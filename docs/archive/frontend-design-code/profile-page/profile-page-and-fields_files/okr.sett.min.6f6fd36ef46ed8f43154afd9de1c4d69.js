var OKRSettings={KEYRESULT_INIT_PAGE:null,OBJECTIVE_INIT_PAGE:null,OBJ_PERM_DATA:null,OBJ_WEI_DATA:!1,OBJ_APPROVE_ENB:!1,KR_WEI_DATA:!1,KR_SETTINGS_TYPE:null,OBJ_TYPES:null,OBJ_ROWCOUNT:0,KR_ROWCOUNT:0,LOC_OKR_VISIBILITY:!1,CONFIGURATION_INIT_PAGE:null,PERMISSION_INIT_PAGE:null,FINANCIAL_YEAR_START:null,FINANCIALYEAR:null,PRE_FINANCIAL_YEAR_START:null,PRE_FINANCIALYEAR:null,alertMsg:null,checkInApproval:!1,ISSUPERADMIN:!1,ADMIN_LIST:null,ADMIN_LIST_OPTIONS:null,ROLE_LIST:null,IS_MODULEADMIN_ENABLED:!1,SEL_ADMIN_LIST:null,SEL_ROLEID:null,IS_SCHEDULED:!1,SCHEDULED_TIME:null,STATUS_UPDATE_TYPE:0,IS_OBJ_ALIGN_APPR:!1,getPreviousPageUrl:()=>"#operations/okr/searchuser",objectiveInitpage:function(){return null!==OKRSettings.OBJECTIVE_INIT_PAGE&&void 0!==OKRSettings.OBJECTIVE_INIT_PAGE||$.ajax({type:"POST",async:!1,url:"/getObjetiveSet.zp",data:{conreqcsr:csrfToken},success:function(resultData){OKRSettings.OBJECTIVE_INIT_PAGE=resultData}}),OKRSettings.OBJECTIVE_INIT_PAGE},objectiveInit:function(){var pageId=settingsPage.container;pageId.html(OKRSettings.objectiveInitpage()),OKRCommon.ajaxCall.getCalltype(!1,"/okrSettings/getObjSettingData",{},OKRSettings.getobjSettingDataConstruct),ZPeopleComponents.toggleswitch(pageId.find("#objweitage")).setAttributes({on:OKRSettings.OBJ_WEI_DATA,change:OKRSettings.objWeight}),ZPeopleComponents.toggleswitch(pageId.find("#objtAppoTogBtn")).setAttributes({on:OKRSettings.OBJ_APPROVE_ENB,change:OKRSettings.objectiveApproveEnb}),ZPeopleComponents.toggleswitch(pageId.find("#objtAlignAppoTogBtn")).setAttributes({on:OKRSettings.IS_OBJ_ALIGN_APPR,change:OKRSettings.objAlignApproveEnb})},objAlignApproveEnb:function(event){var pageId=settingsPage.container,data=event.detail;1==data.state?pageId.find("#objAlignAppro").removeClass("zpl_DNI"):pageId.find("#objAlignAppro").addClass("zpl_DNI"),OKRSettings.IS_OBJ_ALIGN_APPR!=data.state&&OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_ALIGN_APPROVAL")},objectiveApproveEnb:function(event){var pageId=settingsPage.container,data=event.detail;1==data.state?pageId.find("#objAppro").removeClass("DNI"):pageId.find("#objAppro").addClass("DNI"),OKRSettings.OBJ_APPROVE_ENB!=data.state&&OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_APPROVAL")},objectivePermSet:function(obj){var pId=settingsPage.container,id=$(obj).attr("id"),ischanged=!1,data=pId.find("#"+id).prop("checked");null!=OKRSettings.OBJ_PERM_DATA&&void 0!=OKRSettings.OBJ_PERM_DATA?(-1!=id.indexOf("Self")&&(ischanged=-1!=id.indexOf("Add")&&OKRSettings.OBJ_PERM_DATA.objt_MyselfAdd!=data),-1!=id.indexOf("Rep")&&(ischanged=-1!=id.indexOf("Add")&&OKRSettings.OBJ_PERM_DATA.objt_MyTeamAdd!=data),-1!=id.indexOf("Dep")&&(ischanged=-1!=id.indexOf("Add")&&OKRSettings.OBJ_PERM_DATA.objt_DepartAdd!=data),-1!=id.indexOf("Loc")&&(ischanged=-1!=id.indexOf("Add")&&OKRSettings.OBJ_PERM_DATA.objt_LocAdd!=data)):ischanged=!0,ischanged&&OKRSettings.okrSaveResetBtnConstruct("OBJ_PERMISSION")},okrSaveResetBtnConstruct:function(section){var pId=settingsPage.container,_htm='<button type="button" attr="reset" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.reset")+"</button>";_htm+='<button type="button" attr="save" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.save")+"</button>",pId.find("#"+section+"_SAVERESET").html(""),pId.find("#"+section+"_SAVERESET").append(_htm),pId.find("#"+section+"_SAVERESET [attr=reset]").on("click",function(){OKRSettings.Reset.okrResetData(section)}),pId.find("#"+section+"_SAVERESET [attr=save]").on("click",function(){switch(section){case"OBJ_PERMISSION":OKRSettings.Save.saveObjectivePerm();break;case"KEYRESULT_TYPE":OKRSettings.Save.saveKrTypeSetting();break;case"OBJECTIVE_TYPES":OKRSettings.Save.saveObjectiveStatus();break;case"OBJECTIVE_APPROVAL":OKRSettings.Save.saveObjectiveApprovalStatus();break;case"FINANCIAL_YEAR":OKRSettings.Save.saveFinancialYearChange();break;case"KEYCHECKIN_APPROVAL":OKRSettings.Save.saveCheckInApproval();break;case"OKR_ADMINISTRATOR":OKRSettings.Save.saveOkrAdmins();break;case"OBJECTIVE_ALIGN_APPROVAL":OKRSettings.Save.saveObjAlignApproval()}}),pId.find("#"+section+"_SAVERESET").hasClass("zpl_DNI")&&pId.find("#"+section+"_SAVERESET").removeClass("zpl_DNI")},keyResultInitpage:function(){return null!==OKRSettings.KEYRESULT_INIT_PAGE&&void 0!==OKRSettings.KEYRESULT_INIT_PAGE||$.ajax({type:"POST",async:!1,url:"/getKeyResSet.zp",data:{conreqcsr:csrfToken},success:function(resultData){OKRSettings.KEYRESULT_INIT_PAGE=resultData}}),OKRSettings.KEYRESULT_INIT_PAGE},keyResultInit:function(){var pageId=settingsPage.container;pageId.html(OKRSettings.keyResultInitpage()),OKRCommon.ajaxCall.getCalltype(!1,"/okrSettings/getKrSettingData",{},OKRSettings.Success.getKrSettingData),ZPeopleComponents.toggleswitch(pageId.find("#krweight")).setAttributes({on:OKRSettings.KR_WEI_DATA,change:OKRSettings.krWeight}),ZPeopleComponents.toggleswitch(pageId.find("#keyAppoTogBtn")).setAttributes({on:OKRSettings.checkInApproval,change:OKRSettings.checkInApprovalValid}),pageId.find("#keyAssignPer input[type=radio]").change(function(){OKRSettings.updatekeyAssignPer($(this))})},checkInApprovalValid:function(event){var pageId=settingsPage.container,data=event.detail;1==data.state?pageId.find("#keyAppro").removeClass("DNI"):pageId.find("#keyAppro").addClass("DNI"),OKRSettings.checkInApproval!=data.state&&OKRSettings.okrSaveResetBtnConstruct("KEYCHECKIN_APPROVAL")},krWeight:function(event){var data=event.detail,dataParams={submode:"krWeightageSetting"};dataParams.wegenb=data.state?1:0,hdrId="krweightagehdr",OKRSettings.updateOkrSettings(dataParams)},updatekeyAssignPer:function(elem){var pageId=settingsPage.container;ZPeople.autosave.clearelement(pageId.find("#keyAssignPerHdr")),$(pageId.find("#keyAssignPerHdr")).find(".zpl_atosv span").text(ZPI18N.getString("zp.saving"));var params={};params.permission=$(elem).val(),OKRCommon.ajaxCall.postCallType(!1,"/okrSettings/setKeyRtAssignPer",params,OKRSettings.successupdateKeyAssignPer)},successupdateKeyAssignPer:function(resultData){var pageId=settingsPage.container;return ZPeople.autosave.clearelement(pageId.find("#keyAssignPerHdr")),"success"==resultData.msg?($(pageId.find("#keyAssignPerHdr")).find(".zpl_atosv > .zpl_atocnt").addClass("svd"),$(pageId.find("#keyAssignPerHdr")).find(".zpl_atosv span").text(ZPI18N.getString("zp.saved"))):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),setTimeout(function(){ZPeople.autosave.fadeOut(pageId.find("#keyAssignPerHdr"))},1e3)},objWeight:function(event){var data=event.detail,dataParams={submode:"objWeightageSetting"};dataParams.wegenb=data.state?1:0,hdrId="objweighthdr",OKRSettings.updateOkrSettings(dataParams)},locVisi:function(event){var data=event.detail,dataParams={};dataParams.locvisi=data.state?1:0,OKRCommon.ajaxCall.postCallType(!1,"/okrSettings/setLocvisibility",dataParams,OKRSettings.locVisiSuccessFn)},updateOkrSettings:function(dataParams){OKRCommon.ajaxCall.postCallType(!1,"/okrSettings/setWeightageEnable",dataParams,OKRSettings.okrWeightageSuccessFn)},okrWeightageSuccessFn:function(resultData){var pageId=settingsPage.container;"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#"+hdrId),ZPI18N.getString("zp.saved")):"permission_denied"===resultData.msg?ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")):"error"===resultData.msg&&ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},locVisiSuccessFn:function(resultData){var pageId=settingsPage.container;"Success"==resultData.msg?ZPeople.autosave.success(pageId.find("#locobjhdr"),ZPI18N.getString("zp.saved")):"Error"===resultData.msg&&ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},getobjSettingDataConstruct:function(resultData){if(void 0!=resultData&&"success"==resultData.msg){var pId=settingsPage.container;if(OKRSettings.OBJ_WEI_DATA=resultData.objWeightEnable,OKRSettings.OBJ_APPROVE_ENB=resultData.objApproveEnb,OKRSettings.IS_OBJ_ALIGN_APPR=resultData.objAlignApproveEnb,OKRSettings.OBJ_PERM_DATA=resultData.objPerm,OKRSettings.Reset.resetObjectivePerm(resultData.objPerm),void 0!=resultData.objtFormId){let link="#settings/service/okr/approval",approvalTxt='<a target="_blank" href="'+(link+="-formid:"+resultData.objtFormId)+'" class="u-link zpl_link">'+ZPI18N.getString("zp.clickhere")+"</a>"+ZPI18N.getString("zp.cusApproProc");pId.find("#objApproLink").html(approvalTxt)}if(void 0!=resultData.objtAlignFormId){let link="#settings/service/okr/approval",approvalTxt='<a target="_blank" href="'+(link+="-formid:"+resultData.objtAlignFormId)+'" class="u-link zpl_link">'+ZPI18N.getString("zp.clickhere")+"</a>"+ZPI18N.getString("zp.cusApproProc");pId.find("#objAlignApproLink").html(approvalTxt)}OKRSettings.OBJ_APPROVE_ENB?pId.find("#objAppro").removeClass("DNI"):pId.find("#objAppro").addClass("DNI"),OKRSettings.IS_OBJ_ALIGN_APPR?pId.find("#objAlignAppro").removeClass("zpl_DNI"):pId.find("#objAlignAppro").addClass("zpl_DNI")}},constructObjStatus:function(){var pageid=settingsPage.container,series=1;$.each(OKRSettings.OBJ_TYPES,function(index,data){var newrowhtml="",footer="",colorcode=data.code.slice(-1),colorcls="";if(colorcls=colorcode>0&&colorcode<=10?"zpl_seclrdrkbg"+colorcode:0==colorcode?"zpl_seclrdrkbg1"+colorcode:data.code.slice(0,-3),"COM"===data.stscode&&""!=data.stscode)footer+='<tr id="'+data.stsid+'" stscode="'+data.stscode+'"><td><input type="text" class="ztextbox wd100_per" id="name_0" value="'+data.stsname+'"/></td>',footer+="<td>",footer+="</td>",footer+='<td colspan="4"><span id="colorObj_0" name="stscolor" class="zpl_ibg coloropen '+colorcls+'" clcode="'+colorcls+'"></span></tr>',series--,pageid.find("#objectiveTypesfooter").append(footer);else if("NYS"===data.stscode&&""!=data.stscode)newrowhtml+='<tr id="'+data.stsid+'" stscode="'+data.stscode+'" series="'+series+'" ><td><input type="text" class="ztextbox wd100_per" id="name_'+series+'" value="'+data.stsname+'"/></td>',newrowhtml+="<td>",newrowhtml+="</td>",newrowhtml+='<td colspan="4"><span id="colorObj_'+series+'" name="stscolor" class="zpl_ibg coloropen '+colorcls+'" clcode="'+colorcls+'"></span></td></tr> ';else{var to=data.rangeto;100!=data.rangeto&&99!=data.rangeto||(to=0==OKRSettings.STATUS_UPDATE_TYPE?99:100),newrowhtml+='<tr id="'+data.stsid+'" series="'+series+'"><td><input type="text" class="ztextbox wd100_per" id="name_'+series+'"  value="'+data.stsname+'"/></td>',newrowhtml+='<td><div class="zpl_idiv"> <div class="ztextbox--group ztextbox--zicon zpl_inpticfild zh-alignright w100"><span class="ztextbox__icon">%</span><input  type="text"  onkeydown="return OKRSettings.onNRKeyDown(this,event)" id="from_'+series+'" class="ztextbox w100" value="'+data.rangefrom+'" /></div>',newrowhtml+='<em>-</em><div class="ztextbox--group ztextbox--zicon zpl_inpticfild zh-alignright w100"><span class="ztextbox__icon">%</span><input  type="text"  onkeydown="return OKRSettings.onNRKeyDown(this,event)" id="to_'+series+'" class="ztextbox w100" value="'+to+'" /></div> </div></td>',newrowhtml+='<td><span id="colorObj_'+series+'" name="stscolor" class="zpl_ibg coloropen '+colorcls+'" clcode="'+colorcls+'"></span></td>',newrowhtml+='<td><div><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'"></i></div></td></tr>'}pageid.find("#objectiveTypes").append(newrowhtml),series++});var defval=0==OKRSettings.STATUS_UPDATE_TYPE?"99":"100";OKRSettings.OBJ_ROWCOUNT=series,OKRSettings.OBJ_TYPES.length<10&&pageid.find("#addObjTypeaddbtn").parent().show(),pageid.find(".PI_delete").on("click",function(){pageid.find(".PI_delete").addClass("disabled"),pageid.find("[id^='from_']").addClass("disabled"),pageid.find("[id^='to_']").addClass("disabled"),pageid.find("#addObjTypeaddbtn").addClass("disabled"),OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_TYPES");var cur_series=Number($(this).parent().parent().parent().attr("series")),cur_to=Number(pageid.find("#to_"+cur_series).val());2===cur_series?pageid.find("#from_"+(cur_series+1)).val("1"):pageid.find("#to_"+(cur_series-1)).val(cur_to),$(this).parent().parent().parent().remove();var series=1;pageid.find("#objectiveTypes").children().each(function(index,data){$(this).attr("series",series++)}),OKRSettings.OBJ_ROWCOUNT=series}),pageid.find("[id^=name_]").on("keyup",function(){OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_TYPES")}),pageid.find("[id^=colorObj_]").on("click",function(){let elementid=$(this).attr("id"),element=pageid.find("#"+elementid),colormenu=pageid.find("#colorSelectmenu");colormenu.length>0&&ZPeopleComponents.menu(colormenu).destroy(),colormenu.remove(),$(this).append('<div id="colorSelectmenu" class="zpl_drpdwn zpl_clrpckr zpl_drpdwnic"><ul></ul></div>'),(colormenu=pageid.find("#colorSelectmenu")).on("zmenuitemclick",function(eve,edata){var colorclass=edata.iconClass;element.removeAttr("class"),element.addClass("zpl_ibg coloropen "+colorclass),element.attr("clcode",colorclass)});var mhtml="";for(let cnt=1;cnt<=10;cnt++)mhtml+='<li data-icon-class="zpl_seclrdrkbg'+cnt+'"  class="zpl_seclrdrkbg'+cnt+'" ></li>';var newcolor=["grybg","grnbg","redbg","ylwbg","blubg"];for(let cnt=0;cnt<newcolor.length;cnt++)mhtml+='<li data-icon-class="'+newcolor[cnt]+'" class="'+newcolor[cnt]+'" ></li>';colormenu.find("ul").html(mhtml),ZPeopleComponents.menu(colormenu,{forElement:element,column:5,contentType:"icon-text",appendTo:pageid}),ZPeopleComponents.menu(colormenu).show(),OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_TYPES")}),pageid.find("[id^=from_]").on("keyup",function(){OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_TYPES"),pageid.find("[id^='from_']").addClass("disabled"),pageid.find("[id^='to_']").addClass("disabled"),pageid.find("#addObjTypeaddbtn").addClass("disabled");var series=Number($(this).parent().parent().parent().parent().attr("series"));$(this).removeClass("disabled"),pageid.find("#to_"+series).removeClass("disabled"),pageid.find(".zpl_hvr").remove();var pre_to=pageid.find("#to_"+(series-1)).val();void 0!=pre_to&&($(this).parent().parent().append('<div class="zpl_hvr"><i class="PI_tick grn forEdt"></i><i class="PI_cls red forEdt"></i>'),pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").addClass("disabled"),pre_to=Number(pageid.find("#to_"+(series-1)).val()));var cur_val,cur_to=Number(pageid.find("#to_"+series).val());series>=3?(cur_val=Number($(this).val()),pageid.find(".PI_tick").on("click",function(){if(pageid.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),cur_val>pre_to&&cur_val<cur_to)pageid.find("#to_"+(series-1)).val(cur_val-1),pageid.find(".zpl_hvr").remove(),pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").removeClass("disabled"),pageid.find("[id^='from_']").removeClass("disabled"),pageid.find("[id^='to_']").removeClass("disabled");else{let errobj=pageid.find("#objectiveTypesfooter");var errMsg;cur_val>=cur_to?errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangelesserthan",[Number(cur_to)]):cur_val<=pre_to&&(errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[Number(pre_to)])),$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>")}})):2==series&&($(this).val("1"),cur_val=Number($(this).val()),pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").removeClass("disabled"),pageid.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),pageid.find(".PI_tick").on("click",function(){if(pageid.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),cur_val>pre_to&&cur_val<cur_to)pageid.find("#to_"+(series-1)).val(cur_val-1),pageid.find(".zpl_hvr").remove(),pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").removeClass("disabled"),pageid.find("[id^='from_']").removeClass("disabled"),pageid.find("[id^='to_']").removeClass("disabled");else{let errobj=pageid.find("#objectiveTypesfooter");var errMsg;cur_val>=cur_to?errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangelesserthan",[Number(cur_to)]):cur_val<=pre_to&&(errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[Number(pre_to)])),$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>")}})),pageid.find(".PI_cls").on("click",function(){var next_from=Number(void 0==pageid.find("#from_"+(series+1)).val()?Number(defval)+1:pageid.find("#from_"+(series+1)).val());pageid.find("#from_"+series).val(pre_to+1),pageid.find("#to_"+series).val(next_from-1),pageid.find(".zpl_hvr").remove(),pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").removeClass("disabled"),pageid.find("[id^='from_']").removeClass("disabled"),pageid.find("[id^='to_']").removeClass("disabled"),pageid.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),pageid.find("#addObjTypeaddbtn").removeClass("disabled")})}),pageid.find("[id^=to_]").on("keyup",function(){OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_TYPES"),pageid.find("[id^='from_']").addClass("disabled"),pageid.find("[id^='to_']").addClass("disabled"),pageid.find("#addObjTypeaddbtn").addClass("disabled");var series=Number($(this).parent().parent().parent().parent().attr("series"));$(this).removeClass("disabled"),pageid.find("#from_"+series).removeClass("disabled"),pageid.find(".zpl_hvr").remove();var next_from=pageid.find("#from_"+(series+1)).val();void 0!=next_from&&($(this).parent().parent().append('<div class="zpl_hvr"><i class="PI_tick grn forEdt"></i><i class="PI_cls red forEdt"></i>'),pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").addClass("disabled"));var cur_from=Number(pageid.find("#from_"+series).val());101==(next_from=Number(void 0==next_from?"101":pageid.find("#from_"+(series+1)).val()))&&$(this).val(defval);var cur_val=Number($(this).val());pageid.find(".PI_tick").on("click",function(){if(pageid.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),cur_val>cur_from&&cur_val<next_from)pageid.find("#from_"+(series+1)).val(cur_val+1),pageid.find(".zpl_hvr").remove(),pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").removeClass("disabled"),pageid.find("[id^='from_']").removeClass("disabled"),pageid.find("[id^='to_']").removeClass("disabled");else{let errobj=pageid.find("#objectiveTypesfooter");var errMsg;cur_val>=next_from?errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangelesserthan",[Number(next_from)]):cur_val<=cur_from&&(errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[Number(cur_from)])),$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>")}}),pageid.find(".PI_cls").on("click",function(){var pre_to=pageid.find("#to_"+(series-1)).val();void 0!=pre_to&&void 0!=next_from?(pageid.find("#from_"+series).val(Number(pre_to)+1),pageid.find("#to_"+series).val(Number(next_from)-1)):void 0==pre_to&&void 0!=next_from?(pageid.find("#from_"+series).val("1"),pageid.find("#to_"+series).val(Number(next_from)-1)):void 0!=pre_to&&void 0==next_from?(pageid.find("#from_"+series).val(Number(pre_to)+1),pageid.find("#to_"+series).val(defval)):(pageid.find("#from_"+series).val("1"),pageid.find("#to_"+series).val(defval)),pageid.find(".zpl_hvr").remove(),pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").removeClass("disabled"),pageid.find("[id^='from_']").removeClass("disabled"),pageid.find("[id^='to_']").removeClass("disabled"),pageid.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),pageid.find("#addObjTypeaddbtn").removeClass("disabled")})})},objectiveStatusAction:function(){var pageid=settingsPage.container;pageid.find("#addObjTypeaddbtn").click(function(){var newrowhtml="";pageid.find(".PI_delete").addClass("disabled"),pageid.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_TYPES"),pageid.find("[id^='from_']").addClass("disabled"),pageid.find("[id^='to_']").addClass("disabled"),pageid.find("#addObjTypeaddbtn").addClass("disabled");var defval,series=OKRSettings.OBJ_ROWCOUNT,pre_to=pageid.find("#to_"+(series-1)).val(),pre_from=pageid.find("#from_"+(series-1)).val();defval=0==OKRSettings.STATUS_UPDATE_TYPE?99:100,newrowhtml+='<tr  series="'+series+'"><td><input type="text" class="ztextbox wd100_per" id="name_'+series+'" /></td>',newrowhtml+='<td><div class="zpl_idiv"> <div class="ztextbox--group ztextbox--zicon zpl_inpticfild zh-alignright w100"><span class="ztextbox__icon">%</span><input type="text"  onkeydown="return OKRSettings.onNRKeyDown(this,event)" id="from_'+series+'" class="ztextbox w100" /></div>',newrowhtml+='<em>-</em><div class="ztextbox--group ztextbox--zicon zpl_inpticfild zh-alignright w100"><span class="ztextbox__icon">%</span><input  type="text" onkeydown="return OKRSettings.onNRKeyDown()" id="to_'+series+'" value="'+defval+'" disabled class="ztextbox w100"/></div> </div></td>',newrowhtml+='<td><span id="colorObj_'+series+'" name="stscolor" class="zpl_ibg coloropen zpl_seclrdrkbg1" clcode="zpl_seclrdrkbg1"></span></td>',newrowhtml+='<td><div><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'"></i></div></td></tr>',pageid.find("#objectiveTypes").append(newrowhtml),pageid.find("[id^='from_']").on("keyup",function(){pageid.find(".zpl_hvr").remove(),series=$(this).parent().parent().parent().parent().attr("series");var pre_from=pageid.find('[id="from_'+(Number(series)-1)+'"]').val(),min_fromval=0,max_fromval=0,new_val=0;void 0==pre_from?(pageid.find(".zpl_hvr").remove(),pageid.find("[id^='from_"+series+"']").val(1),pageid.find("[id^='to_"+series+"']").val(defval)):($(this).parent().parent().append('<div class="zpl_hvr"><i class="PI_tick grn forEdt"></i><i class="PI_cls red forEdt"></i>'),pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").addClass("disabled"),min_fromval=Number(pre_from)+1,max_fromval=100,new_val=Number(""==$(this).val()?min_fromval+1:$(this).val()),pageid.find(".PI_tick").on("click",function(){if(pageid.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),new_val>min_fromval&&new_val<max_fromval)""==pageid.find("[id^='from_"+series+"']")&&pageid.find("[id^='from_"+series+"']").val(min_fromval+1),pageid.find('[id="to_'+(Number(series)-1)+'"]').val(new_val-1),OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_TYPES"),OKRSettings.OBJ_ROWCOUNT=series++,pageid.find(".zpl_hvr").remove(),pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").removeClass("disabled");else{let errobj=pageid.find("#objectiveTypesfooter");var errMsg;new_val>=max_fromval?errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangelesserthan",[Number(max_fromval)]):new_val<=min_fromval&&(errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[Number(min_fromval)])),$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>")}})),pageid.find(".PI_cls").on("click",function(){pageid.find("#OBJECTIVE_TYPES_SAVERESET").find("[attr='save']").removeClass("disabled"),pageid.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),pageid.find(".zpl_hvr").remove(),pageid.find('[id="from_'+series+'"]').val("")})}),pageid.find("[id^=colorObj_]").on("click",function(){let elementid=$(this).attr("id"),element=pageid.find("#"+elementid),colormenu=pageid.find("#colorSelectmenu");colormenu.length>0&&ZPeopleComponents.menu(colormenu).destroy(),colormenu.remove(),$(this).append('<div id="colorSelectmenu" class="zpl_drpdwn zpl_clrpckr zpl_drpdwnic"><ul></ul></div>'),(colormenu=pageid.find("#colorSelectmenu")).on("zmenuitemclick",function(eve,edata){var colorclass=edata.iconClass;element.removeAttr("class"),element.addClass("zpl_ibg coloropen "+colorclass),element.attr("clcode",colorclass)});var mhtml="";for(let cnt=1;cnt<=10;cnt++)mhtml+='<li data-icon-class="zpl_seclrdrkbg'+cnt+'"  class="zpl_seclrdrkbg'+cnt+'" ></li>';var newcolor=["grybg","grnbg","redbg","ylwbg","blubg"];for(let cnt=0;cnt<newcolor.length;cnt++)mhtml+='<li data-icon-class="'+newcolor[cnt]+'" class="'+newcolor[cnt]+'" ></li>';colormenu.find("ul").html(mhtml),ZPeopleComponents.menu(colormenu,{forElement:element,column:5,contentType:"icon-text",appendTo:pageid}),ZPeopleComponents.menu(colormenu).show(),OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_TYPES")}),pageid.find(".PI_delete").on("click",function(){var cur_from=pageid.find("#from_"+series).val();void 0!=pre_from&&void 0!=pre_to&&""!=cur_from&&(pageid.find("#to_"+(series-2)).val(pre_to),pageid.find("#from_"+(series-2)).val(pre_from)),pageid.find("#addObjTypeaddbtn").addClass("disabled"),pageid.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),$(this).parent().parent().parent().remove(),OKRSettings.OBJ_ROWCOUNT=series--})})},onEditClose:function(sibling_id,value,type){if(1==type)(pageid=settingsPage.container).find(".zpl_hvr").remove(),pageid.find("#"+sibling_id+"_to").val(value-1),OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_TYPES");else if(2==type){var pageid;(pageid=settingsPage.container).find(".zpl_hvr").remove(),pageid.find("#"+sibling_id+"_from").val(Number(value)+1),OKRSettings.okrSaveResetBtnConstruct("OBJECTIVE_TYPES")}},removeObjectiveStatus:function(){var pageId=settingsPage.container;if(1!=pageId.find("#objectiveTypes [rel=typesdiv]").length){$(obj).parent().parent().remove();var count=1;$.each(pageId.find("#objectiveTypes .zpl_idiv"),function(index,ele){$(ele).find("div").first().html(count),count++}),pageId.find("#addObjTypeaddbtn").parent().show()}else ZPeople.Message.failure(ZPI18N.getString("zp.mrtypemincountmsg"))},Save:{saveObjectivePerm:function(){var pId=settingsPage.container,insertData={};insertData.objt_MyselfAdd=pId.find("#objAdd_Self").prop("checked"),insertData.objt_MyTeamAdd=pId.find("#objAdd_Rep").prop("checked"),insertData.objt_DepartAdd=pId.find("#objAdd_Dep").prop("checked"),insertData.objt_LocAdd=pId.find("#objAdd_Loc").prop("checked"),0!=Object.keys(insertData).length&&(ZPeople.autosave.loading(pId.find("#objaccessperm"),ZPI18N.getString("zp.saving")),pId.find("#OBJ_PERMISSION_SAVERESET").html(""),pId.find("#OBJ_PERMISSION_SAVERESET").addClass("zpl_DNI"),OKRSettings.TEMP_PERM_STORE=insertData,OKRCommon.ajaxCall.postCallType(!1,"/okrSettings/setOkrPerm",{perm:JSON.stringify(insertData)},OKRSettings.Success.objPermSuccess))},saveObjectiveStatus:function(){var pId=settingsPage.container,addlist=new Array,updatelist=new Array,removelist=new Array,checklist=new Array,totallist={},iserror=!1;pId.find("#objectiveTypesfooter").find("[elem='errorMsg']").remove(),pId.find("#objectiveTypes").children().each(function(index,data){var from,to,name,isexist=$(this).attr("id"),obj={},statuscode=$(this).attr("stscode");if(void 0==statuscode||null==statuscode||""==statuscode?(from=$(this).find("[id^=from_]").val(),to=$(this).find("[id^=to_]").val()):(from="0",to="0"),""!=(name=$(this).find("[id^=name_]").val())&&null!=name&&null!=from&&""!=from&&null!=to&&""!=to){obj.name=name,obj.from=from,obj.to=to,obj.stscode=void 0==$(this).attr("stscode")?"":$(this).attr("stscode");var color=$(this).find("[id^=colorObj_]").attr("clcode"),colorcode=color.slice(-1);obj.color=colorcode>0&&colorcode<=10?"zpl_seclr"+colorcode:0==colorcode?"zpl_seclr1"+colorcode:color+"lit",void 0!=isexist?(obj.objid=isexist,updatelist.push(obj),checklist.push(isexist)):addlist.push(obj)}else iserror=!0});var fobj={},footer=pId.find("#objectiveTypesfooter").children(),fname=footer.find("#name_0").val();if(null!=fname&&""!=fname){fobj.objid=$(footer).attr("id"),fobj.name=fname,fobj.from="0",fobj.to="0",fobj.stscode=footer.attr("stscode");var color=footer.find("#colorObj_0").attr("clcode"),colorcode=color.slice(-1);fobj.color=colorcode>0&&colorcode<=10?"zpl_seclr"+colorcode:0==colorcode?"zpl_seclr1"+colorcode:color+"lit",updatelist.push(fobj),checklist.push($(footer).attr("id")),$.each(OKRSettings.OBJ_TYPES,function(index,data){""==data.stscode&&-1==checklist.indexOf(data.stsid)&&removelist.push(data.stsid)}),updatelist.length>0&&(totallist.updatelist=updatelist),addlist.length>0&&(totallist.addlist=addlist),removelist.length>0&&(totallist.removelist=removelist)}else iserror=!0;if(iserror){let errobj=pId.find("#objectiveTypesfooter");var errMsg=ZPI18N.getString("zp.emptyfields");$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>")}else pId.find("#OBJECTIVE_TYPES_SAVERESET").html(""),pId.find("#OBJECTIVE_TYPES_SAVERESET").addClass("zpl_DNI"),OKRCommon.ajaxCall.postCallType(!1,"/okrSettings/updateObjectivetypeSetting",{Objtypes:JSON.stringify(totallist)},OKRSettings.Success.ObjectiveTypeSuccessFn)},saveObjectiveApprovalStatus:function(){var pageId=settingsPage.container,isEnable=ZPeopleComponents.toggleswitch(pageId.find("#objtAppoTogBtn")).getState(),param={};param.isEnable=isEnable?1:0,pageId.find("#OBJECTIVE_APPROVAL_SAVERESET").html(""),pageId.find("#OBJECTIVE_APPROVAL_SAVERESET").addClass("zpl_DNI"),OKRCommon.ajaxCall.postCallType(!1,"/okrSettings/objectiveApproval",param,OKRSettings.Success.objectiveApprovalSucessFN)},saveFinancialYearChange:function(){var pageId=settingsPage.container,param={};param.stmonth=OKRSettings.FINANCIAL_YEAR_START,pageId.find("#FINANCIAL_YEAR_SAVERESET").html(""),pageId.find("#FINANCIAL_YEAR_SAVERESET").addClass("zpl_DNI"),OKRCommon.ajaxCall.postCallType(!0,"/okrSettings/financialYearUpdate",param,OKRSettings.FinancialYearChangeSuccessFn)},saveCheckInApproval:function(){var pageId=settingsPage.container,isEnable=ZPeopleComponents.toggleswitch(pageId.find("#keyAppoTogBtn")).getState(),param={};param.isEnable=isEnable?1:0,pageId.find("#KEYCHECKIN_APPROVAL_SAVERESET").html(""),pageId.find("#KEYCHECKIN_APPROVAL_SAVERESET").addClass("zpl_DNI"),OKRCommon.ajaxCall.postCallType(!1,"/okrSettings/keyRsltCheckInApproval",param,OKRSettings.Success.checkInApprovalSucessFN)},saveOkrAdmins:function(){var isEnabled,pageId=settingsPage.container,selectedAdminList=null,selectedRoleId=null,param={};if(isEnabled=ZPeopleComponents.toggleswitch(pageId.find("#admintgbtn")).getState()){var selectedAdminVal=ZPeopleComponents.tokenfield(pageId.find("#okradmins")).getAllValues();if(0==selectedAdminVal.length)return void pageId.find("#okradmins").addClass("ztextbox__error");for(var i in selectedAdminList=[],selectedAdminVal)selectedAdminList.push(selectedAdminVal[i].id);selectedRoleId=ZPeopleComponents.select(pageId.find("#okrNonAdmin")).getValue(),param.selectedAdminList=JSON.stringify(selectedAdminList),param.selectedRoleId=selectedRoleId}param.isCustomAdminEnable=isEnabled,pageId.find("#OKR_ADMINISTRATOR_SAVERESET").html(""),pageId.find("#OKR_ADMINISTRATOR_SAVERESET").addClass("zpl_DNI"),OKRCommon.ajaxCall.postCallType(!0,"/okrSettings/customizeOkrAdmin",param,OKRSettings.Success.customizeOkrAdminSuccessFn)},saveObjAlignApproval:function(){var pageId=settingsPage.container,isEnable=ZPeopleComponents.toggleswitch(pageId.find("#objtAlignAppoTogBtn")).getState(),param={};param.isEnable=isEnable?1:0,pageId.find("#OBJECTIVE_ALIGN_APPROVAL_SAVERESET").html(""),pageId.find("#OBJECTIVE_ALIGN_APPROVAL_SAVERESET").addClass("zpl_DNI"),OKRCommon.ajaxCall.postCallType(!1,"/okrSettings/objAlignApproval",param,OKRSettings.Success.objAlignApprovalSucessFN)}},Reset:{okrResetData:function(section){var pId=settingsPage.container;switch(section){case"OBJ_PERMISSION":OKRSettings.Reset.resetObjectivePerm(OKRSettings.OBJ_PERM_DATA);break;case"KEYRESULT_TYPE":OKRSettings.Reset.resetKrTypeSetting();break;case"OBJECTIVE_TYPES":OKRSettings.Reset.resetObjdataset();break;case"OBJECTIVE_APPROVAL":OKRSettings.Reset.objectiveApproveReset();break;case"FINANCIAL_YEAR":OKRSettings.Reset.financialYearReset();break;case"KEYCHECKIN_APPROVAL":OKRSettings.Reset.checkInApprovalReset();break;case"OKR_ADMINISTRATOR":OKRSettings.Reset.OkrAdminReset();break;case"OBJECTIVE_ALIGN_APPROVAL":OKRSettings.Reset.resetObjAlignApproval()}pId.find("#"+section+"_SAVERESET").html(""),pId.find("#"+section+"_SAVERESET").addClass("zpl_DNI")},resetObjectivePerm:function(resultData){var pId=settingsPage.container;pId.find("#objAdd_Self").prop("checked",resultData.objt_MyselfAdd),pId.find("#objAdd_Rep").prop("checked",resultData.objt_MyTeamAdd),pId.find("#objAdd_Dep").prop("checked",resultData.objt_DepartAdd),pId.find("#objAdd_Loc").prop("checked",resultData.objt_LocAdd)},resetObjdataset:function(){var pageId=settingsPage.container;pageId.find("#objectiveTypes").children().remove(),pageId.find("#objectiveTypesfooter").children().remove(),OKRSettings.constructObjStatus(),pageId.find("#addObjTypeaddbtn").removeClass("disabled"),OKRSettings.OBJ_TYPES.length<10&&pageId.find("#addObjTypeaddbtn").parent().show()},objectiveApproveReset:function(){var pageId=settingsPage.container;OKRSettings.OBJ_APPROVE_ENB?(pageId.find("#objAppro").removeClass("DNI"),pageId.find("#objtAppoTogBtn").ztoggleswitch("switchOn")):(pageId.find("#objAppro").addClass("DNI"),pageId.find("#objtAppoTogBtn").ztoggleswitch("switchOff"))},financialYearReset:function(){var pageId=settingsPage.container;null!=OKRSettings.PRE_FINANCIAL_YEAR_START&&OKRSettings.PRE_FINANCIALYEAR&&(ZPeopleComponents.select(pageId.find("#startmonth")).setValue(OKRSettings.PRE_FINANCIAL_YEAR_START),pageId.find("#finyearInfotxt").text(ZPI18N.getString("zp.okrCycPerd")+" "+OKRSettings.PRE_FINANCIALYEAR))},checkInApprovalReset:function(){var pageId=settingsPage.container;OKRSettings.checkInApproval?(pageId.find("#keyAppro").removeClass("DNI"),pageId.find("#keyAppoTogBtn").ztoggleswitch("switchOn")):(pageId.find("#keyAppro").addClass("DNI"),pageId.find("#keyAppoTogBtn").ztoggleswitch("switchOff"))},OkrAdminReset:function(){OKRSettings.configurationInitialSet.okrAdminSet()},resetObjAlignApproval:function(){var pageId=settingsPage.container;OKRSettings.IS_OBJ_ALIGN_APPR?(pageId.find("#objAlignAppro").removeClass("zpl_DNI"),pageId.find("#objtAlignAppoTogBtn").ztoggleswitch("switchOn")):(pageId.find("#objAlignAppro").addClass("zpl_DNI"),pageId.find("#objtAlignAppoTogBtn").ztoggleswitch("switchOff"))}},Success:{objPermSuccess:function(resultData){var pId=settingsPage.container;void 0!=resultData.msg&&"success"==resultData.msg?(OKRSettings.OBJ_PERM_DATA=OKRSettings.TEMP_PERM_STORE,OKRSettings.TEMP_PERM_STORE=null,ZPeople.autosave.success(pId.find("#objaccessperm"),ZPI18N.getString("zp.saved")),pId.find("#OBJ_PERMISSION_SAVERESET").html(""),pId.find("#OBJ_PERMISSION_SAVERESET").addClass("zpl_DNI")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},okrWeightageSuccessFn:function(resultData){var pageId=settingsPage.container;"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#"+hdrId),ZPI18N.getString("zp.saved")):"permission_denied"===resultData.msg?ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")):"error"===resultData.msg&&ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},getKrSettingData:function(resultData){if(void 0!=resultData&&"success"==resultData.msg){OKRSettings.KR_WEI_DATA=resultData.krWeightEnable,OKRSettings.checkInApproval=resultData.checkInApproval;var pId=settingsPage.container;if(void 0!=resultData.checkInFormId){let link="#settings/service/okr/approval",approvalTxt='<a target="_blank" href="'+(link+="-formid:"+resultData.checkInFormId)+'" class="u-link zpl_link">'+ZPI18N.getString("zp.clickhere")+"</a>"+ZPI18N.getString("zp.cusApproProc");pId.find("#keyApproLink").html(approvalTxt)}OKRSettings.checkInApproval?pId.find("#keyAppro").removeClass("DNI"):pId.find("#keyAppro").addClass("DNI");var keyAssPerId=resultData.keyAssignAllPer?"#allUserAssign":"#subUserAssign";pId.find(keyAssPerId).prop("checked",!0)}},ObjectiveTypeSuccessFn:function(resultData){var pageId=settingsPage.container;void 0!=resultData.msg&&"success"==resultData.msg&&(ZPeople.autosave.success(pageId.find("#objectiveSetting"),ZPI18N.getString("zp.saved")),void 0!=resultData.objTypes&&(OKRSettings.OBJ_TYPES=resultData.objTypes),pageId.find("#objectiveTypes").children().remove(),pageId.find("#objectiveTypesfooter").children().remove(),OKRSettings.constructObjStatus(),pageId.find("#addObjTypeaddbtn").removeClass("disabled"),OKRSettings.OBJ_TYPES.length<10&&pageId.find("#addObjTypeaddbtn").parent().show())},objectiveApprovalSucessFN:function(resultData){var pageId=settingsPage.container;"success"==resultData.msg?(ZPeople.autosave.success(pageId.find("#objtAppDiv"),ZPI18N.getString("zp.saved")),OKRSettings.OBJ_APPROVE_ENB=resultData.objApproveEnb):"appNotAdd"==resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.pa.kra.configapproval",new Array(ZPI18N.getString("zp.Onboarding.Objectives")))):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},checkInApprovalSucessFN:function(resultData){var pageId=settingsPage.container;"success"==resultData.msg?(ZPeople.autosave.success(pageId.find("#keyAppDiv"),ZPI18N.getString("zp.saved")),OKRSettings.checkInApproval=resultData.checkInApproval):"appNotAdd"==resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.pa.kra.configapproval",new Array(ZPI18N.getString("zp.checkin")))):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},customizeOkrAdminSuccessFn:function(resultData){var pageId=settingsPage.container;"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#OKRadminsettinghdr"),ZPI18N.getString("zp.saved")):"permission denied"==resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondeniedtoaccessthispage")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},objAlignApprovalSucessFN:function(resultData){var pageId=settingsPage.container;"success"==resultData.msg?(ZPeople.autosave.success(pageId.find("#objtAlignApprDiv"),ZPI18N.getString("zp.saved")),OKRSettings.IS_OBJ_ALIGN_APPR=resultData.isObjAlignApprove):"appNotAdd"==resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.pa.kra.configapproval",new Array(ZPI18N.getString("zp.Onboarding.Objectives")))):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))}},clearelement:function(headerObj){$(headerObj).find(".zpl_atosv").length>0&&(autosavecnt=$(headerObj).find(".zpl_atosv > .zpl_atocnt"),$(headerObj).find(".zpl_atosv").parent().remove())},onNRKeyDown:function(val,evt){let charCode=evt.which?evt.which:evt.keyCode,value=val.value;return 8===charCode||9===charCode||37===charCode||39===charCode||!(charCode>31&&(charCode<48||charCode>57&&charCode<96||charCode>105))&&!(value.length>3)},configurationInit:function(){var pageId=settingsPage.container;ZPeopleComponents.isComponent(Layout.Page.container.find("#startmonth"))&&ZPeopleComponents.select(pageId.find("#startmonth")).destroy(),pageId.html(OKRSettings.okrConfigurationInitPage()),OKRCommon.ajaxCall.getCalltype(!1,"/okrSettings/getConfigSettingData",{},OKRSettings.getConfigSuccessFn)},okrConfigurationInitPage:function(){return null!==OKRSettings.CONFIGURATION_INIT_PAGE&&void 0!==OKRSettings.CONFIGURATION_INIT_PAGE||OKRCommon.ajaxCall.postCallType(!1,"/getConfigSet.zp",{},function(resultdata){OKRSettings.CONFIGURATION_INIT_PAGE=resultdata}),OKRSettings.CONFIGURATION_INIT_PAGE},getConfigSuccessFn:function(resultData){var endmonth;(void 0!=resultData.locOkrVisi&&(OKRSettings.LOC_OKR_VISIBILITY=resultData.locOkrVisi),void 0!=resultData.finyear)&&(OKRSettings.PRE_FINANCIAL_YEAR_START=resultData.finyear,OKRSettings.FINANCIAL_YEAR_START=resultData.finyear,endmonth=0==OKRSettings.FINANCIAL_YEAR_START?Calendar.months[11]:Calendar.months[OKRSettings.FINANCIAL_YEAR_START-1],OKRSettings.PRE_FINANCIALYEAR=Calendar.months[OKRSettings.FINANCIAL_YEAR_START]+" - "+endmonth,OKRSettings.FINANCIALYEAR=Calendar.months[OKRSettings.FINANCIAL_YEAR_START]+" - "+endmonth);void 0!=resultData.statusUpdateType&&(OKRSettings.STATUS_UPDATE_TYPE=resultData.statusUpdateType),void 0!=resultData.objTypes&&(OKRSettings.OBJ_TYPES=resultData.objTypes),OKRSettings.getConfigActionFn()},getConfigActionFn:function(){var pageId=Layout.Page.container;ZPeopleComponents.toggleswitch(pageId.find("#locobjvisi")).setAttributes({on:OKRSettings.LOC_OKR_VISIBILITY,change:OKRSettings.locVisi});var monthopt="";$.each(Calendar.months,function(key,val){monthopt+='<option value="'+key+'">'+val+"</option>"}),pageId.find("#startmonth").append(monthopt),ZPeopleComponents.select(pageId.find("#startmonth")),null!=OKRSettings.FINANCIAL_YEAR_START&&ZPeopleComponents.select(pageId.find("#startmonth")).setValue(OKRSettings.FINANCIAL_YEAR_START),null!=OKRSettings.FINANCIALYEAR&&pageId.find("#finyearInfotxt").text(ZPI18N.getString("zp.okrCycPerd")+" "+OKRSettings.FINANCIALYEAR),pageId.find("#startmonth").on("zselectchange",OKRSettings.monthchanged);var id=0==OKRSettings.STATUS_UPDATE_TYPE?"#valBased":"#devBased";pageId.find(id).prop("checked",!0),pageId.find("#statusTypeOpt input[type=radio]").change(function(){OKRSettings.okrStatusUpdateChange($(this))}),OKRSettings.constructObjStatus(),OKRSettings.objectiveStatusAction();var isDevBased=0!=OKRSettings.STATUS_UPDATE_TYPE;OKRSettings.statusUpdateAction(isDevBased)},okrStatusUpdateChange:function(element){var pageId=settingsPage.container;ZPeople.autosave.clearelement(pageId.find("#updateTypeStatushdr")),$(pageId.find("#updateTypeStatushdr")).find(".zpl_atosv span").text(ZPI18N.getString("zp.saving"));var param={},value=$(element).val(),isDevBased=0!=value;OKRSettings.statusUpdateAction(isDevBased),param.statusUpdateType=value,param.ObjStatusId=pageId.find('[series="'+(OKRSettings.OBJ_ROWCOUNT-1)+'"]').attr("id"),OKRCommon.ajaxCall.postCallType(!1,"/okrSettings/setOkrStatusUpdateType",param,OKRSettings.setStatusUpTypeSuccessFn)},statusUpdateAction:function(isdevbased){var pageId=Layout.Page.container;isdevbased?(pageId.find("#stsheader").text(ZPI18N.getString("zp.devrange")),pageId.find("#schedulardiv").removeClass("zpl_DNI")):(pageId.find("#stsheader").text(ZPI18N.getString("zp.progrange")),pageId.find("#schedulardiv").addClass("zpl_DNI"))},setStatusUpTypeSuccessFn:function(resultdata){var pageId=settingsPage.container;if("success"==resultdata.msg){if($(pageId.find("#updateTypeStatushdr")).find(".zpl_atosv > .zpl_atocnt").addClass("svd"),$(pageId.find("#updateTypeStatushdr")).find(".zpl_atosv span").text(ZPI18N.getString("zp.saved")),void 0!=resultdata.schedularData){var schData=resultdata.schedularData;void 0!=schData.isscheduled&&(OKRSettings.IS_SCHEDULED=schData.isscheduled),void 0!=schData.schTime&&OKRSettings.IS_SCHEDULED&&(OKRSettings.SCHEDULED_TIME=schData.schTime)}void 0!=resultdata.statusUpdateType&&(OKRSettings.STATUS_UPDATE_TYPE=resultdata.statusUpdateType),void 0!=resultdata.objTypes&&(OKRSettings.OBJ_TYPES=resultdata.objTypes,pageId.find("#objectiveTypes").html(""),pageId.find("#objectiveTypesfooter").html(""),OKRSettings.constructObjStatus());var id=0==OKRSettings.STATUS_UPDATE_TYPE?"#valBased":"#devBased";pageId.find(id).prop("checked",!0)}else ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"));return setTimeout(function(){ZPeople.autosave.fadeOut(pageId.find("#updateTypeStatushdr"))},1e3)},monthchanged:function(){var endmonth,pageId=Layout.Page.container,selectedmonth=parseInt(ZPeopleComponents.select(pageId.find("#startmonth")).getValue());endmonth=0==selectedmonth?Calendar.months[11]:Calendar.months[selectedmonth-1],OKRSettings.FINANCIAL_YEAR_START=selectedmonth,OKRSettings.FINANCIALYEAR=Calendar.months[selectedmonth]+" - "+endmonth,pageId.find("#finyearInfotxt").text(ZPI18N.getString("zp.okrCycPerd")+" "+OKRSettings.FINANCIALYEAR),OKRSettings.okrSaveResetBtnConstruct("FINANCIAL_YEAR")},FinancialYearChangeSuccessFn:function(resultData){var pageId=Layout.Page.container;"Success"==resultData.msg?ZPeople.autosave.success(pageId.find("#financialyearhdr"),ZPI18N.getString("zp.saved")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},getExecutionBeforeTabChange:function(changeTabCall){void 0!=settingsPage.container.find('[attr="save"]').html()?(OKRSettings.alertMsg=new InfoAlertMessage,OKRSettings.alertMsg.title="",OKRSettings.alertMsg.cancelButtonText=ZPI18N.getString("zp.cancel"),OKRSettings.alertMsg.yesButtonText=ZPI18N.getString("zp.proceed"),OKRSettings.alertMsg.despcription=ZPI18N.getString("zp.cancelconfmsg"),OKRSettings.alertMsg.removeAfterYes=!0,OKRSettings.alertMsg.callback=function(){OKRSettings.alertMsg.remove(),OKRSettings.alertMsg=null,changeTabCall()},OKRSettings.alertMsg.show()):changeTabCall()},configurationInitialSet:{okrAdminSet:function(){var pageId=Layout.Page.container;if(pageId.find("#okradmins").hasClass("ztextbox__error")&&pageId.find("#okradmins").removeClass("ztextbox__error"),ZPeopleComponents.toggleswitch(pageId.find("#admintgbtn")).setAttributes({on:OKRSettings.IS_MODULEADMIN_ENABLED,change:OKRSettings.configurationInitialSet.chooseOkrAdmin}),OKRSettings.IS_MODULEADMIN_ENABLED){pageId.find("#chooseOkrAdmin").removeClass("zpl_DNI"),pageId.find("#roleSelect").removeClass("zpl_DNI"),ZPeopleComponents.isComponent(Layout.Page.container.find("#okradmins"))&&ZPeopleComponents.tokenfield(pageId.find("#okradmins")).destroy(),ZPeopleComponents.isComponent(Layout.Page.container.find("#okrNonAdmin"))&&ZPeopleComponents.select(pageId.find("#okrNonAdmin")).destroy();var tokenObj={},adminlist=OKRSettings.configurationInitialSet.getAdminOption(),selectedList=[];if(null!=OKRSettings.SEL_ADMIN_LIST){for(var j in adminlist)OKRSettings.SEL_ADMIN_LIST.includes(adminlist[j].id)&&selectedList.push(adminlist[j]);tokenObj.data=adminlist,tokenObj.contentType="text",tokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},tokenObj.search={by:"name"},tokenObj.allowDuplicateValues=!1,tokenObj.dropdownList={itemType:"checkbox"},tokenObj.placeholder=ZPI18N.getString("zp.selokrdmin"),tokenObj.values=selectedList,ZPeopleComponents.tokenfield(pageId.find("#okradmins"),tokenObj),pageId.find("#okradmins").on("ztokenfieldtokenadd",function(){pageId.find("#okradmins").hasClass("ztextbox__error")&&pageId.find("#okradmins").removeClass("ztextbox__error"),OKRSettings.okrSaveResetBtnConstruct("OKR_ADMINISTRATOR")}),pageId.find("#okradmins").on("ztokenfieldtokenremove",function(){pageId.find("#okradmins").hasClass("ztextbox__error")&&pageId.find("#okradmins").removeClass("ztextbox__error"),OKRSettings.okrSaveResetBtnConstruct("OKR_ADMINISTRATOR")})}}null!=OKRSettings.SEL_ROLEID&&(ZPeopleComponents.select(pageId.find("#okrNonAdmin")).setValue(OKRSettings.SEL_ROLEID),$(pageId.find("#okrNonAdmin").on("zselectchange",function(){OKRSettings.okrSaveResetBtnConstruct("OKR_ADMINISTRATOR")})))},chooseOkrAdmin:function(event){var pageId=Layout.Page.container;if(event.detail.state){if(ZPeopleComponents.isComponent(Layout.Page.container.find("#okradmins"))&&ZPeopleComponents.tokenfield(pageId.find("#okradmins")).destroy(),ZPeopleComponents.isComponent(Layout.Page.container.find("#okrNonAdmin"))&&ZPeopleComponents.select(pageId.find("#okrNonAdmin")).destroy(),pageId.find("#okradmins").hasClass("ztextbox__error")&&pageId.find("#okradmins").removeClass("ztextbox__error"),pageId.find("#chooseOkrAdmin").removeClass("zpl_DNI"),pageId.find("#roleSelect").removeClass("zpl_DNI"),OKRSettings.okrSaveResetBtnConstruct("OKR_ADMINISTRATOR"),null!=OKRSettings.ADMIN_LIST){var adminlist=OKRSettings.configurationInitialSet.getAdminOption(),tokenObj={};tokenObj.data=adminlist,tokenObj.contentType="text",tokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},tokenObj.search={by:"name"},tokenObj.allowDuplicateValues=!1,tokenObj.dropdownList={itemType:"checkbox"},tokenObj.placeholder=ZPI18N.getString("zp.selokrdmin"),ZPeopleComponents.tokenfield(pageId.find("#okradmins"),tokenObj),pageId.find("#okradmins").on("ztokenfieldtokenadd",function(){OKRSettings.okrSaveResetBtnConstruct("OKR_ADMINISTRATOR")}),pageId.find("#okradmins").on("ztokenfieldtokenremove",function(){OKRSettings.okrSaveResetBtnConstruct("OKR_ADMINISTRATOR")}),ZPeopleComponents.select(pageId.find("#okrNonAdmin"),{change:OKRSettings.okrSaveResetBtnConstruct("OKR_ADMINISTRATOR")})}}else OKRSettings.okrSaveResetBtnConstruct("OKR_ADMINISTRATOR"),pageId.find("#chooseOkrAdmin").addClass("zpl_DNI"),pageId.find("#roleSelect").addClass("zpl_DNI")},getAdminOption:function(){return null!==OKRSettings.ADMIN_LIST_OPTIONS&&""!==OKRSettings.ADMIN_LIST_OPTIONS||(OKRSettings.ADMIN_LIST_OPTIONS=[],$.each(OKRSettings.ADMIN_LIST,function(index,data){var Obj={};Obj.name=ZPeople.decodeTxt(data.EMPNAME),Obj.id=data.ERECNO,OKRSettings.ADMIN_LIST_OPTIONS.push(Obj)})),OKRSettings.ADMIN_LIST_OPTIONS},constructOkrAdministratorsDiv:function(){var pageId=Layout.Page.container;if(OKRSettings.ISSUPERADMIN){var roleoption="";null!=OKRSettings.ROLE_LIST&&""!=OKRSettings.ROLE_LIST&&$(OKRSettings.ROLE_LIST).each(function(index,data){roleoption+='<option value="'+data.roleID+'">'+data.roleName+"</option>"});var html='<div class="zpl_crd" ><div class="zpl_crdhdr" id="OKRadminsettinghdr"><div><h4>'+ZPI18N.getString("zp.okradmin")+"</h4><p>"+ZPI18N.getString("zp.okrAdmindesc")+'</p></div><div id="OKR_ADMINISTRATOR_SAVERESET" class="zpl_DNI"></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div class="zpl_tgsprt"><h4 class="zpl_tgl"><input class="togBtn" id="admintgbtn">'+ZPI18N.getString("zp.moduleadmin")+"</h4><p>"+ZPI18N.getString("zp.OKRadmininfo")+'</p></div></div><div class="zpl_secn zpl_DNI" id="chooseOkrAdmin"><div><h4>'+ZPI18N.getString("zp.chooseokradmin")+'</h4></div><div><div class="w200"><textarea id="okradmins"></textarea></div></div></div><div class="zpl_secn zpl_DNI" id="roleSelect"><div><h4>'+ZPI18N.getString("zp.setOthRoleforadmin")+"</h4><p>"+ZPI18N.getString("zp.okrnonadmininfo")+'</p></div><div><div class="zpl_idiv w200"><select id="okrNonAdmin">'+roleoption+"</select></div></div></div></div></div>";pageId.find("#permissiondiv").append(html),OKRSettings.configurationInitialSet.okrAdminSet()}}},permissionInit:function(){var pageId=settingsPage.container;ZPeopleComponents.isComponent(Layout.Page.container.find("#okrNonAdmin"))&&ZPeopleComponents.select(pageId.find("#okrNonAdmin")).destroy(),ZPeopleComponents.isComponent(Layout.Page.container.find("#okradmins"))&&ZPeopleComponents.tokenfield(pageId.find("#okradmins")).destroy(),pageId.html(OKRSettings.permissionInitPage()),OKRCommon.ajaxCall.getCalltype(!1,"/okrSettings/getPermissionData",{},OKRSettings.getPermDataSuccessFn)},permissionInitPage:function(){return null!==OKRSettings.PERMISSION_INIT_PAGE&&void 0!==OKRSettings.PERMISSION_INIT_PAGE||OKRCommon.ajaxCall.postCallType(!1,"/getPermissionSet.zp",{},function(resultdata){OKRSettings.PERMISSION_INIT_PAGE=resultdata}),OKRSettings.PERMISSION_INIT_PAGE},getPermDataSuccessFn:function(resultData){if(void 0!=resultData.issuperAdmin&&(OKRSettings.ISSUPERADMIN=resultData.issuperAdmin),void 0!=resultData.adminList&&(OKRSettings.ADMIN_LIST=resultData.adminList),void 0!=resultData.roleList&&(OKRSettings.ROLE_LIST=resultData.roleList),void 0!=resultData.customAdminDetails){var cusAdminDet=resultData.customAdminDetails;void 0!=cusAdminDet.isModuleAdminEnabled&&null!=cusAdminDet.isModuleAdminEnabled&&(OKRSettings.IS_MODULEADMIN_ENABLED=cusAdminDet.isModuleAdminEnabled),void 0!=cusAdminDet.selAdminList&&null!=cusAdminDet.selAdminList&&cusAdminDet.selAdminList.length>0&&(OKRSettings.SEL_ADMIN_LIST=cusAdminDet.selAdminList),void 0!=cusAdminDet.selRole&&null!=cusAdminDet.selRole&&(OKRSettings.SEL_ROLEID=cusAdminDet.selRole)}OKRSettings.setOkrpermissions()},setOkrpermissions:function(){OKRSettings.ISSUPERADMIN&&OKRSettings.configurationInitialSet.constructOkrAdministratorsDiv()}};