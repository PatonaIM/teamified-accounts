var PMSSetting={ON_LOAD_TMPL_LST_PAGE:null,LOAD_TMPL_DATA:null,goalKraGoalSettingData:null,ENABLED_MODULES:{},CONF_DETAILS:{},SEL_ENABLED_MODULES:{},INITIAL_KRA_ENABLE:!1,OLD_OPTION:-1,GOAL_DISPLAY_NAME:ZPI18N.getString("zp.goals"),KRA_DISPLAY_NAME:ZPI18N.getString("zp.kra"),KRA_GOAL_DISPLAY_NAME:ZPI18N.getString("zp.kravsgoals"),SKILLSET_DISPLAY_NAME:ZPI18N.getString("zp.skillset"),FEEDBACK_DISPLAY_NAME:ZPI18N.getString("zp.feedback"),COMPETENCY_DISPLAY_NAME:ZPI18N.getString("zp.competency"),SUMMARY_DISPLAY_NAME:ZPI18N.getString("zp.summary"),QUS_ANS_DISPLAY_NAME:ZPI18N.getString("zp.questionnaire"),SALARY_DISPLAY_NAME:ZPI18N.getString("zp.salary"),MULTIRATER_DISPLAY_NAME:ZPI18N.getString("zp.multi"),FEEDBACK_IMAGES:{0:"PI_like grn",1:"PI_unlike red",2:"PI_star red",3:"PI_eye dgry",4:"PI_award ylw"},COMPONENTS:{REPORTING_TO:ZPI18N.getString("zp.reportingto"),PEER_TO_PEER:ZPI18N.getString("zp.peertopeer"),"360_FEEDBACK":ZPI18N.getString("zp.360degree"),FEEDBACK:ZPI18N.getString("zp.feedback"),GOALS:ZPI18N.getString("zp.goals"),SKILLSET:ZPI18N.getString("zp.skillset"),SUMMARY:ZPI18N.getString("zp.summary"),SELFAPPRAISALFORM:ZPI18N.getString("zp.selfappraisal"),KRA:ZPI18N.getString("zp.kra"),KRA_GOALS:ZPI18N.getString("zp.kravsgoals"),COMPETENCY:ZPI18N.getString("zp.competency"),QUS_ANS:ZPI18N.getString("zp.questionnaire")},ORIG_COMPONENTS:{FEEDBACK:ZPI18N.getString("zp.feedback"),GOALS:ZPI18N.getString("zp.goals"),SKILLSET:ZPI18N.getString("zp.skillset"),SUMMARY:ZPI18N.getString("zp.summary"),KRA:ZPI18N.getString("zp.kra"),COMPETENCY:ZPI18N.getString("zp.competency"),KRA_GOALS:ZPI18N.getString("zp.kravsgoals"),SALARY:ZPI18N.getString("zp.salary")},LEFT_TAB_URL:{FEEDBACK:"settings/service/performance/feedback",SKILLSET:"settings/service/performance/skillset",KRA:"settings/service/performance/kra",GOAL:"settings/service/performance/goal",COMPETENCY:"settings/service/performance/competency",SALARY:"settings/service/performance/salary"},skilldispName:ZPI18N.getString("zp.skill"),revieworderdefault:{},feedback_types:null,userSkillMapFormId:null,isUserSkillMap_apprConf:null,userSkillMapApprovalId:null,kraUserFormId:null,isKraUserApprConf:null,kraUserApprovalId:null,skillsetDefaultObject:null,kraGoalDefaultObject:null,feedbackDefaultObject:null,compDefaultObject:null,reviewSetdefaultObject:null,reportSetdefaultObject:null,otherSetDefaultObject:null,PERVSPOT_NAMES:"SECTION_PERVSPOTNAMES",SECTION_EXPORTTXT:"SECTION_EXPORTTXT",SECTION_ORDERREVIEW:"SECTION_ORDERREVIEW",SECTION_CUSTOMFEEDBACKOPTION:"SECTION_CUSTOMFEEDBACKOPTION",SECTION_RENAMETERM:"SECTION_RENAMETERM",SECTION_SKILLPOTENTIAL:"SECTION_SKILLPOTENTIAL",SECTION_GOALPERIOD_SETTINGS:"SECTION_GOALPERIOD_SETTINGS",CONTINUOUS_REVIEW:"CONTINUOUS_REVIEW",SECTION_APPRAISALCYLE:"SECTION_APPRAISALCYLE",SECTION_GOALDATETYPE:"SECTION_GOALDATETYPE",CFS_EMP_LKUP:null,CFS_DATA:null,POPULATE_PAST_DATE_FLAG:!1,GRP_ADMIN_DATA:null,CUSTOM_DATA_VISIBLE:!1,CUSTOM_DATA:null,IS_CUSTOMADMIN_ENABLE:null,ADMIN_USERS_LIST:null,ADMIN_USERS_LIST_OPTIONS:null,SEL_ADMIN_USER_LIST:null,SELECTED_ROLE:null,ROLE_LIST:null,ROLE_LIST_OPTIONS:null,EMP_LKUP:null,ALREADY_EXIST_EMP_LKUP:[],GRP_ADMIN_DATA:!1,REVIEW_HISTORY_ENABLE:!1,GRP_ADMIN_MODAL_ID:"cstgrpadmmodalid",skillScoreNames:{},SECTION_KRA:"KRA",SECTION_GOALS:"GOALS",SECTION_FEEDBACK:"FEEDBACK",SECTION_SKILSET:"SKILLSET",SECTION_COMPETENCY:"COMPETENCY",SECTION_SUMMARY:"SUMMARY",SECTION_QUESANS:"QUESTIONANS",SECTION_KRA_GOALS:"KRA_GOALS",SECTION_CUSTOMNAME:"CUSTOMNAME",configurationData:null,CR_APPLI_KEYS:[ZPComponent.CONSTANTS.DEPARTMENTS,ZPComponent.CONSTANTS.DESIGNATIONS,ZPComponent.CONSTANTS.LOCATIONS,ZPComponent.CONSTANTS.ROLES],CR_APPLI_KEYS_OBJ:{APPL_DEP:ZPI18N.getString("zp.departments"),APPL_DES:ZPI18N.getString("zp.designations"),APPL_LOC:ZPI18N.getString("zp.locations"),APPL_ROLE:ZPI18N.getString("zp.roles")},CFS_APPLI_KEYS:[ZPComponent.CONSTANTS.DEPARTMENTS,ZPComponent.CONSTANTS.DESIGNATIONS,ZPComponent.CONSTANTS.LOCATIONS,ZPComponent.CONSTANTS.ROLES,ZPComponent.CONSTANTS.EMPLOYEETYPES],CFS_APPLI_KEYS_OBJ:{APPL_DEP:ZPI18N.getString("zp.departments"),APPL_DES:ZPI18N.getString("zp.designations"),APPL_LOC:ZPI18N.getString("zp.locations"),APPL_ROLE:ZPI18N.getString("zp.roles"),APPL_EMP_TYPE:ZPI18N.getString("zp.employeeType")},ALL_LOCATIONS:null,ALL_ROLES:null,ALL_DEPARTMENTS:null,ALL_DESIGNATION:null,ALL_EMPLOYEE_TYPES:null,ADD_EXCEP_BT:'<div class="zpl_idiv" id="addNonCondtDiv"><a class="zlabel zlabel--blue zlabel--outline zlabel--medium " onclick="PMSSetting.addNonApplicable();">'+ZPI18N.getString("zp.addexemptions")+"</a></div>",GAOLADD_EXCEP_BT:'<div class="zpl_idiv" id="goal_addNonCondtDiv"><a class="zlabel zlabel--blue zlabel--outline zlabel--medium " onclick="PMSSetting.addNonApplicable();">'+ZPI18N.getString("zp.addexemptions")+"</a></div>",CR_NON_APPLI_LST:["APPL_DEP","APPL_DES","APPL_LOC","APPL_ROLE"],LOADINGHTM:'<div> <div class="zpl_atosv"> <div class="zpl_atocnt"> <div class="zpl_atoprg"> <div></div> <div></div> <div></div> <div></div> <div></div> </div> <i class="PI_tick2"></i> <span>'+ZPI18N.getString("zp.saving")+"</span> </div> </div> </div>",SAVEDHTM:'<div> <div class="zpl_atosv"> <div class="zpl_atocnt svd"> <div class="zpl_atoprg"> <div></div> <div></div> <div></div> <div></div> <div></div> </div> <i class="PI_tick2"></i> <span>Saved</span> </div> </div> </div>',FEEDBACK_MENUOBJ:{},TMPL_MORE_MENU:{},CUSTOM_NAMES:null,FDBK_EDIT_OPEN:!1,KRA_INIT_PAGE:null,GOAL_INIT_PAGE:null,paReminderTemplate:{},paReminderTemplateMode:"paCustomizeTemplate",PA_REVIEWTYPE:null,rating_keyarray:[],textrating_name:[],textrating_value:[],CFS_Notify_Tmpl:{},CFSTemplateMode:"cfsCustomizeTemplate",PA_Editor_Id:"editorTextArea_",ON_LOAD_CR_SET_PAGE:null,potentialobj:{},unchangedpotential:{},DateForGS:{},IS_MR_ENABLED:!1,IS_APPRAISAL_ESIGN_ENABLED:!1,IS_CR_CYCLE_ENABLED:!0,goalPriorityOptn:{},goalPriorityCode:["PA_GP_LOW","PA_GP_MDM","PA_GP_HIG","PA_GP_HIST"],goalPriorityEnable:!1,GS_MONTHLY_DAYS_LIMIT:28,GS_QUARTERLY_DAYS_LIMIT:45,GS_HALFYEARLY_DAYS_LIMIT:90,GS_YEARLY_DAYS_LIMIT:180,GS_MONTHLY_FREQUENCY:3,GS_QUARTERLY_FREQUENCY:5,GS_HALFYEARLY_FREQUENCY:6,GS_YEARLY_FREQUENCY:4,POPULATE_VALUE:{},POPULATE_VALUE_TYPE:0,POPULATE_VALUE_INDEX:1,isGoalSettingOldFlowStrict:!1,getKRAPopulateCheckRange:function(){var params={mode:"paQueueProcess"};PMSSetting.POPULATE_VALUE_INDEX=PMSSetting.POPULATE_VALUE_INDEX+10,params.sIndex=PMSSetting.POPULATE_VALUE_INDEX,PMSSetting.POPULATE_VALUE={},ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(data){PMSSetting.POPULATE_VALUE=data});var type=PMSSetting.POPULATE_VALUE_TYPE,resultData=PMSSetting.POPULATE_VALUE;if(void 0!=resultData){if(void 0!=type&&0==type)$.each(resultData.countList.orgRuleUser,function(data){var org=resultData.countList.orgRuleUser[data],kraRule=resultData.countList.kra_user[data];header+="<tr>",header+="<td><span>"+org.type+"</span></td>";var typeVal="";if(void 0!=org.des&&(typeVal+="Designation : "+org.des),void 0!=org.dep){var val="Department : "+org.dep;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=org.level){val="Level : "+org.level;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=org.loc){val="Location : "+org.loc;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=org.rule){val="Designation : "+org.rule;typeVal=""!=typeVal?typeVal+val:val}header+="<td><span >"+typeVal+"</span></td>",header+="<td><span >"+org.empCount+"</span></td>",header+="<td><span >"+org.kraCount+"</span></td>",void 0!=kraRule?(header+="<td><span>"+kraRule.count+"</span></td>",header+="<td><span>"+kraRule.autoPopCount+"</span></td>",header+="<td><span>"+kraRule.kraUserRowPassed+"</span></td>",header+="<td><span>"+kraRule.autoPopPassed+"</span></td>"):(header+="<td><span>-</span></td>",header+="<td><span>-</span></td>",header+="<td><span>-</span></td>",header+="<td><span>-</span></td>"),header+="</tr>"}),header+="";else if(1==type){var header="";$.each(resultData.tasks,function(data){data=resultData.tasks[data],header+="<tr>",header+="<td><span>"+data.operation+"</span></td>",header+="<td><span >"+data.status+"</span></td>",header+="<td><span >"+data.taskType+"</span></td>",header+="<td><span >"+data.subTasks+"</span></td>",header+="<td><span>"+data.completedTasks+"</span></td>",header+="<td><span>"+data.taskId+"</span></td>",header+="<td><span>"+data.parentTaskId+"</span></td>",header+="<td><span>"+data.info+"</span></td>",header+="</tr>"}),header+=""}else if(3==type){header="";$.each(resultData.countList.kra_user_value,function(data){data=resultData.countList.kra_user_value[data],$.each(data,function(value1){value1=data[value1],header+="<tr>",header+="<td><span>"+value1.empFName+"</span></td>",header+="<td><span >"+value1.empLName+"</span></td>";var typeVal="";if(void 0!=value1.des&&(typeVal+="Designation : "+value1.des),void 0!=value1.dep){var val="Department : "+value1.dep;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=value1.level){val="Level : "+value1.level;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=value1.loc){val="Location : "+value1.loc;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=value1.rule){val="Designation : "+value1.rule;typeVal=""!=typeVal?typeVal+val:val}header+="<td><span >"+typeVal+"</span></td>",header+="<td><span >"+value1.kraCount+"</span></td>",header+="<td><span>"+value1.count+"</span></td>",header+="<td><span >"+value1.isVisCount+"</span></td>",header+="<td><span>"+value1.autoPopCount+"</span></td>",header+="</tr>"})})}Layout.Page.container.find("#cardview-mapcontent tbody").append(header);new FireScrollBack(PMSSetting.getKRAPopulateCheckRange,settingsPage.container,"cardview-mapcontent")}},getKRAPopulateCheck:function(isRun,type,isRefresh){var params={mode:"paQueueProcess"};void 0!=isRun&&(params.isRun=isRun),PMSSetting.POPULATE_VALUE_TYPE=type,PMSSetting.POPULATE_VALUE_INDEX=1,(0==Object.keys(PMSSetting.POPULATE_VALUE).length||isRefresh)&&ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(data){PMSSetting.POPULATE_VALUE=data});var resultData=PMSSetting.POPULATE_VALUE;if(void 0!=resultData){if(Layout.Page.container.find("#cardview-mapcontent").empty(),void 0!=type&&0==type){var header='<table class="zpl_tbl"><thead><tr>';header+="<th ><div><span>Type</span></div></th>",header+="<th ><div><span>Name of the Type</span></div></th>",header+="<th ><div><span>Number of Employees</span></div></th>",header+="<th ><div><span>Number of KRAs in Rule</span></div></th>",header+="<th ><div><span>Number of KRAs added to the user</span></div></th>",header+="<th ><div><span>Number of AutoPopulation Rows</span></div></th>",header+="<th ><div><span>Valid KRA Rows</span></div></th>",header+="<th ><div><span>Valid AutoPopulation Rows</span></div></th>",header+="</tr></thead>",header+="<tbody >",$.each(resultData.countList.orgRuleUser,function(data){var org=resultData.countList.orgRuleUser[data],kraRule=resultData.countList.kra_user[data];header+="<tr>",header+="<td><span>"+org.type+"</span></td>";var typeVal="";if(void 0!=org.des&&(typeVal+="Designation : "+org.des),void 0!=org.dep){var val="Department : "+org.dep;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=org.level){val="Level : "+org.level;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=org.loc){val="Location : "+org.loc;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=org.rule){val="Designation : "+org.rule;typeVal=""!=typeVal?typeVal+val:val}header+="<td><span >"+typeVal+"</span></td>",header+="<td><span >"+org.empCount+"</span></td>",header+="<td><span >"+org.kraCount+"</span></td>",void 0!=kraRule?(header+="<td><span>"+kraRule.count+"</span></td>",header+="<td><span>"+kraRule.autoPopCount+"</span></td>",header+="<td><span>"+kraRule.kraUserRowPassed+"</span></td>",header+="<td><span>"+kraRule.autoPopPassed+"</span></td>"):(header+="<td><span>-</span></td>",header+="<td><span>-</span></td>",header+="<td><span>-</span></td>",header+="<td><span>-</span></td>"),header+="</tr>"}),header+="</tbody></table>"}else if(1==type){header='<table class="zpl_tbl"><thead><tr>';header+="<th ><div><span>Operation</span></div></th>",header+="<th ><div><span>Status</span></div></th>",header+="<th ><div><span>Task Type</span></div></th>",header+="<th ><div><span>Sub Tasks</span></div></th>",header+="<th ><div><span>Completed Sub Tasks</span></div></th>",header+="<th ><div><span>Task Id</span></div></th>",header+="<th ><div><span>Parent Task Id</span></div></th>",header+="<th ><div><span>Info</span></div></th>",header+="</tr></thead>",header+="<tbody >",$.each(resultData.tasks,function(data){data=resultData.tasks[data],header+="<tr>",header+="<td><span>"+data.operation+"</span></td>",header+="<td><span >"+data.status+"</span></td>",header+="<td><span >"+data.taskType+"</span></td>",header+="<td><span >"+data.subTasks+"</span></td>",header+="<td><span>"+data.completedTasks+"</span></td>",header+="<td><span>"+data.taskId+"</span></td>",header+="<td><span>"+data.parentTaskId+"</span></td>",header+="<td><span>"+data.info+"</span></td>",header+="</tr>"}),header+="</tbody></table>"}else if(3==type){header='<table class="zpl_tbl"><thead><tr>';header+="<th ><div><span>Employee First Name</span></div></th>",header+="<th ><div><span>Employee Last Name</span></div></th>",header+="<th ><div><span>Type Values</span></div></th>",header+="<th ><div><span>KRA Count</span></div></th>",header+="<th ><div><span>User KRA Count</span></div></th>",header+="<th ><div><span>Is Visible KRA Count</span></div></th>",header+="<th ><div><span>Auto Pop Count</span></div></th>",header+="</tr></thead>",header+="<tbody >",$.each(resultData.countList.kra_user_value,function(data){data=resultData.countList.kra_user_value[data],$.each(data,function(value1){value1=data[value1],header+="<tr>",header+="<td><span>"+value1.empFName+"</span></td>",header+="<td><span >"+value1.empLName+"</span></td>";var typeVal="";if(void 0!=value1.des&&(typeVal+="Designation : "+value1.des),void 0!=value1.dep){var val="Department : "+value1.dep;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=value1.level){val="Level : "+value1.level;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=value1.loc){val="Location : "+value1.loc;typeVal=""!=typeVal?typeVal+val:val}if(void 0!=value1.rule){val="Designation : "+value1.rule;typeVal=""!=typeVal?typeVal+val:val}header+="<td><span >"+typeVal+"</span></td>",header+="<td><span >"+value1.kraCount+"</span></td>",header+="<td><span>"+value1.count+"</span></td>",header+="<td><span >"+value1.isVisCount+"</span></td>",header+="<td><span>"+value1.autoPopCount+"</span></td>",header+="</tr>"})}),header+="</tbody></table>"}Layout.Page.container.find("#cardview-mapcontent").html(header);new FireScrollBack(PMSSetting.getKRAPopulateCheckRange,settingsPage.container,"cardview-mapcontent")}},updateLeftTabs:function(actModuleObj,isFromModuleRename){let kraObj=actModuleObj.KRA,goalObj=actModuleObj.GOALS,kgObj=actModuleObj.KRA_GOALS,tabIndex=1,isCompEnabled=1===kraObj.enable||1===kgObj.enable,moduleDisplayName=PMSSetting.getLeftTabModuleDisplayName(kraObj.rawComDisplayName,PMSSetting.KRA_DISPLAY_NAME);tabIndex=PMSSetting.checkAndUpdateLeftTab(1,tabIndex,"settings/service/performance/kra",isCompEnabled,moduleDisplayName,isFromModuleRename),isCompEnabled=1===goalObj.enable||1===kgObj.enable,moduleDisplayName=PMSSetting.getLeftTabModuleDisplayName(goalObj.rawComDisplayName,PMSSetting.GOAL_DISPLAY_NAME),tabIndex=PMSSetting.checkAndUpdateLeftTab(1,tabIndex,"settings/service/performance/goal",isCompEnabled,moduleDisplayName,isFromModuleRename);let fdb=actModuleObj.FEEDBACK;isCompEnabled=1===fdb.enable,moduleDisplayName=PMSSetting.getLeftTabModuleDisplayName(fdb.rawComDisplayName,PMSSetting.FEEDBACK_DISPLAY_NAME),tabIndex=PMSSetting.checkAndUpdateLeftTab(1,tabIndex,"settings/service/performance/feedback",isCompEnabled,moduleDisplayName,isFromModuleRename);let skillS=actModuleObj.SKILLSET;isCompEnabled=1===skillS.enable,moduleDisplayName=PMSSetting.getLeftTabModuleDisplayName(skillS.rawComDisplayName,PMSSetting.SKILLSET_DISPLAY_NAME),tabIndex=PMSSetting.checkAndUpdateLeftTab(1,tabIndex,"settings/service/performance/skillset",isCompEnabled,moduleDisplayName,isFromModuleRename);let competency=actModuleObj.COMPETENCY;isCompEnabled=1===competency.enable,moduleDisplayName=PMSSetting.getLeftTabModuleDisplayName(competency.rawComDisplayName,PMSSetting.COMPETENCY_DISPLAY_NAME),tabIndex=PMSSetting.checkAndUpdateLeftTab(1,tabIndex,"settings/service/performance/competency",isCompEnabled,moduleDisplayName,isFromModuleRename)},checkAndUpdateLeftTab:function(topTabIndex,tabIndex,compUrl,isCompEnabled,compName,isFromModuleRename){let mainWrp=Layout.Page.pageContWrapper.find("[name=lefttab]>ul");return currTab=mainWrp.find("li[tlhash='"+compUrl+"']"),isCompEnabled?(isFromModuleRename&&void 0!==currTab[0]&&settingsPage.removeLeftTab(topTabIndex,currTab.prevAll("li").length+1),(void 0===currTab[0]||isFromModuleRename&&void 0!==currTab[0])&&settingsPage.addLeftTabs(topTabIndex,tabIndex,[{tabURL:compUrl,dispName:compName}]),tabIndex++):void 0!==currTab[0]&&settingsPage.removeLeftTab(topTabIndex,currTab.prevAll("li").length+1),tabIndex},getLeftTabModuleDisplayName:function(customDisplayName,moduleDisplayName){return void 0!==customDisplayName&&null!==customDisplayName&&"null"!==customDisplayName&&""!==customDisplayName?customDisplayName:moduleDisplayName},validateModuleStatus:function(moduleName){PMSSetting.getPerformanceModules();let kraVsGoalObj=void 0,ispermDenied=!1;return"KRA"!==moduleName&&"Goals"!==moduleName||(kraVsGoalObj=PMSSetting.ENABLED_MODULES.KRA_GOALS),"KRA"===moduleName&&0==PMSSetting.ENABLED_MODULES.KRA.enable&&0==kraVsGoalObj.enable?ispermDenied=!0:"Goals"===moduleName&&0==PMSSetting.ENABLED_MODULES.GOALS.enable&&0==kraVsGoalObj.enable?ispermDenied=!0:"FeedBack"===moduleName&&0==PMSSetting.ENABLED_MODULES.FEEDBACK.enable?ispermDenied=!0:"SkillSet"===moduleName&&0==PMSSetting.ENABLED_MODULES.SKILLSET.enable?ispermDenied=!0:"Competency"===moduleName&&0==PMSSetting.ENABLED_MODULES.COMPETENCY.enable&&(ispermDenied=!0),ispermDenied?(PMSCommon.showHidePermissionDenied(!0),!0):(PMSCommon.showHidePermissionDenied(!1),!1)},getPerformanceModules:function(isFromModuleRename){ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"getPerformanceModules"},function(resultData){PMSSetting.ENABLED_MODULES=resultData.perfModules,PMSSetting.updatedDisplayName(),delete resultData.perfModules,PMSSetting.CONF_DETAILS=resultData}),PMSSetting.updateLeftTabs(PMSSetting.ENABLED_MODULES,isFromModuleRename)},getSelPerformanceModules:function(refresh){if(refresh||null===PMSSetting.SEL_ENABLED_MODULES||Object.keys(PMSSetting.SEL_ENABLED_MODULES).length<=0){ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"getPerformanceModules",type:"SEL"},function(resultData){PMSSetting.SEL_ENABLED_MODULES=resultData.perfModules;var obj=PMSSetting.SEL_ENABLED_MODULES.KRA;void 0!==obj.displayName&&(PMSSetting.KRA_DISPLAY_NAME=obj.displayName),void 0!==(obj=PMSSetting.SEL_ENABLED_MODULES.GOALS).displayName&&(PMSSetting.GOAL_DISPLAY_NAME=obj.displayName)})}},updatedDisplayName:function(){var obj=PMSSetting.ENABLED_MODULES.KRA;void 0!==obj.displayName&&(PMSSetting.KRA_DISPLAY_NAME=obj.displayName),void 0!==(obj=PMSSetting.ENABLED_MODULES.GOALS).displayName&&(PMSSetting.GOAL_DISPLAY_NAME=obj.displayName),void 0!==(obj=PMSSetting.ENABLED_MODULES.FEEDBACK).displayName&&(PMSSetting.FEEDBACK_DISPLAY_NAME=obj.displayName),void 0!==(obj=PMSSetting.ENABLED_MODULES.COMPETENCY).displayName&&(PMSSetting.COMPETENCY_DISPLAY_NAME=obj.displayName),void 0!==(obj=PMSSetting.ENABLED_MODULES.SKILLSET).displayName&&(PMSSetting.SKILLSET_DISPLAY_NAME=obj.displayName),void 0!==(obj=PMSSetting.ENABLED_MODULES.SUMMARY).displayName&&(PMSSetting.SUMMARY_DISPLAY_NAME=obj.displayName),void 0!==(obj=PMSSetting.ENABLED_MODULES.SALARY).displayName&&(PMSSetting.SALARY_DISPLAY_NAME=obj.displayName),void 0!==(obj=PMSSetting.ENABLED_MODULES.QUS_ANS).displayName&&(PMSSetting.QUS_ANS_DISPLAY_NAME=obj.displayName),PMSSetting.MULTIRATER_DISPLAY_NAME=PMSSetting.CONF_DETAILS.multiraterName},generalSettingInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"isSettAccesssible"},function(resultData){if(resultData.isPageAccess){if(PMSOperationCommon.addClearCentreClass(!0),0==pageId.find("#pmsettingsdiv").length){PMSSetting.getPerformanceModules();var obj=PMSSetting.ENABLED_MODULES.KRA,kraCompName=obj.compName;void 0!==obj.displayName&&(PMSSetting.KRA_DISPLAY_NAME=obj.displayName);var html='<div class="zpl_rgtcnt" id="pmsettingsdiv"><div class="zpl_crd" ><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.pa.kra.perfmethodtabhdr")+"</h4><p>"+ZPI18N.getString("zp.pa.kra.perfmethodtabdesc")+'</p></div></div><div class="zpl_crdcnt zpl_crdinfo"></div></div>';pageId.append(html),html='<div><div id="KRAGOALS" class="zpl_secn">',html+='<div><div class="zpl_tgsprt"><h5 class="zpl_tgl"><input id="tg_kragoal" class="togBtn" style="display: none;" compName="KRAGOALS">',html+=ZPI18N.getString("zp.kraandgoals")+"</h5>",html+="<p>"+ZPI18N.getString("zp.pa.kra.kraandgoalsdesc")+"</p></div>",html+='<div class="zpl_tbox zpl_chytpekragls"><h5><em>'+ZPI18N.getString("zp.pa.kra.chotype")+"</em></h5>",html+='<div class="zpl_gbox"><div id="cardDisable" class="zpl_crdlst">',html+='<div class="zpl_catlst" name="modOpts"><div class="chkdectxt">',html+='<div class="zradiobutton"> <input value="1" type="radio" id="kraRdBtn" name="kragoaloption" data-text="KRA" value="1" class="zradiobutton__helper">';let isSameNme=PMSSetting.COMPONENTS[obj.compName].trim()===PMSSetting.KRA_DISPLAY_NAME.trim();html+='<label class="zradiobutton__label" for="kraRdBtn"><span class="zradiobutton__text">'+PMSSetting.COMPONENTS[obj.compName],isSameNme||(html+="&nbsp;("+PMSSetting.KRA_DISPLAY_NAME+")"),html+="</span></label> </div>",html+='<span class="dectxt">'+ZPI18N.getString("zp.pa.kra.ctypekra")+"</span></div></div>";var goalCompName=(obj=PMSSetting.ENABLED_MODULES.GOALS).compName;void 0!==obj.displayName&&(PMSSetting.GOAL_DISPLAY_NAME=obj.displayName),html+='<div class="zpl_catlst" name="modOpts"><div class="chkdectxt">',html+='<div class="zradiobutton"><input value="2" type="radio" id="goalRdBtn" name="kragoaloption" data-text="Goals" value="2" class="zradiobutton__helper">',isSameNme=PMSSetting.COMPONENTS[obj.compName].trim()===PMSSetting.GOAL_DISPLAY_NAME.trim(),html+='<label class="zradiobutton__label" for="goalRdBtn"><span class="zradiobutton__text">'+PMSSetting.COMPONENTS[obj.compName],isSameNme||(html+="&nbsp;("+PMSSetting.GOAL_DISPLAY_NAME+")"),html+="</span></label></div>",html+='<span class="dectxt">'+ZPI18N.getString("zp.pa.kra.ctypegoals")+"</span></div></div>",html+='<div class="zpl_catlst" name="modOpts"><div class="chkdectxt">',html+='<div class="zradiobutton"><input value="3" type="radio" id="kraGoalRdBtn" name="kragoaloption" data-text="KRA and GOALS" value="3" class="zradiobutton__helper">',html+='<label class="zradiobutton__label" for="kraGoalRdBtn"><span class="zradiobutton__text">'+(PMSSetting.COMPONENTS[kraCompName]+" "+ZPI18N.getString("zp.and.small")+" "+PMSSetting.COMPONENTS[goalCompName])+"</span></label></div>",html+='<span class="dectxt">'+ZPI18N.getString("zp.pa.kra.ctypekraandgoals")+"</span></span></div></div>",void 0!==(obj=PMSSetting.ENABLED_MODULES.KRA_GOALS).displayName&&(PMSSetting.KRA_GOAL_DISPLAY_NAME=obj.displayName),html+='<div class="zpl_catlst" name="modOpts"><div class="chkdectxt">',html+='<div class="zradiobutton"><input value="4" type="radio" id="kraVsGoalRdBtn" name="kragoaloption" data-text="kra vs goals" value="4" class="zradiobutton__helper">',isSameNme=PMSSetting.COMPONENTS[obj.compName].trim()===PMSSetting.KRA_GOAL_DISPLAY_NAME.trim(),html+='<label class="zradiobutton__label" for="kraVsGoalRdBtn"><span class="zradiobutton__text">'+PMSSetting.COMPONENTS[obj.compName],isSameNme||(html+="&nbsp;("+PMSSetting.KRA_GOAL_DISPLAY_NAME+")"),html+="</span></label></div>",html+='<span class="dectxt">'+ZPI18N.getString("zp.pa.kra.ctypekravsgoals")+"</span></div></div>",html+='</div><div class="MLauto kgPrevT"></div>',html+="</div></div></div>",html+='<div id="FEEDBACK" class="zpl_secn"><div> <div class="zpl_tgsprt"><h5 class="zpl_tgl"><input id="tg_fdbck" class="togBtn" compName="FEEDBACK" style="display: none;">',void 0!==(obj=PMSSetting.ENABLED_MODULES.FEEDBACK).displayName&&(PMSSetting.FEEDBACK_DISPLAY_NAME=obj.displayName),isSameNme=PMSSetting.FEEDBACK_DISPLAY_NAME.trim()==PMSSetting.FEEDBACK_DISPLAY_NAME.trim(),html+=""+PMSSetting.FEEDBACK_DISPLAY_NAME,isSameNme||(html+="&nbsp;("+PMSSetting.FEEDBACK_DISPLAY_NAME+")"),html+="</h5><p>"+ZPI18N.getString("zp.pa.feedback.feedbackdesc",new Array(PMSSetting.FEEDBACK_DISPLAY_NAME))+"</p></div></div></div>",html+='<div id="SKILLSET" class="zpl_secn"><div> <div class="zpl_tgsprt"><h5 class="zpl_tgl"><input id="tg_skillset" class="togBtn" compName="SKILLSET" style="display: none;">',void 0!==(obj=PMSSetting.ENABLED_MODULES.SKILLSET).displayName&&(PMSSetting.SKILLSET_DISPLAY_NAME=obj.displayName),isSameNme=PMSSetting.SKILLSET_DISPLAY_NAME.trim()==PMSSetting.SKILLSET_DISPLAY_NAME.trim(),html+=""+PMSSetting.SKILLSET_DISPLAY_NAME,isSameNme||(html+="&nbsp;("+PMSSetting.SKILLSET_DISPLAY_NAME+")"),html+="</h5><p>"+ZPI18N.getString("zp.pa.skillset.sillsetdesc")+"</p></div></div></div>",html+='<div id="COMPETENCY" class="zpl_secn"><div> <div class="zpl_tgsprt"><h5 class="zpl_tgl"><input id="tg_compet" class="togBtn" compName="COMPETENCY" style="display: none;">',void 0!==(obj=PMSSetting.ENABLED_MODULES.COMPETENCY).displayName&&(PMSSetting.COMPETENCY_DISPLAY_NAME=obj.displayName),isSameNme=PMSSetting.COMPETENCY_DISPLAY_NAME.trim()==PMSSetting.COMPETENCY_DISPLAY_NAME.trim(),html+=""+PMSSetting.COMPETENCY_DISPLAY_NAME,isSameNme||(html+="&nbsp;("+PMSSetting.COMPETENCY_DISPLAY_NAME+")"),html+="</h5><p>"+ZPI18N.getString("zp.pa.competency.compdesc",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME))+"</p></div></div></div>",html+='<div id="SUMMARY" class="zpl_secn"><div> <div class="zpl_tgsprt"><h5 class="zpl_tgl"><input id="tg_summary" class="togBtn" compName="SUMMARY" style="display: none;" >',void 0!==(obj=PMSSetting.ENABLED_MODULES.SUMMARY).displayName&&(PMSSetting.SUMMARY_DISPLAY_NAME=obj.displayName),isSameNme=PMSSetting.SUMMARY_DISPLAY_NAME.trim()==PMSSetting.SUMMARY_DISPLAY_NAME.trim(),html+=""+PMSSetting.SUMMARY_DISPLAY_NAME,isSameNme||(html+="&nbsp;("+PMSSetting.SUMMARY_DISPLAY_NAME+")"),html+="</h5><p>"+ZPI18N.getString("zp.pa.summary.summarydesc")+"</p></div></div></div>",html+="</div>",pageId.find(".zpl_crdcnt").append(html),$(pageId.find(".togBtn")).ztoggleswitch({size:"medium"}),PMSSetting.generalSettingCallback(),PMSSetting.registerActions(),PMSSetting.getPreviewInfo()}}else!resultData.isHRMSAdmin||resultData.isPAdmin||resultData.isSettAdmin?pageId.html("<div>"+ZPI18N.getString("zp.permissiondeniedtoaccessthispage")+"</div>"):pageId.html("<div>"+ZPI18N.getString("zp.notpaadmin")+"</div>")})}},registerActions:function(){var pageId=settingsPage.container;ZPeopleComponents.toggleswitch(pageId.find("#tg_kragoal")).setAttributes({change:PMSSetting.newEnableDisableKRAOptions}),ZPeopleComponents.toggleswitch(pageId.find("#tg_fdbck")).setAttributes({change:PMSSetting.updatePerformanceModulesPrereq}),ZPeopleComponents.toggleswitch(pageId.find("#tg_skillset")).setAttributes({change:PMSSetting.updatePerformanceModulesPrereq}),ZPeopleComponents.toggleswitch(pageId.find("#tg_compet")).setAttributes({change:PMSSetting.updatePerformanceModulesPrereq}),ZPeopleComponents.toggleswitch(pageId.find("#tg_summary")).setAttributes({change:PMSSetting.updatePerformanceModulesPrereq}),pageId.find("[name=modOpts]").unbind("click"),pageId.find("[name=modOpts]").bind("click",function(){PMSSetting.onClickModuleSel(this)}),PMSSetting.onKeyPress(pageId.find("[comp=appraisalComp]"))},onClickModuleSel:function(obj){var pageId=settingsPage.container;$(obj).find("[name=kragoaloption]").prop("checked",!0),PMSSetting.INITIAL_KRA_ENABLE=!1;var selectedModule=pageId.find("[name=kragoaloption]:checked").attr("value");PMSSetting.updatePerformanceModules("KRA",1,!0,selectedModule)},onKeyPress:function(elemObj){$(elemObj).bind("keyup blur",function(e){if("blur"===e.type||13==e.keyCode){var _module=$(this).attr("module"),componentsData=PMSSetting.getComponentObj(_module);ZPeople.decodeTxt(componentsData.displayName)!=$(this).val().trim()&&PMSSetting.ORIG_COMPONENTS[componentsData.compName]!=$(this).val().trim()&&PMSSetting.editModuleName(_module,$(this).val().trim(),$(this).attr("componentid"))}})},enableDisableKRAOptions:function(isEnable){var pageId=settingsPage.container;isEnable?(pageId.find("#kraRdBtn").attr("disabled",!1),pageId.find("#goalRdBtn").attr("disabled",!1),pageId.find("#kraGoalRdBtn").attr("disabled",!1),pageId.find("#kraVsGoalRdBtn").attr("disabled",!1),pageId.find("#cardDisable").removeClass("disabled")):(pageId.find("#kraRdBtn").attr("disabled",!0),pageId.find("#goalRdBtn").attr("disabled",!0),pageId.find("#kraGoalRdBtn").attr("disabled",!0),pageId.find("#kraVsGoalRdBtn").attr("disabled",!0),pageId.find("#cardDisable").addClass("disabled"))},disableEnableInput:function(actModuleObj){var pageId=settingsPage.container;pageId.find("#kra_displayname,#fdbk_displayname,#ss_displayname,#comp_displayname,#sumy_displayname,#goals_displayname").addClass("is-disabled"),pageId.find("#kra_displayname,#fdbk_displayname,#ss_displayname,#comp_displayname,#sumy_displayname,#goals_displayname").prop("disabled",!0),1===actModuleObj.FEEDBACK.enable&&(pageId.find("#fdbk_displayname").removeClass("is-disabled"),pageId.find("#fdbk_displayname").removeAttr("disabled")),1===actModuleObj.COMPETENCY.enable&&(pageId.find("#comp_displayname").removeClass("is-disabled"),pageId.find("#comp_displayname").removeAttr("disabled")),1===actModuleObj.SKILLSET.enable&&(pageId.find("#ss_displayname").removeClass("is-disabled"),pageId.find("#ss_displayname").removeAttr("disabled")),1===actModuleObj.SKILLSET.enable&&(pageId.find("#ss_displayname").removeClass("is-disabled"),pageId.find("#ss_displayname").removeAttr("disabled"));var kraObj=actModuleObj.KRA,goalObj=actModuleObj.GOALS,kgObj=actModuleObj.KRA_GOALS;1===kraObj.enable&&(pageId.find("#kra_displayname").removeClass("is-disabled"),pageId.find("#kra_displayname").removeAttr("disabled")),1===goalObj.enable&&(pageId.find("#goals_displayname").removeClass("is-disabled"),pageId.find("#goals_displayname").removeAttr("disabled")),1===kgObj.enable&&(pageId.find("#kragoals_displayname").removeClass("is-disabled"),pageId.find("#kragoals_displayname").removeAttr("disabled")),1===actModuleObj.SUMMARY.enable&&(pageId.find("#sumy_displayname").removeClass("is-disabled"),pageId.find("#sumy_displayname").removeAttr("disabled"))},showHideDisplayName:function(){var pageId=settingsPage.container,selectedModule=parseInt(pageId.find("[name=kragoaloption]:checked").attr("value"));pageId.find("#dispKRA,#dispGoal,#dispKRAGoal").hide(),1===selectedModule?pageId.find("#dispKRA").show():2===selectedModule?pageId.find("#dispGoal").show():3===selectedModule?(pageId.find("#dispKRA").show(),pageId.find("#dispGoal").show()):4===selectedModule&&pageId.find("#dispKRAGoal").show()},generalSettingCallback:function(){var pageId=settingsPage.container,isKraEnable=1===PMSSetting.ENABLED_MODULES.KRA.enable,isGoalEnable=1===PMSSetting.ENABLED_MODULES.GOALS.enable,isKraGlEnable=1===PMSSetting.ENABLED_MODULES.KRA_GOALS.enable;pageId.find("#KRAGOALS .togBtn").ztoggleswitch("switchOff"),PMSSetting.enableDisableKRAOptions(!1),isKraEnable&&isGoalEnable?(pageId.find("#KRAGOALS .togBtn").ztoggleswitch("switchOn"),pageId.find("#kraGoalRdBtn").prop("checked",!0),PMSSetting.OLD_OPTION=3,PMSSetting.enableDisableKRAOptions(!0)):isKraEnable?(pageId.find("#KRAGOALS .togBtn").ztoggleswitch("switchOn"),pageId.find("#kraRdBtn").prop("checked",!0),PMSSetting.OLD_OPTION=1,PMSSetting.enableDisableKRAOptions(!0)):isGoalEnable?(pageId.find("#KRAGOALS .togBtn").ztoggleswitch("switchOn"),pageId.find("#goalRdBtn").prop("checked",!0),PMSSetting.OLD_OPTION=2,PMSSetting.enableDisableKRAOptions(!0)):isKraGlEnable?(pageId.find("#KRAGOALS .togBtn").ztoggleswitch("switchOn"),pageId.find("#kraVsGoalRdBtn").prop("checked",!0),PMSSetting.OLD_OPTION=4,PMSSetting.enableDisableKRAOptions(!0)):(pageId.find("#KRAGOALS .togBtn").ztoggleswitch("switchOff"),PMSSetting.OLD_OPTION=-1,PMSSetting.enableDisableKRAOptions(!1)),PMSSetting.showHideDisplayName(),PMSSetting.disableEnableInput(PMSSetting.ENABLED_MODULES),1===PMSSetting.ENABLED_MODULES.FEEDBACK.enable?pageId.find("#FEEDBACK .togBtn").ztoggleswitch("switchOn"):pageId.find("#FEEDBACK .togBtn").ztoggleswitch("switchOff"),1===PMSSetting.ENABLED_MODULES.SKILLSET.enable?pageId.find("#SKILLSET .togBtn").ztoggleswitch("switchOn"):pageId.find("#SKILLSET .togBtn").ztoggleswitch("switchOff"),1===PMSSetting.ENABLED_MODULES.COMPETENCY.enable?pageId.find("#COMPETENCY .togBtn").ztoggleswitch("switchOn"):pageId.find("#COMPETENCY .togBtn").ztoggleswitch("switchOff"),1===PMSSetting.ENABLED_MODULES.SUMMARY.enable?pageId.find("#SUMMARY .togBtn").ztoggleswitch("switchOn"):pageId.find("#SUMMARY .togBtn").ztoggleswitch("switchOff")},newEnableDisableKRAOptions:function(event){if(event.detail.fromUI){var pageId=settingsPage.container,isEnable=event.detail.state;if(PMSSetting.INITIAL_KRA_ENABLE=!1,isEnable)PMSSetting.INITIAL_KRA_ENABLE=!0,PMSSetting.updatePerformanceModules("KRA",1,!0,1);else{var selectedModule=pageId.find("[name=kragoaloption]:checked").attr("value");PMSSetting.updatePerformanceModules("DISABLE_KRA_GOAL",0,!0,selectedModule)}}},updatePerformanceModulesPrereq:function(event,data){if(event.detail.fromUI){PMSSetting.INITIAL_KRA_ENABLE=!1;var compName=data.element.attr("compName"),status=data.state?1:0;PMSSetting.updatePerformanceModules(compName,status)}},getPreviewInfo:function(){var pageId=settingsPage.container;let isTgEnb=ZPeopleComponents.toggleswitch(pageId.find("#tg_kragoal")).getState();if(pageId.find(".kgPrevT").hide(),isTgEnb){var sel=parseInt(pageId.find("[name=kragoaloption]:checked").attr("value"));1===sel?pageId.find(".kgPrevT").html('<div class="zpl_info"><div><h6><b>'+ZPI18N.getString("zp.preview")+'</b></h6><div class="zpl_pachotypeinfo"><div><i class="PI_usr"></i><b>'+ZPI18N.getString("zp.username")+'</b></div><div class="zpl_lnedrp"></div><ul><li><div><span>'+ZPI18N.getString("zp.kra")+" 1</span></div><div><span>"+ZPI18N.getString("zp.kra")+" 2</span></div><div><span>"+ZPI18N.getString("zp.kra")+" 3</span></div><div><span>"+ZPI18N.getString("zp.kra")+" 4</span></div></li></ul></div></div></div></div>").show():2===sel?pageId.find(".kgPrevT").html('<div class="zpl_info"><div><h6><b>'+ZPI18N.getString("zp.preview")+'</b></h6><div class="zpl_pachotypeinfo"><div><i class="PI_usr"></i><b>'+ZPI18N.getString("zp.username")+'</b></div><div class="zpl_lnedrp"></div><ul><li><div><span>'+ZPI18N.getString("zp.goals")+" 1</span></div><div><span>"+ZPI18N.getString("zp.goals")+" 2</span></div><div><span>"+ZPI18N.getString("zp.goals")+" 3</span></div><div><span>"+ZPI18N.getString("zp.goals")+" 4</span></div></li></ul></div></div></div></div>").show():3===sel?pageId.find(".kgPrevT").html('<div class="zpl_info"><div><h6><b>'+ZPI18N.getString("zp.preview")+'</b></h6><div class="zpl_pachotypeinfo zpl_pachtycntr"><div><i class="PI_usr"></i><b>'+ZPI18N.getString("zp.username")+'</b></div><div class="zpl_lnedrp"></div><ul><li><div><span>'+ZPI18N.getString("zp.kra")+" 1</span></div><div><span>"+ZPI18N.getString("zp.goals")+" 1</span></div></li><li><div><span>"+ZPI18N.getString("zp.kra")+" 2</span></div><div><span>"+ZPI18N.getString("zp.goals")+" 2</span></div></li></ul></div></div></div></div>").show():4===sel&&pageId.find(".kgPrevT").html('<div class="zpl_info"><div><h6><b>'+ZPI18N.getString("zp.preview")+'</b></h6><div class="zpl_pachotypeinfo zpl_pachtysub"><div><i class="PI_usr"></i><b>'+ZPI18N.getString("zp.username")+'</b></div><div class="zpl_lnedrp"></div><ul class="zpl_pachtylne"><li><div><span>'+ZPI18N.getString("zp.kra")+" 1</span></div><div><span>"+ZPI18N.getString("zp.goals")+" 1</span></div><div><span>"+ZPI18N.getString("zp.goals")+" 2</span></div></li></ul><ul><li><div><span>"+ZPI18N.getString("zp.kra")+" 2</span></div><div><span>"+ZPI18N.getString("zp.goals")+" 1</span></div><div><span>"+ZPI18N.getString("zp.goals")+" 2</span></div></li></ul></div></div></div></div>").show()}},updatePerformanceModules:function(compName,status,isKraGoal,value){var pageId=settingsPage.container,params={mode:"updatePerformanceModules",compName:compName,status:status,isKraGoal:isKraGoal,type:value};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(callbackData){var resultData=callbackData.updPerfModules,msg=ZPI18N.getString("zp.moduledisable");1===status&&(msg=ZPI18N.getString("zp.moduleenable"));let updPrevInfo=!0;if(void 0!==resultData&&void 0!=resultData.msg)if("success"===resultData.msg.toLowerCase())PMSSetting.updateLeftTabs(callbackData.activeModules),"SALARY"==compName?(updPrevInfo=!1,ZPeople.autosave.success(pageId.find("#salaryweighthdr"),ZPI18N.getString("zp.saved"))):ZPeople.Message.success(msg),isKraGoal&&0===status?(pageId.find("#kraRdBtn").prop("checked",!1),pageId.find("#goalRdBtn").prop("checked",!1),pageId.find("#kraGoalRdBtn").prop("checked",!1),pageId.find("#kraVsGoalRdBtn").prop("checked",!1),pageId.find("#kraRdBtn").attr("disabled",!0),pageId.find("#goalRdBtn").attr("disabled",!0),pageId.find("#kraGoalRdBtn").attr("disabled",!0),pageId.find("#kraVsGoalRdBtn").attr("disabled",!0),pageId.find("#cardDisable").addClass("disabled")):isKraGoal&&1===status&&PMSSetting.INITIAL_KRA_ENABLE?(PMSSetting.OLD_OPTION=1,pageId.find("#kraRdBtn").prop("checked",!0),pageId.find("#kraRdBtn").attr("disabled",!1),pageId.find("#goalRdBtn").attr("disabled",!1),pageId.find("#kraGoalRdBtn").attr("disabled",!1),pageId.find("#kraVsGoalRdBtn").attr("disabled",!1),pageId.find("#cardDisable").removeClass("disabled")):isKraGoal&&1===status&&(PMSSetting.OLD_OPTION=parseInt(value)),PMSSetting.showHideDisplayName(),PMSSetting.disableEnableInput(callbackData.activeModules);else if("default_components"===resultData.msg)ZPeople.Message.warning(ZPI18N.getString("zp.defaultcomponentswarning"));else if("invalid component"===resultData.msg)ZPeople.Message.warning(ZPI18N.getString("zp.invalidinputs"));else if("permission_denied"===resultData.msg)ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied"));else if("error"===resultData.msg)ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"));else if("minimum_constraint"===resultData.msg){if(isKraGoal&&0===status)ZPeopleComponents.toggleswitch($("#tg_kragoal")).switchOn(!1);else{var idx="";"FEEDBACK"===compName?idx="tg_fdbck":"SKILLSET"===compName?idx="tg_skillset":"COMPETENCY"===compName?idx="tg_compet":"SUMMARY"===compName&&(idx="tg_summary"),""!==idx&&ZPeopleComponents.toggleswitch($("#"+idx)).switchOn(!1)}ZPeople.Message.failure(ZPI18N.getString("zp.minconmsgnewsett",new Array(PMSSetting.GOAL_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME,PMSSetting.SKILLSET_DISPLAY_NAME,PMSSetting.FEEDBACK_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME)))}else"KRAvsGoalsEnable"===resultData.msg?ZPeople.Message.failure("Disable "+PMSSetting.KRA_DISPLAY_NAME+" vs "+PMSSetting.GOAL_DISPLAY_NAME+" to perform this action"):"lookupenable"===resultData.msg?(FrameworkCommon.showRefFieldError(resultData.result,ZPI18N.getString("zp.referredfielderror",["disable"])),ZPeopleComponents.toggleswitch($("#tg_salary")).switchOn(!1),updPrevInfo=!1):"PERIODIC_REVIEW_ENABLE"===resultData.msg?(ZPeople.Message.failure(ZPI18N.getString("zp.goaldisablemsg")),ZPeopleComponents.toggleswitch($("#tg_kragoal")).switchOn(!1),1===PMSSetting.OLD_OPTION?pageId.find("#kraRdBtn").prop("checked",!0):2===PMSSetting.OLD_OPTION?pageId.find("#goalRdBtn").prop("checked",!0):3===PMSSetting.OLD_OPTION?pageId.find("#kraGoalRdBtn").prop("checked",!0):4===PMSSetting.OLD_OPTION&&pageId.find("#kraVsGoalRdBtn").prop("checked",!0)):"unabletoenabledisablesalary"===resultData.msg?(pageId.find("#tg_salary").ztoggleswitch("switchOff"),ZPeople.Message.failure(ZPI18N.getString("zp.performance.unabletoenableempsalaryform")),updPrevInfo=!1):"compensation_disabled"===resultData.msg?(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.compensationdisabled")),pageId.find("#tg_salary").ztoggleswitch("switchOff"),updPrevInfo=!1):"compensation_notinitiated"===resultData.msg&&(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.compensationsetnotcomplete")),pageId.find("#tg_salary").ztoggleswitch("switchOff"),updPrevInfo=!1);updPrevInfo&&PMSSetting.getPreviewInfo()})},kraInitPage:function(){return null!==PMSSetting.KRA_INIT_PAGE&&void 0!==PMSSetting.KRA_INIT_PAGE||$.ajax({type:"POST",async:!1,url:"/performance/view/kraGoalSettings",data:{conreqcsr:csrfToken},success:function(resultData){PMSSetting.KRA_INIT_PAGE=resultData}}),PMSSetting.KRA_INIT_PAGE},kraInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;if(PMSOperationCommon.addClearCentreClass(!0),PMSSetting.validateModuleStatus("KRA"))return;pageId.html(PMSSetting.kraInitPage()),PMSSetting.fetchKRAGoalsData("KRA")}},goalInitPage:function(){return null!==PMSSetting.GOAL_INIT_PAGE&&void 0!==PMSSetting.GOAL_INIT_PAGE||$.ajax({type:"POST",async:!1,url:"/performance/view/goalSettings",data:{conreqcsr:csrfToken},success:function(resultData){PMSSetting.GOAL_INIT_PAGE=resultData}}),PMSSetting.GOAL_INIT_PAGE},goalInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!0),["#nonAdnGFCId","#goalsettingPeriodFrequency","#frequencyStartMonth","#dayType","#startSchTime","#PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG_exeTime"].forEach(id=>{const component=$(pageId).find(id);ZPeopleComponents.isComponent(component)&&("#startSchTime"===id||"#PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG_exeTime"==id?ZPeopleComponents.timefield(component).destroy():ZPeopleComponents.select(component).destroy())}),pageId.find("select[type=keyFld], select[type=valFld]").each(function(){ZPeopleComponents.select($(this)).destroy()});var goalDateField=pageId.find("#goalDateFields");if(ZPeopleComponents.isComponent(goalDateField)&&ZPeopleComponents.tokenfield(goalDateField).destroy(),PMSReminderConfig.removeAllReminderRow(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG),PMSReminderConfig.deleteReminderConfiguration(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG),PMSSetting.validateModuleStatus("Goals"))return;pageId.html(""),pageId.html(PMSSetting.goalInitPage()),PMSSetting.fetchKRAGoalsData("GOALS")}},isKRAsettingsChanged:function(){settingsPage.container;PMSSetting.dataChanged(PMSCommon.SECTION_KRA_ACCESS)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_KRA_ACCESS):PMSSetting.closeResetSave(PMSCommon.SECTION_KRA_ACCESS)},setKRAGoalsConfig:function(showPage,resultData){var pageId=settingsPage.container;if($(pageId.find(".togBtn")).ztoggleswitch({size:"medium"}),PMSSetting.kraGoalDefaultObject=resultData,"KRA"===showPage){void 0!=resultData.kraPermissionData&&null!=resultData.kraPermissionData&&PMSSetting.setKRAPermissions(resultData.kraPermissionData),pageId.find("#kraPermission input[type=checkbox]").change(function(){PMSSetting.isKRAsettingsChanged()});var isConvertOrgKraEnabled=resultData.convertOrgKra?"switchOn":"switchOff";pageId.find("#userOrgKra").ztoggleswitch(isConvertOrgKraEnabled),ZPeopleComponents.toggleswitch(pageId.find("#userOrgKra")).setAttributes({change:PMSSetting.isKRAsettingsChanged});var _isKraApprEnabled=resultData.kraApproval?"switchOn":"switchOff";pageId.find("#kraApproval").ztoggleswitch(_isKraApprEnabled),resultData.kraApproval&&PMSSetting.isKraUserApprConfigured(),ZPeopleComponents.toggleswitch(pageId.find("#kraApproval")).setAttributes({change:PMSSetting.configureKraUserApproval});var kraAddSelf=pageId.find("#kraAdd_Self").prop("checked"),kraAddRep=pageId.find("#kraAdd_Rep").prop("checked");if(kraAddSelf||kraAddRep||pageId.find("#userSpfKra").addClass("zpl_DNI"),resultData.hasOwnProperty("kraDisabled")){var _kraDisabled=resultData.kraDisabled?"switchOff":"switchOn";pageId.find("#kraweitage").ztoggleswitch(_kraDisabled),resultData.kraDisabled||pageId.find("#krarestrictweightage").removeClass("DN")}if(ZPeopleComponents.toggleswitch(pageId.find("#kraweitage")).setAttributes({change:PMSSetting.enableDisableKRAWeightage}),resultData.hasOwnProperty("restrictKraWeightageValidation")){var _restrictKraWeightageValidation=!resultData.restrictKraWeightageValidation;pageId.find("#kra_restrict").prop("checked",_restrictKraWeightageValidation)}var _isKRASorting=0!=resultData.kraSortType?"switchOn":"switchOff";if(pageId.find("#enbleKRAS").ztoggleswitch(_isKRASorting),0!=resultData.kraSortType&&(pageId.find("#showKSW").show(),resultData.kraSortType==PMSCommon.KRA_SORT_WEIGHTAGE_ASC?pageId.find("#showKSW input[value='1']").prop("checked",!0):pageId.find("#showKSW input[value='2']").prop("checked",!0)),ZPeopleComponents.toggleswitch(pageId.find("#enbleKRAS")).setAttributes({change:PMSSetting.enableKRASorting}),pageId.find("#showKSW input[type=radio]").change(function(){PMSSetting.updateKRAWeightSorting($(this).val())}),resultData.hasOwnProperty("kraWeightageRange")){var _kraWeightageRange=resultData.kraWeightageRange?"switchOn":"switchOff";pageId.find("#kraweightagerange").ztoggleswitch(_kraWeightageRange)}resultData.hasOwnProperty("kraWeightageRange")&&resultData.kraWeightageRange&&(pageId.find("#userkraweightrangemandatory").parent().parent().removeClass("zpl_DNI"),resultData.hasOwnProperty("kraWeightageRangeMandatory")&&resultData.kraWeightageRangeMandatory&&pageId.find("#userkraweightrangemandatory").prop("checked",!0)),ZPeopleComponents.toggleswitch(pageId.find("#kraweightagerange")).setAttributes({change:PMSSetting.enableDisableKraWeightageRang})}if("GOALS"===showPage){let goalRecPermUrl="#settings/service/performance/recordperm/general";void 0!=resultData.goalFormId&&(goalRecPermUrl+="-formId:"+resultData.goalFormId),pageId.find("#goalPermInfoMsg").html(ZPI18N.getString("zp.pa.goalpermnote",new Array("goal",goalRecPermUrl,"goal"))),PMSSetting.GOALSETTINGPERIOD_DATA=resultData.goalSettingPeriod,PMSSetting.isGoalSettingOldFlowStrict=resultData.isGoalSettingOldFlowStrict,resultData.hasOwnProperty("goalWeightageValidationEnabled")&&("0"==resultData.goalWeightageValidationEnabled?(pageId.find("#enbleGWV").ztoggleswitch("switchOff"),pageId.find("#showGWV").addClass("DN"),pageId.find("#showGWV input[value='1']").prop("checked",!0)):(pageId.find("#enbleGWV").ztoggleswitch("switchOn"),pageId.find("#showGWV").removeClass("DN"),"1"==resultData.goalWeightageValidationEnabled?pageId.find("#showGWV input[value='1']").prop("checked",!0):pageId.find("#showGWV input[value='2']").prop("checked",!0))),ZPeopleComponents.toggleswitch(pageId.find("#enbleGWV")).setAttributes({change:PMSSetting.enableGoalWigtageValidation}),pageId.find("#showGWV input[type=radio]").change(function(){var isgoalWeighatgeValidationEnabled=$(this).val();PMSSetting.updateGoalWigtageValidation(isgoalWeighatgeValidationEnabled)}),ZPeopleComponents.toggleswitch(pageId.find("#enbleGoalArch")).setAttributes({change:PMSSetting.enableGoalArchive}),resultData.hasOwnProperty("goalsArchiveEnabled")&&(resultData.goalsArchiveEnabled?(pageId.find("#enbleGoalArch").ztoggleswitch("switchOn"),pageId.find("#showGoalArchPerm").removeClass("zpl_DNI")):(pageId.find("#enbleGoalArch").ztoggleswitch("switchOff"),pageId.find("#showGoalArchPerm").addClass("zpl_DNI")));var _fblevelElem="all"==resultData.goalsArchivePermission?"#archivepermall":"#archivepermlogin";pageId.find(_fblevelElem).prop("checked",!0),pageId.find("#showGoalArchPerm input[type=radio]").change(function(){PMSSetting.updateGoalArchive($(this))});var empLookup=pageId.find("#nonAdnGFCId");if(empLookup.empty(),empLookup.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),null!=resultData.emplookup&&$.each(resultData.emplookup,function(key,value){empLookup.append(jQuery("<option />",{value:key,id:key}).html(value))}),ZPeopleComponents.select("#nonAdnGFCId",{change:PMSSetting.changeGoalSettings}),pageId.find("#goalSettingsData input[type=checkbox]").click(function(){PMSSetting.dataChanged(PMSCommon.SECTION_GOAL_ACCESS)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_GOAL_ACCESS):PMSSetting.closeResetSave(PMSCommon.SECTION_GOAL_ACCESS)}),resultData.goalSettingsData){var goalSettingsData=resultData.goalSettingsData;goalSettingsData.goalsettingEnable?(ZPeopleComponents.select("#nonAdnGFCId").setAttribute("selectedValue",goalSettingsData.formCompId),goalSettingsData.isView&&pageId.find("#goalViewPer").prop("checked",!0),goalSettingsData.isDelete&&pageId.find("#goalDeletePer").prop("checked",!0),goalSettingsData.isEdit&&pageId.find("#goalEditPer").prop("checked",!0),goalSettingsData.isAdd&&pageId.find("#goalAddPer").prop("checked",!0),PMSSetting.goalSettingsChckBxEnable(!1)):PMSSetting.goalSettingsChckBxEnable(!0)}else PMSSetting.goalSettingsChckBxEnable(!0);ZPeopleComponents.select(pageId.find("#goalsettingPeriodFrequency"),{change:PMSSetting.changePeriod});var monthList="";$.each(Calendar.months,function(key,val){monthList+='<option value="'+key+'">'+val+"</option>"}),pageId.find("#frequencyStartMonth").html(monthList),ZPeopleComponents.select(pageId.find("#frequencyStartMonth"),{change:PMSSetting.frequencyMonthOptionChange}),ZPeopleComponents.select(pageId.find("#dayType"),{change:PMSSetting.goalSettingPeriodInfo}),ZPeopleComponents.timefield("#startSchTime",{value:"12:00 AM",className:"w200",disabled:!0}),pageId.find("#allownewjoineeexempt").prop("checked",!1),PMSSetting.onChangeAllowNewJoineeExemption(),ZPeopleComponents.timefield($("#PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG_exeTime")).setAttributes({format:timeFormat.replace("a","tt"),className:"w200",value:-1!=timeFormat.indexOf("HH")?"00:00":"12:00 AM"}),pageId.find("#goal_nonAppliDiv").html(PMSSetting.GAOLADD_EXCEP_BT),pageId.find("#goalSettingPeriodDetails").on("change",".zcheckbox > input",function(){const id=$(this).attr("id");let isDataChanged=!1;if("goalAddExtend"===id){const goalExtendOpt=PMSSetting.GOALSETTINGPERIOD_DATA.goalExtendOpt;isDataChanged=!goalExtendOpt||goalExtendOpt!==$(this).is(":checked")}if("repManApplicable"===id){const repManApplicable=PMSSetting.GOALSETTINGPERIOD_DATA.repManApplicable;isDataChanged=!repManApplicable||repManApplicable!==$(this).is(":checked")}if("goalReminder"===id){const goalReminder=PMSSetting.GOALSETTINGPERIOD_DATA.goalReminder;isDataChanged=!goalReminder||goalReminder!==$(this).is(":checked")}(isDataChanged=isDataChanged||PMSSetting.isGoalSettingsNewJoineeSectionDataChanged())&&PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALPERIOD_SETTINGS),PMSSetting.goalPeriodDataChanged()}),PMSSetting.constrctGoalSettingData(!1);var goalDateFields=pageId.find("#goalDateFields");goalDateFields.empty();var dateFields=[];dateFields.push({id:1,name:ZPI18N.getString("zp.createddate")}),"false"==resultData.goalFormFieldsHiddenSts.STARTDATE&&dateFields.push({id:2,name:ZPI18N.getString("zp.sdate")}),"false"==resultData.goalFormFieldsHiddenSts.GOAL_PERCENTAGE&&dateFields.push({id:3,name:ZPI18N.getString("zp.local.CompletedOn")}),dateFields.push({id:4,name:ZPI18N.getString("zp.duedate")});var dateObj={};dateObj.data=dateFields,dateObj.contentType="text",dateObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},dateObj.allowDuplicateValues=!1,dateObj.dropdownList={itemType:"checkbox"},dateObj.sort=!1,ZPeopleComponents.tokenfield(goalDateFields,dateObj);var dateTypeObj={1:ZPI18N.getString("zp.createddate"),2:ZPI18N.getString("zp.sdate"),3:ZPI18N.getString("zp.local.CompletedOn"),4:ZPI18N.getString("zp.duedate")},selectedDateTypes=resultData.goalDateType;"true"==resultData.goalFormFieldsHiddenSts.STARTDATE&&-1!=selectedDateTypes.indexOf(2)&&selectedDateTypes.splice(selectedDateTypes.indexOf(2),1),"true"==resultData.goalFormFieldsHiddenSts.GOAL_PERCENTAGE&&-1!=selectedDateTypes.indexOf(3)&&selectedDateTypes.splice(selectedDateTypes.indexOf(3),1),PMSSetting.kraGoalDefaultObject.goalDateType=selectedDateTypes;var dateArr=[];for(var i in selectedDateTypes){var _obj={};_obj.id=selectedDateTypes[i],_obj.name=dateTypeObj[selectedDateTypes[i]],dateArr.push(_obj)}ZPeopleComponents.tokenfield(pageId.find("#goalDateFields")).setAttribute("values",dateArr),$(goalDateFields).on("ztokenfieldtokenadd",PMSSetting.isGoalDateTypeChanged),$(goalDateFields).on("ztokenfieldtokenremove",PMSSetting.isGoalDateTypeChanged)}},enableDisableConvertOrgKra:function(event){if(event.detail.fromUI){var pageId=settingsPage.container,kraAddSelf=pageId.find("#kraAdd_Self").prop("checked");pageId.find("#kraAdd_Rep").prop("checked");if(kraAddSelf||kraAdd_Rep){var state=event.detail.state?1:0;$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",settingsmode:"updateOrgKraPerm",orgKraPermEnabled:state,conreqcsr:csrfToken},success:function(resultData){"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#userSpfKra"),ZPI18N.getString("zp.saved")):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#userSpfKra"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#userSpfKra")))}})}else ZPeople.Message.failure(ZPI18N.getString("zp.orgKRAerrmsg"))}},constrctGoalSettingData:function(isDefaultReset){const pageId=settingsPage.container,goalSettingPeriodData=PMSSetting.GOALSETTINGPERIOD_DATA;if(null!=goalSettingPeriodData&&Object.keys(goalSettingPeriodData).length>0&&!isDefaultReset){ZPeopleComponents.select(pageId.find("#goalsettingPeriodFrequency")).setAttributes({value:goalSettingPeriodData.frequency}),ZPeopleComponents.select(pageId.find("#frequencyStartMonth")).setAttributes({value:goalSettingPeriodData.frequencyStrMonth}),ZPeopleComponents.select(pageId.find("#dayType")).setAttributes({value:goalSettingPeriodData.noofdaysType}),pageId.find("#noofdays").val(goalSettingPeriodData.noofdays),pageId.find("#restrictProgEditInGsp").prop("checked",goalSettingPeriodData.restrictProgEditInGsp),pageId.find("#repManApplicable").prop("checked",!goalSettingPeriodData.repManApplicable),pageId.find("#goalAdminApplicable").prop("checked",!goalSettingPeriodData.goalAdminApplicable),pageId.find("#goalReminder").prop("checked",goalSettingPeriodData.goalReminder),pageId.find("#goalAddExtend").prop("checked",goalSettingPeriodData.goalExtendOpt),ZPeopleComponents.timefield(pageId.find("#startSchTime")).setAttributes({value:Calendar.minstotime(goalSettingPeriodData.schtimeInt),disabled:!0}),void 0!=goalSettingPeriodData.applicable_fromdate&&void 0!=goalSettingPeriodData.applicable_todate&&""!=goalSettingPeriodData.applicable_fromdate&&""!=goalSettingPeriodData.applicable_todate?(pageId.find("#FromAndToDOJ").prop("checked",!0).trigger("click"),ZPeopleComponents.daterangepicker("#gspDateFrToPicker").setFromValue(goalSettingPeriodData.applicable_fromdate),ZPeopleComponents.daterangepicker("#gspDateFrToPicker").setToValue(goalSettingPeriodData.applicable_todate)):(pageId.find("#utilDOJ").prop("checked",!0).trigger("click"),void 0!=goalSettingPeriodData.applicable_todate&&""!=goalSettingPeriodData.applicable_todate&&ZPeopleComponents.datefield(pageId.find("#dojVal1")).setValue(goalSettingPeriodData.applicable_todate));var attr={format:timeFormat.replace("a","tt"),placeholder:-1!=timeFormat.indexOf("HH")?"00:00":"12:00 AM",value:-1!=timeFormat.indexOf("HH")?"00:00":"12:00 AM",className:"w200"};if(ZPeopleComponents.timefield(pageId.find("#PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG_exeTime"),attr),$("#PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG_exeTime").on("ztimefieldchange",PMSSetting.newJoineeReminderExeTimeChange),pageId.find("#allownewjoineeexempt").prop("checked",goalSettingPeriodData.isNewJoineeExemptionEnabled),PMSSetting.onChangeAllowNewJoineeExemption(),PMSReminderConfig.removeAllReminderRow(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG),goalSettingPeriodData.isNewJoineeExemptionEnabled){pageId.find("#newjoineenoofdays").val(goalSettingPeriodData.newJoineeExemptiondays),PMSSetting.goalSettingNewJoineeValueChange(),void 0!=goalSettingPeriodData.isNewJoineeSelfReminder&&goalSettingPeriodData.isNewJoineeSelfReminder&&(pageId.find("#gsNewJoineenotifyRemSelf").prop("checked",!0),PMSSetting.onGoalSettingReminderEnableDisable("GOAL_NEWJOINEE_SELF_REMINDER")),void 0!=goalSettingPeriodData.isNewJoineeRMReminder&&goalSettingPeriodData.isNewJoineeRMReminder&&(pageId.find("#gsNewJoineenotifyRemRM").prop("checked",!0),PMSSetting.onGoalSettingReminderEnableDisable("GOAL_NEWJOINEE_RM_REMINDER"));var executionTime="";if(void 0!=goalSettingPeriodData.isNewJoineeSelfReminder&&goalSettingPeriodData.isNewJoineeSelfReminder||void 0!=goalSettingPeriodData.isNewJoineeRMReminder&&goalSettingPeriodData.isNewJoineeRMReminder){pageId.find("#newjoineedobjNotificationDiv").removeClass("zpl_DNI"),pageId.find("#gsNewJoineeRemindRepeat").removeClass("zpl_DNI");let isJoinDateNotificationEnabled=!1,isNewJoineeRepeatEnabled=!1;for(var index=0;index<goalSettingPeriodData.newJoineeReminderConfig.length;index++){let configArrObj=goalSettingPeriodData.newJoineeReminderConfig[index];configArrObj.reminderConfigType==PMSReminderConfig.START_DATE&&(isJoinDateNotificationEnabled=!0),executionTime=configArrObj.executionTime}isJoinDateNotificationEnabled?(pageId.find("#newjoineedojnotification").prop("checked",!0),goalSettingPeriodData.newJoineeReminderConfig.length>1&&(isNewJoineeRepeatEnabled=!0)):(pageId.find("#newjoineedojnotification").prop("checked",!1),goalSettingPeriodData.newJoineeReminderConfig.length>0&&(isNewJoineeRepeatEnabled=!0)),isJoinDateNotificationEnabled||isNewJoineeRepeatEnabled?(pageId.find("#gsNewJoineeExecutionTime").removeClass("zpl_DNI"),pageId.find("#gsNewJoineeRemindRepeat").find(".zpl_gbox").removeClass("zpl_DNI")):(pageId.find("#gsNewJoineeExecutionTime").addClass("zpl_DNI"),pageId.find("#gsNewJoineeRemindRepeat").find(".zpl_gbox").addClass("zpl_DNI")),isNewJoineeRepeatEnabled?pageId.find("#gsNewJoineeRemindRepeat").find("#"+PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG).removeClass("zpl_DNI"):pageId.find("#gsNewJoineeRemindRepeat").find("#"+PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG).addClass("zpl_DNI"),PMSReminderConfig.setReminderConfiguration(goalSettingPeriodData.newJoineeReminderConfig,PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG),isNewJoineeRepeatEnabled?(pageId.find("#gsNewJoineenotifyRepeat").prop("checked",!0),PMSReminderConfig.constructReminderSection(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG)):pageId.find("#gsNewJoineenotifyRepeat").prop("checked",!1)}else PMSReminderConfig.deleteReminderConfiguration(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG);if(""!=executionTime){if(-1!=timeFormat.indexOf("hh")){let[hours,minutes]=executionTime.split(":");const period=(hours=parseInt(hours,10))>=12?"PM":"AM";executionTime=(hours=(hours=hours%12||12)<10?"0"+hours:hours)+":"+minutes+" "+period}else{let[hours,minutes]=executionTime.split(":");executionTime=hours+":"+minutes}ZPeopleComponents.timefield($("#PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG_exeTime")).setAttributes({className:"w200",value:executionTime,format:timeFormat.replace("a","tt")})}}PMSSetting.setGoalPeriodApplicable(goalSettingPeriodData.applicableFor),PMSSetting.changePeriod(),pageId.find("#goalperiodeletediv").show()}else pageId.find("#utilDOJ").prop("checked",!0).trigger("click");isDefaultReset&&(ZPeopleComponents.select(pageId.find("#goalsettingPeriodFrequency")).setAttributes({value:3}),ZPeopleComponents.select(pageId.find("#frequencyStartMonth")).setAttributes({value:0}),ZPeopleComponents.select(pageId.find("#dayType")).setAttributes({value:0}),pageId.find("#noofdays").val(""),pageId.find("#restrictProgEditInGsp").prop("checked",!1),pageId.find("#repManApplicable").prop("checked",!1),pageId.find("#goalAdminApplicable").prop("checked",!1),pageId.find("#goalReminder").prop("checked",!1),pageId.find("#goalAddExtend").prop("checked",!1),ZPeopleComponents.timefield(pageId.find("#startSchTime")).setAttributes({value:Calendar.minstotime(0),disabled:!0}),pageId.find("#goal_condtInnerDiv .PI_delete").trigger("onclick"),pageId.find("#goal_exemptionDiv .PI_delete").trigger("onclick"),ZPeopleComponents.timefield($("#PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG_exeTime")).setAttributes({format:timeFormat.replace("a","tt"),value:-1!=timeFormat.indexOf("HH")?"00:00":"12:00 AM",className:"w200"}),pageId.find("#allownewjoineeexempt").prop("checked",!1),PMSSetting.onChangeAllowNewJoineeExemption(),PMSSetting.changePeriod()),PMSSetting.closeResetSave(PMSSetting.SECTION_GOALPERIOD_SETTINGS)},goalSettingApplicableDOJ:function(){var pageId=settingsPage.container;if(pageId.find("#FromAndToDOJ").is(":checked")){pageId.find("#dojValDiv").html('<div class="ztextbox--group zh-alignright"><i class="ztextbox__icon PI_calendar"></i><input style="width: 230px;" id="dojVal" class="ztextbox"></div>'),ZPeopleComponents.daterangepicker("#gspDateFrToPicker",{change:function(event){var ui=event.detail;pageId.find("#dojVal").val(ui.fromValueString+"-"+ui.toValueString),PMSSetting.goalSettingPeriodInfo()},format:dateFmt});var picker=pageId.find("#gspDateFrToPicker");pageId.find("#dojVal").on("click",function(){pageId.find("#gspDateFrToPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker).close():ZPeopleComponents.daterangepicker(picker).open()})}else{pageId.find("#dojValDiv").html('<input id="dojVal1" class="ztextbox" style="width: 230px;">');var applicableUntilDOJNeed={calendarIcon:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none",pickerclose:PMSSetting.goalSettingPeriodInfo};ZPeopleComponents.datefield(pageId.find("#dojVal1"),applicableUntilDOJNeed)}},setGoalPeriodApplicable:function(appliData){var pageId=settingsPage.container;PMSSetting.loadApplicableData(),PMSSetting.updateNonAppliArray();var gId="";"#settings-service-performance-goal"===settingsPage.tabId&&(gId="goal_");let isNonAppliPresent=!1,isAppliAllEmp=!0;$.each(appliData,function(key,value){1===value.mode?value.list.length>0&&(isAppliAllEmp=!1):0===value.mode&&(isNonAppliPresent=!0)});let APPLI_KEYS_OBJ=PMSSetting.CR_APPLI_KEYS_OBJ;PMSSetting.isCRConfigurationPage()&&(APPLI_KEYS_OBJ=PMSSetting.CFS_APPLI_KEYS_OBJ,isNonAppliPresent&&pageId.find("#exempDescID").html(""));let alreadySelKey=[];$.each(appliData,function(key,value){if(!isAppliAllEmp&&1===value.mode&&value.list.length>0){pageId.find("#"+gId+"allEmpAppliID").remove();let idx="1";(existingCondt=pageId.find("#"+gId+"condtInnerDiv .addCondtTemp").length)>0&&(idx=parseInt($(pageId.find("#"+gId+"condtInnerDiv .addCondtTemp")[existingCondt-1]).attr("series"))+1),pageId.find("#"+gId+"condtInnerDiv .addCondtTemp").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");-1==alreadySelKey.indexOf(val)&&alreadySelKey.push(val)});let row='<div class="zpl_idiv addCondtTemp" series="'+idx+'"><select id="'+gId+"crAppliKey_"+idx+'" type="keyFld" class="select-js" style="display: none;"></select><span>is</span><select id="'+gId+"crAppliVal_"+idx+'" data-show-search-field="true" type="valFld" multiple="true" class="select-js" style="display: none;"></select><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSSetting.removeAppliCondtRow(this);"></i></div>';pageId.find("#"+gId+"addCondDiv").before(row);var keySelObj=pageId.find("#"+gId+"crAppliKey_"+idx);if(keySelObj.empty(),$.each(APPLI_KEYS_OBJ,function(k,v){keySelObj.append(jQuery("<option />",{value:k,id:k}).html(v))}),ZPeopleComponents.select(keySelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),keySelObj.on("zselectchange",function(event,edata){PMSSetting.onCRAppliKeyChange(edata)}),keySelObj.on("zselectbeforedropdownlistopen",function(event,eData){PMSSetting.refreshKeySelect(eData)}),"Departments"===key)keySelObj.attr("keySel","APPL_DEP"),ZPeopleComponents.select(keySelObj).setValue(["APPL_DEP"]),(valSelObj=pageId.find("#"+gId+"crAppliVal_"+idx)).empty(),$.each(PMSSetting.ALL_DEPARTMENTS,function(key,value){valSelObj.append(jQuery("<option />",{value:value.departmentId,id:value.departmentId}).html(value.departmentName))}),ZPeopleComponents.select(valSelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),0===value.list.length||"-1"===value.list[0]?ZPeopleComponents.select(valSelObj).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder("APPL_DEP")}):ZPeopleComponents.select(valSelObj).setValue(value.list);else if("Designations"===key){ZPeopleComponents.select(keySelObj).setValue(["APPL_DES"]),keySelObj.attr("keySel","APPL_DES"),(valSelObj=pageId.find("#"+gId+"crAppliVal_"+idx)).empty(),$.each(PMSSetting.ALL_DESIGNATION,function(key,value){valSelObj.append(jQuery("<option />",{value:value.desId,id:value.desId}).html(value.desName))}),ZPeopleComponents.select(valSelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),0===value.list.length||"-1"===value.list[0]?ZPeopleComponents.select(valSelObj).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder("APPL_DES")}):ZPeopleComponents.select(valSelObj).setValue(value.list)}else if("Locations"===key){ZPeopleComponents.select(keySelObj).setValue(["APPL_LOC"]),keySelObj.attr("keySel","APPL_LOC"),(valSelObj=pageId.find("#"+gId+"crAppliVal_"+idx)).empty(),$.each(PMSSetting.ALL_LOCATIONS,function(key,value){valSelObj.append(jQuery("<option />",{value:value.locationId,id:value.locationId}).html(value.locationName))}),ZPeopleComponents.select(valSelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),0===value.list.length||"-1"===value.list[0]?ZPeopleComponents.select(valSelObj).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder("APPL_LOC")}):ZPeopleComponents.select(valSelObj).setValue(value.list)}else if("Roles"===key){ZPeopleComponents.select(keySelObj).setValue(["APPL_ROLE"]),keySelObj.attr("keySel","APPL_ROLE"),(valSelObj=pageId.find("#"+gId+"crAppliVal_"+idx)).empty(),$.each(PMSSetting.ALL_ROLES,function(key,value){valSelObj.append(jQuery("<option />",{value:value.roleId,id:value.roleId}).html(value.roleName))}),ZPeopleComponents.select(valSelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),0===value.list.length||"-1"===value.list[0]?ZPeopleComponents.select(valSelObj).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder("APPL_ROLE")}):ZPeopleComponents.select(valSelObj).setValue(value.list)}else if(key===ZPComponent.CONSTANTS.EMPLOYEETYPES){ZPeopleComponents.select(keySelObj).setValue(["APPL_EMP_TYPE"]),keySelObj.attr("keySel","APPL_EMP_TYPE"),(valSelObj=pageId.find("#"+gId+"crAppliVal_"+idx)).empty(),$.each(PMSSetting.ALL_EMPLOYEE_TYPES,function(key,value){valSelObj.append(jQuery("<option />",{value:value.typeId,id:value.typeId}).html(value.typeName))}),ZPeopleComponents.select(valSelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),0===value.list.length||"-1"===value.list[0]?ZPeopleComponents.select(valSelObj).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder("APPL_EMP_TYPE")}):ZPeopleComponents.select(valSelObj).setValue(value.list)}}else if(isNonAppliPresent&&0===value.mode){if("goal_"==gId&&0==pageId.find("#goal_nonCondtInnerDiv").length||""==gId&&0==pageId.find("#nonCondtInnerDiv").length){pageId.find("#"+gId+"nonAppliDiv").empty();let nonApplHtml='<div class="zpl_cndor"><div class="zpl_gbox" id="'+gId+'nonCondtInnerDiv"><div class="zpl_idiv" id="'+gId+'addNonCondtDiv"><a class="zpl_lnkbg" onclick="PMSSetting.addNonApplicable();">'+ZPI18N.getString("zp.addcriteria")+"</a></div></div></div>";pageId.find("#"+gId+"nonAppliDiv").html(nonApplHtml)}pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");-1==alreadySelKey.indexOf(val)&&alreadySelKey.push(val)});let idx="1";var existingCondt;(existingCondt=pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").length)>0&&(idx=parseInt($(pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp")[existingCondt-1]).attr("series"))+1);let row='<div class="zpl_idiv addNonCondtTemp" series="'+idx+'"><select id="'+gId+"crNonAppliKey_"+idx+'" type="keyFld" class="select-js" style="display: none;"></select><span>is</span><select id="'+gId+"crNonAppliVal_"+idx+'" type="valFld" data-show-search-field="true" multiple="true" class="select-js" style="display: none;"></select><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSSetting.removeNonAppliCondtRow(this);"></i></div>';pageId.find("#"+gId+"addNonCondtDiv").before(row);var crNonKeySelObj=pageId.find("#"+gId+"crNonAppliKey_"+idx);if(crNonKeySelObj.empty(),$.each(APPLI_KEYS_OBJ,function(k,v){crNonKeySelObj.append(jQuery("<option />",{value:k,id:k}).html(v))}),ZPeopleComponents.select(crNonKeySelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),crNonKeySelObj.on("zselectchange",function(event,edata){PMSSetting.onCRAppliKeyChange(edata)}),crNonKeySelObj.on("zselectbeforedropdownlistopen",function(event,eData){PMSSetting.refreshNonApplKeySelect(eData)}),"Departments"===key)crNonKeySelObj.attr("keySel","APPL_DEP"),ZPeopleComponents.select(crNonKeySelObj).setValue(["APPL_DEP"]),(valSelObj=pageId.find("#"+gId+"crNonAppliVal_"+idx)).empty(),$.each(PMSSetting.ALL_DEPARTMENTS,function(key,value){valSelObj.append(jQuery("<option />",{value:value.departmentId,id:value.departmentId}).html(value.departmentName))}),ZPeopleComponents.select(valSelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),0===value.list.length||"-1"===value.list[0]?ZPeopleComponents.select(valSelObj).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder("APPL_DEP")}):ZPeopleComponents.select(valSelObj).setValue(value.list);else if("Designations"===key){crNonKeySelObj.attr("keySel","APPL_DES"),ZPeopleComponents.select(crNonKeySelObj).setValue(["APPL_DES"]),(valSelObj=pageId.find("#"+gId+"crNonAppliVal_"+idx)).empty(),$.each(PMSSetting.ALL_DESIGNATION,function(key,value){valSelObj.append(jQuery("<option />",{value:value.desId,id:value.desId}).html(value.desName))}),ZPeopleComponents.select(valSelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),0===value.list.length||"-1"===value.list[0]?ZPeopleComponents.select(valSelObj).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder("APPL_DES")}):ZPeopleComponents.select(valSelObj).setValue(value.list)}else if("Locations"===key){crNonKeySelObj.attr("keySel","APPL_LOC"),ZPeopleComponents.select(crNonKeySelObj).setValue(["APPL_LOC"]),(valSelObj=pageId.find("#"+gId+"crNonAppliVal_"+idx)).empty(),$.each(PMSSetting.ALL_LOCATIONS,function(key,value){valSelObj.append(jQuery("<option />",{value:value.locationId,id:value.locationId}).html(value.locationName))}),ZPeopleComponents.select(valSelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),0===value.list.length||"-1"===value.list[0]?ZPeopleComponents.select(valSelObj).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder("APPL_LOC")}):ZPeopleComponents.select(valSelObj).setValue(value.list)}else if("Roles"===key){crNonKeySelObj.attr("keySel","APPL_ROLE"),ZPeopleComponents.select(crNonKeySelObj).setValue(["APPL_ROLE"]),(valSelObj=pageId.find("#"+gId+"crNonAppliVal_"+idx)).empty(),$.each(PMSSetting.ALL_ROLES,function(key,value){valSelObj.append(jQuery("<option />",{value:value.roleId,id:value.roleId}).html(value.roleName))}),ZPeopleComponents.select(valSelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),0===value.list.length||"-1"===value.list[0]?ZPeopleComponents.select(valSelObj).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder("APPL_ROLE")}):ZPeopleComponents.select(valSelObj).setValue(value.list)}else if(key===ZPComponent.CONSTANTS.EMPLOYEETYPES){var valSelObj;crNonKeySelObj.attr("keySel","APPL_EMP_TYPE"),ZPeopleComponents.select(crNonKeySelObj).setValue(["APPL_EMP_TYPE"]),(valSelObj=pageId.find("#"+gId+"crNonAppliVal_"+idx)).empty(),$.each(PMSSetting.ALL_EMPLOYEE_TYPES,function(key,value){valSelObj.append(jQuery("<option />",{value:value.typeId,id:value.typeId}).html(value.typeName))}),ZPeopleComponents.select(valSelObj,{dropdownList:{appendTo:pageId,fitForElement:!0}}),0===value.list.length||"-1"===value.list[0]?ZPeopleComponents.select(valSelObj).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder("APPL_EMP_TYPE")}):ZPeopleComponents.select(valSelObj).setValue(value.list)}}});var totalSelec=pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").length+pageId.find("#"+gId+"condtInnerDiv .addCondtTemp").length;let maxSelCnt=PMSSetting.isCRConfigurationPage()?5:4;pageId.find("#"+gId+"addNonCondtDiv, #"+gId+"addCondDiv").toggle(totalSelec<maxSelCnt)},bindEnterOnblur:function(elemObj){$(elemObj).bind("keyup blur",function(e){if("blur"===e.type||13==e.keyCode){var _module=$(this).attr("module"),componentsData=PMSSetting.getComponentObj(_module);componentsData.displayName!=$(this).val().trim()&&PMSSetting.ORIG_COMPONENTS[componentsData.compName]!=$(this).val().trim()&&(PMSSetting.editModuleName(_module,$(this).val().trim(),$(this).attr("componentid")),PMSSetting.getPerformanceModules())}})},goalPeriodDataChanged:function(){const pageId=settingsPage.container;let isDataChanged=!1;null!=PMSSetting.GOALSETTINGPERIOD_DATA&&Object.keys(PMSSetting.GOALSETTINGPERIOD_DATA).length>0?(PMSSetting.GOALSETTINGPERIOD_DATA.frequency!==ZPeopleComponents.select(pageId.find("#goalsettingPeriodFrequency")).getValue()&&(isDataChanged=!0),(void 0!=PMSSetting.GOALSETTINGPERIOD_DATA.applicable_fromdate&&PMSSetting.GOALSETTINGPERIOD_DATA.applicable_fromdate!=PMSSetting.DateForGS.applicable_fromdate||void 0!=PMSSetting.GOALSETTINGPERIOD_DATA.applicable_todate&&PMSSetting.GOALSETTINGPERIOD_DATA.applicable_todate!=PMSSetting.DateForGS.applicable_todate)&&(isDataChanged=!0)):isDataChanged=!0,isDataChanged&&PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALPERIOD_SETTINGS)},changePeriod:function(event){const pageId=settingsPage.container,frequency=ZPeopleComponents.select(pageId.find("#goalsettingPeriodFrequency")).getValue(),frequencymnth=ZPeopleComponents.select(pageId.find("#frequencyStartMonth")).getValue();if(3==frequency)return pageId.find("#monthday").removeClass("DN"),pageId.find("#mothPeriod,#nonmonthday").addClass("DN"),pageId.find("#frequencyStartDiv").hide(),void PMSSetting.goalSettingPeriodInfo();pageId.find("#monthday").addClass("DN"),pageId.find("#mothPeriod,#nonmonthday").removeClass("DN"),pageId.find("#frequencyStartDiv").show(),PMSSetting.changeFrequencyMonth(frequencymnth),PMSSetting.goalPeriodDataChanged()},goalSettingPeriodInfo:function(){const pageId=settingsPage.container,frequency=ZPeopleComponents.select(pageId.find("#goalsettingPeriodFrequency")).getValue(),noofdaysType=ZPeopleComponents.select(pageId.find("#dayType")).getValue(),noofdays=pageId.find("#noofdays").val();if(PMSSetting.DateForGS.applicable_fromdate="",PMSSetting.DateForGS.applicable_todate="",pageId.find("#gsinvaliddayerror").remove(),pageId.find("#noofdays").removeClass("ztextbox__error"),pageId.find("#goalPeriodInfo").removeClass("DN"),pageId.find("#periodInfo").removeClass("DN"),pageId.find("#mothPeriodTable").removeClass("DN"),""!==noofdays){let allowedDayLimit=PMSSetting.isGoalSettingOldFlowStrict?28:PMSSetting.getGSAllowedDayLimit(frequency);if(allowedDayLimit<parseInt(noofdays)){pageId.find("#noofdays").addClass("ztextbox__error"),pageId.find("#goalPeriodInfo").addClass("DN"),pageId.find("#periodInfo").addClass("DN"),pageId.find("#mothPeriodTable").addClass("DN");let frequencyText="3"===frequency?ZPI18N.getString("zp.monthly"):"5"===frequency?ZPI18N.getString("zp.quarterly"):"6"===frequency?ZPI18N.getString("zp.schhfyearly"):ZPI18N.getString("zp.yearly");return void pageId.find("#goalPeriodInfo").before('<div id="gsinvaliddayerror"><span class="ztextbox--error__label">'+ZPI18N.getString("zp.gsinvalidnoofdays",new Array(frequencyText,allowedDayLimit+""))+"</span></div>")}if(pageId.find("#goalPeriodInfo").removeClass("DN"),pageId.find("#periodInfo").removeClass("DN"),pageId.find("#mothPeriodTable").removeClass("DN"),pageId.find("#frequencyStartDiv").is(":visible")||pageId.find("#mothPeriodTable").addClass("DN"),"3"===frequency){const range=0==noofdaysType?ZPI18N.getString("zp.first"):ZPI18N.getString("zp.last");pageId.find("#periodInfo em").html(ZPI18N.getString("zp.goalSettingPeriodDuration1",[PMSSetting.GOAL_DISPLAY_NAME,range,noofdays]))}else"0"===noofdaysType?pageId.find("#periodInfo em").html(ZPI18N.getString("zp.goalSettingPeriodDuration",[PMSSetting.GOAL_DISPLAY_NAME,ZPI18N.getString("zp.first"),noofdays,PMSSetting.SELECTEDMONTHFRIST])):"1"===noofdaysType&&pageId.find("#periodInfo em").html(ZPI18N.getString("zp.goalSettingPeriodDuration",[PMSSetting.GOAL_DISPLAY_NAME,ZPI18N.getString("zp.last"),noofdays,PMSSetting.SELECTEDMONTHLAST]));if(pageId.find("#utilDOJ").is(":checked")&&void 0!=pageId.find("#dojVal1").val()&&void 0!=ZPeopleComponents.datefield(pageId.find("#dojVal1")).getValue().dateString){var todt=ZPeopleComponents.datefield(pageId.find("#dojVal1")).getValue().dateString;if(0==PMSV2Cycle.checkvalidDate(todt))return void PMSV2Cycle.showError(ZPI18N.getString("zp.apptodateerror"),pageId.find("#dojVal1"));PMSSetting.DateForGS.applicable_todate=todt,PMSSetting.DateForGS.applicable_fromdate=""}else if(pageId.find("#FromAndToDOJ").is(":checked")&&void 0!=pageId.find("#dojVal").val()&&""!==pageId.find("#dojVal").val()){var res={};PMSV2Cycle.setDateValues(pageId.find("#dojVal").val(),"dojVal","applicable_fromdate","applicable_todate",null,!1,res),PMSSetting.DateForGS.applicable_fromdate=res.applicable_fromdate,PMSSetting.DateForGS.applicable_todate=res.applicable_todate}else PMSSetting.DateForGS.applicable_todate="",PMSSetting.DateForGS.applicable_fromdate=""}else pageId.find("#frequencyStartDiv").is(":visible")||""!==noofdays||pageId.find("#goalPeriodInfo").addClass("DN"),pageId.find("#periodInfo").addClass("DN");PMSSetting.goalPeriodDataChanged()},frequencyMonthOptionChange:function(event){if(event.detail.fromUI){var data=event.detail;PMSSetting.changeFrequencyMonth(data.selectedValue),PMSSetting.goalPeriodDataChanged()}},changeFrequencyMonth:function(month){PMSSetting.SELECTEDMONTHFRIST="",PMSSetting.SELECTEDMONTHLAST="";var pageId=settingsPage.container;month=null!=month?month:0;var frequency=ZPeopleComponents.select(pageId.find("#goalsettingPeriodFrequency")).getValue(),cntMnt=3,feq="Q";6==frequency?(cntMnt=6,feq="H"):4==frequency&&(cntMnt=12);for(var periodMonth="",nextMonth=0,pendingMonth=0,cnt=0,i=parseInt(month);i<=11;i+=cntMnt)(nextMonth=i+(cntMnt-1))>11&&(pendingMonth=(nextMonth-=12)+1),cnt+=1,PMSSetting.SELECTEDMONTHFRIST+=""==PMSSetting.SELECTEDMONTHFRIST?Calendar.months[i]:", "+Calendar.months[i],PMSSetting.SELECTEDMONTHLAST+=""==PMSSetting.SELECTEDMONTHLAST?Calendar.months[nextMonth]:", "+Calendar.months[nextMonth],periodMonth=4==frequency?""!=periodMonth?periodMonth+" | Y - "+Calendar.months[i]+" - "+Calendar.months[nextMonth]:"Y - "+Calendar.months[i]+" - "+Calendar.months[nextMonth]:""!=periodMonth?periodMonth+" | "+feq+cnt+" - "+Calendar.months[i]+" - "+Calendar.months[nextMonth]:feq+cnt+" - "+Calendar.months[i]+" - "+Calendar.months[nextMonth];for(i=pendingMonth;i<parseInt(month);i+=cntMnt)cnt+=1,periodMonth=4==frequency?""!=periodMonth?periodMonth+" | Y - "+Calendar.months[i]+" - "+Calendar.months[i+(cntMnt-1)]:"Y - "+Calendar.months[i]+" - "+Calendar.months[i+(cntMnt-1)]:""!=periodMonth?periodMonth+" | "+feq+cnt+" - "+Calendar.months[i]+" - "+Calendar.months[i+(cntMnt-1)]:feq+cnt+" - "+Calendar.months[i]+" - "+Calendar.months[i+(cntMnt-1)],PMSSetting.SELECTEDMONTHFRIST+=""==PMSSetting.SELECTEDMONTHFRIST?Calendar.months[i]:", "+Calendar.months[i],PMSSetting.SELECTEDMONTHLAST+=""==PMSSetting.SELECTEDMONTHLAST?Calendar.months[i+(cntMnt-1)]:", "+Calendar.months[i+(cntMnt-1)];pageId.find("#mothPeriodTable em").html(periodMonth),pageId.find("#goalPeriodInfo").removeClass("DN"),pageId.find("#mothPeriodTable").removeClass("DN"),PMSSetting.goalSettingPeriodInfo()},showTimePicker:function(reset){var pageId=settingsPage.container;pageId.find("#goalReminder").is(":checked")&&reset?ZPeopleComponents.timefield(pageId.find("#startSchTime")).setAttributes({placeholder:void 0!==PMSSetting.GOALSETTINGPERIOD_DATA.schtimeInt?Calendar.minstotime(PMSSetting.GOALSETTINGPERIOD_DATA.schtimeInt):"12:00 AM",value:void 0!==PMSSetting.GOALSETTINGPERIOD_DATA.schtimeInt?Calendar.minstotime(PMSSetting.GOALSETTINGPERIOD_DATA.schtimeInt):"12:00 AM",disabled:!1}):ZPeopleComponents.timefield(pageId.find("#startSchTime")).setAttributes({placeholder:void 0!==PMSSetting.GOALSETTINGPERIOD_DATA.schtimeInt?Calendar.minstotime(PMSSetting.GOALSETTINGPERIOD_DATA.schtimeInt):"12:00 AM",value:void 0!==PMSSetting.GOALSETTINGPERIOD_DATA.schtimeInt?Calendar.minstotime(PMSSetting.GOALSETTINGPERIOD_DATA.schtimeInt):"12:00 AM",disabled:!0})},getGSAllowedDayLimit:function(frequency){return frequency==PMSSetting.GS_MONTHLY_FREQUENCY?PMSSetting.GS_MONTHLY_DAYS_LIMIT:frequency==PMSSetting.GS_QUARTERLY_FREQUENCY?PMSSetting.GS_QUARTERLY_DAYS_LIMIT:frequency==PMSSetting.GS_HALFYEARLY_FREQUENCY?PMSSetting.GS_HALFYEARLY_DAYS_LIMIT:frequency==PMSSetting.GS_YEARLY_FREQUENCY?PMSSetting.GS_YEARLY_DAYS_LIMIT:PMSSetting.GS_MONTHLY_DAYS_LIMIT},submitGoalSettingPeriod:function(){var pageId=settingsPage.container,goalPeriodMonthsData={},frequency=ZPeopleComponents.select(pageId.find("#goalsettingPeriodFrequency")).getValue(),frequencyStrMonth=ZPeopleComponents.select(pageId.find("#frequencyStartMonth")).getValue(),noofdayObj=pageId.find("#noofdays"),noofdays=noofdayObj.val(),noofdaysType=ZPeopleComponents.select(pageId.find("#dayType")).getValue(),goalReminderEnable=pageId.find("#goalReminder").is(":checked"),appFor=PMSSetting.getCRApplicableObj();let allowedDatLimit=PMSSetting.isGoalSettingOldFlowStrict?28:PMSSetting.getGSAllowedDayLimit(frequency);if(void 0==noofdays||null==noofdays||""==noofdays)return ZPeople.Message.failure(ZPI18N.getString("zp.enternoofday")),$(noofdayObj).trigger("focus"),$(noofdayObj).addClass("ztextbox__error"),void(isValid=!1);if(noofdays>allowedDatLimit)return ZPeople.Message.failure(ZPI18N.getString("zp.noofdaylessthandatecustomErr",new Array(allowedDatLimit+""))),$(noofdayObj).trigger("focus"),$(noofdayObj).addClass("ztextbox__error"),void(isValid=!1);if(0==noofdays)return ZPeople.Message.failure(ZPI18N.getString("zp.entervalidinput")),$(noofdayObj).trigger("focus"),$(noofdayObj).addClass("ztextbox__error"),void(isValid=!1);var startSchTime=ZPeopleComponents.timefield(pageId.find("#startSchTime")).getValue().dateString;startSchTime=PMSSetting.disTwoDigit(parseInt(startSchTime.split(":")[0]))+":"+startSchTime.split(":")[1];var time=0;if(goalReminderEnable){var hrs=startSchTime.split(/(\s+)/)[0],ampm=startSchTime.split(/(\s+)/)[2];ampm=void 0!==ampm?ampm.toLowerCase():"",time=Calendar.timetomins(hrs,0,ampm).tottime}let isNewJoineeExemptionEnabled=pageId.find("#allownewjoineeexempt").is(":checked");if(isNewJoineeExemptionEnabled){var newjoineeExemptionDays=pageId.find("#newjoineenoofdays").val();if(void 0==newjoineeExemptionDays||null==newjoineeExemptionDays||""==newjoineeExemptionDays)return ZPeople.Message.failure(ZPI18N.getString("zp.gsnewjoine.invaildday",new Array(PMSSetting.GOAL_DISPLAY_NAME))),pageId.find("#newjoineenoofdays").addClass("ztextbox__error"),void(isValid=!1);if((pageId.find("#gsNewJoineenotifyRemSelf").is(":checked")||pageId.find("#gsNewJoineenotifyRemRM").is(":checked"))&&!PMSReminderConfig.valiateReminderSection(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG,!0))return isValid=!1,void ZPeople.Message.failure(ZPI18N.getString("zp.gsnewjoinee.invalidreminderConfiguration"));if((pageId.find("#gsNewJoineenotifyRemSelf").is(":checked")||pageId.find("#gsNewJoineenotifyRemRM").is(":checked"))&&(pageId.find("#gsNewJoineeRemindRepeat").find(".ztextbox--error__label").remove(),!pageId.find("#newjoineedojnotification").is(":checked")&&!pageId.find("#gsNewJoineenotifyRepeat").is(":checked")))return isValid=!1,ZPeople.Message.failure(ZPI18N.getString("zp.gsnewjoinee.errornotifyon")),void pageId.find("#gsNewJoineeRemindRepeat").append('<span elem="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.gsnewjoinee.errornotifyon")+"</span>")}if($(noofdayObj).removeClass("ztextbox__error"),$(pageId.find("#newjoineenoofdays")).removeClass("ztextbox__error"),goalPeriodMonthsData.schtime=startSchTime,void 0!=PMSSetting.GOALSETTINGPERIOD_DATA&&null!=PMSSetting.GOALSETTINGPERIOD_DATA&&Object.keys(PMSSetting.GOALSETTINGPERIOD_DATA).length>0){PMSSetting.GOALSETTINGPERIOD_DATA.frequency!=frequency&&(goalPeriodMonthsData.frequency=frequency),PMSSetting.GOALSETTINGPERIOD_DATA.frequencyStrMonth!=frequencyStrMonth&&(goalPeriodMonthsData.frequencyStrMonth=frequencyStrMonth),PMSSetting.GOALSETTINGPERIOD_DATA.noofdaysType!=noofdaysType&&(goalPeriodMonthsData.noofdaysType=noofdaysType),PMSSetting.GOALSETTINGPERIOD_DATA.noofdays!=noofdays&&(goalPeriodMonthsData.noofdays=noofdays),goalPeriodMonthsData.applicableFor=appFor;var status=!pageId.find("#repManApplicable").is(":checked");void 0!=PMSSetting.GOALSETTINGPERIOD_DATA.repManApplicable&&status!=PMSSetting.GOALSETTINGPERIOD_DATA.repManApplicable&&(goalPeriodMonthsData.repManApplicable=status),status=!pageId.find("#goalAdminApplicable").is(":checked"),void 0!=PMSSetting.GOALSETTINGPERIOD_DATA.goalAdminApplicable&&status!=PMSSetting.GOALSETTINGPERIOD_DATA.goalAdminApplicable&&(goalPeriodMonthsData.goalAdminApplicable=status),void 0!=PMSSetting.GOALSETTINGPERIOD_DATA.goalReminder&&goalReminderEnable!=PMSSetting.GOALSETTINGPERIOD_DATA.goalReminder&&(goalPeriodMonthsData.goalReminder=goalReminderEnable),goalReminderEnable&&PMSSetting.GOALSETTINGPERIOD_DATA.schtimeInt!=time&&(goalPeriodMonthsData.schTimeInt=time);var restrictProgEditInGsp=pageId.find("#restrictProgEditInGsp").is(":checked");void 0!=PMSSetting.GOALSETTINGPERIOD_DATA.restrictProgEditInGsp&&restrictProgEditInGsp!=PMSSetting.GOALSETTINGPERIOD_DATA.restrictProgEditInGsp&&(goalPeriodMonthsData.restrictProgEditInGsp=restrictProgEditInGsp),void 0!=PMSSetting.GOALSETTINGPERIOD_DATA.applicable_fromdate&&PMSSetting.DateForGS.applicable_fromdate!=PMSSetting.GOALSETTINGPERIOD_DATA.applicable_fromdate&&(goalPeriodMonthsData.applicable_fromdate=PMSSetting.DateForGS.applicable_fromdate),void 0!=PMSSetting.GOALSETTINGPERIOD_DATA.applicable_todate&&PMSSetting.DateForGS.applicable_todate!=PMSSetting.GOALSETTINGPERIOD_DATA.applicable_todate&&(goalPeriodMonthsData.applicable_todate=PMSSetting.DateForGS.applicable_todate);var extd=pageId.find("#goalAddExtend").is(":checked");void 0!=PMSSetting.GOALSETTINGPERIOD_DATA.goalExtendOpt&&PMSSetting.GOALSETTINGPERIOD_DATA.goalExtendOpt!=extd&&(goalPeriodMonthsData.goalExtendOpt=extd),goalPeriodMonthsData.isNewJoineeExemptionEnabled=isNewJoineeExemptionEnabled,isNewJoineeExemptionEnabled&&(goalPeriodMonthsData.newJoineeExemptiondays=pageId.find("#newjoineenoofdays").val(),pageId.find("#gsNewJoineenotifyRemSelf").is(":checked")?goalPeriodMonthsData.isNewJoineeSelfReminder=!0:goalPeriodMonthsData.isNewJoineeSelfReminder=!1,pageId.find("#gsNewJoineenotifyRemRM").is(":checked")?goalPeriodMonthsData.isNewJoineeRMReminder=!0:goalPeriodMonthsData.isNewJoineeRMReminder=!1,(pageId.find("#gsNewJoineenotifyRemSelf").is(":checked")||pageId.find("#gsNewJoineenotifyRemRM").is(":checked"))&&(goalPeriodMonthsData.newJoineeReminderConfig=PMSReminderConfig.getReminderConfig(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG)))}else goalPeriodMonthsData.frequency=frequency,goalPeriodMonthsData.frequencyStrMonth=frequencyStrMonth,goalPeriodMonthsData.noofdaysType=noofdaysType,goalPeriodMonthsData.noofdays=noofdays,goalPeriodMonthsData.applicableFor=appFor,goalPeriodMonthsData.restrictProgEditInGsp=!pageId.find("#restrictProgEditInGsp").is(":checked"),goalPeriodMonthsData.repManApplicable=!pageId.find("#repManApplicable").is(":checked"),goalPeriodMonthsData.goalAdminApplicable=!pageId.find("#goalAdminApplicable").is(":checked"),goalPeriodMonthsData.goalExtendOpt=pageId.find("#goalAddExtend").is(":checked"),goalPeriodMonthsData.goalReminder=goalReminderEnable,goalPeriodMonthsData.applicable_fromdate=PMSSetting.DateForGS.applicable_fromdate,goalPeriodMonthsData.applicable_todate=PMSSetting.DateForGS.applicable_todate,goalReminderEnable&&(goalPeriodMonthsData.schTimeInt=time,goalPeriodMonthsData.schtime=startSchTime),goalPeriodMonthsData.isNewJoineeExemptionEnabled=isNewJoineeExemptionEnabled,isNewJoineeExemptionEnabled&&(goalPeriodMonthsData.newJoineeExemptiondays=pageId.find("#newjoineenoofdays").val(),pageId.find("#gsNewJoineenotifyRemSelf").is(":checked")?goalPeriodMonthsData.isNewJoineeSelfReminder=!0:goalPeriodMonthsData.isNewJoineeSelfReminder=!1,pageId.find("#gsNewJoineenotifyRemRM").is(":checked")?goalPeriodMonthsData.isNewJoineeRMReminder=!0:goalPeriodMonthsData.isNewJoineeRMReminder=!1,(pageId.find("#gsNewJoineenotifyRemSelf").is(":checked")||pageId.find("#gsNewJoineenotifyRemRM").is(":checked"))&&(goalPeriodMonthsData.newJoineeReminderConfig=PMSReminderConfig.getReminderConfig(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG)));ZPeople.autosave.loading(pageId.find("#goalperiodpermhdr"),ZPI18N.getString("zp.saving")),PMSSetting.closeResetSave(PMSSetting.SECTION_GOALPERIOD_SETTINGS),ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"submitGoalSettingPeriod",conreqcsr:csrfToken,data:JSON.stringify(goalPeriodMonthsData)},PMSSetting.submitGoalPeriodSuccess)},submitGoalPeriodSuccess:function(resultData){var pageId=settingsPage.container;void 0!=resultData&&void 0!=resultData.frequency?(ZPeople.autosave.success(pageId.find("#goalperiodpermhdr"),ZPI18N.getString("zp.saved")),PMSSetting.GOALSETTINGPERIOD_DATA=resultData,ZPeopleComponents.timefield(pageId.find("#startSchTime")).setAttributes({disabled:!0}),PMSSetting.closeResetSave(PMSSetting.SECTION_GOALPERIOD_SETTINGS),pageId.find("#goalperiodeletediv").show()):void 0!=resultData&&"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALPERIOD_SETTINGS)):PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALPERIOD_SETTINGS)},deleteGoalsettingPeriod:function(){var pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#goalperiodpermhdr"),ZPI18N.getString("zp.saving")),ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"deletGoalSettingPeriod",conreqcsr:csrfToken},PMSSetting.goalperioddeletesuccess)},goalperioddeletesuccess:function(resultData){var pageId=settingsPage.container;void 0!=resultData&&"success"===resultData.msg?(pageId.find("#goalperiodeletediv").hide(),ZPeople.autosave.success(pageId.find("#goalperiodpermhdr"),ZPI18N.getString("zp.deleted")),PMSSetting.GOALSETTINGPERIOD_DATA={},ZPeopleComponents.timefield(pageId.find("#startSchTime")).setAttributes({placeholder:"12:00 AM",value:"12:00 AM",disabled:!0}),PMSSetting.constrctGoalSettingData(!0)):void 0!=resultData&&"permission_denied"===resultData.msg&&ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied"))},onChangeAllowNewJoineeExemption:function(){let pageId=Layout.Page.container;pageId.find("#allownewjoineeexempt").is(":checked")?(pageId.find("#gsNewJoineeNoofDays").removeClass("zpl_DNI"),pageId.find("#gsNewJoineeSelfRemind").removeClass("zpl_DNI"),pageId.find("#gsNewJoineeRMRemind").removeClass("zpl_DNI"),pageId.find("#gsNewJoineeInfo em").text(""),pageId.find("#newjoineenoofdays").val(""),pageId.find("#gsNewJoineeNotification").removeClass("zpl_DNI")):(pageId.find("#gsNewJoineeNoofDays").addClass("zpl_DNI"),pageId.find("#gsNewJoineeSelfRemind").addClass("zpl_DNI"),pageId.find("#gsNewJoineeRMRemind").addClass("zpl_DNI"),pageId.find("#gsNewJoineeInfo").addClass("zpl_DNI"),pageId.find("#gsNewJoineenotifyRemSelf").prop("checked",!1),pageId.find("#gsNewJoineenotifyRemRM").prop("checked",!1),pageId.find("#newjoineedojnotification").prop("checked",!1),pageId.find("#gsNewJoineenotifyRepeat").prop("checked",!1),PMSSetting.onGoalSettingReminderEnableDisable("GOAL_NEWJOINEE_SELF_REMINDER"),PMSSetting.onGoalSettingReminderEnableDisable("GOAL_NEWJOINEE_RM_REMINDER"),PMSSetting.goalSettingNewJoineeRepeatNotificationEnableDisable(),pageId.find("#newjoineenoofdays").val(""),pageId.find("#gsNewJoineeNotification").addClass("zpl_DNI"))},goalSettingNewJoineeValueChange:function(){PMSSetting.isGoalSettingsNewJoineeSectionDataChanged()&&PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALPERIOD_SETTINGS)},onGoalSettingReminderEnableDisable:function(type){let pageId=Layout.Page.container,id="",checkboxid="",customizetempid="";if("GOAL_NEWJOINEE_SELF_REMINDER"==type?(checkboxid="gsNewJoineenotifyRemSelf",id="gsNewJoineeSelfRemind",customizetempid="gsNewJoineeSelfnotify"):"GOAL_NEWJOINEE_RM_REMINDER"==type&&(checkboxid="gsNewJoineenotifyRemRM",id="gsNewJoineeRMRemind",customizetempid="gsNewJoineeRMnotify"),""!=id){pageId.find("#"+checkboxid).is(":checked")?pageId.find("#"+customizetempid).removeClass("zpl_DNI"):pageId.find("#"+customizetempid).addClass("zpl_DNI"),pageId.find("#gsNewJoineenotifyRemRM").is(":checked")||pageId.find("#gsNewJoineenotifyRemSelf").is(":checked")?(pageId.find("#newjoineedobjNotificationDiv").removeClass("zpl_DNI"),pageId.find("#gsNewJoineeRemindRepeat").removeClass("zpl_DNI"),pageId.find("#gsNewJoineeNotifyon").removeClass("zpl_DNI")):(pageId.find("#newjoineedobjNotificationDiv").addClass("zpl_DNI"),pageId.find("#gsNewJoineeRemindRepeat").addClass("zpl_DNI"),pageId.find("#gsNewJoineeNotifyon").addClass("zpl_DNI"),pageId.find("#newjoineedojnotification").prop("checked",!1),pageId.find("#gsNewJoineenotifyRepeat").prop("checked",!1),PMSSetting.goalSettingNewJoineeRepeatNotificationEnableDisable())}},newJoineeReminderExeTimeChange:function(){PMSSetting.isGoalSettingsNewJoineeSectionDataChanged()&&PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALPERIOD_SETTINGS)},goalSettingNewJoineeExecutionTimeEnableDisable:function(){let pageId=Layout.Page.container;pageId.find("#newjoineedojnotification").is(":checked")||pageId.find("#gsNewJoineenotifyRepeat").is(":checked")?(pageId.find("#gsNewJoineeExecutionTime").removeClass("zpl_DNI"),pageId.find("#gsNewJoineeRemindRepeat").find(".zpl_gbox").removeClass("zpl_DNI")):(pageId.find("#gsNewJoineeExecutionTime").addClass("zpl_DNI"),pageId.find("#gsNewJoineeRemindRepeat").find(".zpl_gbox").addClass("zpl_DNI"))},goalSettingNewJoineeRepeatNotificationEnableDisable:function(){let pageId=Layout.Page.container;pageId.find("#gsNewJoineenotifyRepeat").is(":checked")?(pageId.find("#gsNewJoineeRemindRepeat").find("#"+PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG).removeClass("zpl_DNI"),PMSReminderConfig.insertReminderRow(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG,1)):(pageId.find("#gsNewJoineeRemindRepeat").find("#"+PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG).addClass("zpl_DNI"),PMSReminderConfig.removeAllReminderRow(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG)),PMSSetting.goalSettingNewJoineeExecutionTimeEnableDisable()},showHideGSNotifyTmpl:function(type){void 0!=type&&(type==PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_SELF_NOTIFY?PMSSetting.showHideCommence(PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_SELF_NOTIFY):type==PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY&&PMSSetting.showHideCommence(PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY))},isGoalSettingsNewJoineeSectionDataChanged:function(){let pageId=Layout.Page.container,isDataChanged=!1;if(!(void 0!==PMSSetting.GOALSETTINGPERIOD_DATA&&Object.keys(PMSSetting.GOALSETTINGPERIOD_DATA).length>0))pageId.find("#allownewjoineeexempt").is(":checked")&&(isDataChanged=!0);else{let isNewJoineeExemptionEnabled=pageId.find("#allownewjoineeexempt").is(":checked");if(isNewJoineeExemptionEnabled!=PMSSetting.GOALSETTINGPERIOD_DATA.isNewJoineeExemptionEnabled&&(isDataChanged=!0),!isDataChanged&&isNewJoineeExemptionEnabled){pageId.find("#newjoineenoofdays").val()!=PMSSetting.GOALSETTINGPERIOD_DATA.newJoineeExemptiondays&&(isDataChanged=!0),pageId.find("#gsNewJoineenotifyRemSelf").is(":checked")!=PMSSetting.GOALSETTINGPERIOD_DATA.isNewJoineeSelfReminder&&(isDataChanged=!0),pageId.find("#gsNewJoineenotifyRemRM").is(":checked")!=PMSSetting.GOALSETTINGPERIOD_DATA.isNewJoineeRMReminder&&(isDataChanged=!0),!isDataChanged&&PMSReminderConfig.isValueChanged(PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG)&&(isDataChanged=!0)}}return isDataChanged},isGoalDateTypeChanged:function(event){PMSSetting.dataChanged(PMSSetting.SECTION_GOALDATETYPE)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALDATETYPE):PMSSetting.closeResetSave(PMSSetting.SECTION_GOALDATETYPE)},submitGoalDateType:function(){var pageId=settingsPage.container;if(pageId.find("#goalDateFields").parent().find(".ztextbox--error__label").remove(),PMSSetting.dataChanged(PMSSetting.SECTION_GOALDATETYPE)){var params={mode:"pakragoalssettings",conreqcsr:csrfToken,settingsmode:"updateGoalDateType"},goalDateFields=ZPeopleComponents.tokenfield(pageId.find("#goalDateFields")).getAllValues();if(goalDateFields.length>0){var dateFields=[];for(var i in goalDateFields)dateFields.push(goalDateFields[i].id);params.dateFields=JSON.stringify(dateFields),ZPeople.autosave.loading(pageId.find("#goalDateHdr"),ZPI18N.getString("zp.saving")),PMSSetting.closeResetSave(PMSSetting.SECTION_GOALDATETYPE),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(resultData){void 0!=resultData&&void 0!=resultData.msg&&("success"==resultData.msg?(ZPeople.autosave.success(pageId.find("#goalDateHdr"),ZPI18N.getString("zp.saved")),PMSSetting.kraGoalDefaultObject.goalDateType=resultData.goalDateType,PMSSetting.closeResetSave(PMSSetting.SECTION_GOALDATETYPE)):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#goalDateHdr")),PMSCommon.autosave.enableHdrBtn(pageId.find("#goalDateHdr"))):(PMSCommon.autosave.clearelement(pageId.find("#goalDateHdr")),PMSCommon.autosave.enableHdrBtn(pageId.find("#goalDateHdr"))))}})}else pageId.find("#goalDateFields").parent().append('<span class="ztextbox--error__label">Please select goals date fields</span>')}},disTwoDigit:function(val,singleDigitHrs){return val>9||singleDigitHrs?val.toString():"0"+val},editModuleName:function(module,dispName,appcompid){var componentName,islenerror=!1;if(dispName.length>25&&(islenerror=!0,ZPeople.Message.warning(ZPI18N.getString("zp.fieldpropertymaxlength",["Module Name","25 characters"]))),!islenerror&&""!=dispName){var param={mode:"editmodulename",appcompid:appcompid,dispname:dispName,conreqcsr:csrfToken},isForm=!1;$.each(PMSSetting.ENABLED_MODULES,function(key,data){data.compID===appcompid&&(componentName=data.compName,"GOALS"!==data.compName&&"KRA"!==data.compName||(isForm=!0))}),param.formData=!!isForm,dispName===PMSSetting.ORIG_COMPONENTS[componentName]?param.reset=!0:param.reset=!1,$.post("/performanceConfig.zp",param,function(resultData){"success"==resultData.msg?(PMSSetting.getPerformanceModules(),ZPeople.Message.success(ZPI18N.getString("zp.moduleeditsucc"))):"failure"==resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")):ZPeople.Message.failure(ZPI18N.getString("zp.permdenied"))})}},getComponentObj:function(componentName){var _compObj="";return $.each(PMSSetting.ENABLED_MODULES,function(key,data){data.compName===componentName&&(_compObj=data)}),_compObj},getComponentObjForId:function(componentId){var _compObj="";return $.each(PMSSetting.ENABLED_MODULES,function(key,data){data.compID===componentId&&(_compObj=data)}),_compObj},fetchKRAGoalsData:function(showPage){$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getSettingsConfig",submode:"getkragoalsconfig",conreqcsr:csrfToken},success:function(resultData){PMSSetting.setKRAGoalsConfig(showPage,resultData)}})},enableKRASorting:function(event){var pageId=settingsPage.container,type=0;event.detail.state?(pageId.find("#showKSW").show(),pageId.find("#showKSW input[value='1']").prop("checked",!0),type=1):pageId.find("#showKSW").hide(),PMSSetting.updateKRAWeightSorting(type)},updateKRAWeightSorting:function(type){var pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#kraweighthdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",conreqcsr:csrfToken,kraSortType:type,settingsmode:"updatekrasorting"},success:function(resultData){"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#kraweighthdr"),ZPI18N.getString("zp.saved")):"permission_denied"===resultData.msg?(PMSCommon.autosave.clearelement(pageId.find("#kraweighthdr")),ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied"))):(PMSCommon.autosave.clearelement(pageId.find("#kraweighthdr")),ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")))}})},enableDisableKraWeightageRang:function(event){if(event.detail.fromUI){var pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#kraweighthdr"),ZPI18N.getString("zp.saving"));var state=event.detail.state?1:0;$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",conreqcsr:csrfToken,kraweightagerange:state,settingsmode:"updatekraweightagerange"},success:function(resultData){"success"==resultData.msg?(ZPeople.autosave.success(pageId.find("#kraweighthdr"),ZPI18N.getString("zp.saved")),resultData.data.kraweightagerange?pageId.find("#userkraweightrangemandatory").parent().parent().removeClass("zpl_DNI"):(pageId.find("#userkraweightrangemandatory").parent().parent().addClass("zpl_DNI"),pageId.find("#userkraweightrangemandatory").prop("checked",!1))):"permission_denied"===resultData.msg?(PMSCommon.autosave.clearelement(pageId.find("#kraweighthdr")),ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied"))):(PMSCommon.autosave.clearelement(pageId.find("#kraweighthdr")),ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")))}})}},restrictKraWeightageRangeMandatory:function(obj){var pageId=settingsPage.container,_restrictKraWeightageRangeMandatory=$(obj).find("input").is(":checked")?1:0;ZPeople.autosave.loading(pageId.find("#kraweighthdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",conreqcsr:csrfToken,restrictKraWeightageRangeMandatory:_restrictKraWeightageRangeMandatory,settingsmode:"restrictKraWeightageRangeMandatory"},success:function(resultData){"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#kraweighthdr"),ZPI18N.getString("zp.saved")):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#kraweighthdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#kraweighthdr")))}})},updateGoalArchive:function(elem){var pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#goalarchivehdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",conreqcsr:csrfToken,archivePermission:$(elem).val(),settingsmode:"goalarchive"},success:function(resultData){"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#goalarchivehdr"),ZPI18N.getString("zp.saved")):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#goalarchivehdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#goalarchivehdr")))}})},enableDisableKRAWeightage:function(event){if(event.detail.fromUI){var data=event.detail,pageId=settingsPage.container,state=data.state?0:1;ZPeople.autosave.loading(pageId.find("#kraweighthdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",conreqcsr:csrfToken,kraweightagedisabled:state,kraSortType:"0",settingsmode:"updatekraweitage"},success:function(resultData){if("success"==resultData.msg){var data=resultData.data;ZPeople.autosave.success(pageId.find("#kraweighthdr"),ZPI18N.getString("zp.saved")),data.kraweightagedisabled?pageId.find("#krarestrictweightage").addClass("DN"):pageId.find("#krarestrictweightage").removeClass("DN"),pageId.find("#enbleKRAS").ztoggleswitch("switchOff"),pageId.find("#showKSW input[value='1']").prop("checked",!0),pageId.find("#kraweightagerange").ztoggleswitch("switchOff")}else"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#kraweighthdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#kraweighthdr")))}})}},enableGoalArchive:function(event){if(event.detail.fromUI){var data=event.detail,pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#goalarchivehdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",conreqcsr:csrfToken,goalarchiveenable:data.state,settingsmode:"updaterestrictgoalarchive"},success:function(resultData){if("success"==resultData.msg){var data=resultData.data;ZPeople.autosave.success(pageId.find("#goalarchivehdr"),ZPI18N.getString("zp.saved")),pageId.find("#showGoalArchPerm").toggleClass("zpl_DNI",!data.goalsArchiveEnabled)}else"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#goalarchivehdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#goalarchivehdr")))}})}},restrictKraWeightageValidation:function(obj){var pageId=settingsPage.container,_restrictKraWeightageValidation=$(obj).find("input").is(":checked")?0:1;ZPeople.autosave.loading(pageId.find("#kraweighthdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",conreqcsr:csrfToken,restrictKraWeightageValidation:_restrictKraWeightageValidation,settingsmode:"restrictweightagevalidation"},success:function(resultData){"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#kraweighthdr"),ZPI18N.getString("zp.saved")):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#kraweighthdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#kraweighthdr")))}})},enableGoalWigtageValidation:function(event){var pageId=settingsPage.container,isgoalWeighatgeValidationEnabled=0;event.detail.state?(pageId.find("#showGWV input[value='1']").prop("checked",!0),isgoalWeighatgeValidationEnabled=pageId.find("#showGWV").find("[name=goalWeightageValidate]:checked").attr("value"),pageId.find("#showGWV").removeClass("DN")):pageId.find("#showGWV").addClass("DN"),PMSSetting.updateGoalWigtageValidation(isgoalWeighatgeValidationEnabled)},updateGoalWigtageValidation:function(isgoalWeighatgeValidationEnabled){var pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#goalweighthdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",conreqcsr:csrfToken,goalWeightageValidationEnabled:isgoalWeighatgeValidationEnabled,settingsmode:"enablegoalweightagevalidation"},success:function(resultData){"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#goalweighthdr"),ZPI18N.getString("zp.saved")):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#goalweighthdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#goalweighthdr")))}})},setKRAPermissions:function(kraPermissionData){var pageId=settingsPage.container;void 0!=kraPermissionData&&null!=kraPermissionData&&(pageId.find("#kraView_Self")[0].checked=!0,pageId.find("#kraAdd_Self")[0].checked=kraPermissionData.isKraAdd_Self,pageId.find("#kraTag_Self")[0].checked=kraPermissionData.isKraTag_Self,pageId.find("#kraDelete_Self")[0].checked=kraPermissionData.isKraDelete_Self,pageId.find("#kraView_Rep")[0].checked=!0,pageId.find("#kraAdd_Rep")[0].checked=kraPermissionData.isKraAdd_Rep,pageId.find("#kraTag_Rep")[0].checked=kraPermissionData.isKraTag_Rep,pageId.find("#kraDelete_Rep")[0].checked=kraPermissionData.isKraDelete_Rep)},checkKraTagPermission:function(obj){var pageId=settingsPage.container,id=$(obj).attr("id");$(obj).prop("checked")&&("kraAdd_Self"!=id||pageId.find("#kraTag_Self").prop("checked")?"kraAdd_Rep"!=id||pageId.find("#kraTag_Rep").prop("checked")||pageId.find("#kraTag_Rep").prop("checked",!0):pageId.find("#kraTag_Self").prop("checked",!0)),"kraAdd_Self"!=id&&"kraAdd_Rep"!=id||(pageId.find("#kraAdd_Self").prop("checked")||pageId.find("#kraAdd_Rep").prop("checked")?pageId.find("#userSpfKra").removeClass("zpl_DNI"):(pageId.find("#userSpfKra").addClass("zpl_DNI"),pageId.find("#userOrgKra").ztoggleswitch("switchOff")))},checkKraAddPermission:function(obj){var pageId=settingsPage.container,id=$(obj).attr("id");$(obj).prop("checked")||("kraTag_Self"==id&&pageId.find("#kraAdd_Self").prop("checked")?pageId.find("#kraAdd_Self").prop("checked",!1):"kraTag_Rep"==id&&pageId.find("#kraAdd_Rep").prop("checked")&&pageId.find("#kraAdd_Rep").prop("checked",!1))},saveKraPermission:function(){var pageId=settingsPage.container,isKraAdd_Self=pageId.find("#kraAdd_Self").prop("checked"),isKraTag_Self=pageId.find("#kraTag_Self").prop("checked"),isKraDelete_Self=pageId.find("#kraDelete_Self").prop("checked"),isKraAdd_Rep=pageId.find("#kraAdd_Rep").prop("checked"),isKraTag_Rep=pageId.find("#kraTag_Rep").prop("checked"),isKraDelete_Rep=pageId.find("#kraDelete_Rep").prop("checked"),isConvertKraEnabled=pageId.find("#userOrgKra").prop("checked"),kraPermissions={isKraAdd_Self:isKraAdd_Self,isKraTag_Self:isKraTag_Self,isKraDelete_Self:isKraDelete_Self,isKraAdd_Rep:isKraAdd_Rep,isKraTag_Rep:isKraTag_Rep,isKraDelete_Rep:isKraDelete_Rep};if(PMSSetting.closeResetSave(PMSCommon.SECTION_KRA_ACCESS),ZPeople.autosave.loading(pageId.find("#kraaccesspermhdr"),ZPI18N.getString("zp.saving")),!isKraAdd_Self&&!isKraAdd_Rep&&isConvertKraEnabled)return ZPeople.Message.failure(ZPI18N.getString("zp.orgKRAerrmsg")),void PMSCommon.autosave.clearelement(pageId.find("#kraaccesspermhdr"));var state=isConvertKraEnabled?1:0;$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",settingsmode:"updateKraPermission",orgKraPermEnabled:state,kraPermissionData:JSON.stringify(kraPermissions),conreqcsr:csrfToken},success:function(resultData){"success"==resultData.msg?(PMSSetting.kraGoalDefaultObject.kraPermissionData=resultData.data.kraPermissions,PMSSetting.kraGoalDefaultObject.convertOrgKra=resultData.data.convertUserKRAtoOrgKRA,ZPeople.autosave.success(pageId.find("#kraaccesspermhdr"),ZPI18N.getString("zp.saved")),PMSSetting.closeResetSave(PMSCommon.SECTION_KRA_ACCESS)):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#kraaccesspermhdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#kraaccesspermhdr")))}})},isKraUserApprConfigured:function(){var pageId=settingsPage.container;null!=PMSSetting.kraUserFormId&&null!=PMSSetting.isKraUserApprConf||$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getKraUserApprConf",conreqcsr:csrfToken},success:function(resultData){PMSSetting.kraUserFormId=resultData.kraUserFormId,PMSSetting.isKraUserApprConf=resultData.isKraUserApprConf,PMSSetting.kraUserApprovalId=resultData.approvalId}}),pageId.find("#kraUserApproval").show();let custClickMsg=PMSSetting.isKraUserApprConf?"zp.customizeapproval":"zp.multiraterapprovalmsg",kraUrlLink="#settings/service/performance/approval";PMSSetting.kraUserFormId&&(kraUrlLink+="-formid:"+PMSSetting.kraUserFormId);let approvalTxt='<a target="_blank" href="'+kraUrlLink+'" class="u-link zpl_link">'+ZPI18N.getString("zp.clickhere")+"</a>"+ZPI18N.getString(custClickMsg,new Array(PMSSetting.KRA_DISPLAY_NAME));pageId.find("#kraApprovalLink").html(approvalTxt)},configureKraUserApproval:function(event){var pageId=settingsPage.container;event.detail.state?PMSSetting.isKraUserApprConfigured():pageId.find("#kraUserApproval").hide(),PMSSetting.dataChanged(PMSCommon.SECTION_KRA_APPROVAL)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_KRA_APPROVAL):PMSSetting.closeResetSave(PMSCommon.SECTION_KRA_APPROVAL)},saveKraApproval:function(){var pageId=settingsPage.container,isKraApproval=ZPeopleComponents.toggleswitch(pageId.find("#kraApproval")).getState();PMSSetting.closeResetSave(PMSCommon.SECTION_KRA_APPROVAL),ZPeople.autosave.loading(pageId.find("#kraapprhdr"),ZPI18N.getString("zp.saving"));var params={mode:"pakragoalssettings",settingsmode:"updateKraApproval",conreqcsr:csrfToken};params.kraApproval=isKraApproval?1:0,$.ajax({type:"POST",async:!1,url:"./performanceConfig.zp",data:params,success:function(resultData){"success"==resultData.msg?(PMSSetting.kraGoalDefaultObject.kraApproval=resultData.data.kraApproval,ZPeople.autosave.success(pageId.find("#kraapprhdr"),ZPI18N.getString("zp.saved")),PMSSetting.closeResetSave(PMSCommon.SECTION_KRA_APPROVAL)):"appr_not_configured"==resultData.msg?(ZPeople.Message.failure(ZPI18N.getString("zp.pa.kra.configapproval",new Array(PMSSetting.KRA_DISPLAY_NAME))),PMSCommon.autosave.clearelement(pageId.find("#kraapprhdr")),PMSSetting.getSaveResetBtn(PMSCommon.SECTION_KRA_APPROVAL)):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#kraapprhdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#kraapprhdr")))}})},changeGoalSettings:function(event){if(event.detail.fromUI){var pageId=settingsPage.container,data=event.detail;pageId.find("#goalSettingsData input[type=checkbox]").each(function(){$(this).prop("checked",!1)}),"-1"!=data.selectedValue?PMSSetting.goalSettingsChckBxEnable(!1):PMSSetting.goalSettingsChckBxEnable(!0),PMSSetting.dataChanged(PMSCommon.SECTION_GOAL_ACCESS)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_GOAL_ACCESS):PMSSetting.closeResetSave(PMSCommon.SECTION_GOAL_ACCESS)}},goalSettingsChckBxEnable:function(isEnable){var pageId=settingsPage.container;isEnable?pageId.find("#goalSettingsData input[type=checkbox]").each(function(){$(this).prop("disabled",!0)}):pageId.find("#goalSettingsData input[type=checkbox]").each(function(){$(this).prop("disabled",!1)})},updateGoalPermissions:function(){var pageId=settingsPage.container,formCompId=ZPeopleComponents.select(pageId.find("#nonAdnGFCId")).getValue(),goalSettingData=null;if(null!=formCompId&&-1!=formCompId){var isView=pageId.find("#goalViewPer").prop("checked"),isDelete=pageId.find("#goalDeletePer").prop("checked"),isEdit=pageId.find("#goalEditPer").prop("checked"),isAdd=pageId.find("#goalAddPer").prop("checked"),isValid=!1;if(isView||isDelete||isEdit||isAdd||(ZPeople.Message.failure(ZPI18N.getString("zp.selectanyonePermission")),isValid=!0),isView||!isDelete&&!isEdit||(ZPeople.Message.failure(ZPI18N.getString("zp.editdeletePermError")),isValid=!0),isValid)return;goalSettingData={formCompId:formCompId,isView:isView,isDelete:isDelete,isEdit:isEdit,isAdd:isAdd}}else goalSettingData={formCompId:formCompId+""};PMSSetting.closeResetSave(PMSCommon.SECTION_GOAL_ACCESS),ZPeople.autosave.loading(pageId.find("#goalaccesspermhdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pakragoalssettings",conreqcsr:csrfToken,goalsData:JSON.stringify(goalSettingData),settingsmode:"goalSettingData"},success:function(resultData){if("success"==resultData.msg){var data=resultData.data;PMSSetting.kraGoalDefaultObject.goalSettingsData=data.goalSettingsData,ZPeople.autosave.success(pageId.find("#goalaccesspermhdr"),ZPI18N.getString("zp.saved")),PMSSetting.closeResetSave(PMSCommon.SECTION_GOAL_ACCESS)}else"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#goalaccesspermhdr")),PMSCommon.autosave.enableHdrBtn(pageId.find("#goalaccesspermhdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#goalaccesspermhdr")),PMSCommon.autosave.enableHdrBtn(pageId.find("#goalaccesspermhdr")))}})},feedbackInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;if(PMSOperationCommon.addClearCentreClass(!0),PMSSetting.validateModuleStatus("FeedBack"))return;$.ajax({type:"POST",async:!1,url:"/performance/view/feedbackSettings",data:{conreqcsr:csrfToken},success:function(resultData){pageId.html(""),pageId.append(resultData),PMSSetting.fetchFeedbackConfigData()}})}},fetchFeedbackConfigData:function(){$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getSettingsConfig",submode:"getfeedbackconfig",conreqcsr:csrfToken},success:function(resultData){PMSSetting.feedbackDefaultObject=resultData,PMSSetting.setFeedBackData(resultData)}})},getFeedbackCategoryHtm:function(data){var fbHtmlList="";if("true"==data.isActive||1==data.isActive){var className=PMSSetting.FEEDBACK_IMAGES[data.imageType];"-1"===data.imageType&&(className="PI_chat blu");var disableClass="true"==data.isdisabled||data.isdisabled?"grybg3":"";fbHtmlList+='<div id="feedbacktype_'+data.typeId+'" class="'+disableClass+'"> <div class="zpl_Fltyp"> <i class="'+className+'"></i> </div> <div class="zpl_Fldtl"> <span>'+data.typeName+"</span> </div>",fbHtmlList+=PMSSetting.getCateEditDelHtm(data.type,data.typeId,data.isdisabled),fbHtmlList+="</div>"}return fbHtmlList},getCateEditDelHtm:function(type,typeId,isdisabled){var fbHtmlList='<div class="zpl_actn"><span><i data-menu-id="'+typeId+'_moremenu" id="'+typeId+'_moreicon" class="PI_more" title="'+ZPI18N.getString("zp.more")+'" onclick="PMSSetting.feedbackmoreicon(event,this,\''+typeId+"')\"></i>";return fbHtmlList+="</span>",fbHtmlList+="</div>"},getFdkMenuList:function(type,typeId,isdisabled){var fbHtmlList=' <div id="'+typeId+'_moremenu" data-type="list" data-direction="auto" data-display-type="callout" data-content-type="text"><ul>';return fbHtmlList+='<li id="feedbackTypeEnDis" rel="'+typeId+'" ftype="'+type+'">'+("true"==isdisabled||isdisabled?ZPI18N.getString("zp.enable"):ZPI18N.getString("zp.disable"))+"</li>","false"!==isdisabled&&isdisabled||(fbHtmlList+='<li id="feedbackTypeEdit" rel="'+typeId+'">'+ZPI18N.getString("zp.edit")+"</li>","1"===type&&(fbHtmlList+='<li id="feedbackTypeDel" rel="'+typeId+'" >'+ZPI18N.getString("zp.delete")+"</li>")),fbHtmlList+="</ul></div>"},disableFeedbackType:function(type,fbId){var isEnable,pageId=settingsPage.container;isEnable=pageId.find("#feedbacktype_"+fbId).hasClass("grybg3"),ZPeople.autosave.loading(pageId.find("#feedbackcategoryhdr"),ZPI18N.getString("zp.saving"));var params={mode:"disablefeedbackType",feeadbackTypeId:fbId,status:isEnable,conreqcsr:csrfToken};$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(resultData){if(void 0!==resultData&&"success"===resultData.msg){for(var isdisabled=!isEnable,fbTypeList=PMSSetting.feedbackDefaultObject.fbTypeList,index=0;index<fbTypeList.length;index++){if(fbTypeList[index].typeId==fbId){PMSSetting.feedbackDefaultObject.fbTypeList[index].isdisabled=isdisabled;break}}PMSSetting.setFeedbackCategory(PMSSetting.feedbackDefaultObject.fbTypeList),ZPeople.autosave.success(pageId.find("#feedbackcategoryhdr"),ZPI18N.getString("zp.saved"))}else"invalid_input"===resultData.msg?(ZPeople.Message.failure(ZPI18N.getString("zp.defaultfeedbackcantbedeleted",new Array(PMSSetting.FEEDBACK_DISPLAY_NAME))),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr"))):"notallowedtodisable"===resultData.msg?(ZPeople.Message.failure(ZPI18N.getString("zp.enabledatleastonefeedback")),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr"))):"error"===resultData.msg&&(ZPeople.Message.failure(ZPI18N.getString("zp.erroroccuredtryagain")),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr")))}})},feedbackmoreicon:function(e,obj,id){for(var pageId=settingsPage.container,fbTypeList=PMSSetting.feedbackDefaultObject.fbTypeList,data="",index=0;index<fbTypeList.length;index++){var v=fbTypeList[index];v.typeId==id&&(data=v)}PMSSetting.FEEDBACK_MENUOBJ.hasOwnProperty(id)&&PMSSetting.FEEDBACK_MENUOBJ[id].destroy();var _editDelHtm=PMSSetting.getFdkMenuList(data.type,data.typeId,data.isdisabled);pageId.find("#"+id+"_moreicon").parent().append($(_editDelHtm)),PMSSetting.feedbackCategoryMenu(id),PMSSetting.FEEDBACK_MENUOBJ[id].show()},feedbackCategoryMenu:function(fbId){var pageId=settingsPage.container;PMSSetting.FEEDBACK_MENUOBJ[fbId]=ZPeopleComponents.menu(pageId.find("#"+fbId+"_moremenu"),{forElement:pageId.find("#"+fbId+"_moreicon"),itemclick:e=>{var detail=e.detail;if("feedbackTypeEdit"==detail.attrs.id)PMSSetting.editDeleteSubmit(detail.attrs.rel);else if("feedbackTypeEnDis"==detail.attrs.id)PMSSetting.disableFeedbackType(detail.attrs.ftype,detail.attrs.rel);else if("feedbackTypeDel"==detail.attrs.id){var deletePopUp=new DeleteAlertMessage;deletePopUp.title="",deletePopUp.despcription=ZPI18N.getString("zp.deleteconfirmtitle"),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){PMSSetting.deleteFeedbackCategory(detail.attrs.rel)},deletePopUp.show()}}})},setFeedbackCategory:function(fbTypeList){var pageId=settingsPage.container;PMSSetting.FEEDBACK_MENUOBJ={},PMSSetting.FDBK_EDIT_OPEN=!1;var fbHtmlList='<div id="addFeedbackcategory" class="zpl_lnk"><div class="zpl_Fltyp"> <i class="PI_ATd"> <i class="path1"> <i class="path2"></i> </i> </i> </div><div class="zpl_Fldtl">'+ZPI18N.getString("zp.addcategory")+"</div> </div>";fbHtmlList+='<div id="feedbackcategoryinput" style="display:none"></div>',pageId.find("#feedbackCategories_List").html(fbHtmlList);for(var index=0;index<fbTypeList.length;index++){"true"!=(data=fbTypeList[index]).isActive&&1!=data.isActive||"true"==data.isdisabled||data.isdisabled||pageId.find("#feedbackCategories_List").append(PMSSetting.getFeedbackCategoryHtm(data))}for(index=0;index<fbTypeList.length;index++){var data;"true"!=(data=fbTypeList[index]).isActive&&1!=data.isActive||("true"==data.isdisabled||data.isdisabled)&&pageId.find("#feedbackCategories_List").append(PMSSetting.getFeedbackCategoryHtm(data))}pageId.find("#addFeedbackcategory").click(function(){pageId.find("#addFeedbackcategory").hide();pageId.find("#feedbackcategoryinput").html('<div class="zpl_Fldtl"> <input type="text" class="ztextbox" id="feedbackcateeditadd"> </div> <div class="zpl_actn zpl_actv"> <span><i class="PI_tick"></i><i class="PI_cls red"></i></span> </div> ').show(),pageId.find("#feedbackcategoryinput .PI_tick").click(function(){var _addTypeName=pageId.find("#feedbackcateeditadd").val();PMSSetting.addOrUpdateFeedbackCategory(!1,_addTypeName)}),pageId.find("#feedbackcategoryinput .PI_cls").click(function(){pageId.find("#addFeedbackcategory").show(),pageId.find("#feedbackcategoryinput").empty().hide()}),pageId.find("#feedbackcateeditadd").bind("keypress",function(e){13==e.keyCode?PMSSetting.addOrUpdateFeedbackCategory(!1,$(this).val()):""!=$(this).val()&&pageId.find("#feedbackcateeditadd").removeClass("ztextbox__error")}),pageId.find("#feedbackcateeditadd").focus()})},setFeedBackData:function(resultData){var pageId=settingsPage.container,fbTypeList=resultData.fbTypeList;PMSSetting.setFeedbackCategory(fbTypeList);var _fbComponents=PMSSetting.ENABLED_MODULES,fbTypeHtml="",repHtml="",peertopeerHtml="",html360="";$.each(_fbComponents,function(index,data){var componentName=PMSSetting.COMPONENTS[data.compName];"REPORTING_TO"===data.compName?repHtml='<div class="zpl_secn"><div class="zpl_info"><div><em>'+ZPI18N.getString("zp.pa.fdbkreptonote",new Array(PMSSetting.FEEDBACK_DISPLAY_NAME))+"</em></div></div></div>":("PEER_TO_PEER"===data.compName&&(peertopeerHtml='<div class="zpl_secn"> <div class="chkdectxt"> <div class="zcheckbox" onchange="PMSSetting.disablefeebackTypeStatus(this,\''+data.compID+"', '"+data.compName+'\')"> <input id="'+data.compName+'" type="checkbox" name="check" class="zcheckbox__helper"> <label for="'+data.compName+'" class="zcheckbox__label" >'+componentName+'</label> </div> <span class="dectxt">'+ZPI18N.getString("zp.pa.fdbkpeer",new Array(PMSSetting.FEEDBACK_DISPLAY_NAME))+"</span> </div> </div>"),"360_FEEDBACK"===data.compName&&(html360='<div class="zpl_secn"> <div class="chkdectxt"> <div class="zcheckbox" onchange="PMSSetting.disablefeebackTypeStatus(this,\''+data.compID+"', '"+data.compName+'\')"> <input id="'+data.compName+'" type="checkbox" name="check" class="zcheckbox__helper"> <label for="'+data.compName+'" class="zcheckbox__label">'+componentName+'</label> </div> <span class="dectxt">'+ZPI18N.getString("zp.orglvlfdbk",new Array(PMSSetting.FEEDBACK_DISPLAY_NAME))+"</span> </div> </div>"))}),fbTypeHtml+=repHtml,fbTypeHtml+=peertopeerHtml,fbTypeHtml+=html360,pageId.find("#feedbackSystemList").html(fbTypeHtml);var _peerCompObj=PMSSetting.ENABLED_MODULES.PEER_TO_PEER;"1"==_peerCompObj.enable&&pageId.find("#"+_peerCompObj.compName).prop("checked",!0);var _feedbnack360CompObj=PMSSetting.ENABLED_MODULES["360_FEEDBACK"];"1"==_feedbnack360CompObj.enable&&pageId.find("#"+_feedbnack360CompObj.compName).prop("checked",!0);var _fblevelElem=resultData.orgFB?"#fblevelorg":"#fbleveldept";pageId.find(_fblevelElem).prop("checked",!0),pageId.find("#fblevel input[type=radio]").change(function(){PMSSetting.feedbackLevel($(this))}),ZPeopleComponents.toggleswitch(pageId.find("#anonymfb")).setAttributes({on:resultData.anonymousFB,change:PMSSetting.anonymfb}),ZPeopleComponents.toggleswitch(pageId.find("#enablefbr")).setAttributes({on:resultData.enableRequestFB,change:PMSSetting.requestFB})},editDeleteSubmit:function(typeid){var pageId=settingsPage.container;if(PMSSetting.FDBK_EDIT_OPEN)pageId.find("[id^=feedbacktype_]").find(".ztextbox").addClass("ztextbox__error");else{PMSSetting.FDBK_EDIT_OPEN=!0;var _feedbacktypeparentEle=pageId.find("#feedbacktype_"+typeid);$(_feedbacktypeparentEle).find(".zpl_actn").remove();var _typeName=$(_feedbacktypeparentEle).find("span").text();$(_feedbacktypeparentEle).find(".zpl_Fldtl").html('<input type="text" value="'+_typeName+'" class="ztextbox">');var submitTick=$(_feedbacktypeparentEle).append($('<div class="zpl_actn zpl_actv"> <span><i class="PI_tick"></i><i class="PI_cls red"></i></span> </div>'));$(submitTick).find(".PI_tick").click(function(){var _editTickParent=$(this).parent().parent().parent(),_etypeId=$(_editTickParent).attr("id"),_eTypeName=$(_editTickParent).find("input").val();PMSSetting.addOrUpdateFeedbackCategory(!0,_eTypeName,_etypeId.split("_")[1])}),$(submitTick).find(".PI_cls").click(function(){for(var fbTypeList=PMSSetting.feedbackDefaultObject.fbTypeList,index=0;index<fbTypeList.length;index++){var v=fbTypeList[index];v.isActive&&PMSSetting.FEEDBACK_MENUOBJ.hasOwnProperty(v.typeId)&&PMSSetting.FEEDBACK_MENUOBJ[v.typeId].destroy()}pageId.find("#feedbackCategories_List").empty(),PMSSetting.setFeedbackCategory(fbTypeList)}),$(submitTick).find("input").bind("keypress",function(e){if(13==e.keyCode){var _editInpTickParent=$(this).parent().parent(),_einptypeId=$(_editInpTickParent).attr("id");PMSSetting.addOrUpdateFeedbackCategory(!0,$(this).val(),_einptypeId.split("_")[1])}else""!=$(this).val()&&_feedbacktypeparentEle.find("input").removeClass("ztextbox__error")});var feedbackinput=$(_feedbacktypeparentEle).find("input");feedbackinput[0].selectionStart=_typeName.length,feedbackinput[0].selectionEnd=_typeName.length,feedbackinput.focus()}},addOrUpdateFeedbackCategory:function(isEdit,typeName,editTypeId){var pageId=settingsPage.container,isValid=!1;if(""==typeName.trim()||typeName.trim().length>100)return isValid=!0,isEdit?pageId.find("#feedbacktype_"+editTypeId).find("input").addClass("ztextbox__error"):pageId.find("#feedbackcateeditadd").addClass("ztextbox__error"),void(""==typeName.trim()?ZPeople.Message.failure(ZPI18N.getString("zp.entervalidinput")):ZPeople.Message.failure(ZPI18N.getString("zp.fieldpropertymaxlength",[ZPI18N.getString("zp.assessment.random.count_categories",[PMSSetting.FEEDBACK_DISPLAY_NAME]),"100"])));if(isEdit?pageId.find("#feedbacktype_"+editTypeId).find("input").removeClass("ztextbox__error"):pageId.find("#feedbackcateeditadd").removeClass("ztextbox__error"),!isValid&&isEdit)for(var fbTypeList=PMSSetting.feedbackDefaultObject.fbTypeList,index=0;index<fbTypeList.length;index++){var data=fbTypeList[index];"true"!=data.isActive&&1!=data.isActive||data.typeId!=editTypeId||typeName!=data.typeName||(isValid=!0)}if(isValid){for(fbTypeList=PMSSetting.feedbackDefaultObject.fbTypeList,index=0;index<fbTypeList.length;index++){var v=fbTypeList[index];v.isActive&&PMSSetting.FEEDBACK_MENUOBJ.hasOwnProperty(v.typeId)&&PMSSetting.FEEDBACK_MENUOBJ[v.typeId].destroy()}pageId.find("#feedbackCategories_List").empty(),PMSSetting.setFeedbackCategory(fbTypeList)}else{var feedbackCateParams={typeName:typeName};isEdit&&(feedbackCateParams.editTypeId=editTypeId),ZPeople.autosave.loading(pageId.find("#feedbackcategoryhdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"feedbacksettings",conreqcsr:csrfToken,feedbackData:JSON.stringify(feedbackCateParams),submode:"updateFeedbackCategory"},success:function(resultData){if("sucess"==resultData.msg){if(isEdit){var fbTypeListtemp=PMSSetting.feedbackDefaultObject.fbTypeList;for(var i in fbTypeListtemp){var ftypObj=fbTypeListtemp[i];if(resultData.typeId==ftypObj.typeId){ftypObj.imageType=resultData.imageType,ftypObj.isActive=resultData.isActive,ftypObj.isdisabled=!1,ftypObj.type=resultData.type,ftypObj.typeName=resultData.typeName;break}}}else{var fbObj={};fbObj.imageType=resultData.imageType,fbObj.isActive=resultData.isActive,fbObj.isdisabled=!1,fbObj.type=resultData.type,fbObj.typeId=resultData.typeId,fbObj.typeName=resultData.typeName,PMSSetting.feedbackDefaultObject.fbTypeList.push(fbObj)}PMSSetting.aftAddOrUpdFeedbackCategory(isEdit,resultData),ZPeople.autosave.success(pageId.find("#feedbackcategoryhdr"),ZPI18N.getString("zp.saved")),PMSSetting.FDBK_EDIT_OPEN=!1}else"duplicate entry"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.duplicatecategory",new Array(PMSSetting.FEEDBACK_DISPLAY_NAME))),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr"))):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr")))}})}},aftAddOrUpdFeedbackCategory:function(isEdit,resultData){var pageId=settingsPage.container;if(isEdit){var typeId="#feedbacktype_"+resultData.typeId;pageId.find(typeId+" input").parent().html("<span>"+resultData.typeName+"</span>"),pageId.find(typeId+" .PI_tick").parent().parent().remove();var _editDelHtm=PMSSetting.getCateEditDelHtm(resultData.type,resultData.typeId,resultData.isdisabled);pageId.find(typeId).append($(_editDelHtm))}else{var _htm=PMSSetting.getFeedbackCategoryHtm(resultData);$("#feedbackCategories_List").append($(_htm)),pageId.find("#feedbackcategoryinput").hide(),pageId.find("#addFeedbackcategory").show();typeId="#feedbacktype_"+resultData.typeId}},deleteFeedbackCategory:function(_editTypeId){var pageId=settingsPage.container,feedbackCateParams={editTypeId:_editTypeId};ZPeople.autosave.loading(pageId.find("#feedbackcategoryhdr"),"Deleting...."),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"feedbacksettings",conreqcsr:csrfToken,feedbackData:JSON.stringify(feedbackCateParams),submode:"deletefeedbackTypeList"},success:function(resultData){"success"==resultData.msg?(PMSSetting.FEEDBACK_MENUOBJ.hasOwnProperty(_editTypeId)&&delete PMSSetting.FEEDBACK_MENUOBJ[_editTypeId],pageId.find("#feedbacktype_"+_editTypeId).remove(),$.each(PMSSetting.feedbackDefaultObject.fbTypeList,function(key,value){value.typeId===_editTypeId&&(value.isActive=!1)}),ZPeople.autosave.success(pageId.find("#feedbackcategoryhdr"),ZPI18N.getString("zp.deleted"))):"invalid_input"===resultData.msg?(ZPeople.Message.failure(ZPI18N.getString("zp.defaultfeedbackcantbedeleted",new Array(PMSSetting.FEEDBACK_DISPLAY_NAME))),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr"))):"NOT_ALLOWED_TO_DELETE"===resultData.msg?(ZPeople.Message.failure(ZPI18N.getString("zp.enabledatleastonefeedback")),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr"))):"error"===resultData.msg?(ZPeople.Message.failure(ZPI18N.getString("zp.erroroccuredtryagain")),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr"))):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#feedbackcategoryhdr")))}})},disablefeebackTypeStatus:function(obj,id,compName){var pageId=settingsPage.container,status=$(obj).find("input").prop("checked")?"1":"0",stringval=$(obj).find("input").prop("checked")?"enabled":"disabled",params={componentId:id,status:status};ZPeople.autosave.loading(pageId.find("#feedbacksystemhdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"feedbacksettings",conreqcsr:csrfToken,feedbackData:JSON.stringify(params),submode:"enabledisableTypeStatus"},success:function(resultData){"success"==resultData.msg?(PMSSetting.ENABLED_MODULES[compName].enable="enabled"==stringval?1:0,ZPeople.autosave.success(pageId.find("#feedbacksystemhdr"),ZPI18N.getString("zp.saved"))):"default_components"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.defaultcomponentswarning")),PMSCommon.autosave.clearelement(pageId.find("#feedbacksystemhdr"))):"invalid component"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.invalidinputs")),PMSCommon.autosave.clearelement(pageId.find("#feedbacksystemhdr"))):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#feedbacksystemhdr"))):"error"===resultData.msg&&(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#feedbacksystemhdr")))}})},anonymfb:function(event){var data=event.detail,fData={};fData.anonymousFB=data.state?1:0,PMSSetting.updateFbGeneralSettings(fData,"anonymfb")},requestFB:function(event){var data=event.detail,fData={};fData.enableRequestFB=data.state?1:0,PMSSetting.updateFbGeneralSettings(fData,"enablefbr")},feedbackLevel:function(elem){var status=$(elem).val(),fData={};"orgFB"==$(elem).attr("name")&&(fData.orgFB="Org"===status?"1":"0"),PMSSetting.updateFbGeneralSettings(fData,"orgFB")},updateFbGeneralSettings:function(valdata,mode){var pageId=settingsPage.container,dataParams={mode:"feedbacksettings"};dataParams.conreqcsr=csrfToken;var hdrId="";"anonymfb"==mode?(dataParams.submode="anonymousFB",hdrId="feedbackaccessanonymfb"):"orgFB"==mode?(dataParams.submode="orgFB",hdrId="feedbackaccesspermhdr"):"enablefbr"==mode&&(dataParams.submode="requestFB",hdrId="feedbackrequest"),dataParams.feedbackData=JSON.stringify(valdata),ZPeople.autosave.loading(pageId.find("#"+hdrId),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:dataParams,success:function(resultData){if("success"==resultData.msg){resultData.data;ZPeople.autosave.success(pageId.find("#"+hdrId),ZPI18N.getString("zp.saved"))}else"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#"+hdrId))):"error"===resultData.msg&&(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#"+hdrId)))}})},skillSetnit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!0);pageId=settingsPage.container;if(PMSSetting.validateModuleStatus("SkillSet"))return;$.ajax({type:"POST",async:!1,url:"/performance/view/skillSetSettings",data:{conreqcsr:csrfToken},success:function(resultData){pageId.find("#skillsetmatrixRole").length>0&&ZPeopleComponents.tokenfield(pageId.find("#skillsetmatrixRole")).destroy(),pageId.html(""),pageId.append(resultData),$(pageId.find(".togBtn")).ztoggleswitch({size:"medium"}),PMSSetting.fetchSkillsetConfigData()}})}},fetchSkillsetConfigData:function(){$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getSettingsConfig",submode:"getskillsetconfig",conreqcsr:csrfToken},success:function(resultData){PMSSetting.skillsetDefaultObject=resultData,PMSSetting.setSkillsetData(resultData)}})},setSkillsetData:function(resultData){var pageId=settingsPage.container,skillsPermissionData=resultData.skillsPermissionData;null!=skillsPermissionData&&void 0!=skillsPermissionData&&PMSSetting.setSkillPermissionData(PMSSetting.skillsetDefaultObject.skillsPermissionData),pageId.find("#skillSetPermission input[type=checkbox]").change(function(){PMSSetting.dataChanged(PMSCommon.SECTION_SKILL_ACCESS)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_SKILL_ACCESS):PMSSetting.closeResetSave(PMSCommon.SECTION_SKILL_ACCESS)});var _isSkillSetApprEnable=resultData.skillSetApproval?"switchOn":"switchOff";pageId.find("#skillSetApproval").ztoggleswitch(_isSkillSetApprEnable),resultData.skillSetApproval&&PMSSetting.isUserSkillMapApprovalConfigured(),ZPeopleComponents.toggleswitch(pageId.find("#skillSetApproval")).setAttributes({change:PMSSetting.configureSkillSetApproval});var _isCertificationMand=resultData.certificationMand?"switchOn":"switchOff";pageId.find("#certificationMand").ztoggleswitch(_isCertificationMand),ZPeopleComponents.toggleswitch(pageId.find("#certificationMand")).setAttributes({change:PMSSetting.saveCertificationMand});var matrixRole=pageId.find("#skillsetmatrixRole");matrixRole.empty();var _tokenObj={},selectedMatrixRoleArr=[];if(null!=resultData.roleList){var _options=[],_allObj={};_allObj.name=ZPI18N.getString("zp.all"),_allObj.id="-1",_options.push(_allObj),$.each(resultData.roleList,function(key,value){var _singleObj={};(_singleObj.name=ZPeople.decodeTxt(value.roleName),_singleObj.id=value.roleID,null!=resultData.skillmatrixRole)&&(-1!=resultData.skillmatrixRole.indexOf(value.roleID)&&selectedMatrixRoleArr.push(_singleObj));_options.push(_singleObj)}),-1!=resultData.skillmatrixRole.indexOf("-1")&&selectedMatrixRoleArr.push(_allObj),_tokenObj.data=_options}if(_tokenObj.contentType="text",_tokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_tokenObj.search={by:"name"},_tokenObj.placeholder=ZPI18N.getString("zp.selectroles"),_tokenObj.allowDuplicateValues=!1,_tokenObj.values=selectedMatrixRoleArr,_tokenObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield(matrixRole,_tokenObj),$(matrixRole).on("ztokenfieldbeforetokenadd",PMSSetting.skillMatrixValidation),$(matrixRole).on("ztokenfieldtokenadd",PMSSetting.skillMatrixAfterTokenAdd),$(matrixRole).on("ztokenfieldtokenremove",PMSSetting.skillMatrixAfterTokenAdd),null!=resultData.scoreWeightageList&&PMSSetting.constructScoreWeitageList(),pageId.find("#skillScoreDefinitionConfigurable").ztoggleswitch(resultData.skillScoreDefinitionConfigurable?"switchOn":"switchOff"),ZPeopleComponents.toggleswitch(pageId.find("#skillScoreDefinitionConfigurable")).setAttributes({change:PMSSetting.configureSkillScoreDefinition}),resultData.skillScoreDefinitionConfigurable&&pageId.find("#skillScoreDefinition").show(),null!=resultData.skillScoreNames){var skillScoreNames=resultData.skillScoreNames,keys=Object.keys(skillScoreNames);for(j in keys)pageId.find("#"+keys[j]).val(ZPeople.decodeTxt(skillScoreNames[keys[j]]))}var _skillWeightage=resultData.skillsetweightagedisabled?"switchOff":"switchOn";if(pageId.find("#skillset_weightage").ztoggleswitch(_skillWeightage),ZPeopleComponents.toggleswitch(pageId.find("#skillset_weightage")).setAttributes({change:PMSSetting.saveSkillsetWeightage}),resultData.skillsetweightagedisabled?(pageId.find("#skillsetweightvaldiv").addClass("DN"),pageId.find("#skillsetcerpotantial").parent().hide()):(pageId.find("#skillsetweightvaldiv").removeClass("DN"),pageId.find("#skillsetcerpotantial").parent().show()),resultData.skillsetweightagedisabled||pageId.find("#skillsetweightvaldiv").removeClass("DN"),resultData.hasOwnProperty("restrictSkillSetWeightageValidation")){var restrictSkillSetWeightageValidation=!resultData.restrictSkillSetWeightageValidation;pageId.find("#skillset_restrict").prop("checked",restrictSkillSetWeightageValidation)}var _upgradeReasonMand=resultData.upgradeReasonMand?"switchOn":"switchOff";pageId.find("#upgradeReasonMand").ztoggleswitch(_upgradeReasonMand),ZPeopleComponents.toggleswitch(pageId.find("#upgradeReasonMand")).setAttributes({change:PMSSetting.saveUpgradeReasonMand})},saveSkillsetWeightage:event=>{const{state:state}=event.detail;if(PMSSetting.dataChanged(PMSCommon.SECTION_SKILLWEIGHTAGE)){const param={skillWeightageDisable:state?0:1};PMSSetting.addOrUpdateSkillSetSettings(PMSCommon.SECTION_SKILLWEIGHTAGE,param)}},setSkillPermissionData:function(skillsPermissionData){var pageId=settingsPage.container;null!=skillsPermissionData&&void 0!=skillsPermissionData&&(pageId.find("#SkillAdd_Self")[0].checked=skillsPermissionData.isSkillAdd_Self,pageId.find("#SkillEdit_Self")[0].checked=skillsPermissionData.isSkillEdit_Self,pageId.find("#SkillDelete_Self")[0].checked=skillsPermissionData.isSkillDelete_Self,pageId.find("#SkillAdd_Rep")[0].checked=skillsPermissionData.isSkillAdd_Rep,pageId.find("#SkillEdit_Rep")[0].checked=skillsPermissionData.isSkillEdit_Rep,pageId.find("#SkillDelete_Rep")[0].checked=skillsPermissionData.isSkillDelete_Rep,pageId.find("#SkillView_Self")[0].checked=!0,pageId.find("#SkillView_Rep")[0].checked=!0,pageId.find("#SkillView_DepHead")[0].checked=skillsPermissionData.isSkillView_DepHead,skillsPermissionData.isSkillView_DepHead?(pageId.find("#SkillAdd_DepHead")[0].checked=skillsPermissionData.isSkillAdd_DepHead,pageId.find("#SkillEdit_DepHead")[0].checked=skillsPermissionData.isSkillEdit_DepHead,pageId.find("#SkillDelete_DepHead")[0].checked=skillsPermissionData.isSkillDelete_DepHead):(pageId.find("#SkillAdd_DepHead")[0].checked=!1,pageId.find("#SkillEdit_DepHead")[0].checked=!1,pageId.find("#SkillDelete_DepHead")[0].checked=!1))},configureSkillScoreDefinition:function(event){var data=event.detail;if(data.fromUI){var pageId=settingsPage.container;if(data.state){if(null!=PMSSetting.skillsetDefaultObject.skillScoreNames){var skillScoreNames=PMSSetting.skillsetDefaultObject.skillScoreNames,keys=Object.keys(skillScoreNames);for(j in keys)pageId.find("#"+keys[j]).val(ZPeople.decodeTxt(skillScoreNames[keys[j]]))}pageId.find("#skillScoreDefinition").show()}else pageId.find("#skillScoreDefinition").hide();PMSSetting.dataChanged(PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE):PMSSetting.closeResetSave(PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE)}},checkSkillDeptHeadViewPermEnabled:function(obj){settingsPage.container.find("#SkillView_DepHead").is(":checked")||($(obj)[0].checked=!1,ZPeople.Message.warning(ZPI18N.getString("zp.skillDeptHeadErrorMsg")))},controlSkillDeptHeadPerm:function(){var pageId=settingsPage.container;pageId.find("#SkillView_DepHead").is(":checked")||(pageId.find("#SkillAdd_DepHead")[0].checked=!1,pageId.find("#SkillEdit_DepHead")[0].checked=!1,pageId.find("#SkillDelete_DepHead")[0].checked=!1)},resetSections:function(obj){var pageId=settingsPage.container,_parentid=$(obj).parent().attr("id"),section=_parentid.slice(0,_parentid.length-10);if(section===PMSCommon.SECTION_SKILL_ACCESS)PMSSetting.setSkillPermissionData(PMSSetting.skillsetDefaultObject.skillsPermissionData);else if(section===PMSCommon.SECTION_SKILLSET_APPROVAL){var _isSkillSetApprEnable=PMSSetting.skillsetDefaultObject.skillSetApproval?"switchOn":"switchOff";pageId.find("#skillSetApproval").ztoggleswitch(_isSkillSetApprEnable)}else if(section===PMSCommon.SECTION_SKILL_MATRIX){var matrixRole=pageId.find("#skillsetmatrixRole");ZPeopleComponents.tokenfield(matrixRole).removeAllTokens();var skillmatrixRole=PMSSetting.skillsetDefaultObject.skillmatrixRole,matrixRoleArr=[];for(var i in skillmatrixRole){var matrixObj={};matrixObj.id=skillmatrixRole[i],matrixRoleArr.push(matrixObj)}ZPeopleComponents.tokenfield(matrixRole).addTokens(matrixRoleArr)}else if(section===PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE){var skillScoreNames=PMSSetting.skillsetDefaultObject.skillScoreNames,keys=Object.keys(skillScoreNames);for(j in keys)pageId.find("#"+keys[j]).val(ZPeople.decodeTxt(skillScoreNames[keys[j]]));pageId.find("#skillScoreDefinitionConfigurable").ztoggleswitch(PMSSetting.skillsetDefaultObject.skillScoreDefinitionConfigurable?"switchOn":"switchOff"),PMSSetting.skillsetDefaultObject.skillScoreDefinitionConfigurable?pageId.find("#skillScoreDefinition").show():pageId.find("#skillScoreDefinition").hide(),pageId.find("#skillScoreDefinition").find("input").each(function(){$(this).removeClass("ztextbox__error")})}else if(section===PMSSetting.PERVSPOT_NAMES){var perVsPotNames=PMSSetting.reportSetdefaultObject.perVsPotNames;keys=Object.keys(perVsPotNames);for(k in keys)pageId.find("#"+keys[k]).val(ZPeople.decodeTxt(perVsPotNames[keys[k]]))}else if(section===PMSSetting.SECTION_EXPORTTXT){var exporttxt=pageId.find("#exporttxt");ZPeopleComponents.tokenfield(exporttxt).removeAllTokens();var selectedexportEmpFiled=PMSSetting.reportSetdefaultObject.selectedexportEmpFiled,exportTxtArr=[];for(var i in selectedexportEmpFiled){(_obj={}).id=selectedexportEmpFiled[i],exportTxtArr.push(_obj)}ZPeopleComponents.tokenfield(exporttxt).addTokens(exportTxtArr)}else if(section===PMSSetting.SECTION_ORDERREVIEW)ZPeopleComponents.listbox($(pageId.find("#reviewordercustom"))).destroy(),PMSSetting.constructReviewOrder(PMSSetting.reviewSetdefaultObject.revieworder);else if(section===PMSSetting.SECTION_CUSTOMFEEDBACKOPTION){pageId.find("#reviewFeedbackType").empty(),PMSSetting.constructReviewFeedback(PMSSetting.reviewSetdefaultObject.feedback_types);var acceptanceData=PMSSetting.reviewSetdefaultObject.acceptanceData;if(acceptanceData&&0==acceptanceData.length)pageId.find("#configRule").ztoggleswitch("switchOff"),pageId.find("#reviewextndiv").hide();else{pageId.find("#configRule").ztoggleswitch("switchOn"),pageId.find("#reviewextndiv div[rel=reviewextension]").hide(),pageId.find("#reviewextndiv div[rel=reviewextension]").each(function(){ZPeopleComponents.select(pageId.find("#"+$(this).find("select").attr("id"))).destroy()}),pageId.find("#reviewextndiv div[rel=reviewextension]").remove();var options,indx=1;$.each(acceptanceData,function(index,data){var _htm=PMSSetting.getAcceptanceHtml(indx,data.noofDays);$(_htm).insertBefore(pageId.find("#addreviewextn"));var selectElem=pageId.find("#reviewFeedbackOption_"+indx);ZPeopleComponents.select(selectElem),options=PMSSetting.updateFeedbackTypeOption(),ZPeopleComponents.select(selectElem).addOption(options),ZPeopleComponents.select(selectElem).setValue(data.optionID),pageId.find(selectElem).on("zselectchange",PMSSetting.changeReviewExtn),pageId.find(selectElem).parent().parent().find("input").val(data.noofDays),indx++}),pageId.find("#reviewextndiv").show(),options.length>1&&pageId.find("#addreviewextn").show()}}else if(section===PMSSetting.SECTION_RENAMETERM){if(PMSSetting.ENABLED_MODULES.KRA.displayName&&pageId.find("#kra_displayname").val(ZPeople.decodeTxt(PMSSetting.ENABLED_MODULES.KRA.displayName)),PMSSetting.ENABLED_MODULES.GOALS.displayName&&pageId.find("#goals_displayname").val(ZPeople.decodeTxt(PMSSetting.ENABLED_MODULES.GOALS.displayName)),PMSSetting.ENABLED_MODULES.FEEDBACK.displayName&&pageId.find("#fdbk_displayname").val(ZPeople.decodeTxt(PMSSetting.ENABLED_MODULES.FEEDBACK.displayName)),PMSSetting.ENABLED_MODULES.SKILLSET.displayName&&pageId.find("#ss_displayname").val(ZPeople.decodeTxt(PMSSetting.ENABLED_MODULES.SKILLSET.displayName)),PMSSetting.ENABLED_MODULES.COMPETENCY.displayName&&pageId.find("#comp_displayname").val(ZPeople.decodeTxt(PMSSetting.ENABLED_MODULES.COMPETENCY.displayName)),PMSSetting.ENABLED_MODULES.SUMMARY.displayName&&pageId.find("#sumy_displayname").val(ZPeople.decodeTxt(PMSSetting.ENABLED_MODULES.SUMMARY.displayName)),PMSSetting.ENABLED_MODULES.QUS_ANS.displayName&&pageId.find("#qus_displayname").val(ZPeople.decodeTxt(PMSSetting.ENABLED_MODULES.QUS_ANS.displayName)),PMSSetting.otherSetDefaultObject.multiraterName){var multiraterVal=PMSSetting.otherSetDefaultObject.multiraterName;pageId.find("#multiraterName").val(ZPeople.decodeTxt(multiraterVal)),PMSSetting.otherSetDefaultObject.multiraterName==ZPI18N.getString("zp.multi")&&(multiraterVal=ZPI18N.getString("zp.multi"))}PMSSetting.otherSetDefaultObject.tabNames&&pageId.find("#PEERS_VIEW").val(ZPeople.decodeTxt(PMSSetting.otherSetDefaultObject.tabNames.PEERS_VIEW)),PMSSetting.otherSetDefaultObject.goalsheetName&&pageId.find("#goalSheetName").val(ZPeople.decodeTxt(PMSSetting.otherSetDefaultObject.goalsheetName)),PMSSetting.otherSetDefaultObject.hikeRelatedTerms.HIKE_NAME&&pageId.find("#hikeName").val(ZPeople.decodeTxt(PMSSetting.otherSetDefaultObject.hikeRelatedTerms.HIKE_NAME)),PMSSetting.otherSetDefaultObject.hikeRelatedTerms.SALARY_HIKE_NAME&&pageId.find("#salaryhikename").val(ZPeople.decodeTxt(PMSSetting.otherSetDefaultObject.hikeRelatedTerms.SALARY_HIKE_NAME)),PMSSetting.otherSetDefaultObject.hikeRelatedTerms.ALLOCATED_HIKE_NAME&&pageId.find("#allocatedhikename").val(ZPeople.decodeTxt(PMSSetting.otherSetDefaultObject.hikeRelatedTerms.ALLOCATED_HIKE_NAME)),PMSSetting.otherSetDefaultObject.hikeRelatedTerms.PROPOSED_HIKE_NAME&&pageId.find("#proposedhikename").val(ZPeople.decodeTxt(PMSSetting.otherSetDefaultObject.hikeRelatedTerms.PROPOSED_HIKE_NAME)),PMSSetting.otherSetDefaultObject.customSectionName.REVIEW_CUSTOM_SECTION&&pageId.find("#customsecname").val(ZPeople.decodeTxt(PMSSetting.otherSetDefaultObject.customSectionName.REVIEW_CUSTOM_SECTION)),PMSSetting.getResetGoalPriorityNames()}else if(section===PMSCommon.SECTION_MRTYPE){pageId.find("#addmultiratertypes").empty();var _multiRaterTyHtm=PMSSetting.constructMultiRaterTypes(PMSSetting.reviewSetdefaultObject.multiraterType);pageId.find("#addmultiratertypes").append($(_multiRaterTyHtm)),(keys=Object.keys(PMSSetting.reviewSetdefaultObject.multiraterType)).length<5&&pageId.find("#addmultirtaddbtn").parent().show(),PMSSetting.multiratertypeactions()}else if(section===PMSSetting.CONTINUOUS_REVIEW)PMSSetting.CFSReset();else if(section===PMSCommon.SECTION_GOAL_ACCESS){var goalSettingsData=PMSSetting.kraGoalDefaultObject.goalSettingsData;goalSettingsData&&(goalSettingsData.goalsettingEnable?(ZPeopleComponents.select(pageId.find("#nonAdnGFCId")).setAttribute("selectedValue",goalSettingsData.formCompId),goalSettingsData.hasOwnProperty("isView")&&pageId.find("#goalViewPer").prop("checked",goalSettingsData.isView),goalSettingsData.hasOwnProperty("isDelete")&&pageId.find("#goalDeletePer").prop("checked",goalSettingsData.isDelete),goalSettingsData.hasOwnProperty("isEdit")&&pageId.find("#goalEditPer").prop("checked",goalSettingsData.isEdit),goalSettingsData.hasOwnProperty("isAdd")&&pageId.find("#goalAddPer").prop("checked",goalSettingsData.isAdd),PMSSetting.goalSettingsChckBxEnable(!1)):(pageId.find("#goalSettingsData input[type=checkbox]").each(function(){$(this).prop("checked",!1)}),ZPeopleComponents.select(pageId.find("#nonAdnGFCId")).setAttribute("selectedValue",-1),PMSSetting.goalSettingsChckBxEnable(!0)))}else if(section===PMSSetting.SECTION_GOALPERIOD_SETTINGS){pageId.find("#goal_condtInnerDiv .PI_delete").trigger("onclick"),pageId.find("#goal_nonCondtInnerDiv .PI_delete").trigger("onclick");let isDefaultReset=!(void 0!==PMSSetting.GOALSETTINGPERIOD_DATA&&Object.keys(PMSSetting.GOALSETTINGPERIOD_DATA).length>0);PMSSetting.constrctGoalSettingData(isDefaultReset)}else if(section===PMSSetting.SECTION_APPRAISALCYLE){if(pageId.find("#selfappraisalhide").prop("checked",PMSSetting.reviewSetdefaultObject.isHideSelfAppraisalReview),pageId.find("#skipreviewlvl").prop("checked",PMSSetting.reviewSetdefaultObject.skipreviewlvl),pageId.find("#excludeNoticEmp").prop("checked",PMSSetting.reviewSetdefaultObject.excludeNoticEmp),pageId.find("#excludeProbEmp").prop("checked",PMSSetting.reviewSetdefaultObject.excludeProbEmp),pageId.find("#reviewCantRater").prop("checked",PMSSetting.reviewSetdefaultObject.isReviewCantRater),pageId.find("#cycleDeleteRestriction").length>0&&isSuperAdmin)if(pageId.find("#cycleDeleteNotes").hide(),ZPeopleComponents.tokenfield(pageId.find("#cycleDeleteUserList")).removeAllTokens(),void 0!=PMSSetting.reviewSetdefaultObject.isCycleDeleteRestrictEnabled&&PMSSetting.reviewSetdefaultObject.isCycleDeleteRestrictEnabled){if(pageId.find("#cycleDeleteRestriction").prop("checked",!0),pageId.find("#cycleDeleteNotes").show(),pageId.find("#cycleDeleteRestictionSelect").show(),void 0!=PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUser&&PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUser.length>0){var cycleDeleteRestrictionSelectedUser=PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUser;UserUtils.createMultiSelectEmpSearchbox("cycleDeleteUserList","cycleAdmins",{pModal:pageId,placeHolder:ZPI18N.getString("zp.performance.selectadmins"),initSelVal:cycleDeleteRestrictionSelectedUser})}}else pageId.find("#cycleDeleteRestriction").prop("checked",!1),pageId.find("#cycleDeleteRestictionSelect").hide();pageId.find("#moduleratingMailmerge").prop("checked",PMSSetting.reviewSetdefaultObject.isModuleRatingMailMergeEnabled)}else if(section===PMSSetting.SECTION_SKILLPOTENTIAL){var data=PMSSetting.unchangedpotential;for(const key in data)if(data.hasOwnProperty(key)){const item=data[key];pageId.find("#editweightageinputNameVal_"+key).val(item.name),pageId.find("#editweightageinputVal_"+key+"_min").val(item.min),pageId.find("#editweightageinputVal_"+key+"_max").val(item.max)}PMSSetting.potentialobj=JSON.parse(JSON.stringify(data))}else if(section==PMSCommon.SECTION_KRA_ACCESS){PMSSetting.setKRAPermissions(PMSSetting.kraGoalDefaultObject.kraPermissionData);var isConvertOrgKraEnabled=PMSSetting.kraGoalDefaultObject.convertOrgKra?"switchOn":"switchOff";pageId.find("#kraAdd_Self").prop("checked")||pageId.find("#kraAdd_Rep").prop("checked")?pageId.find("#userSpfKra").removeClass("zpl_DNI"):pageId.find("#userSpfKra").addClass("zpl_DNI"),pageId.find("#userOrgKra").ztoggleswitch(isConvertOrgKraEnabled)}else if(section==PMSCommon.SECTION_KRA_APPROVAL){var _isKraApprovalEnabled=PMSSetting.kraGoalDefaultObject.kraApproval?"switchOn":"switchOff";pageId.find("#kraApproval").ztoggleswitch(_isKraApprovalEnabled)}else if(section==PMSCommon.SECTION_NORMALIZATION)pageId.find("#reasonForNormalization").prop("checked",PMSSetting.reviewSetdefaultObject.isNorReason),pageId.find("#reasonMandatoryNorm").prop("checked",PMSSetting.reviewSetdefaultObject.isNorMandatory);else if(section==PMSCommon.SECTION_COURSE_DETAILS)pageId.find("#courseView").prop("checked",PMSSetting.reviewSetdefaultObject.isListCourse);else if(section==PMSCommon.SECTION_CUSTOM_ADMIN)PMSSetting.reset();else if(section==PMSSetting.SECTION_GOALDATETYPE){var dateTypeObj={1:ZPI18N.getString("zp.createddate"),2:ZPI18N.getString("zp.sdate"),3:ZPI18N.getString("zp.local.CompletedOn"),4:ZPI18N.getString("zp.duedate")},selectedDateTypes=PMSSetting.kraGoalDefaultObject.goalDateType,dateArr=[];for(var i in selectedDateTypes){var _obj;(_obj={}).id=selectedDateTypes[i],_obj.name=dateTypeObj[selectedDateTypes[i]],dateArr.push(_obj)}var goalDateFldObj=pageId.find("#goalDateFields");ZPeopleComponents.tokenfield(goalDateFldObj).removeAllTokens(),ZPeopleComponents.tokenfield(goalDateFldObj).setAttribute("values",dateArr),pageId.find("#goalDateFields").parent().find(".ztextbox--error__label").remove()}else section==PMSCommon.SECTION_APPRAISAL_ESIGN&&pageId.find("#appraisalsignenabledisable").prop("checked",PMSSetting.IS_APPRAISAL_ESIGN_ENABLED);section!==PMSSetting.CONTINUOUS_REVIEW&&pageId.find("#"+section+"_SAVERESET").empty(),PMSSetting.closeResetSave(section)},getSaveResetBtn:function(section){var _htm="",pageId=settingsPage.container;_htm+='<button type="button" attr="reset" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.reset")+"</button>",_htm+='<button type="button" attr="save" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.save")+"</button>",pageId.find("#"+section+"_SAVERESET").empty(),pageId.find("#"+section+"_SAVERESET").append($(_htm)),pageId.find("#"+section+"_SAVERESET [attr=reset]").click(function(){PMSSetting.resetSections($(this))}),pageId.find("#"+section+"_SAVERESET [attr=save]").click(function(){section===PMSCommon.SECTION_SKILL_ACCESS?PMSSetting.saveSkillSetPermission($(this)):section===PMSCommon.SECTION_SKILLSET_APPROVAL?PMSSetting.saveSkillSetApproval($(this)):section===PMSCommon.SECTION_SKILL_MATRIX?PMSSetting.saveSkillsetMatrix($(this)):section===PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE?PMSSetting.saveSkillScore($(this)):section===PMSSetting.PERVSPOT_NAMES?PMSSetting.saveNineBoxMatrix($(this)):section===PMSSetting.SECTION_EXPORTTXT?PMSSetting.saveExportText($(this)):section===PMSSetting.SECTION_ORDERREVIEW?PMSSetting.updateRevieworder($(this)):section===PMSSetting.SECTION_CUSTOMFEEDBACKOPTION?PMSSetting.updateFeedBackType($(this)):section===PMSSetting.SECTION_RENAMETERM?PMSSetting.saveRenameTerminal($(this)):section===PMSCommon.SECTION_MRTYPE?PMSSetting.saveMultiRaterType($(this)):section===PMSSetting.CONTINUOUS_REVIEW?PMSSetting.saveContinuousReview(!1,!0,!1):section===PMSCommon.SECTION_NOTIFICATION?PMSSetting.saveNotificationData(!0):section===PMSCommon.SECTION_GOAL_ACCESS?PMSSetting.updateGoalPermissions():section===PMSSetting.SECTION_GOALPERIOD_SETTINGS?PMSSetting.submitGoalSettingPeriod():section===PMSSetting.SECTION_GOALDATETYPE?PMSSetting.submitGoalDateType():section===PMSSetting.SECTION_APPRAISALCYLE?PMSSetting.saveReviewSettings(PMSSetting.SECTION_APPRAISALCYLE):section===PMSSetting.SECTION_SKILLPOTENTIAL?PMSSetting.saveScoreWeightAge(PMSSetting.SECTION_SKILLPOTENTIAL):section===PMSCommon.SECTION_KRA_ACCESS?PMSSetting.saveKraPermission():section===PMSCommon.SECTION_KRA_APPROVAL?PMSSetting.saveKraApproval():section===PMSCommon.SECTION_NORMALIZATION?PMSSetting.saveReviewSettings(PMSCommon.SECTION_NORMALIZATION):section==PMSCommon.SECTION_COURSE_DETAILS?PMSSetting.saveReviewSettings(PMSCommon.SECTION_COURSE_DETAILS):section===PMSCommon.SECTION_CUSTOM_ADMIN?PMSSetting.submitCstAdmSett():section==PMSCommon.SECTION_APPRAISAL_ESIGN&&PMSSetting.saveAppraisalEsign()}),pageId.find("#"+section+"_SAVERESET").is(":visible")||(pageId.find("#"+section+"_SAVERESET").show(),pageId.find("#"+section+"_SAVERESET").attr("isPageDataChanged",!0))},isPageDataChanged:function(leftTabChange){if(settingsPage.container.find("div[ispagedatachanged=true]").length>0){var infoAlertMessage=new InfoAlertMessage;infoAlertMessage.title="",infoAlertMessage.despcription=ZPI18N.getString("zp.cancelconfmsg"),infoAlertMessage.yesButtonText=ZPI18N.getString("zp.proceed"),infoAlertMessage.callback=function(obj){leftTabChange()},infoAlertMessage.show()}else leftTabChange()},afterPageChange:function(){settingsPage.container.find("div[ispagedatachanged=true]").removeAttr("isPageDataChanged")},closeResetSave:function(section){var saveResetElem=settingsPage.container.find("#"+section+"_SAVERESET");$(saveResetElem).removeAttr("isPageDataChanged"),$(saveResetElem).empty().hide()},dataChanged:function(section){var pageId=settingsPage.container,isDataChanged=!1;if(section===PMSCommon.SECTION_SKILL_ACCESS){var isSkillAdd_Self=pageId.find("#SkillAdd_Self").prop("checked"),isSkillAdd_Rep=pageId.find("#SkillAdd_Rep").prop("checked"),isSkillAdd_DepHead=pageId.find("#SkillAdd_DepHead").prop("checked"),isSkillEdit_Self=pageId.find("#SkillEdit_Self").prop("checked"),isSkillEdit_Rep=pageId.find("#SkillEdit_Rep").prop("checked"),isSkillEdit_DepHead=pageId.find("#SkillEdit_DepHead").prop("checked"),isSkillDelete_Self=pageId.find("#SkillDelete_Self").prop("checked"),isSkillDelete_Rep=pageId.find("#SkillDelete_Rep").prop("checked"),isSkillDelete_DepHead=pageId.find("#SkillDelete_DepHead").prop("checked"),isSkillView_DepHead=pageId.find("#SkillView_DepHead").prop("checked"),expectedData_isSkillAdd_Self=(expectedData=PMSSetting.skillsetDefaultObject.skillsPermissionData).isSkillAdd_Self,expectedData_isSkillAdd_Rep=expectedData.isSkillAdd_Rep,expectedData_isSkillAdd_DepHead=expectedData.isSkillAdd_DepHead,expectedData_isSkillEdit_Self=expectedData.isSkillEdit_Self,expectedData_isSkillEdit_Rep=expectedData.isSkillEdit_Rep,expectedData_isSkillEdit_DepHead=expectedData.isSkillEdit_DepHead,expectedData_isSkillDelete_Self=expectedData.isSkillDelete_Self,expectedData_isSkillDelete_Rep=expectedData.isSkillDelete_Rep,expectedData_isSkillDelete_DepHead=expectedData.isSkillDelete_DepHead,expectedData_isSkillView_DepHead=expectedData.isSkillView_DepHead;isSkillAdd_Self!==expectedData_isSkillAdd_Self?isDataChanged=!0:isSkillAdd_Rep!==expectedData_isSkillAdd_Rep?isDataChanged=!0:isSkillAdd_DepHead!==expectedData_isSkillAdd_DepHead?isDataChanged=!0:isSkillEdit_Self!==expectedData_isSkillEdit_Self?isDataChanged=!0:isSkillEdit_Rep!==expectedData_isSkillEdit_Rep?isDataChanged=!0:isSkillEdit_DepHead!==expectedData_isSkillEdit_DepHead?isDataChanged=!0:isSkillDelete_Self!==expectedData_isSkillDelete_Self?isDataChanged=!0:isSkillDelete_Rep!==expectedData_isSkillDelete_Rep?isDataChanged=!0:isSkillDelete_DepHead!==expectedData_isSkillDelete_DepHead?isDataChanged=!0:isSkillView_DepHead!==expectedData_isSkillView_DepHead&&(isDataChanged=!0)}else if(section===PMSCommon.SECTION_SKILLSET_APPROVAL){ZPeopleComponents.toggleswitch(pageId.find("#skillSetApproval")).getState()!==PMSSetting.skillsetDefaultObject.skillSetApproval&&(isDataChanged=!0)}else if(section===PMSCommon.SECTION_SKILL_MATRIX){var matrixRole=pageId.find("#skillsetmatrixRole"),actualSelVal=[];if((returnedData=ZPeopleComponents.tokenfield(matrixRole).getAllValues()).length>0)for(var i in returnedData)actualSelVal.push(returnedData[i].id);var expectedSelVal=PMSSetting.skillsetDefaultObject.skillmatrixRole;isDataChanged=PMSSetting.arrayDataChangeCheck(actualSelVal,expectedSelVal)}else if(section===PMSCommon.SECTION_CERTIFICATION_MANDATORY){ZPeopleComponents.toggleswitch(pageId.find("#certificationMand")).getState()!==PMSSetting.skillsetDefaultObject.certificationMand&&(isDataChanged=!0)}else if(section===PMSCommon.SECTION_UPGRADEREASON_MANDATORY){ZPeopleComponents.toggleswitch(pageId.find("#upgradeReasonMand")).getState()!==PMSSetting.skillsetDefaultObject.upgradeReasonMand&&(isDataChanged=!0)}else if(section===PMSCommon.SECTION_SKILLWEIGHTAGE){ZPeopleComponents.toggleswitch(pageId.find("#skillset_weightage")).getState()==PMSSetting.skillsetDefaultObject.skillsetweightagedisabled&&(isDataChanged=!0)}else if(section===PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE){var skillScoreObj={};pageId.find("#skillScoreDefinition input").each(function(){skillScoreObj[$(this).attr("id")]=$(this).val().trim()}),PMSSetting.skillsetDefaultObject.skillScoreDefinitionConfigurable!=ZPeopleComponents.toggleswitch(pageId.find("#skillScoreDefinitionConfigurable")).getState()&&(isDataChanged=!0);var oldSkillScoreNames=PMSSetting.skillsetDefaultObject.skillScoreNames;oldSkillScoreNames.SKILLSCORE_ONE==skillScoreObj.SKILLSCORE_ONE&&oldSkillScoreNames.SKILLSCORE_TWO==skillScoreObj.SKILLSCORE_TWO&&oldSkillScoreNames.SKILLSCORE_THREE==skillScoreObj.SKILLSCORE_THREE&&oldSkillScoreNames.SKILLSCORE_FOUR==skillScoreObj.SKILLSCORE_FOUR||(isDataChanged=!0)}else if(section===PMSCommon.RESTRICT_SKILLSET_WEIGHTAGE_VALIDATION){ZPeopleComponents.toggleswitch(pageId.find("#skillset_restrict")).getState()!==PMSSetting.skillsetDefaultObject.restrictSkillSetWeightageValidation&&(isDataChanged=!0)}else if(section===PMSSetting.PERVSPOT_NAMES){var noneBoxObj={};pageId.find("#perVsPot").find("input").each(function(){noneBoxObj[$(this).attr("id")]=$(this).val().trim()});var oldPerVsPotNames=PMSSetting.reportSetdefaultObject.perVsPotNames,_keys=Object.keys(oldPerVsPotNames);for(var i in _keys)if(oldPerVsPotNames[_keys[i]]!=noneBoxObj[_keys[i]]){isDataChanged=!0;break}}else if(section===PMSCommon.SECTION_EXPORT_PERMISSION){pageId.find("#adminonlyexport").is(":checked")!==PMSSetting.reportSetdefaultObject.adminonlyexport&&(isDataChanged=!0)}else if(section===PMSCommon.SECTION_SALARY_HIKE){("amount"==pageId.find("#salaryhikeSec").find("[name=salaryinput]:checked").attr("value")?0:1)!==PMSSetting.reviewSetdefaultObject.hikeInput&&(isDataChanged=!0)}else if(section===PMSCommon.SECTION_SKIP_REVIEW){pageId.find("#skipreviewlvl").is(":checked")!==PMSSetting.reviewSetdefaultObject.skipreviewlvl&&(isDataChanged=!0)}else if(section===PMSCommon.SECTION_HIDESELFAPPRAISALREVIEW){pageId.find("#selfappraisalhide").is(":checked")!==PMSSetting.reviewSetdefaultObject.isHideSelfAppraisalReview&&(isDataChanged=!0)}else if(section===PMSCommon.SECTION_ACCEPTANCEDATA)var oldAcceptanceData=PMSSetting.defaultObject.acceptanceData;else if(section===PMSSetting.SECTION_CUSTOMFEEDBACKOPTION){var newFeddBackTypes=PMSSetting.getChangedFeedBackTypes(),oldFeddBackTypes=PMSSetting.reviewSetdefaultObject.feedback_types;for(var i in newFeddBackTypes)for(var j in oldFeddBackTypes)oldFeddBackTypes[j].optionId==newFeddBackTypes[i].optionId&&(oldFeddBackTypes[j].optionvalue==newFeddBackTypes[i].optionvalue&&oldFeddBackTypes[j].disabled==newFeddBackTypes[i].disabled||(isDataChanged=!0));oldAcceptanceData=PMSSetting.reviewSetdefaultObject.acceptanceData;if(pageId.find("#reviewextndiv div[rel=reviewextension]").each(function(){var selectedValue=ZPeopleComponents.select(pageId.find("#"+$(this).find("select").attr("id"))).getValue(),currentValue=$(this).find("input[id=noofDays]").val();$.each(oldAcceptanceData,function(index,data){selectedValue===data.optionID&&Number(data.noofDays)!==Number(currentValue)&&(isDataChanged=!0)})}),!isDataChanged){var acceptanceArr=[],selectedArr=[];$.each(oldAcceptanceData,function(index,data){acceptanceArr.push(data.optionID)}),pageId.find("#reviewextndiv div[rel=reviewextension]").each(function(){var selectedValue=ZPeopleComponents.select(pageId.find("#"+$(this).find("select").attr("id"))).getValue();selectedArr.push(selectedValue)}),isDataChanged=PMSSetting.arrayDataChangeCheck(acceptanceArr,selectedArr)}}else if(PMSSetting.IS_MR_ENABLED&&section==PMSCommon.MULTIRATERNAME){var obj=pageId.find("#multiraterName");PMSSetting.otherSetDefaultObject.raw_multiraterName!=obj.val().trim()&&(isDataChanged=!0)}else if(section==PMSCommon.HIKE_NAME){var val=(obj=pageId.find("#hikeName")).val().trim();PMSSetting.otherSetDefaultObject.hikeRelatedTerms.raw_HIKE_NAME!=val&&(isDataChanged=!0)}else if(section==PMSCommon.SALARY_HIKE_NAME){val=(obj=pageId.find("#salaryhikename")).val().trim();PMSSetting.otherSetDefaultObject.hikeRelatedTerms.raw_SALARY_HIKE_NAME!=val&&(isDataChanged=!0)}else if(section==PMSCommon.PROPOSED_HIKE_NAME){val=(obj=pageId.find("#proposedhikename")).val().trim();PMSSetting.otherSetDefaultObject.hikeRelatedTerms.raw_PROPOSED_HIKE_NAME!=val&&(isDataChanged=!0)}else if(section==PMSCommon.ALLOCATED_HIKE_NAME){val=(obj=pageId.find("#allocatedhikename")).val().trim();PMSSetting.otherSetDefaultObject.hikeRelatedTerms.raw_ALLOCATED_HIKE_NAME!=val&&(isDataChanged=!0)}else if(section==PMSSetting.SECTION_CUSTOMNAME){val=(obj=pageId.find("#customsecname")).val().trim();PMSSetting.otherSetDefaultObject.customSectionName.raw_REVIEW_CUSTOM_SECTION!=val&&(isDataChanged=!0)}else if(section==PMSCommon.GOALSHEETNAME){val=(obj=pageId.find("#goalSheetName")).val().trim();PMSSetting.otherSetDefaultObject.raw_goalsheetName!=val&&(isDataChanged=!0)}else if(section==PMSSetting.SECTION_EXPORTTXT){var exportTxtRole=pageId.find("#exporttxt"),returnedData=ZPeopleComponents.tokenfield(exportTxtRole).getAllValues(),selectedexportEmpFiled=PMSSetting.reportSetdefaultObject.selectedexportEmpFiled,expectedArr=[];$.each(returnedData,function(index,data){expectedArr.push(data.id)}),isDataChanged=PMSSetting.arrayDataChangeCheck(selectedexportEmpFiled,expectedArr)}else if(section==PMSCommon.SECTION_MRTYPE){var multiraterType=PMSSetting.reviewSetdefaultObject.multiraterType,multiraterTypeKeys=Object.keys(multiraterType);pageId.find("#addmultiratertypes div[rel=typesdiv]").each(function(){var typeId=$(this).find("input").attr("id");void 0!==typeId&&!1!==typeId&&(1!=pageId.find("#"+typeId).length||pageId.find("#"+typeId).val().trim()==multiraterType[typeId])&&0!=pageId.find("#"+typeId).length||(isDataChanged=!0)}),pageId.find("#addmultiratertypes div[rel=typesdiv]").length!=multiraterTypeKeys.length&&(isDataChanged=!0)}else if(section==PMSSetting.SECTION_KRA){val=(obj=pageId.find("#kra_displayname")).val().trim();PMSSetting.ENABLED_MODULES.KRA.rawComDisplayName!=val&&(isDataChanged=!0)}else if(section==PMSSetting.SECTION_GOALS){val=(obj=pageId.find("#goals_displayname")).val().trim();PMSSetting.ENABLED_MODULES.GOALS.rawComDisplayName!=val&&(isDataChanged=!0)}else if(section==PMSSetting.SECTION_KRA_GOALS){val=(obj=pageId.find("#kra_goals_displayname")).val().trim();PMSSetting.ENABLED_MODULES.KRA_GOALS.rawComDisplayName!=val&&(isDataChanged=!0)}else if(section==PMSSetting.SECTION_FEEDBACK){val=(obj=pageId.find("#fdbk_displayname")).val().trim();PMSSetting.ENABLED_MODULES.FEEDBACK.rawComDisplayName!=val&&(isDataChanged=!0)}else if(section==PMSSetting.SECTION_SKILSET){val=(obj=pageId.find("#ss_displayname")).val().trim();PMSSetting.ENABLED_MODULES.SKILLSET.rawComDisplayName!=val&&(isDataChanged=!0)}else if(section==PMSSetting.SECTION_COMPETENCY){val=(obj=pageId.find("#comp_displayname")).val().trim();PMSSetting.ENABLED_MODULES.COMPETENCY.rawComDisplayName!=val&&(isDataChanged=!0)}else if(section==PMSSetting.SECTION_SUMMARY){val=(obj=pageId.find("#sumy_displayname")).val().trim();PMSSetting.ENABLED_MODULES.SUMMARY.rawComDisplayName!=val&&(isDataChanged=!0)}else if(section==PMSSetting.SECTION_QUESANS){val=(obj=pageId.find("#qus_displayname")).val().trim();PMSSetting.ENABLED_MODULES.QUS_ANS.rawComDisplayName!=val&&(isDataChanged=!0)}else{if(section===PMSCommon.SECTION_NOTIFICATION){var notCon=pageId.find("#paNotification"),valCheck=void 0==PMSSetting.reviewSetdefaultObject.notificationOptions||0==Object.keys(PMSSetting.reviewSetdefaultObject.notificationOptions).length,dataChanges=[];for(var notifyName of PMSCommon.getNotificationTypes()){var dataJson={},changeEnabled=(notCon=pageId.find("#notification_"+notifyName.toLowerCase())).find("#"+notifyName.toLowerCase()).is(":checked");if(valCheck||void 0==PMSSetting.reviewSetdefaultObject.notificationOptions[notifyName]){if(!changeEnabled)continue;dataJson.isEnabled=changeEnabled,"REVIEW_END_NOTIFY"==notifyName&&(dataJson.days=ZPeopleComponents.select(notCon.find("#end_days")).getValue())}else{var data=PMSSetting.reviewSetdefaultObject.notificationOptions[notifyName];if(changeEnabled!=data.isEnabled&&(dataJson.isEnabled=changeEnabled),"REVIEW_END_NOTIFY"==notifyName){var changeDays=ZPeopleComponents.select(notCon.find("#end_days")).getValue();data.days!=parseInt(changeDays)&&(dataJson.days=changeDays)}}Object.keys(dataJson).length>0&&(dataJson.name=notifyName,dataChanges.push(dataJson))}return Object.keys(dataChanges).length>0?dataChanges:isDataChanged}if(section===PMSCommon.SECTION_EXCLUDE_NOTICE_EMPLOYEE)pageId.find("#excludeNoticEmp").is(":checked")!==PMSSetting.reviewSetdefaultObject.excludeNoticEmp&&(isDataChanged=!0);else if(section===PMSCommon.SECTION_EXCLUDE_PROBATION_EMPLOYEE){pageId.find("#excludeProbEmp").is(":checked")!==PMSSetting.reviewSetdefaultObject.excludeProbEmp&&(isDataChanged=!0)}else if(section===PMSCommon.SECTION_GOAL_ACCESS){var expectedData_isView,expectedData_isDelete,expectedData_isEdit,expectedData_isAdd,formCompId=ZPeopleComponents.select(pageId.find("#nonAdnGFCId")).getValue(),isView=pageId.find("#goalViewPer").is(":checked"),isDelete=pageId.find("#goalDeletePer").is(":checked"),isEdit=pageId.find("#goalEditPer").is(":checked"),isAdd=pageId.find("#goalAddPer").is(":checked"),expectedData_formCompId=null;null!==(expectedData=PMSSetting.kraGoalDefaultObject.goalSettingsData)&&void 0!==expectedData?(expectedData_formCompId=expectedData.formCompId,expectedData_isView=expectedData.isView,expectedData_isDelete=expectedData.isDelete,expectedData_isEdit=expectedData.isEdit,expectedData_isAdd=expectedData.isAdd):expectedData_formCompId=-1,parseInt(formCompId)!==parseInt(expectedData_formCompId)?isDataChanged=!0:-1!==parseInt(formCompId)&&-1!==parseInt(expectedData_formCompId)&&(isView!==expectedData_isView?isDataChanged=!0:isDelete!==expectedData_isDelete?isDataChanged=!0:isEdit!==expectedData_isEdit?isDataChanged=!0:isAdd!==expectedData_isAdd&&(isDataChanged=!0))}else if(section==PMSCommon.SECTION_CYCLE_DELETE_RESTRICTION){if(pageId.find("#cycleDeleteRestriction").length>0){var isChecked=pageId.find("#cycleDeleteRestriction").is(":checked");if(isChecked!=PMSSetting.reviewSetdefaultObject.isCycleDeleteRestrictEnabled&&(isDataChanged=!0),isChecked&&!isDataChanged){var selectedAdmin=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(pageId.find("#cycleDeleteUserList")).getAllValues());if(void 0==PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUser&&selectedAdmin.length>0)isDataChanged=!0;else if(void 0!=PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUser&&PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUser.length!=selectedAdmin.length)isDataChanged=!0;else if(void 0!=PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUser){for(i=0;i<PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUser.length;i++){val=PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUser[i];-1!=selectedAdmin.indexOf(val)?selectedAdmin.splice(selectedAdmin.indexOf(val),1):isDataChanged=!0}selectedAdmin.length>0&&(isDataChanged=!0)}}}}else if(section==PMSCommon.SECTION_MODULESRATING_MAILMERGE){pageId.find("#moduleratingMailmerge").is(":checked")!==PMSSetting.reviewSetdefaultObject.isModuleRatingMailMergeEnabled&&(isDataChanged=!0)}else if(section==PMSCommon.SECTION_KRA_ACCESS){var expectedData,isKraAdd_Self=pageId.find("#kraAdd_Self").prop("checked"),isKraTag_Self=pageId.find("#kraTag_Self").prop("checked"),isKraDelete_Self=pageId.find("#kraDelete_Self").prop("checked"),isKraAdd_Rep=pageId.find("#kraAdd_Rep").prop("checked"),isKraTag_Rep=pageId.find("#kraTag_Rep").prop("checked"),isKraDelete_Rep=pageId.find("#kraDelete_Rep").prop("checked"),isConvertKra=pageId.find("#userOrgKra").prop("checked"),expectedData_isKraAdd_Self=(expectedData=PMSSetting.kraGoalDefaultObject.kraPermissionData).isKraAdd_Self,expectedData_isKraTag_Self=expectedData.isKraTag_Self,expectedData_isKraDelete_Self=expectedData.isKraDelete_Self,expectedData_isKraAdd_Rep=expectedData.isKraAdd_Rep,expectedData_isKraTag_Rep=expectedData.isKraTag_Rep,expectedData_isKraDelete_Rep=expectedData.isKraDelete_Rep;isKraAdd_Self!==expectedData_isKraAdd_Self?isDataChanged=!0:isKraTag_Self!==expectedData_isKraTag_Self?isDataChanged=!0:isKraDelete_Self!==expectedData_isKraDelete_Self?isDataChanged=!0:isKraAdd_Rep!==expectedData_isKraAdd_Rep?isDataChanged=!0:isKraTag_Rep!==expectedData_isKraTag_Rep?isDataChanged=!0:isKraDelete_Rep!==expectedData_isKraDelete_Rep?isDataChanged=!0:isConvertKra!==PMSSetting.kraGoalDefaultObject.convertOrgKra&&(isDataChanged=!0)}else if(section==PMSCommon.SECTION_KRA_APPROVAL){ZPeopleComponents.toggleswitch(pageId.find("#kraApproval")).getState()!==PMSSetting.kraGoalDefaultObject.kraApproval&&(isDataChanged=!0)}else if(section==PMSCommon.REVIEWER_RESTRICTION_IN_MR)pageId.find("#reviewCantRater").is(":checked")!==PMSSetting.reviewSetdefaultObject.isReviewCantRater&&(isDataChanged=!0);else if(section==PMSCommon.NOR_REASON_ENABLE)pageId.find("#reasonForNormalization").is(":checked")!==PMSSetting.reviewSetdefaultObject.isNorReason&&(isDataChanged=!0);else if(section==PMSCommon.NOR_REASON_MANDATORY)pageId.find("#reasonMandatoryNorm").is(":checked")!==PMSSetting.reviewSetdefaultObject.isNorMandatory&&(isDataChanged=!0);else if(section==PMSSetting.SECTION_GOALDATETYPE){var goalDateFields=ZPeopleComponents.tokenfield(pageId.find("#goalDateFields")).getAllValues(),expected_goalDateFields=PMSSetting.kraGoalDefaultObject.goalDateType;if(goalDateFields.length!=expected_goalDateFields.length)isDataChanged=!0;else for(var i in goalDateFields)if(!expected_goalDateFields.includes(goalDateFields[i].id)){isDataChanged=!0;break}}else if(section==PMSCommon.COURSE_DETAIL)pageId.find("#courseView").is(":checked")!==PMSSetting.reviewSetdefaultObject.isListCourse&&(isDataChanged=!0);else if(section==PMSCommon.SECTION_APPRAISAL_ESIGN)pageId.find("#appraisalsignenabledisable").is(":checked")!==PMSSetting.IS_APPRAISAL_ESIGN_ENABLED&&(isDataChanged=!0);else if(section==PMSCommon.SECTION_GOALPRIORITY&&PMSSetting.goalPriorityEnable)for(var ids=["lowPriorityName","medPriorityName","higPriorityName","hisPriorityName"],iter=0;iter<4&&(PMSSetting.goalPriorityOptn[PMSSetting.goalPriorityCode[iter]]!=pageId.find("#"+ids[iter]).val().trim()&&(isDataChanged=!0),!isDataChanged);iter++);}return isDataChanged},duplicateNameErrorMsg:function(obj,dispName,isModule){var isValid=!1;return""===dispName&&($(obj).trigger("focus"),$(obj).addClass("ztextbox__error"),isValid=!0),(isModule&&dispName.length>25||dispName.length>100)&&($(obj).trigger("focus"),$(obj).addClass("ztextbox__error"),ZPeople.Message.warning(ZPI18N.getString("zp.exceedmaxlength")),isValid=!0),isValid},arrayDataChangeCheck:function(actualArr,expectedArr){var isDataChanged=!1;if(null!==actualArr&&null!==expectedArr)if(actualArr.length===expectedArr.length)for(var i=0;i<expectedArr.length;i++){var tempVal=expectedArr[i];if(-1===actualArr.indexOf(tempVal))return isDataChanged=!0}else isDataChanged=!0;else null===expectedArr&&null!==actualArr&&actualArr.length>0?isDataChanged=!0:null===actualArr&&null!==expectedArr&&expectedArr.length>0&&(isDataChanged=!0);return isDataChanged},saveSkillSetPermission:function(){var pageId=settingsPage.container,skillPermissionData={isSkillAdd_Self:pageId.find("#SkillAdd_Self").prop("checked"),isSkillAdd_Rep:pageId.find("#SkillAdd_Rep").prop("checked"),isSkillAdd_DepHead:pageId.find("#SkillAdd_DepHead").prop("checked"),isSkillEdit_Self:pageId.find("#SkillEdit_Self").prop("checked"),isSkillEdit_Rep:pageId.find("#SkillEdit_Rep").prop("checked"),isSkillEdit_DepHead:pageId.find("#SkillEdit_DepHead").prop("checked"),isSkillDelete_Self:pageId.find("#SkillDelete_Self").prop("checked"),isSkillDelete_Rep:pageId.find("#SkillDelete_Rep").prop("checked"),isSkillDelete_DepHead:pageId.find("#SkillDelete_DepHead").prop("checked"),isSkillView_DepHead:pageId.find("#SkillView_DepHead").prop("checked")};if(PMSSetting.dataChanged(PMSCommon.SECTION_SKILL_ACCESS)){var param={};param.skillsData=JSON.stringify(skillPermissionData),PMSSetting.addOrUpdateSkillSetSettings(PMSCommon.SECTION_SKILL_ACCESS,param)}},constructScoreWeitageList:function(){var pageId=settingsPage.container,prevWeight=0,_htm="";if(PMSSetting.potentialobj={},PMSSetting.unchangedpotential={},null!=PMSSetting.skillsetDefaultObject){var resultData=PMSSetting.skillsetDefaultObject.scoreWeightageList;$.each(resultData,function(index,data){_htm+='<tr type="'+index+'" id = "potentialrange_'+data.WeightageID+'"><td  id="editweightAgeName_'+data.WeightageID+'"><input id="editweightageinputNameVal_'+data.WeightageID+'" type="text" class="ztextbox w300" value="'+data.WeightageName+'"></td>',_htm+='<td ><div class="zpl_idiv" ><div class="ztextbox--group ztextbox--zicon zpl_inpticfild zh-alignright w100" rel="inputtd"  id="editweightAge_'+data.WeightageID+'_min"><span class="ztextbox__icon">%</span><input type="text" class="ztextbox w100" minval="'+data.Weightage+'" prevval="'+prevWeight+'" id="editweightageinputVal_'+data.WeightageID+'_min" value="'+prevWeight+'"></div><em>-</em>',_htm+='<div class="ztextbox--group ztextbox--zicon zpl_inpticfild zh-alignright w100"  id="editweightAge_'+data.WeightageID+'_max"><span class="ztextbox__icon">%</span><input type="text" class="ztextbox w100" maxval="'+data.Weightage+'" prevval="'+prevWeight+'" id="editweightageinputVal_'+data.WeightageID+'_max" value="'+data.Weightage+'"></div></div></td></tr>',PMSSetting.potentialobj[data.WeightageID]={min:parseInt(prevWeight),max:parseInt(data.Weightage),name:ZPeople.decodeTxt(data.WeightageName)},PMSSetting.unchangedpotential[data.WeightageID]={min:parseInt(prevWeight),max:parseInt(data.Weightage),name:ZPeople.decodeTxt(data.WeightageName)},prevWeight=parseInt(data.Weightage)+1})}pageId.find("#potentialbody").empty().html(_htm),pageId.find("#potentialbody").find("tr:last td:last").find("input:last").attr("disabled",!0),pageId.find("#potentialbody").find("tr:first td:last").find("input:first").attr("disabled",!0),pageId.find("#potentialDiv [id^=editweightageinputVal_]").focusout(function(event){PMSSetting.validatePotential($(this))}),pageId.find("#potentialDiv [id^=editweightageinputNameVal_]").focusout(function(event){var potentialid=$(this).attr("id").split("_")[1],name=pageId.find("#potentialrange_"+potentialid).find("#editweightageinputNameVal_"+potentialid).val();void 0!==name&&""!==name.trim()?PMSSetting.potentialobj[potentialid].name=name:$(this).val(PMSSetting.potentialobj[potentialid].name),PMSSetting.isPotentialDataChanged(PMSSetting.unchangedpotential,PMSSetting.potentialobj)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_SKILLPOTENTIAL):PMSSetting.closeResetSave(PMSSetting.SECTION_SKILLPOTENTIAL)})},isPotentialDataChanged:function(unchangedobj,changedobj){for(const key in changedobj)if(changedobj.hasOwnProperty(key)){const changedData=changedobj[key],unchangedData=unchangedobj[key];if(JSON.stringify(changedData)!==JSON.stringify(unchangedData))return!0}return!1},validatePotential:function(obj){const pageId=settingsPage.container,potentialId=$(obj).attr("id").split("_")[1],trRowObj=pageId.find("#potentialrange_"+potentialId),value=$(obj).val().trim();if(void 0!==value&&""!==value.trim()&&!isNaN(value)&&value>=0&&value<=100)if($(obj).attr("id").includes("min")){const prevInput=trRowObj.prev().find("td:last input:last"),preMinValue=parseInt(trRowObj.prev().find("td:last input:first").val()),currMax=parseInt(trRowObj.find("td:last input:last").val()),parsedValue=parseInt(value),prevPotentialId=trRowObj.prev().find("td:last input:last").attr("id").split("_")[1];parsedValue>preMinValue&&parsedValue<currMax?(prevInput.val(parsedValue-1),PMSSetting.potentialobj[potentialId].min=parsedValue,PMSSetting.potentialobj[prevPotentialId].max=parsedValue-1):$(obj).val(parseInt(PMSSetting.potentialobj[prevPotentialId].max)+1)}else{const nextInput=trRowObj.next().find("td:last input:first"),nextMaxValue=parseInt(trRowObj.next().find("td:last input:last").val()),nextPotentialId=trRowObj.next().find("td:last input:last").attr("id").split("_")[1],prevCurrValue=trRowObj.find("td:last input:first").val();parseInt(value)<nextMaxValue&&parseInt(value)>parseInt(prevCurrValue)?(nextInput.val(parseInt(value)+1),PMSSetting.potentialobj[potentialId].max=parseInt(value),PMSSetting.potentialobj[nextPotentialId].min=parseInt(value)+1):parseInt(value)>=nextMaxValue||parseInt(value)<=prevCurrValue?$(obj).val(parseInt(PMSSetting.potentialobj[potentialId].max)):$(obj).val(parseInt(PMSSetting.potentialobj[potentialId].max)+1)}else{let id=potentialId;$(obj).attr("id").includes("min")||(id=potentialId),$(obj).val(parseInt(PMSSetting.potentialobj[id][$(obj).attr("id").includes("min")?"min":"max"]))}PMSSetting.isPotentialDataChanged(PMSSetting.unchangedpotential,PMSSetting.potentialobj)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_SKILLPOTENTIAL):PMSSetting.closeResetSave(PMSSetting.SECTION_SKILLPOTENTIAL)},skillMatrixValidation:function(event){var pageId=settingsPage.container,detail=event.detail,matrixRole=pageId.find("#skillsetmatrixRole"),_tokenData=detail.tokenData,returnedData=ZPeopleComponents.tokenfield(matrixRole).getAllValues();"-1"==_tokenData.value&&returnedData.length>0?ZPeopleComponents.tokenfield(matrixRole).removeAllTokens():ZPeopleComponents.tokenfield(matrixRole).removeTokens(["-1"])},skillMatrixAfterTokenAdd:function(){PMSSetting.dataChanged(PMSCommon.SECTION_SKILL_MATRIX)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_SKILL_MATRIX):PMSSetting.closeResetSave(PMSCommon.SECTION_SKILL_MATRIX)},saveScoreWeightAge:function(section){const pageId=settingsPage.container,data=PMSSetting.potentialobj,pObjArray=[];let count=0;for(const key in data)if(data.hasOwnProperty(key)){const item=data[key];if(count<Object.keys(data).length-1){const pObj={editweightAgeId:key,editweightAgeName:item.name,editweightAge:item.max};pObjArray.push(pObj)}count++}ZPeople.autosave.loading(pageId.find("#skillsetcerpotantial"),ZPI18N.getString("zp.saving"));let params={mode:"paskillsetsettings",potentialObj:JSON.stringify(pObjArray),settingsmode:"updatePotential",conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){const parseObj=resultData;"sucess"===parseObj.msg?(PMSSetting.skillsetDefaultObject.scoreWeightageList=parseObj.scoreWeightageList,PMSSetting.constructScoreWeitageList(),ZPeople.autosave.success(pageId.find("#skillsetcerpotantial"),ZPI18N.getString("zp.saved")),PMSSetting.closeResetSave(section)):"Not_valid"===parseObj.msg?ZPeople.Message.failure(ZPI18N.getString("appraisal.settings.pleaseentervalidrange")):"permission_denied"===resultData.msg&&ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied"))})},saveSkillsetMatrix:function(){var matrixRole=settingsPage.container.find("#skillsetmatrixRole"),returnedData=ZPeopleComponents.tokenfield(matrixRole).getAllValues(),_rolesTxt=[];for(var i in returnedData)_rolesTxt.push(returnedData[i].id);var param={};param.selectedSkillMatrixRoles=_rolesTxt.toString(),PMSSetting.addOrUpdateSkillSetSettings(PMSCommon.SECTION_SKILL_MATRIX,param)},isUserSkillMapApprovalConfigured:function(){var pageId=settingsPage.container;null!=PMSSetting.userSkillMapFormId&&null!=PMSSetting.isUserSkillMap_apprConf||$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getUserSkillMapConf",conreqcsr:csrfToken},success:function(data){PMSSetting.userSkillMapFormId=data.userSkillMapFormId,PMSSetting.isUserSkillMap_apprConf=data.isUserSkillMapApproverConf,PMSSetting.userSkillMapApprovalId=data.approvalID}});let skillApprLink="#settings/service/performance/approval";var approvaltxt='<a target="_blank" href="'+(skillApprLink+=null!==PMSSetting.userSkillMapFormId&&void 0!==PMSSetting.userSkillMapFormId||""!==PMSSetting.userSkillMapFormId?"-formid:"+PMSSetting.userSkillMapFormId:"")+'" class="u-link zpl_link">'+ZPI18N.getString("zp.clickhere")+"</a>"+ZPI18N.getString("zp.pa.skillset.skillsetlevelupgrade",new Array(PMSSetting.SKILLSET_DISPLAY_NAME));pageId.find("#approvalLink").html(approvaltxt),pageId.find("#userApproval").show()},saveSettings:(event,sectionConstant,paramName)=>{const{state:state}=event.detail;if(PMSSetting.dataChanged(sectionConstant)){const param={[paramName]:state?1:0};PMSSetting.addOrUpdateSkillSetSettings(sectionConstant,param)}},saveCertificationMand:event=>{PMSSetting.saveSettings(event,PMSCommon.SECTION_CERTIFICATION_MANDATORY,"certificationMand")},saveUpgradeReasonMand:event=>{PMSSetting.saveSettings(event,PMSCommon.SECTION_UPGRADEREASON_MANDATORY,"upgradeReasonMand")},saveSkillsetWeightageVal:obj=>{const param={restrictSkillSetWeightageValidation:$(obj).find("input").is(":checked")?0:1};PMSSetting.addOrUpdateSkillSetSettings(PMSCommon.RESTRICT_SKILLSET_WEIGHTAGE_VALIDATION,param)},configureSkillSetApproval:function(event){var pageId=settingsPage.container;event.detail.state?PMSSetting.isUserSkillMapApprovalConfigured():pageId.find("#userApproval").hide(),PMSSetting.dataChanged(PMSCommon.SECTION_SKILLSET_APPROVAL)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_SKILLSET_APPROVAL):PMSSetting.closeResetSave(PMSCommon.SECTION_SKILLSET_APPROVAL)},saveSkillSetApproval:function(){var pageId=settingsPage.container,returnedData=ZPeopleComponents.toggleswitch(pageId.find("#skillSetApproval")).getState();if(PMSSetting.isUserSkillMap_apprConf=null,PMSSetting.isUserSkillMapApprovalConfigured(),returnedData&&0==PMSSetting.isUserSkillMap_apprConf)ZPeople.Message.failure("Configure SkillSet Approval");else{var param={};param.skillSetApproval=returnedData?1:0,PMSSetting.addOrUpdateSkillSetSettings(PMSCommon.SECTION_SKILLSET_APPROVAL,param)}},addOrUpdateSkillSetSettings:function(mode,param){var data={mode:"paskillsetsettings",conreqcsr:csrfToken},_settingsmode="",_saveicon="";mode==PMSCommon.SECTION_SKILLSET_APPROVAL?(data.skillSetApproval=param.skillSetApproval,_settingsmode="updateSkillSetApproval",_saveicon="skillsetapprhdr"):mode==PMSCommon.SECTION_SKILL_MATRIX?(data.selectedSkillMatrixRoles=param.selectedSkillMatrixRoles,_settingsmode="updateMatrixRoles",_saveicon="skillsetmatrix"):mode==PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE?(1===param.skillScoreDefinitionConfigurable&&(data.skillScoreNames=param.skillScoreNames),data.skillScoreDefinitionConfigurable=param.skillScoreDefinitionConfigurable,_settingsmode="updateSkillScore",_saveicon="skillsetscore"):mode==PMSCommon.SECTION_SKILL_ACCESS?(data.skillsData=param.skillsData,_settingsmode="updateSkillPermission",_saveicon="skillsetpermhdr"):mode==PMSCommon.SECTION_CERTIFICATION_MANDATORY?(_settingsmode="updateSkillCertMandatory",_saveicon="skillsetcertmandatory",data.certificationMand=param.certificationMand):mode==PMSCommon.RESTRICT_SKILLSET_WEIGHTAGE_VALIDATION?(_settingsmode="updateSkillSetWeightage",data.restrictSkillSetWeightageValidation=param.restrictSkillSetWeightageValidation,_saveicon="skillsetweight"):mode==PMSCommon.SECTION_UPGRADEREASON_MANDATORY?(_settingsmode="updateReasonMand",data.upgradeReasonMand=param.upgradeReasonMand,_saveicon="skillsetcertmandatory"):mode==PMSCommon.SECTION_SKILLWEIGHTAGE&&(_settingsmode="skillsetweightagedisabled",data.disabled=param.skillWeightageDisable,_saveicon="skillsetweight"),data.settingsmode=_settingsmode;var pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#"+_saveicon),ZPI18N.getString("zp.saving")),PMSSetting.closeResetSave(mode),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:data,success:function(resultData){if("success"==resultData.msg){var data=resultData.data;mode==PMSCommon.SECTION_SKILL_ACCESS?PMSSetting.skillsetDefaultObject.skillsPermissionData=JSON.parse(param.skillsData):mode==PMSCommon.SECTION_SKILLSET_APPROVAL?PMSSetting.skillsetDefaultObject.skillSetApproval=param.skillSetApproval:mode==PMSCommon.SECTION_SKILL_MATRIX?PMSSetting.skillsetDefaultObject.skillmatrixRole=param.selectedSkillMatrixRoles:mode==PMSCommon.SECTION_CERTIFICATION_MANDATORY?PMSSetting.skillsetDefaultObject.certificationMand=param.certificationMand:mode==PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE?(data.skillScoreDefinitionConfigurable?data.skillScoreNames&&(PMSSetting.skillsetDefaultObject.skillScoreNames=data.skillScoreNames):PMSSetting.skillsetDefaultObject.skillScoreNames=JSON.parse(param.skillScoreNames),PMSSetting.skillsetDefaultObject.skillScoreDefinitionConfigurable=data.skillScoreDefinitionConfigurable):mode==PMSCommon.RESTRICT_SKILLSET_WEIGHTAGE_VALIDATION?PMSSetting.skillsetDefaultObject.restrictSkillSetWeightageValidation=param.restrictSkillSetWeightageValidation:mode==PMSCommon.SECTION_UPGRADEREASON_MANDATORY?PMSSetting.skillsetDefaultObject.upgradeReasonMand=param.upgradeReasonMand:mode==PMSCommon.SECTION_SKILLWEIGHTAGE&&(PMSSetting.skillsetDefaultObject.skillsetweightagedisabled=data.skillsetweightagedisabled,data.skillsetweightagedisabled?(pageId.find("#skillsetweightvaldiv").addClass("DN"),pageId.find("#skillsetcerpotantial").parent().hide()):(pageId.find("#skillsetweightvaldiv").removeClass("DN"),pageId.find("#skillsetcerpotantial").parent().show())),ZPeople.autosave.success(pageId.find("#"+_saveicon),ZPI18N.getString("zp.saved")),PMSSetting.closeResetSave(mode)}else"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#"+_saveicon)),PMSCommon.autosave.enableHdrBtn(pageId.find("#"+_saveicon))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#"+_saveicon)),PMSCommon.autosave.enableHdrBtn(pageId.find("#"+_saveicon)))}})},validateSkillScoreBox:function(obj){var pageId=settingsPage.container;$(obj).removeClass("ztextbox__error");var compName=$(obj).attr("id"),dispName=$(obj).val().trim(),isFlag=!1;if(ZPeopleComponents.toggleswitch(pageId.find("#skillScoreDefinitionConfigurable")).getState()&&!PMSSetting.duplicateNameErrorMsg(obj,dispName)){for(var key in PMSSetting.skillScoreNames)PMSSetting.skillScoreNames[key].toLowerCase()===dispName.toLowerCase()&&key!==compName&&($(obj).trigger("focus"),$(obj).addClass("ztextbox__error"),ZPeople.Message.warning(ZPI18N.getString("zp.duplicateName")),isFlag=!0);if(PMSSetting.skillScoreNames[compName]=dispName,!isFlag)PMSSetting.dataChanged(PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE):PMSSetting.closeResetSave(PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE);$(obj).focusout()}return isFlag},saveSkillScore:function(obj){var pageId=settingsPage.container,skillInvalidName=!1,skillInvalidLength=!1,isFlag=!1;if((ZPeopleComponents.toggleswitch(pageId.find("#skillScoreDefinitionConfigurable")).getState()&&(inputEle=pageId.find("#skillScoreDefinition input[type='text']"),$.each(inputEle,function(index,obj){""!==$(obj).val().trim()&&void 0===$(obj).attr("style")||($(obj).addClass("ztextbox__error"),skillInvalidName=!0),$(obj).val().length>100&&($(obj).trigger("focus"),$(obj).addClass("ztextbox__error"),skillInvalidLength=!0)}),skillInvalidName&&(ZPeople.Message.warning(ZPI18N.getString("zp.validData")),isFlag=!0),skillInvalidLength&&(ZPeople.Message.warning(ZPI18N.getString("zp.exceedmaxlength")),isFlag=!0)),!isFlag)&&PMSSetting.dataChanged(PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE)){var param={},isSkillScoreConfigurable=ZPeopleComponents.toggleswitch(pageId.find("#skillScoreDefinitionConfigurable")).getState()?1:0;param.skillScoreDefinitionConfigurable=isSkillScoreConfigurable;var skillScoreObj={};pageId.find("#skillScoreDefinition").find("input").each(function(){skillScoreObj[$(this).attr("id")]=0==isSkillScoreConfigurable?"":$(this).val().trim()}),param.skillScoreNames=JSON.stringify(skillScoreObj),PMSSetting.addOrUpdateSkillSetSettings(PMSCommon.SECTION_SKILLSCORE_CONFIGURABLE,param)}},competencySetInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;if(PMSOperationCommon.addClearCentreClass(!0),PMSSetting.validateModuleStatus("Competency"))return;settingsPage.container.find(".zpl_btnmnu").addClass("zpl_DNI"),0==pageId.find("#pmsettingsdiv").length&&$.ajax({type:"POST",async:!1,url:"/performance/view/competencySettings",data:{conreqcsr:csrfToken},success:function(resultData){pageId.append(resultData),$(pageId.find(".togBtn")).ztoggleswitch({size:"medium"}),PMSSetting.fetchCompConfigData()}})}},salaryInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"isSettAccesssible"},function(resultData){if(resultData.isPageAccess){if(PMSOperationCommon.addClearCentreClass(!0),0==pageId.find("#pmsettingsdiv").length){PMSSetting.getPerformanceModules();let salaryHtml='<div class="zpl_rgtcnt" id="pmsettingsdiv"><div class="zpl_crd">';salaryHtml+='<div class="zpl_crdhdr" id="salaryweighthdr"><div><h4>'+ZPI18N.getString("zp.salary")+"</h4>",void 0!=PMSSetting.CONF_DETAILS.isSalaryDataSourceCompensation&&PMSSetting.CONF_DETAILS.isSalaryDataSourceCompensation?salaryHtml+="<p>"+ZPI18N.getString("zp.pa.salary.salarycompdesc")+"</p>":salaryHtml+="<p>"+ZPI18N.getString("zp.pa.salary.salarydesc")+"</p>",salaryHtml+='<div class="zpl_hdcnt" id="SALARY">',void 0!=PMSSetting.CONF_DETAILS.isCompensationNewOrgGSNotCompleted&&PMSSetting.CONF_DETAILS.isCompensationNewOrgGSNotCompleted?void 0!=PMSSetting.CONF_DETAILS.isCompensationTabDisabled&&PMSSetting.CONF_DETAILS.isCompensationTabDisabled?salaryHtml+='<div class="zpl_tgl">'+ZPI18N.getString("zp.pacompensationdisabled")+"</div>":void 0!=PMSSetting.CONF_DETAILS.showCompensationInitlink&&PMSSetting.CONF_DETAILS.showCompensationInitlink&&(void 0!=Compensation&&Compensation.PermissionBean&&Compensation.PermissionBean.getPermBean()&&Compensation.PermissionBean.getPermBean().isTabAllowed?(salaryHtml+='<div class="zpl_tgl" style="display: none;"><input id="tg_salary" class="togBtn" compName="SALARY" style="display: none;">'+ZPI18N.getString("zp.enable")+"</div>",salaryHtml+='<div class="zpl_tgl"><a target="_blank" href="#settings/service/salarydetails/gettingStarted">'+ZPI18N.getString("zp.compensationmoduleconfig")+"</div>"):salaryHtml+='<div class="zpl_tgl">'+ZPI18N.getString("zp.compensationnotconfigured")+"</div>"):salaryHtml+='<div class="zpl_tgl"><input id="tg_salary" class="togBtn" compName="SALARY" style="display: none;">'+ZPI18N.getString("zp.enable")+"</div>",salaryHtml+="</div></div></div>",salaryHtml+="</div></div>",pageId.append(salaryHtml),$(pageId.find(".togBtn")).ztoggleswitch({size:"medium"}),ZPeopleComponents.toggleswitch(pageId.find("#tg_salary")).setAttributes({change:PMSSetting.updatePerformanceModulesPrereq}),1===PMSSetting.ENABLED_MODULES.SALARY.enable?pageId.find("#SALARY .togBtn").ztoggleswitch("switchOn"):pageId.find("#SALARY .togBtn").ztoggleswitch("switchOff")}}else pageId.html("<div>"+ZPI18N.getString("zp.permissiondeniedtoaccessthispage")+"</div>")})}},fetchCompConfigData:function(){$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getSettingsConfig",submode:"getcompetencyconfig",conreqcsr:csrfToken},success:function(resultData){PMSSetting.compDefaultObject=resultData,PMSSetting.setComptencyData(resultData)}})},setComptencyData:function(resultData){var pageId=settingsPage.container,_isWeightageDisabled=resultData.competencyDisabled?"switchOff":"switchOn";if(pageId.find("#compWeitageDisable").ztoggleswitch(_isWeightageDisabled),resultData.hasOwnProperty("restrictCompWeightageValidation")){var _restrictCompWeightageValidation=!resultData.restrictCompWeightageValidation;pageId.find("#competency_restrict").prop("checked",_restrictCompWeightageValidation)}ZPeopleComponents.toggleswitch(pageId.find("#compWeitageDisable")).setAttributes({change:PMSSetting.enableDisableCompentencyWeightage}),resultData.competencyDisabled&&pageId.find("#comprestrict").hide()},enableDisableCompentencyWeightage:function(event){if(event.detail.fromUI){var pageId=settingsPage.container,data=event.detail,state=(pageId=settingsPage.container,data.state?0:1);ZPeople.autosave.loading(pageId.find("#competencyweighthdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pacomptencysettings",conreqcsr:csrfToken,competencydisabled:state,compSortType:"0",settingsmode:"updatecompweitage"},success:function(resultData){if("success"==resultData.msg){var data=resultData.data;ZPeople.autosave.success(pageId.find("#competencyweighthdr"),ZPI18N.getString("zp.saved")),data.competencydisabled?pageId.find("#comprestrict").hide():pageId.find("#comprestrict").show()}else"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#competencyweighthdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#competencyweighthdr")))}})}},restrictCompWeightageValidation:function(obj){var pageId=settingsPage.container,_restrictCompWeightageValidation=$(obj).find("input").is(":checked")?0:1;ZPeople.autosave.loading(pageId.find("#competencyweighthdr"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"pacomptencysettings",conreqcsr:csrfToken,restrictCompWeightageValidation:_restrictCompWeightageValidation,settingsmode:"restrictCompWeightageValidation"},success:function(resultData){"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#competencyweighthdr"),ZPI18N.getString("zp.saved")):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#competencyweighthdr"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#competencyweighthdr")))}})},reviewSettingInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!0),$.ajax({type:"POST",async:!1,url:"/performance/view/reviewSettings",data:{conreqcsr:csrfToken},success:function(resultData){pageId.find("#reviewordercustom").length>0&&ZPeopleComponents.listbox(pageId.find("#reviewordercustom")).destroy(),pageId.find("#reviewextndiv select").length>0&&pageId.find("#reviewextndiv select").each(function(index){var attrId=$(this).attr("id");ZPeopleComponents.select("#"+attrId).destroy()}),ZPeopleComponents.isComponent(pageId.find("#cycleDeleteUserList"))&&ZPeopleComponents.tokenfield(pageId.find("#cycleDeleteUserList")).destroy(),pageId.html(""),pageId.append(resultData),PMSSetting.getPerformanceModules(),$(pageId.find(".togBtn")).ztoggleswitch({size:"medium"}),PMSSetting.fetchReviewSettingsData()}})}},fetchReviewSettingsData:function(){$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getSettingsConfig",submode:"getreviewsettingsconfig",conreqcsr:csrfToken},success:function(resultData){PMSSetting.reviewSetdefaultObject=resultData,PMSSetting.setReviewSettingsData(resultData)}})},setReviewSettingsData:function(resultData){var pageId=settingsPage.container;if(pageId.find("#reviewappraisalhike h4").html(ZPeople.escapeHtml(PMSSetting.CONF_DETAILS.hikeTerm.SALARY_HIKE_NAME)),PMSSetting.constructReviewOrder(resultData.revieworder),resultData.feedback_types){pageId.find("#reviewFeedbackType").empty(),PMSSetting.constructReviewFeedback(resultData.feedback_types);var options=PMSSetting.updateFeedbackTypeOption();pageId.find("#reviewextndiv").bind("keypress click",function(event){var target=$(event.target);if("click"==event.type)if(target.is("I")&&target.hasClass("PI_delete")){var options,_selectid=target.parent().parent().find("select").attr("id");ZPeopleComponents.select(pageId.find("#"+_selectid)).destroy(),target.parent().parent().remove(),1==pageId.find("#reviewextndiv div[rel=reviewextension]").length&&pageId.find("#reviewextndiv .PI_delete").parent().remove(),pageId.find("#reviewextndiv select").each(function(index){var attrId=$(this).attr("id");ZPeopleComponents.select(pageId.find("#"+attrId)).removeAllOptions()}),pageId.find("#reviewextndiv select").each(function(index){var attrId=$(this).attr("id");options=PMSSetting.updateFeedbackTypeOption(),ZPeopleComponents.select(pageId.find("#"+attrId)).addOption(options),ZPeopleComponents.select(pageId.find("#"+attrId)).setValue(options[0].value)}),options.length>1&&pageId.find("#addreviewextn").show(),PMSSetting.dataChanged(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION):PMSSetting.closeResetSave(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)}else(target.is("a")&&target.find("i").hasClass("PI_plusTemp")||target.is("I")&&target.hasClass("PI_plusTemp"))&&PMSSetting.constructReviewExtn();else if(target.is("input")&&"keypress"==event.type){PMSSetting.dataChanged(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION):PMSSetting.closeResetSave(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)}})}if(ZPeopleComponents.toggleswitch(pageId.find("#configRule")).setAttributes({change:PMSSetting.enableReviewExtn}),resultData.acceptanceData&&0==resultData.acceptanceData.length)pageId.find("#configRule").ztoggleswitch("switchOff"),pageId.find("#reviewextndiv").hide();else{var indx=1;$.each(resultData.acceptanceData,function(index,data){var _htm=PMSSetting.getAcceptanceHtml(indx,data.noofDays);$(_htm).insertBefore(pageId.find("#addreviewextn"));var selectElem=pageId.find("#reviewFeedbackOption_"+indx);let selOptions=PMSSetting.updateFeedbackTypeOption();ZPeopleComponents.select(selectElem),ZPeopleComponents.select(selectElem).addOption(selOptions),ZPeopleComponents.select(selectElem).setValue(data.optionID),pageId.find(selectElem).on("zselectchange",PMSSetting.changeReviewExtn),pageId.find(selectElem).parent().parent().find("input").val(data.noofDays),indx++}),pageId.find("#configRule").ztoggleswitch("switchOn"),pageId.find("#reviewextndiv").show(),pageId.find("#reviewextndiv select").length==options.length&&pageId.find("#addreviewextn").hide()}var _salaryHikeElem="1"==resultData.hikeInput?"#salaryhikepercentage":"#salaryhikeamount";pageId.find(_salaryHikeElem).prop("checked",!0),pageId.find("#salaryhikeSec input[type=radio]").change(function(){PMSSetting.updatehikeSettings($(this))});var _multiRaterTyHtm=PMSSetting.constructMultiRaterTypes(resultData.multiraterType);if(pageId.find("#addmultiratertypes").append($(_multiRaterTyHtm)),Object.keys(resultData.multiraterType).length<5&&pageId.find("#addmultirtaddbtn").parent().show(),PMSSetting.multiratertypeactions(),pageId.find("#selfappraisalhide").prop("checked",resultData.isHideSelfAppraisalReview),pageId.find("#skipreviewlvl").prop("checked",resultData.skipreviewlvl),pageId.find("#reviewCantRater").prop("checked",resultData.isReviewCantRater),pageId.find("#reasonForNormalization").prop("checked",resultData.isNorReason),pageId.find("#reasonMandatoryNorm").prop("checked",resultData.isNorMandatory),ZPeopleComponents.toggleswitch(pageId.find("#crBasedCycle")).switchOff(),resultData.isCRBasedCycle&&ZPeopleComponents.toggleswitch(pageId.find("#crBasedCycle")).switchOn(),ZPeopleComponents.toggleswitch(pageId.find("#crBasedCycle")).setAttributes({change:PMSSetting.enabledCrBasedCycle}),"null"!=PMSSetting.noticePeriodOpt&&""!=PMSSetting.noticePeriodOpt&&pageId.find("#excludeNoticEmp").prop("checked",resultData.excludeNoticEmp),"null"!=PMSSetting.noticePeriodOpt&&""!=PMSSetting.proPeriodOpt&&pageId.find("#excludeProbEmp").prop("checked",resultData.excludeProbEmp),pageId.find("#cycleDeleteRestriction").length>0){var selectedList=[];null!=resultData.cycleDeleteRestrictionSelectedUser&&(selectedList=resultData.cycleDeleteRestrictionSelectedUser,ZPeople.getUserDetailsByIds(selectedList)),UserUtils.createMultiSelectEmpSearchbox("cycleDeleteUserList","cycleAdmins",{pModal:pageId,placeHolder:ZPI18N.getString("zp.performance.selectadmins"),initSelVal:selectedList}),pageId.find("#cycleDeleteUserList").on("ztokenfieldtokenadd",PMSSetting.delUsrListTokenAddRemove),pageId.find("#cycleDeleteUserList").on("ztokenfieldtokenremove",PMSSetting.delUsrListTokenAddRemove),void 0!=resultData.isCycleDeleteRestrictEnabled&&resultData.isCycleDeleteRestrictEnabled?(pageId.find("#cycleDeleteRestriction").prop("checked",!0),pageId.find("#cycleDeleteNotes").show(),pageId.find("#cycleDeleteRestictionSelect").show()):(pageId.find("#cycleDeleteRestriction").prop("checked",!1),pageId.find("#cycleDeleteRestictionSelect").hide())}pageId.find("#moduleratingMailmerge").prop("checked",resultData.isModuleRatingMailMergeEnabled)},showHideCommence:function(type){PMSSetting.PA_REVIEWTYPE=type,PMSSetting.initPARem(type)},getSystemFields:function(){var fieldObj={System_Fields:{},System_Fields:{System_Fields:{}}},sysFields=fieldObj.System_Fields;return"SALARY_HIKE_PUSH_NOTIFY"==PMSSetting.PA_REVIEWTYPE?(PMSV2Cycle.getHikeTerms(),sysFields.System_Fields.Appraiser_Name=ZPI18N.getString("zp.local.Appraiser")+" "+ZPI18N.getString("zp.name"),sysFields.System_Fields.Appraiser_Employee_Id=ZPI18N.getString("zp.local.Appraiser")+" "+ZPI18N.getString("zp.employeeid"),sysFields.System_Fields.Appraisee_Name=ZPI18N.getString("zp.appraisee")+" "+ZPI18N.getString("zp.name"),sysFields.System_Fields.Appraisee_Employee_Id=ZPI18N.getString("zp.appraisee")+" "+ZPI18N.getString("zp.employeeid"),sysFields.System_Fields.Cycle_Start_Date=ZPI18N.getString("zp.local.AppraisalStartDate"),sysFields.System_Fields.Cycle_End_Date=ZPI18N.getString("zp.local.AppraisalEndDate"),sysFields.System_Fields.Hike_Start_Date=ZPI18N.getString("zp.local.hikefromdate"),sysFields.System_Fields.Hike_End_Date=ZPI18N.getString("zp.local.hiketodate"),sysFields.System_Fields.SalaryCycle_Name=ZPI18N.getString("zp.addsalaryhikecycle",new Array(PMSV2Cycle.SALARYHIKENAME)),sysFields.System_Fields.Current_Salary=ZPI18N.getString("zp.local.currentsalary"),sysFields.System_Fields.Revised_Salary=ZPI18N.getString("zp.local.revisedsalary"),sysFields.System_Fields.Revised_Percentage=ZPI18N.getString("zp.pa.sh.hikepercentage"),sysFields.System_Fields.Current_Designation=ZPI18N.getString("zp.local.CurrentDesignation"),sysFields.System_Fields.Promoted_Designation=ZPI18N.getString("zp.local.PromotedDesignation"),sysFields.System_Fields.Remarks=ZPI18N.getString("zp.remarks")):PMSSetting.PA_REVIEWTYPE==PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_SELF_NOTIFY||PMSSetting.PA_REVIEWTYPE==PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY?(sysFields.System_Fields.Employee_Name=ZPI18N.getString("zp.employeename"),sysFields.System_Fields.Employee_Employee_Id=ZPI18N.getString("zp.employeeid"),sysFields.System_Fields.ReportingManager_Name=ZPI18N.getString("zp.reportingmanager")+" "+ZPI18N.getString("zp.name"),sysFields.System_Fields.ReportingManager_Employee_Id=ZPI18N.getString("zp.reportingmanager")+" "+ZPI18N.getString("zp.employeeid"),sysFields.System_Fields.DateofJoining=ZPI18N.getString("zp.dateofjoining"),sysFields.System_Fields.GoalSetting_Deadline_ForNewEmployee=ZPI18N.getString("zp.gsnewjoinee.deadline",[ZPeople.decodeTxt(PMSSetting.GOAL_DISPLAY_NAME)]),sysFields.System_Fields.Repeats=ZPI18N.getString("zp.repeats"),sysFields.System_Fields.Goal_Period_StartMonth=ZPI18N.getString("zp.gsnewjoinee.goalsettingstartmonth",[ZPeople.decodeTxt(PMSSetting.GOAL_DISPLAY_NAME)]),sysFields.System_Fields.Goal_Period_EndMonth=ZPI18N.getString("zp.gsnewjoinee.goalsettingendmonth",[ZPeople.decodeTxt(PMSSetting.GOAL_DISPLAY_NAME)]),PMSSetting.PA_REVIEWTYPE==PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY?(sysFields.System_Fields.New_Joinee_List=ZPI18N.getString("zp.gsnewjoinee.newemployeelist"),sysFields.System_Fields.Goal_Add_ReportingManager_URL=ZPI18N.getString("zp.gsnewjoinee.manageraddgoalurl",[ZPeople.decodeTxt(PMSSetting.GOAL_DISPLAY_NAME)])):sysFields.System_Fields.Goal_Add_Employee_URL=ZPI18N.getString("zp.gsnewjoinee.empaddgoalurl",[ZPeople.decodeTxt(PMSSetting.GOAL_DISPLAY_NAME)])):PMSSetting.PA_REVIEWTYPE==PMSCommon.SKILLSET_TAG_EMP||PMSSetting.PA_REVIEWTYPE==PMSCommon.SKILLSET_TAG_RM||PMSSetting.PA_REVIEWTYPE==PMSCommon.SKILLSET_UPGRADE_EMP||PMSSetting.PA_REVIEWTYPE==PMSCommon.SKILLSET_UPGRADE_RM?(sysFields.System_Fields.Employee_Name=ZPI18N.getString("zp.employeename"),sysFields.System_Fields.Employee_Id=ZPI18N.getString("zp.employeeid"),sysFields.System_Fields.ReportingManager_Id=ZPI18N.getString("zp.reportingmanager")+" "+ZPI18N.getString("zp.employeeid"),sysFields.System_Fields.ReportingManager_Name=ZPI18N.getString("zp.reportingmanager")+" "+ZPI18N.getString("zp.name"),sysFields.System_Fields.Score_GivenBy=ZPI18N.getString("zp.skillGivenby",[ZPeople.decodeTxt(PMSSetting.SKILLSET_DISPLAY_NAME)]),sysFields.System_Fields.Skill_Details=ZPI18N.getString("zp.skillDetails",[ZPeople.decodeTxt(PMSSetting.SKILLSET_DISPLAY_NAME)]),sysFields.System_Fields.View_Skill_URL=ZPI18N.getString("zp.skillURL",[ZPeople.decodeTxt(PMSSetting.SKILLSET_DISPLAY_NAME)])):(sysFields.System_Fields.Appraiser_Name=ZPI18N.getString("zp.local.Appraiser")+" "+ZPI18N.getString("zp.name"),sysFields.System_Fields.Appraiser_Employee_Id=ZPI18N.getString("zp.local.Appraiser")+" "+ZPI18N.getString("zp.employeeid"),sysFields.System_Fields.Cycle_Start_Date=ZPI18N.getString("zp.local.AppraisalStartDate"),sysFields.System_Fields.Cycle_End_Date=ZPI18N.getString("zp.local.AppraisalEndDate"),sysFields.System_Fields.Process_Start_Date=ZPI18N.getString("zp.appraisalprocessstartdate"),sysFields.System_Fields.Process_End_Date=ZPI18N.getString("zp.appraisalprocessenddate"),sysFields.System_Fields.Review_Start_Date=ZPI18N.getString("zp.local.ReviewStartDate"),sysFields.System_Fields.Review_End_Date=ZPI18N.getString("zp.local.ReviewEndDate"),sysFields.System_Fields.Cycle_Name=ZPI18N.getString("zp.appraisalcyclename"),sysFields.System_Fields.Appraisees=ZPI18N.getString("zp.appraisees")),fieldObj},initPARem:function(typeName){if(void 0==PMSSetting.paRemPrevCard||jQuery.isEmptyObject(PMSSetting.paRemPrevCard)){PMSSetting.paRemPrevCard={};var tab=new Tab;tab.id="paremprevcard",tab.cardId="paremprevcardslider",tab.validate=PMSSetting.savePaRem,PMSSetting.paRemPrevCard=new sliderModal(ZPI18N.getString("zp.emailtemplate"),tab),PMSSetting.paRemPrevCard.mediumSize=!0,PMSSetting.paRemPrevCard.construct(),PMSSetting.paRemPrevCard.setCloseCallback(function(){ZPA_Editor.destroy(),PMSSetting.paReminderTemplate={},ZPeopleComponents.isComponent(PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv"))&&ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv")).destroy(),typeName===PMSCommon.PA_REVIEW_END&&ZPeopleComponents.isComponent(PMSSetting.paRemPrevCard.sliderDiv.find("#setRemndVl"))&&ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#setRemndVl")).destroy(),PMSSetting.paRemPrevCard.remove(),PMSSetting.paRemPrevCard={}}),PMSSetting.paRemPrevCard.sliderDiv.find("#paremprevcardslider").append(ZPeople.LOADING_HTML)}if(PMSSetting.paRemPrevCard.sliderDiv.find("#viewTempDiv").append(ZPeople.LOADING_HTML),PMSSetting.paReminderTemplate[typeName])"custom"==ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv")).getValue()?(PMSSetting.paRemPrevCard.sliderDiv.find("#msgEditor").parent().parent().show(),PMSSetting.paRemPrevCard.sliderDiv.find("#msgEditor").show(),ZPA_Editor.initiateEditor(PMSSetting.paReminderTemplateMode,ZPA_Common.getFormId(PMSSetting.paReminderTemplateMode),PMSSetting.paReminderTemplate[typeName].template,PMSSetting.PA_Editor_Id+PMSSetting.paReminderTemplateMode)):PMSSetting.showDefaultTemplate(typeName);else{var params={mode:"getPAReminderTemplate",notificationName:typeName};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resp){ZPeopleComponents.isComponent(PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv"))&&ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv")).destroy(),typeName===PMSCommon.PA_REVIEW_END&&ZPeopleComponents.isComponent(PMSSetting.paRemPrevCard.sliderDiv.find("#setRemndVl"))&&ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#setRemndVl")).destroy(),ZPeopleComponents.isComponent(PMSSetting.paRemPrevCard.sliderDiv.find("#timeOfExe"))&&ZPeopleComponents.timefield(PMSSetting.paRemPrevCard.sliderDiv.find("#timeOfExe")).destroy();var skillNtfyArr=["SKILLSET_TAG_EMP","SKILLSET_TAG_RM","SKILLSET_UPGRADE_EMP","SKILLSET_UPGRADE_RM"];PMSSetting.paRemPrevCard.sliderDiv.find("#paremprevcardslider").html("");var typeHtm=PMSSetting.paRemTempateType(typeName);PMSSetting.paRemPrevCard.sliderDiv.find("#paremprevcardslider").append($(typeHtm)),ZPeopleComponents.isComponent(PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv"))||(ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv")),PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv").on("zselectchange",PMSSetting.onChangeTemplate));var _editHtm='<div class="zpl_crd"><div class="zpl_crdcnt">';_editHtm+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.from")+'</label></div><div><input type="text" id="fromBox" class="ztextbox" disabled></div></div>',_editHtm+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.to")+'</label></div><div><input type="text" id="toBox" class="ztextbox" disabled></div></div>',_editHtm+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.subject")+'</label></div><div><input type="text" id="subject" class="ztextbox"></div></div>',typeName===PMSCommon.SALARY_HIKE_PUSH_NOTIFY||typeName===PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_SELF_NOTIFY||typeName===PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY||skillNtfyArr.includes(typeName)||(_editHtm+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.workflow.timeofexe")+'</label></div><div><input type="text" id="timeOfExe" class="ztextbox"></div></div>'),_editHtm+="</div></div>",_editHtm+='<div class="zpl_crd" id="parem_message"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.message")+'</h4></div></div><div class="zpl_crdcnt">',_editHtm+='<div class="zpl_secn" style="display: none;"><div><div class="zpl_msgedtr" id="msgEditor"></div></div></div>',_editHtm+='<div class="zpl_secn" style="display: none;"><div style="display: none;" id="msgTemplate" class="zpl_msgedtr"></div></div>',_editHtm+="</div></div>",PMSSetting.paRemPrevCard.sliderDiv.find("#paremprevcardslider").append($(_editHtm)),PMSSetting.paReminderTemplate[typeName]=resp;var isDefaultValue="default_temp";resp.isDefault||(isDefaultValue="custom"),ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv")).setValue(isDefaultValue),typeName===PMSCommon.PA_REVIEW_END&&ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#setRemndVl")).setValue(resp.days),typeName===PMSCommon.SALARY_HIKE_PUSH_NOTIFY||typeName===PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_SELF_NOTIFY||typeName===PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY||skillNtfyArr.includes(typeName)||ZPeopleComponents.timefield("#timeOfExe",{value:Calendar.minstotime(resp.time),minuteStep:"15",clearButton:"none"}),ZPA_FromAddress.fetchAllFromAddress(!1);var fromAddressObj=ZPA_FromAddress.getDefaultFromAddressDtl(),fromAddress=ZPI18N.getString("zp.orgdefaultemail")+"("+fromAddressObj.displayName+"<"+fromAddressObj.fromAddress+">)";PMSSetting.paRemPrevCard.sliderDiv.find("#fromBox").val(fromAddress),PMSSetting.paRemPrevCard.sliderDiv.find("#toBox").val(ZPI18N.getString("zp.local.Appraiser")),typeName==PMSCommon.SALARY_HIKE_PUSH_NOTIFY?PMSSetting.paRemPrevCard.sliderDiv.find("#toBox").val(ZPI18N.getString("zp.appraisee")):typeName==PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_SELF_NOTIFY||typeName==PMSCommon.SKILLSET_TAG_EMP||typeName==PMSCommon.SKILLSET_UPGRADE_EMP?PMSSetting.paRemPrevCard.sliderDiv.find("#toBox").val(ZPI18N.getString("zp.employee")):typeName!=PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY&&typeName!=PMSCommon.SKILLSET_UPGRADE_RM&&typeName!=PMSCommon.SKILLSET_TAG_RM||PMSSetting.paRemPrevCard.sliderDiv.find("#toBox").val(ZPI18N.getString("zp.reportingmanager")),PMSSetting.paRemPrevCard.sliderDiv.find("#subject").val(resp.subject),resp.isDefault?PMSSetting.showDefaultTemplate(typeName):(PMSSetting.paRemPrevCard.sliderDiv.find("#msgEditor").parent().parent().show(),PMSSetting.paRemPrevCard.sliderDiv.find("#msgEditor").show(),ZPA_Editor.initiateEditor(PMSSetting.paReminderTemplateMode,ZPA_Common.getFormId(PMSSetting.paReminderTemplateMode),resp.template,PMSSetting.PA_Editor_Id+PMSSetting.paReminderTemplateMode))})}},showDefaultTemplate:function(typeName){var templateData=PMSSetting.paReminderTemplate[typeName].defaultTemplate;if(PMSSetting.paRemPrevCard.sliderDiv.find("#msgEditor").parent().parent().hide(),$.trim(templateData).length>0){var tempDataViewCont='<div id="viewTempDiv" style="padding:10px; min-height:200px;">'+templateData+"</div>";PMSSetting.paRemPrevCard.sliderDiv.find("#msgTemplate").html(""),PMSSetting.paRemPrevCard.sliderDiv.find("#msgTemplate").parent().show(),PMSSetting.paRemPrevCard.sliderDiv.find("#msgTemplate").append($(tempDataViewCont)).show()}},onChangeTemplate:function(event){event.detail.fromUI&&("default_temp"==event.detail.optionData.value?PMSSetting.showDefaultTemplate(PMSSetting.PA_REVIEWTYPE):(PMSSetting.paRemPrevCard.sliderDiv.find("#msgTemplate").parent().hide(),PMSSetting.paRemPrevCard.sliderDiv.find("#msgEditor").parent().parent().show(),PMSSetting.paRemPrevCard.sliderDiv.find("#msgEditor").show(),ZPA_Editor.initiateEditor(PMSSetting.paReminderTemplateMode,ZPA_Common.getFormId(PMSSetting.paReminderTemplateMode),PMSSetting.paReminderTemplate[PMSSetting.PA_REVIEWTYPE].template,PMSSetting.PA_Editor_Id+PMSSetting.paReminderTemplateMode)))},paRemTempateType:function(type){var _htm='<div class="zpl_crd" id="parem_temtype"><div class="zpl_crdcnt"><div class="zpl_secn"><div><select type="text" id="messageOptDiv" class="ztextbox" value="" style="display: none;">';return _htm+='<option value="custom">'+ZPI18N.getString("zp.ctmtmpl")+"</option>",_htm+='<option value="default_temp">'+ZPI18N.getString("zp.deftmpl")+"</option>",_htm+="</select></div></div>",type===PMSCommon.PA_REVIEW_END&&(_htm+='<div class="zpl_secn"><div>',_htm+="<h4>"+ZPI18N.getString("zp.setreminder")+"</h4>",_htm+='</div><div><select type="text" id="setRemndVl" class="ztextbox" value="" style="display: none;width: 150px;">',_htm+='<option value="0">'+ZPI18N.getString("zp.on")+"</option>",_htm+='<option value="1">'+ZPI18N.getString("zp.onedaybefore",[""])+"</option>",_htm+='<option value="2">'+ZPI18N.getString("zp.twodaybefore",[""])+"</option>",_htm+='<option value="3">'+ZPI18N.getString("zp.threedaybefore",[""])+"</option>",_htm+="</select></div></div>"),_htm+="</div></div>"},showHideEnd:function(){PMSSetting.PA_REVIEWTYPE=PMSCommon.PA_REVIEW_END,PMSSetting.initPARem(PMSCommon.PA_REVIEW_END)},savePaRem:function(){var params={mode:"updatePAReminderTemplate"};let subject=PMSSetting.paRemPrevCard.sliderDiv.find("#subject").val(),isSubjectChanged=!1;if(PMSSetting.paReminderTemplate[PMSSetting.PA_REVIEWTYPE].subject.trim()!=subject){if(""==subject)return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.msgsubjectnotempty"));params.subject=subject,isSubjectChanged=!0}if(PMSSetting.PA_REVIEWTYPE!==PMSCommon.SALARY_HIKE_PUSH_NOTIFY&&PMSSetting.PA_REVIEWTYPE!==PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_SELF_NOTIFY&&PMSSetting.PA_REVIEWTYPE!==PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY&&!["SKILLSET_TAG_EMP","SKILLSET_TAG_RM","SKILLSET_UPGRADE_EMP","SKILLSET_UPGRADE_RM"].includes(PMSSetting.PA_REVIEWTYPE)){var time,startSchTime=ZPeopleComponents.timefield(PMSSetting.paRemPrevCard.sliderDiv.find("#timeOfExe")).getValue().dateString,hrs=(startSchTime=PMSSetting.disTwoDigit(parseInt(startSchTime.split(":")[0]))+":"+startSchTime.split(":")[1]).split(/(\s+)/)[0],ampm=startSchTime.split(/(\s+)/)[2];ampm=void 0!==ampm?ampm.toLowerCase():"",time=Calendar.timetomins(hrs,0,ampm).tottime,PMSSetting.paReminderTemplate[PMSSetting.PA_REVIEWTYPE].time!=time&&""!=time&&(params.time=time,isSubjectChanged=!0)}if(PMSSetting.PA_REVIEWTYPE===PMSCommon.PA_REVIEW_END&&(PMSSetting.paReminderTemplate[PMSSetting.PA_REVIEWTYPE].days!=ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#setRemndVl")).getValue()&&(isSubjectChanged=!0),params.days=ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#setRemndVl")).getValue()),"custom"==ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv")).getValue()){if(params.template=editor.getContent(),"<div><br></div>"===params.template)return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.abstemplateempty"))}else if(PMSSetting.paReminderTemplate[PMSSetting.PA_REVIEWTYPE].isDefault){if(!isSubjectChanged)return void PMSSetting.paRemPrevCard.close()}else params.template="<div>Template</div>",params.isDefault=1;"default_temp"==ZPeopleComponents.select(PMSSetting.paRemPrevCard.sliderDiv.find("#messageOptDiv")).getValue()&&(params.template="<div>Template</div>",params.isDefault=1),params.notificationName=PMSSetting.PA_REVIEWTYPE,ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(respdata){PMSSetting.paReminderTemplate[PMSSetting.PA_REVIEWTYPE]=respdata.data,ZPeople.Message.success(ZPI18N.getString("zp.updatesuccessful")),PMSSetting.paRemPrevCard.close()})},setEmptyNotificationData:function(){var pageId=settingsPage.container;if(0==Object.keys(PMSSetting.reviewSetdefaultObject.notificationOptions).length)for(var notifyName of PMSCommon.getNotificationTypes()){var notCon=pageId.find("#notification_"+notifyName.toLowerCase());pageId.find("#"+notifyName.toLowerCase()).prop("checked",!1),notCon.find("#customise").hide();var end_days=notCon.find("#end_days");PMSSetting.notificationSelect(end_days,"0")}},notificationSelect:function(ele,value){ZPeopleComponents.select(ele,{search:{criteria:"startswith",by:"name"},dropdownList:{contentType:"text"},dataMapping:{value:"id"},value:value,removeExistingDropdown:!0}),ele.on("zselectchange",function(){PMSSetting.dataChanged(PMSCommon.SECTION_NOTIFICATION)instanceof Object?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_NOTIFICATION):PMSSetting.closeResetSave(PMSCommon.SECTION_NOTIFICATION)})},setNotificationData:function(isReset){var pageId=settingsPage.container;for(var notifyName of PMSCommon.getNotificationTypes()){var notCon=pageId.find("#notification_"+notifyName.toLowerCase()),data=PMSSetting.reviewSetdefaultObject.notificationOptions[notifyName],name=data.typeName,enabled=data.isEnabled;if(enabled?pageId.find("#"+notifyName.toLowerCase()).prop("checked",!0):pageId.find("#"+notifyName.toLowerCase()).prop("checked",!1),enabled?notCon.find("#customise").show():notCon.find("#customise").hide(),"REVIEW_END_NOTIFY"==name){var days=data.days,end_days=notCon.find("#end_days");isReset?ZPeopleComponents.select(end_days).setValue(days):PMSSetting.notificationSelect(end_days,days),enabled?notCon.find("#days").show():notCon.find("#days").hide()}}},enableDisableNotification:function(obj){var state=$(obj).is(":checked"),parentFG=$(obj).closest(".cstClsT"),id=parentFG.attr("id");state?parentFG.find("#customise").show():parentFG.find("#customise").hide(),"notification_review_end_notify"==id&&(state?parentFG.find("#days").show():parentFG.find("#days").hide()),PMSSetting.dataChanged(PMSCommon.SECTION_NOTIFICATION)instanceof Object?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_NOTIFICATION):PMSSetting.closeResetSave(PMSCommon.SECTION_NOTIFICATION)},enableDisableEmployeeFeedback:function(obj){var pageId=settingsPage.container,input=pageId.find(obj).parent().next(),optionId=input.attr("optid"),options=[];if(pageId.find(obj).is(":checked"))input.prop("disabled",!1),input.removeClass("is-disabled"),pageId.find("#reviewextndiv select").each(function(index){var attrId=$(this).attr("id");ZPeopleComponents.select(pageId.find("#"+attrId)).removeAllOptions()}),pageId.find("#reviewextndiv select").each(function(index){var attrId=$(this).attr("id");options=PMSSetting.updateFeedbackTypeOption(),ZPeopleComponents.select(pageId.find("#"+attrId)).addOption(options),ZPeopleComponents.select(pageId.find("#"+attrId)).setValue(options[0].value),pageId.find("#"+attrId).parent().parent().find("#noofDays").val(pageId.find("#"+attrId).parent().parent().find("#noofDays").attr("value"))}),options.length>1&&(pageId.find("#addreviewextn").show(),$(pageId.find("#reviewextndiv div[rel=reviewextension]")[0]).find("i.PI_delete").show());else{if(2==pageId.find("#reviewFeedbackType input[name='empFeedbackype']:disabled").length)return pageId.find(obj).prop("checked",!0),void ZPeople.Message.warning(ZPI18N.getString("zp.employeereviewfeedbackerrormsg"));input.addClass("is-disabled"),input.prop("disabled",!0),pageId.find("#reviewextndiv select").length>0&&(pageId.find("#reviewextndiv select").each(function(index){var attrId=$(this).attr("id");ZPeopleComponents.select("#"+attrId).getValue()==optionId&&(ZPeopleComponents.select("#"+attrId).destroy(),pageId.find("#"+attrId).parent().parent().remove())}),0==pageId.find("#reviewextndiv select").length&&ZPeopleComponents.toggleswitch(pageId.find("#configRule")).switchOff(),pageId.find("#reviewextndiv select").each(function(index){var attrId=$(this).attr("id");ZPeopleComponents.select(pageId.find("#"+attrId)).removeAllOptions()}),pageId.find("#reviewextndiv select").each(function(index){var attrId=$(this).attr("id");options=PMSSetting.updateFeedbackTypeOption(),ZPeopleComponents.select(pageId.find("#"+attrId)).addOption(options),ZPeopleComponents.select(pageId.find("#"+attrId)).setValue(options[0].value),pageId.find("#"+attrId).parent().parent().find("#noofDays").val(pageId.find("#"+attrId).parent().parent().find("#noofDays").attr("value"))})),1==options.length&&(pageId.find("#addreviewextn").hide(),$(pageId.find("#reviewextndiv div[rel=reviewextension]")[0]).find("i.PI_delete").hide())}PMSSetting.dataChanged(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION):PMSSetting.closeResetSave(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)},getFeedbackTypeEnabledCount:function(){var feedback_types=PMSSetting.getChangedFeedBackTypes(),cnt=0;return $.each(feedback_types,function(index,data){data.disabled||cnt++}),cnt},checkDuplicateName:function(obj){var optionName=$(obj).val();optionName=optionName.trim();var optionId=$(obj).attr("optId");PMSSetting.duplicateNameErrorMsg(obj,optionName)||($.each(PMSSetting.reviewSetdefaultObject.feedback_types,function(index,data){if(data.optionId!=optionId&&data.optionvalue.toLowerCase()===optionName.toLowerCase())return $(obj).trigger("focus"),void ZPeople.Message.warning(ZPI18N.getString("zp.duplicateName"))}),PMSSetting.dataChanged(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION):PMSSetting.closeResetSave(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION));$(obj).focusout()},getDisabledEmployeeFeedbackNames:function(){var empFeedbackNames=[];return $.each($("#reviewFeedbackType input[name='empFeedbackype']:disabled"),function(index,data){empFeedbackNames.push($(data).attr("optid"))}),empFeedbackNames},constructReviewFeedback:function(feedback_types){var pageId=settingsPage.container,_htm="";$.each(feedback_types,function(index,data){var _cls=data.disabled?"ztextbox w300 is-disabled":"ztextbox w300",is_disabled=data.disabled?"disabled":"",is_checked=data.disabled?"":"checked";_htm+='<div class="zpl_idiv" rel="feedback_types" id="'+data.optionId+'"> <div class="zcheckbox"> <input type="checkbox" id="erf_'+data.optionId+'" class="zcheckbox__helper" '+is_checked+' onclick="PMSSetting.enableDisableEmployeeFeedback(this)"> <label for="erf_'+data.optionId+'" class="zcheckbox__label"></label> </div> <input type="text" class="'+_cls+'"  name="empFeedbackype" optid="'+data.optionId+'"  value="'+data.optionvalue+'" '+is_disabled+' onkeyup="PMSSetting.checkDuplicateName(this);"> </div>'}),pageId.find("#reviewFeedbackType").html(_htm)},getChangedFeedBackTypes:function(){var pageId=settingsPage.container,changedFeedback_types=[],defaultfeedback_types=PMSSetting.reviewSetdefaultObject.feedback_types;return $.each(defaultfeedback_types,function(index,data){var optionObj={};pageId.find("#"+data.optionId).find("input[name=empFeedbackype]").hasClass("is-disabled")?optionObj.disabled=!0:optionObj.disabled=!1,optionObj.optionvalue=pageId.find("#"+data.optionId).find("input[name=empFeedbackype]").val(),optionObj.optionId=data.optionId,changedFeedback_types.push(optionObj)}),changedFeedback_types},getSelectedFeedbackTypes:function(){var pageId=settingsPage.container;let selOptions=[];return pageId.find("#reviewextndiv div[rel=reviewextension]").each(function(data){var selectidelem=pageId.find("#"+$(this).find("select").attr("id")),optionID=ZPeopleComponents.select(selectidelem).getValue();selOptions.push(optionID)}),selOptions},updatehikeSettings:function(elem){var _status="percentage"==$(elem).attr("value")?1:0;if(PMSSetting.dataChanged(PMSCommon.SECTION_SALARY_HIKE)){var param={};param.hikeInput=_status,PMSSetting.saveReviewSettings(PMSCommon.SECTION_SALARY_HIKE,param)}},appraisalCycleReviewSection:ele=>{const isHideSelfChanged=PMSSetting.dataChanged(PMSCommon.SECTION_HIDESELFAPPRAISALREVIEW),isSkipRevChanged=PMSSetting.dataChanged(PMSCommon.SECTION_SKIP_REVIEW),isExNotEmpChanged=PMSSetting.dataChanged(PMSCommon.SECTION_EXCLUDE_NOTICE_EMPLOYEE),isExPrbEmpChanged=PMSSetting.dataChanged(PMSCommon.SECTION_EXCLUDE_PROBATION_EMPLOYEE),iscycleDelRestriction=PMSSetting.dataChanged(PMSCommon.SECTION_CYCLE_DELETE_RESTRICTION),isMailMergeChanged=PMSSetting.dataChanged(PMSCommon.SECTION_MODULESRATING_MAILMERGE),isReviewerMRChanged=PMSSetting.dataChanged(PMSCommon.REVIEWER_RESTRICTION_IN_MR);if("cycleDeleteRestriction"===ele.id){const pageId=settingsPage.container,isChecked=pageId.find("#cycleDeleteRestriction").is(":checked");pageId.find("#cycleDeleteRestictionSelect")[isChecked?"show":"hide"](),pageId.find("#cycleDeleteNotes")[isChecked?"show":"hide"]()}isHideSelfChanged||isSkipRevChanged||isExNotEmpChanged||isExPrbEmpChanged||iscycleDelRestriction||isMailMergeChanged||isReviewerMRChanged?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_APPRAISALCYLE):PMSSetting.closeResetSave(PMSSetting.SECTION_APPRAISALCYLE)},enabledCrBasedCycle:function(event){if(!event.detail.fromUI)return;let pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#crBasedCycleHeader"),ZPI18N.getString("zp.saving"));let params={mode:"pareviewsettings",settingsmode:"updateCRCycleStatus",isCRBasedCycle:event.detail.state,conreqcsr:csrfToken};$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(resultData){"success"==resultData.msg?ZPeople.autosave.success(pageId.find("#crBasedCycleHeader"),ZPI18N.getString("zp.saved")):"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#crBasedCycleHeader"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#crBasedCycleHeader")))}})},delUsrListTokenAddRemove:event=>{PMSSetting.dataChanged(PMSCommon.SECTION_CYCLE_DELETE_RESTRICTION)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_APPRAISALCYLE):PMSSetting.closeResetSave(PMSSetting.SECTION_APPRAISALCYLE)},saveNotificationData:function(){var notificationDataChange=PMSSetting.dataChanged(PMSCommon.SECTION_NOTIFICATION);if(notificationDataChange instanceof Object){var param={};param.notificationOptions=notificationDataChange,PMSSetting.saveReviewSettings(PMSCommon.SECTION_NOTIFICATION,param)}},updateFeedBackType:function(){var pageId=settingsPage.container;if(PMSSetting.dataChanged(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)){var optionTypes=[],acceptanceTypeData=[],disableCount=0,isValid=!0,feedback_types=PMSSetting.getChangedFeedBackTypes();$.each(feedback_types,function(index,data){var optionName=data.optionvalue,optionID=data.optionId,disabled=data.disabled;disabled&&disableCount++;var optionObj=pageId.find("#"+optionID).find("input [name=employeeFeedbackype]");PMSSetting.duplicateNameErrorMsg(optionObj,optionName)&&(isValid=!1),-1!=optionTypes.indexOf(optionName)&&(ZPeople.Message.warning(ZPI18N.getString("zp.duplicateName")),isValid=!1),optionTypes.push(optionName),acceptanceTypeData.push({optionId:optionID,optionvalue:optionName,isDisabled:disabled})}),disableCount>2&&(ZPeople.Message.warning(ZPI18N.getString("zp.employeereviewfeedbackerrormsg")),isValid=!1);var acceptanceRuleData=[],typeTem=[];if(pageId.find("#reviewextndiv div[rel=reviewextension]").each(function(data){var selectidelem=pageId.find("#"+$(this).find("select").attr("id")),optionID=ZPeopleComponents.select(selectidelem).getValue(),noofDays=$(this).find("#noofDays").val().trim(),noofDaysconverted=Number($(this).find("#noofDays").val().trim());if(!isNaN(noofDays)&&""!==noofDays&&noofDaysconverted>=0&&noofDaysconverted<=10)-1==typeTem.indexOf(optionID)?(typeTem.push(optionID),acceptanceRuleData.push({optionID:optionID,noofDays:noofDays})):(isValid=!1,ZPeople.Message.failure(ZPI18N.getString(" zp.employeefeedbkextnerror3")));else{if(""===noofDays)return isValid=!1,void ZPeople.Message.failure(ZPI18N.getString("zp.enternoofday"));if(isNaN(noofDays))return isValid=!1,void ZPeople.Message.failure(ZPI18N.getString("zp.employeefeedbkextnerror2"));if(noofDaysconverted<1||noofDaysconverted>10)return isValid=!1,void ZPeople.Message.failure(ZPI18N.getString("zp.employeefeedbkextnerror1"))}}),isValid){var param={};param.acceptanceTypeData=JSON.stringify(acceptanceTypeData),param.acceptanceRuleData=JSON.stringify(acceptanceRuleData),PMSSetting.saveReviewSettings(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION,param)}}},saveReviewSettings:function(mode,param){var pageId=settingsPage.container,data={mode:"pareviewsettings",conreqcsr:csrfToken},_settingsmode="",_saveicon="";mode==PMSCommon.SECTION_SALARY_HIKE?(data.hikeInput=param.hikeInput,_saveicon="reviewappraisalhike",_settingsmode="updatehikeinput"):mode==PMSSetting.SECTION_CUSTOMFEEDBACKOPTION?(data.acceptanceTypeData=param.acceptanceTypeData,data.acceptanceRuleData=param.acceptanceRuleData,_settingsmode="updateAcceptanceTypeData",_saveicon="empreviewfeedback"):mode==PMSSetting.SECTION_ORDERREVIEW?(data.revieworderlist=param.revieworderlist,_settingsmode="updateRevieworderlist",_saveicon="reviewsectionorder"):mode==PMSCommon.SECTION_MRTYPE?(data.multiraterTypeData=JSON.stringify(param.multiraterTypeData),_settingsmode="updatemultiratertypedata",_saveicon="reviewmultiratertypedata"):mode==PMSSetting.SECTION_APPRAISALCYLE?(_settingsmode="updAppraisalSection",data.skipreviewlvl=pageId.find("#skipreviewlvl").is(":checked")?1:0,data.hideselfappraisalreview=pageId.find("#selfappraisalhide").is(":checked")?1:0,data.excludeNoticEmp=pageId.find("#excludeNoticEmp").is(":checked")?1:0,data.excludeProbEmp=pageId.find("#excludeProbEmp").is(":checked")?1:0,data.isReviewCantRater=pageId.find("#reviewCantRater").is(":checked")?1:0,isSuperAdmin&&pageId.find("#cycleDeleteRestriction").length>0&&PMSSetting.dataChanged(PMSCommon.SECTION_CYCLE_DELETE_RESTRICTION)&&(data.cycleDeleteRestriction=pageId.find("#cycleDeleteRestriction").is(":checked"),data.cycleDeleteRestriction&&(data.cycleDeleteAdminList=JSON.stringify(PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(pageId.find("#cycleDeleteUserList")).getAllValues())))),data.includemodulesRatingMailMerge=pageId.find("#moduleratingMailmerge").is(":checked")?1:0,_saveicon="appraisalcyclehdr"):mode==PMSCommon.SECTION_NOTIFICATION?(_settingsmode="updateNotification",data.notificationOptions=JSON.stringify(param.notificationOptions),_saveicon="paNotificationHeader"):mode==PMSCommon.SECTION_NORMALIZATION?(data.isNorReason=pageId.find("#reasonForNormalization").is(":checked")?1:0,data.isNorMandatory=pageId.find("#reasonMandatoryNorm").is(":checked")?1:0,_settingsmode="normReason",_saveicon="normHeader"):mode==PMSCommon.SECTION_COURSE_DETAILS&&(data.isListCourse=pageId.find("#courseView").is(":checked")?1:0,_settingsmode="courseDetail",_saveicon="pmsCourseHeader"),data.settingsmode=_settingsmode;pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#"+_saveicon),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:data,success:function(resultData){if("success"==resultData.msg){var data=resultData.data;mode==PMSCommon.SECTION_SALARY_HIKE?PMSSetting.reviewSetdefaultObject.hikeInput=data.hikeInput:mode==PMSSetting.SECTION_CUSTOMFEEDBACKOPTION?(PMSSetting.reviewSetdefaultObject.feedback_types=data.acceptanceTypeData,PMSSetting.reviewSetdefaultObject.acceptanceData=data.acceptanceData):mode==PMSSetting.SECTION_ORDERREVIEW?PMSSetting.reviewSetdefaultObject.revieworder=resultData.revieworder:mode==PMSCommon.SECTION_MRTYPE?PMSSetting.reviewSetdefaultObject.multiraterType=resultData.multiraterType:mode==PMSSetting.SECTION_APPRAISALCYLE?(PMSSetting.reviewSetdefaultObject.skipreviewlvl=data.skipreviewlvl,PMSSetting.reviewSetdefaultObject.isHideSelfAppraisalReview=data.isHideSelfAppraisalReview,PMSSetting.reviewSetdefaultObject.excludeNoticEmp=data.excludeNoticEmp,PMSSetting.reviewSetdefaultObject.excludeProbEmp=data.excludeProbEmp,PMSSetting.reviewSetdefaultObject.isCycleDeleteRestrictEnabled=data.cycleDeleteRestriction,PMSSetting.reviewSetdefaultObject.isReviewCantRater=data.isReviewCantRater,isSuperAdmin&&(data.cycleDeleteRestriction?PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUser=data.cycleDeleteRestrictionSelectedUser:(PMSSetting.reviewSetdefaultObject.cycleDeleteRestrictionSelectedUse=[],ZPeopleComponents.tokenfield(pageId.find("#cycleDeleteUserList")).removeAllTokens()))):mode==PMSCommon.SECTION_NOTIFICATION?PMSSetting.reviewSetdefaultObject.notificationOptions=data.notificationOptions:mode==PMSCommon.SECTION_NORMALIZATION?(PMSSetting.reviewSetdefaultObject.isNorReason=data.isNorReason,PMSSetting.reviewSetdefaultObject.isNorMandatory=data.isNorMandatory):mode==PMSCommon.SECTION_COURSE_DETAILS&&(PMSSetting.reviewSetdefaultObject.isListCourse=data.isListCourse),ZPeople.autosave.success(pageId.find("#"+_saveicon),ZPI18N.getString("zp.saved")),PMSSetting.closeResetSave(mode)}else"permission_denied"===resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied")),PMSCommon.autosave.clearelement(pageId.find("#"+_saveicon)),PMSCommon.autosave.enableHdrBtn(pageId.find("#"+_saveicon))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#"+_saveicon)),PMSCommon.autosave.enableHdrBtn(pageId.find("#"+_saveicon)))}})},enableReviewExtn:function(event){var detail=event.detail,pageId=settingsPage.container;detail.state?(0==pageId.find("#reviewextndiv div[rel=reviewextension]").length&&PMSSetting.constructReviewExtn(),pageId.find("#reviewextndiv").show()):(pageId.find("#reviewextndiv").hide(),pageId.find("#reviewextndiv div[rel=reviewextension]").each(function(){ZPeopleComponents.select(pageId.find("#"+$(this).find("select").attr("id"))).destroy()}),pageId.find("#reviewextndiv div[rel=reviewextension]").remove(),PMSSetting.dataChanged(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION):PMSSetting.closeResetSave(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION))},updateFeedbackTypeOption:function(){var options=[],feedback_types=PMSSetting.getChangedFeedBackTypes();let selOptions=PMSSetting.getSelectedFeedbackTypes();return $.each(feedback_types,function(index,data){if(!data.disabled&&-1==selOptions.indexOf(data.optionId)){var obj={};obj.label=data.optionvalue,obj.value=data.optionId,options.push(obj)}}),options},constructReviewExtn:function(selectedValue){var pageId=settingsPage.container,feedback_types=PMSSetting.getChangedFeedBackTypes();if(pageId.find("#reviewextndiv div[rel=reviewextension]").length<feedback_types.length){var selectidcnt=pageId.find("#addreviewextn").prev().find("select").attr("id")?parseInt(pageId.find("#addreviewextn").prev().find("select").attr("id").split("_")[1])+1:1,_htm=PMSSetting.getAcceptanceHtml(selectidcnt,0);$(_htm).insertBefore(pageId.find("#addreviewextn"));var selectElem=pageId.find("#reviewFeedbackOption_"+selectidcnt);ZPeopleComponents.select(selectElem);var options=PMSSetting.updateFeedbackTypeOption();ZPeopleComponents.select(selectElem).addOption(options),ZPeopleComponents.select(selectElem).setValue(options[0].value),$(selectElem).on("zselectchange",PMSSetting.changeReviewExtn),1==options.length?pageId.find("#addreviewextn").hide():pageId.find("#addreviewextn").show(),PMSSetting.dataChanged(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION):PMSSetting.closeResetSave(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)}},getAcceptanceHtml:function(indx,noofDays){var pageId=settingsPage.container,_htm=(noofDays=noofDays||0,'<div class="zpl_idiv" rel="reviewextension"> <div>'+ZPI18N.getString("zp.if")+"</div> <div>");return _htm+='<select id="reviewFeedbackOption_'+indx+'" data-width="140px" style="display: none;"></select> </div> <div>'+ZPI18N.getString("zp.pa.reviewsettings.thenreopenextn")+"</div>",_htm+='<div><input id="noofDays" type="text" value="'+noofDays+'" class="ztextbox"></div> <div>'+ZPI18N.getString("zp.days")+"</div>",pageId.find("#reviewextndiv div[rel=reviewextension]").length>0&&(_htm+='<div><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" ></i></div>'),_htm+="</div>"},changeReviewExtn:function(event){var pageId=settingsPage.container,detail=event.detail,selectedValue=(detail.previousValue,detail.selectedValue),acceptanceData=PMSSetting.reviewSetdefaultObject.acceptanceData;$.each(acceptanceData,function(index,data){if(selectedValue==data.optionID)return data.noofDays,!1}),pageId.find(detail.element).parent().parent().find("input").val("0"),PMSSetting.dataChanged(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION):PMSSetting.closeResetSave(PMSSetting.SECTION_CUSTOMFEEDBACKOPTION)},constructReviewOrder:function(revieworder){var itemsArr=[];for(var index in revieworder){var key=revieworder[index],disname=AppraisalConfig.reviewCustomName;"GOALS"==key?disname=PMSSetting.GOAL_DISPLAY_NAME:"KRA"==key?disname=PMSSetting.KRA_DISPLAY_NAME:"KRA_GOALS"==key?disname=PMSSetting.KRA_DISPLAY_NAME+" vs "+PMSSetting.GOAL_DISPLAY_NAME:"COMPETENCY"==key?disname=PMSSetting.COMPETENCY_DISPLAY_NAME:"QUS_ANS"==key&&(disname=PMSSetting.QUS_ANS_DISPLAY_NAME);var obj={};obj.id=key,obj.name=ZPeople.decodeTxt(disname),itemsArr.push(obj)}PMSSetting.revieworderdefault=itemsArr,PMSSetting.constructReviewOrderListBox()},constructReviewOrderListBox:function(){var pageId=settingsPage.container;ZPeopleComponents.listbox(pageId.find("#reviewordercustom"),{items:PMSSetting.revieworderdefault,dataMapping:{text:"name",value:"id"},contentType:"text-desc",reorderable:!0,multiple:!0,hideCheckbox:!0,width:360}),$(pageId.find("#reviewordercustom")).on("zlistboxdragend",PMSSetting.onrevieworderchange)},updateRevieworder:function(){var pageId=settingsPage.container,reviewlist=new Array;ZPeopleComponents.listbox(pageId.find("#reviewordercustom")).selectAll();var returnedData=ZPeopleComponents.listbox(pageId.find("#reviewordercustom")).getValue();$.each(returnedData,function(key,value){reviewlist.push(value.id)}),ZPeopleComponents.listbox(pageId.find("#reviewordercustom")).deselectAll();var param={};param.revieworderlist=JSON.stringify(reviewlist),PMSSetting.saveReviewSettings(PMSSetting.SECTION_ORDERREVIEW,param)},onrevieworderchange:function(event){""==settingsPage.container.find("#"+PMSSetting.SECTION_ORDERREVIEW+"_SAVERESET").html()&&PMSSetting.getSaveResetBtn(PMSSetting.SECTION_ORDERREVIEW)},resetReviewOrder:function(){var pageId=settingsPage.container;ZPeopleComponents.listbox($(pageId.find("#reviewordercustom"))).refresh()},reportSettingInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!0),$.ajax({type:"POST",async:!1,url:"/performance/view/reportSettings",data:{conreqcsr:csrfToken},success:function(resultData){pageId.find("#exporttxt").length>0&&ZPeopleComponents.tokenfield(pageId.find("#exporttxt")).destroy(),pageId.html(""),pageId.append(resultData),PMSSetting.getPerformanceModules(),$(pageId.find(".togBtn")).ztoggleswitch({size:"medium"}),PMSSetting.fetchReportConfigData()}})}},fetchReportConfigData:function(){$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getSettingsConfig",submode:"getreportconfig",conreqcsr:csrfToken},success:function(resultData){PMSSetting.reportSetdefaultObject=resultData,PMSSetting.setReportData(resultData)}})},setReportData:function(resultData){var pageId=settingsPage.container;resultData.adminonlyexport&&pageId.find("#adminonlyexport").prop("checked",!0),pageId.find("#adminonlyexport").change(function(){PMSSetting.saveAdminOnlyExport()});var exportEmp=pageId.find("#exporttxt");exportEmp.empty();var _tokenObj={},expEmpObj={};if(null!=resultData.exportEmpFiled){var _options=[];$.each(resultData.exportEmpFiled,function(key,value){var _singleObj={};if(_singleObj.name=ZPeople.decodeTxt(value.dName),_singleObj.id=value.compId,null!=resultData.selectedexportEmpFiled){var selectedexportEmpFiled=resultData.selectedexportEmpFiled;if(-1!=selectedexportEmpFiled.indexOf(value.compId)){var index=selectedexportEmpFiled.indexOf(value.compId);expEmpObj[index]=_singleObj}}_options.push(_singleObj)}),_tokenObj.data=_options}if(_tokenObj.contentType="text",_tokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_tokenObj.search={by:"name",highlightKeyword:!0},_tokenObj.allowDuplicateValues=!1,_tokenObj.placeholder=ZPI18N.getString("zp.pa.reportsettings.exportplaceholder"),_tokenObj.values=[],_tokenObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield(exportEmp,_tokenObj),$(exportEmp).on("ztokenfieldtokenadd",PMSSetting.exportEmpAfterTokenAdd),$(exportEmp).on("ztokenfieldtokenremove",PMSSetting.exportEmpAfterTokenAdd),Object.entries(expEmpObj).forEach(([index,value])=>{ZPeopleComponents.tokenfield(exportEmp).addToken(value)}),resultData.skillsetweightagedisabled)pageId.find("#reportninebox").parent().hide();else if(pageId.find("#reportninebox").parent().show(),null!=resultData.perVsPotNames){var perVsPotNames=resultData.perVsPotNames,keys=Object.keys(perVsPotNames);for(var i in keys)pageId.find("#"+keys[i]).val(ZPeople.decodeTxt(perVsPotNames[keys[i]]));pageId.find("#perVsPot").on("blur","input",function(e){PMSSetting.dataChanged(PMSSetting.PERVSPOT_NAMES)?PMSSetting.getSaveResetBtn(PMSSetting.PERVSPOT_NAMES):PMSSetting.closeResetSave(PMSSetting.PERVSPOT_NAMES)})}$("#centerCont").scrollTop(0)},exportEmpAfterTokenAdd:function(event){PMSSetting.dataChanged(PMSSetting.SECTION_EXPORTTXT)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_EXPORTTXT):PMSSetting.closeResetSave(PMSSetting.SECTION_EXPORTTXT)},saveAdminOnlyExport:function(){var pageId=settingsPage.container;if(PMSSetting.dataChanged(PMSCommon.SECTION_EXPORT_PERMISSION)){var param={},_isEnable=pageId.find("#adminonlyexport").is(":checked")?1:0;param.adminonlyexport=_isEnable,PMSSetting.saveReportSettings(PMSCommon.SECTION_EXPORT_PERMISSION,param)}},getMaxLimitForEmployeeFieldExport:function(){return isSanmarUI?15:10},saveExportText:function(){var pageId=settingsPage.container;if(PMSSetting.dataChanged(PMSSetting.SECTION_EXPORTTXT)){var exportTxtRole=pageId.find("#exporttxt"),returnedData=ZPeopleComponents.tokenfield(exportTxtRole).getAllValues(),maxLimit=PMSSetting.getMaxLimitForEmployeeFieldExport();if(!(returnedData.length<=maxLimit))return void ZPeople.Message.failure(ZPI18N.getString("zp.pa.export.field.count.limit.msg",[maxLimit]));var _exportTxt=[];for(var i in returnedData)_exportTxt.push(returnedData[i].id);var param={};param.selectedEmpCompIds=_exportTxt.toString(),PMSSetting.saveReportSettings(PMSSetting.SECTION_EXPORTTXT,param)}},saveEditMatrixBox:function(obj){var compName=$(obj).attr("id"),dispName=$(obj).val().trim();if(dispName.length>100)return ZPeople.Message.warning(ZPI18N.getString("zp.exceedmaxlength")),!1;for(var key in PMSSetting.reportSetdefaultObject.perVsPotNames)if(PMSSetting.reportSetdefaultObject.perVsPotNames[key].toLowerCase()===dispName.toLowerCase()&&key!==compName)return ZPeople.Message.warning(ZPI18N.getString("zp.duplicateName")),!1;dispName!==PMSSetting.reportSetdefaultObject.perVsPotNames[compName]&&$(obj).focusout()},saveNineBoxMatrix:function(){var obj={};settingsPage.container.find("#perVsPot input").each(function(){var compName=$(this).attr("id"),dispName=$(this).val().trim();PMSSetting.reportSetdefaultObject.perVsPotNames[compName].toLowerCase()!=dispName.toLowerCase()&&(obj[compName]=dispName)});var param={};param.perVsPotNames=JSON.stringify(obj),PMSSetting.saveReportSettings(PMSSetting.PERVSPOT_NAMES,param)},saveReportSettings:function(mode,param){var pageId=settingsPage.container,data={mode:"pareportsettings",conreqcsr:csrfToken},_settingsmode="",_saveicon="";mode==PMSSetting.PERVSPOT_NAMES?(data.perVsPotNames=param.perVsPotNames,_settingsmode="updatepervspotnames",_saveicon="reportninebox"):mode==PMSSetting.SECTION_EXPORTTXT?(data.selectedEmpCompIds=param.selectedEmpCompIds,_settingsmode="updateempcompids",_saveicon="reportincludeappraisee"):mode==PMSCommon.SECTION_EXPORT_PERMISSION&&(data.adminonlyexport=param.adminonlyexport,_settingsmode="updateexportpermission",_saveicon="reportexport"),PMSCommon.SECTION_EXPORT_PERMISSION,data.settingsmode=_settingsmode;pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#"+_saveicon),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:data,success:function(resultData){if("success"==resultData.msg){var data=resultData.data;if(mode==PMSSetting.PERVSPOT_NAMES)PMSSetting.reportSetdefaultObject.perVsPotNames=data.perVsPotNames;else if(mode==PMSSetting.SECTION_EXPORTTXT){var selectedEmpCompIds=data.selectedEmpCompIds;PMSSetting.reportSetdefaultObject.selectedexportEmpFiled=""!=selectedEmpCompIds?selectedEmpCompIds.split(","):[]}else mode==PMSCommon.SECTION_EXPORT_PERMISSION&&(PMSSetting.reportSetdefaultObject.adminonlyexport=data.adminonlyexport);ZPeople.autosave.success(pageId.find("#"+_saveicon),ZPI18N.getString("zp.saved")),PMSSetting.closeResetSave(mode)}else"permission_denied"===resultData.msg?(PMSCommon.autosave.clearelement(pageId.find("#"+_saveicon)),PMSCommon.autosave.enableHdrBtn(pageId.find("#"+_saveicon)),ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied"))):(PMSCommon.autosave.clearelement(pageId.find("#"+_saveicon)),PMSCommon.autosave.enableHdrBtn(pageId.find("#"+_saveicon)),ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")))}})},otherSettingInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!0),$.ajax({type:"POST",async:!1,url:"/performance/view/otherSettings",data:{conreqcsr:csrfToken},success:function(resultData){pageId.html(""),pageId.append(resultData),PMSSetting.getPerformanceModules(),PMSSetting.fetchOtherSettingConfigData()}})}},fetchOtherSettingConfigData:function(){$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getSettingsConfig",submode:"getothersettingsconfig",conreqcsr:csrfToken},success:function(resultData){PMSSetting.otherSetDefaultObject=resultData,PMSSetting.setOtherSettingsData(resultData)}})},renameComponents:function(){var pageId=settingsPage.container,obj=PMSSetting.ENABLED_MODULES.KRA,kraCompID=obj.compID,kraCompName=obj.compName;void 0!==obj.displayName&&(PMSSetting.KRA_DISPLAY_NAME=obj.displayName);var html='<div class="zpl_idiv"> <div>'+PMSSetting.COMPONENTS[kraCompName]+'</div> <div><input type="text" class="ztextbox" id="kra_displayname" comp="appraisalComp" module="KRA" componentId="'+kraCompID+'" value="'+PMSSetting.KRA_DISPLAY_NAME+'"></div> </div>',goalCompName=(obj=PMSSetting.ENABLED_MODULES.GOALS).compName,goalCompID=obj.compID;void 0!==obj.displayName&&(PMSSetting.GOAL_DISPLAY_NAME=obj.displayName),html+='<div class="zpl_idiv"> <div>'+PMSSetting.COMPONENTS[goalCompName]+'</div> <div><input type="text" class="ztextbox" id="goals_displayname" comp="appraisalComp" module="GOALS" componentId="'+goalCompID+'" value="'+PMSSetting.GOAL_DISPLAY_NAME+'"></div> </div>';var kraGoalCompName=(obj=PMSSetting.ENABLED_MODULES.KRA_GOALS).compName,kraGoalCompID=obj.compID;void 0!==obj.displayName&&(PMSSetting.KRA_GOAL_DISPLAY_NAME=obj.displayName),html+='<div class="zpl_idiv"> <div>'+PMSSetting.COMPONENTS[kraGoalCompName]+'</div> <div><input type="text" class="ztextbox" id="kra_goals_displayname" comp="appraisalComp" module="KRA_GOALS" componentId="'+kraGoalCompID+'" value="'+PMSSetting.KRA_GOAL_DISPLAY_NAME+'"></div> </div>';var fdbkCompID=(obj=PMSSetting.ENABLED_MODULES.FEEDBACK).compID,fdbkCompName=obj.compName;void 0!==obj.displayName&&(PMSSetting.FEEDBACK_DISPLAY_NAME=obj.displayName),html+='<div class="zpl_idiv"> <div>'+PMSSetting.COMPONENTS[fdbkCompName]+'</div> <div><input type="text" class="ztextbox" id="fdbk_displayname" comp="appraisalComp" module="FEEDBACK" componentId="'+fdbkCompID+'" value="'+PMSSetting.FEEDBACK_DISPLAY_NAME+'"></div> </div>';var ssCompID=(obj=PMSSetting.ENABLED_MODULES.SKILLSET).compID,ssCompName=obj.compName;void 0!==obj.displayName&&(PMSSetting.SKILLSET_DISPLAY_NAME=obj.displayName),html+='<div class="zpl_idiv"> <div>'+PMSSetting.COMPONENTS[ssCompName]+'</div> <div><input type="text" class="ztextbox" id="ss_displayname" comp="appraisalComp" module="SKILSET" componentId="'+ssCompID+'" value="'+PMSSetting.SKILLSET_DISPLAY_NAME+'"></div> </div>';var compCompID=(obj=PMSSetting.ENABLED_MODULES.COMPETENCY).compID,compCompName=obj.compName;void 0!==obj.displayName&&(PMSSetting.COMPETENCY_DISPLAY_NAME=obj.displayName),html+='<div class="zpl_idiv"> <div>'+PMSSetting.COMPONENTS[compCompName]+'</div> <div><input type="text" class="ztextbox" id="comp_displayname" comp="appraisalComp" module="COMPETENCY" componentId="'+compCompID+'" value="'+PMSSetting.COMPETENCY_DISPLAY_NAME+'"></div> </div>';var sumyCompID=(obj=PMSSetting.ENABLED_MODULES.SUMMARY).compID,sumyCompName=obj.compName;void 0!==obj.displayName&&(PMSSetting.SUMMARY_DISPLAY_NAME=obj.displayName),html+='<div class="zpl_idiv"> <div>'+PMSSetting.COMPONENTS[sumyCompName]+'</div> <div><input type="text" class="ztextbox" id="sumy_displayname" comp="appraisalComp" module="SUMMARY" componentId="'+sumyCompID+'" value="'+PMSSetting.SUMMARY_DISPLAY_NAME+'"></div> </div>';var qusCompID=(obj=PMSSetting.ENABLED_MODULES.QUS_ANS).compID,qusCompName=obj.compName;void 0!==obj.displayName&&(PMSSetting.QUS_ANS_DISPLAY_NAME=obj.displayName),html+='<div class="zpl_idiv"> <div>'+PMSSetting.COMPONENTS[qusCompName]+'</div> <div><input type="text" class="ztextbox" id="qus_displayname" comp="appraisalComp" module="QUS_ANS" componentId="'+qusCompID+'" value="'+PMSSetting.QUS_ANS_DISPLAY_NAME+'"></div> </div>',$(pageId.find("#multiRater")).prepend(html)},setOtherSettingsData:function(resultData){var pageId=settingsPage.container;if(PMSSetting.renameComponents(),PMSSetting.IS_MR_ENABLED&&resultData.multiraterName){var multiraterVal=resultData.multiraterName;pageId.find("#multiraterName").val(ZPeople.decodeTxt(multiraterVal)),resultData.multiraterName==ZPI18N.getString("zp.multi")&&(multiraterVal=ZPI18N.getString("zp.multi"))}resultData.tabNames&&pageId.find("#PEERS_VIEW").val(ZPeople.decodeTxt(resultData.tabNames.PEERS_VIEW)),resultData.goalsheetName&&pageId.find("#goalSheetName").val(ZPeople.decodeTxt(resultData.goalsheetName)),resultData.hikeRelatedTerms.HIKE_NAME&&pageId.find("#hikeName").val(ZPeople.decodeTxt(resultData.hikeRelatedTerms.HIKE_NAME)),resultData.hikeRelatedTerms.SALARY_HIKE_NAME&&pageId.find("#salaryhikename").val(ZPeople.decodeTxt(resultData.hikeRelatedTerms.SALARY_HIKE_NAME)),resultData.hikeRelatedTerms.ALLOCATED_HIKE_NAME&&pageId.find("#allocatedhikename").val(ZPeople.decodeTxt(resultData.hikeRelatedTerms.ALLOCATED_HIKE_NAME)),resultData.hikeRelatedTerms.PROPOSED_HIKE_NAME&&pageId.find("#proposedhikename").val(ZPeople.decodeTxt(resultData.hikeRelatedTerms.PROPOSED_HIKE_NAME)),resultData.customSectionName.REVIEW_CUSTOM_SECTION&&pageId.find("#customsecname").val(ZPeople.decodeTxt(resultData.customSectionName.REVIEW_CUSTOM_SECTION)),resultData.reviewQuestionsName&&pageId.find("#reviewQuesName").val(ZPeople.decodeTxt(resultData.reviewQuestionsName)),PMSSetting.goalPriorityOptn=resultData.goalPriorityNameChange,void 0!=PMSSetting.goalPriorityOptn&&0!=PMSSetting.goalPriorityOptn.length&&(PMSSetting.getResetGoalPriorityNames(),pageId.find("#goalPriorityBody").keydown(function(event){let charCode=event.which?event.which:event.keyCode;if(!(8===charCode||9===charCode||37===charCode||39===charCode||32==charCode||charCode>64&&charCode<91||charCode>96&&charCode<123))return!1;PMSSetting.dataChanged(PMSCommon.SECTION_GOALPRIORITY)?PMSSetting.getSaveResetBtn(PMSSetting.SECTION_RENAMETERM):PMSSetting.closeResetSave(PMSSetting.SECTION_RENAMETERM)})),pageId.find("#multiRater").keyup(function(event){var _target=event.target,inputid=$(_target).attr("id");$(_target).removeClass("ztextbox__error");var dataChanged=!1;if(!dataChanged&&PMSSetting.IS_MR_ENABLED&&(dataChanged=PMSSetting.dataChanged(PMSCommon.MULTIRATERNAME)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSCommon.GOALSHEETNAME)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSCommon.HIKE_NAME)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSCommon.SALARY_HIKE_NAME)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSCommon.ALLOCATED_HIKE_NAME)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSCommon.PROPOSED_HIKE_NAME)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSSetting.SECTION_KRA)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSSetting.SECTION_GOALS)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSSetting.SECTION_KRA_GOALS)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSSetting.SECTION_FEEDBACK)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSSetting.SECTION_SKILSET)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSSetting.SECTION_COMPETENCY)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSSetting.SECTION_SUMMARY)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSSetting.SECTION_QUESANS)),dataChanged||(dataChanged=PMSSetting.dataChanged(PMSSetting.SECTION_CUSTOMNAME)),dataChanged){if("multiraterName"==inputid)ZPeople.escapeHtml($(_target).val()).trim();PMSSetting.getSaveResetBtn(PMSSetting.SECTION_RENAMETERM)}else PMSSetting.closeResetSave(PMSSetting.SECTION_RENAMETERM)}),PMSSetting.onChangeForHikeTerm()},multiratertypeactions:function(){var pageId=settingsPage.container;pageId.find("#addmultirtaddbtn").click(function(){if(pageId.find("#addmultiratertypes [rel=typesdiv]").length>4)ZPeople.Message.failure(ZPI18N.getString("zp.mrtypemaxcountmsg",[ZPeople.escapeHtml(PMSSetting.MULTIRATER_DISPLAY_NAME)]));else{var edittxt='<div class="zpl_idiv" rel="typesdiv"><div>'+(pageId.find("#addmultiratertypes [rel=typesdiv]").length+1)+"</div>  <div>";edittxt+='<input type="text" class="ztextbox" value="">',edittxt+='</div><div><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" ></i></div></div>';var _elem=$(edittxt).insertBefore(pageId.find("#addmultirtaddbtn").parent());$(_elem).find(".PI_delete").click(function(){PMSSetting.removeMultiRaterType($(this))}),$(_elem).find("input").bind("keyup blur",function(e){PMSSetting.dataChanged(PMSCommon.SECTION_MRTYPE)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_MRTYPE):PMSSetting.closeResetSave(PMSCommon.SECTION_MRTYPE)}),5==pageId.find("#addmultiratertypes [rel=typesdiv]").length&&pageId.find("#addmultirtaddbtn").parent().hide()}}),pageId.find("#addmultiratertypes .PI_delete").click(function(){PMSSetting.removeMultiRaterType($(this))}),pageId.find("#addmultiratertypes input").bind("keyup blur",function(e){PMSSetting.dataChanged(PMSCommon.SECTION_MRTYPE)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_MRTYPE):PMSSetting.closeResetSave(PMSCommon.SECTION_MRTYPE),event.preventDefault()})},saveMultiRaterType:function(){var pageId=settingsPage.container,mrtypeHtml=pageId.find("#addmultiratertypes div[rel=typesdiv]");mrtypeHtml.find("input").removeClass("ztextbox__error");for(var error=0,i=0;i<mrtypeHtml.length&&0==error;i++){var currval=$(mrtypeHtml[i]).find("input").val().trim();if(""==currval){error=2,$(mrtypeHtml[i]).find("input").addClass("ztextbox__error");break}if(currval.length>255){error=3,$(mrtypeHtml[i]).find("input").addClass("ztextbox__error");break}for(var j=i+1;j<mrtypeHtml.length;j++)if(currval==$(mrtypeHtml[j]).find("input").val().trim()){error=1,$(mrtypeHtml[j]).find("input").addClass("ztextbox__error");break}}if(1==error)ZPeople.Message.failure(ZPI18N.getString("zp.mrtypealreadyexist"));else if(2==error)ZPeople.Message.failure(ZPI18N.getString("zp.entervaildmrtype"));else if(3==error)ZPeople.Message.failure(ZPI18N.getString("zp.mrtypelengthvaildation"));else if(0==error){var isValid=!0,multiraterTypeData={},removeList=new Array,addList=new Array,updateList=new Array,typeids=new Array;if($.each(pageId.find("#addmultiratertypes div[rel=typesdiv]"),function(index,data){var id=$(data).find("input").attr("id");if(void 0!=id){if(PMSSetting.reviewSetdefaultObject.multiraterType[id]!=pageId.find("#addmultiratertypes").find("#"+id).val().trim()){var obj={};obj.optionID=id,obj.typeval=pageId.find("#addmultiratertypes").find("#"+id).val().trim(),updateList.push(obj)}typeids.push(id)}else addList.push($(data).find("input").val())}),$.each(PMSSetting.reviewSetdefaultObject.multiraterType,function(index,data){-1==typeids.indexOf(index)&&removeList.push(index)}),(removeList.length>0||addList.length>0||updateList.length>0)&&((removeList.length>0||addList.length>0)&&(pageId.find("#addmultiratertypes div[rel=typesdiv]").length<1&&(ZPeople.Message.failure(ZPI18N.getString("zp.mrtypemincountmsg")),isValid=!1),pageId.find("#addmultiratertypes div[rel=typesdiv]")>5&&(ZPeople.Message.failure(ZPI18N.getString("zp.mrtypemaxcountmsg",[ZPeople.escapeHtml(PMSSetting.MULTIRATER_DISPLAY_NAME)])),isValid=!1)),removeList.length>0&&(multiraterTypeData.removeList=removeList),addList.length>0&&(multiraterTypeData.addList=addList),updateList.length>0&&(multiraterTypeData.updateList=updateList),isValid)){var param={};param.multiraterTypeData=multiraterTypeData,PMSSetting.saveReviewSettings(PMSCommon.SECTION_MRTYPE,param)}}},removeMultiRaterType:function(obj){var pageId=settingsPage.container;if(1!=pageId.find("#addmultiratertypes [rel=typesdiv]").length){$(obj).parent().parent().remove();var count=1;$.each(pageId.find("#addmultiratertypes .zpl_idiv"),function(index,ele){$(ele).find("div").first().html(count),count++}),pageId.find("#addmultirtaddbtn").parent().show(),PMSSetting.dataChanged(PMSCommon.SECTION_MRTYPE)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_MRTYPE):PMSSetting.closeResetSave(PMSCommon.SECTION_MRTYPE)}else ZPeople.Message.failure(ZPI18N.getString("zp.mrtypemincountmsg"))},constructMultiRaterTypes:function(multiraterType){var edittxt="",count=1;return $.each(multiraterType,function(index,data){edittxt+='<div class="zpl_idiv" rel="typesdiv"><div> '+count+"</div>  <div>",edittxt+='<input type="text" class="ztextbox"  id="'+index+'" value="'+data+'">',edittxt+='</div><div><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" ></i></div></div>',count++}),edittxt+='<div class="zpl_idiv" style="display: none;"><a id="addmultirtaddbtn" class="zpl_lnkbg">'+ZPI18N.getString("zp.addmultiratertypes")+"</a></div>"},saveRenameTerminal:function(){var pageId=settingsPage.container;_obj={};var hikeTerms={},tabName={},moduleNames=[],priority={},isFlag=!1;if($(pageId).find("#pmsettingsdiv #multiRater input").removeClass("ztextbox__error"),$(pageId).find("#pmsettingsdiv #goalPriorityBody input").removeClass("ztextbox__error"),PMSSetting.dataChanged(PMSCommon.MULTIRATERNAME)){var obj=pageId.find("#multiraterName");PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim())?(pageId.find("#multiraterName").trigger("focus"),isFlag=!0):_obj.multiraterName=pageId.find("#multiraterName").val().trim()}if(PMSSetting.dataChanged(PMSCommon.GOALSHEETNAME)){obj=pageId.find("#goalSheetName");PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim())?(pageId.find("#goalSheetName").trigger("focus"),isFlag=!0):_obj.goalSheetName=pageId.find("#goalSheetName").val().trim()}if(PMSSetting.dataChanged(PMSCommon.HIKE_NAME)){obj=pageId.find("#hikeName");PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim())?(pageId.find("#hikeName").trigger("focus"),isFlag=!0):hikeTerms.hikeName=pageId.find("#hikeName").val().trim()}if(PMSSetting.dataChanged(PMSCommon.SALARY_HIKE_NAME)){obj=pageId.find("#salaryhikename");PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim())?(pageId.find("#salaryhikename").trigger("focus"),isFlag=!0):hikeTerms.salaryhikename=pageId.find("#salaryhikename").val().trim()}if(PMSSetting.dataChanged(PMSCommon.ALLOCATED_HIKE_NAME)){obj=pageId.find("#allocatedhikename");PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim())?(pageId.find("#allocatedhikename").trigger("focus"),isFlag=!0):hikeTerms.allocatedhikename=pageId.find("#allocatedhikename").val().trim()}if(PMSSetting.dataChanged(PMSCommon.PROPOSED_HIKE_NAME)){obj=pageId.find("#proposedhikename");PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim())?(pageId.find("#proposedhikename").trigger("focus"),isFlag=!0):hikeTerms.proposedhikename=pageId.find("#proposedhikename").val().trim()}if(PMSSetting.dataChanged(PMSSetting.SECTION_CUSTOMNAME)){obj=pageId.find("#customsecname");PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim())?(pageId.find("#customsecname").trigger("focus"),isFlag=!0):_obj.reviewCustomName=pageId.find("#customsecname").val().trim()}if(PMSSetting.dataChanged(PMSSetting.SECTION_KRA)){obj=pageId.find("#kra_displayname");if(PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim(),!0))pageId.find("#kra_displayname").trigger("focus"),isFlag=!0;else(tempObj={}).appcompid=pageId.find("#kra_displayname").attr("componentid"),tempObj.dispname=pageId.find("#kra_displayname").val().trim(),tempObj.formData=!0,moduleNames.push(tempObj)}if(PMSSetting.dataChanged(PMSSetting.SECTION_GOALS)){obj=pageId.find("#goals_displayname");if(PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim(),!0))pageId.find("#goals_displayname").trigger("focus"),isFlag=!0;else(tempObj={}).appcompid=pageId.find("#goals_displayname").attr("componentid"),tempObj.dispname=pageId.find("#goals_displayname").val().trim(),tempObj.formData=!0,moduleNames.push(tempObj)}if(PMSSetting.dataChanged(PMSSetting.SECTION_KRA_GOALS)){obj=pageId.find("#kra_goals_displayname");if(PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim(),!0))pageId.find("#kra_goals_displayname").trigger("focus"),isFlag=!0;else(tempObj={}).appcompid=pageId.find("#kra_goals_displayname").attr("componentid"),tempObj.dispname=pageId.find("#kra_goals_displayname").val().trim(),tempObj.formData=!1,moduleNames.push(tempObj)}if(PMSSetting.dataChanged(PMSSetting.SECTION_FEEDBACK)){obj=pageId.find("#fdbk_displayname");if(PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim(),!0))pageId.find("#fdbk_displayname").trigger("focus"),isFlag=!0;else(tempObj={}).appcompid=pageId.find("#fdbk_displayname").attr("componentid"),tempObj.dispname=pageId.find("#fdbk_displayname").val().trim(),tempObj.formData=!1,moduleNames.push(tempObj)}if(PMSSetting.dataChanged(PMSSetting.SECTION_SKILSET)){obj=pageId.find("#ss_displayname");if(PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim(),!0))pageId.find("#ss_displayname").trigger("focus"),isFlag=!0;else(tempObj={}).appcompid=pageId.find("#ss_displayname").attr("componentid"),tempObj.dispname=pageId.find("#ss_displayname").val().trim(),tempObj.formData=!1,moduleNames.push(tempObj)}if(PMSSetting.dataChanged(PMSSetting.SECTION_COMPETENCY)){obj=pageId.find("#comp_displayname");if(PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim(),!0))pageId.find("#comp_displayname").trigger("focus"),isFlag=!0;else(tempObj={}).appcompid=pageId.find("#comp_displayname").attr("componentid"),tempObj.dispname=pageId.find("#comp_displayname").val().trim(),tempObj.formData=!1,moduleNames.push(tempObj)}if(PMSSetting.dataChanged(PMSSetting.SECTION_SUMMARY)){obj=pageId.find("#sumy_displayname");if(PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim(),!0))pageId.find("#sumy_displayname").trigger("focus"),isFlag=!0;else(tempObj={}).appcompid=pageId.find("#sumy_displayname").attr("componentid"),tempObj.dispname=pageId.find("#sumy_displayname").val().trim(),tempObj.formData=!1,moduleNames.push(tempObj)}if(PMSSetting.dataChanged(PMSSetting.SECTION_QUESANS)){var tempObj;obj=pageId.find("#qus_displayname");if(PMSSetting.duplicateNameErrorMsg(obj,obj.val().trim(),!0))pageId.find("#qus_displayname").trigger("focus"),isFlag=!0;else(tempObj={}).appcompid=pageId.find("#qus_displayname").attr("componentid"),tempObj.dispname=pageId.find("#qus_displayname").val().trim(),tempObj.formData=!1,moduleNames.push(tempObj)}if(PMSSetting.dataChanged(PMSCommon.SECTION_GOALPRIORITY)){var params=PMSSetting.validateGoalPeriority();0==Object.keys(params).length?isFlag=!0:void 0!=params.lenerror?(pageId.find("#"+params.lenerror).addClass("ztextbox__error"),isFlag=!0):priority=params}isFlag||(moduleNames.length>0&&(_obj.moduleNames=moduleNames),Object.keys(hikeTerms).length>0&&(_obj.hikeTerms=hikeTerms),Object.keys(priority).length>0&&(_obj.priority=priority),Object.keys(tabName).length>0&&(_obj.tabName=tabName),PMSSetting.saveOtherSettings("updateRenameData",_obj))},saveOtherSettings:function(settingsmode,param){var data={mode:"paothersettings",conreqcsr:csrfToken};data.settingsmode=settingsmode,"updateRenameData"==settingsmode&&(param.hikeTerms&&(data.hikeTerms=JSON.stringify(param.hikeTerms)),param.goalSheetName&&(data.goalSheetName=param.goalSheetName),param.multiraterName&&(data.multiraterName=param.multiraterName),param.reviewCustomName&&(data.reviewCustomName=param.reviewCustomName),param.tabName&&(data.tabName=JSON.stringify(param.tabName)),param.priority&&(data.priorityNames=JSON.stringify(param.priority)),param.moduleNames&&(data.moduleNames=JSON.stringify(param.moduleNames)));var pageId=settingsPage.container;ZPeople.autosave.loading(pageId.find("#renamecard"),ZPI18N.getString("zp.saving")),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:data,success:function(resultData){if("success"==resultData.msg){var data=resultData.data;"updateRenameData"==settingsmode&&(data.multiraterName&&(PMSSetting.otherSetDefaultObject.multiraterName=data.multiraterName),data.hikeTerms&&(PMSSetting.otherSetDefaultObject.hikeTerms=data.hikeTerms),data.goalsheetName&&(PMSSetting.otherSetDefaultObject.goalsheetName=data.goalsheetName),data.tabNames&&(PMSSetting.otherSetDefaultObject.tabNames=data.tabNames),param.priority&&(PMSSetting.goalPriorityOptn=param.priority),PMSSetting.closeResetSave(PMSSetting.SECTION_RENAMETERM),ZPeople.autosave.success(pageId.find("#renamecard"),ZPI18N.getString("zp.saved")),PMSSetting.getPerformanceModules(!0))}else"dublicate_val"==resultData.mRTypeShowmsg?(ZPeople.Message.failure(ZPI18N.getString("zp.mrtypealreadyexist")),PMSCommon.autosave.clearelement(pageId.find("#renamecard")),PMSCommon.autosave.enableHdrBtn(pageId.find("#renamecard"))):"minValidation"==resultData.mRTypeShowmsg?(ZPeople.Message.failure(ZPI18N.getString("zp.mrtypemincountmsg")),PMSCommon.autosave.clearelement(pageId.find("#renamecard")),PMSCommon.autosave.enableHdrBtn(pageId.find("#renamecard"))):"maxValidation"==resultData.mRTypeShowmsg?(ZPeople.Message.failure(ZPI18N.getString("zp.mrtypemaxcountmsg",[ZPeople.escapeHtml(PMSSetting.MULTIRATER_DISPLAY_NAME)])),PMSCommon.autosave.clearelement(pageId.find("#renamecard")),PMSCommon.autosave.enableHdrBtn(pageId.find("#renamecard"))):"duplicateVal"==resultData.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.goalPriError")),PMSCommon.autosave.clearelement(pageId.find("#renamecard")),PMSCommon.autosave.enableHdrBtn(pageId.find("#renamecard"))):(ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),PMSCommon.autosave.clearelement(pageId.find("#renamecard")),PMSCommon.autosave.enableHdrBtn(pageId.find("#renamecard")))}})},onChangeForHikeTerm:function(){var pageId=settingsPage.container;pageId.find("#hikeName").on("change",function(){PMSSetting.constructFieldsForOtherHikeTerms(pageId.find("#hikeName").val())})},constructFieldsForOtherHikeTerms:function(changedName){var pageId=settingsPage.container,fieldLookup={salaryhikename:ZPI18N.getString("zp.budget",[changedName]),allocatedhikename:ZPI18N.getString("zp.budgetedIncrement",[changedName]),proposedhikename:ZPI18N.getString("zp.recomendedIncrement",[changedName])};$.each(fieldLookup,function(index,val){pageId.find("#"+index).val(val)})},continuousReviewInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!0),null===PMSSetting.ON_LOAD_CR_SET_PAGE&&$.ajax({type:"POST",async:!1,url:"/performance/view/continuousReview",data:{conreqcsr:csrfToken},success:function(resultData){PMSSetting.ON_LOAD_CR_SET_PAGE=resultData}}),PMSSetting.CFSSelectDestroy(),pageId.html(""),pageId.append(PMSSetting.ON_LOAD_CR_SET_PAGE),pageId.find("#nonAppliDiv").html(PMSSetting.ADD_EXCEP_BT),PMSSetting.getSelPerformanceModules(!0),PMSSetting.fetchCfsEmpLookupData();ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"getCFS"},PMSSetting.defaultAction)}},refreshKeySelect:function(eData){var pageId=settingsPage.container;let alreadySelKey=[];var gId="";"#settings-service-performance-goal"===settingsPage.tabId&&(gId="goal_"),pageId.find("#"+gId+"condtInnerDiv .addCondtTemp").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");alreadySelKey.push(val)});let selOpt=$(eData.element[0]),selOptKey=selOpt.attr("keySel"),options=[],cnt=0,fstKey="",APPLI_KEYS_OBJ=PMSSetting.CR_APPLI_KEYS_OBJ;PMSSetting.isCRConfigurationPage()&&(PMSSetting.CR_NON_APPLI_LST.push("APPL_EMP_TYPE"),APPLI_KEYS_OBJ=PMSSetting.CFS_APPLI_KEYS_OBJ),$.each(APPLI_KEYS_OBJ,function(key,value){if(-1===alreadySelKey.indexOf(key)||key===selOptKey){0===cnt&&(fstKey=key);var obj={};obj.label=value,obj.value=key,options.push(obj),cnt+=1}}),selOpt.attr("keySel",fstKey),ZPeopleComponents.select(selOpt).removeAllOptions(),ZPeopleComponents.select(selOpt).addOption(options),ZPeopleComponents.select(selOpt).setValue([fstKey])},initiateSelValData:function(keySel,selOpt){selOpt.empty(),"APPL_LOC"===keySel?$.each(PMSSetting.ALL_LOCATIONS,function(key,value){selOpt.append(jQuery("<option />",{value:value.locationId,id:value.locationId}).text(ZPeople.decodeTxt(value.locationName)))}):"APPL_ROLE"===keySel?$.each(PMSSetting.ALL_ROLES,function(key,value){selOpt.append(jQuery("<option />",{value:value.roleId,id:value.roleId}).text(ZPeople.decodeTxt(value.roleName)))}):"APPL_DEP"===keySel?$.each(PMSSetting.ALL_DEPARTMENTS,function(key,value){selOpt.append(jQuery("<option />",{value:value.departmentId,id:value.departmentId}).text(ZPeople.decodeTxt(value.departmentName)))}):"APPL_DES"===keySel?$.each(PMSSetting.ALL_DESIGNATION,function(key,value){selOpt.append(jQuery("<option />",{value:value.desId,id:value.desId}).text(ZPeople.decodeTxt(value.desName)))}):"APPL_EMP_TYPE"===keySel&&$.each(PMSSetting.ALL_EMPLOYEE_TYPES,function(key,value){selOpt.append(jQuery("<option />",{value:value.typeId,id:value.typeId}).text(ZPeople.decodeTxt(value.typeName)))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:settingsPage.container,fitForElement:!0}}),ZPeopleComponents.select(selOpt).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder(keySel)}),PMSSetting.updateNonAppliArray()},updateNonAppliArray:function(){var pageId=settingsPage.container,gId="";"#settings-service-performance-goal"===settingsPage.tabId&&(gId="goal_"),PMSSetting.CR_NON_APPLI_LST=["APPL_DEP","APPL_DES","APPL_LOC","APPL_ROLE"];let APPLI_KEYS_OBJ=PMSSetting.CR_APPLI_KEYS_OBJ;PMSSetting.isCRConfigurationPage()&&(PMSSetting.CR_NON_APPLI_LST.push("APPL_EMP_TYPE"),APPLI_KEYS_OBJ=PMSSetting.CFS_APPLI_KEYS_OBJ);let alreadySelKey=[];pageId.find("#"+gId+"condtInnerDiv .addCondtTemp").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");alreadySelKey.push(val)}),$.each(APPLI_KEYS_OBJ,function(key,value){if(-1!==alreadySelKey.indexOf(key)){let idxT=PMSSetting.CR_NON_APPLI_LST.indexOf(key);-1!==idxT&&PMSSetting.CR_NON_APPLI_LST.splice(idxT,1)}})},addApplicable:function(){var pageId=settingsPage.container,tabId=settingsPage.tabId,gId="";let APPLI_KEYS_OBJ=PMSSetting.CR_APPLI_KEYS_OBJ,maxApplCnt=3;PMSSetting.isCRConfigurationPage()&&(APPLI_KEYS_OBJ=PMSSetting.CFS_APPLI_KEYS_OBJ,maxApplCnt=4),"#settings-service-performance-goal"===tabId&&(gId="goal_"),PMSSetting.loadApplicableData();let idx="1",alreadySelKey=[];pageId.find("#"+gId+"condtInnerDiv .addCondtTemp").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");alreadySelKey.push(val)});var existingCondt=pageId.find("#"+gId+"condtInnerDiv .addCondtTemp").length;existingCondt>0?idx=parseInt($(pageId.find("#"+gId+"condtInnerDiv .addCondtTemp")[existingCondt-1]).attr("series"))+1:pageId.find("#"+gId+"allEmpAppliID").remove();let row='<div class="zpl_idiv addCondtTemp" series="'+idx+'"><select id="'+gId+"crAppliKey_"+idx+'" type="keyFld" class="select-js" style="display: none;"></select><span>is</span><select id="'+gId+"crAppliVal_"+idx+'" type="valFld" data-show-search-field="true" multiple="true" class="select-js" style="display: none;"></select><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSSetting.removeAppliCondtRow(this);"></i></div>';pageId.find("#"+gId+"addCondDiv").before(row),alreadySelKey.length>=maxApplCnt?pageId.find("#"+gId+"addCondDiv").hide():pageId.find("#"+gId+"addCondDiv").show();var selOpt=pageId.find("#"+gId+"crAppliKey_"+idx);selOpt.empty();let fstKey="",cnt=0;$.each(APPLI_KEYS_OBJ,function(k,v){-1===alreadySelKey.indexOf(k)&&(0===cnt&&(fstKey=k),selOpt.append(jQuery("<option />",{value:k,id:k}).html(v)),cnt+=1)}),selOpt.attr("keySel",fstKey),PMSSetting.updateNonAppliArray(),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),selOpt.on("zselectchange",function(event,edata){PMSSetting.onCRAppliKeyChange(edata)}),selOpt.on("zselectbeforedropdownlistopen",function(event,eData){PMSSetting.refreshKeySelect(eData)});var valSel=pageId.find("#"+gId+"crAppliVal_"+idx);PMSSetting.initiateSelValData(fstKey,valSel);let nonApplRw=pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").find("[keySel="+fstKey+"]");void 0!==nonApplRw&&nonApplRw.length>0&&PMSSetting.removeNonAppliCondtRow($(nonApplRw)),PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALPERIOD_SETTINGS)},removeAppliCondtRow:function(obj){var pageId=settingsPage.container;let div=$(obj).parent("div");var existingCondt,gId="";"#settings-service-performance-goal"===settingsPage.tabId&&(gId="goal_"),ZPeopleComponents.select(div.find("select[type=keyFld]")).destroy(),ZPeopleComponents.select(div.find("select[type=valFld]")).destroy(),div.remove(),PMSSetting.updateNonAppliArray(),pageId.find("#"+gId+"addCondDiv").show(),0===(existingCondt=pageId.find("#"+gId+"condtInnerDiv .addCondtTemp").length)&&pageId.find("#"+gId+"addCondDiv").before('<div class="zpl_idiv" id="'+gId+'allEmpAppliID"><span>'+ZPI18N.getString("zp.applforallusers")+"</span></div>"),(existingCondt=pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").length)>0&&existingCondt>=PMSSetting.CR_NON_APPLI_LST.length?pageId.find("#"+gId+"addNonCondtDiv").hide():pageId.find("#"+gId+"addNonCondtDiv").show(),PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALPERIOD_SETTINGS)},appliKeyOption:function(){var options=[];let keys=PMSSetting.CR_APPLI_KEYS_OBJ;return PMSSetting.isCRConfigurationPage()&&(keys=PMSSetting.CFS_APPLI_KEYS_OBJ),$.each(keys,function(index,data){var obj={};obj.label=data,obj.value=index,options.push(obj)}),options},loadApplicableData:function(){null!=PMSSetting.ALL_DESIGNATION&&null!=PMSSetting.ALL_DEPARTMENTS&&null!=PMSSetting.ALL_LOCATIONS&&null!=PMSSetting.ALL_EMPLOYEE_TYPES||$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getroles_designation",conreqcsr:csrfToken},success:function(data){PMSSetting.ALL_DESIGNATION=data.designations,PMSSetting.ALL_DEPARTMENTS=data.departmentList,PMSSetting.ALL_LOCATIONS=data.locationList,PMSSetting.ALL_ROLES=data.roleList,PMSSetting.ALL_EMPLOYEE_TYPES=data.employeeTypeList}})},onCRAppliKeyChange:function(eData,selectedFieldValues){if(eData&&(""===eData.selectedValue||eData.previousValue==eData.selectedValue))return;let selField=eData.selectedValue;var selOpt=$(eData.element[0]).parent("div").find("select[type=valFld");PMSSetting.updateSelValData(selField,selOpt)},updateSelValData:function(keySel,selOpt){var gId="";"#settings-service-performance-goal"===settingsPage.tabId&&(gId="goal_"),ZPeopleComponents.select(selOpt).destroy(),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:settingsPage.container,fitForElement:!0}}).removeAllOptions();var options=[];if("APPL_LOC"===keySel?$.each(PMSSetting.ALL_LOCATIONS,function(index,data){var obj={};obj.label=ZPeople.decodeTxt(data.locationName),obj.value=data.locationId,options.push(obj)}):"APPL_ROLE"===keySel?$.each(PMSSetting.ALL_ROLES,function(index,data){var obj={};obj.label=ZPeople.decodeTxt(data.roleName),obj.value=data.roleId,options.push(obj)}):"APPL_DEP"===keySel?$.each(PMSSetting.ALL_DEPARTMENTS,function(index,data){var obj={};obj.label=ZPeople.decodeTxt(data.departmentName),obj.value=data.departmentId,options.push(obj)}):"APPL_DES"===keySel?$.each(PMSSetting.ALL_DESIGNATION,function(index,data){var obj={};obj.label=ZPeople.decodeTxt(data.desName),obj.value=data.desId,options.push(obj)}):"APPL_EMP_TYPE"===keySel&&$.each(PMSSetting.ALL_EMPLOYEE_TYPES,function(index,data){var obj={};obj.label=ZPeople.decodeTxt(data.typeName),obj.value=data.typeId,options.push(obj)}),ZPeopleComponents.select(selOpt).addOption(options),ZPeopleComponents.select(selOpt).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder(keySel)}),$(selOpt).parent("div").find("select[type=keyFld]").attr("keySel",keySel),PMSSetting.updateNonAppliArray(),-1===$(selOpt).attr("id").indexOf("crNonAppli")){let nonApplRw=settingsPage.container.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").find("[keySel="+keySel+"]");void 0!==nonApplRw&&nonApplRw.length>0&&PMSSetting.removeNonAppliCondtRow($(nonApplRw))}},addNonApplicable:function(){var pageId=settingsPage.container;PMSSetting.loadApplicableData(),PMSSetting.updateNonAppliArray();var gId="";"#settings-service-performance-goal"===settingsPage.tabId&&(gId="goal_");let idx="1",alreadySelKey=[];if(pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");alreadySelKey.push(val)}),PMSSetting.CR_NON_APPLI_LST.length<=0)return void ZPeople.Message.warning("All applicable options are selected");if(0===alreadySelKey.length){pageId.find("#"+gId+"nonAppliDiv").empty();let nonApplHtml='<div class="zpl_cndor"><div class="zpl_gbox" id="'+gId+'nonCondtInnerDiv"><div class="zpl_idiv" id="'+gId+'addNonCondtDiv"><a class="zpl_lnkbg" onclick="PMSSetting.addNonApplicable();">'+ZPI18N.getString("zp.addcriteria")+"</a></div></div></div>";pageId.find("#"+gId+"nonAppliDiv").html(nonApplHtml)}var existingCondt=pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").length;existingCondt>0&&(idx=parseInt($(pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp")[existingCondt-1]).attr("series"))+1);let row='<div class="zpl_idiv addNonCondtTemp" series="'+idx+'"><select id="'+gId+"crNonAppliKey_"+idx+'" type="keyFld" class="select-js" style="display: none;"></select><span>is</span><select id="'+gId+"crNonAppliVal_"+idx+'" type="valFld" data-show-search-field="true" multiple="true" class="select-js" style="display: none;"></select><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSSetting.removeNonAppliCondtRow(this);"></i></div>';pageId.find("#"+gId+"addNonCondtDiv").before(row),alreadySelKey.length>=PMSSetting.CR_NON_APPLI_LST.length-1?pageId.find("#"+gId+"addNonCondtDiv").hide():pageId.find("#"+gId+"addNonCondtDiv").show();var selOpt=pageId.find("#"+gId+"crNonAppliKey_"+idx);selOpt.empty();let fstKey="",cnt=0,APPLI_KEYS_OBJ=PMSSetting.CR_APPLI_KEYS_OBJ;PMSSetting.isCRConfigurationPage()&&(APPLI_KEYS_OBJ=PMSSetting.CFS_APPLI_KEYS_OBJ),$.each(APPLI_KEYS_OBJ,function(k,v){-1!==PMSSetting.CR_NON_APPLI_LST.indexOf(k)&&-1===alreadySelKey.indexOf(k)&&(0===cnt&&(fstKey=k),selOpt.append(jQuery("<option />",{value:k,id:k}).html(v)),cnt+=1)}),selOpt.attr("keySel",fstKey),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),selOpt.on("zselectchange",function(event,edata){PMSSetting.onCRAppliKeyChange(edata)}),selOpt.on("zselectbeforedropdownlistopen",function(event,eData){PMSSetting.refreshNonApplKeySelect(eData)});var valSel=pageId.find("#"+gId+"crNonAppliVal_"+idx);PMSSetting.initiateSelValData(fstKey,valSel),PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALPERIOD_SETTINGS)},refreshNonApplKeySelect:function(eData){var pageId=settingsPage.container,gId="";"#settings-service-performance-goal"===settingsPage.tabId&&(gId="goal_");let alreadySelKey=[];pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");alreadySelKey.push(val)});let selOpt=$(eData.element[0]),selOptKey=selOpt.attr("keySel"),options=[],cnt=0,fstKey="",APPLI_KEYS_OBJ=PMSSetting.CR_APPLI_KEYS_OBJ;PMSSetting.isCRConfigurationPage()&&(APPLI_KEYS_OBJ=PMSSetting.CFS_APPLI_KEYS_OBJ),$.each(APPLI_KEYS_OBJ,function(key,value){if(-1!==PMSSetting.CR_NON_APPLI_LST.indexOf(key)&&(-1===alreadySelKey.indexOf(key)||key===selOptKey)){0===cnt&&(fstKey=key);var obj={};obj.label=value,obj.value=key,options.push(obj),cnt+=1}}),selOpt.attr("keySel",fstKey),ZPeopleComponents.select(selOpt).removeAllOptions(),ZPeopleComponents.select(selOpt).addOption(options),ZPeopleComponents.select(selOpt).setValue([fstKey])},removeNonAppliCondtRow:function(obj){var pageId=settingsPage.container,gId="";"#settings-service-performance-goal"===settingsPage.tabId&&(gId="goal_");let div=$(obj).parent("div");div.find("select[type=keyFld]").attr("keySel");ZPeopleComponents.select(div.find("select[type=keyFld]")).destroy(),ZPeopleComponents.select(div.find("select[type=valFld]")).destroy(),div.remove(),PMSSetting.updateNonAppliArray();var existingCondt=pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").length;existingCondt>=PMSSetting.CR_NON_APPLI_LST.length?pageId.find("#"+gId+"addNonCondtDiv").hide():pageId.find("#"+gId+"addNonCondtDiv").show(),0===existingCondt&&pageId.find("#"+gId+"nonAppliDiv").html(PMSSetting.ADD_EXCEP_BT),PMSSetting.getSaveResetBtn(PMSSetting.SECTION_GOALPERIOD_SETTINGS)},isCFSSettingPage:function(){return"settings-service-performance-continuousreview"===settingsPage.container.attr("id")},fetchCfsEmpLookupData:function(){if(null===PMSSetting.CFS_EMP_LKUP){var params={mode:"fetchEmpLookup",submode:PMSCommon.CFS_LKUP};ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){PMSSetting.CFS_EMP_LKUP=resultData.emplookup})}},beforeDelete:function(event){if(event.detail.fromUI){var pageId=settingsPage.container,isEnable=event.detail.state;if(isEnable)PMSSetting.enableDisableCRComponents(!1),pageId.find("#cfsMainDiv").show(),ZPeopleComponents.toggleswitch(pageId.find("#saEnable")).setAttributes({disabled:!1}),PMSSetting.getSaveResetBtn(PMSSetting.CONTINUOUS_REVIEW),PMSSetting.CFS_DATA.cfsDetail.cfsNoData?(pageId.find("#crRating").prop("checked",!0),PMSSetting.isCRRatingEnabled()):PMSSetting.updateCRRtgEvalMethodsChange();else{if(!isEnable&&!PMSSetting.CFS_DATA.cfsDetail.cfsEnable)return void PMSSetting.CFSReset();PMSSetting.saveContinuousReview(!0,!1,!0)}}},isCRConfigurationPage:function(){return"#settings-service-performance-continuousreview"===settingsPage.tabId},defaultAction:function(data){var pageId=settingsPage.container;PMSSetting.CFS_DATA=data,PMSSetting.POPULATE_PAST_DATE_FLAG=data.isEmptyData;var cfsDetail=PMSSetting.CFS_DATA.cfsDetail,nxtPopSetDt=PMSSetting.CFS_DATA.nextSetStDt,isEnable=cfsDetail.cfsEnable,cfsNoData=cfsDetail.cfsNoData,evalutionFields=PMSSetting.constructEvalutionOption(isEnable),isCRCompEnable=evalutionFields.length>0;if(isCRCompEnable)pageId.find("#cfs_alert").remove();else{var cfs_alert='<div class="redbglit zpl_info MB20" id="cfs_alert" style="max-width: 1020px;">';cfs_alert+='<span class="d-flexM"><p class="">'+ZPI18N.getString("zp.goalsdisabled")+' <a target="_blank" href="#settings/service/performance/generalsettings" class="u-link zpl_link">'+ZPI18N.getString("zp.clicktoEnable")+"&nbsp;</a></p></span></div>",pageId.find("#cfs_alert").remove(),$(cfs_alert).insertBefore(pageId.find("#crrunningbnrdiv"))}pageId.find("#cfsdeletebtn").hide(),pageId.find("#crHeaderID").html(ZPI18N.getString("zp.continuousreview"));var _evalTokenObj={},selectedList=[],isGoalExist=!1;if(_evalTokenObj.data=evalutionFields,_evalTokenObj.contentType="text",_evalTokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_evalTokenObj.search={by:"name"},_evalTokenObj.allowDuplicateValues=!1,_evalTokenObj.dropdownList={itemType:"checkbox",isTextHTMLEncoded:!0,appendTo:pageId},_evalTokenObj.isLabelHTMLEncoded=!0,isCRCompEnable||(_evalTokenObj.disabled=!0),!cfsNoData){const goalComp=["GOALS","KRA_GOALS"];for(var json in evalutionFields){data=evalutionFields[json];cfsDetail.appraisalModule.hasOwnProperty(data.compName)&&(selectedList.push(data),goalComp.includes(data.compName)&&(isGoalExist=!0))}}_evalTokenObj.values=selectedList,_evalTokenObj.placeholder=ZPI18N.getString("zp.appraisalModuleList"),ZPeopleComponents.tokenfield(pageId.find("#appraisalmodule"),_evalTokenObj),$("#appraisalmodule").on("ztokenfieldchange",PMSSetting.onChangeCFSEvalutation),(!cfsNoData&&!isGoalExist||cfsNoData)&&pageId.find("#pendingGoalDiv").hide();var _freqtokenObj={},_freqoptions=[];_freqoptions.push({name:ZPI18N.getString("zp.monthly"),id:PMSCommon.MONTHLY}),_freqoptions.push({name:ZPI18N.getString("zp.quarterly"),id:PMSCommon.QUARTERLY}),_freqoptions.push({name:ZPI18N.getString("zp.schhfyearly"),id:PMSCommon.HALF_YEARLY}),_freqoptions.push({name:ZPI18N.getString("zp.yearly"),id:PMSCommon.YEARLY}),_freqtokenObj.options=_freqoptions,_freqtokenObj.contentType="text",_freqtokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},_freqtokenObj.search={by:["name"],highlightKeyword:!0},_freqtokenObj.value=cfsNoData?PMSCommon.MONTHLY:[cfsDetail.frequency],isCRCompEnable||(_freqtokenObj.disabled=!0),_freqtokenObj.dropdownList={appendTo:pageId,fitForElement:!0},ZPeopleComponents.select(pageId.find("#cfsFrequency"),_freqtokenObj),$("#cfsFrequency").on("zselectchange",PMSSetting.onChangeCFSFrequency),parseInt(cfsDetail.frequency)===PMSCommon.YEARLY?pageId.find("[hide=yrlyFreq]").hide():pageId.find("[hide=yrlyFreq]").show();var _goalsStTokenObj={};_goalsStTokenObj.options=PMSSetting.dayOptions(!1,!0,!0),_goalsStTokenObj.contentType="text",_goalsStTokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},_goalsStTokenObj.search={by:["name"],highlightKeyword:!0},_goalsStTokenObj.value=cfsNoData?-1:[cfsDetail.dataFetFrom],isCRCompEnable||(_goalsStTokenObj.disabled=!0),_goalsStTokenObj.dropdownList={appendTo:pageId,fitForElement:!0},ZPeopleComponents.select(pageId.find("#cfsStartDay"),_goalsStTokenObj),$("#cfsStartDay").on("zselectchange",PMSSetting.onStartDayChange);var _goalsEtTokenObj={};_goalsEtTokenObj.options=PMSSetting.dayOptions(!1,!1),_goalsEtTokenObj.contentType="text",_goalsEtTokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},_goalsEtTokenObj.search={by:["name"],highlightKeyword:!0},_goalsEtTokenObj.value=cfsNoData?0:[cfsDetail.dataFetTo],_goalsEtTokenObj.disabled=!0,_goalsEtTokenObj.dropdownList={appendTo:pageId,fitForElement:!0},ZPeopleComponents.select(pageId.find("#cfsEndDay"),_goalsEtTokenObj),1===parseInt(cfsDetail.dataFetFrom)&&(parseInt(cfsDetail.frequency)===PMSCommon.MONTHLY?pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.smallsamemonth")):parseInt(cfsDetail.frequency)===PMSCommon.QUARTERLY?pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.smallsamequarter")):pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.smallsamemonth"))),pageId.find("#pastGoalChk")[0].checked=!cfsNoData&&cfsDetail.pastGoalEnable,pageId.find("#pastGoalChk").change(function(){cfsDetail.hasOwnProperty("pastGoalEnable")||PMSSetting.getSaveResetBtn(PMSSetting.CONTINUOUS_REVIEW)});var selfRevEnable=!cfsNoData&&cfsDetail.selfRevEnable;ZPeopleComponents.toggleswitch(pageId.find("#saEnable")),selfRevEnable&&ZPeopleComponents.toggleswitch(pageId.find("#saEnable")).switchOn(),$("#saEnable").on("ztoggleswitchchange",PMSSetting.onCFSSelfEnable),ZPeopleComponents.datefield(pageId.find("#selfSchDate"),{pickerdateselect:PMSSetting.selfCalStDt,format:dateFmt,pickerOptions:{appendTo:pageId}}),ZPeopleComponents.select(pageId.find("#remSelfDays"),{dropdownList:{appendTo:pageId,fitForElement:!0}}),$("#remSelfDays").on("zselectchange",PMSSetting.onRemainderNotiDaysChanges);let selfRevTxt=ZPI18N.getString("zp.smallcaseedate"),isDailyNotify=!1;if(cfsDetail.selfRevEnable&&(ZPeopleComponents.datefield(pageId.find("#selfSchDate")).setValue(cfsDetail.selfStartDate),pageId.find("#cfsSelfEndDay").val([cfsDetail.selfEndDay]),pageId.find("#notifyStartSelf")[0].checked=cfsDetail.notifyStartSelf,cfsDetail.notifyStartSelf?pageId.find("#cfsselfstartnotify").show():pageId.find("#cfsselfstartnotify").hide(),pageId.find("#notifyRemSelf")[0].checked=cfsDetail.notifyRemSelf,cfsDetail.notifyRemSelf?(pageId.find("#cfsselfpendingnotify").show(),ZPeopleComponents.select(pageId.find("#remSelfDays")).setValue([cfsDetail.selfRemDays]),isDailyNotify=cfsDetail.selfRemDays==PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS):(pageId.find("#cfsselfpendingnotify").hide(),ZPeopleComponents.select(pageId.find("#remSelfDays")).setValue([0])),pageId.find("#cfsSelfMainDiv").show()),pageId.find("#remSelfDays_endInfo").text(selfRevTxt),PMSSetting.changeRemainderInfoMsg(isDailyNotify,"remSelfDays"),ZPeopleComponents.select(pageId.find("#crRatingType"),{optionclick:PMSSetting.selectRatingType,value:"numberRating",dropdownList:{appendTo:pageId,fitForElement:!0}}),ZPeopleComponents.select(pageId.find("#numberRate"),{value:"5",dropdownList:{appendTo:pageId,fitForElement:!0}}),ZPeopleComponents.select(pageId.find("#numberRateMin"),{value:"0",dropdownList:{appendTo:pageId,fitForElement:!0}}),pageId.find("#textRating,#numberRating").hide(),pageId.find("#numberRating").show(),null!=PMSSetting.CFS_EMP_LKUP){var empLookup=pageId.find("#cfsReviewer");empLookup.empty(),empLookup.append(jQuery("<option />",{value:-1}).text(ZPI18N.getString("zp.select"))),$.each(PMSSetting.CFS_EMP_LKUP,function(key,value){empLookup.append(jQuery("<option />",{value:key,title:value}).html(value))})}ZPeopleComponents.select(pageId.find("#cfsReviewer"),{dropdownList:{appendTo:pageId,fitForElement:!0}}),$(pageId.find("#cfsReviewer")).on("zselectchange",function(){"-1"!=ZPeopleComponents.select(pageId.find("#cfsReviewer")).getValue()&&(pageId.find("#cfsReviewerError").hide(),ZPeopleComponents.select(pageId.find("#cfsReviewer")).setAttributes({className:""}),PMSSetting.CFS_DATA.cfsDetail.hasOwnProperty("reviewer")||PMSSetting.getSaveResetBtn(PMSSetting.CONTINUOUS_REVIEW))}),ZPeopleComponents.datefield(pageId.find("#revSchDate"),{pickerdateselect:PMSSetting.revCalStDt,format:dateFmt,pickerOptions:{appendTo:pageId}}),pageId.find("#notifyRemRev")[0].checked=!1,pageId.find("#notifyStartRev")[0].checked=!1,PMSSetting.isNoticePeriodEmp()&&(pageId.find("#excludeCRNoticEmp")[0].checked=!1),PMSSetting.isProbationPeriodEmp()&&(pageId.find("#excludeCRProbEmp")[0].checked=!1),ZPeopleComponents.select(pageId.find("#remRevDays"),{dropdownList:{appendTo:pageId,fitForElement:!0}}),$("#remRevDays").on("zselectchange",PMSSetting.onRemainderNotiDaysChanges),ZPeopleComponents.toggleswitch(pageId.find("#tg_continousreview"),{change:PMSSetting.beforeDelete});let publishers=void 0!=cfsDetail.publishers?cfsDetail.publishers:{},optLst=[],selLst=[],optObj={id:"1",name:ZPI18N.getString("zp.finalizer")};if(optLst.push(optObj),publishers.finalizer&&selLst.push(optObj),ZPeopleComponents.tokenfield(pageId.find("#crPubAuthID"),{data:optLst,values:selLst,contentType:"text",allowDuplicateValues:!1,dropdownList:{itemType:"checkbox",appendTo:pageId},dataMapping:{value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},search:{by:"name"}}),$("#crPubAuthID").on("ztokenfieldchange",PMSSetting.onChangeCFSPublisher),PMSSetting.updateCRRtgEvalMethodsChange(),cfsNoData)PMSSetting.enableDisableCRComponents(!0);else{if(ZPeopleComponents.datefield(pageId.find("#revSchDate")).setValue(cfsDetail.reviewerStartDate),pageId.find("#cfsReviewEndDay").val([cfsDetail.reviewerEndDay]),pageId.find("#notifyStartRev")[0].checked=cfsDetail.notifyStartRev,cfsDetail.notifyStartRev?pageId.find("#cfsstartnotify").show():pageId.find("#cfsstartnotify").hide(),pageId.find("#notifyRemRev")[0].checked=cfsDetail.notifyRemRev,isDailyNotify=!1,cfsDetail.notifyRemRev?(pageId.find("#cfspendingnotify").show(),ZPeopleComponents.select(pageId.find("#remRevDays")).setValue([cfsDetail.revRemDays]),isDailyNotify=cfsDetail.revRemDays==PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS):(pageId.find("#cfspendingnotify").hide(),ZPeopleComponents.select(pageId.find("#remRevDays")).setValue([0])),PMSSetting.changeRemainderInfoMsg(isDailyNotify,"remRevDays"),pageId.find("#sfOnSbtSndMail")[0].checked=cfsDetail.selfOnSubmitSendMail,cfsDetail.selfOnSubmitSendMail?pageId.find("#cfsselfcompletenotify").show():pageId.find("#cfsselfcompletenotify").hide(),pageId.find("#onPubSndMail")[0].checked=cfsDetail.onPubSndMail,cfsDetail.onPubSndMail?pageId.find("#cfspublishnotify").show():pageId.find("#cfspublishnotify").hide(),ZPeopleComponents.select(pageId.find("#cfsReviewer")).setValue([cfsDetail.reviewer]),PMSSetting.isNoticePeriodEmp()&&(pageId.find("#excludeCRNoticEmp")[0].checked=cfsDetail.excludeNoticEmp),PMSSetting.isProbationPeriodEmp()&&(pageId.find("#excludeCRProbEmp")[0].checked=cfsDetail.excludeProbEmp),pageId.find("#caConfigID").attr("cfsid",cfsDetail.cfsID),pageId.find("#cfsdeletebtn").show(),pageId.find("#cfsMainDiv").hide(),void 0!==nxtPopSetDt&&!jQuery.isEmptyObject(nxtPopSetDt)){var msg="";if("INITIAL_CASE"===nxtPopSetDt.CASE){var brCrSfStDT=nxtPopSetDt.currSelfStartDt,brCrSfEdDT=nxtPopSetDt.currSelfEndDt,brCrRevStDT=nxtPopSetDt.currRevStartDt,brCrRevEdDT=nxtPopSetDt.currRevEndDt;msg=ZPI18N.getString("zp.bnrinitialcasetxt"),void 0!==brCrSfStDT&&void 0!==brCrSfEdDT&&(msg+="&nbsp;",msg+=ZPI18N.getString("zp.bnrinitialselftxt",["<b>"+brCrSfStDT+"</b>","<b>"+brCrSfEdDT+"</b>"])),msg+="&nbsp;",msg+=ZPI18N.getString("zp.bnrinitialrevtxt",[PMSSetting.CFS_EMP_LKUP[cfsDetail.reviewer],"<b>"+brCrRevStDT+"</b>","<b>"+brCrRevEdDT+"</b>"])}else{var respCurrDt=nxtPopSetDt.currentDt,isProgress=!1;brCrSfStDT=nxtPopSetDt.currSelfStartDt,brCrSfEdDT=nxtPopSetDt.currSelfEndDt,brCrRevStDT=nxtPopSetDt.currRevStartDt,brCrRevEdDT=nxtPopSetDt.currRevEndDt;if(void 0!==brCrSfStDT&&void 0!==brCrRevEdDT&&nxtPopSetDt.isActivePeriod&&PMSSetting.onOrBeforeCurrDate(respCurrDt,brCrSfStDT,brCrRevEdDT)&&(isProgress=!0),isProgress||void 0===brCrRevStDT||void 0===brCrRevEdDT||nxtPopSetDt.isActivePeriod&&PMSSetting.onOrBeforeCurrDate(respCurrDt,brCrRevStDT,brCrRevEdDT)&&(isProgress=!0),isProgress)msg=ZPI18N.getString("zp.bnrinprogress"),void 0!==brCrSfStDT&&void 0!==brCrSfEdDT&&(msg+="&nbsp;",msg+=ZPI18N.getString("zp.exselfreview",["<b>"+brCrSfStDT+"</b>","<b>"+brCrSfEdDT+"</b>"])),msg+="&nbsp;",msg+=ZPI18N.getString("zp.bnrinitialrevtxt",[PMSSetting.CFS_EMP_LKUP[cfsDetail.reviewer],"<b>"+brCrRevStDT+"</b>","<b>"+brCrRevEdDT+"</b>"]);else{var brSfStDT=nxtPopSetDt.selfStartDt,brSfEdDT=nxtPopSetDt.selfEndDt,brRevStDT=nxtPopSetDt.revStartDt,brRevEdDT=nxtPopSetDt.revEndDt;msg=void 0!==brSfStDT?ZPI18N.getString("zp.bnrnxtdate",["<b>"+brSfStDT+"</b>"]):ZPI18N.getString("zp.bnrnxtdate",["<b>"+brRevStDT+"</b>"]),msg+=",",void 0!==brSfStDT&&void 0!==brSfEdDT&&(msg+="&nbsp;",msg+=ZPI18N.getString("zp.bnrnxtselftxt",["<b>"+brSfStDT+"</b>","<b>"+brSfEdDT+"</b>"])),msg+="&nbsp;";var revNme=PMSSetting.CFS_EMP_LKUP[cfsDetail.reviewer]+"'s";msg+=ZPI18N.getString("zp.bnrnxtrevtxt",[revNme,"<b>"+brRevStDT+"</b>","<b>"+brRevEdDT+"</b>"])}}pageId.find("#runningBnrMsg").html(msg),pageId.find("#crrunningbnrdiv").show()}if(0===pageId.find("#cfs_alert").length)if(PMSSetting.POPULATE_PAST_DATE_FLAG&&isEnable){var evalModuleList=PMSSetting.getEvalModuleList(cfsDetail.appraisalModule,!1),cfs_pastpop_info='<div class="zpl_info MB20" style="max-width: 1020px;" id="cfs_pastpop_info">';cfs_pastpop_info+="<p>"+ZPI18N.getString("zp.cfspastpopbanner",[evalModuleList])+' <a onclick="PMSSetting.populatePastDateInfo();" class="zpl_link">'+ZPI18N.getString("zp.clickhere")+"&nbsp;</a></p> </div>",pageId.find("#cfs_pastpop_info").remove(),$(cfs_pastpop_info).insertBefore(pageId.find("#crrunningbnrdiv"))}else pageId.find("#cfs_pastpop_info").remove();if(PMSSetting.setGoalPeriodApplicable(cfsDetail.applicableFor),cfsDetail.ratingObj){var ratingObj=cfsDetail.ratingObj,ratingType=ZPeopleComponents.select(pageId.find("#crRatingType")),numberRate=ZPeopleComponents.select(pageId.find("#numberRate")),numberRateMin=ZPeopleComponents.select(pageId.find("#numberRateMin")),textRatingValue=pageId.find("#textRatingValue");if(ratingObj.isRatingEnabled){if(pageId.find("#crRating").prop("checked",!0),1==ratingObj.type)ratingType.setValue("numberRating"),numberRateMin.setValue(ratingObj.min),numberRate.setValue(ratingObj.max),pageId.find("#numberRating").show(),pageId.find("#textRating").hide();else if(2==ratingObj.type){ratingType.setValue("textRating"),pageId.find("#textRating").show(),pageId.find("#numberRating").hide(),PMSSetting.isRatingModified=!0,PMSSetting.textrating_value=ratingObj.textRatingValue.slice();for(var textRating="",i=ratingObj.max-1;i>=0;i--)PMSSetting.textrating_name[i]=ZPeople.decodeTxt(ratingObj.textRatingName[i]),textRating+='<div class="zpl_idiv" elem="textrow">',textRating+='<div class="zpl_rwfld zpl_rwnum"><span>'+PMSSetting.textrating_value[i]+"</span></div>",textRating+='<div class="zpl_rwfld" style="width: 303px;">',textRating+='<input type="text" class="ztextbox" title="'+ZPeople.decodeTxt(ratingObj.textRatingName[i])+'" value="'+ZPeople.decodeTxt(ratingObj.textRatingName[i])+'" onchange="PMSSetting.editTextRating(this);"></div>',isEnable||(textRating+='<div class="zpl_rwfld zpl_rwicn"> <i class="PI_delete" title="Delete" id="removeTextRating" onclick="PMSSetting.removeTextRating(this);"></i> </div>'),textRating+="</div>";textRatingValue.find("[elem=textrow]").remove(),textRatingValue.find(".ztextbox--error__label").remove(),textRatingValue.append(textRating),(isEnable||ratingObj.max>=10)&&pageId.find("#addtextRating").children().hide()}}else pageId.find("#crRating").prop("checked",!1),ratingType.setValue("numberRating"),pageId.find("#numberRating").show(),pageId.find("#textRating").hide();ratingObj.isCommentEnabled?(pageId.find("#crComment").prop("checked",!0),pageId.find("#commentSec").removeClass("zpl_DNI"),ratingObj.isCommentMandatory&&(pageId.find("#crCmtMdty").prop("checked",!0),pageId.find("#cmtMdtyLenDiv").removeClass("zpl_DNI"),void 0!==ratingObj.minCommentLength&&null!==ratingObj.minCommentLength&&"null"!==ratingObj.minCommentLength&&""!==ratingObj.minCommentLength&&parseInt(ratingObj.minCommentLength)>0&&(pageId.find("#crMinCmtLen")[0].value=parseInt(ratingObj.minCommentLength)))):(pageId.find("#crComment").prop("checked",!1),PMSSetting.isCRCommentEnabled("crComment"))}if(isEnable){if(ZPeopleComponents.toggleswitch(pageId.find("#tg_continousreview")).switchOn(),ZPeopleComponents.tokenfield(pageId.find("#appraisalmodule")).setAttributes({disabled:!0}),ZPeopleComponents.select(pageId.find("#cfsFrequency")).setAttributes({disabled:!0}),ZPeopleComponents.select(pageId.find("#cfsStartDay")).setAttributes({disabled:!0}),ZPeopleComponents.datefield(pageId.find("#revSchDate")).setAttributes({disabled:!0}),ZPeopleComponents.select(pageId.find("#cfsReviewer")).setAttributes({disabled:!0}),cfsDetail.notifyRemRev?ZPeopleComponents.select(pageId.find("#remRevDays")).setAttributes({disabled:!1}):ZPeopleComponents.select(pageId.find("#remRevDays")).setAttributes({disabled:!0}),PMSSetting.enableDiasbleCRApplicability(!0),PMSSetting.isNoticePeriodEmp()&&pageId.find("#excludeCRNoticEmp").prop("disabled",!0),PMSSetting.isProbationPeriodEmp()&&pageId.find("#excludeCRProbEmp").prop("disabled",!0),ZPeopleComponents.toggleswitch(pageId.find("#saEnable")).setAttributes({disabled:!0}),pageId.find("#pastGoalChk").prop("disabled",!0),cfsDetail.selfRevEnable&&(ZPeopleComponents.datefield(pageId.find("#selfSchDate")).setAttributes({disabled:!0}),cfsDetail.notifyRemSelf?ZPeopleComponents.select(pageId.find("#remSelfDays")).setAttributes({disabled:!1}):(ZPeopleComponents.select(pageId.find("#remSelfDays")).setValue([0]),ZPeopleComponents.select(pageId.find("#remSelfDays")).setAttributes({disabled:!0}))),cfsDetail.ratingObj){ratingObj=cfsDetail.ratingObj,ratingType=ZPeopleComponents.select(pageId.find("#crRatingType")),numberRate=ZPeopleComponents.select(pageId.find("#numberRate"));ratingType.setAttributes({disabled:!0}),ratingObj.isRatingEnabled?1==ratingObj.type?(numberRate.setAttributes({disabled:!0}),numberRateMin.setAttributes({disabled:!0})):2==ratingObj.type&&pageId.find("#textRatingValue [elem=textrow] input").addClass("disabled"):(numberRate.setAttributes({disabled:!0}),numberRateMin.setAttributes({disabled:!0})),["#crRating","#crComment","#crCmtMdty"].forEach(element=>{pageId.find(element).prop("disabled",!0)}),pageId.find("#crMinCmtLen").addClass("disabled")}}else PMSSetting.enableDisableCRComponents(!0)}isCRCompEnable&&isEnable||(isCRCompEnable||ZPeopleComponents.toggleswitch(pageId.find("#tg_continousreview")).setAttributes({disabled:!0}),PMSSetting.enableDisableCRComponents(!0)),PMSSetting.onCFSSelfEnable(),isEnable&&(PMSSetting.validateDayInfo(PMSCommon.CFS_SELF),PMSSetting.validateDayInfo(PMSCommon.CFS_REVIEWER));var tooltipOptions={};for(var elementId of["#includependgoalstt","#selfreviewenddaytt","#reviewverenddaytt"])ZPeopleComponents.tooltip(pageId.find(elementId),tooltipOptions);$(pageId).scrollTop(0)},onChangeCFSPublisher:function(){let pageId=settingsPage.container;var cfsDetail=PMSSetting.CFS_DATA.cfsDetail;let publisher=void 0!=cfsDetail&&void 0!=cfsDetail.publishers?cfsDetail.publishers:void 0,isShowBtn=!1,pubOwner=ZPeopleComponents.tokenfield(pageId.find("#crPubAuthID")).getAllValues(),finalizer=!1;for(let pubItr in pubOwner)1==pubOwner[pubItr].id&&(finalizer=!0);void 0!==publisher?(publisher.finalizer&&!finalizer||!publisher.finalizer&&finalizer)&&(isShowBtn=!0):isShowBtn=finalizer,isShowBtn&&PMSSetting.getSaveResetBtn(PMSSetting.CONTINUOUS_REVIEW)},onRemainderNotiDaysChanges:function(event){if(!event.detail.fromUI)return;let pageId=settingsPage.container,isShowBtn=!1;var cfsDetail=PMSSetting.CFS_DATA.cfsDetail;let elemId=$(event.currentTarget).attr("id"),remSelfDays=parseInt(ZPeopleComponents.select(pageId.find("#"+elemId)).getValue()),propName="selfRemDays";"remRevDays"===elemId&&(propName="revRemDays"),cfsDetail.hasOwnProperty(propName)&&remSelfDays===parseInt(cfsDetail[propName])||(isShowBtn=!0),PMSSetting.changeRemainderInfoMsg(remSelfDays===PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS,elemId),isShowBtn&&PMSSetting.getSaveResetBtn(PMSSetting.CONTINUOUS_REVIEW)},changeRemainderInfoMsg:function(isDailyReminder,remDaysKey){let pageId=settingsPage.container;isDailyReminder?(pageId.find("#"+remDaysKey+"_endInfo").addClass("zpl_DNI"),pageId.find("#"+remDaysKey+"_endInfoIcon").removeClass("zpl_DNI")):(pageId.find("#"+remDaysKey+"_endInfo").removeClass("zpl_DNI"),pageId.find("#"+remDaysKey+"_endInfoIcon").addClass("zpl_DNI"))},enableDiasbleCRApplicability:function(isDisable){let pageId=settingsPage.container,appliSelObj=pageId.find("#condtInnerDiv [class=select-js]");$(appliSelObj).each(function(index,elem){let elemId=$(elem).attr("id");void 0!==elemId&&(ZPeopleComponents.isComponent(pageId.find("#"+elemId))&&ZPeopleComponents.select(pageId.find("#"+elemId)).setAttributes({disabled:isDisable}),isDisable?$(elem).parent().find(".PI_delete").addClass("zpl_DNI"):$(elem).parent().find(".PI_delete").removeClass("zpl_DNI"))}),isDisable?pageId.find("#condtInnerDiv #addCondDiv").addClass("zpl_DNI"):pageId.find("#condtInnerDiv #addCondDiv").removeClass("zpl_DNI"),appliSelObj=pageId.find("#nonAppliDiv [class=select-js]"),$(appliSelObj).each(function(index,elem){let elemId=$(elem).attr("id");void 0!==elemId&&(ZPeopleComponents.isComponent(pageId.find("#"+elemId))&&ZPeopleComponents.select(pageId.find("#"+elemId)).setAttributes({disabled:isDisable}),isDisable?$(elem).parent().find(".PI_delete").addClass("zpl_DNI"):$(elem).parent().find(".PI_delete").removeClass("zpl_DNI"))}),0==pageId.find("#nonAppliDiv .addNonCondtTemp").length?pageId.find("#exemptionDiv #exempDescID").text(ZPI18N.getString("zp.pa.contreview.exemptiondesc")+" "+(isDisable?" ":ZPI18N.getString("zp.wishtoadd"))):pageId.find("#exemptionDiv #exempDescID").text(""),isDisable?pageId.find("#nonAppliDiv #addNonCondtDiv").addClass("zpl_DNI"):pageId.find("#nonAppliDiv #addNonCondtDiv").removeClass("zpl_DNI")},enableDisableCRComponents:function(isDisable){let pageId=settingsPage.container;var elementsToDisable=[{type:"tokenfield",selector:"#appraisalmodule"},{type:"select",selector:"#cfsFrequency"},{type:"select",selector:"#cfsStartDay"},{type:"toggleswitch",selector:"#saEnable"},{type:"datefield",selector:"#selfSchDate"},{type:"select",selector:"#cfsReviewer"},{type:"datefield",selector:"#revSchDate"},{type:"tokenfield",selector:"#crPubAuthID"}];isDisable?(elementsToDisable.push({type:"select",selector:"#remRevDays"}),elementsToDisable.push({type:"select",selector:"#remSelfDays"}),elementsToDisable.push({type:"select",selector:"#cfsEndDay"}),elementsToDisable.push({type:"select",selector:"#crRatingType"}),elementsToDisable.push({type:"select",selector:"#numberRateMin"}),elementsToDisable.push({type:"select",selector:"#numberRate"})):(pageId.find("#crRating").is(":checked")&&(elementsToDisable.push({type:"select",selector:"#crRatingType"}),elementsToDisable.push({type:"select",selector:"#numberRateMin"}),elementsToDisable.push({type:"select",selector:"#numberRate"})),pageId.find("#notifyRemRev").is(":checked")&&elementsToDisable.push({type:"select",selector:"#remRevDays"}),ZPeopleComponents.toggleswitch(pageId.find("#saEnable")).getState()&&pageId.find("#notifyRemSelf").is(":checked")&&elementsToDisable.push({type:"select",selector:"#remSelfDays"})),elementsToDisable.forEach(element=>{ZPeopleComponents.isComponent(pageId.find(element.selector))&&("tokenfield"===element.type?ZPeopleComponents.tokenfield(pageId.find(element.selector)).setAttributes({disabled:isDisable}):"select"===element.type?ZPeopleComponents.select(pageId.find(element.selector)).setAttributes({disabled:isDisable}):"datefield"===element.type?ZPeopleComponents.datefield(pageId.find(element.selector)).setAttributes({disabled:isDisable}):"toggleswitch"===element.type&&ZPeopleComponents.toggleswitch(pageId.find(element.selector)).setAttributes({disabled:isDisable}))});["#pastGoalChk, #notifyStartSelf","#notifyRemSelf","#onPubSndMail","#sfOnSbtSndMail","#notifyRemRev","#notifyStartRev","#cfsSelfEndDay","#cfsReviewEndDay","#crRating","#crComment","#crCmtMdty"].forEach(element=>{pageId.find(element).prop("disabled",isDisable)}),isDisable?pageId.find("#cfsselfstartnotify, #cfsselfpendingnotify, #cfsstartnotify, #cfspendingnotify, #cfsselfcompletenotify, #cfspublishnotify, #crMinCmtLen").addClass("disabled"):pageId.find("#cfsselfstartnotify, #cfsselfpendingnotify, #cfsstartnotify, #cfspendingnotify, #cfsselfcompletenotify, #cfspublishnotify, #crMinCmtLen").removeClass("disabled"),PMSSetting.isNoticePeriodEmp()&&pageId.find("#excludeCRNoticEmp").prop("disabled",isDisable),PMSSetting.isProbationPeriodEmp()&&pageId.find("#excludeCRProbEmp").prop("disabled",isDisable),PMSSetting.enableDiasbleCRApplicability(isDisable),isDisable?pageId.find("#textRatingValue").addClass("disabled"):pageId.find("#crRating").is(":checked")&&pageId.find("#textRatingValue").removeClass("disabled")},isNoticePeriodEmp:function(){return void 0!==PMSSetting.noticePeriodOpt&&null!==PMSSetting.noticePeriodOpt&&"null"!==PMSSetting.noticePeriodOpt&&""!==PMSSetting.noticePeriodOpt},isProbationPeriodEmp:function(){return void 0!==PMSSetting.proPeriodOpt&&null!==PMSSetting.proPeriodOpt&&"null"!==PMSSetting.proPeriodOpt&&""!==PMSSetting.proPeriodOpt},isCRRatingEnabled:function(){let pageId=settingsPage.container;pageId.find("#crRating").is(":checked")?(ZPeopleComponents.select(pageId.find("#numberRate")).setAttributes({disabled:!1}),ZPeopleComponents.select(pageId.find("#numberRateMin")).setAttributes({disabled:!1}),pageId.find("#textRatingValue, #textRatingValue [elem=textrow] input, #addtextRating, #removeTextRating").removeClass("disabled"),ZPeopleComponents.select(pageId.find("#crRatingType")).setAttributes({disabled:!1})):(ZPeopleComponents.select(pageId.find("#numberRate")).setAttributes({disabled:!0}),ZPeopleComponents.select(pageId.find("#numberRateMin")).setAttributes({disabled:!0}),pageId.find("#textRatingValue, #textRatingValue [elem=textrow] input, #addtextRating, #removeTextRating").addClass("disabled"),ZPeopleComponents.select(pageId.find("#crRatingType")).setAttributes({disabled:!0}))},isCRCommentEnabled:function(elemId){let pageId=settingsPage.container;"crComment"===elemId?pageId.find("#crComment").is(":checked")?pageId.find("#commentSec").removeClass("zpl_DNI"):($("#crMinCmtLen").val(""),pageId.find("#cmtMdtyLenDiv").addClass("zpl_DNI"),pageId.find("#crCmtMdty").prop("checked",!1),pageId.find("#commentSec").addClass("zpl_DNI")):"crCmtMdty"===elemId&&(pageId.find("#crCmtMdty").is(":checked")?pageId.find("#cmtMdtyLenDiv").removeClass("zpl_DNI"):($("#crMinCmtLen").val(""),pageId.find("#cmtMdtyLenDiv").addClass("zpl_DNI")))},updateCRRtgEvalMethodsChange:function(){let pageId=settingsPage.container;if(PMSSetting.isOnlyQusAnsInclude())pageId.find("[hide=yrlyFreq]").hide(),ZPeopleComponents.select(pageId.find("#cfsStartDay")).setValue([1]),ZPeopleComponents.select(pageId.find("#cfsEndDay")).setValue([32]),pageId.find("#crRating").prop("checked",!1),PMSSetting.isCRRatingEnabled(),pageId.find("#ratingDiv").addClass("zpl_DNI");else if(pageId.find("#ratingDiv").removeClass("zpl_DNI"),ZPeopleComponents.isComponent(pageId.find("#cfsFrequency"))){let freq=ZPeopleComponents.select(pageId.find("#cfsFrequency")).getValue();parseInt(freq)!==PMSCommon.YEARLY&&pageId.find("[hide=yrlyFreq]").show()}PMSSetting.isOnlyQusAnsInclude(!0)?(pageId.find("#crComment").prop("checked",!0),PMSSetting.isCRCommentEnabled("crComment"),pageId.find("#crComment").prop("disabled",!0)):pageId.find("#crComment").prop("disabled",!1)},isOnlyQusAnsInclude:function(isQusAnsEnable){let pageId=settingsPage.container,evalMeth=ZPeopleComponents.tokenfield(pageId.find("#appraisalmodule")).getAllValues();if(isQusAnsEnable){let isQusAns=!1;return evalMeth.forEach(function(obj){if(void 0!==obj.compName&&"QUS_ANS"===obj.compName)return isQusAns=!0,!1}),isQusAns}return 1===evalMeth.length&&void 0!==evalMeth[0].compName&&"QUS_ANS"===evalMeth[0].compName},constructEvalutionOption:function(cfsNoData){var _evalutionOption=[];const crComp=["GOALS","KRA_GOALS","KRA","COMPETENCY","QUS_ANS"];for(var json in PMSSetting.SEL_ENABLED_MODULES){var data=PMSSetting.SEL_ENABLED_MODULES[json],dispName="";(data.enable||cfsNoData)&&crComp.includes(data.compName)&&(data.hasOwnProperty("displayName")?dispName=data.displayName:"GOALS"===data.compName?dispName=PMSSetting.GOAL_DISPLAY_NAME:"KRA_GOALS"===data.compName?dispName=PMSSetting.KRA_GOAL_DISPLAY_NAME:"KRA"===data.compName?dispName=PMSSetting.KRA_DISPLAY_NAME:"COMPETENCY"===data.compName?dispName=PMSSetting.COMPETENCY_DISPLAY_NAME:"QUS_ANS"===data.compName&&(dispName=PMSSetting.QUS_ANS_DISPLAY_NAME),_evalutionOption.push({name:dispName,id:data.compID,compName:data.compName}))}return _evalutionOption},selectRatingType:function(event){var hideId,data=event.detail,pageId=settingsPage.container,id=data.selectedValue;"numberRating"==id?hideId="textRating":"textRating"==id&&(hideId="numberRating"),PMSSetting.isRatingModified=!1,PMSSetting.ratingName=null,PMSSetting.isRatingEditable=!1,PMSSetting.oldMinRange=null,PMSSetting.oldMaxRange=null,pageId.find("#"+id).show(),pageId.find("#"+hideId).hide(),PMSSetting.getDefaultRatings()},getDefaultRatings:function(rating,mode){var pageId=settingsPage.container,len=PMSSetting.rating_keyarray.filter(Boolean).length;if(""!=rating&&void 0!=rating&&"add"==mode){if(PMSSetting.rating_keyarray.push(rating),len+1>10)return void ZPeople.Message.warning(ZPI18N.getString("zp.maxratingwarning"))}else"retain"==mode||"delete"==mode||PMSSetting.isRatingModified||(PMSSetting.rating_keyarray=[ZPI18N.getString("zp.unsatisfactory"),ZPI18N.getString("zp.needimprovement"),ZPI18N.getString("zp.satisfactory"),ZPI18N.getString("zp.excellent"),ZPI18N.getString("zp.outstanding")],PMSSetting.textrating_name=[ZPI18N.getString("zp.unsatisfactory"),ZPI18N.getString("zp.needimprovement"),ZPI18N.getString("zp.satisfactory"),ZPI18N.getString("zp.excellent"),ZPI18N.getString("zp.outstanding")],PMSSetting.textrating_value=[1,2,3,4,5]);var max=5,min=0;if("numberRating"==ZPeopleComponents.select(pageId.find("#crRatingType")).getValue()?(max=ZPeopleComponents.select(pageId.find("#numberRate")).getValue(),min=ZPeopleComponents.select(pageId.find("#numberRateMin")).getValue()):"textRating"==ZPeopleComponents.select(pageId.find("#crRatingType")).getValue()&&(max=PMSSetting.textrating_name.length,ZPeopleComponents.select(pageId.find("#numberRate")).setValue(max),ZPeopleComponents.select(pageId.find("#numberRateMin")).setValue(min)),"textRating"==ZPeopleComponents.select(pageId.find("#crRatingType")).getValue()){pageId.find("#addtextRating").children().show(),pageId.find("#textRatingValue [elem=textrow]").remove();var textRating="";textRating="";for(var i=PMSSetting.textrating_name.length-1;i>=0;i--)textRating+='<div class="zpl_idiv" elem="textrow"> <div class="zpl_rwfld zpl_rwnum"><span>'+PMSSetting.textrating_value[i]+'</span></div> <div class="zpl_rwfld" style="width: 303px;"> <input type="text" class="ztextbox" value="'+PMSSetting.textrating_name[i]+'" onchange="PMSSetting.editTextRating(this);"> </div> <div class="zpl_rwfld zpl_rwicn"> <i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" id="removeTextRating" onclick="PMSSetting.removeTextRating(this);"></i> </div> </div>';pageId.find("#textRatingValue").append(textRating),PMSSetting.textrating_name.length>=10&&pageId.find("#addtextRating").children().hide()}pageId.find("#textRatingValue .ztextbox--error__label").remove()},showNewtextRating:function(obj){var pageID=settingsPage.container;pageID.find("#textRatingValue .ztextbox--error__label").remove();var tratingname=pageID.find("#addtextRating").siblings("[elem=textrow]").children(".zpl_rwfld").children("input").val();if(void 0==tratingname||""==tratingname||pageID.find("#editTextRating").is(":visible"))if(void 0!=tratingname&&tratingname.length>50){var ratingerr='<span class="ztextbox--error__label"  id="addRatingErrormsg">'+ZPI18N.getString("zp.ratinglengtherror")+"</span>";pageID.find("#editTextRating input").after(ratingerr),pageID.find("#editTextRating input").addClass("ztextbox__error")}else{ratingerr='<span class="ztextbox--error__label"  id="addRatingErrormsg">'+ZPI18N.getString("zp.ratingmandatory")+"</span>";pageID.find("#editTextRating input").after(ratingerr),pageID.find("#editTextRating input").addClass("ztextbox__error")}else{var addrating='<div class="zpl_idiv" elem="textrow" id="editTextRating"> <div class="zpl_rwfld zpl_rwnum"><span>'+(PMSSetting.textrating_name.filter(Boolean).length+1)+'</span></div> <div class="zpl_rwfld" style="width: 303px;"> <input type="text" class="ztextbox" value="" id="text_ratingName" onchange="PMSSetting.addNewtextRating(this)"> </div> <div class="zpl_rwfld zpl_rwicn"> <i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" id="removeTextRating" onclick="PMSSetting.removeTextRating(this);"></i> </div> </div>';pageID.find("#textRatingValue :first").after(addrating)}},editTextRating:function(obj){PMSSetting.ratingTextName=$(obj).attr("value").trim(),PMSSetting.isTextRatingEditable=!0,PMSSetting.addNewtextRating(obj)},addNewtextRating:function(obj){var pageID=settingsPage.container,ratingName=PMSSetting.isTextRatingEditable?$(obj).val().trim():$(obj).parent().parent().find("#text_ratingName").val().trim();if(pageID.find("#textRatingValue .ztextbox--error__label").remove(),""!=ratingName&&ratingName.length<=50){if(PMSSetting.isTextRatingEditable){var index=PMSSetting.textrating_name.indexOf(ZPeople.escapeHtml(PMSSetting.ratingTextName));PMSSetting.textrating_name[index]=ZPeople.escapeHtml(ratingName),PMSSetting.isTextRatingEditable=!1}else PMSSetting.textrating_name.push(ZPeople.escapeHtml(ratingName)),PMSSetting.textrating_value.push(PMSSetting.textrating_name.length);$(obj).parent().parent().remove(),PMSSetting.isRatingModified=!0,PMSSetting.getDefaultRatings()}else{var ratingerr="";""==ratingName?ratingerr="<span class='ztextbox--error__label' id='addRatingErrormsg'>"+ZPI18N.getString("zp.ratingmandatory")+"</span>":ratingName.length>25&&(ratingerr="<span class='ztextbox--error__label' id='addRatingErrormsg'>"+ZPI18N.getString("zp.ratinglengtherror")+"</span>"),$(obj).parent().append(ratingerr),$(obj).addClass("ztextbox__error")}},removeTextRating:function(obj){var pageID=settingsPage.container;if(PMSSetting.textrating_name.filter(Boolean).length<=3)ZPeople.Message.warning(ZPI18N.getString("zp.minratreq"));else{var ratingname=$(obj).parent().parent().find("input").val();void 0!=ratingname&&""!=ratingname&&(PMSSetting.textrating_name.splice(PMSSetting.textrating_name.indexOf(ratingname),1),PMSSetting.textrating_value.splice(PMSSetting.textrating_value.length-1,1)),$(obj).parent().fadeOut(300,function(){$(this).remove()}),pageID.find("#addtextRating").show()}PMSSetting.getDefaultRatings("","retain")},selfCalStDt:function(event){var isValid=!1,pageID=settingsPage.container;pageID.find("#cfsSelfStartDayError").hide();var startDate=ZPeopleComponents.datefield(pageID.find("#selfSchDate")).getValue().dateString;if(!PMSSetting.isValidDate(startDate))return pageID.find("#cfsSelfStartDayError").html(ZPI18N.getString("zp.notvaliddate")).show(),isValid;if(ZPeopleComponents.datefield(pageID.find("#selfSchDate")).setAttributes({className:""}),PMSSetting.onOrAfterCurrDate(startDate)){PMSSetting.constructHelpContent();var revStDt=ZPeopleComponents.datefield("#revSchDate").getValue().dateString;void 0!==revStDt&&""!==revStDt&&(isValid=PMSSetting.revCalStDt())}else pageID.find("#cfsSelfStartDayError").html(ZPI18N.getString("zp.seldateerror")).show();return PMSSetting.OnNotifyStart("SELF"),PMSSetting.CFS_DATA.cfsDetail.hasOwnProperty("selfStartDate")||PMSSetting.getSaveResetBtn(PMSSetting.CONTINUOUS_REVIEW),isValid},revCalStDt:function(){var isValid=!1,pageID=settingsPage.container;pageID.find("#cfsReviewStartDayError").hide();var revStDt=ZPeopleComponents.datefield(pageID.find("#revSchDate")).getValue().dateString;if(!PMSSetting.isValidDate(revStDt))return pageID.find("#cfsReviewStartDayError").html(ZPI18N.getString("zp.notvaliddate")).show(),isValid;if(ZPeopleComponents.datefield(pageID.find("#revSchDate")).setAttributes({className:""}),PMSSetting.onOrAfterCurrDate(revStDt)){var flag=!0,expDt=void 0;if(ZPeopleComponents.toggleswitch(pageID.find("#saEnable")).getState()){pageID.find("#cfsSelfStartDayError").hide();var sfStDt=ZPeopleComponents.datefield(pageID.find("#selfSchDate")).getValue().dateString;if(""===sfStDt||void 0===sfStDt)return pageID.find("#cfsSelfStartDayError").html(ZPI18N.getString("zp.holiday.dateerror")).show(),void ZPeopleComponents.datefield(pageID.find("#selfSchDate")).setAttributes({className:"ztextbox__error"});if(ZPeopleComponents.datefield(pageID.find("#selfSchDate")).setAttributes({className:""}),""===revStDt)return pageID.find("#cfsReviewStartDayError").html(ZPI18N.getString("zp.holiday.dateerror")).show(),void ZPeopleComponents.datefield(pageID.find("#revSchDate")).setAttributes({className:"ztextbox__error"});ZPeopleComponents.datefield(pageID.find("#revSchDate")).setAttributes({className:""}),flag=!1;var sDt=moment(sfStDt,dateFmt.toUpperCase()),rDt=moment(revStDt,dateFmt.toUpperCase()),newDt=sDt.clone().add(1,"months");expDt=newDt=newDt.add(-1,"days"),(rDt.isSame(sDt)||rDt.isAfter(sDt))&&(rDt.isSame(newDt)||rDt.isBefore(newDt))&&(flag=!0)}if(flag)PMSSetting.constructHelpContent(),isValid=!0;else{var tempDt=expDt.date();tempDt>28&&(tempDt=28);var tempStDt=new Date(expDt.year(),expDt.month(),tempDt);ZPeople.Message.failure(ZPI18N.getString("zp.revstdterror",[sfStDt,Calendar.formatDate(tempStDt)])),pageID.find("#cfsReviewStartDayError").html(ZPI18N.getString("zp.revstdterror",[sfStDt,Calendar.formatDate(tempStDt)])).show(),ZPeopleComponents.datefield(pageID.find("#revSchDate")).setAttributes({className:"ztextbox__error"})}}else ZPeople.Message.failure(ZPI18N.getString("zp.seldateerror")),pageID.find("#cfsReviewStartDayError").html(ZPI18N.getString("zp.seldateerror")).show(),ZPeopleComponents.datefield(pageID.find("#revSchDate")).setAttributes({className:"ztextbox__error"});return PMSSetting.OnNotifyStart("REVIEWER"),PMSSetting.CFS_DATA.cfsDetail.hasOwnProperty("reviewerStartDate")||PMSSetting.getSaveResetBtn(PMSSetting.CONTINUOUS_REVIEW),isValid},isValidDate:function(selDate){var isValid=!1,day=moment(selDate,dateFmt.toUpperCase()).date();return day>=1&&day<=28&&(isValid=!0),isValid},onOrAfterCurrDate:function(selDate){var flag=!1,stDt=moment(selDate,dateFmt.toUpperCase()),currDt=PMSSetting.getDate();return(stDt.isSame(currDt)||stDt.isAfter(currDt))&&(flag=!0),flag},onOrBeforeCurrDate:function(currDate,stDate,edDate){var flag=!1,currDt=moment(currDate,dateFmt.toUpperCase()),stDt=moment(stDate,dateFmt.toUpperCase()),edDt=moment(edDate,dateFmt.toUpperCase());return stDt.isSame(currDt)||edDt.isSame(currDt)?flag=!0:currDt.isAfter(stDt)&&currDt.isBefore(edDt)&&(flag=!0),flag},getDate:function(gDate,format){var currDt=moment().startOf("day");return void 0!==gDate&&(currDt=moment(gDate,format)),currDt},OnNotifyStart:function(type){var pageID=settingsPage.container,currDt=PMSSetting.getDate();if("SELF"===type){var ntfyStSf=pageID.find("#notifyStartSelf").is(":checked"),selfStDt=ZPeopleComponents.datefield(pageID.find("#selfSchDate")).getValue().dateString;if(ntfyStSf){if(pageID.find("#cfsselfstartnotify").show(),void 0===selfStDt)return;moment(selfStDt,dateFmt.toUpperCase()).isSame(currDt)&&ZPeople.Message.warning(ZPI18N.getString("zp.stdtnotifywarn"))}else pageID.find("#cfsselfstartnotify").hide()}else if("REVIEWER"===type){var ntfyStRev=pageID.find("#notifyStartRev").is(":checked"),revStDt=ZPeopleComponents.datefield(pageID.find("#revSchDate")).getValue().dateString;if(ntfyStRev){if(pageID.find("#cfsstartnotify").show(),void 0===revStDt)return;moment(revStDt,dateFmt.toUpperCase()).isSame(currDt)&&ZPeople.Message.warning(ZPI18N.getString("zp.stdtnotifywarn"))}else pageID.find("#cfsstartnotify").hide()}PMSSetting.onChangeShowResetSaveBtn()},onStartDayChange:function(event){var pageId=settingsPage.container,data=event.detail,selectedFreq=parseInt(ZPeopleComponents.select(pageId.find("#cfsFrequency")).getValue()),dataFetchFrom=parseInt(data.optionData.id);pageId.find("#cfsStartDayError").hide(),ZPeopleComponents.select(pageId.find("#cfsStartDay")).setAttributes({className:""}),selectedFreq===PMSCommon.MONTHLY?pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.ppnextmonth")):selectedFreq===PMSCommon.QUARTERLY?pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.smallnextquarter")):pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.samesixmth")),0===dataFetchFrom?(ZPeopleComponents.select(pageId.find("#cfsEndDay")).setValue(0),pageId.find("#cfsStartDayError").html(ZPI18N.getString("zp.startdayerror")).show(),ZPeopleComponents.select(pageId.find("#cfsStartDay")).setAttributes({className:"ztextbox__error"}),PMSSetting.constructHelpContent()):1===dataFetchFrom?(ZPeopleComponents.select(pageId.find("#cfsEndDay")).setValue([RSCONSTANTS.LASTDAY]),selectedFreq===PMSCommon.MONTHLY?(pageId.find("#cfsStartDayInfo").html(ZPI18N.getString("zp.smallofeverymonth")),pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.smallsamemonth"))):selectedFreq===PMSCommon.QUARTERLY?(pageId.find("#cfsStartDayInfo").html(ZPI18N.getString("zp.ofeveryquarter")),pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.smallsamequarter"))):(pageId.find("#cfsStartDayInfo").html(ZPI18N.getString("zp.everysixmth")),pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.samesixmth"))),PMSSetting.constructHelpContent()):(ZPeopleComponents.select(pageId.find("#cfsEndDay")).setValue([dataFetchFrom-1]),PMSSetting.validateDayInfo(PMSCommon.CFS_SELF),PMSSetting.validateDayInfo(PMSCommon.CFS_REVIEWER));var cfsDetail=PMSSetting.CFS_DATA.cfsDetail;(cfsDetail.hasOwnProperty("dataFetFrom")&&cfsDetail.dataFetFrom!=dataFetchFrom||!cfsDetail.hasOwnProperty("dataFetFrom"))&&PMSSetting.getSaveResetBtn(PMSSetting.CONTINUOUS_REVIEW)},constructHelpContent:function(){var pageID=settingsPage.container,selectedFreq=parseInt(ZPeopleComponents.select(pageID.find("#cfsFrequency")).getValue()),dataFetchFrom=isNaN(parseInt(ZPeopleComponents.select(pageID.find("#cfsStartDay")).getValue()))?0:parseInt(ZPeopleComponents.select(pageID.find("#cfsStartDay")).getValue()),dataFetchTo=isNaN(parseInt(ZPeopleComponents.select(pageID.find("#cfsEndDay")).getValue()))?0:parseInt(ZPeopleComponents.select(pageID.find("#cfsEndDay")).getValue()),selfRevEnable=ZPeopleComponents.toggleswitch(pageID.find("#saEnable")).getState(),selfStDt=ZPeopleComponents.datefield(pageID.find("#selfSchDate")).getValue().dateString,selfEndDay=isNaN(parseInt(pageID.find("#cfsSelfEndDay").val()))?0:parseInt(pageID.find("#cfsSelfEndDay").val()),revStDt=ZPeopleComponents.datefield(pageID.find("#revSchDate")).getValue().dateString,revEndDay=isNaN(parseInt(pageID.find("#cfsReviewEndDay").val()))?0:parseInt(pageID.find("#cfsReviewEndDay").val()),d=PMSSetting.getDate(),sf=d.clone();if(0!==dataFetchFrom&&selfRevEnable&&""!==selfStDt&&""!==selfEndDay&&0!==selfEndDay&&ZPUtil.Validation.isNumber(selfEndDay)){(sf=moment(selfStDt,dateFmt.toUpperCase())).isBefore(d)&&(sf=sf.add(1,"months"));var st=sf.clone();st=st.add(selfEndDay,"days");var a1=sf.date()+""+PMSSetting.getNumberSuffix(sf.date())+" of "+ZPDateTime.months_long[sf.month()],a2=st.date()+""+PMSSetting.getNumberSuffix(st.date())+" of "+ZPDateTime.months_long[st.month()],msg=ZPI18N.getString("zp.exselfreview",[a1,a2]);pageID.find("#giSlfRvwID").html(msg),PMSSetting.START_DATE_INFO=sf}else pageID.find("#giSlfRvwID").html(ZPI18N.getString("zp.exselfreviewdef"));if(0!==dataFetchFrom&&-1!==revStDt&&""!==revEndDay&&0!==revEndDay&&ZPUtil.Validation.isNumber(revEndDay)){var rf=sf.clone();rf=moment(revStDt,dateFmt.toUpperCase());var tDt=selfRevEnable?sf.clone():d.clone();rf.isBefore(tDt)&&(rf=rf.add(1,"months"));var rt=rf.clone();rt=rt.add(revEndDay,"days");a1=rf.date()+""+PMSSetting.getNumberSuffix(rf.date())+" of "+ZPDateTime.months_long[rf.month()],a2=rt.date()+""+PMSSetting.getNumberSuffix(rt.date())+" of "+ZPDateTime.months_long[rt.month()],msg=ZPI18N.getString("zp.exreviewconfig",[a1,a2]);pageID.find("#giRvwCngID").html(msg),selfRevEnable||(PMSSetting.START_DATE_INFO=rf)}else pageID.find("#giRvwCngID").html(ZPI18N.getString("zp.exreviewconfigdef"));var evalutionValue=ZPeopleComponents.tokenfield(pageID.find("#appraisalmodule")).getAllValues();if(0!==dataFetchFrom&&(selfRevEnable||void 0!==rf)&&evalutionValue.length>0){var df=selfRevEnable?sf.clone():rf.clone(),dfStDay=df.date(),f="",t="",dt=(df=df.set("date",dataFetchFrom)).clone();32!==dataFetchTo&&dfStDay<=dataFetchTo?(selectedFreq===PMSCommon.MONTHLY?df=df.add(-2,"months"):selectedFreq===PMSCommon.QUARTERLY?df=df.add(-4,"months"):selectedFreq===PMSCommon.HALF_YEARLY?df=df.add(-7,"months"):selectedFreq===PMSCommon.YEARLY&&(df=df.add(-13,"months")),f=df.date()+""+PMSSetting.getNumberSuffix(df.date())+" of "+ZPDateTime.months_long[df.month()],t=(dt=(dt=dt.set("date",dataFetchTo)).add(-1,"months")).date()+""+PMSSetting.getNumberSuffix(dt.date())+" of "+ZPDateTime.months_long[dt.month()]):(selectedFreq===PMSCommon.MONTHLY?df=df.add(-1,"months"):selectedFreq===PMSCommon.QUARTERLY?df=df.add(-3,"months"):selectedFreq===PMSCommon.HALF_YEARLY?df=df.add(-6,"months"):selectedFreq===PMSCommon.YEARLY&&(df=df.add(-12,"months")),f=df.date()+""+PMSSetting.getNumberSuffix(df.date())+" of "+ZPDateTime.months_long[df.month()],t="",32===dataFetchTo?selectedFreq===PMSCommon.MONTHLY?t=ZPI18N.getString("zp.lastday")+" of "+ZPDateTime.months_long[df.month()]:selectedFreq===PMSCommon.QUARTERLY?(dt=dt.add(-1,"months"),t=ZPI18N.getString("zp.lastday")+" of "+ZPDateTime.months_long[dt.month()]):selectedFreq===PMSCommon.HALF_YEARLY?(dt=dt.add(-1,"months"),t=ZPI18N.getString("zp.lastday")+" of "+ZPDateTime.months_long[dt.month()]):selectedFreq===PMSCommon.YEARLY&&(dt=dt.add(-1,"months"),t=ZPI18N.getString("zp.lastday")+" of "+ZPDateTime.months_long[dt.month()]):t=(dt=dt.set("date",dataFetchTo)).date()+""+PMSSetting.getNumberSuffix(dt.date())+" of "+ZPDateTime.months_long[dt.month()]);msg="";const goalComp=["GOALS","KRA_GOALS"];var selEval={};for(var json in evalutionValue){var data=evalutionValue[json];if(goalComp.includes(data.compName)){var displayName=data.name;"KRA_GOALS"===data.compName&&(displayName=PMSSetting.GOAL_DISPLAY_NAME,selEval[data.compName]=PMSSetting.KRA_DISPLAY_NAME),msg=ZPI18N.getString("zp.exfetchperiod",[displayName,f,t])}else selEval[data.compName]=data.name}var compName=PMSSetting.getEvalModuleList(selEval,!0);""!==compName&&(msg+=ZPI18N.getString("zp.fetchmoduleMsg",[compName])),pageID.find("#giFetPidID").html(msg)}else pageID.find("#giFetPidID").html(ZPI18N.getString("zp.exfetchperioddef",[PMSSetting.GOAL_DISPLAY_NAME,PMSSetting.GOAL_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME,PMSSetting.QUS_ANS_DISPLAY_NAME]))},getEvalModuleList:function(evalMethods,isHelpContent){var moduleMsg="",i=0;for(var evalMethodJson in evalMethods){var dispName="";"KRA_GOALS"!==evalMethodJson||isHelpContent?""!=evalMethods[evalMethodJson]?dispName=evalMethods[evalMethodJson]:"GOALS"===evalMethodJson||isHelpContent&&"KRA_GOALS"===evalMethodJson?dispName=PMSSetting.GOAL_DISPLAY_NAME:"KRA"===evalMethodJson?dispName=PMSSetting.KRA_DISPLAY_NAME:"COMPETENCY"===evalMethodJson?dispName=PMSSetting.COMPETENCY_DISPLAY_NAME:"QUS_ANS"===evalMethodJson&&(dispName=PMSSetting.QUS_ANS_DISPLAY_NAME):dispName=PMSSetting.GOAL_DISPLAY_NAME+", "+PMSSetting.KRA_DISPLAY_NAME,moduleMsg+=dispName;var moduleLen=Object.keys(evalMethods).length;i<moduleLen-2?moduleMsg+=", ":i<moduleLen-1&&(moduleMsg+=" and "),i+=1}return moduleMsg},validateDayInfo:function(type,showErrorMsg){var pageID=settingsPage.container,startDaySelect="",endDaySelect="",startDayError="",endDayError="",remDaysKey="";if(PMSSetting.constructHelpContent(),0===ZPeopleComponents.tokenfield(pageID.find("#appraisalmodule")).getAllValues().length)return showErrorMsg&&(pageID.find("#appraisalmoduleError").html(ZPI18N.getString("zp.emptyAppraisalModule")).show(),ZPeopleComponents.tokenfield(pageID.find("#appraisalmodule")).setAttributes({className:"ztextbox__error"})),!1;var fetchFromDay=isNaN(parseInt(ZPeopleComponents.select(pageID.find("#cfsStartDay")).getValue()))?0:parseInt(ZPeopleComponents.select(pageID.find("#cfsStartDay")).getValue());isNaN(parseInt(ZPeopleComponents.select(pageID.find("#cfsEndDay")).getValue()))||parseInt(ZPeopleComponents.select(pageID.find("#cfsEndDay")).getValue());if(0===fetchFromDay)return showErrorMsg&&(pageID.find("#cfsStartDayError").html(ZPI18N.getString("zp.startdayerror")).show(),ZPeopleComponents.select(pageID.find("#cfsStartDay")).setAttributes({className:"ztextbox__error"})),!1;type===PMSCommon.CFS_SELF?(startDayInfoID="cfsSelfStartDayInfo","cfsSelfEndDayInfo",endDaySelect="cfsSelfEndDay",startDaySelect="selfSchDate",startDayError="cfsSelfStartDayError",startDayDateField="selfSchDate",endDayError="cfsSelfEndDayError",startDayOpt="cfsSelfStartDayOpt",endDayOpt="cfsSelfEndDayOpt",remDaysKey="remSelfDays"):type===PMSCommon.CFS_REVIEWER&&(startDayInfoID="cfsReviewStartDayInfo","cfsReviewEndDayInfo",endDaySelect="cfsReviewEndDay",startDaySelect="revSchDate",startDayError="cfsReviewStartDayError",startDayDateField="revSchDate",endDayError="cfsReviewEndDayError",startDayOpt="cfsReviewStartDayOpt",endDayOpt="cfsReviewEndDayOpt",remDaysKey="remRevDays"),pageID.find("#"+startDayError).hide(),pageID.find("#"+endDayError).hide(),pageID.find("#"+endDaySelect).removeClass("ztextbox__error");var startDate=ZPeopleComponents.datefield(pageID.find("#"+startDaySelect)).getValue().dateString;if(void 0===startDate||""===startDate)return showErrorMsg&&(pageID.find("#"+startDayError).html(ZPI18N.getString("zp.holiday.dateerror")).show(),ZPeopleComponents.datefield("#"+startDayDateField).setAttributes({className:"ztextbox__error"})),!1;var selectedFreq=parseInt(ZPeopleComponents.select(pageID.find("#cfsFrequency")).getValue()),endDayVal=parseInt(pageID.find("#"+endDaySelect).val()),isCREndDayValid=!0;if(selectedFreq===PMSCommon.MONTHLY?isCREndDayValid=PMSSetting.validateCREndDays(showErrorMsg,endDaySelect,endDayError,endDayVal,29):selectedFreq===PMSCommon.QUARTERLY?isCREndDayValid=PMSSetting.validateCREndDays(showErrorMsg,endDaySelect,endDayError,endDayVal,86):selectedFreq===PMSCommon.HALF_YEARLY?isCREndDayValid=PMSSetting.validateCREndDays(showErrorMsg,endDaySelect,endDayError,endDayVal,176):selectedFreq===PMSCommon.YEARLY&&(isCREndDayValid=PMSSetting.validateCREndDays(showErrorMsg,endDaySelect,endDayError,endDayVal,351)),!isCREndDayValid)return!1;var diff=endDayVal,remDays=pageID.find("#"+remDaysKey),remSelectedDays=parseInt(ZPeopleComponents.select(pageID.find("#"+remDaysKey)).getValue());remDays.empty();var options=[];diff>3?(options.push({label:ZPI18N.getString("zp.wfon"),name:ZPI18N.getString("zp.wfon"),value:0,id:0}),options.push({label:ZPI18N.getString("zp.daily",new Array("")),name:ZPI18N.getString("zp.daily",new Array("")),value:PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS,id:PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS}),options.push({label:ZPI18N.getString("zp.onedaybefore",new Array("")),name:ZPI18N.getString("zp.onedaybefore",new Array("")),value:1,id:1}),options.push({label:ZPI18N.getString("zp.twodaybefore",new Array("")),name:ZPI18N.getString("zp.twodaybefore",new Array("")),value:2,id:2}),options.push({label:ZPI18N.getString("zp.threedaybefore",new Array("")),name:ZPI18N.getString("zp.threedaybefore",new Array("")),value:3,id:3})):3===diff?(options.push({label:ZPI18N.getString("zp.wfon"),name:ZPI18N.getString("zp.wfon"),value:0,id:0}),options.push({label:ZPI18N.getString("zp.daily",new Array("")),name:ZPI18N.getString("zp.daily",new Array("")),value:PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS,id:PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS}),options.push({label:ZPI18N.getString("zp.onedaybefore",new Array("")),name:ZPI18N.getString("zp.onedaybefore",new Array("")),value:1,id:1}),options.push({label:ZPI18N.getString("zp.twodaybefore",new Array("")),name:ZPI18N.getString("zp.twodaybefore",new Array("")),value:2,id:2}),3===remSelectedDays&&(remSelectedDays=0)):2===diff?(options.push({label:ZPI18N.getString("zp.wfon"),name:ZPI18N.getString("zp.wfon"),value:0,id:0}),options.push({label:ZPI18N.getString("zp.daily",new Array("")),name:ZPI18N.getString("zp.daily",new Array("")),value:PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS,id:PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS}),options.push({label:ZPI18N.getString("zp.onedaybefore",new Array("")),name:ZPI18N.getString("zp.onedaybefore",new Array("")),value:1,id:1}),3!==remSelectedDays&&2!==remSelectedDays||(remSelectedDays=0)):1===diff&&(options.push({label:ZPI18N.getString("zp.wfon"),name:ZPI18N.getString("zp.wfon"),value:0,id:0}),options.push({label:ZPI18N.getString("zp.daily",new Array("")),name:ZPI18N.getString("zp.daily",new Array("")),value:PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS,id:PMSCommon.CFS_DAILY_NOTIFY_CONSTANTS}),3!==remSelectedDays&&2!==remSelectedDays&&1!==remSelectedDays||(remSelectedDays=0)),ZPeopleComponents.select(pageID.find("#"+remDaysKey)).removeAllOptions(),ZPeopleComponents.select(pageID.find("#"+remDaysKey)).addOption(options);var cfsDetail=PMSSetting.CFS_DATA.cfsDetail;if(type===PMSCommon.CFS_SELF){var val=remSelectedDays;showErrorMsg||(val=void 0===cfsDetail.selfRemDays?0:cfsDetail.selfRemDays),ZPeopleComponents.select(pageID.find("#"+remDaysKey)).setValue([val])}else if(type===PMSCommon.CFS_REVIEWER){val=remSelectedDays;showErrorMsg||(val=void 0===cfsDetail.revRemDays?0:cfsDetail.revRemDays),ZPeopleComponents.select(pageID.find("#"+remDaysKey)).setValue([val])}return ZPeopleComponents.select(pageID.find("#"+remDaysKey)).setValue([val]),!0},validateCREndDays:function(showErrorMsg,endDaySelectId,errMsgId,endDayVal,maxEndDays){var pageID=settingsPage.container;return!(!ZPUtil.Validation.isNumber(endDayVal)||endDayVal<=0||endDayVal>=maxEndDays)||(showErrorMsg&&(pageID.find("#"+errMsgId).html(ZPI18N.getString("zp.enddayerror1",[maxEndDays-1])).show(),pageID.find("#"+endDaySelectId).addClass("ztextbox__error")),!1)},onChangeDayInfo:function(event){const inputValue=$(event.target).val(),inputId=$(event.target).attr("id"),cfsDetail=PMSSetting.CFS_DATA.cfsDetail;("cfsReviewEndDay"==inputId&&cfsDetail.hasOwnProperty("reviewerEndDay")&&cfsDetail.reviewerEndDay!=inputValue||!cfsDetail.hasOwnProperty("reviewerEndDay"))&&PMSSetting.onChangeShowResetSaveBtn(),("cfsSelfEndDay"==inputId&&cfsDetail.hasOwnProperty("selfEndDay")&&cfsDetail.selfEndDay!=inputValue||!cfsDetail.hasOwnProperty("selfEndDay"))&&PMSSetting.onChangeShowResetSaveBtn()},onEndDtKeyDown:function(val,evt,isCREndDay,isGoalNewJoineeDays,isGoalSettingPeriodDay){var charCode=evt.which?evt.which:evt.keyCode;if(isGoalNewJoineeDays=void 0!=isGoalNewJoineeDays&&isGoalNewJoineeDays,isGoalSettingPeriodDay=void 0!=isGoalSettingPeriodDay&&isGoalSettingPeriodDay,8===charCode||9===charCode||37===charCode||39===charCode)return!0;var value=val.value;return!(isCREndDay&&value.length>2||!isGoalSettingPeriodDay&&!isCREndDay&&!isGoalNewJoineeDays&&value.length>1)&&(!(isGoalNewJoineeDays&&value.length>3)&&(!(isGoalSettingPeriodDay&&value.length>2)&&(46!=charCode&&190!=charCode&&110!=charCode&&(void 0==charCode||!(charCode<48||charCode>57&&charCode<96||charCode>105)&&evt.key>="0"&&evt.key<="9"))))},onChangeCFSEvalutation:function(){var pageId=settingsPage.container;pageId.find("#appraisalmoduleError").hide(),ZPeopleComponents.tokenfield(pageId.find("#appraisalmodule")).setAttributes({className:""});var evalutionValue=ZPeopleComponents.tokenfield(pageId.find("#appraisalmodule")).getAllValues(),showPendingGoal=!1;if(evalutionValue.length>0){const goalComp=["GOALS","KRA_GOALS"];for(var json in evalutionValue){var data=evalutionValue[json];goalComp.includes(data.compName)&&(showPendingGoal=!0)}}showPendingGoal?pageId.find("#pendingGoalDiv").show():pageId.find("#pendingGoalDiv").hide(),PMSSetting.updateCRRtgEvalMethodsChange(),PMSSetting.constructHelpContent()},onChangeCFSFrequency:function(event){var data=event.detail,pageId=settingsPage.container,selectedFreq=parseInt(data.optionData.id);selectedFreq===PMSCommon.MONTHLY?(pageId.find("#cfsStartDayInfo").html(ZPI18N.getString("zp.smallofeverymonth")),pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.smallsamemonth"))):selectedFreq===PMSCommon.QUARTERLY?(pageId.find("#cfsStartDayInfo").html(ZPI18N.getString("zp.ofeveryquarter")),pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.smallsamequarter"))):selectedFreq===PMSCommon.HALF_YEARLY?(pageId.find("#cfsStartDayInfo").html(ZPI18N.getString("zp.everysixmth")),pageId.find("#cfsEndDayInfo").html(ZPI18N.getString("zp.samesixmth"))):selectedFreq===PMSCommon.YEARLY&&(pageId.find("[hide=yrlyFreq]").hide(),ZPeopleComponents.select("#cfsStartDay").setValue([1]),ZPeopleComponents.select("#cfsEndDay").setValue([32])),selectedFreq===PMSCommon.YEARLY||PMSSetting.isOnlyQusAnsInclude()||pageId.find("[hide=yrlyFreq]").show(),PMSSetting.constructHelpContent();var cfsDetail=PMSSetting.CFS_DATA.cfsDetail;(cfsDetail.hasOwnProperty("frequency")&&cfsDetail.frequency!=selectedFreq||!cfsDetail.hasOwnProperty("frequency"))&&PMSSetting.getSaveResetBtn(PMSSetting.CONTINUOUS_REVIEW)},dayOptions:function(skipNone,isStart,skipLastDay){var monthlyOpt=[];skipNone?monthlyOpt.push({name:ZPI18N.getString("zp.none"),id:0}):isStart?monthlyOpt.push({name:ZPI18N.getString("zp.select"),id:0}):monthlyOpt.push({name:ZPI18N.getString("zp.ppendday"),id:0});for(var i=1;i<=28;i++)monthlyOpt.push({name:i+PMSSetting.getNumberSuffix(i),id:i});return skipLastDay||monthlyOpt.push({name:ZPI18N.getString("zp.lastday"),id:RSCONSTANTS.LASTDAY}),monthlyOpt},monthOptions:function(isStart){var monthlyOpt=[];isStart?monthlyOpt.push({name:"Start Month",id:RSCONSTANTS.NONE}):monthlyOpt.push({name:"End Month",id:RSCONSTANTS.NONE});for(var i=0;i<12;i++)monthlyOpt.push({name:Calendar.months[i],id:i});return monthlyOpt},getNumberSuffix:function(num){if(-1===[11,12,13].indexOf(num)){var ss=num%10;switch(ss){case 1:case 2:case 3:return RSCONSTANTS.SUPERSCRIPT[ss+""];default:return RSCONSTANTS.SUPERSCRIPT[4]}}return RSCONSTANTS.SUPERSCRIPT[4]},onCFSSelfEnable:function(event){var pageId=settingsPage.container;ZPeopleComponents.toggleswitch(pageId.find("#saEnable")).getState()?(pageId.find("#cfsSelfMainDiv").show(),pageId.find("[name=hideSelfEx]").show(),pageId.find("#sfOnSbtSndMailDiv").show()):(pageId.find("#cfsSelfMainDiv").hide(),pageId.find("[name=hideSelfEx]").hide(),pageId.find("#sfOnSbtSndMail").prop("checked",!1),pageId.find("#cfsselfcompletenotify").hide(),pageId.find("#sfOnSbtSndMailDiv").hide()),PMSSetting.constructHelpContent()},onReminderChange:function(type){var pageID=settingsPage.container,notifyID="notifyRemRev",remDaysID="remRevDays",notifyTmpltType="cfspendingnotify";type===PMSCommon.CFS_SELF&&(notifyID="notifyRemSelf",remDaysID="remSelfDays",notifyTmpltType="cfsselfpendingnotify");var isEnable=pageID.find("#"+notifyID).prop("checked");ZPeopleComponents.select(pageID.find("#"+remDaysID)).setAttributes({disabled:!isEnable}),isEnable?pageID.find("#"+notifyTmpltType).show():pageID.find("#"+notifyTmpltType).hide(),PMSSetting.onChangeShowResetSaveBtn()},onSelfPublishChange:function(type){var pageID=settingsPage.container,notifyTmpltType="cfspublishnotify",notifyId="onPubSndMail";type===PMSCommon.CFS_SELF&&(notifyTmpltType="cfsselfcompletenotify",notifyId="sfOnSbtSndMail"),pageID.find("#"+notifyId).is(":checked")?pageID.find("#"+notifyTmpltType).show():pageID.find("#"+notifyTmpltType).hide(),PMSSetting.onChangeShowResetSaveBtn()},CFSSelectDestroy:function(){const pageId=settingsPage.container;[{selector:"cfsFrequency",method:"select"},{selector:"cfsStartDay",method:"select"},{selector:"cfsEndDay",method:"select"},{selector:"cfsReviewer",method:"select"},{selector:"remRevDays",method:"select"},{selector:"remSelfDays",method:"select"},{selector:"crRatingType",method:"select"},{selector:"numberRateMin",method:"select"},{selector:"numberRate",method:"select"},{selector:"appraisalmodule",method:"tokenfield"},{selector:"crPubAuthID",method:"tokenfield"}].forEach(compObj=>{let elem=pageId.find("#"+compObj.selector);ZPeopleComponents.isComponent(elem)&&ZPeopleComponents[compObj.method](elem).destroy()}),pageId.find("select[type=keyFld], select[type=valFld]").each(function(){ZPeopleComponents.isComponent($(this))&&ZPeopleComponents.select($(this)).destroy()})},onChangeShowResetSaveBtn:function(){PMSSetting.getSaveResetBtn(PMSSetting.CONTINUOUS_REVIEW)},CFSReset:function(){var pageId=settingsPage.container;PMSSetting.CFSSelectDestroy(),pageId.html(""),null===PMSSetting.ON_LOAD_CR_SET_PAGE&&$.ajax({type:"POST",async:!1,url:"/performance/view/continuousReview",data:{conreqcsr:csrfToken},success:function(resultData){PMSSetting.ON_LOAD_CR_SET_PAGE=resultData}}),pageId.append(PMSSetting.ON_LOAD_CR_SET_PAGE),pageId.find("#nonAppliDiv").html(PMSSetting.ADD_EXCEP_BT),PMSSetting.defaultAction(PMSSetting.CFS_DATA)},getCRApplicableObj:function(){let returnObj={};var pageId=settingsPage.container,tabId=settingsPage.tabId;let isCRConfigurationPage=PMSSetting.isCRConfigurationPage();var gId="";return"#settings-service-performance-goal"===tabId&&(gId="goal_"),pageId.find("#"+gId+"condtInnerDiv .addCondtTemp").each(function(){let k=ZPeopleComponents.select($(this).find("select[type=keyFld]")).getValue(),v=ZPeopleComponents.select($(this).find("select[type=valFld]")).getValue();0===v.length&&(v=["-1"]),"APPL_DEP"===k?returnObj.Departments={mode:1,list:v}:"APPL_DES"===k?returnObj.Designations={mode:1,list:v}:"APPL_LOC"===k?returnObj.Locations={mode:1,list:v}:"APPL_ROLE"===k?returnObj.Roles={mode:1,list:v}:"APPL_EMP_TYPE"===k&&isCRConfigurationPage&&(returnObj.EmployeeTypes={mode:1,list:v})}),pageId.find("#"+gId+"nonCondtInnerDiv .addNonCondtTemp").each(function(){let k=ZPeopleComponents.select($(this).find("select[type=keyFld]")).getValue(),v=ZPeopleComponents.select($(this).find("select[type=valFld]")).getValue();0===v.length&&(v=["-1"]),"APPL_DEP"===k?returnObj.Departments={mode:0,list:v}:"APPL_DES"===k?returnObj.Designations={mode:0,list:v}:"APPL_LOC"===k?returnObj.Locations={mode:0,list:v}:"APPL_ROLE"===k?returnObj.Roles={mode:0,list:v}:"APPL_EMP_TYPE"===k&&isCRConfigurationPage&&(returnObj.EmployeeTypes={mode:0,list:v})}),returnObj},saveContinuousReview:function(deleteFlag,chkPrevDataFlag,chkFutPopDataFlag){var pageID=settingsPage.container,cfsID=pageID.find("#caConfigID").attr("cfsid");if(!deleteFlag&&void 0!==cfsID&&PMSSetting.CFS_DATA.cfsDetail.cfsEnable)return void PMSSetting.updateSetting();var params={mode:"saveCFS"};deleteFlag?(params.chkPrevDataFlag=!1,params.chkFutPopDataFlag=chkFutPopDataFlag):(params.chkPrevDataFlag=chkPrevDataFlag,params.chkFutPopDataFlag=!1);var isEnable=!deleteFlag,selfRevEnable=ZPeopleComponents.toggleswitch(pageID.find("#saEnable")).getState(),isValid=!0;if(isEnable){isValid=!selfRevEnable||PMSSetting.validateDayInfo(PMSCommon.CFS_SELF,!0);var isRevValid=PMSSetting.validateDayInfo(PMSCommon.CFS_REVIEWER,!0);isValid=isValid?isRevValid:isValid}else isValid=!0;let isRtgEnabled=!1,isCmtEnabled=!1;if(isEnable){if(pageID.find("#crRating").is(":visible")&&(isRtgEnabled=pageID.find("#crRating").is(":checked")),pageID.find("#crComment").is(":visible")&&(isCmtEnabled=pageID.find("#crComment").is(":checked")),PMSSetting.isOnlyQusAnsInclude(!0)&&!isCmtEnabled)return void ZPeople.Message.warning(ZPI18N.getString("zp.enablecommentqusans",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME)));if(!isRtgEnabled&&!isCmtEnabled)return void ZPeople.Message.warning(ZPI18N.getString("zp.crchooseratingtype"))}(params.cfsEnable=isEnable,isEnable)&&("-1"===(reviewer=ZPeopleComponents.select(pageID.find("#cfsReviewer")).getValue())||null===reviewer||void 0===reviewer?(pageID.find("#cfsReviewerError").html(ZPI18N.getString("zp.selectReviewer")).show(),ZPeopleComponents.select(pageID.find("#cfsReviewer")).setAttributes({className:"ztextbox__error"}),isValid=!1):(pageID.find("#cfsReviewerError").hide(),ZPeopleComponents.select(pageID.find("#cfsReviewer")).setAttributes({className:""})),isValid=(isValid=isValid&&selfRevEnable?PMSSetting.selfCalStDt():isValid)?PMSSetting.revCalStDt():isValid);(pageID.find("#textRatingValue .ztextbox--error__label").remove(),pageID.find("textRatingValue [elem=textrow] input").removeClass("ztextbox__error"),isEnable&&isRtgEnabled&&"textRating"==ZPeopleComponents.select(pageID.find("#crRatingType")).getValue())&&pageID.find("#textRatingValue").find("[elem=textrow]").each(function(index){var ratingName=$(this).children(".zpl_rwfld").children("input").val();if(""==ratingName){var ratingerr='<span class="ztextbox--error__label"  id="addRatingErrormsg">'+ZPI18N.getString("zp.ratingmandatory")+"</span>";$(this).find("input").after(ratingerr),$(this).find("input").addClass("ztextbox__error"),isValid=!1}else if(ratingName.length>50){ratingerr='<span class="ztextbox--error__label"  id="addRatingErrormsg">'+ZPI18N.getString("zp.ratinglengtherror")+"</span>";$(this).find("input").after(ratingerr),$(this).find("input").addClass("ztextbox__error"),isValid=!1}});let isCmtMdty=pageID.find("#crCmtMdty").is(":checked");var minCmtLen=Number(pageID.find("#crMinCmtLen").val());if(pageID.find("#cmtRatingErrorMsg").html(""),pageID.find("#cmtRatingErrorMsg").hide(),pageID.find("#crMinCmtLen").removeClass("ztextbox__error"),isEnable&&isCmtEnabled&&isCmtMdty&&""!=minCmtLen&&(isNaN(minCmtLen)?(pageID.find("#crMinCmtLen").addClass("ztextbox__error"),pageID.find("#cmtRatingErrorMsg").html(ZPI18N.getString("zp.fieldupdate.numbererror")),pageID.find("#cmtRatingErrorMsg").show(),isValid=!1):minCmtLen<0?(pageID.find("#crMinCmtLen").addClass("ztextbox__error"),pageID.find("#cmtRatingErrorMsg").html(ZPI18N.getString("zp.cycle.errormsg.mincmtlengthgreaterthan",[0])),pageID.find("#cmtRatingErrorMsg").show(),isValid=!1):minCmtLen>1e3&&(pageID.find("#crMinCmtLen").addClass("ztextbox__error"),pageID.find("#cmtRatingErrorMsg").html(ZPI18N.getString("zp.cycle.errormsg.mincmtlengthlesserthan",[1e3])),pageID.find("#cmtRatingErrorMsg").show(),isValid=!1)),isValid){if(isEnable){var appFor=PMSSetting.getCRApplicableObj(),apprComp=ZPeopleComponents.tokenfield(pageID.find("#appraisalmodule")).getAllValues(),evaluComp=[];for(var json in apprComp){var data=apprComp[json];evaluComp.push(data.id)}var selfStartDay,selfStartDt,selfEndDay,frequency=parseInt(ZPeopleComponents.select(pageID.find("#cfsFrequency")).getValue()),dataFetchFrom=isNaN(parseInt(ZPeopleComponents.select(pageID.find("#cfsStartDay")).getValue()))?0:parseInt(ZPeopleComponents.select(pageID.find("#cfsStartDay")).getValue()),dataFetchTo=isNaN(parseInt(ZPeopleComponents.select(pageID.find("#cfsEndDay")).getValue()))?0:parseInt(ZPeopleComponents.select(pageID.find("#cfsEndDay")).getValue()),pastGoalChk=!0;PMSSetting.CFS_DATA.showIncludePending&&(pastGoalChk=pageID.find("#pastGoalChk").is(":checked"));var notifyStartSelf,notifyRemSelf,selfRemDays=0;if(selfRevEnable)selfStartDt=ZPeopleComponents.datefield(pageID.find("#selfSchDate")).getValue().dateString,selfStartDay=Calendar.parseDate(selfStartDt,uidateFormat).getDate(),selfEndDay=parseInt(pageID.find("#cfsSelfEndDay").val()),notifyStartSelf=pageID.find("#notifyStartSelf").is(":checked"),(notifyRemSelf=pageID.find("#notifyRemSelf").is(":checked"))&&(selfRemDays=parseInt(ZPeopleComponents.select(pageID.find("#remSelfDays")).getValue()));var revStartDate=ZPeopleComponents.datefield(pageID.find("#revSchDate")).getValue().dateString,reviewerStartDay=Calendar.parseDate(revStartDate,uidateFormat).getDate(),reviewerEndDay=parseInt(pageID.find("#cfsReviewEndDay").val()),notifyStartRev=pageID.find("#notifyStartRev").is(":checked"),notifyRemRev=pageID.find("#notifyRemRev").is(":checked"),revRemDays=0;notifyRemRev&&(revRemDays=parseInt(ZPeopleComponents.select(pageID.find("#remRevDays")).getValue()));var sfOnSbtSndMail=!!selfRevEnable&&pageID.find("#sfOnSbtSndMail").is(":checked"),onPubSndMail=pageID.find("#onPubSndMail").is(":checked"),reviewer=ZPeopleComponents.select(pageID.find("#cfsReviewer")).getValue();let pubOwner=ZPeopleComponents.tokenfield(pageID.find("#crPubAuthID")).getAllValues(),pubOwnerObj={reportingTo:!1,finalizer:!1};for(let pubItr in pubOwner)1==pubOwner[pubItr].id&&(pubOwnerObj.finalizer=!0);var cfsSettObj={};cfsSettObj.applicableFor=appFor,cfsSettObj.frequency=frequency,cfsSettObj.dataFetFrom=dataFetchFrom,cfsSettObj.dataFetTo=dataFetchTo,cfsSettObj.pastGoalEnable=pastGoalChk,cfsSettObj.selfRevEnable=selfRevEnable,selfRevEnable&&(cfsSettObj.selfStartDay=selfStartDay,cfsSettObj.selfStartDate=selfStartDt,cfsSettObj.selfEndDay=selfEndDay,cfsSettObj.notifyStartSelf=notifyStartSelf,cfsSettObj.notifyRemSelf=notifyRemSelf,cfsSettObj.selfRemDays=selfRemDays),cfsSettObj.reviewerStartDay=reviewerStartDay,cfsSettObj.reviewerStartDate=revStartDate,cfsSettObj.reviewerEndDay=reviewerEndDay,cfsSettObj.notifyStartRev=notifyStartRev,cfsSettObj.notifyRemRev=notifyRemRev,cfsSettObj.revRemDays=revRemDays,cfsSettObj.selfOnSubmitSendMail=sfOnSbtSndMail,cfsSettObj.onPubSndMail=onPubSndMail,cfsSettObj.reviewer=reviewer,cfsSettObj.appraisalmodule=evaluComp,cfsSettObj.isCommentEnabled=isCmtEnabled,cfsSettObj.publishers=pubOwnerObj,PMSSetting.isNoticePeriodEmp()&&(cfsSettObj.excludeNoticEmp=pageID.find("#excludeCRNoticEmp").is(":checked")),PMSSetting.isProbationPeriodEmp()&&(cfsSettObj.excludeProbEmp=pageID.find("#excludeCRProbEmp").is(":checked")),params.cfsSetting=JSON.stringify(cfsSettObj);var ratingType={};isRtgEnabled&&("numberRating"==ZPeopleComponents.select(pageID.find("#crRatingType")).getValue()&&(ratingType.type=1,ratingType.max=ZPeopleComponents.select(pageID.find("#numberRate")).getValue(),ratingType.min=ZPeopleComponents.select(pageID.find("#numberRateMin")).getValue()),"textRating"==ZPeopleComponents.select(pageID.find("#crRatingType")).getValue()&&(ratingType.type=2,ratingType.max=PMSSetting.textrating_name.length,ratingType.textRatingName=PMSSetting.textrating_name,ratingType.textRatingValue=PMSSetting.textrating_value)),ratingType.isCommentsMandatory=isCmtMdty,isCmtEnabled&&isCmtMdty&&""!=minCmtLen&&(ratingType.minCommentLength=minCmtLen),params.ratingTypeJSON=JSON.stringify(ratingType)}pageID.find("#CONTINUOUS_REVIEW_SAVERESET [type=button]").attr("disabled","disabled");var otherDet={isDeleteAction:deleteFlag,chkFutPopDataFlag:chkFutPopDataFlag};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,PMSSetting.afterSave,otherDet,PMSSetting.saveCRFailureCallBack)}else ZPeople.Message.warning(ZPI18N.getString("zp.checkinputs"))},saveCRFailureCallBack:function(){settingsPage.container.find("#CONTINUOUS_REVIEW_SAVERESET [type=button]").removeAttr("disabled","disabled")},afterSave:function(data,params,otherDet){if(settingsPage.container.find("#CONTINUOUS_REVIEW_SAVERESET [type=button]").removeAttr("disabled","disabled"),otherDet.chkFutPopDataFlag)null!=data&&data.futPopDataFlag?PMSSetting.futPopDataInfo():PMSSetting.deleteCRCongiurationInfo();else if(null!=data&&data.isPrevDataFlag)PMSSetting.prevDataInfo(data);else if(null!=data&&"SUCCESS"===data.msg){otherDet.isDeleteAction?ZPeople.Message.success(ZPI18N.getString("zp.lite.reportsdisablesuccess",new Array(ZPI18N.getString("zp.settings")))):otherDet.updateFlag?ZPeople.Message.success(ZPI18N.getString("zp.settingupdatesuccess")):ZPeople.Message.success(ZPI18N.getString("zp.ttsettingssaved")),PMSSetting.CFS_DATA=data;var isEnable=PMSSetting.CFS_DATA.cfsDetail.cfsEnable;PMSSetting.POPULATE_PAST_DATE_FLAG=data.isEmptyData,PMSSetting.CFSReset(),!otherDet.updateFlag&&isEnable&&PMSSetting.POPULATE_PAST_DATE_FLAG&&PMSSetting.populatePastDateInfo()}else null!=data&&"Appraisal_Modules_DISABLED"===data.msg?ZPeople.Message.failure(ZPI18N.getString("zp.goalsdisabled")):void 0!==data.errorList&&-1!=data.errorList.indexOf("NO_USER_APPLICABLE")?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.noUserAppliCR")):ZPeople.Message.failure(ZPI18N.getString("zp.invcase3",[ZPeople.peopleSupportEmail]))},deleteCRCongiurationInfo:function(){var deletePopUp=new DeleteAlertMessage;deletePopUp.title="Disable review configuration",deletePopUp.despcription=ZPI18N.getString("zp.contideletepop"),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){PMSSetting.saveContinuousReview(!0,!1,!1)},deletePopUp.setCloseCallback(function(){let pageId=settingsPage.container;ZPeopleComponents.toggleswitch(pageId.find("#tg_continousreview")).switchOn()}),deletePopUp.show()},futPopDataInfo:function(){var infoPopUp=new InfoAlertMessage;infoPopUp.title=ZPI18N.getString("zp.deleteconfigandstopreviewtitle"),infoPopUp.despcription=ZPI18N.getString("zp.deleteconfigandstopreviewdesc"),infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.close"),infoPopUp.callback=function(){PMSSetting.deleteCRCongiurationInfo()},infoPopUp.setCloseCallback(function(){let pageId=settingsPage.container;ZPeopleComponents.toggleswitch(pageId.find("#tg_continousreview")).switchOn()}),infoPopUp.show()},prevDataInfo:function(data){var txt=ZPI18N.getString("zp.crsamemthinfo",[moment(data.fetFrmDt,"YYYY-MM-DD").format(dateFmt.toUpperCase()),moment(data.fetToDt,"YYYY-MM-DD").format(dateFmt.toUpperCase())]),infoPopUp=new InfoAlertMessage;infoPopUp.title=ZPI18N.getString("zp.crdiscardtitle"),infoPopUp.despcription=txt,infoPopUp.yesButtonText="",infoPopUp.cancelButtonText=ZPI18N.getString("zp.close"),infoPopUp.callback=function(){PMSSetting.saveContinuousReview(!1,!1,!1)},infoPopUp.show()},populatePastDateInfo:function(){if(PMSSetting.constructHelpContent(),void 0!==PMSSetting.START_DATE_INFO){var dt=PMSSetting.START_DATE_INFO,tempStDt=new Date(dt.year(),dt.month(),dt.date()),infoPopUp=new InfoAlertMessage,evalModuleList=PMSSetting.getEvalModuleList(PMSSetting.CFS_DATA.cfsDetail.appraisalModule,!1);infoPopUp.title=ZPI18N.getString("zp.confirm"),infoPopUp.despcription=ZPI18N.getString("zp.cfspastdatepop",[Calendar.formatDate(tempStDt),evalModuleList]),infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){PMSSetting.populatePastDate()},infoPopUp.show()}},populatePastDate:function(){ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"populatePastDate"},function(returnData){void 0!==returnData&&"SUCCESS"===returnData.MSG?(PMSSetting.POPULATE_PAST_DATE_FLAG=!1,PMSSetting.CFSReset(),ZPeople.Message.success(ZPI18N.getString("zp.pastpopsuccmsg")),window.location.reload()):ZPeople.Message.failure(ZPI18N.getString("zp.pastpopfailmsg"))})},updateSetting:function(){var pageID=settingsPage.container,cfsID=pageID.find("#caConfigID").attr("cfsid");if(void 0!==cfsID){var params={mode:"updateCFS",chkPrevDataFlag:!1},isEnable=ZPeopleComponents.toggleswitch(pageID.find("#tg_continousreview")).getState(),selfRevEnable=ZPeopleComponents.toggleswitch(pageID.find("#saEnable")).getState(),isValid=!0;if(isEnable){isValid=!selfRevEnable||PMSSetting.validateDayInfo(PMSCommon.CFS_SELF,!0);var isRevValid=PMSSetting.validateDayInfo(PMSCommon.CFS_REVIEWER,!0);isValid=isValid?isRevValid:isValid}else isValid=!0;if(params.cfsEnable=isEnable,isEnable)"-1"!==(reviewer=ZPeopleComponents.select(pageID.find("#cfsReviewer")).getValue())&&null!==reviewer&&void 0!==reviewer||(ZPeople.Message.failure(ZPI18N.getString("zp.selectReviewer")),isValid=!1);if(isValid){if(isEnable){var selfStartDay,selfStartDt,selfEndDay,appFor=PMSSetting.getCRApplicableObj(),frequency=parseInt(ZPeopleComponents.select(pageID.find("#cfsFrequency")).getValue()),dataFetchFrom=parseInt(pageID.find("#cfsStartDay").val()),dataFetchTo=parseInt(pageID.find("#cfsEndDay").val()),pastGoalChk=!0;PMSSetting.CFS_DATA.showIncludePending&&(pastGoalChk=pageID.find("#pastGoalChk").is(":checked"));var notifyStartSelf,notifyRemSelf,selfRemDays=0;if(selfRevEnable)selfStartDt=ZPeopleComponents.datefield("#selfSchDate").getValue().dateString,selfStartDay=Calendar.parseDate(selfStartDt,uidateFormat).getDate(),selfEndDay=parseInt(pageID.find("#cfsSelfEndDay").val()),notifyStartSelf=pageID.find("#notifyStartSelf").is(":checked"),(notifyRemSelf=pageID.find("#notifyRemSelf").is(":checked"))&&(selfRemDays=parseInt(ZPeopleComponents.select(pageID.find("#remSelfDays")).getValue()));var revStartDate=ZPeopleComponents.datefield("#revSchDate").getValue().dateString,reviewerStartDay=Calendar.parseDate(revStartDate,uidateFormat).getDate(),reviewerEndDay=parseInt(pageID.find("#cfsReviewEndDay").val()),notifyStartRev=pageID.find("#notifyStartRev").is(":checked"),notifyRemRev=pageID.find("#notifyRemRev").is(":checked"),revRemDays=0;notifyRemRev&&(revRemDays=parseInt(ZPeopleComponents.select(pageID.find("#remRevDays")).getValue()));var sfOnSbtSndMail=!!selfRevEnable&&pageID.find("#sfOnSbtSndMail").is(":checked"),onPubSndMail=pageID.find("#onPubSndMail").is(":checked"),reviewer=ZPeopleComponents.select(pageID.find("#cfsReviewer")).getValue();let pubOwner=ZPeopleComponents.tokenfield(pageID.find("#crPubAuthID")).getAllValues(),pubOwnerObj={reportingTo:!1,finalizer:!1};for(let pubItr in pubOwner)1==pubOwner[pubItr].id&&(pubOwnerObj.finalizer=!0);var cfsSettObj={};cfsSettObj.cfsID=cfsID,cfsSettObj.applicableFor=appFor,cfsSettObj.frequency=frequency,cfsSettObj.dataFetFrom=dataFetchFrom,cfsSettObj.dataFetTo=dataFetchTo,cfsSettObj.pastGoalEnable=pastGoalChk,cfsSettObj.selfRevEnable=selfRevEnable,selfRevEnable&&(cfsSettObj.selfStartDay=selfStartDay,cfsSettObj.selfStartDate=selfStartDt,cfsSettObj.selfEndDay=selfEndDay,cfsSettObj.notifyStartSelf=notifyStartSelf,cfsSettObj.notifyRemSelf=notifyRemSelf,cfsSettObj.selfRemDays=selfRemDays),cfsSettObj.reviewerStartDay=reviewerStartDay,cfsSettObj.reviewerStartDate=revStartDate,cfsSettObj.reviewerEndDay=reviewerEndDay,cfsSettObj.notifyStartRev=notifyStartRev,cfsSettObj.notifyRemRev=notifyRemRev,cfsSettObj.revRemDays=revRemDays,cfsSettObj.selfOnSubmitSendMail=sfOnSbtSndMail,cfsSettObj.onPubSndMail=onPubSndMail,cfsSettObj.reviewer=reviewer,cfsSettObj.publishers=pubOwnerObj,params.cfsSetting=JSON.stringify(cfsSettObj)}pageID.find("#CONTINUOUS_REVIEW_SAVERESET [type=button]").attr("disabled","disabled");ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,PMSSetting.afterSave,{updateFlag:!0},PMSSetting.saveCRFailureCallBack)}else ZPeople.Message.warning(ZPI18N.getString("zp.checkinputs"))}},beforeDataDelete:function(){var deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.crcfmmsg1title"),deletePopUp.despcription=ZPI18N.getString("zp.crcfmmsg1"),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=PMSSetting.finalConfirmation,deletePopUp.show()},finalConfirmation:function(){var deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.crfinaldeltitle"),deletePopUp.despcription=ZPI18N.getString("zp.crfinaldelmsg"),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=PMSSetting.deleteDataAndConfig,deletePopUp.show()},deleteDataAndConfig:function(){ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"deleteCRDataAndConfig"},PMSSetting.afterDelete)},afterDelete:function(data){if("SUCCESS"===data.msg){ZPeople.Message.success(ZPI18N.getString("zp.deletesuccessful")),PMSSetting.CFS_DATA=data;PMSSetting.CFS_DATA.cfsDetail.cfsEnable;PMSSetting.CFSReset()}else"FAILURE"===data.msg?ZPeople.Message.failure(ZPI18N.getString("zp.serrviceconflict.people_failure")):"PERMISSION_DENIED"===data.msg&&ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied"))},showHideCRNotifyTmpl:function(typeName){PMSSetting.crEmPrevCard={};var tab=new Tab;if(tab.id="cremprevcard",tab.cardId="crremprevcardslider",tab.validate=PMSSetting.updateCRNotficationTmpl,PMSSetting.curNotifiTmplType=typeName,PMSSetting.crEmPrevCard=new sliderModal(ZPI18N.getString("zp.emailtemplate"),tab),PMSSetting.crEmPrevCard.mediumSize=!0,PMSSetting.crEmPrevCard.construct(),PMSSetting.crEmPrevCard.setCloseCallback(function(){ZPA_Editor.destroy(),PMSSetting.crEmPrevCard.remove(),PMSSetting.crEmPrevCard={}}),PMSSetting.crEmPrevCard.sliderDiv.find("#crremprevcardslider").append(ZPeople.LOADING_HTML),PMSSetting.CFS_Notify_Tmpl.hasOwnProperty(PMSSetting.curNotifiTmplType))PMSSetting.constructCRNotifyTemplate();else{var params={mode:"getCFSNotificationTemplate",submode:PMSSetting.curNotifiTmplType};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resp){PMSSetting.CFS_Notify_Tmpl[PMSSetting.curNotifiTmplType]=resp,PMSSetting.constructCRNotifyTemplate()})}},constructCRNotifyTemplate:function(){if(null===PMSSetting.CFS_Notify_Tmpl[PMSSetting.curNotifiTmplType]||void 0===PMSSetting.CFS_Notify_Tmpl[PMSSetting.curNotifiTmplType])return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror")),void PMSSetting.crEmPrevCard.close();var _editHtm='<div class="zpl_crd" id="crTmplSubj"><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.subject")+'</label></div><div><input type="text" id="crSubject" placeholder="" value="'+ZSEC.Encoder.encodeForHTMLAttribute(PMSSetting.CFS_Notify_Tmpl[PMSSetting.curNotifiTmplType].subject)+'" class="ztextbox"></div></div>';_editHtm+="</div></div>",_editHtm+='<div class="zpl_crd" id="crem_message"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.message")+'</h4></div></div><div class="zpl_crdcnt">',_editHtm+='<div class="zpl_secn" style="display: none;"><div><div class="zpl_msgedtr" id="msgEditor"></div></div></div>',_editHtm+='<div class="zpl_secn" style="display: none;"><div style="display: none;" id="msgTemplate" class="zpl_msgedtr"></div></div>',_editHtm+="</div></div>",PMSSetting.crEmPrevCard.sliderDiv.find("#crremprevcardslider").html(""),PMSSetting.crEmPrevCard.sliderDiv.find("#crremprevcardslider").append($(_editHtm)),PMSSetting.crEmPrevCard.sliderDiv.find("#msgEditor").parent().parent().show(),PMSSetting.crEmPrevCard.sliderDiv.find("#msgEditor").show(),ZPA_Editor.initiateEditor(PMSSetting.CFSTemplateMode,void 0,PMSSetting.CFS_Notify_Tmpl[PMSSetting.curNotifiTmplType].template,PMSSetting.PA_Editor_Id+PMSSetting.CFSTemplateMode)},updateCRNotficationTmpl:function(){var pageId=settingsPage.container,params={mode:"updateCFSNotificationTemplate"};params.submode=PMSSetting.curNotifiTmplType;var subject=void 0!=pageId.find("#crSubject").val()?pageId.find("#crSubject").val().trim():"";if(PMSSetting.CFS_Notify_Tmpl[PMSSetting.curNotifiTmplType].subject.trim()!=subject){if(""==subject)return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.msgsubjectnotempty"));params.subject=subject}var template=editor.getContent();"<div><br></div>"===template||ZPUtil.Validation.isEmpty($(template).text())?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.abstemplateempty")):template.length>1e5?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.lengthofmessage")):(params.template=template,ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(respdata){"success"==respdata.msg?(PMSSetting.CFS_Notify_Tmpl[PMSSetting.curNotifiTmplType]=respdata.data,ZPeople.Message.success(ZPI18N.getString("zp.updatesuccessful")),PMSSetting.crEmPrevCard.close()):(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.msgsubjectnotempty")),PMSSetting.crEmPrevCard.close())}))},getCRSystemFields:function(){var fieldObj={System_Fields:{},System_Fields:{System_Fields:{}}},sysFields=fieldObj.System_Fields,type=PMSSetting.curNotifiTmplType;return"cfsstartnotify"!==type&&"cfspendingnotify"!==type&&(sysFields.System_Fields.Appraisee_Name=ZPI18N.getString("zp.appraiseename"),"cfsselfcompletenotify"!==type&&"cfspublishnotify"!==type&&(sysFields.System_Fields.Self_Start_Date=ZPI18N.getString("zp.selfstartdate"),sysFields.System_Fields.Self_End_Date=ZPI18N.getString("zp.selfenddate"))),"cfsselfstartnotify"!==type&&"cfsselfpendingnotify"!==type&&(sysFields.System_Fields.Appraiser_Name=ZPI18N.getString("zp.local.Appraiser")+" "+ZPI18N.getString("zp.name"),"cfspublishnotify"!==type&&(sysFields.System_Fields.Review_Start_Date=ZPI18N.getString("zp.local.ReviewStartDate"),sysFields.System_Fields.Review_End_Date=ZPI18N.getString("zp.local.ReviewEndDate"))),sysFields.System_Fields.Cycle_Start_Date=ZPI18N.getString("zp.cyclestartdate"),sysFields.System_Fields.Cycle_End_Date=ZPI18N.getString("zp.cycleenddate"),fieldObj},appraisalTemplateInitLoadFile:function(){PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)&&Layout.PageUtil.loadFiles(["approvalv5.min.js"],PMSSetting.appraisalTemplateInit)},appraisalTemplateInit:function(notReload){PMSOperationCommon.addClearCentreClass(!0),notReload||PMSSetting.getSelPerformanceModules(!0),PMSTmpl.destroyTmplPageComponents();var pageId=settingsPage.container;null===PMSSetting.ON_LOAD_TMPL_LST_PAGE&&$.ajax({type:"POST",async:!1,url:"/performance/view/appraisalTemplatePage",data:{conreqcsr:csrfToken},success:function(resultData){PMSSetting.ON_LOAD_TMPL_LST_PAGE=resultData}}),pageId.html(PMSSetting.ON_LOAD_TMPL_LST_PAGE),pageId.find("#tmplPopUpDiv").removeClass("zpl_mopen"),PMSSetting.cartConstructTmplListPage()},openTmplPopUp:function(){var pageId=settingsPage.container;pageId.find("#popTmplNme").hasClass("ztextbox__error")&&(pageId.find("#popTmplNme").removeClass("ztextbox__error"),pageId.find("#popTmplNme").parent().find("[elem=errorMsg]").remove()),pageId.find("#tmplPopUpDiv").addClass("zpl_mopen"),PMSV2Cycle.prerequisiteData(!1),pageId.find("#popTmplNme").focus(),PMSV2Cycle.isPARatingEnabled||pageId.find("#poptmplnormTglBtnFstCrtDiv").hide()},closeTmplPopUp:function(){settingsPage.container.find("#tmplPopUpDiv").removeClass("zpl_mopen")},createTmplFrmPopUp:function(){let pageId=settingsPage.container;pageId.find("#popTmplNme").hasClass("ztextbox__error")&&(pageId.find("#popTmplNme").removeClass("ztextbox__error"),pageId.find("#popTmplNme").parent().find("[elem=errorMsg]").remove()),pageId.find("#popTmplCreBtn").removeAttr("disabled");let tmplNm=pageId.find("#popTmplNme").val().trim();if(tmplNm.length<=0)return void PMSTmpl.showError(ZPI18N.getString("zp.tmplnameerr"),pageId.find("#popTmplNme"));if(tmplNm.length>250)return void PMSTmpl.showError(ZPI18N.getString("zp.fieldpropertymaxlength",[ZPI18N.getString("zp.templatename"),"250 characters"]),pageId.find("#popTmplNme"));if(void 0!==PMSSetting.LOAD_TMPL_DATA.data&&PMSSetting.LOAD_TMPL_DATA.data.length>0){let isValidName=!1;if($.each(PMSSetting.LOAD_TMPL_DATA.data,function(index,tmpObj){void 0!=tmpObj&&void 0!=tmpObj.cycleName&&tmpObj.rawCycleName===tmplNm&&(isValidName=!0)}),isValidName)return void PMSTmpl.showError(ZPI18N.getString("zp.duplicateSkill",[ZPI18N.getString("zp.templatename")]),pageId.find("#popTmplNme"))}if(pageId.find("#popTmplDesc").val().trim().length>5e3)return void PMSTmpl.showError(ZPI18N.getString("zp.fieldpropertymaxlength",[ZPI18N.getString("zp.template")+" "+ZPI18N.getString("zp.description"),"5000 characters"]),pageId.find("#popTmplDesc"));let tmplObj={};tmplObj.nme=pageId.find("#popTmplNme").val(),tmplObj.desc=pageId.find("#popTmplDesc").val(),tmplObj.sa=pageId.find("#poptmplsaTglBtnFstCrtDiv").hasClass("zpl_act"),tmplObj.mr=pageId.find("#poptmplmrTglBtnFstCrtDiv").hasClass("zpl_act"),tmplObj.hk=pageId.find("#poptmplhikeTglBtnFstCrtDiv").hasClass("zpl_act"),tmplObj.norm=pageId.find("#poptmplnormTglBtnFstCrtDiv").hasClass("zpl_act"),pageId.find("#tmplPopUpDiv").removeClass("zpl_mopen"),pageId.find("#popTmplCreBtn").attr("disabled",!0),PMSTmpl.openAddTemplate(!0,tmplObj)},selTmplModule:function(obj){$(obj).attr("val");$(obj).hasClass("zpl_act")?$(obj).removeClass("zpl_act"):$(obj).addClass("zpl_act")},cartConstructTmplListPage:function(){settingsPage.container;if(null===PMSSetting.LOAD_TMPL_DATA){let params={mode:"tmplList"};ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){PMSSetting.LOAD_TMPL_DATA=resultData})}PMSSetting.cartBuildTmplList();let tmplLst=PMSSetting.LOAD_TMPL_DATA.data;$.each(tmplLst,function(index,data){data.configID;$.each(tmplLst,function(index,data){PMSSetting.TMPL_MORE_MENU.hasOwnProperty(data.configID)||PMSSetting.tmplMoreMenu(data.configID)})})},cartBuildTmplList:function(){PMSSetting.TMPL_MORE_MENU={};const pageId=settingsPage.container,tmplLst=PMSSetting.LOAD_TMPL_DATA.data;PMSSetting.CUSTOM_NAMES=null===PMSSetting.CUSTOM_NAMES?PMSSetting.LOAD_TMPL_DATA.customName:PMSSetting.CUSTOM_NAMES;let li="",cnt=0;tmplLst.forEach((data,index)=>{data.status&&(li+=PMSSetting.cartConstructTmplList(index,data,PMSSetting.CUSTOM_NAMES,PMSTmpl.tmplColors[cnt]),cnt=(cnt+1)%PMSTmpl.tmplColors.length)}),tmplLst.forEach((data,index)=>{data.status||(li+=PMSSetting.cartConstructTmplList(index,data,PMSSetting.CUSTOM_NAMES,PMSTmpl.tmplColors[cnt]),cnt=(cnt+1)%PMSTmpl.tmplColors.length)});const cartTmplLst=pageId.find("#cartTmplLst"),cartTmplLstNoData=pageId.find("#cartTmplLstNoData");tmplLst.length>0?(pageId.find("#cartTmplLst #ctTmplLstID").html(li),cartTmplLst.show(),cartTmplLstNoData.hide()):(cartTmplLstNoData.show(),cartTmplLst.hide(),PMSOperationCommon.setNoData(cartTmplLstNoData,null,"zp_nd_nodata1",null,ZPI18N.getString("zp.comp.rlt.notmpl"),null),pageId.find("#emptPage").height(pageId.outerHeight(!0)))},tmplMoreIcon:function(e,obj,id){var menuObj=PMSSetting.TMPL_MORE_MENU;menuObj.hasOwnProperty(id)&&menuObj[id].show()},tmplMoreMenu:function(tmplID){var pageId=settingsPage.container;PMSSetting.TMPL_MORE_MENU[tmplID]=ZPeopleComponents.menu(pageId.find("#"+tmplID+"_moremenu"),{forElement:pageId.find("#"+tmplID+"_moreicon"),appendTo:pageId,itemclick:e=>{var detail=e.detail;if("tmplEdit"==detail.attrs.id)PMSTmpl.openEditTemplateFrmCart(tmplID);else if("tmplEnDis"==detail.attrs.id){let flg=!("true"===detail.attrs.status);PMSSetting.newTmplEnableDisable(tmplID,flg)}else"tmplDel"==detail.attrs.id&&PMSSetting.tmplDelete(tmplID)}})},cartConstructTmplList:function(index,data,customName,color){let cID=data.configID;li="<li tmplid="+cID+' cycleType="'+data.cycleType+'" class="zpl_grdcrdtyelst">',li+='<div class="zpl_grdcrdtyeimg '+color+'"><h5 class="zpl_ellipsis" id="tNme" title="'+data.cycleName+'">'+data.cycleName+"</h5></div>",li+='<div class="zpl_grdcrdtyecnt"  enDis="true"><ul class="zpl_lstdisc">',data.isSelfEnable&&(li+='<li><i class="PI_tick2 grn"></i>'+ZPI18N.getString("zp.selfappraisal")+"</li>"),data.isMREnable&&(li+='<li><i class="PI_tick2 grn"></i>'+customName.mrName+"</li>"),li+='<li><i class="PI_tick2 grn"></i>'+ZPI18N.getString("zp.reviewerreview")+"</li>",li+="</ul></div>",li+='<div class="zpl_grdcrdtyefdr" id="stmplSelDiv">',data.status?(li+='<div><button onclick="PMSOperation.onClickViewDetail(this);" type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small">'+ZPI18N.getString("zp.viewdetails")+"</button>",li+='<button data-action-in-progress="true" onclick=PMSTmpl.openEditTemplateFrmCart(this,true);  onclick="PMSOperation.onClickViewDetail(this);" type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small">'+ZPI18N.getString("zp.edit")+"</button></div>"):li+='<div><span class="d-flexclmcap8 zpl_cpd a-itm-cntr"><div class="zpl_statCon grybg3"><i class="PI_disable"></i><span>'+ZPI18N.getString("zp.disabled")+"</span></div></span></div>",li+='<div><span class="zpl_hvr zpl_hvrsw">',li+='<i type="button" class="zpl_drpdwn-js zpl_act PI_more" data-menu-id="'+cID+'_moremenu" id="'+cID+'_moreicon"  title="'+ZPI18N.getString("zp.more")+'" onclick="PMSSetting.tmplMoreIcon(event,this,\''+cID+"')\"></i>",li+=' <div id="'+cID+'_moremenu" data-type="list" data-content-type="icon-text" data-direction="auto" data-display-type="callout" class="zpl_drpdwn"><ul>';let _endisStr=data.status?ZPI18N.getString("zp.disable"):ZPI18N.getString("zp.enable"),_endisStrCls=data.status?"PI_disable":"PI_tick2";return li+='<li id="tmplEnDis" rel="'+cID+'" status="'+data.status+'" data-icon-class="'+_endisStrCls+'" data-label="'+_endisStr+'">'+_endisStr+"</li>",data.status&&(li+='<li id="tmplDel" rel="'+cID+'"  data-icon-class="PI_delete"  data-label="'+ZPI18N.getString("zp.delete")+'" class="red">'+ZPI18N.getString("zp.delete")+"</li>"),li+="</ul></div>",li+="</span></div>",li+="</div>",li+="</li>",li},constructTmplListPage:function(){var pageId=settingsPage.container;if(null===PMSSetting.LOAD_TMPL_DATA){let params={mode:"tmplList"};ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){PMSSetting.LOAD_TMPL_DATA=resultData})}let tr="",tmplLst=PMSSetting.LOAD_TMPL_DATA.data;$.each(tmplLst,function(index,data){tr+=PMSSetting.getTmplLstRow(data.configID,data.cycleName,data.status)}),pageId.find("#tmplLstTBody").html(tr),$(pageId.find(".tmpltg")).ztoggleswitch({size:"medium"}),$.each(tmplLst,function(index,data){let idx="tg_"+data.configID,trID="tmpl_"+data.configID;data.status?(pageId.find("#"+idx).ztoggleswitch("switchOn"),pageId.find("#"+trID).removeClass("disabled")):(pageId.find("#"+idx).ztoggleswitch("switchOff"),pageId.find("#"+trID).addClass("disabled")),ZPeopleComponents.toggleswitch("#"+idx).setAttributes({change:PMSSetting.tmplEnableDisable})})},getTmplLstRow:function(tmplID,tmplNme){let tr='<tr id="tmpl_'+tmplID+'" tmplID='+tmplID+">";return tr+='<td class="CP" onclick="PMSTmpl.openEditTemplate(this);"><b>'+tmplNme+"</b></td>",tr+='<td><input id="tg_'+tmplID+'" tmplID='+tmplID+' class="togbutton-js tmpltg" style="display: none;"></td>',tr+='<td width="10%">',tr+='<div class="text-center"><div class="zpl_hvr"><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSSetting.tmplDelete(this)"></i></div></div>',tr+="</td>",tr+="</tr>"},tmplEnableDisable:function(event,data){if(!event.detail.fromUI)return;var tmplID=data.element.attr("tmplID"),status=data.state?1:0;let params={mode:"tmplEnableDisable",tmplID:tmplID,status:status};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){var pageId=settingsPage.container;null!==resultData&&"SUCCESS"===resultData.msg?(PMSSetting.LOAD_TMPL_DATA=resultData,1===status?(ZPeople.Message.success(ZPI18N.getString("zp.templateenable")),pageId.find("#tmpl_"+tmplID).removeClass("disabled")):(ZPeople.Message.success(ZPI18N.getString("zp.templatedisable")),pageId.find("#tmpl_"+tmplID).addClass("disabled"))):"FAIL_ONE_MUST"===resultData.msg&&(ZPeople.Message.warning(ZPI18N.getString("zp.oneactivecycletemplatemsg")),1===status?pageId.find("#tg_"+tmplID).ztoggleswitch("switchOff"):pageId.find("#tg_"+tmplID).ztoggleswitch("switchOn"))})},newTmplEnableDisable:function(tmplID,flg){var status=flg?1:0;let params={mode:"tmplEnableDisable",tmplID:tmplID,status:status};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){settingsPage.container;if(null!==resultData&&"SUCCESS"===resultData.msg){const message=status?ZPI18N.getString("zp.templateenable"):ZPI18N.getString("zp.templatedisable");ZPeople.Message.success(message),PMSTmpl.updateAfterSubmit(!0,resultData),PMSSetting.cartConstructTmplListPage()}else"FAIL_ONE_MUST"===resultData.msg&&ZPeople.Message.warning(ZPI18N.getString("zp.oneactivecycletemplatemsg"))})},tmplDelete:function(tmplID){var deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.tmpldeltitle"),deletePopUp.despcription=ZPI18N.getString("zp.tmpldelmsg"),deletePopUp.yesButtonText=ZPI18N.getString("zp.delete"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){let params={mode:"tmplDelete",tmplID:tmplID};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){if(null!==resultData&&"SUCCESS"===resultData.msg){const selectedIndex=PMSSetting.LOAD_TMPL_DATA.data.findIndex(obj=>obj.configID===resultData.configId);PMSSetting.LOAD_TMPL_DATA.data.splice(selectedIndex,1),ZPeople.Message.success(ZPI18N.getString("zp.templatedeletedsuccessfully")),PMSSetting.cartConstructTmplListPage()}else"FAIL_ONE_MUST"===resultData.msg&&ZPeople.Message.warning(ZPI18N.getString("zp.oneactivecycletemplatemsg"))})},deletePopUp.show()},appraisalAdminInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)){const pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!0),PMSSetting.appraisalAdminDefaultAction(),$.ajax({type:"POST",async:!1,url:"/performance/view/appraisaladmin",data:{conreqcsr:csrfToken},success(resultData){pageId.html(""),pageId.append(resultData),$(pageId.find(".togBtn")).ztoggleswitch({size:"medium"}),PMSSetting.CUSTOM_DATA_VISIBLE=pageId.find("#customAdminSection").length>0;ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"getCustomAdminSettings"},PMSSetting.buildData)}})}},appraisalAdminDefaultAction:function(){const pageID=settingsPage.container;PMSSetting.CUSTOM_DATA_VISIBLE&&(ZPeopleComponents.toggleswitch(pageID.find("#customAdminChkBox")).destroy(),ZPeopleComponents.toggleswitch(pageID.find("#accessChkBox")).destroy(),ZPeopleComponents.toggleswitch(pageID.find("#reviewHistoryAllow")).destroy(),ZPeopleComponents.tokenfield(pageID.find("#caMembers")).destroy(),ZPeopleComponents.select(pageID.find("#nonAdminRole")).destroy()),pageID.find("#cstAdmTbody").children().each(function(k,v){1==$(v).find("select").length&&ZPeopleComponents.select($(v).find("select")).destroy()})},buildData:function(data){PMSSetting.GRP_ADMIN_DATA=data,PMSSetting.constructPage()},reset:function(){PMSSetting.appraisalAdminDefaultAction(),PMSSetting.constructPage()},toggleDataPermCustomAdmin:function(){var pageId=settingsPage.container,dataChkbox=pageId.find("#cstAdmTbody input[type=checkbox][attr=vwApp]"),isAllow=!1;$.each(dataChkbox,function(idx,val){if(pageId.find(val).is(":checked"))return isAllow=!0,!1}),isAllow?pageId.find("#reviewHistoryAllowDiv").removeClass("DNI"):pageId.find("#reviewHistoryAllowDiv").addClass("DNI"),PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)},constructPage:function(){var pageId=settingsPage.container;if(void 0!==PMSSetting.GRP_ADMIN_DATA.moduleAdminData&&(PMSSetting.CUSTOM_DATA=PMSSetting.GRP_ADMIN_DATA.moduleAdminData,PMSSetting.IS_CUSTOMADMIN_ENABLE=PMSSetting.CUSTOM_DATA.isCustomAdminEnable,PMSSetting.ADMIN_USERS_LIST=PMSSetting.CUSTOM_DATA.list,PMSSetting.IS_CUSTOMADMIN_ENABLE?(PMSSetting.SEL_ADMIN_USER_LIST=PMSSetting.CUSTOM_DATA.selAdminList,PMSSetting.SELECTED_ROLE=PMSSetting.CUSTOM_DATA.selectedRole):(PMSSetting.SEL_ADMIN_USER_LIST=null,PMSSetting.SELECTED_ROLE=null),PMSSetting.ROLE_LIST=PMSSetting.CUSTOM_DATA.roleList),PMSSetting.REVIEW_HISTORY_ENABLE=void 0!=PMSSetting.GRP_ADMIN_DATA.reviewHistoryEnabled&&PMSSetting.GRP_ADMIN_DATA.reviewHistoryEnabled,ZPeopleComponents.toggleswitch(pageId.find("#reviewHistoryAllow")).setAttributes({change:function(){PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)}}),PMSSetting.CUSTOM_DATA_VISIBLE&&null!==PMSSetting.CUSTOM_DATA){ZPeopleComponents.toggleswitch(pageId.find("#customAdminChkBox")).setAttributes({change:PMSSetting.toggleCustomAdmin});var _customAdminEnable=PMSSetting.IS_CUSTOMADMIN_ENABLE?"switchOn":"switchOff";pageId.find("#customAdminChkBox").ztoggleswitch(_customAdminEnable),PMSSetting.IS_CUSTOMADMIN_ENABLE?pageId.find("#chooseAdmin,#nonAdminRoleDiv").removeClass("DN"):pageId.find("#chooseAdmin,#nonAdminRoleDiv").addClass("DN");var caMembers=pageId.find("#caMembers"),_tokenObj={},adminList=PMSSetting.getAdminEmployeeOption(),selectedList=[];if(null!=PMSSetting.SEL_ADMIN_USER_LIST)for(var j in adminList)PMSSetting.SEL_ADMIN_USER_LIST.includes(adminList[j].id)&&selectedList.push(adminList[j]);_tokenObj.data=adminList,_tokenObj.contentType="text",_tokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_tokenObj.search={by:"name"},_tokenObj.allowDuplicateValues=!1,_tokenObj.dropdownList={itemType:"checkbox"},_tokenObj.placeholder=ZPI18N.getString("zp.selpadmin"),_tokenObj.values=selectedList,ZPeopleComponents.tokenfield(caMembers,_tokenObj),$(caMembers).on("ztokenfieldtokenadd",function(){PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)}),$(caMembers).on("ztokenfieldtokenremove",function(){PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)});var nonAdminRole=pageId.find("#nonAdminRole"),_roleSelectObj={};_roleSelectObj.options=PMSSetting.getRoleOption(!1),_roleSelectObj.contentType="text",_roleSelectObj.dataMapping={label:"name",value:"id",informativeText:"name"},_roleSelectObj.search={by:["name"],highlightKeyword:!0},_roleSelectObj.value=PMSSetting.SELECTED_ROLE,ZPeopleComponents.select(nonAdminRole,_roleSelectObj),$(nonAdminRole).on("zselectchange",function(){PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)})}ZPeopleComponents.toggleswitch(pageId.find("#accessChkBox")).setAttributes({change:PMSSetting.toggleAccessDataReport});var caSettings=PMSSetting.GRP_ADMIN_DATA.caSettings,tr="";$.each(caSettings,function(idx,val){tr+=PMSSetting.constructGrpAdmRow(val)}),pageId.find("#cstAdmTbody").html(tr);let isChkFlg=!1,isChkData=!1;$.each(caSettings,function(idx,val){var rowObj=pageId.find("#row_"+val.caSettID);1===val.isVwAppData&&(rowObj.find('[attr="vwApp"]').prop("checked",!0),isChkFlg=!0,isChkData=!0),1===val.isVwRpt&&(rowObj.find('[attr="vwRpt"]').prop("checked",!0),isChkFlg=!0)}),isChkFlg?(pageId.find("#accessChkBox").ztoggleswitch("switchOn"),pageId.find("#accessChkBoxDiv").removeClass("DN")):(pageId.find("#accessChkBox").ztoggleswitch("switchOff"),pageId.find("#accessChkBoxDiv").addClass("DN")),isChkFlg&&isChkData?(pageId.find("#reviewHistoryAllowDiv").removeClass("DNI"),PMSSetting.REVIEW_HISTORY_ENABLE?pageId.find("#reviewHistoryAllow").ztoggleswitch("switchOn"):pageId.find("#reviewHistoryAllow").ztoggleswitch("switchOff")):pageId.find("#reviewHistoryAllowDiv").addClass("DNI"),pageId.find("#cstAdmTbody input[type=checkbox][attr=vwApp]").click(function(){PMSSetting.toggleDataPermCustomAdmin()}),pageId.find("#cstAdmTbody input[type=checkbox][attr=vwRpt]").click(function(){PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)}),PMSSetting.closeResetSave(PMSCommon.SECTION_CUSTOM_ADMIN)},getAdminEmployeeOption:function(){return null!==PMSSetting.ADMIN_USERS_LIST_OPTIONS&&""!==PMSSetting.ADMIN_USERS_LIST_OPTIONS||(PMSSetting.ADMIN_USERS_LIST_OPTIONS=[],$.each(PMSSetting.ADMIN_USERS_LIST,function(index,data){var _singleObj={};_singleObj.name=ZPeople.decodeTxt(data.EMPNAME),_singleObj.id=data.ERECNO,PMSSetting.ADMIN_USERS_LIST_OPTIONS.push(_singleObj)})),PMSSetting.ADMIN_USERS_LIST_OPTIONS},getRoleOption:function(needAllOption){return PMSSetting.ROLE_LIST_OPTIONS=[],needAllOption&&PMSSetting.ROLE_LIST_OPTIONS.push({name:ZPI18N.getString("zp.all"),id:0}),$.each(PMSSetting.CUSTOM_DATA.roleList,function(index,data){PMSSetting.ROLE_LIST_OPTIONS.push({name:ZPeople.decodeTxt(data.roleName),id:data.roleID})}),PMSSetting.ROLE_LIST_OPTIONS},toggleCustomAdmin:function(event){var data=event.detail,pageId=settingsPage.container;data.state?pageId.find("#chooseAdmin,#nonAdminRoleDiv").removeClass("DN"):pageId.find("#chooseAdmin,#nonAdminRoleDiv").addClass("DN"),PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)},toggleAccessDataReport:function(event){const{state:state}=event.detail,pageId=settingsPage.container;if(state){pageId.find("#accessChkBoxDiv").removeClass("DN");var isCheck=!1;PMSSetting.GRP_ADMIN_DATA.caSettings.forEach(function(val){if(1===val.isVwAppData)return isCheck=!0,!1}),isCheck&&pageId.find("#reviewHistoryAllowDiv").removeClass("DNI")}else{pageId.find("#accessChkBoxDiv").addClass("DN"),pageId.find("#reviewHistoryAllowDiv").addClass("DNI"),pageId.find("#cstAdmTbody").children().each(function(k,v){1==$(v).find("select").length&&ZPeopleComponents.select($(v).find("select")).destroy()}),pageId.find("#cstAdmTbody").empty();const caSettings=PMSSetting.GRP_ADMIN_DATA.caSettings;let tr="";caSettings.forEach(function(val){tr+=PMSSetting.constructGrpAdmRow(val)}),pageId.find("#cstAdmTbody").html(tr),caSettings.forEach(function(val){const rowObj=pageId.find(`#row_${val.caSettID}`);1===val.isVwAppData&&rowObj.find('[attr="vwApp"]').prop("checked",!0),1===val.isVwRpt&&rowObj.find('[attr="vwRpt"]').prop("checked",!0)}),pageId.find("#cstAdmTbody input[type=checkbox][attr=vwApp]").click(function(){PMSSetting.toggleDataPermCustomAdmin()}),pageId.find("#cstAdmTbody input[type=checkbox][attr=vwRpt]").click(function(){PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)})}PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)},constructGrpAdmRow:function(rowObj){var tr="<tr id="+("row_"+rowObj.caSettID)+" type="+rowObj.type+" fcid="+rowObj.fcID+" casettid="+rowObj.caSettID+" grpid="+rowObj.grpID+" dispname='"+rowObj.displayNme+"'>";return tr+=rowObj.isDft?"<td><span>"+rowObj.displayNme+"</span></td>":"<td onclick='PMSSetting.viewGroupAdminModal(this);'><span>"+rowObj.displayNme+"</span></td>",tr+="<td><div class='zpl_tgl j-cnt-cntr'><div class='zcheckbox'><input attr='vwApp' id='vwApp_"+rowObj.caSettID+"' type='checkbox' name='check' class='zcheckbox__helper'><label for='vwApp_"+rowObj.caSettID+"' class='zcheckbox__label'></label></div></div></td>",tr+="<td><div class='zpl_tgl j-cnt-cntr'><div class='zcheckbox'><input attr='vwRpt' id='vwRpt_"+rowObj.caSettID+"' type='checkbox' name='check' class='zcheckbox__helper'><label for='vwRpt_"+rowObj.caSettID+"' class='zcheckbox__label'></label></div></div></td>",tr+="<td>",rowObj.isDft||(tr+="<div class='text-center'> <div class='zpl_hvr'> <i class='PI_delete' title="+ZPI18N.getString("zp.delete")+" onclick='PMSSetting.newDeleteRow(this);'></i> </div> </div>"),tr+="</td>",tr+="</tr>"},addNewFormFldRow:function(){var pageID=settingsPage.container,tBody=pageID.find("#cstAdmTbody");if(!ZPeopleComponents.select(pageID.find("#cstAdmTbody tr").last().find("select"))||0!=ZPeopleComponents.select(pageID.find("#cstAdmTbody tr").last().find("select")).getValue()){if(PMSSetting.ALREADY_EXIST_EMP_LKUP=[],pageID.find("#cstAdmTbody tr").each(function(index,ele){var nm=$(this).attr("dispname");PMSSetting.ALREADY_EXIST_EMP_LKUP.push(nm)}),null===PMSSetting.EMP_LKUP){var params={mode:"fetchEmpLookup",submode:PMSCommon.APPROVAL_LKUP};ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){PMSSetting.EMP_LKUP=resultData.emplookup})}var newEmpLkup={},cnt=0;if(null!=PMSSetting.EMP_LKUP&&$.each(PMSSetting.EMP_LKUP,function(key,value){-1===PMSSetting.ALREADY_EXIST_EMP_LKUP.indexOf(value)&&(newEmpLkup.key=value,cnt+=1)}),cnt>0){var dynval=(new Date).getTime(),rowid="newfrmfld_"+dynval,row="<tr newrow='newrow'><td><select id='"+rowid+"' data-width='150' style='display: none;'></select></td>";row+="<td><div class='zpl_tgl j-cnt-cntr'><div class='zcheckbox'><input attr='vwApp' id='vwApp_"+dynval+"' type='checkbox' name='check' class='zcheckbox__helper'><label for='vwApp_"+dynval+"' class='zcheckbox__label'></label></div></div></td>",row+="<td><div class='zpl_tgl j-cnt-cntr'><div class='zcheckbox'><input attr='vwRpt' id='vwRpt_"+dynval+"' type='checkbox' name='check' class='zcheckbox__helper'><label for='vwRpt_"+dynval+"' class='zcheckbox__label'></label></div></div></td>",row+="<td><div class='text-center'> <div class='zpl_hvr'> <i class='PI_delete' title="+ZPI18N.getString("zp.delete")+" onclick='PMSSetting.newDeleteRow(this);'></i> </div> </div></td></tr>",tBody.append(row);var empLookupArr=[];empLookupArr.push({name:ZPI18N.getString("zp.sltlkupfld"),id:0}),$.each(PMSSetting.EMP_LKUP,function(key,value){-1===PMSSetting.ALREADY_EXIST_EMP_LKUP.indexOf(value)&&(empLookupArr.push({name:value,id:key}),cnt+=1)});var empLookup=tBody.find("tr[newrow=newrow] #"+rowid),_cusAdminSelectObj={};_cusAdminSelectObj.options=empLookupArr,_cusAdminSelectObj.contentType="text",_cusAdminSelectObj.dataMapping={label:"name",value:"id",informativeText:"name"},_cusAdminSelectObj.search={by:["name"],highlightKeyword:!0},ZPeopleComponents.select(empLookup,_cusAdminSelectObj),$(empLookup).on("zselectchange",PMSSetting.onFormFldChange)}else ZPeople.Message.warning(ZPI18N.getString("zp.nolkupfld"))}},onFormFldChange:function(obj){settingsPage.container;var data=obj.detail,tr=$(data.element[0]).parents("tr"),val=data.optionData.id,dispNm=PMSSetting.EMP_LKUP[val];$(tr).removeAttr("dispname").attr("dispname",dispNm),$(tr).removeAttr("fcid"),$(tr).removeAttr("type"),void 0!==dispNm&&($(tr).attr("fcid",val),$(tr).attr("type",2)),$(tr).removeAttr("newrow"),tr.find("input[type=checkbox][attr=vwApp]").is(":checked")&&PMSSetting.toggleDataPermCustomAdmin(),tr.find("input[type=checkbox][attr=vwApp]").click(function(){PMSSetting.toggleDataPermCustomAdmin()}),tr.find("input[type=checkbox][attr=vwRpt]").click(function(){PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)}),PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)},newDeleteRow:function(obj){var tr=$(obj).parents("tr");if(1==$(tr).find("select").length){var selectEle=$(tr).find("select").attr("id");ZPeopleComponents.select("#"+selectEle).destroy()}$(tr).remove(),PMSSetting.getSaveResetBtn(PMSCommon.SECTION_CUSTOM_ADMIN)},submitCstAdmSett:function(){var pageID=settingsPage.container,selErecList=null,selRoleID=null,isEnable=!1;if(PMSSetting.CUSTOM_DATA_VISIBLE){if(isEnable=ZPeopleComponents.toggleswitch(pageID.find("#customAdminChkBox")).getState()){var selErecVal=ZPeopleComponents.tokenfield(pageID.find("#caMembers")).getAllValues();if(0==selErecVal.length)return ZPeopleComponents.tokenfield(pageID.find("#caMembers")).setAttributes({className:"ztextbox__error"}),void pageID.find("#caMembers_error").html(ZPI18N.getString("zp.selectuser")).show();for(var i in ZPeopleComponents.tokenfield(pageID.find("#caMembers")).setAttributes({className:""}),pageID.find("#caMembers_error").html("").hide(),selErecList=[],selErecVal)selErecList+=""==selErecList?selErecVal[i].id:","+selErecVal[i].id}selRoleID=ZPeopleComponents.select(pageID.find("#nonAdminRole")).getValue()}var gsData={};PMSSetting.CUSTOM_DATA_VISIBLE&&(gsData=isEnable?{moduleAdminData:{isCustomAdminEnable:isEnable,selAdminList:selErecList,selectedRole:selRoleID}}:{moduleAdminData:{isCustomAdminEnable:isEnable}});var accessChkBox=ZPeopleComponents.toggleswitch(pageID.find("#accessChkBox")).getState(),cstAdmSettObj=[],trArr=pageID.find("#cstAdmTbody").children(),appData=!1;$.each(trArr,function(k,v){var cstAdmTempObj={},caSettID=$(v).attr("casettid");if(void 0===$(v).attr("type"))return!0;var type=parseInt($(v).attr("type"));if(!ZPUtil.Validation.isNumber(type))return!0;var fcID=null;2===type&&(fcID=$(v).attr("fcid"));var grpID=$(v).attr("grpid"),rowObj=void 0!=caSettID?pageID.find("#row_"+caSettID):$(v),isVwRpt=0,isVwAppData=0;accessChkBox&&(isVwRpt=rowObj.find('[attr="vwRpt"]').is(":checked")?1:0,isVwAppData=rowObj.find('[attr="vwApp"]').is(":checked")?1:0),1===isVwAppData&&(appData=!0);var isEdtAppData=isVwAppData;cstAdmTempObj.caSettID=caSettID,cstAdmTempObj.type=type,2===type&&(cstAdmTempObj.fcID=fcID),cstAdmTempObj.groupID=grpID,cstAdmTempObj.isVwRpt=isVwRpt,cstAdmTempObj.isVwAppData=isVwAppData,cstAdmTempObj.isEdtAppData=isEdtAppData,cstAdmSettObj.push(cstAdmTempObj)}),gsData.reviewHistoryEnabled=!!appData&&ZPeopleComponents.toggleswitch(pageID.find("#reviewHistoryAllow")).getState(),gsData.cstAdmSettObj=cstAdmSettObj;var params={mode:"saveCustomAdminSetting",data:JSON.stringify(gsData)};pageID.find("#cstgrpadmSbtBtn").attr("disabled",!0),ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(data){pageID.find("#cstgrpadmSbtBtn").prop("disabled",!1),"success"===data.MSG?(ZPeople.Message.success(ZPI18N.getString("zp.settingssaved")),PMSSetting.buildData(data)):"permission_denied"===data.MSG?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):ZPeople.Message.failure(ZPI18N.getString("zp.errorwhlsubmitting"))})},viewGroupAdminModal:function(obj){var params={mode:"getCustomGroupDetails",groupID:$(obj).parents("tr").attr("grpid")};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(data){PMSSetting.showGroupAdminModal(data.caGrpDetails)})},showGroupAdminModal:function(data){var sliderTab=new Tab(PMSSetting.GRP_ADMIN_MODAL_ID,function(){var _htm='<div class="zpl_crd"> <div class="zpl_crdcnt zpl_crdinfo"> <div> <div class="zpl_secn"> <div><label>'+ZPI18N.getString("zp.cstadmthrough",new Array(""))+"</label></div>";_htm+='<div class="zradiobutton"> <input type="radio" id="lkupID" value="2" name="cstadmin" data-text="'+ZPI18N.getString("zp.LookupField")+'" class="zradiobutton__helper"><label class="zradiobutton__label" for="lkupID"><span class="zradiobutton__text">'+ZPI18N.getString("zp.LookupField")+"</span></label> </div>",_htm+="</div>",_htm+='<div class="zpl_secn"> <div> <label>'+ZPI18N.getString("zp.sltcstadm")+'</label> </div> <div> <select id="grpAdmSelID" style="display: none;"> </select> </div> </div>',_htm+="</div> </div> </div>",$("#cardcstgrpadmmodalid").html(_htm)},function(){PMSSetting.sumbitGroupAdmin()});if(PMSSetting.grpAdminPopupObj=new popupModal(ZPI18N.getString("zp.addadmgrpbtn"),sliderTab),PMSSetting.grpAdminPopupObj.setCloseCallback(function(){var _sliderDiv=$(PMSSetting.grpAdminPopupObj.sliderDiv);ZPeopleComponents.select(_sliderDiv.find("select")).destroy(),PMSSetting.grpAdminPopupObj.remove(),PMSSetting.grpAdminPopupObj={}}),PMSSetting.grpAdminPopupObj.construct(),null===PMSSetting.EMP_LKUP){var params={mode:"fetchEmpLookup",submode:PMSCommon.APPROVAL_LKUP};ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){PMSSetting.EMP_LKUP=resultData.emplookup})}PMSSetting.defaultActGrpAdmModal(data)},sumbitGroupAdmin:function(){settingsPage.container;var _sliderDiv=$(PMSSetting.grpAdminPopupObj.sliderDiv),mode=_sliderDiv.find("#card"+PMSSetting.GRP_ADMIN_MODAL_ID).attr("mode"),isUpd=!1,type=parseInt(_sliderDiv.find("[name=cstadmin]:checked").val());ZPeopleComponents.select(_sliderDiv.find("#card"+PMSSetting.GRP_ADMIN_MODAL_ID).find("#grpAdmSelID")).getValue();var grpAdmin=ZPeopleComponents.select(_sliderDiv.find("#card"+PMSSetting.GRP_ADMIN_MODAL_ID).find("#grpAdmSelID")).getValue();if("0"!==grpAdmin){var params={};if("add"===mode)params={mode:"saveGrpAdmin",type:type,grpAdmin:grpAdmin};else if("edit"===mode){params={mode:"updateGrpAdmin",type:type,grpAdmin:grpAdmin,groupID:_sliderDiv.find("#card"+PMSSetting.GRP_ADMIN_MODAL_ID).attr("grpid")},isUpd=!0}ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(data){"success"===data.MSG?(isUpd?ZPeople.Message.success("Group admin setting updated successfully"):ZPeople.Message.success("Group admin setting saved successfully"),PMSSetting.GRP_ADMIN_DATA=data,PMSSetting.reset(),ZPeopleComponents.select(_sliderDiv.find("select")).destroy(),PMSSetting.grpAdminPopupObj.remove(),PMSSetting.grpAdminPopupObj={}):"duplicate"===data.MSG?ZPeople.Message.warning("Already form field selected"):"failure"===data.MSG&&ZPeople.Message.failure(ZPI18N.getString("zp.serrviceconflict.people_failure"))})}else ZPeople.Message.showFailureMsg("Please select Group Admin")},defaultActGrpAdmModal:function(data){var empLookupArr=[],_sliderDiv=$(PMSSetting.grpAdminPopupObj.sliderDiv),empLookup=_sliderDiv.find("#grpAdmSelID");null!=PMSSetting.EMP_LKUP&&(empLookupArr.push({name:ZPI18N.getString("zp.select"),id:0}),$.each(PMSSetting.EMP_LKUP,function(key,value){empLookupArr.push({name:value,id:key})}));var _cusAdminSelectObj={};_cusAdminSelectObj.options=empLookupArr,_cusAdminSelectObj.contentType="text",_cusAdminSelectObj.dataMapping={label:"name",value:"id",informativeText:"name"},_cusAdminSelectObj.search={by:["name"],highlightKeyword:!0},void 0!==data&&data.grpAdmin&&(_cusAdminSelectObj.value=data.grpAdmin),ZPeopleComponents.select(empLookup,_cusAdminSelectObj),void 0!==data&&2===data.type?(_sliderDiv.find("#card"+PMSSetting.GRP_ADMIN_MODAL_ID).attr("mode","edit"),_sliderDiv.find("#card"+PMSSetting.GRP_ADMIN_MODAL_ID).attr("grpid",data.grpID),_sliderDiv.find("#lkupID")[0].checked=!0):(_sliderDiv.find("#card"+PMSSetting.GRP_ADMIN_MODAL_ID).attr("mode","add"),_sliderDiv.find("#lkupID")[0].checked=!0)},paNotificationInit:function(){PMSGettingStarted.gettingStartedInit(PMSGettingStarted.SETTINGS_PAGE)&&PMSSetting.notiList()},notiList:function(){var pageID=settingsPage.container;if(pageID.find("div.zpl_rgtcnt").length<=0){var params={mode:"mailalerts",conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){var usrNotRow="";void 0!==resultData.selfappraisal&&""!==resultData.selfappraisal&&(usrNotRow+=resultData.selfappraisal.length>0?"<thead><tr><th>"+resultData.selfappraisal_dispName+'</th></tr></thead><tbody name="paNtfy_body">':"",$.each(resultData.selfappraisal,function(index,data){usrNotRow+=PMSSetting.listRow(data,resultData.selfappraisal_formId,resultData.isSettingsAdmin)}),usrNotRow+=resultData.selfappraisal.length>0?"</tbody>":"");var modEnabledChkArr=["SALARY_HIKE_PUSH_NOTIFY","SKILLSET_TAG_EMP","SKILLSET_TAG_RM","SKILLSET_UPGRADE_EMP","SKILLSET_UPGRADE_RM",PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_SELF_NOTIFY,PMSCommon.PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY];if(void 0!==resultData.defaultReviewNotificationType&&(usrNotRow+="<thead><tr><th>"+resultData.appraisal_dispName+'</th></tr></thead><tbody name="paNtfy_body">',$.each(resultData.defaultReviewNotificationType,function(index,data){if(!modEnabledChkArr.includes(data.notificationName)){var check=void 0!=resultData.defaultReviewNotificationDetails&&resultData.defaultReviewNotificationDetails.hasOwnProperty(data.notificationName),displayName=void 0!=data.description&&""!=data.description?data.description:data.name;if(check){var description=resultData.defaultReviewNotificationDetails[data.notificationName].description;displayName=""!=description?description:data.name}usrNotRow+='<tr type="grpMailTmpl" formTempId="'+data.notificationName+'"><td><div class="d-flexC" ><div class="zpl_tgsprt"><div class="d-flexclmcap10"><input id="enbdis_'+data.notificationName+'"/>'+displayName+'<i class="PI_info" id="" title="'+ZPI18N.getString("zp.pagroupmailinfo")+'"></i></div></div><div class="MLauto"><div class="zpl_hvr" type="grpMailTmpl" formTempId="'+data.notificationName+'"><i class="PI_edt"></i></div></div></div></td></tr>'}})),void 0!==resultData.appraisal&&$.each(resultData.appraisal,function(index,data){usrNotRow+=PMSSetting.listRow(data,resultData.appraisal_formId,resultData.isSettingsAdmin)}),void 0===resultData.defaultReviewNotificationType&&void 0===resultData.appraisal||(usrNotRow+="</tbody>"),void 0===resultData.defaultReviewNotificationType||void 0==resultData.isSalaryDataSourceCompensation||resultData.isSalaryDataSourceCompensation||(PMSV2Cycle.getHikeTerms(),usrNotRow+="<thead><tr><th>"+PMSV2Cycle.SALARYHIKENAME+'</th></tr></thead><tbody name="paNtfy_body">',$.each(resultData.defaultReviewNotificationType,function(index,data){if("SALARY_HIKE_PUSH_NOTIFY"==data.notificationName){var check=void 0!=resultData.defaultReviewNotificationDetails&&resultData.defaultReviewNotificationDetails.hasOwnProperty(data.notificationName),displayName=void 0!=data.description&&""!=data.description?data.description:data.name;if(check){resultData.defaultReviewNotificationDetails[data.notificationName].isEnabled;var description=resultData.defaultReviewNotificationDetails[data.notificationName].description;displayName=""!=description?description:data.name}usrNotRow+='<tr type="grpMailTmpl" formTempId="'+data.notificationName+'"><td><div class="d-flexC" ><div class="zpl_tgsprt"><div class="d-flexclmcap10"><input id="enbdis_'+data.notificationName+'"/>'+displayName+'<i class="PI_info" id="" title="'+ZPI18N.getString("zp.salarycyclemailinfo")+'"></i></div></div><div class="MLauto"><div class="zpl_hvr" type="grpMailTmpl" formTempId="'+data.notificationName+'"><i class="PI_edt"></i></div></div></div></td></tr>'}}),usrNotRow+="</tbody>"),void 0!=resultData.defaultReviewNotificationType&&void 0!=resultData.skillsetEnabled&&resultData.skillsetEnabled){var skillNtfyArr=["SKILLSET_TAG_EMP","SKILLSET_TAG_RM","SKILLSET_UPGRADE_EMP","SKILLSET_UPGRADE_RM"];usrNotRow+="<thead><tr><th>"+resultData.skillDispName+'</th></tr></thead><tbody name="paNtfy_body">',$.each(resultData.defaultReviewNotificationType,function(index,data){if(skillNtfyArr.includes(data.notificationName)){var check=void 0!=resultData.defaultReviewNotificationDetails&&resultData.defaultReviewNotificationDetails.hasOwnProperty(data.notificationName),displayName=void 0!=data.description&&""!=data.description?data.description:data.name;if(check){resultData.defaultReviewNotificationDetails[data.notificationName].isEnabled;var description=resultData.defaultReviewNotificationDetails[data.notificationName].description;displayName=""!=description?description:data.name}usrNotRow+='<tr type="grpMailTmpl" formTempId="'+data.notificationName+'"><td><div class="d-flexC" ><div class="zpl_tgsprt"><div class="d-flexclmcap10"><input id="enbdis_'+data.notificationName+'"/>'+displayName+'</div></div><div class="MLauto"><div class="zpl_hvr" type="grpMailTmpl" formTempId="'+data.notificationName+'"><i class="PI_edt"></i></div></div></div></td></tr>'}}),usrNotRow+="</tbody>"}void 0!==resultData.goals_formId&&(usrNotRow+=resultData.goals.length>0?"<thead><tr><th>"+resultData.goals_dispName+'</th></tr></thead><tbody name="paNtfy_body">':"",$.each(resultData.goals,function(index,data){usrNotRow+=PMSSetting.listRow(data,resultData.goals_formId,resultData.isSettingsAdmin)}),usrNotRow+=resultData.goals.length>0?"</tbody>":""),void 0!==resultData.mr_formId&&(usrNotRow+=resultData.mr.length>0?"<thead><tr><th>"+resultData.mr_dispName+'</th></tr></thead><tbody name="paNtfy_body">':"",$.each(resultData.mr,function(index,data){usrNotRow+=PMSSetting.listRow(data,resultData.mr_formId,resultData.isSettingsAdmin)}),usrNotRow+=resultData.mr.length>0?"</tbody>":""),void 0!==resultData.extendReview_formId&&(usrNotRow+=resultData.extendreview.length>0?"<thead><tr><th>"+resultData.extendreview_dispName+'</th></tr></thead><tbody name="paNtfy_body">':"",$.each(resultData.extendreview,function(index,data){usrNotRow+=PMSSetting.listRow(data,resultData.extendReview_formId,resultData.isSettingsAdmin)}),usrNotRow+=resultData.extendreview.length>0?"</tbody>":"");var html='<div class="zpl_rgtcnt"><div class="zpl_tblres">'+('<table class="zpl_tbl">'+usrNotRow+"</table>")+"</div></div>";pageID.append(html);var topMenuDiv=pageID.find("#topSettMenu");topMenuDiv.append('<div class="search-cmn"><i class="PI_lens"></i><input type="text" class="ztextbox" id="suggestFieldId" placeholder=" '+ZPI18N.getString("zp.searchdata")+' "><i class="PI_cls"></i></div><div class="zpl_rgt"><button class="" id="addPaNtfy">'+ZPI18N.getString("zp.workflow.add")+'</button><i id="paNtfy_srh" data-title-display-type="callout" class="zpl_ibg PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i></div>'),ZPA_Workflow.initiateSearch(topMenuDiv.find("[name=paNtfy_body]")),ZPeopleComponents.button(pageID.find("#addPaNtfy"),{appearance:"primary",click:function(){ZPA_Workflow.addSlide(),setTimeout(function(){void 0!==ZPA_Workflow.Slider.workflowModal&&ZPA_Workflow.Slider.workflowModal.setCloseCallback(function(){ZPA_Workflow.Slider.destroy(),ZPA_Workflow.Slider.workflowModal.remove()})},1e3)}}),pageID.find("#topSettMenu").removeClass("zpl_DNI"),void 0===resultData.selfappraisal||""===resultData.selfappraisal||resultData.isSettingsAdmin||$.each(resultData.selfappraisal,function(index,v){PMSSetting.toggleInit(v.workflowId,v.isactive)}),void 0!==resultData.defaultReviewNotificationType&&$.each(resultData.defaultReviewNotificationType,function(index,data){var isActive=!1;void 0!=resultData.defaultReviewNotificationDetails&&resultData.defaultReviewNotificationDetails.hasOwnProperty(data.notificationName)&&(isActive=resultData.defaultReviewNotificationDetails[data.notificationName].isEnabled),PMSSetting.toggleInit(data.notificationName,isActive)}),void 0===resultData.appraisal||resultData.isSettingsAdmin||$.each(resultData.appraisal,function(index,data){PMSSetting.toggleInit(data.workflowId,data.isactive)}),void 0===resultData.goals_formId||resultData.isSettingsAdmin||$.each(resultData.goals,function(index,data){PMSSetting.toggleInit(data.workflowId,data.isactive)}),void 0===resultData.mr_formId||resultData.isSettingsAdmin||$.each(resultData.mr,function(index,data){PMSSetting.toggleInit(data.workflowId,data.isactive)}),void 0===resultData.extendReview_formId||resultData.isSettingsAdmin||$.each(resultData.extendreview,function(index,data){PMSSetting.toggleInit(data.workflowId,data.isactive)}),pageID.find("[name=paNtfy_body] td .zpl_hvr").on("click",function(event){var target=$(event.currentTarget);if(void 0!==target.attr("formtempid"))if("grpMailTmpl"===target.attr("type")){let ntfyNme=target.attr("formTempId");ntfyNme===PMSCommon.APPRAISAL_CYCLE_COMMENCE?PMSSetting.showHideCommence(PMSCommon.APPRAISAL_CYCLE_COMMENCE):ntfyNme===PMSCommon.PA_REVIEW_COMMENCE?PMSSetting.showHideCommence(PMSCommon.PA_REVIEW_COMMENCE):ntfyNme===PMSCommon.PA_REVIEW_END?PMSSetting.showHideEnd():ntfyNme===PMSCommon.SALARY_HIKE_PUSH_NOTIFY?PMSSetting.showHideCommence(PMSCommon.SALARY_HIKE_PUSH_NOTIFY):ntfyNme===PMSCommon.SKILLSET_TAG_EMP?PMSSetting.showHideCommence(PMSCommon.SKILLSET_TAG_EMP):ntfyNme===PMSCommon.SKILLSET_TAG_RM?PMSSetting.showHideCommence(PMSCommon.SKILLSET_TAG_RM):ntfyNme===PMSCommon.SKILLSET_UPGRADE_EMP?PMSSetting.showHideCommence(PMSCommon.SKILLSET_UPGRADE_EMP):ntfyNme===PMSCommon.SKILLSET_UPGRADE_RM&&PMSSetting.showHideCommence(PMSCommon.SKILLSET_UPGRADE_RM)}else appsettingsadmin||window.open("zp#settings/service/performance/workflow/edit-formid:"+target.attr("formid")+"/workflowid:"+target.attr("wfid"),"_blank")})})}},toggleInit:function(wfID,isActive){void 0!=ZPeopleComponents.toggleswitch("#enbdis_"+wfID)&&ZPeopleComponents.toggleswitch("#enbdis_"+wfID).destroy(),ZPeopleComponents.toggleswitch("#enbdis_"+wfID,{on:isActive}),$("#enbdis_"+wfID).off().on("ztoggleswitchchange",function(event,data){PMSSetting.changeWorkFlowStatus(wfID)}),$("#enbdis_"+wfID).siblings("div").on("click",function(event,data){event.stopPropagation(),event.preventDefault()})},listRow:function(data,formID,isSettingsAdmin){var displayName=void 0!=data.description&&""!=data.description?data.description:data.displayname;let html='<tr type="wfTmpl" wfId="'+data.workflowId+'" formid="'+formID+'" formTempId="'+data.workflowId+'"><td><div class="d-flexC"><div class="zpl_tgsprt"><div class="d-flexclmcap10">';return html+=isSettingsAdmin?"":'<input id="enbdis_'+data.workflowId+'"/>',html+=displayName+'</div></div><div class="MLauto"><div class="zpl_hvr" type="wfTmpl" wfId="'+data.workflowId+'" formid="'+formID+'" formTempId="'+data.workflowId+'"><i class="PI_edt"></i></div></div></div></td></tr>'},changeWorkFlowStatus:function(id){if(-1!=PMSCommon.getNotificationTypes().indexOf(id))PMSSetting.updateReviewNotification(id);else{var params={method:"enableDisable",workflowId:id,conreqcsr:csrfToken};$.post("/changeWorkFlowStatus.zp",params,function(resultData){ZPeople.Message.success(ZPI18N.getString("zp.success"))})}},updateReviewNotification:function(typeName){var params={mode:"updateReviewNotificationStatus",notificationName:typeName,conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){"success"==resultData.msg&&ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.enablesuccessful"))})},normSection:function(){const isNorReaEnable=PMSSetting.dataChanged(PMSCommon.NOR_REASON_ENABLE);!settingsPage.container.find("#reasonForNormalization").is(":checked")&&settingsPage.container.find("#reasonMandatoryNorm").prop("checked",!1),PMSSetting.dataChanged(PMSCommon.NOR_REASON_MANDATORY)||isNorReaEnable?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_NORMALIZATION):PMSSetting.closeResetSave(PMSCommon.SECTION_NORMALIZATION)},courseSection:function(){var pId=settingsPage.container;if(void 0==pId.find("#pmsCourseHeader").html()){var html='<div class="zpl_rgtcnt" id="pmsCourseTab"><div class="zpl_crd" ><div class="zpl_crdhdr" id="pmsCourseHeader"><div><h4>'+ZPI18N.getString("zp.courseSettHeadForPms")+"</h4><p>"+ZPI18N.getString("zp.courseSettBodyForPms")+'</p></div><div id="SECTION_COURSE_DETAILS_SAVERESET" style="display:none"></div></div><div class="zpl_crdcnt" id="courseIntegrationEnable"></div></div>';pId.append(html),html='<div class="zpl_secn"><div class="cstClsT">',html+='<div class="zcheckbox">',html+='<input id="courseView" type="checkbox" name="check" class="zcheckbox__helper" onclick="">',html+='<label for="courseView" class="zcheckbox__label">'+ZPI18N.getString("zp.courseListforPms")+"</label>",html+="</div>",html+="</div></div>",pId.find("#courseIntegrationEnable").append(html),pId.find("#courseView").on("change",function(){PMSSetting.dataChanged(PMSCommon.COURSE_DETAIL)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_COURSE_DETAILS):PMSSetting.closeResetSave(PMSCommon.SECTION_COURSE_DETAILS)})}$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getSettingsConfig",conreqcsr:csrfToken,submode:"courseIntegartion"},success:function(resultData){void 0!=resultData.isListCourse&&(pId.find("#courseView").prop("checked",resultData.isListCourse),PMSSetting.reviewSetdefaultObject={},PMSSetting.reviewSetdefaultObject.isListCourse=resultData.isListCourse)}})},esignSettingInt:function(){if(0==Layout.Page.container.find("#appraisalesigntab").length){ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"getAppraisalEsignSetting"},function(callbackData){PMSSetting.IS_APPRAISAL_ESIGN_ENABLED=callbackData.isAppraisalEsignEnabled,PMSSetting.constructAppraisalEsignSettingsPage()})}},constructAppraisalEsignSettingsPage:function(){let pageId=Layout.Page.container;var html='<div class="zpl_rgtcnt" id="appraisalesigntab"><div class="zpl_crd" ><div class="zpl_crdhdr" id="appraisalEsignHeader"><div><h4>'+ZPI18N.getString("zp.paesign.appraisalesignheader")+"</h4><p>"+ZPI18N.getString("zp.paesign.appraisalesigndescription")+'</p></div><div id="APPRAISAL_ESIGN_SAVERESET" style="display:none"></div></div><div class="zpl_crdcnt" id="appraisalEsignEnable"></div></div>';pageId.append(html),html='<div class="zpl_secn"><div class="cstClsT">',html+='<div class="zcheckbox">',html+='<input id="appraisalsignenabledisable" type="checkbox" name="check" class="zcheckbox__helper" onclick="">',html+='<label for="appraisalsignenabledisable" class="zcheckbox__label">'+ZPI18N.getString("zp.paesign.enableappraisalsign")+"</label>",html+="</div>",html+="</div></div>",pageId.find("#appraisalEsignEnable").append(html),pageId.find("#appraisalsignenabledisable").on("change",function(){PMSSetting.dataChanged(PMSCommon.SECTION_APPRAISAL_ESIGN)?PMSSetting.getSaveResetBtn(PMSCommon.SECTION_APPRAISAL_ESIGN):PMSSetting.closeResetSave(PMSCommon.SECTION_APPRAISAL_ESIGN)}),pageId.find("#appraisalsignenabledisable").prop("checked",PMSSetting.IS_APPRAISAL_ESIGN_ENABLED)},saveAppraisalEsign:function(){if(Layout.Page.container.find("#appraisalsignenabledisable").is(":checked")){var infoPopUp=new InfoAlertMessage;infoPopUp.title=ZPI18N.getString("zp.paesign.enableinfotitle"),infoPopUp.despcription=ZPI18N.getString("zp.paesign.enableinfodesc"),infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){PMSSetting.saveAppraisalEsignAjax()},infoPopUp.show()}else PMSSetting.saveAppraisalEsignAjax()},saveAppraisalEsignAjax:function(){let pageId=Layout.Page.container;ZPeople.autosave.loading(pageId.find("#appraisalEsignHeader"),ZPI18N.getString("zp.saving"));var params={mode:"savePAEsigConfig",isEnabled:pageId.find("#appraisalsignenabledisable").is(":checked")};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(callbackData){void 0!=callbackData.msg&&"success"==callbackData.msg?(PMSSetting.IS_APPRAISAL_ESIGN_ENABLED=callbackData.isAppraisalEsignEnabled,ZPeople.autosave.success(pageId.find("#appraisalEsignHeader"),ZPI18N.getString("zp.saved")),PMSSetting.closeResetSave(PMSCommon.SECTION_APPRAISAL_ESIGN)):void 0!=callbackData.msg&&"enable_sign_connection"==callbackData.msg&&(ZPeople.Message.failure(ZPI18N.getString("zp.paesign.nosignintegrationenabled")),PMSCommon.autosave.clearelement(pageId.find("#appraisalEsignHeader")),PMSCommon.autosave.enableHdrBtn(pageId.find("#appraisalEsignHeader")))})},validateGoalPeriority:function(){for(var pId=settingsPage.container,ids=["lowPriorityName","medPriorityName","higPriorityName","hisPriorityName"],params={},iter=0;iter<4;iter++){var textElement=pId.find("#"+ids[iter]),data=textElement.val().trim();if(data.length>50){(params={}).lenerror=ids[iter];break}if(0==data.length){(params={}).lenerror=ids[iter];break}PMSSetting.duplicateNameErrorMsg(textElement,data)?!0:params[PMSSetting.goalPriorityCode[iter]]=data}return params},getResetGoalPriorityNames:function(){var pId=settingsPage.container;pId.find("#lowPriorityName").val(ZPeople.decodeTxt(PMSSetting.goalPriorityOptn[PMSSetting.goalPriorityCode[0]])),pId.find("#medPriorityName").val(ZPeople.decodeTxt(PMSSetting.goalPriorityOptn[PMSSetting.goalPriorityCode[1]])),pId.find("#higPriorityName").val(ZPeople.decodeTxt(PMSSetting.goalPriorityOptn[PMSSetting.goalPriorityCode[2]])),pId.find("#hisPriorityName").val(ZPeople.decodeTxt(PMSSetting.goalPriorityOptn[PMSSetting.goalPriorityCode[3]]))}},CR_CONSTANTS={MONTHLY:1,WEEKLY:2,BIWEEKLY:3,SEMIMONTHLY:4,SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,LASTDAY:32,NONE:-1,CURRENT_MONTH:0,NEXT_MONTH:1,WEEK_NAME:[ZPI18N.getString("zp.sunday"),ZPI18N.getString("zp.monday"),ZPI18N.getString("zp.tuesday"),ZPI18N.getString("zp.wednesday"),ZPI18N.getString("zp.thursday"),ZPI18N.getString("zp.friday"),ZPI18N.getString("zp.saturday")],SUPERSCRIPT:{1:"st",2:"nd",3:"rd",4:"th"}},PMSOperationCommon={ERRORBOX_TIME:null,focus:function(element){$(element).focus()},clearFocus:function(element){$(element).blur()},markInputError:function(Obj){null!=PMSOperationCommon.ERRORBOX_TIME&&clearTimeout(ZPUtil.ERRORBOX_TIME),$(Obj).addClass("ztextbox__error"),$(Obj).on("keyup",function(){PMSOperationCommon.resetInputError(Obj)}),PMSOperationCommon.ERRORBOX_TIME=setTimeout(function(){PMSOperationCommon.resetInputError(Obj)},3e3)},resetInputError:function(Obj){PMSOperationCommon.ERRORBOX_TIME=null,$(Obj).removeClass("ztextbox__error")},setNoData:function(insertElem,messgae,mode,title,desc,buttonName,isRemoveAppnd){var imgClass="zp_nd_nodata";"no_data_found"==mode?imgClass="zp_nd_nodata":"zp_nd_record"==mode?imgClass="zp_nd_record":"zp_nd_permission"==mode&&(imgClass="zp_nd_permission"),messgae=null!=messgae?messgae:"";desc=null!=desc?desc:"",buttonName=null!=buttonName?buttonName:"";(isRemoveAppnd||void 0==isRemoveAppnd)&&insertElem.html(""),insertElem.append('<div id="emptPage" class="zpl_crd wd100_per"><div class="zpl_crdcnt"><div class="zpl_Emptydata"><div><div class="zpl_emptimg '+imgClass+'"></div>'+(""!=messgae?"<h4>"+messgae+"</h4>":"")+"<p>"+desc+"</p>"+(""!=buttonName?'<font><button id="empBtnCrt" class="zlabel zlabel--blue zlabel--medium zpl_btnellips" title="'+buttonName+'"><span class="zpl_ellipsis">'+buttonName+"</span></button></font>":"")+"</div></div></div></div>"),$(insertElem).show()},clearNoData:function(clearEle){$(clearEle).html("")},populateUsers:function(eleId,initialSel,extraDtls,isMultiple,pageContainer,inpFormat,isDefaultValue,pModal){var ele=(pageContainer=pageContainer||settingsPage.container).find("#"+eleId),mode=ele.attr("searchmode")?ele.attr("searchmode"):"DATAVIEW";pModal=void 0!=pModal?pModal:$(ele).closest(".zpl_crd").length>0?$(ele).closest(".zpl_crd"):$(ele).closest(".zpl_mcnt");extraDtls=extraDtls||{};var defaultValue={id:"-1",text:ZPI18N.getString("zp.allemployees"),html:ZPI18N.getString("zp.allemployees"),value:"-1",photo:"/images/user.png"},skipDefaultValues=!1;extraDtls.skipDefaultValues&&(skipDefaultValues=extraDtls.skipDefaultValues,delete extraDtls.skipDefaultValues);var jsonParam={ele:ele,inpFormat:inpFormat,placeHolder:ZPI18N.getString("zp.select"),isMultiple:!!isMultiple,initCurrentUser:!1,type:1,limit:10,searchMode:mode,searchType:"emp",initialSelection:initialSel||null,initDefaultValues:!skipDefaultValues,pModal:pModal.length>0?pModal:void 0};return"select"===inpFormat&&(jsonParam.height="300px"),ele.attr("extraParamCallback")&&(jsonParam.extraParamCallback=PMSOperationCommon.getParamFuction(mode)),isDefaultValue&&(jsonParam.defaultOption=defaultValue),!initialSel&&isDefaultValue&&(jsonParam.initialSel=defaultValue),isMultiple&&(jsonParam.placeHolder=extraDtls.placeHolder?extraDtls.placeHolder:ZPI18N.getString("zp.allemployees"),jsonParam.initialSelection=initialSel?jsonParam.initialSelection:null,jsonParam.defaultOption=extraDtls.defaultOptionNeeded?jsonParam.defaultOption:null,delete extraDtls.placeHolder),extraDtls.defaultText&&(isMultiple?jsonParam.placeHolder=extraDtls.defaultText:(defaultValue.text=extraDtls.defaultText,defaultValue.html=extraDtls.defaultText),delete extraDtls.text),extraDtls.changeCallback&&(jsonParam.changeCallback=extraDtls.changeCallback,delete extraDtls.changeCallback),extraDtls.maxAllowedValues&&(jsonParam.maxAllowedValues=extraDtls.maxAllowedValues,delete extraDtls.maxAllowedValues),extraDtls.initCurrentUser&&(defaultValue.zuid=ZPeople.CURR_USER.zuid,defaultValue.id=ZPeople.CURR_USER.usererec,defaultValue.text=ZPeople.decodeTxt(ZPeople.CURR_USER.empid+" "+ZPeople.CURR_USER.name),defaultValue.html=ZPeople.CURR_USER.empid+" "+ZPeople.CURR_USER.name,defaultValue.photo=ZPeople.CURR_USER.thumb,jsonParam.initCurrentUser=!0,delete extraDtls.initCurrentUser),delete extraDtls.searchConf,jsonParam.extraparam=extraDtls||{},ModuleComp.Search.reset(jsonParam,!0),ModuleComp.Search.create(jsonParam)},getParamFuction:function(mode){let func="";return"PA_APPRAISALREVIEWNEW"==mode&&(func=AppraisalView.getConfigID),func},addClearCentreClass:function(isremove){settingsPage.container;settingsPage.container.parent().addClass("zpl_crdwthful"),isremove&&settingsPage.container.parent().removeClass("zpl_crdwthful")}},PMSOperation={CR_FS_ST_IDX:1,CY_FS_ST_IDX:1,CR_ST_DATE:null,CR_TO_DATE:null,CR_FETCH_MODE:"",TMPL_V_D_MODAL:null,REP_TO_NAME:ZPI18N.getString("zp.reportingto"),initialSort:!1,temp:new Array,salaryHikeCycle:new Array,appraisalCycle:new Array,temp:new Array,CR_START_IDX:0,KraMapDetails:"",mappingidx:"0",kraUsrformDtl:new Array,kraformDtl:new Array,multiraterDtl:new Array,competencyUsrformDtl:new Array,performanceappFormDtl:new Array,skillsformDtl:new Array,competencyformDtl:new Array,userSkillMapformDtl:new Array,tagComponentKeyNames:{},searchTagChooseList:[],searchTagSelectedList:[],chooseConponentList:[],selectedConponentList:[],kraSliderObj:{},formfieldName:"",KraMapDetails:[],CompMapDeatils:[],deletedskillmap:[],editedSkillMap:[],skillsetMappeddata:{},skillsetSearchResult:"",skillsetConst:{},mappedRuledesArray:[],NORMALIZATIONENABLECYCLE:[],NORMALIZATIONENABLEDALLCYCLE:[],APPRAISEERATINGDETALS:{},REVIEWNOTCOMP:!1,REASONFIELD:!1,REASONMANDFIELD:!1,NorStartIndex:1,manageAppraiseeSliderObj:{},includeEmpSliderObj:{},salHikeStatusEmpSliderObj:{},salHikeStatusfsb:{},individualChangeOrExclude:!1,notselectedreviewerloaded:!1,appraiseeArr:new Array,tempAppraisee:new Array,appraisalstartintx:1,CYCLE_LIST_TEMPLATE_PAGE:null,CYCLE_CONFIG_PAGE:null,LOAD_TMPL_DATA:null,CYCLE_APPLICABLE_KEYS:{APPL_LOC:ZPI18N.getString("zp.location"),APPL_ROLE:ZPI18N.getString("zp.role"),APPL_DEP:ZPI18N.getString("zp.department"),APPL_DES:ZPI18N.getString("zp.designation")},ALL_LOCATIONS:null,ALL_ROLES:null,ALL_DEPARTMENTS:null,ALL_DESIGNATION:null,ALL_LEVELS:null,nonAppraiseeList:[],tempNonAppraiseeList:[],nonAppraiseeListSIndex:1,nonAppraiseeDataList:{},nonAppraiseeDataSearchResult:"",isNonApplEmpSearchAllowed:!0,CR_NOT_APPLI_LST:[],TEMP_CR_NOT_APPLI_LST:[],APPLI_USER_START_IDX:-1,INCLUDE_EXCLUDE_USER_ARR:[],extendreviewrecid:null,pendingextendreview:new Array,startIndex:1,SHOW_CR_MODAL:null,SHOW_CR_NOT_APPLI_MODAL:null,TEMPAPPRAISERERECNO:"",normStartIndex:1,REVIEWNOTCOMP:!1,notSelectedApplicableKeys:["location","role","department","level","customDate","totalWrkExp"],TEMP_EMP_DETAILS:void 0,ONLOADAPPRISER:"",RATINGSUBMITTED:!1,APPRAISERANDSUBUSERDETAILS:[],SELECTEDAPPRAISER:null,APPRAISEERATINGDETALS:{},RATINGGIVENCOUNT:{},TOATLEMPLOYEEBYAPPRAISER:0,RATINGDETAILS:{},TOATALRATING:0,RATINGGIVENCOUNT:{},MANAGERSEARCHENABLE:!1,isLibraryModalOpen:!1,RESTRICT_KRA_WEIGHTAGE:null,RESTRICT_SKILLSET_WEIGHTAGE:null,RESTRICT_COMPETENCY_WEIGHTAGE:null,REVIEW_EXTENDPAGECNT:"100",REVIEW_EXTENDFOR:void 0,REVIEW_EXTENDSTATUS:[{"-2":ZPI18N.getString("zp.all")},{1:ZPI18N.getString("zp.extended")},{"-1":ZPI18N.getString("zp.pending")},{0:ZPI18N.getString("zp.declined")}],LIBRARY_MODE:"",firescrollback:{},nonAppraiseefsb:{},CYCLE_SORTPERIOD:"u",CYCLE_SORTSTATUS:"d",crRemainderUsrList:new Array,cycleDelStartIndex:1,reviewedExcludeList:new Array,tempNonExcludeList:new Array,isSelfAppraisalEnabled:!1,isMultiRaterEnabled:!1,isHikeEnabled:!1,isGroupByOrder:null,loadedData:null,CRREVIEW_DATA:null,CR_Self_Enabled:!1,teambudgetformDtl:[],ENABLED_MODULES:{},cycleStatusObj:{},isCyclelistViewLoaded:!1,isCyclelistpageLoaded:!1,cyclelistTempSIndex:0,cyclelistTempCycleStatusObj:{},isKraShow:!1,isCompShow:!1,isSkillShow:!1,isRevQuesShow:!1,isSummaryShow:!1,isOprMrSelectionAllowed:!1,isCycleManageDataAllowed:!1,isAllowedToManageCycle:!1,isAllowedToCycleStatus:!1,skillRecScrollLimit:25,CR_APPLI_USER_LIST:new Array,CR_NON_APPLI_USER_LIST:new Array,CR_APPLI_SEARCH_USER_LIST:new Array,CR_NON_APPLI_SEARCH_USER_LIST:new Array,CR_APPLI_FIRESCROLL_OBJ:{},CR_NON_APPLI_FIRESCROLL_OBJ:{},REMINDER_POKE_PREV_SEARCHTEXT:"",CR_OPR_PAGR:"",IS_ACTIVE_CYCLE_ONLY:!0,cyclelistTempIsActiveOnly:!1,skipHasChange:!1,REV_EXT_FILETR_NAME:null,LOAD_REV_EXT_DATA:null,iscfsDataAvailable:!1,DEF_METHODS_SIZE:4,IS_PERF_MOD_ENABLED:!1,IS_CR_REVEXT_ALLOWED:!1,IS_APPR_REVEXT_ALLOWED:!1,APPRAISAL_CYCLE_PREV_SEARCHTEXT:"",SALARY_CYCLE_PREV_SEARCHTEXT:"",kraWeightageRange:!1,kraWeightageRangeMandatory:!1,isKRAWeightageRestirctionEnabled:!1,kraWeightageModValue:1,KRA_MAPPING_CONFIG:{type:0},kraSettingInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!1),PMSOperation.destoryComponentObj(),pageId.html(""),$.ajax({type:"POST",async:!0,url:"/performance/view/kraSettings",data:{conreqcsr:csrfToken},success:function(resultData){pageId.append(resultData),"true"==PMSOperation.isKraShow&&(PMSOperation.getformDetails("kraUserform"),PMSOperation.getKraList())}})}},getKraList:function(){$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getkra",conreqcsr:csrfToken,type:0},success:function(resultData){PMSOperation.constructKRAPage(resultData)}})},constructKRAPage:function(resultData){var pageId=settingsPage.container;if(!ZPeopleComponents.isComponent("#kramenuiconimpexpmapping")){var mapMenu=ZPeopleComponents.menu("#kramenuiconimpexpmapping",{forElement:pageId.find("#kramappingimportexpbtn"),className:"",itemclick:e=>{PMSOperation.skillsetMapMenu(e)}});pageId.find("#kramappingimportexpbtn").off("click").on("click",function(ev){mapMenu.show()})}var _tokenObj={},_options=[];_options.push({name:ZPI18N.getString("zp.designation"),id:"0"}),_options.push({name:ZPI18N.getString("zp.department"),id:"1"}),_options.push({name:ZPI18N.getString("zp.location"),id:"2"}),resultData.formfieldDetails.isAvailable&&_options.push({name:resultData.formfieldDetails.displayName,id:"6"}),_options.push({name:ZPI18N.getString("zp.designation")+" & "+ZPI18N.getString("zp.department"),id:"3"}),resultData.formfieldDetails.isAvailable&&(_options.push({name:ZPI18N.getString("zp.designation")+" & "+resultData.formfieldDetails.displayName,id:"4"}),_options.push({name:ZPI18N.getString("zp.designation")+" "+resultData.formfieldDetails.displayName+" & "+ZPI18N.getString("zp.department"),id:"5"})),_tokenObj.options=_options,_tokenObj.contentType="text",_tokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},_tokenObj.removeExistingDropdown=!0,_tokenObj.search={by:["name"],highlightKeyword:!0},_tokenObj.value="0",ZPeopleComponents.select(pageId.find("#desdepselect"),_tokenObj),$(pageId.find("#desdepselect")).on("zselectchange",PMSOperation.switchkrasubtabs),PMSOperation.tagComponentKeyNames={},PMSOperation.tagComponentKeyNames.NameKey="kraName",PMSOperation.tagComponentKeyNames.IdKey="kraId",PMSOperation.tagComponentKeyNames.weightageKey="weightage",PMSOperation.tagComponentKeyNames.descKey="kraDes",PMSOperation.tagComponentKeyNames.comName="kra",resultData.kraDetails&&resultData.kraDetails.kraList&&resultData.kraDetails.kraList.length>0||resultData.userKraDetails&&resultData.userKraDetails.kraList&&resultData.userKraDetails.kraList.length>0?(PMSOperation.ALL_KRA=resultData.kraDetails&&resultData.kraDetails.kraList&&resultData.kraDetails.kraList.length>0?resultData.kraDetails.kraList:[],PMSOperation.ALL_KRA_USERMAPID_DETAILS=void 0!=resultData.kraDetails.kraUserIdList?resultData.kraDetails.kraUserIdList:{},PMSOperation.constructKraMapping(resultData.ddlMapping,void 0!=resultData.isNextAvailable&&resultData.isNextAvailable),resultData.KRAWeightageRestirctionValue.hasOwnProperty("modVal")?(AppraisalConfig.kraWeightageModValue=resultData.KRAWeightageRestirctionValue,AppraisalConfig.isKRAWeightageRestirctionEnabled=!0):AppraisalConfig.isKRAWeightageRestirctionEnabled=!1):(PMSOperation.ALL_KRA=[],PMSOperation.moduleDefaultNoData("KRA")),void 0!=resultData.userKraDetails&&void 0!=resultData.userKraDetails.kraList&&resultData.userKraDetails.kraList.length>0?(PMSOperation.ALL_USER_KRA=resultData.userKraDetails.kraList,PMSOperation.USER_KRA_EMP_DETAILS=void 0!=resultData.userKraDetails.empList?resultData.userKraDetails.empList:{},PMSOperation.USER_KRA_MAPID_DETAILS=void 0!=resultData.userKraDetails.kraUserIdList?resultData.userKraDetails.kraUserIdList:{}):(PMSOperation.ALL_USER_KRA=[],PMSOperation.USER_KRA_EMP_DETAILS={},PMSOperation.USER_KRA_MAPID_DETAILS={}),resultData.kraWeightageRange?PMSOperation.kraWeightageRange=resultData.kraWeightageRange:PMSOperation.kraWeightageRange=!1,PMSOperation.formfieldName=resultData.formfieldDetails.displayName,(PMSOperation.ALL_KRA.length>0||PMSOperation.ALL_USER_KRA.length>0)&&pageId.find("#kralibrarybtn").show()},moduleDefaultNoData:function(mode){var pageId=settingsPage.container;if("KRA"==mode){var _btnName=ZPI18N.getString("zp.add")+" "+PMSSetting.KRA_DISPLAY_NAME;PMSOperationCommon.setNoData(pageId.find("#cardview-mapcontent"),ZPI18N.getString("zp.pa.nodataadded",new Array(PMSSetting.KRA_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.addkramsg",new Array(PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME)),_btnName),ZPeopleComponents.isComponent("#kramenuiconimpexpmapping")&&ZPeopleComponents.menu("#kramenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#kramenuiconimpexpmapping").getMenuItemAt("1").attr("id")])}else if("COMPETENCY"==mode){_btnName=ZPI18N.getString("zp.add")+" "+PMSSetting.COMPETENCY_DISPLAY_NAME;PMSOperationCommon.setNoData(pageId.find("#competencyMapping"),ZPI18N.getString("zp.pa.nodataadded",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.addcompetencymsg",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME)),_btnName),ZPeopleComponents.isComponent("#compmenuiconimpexpmapping")&&ZPeopleComponents.menu("#compmenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#compmenuiconimpexpmapping").getMenuItemAt("1").attr("id")])}pageId.find("#kralibrarybtn").hide(),pageId.find("#kramappingbtn").hide(),pageId.find("#empBtnCrt").click(function(){PMSOperation.openLibrarySlider(mode)})},switchkrasubtabs:function(event){var data=event.detail,pageId=settingsPage.container;pageId.find("#cardview-mapcontent").html(""),pageId.find("#cardview-mapcontent").html(ZPeople.LOADING_HTML),PMSOperation.getKraMaping(data.value),PMSOperation.mappingidx=data.value},getKraMaping:function(type){PMSOperation.KRA_MAPPING_CONFIG.startIndex=1;var params={mode:"getkramapping",conreqcsr:csrfToken,type:type,sIndex:PMSOperation.KRA_MAPPING_CONFIG.startIndex};PMSOperation.KRA_MAPPING_CONFIG.type=type,$.post("/performanceConfig.zp",params,function(resultData){PMSOperation.constructKraMapping(resultData.ddlMapping,void 0!=resultData.isNextAvailable&&resultData.isNextAvailable)})},getKraMappingFireScroll:function(){var params={mode:"getkramapping",conreqcsr:csrfToken,type:PMSOperation.KRA_MAPPING_CONFIG.type,sIndex:PMSOperation.KRA_MAPPING_CONFIG.startIndex};$.post("/performanceConfig.zp",params,function(resultData){if(resultData.ddlMapping.length>0&&(PMSOperation.KraMapDetails=PMSOperation.KraMapDetails.concat(resultData.ddlMapping),PMSOperation.constructKRAMappingRow(resultData.ddlMapping),void 0!=resultData.isNextAvailable&&resultData.isNextAvailable)){PMSOperation.KRA_MAPPING_CONFIG.startIndex=void 0!=PMSOperation.KRA_MAPPING_CONFIG.startIndex?PMSOperation.KRA_MAPPING_CONFIG.startIndex+10:11;new FireScrollBack(PMSOperation.getKraMappingFireScroll,settingsPage.container,"kramappingsc")}})},constructKRAMappingRow:function(dataobj){var pageId=settingsPage.container;$.each(dataobj,function(index,data){if(Object.keys(data.kramapping).length>0){var mapName="",_mapNameHtm="",mapcount=0;$.each(data.mapingDetails,function(index,data){mapcount<PMSOperation.DEF_METHODS_SIZE&&(0!=index&&(mapName+=",&nbsp;"),mapName+=" "+ZPeople.decodeTxt(data.mapName)+" ",_mapNameHtm+="<h5>"+data.mapName+"</h5>"),mapcount++});var idobje="",mapid="";void 0!=data.ruleId&&-1!=data.ruleId?(idobje='ruleid="'+data.ruleId+'"',void 0!=data.ruleLen&&1==data.ruleLen&&(idobje+=' isSingle="true"'),mapid=data.ruleId):(idobje='id="'+data.mapingDetails[0].mapId+'"',mapid=data.mapingDetails[0].mapId);var row='<div class="zpl_crd"  id="'+mapid+'"> <div class="zpl_crdcnt"><div class="zpl_secn"><div><ul class="zpl_paperent" id="desmap_'+mapid+'">';if(void 0!=data.lvlName&&(_mapNameHtm+="<h5>"+data.lvlName+"</h5>"),row+="<li "+idobje+"><div>"+_mapNameHtm,void 0!=data.designationrule){var designationrule="",i=0;if($.each(data.designationrule,function(index1,data1){i<PMSOperation.DEF_METHODS_SIZE&&(designationrule+=0==i?data1.depName:", "+data1.depName),i++}),""!=designationrule)if(row+='<span class="zpl_dots"></span>',data.designationrule.length>PMSOperation.DEF_METHODS_SIZE){var blncCnt=data.designationrule.length-PMSOperation.DEF_METHODS_SIZE;row+="<em>"+designationrule+',&nbsp;</em><div class="zpl_tg" title="'+ZPI18N.getString("zp.more")+'"><a id="showMore_'+mapid+'" mapid="'+mapid+'">+'+blncCnt+"</a></div>"}else row+="<em>"+designationrule+"</em>"}var isAllDisable=!0;-1!=mapid&&1!=mapid&&"All"!=mapName.trim()&&(isAllDisable=!1),row+="</div>",data.mapingDetails.length>PMSOperation.DEF_METHODS_SIZE&&(row+='<div class="zpl_tg" title="'+ZPI18N.getString("zp.more")+'"><a id="showMore_'+mapid+'" mapid="'+mapid+'">+'+(data.mapingDetails.length-PMSOperation.DEF_METHODS_SIZE)+"</a></div>"),row+='<div class="zpl_hvr"> ',row+='<i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+'" onclick="PMSOperation.editkramapnew(this,\''+isAllDisable+'\');" ></i><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.kradelconfrim(\'kramap_confirm\', this);"></i> </div></li>',$.each(data.kramapping,function(index1,data1){row+='<li class="zpl_pavlu"  id="'+data1.kraId+'"> ',PMSOperation.kraUsrformDtl.WEIGHTAGE||(row+="<b>"+data1.weightage+"%</b>"),row+="<span>"+data1.kraName+"</span> </li>"}),row+="</ul></div></div></div> </div>",(row=$(row)).data("ldata",data),pageId.find("#cardview-mapcontent").append(row)}}),pageId.find("[id^=showMore_]").unbind(),pageId.find("[id^=showMore_]").on("click",event=>{PMSOperation.showMorePopOver(event,3===optiontype?"KRA_DES_DEP":"KRA")})},constructKraMapping:function(dataobj,isNext){var pageId=settingsPage.container;if(PMSOperation.KraMapDetails=dataobj,pageId.find("#cardview-mapcontent").html(""),dataobj.length>0){ZPeopleComponents.isComponent("#kramenuiconimpexpmapping")&&ZPeopleComponents.menu("#kramenuiconimpexpmapping").showMenuItems(["#"+ZPeopleComponents.menu("#kramenuiconimpexpmapping").getMenuItemAt("1").attr("id")]),pageId.find("#kralibrarybtn").show(),pageId.find("#kramappingbtn").show();var optiontype=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue());if(PMSOperation.constructKRAMappingRow(dataobj),PMSOperation.mapMenu={},pageId.find("#cardview-mapcontent .zpl_crd").each(function(index,element){const moreBtn=$(element).find(".PI_more");moreBtn.length>0&&(PMSOperation.mapMenu[$(element).attr("id")]=ZPeopleComponents.menu($(element).find(".zpl_drpdwn"),{forElement:moreBtn}))}),pageId.find("#cardview-mapcontent .zpl_crd .PI_more").on("click",function(ev){PMSOperation.mapMenu[$(this).attr("mapid")].show()}),pageId.find("[id^=showMore_]").unbind(),pageId.find("[id^=showMore_]").on("click",event=>{PMSOperation.showMorePopOver(event,3===optiontype?"KRA_DES_DEP":"KRA")}),isNext){PMSOperation.KRA_MAPPING_CONFIG.startIndex=void 0!=PMSOperation.KRA_MAPPING_CONFIG.startIndex?PMSOperation.KRA_MAPPING_CONFIG.startIndex+10:11;new FireScrollBack(PMSOperation.getKraMappingFireScroll,pageId,"kramappingsc")}}else if(ZPeopleComponents.isComponent("#kramenuiconimpexpmapping")&&ZPeopleComponents.menu("#kramenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#kramenuiconimpexpmapping").getMenuItemAt("1").attr("id")]),PMSOperation.ALL_KRA.length>0){var _btnName=ZPI18N.getString("zp.tag.module",new Array(PMSSetting.KRA_DISPLAY_NAME));PMSOperationCommon.setNoData(pageId.find("#cardview-mapcontent"),ZPI18N.getString("zp.pa.norectagged",new Array(PMSSetting.KRA_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.tagkramsg",new Array(PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME)),_btnName),pageId.find("#kralibrarybtn").show(),pageId.find("#kramappingbtn").hide(),pageId.find("#empBtnCrt").click(function(){PMSOperation.tagKra()})}else PMSOperation.moduleDefaultNoData("KRA")},showMorePopOver:function(event,mode){var pageId=settingsPage.container;let mapId=$(event.currentTarget)[0].getAttribute("mapid"),mapData=void 0,depObj=void 0,depIDKey="depId",depNameKey="depName";switch(mode){case"KRA":depObj=(mapData=pageId.find("#"+mapId).data("ldata")).mapingDetails,depIDKey="mapId",depNameKey="mapName";break;case"KRA_DES_DEP":depObj=(mapData=pageId.find("#"+mapId).data("ldata")).designationrule;break;case"SKILL":depObj=(mapData=pageId.find("#skilldesDep_"+mapId).data()).depList;break;case"COMPETENCY":depObj=(mapData=pageId.find("#compmap_"+mapId).data("ldata")).designationrule;break;case"REV_QUS":depObj=(mapData=pageId.find("#compmap_"+mapId).data()).desDepval;break;default:mapData=pageId.find("#"+mapId).data()}0==pageId.find("#pms_methods_showPopOver").length&&pageId.append($('<div id="pms_methods_showPopOver" class="zpl_popovr zpl_fltrvw-popovr" data-type="list" data-content-type="icon-text" role="menu" tabindex="0" aria-hidden="true"></div>'));let _html="";if("REV_QUS"===mode){if(Object.keys(depObj).length>PMSOperation.DEF_METHODS_SIZE){_html='<ul data-body="true" class="zpl_fltrvwlst">';let desDepCnt=0;$.each(depObj,function(key,value){desDepCnt>=PMSOperation.DEF_METHODS_SIZE&&(_html+='<li index="'+desDepCnt+'" optionId="'+key+'">',_html+='<span id="textSpan" title="'+value+'">'+value+"</span>",_html+="</li>"),desDepCnt++}),_html+="</ul>"}}else if(depObj.length>PMSOperation.DEF_METHODS_SIZE){_html='<ul data-body="true" class="zpl_fltrvwlst">';for(let index=PMSOperation.DEF_METHODS_SIZE;index<depObj.length;index++){let desDts=depObj[index];_html+='<li index="'+index+'" optionId="'+desDts[depIDKey]+'">',_html+='<span id="textSpan" title="'+desDts[depNameKey]+'">'+desDts[depNameKey]+"</span>",_html+="</li>"}_html+="</ul>"}ZPeopleComponents.popover(pageId.find("#pms_methods_showPopOver")).destroy(),""!==_html&&(pageId.find("#pms_methods_showPopOver").html(_html),ZPeopleComponents.popover(pageId.find("#pms_methods_showPopOver"),{forElement:$(event.currentTarget),appendTo:pageId,position:"bottom",displayType:"box",closeOnScroll:!0}),ZPeopleComponents.popover(pageId.find("#pms_methods_showPopOver")).open())},editkramapnew:function(obj,isAllDisable){PMSOperation.loadMappingHtml("edit","KRA"),PMSOperation.setWeightageValidationKey("kra");var sliderEle=$(PMSOperation.sliderObj.sliderDiv),pageId=settingsPage.container;PMSOperation.chooseConponentList=new Array,PMSOperation.selectedConponentList=new Array,PMSOperation.searchTagChooseList=new Array,PMSOperation.searchTagSelectedList=new Array;var optType=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue());PMSOperation.getTokenDataSource(optType,isAllDisable,"EDIT"),$("#ddlselect").addClass("DN"),$("#levelselect").addClass("DN"),$("#depselect").addClass("DN"),$("#desselect").addClass("DN");var labl="";0==optType?labl=ZPI18N.getString("zp.designation"):1==optType?labl=ZPI18N.getString("zp.department"):2==optType?labl=ZPI18N.getString("zp.location"):6==optType&&(labl=PMSOperation.formfieldName);var valob=$(obj).parent().parent().parent().parent().parent().parent().parent().data().ldata;if(PMSOperation.loadedData=valob,void 0!=valob){PMSOperation.kramapold={};var kramapingAry=[];if(0==optType||1==optType||2==optType||6==optType){sliderEle.find("#ddlselect").removeClass("DN"),$(sliderEle.find("#ddlselect label")[0]).html(labl);var recId=valob.ruleId;void 0==recId?(recId=valob.mapingDetails[0].mapId,PMSOperation.editkraRuleId=-1):PMSOperation.editkraRuleId=recId,$.each(PMSOperation.KraMapDetails,function(index,data){var reqId=data.ruleId;if(void 0==reqId&&(reqId=data.mapingDetails[0].mapId),recId==reqId){var idarr=[],selectedArr=[];$.each(data.mapingDetails,function(index1,data1){selectedArr.push({id:data1.mapId,name:ZPeople.decodeTxt(data1.mapName)}),idarr.push(data1.mapId)});var options={};options.values=selectedArr,ZPeopleComponents.tokenfield($("#ddl_list")).setAttributes(options),kramapingAry=data.kramapping}})}else 3!=optType&&4!=optType&&5!=optType||(sliderEle.find("#desselect").removeClass("DN"),recId=valob.ruleId,PMSOperation.editkraRuleId=recId,$.each(PMSOperation.KraMapDetails,function(index,data){if(recId==data.ruleId){if(data.kramapping,(selectedArr=[]).push({id:data.mapingDetails[0].mapId,name:data.mapingDetails[0].mapName}),(options={}).value=selectedArr,options.disabled=!0,ZPeopleComponents.select($("#des_list")).setAttributes(options),3==optType||5==optType){sliderEle.find("#depselect").removeClass("DN");var options,selectedArr=[];$.each(data.designationrule,function(index1,data1){selectedArr.push({id:data1.depId,name:ZPeople.decodeTxt(data1.depName)})}),(options={}).values=selectedArr,ZPeopleComponents.tokenfield($("#dep_list")).setAttributes(options)}4!=optType&&5!=optType||(sliderEle.find("#levelselect").removeClass("DN"),ZPeopleComponents.select($("#lvl-list")).setValue(data.lvlId)),kramapingAry=data.kramapping}}));if(Object.keys(kramapingAry).length>0){Array.isArray(kramapingAry)&&(kramapingAry=PMSOperation.convertArrayToObject(kramapingAry,"kraId")),PMSOperation.kramapold=Object.assign({},kramapingAry),PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.removeAllElementInTagComponent("csekralst"),PMSOperation.kraUsrformDtl.WEIGHTAGE&&pageId.find("#sltKra_wghthd").find("#kraweightage b").text("");var csefkralst="",cselkralst="",sltkralst="";$.each(PMSOperation.ALL_KRA,function(i,val){if("-1"!=val.approvalStatus){var temp,tempkraId=val.kraId;if(void 0!=kramapingAry[tempkraId])(temp={}).kraName=val.kraName,temp.kraId=tempkraId,temp.weightage=kramapingAry[tempkraId].weightage,PMSOperation.selectedConponentList.push(temp),sltkralst+=PMSOperation.tagComponentSelectedlistElementConstruction(tempkraId,val.kraName,PMSOperation.kraUsrformDtl.WEIGHTAGE,temp.weightage,"KRA"),csefkralst+=PMSOperation.tagComponentChooseListElementConstruction(tempkraId,val.kraName,!0);else(temp={}).kraName=val.kraName,temp.kraId=tempkraId,PMSOperation.chooseConponentList.push(temp),cselkralst+=PMSOperation.tagComponentChooseListElementConstruction(tempkraId,val.kraName)}}),sliderEle.find("#sltkralst").append(sltkralst),PMSOperation.tagComponentSelectedlistAfterConstruction(PMSOperation.selectedConponentList,"edit"),sliderEle.find("#csekralst").append(csefkralst+cselkralst),PMSOperation.tagComponentChooselistafterConstruction(PMSOperation.selectedConponentList.concat(PMSOperation.chooseConponentList),"edit",PMSOperation.tagComponentKeyNames.comName),PMSOperation.changeSelectedCount()}}PMSOperation.chooseSelectAllReset()},loadMappingHtml:function(mode,module){var pageId=settingsPage.container;PMSOperation.sliderObj={},null!=PMSOperation.ALL_DESIGNATION&&null!=PMSOperation.ALL_DEPARTMENTS&&null!=PMSOperation.ALL_LOCATIONS&&null!=PMSOperation.ALL_LEVELS&&null!=PMSOperation.ALL_ROLES||$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getroles_designation",conreqcsr:csrfToken},success:function(data){PMSOperation.ALL_DESIGNATION=data.designations,PMSOperation.ALL_DEPARTMENTS=data.departmentList,PMSOperation.ALL_LOCATIONS=data.locationList,PMSOperation.ALL_ROLES=data.roleList,PMSOperation.ALL_LEVELS=data.designationLevelList}});var tabName="";"KRA"==module?tabName=PMSSetting.KRA_DISPLAY_NAME:"COMPETENCY"==module?tabName=PMSSetting.COMPETENCY_DISPLAY_NAME:"SKILL"==module?tabName=PMSSetting.skilldispName:"REVQES"==module&&(tabName=PMSSetting.QUS_ANS_DISPLAY_NAME);var sliderTab=new Tab("oprmoduletagslider",function(){if("KRA"==module){var optType=ZPeopleComponents.select(pageId.find("#desdepselect")).getValue(),noteStr=ZPI18N.getString("zp.notetagcomponent",new Array(tabName)),row='<div class="zpl_crd"> <div class="zpl_crdcnt zpl_crdinfo"> <div>';row+='<div class="zpl_secn DN" id="ddlselect"><div><label>'+ZPI18N.getString("zp.designation")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><textarea id="ddl_list"></textarea><span class="ztextbox--error__label" id="deserr" style="display:none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div></div>",row+='<div class="zpl_secn DN" id="desselect"><div><label>'+ZPI18N.getString("zp.designation")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><select  data-show-search-field="true" data-lazy-loading="true"   id="des_list"></select><span class="ztextbox--error__label" id="deserr" style="display:none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div></div> ",row+='<div class="zpl_secn DN" id="levelselect"><div><label>'+PMSOperation.formfieldName+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;">',row+="5"==optType||"4"==optType?'<select  data-show-search-field="true" data-lazy-loading="true"   id="lvl-list"></select>':'<textarea id="lvl-list"></textarea>',row+='<span class="ztextbox--error__label" id="des-lvl-err" style="display:none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div> </div>",row+='<div class="zpl_secn DN" id="depselect"><div><label>'+ZPI18N.getString("zp.departments")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><textarea id="dep_list"></textarea><span class="ztextbox--error__label" id="deperr" style="display:none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div> </div>",row+='</div> <div class="zpl_info DN"> <p id="weightagenote">'+noteStr+'</p><p class="DN" id="selectedCnt"></p><p class="DN" id="weightagetotal"></p> </div> </div> </div>',row+='<div class="zpl_pachokeylst"><div>',row+='<header><div><div class="zcheckbox" onchange="PMSOperation.chooseAllElementsinList(this,\'KRA\')">',row+='<input id="cseKra_tpHd" type="checkbox" name="check" class="zcheckbox__helper ztextbox_opn">',row+='<label for="cseKra_tpHd" class="zcheckbox__label"><b class="zpl_ellipsis" style="max-width: 300px;display: block;" title="'+ZPI18N.getString("zp.choosePA",new Array(PMSSetting.KRA_DISPLAY_NAME))+'">'+ZPI18N.getString("zp.choosePA",new Array(PMSSetting.KRA_DISPLAY_NAME))+"</b></label></div>",row+='<div class="MLauto d-flexC flexclmcap">',row+='<span class="red CP" style="display : none" id="leftclearsearch" onclick="PMSOperation.clearComponentSearch(\'chooseKra\',\'KRA\')">'+ZPI18N.getString("zp.clearsearch")+"</span>",row+='<i class="PI_lens" id="lftSearchButton" title="'+ZPI18N.getString("zp.search")+'"></i>',row+='<a data-popup-open="AddKeyAccountabilityform" class="zpl_ellipsis" style="max-width: 100px;" title="'+ZPI18N.getString("zp.addcomponents",[PMSSetting.KRA_DISPLAY_NAME])+'"><b onclick="PMSOperation.addKRAPopup(this,\'KRA\')">'+ZPI18N.getString("zp.addcomponents",[PMSSetting.KRA_DISPLAY_NAME])+"</b></a>",row+="</div>",row+="</div>",row+=' <div id="lftSearchpopover" data-is-content-html-encoded="true" data-for-element="#lftSearchButton" data-position="bottom" style="display: none;"><div class="zpl_search zpl_srchsml" style="width: 220px"><input id="choosekraSearch" onkeyup="PMSOperation.tagComponentSearch(this,\'chooseKra\',\'KRA\')" placeholder="'+ZPI18N.getString("zp.search")+'" type="text" class="ztextbox"><i class="PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i></div></div>',row+="</header>",row+='<ul id="csekralst"></ul></div>',row+="<div>",row+="<header>",row+='<div class="zpl_twoclum" id="sltKra_wghthd"><div><b class="zpl_ellipsis" style="max-width: 300px;display: block;" title="'+tabName+'">'+tabName+'</b></div><div id="kraweightage">',PMSOperation.kraWeightageRange?(row+='<b class="zpl_w120">'+ZPI18N.getString("zp.weightage")+"</b>",row+=PMSOperation.kraWeightageRange?"<b>"+ZPI18N.getString("zp.range")+"</b>":""):row+="<b>"+ZPI18N.getString("zp.weightage")+"</b>",row+='<i class="PI_lens MLauto" id="rgtSearchButton" title="'+ZPI18N.getString("zp.search")+'"></i>',row+='<span class="red CP" style="display : none" id="rightclearsearch" onclick="PMSOperation.clearComponentSearch(\'selectedKra\',\'KRA\')">'+ZPI18N.getString("zp.clearsearch")+"</span>",row+="</div></div>",row+=' <div id="rgtSearchpopover" data-is-content-html-encoded="true" data-for-element="#rgtSearchButton" data-position="bottom" style="display: none;"><div class="zpl_search zpl_srchsml" style="width: 220px"><input id="chooseSelectedKra" onkeyup="PMSOperation.tagComponentSearch(this,\'selectedKra\',\'KRA\')" placeholder="'+ZPI18N.getString("zp.search")+'" type="text" class="ztextbox"><i class="PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i></div></div>',row+="</header>",row+='<ul id="sltkralst"> </ul></div>',row+="</di>"}else if("SKILL"==module){noteStr=ZPI18N.getString("zp.notetagcomponent",new Array(tabName)),row='<div class="zpl_crd"> <div class="zpl_crdcnt zpl_crdinfo"> <div>';row+='<div class="zpl_secn" id="domainselect"><div><label>'+ZPI18N.getString("zp.domainname")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><input type="text" id="domainSearch" class="ztextbox"> </div><span class="ztextbox--error__label" id="domainExists" style="display:none">'+ZPI18N.getString("zp.domainexist")+'</span><span class="ztextbox--error__label" id="domainEmpty" style="display:none">'+ZPI18N.getString("zp.domainempty")+"</span></div>",row+='<div class="zpl_secn DN" id="designationselect"><div><label>'+ZPI18N.getString("zp.designation")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><select id="desDepRoleselect"  data-show-search-field="true" data-lazy-loading="true"   ></select><span class="ztextbox--error__label" id="deserr" style="display:none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div></div> ",row+='<div class="zpl_secn DN" id="departmentselect"><div><label>'+ZPI18N.getString("zp.departments")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><select  data-show-search-field="true" data-lazy-loading="true"   id="depselect" ></select><span class="ztextbox--error__label" id="deperr" style="display:none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div></div> ",row+='<div class="zpl_secn DN" id="desselect"><div><label>'+ZPI18N.getString("zp.designation")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><select  data-show-search-field="true" data-lazy-loading="true"   id="des_list" ></select><span class="ztextbox--error__label" id="designerr" style="display:none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div></div> ",row+='<div class="zpl_secn DN" id="desDepartmentselect"><div><label>'+ZPI18N.getString("zp.departments")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><textarea id="desDepselect"></textarea><span class="ztextbox--error__label" id="desdeperr" style="display:none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div></div> ",row+='</div> <div class="zpl_info DN"> <p id="weightagenote">'+noteStr+'</p><p class="DN" id="selectedCnt"></p><p class="DN" id="weightagetotal"></p>  </div> </div> </div>',row+='<div class="zpl_pachokeylst"><div>',row+='<header><div><div class="zcheckbox" onchange="PMSOperation.chooseAllElementsinList(this,\'SKILL\')">',row+='<input id="cseKra_tpHd" type="checkbox" name="check" class="zcheckbox__helper ztextbox_opn">',row+='<label for="cseKra_tpHd" class="zcheckbox__label"><b class="zpl_ellipsis" style="max-width: 300px;display: block;" title="'+ZPI18N.getString("zp.choosePA",new Array(PMSSetting.skilldispName))+'">'+ZPI18N.getString("zp.choosePA",new Array(PMSSetting.skilldispName))+"</b></label></div>",row+='<div class="MLauto d-flexC flexclmcap">',row+='<span class="red CP" style="display : none" id="leftclearsearch" onclick="PMSOperation.clearComponentSearch(\'chooseKra\',\'SKILL\')">'+ZPI18N.getString("zp.clearsearch")+"</span>",row+='<i class="PI_lens" id="lftSearchButton" title="'+ZPI18N.getString("zp.search")+'"></i>',row+='<a data-popup-open="AddKeyAccountabilityform" class="zpl_ellipsis" style="max-width: 100px;"><b onclick="PMSOperation.addKRAPopup(this,\'SKILL\')" title="'+ZPI18N.getString("zp.addcomponents",[PMSSetting.skilldispName])+'">'+ZPI18N.getString("zp.addcomponents",[PMSSetting.skilldispName])+"</b></a>",row+="</div>",row+="</div>",row+=' <div id="lftSearchpopover" data-is-content-html-encoded="true" data-for-element="#lftSearchButton" data-position="bottom" style="display: none;"><div class="zpl_search zpl_srchsml" style="width: 220px"><input id="choosekraSearch" onkeyup="PMSOperation.tagComponentSearch(this,\'chooseKra\',\'Skill  Set\')" placeholder="'+ZPI18N.getString("zp.search")+'" type="text" class="ztextbox"><i class="PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i></div></div>',row+="</header>",row+='<ul id="csekralst"></ul></div>',row+="<div><header>",row+='<div class="zpl_twoclum" id="sltKra_wghthd"><div><b class="zpl_ellipsis" style="max-width: 300px;display: block;" title="'+PMSSetting.skilldispName+'">'+PMSSetting.skilldispName+'</b></div><div ><b id="skillweightagediv">'+ZPI18N.getString("zp.weightage")+"</b>",row+='<i class="PI_lens MLauto" id="rgtSearchButton" title="'+ZPI18N.getString("zp.search")+'"></i>',row+='<span class="red CP" style="display : none" id="rightclearsearch" onclick="PMSOperation.clearComponentSearch(\'selectedKra\',\'SKILL\')">'+ZPI18N.getString("zp.clearsearch")+"</span>",row+="</div></div>",row+=' <div id="rgtSearchpopover" data-is-content-html-encoded="true" data-for-element="#rgtSearchButton" data-position="bottom" style="display: none;"><div class="zpl_search zpl_srchsml" style="width: 220px"><input id="chooseSelectedKra" onkeyup="PMSOperation.tagComponentSearch(this,\'selectedKra\',\'SKILL\')" placeholder="'+ZPI18N.getString("zp.search")+'" type="text" class="ztextbox"><i class="PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i></div></div>',row+="</header>",row+='<ul id="sltkralst"> </ul></div>',row+="</di>"}else if("COMPETENCY"==module){noteStr=ZPI18N.getString("zp.notetagcomponent",new Array(tabName)),row='<div class="zpl_crd"> <div class="zpl_crdcnt zpl_crdinfo"> <div>';row+='<div class="zpl_secn" id="desselect"><div><label>'+ZPI18N.getString("zp.designation")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><select data-show-search-field="true" data-lazy-loading="true"  id="desDepRoleselect"></select><span class="ztextbox--error__label" id="deserr" style="display:none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div></div>",row+='<div class="zpl_secn DN" id="depselectcomp"><div><label>'+ZPI18N.getString("zp.departments")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><textarea id="dep_list_comp"></textarea><span class="ztextbox--error__label" id="deperrcomp" style="display:none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div></div> ",row+='</div> <div class="zpl_info DN"> <p id="weightagenote">'+noteStr+'</p><p class="DN" id="selectedCnt"></p><p class="DN" id="weightagetotal"></p>   </div> </div> </div>',row+='<div class="zpl_pachokeylst"><div>',row+='<header><div><div class="zcheckbox" onchange="PMSOperation.chooseAllElementsinList(this,\'COMPETENCY\')">',row+='<input id="cseKra_tpHd" type="checkbox" name="check" class="zcheckbox__helper ztextbox_opn">',row+='<label for="cseKra_tpHd" class="zcheckbox__label"><b class="zpl_ellipsis" style="max-width: 300px;display: block;" title="'+ZPI18N.getString("zp.choosePA",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME))+'"">'+ZPI18N.getString("zp.choosePA",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME))+"</b></label></div>",row+='<div class="MLauto d-flexC flexclmcap">',row+='<span class="red CP" style="display : none" id="leftclearsearch" onclick="PMSOperation.clearComponentSearch(\'chooseKra\',\'COMPETENCY\')">'+ZPI18N.getString("zp.clearsearch")+"</span>",row+='<i class="PI_lens" id="lftSearchButton" title="'+ZPI18N.getString("zp.search")+'"></i>',row+='<a data-popup-open="AddKeyAccountabilityform" class="zpl_ellipsis" style="max-width: 100px;" title="'+ZPI18N.getString("zp.addcomponents",[PMSSetting.COMPETENCY_DISPLAY_NAME])+'"><b onclick="PMSOperation.addKRAPopup(this,\'COMPETENCY\')">'+ZPI18N.getString("zp.addcomponents",[PMSSetting.COMPETENCY_DISPLAY_NAME])+"</b></a>",row+="</div>",row+="</div>",row+=' <div id="lftSearchpopover" data-is-content-html-encoded="true" data-for-element="#lftSearchButton" data-position="bottom" style="display: none;"><div class="zpl_search zpl_srchsml" style="width: 220px"><input id="choosekraSearch" onkeyup="PMSOperation.tagComponentSearch(this,\'chooseKra\',\'COMPETENCY\')" placeholder="'+ZPI18N.getString("zp.search")+'" type="text" class="ztextbox"><i class="PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i></div></div>',row+="</header>",row+='<ul id="csekralst"></ul></div>',row+="<div><header>",row+='<div class="zpl_twoclum" id="sltKra_wghthd"><div><b class="zpl_ellipsis" style="max-width: 300px;display: block;" title="'+PMSSetting.COMPETENCY_DISPLAY_NAME+'">'+PMSSetting.COMPETENCY_DISPLAY_NAME+'</b></div><div id="Competencyweightage"><b>'+ZPI18N.getString("zp.weightage")+"</b>",row+='<i class="PI_lens MLauto" id="rgtSearchButton" title="'+ZPI18N.getString("zp.search")+'"></i>',row+='<span class="red CP" style="display : none" id="rightclearsearch" onclick="PMSOperation.clearComponentSearch(\'selectedKra\',\'COMPETENCY\')">'+ZPI18N.getString("zp.clearsearch")+"</span>",row+="</div></div>",row+=' <div id="rgtSearchpopover" data-is-content-html-encoded="true" data-for-element="#rgtSearchButton" data-position="bottom" style="display: none;"><div class="zpl_search zpl_srchsml" style="width: 220px"><input id="chooseSelectedKra" onkeyup="PMSOperation.tagComponentSearch(this,\'selectedKra\',\'COMPETENCY\')" placeholder="'+ZPI18N.getString("zp.search")+'" type="text" class="ztextbox"><i class="PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i></div></div>',row+="</header>",row+='<ul id="sltkralst"> </ul></div>',row+="</div>"}else if("REVQES"==module){optType=ZPeopleComponents.select(pageId.find("#questiondesdepsel2")).getValue(),row='<div class="zpl_crd"> <div class="zpl_crdcnt zpl_crdinfo"> <div>';row+='<div class="zpl_secn"><div><label id="choosedesdep">'+ZPI18N.getString("zp.designation")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><textarea id="desDepRoleselect" style="display: none;"></textarea><span class="ztextbox--error__label" id="desErr" style="display: none;"></span></div></div>',row+='<div class="zpl_secn"><div><label id="chooseReviewtype">'+ZPI18N.getString("zp.reviewtype")+'</label><label class="zpl_mtry"></label></div><div style="width: 605px;"><textarea id="reviewTypeselect" style="display: none;"></textarea><span class="ztextbox--error__label" id="rtErr" style="display: none;"></span></div></div>',row+='</div> <div class="zpl_info DN"> <p id="weightagenote"></p><p class="DN" id="selectedCnt"></p><p class="DN" id="weightagetotal"></p> </div> </div> </div>',row+='<div class="zpl_pachokeylst"><div>',row+='<header><div><div class="zcheckbox" onchange="PMSOperation.chooseAllElementsinList(this,\'REVQES\')">',row+='<input id="cseKra_tpHd" type="checkbox" name="check" class="zcheckbox__helper ztextbox_opn">',row+='<label for="cseKra_tpHd" class="zcheckbox__label"><b class="zpl_ellipsis" style="max-width: 300px;display: block;" title="'+ZPI18N.getString("zp.choosePA",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME))+'">'+ZPI18N.getString("zp.choosePA",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME))+"</b></label></div>",row+='<div class="MLauto d-flexC flexclmcap">',row+='<span class="red CP" style="display : none" id="leftclearsearch" onclick="PMSOperation.clearComponentSearch(\'chooseKra\',\'REVQES\')">'+ZPI18N.getString("zp.clearsearch")+"</span>",row+='<i class="PI_lens" id="lftSearchButton" title="'+ZPI18N.getString("zp.search")+'"></i>',row+='<a data-popup-open="AddKeyAccountabilityform" class="zpl_ellipsis" style="max-width: 100px;" title="'+ZPI18N.getString("zp.addcomponents",[PMSSetting.QUS_ANS_DISPLAY_NAME])+'"><b onclick="PMSOperation.addKRAPopup(this,\'REVQES\')">'+ZPI18N.getString("zp.addcomponents",[PMSSetting.QUS_ANS_DISPLAY_NAME])+"</b></a>",row+="</div>",row+="</div>",row+=' <div id="lftSearchpopover" data-is-content-html-encoded="true" data-for-element="#lftSearchButton" data-position="bottom" style="display: none;"><div class="zpl_search zpl_srchsml" style="width: 220px"><input id="choosekraSearch" onkeyup="PMSOperation.tagComponentSearch(this,\'chooseKra\',\'REVQES\')" placeholder="'+ZPI18N.getString("zp.search")+'" type="text" class="ztextbox"><i class="PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i></div></div>',row+="</header>",row+='<ul id="csekralst"></ul></div>',row+="<div>",row+="<header>",row+='<div class="zpl_twoclum" id="sltKra_wghthd"><div><b class="zpl_ellipsis" style="max-width: 300px;display: block;" title="'+tabName+'">'+tabName+'</b></div><div id="reviewQuestionweightage"><b></b>',row+='<i class="PI_lens MLauto" id="rgtSearchButton" title="'+ZPI18N.getString("zp.search")+'"></i>',row+='<span class="red CP" style="display : none" id="rightclearsearch" onclick="PMSOperation.clearComponentSearch(\'selectedKra\',\'REVQES\')">'+ZPI18N.getString("zp.clearsearch")+"</span>",row+="</div></div>",row+=' <div id="rgtSearchpopover" data-is-content-html-encoded="true" data-for-element="#rgtSearchButton" data-position="bottom" style="display: none;"><div class="zpl_search zpl_srchsml" style="width: 220px"><input id="chooseSelectedKra" onkeyup="PMSOperation.tagComponentSearch(this,\'selectedKra\',\'REVQES\')" placeholder="'+ZPI18N.getString("zp.search")+'" type="text" class="ztextbox"><i class="PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i></div></div>',row+="</header>",row+='<ul id="sltkralst"> </ul></div>',row+="</di>"}$("#cardoprmoduletagslider").html(row),$(".zpl_pachokeylst").parent().parent().parent().addClass("zpl_pachokey"),ZPeopleComponents.popover("#lftSearchpopover",{open:function(event){setTimeout(()=>{$("#choosekraSearch").focus()},100)}}),$("#lftSearchButton").bind("click",function(){ZPeopleComponents.popover("#lftSearchpopover").open()}),ZPeopleComponents.popover("#rgtSearchpopover",{open:function(event){setTimeout(()=>{$("#chooseSelectedKra").focus()},100)}}),$("#rgtSearchButton").bind("click",function(){ZPeopleComponents.popover("#rgtSearchpopover").open()})},function(){"KRA"==module?PMSOperation.tagkranew(mode):"COMPETENCY"==module?PMSOperation.tagCompetency(mode):"SKILL"==module?PMSOperation.submitTags(mode):"REVQES"==module&&PMSOperation.tagReviewQuestion(mode)});PMSOperation.sliderObj=new sliderModal(ZPI18N.getString("zp.tag.module",new Array(tabName)),sliderTab),PMSOperation.sliderObj.largeSize=!0,PMSOperation.sliderObj._saveToggle=!1,PMSOperation.sliderObj.setCloseCallback(function(){var _sliderDiv=$(PMSOperation.sliderObj.sliderDiv);ZPeopleComponents.isComponent(_sliderDiv.find("#desDepRoleselect"))&&(ZPeopleComponents.select(_sliderDiv.find("#desDepRoleselect")).destroy(),ZPeopleComponents.tokenfield(_sliderDiv.find("#desDepRoleselect")).destroy()),ZPeopleComponents.isComponent(_sliderDiv.find("#dep_list_comp"))&&ZPeopleComponents.tokenfield(_sliderDiv.find("#dep_list_comp")).destroy(),ZPeopleComponents.isComponent(_sliderDiv.find("#ddl_list"))&&ZPeopleComponents.tokenfield(_sliderDiv.find("#ddl_list")).destroy(),ZPeopleComponents.isComponent(_sliderDiv.find("#des_list"))&&ZPeopleComponents.select(_sliderDiv.find("#des_list")).destroy(),ZPeopleComponents.isComponent(_sliderDiv.find("#lvl-list"))&&("SELECT"==_sliderDiv.find("#lvl-list").get(0).nodeName?ZPeopleComponents.select(_sliderDiv.find("#lvl-list")).destroy():ZPeopleComponents.tokenfield(_sliderDiv.find("#lvl-list")).destroy()),ZPeopleComponents.isComponent(_sliderDiv.find("#depselect"))&&(ZPeopleComponents.tokenfield(_sliderDiv.find("#depselect")).destroy(),ZPeopleComponents.select(_sliderDiv.find("#depselect")).destroy()),ZPeopleComponents.isComponent(_sliderDiv.find("#des_list"))&&ZPeopleComponents.select(_sliderDiv.find("#des_list")).destroy(),ZPeopleComponents.isComponent(_sliderDiv.find("#desDepselect"))&&(ZPeopleComponents.select(_sliderDiv.find("#desDepselect")).destroy(),ZPeopleComponents.tokenfield(_sliderDiv.find("#desDepselect")).destroy()),ZPeopleComponents.isComponent(_sliderDiv.find("#dep_list"))&&(ZPeopleComponents.select(_sliderDiv.find("#dep_list")).destroy(),ZPeopleComponents.tokenfield(_sliderDiv.find("#dep_list")).destroy()),ZPeopleComponents.isComponent(_sliderDiv.find("#reviewTypeselect"))&&ZPeopleComponents.tokenfield(_sliderDiv.find("#reviewTypeselect")).destroy(),ZPeopleComponents.isComponent(_sliderDiv.find("#lftSearchpopover"))&&ZPeopleComponents.popover(_sliderDiv.find("#lftSearchpopover")).destroy(),ZPeopleComponents.isComponent(_sliderDiv.find("#rgtSearchpopover"))&&ZPeopleComponents.popover(_sliderDiv.find("#rgtSearchpopover")).destroy(),PMSOperation.sliderObj.remove(),PMSOperation.sliderObj={},PMSOperation.chooseConponentList=[],PMSOperation.selectedConponentList=[],PMSOperation.searchTagChooseList=[],PMSOperation.searchTagSelectedList=[]}),PMSOperation.sliderObj.construct()},submitTags:function(mode){var pageId=settingsPage.container,_sliderDiv=$(PMSOperation.sliderObj.sliderDiv);_sliderDiv.find("#domainselect").parent().find(".ztextbox__error").each(function(){$(this).hasClass("ztokenfield")?(ZPeopleComponents.tokenfield($(this).prev()).setAttributes({className:""}),$(this).next().hide()):$(this).hasClass("zselectbox")?(ZPeopleComponents.select($(this).prev()).setAttributes({className:""}),$(this).next().hide()):$(this).hasClass("ztextbox")&&$(this).removeClass("ztextbox__error")});var params={mode:"addSkillTagsNew",userErecno:erecno,conreqcsr:csrfToken};PMSOperation.selectedConponentList.length!=_sliderDiv.find("#sltkralst li").length&&(PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.tagComponentSelectedlistConstruction(PMSOperation.selectedConponentList,"skillsName","skillsId","skillSetWeight","edit"));var type=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue(),domainName=_sliderDiv.find("#domainSearch").val().trim(),tagList=[],isdomainnamechanges=!1;if("domain"==type){if(null!=PMSOperation.DOMAINID||void 0!=PMSOperation.DOMAINID)params.domainId=PMSOperation.DOMAINID,index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.domain,"domainId",PMSOperation.DOMAINID),tagdata=PMSOperation.skillsetMappeddata.domain[index],domainName!=PMSOperation.skillsetMappeddata.domain[index].domainName&&(isdomainnamechanges=!0);else{if(_sliderDiv.find("#domainExists").is(":visible"))return void ZPeople.Message.warning(ZPI18N.getString("zp.tagminimumerror",new Array(PMSSetting.skilldispName)));if(""==domainName)return _sliderDiv.find("#domainEmpty").show(),void _sliderDiv.find("#domainSearch").addClass("ztextbox__error");_sliderDiv.find("#domainEmpty").hide()}params.domainName=domainName,params.type=0}if("designation"==type){if(_sliderDiv.find("#domainEmpty,#domainExists").hide(),void 0!=PMSOperation.DESIGNATIONID&&"-1"!=PMSOperation.DESIGNATIONID)for(var d=0;d<PMSOperation.designationArray.length;d++){(desigObj=PMSOperation.designationArray[d]).id==PMSOperation.DESIGNATIONID&&(desigName=desigObj.name)}else PMSOperation.DESIGNATIONID=ZPeopleComponents.select(_sliderDiv.find("#desDepRoleselect")).getValue();if("-1"==PMSOperation.DESIGNATIONID||""==PMSOperation.DESIGNATIONID||void 0==PMSOperation.DESIGNATIONID)return _sliderDiv.find("#deserr").show(),void ZPeopleComponents.select(_sliderDiv.find("#desDepRoleselect")).setAttributes({className:"ztextbox__error"});params.designationId=PMSOperation.DESIGNATIONID,params.type=1}if("department"==type){if(_sliderDiv.find("#domainEmpty,#domainExists").hide(),void 0!=PMSOperation.DEPARTMENTID&&"-1"!=PMSOperation.DEPARTMENTID)for(d=0;d<PMSOperation.departmentArray.length;d++){var desigObj;(desigObj=PMSOperation.departmentArray[d]).id==PMSOperation.DEPARTMENTID&&(desigName=desigObj.name)}else PMSOperation.DEPARTMENTID=ZPeopleComponents.select(_sliderDiv.find("#depselect")).getValue();if("-1"==PMSOperation.DEPARTMENTID||""==PMSOperation.DEPARTMENTID||void 0==PMSOperation.DEPARTMENTID)return _sliderDiv.find("#deperr").show(),void ZPeopleComponents.select(_sliderDiv.find("#depselect")).setAttributes({className:"ztextbox__error"});params.departmentId=PMSOperation.DEPARTMENTID,params.type=2}if("desDep"==type){if(_sliderDiv.find("#domainEmpty,#domainExists").hide(),_sliderDiv.find("#domainSearch").removeClass("ztextbox__error"),void 0!=PMSOperation.RULEID&&"-1"!=PMSOperation.RULEID&&""!=PMSOperation.RULEID)params.ruleId=PMSOperation.RULEID;else{var desIds=ZPeopleComponents.select(_sliderDiv.find("#des_list")).getValue();if(void 0==desIds||"-1"==desIds)return _sliderDiv.find("#designerr").show(),void ZPeopleComponents.select(_sliderDiv.find("#des_list")).setAttributes({className:"ztextbox__error"});_sliderDiv.find("#designerr").hide(),ZPeopleComponents.select(_sliderDiv.find("#des_list")).setAttributes({className:""}),params.designationId=desIds;var depIds=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(_sliderDiv.find("#desDepselect")).getAllValues());if(void 0==depIds||0==depIds.length)return _sliderDiv.find("#desdeperr").show(),void ZPeopleComponents.tokenfield(_sliderDiv.find("#desDepselect")).setAttributes({className:"ztextbox__error"});params.depIdList=JSON.stringify(depIds)}params.type=3}var errorFlag=!1,totalWeightage=0;_sliderDiv.find("#sltkralst li").each(function(){var kraId=$(this).attr("id"),weightage=$(this).find("input").val();if(weightage=PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE?"0":weightage.replace("%",""),totalWeightage+=parseFloat(weightage),("-1"==kraId||void 0==weightage||""==weightage||weightage>100||weightage<0)&&($(this).find("input").addClass("error-clr"),errorFlag=!0),-1==tagList.indexOf(kraId)){var temp={};temp.skillid=kraId,temp.weight=weightage,tagList.push(temp)}else errorFlag=!0}),totalWeightage=parseFloat(totalWeightage).toFixed(2);var varparams={mode:"getRestrictionWeightageValidation",conreqcsr:csrfToken,type:"skill"};if($.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:varparams,success:function(resultData){PMSOperation.RESTRICT_SKILLSET_WEIGHTAGE=void 0!=resultData.enabled&&resultData.enabled?"1":"0"}}),"0"==PMSOperation.RESTRICT_SKILLSET_WEIGHTAGE&&totalWeightage>100)ZPeople.Message.failure(ZPI18N.getString("zp.errortagcomponent",new Array(PMSSetting.skilldispName)));else if(errorFlag)ZPeople.Message.failure(ZPI18N.getString("zp.krainvalidweightage"));else{if(0==PMSOperation.selectedConponentList.length)return ZPeople.Message.failure(ZPI18N.getString("zp.tagminimumerror",new Array(PMSSetting.skilldispName))),!1;PMSOperation.Skillsetlimit=0;var tempArr=Object.assign({},PMSOperation.kramapold);if(void 0!=mode&&"edit"==mode){successmsg=ZPI18N.getString("zp.editedsuccess");var editobj=[],addobj=[],delobj=[];_sliderDiv.find("#sltkralst li").each(function(){var kraId=$(this).attr("id"),weightage=$(this).find("input").val();if(weightage=PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE?"0":weightage.replace("%",""),void 0!=PMSOperation.kramapold[kraId]&&PMSOperation.kramapold[kraId].skillSetWeight!=weightage)(temp={}).skillid=kraId,temp.weight=weightage,editobj.push(temp),delete PMSOperation.kramapold[kraId];else if(void 0==PMSOperation.kramapold[kraId]){var temp;(temp={}).skillid=kraId,temp.weight=weightage,addobj.push(temp)}else void 0!=PMSOperation.kramapold[kraId]&&PMSOperation.kramapold[kraId].skillSetWeight==weightage&&delete PMSOperation.kramapold[kraId]}),$.each(PMSOperation.kramapold,function(index,data){delobj.push(index)});var paramObj=void 0;if("desDep"==type&&void 0!=(paramObj=PMSOperation.editSkilldesignationRule(PMSOperation.editSkillRuleId))&&(params.ruleObj=JSON.stringify(paramObj)),0==editobj.length&&0==addobj.length&&0==delobj.length&&!isdomainnamechanges&&void 0==paramObj)return PMSOperation.kramapold=Object.assign({},tempArr),PMSOperation.sliderObj.close(),!1;if((editobj.length>100||addobj.length>100||delobj.length>100)&&void 0==paramObj)return ZPeople.Message.failure(ZPI18N.getString("zp.kralength",new Array(PMSSetting.skilldispName))),PMSOperation.kramapold=Object.assign({},tempArr),!1;addobj.length>0&&(params.tagskillIds=JSON.stringify(addobj)),editobj.length>0&&(params.editskillIds=JSON.stringify(editobj)),delobj.length>0&&(params.untagskillIds=JSON.stringify(delobj))}else{if(tagList.length>100)return ZPeople.Message.failure(ZPI18N.getString("zp.kralength",new Array(PMSSetting.skilldispName))),!1;tagList.length>0&&(params.tagskillIds=JSON.stringify(tagList))}_sliderDiv.find("#sliderSbt").addClass("disabled"),$.post("/performanceConfig.zp",params,function(data){if(_sliderDiv.find("#sliderSbt").removeClass("disabled"),"failure"==data.msg)ZPeople.Message.failure(data.msg);else if("PERMISSION_DENIED"==data.msg)ZPeople.Message.failure(ZPI18N.getString("zp.nopermission"));else{if(data.error)return void("weightageError"==data.error?ZPeople.Message.failure(ZPI18N.getString("zp.errortagcomponent",new Array(PMSSetting.skilldispName))):ZPeople.Message.failure(data.error));ZPeople.Message.success(data.msg),ZPeopleComponents.isComponent("#skillmenuiconimpexpmapping")&&ZPeopleComponents.menu("#skillmenuiconimpexpmapping").showMenuItems(["#"+ZPeopleComponents.menu("#skillmenuiconimpexpmapping").getMenuItemAt("1").attr("id")]);var tagdata=data.mappedskills[0];if("domain"==type){isExist=pageId.find("#skilldomain_"+data.mainId),row='<div class="zpl_crd"  id="skilldomain_'+data.mainId+'"> <div class="zpl_crdcnt"> <div class="zpl_secn"> <div> <ul class="zpl_paperent">',row+="<li><div><h5>"+data.domainName+"</h5>",row+='</div><div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+"\" onclick=\"PMSOperation.editskillSetMapping('edit', '"+data.mainId+'\');" ></i> <i data-popup-open="" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.deleteskillsetDomain(\''+data.mainId+"');\"></i> </div>",row+="</li>",void 0!=(index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.domain,"domainId",data.mainId))&&(PMSOperation.skillsetMappeddata.domain[index]=data.mappedskills[0])}else{if("designation"==type?isExist=pageId.find("#skilldesignation_"+data.mainId):"department"==type?isExist=pageId.find("#skilldepartment_"+data.mainId):"desDep"==type&&(isExist=pageId.find("#skilldesDep_"+data.mainId)),"designation"==type)row='<div class="zpl_crd" id="skilldesignation_'+data.mainId+'"> <div class="zpl_crdcnt"> <div class="zpl_secn"> <div> <ul class="zpl_paperent">',row+="<li><div><h5>"+tagdata.designationName+"</h5>";else if("department"==type)row='<div class="zpl_crd"  id="skilldepartment_'+data.mainId+'"> <div class="zpl_crdcnt"> <div class="zpl_secn"> <div> <ul class="zpl_paperent">',row+="<li> <div><h5>"+tagdata.depName+"</h5>";else if("desDep"==type&&(row='<div class="zpl_crd"  id="skilldesDep_'+tagdata.ruleId+'" > <div class="zpl_crdcnt"> <div class="zpl_secn"> <div> <ul class="zpl_paperent">',row+='<li ruleid="'+tagdata.ruleId+'"> <div><h5>'+tagdata.designationName+"</h5>",void 0!=tagdata.depList)){row+='<span class="zpl_dots"></span>';var desrule="",i=0;if($.each(tagdata.depList,function(index1,data1){i<3&&(desrule+=0==i?data1.depName:","+data1.depName),i++}),row+="<em>"+desrule+"</em>",tagdata.depList.length>2){var blncCnt=tagdata.depList.length-3;row+='<div class="zpl_tg"><span>+'+blncCnt+"</span></div>"}}if(row+='</div><div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+"\" onclick=\"PMSOperation.editskillSetMapping('edit', '"+data.mainId+'\');" ></i> <i data-popup-open="" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.deleteDesignationTags(\''+data.mainId+"');\"></i> </div>",row+="</li>","designation"==type)void 0!=(index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.designation,"designationId",data.mainId))?PMSOperation.skillsetMappeddata.designation[index]=data.mappedskills[0]:-1==PMSOperation.mappeddesignationArray.indexOf(data.mainId)&&PMSOperation.mappeddesignationArray.push(data.mainId);else if("department"==type){void 0!=(index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.department,"depId",data.mainId))?PMSOperation.skillsetMappeddata.department[index]=data.mappedskills[0]:-1==PMSOperation.mappeddepartmentArray.indexOf(data.mainId)&&PMSOperation.mappeddepartmentArray.push(data.mainId)}else if("desDep"==type){var index;void 0!=(index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.desDep,"ruleId",data.mainId))?PMSOperation.skillsetMappeddata.desDep[index]=data.mappedskills[0]:-1==PMSOperation.mappeddesDeptArray.indexOf(data.mainId)&&PMSOperation.mappeddesDeptArray.push(data.mainId)}}for(i=0;i<tagdata.skillset.length;i++){var skillobj;skillobj=tagdata.skillset[i],row+='<li class="zpl_pavlu"  skillids='+skillobj.skillsId+">",row+="<b>"+skillobj.skillSetWeight+"%</b>",row+="<span>"+ZPeople.escapeHtml(ZPeople.decodeTxt(skillobj.skillsName))+"</span> </li>"}row+="</ul></div></div></div></div>",isExist.length>0?(pageId.find("#notagdata").hide(),pageId.find("#kramappingbtn").show(),row=$(row),row.data("ldata",tagdata),isExist.replaceWith($(row))):(pageId.find("#notagdata").hide(),pageId.find("#kramappingbtn").show(),"domain"==type?(PMSOperation.skillsetMappeddata.domain.unshift(tagdata),pageId.find("#domainMapping").prepend($(row))):"designation"==type?(PMSOperation.skillsetMappeddata.designation.unshift(tagdata),pageId.find("#designationMapping").prepend($(row))):"department"==type?(PMSOperation.skillsetMappeddata.department.unshift(tagdata),pageId.find("#departmentMapping").prepend($(row))):"desDep"==type&&(PMSOperation.skillsetMappeddata.desDep.unshift(tagdata),row=$(row),row.data("ldata",tagdata),pageId.find("#desDepMapping").prepend(row)));var label="";"domain"==type?(pageId.find("#domainMapping").show(),pageId.find("#designationMapping").hide(),pageId.find("#departmentMapping").hide(),pageId.find("#desDepMapping").hide(),label=ZPI18N.getString("zp.domain")):"designation"==type?(pageId.find("#domainMapping").hide(),pageId.find("#departmentMapping").hide(),pageId.find("#designationMapping").show(),pageId.find("#desDepMapping").hide(),label=ZPI18N.getString("zp.designation")):"department"==type?(pageId.find("#domainMapping").hide(),pageId.find("#designationMapping").hide(),pageId.find("#departmentMapping").show(),pageId.find("#desDepMapping").hide(),label=ZPI18N.getString("zp.department")):"desDep"==type&&(pageId.find("#domainMapping").hide(),pageId.find("#designationMapping").hide(),pageId.find("#departmentMapping").hide(),pageId.find("#desDepMapping").show(),label=ZPI18N.getString("zp.designation")+" & "+ZPI18N.getString("zp.department")),pageId.find("#zp_page_loading").remove(),ZPeople.Message.success(PMSSetting.skilldispName+" tagged to "+label),$("#des_list").length>0&&ZPeopleComponents.select($("#des_list")).destroy(),$("#depselect").length>0&&ZPeopleComponents.select($("#depselect")).destroy(),$("#des_list").length>0&&ZPeopleComponents.select($("#depselect")).destroy(),$("#desDepRoleselect").length>0&&ZPeopleComponents.select($("#desDepRoleselect")).destroy(),$("#desDepselect").length>0&&ZPeopleComponents.tokenfield($("#desDepselect")).destroy(),PMSOperation.sliderObj.close()}})}},editSkilldesignationRule:function(ruleId){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),params={};if(void 0!=ruleId){var depIds,depIdlists=ZPeopleComponents.isComponent(sliderEle.find("#desDepselect"))?PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#desDepselect")).getAllValues()):[],desId=ZPeopleComponents.select(sliderEle.find("#des_list")).getValue();if(void 0==depIdlists||null==depIdlists||0==depIdlists.length)return;depIds=null==depIdlists?[]:JSON.stringify(depIdlists),params.desId=desId,params.depIds=depIds,params.ruleId=ruleId}return params},destoryComponentObj:function(){ZPeopleComponents.isComponent($("#ddl_list"))&&ZPeopleComponents.tokenfield($("#ddl_list")).destroy(),ZPeopleComponents.isComponent($("#des_list"))&&ZPeopleComponents.tokenfield($("#des_list")).destroy(),ZPeopleComponents.isComponent($("#lvl-list"))&&ZPeopleComponents.tokenfield($("#lvl-list")).destroy(),ZPeopleComponents.isComponent($("#dep_list"))&&ZPeopleComponents.tokenfield($("#dep_list")).destroy(),ZPeopleComponents.isComponent($("#desDepRoleselect"))&&ZPeopleComponents.select($("#desDepRoleselect")).destroy(),ZPeopleComponents.isComponent($("#desDepRoleselect"))&&ZPeopleComponents.select($("#desDepRoleselect")).destroy(),ZPeopleComponents.isComponent($("#dep_list_comp"))&&ZPeopleComponents.tokenfield($("#dep_list_comp")).destroy(),ZPeopleComponents.isComponent($("#desDepRoleselect"))&&ZPeopleComponents.select($("#desDepRoleselect")).destroy(),ZPeopleComponents.isComponent($("#depselect"))&&ZPeopleComponents.select($("#depselect")).destroy(),ZPeopleComponents.isComponent($("#des_list"))&&ZPeopleComponents.select($("#des_list")).destroy(),ZPeopleComponents.isComponent($("#desdepselect"))&&ZPeopleComponents.select($("#desdepselect")).destroy(),ZPeopleComponents.isComponent($("#desDepselect"))&&ZPeopleComponents.select($("#desDepselect")).destroy(),ZPeopleComponents.isComponent($("#dep_list_comp"))&&ZPeopleComponents.tokenfield($("#dep_list_comp")).destroy(),ZPeopleComponents.isComponent($("#desigdomainsel"))&&ZPeopleComponents.select($("#desigdomainsel")).destroy(),ZPeopleComponents.isComponent($("#compdesdepsel2"))&&ZPeopleComponents.select($("#compdesdepsel2")).destroy(),ZPeopleComponents.isComponent($("#questiondesdepsel2"))&&ZPeopleComponents.select($("#questiondesdepsel2")).destroy()},showSearchInput:function(obj,mode){if("selectedkradiv"==mode){var tagslideEle=$(PMSOperation.sliderObj.sliderDiv);tagslideEle.find("#selectedkraSearch").val(" "),tagslideEle.find("#selectedkradiv").is(":visible")?(tagslideEle.find("#selectedkradiv").hide(),tagslideEle.find("#sltKra_wghthd").show(),PMSOperation.tagComponentSearch(tagslideEle.find("#selectedkraSearch"),"selectedKra")):(tagslideEle.find("#selectedkradiv").show(),tagslideEle.find("#sltKra_wghthd").hide())}else $(obj).prev().hasClass("ztextbox_opn")?$(obj).prev().removeClass("ztextbox_opn"):($(obj).prev().addClass("ztextbox_opn"),$(obj).prev().focus())},tagKra:function(){var pageId=settingsPage.container;PMSOperation.loadMappingHtml("add","KRA"),PMSOperation.setWeightageValidationKey("kra");var optiontype=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue()),tagslideEle=$(PMSOperation.sliderObj.sliderDiv),labl="";0==optiontype?labl=ZPI18N.getString("zp.designation"):1==optiontype?labl=ZPI18N.getString("zp.department"):2==optiontype?labl=ZPI18N.getString("zp.location"):6==optiontype&&(labl=PMSOperation.formfieldName),$(tagslideEle.find("#ddlselect").find("label")[0]).html(labl);PMSOperation.getTokenDataSource(optiontype,!1,"ADD");if(PMSOperationCommon.clearNoData($(PMSOperation.sliderObj.sliderDiv).find("#csekralst")),void 0!=PMSOperation.ALL_KRA&&PMSOperation.ALL_KRA.length>0){PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.removeAllElementInTagComponent("csekralst"),PMSOperation.kraUsrformDtl.WEIGHTAGE&&tagslideEle.find("#sltKra_wghthd").find("#kraweightage b").text("");var csekralst="";$.each(PMSOperation.ALL_KRA,function(index,data){if(""!=data&&data.isactive&&"-1"!=data.approvalStatus){csekralst+=PMSOperation.tagComponentChooseListElementConstruction(data.kraId,data.kraName);var temp={};temp.kraId=data.kraId,temp.kraName=data.kraName,void 0==PMSOperation.chooseConponentList&&(PMSOperation.chooseConponentList=[]),PMSOperation.chooseConponentList.push(temp)}}),$(PMSOperation.sliderObj.sliderDiv).find("#csekralst").append(csekralst),PMSOperation.setActionlistenerForTagComponents("choose")}else PMSOperationCommon.setNoData($(PMSOperation.sliderObj.sliderDiv).find("#csekralst"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null);PMSOperationCommon.setNoData($(PMSOperation.sliderObj.sliderDiv).find("#sltkralst"),ZPI18N.getString("zp.nokramapped",new Array(PMSSetting.KRA_DISPLAY_NAME)),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null)},getTokenDataSource:function(optiontype,isAllDisable,mode){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),ddlId_ele=sliderEle.find("#ddl_list"),lvl_ele=sliderEle.find("#lvl-list");sliderEle.find("#dep_list");sliderEle.find("#ddlselect").removeClass("DN"),sliderEle.find("#levelselect").addClass("DN"),sliderEle.find("#depselect").addClass("DN"),sliderEle.find("#desselect").addClass("DN");var dataSource=[],allMapped=[];if($.each(PMSOperation.KraMapDetails,function(index1,data){$.each(data.mapingDetails,function(index,data1){allMapped.push(data1.mapId)})}),-1==allMapped.indexOf("1")&&"ADD"==mode){let name=ZPI18N.getString("zp.all");0==optiontype?name=ZPI18N.getString("zp.alldesignation"):1==optiontype?name=ZPI18N.getString("zp.alldepartment"):2==optiontype?name=ZPI18N.getString("zp.alllocaction"):6==optiontype&&(name=ZPI18N.getString("zp.alllevel")),dataSource.push({id:"1",name:name})}var istokenfield=!1;if(0==optiontype)$.each(PMSOperation.ALL_DESIGNATION,function(index,data){"1"!=data&&dataSource.push({id:data.desId,name:ZPeople.decodeTxt(data.desName)})}),istokenfield=!0;else if(1==optiontype)$.each(PMSOperation.ALL_DEPARTMENTS,function(index,data){"1"!=data&&dataSource.push({id:data.departmentId,name:ZPeople.decodeTxt(data.departmentName)})}),istokenfield=!0;else if(2==optiontype)$.each(PMSOperation.ALL_LOCATIONS,function(index,data){"1"!=data&&dataSource.push({id:data.locationId,name:ZPeople.decodeTxt(data.locationName)})}),istokenfield=!0;else if(6==optiontype)$.each(PMSOperation.ALL_LEVELS,function(index,data){"1"!=data&&dataSource.push({id:data.levelId,name:ZPeople.decodeTxt(data.levelName)})}),istokenfield=!0;else if(5==optiontype||4==optiontype||3==optiontype){if(5==optiontype||4==optiontype){$(PMSOperation.sliderObj.sliderDiv).find("#levelselect").removeClass("DN"),(dataSource=[]).push({id:"-1",name:ZPI18N.getString("zp.select")}),$.each(PMSOperation.ALL_LEVELS,function(index,data){"1"!=data&&dataSource.push({id:data.levelId,name:ZPeople.decodeTxt(data.levelName)})});var _lvlselectObj={};_lvlselectObj.options=dataSource,_lvlselectObj.contentType="text",_lvlselectObj.dataMapping={label:"name",value:"id",informativeText:"name"},_lvlselectObj.removeExistingDropdown=!0,_lvlselectObj.search={by:["name"],highlightKeyword:!0},_lvlselectObj.dropdownList={height:"300px"},ZPeopleComponents.select($(lvl_ele),_lvlselectObj)}if(5==optiontype||3==optiontype){dataSource=[],$("#depselect").removeClass("DN"),$(PMSOperation.sliderObj.sliderDiv).find("#depselect").removeClass("DN"),$.each(PMSOperation.ALL_DEPARTMENTS,function(index,data){"1"!=data&&dataSource.push({id:data.departmentId,name:ZPeople.decodeTxt(data.departmentName)})});var _deptokenObj={};_deptokenObj.data=dataSource,_deptokenObj.contentType="text",_deptokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_deptokenObj.search={by:"name"},_deptokenObj.allowDuplicateValues=!1,_deptokenObj.removeExistingDropdown=!0,_deptokenObj.tokens={showRemoveButtonOnHover:!0},_deptokenObj.sort=!1,_deptokenObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield($(PMSOperation.sliderObj.sliderDiv).find("#dep_list"),_deptokenObj)}ddlId_ele=sliderEle.find("#des_list"),$(PMSOperation.sliderObj.sliderDiv).find("#desselect").removeClass("DN"),$(PMSOperation.sliderObj.sliderDiv).find("#ddlselect").addClass("DN"),(dataSource=[]).push({id:"-1",name:ZPI18N.getString("zp.select")}),$.each(PMSOperation.ALL_DESIGNATION,function(index,data){"1"!=data&&dataSource.push({id:data.desId,name:ZPeople.decodeTxt(data.desName)})});var desgTokenObj={};desgTokenObj.options=dataSource,desgTokenObj.contentType="text",desgTokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},desgTokenObj.removeExistingDropdown=!0,desgTokenObj.search={by:["name"],highlightKeyword:!0},desgTokenObj.dropdownList={height:"300px"},ZPeopleComponents.select(sliderEle.find("#des_list"),desgTokenObj)}if(istokenfield){sliderEle.find("#ddlselect").removeClass("DN");var _destokenObj={};_destokenObj.data=dataSource,_destokenObj.contentType="text",_destokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_destokenObj.search={by:"name"},_destokenObj.allowDuplicateValues=!1,_destokenObj.removeExistingDropdown=!0,_destokenObj.sort=!1,"true"==isAllDisable&&(_destokenObj.disabled=!0),_destokenObj.tokens={showRemoveButtonOnHover:!0},_destokenObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield($(ddlId_ele),_destokenObj),0!=optiontype&&1!=optiontype&&2!=optiontype&&6!=optiontype||$(ddlId_ele).on("ztokenfieldtokenadd",PMSOperation.checkProperData)}},checkProperData:function(event){if(!event.detail.isTrusted)return;const sliderEle=$(PMSOperation.sliderObj.sliderDiv),ddlId_ele=sliderEle.find("#ddl_list"),curSelVal=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#ddl_list")).getAllValues());if(Array.isArray(curSelVal)&&curSelVal.includes("1")){ZPeopleComponents.tokenfield(ddlId_ele).removeAllTokens(),ZPeopleComponents.tokenfield(ddlId_ele).clearCache(),ZPeopleComponents.tokenfield(ddlId_ele).closeDropdownList();const pageId=settingsPage.container,optiontype=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue()),dataSource=[{id:"1",name:ZPI18N.getString("zp.all")}];switch(optiontype){case 0:dataSource[0].name=ZPI18N.getString("zp.alldesignation");break;case 1:dataSource[0].name=ZPI18N.getString("zp.alldepartment");break;case 2:dataSource[0].name=ZPI18N.getString("zp.alllocation");break;case 6:dataSource[0].name=ZPI18N.getString("zp.alllevel")}ZPeopleComponents.tokenfield(ddlId_ele).addTokens(dataSource)}},mergeTwoArrays:function(arr1,arr2,id,selected){var weightage="weightage";"skillsId"==id&&(weightage="skillSetWeight");for(var result_array=[],arr=new Array,len=(arr="questionId"==id?arr2.concat(arr1):arr1.concat(arr2)).length,result={};len--;){var item=arr[len][id];result[item]||(!arr[len][weightage]&&selected?arr[len][weightage]=0:void 0==arr[len][weightage]||selected||delete arr[len][weightage],result_array.unshift(arr[len]),result[item]=!0)}return result_array},findCommonElements:function(arr1,arr2,value,id){var weightage="weightage";"skillsId"==value&&(weightage="skillSetWeight");for(var res=[],common=[],notCommon=[],i=0;i<arr1.length;i++)res[arr1[i][value]]=!0;for(i=0;i<arr2.length;i++)res[arr2[i][value]]?res[arr2[i][value]]&&(res[arr2[i][value]]=!1):(res[arr2[i][value]]=!0,common.push(arr2[i]));if(void 0!=id){arr=[].concat("selected"==id?PMSOperation.selectedConponentList:PMSOperation.chooseConponentList);for(i=0;i<arr.length;i++)res[arr[i][value]]||("selected"!=id&&void 0==arr[i][weightage]&&(arr[i][weightage]=0),notCommon[arr[i][value]]=!0);if("selected"==id)for(i=0;i<PMSOperation.chooseConponentList.length;i++)notCommon[PMSOperation.chooseConponentList[i][value]]&&(PMSOperation.chooseConponentList.splice(i,1),--i);else for(i=0;i<PMSOperation.selectedConponentList.length;i++)notCommon[PMSOperation.selectedConponentList[i][value]]&&(PMSOperation.selectedConponentList.splice(i,1),--i)}return common},chooseAllElementsinList:function(obj,component){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),searchVal=sliderEle.find("#lftSearchpopover").find("#choosekraSearch").val().trim(),IdKey=PMSOperation.tagComponentKeyNames.IdKey,NameKey=PMSOperation.tagComponentKeyNames.NameKey,weightageKey=PMSOperation.tagComponentKeyNames.weightageKey,comName=PMSOperation.tagComponentKeyNames.comName,value="skillsId",dispName=PMSSetting.skilldispName;if("competency"==comName?(value="compId",dispName=PMSSetting.COMPETENCY_DISPLAY_NAME):"kra"==comName?(value="kraId",dispName=PMSSetting.KRA_DISPLAY_NAME):"question"==comName&&(value="questionId",dispName=PMSSetting.QUS_ANS_DISPLAY_NAME),$(obj).parent().find("input").is(":checked")){var arr=new Array;arr=PMSOperation.setAllComponentList(),""!=searchVal?(arr=PMSOperation.SearchComponent(arr,searchVal,NameKey),PMSOperation.selectedConponentList=PMSOperation.mergeTwoArrays(arr,PMSOperation.selectedConponentList,value,!0),arr=PMSOperation.findCommonElements(PMSOperation.selectedConponentList,arr,value,"selected"),PMSOperation.searchTagChooseList=PMSOperation.SearchComponent(PMSOperation.chooseConponentList,searchVal,NameKey),PMSOperation.searchTagSelectedList=PMSOperation.SearchComponent(PMSOperation.selectedConponentList,searchVal,NameKey)):(PMSOperation.selectedConponentList=PMSOperation.mergeTwoArrays(PMSOperation.chooseConponentList,PMSOperation.selectedConponentList,value,!0),PMSOperation.chooseConponentList=[]),sliderEle.find("#sltkralst").empty(),PMSOperation.tagComponentSelectedlistConstruction(PMSOperation.selectedConponentList,NameKey,IdKey,weightageKey),sliderEle.find("#csekralst input").prop("checked",!0)}else arr=PMSOperation.setAllComponentList(),""!=searchVal?(arr=PMSOperation.SearchComponent(arr,searchVal,NameKey),PMSOperation.chooseConponentList=PMSOperation.mergeTwoArrays(arr,PMSOperation.chooseConponentList,value,!1),arr=PMSOperation.findCommonElements(PMSOperation.chooseConponentList,arr,value,"choose"),PMSOperation.searchTagChooseList=PMSOperation.SearchComponent(PMSOperation.chooseConponentList,searchVal,NameKey),PMSOperation.searchTagSelectedList=PMSOperation.SearchComponent(PMSOperation.selectedConponentList,searchVal,NameKey)):(PMSOperation.chooseConponentList=PMSOperation.mergeTwoArrays(PMSOperation.chooseConponentList,PMSOperation.selectedConponentList,value,!1),PMSOperation.selectedConponentList=[]),sliderEle.find("#sltkralst").empty(),PMSOperation.selectedConponentList.length>0?PMSOperation.tagComponentSelectedlistConstruction(PMSOperation.selectedConponentList,NameKey,IdKey,weightageKey):PMSOperationCommon.setNoData(sliderEle.find("#sltkralst"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null),sliderEle.find("#csekralst input").prop("checked",!1);if(PMSOperation.selectedConponentList.length>0){var txt=ZPI18N.getString("zp.numberof")+" "+dispName+" "+ZPI18N.getString("zp.cap.selected")+' : <em style="margin-left: 2px;">'+PMSOperation.selectedConponentList.length+"</em>";sliderEle.find("#selectedCnt").html(txt),sliderEle.find("#selectedCnt").removeClass("DN"),sliderEle.find("#selectedCnt").parent().removeClass("DN")}else sliderEle.find("#selectedCnt").html(""),sliderEle.find("#selectedCnt").addClass("DN"),sliderEle.find("#weightagenote").hasClass("DN")&&sliderEle.find("#selectedCnt").parent().addClass("DN")},tagComponentSelectedlistConstruction:function(arr,nameKey,id,weightagekey,mode,added){var sltkralst="",sliderEle=$(PMSOperation.sliderObj.sliderDiv);"search"!=mode&&sliderEle.find("#sltKra_wghthd").show();var weightDisabled=!1;"kraName"==nameKey?weightDisabled=PMSOperation.kraUsrformDtl.WEIGHTAGE:"name"==nameKey?weightDisabled=PMSOperation.competencyUsrformDtl.WEIGHTAGE:"question"==nameKey?weightDisabled=!0:"skillsName"==nameKey&&(weightDisabled=PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE),$.each(arr,function(i,val){sltkralst+=PMSOperation.tagComponentSelectedlistElementConstruction(val[id],val[nameKey],weightDisabled,val[weightagekey],nameKey)}),""!=sltkralst&&(sliderEle.find("#sltkralst #emptPage").remove(),"question"==nameKey||"kraName"==nameKey?sliderEle.find("#sltkralst").append(sltkralst):sliderEle.find("#sltkralst").prepend(sltkralst),PMSOperation.tagComponentSelectedlistAfterConstruction(arr,mode,id,added))},tagComponentSelectedlistAfterConstruction:function(arr,mode,id,added){Layout.Page.container;PMSOperation.tagComponentKeyNames.IdKey,PMSOperation.setActionlistenerForTagComponents("selected")},tagComponentChooselistConstruction:function(arr,mode,front){for(var csekralst="",sliderEle=$(PMSOperation.sliderObj.sliderDiv),IdKey=PMSOperation.tagComponentKeyNames.IdKey,NameKey=PMSOperation.tagComponentKeyNames.NameKey,comName=PMSOperation.tagComponentKeyNames.comName,i=0;i<arr.length;i++){var val=arr[i];csekralst+=PMSOperation.tagComponentChooseListElementConstruction(val[IdKey],val[NameKey])}sliderEle.find("#csekralst #emptPage").remove(),void 0!=front&&front?sliderEle.find("#csekralst").prepend(csekralst):sliderEle.find("#csekralst").append(csekralst),PMSOperation.tagComponentChooselistafterConstruction(arr,mode,comName)},tagComponentChooselistafterConstruction:function(arr,mode,comName){PMSOperation.setActionlistenerForTagComponents("choose")},setActionlistenerForTagComponents:function(type){var sliderEle=$(PMSOperation.sliderObj.sliderDiv);"choose"==type?(sliderEle.find("#csekralst").find("input").off("click"),sliderEle.find("#csekralst").find("input").on("click",function(){PMSOperation.addNewRowInSelected(this)})):(sliderEle.find("#sltkralst").find("I").off("click"),sliderEle.find("#sltkralst").find("input").off("focusin"),sliderEle.find("#sltkralst").find("input").off("focusout"),sliderEle.find("#sltkralst").find("I").on("click",function(){PMSOperation.hideRowInSelected(this)}),sliderEle.find("#sltkralst").find("input").on("focusin",function(){PMSOperation.taggedlistweightfocusin(this)}),sliderEle.find("#sltkralst").find(" input").on("focusout",function(){PMSOperation.taggedlistweightfocusout(this)}))},convertArrayToObject:function(array,key){var obj={};return $.each(array,function(i,val){obj[val[key]]=val}),obj},hideRowInSelected:function(obj){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),IdKey=PMSOperation.tagComponentKeyNames.IdKey,NameKey=PMSOperation.tagComponentKeyNames.NameKey,allCom=PMSOperation.setAllComponentList();obj=$(obj).parent().parent();var kraId=$(obj).attr("id"),Data=allCom[PMSOperation.findArrayindexBykeyValue(allCom,IdKey,kraId)],temp={};temp[NameKey]=Data[NameKey],temp[IdKey]=kraId,PMSOperation.chooseConponentList.splice(0,0,temp),(new Array).push(temp),sliderEle.find("#csekralst #emptPage").remove(),1==sliderEle.find("#sltkralst li").length&&(sliderEle.find(".sltKra_wghthd").hide(),PMSOperationCommon.setNoData(sliderEle.find("#sltkralst"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null)),PMSOperation.selectedConponentList.splice(PMSOperation.findArrayindexBykeyValue(PMSOperation.selectedConponentList,IdKey,kraId),1),$(obj).remove(),sliderEle.find("#csekralst").find("#"+kraId).find("input").prop("checked",!1),PMSOperation.changeSelectedCount(),PMSOperation.chooseSelectAllReset()},changeSelectedCount:function(){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),comName=PMSOperation.tagComponentKeyNames.comName;if(PMSOperation.selectedConponentList.length>0){var dispName=PMSSetting.skilldispName;"competency"==comName?dispName=PMSSetting.COMPETENCY_DISPLAY_NAME:"kra"==comName?dispName=PMSSetting.KRA_DISPLAY_NAME:"question"==comName&&(dispName=PMSSetting.QUS_ANS_DISPLAY_NAME);var txt=ZPI18N.getString("zp.numberof")+" "+dispName+" "+ZPI18N.getString("zp.cap.selected")+' : <em style="margin-left: 2px;">'+PMSOperation.selectedConponentList.length+"</em>";sliderEle.find("#selectedCnt").html(txt),sliderEle.find("#selectedCnt").removeClass("DN"),sliderEle.find("#selectedCnt").parent().removeClass("DN")}else sliderEle.find("#selectedCnt").html(""),sliderEle.find("#selectedCnt").addClass("DN"),sliderEle.find("#weightagenote").hasClass("DN")&&sliderEle.find("#selectedCnt").parent().addClass("DN");var isWeightage=!1;"competency"==comName?isWeightage=PMSOperation.competencyUsrformDtl.WEIGHTAGE:"kra"==comName?isWeightage=PMSOperation.kraUsrformDtl.WEIGHTAGE:"skill"==comName?isWeightage=PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE:"question"==comName&&(isWeightage=!0),isWeightage||PMSOperation.changeTotalWeightage()},chooseSelectAllReset:function(){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),selectedLength=sliderEle.find("#csekralst input[type=checkbox]:checked").length,len=sliderEle.find("#csekralst li").length;len==selectedLength&&len>0?sliderEle.find("#cseKra_tpHd").prop("checked",!0):sliderEle.find("#cseKra_tpHd").prop("checked",!1)},taggedlistweightfocusin:function(obj){var val=$(obj).val();val=val.replace("%",""),$(obj).val(val)},taggedlistweightfocusout:function(obj){var IdKey=PMSOperation.tagComponentKeyNames.IdKey,weightageKey=PMSOperation.tagComponentKeyNames.weightageKey,val=$(obj).val();if(""!=val){val=val.replace("%","");var weightage=val=parseFloat(val);val+="%",$(obj).val(val),obj=PMSOperation.kraWeightageRange?$(obj).parent().parent().parent():$(obj).parent().parent();var kraId=$(obj).attr("id"),index=PMSOperation.findArrayindexBykeyValue(PMSOperation.selectedConponentList,IdKey,kraId);PMSOperation.selectedConponentList[index][weightageKey]=weightage}},tagComponentSelectedlistElementConstruction:function(Id,Name,IsWeightDisabled,comweight,typeName){if("operations-performance-kra"==Layout.Page.pageId&&!IsWeightDisabled&&PMSOperation.kraWeightageRange){const kraobj=PMSOperation.ALL_KRA.find(kra=>kra.kraId===Id);var html='<li class="zpl_twoclum"  id="'+Id+'"><div>'+Name+"</div><div>";html+='<span class="zpl_w120"><input type="text" class="ztextbox w60 ztextbox_opn" onkeyup=PMSOperation.tagComponentWeightOnchange(this,\''+typeName+"'); onkeydown=\"return paCommonUtil.onNRKeyDown(this,event,'moduleWeightage','"+typeName+'\');" value="'+comweight+'%"></span>',"null"==kraobj.minRange&&"null"==kraobj.maxRange?html+='<span class="">-</span>':html+='<span class="">'+kraobj.minRange+" - "+kraobj.maxRange+"</span>",html+='<i class="PI_cls red" title="'+ZPI18N.getString("zp.remove")+'"></i></div></li>'}else{html='<li class="zpl_twoclum"  id="'+Id+'"><div>'+Name+"</div><div>";IsWeightDisabled||(html+='<input type="text" class="ztextbox w60 ztextbox_opn" onkeyup=PMSOperation.tagComponentWeightOnchange(this,\''+typeName+"'); onkeydown=\"return paCommonUtil.onNRKeyDown(this,event,'moduleWeightage','"+typeName+'\');" value="'+comweight+'%">'),html+='<i class="PI_cls red" title="'+ZPI18N.getString("zp.remove")+'"></i></div></li>'}return html},tagComponentChooseListElementConstruction:function(Id,Name,checked){var check="";return void 0!=checked&&(check="checked"),'<li  id="'+Id+'"> <div class="zcheckbox"> <input type="checkbox"  id="'+Name+'" name="check" '+check+' class="zcheckbox__helper ztextbox_opn"> <label for="'+Name+'" class="zcheckbox__label">'+Name+"</label> </div> </li>"},getformDetails:function(mode,formdetails,callback,callbackParams){var formName="";if("appraisal"===mode&&0==PMSOperation.performanceappFormDtl.length&&(formName="performanceapp_form"),"kraUserform"==mode&&0==PMSOperation.kraUsrformDtl.length?formName="krauser_form":"competencyUserform"==mode&&0==PMSOperation.competencyUsrformDtl.length?formName="competencyuser_form":"competency_form"==mode&&0==PMSOperation.competencyformDtl.length?formName="competency_form":"userSkillMap"==mode&&0==PMSOperation.userSkillMapformDtl.length?formName="userSkillMap_form":"skillform"==mode&&0==PMSOperation.skillsformDtl.length?formName="skillsform":"kraForm"==mode&&0==PMSOperation.kraformDtl.length?formName="kra_form":"multirater"===mode&&0==PMSOperation.multiraterDtl.length?formName="multirater_form":"teambudgetform"==mode&&0==PMSOperation.teambudgetformDtl.length&&(formName="teambudget_form"),""!=formName){var params={mode:"getformdetails",formName:formName,conreqcsr:csrfToken};$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(resultData){void 0!=resultData&&("appraisal"===mode?PMSOperation.performanceappFormDtl=resultData:"kraUserform"==mode?(PMSOperation.kraUsrformDtl=resultData,null!=resultData.kradispName&&(PMSSetting.KRA_DISPLAY_NAME=resultData.kradispName),PMSSetting.KRA_DISPLAY_NAME=resultData.kradispName?resultData.kradispName:ZPI18N.getString("zp.kra")):"competencyUserform"==mode?(PMSOperation.competencyUsrformDtl=resultData,null!=resultData.competencydispName&&(PMSSetting.COMPETENCY_DISPLAY_NAME=resultData.competencydispName),PMSSetting.COMPETENCY_DISPLAY_NAME=resultData.competencydispName?resultData.competencydispName:ZPI18N.getString("zp.competency")):"competency_form"==mode?(PMSOperation.competencyformDtl=resultData,null!=resultData.formDispname&&(PMSSetting.competencyDisplayName=resultData.formDispname)):"skillform"==mode?PMSOperation.skillsformDtl=resultData:"kraForm"==mode?(PMSOperation.kraformDtl=resultData,null!=resultData.kradispName&&(PMSSetting.KRA_DISPLAY_NAME=resultData.kradispName)):"multirater"==mode?PMSOperation.multiraterDtl=resultData:"teambudgetform"==mode?PMSOperation.teambudgetformDtl=resultData:"userSkillMap"==mode&&(PMSOperation.userSkillMapformDtl=resultData),null!==callback&&void 0!==callback&&"function"==typeof callback&&callback(callbackParams))}})}},tagComponentWeightOnchange:function(obj,typeName){var weight=$(obj).val();if(weight=weight.replace("%",""),"operations-performance-kra"==Layout.Page.pageId&&PMSOperation.kraWeightageRange){let kraid=$(obj).parent().parent().parent().attr("id");const kraobj=PMSOperation.ALL_KRA.find(kra=>kra.kraId===kraid);let minRange=0,maxRange=100;"null"!=kraobj.minRange&&"null"!=kraobj.maxRange&&(minRange=parseInt(kraobj.minRange),maxRange=parseInt(kraobj.maxRange)),""==weight||Number(weight)>100||Number(weight)<0||isNaN(weight)||Number(weight)<minRange||Number(weight)>maxRange?(""==weight&&$(obj).val(""),$(obj).addClass("ztextbox__error")):paCommonUtil.checkKraWeightageMod(weight,AppraisalConfig.kraWeightageModValue.modVal)&&AppraisalConfig.isKRAWeightageRestirctionEnabled&&("KRA"==typeName||"kraName"==typeName)?($(obj).addClass("ztextbox__error"),ZPeople.Message.warning(ZPI18N.getString("zp.kraModValueErrMsg",new Array([AppraisalConfig.formUtil.kradispName],[AppraisalConfig.kraWeightageModValue.modVal])))):($(obj).removeClass("ztextbox__error"),PMSOperation.changeTotalWeightage())}else""==weight||Number(weight)>100||Number(weight)<0||isNaN(weight)?(""==weight&&$(obj).val(""),$(obj).addClass("ztextbox__error")):paCommonUtil.checkKraWeightageMod(weight,AppraisalConfig.kraWeightageModValue.modVal)&&AppraisalConfig.isKRAWeightageRestirctionEnabled&&("KRA"==typeName||"kraName"==typeName)?($(obj).addClass("ztextbox__error"),ZPeople.Message.warning(ZPI18N.getString("zp.kraModValueErrMsg",new Array([AppraisalConfig.formUtil.kradispName],[AppraisalConfig.kraWeightageModValue.modVal])))):($(obj).removeClass("ztextbox__error"),PMSOperation.changeTotalWeightage())},changeTotalWeightage:function(){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),_total=0;sliderEle.find("#sltkralst li").each(function(){var weightage=parseFloat($(this).find("input").val().replace("%",""));_total+=weightage});const myArray=(""+_total).split(".");void 0!=myArray[1]&&myArray[1].length>2&&(_total=_total.toFixed(2));var weigtageTotalTxt=ZPI18N.getString("zp.totalweightage")+': <em style="margin-left: 2px;">'+_total+"</em>";sliderEle.find("#weightagetotal").html(weigtageTotalTxt),_total>0?sliderEle.find("#weightagetotal").removeClass("DN"):sliderEle.find("#weightagetotal").addClass("DN")},clearComponentSearch:function(type,Component){const sliderEle=$(PMSOperation.sliderObj.sliderDiv);var searchObj;let id="";"chooseKra"==type?(searchObj=sliderEle.find("#lftSearchpopover"),id="choosekraSearch"):"selectedKra"==type&&(id="chooseSelectedKra",searchObj=sliderEle.find("#rgtSearchpopover")),searchObj.find("#"+id).val(""),PMSOperation.tagComponentSearch(searchObj.find("#"+id),type,Component)},tagComponentSearch:function(key,type,Component){var IdKey=PMSOperation.tagComponentKeyNames.IdKey,NameKey=PMSOperation.tagComponentKeyNames.NameKey,weightageKey=PMSOperation.tagComponentKeyNames.weightageKey,strval=$(key).val();strval=strval.trim();const sliderEle=$(PMSOperation.sliderObj.sliderDiv),isEmpty=""===strval;var allCompArr=PMSOperation.setAllComponentList();if("chooseKra"==type?(sliderEle.find("#leftclearsearch").toggle(!isEmpty),sliderEle.find("#lftSearchButton").toggle(isEmpty)):(sliderEle.find("#rightclearsearch").toggle(!isEmpty),sliderEle.find("#rgtSearchButton").toggle(isEmpty)),"chooseKra"==type?(PMSOperation.searchTagChooseList=PMSOperation.SearchComponent(allCompArr,strval,NameKey),PMSOperation.searchTagSelectedList=new Array):(type="selectedKra")&&(PMSOperation.searchTagSelectedList=PMSOperation.SearchComponent(PMSOperation.selectedConponentList,strval,NameKey)),"chooseKra"==type){if(0==PMSOperation.searchTagChooseList.length&&0==PMSOperation.searchTagSelectedList.length)return PMSOperation.removeAllElementInTagComponent("csekralst"),void PMSOperationCommon.setNoData($(PMSOperation.sliderObj.sliderDiv).find("#csekralst"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null)}else if("selectedKra"==type&&0==PMSOperation.searchTagSelectedList.length)return void PMSOperationCommon.setNoData($(PMSOperation.sliderObj.sliderDiv).find("#sltkralst"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null);"selectedKra"==type?(PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.tagComponentSelectedlistConstruction(PMSOperation.searchTagSelectedList,NameKey,IdKey,weightageKey,"search")):(PMSOperation.removeAllElementInTagComponent("csekralst"),PMSOperation.showTagScrollChooseList(Component),PMSOperation.chooseSelectAllReset())},showTagScrollChooseList:function(value){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),csekralst=(sliderEle.find("#csekralst li").length,sliderEle.find("#csekralst input:checked").length,""),searchVal=sliderEle.find("#choosekraSearch").val().trim(),chooseList=PMSOperation.chooseConponentList;""!=searchVal?chooseList=PMSOperation.searchTagChooseList:void 0!=value&&(chooseList=PMSOperation.setAllComponentList());var id="skillsId",name="skillsName";"KRA"==value?(id="kraId",name="kraName"):"COMPETENCY"==value?(id="compId",name="name"):"REVQES"==value&&(id="questionId",name="question");let selectedCompObj=PMSOperation.convertArrayToObject(PMSOperation.selectedConponentList,id);for(var i=0;i<chooseList.length;i++){var val=chooseList[i];void 0!=selectedCompObj[val[id]]?csekralst+=PMSOperation.tagComponentChooseListElementConstruction(val[id],val[name],!0):csekralst+=PMSOperation.tagComponentChooseListElementConstruction(val[id],val[name])}""!=csekralst&&(sliderEle.find("#csekralst").html(""),sliderEle.find("#csekralst").append(csekralst),PMSOperation.setActionlistenerForTagComponents("choose"))},removeAllElementInTagComponent:function(id){var sliderEle=$(PMSOperation.sliderObj.sliderDiv);if("sltkralst"==id)sliderEle.find("#sltkralst li").remove();else if("csekralst"==id){sliderEle.find("#csekralst li").remove();id="addkratag";"skillsId"==PMSOperation.tagComponentKeyNames.IdKey?(id="",name=ZPI18N.getString("zp.addskills",new Array(PMSSetting.skilldispName)),onclick='onclick="PMSOperation.addSkillDiv();"'):"compId"==PMSOperation.tagComponentKeyNames.IdKey?(id="addcompetency",name=ZPI18N.getString("zp.addcomponents",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME))):"questionId"==PMSOperation.tagComponentKeyNames.IdKey&&(id="",name=ZPI18N.getString("zp.addcomponents",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME)))}},openLibrarySlider:function(module){var sliderProps={};PMSOperation.moduleLibraryslider={},sliderProps.id="libraryslider",sliderProps.cardId="libraryslidercard";var headerCon,tab=new Tab("libraryslider",sliderProps),resultData="",dispName="";if("KRA"==module?(resultData=PMSOperation.ALL_KRA,dispName=ZPI18N.getString("zp.pms.library",new Array(PMSSetting.KRA_DISPLAY_NAME)),headerCon='<div><select id="kraView" data-width="300"></select></div><a id="sliderCls" class="_cls PI_cls"></a>'):"COMPETENCY"==module?(resultData=PMSOperation.allCompetencies,dispName=ZPI18N.getString("zp.pms.library",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME))):"SKILL"==module?(resultData=PMSOperation.ALL_SKILLS,dispName=ZPI18N.getString("zp.pms.library",new Array(PMSSetting.skilldispName))):"REVQES"==module&&(resultData=PMSOperation.allQuestion,dispName=ZPI18N.getString("zp.pms.library",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME))),PMSOperation.moduleLibraryslider=new sliderModal(dispName,tab),"KRA"==module?PMSOperation.moduleLibraryslider.fullPageSize=!0:PMSOperation.moduleLibraryslider.mediumSize=!0,PMSOperation.moduleLibraryslider.ftExtraCls="DN",PMSOperation.moduleLibraryslider.setCloseCallback(function(){"KRA"==module&&ZPeopleComponents.select($(PMSOperation.moduleLibraryslider.sliderDiv).find("#kraView")).destroy(),PMSOperation.moduleLibraryslider.remove(),PMSOperation.moduleLibraryslider={},PMSOperation.isLibraryModalOpen=!1}),PMSOperation.moduleLibraryslider.construct(headerCon),"KRA"==module&&PMSOperation.moduleLibraryslider.sliderDiv.find("#cardlibraryslider").addClass("zpl_flex-column").css("overflow-x","auto"),PMSOperation.isLibraryModalOpen=!0,"KRA"==module){var _kraViewSelObj={},_kraViewOptions=[];_kraViewOptions.push({name:ZPeople.decodeTxt(PMSSetting.KRA_DISPLAY_NAME),id:0}),_kraViewOptions.push({name:ZPI18N.getString("zp.userspecifickra",new Array(ZPeople.decodeTxt(PMSSetting.KRA_DISPLAY_NAME))),id:1}),_kraViewSelObj.options=_kraViewOptions,_kraViewSelObj.contentType="text",_kraViewSelObj.dataMapping={label:"name",value:"id",informativeText:"name"},_kraViewSelObj.removeExistingOption=!0,_kraViewSelObj.value=0,_kraViewSelObj.dropdownList={fitForElement:!0,titleText:"informativeText"},ZPeopleComponents.select($(PMSOperation.moduleLibraryslider.sliderDiv).find("#kraView"),_kraViewSelObj),$(PMSOperation.moduleLibraryslider.sliderDiv).find("#kraView").on("zselectchange",PMSOperation.changeKraViewTab)}PMSOperation.libraryConstruction(module,resultData)},libraryConstruction:function(mode,resultData,strval,isSearch){var srchCls="";void 0==strval&&void 0==isSearch||""==strval&&void 0==isSearch||void 0!=isSearch&&!isSearch?(strval="",srchCls="search-cmn"):($(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider").find("#librarylist").html(""),srchCls="search-cmn opn"),PMSOperation.LIBRARY_MODE=mode;var idString="",btnName=ZPI18N.getString("zp.add"),dispName="";let nodataMsg="";if("KRA"==mode?(idString="kra_",btnName+=" "+PMSSetting.KRA_DISPLAY_NAME,dispName=PMSSetting.KRA_DISPLAY_NAME,nodataMsg=ZPI18N.getString("zp.pa.addkramsg",new Array(dispName,dispName))):"USER_KRA"==mode?(idString="userkra_",dispName=ZPI18N.getString("zp.userspecifickra",new Array(PMSSetting.KRA_DISPLAY_NAME))):"COMPETENCY"==mode?(idString="competency_",btnName+=" "+PMSSetting.COMPETENCY_DISPLAY_NAME,dispName=PMSSetting.COMPETENCY_DISPLAY_NAME,nodataMsg=ZPI18N.getString("zp.pa.addcompetencymsg",new Array(dispName,dispName))):"SKILL"==mode?(idString="skill_",btnName+=" "+PMSSetting.skilldispName,dispName=PMSSetting.skilldispName,nodataMsg=ZPI18N.getString("zp.pa.addskillmsg",new Array(dispName,dispName))):"REVQES"==mode&&(idString="REVQES_",btnName+=" "+PMSSetting.QUS_ANS_DISPLAY_NAME,dispName=PMSSetting.QUS_ANS_DISPLAY_NAME,nodataMsg=ZPI18N.getString("zp.pa.tagreviewques",new Array(dispName))),void 0==isSearch||!isSearch){var listLen=resultData?resultData.length:0,_htm="";("USER_KRA"!=mode||listLen>0)&&(_htm+='<div class="zpl_btnmnu">',_htm+='<div class="'+srchCls+'"> <i class="PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i> <input type="text" class="ztextbox" id="skillsetsearch"  placeholder="'+ZPI18N.getString("zp.searchdata")+'"  onkeyup="PMSOperation.searchSkillSet(this,\''+mode+"','"+!0+'\')"> <i class="PI_cls" onclick="PMSOperation.clssearch(\''+mode+'\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div>',_htm+='<div class="actn_ovrly" id="multideletediv"> <div>',"USER_KRA"==mode&&(_htm+='<button class="zlabel zlabel--blue zlabel--outline zlabel--medium zpl_btnellips" id="bulkChangeCommonKraBtn" onclick="PMSOperation.showChangetoCommonKra()" title="'+ZPI18N.getString("zp.changetocommonkra",new Array(PMSSetting.KRA_DISPLAY_NAME))+'"><span class="zpl_ellipsis">'+ZPI18N.getString("zp.changetocommonkra",new Array(PMSSetting.KRA_DISPLAY_NAME))+"</span></button>"),_htm+='<button class="zlabel zlabel--red zlabel--medium" onclick="PMSOperation.libraryListMultiDelete(this,\''+mode+"')\">"+ZPI18N.getString("zp.delete")+'</button> </div> <i class="PI_cls" onclick="PMSOperation.removeAllMultiDeleteAction(\''+mode+"')\"></i> </div>",listLen>0&&"KRA"!=mode&&"USER_KRA"!=mode&&(_htm+='<div class="zpl_selchklstall">',_htm+='<div class="zcheckbox" onclick="PMSOperation.selectAllMultiDeleteAction(this)" ><input type="checkbox" name="check" id="allselchk" class="zcheckbox__helper ztextbox_opn"><label for="allselchk" class="zcheckbox__label">'+ZPI18N.getString("zp.selectall")+"</label> </div>",_htm+='<em>|</em><span class="d-flex">',_htm+='<label class="zpl_ellipsis" style="max-width: 200px;" title="'+ZPI18N.getString("zp.totalnodes",[dispName])+" "+ZPI18N.getString("zp.count")+'">'+ZPI18N.getString("zp.totalnodes",[dispName])+" "+ZPI18N.getString("zp.count")+":&nbsp;</label>",_htm+='<b id="modulelistcount">'+listLen+"</b></span></div>"),_htm+='<div class="zpl_rgt">',"USER_KRA"!=mode&&(_htm+='<button class="zlabel zlabel--blue zlabel--medium zpl_btnellips" onclick="PMSOperation.addKRAPopup(this,\''+mode+'\')" title="'+btnName+'"><span class="zpl_ellipsis">'+btnName+"</span></button>"),listLen>0&&(_htm+='<i class="zpl_ibg PI_lens" onclick="PMSOperation.opnsearch()" title="'+ZPI18N.getString("zp.search")+'"></i>'),"REVQES"!=mode&&(("USER_KRA"!=mode||listLen>0)&&(_htm+='<i class="zpl_ibg PI_more" title="'+ZPI18N.getString("zp.more")+'" data-menu-id="menuiconimpexp" id="importexpbtn"></i>'),_htm+='<div id="menuiconimpexp" class="zpl_drpdwn" data-type="list" data-content-type="icon-text">',_htm+="<ul>","USER_KRA"!=mode&&(_htm+='<li data-icon-class="PI_imprt">'+ZPI18N.getString("zp.import")+"</li>"),listLen>0&&(_htm+='<li data-icon-class="PI_exprt">'+ZPI18N.getString("zp.export")+"</li>"),_htm+="</ul>"),_htm+="</div>",_htm+="</div> </div>"),"KRA"==mode||"USER_KRA"==mode?(_htm+='<div class="zpl_crdcnt"><div class="zpl_tblres zpl_oxa"><table class="zpl_tbl wd100_per" id="userManagementDivTable"><thead><tr id="teamdata"><th width="40"><div class="zcheckbox" onclick="PMSOperation.selectAllMultiDeleteAction(this)"><input type="checkbox" name="check" value="" class="zcheckbox__helper" id="allselchk"><label class="zcheckbox__label" for="allselchk"></label></div></th><th>'+PMSSetting.KRA_DISPLAY_NAME+'<span style="margin-left: 5px;"  id="modulelistcount">('+listLen+")</span></th>",!PMSOperation.kraUsrformDtl.WEIGHTAGE&&PMSOperation.kraWeightageRange?(_htm+='<th width="500">'+ZPI18N.getString("zp.description")+"</th>",_htm+='<th width="150">'+ZPI18N.getString("zp.range")+"</th>"):_htm+='<th width="700">'+ZPI18N.getString("zp.description")+"</th>","USER_KRA"==mode?(_htm+='<th width="100">'+ZPI18N.getString("zp.employee")+"</th>",_htm+='<th width="70">'+ZPI18N.getString("zp.status")+"</th>",_htm+='<th width="150"></th>'):_htm+='<th width="150"></th>',_htm+='</tr></thead><tbody id="librarylist"></tbody></table></div></div>'):_htm+='<div class="zpl_rgtcnt zpl_crdwthful"><div class="zpl_crdlst" id="librarylist"></div></div>',$(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider").html(_htm),$(PMSOperation.moduleLibraryslider.sliderDiv).find("#skillsetsearch").text(strval)}if(void 0!=resultData&&resultData.length>0){"KRA"==mode||"USER_KRA"==mode?($(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider #emptPage").remove(),$(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider #userManagementDivTable").parent().show()):PMSOperationCommon.clearNoData($(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider").find("#librarylist"));var empDetails,kraUserIdDetails,count=0;if("USER_KRA"==mode?(empDetails=PMSOperation.USER_KRA_EMP_DETAILS,kraUserIdDetails=PMSOperation.USER_KRA_MAPID_DETAILS):"KRA"==mode&&(kraUserIdDetails=PMSOperation.ALL_KRA_USERMAPID_DETAILS),$.each(resultData,function(index,val){if(count>=100)return!1;var row="";row="KRA"==mode||"USER_KRA"==mode?PMSOperation.constructModuleLibraryWithRange(mode,val,idString,empDetails,kraUserIdDetails):PMSOperation.constructModuleLibraryRow(mode,val,idString,empDetails,kraUserIdDetails),count++,(row=$(row)).data("ldata",val),$(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider").find("#librarylist").append(row)}),"KRA"==mode||"USER_KRA"==mode)new FireScrollBack(PMSOperation.kraConstructionScroll,$(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider .zpl_crdcnt"),"librarylist");else new FireScrollBack(PMSOperation.kraConstructionScroll,$(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider"),"librarylist")}else"KRA"==mode||"USER_KRA"==mode?($(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider #emptPage").remove(),$(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider #userManagementDivTable").parent().hide(),PMSOperationCommon.setNoData($(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider .zpl_crdcnt"),ZPI18N.getString("zp.pa.nodataadded",new Array(dispName)),"no_data_found",null,nodataMsg,null,!1)):PMSOperationCommon.setNoData($(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider").find("#librarylist"),ZPI18N.getString("zp.pa.nodataadded",new Array(dispName)),"no_data_found",null,nodataMsg,null);if(void 0==isSearch||!isSearch){var _sliderDiv=$(PMSOperation.moduleLibraryslider.sliderDiv),mapMenu=ZPeopleComponents.menu(_sliderDiv.find("#menuiconimpexp"),{forElement:_sliderDiv.find("#importexpbtn"),className:"",itemclick:e=>{PMSOperation.libraryMenu(e)}});_sliderDiv.find("#importexpbtn").on("click",function(ev){mapMenu.show()}),$(PMSOperation.moduleLibraryslider.sliderDiv).find("#skillsetsearch").parent().hasClass("opn")&&$(PMSOperation.moduleLibraryslider.sliderDiv).find("#skillsetsearch").focus().val("").val(strval)}},kraConstructionScroll:function(){var sliderDiv=$(PMSOperation.moduleLibraryslider.sliderDiv),isSearch=!1;""!=sliderDiv.find("#skillsetsearch").val()&&(isSearch=!0);var idString="",arr="";"KRA"==PMSOperation.LIBRARY_MODE?(idString="kra_",arr=isSearch?PMSOperation.skillsetSearchResult:PMSOperation.ALL_KRA):"USER_KRA"==PMSOperation.LIBRARY_MODE?(idString="userkra_",arr=isSearch?PMSOperation.skillsetSearchResult:PMSOperation.ALL_USER_KRA):"COMPETENCY"==PMSOperation.LIBRARY_MODE?(idString="competency_",arr=isSearch?PMSOperation.skillsetSearchResult:PMSOperation.allCompetencies):"SKILL"==PMSOperation.LIBRARY_MODE?(idString="skill_",arr=isSearch?PMSOperation.skillsetSearchResult:PMSOperation.ALL_SKILLS):"REVQES"==PMSOperation.LIBRARY_MODE&&(idString="REVQES_",arr=isSearch?PMSOperation.skillsetSearchResult:PMSOperation.allQuestion);var listedcount="KRA"==PMSOperation.LIBRARY_MODE||"USER_KRA"==PMSOperation.LIBRARY_MODE?sliderDiv.find("#librarylist tr").length:sliderDiv.find("#librarylist .zpl_catlst").length;if(listedcount!==arr.length){var empDetails,kraUserIdDetails;"USER_KRA"==PMSOperation.LIBRARY_MODE?(empDetails=PMSOperation.USER_KRA_EMP_DETAILS,kraUserIdDetails=PMSOperation.USER_KRA_MAPID_DETAILS):"KRA"==PMSOperation.LIBRARY_MODE&&(kraUserIdDetails=PMSOperation.ALL_KRA_USERMAPID_DETAILS);for(var i=listedcount;i<arr.length&&i<listedcount+100;i++){var val=arr[i],row="";row="KRA"==PMSOperation.LIBRARY_MODE||"USER_KRA"==PMSOperation.LIBRARY_MODE?PMSOperation.constructModuleLibraryWithRange(PMSOperation.LIBRARY_MODE,val,idString,empDetails,kraUserIdDetails):PMSOperation.constructModuleLibraryRow(PMSOperation.LIBRARY_MODE,val,idString,empDetails,kraUserIdDetails),(row=$(row)).data("ldata",val),sliderDiv.find("#librarylist").append(row)}if("KRA"==PMSOperation.LIBRARY_MODE||"USER_KRA"==PMSOperation.LIBRARY_MODE)new FireScrollBack(PMSOperation.kraConstructionScroll,$(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider .zpl_crdcnt"),"librarylist");else new FireScrollBack(PMSOperation.kraConstructionScroll,$(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider"),"librarylist")}},constructModuleLibraryRow:function(mode,val,idString,empDetails,kraUserIdDetails){var id=val[PMSOperation.tagComponentKeyNames.IdKey],row='<div class="zpl_catlst" id="'+idString+id+'">';if(row+='<div class="chkdectxt'+("USER_KRA"==mode?" wd50_per":"KRA"==mode?" zpl_w-100":"")+'">',row+='<div class="zcheckbox" onclick="PMSOperation.multiDeleteAction(this)">',row+='<input type="checkbox" name="check" id="'+val[PMSOperation.tagComponentKeyNames.NameKey]+'" class="zcheckbox__helper ztextbox_opn">',row+='<label for="'+val[PMSOperation.tagComponentKeyNames.NameKey]+'" class="zcheckbox__label">'+val[PMSOperation.tagComponentKeyNames.NameKey]+"</label>",row+="</div>","REVQES"!=mode&&(row+='<span class="dectxt">'+val[PMSOperation.tagComponentKeyNames.descKey]+"</span>"),row+="</div>","USER_KRA"==mode){if(row+='<div class="mw300">',void 0!=empDetails&&void 0!=empDetails[val.owner]){var empData=empDetails[val.owner];row+='<div class="zpl_em"><div class="zpl_emdts"><div><em>'+empData.empid+" - </em><b>"+empData.name+"</b></div></div></div>"}row+="</div>"}if("KRA"==mode||"USER_KRA"==mode){if(row+="USER_KRA"==mode?'<div class="mw50">':'<div class="zpl_mmax160">',-1==val.approvalStatus){var kraUserId=kraUserIdDetails[id];row+='<span class="PI_Approval-pending"'+(void 0!=kraUserId?" onclick=\"PMSOperation.showUserKraForm('"+kraUserId+"');\"":"")+"></span>"}else 1==val.approvalStatus&&(row+='<span class="grn PI_like"></span>');row+="</div>"}return"KRA"==mode?row+='<div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+'" onclick="PMSOperation.showeditkra(\''+val[PMSOperation.tagComponentKeyNames.IdKey]+'\', this)"></i><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.kradelconfrim(\'confirm\', this)"></i> </div>':"USER_KRA"==mode?row+='<div class="zpl_hvr mw150"> '+(-1!=val.approvalStatus?'<i class="PI_sndfile" title="'+ZPI18N.getString("zp.changetocommonkra",new Array(PMSSetting.KRA_DISPLAY_NAME))+'" onclick="PMSOperation.showChangetoCommonKra(\''+val[PMSOperation.tagComponentKeyNames.IdKey]+"')\"></i>":"")+'<i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+'" onclick="PMSOperation.showedituserkra(\''+val[PMSOperation.tagComponentKeyNames.IdKey]+'\', this)"></i><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.kradelconfrim(\'confirm\', this)"></i> </div>':"COMPETENCY"==mode?row+='<div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+'" onclick="PMSOperation.showeditcompetency(\''+val[PMSOperation.tagComponentKeyNames.IdKey]+'\', this)"></i><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.compdel(\'deloption\', this)"></i> </div>':"SKILL"==mode?row+='<div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+'" onclick="PMSOperation.showeditskill(\''+val[PMSOperation.tagComponentKeyNames.IdKey]+'\', this)"></i><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.skilldel(\'deloption\', this)"></i> </div>':"REVQES"==mode&&(row+='<div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+'" onclick="PMSOperation.showeditReviewQuestion(\''+val[PMSOperation.tagComponentKeyNames.IdKey]+'\', this)"></i><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+"\" onclick=\"PMSOperation.ReviewQuestiondel('deloption','"+val[PMSOperation.tagComponentKeyNames.IdKey]+"', this)\"></i> </div>"),row+="</div>"},constructModuleLibraryWithRange:function(mode,val,idString,empDetails,kraUserIdDetails){var id=val[PMSOperation.tagComponentKeyNames.IdKey],row='<tr id="'+idString+id+'">';if(row+='<td><div class="zcheckbox" onclick="PMSOperation.multiDeleteAction(this)"><input id="'+val[PMSOperation.tagComponentKeyNames.NameKey]+'" type="checkbox" class="zcheckbox__helper"><label for="'+val[PMSOperation.tagComponentKeyNames.NameKey]+'" class="zcheckbox__label"></label></div></td>',row+="<td><span>"+val[PMSOperation.tagComponentKeyNames.NameKey]+"</span></td>","REVQES"!=mode){let comment=val[PMSOperation.tagComponentKeyNames.descKey];if(void 0!=comment&&comment.length>300){var cmt=comment.slice(0,250);row+='<td><div class="zpl_paglcmrtmx zpl_DNI" style="z-index: 11;"><div class="zpl_glrtmxbox"><p style="word-break: break-word;" class="blk">'+paCommonUtil.replaceURLWithTag(paCommonUtil.replaceLineBr(comment))+"</p></div></div><span>"+paCommonUtil.replaceURLWithTag(paCommonUtil.replaceLineBr(cmt))+'<a class="zpl_more-js" onclick="paCommonUtil.openComtDivinViewMode(this);"> '+ZPI18N.getString("zp.more")+"...</a></span></td>"}else row+="<td><span>"+paCommonUtil.replaceURLWithTag(paCommonUtil.replaceLineBr(comment))+"</span></td>"}if(!PMSOperation.kraUsrformDtl.WEIGHTAGE&&PMSOperation.kraWeightageRange){row+="<td><span>"+("null"==val.minRange&&"null"==val.maxRange?"-":val.minRange+" - "+val.maxRange)+"</span></td>"}if("USER_KRA"==mode){if(void 0!=empDetails&&void 0!=empDetails[val.owner]){var empData=empDetails[val.owner];row+='<td><div class="zpl_em"><div class="zpl_emimg"><img src="'+empData.photo+'"></div><div class="zpl_emdts"><div><em>'+empData.empid+" - </em><b>"+empData.name+"</b></div></div></div></td>"}if(row+="<td>",-1==val.approvalStatus){var kraUserId=kraUserIdDetails[id];row+='<span class="PI_Approval-pending"'+(void 0!=kraUserId?" onclick=\"PMSOperation.showUserKraForm('"+kraUserId+"');\"":"")+"></span>"}else 1==val.approvalStatus&&(row+='<span class="grn PI_like"></span>');row+="</td>"}return"KRA"==mode?row+='<td><div class="zpl_hvr"><i class="PI_edt"  title="'+ZPI18N.getString("zp.edit")+'" onclick="PMSOperation.showeditkra(\''+val[PMSOperation.tagComponentKeyNames.IdKey]+'\', this)"></i><i class="PI_delete"  title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.kradelconfrim(\'confirm\', this)"></i> </div>  </td>':"USER_KRA"==mode&&(row+='<td><div class="zpl_hvr">'+(-1!=val.approvalStatus?'<i class="PI_sndfile" title="'+ZPI18N.getString("zp.changetocommonkra",new Array(PMSSetting.KRA_DISPLAY_NAME))+'" onclick="PMSOperation.showChangetoCommonKra(\''+val[PMSOperation.tagComponentKeyNames.IdKey]+"')\"></i>":"")+'<i class="PI_edt"  title="'+ZPI18N.getString("zp.edit")+'" onclick="PMSOperation.showedituserkra(\''+val[PMSOperation.tagComponentKeyNames.IdKey]+'\', this)"></i><i class="PI_delete"  title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.kradelconfrim(\'confirm\', this)"></i> </div>  </td>'),row+="</tr>"},libraryMenu:function(event){var iconClass=event.detail.iconClass;"PI_imprt"==iconClass?"#operations/performance/kra"==Layout.Page.hash?PMSImport.showImport("kraForm"):"#operations/performance/competency"==Layout.Page.hash?PMSImport.showImport("competency_form"):"#operations/performance/skillset"==Layout.Page.hash&&PMSImport.showImport("skillform"):"PI_exprt"==iconClass&&("#operations/performance/kra"==Layout.Page.hash?PMSCommon.Export.showExportPopup(PMSCommon.Export.exportdata,"kraForm"):"#operations/performance/competency"==Layout.Page.hash?PMSCommon.Export.showExportPopup(PMSCommon.Export.exportdata,"competency_form"):"#operations/performance/skillset"==Layout.Page.hash&&PMSCommon.Export.showExportPopup(PMSCommon.Export.exportdata,"skillform"))},removeAllMultiDeleteAction:function(mode){var sliderEle=$(PMSOperation.moduleLibraryslider.sliderDiv);sliderEle.find("#librarylist input").prop("checked",!1),sliderEle.find("#allselchk").prop("checked",!1),0==sliderEle.find("#librarylist input:checked").length&&sliderEle.find("#multideletediv").removeClass("opn"),""!=sliderEle.find("#skillsetsearch").val()&&(sliderEle.find("#skillsetsearch").parent().addClass("opn"),PMSOperation.searchSkillSet(sliderEle.find("#skillsetsearch"),mode,!0))},multiDeleteAction:function(obj){var sliderEle=$(PMSOperation.moduleLibraryslider.sliderDiv);$(obj).find("input").is(":checked")&&!sliderEle.find("#multideletediv").hasClass("opn")?(sliderEle.find("#multideletediv").addClass("opn"),sliderEle.find("#librarylist input:checked").length==parseInt(sliderEle.find("#modulelistcount").text())&&sliderEle.find("#allselchk").prop("checked",!0)):0==sliderEle.find("#librarylist input:checked").length&&(sliderEle.find("#allselchk").prop("checked",!1),sliderEle.find("#multideletediv").removeClass("opn")),sliderEle.find("#skillsetsearch").parent().removeClass("opn")},selectAllMultiDeleteAction:function(obj){var sliderEle=$(PMSOperation.moduleLibraryslider.sliderDiv);$(obj).find("input").is(":checked")?(sliderEle.find("#librarylist input").prop("checked",!0),$(obj).find("input").is(":checked")&&!sliderEle.find("#multideletediv").hasClass("opn")&&sliderEle.find("#librarylist input:checked").length>0&&sliderEle.find("#multideletediv").addClass("opn")):(sliderEle.find("#librarylist input").prop("checked",!1),0==sliderEle.find("#librarylist input:checked").length&&sliderEle.find("#multideletediv").removeClass("opn"))},libraryListMultiDelete:function(obj,mode){var pageId=settingsPage.container,sliderEle=$(PMSOperation.moduleLibraryslider.sliderDiv),displayName="";"COMPETENCY"==mode?displayName=PMSSetting.COMPETENCY_DISPLAY_NAME:"KRA"==mode||"USER_KRA"==mode?displayName=PMSSetting.KRA_DISPLAY_NAME:"SKILL"==mode?displayName=PMSSetting.skilldispName:"SUMMARY"==mode?displayName=PMSSetting.SUMMARY_DISPLAY_NAME:"REVQES"==mode&&(displayName=PMSSetting.QUS_ANS_DISPLAY_NAME);var checkedlist=[];if(sliderEle.find("#librarylist input:checked").each(function(){var checkid=$(this).parent().parent().parent().attr("id");checkedlist.push(checkid.split("_")[1])}),checkedlist.length>100)return ZPeople.Message.warning(ZPI18N.getString("zp.module.delete",new Array(displayName))),!1;if(checkedlist.length>0){var deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.common.entitydelete",new Array(displayName)),deletePopUp.despcription=ZPI18N.getString("zp.pa.deletelibrecmsg",new Array(displayName,displayName)),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){var params={mode:"operationsmultidelete",conreqcsr:csrfToken,recidlist:JSON.stringify(checkedlist)};"KRA"==mode?params.submode="deleteMultikra":"USER_KRA"==mode?params.submode="deleteMultiuserkra":"COMPETENCY"==mode?params.submode="deleteMulticomp":"SKILL"==mode?params.submode="deleteMultiskillset":"REVQES"==mode&&(params.submode="deleteReviewQuestions"),$.post("/performanceConfig.zp",params,function(resultData){if(ZAlertDialog.close(),"success"==resultData.msg){if(sliderEle.find("#multideletediv").removeClass("opn"),sliderEle.find("#allselchk").prop("checked",!1),"KRA"==mode){for(var i in checkedlist)sliderEle.find("#kra_"+checkedlist[i]).remove();void 0!=resultData.kraDetails&&void 0!=resultData.kraDetails.kraList?PMSOperation.ALL_KRA=resultData.kraDetails.kraList:PMSOperation.ALL_KRA=[];var optType=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue());PMSOperation.getKraMaping(optType),ZPeople.Message.success(ZPI18N.getString("zp.deletesuccessful")),$(sliderEle).find("#modulelistcount").text(PMSOperation.ALL_KRA.length),PMSOperation.libraryConstruction("KRA",PMSOperation.ALL_KRA)}else if("USER_KRA"==mode){for(var i in checkedlist)sliderEle.find("#userkra_"+checkedlist[i]).remove();void 0!=resultData.kraDetails&&void 0!=resultData.kraDetails.kraList?(PMSOperation.ALL_USER_KRA=resultData.kraDetails.kraList,PMSOperation.USER_KRA_EMP_DETAILS=void 0!=resultData.kraDetails.empList?resultData.kraDetails.empList:{},PMSOperation.USER_KRA_MAPID_DETAILS=void 0!=resultData.kraDetails.kraUserIdList?resultData.kraDetails.kraUserIdList:{}):(PMSOperation.ALL_USER_KRA=[],PMSOperation.USER_KRA_EMP_DETAILS={},PMSOperation.USER_KRA_MAPID_DETAILS={}),ZPeople.Message.success(ZPI18N.getString("zp.deletesuccessful")),$(sliderEle).find("#modulelistcount").text("("+PMSOperation.ALL_USER_KRA.length+")"),PMSOperation.libraryConstruction("USER_KRA",PMSOperation.ALL_USER_KRA)}else if("COMPETENCY"==mode){for(var i in checkedlist)sliderEle.find("#competency_"+checkedlist[i]).remove();ZPeople.Message.success(ZPI18N.getString("zp.deletesuccessful")),PMSOperation.allCompetencies=resultData.competencies;optType=parseInt(ZPeopleComponents.select(pageId.find("#compdesdepsel2")).getValue());PMSOperation.getCompMapping(optType),$(sliderEle).find("#modulelistcount").text("("+PMSOperation.ALL_USER_KRA.length+")"),PMSOperation.libraryConstruction("COMPETENCY",resultData.competencies)}else if("SKILL"==mode){for(var i in checkedlist)sliderEle.find("#skill_"+checkedlist[i]).remove();ZPeople.Message.success(ZPI18N.getString("zp.deleted.successfully.msg",new Array(PMSSetting.skilldispName)));var skillLen="no_skills"==resultData.skillslist[0].msg?0:resultData.skillslist.length;$(sliderEle).find("#modulelistcount").text(skillLen),"no_skills"==resultData.skillslist[0].msg&&(PMSOperation.ALL_SKILLS=[]),""!=sliderEle.find("#skillsetsearch").val()&&void 0==resultData.skillslist[0].msg&&resultData.skillslist.length>0&&(PMSOperation.ALL_SKILLS=resultData.skillslist),PMSOperation.libraryConstruction("SKILL",PMSOperation.ALL_SKILLS),PMSOperation.skillsetConst.domaintriggered=!1,PMSOperation.skillsetConst.destriggered=!1,PMSOperation.skillsetConst.deptriggered=!1,PMSOperation.skillsetConst.desDeptriggered=!1,PMSOperation.skillSetMappingListView()}else if("REVQES"==mode){for(var i in checkedlist)sliderEle.find("#REVQES_"+checkedlist[i]).remove();$(sliderEle).find("#modulelistcount").text(sliderEle.find("#librarylist input:input:checkbox").length),0==sliderEle.find("#librarylist input:input:checkbox").length&&PMSOperationCommon.setNoData(sliderEle.find("#librarylist"),ZPI18N.getString("zp.pa.nodataadded",new Array(displayName)),"no_data_found",null,ZPI18N.getString("zp.pa.tagreviewques",new Array(displayName)),null),ZPeople.Message.success(ZPI18N.getString("zp.deletesuccessful")),PMSOperation.getReviewQuestion()}}else"MAX_LENGTH_EXCEEDED"==resultData.msg?ZPeople.Message.warning(ZPI18N.getString("zp.module.delete",new Array(displayName))):"failure"==resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")):"tagged"===resultData.msg?ZPeople.Message.warning(ZPI18N.getString("zp.skillstagged",new Array(PMSSetting.skilldispName,PMSSetting.skilldispName))):ZPeople.Message.failure(resultData.msg)})},deletePopUp.show()}},opnsearch:function(mode){let sliderDiv=null,element=null;mode&&"noAppEmp"===mode?element=(sliderDiv=PMSOperation.includeEmpSliderObj.sliderDiv).find("#notAppSerachEmployee"):"CRAppEmp"==mode?element=(sliderDiv=PMSOperation.crManageEmpSliderObj.sliderDiv).find("#CRAppSerachEmployee"):"CRNonAppEmp"==mode?element=(sliderDiv=PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv).find("#CRNonAppSerachEmployee"):"CRReminder"==mode?(PMSOperation.REMINDER_POKE_PREV_SEARCHTEXT="",element=(sliderDiv=PMSOperation.CR_REMAINDER_MODAL.sliderDiv).find("#CRReminderSerachEmployee")):"CycleReminder"==mode?(PMSOperation.REMINDER_POKE_PREV_SEARCHTEXT="",element=(sliderDiv=PMSV2Cycle.reminderslider.sliderDiv).find("#CycleReminderSerachEmployee")):"CRAppAvgEmp"==mode?(PMSOperation.REMINDER_POKE_PREV_SEARCHTEXT="",element=(sliderDiv=PMSOperation.SHOW_SELFCR_MODAL.sliderDiv).find("#CRAvgSerachEmployee")):"AppraisalCycle"==mode?(PMSOperation.APPRAISAL_CYCLE_PREV_SEARCHTEXT="",element=(sliderDiv=Layout.Page.container.find("#cycleListDiv")).find("#apprCyclesearch")):"SalaryCycle"==mode?(PMSOperation.SALARY_CYCLE_PREV_SEARCHTEXT="",element=(sliderDiv=Layout.Page.container.find("#cycleListDiv")).find("#salaryCyclesearch")):"Esign_StatusList"==mode?(PMSESign.ESIGN_PREV_SEARCHTEXT="",element=(sliderDiv=PMSESign.apprEsignDocumentObj.sliderDiv).find("#CycleEsignSerachEmployee")):element=(sliderDiv=PMSOperation.moduleLibraryslider.sliderDiv).find("#skillsetsearch"),null!=element&&(element.parent().hasClass("opn")||element.parent().addClass("opn"),$(element).focus())},clssearch:function(mode){let sliderDiv=null,searchInput=null;(searchInput=mode&&"noAppEmp"===mode?(sliderDiv=PMSOperation.includeEmpSliderObj.sliderDiv).find("#notAppSerachEmployee"):"CRAppEmp"==mode?(sliderDiv=PMSOperation.crManageEmpSliderObj.sliderDiv).find("#CRAppSerachEmployee"):"CRNonAppEmp"==mode?(sliderDiv=PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv).find("#CRNonAppSerachEmployee"):"CRReminder"==mode?(sliderDiv=PMSOperation.CR_REMAINDER_MODAL.sliderDiv).find("#CRReminderSerachEmployee"):"CycleReminder"==mode?(sliderDiv=PMSV2Cycle.reminderslider.sliderDiv).find("#CycleReminderSerachEmployee"):"CRAppAvgEmp"==mode?(sliderDiv=PMSOperation.SHOW_SELFCR_MODAL.sliderDiv).find("#CRAvgSerachEmployee"):"AppraisalCycle"==mode?(sliderDiv=Layout.Page.container.find("#cycleListDiv")).find("#apprCyclesearch"):"SalaryCycle"==mode?(sliderDiv=Layout.Page.container.find("#cycleListDiv")).find("#salaryCyclesearch"):"Esign_StatusList"==mode?(sliderDiv=PMSESign.apprEsignDocumentObj.sliderDiv).find("#CycleEsignSerachEmployee"):(sliderDiv=PMSOperation.moduleLibraryslider.sliderDiv).find("#skillsetsearch")).parent().hasClass("opn")&&(searchInput.parent().removeClass("opn"),searchInput.val(""),mode&&"noAppEmp"===mode?(PMSOperation.nonAppraiseeList=[],PMSOperation.tempNonAppraiseeList=[],PMSOperation.nonAppraiseeListSIndex=1,sliderDiv.find("#includeEmpTab").html(""),sliderDiv.find("#includeAllEmployeeChkBox").prop("checked",!1),PMSOperation.constructIncludeEmployeeDiv()):mode&&"CRAppEmp"===mode?(PMSOperation.INCLUDE_EXCLUDE_USER_ARR=[],PMSOperation.searchCRApplicableEmployees(searchInput)):"CRNonAppEmp"==mode?(PMSOperation.CR_NOT_APPLI_LST=[],PMSOperation.searchCRNonApplicableEmployees(searchInput)):"CRReminder"==mode?(PMSOperation.crRemainderUsrList=[],PMSOperation.CR_FS_ST_IDX=1,PMSOperation.constructCRRemainderModal()):"CycleReminder"==mode?(PMSV2Cycle.remindUserList=[],PMSV2Cycle.pendingStartIndx=1,PMSV2Cycle.showReminderSlider(PMSV2Cycle.CYCLE_REMINDER_OBJ.type,PMSV2Cycle.CYCLE_REMINDER_OBJ.configId,PMSV2Cycle.CYCLE_REMINDER_OBJ.userCount)):"AppraisalCycle"==mode||"SalaryCycle"==mode?("AppraisalCycle"==mode?PMSOperation.APPRAISAL_CYCLE_PREV_SEARCHTEXT="":PMSOperation.SALARY_CYCLE_PREV_SEARCHTEXT="",PMSOperation.loadCycles()):"CRAppAvgEmp"==mode?PMSOperation.getSelfFinalCRData("all"):"Esign_StatusList"==mode?(PMSESign.ESIGN_PREV_SEARCHTEXT="",PMSESign.esignOprStatusOnchange()):PMSOperation.searchSkillSet(searchInput,mode,!1))},searchSkillSet:function(key,component,isInput){var strval=$(key).val(),arr=(key="skillsName",PMSOperation.ALL_SKILLS);if("COMPETENCY"==component?(key="name",arr=PMSOperation.allCompetencies):"KRA"==component||"USER_KRA"==component?(key="kraName",arr="KRA"==component?PMSOperation.ALL_KRA:PMSOperation.ALL_USER_KRA):"REVQES"==component&&(key="question",arr=PMSOperation.allQuestion),0==arr.length)return!1;PMSOperation.skillsetSearchResult=new Array,PMSOperation.skillsetSearchResult=PMSOperation.SearchComponent(arr,strval,key),PMSOperation.libraryConstruction(component,PMSOperation.skillsetSearchResult,strval,!!isInput)},SearchComponent:function(arr,strval,key){var result=new Array;if(""!=strval&&void 0!=strval){for(var i=0;i<arr.length;i++)ZPeople.decodeTxt(arr[i][key]).toLocaleLowerCase().includes(strval.toLocaleLowerCase())&&result.push(arr[i]);result=result.sort(function(a,b){var x=ZPeople.decodeTxt(a[key]),y=ZPeople.decodeTxt(b[key]);return(x=x.toLocaleLowerCase().indexOf(strval.toLocaleLowerCase()))<(y=y.toLocaleLowerCase().indexOf(strval.toLocaleLowerCase()))?-1:x>y?1:0})}else result=JSON.parse(JSON.stringify(arr));return result},addKRAPopup:function(obj,component,recid){let popupName="";const addAction=recid?ZPI18N.getString("zp.edit"):ZPI18N.getString("zp.add");let id,addOrEdit;switch(component){case"COMPETENCY":popupName=addAction+" "+PMSSetting.COMPETENCY_DISPLAY_NAME,id="comp_name",addOrEdit=recid?"editcomp":"add";break;case"KRA":popupName=addAction+" "+PMSSetting.KRA_DISPLAY_NAME,id="kra_name",addOrEdit=recid?"editkra":"add";break;case"USER_KRA":popupName=addAction+" "+ZPI18N.getString("zp.userspecifickra",new Array(PMSSetting.KRA_DISPLAY_NAME)),id="kra_name",addOrEdit="editkra";break;case"SKILL":popupName=addAction+" "+PMSSetting.skilldispName,id="skillSearch",addOrEdit=recid?"edit":"add";break;case"SUMMARY":popupName=addAction+" "+ZPI18N.getString("zp.question"),id="new_question",addOrEdit=recid?"edit":"add";break;case"REVQES":popupName=addAction+" "+PMSSetting.QUS_ANS_DISPLAY_NAME,id="revques_name",addOrEdit=recid?"editcomp":"add"}var popupTab=new Tab("kraaddpopup",function(){let _htm='<form><div class="zpl_crd"><div class="zpl_crdcnt">';switch(component){case"KRA":case"USER_KRA":_htm+='<div class="zpl_secn"> <div> <label class="zpl_mtry">'+ZPI18N.getString("zp.title")+'</label> </div> <div> <input type="text" id="kra_name" placeholder="'+ZPI18N.getString("zp.lms.messages.titleempty")+'" class="ztextbox ztextbox_opn"><span class="ztextbox--error__label" id="kra_exist_error"></span> </div> </div>',_htm+='<div class="zpl_secn"> <div> <label>'+ZPI18N.getString("zp.description")+'</label> </div> <div> <textarea class="ztextbox"  id="kra_desc" rows="3" placeholder="'+ZPI18N.getString("zp.enterdesc")+'"></textarea><span class="ztextbox--error__label" id="kra_desc_error"></span> </div> </div>',!PMSOperation.kraUsrformDtl.WEIGHTAGE&&PMSOperation.kraWeightageRange&&(_htm+='<div><div class="zpl_secn"> <div> <label>'+ZPI18N.getString("zp.weightage")+'</label><i class="PI_info" id="weightinfo" title="'+ZPI18N.getString("zp.pa.kra.weightinfo",[PMSSetting.KRA_DISPLAY_NAME])+'"></i></div>',_htm+='<div class="zpl_idiv" id="weightageRangeDiv">',_htm+='<input type="text" style="width: 140px;" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'moduleWeightage\');" id="minweightage" class="ztextbox w80I" placeholder="'+ZPI18N.getString("zp.pa.kra.kraweightminrange")+'"><em>-</em>',_htm+='<input type="text" style="width: 140px;" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'moduleWeightage\');" id="maxweightage" class="ztextbox w80I" placeholder="'+ZPI18N.getString("zp.pa.kra.kraweightmaxrange")+'">',_htm+='</div></div><span class="ztextbox--error__label" id="kra_range_error"></span></div>');break;case"COMPETENCY":_htm+='<div class="zpl_secn"> <div> <label class="zpl_mtry">'+ZPI18N.getString("zp.title")+'</label> </div> <div> <input type="text" placeholder="'+ZPI18N.getString("zp.lms.messages.titleempty")+'" id="comp_name" class="ztextbox ztextbox_opn"><span class="ztextbox--error__label" id="comp_exist_error"></span> </div> </div>',_htm+='<div class="zpl_secn"> <div> <label>'+ZPI18N.getString("zp.description")+'</label> </div> <div> <textarea class="ztextbox" placeholder="'+ZPI18N.getString("zp.enterdesc")+'" id="comp_desc" rows="3"></textarea><span class="ztextbox--error__label" id="comp_desc_error"></span> </div> </div>';break;case"SKILL":_htm+='<div class="zpl_secn"> <div> <label class="zpl_mtry"><label>'+ZPI18N.getString("zp.title")+'</label> </div> <div> <input type="text" id="skillSearch" placeholder="'+ZPI18N.getString("zp.lms.messages.titleempty")+'" class="ztextbox ztextbox_opn"><span class="ztextbox--error__label" id="skillset_exist_error"></span> </div> </div>',_htm+='<div class="zpl_secn"> <div> <label>'+ZPI18N.getString("zp.description")+'</label> </div> <div> <textarea class="ztextbox"  id="skill_desc" rows="3" placeholder="'+ZPI18N.getString("zp.enterdesc")+'"></textarea><span class="ztextbox--error__label" id="skill_desc_error"></span> </div> </div>';break;case"SUMMARY":_htm+='<div class="zpl_secn"><div id="new_add_quetion"> <textarea class="ztextbox"  id="new_question" placeholder="'+popupName+'" rows="3"></textarea><span class="ztextbox--error__label" id="summary_exist_error"></span> </div> </div>';break;case"REVQES":_htm+='<div class="zpl_secn"><div id="new_addrev_quetion"> <textarea class="ztextbox"  placeholder="'+popupName+'" id="revques_name" rows="3"></textarea><span class="ztextbox--error__label" id="revques_exist_error"></span> </div> </div>'}_htm+="</form></div></div>",$("#cardkraaddpopup").html(_htm)},function(){switch(component){case"COMPETENCY":PMSOperation.addCompetency(addOrEdit,recid);break;case"KRA":case"USER_KRA":PMSOperation.addKra(addOrEdit,recid);break;case"SKILL":PMSOperation.addSkills(addOrEdit,recid);break;case"SUMMARY":PMSOperation.saveQuestions(addOrEdit,recid);break;case"REVQES":PMSOperation.addQuestion(addOrEdit,recid)}});PMSOperation.kraaddmodal=new popupModal(popupName,popupTab),PMSOperation.kraaddmodal.setCloseCallback(function(){PMSOperation.kraaddmodal.remove(),PMSOperation.kraaddmodal={}}),PMSOperation.kraaddmodal.construct();const popEle=$(PMSOperation.kraaddmodal.sliderDiv);PMSOperationCommon.focus(popEle.find("#"+id))},addKra:function(mode,recId){var successmsg,popEle=$(PMSOperation.kraaddmodal.sliderDiv),pageId=settingsPage.container,kraName=$("#kra_name").val(),kraDes=$("#kra_desc").val(),params={mode:"addkra",conreqcsr:csrfToken};if(params.kraName=kraName,params.kraDes=kraDes,popEle.find("#kra_exist_error").hide(),void 0==kraName||""==kraName.trim(""))return popEle.find("#kra_name").addClass("ztextbox__error"),void popEle.find("#kra_exist_error").html(ZPI18N.getString("zp.invalidvalue",[PMSSetting.KRA_DISPLAY_NAME])).show();if(popEle.find("#kra_name").removeClass("ztextbox__error"),kraName.length>500)return popEle.find("#kra_exist_error").html(ZPI18N.getString("zp.fieldpropertymaxlength",[PMSSetting.KRA_DISPLAY_NAME+" "+ZPI18N.getString("zp.name"),"500 characters"])),void popEle.find("#kra_exist_error").show();if(-1!=kraName.indexOf("<")&&-1!=kraName.indexOf(">"))return popEle.find("#kra_exist_error").html(ZPI18N.getString("zp.charactorremove",["<, >"])),void popEle.find("#kra_exist_error").show();if(kraDes.length>5e3)return popEle.find("#kra_desc").addClass("ztextbox__error"),void popEle.find("#kra_desc_error").html(ZPI18N.getString("zp.fieldpropertymaxlength",[PMSSetting.KRA_DISPLAY_NAME+" "+ZPI18N.getString("zp.description"),"5000 characters"])).show();if(popEle.find("#kra_desc_error").removeClass("ztextbox__error"),-1!=kraDes.indexOf("<")&&-1!=kraDes.indexOf(">"))return popEle.find("#kra_desc_error").html(ZPI18N.getString("zp.charactorremove",["<, >"])),void popEle.find("#kra_desc_error").show();if(PMSOperation.kraWeightageRange){let errMsg=PMSOperation.validateWeightageRange();if(""!=errMsg)return popEle.find("#kra_range_error").html(errMsg),void popEle.find("#kra_range_error").show();if(""!=popEle.find("#minweightage").val()&&""!=popEle.find("#maxweightage").val()){const min=parseInt(popEle.find("#minweightage").val(),10),max=parseInt(popEle.find("#maxweightage").val(),10);let weightObj={};weightObj.min=min,weightObj.max=max,params.weightageRange=JSON.stringify(weightObj)}}void 0!=mode&&"editkra"==mode&&void 0!=recId?(params.recId=recId,successmsg=ZPI18N.getString("zp.updatesuccessful")):successmsg=ZPI18N.getString("zp.addsuccessful"),$.post("/performanceConfig.zp",params,function(resultData){if(void 0!=resultData.msg&&"success"==resultData.msg){if(ZPeople.Message.success(successmsg),PMSOperation.isLibraryModalOpen&&"USER_KRA"==PMSOperation.LIBRARY_MODE?void 0!=resultData.kraDetails&&void 0!=resultData.kraDetails.kraList?(PMSOperation.ALL_USER_KRA=resultData.kraDetails.kraList,PMSOperation.USER_KRA_EMP_DETAILS=void 0!=resultData.kraDetails.empList?resultData.kraDetails.empList:{},PMSOperation.USER_KRA_MAPID_DETAILS=void 0!=resultData.kraDetails.kraUserIdList?resultData.kraDetails.kraUserIdList:{}):(PMSOperation.ALL_USER_KRA=[],PMSOperation.USER_KRA_EMP_DETAILS={},PMSOperation.USER_KRA_MAPID_DETAILS={}):void 0!=resultData.kraDetails&&void 0!=resultData.kraDetails.kraList?PMSOperation.ALL_KRA=resultData.kraDetails.kraList:PMSOperation.ALL_KRA=[],PMSOperation.ALL_KRA.length>0&&1==pageId.find("#cardview-mapcontent #emptPage").length){var _btnName=ZPI18N.getString("zp.tag.module",new Array(PMSSetting.KRA_DISPLAY_NAME));PMSOperationCommon.setNoData(pageId.find("#cardview-mapcontent"),ZPI18N.getString("zp.pa.norectagged",new Array(PMSSetting.KRA_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.tagkramsg",new Array(PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME)),_btnName),pageId.find("#kralibrarybtn").show(),pageId.find("#kramappingbtn").hide(),pageId.find("#empBtnCrt").click(function(){PMSOperation.tagKra()})}if(void 0!=PMSOperation.chooseConponentList&&PMSOperation.chooseConponentList.length>0&&!PMSOperation.isLibraryModalOpen){var temp={};temp.kraId=resultData.kraId,temp.kraName=resultData.kraName;var arr=new Array;arr.push(temp);$("#choosekraSearch").length>0&&$("#choosekraSearch").val().trim();PMSOperation.tagComponentChooselistConstruction(arr,"kraName",!0),PMSOperation.chooseConponentList.push(temp),PMSOperation.chooseSelectAllReset()}else void 0!=PMSOperation.moduleLibraryslider&&PMSOperation.libraryConstruction(PMSOperation.LIBRARY_MODE,"KRA"==PMSOperation.LIBRARY_MODE?PMSOperation.ALL_KRA:PMSOperation.ALL_USER_KRA);if("KRA"==PMSOperation.LIBRARY_MODE&&void 0!=mode&&"editkra"==mode){var type=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue());PMSOperation.getKraMaping(type)}if(void 0==PMSOperation.moduleLibraryslider&&!PMSOperation.isLibraryModalOpen)return void PMSOperation.kraaddmodal.close()}else if("Already exists"==resultData.error)ZPeople.Message.failure(ZPI18N.getString("zp.existingkraname",new Array(PMSSetting.KRA_DISPLAY_NAME)));else{if("exceeds maxLen"==resultData.error)return popEle.find("#kra_exist_error").html(ZPI18N.getString("zp.fieldpropertymaxlength",[PMSSetting.KRA_DISPLAY_NAME+" "+ZPI18N.getString("zp.name"),resultData.maxLen+" characters"])),void popEle.find("#kra_exist_error").show();ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))}void 0==PMSOperation.kraaddmodal||jQuery.isEmptyObject(PMSOperation.kraaddmodal)||PMSOperation.kraaddmodal.close()})},validateWeightageRange:function(){var popEle=$(PMSOperation.kraaddmodal.sliderDiv);const minVal=popEle.find("#minweightage").val(),maxVal=popEle.find("#maxweightage").val(),min=parseInt(minVal,10),max=parseInt(maxVal,10);let erroMsg="";const getWeightageError=()=>""===minVal||""===maxVal?ZPI18N.getString("zp.pa.kra.kraweightvalidmaxminrange"):isNaN(min)||isNaN(max)?ZPI18N.getString("zp.pa.kra.kraweightminmaxnumber"):min===max?ZPI18N.getString("zp.cycle.errormsg.minrangecannotbeequalmaxrange"):min<0||max<0?ZPI18N.getString(" zp.pa.kra.kraweightminmaxnotnegative"):min>100||max>100?ZPI18N.getString("zp.cycle.errormsg.maxminrangelesserthan",["100"]):min>=max?ZPI18N.getString("zp.pa.kra.kraminrangelesserthanmaxrange"):"";return PMSOperation.kraWeightageRangeMandatory?erroMsg=getWeightageError():(minVal||maxVal)&&(erroMsg=getWeightageError()),erroMsg},closeTagDiv:function(id){delete PMSOperation.chooseConponentList,delete PMSOperation.selectedConponentList,delete PMSOperation.searchTagChooseList,delete PMSOperation.searchTagSelectedList,PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.removeAllElementInTagComponent("csekralst")},addNewRowInSelected:function(obj){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),IdKey=PMSOperation.tagComponentKeyNames.IdKey,NameKey=PMSOperation.tagComponentKeyNames.NameKey,allCom=PMSOperation.setAllComponentList(),weightageKey=PMSOperation.tagComponentKeyNames.weightageKey,comName=PMSOperation.tagComponentKeyNames.comName,parent=$(obj).closest("li"),kraId=$(parent).attr("id");PMSSetting.skilldispName;if("competency"==comName?PMSSetting.COMPETENCY_DISPLAY_NAME:"kra"==comName?PMSSetting.KRA_DISPLAY_NAME:"question"==comName&&PMSSetting.QUS_ANS_DISPLAY_NAME,$(obj).is(":checked")){var Data=allCom[PMSOperation.findArrayindexBykeyValue(allCom,IdKey,kraId)];(temp={})[NameKey]=Data[NameKey],temp[IdKey]=kraId,temp[weightageKey]=0,"question"==comName?PMSOperation.selectedConponentList.push(temp):PMSOperation.selectedConponentList.splice(0,0,temp);var arr=new Array;arr.push(temp),sliderEle.find("#sltkralst #emptPage").remove(),PMSOperation.tagComponentSelectedlistConstruction(arr,NameKey,IdKey,weightageKey,void 0,"added"),0==sliderEle.find("#csekralst li").length&&PMSOperationCommon.setNoData(sliderEle.find("#csekralst"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null),PMSOperation.chooseConponentList.splice(PMSOperation.findArrayindexBykeyValue(PMSOperation.chooseConponentList,IdKey,kraId),1)}else{var temp;Data=allCom[PMSOperation.findArrayindexBykeyValue(allCom,IdKey,kraId)];(temp={})[NameKey]=Data[NameKey],temp[IdKey]=kraId,temp[weightageKey]=0,PMSOperation.chooseConponentList.splice(0,0,temp),sliderEle.find("#csekralst #emptPage").remove(),sliderEle.find("#sltkralst").find("#"+kraId).remove(),0==sliderEle.find("#sltkralst li").length&&PMSOperationCommon.setNoData(sliderEle.find("#sltkralst"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null),PMSOperation.selectedConponentList.splice(PMSOperation.findArrayindexBykeyValue(PMSOperation.selectedConponentList,IdKey,kraId),1)}PMSOperation.changeSelectedCount(),PMSOperation.chooseSelectAllReset()},setAllComponentList:function(){return"kra"==PMSOperation.tagComponentKeyNames.comName?PMSOperation.ALL_KRA:"skill"==PMSOperation.tagComponentKeyNames.comName?PMSOperation.ALL_SKILLS:"competency"==PMSOperation.tagComponentKeyNames.comName?PMSOperation.allCompetencies:"question"==PMSOperation.tagComponentKeyNames.comName?PMSOperation.allQuestion:void 0},findArrayindexBykeyValue:function(arr,key,val){for(var i=0;i<arr.length;i++)if(arr[i][key]==val)return i},iterateTokenFieldValues:function(arr){for(var idArr=[],i=0;i<arr.length;i++)idArr.push(arr[i].id);return idArr},tagkranew:function(mode){var pageId=settingsPage.container,sliderEle=$(PMSOperation.sliderObj.sliderDiv),optType=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue()),mapId=ZPeopleComponents.isComponent(sliderEle.find("#ddl_list"))?PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#ddl_list")).getAllValues()):[],desId=ZPeopleComponents.isComponent(sliderEle.find("#des_list"))?ZPeopleComponents.select(sliderEle.find("#des_list")).getValue():"",lvlId="";lvlId="5"==optType||"4"==optType?ZPeopleComponents.isComponent(sliderEle.find("#lvl-list"))?ZPeopleComponents.select(sliderEle.find("#lvl-list")).getValue():"":ZPeopleComponents.isComponent(sliderEle.find("#lvl-list"))?PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#lvl-list")).getAllValues()):[];var depId=ZPeopleComponents.isComponent(sliderEle.find("#dep_list"))?PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#dep_list")).getAllValues()):[];PMSOperation.selectedConponentList.length!=sliderEle.find("#sltkralst li").length&&(PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.tagComponentSelectedlistConstruction(PMSOperation.selectedConponentList,"kraName","kraId","weightage","edit")),sliderEle.find("#ddlselect").parent().find(".ztextbox__error").each(function(){$(this).hasClass("ztokenfield")?(ZPeopleComponents.tokenfield($(this).prev()).setAttributes({className:""}),$(this).next().hide()):$(this).hasClass("zselectbox")&&(ZPeopleComponents.select($(this).prev()).setAttributes({className:""}),$(this).next().hide())});var flag=!0;if(0==optType||1==optType||2==optType){var nameAry=[ZPI18N.getString("zp.designation"),ZPI18N.getString("zp.department"),ZPI18N.getString("zp.location")];if(null==mapId||0==mapId.length)return sliderEle.find("#deserr").show(),void ZPeopleComponents.tokenfield(sliderEle.find("#ddl_list")).setAttributes({className:"ztextbox__error"});if(null!=mapId){var isValid=!0;$.each(PMSOperation.KraMapDetails,function(index,data){mapId.length==data.mapingDetails.length&&($.each(data.mapingDetails,function(index,data1){mapId.includes(data1.mapId)||(isValid=!1)}),isValid&&"edit"!=mode&&(sliderEle.find("#deserr").html(ZPI18N.getString("zp.plsselectPropervalues",[PMSSetting.KRA_DISPLAY_NAME,nameAry[optType],nameAry[optType]])),sliderEle.find("#deserr").show(),ZPeopleComponents.tokenfield(sliderEle.find("#ddl_list")).setAttributes({className:"ztextbox__error"}),flag=!1),isValid=!0)})}}else if(3!=optType||"-1"!=desId&&0!=depId.length&&null!=depId)if(4!=optType||"-1"!=lvlId&&"-1"!=desId)if(5!=optType||"-1"!=lvlId&&"-1"!=desId&&0!=depId.length&&null!=depId){if(6==optType&&(null==mapId||0==mapId.length))return sliderEle.find("#ddlselect").find("#deserr").show(),void ZPeopleComponents.tokenfield(sliderEle.find("#ddl_list")).setAttributes({className:"ztextbox__error"})}else{if(null==desId||"-1"==desId)return sliderEle.find("#desselect").find("#deserr").show(),void ZPeopleComponents.select(sliderEle.find("#des_list")).setAttributes({className:"ztextbox__error"});if(null==lvlId||"-1"==lvlId)return sliderEle.find("#des-lvl-err").show(),void ZPeopleComponents.select(sliderEle.find("#lvl-list")).setAttributes({className:"ztextbox__error"});if(null==depId||0==depId.length)return sliderEle.find("#deperr").show(),sliderEle.find("#deperr").show(),void ZPeopleComponents.tokenfield(sliderEle.find("#dep_list")).setAttributes({className:"ztextbox__error"})}else{if(null==desId||"-1"==desId)return sliderEle.find("#desselect").find("#deserr").show(),void ZPeopleComponents.select(sliderEle.find("#des_list")).setAttributes({className:"ztextbox__error"});if(null==lvlId||"-1"==lvlId)return sliderEle.find("#des-lvl-err").show(),void ZPeopleComponents.select(sliderEle.find("#lvl-list")).setAttributes({className:"ztextbox__error"})}else{if(null==desId||"-1"==desId)return sliderEle.find("#desselect").find("#deserr").show(),void ZPeopleComponents.select(sliderEle.find("#des_list")).setAttributes({className:"ztextbox__error"});if(null==depId||0==depId.length)return sliderEle.find("#deperr").show(),void ZPeopleComponents.tokenfield(sliderEle.find("#dep_list")).setAttributes({className:"ztextbox__error"})}if(!flag)return;var kraIds=[],kraIdlist=[];let wieghtRangeMsg="";if(0==PMSOperation.selectedConponentList.length)return ZPeople.Message.failure(ZPI18N.getString("zp.nokraselected",new Array(PMSSetting.KRA_DISPLAY_NAME))),!1;var totalWeightage=0,modWeightFlag=!1;sliderEle.find("#sltkralst li").each(function(){var kraId=$(this).attr("id"),weightage=$(this).find("input").val();if(weightage=PMSOperation.kraUsrformDtl.WEIGHTAGE?"0":weightage.replace("%",""),totalWeightage+=parseFloat(weightage),("-1"==kraId||void 0==weightage||""==weightage||weightage>100||weightage<0)&&(flag=!1),PMSOperation.kraWeightageRange){const kraobj=PMSOperation.ALL_KRA.find(kra=>kra.kraId===kraId);let minRange=parseInt(kraobj.minRange),maxRange=parseInt(kraobj.maxRange);(Number(weightage)<minRange||Number(weightage)>maxRange)&&(wieghtRangeMsg=ZPI18N.getString("zp.pa.kra.weighterrormessage",[kraobj.kraName,minRange,maxRange]),flag=!1)}if(paCommonUtil.checkKraWeightageMod(weightage,AppraisalConfig.kraWeightageModValue.modVal)&&AppraisalConfig.isKRAWeightageRestirctionEnabled&&(modWeightFlag=!0),-1==kraIdlist.indexOf(kraId)){kraIdlist.push(kraId);var kradtl={};kradtl.kraId=kraId,kradtl.weightage=weightage,kraIds.push(kradtl)}else flag=!1}),totalWeightage=parseFloat(totalWeightage).toFixed(2);var varparams={mode:"getRestrictionWeightageValidation",conreqcsr:csrfToken,type:"kra"};if($.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:varparams,success:function(resultData){PMSOperation.RESTRICT_KRA_WEIGHTAGE=void 0!=resultData.enabled&&resultData.enabled?"1":"0"}}),"0"==PMSOperation.RESTRICT_KRA_WEIGHTAGE&&totalWeightage>100)ZPeople.Message.failure(ZPI18N.getString("zp.errortagcomponent",new Array(PMSSetting.KRA_DISPLAY_NAME)));else if(modWeightFlag)ZPeople.Message.warning(ZPI18N.getString("zp.kraModValueErrMsg",new Array([AppraisalConfig.formUtil.kradispName],[AppraisalConfig.kraWeightageModValue.modVal])));else if(flag){var params={mode:"newmapkra",conreqcsr:csrfToken,optType:optType};params.optType=optType,3==optType?(params.designationId=desId,depId=JSON.stringify(depId),params.deplist=depId):5==optType?(params.designationId=desId,depId=JSON.stringify(depId),params.deplist=depId,params.levelId=lvlId):4==optType?(params.designationId=desId,params.levelId=lvlId):0!=optType&&1!=optType&&2!=optType&&6!=optType||(mapId.includes("1")?params.category="all":mapId.length>1?(mapId=JSON.stringify(mapId),params.mapIdlist=mapId,params.category="multi"):params.mapId=mapId[0]);var labl="";0==optType?labl=ZPI18N.getString("zp.designation"):1==optType?labl=ZPI18N.getString("zp.department"):2==optType?labl=ZPI18N.getString("zp.location"):6==optType&&(labl=PMSOperation.formfieldName);var successmsg="KRA tagged to "+labl,tempArr=Object.assign({},PMSOperation.kramapold);if(void 0!=mode&&"edit"==mode){params.ruleId=PMSOperation.editkraRuleId,params.submode="editmapkra",successmsg=ZPI18N.getString("zp.editedsuccess");var editobj=[],addobj=[],delobj=[],sequenceIds=[],isSeqChanged=!1;sliderEle.find("#sltkralst li").each(function(){var kraId=$(this).attr("id"),weightage=$(this).find("input").val();if(weightage=PMSOperation.kraUsrformDtl.WEIGHTAGE?"0":weightage.replace("%",""),void 0!=PMSOperation.kramapold[kraId]&&void 0!=PMSOperation.kramapold[kraId].sequence&&PMSOperation.kramapold[kraId].sequence!=i+1&&(isSeqChanged=!0),void 0==PMSOperation.kramapold[kraId]||PMSOperation.kraUsrformDtl.WEIGHTAGE||PMSOperation.kramapold[kraId].weightage==weightage)if(void 0==PMSOperation.kramapold[kraId]){var temp;(temp={}).kraId=kraId,temp.weightage=weightage,addobj.push(temp),isSeqChanged=!0,sequenceIds.push(kraId)}else void 0==PMSOperation.kramapold[kraId]||!PMSOperation.kraUsrformDtl.WEIGHTAGE&&PMSOperation.kramapold[kraId].weightage!=weightage||(delete PMSOperation.kramapold[kraId],sequenceIds.push(kraId));else(temp={}).kraId=kraId,temp.weightage=weightage,editobj.push(temp),delete PMSOperation.kramapold[kraId],sequenceIds.push(kraId)}),$.each(PMSOperation.kramapold,function(index,data){var temp={};temp.kraId=index,delobj.push(temp),isSeqChanged=!0});var dataObj=PMSOperation.loadedData,ruleId=void 0!=dataObj.ruleLen&&1==dataObj.ruleLen?void 0:dataObj.ruleId,paramObj=null;if(optType<=2||6==optType){var allDDL=!1,singleDDL=!1,multiDDL=!1;void 0==ruleId?-1!=(ruleId=dataObj.mapingDetails[0].mapId)?singleDDL=!0:allDDL=!0:multiDDL=!0,paramObj=PMSOperation.editKRARuleObj(ruleId,optType,allDDL,singleDDL,multiDDL)}else optType>2&&(paramObj=PMSOperation.editKRAdesignationRule(ruleId,optType));if(void 0!=paramObj){if(void 0!=paramObj.error&&paramObj.error)return $(PMSOperation.sliderObj.sliderDiv).find("#"+paramObj.element).show(),$(PMSOperation.sliderObj.sliderDiv).find("#"+paramObj.element).html(paramObj.errormessage),!1;params.ruleObj=JSON.stringify(paramObj)}if(0==editobj.length&&0==addobj.length&&0==delobj.length&&void 0==paramObj&&!isSeqChanged)return PMSOperation.sliderObj.close(),PMSOperation.kramapold=Object.assign({},tempArr),!1;if((editobj.length>100||addobj.length>100||delobj.length>100)&&void 0==paramObj)return ZPeople.Message.failure(ZPI18N.getString("zp.kralength",new Array(PMSSetting.KRA_DISPLAY_NAME))),PMSOperation.kramapold=Object.assign({},tempArr),!1;editobj=JSON.stringify(editobj),addobj=JSON.stringify(addobj),delobj=JSON.stringify(delobj),sequenceIds=JSON.stringify(sequenceIds),params.toedit=editobj,params.toadd=addobj,params.todel=delobj,params.sequence=sequenceIds}else{if(kraIds.length>100)return ZPeople.Message.failure(ZPI18N.getString("zp.kralength",new Array(PMSSetting.KRA_DISPLAY_NAME))),!1;kraIds=JSON.stringify(kraIds),params.kralist=kraIds}sliderEle.find("#sliderSbt").addClass("disabled"),$.post("/performanceConfig.zp",params,function(resultData){if(sliderEle.find("#sliderSbt").removeClass("disabled"),"success"==resultData.msg)ZPeople.Message.success(successmsg),PMSOperation.sliderObj.close(),PMSOperation.selectedConponentList=[],PMSOperation.chooseConponentList=[],PMSOperation.getKraMaping(optType),PMSOperation.editkraRuleId=-1,PMSOperation.kramapold=Object.assign({},tempArr);else if(void 0!=resultData.msg&&"allReadytagged"==resultData.msg)ZPeople.Message.failure(ZPI18N.getString("zp.duplicateentriescheck"));else if(void 0!=resultData.msg&&"error"==resultData.msg&&void 0!=resultData.errormsg)"weightageError"==resultData.errormsg?ZPeople.Message.failure(ZPI18N.getString("zp.errortagcomponent",new Array(PMSSetting.KRA_DISPLAY_NAME))):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"));else if("PERMISSION_DENIED"===resultData.MSG)ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied"));else if(void 0!=resultData.msg&&"failure"==resultData.msg)"alreadyexists"==resultData.error&&ZPeople.Message.failure(ZPI18N.getString("zp.duplicateentriescheck"));else if(void 0!=resultData.msg&&"range_error"==resultData.msg){const key=Object.keys(resultData).find(k=>"msg"!==k);ZPeople.Message.failure(resultData[key])}else void 0!=resultData.msg?ZPeople.Message.failure(resultData.msg):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"));PMSOperation.editkraRuleId=-1})}else PMSOperation.kraWeightageRange?ZPeople.Message.failure(wieghtRangeMsg):ZPeople.Message.failure(ZPI18N.getString("zp.krainvalidweightage"))},editKRAdesignationRule:function(ruleId,optType){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),params={};if(void 0!=ruleId){var depIdlists=[],levelId=null,ischanged=!1,type="";if(3==optType?(depIdlists=ZPeopleComponents.isComponent(sliderEle.find("#dep_list"))?PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#dep_list")).getAllValues()):[],type="desRule",$.each(PMSOperation.KraMapDetails,function(index,data){data.ruleId==ruleId&&(data.designationrule.length==depIdlists.length?$.each(data.designationrule,function(i,val){-1==depIdlists.indexOf(val.depId)&&(ischanged=!0)}):ischanged=!0)})):4==optType?(levelId=ZPeopleComponents.isComponent(sliderEle.find("#lvl-list"))?ZPeopleComponents.select(sliderEle.find("#lvl-list")).getValue():"",type="desLvl",$.each(PMSOperation.KraMapDetails,function(index,data){data.ruleId==ruleId&&data.lvlId!==levelId&&(ischanged=!0)})):5==optType&&(type="desdepLvl",depIdlists=ZPeopleComponents.isComponent(sliderEle.find("#dep_list"))?PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#dep_list")).getAllValues()):[],levelId=ZPeopleComponents.isComponent(sliderEle.find("#lvl-list"))?ZPeopleComponents.select(sliderEle.find("#lvl-list")).getValue():"",$.each(PMSOperation.KraMapDetails,function(index,data){data.ruleId==ruleId&&(data.designationrule.length==depIdlists.length?$.each(data.designationrule,function(i,val){-1==depIdlists.indexOf(val.depId)&&(ischanged=!0)}):ischanged=!0,data.lvlId!==levelId&&(ischanged=!0))})),!ischanged)return;var depIds=JSON.stringify(depIdlists);depIds=null==depIdlists?[]:JSON.stringify(depIdlists),null!=levelId&&""!==levelId||(levelId=-1),params.depIds=depIds,params.ruleId=ruleId,params.levelId=levelId,params.type=type,params.isRule=1}return params},editKRARuleObj:function(ruleId,optType,allDDL,singleDDL,multiDDL){var pageId=settingsPage.container,params={};if(void 0!=ruleId&&!allDDL){var new_ruleId,objIds,sliderEle=$(PMSOperation.sliderObj.sliderDiv),ids=(optType=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue()),ZPeopleComponents.isComponent(sliderEle.find("#ddl_list"))?PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#ddl_list")).getAllValues()):[]),ischanged=!1,typeStr="",name="",isValid=!1;if(void 0==ids)return void pageId.find("#deserr").show();if(0===optType?(name=ZPI18N.getString("zp.designation"),typeStr="designation",multiDDL&&(typeStr="muldesignation")):1===optType?(name=ZPI18N.getString("zp.department"),typeStr="department",multiDDL&&(typeStr="muldepartment")):2===optType?(name=ZPI18N.getString("zp.location"),typeStr="location",multiDDL&&(typeStr="mullocation")):6===optType&&(name=PMSOperation.formfieldName,typeStr="level",multiDDL&&(typeStr="mullevel")),$.each(PMSOperation.KraMapDetails,function(index,data){(void 0!=data.ruleLen&&1==data.ruleLen||void 0==data.ruleId?data.mapingDetails[0].mapId:data.ruleId)==ruleId&&(void 0!=data.ruleLen&&1==data.ruleLen&&(new_ruleId=data.ruleId),data.mapingDetails.length==ids.length?$.each(data.mapingDetails,function(i,val){-1==ids.indexOf(val.mapId)&&(ischanged=!0)}):ischanged=!0)}),$.each(PMSOperation.KraMapDetails,function(index,data){if(ids.length==data.mapingDetails.length&&(isValid=!0,$.each(data.mapingDetails,function(i,val){ids.includes(val.mapId)||(isValid=!1)}),isValid&&ischanged))return $("#editruleobjerr").html(ZPI18N.getString("zp.plsselectPropervalues",[PMSSetting.KRA_DISPLAY_NAME,name,name])),pageId.find("#editruleobjerr").show(),!1}),!ischanged)return;if(isValid&&ischanged)return params.error=!0,params.errormessage=ZPI18N.getString("zp.plsselectPropervalues",[PMSSetting.KRA_DISPLAY_NAME,name,name]),params.element="deserr",params;objIds=null==ids?[]:JSON.stringify(ids),params.objIds=objIds,params.type=typeStr,void 0!=new_ruleId&&(ruleId=new_ruleId),params.ruleId=ruleId}return params},changeKraViewTab:function(){var sliderDiv=$(PMSOperation.moduleLibraryslider.sliderDiv),kraView=parseInt(ZPeopleComponents.select(sliderDiv.find("#kraView")).getValue());0==kraView?PMSOperation.libraryConstruction("KRA",PMSOperation.ALL_KRA):1==kraView&&PMSOperation.libraryConstruction("USER_KRA",PMSOperation.ALL_USER_KRA)},compSettingInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){PMSOperation.destoryComponentObj();var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!1),pageId.html(""),$.ajax({type:"POST",async:!0,url:"/performance/view/compOperationSettings",data:{conreqcsr:csrfToken},success:function(resultData){pageId.append(resultData),"true"==PMSOperation.isCompShow&&(PMSOperation.getformDetails("competencyUserform"),PMSOperation.tagComponentKeyNames={},PMSOperation.tagComponentKeyNames.NameKey="name",PMSOperation.tagComponentKeyNames.IdKey="compId",PMSOperation.tagComponentKeyNames.weightageKey="weightage",PMSOperation.tagComponentKeyNames.descKey="desc",PMSOperation.tagComponentKeyNames.comName="competency",PMSOperation.getComptencyList())}})}},getComptencyList:function(){$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getCompetency",conreqcsr:csrfToken,optType:0},success:function(resultData){PMSOperation.onloadConstructCompetency(resultData)}})},onloadConstructCompetency:function(resultData,params,mode){var pageId=settingsPage.container;if(!ZPeopleComponents.isComponent("#compmenuiconimpexpmapping")){var mapMenu=ZPeopleComponents.menu(pageId.find("#compmenuiconimpexpmapping"),{forElement:pageId.find("#compmappingimportexpbtn"),className:"",itemclick:e=>{PMSOperation.skillsetMapMenu(e)}});pageId.find("#compmappingimportexpbtn").off("click").on("click",function(ev){mapMenu.show()})}compbrCls="editcomp"==mode?"#editcompsubmit":"#addcompsubmit",PMSOperation.constructCompetency(resultData.competencies),void 0!=resultData.competencies&&resultData.competencies.length>0?(PMSOperation.allCompetencies=resultData.competencies,PMSOperation.constructCompetencymapping(resultData.compMapingDetails,mode)):(PMSOperation.allCompetencies=[],PMSOperation.moduleDefaultNoData("COMPETENCY"))},constructCompetency:function(resultData){settingsPage.container;var _tokenObj={},_options=[];_options.push({name:ZPI18N.getString("zp.designation"),id:"0"}),_options.push({name:ZPI18N.getString("zp.department"),id:"1"}),_options.push({name:ZPI18N.getString("zp.role"),id:"2"}),_options.push({name:ZPI18N.getString("zp.location"),id:"3"}),_options.push({name:ZPI18N.getString("zp.designation")+" & "+ZPI18N.getString("zp.department"),id:"4"}),_tokenObj.options=_options,_tokenObj.contentType="text",_tokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},_tokenObj.removeExistingDropdown=!0,_tokenObj.search={by:["name"],highlightKeyword:!0},_tokenObj.value="0",ZPeopleComponents.select("#compdesdepsel2",_tokenObj),$("#compdesdepsel2").on("zselectchange",PMSOperation.switchcompsubtabs)},constructCompetencymapping:function(resultData,mode,mapid){var pageId=settingsPage.container;if(pageId.find("#competencyMapping").html(""),PMSOperation.CompMapDeatils=resultData,resultData.length>0)pageId.find("#kralibrarybtn").show(),pageId.find("#kramappingbtn").show(),$.each(resultData,function(index,data){if(row='<div class="zpl_crd" id="compmap_'+data.mapId+'"> <div class="zpl_crdcnt"> <div class="zpl_secn"> <div> <ul class="zpl_paperent">',row+="<li ruleId="+data.mapId+"><div><h5>"+data.mapName+"</h5>",void 0!=data.designationrule){row+='<span class="zpl_dots"></span>';var designationrule="",i=0;if($.each(data.designationrule,function(index1,data1){i<PMSOperation.DEF_METHODS_SIZE&&(designationrule+=0==i?data1.depName:",&nbsp;"+data1.depName),i++}),data.designationrule.length>PMSOperation.DEF_METHODS_SIZE){var blncCnt=data.designationrule.length-PMSOperation.DEF_METHODS_SIZE;row+="<em>"+designationrule+',&nbsp;</em><div class="zpl_tg" title="'+ZPI18N.getString("zp.more")+'"><a id="showMore_'+data.mapId+'" mapid="'+data.mapId+'">+'+blncCnt+"</a></div>"}else row+="<em>"+designationrule+"</em>"}row+='</div><div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+'" onclick="PMSOperation.editCompetencymapping(\''+data.mapId+'\');"></i> <i data-popup-open="" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.deleteCompetencymapping(\''+data.mapId+'\')""></i> </div>',row+="</li>",$.each(data.mappings,function(index,val){row+='<li class="zpl_pavlu" id="'+val.compId+'">',PMSOperation.competencyUsrformDtl.WEIGHTAGE||(row+="<b>"+val.weightage+"%</b>"),row+="<span>"+val.name+"</span> </li>"}),row+="</ul></div></div></div></div>",row=$(row),row.data("ldata",data),pageId.find("#competencyMapping").append(row)}),ZPeopleComponents.isComponent("#compmenuiconimpexpmapping")&&ZPeopleComponents.menu("#compmenuiconimpexpmapping").showMenuItems(["#"+ZPeopleComponents.menu("#compmenuiconimpexpmapping").getMenuItemAt("1").attr("id")]),pageId.find("[id^=showMore_]").unbind(),pageId.find("[id^=showMore_]").on("click",event=>{PMSOperation.showMorePopOver(event,"COMPETENCY")});else if(ZPeopleComponents.isComponent("#compmenuiconimpexpmapping")&&ZPeopleComponents.menu("#compmenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#compmenuiconimpexpmapping").getMenuItemAt("1").attr("id")]),PMSOperation.allCompetencies.length>0){var _btnName=ZPI18N.getString("zp.tag.module",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME));PMSOperationCommon.setNoData(pageId.find("#competencyMapping"),ZPI18N.getString("zp.pa.norectagged",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.tagcompetencymsg",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME)),_btnName),pageId.find("#kralibrarybtn").show(),pageId.find("#kramappingbtn").hide(),pageId.find("#empBtnCrt").click(function(){PMSOperation.showtagComp("tag",!1)})}else PMSOperation.moduleDefaultNoData("COMPETENCY")},showtagComp:function(mode,isLoading){var pageId=settingsPage.container;PMSOperation.loadMappingHtml(mode,"COMPETENCY"),PMSOperation.setWeightageValidationKey("comp");var optType=parseInt(ZPeopleComponents.select(pageId.find("#compdesdepsel2")).getValue()),_sliderDiv=$(PMSOperation.sliderObj.sliderDiv);PMSOperation.chooseConponentList=new Array,PMSOperation.selectedConponentList=new Array,PMSOperation.searchTagChooseList=new Array,PMSOperation.searchTagSelectedList=new Array;var nameAry=[ZPI18N.getString("zp.designation"),ZPI18N.getString("zp.department"),ZPI18N.getString("zp.role"),ZPI18N.getString("zp.location")];$(_sliderDiv.find("#desselect").find("label")[0]).html(nameAry[optType]);var allMapped=[];isLoading||$.each(PMSOperation.CompMapDeatils,function(index1,data){allMapped.push(data.mapId)});var dataSource=[];_sliderDiv.find("#desDepRoleselect"),_sliderDiv.find("#dep_list_comp");if(_sliderDiv.find("#depselectcomp").addClass("DN"),dataSource.push({name:ZPI18N.getString("zp.select"),id:"0"}),allMapped.includes(1)||dataSource.push({name:ZPI18N.getString("zp.all"),id:"1"}),0==optType&&PMSOperation.ALL_DESIGNATION.length>0)$.each(PMSOperation.ALL_DESIGNATION,function(index,data){allMapped.includes(data.desId)||dataSource.push({name:ZPeople.decodeTxt(data.desName),id:data.desId})});else if(1==optType&&PMSOperation.ALL_DEPARTMENTS.length>0)$.each(PMSOperation.ALL_DEPARTMENTS,function(index,data){allMapped.includes(data.departmentId)||dataSource.push({name:ZPeople.decodeTxt(data.departmentName),id:data.departmentId})});else if(2==optType&&PMSOperation.ALL_ROLES.length>0)$.each(PMSOperation.ALL_ROLES,function(index,data){allMapped.includes(data.roleId)||dataSource.push({name:ZPeople.decodeTxt(data.roleName),id:data.roleId})});else if(3==optType&&PMSOperation.ALL_LOCATIONS.length>0)$.each(PMSOperation.ALL_LOCATIONS,function(index,data){allMapped.includes(data.locationId)||dataSource.push({name:ZPeople.decodeTxt(data.locationName),id:data.locationId})});else if(4==optType){_sliderDiv.find("#depselectcomp").removeClass("DN"),(dataSource=[]).push({name:ZPI18N.getString("zp.select"),id:"0"}),$.each(PMSOperation.ALL_DESIGNATION,function(index,data){allMapped.includes(data.desId)||dataSource.push({name:ZPeople.decodeTxt(data.desName),id:data.desId})});var depvalDataSource=[];$.each(PMSOperation.ALL_DEPARTMENTS,function(index,data){allMapped.includes(data.departmentId)||depvalDataSource.push({name:ZPeople.decodeTxt(data.departmentName),id:data.departmentId})});var depvalTokenObj={};depvalTokenObj.data=depvalDataSource,depvalTokenObj.contentType="text",depvalTokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},depvalTokenObj.search={by:"name"},depvalTokenObj.allowDuplicateValues=!1,depvalTokenObj.sort=!1,depvalTokenObj.tokens={showRemoveButtonOnHover:!0},depvalTokenObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield("#dep_list_comp",depvalTokenObj)}var compTokenObj={};if(compTokenObj.options=dataSource,compTokenObj.contentType="text",compTokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},compTokenObj.removeExistingDropdown=!0,compTokenObj.search={by:["name"],highlightKeyword:!0},compTokenObj.dropdownList={height:"300px"},ZPeopleComponents.select("#desDepRoleselect",compTokenObj),_sliderDiv.find("#choosekraSearch").val(""),_sliderDiv.find("#selectedkraSearch").val(""),!isLoading){if(void 0!=PMSOperation.allCompetencies&&PMSOperation.allCompetencies.length>0){PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.removeAllElementInTagComponent("csekralst"),PMSOperation.competencyUsrformDtl.WEIGHTAGE&&_sliderDiv.find("#sltKra_wghthd").find("#Competencyweightage b").text("");var csekralst="";$.each(PMSOperation.allCompetencies,function(index,data){if(""!=data&&data.isactive){csekralst+=PMSOperation.tagComponentChooseListElementConstruction(data.compId,data.name),i++;var temp={};temp.compId=data.compId,temp.name=data.name,PMSOperation.chooseConponentList.push(temp)}}),_sliderDiv.find("#csekralst").append(csekralst),PMSOperation.setActionlistenerForTagComponents("choose")}else PMSOperationCommon.setNoData($(PMSOperation.sliderObj.sliderDiv).find("#csekralst"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null);PMSOperationCommon.setNoData($(PMSOperation.sliderObj.sliderDiv).find("#sltkralst"),ZPI18N.getString("zp.nokramapped",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME)),"no_data_found",null,null,null)}},switchcompsubtabs:function(event){var data=event.detail,pageId=settingsPage.container;pageId.find("#competencyMapping").html(""),pageId.find("#competencyMapping").html(ZPeople.LOADING_HTML),PMSOperation.getCompMapping(data.value),PMSOperation.compmappingidx=data.value},getCompMapping:function(type,mode,mapid){var params={mode:"getCompetencyMaping",conreqcsr:csrfToken,optType:type};$.post("/performanceConfig.zp",params,function(resultData){PMSOperation.constructCompetencymapping(resultData.compMapingDetails,mode,mapid)})},editCompetencymapping:function(recId){var pageId=settingsPage.container;if(PMSOperation.showtagComp("edit",!0),PMSOperation.setWeightageValidationKey("comp"),void 0!=recId){PMSOperation.editCompRuleId=recId,PMSOperation.kramapold={};var _sliderDiv=$(PMSOperation.sliderObj.sliderDiv),optType=parseInt(ZPeopleComponents.select(pageId.find("#compdesdepsel2")).getValue()),nameAry=[ZPI18N.getString("zp.designation"),ZPI18N.getString("zp.department"),ZPI18N.getString("zp.role"),ZPI18N.getString("zp.location")];$(_sliderDiv.find("#desselect").find("label")[0]).html(nameAry[optType]),$.each(PMSOperation.CompMapDeatils,function(index,data){if(recId==data.mapId){var options=[],obj={};if(obj.name=data.mapName,obj.id=data.mapId,options.push(obj),ZPeopleComponents.select("#desDepRoleselect").addOption(options),ZPeopleComponents.select("#desDepRoleselect").setValue(data.mapId),ZPeopleComponents.select($("#desDepRoleselect")).setAttributes({disabled:!0}),_sliderDiv.find("#depselectcomp").addClass("DN"),4==optType&&(_sliderDiv.find("#depselectcomp").removeClass("DN"),$.each(PMSOperation.CompMapDeatils,function(index,data){if(recId==data.mapId){_sliderDiv.find("#depselectcomp").removeClass("DN");var idarr=[],selectedArr=[];$.each(data.designationrule,function(index1,data1){selectedArr.push({id:data1.depId,name:ZPeople.decodeTxt(data1.depName)}),idarr.push(data1.depId)});var options={};options.values=selectedArr,ZPeopleComponents.tokenfield("#dep_list_comp").setAttributes(options)}})),Object.keys(data.mappings).length>0){PMSOperation.kramapold=PMSOperation.convertArrayToObject(data.mappings,"compId"),PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.removeAllElementInTagComponent("csekralst");var csekralst="",sltkralst="";$.each(PMSOperation.allCompetencies,function(i,val){var temp,tempcompId=val.compId;void 0!=PMSOperation.kramapold[tempcompId]?((temp={}).name=val.name,temp.compId=tempcompId,temp.weightage=PMSOperation.kramapold[tempcompId].weightage,PMSOperation.selectedConponentList.push(temp),sltkralst+=PMSOperation.tagComponentSelectedlistElementConstruction(tempcompId,val.name,PMSOperation.competencyUsrformDtl.WEIGHTAGE,temp.weightage),csekralst+=PMSOperation.tagComponentChooseListElementConstruction(tempcompId,val.name)):((temp={}).name=val.name,temp.compId=tempcompId,PMSOperation.chooseConponentList.push(temp),csekralst+=PMSOperation.tagComponentChooseListElementConstruction(tempcompId,val.name))}),_sliderDiv.find("#sltkralst").append(sltkralst),PMSOperation.tagComponentSelectedlistAfterConstruction(PMSOperation.selectedConponentList,"edit"),_sliderDiv.find("#csekralst").append(csekralst),PMSOperation.tagComponentChooselistafterConstruction(PMSOperation.selectedConponentList.concat(PMSOperation.chooseConponentList),"edit",PMSOperation.tagComponentKeyNames.comName),PMSOperation.addSelectedinChooselistafterConstruction(PMSOperation.selectedConponentList,"edit",PMSOperation.tagComponentKeyNames.comName),PMSOperation.changeSelectedCount()}}})}PMSOperation.chooseSelectAllReset()},tagCompetency:function(mode){var sliderEle=$(PMSOperation.sliderObj.sliderDiv),mapId=ZPeopleComponents.select($("#desDepRoleselect")).getValue(),optType=parseInt(ZPeopleComponents.select($("#compdesdepsel2")).getValue());if(sliderEle.find("#desDepRoleselect").parent().parent().parent().find(".ztextbox__error").each(function(){$(this).hasClass("ztokenfield")?(ZPeopleComponents.tokenfield($(this).prev()).setAttributes({className:""}),$(this).next().hide()):$(this).hasClass("zselectbox")&&(ZPeopleComponents.select($(this).prev()).setAttributes({className:""}),$(this).next().hide())}),"0"==mapId)return sliderEle.find("#deserr").show(),void ZPeopleComponents.select(sliderEle.find("#desDepRoleselect")).setAttributes({className:"ztextbox__error"});if(4==optType&&(null==(depId=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#dep_list_comp")).getAllValues()))||0==depId.length))return sliderEle.find("#deperrcomp").show(),void ZPeopleComponents.tokenfield(sliderEle.find("#dep_list_comp")).setAttributes({className:"ztextbox__error"});PMSOperation.selectedConponentList.length!=sliderEle.find("#sltkralst li").length&&(PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.tagComponentSelectedlistConstruction(PMSOperation.selectedConponentList,"name","compId","weightage","edit"));var flag=!0,compIds=[],compIdlist=[];if(0==PMSOperation.selectedConponentList.length)return ZPeople.Message.failure(ZPI18N.getString("zp.nokraselected",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME))),!1;var totalWeightage=0;sliderEle.find("#sltkralst li").each(function(){var compid=$(this).attr("id"),weightage=$(this).find("input").val();if(weightage=PMSOperation.competencyUsrformDtl.WEIGHTAGE?"0":weightage.replace("%",""),totalWeightage+=parseFloat(weightage),("-1"==compid||void 0==weightage||""==weightage||weightage>100||weightage<0)&&(flag=!1),-1==compIdlist.indexOf(compid)){compIdlist.push(compid);var compdtl={};compdtl.compId=compid,compdtl.weightage=weightage,compIds.push(compdtl)}}),totalWeightage=parseFloat(totalWeightage).toFixed(2);var varparams={mode:"getRestrictionWeightageValidation",conreqcsr:csrfToken,type:"comp"};if($.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:varparams,success:function(resultData){PMSOperation.RESTRICT_COMPETENCY_WEIGHTAGE=void 0!=resultData.enabled&&resultData.enabled?"1":"0"}}),"0"==PMSOperation.RESTRICT_COMPETENCY_WEIGHTAGE&&totalWeightage>100)ZPeople.Message.failure(ZPI18N.getString("zp.errortagcomponent",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME)));else if(flag){var params={};if((params={mode:"mapCompetencyNew",conreqcsr:csrfToken}).optType=optType,params.mapId=mapId,4==optType){var depId=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#dep_list_comp")).getAllValues());depId=JSON.stringify(depId),params.deplist=depId}var label=[ZPI18N.getString("zp.designation"),ZPI18N.getString("zp.department"),ZPI18N.getString("zp.role"),ZPI18N.getString("zp.location")][optType];4==optType&&(label=ZPI18N.getString("zp.designation")+" & "+ZPI18N.getString("zp.department"));var successmsg="Competency tagged to "+label,tempArr=Object.assign({},PMSOperation.kramapold);if(void 0!=mode&&"edit"==mode){params.submode="editmapcomp",successmsg=ZPI18N.getString("zp.editedsuccess"),PMSOperation.kramapnew={};var editobj=[],addobj=[],delobj=[];sliderEle.find("#sltkralst li").each(function(){var compId=$(this).attr("id"),weightage=$(this).find("input").val();if(weightage=PMSOperation.competencyUsrformDtl.WEIGHTAGE?"0":weightage.replace("%",""),void 0==PMSOperation.kramapold[compId]||PMSOperation.competencyUsrformDtl.WEIGHTAGE||PMSOperation.kramapold[compId].weightage==weightage)if(void 0==PMSOperation.kramapold[compId]){var temp;(temp={}).compId=compId,temp.weightage=weightage,addobj.push(temp)}else void 0==PMSOperation.kramapold[compId]||!PMSOperation.competencyUsrformDtl.WEIGHTAGE&&PMSOperation.kramapold[compId].weightage!=weightage||delete PMSOperation.kramapold[compId];else(temp={}).compId=compId,temp.weightage=weightage,editobj.push(temp),delete PMSOperation.kramapold[compId]}),$.each(PMSOperation.kramapold,function(index,data){var temp={};temp.compId=index,delobj.push(temp)});var paramObj=void 0;if(4==optType)void 0!=(paramObj=PMSOperation.editCompdesignationRule(PMSOperation.editCompRuleId,optType))&&(params.ruleObj=JSON.stringify(paramObj));if(0==editobj.length&&0==addobj.length&&0==delobj.length&&void 0==paramObj)return PMSOperation.sliderObj.close(),PMSOperation.kramapold=Object.assign({},tempArr),!1;if((editobj.length>100||addobj.length>100||delobj.length>100)&&void 0==paramObj)return ZPeople.Message.failure(ZPI18N.getString("zp.kralength",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME))),PMSOperation.kramapold=Object.assign({},tempArr),!1;editobj=JSON.stringify(editobj),addobj=JSON.stringify(addobj),delobj=JSON.stringify(delobj),params.toedit=editobj,params.toadd=addobj,params.todel=delobj}else{if(compIds.length>100)return ZPeople.Message.failure(ZPI18N.getString("zp.kralength",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME))),!1;compIds=JSON.stringify(compIds),params.complist=compIds}sliderEle.find("#sliderSbt").addClass("disabled"),$.post("/performanceConfig.zp",params,function(resultData){sliderEle.find("#sliderSbt").removeClass("disabled"),"success"==resultData.msg?(ZPeople.Message.success(successmsg),jQuery.isEmptyObject(PMSOperation.sliderObj)||PMSOperation.sliderObj.close(),PMSOperation.getCompMapping(optType,"edit",mapId)):void 0!=resultData.msg&&"error"==resultData.msg&&void 0!=resultData.errormsg?"weightageError"==resultData.errormsg?ZPeople.Message.failure(ZPI18N.getString("zp.errortagcomponent",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME))):ZPeople.Message.failure(resultData.errormsg):"PERMISSION_DENIED"===resultData.MSG?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):(ZPeople.Message.success(ZPI18N.getString("zp.sorryservererror")),PMSOperation.sliderObj.close())})}else ZPeople.Message.failure(ZPI18N.getString("zp.krainvalidweightage"))},editCompdesignationRule:function(ruleId,optType){settingsPage.container;var sliderEle=$(PMSOperation.sliderObj.sliderDiv),params={};if(void 0!=ruleId){var depIdlists=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderEle.find("#dep_list_comp")).getAllValues()),ischanged=!1;if($.each(PMSOperation.CompMapDeatils,function(index,data){data.mapId==ruleId&&(data.designationrule.length==depIdlists.length?$.each(data.designationrule,function(i,val){-1==depIdlists.indexOf(val.depId)&&(ischanged=!0)}):ischanged=!0)}),!ischanged)return;var depIds=JSON.stringify(depIdlists);depIds=null==depIdlists?[]:JSON.stringify(depIdlists),params.depIds=depIds,params.ruleId=ruleId}return params},getCompMapping:function(type,mode,mapid){var params={mode:"getCompetencyMaping",conreqcsr:csrfToken,optType:type};$.post("/performanceConfig.zp",params,function(resultData){PMSOperation.constructCompetencymapping(resultData.compMapingDetails,mode,mapid)})},addCompetency:function(mode,compId){var pageId=settingsPage.container,_popEle=$(PMSOperation.kraaddmodal.sliderDiv),kraName=_popEle.find("#comp_name").val(),kraDes=_popEle.find("#comp_desc").val();if(void 0==kraName||""==kraName.trim(""))return _popEle.find("#comp_name").addClass("ztextbox__error"),void _popEle.find("#comp_exist_error").html(ZPI18N.getString("zp.invalidvalue",[PMSSetting.COMPETENCY_DISPLAY_NAME])).show();if(_popEle.find("#comp_name").removeClass("ztextbox__error"),_popEle.find("#comp_exist_error").html("").hide(),kraName.length>300)return _popEle.find("#comp_exist_error").html(ZPI18N.getString("zp.fieldpropertymaxlength",["Competency Name","300 characters"])),void _popEle.find("#comp_desc_error").show();if(_popEle.find("#comp_exist_error").is(":visible")&&_popEle.find("#comp_exist_error").hide(),kraDes.length>5e3)return _popEle.find("#comp_desc").addClass("ztextbox__error"),void _popEle.find("#comp_desc_error").html(ZPI18N.getString("zp.fieldpropertymaxlength",["Competency Description","5000 characters"])).show();_popEle.find("#comp_desc_error").removeClass("ztextbox__error"),_popEle.find("#comp_desc_error").is(":visible")&&_popEle.find("#comp_desc_error").hide();var params={mode:"addCompetency",conreqcsr:csrfToken};params.compName=kraName,params.compDes=kraDes,void 0!=mode&&"editcomp"==mode&&void 0!=compId?params.recId=compId:mode="add";var successmsg=ZPI18N.getString("zp.addsuccessful");"editcomp"==mode&&("#editcompsubmit",successmsg=ZPI18N.getString("zp.editedsuccess")),$.post("/performanceConfig.zp",params,function(resultData){if(void 0!=resultData.msg&&"success"==resultData.msg){if(PMSOperation.kraaddmodal.close(),ZPeople.Message.success(successmsg),PMSOperation.allCompetencies=resultData.comptencies,PMSOperation.allCompetencies.length>0&&1==pageId.find("#competencyMapping #emptPage").length){var _btnName=ZPI18N.getString("zp.tag.module",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME));PMSOperationCommon.setNoData(pageId.find("#competencyMapping"),ZPI18N.getString("zp.pa.norectagged",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.tagcompetencymsg",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME)),_btnName),pageId.find("#kralibrarybtn").show(),pageId.find("#kramappingbtn").hide(),pageId.find("#empBtnCrt").click(function(){PMSOperation.showtagComp("tag",!1)})}if("editcomp"!=mode&&void 0!=PMSOperation.chooseConponentList&&PMSOperation.chooseConponentList.length>0&&!PMSOperation.isLibraryModalOpen){var temp={};temp.compId=resultData.comId,temp.name=resultData.comName;var arr=new Array;arr.push(temp);$("#choosekraSearch").length>0&&$("#choosekraSearch").val().trim();PMSOperation.tagComponentChooselistConstruction(arr,"add",!0),PMSOperation.chooseConponentList.push(temp),PMSOperation.chooseSelectAllReset()}else void 0!=PMSOperation.moduleLibraryslider&&PMSOperation.libraryConstruction("COMPETENCY",resultData.comptencies);if("editcomp"==mode){var optType=parseInt(ZPeopleComponents.select(pageId.find("#compdesdepsel2")).getValue());PMSOperation.getCompMapping(optType)}if(void 0==PMSOperation.moduleLibraryslider&&!PMSOperation.isLibraryModalOpen)return}else"Already exists"==resultData.error?ZPeople.Message.failure(ZPI18N.getString("zp.existingkraname",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME))):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))})},kradelconfrim:function(mode,obj){var valobj,pageId=settingsPage.container,isrule=!1;if("kramap_confirm"==mode){if(void 0==(valobj=$(obj).parent().parent().attr("id"))){isrule=!0,valobj=$(obj).parent().parent().attr("ruleid");var isSingle=$(obj).parent().parent().attr("isSingle");void 0!=isSingle&&"true"==isSingle&&(isrule=!1)}}else valobj=$(obj).parent().parent().parent().data().ldata;if(void 0!=valobj){var id=valobj.kraId;if(void 0!=mode&&"confirm"==mode)(deletePopUp=new DeleteAlertMessage).title=ZPI18N.getString("zp.common.entitydelete",new Array(PMSSetting.KRA_DISPLAY_NAME)),deletePopUp.despcription=ZPI18N.getString("zp.pa.deletelibrecmsg",new Array(PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME)),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){PMSOperation.kradeletion(id)},deletePopUp.show();else if(void 0!=mode&&"kramap_confirm"==mode){var deletePopUp;(deletePopUp=new DeleteAlertMessage).title=ZPI18N.getString("zp.delete")+" "+PMSSetting.KRA_DISPLAY_NAME+" Mapping",deletePopUp.despcription=ZPI18N.getString("zp.deleteKra",new Array(PMSSetting.KRA_DISPLAY_NAME+" "+ZPI18N.getString("zp.rule"))),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){var params,optType=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue()),submode="";-1!=(id=valobj)&&1!=id||(submode="all"),1==isrule&&(submode="multi");var kralist=[];pageId.find("#desmap_"+id).find("li").each(function(){kralist.push($(this).attr("id"))}),kralist=JSON.stringify(kralist),params={mode:"deletekramapping",conreqcsr:csrfToken,recId:id,submode:submode,optType:optType},$.post("/performanceConfig.zp",params,function(resultData){if("success"==resultData.msg){var ruleid=$(obj).closest(".zpl_crd").attr("id");if(ZAlertDialog.close(),$.each(PMSOperation.KraMapDetails,function(index,data){void 0==data||data.ruleId!=ruleid&&data.mapingDetails.ruleId!=ruleid&&id!=data.mapingDetails[0].mapId||PMSOperation.KraMapDetails.splice(index,1)}),$(obj).parent().parent().parent().parent().parent().parent().parent().remove(),ZPeople.Message.success(ZPI18N.getString("zp.deletesuccessful")),0==PMSOperation.KraMapDetails.length)if(PMSOperation.ALL_KRA.length>0){var _btnName=ZPI18N.getString("zp.tag.module",new Array(PMSSetting.KRA_DISPLAY_NAME));PMSOperationCommon.setNoData(pageId.find("#cardview-mapcontent"),ZPI18N.getString("zp.pa.norectagged",new Array(PMSSetting.KRA_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.tagkramsg",new Array(PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME)),_btnName),ZPeopleComponents.isComponent("#kramenuiconimpexpmapping")&&ZPeopleComponents.menu("#kramenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#kramenuiconimpexpmapping").getMenuItemAt("1").attr("id")]),pageId.find("#kralibrarybtn").show(),pageId.find("#kramappingbtn").hide(),pageId.find("#empBtnCrt").click(function(){PMSOperation.tagKra()})}else PMSOperation.moduleDefaultNoData("KRA")}else ZPeople.Message.warning(ZPI18N.getString("zp.sorryservererror"))})},deletePopUp.show()}}},deleteCompetencymapping:function(recId,delMode){var pageId=settingsPage.container,deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.delete")+" "+PMSSetting.COMPETENCY_DISPLAY_NAME+" Mapping",deletePopUp.despcription=ZPI18N.getString("zp.deleteKra",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME+" "+ZPI18N.getString("zp.rule"))),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){var optType=parseInt(ZPeopleComponents.select(pageId.find("#compdesdepsel2")).getValue()),params={mode:"deletecompmapping",recId:recId,conreqcsr:csrfToken,optType:optType};$.post("/performanceConfig.zp",params,function(resultData){if("success"==resultData.msg){if(ZAlertDialog.close(),ZPeople.Message.success(ZPI18N.getString("zp.deletesuccessful")),pageId.find("#compmap_"+recId).remove(),0==pageId.find("#competencyMapping .zpl_crd").length)if(PMSOperation.allCompetencies.length>0){var _btnName=ZPI18N.getString("zp.tag.module",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME));PMSOperationCommon.setNoData(pageId.find("#competencyMapping"),ZPI18N.getString("zp.pa.norectagged",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.tagcompetencymsg",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME)),_btnName),ZPeopleComponents.isComponent("#compmenuiconimpexpmapping")&&ZPeopleComponents.menu("#compmenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#compmenuiconimpexpmapping").getMenuItemAt("1").attr("id")]),pageId.find("#kralibrarybtn").show(),pageId.find("#kramappingbtn").hide(),pageId.find("#empBtnCrt").click(function(){PMSOperation.showtagComp("tag",!1)})}else PMSOperation.moduleDefaultNoData("COMPETENCY");$.each(PMSOperation.CompMapDeatils,function(index,data){void 0!=data&&data.mapId==recId&&PMSOperation.CompMapDeatils.splice(index,1)})}else ZPeople.Message.success(ZPI18N.getString("zp.sorryservererror"))})},deletePopUp.show()},kradeletion:function(recId){var pageId=settingsPage.container,sliderEle=$(PMSOperation.moduleLibraryslider.sliderDiv),params={mode:"deletekra",conreqcsr:csrfToken,recId:recId};$.post("/performanceConfig.zp",params,function(resultData){if("success"==resultData.msg){var kraArrLength=0;if("KRA"==PMSOperation.LIBRARY_MODE){sliderEle.find("#kra_"+recId).remove(),void 0!=resultData.kraDetails&&void 0!=resultData.kraDetails.kraList?(kraArrLength=resultData.kraDetails.kraList.length,PMSOperation.ALL_KRA=resultData.kraDetails.kraList):PMSOperation.ALL_KRA=[],0==PMSOperation.ALL_KRA.length&&PMSOperation.libraryConstruction("KRA",PMSOperation.ALL_KRA);var optType=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue());PMSOperation.getKraMaping(optType)}else sliderEle.find("#userkra_"+recId).remove(),void 0!=resultData.kraDetails&&void 0!=resultData.kraDetails.kraList?(kraArrLength=resultData.kraDetails.kraList.length,PMSOperation.ALL_USER_KRA=resultData.kraDetails.kraList,PMSOperation.USER_KRA_EMP_DETAILS=void 0!=resultData.kraDetails.empList?resultData.kraDetails.empList:{},PMSOperation.USER_KRA_MAPID_DETAILS=void 0!=resultData.kraDetails.kraUserIdList?resultData.kraDetails.kraUserIdList:{}):(PMSOperation.ALL_USER_KRA=[],PMSOperation.USER_KRA_EMP_DETAILS={},PMSOperation.USER_KRA_MAPID_DETAILS={}),0==PMSOperation.ALL_USER_KRA.length&&PMSOperation.libraryConstruction("USER_KRA",PMSOperation.ALL_USER_KRA);ZPeople.Message.success(ZPI18N.getString("zp.deletesuccessful")),$(sliderEle).find("#modulelistcount").text("("+kraArrLength+")"),0!=kraArrLength&&0!=$(PMSOperation.moduleLibraryslider.sliderDiv).find("#librarylist").children().length||($(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider #emptPage").remove(),$(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider #userManagementDivTable").parent().hide(),PMSOperationCommon.setNoData($(PMSOperation.moduleLibraryslider.sliderDiv).find("#cardlibraryslider .zpl_crdcnt"),ZPI18N.getString("zp.pa.nodataadded",new Array(PMSSetting.KRA_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.addkramsg",new Array(PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME)),null,!1))}"failure"==resultData.msg&&ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))})},compdel:function(mode,obj){var id=$(obj).parent().parent().attr("id"),pageId=settingsPage.container;id=id.split("_")[1];var sliderEle=$(PMSOperation.moduleLibraryslider.sliderDiv),deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.common.entitydelete",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME)),deletePopUp.despcription=ZPI18N.getString("zp.pa.deletelibrecmsg",new Array(PMSSetting.COMPETENCY_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME)),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){var params={mode:"deleteCompetency",conreqcsr:csrfToken};params.recId=id,$.post("/performanceConfig.zp",params,function(resultData){if(void 0!=resultData.msg&&"success"==resultData.msg){$(PMSOperation.moduleLibraryslider.sliderDiv).find("#competency_"+id).remove(),ZPeople.Message.success(ZPI18N.getString("zp.deletesuccessful")),PMSOperation.allCompetencies=resultData.competencies,$(sliderEle).find("#modulelistcount").text(resultData.competencies.length),0==PMSOperation.allCompetencies.length?PMSOperation.libraryConstruction("COMPETENCY",PMSOperation.allCompetencies):0==sliderEle.find("#librarylist").find(".zpl_catlst input").length&&PMSOperationCommon.setNoData(sliderEle.find("#librarylist"),null,"no_data_found",null,ZPI18N.getString("zp.norecfound"),null);var optType=parseInt(ZPeopleComponents.select(pageId.find("#compdesdepsel2")).getValue());PMSOperation.getCompMapping(optType)}})},deletePopUp.show()},skilldel:function(mode,obj){var id=$(obj).parent().parent().attr("id"),pageId=settingsPage.container;id=id.split("_")[1];var sliderEle=$(PMSOperation.moduleLibraryslider.sliderDiv),deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.common.entitydelete",new Array(PMSSetting.skilldispName)),deletePopUp.despcription=ZPI18N.getString("zp.pa.deletelibrecmsg",new Array(PMSSetting.skilldispName,PMSSetting.skilldispName)),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){var params={mode:"deleteSkill",conreqcsr:csrfToken};params.skillsId=id,$.post("/performanceConfig.zp",params,function(resultData){if(void 0!=resultData.msg&&"success"==resultData.msg){var sliderDiv=$(PMSOperation.moduleLibraryslider.sliderDiv);if(sliderDiv.find("#skill_"+id).remove(),ZPeople.Message.success(ZPI18N.getString("zp.deleted.successfully.msg",new Array(PMSSetting.skilldispName))),0==sliderDiv.find("#librarylist div").length&&(PMSOperationCommon.setNoData(sliderDiv.find("#librarylist"),ZPI18N.getString("zp.pa.nodataadded",new Array(PMSSetting.SKILLSET_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.addskillmsg",new Array(PMSSetting.SKILLSET_DISPLAY_NAME,PMSSetting.SKILLSET_DISPLAY_NAME)),null),""!=sliderDiv.find("#skillsetsearch").val()&&"no_skills"!=resultData.skillslist[0].msg&&resultData.skillslist.length>0))return PMSOperation.ALL_SKILLS=resultData.skillslist,!1;0!=resultData.skillslist.length&&"no_skills"!=resultData.skillslist[0].msg?PMSOperation.ALL_SKILLS=resultData.skillslist:(PMSOperation.ALL_SKILLS=new Array,PMSOperationCommon.setNoData(pageId.find("#notagdata"),ZPI18N.getString("zp.pa.nodataadded",new Array(PMSSetting.skilldispName)),"no_data_found",null,ZPI18N.getString("zp.pa.addskillmsg",new Array(PMSSetting.skilldispName,PMSSetting.skilldispName)),ZPI18N.getString("zp.add")+" "+PMSSetting.skilldispName),PMSOperation.skillNoData()),$(sliderEle).find("#modulelistcount").text(PMSOperation.ALL_SKILLS.length),0==PMSOperation.ALL_SKILLS.length&&PMSOperation.libraryConstruction("SKILL",PMSOperation.ALL_SKILLS)}else"tagged"===resultData.msg?ZPeople.Message.warning(ZPI18N.getString("zp.skillstagged",new Array(PMSSetting.skilldispName,PMSSetting.skilldispName))):ZPeople.Message.failure(resultData.msg)})},deletePopUp.show()},showeditkra:function(kraId,obj){PMSOperation.addKRAPopup(null,"KRA",kraId);var popEle=$(PMSOperation.kraaddmodal.sliderDiv);$.each(PMSOperation.ALL_KRA,function(index,data){kraId==data.kraId&&(popEle.find("#kra_name").val(ZPeople.decodeTxt(data.kraName)),popEle.find("#kra_desc").val(ZPeople.decodeTxt(data.kraDes.replace(/<br[^>]*>/gi,"\n"))),"null"!=data.minRange&&"null"!=data.maxRange&&(popEle.find("#minweightage").val(data.minRange),popEle.find("#maxweightage").val(data.maxRange)))})},showedituserkra:function(kraId,obj){PMSOperation.addKRAPopup(null,"USER_KRA",kraId);var popEle=$(PMSOperation.kraaddmodal.sliderDiv);$.each(PMSOperation.ALL_USER_KRA,function(index,data){kraId==data.kraId&&(popEle.find("#kra_name").val(ZPeople.decodeTxt(data.kraName)),popEle.find("#kra_desc").val(ZPeople.decodeTxt(data.kraDes.replace(/<br[^>]*>/gi,"\n"))),"null"!=data.minRange&&"null"!=data.maxRange&&(popEle.find("#minweightage").val(data.minRange),popEle.find("#maxweightage").val(data.maxRange)))})},showeditcompetency:function(compId,obj){PMSOperation.addKRAPopup(null,"COMPETENCY",compId);var popEle=$(PMSOperation.kraaddmodal.sliderDiv);$.each(PMSOperation.allCompetencies,function(index,data){compId==data.compId&&(popEle.find("#comp_name").val(ZPeople.decodeTxt(data.name)),popEle.find("#comp_desc").val(ZPeople.decodeTxt(data.desc.replace(/<br[^>]*>/gi,"\n"))))})},showeditskill:function(skillid,obj){PMSOperation.addKRAPopup(null,"SKILL",skillid);var popEle=$(PMSOperation.kraaddmodal.sliderDiv);$.each(PMSOperation.ALL_SKILLS,function(index,data){skillid==data.skillsId&&(popEle.find("#skillSearch").val(ZPeople.decodeTxt(data.skillsName)),popEle.find("#skill_desc").val(ZPeople.decodeTxt(data.skillsDesc.replace(/<br[^>]*>/gi,"\n"))))})},showChangetoCommonKra:function(id){var infoPopUp=new InfoAlertMessage;infoPopUp.title=ZPI18N.getString("zp.convertkraconfirmmsg",new Array(PMSSetting.KRA_DISPLAY_NAME)),infoPopUp.despcription=ZPI18N.getString("zp.convertkramsg",new Array(PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME)),infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.noButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){PMSOperation.changeToCommonKra(id)},infoPopUp.show()},changeToCommonKra:function(id){var sliderEle=$(PMSOperation.moduleLibraryslider.sliderDiv),kraArr=[];if(void 0!=id?kraArr.push(id):sliderEle.find("#librarylist input:checked").each(function(){var checkid=$(this).parent().parent().parent().attr("id");kraArr.push(checkid.split("_")[1])}),kraArr.length>0){var kraId=JSON.stringify(kraArr);$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"convertToCommonKra",kraId:kraId,conreqcsr:csrfToken},success:function(resultData){"success"==resultData.msg?(void 0!=resultData.kraDetails&&void 0!=resultData.kraDetails.kraList?PMSOperation.ALL_KRA=resultData.kraDetails.kraList:PMSOperation.ALL_KRA=[],void 0!=resultData.userKraDetails&&void 0!=resultData.userKraDetails.kraList?(PMSOperation.ALL_USER_KRA=resultData.userKraDetails.kraList,PMSOperation.USER_KRA_EMP_DETAILS=void 0!=resultData.userKraDetails.empList?resultData.userKraDetails.empList:{},PMSOperation.USER_KRA_MAPID_DETAILS=void 0!=resultData.userKraDetails.kraUserIdList?resultData.userKraDetails.kraUserIdList:{}):(PMSOperation.ALL_USER_KRA=[],PMSOperation.USER_KRA_EMP_DETAILS={},PMSOperation.USER_KRA_MAPID_DETAILS={}),0==PMSOperation.ALL_USER_KRA.length?PMSOperationCommon.setNoData(sliderEle.find("#librarylist"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null):PMSOperation.libraryConstruction("USER_KRA",PMSOperation.ALL_USER_KRA),resultData.convertedKraList.length==kraArr.length?ZPeople.Message.success(ZPI18N.getString("zp.convertkrasuccessmsg",new Array(PMSSetting.KRA_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME))):ZPeople.Message.success("Some KRA changed as a common KRA, Pending KRA cannot be changed as a common KRA")):"failure"==resultData.msg?ZPeople.Message.warning("Pending KRA cannot be changed as a common KRA"):"permission_denied"==resultData.msg&&ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied"))}})}},showUserKraForm:function(kraUserId){AppraisalConfig.formUtil.getformDetails("kraUserform");var formData=AppraisalConfig.formUtil.kraUsrformDtl,params={formId:formData.formId,tableName:formData.formTableName,recordId:kraUserId,formMode:"VIEW",callback:PMSOperation.userKraFormCallback,isEmbed:!0};ZP5Form.load(params)},userKraFormCallback:function(){var params={mode:"getUserKra",conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){void 0!=resultData.kraList?(PMSOperation.ALL_USER_KRA=resultData.kraList,PMSOperation.USER_KRA_EMP_DETAILS=void 0!=resultData.empList?resultData.empList:{},PMSOperation.USER_KRA_MAPID_DETAILS=void 0!=resultData.kraUserIdList?resultData.kraUserIdList:{}):(PMSOperation.ALL_USER_KRA=[],PMSOperation.USER_KRA_EMP_DETAILS={},PMSOperation.USER_KRA_MAPID_DETAILS={}),PMSOperation.libraryConstruction("USER_KRA",PMSOperation.ALL_USER_KRA)})},skillsetSettingInit:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){PMSOperation.destoryComponentObj();var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!1),pageId.html(""),$.ajax({type:"POST",async:!0,url:"/performance/view/skillsetOperationSettings",data:{conreqcsr:csrfToken},success:function(resultData){PMSOperation.getformDetails("userSkillMap"),pageId.append(resultData),"true"==PMSOperation.isSkillShow&&(PMSOperation.tagComponentKeyNames={},PMSOperation.tagComponentKeyNames.NameKey="skillsName",PMSOperation.tagComponentKeyNames.IdKey="skillsId",PMSOperation.tagComponentKeyNames.weightageKey="skillSetWeight",PMSOperation.tagComponentKeyNames.comName="skill",PMSOperation.tagComponentKeyNames.descKey="skillsDesc",PMSOperation.skillsetConst.domainsIndex=1,PMSOperation.skillsetConst.designationsIndex=1,PMSOperation.skillsetConst.departmentIndex=1,PMSOperation.skillsetConst.desDepIndex=1,delete PMSOperation.skillsetConst.domaintriggered,delete PMSOperation.skillsetConst.destriggered,delete PMSOperation.skillsetConst.deptriggered,delete PMSOperation.skillsetConst.desDeptriggered,PMSOperation.getSkillsetList(),null!=PMSOperation.ALL_DESIGNATION&&null!=PMSOperation.ALL_DEPARTMENT||$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getroles_designation",type:"DES",conreqcsr:csrfToken},success:function(data){PMSOperation.ALL_DESIGNATION=data.designations,PMSOperation.ALL_DEPARTMENT=data.departmentList}}))}})}},skillsetMapMenu:function(event){settingsPage.container;var iconClass=event.detail.iconClass;"PI_imprt"==iconClass?(PMSImport.isModuleBasedImport=!0,PMSImport.isMethodBasedImport=!1,ZP5Import.init(ZP5Import.HANDLER_MODE.PAMETHODS)):"PI_exprt"==iconClass&&("#operations/performance/kra"==Layout.Page.hash?PMSCommon.Export.moduleType=1:"#operations/performance/competency"==Layout.Page.hash?PMSCommon.Export.moduleType=2:"#operations/performance/skillset"==Layout.Page.hash&&(PMSCommon.Export.moduleType=0),PMSCommon.Export.showExportPopup(PMSCommon.Export.exportModuleMapping))},getSkillsetList:function(mode){var pageId=settingsPage.container;if(!ZPeopleComponents.isComponent("#skillmenuiconimpexpmapping")){var mapMenu=ZPeopleComponents.menu(pageId.find("#skillmenuiconimpexpmapping"),{forElement:pageId.find("#skillmappingimportexpbtn"),className:"",itemclick:e=>{PMSOperation.skillsetMapMenu(e)}});pageId.find("#skillmappingimportexpbtn").off("click").on("click",function(ev){mapMenu.show()})}PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE?pageId.find("#skillweightagediv").text(""):pageId.find("#skillweightagediv").show(),PMSOperation.constructSkillSet(),pageId.find("#domainMapping").parent().append(ZPeople.LOADING_HTML);var opttype=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue(),params={mode:"getskillSet",conreqcsr:csrfToken};if("editload"!=mode){var params2={mode:"fetchSkillOnload",conreqcsr:csrfToken};$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params2,success:function(resultData){PMSOperation.designationArray=[],PMSOperation.departmentArray=[],PMSOperation.mappeddesignationArray=[],PMSOperation.mappeddepartmentArray=[],PMSOperation.mappeddesDeptArray=[],PMSOperation.mappeddesignationArray=resultData.skillmappeddes,PMSOperation.mappeddepartmentArray=resultData.skillmappeddep,PMSOperation.mappeddesDeptArray=resultData.skillmappedrule,$.each(resultData.designation,function(index,data){var desigObj={};desigObj.id=data.desId,desigObj.name=ZPeople.escapeHtml(ZPeople.decodeTxt(data.desName)),PMSOperation.designationArray.push(desigObj)}),$.each(resultData.departmentList,function(index,data){var depObj={};depObj.id=data.departmentId,depObj.name=ZPeople.escapeHtml(ZPeople.decodeTxt(data.departmentName)),PMSOperation.departmentArray.push(depObj)}),"no_skills"==resultData.skills[0].msg?PMSOperation.ALL_SKILLS=[]:PMSOperation.ALL_SKILLS=resultData.skills}})}setTimeout(function(){"domain"==opttype?(params.isDomainselected=!0,params.sIndex=PMSOperation.skillsetConst.domainsIndex,PMSOperation.skillsetConst.domaintriggered):"designation"==opttype?(params.isDomainselected=!1,params.sIndex=PMSOperation.skillsetConst.designationsIndex,params.modtype=1,PMSOperation.skillsetConst.destriggered):"department"==opttype?(params.isDepselected=!1,params.sIndex=PMSOperation.skillsetConst.departmentIndex,params.modtype=2,PMSOperation.skillsetConst.deptriggered):"desDep"==opttype&&(params.isDepselected=!1,params.sIndex=PMSOperation.skillsetConst.desDepIndex,params.modtype=3,PMSOperation.skillsetConst.desDeptriggered),$.post("/performanceConfig.zp",params,function(resultData){pageId.find("#zp_page_loading").remove(),PMSOperation.skillSetListView(resultData,mode)})},200)},skillSetListView:function(resultData,isAddEdit,isScroll){var scrollMode,pageId=settingsPage.container;resultData.domain.length>0&&resultData.domain[0].hasOwnProperty("msg")&&(resultData.domain=[],PMSOperation.skillsetConst.domainsIndex=1),resultData.designation.length>0&&resultData.designation[0].hasOwnProperty("msg")&&(resultData.designation=[],PMSOperation.skillsetConst.designationsIndex=1),resultData.department.length>0&&resultData.department[0].hasOwnProperty("msg")&&(resultData.department=[],PMSOperation.skillsetConst.departmentIndex=1),resultData.desDep.length>0&&resultData.desDep[0].hasOwnProperty("msg")&&(resultData.desDep=[],PMSOperation.skillsetConst.desDepIndex=1),resultData.domain.length>0&&pageId.find("#notagdata").hide(),void 0==PMSOperation.skillsetMappeddata.designation&&(PMSOperation.skillsetMappeddata.designation=[]),void 0==PMSOperation.skillsetMappeddata.department&&(PMSOperation.skillsetMappeddata.department=[]),void 0==PMSOperation.skillsetMappeddata.desDep&&(PMSOperation.skillsetMappeddata.desDep=[]);let isScrollExist=!1;if(resultData.designation.length>0&&(PMSOperation.skillsetConst.designationsIndex+=resultData.designation.length,isScrollExist=resultData.designation.length===PMSOperation.skillRecScrollLimit,$.each(resultData.designation,function(index,data){void 0==(index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.designation,"designationId",data.designationId))?PMSOperation.skillsetMappeddata.designation.push(data):PMSOperation.skillsetMappeddata.designation[index]=data})),resultData.department.length>0&&(PMSOperation.skillsetConst.departmentIndex+=resultData.department.length,isScrollExist=resultData.department.length===PMSOperation.skillRecScrollLimit,$.each(resultData.department,function(index,data){void 0==(index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.department,"depId",data.depId))?PMSOperation.skillsetMappeddata.department.push(data):PMSOperation.skillsetMappeddata.department[index]=data})),resultData.desDep.length>0&&(PMSOperation.skillsetConst.desDepIndex+=resultData.desDep.length,isScrollExist=resultData.desDep.length===PMSOperation.skillRecScrollLimit,$.each(resultData.desDep,function(index,data){void 0==(index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.desDep,"ruleId",data.ruleId))?PMSOperation.skillsetMappeddata.desDep.push(data):PMSOperation.skillsetMappeddata.desDep[index]=data})),void 0==PMSOperation.skillsetMappeddata.domain&&(PMSOperation.skillsetMappeddata.domain=[]),resultData.domain.length>0&&(PMSOperation.skillsetConst.domainsIndex+=resultData.domain.length,isScrollExist=resultData.domain.length===PMSOperation.skillRecScrollLimit,$.each(resultData.domain,function(index,data){void 0==(index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.domain,"domainId",data.domainId))?PMSOperation.skillsetMappeddata.domain.push(data):PMSOperation.skillsetMappeddata.domain[index]=data})),ZPeopleComponents.isComponent("#skillmenuiconimpexpmapping")&&ZPeopleComponents.menu("#skillmenuiconimpexpmapping").showMenuItems(["#"+ZPeopleComponents.menu("#skillmenuiconimpexpmapping").getMenuItemAt("1").attr("id")]),void 0!==resultData&&null!==resultData){var isNoData=!1;if(isScroll||(isNoData=PMSOperation.skillsetMappingNoData(resultData)),isNoData||(pageId.find("#kramappingbtn").show(),pageId.find("#kralibrarybtn").show(),$.each(resultData.designation,function(index,data){var isExist=pageId.find("#skilldesignation_"+data.designationId),row='<div class="zpl_crd" id="skilldesignation_'+data.designationId+'"> <div class="zpl_crdcnt"> <div class="zpl_secn"> <div> <ul class="zpl_paperent">';row+="<li><div><h5>"+data.designationName+"</h5>",row+='</div><div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+"\" onclick=\"PMSOperation.editskillSetMapping('edit', '"+data.designationId+'\');"></i> <i data-popup-open="" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.deleteDesignationTags(\''+data.designationId+"');\"></i> </div>",row+="</li>",$.each(data.skillset,function(index1,skillsdata){row+='<li class="zpl_pavlu" skillids='+skillsdata.skillsId+">",PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE||(row+="<b>"+skillsdata.skillSetWeight+"%</b>"),row+="<span>"+skillsdata.skillsName+"</span> </li>"}),row+="</ul></div></div></div></div>",row=$(row),isExist.length>0?isExist.replaceWith($(row).data(data)):pageId.find("#designationMapping").append($(row).data(data)),"designationMapping",scrollMode="skillDesScrollView"}),$.each(resultData.department,function(index,data){var isExist=pageId.find("#skilldepartment_"+data.depId),row='<div class="zpl_crd" id="skilldepartment_'+data.depId+'"> <div class="zpl_crdcnt"> <div class="zpl_secn"> <div> <ul class="zpl_paperent">';row+="<li><div><h5>"+data.depName+"</h5>",row+='</div><div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+"\" onclick=\"PMSOperation.editskillSetMapping('edit', '"+data.depId+'\');"></i> <i data-popup-open="" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.deleteDesignationTags(\''+data.depId+"');\"></i> </div>",row+="</li>",$.each(data.skillset,function(index1,skillsdata){row+='<li class="zpl_pavlu" skillids='+skillsdata.skillsId+">",PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE||(row+="<b>"+skillsdata.skillSetWeight+"%</b>"),row+="<span>"+skillsdata.skillsName+"</span> </li>"}),row+="</ul></div></div></div></div>",row=$(row),isExist.length>0?isExist.replaceWith($(row).data(data)):pageId.find("#departmentMapping").append($(row).data(data)),"departmentMapping",scrollMode="skillDepScrollView"}),$.each(resultData.desDep,function(index,data){var isExist=pageId.find("#skilldesDep_"+data.ruleId),row='<div class="zpl_crd" id="skilldesDep_'+data.ruleId+'"> <div class="zpl_crdcnt"> <div class="zpl_secn"> <div> <ul class="zpl_paperent">';if(row+='<li ruleid="'+data.ruleId+'"><div><h5>'+data.designationName+"</h5>",void 0!=data.depList){row+='<span class="zpl_dots"></span>';var desrule="",i=0;if($.each(data.depList,function(index1,data1){i<PMSOperation.DEF_METHODS_SIZE&&(desrule+=0==i?data1.depName:",&nbsp;"+data1.depName),i++}),data.depList.length>PMSOperation.DEF_METHODS_SIZE){var blncCnt=data.depList.length-PMSOperation.DEF_METHODS_SIZE;row+="<em>"+desrule+',&nbsp;</em><div class="zpl_tg" title="'+ZPI18N.getString("zp.more")+'"><a id="showMore_'+data.ruleId+'" mapid="'+data.ruleId+'">+'+blncCnt+"</a></div>"}else row+="<em>"+desrule+"</em>"}row+='</div><div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+"\" onclick=\"PMSOperation.editskillSetMapping('edit', '"+data.ruleId+'\');" ></i> <i data-popup-open="" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.deleteDesignationTags(\''+data.ruleId+"');\"></i> </div>",row+="</li>",$.each(data.skillset,function(index1,skillsdata){row+='<li class="zpl_pavlu"  skillids='+skillsdata.skillsId+">",PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE||(row+="<b>"+skillsdata.skillSetWeight+"%</b>"),row+="<span>"+skillsdata.skillsName+"</span> </li>"}),row+="</ul></div></div></div></div>",row=$(row),isExist.length>0?isExist.replaceWith($(row).data(data)):pageId.find("#desDepMapping").append($(row).data(data)),"desDepMapping",scrollMode="skillDesDepScrollView"}),pageId.find("[id^=showMore_]").unbind(),pageId.find("[id^=showMore_]").on("click",event=>{PMSOperation.showMorePopOver(event,"SKILL")}),$.each(resultData.domain,function(index,skillsetdata){var isExist=pageId.find("#skilldomain_"+skillsetdata.domainId),row='<div class="zpl_crd" id="skilldomain_'+skillsetdata.domainId+'"> <div class="zpl_crdcnt"> <div class="zpl_secn"> <div> <ul class="zpl_paperent">';row+="<li><div><h5>"+skillsetdata.domainName+"</h5>",row+='</div><div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+"\" onclick=\"PMSOperation.editskillSetMapping('edit', '"+skillsetdata.domainId+'\');" ></i> <i data-popup-open="" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.deleteskillsetDomain(\''+skillsetdata.domainId+"');\" ></i> </div>",row+="</li>",$.each(skillsetdata.skillset,function(index1,data){row+='<li class="zpl_pavlu" skillids='+data.skillsId+">",PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE||(row+="<b>"+data.skillSetWeight+"%</b>"),row+="<span>"+data.skillsName+"</span> </li>"}),row+="</ul></div></div></div></div>",row=$(row),isExist.length>0?isExist.replaceWith($(row).data(skillsetdata)):pageId.find("#domainMapping").append($(row).data(skillsetdata)),"domainMapping",scrollMode="skillDomainScrollView"})),void 0!==settingsPage.fireScrollObj[scrollMode]&&(settingsPage.fireScrollObj[scrollMode].reset(),delete settingsPage.fireScrollObj[scrollMode]),isScrollExist)new FireScrollBack(PMSOperation.skillSetMappingListView,pageId,scrollMode)}else PMSOperationCommon.setNoData(pageId.find("#notagdata"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null)},skillsetMappingNoData:function(resultData){var pageId=settingsPage.container,isNoData=!1,opttype=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue(),_btnName=PMSOperation.ALL_SKILLS.length>0?ZPI18N.getString("zp.tag.module",new Array(PMSSetting.skilldispName)):ZPI18N.getString("zp.add")+" "+PMSSetting.skilldispName,noDataTitleMsg=PMSOperation.ALL_SKILLS.length>0?ZPI18N.getString("zp.pa.norectagged",new Array(PMSSetting.skilldispName)):ZPI18N.getString("zp.pa.nodataadded",new Array(PMSSetting.skilldispName)),noDataDescMsg=PMSOperation.ALL_SKILLS.length>0?ZPI18N.getString("zp.pa.tagskillmsg",new Array(PMSSetting.skilldispName,PMSSetting.skilldispName,PMSSetting.skilldispName)):ZPI18N.getString("zp.pa.addskillmsg",new Array(PMSSetting.skilldispName,PMSSetting.skilldispName));return"domain"==opttype&&0==resultData.domain.length?(PMSOperation.skillsetConst.domaintriggered=!0,pageId.find("#domainMapping,#designationMapping,#departmentMapping","#desDepMapping").hide(),PMSOperationCommon.setNoData(pageId.find("#notagdata"),noDataTitleMsg,"no_data_found",null,noDataDescMsg,_btnName),PMSOperation.skillNoData(resultData.domain.length),isNoData=!0,ZPeopleComponents.isComponent("#skillmenuiconimpexpmapping")&&ZPeopleComponents.menu("#skillmenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#skillmenuiconimpexpmapping").getMenuItemAt("1").attr("id")])):"designation"==opttype&&0==resultData.designation.length?(PMSOperation.skillsetConst.destriggered=!0,pageId.find("#domainMapping,#designationMapping,#departmentMapping","#desDepMapping").hide(),PMSOperationCommon.setNoData(pageId.find("#notagdata"),noDataTitleMsg,"no_data_found",null,noDataDescMsg,_btnName),PMSOperation.skillNoData(resultData.designation.length),isNoData=!0,ZPeopleComponents.isComponent("#skillmenuiconimpexpmapping")&&ZPeopleComponents.menu("#skillmenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#skillmenuiconimpexpmapping").getMenuItemAt("1").attr("id")])):"department"==opttype&&0==resultData.department.length?(PMSOperation.skillsetConst.deptriggered=!0,pageId.find("#domainMapping,#designationMapping,#departmentMapping","#desDepMapping").hide(),PMSOperationCommon.setNoData(pageId.find("#notagdata"),noDataTitleMsg,"no_data_found",null,noDataDescMsg,_btnName),PMSOperation.skillNoData(resultData.department.length),isNoData=!0,ZPeopleComponents.isComponent("#skillmenuiconimpexpmapping")&&ZPeopleComponents.menu("#skillmenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#skillmenuiconimpexpmapping").getMenuItemAt("1").attr("id")])):"desDep"==opttype&&0==resultData.desDep.length&&(PMSOperation.skillsetConst.desDeptriggered=!0,pageId.find("#domainMapping,#designationMapping,#departmentMapping,#desDepMapping").hide(),PMSOperationCommon.setNoData(pageId.find("#notagdata"),noDataTitleMsg,"no_data_found",null,noDataDescMsg,_btnName),PMSOperation.skillNoData(resultData.desDep.length),isNoData=!0,ZPeopleComponents.isComponent("#skillmenuiconimpexpmapping")&&ZPeopleComponents.menu("#skillmenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#skillmenuiconimpexpmapping").getMenuItemAt("1").attr("id")])),isNoData},editskillSetMapping:function(mode,recId){var pageId=settingsPage.container;PMSOperation.loadMappingHtml("edit","SKILL"),PMSOperation.setWeightageValidationKey("skill"),PMSOperation.editSkillRuleId=recId,PMSOperation.getformDetails("userSkillMap"),PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE?pageId.find("#skillweightagediv").text(""):pageId.find("#skillweightagediv").show();var _sliderDiv=$(PMSOperation.sliderObj.sliderDiv);PMSOperation.tagArray={},PMSOperation.chooseConponentList=new Array,PMSOperation.selectedConponentList=new Array,PMSOperation.searchTagChooseList=new Array,PMSOperation.searchTagSelectedList=new Array,pageId.find("#choosekraSearch").val(""),pageId.find("#selectedkraSearch").val(""),pageId.find("#sltKra_wghthd").show(),null!=PMSOperation.ALL_DESIGNATION&&null!=PMSOperation.ALL_DEPARTMENT||$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getroles_designation",type:"DES",conreqcsr:csrfToken},success:function(data){PMSOperation.ALL_DESIGNATION=data.designations}});var opttype=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue(),kramapingAry=new Array;if("domain"==opttype){var index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.domain,"domainId",recId);kramapingAry=PMSOperation.skillsetMappeddata.domain[index].skillset,_sliderDiv.find("#domainSearch").val(ZPeople.decodeTxt(PMSOperation.skillsetMappeddata.domain[index].domainName)),_sliderDiv.find("#domainSearch").focus(),PMSOperation.DOMAINID=recId,_sliderDiv.find("#designationselect").hide(),_sliderDiv.find("#departmentselect").hide(),_sliderDiv.find("#desDepartmentselect").hide(),_sliderDiv.find("#desselect").hide(),_sliderDiv.find("#domainselect").show()}else if("designation"==opttype){_sliderDiv.find("#domainselect").hide(),_sliderDiv.find("#departmentselect").hide(),_sliderDiv.find("#desDepartmentselect").hide(),_sliderDiv.find("#desselect").hide(),_sliderDiv.find("#designationselect").show();_sliderDiv.find("#desDepRoleselect"),index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.designation,"designationId",recId);kramapingAry=PMSOperation.skillsetMappeddata.designation[index].skillset,PMSOperation.DESIGNATIONID=recId,(dataSource=[]).push({id:"1",name:ZPI18N.getString("zp.select")}),$.each(PMSOperation.ALL_DESIGNATION,function(key,value){dataSource.push({id:value.desId,name:ZPeople.decodeTxt(value.desName)})});var idarr=[{id:recId,name:PMSOperation.skillsetMappeddata.designation[index].designationName}],depRolesTokenObj={};depRolesTokenObj.options=dataSource,depRolesTokenObj.contentType="text",depRolesTokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},depRolesTokenObj.removeExistingDropdown=!0,depRolesTokenObj.search={by:["name"],highlightKeyword:!0},depRolesTokenObj.disabled=!0,depRolesTokenObj.value=idarr,depRolesTokenObj.dropdownList={height:"300px"},ZPeopleComponents.select("#desDepRoleselect",depRolesTokenObj)}else if("department"==opttype){_sliderDiv.find("#domainselect").hide(),_sliderDiv.find("#designationselect").hide(),_sliderDiv.find("#desDepartmentselect").hide(),_sliderDiv.find("#desselect").hide(),_sliderDiv.find("#departmentselect").show();_sliderDiv.find("#depselect"),index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.department,"depId",recId);kramapingAry=PMSOperation.skillsetMappeddata.department[index].skillset,PMSOperation.DEPARTMENTID=recId;var dataSource=[];$.each(PMSOperation.ALL_DEPARTMENT,function(key,value){dataSource.push({id:value.departmentId,name:ZPeople.decodeTxt(value.departmentName)})});idarr=[{id:recId,name:PMSOperation.skillsetMappeddata.department[index].depName}];var depTokenObj={};depTokenObj.options=dataSource,depTokenObj.contentType="text",depTokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},depTokenObj.value=idarr,depTokenObj.removeExistingDropdown=!0,depTokenObj.search={by:["name"],highlightKeyword:!0},depTokenObj.disabled=!0,depTokenObj.dropdownList={height:"300px"},ZPeopleComponents.select("#depselect",depTokenObj)}else if("desDep"==opttype){_sliderDiv.find("#domainselect").hide(),_sliderDiv.find("#designationselect").hide(),_sliderDiv.find("#departmentselect").hide(),_sliderDiv.find("#desDepartmentselect").show(),_sliderDiv.find("#desselect").show(),PMSOperation.RULEID=recId;_sliderDiv.find("#desDepselect"),index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.desDep,"ruleId",recId);kramapingAry=PMSOperation.skillsetMappeddata.desDep[index].skillset;dataSource=[];$.each(PMSOperation.ALL_DESIGNATION,function(key,value){dataSource.push({id:value.desId,name:ZPeople.decodeTxt(value.desName)})});var slecArr=[{id:PMSOperation.skillsetMappeddata.desDep[index].designationId,name:PMSOperation.skillsetMappeddata.desDep[index].designationName}],desSelectTokenObj={};desSelectTokenObj.options=dataSource,desSelectTokenObj.contentType="text",desSelectTokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},desSelectTokenObj.removeExistingDropdown=!0,desSelectTokenObj.search={by:["name"],highlightKeyword:!0},desSelectTokenObj.disabled=!0,desSelectTokenObj.value=slecArr,desSelectTokenObj.dropdownList={height:"300px"},ZPeopleComponents.select($(PMSOperation.sliderObj.sliderDiv).find("#des_list"),desSelectTokenObj);var dataSource1=[];$.each(PMSOperation.ALL_DEPARTMENT,function(key,value){dataSource1.push({id:value.departmentId,name:ZPeople.decodeTxt(value.departmentName)})});idarr=[];$.each(PMSOperation.skillsetMappeddata.desDep[index].depList,function(index,data){idarr.push({id:data.depId,name:ZPeople.decodeTxt(data.depName)})});var _destokenObj={};_destokenObj.data=dataSource1,_destokenObj.contentType="text",_destokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_destokenObj.search={by:"name"},_destokenObj.allowDuplicateValues=!1,_destokenObj.removeExistingDropdown=!0,_destokenObj.tokens={showRemoveButtonOnHover:!0},_destokenObj.values=idarr,_destokenObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield($(PMSOperation.sliderObj.sliderDiv).find("#desDepselect"),_destokenObj)}if(Object.keys(kramapingAry).length>0){PMSOperation.kramapold=PMSOperation.convertArrayToObject(kramapingAry,"skillsId"),PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.removeAllElementInTagComponent("csekralst");var csekralst="",sltkralst="";if($.each(PMSOperation.ALL_SKILLS,function(i,val){var temp,tempkraId=val.skillsId;void 0!=PMSOperation.kramapold[tempkraId]?((temp={}).skillsName=val.skillsName,temp.skillsId=tempkraId,temp.skillSetWeight=PMSOperation.kramapold[tempkraId].skillSetWeight,PMSOperation.selectedConponentList.push(temp),sltkralst+=PMSOperation.tagComponentSelectedlistElementConstruction(tempkraId,val.skillsName,PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE,temp.skillSetWeight),csekralst+=PMSOperation.tagComponentChooseListElementConstruction(tempkraId,val.skillsName,!0)):((temp={}).skillsName=val.skillsName,temp.skillsId=tempkraId,PMSOperation.chooseConponentList.push(temp),csekralst+=PMSOperation.tagComponentChooseListElementConstruction(tempkraId,val.skillsName))}),_sliderDiv.find("#sltkralst").append(sltkralst),PMSOperation.tagComponentSelectedlistAfterConstruction(PMSOperation.selectedConponentList,"edit"),_sliderDiv.find("#csekralst").append(csekralst),PMSOperation.tagComponentChooselistafterConstruction(PMSOperation.selectedConponentList.concat(PMSOperation.chooseConponentList),"edit",PMSOperation.tagComponentKeyNames.comName),PMSOperation.selectedConponentList.length>0){var txt=ZPI18N.getString("zp.numberof")+" "+PMSSetting.skilldispName+" "+ZPI18N.getString("zp.cap.selected")+' : <em style="margin-left: 2px;">'+PMSOperation.selectedConponentList.length+"</em>";_sliderDiv.find("#selectedCnt").html(txt),_sliderDiv.find("#selectedCnt").removeClass("DN")}}PMSOperation.chooseSelectAllReset()},deleteDesignationTags:function(mapId){var pageId=settingsPage.container,deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.delete")+" "+PMSSetting.skilldispName+" Mapping",deletePopUp.despcription=ZPI18N.getString("zp.deleteKra",new Array(PMSSetting.skilldispName+" "+ZPI18N.getString("zp.rule"))),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){var opttype=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue();"designation"==opttype?optType=1:"department"==opttype?optType=2:"desDep"==opttype&&(optType=3);var params={mode:"deleteDesignationskillsTag",mapId:mapId,type:optType,conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){if("success"!=resultData.msg)ZPeople.Message.failure(resultData.msg);else if(ZAlertDialog.close(),1==optType){var index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.designation,"designationId",mapId);PMSOperation.skillsetMappeddata.designation.splice(index,1),PMSOperation.mappeddesignationArray.splice(PMSOperation.mappeddesignationArray.indexOf(mapId),1),PMSOperation.skillsetConst.designationsIndex--,pageId.find("#skilldesignation_"+mapId).fadeOut(function(){1===$("#designationMapping .zpl_crd").length&&PMSOperation.skillsetMappingNoData(PMSOperation.skillsetMappeddata),$(this).remove()}),ZPeople.Message.success(ZPI18N.getString("zp.skilltagdeletemsg",[ZPI18N.getString("zp.designation")])),Layout.Page.container.find("#designationMapping .zpl_crd").length<PMSOperation.skillRecScrollLimit&&PMSOperation.skillSetMappingListView()}else if(2==optType){index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.department,"depId",mapId);PMSOperation.skillsetMappeddata.department.splice(index,1),PMSOperation.mappeddepartmentArray.splice(PMSOperation.mappeddepartmentArray.indexOf(mapId),1),PMSOperation.skillsetConst.departmentIndex--,pageId.find("#skilldepartment_"+mapId).fadeOut(function(){1===$("#departmentMapping .zpl_crd").length&&PMSOperation.skillsetMappingNoData(PMSOperation.skillsetMappeddata),$(this).remove()}),ZPeople.Message.success(ZPI18N.getString("zp.skilltagdeletemsg",[ZPI18N.getString("zp.department")])),Layout.Page.container.find("#departmentMapping .zpl_crd").length<PMSOperation.skillRecScrollLimit&&PMSOperation.skillSetMappingListView()}else{index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.desDep,"ruleId",mapId);PMSOperation.skillsetMappeddata.desDep.splice(index,1),PMSOperation.mappeddesDeptArray.splice(PMSOperation.mappeddesDeptArray.indexOf(mapId),1),PMSOperation.skillsetConst.desDepIndex--,pageId.find("#skilldesDep_"+mapId).fadeOut(function(){1===$("#desDepMapping .zpl_crd").length&&PMSOperation.skillsetMappingNoData(PMSOperation.skillsetMappeddata),$(this).remove()}),ZPeople.Message.success(ZPI18N.getString("zp.skilltagdeletemsg",[ZPI18N.getString("zp.designation")+" & "+ZPI18N.getString("zp.department")])),Layout.Page.container.find("#desDepMapping .zpl_crd").length<PMSOperation.skillRecScrollLimit&&PMSOperation.skillSetMappingListView()}})},deletePopUp.show()},deleteskillsetDomain:function(domainId){var pageId=settingsPage.container,deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.delete")+" "+PMSSetting.skilldispName+" Mapping",deletePopUp.despcription=ZPI18N.getString("zp.deleteKra",new Array(PMSSetting.skilldispName+" "+ZPI18N.getString("zp.rule"))),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){var params={mode:"deleteSkillDomain",domainId:domainId,conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){if(void 0!==resultData[0]&&"success"===resultData[0].msg){ZAlertDialog.close();var index=PMSOperation.findArrayindexBykeyValue(PMSOperation.skillsetMappeddata.domain,"domainId",domainId);PMSOperation.skillsetMappeddata.domain.splice(index,1),PMSOperation.skillsetConst.domainsIndex--,pageId.find("#skilldomain_"+domainId).fadeOut(function(){1===pageId.find("#domainMapping .zpl_crd").length&&PMSOperation.skillsetMappingNoData(PMSOperation.skillsetMappeddata),$(this).remove()}),ZPeople.Message.success(ZPI18N.getString("zp.deleted.successfully.msg",new Array(PMSSetting.SKILLSET_DISPLAY_NAME))),pageId.find("#domainMapping .zpl_crd").length<PMSOperation.skillRecScrollLimit&&PMSOperation.skillSetMappingListView()}})},deletePopUp.show()},setWeightageValidationKey:function(key){var data="0",_sliderDiv=$(PMSOperation.sliderObj.sliderDiv),varparams={mode:"getRestrictionWeightageValidation",conreqcsr:csrfToken,type:key};$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:varparams,success:function(resultData){data=void 0!=resultData.enabled&&resultData.enabled?"1":"0"}}),"comp"==key?PMSOperation.RESTRICT_COMPETENCY_WEIGHTAGE=data:"kra"==key?PMSOperation.RESTRICT_KRA_WEIGHTAGE=data:"skill"==key&&(PMSOperation.RESTRICT_SKILLSET_WEIGHTAGE=data),"0"==data?(_sliderDiv.find("#weightagenote").removeClass("DN"),_sliderDiv.find(".zpl_info").removeClass("DN")):(_sliderDiv.find("#weightagenote").addClass("DN"),_sliderDiv.find("#selectedCnt").hasClass("DN")&&_sliderDiv.find(".zpl_info").addClass("DN"))},changeView:function(mode,istabChange){var rowcount,modeStr,triggered,pageId=settingsPage.container;mode=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue();if(pageId.scrollTop(0),"domain"===mode?(modeStr="domainMapping",pageId.find("#domainMapping").show(),pageId.find("#designationMapping").hide(),pageId.find("#departmentMapping").hide(),pageId.find("#desDepMapping").hide(),ZPI18N.getString("zp.kramappingmessage",new Array(PMSSetting.SKILLSET_DISPLAY_NAME,ZPI18N.getString("zp.domain"))),triggered=PMSOperation.skillsetConst.domaintriggered):"designation"===mode?(modeStr="designationMapping",pageId.find("#domainMapping").hide(),pageId.find("#designationMapping").show(),pageId.find("#departmentMapping").hide(),pageId.find("#desDepMapping").hide(),ZPI18N.getString("zp.kramappingmessage",new Array(PMSSetting.SKILLSET_DISPLAY_NAME,ZPI18N.getString("zp.designation"))),triggered=PMSOperation.skillsetConst.destriggered):"department"===mode?(modeStr="departmentMapping",pageId.find("#domainMapping").hide(),pageId.find("#designationMapping").hide(),pageId.find("#departmentMapping").show(),pageId.find("#desDepMapping").hide(),ZPI18N.getString("zp.kramappingmessage",new Array(PMSSetting.SKILLSET_DISPLAY_NAME,ZPI18N.getString("zp.department"))),triggered=PMSOperation.skillsetConst.deptriggered):"desDep"===mode&&(modeStr="desDepMapping",pageId.find("#domainMapping").hide(),pageId.find("#designationMapping").hide(),pageId.find("#departmentMapping").hide(),pageId.find("#desDepMapping").show(),ZPI18N.getString("zp.depskill",new Array(PMSSetting.SKILLSET_DISPLAY_NAME)),ZPI18N.getString("zp.kramappingdesrulemessage",new Array(PMSSetting.SKILLSET_DISPLAY_NAME,ZPI18N.getString("zp.designation"),ZPI18N.getString("zp.department"))),triggered=PMSOperation.skillsetConst.desDeptriggered),istabChange&&(pageId.find("#notagdata").hide(),0==triggered||void 0==triggered?PMSOperation.skillSetMappingListView():istabChange=!1),rowcount=pageId.find("#"+modeStr+" .zpl_crd").length,!istabChange){if(0==rowcount){var _btnName=PMSOperation.ALL_SKILLS.length>0?ZPI18N.getString("zp.tag.module",new Array(PMSSetting.skilldispName)):ZPI18N.getString("zp.add")+" "+PMSSetting.skilldispName;pageId.find("#domainMapping","#designationMapping","#departmentMapping","#desDepMapping").hide(),pageId.find("#kramappingbtn").hide(),PMSOperationCommon.setNoData(pageId.find("#notagdata"),null,"no_data_found",null,ZPI18N.getString("zp.kramappingnodata",new Array(PMSSetting.skilldispName)),_btnName),pageId.find("#empBtnCrt").unbind(),PMSOperation.ALL_SKILLS.length>0?pageId.find("#empBtnCrt").click(function(){PMSOperation.showaddskillsTag()}):pageId.find("#empBtnCrt").click(function(){PMSOperation.addKRAPopup(pageId.find("#empBtnCrt"),"SKILL")}),ZPeopleComponents.isComponent("#skillmenuiconimpexpmapping")&&ZPeopleComponents.menu("#skillmenuiconimpexpmapping").hideMenuItems(["#"+ZPeopleComponents.menu("#skillmenuiconimpexpmapping").getMenuItemAt("1").attr("id")])}else pageId.find("#kramappingbtn").show(),pageId.find("#notagdata").hide(),ZPeopleComponents.isComponent("#skillmenuiconimpexpmapping")&&ZPeopleComponents.menu("#skillmenuiconimpexpmapping").showMenuItems(["#"+ZPeopleComponents.menu("#skillmenuiconimpexpmapping").getMenuItemAt("1").attr("id")]);pageId.find("#zp_page_loading").remove()}},showaddskillsTag:function(mode){var pageId=settingsPage.container;PMSOperation.tagArray={},delete PMSOperation.DESIGNATIONID,delete PMSOperation.DOMAINID,delete PMSOperation.DEPARTMENTID,delete PMSOperation.RULEID,PMSOperation.chooseConponentList=new Array,PMSOperation.selectedConponentList=new Array,PMSOperation.searchTagChooseList=new Array,PMSOperation.searchTagSelectedList=new Array,PMSOperation.loadMappingHtml("add","SKILL"),PMSOperation.userSkillMapformDtl.SKILL_WEIGHTAGE?pageId.find("#skillweightagediv").text(""):pageId.find("#skillweightagediv").show();var _sliderDiv=$(PMSOperation.sliderObj.sliderDiv),opttype=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue();if("domain"==opttype)_sliderDiv.find("#domainSearch").val(""),_sliderDiv.find("#domainSearch").focus(),_sliderDiv.find("#designationselect").hide(),_sliderDiv.find("#departmentselect").hide(),_sliderDiv.find("#desselect").hide(),pageId.find("#desDepartmentselect").hide(),_sliderDiv.find("#domainselect").show();else if("designation"==opttype){_sliderDiv.find("#domainselect").hide(),_sliderDiv.find("#departmentselect").hide(),_sliderDiv.find("#desselect").hide(),_sliderDiv.find("#desDepartmentselect").hide(),_sliderDiv.find("#designationselect").show();var dataSource=[];_sliderDiv.find("#desDepRoleselect");dataSource.push({id:"-1",name:ZPI18N.getString("zp.select")}),$.each(PMSOperation.ALL_DESIGNATION,function(key,value){-1==PMSOperation.mappeddesignationArray.indexOf(value.desId)&&dataSource.push({id:value.desId,name:ZPeople.decodeTxt(value.desName)})});var depRolesTokenObj={};depRolesTokenObj.options=dataSource,depRolesTokenObj.contentType="text",depRolesTokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},depRolesTokenObj.removeExistingDropdown=!0,depRolesTokenObj.search={by:"name",highlightKeyword:!0},depRolesTokenObj.dropdownList={height:"300px"},ZPeopleComponents.select("#desDepRoleselect",depRolesTokenObj)}else if("department"==opttype){_sliderDiv.find("#domainselect").hide(),_sliderDiv.find("#designationselect").hide(),_sliderDiv.find("#desselect").hide(),_sliderDiv.find("#desDepartmentselect").hide(),_sliderDiv.find("#departmentselect").show();_sliderDiv.find("#depselect");(dataSource=[]).push({id:"-1",name:ZPI18N.getString("zp.select")}),$.each(PMSOperation.ALL_DEPARTMENT,function(key,value){-1==PMSOperation.mappeddepartmentArray.indexOf(value.departmentId)&&dataSource.push({id:value.departmentId,name:ZPeople.decodeTxt(value.departmentName)})});var depTokenObj={};depTokenObj.options=dataSource,depTokenObj.contentType="text",depTokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},depTokenObj.removeExistingDropdown=!0,depTokenObj.search={by:"name",highlightKeyword:!0},depTokenObj.dropdownList={height:"300px"},ZPeopleComponents.select("#depselect",depTokenObj)}else if("desDep"==opttype){_sliderDiv.find("#domainselect").hide(),_sliderDiv.find("#designationselect").hide(),_sliderDiv.find("#desDepartmentselect").show(),_sliderDiv.find("#desselect").show(),_sliderDiv.find("#departmentselect").hide();_sliderDiv.find("#des_list");(dataSource=[]).push({id:"-1",name:ZPI18N.getString("zp.select")}),$.each(PMSOperation.ALL_DESIGNATION,function(key,value){-1==PMSOperation.mappedRuledesArray.indexOf(value.desId)&&dataSource.push({id:value.desId,name:ZPeople.decodeTxt(value.desName)})});var desSelectTokenObj={};desSelectTokenObj.options=dataSource,desSelectTokenObj.contentType="text",desSelectTokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},desSelectTokenObj.removeExistingDropdown=!0,desSelectTokenObj.search={by:"name",highlightKeyword:!0},desSelectTokenObj.dropdownList={height:"300px"},ZPeopleComponents.select("#des_list",desSelectTokenObj);_sliderDiv.find("#desDepselect");var dataSource1=[];$.each(PMSOperation.ALL_DEPARTMENT,function(key,value){-1==PMSOperation.mappeddesDeptArray.indexOf(value.departmentId)&&dataSource1.push({id:value.departmentId,name:ZPeople.decodeTxt(value.departmentName)})});var _destokenObj={};_destokenObj.data=dataSource1,_destokenObj.contentType="text",_destokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_destokenObj.search={by:"name"},_destokenObj.allowDuplicateValues=!1,_destokenObj.removeExistingDropdown=!0,_destokenObj.tokens={showRemoveButtonOnHover:!0},_destokenObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield($(PMSOperation.sliderObj.sliderDiv).find("#desDepselect"),_destokenObj)}if(void 0!=PMSOperation.ALL_SKILLS&&PMSOperation.ALL_SKILLS.length>0){PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.removeAllElementInTagComponent("csekralst");var csekralst="",i=0;$.each(PMSOperation.ALL_SKILLS,function(index,data){if(""!=data&&data.isActive){i<25&&(csekralst+=PMSOperation.tagComponentChooseListElementConstruction(data.skillsId,data.skillsName)),i++;var temp={};temp.skillsId=data.skillsId,temp.skillsName=data.skillsName,PMSOperation.chooseConponentList.push(temp)}}),_sliderDiv.find("#csekralst").append(csekralst),PMSOperation.setActionlistenerForTagComponents("choose")}else PMSOperationCommon.setNoData(_sliderDiv.find("#csekralst"),ZPI18N.getString("zp.nodatafound"),"zp_nd_record",null,null,null);PMSOperationCommon.setNoData(_sliderDiv.find("#sltkralst"),ZPI18N.getString("zp.nokramapped",new Array(PMSSetting.skilldispName)),"zp_nd_record",null,null,null),PMSOperation.chooseSelectAllReset()},constructSkillSet:function(arr,mode,name){var pageId=settingsPage.container,_tokenObj={},_options=[];_options.push({name:ZPI18N.getString("zp.domain"),id:"domain"}),_options.push({name:ZPI18N.getString("zp.designation"),id:"designation"}),_options.push({name:ZPI18N.getString("zp.department"),id:"department"}),_options.push({name:ZPI18N.getString("zp.designation")+" & "+ZPI18N.getString("zp.department"),id:"desDep"}),_tokenObj.options=_options,_tokenObj.contentType="text",_tokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},_tokenObj.removeExistingDropdown=!0,_tokenObj.search={by:["name"],highlightKeyword:!0},_tokenObj.value="domain",ZPeopleComponents.select(pageId.find("#desigdomainsel"),_tokenObj),pageId.find("#desigdomainsel").on("zselectchange",PMSOperation.changeView)},skillSetMappingListView:function(){var triggered,pageId=settingsPage.container,opttype=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue(),params={mode:"getskillSet",conreqcsr:csrfToken},mode="domainMapping";"domain"==opttype?(params.isDomainselected=!0,params.sIndex=PMSOperation.skillsetConst.domainsIndex,triggered=PMSOperation.skillsetConst.domaintriggered):"designation"==opttype?(params.sIndex=PMSOperation.skillsetConst.designationsIndex,params.isDomainselected=!1,params.modtype=1,triggered=PMSOperation.skillsetConst.destriggered,mode="designationMapping"):"department"==opttype?(params.sIndex=PMSOperation.skillsetConst.departmentIndex,params.isDomainselected=!1,params.modtype=2,triggered=PMSOperation.skillsetConst.deptriggered,mode="departmentMapping"):"desDep"==opttype&&(params.sIndex=PMSOperation.skillsetConst.desDepIndex,params.isDomainselected=!1,params.modtype=3,triggered=PMSOperation.skillsetConst.desDeptriggered,mode="desDepMapping"),0!=triggered&&void 0!=triggered||("domain"==opttype?PMSOperation.skillsetConst.domaintriggered=!0:"designation"==opttype?PMSOperation.skillsetConst.destriggered=!0:"department"==opttype?PMSOperation.skillsetConst.deptriggered=!0:"desDep"==opttype&&(PMSOperation.skillsetConst.desDeptriggered=!0),pageId.find("#"+mode).append(ZPeople.LOADING_HTML),$.post("/performanceConfig.zp",params,function(resultData){var isNoData=!1;params.sIndex<=1&&(isNoData=PMSOperation.skillsetMappingNoData(resultData)),isNoData||(pageId.find("#notagdata").hide(),"domain"==opttype?resultData.domain.length<PMSOperation.skillRecScrollLimit?PMSOperation.skillsetConst.domaintriggered=!0:PMSOperation.skillsetConst.domaintriggered=!1:"designation"==opttype?resultData.designation.length<PMSOperation.skillRecScrollLimit?PMSOperation.skillsetConst.destriggered=!0:PMSOperation.skillsetConst.destriggered=!1:"department"==opttype?resultData.department.length<PMSOperation.skillRecScrollLimit?PMSOperation.skillsetConst.deptriggered=!0:PMSOperation.skillsetConst.deptriggered=!1:"desDep"==opttype&&(resultData.desDep.length<PMSOperation.skillRecScrollLimit?PMSOperation.skillsetConst.desDeptriggered=!0:PMSOperation.skillsetConst.desDeptriggered=!1),PMSOperation.skillSetListView(resultData,!0,!(params.sIndex<=1))),pageId.find("#zp_page_loading").remove()}))},skillNoData:function(length){var pageId=settingsPage.container;PMSOperation.ALL_SKILLS.length>0?0==length?(pageId.find("#kramappingbtn").hide(),pageId.find("#kralibrarybtn").show(),pageId.find("#empBtnCrt").html('<span class="zpl_ellipsis">'+ZPI18N.getString("zp.tag.module",[PMSSetting.SKILLSET_DISPLAY_NAME])+"</span>"),pageId.find("#empBtnCrt").attr("title",ZPI18N.getString("zp.tag.module",[ZPeople.decodeTxt(PMSSetting.SKILLSET_DISPLAY_NAME)])),pageId.find("#empBtnCrt").off("click").on("click",function(){PMSOperation.showaddskillsTag()})):(pageId.find("#kramappingbtn").show(),pageId.find("#kralibrarybtn").show()):(pageId.find("#kramappingbtn").hide(),pageId.find("#kralibrarybtn").hide(),pageId.find("#empBtnCrt").html('<span class="zpl_ellipsis">'+ZPI18N.getString("zp.add")+" "+PMSSetting.SKILLSET_DISPLAY_NAME+"</span>"),pageId.find("#empBtnCrt").attr("title",ZPI18N.getString("zp.add")+" "+ZPeople.decodeTxt(PMSSetting.SKILLSET_DISPLAY_NAME)),pageId.find("#empBtnCrt").off("click").on("click",function(){PMSOperation.openLibrarySlider("SKILL")}))},addSelectedinChooselistafterConstruction:function(arr,mode,name){var value="skillsId";"competency"==name?value="compId":"kra"==name?value="kraId":"question"==name&&(value="questionId");var _sliderDiv=$(PMSOperation.sliderObj.sliderDiv);"edit"!=mode&&"search"!=mode||$.each(arr,function(i,val){_sliderDiv.find("#"+val[value]).find("input").prop("checked",!0)})},addSkills:function(mode,skillId){for(var pageId=settingsPage.container,popEle=$(PMSOperation.kraaddmodal.sliderDiv),skillname=popEle.find("#skillSearch").val(),skillName=[],p=0;p<PMSOperation.ALL_SKILLS.length;p++)skillName[p]=PMSOperation.ALL_SKILLS[p].skillsName.toLowerCase();if(popEle.find("#skillset_exist_error").hide(),popEle.find("#skill_desc_error").hide(),popEle.find("#skillSearch").removeClass("ztextbox__error"),void 0==skillname||""==skillname.trim())return popEle.find("#skillSearch").addClass("ztextbox__error"),void popEle.find("#skillset_exist_error").html(ZPI18N.getString("zp.invalidvalue",[PMSSetting.skilldispName])).show();if(skillname.length>500)return popEle.find("#skillSearch").addClass("ztextbox__error"),void popEle.find("#skillset_exist_error").html(ZPI18N.getString("zp.eachskilllength",new Array(PMSSetting.skilldispName))).show();if(-1!=$.inArray(skillname.toLowerCase(),skillName)&&skillname.length<=500&&"edit"!=mode)ZPeople.Message.warning(ZPI18N.getString("zp.duplicateSkill",new Array(PMSSetting.skilldispName)));else{var skillDes=popEle.find("#skill_desc").val();if(skillDes.length>5e3)return popEle.find("#skill_desc").addClass("ztextbox__error"),void popEle.find("#skill_desc_error").html(ZPI18N.getString("zp.fieldpropertymaxlength",["Skill Description","5000 characters"])).show();popEle.find("#skill_desc_error").removeClass("ztextbox__error"),popEle.find("#skill_desc_error").is(":visible")&&popEle.find("#skill_desc_error").hide();ZPI18N.getString("zp.skillsadd",new Array(PMSSetting.skilldispName));var params={mode:"addNewSkill",skill:skillname,conreqcsr:csrfToken,skillDes:skillDes};"edit"==mode&&(ZPI18N.getString("zp.skilledit",new Array(PMSSetting.skilldispName)),params.submode="edit",params.skillId=skillId),$.post("/performanceConfig.zp",params,function(resultData){if(void 0!=resultData[0].msg&&"duplicate"==resultData[0].msg)ZPeople.Message.warning(ZPI18N.getString("zp.duplicateSkill",new Array(PMSSetting.skilldispName)));else if(void 0!=resultData[0].msg)ZPeople.Message.failure(msg);else{jQuery.isEmptyObject(PMSOperation.kraaddmodal)||PMSOperation.kraaddmodal.close(),PMSOperation.ALL_SKILLS=resultData;var length=0;if("domain"==(type=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue())?length=PMSOperation.skillsetMappeddata.domain.length:"designation"==type?length=PMSOperation.skillsetMappeddata.designation.length:"department"==type?length=PMSOperation.skillsetMappeddata.department.length:"desDep"==type&&(length=PMSOperation.skillsetMappeddata.desDep.length),PMSOperation.ALL_SKILLS.length>0&&0==length){var _btnName=ZPI18N.getString("zp.tag.module",new Array(PMSSetting.skilldispName)),mode=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue();pageId.find("#domainMapping","#designationMapping","#departmentMapping","#desDepMapping").hide(),PMSOperationCommon.setNoData(pageId.find("#notagdata"),ZPI18N.getString("zp.pa.norectagged",new Array(PMSSetting.skilldispName)),"no_data_found",null,ZPI18N.getString("zp.pa.tagskillmsg",new Array(PMSSetting.skilldispName,PMSSetting.skilldispName,PMSSetting.skilldispName)),_btnName),pageId.find("#kralibrarybtn").show(),pageId.find("#kramappingbtn").hide(),pageId.find("#empBtnCrt").click(function(){PMSOperation.showaddskillsTag()})}if(jQuery.isEmptyObject(PMSOperation.sliderObj)&&!PMSOperation.isLibraryModalOpen)return;if(void 0!=PMSOperation.chooseConponentList&&PMSOperation.chooseConponentList.length>0&&!PMSOperation.isLibraryModalOpen){var temp={};resultData.length;if(void 0!=resultData[0]){temp.skillsId=resultData[0].skillsId,temp.skillsName=resultData[0].skillsName;var arr=new Array;arr.push(temp),PMSOperation.tagComponentChooselistConstruction(arr,"add",!0),PMSOperation.chooseConponentList.push(temp),PMSOperation.chooseSelectAllReset()}}else void 0!=PMSOperation.moduleLibraryslider&&PMSOperation.libraryConstruction("SKILL",resultData);if(void 0!=mode&&"editkra"==mode){var type=parseInt(ZPeopleComponents.select(pageId.find("#desdepselect")).getValue());PMSOperation.getKraMaping(type)}ZPeople.Message.success(ZPI18N.getString("zp.skillsadd",new Array(PMSSetting.skilldispName)))}})}},initiateSummary:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!1),pageId.html(""),$.ajax({type:"POST",async:!0,url:"/performance/view/operationSummary",data:{conreqcsr:csrfToken},success:function(resultData){pageId.append(resultData),"true"==PMSOperation.isSummaryShow&&PMSOperation.getHRNotes()}})}},getHRNotes:function(){var params={mode:"getSummaryquestionList",configId:"-1",userErecNo:erecno,frommode:"settings",conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){PMSOperation.summaryList(resultData,"list")})},summaryList:function(resultData,mode){var hrNoteHTML,pageId=settingsPage.container;hrNoteHTML="list"===mode?pageId.find("#questionbody").empty():pageId.find("#questionbody"),$.each(resultData,function(index,data){var existObj=pageId.find("#summary_question_"+data.questionId),rowHTML='<tr id="summary_question_'+data.questionId+'" class="'+("1"!=data.status?"disabled":"")+'" style="'+("1"!=data.status&&"-1"==data.type?"pointer-events: auto;":"")+'"> <td id="question_defalut_'+data.questionId+'" onclick="PMSOperation.showeditsummary(\''+data.questionId+"', this)\">"+data.question+"</td>";rowHTML+='<td><input style="display: none;"  id="enabledisableicon_'+data.questionId+'" id=""></td> ',rowHTML+="<td> ","-1"==data.type&&(rowHTML+='<div> <div class="zpl_hvr"><i title="'+ZPI18N.getString("zp.delete")+'" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.deleteDefalutQuestion(\''+data.questionId+"');\"></i></div> </div> "),rowHTML+="</td>",rowHTML+="</div> </div> </td>",rowHTML+="</tr>",existObj.length>0?existObj.replaceWith($(rowHTML)):hrNoteHTML.append($(rowHTML)),ZPeopleComponents.toggleswitch(pageId.find("#questionbody").find("#enabledisableicon_"+data.questionId),{on:"1"==data.status,change:PMSOperation.enabledisableQuestions})}),ZPeopleComponents.tooltip(pageId.find("#questionbody"),{})},saveQuestions:function(mode,id,type){const $popEle=$(PMSOperation.kraaddmodal.sliderDiv),$newQuestion=$popEle.find("#new_question"),$summaryExistError=$popEle.find("#summary_exist_error"),editQuestion=$popEle.find("#new_add_quetion textarea").val().trim();let editquestionId;if("edit"===mode&&(editquestionId=id),!editQuestion)return $newQuestion.trigger("focus").addClass("ztextbox__error"),void $summaryExistError.html(ZPI18N.getString("zp.givevalidinp")).show();if(editQuestion.length>1e4)return $newQuestion.trigger("focus").addClass("ztextbox__error"),void $summaryExistError.html(ZPI18N.getString("zp.exceedmaxlength")).show();$newQuestion.removeClass("ztextbox__error"),$summaryExistError.html("").hide();const params={question:editQuestion};"add"===mode?params.type="-1":params.editquestionId=editquestionId,pmsUtil.update("/performance/summary/adddefalutQuestion",params,!0,function(resultData){"sucess"===resultData.msg&&(PMSOperation.kraaddmodal.close(),"edit"===mode?ZPeople.Message.success(ZPI18N.getString("zp.questionmodifiedsucc")):ZPeople.Message.success(ZPI18N.getString("zp.questionaddedsucc")),PMSOperation.summaryList(resultData.summaryQuestion,mode))})},showeditsummary:function(questionid,obj){PMSOperation.addKRAPopup(null,"SUMMARY",questionid);var popEle=$(PMSOperation.kraaddmodal.sliderDiv),summaryObj=settingsPage.container.find("#summary_question_"+questionid);popEle.find("#new_question").val(summaryObj.find("#question_defalut_"+questionid).text()).trigger("focus")},enabledisableQuestions:function(event){if(event.detail.fromUI){var data=event.detail,pageId=settingsPage.container,questionid=$(event.target).attr("id").split("_")[1];if(data.state)ZPeopleComponents.toggleswitch(pageId.find("#questionbody").find("#enabledisableicon_"+questionid)).disable(),PMSOperation.enableDisableQuestion(questionid,"1");else{var infoAlertMessage=new InfoAlertMessage;infoAlertMessage.title=ZPI18N.getString("zp.summaryquewarningmsg"),infoAlertMessage.despcription="",infoAlertMessage.yesButtonText=ZPI18N.getString("zp.confirm"),infoAlertMessage.callback=function(obj){ZPeopleComponents.toggleswitch(pageId.find("#questionbody").find("#enabledisableicon_"+questionid)).disable(),PMSOperation.enableDisableQuestion(questionid,"0")},infoAlertMessage.cancelCallback=function(obj){pageId.find("#questionbody").find("#enabledisableicon_"+questionid).ztoggleswitch("switchOn")},infoAlertMessage.show()}}},enableDisableQuestion:function(questionid,status){var pageId=settingsPage.container,param={mode:"enabledisablequestion",questionId:questionid,status:status,conreqcsr:csrfToken};$.post("/performanceConfig.zp",param,function(resultData){ZPeopleComponents.toggleswitch(pageId.find("#questionbody").find("#enabledisableicon_"+questionid)).enable(),"success"===resultData.msg&&(ZPeople.Message.success(ZPI18N.getString("zp.statuschanged")),"0"==resultData.status?pageId.find("#summary_question_"+questionid).addClass("disabled"):pageId.find("#summary_question_"+questionid).removeClass("disabled"))})},deleteDefalutQuestion:function(id){var pageId=settingsPage.container,deleteAlertMessage=new DeleteAlertMessage;deleteAlertMessage.title=ZPI18N.getString("zp.assessment.question.delete.confirm"),deleteAlertMessage.despcription=ZPI18N.getString("zp.actdelconfmsgarg",new Array(ZPI18N.getString("zp.question"))),deleteAlertMessage.yesButtonText=ZPI18N.getString("zp.confirm"),deleteAlertMessage.cancelButtonText=ZPI18N.getString("zp.cancel"),deleteAlertMessage.callback=function(obj){pmsUtil.delete("/performance/summary/deletequestion",{questionId:id},!0,function(resultData){resultData.length>0&&"success"===resultData[0].msg&&(ZPeople.Message.success(ZPI18N.getString("zp.questiondeletedsucc")),pageId.find("#summary_question_"+id).fadeOut(function(){$(this).remove()}))})},deleteAlertMessage.show()},getCycleTmplPage:function(){null===PMSOperation.CYCLE_LIST_TEMPLATE_PAGE&&$.ajax({type:"POST",async:!1,url:"/performance/view/cycleSettings",data:{conreqcsr:csrfToken},success:function(resultData){PMSOperation.CYCLE_LIST_TEMPLATE_PAGE=resultData}})},initiateTagquestion:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){PMSOperation.destoryComponentObj();var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!1),pageId.html(""),$.ajax({type:"POST",async:!0,url:"performance/view/questionnaire",data:{conreqcsr:csrfToken},success:function(resultData){pageId.append(resultData),"true"==PMSOperation.isRevQuesShow&&PMSOperation.getReviewQuestion()}})}},getReviewQuestion:function(){var pageId=settingsPage.container;PMSOperation.tagComponentKeyNames={},PMSOperation.tagComponentKeyNames.NameKey="question",PMSOperation.tagComponentKeyNames.IdKey="questionId",PMSOperation.tagComponentKeyNames.weightageKey="",PMSOperation.tagComponentKeyNames.descKey="desc",PMSOperation.tagComponentKeyNames.comName="question",PMSOperation.questionMappedList=new Array,PMSOperation.questionUnMappedList=new Array,PMSOperation.questionSearchresult=new Array,PMSOperation.allQuestion=void 0,ZPeopleComponents.select(pageId.find("#questiondesdepsel2"),{change:PMSOperation.switchReviewQuestiontab});ZPeopleComponents.select("#questiondesdepsel2").getValue();var params={mode:"getReviewQuestion",conreqcsr:csrfToken};ZPeople.Request.sendAsyncPost("/performanceConfig.zp",params,PMSOperation.constructReviewQuestionsList,"get"),PMSOperation.getReviewQuestionMapping()},switchReviewQuestiontab:function(eData){var pageId=settingsPage.container,id=eData.detail.selectedValue;"questiondesmapping"==id?(pageId.find("#desQuestion").html(ZPeople.LOADING_HTML).show(),pageId.find("#roleQuestion").hide(),pageId.find("#depQuestion").hide(),pageId.find("#locationQuestion").hide(),PMSOperation.getReviewQuestionMapping(id)):"questiondepmapping"==id?(pageId.find("#desQuestion").hide(),pageId.find("#roleQuestion").hide(),pageId.find("#depQuestion").html(ZPeople.LOADING_HTML).show(),pageId.find("#locationQuestion").hide(),PMSOperation.getReviewQuestionMapping(id)):"questionrolemapping"==id?(pageId.find("#desQuestion").hide(),pageId.find("#roleQuestion").html(ZPeople.LOADING_HTML).show(),pageId.find("#depQuestion").hide(),pageId.find("#locationQuestion").hide(),PMSOperation.getReviewQuestionMapping(id)):"questionlocationmapping"==id&&(pageId.find("#desQuestion").hide(),pageId.find("#roleQuestion").hide(),pageId.find("#depQuestion").hide(),pageId.find("#locationQuestion").html(ZPeople.LOADING_HTML).show(),PMSOperation.getReviewQuestionMapping(id))},showtagQuestion:function(mode){var pageId=settingsPage.container;null!=PMSOperation.ALL_DESIGNATION&&null!=PMSOperation.ALL_DEPARTMENTS&&null!=PMSOperation.ALL_ROLES&&null!=PMSOperation.ALL_LOCATIONS||$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getroles_designation",conreqcsr:csrfToken},success:function(data){PMSOperation.ALL_DESIGNATION=data.designations,PMSOperation.ALL_DEPARTMENTS=data.departmentList,PMSOperation.ALL_ROLES=data.roleList,PMSOperation.ALL_LOCATIONS=data.locationList}});let isAddMode=!1;void 0!=mode&&"edit"==mode?PMSOperation.loadMappingHtml("edit","REVQES"):(isAddMode=!0,PMSOperation.loadMappingHtml("add","REVQES"));var desdepobj={},dataObj={},desid="",desname="",selectdisName="",placeHolder="",tagselec=ZPeopleComponents.select(pageId.find("#questiondesdepsel2")).getValue();"questiondesmapping"==tagselec?(desdepobj=JSON.parse(JSON.stringify(PMSOperation.ALL_DESIGNATION)),dataObj=PMSOperation.Designation_comp,desid="desId",desname="desName",selectdisName=ZPI18N.getString("zp.designation"),placeHolder=ZPI18N.getString("zp.selDesignation")):"questiondepmapping"==tagselec?(desdepobj=JSON.parse(JSON.stringify(PMSOperation.ALL_DEPARTMENTS)),dataObj=PMSOperation.Department_comp,desid="departmentId",desname="departmentName",selectdisName=ZPI18N.getString("zp.department"),placeHolder=ZPI18N.getString("zp.selDepartment")):"questionrolemapping"==tagselec?(desdepobj=JSON.parse(JSON.stringify(PMSOperation.ALL_ROLES)),dataObj=PMSOperation.Role_comp,desid="roleId",desname="roleName",selectdisName=ZPI18N.getString("zp.role"),placeHolder=ZPI18N.getString("zp.selectroles")):"questionlocationmapping"==tagselec&&(desdepobj=JSON.parse(JSON.stringify(PMSOperation.ALL_LOCATIONS)),dataObj=PMSOperation.Location_comp,desid="locationId",desname="locationName",selectdisName=ZPI18N.getString("zp.location"),placeHolder=ZPI18N.getString("zp.selLocation")),PMSOperation.kramapold={},PMSOperation.mappedDesDep=PMSOperation.convertArrayToObject(dataObj,"mapdesdepId"),$(PMSOperation.sliderObj.sliderDiv).find("#choosedesdep").text(ZPI18N.getString("zp.choosedesdep",new Array(selectdisName)));var des_ele=$(PMSOperation.sliderObj.sliderDiv).find("#desDepRoleselect"),revty_ele=$(PMSOperation.sliderObj.sliderDiv).find("#reviewTypeselect"),dataSource=[];dataSource.push({id:"1",name:ZPI18N.getString("zp.all")}),null!=desdepobj&&desdepobj.length>0&&$.each(desdepobj,function(index,data){dataSource.push({id:data[desid],name:ZPeople.decodeTxt(data[desname])})});var _desdeptokenObj={};_desdeptokenObj.data=dataSource,_desdeptokenObj.contentType="text",_desdeptokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_desdeptokenObj.search={by:"name"},_desdeptokenObj.allowDuplicateValues=!1,_desdeptokenObj.placeholder=placeHolder,_desdeptokenObj.sort=!1,_desdeptokenObj.tokens={showRemoveButtonOnHover:!0},_desdeptokenObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield(des_ele,_desdeptokenObj),$(des_ele).on("ztokenfieldbeforetokenadd",PMSOperation.showhideQuestionMapQuestion);var revdataSource=[];revdataSource.push({id:"self",name:ZPI18N.getString("zp.self")}),revdataSource.push({id:"rater",name:ZPI18N.getString("zp.rater")}),revdataSource.push({id:"reviewer",name:ZPI18N.getString("zp.reviewer")});var _revtypetokenObj={};if(_revtypetokenObj.data=revdataSource,_revtypetokenObj.contentType="text",_revtypetokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_revtypetokenObj.search={by:"name"},_revtypetokenObj.allowDuplicateValues=!1,_revtypetokenObj.placeholder=ZPI18N.getString("zp.selectreviewtype"),_revtypetokenObj.tokens={showRemoveButtonOnHover:!0},_revtypetokenObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield(revty_ele,_revtypetokenObj),PMSOperationCommon.clearNoData($(PMSOperation.sliderObj.sliderDiv).find("#csekralst")),isAddMode){if(void 0!=PMSOperation.allQuestion&&PMSOperation.allQuestion.length>0){PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.removeAllElementInTagComponent("csekralst"),$(PMSOperation.sliderObj.sliderDiv).find("#sltKra_wghthd").find("#kraweightage b").remove();var csekralst="";$.each(PMSOperation.allQuestion,function(index,data){if(""!=data&&data.isactive){csekralst+=PMSOperation.tagComponentChooseListElementConstruction(data.questionId,data.question);var temp={};temp.questionId=data.questionId,temp.question=data.question,void 0==PMSOperation.chooseConponentList&&(PMSOperation.chooseConponentList=[]),PMSOperation.chooseConponentList.push(temp)}}),$(PMSOperation.sliderObj.sliderDiv).find("#csekralst").append(csekralst),PMSOperation.setActionlistenerForTagComponents("choose")}else PMSOperationCommon.setNoData($(PMSOperation.sliderObj.sliderDiv).find("#csekralst"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null);PMSOperationCommon.setNoData($(PMSOperation.sliderObj.sliderDiv).find("#sltkralst"),ZPI18N.getString("zp.nokramapped",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME)),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null)}},editReviewQuestionmapping:function(recId){var pageId=settingsPage.container;if(void 0!=recId){PMSOperation.chooseConponentList=new Array,PMSOperation.selectedConponentList=new Array,PMSOperation.searchTagChooseList=new Array,PMSOperation.searchTagSelectedList=new Array,PMSOperation.editRevQuesRuleId=recId,PMSOperation.showtagQuestion("edit",recId);var sliderDiv=$(PMSOperation.sliderObj.sliderDiv);PMSOperation.kramapold={};var dataObj=null,selectdisName="";pageId.find("#desQuestion").is(":visible")?(dataObj=PMSOperation.Designation_comp,selectdisName=ZPI18N.getString("zp.designation")):pageId.find("#depQuestion").is(":visible")?(dataObj=PMSOperation.Department_comp,selectdisName=ZPI18N.getString("zp.department")):pageId.find("#roleQuestion").is(":visible")?(dataObj=PMSOperation.Role_comp,selectdisName=ZPI18N.getString("zp.role")):pageId.find("#locationQuestion").is(":visible")&&(dataObj=PMSOperation.Location_comp,selectdisName=ZPI18N.getString("zp.location")),sliderDiv.find("#choosedesdep").text(ZPI18N.getString("zp.choosedesdep",new Array(selectdisName))),$.each(dataObj,function(index,data){if(recId==data.mapId){var desvals=new Array;$.each(data.desDepval,function(desindex,desdata){desvals.push({id:desindex,name:ZPeople.decodeTxt(desdata)})}),ZPeopleComponents.tokenfield(sliderDiv.find("#desDepRoleselect")).setAttributes({values:desvals,disabled:!1});var revdataSource=[];if(0==data.type.length)revdataSource.push({id:"self",name:ZPI18N.getString("zp.self")}),revdataSource.push({id:"rater",name:ZPI18N.getString("zp.rater")}),revdataSource.push({id:"reviewer",name:ZPI18N.getString("zp.reviewer")});else for(var j in data.type)"self"==data.type[j]&&revdataSource.push({id:"self",name:ZPI18N.getString("zp.self")}),"rater"==data.type[j]&&revdataSource.push({id:"rater",name:ZPI18N.getString("zp.rater")}),"reviewer"==data.type[j]&&revdataSource.push({id:"reviewer",name:ZPI18N.getString("zp.reviewer")});if(ZPeopleComponents.tokenfield(sliderDiv.find("#reviewTypeselect")).setAttributes({values:revdataSource,disabled:!1}),Object.keys(data.questions).length>0){sliderDiv.find("#emptPage").remove(),PMSOperation.kramapold=PMSOperation.convertArrayToObject(data.questions,"questionId"),PMSOperation.chooseConponentList=new Array,PMSOperation.selectedConponentList=new Array,PMSOperation.removeAllElementInTagComponent("sltkralst"),PMSOperation.removeAllElementInTagComponent("csekralst");var sltkralst="",csekralst="";$.each(data.questions,function(i,val){var tempcompId=val.questionId;if(void 0!=PMSOperation.kramapold[tempcompId]){var temp={};temp.question=val.question,temp.questionId=tempcompId,PMSOperation.selectedConponentList.push(temp),sltkralst+=PMSOperation.tagComponentSelectedlistElementConstruction(tempcompId,val.question,!0)}}),void 0==PMSOperation.chooseConponentList&&(PMSOperation.chooseConponentList=[]),$.each(PMSOperation.allQuestion,function(i,val){var tempcompId=val.questionId;if(void 0==PMSOperation.kramapold[tempcompId]){csekralst+=PMSOperation.tagComponentChooseListElementConstruction(val.questionId,val.question);var temp={};temp.question=val.question,temp.questionId=tempcompId,PMSOperation.chooseConponentList.push(temp)}else csekralst+=PMSOperation.tagComponentChooseListElementConstruction(val.questionId,val.question)}),sliderDiv.find("#sltkralst").append(sltkralst),PMSOperation.tagComponentSelectedlistAfterConstruction(PMSOperation.selectedConponentList,"edit"),sliderDiv.find("#csekralst").append(csekralst),PMSOperation.tagComponentChooselistafterConstruction(PMSOperation.selectedConponentList.concat(PMSOperation.chooseConponentList),"edit",PMSOperation.tagComponentKeyNames.comName),PMSOperation.addSelectedinChooselistafterConstruction(PMSOperation.selectedConponentList,"edit",PMSOperation.tagComponentKeyNames.comName),PMSOperation.changeSelectedCount()}}}),PMSOperation.chooseSelectAllReset()}},tagReviewQuestion:function(mode){var pageId=settingsPage.container,sliderDiv=$(PMSOperation.sliderObj.sliderDiv);sliderDiv.find("#desDepRoleselect").parent().parent().parent().find(".ztextbox__error").each(function(){$(this).hasClass("ztokenfield")&&(ZPeopleComponents.tokenfield($(this).prev()).setAttributes({className:""}),$(this).next().hide())}),0==PMSOperation.selectedConponentList.length&&ZPeople.Message.failure(ZPI18N.getString("zp.nokraselected",new Array(ZPI18N.getString("zp.question")))),sliderDiv.find("#sliderSbt").prop("disabled",!0);var desId=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderDiv.find("#desDepRoleselect")).getAllValues()),tagval=ZPeopleComponents.select(pageId.find("#questiondesdepsel2")).getValue(),selecteddesname="",flag=!0;if("questiondesmapping"==tagval?selecteddesname=ZPI18N.getString("zp.designation"):"questiondepmapping"==tagval?selecteddesname=ZPI18N.getString("zp.department"):"questionrolemapping"==tagval?selecteddesname=ZPI18N.getString("zp.role"):"questionlocationmapping"==tagval&&(selecteddesname=ZPI18N.getString("zp.location")),void 0!=desId&&desId.length>0?desId.length>=2&&"-1"!=desId.indexOf("1")&&(flag=!1):flag=!1,!flag)return ZPeopleComponents.tokenfield(sliderDiv.find("#desDepRoleselect")).setAttributes({className:"ztextbox__error"}),sliderDiv.find("#desErr").text(ZPI18N.getString("zp.pleaseselectdes",new Array(selecteddesname))).show(),sliderDiv.find("#sliderSbt").prop("disabled",!1),!1;for(var compIds=[],compIdlist=[],index=0;index<PMSOperation.selectedConponentList.length;index++){var compid=PMSOperation.selectedConponentList[index].questionId;if(-1==compIdlist.indexOf(compid)){compIdlist.push(compid);var compdtl={};compdtl.questionId=compid,compIds.push(compdtl)}}var params={};(params={mode:"mapReviewQuestionNew",conreqcsr:csrfToken}).desdeproleId=JSON.stringify(desId);var selectdisName="";if("questiondesmapping"==tagval?(params.category="designation",selectdisName=ZPI18N.getString("zp.designation")):"questiondepmapping"==tagval?(params.category="department",selectdisName=ZPI18N.getString("zp.department")):"questionrolemapping"==tagval?(params.category="role",selectdisName=ZPI18N.getString("zp.role")):"questionlocationmapping"==tagval&&(params.category="location",selectdisName=ZPI18N.getString("zp.location")),0==ZPeopleComponents.tokenfield(sliderDiv.find("#reviewTypeselect")).getAllValues().length)return flag=!1,ZPeopleComponents.tokenfield(sliderDiv.find("#reviewTypeselect")).setAttributes({className:"ztextbox__error"}),sliderDiv.find("#rtErr").text(ZPI18N.getString("zp.selectvalueforreviewtype")).show(),sliderDiv.find("#sliderSbt").prop("disabled",!1),!1;params.type=JSON.stringify(PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderDiv.find("#reviewTypeselect")).getAllValues())),params.orderedreviewquestion=JSON.stringify(compIdlist),successmsg="Review Question tagged to "+selectdisName;var tempArr=Object.assign({},PMSOperation.kramapold);if(void 0!=mode&&"edit"==mode){params.submode="editmapcomp",successmsg=ZPI18N.getString("zp.editedsuccess"),params.mappingid=PMSOperation.editRevQuesRuleId;var addobj=[],delobj=[];for(index=0;index<PMSOperation.selectedConponentList.length;index++){var compId=PMSOperation.selectedConponentList[index].questionId;if(void 0==PMSOperation.kramapold[compId]){var temp={};temp.questionId=compId,addobj.push(temp)}else void 0!=PMSOperation.kramapold[compId]&&delete PMSOperation.kramapold[compId]}$.each(PMSOperation.kramapold,function(index,data){var temp={};temp.questionId=index,delobj.push(temp)});var ischanged=PMSOperation.validateRuleObj();(addobj.length>100||delobj.length>100)&&!ischanged&&(ZPeople.Message.failure(ZPI18N.getString("zp.kralength",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME))),PMSOperation.kramapold=Object.assign({},tempArr),flag=!1),0==PMSOperation.selectedConponentList.length&&(ZPeople.Message.failure(ZPI18N.getString("zp.nokraselected",new Array(ZPI18N.getString("zp.question")))),flag=!1),addobj=JSON.stringify(addobj),delobj=JSON.stringify(delobj),params.toadd=addobj,params.todel=delobj}else compIds.length>100&&(ZPeople.Message.failure(ZPI18N.getString("zp.kralength",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME))),flag=!1),0==compIds.length&&(ZPeople.Message.failure(ZPI18N.getString("zp.nokraselected",new Array(ZPI18N.getString("zp.question")))),flag=!1),compIds=JSON.stringify(compIds),params.complist=compIds;if(!flag)return sliderDiv.find("#sliderSbt").prop("disabled",!1),!1;$.post("/performanceConfig.zp",params,function(resultData){"success"==resultData.msg?(ZPeople.Message.success(successmsg),PMSOperation.sliderObj.close(),PMSOperation.selectedConponentList=[],PMSOperation.chooseConponentList=[],PMSOperation.kramapold=Object.assign({},tempArr),PMSOperation.getReviewQuestionMapping()):"PERMISSION_DENIED"===resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):"mapping_Exist"==resultData.msg||"mapping_exist"==resultData.msg?ZPeople.Message.success("Mapping Already Exist"):ZPeople.Message.success(ZPI18N.getString("zp.sorryservererror")),sliderDiv.find("#sliderSbt").prop("disabled",!1)})},showhideQuestionMapQuestion:function(eData){settingsPage.container;var selVal=eData.detail.tokenData.id;if(null!=selVal){var tokenList=ZPeopleComponents.tokenfield("#desDepRoleselect").getAllValues();if(1==selVal&&tokenList.length>0)ZPeopleComponents.tokenfield("#desDepRoleselect").removeAllTokens();else if(tokenList.length>0)for(var i in tokenList)if("1"==tokenList[i].id){ZPeopleComponents.tokenfield("#desDepRoleselect").removeTokens(["1"]);break}}},getReviewQuestionMapping:function(tabselected){var pageId=settingsPage.container,params={mode:"getReviewQuestionMapping",conreqcsr:csrfToken};void 0==tabselected&&(tabselected=ZPeopleComponents.select("#questiondesdepsel2").getValue());var id="";"questiondesmapping"===tabselected?(params.tab="DES",id="desQuestion"):"questiondepmapping"===tabselected?(params.tab="DEP",id="depQuestion"):"questionlocationmapping"===tabselected?(params.tab="LOCATION",id="locationQuestion"):(params.tab="ROLE",id="roleQuestion"),pageId.find("#"+id).html(ZPeople.LOADING_HTML).show(),ZPeople.Request.send("/performanceConfig.zp",params,PMSOperation.constructReviewQuestionMappingList,"get")},constructReviewQuestionMappingList:function(resultData,mode){var pageId=settingsPage.container,id="";if("DES"==resultData.tab?(pageId.find("#desQuestion").html(""),PMSOperation.Designation_comp=resultData.mapping,id="desQuestion","designation"):"DEP"==resultData.tab?(pageId.find("#depQuestion").html(""),PMSOperation.Department_comp=resultData.mapping,id="depQuestion","department"):"ROLE"==resultData.tab?(pageId.find("#roleQuestion").html(""),PMSOperation.Role_comp=resultData.mapping,id="roleQuestion","role"):"LOCATION"==resultData.tab&&(pageId.find("#locationQuestion").html(""),PMSOperation.Location_comp=resultData.mapping,id="locationQuestion","location"),void 0!=resultData.mapping&&resultData.mapping.length>0)pageId.find("#reviewquestiontagbtn,#reviewquestionadd").show(),$.each(resultData.mapping,function(index,data){if(data.questions.length>0){var depdesDisName="";let showMoreInfo=!1,desDeptcnt=0;$.each(data.desDepval,function(desindex,desdata){if(!(desDeptcnt<PMSOperation.DEF_METHODS_SIZE))return showMoreInfo=!0,!1;depdesDisName=""==depdesDisName?desdata:depdesDisName+",&nbsp;"+desdata,desDeptcnt++});var row='<div class="zpl_crd" id="compmap_'+data.mapId+'"> <div class="zpl_crdcnt"> <div class="zpl_secn"> <div> <ul class="zpl_paperent">';if(row+="<li><div>",row+=showMoreInfo?"<h5>"+depdesDisName+',&nbsp;</h5><div class="zpl_tg" title="'+ZPI18N.getString("zp.more")+'"><a id="showMore_'+data.mapId+'" mapid="'+data.mapId+'">+'+(Object.keys(data.desDepval).length-PMSOperation.DEF_METHODS_SIZE)+"</a></div>":"<h5>"+depdesDisName+"</h5>",row+='<span class="zpl_dots"></span>',0==data.type.length)row+="<em>"+ZPI18N.getString("zp.self")+", "+ZPI18N.getString("zp.rater")+", "+ZPI18N.getString("zp.reviewer")+"</em>";else{var _typeDisplay="",cnt=0;for(var i in data.typeDisplay)0==cnt?_typeDisplay=data.typeDisplay[i]:_typeDisplay+=",&nbsp;"+data.typeDisplay[i],cnt++;row+="<em>"+_typeDisplay+"</em>"}row+='</div><div class="zpl_hvr"> <i class="PI_edt" title="'+ZPI18N.getString("zp.edit")+'" onclick="PMSOperation.editReviewQuestionmapping(\''+data.mapId+'\');"></i> <i data-popup-open="" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+"\" onclick=\"PMSOperation.deleteReviewQuestionmapping('deloption', '"+data.mapId+"');\"></i> </div>",row+="</li>",$.each(data.questions,function(index,val){row+='<li class="zpl_pavlu" id="'+val.questionId+'">',row+="<span>"+val.question+"</span> </li>"}),row+="</ul></div></div></div></div>",row=$(row),pageId.find("#"+id).append($(row).data(data))}}),pageId.find("#"+id).show(),pageId.find("[id^=showMore_]").unbind(),pageId.find("[id^=showMore_]").on("click",event=>{PMSOperation.showMorePopOver(event,"REV_QUS")});else{pageId.find("#"+id).show();let noDataTitleMsg=void 0==PMSOperation.allQuestion||0==PMSOperation.allQuestion.length?ZPI18N.getString("zp.pa.nodataadded",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME)):ZPI18N.getString("zp.pa.norectagged",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME));PMSOperationCommon.setNoData(pageId.find("#"+id),noDataTitleMsg,"no_data_found",null,ZPI18N.getString("zp.pa.tagreviewques",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME)),ZPI18N.getString("zp.add")+" "+PMSSetting.QUS_ANS_DISPLAY_NAME),void 0==PMSOperation.allQuestion||0==PMSOperation.allQuestion.length?(pageId.find("#reviewquestionadd").hide(),pageId.find("#reviewquestiontagbtn").hide(),pageId.find("#"+id).find("#empBtnCrt").html('<span class="zpl_ellipsis">'+ZPI18N.getString("zp.add")+"</span>"),pageId.find("#"+id).find("#empBtnCrt").attr("title",ZPI18N.getString("zp.add")+" "+ZPeople.decodeTxt(PMSSetting.QUS_ANS_DISPLAY_NAME)),pageId.find("#"+id).find("#empBtnCrt").click(function(){PMSOperation.openLibrarySlider("REVQES")})):(pageId.find("#reviewquestionadd").show(),pageId.find("#reviewquestiontagbtn").hide(),pageId.find("#"+id).find("#empBtnCrt").html('<span class="zpl_ellipsis">'+ZPI18N.getString("zp.tag.module",[PMSSetting.QUS_ANS_DISPLAY_NAME])+"</span>"),pageId.find("#"+id).find("#empBtnCrt").attr("title",ZPI18N.getString("zp.tag.module",[ZPeople.decodeTxt(PMSSetting.QUS_ANS_DISPLAY_NAME)])),pageId.find("#"+id).find("#empBtnCrt").click(function(){PMSOperation.showtagQuestion()}))}},addQuestion:function(mode,compId){const pageId=settingsPage.container,popEle=$(PMSOperation.kraaddmodal.sliderDiv),revQuesName=popEle.find("#revques_name"),revQuesExistError=popEle.find("#revques_exist_error"),question=revQuesName.val().trim();if(!question)return revQuesName.trigger("focus").addClass("ztextbox__error"),void revQuesExistError.html(ZPI18N.getString("zp.givevalidinp")).show();if(question.length>1e3)return revQuesName.trigger("focus").addClass("ztextbox__error"),void revQuesExistError.text(ZPI18N.getString("zp.fieldpropertymaxlength",[ZPeople.decodeTxt(PMSSetting.QUS_ANS_DISPLAY_NAME),"1000 characters"])).show();revQuesName.removeClass("ztextbox__error"),revQuesExistError.html("").hide();const params={mode:"addReviewQuestion",conreqcsr:csrfToken,compName:question};"editcomp"===mode&&void 0!==compId?params.recId=compId:mode="add";pageId.find("#sliderSbt").find("#addcompsubmit").attr("disabled",!0),ZPeople.Request.send("/performanceConfig.zp",params,PMSOperation.constructReviewQuestionsList,mode)},constructReviewQuestionsList:function(resultData,params,mode){if(compbrCls="#addcompsubmit","success"==resultData.msg){if(void 0!=resultData.reviewQuestions){if(!PMSOperation.isLibraryModalOpen&&void 0!=PMSOperation.sliderObj&&void 0!=PMSOperation.sliderObj.sliderDiv&&$(PMSOperation.sliderObj.sliderDiv).find("#reviewTypeselect").length>0){PMSOperation.allQuestion=void 0==PMSOperation.allQuestion?resultData.reviewQuestions:PMSOperation.allQuestion.concat(resultData.reviewQuestions);var arr=new Array;$.each(resultData.reviewQuestions,function(index,data){var temp={};temp.questionId=data.questionId,temp.question=data.question,arr.push(temp),PMSOperation.chooseConponentList.push(temp)}),PMSOperation.tagComponentChooselistConstruction(arr,"question",!0),PMSOperation.chooseSelectAllReset(),$(PMSOperation.sliderObj.sliderDiv).find("#csekralst").find("#emptPage").length>0&&$(PMSOperation.sliderObj.sliderDiv).find("#csekralst").html(""),$(PMSOperation.sliderObj.sliderDiv).find("#tagquestionlist").append(""),void 0==PMSOperation.kraaddmodal||jQuery.isEmptyObject(PMSOperation.kraaddmodal)||PMSOperation.kraaddmodal.close()}else void 0==PMSOperation.kraaddmodal||jQuery.isEmptyObject(PMSOperation.kraaddmodal)?(PMSOperation.allQuestion=resultData.reviewQuestions,0==PMSOperation.allQuestion.length&&PMSOperation.isLibraryModalOpen&&PMSOperation.libraryConstruction("REVQES",PMSOperation.allQuestion)):(PMSOperation.constructReviewQuestion(mode,resultData.reviewQuestions),PMSOperation.kraaddmodal.close());PMSOperation.getReviewQuestionMapping()}}else"Already_exists"==resultData.error?ZPeople.Message.failure(ZPI18N.getString("zp.duplicateSkill",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME==ZPI18N.getString("zp.questionnaire")?ZPI18N.getString("zp.reviewquestion"):PMSSetting.QUS_ANS_DISPLAY_NAME))):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},constructReviewQuestion:function(mode,reviewQuestions){void 0!=mode&&"add"==mode?(void 0==PMSOperation.allQuestion?PMSOperation.allQuestion=new Array(reviewQuestions[0]):PMSOperation.allQuestion.unshift(reviewQuestions[0]),ZPeople.Message.success(ZPI18N.getString("zp.added.successfully.msg",new Array(ZPI18N.getString("zp.question"))))):void 0!=mode&&"editcomp"==mode?(ZPeople.Message.success(ZPI18N.getString("zp.editedHoliday",new Array(ZPI18N.getString("zp.question")))),$.each(PMSOperation.allQuestion,function(index,data){data.questionId==reviewQuestions[0].questionId&&(PMSOperation.allQuestion[index].question=reviewQuestions[0].question,PMSOperation.allQuestion[index].desc=reviewQuestions[0].desc,PMSOperation.allQuestion[index].isactive=reviewQuestions[0].isactive)})):PMSOperation.allQuestion=reviewQuestions,(void 0!=PMSOperation.moduleLibraryslider||PMSOperation.isLibraryModalOpen)&&void 0!=PMSOperation.moduleLibraryslider&&PMSOperation.isLibraryModalOpen&&PMSOperation.libraryConstruction("REVQES",PMSOperation.allQuestion)},showeditReviewQuestion:function(compId,obj){$.each(PMSOperation.allQuestion,function(index,data){compId==data.questionId&&(PMSOperation.addKRAPopup(null,"REVQES",data.questionId),$(PMSOperation.kraaddmodal.sliderDiv).find("#revques_name").val(ZPeople.decodeTxt(data.question)))})},ReviewQuestiondel:function(mode,questionId){var sliderDiv=$(PMSOperation.moduleLibraryslider.sliderDiv);if("deloption"==mode){if(void 0!==questionId&&null!==questionId){var deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.common.entitydelete",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME)),deletePopUp.despcription=ZPI18N.getString("zp.pa.deletelibrecmsg",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME,PMSSetting.QUS_ANS_DISPLAY_NAME)),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){PMSOperation.ReviewQuestiondel("delconfirm",questionId)},deletePopUp.show()}}else if("delconfirm"==mode){var params={mode:"deleteReviewQuestion",conreqcsr:csrfToken};params.questionId=questionId,$.post("/performanceConfig.zp",params,function(resultData){void 0!=resultData[0].msg&&"success"==resultData[0].msg&&(sliderDiv.find("#librarylist").find("#REVQES_"+questionId).remove(),$.each(PMSOperation.allQuestion,function(index,data){void 0!==data&&questionId==data.questionId&&(PMSOperation.allQuestion.splice(index,1),sliderDiv.find("#modulelistcount").text(PMSOperation.allQuestion.length),0==PMSOperation.allQuestion.length?PMSOperation.libraryConstruction("REVQES",PMSOperation.allQuestion):0==sliderDiv.find("#librarylist").find(".zpl_catlst input").length&&PMSOperationCommon.setNoData(sliderDiv.find("#librarylist"),ZPI18N.getString("zp.pa.nodataadded",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME)),"no_data_found",null,ZPI18N.getString("zp.pa.tagreviewques",new Array(PMSSetting.QUS_ANS_DISPLAY_NAME)),null))}),ZPeople.Message.success(ZPI18N.getString("zp.deleted.successfully.msg",new Array(ZPI18N.getString("zp.question")))),PMSOperation.getReviewQuestionMapping())})}},deleteReviewQuestionmapping:function(mode,recId){var pageId=settingsPage.container;if("deloption"==mode){if(void 0!==recId&&null!==recId){var deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.assessment.question.delete.confirm"),deletePopUp.despcription=ZPI18N.getString("zp.deletequestionconfmsg"),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){PMSOperation.deleteReviewQuestionmapping("delconfirm",recId)},deletePopUp.show()}}else if("delconfirm"==mode){var params={mode:"deleteReviewQuestionmapping",recId:recId,conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){"success"==resultData.msg?(ZPeople.Message.success(ZPI18N.getString("zp.questionunmappedsucc",new Array(ZPI18N.getString("zp.question")))),pageId.find("#compmap_"+recId).remove(),PMSOperation.getReviewQuestionMapping()):ZPeople.Message.success(ZPI18N.getString("zp.sorryservererror"))})}},validateRuleObj:function(){var pageId=settingsPage.container,sliderDiv=$(PMSOperation.sliderObj.sliderDiv),dataObj=null,isChanged=!1;pageId.find("#desQuestion").is(":visible")?dataObj=PMSOperation.Designation_comp:pageId.find("#depQuestion").is(":visible")?dataObj=PMSOperation.Department_comp:pageId.find("#roleQuestion").is(":visible")?dataObj=PMSOperation.Role_comp:pageId.find("#locationQuestion").is(":visible")&&(dataObj=PMSOperation.Location_comp);var desId=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderDiv.find("#desDepRoleselect")).getAllValues()),reviewTypeselect=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(sliderDiv.find("#reviewTypeselect")).getAllValues());return $.each(dataObj,function(index,data){if(PMSOperation.editRevQuesRuleId==data.mapId){var keys=Object.keys(data.desDepval);return JSON.stringify(keys)!=JSON.stringify(desId)&&(isChanged=!0),JSON.stringify(data.type)!=JSON.stringify(reviewTypeselect)&&(isChanged=!0),!1}}),isChanged},initCyclePageLoadFile:function(){PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)&&Layout.PageUtil.loadFiles(["approvalv5.min.js"],PMSOperation.initCyclePageCheck)},initCyclePageCheck:function(){PMSOperation.skipHasChange?PMSOperation.skipHasChange=!1:void 0!=settingsUrlProps.urlParamsArr.reviewuser||void 0!=settingsUrlProps.urlParamsArr.configId||void 0!=settingsUrlProps.urlParamsArr.viewstatus?PMSV2Cycle.isCycleAddEditPageValueChangedInit(PMSOperation.initCyclePage,!1,"operations/performance/cycle",!0):PMSOperation.initCyclePage()},onClickAddCycle:function(){if("true"==PMSSetting.IS_CR_CYCLE_ENABLED){let pageId=settingsPage.container;var divId="addAppraisalCycleMenu";if(ZPeopleComponents.isComponent(pageId.find("#"+divId)))return void ZPeopleComponents.menu(pageId.find("#"+divId)).show();let options=[{id:"appraisalCycle",cycleType:PACycle.Constants.CYCLE_TYPE.APPRAISAL_CYCLE_TYPE,templateType:PACycle.Constants.CYCLE_TYPE.TEMPLATE_TYPE,label:ZPI18N.getString("zp.addappraisalcycle")},{id:"crBasedCycle",cycleType:PACycle.Constants.CYCLE_TYPE.CR_CYCLE_TYPE,templateType:PACycle.Constants.CYCLE_TYPE.CR_TEMPLATE_TYPE,label:ZPI18N.getString("zp.addCrbasedcycle")}],tokenObj={displayType:"callout",contentType:"text",forElement:pageId.find("#addAppSalCycle"),itemclick:event=>(PMSV2Cycle.addCycleType=event.detail.cycleType,PMSOperation.chooseTemplate()),show:()=>{pageId.find("#addAppSalCycle").removeAttr("onclick")},hide:()=>{pageId.find("#addAppSalCycle").attr("onclick","PMSOperation.onClickAddCycle();")},className:"zpl_drpdwn",appendTo:pageId};ZPeopleComponents.createMenu(divId,options,tokenObj),ZPeopleComponents.menu("#"+divId).show()}},initCyclePage:function(){var pageId=settingsPage.container;if(void 0!=settingsUrlProps.urlParamsArr.reviewuser)PATeamTabHandler.OpAppraisalReviewUserrHandleCallback();else if(void 0!=settingsUrlProps.urlParamsArr.viewstatus)PMSV2Cycle.openCycleViewStatusPage();else{if(SalaryHikeV2Cycle.isSalaryHikeCycle&&(PMSOperation.salaryHikeCycle=PMSOperation.temp,PMSOperation.temp=PMSOperation.appraisalCycle,PMSOperation.CY_FS_ST_IDX=PMSOperation.cyclelistTempSIndex,PMSOperation.cycleStatusObj=PMSOperation.cyclelistTempCycleStatusObj,PMSOperation.IS_ACTIVE_CYCLE_ONLY=PMSOperation.cyclelistTempIsActiveOnly),SalaryHikeV2Cycle.isSalaryHikeCycle=!1,PMSV2Cycle.IS_VIEW_STATUS_OPENED_FROM_CYCLELISTING=!1,null!=PMSV2Cycle.appStatusSliderObj&&void 0!=PMSV2Cycle.appStatusSliderObj&&0!=Object.keys(PMSV2Cycle.appStatusSliderObj).length&&PMSV2Cycle.appStatusSliderObj.closeCallback(),!PMSOperation.isCyclelistpageLoaded){PMSV2Cycle.destroyCyclePageComponents(),PMSOperationCommon.addClearCentreClass(!0),pageId.html(""),PMSOperation.getCycleTmplPage(),pageId.append(PMSOperation.CYCLE_LIST_TEMPLATE_PAGE);let cycleToggleFilter='<ul class="zpl_grpmnu" id="cycleListingStatus_Filter"><li id="activeCycle_toggle" status="1" class="zpl_act"><span>'+ZPI18N.getString("zp.activecycles")+'</span><div class="zpl_tg"><span id="activeCycleCount" count="0"><b></b></span></div></li><li id="completedCycle_toggle" status="2"><span>'+ZPI18N.getString("zp.completedcycles")+'</span><div class="zpl_tg"><span id="completedCycleCount" count="0"><b></b></span></div></li></ul>';pageId.find(".zpl_btnmnu .zpl_lft").html(cycleToggleFilter),PMSOperation.isCyclelistpageLoaded=!0}if(pageId.find("#chooseTemplateDiv").hide(),pageId.find("#cycleListDiv").show(),pageId.parents().find("#zp-contwrap-operations-performance-cycle").find("[name=lefttab]").removeClass("zpl_DNI"),PMSOperation.isCyclelistViewLoaded){let _mode=AppraisalView.constant.oprAppraisal;null!==AppraisalView[_mode].sel_configId&&(AppraisalView.cycleManageData[_mode].isAppraiserViewLoaded||AppraisalView[_mode].isListViewLoaded)&&(AppraisalView.manageAppraisal.showManageAppraiserDataurl(AppraisalView[_mode].sel_configId),AppraisalView[_mode].isListView?AppraisalView.setRefreshListView():AppraisalView.cycleManageData.setrefreshManageAppraisalData())}else{let _mode=AppraisalView.constant.oprAppraisal;null!==AppraisalView[_mode].sel_configId&&(AppraisalView.cycleManageData[_mode].isAppraiserViewLoaded||AppraisalView[_mode].isListViewLoaded)?(AppraisalView.manageAppraisal.showManageAppraiserDataurl(AppraisalView[_mode].sel_configId),AppraisalView[_mode].isListView?AppraisalView.setRefreshListView():AppraisalView.cycleManageData.setrefreshManageAppraisalData()):(PMSOperation.isCyclelistViewLoaded=!0,PMSOperation.cycleStatusObj={},PMSOperation.loadCycles())}}},toggleCycleStatusFun:function(){let pageId=settingsPage.container;pageId.find("#cycleListingStatus_Filter li").unbind(),pageId.find("#cycleListingStatus_Filter li").on("click",function(){pageId.find("#cycleListingStatus_Filter li").removeClass("zpl_act"),$(this).toggleClass("zpl_act"),"1"===$(this).attr("status")?(PMSOperation.IS_ACTIVE_CYCLE_ONLY=!0,pageId.find("#CompeletedCycleTableBody").addClass("zpl_DNI"),pageId.find("#cycleTableBody").removeClass("zpl_DNI")):(PMSOperation.IS_ACTIVE_CYCLE_ONLY=!1,pageId.find("#cycleTableBody").addClass("zpl_DNI"),pageId.find("#CompeletedCycleTableBody").removeClass("zpl_DNI")),PMSOperation.loadCycles()})},cyfireScrollCallBack:function(){let pageId=settingsPage.container;0===PMSOperation.cycleStatusObj.activeCycleCount||pageId.find("#cycleTableBody").children().length===PMSOperation.cycleStatusObj.activeCycleCount?pageId.find("#CompeletedCycleTableBody").append(ZPeople.LOADING_HTML):pageId.find("#cycleTableBody").append(ZPeople.LOADING_HTML);var params={mode:"nwCycleList",startIdx:PMSOperation.CY_FS_ST_IDX};params.isSalaryHikeCycle=SalaryHikeV2Cycle.isSalaryHikeCycle,params.isActiveCycle=PMSOperation.IS_ACTIVE_CYCLE_ONLY,params.isSalaryHikeCycle?params.searchText=pageId.find("#salaryCyclesearch").val():params.searchText=pageId.find("#apprCyclesearch").val(),pageId.find("#cycleListingStatus_Filter li").unbind(),ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){pageId.find("#cycleTableBody").find("#zp_page_loading").remove(),pageId.find("#CompeletedCycleTableBody").find("#zp_page_loading").remove(),PMSOperation.toggleCycleStatusFun(),void 0!==resultData&&(PMSOperation.CY_FS_ST_IDX=PMSOperation.CY_FS_ST_IDX+resultData.appConfList.length,PMSOperation.TEMP_EMP_DETAILS=resultData.empDetails,void 0!==resultData.appConfList[0].msg&&"No_records_Found"===resultData.appConfList[0].msg||(PMSOperation.temp=[...PMSOperation.temp,...resultData.appConfList],PMSOperation.IS_ACTIVE_CYCLE_ONLY?0!==PMSOperation.cycleStatusObj.activeCycleCount&&pageId.find("#cycleTableBody").children().length!==PMSOperation.cycleStatusObj.activeCycleCount&&(pageId.find("#cycleTableBody").append(PMSOperation.getAppraisalConfListTemplate(resultData.appConfList,!1)),pageId.find("#cycleTableBody").find("[hide=status_5]").hide()):(pageId.find("#CompeletedCycleTableBody").removeClass("zpl_DNI"),void 0!==PMSOperation.cycleStatusObj.completedCycleCount&&0!==PMSOperation.cycleStatusObj.completedCycleCount?(pageId.find("#CompeletedCycleTableBody").append(PMSOperation.getAppraisalConfListTemplate(resultData.appConfList,!0)),pageId.find("#CompeletedCycleTableBody").find("[hide=status_5]").hide()):PMSOperation.setNoDataForCycleListing(pageId,!0)),PMSOperation.setAppraisalConfProgress(resultData.appConfList),settingsPage.fireScrollObj.cyLstFS.reset()))})},loadCycles:function(isRefresh){let pageId=settingsPage.container;if(isRefresh){PMSOperationCommon.addClearCentreClass(!0),pageId.find("#cycleListingStatus_Filter li").unbind(),SalaryHikeV2Cycle.isSalaryHikeCycle?SalaryHikeV2Cycle.destroyCyclePageComponents():PMSV2Cycle.destroyCyclePageComponents(),pageId.html(""),PMSOperation.getCycleTmplPage(),pageId.append(PMSOperation.CYCLE_LIST_TEMPLATE_PAGE);let cycleToggleFilter='<ul class="zpl_grpmnu" id="cycleListingStatus_Filter"><li id="activeCycle_toggle" status="1"><span>'+ZPI18N.getString("zp.activecycles")+'</span><div class="zpl_tg"><span id="activeCycleCount" count="0"><b></b></span></div></li><li id="completedCycle_toggle" status="2"><span>'+ZPI18N.getString("zp.completedcycles")+'</span><div class="zpl_tg"><span id="completedCycleCount" count="0"><b></b></span></div></li></ul>';pageId.find(".zpl_btnmnu .zpl_lft").html(cycleToggleFilter)}pageId.find("#cycleTableBody").empty(),pageId.find("#CompeletedCycleTableBody").empty(),pageId.find("#activeCycleCountdiv").empty(),pageId.find(".zpl_btnmnu .zpl_lft #cycleListingStatus_Filter li").removeClass("zpl_act"),PMSOperation.IS_ACTIVE_CYCLE_ONLY?pageId.find("#activeCycle_toggle").toggleClass("zpl_act"):pageId.find("#completedCycle_toggle").toggleClass("zpl_act"),PMSOperation.IS_ACTIVE_CYCLE_ONLY?pageId.find("#cycleTableBody").append(ZPeople.LOADING_HTML):pageId.find("#CompeletedCycleTableBody").append(ZPeople.LOADING_HTML),pageId.find("#cycleListingStatus_Filter li").unbind(),PMSOperation.initialSort=!1,PMSOperation.CY_FS_ST_IDX=1;var params={mode:"nwCycleList",startIdx:0};params.isSalaryHikeCycle=SalaryHikeV2Cycle.isSalaryHikeCycle,params.isActiveCycle=PMSOperation.IS_ACTIVE_CYCLE_ONLY,params.isSalaryHikeCycle?params.searchText=pageId.find("#salaryCyclesearch").val():params.searchText=pageId.find("#apprCyclesearch").val(),ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){pageId.find("#cycleTableBody").find("#zp_page_loading").remove(),pageId.find("#CompeletedCycleTableBody").find("#zp_page_loading").remove(),PMSOperation.toggleCycleStatusFun(),void 0!=resultData&&resultData.hasOwnProperty("appConfList")&&(PMSOperation.cycleStatusObj={},PMSOperation.cycleStatusObj.activeCycleCount=resultData.activeCycleCount,PMSOperation.cycleStatusObj.completedCycleCount=resultData.completedCycleCount,void 0!==resultData.appConfList[0].msg&&"No_records_Found"===resultData.appConfList[0].msg?(PMSOperation.updateActiveCycleCount(pageId,void 0),PMSOperation.updateCompletedCycleCount(pageId,void 0),PMSOperation.setNoDataForCycleListing(pageId,!PMSOperation.IS_ACTIVE_CYCLE_ONLY)):(PMSOperation.TEMP_EMP_DETAILS=resultData.empDetails,PMSOperation.temp=resultData.appConfList,PMSOperation.CY_FS_ST_IDX=resultData.appConfList.length+1,PMSOperation.isCycleManageDataAllowed=void 0!=resultData.isAllowedToManageData&&resultData.isAllowedToManageData,PMSOperation.isAllowedToManageCycle=void 0!=resultData.isAllowedToManageAppraisal&&resultData.isAllowedToManageAppraisal,PMSOperation.isAllowedToCycleStatus=void 0!=resultData.isAllowedToCycleStatus&&resultData.isAllowedToCycleStatus,PMSOperation.constructAppraisalConfList(resultData.appConfList,pageId)))});new FireScrollBack(PMSOperation.cyfireScrollCallBack,pageId,"cyLstFS")},fetchConfigIDCycles:function(confId){var pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!0),pageId.find("#cycleListingStatus_Filter li").unbind(),pageId.html(""),PMSOperation.getCycleTmplPage(),pageId.append(PMSOperation.CYCLE_LIST_TEMPLATE_PAGE);let cycleToggleFilter='<ul class="zpl_grpmnu" id="cycleListingStatus_Filter"><li id="activeCycle_toggle" status="1"><span>'+ZPI18N.getString("zp.activecycles")+'</span><div class="zpl_tg"><span id="activeCycleCount" count="0"><b></b></span></div></li><li id="completedCycle_toggle" status="2"><span>'+ZPI18N.getString("zp.completedcycles")+'</span><div class="zpl_tg"><span id="completedCycleCount" count="0"><b></b></span></div></li></ul>';pageId.find(".zpl_btnmnu .zpl_lft").html(cycleToggleFilter),PMSOperation.IS_ACTIVE_CYCLE_ONLY?pageId.find("#activeCycle_toggle").toggleClass("zpl_act"):pageId.find("#completedCycle_toggle").toggleClass("zpl_act"),pageId.find("#chooseTemplateDiv").hide(),pageId.find("#cycleListDiv").show(),pageId.find("#cycleListingStatus_Filter li").unbind(),PMSOperation.initialSort=!1,PMSOperation.CY_FS_ST_IDX=1;var params={mode:"nwCycleList",startIdx:0,configId:confId};params.isSalaryHikeCycle=SalaryHikeV2Cycle.isSalaryHikeCycle,params.isActiveCycle=PMSOperation.IS_ACTIVE_CYCLE_ONLY,ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){if(PMSOperation.toggleCycleStatusFun(),void 0!==resultData){if(PMSOperation.TEMP_EMP_DETAILS=resultData.empDetails,pageId.find("#cycleTableBody").empty(),pageId.find("#CompeletedCycleTableBody").empty(),pageId.find("#CompeletedCycleTableBody").addClass("zpl_DNI"),PMSV2Cycle.EDIT_CYCLE_FLAG&&!PMSV2Cycle.CLONE_CYCLE_FLAG){const selectedIndex=PMSOperation.temp.findIndex(obj=>obj.configId===confId);-1!==selectedIndex&&PMSOperation.temp.splice(selectedIndex,1,resultData.appConfList[0])}else PMSOperation.temp.unshift(resultData.appConfList[0]);PMSOperation.CY_FS_ST_IDX=PMSOperation.temp.length+1,PMSOperation.isCycleManageDataAllowed=void 0!=resultData.isAllowedToManageData&&resultData.isAllowedToManageData,PMSOperation.isAllowedToManageCycle=void 0!=resultData.isAllowedToManageAppraisal&&resultData.isAllowedToManageAppraisal,PMSOperation.isAllowedToCycleStatus=void 0!=resultData.isAllowedToCycleStatus&&resultData.isAllowedToCycleStatus,void 0!=resultData.activeCycleCount&&(PMSOperation.cycleStatusObj.activeCycleCount=resultData.activeCycleCount,PMSOperation.cycleStatusObj.completedCycleCount=resultData.completedCycleCount),PMSOperation.constructAppraisalConfList(PMSOperation.temp,pageId)}});new FireScrollBack(PMSOperation.cyfireScrollCallBack,pageId,"cyLstFS")},searchAppraisalCycles:function(obj){SalaryHikeV2Cycle.isSalaryHikeCycle?paCommonUtil.validateSearch(obj,"SalaryCycle",PMSOperation.appraisalCycleSearchCallback,!0):paCommonUtil.validateSearch(obj,"AppraisalCycle",PMSOperation.appraisalCycleSearchCallback,!0)},appraisalCycleSearchCallback:function(){SalaryHikeV2Cycle.isSalaryHikeCycle?PMSOperation.SALARY_CYCLE_PREV_SEARCHTEXT=Layout.Page.container.find("#salaryCyclesearch").val():PMSOperation.APPRAISAL_CYCLE_PREV_SEARCHTEXT=Layout.Page.container.find("#apprCyclesearch").val(),PMSOperation.loadCycles()},sortappname:function(obj){if(0==PMSOperation.initialSort){$(obj).removeClass().addClass("PI_sort asc"),PMSOperation.temp.sort(function(x,y){return x.periodName==y.periodName?0:x.periodName<y.periodName?1:-1}),PMSOperation.initialSort=!0}else{$(obj).removeClass().addClass("PI_sort desc"),PMSOperation.temp.sort(function(x,y){return x.periodName==y.periodName?0:x.periodName>y.periodName?1:-1}),PMSOperation.initialSort=!1}PMSOperation.constructAppraisalConfList(PMSOperation.temp)},sortstatus:function(obj){if("d"===PMSOperation.CYCLE_SORTSTATUS){$(obj).removeClass().addClass("PI_sort asc"),PMSOperation.CYCLE_SORTSTATUS="u",PMSOperation.temp.sort(function(x,y){return x.periodStatus==y.periodStatus?0:x.periodStatus<y.periodStatus?1:-1})}else if("u"===PMSOperation.CYCLE_SORTSTATUS){$(obj).removeClass().addClass("PI_sort desc"),PMSOperation.CYCLE_SORTSTATUS="d",PMSOperation.temp.sort(function(x,y){return x.periodStatus==y.periodStatus?0:x.periodStatus>y.periodStatus?1:-1})}PMSOperation.constructAppraisalConfList(PMSOperation.temp)},sortperiod:function(obj){if("d"===PMSOperation.CYCLE_SORTPERIOD){$(obj).removeClass().addClass("PI_sort asc"),PMSOperation.CYCLE_SORTPERIOD="u",PMSOperation.temp.sort(function(x,y){var xdate=Calendar.parseDate(x.createtime,uidateFormat),ydate=Calendar.parseDate(y.createtime,uidateFormat);return xdate==ydate?0:xdate<ydate?1:-1})}else if("u"===PMSOperation.CYCLE_SORTPERIOD){$(obj).removeClass().addClass("PI_sort desc"),PMSOperation.CYCLE_SORTPERIOD="d",PMSOperation.temp.sort(function(x,y){var xdate=Calendar.parseDate(x.createtime,uidateFormat),ydate=Calendar.parseDate(y.createtime,uidateFormat);return xdate==ydate?0:xdate>ydate?1:-1})}PMSOperation.constructAppraisalConfList(PMSOperation.temp)},updateActiveCycleCount:function(container,updateType){void 0==container&&(container=settingsPage.container),void 0===PMSOperation.cycleStatusObj.activeCycleCount?PMSOperation.cycleStatusObj.activeCycleCount=0:void 0!==updateType&&("subtract"===updateType?PMSOperation.cycleStatusObj.activeCycleCount>1?PMSOperation.cycleStatusObj.activeCycleCount=PMSOperation.cycleStatusObj.activeCycleCount-1:PMSOperation.cycleStatusObj.activeCycleCount=0:"Add"===updateType&&(PMSOperation.cycleStatusObj.activeCycleCount=PMSOperation.cycleStatusObj.activeCycleCount+1)),container.find("#activeCycleCount b").html(PMSOperation.cycleStatusObj.activeCycleCount),container.find("#activeCycleCount").attr("count",PMSOperation.cycleStatusObj.activeCycleCount)},updateCompletedCycleCount:function(container,updateType){void 0==container&&(container=settingsPage.container),void 0===PMSOperation.cycleStatusObj.completedCycleCount?PMSOperation.cycleStatusObj.completedCycleCount=0:void 0!==updateType&&("subtract"===updateType?PMSOperation.cycleStatusObj.completedCycleCount>1?PMSOperation.cycleStatusObj.completedCycleCount=PMSOperation.cycleStatusObj.completedCycleCount-1:PMSOperation.cycleStatusObj.completedCycleCount=0:"Add"===updateType&&(PMSOperation.cycleStatusObj.completedCycleCount=PMSOperation.cycleStatusObj.completedCycleCount+1)),container.find("#completedCycleCount b").html(PMSOperation.cycleStatusObj.completedCycleCount),container.find("#completedCycleCount").attr("count",PMSOperation.cycleStatusObj.completedCycleCount)},setNoDataForCycleListing:function(container,isCompletdCycle){void 0==container&&(container=settingsPage.container);let statusMsg="zp.activesmall",cycleStatusModeId="cycleTableBody";isCompletdCycle&&(container.find("#CompeletedCycleTableBody [id^=appraisal_row_]").remove(),cycleStatusModeId="CompeletedCycleTableBody",statusMsg="zp.completedsmall");let cycName=SalaryHikeV2Cycle.isSalaryHikeCycle?PMSV2Cycle.SALARYHIKENAME:ZPI18N.getString("zp.smallappraisal");container.find("#"+cycleStatusModeId+" #emptPage").remove(),PMSOperationCommon.setNoData(container.find("#"+cycleStatusModeId),ZPI18N.getString("zp.cycle.noCyclesatthemoment",new Array(ZPI18N.getString(statusMsg),cycName)),"no_data_found",null,null,null,!isCompletdCycle),container.find("#"+cycleStatusModeId+" #emptPage").attr("style","max-width: none;")},constructAppraisalConfList:function(resultData,container){void 0==container&&(container=settingsPage.container),PMSOperation.updateActiveCycleCount(container,void 0),PMSOperation.updateCompletedCycleCount(container,void 0),PMSOperation.IS_ACTIVE_CYCLE_ONLY?void 0!==PMSOperation.cycleStatusObj.activeCycleCount&&0!==PMSOperation.cycleStatusObj.activeCycleCount?(container.find("#cycleTableBody").html(PMSOperation.getAppraisalConfListTemplate(resultData,!1)),container.find("#cycleTableBody").find("[hide=status_5]").hide()):PMSOperation.setNoDataForCycleListing(container,!1):(container.find("#CompeletedCycleTableBody").removeClass("zpl_DNI"),void 0!==PMSOperation.cycleStatusObj.completedCycleCount&&0!==PMSOperation.cycleStatusObj.completedCycleCount?(container.find("#CompeletedCycleTableBody").append(PMSOperation.getAppraisalConfListTemplate(resultData,!0)),container.find("#CompeletedCycleTableBody").find("[hide=status_5]").hide()):PMSOperation.setNoDataForCycleListing(container,!0)),PMSOperation.setAppraisalConfProgress(resultData),ZPeopleComponents.tooltip(container.find("#cycleTableBody"),{}),ZPeopleComponents.tooltip(container.find("#CompeletedCycleTableBody"),{})},setAppraisalConfProgress:function(appConfList){var pageId=settingsPage.container;$.each(appConfList,function(){var id="progressImg_"+this.configId;pageId.find("#"+id).length>0&&(ZPeopleComponents.progresswheel(pageId.find("#"+id)).destroy(),ZPeopleComponents.progresswheel("#"+id,{statusMessage:{text:pageId.find("#"+id).attr("data-value")+"%",position:"center"}}))})},getAppraisalConfListTemplate:function(appConfList,isCompletedCycle){settingsPage.container;var row="";return PMSV2Cycle.getHikeTerms(),$.each(appConfList,function(){let tOwner=this.ownerErecno,ownerDt="";if(void 0!==PMSOperation.TEMP_EMP_DETAILS&&Object.keys(PMSOperation.TEMP_EMP_DETAILS).length>0&&(ownerDt=""===(ownerDt=void 0!==PMSOperation.TEMP_EMP_DETAILS[tOwner]?PMSOperation.TEMP_EMP_DETAILS[tOwner].personalDetails:"")?"":ZPI18N.getString("zp.createdby",[ownerDt.html])),5===this.periodStatus&&isCompletedCycle||5!==this.periodStatus&&!isCompletedCycle){row+='<div class="zpl_catlst" id="appraisal_row_'+this.configId+'" configid="'+this.configId+'" cycleType="'+this.cycleType+'"><div class="zpl_catlsthdr">',row+='<div class="zpl_catlstlft"><h5>'+(void 0!=this.periodName&&"null"!=this.periodName?this.periodName:"&nbsp;-&nbsp")+'<i id="cycAddDet" class="PI_info" title="'+ownerDt+'"></i></h5> <p>'+ZPI18N.getString("zp.evaluationperiod")+"<b> "+this.cyclefromdate+" "+ZPI18N.getString("zp.sto")+" "+this.cycletoDate+"</b></p></div>",row+='<div class="zpl_catlstcntr zpl_pacylesrate">';let percentage=0;void 0!=this.completedPercent&&this.completedPercent>0&&(percentage=this.completedPercent),row+='<div id="progressImg_'+this.configId+'" data-size="large" data-value="'+percentage+'" title="'+percentage+"% "+ZPI18N.getString("zp.completed")+'"></div>',row+='<div class="d-flexclmcap10 flex-dirC"><div>'+ZPI18N.getString("zp.totalappraisee")+' <b id="AppraiseeCount_'+this.configId+'">'+(void 0!=this.appraiseeCnt?this.appraiseeCnt:"0")+'</b></div></div></div> <div class="zpl_catlstrgt align-self-cntr" '+(this.cycleType===PACycle.Constants.CYCLE_TYPE.CR_CYCLE_TYPE?'style="flex-direction: column;align-items: flex-end;"':"")+">",this.cycleType===PACycle.Constants.CYCLE_TYPE.CR_CYCLE_TYPE&&(row+='<span class="ylw ylwbdrbglit zpl_tg zpl_ylwlit"><span style="min-inline-size: 230px;" title="'+ZPI18N.getString("zp.crbasedcycle")+'">'+ZPI18N.getString("zp.crbasedcycle")+"</span></span>"),PMSOperation.isAllowedToCycleStatus&&(-1==this.periodStatus?SalaryHikeV2Cycle.isSalaryHikeCycle?row+='<button onclick=SalaryHikeV2Cycle.startSalHikeCycleProcess(this); type="button" class="zlabel zlabel--blue zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.startcycle")+"</button>":row+="<button onclick=PMSOperation.startCycleCmf(this,'"+this.appraiseeCnt+"','"+this.configId+'\'); type="button" class="zlabel zlabel--blue zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.startcycle")+"</button>":row+="<a onclick=\"PMSV2Cycle.openViewStatus('"+this.configId+"','"+this.periodStatus+"');\">"+ZPI18N.getString("zp.viewcyclestatus")+"</a>"),row+='</div></div><div class="zpl_catlstfdr">',row+="<div><p>"+ZPI18N.getString("zp.createon")+" "+this.createtime+"</p></div>",row+='<div class="zpl_catlstrgt"><ul class="zpl_lstbdrlne">',!PMSOperation.isCycleManageDataAllowed||0!==this.periodStatus&&1!==this.periodStatus&&-2!==this.periodStatus&&2!=this.periodStatus&&4!=this.periodStatus&&5!==this.periodStatus||(this.salaryHikeEnabled&&(row+=" <li onclick=\"PMSCycleManageData.salaryHikeCycle.showSalaryHikeManageData('"+this.configId+'\')"><a><i class="PI_user1"></i><span class="zpl_ellipsis" style="max-width: 200px !important;" title="'+ZPI18N.getString("zp.managesalaryhike",[PMSV2Cycle.SALARYHIKENAME])+'">'+ZPI18N.getString("zp.managesalaryhike",[PMSV2Cycle.SALARYHIKENAME])+"</span></a></li>"),SalaryHikeV2Cycle.isSalaryHikeCycle||isSanmarUI||(row+=" <li onclick=\"AppraisalView.manageAppraisal.showManageAppraiserDataurl('"+this.configId+'\')"><a><i class="PI_user1"></i>'+ZPI18N.getString("zp.manageappraisal")+"</a></li>")),PMSOperation.isAllowedToManageCycle&&(row+=" <li onclick=\"PMSOperation.showUserManagement('userManagement','"+this.configId+"',undefined,undefined,'"+this.periodStatus+'\')"><a><i class="PI_mngap"></i> '+ZPI18N.getString("zp.manageuser")+"</a></li>",SalaryHikeV2Cycle.isSalaryHikeCycle?(row+=" <li onclick=\"SalaryHikeV2Cycle.showEditSalaryCycleConfiguration('"+this.configId+"','clone');\"><a><i class=\"PI_clone\"></i>  "+ZPI18N.getString("zp.clone")+"</a></li>",row+=' <li hide="status_'+this.periodStatus+'" onclick="SalaryHikeV2Cycle.showEditSalaryCycleConfiguration(\''+this.configId+"','edit');\"><a><i class=\"PI_edt\"></i>"+ZPI18N.getString("zp.advan.editconfig")+"</a></li>"):(this.cycleType===PACycle.Constants.CYCLE_TYPE.CR_CYCLE_TYPE?"true"==PMSSetting.IS_CR_CYCLE_ENABLED&&(row+=' <li onclick="PMSOperation.cloneCycle(this);"><a><i class="PI_clone"></i> '+ZPI18N.getString("zp.clone")+"</a></li>"):row+=' <li onclick="PMSOperation.cloneCycle(this);"><a><i class="PI_clone"></i> '+ZPI18N.getString("zp.clone")+"</a></li>",row+=' <li hide="status_'+this.periodStatus+'" onclick="PMSOperation.showEditCycleConfiguration(this);"><a><i class="PI_edt"></i> '+ZPI18N.getString("zp.advan.editconfig")+"</a></li>"),row+=' <li onclick="PMSOperation.deleteCycleConfirm(this);"><a><i class="PI_delete"></i></a></li>'),row+=" </ul></div></div></div>"}}),row},startCycleCmf:function(obj,cnt,cycleId,extrvar){cnt=void 0!=cnt?cnt:0;var popupTab=new Tab("cycleStartDiv",function(){let stPopdiv='<div class="zpl_mb2 zpl_ma0"><sapn>'+ZPI18N.getString("zp.cycstinfo4")+"</sapn></div>";stPopdiv+='<div class="zpl_crdlst zpl_crdlstvw">',stPopdiv+='<div class="zpl_catlst" ><span class="PI_aplcablity icn zpl_seclr3"></span><div><p>'+ZPI18N.getString("zp.cycstinfo3")+"</p></div></div>",stPopdiv+='<div class="zpl_catlst" ><span class="PI_mail_to_us icn zpl_seclr9"></span><div><p>'+ZPI18N.getString("zp.cycstinfo1")+"</p></div></div>",stPopdiv+='<div class="zpl_catlst" ><span class="PI_star_line icn zpl_seclr5"></span><div><p>'+ZPI18N.getString("zp.cycstinfo2")+"</p></div></div>",stPopdiv+="</div>",PMSOperation.StartPopup.sliderDiv.find("#cardcycleStartDiv").append(stPopdiv)},function(){PMSOperation.startCycle(obj)});PMSOperation.StartPopup=new popupModal(ZPI18N.getString("zp.cycstinfo5"),popupTab),PMSOperation.StartPopup.save=ZPI18N.getString("zp.yeProd"),PMSOperation.StartPopup.setCloseCallback(function(){PMSOperation.StartPopup.remove(),PMSOperation.StartPopup={}}),PMSOperation.StartPopup.construct()},startCycle:function(obj){let confId=$(obj).parents(".zpl_catlst").attr("configid");PMSOperation.StartPopup.sliderDiv.find("#sliderSbt").addClass("disabled");var params={mode:"getBudgetDetailsByConfigID",configID:confId};ZPeople.Request.send("/performanceConfig.zp",params,function(data){let salDataAvlFlg=!0;(PMSOperation.StartPopup.remove(),PMSOperation.StartPopup={},data.isBudgetEnable)?"SUCCESS"===data.status?-1===data.configDetails.status&&data.salaryNotAvailable.length>0?(PMSV2Cycle.showSalaryNotAvailableModal(data),salDataAvlFlg=!1):salDataAvlFlg=!0:salDataAvlFlg=!1:salDataAvlFlg=!0;if(salDataAvlFlg)if($(obj).prop("disabled",!0),void 0!==confId&&null!==confId&&""!=confId){var params={mode:"prepopulate",configId:confId,conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){$(obj).prop("disabled",!1);var parseObj=resultData;parseObj.length>0&&$.each(parseObj,function(index,data){if("nousers"===data.msg)ZPeople.Message.warning(ZPI18N.getString("zp.nousersinconfig"));else if("permission denied"===data.msg)ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied"));else if("error"===data.msg)ZPeople.Message.failure(ZPI18N.getString("zp.errorinaddingconfig"));else if(void 0!==data.msg&&"success"==data.msg)PMSOperation.loadCycles(),ZPeople.Message.success(ZPI18N.getString("zp.startedsuccess"));else if("BUDGET_NOT_MAPPED"===data.msg)ZPeople.Message.warning(ZPI18N.getString("zp.budgetnotmapped",[PMSV2Cycle.HIKENAME]));else if("BUDGET_NOT_APPROVED"===data.msg){var statusMsg="-1"===data.budgetApprovalStatus?ZPI18N.getString("zp.pending"):"0"===data.budgetApprovalStatus?ZPI18N.getString("zp.rejected"):ZPI18N.getString("zp.nostatus");ZPeople.Message.warning(ZPI18N.getString("zp.budgetstatus",[statusMsg]))}else"BUDGET_CURRENCY_NOT_CONFIGURED"===data.msg?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.performance.applicablecurrencynotconfigured")):"COMPENSATION_DISABLED"===data.msg?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.performance.addconfigcompensationdisabled")):"COMPENSATION_SALARY_DISABLED"===data.msg?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.performance.addconfigcompensationsalarydisable")):"HIKE_PERIOD_EMPTY"===data.msg?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.providehikeperiod")):"NORMALIZATION_BEFORE_HIKEPERIOD"===data.msg&&ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.normalizationStartbeforehikePeriod",[PMSV2Cycle.HIKENAME]))})})}else ZPeople.Message.failure(ZPI18N.getString("zp.datanotpopulated"))})},showUserManagement:function(id,confId,fetFrmDt,fetToD,status){const pageId=settingsPage.container;if("userManagement"===id){const appraisalOperationSetting=PMSOperation;if(appraisalOperationSetting.appraiseeArr=[],$(appraisalOperationSetting.manageAppraiseeSliderObj.sliderDiv).length>0&&$(appraisalOperationSetting.manageAppraiseeSliderObj.sliderDiv).find("#emp_search, #designation_search, #dept_search, #loct_search,#level_search").each(function(){$(this).is("#emp_search")&&ZPeopleComponents.isComponent($(this))?ZPeopleComponents.tokenfield($(this)).destroy():ZPeopleComponents.isComponent($(this))&&ZPeopleComponents.select($(this)).destroy()}),0==$("#cardappraisalemptagslider").length){const sliderTab=new Tab("appraisalemptagslider",function(){$("#cardappraisalemptagslider").append(ZPeople.LOADING_HTML),$.ajax({type:"POST",async:!1,url:"/performance/view/manageAppraiseePage",data:{conreqcsr:csrfToken},success:function(resultData){$("#cardappraisalemptagslider").html(resultData),$("#cardappraisalemptagslider").find("#includeEmployeeTitle").toggle(5!=status)}})});appraisalOperationSetting.manageAppraiseeSliderObj=new sliderModal(ZPI18N.getString("zp.local.AppraiseeList"),sliderTab),appraisalOperationSetting.manageAppraiseeSliderObj.largeSize=!0,appraisalOperationSetting.manageAppraiseeSliderObj.setCloseCallback(function(){PMSOperation.getUpdatedStatusCountForCycle(appraisalOperationSetting.manageAppraiseeSliderObj.configId);const _sliderDiv=$(appraisalOperationSetting.manageAppraiseeSliderObj.sliderDiv);$(_sliderDiv).find("#emp_search, #designation_search, #dept_search, #loct_search,#level_search").each(function(){$(this).is("#emp_search")&&ZPeopleComponents.isComponent($(this))?ZPeopleComponents.tokenfield($(this)).destroy():ZPeopleComponents.isComponent($(this))&&ZPeopleComponents.select($(this)).destroy()}),appraisalOperationSetting.manageAppraiseeSliderObj.remove(),appraisalOperationSetting.manageAppraiseeSliderObj={},appraisalOperationSetting.startIndex=1}),appraisalOperationSetting.manageAppraiseeSliderObj.construct();var mapMenu=ZPeopleComponents.menu("#menuiconimpexpmanageuser",{forElement:pageId.find("#menuiconimpexpmanageuserbtn"),className:"",itemclick:event=>{"zp_manageuser_exp"==event.detail.id?PMSCommon.Export.showExportPopup(PMSOperation.appraisalCycleEmployeeExport,"appraisalEmployees"):"zp_manageuser_imp"==event.detail.id&&PMSImport.showAppraiseeimportPage()}});pageId.find("#menuiconimpexpmanageuserbtn").on("click",function(ev){mapMenu.show()}),appraisalOperationSetting.manageAppraiseeSliderObj.configId=confId,appraisalOperationSetting.isGroupByOrder=null;let sliderDiv=$(appraisalOperationSetting.manageAppraiseeSliderObj.sliderDiv);sliderDiv.find("#sliderSbt").remove(),sliderDiv.find("#sliderCancel").text(ZPI18N.getString("zp.close")),sliderDiv.find("#ma_filter_search").on("click",PMSOperation.showAppraisalUserList),sliderDiv.find("#ma_filter_reset").on("click",PMSOperation.resetManageAppraisee),sliderDiv.find("#ma_fltr_clearall").on("click",function(){sliderDiv.find("#appraiseeListUpdate").removeClass("opn"),PMSOperation.resetManageAppraisee(),PMSOperation.showAppraisalUserList()})}let valdata="";const sliderObj=$(appraisalOperationSetting.manageAppraiseeSliderObj.sliderDiv);sliderObj.find("#userManagementDivTable").html(ZPeople.LOADING_HTML),void 0!=confId&&-1!=confId?$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"appraisalCycleDetails",conreqcsr:csrfToken,configId:confId},success:function(data){void 0!==(valdata=data)&&null!==valdata&&($(sliderObj).find("#appraisalstatus").val(valdata.periodStatus),$(sliderObj).find("#configId").val(valdata.configId),$(sliderObj).find("#cyclePeriod").text(ZPeople.decodeTxt(valdata.periodName)),$(sliderObj).find("#config_duration").html(valdata.periodStart+"&nbsp; - &nbsp;"+valdata.periodEnd),-1===valdata.periodStatus&&(sliderObj.find("#reviewerstatus").hide(),sliderObj.find("#zp_view_sortingbtn").hide()),appraisalOperationSetting.isSelfAppraisalEnabled=valdata.isSelfAppraisalEnabled,appraisalOperationSetting.isMultiRaterEnabled=valdata.multiRaterEnabled,appraisalOperationSetting.isHikeEnabled=valdata.budgetEnable,setTimeout(function(){appraisalOperationSetting.onloadshowAppraisalUserList(!0)},100))}}):(sliderObj.find("#userManagementDivTable").html(ZPeople.LOADING_HTML),appraisalOperationSetting.onloadshowAppraisalUserList(!0))}else if("includeEmployeeDivTable"==id){if(PMSOperation.nonAppraiseeList=[],PMSOperation.tempNonAppraiseeList=[],PMSOperation.nonAppraiseeListSIndex=1,0==Object.keys(PMSOperation.includeEmpSliderObj).length){const sliderTab=new Tab("includeEmployeeList",function(){var _htm='<div class="zpl_btnmnu"><div class="search-cmn"> <i class="PI_lens"  title="'+ZPI18N.getString("zp.search")+'"></i>';_htm+='<input type="text" class="ztextbox" id="notAppSerachEmployee" placeholder="'+ZPI18N.getString("zp.searchdata")+'" onkeyup="PMSOperation.searchNotApplicableEmployees(this)"> <i class="PI_cls" onclick="PMSOperation.clssearch(\'noAppEmp\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div>',_htm+='<div class="actn_ovrly" style="z-index: 6;" id="includeuserMultiActionDiv"> <div><button class="zlabel  zlabel--blue zlabel--outline zlabel--medium" onclick="PMSOperation.includeUsertoCycle()">'+ZPI18N.getString("zp.include")+'</button> </div> <i class="PI_cls" onclick="PMSOperation.removeAllIncludeUserMultiDeleteAction(\'CycleAppEmp\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div>',_htm+='<div class="zpl_rgt"><i class="zpl_ibg PI_lens" onclick="PMSOperation.opnsearch(\'noAppEmp\')" title="'+ZPI18N.getString("zp.search")+'"></i></div> </div>',_htm+='<div class="zpl_tblres"><table class="zpl_tbl wd100_per" id="cna-employees"></table></div>',$("#cardincludeEmployeeList").html(_htm),$("#cna-employees").html(ZPeople.LOADING_HTML)});PMSOperation.includeEmpSliderObj=new sliderModal(ZPI18N.getString("zp.nonApplicableEmp"),sliderTab),PMSOperation.includeEmpSliderObj.setCloseCallback(function(){PMSOperation.includeEmpSliderObj.remove(),PMSOperation.includeEmpSliderObj={};const _mSliderDiv=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv);PMSOperation.nonAppraiseeList=[],PMSOperation.nonAppraiseeDataList={},PMSOperation.tempNonAppraiseeList=[],_mSliderDiv.find("#userManagementDivTable").html(ZPeople.LOADING_HTML),PMSOperation.closeIncludeEmpModal(_mSliderDiv.find("#configId").val())}),PMSOperation.includeEmpSliderObj.construct(),PMSOperation.includeEmpSliderObj.open(),$(PMSOperation.includeEmpSliderObj.sliderDiv).find("#sliderSbt").remove(),$(PMSOperation.includeEmpSliderObj.sliderDiv).find("#sliderCancel").text(ZPI18N.getString("zp.close"))}else $(PMSOperation.includeEmpSliderObj.sliderDiv).find("#includeEmpTab").empty();setTimeout(function(){PMSOperation.constructIncludeEmployeeDiv()},100)}else if("includeCREmployeeDivTable"==id){var sliderTab=new Tab("manageEREmployeeList",function(){});PMSOperation.crManageEmpSliderObj=new sliderModal(ZPI18N.getString("zp.local.ManageApplicability"),sliderTab),PMSOperation.crManageEmpSliderObj.mediumSize=!0,PMSOperation.crManageEmpSliderObj.ftExtraCls="DN",PMSOperation.crManageEmpSliderObj.setCloseCallback(function(){PMSOperation.crManageEmpSliderObj.remove(),PMSOperation.crManageEmpSliderObj={},PMSOperation.CR.initContinuousReview()}),PMSOperation.crManageEmpSliderObj.construct(),$(PMSOperation.crManageEmpSliderObj.sliderDiv).find("h4").parent().addClass("d-flexC j-cnt-btwen"),$('<div class="zpl_mhderrgt"><a class="zlabel zlabel--blue zlabel--outline zlabel--medium " onclick=" PMSOperation.showCRIncludeEmp()">'+ZPI18N.getString("zp.includeemployee")+"</a></div>").insertBefore(PMSOperation.crManageEmpSliderObj.sliderDiv.find("#sliderCls")),PMSOperation.applicableUserView()}else if("compensationsalaryhikestatus"==id){if(0==Object.keys(PMSOperation.salHikeStatusEmpSliderObj).length){sliderTab=new Tab("compSalHikeStatus",function(){var _htm=' <div class="zpl_tblres"><table class="zpl_tbl wd100_per">';_htm+="<thead><tr>",_htm+='<th></th><th width="350"></th></tr></thead>',_htm+='<tbody id="compSalHikeStatus"></tbody></table></div>',$("#cardcompSalHikeStatus").html(_htm)});PMSOperation.salHikeStatusEmpSliderObj=new sliderModal(ZPI18N.getString("zp.performance.hikeprocessstatus"),sliderTab),PMSOperation.salHikeStatusEmpSliderObj.ftExtraCls="DN",PMSOperation.salHikeStatusEmpSliderObj.setCloseCallback(function(){PMSOperation.salHikeStatusEmpSliderObj.remove(),PMSOperation.salHikeStatusEmpSliderObj={}}),PMSOperation.salHikeStatusEmpSliderObj.construct()}PMSOperation.compSalHikeSIndex=1,PMSOperation.constructCompSalHikeStatus()}},appraisalCycleEmployeeExport:function(){var popCont=$(PMSCommon.Export.EXPACK_MODAL.sliderDiv);let searchParams={empObj:[],deptval:[],desival:[],lvlval:[],loctval:[]};const _sliderDiv=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv);ZPeopleComponents.isComponent($(_sliderDiv).find("#emp_search"))&&void 0!==ZPeopleComponents.tokenfield($(_sliderDiv).find("#emp_search")).getAllValues()&&"-1"!=ZPeopleComponents.tokenfield($(_sliderDiv).find("#emp_search")).getAllValues()[0]&&(searchParams.empObj=ZPeopleComponents.tokenfield($(_sliderDiv).find("#emp_search")).getAllValues());var depSearch=$(_sliderDiv).find("#dept_search");if(ZPeopleComponents.isComponent(depSearch)&&void 0!==ZPeopleComponents.select(depSearch).getValues()){var depArr=0==ZPeopleComponents.select(depSearch).getValues().length?["-1"]:ZPeopleComponents.select(depSearch).getValues();searchParams.deptval=depArr}var desSearch=$(_sliderDiv).find("#designation_search");if(ZPeopleComponents.isComponent(desSearch)&&void 0!==ZPeopleComponents.select(desSearch).getValues()){var desArr=0==ZPeopleComponents.select(desSearch).getValues().length?["-1"]:ZPeopleComponents.select(desSearch).getValues();searchParams.desival=desArr}var levelSearch=$(_sliderDiv).find("#level_search");if(levelSearch.length>0&&ZPeopleComponents.isComponent(levelSearch)){var levelValues=ZPeopleComponents.select(levelSearch).getValues();if(void 0!==levelValues){var lvlArr=0==levelValues.length?["-1"]:levelValues;searchParams.lvlval=lvlArr}}var loctSearch=$(_sliderDiv).find("#loct_search");if(ZPeopleComponents.isComponent(loctSearch)&&void 0!==ZPeopleComponents.select(loctSearch).getValues()){var locArr=0==ZPeopleComponents.select(loctSearch).getValues().length?["-1"]:ZPeopleComponents.select(loctSearch).getValues();searchParams.loctval=locArr}var ftype=popCont.find("input[name=zp_ftype]:checked").val(),formObj=$("#zp_appraisalCycleEmp_Export").html("");formObj.append('<input type="hidden" value="'+ftype+'" name="ftype"/>'),formObj.append('<input type="hidden" value="'+csrfToken+'" name="'+csrfParamName+'"/>'),formObj.append('<input type="hidden" value="appraisalCycleEmployees" name="submode"/>'),formObj.append('<input type="hidden" value="'+$(PMSOperation.manageAppraiseeSliderObj.sliderDiv).find("#configId").val()+'" name="configId"/>'),searchParams.empObj.length>0&&formObj.append('<input type="hidden" value=\''+JSON.stringify(searchParams.empObj)+'\' name="employeeArr"/>'),searchParams.loctval.length>0&&formObj.append('<input type="hidden" value=\''+JSON.stringify(searchParams.loctval)+'\' name="locationArr"/>'),searchParams.deptval.length>0&&formObj.append('<input type="hidden" value=\''+JSON.stringify(searchParams.deptval)+'\' name="departmentArr"/>'),searchParams.desival.length>0&&formObj.append('<input type="hidden" value=\''+JSON.stringify(searchParams.desival)+'\' name="designationArr"/>'),searchParams.lvlval.length>0&&formObj.append('<input type="hidden" value=\''+JSON.stringify(searchParams.lvlval)+'\' name="levelArr"/>'),formObj.submit(),PMSCommon.Export.EXPACK_MODAL.close()},constructCompSalHikeStatus:function(){var resultData,pageId=$(PMSOperation.salHikeStatusEmpSliderObj.sliderDiv),params={mode:"getSalaryPushConflictUser",configId:PMSV2Cycle.REVIEWSTATUS_DATA.cycleData.configId,sIndex:PMSOperation.compSalHikeSIndex,conreqcsr:csrfToken};($.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(data){resultData=data}}),0==Object.keys(PMSOperation.salHikeStatusfsb).length&&1==PMSOperation.compSalHikeSIndex)&&pageId.find("#compSalHikeStatus").html("");0==resultData.limit&&Object.keys(PMSOperation.salHikeStatusfsb).length>0&&(PMSOperation.salHikeStatusfsb.reset(),PMSOperation.salHikeStatusfsb={}),PMSOperation.compSalHikeSIndex+=resultData.limit;var details="";resultData.limit>0?(void 0!=resultData.isSalaryDataSourceCompensation&&resultData.isSalaryDataSourceCompensation?($.each(resultData.nonAppliEmps,function(index,data){details+=PMSOperation.salaryPublishConflictUserListEmpDivConstruct(resultData,data,resultData.reason[data])}),void 0!=resultData.appliEmps&&$.each(resultData.appliEmps,function(index,data){details+=PMSOperation.salaryPublishConflictUserListEmpDivConstruct(resultData,data,ZPI18N.getString("zp.performance.readytopushtocompensation"))}),void 0!=resultData.compensationPending&&$.each(resultData.compensationPending,function(index,data){details+=PMSOperation.salaryPublishConflictUserListEmpDivConstruct(resultData,data,ZPI18N.getString("zp.performance.apprpendingincompensation"))}),void 0!=resultData.compensationApproved&&$.each(resultData.compensationApproved,function(index,data){details+=PMSOperation.salaryPublishConflictUserListEmpDivConstruct(resultData,data,ZPI18N.getString("zp.performance.apprprocessedincompensation"))}),void 0!=resultData.compensationRejected&&$.each(resultData.compensationRejected,function(index,data){details+=PMSOperation.salaryPublishConflictUserListEmpDivConstruct(resultData,data,ZPI18N.getString("zp.performance.apprrejectedincompensation"))}),void 0!=resultData.pushedbeforeComp&&$.each(resultData.pushedbeforeComp,function(index,data){details+=PMSOperation.salaryPublishConflictUserListEmpDivConstruct(resultData,data,ZPI18N.getString("zp.pushtosalaryform"))})):$.each(resultData.userlist,function(index,data){details+=PMSOperation.salaryPublishConflictUserListEmpDivConstruct(resultData,data,resultData.reason[data])}),pageId.find("#compSalHikeStatus").append(details),PMSOperation.salHikeStatusfsb=new FireScrollBack(PMSOperation.constructCompSalHikeStatus,$(PMSOperation.salHikeStatusEmpSliderObj.sliderDiv).find("#cardcompSalHikeStatus"),"getSalaryPushConflictUser")):0==Object.keys(PMSOperation.salHikeStatusfsb).length&&1==PMSOperation.compSalHikeSIndex&&PMSOperationCommon.setNoData(pageId.find("#cardcompSalHikeStatus"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null)},groupByOrder:function(event){const OperationSetting=PMSOperation;OperationSetting.isGroupByOrder=null,OperationSetting.startIndex=1,OperationSetting.appraiseeArr=[],OperationSetting.tempAppraisee=[];const menu=ZPeopleComponents.menu($("#zp_view_sorting")),ascending="ascending"===event.detail.id,descending="descending"===event.detail.id,checked=event.detail.checked;(ascending||descending)&&(menu.setMenuItemsAttribute([ascending?"#descending":"#ascending"],"checked",!1),OperationSetting.isGroupByOrder=checked?ascending?"Asc":"Desc":null),OperationSetting.showAppraisalUserList()},salaryPublishConflictUserListEmpDivConstruct:function(resultData,empErecno,reason){var html="";if(void 0!=resultData.empDetails&&void 0!=resultData.empDetails["Emp_"+empErecno]){var userInfo=resultData.empDetails["Emp_"+empErecno],dept=void 0!=userInfo.empDep?userInfo.empDep:"",des=void 0!=userInfo.empDes?userInfo.empDes:"";let empHtml='<div class="zpl_em">';empHtml+='<div class="zpl_emimg"><img src="'+userInfo.photopath+'"></div>',empHtml+='<div class="zpl_emdts">',empHtml+="<div><em>"+userInfo.empId+" - </em><b>"+userInfo.empdisplayname+"</b></div>",""==des&&""==dept||(empHtml+="<em>"+des+"&nbsp;-&nbsp;"+dept+"</em>"),html+='<tr class="ZPLRow" id="'+empErecno+'"><td>'+(empHtml+="</div></div>")+"</td>",html+="<td >"+reason+"</td></tr>"}return html},showChangeReviewPopup:function(){var sliderTab=new Tab("chngRvwr",function(){var _htm='<div class="zpl_crd"> <div class="zpl_crdcnt zpl_crdinfo"><div> ';_htm+='<div class="zpl_secn"> <div> <label>'+ZPI18N.getString("zp.chooseReviewer")+'</label> </div> <div> <select inpFormat="select" data-width="500" id="employeelisting" searchMode="INCLUDEUSERS" style="display: none;"> </select> </div> </div>',_htm+="</div> </div> </div>",$("#cardchngRvwr").html(_htm)},function(){PMSOperation.changeReviewer()});PMSOperation.chngRvwrPopupObj=new popupModal(ZPI18N.getString("zp.changereviewer"),sliderTab),PMSOperation.chngRvwrPopupObj.setCloseCallback(function(){var _sliderDiv=$(PMSOperation.chngRvwrPopupObj.sliderDiv);ZPeopleComponents.select(_sliderDiv.find("select")).destroy(),PMSOperation.chngRvwrPopupObj.remove(),PMSOperation.chngRvwrPopupObj={}}),PMSOperation.chngRvwrPopupObj.construct();var _sliderDiv=$(PMSOperation.chngRvwrPopupObj.sliderDiv);PMSOperationCommon.populateUsers("employeelisting",void 0,{skipDefaultValues:!1},!1,$(_sliderDiv),"select",!1,$(_sliderDiv))},changeReviewer:function(){var pageId=$(PMSOperation.chngRvwrPopupObj.sliderDiv),selAppraisertochange=ZPeopleComponents.select(pageId.find("#employeelisting")).getValue(),configId=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv).find("#configId").val();if(PMSOperation.appraiseeArr.length>1&&(PMSOperation.currentReviewer=""),""!==selAppraisertochange&&-1!=selAppraisertochange){var params={mode:"updateChangedReviewer",newReviewer:selAppraisertochange,configID:configId,conreqcsr:csrfToken,appraiseeList:JSON.stringify(PMSOperation.appraiseeArr),currentReviewer:PMSOperation.currentReviewer};$.post("/performanceConfig.zp",params,function(resultData){var parseObj=resultData;$.each(parseObj,function(index,data){if(void 0!==data.msg&&"success"==data.msg)ZPeopleComponents.select(pageId.find("#employeelisting")).destroy(),PMSOperation.chngRvwrPopupObj.close(),PMSOperation.appraiseeArr.length==data.sucessfullyUpdatedCount&&ZPeople.Message.success(ZPI18N.getString("zp.reviewerchanged")),PMSOperation.onloadshowAppraisalUserList(),PMSOperation.showAppraiseeList();else if(void 0!==data.msg&&"samereviewer"==data.msg)ZPeople.Message.failure(ZPI18N.getString("zp.samereviewer"));else if(void 0!==resultData.msg&&"normalizeErr"==resultData.msg)ZPeople.Message.failure(ZPI18N.getString("zp.changeReviewErrAfterNormaliz"));else if(void 0!==data.msg&&"subordinate"==data.msg){var userDetails=ZPeople.getUserDetailsById(PMSOperation.appraiseeArr[0]);ZPeople.Message.failure(ZPI18N.getString("zp.subortinatereviewer",[userDetails.name]))}else void 0!==data.msg&&"selfReview"==data.msg?ZPeople.Message.failure(ZPI18N.getString("zp.selfReview")):void 0!==data.msg&&"allReviewersSkipped"==data.msg?ZPeople.Message.failure(ZPI18N.getString("zp.reviewernotchanged")):void 0!==data.msg&&"norecord"==data.msg?(1==PMSOperation.appraiseeArr.length&&ZPeople.Message.failure(ZPI18N.getString("zp.reviewCompleted")),ZPeopleComponents.select(pageId.find("#employeelisting")).destroy(),PMSOperation.chngRvwrPopupObj.close(),PMSOperation.appraiseeArr=[],pageId.container.find('#appraisee_tbody input[type="checkbox"]').prop("checked",!1),pageId.container.find("#appraiseeListUpdate").hide(),pageId.container.find("#publish_bar").show()):void 0!==data.msg&&"cyle_closed"==data.msg?(ZPeopleComponents.select(pageId.find("#employeelisting")).destroy(),PMSOperation.chngRvwrPopupObj.close(),ZPeople.Message.failure(data.message)):void 0!==data.msg&&"permission denied"==data.msg&&ZPeople.Message.failure(ZPI18N.getString("zp.permdenied"))})})}else ZPeople.Message.failure(ZPI18N.getString("zp.selectReviewer"))},individualChangeReviewer:function(erecno){PMSOperation.appraiseeArr=[],PMSOperation.individualChangeOrExclude=!0,PMSOperation.appraiseeArr.push(erecno),PMSOperation.showChangeReviewPopup()},showCRIncludeEmp:function(){var popupTab=new Tab("Not Applicable Empl",function(){PMSOperation.getCRNotAppliEmp()});PMSOperation.SHOW_CR_NOT_APPLI_MODAL=new sliderModal(ZPI18N.getString("zp.nonApplicableEmp"),popupTab),PMSOperation.SHOW_CR_NOT_APPLI_MODAL.setCloseCallback(function(){PMSOperation.SHOW_CR_NOT_APPLI_MODAL.remove(),PMSOperation.applicableUserView()}),PMSOperation.SHOW_CR_NOT_APPLI_MODAL.construct(),$(PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv).find(".zpl_mfoter").html("");var _footer='<button type="button" id="zp_modal_cancelbtn" onclick="PMSOperation.closeCRNotAppli();" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.close")+"</button>";$(PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv).find(".zpl_mfoter").html(_footer),$(PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv).find("#cardNotApplicableEmpl").html(ZPeople.LOADING_HTML)},closeCRNotAppli:function(){PMSOperation.SHOW_CR_NOT_APPLI_MODAL.close()},getCRNotAppliEmp:function(){ZPeople.Request.send("/performanceConfig.zp",{mode:"crNonApplicableEmp"},PMSOperation.constructCRNotAppliEmp)},constructCRNotAppliEmp:function(data){PMSOperation.TEMP_CR_NOT_APPLI_LST=[],PMSOperation.CR_NOT_APPLI_LST=[],PMSOperation.CR_NON_APPLI_USER_LIST=[];var pageID=$(PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv);let isAllowConstr=!0,errMsg=ZPI18N.getString("zp.norecfound"),errIcon="no_data_found";if(void 0===data||0===Object.keys(data).length||void 0===data.MSG?isAllowConstr=!1:"PERMISSION_DENIED"===data.MSG?(isAllowConstr=!1,errMsg=ZPI18N.getString("zp.permissiondenied"),errIcon="zp_nd_permission"):("SUCCESS"!==data.MSG||"SUCCESS"===data.MSG&&data.empCnt<=0)&&(isAllowConstr=!1),isAllowConstr){var body='<div class="zpl_btnmnu"><div class="search-cmn"> <i class="PI_lens"  title="'+ZPI18N.getString("zp.search")+'"></i>';body+='<input type="text" class="ztextbox" id="CRNonAppSerachEmployee" placeholder="'+ZPI18N.getString("zp.searchdata")+'" onkeyup="PMSOperation.searchCRNonApplicableEmployees(this,\'CRNonAppEmp\')"> <i class="PI_cls" onclick="PMSOperation.clssearch(\'CRNonAppEmp\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div>',body+='<div class="actn_ovrly" style="z-index: 6;" id="CRNonAppMultiActionDiv"> <div><button class="zlabel zlabel--blue zlabel--outline  zlabel--medium" id="includeCREmpButton" onclick="PMSOperation.includeCrUserPopMsg();">'+ZPI18N.getString("zp.include")+'</button> </div> <i class="PI_cls" onclick="PMSOperation.removeAllIncludeUserMultiDeleteAction(\'CRNonAppEmp\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div>',body+='<div class="zpl_rgt"><i class="zpl_ibg PI_lens" onclick="PMSOperation.opnsearch(\'CRNonAppEmp\')" title="'+ZPI18N.getString("zp.search")+'"></i></div> </div>',body+='<div class="zpl_tblres zpl_oxa"><table class="zpl_tbl wd100_per">',body+='<thead><tr><th width="40"><div class="zcheckbox" onclick="PMSOperation.enableDisableAll(this)" id="includeCREmployeeChkBox" ><input type="checkbox" id="includeCRAllEmployeeChkBox" name="check" class="zcheckbox__helper"><label for="includeCRAllEmployeeChkBox" class="zcheckbox__label"></label></div></th><th width="500"></th><th></th> </tr></thead>',body+='<tbody id="notAppliTBody">';var empDet=data.empDts,empArr=data.empDts.empArr;PMSOperation.APPLI_USER_START_IDX+=empArr.length;for(var i=0;i<empArr.length;i++){var k=empArr[i],empObj=empDet[k].personalDetails;empObj.dep=empDet[k].departmentName,empObj.desig=empDet[k].designationName,PMSOperation.CR_NON_APPLI_USER_LIST.push(empObj),i<100&&(PMSOperation.TEMP_CR_NOT_APPLI_LST.push(empObj.id),body+=PMSOperation.constructCRNonAppliUserRow(empObj))}body+="</tbody></table> </div>",pageID.find("#cardNotApplicableEmpl").html(body),PMSOperation.CR_NON_APPLI_FIRESCROLL_OBJ={},PMSOperation.CR_NON_APPLI_FIRESCROLL_OBJ=new FireScrollBack(PMSOperation.constructCRNonAppliUserFireScrollCallback,pageID.find("#cardNotApplicableEmpl"),"CRNonApplicableUser")}else PMSOperationCommon.setNoData(pageID.find("#cardNotApplicableEmpl"),errMsg,errIcon,null,null,null)},constructCRNonAppliUserRow:function(empObj){let row="";return row+='<tr id="'+empObj.id+'"><td><div class="zcheckbox">',row+='<input onclick="PMSOperation.showIncludeCREmpList(this)" id="check_'+empObj.id+'"type="checkbox" name="check" class="zcheckbox__helper">',row+='<label for="check_'+empObj.id+'" class="zcheckbox__label"></label>',row+="</div></td> ",row+='<td><div class="zpl_em"><div class="zpl_emimg" module="pms" popup="user" empid="'+empObj.zuid+'"><img src="'+empObj.photo+'"></div><div class="zpl_emdts"><div><em>'+empObj.empid+"  </em><b>&nbsp;-&nbsp;"+empObj.name+"</b></div><em>"+empObj.desig+"&nbsp;-&nbsp;"+empObj.dep+"</em>",row+="</div></div></td>",row+='<td><div class="zpl_hvr"><button class="zlabel zlabel--blue zlabel--outline zlabel--small" onclick="PMSOperation.includeCrUserPopMsg(this)">'+ZPI18N.getString("zp.include")+"</button></div></td></tr>"},constructCRNonAppliUserFireScrollCallback:function(){var pageId=$(PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv);let resultArr=pageId.find(".search-cmn").hasClass("opn")?PMSOperation.CR_NON_APPLI_SEARCH_USER_LIST:PMSOperation.CR_NON_APPLI_USER_LIST,constructedLenght=pageId.find("#notAppliTBody tr").length,newRowCnt=0,body="";for(var i=constructedLenght;i<resultArr.length&&newRowCnt<100;i++)PMSOperation.TEMP_CR_NOT_APPLI_LST.push(resultArr[i].id),body+=PMSOperation.constructCRNonAppliUserRow(resultArr[i]),newRowCnt++;pageId.find("#notAppliTBody").append(body),constructedLenght+newRowCnt<=resultArr.length&&PMSOperation.CR_NON_APPLI_FIRESCROLL_OBJ.reset()},closeIncludeEmployeeDiv:function(){var pageID=$(PMSOperation.crUserListPopupObj.sliderDiv);ZPeopleComponents.select(pageID.find("#CRAddAppliEmp")).destroy(),PMSOperation.crUserListPopupObj.close()},closeIncludeEmpModal:function(confId){setTimeout(function(){PMSOperation.showUserManagement("userManagement",confId)},100)},enableDisableAll:function(obj){var input=!$(obj).children("input").prop("checked");if("includeEmployeeChkBox"==$(obj).attr("id")&&void 0!=input){var includeBtn=(includeAll=$(PMSOperation.includeEmpSliderObj.sliderDiv).find("#cardincludeEmployeeList")).find("#includeEmpButton");input?(PMSOperation.nonAppraiseeList=[],includeBtn.prop("disabled",!0),includeAll.find("tbody input[type='checkbox']").prop("checked",!1),includeAll.find("#includeuserMultiActionDiv").hasClass("opn")&&includeAll.find("#includeuserMultiActionDiv").removeClass("opn")):(includeAll.find("tbody input[type='checkbox']").prop("checked",!0),includeBtn.prop("disabled",!1),PMSOperation.nonAppraiseeList=[],PMSOperation.nonAppraiseeList=PMSOperation.tempNonAppraiseeList.slice(0,PMSOperation.tempNonAppraiseeList.length),includeAll.find("#includeuserMultiActionDiv").hasClass("opn")||includeAll.find("#includeuserMultiActionDiv").addClass("opn"))}else if("extendreview_allchk"==$(obj).attr("id")){var pageId=settingsPage.container;if(input)PMSOperation.pendingextendreview=new Array,pageId.find('#extendMyapproval input[type="checkbox"]').prop("checked",!1),pageId.find("#extendreview_acceptbutton").parent().parent().removeClass("opn");else pageId.find('#extendMyapproval  input[type="checkbox"]').each(function(){var objval=$(this).attr("id");void 0!==(objval=(objval=objval.split("_checkbox"))[0])&&("-1"==$("#"+objval).data(objval).approvalstatus&&(PMSOperation.pendingextendreview.push(objval),pageId.find("#"+objval+' input[type="checkbox"]').prop("checked",!0)))}),PMSOperation.pendingextendreview.length>0&&pageId.find("#extendreview_acceptbutton").parent().parent().addClass("opn")}else if("includeCREmployeeChkBox"===$(obj).attr("id")){var includeAll;includeBtn=(includeAll=$(PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv).find("#cardNotApplicableEmpl")).find("#includeCREmpButton");input?(PMSOperation.CR_NOT_APPLI_LST=[],includeBtn.prop("disabled",!0),includeAll.find("tbody input[type='checkbox']").prop("checked",!1),includeAll.find("#CRNonAppMultiActionDiv").hasClass("opn")&&includeAll.find("#CRNonAppMultiActionDiv").removeClass("opn")):(includeAll.find("tbody input[type='checkbox']").prop("checked",!0),includeBtn.prop("disabled",!1),PMSOperation.CR_NOT_APPLI_LST=[],PMSOperation.CR_NOT_APPLI_LST=PMSOperation.TEMP_CR_NOT_APPLI_LST.slice(0,PMSOperation.TEMP_CR_NOT_APPLI_LST.length),includeAll.find("#CRNonAppMultiActionDiv").hasClass("opn")||includeAll.find("#CRNonAppMultiActionDiv").addClass("opn"))}else if("excludeRevEmpChkBox"==$(obj).attr("id")){var excludeAll=$(PMSOperation.noUserExcludeSliderObj.sliderDiv).find("#notExcEmpDiv"),excludeBtn=$(PMSOperation.noUserExcludeSliderObj.sliderDiv).find("#excludeRevEmpButton");input?(excludeAll.find("#notExcEmpBody input[type='checkbox']").prop("checked",!1),excludeBtn.prop("disabled",!0),PMSOperation.reviewedExcludeList=[]):(excludeAll.find("#notExcEmpBody input[type='checkbox']").not(".disabled").prop("checked",!0),excludeBtn.prop("disabled",!1),PMSOperation.reviewedExcludeList=[],PMSOperation.reviewedExcludeList=PMSOperation.tempNonExcludeList.slice(0,PMSOperation.tempNonExcludeList.length))}else if("remindallchkbox"==$(obj).attr("id")){const remindAll=$(PMSV2Cycle.reminderslider.sliderDiv).find("#cardreminderuserdetails"),remindBtn=remindAll.find("#remindpokeallbtn");input?(remindAll.find("tbody input[type='checkbox']").prop("checked",!1),remindBtn.prop("disabled",!0),PMSV2Cycle.remindUserList=[],remindAll.find("#CycleReminderMultiActionDiv").hasClass("opn")&&remindAll.find("#CycleReminderMultiActionDiv").removeClass("opn")):(remindAll.find("tbody input[type='checkbox']").prop("checked",!0),remindBtn.prop("disabled",!1),PMSV2Cycle.remindUserList=[...PMSV2Cycle.tempRemindUserList],remindAll.find("#CycleReminderMultiActionDiv").hasClass("opn")||remindAll.find("#CycleReminderMultiActionDiv").addClass("opn"))}else if("remindCRallchkbox"==$(obj).attr("id")){const remindAll=$(PMSOperation.CR_REMAINDER_MODAL.sliderDiv).find("#cardCRPendingRemainderView"),remindBtn=remindAll.find("#remindpokeCRallbtn");input?(remindAll.find("tbody input[type='checkbox']").prop("checked",!1),remindBtn.prop("disabled",!0),PMSOperation.crRemainderUsrList=[],remindAll.find("#CRReminderMultiActionDiv").hasClass("opn")&&remindAll.find("#CRReminderMultiActionDiv").removeClass("opn")):(remindAll.find("tbody input[type='checkbox']").prop("checked",!0),remindBtn.prop("disabled",!1),PMSOperation.crRemainderUsrList=[],remindAll.find("#pendinglisttbody tr").each(function(index,rowObj){PMSOperation.crRemainderUsrList.push($(rowObj).attr("id"))}),remindAll.find("#CRReminderMultiActionDiv").hasClass("opn")||remindAll.find("#CRReminderMultiActionDiv").addClass("opn"))}else"excludeUnpubRecallEmpChkBox"==$(obj).attr("id")?input?($(PMSESign.notpublishedOrExcludedListSliderObj.sliderDiv).find("tbody input[type='checkbox']").prop("checked",!1),$(PMSESign.notpublishedOrExcludedListSliderObj.sliderDiv).find("#esignPublishExcludeRestrictionButton").prop("disabled",!0)):($(PMSESign.notpublishedOrExcludedListSliderObj.sliderDiv).find("tbody input[type='checkbox']:not(.disabled)").prop("checked",!0),$(PMSESign.notpublishedOrExcludedListSliderObj.sliderDiv).find("#esignPublishExcludeRestrictionButton").prop("disabled",!1)):"excludeRecallEmpChkBox"==$(obj).attr("id")&&(input?($(PMSOperation.noUserExcludeSliderObj.sliderDiv).find("#excludeRecallTbody input[type='checkbox']").prop("checked",!1),$(PMSOperation.noUserExcludeSliderObj.sliderDiv).find("#excludeRecallBtn").prop("disabled",!0)):($(PMSOperation.noUserExcludeSliderObj.sliderDiv).find("#excludeRecallTbody input[type='checkbox']").prop("checked",!0),$(PMSOperation.noUserExcludeSliderObj.sliderDiv).find("#excludeRecallBtn").prop("disabled",!1)))},showAppraiseeList:function(){var pageId=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv);pageId.find("#appraiseeListUpdate").removeClass("opn"),pageId.find('#appraisee_tbody input[type="checkbox"]').prop("checked",!1),PMSOperation.appraiseeArr=[]},getIncludeEmployeeHtml:function(){var _htm='<thead><tr><th width="40"><div class="zcheckbox"  onclick="PMSOperation.enableDisableAll(this)" id="includeEmployeeChkBox">';return _htm+='<input id="includeAllEmployeeChkBox" type="checkbox" name="check" class="zcheckbox__helper">',_htm+='<label for="includeAllEmployeeChkBox" class="zcheckbox__label"></label></div></th>',_htm+='<th></th><th width="200"></th></tr></thead>',_htm+='<tbody id="includeEmpTab"></tbody> '},searchNotApplicableEmployees:function(obj){var _sliderDiv=$(PMSOperation.includeEmpSliderObj.sliderDiv);void 0!=$(obj).val().trim()&&PMSOperation.isNonApplEmpSearchAllowed&&(PMSOperation.isNonApplEmpSearchAllowed=!1,setTimeout(function(){PMSOperation.nonAppraiseeList=[],PMSOperation.tempNonAppraiseeList=[],PMSOperation.nonAppraiseeListSIndex=1,PMSOperation.isNonApplEmpSearchAllowed=!0,_sliderDiv.find("#includeEmpTab").html(""),_sliderDiv.find("#includeAllEmployeeChkBox").prop("checked",!1),PMSOperation.constructIncludeEmployeeDiv()},500))},checkAllCheckboxes:function(nonAppraiseeList){const _sliderDiv=$(PMSOperation.includeEmpSliderObj.sliderDiv),includeEmpTab=_sliderDiv.find("#includeEmpTab");nonAppraiseeList.forEach(value=>{_sliderDiv.find(`#check_${value}`).prop("checked",!0)});let allChecked=!0;includeEmpTab.find("input[type='checkbox']").each(function(){if(!this.checked)return allChecked=!1,!1}),_sliderDiv.find("#includeAllEmployeeChkBox").prop("checked",allChecked)},constructIncludeEmployeeDiv:function(){var employeeData,pageId=$(PMSOperation.includeEmpSliderObj.sliderDiv),params={mode:"getNonApplicableEmployeesForCycle",conreqcsr:csrfToken,configId:$(PMSOperation.manageAppraiseeSliderObj.sliderDiv).find("#configId").val(),status:$(PMSOperation.manageAppraiseeSliderObj.sliderDiv).find("#appraisalstatus").val(),sIndex:PMSOperation.nonAppraiseeListSIndex};let searchVal=pageId.find("#notAppSerachEmployee").val().trim();void 0!=searchVal&&""!=searchVal&&(params.searchVal=searchVal),$.ajax({type:"POST",url:"/performanceConfig.zp",data:params,cache:!0}).done(function(data){if(employeeData=data,0==pageId.find("#includeEmpTab").length&&pageId.find("#cna-employees").html(PMSOperation.getIncludeEmployeeHtml()),0==employeeData.nonApplicableEmployees.length&&Object.keys(PMSOperation.nonAppraiseefsb).length>0)PMSOperation.nonAppraiseefsb.reset(),PMSOperation.nonAppraiseefsb={};else{var nonAppraiseeListSIndex=PMSOperation.nonAppraiseeListSIndex;0===employeeData.nonApplicableEmployees.length?PMSOperation.nonAppraiseeListSIndex=nonAppraiseeListSIndex:PMSOperation.nonAppraiseeListSIndex=nonAppraiseeListSIndex+100}if(employeeData.nonApplicableEmployees.length>0){pageId.find(".zpl_btnmnu").removeClass("zpl_DNI"),void 0!=PMSOperation.nonAppraiseeDataList.nonApplicableEmployees&&PMSOperation.nonAppraiseeDataList.nonApplicableEmployees.length>0?PMSOperation.nonAppraiseeDataList.nonApplicableEmployees=[...PMSOperation.nonAppraiseeDataList.nonApplicableEmployees,...employeeData.nonApplicableEmployees]:PMSOperation.nonAppraiseeDataList=employeeData;var details=PMSOperation.constructNAEmployees(employeeData,null);pageId.find("#includeEmpTab").append(details),PMSOperation.nonAppraiseefsb=new FireScrollBack(PMSOperation.constructIncludeEmployeeDiv,$(PMSOperation.includeEmpSliderObj.sliderDiv).find("#cardincludeEmployeeList"),"getNonApplicableEmployeesForCycle")}else 0==Object.keys(PMSOperation.nonAppraiseefsb).length&&1==PMSOperation.nonAppraiseeListSIndex&&PMSOperationCommon.setNoData(pageId.find("#cna-employees"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null),0==Object.keys(PMSOperation.nonAppraiseefsb).length&&1==PMSOperation.nonAppraiseeListSIndex&&""==searchVal&&(pageId.find(".zpl_btnmnu").addClass("zpl_DNI"),PMSOperationCommon.setNoData(pageId.find("#cna-employees"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null))}).fail(function(jqXHR,textStatus,errorThrown){ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))})},constructNAEmployees:function(employeeData,searchArr){var nonApplicableEmployees=null!=searchArr?searchArr:employeeData.nonApplicableEmployees,details="";return $.each(nonApplicableEmployees,function(index,data){var userObj=data;void 0!=employeeData.isCompensationEnabled&&employeeData.isCompensationEnabled&&void 0!=employeeData.nonApplicableEmployeeCompensation[userObj.id]||null!=searchArr||PMSOperation.tempNonAppraiseeList.push(userObj.id),userObj.empDesignation=void 0==userObj.empDesignation?"":userObj.empDesignation,userObj.empDepartment=void 0==userObj.empDepartment?"":userObj.empDepartment,details+='<tr id="'+userObj.id+'"><td><div class="zcheckbox">',void 0!=employeeData.isCompensationEnabled&&employeeData.isCompensationEnabled&&void 0!=employeeData.nonApplicableEmployeeCompensation[userObj.id]||(details+='<input onclick="PMSOperation.showIncludeAppraiseeList(this)" id="check_'+userObj.id+'"type="checkbox" name="check" class="zcheckbox__helper">',details+='<label for="check_'+userObj.id+'" class="zcheckbox__label"></label>'),details+="</div></td> ",details+='<td><div class="zpl_em"><div class="zpl_emimg" module="pms" popup="user" empid="'+userObj.zuid+'"><img src="'+userObj.empPhoto+'"></div><div class="zpl_emdts"><div><em>'+userObj.empId+"&nbsp;-&nbsp;</em><b>"+userObj.empName+"</b></div>";var destxt="";""!=userObj.empDesignation&&(destxt=userObj.empDesignation),""!=userObj.empDesignation&&""!=userObj.empDepartment&&(destxt+="&nbsp;-&nbsp;"),""!=userObj.empDepartment&&(destxt+=userObj.empDepartment),""!=destxt&&(details+="<em>"+destxt+"</em>"),details+="</div></div></td>",void 0!=employeeData.isCompensationEnabled&&employeeData.isCompensationEnabled&&void 0!=employeeData.nonApplicableEmployeeCompensation[userObj.id]?details+='<td style="white-space: initial !important;"><div>'+employeeData.nonApplicableEmployeeCompensation[userObj.id]:details+='<td><div class="zpl_hvr"><button type="button" class="zlabel  zlabel--blue zlabel--outline zlabel--small" onclick="PMSOperation.includeUsertoCycle(this)">'+ZPI18N.getString("zp.include")+"</button>",details+="</div></td></tr>"}),details},showIncludeAppraiseeList:function(obj){var pageId=$(PMSOperation.includeEmpSliderObj.sliderDiv),userId=$(obj).closest("tr").attr("id"),includeAll=pageId.find("#cardincludeEmployeeList"),includeBtn=includeAll.find("#includeEmpButton");$(obj).is(":checked")?(pageId.find("#includeuserMultiActionDiv").hasClass("opn")||pageId.find("#includeuserMultiActionDiv").addClass("opn"),PMSOperation.nonAppraiseeList.push(userId),includeBtn.prop("disabled",!1),PMSOperation.nonAppraiseeList.length==PMSOperation.tempNonAppraiseeList.length&&includeAll.find("#includeEmployeeChkBox input").prop("checked",!0)):(PMSOperation.nonAppraiseeList.splice(PMSOperation.nonAppraiseeList.indexOf(userId),1),PMSOperation.nonAppraiseeList.length<PMSOperation.tempNonAppraiseeList.length&&includeAll.find("#includeEmployeeChkBox input").prop("checked",!1),PMSOperation.nonAppraiseeList.length>0?(includeBtn.prop("disabled",!1),pageId.find("#includeuserMultiActionDiv").hasClass("opn")||pageId.find("#includeuserMultiActionDiv").addClass("opn")):(includeBtn.prop("disabled",!0),pageId.find("#includeuserMultiActionDiv").hasClass("opn")&&pageId.find("#includeuserMultiActionDiv").removeClass("opn")))},showIncludeCREmpList:function(obj){var pageId=$(PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv),userId=$(obj).closest("tr").attr("id"),includeAll=pageId.find("#cardNotApplicableEmpl"),includeBtn=includeAll.find("#includeCREmpButton");$(obj).is(":checked")?(PMSOperation.CR_NOT_APPLI_LST.push(userId),includeBtn.prop("disabled",!1),PMSOperation.CR_NOT_APPLI_LST.length==PMSOperation.TEMP_CR_NOT_APPLI_LST.length&&includeAll.find("#includeCREmployeeChkBox input").prop("checked",!0),pageId.find("#CRNonAppMultiActionDiv").hasClass("opn")||pageId.find("#CRNonAppMultiActionDiv").addClass("opn")):(PMSOperation.CR_NOT_APPLI_LST.splice(PMSOperation.CR_NOT_APPLI_LST.indexOf(userId),1),PMSOperation.CR_NOT_APPLI_LST.length<PMSOperation.TEMP_CR_NOT_APPLI_LST.length&&includeAll.find("#includeCREmployeeChkBox input").prop("checked",!1),PMSOperation.CR_NOT_APPLI_LST.length>0?(includeBtn.prop("disabled",!1),pageId.find("#CRNonAppMultiActionDiv").hasClass("opn")||pageId.find("#CRNonAppMultiActionDiv").addClass("opn")):(includeBtn.prop("disabled",!0),pageId.find("#CRNonAppMultiActionDiv").hasClass("opn")&&pageId.find("#CRNonAppMultiActionDiv").removeClass("opn")))},includeCrUserPopMsg:function(obj){if(void 0===PMSOperation.SHOW_CR_NOT_APPLI_MODAL.periodDetails){let params={mode:"getLatestCRReviewDetails",conreqcsr:csrfToken},resultData=PMSOperation.CR.fetchData(params,void 0);void 0!==resultData&&void 0!==resultData.msg&&(resultData.isAllowed=!1,"ON_GOING_REVIEW_PERIOD"!==resultData.msg&&"FUTURE_REVIEW_PERIOD"!==resultData.msg||(resultData.isAllowed=!0),PMSOperation.SHOW_CR_NOT_APPLI_MODAL.periodDetails=resultData)}if(void 0!==PMSOperation.SHOW_CR_NOT_APPLI_MODAL.periodDetails&&PMSOperation.SHOW_CR_NOT_APPLI_MODAL.periodDetails.isAllowed){var InfoPopup=new InfoAlertMessage;let titleMsg=ZPI18N.getString("zp.cr.includeemployee",[ZPI18N.getString("zp.employee")]);void 0===obj&&PMSOperation.CR_NOT_APPLI_LST.length>1&&(titleMsg=ZPI18N.getString("zp.cr.includeemployee",[ZPI18N.getString("zp.employees")]));let empTxt=void 0===obj&&PMSOperation.CR_NOT_APPLI_LST.length>1?ZPI18N.getString("zp.selected")+" "+ZPI18N.getString("zp.employees_LC"):ZPI18N.getString("zp.employee_LC"),desc="";desc="ON_GOING_REVIEW_PERIOD"===PMSOperation.SHOW_CR_NOT_APPLI_MODAL.periodDetails.msg?ZPI18N.getString("zp.cr.include.currentperioddesc",[empTxt,PMSOperation.SHOW_CR_NOT_APPLI_MODAL.periodDetails.dataFromDt,PMSOperation.SHOW_CR_NOT_APPLI_MODAL.periodDetails.dataToDt]):ZPI18N.getString("zp.cr.include.futureperioddesc",[empTxt]),InfoPopup.title=titleMsg,InfoPopup.despcription=desc,InfoPopup.yesButtonText=ZPI18N.getString("zp.confirm"),InfoPopup.cancelButtonText=ZPI18N.getString("zp.cancel"),InfoPopup.callback=function(){PMSOperation.newIncludeUserToCR(obj)},InfoPopup.show()}else ZPeople.Message.failure(ZPI18N.getString("zp.rebranderrinaction"))},newIncludeUserToCR:function(obj){var pageId=$(PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv),params={mode:"includeExcludeCRUser",type:1};if(void 0!==obj){var id=pageId.find(obj).closest("tr").attr("id"),list=[];list.push(id),params.includeExcludeCRUserArr=JSON.stringify(list),PMSOperation.CR_NOT_APPLI_LST.splice(PMSOperation.CR_NOT_APPLI_LST.indexOf(id),1),pageId.find(obj).attr("disabled",!0),ZPeople.Request.send("/performanceConfig.zp",params,function(data){"SUCCESS"===data.msg?(void 0!==data.dataFromDt&&void 0!==data.dataToDt?ZPeople.Message.success(ZPI18N.getString("zp.cr.include.currentperiodsuccessmsg",[ZPI18N.getString("zp.employee")])):ZPeople.Message.success(ZPI18N.getString("zp.cr.include.futureperiodsuccessmsg",[ZPI18N.getString("zp.employee")])),PMSOperation.getCRNotAppliEmp()):ZPeople.Message.failure(ZPI18N.getString("zp.errorinuserinclude"))})}else if(PMSOperation.CR_NOT_APPLI_LST.length>0){if(PMSOperation.CR_NOT_APPLI_LST.length>100)return void ZPeople.Message.warning(ZPI18N.getString("zp.include.limiterrormsg"));pageId.find("#includeEmpButton").prop("disabled",!0),params.includeExcludeCRUserArr=JSON.stringify(PMSOperation.CR_NOT_APPLI_LST),ZPeople.Request.send("/performanceConfig.zp",params,function(data){if("SUCCESS"===data.msg){let multiEmplTxt=void 0!==data.userList&&data.userList.length>1?ZPI18N.getString("zp.employees"):ZPI18N.getString("zp.employee");void 0!==data.dataFromDt&&void 0!==data.dataToDt?ZPeople.Message.success(ZPI18N.getString("zp.cr.include.currentperiodsuccessmsg",[multiEmplTxt])):ZPeople.Message.success(ZPI18N.getString("zp.cr.include.futureperiodsuccessmsg",[multiEmplTxt])),PMSOperation.getCRNotAppliEmp()}else ZPeople.Message.failure(ZPI18N.getString("zp.errorinuserinclude"))})}},includeUsertoCycle:function(obj){var appraiseeListPageId=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv),pageId=$(PMSOperation.includeEmpSliderObj.sliderDiv);if(void 0!=obj){var id=pageId.find(obj).closest("tr").attr("id");appraiseeListPageId.find("#appraisalstatus").val();(params={mode:"includeusertocycle",conreqcsr:csrfToken}).configId=appraiseeListPageId.find("#configId").val();var list=[];list.push(id),params.includeusers=JSON.stringify(list),params.status=appraiseeListPageId.find("#appraisalstatus").val(),PMSOperation.nonAppraiseeList.splice(PMSOperation.nonAppraiseeList.indexOf(id),1),pageId.find(obj).attr("disabled",!0),ZPeople.Request.send("/performanceConfig.zp",params,PMSOperation.responseforincludeuser,obj)}else if(PMSOperation.nonAppraiseeList.length>0){if(PMSOperation.nonAppraiseeList.length>100)return void ZPeople.Message.warning(ZPI18N.getString("zp.include.limiterrormsg"));pageId.find("#includeEmpButton").prop("disabled",!0);var params;appraiseeListPageId.find("#appraisalstatus").val();(params={mode:"includeusertocycle",conreqcsr:csrfToken}).configId=appraiseeListPageId.find("#configId").val(),params.includeusers=JSON.stringify(PMSOperation.nonAppraiseeList),params.status=appraiseeListPageId.find("#appraisalstatus").val(),ZPeople.Request.send("/performanceConfig.zp",params,PMSOperation.responseforincludeuser)}else ZPeople.Message.warning(ZPI18N.getString("zp.includeuser"))},removeAllIncludeUserMultiDeleteAction:function(mode){if("CycleAppEmp"==mode){var pageId=$(PMSOperation.includeEmpSliderObj.sliderDiv),includeAll=$(PMSOperation.includeEmpSliderObj.sliderDiv).find("#cardincludeEmployeeList");PMSOperation.nonAppraiseeList=[],includeAll.find("input[type='checkbox']").prop("checked",!1),pageId.find("#includeuserMultiActionDiv").hasClass("opn")&&pageId.find("#includeuserMultiActionDiv").removeClass("opn")}else if("CRAppEmp"==mode){pageId=$(PMSOperation.crManageEmpSliderObj.sliderDiv);PMSOperation.INCLUDE_EXCLUDE_USER_ARR=[],pageId.find("input[type='checkbox']").prop("checked",!1),pageId.find("#CRAppMultiActionDiv").hasClass("opn")&&pageId.find("#CRAppMultiActionDiv").removeClass("opn")}else if("CRNonAppEmp"==mode){pageId=$(PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv);PMSOperation.CR_NOT_APPLI_LST=[],pageId.find("input[type='checkbox']").prop("checked",!1),pageId.find("#CRNonAppMultiActionDiv").hasClass("opn")&&pageId.find("#CRNonAppMultiActionDiv").removeClass("opn")}else if("CRReminder"==mode){pageId=$(PMSOperation.CR_REMAINDER_MODAL.sliderDiv);PMSOperation.crRemainderUsrList=[],pageId.find("input[type='checkbox']").prop("checked",!1),pageId.find("#CRReminderMultiActionDiv").hasClass("opn")&&pageId.find("#CRReminderMultiActionDiv").removeClass("opn")}else if("CycleReminder"==mode){pageId=$(PMSV2Cycle.reminderslider.sliderDiv);PMSV2Cycle.remindUserList=[],pageId.find("input[type='checkbox']").prop("checked",!1),pageId.find("#CycleReminderMultiActionDiv").hasClass("opn")&&pageId.find("#CycleReminderMultiActionDiv").removeClass("opn")}},responseforincludeuser:function(resultData,params,obj){var pageId=$(PMSOperation.includeEmpSliderObj.sliderDiv);void 0!=obj?pageId.find(obj).prop("disabled",!1):pageId.find("#includeEmpButton").prop("disabled",!1),"success"==resultData.msg?(PMSOperation.nonAppraiseeList=[],ZPeople.Message.success(ZPI18N.getString("zp.employeeinclude")),PMSOperation.clssearch("noAppEmp"),PMSOperation.showUserManagement("includeEmployeeDivTable"),pageId.find("#includeuserMultiActionDiv").hasClass("opn")&&pageId.find("#includeuserMultiActionDiv").removeClass("opn")):"nousers"==resultData.msg?ZPeople.Message.warning(ZPI18N.getString("zp.useralreadyexistsincycle")):"cycleclose_error"==resultData.msg?ZPeople.Message.failure(resultData.message):"normalizeErr"==resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.includeUserErrAfterNormaliz")):ZPeople.Message.failure(ZPI18N.getString("zp.errorinuserinclude")),void 0!=resultData.salaryNotAvailEmpDetails&&(resultData.salaryNotAvailable=Object.keys(resultData.salaryNotAvailEmpDetails),resultData.salaryNotAvailable.length>0&&(resultData.status="SUCCESS",PMSV2Cycle.showSalaryNotAvailableModal(resultData)))},showhideMngeAppraiseeFilter:function(isClose,breadCrumbObj){let pageId=PMSOperation.manageAppraiseeSliderObj.sliderDiv,filterCont=pageId.find(".zpl_minr");if(void 0!==isClose?isClose?filterCont.removeClass("zpl_fltr_flt"):filterCont.addClass("zpl_fltr_flt"):filterCont.hasClass("zpl_fltr_flt")?filterCont.removeClass("zpl_fltr_flt"):filterCont.addClass("zpl_fltr_flt"),void 0!==breadCrumbObj){let filterElementObj=JSON.parse($(breadCrumbObj).attr("fieldObj"));ZPeopleComponents.isComponent(pageId.find("#"+filterElementObj.filterElementId))&&("selectField"===filterElementObj.filterElementType?ZPeopleComponents.select(pageId.find("#"+filterElementObj.filterElementId)).open():"tokenField"===filterElementObj.filterElementType&&ZPeopleComponents.tokenfield(pageId.find("#"+filterElementObj.filterElementId)).openDropdownList())}},hideMngeAppraiseeFilter:function(){$(PMSOperation.manageAppraiseeSliderObj.sliderDiv).find(".zpl_minr").removeClass("zpl_fltr_flt")},onloadshowAppraisalUserList:function(onload){const _sliderDiv=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv);if(onload){PMSOperationCommon.populateUsers("emp_search",null,{maxAllowedValues:25},!0,$(_sliderDiv),"token"),["designation_search","dept_search","loct_search","level_search"].forEach(filter=>PMSOperation.showManageApprFilterSelect(_sliderDiv.find(`#${filter}`),filter))}_sliderDiv.find("#zp_revstatus_usermanagement_recordcount").addClass("DN"),_sliderDiv.find("#zp_revstatus_usermanagement_recordcount").text(""),PMSOperation.showAppraisalUserList()},getDesignationList:function(){null!=PMSOperation.ALL_DESIGNATION&&null!=PMSOperation.ALL_DEPARTMENTS&&null!=PMSOperation.ALL_ROLES||$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getroles_designation",conreqcsr:csrfToken},success:function(data){PMSOperation.ALL_DESIGNATION=data.designations,PMSOperation.ALL_DEPARTMENTS=data.departmentList,PMSOperation.ALL_ROLES=data.roleList,PMSOperation.ALL_LOCATIONS=data.locationList,PMSOperation.ALL_LEVELS=data.designationLevelList}});var parseObj=PMSOperation.ALL_DESIGNATION,_options=[];return void 0!=parseObj&&$.each(parseObj,function(index,data){_options.push({name:data.desName,id:data.desId})}),_options},getDepartmentsList:function(){var parseObj=PMSOperation.ALL_DEPARTMENTS,_options=[];return void 0!=parseObj&&$.each(parseObj,function(index,data){_options.push({name:data.departmentName,id:data.departmentId})}),_options},getLocationsList:function(){var parseObj=PMSOperation.ALL_LOCATIONS,_options=[];return void 0!=parseObj&&$.each(parseObj,function(index,data){_options.push({name:data.locationName,id:data.locationId})}),_options},getLevelsList:function(){var parseObj=PMSOperation.ALL_LEVELS,_options=[];return void 0!=parseObj&&$.each(parseObj,function(index,data){_options.push({name:data.levelName,id:data.levelId})}),_options},showManageApprFilterSelect:function(desfe,id){var _selectObj={},_options=[],placeholder="";"designation_search"==id?(_options=PMSOperation.getDesignationList(),placeholder=ZPI18N.getString("zp.alldesignation")):"dept_search"==id?(_options=PMSOperation.getDepartmentsList(),placeholder=ZPI18N.getString("zp.alldepartment")):"loct_search"==id?(_options=PMSOperation.getLocationsList(),placeholder=ZPI18N.getString("zp.alllocaction")):"level_search"==id&&(_options=PMSOperation.getLevelsList(),placeholder=ZPI18N.getString("zp.alllevel")),_selectObj.placeholder=placeholder,_selectObj.options=_options,_selectObj.dropdownList={width:"260",isTextHTMLEncoded:!0},_selectObj.contentType="text",_selectObj.dataMapping={label:"name",value:"id",informativeText:"name"},_selectObj.isLabelHTMLEncoded=!0,_selectObj.search={by:["name"],highlightKeyword:!0},ZPeopleComponents.select(desfe,_selectObj)},resetManageAppraisee:function(){var _sliderDiv=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv);const destroyComponent=selector=>{const el=$(_sliderDiv).find(selector);ZPeopleComponents.isComponent(el)&&(el.is("#emp_search")?ZPeopleComponents.tokenfield(el).removeAllTokens():ZPeopleComponents.select(el).deselectAllOptions())};destroyComponent("#emp_search"),destroyComponent("#designation_search"),destroyComponent("#dept_search"),destroyComponent("#loct_search"),destroyComponent("#level_search")},showAppraisalUserList:function(objele,scrollaction,isAdditionalBreadCrumb){var _sliderDiv=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv),params={mode:"previewofappraisalusers",conreqcsr:csrfToken};params.configId=_sliderDiv.find("#configId").val();let searchParams={empObj:[],deptval:[],desival:[],lvlval:[],loctval:[]};ZPeopleComponents.isComponent($(_sliderDiv).find("#emp_search"))&&void 0!==ZPeopleComponents.tokenfield($(_sliderDiv).find("#emp_search")).getAllValues()&&"-1"!=ZPeopleComponents.tokenfield($(_sliderDiv).find("#emp_search")).getAllValues()[0]&&(params.searchval=JSON.stringify(PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield($(_sliderDiv).find("#emp_search")).getAllValues())),searchParams.empObj=ZPeopleComponents.tokenfield($(_sliderDiv).find("#emp_search")).getAllValues());var depSearch=$(_sliderDiv).find("#dept_search");if(ZPeopleComponents.isComponent(depSearch)&&void 0!==ZPeopleComponents.select(depSearch).getValues()){var depArr=0==ZPeopleComponents.select(depSearch).getValues().length?["-1"]:ZPeopleComponents.select(depSearch).getValues();params.deptval=JSON.stringify(depArr),searchParams.deptval=depArr}var desSearch=$(_sliderDiv).find("#designation_search");if(ZPeopleComponents.isComponent(desSearch)&&void 0!==ZPeopleComponents.select(desSearch).getValues()){var desArr=0==ZPeopleComponents.select(desSearch).getValues().length?["-1"]:ZPeopleComponents.select(desSearch).getValues();params.desival=JSON.stringify(desArr),searchParams.desival=desArr}var levelSearch=$(_sliderDiv).find("#level_search");if(levelSearch.length>0&&ZPeopleComponents.isComponent(levelSearch)){var levelValues=ZPeopleComponents.select(levelSearch).getValues();if(void 0!==levelValues){var lvlArr=0==levelValues.length?["-1"]:levelValues;searchParams.lvlval=lvlArr,params.lvlval=JSON.stringify(lvlArr)}}var loctSearch=$(_sliderDiv).find("#loct_search");if(ZPeopleComponents.isComponent(loctSearch)&&void 0!==ZPeopleComponents.select(loctSearch).getValues()){var locArr=0==ZPeopleComponents.select(loctSearch).getValues().length?["-1"]:ZPeopleComponents.select(loctSearch).getValues();params.loctval=JSON.stringify(locArr),searchParams.loctval=locArr}if(params.status=_sliderDiv.find("#appraisalstatus").val(),params.notselectedreviewerloaded=PMSOperation.notselectedreviewerloaded,params.viewmode="userManagement",null!=PMSOperation.isGroupByOrder&&(params.groupbytype=PMSOperation.isGroupByOrder),void 0!=PMSOperation.startIndex&&scrollaction?params.sIndex=PMSOperation.startIndex:(params.sIndex=1,PMSOperation.startIndex=1,params.notselectedreviewerloaded=!1),$(_sliderDiv).find("#zp_revstatus_usermanagement_recordcount").hasClass("DN")&&PMSOperation.applicableUserCount(),!isAdditionalBreadCrumb){var filterObject=PMSOperation.constructSelectedMAFilterHTML(searchParams,!1);filterObject?($(_sliderDiv).find("#selectedfltrlst").html(filterObject),$(_sliderDiv).find("#maselectedfltr").removeClass("DNI"),$(_sliderDiv).find("#ma_fltr_more").unbind(),$(_sliderDiv).find("#ma_fltr_more").on("click",function(){PMSOperation.showhideMngeAppraiseeFilter(!1,void 0)}),$(_sliderDiv).find("[name=BreadCrumbElement]").unbind(),$(_sliderDiv).find("[name=BreadCrumbElement]").on("click",function(){PMSOperation.onclickMaBreadCrumb(event,this)})):($(_sliderDiv).find("#selectedfltrlst").empty(),$(_sliderDiv).find("#maselectedfltr").addClass("DNI"))}ZPeople.Request.send("/performanceConfig.zp",params,PMSOperation.responseforpreviewofapplicableuser,scrollaction),appraisalflag=!1},constructSelectedMAFilter:function(obj,isFromAddiInfo){const{deptval:deptval,desival:desival,lvlval:lvlval,loctval:loctval,empObj:empObj}=obj;let departmentNames=[],designationNames=[],levelNames=[],locationNames=[],employeeNames=[];return[...deptval,...desival,...lvlval,...loctval,empObj].flat().every(val=>"-1"===val||0===val.length)?{}:(PMSOperation.ALL_DEPARTMENTS.forEach(department=>{deptval.includes(department.departmentId)&&(isFromAddiInfo?departmentNames.push({id:department.departmentId,value:department.departmentName}):departmentNames.push(department.departmentName))}),PMSOperation.ALL_DESIGNATION.forEach(designation=>{desival.includes(designation.desId)&&(isFromAddiInfo?designationNames.push({id:designation.desId,value:designation.desName}):designationNames.push(designation.desName))}),PMSOperation.ALL_LEVELS.forEach(level=>{lvlval.includes(level.levelId)&&(isFromAddiInfo?levelNames.push({id:levelNames.levelId,value:levelNames.levelName}):levelNames.push(level.levelName))}),PMSOperation.ALL_LOCATIONS.forEach(location=>{loctval.includes(location.locationId)&&(isFromAddiInfo?locationNames.push({id:location.locationId,value:location.locationName}):locationNames.push(location.locationName))}),empObj.forEach(function(obj){isFromAddiInfo?employeeNames.push({id:obj.id,value:obj.html}):employeeNames.push(obj.decodedItemText)}),{departmentNames:departmentNames,designationNames:designationNames,levelNames:levelNames,locationNames:locationNames,employeeNames:employeeNames})},constructSelectedMAFilterHTML:function(params){const selectedMAFilter=PMSOperation.constructSelectedMAFilter(params,!1);let html="",selectCnt=0,isMore=!1;const constructFilter=(filterType,headerName,filterElement,filterElementType)=>{const filterValues=selectedMAFilter[filterType];if(filterValues.length>0){let subHtml="";filterValues.length>1&&(subHtml='<sub data-menu-id="filterAdditional_list" id="filterCount" filterId="'+filterElement+'">+'+(filterValues.length-1)+"</sub>"),selectCnt<=3?html+='<li class="w250" name="BreadCrumbElement" fieldObj=\''+JSON.stringify({filterElementId:filterElement,filterElementType:filterElementType})+"'><label>"+headerName+':</label><span title="'+filterValues[0]+'">'+filterValues[0]+"</span>"+subHtml+'<a id="filterTypeClose" class="PI_cls" filterid="'+filterElement+'" title="'+ZPI18N.getString("zp.remove")+'"></a></li>':isMore||(isMore=!0,html+='<li class="zpl_mre" id="ma_fltr_more"><i class="PI_more d-flex"></i></li>'),selectCnt++}};return selectedMAFilter.employeeNames&&constructFilter("employeeNames",ZPI18N.getString("zp.employee"),"emp_search","tokenField"),selectedMAFilter.designationNames&&constructFilter("designationNames",ZPI18N.getString("zp.designation"),"designation_search","selectField"),selectedMAFilter.departmentNames&&constructFilter("departmentNames",ZPI18N.getString("zp.department"),"dept_search","selectField"),selectedMAFilter.locationNames&&constructFilter("locationNames",ZPI18N.getString("zp.location"),"loct_search","selectField"),selectedMAFilter.levelNames&&constructFilter("levelNames",ZPI18N.getString("zp.level"),"level_search","selectField"),html},removeMaSelectedFilter:function(element){var _sliderDiv=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv);"emp_search"===element?ZPeopleComponents.tokenfield(_sliderDiv.find("#"+element)).removeAllTokens():ZPeopleComponents.select(_sliderDiv.find("#"+element)).deselectAllOptions(),PMSOperation.showAppraisalUserList()},onclickMaBreadCrumb:function(event,obj){let filterFieldId=$(event.target).attr("id"),filterFieldObj=JSON.parse($(obj).attr("fieldobj"));if(void 0===filterFieldId||"filterTypeClose"!==filterFieldId&&"filterCount"!==filterFieldId)PMSOperation.showhideMngeAppraiseeFilter(!1,obj);else{let filterId=$(event.target).attr("filterid");"filterTypeClose"===filterFieldId?PMSOperation.removeMaSelectedFilter(filterId):"filterCount"===filterFieldId&&PMSOperation.appendAdditionalMAValues(filterFieldObj)}},appendAdditionalMAValues:function(filterFieldObj){let filterValue="";var _sliderDiv=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv),divId="filterAdditional_list",forElementId="[filterid="+filterFieldObj.filterElementId+"]";0!==$("#"+divId).length&&(ZPeopleComponents.menu("#"+divId).destroy(),$("#"+divId).remove());let searchParams={empObj:[],deptval:[],desival:[],lvlval:[],loctval:[]},paramFieldObj="";ZPeopleComponents.isComponent($(_sliderDiv).find("#emp_search"))&&void 0!==ZPeopleComponents.tokenfield($(_sliderDiv).find("#emp_search")).getAllValues()&&"-1"!=ZPeopleComponents.tokenfield($(_sliderDiv).find("#emp_search")).getAllValues()[0]&&(searchParams.empObj=ZPeopleComponents.tokenfield($(_sliderDiv).find("#emp_search")).getAllValues(),"emp_search"===filterFieldObj.filterElementId&&(paramFieldObj="employeeNames"));var depSearch=$(_sliderDiv).find("#dept_search");ZPeopleComponents.isComponent(depSearch)&&void 0!==ZPeopleComponents.select(depSearch).getValues()&&(searchParams.deptval=0==ZPeopleComponents.select(depSearch).getValues().length?["-1"]:ZPeopleComponents.select(depSearch).getValues(),"dept_search"===filterFieldObj.filterElementId&&(paramFieldObj="departmentNames"));var desSearch=$(_sliderDiv).find("#designation_search");ZPeopleComponents.isComponent(desSearch)&&void 0!==ZPeopleComponents.select(desSearch).getValues()&&(searchParams.desival=0==ZPeopleComponents.select(desSearch).getValues().length?["-1"]:ZPeopleComponents.select(desSearch).getValues(),"designation_search"===filterFieldObj.filterElementId&&(paramFieldObj="designationNames"));var levelSearch=$(_sliderDiv).find("#level_search");if(levelSearch.length>0&&ZPeopleComponents.isComponent(levelSearch)){var levelValues=ZPeopleComponents.select(levelSearch).getValues();void 0!==levelValues&&(searchParams.lvlval=0==levelValues.length?["-1"]:levelValues),"level_search"===filterFieldObj.filterElementId&&(paramFieldObj="levelNames")}var loctSearch=$(_sliderDiv).find("#loct_search");ZPeopleComponents.isComponent(loctSearch)&&void 0!==ZPeopleComponents.select(loctSearch).getValues()&&(searchParams.loctval=0==ZPeopleComponents.select(loctSearch).getValues().length?["-1"]:ZPeopleComponents.select(loctSearch).getValues(),"loct_search"===filterFieldObj.filterElementId&&(paramFieldObj="locationNames"));let selectedMAFilter=PMSOperation.constructSelectedMAFilter(searchParams,!0);if(void 0!==(filterValue=void 0!==paramFieldObj&&Object.keys(selectedMAFilter).includes(paramFieldObj)&&void 0!==selectedMAFilter[paramFieldObj]&&selectedMAFilter[paramFieldObj].length>0?selectedMAFilter[paramFieldObj]:void 0)&&void 0!==filterFieldObj.filterElementId){var actionsList=[];if($(filterValue).each(function(index,filterDts){if(0!==index){let menuId="",optionId=filterDts.id,textValue=filterDts.value;menuId=optionId+"_addi_"+filterFieldObj.filterElementId;let _htm="<span>"+textValue+'</span><a class="PI_cls" id="addiFilterClose" title="'+ZPI18N.getString("zp.remove")+'"></a>';actionsList.push({id:menuId,itemType:"custom",innerHTML:_htm,optionId:optionId,filterFieldType:filterFieldObj.filterElementType,filterFieldId:filterFieldObj.filterElementId})}}),actionsList.length>0){var tokenObj={displayType:"box"};tokenObj.forElement=forElementId,tokenObj.itemclick=PMSOperation.onAdditionalValuesMAClickAction,tokenObj.className="zpl_drpdwn zpl_fltrvwlst",tokenObj.width=250,ZPeopleComponents.createMenu(divId,actionsList,tokenObj),ZPeopleComponents.menu("#"+divId).show()}}},onAdditionalValuesMAClickAction:function(event,data){var pageId=PMSOperation.manageAppraiseeSliderObj.sliderDiv;if(void 0===$(data.originalEvent.target).attr("id")||"addiFilterClose"!==$(data.originalEvent.target).attr("id"))return!1;let optionId=data.id;ZPeopleComponents.menu("#filterAdditional_list").removeMenuItem("#"+optionId),void 0!==data.filterFieldType&&void 0!==data.optionId&&void 0!==data.filterFieldId&&("tokenField"===data.filterFieldType?ZPeopleComponents.tokenfield(pageId.find("#"+data.filterFieldId)).removeTokens([data.optionId]):"selectField"===data.filterFieldType&&ZPeopleComponents.select(pageId.find("#"+data.filterFieldId)).removeOption([data.optionId]));let optionCount=$(ZPeopleComponents.menu("#filterAdditional_list").getElement()).find("ul").children().length;if(0!==optionCount){let editText="+"+optionCount;$(data.target[0]).html(editText)}else ZPeopleComponents.isComponent("#filterAdditional_list")&&ZPeopleComponents.menu("#filterAdditional_list").hide(),$(data.forElement[0]).remove();return PMSOperation.showAppraisalUserList(void 0,!1,!0),0===optionCount&&void 0},applicableUserCount:function(){var slideObj=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv),params={mode:"applicableUsercount",conreqcsr:csrfToken};params.configId=slideObj.find("#configId").val(),params.status=slideObj.find("#appraisalstatus").val(),ZPeople.Request.send("/performanceConfig.zp",params,PMSOperation.responseforapplicableusercount)},responseforapplicableusercount:function(resultData){var pageId=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv);pageId.find("#zp_revstatus_usermanagement_recordcount").removeClass("DN"),pageId.find("#zp_revstatus_usermanagement_recordcount").text(resultData.recordcount),PMSOperation.ApplicableUsercount=resultData.recordcount,PMSOperation.ApplicableUsercount>0?$('[id="menuiconimpexpmanageuser"]').find('[id="zp_manageuser_exp"]').removeClass("zpl_DNI"):$('[id="menuiconimpexpmanageuser"]').find('[id="zp_manageuser_exp"]').addClass("zpl_DNI")},responseforpreviewofapplicableuser:function(resultData,params,scrollaction){var parseObj=resultData;PMSOperation.hideMngeAppraiseeFilter();var slideObj=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv);if(slideObj.find("#zp_page_loading").length>0){slideObj.find("#userManagementDivTable").empty().html(PMSOperation.constructMAUserListHeader());var mapMenu=ZPeopleComponents.menu("#zp_view_sorting",{forElement:"#zp_view_sortingbtn",itemclick:event=>{PMSOperation.groupByOrder(event)}});slideObj.find("#zp_view_sortingbtn").on("click",function(ev){mapMenu.show()})}var appraisalStatus=slideObj.find("#appraisalstatus").val(),sortingBtn=slideObj.find("#zp_view_sortingbtn");"-1"===appraisalStatus?slideObj.find("#reviewerstatus, #zp_view_sortingbtn").hide():sortingBtn.show(),PMSOperation.startIndex+=resultData.length,void 0===resultData[0].msg&&resultData.length<100&&settingsPage.fireScrollObj.hasOwnProperty("previewofappraisalusers")&&settingsPage.fireScrollObj.previewofappraisalusers.reset(),slideObj.find("#zp_revstatus_usermanagement_recordcount").hasClass("DN")&&PMSOperation.applicableUserCount();var row="",erecNo=null;if($.each(parseObj,function(index,data){void 0===data.msg||null===data.msg?(PMSOperation.Applicableuserlastnocrt=null,null!=PMSOperation.isGroupByOrder?(data.appraiserErecNo!=erecNo&&(erecNo=data.appraiserErecNo,void 0==data.isreviewerselected||data.isreviewerselected?row+='<tr> <td colspan="100" class="--thmgryclr"> <div class="zpl_em"> <div class="zpl_emdts"> <div><em>'+data.appraiserEmpId+"&nbsp;-&nbsp;</em><b>"+data.appraiser+"</b></div> </div> </div> </td> </tr>":row+='<tr> <td colspan="100" class="--thmgryclr"> <div class="zpl_em"> <div class="zpl_emdts"> <div><em></em><b>'+ZPI18N.getString("zp.reviewernotselected")+"</b></div> </div> </div> </td> </tr>"),row+='<tr  id="userpopup_'+data.recordId+'">',row+='<td><div class="zcheckbox"><input id="'+data.recordId+'" type="checkbox" name="check" class="zcheckbox__helper"><label for="'+data.recordId+'" class="zcheckbox__label"></label></div></td>',row+="<td>",row+='<div class="zpl_em">',row+='<div class="zpl_emimg" module="pms" popup="user" empid="'+data.zuid+'"><img src="'+data.photopath+'"></div>',row+='<div class="zpl_emdts">',row+="<div><em>"+data.empId+" - </em><b>"+data.empdisplayname+"</b></div>",""==data.designationName&&""==data.deptName||(row+="<em>"+data.designationName+"&nbsp;-&nbsp;"+data.deptName+"</em>"),row+="</div></div></td>",void 0==data.isreviewerselected||data.isreviewerselected?(row+='<td id="appriaser" val= '+data.appraiserErecNo+'> <div class="zpl_em"> <div class="zpl_emdts"> <div>',data.appraiserEmpId&&-1==data.appraiserEmpId.indexOf("_deleted")&&(row+="<em>"+data.appraiserEmpId+"&nbsp;-&nbsp;</em>"),row+="<b> "+data.appraiser+"</b></div> </div> </div> </td>"):(row+='<td id="appriaser"> <div class="zpl_em"> <div class="zpl_emdts"> <div>',data.appraiserEmpId&&-1==data.appraiserEmpId.indexOf("_deleted")&&(row+="<em>"+data.appraiserEmpId+"&nbsp;-&nbsp;</em>"),row+="<b>"+data.appraiser+"&nbsp;"+ZPI18N.getString("zp.revieweryettochoose")+"</b></div> </div> </div> </td>"),SalaryHikeV2Cycle.isSalaryHikeCycle?-2==data.status||-1==data.status?row+='<td><span class="org">'+ZPI18N.getString("zp.pending")+"</span></td>":1!=data.status&&3!=data.status||(row+='<td><span class="grn">'+ZPI18N.getString("zp.completed")+"</span></td>"):0==data.status||-1==data.status||-3==data.status||-4==data.status||2==data.status?row+='<td><span class="org">'+ZPI18N.getString("zp.pending")+"</span></td>":1==data.status&&(row+='<td><span class="grn">'+ZPI18N.getString("zp.completed")+"</span></td>"),row+='<td> <div class="zpl_hvr">',SalaryHikeV2Cycle.isSalaryHikeCycle||-1==slideObj.find("#appraisalstatus").val()||5==slideObj.find("#appraisalstatus").val()||(row+='<button type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small" onclick="PMSOperation.individualChangeReviewer(\''+data.erecNo+"')\">"+ZPI18N.getString("zp.changereviewer")+"</button>"),5!=slideObj.find("#appraisalstatus").val()&&(row+='<button type="button" class="zlabel zlabel--red zlabel--small" onclick="PMSOperation.individualExclude(\''+data.erecNo+"');\">"+ZPI18N.getString("zp.exclude")+"</button>"),row+="</div></td>"):(row+='<tr  id="userpopup_'+data.recordId+'">',row+='<td><div class="zcheckbox"><input id="'+data.recordId+'" type="checkbox" name="check" class="zcheckbox__helper"><label for="'+data.recordId+'" class="zcheckbox__label"></label></div></td>',row+="<td>",row+='<div class="zpl_em">',row+='<div class="zpl_emimg" popup="user" empid="'+data.zuid+'" module="pms"><img src="'+data.photopath+'"></div>',row+='<div class="zpl_emdts">',row+="<div><em>"+data.empId+" - </em><b>"+data.empdisplayname+"</b></div>",""==data.designationName&&""==data.deptName||(row+="<em>"+data.designationName+"&nbsp;-&nbsp;"+data.deptName+"</em>"),row+="</div></div></td>",void 0==data.isreviewerselected||data.isreviewerselected?(row+='<td id="appriaser" val= '+data.appraiserErecNo+'> <div class="zpl_em"> <div class="zpl_emdts"> <div>',data.appraiserEmpId&&-1==data.appraiserEmpId.indexOf("_deleted")&&(row+="<em>"+data.appraiserEmpId+"&nbsp;-&nbsp;</em>"),row+="<b> "+data.appraiser+"</b></div> </div> </div> </td>"):(row+='<td id="appriaser"> <div class="zpl_em"> <div class="zpl_emdts"> <div>',data.appraiserEmpId&&-1==data.appraiserEmpId.indexOf("_deleted")&&(row+="<em>"+data.appraiserEmpId+"&nbsp;-&nbsp;</em>"),row+="<b>"+data.appraiser+"&nbsp;"+ZPI18N.getString("zp.revieweryettochoose")+"</b></div> </div> </div> </td>"),SalaryHikeV2Cycle.isSalaryHikeCycle?-2==data.status||-1==data.status?row+='<td><span class="org">'+ZPI18N.getString("zp.pending")+"</span></td>":1!=data.status&&3!=data.status||(row+='<td><span class="grn">'+ZPI18N.getString("zp.completed")+"</span></td>"):0==data.status||-1==data.status||-3==data.status||-4==data.status||2==data.status?row+='<td><span class="org">'+ZPI18N.getString("zp.pending")+"</span></td>":1==data.status&&(row+='<td><span class="grn">'+ZPI18N.getString("zp.completed")+"</span></td>"),row+='<td> <div class="zpl_hvr">',SalaryHikeV2Cycle.isSalaryHikeCycle||-1==slideObj.find("#appraisalstatus").val()||5==slideObj.find("#appraisalstatus").val()||(row+='<button type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small" onclick="PMSOperation.individualChangeReviewer(\''+data.erecNo+"')\">"+ZPI18N.getString("zp.changereviewer")+"</button>"),5!=slideObj.find("#appraisalstatus").val()&&(row+='<button type="button" class="zlabel zlabel--red zlabel--small" onclick="PMSOperation.individualExclude(\''+data.erecNo+"');\">"+ZPI18N.getString("zp.exclude")+"</button>"),row+="</div></td>"),PMSOperation.tempAppraisee.push(data.erecNo)):"no users"===data.msg&&(scrollaction||(row=slideObj.find("#selectedfltrlst").children().length>0&&$("#selectedfltrlst").is(":visible")?'<tr id="nousersforcycle"><td colspan="6" align="center"><div class="zpl_Emptydata" id="emptPage"><div><div class="zpl_emptimg zp_nd_nodata"></div><h4>'+ZPI18N.getString("zp.searchnodata",[ZPI18N.getString("zp.employee")])+"</h4><p></p></div></div></td></tr>":'<tr id="nousersforcycle"><td colspan="6" align="center"><div class="zpl_Emptydata" id="emptPage"><div><div class="zpl_emptimg zp_nd_empprfl"></div><h4>'+ZPI18N.getString("zp.noemployeesapplicable")+"</h4><p></p></div></div></td></tr>",PMSOperation.Applicableuserlastnocrt=params.searchval,PMSOperation.isGroupByOrder=null,slideObj.find("#zp_view_sortingbtn").hide(),slideObj.find("#appraisee_tbody").empty().append($(row))))}),void 0==resultData[0].msg){if(1==params.sIndex&&slideObj.find("#appraisee_tbody").empty(),slideObj.find("#appraisee_tbody").append($(row)),slideObj.find(".zcheckbox").unbind(),slideObj.find(".zcheckbox input").on("click",function(){var dataid=$(this).attr("id");PMSOperation.addSelectedAppraisee($(this),dataid)}),100==resultData.length){settingsPage.fireScrollObj.hasOwnProperty("previewofappraisalusers")&&(settingsPage.fireScrollObj.previewofappraisalusers.reset(),delete settingsPage.fireScrollObj.previewofappraisalusers);new FireScrollBack(PMSOperation.showAppraisalUserLislfirescroll,$(PMSOperation.manageAppraiseeSliderObj.sliderDiv).find("#cardappraisalemptagslider"),"previewofappraisalusers")}ZPeopleComponents.tooltip(slideObj.find("#appraisee_tbody"),{})}},constructMAUserListHeader:function(){var htm="<thead>";return htm+='<tr id="teamdata">',htm+='<th width="5%">',htm+="</th>",htm+="<th>"+ZPI18N.getString("zp.employee"),SalaryHikeV2Cycle.isSalaryHikeCycle?htm+='<th id="userManagement_Appraiser">'+ZPI18N.getString("zp.hikeDecider"):htm+='<th id="userManagement_Appraiser">'+ZPI18N.getString("zp.reviewer"),htm+='<div class="zpl_icncnt"><i class="PI_sort" data-menu-id="zp_view_sorting" id="zp_view_sortingbtn"  value="'+ZPI18N.getString("zp.reportingto")+'" ralname="Reporting_To" ftype="1"></i></div>',htm+='<div id="zp_view_sorting" class="zpl_drpdwn" data-type="list" data-direction="auto" data-display-type="box"  data-content-type="icon-text"><ul>',htm+='<li id="ascending" data-item-type="checkbox">'+ZPI18N.getString("zp.asc")+"</li>",htm+='<li id="descending" data-item-type="checkbox">'+ZPI18N.getString("zp.desc")+"</li>",htm+="</ul></div>",htm+="</div></th>",SalaryHikeV2Cycle.isSalaryHikeCycle?htm+='<th id="reviewerstatus">'+ZPI18N.getString("zp.module.status",new Array(PMSV2Cycle.SALARYHIKENAME))+"</th>":htm+='<th id="reviewerstatus">'+ZPI18N.getString("zp.reviewerreview")+" "+ZPI18N.getString("zp.status")+"</th>",htm+='<th class="zpl_mw260"></th>',htm+="</tr>",htm+="</thead>",htm+='<tbody id="appraisee_tbody"></tbody>'},showAppraisalUserLislfirescroll:function(){PMSOperation.showAppraisalUserList("",!0)},addSelectedAppraisee:function(obj,erecNo){var pageId=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv);$(obj).is(":checked")?PMSOperation.appraiseeArr.length<20?(PMSOperation.appraiseeArr.push(erecNo),PMSOperation.currentReviewer=$(obj).parent().parent().parent().find("#appriaser").attr("val"),5==pageId.find("#appraisalstatus").val()?(pageId.find("#appraiseeListUpdate").removeClass("opn"),pageId.find("#includeEmployeeTitle").hide()):(pageId.find("#appraiseeListUpdate").addClass("opn"),pageId.find("#includeEmployeeTitle").show()),-1==pageId.find("#appraisalstatus").val()||5==pageId.find("#appraisalstatus").val()||SalaryHikeV2Cycle.isSalaryHikeCycle?pageId.find("#changeAppraiser").hide():pageId.find("#changeAppraiser").show()):(ZPeople.Message.warning(ZPI18N.getString("zp.maxExcludeEmpSelectMsg")),$(obj).prop("checked",!1)):(PMSOperation.appraiseeArr.splice(PMSOperation.appraiseeArr.indexOf(erecNo),1),PMSOperation.appraiseeArr.length<PMSOperation.tempAppraisee.length&&0==PMSOperation.appraiseeArr.length&&pageId.find("#appraiseeListUpdate").removeClass("opn"))},individualExclude:function(erecno){PMSOperation.appraiseeArr=[],PMSOperation.individualChangeOrExclude=!0,PMSOperation.appraiseeArr.push(erecno),PMSOperation.ExclueUser(erecno)},ExclueUser:function(recordId){var slideObj=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv),params={mode:"excludeuser",conreqcsr:csrfToken};params.configId=slideObj.find("#configId").val(),Object.keys(PMSOperation.manageAppraiseeSliderObj).length>0&&(params.employeeArray=JSON.stringify(PMSOperation.appraiseeArr)),params.status=slideObj.find("#appraisalstatus").val(),ZPeople.Request.send("/performanceConfig.zp",params,PMSOperation.excludeuserresponse)},excludeuserresponse:function(resultData,param){var slideObj=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv);if("success"===resultData.msg||"no_user_excluded"===resultData.msg){let hasReviewEmp=void 0==param.excludeReviewedEmp&&void 0!=resultData.reviewedEmpArr&&resultData.reviewedEmpArr.length>0,hasEsignLettersendUser=void 0!=resultData.notRecalledUserlist&&resultData.notRecalledUserlist.length>0;if(hasReviewEmp||hasEsignLettersendUser){var apprTxt="";PMSOperation.isSelfAppraisalEnabled&&(apprTxt=ZPI18N.getString("zp.selfappraisal")),PMSOperation.isMultiRaterEnabled&&(apprTxt+=""!=apprTxt?", "+PMSSetting.MULTIRATER_DISPLAY_NAME:PMSSetting.MULTIRATER_DISPLAY_NAME),PMSOperation.isHikeEnabled?(apprTxt+=""!=apprTxt?", "+ZPI18N.getString("zp.reviewerreview"):ZPI18N.getString("zp.reviewerreview"),apprTxt+=" "+ZPI18N.getString("zp.or")+" "+ZPI18N.getString("zp.appraisalhike")):apprTxt+=""!=apprTxt?" "+ZPI18N.getString("zp.or")+" "+ZPI18N.getString("zp.reviewerreview"):ZPI18N.getString("zp.reviewerreview");var excludeTxt=ZPI18N.getString("zp.excludeExceptionMsg",new Array(apprTxt))+"<br>"+ZPI18N.getString("zp.excludeMsg")+"<br>"+ZPI18N.getString("zp.empSelectToExcludeMsg");let isAppraisalLetterEnabled=PMSESign.isAppraisalLetterEnabled(PMSOperation.temp,param.configId);if(isAppraisalLetterEnabled){PMSESign.isAppraisalEsignEnabled(PMSOperation.temp,param.configId)&&(excludeTxt+="<br>"+ZPI18N.getString("zp.paesign.excluderecallsignedusermsg"))}const sliderTab=new Tab("nouserexclude",function(){$("#cardnouserexclude").append(ZPeople.LOADING_HTML);var _htm='<div class="zpl_info" style="margin-bottom: 20px;"><div><p id="excludeMessage">'+excludeTxt+"</p></div></div>";_htm+='<div class="zpl_btnmnu"><div class="zpl_nowrap"><ul class="zpl_grpmnulnelst">',_htm+="<li>"+ZPI18N.getString("zp.excludedCount")+'<b class="ylw id="successExcludeCount">'+resultData.erecno.length+"</b></li>",_htm+="<li>"+ZPI18N.getString("zp.notExcludedCount")+'<b class="ylw" id="failedExcludeCount">'+(resultData.reviewedEmpArr.length+(hasEsignLettersendUser?resultData.notRecalledUserlist.length:0))+"</b></li></ul></div></div>",_htm+='<div class="zpl_btnmnu zpl_DNI" id="ExcludeUserSummaryView"><div class="zpl_nowrap"><ul class="zpl_grpmnu" id="ExcludeUserSummary_Filter">',_htm+='<li id="reviewcompleted_toggle" status="1" class="zpl_act"><span>'+ZPI18N.getString("zp.paesign.reviewcompleteduser")+'</span><div class="zpl_tg"><span id="reviewcompletedcnt"><b></b></span></div></li>',_htm+='<li id="lettersent_toggle" status="2"><span>'+ZPI18N.getString("zp.paesign.yettosignuser")+'</span><div class="zpl_tg"><span id="esignlettersendcnt" ><b></b></span></div></li>',_htm+='<li id="signedletter_toggle" status="3"><span>'+ZPI18N.getString("zp.paesign.signeduser")+'</span><div class="zpl_tg"><span id="signedlettercnt" ><b></b></span></div></li>',_htm+="</ul></div></div>",_htm+='<div class="zpl_crd" id="excludeReviewCompletedUser">',_htm+='<div class="zpl_crdcnt">',_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_tblres">',_htm+='<table class="zpl_tbl wd100_per" id="notExcEmpDiv"><thead>',_htm+='<tr><th style="width: 8%;">',_htm+='<div class="zcheckbox" id="excludeRevEmpChkBox" onclick="PMSOperation.enableDisableAll(this)"><input id="nouserexcluded" type="checkbox" name="check" class="zcheckbox__helper">',_htm+='<label for="nouserexcluded" class="zcheckbox__label"></label></div></th>',_htm+='<th><button type="button" class="zlabel zlabel--red zlabel--small" id="excludeRevEmpButton" onclick="PMSOperation.backupAndExcludeReviewedEmp()" value="Exclude" disabled>'+ZPI18N.getString("zp.exclude")+"</button></th></tr>",_htm+='</thead><tbody id="notExcEmpBody"></tbody></table></div></div></div></div>',_htm+='<div class="zpl_crd zpl_DNI" id="recallEsignLettercrd">',_htm+='<div class="zpl_crdcnt">',_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_tblres">',_htm+='<table class="zpl_tbl wd100_per" id="excludeRecall"><thead>',_htm+='<tr><th style="width: 8%;">',_htm+='<div class="zcheckbox" id="excludeRecallEmpChkBox" onclick="PMSOperation.enableDisableAll(this)"><input id="noexcludeRecall" type="checkbox" name="check" class="zcheckbox__helper">',_htm+='<label for="noexcludeRecall" class="zcheckbox__label"></label></div></th>',_htm+='<th><button type="button" class="zlabel zlabel--red zlabel--small" id="excludeRecallBtn" onclick="PMSESign.backupAndRecallExcludeReviewedEmp()" value="Recall" disabled>'+ZPI18N.getString("zp.exclude")+"</button></th></tr>",_htm+='</thead><tbody id="excludeRecallTbody"></tbody></table></div></div></div></div>',_htm+='<div class="zpl_crd zpl_DNI" id="signedEsignLettercrd">',_htm+='<div class="zpl_crdcnt">',_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_tblres">',_htm+='<table class="zpl_tbl wd100_per" ><thead>',_htm+='<tr><th style="width: 8%;">',_htm+="<div>",_htm+='<label for="signedexcludelist" class="zcheckbox__label"></label></div></th>',_htm+="<th></th></tr>",_htm+='</thead><tbody id="signedexcludeTbody"></tbody></table></div></div></div></div>',$("#cardnouserexclude").html(_htm)});PMSOperation.noUserExcludeSliderObj=new sliderModal(ZPI18N.getString("zp.excludeSummary"),sliderTab),PMSOperation.noUserExcludeSliderObj.setCloseCallback(function(){PMSOperation.noUserExcludeSliderObj.remove(),PMSOperation.noUserExcludeSliderObj={},$(PMSOperation.manageAppraiseeSliderObj.sliderDiv).find("#userManagementDivTable").html(ZPeople.LOADING_HTML),Object.keys(PMSOperation.manageAppraiseeSliderObj).length>0&&(PMSOperation.startIndex=1,PMSOperation.onloadshowAppraisalUserList(!1))}),PMSOperation.noUserExcludeSliderObj.construct();var _sliderDiv=$(PMSOperation.noUserExcludeSliderObj.sliderDiv);if(_sliderDiv.find("#sliderSbt").remove(),_sliderDiv.find("#sliderCancel").text(ZPI18N.getString("zp.close")),_sliderDiv.find("#cardnouserexclude").append('<form id="zp_cycle_backup" action="paCycleBackup.zp" method="post" name="zp_cycle_backup" style="display: none;"  target="exportresp"></form>'),PMSOperation.showNotExcludedEmp(resultData.reviewedEmpArr),_sliderDiv.find("#ExcludeUserSummaryView").addClass("zpl_DNI"),_sliderDiv.find("#recallEsignLettercrd").addClass("zpl_DNI"),isAppraisalLetterEnabled=PMSESign.isAppraisalLetterEnabled(PMSOperation.temp,param.configId)){if(PMSESign.isAppraisalEsignEnabled(PMSOperation.temp,param.configId)&&hasEsignLettersendUser){_sliderDiv.find("#ExcludeUserSummaryView").removeClass("zpl_DNI"),_sliderDiv.find("#reviewcompletedcnt").html("<b>"+resultData.reviewedEmpArr.length+"</b>");var row="";let count=0;$.each(resultData.notRecalledUserlist,function(index,data){void 0==data.isEsignCompleted||data.isEsignCompleted||(row+=PMSESign.constructRecallRow(data,"Exclude"),count+=1)}),_sliderDiv.find("#esignlettersendcnt").html("<b>"+count+"</b>"),_sliderDiv.find("#excludeRecallTbody").html(row),0==count&&(_sliderDiv.find("#excludeRecallTbody").parent().addClass("zpl_DNI"),PMSOperationCommon.setNoData(_sliderDiv.find("#excludeRecallTbody").parent().parent(),ZPI18N.getString("zp.norecfound"),"zp_nd_record",null,null,null)),row="",count=0,$.each(resultData.notRecalledUserlist,function(index,data){void 0!=data.isEsignCompleted&&data.isEsignCompleted&&(row+=PMSESign.constructRecallRow(data,"signedsection"),count+=1)}),_sliderDiv.find("#signedlettercnt").html("<b>"+count+"</b>"),_sliderDiv.find("#signedexcludeTbody").html(row),0==count&&(_sliderDiv.find("#signedexcludeTbody").parent().addClass("zpl_DNI"),PMSOperationCommon.setNoData(_sliderDiv.find("#signedexcludeTbody").parent().parent(),ZPI18N.getString("zp.norecfound"),"zp_nd_record",null,null,null)),_sliderDiv.find("#ExcludeUserSummary_Filter li").on("click",function(obj){"reviewcompleted_toggle"==$(obj.currentTarget).attr("id")?(_sliderDiv.find("#excludeReviewCompletedUser").removeClass("zpl_DNI"),_sliderDiv.find("#recallEsignLettercrd").addClass("zpl_DNI"),_sliderDiv.find("#signedEsignLettercrd").addClass("zpl_DNI"),_sliderDiv.find("#reviewcompleted_toggle").addClass("zpl_act"),_sliderDiv.find("#lettersent_toggle").removeClass("zpl_act"),_sliderDiv.find("#signedletter_toggle").removeClass("zpl_act")):"lettersent_toggle"==$(obj.currentTarget).attr("id")?(_sliderDiv.find("#excludeReviewCompletedUser").addClass("zpl_DNI"),_sliderDiv.find("#recallEsignLettercrd").removeClass("zpl_DNI"),_sliderDiv.find("#signedEsignLettercrd").addClass("zpl_DNI"),_sliderDiv.find("#reviewcompleted_toggle").removeClass("zpl_act"),_sliderDiv.find("#lettersent_toggle").addClass("zpl_act"),_sliderDiv.find("#signedletter_toggle").removeClass("zpl_act")):"signedletter_toggle"==$(obj.currentTarget).attr("id")&&(_sliderDiv.find("#excludeReviewCompletedUser").addClass("zpl_DNI"),_sliderDiv.find("#recallEsignLettercrd").addClass("zpl_DNI"),_sliderDiv.find("#signedEsignLettercrd").removeClass("zpl_DNI"),_sliderDiv.find("#reviewcompleted_toggle").removeClass("zpl_act"),_sliderDiv.find("#lettersent_toggle").removeClass("zpl_act"),_sliderDiv.find("#signedletter_toggle").addClass("zpl_act"))}),0==resultData.reviewedEmpArr.length&&(PMSOperationCommon.setNoData(_sliderDiv.find("#notExcEmpDiv").parent(),ZPI18N.getString("zp.norecfound"),"zp_nd_record",null,null,null),_sliderDiv.find("#excludeReviewCompletedUser").addClass("zpl_DNI"),_sliderDiv.find("#recallEsignLettercrd").removeClass("zpl_DNI"),_sliderDiv.find("#signedEsignLettercrd").addClass("zpl_DNI"),_sliderDiv.find("#reviewcompleted_toggle").removeClass("zpl_act"),_sliderDiv.find("#lettersent_toggle").addClass("zpl_act"),_sliderDiv.find("#signedletter_toggle").removeClass("zpl_act"))}}}else void 0!=param.excludeReviewedEmp&&1==param.excludeReviewedEmp&&(PMSOperation.noUserExcludeSliderObj.close(),PMSOperation.reviewedExcludeList=[]),ZPeople.Message.success(ZPI18N.getString("zp.employeeexclude")),Object.keys(PMSOperation.manageAppraiseeSliderObj).length>0&&(PMSOperation.startIndex=1,PMSOperation.onloadshowAppraisalUserList(!1));PMSOperation.showAppraiseeList(!1)}else"cycleclose_error"===resultData.msg?ZPeople.Message.failure(resultData.message):"normalizeErr"==resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.excludeUserErrAfterNormaliz")):(slideObj.find("#userpopup_"+resultData.erecno).show(),ZPeople.Message.failure(ZPI18N.getString("zp.errorinexclude")))},showNotExcludedEmp:function(empList){PMSOperation.tempNonExcludeList=[];var row="";$.each(empList,function(index,data){row+='<tr id="'+data.recordId+'"><td><div class="zcheckbox">',data.isEsignCompleted?row+='<input id="Include_'+data.recordId+'" type="checkbox" name="check" class="zcheckbox__helper disabled" disabled>':(PMSOperation.tempNonExcludeList.push(data.recordId),row+='<input id="Include_'+data.recordId+'" type="checkbox" name="check" class="zcheckbox__helper" onclick="PMSOperation.addExcludeReviewedEmp(this)">'),row+='<label for="Include_'+data.recordId+'" class="zcheckbox__label"></label></div></td>',row+='<td><div class="zpl_em">',row+='<div class="zpl_emimg"><img src="'+data.empPhoto+'"></div>',row+='<div class="zpl_emdts"><div><em>'+data.empId+" - </em><b>"+data.name+"</b></div></div></div> </td> </tr>"}),$(PMSOperation.noUserExcludeSliderObj.sliderDiv).find("#notExcEmpBody").html(row)},addExcludeReviewedEmp:function(obj){var pageId=$(PMSOperation.noUserExcludeSliderObj.sliderDiv),userId=$(obj).closest("tr").attr("id"),excludeBtn=pageId.find("#excludeRevEmpButton");$(obj).is(":checked")?(PMSOperation.reviewedExcludeList.push(userId),excludeBtn.prop("disabled",!1),PMSOperation.reviewedExcludeList.length==PMSOperation.tempNonExcludeList.length&&pageId.find("#excludeRevEmpChkBox input").prop("checked",!0)):(PMSOperation.reviewedExcludeList.splice(PMSOperation.reviewedExcludeList.indexOf(userId),1),PMSOperation.reviewedExcludeList.length<PMSOperation.tempNonExcludeList.length&&pageId.find("#excludeRevEmpChkBox input").prop("checked",!1),PMSOperation.reviewedExcludeList.length>0?excludeBtn.prop("disabled",!1):excludeBtn.prop("disabled",!0))},backupAndExcludeReviewedEmp:function(){if(PMSOperation.reviewedExcludeList.length>0){var infoPopUp=new InfoAlertMessage;infoPopUp.title=ZPI18N.getString("zp.excludeEmp"),infoPopUp.despcription=ZPI18N.getString("zp.excludeConfirmationBackupMsg"),infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){var container=$(PMSOperation.noUserExcludeSliderObj.sliderDiv);container.find("#notExcEmpDiv").find("tbody input[type='checkbox']").prop("disabled",!0),container.find("#excludeRevEmpChkBox").find("input[type='checkbox']").prop("disabled",!0),PMSOperation.backUpCycleData(PMSOperation.reviewedExcludeList)},infoPopUp.show()}},excludeReviewedEmp:function(){$(PMSOperation.noUserExcludeSliderObj.sliderDiv);if(PMSOperation.reviewedExcludeList.length>0){const params={mode:"excludeuser",excludeReviewedEmp:!0,conreqcsr:csrfToken,configId:$(PMSOperation.manageAppraiseeSliderObj.sliderDiv).find("#configId").val(),employeeArray:JSON.stringify(PMSOperation.reviewedExcludeList),status:$(PMSOperation.manageAppraiseeSliderObj.sliderDiv).find("#appraisalstatus").val()};ZPeople.Request.send("/performanceConfig.zp",params,PMSOperation.excludeuserresponse)}},backUpCycleData:function(empList,isFromRecall){var formObj=$(PMSOperation.noUserExcludeSliderObj.sliderDiv).find("#zp_cycle_backup").html("");formObj.append('<input type="hidden" value="xls" name="ftype"/>'),formObj.append('<input type="hidden" value="'+csrfToken+'" name="'+csrfParamName+'"/>'),formObj.append('<input type="hidden" value="cyclebackup" name="submode"/>');var configId=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv).find("#configId").val();formObj.append('<input type="hidden" value="'+configId+'" name="configId"/>'),formObj.append('<input type="hidden" value=\''+JSON.stringify(empList)+'\'  name="employeeArr"/>'),formObj.append('<input type="hidden" value="true" name="isnewui"/>'),void 0!=isFromRecall&&isFromRecall?formObj.append('<input type="hidden" value="true" name="isFromRecall"/>'):formObj.append('<input type="hidden" value="false" name="isFromRecall"/>'),formObj.submit()},deleteCycleConfirm:function(obj){var periodId=$(obj).parents(".zpl_catlst").attr("configid");if(void 0!==periodId&&null!==periodId){for(var isAllowedToDelete=!1,isCycleDeleteRequestPending=!1,index=0;index<PMSOperation.temp.length;index++){var data=PMSOperation.temp[index];void 0!=data&&void 0!=data.configId&&data.configId==periodId&&(void 0!=data.isAllowedToDeleteCycle&&data.isAllowedToDeleteCycle&&(isAllowedToDelete=!0),void 0!=data.isCycleDeleteRequestPending&&data.isCycleDeleteRequestPending&&(isCycleDeleteRequestPending=!0))}if(PMSOperation.deleteCyclePopUp=new DeleteAlertMessage,PMSOperation.deleteCyclePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),PMSOperation.deleteCyclePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),isAllowedToDelete)SalaryHikeV2Cycle.isSalaryHikeCycle?PMSOperation.deleteCyclePopUp.title=ZPI18N.getString("zp.lms.entitydelete",[ZPI18N.getString("zp.salaryhikecycle",[PMSV2Cycle.SALARYHIKENAME])]):PMSOperation.deleteCyclePopUp.title=ZPI18N.getString("zp.lms.entitydelete",[ZPI18N.getString("zp.appraisalcycle")]),PMSOperation.deleteCyclePopUp.despcription=ZPI18N.getString("zp.cycledeletewarningmsg"),PMSOperation.deleteCyclePopUp.callback=function(){PMSOperation.deletePeriodDetails(periodId)};else{if(isCycleDeleteRequestPending)return void ZPeople.Message.warning(ZPI18N.getString("zp.performance.cycledeleterequestpending"));PMSOperation.deleteCyclePopUp.title=ZPI18N.getString("zp.performance.cycledeletesentrequestheader"),PMSOperation.deleteCyclePopUp.despcription=ZPI18N.getString("zp.performance.cycledeletesentrequestbody"),PMSOperation.deleteCyclePopUp.centerHtml='<textarea class="ztextbox" spellcheck="false" id="cycledeleterequest_comment" placeholder="Your Comments.."></textarea><span class="ztextbox--error__label DN" id="cycledeleterequest_errmsg"></span>',PMSOperation.deleteCyclePopUp._centerDN="",PMSOperation.deleteCyclePopUp.removeAfterYes=!1,PMSOperation.deleteCyclePopUp.callback=function(){PMSOperation.sentAppraisalCycleDeleteRequest(periodId)}}PMSOperation.deleteCyclePopUp.setCloseCallback=function(){PMSOperation.deleteCyclePopUp.remove(),PMSOperation.deleteCyclePopUp={}},PMSOperation.deleteCyclePopUp.show()}},sentAppraisalCycleDeleteRequest:function(configId){var alertDiv=PMSOperation.deleteCyclePopUp.alertDiv;alertDiv.find("#cycledeleterequest_comment").removeClass("ztextbox__error"),alertDiv.find("#cycledeleterequest_errmsg").addClass("DN");var reason=alertDiv.find("#cycledeleterequest_comment").val();return reason&&""!==reason.trim()?reason.trim().length>250?(alertDiv.find("#cycledeleterequest_comment").addClass("ztextbox__error"),void alertDiv.find("#cycledeleterequest_errmsg").text(ZPI18N.getString("zp.leave.cancell.error.reasonlength")).removeClass("DN")):void PMSOperation.deletePeriodDetails(configId,void 0,reason):(alertDiv.find("#cycledeleterequest_comment").addClass("ztextbox__error"),void alertDiv.find("#cycledeleterequest_errmsg").text(ZPI18N.getString("zp.invcancelreason")).removeClass("DN"))},deletePeriodDetails:function(periodId,isimport,reason){var pageId=settingsPage.container;if(void 0!==periodId&&null!==periodId){var params={mode:"deletePeriodDetails",periodId:periodId};null!=isimport&&(params.isimport=isimport),void 0!=reason&&(params.description=reason),ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){$.each(resultData,function(inde,data){if("success"===data.msg){PMSOperation.CY_FS_ST_IDX--,pageId.find("#appraisal_row_"+periodId).remove(),PMSOperation.IS_ACTIVE_CYCLE_ONLY?PMSOperation.updateActiveCycleCount(pageId,"subtract"):PMSOperation.updateCompletedCycleCount(pageId,"subtract");const selectedIndex=PMSOperation.temp.findIndex(obj=>obj.configId===periodId);-1!==selectedIndex&&PMSOperation.temp.splice(selectedIndex,1),ZPeople.Message.success(ZPI18N.getString("zp.appperioddeletedsuccess"));let existActiveCycCnt=pageId.find("#cycleTableBody [id^=appraisal_row_]").length,existCompCycCnt=pageId.find("#CompeletedCycleTableBody [id^=appraisal_row_]").length,isLoadData=!1;PMSOperation.IS_ACTIVE_CYCLE_ONLY?existActiveCycCnt<10&&existActiveCycCnt!==PMSOperation.cycleStatusObj.activeCycleCount&&(isLoadData=!0):existCompCycCnt<10&&existCompCycCnt!==PMSOperation.cycleStatusObj.completedCycleCount&&(isLoadData=!0),isLoadData?PMSOperation.cyfireScrollCallBack():(PMSOperation.IS_ACTIVE_CYCLE_ONLY&&0===existActiveCycCnt||!PMSOperation.IS_ACTIVE_CYCLE_ONLY&&0===existCompCycCnt)&&PMSOperation.setNoDataForCycleListing(pageId,!PMSOperation.IS_ACTIVE_CYCLE_ONLY)}else"request_sent"==data.msg?(ZPeople.Message.success(ZPI18N.getString("zp.performance.cycledeleterequestsent")),$.each(PMSOperation.temp,function(index,data1){data1.configId==periodId&&(PMSOperation.temp[index].isCycleDeleteRequestPending=!0)})):"request_pending"==data.msg?ZPeople.Message.warning(ZPI18N.getString("zp.performance.cycledeleterequestpending")):"invalidreason"==data.msg&&ZPeople.Message.warning(ZPI18N.getString("zp.invcancelreason"));PMSOperation.deleteCyclePopUp.close()})})}},getChooseTmplPage:function(){var pageId=settingsPage.container;pageId.html(""),PMSOperation.getCycleTmplPage(),pageId.append(PMSOperation.CYCLE_LIST_TEMPLATE_PAGE),PMSOperation.chooseTemplate()},chooseTemplate:function(){var pageId=settingsPage.container;if(pageId.find("#cycleListDiv").hide(),pageId.find("#chooseTemplateDiv").show(),pageId.find("#chooseTemplateDiv #tmplLstID").empty(),null===PMSOperation.LOAD_TMPL_DATA){ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"tmplList"},function(resultData){PMSOperation.LOAD_TMPL_DATA=resultData})}PMSOperation.buildTmplList()},buildTmplList:function(){var pageId=settingsPage.container,tmplLst=PMSOperation.LOAD_TMPL_DATA.data,customName=PMSOperation.LOAD_TMPL_DATA.customName;null===PMSV2Cycle.addCycleType&&(PMSV2Cycle.addCycleType=PACycle.Constants.CYCLE_TYPE.APPRAISAL_CYCLE_TYPE),pageId.find("#tmplLstID").parent().find("#emptPage").remove();let li="";if(PMSV2Cycle.addCycleType===PACycle.Constants.CYCLE_TYPE.CR_CYCLE_TYPE){if(pageId.find("#chooseTemplateDiv #chooseTemplateHdrMsg").text(ZPI18N.getString("zp.addCrbasedcycle")),pageId.find("#chooseTemplateDiv #selTmplInfoHdr").text(ZPI18N.getString("zp.selecttemplate2")),pageId.find("#chooseTemplateDiv #selTmplInfoDesc").text(ZPI18N.getString("zp.crbasedtmpldesc")),!(void 0!==PMSOperation.LOAD_TMPL_DATA.crCycleData&&PMSOperation.LOAD_TMPL_DATA.crCycleData.length>0))return void PMSOperationCommon.setNoData(pageId.find("#tmplLstID").parent(),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null,!1);tmplLst=PMSOperation.LOAD_TMPL_DATA.crCycleData}else pageId.find("#chooseTemplateDiv #chooseTemplateHdrMsg").text(ZPI18N.getString("zp.selecttemplate")),pageId.find("#chooseTemplateDiv #selTmplInfoHdr").text(ZPI18N.getString("zp.cycletemplate.choosetemplate")),pageId.find("#chooseTemplateDiv #selTmplInfoDesc").text(ZPI18N.getString("zp.cycletemplate.choosetempdesc")),li='<li class="zpl_grdcrdtyelst zpl_grdcrdtyecrate">',li+='<div class="zpl_grdcrdtyecnt">',li+="<h5>"+ZPI18N.getString("zp.cycletemplate.createcyclehdr")+"</h5>",li+="<p><em>"+ZPI18N.getString("zp.cycletemplate.createcycledesc")+"</em></p>",li+="</div>",li+='<div class="zpl_grdcrdtyefdr">',li+='<button type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small" onclick="PMSSetting.openTmplPopUp()">'+ZPI18N.getString("zp.cycletemplate.createcyclehdr")+"</button>",li+="</div>",li+="</li>";let cnt=0;$.each(tmplLst,function(index,data){data.status&&(li+=PMSOperation.constructTmplList(index,data,customName,PMSTmpl.tmplColors[cnt]),cnt=(cnt+1)%PMSTmpl.tmplColors.length)}),pageId.find("#chooseTemplateDiv #tmplLstID").html(li),pageId.find("#openCycleConfig").attr("disabled","disabled")},constructTmplList:function(index,data,customName,color){var li="<li tmplid="+data.configID+' cycleType="'+data.cycleType+'"  class="zpl_grdcrdtyelst"><div class="zpl_grdcrdtyeimg '+color+'"><h5 class="zpl_ellipsis" id="tNme" title="'+data.cycleName+'">'+data.cycleName+'</h5></div><div class="zpl_grdcrdtyecnt"><ul class="zpl_lstdisc">';return data.isSelfEnable&&(li+='<li><i class="PI_tick2 grn"></i>'+ZPI18N.getString("zp.selfappraisal")+"</li>"),data.isMREnable&&(li+='<li><i class="PI_tick2 grn"></i>'+customName.mrName+"</li>"),li+='<li><i class="PI_tick2 grn"></i>'+ZPI18N.getString("zp.reviewerreview")+"</li>",li+='</ul></div><div class="zpl_grdcrdtyefdr" id="tmplSelDiv"><div>',li+='<button onclick="PMSOperation.onClickViewDetail(this);" type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small">'+ZPI18N.getString("zp.viewdetails")+"</button>",li+='<button id="applyID_'+data.configID+'" data-action-in-progress="true" onclick="PMSOperation.tmplSelection(this);" type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small">'+ZPI18N.getString("zp.apply")+"</button>",li+="<div></div></li>"},onClickViewDetail:function(obj){let li=$(obj).parents("li"),tID=$(li).attr("tmplid"),cycleType=parseInt($(li).attr("cycleType")),tNme=$(li).find("#tNme").text();var popupTab=new Tab("TemplateDet",function(){PMSOperation.getTmplDetails(tID,cycleType)});PMSOperation.TMPL_V_D_MODAL=new sliderModal("",popupTab),PMSOperation.TMPL_V_D_MODAL.setCloseCallback(function(){PMSOperation.TMPL_V_D_MODAL.remove()}),PMSOperation.TMPL_V_D_MODAL.construct(),$(PMSOperation.TMPL_V_D_MODAL.sliderDiv).find(".zpl_mfoter").html(""),$(PMSOperation.TMPL_V_D_MODAL.sliderDiv).find("#sliHdrDiv h4").text(tNme);var _footer;_footer='<button type="button" id="zp_modal_cancelbtn" onclick="PMSOperation.closeVD();" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.close")+"</button>",$(PMSOperation.TMPL_V_D_MODAL.sliderDiv).find(".zpl_mfoter").html(_footer),$(PMSOperation.TMPL_V_D_MODAL.sliderDiv).find("#cardTemplateDet").html(ZPeople.LOADING_HTML)},getTmplDetails:function(tmplID,cycleType){var params={mode:"getConfigDetails",configId:tmplID,cyType:cycleType};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData,reqParam){let pageId=$(PMSOperation.TMPL_V_D_MODAL.sliderDiv),content="",sa=resultData.SA_moduleVal,mr=resultData.MR_moduleVal,pa=resultData.Reviewer_moduleVal;if(void 0!==sa&&sa.length>0||void 0!==mr&&mr.length>0||void 0!==pa&&pa.length>0){if(PMSSetting.getSelPerformanceModules(!1),content='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div><h5>'+ZPI18N.getString("zp.reviewparameters")+'</h5></div><div><table class="zpl_itbl"><tbody>',void 0!==sa&&sa.length>0&&(content+=PMSOperation.constructRevDet(ZPI18N.getString("zp.selfappraisal"),sa)),void 0!==mr&&mr.length>0){let mrName=void 0!==PMSTmpl.MR_NAME&&PMSTmpl.MR_NAME.length>0?PMSTmpl.MR_NAME:PMSV2Cycle.multiraterName;content+=PMSOperation.constructRevDet(mrName,mr)}void 0!==pa&&pa.length>0&&(content+=PMSOperation.constructRevDet(ZPI18N.getString("zp.reviewerreview"),pa)),content+="</tbody></table></div></div></div></div>"}let appr=resultData.approvalArr;content+='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div><h5>'+ZPI18N.getString("zp.reviewer")+'</h5></div><div><table class="zpl_itbl"><tbody>';for(let i=0;i<appr.length>0;i++){let temp=appr[i],apprType=temp.apprType;if("REPORTING_TO"===apprType)content+='<tr><td style="vertical-align: top;"><b class="d-flexC"><span class="zpl_dots"></span>'+PMSOperation.REP_TO_NAME+'</b></td><td><div class="zpl_tglist"><div class="zpl_tg"><span>'+temp.apprTypeDisplayName+"</span></div></div></td></tr>";else if(apprType===ApproverConstants.Type.APPRAISER_LAST_LEVEL)content+='<tr><td><b class="d-flexC"><span class="zpl_dots"></span>'+ZPI18N.getString("zp.lastlevelreview")+"</b></td></tr>";else if(apprType===ApproverConstants.Type.DEPT_HEAD_LOGIN)content+='<tr><td><b class="d-flexC"><span class="zpl_dots"></span>'+ZPI18N.getString("zp.deptheadofloginuser")+"</b></td></tr>";else if(apprType===ApproverConstants.Type.USER)content+='<tr><td style="vertical-align: top;"><b class="d-flexC"><span class="zpl_dots"></span>'+ZPI18N.getString("zp.employee")+'</b></td><td><div class="zpl_tg" title="'+ZSEC.Encoder.encodeForHTML(temp.apprTypeDisplayName)+'"><span>'+ZSEC.Encoder.encodeForHTML(temp.apprTypeDisplayName)+"</span></div></td></tr>";else if(apprType===ApproverConstants.Type.FORM_FIELD){if(null===PMSSetting.EMP_LKUP){var params={mode:"fetchEmpLookup",submode:PMSCommon.APPROVAL_LKUP};ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){PMSSetting.EMP_LKUP=resultData.emplookup})}void 0!=PMSSetting.EMP_LKUP&&null!==PMSSetting.EMP_LKUP&&Object.keys(PMSSetting.EMP_LKUP).length>0&&-1!=Object.keys(PMSSetting.EMP_LKUP).indexOf(temp.fcid)&&(content+='<tr><td style="vertical-align: top;"><b class="d-flexC"><span class="zpl_dots"></span>'+ZPI18N.getString("zp.formfield")+'</b></td><td><div class="zpl_tglist"><div class="zpl_tg" title="'+PMSSetting.EMP_LKUP[temp.fcid]+'"><span>'+PMSSetting.EMP_LKUP[temp.fcid]+"</span></div></div></td></tr>")}}content+="</tbody></table></div></div></div></div>";let modWgt=resultData.modWeightage;void 0!==modWgt&&Object.keys(modWgt).length>0&&(content+='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div><h5>'+ZPI18N.getString("zp.setmoduleweightage")+'</h5></div><div><table class="zpl_itbl"><tbody>',$.each(modWgt,function(k,v){"GOALS"===k?content+='<tr><td style="vertical-align: top;"><b class="d-flexC"><span class="zpl_dots"></span>'+PMSSetting.SEL_ENABLED_MODULES.GOALS.displayName+'</b></td><td><div class="zpl_tglist"><div class="zpl_tg"><span>'+v+"</span></div></div></td></tr>":"KRA"===k?content+='<tr><td style="vertical-align: top;"><b class="d-flexC"><span class="zpl_dots"></span>'+PMSSetting.SEL_ENABLED_MODULES.KRA.displayName+'</b></td><td><div class="zpl_tglist"><div class="zpl_tg"><span>'+v+"</span></div></div></td></tr>":"KRA_GOALS"===k?content+='<tr><td style="vertical-align: top;"><b class="d-flexC"><span class="zpl_dots"></span>'+PMSSetting.SEL_ENABLED_MODULES.KRA_GOALS.displayName+'</b></td><td><div class="zpl_tglist"><div class="zpl_tg"><span>'+v+"</span></div></div></td></tr>":"COMPETENCY"===k&&(content+='<tr><td style="vertical-align: top;"><b class="d-flexC"><span class="zpl_dots"></span>'+PMSSetting.SEL_ENABLED_MODULES.COMPETENCY.displayName+'</b></td><td><div class="zpl_tglist"><div class="zpl_tg"><span>'+v+"</span></div></div></td></tr>")}),content+="</tbody></table></div></div></div></div>");let modRtgObj=resultData.moduleRatingType;if(void 0!==modRtgObj&&null!==modRtgObj&&Object.keys(modRtgObj).length>0&&(void 0!==sa&&sa.length>0||void 0!==mr&&mr.length>0||void 0!==pa&&pa.length>0)&&!PMSV2Cycle.isCRBasedCycle(reqParam.cyType)){let noOfDig=modRtgObj.noOfDigits;content+='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div><h5>'+ZPI18N.getString("zp.lms.reports.rating")+'</h5></div><div><table class="zpl_itbl"><tbody>',0===modRtgObj.type?content+='<tr><td><span class="zpl_dots"></span><div class="zpl_tg"><span>'+ZPI18N.getString("zp.local.Stars")+"</span></div></td></tr>":1===modRtgObj.type?content+='<tr><td><span class="zpl_dots"></span><div class="zpl_tg"><span>'+ZPI18N.getString("zp.numberRating")+"</span></div></td></tr>":2===modRtgObj.type?content+='<tr><td><span class="zpl_dots"></span><div class="zpl_tg"><span>'+ZPI18N.getString("zp.text")+"</span></div></td></tr>":3===modRtgObj.type&&(content+='<tr><td><span class="zpl_dots"></span><div class="zpl_tg"><span>'+ZPI18N.getString("zp.custom")+"</span></div></td></tr>"),content+=1===noOfDig?'<tr><td><span class="zpl_dots"></span><div class="zpl_tg"><span>'+ZPI18N.getString("zp.onedecimalinscore")+"</span></div></td></tr>":2===noOfDig?'<tr><td><span class="zpl_dots"></span><div class="zpl_tg"><span>'+ZPI18N.getString("zp.twodecimalinscore")+"</span></div></td></tr>":'<tr><td><span class="zpl_dots"></span><div class="zpl_tg"><span>'+ZPI18N.getString("zp.nodecimalinscore")+"</span></div></td></tr>",content+="</tbody></table></div></div></div></div>"}if(resultData.normalizationEnable&&(content+='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div><h5>'+ZPI18N.getString("zp.normalization")+'</h5></div><div><table class="zpl_itbl"><tbody>',content+='<tr><td><span class="zpl_dots"></span><div class="zpl_tg" title="'+ZPI18N.getString("zp.normpartofthecycle")+'"><span>'+ZPI18N.getString("zp.normpartofthecycle")+"</span></div></td></tr>",content+="</tbody></table></div></div></div></div>"),resultData.budgetEnable){PMSSetting.fetchCfsEmpLookupData();let hkName=void 0!==PMSTmpl.HK_NAME&&PMSTmpl.HK_NAME.length>0?PMSTmpl.HK_NAME:PMSV2Cycle.HIKENAME;content+='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div><h5>'+hkName+'</h5></div><div><table class="zpl_itbl"><tbody>',content+='<tr><td style="vertical-align: top;"><b class="d-flexC"><span class="zpl_dots"></span>'+hkName+" "+ZPI18N.getString("zp.local.Appraiser")+'</b></td><td><div class="zpl_tglist"><div class="zpl_tg"><span>'+PMSSetting.CFS_EMP_LKUP[resultData.hikeDecider]+"</span></div></div></td></tr>";let txt=hkName+"&nbsp;"+ZPI18N.getString("zp.approvall")+"&nbsp;"+ZPI18N.getString("zp.lookup.is");resultData.hikeApprovalEnable?txt+="&nbsp;"+ZPI18N.getString("zp.senabled"):txt+="&nbsp;"+ZPI18N.getString("zp.sdisabled"),content+='<tr><td colspan="2"><span class="zpl_dots"></span><div class="zpl_tg" title="'+txt+'"><span>'+txt+"</span></div></td></tr>",content+="</tbody></table></div></div></div></div>"}pageId.find("#cardTemplateDet").html(content)})},constructRevDet:function(name,arr){let content="";if(arr.length>0){let temp="";for(let i=0;i<arr.length;i++)"GOALS"===arr[i]&&(temp+='<div class="zpl_tg"><span>'+PMSSetting.SEL_ENABLED_MODULES.GOALS.displayName+"</span></div>"),"KRA"===arr[i]&&(temp+='<div class="zpl_tg"><span>'+PMSSetting.SEL_ENABLED_MODULES.KRA.displayName+"</span></div>"),"KRA_GOALS"===arr[i]&&(temp+='<div class="zpl_tg"><span>'+PMSSetting.SEL_ENABLED_MODULES.KRA_GOALS.displayName+"</span></div>"),"COMPETENCY"===arr[i]&&(temp+='<div class="zpl_tg"><span>'+PMSSetting.SEL_ENABLED_MODULES.COMPETENCY.displayName+"</span></div>"),"QUS_ANS"===arr[i]&&(temp+='<div class="zpl_tg"><span>'+PMSSetting.SEL_ENABLED_MODULES.QUS_ANS.displayName+"</span></div>");content+='<tr><td style="vertical-align: top;"><b class="d-flexC"><span class="zpl_dots"></span>'+name+'</b></td><td><div class="zpl_tglist">'+temp+"</div></td></tr>"}return content},closeVD:function(){PMSOperation.TMPL_V_D_MODAL.close()},tmplSelection:function(obj){let prepend='<button onclick="PMSOperation.onClickViewDetail(this);" type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small">'+ZPI18N.getString("zp.viewdetails")+"</button>",selectedDiv="<div>"+prepend+'<button  tmpl="selected" type="button" class="zlabel zlabel--blue zlabel--small">'+ZPI18N.getString("zp.applied")+"</button></div>",selectDiv="<div>"+prepend+'<button data-action-in-progress="true" onclick="PMSOperation.tmplSelection(this);" type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small">'+ZPI18N.getString("zp.apply")+"</button></div>",pageId=settingsPage.container,li=$(obj).parents("li"),prevLi=pageId.find("#tmplLstID .zpl_act");void 0!==prevLi&&($(prevLi).removeClass("zpl_act"),$(prevLi).find("#tmplSelDiv").html(selectDiv)),$(li).addClass("zpl_act"),$(li).find("#tmplSelDiv").html(selectedDiv),pageId.find("#openCycleConfig").removeAttr("disabled"),setTimeout(()=>{PMSOperation.showCycleConfiguration()},350)},closeChooseTemplate:function(){var pageId=settingsPage.container;PMSV2Cycle.addCycleType=null,pageId.find("#chooseTemplateDiv").hide(),pageId.find("#cycleListDiv").show(),PMSOperation.initCyclePage()},showCycleConfiguration:function(obj){var pageId=settingsPage.container;pageId.find("#openCycleConfig").attr("disabled","disabled");let tmplID="",cycleType=PACycle.Constants.CYCLE_TYPE.TEMPLATE_TYPE;void 0!==obj?tmplID=$(obj).attr("tmplid"):(tmplID=pageId.find("button[tmpl=selected]").parents("li").attr("tmplid"),cycleType=parseInt(pageId.find("button[tmpl=selected]").parents("li").attr("cycletype"))),PMSV2Cycle.prerequisiteData(!1),PMSV2Cycle.getConfigDetails(tmplID,1,cycleType)},showEditCycleConfiguration:function(obj){let tmplID=$(obj).parents(".zpl_catlst").attr("configid"),cycleType=$(obj).parents(".zpl_catlst").attr("cycleType");void 0!==cycleType&&null!==cycleType&&""!==cycleType||(cycleType=PACycle.Constants.CYCLE_TYPE.APPRAISAL_CYCLE_TYPE),PMSV2Cycle.getConfigDetails(tmplID,0,parseInt(cycleType))},cloneCycle:function(obj){let tmplID=$(obj).parents(".zpl_catlst").attr("configid"),cycleType=$(obj).parents(".zpl_catlst").attr("cycleType");void 0!==cycleType&&null!==cycleType&&""!==cycleType||(cycleType=PACycle.Constants.CYCLE_TYPE.APPRAISAL_CYCLE_TYPE),PMSV2Cycle.getConfigDetails(tmplID,3,parseInt(cycleType))},monthOptions:function(id){PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck();let selOpt=settingsPage.container.find("#"+id);selOpt.empty(),$.each(Calendar.months,function(key,value){selOpt.append(jQuery("<option />",{value:key}).html(value))}),ZPeopleComponents.select(selOpt),"cstMthVal"!=id&&"dojMthVal"!=id&&"dojMthVal_2"!=id||selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)})},beforeCloseCycleConfig:function(){$("#confirmationPopup").modal({backdrop:"static",keyboard:!1}),$("#textConfirmationPopupBody").html("").append("Are you sure you want to close cycle configuration page?"),$("#confirmConfirmationPopup").html("").append(ZPI18N.getString("zp.proceed")),$("#confirmConfirmationPopup").off("click"),$("#cancelConfirmationPopup").off("click"),$("#confirmConfirmationPopup").on("click",function(){PMSOperation.closeCycleConfig()})},closeCycleConfig:function(){PMSOperation.loadCycles()},collapseExpand:function(obj){settingsPage.container;let parentDiv=$(obj).parent().parent().parent(),isExpanded=$(parentDiv).attr("aria-expanded"),id=$(parentDiv).attr("id");isExpanded?ZPeopleComponents.collapsiblepanel("#"+id).collapsePanel():ZPeopleComponents.collapsiblepanel("#"+id).expandPanel()},addAppliCondt:function(){var pageId=settingsPage.container;let appliDiv=pageId.find("#cycleAppliDiv_nw"),prevSeries=parseInt(pageId.find("#addCriDiv_nw").prev().attr("series")),alreadySelKey=[];pageId.find("#cycleAppliDiv_nw div[cnt^=series_]").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");alreadySelKey.push(val)});let selectDiv=PMSOperation.getApplDiv(prevSeries+1);pageId.find("#addCriDiv_nw").before(selectDiv);var div=pageId.find("#cycleAppliDiv_nw div[series="+[prevSeries+1]+"]");alreadySelKey.length>=3&&appliDiv.find("#addCriDiv_nw").remove(),(selOpt=div.find("select[type=keyFld]")).empty();let fstKey="",cnt=0;$.each(PMSOperation.CYCLE_APPLICABLE_KEYS,function(key,value){-1===alreadySelKey.indexOf(key)&&(0===cnt&&(fstKey=key),selOpt.append(jQuery("<option />",{value:key,id:key}).html(value)),cnt+=1)}),selOpt.attr("keySel",fstKey),ZPeopleComponents.select(selOpt),selOpt.on("zselectchange",function(event,edata){PMSOperation.onChangeKeySelect(edata)}),selOpt.on("zselectbeforedropdownlistopen",function(event,eData){PMSOperation.refreshKeySelect(eData)});var selOpt=div.find("select[type=valFld]");PMSOperation.initiateSelValData(fstKey,selOpt),ZPeopleComponents.select(pageId.find("#applCrtIS_"+[prevSeries+1]))},getApplDiv:function(idx){return'<div class="zpl_idiv" cnt="series_'+idx+'" series="'+idx+'"><select class="select" type="keyFld" style="display: none;"></select><select class="select" id="applCrtIS_'+idx+'" disabled="disabled" style="display: none;"><option value="CRT_IS">'+ZPI18N.getString("zp.is")+'</option></select><select class="select" type="valFld" style="display: none;width: 230px;" multiple="true"></select><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSOperation.removeAppliCondtRow(this)"></i></div>'},removeAppliCondtRow:function(obj){let div=$(obj).parent("div"),parentDiv=div.parent("div"),series=$(div).attr("series");0!==$(div).find("#applCrtIS_"+series).length&&ZPeopleComponents.select("#applCrtIS_"+series).destroy(),div.remove(),parentDiv.find("#addCriDiv_nw").remove(),parentDiv.append('<div id="addCriDiv_nw" class="zpl_idiv"><a class="zpl_lnkbg" onclick="PMSOperation.addAppliCondt();"><i class="PI_plus"></i>'+ZPI18N.getString("zp.addcriteria")+"</a></div>")},addApplicableCriteria:function(event,id){var pageId=settingsPage.container;null!=event&&void 0!=event&&(id=event.detail.id);var html='<div class="zpl_idiv" id="'+id+'AppliDiv">';"location"==id||"role"==id||"department"==id||"level"==id?(html+='<select disabled="disabled" class="select-js" type="keyFld" style="display: none;"></select>',html+='<select class="select-js" type="crtFld" id="'+id+'ApplCrtIS" disabled="disabled" style="display: none;"><option value="CRT_IS">'+ZPI18N.getString("zp.is")+"</option></select>",html+='<select class="select" type="valFld" style="display: none;width: 230px;" multiple="true"></select>'):"customDate"==id?(html+='<select id="cstKey" class="select" style="display: none;"></select>',html+='<select id="cstCrt" class="select-js" style="display: none;"><option value="CST_DATE">'+ZPI18N.getString("zp.datebased")+'</option><option value="CST_MTH">'+ZPI18N.getString("zp.monthbased")+"</option></select>",html+='<div id="cstValDiv" style="width: 230px;"><div id="cstPrdVal" class="ztextbox--group zh-alignright"><i class="ztextbox__icon PI_calendar"></i><input id="cstVal" class="ztextbox" style="width: 230px;"></div></div>'):"totalWrkExp"==id&&(html+='<select id="expKey" disabled="disabled" class="select-js" style="display: none;"><option value="EXP_APPLI_CRT">'+ZPI18N.getString("zp.totalworkexperience")+"</option></select>",html+='<select id="expCrt" class="select-js" style="display: none;"><option value="-1">'+ZPI18N.getString("zp.select")+'<option value="0">'+ZPI18N.getString("zp.equalto")+'</option><option value="1">'+ZPI18N.getString("zp.lesserthan")+'</option><option value="2">'+ZPI18N.getString("zp.greaterthan")+'<option value="3">'+ZPI18N.getString("zp.lessthanorequalto",new Array(""))+'<option value="4">'+ZPI18N.getString("zp.greaterthanorequalto",new Array(""))+'<option value="5">'+ZPI18N.getString("zp.between")+"</option></select>",html+='<div id="expValDiv" class="zpl_idiv" style="width: 230px;"><input id="expFrom" class="ztextbox w80I" type="text" style="width: 230px;" placeholder="'+ZPI18N.getString("zp.years")+'" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'year\');" onchange="PMSOperation.checkExperienceYear()"><input id="expTo" class="ztextbox w80I" type="text" style="width: 110px; display: none;" placeholder="'+ZPI18N.getString("zp.years")+'" onkeydown="return PMSV2Cycle.onNRKeyDown(this,event,\'year\');" onchange="PMSOperation.checkExperienceYear(true)"></div>'),html+='<i class="PI_delete tooltip-js" data-title-position="bottom" onclick="PMSOperation.deleteApplicableCriteria(this)" title="'+ZPI18N.getString("zp.delete")+'"></i>',html+="</div>",pageId.find("#appliAddButton").parent().before(html),PMSOperation.defaultOptionForAppliField(id),ZPeopleComponents.menu("#appliMenuList").hideMenuItems(["#"+id]),PMSOperation.notSelectedApplicableKeys.splice(PMSOperation.notSelectedApplicableKeys.indexOf(id),1),0==PMSOperation.notSelectedApplicableKeys.length&&pageId.find("#appliAddButton").addClass("DNI")},defaultOptionForAppliField:function(id){var pageId=settingsPage.container;let isBudgetCheck=!1;if((PMSV2Cycle.EDIT_CYCLE_FLAG&&PMSV2Cycle.SELECTED_TMPL.budgetEnable||!PMSV2Cycle.EDIT_CYCLE_FLAG&&!PMSV2Cycle.CLONE_CYCLE_FLAG&&null!=PMSV2Cycle.SELECTED_TMPL&&PMSV2Cycle.SELECTED_TMPL.budgetEnable||!PMSV2Cycle.EDIT_CYCLE_FLAG&&!PMSV2Cycle.CLONE_CYCLE_FLAG&&PMSV2Cycle.IS_SAL_HK_ENABLED)&&(isBudgetCheck=!0),"location"==id)(selOpt=pageId.find("#cycleAppliDiv_nw #locationAppliDiv select[type=keyFld]")).empty(),selOpt.append(jQuery("<option />",{value:"APPL_LOC",id:"APPL_LOC"}).html(ZPI18N.getString("zp.location"))),ZPeopleComponents.select(selOpt),selOpt=pageId.find("#cycleAppliDiv_nw #locationAppliDiv #locationApplCrtIS"),ZPeopleComponents.select(selOpt),(selOpt=pageId.find("#cycleAppliDiv_nw").find("#locationAppliDiv select[type=valFld]")).empty(),$.each(PMSV2Cycle.ALL_LOCATIONS,function(key,value){selOpt.append(jQuery("<option />",{value:value.locationId,id:value.locationId}).html(value.locationName))}),ZPeopleComponents.select(selOpt),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.alllocaction")}),selOpt.attr("keySel","APPL_LOC"),selOpt.on("zselectchange",function(event,edata){isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)});else if("role"==id){(selOpt=pageId.find("#cycleAppliDiv_nw #roleAppliDiv select[type=keyFld]")).empty(),selOpt.append(jQuery("<option />",{value:"APPL_ROLE",id:"APPL_ROLE"}).html(ZPI18N.getString("zp.role"))),ZPeopleComponents.select(selOpt),selOpt=pageId.find("#cycleAppliDiv_nw #roleAppliDiv #roleApplCrtIS"),ZPeopleComponents.select(selOpt),(selOpt=pageId.find("#cycleAppliDiv_nw").find("#roleAppliDiv select[type=valFld]")).empty(),$.each(PMSV2Cycle.ALL_ROLES,function(key,value){selOpt.append(jQuery("<option />",{value:value.roleId,id:value.roleId}).html(value.roleName))}),ZPeopleComponents.select(selOpt),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.allroles")}),selOpt.attr("keySel","APPL_ROLE"),selOpt.on("zselectchange",function(event,edata){isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)})}else if("department"==id){(selOpt=pageId.find("#cycleAppliDiv_nw #departmentAppliDiv select[type=keyFld]")).empty(),selOpt.append(jQuery("<option />",{value:"APPL_DEP",id:"APPL_DEP"}).html(ZPI18N.getString("zp.department"))),ZPeopleComponents.select(selOpt),selOpt=pageId.find("#cycleAppliDiv_nw #departmentAppliDiv #departmentApplCrtIS"),ZPeopleComponents.select(selOpt),(selOpt=pageId.find("#cycleAppliDiv_nw").find("#departmentAppliDiv select[type=valFld]")).empty(),$.each(PMSV2Cycle.ALL_DEPARTMENTS,function(key,value){selOpt.append(jQuery("<option />",{value:value.departmentId,id:value.departmentId}).html(value.departmentName))}),ZPeopleComponents.select(selOpt),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.alldepartment")}),selOpt.attr("keySel","APPL_DEP"),selOpt.on("zselectchange",function(event,edata){isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)})}else if("level"==id){(selOpt=pageId.find("#cycleAppliDiv_nw #levelAppliDiv select[type=keyFld]")).empty(),selOpt.append(jQuery("<option />",{value:"APPL_LVL",id:"APPL_LVL"}).html(ZPI18N.getString("zp.level"))),ZPeopleComponents.select(selOpt),selOpt=pageId.find("#cycleAppliDiv_nw #levelAppliDiv #levelApplCrtIS"),ZPeopleComponents.select(selOpt),(selOpt=pageId.find("#cycleAppliDiv_nw").find("#levelAppliDiv select[type=valFld]")).empty(),$.each(PMSV2Cycle.ALL_LEVELS,function(key,value){selOpt.append(jQuery("<option />",{value:value.levelId,id:value.levelId}).html(value.levelName))}),ZPeopleComponents.select(selOpt),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.alllevel")}),selOpt.attr("keySel","APPL_LVL"),selOpt.on("zselectchange",function(event,edata){isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)})}else if("customDate"==id){(selOpt=pageId.find("#customDateAppliDiv #cstKey")).empty(),selOpt.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),$.each(PMSV2Cycle.customDateFCID,function(key,value){selOpt.append(jQuery("<option />",{value:value.componentID,id:value.componentID}).html(value.displayName))}),ZPeopleComponents.select(selOpt),selOpt.on("zselectchange",function(event,eData){PMSV2Cycle.onChangeApplicableFields(eData)});let cstCrtSelect=pageId.find("#customDateAppliDiv #cstCrt");ZPeopleComponents.select(cstCrtSelect),cstCrtSelect.on("zselectchange",function(event,eData){isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(eData):(PMSOperation.onCstCrtSelect(eData),PMSV2Cycle.onChangeApplicableFields(eData))}),ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cstVal").val(ui.fromValueString+"-"+ui.toValueString),isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(ui):PMSV2Cycle.onChangeApplicableFields(ui)},format:dateFmt});let picker10=pageId.find("#cyApplCstPrdPicker");pageId.find("#cstVal").on("click",function(){pageId.find("#cyApplCstPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker10).close():ZPeopleComponents.daterangepicker(picker10).open()})}else if("totalWrkExp"==id){var selOpt=pageId.find("#totalWrkExpAppliDiv #expKey");ZPeopleComponents.select(selOpt);let expCrtSelect=pageId.find("#totalWrkExpAppliDiv #expCrt");ZPeopleComponents.select(expCrtSelect),expCrtSelect.on("zselectchange",function(event,eData){PMSOperation.onExpCrtSelect(eData),isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(eData):PMSV2Cycle.onChangeApplicableFields(eData)})}},deleteApplicableCriteria:function(obj){var pageId=settingsPage.container,appliDivId=$(obj).parent().attr("id"),id=appliDivId.split("AppliDiv")[0];"location"==id||"role"==id||"department"==id||"level"==id?(ZPeopleComponents.select($(obj).parent().find("select[type=keyFld]")).destroy(),ZPeopleComponents.select($(obj).parent().find("select[type=crtFld]")).destroy(),ZPeopleComponents.select($(obj).parent().find("select[type=valFld]")).destroy()):"customDate"==id?(ZPeopleComponents.select($(obj).parent().find("#cstKey")).destroy(),ZPeopleComponents.select($(obj).parent().find("#cstCrt")).destroy(),ZPeopleComponents.isComponent(pageId.find("#cstMthVal"))&&ZPeopleComponents.select($(obj).parent().find("#cstMthVal")).destroy()):"totalWrkExp"==id&&(ZPeopleComponents.select($(obj).parent().find("#expKey")).destroy(),ZPeopleComponents.select($(obj).parent().find("#expCrt")).destroy()),pageId.find("#"+appliDivId).remove(),PMSOperation.notSelectedApplicableKeys.push(id),ZPeopleComponents.menu("#appliMenuList").showMenuItems(["#"+id]),pageId.find("#appliAddButton").removeClass("DNI"),PMSV2Cycle.onChangeApplicableFields()},refreshKeySelect:function(eData){let alreadySelKey=[];settingsPage.container.find("#cycleAppliDiv_nw div[cnt^=series_]").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");alreadySelKey.push(val)});let selOpt=$(eData.element[0]),selOptKey=selOpt.attr("keySel"),options=[],cnt=0,fstKey="";$.each(PMSOperation.CYCLE_APPLICABLE_KEYS,function(key,value){if(-1===alreadySelKey.indexOf(key)||key===selOptKey){0===cnt&&(fstKey=key);var obj={};obj.label=value,obj.value=key,options.push(obj),cnt+=1}}),selOpt.attr("keySel",fstKey),ZPeopleComponents.select(selOpt).removeAllOptions(),ZPeopleComponents.select(selOpt).addOption(options)},onChangeKeySelect:function(eData,selectedFieldValues){if(eData&&(""===eData.selectedValue||eData.previousValue==eData.selectedValue))return;settingsPage.container;let selField=eData.selectedValue;$(eData.element[0]).attr("keySel",selField);var selOpt=$(eData.element[0]).parent("div").find("select[type=valFld");PMSOperation.updateSelValData(selField,selOpt)},onDateTypeSelect:function(eData){if(!eData||""!==eData.selectedValue&&eData.previousValue!=eData.selectedValue){var pageId=settingsPage.container;ZPeopleComponents.select(pageId.find("#dojCrt")).setValue("DOJ_UNTIL"),pageId.find("#dojAppliDiv_2").is(":hidden")||(ZPeopleComponents.select(pageId.find("#dojCrt_2")).setValue("DOJ_MTH"),pageId.find("#dojAppliDiv_2").addClass("zpl_DNI"),pageId.find("#addCriDiv_DOJ").removeClass("zpl_DNI"));var firstCri=ZPeopleComponents.select("#dojCrt");2==(options=firstCri.getOptions()).length?firstCri.addOption([{label:ZPI18N.getString("zp.workflow.months"),value:"DOJ_MTH"}]):1==options.length&&firstCri.addOption([{label:ZPI18N.getString("zp.until"),value:"DOJ_UNTIL"},{label:ZPI18N.getString("zp.fromandtp"),value:"DOJ_FRM_TO"}]);var options,secondCri=ZPeopleComponents.select("#dojCrt_2");2==(options=secondCri.getOptions()).length?secondCri.addOption([{label:ZPI18N.getString("zp.workflow.months"),value:"DOJ_MTH"}]):1==options.length&&secondCri.addOption([{label:ZPI18N.getString("zp.until"),value:"DOJ_UNTIL"},{label:ZPI18N.getString("zp.fromandtp"),value:"DOJ_FRM_TO"}])}},onDojCrtSelect:function(eData){if(eData&&(""===eData.selectedValue||eData.previousValue==eData.selectedValue))return;var pageId=settingsPage.container;let selField=eData.selectedValue,selectId="dojCrt_2-listbox"==$(eData.dropdownList).attr("id")?"_2":"";if("DOJ_UNTIL"===selField){0!==pageId.find("#dojMthVal"+selectId).length&&ZPeopleComponents.select("#dojMthVal"+selectId).destroy(),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId).clearSelection(),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId).destroy(),pageId.find("#dojValDiv"+selectId).html('<input id="dojVal1'+selectId+'" class="ztextbox" style="width: 230px;">');var effectiveDateOptions={calendarIcon:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none",pickerclose:PMSV2Cycle.booleanDOJBudgetCheck};ZPeopleComponents.datefield(pageId.find("#dojVal1"+selectId),effectiveDateOptions),PMSV2Cycle.SELECTED_DOJUTIL_DATE=null,pageId.find("#dojVal1"+selectId+"-container .zinputfield__textbox").attr("style","width:190px;")}else if("DOJ_FRM_TO"===selField){0!==pageId.find("#dojMthVal"+selectId).length&&ZPeopleComponents.select("#dojMthVal"+selectId).destroy(),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId).destroy(),pageId.find("#dojValDiv"+selectId).html('<div id="dblDateCalDiv'+selectId+'" class="ztextbox--group zh-alignright"><i id="dojVal_Icon'+selectId+'" class="ztextbox__icon PI_monthly"></i><input style="width: 230px;" id="dojVal'+selectId+'" class="ztextbox"></div>'),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId,{change:function(event,ui){pageId.find("#dojVal"+selectId).val(ui.fromValueString+"-"+ui.toValueString),PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(ui):PMSV2Cycle.onChangeApplicableFields(ui)},format:dateFmt,appendTo:pageId.find("#nwCylAppliDiv"),position:"bottom",forElement:"#dojVal"+selectId});let picker9=pageId.find("#cyApplFrmToPrdPicker"+selectId);pageId.find("#dojVal"+selectId+", #dojVal_Icon"+selectId).on("click",function(){pageId.find("#cyApplFrmToPrdPicker"+selectId).is(":visible")?ZPeopleComponents.daterangepicker(picker9).close():ZPeopleComponents.daterangepicker(picker9).open()})}else ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId).clearSelection(),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId).destroy(),pageId.find("#dojValDiv"+selectId).html('<select id="dojMthVal'+selectId+'" class="select-js" style="width: 230px;" type="dojVal" multiple="true"></select>'),PMSOperation.monthOptions("dojMthVal"+selectId)},onCstCrtSelect:function(eData){if(eData&&(""===eData.selectedValue||eData.previousValue==eData.selectedValue))return;PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck();var pageId=settingsPage.container;if("CST_DATE"===eData.selectedValue){0!==pageId.find("#cstMthVal").length&&ZPeopleComponents.select("#cstMthVal").destroy(),pageId.find("#cstValDiv").html('<div id="cstPrdVal" class="ztextbox--group zh-alignright"><i class="ztextbox__icon PI_calendar"></i><input style="width: 230px;" id="cstVal" class="ztextbox"></div>'),ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker",{change:function(event,ui){pageId.find("#cstVal").val(ui.fromValueString+"-"+ui.toValueString),PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(ui):PMSV2Cycle.onChangeApplicableFields(ui)},format:dateFmt});let picker10=pageId.find("#cyApplCstPrdPicker");pageId.find("#cstVal").on("click",function(){pageId.find("#cyApplCstPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker10).close():ZPeopleComponents.daterangepicker(picker10).open()}),pageId.find("#cstVal").on("zdatefieldchange",function(eData){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(eData):PMSV2Cycle.onChangeApplicableFields(eData)})}else ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker").clearSelection(),pageId.find("#cstValDiv").html('<select id="cstMthVal" class="select-js" style="width: 230px;" type="cstVal" multiple="true"></select>'),PMSOperation.monthOptions("cstMthVal")},onExpCrtSelect:function(eData){if(eData&&(""===eData.selectedValue||eData.previousValue==eData.selectedValue))return;var cycleApplContainer=settingsPage.container.find("#cycleAppliDiv_nw"),container=cycleApplContainer.find("#totalWrkExpAppliDiv");let selField=eData.selectedValue;if(-1==selField)return cycleApplContainer.find(".ztextbox--error__label").remove(),void container.after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.selectcriteria")+"</span>");cycleApplContainer.find("#sel_opt_error").remove(),5==selField?(container.find("#expFrom").attr("style","width: 110px;"),container.find("#expTo").show()):(container.find("#expFrom").attr("style","width: 230px;"),container.find("#expTo").val(""),container.find("#expTo").hide());var from=container.find("#expFrom").val();if(void 0!=from&&""!=from){var to=container.find("#expTo").val();(5!=selField||5==selField&&void 0!=to&&""!=to)&&PMSOperation.checkExperienceYear(null,!1)}},checkExperienceYear:function(toCheck,isOnchange){var cycleApplContainer=settingsPage.container.find("#cycleAppliDiv_nw"),container=cycleApplContainer.find("#totalWrkExpAppliDiv");PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck(),(isOnchange||void 0==isOnchange)&&(PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalcSalaryonInputfields("totalWrkExpAppliDiv"):PMSV2Cycle.onChangeApplicableFields(null,"totalWrkExpAppliDiv"));var option=container.find("#expCrt").val();if(-1==option)return container.find(".ztextbox--error__label").remove(),container.after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.selectcriteria")+"</span>"),!1;var from=container.find("#expFrom").val();if(""==from||void 0==from)return cycleApplContainer.find(".ztextbox--error__label").remove(),container.after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;from=Number(from.replace(/[^0-9]+/g,"")),container.find("#expFrom").val(from);var to=container.find("#expTo").val();if(5==option)if(void 0!=toCheck&&1==toCheck){if(""==to||void 0==to)return cycleApplContainer.find(".ztextbox--error__label").remove(),container.after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;if(to=Number(to.replace(/[^0-9]+/g,"")),container.find("#expTo").val(to),Number(to)<=Number(from))return cycleApplContainer.find(".ztextbox--error__label").remove(),container.after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validfromtoyearerror")+"</span>"),!1}else if(void 0==toCheck&&(""==to||void 0==to))return!0;return cycleApplContainer.find(".ztextbox--error__label").remove(),!0},initiateSelValData:function(keySel,selOpt){selOpt.empty(),"APPL_LOC"===keySel?$.each(PMSV2Cycle.ALL_LOCATIONS,function(key,value){selOpt.append(jQuery("<option />",{value:value.locationId,id:value.locationId}).html(value.locationName))}):"APPL_ROLE"===keySel?$.each(PMSV2Cycle.ALL_ROLES,function(key,value){selOpt.append(jQuery("<option />",{value:value.roleId,id:value.roleId}).html(value.roleName))}):"APPL_DEP"===keySel?$.each(PMSV2Cycle.ALL_DEPARTMENTS,function(key,value){selOpt.append(jQuery("<option />",{value:value.departmentId,id:value.departmentId}).html(value.departmentName))}):"APPL_DES"===keySel&&$.each(PMSV2Cycle.ALL_DESIGNATION,function(key,value){selOpt.append(jQuery("<option />",{value:value.desId,id:value.desId}).html(value.desName))}),ZPeopleComponents.select(selOpt),ZPeopleComponents.select(selOpt).setAttributes({placeholder:PMSOperation.getPlaceHolder(keySel)}),selOpt.attr("keySel",keySel)},getPlaceHolder:function(keySel){var placeholder="";return"APPL_LOC"===keySel?placeholder=ZPI18N.getString("zp.alllocaction"):"APPL_ROLE"===keySel?placeholder=ZPI18N.getString("zp.allroles"):"APPL_DEP"===keySel?placeholder=ZPI18N.getString("zp.alldepartment"):"APPL_DES"===keySel&&(placeholder=ZPI18N.getString("zp.alldesignation")),placeholder},updateSelValData:function(keySel,selOpt){ZPeopleComponents.select(selOpt).destroy(),ZPeopleComponents.select(selOpt).removeAllOptions();var options=[];"APPL_LOC"===keySel?$.each(PMSV2Cycle.ALL_LOCATIONS,function(index,data){var obj={};obj.label=data.locationName,obj.value=data.locationId,options.push(obj)}):"APPL_ROLE"===keySel?$.each(PMSV2Cycle.ALL_ROLES,function(index,data){var obj={};obj.label=data.roleName,obj.value=data.roleId,options.push(obj)}):"APPL_DEP"===keySel?$.each(PMSV2Cycle.ALL_DEPARTMENTS,function(index,data){var obj={};obj.label=data.departmentName,obj.value=data.departmentId,options.push(obj)}):"APPL_DES"===keySel&&$.each(PMSV2Cycle.ALL_DESIGNATION,function(index,data){var obj={};obj.label=data.desName,obj.value=data.desId,options.push(obj)}),selOpt.attr("keySel",keySel),ZPeopleComponents.select(selOpt).addOption(options),ZPeopleComponents.select(selOpt).setAttributes({placeholder:PMSOperation.getPlaceHolder(keySel)})},initNormalization:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){var pageId=settingsPage.container;pageId.addClass("zpl_tblfxd"),PMSOperationCommon.addClearCentreClass(!0),pageId.find("#cycleId").length>0&&ZPeopleComponents.select(pageId.find("#cycleId")).destroy(),pageId.find("#reviewerId").length>0&&ZPeopleComponents.select(pageId.find("#reviewerId")).destroy(),pageId.empty(),$.ajax({type:"POST",async:!0,url:"/performance/view/noramalization",data:{conreqcsr:csrfToken},success:function(resultData){pageId.empty().append(resultData),(isPAdmin||appdataadmin||"true"==PMSCommon.ismanager)&&(pageId.addClass("zpl_tblfxd"),pageId.append(ZPeople.LOADING_HTML),$("#norm_filter_search").on("click",function(){PMSOperation.searchNormalizRatPer()}),$("#norm_filter_reset, #norm_fltr_clearall").on("click",function(){PMSOperation.resetNormalizFilter(),PMSOperation.removeNormListSelection()}),PMSOperation.onloadAppraiserListForNormalization())}})}},openFilterIcon:function(){var pageId=settingsPage.container;pageId.hasClass("zpl_fltr_flt")||pageId.addClass("zpl_fltr_flt")},removeNormListSelection:function(){var pageId=settingsPage.container;pageId.find("#ratinglockbtns").hasClass("opn")&&(pageId.find("#normalizationPage input").prop("checked",!1),pageId.find("#ratinglockbtns").removeClass("opn"))},getAppraiserListForNormalization:function(){var pageId=settingsPage.container;if(-1!=ZPeopleComponents.select("#cycleId").getValue()){var params={mode:"getAppraiserForNormalization",conreqcsr:csrfToken};params.configId=ZPeopleComponents.select("#cycleId").getValue(),params.startIndex=PMSOperation.normStartIndex,params.revpendingemp=PMSOperation.REVIEWNOTCOMP;var appraiser=ZPeopleComponents.select("#reviewerId").getValue();void 0!=appraiser&&null!=appraiser&&""!==appraiser&&"-1"!=appraiser&&(params.appraiser=appraiser),params.ordertype="asc",$.post("/performanceConfig.zp",params,function(resultData){PMSOperation.REVIEWNOTCOMP&&void 0===resultData.pendingAppraiseeDetails||PMSOperation.REVIEWNOTCOMP&&resultData.pendingAppraiseeDetails.length<=0||PMSOperation.constructAppraiserPendingReviewList(resultData)})}else pageId.find("#zp_page_loading").remove(),pageId.find("#appraisermainDiv").addClass("DN"),pageId.find("#pendingReviewDiv").addClass("DN"),pageId.find("#normfiltericon").addClass("DNI"),PMSOperationCommon.setNoData(pageId.find("#normalizationPageNoData"),ZPI18N.getString("zp.norecfound"),"zp_nd_record",null,null,null)},onloadAppraiserListForNormalization:function(issearch){var pageId=settingsPage.container;setTimeout(function(){if(PMSOperation.normStartIndex=1,void 0==issearch){PMSOperation.narmalizatioenabledCycle("cycleId"),PMSOperationCommon.populateUsers("reviewerId",null,{defaultText:ZPI18N.getString("zp.select")},!1,pageId,"select");var mapMenu=ZPeopleComponents.menu("#normexpmenu",{forElement:pageId.find("#normalizeexpmenu"),className:"",itemclick:event=>{"zp_norm_exp"==event.detail.id?PMSCommon.Export.showExportPopup(PMSOperation.normalizationExport,"normalization"):"zp_norm_exp_dev"==event.detail.id&&PMSCommon.Export.showExportPopup(PMSOperation.normalizationExport,"normDeviation")}});pageId.find("#normalizeexpmenu").on("click",function(ev){mapMenu.show()})}pageId.find("#normalizationPage").removeClass("DN"),pageId.find("#normalizationPageNoData").addClass("DN"),pageId.find("#appraiserDetailsDiv").html(""),pageId.find("#pendingReviewDiv thead[attr=pendinglist]").remove(),pageId.find("#pendingReviewDiv tbody[attr=pendinglist]").remove(),pageId.find("#pa_alert").remove();var configId=ZPeopleComponents.select(pageId.find("#cycleId")).getValue();if(-1!=configId){var params={mode:"getAppraiserForNormalization",conreqcsr:csrfToken};params.configId=configId;var appraiser=ZPeopleComponents.select("#reviewerId").getValue();if(void 0!=appraiser&&null!=appraiser&&""!==appraiser&&"-1"!=appraiser&&(params.appraiser=appraiser),params.startIndex=PMSOperation.normStartIndex,params.ordertype="asc",issearch&&void 0!==params.appraiser){pageId.find("#normselectedfltr").removeClass("DNI");let filterValue=ZPeopleComponents.select("#reviewerId").getOptionData()[0].html;pageId.find("#selectedfltrlst").html("<li name=BreadCrumbElement><label>"+ZPI18N.getString("zp.appraisers")+' :</label><span title="'+filterValue+'">'+filterValue+'</span><a class="PI_cls" id="filterTypeClose" title="'+ZPI18N.getString("zp.remove")+'"></a></li>'),pageId.find("#selectedfltrlst [name=BreadCrumbElement]").unbind(),pageId.find("#selectedfltrlst [name=BreadCrumbElement]").on("click",function(){let filterFieldId=$(event.target).attr("id");void 0!==filterFieldId&&"filterTypeClose"===filterFieldId?(ZPeopleComponents.select("#reviewerId").deselectAllOptions(),PMSOperation.searchNormalizRatPer()):(PMSOperation.openFilterIcon(),ZPeopleComponents.select("#reviewerId").open())})}else pageId.find("#normselectedfltr").addClass("DNI"),pageId.find("#selectedfltrlst").empty();$.post("/performanceConfig.zp",params,function(resultData){if(void 0!=resultData.reviewNotComp&&1==resultData.reviewNotComp){var pa_alert='<div class="zpl_topgrpmnu" id="pa_alert"><div class="zpl_info"><div><p>'+ZPI18N.getString("zp.normalizationreviewNotcompleteMsg")+"</p></div><p></p></div></div>";$(pa_alert).insertBefore(pageId.find(".zpl_rgtcnt")),pageId.find("#normalizeexpmenu").hide()}else pageId.find("#normalizeexpmenu").show();PMSOperation.cycledetailsShow(params.configId,PMSOperation.NORMALIZATIONENABLECYCLE,"cycleDetails"),PMSOperation.constructAppraiserPendingReviewList(resultData)})}else pageId.find("#zp_page_loading").remove(),pageId.find("#normalizeexpmenu").hide(),pageId.find("#reviewOptDiv").addClass("DNI"),pageId.find("#normfiltericon").addClass("DNI"),PMSOperationCommon.setNoData(pageId.find("#normalizationPageNoData"),ZPI18N.getString("zp.norecfound"),"zp_nd_nodata",null,null,null)},100)},searchNormalizRatPer:function(){PMSOperation.onloadAppraiserListForNormalization(!0)},resetNormalizFilter:function(){settingsPage.container;ZPeopleComponents.select("#reviewerId").deselectAllOptions(),PMSOperation.onloadAppraiserListForNormalization(!0)},constructAppraiserPendingReviewList:function(resultData){var pageId=settingsPage.container;if(PMSOperation.hidefilter("normaliz_filter"),pageId.find("#zp_page_loading").remove(),PMSOperation.removeNormListSelection(),void 0!=settingsPage.fireScrollObj.normPendingList&&(settingsPage.fireScrollObj.normPendingList.reset(),delete settingsPage.fireScrollObj.normPendingList),void 0!=resultData.reviewNotComp&&0==resultData.reviewNotComp){if(pageId.find("#pendingReviewDiv").addClass("DN"),pageId.find("#appraisermainDiv").removeClass("DN"),pageId.find("#normfiltericon").removeClass("DNI"),pageId.find("#reviewOptDiv").removeClass("DNI"),pageId.find("#viewgraphBtn").removeClass("DN"),pageId.find("#allCheckbox").prop("checked",!1),PMSOperation.REVIEWNOTCOMP=!1,PMSOperation.REASONFIELD=void 0!=resultData.isNorReason&&resultData.isNorReason,PMSOperation.REASONMANDFIELD=void 0!=resultData.isNorReasonMandatory&&resultData.isNorReasonMandatory,PMSOperation.constructAppraiserList(resultData.appraiserDetails,resultData.reqNormalizopt),void 0!=resultData.appraiserDetails&&resultData.appraiserDetails.length>0)new FireScrollBack(PMSOperation.getAppraiserListForNormalization,pageId,"normPendingList")}else if(void 0!=resultData.reviewNotComp&&1==resultData.reviewNotComp){if(PMSOperation.REVIEWNOTCOMP=!0,pageId.find("#pendingReviewDiv").removeClass("DN"),pageId.find("#reviewOptDiv").addClass("DNI"),pageId.find("#normfiltericon").addClass("DNI"),pageId.find("#viewgraphBtn").addClass("DN"),pageId.find("#appraisermainDiv").addClass("DN"),pageId.find("#normselectedfltr").addClass("DNI"),ZPeopleComponents.select("#reviewerId").deselectAllOptions(),PMSOperation.constructPendingReviewList(resultData.pendingAppraiseeDetails),void 0!=resultData.pendingAppraiseeDetails&&resultData.pendingAppraiseeDetails.length>0)new FireScrollBack(PMSOperation.getAppraiserListForNormalization,pageId,"normPendingList")}else pageId.find("#normfiltericon").addClass("DNI"),pageId.find("#appraisermainDiv").addClass("DN"),pageId.find("#normalizationPageNoData").removeClass("DN"),PMSOperationCommon.setNoData(pageId.find("#normalizationPageNoData"),ZPI18N.getString("zp.norecfound"),"zp_nd_nodata",null,null,null)},constructPendingReviewList:function(resultData){var pageId=settingsPage.container;void 0!=resultData&&resultData.length>0?(PMSOperation.normStartIndex+=resultData.length,$.each(resultData,function(index,data){var row="";data.appraiserErecNo!=PMSOperation.TEMPAPPRAISERERECNO&&(PMSOperation.TEMPAPPRAISERERECNO=data.appraiserErecNo,row+='<thead attr="pendinglist"><tr><td colspan="100" class="--thmgryclr"><span><em>'+ZSEC.Encoder.encodeForHTML(data.appraiserEmpId)+"</em>&nbsp;-&nbsp;"+data.appraiser+"</span></td></tr></thead>",row+='<tbody id="'+data.appraiserErecNo+'" attr="pendinglist"></tbody>'),pageId.find("#pendingReviewDiv").append(row)}),$.each(resultData,function(index,data){var row="",expDet="",exper=void 0!=data.exper?data.exper:0;if(exper>0){var month=exper%12,year=parseInt(exper-month);expDet=(year=parseInt(year)>=12?parseInt(year)/12:0)+"&nbsp;"+ZPI18N.getString("zp.years")+"&nbsp;"+month+"&nbsp;"+ZPI18N.getString("zp.months")}row+='<tr> <td> <div class="zpl_em"> <div class="zpl_emimg"><img src="'+data.empPhoto+'"></div> <div class="zpl_emdts"> <div>',void 0!=data.empId&&(row+="<em>"+data.empId+" - </em>"),row+="<span>&nbsp;-&nbsp;"+data.name+"</span></div> <em>"+expDet+"</em> </div> </div> </td> <td><span><em>"+ZSEC.Encoder.encodeForHTML(data.appraiserEmpId)+"&nbsp;-&nbsp;</em> "+data.appraiser+"</span></td> </tr>",pageId.find("#pendingReviewDiv #"+data.appraiserErecNo).append(row)})):1==PMSOperation.normStartIndex&&(pageId.find("#pa_alert").remove(),pageId.find("#pendingReviewDiv").addClass("DN"),void 0!=settingsPage.fireScrollObj.normPendingList&&(settingsPage.fireScrollObj.normPendingList.reset(),delete settingsPage.fireScrollObj.normPendingList),PMSOperationCommon.setNoData(pageId.find("#normalizationPageNoData"),ZPI18N.getString("zp.normalizationreviewNotcompleteMsg"),"zp_nd_record",null,null,null))},constructAppraiserList:function(resultData,normalizReqOpt){var pageId=settingsPage.container;if(normalizReqOpt=void 0!=normalizReqOpt&&normalizReqOpt,void 0!=resultData&&resultData.length>0)PMSOperation.normStartIndex+=resultData.length,$.each(resultData,function(index,data){var colClass=data.deviation<0?"red":"grn",row='<tr appraiser="'+data.recordId+'"><td><div class="zcheckbox">';row+=(1==normalizReqOpt?'<input type="checkbox" name="check" class="zcheckbox__helper" onclick="PMSOperation.appraiserRatingLockForIndividualUser(this)" id="'+data.recordId+'">':'<input  class="zcheckbox__helper" type="checkbox" disabled>')+'<label for="'+data.recordId+'" class="zcheckbox__label"></label></div></td>',row+="<td onclick=\"PMSOperation.getNorRatingByAppraiser('"+data.recordId+'\',true)"><div class="zpl_em"><div class="zpl_emimg"><img src="'+data.empPhoto+'"></div>',row+="<span><b>"+data.name+"</b></span></div></td>",row+='<td id="appraiserDevi1_'+data.recordId+'" deviation="'+data.deviation+'"><span class="'+colClass+'">'+data.deviation+"</span></td>",void 0!=data.ratingLock&&1==data.ratingLock&&1==normalizReqOpt?row+='<td id="ratingLock" ><span><i class="PI_lock red" onclick="PMSOperation.lockUnLockRatingEditOption(this,0)"></i></span></td>':void 0!=data.ratingLock&&1==data.ratingLock?row+='<td><span><i class="PI_lock grn"></i></span></td>':row+=1==normalizReqOpt?'<td id="ratingLock"><span><i class="PI_lock grn" onclick="PMSOperation.lockUnLockRatingEditOption(this,1)"></i></span></td>':'<td><span><i class="PI_lock grn"></i></span></td>',0==data.normalizstatus?row+='<td id="nzReqstatus"><span>'+ZPI18N.getString("zp.normalizeRequested")+"</span></td>":1==data.normalizstatus&&data.deviation<0?row+='<td id="nzReqstatus"><span>'+ZPI18N.getString("zp.notyetIdeal")+"</span></td>":1==data.normalizstatus?row+='<td id="nzReqstatus"><span>'+ZPI18N.getString("zp.normalized")+"</span></td>":3==data.normalizstatus?row+='<td id="nzReqstatus"><span>'+ZPI18N.getString("zp.expiry")+"</span></td>":data.deviation<0?row+='<td id="nzReqstatus"><span>'+ZPI18N.getString("zp.notideal")+"</span></td>":row+='<td id="nzReqstatus"><span>'+ZPI18N.getString("zp.ideal")+"</span></td>",1!=data.normalizstatus&&0!=data.normalizstatus&&1==normalizReqOpt&&(3==data.normalizstatus||data.deviation<0)?row+='<td><div class="zpl_hvr"><span><button class="zlabel zlabel--blue  zlabel--outline zlabel--small" onclick="PMSOperation.requestForNormalize(\''+data.recordId+"',this)\" >"+ZPI18N.getString("zp.reqNormaliz")+"</button></span></div></td>":1==normalizReqOpt&&1==data.normalizstatus&&data.deviation<0?row+='<td><div class="zpl_hvr"><span><button class="zlabel zlabel--blue  zlabel--outline zlabel--small" onclick="PMSOperation.requestForNormalize(\''+data.recordId+"',this)\" >"+ZPI18N.getString("zp.reReqNormalize")+"</button></span></div></td>":row+="<td></td>",row+="</tr>",pageId.find("#appraiserDetailsDiv").append(row)}),0==normalizReqOpt&&pageId.find("#allCheckbox").prop("disabled",!0);else if(1==PMSOperation.normStartIndex){pageId.find("#viewgraphBtn").addClass("DN"),pageId.find("#appraisermainDiv").addClass("DN"),pageId.find("#normalizationPageNoData").removeClass("DN"),pageId.find("#normalizationPage").removeClass("DN");let noDataContent=ZPI18N.getString("zp.norecfound");pageId.find("#selectedfltrlst").children().length>0&&!pageId.find("#normselectedfltr").hasClass("DNI")&&(noDataContent=ZPI18N.getString("zp.searchnodata",[ZPI18N.getString("zp.appraisers")])),void 0!=settingsPage.fireScrollObj.normPendingList&&(settingsPage.fireScrollObj.normPendingList.reset(),delete settingsPage.fireScrollObj.normPendingList),PMSOperationCommon.setNoData(pageId.find("#normalizationPageNoData"),noDataContent,"no_data_found",null,null,null)}},getNorRatingByAppraiser:function(erecno,needreportee,obj){var pageId=settingsPage.container,params={mode:"getNorRatingByAppraiser",conreqcsr:csrfToken};params.configId=ZPeopleComponents.select(pageId.find("#cycleId")).getValue(),params.appraiser=erecno,params.needreportee=needreportee,needreportee&&(PMSOperation.ONLOADAPPRISER=erecno,PMSOperation.RATINGSUBMITTED=!1,PMSOperation.APPRAISERANDSUBUSERDETAILS=[]),PMSOperation.SELECTEDAPPRAISER=erecno,PMSOperation.APPRAISEERATINGDETALS={},PMSOperation.RATINGGIVENCOUNT={},$.post("/performanceConfig.zp",params,function(resultData){if(void 0!=resultData.appraiserSubUserlist&&void 0!=resultData.appraiserdetails&&(PMSOperation.APPRAISERANDSUBUSERDETAILS=resultData.appraiserdetails,PMSOperation.APPRAISERANDSUBUSERDETAILS=PMSOperation.APPRAISERANDSUBUSERDETAILS.concat(resultData.appraiserSubUserlist)),void 0!=resultData.ratingDetails){PMSOperation.constructRatingDetailsforNormalization(resultData,needreportee,obj);var row="";row=void 0!=resultData.appraiserName?ZPI18N.getString("zp.reviewsheet",new Array(ZPeople.decodeTxt(resultData.appraiserName))):ZPI18N.getString("zp.reviewsheet",new Array);let sliderDiv=$(PMSOperation.reviewSheetSlider.sliderDiv);sliderDiv.find("#sliHdrDiv h4").text(row),void 0!=resultData.ratingEditopt&&1==resultData.ratingEditopt?(PMSOperation.RATINGEDITOPTION=!0,sliderDiv.find("#sliFootDiv").removeClass("DN")):(PMSOperation.RATINGEDITOPTION=!1,sliderDiv.find("#sliFootDiv").addClass("DN")),PMSOperation.constructReviewSheetPage(resultData,needreportee,obj)}let sliderDiv=$(PMSOperation.reviewSheetSlider.sliderDiv);sliderDiv.find("#managerSearch").keyup(function(event){13==event.which&&PMSOperation.searchAppraiserManager()}),needreportee&&sliderDiv.find("#managerSearch").val(""),PMSOperation.constructAppraiserSublistDetails(needreportee,obj)})},searchAppraiserManager:function(){let pageId=settingsPage.container,sliderDiv=$(PMSOperation.reviewSheetSlider.sliderDiv);var params={mode:"managerSearchForNormalization",conreqcsr:csrfToken};params.configId=ZPeopleComponents.select(pageId.find("#cycleId")).getValue(),params.appraiser=PMSOperation.ONLOADAPPRISER;var searchval=sliderDiv.find("#managerSearch").val();(null!=searchval&&""!=searchval&&""!=searchval.trim()||(""==searchval||""==searchval.trim())&&PMSOperation.MANAGERSEARCHENABLE)&&(PMSOperation.MANAGERSEARCHENABLE=null!=searchval&&""!=searchval&&""!=searchval.trim(),params.searchval=searchval,PMSOperation.APPRAISERANDSUBUSERDETAILS=[],$.post("/performanceConfig.zp",params,function(resultData){resultData.length>0?(PMSOperation.APPRAISERANDSUBUSERDETAILS=resultData,PMSOperation.constructAppraiserSublistDetails(!0)):(sliderDiv.find("#appriserandSubUsrList").html(""),PMSOperationCommon.setNoData(sliderDiv.find("#appriserandSubUsrList"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null))}))},constructAppraiserSublistDetails:function(needreportee,obj){settingsPage.container;let sliderDiv=$(PMSOperation.reviewSheetSlider.sliderDiv);if(PMSOperation.APPRAISERANDSUBUSERDETAILS.length>0&&needreportee){sliderDiv.find("#appraiserSubortinate").show(),sliderDiv.find("#appriserandSubUsrList").html("");var isSelected=!1;$.each(PMSOperation.APPRAISERANDSUBUSERDETAILS,function(index,data){if(void 0!=data){var colClass=data.deviation<0?"red":"grn",emprow="<li onclick=\"PMSOperation.getNorRatingByAppraiserinPopup('"+data.recordId+'\',this)"><div class="a-itm-cntr">';void 0!=data.recordId&&data.recordId==PMSOperation.SELECTEDAPPRAISER&&(emprow='<li class="zpl_act" onclick="PMSOperation.getNorRatingByAppraiserinPopup(\''+data.recordId+'\',this)"><div class="a-itm-cntr">',isSelected=!0),emprow+='<div class="zpl_em"><div class="zpl_emimg"><img src="'+data.empPhoto+'"></div><div class="zpl_emdts"><div><em>'+data.empId+" - </em><b>"+data.name+"</b></div></div></div>",emprow+='<div class="MLauto '+colClass+'" id="appraiserDevi_'+data.recordId+'">'+data.deviation+"%</div></div></li>",sliderDiv.find("#appriserandSubUsrList").append(emprow)}}),isSelected&&sliderDiv.find("#reviewsheetrgt .h100_per").addClass("zpl_act")}else needreportee?sliderDiv.find("#appraiserSubortinate").hide():needreportee||void 0==obj||$(obj).closest("li").hasClass("zpl_act")||($(obj).closest("#appriserandSubUsrList").find("li").removeClass("zpl_act"),$(obj).closest("li").addClass("zpl_act"))},getNorRatingByAppraiserinPopup:function(erecno,obj){settingsPage.container;let sliderDiv=$(PMSOperation.reviewSheetSlider.sliderDiv);if(null==PMSOperation.SELECTEDAPPRAISER||PMSOperation.SELECTEDAPPRAISER!==erecno){var ratingchanges=!1;if(sliderDiv.find("#ratingDetails").find("tr").each(function(index,ele){ZPeopleComponents.select($(this).find("select")).getValue()==$(this).find("select").attr("defaultOldRating")||(ratingchanges=!0)}),ratingchanges){var deletePopUp=new DeleteAlertMessage;deletePopUp.title="",deletePopUp.despcription=ZPI18N.getString("zp.ratingChangesNeed"),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){PMSOperation.submitNormalizedRating(obj,erecno)},deletePopUp.cancelCallback=function(){PMSOperation.getNorRatingByAppraiser(erecno,!1,obj)},deletePopUp.show()}else PMSOperation.getNorRatingByAppraiser(erecno,!1,obj)}},constructRatingDetailsforNormalization:function(resultData,needreportee,obj){settingsPage.container;if(void 0==PMSOperation.reviewSheetSlider){let sliderTab=new Tab("reviewsheet",function(){let htm='<div class="zpl_mmnu"> <div class="zpl_mmnurgt"> <div class="zpl_act"> <div class="zpl_norstionrwshet"> <div class="zpl_norstionrwshetlft" style="display: none;" id="appraiserSubortinate">';htm+=PMSOperation.constructReviewSheetPageLft(),htm+='</div> <div class="zpl_norstionrwshetcnt"  id="reviewsheetrgt">',htm+='<div class="zpl_crd  h100_per wd100_per"> <div class="zpl_crdcnt"> <div class="zpl_gbox wd100_per">',htm+='<div class="zpl_secn"><div><ul class="zpl_tpcrdlst" id="ratingOpt">',htm+="</ul></div> </div>",htm+='<div class="zpl_secn"> <div class="zpl_tblres"> <table class="zpl_tbl wd100_per"> <thead> <tr> <th width="30%"><span>'+ZPI18N.getString("zp.employee")+'</span></th> <th width="25%"><span>'+ZPI18N.getString("zp.rating")+"</span></th>",PMSOperation.REASONFIELD&&(htm+='<th width="25%"><span>'+ZPI18N.getString("zp.reason")+"</span></th>"),htm+='<th width="20%"><span></span></th></tr> </thead> <tbody id="ratingDetails"> </tbody> </table> </div> </div>',htm+="</div> </div> </div>",htm+="</div> </div> </div> </div> </div>",$("#cardreviewsheet").html(htm);let viewgrph='<span class="zpl_mhderrgt"> <button id="indvviewgraphBtn" class="zlabel zlabel--outline zlabel--medium" onclick="PMSOperation.getNormalizationRatingChart(true)">'+ZPI18N.getString("zp.viewgraph")+"</button> </span>";$(viewgrph).insertBefore($("#cardreviewsheet").parent().find("#sliderCls"))},function(){PMSOperation.submitNormalizedRating()}),sheetName=void 0!=resultData.appraiserName?ZPI18N.getString("zp.reviewsheet",new Array(resultData.appraiserName)):ZPI18N.getString("zp.reviewsheet",new Array);PMSOperation.reviewSheetSlider=new sliderModal(sheetName,sliderTab),PMSOperation.reviewSheetSlider.fullPageSize=!0,PMSOperation.reviewSheetSlider.setCloseCallback(function(){PMSOperation.closeNorRepPop()}),PMSOperation.reviewSheetSlider.construct()}needreportee&&(PMSOperation.RATINGSUBMITTED=!1)},constructReviewSheetPage:function(resultData,needreportee,obj){var totalEmp=void 0!=resultData.totalEmp?resultData.totalEmp:0,totalRating=void 0!=resultData.totalRating?resultData.totalRating:0;PMSOperation.TOATLEMPLOYEEBYAPPRAISER=totalEmp,PMSOperation.TOATALRATING=totalRating,PMSOperation.RATINGDETAILS=resultData.ratingDetails;var countUser=0;let htm='<li class="zpl_act" onclick="PMSOperation.getAppraiseeByRatingId(\'1\',this)"><span class="PI_caslv"></span><span>'+ZPI18N.getString("zp.all")+'</span><b class="blu" id="allcount"></b></li>';if(totalRating<=totalEmp)$.each(resultData.ratingDetails,function(index,data){htm+="<li onclick=\"PMSOperation.getAppraiseeByRatingId('"+data.ratingId+'\',this)"><span class="PI_sicklv1"></span><span>'+data.ratingName+"</span>";var perUser=0;parseInt(totalEmp)<=parseInt(countUser)?perUser=0:parseInt(totalRating)-1==index?perUser=parseInt(totalEmp)-parseInt(countUser):(perUser=parseInt(totalEmp)>0&&void 0!=data.ratingPer?Math.round(totalEmp/100*parseInt(data.ratingPer)):0,parseInt(totalEmp)<parseInt(countUser+perUser)&&(perUser=parseInt(totalEmp)-parseInt(countUser))),countUser+=parseInt(perUser),PMSOperation.RATINGGIVENCOUNT[data.ratingId]=parseInt(data.rtgGvnCnt),htm+=PMSOperation.userDiffContruction(perUser,data.rtgGvnCnt),htm+="</li>"});else{$(PMSOperation.reviewSheetSlider.sliderDiv).find("#indvviewgraphBtn").addClass("DN");var perUser=0;$.each(resultData.ratingDetails,function(index,data){htm+="<li onclick=\"PMSOperation.getAppraiseeByRatingId('"+data.ratingId+'\',this)"><span class="PI_sicklv1"></span><span>'+data.ratingName+"</span>",PMSOperation.RATINGGIVENCOUNT[data.ratingId]=parseInt(data.rtgGvnCnt),perUser=data.rtgGvnCnt>0?1:0,htm+=PMSOperation.userDiffContruction(perUser,data.rtgGvnCnt),htm+="</li>"})}$(PMSOperation.reviewSheetSlider.sliderDiv).find("#ratingOpt").html(htm),void 0!=resultData.appraiseeDetails&&(PMSOperation.APPRAISEERATINGDETALS[1]=resultData.appraiseeDetails,PMSOperation.constructAllratingUserDetails(resultData.appraiseeDetails))},constructReviewSheetPageLft:function(){let _htm='<div class="zpl_norstionrwshetfix"><div class="zpl_search"><input placeholder="'+ZPI18N.getString("zp.search")+'" id="managerSearch" type="text" class="ztextbox"><i class="PI_lens" title="'+ZPI18N.getString("zp.search")+'"></i></div><div class="d-flexC ">';return _htm+='<em>Name</em><em class="MLauto">Deviation</em></div></div>',_htm+='<ul id="appriserandSubUsrList"></ul>'},getAppraiseeByRatingId:function(ratingId,obj){let pageId=settingsPage.container,sliderDiv=$(PMSOperation.reviewSheetSlider.sliderDiv);if(!$(obj).hasClass("zpl_act"))if(sliderDiv.find(".zpl_tpcrdlst li").removeClass("zpl_act"),$(obj).addClass("zpl_act"),sliderDiv.find("#emptPage").length&&sliderDiv.find("#emptPage").remove(),"1"==ratingId)PMSOperation.constructAllratingUserDetails(PMSOperation.APPRAISEERATINGDETALS[ratingId]);else{if(sliderDiv.find("#ratingDetails [selectOption=selectOpt]").each(function(index){ZPeopleComponents.select($(this)).destroy()}),sliderDiv.find("#ratingDetails").html(""),void 0==PMSOperation.APPRAISEERATINGDETALS[ratingId]||0==PMSOperation.APPRAISEERATINGDETALS[ratingId].length){var params={mode:"getAppraiseeByRating",conreqcsr:csrfToken,ratingId:ratingId};null!=PMSOperation.SELECTEDAPPRAISER&&void 0!=PMSOperation.SELECTEDAPPRAISER&&(params.appraiser=PMSOperation.SELECTEDAPPRAISER,params.configId=ZPeopleComponents.select(pageId.find("#cycleId")).getValue()),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(resultData){PMSOperation.APPRAISEERATINGDETALS[ratingId]=resultData}})}if(void 0!=PMSOperation.APPRAISEERATINGDETALS[ratingId]&&PMSOperation.APPRAISEERATINGDETALS[ratingId].length>0){var row="",opts=PMSOperation.constructRatingSelectOpt(ratingId),disableClass=0==PMSOperation.RATINGEDITOPTION?"disabled='disabled'":"";$.each(PMSOperation.APPRAISEERATINGDETALS[ratingId],function(index,data){var empRow=PMSOperation.employeeDetailsRow(data);row+='<tr><td><div class="zpl_em">'+empRow+"</div></td>",row+="<td><span><select "+disableClass+' style="display: none;" selectOption="selectOpt" oldRatingId="'+data.ratingId+'" defaultOldRating="'+data.ratingId+'" userErecno="'+data.recordId+'" >'+opts+"</select></span></td>",row+='<td><div class="zpl_hvr"><span><button class="zlabel zlabel--blue  zlabel--outline zlabel--medium" onclick="PMSOperation.openReviewPage(\''+data.perRecordId+"','"+data.configId+"','"+data.recordId+"')\">"+ZPI18N.getString("zp.viewRecord")+"</button></span></div></td></tr>"}),sliderDiv.find("#ratingDetails").html(row),ZPeopleComponents.select(sliderDiv.find("[selectOption=selectOpt]"),{change:PMSOperation.ratingGivenCalchange})}else sliderDiv.find("#ratingDetails").html(""),PMSOperationCommon.setNoData(sliderDiv.find("#ratingDetails").parent().parent(),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null,!1)}},ratingGivenCalchange:function(event){var data=event.detail;settingsPage.container;let sliderDiv=$(PMSOperation.reviewSheetSlider.sliderDiv);var newratingId=data.optionData.value,oldRatingId=data.previousValue;sliderDiv.find("#ratingOpt").html("");var ratinGivcnt=0,rows='<li onclick=PMSOperation.getAppraiseeByRatingId("1",this)><span class="PI_sicklv1"></span><span>'+ZPI18N.getString("zp.all")+"</span></li>",totaldeviation=0,perUser=0,countUser=0,totalEmp=PMSOperation.TOATLEMPLOYEEBYAPPRAISER,totalRating=PMSOperation.TOATALRATING;if(PMSOperation.TOATALRATING<=PMSOperation.TOATLEMPLOYEEBYAPPRAISER)$.each(PMSOperation.RATINGDETAILS,function(index,data){var ratinGivPer=0;rows+="<li onclick=PMSOperation.getAppraiseeByRatingId('"+data.ratingId+'\',this)><span class="PI_sicklv1"></span><span>'+data.ratingName+"</span>",void 0!=newratingId&&newratingId==data.ratingId&&void 0!=PMSOperation.RATINGGIVENCOUNT[data.ratingId]&&(PMSOperation.RATINGGIVENCOUNT[data.ratingId]+=1),void 0!=oldRatingId&&oldRatingId==data.ratingId&&void 0!=PMSOperation.RATINGGIVENCOUNT[data.ratingId]&&(PMSOperation.RATINGGIVENCOUNT[data.ratingId]-=1),(ratinGivcnt=parseInt(PMSOperation.RATINGGIVENCOUNT[data.ratingId]))>0&&(ratinGivPer=parseFloat(ratinGivcnt/totalEmp*100));var diffPer=parseInt(data.ratingPer)-parseInt(ratinGivPer);parseInt(totalEmp)<=parseInt(countUser)?perUser=0:parseInt(totalRating)-1==index?perUser=parseInt(totalEmp)-parseInt(countUser):(perUser=parseInt(totalEmp)>0&&void 0!=data.ratingPer?Math.round(totalEmp/100*parseInt(data.ratingPer)):0,parseInt(totalEmp)<parseInt(countUser+perUser)&&(perUser=parseInt(totalEmp)-parseInt(countUser))),countUser+=parseInt(perUser),diffPer<0&&perUser!=ratinGivcnt&&(totaldeviation+=diffPer),rows+=PMSOperation.userDiffContruction(perUser,ratinGivcnt),rows+="</li>"});else{var ratinPer=parseFloat(100/totalRating);$.each(PMSOperation.RATINGDETAILS,function(index,data){if(rows+="<li onclick=PMSOperation.getAppraiseeByRatingId('"+data.ratingId+'\',this)><span class="PI_sicklv1"></span><span>'+data.ratingName+"</span>",void 0!=newratingId&&newratingId==data.ratingId&&void 0!=PMSOperation.RATINGGIVENCOUNT[data.ratingId]&&(PMSOperation.RATINGGIVENCOUNT[data.ratingId]+=1),void 0!=oldRatingId&&oldRatingId==data.ratingId&&void 0!=PMSOperation.RATINGGIVENCOUNT[data.ratingId]&&(PMSOperation.RATINGGIVENCOUNT[data.ratingId]-=1),ratinGivcnt=parseInt(PMSOperation.RATINGGIVENCOUNT[data.ratingId]),perUser=0,ratinGivcnt>0){perUser=1;var diffPer=parseInt(ratinPer)-parseInt(ratinPer*ratinGivcnt);totaldeviation+=diffPer}rows+=PMSOperation.userDiffContruction(perUser,ratinGivcnt),rows+="</li>"})}sliderDiv.find("#ratingOpt").html(rows);var devitionObj=sliderDiv.find("#appraiserDevi_"+PMSOperation.SELECTEDAPPRAISER);devitionObj.html(totaldeviation+"%"),totaldeviation<0?(devitionObj.addClass("red"),devitionObj.removeClass("grn")):(devitionObj.addClass("grn"),devitionObj.removeClass("red"))},closeNorRepPop:function(){$(PMSOperation.reviewSheetSlider.sliderDiv).find("#ratingDetails [selectOption=selectOpt]").each(function(index){ZPeopleComponents.select($(this)).destroy()}),PMSOperation.reviewSheetSlider.remove(),PMSOperation.reviewSheetSlider=void 0,PMSOperation.RATINGSUBMITTED&&PMSOperation.onloadAppraiserListForNormalization(!0)},submitNormalizedRating:function(obj,erecno){var userArr=[];let sliderDiv=$(PMSOperation.reviewSheetSlider.sliderDiv),pageId=settingsPage.container;var params={mode:"submitNormalizRating",conreqcsr:csrfToken},error=!1;let appraiseeDetails=void 0!=PMSOperation.APPRAISEERATINGDETALS[1]?PMSOperation.APPRAISEERATINGDETALS[1]:new Array;sliderDiv.find("#ratingDetails").find("tr").each(function(index,ele){var radata={},ratingId=ZPeopleComponents.select($(this).find("[selectOption=selectOpt]")).getValue(),oldRatig=$(this).find("[selectOption=selectOpt]").attr("defaultOldRating"),rateruser=$(this).find("[selectOption=selectOpt]").attr("userErecno"),reason=$.trim($(this).find("#norComment").val()),oldValindex=appraiseeDetails.findIndex(obj=>obj.recordId===rateruser),oldReason=-1!=oldValindex?appraiseeDetails[oldValindex].norReason:"";ratingId!=oldRatig?(""===reason&&PMSOperation.REASONMANDFIELD&&(error=!0),radata.newRatingId=ratingId,radata.user=rateruser,radata.reason=reason,userArr.push(radata)):""==reason&&reason==oldReason||(""===reason&&PMSOperation.REASONMANDFIELD&&(error=!0),radata.reason=reason,radata.user=rateruser,userArr.push(radata))}),userArr.length>0&&!error?(params.normalizratingArray=JSON.stringify(userArr),void 0!=ZPeopleComponents.select(pageId.find("#cycleId")).getValue()?params.configId=ZPeopleComponents.select(pageId.find("#cycleId")).getValue():void 0!=PMSOperation.APPRAISERNORMALIZECONFIGID&&(params.configId=PMSOperation.APPRAISERNORMALIZECONFIGID),params.ratingId=PMSOperation.SELECTEDRATINGID,void 0!=PMSOperation.SELECTEDAPPRAISER&&null!=PMSOperation.SELECTEDAPPRAISER&&(params.appraiser=PMSOperation.SELECTEDAPPRAISER),$.post("/performanceConfig.zp",params,function(resultData){void 0!=resultData.msg&&"success"==resultData.msg?(PMSOperation.RATINGSUBMITTED=!0,ZPeople.Message.success(ZPI18N.getString("zp.ratingUpdated")),void 0!=obj?PMSOperation.getNorRatingByAppraiser(erecno,!1,obj):PMSOperation.getNorRatingByAppraiser(PMSOperation.SELECTEDAPPRAISER,!1)):void 0!=resultData.msg&&"APPROVAL_CANNOT_NORM"==resultData.msg?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.noNormApprovedRec")):void 0!=resultData.msg&&"PUSHED_NORM"==resultData.msg?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.noNormPushedRec")):void 0!=resultData.msg&&"permission denied"==resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.permdenied")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))})):error?ZPeople.Message.failure(ZPI18N.getString("zp.normCommentNotGivenMsg")):ZPeople.Message.warning(ZPI18N.getString("zp.ratingnotChanges"))},constructAllratingUserDetails:function(resultData){let row="",pageId=$(PMSOperation.reviewSheetSlider.sliderDiv);var disableClass=0==PMSOperation.RATINGEDITOPTION?"disabled='disabled'":"";$.each(resultData,function(index,data){var empRow=PMSOperation.employeeDetailsRow(data),opts=PMSOperation.constructRatingSelectOpt(data.ratingId);row+='<tr><td><div class="zpl_em">'+empRow+"</div></td>",row+="<td><span><select "+disableClass+' style="display: none;"  selectOption="selectOpt" oldRatingId="'+data.ratingId+'" defaultOldRating="'+data.ratingId+'" userErecno="'+data.recordId+'" >'+opts+"</select></span></td>",PMSOperation.REASONFIELD&&(row+='<td><div><textarea class="ztextbox" style="width: 100%;" id="norComment" '+disableClass+">"+data.norReason+"</textarea></div></td>"),row+='<td><div class="zpl_hvr"><span><button class="zlabel zlabel--blue  zlabel--outline zlabel--medium" onclick="PMSOperation.openReviewPage(\''+data.perRecordId+"','"+data.configId+"','"+data.recordId+"')\">"+ZPI18N.getString("zp.viewRecord")+"</button></span></div></td></tr>"}),pageId.find("#ratingDetails").html(row),pageId.find("#ratingDetails [selectOption=selectOpt]").each(function(index){ZPeopleComponents.select($(this)),$(this).on("zselectchange",PMSOperation.ratingGivenCalchange)}),pageId.find("#allcount").text(resultData.length)},openReviewPage:function(recordId,configId,userId){window.open("#operations/performance/cycle-reviewuser:"+userId+"/configId:"+configId+"/recordId:"+recordId)},constructRatingSelectOpt:function(ratingId){let pageId=$(PMSOperation.reviewSheetSlider.sliderDiv),opt="";return void 0!=PMSOperation.RATINGDETAILS&&$.each(PMSOperation.RATINGDETAILS,function(index,data){data.ratingId==ratingId?(PMSOperation.SELECTEDRATINGID=data.ratingId,opt+='<option selected value="'+data.ratingId+'">'+data.ratingName+"</option>",pageId.find("#ratingname").html(data.ratingName)):opt+='<option value="'+data.ratingId+'">'+data.ratingName+"</option>"}),opt},employeeDetailsRow:function(data){var emprow="";if(void 0!=data){emprow='<div class="zpl_emimg"><img src="'+data.empPhoto+'"></div>',emprow+='<div class="zpl_emdts"><div>',void 0!=data.empId&&(emprow+="<em>"+data.empId+" - </em>"),emprow+="<b>"+data.name+"</b></div>";var exper=void 0!=data.exper?data.exper:0;if(exper>0){var month=exper%12,year=parseInt(exper-month);emprow+="<em>"+(year=parseInt(year)>=12?parseInt(year)/12:0)+"&nbsp;"+ZPI18N.getString("zp.years")+"&nbsp;"+month+"&nbsp;"+ZPI18N.getString("zp.months")+"</em>"}emprow+="</div>"}return emprow},userDiffContruction:function(perUser,rtgGvnCnt){return perUser>rtgGvnCnt?'<b class="grn">'+rtgGvnCnt+"/"+perUser+"("+ZPI18N.getString("zp.more")+")</b>":perUser<rtgGvnCnt?'<b class="red">'+rtgGvnCnt+"/"+perUser+"("+ZPI18N.getString("zp.exceeded")+")</b>":"<b>"+rtgGvnCnt+"/"+perUser+"</b>"},requestForNormalize:function(erecno,obj){if($(obj).closest("tr").find("#ratingLock").find("i").hasClass("PI_lock")){var infoPopUp=new InfoAlertMessage;infoPopUp.title="",infoPopUp.despcription=ZPI18N.getString("zp.normalizeReqsendreviewLockshowmsg"),infoPopUp.yesButtonText=ZPI18N.getString("zp.yes"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.no"),infoPopUp.callback=function(){PMSOperation.addNormalizReq(erecno,obj)},infoPopUp.show()}else PMSOperation.addNormalizReq(erecno,obj)},addNormalizReq:function(erecno,obj){var pageId=settingsPage.container,params={mode:"addNormalizReq",conreqcsr:csrfToken};params.configId=ZPeopleComponents.select(pageId.find("#cycleId")).getValue(),params.appraiser=erecno,void 0!=erecno&&null!=erecno||(params.appraiser=PMSOperation.SELECTEDAPPRAISER),$.post("/performanceConfig.zp",params,function(resultData){"success"===resultData.msg?(ZPeople.Message.success(ZPI18N.getString("zp.reqAddeddSuccess")),$(obj).closest("tr").find("#ratingLock").find("i").removeClass("PI_lock red").addClass("PI_lock grn"),$(obj).closest("tr").find("#ratingLock").attr("onclick","PMSOperation.lockUnLockRatingEditOption(this,1)"),$(obj).closest("tr").find("#ratingLock").attr("title",ZPI18N.getString("zp.clicktolckRating")),$(obj).closest("tr").find("#nzReqstatus").html(ZPI18N.getString("zp.normalizeRequested")),pageId.find("#nzReqstatus").next().html("")):"permissiondenied"===resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.permdenied")):ZPeople.Message.warning(resultData.msg)})},appraiserRatingLockForAllUser:function(obj){var pageId=settingsPage.container;$(obj).find("input[type=checkbox]").is(":checked")?(pageId.find("#appraiserDetailsDiv").find("tr").find("input[type=checkbox]").prop("checked",!0),pageId.find("#ratinglockbtns").addClass("opn")):(pageId.find("#appraiserDetailsDiv").find("tr").find("input[type=checkbox]").prop("checked",!1),pageId.find("#ratinglockbtns").removeClass("opn"))},appraiserRatingLockForIndividualUser:function(){var appraiseerSelectedCnt=0,totalAppraiserCnt=0,pageId=settingsPage.container;pageId.find("#appraiserDetailsDiv").find("tr").each(function(index,ele){$(this).find("input[type=checkbox]").is(":checked")&&(appraiseerSelectedCnt+=1),totalAppraiserCnt+=1}),0==appraiseerSelectedCnt?(pageId.find("#ratinglockbtns").removeClass("opn"),pageId.find("#allCheckbox").prop("checked",!1)):(appraiseerSelectedCnt==totalAppraiserCnt&&pageId.find("#allCheckbox").prop("checked",!0),pageId.find("#ratinglockbtns").addClass("opn"))},lockUnLockRatingEditOption:function(obj,type){var appraiser=$(obj).closest("tr").attr("appraiser");if(void 0!=appraiser&&void 0!=ZPeopleComponents.select("#cycleId").getValue()){var params={mode:"addNormalizationRatinglock",conreqcsr:csrfToken};params.configId=ZPeopleComponents.select("#cycleId").getValue(),params.type=type;var appraisers=[];appraisers.push(appraiser),params.appraiserarr=JSON.stringify(appraisers),PMSOperation.excuteRatingLockReq(params,obj)}},ratingEditoptionLock:function(type){var pageId=settingsPage.container,params={mode:"addNormalizationRatinglock",conreqcsr:csrfToken};if(void 0!=ZPeopleComponents.select(pageId.find("#cycleId")).getValue()){params.configId=ZPeopleComponents.select(pageId.find("#cycleId")).getValue();var appraisers=new Array;appraisers=[];if(pageId.find("#allCheckbox").is(":checked"))params.alluser=!0;else{appraisers=[];pageId.find("#appraiserDetailsDiv").find("tr").each(function(index,ele){$(this).find("input[type=checkbox]").is(":checked")&&appraisers.push($(this).attr("appraiser"))})}params.appraiserarr=JSON.stringify(appraisers),params.type=type,PMSOperation.excuteRatingLockReq(params)}},excuteRatingLockReq:function(params,obj){var pageId=settingsPage.container;$.post("/performanceConfig.zp",params,function(resultData){pageId.find("#allCheckbox").prop("checked",!1),pageId.find("#ratinglockbtns").removeClass("opn"),void 0!=resultData.msg&&"success"==resultData.msg?(1==params.type?ZPeople.Message.success(ZPI18N.getString("zp.reviewlocked")):ZPeople.Message.success(ZPI18N.getString("zp.ratingeditUnLocked")),void 0!=obj&&0==params.type?($(obj).removeClass("red").addClass("grn"),$(obj).attr("onclick","PMSOperation.lockUnLockRatingEditOption(this,1)"),$(obj).attr("title",ZPI18N.getString("zp.clicktolckRating"))):void 0!=obj?($(obj).addClass("red").removeClass("grn"),$(obj).attr("onclick","PMSOperation.lockUnLockRatingEditOption(this,0)"),$(obj).attr("title",ZPI18N.getString("zp.clicktoUnlckRating"))):PMSOperation.searchNormalizRatPer()):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))})},cycledetailsShow:function(configId,obj,id){var pageId=settingsPage.container;if(void 0!=obj&&obj.length>0&&"-1"!=configId){var cycleobj="";$.each(obj,function(key,value){value.configId!==configId||(cycleobj=value)}),void 0!=cycleobj&&""!=cycleobj&&(pageId.find("#"+id).text(ZPeople.decodeTxt(cycleobj.periodName)),pageId.find("#"+id).removeClass("DN"))}},narmalizatioenabledCycle:function(id){var pageId=settingsPage.container;void 0!=PMSOperation.NORMALIZATIONENABLECYCLE&&0!=PMSOperation.NORMALIZATIONENABLECYCLE.length||$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getNormalizationCycle",conreqcsr:csrfToken,isReport:!1},success:function(resultdata){PMSOperation.NORMALIZATIONENABLECYCLE=resultdata}});var _selectObj={},opt=PMSOperation.cycleOptionConstruct(PMSOperation.NORMALIZATIONENABLECYCLE);_selectObj.options=opt,_selectObj.contentType="text",_selectObj.dataMapping={label:"name",value:"id",informativeText:"name"},_selectObj.search={by:["name"],highlightKeyword:!0},_selectObj.value=opt[0].id,ZPeopleComponents.select(pageId.find("#cycleId"),_selectObj),pageId.find("#cycleId").unbind(),pageId.find("#cycleId").on("zselectchange",PMSOperation.changeNormCycle);var normCycleSelWidth=$(ZPeopleComponents.select(pageId.find("#cycleId")).getElement()[0]).outerWidth();ZPeopleComponents.select(pageId.find("#cycleId")).setAttribute("dropdownList",{width:normCycleSelWidth+"px"})},changeNormCycle:function(event){event.detail.fromUI&&PMSOperation.onloadAppraiserListForNormalization(!0)},cycleOptionConstruct:function(cycleObj){var _options=[];return cycleObj.length>0?$.each(cycleObj,function(index,data){_options.push({name:ZPeople.decodeTxt(data.periodName),id:data.configId+""})}):_options.push({name:ZPI18N.getString("zp.select"),id:"-1"}),_options},hidefilter:function(id){var pageId=settingsPage.container;pageId.hasClass("zpl_fltr_flt")&&pageId.removeClass("zpl_fltr_flt")},getNormalizationRatingChart:function(individual){var pageId=settingsPage.container,normReport=new Tab("normZchartData",function(){});if(-1!=ZPeopleComponents.select(pageId.find("#cycleId")).getValue()){var params={mode:"getNormliationChartReport",conreqcsr:csrfToken};params.configId=ZPeopleComponents.select(pageId.find("#cycleId")).getValue();var cyclename=PMSOperation.cyclename(params.configId,PMSOperation.NORMALIZATIONENABLECYCLE),chatName=ZPI18N.getString("zp.normalizationReport",new Array(cyclename));1==individual&&(params.appraiser=PMSOperation.SELECTEDAPPRAISER,chatName=ZPI18N.getString("zp.idealactualRatingReport")),PMSOperation.normReport=new popupModal(chatName,normReport),PMSOperation.normReport.largeSize=!0,PMSOperation.normReport.setCloseCallback(function(){PMSOperation.normReport.remove(),PMSOperation.normReport={}}),PMSOperation.normReport.construct(),$(PMSOperation.normReport.sliderDiv).find("#modalFooter").addClass("DNI"),PMSOperation.normalizationChartDataExcute(params,individual)}else PMSOperationCommon.setNoData(pageId.find("#cardnormZchartData"),ZPI18N.getString("zp.norecfound"),"zp_nd_record",null,null,null)},normalizationChartDataExcute:function(params,individual){$.post("/performanceConfig.zp",params,function(resultData){var pageId=$(PMSOperation.normReport.sliderDiv);pageId.find("#cardnormZchartData").find("#zp_page_loading").remove(),pageId.find("#cardnormZchartData").find(".ZPNdata").remove(),void 0!=resultData.raitngName&&0==individual?PMSOperation.constructOverAllchartData(resultData):void 0!=resultData.raitngName?PMSOperation.constructIndividualchartData(resultData):PMSOperationCommon.setNoData(pageId.find("#cardnormZchartData"),ZPI18N.getString("zp.norecfound"),"zp_nd_record",null,null,null)})},cyclename:function(configId,obj){if(void 0!=obj&&obj.length>0&&"-1"!=configId){var cycleobj="";if($.each(obj,function(key,value){value.configId!==configId||(cycleobj=value)}),void 0!=cycleobj&&""!=cycleobj&&void 0!=cycleobj.periodName)return cycleobj.periodName}return""},constructOverAllchartData:function(resultData){var pageId=$(PMSOperation.normReport.sliderDiv);pageId.find("#cardnormZchartData").highcharts({chart:{height:600,type:"spline"},title:{text:"Chart View"},xAxis:{categories:resultData.raitngName},yAxis:{title:{text:ZPI18N.getString("zp.count")},labels:{formatter:function(){return this.value}}},tooltip:{crosshairs:!0,shared:!0},plotOptions:{spline:{marker:{radius:4,lineColor:"#666666",lineWidth:1}}},series:[{name:ZPI18N.getString("zp.actualRating"),marker:{symbol:"circle"},data:resultData.ratingGivenPer},{name:ZPI18N.getString("zp.idealRating"),marker:{symbol:"circle"},data:resultData.raitngPer}]}),pageId.find("#cardnormZchartData").find("svg").find("text:last").html("")},constructIndividualchartData:function(resultData){var pageId=$(PMSOperation.normReport.sliderDiv);pageId.find("#cardnormZchartData").highcharts({chart:{height:600,type:"column",backgroundColor:"transparent"},title:{text:""},xAxis:{categories:resultData.raitngName,title:{text:ZPI18N.getString("zp.rating"),style:{fontSize:"14px"}}},yAxis:{allowDecimals:!1,title:{text:ZPI18N.getString("zp.users"),style:{fontSize:"14px"}}},plotOptions:{bar:{dataLabels:{enabled:!1}}},legend:{enabled:!1},credits:{enabled:!1},plotOptions:{series:{cursor:"pointer"},column:{maxPointWidth:50,pointPadding:0,borderWidth:0}},series:[{name:ZPI18N.getString("zp.idealRating"),color:"#999",backgroundColor:"transparent",data:resultData.raitngPer},{name:ZPI18N.getString("zp.actualRating"),color:"#579DE6",backgroundColor:"transparent",data:resultData.ratingGivenPer}],navigation:{buttonOptions:{enabled:!1}}}),pageId.find("#cardnormZchartData").find("svg").find("text:last").html("")},normalizationExport:function(mode){var popCont=$(PMSCommon.Export.EXPACK_MODAL.sliderDiv),pageID=settingsPage.container,ftype=popCont.find("input[name=zp_ftype]:checked").val(),formObj=$("#zp_normalization_Export").html("");formObj.append('<input type="hidden" value="'+ftype+'" name="ftype"/>'),formObj.append('<input type="hidden" value="'+csrfToken+'" name="'+csrfParamName+'"/>'),"normalization"==mode?formObj.append('<input type="hidden" value="normalization" name="submode"/>'):formObj.append('<input type="hidden" value="normDeviation" name="submode"/>'),formObj.append('<input type="hidden" value="'+pageID.find("#cycleId").val()+'" name="configId"/>'),null!=pageID.find("#reviewerId").val()&&"-1"!=pageID.find("#reviewerId").val()&&formObj.append('<input type="hidden" value="'+pageID.find("#reviewerId").val()+'" name="managerId"/>'),formObj.submit(),PMSCommon.Export.EXPACK_MODAL.close()},initPendingCREmplList:function(type,obj){PMSOperation.CR_ST_DATE=$(obj).attr("fetfrm"),PMSOperation.CR_TO_DATE=$(obj).attr("fetto"),PMSOperation.CR_FS_ST_IDX=1,PMSOperation.CR_FETCH_MODE=type;var popupTab=new Tab("CRPendingRemainderView",function(){});PMSOperation.CR_REMAINDER_MODAL=new sliderModal("",popupTab),PMSOperation.CR_REMAINDER_MODAL.setCloseCallback(function(){PMSOperation.CR_REMAINDER_MODAL.remove(),PMSOperation.CR_FS_ST_IDX=1,PMSOperation.CR_ST_DATE="",PMSOperation.CR_TO_DATE="",PMSOperation.CR_FETCH_MODE="",void 0!==settingsPage.fireScrollObj.CRRemainderPendinglist&&(settingsPage.fireScrollObj.CRRemainderPendinglist.reset(),delete settingsPage.fireScrollObj.CRRemainderPendinglist)}),PMSOperation.CR_REMAINDER_MODAL.construct(),$(PMSOperation.CR_REMAINDER_MODAL.sliderDiv).find(".zpl_mfoter").html(""),PMSOperation.constructCRRemainderModal()},constructCRRemainderModal:function(isSearch){let pageId=$(PMSOperation.CR_REMAINDER_MODAL.sliderDiv),statusName=ZPI18N.getString("zp.selfassessment");"1"===PMSOperation.CR_FETCH_MODE&&(statusName=ZPI18N.getString("zp.reviewerreview")),void 0!=isSearch&&isSearch&&(PMSOperation.CR_FS_ST_IDX=1);let pendingCntMode=PMSOperation.CR_Self_Enabled?PMSOperation.CR_FETCH_MODE:"0";void 0!=isSearch&&isSearch?pageId.find(".zpl_tblres").html(ZPeople.LOADING_HTML):pageId.find("#cardCRPendingRemainderView").html(ZPeople.LOADING_HTML);let params={mode:"getCRReminderPendingList",startDate:PMSOperation.CR_ST_DATE,endDate:PMSOperation.CR_TO_DATE,startIndex:PMSOperation.CR_FS_ST_IDX,reclimit:50,compmode:PMSOperation.CR_FETCH_MODE,conreqcsr:csrfToken};pageId.find(".search-cmn").hasClass("opn")?(params.searchText=pageId.find("#CRReminderSerachEmployee").val(),PMSOperation.REMINDER_POKE_PREV_SEARCHTEXT=params.searchText,pageId.find(".zpl_tblres").html(ZPeople.LOADING_HTML)):(pageId.find("#cardCRPendingRemainderView").html(ZPeople.LOADING_HTML),PMSOperation.REMINDER_POKE_PREV_SEARCHTEXT=""),$.post(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){if(pageId.find("#zp_page_loading").remove(),$(PMSOperation.CR_REMAINDER_MODAL.sliderDiv).find("#sliHdrDiv h4").html(statusName),void 0===resultData.MSG||"PERMISSION_DENIED"!==resultData.MSG){if(!(void 0!==resultData.PENDINGLIST&&Object.keys(resultData.PENDINGLIST).length>0))return isSearch?void PMSOperationCommon.setNoData(pageId.find(".zpl_tblres"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null):void PMSOperationCommon.setNoData(pageId.find("#cardCRPendingRemainderView"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null);if(void 0!=isSearch&&isSearch){let _htm='<table class="zpl_tbl wd100_per"><thead><tr><th style="width: 1%;">';_htm+='<div class="zcheckbox" id="remindCRallchkbox" onclick="PMSOperation.enableDisableAll(this);"><input id="crremindall" type="checkbox" name="check" class="zcheckbox__helper"><label for="crremindall" class="zcheckbox__label"></label></div>',_htm+="</th><th></th>",_htm+='<th width="150"></th></tr></thead>',_htm+='<tbody id="pendinglisttbody"></tbody>',_htm+="</table>",pageId.find(".zpl_tblres").html(_htm)}else{let _htm='<div class="zpl_btnmnu"> ';_htm+='<div class="search-cmn"> <i class="PI_lens"  title="'+ZPI18N.getString("zp.search")+'"></i>',_htm+='<input type="text" class="ztextbox" id="CRReminderSerachEmployee" placeholder="'+ZPI18N.getString("zp.searchdata")+'" onkeyup="PMSOperation.searchCRReminderEmployees(this,\'CRReminder\')"> <i class="PI_cls" onclick="PMSOperation.clssearch(\'CRReminder\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div>',_htm+='<div class="actn_ovrly" style="z-index: 6;" id="CRReminderMultiActionDiv"> <div><button class="zlabel  zlabel--blue zlabel--outline zlabel--medium" id="remindpokeCRallbtn" onclick="PMSOperation.triggerReminderCR(this);">'+ZPI18N.getString("zp.reminder.remind")+'</button> </div> <i class="PI_cls" onclick="PMSOperation.removeAllIncludeUserMultiDeleteAction(\'CRReminder\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div>',_htm+='<div class="zpl_rgt"><span><label>'+ZPI18N.getString("zp.totalApllicableemployees")+'</label>&nbsp;:&nbsp;<b id="zp_pending_recordcount" class="">'+PMSOperation.CRREVIEW_DATA[pendingCntMode].pending+"</b></span>",_htm+='<button class="zlabel zlabel--blue zlabel--outline zlabel--medium" id="remindCRAllUsersBtn" onclick="PMSOperation.triggerReminderCR(this);">'+ZPI18N.getString("zp.cyclestatus.remindall")+"</button>",_htm+='<i class="zpl_ibg PI_lens" onclick="PMSOperation.opnsearch(\'CRReminder\')" title="'+ZPI18N.getString("zp.search")+'"></i>',_htm+="</div></div>",_htm+='<div type="'+PMSOperation.CR_FETCH_MODE+'"><div class="zpl_crdcnt">',_htm+='<div class="zpl_tblres"><table class="zpl_tbl wd100_per"><thead><tr><th style="width: 1%;">',_htm+='<div class="zcheckbox" id="remindCRallchkbox" onclick="PMSOperation.enableDisableAll(this);"><input id="crremindall" type="checkbox" name="check" class="zcheckbox__helper"><label for="crremindall" class="zcheckbox__label"></label></div>',_htm+="</th><th></th>",_htm+='<th width="150"></th></tr></thead>',_htm+='<tbody id="pendinglisttbody"></tbody>',_htm+="</table></div></div></div>",pageId.find("#cardCRPendingRemainderView").html(_htm)}if(PMSOperation.constructCRPendingListRow(resultData.PENDINGLIST),PMSOperation.CR_FS_ST_IDX=PMSOperation.CR_FS_ST_IDX+Object.keys(resultData.PENDINGLIST).length,resultData.ishasnext)new FireScrollBack(PMSOperation.pendingCRRemainderList,pageId.find("#cardCRPendingRemainderView"),"CRRemainderPendinglist");else void 0!==settingsPage.fireScrollObj.CRRemainderPendinglist&&(settingsPage.fireScrollObj.CRRemainderPendinglist.reset(),delete settingsPage.fireScrollObj.CRRemainderPendinglist)}else PMSOperationCommon.setNoData(pageId.find("#cardCRPendingRemainderView"),ZPI18N.getString("zp.permissiondeniedtoaccessthispage"),"zp_nd_permission",null,null,null)})},pendingCRRemainderList:function(){let pageId=$(PMSOperation.CR_REMAINDER_MODAL.sliderDiv),params={mode:"getCRReminderPendingList",startDate:PMSOperation.CR_ST_DATE,endDate:PMSOperation.CR_TO_DATE,startIndex:PMSOperation.CR_FS_ST_IDX,reclimit:50,compmode:PMSOperation.CR_FETCH_MODE,conreqcsr:csrfToken};pageId.find(".search-cmn").hasClass("opn")&&(params.searchText=pageId.find("#CRReminderSerachEmployee").val()),ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){if(void 0!==settingsPage.fireScrollObj.CRRemainderPendinglist&&(settingsPage.fireScrollObj.CRRemainderPendinglist.reset(),delete settingsPage.fireScrollObj.CRRemainderPendinglist),void 0!==resultData.PENDINGLIST&&Object.keys(resultData.PENDINGLIST).length>0&&(pageId.find("#cardCRPendingRemainderView #remindCRallchkbox input").prop("checked",!1),PMSOperation.constructCRPendingListRow(resultData.PENDINGLIST),PMSOperation.CR_FS_ST_IDX=PMSOperation.CR_FS_ST_IDX+Object.keys(resultData.PENDINGLIST).length,resultData.ishasnext))new FireScrollBack(PMSOperation.pendingCRRemainderList,pageId.find("#cardCRPendingRemainderView"),"CRRemainderPendinglist")})},constructCRPendingListRow:function(empObj){let pageId=$(PMSOperation.CR_REMAINDER_MODAL.sliderDiv),_dataHtm="";$.each(empObj,function(index,obj){_dataHtm='<tr id="'+obj.erecNo+'"><td><div class="zcheckbox"><input id="remind_'+obj.erecNo+'" type="checkbox" name="check" class="zcheckbox__helper"><label for="remind_'+obj.erecNo+'" class="zcheckbox__label"></label></div></td>',_dataHtm+='<td><div class="zpl_em">',_dataHtm+='<div class="zpl_emimg"><img src="'+obj.empPhoto+'"></div>',_dataHtm+='<div class="zpl_emdts"><div><em>'+obj.empId+" - </em><b>"+obj.name+"</b></div><em>"+obj.designationName+"</em></div>",_dataHtm+="</div> </td>",_dataHtm+='<td><div class="zpl_hvr"><button type="button" class="zlabel zlabel--blue zlabel--small zlabel--outline" id="particularUser" erecNo="'+obj.erecNo+'" onclick="PMSOperation.triggerReminderCR(this);">'+ZPI18N.getString("zp.reminder.remind")+"</button></div></td></tr>",pageId.find("#cardCRPendingRemainderView #pendinglisttbody").append(_dataHtm);let usrRow=pageId.find("#cardCRPendingRemainderView #pendinglisttbody #"+obj.erecNo);$(usrRow).data(obj),$(usrRow).find("input[type='checkbox']").on("click",function(){let table=pageId.find("#cardCRPendingRemainderView"),userId=$(this).closest("tr").attr("id");this.checked?(PMSOperation.crRemainderUsrList.push(userId),pageId.find("#CRReminderMultiActionDiv").hasClass("opn")||pageId.find("#CRReminderMultiActionDiv").addClass("opn"),pageId.find("#remindpokeCRallbtn").prop("disabled",!1),PMSOperation.crRemainderUsrList.length===$(table).find("#pendinglisttbody").children().length?$(table).find("#remindCRallchkbox input").prop("checked",!0):$(table).find("#remindCRallchkbox input").prop("checked",!1)):(PMSOperation.crRemainderUsrList.splice(PMSOperation.crRemainderUsrList.indexOf(userId),1),PMSOperation.crRemainderUsrList.length<$(table).find("#pendinglisttbody").children().length&&$(table).find("#remindCRallchkbox input").prop("checked",!1),0===PMSOperation.crRemainderUsrList.length&&($(table).find("#remindpokeCRallbtn").prop("disabled",!0),pageId.find("#CRReminderMultiActionDiv").hasClass("opn")&&pageId.find("#CRReminderMultiActionDiv").removeClass("opn")))})})},searchCRReminderEmployees:function(obj){paCommonUtil.validateSearch(obj,PMSOperation.REMINDER_POKE_PREV_SEARCHTEXT,PMSOperation.constructCRRemainderModal,!0)},triggerReminderCR:function(obj){let pageId=$(PMSOperation.CR_REMAINDER_MODAL.sliderDiv),params={};if("remindCRAllUsersBtn"!==$(obj).attr("id")&&("particularUser"===$(obj).attr("id")?params.pendingCRUserList=[$(obj).attr("erecNo")]:"remindpokeCRallbtn"===$(obj).attr("id")&&(params.pendingCRUserList=PMSOperation.crRemainderUsrList)),"particularUser"!==$(obj).attr("id"))switch(PMSOperation.pendingAlert=new InfoAlertMessage,PMSOperation.pendingAlert.title=ZPI18N.getString("zp.reminder.remind"),"remindCRAllUsersBtn"!==$(obj).attr("id")?PMSOperation.pendingAlert.despcription=ZPI18N.getString("zp.reminder.remindnotifidesc",new Array(params.pendingCRUserList.length+"")):PMSOperation.pendingAlert.despcription=ZPI18N.getString("zp.reminder.remindnotifidesall",new Array(pageId.find("#zp_pending_recordcount").text())),PMSOperation.pendingAlert.handleESC=!0,PMSOperation.pendingAlert.needButton=!0,PMSOperation.pendingAlert.cancelButtonText=ZPI18N.getString("zp.cancel"),"remindCRAllUsersBtn"===$(obj).attr("id")?(PMSOperation.pendingAlert.yesButtonText=ZPI18N.getString("zp.cyclestatus.remindall"),PMSOperation.pendingAlert.callback=function(obj){PMSOperation.sendCRReminder(obj,params,!0)}):(PMSOperation.pendingAlert.yesButtonText=ZPI18N.getString("zp.cyclestatus.remindselemp"),PMSOperation.pendingAlert.callback=function(obj){$(obj).prop("disabled",!0),PMSOperation.sendCRReminder(obj,params,!1)}),PMSOperation.pendingAlert.setCloseCallback=function(){PMSOperation.pendingAlert.remove(),PMSOperation.pendingAlert=null},PMSOperation.pendingAlert.show(),PMSOperation.CR_FETCH_MODE){case"0":PMSOperation.pendingAlert.alertDiv.find(".cont").append('<p class="">'+ZPI18N.getString("zp.cyclestatus.remselfnote")+"</p>");break;case"1":PMSOperation.pendingAlert.alertDiv.find(".cont").append('<p class="">'+ZPI18N.getString("zp.cyclestatus.remreviewnote")+"</p>")}else $(obj).prop("disabled",!0),PMSOperation.sendCRReminder(obj,params,!1)},sendCRReminder:(obj,paramlist,isAll)=>{let params={mode:"triggerCRReminder",fetFrmDt:PMSOperation.CR_ST_DATE,fetToDt:PMSOperation.CR_TO_DATE,type:PMSOperation.CR_FETCH_MODE,conreqcsr:csrfToken};isAll||(params.pendingCRUserList=JSON.stringify(paramlist.pendingCRUserList)),$.post("/performanceConfig.zp",params,function(resultData){if($(obj).prop("disabled",!1),"PERMISSION_DENIED"===resultData.MSG)ZPeople.Message.success(ZPI18N.getString("zp.permdeniedremaindermail"));else if("FAILURE"===resultData.MSG)ZPeople.Message.failure(ZPI18N.getString("zp.failedremaindermail"));else if("COUNT_EXCEEDED"===resultData.MSG)"TRY_AFTER_1HR"==resultData.Remindmessage?ZPeople.Message.warning(ZPI18N.getString("zp.paremindallmsg1hr")):ZPeople.Message.warning(ZPI18N.getString("zp.paremindallmsg24hr"));else if("REMINDER_SCHEDLED"==resultData.MSG)ZPeople.Message.success(ZPI18N.getString("zp.paremindallmsg"));else{null!=PMSOperation.pendingAlert&&PMSOperation.pendingAlert.close();const remindAll=$(PMSOperation.CR_REMAINDER_MODAL.sliderDiv).find("#cardCRPendingRemainderView"),remindBtn=remindAll.find("#remindpokeCRallbtn");remindAll.find("tbody input[type='checkbox']").prop("checked",!1),remindBtn.prop("disabled",!0),PMSOperation.crRemainderUsrList=[],ZPeople.Message.success(ZPI18N.getString("zp.successramindermail")),PMSOperation.removeAllIncludeUserMultiDeleteAction("CRReminder")}})},getSelfDetailsModal:function(obj,activeCR,modalHdr,mode){PMSOperation.CR_ST_DATE="true"==activeCR?$(obj).attr("fetfrm"):$(obj).parent().parent().parent().parent().attr("fetfrm"),PMSOperation.CR_FETCH_MODE=mode;var popupTab=new Tab("Score View",function(){PMSOperation.getSelfFinalCRData(mode);new FireScrollBack(PMSOperation.crSelffireScrollCallBack,$(PMSOperation.SHOW_SELFCR_MODAL.sliderDiv).find("#cardScoreView"),"crCmplList")});PMSOperation.SHOW_SELFCR_MODAL=new sliderModal(modalHdr,popupTab),PMSOperation.SHOW_SELFCR_MODAL.setCloseCallback(function(){PMSOperation.SHOW_SELFCR_MODAL.remove(),PMSOperation.CR_FS_ST_IDX=1,PMSOperation.CR_FETCH_MODE=""}),PMSOperation.SHOW_SELFCR_MODAL.construct(),$(PMSOperation.SHOW_SELFCR_MODAL.sliderDiv).find(".zpl_mfoter").html("");var _footer='<button type="button" id="zp_modal_cancelbtn" onclick="PMSOperation.closeCR(\'true\');" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.close")+"</button>";$(PMSOperation.SHOW_SELFCR_MODAL.sliderDiv).find(".zpl_mfoter").html(_footer),$(PMSOperation.SHOW_SELFCR_MODAL.sliderDiv).find("#cardScoreView").html(ZPeople.LOADING_HTML)},crSelffireScrollCallBack:function(){var params={mode:"getAssessorUsersByFreqSettAdminSelf",stDt:PMSOperation.CR_ST_DATE,iCnt:0,startIndex:PMSOperation.CR_FS_ST_IDX,reclimit:50,assessor:-1,compmode:PMSOperation.CR_FETCH_MODE};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){var pageId=$(PMSOperation.SHOW_SELFCR_MODAL.sliderDiv),cfsData=resultData.cfsData,empArr=cfsData.empArr,empDts=cfsData.empDts;if(!(void 0===empArr||empArr.length<=0)){settingsPage.fireScrollObj.crCmplList.reset();for(var avgData=cfsData.avgData,selfAvgData=avgData.selfAvg,revAvgData=avgData.assessorAvg,tableCont="",i=0;i<empArr.length;i++){var k=empArr[i],emp=empDts[k].personalDetails,selfAvgScr=void 0===selfAvgData?void 0:selfAvgData[k],revAvgScr=void 0===revAvgData?void 0:revAvgData[k];tableCont+=PMSOperation.constructCRSelfDetRow(emp,selfAvgScr,revAvgScr)}pageId.find("#cardScoreView #crDtTBody").append(tableCont),PMSOperation.CR_FS_ST_IDX=PMSOperation.CR_FS_ST_IDX+empArr.length}})},getSelfFinalCRData:function(mode){PMSOperation.CR_FS_ST_IDX=1;let isSearch=!1;var params={mode:"getAssessorUsersByFreqSettAdminSelf",stDt:PMSOperation.CR_ST_DATE,iCnt:0,startIndex:PMSOperation.CR_FS_ST_IDX,reclimit:50,assessor:-1,compmode:mode};void 0!=mode&&"all"==mode&&void 0!=PMSOperation.SHOW_SELFCR_MODAL.sliderDiv&&$(PMSOperation.SHOW_SELFCR_MODAL.sliderDiv).find(".search-cmn").hasClass("opn")&&(params.searchText=$(PMSOperation.SHOW_SELFCR_MODAL.sliderDiv).find("#CRAvgSerachEmployee").val(),isSearch=!0),ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){var pageId=$(PMSOperation.SHOW_SELFCR_MODAL.sliderDiv);if(void 0!=params.searchText&&(PMSOperation.REMINDER_POKE_PREV_SEARCHTEXT=params.searchText),void 0===resultData.MSG||"PERMISSION_DENIED"!==resultData.MSG){var cfsData=resultData.cfsData,empArr=cfsData.empArr,empDts=cfsData.empDts;if(void 0===empArr||empArr.length<=0)return isSearch?void PMSOperationCommon.setNoData(pageId.find("#CRAvgOprDiv"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null):void PMSOperationCommon.setNoData(pageId.find("#cardScoreView"),ZPI18N.getString("zp.pa.contreview.crnotcompleted"),"no_data_found",null,null,null);var avgData=cfsData.avgData,selfAvgData=avgData.selfAvg,revAvgData=avgData.assessorAvg,tableCont="";isSearch||(tableCont='<div class="zpl_btnmnu"> <div class="search-cmn"> <i class="PI_lens" title="Search"></i><input type="text" class="ztextbox" id="CRAvgSerachEmployee" placeholder="'+ZPI18N.getString("zp.searchdata")+'" onkeyup="PMSOperation.searchCRAverageEmployees(this)"> <i class="PI_cls" onclick="PMSOperation.clssearch(\'CRAppAvgEmp\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div><div class="zpl_rgt"><i class="zpl_ibg PI_lens" onclick="PMSOperation.opnsearch(\'CRAppAvgEmp\')" title="Search"></i></div></div><div id="CRAvgOprDiv">'),tableCont+='<div class="zpl_crdcnt"><div ><div><div class="zpl_tblres"><table class="zpl_tbl wd100_per"><thead><tr><th>'+ZPI18N.getString("zp.employeename")+"</th>",tableCont+="self"===mode?"<th>"+ZPI18N.getString("zp.selfoverallscore")+"</th>":"reviewer"===mode?"<th>"+ZPI18N.getString("zp.revieweroverallscore")+"</th>":"<th>"+ZPI18N.getString("zp.selfoverallscore")+"</th><th>"+ZPI18N.getString("zp.revieweroverallscore")+"</th>",tableCont+='</tr></thead><tbody id="crDtTBody">';for(var i=0;i<empArr.length;i++){var k=empArr[i],emp=empDts[k].personalDetails,selfAvgScr=void 0===selfAvgData?void 0:selfAvgData[k],revAvgScr=void 0===revAvgData?void 0:revAvgData[k];tableCont+=PMSOperation.constructCRSelfDetRow(emp,selfAvgScr,revAvgScr,mode)}tableCont+="</tbody></table></div></div></div></div></div>",isSearch?pageId.find("#CRAvgOprDiv").html(tableCont):(tableCont+="</div>",pageId.find("#cardScoreView").html(tableCont)),PMSOperation.CR_FS_ST_IDX=empArr.length+1}else PMSOperationCommon.setNoData(pageId.find("#cardScoreView"),ZPI18N.getString("zp.permissiondeniedtoaccessthispage"),"zp_nd_permission",null,null,null)})},constructCRSelfDetRow:function(emp,selfAvgScr,revAvgScr,mode){selfAvgScr=void 0===selfAvgScr?"-":"-1.0"===selfAvgScr?ZPI18N.getString("zp.na"):selfAvgScr,revAvgScr=void 0===revAvgScr?"-":"-1.0"===revAvgScr?ZPI18N.getString("zp.na"):revAvgScr;let tr='<tr><td><div class="zpl_em"><div class="zpl_emimg"><img src="'+emp.photo+'"></div><div class="zpl_emdts"><div><em>'+emp.empid+"</em><b>&nbsp;-&nbsp;"+emp.name+"</b></div></div></div></td>";return tr+="self"===mode?"<td>"+selfAvgScr+"</td>":"reviewer"===mode?"<td>"+revAvgScr+"</td>":"<td>"+selfAvgScr+"</td><td>"+revAvgScr+"</td>",tr+="</tr>"},closeCR:function(isSelf){"true"===isSelf?PMSOperation.SHOW_SELFCR_MODAL.close():PMSOperation.SHOW_CR_MODAL.close()},applicableUserView:function(){var pageId=$(PMSOperation.crManageEmpSliderObj.sliderDiv);PMSOperation.INCLUDE_EXCLUDE_USER_ARR=[],PMSOperation.APPLI_USER_START_IDX=-1,pageId.find("#cardmanageEREmployeeList").html(ZPeople.LOADING_HTML);var params={mode:"getApplicableUsersList",startIndex:PMSOperation.APPLI_USER_START_IDX};ZPeople.Request.send("/performanceConfig.zp",params,PMSOperation.constructAppliUser)},searchCRAverageEmployees:function(obj){paCommonUtil.validateSearch(obj,PMSOperation.REMINDER_POKE_PREV_SEARCHTEXT,PMSOperation.getSelfFinalCRData,"all")},constructAppliUser:function(data){var pageID=$(PMSOperation.crManageEmpSliderObj.sliderDiv);PMSOperation.CR_APPLI_USER_LIST=[];let isAllowConstr=!0,errMsg=ZPI18N.getString("zp.norecfound"),errIcon="no_data_found";if(void 0===data||0===Object.keys(data).length||void 0===data.MSG?isAllowConstr=!1:"PERMISSION_DENIED"===data.MSG?(isAllowConstr=!1,errMsg=ZPI18N.getString("zp.permissiondenied"),errIcon="zp_nd_permission",pageID.find("#sliHdrDiv .zpl_mhderrgt").remove()):("SUCCESS"!==data.MSG||"SUCCESS"===data.MSG&&data.empCnt<=0)&&(isAllowConstr=!1),isAllowConstr){pageID.find("#CRappliCountDiv").remove(),pageID.find(".zpl_mhderrgt").prepend('<span id="CRappliCountDiv"><label>'+ZPI18N.getString("zp.local.ApplicableEmployees")+"</label>&nbsp;:&nbsp;<b >"+data.empDts.empArr.length+"</b></span>");var body='<div class="zpl_btnmnu"><div class="search-cmn"> <i class="PI_lens"  title="'+ZPI18N.getString("zp.search")+'"></i>';body+='<input type="text" class="ztextbox" id="CRAppSerachEmployee" placeholder="'+ZPI18N.getString("zp.searchdata")+'" onkeyup="PMSOperation.searchCRApplicableEmployees(this,\'CRAppEmp\')"> <i class="PI_cls" onclick="PMSOperation.clssearch(\'CRAppEmp\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div>',body+='<div class="actn_ovrly" style="z-index: 6;" id="CRAppMultiActionDiv"> <div><button class="zlabel  zlabel--red  zlabel--medium" id="excludeAllBtn" onclick="PMSOperation.CR.excludeUserConfirmation(this,true);">'+ZPI18N.getString("zp.exclude")+'</button> </div> <i class="PI_cls" onclick="PMSOperation.removeAllIncludeUserMultiDeleteAction(\'CRAppEmp\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div>',body+='<div class="zpl_rgt"><i class="zpl_ibg PI_lens" onclick="PMSOperation.opnsearch(\'CRAppEmp\')" title="'+ZPI18N.getString("zp.search")+'"></i></div> </div>',body+='<div class="zpl_tblres zpl_oxa"><table class="zpl_tbl wd100_per">',body+='<thead><tr><th style="width: 5%;"> <div class="zcheckbox"><input id="excludeAllCRUser" type="checkbox" name="check" class="zcheckbox__helper" onclick="PMSOperation.excludeAllChkBox(this);"><label for="excludeAllCRUser" class="zcheckbox__label"></label></div></th>',body+="<th> </th>",body+='<th width="220"></th></tr></thead><tbody id="appliTBody">';var empDet=data.empDts,empArr=data.empDts.empArr;PMSOperation.APPLI_USER_START_IDX+=empArr.length;for(var i=0;i<empArr.length;i++){var k=empArr[i],empObj=empDet[k].personalDetails;empObj.dep=empDet[k].departmentName,empObj.desig=empDet[k].designationName,PMSOperation.CR_APPLI_USER_LIST.push(empObj),i<100&&(body+=PMSOperation.constructAppliUserRow(empObj))}body+="</tbody></table> </div>",pageID.find("#cardmanageEREmployeeList").html(body),PMSOperation.CR_APPLI_FIRESCROLL_OBJ={},PMSOperation.CR_APPLI_FIRESCROLL_OBJ=new FireScrollBack(PMSOperation.constructAppliUserFireScrollCallback,pageID.find("#cardmanageEREmployeeList"),"CRApplicableUser")}else PMSOperationCommon.setNoData(pageID.find("#cardmanageEREmployeeList"),errMsg,errIcon,null,null,null)},constructAppliUserFireScrollCallback:function(){var pageId=$(PMSOperation.crManageEmpSliderObj.sliderDiv);let resultArr=pageId.find(".search-cmn").hasClass("opn")?PMSOperation.CR_APPLI_SEARCH_USER_LIST:PMSOperation.CR_APPLI_USER_LIST,constructedLenght=pageId.find("#appliTBody tr").length,newRowCnt=0,body="";for(var i=constructedLenght;i<resultArr.length&&newRowCnt<100;i++)body+=PMSOperation.constructAppliUserRow(resultArr[i]),newRowCnt++;pageId.find("#appliTBody").append(body),constructedLenght+newRowCnt<=resultArr.length&&PMSOperation.CR_APPLI_FIRESCROLL_OBJ.reset()},searchCRApplicableEmployees:function(obj,mode){var pageId=$(PMSOperation.crManageEmpSliderObj.sliderDiv);pageId.find("#emptPage").remove(),PMSOperation.CR_APPLI_SEARCH_USER_LIST=[];var strval=$(obj).val(),arr=PMSOperation.CR_APPLI_USER_LIST;if(0==arr.length)return!1;pageId.find(".zpl_tblres").html("");let body="";if(PMSOperation.CR_APPLI_SEARCH_USER_LIST=PMSOperation.SearchComponent(arr,strval,"html"),PMSOperation.CR_APPLI_SEARCH_USER_LIST.length>0){body='<table class="zpl_tbl wd100_per">',body+='<thead><tr><th style="width: 5%;"> <div class="zcheckbox"><input id="excludeAllCRUser" type="checkbox" name="check" class="zcheckbox__helper" onclick="PMSOperation.excludeAllChkBox(this);"><label for="excludeAllCRUser" class="zcheckbox__label"></label></div></th>',body+="<th> </th>",body+='<th width="220"></th></tr></thead><tbody id="appliTBody">';for(var i=0;i<PMSOperation.CR_APPLI_SEARCH_USER_LIST.length;i++)i<100&&(body+=PMSOperation.constructAppliUserRow(PMSOperation.CR_APPLI_SEARCH_USER_LIST[i]));body+="</tbody></table>",pageId.find(".zpl_tblres").append(body)}else PMSOperationCommon.setNoData(pageId.find(".zpl_tblres"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null)},searchCRNonApplicableEmployees:function(obj){var pageId=$(PMSOperation.SHOW_CR_NOT_APPLI_MODAL.sliderDiv);pageId.find("#emptPage").remove(),PMSOperation.TEMP_CR_NOT_APPLI_LST=[],PMSOperation.CR_NON_APPLI_SEARCH_USER_LIST=[];var strval=$(obj).val(),arr=PMSOperation.CR_NON_APPLI_USER_LIST;if(0==arr.length)return!1;pageId.find(".zpl_tblres").html("");let body="";if(PMSOperation.CR_NON_APPLI_SEARCH_USER_LIST=PMSOperation.SearchComponent(arr,strval,"html"),PMSOperation.CR_NON_APPLI_SEARCH_USER_LIST.length>0){body='<table class="zpl_tbl wd100_per">',body+='<thead><tr><th width="40"><div class="zcheckbox" onclick="PMSOperation.enableDisableAll(this)" id="includeCREmployeeChkBox" ><input type="checkbox" id="includeCRAllEmployeeChkBox" name="check" class="zcheckbox__helper"><label for="includeCRAllEmployeeChkBox" class="zcheckbox__label"></label></div></th><th width="500"></th><th></th> </tr></thead>',body+='<tbody id="notAppliTBody">';for(var i=0;i<PMSOperation.CR_NON_APPLI_SEARCH_USER_LIST.length;i++)i<100&&(PMSOperation.TEMP_CR_NOT_APPLI_LST.push(PMSOperation.CR_NON_APPLI_SEARCH_USER_LIST[i].id),body+=PMSOperation.constructCRNonAppliUserRow(PMSOperation.CR_NON_APPLI_SEARCH_USER_LIST[i]));body+="</tbody></table>",pageId.find(".zpl_tblres").append(body)}else PMSOperationCommon.setNoData(pageId.find(".zpl_tblres"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null)},excludeAllChkBox:function(obj){PMSOperation.INCLUDE_EXCLUDE_USER_ARR=[];var pageID=$(PMSOperation.crManageEmpSliderObj.sliderDiv),isChecked=$(obj).is(":checked");isChecked?(pageID.find("#excludeAllBtn").removeAttr("disabled"),pageID.find("#CRAppMultiActionDiv").hasClass("opn")||pageID.find("#CRAppMultiActionDiv").addClass("opn")):(pageID.find("#excludeAllBtn").attr("disabled","disabled"),pageID.find("#CRAppMultiActionDiv").hasClass("opn")&&pageID.find("#CRAppMultiActionDiv").removeClass("opn"));var trList=pageID.find("#appliTBody").children();$.each(trList,function(k,v){var selErecNo=$(v).attr("erecno");isChecked&&PMSOperation.INCLUDE_EXCLUDE_USER_ARR.push(selErecNo),$(v).find("[type=checkbox]")[0].checked=isChecked})},singleExcludeChkBox:function(obj){var pageID=$(PMSOperation.crManageEmpSliderObj.sliderDiv);pageID.find("#excludeAllCRUser")[0].checked=!1;var isChecked=$(obj).is(":checked"),selErecNo=$(obj).parents("tr").attr("erecno");isChecked?PMSOperation.INCLUDE_EXCLUDE_USER_ARR.push(selErecNo):PMSOperation.INCLUDE_EXCLUDE_USER_ARR.splice(PMSOperation.INCLUDE_EXCLUDE_USER_ARR.indexOf(selErecNo),1);var tBody=pageID.find("#appliTBody"),recordTotal=$(tBody).children().length,checkBoxSelectedCount=$(tBody).children("tr").find("input[type=checkbox]:checked").length;0===checkBoxSelectedCount?(pageID.find("#excludeAllBtn").attr("disabled","disabled"),pageID.find("#CRAppMultiActionDiv").hasClass("opn")&&pageID.find("#CRAppMultiActionDiv").removeClass("opn")):(pageID.find("#excludeAllBtn").removeAttr("disabled"),pageID.find("#CRAppMultiActionDiv").hasClass("opn")||pageID.find("#CRAppMultiActionDiv").addClass("opn")),recordTotal===checkBoxSelectedCount&&(pageID.find("#excludeAllCRUser")[0].checked=!0)},constructAppliUserRow:function(empObj){var appliRow='<tr id="ID_'+empObj.id+'" erecno="'+empObj.id+'">';return appliRow+='<td> <div class="zcheckbox"> <input id="checlbx_'+empObj.id+'" type="checkbox" name="check" class="zcheckbox__helper" onclick="PMSOperation.singleExcludeChkBox(this);"> <label for="checlbx_'+empObj.id+'" class="zcheckbox__label"></label> </div> </td>',appliRow+="<td>",appliRow+='<div class="zpl_em">',appliRow+=' <div class="zpl_emimg" module="pms" popup="user" empid="'+empObj.zuid+'"><img src="'+empObj.photo+'"></div>',appliRow+='<div class="zpl_emdts"><div><em>'+empObj.empid+"</em><b>&nbsp;-&nbsp;"+empObj.name+"</b></div><em>"+empObj.desig+"&nbsp;-&nbsp;"+empObj.dep+"</em></div>",appliRow+="</div></td>",appliRow+='<td> <div class="zpl_hvr"> <button type="button" name="excludeCRUser" class="zlabel zlabel--red zlabel--small" onclick="PMSOperation.CR.excludeUserConfirmation(this,false);">'+ZPI18N.getString("zp.exclude")+"</button> </div> </td>",appliRow+="</tr>"},showCRManageUserList:function(){settingsPage.container;var slideObj=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv),params={mode:"previewofcrusers",conreqcsr:csrfToken};params.fetFrmDt=slideObj.find("#configId").val(),params.fetToDt=slideObj.find("#appraisalstatus").val(),void 0!=PMSOperation.appraisalstartintx&&scrollaction?params.sIndex=PMSOperation.appraisalstartintx:(params.sIndex=1,params.notselectedreviewerloaded=!1),ZPeople.Request.send("/performanceConfig.zp",params,PMSOperation.responseforpreviewofapplicableuser)},destoryRevExtComp:function(){var pageId=settingsPage.container;["apprStatus_filter","ExtendReview_Mode","configuration_sel"].forEach(id=>{ZPeopleComponents.isComponent(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+id))&&ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+id)).destroy()})},initReviewExtension:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){PMSOperation.isOprCRReviewExtension()||PMSImport.getApprConfigDetails();var pageId=settingsPage.container;if(PMSOperation.REV_EXT_FILETR_NAME=Layout.Page.currentmode.split("/")[2]+"_",PMSOperation.destoryRevExtComp(),pageId.addClass("zpl_tblfxd"),PMSOperationCommon.addClearCentreClass(!0),pageId.html(""),void 0==PMSOperation.LOAD_REV_EXT_DATA||null==PMSOperation.LOAD_REV_EXT_DATA?$.ajax({type:"POST",async:!1,url:"/performance/view/reviewExtension",data:{conreqcsr:csrfToken},success:function(resultData){PMSOperation.LOAD_REV_EXT_DATA=resultData,pageId.append(PMSOperation.LOAD_REV_EXT_DATA),PMSOperation.IS_PERF_MOD_ENABLED="true"===PMSOperation.IS_PERF_MOD_ENABLED,PMSOperation.IS_CR_REVEXT_ALLOWED="true"===PMSOperation.IS_CR_REVEXT_ALLOWED,PMSOperation.IS_APPR_REVEXT_ALLOWED="true"===PMSOperation.IS_APPR_REVEXT_ALLOWED}}):pageId.append(PMSOperation.LOAD_REV_EXT_DATA),!PMSOperation.IS_CR_REVEXT_ALLOWED&&PMSOperation.isOprCRReviewExtension()||!PMSOperation.IS_APPR_REVEXT_ALLOWED&&!PMSOperation.isOprCRReviewExtension())return PMSOperation.IS_PERF_MOD_ENABLED?PMSOperationCommon.setNoData(pageId,ZPI18N.getString("zp.permissiondenied"),"zp_nd_permission",null,null,null):PMSOperationCommon.setNoData(pageId,ZPI18N.getString("zp.tabdisabled",new Array(ZPI18N.getString("zp.performance"))),"zp_nd_permission",null,null,null),!1;pageId.find("#re_filter_search, #re_filter_reset").on("click",function(){"re_filter_search"===this.id?PMSOperation.getextendreviewrequest(!1,!0):"re_filter_reset"===this.id&&(PMSOperation.resetReviewExtension(),PMSOperation.getextendreviewrequest(!1,!0))}),PMSOperation.constructRevExtFilter(),PMSOperation.startIndex=1,PMSOperation.ExtendReviewTypeLoaded=void 0,PMSOperation.getextendreviewrequest(!1,!1)}},constructRevExtFilter:function(){const pageId=settingsPage.container;pageId.find("#configuration_sel_Div").html('<select id="'+PMSOperation.REV_EXT_FILETR_NAME+'configuration_sel" style="display: none;" data-show-search-field="true"></select>'),pageId.find("#ExtendReview_Mode_Div").html('<select id="'+PMSOperation.REV_EXT_FILETR_NAME+'ExtendReview_Mode" style="display: none;"></select>'),pageId.find("#apprStatus_filter_Div").html('<select id="'+PMSOperation.REV_EXT_FILETR_NAME+'apprStatus_filter" style="display: none;"></select>')},showHideExtensionFltr:function(isClose,breadCrumbObj){const pageId=settingsPage.container;if(void 0!==isClose?isClose?pageId.removeClass("zpl_fltr_flt"):pageId.addClass("zpl_fltr_flt"):pageId.hasClass("zpl_fltr_flt")?pageId.removeClass("zpl_fltr_flt"):pageId.addClass("zpl_fltr_flt"),void 0!==breadCrumbObj){let filterElementObj=JSON.parse($(breadCrumbObj).attr("fieldObj"));ZPeopleComponents.isComponent(pageId.find("#"+filterElementObj.filterElementId))&&("selectField"===filterElementObj.filterElementType?ZPeopleComponents.select(pageId.find("#"+filterElementObj.filterElementId)).open():"tokenField"===filterElementObj.filterElementType&&ZPeopleComponents.tokenfield(pageId.find("#"+filterElementObj.filterElementId)).openDropdownList())}},resetReviewExtension:function(){const pageId=settingsPage.container;["apprStatus_filter","ExtendReview_Mode","configuration_sel"].forEach(id=>{if(ZPeopleComponents.isComponent(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+id))){const selectElem=ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+id));selectElem.deselectAllOptions();let value="";switch(id){case"configuration_sel":value=-1;break;case"apprStatus_filter":value=-2;break;case"ExtendReview_Mode":value=1}selectElem.setValue(value)}})},removeReSelectedFilter:function(id){const pageId=settingsPage.container;if(ZPeopleComponents.isComponent(pageId.find("#"+id))){const selectElem=ZPeopleComponents.select(pageId.find("#"+id));selectElem.deselectAllOptions();let value="";switch(id){case PMSOperation.REV_EXT_FILETR_NAME+"configuration_sel":value=-1;break;case PMSOperation.REV_EXT_FILETR_NAME+"apprStatus_filter":value=-2;break;case PMSOperation.REV_EXT_FILETR_NAME+"ExtendReview_Mode":value=1;break;default:value=-1}selectElem.setValue(value)}PMSOperation.startIndex=1,PMSOperation.getextendreviewrequest(!1,!0)},onclickREBreadCrumb:function(event,obj){let filterFieldId=$(event.target).attr("id");if(void 0!==filterFieldId&&"filterTypeClose"===filterFieldId){let filterId=$(event.target).attr("filterid");"filterTypeClose"===filterFieldId&&PMSOperation.removeReSelectedFilter(filterId)}else PMSOperation.showHideExtensionFltr(!1,obj)},getextendreviewrequest:function(scroll,issearch){var pageId=settingsPage.container;if(!scroll||issearch?pageId.find("#MyapprovalList_page").html(ZPeople.LOADING_HTML):pageId.find("#MyapprovalList_page").append(ZPeople.LOADING_HTML),issearch&&(PMSOperation.startIndex=1),PMSOperation.pendingextendreview=new Array,void 0==PMSOperation.ExtendReviewTypeLoaded){PMSOperation.resetReviewExtension();var _confselObj={},_confselptions=[];if(_confselptions.push({name:ZPI18N.getString("zp.all"),id:"-1"}),!PMSOperation.isOprCRReviewExtension()){var parseObj=PMSImport.configurationData;$.each(parseObj,function(index,data){if((void 0==data.msg||null==data.msg)&&0===data.periodStatus||-2===data.periodStatus||5===data.periodStatus||4===data.periodStatus){var cycDtl={};cycDtl.id=data.configId,cycDtl.name=ZPeople.decodeTxt(data.periodName),cycDtl.type=0===data.periodStatus||4===data.periodStatus?ZPI18N.getString("zp.activecycles"):ZPI18N.getString("zp.completedcycles"),_confselptions.push(cycDtl)}})}_confselObj.options=_confselptions,_confselObj.contentType="text",_confselObj.dataMapping={label:"name",value:"id",informativeText:"name",optgroupLabel:"type"},_confselObj.dropdownList={contentType:"text",appendTo:pageId},_confselObj.search={by:["name"],highlightKeyword:!0},ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"configuration_sel"),_confselObj);var selConfWidth=$(ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"configuration_sel")).getElement()[0]).outerWidth();ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"configuration_sel")).setAttribute("dropdownList",{width:selConfWidth+"px"}),PMSOperation.isOprCRReviewExtension()?pageId.find("#configuration_sel_Div").parent().addClass("zpl_DNI"):pageId.find("#configuration_sel_Div").parent().removeClass("zpl_DNI");for(var _apprtokenObj={},_approptions=[],extentStatus=PMSOperation.REVIEW_EXTENDSTATUS,i=0;i<extentStatus.length;i++){var obj=extentStatus[i];for(var key in obj){var value=obj[key];_approptions.push({name:value,id:key})}}_apprtokenObj.options=_approptions,_apprtokenObj.contentType="text",_apprtokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},_apprtokenObj.dropdownList={appendTo:pageId},ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"apprStatus_filter"),_apprtokenObj);var apprStatusWidth=$(ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"apprStatus_filter")).getElement()[0]).outerWidth();ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"apprStatus_filter")).setAttribute("dropdownList",{width:apprStatusWidth+"px"});var _extntokenObj={},_extnoptions=[];_extnoptions.push({name:ZPI18N.getString("zp.all"),id:"1"}),_extntokenObj.options=_extnoptions,_extntokenObj.contentType="text",_extntokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},_extntokenObj.dropdownList={appendTo:pageId},ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"ExtendReview_Mode"),_extntokenObj);var extendReview_ModeWidth=$(ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"ExtendReview_Mode")).getElement()[0]).outerWidth();ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"ExtendReview_Mode")).setAttribute("dropdownList",{width:extendReview_ModeWidth+"px"})}pageId.find("#extendreview_allchk input[type='checkbox']").prop("checked",!1);PMSOperation.extendreviewrecid;var status=pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"apprStatus_filter").val(),configId="-1";void 0!=ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"configuration_sel")).getValue()&&(configId=ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"configuration_sel")).getValue());var reviewMode=1;if(reviewMode=void 0!=PMSOperation.ExtendReviewTypeLoaded&&ZPeopleComponents.isComponent(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"ExtendReview_Mode"))?ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"ExtendReview_Mode")).getValue():1,issearch){var params={status:status,reviewMode:reviewMode,configId:configId},filterObject=PMSOperation.constructSelectedREFilterHTML(params);filterObject?(pageId.addClass("zpl_fltrvwfxd"),pageId.find("#selectedfltrlst").html(filterObject),pageId.find("#reselectedfltr").removeClass("DNI"),pageId.find("#re_fltr_clearall").unbind(),pageId.find("#re_fltr_clearall").on("click",function(){PMSOperation.resetReviewExtension(),PMSOperation.getextendreviewrequest(!1,!0)}),$("[name=BreadCrumbElement]").unbind(),$("[name=BreadCrumbElement]").on("click",function(){PMSOperation.onclickREBreadCrumb(event,this)})):(pageId.removeClass("zpl_fltrvwfxd"),pageId.find("#selectedfltrlst").empty(),pageId.find("#reselectedfltr").addClass("DNI"))}else scroll||(pageId.removeClass("zpl_fltrvwfxd"),pageId.find("#selectedfltrlst").empty(),pageId.find("#reselectedfltr").addClass("DNI"));$.post("/performanceConfig.zp",{mode:"getextendreviewrequest",reclimit:PMSOperation.REVIEW_EXTENDPAGECNT,status:status,sIndex:PMSOperation.startIndex,reviewMode:reviewMode,configId:configId,submode:PMSOperation.isOprCRReviewExtension()?"CR":"Cycle",conreqcsr:csrfToken},function(resultData){if(pageId.find("#zp_page_loading").remove(),0==pageId.find("#extendmyapprovalthead").length){var _headerhtm='<table class="zpl_tbl"><thead id="extendmyapprovalthead">';_headerhtm+='<tr><th width="50"><div class="zcheckbox" id="extendreview_allchk" onclick="PMSOperation.enableDisableAll(this);">',_headerhtm+='<input  id="extendreviewallchk" type="checkbox" name="check" class="zcheckbox__helper"><label for="extendreviewallchk" class="zcheckbox__label"></label></div></th>',_headerhtm+="<th><span>"+ZPI18N.getString("zp.message")+'</span></th><th width="220"><span>'+ZPI18N.getString("zp.status")+'</span></tr></thead><tbody id="extendMyapproval"></tbody></table>',pageId.find("#MyapprovalList_page").html(" "),pageId.find("#MyapprovalList_page").append(_headerhtm)}if(issearch&&pageId.find("#extendMyapproval").html(""),PMSOperation.closeFilter(),void 0==PMSOperation.ExtendReviewTypeLoaded){PMSOperation.REVIEW_EXTENDFOR={};var addoptions=[];$.each(resultData.reviewType,function(index,type){if((index>=1&&index<=7||11==index)&&void 0!=resultData.reviewType[type]){let isCRRevExt=-1!=resultData.reviewType[type].indexOf("Continuous Review");(isCRRevExt&&PMSOperation.isOprCRReviewExtension()||!isCRRevExt&&!PMSOperation.isOprCRReviewExtension())&&(addoptions.push({name:ZPeople.decodeTxt(resultData.reviewType[type]),id:type}),PMSOperation.REVIEW_EXTENDFOR[type]=ZPeople.decodeTxt(resultData.reviewType[type]))}}),addoptions.length>0&&ZPeopleComponents.select(pageId.find("#"+PMSOperation.REV_EXT_FILETR_NAME+"ExtendReview_Mode")).addOption(addoptions),PMSOperation.ExtendReviewTypeLoaded=!0}if(null!=resultData.resultarr&&void 0!=resultData.resultarr&&resultData.resultarr.length>0){var isallcheck=!1;if($.each(resultData.resultarr,function(i,data){var onclickevent="";onclickevent="1"===data.approvalstatus||"0"===data.approvalstatus?"onclick=\"PMSOperation.viewextendReview('"+data.recid+"');\"":"onclick=\"PMSOperation.approveextendReview('"+data.recid+"');\"";var row="<tr id="+data.recid+' approvalstatus="'+data.approvalstatus+'">';row+='<td> <div class="zcheckbox"> <input id="'+data.recid+'_checkbox" type="checkbox" name="check" class="zcheckbox__helper" onclick="PMSOperation.enableExtnSinglecheck(this)"> <label for="'+data.recid+'_checkbox" class="zcheckbox__label"></label> </div> </td>';var empdata=resultData.emplist["Emp_"+data.owner];11==data.type?(row+="<td "+onclickevent+'><div class="zpl_em">',row+='<div class="zpl_emimg" module="pms" popup="user" empid="'+empdata.zuid+'"><img src="'+empdata.photo+'"></div>',row+='<div class="zpl_emdts">',row+="<div><em>"+empdata.empId+" - </em><b>"+empdata.name+"</b></div>",row+="<span>"+ZPI18N.getString("zp.pa.reviewextn.extendreviewlistingmsg",new Array(PMSSetting.GOAL_DISPLAY_NAME))+"</span></div></div></td>"):(row+="<td "+onclickevent+'><div class="zpl_em">',row+='<div class="zpl_emimg" module="pms" popup="user" empid="'+empdata.zuid+'"><img src="'+empdata.photo+'"></div>',row+='<div class="zpl_emdts">',row+="<div><em>"+empdata.empId+" - </em><b>"+empdata.name+"</b></div>",row+="<span>"+ZPI18N.getString("zp.pa.reviewextn.extendreviewlistingmsg",new Array(data.mode))+"</span></div></div></td>");empdata=resultData.emplist["Emp_"+data.owner];if(data.name=empdata.name,data.empId=empdata.empId,"null"!==data.approvedby&&(empdata=resultData.emplist["Emp_"+data.approvedby],data.apprname=empdata.name,data.apprempId=empdata.empId),"3"!==data.type&&"6"!==data.type&&"8"!==data.type||(empdata=resultData.emplist["Emp_"+data.emp],data.appraiseename=empdata.name,data.appraiseeempId=empdata.empId),"1"===data.approvalstatus)row+="<td><span>"+ZPI18N.getString("zp.extended")+"</span> </td>";else if("0"===data.approvalstatus)row+="<td><span>"+ZPI18N.getString("zp.declined")+"</span> </td>";else{var status='<td><button name="extenddeclinebtn" id="extendbtn">'+ZPI18N.getString("zp.extenddecline")+"</button></td>";pageId.find('#extend_chkall  input[type="checkbox"]').attr("disabled",!1),isallcheck=!0,row+=status}row+="</tr>",pageId.find("#extendMyapproval").append(row),ZPeopleComponents.button(pageId.find("#"+data.recid+" [name=extenddeclinebtn]"),{click:function(data){var recid=$(data.target[0]).closest("tr").attr("id");PMSOperation.approveextendReview(recid)}}),"1"!==data.approvalstatus&&"0"!==data.approvalstatus||pageId.find("#"+data.recid+' input[type="checkbox"]').attr("disabled",!0),$("#"+data.recid).data(data.recid,data),$("#"+data.recid).data(data.recid+"1",resultData.offset),PMSOperation.extendreviewrecid=data.recid}),!1===isallcheck?pageId.find("#extend_chkall").attr("disabled",!0):pageId.find("#extend_chkall").attr("disabled",!1),resultData.resultarr.length<100&&settingsPage.fireScrollObj.hasOwnProperty("extendreview"))settingsPage.fireScrollObj.extendreview.reset();else new FireScrollBack(PMSOperation.getNextExtendreviewSet,pageId,"extendreview")}else if(void 0!=scroll&&0==pageId.find("#extendMyapproval tr").length||void 0!=scroll&&issearch){let breadCrumbLen=pageId.find("#selectedfltrlst").children().length,noDataMsg=ZPI18N.getString("zp.noreqreceived");parseInt(breadCrumbLen)>0&&(noDataMsg=ZPI18N.getString("zp.searchnodata",new Array(ZPI18N.getString("zp.extendreview")))),PMSOperationCommon.setNoData(pageId.find("#MyapprovalList_page"),noDataMsg,"no_data_found",null,null,null)}pageId.find("#zp_page_loading").remove()})},constructSelectedREFilter:function(obj){const{configId:configId,reviewMode:reviewMode,status:status}=obj;let cycleNames=[],statusNames=[],reviewExtendFor=[];const configurationData=PMSImport.configurationData;if("-1"!=configId)for(let i=0;i<configurationData.length;i++)if(configurationData[i].configId===configId){cycleNames.push(configurationData[i].periodName);break}const extentStatus=PMSOperation.REVIEW_EXTENDSTATUS;if("-2"!=status)for(let j=0;i<extentStatus.length;j++){let isBreak=!1,obj=extentStatus[j];for(let key in obj){let value=obj[key];if(key==parseInt(status)){statusNames.push(value),isBreak=!0;break}}if(isBreak)break}const reviewExtendArr=PMSOperation.REVIEW_EXTENDFOR;if(void 0!=reviewExtendArr||"1"!=reviewExtendFor)for(const key in reviewExtendArr)if(key===reviewMode){reviewExtendFor.push(reviewExtendArr[key]);break}return{cycleNames:cycleNames,statusNames:statusNames,reviewExtendFor:reviewExtendFor}},constructSelectedREFilterHTML:function(params){const selectedREFilter=PMSOperation.constructSelectedREFilter(params);let html="";const constructFilter=(filterType,headerName,filterElement,filterElementType)=>{const filterValues=selectedREFilter[filterType];if(filterValues.length>0){let subHtml="",filterValue=filterValues[0];"reviewExtendFor"===filterType&&(filterValue=ZPeople.escapeHtml(filterValues[0])),html+='<li name="BreadCrumbElement" fieldObj=\''+JSON.stringify({filterElementId:filterElement,filterElementType:filterElementType})+"'><label>"+headerName+':</label><span title="'+filterValue+'">'+filterValue+"</span>"+subHtml+'<a class="PI_cls" id="filterTypeClose" filterId="'+filterElement+'" title="'+ZPI18N.getString("zp.remove")+'"></a></li>'}};return constructFilter("cycleNames",ZPI18N.getString("zp.appraisalcycle"),PMSOperation.REV_EXT_FILETR_NAME+"configuration_sel","selectField"),constructFilter("reviewExtendFor",ZPI18N.getString("zp.extendreviewfor",new Array("")),PMSOperation.REV_EXT_FILETR_NAME+"ExtendReview_Mode","selectField"),constructFilter("statusNames",ZPI18N.getString("zp.status"),PMSOperation.REV_EXT_FILETR_NAME+"apprStatus_filter","selectField"),html},getNextExtendreviewSet:function(){PMSOperation.startIndex=PMSOperation.startIndex+Number(PMSOperation.REVIEW_EXTENDPAGECNT),PMSOperation.getextendreviewrequest(!0)},approveextendReview:function(recid){var data=$("#"+recid).data(recid),data1=$("#"+recid).data(recid+"1"),sliderTab=new Tab("ReviewExtension",function(slidedata){var _htm='<div class="zpl_crd"><div class="zpl_crdcnt">';11==data.type?_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.reviewtype"),PMSSetting.GOAL_DISPLAY_NAME,!0):_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.reviewtype"),data.mode,!0),"6"==data.type||"5"==data.type||"10"==data.type?_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.revperiod"),data.cfsFromDate+" - "+data.cfsEndDate,!0):"11"!=data.type&&(_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.appraisalcycle"),data.periodname,!0)),_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.local.Appraiser"),data.empId+" "+data.name,!0),"3"!==data.type&&"6"!==data.type&&"8"!==data.type||(_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.appraisee"),data.appraiseeempId+" "+data.appraiseename,!0)),_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.reason"),data.desc,!0),_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.fromtodate"),PMSOperation.showtimeExtendreview(data1),!0),_htm+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.local.NoOfDays")+'</label></div><div><input class="ztextbox" name="noofdays" id="noofdays" min="1" max="9"  maxlength="1" pattern="[1-9]" data-validation="numeric" value="'+data.noofdays+'" onkeydown="return PMSOperation.numberFieldValidation(this,event);" onchange="PMSOperation.changeDateInRequest('+data1+');" oninput="PMSOperation.validateNumberInput(this)"></div></div>',_htm+='<div class="zpl_secn"> <div> <label>'+ZPI18N.getString("zp.comment")+'</label> </div> <div> <textarea class="ztextbox" rows="3" name="description" id="extendreview_comment"></textarea> </div> </div>',_htm+="</div></div>",$(slidedata.sliderDiv).find("#cardReviewExtension").html(_htm),$(slidedata.sliderDiv).find("#cardReviewExtension #noofdays").parent().parent().find("label").addClass("zpl_mtry")},function(){});PMSOperation.extendsliderModalObj=new sliderModal(ZPI18N.getString("zp.extendreview"),sliderTab),PMSOperation.extendsliderModalObj.setCloseCallback(function(){PMSOperation.extendsliderModalObj.remove(),PMSOperation.extendsliderModalObj={}}),PMSOperation.extendsliderModalObj.construct(),$(PMSOperation.extendsliderModalObj.sliderDiv).find(".zpl_mfoter").html("");var _footer='<button type="button" id="add_extendreview" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.accept")+"</button>";_footer+='<button type="button" id="reject_extendreview" class="zlabel zlabel--red zlabel--medium">'+ZPI18N.getString("zp.workflow.decline")+"</button>",_footer+='<button type="button" id="zp_modal_cancelbtn" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.close")+"</button>",$(PMSOperation.extendsliderModalObj.sliderDiv).find(".zpl_mfoter").append($(_footer)),$(PMSOperation.extendsliderModalObj.sliderDiv).find("#add_extendreview").attr("onclick","PMSOperation.rejectextendReview('"+recid+"','1');"),$(PMSOperation.extendsliderModalObj.sliderDiv).find("#reject_extendreview").attr("onclick","PMSOperation.rejectextendReview('"+recid+"','0');"),$(PMSOperation.extendsliderModalObj.sliderDiv).find("#zp_modal_cancelbtn").attr("onclick","PMSOperation.closeExtnReview('extendsliderModalObj');")},validateNumberInput:function(input){/^[1-9]$/.test(input.value)||(input.value="")},numberFieldValidation:function(obj,event){var pageId,massExtendReviewObj=PMSOperation.massExtendReviewObj,extendsliderModalObj=PMSOperation.extendsliderModalObj;pageId=void 0!=massExtendReviewObj&&Object.keys(massExtendReviewObj).length>0?$(massExtendReviewObj.sliderDiv):$(extendsliderModalObj.sliderDiv);var charKey=event.which?event.which:event.KeyCode,valNoofdays=parseInt(event.key);return $(pageId).find("#noofdays").removeClass("ztextbox__error"),$(pageId).find("#noofdays").parent().find("#error_message").remove(),8===charKey||9===charKey||37===charKey||39===charKey||13!==charKey&&((charKey<48||charKey>57&&charKey<96||charKey>105||!(event.key>="0"&&event.key<="9"))&&void 0!=charKey?($(pageId).find("#noofdays").addClass("ztextbox__error"),$(pageId).find("#noofdays").parent().append('<span class="ztextbox--error__label" id="error_message">'+ZPI18N.getString("zp.errornofordays")+"</span>"),!1):!(void 0!=valNoofdays&&valNoofdays.length>=1&&"0"!=valNoofdays)||($(pageId).find("#noofdays").addClass("ztextbox__error"),$(pageId).find("#noofdays").parent().append('<span class="ztextbox--error__label" id="error_message">'+ZPI18N.getString("zp.errornofordays")+"</span>"),!1))},changeDateInRequest:function(offset){var pageid=$(PMSOperation.extendsliderModalObj.sliderDiv),data={noofdays:pageid.find("#noofdays").val()};pageid.find("#noofdaysrequested").val(PMSOperation.showtimeExtendreview(offset,data))},viewextendReview:function(recid){var data=$("#"+recid).data(recid),sliderTab=new Tab("ReviewExtension",function(slidedata){var _htm='<div class="zpl_crd"><div class="zpl_crdcnt">';11==data.type?_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.reviewtype"),PMSSetting.GOAL_DISPLAY_NAME,!0,!1):_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.reviewtype"),data.mode,!0,!1),"6"==data.type||"5"==data.type?_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.revperiod"),data.cfsFromDate+" - "+data.cfsEndDate,!0,!1):"11"!=data.type&&(_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.appraisalcycle"),data.periodname,!0,!1)),_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.local.Appraiser"),data.empId+" "+data.name,!0),"3"!==data.type&&"6"!==data.type&&"8"!==data.type||(_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.appraisee"),data.appraiseeempId+" "+data.appraiseename,!0,!1)),_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.reason"),data.desc,!0,!0),_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.local.NoOfDays"),data.noofdays,!0,!1),"1"===data.approvalstatus&&(_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.fromtodate"),data.daydis,!0,!1)),"-1"!==data.approvalstatus?("null"!=data.apprcomment?_htm+='<div class="zpl_secn"> <div> <label class="disabled">'+ZPI18N.getString("zp.comment")+'</label> </div> <div> <textarea class="ztextbox" rows="3" name="description" id="extendreview_comment" disabled>'+data.apprcomment+"</textarea> </div> </div>":_htm+='<div class="zpl_secn"> <div> <label class="disabled">'+ZPI18N.getString("zp.comment")+'</label> </div> <div> <textarea class="ztextbox" rows="3" name="description" id="extendreview_comment" disabled>-</textarea> </div> </div>',"0"===data.approvalstatus?_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.declined")+" "+ZPI18N.getString("zp.by"),data.apprempId+" "+data.apprname,!0,!1):"1"===data.approvalstatus&&(_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.extended")+" "+ZPI18N.getString("zp.by"),data.apprempId+" "+data.apprname,!0,!1))):_htm+=PMSOperation.constructExtendReviewViewMode(ZPI18N.getString("zp.status"),ZPI18N.getString("zp.pending"),!1),_htm+="</div></div>",$(slidedata.sliderDiv).find("#cardReviewExtension").html(_htm)});PMSOperation.extendviewsliderModalObj=new sliderModal(ZPI18N.getString("zp.extendreview"),sliderTab),PMSOperation.extendviewsliderModalObj.construct(),$(PMSOperation.extendviewsliderModalObj.sliderDiv).find(".zpl_mfoter").html("");var _footer='<button type="button" id="zp_modal_cancelbtn" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.close")+"</button>";$(PMSOperation.extendviewsliderModalObj.sliderDiv).find(".zpl_mfoter").append($(_footer)),$(PMSOperation.extendviewsliderModalObj.sliderDiv).find("#zp_modal_cancelbtn").attr("onclick","PMSOperation.closeExtnReview('extendviewsliderModalObj');")},constructExtendReviewViewMode:function(mode,text,isView,isComment){const inputType=isComment?"textarea":"input";return`<div class="zpl_secn"><div><label class="${isView?"disabled":""}">${mode}</label></div><div><${inputType} ${isView?'class="ztextbox disabled"':'class="ztextbox"'} ${isComment?`rows="3" name="description" placeholder="${text}"`:`placeholder="${text}" value="${text}"`} ${isView?"disabled":""}>${isComment?text:""}</${inputType}></div></div>`},showtimeExtendreview:function(offset){var d=new Date,utc=d.getTime()+6e4*d.getTimezoneOffset(),nd=new Date(utc+offset),fromduedate=Calendar.formatDate(nd);return utc+=864e5,nd=new Date(utc+offset),fromduedate+" - "+Calendar.formatDate(nd)},rejectextendReview:function(recid,status){let comment,noofday;const extendReviewObj=PMSOperation.extendsliderModalObj,massExtendReviewObj=PMSOperation.massExtendReviewObj;let pageId;pageId=void 0!=extendReviewObj&&Object.keys(extendReviewObj).length>0?$(extendReviewObj.sliderDiv):$(massExtendReviewObj.sliderDiv),void 0!==recid&&""!=recid?(PMSOperation.pendingextendreview=[recid],comment=$(pageId).find("#extendreview_comment").val(),noofday=$(pageId).find("#noofdays").val()):(comment=$(pageId).find("#bulkextendreview_comment").val(),noofday=$(pageId).find("#noofdays").val());let param={mode:"approveRejectextendreview",status:status,recid:JSON.stringify(PMSOperation.pendingextendreview),comment:comment,conreqcsr:csrfToken};if($(pageId).find("#noofdays").removeClass("ztextbox__error"),$(pageId).find("#noofdays").parent().find("#error_message").remove(),""===noofday||parseInt(noofday)>9||0===parseInt(noofday))return $(pageId).find("#noofdays").addClass("ztextbox__error"),void $(pageId).find("#noofdays").parent().append('<span class="ztextbox--error__label" id="error_message">'+ZPI18N.getString("zp.errornofordays")+"</span>");param.noofdays=parseInt(noofday),$.post("/performanceConfig.zp",param,function(resultData){void 0!=resultData.success&&resultData.success?(1===parseInt(status)?ZPeople.Message.success(ZPI18N.getString("zp.extendreviewsuccmsg")):ZPeople.Message.success(ZPI18N.getString("zp.extendreviewrejmsg")),void 0!==recid&&""!=recid?PMSOperation.extendsliderModalObj.close():(PMSOperation.massExtendReviewObj.close(),pageId.find("#extendreview_acceptbutton").parent().parent().removeClass("opn")),PMSOperation.closeExtnAcceptbutton(),PMSOperation.getextendreviewrequest(!1,!0)):ZPeople.Message.warning(ZPI18N.getString("zp.permdenied"))})},enableExtnSinglecheck:function(obj,mode){var tempArr=new Array,pageId=settingsPage.container;if($(obj).is(":checked")){objval=(objval=(objval=$(obj).attr("id")).split("_checkbox"))[0],PMSOperation.pendingextendreview.push(objval),pageId.find("#"+objval+' input[type="checkbox"]').prop("checked",!0),pageId.find("#extendreview_acceptbutton").parent().parent().addClass("opn")}else{var objval;objval=(objval=(objval=$(obj).attr("id")).split("_checkbox"))[0];for(var i=0;i<PMSOperation.pendingextendreview.length;i++)PMSOperation.pendingextendreview[i]!==objval&&tempArr.push(PMSOperation.pendingextendreview[i]);PMSOperation.pendingextendreview=tempArr,0===tempArr.length&&pageId.find("#extendreview_acceptbutton").parent().parent().removeClass("opn")}},closeExtnAcceptbutton:function(){var pageId=settingsPage.container;pageId.find('#extendMyapproval  input[type="checkbox"], #extendmyapprovalthead input[type="checkbox"]').prop("checked",!1),pageId.find("#extendreview_acceptbutton").parent().parent().removeClass("opn")},massextendreview:function(obj,status){var sliderTab=new Tab("massextendreview",function(popupdata){var _htm='<form><div class="zpl_crd"><div class="zpl_crdcnt">';_htm+='<div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.local.NoOfDays")+"</label></div>",_htm+='<div><input type="text" name="noofdays" id="noofdays" min="1" max="9"  maxlength="1" pattern="[1-9]" data-validation="numeric" class="ztextbox" onkeydown="return PMSOperation.numberFieldValidation(this,event);" oninput="PMSOperation.validateNumberInput(this)"></div></div>',_htm+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.description")+"</label></div>",_htm+='<div><textarea class="ztextbox" id="bulkextendreview_comment" placeholder="Your Comments.." rows="4"></textarea></div></div>',_htm+="</div></div></form>",$(popupdata.sliderDiv).find("#cardmassextendreview").html(_htm)});PMSOperation.massExtendReviewObj=new popupModal(ZPI18N.getString("zp.extendreview"),sliderTab),PMSOperation.massExtendReviewObj.setCloseCallback(function(){PMSOperation.massExtendReviewObj.remove(),PMSOperation.massExtendReviewObj={}}),PMSOperation.massExtendReviewObj.construct(),$(PMSOperation.massExtendReviewObj.sliderDiv).find(".zpl_mfoter").html("");var _footer='<button type="button" id="zp_modal_blubtn" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.accept")+"</button>";_footer+='<button type="button" id="zp_modal_redbtn" class="zlabel zlabel--red zlabel--medium">'+ZPI18N.getString("zp.workflow.decline")+"</button>",_footer+='<button type="button" id="zp_modal_cancelbtn" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.close")+"</button>",$(PMSOperation.massExtendReviewObj.sliderDiv).find(".zpl_mfoter").append($(_footer)),$(PMSOperation.massExtendReviewObj.sliderDiv).find("#zp_modal_blubtn").attr("onclick","PMSOperation.rejectextendReview('','1');"),$(PMSOperation.massExtendReviewObj.sliderDiv).find("#zp_modal_redbtn").attr("onclick","PMSOperation.rejectextendReview('','0');"),$(PMSOperation.massExtendReviewObj.sliderDiv).find("#zp_modal_cancelbtn").attr("onclick","PMSOperation.closeExtnReview('massExtendReviewObj');")},closeFilter:function(obj){settingsPage.container.removeClass("zpl_fltr_flt")},closeExtnReview:function(mode){"extendviewsliderModalObj"==mode?PMSOperation.extendviewsliderModalObj.close():"extendsliderModalObj"==mode?PMSOperation.extendsliderModalObj.close():"massExtendReviewObj"==mode&&PMSOperation.massExtendReviewObj.close()},initCycleDelete:function(scroll){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){const pageId=settingsPage.container;pageId.addClass("zpl_tblfxd");const loadingHtml=ZPeople.LOADING_HTML,messageString=ZPI18N.getString("zp.message"),statusString=ZPI18N.getString("zp.status");1==PMSOperation.cycleDelStartIndex&&pageId.html(loadingHtml).show(),$.post("/performanceConfig.zp",{mode:"getAppraisalCycleDeleteRequest",reclimit:PMSOperation.REVIEW_EXTENDPAGECNT,sIndex:PMSOperation.cycleDelStartIndex,conreqcsr:csrfToken},function(resultData){if(pageId.find("#zp_page_loading").remove(),null!=resultData.requestList&&void 0!=resultData.requestList&&resultData.requestList.length>0){if(1==PMSOperation.cycleDelStartIndex){let htmlString='<div class="zpl_btnmnu"><div class="zpl_rgt"></div></div>';htmlString+='<div class="zpl_rgtcnt"> <div class="zpl_tblres"><table class="zpl_tbl"><thead id="appraisalCycleDeletemyapprovalthead">',htmlString+=`<tr><th width="70%"><span>${messageString}</span></th><th width="30%"><span>${statusString}</span></th></tr></thead>`,htmlString+='<tbody id="appraisalCycleDeleteMyapproval"></tbody></table></div></div>',pageId.html(htmlString)}resultData.requestList.forEach(data=>{let onclickevent="onclick=\"PMSOperation.approveRejectCycleDeleteRequest('"+data.recid+"');\"";"1"!==data.approvalstatus&&"0"!==data.approvalstatus||(onclickevent="onclick=\"PMSOperation.viewCycleDeleteRequest('"+data.recid+"');\"");let row=`<tr id=${data.recid} status=${data.approvalstatus}>`;const empdata=resultData.emplist[`Emp_${data.owner}`];let apprName="";if("null"!==data.approvedby||void 0===data.approvedby){const apprempdata=resultData.emplist[`Emp_${data.approvedby}`];void 0!==apprempdata&&(data.apprname=apprempdata.name,data.apprempId=apprempdata.empId,apprName=`${data.apprempId} ${data.apprname}`)}let status="";status="1"===data.approvalstatus?`<span>${ZPI18N.getString("zp.performance.approvedby",[apprName])}</span>`:"0"===data.approvalstatus?`<span>${ZPI18N.getString("zp.performance.rejectedby",[apprName])}</span>`:`<button name="extenddeclinebtn" id="extendbtn">${ZPI18N.getString("zp.performance.approvedecline")}</button>`,row+="<td "+onclickevent+">",row+='<div class="zpl_em">',row+=`<div class="zpl_emimg" module="pms" popup="user"  empid="${empdata.zuid}">`,row+=`<img src="${empdata.photo}"></div>`,row+='<div class="zpl_emdts">',row+=`<div><em>${empdata.empId} - </em><b>${empdata.name}</b></div><span>${ZPI18N.getString("zp.performance.cycledeletionmsg",[data.periodname])}</span></div>`,row+="</div></td>",row+=`<td>${status}</td></tr>`,data.name=empdata.name,data.empId=empdata.empId,void 0!==resultData.reviewstartedCycle&&data.configid&&-1!==resultData.reviewstartedCycle.indexOf(data.configid)?data.showdeletewarningmsg=!0:data.showdeletewarningmsg=!1,pageId.find("#appraisalCycleDeleteMyapproval").append(row),$(`#${data.recid}`).data(data.recid,data),ZPeopleComponents.button(pageId.find(`#${data.recid} [name=extenddeclinebtn]`),{click:function(data){const recid=$(data.target[0]).closest("tr").attr("id");PMSOperation.approveRejectCycleDeleteRequest(recid)}})});new FireScrollBack(PMSOperation.getNextappraisalCycleDeleteSet,pageId,"cycledelete")}else void 0==scroll&&0==pageId.find("#appraisalCycleDeleteMyapproval tr").length&&PMSOperationCommon.setNoData(pageId,ZPI18N.getString("zp.noreqreceived"),"no_data_found",null,null,null)})}},getNextappraisalCycleDeleteSet:function(){PMSOperation.cycleDelStartIndex=PMSOperation.cycleDelStartIndex+Number(PMSOperation.REVIEW_EXTENDPAGECNT),PMSOperation.initCycleDelete(!1)},approveRejectCycleDeleteRequest:function(recid){const data=$(`#${recid}`).data(recid),constructExtendReviewViewMode=PMSOperation.constructExtendReviewViewMode,sliderTab=new Tab("appraisalCycleDelete",slidedata=>{let _htm='<div class="zpl_crd"><div class="zpl_crdcnt">';void 0!=data&&void 0!=data.showdeletewarningmsg&&data.showdeletewarningmsg&&(_htm+='<div class="zpl_secn"><div class="zpl_info"><div><em id="excludeMessage">'+ZPI18N.getString("zp.performance.cycledeletewarningmsg")+"</em></div></div></div>"),_htm+=constructExtendReviewViewMode(ZPI18N.getString("zp.appraisalcycle"),data.periodname,!0,!1),_htm+=constructExtendReviewViewMode(ZPI18N.getString("zp.requestedby"),`${data.empId} ${data.name}`,!0,!1),_htm+=constructExtendReviewViewMode(ZPI18N.getString("zp.performance.deletereason"),data.desc,!0,!0),void 0!==data.createtime&&(_htm+=constructExtendReviewViewMode(ZPI18N.getString("zp.requestedon"),data.createtime,!0,!1)),_htm+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.comment")+'</label></div><div><textarea class="ztextbox" rows="3" name="description" id="cycleDeleteRequest_comment"></textarea></div></div>',_htm+="</div></div>",$(slidedata.sliderDiv).find("#cardappraisalCycleDelete").html(_htm)});PMSOperation.extendsliderModalObj=new sliderModal(ZPI18N.getString("zp.performance.cycledeleteapproversubject"),sliderTab),PMSOperation.extendsliderModalObj.setCloseCallback(function(){PMSOperation.extendsliderModalObj.remove(),PMSOperation.extendsliderModalObj={}}),PMSOperation.extendsliderModalObj.construct(),$(PMSOperation.extendsliderModalObj.sliderDiv).find(".zpl_mfoter").html("");let _footer=`<button type="button" id="add_extendreview" class="zlabel zlabel--blue zlabel--medium">${ZPI18N.getString("zp.accept")}</button> `;_footer+=`<button type="button" id="reject_extendreview" class="zlabel zlabel--red zlabel--medium">${ZPI18N.getString("zp.workflow.decline")}</button> `,_footer+=`<button type="button" id="zp_modal_cancelbtn" class="zlabel zlabel--outline zlabel--medium">${ZPI18N.getString("zp.close")}</button> `,$(PMSOperation.extendsliderModalObj.sliderDiv).find(".zpl_mfoter").append($(_footer)),$(PMSOperation.extendsliderModalObj.sliderDiv).find("#add_extendreview").attr("onclick",`PMSOperation.cycleDeleterejectCycleDeleterequest('${recid}', '1');`),$(PMSOperation.extendsliderModalObj.sliderDiv).find("#reject_extendreview").attr("onclick",`PMSOperation.cycleDeleterejectCycleDeleterequest('${recid}', '0');`),$(PMSOperation.extendsliderModalObj.sliderDiv).find("#zp_modal_cancelbtn").attr("onclick","PMSOperation.closeExtnReview('extendsliderModalObj');")},viewCycleDeleteRequest:function(recid){const data=$("#"+recid).data(recid),constructExtendReviewViewMode=PMSOperation.constructExtendReviewViewMode,sliderTab=new Tab("viewAppraisalCycleDelete",function(slidedata){let _htm='<div class="zpl_crd"><div class="zpl_crdcnt">'+constructExtendReviewViewMode(ZPI18N.getString("zp.appraisalcycle"),data.periodname,!0,!1)+constructExtendReviewViewMode(ZPI18N.getString("zp.requestedby"),data.empId+" "+data.name,!0,!1)+constructExtendReviewViewMode(ZPI18N.getString("zp.performance.deletereason"),data.desc,!0,!0);void 0!==data.createtime&&(_htm+=constructExtendReviewViewMode(ZPI18N.getString("zp.requestedon"),data.createtime,!0,!1)),void 0!==data.approvalstatus&&("1"==data.approvalstatus?(_htm+=constructExtendReviewViewMode(ZPI18N.getString("zp.status"),ZPI18N.getString("zp.deleted"),!0,!1)+constructExtendReviewViewMode(ZPI18N.getString("zp.performance.approvedby",new Array("")),data.apprempId+" "+data.apprname,!0,!1),void 0!==data.modifiedtime&&(_htm+=constructExtendReviewViewMode(ZPI18N.getString("zp.performance.approvedon"),data.modifiedtime,!0,!1))):"0"==data.approvalstatus&&(_htm+=constructExtendReviewViewMode(ZPI18N.getString("zp.status"),ZPI18N.getString("zp.rejected"),!0,!1)+constructExtendReviewViewMode(ZPI18N.getString("zp.performance.rejectedby",new Array("")),data.apprempId+" "+data.apprname,!0,!1)));const apprcomment=void 0!==data.apprcomment?data.apprcomment:"";_htm+=constructExtendReviewViewMode(ZPI18N.getString("zp.comment"),apprcomment,!0,!0)+"</div></div>",$(slidedata.sliderDiv).find("#cardviewAppraisalCycleDelete").html(_htm)}),extendviewsliderModalObj=PMSOperation.extendviewsliderModalObj=new sliderModal(ZPI18N.getString("zp.performance.cycledeleteapproversubject"),sliderTab);extendviewsliderModalObj.construct(),$(extendviewsliderModalObj.sliderDiv).find(".zpl_mfoter").html("");const _footer='<button type="button" id="zp_modal_cancelbtn" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.close")+"</button>";$(extendviewsliderModalObj.sliderDiv).find(".zpl_mfoter").append($(_footer)),$(extendviewsliderModalObj.sliderDiv).find("#zp_modal_cancelbtn").attr("onclick","PMSOperation.closeExtnReview('extendviewsliderModalObj');")},cycleDeleterejectCycleDeleterequest:function(recId,status){const comment=$(PMSOperation.extendsliderModalObj.sliderDiv).find("#cycleDeleteRequest_comment").val(),param={mode:"approveRejectCycleDeleteRequest",status:status,recid:recId,comment:comment,conreqcsr:csrfToken};$.post("/performanceConfig.zp",param,resultData=>{void 0!=resultData.msg&&"success"===resultData.msg?1===parseInt(status)?ZPeople.Message.success(ZPI18N.getString("zp.performance.cycledeletedsuccess")):ZPeople.Message.success(ZPI18N.getString("zp.performance.cycledeleterequestrejected")):ZPeople.Message.warning(ZPI18N.getString("zp.permdenied")),PMSOperation.extendsliderModalObj.close(),PMSOperation.cycleDelStartIndex=1,PMSOperation.initCycleDelete(!1)})},getUpdatedStatusCountForCycle:function(configId){var params={mode:"getAppraisalUserStatusCount",conreqcsr:csrfToken};params.configId=configId,$.post("/performanceConfig.zp",params,function(resultData){for(let itr=0;itr<PMSOperation.temp.length;itr++){let obj=PMSOperation.temp[itr];if(void 0!=obj&&Object.keys(obj).length>0&&void 0!=obj.configId&&obj.configId==configId&&void 0!=obj.appraiseeCnt&&void 0!=resultData.appraiseeCnt){obj.appraiseeCnt=resultData.appraiseeCnt;break}}settingsPage.container.find("#AppraiseeCount_"+configId).text(resultData.appraiseeCnt);var id="progressImg_"+configId;settingsPage.container.find("#"+id).attr("data-value",resultData.completedPercent),settingsPage.container.find("#"+id).length>0&&(ZPeopleComponents.progresswheel(settingsPage.container.find("#"+id)).destroy(),ZPeopleComponents.progresswheel("#"+id,{statusMessage:{text:settingsPage.container.find("#"+id).attr("data-value")+"%",position:"center"}}))})},intiateMultiraterSelection:function(){PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)&&(settingsPage.container.hasClass("zpl_tblfxd")||settingsPage.container.addClass("zpl_tblfxd"),0==settingsPage.container.find("#pa_multirater_reviewers_page").length&&$.ajax({type:"POST",async:!1,url:"/performance/view/multiraterOperation",data:{conreqcsr:csrfToken},success:function(resultData){settingsPage.container.html(resultData)}}),settingsPage.container.find("#pa_multirater_reviewers_page .zpl_fltr").css("bottom","60px"),MR.ApprSelection.initApprSelection())},showCRReviewerViewOnload:function(){window.location.href="#operations/performance/crs/oprreview-reviewerview"},showCRReviewerView:function(){let pageId=Layout.Page.container;pageId.hasClass("zpl_tblfxd")||pageId.addClass("zpl_tblfxd"),pageId.find("#reviewerPageMainDiv").html(""),pageId.find("#reviewerPageMainDiv").append(PMSOperation.continuousreviewAdminViewHtml()),CR.Reviewer.reviewerPageOnLoad()},continuousreviewAdminViewHtml:function(){return'<div id="cr_rev_hdr"> <div class="zpl_btnmnu"><i class="zpl_ibg PI_back" onclick="PMSOperation.gotoCROperationPage()"></i> <div id="crPublishHdr" class="actn_ovrly"> <div><button id="crDoPublish" class="zlabel zlabel--blue zlabel--medium" onclick="CR.Reviewer.newPublishData();">'+ZPI18N.getString("zp.publish")+' </button></div> <i class="PI_cls" onclick="CR.Reviewer.closePublishHdr();" ></i> </div> <div></div> <div id="freqVwNvg" class="j-cnt-cntr"> <div class="zpl_inav"> <i class="PI_alft" id="fqPrevArw" title='+ZPI18N.getString("zp.previous")+'></i> <i class="PI_monthly" id="tl_datePicker"></i> <i class="PI_argt" id="fqNxtArw" title='+ZPI18N.getString("zp.next")+'></i> </div> <b id="revFreqFilDateInfo"></b> </div> <div id="yearVwNvg" class="j-cnt-cntr" style="display: none;"> <div class="zpl_inav"> <i class="PI_alft" id="yrPrevArw" title='+ZPI18N.getString("zp.previous")+'></i> <i class="PI_monthly" id="tl_datePicker"></i> <i class="PI_argt" id="yrNxtArw" title='+ZPI18N.getString("zp.next")+'></i> </div> <b id="revFilDateInfo"></b> </div> <div class="zpl_rgt"> <ul class="zpl_grpmnu"> <li id="cr_mth_view" reviewerview="freq" class="zpl_act active" ref="switchView" onclick="CR.Reviewer.reviewerViewOnChange(\'freq\');">'+ZPI18N.getString("zp.freqview")+' </li> <li id="cr_yr_view" reviewerview="year" ref="switchView" onclick="CR.Reviewer.reviewerViewOnChange(\'year\');" class=""> '+ZPI18N.getString("zp.yrview")+'</li> </ul> <i class="zpl_ibg PI_fltr" title="'+ZPI18N.getString("zp.yrview")+'" onclick="CR.Reviewer.toggleFilter(false);" id="assRatngFilter"></i> </div> </div> <div class="zpl_fltrvw DNI" id="crReviewerfltr"> <div> <ul class="zpl_fltrvwlst" id="crReviewerfltrlst"></ul> </div> <div class="d-flexcap MLauto"> <a id="crReviewer_fltr_clearall" class="zpl_link">'+ZPI18N.getString("zp.reset")+'</a> </div> </div> <div class="zpl_tbllftfxd"> <div class="zpl_rgtcnt" id="cfsMainDiv" style="padding-bottom: 60px;"></div> </div> <div class="zpl_tblpagination" id="cfsAssessPage_pagination"> <div class="zpl_rhtpgn" id="cfsAssessPage_rec_perpage_cont"> <select data-width="70" class="zselectbox select-js" id="cfsAssessPage_opr_rec_perpage" style="display: none;"> <option value="10">10</option> <option value="20">20</option> <option value="30">30</option> <option value="40">40</option> <option value="50">50</option> </select> <div class="pagecount" id="cfsAssessPage_navi"> <a class="zpl_prev gry" id="cfsAssessPage_pageprev"></a> <span id="cfsAssessPage_page_cnt"></span> <a class="zpl_nxt gry" id="cfsAssessPage_pagenext"></a> </div> </div> </div> <div id="cfsAssessPage"></div> <div class="zpl_fltr" id="assRatngEmpFilter"> <div> <div class="zpl_fltrhd"> <h5>'+ZPI18N.getString("zp.filter")+'</h5> <i class="PI_cls" onclick="CR.Reviewer.toggleFilter(true);"></i> </div> </div> <div class="zpl_fltrcnt"> <div> <div class="zpl_fltclps fltopn"> <div class="zpl_fltrlst"> <div class="zpl_secn"> <div><label>'+ZPI18N.getString("zp.employee")+'</label></div> <div> <textarea searchmode="PA_CFSREVIEWERREPORTEES" id="cfsAppraiseeFilt_opr" class="tokenfieldId-js" style="display: none;"></textarea> </div> </div> <div class="zpl_secn"> <div><label>'+ZPI18N.getString("zp.reviewer")+'</label></div> <div> <textarea searchmode="PA_ADDREVIEWER" id="cfsAssessorFilt" class="tokenfieldId-js" style="display: none;"></textarea> </div> </div> </div> </div> </div> </div> <div> <button type="button" class="zlabel zlabel--blue zlabel--medium" onclick="CR.Reviewer.assRtngFiltSearch();">'+ZPI18N.getString("zp.apply")+'</button> <button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="CR.Reviewer.resetRtngFilter(true);">'+ZPI18N.getString("zp.reset")+"</button> </div> </div> </div>"},gotoCROperationPage:function(){CR.Reviewer.destroyComponents(),window.location.href="#operations/performance/crs/oprreview"},isOprCRReviewExtension:function(){return-1!==settingsPage.tabId.indexOf("operations-performance-crs-revextension")}};PMSOperation.CR={IS_ACTIVE_CONFIG:!1,IS_ACTIVE_PERIOD_DATA:!1,MANAGE_PERIOD_HTML:null,MANAGE_PERIOD_ALLOWED:!1,CR_MANAGE_PERIOD_ARR:[],MANAGE_PERIOD_START_INDEX:1,DEFAULT_REC_LIMIT:20,PAGE_FILTER_ID:"",PAGE_ID:"",REVIEWED_EXCLUDE_LIST:[],CHK_REVIEWED_EXCLUDE_LIST:[],EXCLUDE_USER:0,INCLUDE_USER:1,setInitFilterId:function(){PMSOperation.CR.isCRManagePeriodPage()&&(PMSOperation.CR.PAGE_ID="crManPer_",PMSOperation.CR.PAGE_FILTER_ID="crManPer_")},isCRManagePeriodPage:function(){return"#operations-performance-crs-manageperiod"===settingsPage.tabId},isCROperationPage:function(){return"#operations-performance-crs-oprreview"===settingsPage.tabId},fetchData:function(params,async,successCallBack,failureCallBack){let _data=void 0;return async?ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,successCallBack,void 0,failureCallBack):void 0!=async?ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,successCallBack,void 0,failureCallBack):ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,resultData=>{_data=resultData}),_data},getRequestParams:function(mode,mappingId){let params={conreqcsr:csrfToken};switch(mode){case"getCRManagePeriodData":params.mode="getCRManagePeriodData",params.startIndex=PMSOperation.CR.MANAGE_PERIOD_START_INDEX,params.reclimit=PMSOperation.CR.DEFAULT_REC_LIMIT;let filterParams=PMSOperation.CR.getFilterValues();void 0!=filterParams.fromDate&&void 0!=filterParams.toDate&&(params.fromDate=filterParams.fromDate,params.toDate=filterParams.toDate);break;case"getCRPeriodStatus":params.mode="getCRPeriodStatus",params.mappingId=PMSOperation.CR.crStatusPage.mappingId;break;case"periodBackup":params.mode="crPeriodBackup",params.mappingId=PMSOperation.CR.crStatusPage.crData.mappingId;break;case"publishCRPeriod":params.mode="publishCRratingtouser",params.mappingId=mappingId;break;case"getCRPublishedUserDetails":params.mode="getCRPublishedUserDetails",params.mappingId=mappingId,params.startIndex=PMSOperation.CR.unpublishedReview.START_INDEX,params.reclimit=PMSOperation.CR.unpublishedReview.REC_LIMIT;break;case"unPublishReview":params.mode="unpublishCRRatingforUser",params.mappingId=mappingId,PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST.length>0&&(params.unPublishUserList=JSON.stringify(PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST));break;case"excludeCRUser":params.mode="includeExcludeCRUser",params.type=PMSOperation.CR.EXCLUDE_USER,void 0!==PMSOperation.CR.reviewedExcludeSliderObj&&Object.keys(PMSOperation.CR.reviewedExcludeSliderObj).length>0?params.includeExcludeCRUserArr=JSON.stringify(PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST):PMSOperation.INCLUDE_EXCLUDE_USER_ARR.length>0&&(params.includeExcludeCRUserArr=JSON.stringify(PMSOperation.INCLUDE_EXCLUDE_USER_ARR));break;case"getCRLstDt":params.mode="getCRLstDt"}return params},constructCRFrequecy:function(frequency){return frequency===PMSCommon.MONTHLY?ZPI18N.getString("zp.monthly"):frequency===PMSCommon.QUARTERLY?ZPI18N.getString("zp.quarterly"):frequency===PMSCommon.HALF_YEARLY?ZPI18N.getString("zp.schhfyearly"):frequency===PMSCommon.YEARLY?ZPI18N.getString("zp.yearly"):""},addEmployeeToSelectList:function(mode,obj){let _sliderDiv=void 0;if("excludeEmp"===mode){_sliderDiv=PMSOperation.CR.reviewedExcludeSliderObj.sliderDiv;let userId=$(obj).closest("tr").attr("id"),excludeBtn=_sliderDiv.find("#crExcludeRevEmpButton");if($(obj).is(":checked"))PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST.push(userId),excludeBtn.prop("disabled",!1),PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST.length===PMSOperation.CR.REVIEWED_EXCLUDE_LIST.length&&_sliderDiv.find("#crReviewedUserexcluded").prop("checked",!0);else{let index=PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST.indexOf(userId);-1!=index&&PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST.splice(index,1),PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST.length<PMSOperation.CR.REVIEWED_EXCLUDE_LIST.length&&_sliderDiv.find("#crReviewedUserexcluded").prop("checked",!1),PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST.length>0?excludeBtn.prop("disabled",!1):excludeBtn.prop("disabled",!0)}}else if("unPublishReviews"===mode){_sliderDiv=PMSOperation.CR.unpublishedReview.sliderDiv;let userId=$(obj).closest("tr").attr("id"),unpublishBtn=_sliderDiv.find("#unPublishReviewButton");if($(obj).is(":checked"))PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST.push(userId),unpublishBtn.prop("disabled",!1),PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST.length===PMSOperation.CR.unpublishedReview.PUBLISHED_USERS_LIST.length&&_sliderDiv.find("#unPubAllReviews").prop("checked",!0);else{let index=PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST.indexOf(userId);-1!=index&&PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST.splice(index,1),PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST.length<PMSOperation.CR.unpublishedReview.PUBLISHED_USERS_LIST.length&&_sliderDiv.find("#unPubAllReviews").prop("checked",!1),PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST.length>0?unpublishBtn.prop("disabled",!1):unpublishBtn.prop("disabled",!0)}}},selectAllEmployeesToList:function(mode,obj){let _sliderDiv=void 0;"excludeEmp"===mode?(_sliderDiv=PMSOperation.CR.reviewedExcludeSliderObj.sliderDiv,PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST=[],$(obj).is(":checked")?(PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST=PMSOperation.CR.REVIEWED_EXCLUDE_LIST.slice(0,PMSOperation.CR.REVIEWED_EXCLUDE_LIST.length),_sliderDiv.find("#crExcludeRevEmpButton").prop("disabled",!1),_sliderDiv.find("#crReviewedExcEmpBody [id^=crInclude_]").prop("checked",!0)):(_sliderDiv.find("#crExcludeRevEmpButton").prop("disabled",!0),_sliderDiv.find("#crReviewedExcEmpBody [id^=crInclude_]").prop("checked",!1))):"unPublishReviews"===mode&&(_sliderDiv=PMSOperation.CR.unpublishedReview.sliderDiv,PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST=[],$(obj).is(":checked")?(PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST=PMSOperation.CR.unpublishedReview.PUBLISHED_USERS_LIST.slice(0,PMSOperation.CR.unpublishedReview.PUBLISHED_USERS_LIST.length),_sliderDiv.find("#unPublishReviewButton").prop("disabled",!1),_sliderDiv.find("#unpublishReviewTableBody [id^=unPubReviews_]").prop("checked",!0)):(_sliderDiv.find("#unPublishReviewButton").prop("disabled",!0),_sliderDiv.find("#unpublishReviewTableBody [id^=unPubReviews_]").prop("checked",!1)))},constructEmpRow:function(data,prefixId){let nameAttr="";"unPubReviews_"===prefixId&&(nameAttr="name=unPublish");let row='<tr id="'+data.recordId+'">';return row+="<td>",row+='<div class="zcheckbox">',row+='<input id="'+prefixId+data.recordId+'" '+nameAttr+' type="checkbox" name="check" class="zcheckbox__helper">',row+='<label for="'+prefixId+data.recordId+'" class="zcheckbox__label"></label>',row+="</div>",row+="</td>",row+="<td>",row+='<div class="zpl_em">',row+='<div class="zpl_emimg">',row+='<img src="'+data.empPhoto+'">',row+="</div>",row+='<div class="zpl_emdts">',row+='<div title="'+data.name+'">',row+="<em>"+data.empId+" - </em><b>"+data.name+"</b>",row+="</div>",row+="</div>",row+="</div>",row+="</td>","unPubReviews_"===prefixId&&(row+="<td>",row+='<div class="zpl_hvr">',row+='<button type="button" name="unPublish" id="unPublish_'+data.recordId+'" class="zlabel zlabel--blue  zlabel--outline">'+ZPI18N.getString("zp.lms.course.unpublish")+"</button>",row+="</div>",row+="</td>"),row+="</tr>"},toggleFilter:function(isClose,breadCrumbObj){const pageId=settingsPage.container;if(void 0!==isClose?isClose?pageId.removeClass("zpl_fltr_flt"):pageId.addClass("zpl_fltr_flt"):pageId.hasClass("zpl_fltr_flt")?pageId.removeClass("zpl_fltr_flt"):pageId.addClass("zpl_fltr_flt"),void 0!==breadCrumbObj){let filterElementObj=JSON.parse($(breadCrumbObj).attr("fieldObj")),elemId=PMSOperation.CR.PAGE_FILTER_ID+filterElementObj.filterElementId;ZPeopleComponents.isComponent(pageId.find("#"+elemId))&&"dateField"===filterElementObj.filterElementType&&(ZPeopleComponents.datefield(pageId.find("#"+elemId)).focus(),ZPeopleComponents.datefield(pageId.find("#"+elemId)).openPicker())}},initFilter:function(){const pageId=settingsPage.container;if(PMSOperation.CR.isCRManagePeriodPage()){let fdateId=PMSOperation.CR.PAGE_FILTER_ID+"fetchFrom",tdateId=PMSOperation.CR.PAGE_FILTER_ID+"fetchTo";ZPeopleComponents.datefield(pageId.find("#"+fdateId),{format:dateFmt,pickerOptions:{appendTo:pageId}}),ZPeopleComponents.datefield(pageId.find("#"+tdateId),{format:dateFmt,pickerOptions:{appendTo:pageId}})}},destoryComponent:function(){const pageId=settingsPage.container;let filterComp=[];PMSOperation.CR.isCRManagePeriodPage()&&(filterComp.push({selector:"fetchFrom",method:"datefield"}),filterComp.push({selector:"fetchTo",method:"datefield"})),filterComp.length>0&&filterComp.forEach(component=>{ZPeopleComponents.isComponent(pageId.find("#"+PMSOperation.CR.PAGE_FILTER_ID+component.selector))&&("datefield"===component.method?ZPeopleComponents.datefield(pageId.find("#"+PMSOperation.CR.PAGE_FILTER_ID+component.selector)).destroy():"select"===component.method&&ZPeopleComponents.select(pageId.find("#"+PMSOperation.CR.PAGE_FILTER_ID+component.selector)).destroy())})},validateFilter:function(){let isValid=!0;const pageId=settingsPage.container;if(PMSOperation.CR.isCRManagePeriodPage()){let fdateId=PMSOperation.CR.PAGE_FILTER_ID+"fetchFrom",tdateId=PMSOperation.CR.PAGE_FILTER_ID+"fetchTo";pageId.find("#"+fdateId).parent().find("#error_message").remove(),ZPeopleComponents.datefield(pageId.find("#"+fdateId)).setAttributes({className:""}),pageId.find("#"+tdateId).parent().find("#error_message").remove(),ZPeopleComponents.datefield(pageId.find("#"+tdateId)).setAttributes({className:""});let fromDate=ZPeopleComponents.datefield(pageId.find("#"+fdateId)).getValue().dateString,toDate=ZPeopleComponents.datefield(pageId.find("#"+tdateId)).getValue().dateString;if(null!==fromDate&&void 0!=fromDate&&""!=fromDate&&null!==toDate&&void 0!=toDate&&""!=toDate){let fdate=Calendar.parseDate(fromDate,uidateFormat);Calendar.parseDate(toDate,uidateFormat)<fdate&&(pageId.find("#"+fdateId).parent().append('<span id="error_message" class="ztextbox--error__label">'+ZPI18N.getString("zp.fromDateIsGreater")+"</span>"),ZPeopleComponents.datefield(pageId.find("#"+fdateId)).setAttributes({className:"ztextbox__error"}),isValid=!1)}else null!=fromDate&&void 0!=fromDate&&""!=fromDate||null===toDate||void 0===toDate||""===toDate?null!=toDate&&void 0!=toDate&&""!=toDate||null===fromDate||void 0===fromDate||""===fromDate||(pageId.find("#"+tdateId).parent().append('<span id="error_message" class="ztextbox--error__label">'+ZPI18N.getString("zp.apptodateerror")+"</span>"),ZPeopleComponents.datefield(pageId.find("#"+tdateId)).setAttributes({className:"ztextbox__error"}),isValid=!1):(pageId.find("#"+fdateId).parent().append('<span id="error_message" class="ztextbox--error__label">'+ZPI18N.getString("zp.appfromdateerror")+"</span>"),ZPeopleComponents.datefield(pageId.find("#"+fdateId)).setAttributes({className:"ztextbox__error"}),isValid=!1)}return isValid},getFilterValues:function(){const pageId=settingsPage.container;let filterParams={};if(PMSOperation.CR.isCRManagePeriodPage()){let fdateId=PMSOperation.CR.PAGE_FILTER_ID+"fetchFrom",tdateId=PMSOperation.CR.PAGE_FILTER_ID+"fetchTo",fromDate=ZPeopleComponents.datefield(pageId.find("#"+fdateId)).getValue().dateString,toDate=ZPeopleComponents.datefield(pageId.find("#"+tdateId)).getValue().dateString;void 0!==fromDate&&null!==fromDate&&""!==fromDate&&(filterParams.fromDate=fromDate),void 0!==fromDate&&null!==fromDate&&""!==fromDate&&(filterParams.toDate=toDate)}return filterParams},searchFilter:function(){PMSOperation.CR.validateFilter()&&(PMSOperation.CR.toggleFilter(!0),PMSOperation.CR.initFilterBreadCrumb(),PMSOperation.CR.isCRManagePeriodPage()&&(PMSOperation.CR.MANAGE_PERIOD_START_INDEX=1,PMSOperation.CR.getCRManagePeriod(!0)))},resetFilter:function(){const pageId=settingsPage.container;if(PMSOperation.CR.isCRManagePeriodPage()){let fdateId=PMSOperation.CR.PAGE_FILTER_ID+"fetchFrom",tdateId=PMSOperation.CR.PAGE_FILTER_ID+"fetchTo";ZPeopleComponents.datefield(pageId.find("#"+fdateId)).clear(),ZPeopleComponents.datefield(pageId.find("#"+tdateId)).clear(),ZPeopleComponents.datefield(pageId.find("#"+fdateId)).setAttributes({placeholder:dateFmt}),ZPeopleComponents.datefield(pageId.find("#"+tdateId)).setAttributes({placeholder:dateFmt})}PMSOperation.CR.searchFilter()},initFilterBreadCrumb:function(){const pageId=settingsPage.container;let breadCrumbHtml=PMSOperation.CR.constructFilterBreadCrumb();""!==breadCrumbHtml?(pageId.find("[name=selectedfltrlst]").html(breadCrumbHtml),pageId.find("[name=selectedfltr]").removeClass("zpl_DNI"),pageId.addClass("zpl_fltrvwfxd"),pageId.find("[name=fltr_clearall]").unbind(),pageId.find("[name=fltr_clearall]").on("click",function(){PMSOperation.CR.resetFilter()}),pageId.find("[name=BreadCrumbElement]").unbind(),pageId.find("[name=BreadCrumbElement]").on("click",function(){PMSOperation.CR.onclickBreadCrumb(event,this)})):PMSOperation.CR.hideFilterBreadCrumb()},hideFilterBreadCrumb:function(){const pageId=settingsPage.container;pageId.removeClass("zpl_fltrvwfxd"),pageId.find("[name=selectedfltr]").addClass("zpl_DNI"),pageId.find("[name=selectedfltrlst]").empty()},constructFilterBreadCrumb:function(){let _htm="",filterParams=PMSOperation.CR.getFilterValues(),constructFilter=(filterElementKey,headerName,filterElement,filterElementType)=>{let value=filterParams[filterElementKey];void 0!=value&&""!=value&&(_htm+='<li name="BreadCrumbElement" fieldObj=\''+JSON.stringify({filterElementId:filterElement,filterElementType:filterElementType})+"'><label>"+headerName+':</label><span title="'+value+'">'+value+'</span><a id="filterTypeClose" class="PI_cls" filterId="'+filterElement+'" title="'+ZPI18N.getString("zp.remove")+'"></a></li>')};return PMSOperation.CR.isCRManagePeriodPage()&&(constructFilter("fromDate",ZPI18N.getString("zp.fromdate"),"fetchFrom","dateField"),constructFilter("toDate",ZPI18N.getString("zp.todate"),"fetchTo","dateField")),_htm},onclickBreadCrumb:function(event,obj){let filterFieldId=$(event.target).attr("id");if(void 0!==filterFieldId&&"filterTypeClose"===filterFieldId){let filterId=$(event.target).attr("filterid");"filterTypeClose"===filterFieldId&&PMSOperation.CR.removeSelectedFilter(filterId)}else PMSOperation.CR.toggleFilter(!1,obj)},removeSelectedFilter:function(elementId){const pageId=settingsPage.container;if("fetchFrom"===elementId||"fetchTo"===elementId){let fdateId=PMSOperation.CR.PAGE_FILTER_ID+"fetchFrom",tdateId=PMSOperation.CR.PAGE_FILTER_ID+"fetchTo";ZPeopleComponents.datefield(pageId.find("#"+fdateId)).clear(),ZPeopleComponents.datefield(pageId.find("#"+tdateId)).clear(),ZPeopleComponents.datefield(pageId.find("#"+fdateId)).setAttributes({placeholder:dateFmt}),ZPeopleComponents.datefield(pageId.find("#"+tdateId)).setAttributes({placeholder:dateFmt})}PMSOperation.CR.searchFilter()},initManagePeriod:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){const pageId=settingsPage.container;if(PMSOperation.CR.setInitFilterId(),null===PMSOperation.CR.MANAGE_PERIOD_HTML&&$.ajax({type:"POST",async:!1,url:"/performance/view/crManagePeriod",data:{conreqcsr:csrfToken},success:function(resultData){PMSOperation.CR.MANAGE_PERIOD_HTML=resultData}}),pageId.html(PMSOperation.CR.MANAGE_PERIOD_HTML),!PMSOperation.CR.MANAGE_PERIOD_ALLOWED)return!1;PMSOperation.CR.destoryComponent(),PMSOperation.CR.initFilter(),PMSOperation.CR.hideFilterBreadCrumb(),PMSOperation.CR.MANAGE_PERIOD_START_INDEX=1,PMSOperation.CR.getCRManagePeriod(!1)}},getCRManagePeriod:function(){const pageId=settingsPage.container;PMSOperation.CR.CR_MANAGE_PERIOD_ARR=[],pageId.find("#emptPage").remove(),pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner").addClass("zpl_DNI"),pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner").empty(),pageId.find("#"+PMSOperation.CR.PAGE_ID+"BodyCon").prepend(ZPeople.LOADING_HTML);let params=PMSOperation.CR.getRequestParams("getCRManagePeriodData");ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){$(pageId.find("#zp_page_loading")).remove(),void 0!==resultData&&void 0!==resultData.msg&&"SUCCESS"===resultData.msg&&void 0!=resultData.schObj&&resultData.schObj.length>0?(pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner").removeClass("zpl_DNI"),PMSOperation.CR.constructManageperiodRec(resultData.schObj,resultData.hasNext)):void 0!==resultData&&void 0!==resultData.msg&&"PERMISSION_DENIED"===resultData.msg?PMSOperationCommon.setNoData(pageId.find("#"+PMSOperation.CR.PAGE_ID+"BodyCon"),ZPI18N.getString("zp.permissiondenied"),"zp_nd_permission",null,null,null,!1):PMSOperationCommon.setNoData(pageId.find("#"+PMSOperation.CR.PAGE_ID+"BodyCon"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null,!1)},void 0,function(){pageId.find("#zp_page_loading").remove(),PMSOperationCommon.setNoData(pageId.find("#"+PMSOperation.CR.PAGE_ID+"BodyCon"),ZPI18N.getString("zp.erroroccurredloadingpage"),"no_data_found",null,null,null,!1)})},fireScrollManagePeriod:function(){const pageId=settingsPage.container;if(PMSOperation.CR.isCRManagePeriodPage()){pageId.find("#"+PMSOperation.CR.PAGE_ID+"BodyCon").append(ZPeople.LOADING_HTML);let params=PMSOperation.CR.getRequestParams("getCRManagePeriodData");ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){pageId.find("#zp_page_loading").remove(),settingsPage.fireScrollObj.hasOwnProperty("crManagePeriod")&&(settingsPage.fireScrollObj.crManagePeriod.reset(),delete settingsPage.fireScrollObj.crManagePeriod),void 0!==resultData.msg&&"SUCCESS"===resultData.msg&&void 0!=resultData.schObj&&resultData.schObj.length>0?(pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner").removeClass("zpl_DNI"),PMSOperation.CR.constructManageperiodRec(resultData.schObj,resultData.hasNext)):0===pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner").children().length&&(pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner").addClass("zpl_DNI"),PMSOperationCommon.setNoData(pageId.find("#"+PMSOperation.CR.PAGE_ID+"BodyCon"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null,!1))},void 0,function(){pageId.find("#zp_page_loading").remove()})}},constructManageperiodRec:function(schedulerObj,hasScroll){const pageId=settingsPage.container;let row="";if($.each(schedulerObj,function(index,schObj){row='<div class="zpl_catlst" id="'+schObj.mappingId+'">',row+='<div class="zpl_catlsthdr">',row+='<div class="zpl_catlstlft">',row+='<div class="d-flexclm8">',row+="<div>",row+='<span class="d-flexC">',void 0!==schObj.frequency&&(row+="<b>"+PMSOperation.CR.constructCRFrequecy(parseInt(schObj.frequency))+"&nbsp;"+ZPI18N.getString("zp.review")+"</b>"),void 0!==schObj.dataFromDt&&schObj.dataFromDt&&(row+='<span class="zpl_dots"></span>',row+="<em>"+schObj.dataFromDt+"&nbsp;-&nbsp;"+schObj.dataToDt+"</em>"),row+="</span>",row+="</div>",row+="</div>",row+="</div>",row+='<div class="zpl_catlstrgt align-self-cntr">',row+='<a class="zpl_link" id="'+schObj.mappingId+'_viewStatus" mappingId="'+schObj.mappingId+'">'+ZPI18N.getString("zp.local.ViewCycleStatus")+"</a>",row+="</div>",row+="</div>",row+='<div class="zpl_catlstfdr">',row+="<div>",row+='<ul class="zpl_lstbdrlne">',row+='<li id="'+schObj.mappingId+'_selfReview">',row+='<span class="zpl_lstbdrlneview">',row+="<span>",row+=ZPI18N.getString("zp.selfassessment")+"&nbsp;-&nbsp;"+(schObj.selfRevEnabled?'<span class="grn">'+ZPI18N.getString("zp.enabled")+"</span>":'<span class="red">'+ZPI18N.getString("zp.disabled")+"</span>"),row+="</span>",row+="</span>",row+="</li>",row+='<li id="'+schObj.mappingId+'_managerReview">',row+='<span class="zpl_lstbdrlneview">',row+="<span>",row+=ZPI18N.getString("zp.reviewerreview")+'&nbsp;-&nbsp;<span class="grn">'+ZPI18N.getString("zp.enabled")+"<span>"+(schObj.reviewerPopulated?"":'<i class="PI_info" title="'+ZPI18N.getString("zp.reviewyettopopulate")+'"></i>'),row+="</span>",row+="</span>",row+="</li>",row+="</ul>",row+="</div>",isPAdmin&&(row+='<div class="zpl_catlstrgt">',row+='<ul class="zpl_lstbdrlne">',row+='<li id="deletePeriod">',row+='<a id="'+schObj.mappingId+'_deletePeriod" mappingId="'+schObj.mappingId+'"><i class="PI_delete"></i></a>',row+="</li>",row+="</ul>",row+="</div>"),row+="</div>",row+="</div>",pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner").append(row),pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner #"+schObj.mappingId).data("schMappingObj",schObj),pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner #"+schObj.mappingId+"_deletePeriod").unbind(),pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner #"+schObj.mappingId+"_deletePeriod").on("click",function(){PMSOperation.CR.checkPeriodSubmittedRec($(this).attr("mappingId"))}),pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner #"+schObj.mappingId+"_viewStatus").unbind(),pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner #"+schObj.mappingId+"_viewStatus").on("click",function(){PMSOperation.CR.initStatusPage($(this).attr("mappingId"))}),-1==PMSOperation.CR.CR_MANAGE_PERIOD_ARR.indexOf(schObj.mappingId)&&PMSOperation.CR.CR_MANAGE_PERIOD_ARR.push(schObj.mappingId)}),PMSOperation.CR.MANAGE_PERIOD_START_INDEX+=schedulerObj.length,settingsPage.fireScrollObj.hasOwnProperty("crManagePeriod")&&(settingsPage.fireScrollObj.crManagePeriod.reset(),delete settingsPage.fireScrollObj.crManagePeriod),void 0!=hasScroll&&hasScroll)new FireScrollBack(PMSOperation.CR.fireScrollManagePeriod,pageId,"crManagePeriod")},checkPeriodSubmittedRec:function(mappingId){let params={mode:"isCRSubmitCheck",conreqcsr:csrfToken,mappingId:mappingId};ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){if(void 0!==resultData&&void 0!==resultData.msg&&"FAILURE"!==resultData.msg)if("SUCCESS"===resultData.msg){let isSubmitted=void 0!==resultData.isSubmitted&&resultData.isSubmitted;PMSOperation.CR.crManagePeriodDeleteConfirm1(mappingId,isSubmitted)}else"PERMISSION_DENIED"===resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):ZPeople.Message.failure(ZPI18N.getString("zp.problemoccured"));else ZPeople.Message.failure(ZPI18N.getString("zp.serrviceconflict.commonerror",[ZPeople.peopleSupportEmail]))},void 0,function(){ZPeople.Message.failure(ZPI18N.getString("zp.serrviceconflict.commonerror",[ZPeople.peopleSupportEmail]))})},crManagePeriodDeleteConfirm1:function(mappingId,isSubmitted){let schMapObj=settingsPage.container.find("#"+mappingId).data("schMappingObj"),deleteAlert=new InfoAlertMessage;deleteAlert.title=ZPI18N.getString("zp.deletecrcycle"),deleteAlert.despcription=ZPI18N.getString("zp.deletecrcycleinfomsg",new Array(schMapObj.dataFromDt,schMapObj.dataToDt)),deleteAlert.yesButtonText=ZPI18N.getString("zp.confirm"),isSubmitted?deleteAlert.callback=function(){PMSOperation.CR.crManagePeriodDeleteConfirm2(mappingId)}:(deleteAlert.centerHtml=ZPI18N.getString("zp.crselfreviewernotsubmitted"),deleteAlert._centerDN="",deleteAlert.callback=function(){PMSOperation.CR.crManagePeriodDelete(mappingId)}),deleteAlert.show()},crManagePeriodDeleteConfirm2:function(mappingId){let schMapObj=settingsPage.container.find("#"+mappingId).data("schMappingObj"),deleteAlert=new DeleteAlertMessage;deleteAlert.title=ZPI18N.getString("zp.deletecrcycle"),deleteAlert.despcription=ZPI18N.getString("zp.deletecrcyclefinalinfomsg",new Array(schMapObj.dataFromDt,schMapObj.dataToDt)),deleteAlert.centerHtml=ZPI18N.getString("zp.crbackupinfomsg"),deleteAlert._centerDN="",deleteAlert.yesButtonText=ZPI18N.getString("zp.confirm"),deleteAlert.callback=function(){PMSOperation.CR.crManagePeriodDelete(mappingId)},deleteAlert.show()},crManagePeriodDelete:function(mappingId){const pageId=settingsPage.container;let params={mode:"deleteCRPeriod",conreqcsr:csrfToken,mappingId:mappingId};ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,(resultData,params)=>{if(void 0!==resultData&&void 0!==resultData.MSG&&"FAILURE"!==resultData.MSG)if("SUCCESS"===resultData.MSG){"BACKUP_MAIL"===resultData.INFO?ZPeople.Message.success(ZPI18N.getString("zp.perioddeletesuccessfully")+". "+ZPI18N.getString("zp.crcyclebackupmsg")):ZPeople.Message.success(ZPI18N.getString("zp.perioddeletesuccessfully"));let mappingId=params.mappingId,perInd=PMSOperation.CR.CR_MANAGE_PERIOD_ARR.indexOf(mappingId);-1!==perInd&&PMSOperation.CR.CR_MANAGE_PERIOD_ARR.splice(perInd,1),pageId.find("#"+mappingId).remove(),pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner").children().length<10&&settingsPage.fireScrollObj.hasOwnProperty("crManagePeriod")&&PMSOperation.CR.fireScrollManagePeriod(),0===pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner").children().length&&(pageId.find("#"+PMSOperation.CR.PAGE_ID+"ViewConatiner").addClass("zpl_DNI"),PMSOperationCommon.setNoData(pageId.find("#"+PMSOperation.CR.PAGE_ID+"BodyCon"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null,!1))}else"PERMISSION_DENIED"===resultData.MSG?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):"NO_RECORDS"===resultData.MSG?ZPeople.Message.failure(ZPI18N.getString("zp.problemoccured")):ZPeople.Message.failure(ZPI18N.getString("zp.serrviceconflict.commonerror",[ZPeople.peopleSupportEmail]));else ZPeople.Message.failure(ZPI18N.getString("zp.serrviceconflict.commonerror",[ZPeople.peopleSupportEmail]))})},initStatusPage:function(mappingId,isFromPubStatus){const pageId=settingsPage.container;PMSOperation.CR.crStatusPage={};let schMapObj=pageId.find("#"+mappingId).data("schMappingObj");var tab=new Tab;tab.id="crPeriodStatus",tab.cardId="crPeriodStatusBody";let headingHtml='<span class="d-flexC">';headingHtml+="<h4>"+PMSOperation.CR.constructCRFrequecy(parseInt(schMapObj.frequency))+"&nbsp;"+ZPI18N.getString("zp.review")+"</h4>",headingHtml+='<span class="zpl_dots"></span>',headingHtml+="<em>"+schMapObj.dataFromDt+"&nbsp;-&nbsp;"+schMapObj.dataToDt+"</em>",headingHtml+="</span>",PMSOperation.CR.crStatusPage=new sliderModal("",tab),PMSOperation.CR.crStatusPage.largeSize=!0,PMSOperation.CR.crStatusPage.setCloseCallback(function(){PMSOperation.CR.crStatusPage.remove(),PMSOperation.CR.crStatusPage={}}),PMSOperation.CR.crStatusPage.construct(),PMSOperation.CR.crStatusPage.mappingId=schMapObj.mappingId;let sliderDiv=PMSOperation.CR.crStatusPage.sliderDiv;sliderDiv.find("#sliHdrDiv div").html(headingHtml),sliderDiv.find("#sliderSbt").remove(),sliderDiv.find("#sliderCancel").text(ZPI18N.getString("zp.close")),sliderDiv.find("#crPeriodStatusBody").html(ZPeople.LOADING_HTML);let params=PMSOperation.CR.getRequestParams("getCRPeriodStatus");ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){PMSOperation.CR.constructPeriodStatus(resultData,isFromPubStatus)},void 0,function(){PMSOperationCommon.setNoData(sliderDiv.find("#crPeriodStatusBody"),ZPI18N.getString("zp.erroroccurredloadingpage"),"no_data_found",null,null,null,!0)})},constructPeriodStatus:function(resultData,isFromPubStatus){let sliderDiv=PMSOperation.CR.crStatusPage.sliderDiv;if(sliderDiv.find("#zp_page_loading").remove(),void 0!==resultData)if("SUCCESS"===resultData.MSG){let crData=resultData.crData,_htm='<div class="zpl_crd wd100_per">';_htm+='<div class="zpl_crdcnt">',_htm+='<div class="zpl_secn zpl_cyleprid">',_htm+='<div class="zpl_DNI">',_htm+="</div>",_htm+="<div>",_htm+="<div>",_htm+="<span>"+ZPI18N.getString("zp.totApprCnt")+"&nbsp;:&nbsp;</span>",_htm+="<b>"+crData.totCnt+"</b>",_htm+="</div>",_htm+="</div>",isPAdmin&&(_htm+="<div>",_htm+='<button type="button" class="zlabel zlabel--blue zlabel--outline zlabel--medium" id="CRExportbtn"><i class="PI_exprt"> </i>'+ZPI18N.getString("zp.backuptxt")+"</button>",_htm+="</div>"),_htm+="</div>",_htm+="</div>",_htm+="</div>",_htm+='<div style="margin-top: 30px;" id="crMngTBody">',_htm+='<div class="zpl_anulperid" id="crMngTDiv">',_htm+='<div class="zpl_anulperidlft">',_htm+='<ul id="crManPer_crdetailslft"></ul>',_htm+="</div>",_htm+='<div class="zpl_anulperidcnt" id="crManPer_crdetailsrgt"></div>',_htm+="</div>",_htm+="</div>",sliderDiv.find("#crPeriodStatusBody").html(_htm),sliderDiv.find("#CRExportbtn").unbind(),sliderDiv.find("#CRExportbtn").on("click",function(){PMSOperation.CR.getCRReviewPeriodBackup()}),PMSOperation.CR.constructCRMngRow(resultData.crData,isFromPubStatus),PMSOperation.CR.crStatusPage.crData=resultData.crData}else"PERMISSION_DENIED"===resultData.MSG?PMSOperationCommon.setNoData(sliderDiv.find("#crPeriodStatusBody"),ZPI18N.getString("zp.permissiondenied"),"zp_nd_permission",null,null,null,!0):PMSOperationCommon.setNoData(sliderDiv.find("#crPeriodStatusBody"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null,!0);else PMSOperationCommon.setNoData(sliderDiv.find("#crPeriodStatusBody"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null,!0)},getCRReviewPeriodBackup:function(){let schMapObj=settingsPage.container.find("#"+PMSOperation.CR.crStatusPage.crData.mappingId).data("schMappingObj"),enableModTxt=PMSSetting.getEvalModuleList(PMSOperation.CR.crStatusPage.crData.enabledComponents,!0),infoPopUp=new InfoAlertMessage;infoPopUp.title=ZPI18N.getString("zp.backupcontinuousreviewdata"),infoPopUp.despcription=ZPI18N.getString("zp.backupcontinuousreviewinfo",new Array(schMapObj.dataFromDt,schMapObj.dataToDt,enableModTxt)),infoPopUp.centerHtml=ZPI18N.getString("zp.backupcontinuousreviewexcludeinfo"),infoPopUp._centerDN="",infoPopUp.yesButtonText=ZPI18N.getString("zp.backuptxt"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){let sliderDiv=PMSOperation.CR.crStatusPage.sliderDiv;sliderDiv.find("#CRExportbtn").addClass("disabled");let params=PMSOperation.CR.getRequestParams("periodBackup");ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData,param){sliderDiv.find("#CRExportbtn").removeClass("disabled"),void 0!=resultData.msg?"SUCCESS"===resultData.msg?ZPeople.Message.success(ZPI18N.getString("zp.backupcontinuousreviewsuccessmsg")):"PERMISSION_DENIED"===resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},void 0,function(){sliderDiv.find("#CRExportbtn").removeClass("disabled"),ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))})},infoPopUp.show()},publishCRReviewPeriod:function(mappingId){let infoPopUp=new InfoAlertMessage;infoPopUp.title=ZPI18N.getString("zp.publishreviews"),infoPopUp.despcription=ZPI18N.getString("zp.publishreviewsmsg"),infoPopUp.yesButtonText=ZPI18N.getString("zp.publish"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){let sliderDiv=settingsPage.container,isManagePeriod=PMSOperation.CR.isCRManagePeriodPage();isManagePeriod&&(sliderDiv=PMSOperation.CR.crStatusPage.sliderDiv);let params=PMSOperation.CR.getRequestParams("publishCRPeriod",mappingId);sliderDiv.find("#publishCrbtn").addClass("disabled"),ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData,param){if(sliderDiv.find("#publishCrbtn").removeClass("disabled"),void 0!=resultData.msg)if("SUCCESS"===resultData.msg)if(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.crpublishmsg1")),isManagePeriod)PMSOperation.CR.initStatusPage(params.mappingId,!0);else{let params=PMSOperation.CR.getRequestParams("getCRLstDt"),resultData=PMSOperation.CR.fetchData(params,void 0);void 0!==resultData&&PMSOperation.CR.constructCRMngRow(resultData.crData,!0)}else"PERMISSION_DENIED"===resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):"ERROR_OCCURED"===resultData.msg||"REVIEWER_RATING_PERIOD_NOT_STARTED"===resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.crpublishmsg2")):"NO_REVIEWED_RECORDS"===resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.crpublishmsg3")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"));else ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},void 0,function(){sliderDiv.find("#publishCrbtn").removeClass("disabled"),ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))})},infoPopUp.show()},initUnPublishReview:function(mappingId){const sliderTab=new Tab("unPublishReview",function(){let _htm='<div class="zpl_crd zpl_DNI" id="unPublishReviewCard">';_htm+='<div class="zpl_crdcnt">',_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_tblres">',_htm+='<table class="zpl_tbl wd100_per" id="unpublishReviewTable">',_htm+="<thead><tr>",_htm+='<th class="w50">',_htm+='<div class="zcheckbox" id="unpublishReviewChkBox">',_htm+='<input id="unPubAllReviews" name="unPublish" type="checkbox" name="check" class="zcheckbox__helper">',_htm+='<label for="unPubAllReviews" class="zcheckbox__label"></label>',_htm+="</div>",_htm+="</th>",_htm+="<th>",_htm+='<button type="button" name="unPublish" class="zlabel zlabel--blue  zlabel--outline" id="unPublishReviewButton" disabled>'+ZPI18N.getString("zp.lms.course.unpublish")+"</button>",_htm+="</th>",_htm+='<th class="w200"></th>',_htm+="</tr></thead>",_htm+='<tbody id="unpublishReviewTableBody"></tbody>',_htm+="</table>",_htm+="</div>",_htm+="</div>",_htm+="</div>",_htm+="</div>",$("#cardunPublishReview").html(_htm),$("#cardunPublishReview").append(ZPeople.LOADING_HTML)});PMSOperation.CR.unpublishedReview=new sliderModal(ZPI18N.getString("zp.pubrev"),sliderTab),PMSOperation.CR.unpublishedReview.setCloseCallback(function(){let isRefresh=PMSOperation.CR.unpublishedReview.isRefresh;if(settingsPage.fireScrollObj.hasOwnProperty("CRManPer_unpublishedReview")&&(settingsPage.fireScrollObj.CRManPer_unpublishedReview.reset(),delete settingsPage.fireScrollObj.CRManPer_unpublishedReview),PMSOperation.CR.unpublishedReview.PUBLISHED_USERS_LIST=new Array,PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST=new Array,PMSOperation.CR.unpublishedReview.remove(),PMSOperation.CR.unpublishedReview={},isRefresh)if(PMSOperation.CR.isCRManagePeriodPage())PMSOperation.CR.initStatusPage(params.mappingId,!0);else{let params=PMSOperation.CR.getRequestParams("getCRLstDt"),resultData=PMSOperation.CR.fetchData(params,void 0);void 0!==resultData&&PMSOperation.CR.constructCRMngRow(resultData.crData,!0)}}),PMSOperation.CR.unpublishedReview.construct(),PMSOperation.CR.unpublishedReview.PUBLISHED_USERS_LIST=new Array,PMSOperation.CR.unpublishedReview.SEL_PUBLISHED_USERS_LIST=new Array,PMSOperation.CR.unpublishedReview.mappingId=mappingId;let sliderDiv=PMSOperation.CR.unpublishedReview.sliderDiv;sliderDiv.find("#sliderSbt").remove(),sliderDiv.find("#sliderCancel").text(ZPI18N.getString("zp.close")),sliderDiv.find("#unPubAllReviews").unbind(),sliderDiv.find("#unPubAllReviews").on("click",function(){PMSOperation.CR.selectAllEmployeesToList("unPublishReviews",this)}),sliderDiv.find("#unPublishReviewButton").unbind(),sliderDiv.find("#unPublishReviewButton").on("click",function(){PMSOperation.CR.unpublishCRReview()}),PMSOperation.CR.unpublishedReview.START_INDEX=1,PMSOperation.CR.unpublishedReview.REC_LIMIT=30,settingsPage.fireScrollObj.hasOwnProperty("CRManPer_unpublishedReview")&&(settingsPage.fireScrollObj.CRManPer_unpublishedReview.reset(),delete settingsPage.fireScrollObj.CRManPer_unpublishedReview);let params=PMSOperation.CR.getRequestParams("getCRPublishedUserDetails",mappingId);ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,PMSOperation.CR.unPublishReviewSuccessCallBack,void 0,PMSOperation.CR.unPublishReviewFailureCallBack)},unPublishReviewSuccessCallBack:function(resultData,param){let sliderDiv=PMSOperation.CR.unpublishedReview.sliderDiv;if(sliderDiv.find("#zp_page_loading").remove(),void 0!==resultData&&void 0!==resultData.msg)if("SUCCESS"===resultData.msg)if(void 0!=resultData.publishedUserArr&&resultData.publishedUserArr.length>0){sliderDiv.find("#unPublishReviewCard").removeClass("zpl_DNI"),sliderDiv.find("#unPubAllReviews").prop("checked",!1);let row="";if($.each(resultData.publishedUserArr,function(index,data){PMSOperation.CR.unpublishedReview.PUBLISHED_USERS_LIST.push(data.recordId),row+=PMSOperation.CR.constructEmpRow(data,"unPubReviews_")}),void 0!==param&&void 0!==param.startIndex&&parseInt(param.startIndex)>1?sliderDiv.find("#unpublishReviewTableBody").append(row):sliderDiv.find("#unpublishReviewTableBody").html(row),sliderDiv.find("#unpublishReviewTableBody [id^=unPubReviews]").unbind(),sliderDiv.find("#unpublishReviewTableBody [id^=unPubReviews_]").on("click",function(){PMSOperation.CR.addEmployeeToSelectList("unPublishReviews",this)}),sliderDiv.find("#unpublishReviewTableBody [id^=unPublish_]").unbind(),sliderDiv.find("#unpublishReviewTableBody [id^=unPublish_]").on("click",function(){PMSOperation.CR.unpublishCRReview(this)}),PMSOperation.CR.unpublishedReview.START_INDEX+=resultData.publishedUserArr.length,settingsPage.fireScrollObj.hasOwnProperty("CRManagePeriod")&&(settingsPage.fireScrollObj.CRManPer_unpublishedReview.reset(),delete settingsPage.fireScrollObj.CRManPer_unpublishedReview),resultData.isHasNext)new FireScrollBack(PMSOperation.CR.onFireScrollUnPublishReview,sliderDiv.find("#cardunPublishReview"),"CRManPer_unpublishedReview")}else PMSOperationCommon.setNoData(sliderDiv.find("#cardunPublishReview"),ZPI18N.getString("zp.lookup.norecfound"),"no_data_found",null,null,null,!0);else"PERMISSION_DENIED"===resultData.msg?PMSOperationCommon.setNoData(sliderDiv.find("#cardunPublishReview"),ZPI18N.getString("zp.permissiondenied"),"zp_nd_permission",null,null,null,!0):PMSOperationCommon.setNoData(sliderDiv.find("#cardunPublishReview"),ZPI18N.getString("zp.erroroccurredloadingpage"),"no_data_found",null,null,null,!0);else PMSOperationCommon.setNoData(sliderDiv.find("#cardunPublishReview"),ZPI18N.getString("zp.erroroccurredloadingpage"),"no_data_found",null,null,null,!0)},unPublishReviewFailureCallBack:function(){let sliderDiv=PMSOperation.CR.unpublishedReview.sliderDiv;sliderDiv.find("#zp_page_loading").remove(),PMSOperationCommon.setNoData(sliderDiv.find("#cardunPublishReview"),ZPI18N.getString("zp.erroroccurredloadingpage"),"no_data_found",null,null,null,!0)},onFireScrollUnPublishReview:function(){let sliderDiv=PMSOperation.CR.unpublishedReview.sliderDiv;sliderDiv.find("#unpublishReviewTable").parent().append(ZPeople.LOADING_HTML);let params=PMSOperation.CR.getRequestParams("getCRPublishedUserDetails",PMSOperation.CR.unpublishedReview.mappingId);ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData,param){sliderDiv.find("#zp_page_loading").remove(),settingsPage.fireScrollObj.hasOwnProperty("CRManPer_unpublishedReview")&&(settingsPage.fireScrollObj.CRManPer_unpublishedReview.reset(),delete settingsPage.fireScrollObj.CRManPer_unpublishedReview),void 0!==resultData&&void 0!==resultData.msg&&"SUCCESS"===resultData.msg&&void 0!=resultData.publishedUserArr&&resultData.publishedUserArr.length>0&&PMSOperation.CR.unPublishReviewSuccessCallBack(resultData,params)},void 0,function(){sliderDiv.find("#zp_page_loading").remove()})},unpublishCRReview:function(obj){let sliderDiv=PMSOperation.CR.unpublishedReview.sliderDiv,params=PMSOperation.CR.getRequestParams("unPublishReview",PMSOperation.CR.unpublishedReview.mappingId);if(void 0!==obj){let tr=$(obj).closest("tr");params.unPublishUserList=JSON.stringify(new Array($(tr).attr("id")))}sliderDiv.find("[name=unPublish]").prop("disabled",!0),ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,(resultData,params)=>{if(sliderDiv.find("[name=unPublish]").prop("disabled",!1),void 0!=resultData)if("SUCCESS"===resultData.msg){ZPeople.Message.success(ZPI18N.getString("zp.unpublishreviewsuccessmsg")),sliderDiv.find("#unPubAllReviews").prop("checked",!1),PMSOperation.CR.selectAllEmployeesToList("unPublishReviews",sliderDiv.find("#unPubAllReviews")),sliderDiv.find("#unPublishReviewCard").addClass("zpl_DNI"),sliderDiv.find("#cardunPublishReview").append(ZPeople.LOADING_HTML),PMSOperation.CR.unpublishedReview.isRefresh=!0,PMSOperation.CR.unpublishedReview.START_INDEX=1;let params=PMSOperation.CR.getRequestParams("getCRPublishedUserDetails",PMSOperation.CR.unpublishedReview.mappingId);ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,PMSOperation.CR.unPublishReviewSuccessCallBack,void 0,PMSOperation.CR.unPublishReviewFailureCallBack)}else"PERMISSION_DENIED"===resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"));else ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},void 0,function(){sliderDiv.find("[name=unPublish]").prop("disabled",!1),ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))})},initContinuousReview:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){var pageId=settingsPage.container;CR.Reviewer.isAdminView=!0,CR.Reviewer.SHOW_REVIEWER_FILTER=!0,CR.Reviewer.CR_REC_PER_PAGE_ID="cfsAssessPage_opr_rec_perpage",CR.Reviewer.CR_REVIEW_APPRAISEE_ID="cfsAppraiseeFilt_opr",CR.Reviewer.destroyComponents(),""==PMSOperation.CR_OPR_PAGR?(PMSOperationCommon.addClearCentreClass(!0),pageId.html(""),$.ajax({type:"POST",async:!0,url:"/performance/view/crManagePage",data:{conreqcsr:csrfToken},success:function(resultData){PMSOperation.CR_OPR_PAGR=resultData,pageId.append(resultData),PMSOperation.CR.IS_ACTIVE_CONFIG="true"===PMSOperation.CR.IS_ACTIVE_CONFIG,PMSOperation.CR.IS_ACTIVE_PERIOD_DATA="true"===PMSOperation.CR.IS_ACTIVE_PERIOD_DATA,(PMSOperation.CR.IS_ACTIVE_CONFIG||PMSOperation.CR.IS_ACTIVE_PERIOD_DATA)&&(0==Object.keys(Layout.Page.urlparam).length?(pageId.find("#reviewerPageMainDiv, #crMngTBody #emptPage").remove(),pageId.find("#pa_activereview").hide(),pageId.append(ZPeople.LOADING_HTML),PMSOperation.CR.loadCRData()):(pageId.find("#sclID").remove(),PMSOperation.showCRReviewerView()))}})):(pageId.html(""),pageId.append(PMSOperation.CR_OPR_PAGR),PMSOperation.CR.IS_ACTIVE_CONFIG="true"===PMSOperation.CR.IS_ACTIVE_CONFIG,PMSOperation.CR.IS_ACTIVE_PERIOD_DATA="true"===PMSOperation.CR.IS_ACTIVE_PERIOD_DATA,(PMSOperation.CR.IS_ACTIVE_CONFIG||PMSOperation.CR.IS_ACTIVE_PERIOD_DATA)&&(0==Object.keys(Layout.Page.urlparam).length?(pageId.find("#reviewerPageMainDiv, #crMngTBody #emptPage").remove(),pageId.find("#pa_activereview").hide(),pageId.append(ZPeople.LOADING_HTML),PMSOperation.CR.loadCRData()):(pageId.find("#sclID").remove(),PMSOperation.showCRReviewerView())))}},loadCRData:function(){var pageId=settingsPage.container,params={mode:"getCRLstDt",conreqcsr:csrfToken};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){pageId.find("#zp_page_loading").remove(),void 0!==resultData&&void 0!==resultData.MSG?void 0!==resultData.MSG&&"PERMISSION_DENIED"===resultData.MSG?PMSOperationCommon.setNoData(pageId.find("#crMngTBody"),ZPI18N.getString("zp.permissiondeniedtoaccessthispage"),"zp_nd_permission",null,null,null):"SUCCESS"===resultData.MSG||"NO_RECORDS"===resultData.MSG?(pageId.find("#pa_activereview").show(),PMSOperation.CR.constructActiveCRMng(resultData.crData),PMSOperation.CR.constructCRMngRow(resultData.crData,!1)):PMSOperationCommon.setNoData(pageId.find("#crMngTBody"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null):PMSOperationCommon.setNoData(pageId.find("#crMngTBody"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null)},void 0,function(){pageId.find("#zp_page_loading").remove(),PMSOperationCommon.setNoData(pageId.find("#crMngTBody"),ZPI18N.getString("zp.nodatafound"),"no_data_found",null,null,null)})},constructActiveCRMng:function(crData){var pageId=settingsPage.container;let _htm='<div class="zpl_crdhdr zpl_pacntrevperd" >';if(_htm+='<div class="zpl_self-center">',_htm+="<h4>"+ZPI18N.getString("zp.continuousreviewperiod")+"</h4>",_htm+="</div>",crData.isCRConfActive&&!palocadm&&(_htm+='<div><ul class="zpl_pacntrvw">',_htm+='<li class="zpl_blulit">'+ZPI18N.getString("zp.appliemplist")+"<b>"+crData.totCnt+"</b></li>",_htm+="</ul></div>"),isPAdmin||appdataadmin||palocadm){let mwCls="zpl_mw120";crData.isCRActiveData&&crData.isCRConfActive&&!palocadm?mwCls="zpl_mw320":crData.isCRConfActive&&!palocadm&&(mwCls="zpl_mw180"),_htm+='<div class="zpl_catlstrgt '+mwCls+'"><ul class="zpl_lstbdrlne">',crData.isCRActiveData&&(_htm+='<li id="crMgedata" onclick="PMSOperation.showCRReviewerViewOnload()"><a><i class="PI_user1"></i>'+ZPI18N.getString("zp.managesalaryhike",[ZPI18N.getString("zp.data")])+"</a></li>"),crData.isCRConfActive&&!palocadm&&(_htm+='<li id="crMgeUsr" onclick="PMSOperation.showUserManagement(\'includeCREmployeeDivTable\');"><a><i class="PI_user1"></i>'+ZPI18N.getString("zp.local.ApplicableEmployees")+"</a></li>"),_htm+="</ul></div>"}else _htm+='<div class="zpl_catlstrgt zpl_mw160"></div>';_htm+="</div>",pageId.find("#pa_activereview").html(_htm)},constructCRMngRow:function(crData,isShowPubReview){const pageId=settingsPage.container;let preFixId="";if(PMSOperation.CR.isCRManagePeriodPage()&&(preFixId="crManPer_"),pageId.find("#crMngTBody #emptPage").remove(),void 0===crData||0===Object.keys(crData).length)return pageId.find("#crMngTDiv").addClass("zpl_DNI"),void PMSOperationCommon.setNoData(pageId.find("#crMngTBody"),ZPI18N.getString("zp.cr.noreviewperiod"),"no_data_found",null,null,null,!1);pageId.find("#crMngTDiv").removeClass("zpl_DNI");let lftObj=PMSOperation.CR.constructAppLftObj(crData);if(void 0===lftObj||lftObj.length<=0)return pageId.find("#crMngTDiv").addClass("zpl_DNI"),void PMSOperationCommon.setNoData(pageId.find("#crMngTBody"),ZPI18N.getString("zp.cr.noreviewperiod"),"no_data_found",null,null,null,!1);PMSOperation.CRREVIEW_DATA=lftObj;let leftElem=PMSOperation.CR.constructAppLft(lftObj);if(pageId.find("#"+preFixId+"crdetailslft").html($(leftElem)),pageId.find("#"+preFixId+"crdetailslft li").removeClass("zpl_act"),pageId.find("#"+preFixId+"crdetailslft > li").length>1&&(pageId.find("#"+preFixId+"crdetailslft li").unbind(),pageId.find("#"+preFixId+"crdetailslft li").click(function(event){pageId.find("#"+preFixId+"crdetailslft li").removeClass("zpl_act"),$(this).addClass("zpl_act");let modType=$(this).attr("id"),indx=0,pieId="",chartName="",isConsChart=!1;"selfContData"===modType?(indx=0,pieId="crselfpie",chartName=ZPI18N.getString("zp.selfassessment"),isConsChart=!0):"performanceData"===modType?(indx="selfContData"===PMSOperation.CRREVIEW_DATA[0].liId?1:0,pieId="crreviewpie",chartName=ZPI18N.getString("zp.reviewerreview"),isConsChart=!0):"publishContData"===modType&&(indx="selfContData"===PMSOperation.CRREVIEW_DATA[0].liId?2:1,pieId="publishstatus",chartName=ZPI18N.getString("zp.publishstatus"),isConsChart=!0),isConsChart&&PMSOperation.CR.constructCRRgt(PMSOperation.CRREVIEW_DATA[indx],preFixId+pieId,chartName)})),0!==PMSOperation.CRREVIEW_DATA.length)if(isShowPubReview){let indx="selfContData"===PMSOperation.CRREVIEW_DATA[0].liId?2:1;pageId.find("#"+preFixId+"crdetailslft #publishContData").addClass("zpl_act"),PMSOperation.CR.constructCRRgt(PMSOperation.CRREVIEW_DATA[indx],preFixId+"publishstatus",ZPI18N.getString("zp.publishstatus"))}else"selfContData"===PMSOperation.CRREVIEW_DATA[0].liId?(pageId.find("#"+preFixId+"crdetailslft #selfContData").addClass("zpl_act"),PMSOperation.CR.constructCRRgt(PMSOperation.CRREVIEW_DATA[0],preFixId+"crselfpie",ZPI18N.getString("zp.selfassessment"))):(pageId.find("#"+preFixId+"crdetailslft #performanceData").addClass("zpl_act"),PMSOperation.CR.constructCRRgt(PMSOperation.CRREVIEW_DATA[0],preFixId+"crreviewpie",ZPI18N.getString("zp.reviewerreview")))},constructAppLftObj:function(data){const{mappingId:mappingId,fetFrmDt:fetFrmDt,dforFetFrmDt:dforFetFrmDt,fetToDt:fetToDt,dforFetToDt:dforFetToDt,selfFrmDt:selfFrmDt,selfToDt:selfToDt,selfCmpCnt:selfCmpCnt,selfTotalCnt:selfTotalCnt,reviewFrmDt:reviewFrmDt,reviewToDt:reviewToDt,revCmpCnt:revCmpCnt,revTotalCnt:revTotalCnt,totCnt:totCnt,selfshowRemid:selfshowRemid,revshowRemid:revshowRemid,publishDetails:publishDetails}=data;let hdr="",reviewerFlag=!1,selfFalg=!1,perfJSON={},selfJSON={},publishJSON={};if(revTotalCnt>0){hdr=reviewFrmDt+" - "+reviewToDt;let pendingCnt=parseInt(revTotalCnt)-parseInt(revCmpCnt);perfJSON={mappingId:mappingId,name:ZPI18N.getString("zp.reviewerreview")+" "+ZPI18N.getString("zp.status"),date:hdr,total:revTotalCnt,completed:revCmpCnt,pending:pendingCnt,statusArr:[{key:ZPI18N.getString("zp.completed"),value:revCmpCnt,iconCol:"blu"},{key:ZPI18N.getString("zp.pending"),value:pendingCnt,iconCol:""}],liId:"performanceData",remidertext:ZPI18N.getString("zp.formssubmitreminder",[ZPI18N.getString("zp.reviewerreview")]),remidertype:1,fetFrmDt:fetFrmDt,dforFetFrmDt:dforFetFrmDt,dforFetToDt:dforFetToDt,fetToDt:fetToDt,showreminder:revshowRemid,revFromDt:reviewFrmDt,revToDt:reviewToDt,icon:"PI_perfrm_rvw zpl_seclr4 icn"},reviewerFlag=!0,void 0!==publishDetails&&void 0!==publishDetails.showPublishStatus&&publishDetails.showPublishStatus&&(publishJSON={mappingId:mappingId,name:ZPI18N.getString("zp.publishstatus"),total:totCnt,completed:publishDetails.publishedCnt,pending:publishDetails.pendingPublishedCnt,statusArr:[{key:ZPI18N.getString("zp.published"),value:publishDetails.publishedCnt,iconCol:"blu"},{key:ZPI18N.getString("zp.unpublished"),value:publishDetails.pendingPublishedCnt,iconCol:""}],liId:"publishContData",showreminder:!1,isShowpublishBtn:publishDetails.isShowpublishBtn,isShowUnPublishBtn:publishDetails.isShowUnPublishBtn,fetFrmDt:fetFrmDt,fetToDt:fetToDt,dforFetFrmDt:dforFetFrmDt,dforFetToDt:dforFetToDt,icon:"PI_publish zpl_seclr6 icn"})}if(selfTotalCnt>0){hdr=selfFrmDt+" - "+selfToDt,selfFalg=!0,PMSOperation.CR_Self_Enabled=!0;let pendingCnt=parseInt(selfTotalCnt)-parseInt(selfCmpCnt);selfJSON={mappingId:mappingId,name:ZPI18N.getString("zp.selfassessment")+" "+ZPI18N.getString("zp.status"),date:hdr,total:selfTotalCnt,completed:selfCmpCnt,pending:pendingCnt,statusArr:[{key:ZPI18N.getString("zp.completed"),value:selfCmpCnt,iconCol:"blu"},{key:ZPI18N.getString("zp.pending"),value:pendingCnt,iconCol:""}],liId:"selfContData",remidertext:ZPI18N.getString("zp.formssubmitreminder",[ZPI18N.getString("zp.selfassessment")]),remidertype:0,fetFrmDt:fetFrmDt,fetToDt:fetToDt,dforFetFrmDt:dforFetFrmDt,dforFetToDt:dforFetToDt,showreminder:selfshowRemid,revFromDt:selfFrmDt,revToDt:selfToDt,icon:"PI_self_appraisal icn zpl_seclr2"}}else PMSOperation.CR_Self_Enabled=!1;let result=[];return selfFalg&&reviewerFlag?(result.push(selfJSON),result.push(perfJSON),Object.keys(publishJSON).length>0&&result.push(publishJSON)):selfFalg&&!reviewerFlag?result.push(selfJSON):!selfFalg&&reviewerFlag&&(result.push(perfJSON),Object.keys(publishJSON).length>0&&result.push(publishJSON)),result},constructAppLft:function(arr){let _htm="";for(var i in arr)_htm+='<li id="'+arr[i].liId+'" mappingId="'+arr[i].mappingId+'"><div>',_htm+='<div class="zpl_cyclecht">',_htm+='<div class="icnDv"><span class="'+arr[i].icon+'"></span></div>',_htm+="</div>",_htm+="<div>",_htm+='<span class="d-flexC"><b>'+arr[i].name+"</b>",arr[i].hasOwnProperty("date")&&(_htm+='<span class="zpl_dots"></span><em>'+arr[i].date+"</em>"),_htm+="</span>",_htm+='<ul class="zpl_cylesta">',$.each(arr[i].statusArr,function(index,statusObj){_htm+="<li>",_htm+='<span class="zpl_dots '+statusObj.iconCol+'"></span>',_htm+="<em>"+statusObj.key+"</em>",_htm+="<span>"+statusObj.value+"</span>",_htm+="</li>"}),_htm+="</ul>",_htm+="</div>",_htm+="</div></li>";return _htm},constructCRRgt:function(_data,pieId,name){const pageId=settingsPage.container;let preFixId="";PMSOperation.CR.isCRManagePeriodPage()&&(preFixId="crManPer_");let _htm='<div class="zpl_crd zpl_act" style="height: 102%;max-width: 100%;"><div class="zpl_crdcnt">';PMSOperation.CR.isCRManagePeriodPage()||(_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_cylepridhdr">',_htm+='<div class="zpl_idiv"></div>',_htm+='<div class="zpl_idiv">',_htm+="<span>"+ZPI18N.getString("zp.evaluationperiod_LC")+":</span>",_htm+="<b>"+_data.dforFetFrmDt+"&nbsp;"+ZPI18N.getString("zp.sto")+"&nbsp;"+_data.dforFetToDt+"</b>",_htm+="</div>",_htm+="</div>",_htm+="</div>"),_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="'+pieId+'" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',$.each(_data.statusArr,function(index,statusObj){_htm+="<li>",_htm+='<span class="zpl_dots '+statusObj.iconCol+'"></span>',_htm+="<em>"+statusObj.key+"</em>",_htm+="<span>"+statusObj.value+"</span>",_htm+="</li>"}),_htm+="</ul>",_htm+="</div>",_htm+="</div>",_data.showreminder?(_htm+='<div class="zpl_secn"><div>',_htm+='<div class="zpl_gbox wd100_per">',_htm+="<div>",_htm+="<h4>"+ZPI18N.getString("zp.reminder.remind")+"</h4>",_htm+="<p>"+_data.remidertext+"</p>",_htm+="</div>",_htm+='<div class="zpl_idiv">',_htm+='<button type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue" fetFrm="'+_data.fetFrmDt+'" fetTo="'+_data.fetToDt+'" onclick="PMSOperation.initPendingCREmplList(\''+_data.remidertype+"', this);\">"+ZPI18N.getString("zp.reminder.remind")+"</button>",_htm+="</div>",_htm+="</div>",_htm+="</div></div>"):"publishContData"===_data.liId&&(_data.isShowpublishBtn||_data.isShowUnPublishBtn)&&(_htm+='<div class="zpl_secn">',_htm+="<div>",_htm+='<div class="zpl_gbox wd100_per">',_data.isShowUnPublishBtn&&(_htm+="<div>",_htm+="<h4></h4>",_htm+="<p>"+ZPI18N.getString("zp.unpublishcrinfo",["PMSOperation.CR.initUnPublishReview('"+_data.mappingId+"')"])+"</p>",_htm+="</div>"),_data.isShowpublishBtn&&_data.isShowUnPublishBtn&&(_htm+='<div class="zpl_idiv"></div>'),_data.isShowpublishBtn&&(_htm+='<div class="zpl_idiv">',_htm+='<button type="button" id="publishCrbtn" class="zlabel zlabel--outline zlabel--medium zlabel--blue" onclick="PMSOperation.CR.publishCRReviewPeriod(\''+_data.mappingId+"');\">"+ZPI18N.getString("zp.publish")+"</button>",_htm+="</div>"),_htm+="</div>",_htm+="</div>",_htm+="</div>"),_htm+="</div></div>",pageId.find("#"+preFixId+"crdetailsrgt").empty().append($(_htm)),PMSV2Cycle.constructNonApprovalPieChart(pieId,name,_data.total,_data.completed,_data.pending)},excludeUserConfirmation:function(obj,allFlag){if(void 0===PMSOperation.crManageEmpSliderObj.periodDetails){let params={mode:"getLatestCRReviewDetails",conreqcsr:csrfToken},resultData=PMSOperation.CR.fetchData(params,void 0);void 0!==resultData&&void 0!==resultData.msg&&(resultData.isAllowed=!1,"ON_GOING_REVIEW_PERIOD"!==resultData.msg&&"FUTURE_REVIEW_PERIOD"!==resultData.msg||(resultData.isAllowed=!0),PMSOperation.crManageEmpSliderObj.periodDetails=resultData)}if(void 0!==PMSOperation.crManageEmpSliderObj.periodDetails&&PMSOperation.crManageEmpSliderObj.periodDetails.isAllowed){var selErecNo=allFlag?null:$(obj).parents("tr").attr("erecno"),deletePopUp=new DeleteAlertMessage;let isMultiExcl=!!(allFlag&&void 0!==PMSOperation.INCLUDE_EXCLUDE_USER_ARR&&PMSOperation.INCLUDE_EXCLUDE_USER_ARR.length>1),empTit=ZPI18N.getString("zp.employee"),empTxt=ZPI18N.getString("zp.employee_LC");isMultiExcl&&(empTit=ZPI18N.getString("zp.employees"),empTxt=ZPI18N.getString("zp.employees_LC")),deletePopUp.title=ZPI18N.getString("zp.cr.excludeemployee",[empTit]);let desc="";desc="ON_GOING_REVIEW_PERIOD"===PMSOperation.crManageEmpSliderObj.periodDetails.msg?ZPI18N.getString("zp.cr.exclude.currentperioddesc",[empTxt,PMSOperation.crManageEmpSliderObj.periodDetails.dataFromDt,PMSOperation.crManageEmpSliderObj.periodDetails.dataToDt]):ZPI18N.getString("zp.cr.exclude.futureperioddesc",[empTxt]),deletePopUp.despcription=desc,deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=function(){PMSOperation.CR.excludeCRUser(selErecNo)},deletePopUp.show()}else ZPeople.Message.failure(ZPI18N.getString("zp.rebranderrinaction"))},excludeCRUser:function(selErecNo,excludeReviewedEmp){let params=PMSOperation.CR.getRequestParams("excludeCRUser");if(null!=selErecNo&&void 0!=selErecNo){let tempArr=new Array;tempArr.push(selErecNo),params.includeExcludeCRUserArr=JSON.stringify(tempArr)}void 0!=excludeReviewedEmp&&(params.excludeReviewedEmp=excludeReviewedEmp),ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,PMSOperation.CR.excludeCRUserSuccessReponse,void 0,PMSOperation.CR.excludeCRUserFailureReponse)},excludeCRUserSuccessReponse:function(resultData,params){if("SUCCESS"===resultData.msg||"NO_USER_EXCLUDED"===resultData.msg){let _applSlider=PMSOperation.crManageEmpSliderObj.sliderDiv;if(PMSOperation.INCLUDE_EXCLUDE_USER_ARR=[],_applSlider.find("#excludeAllBtn").attr("disabled","disabled"),_applSlider.find("#CRAppMultiActionDiv").removeClass("opn"),_applSlider.find("#appliTBody [id^=checlbx_]").prop("checked",!1),void 0==params.excludeReviewedEmp&&void 0!=resultData.reviewedEmpArr&&resultData.reviewedEmpArr.length>0)PMSOperation.CR.constReviewedExcludeUsrSlider(resultData);else if(void 0!==params.excludeReviewedEmp&&!0===params.excludeReviewedEmp&&void 0!==PMSOperation.CR.reviewedExcludeSliderObj&&Object.keys(PMSOperation.CR.reviewedExcludeSliderObj).length>0){let emplTxt=void 0!==resultData.excludeUsers&&resultData.excludeUsers.length>1?ZPI18N.getString("zp.employees"):ZPI18N.getString("zp.employee");ZPeople.Message.success(ZPI18N.getString("zp.cr.exclude.currentperiodsuccessmsg",[emplTxt])+". "+ZPI18N.getString("zp.crcyclebackupmsg")),PMSOperation.CR.reviewedExcludeSliderObj.close()}else{let emplTxt=void 0!==resultData.excludeUsers&&resultData.excludeUsers.length>1?ZPI18N.getString("zp.employees"):ZPI18N.getString("zp.employee");void 0!==resultData.dataFromDt&&void 0!==resultData.dataToDt?ZPeople.Message.success(ZPI18N.getString("zp.cr.exclude.currentperiodsuccessmsg",[emplTxt])):ZPeople.Message.success(ZPI18N.getString("zp.cr.exclude.futureperiodsuccessmsg",[emplTxt])),PMSOperation.applicableUserView()}}else"ALL_USER_EXCLUDE"===resultData.msg?ZPeople.Message.failure(ZPI18N.getString("zp.excludeCRAllUsr")):ZPeople.Message.failure(ZPI18N.getString("zp.errorinexclude"))},excludeCRUserFailureReponse:function(resultData,params){ZPeople.Message.failure(ZPI18N.getString("zp.errorinexclude"));let _applSlider=PMSOperation.crManageEmpSliderObj.sliderDiv;PMSOperation.INCLUDE_EXCLUDE_USER_ARR=[],_applSlider.find("#excludeAllBtn").attr("disabled","disabled"),_applSlider.find("#CRAppMultiActionDiv").removeClass("opn"),_applSlider.find("#excludeAllCRUser, #appliTBody [id^=checlbx_]").prop("checked",!1),void 0!==params.excludeReviewedEmp&&!0===params.excludeReviewedEmp&&PMSOperation.CR.reviewedExcludeSliderObj.close()},constReviewedExcludeUsrSlider:function(resultData){const sliderTab=new Tab("crReviewedExcludeUsr",function(){$("#cardcrReviewedExcludeUsr").append(ZPeople.LOADING_HTML);let apprTxt="";void 0!==resultData.self_Cfs_Sch_Id?(apprTxt+=ZPI18N.getString("zp.selfassessment"),void 0!==resultData.rev_Cfs_Sch_Id&&(apprTxt+="&nbsp;"+ZPI18N.getString("zp.or")+"&nbsp;"+ZPI18N.getString("zp.reviewerreview"))):void 0!==resultData.rev_Cfs_Sch_Id&&(apprTxt+=ZPI18N.getString("zp.reviewerreview"));let _htm='<div class="zpl_info" style="margin-bottom: 20px;"><div>';_htm+='<p id="excludeMessage">'+(ZPI18N.getString("zp.excludecrexceptionmsg",new Array(apprTxt,PMSOperation.crManageEmpSliderObj.periodDetails.dataFromDt,PMSOperation.crManageEmpSliderObj.periodDetails.dataToDt))+"<br>"+ZPI18N.getString("zp.empselecttocrexcludemsg"))+"</p>",_htm+="</div></div>",_htm+='<div class="zpl_btnmnu">',_htm+='<div class="zpl_nowrap">',_htm+='<ul class="zpl_grpmnulnelst">',_htm+="<li>"+ZPI18N.getString("zp.excluded")+'&nbsp;:&nbsp;<b class="ylw id="successExcludeCount">'+(void 0!==resultData.excludeUsers?resultData.excludeUsers.length:0)+"</b></li>",_htm+="<li>"+ZPI18N.getString("zp.notexlcuded")+'&nbsp;:&nbsp;<b class="ylw id="failedExcludeCount">'+(void 0!==resultData.reviewedEmpArr?resultData.reviewedEmpArr.length:0)+"</b></li>",_htm+="</ul>",_htm+="</div>",_htm+="</div>",_htm+='<div class="zpl_crd">',_htm+='<div class="zpl_crdcnt">',_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_tblres">',_htm+='<table class="zpl_tbl wd100_per" id="crReviewedExcEmpDiv">',_htm+="<thead><tr>",_htm+='<th class="w50">',_htm+='<div class="zcheckbox" id="excludeRevEmpChkBox">',_htm+='<input id="crReviewedUserexcluded" type="checkbox" name="check" class="zcheckbox__helper">',_htm+='<label for="crReviewedUserexcluded" class="zcheckbox__label"></label>',_htm+="</div>",_htm+="</th>",_htm+="<th>",_htm+='<button type="button" class="zlabel zlabel--red zlabel--small" id="crExcludeRevEmpButton" disabled>'+ZPI18N.getString("zp.exclude")+"</button>",_htm+="</th>",_htm+="</tr></thead>",_htm+='<tbody id="crReviewedExcEmpBody"></tbody>',_htm+="</table>",_htm+="</div>",_htm+="</div>",_htm+="</div>",_htm+="</div>",$("#cardcrReviewedExcludeUsr").html(_htm)});PMSOperation.CR.reviewedExcludeSliderObj=new sliderModal(ZPI18N.getString("zp.excludeSummary"),sliderTab),PMSOperation.CR.reviewedExcludeSliderObj.setCloseCallback(function(){PMSOperation.CR.REVIEWED_EXCLUDE_LIST=[],PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST=[],PMSOperation.CR.reviewedExcludeSliderObj.remove(),PMSOperation.CR.reviewedExcludeSliderObj={},PMSOperation.applicableUserView()}),PMSOperation.CR.reviewedExcludeSliderObj.construct(),PMSOperation.CR.reviewedExcludeSliderObj.isSelfReviewExist=!!resultData.self_Cfs_Sch_Id,PMSOperation.CR.reviewedExcludeSliderObj.isManagerReviewExist=!!resultData.rev_Cfs_Sch_Id;let _sliderDiv=PMSOperation.CR.reviewedExcludeSliderObj.sliderDiv;_sliderDiv.find("#sliderSbt").remove(),_sliderDiv.find("#sliderCancel").text(ZPI18N.getString("zp.close")),_sliderDiv.find("#crReviewedUserexcluded").unbind(),_sliderDiv.find("#crReviewedUserexcluded").on("click",function(){PMSOperation.CR.selectAllEmployeesToList("excludeEmp",this)}),_sliderDiv.find("#crExcludeRevEmpButton").unbind(),_sliderDiv.find("#crExcludeRevEmpButton").on("click",function(){PMSOperation.CR.backupAndExcludeReviewedEmp()});let row="";$.each(resultData.reviewedEmpArr,function(index,data){PMSOperation.CR.REVIEWED_EXCLUDE_LIST.push(data.recordId),row+=PMSOperation.CR.constructEmpRow(data,"crInclude_")}),_sliderDiv.find("#crReviewedExcEmpBody").html(row),_sliderDiv.find("#crReviewedExcEmpBody [id^=crInclude_]").unbind(),_sliderDiv.find("#crReviewedExcEmpBody [id^=crInclude_]").on("click",function(){PMSOperation.CR.addEmployeeToSelectList("excludeEmp",this)})},backupAndExcludeReviewedEmp:function(){if(PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST.length>0){let apprTxt="";void 0!==PMSOperation.CR.reviewedExcludeSliderObj.isSelfReviewExist?(apprTxt+=ZPI18N.getString("zp.selfassessment"),void 0!==PMSOperation.CR.reviewedExcludeSliderObj.isManagerReviewExist&&(apprTxt+="&nbsp;"+ZPI18N.getString("zp.or")+"&nbsp;"+ZPI18N.getString("zp.reviewerreview"))):void 0!==PMSOperation.CR.reviewedExcludeSliderObj.isManagerReviewExist&&(apprTxt+=ZPI18N.getString("zp.reviewerreview"));let tempTxt="",empTxt="";PMSOperation.CR.CHK_REVIEWED_EXCLUDE_LIST.length>1?(tempTxt=ZPI18N.getString("zp.remove_LC"),empTxt=ZPI18N.getString("zp.selected")+" "+ZPI18N.getString("zp.employees_LC")):(tempTxt=ZPI18N.getString("zp.exclude_LC"),empTxt=ZPI18N.getString("zp.employee_LC"));var infoPopUp=new InfoAlertMessage;infoPopUp.title=ZPI18N.getString("zp.excludeEmp"),infoPopUp.despcription=ZPI18N.getString("zp.excludeconfirmationcrbackupmsg",[tempTxt,empTxt,apprTxt,PMSOperation.crManageEmpSliderObj.periodDetails.dataFromDt,PMSOperation.crManageEmpSliderObj.periodDetails.dataToDt]),infoPopUp.centerHtml=ZPI18N.getString("zp.crbackupinfomsg"),infoPopUp._centerDN="",infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){PMSOperation.CR.reviewedExcludeSliderObj.sliderDiv.find("#crReviewedUserexcluded, #crReviewedExcEmpBody [id^=crInclude_]").find("tbody input[type='checkbox']").prop("disabled",!0),PMSOperation.CR.excludeCRUser(void 0,!0)},infoPopUp.show()}}};var PACycle={Constants:{CYCLE_TYPE:{APPRAISAL_CYCLE_TYPE:0,TEMPLATE_TYPE:1,SALARY_HIKE_CYCLE_TYPE:2,CR_TEMPLATE_TYPE:3,CR_CYCLE_TYPE:4},TEMPLATE_STATUS:77}},PMSV2Cycle={LEFT_TAB_ARRAY:["nwCylbasicDetDiv","nwCylAppliDiv","nwCylsaDetDiv_hide","nwCylmrDetDiv_hide","nwCylpaDetDiv","nwCylratingDetDiv","nwCylhkDetDiv_hide","nwCylnrmDetDiv_hide","nwCylpubDetDiv","nwCylAppraisalLetterDiv_hide","nwCylPeriodDiv"],LEFT_TAB_K_V:{},ON_LOAD_PAGE:void 0,MR_NAME:"",EDIT_TMPL_DETAIL:null,CYCLE_CONFIG_PAGE:null,CYCLE_APPLICABLE_KEYS:{APPL_LOC:ZPI18N.getString("zp.location"),APPL_ROLE:ZPI18N.getString("zp.role"),APPL_DEP:ZPI18N.getString("zp.department"),APPL_DES:ZPI18N.getString("zp.designation")},INIT_SETTINGS:null,ALL_LOCATIONS:null,ALL_ROLES:null,ALL_DEPARTMENTS:null,ALL_DESIGNATION:null,ALL_LEVELS:null,ALL_EMPTYPES:null,isLevelEnabled:!1,customDateFCID:null,mrTemplateId:null,mrApprFormId:null,isMR_apprConf:null,review_ApprConf:!1,budgetSpliupSheetApprovalFormId:null,teamBudgetFormName:null,isBudget_apprConf:null,teamBudgetApprID:null,appraisalfields:null,kraRatingComponent:null,goalRatingComponent:null,userRatingComponent:null,managerRatingComponent:null,moduleRatingType:null,mrtypes:null,mrTypeData:null,HIKE_EMP_LOOKUPS:null,APPRAISALTABULARFIELDS:null,isSARatingEnabled:null,isPARatingEnabled:null,IS_FINALSCORE_ENABLED:null,multiraterName:"",isRatingModified:!1,rating_keyarray:[],rating_idarray:[],rating_normPerArray:[],rating_keyarray_color:["zpl_fc1","zpl_fc2","zpl_fc3","zpl_fc4","zpl_fc5","zpl_fc6","zpl_fc7","zpl_fc8","zpl_fc9","zpl_fc10"],rating_minRangeArray:new Array,rating_maxRangeArray:new Array,textrating_name:[],textrating_value:[],SEFLAPPRAISALFILEREMOVED:!1,GUIDELINEDOCREMOVED:!1,TTOTAL_SALARY:0,CUR_HIKE_RULE:0,DATEERROR:!1,ISRATINGEDITOPEN:!1,BUDGETCONFIGERROR:!1,SELECTED_TMPL:null,TAB_SCROLL:!1,EDIT_CYCLE_FLAG:!1,CLONE_CYCLE_FLAG:!1,ALREADY_SEL_VAL:[],HIKENAME:null,SALARYHIKENAME:null,ALLOCATEDHIKENAME:null,PROPOSEDHIKENAME:null,REVIEWSTATUS_DATA:null,SHOW_SAL_NOTAVAIL_MODAL:null,FS_IDX:1,cyleCompleteStatus:"5",cyleActiveStatus:"0",selectedUnPublishUserCnt:0,GUIDE_FILE:null,SELF_FILE:null,SELFAPPFORMFILEID:null,GUIDELINESFILEID:null,SELECTED_DOJUTIL_DATE:null,pendingStartIndx:1,remindUserList:new Array,tempRemindUserList:new Array,pendingempSelf:new Array,CYCLE_REMINDER_OBJ:{},IS_SELF_ENABLED:!1,IS_MR_ENABLED:!1,IS_SAL_HK_ENABLED:!1,IS_NORM_ENABLED:!1,IS_MOD_WGT_ENABLED:!1,IS_COURSE_ENABLE:!1,IS_DATE_OF_CONFIRMATION_ENABLED:!1,DATE_TYPE:1,IS_HIDE_AVERGE_ENABLED:{},CHOSEN_CUST_OPT:[],APP_DESIGNATION:{},APP_DEPARTMENT:{},APP_RATING:null,isApplAllowed:!1,SelCustArr:new Map,isChanged:!1,isCalculate:!1,newDOJ:!0,hikeAmtObj:{},cycle_rating:{},curRule:new Map,empCntArr:new Map,isCycStarted:!1,clone_Rating_Data:{},applObj:{},isBudgetCalc:!1,isBudgetCheck:!1,VIEW_STATUS_PAGE_PERIOD_STATUS:null,IS_VIEW_STATUS_OPENED_FROM_CYCLELISTING:!1,unPublishStIndx:1,unPublishSelConfigId:null,addCycleType:null,showCycleConfiguration:function(){PMSV2Cycle.ISRATINGEDITOPEN=!1;var pageId=settingsPage.container;pageId.html(""),null===PMSV2Cycle.CYCLE_CONFIG_PAGE&&$.ajax({type:"POST",async:!1,url:"/performance/view/cycleConfigurationPageV2",data:{conreqcsr:csrfToken},success:function(resultData){PMSV2Cycle.CYCLE_CONFIG_PAGE=resultData}}),PMSOperation.isCyclelistViewLoaded=!1,PMSOperation.isCyclelistpageLoaded=!1,pageId.html(PMSV2Cycle.CYCLE_CONFIG_PAGE),pageId.find("#hdrLbl").html(ZPI18N.getString("zp.addappraisalcycle")),PMSV2Cycle.load()},isCRBasedCycle:function(cyType){if(void 0!==cyType){if(cyType===PACycle.Constants.CYCLE_TYPE.CR_TEMPLATE_TYPE||cyType===PACycle.Constants.CYCLE_TYPE.CR_CYCLE_TYPE)return!0}else if(null!==PMSV2Cycle.SELECTED_TMPL&&(PMSV2Cycle.SELECTED_TMPL.cycleType===PACycle.Constants.CYCLE_TYPE.CR_TEMPLATE_TYPE||PMSV2Cycle.SELECTED_TMPL.cycleType===PACycle.Constants.CYCLE_TYPE.CR_CYCLE_TYPE))return!0;return!1},getConfigDetails:function(tmplID,cyActionType,cyType){PMSV2Cycle.SELECTED_TMPL=null,PMSV2Cycle.GUIDE_FILE=null,PMSV2Cycle.SELF_FILE=null,PMSV2Cycle.GUIDELINESFILEID=null,PMSV2Cycle.SELFAPPFORMFILEID=null,PMSV2Cycle.EDIT_CYCLE_FLAG=0===cyActionType,PMSV2Cycle.CLONE_CYCLE_FLAG=!1,PMSV2Cycle.isApplAllowed=!1;var params={mode:"getConfigDetails",configId:tmplID,conreqcsr:csrfToken};if(3===cyActionType&&(PMSV2Cycle.CLONE_CYCLE_FLAG=!0,PMSV2Cycle.EDIT_CYCLE_FLAG=!0,params.cycleMode="clone"),params.cyType=cyType,PMSV2Cycle.ALREADY_SEL_VAL=[],$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(resultData){PMSV2Cycle.SELECTED_TMPL=resultData}}),1==cyActionType&&!PMSV2Cycle.isCRBasedCycle(cyType)){var errObj=PMSV2Cycle.isAllowedToApplyTemplate(),error=!1;if(void 0!==errObj.mrFormErr&&errObj.mrFormErr&&(ZPeople.Message.warning(ZPI18N.getString("zp.formmismatch",[PMSSetting.MULTIRATER_DISPLAY_NAME,PMSSetting.MULTIRATER_DISPLAY_NAME])),error=!0),void 0!=errObj.normErr&&errObj.normErr&&(ZPeople.Message.warning(ZPI18N.getString("zp.ratingfielddisablederrorfornormalization")),error=!0),!error&&void 0!=errObj.mrTypeErr&&errObj.mrTypeErr&&(ZPeople.Message.warning(ZPI18N.getString("zp.mrtypedisablemsg")),error=!0),!error&&void 0!=errObj.moduleErr&&errObj.moduleErr&&(ZPeople.Message.warning(ZPI18N.getString("zp.mismatchtemplatemoduleerror")),error=!0),error){let selectDiv="<div>"+('<button onclick="PMSOperation.onClickViewDetail(this);" type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small">'+ZPI18N.getString("zp.viewdetails")+"</button>")+'<button data-action-in-progress="true" onclick="PMSOperation.tmplSelection(this);" type="button" class="zlabel zlabel--blue zlabel--outline zlabel--small">'+ZPI18N.getString("zp.apply")+"</button></div>",pageId=settingsPage.container,li=pageId.find('[tmplid="'+tmplID+'"]');return $(li).removeClass("zpl_act"),$(li).find("#tmplSelDiv").html(selectDiv),pageId.find("#openCycleConfig").attr("disabled","disabled"),!1}}PMSV2Cycle.showCycleConfiguration(),PMSV2Cycle.setTmplValues()},isAllowedToApplyTemplate:function(){var errorObj={},moduleErr=!1,normErr=!1;let mrFormErr=!1;return!PMSV2Cycle.INIT_SETTINGS.isMRFormEnable&&PMSV2Cycle.SELECTED_TMPL.multiRaterEnabled?(mrFormErr=!0,errorObj.mrFormErr=mrFormErr,errorObj):!PMSV2Cycle.isPARatingEnabled&&PMSV2Cycle.SELECTED_TMPL.normalizationEnable?(normErr=!0,errorObj.normErr=normErr,errorObj):void 0!=PMSV2Cycle.mrTypeData&&!PMSV2Cycle.mrTypeData.isMrtypeComEnabled&&PMSV2Cycle.SELECTED_TMPL.mrTypebasedmodule?(errorObj.mrTypeErr=!0,errorObj):(PMSSetting.getSelPerformanceModules(!0),!PMSSetting.SEL_ENABLED_MODULES.GOALS.enable&&(-1!=PMSV2Cycle.SELECTED_TMPL.SA_moduleVal.indexOf("GOALS")||-1!=PMSV2Cycle.SELECTED_TMPL.Reviewer_moduleVal.indexOf("GOALS")||PMSV2Cycle.SELECTED_TMPL.multiRaterEnabled&&-1!=PMSV2Cycle.SELECTED_TMPL.MR_moduleVal.indexOf("GOALS"))&&(moduleErr=!0),!PMSSetting.SEL_ENABLED_MODULES.KRA.enable&&(-1!=PMSV2Cycle.SELECTED_TMPL.SA_moduleVal.indexOf("KRA")||-1!=PMSV2Cycle.SELECTED_TMPL.Reviewer_moduleVal.indexOf("KRA")||PMSV2Cycle.SELECTED_TMPL.multiRaterEnabled&&-1!=PMSV2Cycle.SELECTED_TMPL.MR_moduleVal.indexOf("KRA"))&&(moduleErr=!0),!PMSSetting.SEL_ENABLED_MODULES.KRA_GOALS.enable&&(-1!=PMSV2Cycle.SELECTED_TMPL.SA_moduleVal.indexOf("KRA_GOALS")||-1!=PMSV2Cycle.SELECTED_TMPL.Reviewer_moduleVal.indexOf("KRA_GOALS")||PMSV2Cycle.SELECTED_TMPL.multiRaterEnabled&&-1!=PMSV2Cycle.SELECTED_TMPL.MR_moduleVal.indexOf("KRA_GOALS"))&&(moduleErr=!0),!PMSSetting.SEL_ENABLED_MODULES.QUS_ANS.enable&&(-1!=PMSV2Cycle.SELECTED_TMPL.SA_moduleVal.indexOf("QUS_ANS")||-1!=PMSV2Cycle.SELECTED_TMPL.Reviewer_moduleVal.indexOf("QUS_ANS")||PMSV2Cycle.SELECTED_TMPL.multiRaterEnabled&&-1!=PMSV2Cycle.SELECTED_TMPL.MR_moduleVal.indexOf("QUS_ANS"))&&(moduleErr=!0),errorObj.moduleErr=moduleErr,errorObj)},createCycleFrmPopUp:function(){let pageId=settingsPage.container;pageId.find("#popTmplNme").hasClass("ztextbox__error")&&(pageId.find("#popTmplNme").removeClass("ztextbox__error"),pageId.find("#popTmplNme").parent().find("[elem=errorMsg]").remove()),pageId.find("#popTmplCreBtn").removeAttr("disabled"),PMSV2Cycle.SELECTED_TMPL=null,PMSV2Cycle.CLONE_CYCLE_FLAG=!1,PMSV2Cycle.EDIT_CYCLE_FLAG=!1,PMSV2Cycle.GUIDE_FILE=null,PMSV2Cycle.SELF_FILE=null,PMSV2Cycle.GUIDELINESFILEID=null,PMSV2Cycle.SELFAPPFORMFILEID=null,PMSV2Cycle.IS_SAL_HK_ENABLED=!1,PMSV2Cycle.ALREADY_SEL_VAL=[];let tmplObj={};tmplObj.periodName=pageId.find("#popTmplNme").val(),tmplObj.description=pageId.find("#popTmplDesc").val(),tmplObj.isSelfAppraisalEnabled=pageId.find("#poptmplsaTglBtnFstCrtDiv").hasClass("zpl_act"),tmplObj.multiRaterEnabled=pageId.find("#poptmplmrTglBtnFstCrtDiv").hasClass("zpl_act"),tmplObj.budgetEnable=pageId.find("#poptmplhikeTglBtnFstCrtDiv").hasClass("zpl_act"),tmplObj.normalizationEnable=pageId.find("#poptmplnormTglBtnFstCrtDiv").hasClass("zpl_act"),tmplObj.compidarr=[],tmplObj.cycleRatings={configArr:[]},pageId.find("#tmplPopUpDiv").removeClass("zpl_mopen"),pageId.find("#popTmplCreBtn").attr("disabled",!0),PMSV2Cycle.CHOSEN_CUST_OPT=new Map,PMSV2Cycle.SelCustArr=new Map,PMSV2Cycle.isBudgetCalc=!1,PMSV2Cycle.applObj={},PMSV2Cycle.isChanged=!1,PMSV2Cycle.isCalculate=!1,PMSV2Cycle.newDOJ=!0,PMSV2Cycle.isApplAllowed=!1,PMSV2Cycle.hikeAmtObj={},tmplObj.budgetEnable&&(PMSV2Cycle.IS_SAL_HK_ENABLED=!0),PMSV2Cycle.showCycleConfiguration(),PMSV2Cycle.isApplAllowed=!0,PMSV2Cycle.isCycStarted=!1,PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck(),pageId.find("#reviewApprovalEnable").prop("checked",!1),tmplObj.isSelfAppraisalEnabled?(pageId.find("#saCrt,#saPeriodDiv").show(),pageId.find("#mrSaFldDiv").show(),PMSV2Cycle.postSelTgBtnAction("nwCylsaDetDiv",1),PMSV2Cycle.IS_SELF_ENABLED=!0):(pageId.find("#saCrt,#saPeriodDiv").hide(),pageId.find("#mrSaFldDiv").hide(),PMSV2Cycle.postSelTgBtnAction("nwCylsaDetDiv",0),PMSV2Cycle.IS_SELF_ENABLED=!1),tmplObj.multiRaterEnabled?(pageId.find("#mrCrt,#mrPeriodDiv").show(),PMSV2Cycle.postSelTgBtnAction("nwCylmrDetDiv",1),PMSV2Cycle.IS_MR_ENABLED=!0):(pageId.find("#mrCrt,#mrPeriodDiv").hide(),PMSV2Cycle.postSelTgBtnAction("nwCylmrDetDiv",0),PMSV2Cycle.IS_MR_ENABLED=!1),tmplObj.budgetEnable?(pageId.find("#C_E_hike,#hkPeriodDiv").show(),PMSV2Cycle.postSelTgBtnAction("nwCylhkDetDiv",1),void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource&&pageId.find("#empCurrencyAppliDiv").show(),PMSV2Cycle.budgetResetCalcFunc()):(pageId.find("#C_E_hike,#hkPeriodDiv").hide(),PMSV2Cycle.postSelTgBtnAction("nwCylhkDetDiv",0),PMSV2Cycle.IS_SAL_HK_ENABLED=!1),tmplObj.normalizationEnable&&PMSV2Cycle.isPARatingEnabled?(pageId.find("#C_E_normalisation,#nrmPeriodDiv").show(),PMSV2Cycle.postSelTgBtnAction("nwCylnrmDetDiv",1),PMSV2Cycle.IS_NORM_ENABLED=!0):(pageId.find("#C_E_normalisation,#nrmPeriodDiv").hide(),PMSV2Cycle.postSelTgBtnAction("nwCylnrmDetDiv",0),PMSV2Cycle.IS_NORM_ENABLED=!1),PMSV2Cycle.getCourseTabDetails()},budgetResetCalcFunc:function(){let pageId=settingsPage.container;PMSV2Cycle.getNewCycleBudgetDetails();var budgetData=PMSTmpl.BUDGET_CONFIG_DATA,totalAmt=Number(budgetData.totalcalcHikeAmount)+Number(budgetData.totalAmount);pageId.find("#totalAmountAfterHike").text(parseFloat(totalAmt).toFixed(2)),pageId.find("#totalAmount").text(parseFloat(totalAmt).toFixed(2)),pageId.find("#totalEmpCnt").text(budgetData.totalEmpCnt),pageId.find("#hikePercentage").val(parseFloat(budgetData.hikePercentage)),pageId.find("#totAmountView").text(parseFloat(budgetData.totalcalcHikeAmount).toFixed(2)),PMSV2Cycle.isBudgetCalc=!1,PMSV2Cycle.hikeAmtArr={},PMSV2Cycle.SelCustArr=new Map,PMSV2Cycle.isChanged=!1,PMSV2Cycle.curRule=new Map,void 0!=PMSV2Cycle.applObj.designation&&0!=PMSV2Cycle.applObj.designation.length?PMSV2Cycle.APP_DESIGNATION=PMSV2Cycle.applObj.designation:PMSV2Cycle.APP_DESIGNATION=Object.keys(PMSTmpl.DESIGNATION_LIST),void 0!=PMSV2Cycle.applObj.department&&0!=PMSV2Cycle.applObj.department.length?PMSV2Cycle.APP_DEPARTMENT=PMSV2Cycle.applObj.department:PMSV2Cycle.APP_DEPARTMENT=Object.keys(PMSTmpl.DEPARTMENT_LIST)},load:function(){performance.now();var pageId=settingsPage.container;appsettingsadmin?pageId.find(".PI_widgt_custm").addClass("zpl_DNI"):pageId.find(".PI_widgt_custm").removeClass("zpl_DNI"),ZPeopleComponents.select(pageId.find(".select-js"),{dropdownList:{appendTo:pageId,fitForElement:!0}}),PMSV2Cycle.isCRBasedCycle()?(PMSV2Cycle.LEFT_TAB_ARRAY=["nwCylbasicDetDiv","nwCylAppliDiv","nwCylsaDetDiv_hide","nwCylpaDetDiv","nwCylratingDetDiv","nwCylpubDetDiv","nwCylPeriodDiv"],PMSV2Cycle.LEFT_TAB_K_V={nwCylbasicDetDiv:ZPI18N.getString("zp.basicdetails"),nwCylAppliDiv:ZPI18N.getString("zp.applicability"),nwCylsaDetDiv:ZPI18N.getString("zp.selfappraisal"),nwCylpaDetDiv:ZPI18N.getString("zp.reviewerreview"),nwCylratingDetDiv:ZPI18N.getString("zp.lms.reports.rating"),nwCylpubDetDiv:ZPI18N.getString("zp.publishconfiguration"),nwCylPeriodDiv:ZPI18N.getString("zp.cycle.periodconfig")}):(PMSV2Cycle.LEFT_TAB_ARRAY=["nwCylbasicDetDiv","nwCylAppliDiv","nwCylsaDetDiv_hide","nwCylmrDetDiv_hide","nwCylpaDetDiv","nwCylcourseDetDiv_hide","nwCylratingDetDiv","nwCylnrmDetDiv_hide","nwCylhkDetDiv_hide","nwCylpubDetDiv","nwCylAppraisalLetterDiv_hide","nwCylPeriodDiv"],PMSV2Cycle.LEFT_TAB_K_V={nwCylbasicDetDiv:ZPI18N.getString("zp.basicdetails"),nwCylAppliDiv:ZPI18N.getString("zp.applicability"),nwCylsaDetDiv:ZPI18N.getString("zp.selfappraisal"),nwCylmrDetDiv:PMSV2Cycle.multiraterName,nwCylpaDetDiv:ZPI18N.getString("zp.reviewerreview"),nwCylcourseDetDiv:ZPI18N.getString("zp.lms.course"),nwCylratingDetDiv:ZPI18N.getString("zp.lms.reports.rating"),nwCylnrmDetDiv:ZPI18N.getString("zp.normalization"),nwCylhkDetDiv:PMSV2Cycle.SALARYHIKENAME,nwCylpubDetDiv:ZPI18N.getString("zp.publishconfiguration"),nwCylAppraisalLetterDiv:ZPI18N.getString("zp.paesign.appraisalletterandesign"),nwCylPeriodDiv:ZPI18N.getString("zp.cycle.periodconfig")}),PMSV2Cycle.leftTabConstruct(),PMSV2Cycle.prerequisiteData(!0),PMSV2Cycle.registerActions(),PMSV2Cycle.defaultOption(),PMSV2Cycle.buildQuantitativeParam(),PMSV2Cycle.isCRBasedCycle()?(pageId.find("#nwCylratingDetDiv #nwCylratingSecHdr").text(ZPI18N.getString("zp.cycle.ratings.employeeratings2")),pageId.find("#nwCylratingDetDiv #nwCylratingSecDesc").text(ZPI18N.getString("zp.cycle.ratings.employeeratingsdesc2"))):(PMSV2Cycle.constructModWgt(),pageId.find("#nwCylratingDetDiv #nwCylratingSecHdr").text(ZPI18N.getString("zp.cycle.ratings.employeeratings")),pageId.find("#nwCylratingDetDiv #nwCylratingSecDesc").text(ZPI18N.getString("zp.cycle.ratings.employeeratingsdesc"))),PMSV2Cycle.constructRatingSection(),PMSV2Cycle.rtgAction(),pageId.find("#cycleRevSelectionDiv").html(ZPA_Approval.ContainerBody.APPROVER),ZPA_Approvers.formfield=void 0,void 0!==PMSV2Cycle.INIT_SETTINGS&&void 0!==PMSV2Cycle.INIT_SETTINGS.emplookup&&Object.keys(PMSV2Cycle.INIT_SETTINGS.emplookup).length>0&&(ZPA_Approvers.formfield=[],$.each(PMSV2Cycle.INIT_SETTINGS.emplookup,function(key,value){var formfield={};formfield.id=key,formfield.displayName=value,ZPA_Approvers.formfield.push(formfield)})),ZPA_Approvers.reset(),pageId.find("#add_level .zpl_lnkbg").html(ZPI18N.getString("zp.addcomponents",[ZPI18N.getString("zp.reviewerlevel")]));let chdLen=pageId.find("#cycleRevSelectionDiv").find("#approver_body").children();if(chdLen.length>0&&$(chdLen[0]).find(".zpl_rwicn").attr("style","opacity: 0;"),$(pageId.find(".togbutton-js")).ztoggleswitch({size:"medium"}),!PMSV2Cycle.isCRBasedCycle()){let timeFormat=Calendar.is12HrFormat()?"hh:mm tt":"HH:mm",dTimeObj={format:dateFmt+" "+timeFormat,clearButton:"focus",calendarIcon:!0,calendarIconClassName:"ztextbox__icon PI_monthly"};ZPeopleComponents.datetimefield("#cyHkPushID",dTimeObj)}var effectiveDateOptions={calendarIcon:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none",pickerclose:PMSV2Cycle.booleanDOJBudgetCheck};ZPeopleComponents.datefield(pageId.find("#dojVal1"),effectiveDateOptions),pageId.find("#dojVal1-container .zinputfield__textbox").attr("style","width:190px;"),PMSV2Cycle.dateRangeInitialization();let ids=[];(ids=PMSV2Cycle.isCRBasedCycle()?["#saRQMdtDiv","#paRQMdtDiv"]:["#saQntParmDiv","#mrQntParmDiv","#paQntParmDiv","#saRQMdtDiv","#mrRQMdtDiv","#mrTypeDiv","#paRQMdtDiv","#mrSelTypeDiv","#modWgtSecDiv"]).length>0&&ids.forEach(id=>{if(pageId.find(id).hasClass("disabled")){pageId.find(id).find("[role=switch]").css("pointer-events","none")}}),PMSOperationCommon.focus(pageId.find("#cycleName")),PMSV2Cycle.ESign.constructEsignFlow()},booleanDOJBudgetCheck:function(event,edata){PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck(),PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(event):PMSV2Cycle.onChangeApplicableFields(event)},destroyCyclePageComponents:function(){var pageId=settingsPage.container;pageId.find("#dojKey").length>0&&ZPeopleComponents.select(pageId.find("#dojKey")).destroy(),pageId.find("#dojCrt").length>0&&ZPeopleComponents.select(pageId.find("#dojCrt")).destroy(),pageId.find("#dojCrt_2").length>0&&ZPeopleComponents.select(pageId.find("#dojCrt_2")).destroy(),ZPeopleComponents.isComponent(pageId.find("#dojMthVal"))&&ZPeopleComponents.select(pageId.find("#dojMthVal")).destroy(),ZPeopleComponents.isComponent(pageId.find("#dojMthVal_2"))&&ZPeopleComponents.select(pageId.find("#dojMthVal_2")).destroy(),pageId.find("select[type=keyFld]").each(function(){ZPeopleComponents.select($(this)).destroy()}),pageId.find("select[type=crtFld]").each(function(){ZPeopleComponents.select($(this)).destroy()}),pageId.find("select[type=valFld]").each(function(){ZPeopleComponents.select($(this)).destroy()}),pageId.find("#customDateAppliDiv").length>0&&(ZPeopleComponents.select(pageId.find("#cstKey")).destroy(),ZPeopleComponents.select(pageId.find("#cstCrt")).destroy(),ZPeopleComponents.isComponent(pageId.find("#cstMthVal"))&&ZPeopleComponents.select(pageId.find("#cstMthVal")).destroy()),pageId.find("#totalWrkExpAppliDiv").length>0&&(ZPeopleComponents.select(pageId.find("#expKey")).destroy(),ZPeopleComponents.select(pageId.find("#expCrt")).destroy()),pageId.find("#appliMenuList").length>0&&ZPeopleComponents.menu("#appliMenuList").destroy(),$("#appliMenuList").remove(),pageId.find("#mrTypeSelID").length>0&&ZPeopleComponents.select(pageId.find("#mrTypeSelID")).destroy(),pageId.find("#ratingType").length>0&&ZPeopleComponents.select(pageId.find("#ratingType")).destroy(),pageId.find("#ratingNoOfDigits").length>0&&ZPeopleComponents.select(pageId.find("#ratingNoOfDigits")).destroy(),pageId.find("#appCurrSelID").length>0&&ZPeopleComponents.select(pageId.find("#appCurrSelID")).destroy(),pageId.find("#hkApprSel").length>0&&ZPeopleComponents.select(pageId.find("#hkApprSel")).destroy(),pageId.find("#hkBsdOn").length>0&&ZPeopleComponents.select(pageId.find("#hkBsdOn")).destroy(),ZPeopleComponents.isComponent(pageId.find("#hkFldType"))&&ZPeopleComponents.select(pageId.find("#hkFldType")).destroy(),pageId.find("#chooseCustOpt").length>0&&ZPeopleComponents.tokenfield(pageId.find("#chooseCustOpt")).destroy(),pageId.find("#custRules").length>0&&($("#custRules select").each(function(){ZPeopleComponents.select($(this)).destroy()}),$("#custRules textarea").each(function(){ZPeopleComponents.tokenfield($(this)).destroy()})),pageId.find("#pubAuthID").length>0&&ZPeopleComponents.tokenfield(pageId.find("#pubAuthID")).destroy(),pageId.find("#fldToPubID").length>0&&ZPeopleComponents.tokenfield(pageId.find("#fldToPubID")).destroy(),ZPeopleComponents.isComponent(pageId.find("#esignMailMergeselect"))&&ZPeopleComponents.select(pageId.find("#esignMailMergeselect")).destroy();let elements=pageId.find("[name=apprEsignrecp_row]");for(var i=0;i<elements.length;i++){let element=elements[i],rowNum=$(element).attr("number"),signGrpId="apprEsignrecpFormValue_"+rowNum,signerSelectId="apprEsign_Signer"+rowNum+"select";ZPeopleComponents.isComponent(pageId.find("#"+signGrpId))&&ZPeopleComponents.select(pageId.find("#"+signGrpId)).destroy(),ZPeopleComponents.isComponent(pageId.find("#"+signerSelectId))&&ZPeopleComponents.select(pageId.find("#"+signerSelectId)).destroy()}},pageClose:function(){PMSV2Cycle.isCycleAddEditPageValueChangedInit(PMSV2Cycle.cyclePageClose)},cyclePageClose:function(){PMSV2Cycle.EDIT_CYCLE_FLAG?PMSV2Cycle.afterSave(null):(PMSV2Cycle.destroyCyclePageComponents(),PMSOperation.getChooseTmplPage())},prerequisiteData:function(refresh){PMSSetting.getSelPerformanceModules(refresh),null===PMSV2Cycle.INIT_SETTINGS&&$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"initCycle",conreqcsr:csrfToken},success:function(data){PMSV2Cycle.INIT_SETTINGS=data}});let appraisalFlds=PMSV2Cycle.INIT_SETTINGS.getappraisalfields,rtgEndInfo=PMSV2Cycle.INIT_SETTINGS.getRatingEnabledInfo,initData=PMSV2Cycle.INIT_SETTINGS.initSettings;void 0!=appraisalFlds.appraisalfields&&appraisalFlds.appraisalfields.length>0&&(PMSV2Cycle.appraisalfields=appraisalFlds.appraisalfields),void 0!=appraisalFlds.patabularfield&&appraisalFlds.patabularfield.length>0&&(PMSV2Cycle.APPRAISALTABULARFIELDS=appraisalFlds.patabularfield),void 0!=appraisalFlds.multiraterfields&&appraisalFlds.multiraterfields.length>0&&(PMSV2Cycle.multiraterfields=appraisalFlds.multiraterfields),void 0!=appraisalFlds.userRating&&(PMSV2Cycle.userRatingComponent=appraisalFlds.userRating),void 0!=appraisalFlds.managerRating&&(PMSV2Cycle.managerRatingComponent=appraisalFlds.managerRating),void 0!=appraisalFlds.mrtypes&&(PMSV2Cycle.mrtypes=appraisalFlds.mrtypes,PMSV2Cycle.mrtypes[1]=PMSV2Cycle.multiraterName),void 0!=appraisalFlds.compensation&&(PMSV2Cycle.compensationData=appraisalFlds.compensation),PMSV2Cycle.HIKE_EMP_LOOKUPS=appraisalFlds.empLookUps,PMSV2Cycle.moduleRatingType=appraisalFlds.moduleRatingType,PMSV2Cycle.mrTypeData=appraisalFlds.mrTypeData,PMSV2Cycle.isSARatingEnabled=rtgEndInfo.SARatingEnabled,PMSV2Cycle.isPARatingEnabled=rtgEndInfo.PARatingEnabled,PMSV2Cycle.IS_FINALSCORE_ENABLED=rtgEndInfo.finalScoreCardEnabled,initData.multiraterDetails&&(PMSV2Cycle.mrTemplateId=initData.multiraterDetails.mrFormId,PMSV2Cycle.mrApprFormId=initData.multiraterDetails.mrApprFormId,PMSV2Cycle.isMR_apprConf=initData.multiraterDetails.isMR_apprConf),initData.BudgetSpliupSheetApprovalDetails&&(PMSV2Cycle.budgetSpliupSheetApprovalFormId=initData.BudgetSpliupSheetApprovalDetails.BudgetSplitupFormId,PMSV2Cycle.teamBudgetFormName=initData.BudgetSpliupSheetApprovalDetails.formName,PMSV2Cycle.isBudget_apprConf=initData.BudgetSpliupSheetApprovalDetails.isBudget_apprConf,void 0!==initData.BudgetSpliupSheetApprovalDetails.approvalID&&(PMSV2Cycle.teamBudgetApprID=initData.BudgetSpliupSheetApprovalDetails.approvalID)),PMSV2Cycle.ALL_LOCATIONS=initData.locationList,PMSV2Cycle.ALL_ROLES=initData.roleList,PMSV2Cycle.customDateFCID=initData.customDateFCID,PMSV2Cycle.ALL_DEPARTMENTS=initData.departmentList,PMSV2Cycle.ALL_DESIGNATION=initData.designationlist,PMSV2Cycle.isLevelEnabled=initData.isLevelEnabled,initData.isLevelEnabled&&(PMSV2Cycle.ALL_LEVELS=initData.designationLevelList),PMSV2Cycle.ALL_EMPTYPES=initData.employeeTypeList,PMSV2Cycle.IS_COURSE_ENABLE=initData.courseIntegration,PMSOperation.notSelectedApplicableKeys=["location","role","department","level","customDate","totalWrkExp"],PMSV2Cycle.isLevelEnabled||PMSOperation.notSelectedApplicableKeys.splice(PMSOperation.notSelectedApplicableKeys.indexOf("level"),1),void 0!=PMSV2Cycle.INIT_SETTINGS.initSettings.dateOfConfirmFCID&&Object.keys(PMSV2Cycle.INIT_SETTINGS.initSettings.dateOfConfirmFCID).length>0&&(PMSV2Cycle.IS_DATE_OF_CONFIRMATION_ENABLED=!0),PMSESign.initEsignSetting()},getFormApprovalDetails:function(){$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"isMRApprEnabled",conreqcsr:csrfToken},success:function(data){data.isMRApprEnabled?PMSV2Cycle.isMR_apprConf=!0:PMSV2Cycle.isMR_apprConf=!1,PMSV2Cycle.review_ApprConf=data.review_AppConf,void 0!==data.budgetApprDetails&&(PMSV2Cycle.budgetSpliupSheetApprovalFormId=data.budgetApprDetails.BudgetSplitupFormId,PMSV2Cycle.teamBudgetFormName=data.budgetApprDetails.formName,PMSV2Cycle.isBudget_apprConf=data.budgetApprDetails.isBudget_apprConf,void 0!==data.budgetApprDetails.approvalID&&(PMSV2Cycle.teamBudgetApprID=data.budgetApprDetails.approvalID)),void 0!=data.compensation&&(PMSV2Cycle.compensationData=data.compensation)}})},dateRangeInitialization:function(){performance.now();var pageId=settingsPage.container;let tmplVal=PMSV2Cycle.SELECTED_TMPL,isCycleEdit=PMSV2Cycle.EDIT_CYCLE_FLAG;ZPeopleComponents.daterangepicker("#cyPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyclePeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt,fromValue:isCycleEdit?tmplVal.cyclefromdate:"",toValue:isCycleEdit?tmplVal.cycletoDate:""});var picker=pageId.find("#cyPrdPicker");pageId.find("#cyclePeriodID, #cyclePeriodID_Icon").on("click",function(){pageId.find("#cyPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker).close():ZPeopleComponents.daterangepicker(picker).open()}),ZPeopleComponents.daterangepicker("#cyPPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyPPeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker1=pageId.find("#cyPPrdPicker");pageId.find("#cyPPeriodID, #cyPPeriodID_Icon").on("click",function(){pageId.find("#cyPPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker1).close():ZPeopleComponents.daterangepicker(picker1).open()}),ZPeopleComponents.daterangepicker("#cyRPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyRPeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker2=pageId.find("#cyRPrdPicker");pageId.find("#cyRPeriodID,#cyRPeriodID_Icon").on("click",function(){pageId.find("#cyRPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker2).close():ZPeopleComponents.daterangepicker(picker2).open()}),ZPeopleComponents.daterangepicker("#cySAPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cySAPeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker3=pageId.find("#cySAPrdPicker");pageId.find("#cySAPeriodID,#cySAPeriodID_Icon").on("click",function(){pageId.find("#cySAPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker3).close():ZPeopleComponents.daterangepicker(picker3).open()}),ZPeopleComponents.daterangepicker("#cyMRSelPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyMRSelPeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker4=pageId.find("#cyMRSelPrdPicker");pageId.find("#cyMRSelPeriodID,#cyMRSelPeriodID_Icon").on("click",function(){pageId.find("#cyMRSelPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker4).close():ZPeopleComponents.daterangepicker(picker4).open()}),ZPeopleComponents.daterangepicker("#cyMRFdBkPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyMRFdBkPeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker5=pageId.find("#cyMRFdBkPrdPicker");pageId.find("#cyMRFdBkPeriodID,#cyMRFdBkPeriodID_Icon").on("click",function(){pageId.find("#cyMRFdBkPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker5).close():ZPeopleComponents.daterangepicker(picker5).open()}),ZPeopleComponents.daterangepicker("#cyHkPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyHkPeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker6=pageId.find("#cyHkPrdPicker");pageId.find("#cyHkPeriodID,#cyHkPeriodID_Icon").on("click",function(){pageId.find("#cyHkPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker6).close():ZPeopleComponents.daterangepicker(picker6).open()}),ZPeopleComponents.daterangepicker("#cyNrmPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyNrmPeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker7=pageId.find("#cyNrmPrdPicker");pageId.find("#cyNrmPeriodID,#cyNrmPeriodID_Icon").on("click",function(){pageId.find("#cyNrmPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker7).close():ZPeopleComponents.daterangepicker(picker7).open()}),ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyMnlPubPeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker8=pageId.find("#cyMnlPubPrdPicker");pageId.find("#cyMnlPubPeriodID,#cyMnlPubPeriodID_Icon").on("click",function(){pageId.find("#cyMnlPubPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker8).close():ZPeopleComponents.daterangepicker(picker8).open()})},registerActions:function(){performance.now();var pageId=settingsPage.container;ZPeopleComponents.toggleswitch(pageId.find("#saModRtDetID")).setAttributes({change:PMSV2Cycle.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#mrModRtDetID")).setAttributes({change:PMSV2Cycle.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#paModRtDetID")).setAttributes({change:PMSV2Cycle.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#saRQID")).setAttributes({change:PMSV2Cycle.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#mrRQID")).setAttributes({change:PMSV2Cycle.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#mrTypeID")).setAttributes({change:PMSV2Cycle.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#paRQID")).setAttributes({change:PMSV2Cycle.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#mrAutoPopulate")).setAttributes({change:PMSV2Cycle.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#setModWgtID")).setAttributes({change:PMSV2Cycle.showDisabledTgBtnAction}),PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck();let appliMenu=ZPeopleComponents.menu(pageId.find("#appliMenuList"),{forElement:pageId.find("#appliAddButton"),appendTo:pageId,itemclick:e=>{PMSV2Cycle.addApplicableCriteria(e)}});pageId.find("#appliAddButton").on("click",function(ev){appliMenu.show()}),pageId.find("#addCriDiv_DOJ").on("click",function(e){PMSV2Cycle.addDateOfApplicableCriteria(e)}),pageId.find("#dojAppliDiv #dojCrt").on("zselectchange",function(event,eData){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(eData):(PMSOperation.onDojCrtSelect(eData),PMSV2Cycle.onChangeApplicableFields(eData))});var effectiveDateOptions={calendarIcon:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none",pickerclose:PMSV2Cycle.booleanDOJBudgetCheck};ZPeopleComponents.datefield(pageId.find("#dojVal1_2"),effectiveDateOptions),pageId.find("#dojVal1_2-container .zinputfield__textbox").attr("style","width:190px;"),pageId.find("#dojAppliDiv_2 #dojCrt_2").on("zselectchange",function(event,eData){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(eData):(PMSOperation.onDojCrtSelect(eData),PMSV2Cycle.onChangeApplicableFields(eData))}),pageId.find("#dojKey").on("zselectchange",function(event,eData){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(eData):(PMSOperation.onDateTypeSelect(eData),PMSV2Cycle.onChangeApplicableFields(eData))}),pageId.find("#ratingType").on("zselectchange",function(event,eData){PMSV2Cycle.onRatingTypeAction(eData)}),pageId.find("#ratingNoOfDigits").on("zselectchange",function(event,eData){PMSV2Cycle.onRatingTypeAction(eData)}),pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction(),pageId.find("#hkFldType").on("zselectchange",function(event,eData){PMSV2Cycle.changeRuleType(eData)}),pageId.find("[name=pubMtd]").unbind("click"),pageId.find("[name=pubMtd]").bind("click",function(){PMSV2Cycle.onPublishMethodAction()}),pageId.find("[name=mrSelRdBx]").unbind("click"),pageId.find("[name=mrSelRdBx]").bind("click",function(){pageId.find('#mrEmpRepToSecDiv [elem="errorMsg"]').remove(),"2"===pageId.find("[name=mrSelRdBx]:checked").attr("value")?pageId.find("[hide=mrEmpSel]").hide():pageId.find("[hide=mrEmpSel]").show()})},defaultOption:function(){performance.now();var pageId=settingsPage.container;pageId.find("#saModRtDetID").ztoggleswitch("switchOff"),pageId.find("#saQntParmDiv").addClass("disabled"),pageId.find("#mrModRtDetID").ztoggleswitch("switchOff"),pageId.find("#mrQntParmDiv").addClass("disabled"),pageId.find("#paModRtDetID").ztoggleswitch("switchOff"),pageId.find("#paQntParmDiv").addClass("disabled"),pageId.find("#saRQID").ztoggleswitch("switchOff"),pageId.find("#saRQMdtDiv").addClass("disabled"),pageId.find("#mrRQID").ztoggleswitch("switchOff"),pageId.find("#mrRQMdtDiv").addClass("disabled"),pageId.find("#mrTypeID").ztoggleswitch("switchOff"),pageId.find("#mrTypeDiv").addClass("disabled"),pageId.find("#paRQID").ztoggleswitch("switchOff"),pageId.find("#paRQMdtDiv").addClass("disabled"),pageId.find("#mrAutoPopulate").ztoggleswitch("switchOff"),pageId.find("#mrSelTypeDiv").addClass("disabled"),pageId.find("#setModWgtID").ztoggleswitch("switchOff"),pageId.find("#modWgtSecDiv").addClass("disabled"),PMSV2Cycle.IS_DATE_OF_CONFIRMATION_ENABLED?1==ZPeopleComponents.select($("#dojKey")).getOptions().length&&ZPeopleComponents.select(pageId.find("#dojKey")).addOption([{value:2,label:ZPI18N.getString("zp.dateofconfirmation")}]):ZPeopleComponents.select(pageId.find("#dojKey")).removeOption([2]);var selOpt1=pageId.find("#mrTypeSelID");selOpt1.empty(),selOpt1.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),Object.keys(PMSV2Cycle.mrtypes).length>1&&$.each(PMSV2Cycle.mrtypes,function(key,value){1!=key&&selOpt1.append(jQuery("<option />",{value:key,id:key}).html(value))}),ZPeopleComponents.select(selOpt1,{dropdownList:{appendTo:pageId,fitForElement:!0}});let selOpt=pageId.find("#cycleAppliDiv_nw #empTypeAppliDiv select[type=valFld]");selOpt.empty(),$.each(PMSV2Cycle.ALL_EMPTYPES,function(key,value){selOpt.append(jQuery("<option />",{value:value.typeId,id:value.typeId}).html(value.typeName))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.allEmpTypes")}),selOpt.attr("keySel","APPL_EMPTYPE"),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)}),PMSV2Cycle.applObj.empType=[],(selOpt=pageId.find("#cycleAppliDiv_nw #designationAppliDiv select[type=valFld]")).empty(),$.each(PMSV2Cycle.ALL_DESIGNATION,function(key,value){selOpt.append(jQuery("<option />",{value:value.desId,id:value.desId}).html(value.desName))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.alldesignation")}),selOpt.attr("keySel","APPL_DES"),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)}),PMSV2Cycle.applObj.designation=[],pageId.find("#mrEmpRepToRdBx").prop("checked",!0),"2"===pageId.find("[name=mrSelRdBx]:checked").attr("value")?pageId.find("[hide=mrEmpSel]").hide():pageId.find("[hide=mrEmpSel]").show(),(selOpt=pageId.find("#hkApprSel")).empty(),selOpt.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),$.each(PMSV2Cycle.HIKE_EMP_LOOKUPS,function(key,value){selOpt.append(jQuery("<option />",{value:key,id:key}).html(value))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),(selOpt=pageId.find("#appCurrSelID")).empty(),void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?(selOpt.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),$.each(PMSV2Cycle.compensationData.config_currencies,function(key,value){selOpt.append(jQuery("<option />",{value:value.currencyid,id:value.currencyid}).html(value.currencystring))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)}),PMSV2Cycle.applObj.empCurrency=[]):pageId.find("#empCurrencyAppliDiv").hide(),pageId.find("#enablehikedeviation").prop("checked",!1),PMSV2Cycle.showHikedeviation(),PMSV2Cycle.pubRtgAllower(),PMSV2Cycle.fldToPublish()},pubRtgAllower:function(){let pageId=settingsPage.container,publisherFinalizer=null!==PMSV2Cycle.SELECTED_TMPL&&PMSV2Cycle.SELECTED_TMPL.publisherFinalizer,publisherRM=null!==PMSV2Cycle.SELECTED_TMPL&&PMSV2Cycle.SELECTED_TMPL.publisherRM,selLst=[];var pubAuth=pageId.find("#pubAuthID");pubAuth.empty();var dataObj={},optLst=[],optObj={};optObj.name=ZPI18N.getString("zp.reportingmanager"),optObj.id="2",optLst.push(optObj),publisherRM&&selLst.push(optObj),(optObj={}).name=ZPI18N.getString("zp.finalizer"),optObj.id="3",optLst.push(optObj),publisherFinalizer&&selLst.push(optObj),dataObj.data=optLst,dataObj.contentType="text",dataObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},dataObj.search={by:"name"},dataObj.allowDuplicateValues=!1,dataObj.values=selLst,dataObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield(pubAuth,dataObj)},fldToPublish:function(){var appfield_ele=settingsPage.container.find("#fldToPubID");if(ZPeopleComponents.isComponent(appfield_ele)){PMSV2Cycle.ALREADY_SEL_VAL=[];let alreadySelVal=ZPeopleComponents.tokenfield(appfield_ele).getAllValues();if(alreadySelVal.length>0)for(var i in alreadySelVal)PMSV2Cycle.ALREADY_SEL_VAL.push(alreadySelVal[i].id);ZPeopleComponents.tokenfield(appfield_ele).destroy()}appfield_ele.html("");var optLst=[],selLst=[];let grpNme=ZPI18N.getString("zp.perfapprfield"),selArrID=null!==PMSV2Cycle.SELECTED_TMPL?PMSV2Cycle.SELECTED_TMPL.compidarr:[];if(PMSV2Cycle.ALREADY_SEL_VAL.length>0)for(var i in PMSV2Cycle.ALREADY_SEL_VAL)selArrID.push(PMSV2Cycle.ALREADY_SEL_VAL[i]);let rtgAdded=!1;if($.each(PMSV2Cycle.appraisalfields,function(ind,val){if("USERERECNO"!=val.comp_columnname){let optObj={};optObj.name=val.comp_dispname,optObj.id=val.comp_id,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(val.comp_id)&&("RATINGID"==val.comp_columnname&&(rtgAdded=!0),selLst.push(optObj))}if(null!==PMSV2Cycle.SELECTED_TMPL&&-1==selArrID.indexOf(val.comp_id)&&(rtgAdded=!0),!rtgAdded&&"RATINGID"==val.comp_columnname){let optObj={};optObj.name=val.comp_dispname,optObj.id=val.comp_id,optObj.grpnme=grpNme,-1===selLst.indexOf(val.comp_id)&&selLst.push(optObj)}}),null!==PMSV2Cycle.APPRAISALTABULARFIELDS&&PMSV2Cycle.APPRAISALTABULARFIELDS.length>0&&$.each(PMSV2Cycle.APPRAISALTABULARFIELDS,function(index,data){let grpNme=data.secName;$.each(data.compDetails,function(index,comData){let optObj={};optObj.name=comData.comp_dispname,optObj.id=comData.comp_id,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(comData.comp_id)&&selLst.push(optObj)})}),PMSV2Cycle.IS_MR_ENABLED){let grpNme=ZPI18N.getString("zp.mrfield",[ZPeople.decodeTxt(PMSV2Cycle.multiraterName)]);$.each(PMSV2Cycle.multiraterfields,function(ind,val){if("MODIFIEDBY"!=val.comp_columnname&&"MODIFIEDTIME"!=val.comp_columnname&&"FEEDBACK_STATUS"!=val.comp_columnname&&"OWNER"!=val.comp_columnname&&"CREATEDTIME"!=val.comp_columnname&&"DESCRIPTION"!=val.comp_columnname){let optObj={};optObj.name=val.comp_dispname,optObj.id=val.comp_id,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(val.comp_id)&&selLst.push(optObj)}})}let tySelRtgObj=PMSV2Cycle.getModWgtRtgCmtCntObj(!0),isSelfRtg=!1,isMrRtg=!1,isPaRtg=!1;if(void 0!==tySelRtgObj&&(void 0!==tySelRtgObj.sa&&(tySelRtgObj.sa.modCnt>0&&(tySelRtgObj.sa.modRtgCnt>0||tySelRtgObj.sa.modCmtCnt>0)||void 0!==tySelRtgObj.sa.QusAns&&tySelRtgObj.sa.QusAns)&&(isSelfRtg=!0),void 0!==tySelRtgObj.mr&&(tySelRtgObj.mr.modCnt>0&&(tySelRtgObj.mr.modRtgCnt>0||tySelRtgObj.mr.modCmtCnt>0)||void 0!==tySelRtgObj.mr.QusAns&&tySelRtgObj.mr.QusAns)&&(isMrRtg=!0),void 0!==tySelRtgObj.pa&&(tySelRtgObj.pa.modCnt>0&&(tySelRtgObj.pa.modRtgCnt>0||tySelRtgObj.pa.modCmtCnt>0)||void 0!==tySelRtgObj.pa.QusAns&&tySelRtgObj.pa.QusAns)&&(isPaRtg=!0)),isSelfRtg||isMrRtg||isPaRtg){if(grpNme=ZPI18N.getString("zp.moduleratings"),void 0!=PMSV2Cycle.userRatingComponent&&isSelfRtg){let optObj={};optObj.name=ZPI18N.getString("zp.userrating"),optObj.id=PMSV2Cycle.userRatingComponent.comp_id,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(PMSV2Cycle.userRatingComponent.comp_id)&&selLst.push(optObj)}if(void 0!=PMSV2Cycle.managerRatingComponent){let typeArr=null!==PMSV2Cycle.SELECTED_TMPL?PMSV2Cycle.SELECTED_TMPL.typearr:[];if(typeArr.length>0)for(var i in typeArr)selArrID.push(parseInt(typeArr[i]));if(isMrRtg){let optObj={};optObj.name=ZPI18N.getString("zp.raterRating"),optObj.id=1,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(1)&&selLst.push(optObj),(optObj={}).name=ZPI18N.getString("zp.ratercomment"),optObj.id=4,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(4)&&selLst.push(optObj)}if(isPaRtg){let optObj={};if(!PMSV2Cycle.isCRBasedCycle()&&(optObj.name=ZPI18N.getString("zp.reviewRating"),optObj.id=2,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(2))){selLst.push(optObj);let finScrObj={};finScrObj.name=ZPI18N.getString("zp.fnlReviewScorecard"),finScrObj.id=3,finScrObj.grpnme=ZPI18N.getString("zp.moduleratings"),optLst.push(finScrObj),-1!==selArrID.indexOf(3)&&selLst.push(finScrObj)}(optObj={}).name=ZPI18N.getString("zp.reviewcomment"),optObj.id=5,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(5)&&selLst.push(optObj)}}}if(PMSV2Cycle.isCRBasedCycle()){let optObj={};optObj.name=ZPI18N.getString("zp.crreviewdata"),optObj.id=6,optObj.grpnme=ZPI18N.getString("zp.moduleratings"),optLst.push(optObj);let typeArr=null!==PMSV2Cycle.SELECTED_TMPL?PMSV2Cycle.SELECTED_TMPL.typearr:[];typeArr.length>0&&-1!==typeArr.indexOf("6")&&-1===selArrID.indexOf(6)&&selArrID.push(6),-1!==selArrID.indexOf(6)&&selLst.push(optObj)}dataObj={},dataObj.data=optLst,dataObj.contentType="text",dataObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name",groupLabel:"grpnme"},dataObj.search={by:"name"},dataObj.allowDuplicateValues=!1,dataObj.values=selLst,dataObj.dropdownList={itemType:"checkbox",isTextHTMLEncoded:!0},dataObj.isLabelHTMLEncoded=!0,dataObj.tokenadd=PMSV2Cycle.onUpdatefldToPublish,dataObj.tokenremove=PMSV2Cycle.onUpdatefldToPublish,ZPeopleComponents.tokenfield(appfield_ele,dataObj)},onUpdatefldToPublish:function(event){var appfield_ele=settingsPage.container.find("#fldToPubID");let selPubFieldsIds=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(appfield_ele).getAllValues()),optsData=ZPeopleComponents.tokenfield("#fldToPubID").getAttributes().data,scoreCardIndex=optsData.findIndex(opts=>3==opts.id);if(-1==scoreCardIndex&&-1!=selPubFieldsIds.indexOf(2)){let optObj={};optObj.name=ZPI18N.getString("zp.fnlReviewScorecard"),optObj.id=3,optObj.grpnme=ZPI18N.getString("zp.moduleratings"),optsData.push(optObj),ZPeopleComponents.tokenfield("#fldToPubID").setAttributes({data:optsData})}else-1==selPubFieldsIds.indexOf(2)&&-1!=scoreCardIndex&&(optsData.splice(scoreCardIndex,1),ZPeopleComponents.tokenfield("#fldToPubID").removeTokens([3]),ZPeopleComponents.tokenfield("#fldToPubID").setAttributes({data:optsData}))},addDateOfApplicableCriteria:function(){var pageId=settingsPage.container,selVal=ZPeopleComponents.select(pageId.find("#dojCrt")).getValue(),isEmpty=!0,value="";if("DOJ_UNTIL"==selVal?value=ZPeopleComponents.datefield(pageId.find("#dojVal1")).getValue().dateString:"DOJ_FRM_TO"==selVal?value=ZPeopleComponents.daterangepicker(pageId.find("#cyApplFrmToPrdPicker")).getValue().value:"DOJ_MTH"==selVal&&(value=ZPeopleComponents.select(pageId.find("#dojMthVal")).getValue()),void 0!=value&&""!=value&&(isEmpty=!1),isEmpty)ZPeople.Message.warning("Please add the criteria");else{pageId.find("#addCriDiv_DOJ").addClass("zpl_DNI"),pageId.find("#dojAppliDiv_2").removeClass("zpl_DNI"),ZPeopleComponents.isComponent(pageId.find("#dojMthVal_2"))&&ZPeopleComponents.select("#dojMthVal_2").deselectAllOptions(),ZPeopleComponents.isComponent(pageId.find("#dojVal1_2"))&&ZPeopleComponents.datefield($("#dojVal1_2")).setValue("");var options=ZPeopleComponents.select("#dojCrt").getOptions();value=ZPeopleComponents.select("#dojCrt").getValue();3==options.length&&("DOJ_FRM_TO"==value||"DOJ_UNTIL"==value?(ZPeopleComponents.select("#dojCrt").removeOption(["DOJ_MTH"]),ZPeopleComponents.select("#dojCrt_2").removeOption(["DOJ_UNTIL","DOJ_FRM_TO"])):"DOJ_MTH"==value&&(ZPeopleComponents.select("#dojCrt").removeOption(["DOJ_UNTIL","DOJ_FRM_TO"]),ZPeopleComponents.select("#dojCrt_2").removeOption(["DOJ_MTH"]))),"DOJ_FRM_TO"==value||"DOJ_UNTIL"==value?ZPeopleComponents.select("#dojCrt_2").setValue("DOJ_MTH"):"DOJ_MTH"==value&&ZPeopleComponents.select("#dojCrt_2").setValue("DOJ_UNTIL")}},deleteDateOfApplicableCriteria:function(){var pageId=settingsPage.container;if(pageId.find("#dojAppliDiv_2").addClass("zpl_DNI"),pageId.find("#dojAppliDiv_2 [elem=errorMsg]").remove(),pageId.find("#dojAppliDiv_2 .ztextbox__error").removeClass("ztextbox__error"),pageId.find("#addCriDiv_DOJ").removeClass("zpl_DNI"),ZPeopleComponents.isComponent(pageId.find("#cyApplFrmToPrdPicker_2"))){ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker_2").clearSelection(),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker_2").destroy(),pageId.find("#dojValDiv_2").html('<div id="dblDateCalDiv_2" class="ztextbox--group zh-alignright"><i id="dojVal_Icon_2" class="ztextbox__icon PI_monthly"></i><input style="width: 230px;" id="dojVal_2" class="ztextbox"></div>'),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker_2",{change:function(event,ui){pageId.find("#dojVal_2").val(ui.fromValueString+"-"+ui.toValueString),PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(ui):PMSV2Cycle.onChangeApplicableFields(ui)},format:dateFmt,appendTo:pageId.find("#nwCylAppliDiv"),position:"bottom",forElement:"#dojVal_2"});let picker9=pageId.find("#cyApplFrmToPrdPicker_2");pageId.find("#dojVal_2, #dojVal_Icon_2").on("click",function(){pageId.find("#cyApplFrmToPrdPicker_2").is(":visible")?ZPeopleComponents.daterangepicker(picker9).close():ZPeopleComponents.daterangepicker(picker9).open()})}ZPeopleComponents.isComponent(pageId.find("#dojMthVal_2"))&&ZPeopleComponents.select("#dojMthVal_2").deselectAllOptions(),ZPeopleComponents.isComponent(pageId.find("#dojVal1_2"))&&ZPeopleComponents.datefield($("#dojVal1_2")).setValue("");var firstCri=ZPeopleComponents.select("#dojCrt");2==(options=firstCri.getOptions()).length?firstCri.addOption([{label:ZPI18N.getString("zp.workflow.months"),value:"DOJ_MTH"}]):1==options.length&&firstCri.addOption([{label:ZPI18N.getString("zp.until"),value:"DOJ_UNTIL"},{label:ZPI18N.getString("zp.fromandtp"),value:"DOJ_FRM_TO"}]);var options,secondCri=ZPeopleComponents.select("#dojCrt_2");2==(options=secondCri.getOptions()).length?secondCri.addOption([{label:ZPI18N.getString("zp.workflow.months"),value:"DOJ_MTH"}]):1==options.length&&secondCri.addOption([{label:ZPI18N.getString("zp.until"),value:"DOJ_UNTIL"},{label:ZPI18N.getString("zp.fromandtp"),value:"DOJ_FRM_TO"}])},addApplicableCriteria:function(event,id){var pageId=settingsPage.container;null!=event&&void 0!=event&&(id=event.detail.id);var html='<div class="zpl_idiv" id="'+id+'AppliDiv">';"location"==id||"role"==id||"department"==id||"level"==id?(html+='<select disabled="disabled" class="select-js" type="keyFld" style="display: none;"></select>',html+='<select class="select-js" type="crtFld" id="'+id+'ApplCrtIS" disabled="disabled" style="display: none;"><option value="CRT_IS">'+ZPI18N.getString("zp.is")+"</option></select>",html+='<select class="select" type="valFld" data-show-search-field="true" style="display: none;width: 230px;" multiple="true"></select>'):"customDate"==id?(html+='<select id="cstKey" data-show-search-field="true" class="select" style="display: none;"></select>',html+='<select id="cstCrt" data-show-search-field="true" class="select-js" style="display: none;"><option value="CST_DATE">'+ZPI18N.getString("zp.datebased")+'</option><option value="CST_MTH">'+ZPI18N.getString("zp.monthbased")+"</option></select>",html+='<div id="cstValDiv" style="width: 230px;"><div id="cstPrdVal" class="ztextbox--group zh-alignright"><i class="ztextbox__icon PI_calendar"></i><input id="cstVal" class="ztextbox" style="width: 230px;"></div></div>'):"totalWrkExp"==id&&(html+='<select id="expKey" disabled="disabled" class="select-js" style="display: none;"><option value="EXP_APPLI_CRT">'+ZPI18N.getString("zp.totalworkexperience")+"</option></select>",html+='<select id="expCrt" data-show-search-field="true" class="select-js" style="display: none;"><option value="-1">'+ZPI18N.getString("zp.select")+'<option value="0">'+ZPI18N.getString("zp.equalto")+'</option><option value="1">'+ZPI18N.getString("zp.lesserthan")+'</option><option value="2">'+ZPI18N.getString("zp.greaterthan")+'<option value="3">'+ZPI18N.getString("zp.lessthanorequalto",new Array(""))+'<option value="4">'+ZPI18N.getString("zp.greaterthanorequalto",new Array(""))+'<option value="5">'+ZPI18N.getString("zp.between")+"</option></select>",html+='<div id="expValDiv" class="zpl_idiv" style="width: 230px;"><input id="expFrom" class="ztextbox w80I" type="text" style="width: 230px;" placeholder="'+ZPI18N.getString("zp.years")+'" onkeydown="return PMSV2Cycle.onNRKeyDown(this,event,\'year\');" onchange="PMSOperation.checkExperienceYear()"><input id="expTo" class="ztextbox w80I" type="text" style="width: 110px; display: none;" placeholder="'+ZPI18N.getString("zp.years")+'" onkeydown="return PMSV2Cycle.onNRKeyDown(this,event,\'year\');" onchange="PMSOperation.checkExperienceYear(true)"></div>'),html+='<i class="PI_delete tooltip-js" data-title-position="bottom" onclick="PMSV2Cycle.checkDelApplicability(this)" title="'+ZPI18N.getString("zp.delete")+'"></i>',html+="</div>",pageId.find("#appliAddButton").parent().before(html),PMSV2Cycle.defaultOptionForAppliField(id),ZPeopleComponents.menu("#appliMenuList").hideMenuItems(["#"+id]),PMSOperation.notSelectedApplicableKeys.splice(PMSOperation.notSelectedApplicableKeys.indexOf(id),1),0==PMSOperation.notSelectedApplicableKeys.length&&pageId.find("#appliAddButton").addClass("zpl_DNI")},checkDelApplicability:function(obj){PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck(),PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(null,obj):PMSV2Cycle.deleteApplicableCriteria(obj)},defaultOptionForAppliField:function(id){var pageId=settingsPage.container;if("location"==id)(selOpt=pageId.find("#cycleAppliDiv_nw #locationAppliDiv select[type=keyFld]")).empty(),selOpt.append(jQuery("<option />",{value:"APPL_LOC",id:"APPL_LOC"}).html(ZPI18N.getString("zp.location"))),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),selOpt=pageId.find("#cycleAppliDiv_nw #locationAppliDiv #locationApplCrtIS"),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),(selOpt=pageId.find("#cycleAppliDiv_nw").find("#locationAppliDiv select[type=valFld]")).empty(),$.each(PMSV2Cycle.ALL_LOCATIONS,function(key,value){selOpt.append(jQuery("<option />",{value:value.locationId,id:value.locationId}).html(value.locationName))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.alllocaction")}),selOpt.attr("keySel","APPL_LOC"),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)});else if("role"==id){(selOpt=pageId.find("#cycleAppliDiv_nw #roleAppliDiv select[type=keyFld]")).empty(),selOpt.append(jQuery("<option />",{value:"APPL_ROLE",id:"APPL_ROLE"}).html(ZPI18N.getString("zp.role"))),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),selOpt=pageId.find("#cycleAppliDiv_nw #roleAppliDiv #roleApplCrtIS"),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),(selOpt=pageId.find("#cycleAppliDiv_nw").find("#roleAppliDiv select[type=valFld]")).empty(),$.each(PMSV2Cycle.ALL_ROLES,function(key,value){selOpt.append(jQuery("<option />",{value:value.roleId,id:value.roleId}).html(value.roleName))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.allroles")}),selOpt.attr("keySel","APPL_ROLE"),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)})}else if("department"==id){(selOpt=pageId.find("#cycleAppliDiv_nw #departmentAppliDiv select[type=keyFld]")).empty(),selOpt.append(jQuery("<option />",{value:"APPL_DEP",id:"APPL_DEP"}).html(ZPI18N.getString("zp.department"))),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),selOpt=pageId.find("#cycleAppliDiv_nw #departmentAppliDiv #departmentApplCrtIS"),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),(selOpt=pageId.find("#cycleAppliDiv_nw").find("#departmentAppliDiv select[type=valFld]")).empty(),$.each(PMSV2Cycle.ALL_DEPARTMENTS,function(key,value){selOpt.append(jQuery("<option />",{value:value.departmentId,id:value.departmentId}).html(value.departmentName))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.alldepartment")}),selOpt.attr("keySel","APPL_DEP"),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)})}else if("level"==id){(selOpt=pageId.find("#cycleAppliDiv_nw #levelAppliDiv select[type=keyFld]")).empty(),selOpt.append(jQuery("<option />",{value:"APPL_LVL",id:"APPL_LVL"}).html(ZPI18N.getString("zp.level"))),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),selOpt=pageId.find("#cycleAppliDiv_nw #levelAppliDiv #levelApplCrtIS"),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),(selOpt=pageId.find("#cycleAppliDiv_nw").find("#levelAppliDiv select[type=valFld]")).empty(),$.each(PMSV2Cycle.ALL_LEVELS,function(key,value){selOpt.append(jQuery("<option />",{value:value.levelId,id:value.levelId}).html(value.levelName))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.alllevel")}),selOpt.attr("keySel","APPL_LVL"),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)})}else if("customDate"==id){(selOpt=pageId.find("#customDateAppliDiv #cstKey")).empty(),selOpt.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),$.each(PMSV2Cycle.customDateFCID,function(key,value){selOpt.append(jQuery("<option />",{value:value.componentID,id:value.componentID}).html(value.displayName))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)});let cstCrtSelect=pageId.find("#customDateAppliDiv #cstCrt");ZPeopleComponents.select(cstCrtSelect,{dropdownList:{appendTo:pageId,fitForElement:!0}}),cstCrtSelect.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):(PMSOperation.onCstCrtSelect(edata),PMSV2Cycle.onChangeApplicableFields(edata))}),ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker",{change:function(event,edata){var ui=event.detail;pageId.find("#cstVal").val(ui.fromValueString+"-"+ui.toValueString),PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)},format:dateFmt});let picker10=pageId.find("#cyApplCstPrdPicker");pageId.find("#cstVal").on("click",function(){pageId.find("#cyApplCstPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker10).close():ZPeopleComponents.daterangepicker(picker10).open()})}else if("totalWrkExp"==id){var selOpt=pageId.find("#totalWrkExpAppliDiv #expKey");ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}});let expCrtSelect=pageId.find("#totalWrkExpAppliDiv #expCrt");ZPeopleComponents.select(expCrtSelect,{dropdownList:{appendTo:pageId,fitForElement:!0}}),expCrtSelect.on("zselectchange",function(event,eData){PMSOperation.onExpCrtSelect(eData),PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(eData,event):PMSV2Cycle.onChangeApplicableFields(eData)})}},deleteApplicableCriteria:function(obj){var pageId=settingsPage.container,appliDivId=$(obj).parent().attr("id"),id=appliDivId.split("AppliDiv")[0];"location"==id||"role"==id||"department"==id||"level"==id?(ZPeopleComponents.select($(obj).parent().find("select[type=keyFld]")).destroy(),ZPeopleComponents.select($(obj).parent().find("select[type=crtFld]")).destroy(),ZPeopleComponents.select($(obj).parent().find("select[type=valFld]")).destroy()):"customDate"==id?(ZPeopleComponents.select($(obj).parent().find("#cstKey")).destroy(),ZPeopleComponents.select($(obj).parent().find("#cstCrt")).destroy(),ZPeopleComponents.isComponent(pageId.find("#cstMthVal"))&&ZPeopleComponents.select($(obj).parent().find("#cstMthVal")).destroy()):"totalWrkExp"==id&&(ZPeopleComponents.select($(obj).parent().find("#expKey")).destroy(),ZPeopleComponents.select($(obj).parent().find("#expCrt")).destroy()),pageId.find("#"+appliDivId).remove(),PMSOperation.notSelectedApplicableKeys.push(id),ZPeopleComponents.menu("#appliMenuList").showMenuItems(["#"+id]),pageId.find("#appliAddButton").removeClass("zpl_DNI")},getEmpCnt:function(obj){let id=$(obj).attr("id"),pageId=settingsPage.container;if("nonrulEmpCnt"==id){pageId.find("#nonruleEmpCount").removeClass("zpl_DNI"),pageId.find("#nonrulEmpCnt").addClass("zpl_DNI");var empCnt=0;for(let[key,value]of PMSV2Cycle.empCntArr)empCnt+=value;var totCnt=Number(pageId.find("#totalEmpCnt").text());pageId.find("#nonruleEmpCount").text(totCnt-empCnt)}else{var tbodyId=$(obj).closest(".zpl_paappslyhike").attr("id"),ruleNo=tbodyId.split("totalrule_").toString().replace(",",""),totRulelen=pageId.find("#custRules").find(".zpl_paappslyhike").length;if(!PMSV2Cycle.isCycStarted&&PMSV2Cycle.CHOSEN_CUST_OPT.includes("5"))ZPeople.Message.warning(ZPI18N.getString("zp.empCntRatingCyc")),PMSV2Cycle.empCntArr.set(ruleNo.toString(),0);else if(PMSV2Cycle.empCntArr.has(ruleNo.toString())){empCnt=PMSV2Cycle.empCntArr.get(ruleNo.toString());2==PMSV2Cycle.isReviewComplete&&0==empCnt?ZPeople.Message.warning(ZPI18N.getString("zp.empCntRatingCyc")):0!=PMSV2Cycle.isReviewComplete&&1!=PMSV2Cycle.isReviewComplete&&-1!=PMSV2Cycle.isReviewComplete||0!=empCnt?(pageId.find("#"+tbodyId).find("#ruleEmpCount").removeClass("zpl_DNI"),pageId.find("#"+tbodyId).find("#rulEmpCnt").addClass("zpl_DNI"),pageId.find("#"+tbodyId).find("#ruleEmpCount").text(empCnt)):ZPeople.Message.warning(ZPI18N.getString("zp.noemployeesapplicable"))}else if(PMSV2Cycle.checkRule(tbodyId,totRulelen,!1,!0)){for(var arrLen=PMSV2Cycle.CHOSEN_CUST_OPT.length,ruleObj={},ruleArr=[],i=0;i<arrLen;i++){var temp={},type=PMSV2Cycle.CHOSEN_CUST_OPT[i];if(1==type||4==type){var arr;if(0==(arr=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield("#tot"+ruleNo+"_rule"+i+"_option").getAllValues())).length)return pageId.find("#tot"+ruleNo+"_rule"+i+"_ruleVal").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.entervalidinput")+"</span>"),!1;1==type?temp.desList=arr:temp.deptList=arr}else if(2==type||3==type&&!PMSV2Cycle.newDOJ){var expObj={},opt=ZPeopleComponents.select("#tot"+ruleNo+"_rule"+i+"_option").getValue();expObj.condType=opt;var val=Number(pageId.find("#tot"+ruleNo+"_rule"+i+"_expFrom_1").val());if(expObj.condValue=val,""==val.toString()||""==opt.toString())return pageId.find("#tot"+ruleNo+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.entervalidinput")+"</span>"),!1;if(5==opt){val=Number(pageId.find("#tot"+ruleNo+"_rule"+i+"_expTo_1").val());if(expObj.condValueTo=val,""==val||void 0==val)return pageId.find("#tot"+ruleNo+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;if(val<expObj.condValue)return pageId.find("#tot"+ruleNo+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validfromtoyearerror")+"</span>"),!1}temp.expDetails=expObj}else if(3==type&&PMSV2Cycle.newDOJ){var dojObj={};opt=ZPeopleComponents.select("#tot"+ruleNo+"_rule"+i+"_option").getValue();if(dojObj.condType=opt,""==(val=2!=opt?ZPeopleComponents.datefield(pageId.find("#tot"+ruleNo+"_rule"+i+"_dojSel")).getValue().dateString:ZPeopleComponents.daterangepicker(pageId.find("#tot"+len+"_rule"+i+"_hkDoj")).getFromValue().fromValueString).toString()||""==opt.toString())return pageId.find("#tot"+ruleNo+"_rule"+i+"_dojDetails").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;if(2==opt){var fromDate=val,toDate=ZPeopleComponents.daterangepicker(pageId.find("#tot"+ruleNo+"_rule"+i+"_hkDoj")).getToValue().toValueString;dojObj.condValue=fromDate,dojObj.condValueTo=toDate}else dojObj.condValue=val;dojObj.isnew=!0,temp.dojDetails=dojObj}else if(5==type){val=ZPeopleComponents.select("#tot"+ruleNo+"_rule"+i+"_option").getValue();if(temp.rating=val,""==val)return pageId.find("#tot"+ruleNo+"_rule"+i+"_ruleVal").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.entervalidinput")+"</span>"),!1}ruleArr.push(temp)}ruleObj.criteria=ruleArr,ruleObj.ruleFormat=PMSV2Cycle.CHOSEN_CUST_OPT;csrfToken,JSON.stringify(ruleObj);let formdata=new FormData;PMSV2Cycle.getApplicableCriObj(formdata);var configId=pageId.find("#addCycleConfigDiv").attr("configid");null!=configId&&void 0!=configId&&""!=configId&&formdata.append("configId",configId),formdata.append("conreqcsr",csrfToken),formdata.append("hikeRuleConfig",JSON.stringify(ruleObj)),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp?mode=getRuleEmpCnt",data:formdata,processData:!1,contentType:!1,success:function(resultData){if("0"===resultData.totalEmployees)return PMSV2Cycle.curRule=new Map,pageId.find("#sel_opt_error").remove(),pageId.find("#tot"+ruleNo+"_employeecnt").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.noemployeesapplicable")+"</span>"),!1;"-1"==resultData.totalEmployees?(PMSV2Cycle.empCntArr.set(ruleNo.toString(),0),resultData.totalEmployees=0):PMSV2Cycle.empCntArr.set(ruleNo.toString(),resultData.totalEmployees),pageId.find("#"+tbodyId).find("#ruleEmpCount").removeClass("zpl_DNI"),pageId.find("#"+tbodyId).find("#rulEmpCnt").addClass("zpl_DNI"),pageId.find("#"+tbodyId).find("#ruleEmpCount").text(resultData.totalEmployees)}})}}},buildCreatedCustomRules:function(budgetData,modeType){PMSV2Cycle.CHOSEN_CUST_OPT=budgetData.typeArr;let pageId=settingsPage.container,custoptions=ZPeopleComponents.tokenfield(pageId.find("#chooseCustOpt")).getAttributes().data;pageId.find("#custRules").removeClass("zpl_DNI"),pageId.find("[fld=hide]").removeClass("zpl_DNI");var selcustopt=[];for(var json in custoptions){let data=custoptions[json];PMSV2Cycle.CHOSEN_CUST_OPT.includes(data.id)&&selcustopt.push(data)}pageId.find("[fld=hideForFld]").removeClass("zpl_DNI"),pageId.find("#incPerLabel").html(ZPI18N.getString("zp.incrementAmt",new Array(PMSV2Cycle.HIKENAME))),ZPeopleComponents.tokenfield(pageId.find("#chooseCustOpt")).addTokens(selcustopt),ZPeopleComponents.tokenfield(pageId.find("#chooseCustOpt")).setAttribute("disabled","disabled");var ruleDetails=budgetData.ruleDetails,ruleLen=ruleDetails.length;"view"==modeType&&(ruleLen-=1),"view"!=modeType&&(PMSV2Cycle.isChanged=!0);for(let i=0;i<ruleLen;i++){var obj=ruleDetails[i],criteria=obj.criteria,hikePerAmountTrimValue=(PMSV2Cycle.ALLOCATEDHIKENAME+" "+ZPI18N.getString("zp.amount")).length>30?(PMSV2Cycle.ALLOCATEDHIKENAME+" "+ZPI18N.getString("zp.amount")).slice(0,25)+".....":PMSV2Cycle.ALLOCATEDHIKENAME+" "+ZPI18N.getString("zp.amount"),hikePerTrimValue=(PMSV2Cycle.HIKENAME+" "+ZPI18N.getString("zp.percentage")).length>22?(PMSV2Cycle.HIKENAME+" "+ZPI18N.getString("zp.percentage")).slice(0,22)+".....":PMSV2Cycle.HIKENAME+" "+ZPI18N.getString("zp.percentage"),newRule=`<div class="zpl_gbox zpl_paappslyhike" id="totalrule_${i}" series="${i}">\n\t\t\t\t\t\t \t<div>\n\t\t\t\t\t\t \t\t <div class="zpl_paappslyhikehdr" id="ruleName">\n                            \t\t<h5>${ZPI18N.getString("zp.hkrule",[i+1])}</h5> \n                            \t\t<div class="zpl_hvr zpl_hvrsw"><i class="PI_delete" id="ruleDel" onclick="PMSV2Cycle.deleteRule(this)"></i></div>\n                          \t\t </div>\n                          \t\t <div class="zpl_paappslyhikecnt">\n                          \t \t\t<div class="zpl_flexcolumngap4 zpl_paappslyhikcntlft">\n                          \t \t\t\t<div class="zpl_flexgap4" id="tot${i}_rule0">\n                          \t \t\t\t\t<div class="zpl_w200" id="tot${i}_rule0_ruleselect">\n                          \t \t\t\t\t\t<select id="tot${i}_rule0_ruleType"  tabindex="-1"></select>\n                          \t \t\t\t\t</div>\n                          \t \t\t\t\t<div class="" id="tot${i}_rule0_ruleVal"></div>\n                          \t \t\t\t</div>\n                          \t \t\t\t<div class="zpl_flexgap4" id="tot${i}_employeecnt">\n                               \t\t\t\t <div class="zpl_tg">\n                               \t\t\t\t <span>${ZPI18N.getString("zp.ruleUser")}</span> \n                                  \t\t\t <a id="rulEmpCnt" onclick="PMSV2Cycle.getEmpCnt(this)">#</a>\t\n\t          \t\t\t\t\t\t\t\t <span id="ruleEmpCount"></span> \n                                \t\t\t </div>\n                                \t\t\t <div><input type="hidden" id="inp_rules" value="" /></div>\n                                \t\t</div>\n                          \t \t\t\t\n\t\t\t\t\t\t     \t\t</div>\n\t\t\t\t\t\t     \t\t<div class="zpl_paappslyhikcntrgt">\n                              \t\t\t<div class="zpl_flexcolumnaligngap2">\n                               \t\t\t\t     <div><input type="text" class="ztextbox zpl_w80i" id="hikePercent" onchange="PMSV2Cycle.calcRuleHike(this)"></div>\n                               \t\t\t\t\t <span class="zpl_ellipsis200" title="${PMSV2Cycle.HIKENAME+" "+ZPI18N.getString("zp.percentage")}">${hikePerTrimValue}</span>\n                              \t\t\t  </div>\n                             \t\t\t  <div class="zpl_flexcolumnaligngap2">\n                               \t\t\t\t\t <div><input type="text" class="ztextbox zpl_w80i" id="hikeRuleAmt" disabled="disabled"></div>\n                               \t\t\t\t\t <span class="zpl_ellipsis200" id="hikeAmtLabel" title="${PMSV2Cycle.ALLOCATEDHIKENAME+" "+ZPI18N.getString("zp.amount")}">${hikePerAmountTrimValue}</span>\n                              \t\t\t  </div>\n                            \t\t</div>\n\t\t\t\t\t\t     \t</div>\n\t\t\t             \t</div>\n\t\t\t             </div>`;0==i?pageId.find("#custRules").append(newRule):pageId.find("#custRules").find("#totalrule_"+(i-1)).after(newRule);var arrLength=PMSV2Cycle.CHOSEN_CUST_OPT.length,optLst=PMSV2Cycle.selectCustOpt(),dataObj={};dataObj.options=optLst,dataObj.contentType="text",dataObj.dataMapping={value:"id",label:"name",informativeText:"name"},dataObj.search={by:"name"};for(let index=0;index<arrLength;index++){PMSV2Cycle.CHOSEN_CUST_OPT[index];if(0!=index){var addCri=`<div class="zpl_flexgap4" id="tot${i}_rule${index}">\n                          \t \t\t\t\t<div class="zpl_w200" id="tot${i}_rule${index}_ruleselect">\n                          \t \t\t\t\t\t<select id="tot${i}_rule${index}_ruleType" ></select>\n                          \t \t\t\t\t</div>\n                          \t \t\t\t\t<div class="" id="tot${i}_rule${index}_ruleVal"></div>\n                          \t   </div>`;pageId.find("#tot"+i+"_rule"+(index-1)).after(addCri)}ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_ruleType"),dataObj);json={};if((json=criteria[index]).hasOwnProperty("1")||json.hasOwnProperty("4")){var arr=[];for(var key in json)arr.push(json[key]);var td='<textarea id="tot'+i+"_rule"+index+'_option" style="display: none;"></textarea>';pageId.find("#tot"+i+"_rule"+index+"_ruleVal").append(td);optLst=[];if(json.hasOwnProperty("1")){var desOpt=[];$.each(PMSV2Cycle.ALL_DESIGNATION,function(index,data){if(PMSV2Cycle.APP_DESIGNATION.includes(data.desId)){let optObj={};optObj.name=data.desName,optObj.id=data.desId,optLst.push(optObj),arr[0].includes(data.desId)&&desOpt.push(optObj)}}),(dataObj1={}).data=optLst,dataObj1.contentType="text",dataObj1.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},dataObj1.search={by:"name"},dataObj1.allowDuplicateValues=!1,dataObj1.dropdownList={itemType:"checkbox",isTextHTMLEncoded:!0},dataObj1.isLabelHTMLEncoded=!0,dataObj1.values=desOpt,ZPeopleComponents.tokenfield(pageId.find("#tot"+i+"_rule"+index+"_option"),dataObj1),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_DESIGNATION)}else{var dataObj1,deptOpt=[];$.each(PMSV2Cycle.ALL_DEPARTMENTS,function(index,data){if(PMSV2Cycle.APP_DEPARTMENT.includes(data.departmentId)){let optObj={};optObj.name=data.departmentName,optObj.id=data.departmentId,optLst.push(optObj),arr[0].includes(data.departmentId)&&deptOpt.push(optObj)}}),(dataObj1={}).data=optLst,dataObj1.contentType="text",dataObj1.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},dataObj1.search={by:"name"},dataObj1.allowDuplicateValues=!1,dataObj1.dropdownList={itemType:"checkbox",isTextHTMLEncoded:!0},dataObj1.isLabelHTMLEncoded=!0,dataObj1.values=deptOpt,ZPeopleComponents.tokenfield(pageId.find("#tot"+i+"_rule"+index+"_option"),dataObj1),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_DEPARTMENT)}}else if(json.hasOwnProperty("2")){arr=[];for(var key in json)arr.push(json[key]);var condtype=arr[0].condType,condVal=arr[0].condValue,expTabledata=`<div id="tot${i}_rule${index}_expDetailsTable" class="zpl_flexgap4">\n\t\t\t\t\t   \t\t\t\t\t  <div id="tot${i}_rule${index}_expOpt" ><select id="tot${i}_rule${index}_option"></select></div>\n\t\t\t\t\t   \t\t\t\t\t  <div id="tot${i}_rule${index}_expFrom"><input id="tot${i}_rule${index}_expFrom_1" class="ztextbox" ></div>\n\t\t\t\t\t   \t\t\t\t\t  </div>`;if(pageId.find("#tot"+i+"_rule"+index+"_ruleVal").append(expTabledata),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_option"),PMSV2Cycle.getTotalExpOption()),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_option")).setValue(condtype),pageId.find("#tot"+i+"_rule"+index+"_expFrom_1").val(arr[0].condValue),5==condtype){td=`<div id="tot${i}_rule${index}_expTo" ><input type="text" class="form-control" value="" placeholder="${ZPI18N.getString("zp.years")}" id="tot${i}_rule${index}_expTo_1" ></div>`;pageId.find("#tot"+i+"_rule"+index+"_expFrom").after(td),pageId.find("#tot"+i+"_rule"+index+"_expTo_1").val(arr[0].condValueTo),pageId.find("#tot"+i+"_rule"+index+"_expTo_1").prop("disabled",!0)}pageId.find("#tot"+i+"_rule"+index+"_expFrom_1").prop("disabled",!0),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_TOTAL_EXPERIENCE)}else if(json.hasOwnProperty("3")){arr=[];for(var key in json)arr.push(json[key]);condtype=arr[0].condType,condVal=arr[0].condValue;if(arr[0].hasOwnProperty("isnew")?PMSV2Cycle.newDOJ=arr[0].isnew:PMSV2Cycle.newDOJ=!1,PMSV2Cycle.newDOJ){expTabledata=`<div id="tot${i}_rule${index}_dojDetails" class="zpl_flexgap4">\n\t\t\t   \t\t\t\t\t\t\t\t\t<div id="tot${i}_rule${index}_expOpt" ><select class="select-js" id="tot${i}_rule${index}_option"></select></div>\n\t\t\t   \t\t\t\t\t\t\t\t\t<div id="tot${i}_rule${index}_dojDate" ></div>\n\t\t\t   \t\t\t\t\t\t\t\t\t</div>`;pageId.find("#tot"+i+"_rule"+index+"_ruleVal").append(expTabledata),pageId.find("#tot"+i+"_rule"+index+"_dojDate").html('<input fld="dojHide" id="tot'+i+"_rule"+index+'_dojSel" class="ztextbox">');var effectiveDateOptions={calendarIcon:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none"};ZPeopleComponents.datefield(pageId.find("#tot"+i+"_rule"+index+"_dojSel"),effectiveDateOptions),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_option"),PMSV2Cycle.getDOJOption()),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_option")).setValue(condtype),2==condtype?(pageId.find("#hkDojdateRangePicker").append(`<div id="tot${i}_rule${index}_hkDoj"  data-for-element="#tot${i}_rule${index}_dojSel" ></div>`),pageId.find("#tot"+i+"_rule"+index+"_dojDate").html(`<div class="ztextbox--group zh-alignright"><i class="ztextbox__icon PI_calendar"></i><input id="tot${i}_rule${index}_dojSel" fld="dojRangeHide" class="ztextbox"></div>`),ZPeopleComponents.daterangepicker("#tot"+i+"_rule"+index+"_hkDoj",{change:function(event,ui){pageId.find("#tot"+i+"_rule"+index+"_dojSel").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt}),ZPeopleComponents.daterangepicker("#tot"+i+"_rule"+index+"_hkDoj").setFromValue(condVal),ZPeopleComponents.daterangepicker("#tot"+i+"_rule"+index+"_hkDoj").setToValue(arr[0].condValueTo)):ZPeopleComponents.datefield(pageId.find("#tot"+i+"_rule"+index+"_dojSel")).setValue(condVal),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_DATE_OF_JOIN)}else{expTabledata=`<div id="tot${i}_rule${index}_expDetailsTable" class="zpl_flexgap4">\n\t\t\t\t\t   \t\t\t\t\t  <div id="tot${i}_rule${index}_expOpt" ><select id="tot${i}_rule${index}_option"></select></div>\n\t\t\t\t\t   \t\t\t\t\t  <div id="tot${i}_rule${index}_expFrom"><input id="tot${i}_rule${index}_expFrom_1" class="ztextbox" ></div>\n\t\t\t\t\t   \t\t\t\t\t  </div>`;pageId.find("#tot"+i+"_rule"+index+"_ruleVal").append(expTabledata),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_option"),PMSV2Cycle.getTotalExpOption());ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_option")).getAttributes().data;if(ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_option")).setValue(condtype),pageId.find("#tot"+i+"_rule"+index+"_expFrom_1").val(arr[0].condValue),5==condtype){td=`<div id="tot${i}_rule${index}_expTo" ><input type="text" class="form-control" value="" placeholder="${ZPI18N.getString("zp.years")}" id="tot${i}_rule${index}_expTo_1" ></div>`;pageId.find("#tot"+i+"_rule"+index+"_expFrom").after(td),pageId.find("#tot"+i+"_rule"+index+"_expTo_1").val(arr[0].condValueTo),pageId.find("#tot"+i+"_rule"+index+"_expTo_1").prop("disabled",!0)}pageId.find("#tot"+i+"_rule"+index+"_expFrom_1").prop("disabled",!0),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_DATE_OF_JOIN)}}else if(json.hasOwnProperty("5")){var rate="";for(var key in json)rate=json[key];"clone"==modeType&&($.each(PMSV2Cycle.clone_Rating_Data,function(iter,val){val==rate&&(rate=iter)}),PMSV2Cycle.hikeAmtObj[i]=0);td='<select class="select-js" id="tot'+i+"_rule"+index+'_option"></select>';pageId.find("#tot"+i+"_rule"+index+"_ruleVal").append(td);optLst=pageId.find("#tot"+i+"_rule"+index+"_option");$.each(PMSV2Cycle.cycle_rating,function(key,val){optLst.append(jQuery("<option />",{value:val.id,id:val.id}).html(val.value))}),ZPeopleComponents.select(optLst),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_option")).setValue(rate),ZPeopleComponents.select(pageId.find("#tot"+i+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_RATING)}pageId.find("#tot"+i+"_rule"+index+"_ruleVal").prop("disabled",!0)}if(pageId.find("#totalrule_"+i).find("[fld=dojHide]").each(function(){ZPeopleComponents.datefield($(this)).setAttribute("disabled","disabled")}),pageId.find("#totalrule_"+i).find("[fld=dojRangeHide]").each(function(){$(this).addClass("disabled")}),$("#totalrule_"+i+" select").each(function(){ZPeopleComponents.select($(this)).setAttribute("disabled","disabled")}),$("#totalrule_"+i+" textarea").each(function(){ZPeopleComponents.tokenfield($(this)).setAttribute("disabled","disabled")}),pageId.find("#totalrule_"+i).find("#hikePercent").val(obj.ruleHikePer),"clone"!=modeType?pageId.find("#totalrule_"+i).find("#inp_rules").val(obj.ruleid):PMSV2Cycle.hikeAmtObj[i]=parseFloat(obj.ruleHikeAmt),pageId.find("#totalrule_"+i).find("#hikeRuleAmt").val(parseFloat(obj.ruleHikeAmt).toFixed(2)),pageId.find("#totalrule_"+i).find("#hikePercent").prop("disabled",!0),pageId.find("#totalrule_"+i).find("#hikeRuleAmt").prop("disabled",!0),"add"==modeType||"clone"==modeType){-1==(empCnt=budgetData.ruleUserCount[i])?PMSV2Cycle.empCntArr.set(i.toString(),0):PMSV2Cycle.empCntArr.set(i.toString(),empCnt)}else{if(budgetData.ruleUserCount.hasOwnProperty(obj.ruleid))if("clone"==modeType&&PMSV2Cycle.CHOSEN_CUST_OPT.includes("5"))PMSV2Cycle.empCntArr.set(i.toString(),0);else{var empCnt=budgetData.ruleUserCount[obj.ruleid];PMSV2Cycle.empCntArr.set(i.toString(),empCnt)}else if("clone"==modeType)-1==(empCnt=budgetData.ruleUserCount[i])?PMSV2Cycle.empCntArr.set(i.toString(),0):PMSV2Cycle.empCntArr.set(i.toString(),empCnt);else PMSV2Cycle.empCntArr.set(i.toString(),0);"clone"!=modeType&&pageId.find("#totalrule_"+i).find("#ruleDel").addClass("zpl_DNI")}}budgetData.isReviewComplete||5==budgetData.cycleStatus?PMSV2Cycle.isReviewComplete=1:budgetData.typeArr.includes("5")?PMSV2Cycle.isReviewComplete=2:PMSV2Cycle.isReviewComplete=0,"view"==modeType?(pageId.find("#custopt").addClass("zpl_DNI"),pageId.find("#addRule").addClass("zpl_DNI")):(pageId.find("#custSavebtn").addClass("zpl_DNI"),pageId.find("#custResetbtn").removeClass("zpl_DNI"),pageId.find("#custResetbtn").off("click").on("click",function(){PMSV2Cycle.changeConfirmRule()}))},setTmplValues:function(){let pageId=settingsPage.container,tmplVal=PMSV2Cycle.SELECTED_TMPL,isCycleEdit=PMSV2Cycle.EDIT_CYCLE_FLAG,isCycleClone=PMSV2Cycle.CLONE_CYCLE_FLAG;PMSV2Cycle.SELECTED_DOJUTIL_DATE=null,PMSV2Cycle.isBudgetCalc=!1,PMSV2Cycle.applObj={};let fieldLockFlg=!1;if(PMSV2Cycle.APP_DEPARTMENT={},PMSV2Cycle.APP_DESIGNATION={},pageId.find("#addCycleConfigDiv").attr("configid",""),pageId.find("#tmplChngBnr").show(),pageId.find("#cycletempname").text(ZPI18N.getString("zp.cycle.templatename",new Array(ZPeople.decodeTxt(PMSV2Cycle.SELECTED_TMPL.periodName)))),tmplVal.budgetEnable&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationSalaryDisabled&&PMSV2Cycle.compensationData.isCompensationSalaryDisabled&&(isCycleClone||!isCycleClone&&!isCycleEdit)&&(tmplVal.budgetEnable=!1),isCycleEdit){pageId.find("#tmplChngBnr").hide(),isCycleEdit&&!isCycleClone&&(pageId.find("#hdrLbl").html(ZPI18N.getString("zp.editappraisalcycle")),pageId.find("#addCycleConfigDiv").attr("configid",tmplVal.configId),fieldLockFlg=!0);let cycNme=ZPeople.decodeTxt(tmplVal.periodName);if(isCycleClone&&(cycNme=cycNme+" ("+ZPI18N.getString("zp.clone")+")"),pageId.find("#cycleName").val(cycNme),pageId.find("#cycleDesc").val(ZPeople.decodeTxt(tmplVal.description)),void 0!=tmplVal.cycleType&&"2"==tmplVal.cycleType?pageId.find("#cycleType").prop("checked",!0):pageId.find("#cycleType").prop("checked",!1),ZPeopleComponents.daterangepicker("#cyPrdPicker").setFromValue(tmplVal.cyclefromdate),ZPeopleComponents.daterangepicker("#cyPrdPicker").setToValue(tmplVal.cycletoDate),"null"!==tmplVal.guidelines&&""!==tmplVal.guidelines&&!isCycleClone)if(null!==(filename=tmplVal.guidelinesDisname)&&void 0!==filename&&""!==filename){var fileExtn=filename.substring(filename.lastIndexOf(".")+1,filename.length),attachFileHtml=PMSV2Cycle.getAttachFileHtml(decodeURIComponent(ZPeople.decodeTxt(filename)),fileExtn,"cycleguide");$("#guidelinesId_beforeUpload").css("display","none"),$("#guidelinesId_afterUpload").parent().css("display","block"),$("#guidelinesId_afterUpload").append(attachFileHtml),PMSV2Cycle.GUIDELINESFILEID=tmplVal.guidelines}if(pageId.find("#nwCylAppliDiv").addClass("zpl_act"),isCycleEdit&&!isCycleClone&&1==ZPeopleComponents.select(pageId.find("#dojKey")).getOptions().length&&ZPeopleComponents.select(pageId.find("#dojKey")).addOption([{value:2,label:ZPI18N.getString("zp.dateofconfirmation")}]),void 0!=tmplVal.applicableDateType){var applicableDateType=tmplVal.applicableDateType,setDateApplicable=!0;if(PMSV2Cycle.IS_DATE_OF_CONFIRMATION_ENABLED||(isCycleClone&&2==applicableDateType.type&&(setDateApplicable=!1),1==applicableDateType.type&&isCycleEdit&&ZPeopleComponents.select(pageId.find("#dojKey")).removeOption([2])),setDateApplicable){ZPeopleComponents.select(pageId.find("#dojKey")).setValue(applicableDateType.type);var isChanged=!1;if(PMSV2Cycle.applObj.dateType=applicableDateType.type,void 0!=applicableDateType.until)ZPeopleComponents.select(pageId.find("#dojCrt")).setValue("DOJ_UNTIL"),ZPeopleComponents.datefield(pageId.find("#dojVal1")).setValue(applicableDateType.until),PMSV2Cycle.SELECTED_DOJUTIL_DATE=applicableDateType.until,PMSV2Cycle.applObj.DOJ=applicableDateType.until,isChanged=!0;else if(void 0!=applicableDateType.fromDate&&void 0!=applicableDateType.toDate){ZPeopleComponents.select(pageId.find("#dojCrt")).setValue("DOJ_FRM_TO"),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker").setFromValue(applicableDateType.fromDate),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker").setToValue(applicableDateType.toDate),(arr=[]).push(applicableDateType.fromDate),arr.push(applicableDateType.toDate),PMSV2Cycle.applObj.DOJfromTo=arr,isChanged=!0}if(void 0!=applicableDateType.monthList&&applicableDateType.monthList.length>0){var selectId=isChanged?"_2":"";isChanged&&PMSV2Cycle.addDateOfApplicableCriteria(),ZPeopleComponents.select(pageId.find("#dojCrt"+selectId)).setValue("DOJ_MTH"),ZPeopleComponents.select(pageId.find("#dojMthVal"+selectId)).setValue(applicableDateType.monthList),isChanged?PMSV2Cycle.applObj.DOJmonth_2=applicableDateType.monthList:PMSV2Cycle.applObj.DOJmonth=applicableDateType.monthList}isChanged||PMSV2Cycle.deleteDateOfApplicableCriteria(),PMSV2Cycle.applObj.DOJType=applicableDateType}}var tempArr=new Array;if(tmplVal.employeeType.length>0&&""!==tmplVal.employeeType){for(i=0;i<tmplVal.employeeType.length;i++)tempArr.push(tmplVal.employeeType[i].typeId);ZPeopleComponents.select(pageId.find("[keysel=APPL_EMPTYPE]")).setValue(tempArr),PMSV2Cycle.applObj.empType=tempArr}else ZPeopleComponents.select(pageId.find("[keysel=APPL_EMPTYPE]")).setValue([]);if(tempArr=new Array,tmplVal.designation.length>0&&""!==tmplVal.designation){for(tempArr=new Array,i=0;i<tmplVal.designation.length;i++)tempArr.push(tmplVal.designation[i].desId);ZPeopleComponents.select(pageId.find("[keysel=APPL_DES]")).setValue(tempArr),PMSV2Cycle.applObj.designation=tempArr}else ZPeopleComponents.select(pageId.find("[keysel=APPL_DES]")).setValue([]);if(tmplVal.location.length>0&&""!==tmplVal.location){for(PMSV2Cycle.addApplicableCriteria(null,"location"),tempArr=new Array,i=0;i<tmplVal.location.length;i++)tempArr.push(tmplVal.location[i].locationId);ZPeopleComponents.select(pageId.find("[keysel=APPL_LOC]")).setValue(tempArr),PMSV2Cycle.applObj.location=tempArr}if(tmplVal.role.length>0&&""!==tmplVal.role){for(PMSV2Cycle.addApplicableCriteria(null,"role"),tempArr=new Array,i=0;i<tmplVal.role.length;i++)tempArr.push(tmplVal.role[i].roleId);ZPeopleComponents.select(pageId.find("[keysel=APPL_ROLE]")).setValue(tempArr),PMSV2Cycle.applObj.role=tempArr}if(tmplVal.department.length>0&&""!==tmplVal.department){for(PMSV2Cycle.addApplicableCriteria(null,"department"),tempArr=new Array,i=0;i<tmplVal.department.length;i++)tempArr.push(tmplVal.department[i].departmentId);ZPeopleComponents.select(pageId.find("[keysel=APPL_DEP]")).setValue(tempArr),PMSV2Cycle.applObj.department=tempArr}if(tmplVal.level.length>0&&""!==tmplVal.level){for(PMSV2Cycle.addApplicableCriteria(null,"level"),tempArr=new Array,i=0;i<tmplVal.level.length;i++)tempArr.push(tmplVal.level[i].lvlID);ZPeopleComponents.select(pageId.find("[keysel=APPL_LVL]")).setValue(tempArr),PMSV2Cycle.applObj.level=tempArr}if(void 0!=tmplVal.customDateFCID&&"-1"!=tmplVal.customDateFCID){var obj={};PMSV2Cycle.addApplicableCriteria(null,"customDate");var selType=tmplVal.cdType;tmplVal.cdType;"1"==selType?(obj.selType=0,ZPeopleComponents.select(pageId.find("#cstCrt")).setValue("CST_DATE"),ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker").setFromValue(tmplVal.customFromDate),ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker").setToValue(tmplVal.customToDate),obj.from=tmplVal.customFromDate,obj.to=tmplVal.customToDate):(obj.selType=1,ZPeopleComponents.select(pageId.find("#cstCrt")).setValue("CST_MTH"),ZPeopleComponents.select(pageId.find("#cstMthVal")).setValue(tmplVal.customMonth),obj.month=tmplVal.customMonth),ZPeopleComponents.select(pageId.find("#cstKey")).setValue(tmplVal.customDateFCID),obj.customDate=tmplVal.customDateFCID,PMSV2Cycle.applObj.customDate=obj}if(void 0!=tmplVal.expFilter){PMSV2Cycle.addApplicableCriteria(null,"totalWrkExp");var expObj=tmplVal.expFilter,operator=expObj.operator;ZPeopleComponents.select(pageId.find("#expCrt")).setValue(operator),pageId.find("#expFrom").val(expObj.from);var arr=[];(obj={}).operator=expObj.operator,obj.from=expObj.from,5==operator&&(pageId.find("#expTo").val(expObj.to),obj.to=expObj.to),arr.push(obj),PMSV2Cycle.applObj.totalWrkExp=arr}pageId.find("#nwCylAppliDiv").removeClass("zpl_act"),ZPeopleComponents.daterangepicker("#cyPPrdPicker").setFromValue(tmplVal.periodStart),ZPeopleComponents.daterangepicker("#cyPPrdPicker").setToValue(tmplVal.periodEnd);var schedule=tmplVal.schedule;void 0!==schedule&&$.each(schedule,function(index,data2){"Self Appraisal"===data2.scheduleName?(ZPeopleComponents.daterangepicker("#cySAPrdPicker").setFromValue(data2.startdate),ZPeopleComponents.daterangepicker("#cySAPrdPicker").setToValue(data2.duedate)):"Appraisal"===data2.scheduleName?(ZPeopleComponents.daterangepicker("#cyRPrdPicker").setFromValue(data2.startdate),ZPeopleComponents.daterangepicker("#cyRPrdPicker").setToValue(data2.duedate)):"Normalization"===data2.scheduleName?(ZPeopleComponents.daterangepicker("#cyNrmPrdPicker").setFromValue(data2.startdate),ZPeopleComponents.daterangepicker("#cyNrmPrdPicker").setToValue(data2.duedate),!0):"REVIEW_PUBLISH"===data2.scheduleName&&"0"==tmplVal.publishOption&&(ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker").setFromValue(data2.startdate),ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker").setToValue(data2.duedate))}),null!=tmplVal.hikeFromDt&&null!=tmplVal.hikeToDt&&(ZPeopleComponents.daterangepicker("#cyHkPrdPicker").setFromValue(tmplVal.hikeFromDt),ZPeopleComponents.daterangepicker("#cyHkPrdPicker").setToValue(tmplVal.hikeToDt)),null!=tmplVal.hikePublishDt&&ZPeopleComponents.datetimefield(pageId.find("#cyHkPushID")).setValue(tmplVal.hikePublishDt),null!=tmplVal.MR_selectfromDate&&null!=tmplVal.MR_selecttoDate&&(ZPeopleComponents.daterangepicker("#cyMRSelPrdPicker").setFromValue(tmplVal.MR_selectfromDate),ZPeopleComponents.daterangepicker("#cyMRSelPrdPicker").setToValue(tmplVal.MR_selecttoDate)),null!=tmplVal.MR_fromDate&&null!=tmplVal.MR_toDate&&(ZPeopleComponents.daterangepicker("#cyMRFdBkPrdPicker").setFromValue(tmplVal.MR_fromDate),ZPeopleComponents.daterangepicker("#cyMRFdBkPrdPicker").setToValue(tmplVal.MR_toDate)),PMSV2Cycle.isApplAllowed=!0,PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck()}else pageId.find("#cycleType").prop("checked",!1);var filename;if(isCycleEdit||isCycleClone||!tmplVal.budgetEnable||(pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction(),PMSV2Cycle.budgetResetCalcFunc()),pageId.find("#reviewApprovalEnable").prop("checked",tmplVal.reviewApprovalEnable),tmplVal.reviewApprovalEnable?pageId.find("#reviewApprConf").show():pageId.find("#reviewApprConf").hide(),tmplVal.isSelfAppraisalEnabled){if(pageId.find("#saCrt,#saPeriodDiv").show(),PMSV2Cycle.postSelTgBtnAction("nwCylsaDetDiv",1),PMSV2Cycle.IS_SELF_ENABLED=!0,"null"!==tmplVal.selfappraisalform&&""!==tmplVal.selfappraisalform&&!isCycleClone&&null!==(filename=tmplVal.selfappraisalformDisname)&&void 0!==filename&&""!==filename){fileExtn=filename.substring(filename.lastIndexOf(".")+1,filename.length),attachFileHtml=PMSV2Cycle.getAttachFileHtml(decodeURIComponent(ZPeople.decodeTxt(filename)),fileExtn,"cycleself");$("#selfappFormid_beforeUpload").css("display","none"),$("#selfappFormid_afterUpload").parent().css("display","block"),$("#selfappFormid_afterUpload").append(attachFileHtml),pageId.find("#tempselffileupload").prop("checked",!0),pageId.find("#selfdocuploadsec").removeClass("DN"),PMSV2Cycle.SELFAPPFORMFILEID=tmplVal.selfappraisalform}}else pageId.find("#saCrt,#saPeriodDiv").hide(),PMSV2Cycle.postSelTgBtnAction("nwCylsaDetDiv",0),PMSV2Cycle.IS_SELF_ENABLED=!1;tmplVal.multiRaterEnabled?(pageId.find("#mrCrt,#mrPeriodDiv").show(),PMSV2Cycle.postSelTgBtnAction("nwCylmrDetDiv",1),PMSV2Cycle.IS_MR_ENABLED=!0):(pageId.find("#mrCrt,#mrPeriodDiv").hide(),PMSV2Cycle.postSelTgBtnAction("nwCylmrDetDiv",0),PMSV2Cycle.IS_MR_ENABLED=!1),tmplVal.budgetEnable?(pageId.find("#C_E_hike,#hkPeriodDiv").show(),PMSV2Cycle.postSelTgBtnAction("nwCylhkDetDiv",1),PMSV2Cycle.IS_SAL_HK_ENABLED=!0,isCycleEdit||isCycleClone||(void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1"),pageId.find("#empCurrencyAppliDiv").show()):(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1"),pageId.find("#empCurrencyAppliDiv").hide()))):(pageId.find("#C_E_hike,#hkPeriodDiv").hide(),PMSV2Cycle.postSelTgBtnAction("nwCylhkDetDiv",0),PMSV2Cycle.IS_SAL_HK_ENABLED=!1),tmplVal.normalizationEnable&&PMSV2Cycle.isPARatingEnabled?(pageId.find("#C_E_normalisation,#nrmPeriodDiv").show(),PMSV2Cycle.postSelTgBtnAction("nwCylnrmDetDiv",1),PMSV2Cycle.IS_NORM_ENABLED=!0):(pageId.find("#C_E_normalisation,#nrmPeriodDiv").hide(),PMSV2Cycle.postSelTgBtnAction("nwCylnrmDetDiv",0),PMSV2Cycle.IS_NORM_ENABLED=!1),PMSV2Cycle.getCourseTabDetails();let rtgCmVl=tmplVal.ratingCommentStatus;if(void 0!==rtgCmVl&&null!==rtgCmVl&&Object.keys(rtgCmVl).length>0){let saVl=rtgCmVl.selfObj;Object.keys(saVl).length>0&&PMSTmpl.setCheckBx("saModRtDetID","saQtPmTBody","saRQID","saQlPmTBody",saVl);let mrVl=rtgCmVl.mrObj;Object.keys(mrVl).length>0&&PMSTmpl.setCheckBx("mrModRtDetID","mrQtPmTBody","mrRQID","mrQlPmTBody",mrVl);let paVl=rtgCmVl.reviewObj;Object.keys(paVl).length>0&&PMSTmpl.setCheckBx("paModRtDetID","paQtPmTBody","paRQID","paQlPmTBody",paVl)}let isValidMRTypeStatus=!0;if((isCycleClone&&isCycleEdit||!isCycleClone&&!isCycleEdit)&&(void 0==PMSV2Cycle.mrTypeData||PMSV2Cycle.mrTypeData.isMrtypeComEnabled||(isValidMRTypeStatus=!1)),(!isCycleClone&&isCycleEdit||isValidMRTypeStatus)&&void 0!=tmplVal.mrTypebasedmodule&&tmplVal.mrTypebasedmodule){pageId.find("#mrTypeID").ztoggleswitch("switchOn");let showHideDiv=pageId.find("#mrTypeID").attr("showhidesec");pageId.find("#"+showHideDiv).removeClass("disabled")}if(isValidMRTypeStatus){let mrTypeObj=tmplVal.mrEnabledmodule;if(void 0!==mrTypeObj&&null!==mrTypeObj&&Object.keys(mrTypeObj).length>0){$.each(mrTypeObj,function(k,v){if("1"!==k)PMSV2Cycle.setMRTypeCheckBx(k,v)});let child=pageId.find("#mrQtPmTBody").children();PMSV2Cycle.mrTypeShowHide($(child[0]))}}if(tmplVal.multiRaterEnabled){let mrType=tmplVal.mrType,isMRAutoPopulateChk=!1;tmplVal.mrType>3&&(isMRAutoPopulateChk=!0,mrType=tmplVal.mrType-3,pageId.find("#mrAutoPopulate").ztoggleswitch("switchOn")),0===tmplVal.periodStatus&&!isCycleClone&&isCycleEdit?void 0!==tmplVal.defaultmrType&&void 0!=tmplVal.defaultmrtypeName&&(ZPeopleComponents.select(pageId.find("#mrTypeSelID")).removeAllOptions(),ZPeopleComponents.select(pageId.find("#mrTypeSelID")).addOption([{value:tmplVal.defaultmrType,id:tmplVal.defaultmrType,label:tmplVal.defaultmrtypeName}]),ZPeopleComponents.select(pageId.find("#mrTypeSelID")).setValue(tmplVal.defaultmrType)):(void 0!=PMSV2Cycle.mrtypes&&void 0!=PMSV2Cycle.mrtypes[tmplVal.defaultmrType]?ZPeopleComponents.select(pageId.find("#mrTypeSelID")).setValue(tmplVal.defaultmrType):ZPeopleComponents.select(pageId.find("#mrTypeSelID")).setValue(-1),isValidMRTypeStatus||ZPeopleComponents.select(pageId.find("#mrTypeSelID")).setValue(-1)),!isCycleClone&&isCycleEdit&&-1!==tmplVal.periodStatus||!isMRAutoPopulateChk?pageId.find("#mrSelTypeDiv").addClass("disabled"):isMRAutoPopulateChk?pageId.find("#mrSelTypeDiv").removeClass("disabled"):pageId.find("#mrSelTypeDiv").addClass("disabled"),isValidMRTypeStatus?pageId.find("#mrSelTypeDiv").show():pageId.find("#mrSelTypeDiv").hide(),pageId.find("#minrater").val(tmplVal.mrMinRater),pageId.find("#maxrater").val(tmplVal.mrMaxRater),1===mrType?(pageId.find("[hide=mrEmpSel]").show(),pageId.find("#mrEmpRepToRdBx").prop("checked",!0),pageId.find("#mrRepToRdBx").prop("checked",!1),pageId.find("#mrAnonID").prop("checked",!tmplVal.showRaterByRM)):2===mrType&&(pageId.find("#mrRepToRdBx").prop("checked",!0),pageId.find("#mrEmpRepToRdBx").prop("checked",!1),pageId.find("[hide=mrEmpSel]").hide()),tmplVal.isSelfAppraisalEnabled?(tmplVal.showSelfApprForMR?pageId.find("#selfApprViewForMR").prop("checked",!0):(pageId.find("#selfApprViewForMR").ztoggleswitch("switchOff"),pageId.find("#selfApprViewForMR").prop("checked",!1)),pageId.find("#mrSaFldDiv").show()):pageId.find("#mrSaFldDiv").hide()}ZPA_Approvers.loadApprovers(tmplVal.approvalArr);let retObj=PMSV2Cycle.getModWgtRtgCmtCntObj(!1),modWgtObj=tmplVal.modWeightage,isShowModWgt=retObj.sa.modRtgCnt>=2||retObj.mr.modRtgCnt>=2||retObj.pa.modRtgCnt>=2;if(!isCycleClone&&isCycleEdit||(isShowModWgt=!(!isShowModWgt||!PMSV2Cycle.IS_FINALSCORE_ENABLED)),isShowModWgt&&void 0!==modWgtObj&&null!==modWgtObj&&Object.keys(modWgtObj).length>0){var actModuleObj=PMSSetting.SEL_ENABLED_MODULES;let constructModWht=function(moduleObj,compId){let _whtHtml="",moduleWht=modWgtObj[moduleObj.compName];return void 0!==moduleWht&&null!==moduleWht&&""!==moduleWht&&(!isCycleClone&&isCycleEdit||1===moduleObj.enable)&&(_whtHtml="<tr><td>"+moduleObj.displayName+'</td><td><input compNme="'+moduleObj.compName+'" id="'+compId+'" type="text" class="ztextbox w60" value="'+moduleWht+'" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'moduleWeightage\');"></td></tr>'),_whtHtml},_htm=constructModWht(actModuleObj.GOALS,"goalMWgtID");if(_htm+=constructModWht(actModuleObj.KRA,"kraMWgtID"),_htm+=constructModWht(actModuleObj.KRA_GOALS,"kgMWgtID"),""!=(_htm+=constructModWht(actModuleObj.COMPETENCY,"compMWgtID"))){pageId.find("#modWgtTBody").html(_htm),pageId.find("#setModWgtID").ztoggleswitch("switchOn");let showHideDiv=pageId.find("#setModWgtID").attr("showhidesec");pageId.find("#"+showHideDiv).removeClass("disabled"),PMSV2Cycle.IS_MOD_WGT_ENABLED=!0,pageId.find("#modWgtDiv").show()}else pageId.find("#setModWgtID").ztoggleswitch("switchOff"),pageId.find("#modWgtDiv").hide(),PMSV2Cycle.IS_MOD_WGT_ENABLED=!1}else!isCycleClone&&isCycleEdit?pageId.find("#modWgtDiv").hide():isShowModWgt?pageId.find("#modWgtDiv").show():pageId.find("#modWgtDiv").hide(),PMSV2Cycle.IS_MOD_WGT_ENABLED=!1;!isCycleClone&&isCycleEdit||PMSV2Cycle.modWgtAction();let cnt=PMSV2Cycle.getCmtMdtyCnt();if(cnt>0){let cmtLen=tmplVal.moduleRatingType.minCommentLength;pageId.find("#cmtLenDiv").removeClass("DN"),""!==cmtLen&&pageId.find("#cmtLenInp").val(cmtLen)}else pageId.find("#cmtLenDiv").addClass("DN"),pageId.find("#cmtLenInp").val("");if((retObj=PMSV2Cycle.getModWgtRtgCnt()).rtgCnt>0||PMSV2Cycle.isCRBasedCycle()){pageId.find("#modRtgDiv,#overallRtgDiv").removeClass("zpl_DNI");let modRtgObj=tmplVal.moduleRatingType;if(void 0!==modRtgObj&&null!==modRtgObj&&Object.keys(modRtgObj).length>0){pageId.find("#modRtgDiv,#overallRtgDiv").removeClass("zpl_DNI");let noOfDig=modRtgObj.noOfDigits;0===modRtgObj.type?(ZPeopleComponents.select(pageId.find("#ratingType")).setValue("starRating"),pageId.find("#numRtgDiv,#txtRtgDiv").hide()):1===modRtgObj.type?(ZPeopleComponents.select(pageId.find("#ratingType")).setValue("numberRating"),pageId.find("#txtRtgDiv").hide(),pageId.find("#numRtgDiv").show(),pageId.find("#mnVl").val(1).addClass("disabled"),pageId.find("#mxVl").val(modRtgObj.max)):2===modRtgObj.type?(ZPeopleComponents.select(pageId.find("#ratingType")).setValue("textRating"),pageId.find("#numRtgDiv").hide(),pageId.find("#txtRtgDiv").show(),PMSV2Cycle.getTextRatingSec(!0,!0,!0,!0)):3===modRtgObj.type&&(ZPeopleComponents.select(pageId.find("#ratingType")).setValue("customRating"),pageId.find("#txtRtgDiv").hide(),pageId.find("#numRtgDiv").show(),pageId.find("#mnVl").val(modRtgObj.min).removeClass("disabled"),pageId.find("#mxVl").val(modRtgObj.max)),ZPeopleComponents.select(pageId.find("#ratingNoOfDigits")).setValue(noOfDig),modRtgObj.isNotApplicable?pageId.find("#notApplicable").prop("checked",!0):pageId.find("#notApplicable").prop("checked",!1),modRtgObj.roundOfRT?pageId.find("#rtRndOffID").prop("checked",!0):pageId.find("#rtRndOffID").prop("checked",!1),modRtgObj.isIncNoDataMod?pageId.find("#isIncNoDataMod").prop("checked",!0):pageId.find("#isIncNoDataMod").prop("checked",!1);let tySelRtgObj=PMSV2Cycle.getModWgtRtgCmtCntObj(!1);PMSV2Cycle.saEnableDisable(tySelRtgObj),PMSV2Cycle.mrEnableDisable(tySelRtgObj),PMSV2Cycle.paEnableDisable(tySelRtgObj);for(let i=0;i<tmplVal.hideaverage.length;i++)"SELF"===tmplVal.hideaverage[i]&&pageId.find("#selfaveragehide").prop("checked",!0),"MR"===tmplVal.hideaverage[i]&&pageId.find("#mraveragehide").prop("checked",!0),"REVIEW"===tmplVal.hideaverage[i]&&pageId.find("#reviewaveragehide").prop("checked",!0)}if(isCycleEdit&&!isCycleClone){tmplVal.cycleRatings.isRatingRangeEnabled?(PMSV2Cycle.getRatingWthRangeSec(!0,void 0,!0),pageId.find("#isRatingLockedDiv").show()):(PMSV2Cycle.getRatingSec(!0,!0),pageId.find("#isRatingLockedDiv").hide()),PMSV2Cycle.isCRBasedCycle()?pageId.find("#isRatingLockedDiv").hide():pageId.find("#isRatingLockedDiv").show()}else PMSV2Cycle.constructRatingSec(!0,void 0,!0);tmplVal.paRatingLock||tmplVal.saRatingLock?pageId.find("#isRatingLocked").prop("checked",!0):pageId.find("#isRatingLocked").prop("checked",!1)}else cnt>0?(pageId.find("[name=ratingSecn]").addClass("zpl_DNI"),pageId.find("#modRtgDiv").removeClass("zpl_DNI")):pageId.find("#modRtgDiv,#overallRtgDiv").addClass("zpl_DNI"),PMSV2Cycle.constructRatingSec(!0,void 0,!0);if(PMSV2Cycle.isCRBasedCycle()&&(cnt>0?pageId.find("#modRtgDiv").removeClass("zpl_DNI"):pageId.find("#modRtgDiv").addClass("zpl_DNI"),pageId.find("#overallRtgDiv").addClass("zpl_DNI")),tmplVal.budgetEnable){if(void 0!==tmplVal.hikeDecider&&null!==tmplVal.hikeDecider&&ZPeopleComponents.select(pageId.find("#hkApprSel")).setValue(tmplVal.hikeDecider),tmplVal.hikeApprovalEnable?(pageId.find("#hkApproval").prop("checked",!0),pageId.find("#hkApprConf").show()):(pageId.find("#hkApproval").prop("checked",!1),pageId.find("#hkApprConf").hide()),tmplVal.promotionOnHikeEnabled?pageId.find("#incProp").prop("checked",!0):pageId.find("#incProp").prop("checked",!1),isCycleEdit){let budgetData=tmplVal.budgetDetails;if(tmplVal.budgetEnable&&void 0!==budgetData&&Object.keys(budgetData).length>0){if(PMSV2Cycle.getHikeTerms(),!isCycleClone&&isCycleEdit)if(void 0!=tmplVal.compensationApplicableCurrencyStr)if(0!=tmplVal.periodStatus&&5!=tmplVal.periodStatus)void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue(tmplVal.compensationApplicableCurrency),pageId.find("#empCurrencyAppliDiv").show(),PMSV2Cycle.applObj.empCurrency=tmplVal.compensationApplicableCurrency):(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1"),pageId.find("#empCurrencyAppliDiv").hide());else if(0==pageId.find("#appCurrSelID").find("#"+tmplVal.compensationApplicableCurrency).length){var options=[{label:tmplVal.compensationApplicableCurrencyStr,value:tmplVal.compensationApplicableCurrency}];ZPeopleComponents.select(pageId.find("#appCurrSelID")).addOption(options),ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue(tmplVal.compensationApplicableCurrency),pageId.find("#empCurrencyAppliDiv").show()}else ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue(tmplVal.compensationApplicableCurrency),pageId.find("#empCurrencyAppliDiv").show();else 0!=tmplVal.periodStatus&&5!=tmplVal.periodStatus&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1"),pageId.find("#empCurrencyAppliDiv").show()):(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1"),pageId.find("#empCurrencyAppliDiv").hide());else isCycleClone&&(void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue(tmplVal.compensationApplicableCurrency),PMSV2Cycle.applObj.empCurrency=tmplVal.compensationApplicableCurrency,pageId.find("#empCurrencyAppliDiv").show()):pageId.find("#empCurrencyAppliDiv").hide());if(tmplVal.initBudgetLoad=!0,void 0!=PMSV2Cycle.applObj.designation&&0!=PMSV2Cycle.applObj.designation.length?PMSV2Cycle.APP_DESIGNATION=PMSV2Cycle.applObj.designation:PMSV2Cycle.APP_DESIGNATION=Object.keys(budgetData.designationList),void 0!=PMSV2Cycle.applObj.department&&0!=PMSV2Cycle.applObj.department.length?PMSV2Cycle.APP_DEPARTMENT=PMSV2Cycle.applObj.department:PMSV2Cycle.APP_DEPARTMENT=Object.keys(budgetData.departmentList),isCycleClone&&void 0==tmplVal.compensationApplicableCurrency&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource)pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction();else{var ruleDetails=budgetData.ruleDetails;PMSV2Cycle.hikeAmtArr={},PMSV2Cycle.SelCustArr=new Map,PMSV2Cycle.isChanged=!1,PMSV2Cycle.curRule=new Map,PMSV2Cycle.hikeAmtArr=budgetData.ruleAmt;let mode="add";PMSV2Cycle.isCycStarted=!1,isCycleClone||0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus?isCycleClone&&(mode="clone"):(PMSV2Cycle.isCycStarted=!0,mode="view"),pageId.find("#totalEmpCnt").text(budgetData.totalEmpCnt),pageId.find("#totalAmount").text(Number(budgetData.totalAmount).toFixed(2)),pageId.find("#totalAmount").attr("totalAmount",budgetData.totalAmount);let ruleLen=void 0!=ruleDetails&&ruleDetails.length>0?ruleDetails.length:0;if("view"==mode&&(ruleLen-=1),ruleLen>0?(PMSV2Cycle.hikeAmtObj={},"add"!=mode&&"view"!=mode||(PMSV2Cycle.hikeAmtObj=budgetData.ruleAmt),pageId.find("#hkBsdOn").find("#hikeBaseRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction(),PMSV2Cycle.buildCreatedCustomRules(budgetData,mode),pageId.find("#hikePercentage").val(parseFloat(budgetData.hikePercentage).toFixed(2))):(pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction()),"clone"==mode&&PMSV2Cycle.CHOSEN_CUST_OPT.includes("5"))pageId.find("#totalAmountAfterHike").text(parseFloat(budgetData.totalAmount).toFixed(2)),pageId.find("#totAmountView").text(parseFloat(0).toFixed(2)),pageId.find("#totalEmpCnt").text(budgetData.totalEmpCnt),pageId.find("#totalAmount").text(parseFloat(budgetData.totalAmount).toFixed(2));else if("add"==mode||"clone"==mode){PMSV2Cycle.checkTempRule(),pageId.find("#hikePercentage").val(parseFloat(budgetData.hikePercentage).toString()),pageId.find("#totAmountView").text(parseFloat(budgetData.totalcalcHikeAmount).toFixed(2));var totalAmt=Number(budgetData.totalcalcHikeAmount)+Number(budgetData.totalAmount);pageId.find("#totalAmountAfterHike").text(parseFloat(totalAmt).toFixed(2))}else if("view"==mode){var hikeAmount=parseFloat(budgetData.totalAmountAfterHike)-Number(budgetData.totalAmount);pageId.find("#totalAmountAfterHike").text(parseFloat(budgetData.totalAmountAfterHike).toFixed(2)),pageId.find("#totAmountView").text(parseFloat(hikeAmount).toFixed(2)),pageId.find("#hikePercentage").val(parseFloat(budgetData.hikePercentage).toString()),pageId.find("#hikePercentage").prop("disabled",!0),pageId.find("#hkBsdOn").find("[name=ruleOpt]").prop("disabled",!0)}if("clone"==mode&&ruleLen>1){let lastid=pageId.find(".zpl_paappslyhike").last().attr("series");PMSV2Cycle.SelCustArr.delete(lastid.toString())}}}}pageId.find("#enablehikedeviation").prop("checked",tmplVal.budgetDetails.hikedeviationenable),PMSV2Cycle.showHikedeviation(),tmplVal.budgetDetails.hikedeviationenable&&pageId.find("#hikedeviationper").val(parseFloat(tmplVal.budgetDetails.hikedeviationper).toFixed(2))}0===parseInt(tmplVal.publishOption)?pageId.find("#mnlRdBtn").prop("checked",!0):pageId.find("#autoRdBtn").prop("checked",!0),PMSV2Cycle.onPublishMethodAction(),isCycleEdit&&(null!=tmplVal.reviewPublishDt&&ZPeopleComponents.datetimefield(pageId.find("#cyMnlPubWthTimeID")).setValue(tmplVal.reviewPublishDt),void 0!==schedule&&$.each(schedule,function(index,data2){"REVIEW_PUBLISH"===data2.scheduleName&&"0"==tmplVal.publishOption&&(ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker").setFromValue(data2.startdate),ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker").setToValue(data2.duedate))})),pageId.find("#empApprFdbkID").prop("checked",tmplVal.shareFeedback),PMSV2Cycle.pubRtgAllower(),PMSV2Cycle.fldToPublish(),void 0!=tmplVal.courseListing&&(pageId.find("#courseListView").prop("checked",1==tmplVal.courseListing),pageId.find("#courseSuggestion").prop("checked",1==tmplVal.isCourseSugg)),isCycleEdit&&!isCycleClone&&fieldLockFlg&&(0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus||(pageId.find("#nwCylAppliDiv").addClass("zpl_act"),pageId.find("#cycleAppliDiv_nw").find("select").each(function(){ZPeopleComponents.select($(this)).setAttributes({disabled:!0})}),pageId.find("#cycleAppliDiv_doj_nw").find("select").each(function(){ZPeopleComponents.select($(this)).setAttributes({disabled:!0})}),pageId.find("#nwCylAppliDiv").removeClass("zpl_act"),pageId.find("#addCriDiv_DOJ").addClass("zpl_DNI"),pageId.find("#cycleAppliDiv_doj_nw .PI_delete").addClass("zpl_DNI"),pageId.find("#cycleAppliDiv_doj_nw").find("input").each(function(){let idx=$(this).attr("id");"dojVal1"==idx||"dojVal1_2"==idx?ZPeopleComponents.isComponent($(this))&&ZPeopleComponents.datefield($(this)).setAttributes({disabled:!0}):"dojVal"===idx?ZPeopleComponents.isComponent(pageId.find("#cyApplFrmToPrdPicker"))&&pageId.find("#dojVal").addClass("disabled"):"dojVal_2"==idx&&ZPeopleComponents.isComponent(pageId.find("#cyApplFrmToPrdPicker_2"))&&pageId.find("#dojVal_2").addClass("disabled")}),pageId.find("#cycleAppliDiv_nw").find("input").each(function(){let idx=$(this).attr("id");"dojVal1"===idx?ZPeopleComponents.isComponent($(this))&&ZPeopleComponents.datefield($(this)).setAttributes({disabled:!0}):"cstVal"===idx?ZPeopleComponents.isComponent("#cyApplCstPrdPicker")&&pageId.find("#cstVal").addClass("disabled"):"dojVal"===idx?ZPeopleComponents.isComponent(pageId.find("#cyApplFrmToPrdPicker"))&&pageId.find("#dojVal").addClass("disabled"):"expFrom"===idx?pageId.find("#expFrom").addClass("disabled"):"expTo"===idx&&pageId.find("#expTo").addClass("disabled")}),pageId.find("#cycleAppliDiv_nw").find(".PI_delete").addClass("zpl_DNI"),pageId.find("#appliAddButton").addClass("zpl_DNI")),PMSV2Cycle.moduleSelFreeze("nwCylsaDetDiv"),PMSV2Cycle.moduleSelFreeze("nwCylmrDetDiv"),PMSV2Cycle.moduleSelFreeze("nwCylpaDetDiv"),pageId.find("#approver_body").parent().parent().hide(),0===tmplVal.periodStatus&&(pageId.find("#reviewApprovalEnable").prop("disabled",!0),pageId.find("[name=mrSelRdBx]").attr("disabled","true")),0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus||(ZPeopleComponents.select(pageId.find("#hkApprSel")).setAttribute("disabled","disabled"),pageId.find("#hkApproval").prop("disabled",!0),ZPeopleComponents.isComponent(pageId.find("#hkFldType"))&&ZPeopleComponents.select(pageId.find("#hkFldType")).setAttribute("disabled","disabled")),(PMSV2Cycle.CLONE_CYCLE_FLAG||0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus)&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource||ZPeopleComponents.select(pageId.find("#appCurrSelID")).setAttribute("disabled","disabled"),void 0!=tmplVal.feedbackGiven&&tmplVal.feedbackGiven?pageId.find("#empApprFdbkID").prop("disabled",!0):pageId.find("#empApprFdbkID").prop("disabled",!1),pageId.find("#modRtgDiv .zpl_gboxwhti >div[tohide=true]").addClass("disabled"),pageId.find("#overallRtgDiv .zpl_gboxwhti").addClass("disabled"),ZPeopleComponents.toggleswitch(pageId.find("#setModWgtID")).disable(),pageId.find("#modWgtSecDiv").addClass("disabled"),pageId.find("#rtgDetDiv ul").addClass("disabled"),pageId.find("#rtgDetDiv #addRtgOpt").remove(),pageId.find("#rtgDetDiv .forDel").each(function(){$(this).addClass("zpl_DNI")}),PMSV2Cycle.IS_COURSE_ENABLE&&(pageId.find("#courseListView").prop("disabled","disabled"),pageId.find("#courseSuggestion").prop("disabled","disabled")))},checkTempRule:function(){let pageId=settingsPage.container,totLen=pageId.find("#custRules").find(".zpl_paappslyhike").length;var trLen=PMSV2Cycle.CHOSEN_CUST_OPT.length;for(let i=0;i<totLen;i++){for(var ruleDetMap=new Map,j=0;j<trLen;j++){let mode=PMSV2Cycle.CHOSEN_CUST_OPT[j];if(mode==PMSCommon.HIKE_DESIGNATION||mode==PMSCommon.HIKE_DEPARTMENT){let val=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield("#tot"+i+"_rule"+j+"_option").getAllValues());val.sort();let optLen=val.length;var str="";for(let iter=0;iter<optLen;iter++){var opt=val[iter].toString();str=(str=str.concat("_")).concat(opt)}if(0==optLen)return PMSV2Cycle.showError(ZPI18N.getString("zp.entervalidinput"),pageId.find("#tot"+i+"_rule"+j)),!1;1==mode?ruleDetMap.set("desList",str):ruleDetMap.set("deptList",str)}else if(mode==PMSCommon.HIKE_TOTAL_EXPERIENCE||mode==PMSCommon.HIKE_DATE_OF_JOIN&&!PMSV2Cycle.newDOJ){var val1=ZPeopleComponents.select("#tot"+i+"_rule"+j+"_option").getValue(),val2=pageId.find("#tot"+i+"_rule"+j+"_expFrom_1").val(),val3=-1;5==val1&&(val3=(val3=pageId.find("#tot"+i+"_rule"+j+"_expTo_1").val()).toString()),val1=val1.toString(),val2=val2.toString();str="";str=-1==val3?val1+"_"+val2:val1+"_"+val2+"_"+val3,2==mode?ruleDetMap.set("Experience",str):ruleDetMap.set("DateOfJoin",str)}else if(mode==PMSCommon.HIKE_DATE_OF_JOIN){var val=2!=(opt=ZPeopleComponents.select("#tot"+i+"_rule"+j+"_option").getValue())?ZPeopleComponents.datefield(pageId.find("#tot"+i+"_rule"+j+"_dojSel")).getValue().dateString:ZPeopleComponents.daterangepicker(pageId.find("#tot"+i+"_rule"+j+"_hkDoj")).getFromValue().fromValueString;val2=-1,val3=-1;2==opt&&(val2=val,val3=ZPeopleComponents.daterangepicker(pageId.find("#tot"+i+"_rule"+j+"_hkDoj")).getToValue().toValueString),str=2!=opt?opt+"_"+val:opt+"_"+val2+"_"+val3,ruleDetMap.set("DateOfJoin",str)}else if(mode==PMSCommon.HIKE_RATING){str=(val=ZPeopleComponents.select("#tot"+i+"_rule"+j+"_option").getValue()).toString();ruleDetMap.set("Rating",str)}}PMSV2Cycle.SelCustArr.set(i.toString(),ruleDetMap)}},moduleSelFreeze:function(mod){let pageId=settingsPage.container;pageId.find("#"+mod).find(".togbutton-js[showhidesec]").each(function(){let idT=$(this).attr("showhidesec");ZPeopleComponents.toggleswitch($(this)).disable(),"mrSelTypeDiv"!==idT&&(pageId.find("#"+idT).addClass("disabled"),pageId.find("#"+idT).find(".togbutton-js").each(function(){$(this).next().addClass("zpl_pe-n")}))})},getBudgetDataViewMode:function(hikeRuleType,budgetData){let pageId=settingsPage.container,ruleDetails=budgetData.ruleDetails;if(1===hikeRuleType){let _deshtm='<thead><tr id="rules_0"><th width="300">'+ZPI18N.getString("zp.designation")+'</th><th width="250">'+PMSV2Cycle.HIKENAME+'&nbsp;%</th><th width="250">'+PMSV2Cycle.HIKENAME+"&nbsp;"+ZPI18N.getString("zp.amount")+"</th></tr></thead>";_deshtm+="<tbody>",$.each(ruleDetails,function(index,data){let ruleData={},designame=((ruleData=ruleDetails[index]).expDetails,"");var i=0;$.each(ruleData.desList,function(index,data){if(PMSTmpl.DESIGNATION_LIST.hasOwnProperty(data)){let desObj=PMSTmpl.DESIGNATION_LIST[data];designame=""==designame?desObj.recName:designame+", "+desObj.recName}}),_deshtm+='<tr id="rules_'+i+'"> <td>'+designame+"</td> <td>"+ruleData.hikePer+"%</td> <td>"+ruleData.hikeAmt+"</td> </tr>",i++}),_deshtm+="</tbody>",pageId.find("#desRuleObj").html(_deshtm)}else{let _expOption={0:"=",1:"<",2:">",3:"<=",4:">=",5:ZPI18N.getString("zp.between")},_hdr='<thead><tr id="rules_0">';hikeRuleType==PMSCommon.HIKE_DATE_OF_JOIN?_hdr+='<th width="200">'+ZPI18N.getString("zp.dateofjoining")+"</th>":_hdr+='<th width="200">'+ZPI18N.getString("zp.totalworkexperience")+"</th>";let ruleHtm="<tbody>";var isfivetab=!1;$.each(ruleDetails,function(index,data){let ruleData={},expDetails=(ruleData=ruleDetails[index]).expDetails;3===Object.keys(expDetails).length&&(isfivetab=!0)});var i=1;$.each(ruleDetails,function(index,data){let ruleData={},expDetails=(ruleData=ruleDetails[index]).expDetails;ruleHtm+='<tr id="rules_'+i+'"> <td>'+_expOption[parseInt(expDetails.condType)]+"</td>",3===Object.keys(expDetails).length?ruleHtm+="<td>"+expDetails.condValue+"</td> <td>"+expDetails.condValueTo+"</td>":(ruleHtm+="<td>"+expDetails.condValue+"</td>",isfivetab&&(ruleHtm+="<td></td>")),ruleHtm+="<td>"+ruleData.hikePer+"%</td> <td>"+ruleData.hikeAmt+"</td> </tr>",i++}),ruleHtm+="</tbody>",isfivetab&&(_hdr+='<th width="200"></th>'),_hdr+='<th width="200"></th><th width="200">'+PMSV2Cycle.HIKENAME+'&nbsp;%</th><th width="200">'+PMSV2Cycle.HIKENAME+"&nbsp;"+ZPI18N.getString("zp.amount")+"</th></tr></thead>",_hdr+=ruleHtm,pageId.find("#expRuleObj").html(_hdr)}},setMRTypeCheckBx:function(k,v){let pageId=settingsPage.container,enableTg=!1;for(let i=0;i<v.length;i++){let idx="mrType_"+v[i]+"_"+k;pageId.find("#"+idx).prop("checked",!0),enableTg=!0}return enableTg},selTgBtnAction:function(event,data){if(event.detail.fromUI){var compName=data.element.attr("val"),status=data.state?1:0,pageId=settingsPage.container;1===status?pageId.find("[name="+compName+"]").show():pageId.find("[name="+compName+"]").hide()}},showHideTgBtnAction:function(event,data){if(event.detail.fromUI){var secName=data.element.attr("showhidesec"),status=data.state?1:0,pageId=settingsPage.container;1===status?(pageId.find("#"+secName).show(),PMSV2Cycle.rtgAction()):pageId.find("#"+secName).hide()}},moduleRtgSelAction:function(){settingsPage.container;let tySelRtgObj=PMSV2Cycle.getModWgtRtgCmtCntObj(!1);PMSV2Cycle.saEnableDisable(tySelRtgObj),PMSV2Cycle.mrEnableDisable(tySelRtgObj),PMSV2Cycle.paEnableDisable(tySelRtgObj),PMSV2Cycle.fldToPublish()},saEnableDisable:function(tySelRtgObj){let pageId=settingsPage.container,selfObj=tySelRtgObj.sa;!PMSV2Cycle.isCRBasedCycle()&&void 0!==selfObj&&selfObj.modCnt>0&&selfObj.modRtgCnt>0?(pageId.find("#selfaveragehide").parent().parent().show(),PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.SELF=!0):(pageId.find("#selfaveragehide").parent().parent().hide(),PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.SELF=!1)},mrEnableDisable:function(tySelRtgObj){let pageId=settingsPage.container,mrObj=tySelRtgObj.mr;!PMSV2Cycle.isCRBasedCycle()&&void 0!==mrObj&&mrObj.modCnt>0&&mrObj.modRtgCnt>0?(pageId.find("#mraveragehide").parent().parent().show(),PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.MR=!0):(pageId.find("#mraveragehide").parent().parent().hide(),PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.MR=!1)},paEnableDisable:function(tySelRtgObj){let pageId=settingsPage.container,paObj=tySelRtgObj.pa;!PMSV2Cycle.isCRBasedCycle()&&void 0!==paObj&&paObj.modCnt>0&&paObj.modRtgCnt>0?(pageId.find("#reviewaveragehide").parent().parent().show(),PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.REVIEW=!0):(pageId.find("#reviewaveragehide").parent().parent().hide(),PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.REVIEW=!1)},showDisabledTgBtnAction:function(event,data){if(!event.detail.fromUI)return;var secName=data.element.attr("showhidesec"),status=data.state?1:0,pageId=settingsPage.container;let proceedFlag=!0;if("mrTypeDiv"===secName){let isMRQtPmEnabled=ZPeopleComponents.toggleswitch(pageId.find("#mrModRtDetID")).getState(),isMRQlPmEnabled=ZPeopleComponents.toggleswitch(pageId.find("#mrRQID")).getState();if(isMRQtPmEnabled||isMRQlPmEnabled){let child=pageId.find("#mrQtPmTBody").children();PMSV2Cycle.mrTypeShowHide($(child[0]))}else proceedFlag=!1,$(data.element).ztoggleswitch("switchOff")}if(proceedFlag){let tBodyID=pageId.find("#"+secName).find("tbody").attr("id");if(1===status)if(pageId.find("#"+secName).removeClass("disabled"),"modWgtSecDiv"!==secName){let retObj=PMSV2Cycle.getModWgtRtgCmtCntObj();PMSV2Cycle.enableDisableAll(tBodyID,"on");let isRefreshRtg=PMSV2Cycle.isRefreshRatingRange(secName,void 0,retObj,0);PMSV2Cycle.rtgAction(isRefreshRtg)}else PMSV2Cycle.IS_MOD_WGT_ENABLED=!0;else pageId.find("#"+secName).addClass("disabled"),"modWgtSecDiv"!==secName?PMSV2Cycle.enableDisableAll(tBodyID,"off"):PMSV2Cycle.IS_MOD_WGT_ENABLED=!1}PMSV2Cycle.moduleRtgSelAction()},enableDisableAll:function(id,onOff,isRefreshRtg){var pageId=settingsPage.container;let txt="switchOff",inpCndt="input[type=checkbox]",retObj=null;"on"===onOff&&(txt="switchOn",inpCndt="mrTypeTBody"===id?"input[type=checkbox]":"input[enb=true]",retObj=PMSV2Cycle.getModWgtRtgCmtCntObj(!0));let isRtgAction=!1,trList=pageId.find("#"+id).children();if($.each(trList,function(k,v){$(this).find(".togbutton-js").ztoggleswitch(txt),$(this).find(".togbutton-js").next().css("pointer-events","off"==onOff?"none":""),$(this).find(inpCndt).each(function(){"on"===onOff?$(this)[0].checked=!0:(-1===$(this)[0].getAttribute("id").indexOf("_rtChkBx")||isRtgAction||(isRtgAction=$(this)[0].checked),$(this)[0].checked=!1)}),PMSV2Cycle.mrTypeShowHide(this)}),"off"===onOff&&(retObj=PMSV2Cycle.getModWgtRtgCmtCntObj(!0)),"off"!==onOff||"saQntParmDiv"!==id&&"saQtPmTBody"!==id&&"paQntParmDiv"!==id&&"paQtPmTBody"!==id&&"mrQntParmDiv"!==id&&"mrQtPmTBody"!==id||(isRefreshRtg=void 0==isRefreshRtg?isRtgAction:isRefreshRtg),isRefreshRtg=(void 0==isRefreshRtg||!0===isRefreshRtg)&&PMSV2Cycle.isRefreshRatingRange(id,void 0,retObj,0),PMSV2Cycle.rtgAction(isRefreshRtg),PMSV2Cycle.moduleRtgSelAction(),"mrQtPmTBody"===id||"mrQlPmTBody"===id){ZPeopleComponents.toggleswitch(pageId.find("#mrTypeID")).getState()&&retObj.mr.modCnt<=0&&!retObj.mr.QusAns&&(pageId.find("#mrTypeID").ztoggleswitch("switchOff"),pageId.find("#mrTypeDiv").addClass("disabled"),PMSV2Cycle.enableDisableAll("mrTypeTBody","off"))}},enableDisableModule:function(event,data){if(!event.detail.fromUI)return;var pageId=settingsPage.container,status=data.state?1:0;let retObj=null;1===status&&(retObj=PMSV2Cycle.getModWgtRtgCmtCntObj(!0));let obj=$(event.detail.element),tr=$(obj).parents("tr"),tBodyName=$(obj).attr("id").split("_")[0],inpCndt=1===status?"input[enb=true]":"input[type=checkbox]",moduleObj={};$(tr).find(inpCndt).each(function(){0==Object.getOwnPropertyNames(moduleObj).length&&(moduleObj.compName=$(this)[0].getAttribute("compname"));let chkBoxId=$(this)[0].getAttribute("id");"QUS_ANS"!==moduleObj.compName?-1!==chkBoxId.indexOf("_rtChkBx")&&(moduleObj.isRatingAction=$(this)[0].checked):moduleObj.isRatingAction=!1,$(this)[0].checked=1===status}),PMSV2Cycle.mrTypeShowHide(tr),0===status&&(retObj=PMSV2Cycle.getModWgtRtgCmtCntObj(!0));let isRefreshRtg=PMSV2Cycle.isRefreshRatingRange(tBodyName,moduleObj,retObj,0);if(PMSV2Cycle.rtgAction(isRefreshRtg),PMSV2Cycle.moduleRtgSelAction(),PMSV2Cycle.onModuleEnableDisableAllAction(obj,!1),"mrQtPmTBody"===tBodyName||"mrQlPmTBody"===tBodyName){ZPeopleComponents.toggleswitch(pageId.find("#mrTypeID")).getState()&&retObj.mr.modCnt<=0&&!retObj.mr.QusAns&&(pageId.find("#mrTypeID").ztoggleswitch("switchOff"),pageId.find("#mrTypeDiv").addClass("disabled"),PMSV2Cycle.enableDisableAll("mrTypeTBody","off"))}},mrTypeShowHide:function(tr){let tBody=$(tr).parents("tbody"),tBodyID=$(tBody).attr("id");if("mrQtPmTBody"===tBodyID||"mrQlPmTBody"===tBodyID){var pageId=settingsPage.container;let trChild=pageId.find("#mrQtPmTBody").children();$.each(trChild,function(k,v){let togObj=$(this).find(".togbutton-js"),modName=$(togObj).attr("modname");ZPeopleComponents.toggleswitch(togObj).getState()?pageId.find("#mrTypeDiv [mrtypename="+modName+"]").show():pageId.find("#mrTypeDiv [mrtypename="+modName+"]").hide()});let trChild1=pageId.find("#mrQlPmTBody").children();$.each(trChild1,function(k,v){let togObj=$(this).find(".togbutton-js"),modName=$(togObj).attr("modname");ZPeopleComponents.toggleswitch(togObj).getState()?pageId.find("#mrTypeDiv [mrtypename="+modName+"]").show():pageId.find("#mrTypeDiv [mrtypename="+modName+"]").hide()})}},buildQuantitativeParam:function(){performance.now();let tmplVal=PMSV2Cycle.SELECTED_TMPL,saMod=null,mrMod=null,paMod=null;void 0!==tmplVal&&null!==tmplVal&&(saMod=tmplVal.SA_moduleVal,mrMod=tmplVal.MR_moduleVal,paMod=tmplVal.Reviewer_moduleVal),PMSV2Cycle.showQuantitativeParam("sa","saQtPmTBody","saQlPmTBody",saMod),PMSV2Cycle.isCRBasedCycle()||PMSV2Cycle.showQuantitativeParam("mr","mrQtPmTBody","mrQlPmTBody",mrMod),PMSV2Cycle.showQuantitativeParam("pa","paQtPmTBody","paQlPmTBody",paMod)},showQuantitativeParam:function(mode,qtPmTBodyID,qlPmTBodyID,selData){var pageId=settingsPage.container,actModuleObj=PMSSetting.SEL_ENABLED_MODULES,kraObj=actModuleObj.KRA,goalObj=actModuleObj.GOALS,kgObj=actModuleObj.KRA_GOALS,comptObj=actModuleObj.COMPETENCY,tr="";let ids=[];if(PMSV2Cycle.isCRBasedCycle())pageId.find("#"+mode+"QtSecDiv").addClass("zpl_DNI");else{if(PMSV2Cycle.EDIT_CYCLE_FLAG&&PMSV2Cycle.CLONE_CYCLE_FLAG||!PMSV2Cycle.EDIT_CYCLE_FLAG&&!PMSV2Cycle.CLONE_CYCLE_FLAG)1===kgObj.enable?(tr+=PMSV2Cycle.getQtPmRowNew(qtPmTBodyID,kgObj),ids.push(qtPmTBodyID+"_"+kgObj.compName)):(1===kraObj.enable&&(tr+=PMSV2Cycle.getQtPmRowNew(qtPmTBodyID,kraObj),ids.push(qtPmTBodyID+"_"+kraObj.compName)),1===goalObj.enable&&(tr+=PMSV2Cycle.getQtPmRowNew(qtPmTBodyID,goalObj),ids.push(qtPmTBodyID+"_"+goalObj.compName))),1===comptObj.enable&&(tr+=PMSV2Cycle.getQtPmRowNew(qtPmTBodyID,comptObj),ids.push(qtPmTBodyID+"_"+comptObj.compName));else if(void 0!=selData&&null!=selData&&selData.length>0)for(let i=0;i<selData.length;i++){let m=selData[i];if("QUS_ANS"!==m){let modObj=PMSSetting.SEL_ENABLED_MODULES[m];tr+=PMSV2Cycle.getQtPmRowNew(qtPmTBodyID,modObj),ids.push(qtPmTBodyID+"_"+modObj.compName)}}""===tr||0===tr.length?pageId.find("#"+qtPmTBodyID).html(ZPI18N.getString("zp.performance.nomodulemsg")):pageId.find("#"+qtPmTBodyID).html(tr),pageId.find("#"+mode+"QtSecDiv").removeClass("zpl_DNI")}let QusAns=PMSSetting.SEL_ENABLED_MODULES.QUS_ANS;let reQObj={compName:"QUS_ANS",displayName:void 0!=QusAns.displayName?QusAns.displayName:ZPI18N.getString("zp.questionnaire")};if(pageId.find("#"+qlPmTBodyID).html(PMSV2Cycle.getQtPmRowNew(qlPmTBodyID,reQObj)),ids.push(qlPmTBodyID+"_"+reQObj.compName),PMSV2Cycle.moduleToggleAction(ids),"mrQtPmTBody"===qtPmTBodyID)if(PMSV2Cycle.EDIT_CYCLE_FLAG&&PMSV2Cycle.CLONE_CYCLE_FLAG||!PMSV2Cycle.EDIT_CYCLE_FLAG&&!PMSV2Cycle.CLONE_CYCLE_FLAG)if(void 0!=PMSV2Cycle.mrTypeData&&PMSV2Cycle.mrTypeData.isMrtypeComEnabled){let th="<tr><th>"+ZPI18N.getString("zp.parameter")+"</th>";1===kgObj.enable?th+="<th mrtypename="+kgObj.compName+">"+kgObj.displayName+"</th>":(1===kraObj.enable&&(th+="<th mrtypename="+kraObj.compName+">"+kraObj.displayName+"</th>"),1===goalObj.enable&&(th+="<th mrtypename="+goalObj.compName+">"+goalObj.displayName+"</th>")),1===comptObj.enable&&(th+="<th mrtypename="+comptObj.compName+">"+comptObj.displayName+"</th>"),th+="<th mrtypename="+reQObj.compName+">"+reQObj.displayName+"</th>",pageId.find("#mrTypeTHead").html(th);let tr="",cnt=0;$.each(PMSV2Cycle.mrtypes,function(index,data){if(0!=cnt){if(tr+='<tr id="mr_module_choice_'+index+'"><td><span>'+data+"</span></td>",1===kgObj.enable){let idx="mrType_"+kgObj.compName+"_"+index;tr+="<td mrtypename="+kgObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+kgObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>'}else{if(1===kraObj.enable){let idx="mrType_"+kraObj.compName+"_"+index;tr+="<td mrtypename="+kraObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+kraObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>'}if(1===goalObj.enable){let idx="mrType_"+goalObj.compName+"_"+index;tr+="<td mrtypename="+goalObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+goalObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>'}}if(1===comptObj.enable){let idx="mrType_"+comptObj.compName+"_"+index;tr+="<td mrtypename="+comptObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+comptObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>'}let idx="mrType_"+reQObj.compName+"_"+index;tr+="<td mrtypename="+reQObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+reQObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>',tr+="</tr>"}cnt+=1}),pageId.find("#mrTypeTBody").html(tr),pageId.find("#mrTypeIDSecDiv").show(),pageId.find("#mrTypeSecDiv").show(),pageId.find("#mrSelTypeDiv").show()}else pageId.find("#mrTypeIDSecDiv").hide(),pageId.find("#mrTypeSecDiv").hide(),pageId.find("#mrSelTypeDiv").hide();else if(void 0!=PMSV2Cycle.SELECTED_TMPL&&PMSV2Cycle.SELECTED_TMPL.mrTypebasedmodule){if(void 0!=selData&&null!=selData&&selData.length>0){let th="<tr><th>"+ZPI18N.getString("zp.parameter")+"</th>";for(let i=0;i<selData.length;i++){let m=selData[i];if("QUS_ANS"!==m){let modObj=PMSSetting.SEL_ENABLED_MODULES[m];th+="<th mrtypename="+modObj.compName+">"+modObj.displayName+"</th>"}}th+="<th mrtypename="+reQObj.compName+">"+reQObj.displayName+"</th>",pageId.find("#mrTypeTHead").html(th);let tr="",cnt=0;$.each(PMSV2Cycle.mrtypes,function(index,data){if(0!=cnt){tr+='<tr id="mr_module_choice_'+index+'"><td><span>'+data+"</span></td>";for(let i=0;i<selData.length;i++){let m=selData[i];if("QUS_ANS"!==m){let modObj=PMSSetting.SEL_ENABLED_MODULES[m],idx="mrType_"+modObj.compName+"_"+index;tr+="<td mrtypename="+modObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+modObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>'}}let idx="mrType_"+reQObj.compName+"_"+index;tr+="<td mrtypename="+reQObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+reQObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>',tr+="</tr>"}cnt+=1}),pageId.find("#mrTypeTBody").html(tr)}pageId.find("#mrTypeIDSecDiv").show(),pageId.find("#mrTypeSecDiv").show(),pageId.find("#mrSelTypeDiv").show()}else pageId.find("#mrTypeIDSecDiv").hide(),pageId.find("#mrTypeSecDiv").hide(),pageId.find("#mrSelTypeDiv").hide()},moduleToggleAction:function(ids){var pageId=settingsPage.container;$.each(ids,function(k,v){ZPeopleComponents.toggleswitch(pageId.find("#"+v)).setAttributes({change:PMSV2Cycle.enableDisableModule})})},getQtPmRowNew:function(prefix,obj){let rtShowFlg=!0;-1!==prefix.indexOf("QlPmTBody")&&(rtShowFlg=!1);let section="";"saQtPmTBody"===prefix||"saQlPmTBody"===prefix?section="sa":"mrQtPmTBody"===prefix||"mrQlPmTBody"===prefix?section="mr":"paQtPmTBody"!==prefix&&"paQlPmTBody"!==prefix||(section="pa");let rtgCntFlg="mrQtPmTBody"===prefix?"":"rtgcnt=yes",cmnPfx=prefix+"_"+obj.compName,mdtyLbl=ZPI18N.getString("zp.lms.mandatory"),tr='<tr id="tr_'+obj.compName+'">';if(tr+='<td><div class="zpl_idiv"><div class="zpl_tgl"><input id='+cmnPfx+" sect="+section+' modname="'+obj.compName+'" class="togbutton-js" style="display: none;">'+obj.displayName+'</div></div><div class="zpl_idiv"><em class="zpl_tgllftml">'+mdtyLbl+"</em></div></td>",rtShowFlg){let idPfx=cmnPfx+"_rtChkBx";tr+='<td><div class="zpl_idiv j-cnt-cntr"><div class="zcheckbox"><input id='+idPfx+" sect="+section+' enb=true compname="'+obj.compName+'" modname="'+obj.compName+'_Rating" '+rtgCntFlg+"  depid="+cmnPfx+' onclick="PMSV2Cycle.qtChkBox(this);" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idPfx+' class="zcheckbox__label"></label></div></div>',tr+='<div class="zpl_idiv j-cnt-cntr"><div class="zcheckbox"><input id='+(idPfx=cmnPfx+"_rtMdty")+" depid="+cmnPfx+' compname="'+obj.compName+'" onclick="PMSV2Cycle.mdtyChkBox(this);" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idPfx+' class="zcheckbox__label"></label></div></div></td>'}let idPfx1=cmnPfx+"_cmtChkBx";return tr+='<td><div class="zpl_idiv j-cnt-cntr"><div class="zcheckbox"><input id='+idPfx1+" sect="+section+' compname="'+obj.compName+'" enb=true depid='+cmnPfx+' onclick="PMSV2Cycle.qtChkBox(this);" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idPfx1+' class="zcheckbox__label"></label></div></div>',tr+='<div class="zpl_idiv j-cnt-cntr"><div class="zcheckbox"><input id='+(idPfx1=cmnPfx+"_cmtMdty")+" depid="+cmnPfx+' cmtmdty=true compname="'+obj.compName+'" onclick="PMSV2Cycle.mdtyChkBox(this);" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idPfx1+' class="zcheckbox__label"></label></div></div></td>',tr+="</tr>"},mdtyChkBox:function(obj){var pageId=settingsPage.container,val=$(obj).prop("checked"),id=$(obj).attr("id");let tBodyName=id.split("_")[0],compname=$(obj).attr("compname"),isalreadyCheck=!1;if(val){var modId=$(obj).attr("depid");pageId.find("#"+modId).prop("checked",val),-1!==id.indexOf("_rtMdty")?(isalreadyCheck=pageId.find("#"+modId+"_rtChkBx").is(":checked"),pageId.find("#"+modId+"_rtChkBx").prop("checked",val),pageId.find("#"+modId).ztoggleswitch("switchOn")):-1!==id.indexOf("_cmtMdty")&&(pageId.find("#"+modId+"_cmtChkBx").prop("checked",val),pageId.find("#"+modId).ztoggleswitch("switchOn"))}let retObj=PMSV2Cycle.getModWgtRtgCmtCntObj(),isRefreshRtg=!1;val&&(isRefreshRtg=PMSV2Cycle.isRefreshRatingRange(tBodyName,{compName:compname,isRatingAction:-1!==id.indexOf("_rtMdty"),isMandatoryAction:!0,prevRatingEnabled:isalreadyCheck},retObj,1)),PMSV2Cycle.rtgAction(isRefreshRtg),PMSV2Cycle.moduleRtgSelAction()},showHideCmtLenDiv:function(){var pageId=settingsPage.container;PMSV2Cycle.getCmtMdtyCnt()>0?pageId.find("#cmtLenDiv").removeClass("DN"):(pageId.find("#cmtLenDiv").addClass("DN"),pageId.find("#cmtLenInp").val(""))},onModuleEnableDisableAllAction:function(obj,isRefreshRtg){let table=$(obj).parents("table"),elements=table.find(".togbutton-js");var isAllEnable=!1;if($.each(elements,function(k,v){ZPeopleComponents.toggleswitch($(this)).getState()&&(isAllEnable=!0)}),!isAllEnable){let togObj=$(obj).parents("table").parent().parent().prev().find(".togbutton-js");ZPeopleComponents.toggleswitch(togObj).switchOff();let tBodyID=$(obj).parents("tbody").attr("id");table.addClass("disabled"),PMSV2Cycle.enableDisableAll(tBodyID,"off",isRefreshRtg)}},qtChkBox:function(obj){var pageId=settingsPage.container,val=$(obj).prop("checked");let txt=val?"switchOn":"switchOff",id=$(obj).attr("id"),tBodyName=id.split("_")[0];var modId=$(obj).attr("depid");let compname=$(obj).attr("compname");if(val)pageId.find("#"+modId).ztoggleswitch(txt);else if(-1!==id.indexOf("_rtChkBx"))pageId.find("#"+modId+"_rtMdty").prop("checked",val),pageId.find("#"+modId+"_cmtChkBx").prop("checked")||pageId.find("#"+modId).ztoggleswitch(txt);else if(-1!==id.indexOf("_cmtChkBx")){pageId.find("#"+modId+"_cmtMdty").prop("checked",val),pageId.find("#"+modId+"_rtChkBx").prop("checked")||pageId.find("#"+modId).ztoggleswitch(txt)}let retObj=PMSV2Cycle.getModWgtRtgCmtCntObj(!0),isRefreshRtg=PMSV2Cycle.isRefreshRatingRange(tBodyName,{compName:compname,isRatingAction:-1!==id.indexOf("_rtChkBx"),isMandatoryAction:!1},retObj,val?1:0);if(PMSV2Cycle.rtgAction(isRefreshRtg),PMSV2Cycle.moduleRtgSelAction(),"mrQtPmTBody"===tBodyName||"mrQlPmTBody"===tBodyName){let tr=$(obj).parents("tr");PMSV2Cycle.mrTypeShowHide(tr),ZPeopleComponents.toggleswitch(pageId.find("#mrTypeID")).getState()&&retObj.mr.modCnt<=0&&!retObj.mr.QusAns&&(pageId.find("#mrTypeID").ztoggleswitch("switchOff"),pageId.find("#mrTypeDiv").addClass("disabled"),PMSV2Cycle.enableDisableAll("mrTypeTBody","off"))}PMSV2Cycle.onModuleEnableDisableAllAction(obj,!1)},modTDChkBox:function(obj){var pageId=settingsPage.container,val=$(obj).prop("checked"),pId=$(obj).attr("id");val?(pageId.find("#"+pId+"_rtChkBx").prop("checked",val),pageId.find("#"+pId+"_cmtChkBx").prop("checked",val)):(pageId.find("#"+pId+"_rtChkBx").prop("checked",val),pageId.find("#"+pId+"_rtMdty").prop("checked",val),pageId.find("#"+pId+"_cmtChkBx").prop("checked",val),pageId.find("#"+pId+"_cmtMdty").prop("checked",val)),PMSV2Cycle.rtgAction(),PMSV2Cycle.moduleRtgSelAction()},addAppliCondt:function(){var pageId=settingsPage.container;let appliDiv=pageId.find("#cycleAppliDiv"),prevSeries=parseInt(pageId.find("#addCriDiv").prev().attr("series")),alreadySelKey=[];pageId.find("#cycleAppliDiv div[cnt^=series_]").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");alreadySelKey.push(val)});let selectDiv=PMSV2Cycle.getApplDiv(prevSeries+1);pageId.find("#addCriDiv").before(selectDiv);var div=pageId.find("#cycleAppliDiv div[series="+[prevSeries+1]+"]");alreadySelKey.length>=3&&appliDiv.find("#addCriDiv").remove(),(selOpt=div.find("select[type=keyFld]")).empty();let fstKey="",cnt=0;$.each(PMSV2Cycle.CYCLE_APPLICABLE_KEYS,function(key,value){-1===alreadySelKey.indexOf(key)&&(0===cnt&&(fstKey=key),selOpt.append(jQuery("<option />",{value:key,id:key}).html(value)),cnt+=1)}),selOpt.attr("keySel",fstKey),ZPeopleComponents.select(selOpt),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.onChangeKeySelect(edata)}),selOpt.on("zselectbeforedropdownlistopen",function(event,eData){PMSV2Cycle.refreshKeySelect(eData)});var selOpt=div.find("select[type=valFld]");PMSV2Cycle.initiateSelValData(fstKey,selOpt)},removeAppliCondtRow:function(obj){let div=$(obj).parent("div"),parentDiv=div.parent("div");div.remove(),parentDiv.find("#addCriDiv").remove(),parentDiv.append('<div id="addCriDiv" class="zpl_idiv"><a class="zpl_lnkbg" onclick="PMSV2Cycle.addAppliCondt();">'+ZPI18N.getString("zp.addcriteria")+"</a></div>")},refreshKeySelect:function(eData){let alreadySelKey=[];settingsPage.container.find("#cycleAppliDiv div[cnt^=series_]").each(function(){let val=$(this).find("select[type=keyFld]").attr("keySel");alreadySelKey.push(val)});let selOpt=$(eData.element[0]),selOptKey=selOpt.attr("keySel"),options=[],cnt=0,fstKey="";$.each(PMSV2Cycle.CYCLE_APPLICABLE_KEYS,function(key,value){if(-1===alreadySelKey.indexOf(key)||key===selOptKey){0===cnt&&(fstKey=key);var obj={};obj.label=value,obj.value=key,options.push(obj),cnt+=1}}),selOpt.attr("keySel",fstKey),ZPeopleComponents.select(selOpt).removeAllOptions(),ZPeopleComponents.select(selOpt).addOption(options)},onChangeKeySelect:function(eData,selectedFieldValues){if(eData&&(""===eData.selectedValue||eData.previousValue==eData.selectedValue))return;settingsPage.container;let selField=eData.selectedValue;$(eData.element[0]).attr("keySel",selField);var selOpt=$(eData.element[0]).parent("div").find("select[type=valFld");PMSV2Cycle.updateSelValData(selField,selOpt)},initiateSelValData:function(keySel,selOpt){selOpt.empty(),"APPL_LOC"===keySel?$.each(PMSV2Cycle.ALL_LOCATIONS,function(key,value){selOpt.append(jQuery("<option />",{value:value.locationId,id:value.locationId}).html(value.locationName))}):"APPL_ROLE"===keySel?$.each(PMSV2Cycle.ALL_ROLES,function(key,value){selOpt.append(jQuery("<option />",{value:value.roleId,id:value.roleId}).html(value.roleName))}):"APPL_DEP"===keySel?$.each(PMSV2Cycle.ALL_DEPARTMENTS,function(key,value){selOpt.append(jQuery("<option />",{value:value.departmentId,id:value.departmentId}).html(value.departmentName))}):"APPL_DES"===keySel&&$.each(PMSV2Cycle.ALL_DESIGNATION,function(key,value){selOpt.append(jQuery("<option />",{value:value.desId,id:value.desId}).html(value.desName))}),ZPeopleComponents.select(selOpt),ZPeopleComponents.select(selOpt).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder(keySel)}),selOpt.attr("keySel",keySel)},getPlaceHolder:function(keySel){var placeholder="";return"APPL_LOC"===keySel?placeholder=ZPI18N.getString("zp.alllocaction"):"APPL_ROLE"===keySel?placeholder=ZPI18N.getString("zp.allroles"):"APPL_DEP"===keySel?placeholder=ZPI18N.getString("zp.alldepartment"):"APPL_DES"===keySel?placeholder=ZPI18N.getString("zp.alldesignation"):"APPL_EMP_TYPE"===keySel&&(placeholder=ZPI18N.getString("zp.allEmpTypes")),placeholder},updateSelValData:function(keySel,selOpt){ZPeopleComponents.select(selOpt).destroy(),ZPeopleComponents.select(selOpt).removeAllOptions();var options=[];"APPL_LOC"===keySel?$.each(PMSV2Cycle.ALL_LOCATIONS,function(index,data){var obj={};obj.label=data.locationName,obj.value=data.locationId,options.push(obj)}):"APPL_ROLE"===keySel?$.each(PMSV2Cycle.ALL_ROLES,function(index,data){var obj={};obj.label=data.roleName,obj.value=data.roleId,options.push(obj)}):"APPL_DEP"===keySel?$.each(PMSV2Cycle.ALL_DEPARTMENTS,function(index,data){var obj={};obj.label=data.departmentName,obj.value=data.departmentId,options.push(obj)}):"APPL_DES"===keySel&&$.each(PMSV2Cycle.ALL_DESIGNATION,function(index,data){var obj={};obj.label=data.desName,obj.value=data.desId,options.push(obj)}),selOpt.attr("keySel",keySel),ZPeopleComponents.select(selOpt).addOption(options),ZPeopleComponents.select(selOpt).setAttributes({placeholder:PMSV2Cycle.getPlaceHolder(keySel)})},constructModWgt:function(){let pageId=settingsPage.container,actModuleObj=PMSSetting.SEL_ENABLED_MODULES,constructModWht=function(moduleObj,compId){let _whtHtml="";return 1===moduleObj.enable&&(_whtHtml="<tr><td>"+moduleObj.displayName+'</td><td><input compNme="'+moduleObj.compName+'" id="'+compId+'" type="text" class="ztextbox w60" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'moduleWeightage\');"></td></tr>'),_whtHtml},_htm="";1===actModuleObj.KRA_GOALS.enable?_htm=constructModWht(actModuleObj.KRA_GOALS,"kgMWgtID"):(_htm=constructModWht(actModuleObj.GOALS,"goalMWgtID"),_htm+=constructModWht(actModuleObj.KRA,"kraMWgtID")),""!=(_htm+=constructModWht(actModuleObj.COMPETENCY,"compMWgtID"))&&pageId.find("#modWgtTBody").html(_htm)},onRatingTypeAction:function(eData){if(!eData.fromUI)return;if(eData&&(""===eData.selectedValue||eData.previousValue==eData.selectedValue))return;var pageId=settingsPage.container;let selRtgTpe=eData.selectedValue,eleId=$(eData.element)[0].getAttribute("id");if(pageId.find("#mnVl").removeClass("ztextbox__error"),pageId.find("#mxVl").removeClass("ztextbox__error"),pageId.find("#numRtgDiv [elem=errorMsg]").remove(),pageId.find("#rtgSecDiv [elem=errorMsg]").remove(),"ratingType"===eleId)"starRating"===selRtgTpe?pageId.find("#numRtgDiv,#txtRtgDiv").hide():"numberRating"===selRtgTpe?(pageId.find("#txtRtgDiv").hide(),pageId.find("#numRtgDiv").show(),pageId.find("#mnVl").val(1).addClass("disabled"),pageId.find("#mxVl").val(5)):"textRating"===selRtgTpe?(pageId.find("#numRtgDiv").hide(),pageId.find("#txtRtgDiv").show(),PMSV2Cycle.getTextRatingSec(!0,!0,!0,!0)):"customRating"===selRtgTpe&&(pageId.find("#txtRtgDiv").hide(),pageId.find("#numRtgDiv").show(),pageId.find("#mnVl").val(0).removeClass("disabled"),pageId.find("#mxVl").val(10)),PMSV2Cycle.constructRatingSec(!0);else{"customRating"===pageId.find("#ratingType").val()?(PMSV2Cycle.updateRatingRangeValue(),PMSV2Cycle.constructRatingSec(!1)):PMSV2Cycle.constructRatingSec(!0)}},rtgAction:function(refresh,isUpdateNorm){performance.now();var pageId=settingsPage.container;if(PMSV2Cycle.isCRBasedCycle()){pageId.find("#modWgtDiv").hide(),PMSV2Cycle.IS_MOD_WGT_ENABLED=!1,pageId.find("#isIncNoDataMod").parent().parent().hide(),pageId.find("#overallRtgDiv").addClass("zpl_DNI"),PMSV2Cycle.getCmtMdtyCnt()>0?(pageId.find("#modRtgDiv").removeClass("zpl_DNI"),pageId.find("[name=ratingSecn]").addClass("zpl_DNI")):pageId.find("#modRtgDiv, [name=ratingSecn]").addClass("zpl_DNI")}else{let retObj=PMSV2Cycle.getModWgtRtgCmtCntObj(!1);PMSV2Cycle.IS_FINALSCORE_ENABLED&&(retObj.sa.modRtgCnt>=2||retObj.mr.modRtgCnt>=2||retObj.pa.modRtgCnt>=2)?(pageId.find("#modWgtDiv").show(),PMSV2Cycle.IS_MOD_WGT_ENABLED=!0,PMSV2Cycle.modWgtAction()):(pageId.find("#modWgtDiv").hide(),PMSV2Cycle.IS_MOD_WGT_ENABLED=!1);let rtgCnt=(retObj=PMSV2Cycle.getModWgtRtgCnt()).rtgCnt,cnt=PMSV2Cycle.getCmtMdtyCnt();rtgCnt>0||cnt>0?(rtgCnt>0?pageId.find("#overallRtgDiv, [name=ratingSecn]").removeClass("zpl_DNI"):pageId.find("[name=ratingSecn]").addClass("zpl_DNI"),pageId.find("#modRtgDiv").removeClass("zpl_DNI")):pageId.find("#modRtgDiv,#overallRtgDiv").addClass("zpl_DNI")}PMSV2Cycle.constructRatingSec(void 0===refresh||refresh,isUpdateNorm),PMSV2Cycle.showHideCmtLenDiv()},modWgtAction:function(){var pageId=settingsPage.container,actModuleObj=PMSSetting.SEL_ENABLED_MODULES;let chkConstrucModWgt=function(moduleObj,wgtId){let compName=moduleObj.compName;if(pageId.find("input[modname="+compName+"_Rating]").is(":checked")){if(0===pageId.find("#modWgtTBody #"+wgtId).length){let _wgtHtm="<tr><td>"+moduleObj.displayName+'</td><td><input compNme="'+compName+'" id="'+wgtId+'" type="text" class="ztextbox w60" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'moduleWeightage\');"></td></tr>';"GOALS"===compName||"KRA_GOALS"===compName?pageId.find("#modWgtTBody").prepend(_wgtHtm):"COMPETENCY"===compName?pageId.find("#modWgtTBody").append(_wgtHtm):"KRA"===compName&&(0===pageId.find("#modWgtTBody #goalMWgtID").length?pageId.find("#modWgtTBody").prepend(_wgtHtm):$(_wgtHtm).insertAfter(pageId.find("#modWgtTBody #goalMWgtID").closest("tr")))}pageId.find("#"+wgtId).removeClass("disabled").removeAttr("disabled")}else pageId.find("#"+wgtId).addClass("disabled").attr("disabled","true"),pageId.find("#"+wgtId).val("")};chkConstrucModWgt(actModuleObj.GOALS,"goalMWgtID"),chkConstrucModWgt(actModuleObj.KRA,"kraMWgtID"),chkConstrucModWgt(actModuleObj.KRA_GOALS,"kgMWgtID"),chkConstrucModWgt(actModuleObj.COMPETENCY,"compMWgtID")},getApplDiv:function(idx){return'<div class="zpl_idiv" cnt="series_'+idx+'" series="'+idx+'"><select class="select" type="keyFld" style="display: none;"></select><span>'+ZPI18N.getString("zp.is")+'</span><select class="select" type="valFld" style="display: none;" multiple="true"></select><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSV2Cycle.removeAppliCondtRow(this)"></i></div>'},getCmtMdtyCnt:function(){let rtgCnt=0,rtgChilds=settingsPage.container.find("input[cmtmdty=true]");return $.each(rtgChilds,function(k,v){$(this).prop("checked")&&(rtgCnt+=1)}),rtgCnt},getModWgtRtgCnt:function(){let rtgCnt=0,modInc=[],rtgChilds=settingsPage.container.find("input[id*=_rtChkBx]");return $.each(rtgChilds,function(k,v){let state=$(this).prop("checked"),cNm=$(this).attr("compname");state&&(rtgCnt+=1,-1===modInc.indexOf(cNm)&&modInc.push(cNm))}),{modInc:modInc,rtgCnt:rtgCnt}},getTypeWiseRtgCnt:function(withQA){let pageId=settingsPage.container,typeWsRtg={sa:0,mr:0,pa:0},rtgChilds=pageId.find("input[modname=KRA]");return $.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked");if(void 0!==compNme&&state){let t=typeWsRtg[compNme];typeWsRtg[compNme]=t+1}}),rtgChilds=pageId.find("input[modname=GOALS]"),$.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked");if(void 0!==compNme&&state){let t=typeWsRtg[compNme];typeWsRtg[compNme]=t+1}}),rtgChilds=pageId.find("input[modname=KRA_GOALS]"),$.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked");if(void 0!==compNme&&state){let t=typeWsRtg[compNme];typeWsRtg[compNme]=t+1}}),rtgChilds=pageId.find("input[modname=COMPETENCY]"),$.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked");if(void 0!==compNme&&state){let t=typeWsRtg[compNme];typeWsRtg[compNme]=t+1}}),withQA&&(rtgChilds=pageId.find("input[modname=QUS_ANS]"),$.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked");if(void 0!==compNme&&state){let t=typeWsRtg[compNme];typeWsRtg[compNme]=t+1}})),typeWsRtg},getModWgtRtgCmtCntObj:function(withQA){let pageId=settingsPage.container,finalObj={},selfObj={modCnt:0,modRtgCnt:0,modCmtCnt:0},mrObj={modCnt:0,modRtgCnt:0,modCmtCnt:0},paObj={modCnt:0,modRtgCnt:0,modCmtCnt:0},updateObjCnt=(compName,isModEnabled,isRtgEnabled,isCmtEnabled,isQA)=>{let tmpObj=void 0;if("sa"===compName?tmpObj=selfObj:"mr"===compName?tmpObj=mrObj:"pa"===compName&&(tmpObj=paObj),void 0!==compName&&void 0!==tmpObj){if(isModEnabled&&!isQA){let orgCnt=tmpObj.modCnt;tmpObj.modCnt=orgCnt+1,isRtgEnabled&&(orgCnt=tmpObj.modRtgCnt,tmpObj.modRtgCnt=orgCnt+1),isCmtEnabled&&(orgCnt=tmpObj.modCmtCnt,tmpObj.modCmtCnt=orgCnt+1)}isQA&&(tmpObj.QusAns=isModEnabled)}},moduleCompStatus=modName=>{let rtgChilds=pageId.find("input[modname="+modName+"]");$.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked"),id=$(this).attr("id"),isRtgEnabled=!1,isCmtEnabled=!1;if(void 0!==compNme&&state&&"QUS_ANS"!==modName){let rtgChkId=id+"_rtChkBx";isRtgEnabled=pageId.find("#"+rtgChkId).prop("checked"),rtgChkId=id+"_cmtChkBx",isCmtEnabled=pageId.find("#"+rtgChkId).prop("checked"),updateObjCnt(compNme,state,isRtgEnabled,isCmtEnabled,!1)}"QUS_ANS"===modName&&updateObjCnt(compNme,state,isRtgEnabled,isCmtEnabled,!0)})};return moduleCompStatus("KRA"),moduleCompStatus("GOALS"),moduleCompStatus("KRA_GOALS"),moduleCompStatus("COMPETENCY"),withQA&&moduleCompStatus("QUS_ANS"),finalObj.sa=selfObj,finalObj.mr=mrObj,finalObj.pa=paObj,finalObj},constructRatingSection:function(){performance.now(),settingsPage.container;PMSV2Cycle.isCRBasedCycle()?PMSV2Cycle.getRatingWthRangeSec(!0):PMSV2Cycle.getRatingSec(!0)},getTextRatingSec:function(refresh,add,edit,del){let pageId=settingsPage.container,ul='<div class="zpl_idiv flex-wrap">';if(refresh){let modRtgObj=null!==PMSV2Cycle.SELECTED_TMPL?PMSV2Cycle.SELECTED_TMPL.moduleRatingType:null;if(void 0!==modRtgObj&&null!==modRtgObj&&Object.keys(modRtgObj).length>0&&2===modRtgObj.type){PMSV2Cycle.textrating_name=modRtgObj.textRatingName,PMSV2Cycle.textrating_value=modRtgObj.textRatingValue;for(let itr=0;itr<PMSV2Cycle.textrating_name.length;itr++)PMSV2Cycle.textrating_name[itr]=ZPeople.decodeTxt(PMSV2Cycle.textrating_name[itr])}else PMSV2Cycle.textrating_name=[ZPI18N.getString("zp.unsatisfactory"),ZPI18N.getString("zp.needimprovement"),ZPI18N.getString("zp.satisfactory"),ZPI18N.getString("zp.excellent"),ZPI18N.getString("zp.outstanding")],PMSV2Cycle.textrating_value=[1,2,3,4,5]}let editOnClick="";for(let i=PMSV2Cycle.textrating_name.length-1;i>=0;i--){let rtgName=PMSV2Cycle.textrating_name[i];editOnClick=edit?'<input type="text" class="ztextbox" rtgNme="'+rtgName+'" value="'+rtgName+'" onchange="PMSV2Cycle.editTxtRtgFocusOut(this);">':'<span rtgNme="'+rtgName+'">'+rtgName+"</span>",ul+='<div class="zpl_iputgrp zpl_iputgrpcls" rtgNme="'+rtgName+'"><span>'+PMSV2Cycle.textrating_value[i]+"</span>"+editOnClick+'<i class="PI_cls" onclick="PMSV2Cycle.onDelTxtRtg(this);"></i></div>'}ul+="</div>",add&&(ul+='<div class="zpl_idiv" id="addTxtRtgBtn"><a class="zpl_lnkbg" onclick="PMSV2Cycle.newTxtRtgDiv();">'+ZPI18N.getString("zp.addrating")+"</a></div>"),pageId.find("#cstTxtRtgID").html(ul),PMSV2Cycle.textrating_name.length>=10&&pageId.find("#addTxtRtgBtn").addClass("zpl_DNI"),PMSV2Cycle.constructRatingSec(refresh)},newTxtRtgDiv:function(){let pageId=settingsPage.container;if(PMSV2Cycle.validateTextRatingName()){let newDiv='<div class="zpl_iputgrp zpl_iputgrpcls"><span>'+[PMSV2Cycle.textrating_name.length+1]+'</span><input id="newTxtRtgInp" type="text" class="ztextbox" value="" onchange="PMSV2Cycle.newTxtRtgFocusOut();"><i class="PI_cls" onclick="PMSV2Cycle.onDelTxtRtg(this);"></i></div>';pageId.find("#cstTxtRtgID .zpl_idiv.flex-wrap").prepend(newDiv),pageId.find("#addTxtRtgBtn").addClass("disabled"),pageId.find("#newTxtRtgInp").trigger("focus")}},showTxtRtgErrorMsg:function(isEmptyName,obj){let pageId=settingsPage.container,msg="";msg=isEmptyName?ZPI18N.getString("zp.ratingmandatory"):ZPI18N.getString("zp.ratinglengtherror"),$(obj).addClass("ztextbox__error"),$('<span elem="errorMsg" class="ztextbox--error__label">'+msg+"</span>").insertBefore(pageId.find("#addTxtRtgBtn")),$(pageId.find("#addTxtRtgBtn").siblings())[0].scrollIntoView({behavior:"smooth",block:"center"})},validateTextRatingName:function(){let isValid=!0,isEmptyName=!1,pageId=settingsPage.container,txtRatingChild=pageId.find("#txtRtgDiv #cstTxtRtgID .zpl_iputgrp"),errorObj=void 0;return $(txtRatingChild).each(function(index,obj){let rtgName=$(obj).find("input").val().trim();(void 0===rtgName||""===rtgName||rtgName.length>50)&&(void 0!==rtgName&&""!==rtgName||(isEmptyName=!0),isValid=!1,void 0===errorObj&&(errorObj=$(obj).find("input")))}),pageId.find("#cstTxtRtgID [elem=errorMsg]").remove(),isValid||PMSV2Cycle.showTxtRtgErrorMsg(isEmptyName,errorObj),isValid},newTxtRtgFocusOut:function(){let pageId=settingsPage.container,newRtg=pageId.find("#newTxtRtgInp").val().trim();pageId.find("#cstTxtRtgID").find("input").removeClass("ztextbox__error"),pageId.find("#cstTxtRtgID [elem=errorMsg]").remove(),void 0!==newRtg&&""!==newRtg&&newRtg.length<=50?(PMSV2Cycle.textrating_name.push(ZPeople.escapeHtml(newRtg)),PMSV2Cycle.textrating_value.push(PMSV2Cycle.textrating_name.length),pageId.find("#addTxtRtgBtn").removeClass("disabled"),PMSV2Cycle.getTextRatingSec(!1,!0,!0,!0)):PMSV2Cycle.showTxtRtgErrorMsg(void 0==newRtg||""==newRtg,pageId.find("#newTxtRtgInp"))},editTxtRtgFocusOut:function(obj){let pageId=settingsPage.container,rtgName=$(obj).val().trim();if(pageId.find("#cstTxtRtgID").find("input").removeClass("ztextbox__error"),pageId.find("#cstTxtRtgID [elem=errorMsg]").remove(),void 0!==rtgName&&""!==rtgName&&rtgName.length<=50){let oldRtgName=$(obj).attr("rtgnme"),index=PMSV2Cycle.textrating_name.indexOf(ZPeople.escapeHtml(oldRtgName));PMSV2Cycle.textrating_name[index]=ZPeople.escapeHtml(rtgName),PMSV2Cycle.getTextRatingSec(!1,!0,!0,!0)}else PMSV2Cycle.showTxtRtgErrorMsg(void 0==rtgName||""==rtgName,obj)},onDelTxtRtg:function(obj){if(PMSV2Cycle.textrating_name.length<=3)ZPeople.Message.warning(ZPI18N.getString("zp.minratreq"));else{let mainDiv=$(obj).parents("div"),rtgNme=$(mainDiv).attr("rtgNme"),pageId=settingsPage.container;if(pageId.find("#cstTxtRtgID").find("input").removeClass("ztextbox__error"),pageId.find("#cstTxtRtgID [elem=errorMsg]").remove(),void 0!=rtgNme&&""!=rtgNme){let idx=PMSV2Cycle.textrating_name.indexOf(ZPeople.escapeHtml(rtgNme));-1!==idx&&(PMSV2Cycle.textrating_name.splice(idx,1),PMSV2Cycle.textrating_value.splice(PMSV2Cycle.textrating_value.length-1,1))}}PMSV2Cycle.getTextRatingSec(!1,!0,!0,!0)},parseCycleRatings:function(){let cycleRtgArr=PMSV2Cycle.SELECTED_TMPL.cycleRatings.configArr,cnt=0;PMSV2Cycle.rating_keyarray=[],PMSV2Cycle.clone_Rating_Data={},PMSV2Cycle.cycle_rating={},PMSV2Cycle.rating_idarray=[],PMSV2Cycle.rating_minRangeArray=[],PMSV2Cycle.rating_maxRangeArray=[],PMSV2Cycle.rating_normPerArray=[];for(let i=cycleRtgArr.length-1;i>=0;i--)PMSV2Cycle.rating_keyarray[cnt]=cycleRtgArr[i].ratingName,PMSV2Cycle.rating_idarray[cnt]=cycleRtgArr[i].ratingId,void 0!==cycleRtgArr[i].minRange&&(PMSV2Cycle.rating_minRangeArray[cnt]=cycleRtgArr[i].minRange),void 0!==cycleRtgArr[i].maxRange&&(PMSV2Cycle.rating_maxRangeArray[cnt]=cycleRtgArr[i].maxRange),PMSV2Cycle.rating_normPerArray[cnt]=cycleRtgArr[i].norPer,cnt+=1},isRefreshRatingRange:function(tBodyName,moduleObj,rtgCntObj,refreshCnt){let checkRefresh=!1,isRefresh=!1,isMultiRater=!1,isSelfAppr=!1,isPaAppr=!1;if("saQntParmDiv"!==tBodyName&&"saQtPmTBody"!==tBodyName&&"paQntParmDiv"!==tBodyName&&"paQtPmTBody"!==tBodyName&&"mrQntParmDiv"!==tBodyName&&"mrQtPmTBody"!==tBodyName||(checkRefresh=!0,"saQntParmDiv"===tBodyName||"saQtPmTBody"===tBodyName?isSelfAppr=!0:"paQntParmDiv"===tBodyName||"paQtPmTBody"===tBodyName?isPaAppr=!0:"mrQntParmDiv"!==tBodyName&&"mrQtPmTBody"!==tBodyName||(isMultiRater=!0)),void 0!==moduleObj&&void 0!==moduleObj.compName&&void 0!==moduleObj.isRatingAction&&(checkRefresh="QUS_ANS"!==moduleObj.compName&&1==moduleObj.isRatingAction&&(void 0===moduleObj.isMandatoryAction||!moduleObj.isMandatoryAction||!moduleObj.prevRatingEnabled)),checkRefresh){let saCnt=0,paCnt=0,mrCnt=0,rfrCnt=parseInt(refreshCnt);if(void 0!==rtgCntObj){let moduleCnt=modCntObj=>void 0!==modCntObj&&void 0!==modCntObj.modRtgCnt?parseInt(modCntObj.modRtgCnt):0;saCnt=moduleCnt(rtgCntObj.sa),paCnt=moduleCnt(rtgCntObj.pa),mrCnt=moduleCnt(rtgCntObj.mr)}if(PMSV2Cycle.IS_FINALSCORE_ENABLED&&(PMSV2Cycle.isSARatingEnabled||PMSV2Cycle.isPARatingEnabled))if(isSelfAppr&&!PMSV2Cycle.isSARatingEnabled)isRefresh=0===paCnt&&saCnt+mrCnt===rfrCnt;else if(isPaAppr&&!PMSV2Cycle.isPARatingEnabled)isRefresh=0===saCnt&&paCnt+mrCnt===rfrCnt;else if(isMultiRater)isRefresh=0===saCnt&&0===paCnt&&mrCnt===rfrCnt;else{let totRtgCnt=PMSV2Cycle.isSARatingEnabled?saCnt:0;isRefresh=(totRtgCnt+=PMSV2Cycle.isPARatingEnabled?paCnt:0)===rfrCnt}else isRefresh=saCnt+paCnt+mrCnt===rfrCnt}return isRefresh},constructRatingSec:function(refresh,isUpdateNorm,isSetTmplValue){var pageId=settingsPage.container;let isCRBasedCycle=PMSV2Cycle.isCRBasedCycle(),isRatingRange=!1;if(isCRBasedCycle)isRatingRange=!!(PMSV2Cycle.IS_SELF_ENABLED&&PMSV2Cycle.isSARatingEnabled||PMSV2Cycle.isPARatingEnabled);else{let saModRtgCnt=PMSV2Cycle.getRtgCntWithOutMR("saQtPmTBody"),paModRtgCnt=PMSV2Cycle.getRtgCntWithOutMR("paQtPmTBody");isRatingRange=!!(PMSV2Cycle.isSARatingEnabled&&saModRtgCnt>=1||PMSV2Cycle.isPARatingEnabled&&paModRtgCnt>=1)}if(PMSV2Cycle.IS_FINALSCORE_ENABLED&&isRatingRange){PMSV2Cycle.getRatingWthRangeSec(refresh,isUpdateNorm,isSetTmplValue),isCRBasedCycle?pageId.find("#isRatingLockedDiv").hide():pageId.find("#isRatingLockedDiv").show(),0===parseInt(pageId.find("#ratingNoOfDigits").val())?pageId.find("#rtRndOffID").parent().parent().hide():pageId.find("#rtRndOffID").parent().parent().show()}else PMSV2Cycle.getRatingSec(refresh,isSetTmplValue),pageId.find("#isRatingLockedDiv").hide()},getRatingSec:function(refresh,isSetTmplValue){let pageId=settingsPage.container,ul='<ul class="zpl_cyclrg" rttype="default">',chosenRtgType=pageId.find("#ratingType").val();if(refresh){let modRtgObj=null!==PMSV2Cycle.SELECTED_TMPL?PMSV2Cycle.SELECTED_TMPL.moduleRatingType:null,selValChk=0;"starRating"===chosenRtgType?selValChk=0:"numberRating"===chosenRtgType?selValChk=1:"textRating"===chosenRtgType?selValChk=2:"customRating"===chosenRtgType&&(selValChk=3),isSetTmplValue&&void 0!==modRtgObj&&null!==modRtgObj&&Object.keys(modRtgObj).length>0&&modRtgObj.type===selValChk?PMSV2Cycle.parseCycleRatings():(PMSV2Cycle.rating_keyarray=[ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.unsatisfactory")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.needimprovement")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.satisfactory")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.excellent")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.outstanding"))],PMSV2Cycle.rating_idarray=[],PMSV2Cycle.rating_normPerArray=[],PMSV2Cycle.clone_Rating_Data={},PMSV2Cycle.cycle_rating={})}let add=!1,edit=!1,del=!1;if(PMSV2Cycle.getModWgtRtgCnt().rtgCnt>0){var len=PMSV2Cycle.rating_keyarray.filter(Boolean).length;if("starRating"===chosenRtgType)add=!1,edit=!0,del=!1;else if("numberRating"===chosenRtgType){let mx=parseInt(pageId.find("#mxVl").val());mx===len?(add=!1,edit=!0,del=!1):mx<len?(add=!1,edit=!0,del=!0):mx>len&&(add=!0,edit=!0,del=!1)}else if("textRating"===chosenRtgType){let txtlen=pageId.find("#cstTxtRtgID").find(".zpl_idiv.flex-wrap").children().length;txtlen===len?(add=!1,edit=!0,del=!1):txtlen<len?(add=!1,edit=!0,del=!0):txtlen>len&&(add=!0,edit=!0,del=!1)}else"customRating"===chosenRtgType&&(add=!0,edit=!0,del=!0)}else{if(PMSV2Cycle.isCRBasedCycle())add=!0;else(len=PMSV2Cycle.rating_keyarray.filter(Boolean).length)<10&&(add=!0);edit=!0,del=!0}let editOnClick="";edit&&(editOnClick='onclick="PMSV2Cycle.onEditOpen(this);"'),add&&(ul+='<li id="addRtgOpt"><a class="zpl_lnkbg" rttype="default" onclick="PMSV2Cycle.popForRatingChange(this);">'+ZPI18N.getString("zp.addrating")+"</a></li>"),PMSV2Cycle.cycle_rating={},PMSV2Cycle.clone_Rating_Data={};for(let i=PMSV2Cycle.rating_keyarray.length-1;i>=0;i--){let rtgName=PMSV2Cycle.rating_keyarray[i],isValid=PMSV2Cycle.EDIT_CYCLE_FLAG&&PMSV2Cycle.CLONE_CYCLE_FLAG,rtgID=void 0===PMSV2Cycle.rating_idarray[i]||isValid?"":PMSV2Cycle.rating_idarray[i];var obj;if(ul+='<li class="zpl_editmode" id="li_'+i+'" rttype="default" series="'+i+'" rating_id="'+rtgID+'"><div class="zpl_cyclrgsr"><span class="'+PMSV2Cycle.rating_keyarray_color[i]+'" rtgNme="'+rtgName+'" '+editOnClick+">"+rtgName+'</span></div><div class="zpl_hvr"><i class="PI_tick grn forEdt zpl_DNI" onclick="PMSV2Cycle.onEditClose(this);"></i><i class="PI_cls red forEdt zpl_DNI" onclick="PMSV2Cycle.closeRatingLi(this);"></i>',del&&(ul+='<i class="PI_delete forDel" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSV2Cycle.popForRatingChange(this);"></i>'),ul+="</div></li>",""!=rtgID)(obj={}).id=rtgID,obj.value=PMSV2Cycle.rating_keyarray[i],PMSV2Cycle.cycle_rating[i]=obj;else(obj={}).id=i+1,obj.value=PMSV2Cycle.rating_keyarray[i],PMSV2Cycle.cycle_rating[i]=obj,PMSV2Cycle.CLONE_CYCLE_FLAG&&void 0!=PMSV2Cycle.rating_idarray[i]&&(PMSV2Cycle.clone_Rating_Data[i+1]=PMSV2Cycle.rating_idarray[i])}ul+="</ul>",pageId.find("#rtgDetDiv").html(ul),PMSV2Cycle.getNormalizationRatingSection()},getRatingWthRangeSec:function(refresh,isUpdateNorm,isSetTmplValue){PMSV2Cycle.ISRATINGEDITOPEN=!1;let pageId=settingsPage.container,ratingDigits=parseInt(pageId.find("#ratingNoOfDigits").val());pageId.find("#rtRndOffID").is(":checked")&&(ratingDigits=0);let chosenRtgType=pageId.find("#ratingType").val(),isCstRtgType="customRating"===chosenRtgType;if(refresh){let modRtgObj=null!==PMSV2Cycle.SELECTED_TMPL?PMSV2Cycle.SELECTED_TMPL.moduleRatingType:null,isRangeEnabled=null===PMSV2Cycle.SELECTED_TMPL||PMSV2Cycle.SELECTED_TMPL.cycleRatings.isRatingRangeEnabled,selValChk=0;"starRating"===chosenRtgType?selValChk=0:"numberRating"===chosenRtgType?selValChk=1:"textRating"===chosenRtgType?selValChk=2:"customRating"===chosenRtgType&&(selValChk=3),isSetTmplValue&&void 0!==modRtgObj&&null!==modRtgObj&&Object.keys(modRtgObj).length>0&&modRtgObj.type===selValChk&&(PMSTmpl.isDiffRating(PMSV2Cycle.SELECTED_TMPL)||PMSV2Cycle.isCRBasedCycle())&&isRangeEnabled?PMSV2Cycle.parseCycleRatings():(PMSV2Cycle.rating_idarray=[],PMSV2Cycle.rating_normPerArray=[],PMSV2Cycle.rating_keyarray=[ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.unsatisfactory")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.needimprovement")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.satisfactory")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.excellent")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.outstanding"))],PMSV2Cycle.rating_minRangeArray=0===ratingDigits?isCstRtgType?[0,3,5,7,9]:[0,1,2,3,4]:1===ratingDigits?isCstRtgType?[0,2.1,4.1,6.1,8.1]:[0,1.1,2.1,3.1,4.1]:isCstRtgType?[0,2.01,4.01,6.01,8.01]:[0,1.01,2.01,3.01,4.01],PMSV2Cycle.rating_maxRangeArray=isCstRtgType?[2,4,6,8,10]:[1,2,3,4,5])}let add=!1,edit=!1,del=!1;var len=PMSV2Cycle.rating_keyarray.filter(Boolean).length,type=PMSCommon.STAR_RATING;if("starRating"===chosenRtgType)add=!1,edit=!0,del=!1,type=PMSCommon.STAR_RATING;else if("numberRating"===chosenRtgType){pageId.find("#mnVl").val(1).addClass("disabled");let mx=parseInt(pageId.find("#mxVl").val());mx===len?(add=!1,edit=!0,del=!1):mx<len?(add=!1,edit=!0,del=!0):mx>len&&(add=!0,edit=!0,del=!1),type=PMSCommon.NUMBER_RATING,mx}else if("textRating"===chosenRtgType){let txtlen=pageId.find("#cstTxtRtgID").find(".zpl_idiv.flex-wrap").children().length;txtlen===len?(add=!1,edit=!0,del=!1):txtlen<len?(add=!1,edit=!0,del=!0):txtlen>len&&(add=!0,edit=!0,del=!1),type=PMSCommon.TEXT_RATING,PMSV2Cycle.textrating_name.length}else"customRating"===chosenRtgType&&(add=!0,edit=!0,del=!0,type=PMSCommon.CUSTOM_RATING,len);let ul='<ul class="zpl_cyclrg" rttype="range">',editOnClick="";edit&&(editOnClick='onclick="PMSV2Cycle.onEditOpen(this);"'),add&&(ul+='<li id="addRtgOpt"><a class="zpl_lnkbg" rttype="range" onclick="PMSV2Cycle.popForRatingChange(this);">'+ZPI18N.getString("zp.addrating")+"</a></li>"),PMSV2Cycle.cycle_rating={},PMSV2Cycle.clone_Rating_Data={};for(let i=PMSV2Cycle.rating_keyarray.length-1;i>=0;i--){let rtgName=PMSV2Cycle.rating_keyarray[i],minValT=parseFloat(PMSV2Cycle.rating_minRangeArray[i]).toFixed(ratingDigits),maxValT=parseFloat(PMSV2Cycle.rating_maxRangeArray[i]).toFixed(ratingDigits),isValid=PMSV2Cycle.EDIT_CYCLE_FLAG&&PMSV2Cycle.CLONE_CYCLE_FLAG,rtgID=void 0===PMSV2Cycle.rating_idarray[i]||isValid?"":PMSV2Cycle.rating_idarray[i];ul+='<li class="zpl_editmode" id="li_'+i+'" rttype="range" series="'+i+'" rating_id="'+rtgID+'"><div class="zpl_cyclrgsr"><span class="'+PMSV2Cycle.rating_keyarray_color[i]+'" rtgNme="'+rtgName+'" '+editOnClick+">"+rtgName+"</span></div>",ul+='<div class="zpl_cyclrgvlu">';var digits=parseInt(ratingDigits);let inpCls="w60";var obj;if(type===PMSCommon.CUSTOM_RATING&&(inpCls="w80",digits=parseInt(ratingDigits)+3),PMSV2Cycle.IS_SAL_HK_ENABLED)if(""!=rtgID)(obj={}).id=rtgID,obj.value=PMSV2Cycle.rating_keyarray[i],PMSV2Cycle.cycle_rating[i]=obj;else(obj={}).id=i+1,obj.value=PMSV2Cycle.rating_keyarray[i],PMSV2Cycle.cycle_rating[i]=obj,PMSV2Cycle.CLONE_CYCLE_FLAG&&void 0!=PMSV2Cycle.rating_idarray[i]&&(PMSV2Cycle.clone_Rating_Data[i+1]=PMSV2Cycle.rating_idarray[i]);0===ratingDigits&&type!==PMSCommon.CUSTOM_RATING||(ul+='<div id="rtMinSpn_'+i+'" minV="'+minValT+'" '+editOnClick+'><input id="rtMinInp" name="rtMinRangeInp" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\''+digits+'\')" onkeyup="PMSV2Cycle.validateNewMinrange(this)" type="text" class="'+inpCls+' ztextbox" value="'+minValT+'"></div><em>-</em>'),ul+='<div id="rtMaxSpn_'+i+'" maxV="'+maxValT+'" '+editOnClick+'><input id="rtMaxInp" name="rtMaxRangeInp" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\''+digits+'\')" onkeyup="PMSV2Cycle.validateNewMaxrange(this)" type="text" class="ztextbox '+inpCls+'" value="'+maxValT+'"></div></div>',ul+='<div class="zpl_hvr"><i class="PI_tick grn forEdt zpl_DNI" onclick="PMSV2Cycle.onEditClose(this);"></i><i class="PI_cls red forEdt zpl_DNI" onclick="PMSV2Cycle.closeRatingLi(this);"></i>',del&&(ul+='<i class="PI_delete forDel" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSV2Cycle.popForRatingChange(this);"></i>'),ul+="</div></li>"}ul+="</ul>",pageId.find("#rtgDetDiv").html(ul),!refresh&&!isUpdateNorm||PMSV2Cycle.isCRBasedCycle()||PMSV2Cycle.getNormalizationRatingSection()},rtgMinMaxFocusOut:function(obj){let pageId=settingsPage.container,chosenRtgType=pageId.find("#ratingType").val(),elemId=$(obj).attr("id"),isValidScore=!0;if(pageId.find("#mxVl, #mnVl").removeClass("ztextbox__error"),pageId.find("#numRtgDiv [elem=errorMsg]").remove(),(isValidScore="mnVl"===elemId?PMSV2Cycle.validateMinScore(pageId.find("#mnVl"),!0):PMSV2Cycle.validateMaxScore(pageId.find("#mxVl"),!0))&&"mnVl"!==elemId?isValidScore=PMSV2Cycle.validateMinScore(pageId.find("#mnVl"),!0):isValidScore&&(isValidScore=PMSV2Cycle.validateMaxScore(pageId.find("#mxVl"),!0)),!isValidScore)return!1;"customRating"===chosenRtgType&&PMSV2Cycle.updateRatingRangeValue(),PMSV2Cycle.constructRatingSec(!1)},updateRatingRangeValue:function(crMin,crMax){let pageId=settingsPage.container;PMSV2Cycle.rating_minRangeArray=[],PMSV2Cycle.rating_maxRangeArray=[];let chosenRtgType=pageId.find("#ratingType").val(),mn=0,mx=void 0;"textRating"===chosenRtgType?mx=PMSV2Cycle.textrating_name.length:(mx=parseInt(pageId.find("#mxVl").val().trim()),PMSV2Cycle.isCRBasedCycle()&&(mx=void 0!==crMax?crMax:5));var allowedratings=mx;"customRating"===chosenRtgType&&(mn=parseInt(pageId.find("#mnVl").val().trim()),PMSV2Cycle.isCRBasedCycle()&&(mn=void 0!==crMin?crMin:0),allowedratings=mx-mn);var currentNoOfRatings=PMSV2Cycle.rating_keyarray.length,min=mn,max=min+parseFloat((allowedratings/currentNoOfRatings).toFixed(1)),increment=parseFloat((allowedratings/currentNoOfRatings).toFixed(1));let ratingDigits=parseInt(pageId.find("#ratingNoOfDigits").val());$("#rtRndOffID").is(":checked")&&(ratingDigits=0);for(let i=0;i<currentNoOfRatings;i++){PMSV2Cycle.rating_minRangeArray.push(min),PMSV2Cycle.rating_maxRangeArray.push(max);let minScore=parseInt(pageId.find("#mnVl").val().trim());PMSV2Cycle.isCRBasedCycle()&&(minScore=void 0!==crMin?crMin:0),0==min||min==minScore?1===ratingDigits?min=parseFloat((min+increment+.1).toFixed(1)):2===ratingDigits?min=parseFloat((min+increment+.01).toFixed(2)):0===ratingDigits&&(min=parseFloat(min+increment+1)):(min=parseFloat((min+increment).toFixed(parseInt(ratingDigits))),0===ratingDigits&&(min=max+1)),max=parseFloat((max+increment).toFixed(1));let maxScore=parseInt(pageId.find("#mxVl").val().trim());PMSV2Cycle.isCRBasedCycle()&&(maxScore=void 0!==crMax?crMax:5),max>maxScore&&(max=maxScore)}},getNormalizationRatingSection:function(){let pageId=settingsPage.container,ul='<ul class="zpl_cyclrg">',editData=(null!==PMSV2Cycle.SELECTED_TMPL?PMSV2Cycle.SELECTED_TMPL.cycleRatings.configArr:[]).length>0;for(let i=PMSV2Cycle.rating_keyarray.length-1;i>=0;i--){let v="";editData&&void 0!==PMSV2Cycle.rating_normPerArray[i]&&(v='value="'+PMSV2Cycle.rating_normPerArray[i]+'"'),ul+='<li id="li_'+i+'"><div class="zpl_cyclrgsr"><span class="'+PMSV2Cycle.rating_keyarray_color[i]+'">'+PMSV2Cycle.rating_keyarray[i]+'</span></div><div class="zpl_cyclrgvlu"><div class="ztextbox--group ztextbox--zicon zpl_inpticfild"><span class="ztextbox__icon">%</span><input id="nmRtMinInp_'+i+'" type="text" class="ztextbox w100" '+v+'  value="0"></div></div></li>'}pageId.find("#normRtgDetDiv").html(ul)},popForRatingChange:function(obj){PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck();let pageId=settingsPage.container;PMSV2Cycle.isBudgetCheck&&PMSV2Cycle.CHOSEN_CUST_OPT.includes("5")&&pageId.find("#custRules .zpl_paappslyhike").length>0?PMSV2Cycle.showratingChangePopUp(obj):"savenewRate"==$(obj).attr("id")?PMSV2Cycle.onAddRating(obj):"addRtgOpt"==$(obj).parent().attr("id")?PMSV2Cycle.addRatingRow(obj):PMSV2Cycle.onDeleteRtg(obj)},showratingChangePopUp:function(obj){let pageId=settingsPage.container;var infoAlertMessage=new InfoAlertMessage;infoAlertMessage.title="",infoAlertMessage.despcription=ZPI18N.getString("zp.ratingPopUp"),infoAlertMessage.yesButtonText=ZPI18N.getString("zp.reset"),infoAlertMessage.callback=function(){"savenewRate"==$(obj).attr("id")?PMSV2Cycle.onAddRating(obj):"addRtgOpt"==$(obj).parent().attr("id")?PMSV2Cycle.addRatingRow(obj):PMSV2Cycle.onDeleteRtg(obj),pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction(),PMSV2Cycle.isChanged=!1,PMSV2Cycle.empCntArr=new Map,PMSV2Cycle.hikeAmtArr={},PMSV2Cycle.SelCustArr=new Map,PMSV2Cycle.curRule=new Map},infoAlertMessage.show()},onDeleteRtg:function(obj){if(PMSV2Cycle.rating_keyarray.length<=3)return void ZPeople.Message.warning(ZPI18N.getString("zp.minratreq"));let li=$(obj).parents("li"),rtgNme=$(li).find(".zpl_cyclrgsr span").attr("rtgNme"),idx=PMSV2Cycle.rating_keyarray.indexOf(ZSEC.Encoder.encodeForHTML(rtgNme)),crMin=void 0,crMax=void 0;PMSV2Cycle.isCRBasedCycle()&&(crMin=parseInt(PMSV2Cycle.rating_minRangeArray[0]),crMax=parseInt(PMSV2Cycle.rating_maxRangeArray[PMSV2Cycle.rating_keyarray.length-1])),-1!==idx&&(PMSV2Cycle.rating_keyarray.splice(idx,1),PMSV2Cycle.rating_minRangeArray.splice(-1,1),PMSV2Cycle.rating_maxRangeArray.splice(-1,1)),$(obj).parent().find(".PI_tick").hasClass("zpl_DNI")||$(obj).parent().find(".PI_cls").hasClass("zpl_DNI")||(PMSV2Cycle.ISRATINGEDITOPEN=!1),"default"===$(li).attr("rttype")?PMSV2Cycle.getRatingSec(!1):(PMSV2Cycle.updateRatingRangeValue(crMin,crMax),PMSV2Cycle.getRatingWthRangeSec(!1,!0))},roundOffAction:function(){var pageId=settingsPage.container;if($("#rtRndOffID").is(":checked")){"customRating"===pageId.find("#ratingType").val()&&PMSV2Cycle.updateRatingRangeValue()}PMSV2Cycle.constructRatingSec(!1)},addRatingRow:function(obj){let ul=$(obj).parents("ul");if(!PMSV2Cycle.ISRATINGEDITOPEN){var pageId=settingsPage.container;let rtType=$(obj).attr("rttype"),newLi="",chosenRtgType=pageId.find("#ratingType").val(),ratingDigits=parseInt(pageId.find("#ratingNoOfDigits").val()),roundOff=pageId.find("#rtRndOffID").is(":checked");if($(pageId).find("#rtgDetDiv [name=rtMinRangeInp]").attr("disabled",!0),$(pageId).find("#rtgDetDiv [name=rtMaxRangeInp]").attr("disabled",!0),roundOff&&(ratingDigits=0),"default"===rtType)newLi='<li class="zpl_editmode" rttype="default"><div class="zpl_cyclrgsr"><span><input type="text" id="newRtgName"  class="ztextbox" placeholder="'+ZPI18N.getString("zp.newrtgph")+'"></span></div><div class="zpl_hvr"><i class="PI_tick grn forEdt" id="savenewRate" onclick="PMSV2Cycle.popForRatingChange(this);"></i><i class="PI_cls red forEdt" onclick="PMSV2Cycle.onAddRatingClose(this);"></i></div></li>',pageId.find("#isRatingLockedDiv").hide();else{newLi='<li class="zpl_editmode" rttype="range"><div class="zpl_cyclrgsr"><span><input type="text" id="newRtgName"  class="ztextbox" placeholder="'+ZPI18N.getString("zp.newrtgph")+'"></span></div><div class="zpl_cyclrgvlu">';var digits=parseInt(ratingDigits);let inpCls="w60";"customRating"===chosenRtgType&&(inpCls="w80",digits=parseInt(ratingDigits)+3),0===ratingDigits&&"customRating"!==chosenRtgType||(newLi+='<div id="rtMinSpn"><input id="rtMinInp" name="rtMinRangeInp" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\''+digits+'\')" type="text" class="ztextbox '+inpCls+'" placeholder="'+ZPI18N.getString("zp.min")+'"></div><em>-</em>'),newLi+='<div id="rtMaxSpn"><input id="rtMaxInp" name="rtMaxRangeInp" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\''+digits+'\')" type="text" class="ztextbox '+inpCls+'" placeholder="'+ZPI18N.getString("zp.max")+'"></div></div><div class="zpl_hvr"><i class="PI_tick grn forEdt" id="savenewRate" onclick="PMSV2Cycle.popForRatingChange(this);"></i><i class="PI_cls red forEdt" onclick="PMSV2Cycle.onAddRatingClose(this);"></i></div></li>',PMSV2Cycle.isCRBasedCycle()?pageId.find("#isRatingLockedDiv").hide():pageId.find("#isRatingLockedDiv").show()}$(ul).find("#addRtgOpt").after(newLi),pageId.find("#newRtgName").trigger("focus"),PMSV2Cycle.ISRATINGEDITOPEN=!0}},onAddRating:function(obj){let showErrorMsg=msg=>{let errobj=pageId.find("#rtgDetDiv").parent();$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+msg+"</span>"),$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"})};(pageId=settingsPage.container).find('[elem="errorMsg"]').remove();let li=$(obj).parents("li"),rtgType=$(li).attr("rttype"),rtgNme=$(li).find(".zpl_cyclrgsr span input").val();if(rtgNme.length<=0)showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.ratingnamemandatory"));else{if("default"===rtgType)PMSV2Cycle.rating_keyarray.push(ZSEC.Encoder.encodeForHTML(rtgNme)),PMSV2Cycle.getRatingSec(!1);else{var pageId=settingsPage.container;let li=$(obj).parents("li"),ratingDigits=parseInt(pageId.find("#ratingNoOfDigits").val());pageId.find("#rtRndOffID").is(":checked")&&(ratingDigits=0);var fixedDigits=0,incVal=0;if(1===ratingDigits)fixedDigits=1,incVal=.1;else if(2===ratingDigits)fixedDigits=2,incVal=.01;var parent=$(obj).parent().parent(),next=$(obj).parent().parent().next(),allowedMinrange=(parseFloat($(next).find('[name="rtMinRangeInp"]').val())+incVal).toFixed(fixedDigits);let chosenRtgType=pageId.find("#ratingType").val();var max=5,min=0;"customRating"===chosenRtgType&&(min=parseInt(pageId.find("#mnVl").val())),"numberRating"===chosenRtgType||"customRating"===chosenRtgType?max=parseInt(pageId.find("#mxVl").val()):"textRating"===chosenRtgType&&(max=pageId.find("#cstTxtRtgID").find(".zpl_idiv.flex-wrap").children().length);var minRange="";void 0!=$(parent).find('[name="rtMinRangeInp"]').val()&&(minRange=$(parent).find('[name="rtMinRangeInp"]').val().trim());var maxRange=$(parent).find('[name="rtMaxRangeInp"]').val().trim();if(("0"!=ratingDigits||"customRating"===chosenRtgType)&&""==minRange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangemandatory"));if(""==maxRange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangemandatory"));if(minRange=parseFloat(minRange),maxRange=parseFloat(maxRange),isNaN(minRange)&&("0"!=ratingDigits||"customRating"===chosenRtgType))return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangenumber"));if(isNaN(maxRange))return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangenumber"));if(min>minRange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[min]));if(minRange>max||maxRange>max)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxminrangelesserthan",[max]));if(("0"!=ratingDigits||"customRating"===chosenRtgType)&&minRange>maxRange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangelesserthanmaxrange"));if("0"==ratingDigits&&"customRating"!==chosenRtgType&&maxRange<=$(next).find('[name="rtMaxRangeInp"]').val())return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[$(next).find('[name="rtMaxRangeInp"]').val()]));if(minRange==maxRange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangecannotbeequalmaxrange"));if(minRange<=allowedMinrange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[allowedMinrange]));0===parseInt(ratingDigits)&&(incVal=1);let nwMin=$(li).find("#rtMinSpn input").val(),nwMax=$(li).find("#rtMaxSpn input").val();""===rtgNme||""===nwMin&&0!==parseInt(ratingDigits)||""===nwMax||(""==nwMin||isNaN(nwMin)||(PMSV2Cycle.rating_maxRangeArray[PMSV2Cycle.rating_keyarray.length-1]=parseFloat(nwMin-incVal).toFixed(fixedDigits),PMSV2Cycle.rating_minRangeArray.push(parseFloat(nwMin).toFixed(fixedDigits))),PMSV2Cycle.rating_keyarray.push(ZSEC.Encoder.encodeForHTML(rtgNme)),PMSV2Cycle.rating_maxRangeArray.push(parseFloat(nwMax).toFixed(fixedDigits)),PMSV2Cycle.getRatingWthRangeSec(!1,!0))}PMSV2Cycle.ISRATINGEDITOPEN=!1}},onAddRatingClose:function(obj){let li=$(obj).parents("li");$(li).remove(),PMSV2Cycle.ISRATINGEDITOPEN=!1;let pageId=settingsPage.container;$(pageId).find("#rtgDetDiv [name=rtMinRangeInp]").attr("disabled",!1),$(pageId).find("#rtgDetDiv [name=rtMaxRangeInp]").attr("disabled",!1),$(pageId).find("#rtgDetDiv").parent().find("[elem=errorMsg]").remove()},onEditOpen:function(obj){if(!PMSV2Cycle.ISRATINGEDITOPEN){let pageId=settingsPage.container;PMSV2Cycle.ISRATINGEDITOPEN=!0;let li=$(obj).parents("li"),rtgType=$(li).attr("rttype"),rtgNme=(parseInt(pageId.find("#ratingNoOfDigits").val()),$(li).find(".zpl_cyclrgsr span").text());if($(li).find(".zpl_cyclrgsr span").html('<input type="text" class="ztextbox" value="'+ZSEC.Encoder.encodeForHTMLAttribute(rtgNme)+'">'),"range"===rtgType){let series=$(li).attr("series");$(li).find("#rtMinSpn_"+series+" input").removeAttr("name"),$(li).find("#rtMaxSpn_"+series+" input").removeAttr("name"),$(pageId).find("#rtgDetDiv [name=rtMinRangeInp]").attr("disabled",!0),$(pageId).find("#rtgDetDiv [name=rtMaxRangeInp]").attr("disabled",!0),$(li).find("#rtMinSpn_"+series+" input").attr("disabled",!1),$(li).find("#rtMaxSpn_"+series+" input").attr("disabled",!1),$(li).find("#rtMinSpn_"+series).removeAttr("onclick"),$(li).find("#rtMaxSpn_"+series).removeAttr("onclick")}$(li).find(".forEdt").removeClass("zpl_DNI"),$(li).find(".zpl_cyclrgsr span").removeAttr("onclick"),"SPAN"==$(obj).prop("nodeName")?$(obj).parent().find("input").focus():$(obj).focus()}},onEditClose:function(obj){let pageId=settingsPage.container,li=$(obj).parents("li"),rtgType=$(li).attr("rttype"),series=$(li).attr("series"),ratingDigits=parseInt(pageId.find("#ratingNoOfDigits").val()),oldRtgNme=$(li).find(".zpl_cyclrgsr span").attr("rtgNme"),newRtgNme=$(li).find(".zpl_cyclrgsr span input").val(),roundOff=pageId.find("#rtRndOffID").is(":checked");if(newRtgNme.length<=0)ZPeople.Message.warning(ZPI18N.getString("zp.cycle.errormsg.ratingnamemandatory"));else{roundOff&&(ratingDigits=0);var fixedDigits=0,incVal=1;if(1===ratingDigits)fixedDigits=1,incVal=.1;else if(2==ratingDigits)fixedDigits=2,incVal=.01;var errorFlag=!1;if("range"===rtgType&&((errorFlag=PMSV2Cycle.validateNewMinrange($(li).find("#rtMinSpn_"+series+" input")))||(errorFlag=PMSV2Cycle.validateNewMaxrange($(li).find("#rtMaxSpn_"+series+" input")))),!errorFlag){let idx=PMSV2Cycle.rating_keyarray.indexOf(ZSEC.Encoder.encodeForHTML(oldRtgNme));if(-1!==idx&&(newRtgNme!=ZSEC.Encoder.encodeForHTML(oldRtgNme)&&(PMSV2Cycle.rating_keyarray[idx]=ZSEC.Encoder.encodeForHTML(newRtgNme),$(li).find(".zpl_cyclrgsr span").attr("rtgNme",ZSEC.Encoder.encodeForHTML(newRtgNme))),"range"===rtgType)){let oldMin=$(li).find("#rtMinSpn_"+series).attr("minv"),oldMax=$(li).find("#rtMaxSpn_"+series).attr("maxv"),nwMin=$(li).find("#rtMinSpn_"+series+" input").val(),nwMax=$(li).find("#rtMaxSpn_"+series+" input").val();nwMin!=oldMin&&(PMSV2Cycle.rating_minRangeArray[idx]=parseFloat(nwMin).toFixed(fixedDigits),PMSV2Cycle.rating_maxRangeArray[idx-1]=parseFloat(nwMin-incVal).toFixed(fixedDigits)),nwMax!=oldMax&&(PMSV2Cycle.rating_maxRangeArray[idx]=parseFloat(nwMax).toFixed(fixedDigits),idx<PMSV2Cycle.rating_maxRangeArray.length-1&&(PMSV2Cycle.rating_minRangeArray[idx+1]=(parseFloat(nwMax)+parseFloat(incVal)).toFixed(fixedDigits)))}PMSV2Cycle.ISRATINGEDITOPEN=!1,"range"===rtgType?PMSV2Cycle.getRatingWthRangeSec(!1,!0):PMSV2Cycle.getRatingSec(!1),PMSV2Cycle.isBudgetCheck&&PMSV2Cycle.CHOSEN_CUST_OPT.includes("5")&&(series=Number(series)+1,PMSV2Cycle.resetHkRating(series,newRtgNme))}}},resetHkRating:function(series,newRtgNme){let index=PMSV2Cycle.CHOSEN_CUST_OPT.indexOf("5");settingsPage.container.find("#custRules .zpl_paappslyhike").each(function(){var i=parseInt($(this).attr("series"));ZPeopleComponents.select("#tot"+i+"_rule"+index+"_option").setOptionAttributes(series.toString(),"label",newRtgNme)})},onNRKeyDown:function(val,evt,mode,extramode){var charCode=evt.which?evt.which:evt.keyCode;if(8===charCode||9===charCode||37===charCode||39===charCode)return!0;var value=val.value,splitArr=value.split(".");return!(value.length>2&&"2"!=mode&&"3"!=mode&&"4"!=mode&&"5"!=mode)&&((!(value.length>3)||"2"!=mode&&"3"!=mode)&&(!(value.length>1&&"0"==mode)&&(!(value.length>4&&"4"==mode)&&(!(value.length>5&&"5"==mode)&&((!(splitArr.length>1)||"0"!=mode&&"3"!=mode)&&((!(splitArr.length>1&&splitArr[1].length>0)||"1"!=mode&&"4"!=mode)&&((!(splitArr.length>1&&splitArr[1].length>1)||"2"!=mode&&"5"!=mode)&&(46==charCode||190==charCode||110==charCode?-1===value.indexOf("."):!(charCode>31&&(charCode<48||charCode>57&&charCode<96||charCode>105))&&!(splitArr.length>1&&splitArr[1].length>0&&splitArr[0].length>0&&"2"!=mode&&"3"!=mode&&"4"!=mode&&"5"!=mode)))))))))},onRatingScoreMaxMinKeyDown:function(val,evt){let mode="3";return"numberRating"===settingsPage.container.find("#ratingType").val()&&(mode="0"),PMSV2Cycle.onNRKeyDown(val,evt,mode)},validateMinScore:function(obj,isShowMsg){let showErrorMsg=msg=>{let errobj=$(obj).parent().parent();$(obj).addClass("ztextbox__error"),$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+msg+"</span>"),$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"})};var pageId=settingsPage.container,minScore=$(obj).val().trim();isShowMsg&&($(obj).removeClass("ztextbox__error"),$(obj).parent().parent().find("[elem=errorMsg]").remove());let ratingDigits=parseInt(pageId.find("#ratingNoOfDigits").val()),roundOff=pageId.find("#rtRndOffID").is(":checked"),chosenRtgType=pageId.find("#ratingType").val();return roundOff&&(ratingDigits="0"),""==minScore?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangemandatory")),!1):(minScore=Number(minScore),isNaN(minScore)?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangenumber")),!1):Number.isInteger(minScore)?minScore<0?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangenotnegative")),!1):minScore>=parseInt($("#mxVl").val())?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangelesserthan",[$("#mxVl").val()])),!1):!("0"==ratingDigits&&"customRating"===chosenRtgType&&Number($("#mxVl").val())-minScore<PMSV2Cycle.rating_keyarray.length)||(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minandmaxrangediffgreaterthan",[PMSV2Cycle.rating_keyarray.length])),!1):(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangenotdecimal")),!1))},validateMaxScore:function(obj,isShowMsg){let showErrorMsg=msg=>{let errobj=$(obj).parent().parent();$(obj).addClass("ztextbox__error"),$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+msg+"</span>"),$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"})};var pageId=settingsPage.container,maxScore=$(obj).val().trim();isShowMsg&&($(obj).removeClass("ztextbox__error"),$(obj).parent().parent().find("[elem=errorMsg]").remove());let ratingDigits=parseInt(pageId.find("#ratingNoOfDigits").val()),roundOff=pageId.find("#rtRndOffID").is(":checked"),chosenRtgType=pageId.find("#ratingType").val(),maxValueAllowed=10;return"customRating"===chosenRtgType&&(maxValueAllowed=1e3),roundOff&&(ratingDigits="0"),""==maxScore?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangemandatory")),!1):(maxScore=Number(maxScore),isNaN(maxScore)?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangenumber")),!1):Number.isInteger(maxScore)?maxScore<=parseInt($("#mnVl").val())?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangegreaterthan",[$("#mnVl").val()])),!1):"numberRating"===chosenRtgType&&maxScore<=2?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangegreaterthan",[2])),!1):maxScore>maxValueAllowed?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangelesserthan",[maxValueAllowed])),!1):!("0"==ratingDigits&&"customRating"===chosenRtgType&&maxScore-Number($("#mnVl").val())<PMSV2Cycle.rating_keyarray.length)||(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minandmaxrangediffgreaterthan",[PMSV2Cycle.rating_keyarray.length])),!1):(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangenotdecimal")),!1))},validateNewMinrange:function(obj){var errorFlag=!1,errMsg="";let pageId=settingsPage.container;if(pageId.find('[elem="errorMsg"]').remove(),void 0===$(obj).val())return;var minValue=$(obj).val().trim(),maxValue=""!=$(obj).parent().parent().find("#rtMaxInp").val()?$(obj).parent().parent().find("#rtMaxInp").val().trim():"";let ratingDigits=parseInt(pageId.find("#ratingNoOfDigits").val()),roundOff=pageId.find("#rtRndOffID").is(":checked"),chosenRtgType=pageId.find("#ratingType").val();roundOff&&(ratingDigits=0);var fixedDigits=0,incVal=1;if(1===ratingDigits)fixedDigits=1,incVal=.1;else if(2==ratingDigits)fixedDigits=2,incVal=.01;var checkMin=!1;0==ratingDigits&&"customRating"!==chosenRtgType||(checkMin=!0);var child=$(obj).parent().parent().parent().next();checkMin&&""==minValue&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangemandatory")),minValue=parseFloat(minValue),checkMin&&isNaN(minValue)&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangenumber"));var series=$(child).attr("series"),nextRowMin=""!=$(child).find("#rtMinSpn_"+series+" input").val()?$(child).find("#rtMinSpn_"+series+" input").val():"";if(!errorFlag&&0!=ratingDigits&&minValue<=(parseFloat(nextRowMin)+parseFloat(incVal)).toFixed(fixedDigits)?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[(parseFloat(nextRowMin)+parseFloat(incVal)).toFixed(fixedDigits)])):!errorFlag&&0==ratingDigits&&"customRating"===chosenRtgType&&minValue<=parseFloat(nextRowMin).toFixed(fixedDigits)?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[parseFloat(nextRowMin).toFixed(fixedDigits)])):!errorFlag&&checkMin&&""==nextRowMin&&minValue<0?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthanorequal",[0])):!errorFlag&&"customRating"===chosenRtgType&&""==nextRowMin&&minValue<parseInt(pageId.find("#mnVl").val())?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthanorequal",[pageId.find("#mnVl").val()])):!errorFlag&&checkMin&&""!=maxValue&&minValue>=maxValue&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangelesserthan",[maxValue])),errorFlag){let errobj=pageId.find("#rtgDetDiv").parent();return $(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>"),$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"}),$(obj).parent().parent().parent().find(".PI_tick").css("opacity","0.4"),$(obj).parent().parent().parent().find(".PI_tick").css("cursor","not-allowed"),$(obj).parent().parent().parent().find(".PI_tick").removeAttr("onclick"),errorFlag}return $(obj).parent().parent().parent().find(".PI_tick").css("opacity",""),$(obj).parent().parent().parent().find(".PI_tick").css("cursor",""),$(obj).parent().parent().parent().find(".PI_tick").attr("onclick","PMSV2Cycle.onEditClose(this);"),errorFlag},validateNewMaxrange:function(obj){var errorFlag=!1,errMsg="";let pageId=settingsPage.container;pageId.find('[elem="errorMsg"]').remove();var maxValue=$(obj).val().trim(),minValue=0;void 0!==$(obj).parent().parent().find("#rtMinInp").val()&&(minValue=$(obj).parent().parent().find("#rtMinInp").val().trim());let ratingDigits=parseInt(pageId.find("#ratingNoOfDigits").val()),roundOff=pageId.find("#rtRndOffID").is(":checked"),chosenRtgType=pageId.find("#ratingType").val();var max=5;"numberRating"===chosenRtgType||"customRating"===chosenRtgType?max=pageId.find("#mxVl").val():"textRating"===chosenRtgType&&(max=pageId.find("#cstTxtRtgID").find(".zpl_idiv.flex-wrap").children().length),roundOff&&(ratingDigits=0);var fixedDigits=0,incVal=0;1===ratingDigits?(fixedDigits=1,incVal=.1):2==ratingDigits&&(fixedDigits=2,incVal=.01);var parent=$(obj).parent().parent().parent().prev(),child=$(obj).parent().parent().parent().next();""==(maxValue=parseFloat(maxValue))&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangemandatory")),isNaN(maxValue)&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangenumber"));var series=$(parent).attr("series"),parentMax=""!=$(parent).find("#rtMaxSpn_"+series+" input").val()?$(parent).find("#rtMaxSpn_"+series+" input").val():"",chseries=$(child).attr("series");if(!errorFlag&&""!=parentMax&&void 0!=parentMax&&maxValue>=(parseFloat(parentMax)-parseFloat(incVal)).toFixed(fixedDigits)?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangelesserthan",[(parseFloat(parentMax)-parseFloat(incVal)).toFixed(fixedDigits)])):!errorFlag&&(""==parentMax||void 0==parentMax)&&maxValue>max?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangelesserthanorequal",[max])):!errorFlag&&("0"!=ratingDigits||"customRating"===chosenRtgType)&&maxValue<=minValue?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangegreaterthan",[minValue])):!errorFlag&&"0"==ratingDigits&&maxValue<=$(child).find("#rtMaxSpn_"+chseries+" input").val()&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangegreaterthan",[$(child).find("#rtMaxSpn_"+chseries+" input").val()])),errorFlag){let errobj=pageId.find("#rtgDetDiv").parent();return $(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>"),$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"}),$(obj).parent().parent().parent().find(".PI_tick").css("opacity","0.4"),$(obj).parent().parent().parent().find(".PI_tick").css("cursor","not-allowed"),$(obj).parent().parent().parent().find(".PI_tick").removeAttr("onclick"),errorFlag}return $(obj).parent().parent().parent().find(".PI_tick").css("opacity",""),$(obj).parent().parent().parent().find(".PI_tick").css("cursor",""),$(obj).parent().parent().parent().find(".PI_tick").attr("onclick","PMSV2Cycle.onEditClose(this);"),errorFlag},showError:function(errMsg,obj,extraParentCnt){$(obj).addClass("ztextbox__error");let objT=$(obj).parent();void 0!=extraParentCnt&&2==extraParentCnt?objT=$(obj).parent().parent():void 0!=extraParentCnt&&1==extraParentCnt?objT=$(obj).parent():void 0!=extraParentCnt&&3==extraParentCnt&&(objT=$(obj).parent().parent().parent()),0==$(objT).find('[elem="errorMsg"]').length?$(objT).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>"):$(objT).find('[elem="errorMsg"]').text(errMsg),$(objT)[0].scrollIntoView({behavior:"smooth",block:"center"})},removeError:function(){let pageId=settingsPage.container;pageId.find(".ztextbox__error").removeClass("ztextbox__error"),pageId.find('[elem="errorMsg"]').remove()},validateCycleName:function(){let cycleName=settingsPage.container.find("#cycleName").val().trim(),isValidName=!0;if(void 0!=PMSOperation.temp&&PMSOperation.temp.length>0){for(let cycObj of PMSOperation.temp)if(void 0!==cycObj&&cycObj.rawPeriodName===cycleName&&(PMSV2Cycle.EDIT_CYCLE_FLAG&&!PMSV2Cycle.CLONE_CYCLE_FLAG&&cycObj.configId!==PMSV2Cycle.SELECTED_TMPL.configId||PMSV2Cycle.CLONE_CYCLE_FLAG||!PMSV2Cycle.EDIT_CYCLE_FLAG)){isValidName=!1;break}if(!isValidName)return!1}return!0},basicDetValidation:function(){let pageId=settingsPage.container,isValid=!0;return pageId.find("#cycleName").val().trim().length<=0&&(isValid=!1,PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.emptycycle"),pageId.find("#cycleName"))),PMSV2Cycle.validateCycleName()||(PMSV2Cycle.showError(ZPI18N.getString("zp.duplicateSkill",[ZPI18N.getString("zp.salaryhikecyclename",[""])]),pageId.find("#cycleName")),isValid=!1),pageId.find("#cycleDesc").val().trim().length>5e3&&(isValid=!1,PMSV2Cycle.showError(ZPI18N.getString("zp.fieldpropertymaxlength",[ZPI18N.getString("zp.local.AdditionalNotes"),"5000 characters"]),pageId.find("#cycleDesc"))),isValid},mrValidation:function(){let pageId=settingsPage.container,isValid=!0;if(ZPeopleComponents.toggleswitch(pageId.find("#mrAutoPopulate")).getState()&&("-1"===pageId.find("#mrTypeSelID").val()&&void 0!=PMSV2Cycle.mrTypeData&&PMSV2Cycle.mrTypeData.isMrtypeComEnabled&&PMSV2Cycle.mrTypeData.isMrtypeMandatary)){isValid=!1;let errMsg=ZPI18N.getString("zp.selectmrtype",[PMSV2Cycle.multiraterName]);PMSV2Cycle.showError(errMsg,pageId.find("#mrTypeSelID"),2)}1===parseInt(pageId.find("[name=mrSelRdBx]:checked").val())&&(""!=PMSV2Cycle.isMR_apprConf&&PMSV2Cycle.isMR_apprConf||(isValid=!1,PMSV2Cycle.showError(ZPI18N.getString("zp.mrapprerrmsg"),pageId.find("[tit=mrapprconfig]"),1)));let errMsg="",mnHghBox="",mxHghBox="",mnTmp=pageId.find("#minrater").val().trim(),mxTmp=pageId.find("#maxrater").val().trim();if(""===mnTmp||""===mxTmp)""===mnTmp&&(mnHghBox=!0),""===mxTmp&&(mxHghBox=!0),errMsg=ZPI18N.getString("zp.mrcounterror1"),isValid=!1;else{let min=parseInt(mnTmp),max=parseInt(mxTmp);isNaN(min)||isNaN(max)?(errMsg=ZPI18N.getString("zp.fieldupdate.numbererror"),isValid=!1):min<=0||max<=0?(errMsg=ZPI18N.getString("zp.mrcounterror1"),isValid=!1,mnHghBox=!0,mxHghBox=!0):min>=max?(errMsg=ZPI18N.getString("zp.mrcounterror2"),isValid=!1,mnHghBox=!0):max>120&&(errMsg=ZPI18N.getString("zp.mrcounterror3"),isValid=!1,mxHghBox=!0)}if(errMsg.length>0){let obj=pageId.find("#minrater").parent();mnHghBox&&pageId.find("#minrater").addClass("ztextbox__error"),mxHghBox&&pageId.find("#maxrater").addClass("ztextbox__error"),0==$(obj).find('[elem="errorMsg"]').length?$(obj).after('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>"):$(obj).find('[elem="errorMsg"]').text(errMsg),$(obj)[0].scrollIntoView({behavior:"smooth",block:"center"})}return isValid},rtgValidation:function(){let pageId=settingsPage.container,isValid=!0;if(!!PMSV2Cycle.IS_MOD_WGT_ENABLED&&ZPeopleComponents.toggleswitch("#setModWgtID").getState()){let validateModuleWeightage=compId=>{let isValidWeight=!0;if(void 0!==pageId.find("#modWgtTBody #"+compId)[0]&&!pageId.find("#modWgtTBody #"+compId).hasClass("disabled")){let value=pageId.find("#modWgtTBody #"+compId).val();(null===value||isNaN(value)||parseInt(value)<0||parseInt(value)>100)&&(isValidWeight=!1)}return isValidWeight};var actModuleObj=PMSSetting.SEL_ENABLED_MODULES,kraObj=actModuleObj.KRA,goalObj=actModuleObj.GOALS,kgObj=actModuleObj.KRA_GOALS,comptObj=actModuleObj.COMPETENCY;let modWgtTBody=pageId.find("#modWgtTBody"),moduleIds=[{id:"kgMWgtID",name:kgObj.displayName},{id:"kraMWgtID",name:kraObj.displayName},{id:"goalMWgtID",name:goalObj.displayName},{id:"compMWgtID",name:comptObj.displayName}];if(moduleIds.some(({id:id})=>{let value=pageId.find("#modWgtTBody #"+id).val();return null!==value&&!isNaN(value)&&parseInt(value)>0})){for(const{id:id,name:name}of moduleIds)if(!validateModuleWeightage(id)){PMSV2Cycle.showError(ZPI18N.getString("zp.pleaseenterweightage",[name]),$(modWgtTBody).parent(),2),isValid=!1;break}}else PMSV2Cycle.showError(ZPI18N.getString("zp.atleastonemoduleweightage"),$(modWgtTBody).parent(),2),isValid=!1;if(isValid){let trChd=$(modWgtTBody).children(),k=0,g=0,c=0,kg=0;$.each(trChd,function(key,val){let inp=$(this).find("input"),cNm=$(inp).attr("compNme"),value=$(inp).val().trim();"KRA"===cNm?!isNaN(value)&&value.length>0&&(k=parseFloat(value)):"GOALS"===cNm?!isNaN(value)&&value.length>0&&(g=parseFloat(value)):"KRA_GOALS"===cNm?!isNaN(value)&&value.length>0&&(kg=parseFloat(value)):"COMPETENCY"===cNm&&!isNaN(value)&&value.length>0&&(c=parseFloat(value))}),100!==k+g+kg+c&&(isValid=!1,PMSV2Cycle.showError(ZPI18N.getString("zp.setweightageerr"),$(trChd).parent(),2))}}if(PMSV2Cycle.getModWgtRtgCnt().rtgCnt>0||PMSV2Cycle.isCRBasedCycle()){let isValidScore=!0,chosenRtgType=pageId.find("#ratingType").val();pageId.find("#mxVl, #mnVl").removeClass("ztextbox__error"),pageId.find("#numRtgDiv [elem=errorMsg]").remove(),"numberRating"===chosenRtgType?isValidScore=PMSV2Cycle.validateMaxScore(pageId.find("#mxVl"),!0):"customRating"===chosenRtgType?(isValidScore=PMSV2Cycle.validateMinScore(pageId.find("#mnVl"),!0))&&(isValidScore=PMSV2Cycle.validateMaxScore(pageId.find("#mxVl"),!0)):"textRating"===chosenRtgType&&(isValidScore=PMSV2Cycle.validateTextRatingName()),isValid=!1===isValidScore?isValidScore:isValid;let errMsg1="";if(PMSV2Cycle.rating_keyarray.length>=1){let validateRatingRange=(orgRtgCnt,maxRtgRange)=>"range"===pageId.find("#rtgDetDiv ul").attr("rttype")&&Number(PMSV2Cycle.rating_maxRangeArray[orgRtgCnt-1])!==maxRtgRange,chosenRtgType=pageId.find("#ratingType").val();if("numberRating"===chosenRtgType){var origCnt=PMSV2Cycle.rating_keyarray.length;let max=parseInt(pageId.find("#mxVl").val().trim());if(""==max||isNaN(max))errMsg1=ZPI18N.getString("zp.cycle.errormsg.maxrangemandatory");else if(origCnt!==max)(arr=[]).push(max),errMsg1=ZPI18N.getString("zp.addratingerror",new Array(arr.toString()));else validateRatingRange(origCnt,max)&&(errMsg1=ZPI18N.getString("zp.cycle.errormsg.maxrangeequalto",new Array(max.toString())))}else if("textRating"===chosenRtgType){origCnt=PMSV2Cycle.rating_keyarray.length;var arr,max=PMSV2Cycle.textrating_name.length;if(origCnt!==max)(arr=[]).push(max),errMsg1=ZPI18N.getString("zp.addratingerror",new Array(arr.toString()));else validateRatingRange(origCnt,max)&&(errMsg1=ZPI18N.getString("zp.cycle.errormsg.maxrangeequalto",new Array(max.toString())))}else if("customRating"===chosenRtgType){origCnt=PMSV2Cycle.rating_keyarray.length;var maxScore=$("#mxVl").val(),minScore=$("#mnVl").val();if(""==minScore||""==maxScore||isNaN(minScore)||isNaN(maxScore))errMsg1=ZPI18N.getString("zp.cycle.errormsg.minormaxrangemandatory");else{maxScore=Number(maxScore),minScore=Number(minScore);var origScore=Number(PMSV2Cycle.rating_maxRangeArray[origCnt-1]);maxScore<origScore&&(errMsg1=ZPI18N.getString("zp.addscoreerror",new Array(maxScore.toString()))),minScore>(origScore=Number(PMSV2Cycle.rating_minRangeArray[0]))&&(errMsg1=ZPI18N.getString("zp.addminscoreerror",new Array(minScore.toString()))),""===errMsg1&&(PMSV2Cycle.isCRBasedCycle()?"range"===pageId.find("#rtgDetDiv ul").attr("rttype")&&(Number.isInteger(parseFloat(PMSV2Cycle.rating_maxRangeArray[origCnt-1]))?0!=parseFloat(PMSV2Cycle.rating_minRangeArray[0])&&(errMsg1=ZPI18N.getString("zp.crcycle.minrangeerr")):errMsg1=ZPI18N.getString("zp.crcycle.maxrangedecimal")):validateRatingRange(origCnt,maxScore)&&(errMsg1=ZPI18N.getString("zp.cycle.errormsg.maxrangeequalto",new Array(maxScore.toString()))))}}else if("starRating"===chosenRtgType){let maxScore=5;validateRatingRange(5,maxScore)&&(errMsg1=ZPI18N.getString("zp.cycle.errormsg.maxrangeequalto",new Array(maxScore.toString())))}}else errMsg1=ZPI18N.getString("zp.minratreq");errMsg1.length>0&&(isValid=!1,PMSV2Cycle.showError(errMsg1,pageId.find("#rtgDetDiv"),1))}if(!pageId.find("#cmtLenDiv").hasClass("DN")){let errCmtMsg="",minCmtVal=pageId.find("#cmtLenInp").val();if(""!==minCmtVal){var minCmtLen=Number(minCmtVal);isNaN(minCmtLen)?errCmtMsg=ZPI18N.getString("zp.fieldupdate.numbererror"):minCmtLen<=0?errCmtMsg=ZPI18N.getString("zp.cycle.errormsg.mincmtlengthgreaterthan",[0]):minCmtLen>1e3&&(errCmtMsg=ZPI18N.getString("zp.cycle.errormsg.mincmtlengthlesserthan",[1e3])),errCmtMsg.length>0&&(isValid=!1,PMSV2Cycle.showError(errCmtMsg,pageId.find("#cmtLenInp"),2))}}return isValid},normalizationValidation:function(){let pageId=settingsPage.container,isValid=!0,errMsg="";var totalNomalizPer=0;let chkTotPerFlg=!0;if(PMSV2Cycle.rating_keyarray.length>=1){pageId.find("#rtgDetDiv ul").attr("rttype");pageId.find("#rtgDetDiv ul").find("li[id^=li_]").each(function(){var series=parseInt($(this).attr("series")),ratingPer=pageId.find("#normRtgDetDiv ul li").find("#nmRtMinInp_"+series).val();void 0!=ratingPer&&""!=ratingPer?totalNomalizPer+=parseFloat(ratingPer):(errMsg=ZPI18N.getString("zp.ratingDistributionerr"),chkTotPerFlg=!1)})}return chkTotPerFlg&&(totalNomalizPer>100||totalNomalizPer<100)&&(errMsg=ZPI18N.getString("zp.setRatingdisterr")),errMsg.length>0&&(isValid=!1,PMSV2Cycle.showError(errMsg,pageId.find("#normRtgDetDiv"),1)),isValid},hikeValidation:function(){let pageId=settingsPage.container,isValid=!0;if(1===PMSSetting.SEL_ENABLED_MODULES.SALARY.enable||void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationEnabled&&PMSV2Cycle.compensationData.isCompensationEnabled){var hikeDeciderID=pageId.find("#hkApprSel").val();if(void 0!==hikeDeciderID&&"-1"!==hikeDeciderID||(isValid=!1,PMSV2Cycle.showError(ZPI18N.getString("zp.selecthikedecider",[PMSV2Cycle.HIKENAME]),pageId.find("#hkApprSel"),2)),void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource&&(PMSV2Cycle.CLONE_CYCLE_FLAG||void 0!=PMSV2Cycle.SELECTED_TMPL&&0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus)){var applicablecurrency=pageId.find("#appCurrSelID").val();if(void 0===applicablecurrency||"-1"===applicablecurrency){isValid=!1;let errobj=pageId.find("#empTypeAppliDiv");$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"}),ZPeopleComponents.select($("#appCurrSelID")).getElement().addClass("ztextbox__error"),pageId.find("#appCurrSelDiv").find(".ztextbox--error__label").remove(),pageId.find("#appCurrSelDiv").append('<span elem="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.selectapplicablecurrency")+"</span>")}}!pageId.find("#hkApproval").is(":checked")||""!=PMSV2Cycle.isBudget_apprConf&&PMSV2Cycle.isBudget_apprConf||(isValid=!1,PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.configureapprovalforform",new Array(ZPeople.escapeHtml(PMSV2Cycle.teamBudgetFormName))),pageId.find("#hkApprConf div"),1))}else isValid=!1,void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?void 0!=PMSV2Cycle.compensationData.isCompensationSalaryDisabled&&PMSV2Cycle.compensationData.isCompensationSalaryDisabled?ZPeople.Message.failure(ZPI18N.getString("zp.performance.addconfigcompensationsalarydisable")):ZPeople.Message.failure(ZPI18N.getString("zp.performance.addconfigcompensationdisabled")):ZPeople.Message.failure("Enable Employee Salary Form");return isValid},budgetConfigValidation:function(){var budgetConfig={};PMSV2Cycle.BUDGETCONFIGERROR=!1;let pageId=settingsPage.container;var mode=pageId.find("#hkBsdOn").find("[name=ruleOpt]:checked").val(),hikePer=pageId.find("#hikePercentage").val();if(null===hikePer||ZPUtil.Validation.isEmpty(hikePer)||!ZPUtil.Validation.isDecimal(hikePer)||0==parseFloat(hikePer)&&(!PMSV2Cycle.EDIT_CYCLE_FLAG||PMSV2Cycle.CLONE_CYCLE_FLAG||-1==PMSV2Cycle.SELECTED_TMPL.periodStatus))return PMSV2Cycle.showError(ZPI18N.getString("zp.inputhikepercentage",[PMSV2Cycle.HIKENAME]),pageId.find("#hikePercentage"),2),void(PMSV2Cycle.BUDGETCONFIGERROR=!0);if(pageId.find("#enablehikedeviation").is(":checked")){let hikeDeviationPer=pageId.find("#hikedeviationper").val();if(IsNumeric(hikeDeviationPer)){budgetConfig.hikedeviationenable=!0;let hikeDeviation=pageId.find("#hikedeviationper").val();budgetConfig.hikedeviationper=Number(hikeDeviation.replace(/[^0-9\.]+/g,"")).toFixed(2)+""}else PMSV2Cycle.BUDGETCONFIGERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.entervalidhikedeviation",[PMSV2Cycle.HIKENAME]),pageId.find("#hikedeviationper"),2)}else budgetConfig.hikedeviationenable=!1;if(0==mode)budgetConfig.defHikePer=Number(hikePer.replace(/[^0-9\.]+/g,"")).toFixed(2)+"",budgetConfig.budgetName=pageId.find("#cycleName").val().trim(),budgetConfig.totalHikeAmt="0",budgetConfig.ruleFormat=[];else{var tbodyid="totalrule_"+(pageId.find("#custRules").find(".zpl_paappslyhike").length-1),custLen=PMSV2Cycle.CHOSEN_CUST_OPT.length,hikeRule={},ruleDetails=[],ruleId=pageId.find("#"+tbodyid).find("#inp_rules").val();budgetConfig.defHikePer=Number(hikePer.replace(/[^0-9\.]+/g,"")).toFixed(2)+"",PMSV2Cycle.calcRuleHike(!0)||null!=ruleId&&void 0!=ruleId&&""!=ruleId?(pageId.find("#custRules .zpl_paappslyhike").each(function(){var i=parseInt($(this).attr("series")),tbodyArr=[],totalTbody={};for(let j=0;j<custLen;j++){var temp={},type=PMSV2Cycle.CHOSEN_CUST_OPT[j];if(1==type||4==type){var arr=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield("#tot"+i+"_rule"+j+"_option").getAllValues());1==type?temp.desList=arr:temp.deptList=arr}else if(2==type||3==type&&!PMSV2Cycle.newDOJ){var obj={},opt=Number(ZPeopleComponents.select("#tot"+i+"_rule"+j+"_option").getValue());obj.condType=opt;var val=Number(pageId.find("#tot"+i+"_rule"+j+"_expFrom_1").val());if(obj.condValue=val,5==opt){val=Number(pageId.find("#tot"+i+"_rule"+j+"_expTo_1").val());obj.condValueTo=val}temp.expDetails=obj}else if(3==type&&PMSV2Cycle.newDOJ){var dojObj={};opt=Number(ZPeopleComponents.select("#tot"+i+"_rule"+j+"_option").getValue());dojObj.condType=opt;val=2!=opt?ZPeopleComponents.datefield(pageId.find("#tot"+i+"_rule"+j+"_dojSel")).getValue().dateString:ZPeopleComponents.daterangepicker(pageId.find("#tot"+i+"_rule"+j+"_hkDoj")).getFromValue().fromValueString;2==opt?(dojObj.condValue=val,dojObj.condValueTo=ZPeopleComponents.daterangepicker(pageId.find("#tot"+i+"_rule"+j+"_hkDoj")).getToValue().toValueString):dojObj.condValue=val,dojObj.isnew=!0,temp.dojDetails=dojObj}else if(5==type){val=ZPeopleComponents.select("#tot"+i+"_rule"+j+"_option").getValue();temp.rating=val}tbodyArr.push(temp)}totalTbody.criteria=tbodyArr;var hike=pageId.find("#totalrule_"+i).find("#hikePercent").val();totalTbody.ruleHikeAmt="0",totalTbody.ruleHikePer=hike,ruleDetails.push(totalTbody)}),hikeRule.ruleDetails=ruleDetails,budgetConfig.hikeRuleDetails=hikeRule,budgetConfig.ruleFormat=PMSV2Cycle.CHOSEN_CUST_OPT,budgetConfig.budgetName=pageId.find("#cycleName").val().trim()):PMSV2Cycle.BUDGETCONFIGERROR=!0}return budgetConfig},publishValidation:function(){let pageId=settingsPage.container,isValid=!0;var fldPubData=ZPeopleComponents.tokenfield(pageId.find("#fldToPubID")).getAllValues(),actualSelVal=[];if(fldPubData.length>0)for(var i in fldPubData)actualSelVal.push(fldPubData[i].id);null!==actualSelVal&&0!==actualSelVal.length||(isValid=!1,PMSV2Cycle.showError(ZPI18N.getString("zp.selectatleastonefieldmsg"),pageId.find("#fldToPubID"),1));var pubOwner=ZPeopleComponents.tokenfield(pageId.find("#pubAuthID")).getAllValues(),pubOwnerSelVal=[];if(pubOwner.length>0)for(var i in pubOwner)pubOwnerSelVal.push(pubOwner[i].id);return isValid},getMRModSelObj:function(formData){let pageId=settingsPage.container,mrObj={isEnabled:!0};mrObj.mrTemplateId=PMSV2Cycle.mrTemplateId;let isAddReporteeFlg=ZPeopleComponents.toggleswitch(pageId.find("#mrAutoPopulate")).getState(),mrChoice=parseInt(pageId.find("[name=mrSelRdBx]:checked").val());if(mrObj.MRchoice=mrChoice,mrObj.minrater=pageId.find("#minrater").val(),mrObj.maxrater=pageId.find("#maxrater").val(),1==mrChoice){var showRaterByRM=pageId.find("#mrAnonID").is(":checked");mrObj.showRaterByRM=!showRaterByRM,isAddReporteeFlg&&(mrObj.MRchoice=4)}if(isAddReporteeFlg){var defaulttype=pageId.find("#mrTypeSelID").val();null!=PMSV2Cycle.mrTypeData&&PMSV2Cycle.mrTypeData.isMrtypeComEnabled&&PMSV2Cycle.mrTypeData.isMrtypeMandatary?"-1"!=defaulttype&&(mrObj.defaultmrtype=defaulttype):mrObj.defaultmrtype=defaulttype}isAddReporteeFlg&&2==mrObj.MRchoice&&(mrObj.MRchoice=5);let isSfApprVw=pageId.find("#selfApprViewForMR").is(":checked");if(mrObj.showSelfApprForMR=!!isSfApprVw,void 0!=pageId.find("#cyMRSelPeriodID").val()&&""!==pageId.find("#cyMRSelPeriodID").val()){var dateVal=pageId.find("#cyMRSelPeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cyMRSelPeriodID","selectfromDate","selecttoDate",formData,!0,mrObj)}else mrObj.selectfromDate="",mrObj.selecttoDate="";if(void 0!=pageId.find("#cyMRFdBkPeriodID").val()&&""!==pageId.find("#cyMRFdBkPeriodID").val()){dateVal=pageId.find("#cyMRFdBkPeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cyMRFdBkPeriodID","fromDate","toDate",formData,!0,mrObj)}else mrObj.fromDate="",mrObj.toDate="";let isMRTypeEnable=ZPeopleComponents.toggleswitch(pageId.find("#mrTypeID")).getState();if(mrObj.isMRtypeModules=isMRTypeEnable,isMRTypeEnable){let mrArr=[],hd={},mrMoVl=PMSV2Cycle.getModSelObj("mrQtPmTBody","mrQlPmTBody"),mrMoVlDet={};mrMoVl.length>0&&(hd.optionID="1",hd.moduleVal=mrMoVl,mrMoVlDet=PMSV2Cycle.getModSelRtgCmtObj("mrQtPmTBody","mrQlPmTBody",mrMoVl),hd.mrJSONRatingComment=mrMoVlDet),mrArr.push(hd),$.each(PMSV2Cycle.mrtypes,function(index,data){let t={};var ratingstatus={};if("1"!==index){let mVl=[];t.optionID=index;let tdChild=pageId.find("#mr_module_choice_"+index).find("input[type=checkbox]:checked");$.each(tdChild,function(k,v){let mNm=$(this).attr("modname");-1!==mrMoVl.indexOf(mNm)&&("KRA"!==mNm&&"GOALS"!==mNm&&"KRA_GOALS"!==mNm&&"COMPETENCY"!==mNm&&"QUS_ANS"!==mNm||(mVl.push(mNm),ratingstatus[mNm]={},ratingstatus[mNm].isRatingEnabled=mrMoVlDet[mNm].isRatingEnabled,ratingstatus[mNm].isRatingMdty=mrMoVlDet[mNm].isRatingMdty,ratingstatus[mNm].isCommentEnabled=mrMoVlDet[mNm].isCommentEnabled,ratingstatus[mNm].isCommentMdty=mrMoVlDet[mNm].isCommentMdty))}),t.mrJSONRatingComment=ratingstatus,t.moduleVal=mVl,mrArr.push(t)}}),mrObj.ModuleTypeData=mrArr}else{let mrMoVl=PMSV2Cycle.getModSelObj("mrQtPmTBody","mrQlPmTBody");mrMoVl.length>0&&(mrObj.moduleVal=mrMoVl,mrObj.mrJSONRatingComment=PMSV2Cycle.getModSelRtgCmtObj("mrQtPmTBody","mrQlPmTBody",mrMoVl))}return mrObj},getModSelRtgCmtObj:function(qtPmTBody,qlPmtTBody,enabledModArr){let pageId=settingsPage.container,modVl={};for(let i=0;i<enabledModArr.length;i++){let m=enabledModArr[i],chkChilds=pageId.find("#"+qtPmTBody).find("input[type=checkbox][compname="+m+"]");"QUS_ANS"===m&&(chkChilds=pageId.find("#"+qlPmtTBody).find("input[type=checkbox][compname="+m+"]"));let mvObj=PMSV2Cycle.buildModVlObj(chkChilds,m);modVl[m]={isRatingEnabled:mvObj.isRatingEnabled,isRatingMdty:mvObj.isRatingMdty,isCommentEnabled:mvObj.isCommentEnabled,isCommentMdty:mvObj.isCommentMdty}}return modVl},buildModVlObj:function(chkChilds,m){let isRatingEnabled=!1,isCommentEnabled=!1,isRatingMdty=!1,isCommentMdty=!1;return $.each(chkChilds,function(k,v){let idx=$(this).attr("id");-1!==idx.indexOf("_rtChkBx")?isRatingEnabled=$(this).prop("checked"):"QUS_ANS"===m&&(isRatingEnabled=!0),-1!==idx.indexOf("_rtMdty")?isRatingMdty=$(this).prop("checked"):"QUS_ANS"===m&&(isRatingMdty=!0),-1!==idx.indexOf("_cmtChkBx")&&(isCommentEnabled=$(this).prop("checked")),-1!==idx.indexOf("_cmtMdty")&&(isCommentMdty=$(this).prop("checked"))}),{isRatingEnabled:isRatingEnabled,isRatingMdty:isRatingMdty,isCommentEnabled:isCommentEnabled,isCommentMdty:isCommentMdty}},getRtgCntWithOutMR:function(tBodyID){let pageId=settingsPage.container,rtgCnt=0,rtgChilds=pageId.find("input[rtgcnt=yes]");return void 0!==tBodyID&&(rtgChilds=pageId.find("#"+tBodyID+" input[rtgcnt=yes]")),$.each(rtgChilds,function(k,v){$(this).prop("checked")&&(rtgCnt+=1)}),rtgCnt},getModSelObj:function(qtPmTBody,qlPmtTBody){let pageId=settingsPage.container,modVl=[],tgChilds=pageId.find("#"+qtPmTBody).find(".togbutton-js");return $.each(tgChilds,function(k,v){let state=ZPeopleComponents.toggleswitch(this).getState(),modnm=$(this).attr("modname");state&&modVl.push(modnm)}),tgChilds=pageId.find("#"+qlPmtTBody).find(".togbutton-js"),$.each(tgChilds,function(k,v){let state=ZPeopleComponents.toggleswitch(this).getState(),modnm=$(this).attr("modname");state&&modVl.push(modnm)}),modVl},setApplicableTypeValue:function(dojSelVal,returnedData,appliJson,isFirst){var selectId=isFirst?"":"_2",pageId=settingsPage.container;if("DOJ_UNTIL"==dojSelVal&&void 0!=returnedData.dateString)1==PMSV2Cycle.checkvalidDate(returnedData.dateString)?void 0!=appliJson.until?(PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError("Duplicate Rule",pageId.find("#dojVal1"+selectId),2)):void 0!=appliJson.fromDate?(PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError("Either Until or (From Date / To Date) should be selected",pageId.find("#dojVal1"+selectId),2)):appliJson.until=returnedData.dateString:(PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.invaliddate"),pageId.find("#dojVal1"+selectId),2));else if("DOJ_FRM_TO"!=dojSelVal||PMSV2Cycle.DATEERROR||void 0==pageId.find("#dojVal"+selectId).val()||""===pageId.find("#dojVal"+selectId).val())"DOJ_MTH"==dojSelVal&&(void 0!=appliJson.monthList?(PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError("Duplicate Rule",pageId.find("#dojMthVal"+selectId),2)):appliJson.monthList=pageId.find("#dojMthVal"+selectId).val());else{var dateVal=pageId.find("#dojVal"+selectId).val();void 0!=appliJson.until?(PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError("Either Until or (From Date / To Date) should be selected",pageId.find("#dojVal"+selectId),2)):void 0!=appliJson.fromDate?(PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError("Duplicate Rule",pageId.find("#dojVal"+selectId),2)):PMSV2Cycle.setDateValues(dateVal,"dojVal"+selectId,"fromDate","toDate",void 0,!1,appliJson)}},getApplicableCriObj:function(formData){let pageId=settingsPage.container;var dojSelVal=pageId.find("#dojCrt").val();PMSV2Cycle.DATEERROR=!1;var applicableTypeJson={},returnedData="DOJ_UNTIL"==dojSelVal?ZPeopleComponents.datefield(pageId.find("#dojVal1")).getValue():"";PMSV2Cycle.setApplicableTypeValue(dojSelVal,returnedData,applicableTypeJson,!0),dojSelVal=pageId.find("#dojCrt_2").val();var secondReturnedData=pageId.find("#dojAppliDiv_2").hasClass("zpl_DNI")?"":"DOJ_UNTIL"==pageId.find("#dojCrt_2").val()?ZPeopleComponents.datefield(pageId.find("#dojVal1_2")).getValue():"";if(PMSV2Cycle.setApplicableTypeValue(dojSelVal,secondReturnedData,applicableTypeJson,!1),Object.keys(applicableTypeJson).length>0){var dateType=pageId.find("#dojKey").val();applicableTypeJson.type=dateType,formData.append("applicableType",JSON.stringify(applicableTypeJson))}var empType=pageId.find("[keysel=APPL_EMPTYPE]").val();if(null===empType||0==empType.length){var tempEmpType=new Array;tempEmpType.push("-1"),formData.append("employeeTypeId",JSON.stringify(tempEmpType))}else formData.append("employeeTypeId",JSON.stringify(empType));var designation=pageId.find("[keysel=APPL_DES]").val();if(null===designation||0==designation.length){var tempdesignation=new Array;tempdesignation.push("-1"),formData.append("designationId",JSON.stringify(tempdesignation))}else formData.append("designationId",JSON.stringify(designation));if(pageId.find("#locationAppliDiv").length>0){var location=pageId.find("[keysel=APPL_LOC]").val();if(null===location||0==location.length){var templocation=new Array;templocation.push("-1"),formData.append("locationId",JSON.stringify(templocation))}else formData.append("locationId",JSON.stringify(location))}if(pageId.find("#roleAppliDiv").length>0){var role=pageId.find("[keysel=APPL_ROLE]").val();if(null===role||0==role.length){var temprole=new Array;temprole.push("-1"),formData.append("roleId",JSON.stringify(temprole))}else formData.append("roleId",JSON.stringify(role))}if(pageId.find("#departmentAppliDiv").length>0){var department=pageId.find("[keysel=APPL_DEP]").val();if(null===department||0==department.length){var tempdepartment=new Array;tempdepartment.push("-1"),formData.append("departmentId",JSON.stringify(tempdepartment))}else formData.append("departmentId",JSON.stringify(department))}if(pageId.find("#levelAppliDiv").length>0){var level=pageId.find("[keysel=APPL_LVL]").val();if(null===level||void 0==level||0==level.length){var templevel=new Array;templevel.push("-1"),formData.append("levelId",JSON.stringify(templevel))}else formData.append("levelId",JSON.stringify(level))}if(pageId.find("#customDateAppliDiv").length>0){var cDateObj={},customDateFCID=pageId.find("#cstKey").val();if(void 0!=customDateFCID&&null!=customDateFCID&&"-1"!==customDateFCID){if((cDateObj={}).customDateFCID=customDateFCID,cDateObj.type="CST_DATE"==pageId.find("#cstCrt").val()?"date":"month","date"==cDateObj.type)if(""!==pageId.find("#cstVal").val()){var dateVal=pageId.find("#cstVal").val();PMSV2Cycle.setDateValues(dateVal,"cstVal","fromDate","toDate",formData,!1,cDateObj)}else PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.selectdate"),pageId.find("#cstVal"),1);else if("month"==cDateObj.type){var monthList=pageId.find("#cstMthVal").val();null==monthList||0==monthList.length?(PMSV2Cycle.showError(ZPI18N.getString("zp.selectmonth"),pageId.find("#cstMthVal"),1),PMSV2Cycle.DATEERROR=!0):$.each(monthList,function(index,data){(isNaN(data)||data<0||data>11)&&(PMSV2Cycle.showError(ZPI18N.getString("zp.invalidinputs"),pageId.find("#cstMthVal"),1),PMSV2Cycle.DATEERROR=!0)}),PMSV2Cycle.DATEERROR||(cDateObj.monthList=monthList)}var cdJSON=JSON.stringify(cDateObj);formData.append("customDateFilterJSON",cdJSON)}else{cdJSON=JSON.stringify(cDateObj);formData.append("customDateFilterJSON",cdJSON)}}if(pageId.find("#totalWrkExpAppliDiv").length>0){var expOption=pageId.find("#expCrt").val();if(-1!=expOption)if(PMSOperation.checkExperienceYear(!0,!1)){var expObj={};expObj.operator=expOption,expObj.from=pageId.find("#expFrom").val(),5==expOption&&(expObj.to=pageId.find("#expTo").val()),formData.append("expFilterJSON",JSON.stringify(expObj))}else PMSV2Cycle.DATEERROR=!0}if((PMSV2Cycle.IS_SAL_HK_ENABLED||SalaryHikeV2Cycle.isSalaryHikeCycle)&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource&&(PMSV2Cycle.CLONE_CYCLE_FLAG||void 0==PMSV2Cycle.SELECTED_TMPL||void 0!=PMSV2Cycle.SELECTED_TMPL&&0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus)){var currency=pageId.find("#appCurrSelID").val();if(-1!=currency)formData.append("applicable_currency",currency);else{PMSV2Cycle.DATEERROR=!0;let errobj=pageId.find("#empTypeAppliDiv");$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"}),ZPeopleComponents.select($("#appCurrSelID")).getElement().addClass("ztextbox__error"),pageId.find("#appCurrSelDiv").find(".ztextbox--error__label").remove(),pageId.find("#appCurrSelDiv").append('<span elem="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.selectapplicablecurrency")+"</span>")}}return formData},dateValidationandSetParam:function(formData){let pageId=settingsPage.container;if(""!==pageId.find("#cyPPeriodID").val()){var dateVal=pageId.find("#cyPPeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cyPPeriodID","fromDate","toDate",formData,!1)}else PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.emptycycleperiod"),pageId.find("#cyPPeriodID"),2);if(void 0!=pageId.find("#cySAPeriodID").val()&&""!==pageId.find("#cySAPeriodID").val()){dateVal=pageId.find("#cySAPeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cySAPeriodID","safromDate","satoDate",formData,!0)}if(""!==pageId.find("#cyRPeriodID").val()){dateVal=pageId.find("#cyRPeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cyRPeriodID","appraisalfromDate","appraisaltoDate",formData,!0)}if(!PMSV2Cycle.IS_SAL_HK_ENABLED||""!=pageId.find("#cyHkPeriodID").val()&&void 0!=pageId.find("#cyHkPeriodID").val()){if(void 0!=pageId.find("#cyHkPeriodID").val()&&""!==pageId.find("#cyHkPeriodID").val()){dateVal=pageId.find("#cyHkPeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cyHkPeriodID","hikefromDate","hiketoDate",formData,!0)}}else PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.emptycycleperiod"),pageId.find("#cyHkPeriodID"),2);if(void 0!=pageId.find("#cyNrmPeriodID").val()&&""!==pageId.find("#cyNrmPeriodID").val()){dateVal=pageId.find("#cyNrmPeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cyNrmPeriodID","normalizefromDate","normalizetoDate",formData,!1)}else PMSV2Cycle.IS_NORM_ENABLED&&(PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.norperioderror"),pageId.find("#cyNrmPeriodID"),2));if(void 0!=pageId.find("#cyMnlPubPeriodID").val()&&""!==pageId.find("#cyMnlPubPeriodID").val()){dateVal=pageId.find("#cyMnlPubPeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cyMnlPubPeriodID","publishfromDate","publishtoDate",formData,!0)}return formData},setDateValues:function(dateVal,id,formDateId,toDateId,formData,checkinPrcDate,mrObj){let pageId=settingsPage.container;var fromDate=null,toDate=null;if(6===dateVal.split("-").length)fromDate=(date=dateVal.split("-"))[0]+"-"+date[1]+"-"+date[2],toDate=date[3]+"-"+date[4]+"-"+date[5];else if(2===dateVal.split("-").length){var date;fromDate=(date=dateVal.split("-"))[0],toDate=date[1]}var tdate="",fdate="";null!=fromDate&&(fdate=Calendar.parseDate(fromDate,uidateFormat)),null!=toDate&&(tdate=Calendar.parseDate(toDate,uidateFormat));if(null==fromDate||0==PMSV2Cycle.checkvalidDate(fromDate)?(PMSV2Cycle.showError(ZPI18N.getString("zp.appfromdateerror"),pageId.find("#"+id),2),PMSV2Cycle.DATEERROR=!0):null==toDate||0==PMSV2Cycle.checkvalidDate(toDate)?(PMSV2Cycle.showError(ZPI18N.getString("zp.apptodateerror"),pageId.find("#"+id),2),PMSV2Cycle.DATEERROR=!0):tdate<fdate&&(PMSV2Cycle.showError(ZPI18N.getString("zp.fromDateIsGreater"),pageId.find("#"+id),2),PMSV2Cycle.DATEERROR=!0),!PMSV2Cycle.DATEERROR&&checkinPrcDate){var prcFormDate=Calendar.parseDate(formData.get("fromDate"),uidateFormat),prcToDate=Calendar.parseDate(formData.get("toDate"),uidateFormat);(prcFormDate>fdate||prcToDate<tdate)&&(PMSV2Cycle.showError(ZPI18N.getString("zp.appperioderr"),pageId.find("#"+id),2),PMSV2Cycle.DATEERROR=!0)}if(PMSV2Cycle.DATEERROR||"cyRPeriodID"!=id||void 0==formData.get("safromDate")||void 0==formData.get("satoDate"))if(PMSV2Cycle.DATEERROR||"cyNrmPeriodID"!=id||void 0==formData.get("appraisaltoDate")){if(!PMSV2Cycle.DATEERROR&&"cyNrmPeriodID"==id){Calendar.parseDate(formData.get("fromDate"),uidateFormat);if(fdate<prcFormDate&&(PMSV2Cycle.showError(ZPI18N.getString("zp.appperioderr"),pageId.find("#"+id),2),PMSV2Cycle.DATEERROR=!0),PMSV2Cycle.IS_SAL_HK_ENABLED)tdate>=Calendar.parseDate(formData.get("hikefromDate"),uidateFormat)&&(PMSV2Cycle.showError(ZPI18N.getString("zp.normalizationStartbeforehikePeriod",[PMSV2Cycle.HIKENAME]),pageId.find("#"+id),2),PMSV2Cycle.DATEERROR=!0)}}else{fdate<Calendar.parseDate(formData.get("appraisaltoDate"),uidateFormat)&&(PMSV2Cycle.showError(ZPI18N.getString("zp.normalizationStartafterReviewenddate"),pageId.find("#"+id),2),PMSV2Cycle.DATEERROR=!0)}else{var safromDate=Calendar.parseDate(formData.get("safromDate"),uidateFormat),satodate=Calendar.parseDate(formData.get("satoDate"),uidateFormat);fdate<safromDate?(PMSV2Cycle.showError(ZPI18N.getString("zp.reviewafterselfappraisal"),pageId.find("#"+id),2),PMSV2Cycle.DATEERROR=!0):tdate<=satodate&&(PMSV2Cycle.showError(ZPI18N.getString("zp.reviewendselfappraisal"),pageId.find("#"+id),2),PMSV2Cycle.DATEERROR=!0)}return PMSV2Cycle.DATEERROR||void 0==mrObj?PMSV2Cycle.DATEERROR||(formData.append(formDateId,fromDate),formData.append(toDateId,toDate)):(mrObj[formDateId]=fromDate,mrObj[toDateId]=toDate),formData},checkvalidDate:function(chkdate){var ufmt=uidateFormat.match(/%./g),udate=chkdate.split(/\W+/),date=0,month=0,year=0;if(udate.length>3)return!1;for(var i=0;i<udate.length;i++)switch(ufmt[i]){case"%d":date=udate[i];break;case"%m":month=udate[i];break;case"%Y":case"%y":year=udate[i];break;case"%b":month=udate[i],Math.round(month)>0&&(month=-1);for(var j=0;j<Calendar.months.length;j++)month===Calendar.months[j]&&(month=j+1)}var valid=!0;return 0===date||date.match(/^([0-9]{1,2})$/i)||(valid=!1),month.toString().match(/^([0-9]{1,2})$/i)||(valid=!1),year.toString().match(/^([0-9]{2}|[0-9]{4})$/i)||(valid=!1),0!==date&&(date=Math.round(date)),month=Math.round(month),(year=Math.round(year))<100&&(year+=2e3),(month<1||month>12)&&(valid=!1),(date>Calendar.daysInMonth(year,month-1)||0==date)&&(valid=!1),valid},closeRatingLi:function(obj){let pageId=settingsPage.container,li=$(obj).parents("li"),series=$(li).attr("series"),rtgNme=$(li).find(".zpl_cyclrgsr span").attr("rtgNme"),min=$(li).find("#rtMinSpn_"+series).attr("minV"),max=$(li).find("#rtMaxSpn_"+series).attr("maxV");pageId.find('[elem="errorMsg"]').remove(),PMSV2Cycle.ISRATINGEDITOPEN=!1,$(li).find(".zpl_cyclrgsr span").html(ZSEC.Encoder.encodeForHTML(rtgNme)),$(li).find("#rtMinSpn_"+series+" input").val(min),$(li).find("#rtMaxSpn_"+series+" input").val(max),$(li).find("#rtMinSpn_"+series+" input").attr("name","rtMinRangeInp"),$(li).find("#rtMaxSpn_"+series+" input").attr("name","rtMaxRangeInp"),$(pageId).find("#rtgDetDiv [name=rtMinRangeInp]").attr("disabled",!1),$(pageId).find("#rtgDetDiv [name=rtMaxRangeInp]").attr("disabled",!1),$(li).find(".forEdt").addClass("zpl_DNI"),$(li).find(".zpl_cyclrgsr span").attr("onclick","PMSV2Cycle.onEditOpen(this)"),$(li).find("#rtMinSpn_"+series).attr("onclick","PMSV2Cycle.onEditOpen(this)"),$(li).find("#rtMaxSpn_"+series).attr("onclick","PMSV2Cycle.onEditOpen(this)"),$(li).find(".PI_tick").css("opacity",""),$(li).find(".PI_tick").css("cursor",""),$(li).find(".PI_tick").attr("onclick","PMSV2Cycle.onEditClose(this);")},getNewCycleBudgetDetails:function(){let formDataT=new FormData;PMSV2Cycle.getApplicableCriObj(formDataT);var configId=settingsPage.container.find("#addCycleConfigDiv").attr("configid");null!=configId&&void 0!=configId&&""!=configId&&formDataT.append("configID",configId),formDataT.append("conreqcsr",csrfToken),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp?mode=cycleBudgetDetails",data:formDataT,processData:!1,contentType:!1,success:function(resultData){PMSTmpl.BUDGET_CONFIG_DATA=resultData,PMSTmpl.DESIGNATION_LIST=resultData.designationList,PMSTmpl.DESIGNATION_SALARY=resultData.desHike,PMSTmpl.HIKE_EXP_STORE=resultData.expVsHike,PMSTmpl.TOTAL_SALARY=resultData.totalAmount,PMSTmpl.DEPARTMENT_LIST=resultData.departmentList}})},onHikeBasedAction:function(){var pageId=settingsPage.container,selFld=pageId.find("#hkBsdOn").find("[name=ruleOpt]:checked").val();if(pageId.find("#defHikeLbl").html(ZPI18N.getString("zp.defHike",[PMSV2Cycle.HIKENAME])),pageId.find("#incPerLabel").html(""),0==selFld)pageId.find("[fld=hideForFld]").addClass("zpl_DNI"),PMSV2Cycle.CHOSEN_CUST_OPT=[],pageId.find("[fld=hide]").removeClass("zpl_DNI"),pageId.find("#custRules").addClass("zpl_DNI"),pageId.find("#incPerLabel").html(ZPI18N.getString("zp.hikeforall")),pageId.find("#incPerLabel").html(ZPI18N.getString("zp.hikePerAll",new Array(PMSV2Cycle.HIKENAME)));else if(1==selFld){pageId.find("[fld=hideForFld]").addClass("zpl_DNI"),ZPeopleComponents.tokenfield(pageId.find("#chooseCustOpt")).destroy(),$("#custRules select").each(function(){ZPeopleComponents.select($(this)).destroy()}),$("#custRules textarea").each(function(){ZPeopleComponents.tokenfield($(this)).destroy()}),pageId.find("[fld=hide]").addClass("zpl_DNI"),pageId.find("#custopt").removeClass("zpl_DNI"),pageId.find("#incPerLabel").html(ZPI18N.getString("zp.incrementAmt",new Array(PMSV2Cycle.HIKENAME)));var optLst=PMSV2Cycle.selectCustOpt(),dataObj={};dataObj.data=optLst,dataObj.contentType="text",dataObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},dataObj.search={by:"name"},dataObj.isLabelHTMLEncoded=!0,dataObj.allowDuplicateValues=!1,dataObj.dropdownList={itemType:"checkbox",isTextHTMLEncoded:!0},ZPeopleComponents.tokenfield(pageId.find("#chooseCustOpt"),dataObj),pageId.find("#custSavebtn").removeClass("zpl_DNI"),$("#custSavebtn").off("click").on("click",function(){PMSV2Cycle.buildCustRules()}),pageId.find("#custResetbtn").addClass("zpl_DNI"),pageId.find("#custRules").html(""),PMSV2Cycle.CHOSEN_CUST_OPT=[]}pageId.find("#hikePercentage").val("0")},selectCustOpt:function(tableID,ruleId){var optLst=[],optObj={};return optObj.name=ZPI18N.getString("zp.designation"),optObj.id="1",optLst.push(optObj),(optObj={}).name=ZPI18N.getString("zp.totalworkexperience"),optObj.id="2",optLst.push(optObj),(optObj={}).name=ZPI18N.getString("zp.dateofjoining"),optObj.id="3",optLst.push(optObj),(optObj={}).name=ZPI18N.getString("zp.department"),optObj.id="4",optLst.push(optObj),SalaryHikeV2Cycle.isSalaryHikeCycle||!PMSV2Cycle.isPARatingEnabled&&(PMSV2Cycle.isPARatingEnabled||!PMSV2Cycle.EDIT_CYCLE_FLAG&&!PMSV2Cycle.CLONE_CYCLE_FLAG)||((optObj={}).name=ZPI18N.getString("zp.rating"),optObj.id="5",optLst.push(optObj)),optLst},buildCustRules:function(){var pageId=settingsPage.container;ZPeopleComponents.tokenfield(pageId.find("#chooseCustOpt")).getAllValues().length?(ZPeopleComponents.tokenfield(pageId.find("#chooseCustOpt")).setAttributes({disabled:!0}),pageId.find("[fld=hideForFld]").removeClass("zpl_DNI"),pageId.find("[fld=hide]").removeClass("zpl_DNI"),pageId.find("#incPerLabel").html(ZPI18N.getString("zp.incrementAmt",new Array(PMSV2Cycle.HIKENAME))),PMSV2Cycle.CHOSEN_CUST_OPT=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(pageId.find("#chooseCustOpt")).getAllValues()),pageId.find("#custSavebtn").off("click"),PMSV2Cycle.isChanged=!0,pageId.find("#custSavebtn").addClass("zpl_DNI"),pageId.find("#custResetbtn").removeClass("zpl_DNI"),pageId.find("#totAmountView").text("0"),pageId.find("#custResetbtn").off("click").on("click",function(){PMSV2Cycle.changeConfirmRule()}),PMSV2Cycle.addCustHikeRule()):ZPeople.Message.failure(ZPI18N.getString("zp.enteravalue"))},changeConfirmRule:function(resetMode){if(PMSV2Cycle.hasAnyChangeInRule()||resetMode){var infoAlertMessage=new InfoAlertMessage;infoAlertMessage.title="",infoAlertMessage.despcription=ZPI18N.getString("zp.resetNotify"),infoAlertMessage.yesButtonText=ZPI18N.getString("zp.reset"),infoAlertMessage.callback=function(obj){PMSV2Cycle.onHikeBasedAction(),PMSV2Cycle.isChanged=!1,PMSV2Cycle.empCntArr=new Map},infoAlertMessage.cancelCallback=(()=>{let pageId=settingsPage.container;"1"==pageId.find("#hkBsdOn").find("[name=ruleOpt]:checked").val()?pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0):pageId.find("#hkBsdOn").find("#hikeBaseRule").prop("checked",!0)}),infoAlertMessage.show()}else PMSV2Cycle.onHikeBasedAction()},deleteRule:function(obj){var pageId=settingsPage.container,ruleDiv=$(obj).closest(".zpl_paappslyhike").attr("id"),ruleDivNo=ruleDiv.split("totalrule_").toString().replace(",",""),totRulelen=pageId.find(".zpl_paappslyhike").length;PMSV2Cycle.hikeAmtObj.hasOwnProperty(ruleDivNo)&&delete PMSV2Cycle.hikeAmtObj[ruleDivNo],PMSV2Cycle.SelCustArr.delete(ruleDivNo.toString());var custOptLen=PMSV2Cycle.CHOSEN_CUST_OPT.length,defHikePer=(pageId.find("#"+ruleDiv).find("#hikeRuleAmt").val(),pageId.find("#hikePercentage").val());""!=(defHikePer=Number(defHikePer.replace(/[^0-9\.]+/g,"")))&&0!=Number(defHikePer)&&void 0!=defHikePer||(defHikePer="0");let lastid=pageId.find(".zpl_paappslyhike").last().attr("series");var count=0,ruleDetails=[];pageId.find("#custRules .zpl_paappslyhike").each(function(){var i=parseInt($(this).attr("series"));$(this).attr("id");if(count++,i>Number(ruleDivNo)){var ischeck=!0,hike=pageId.find("#totalrule_"+i).find("#hikePercent").val();i==lastid&&""==hike&&(ischeck=!1);var ruleArr=[],totalRule={};if(ischeck){for(var j=0;j<custOptLen;j++){var temp={},type=PMSV2Cycle.CHOSEN_CUST_OPT[j];if(1==type||4==type){var arr;0==(arr=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(pageId.find("#tot"+i+"_rule"+j+"_option")).getAllValues())).length&&(ischeck=!1),1==type?temp.desList=arr:temp.deptList=arr}else if(3==type&&PMSV2Cycle.newDOJ){var dojObj={},opt=ZPeopleComponents.select("#tot"+i+"_rule"+j+"_option").getValue();if(dojObj.condType=opt,PMSV2Cycle.newDOJ){if(""!=(val=2!=opt?ZPeopleComponents.datefield(pageId.find("#tot"+i+"_rule"+j+"_dojSel")).getValue().dateString:ZPeopleComponents.daterangepicker(pageId.find("#tot"+len+"_rule"+i+"_hkDoj")).getFromValue().fromValueString).toString()&&""!=opt.toString()||(ischeck=!1),2==opt){var fromDate=val,toDate=ZPeopleComponents.daterangepicker(pageId.find("#tot"+i+"_rule"+j+"_hkDoj")).getToValue().toValueString;""==toDate&&(ischeck=!1),dojObj.condValue=fromDate,dojObj.condValueTo=toDate}else dojObj.condValue=val;dojObj.isnew=!0,temp.dojDetails=dojObj}}else if(2==type||3==type){var expObj={};opt=ZPeopleComponents.select("#tot"+i+"_rule"+j+"_option").getValue();expObj.condType=opt;var val=Number(pageId.find("#tot"+i+"_rule"+j+"_expFrom_1").val());if(expObj.condValue=val,""==val.toString()||""==opt.toString())return PMSV2Cycle.showError(ZPI18N.getString("zp.entervalidinput"),pageId.find("#tot"+i+"_rule"+j+"_expDetailsTable")),!1;if(5==opt){val=Number(pageId.find("#tot"+i+"_rule"+j+"_expTo").val());expObj.condValueTo=val,(""==val||val<expObj.condValue)&&(ischeck=!1)}temp.expDetails=expObj}else if(5==type){val=ZPeopleComponents.select("#tot"+i+"_rule"+j+"_option").getValue();temp.rating=val,""==val&&(ischeck=!1)}ruleArr.push(temp)}if(i==lastid&&ischeck){var curId="totalrule_"+i,ruleId=pageId.find("#totalrule_"+i).find("#inp_rules").val();PMSV2Cycle.checkRule(curId,lastid,!1)||void 0!=ruleId&&""!=ruleId||(ischeck=!1)}ischeck&&(delete PMSV2Cycle.hikeAmtObj[i],totalRule.criteria=ruleArr,totalRule.ruleHikePer=hike,ruleDetails.push(totalRule))}pageId.find("#totalrule_"+i).find("#ruleName").find("h5").empty(),pageId.find("#totalrule_"+i).find("#ruleName").find("h5").text("Rule "+(count-1))}}),PMSV2Cycle.curRule=new Map,ruleDivNo==lastid&&""==pageId.find("#totalrule_"+lastid).find("#inp_rules").val()&&PMSV2Cycle.SelCustArr.delete(lastid.toString());var ruleFormat=PMSV2Cycle.CHOSEN_CUST_OPT,temp={};temp.ruleFormat=ruleFormat,ruleDetails.push(temp);var calcVal=0,configId=pageId.find("#addCycleConfigDiv").attr("configid");let formdata=new FormData;PMSV2Cycle.getApplicableCriObj(formdata),null!=configId&&void 0!=configId&&""!=configId&&formdata.append("configId",configId),formdata.append("conreqcsr",csrfToken),formdata.append("ruleDetails",JSON.stringify(ruleDetails)),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp?mode=deleteRuleHike",data:formdata,processData:!1,contentType:!1,success:function(data){if("success"==data.msg){PMSV2Cycle.empCntArr.delete(ruleDivNo.toString()),pageId.find("#custRules").find(".ztextbox--error__label").remove();for(let key of PMSV2Cycle.empCntArr.keys())Number(key)>Number(ruleDivNo)&&PMSV2Cycle.empCntArr.delete(key);var hikeArr=data.calculatedHike,len=hikeArr.length;if(pageId.find("#nonruleEmpCount").addClass("zpl_DNI"),pageId.find("#nonrulEmpCnt").removeClass("zpl_DNI"),len>0)for(var start=pageId.find("#totalrule_"+ruleDivNo).next().attr("series"),end=pageId.find(".zpl_paappslyhike").last().attr("series"),k=0;k<len;k++){var obj=hikeArr[k];"-1"==obj.totalEmployees?(PMSV2Cycle.hikeAmtObj[start]=0,obj.totalEmployees=0):PMSV2Cycle.hikeAmtObj[start]=Number(obj.totalAmount),PMSV2Cycle.hikeAmtObj[start]=Number(obj.totalAmount),PMSV2Cycle.empCntArr.set(start.toString(),obj.totalEmployees);var hikeperVal=pageId.find("#totalrule_"+start).find("#hikePercent").val(),val1=parseFloat(obj.totalAmount*hikeperVal/100);calcVal+=val1,pageId.find("#totalrule_"+start).find("#hikeRuleAmt").val(parseFloat(val1).toFixed(2)),pageId.find("#totalrule_"+start).find("#empCount").remove(),pageId.find("#totalrule_"+start).find("#ruleEmpCount").addClass("zpl_DNI"),pageId.find("#totalrule_"+start).find("#rulEmpCnt").removeClass("zpl_DNI"),PMSV2Cycle.isCalculate=!0,start<=end&&(start=pageId.find("#totalrule_"+start).next().attr("series"))}if(lastid==ruleDivNo){let curLastID=pageId.find(".zpl_paappslyhike").last().prev().attr("series");PMSV2Cycle.empCntArr.delete(curLastID.toString()),PMSV2Cycle.SelCustArr.delete(curLastID.toString()),delete PMSV2Cycle.hikeAmtObj[curLastID]}pageId.find("#custRules .zpl_paappslyhike").each(function(){var divNo=parseInt($(this).attr("series"));divNo<ruleDivNo&&(calcVal+=parseFloat(pageId.find("#totalrule_"+divNo).find("#hikeRuleAmt").val()))})}}}),$(obj).closest(".zpl_paappslyhike").find("select").each(function(){ZPeopleComponents.select($(this)).destroy()}),$(obj).closest(".zpl_paappslyhike").find("textarea").each(function(){ZPeopleComponents.tokenfield($(this)).destroy()}),pageId.find(obj).closest(".zpl_paappslyhike").remove(),1==totRulelen&&PMSV2Cycle.addCustHikeRule();var empSal=0;$.each(PMSV2Cycle.hikeAmtObj,function(key,value){isNaN(Number(PMSV2Cycle.hikeAmtObj.key))||(empSal+=parseFloat(PMSV2Cycle.hikeAmtObj.key))}),pageId.find("#amtforRule").text(calcVal.toFixed(2));var totAmt=parseFloat(pageId.find("#totalAmount").text()),allocateHike=parseFloat((totAmt-empSal)*Number(defHikePer)/100),val1=calcVal+allocateHike,val2=totAmt+allocateHike+calcVal;pageId.find("#totAmountView").text(val1.toFixed(2)),pageId.find("#totalAmountAfterHike").text(val2.toFixed(2))},addCustHikeRule:function(obj){var pageId=settingsPage.container;let id=0;var existingLen=pageId.find("#custRules .zpl_paappslyhike").length;existingLen>0&&(id=parseInt($(pageId.find("#custRules .zpl_paappslyhike")[existingLen-1]).attr("series"))+1);var isAllow=!0;if(existingLen>0&&("ruleDel"!=$(obj).attr("id")||1!=existingLen)){isAllow=!1;var tbody="totalrule_"+(id-1),ruleId=pageId.find("#"+tbody).find("#inp_rules").val();if(""!=ruleId&&parseInt(ruleId)>0)isAllow=!0;else if(PMSV2Cycle.checkRule(tbody,existingLen,!1)){if(!PMSV2Cycle.calcRuleHike())return pageId.find("#totalrule_"+(id-1)).find(".ztextbox--error__label").remove(),pageId.find("#tot"+(id-1)+"_employeecnt").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.noemployeesapplicable")+"</span>"),!1;PMSV2Cycle.SelCustArr.set((id-1).toString(),PMSV2Cycle.curRule),isAllow=!0}}if(isAllow){var hikePerAmountTrimValue=(PMSV2Cycle.ALLOCATEDHIKENAME+" "+ZPI18N.getString("zp.amount")).length>30?(PMSV2Cycle.ALLOCATEDHIKENAME+" "+ZPI18N.getString("zp.amount")).slice(0,25)+".....":PMSV2Cycle.ALLOCATEDHIKENAME+" "+ZPI18N.getString("zp.amount"),hikePerTrimValue=(PMSV2Cycle.HIKENAME+" "+ZPI18N.getString("zp.percentage")).length>22?(PMSV2Cycle.HIKENAME+" "+ZPI18N.getString("zp.percentage")).slice(0,22)+".....":PMSV2Cycle.HIKENAME+" "+ZPI18N.getString("zp.percentage"),newRule=`<div class="zpl_gbox zpl_paappslyhike" id="totalrule_${id}" series="${id}">\n\t\t\t\t\t\t \t<div>\n\t\t\t\t\t\t \t\t <div class="zpl_paappslyhikehdr" id="ruleName">\n                            \t\t<h5>${ZPI18N.getString("zp.hkrule",[existingLen+1])} </h5> \n                            \t\t<div class="zpl_hvr zpl_hvrsw"><i class="PI_delete" id="ruleDel" onclick="PMSV2Cycle.deleteRule(this)"></i></div>\n                          \t\t </div>\n                          \t\t <div class="zpl_paappslyhikecnt">\n                          \t \t\t<div class="zpl_flexcolumngap4 zpl_paappslyhikcntlft">\n                          \t \t\t\t<div class="zpl_flexgap4" id="tot${id}_rule0">\n                          \t \t\t\t\t<div class="zpl_w200" id="tot${id}_rule0_ruleselect">\n                          \t \t\t\t\t\t<select id="tot${id}_rule0_ruleType"  tabindex="-1"></select>\n                          \t \t\t\t\t</div>\n                          \t \t\t\t\t<div class="" id="tot${id}_rule0_ruleVal"></div>\n                          \t \t\t\t</div>\n                          \t \t\t\t<div class="zpl_flexgap4" id="tot${id}_employeecnt">\n                               \t\t\t\t <div class="zpl_tg">\n                                  \t\t\t <span>${ZPI18N.getString("zp.ruleUser")}</span> \n                                  \t\t\t <a id="rulEmpCnt" onclick="PMSV2Cycle.getEmpCnt(this)">#</a>\t\n\t          \t\t\t\t\t\t\t\t <span id="ruleEmpCount"></span>\n                                \t\t\t </div>\n                                \t\t</div>\n                          \t \t\t\t<div><input type="hidden" id="inp_rules" value="" /></div>\n\t\t\t\t\t\t     \t\t</div>\n\t\t\t\t\t\t     \t\t<div class="zpl_paappslyhikcntrgt">\n                              \t\t\t<div class="zpl_flexcolumnaligngap2">\n                               \t\t\t\t     <div><input type="text" class="ztextbox zpl_w80i" id="hikePercent" onchange="PMSV2Cycle.calcRuleHike(this);" onkeydown="return paCommonUtil.onNRKeyDown(this,event,'hike');"></div>\n                               \t\t\t\t\t <span class="zpl_ellipsis200" title="${PMSV2Cycle.HIKENAME+" "+ZPI18N.getString("zp.percentage")}">${hikePerTrimValue}</span>\n                              \t\t\t  </div>\n                             \t\t\t  <div class="zpl_flexcolumnaligngap2">\n                               \t\t\t\t\t <div><input type="text" class="ztextbox zpl_w80i" id="hikeRuleAmt" disabled="disabled"></div>\n                               \t\t\t\t\t <span class="zpl_ellipsis200" id="hikeAmtLabel" title="${PMSV2Cycle.ALLOCATEDHIKENAME+" "+ZPI18N.getString("zp.amount")}">${hikePerAmountTrimValue}</span>\n                              \t\t\t  </div>\n                            \t\t</div>\n\t\t\t\t\t\t     \t</div>\n\t\t\t             \t</div>\n\t\t\t             </div>`;0==existingLen?pageId.find("#custRules").append(newRule):(PMSV2Cycle.removeError(),pageId.find("#totalrule_"+(id-1)).find("input").attr("disabled",!0),$("#totalrule_"+(id-1)+" select").each(function(){ZPeopleComponents.select($(this)).setAttribute("disabled","disabled")}),$("#totalrule_"+(id-1)+" textarea").each(function(){ZPeopleComponents.tokenfield($(this)).setAttribute("disabled","disabled")}),$("#totalrule_"+(id-1)+" [fld=dojHide]").each(function(){ZPeopleComponents.datefield($(this)).setAttribute("disabled","disabled")}),$("#totalrule_"+(id-1)+" [fld=dojRangeHide]").each(function(){$(this).addClass("disabled")}),pageId.find("#totalrule_"+(id-1)).find("#hikePercent").prop("disabled",!0),pageId.find("#tot"+id+"_rule0_ruleVal").prop("disabled",!0),pageId.find("#totalrule_"+(id-1)).find("#hikeRuleAmt").prop("disabled",!0),pageId.find("#custRules").find("#totalrule_"+(id-1)).after(newRule)),PMSV2Cycle.isCalculate=!1;var optLst=PMSV2Cycle.selectCustOpt(),dataObj={};dataObj.options=optLst,dataObj.contentType="text",dataObj.dataMapping={value:"id",label:"name",informativeText:"name"},dataObj.search={by:"name"},ZPeopleComponents.select(pageId.find("#totalrule_"+id).find("#tot"+id+"_rule0_ruleType"),dataObj);var custLength=PMSV2Cycle.CHOSEN_CUST_OPT.length;for(let index=0;index<custLength;index++){let mode=PMSV2Cycle.CHOSEN_CUST_OPT[index];if(0!=index){var addCri=`<div class="zpl_flexgap4" id="tot${id}_rule${index}">\n                          \t \t\t\t\t<div class="zpl_w200" id="tot${id}_rule${index}_ruleselect">\n                          \t \t\t\t\t\t<select id="tot${id}_rule${index}_ruleType" ></select>\n                          \t \t\t\t\t</div>\n                          \t \t\t\t\t<div class="" id="tot${id}_rule${index}_ruleVal"></div>\n                          \t   </div>`;pageId.find("#totalrule_"+id).find("#tot"+id+"_rule"+(index-1)).after(addCri),ZPeopleComponents.select(pageId.find("#totalrule_"+id).find("#tot"+id+"_rule"+index+"_ruleType"),dataObj)}if(mode==PMSCommon.HIKE_DESIGNATION||mode==PMSCommon.HIKE_DEPARTMENT){if(mode==PMSCommon.HIKE_DESIGNATION){var td='<textarea id="tot'+id+"_rule"+index+'_option" style="display: none;"></textarea>';pageId.find("#tot"+id+"_rule"+index+"_ruleVal").append(td);optLst=[];$.each(PMSV2Cycle.ALL_DESIGNATION,function(index,data){if(PMSV2Cycle.APP_DESIGNATION.includes(data.desId)){let optObj={};optObj.name=data.desName,optObj.id=data.desId,optLst.push(optObj)}}),(dataObj1={}).data=optLst,dataObj1.contentType="text",dataObj1.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},dataObj1.search={by:"name"},dataObj1.allowDuplicateValues=!1,dataObj1.placeholder="Enter Designation",dataObj1.dropdownList={itemType:"checkbox",isTextHTMLEncoded:!0},dataObj1.isLabelHTMLEncoded=!0,ZPeopleComponents.tokenfield(pageId.find("#tot"+id+"_rule"+index+"_option"),dataObj1);let obj={};obj.id=PMSCommon.HIKE_DESIGNATION,obj.name=ZPI18N.getString("zp.designation"),[].push(obj),ZPeopleComponents.select(pageId.find("#tot"+id+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_DESIGNATION),$(pageId.find("#tot"+id+"_rule"+index+"_option")).on("ztokenfieldchange",PMSV2Cycle.calcRuleHike),$(pageId.find("#tot"+id+"_rule"+index+"_option")).on("ztokenfieldtokenremove",PMSV2Cycle.calcRuleHike)}else if(mode==PMSCommon.HIKE_DEPARTMENT){td='<textarea id="tot'+id+"_rule"+index+'_option" style="display: none;"></textarea>';pageId.find("#tot"+id+"_rule"+index+"_ruleVal").append(td);var dataObj1;optLst=[];$.each(PMSV2Cycle.ALL_DEPARTMENTS,function(index,data){if(PMSV2Cycle.APP_DEPARTMENT.includes(data.departmentId)){let optObj={};optObj.name=data.departmentName,optObj.id=data.departmentId,optLst.push(optObj)}}),(dataObj1={}).data=optLst,dataObj1.contentType="text",dataObj1.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},dataObj1.search={by:"name"},dataObj1.allowDuplicateValues=!1,dataObj1.placeholder="Enter Department",dataObj1.dropdownList={itemType:"checkbox",isTextHTMLEncoded:!0},dataObj1.isLabelHTMLEncoded=!0,ZPeopleComponents.tokenfield(pageId.find("#tot"+id+"_rule"+index+"_option"),dataObj1),ZPeopleComponents.select(pageId.find("#tot"+id+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_DEPARTMENT),$(pageId.find("#tot"+id+"_rule"+index+"_option")).on("ztokenfieldchange",PMSV2Cycle.calcRuleHike),$(pageId.find("#tot"+id+"_rule"+index+"_option")).on("ztokenfieldtokenremove",PMSV2Cycle.calcRuleHike)}}else if(mode==PMSCommon.HIKE_TOTAL_EXPERIENCE){var expTabledata=`<div id="tot${id}_rule${index}_expDetailsTable" class="zpl_flexgap4">\n\t\t\t\t\t   \t\t\t\t\t  <div id="tot${id}_rule${index}_expOpt" ><select id="tot${id}_rule${index}_option"></select></div>\n\t\t\t\t\t   \t\t\t\t\t  <div id="tot${id}_rule${index}_expFrom"><input id="tot${id}_rule${index}_expFrom_1" onchange="PMSV2Cycle.calcRuleHike();" onkeydown="return paCommonUtil.onNRKeyDown(this,event,'year');" class="ztextbox" ></div>\n\t\t\t\t\t   \t\t\t\t\t  </div>`;pageId.find("#tot"+id+"_rule"+index+"_ruleVal").append(expTabledata),ZPeopleComponents.select(pageId.find("#tot"+id+"_rule"+index+"_option"),PMSV2Cycle.getTotalExpOption()),$(pageId.find("#tot"+id+"_rule"+index+"_option")).on("zselectchange",PMSV2Cycle.changeHikeExpObj),ZPeopleComponents.select(pageId.find("#tot"+id+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_TOTAL_EXPERIENCE)}else if(mode==PMSCommon.HIKE_DATE_OF_JOIN){if(PMSV2Cycle.newDOJ){expTabledata=`<div id="tot${id}_rule${index}_dojDetails" class="zpl_flexgap4">\n\t\t\t   \t\t\t\t\t\t\t\t\t<div id="tot${id}_rule${index}_expOpt" ><select class="select-js" id="tot${id}_rule${index}_option"></select></div>\n\t\t\t   \t\t\t\t\t\t\t\t\t<div id="tot${id}_rule${index}_dojDate" ></div>\n\t\t\t   \t\t\t\t\t\t\t\t\t</div>`;pageId.find("#tot"+id+"_rule"+index+"_ruleVal").append(expTabledata),pageId.find("#tot"+id+"_rule"+index+"_dojDate").html('<input id="tot'+id+"_rule"+index+'_dojSel" fld="dojHide" class="ztextbox">');var effectiveDateOptions={calendarIcon:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none",pickerclose:PMSV2Cycle.calcRuleHike};ZPeopleComponents.datefield(pageId.find("#tot"+id+"_rule"+index+"_dojSel"),effectiveDateOptions),ZPeopleComponents.select(pageId.find("#tot"+id+"_rule"+index+"_option"),PMSV2Cycle.getDOJOption())}else{expTabledata=`<div id="tot${id}_rule${index}_expDetailsTable" class="zpl_flexgap4">\n\t\t\t   \t\t\t\t\t\t\t\t\t<div id="tot${id}_rule${index}_expOpt" ><select  id="tot${id}_rule${index}_option" ></select></div>\n\t\t\t   \t\t\t\t\t\t\t\t\t<div id="tot${id}_rule${index}_expFrom" ><input id="tot${id}_rule${index}_expFrom_1" onkeydown="return paCommonUtil.onNRKeyDown(this,event,'year');"></div>\n\t\t\t   \t\t\t\t\t\t\t\t\t</div>`;pageId.find("#totalrule_"+id).find("#tot"+id+"_rule"+index).find("#tot"+id+"_rule"+index+"_ruleVal").append(expTabledata),ZPeopleComponents.select(pageId.find("#tot"+id+"_rule"+index+"_option")).addOption(PMSV2Cycle.getTotalExpOption())}$(pageId.find("#tot"+id+"_rule"+index+"_option")).on("zselectchange",PMSV2Cycle.changeHikeExpObj),ZPeopleComponents.select(pageId.find("#tot"+id+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_DATE_OF_JOIN)}else if(mode==PMSCommon.HIKE_RATING){td='<select class="select-js" id="tot'+id+"_rule"+index+'_option"></select>';pageId.find("#totalrule_"+id).find("#tot"+id+"_rule"+index).find("#tot"+id+"_rule"+index+"_ruleVal").append(td);optLst=pageId.find("#tot"+id+"_rule"+index+"_option");$.each(PMSV2Cycle.cycle_rating,function(key,val){optLst.append(jQuery("<option />",{value:val.id,id:val.id}).html(val.value))}),ZPeopleComponents.select(optLst),pageId.find("#totalrule_"+id).find("#hikeRuleAmt").addClass("zpl_DNI"),pageId.find("#totalrule_"+id).find("#hikeAmtLabel").addClass("zpl_DNI"),ZPeopleComponents.select(pageId.find("#tot"+id+"_rule"+index+"_ruleType")).setValue(PMSCommon.HIKE_RATING)}ZPeopleComponents.select(pageId.find("#totalrule_"+id).find("#tot"+id+"_rule"+index).find("#tot"+id+"_rule"+index+"_ruleType")).setAttributes({disabled:!0})}}},getTotalExpOption:function(){let opt=[];opt.push({name:"=",id:0}),opt.push({name:"<",id:1}),opt.push({name:">",id:2}),opt.push({name:"<=",id:3}),opt.push({name:">=",id:4}),opt.push({name:ZPI18N.getString("zp.between"),id:5});var dataObj={};return dataObj.options=opt,dataObj.contentType="text",dataObj.dataMapping={value:"id",label:"name",informativeText:"name"},dataObj.search={by:"name"},dataObj},getDOJOption:function(){let opt=[];opt.push({name:"<=",id:0}),opt.push({name:">=",id:1}),opt.push({name:ZPI18N.getString("zp.between"),id:2});let dataObj={};return dataObj.options=opt,dataObj.contentType="text",dataObj.dataMapping={value:"id",label:"name",informativeText:"name"},dataObj.search={by:"name"},dataObj},calcAllocateHike:function(){let pageId=settingsPage.container;var totalAmount=parseFloat(pageId.find("#totalAmount").text()),hikePer=pageId.find("#hikePercentage").val();PMSV2Cycle.isChanged=!0,"."==hikePer&&(hikePer="0");var mode=pageId.find("#hkBsdOn").find("[name=ruleOpt]:checked").val();if(""!=hikePer&&0!=Number(hikePer)&&void 0!=hikePer){var hikeCalcAmt=0;if(hikePer=Number(hikePer.replace(/[^0-9\.]+/g,"")),pageId.find("#hikePercentage").val(hikePer),"0"==mode)totalAmount+=hikeCalcAmt=parseFloat(totalAmount*(hikePer/100)),pageId.find("#totalAmountAfterHike").text(parseFloat(totalAmount).toFixed(2)),pageId.find("#totAmountView").text(parseFloat(hikeCalcAmt).toFixed(2));else{pageId.find("#custRules").find(".zpl_paappslyhike").length;var calchikeAmt=0;pageId.find("#custRules .zpl_paappslyhike").each(function(){var divNo=parseInt($(this).attr("series")),tbodyId1=$(this).attr("id");isNaN(Number(PMSV2Cycle.hikeAmtObj[divNo.toString()]))||(hikeCalcAmt+=parseFloat(PMSV2Cycle.hikeAmtObj[divNo.toString()]),calchikeAmt+=parseFloat(pageId.find("#"+tbodyId1).find("#hikeRuleAmt").val()))});var totHikeAmt=parseFloat((totalAmount-hikeCalcAmt)*hikePer/100),totHike=calchikeAmt+totHikeAmt;pageId.find("#totalAmountAfterHike").text((totalAmount+totHike).toFixed(2)),pageId.find("#totAmountView").text(totHike.toFixed(2))}}},calcRuleHike:function(isSubmit){PMSV2Cycle.isChanged=!0;var pageId=settingsPage.container,tbodylen=pageId.find("#custRules").find(".zpl_paappslyhike").length,existingLen=pageId.find("#custRules .zpl_paappslyhike").length;let id=0;existingLen>0&&(id=parseInt($(pageId.find("#custRules .zpl_paappslyhike")[existingLen-1]).attr("series")));var tbodyId="totalrule_"+id,hikePer=pageId.find("#"+tbodyId).find("#hikePercent").val(),custLen=PMSV2Cycle.CHOSEN_CUST_OPT.length,iscalc=!1;if(void 0!=PMSV2Cycle.hikeAmtObj&&PMSV2Cycle.hikeAmtObj.hasOwnProperty(id)&&delete PMSV2Cycle.hikeAmtObj[id],PMSV2Cycle.empCntArr.delete(id.toString()),pageId.find("#tot"+id+"_employeecnt").find("#ruleEmpCount").addClass("zpl_DNI"),pageId.find("#tot"+id+"_employeecnt").find("#rulEmpCnt").removeClass("zpl_DNI"),pageId.find("#tot"+id+"_employeecnt").find("#ruleEmpCount").text(),void 0!=hikePer&&""!=hikePer&&"0"!=hikePer&&"0.0"!=hikePer){if(pageId.find("#"+tbodyId).find(".ztextbox--error__label").remove(),pageId.find("#"+tbodyId).find(".ztextbox__error").removeClass("ztextbox__error"),PMSV2Cycle.checkRule(tbodyId,tbodylen,!1)){hikePer=Number(hikePer.replace(/[^0-9\.]+/g,"")),pageId.find("#"+tbodyId).find("#hikePercent").val(hikePer);var ruleObj={},ruleArr=[];for(let i=0;i<custLen;i++){var temp={},type=PMSV2Cycle.CHOSEN_CUST_OPT[i];if(1==type||4==type){var arr;if(0==(arr=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield("#tot"+id+"_rule"+i+"_option").getAllValues())).length)return pageId.find("#tot"+id+"_rule"+i).after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.entervalidinput")+"</span>"),!1;1==type?temp.desList=arr:temp.deptList=arr}else if(2==type){var expObj={},opt=ZPeopleComponents.select("#tot"+id+"_rule"+i+"_option").getValue();expObj.condType=opt;var val=Number(pageId.find("#tot"+id+"_rule"+i+"_expFrom_1").val());if(expObj.condValue=val,""==val.toString()||""==opt.toString())return pageId.find("#tot"+id+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.entervalidinput")+"</span>"),!1;if(5==opt){val=Number(pageId.find("#tot"+id+"_rule"+i+"_expTo_1").val());if(expObj.condValueTo=val,""==val)return pageId.find("#tot"+id+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;if(val<expObj.condValue)return pageId.find("#tot"+id+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validfromtoyearerror")+"</span>"),!1}temp.expDetails=expObj}else if(3==type){var dojObj={};opt=ZPeopleComponents.select("#tot"+id+"_rule"+i+"_option").getValue();if(dojObj.condType=opt,PMSV2Cycle.newDOJ){if(""==(val=2!=opt?ZPeopleComponents.datefield(pageId.find("#tot"+id+"_rule"+i+"_dojSel")).getValue().dateString:ZPeopleComponents.daterangepicker(pageId.find("#tot"+id+"_rule"+i+"_hkDoj")).getFromValue().fromValueString).toString()||""==opt.toString())return pageId.find("#tot"+id+"_rule"+i+"_dojDetails").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;if(2==opt){var fromDate=val,toDate=ZPeopleComponents.daterangepicker(pageId.find("#tot"+id+"_rule"+i+"_hkDoj")).getToValue().toValueString;dojObj.condValue=fromDate,dojObj.condValueTo=toDate}else dojObj.condValue=val;dojObj.isnew=!0,temp.dojDetails=dojObj}else{val=Number(pageId.find("#tot"+id+"_rule"+i+"_expFrom_1").val());if(dojObj.condValue=val,""==val.toString()||""==opt.toString())return pageId.find("#tot"+id+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.entervalidinput")+"</span>"),!1;if(5==opt){val=Number(pageId.find("#tot"+id+"_rule"+i+"_expTo_1").val());if(expObj.condValueTo=val,""==val)return pageId.find("#tot"+id+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;if(val<expObj.condValue)return pageId.find("#tot"+id+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validfromtoyearerror")+"</span>"),!1}temp.expDetails=dojObj}}else if(5==type){val=ZPeopleComponents.select("#tot"+id+"_rule"+i+"_option").getValue();if(temp.rating=val,""==val)return pageId.find("#tot"+id+"_rule"+i).after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.entervalidinput")+"</span>"),!1}ruleArr.push(temp)}ruleObj.criteria=ruleArr,ruleObj.hikePer=hikePer,ruleObj.ruleFormat=PMSV2Cycle.CHOSEN_CUST_OPT;let formdata=new FormData;PMSV2Cycle.getApplicableCriObj(formdata),formdata.append("conreqcsr",csrfToken),formdata.append("hikeRuleConfig",JSON.stringify(ruleObj)),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp?mode=calculateRuleHike",data:formdata,processData:!1,contentType:!1,success:function(resultData){if("0"==resultData.totalEmployees)return PMSV2Cycle.isCalculate=!1,PMSV2Cycle.SelCustArr.delete(id.toString()),PMSV2Cycle.curRule=new Map,pageId.find("#sel_opt_error").remove(),pageId.find("#tot"+id+"_employeecnt").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.noemployeesapplicable")+"</span>"),!1;PMSV2Cycle.isCalculate=!0;var Amt=parseFloat(resultData.totalAmount);isNaN(Amt)&&(Amt=0),PMSV2Cycle.empCntArr.set(id.toString(),resultData.totalEmployees),PMSV2Cycle.hikeAmtObj[id]=Amt;var hikeAmt=Amt*(hikePer/100);isNaN(hikeAmt)&&(hikeAmt=0),pageId.find("#"+tbodyId).find("#hikeRuleAmt").val(parseFloat(hikeAmt).toFixed(2));var keyArr=Object.keys(PMSV2Cycle.hikeAmtObj),calcSal=(pageId.find("#custRules").find(".zpl_paappslyhike").length,0),calchikeAmt=0;pageId.find("#custRules .zpl_paappslyhike").each(function(){var divNo=parseInt($(this).attr("series")),tbodyId1=$(this).attr("id");keyArr.includes(divNo.toString())&&(calcSal+=parseFloat(PMSV2Cycle.hikeAmtObj[divNo.toString()]),calchikeAmt+=parseFloat(pageId.find("#"+tbodyId1).find("#hikeRuleAmt").val()))});var totalAmount=parseFloat(pageId.find("#totalAmount").text()),hikepercentage=pageId.find("#hikePercentage").val(),totHike=0,totAmt=0;""!=(hikepercentage=Number(hikepercentage.replace(/[^0-9\.]+/g,"")))&&0!=Number(hikepercentage)&&(totHike=parseFloat((totalAmount-calcSal)*hikepercentage/100)),totAmt=totalAmount+calchikeAmt+totHike,totHike+=calchikeAmt,isNaN(totAmt)&&(totAmt=0),isNaN(totHike)&&(totHike=0),"-1"==resultData.totalEmployees?PMSV2Cycle.empCntArr.set(id.toString(),0):PMSV2Cycle.empCntArr.set(id.toString(),resultData.totalEmployees),pageId.find("#totAmountView").text(parseFloat(totHike).toFixed(2)),pageId.find("#totalAmountAfterHike").text(parseFloat(totAmt).toFixed(2)),pageId.find("#nonruleEmpCount").addClass("zpl_DNI"),pageId.find("#nonrulEmpCnt").removeClass("zpl_DNI"),iscalc=!0}})}}else isSubmit&&(PMSV2Cycle.showError(ZPI18N.getString("zp.enteravalue"),pageId.find("#totalrule_"+id).find("#hikePercent"),2),pageId.find("#totalrule_"+id).find("[elem='errorMsg']").css("text-align","center"));return iscalc},checkRule:function(tbodyId,len,ischeck,isEmpCnt){var pageId=settingsPage.container;let selRule=new Map,custLen=PMSV2Cycle.CHOSEN_CUST_OPT.length;var ruleDivNo=tbodyId.split("totalrule_").toString().replace(",","");pageId.find("#"+tbodyId).find(".ztextbox--error__label").remove();for(let i=0;i<custLen;i++){let mode=PMSV2Cycle.CHOSEN_CUST_OPT[i];if(mode==PMSCommon.HIKE_DESIGNATION||mode==PMSCommon.HIKE_DEPARTMENT){let val=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield("#tot"+ruleDivNo+"_rule"+i+"_option").getAllValues());val.sort();let optLen=val.length;var str="";for(let j=0;j<optLen;j++){if(""==(opt=val[j].toString()))return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_ruleVal").append('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.entervalidinput")+"</span>"),!1;str=(str=str.concat("_")).concat(opt)}if(0==optLen)return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_ruleVal").append('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.entervalidinput")+"</span>"),!1;1==mode?selRule.set("desList",str):selRule.set("deptList",str)}else if(mode==PMSCommon.HIKE_TOTAL_EXPERIENCE||mode==PMSCommon.HIKE_DATE_OF_JOIN&&!PMSV2Cycle.newDOJ){var val1=ZPeopleComponents.select("#tot"+ruleDivNo+"_rule"+i+"_option").getValue(),letters=/^[A-Za-z]+$/;if(""==(val2=pageId.find("#tot"+ruleDivNo+"_rule"+i+"_expFrom_1").val())||void 0==val2)return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;if(val2.match(letters))return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;var val3=-1;if(5==val1)if(""==(val3=(val3=pageId.find("#tot"+ruleDivNo+"_rule"+i+"_expTo_1").val()).toString())||void 0==val3||val3.match(letters))return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_expTo_1").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;val1=val1.toString(),val2=val2.toString();str="";str=-1==val3?val1+"_"+val2:val1+"_"+val2+"_"+val3,2==mode?selRule.set("Experience",str):selRule.set("DateOfJoin",str)}else if(mode==PMSCommon.HIKE_DATE_OF_JOIN){var opt,val2=-1;val3=-1;if(""===(val=2!=(opt=ZPeopleComponents.select("#tot"+ruleDivNo+"_rule"+i+"_option").getValue())?ZPeopleComponents.datefield(pageId.find("#tot"+ruleDivNo+"_rule"+i+"_dojSel")).getValue().dateString:ZPeopleComponents.daterangepicker(pageId.find("#tot"+ruleDivNo+"_rule"+i+"_hkDoj")).getFromValue().fromValueString)||null===val||void 0==val)return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_dojDetails").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.invaliddate")+"</span>"),!1;if(2!=opt){if(!PMSV2Cycle.checkvalidDate(val))return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_dojDetails").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.invaliddate")+"</span>"),!1}else{var fromDate=val,toDate=ZPeopleComponents.daterangepicker(pageId.find("#tot"+ruleDivNo+"_rule"+i+"_hkDoj")).getToValue().toValueString;if(null==fromDate||!Calendar.isvalidDate(fromDate)||!PMSV2Cycle.checkvalidDate(fromDate))return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_dojDate").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.invaliddate")+"</span>"),!1;if(null==toDate||!Calendar.isvalidDate(toDate)||!PMSV2Cycle.checkvalidDate(toDate))return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_dojDate").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.invaliddate")+"</span>"),!1;val2=fromDate,val3=toDate;var fdate=Calendar.parseDate(fromDate,uidateFormat);if(Calendar.parseDate(toDate,uidateFormat)<fdate)return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_dojDate").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.invaliddate")+"</span>"),!1}str=2!=opt?opt+"_"+val:opt+"_"+val2+"_"+val3,selRule.set("DateOfJoin",str)}else if(mode==PMSCommon.HIKE_RATING){var val;if(""==(val=ZPeopleComponents.select("#tot"+ruleDivNo+"_rule"+i+"_option").getValue())||"-1"==val||void 0==val)return pageId.find("#tot"+ruleDivNo+"_rule"+i+"_ruleVal").append('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.entervalidinput")+"</span>"),!1;str=val.toString();selRule.set("Rating",str)}}if(!isEmpCnt){var hikepercent=pageId.find("#"+tbodyId).find("#hikePercent").val();if(""==hikepercent||Number(hikepercent)<0||0==hikepercent||0==hikepercent)return pageId.find("#"+tbodyId).append('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validproposedhikepercentage")+"</span>"),!1}return PMSV2Cycle.findDuplicateEntry(ischeck,selRule,ruleDivNo,len)},findDuplicateEntry:function(ischeck,curArr,tbodyNo,len){if(1==len)ischeck&&PMSV2Cycle.SelCustArr.set("0",curArr);else{let pageId=settingsPage.container;var len1=PMSV2Cycle.SelCustArr.size,trLen=PMSV2Cycle.CHOSEN_CUST_OPT.length,isallow=!0,selArr=[...PMSV2Cycle.SelCustArr];for(let iter=0;iter<len1;iter++){let index=selArr[iter][0];var count=curArr.size;let map1=selArr[iter][1];if(map1.forEach(function(value,key){if("desList"==key&&curArr.has("desList")){var flag=0;if(value===(str1=curArr.get("desList")))count-=1;else{var arr=value.split("_"),arr1=str1.split("_");for(k=1;k<arr1.length;k++)arr.includes(arr1[k])&&(flag=1);1==flag&&(count-=1)}0}else if("deptList"==key&&curArr.has("deptList")){var str1;flag=0;if(value===(str1=curArr.get("deptList")))count-=1;else{arr=value.split("_"),arr1=str1.split("_");for(k=1;k<arr1.length;k++)arr.includes(arr1[k])&&(flag=1);1==flag&&(count-=1)}0}if("Experience"==key&&curArr.has("Experience")||"DateOfJoin"==key&&curArr.has("DateOfJoin")){if("Experience"==key&&value===curArr.get("Experience"))count-=1;else if("DateOfJoin"==key&&value===curArr.get("DateOfJoin"))count-=1;else{var list=value.split("_"),list1="Experience"==key?curArr.get("Experience").split("_"):curArr.get("DateOfJoin").split("_"),prevopt=list[0],curOpt=list1[0],from=to=list[1],curFrom=curTo=list1[1];if(PMSV2Cycle.newDOJ&&"DateOfJoin"==key)2==prevopt&&(to=list[2],to=Calendar.parseDate(to,uidateFormat)),2==curOpt&&(curTo=list1[2],curTo=Calendar.parseDate(curTo,uidateFormat)),curFrom=Calendar.parseDate(curFrom,uidateFormat),from=Calendar.parseDate(from,uidateFormat),0==prevopt?(0==curOpt&&(curFrom<=from||curFrom>=from)||1==curOpt&&from>=curFrom||2==curOpt&&from>=curFrom)&&(count-=1):1==prevopt?(0==curOpt&&(curFrom>=from||curFrom<=from)||1==curOpt&&curFrom<=from||2==curOpt&&(curFrom>=from||curTo>=to))&&(count-=1):2==prevopt&&(0==curOpt&&curFrom>=from||1==curOpt&&curFrom<=from||2==curOpt&&(curTo>=from&&curTo<=to||curFrom>=from&&curFrom<=to))&&(count-=1);else{if((""==curFrom||void 0==curFrom)&&(""==from||void 0==from)||1==curOpt&&0==curFrom)return pageId.find("#tot"+tbodyNo+"_rule"+index).append('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),isallow=!1,!1;if(5==curOpt){if(to=list[2],curTo=list1[2],""===curTo||void 0==curTo)return pageId.find("#tot"+tbodyNo+"_rule"+index).append('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validyearerror")+"</span>"),isallow=!1,!1;if(Number(curTo)<=Number(curFrom))return pageId.find("#tot"+tbodyNo+"_rule"+index).append('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.validfromtoyearerror")+"</span>"),isallow=!1,!1;""!=curTo&&void 0!=curTo&&(curTo=Number(curTo.replace(/[^0-9]+/g,"")))}0==prevopt?(curFrom==from&&(0==curOpt||3==curOpt||4==curOpt)||(1==curOpt||3==curOpt)&&Number(from)<Number(curFrom)||(2==curOpt||4==curOpt)&&Number(from)>Number(curFrom)||5==curOpt&&Number(from)>Number(curFrom)&&Number(from)<Number(curTo))&&(count-=1):1==prevopt?(Number(curFrom)<Number(from)||(1==curOpt||3==curOpt)&&Number(from)<=Number(curFrom)||5==curOpt&&(Number(curTo)<Number(from)||Number(curFrom)<Number(from)))&&(count-=1):2==prevopt?(curFrom>from||(2==curOpt||4==curOpt)&&from>=curFrom||5==curOpt&&(Number(curTo)>Number(from)||Number(curFrom)>Number(from)))&&(count-=1):3==prevopt?(Number(curFrom)<Number(from)||5!=curOpt&&2!=curOpt&&from==curFrom||(1==curOpt||3==curOpt)&&Number(from)<Number(curFrom)||5==curOpt&&Number(curTo)<Number(from))&&(count-=1):4==prevopt?(Number(curFrom)>Number(from)||5!=curOpt&&1!=curOpt&&from==curFrom||(2==curOpt||4==curOpt)&&Number(from)>Number(curFrom)||5==curOpt&&Number(curTo)>Number(from))&&(count-=1):5==prevopt&&(Number(curFrom)>Number(from)&&Number(curFrom)<Number(to)||Number(curTo)>Number(from)&&Number(curTo)<Number(to)||(1==curOpt||3==curOpt)&&(Number(curFrom)>Number(to)||Number(curFrom)>Number(from))||(2==curOpt||4==curOpt)&&(Number(curFrom)<Number(to)||Number(curFrom)<Number(from))||5==curOpt&&Number(curTo)>Number(from)&&Number(curFrom)<Number(to))&&(count-=1)}}0}if("Rating"==key&&curArr.has("Rating")&&(value===curArr.get("Rating")&&(count-=1),0),0==count&&map1.size===curArr.size){var ruleType=ZPeopleComponents.select("#tot"+tbodyNo+"_rule"+(trLen-1)+"_ruleType").getValue();return 2==ruleType||!PMSV2Cycle.newDOJ&&3==ruleType?pageId.find("#tot"+tbodyNo+"_rule"+(trLen-1)+"_expDetailsTable").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.ruleExist")+"</span>"):3==ruleType?pageId.find("#tot"+tbodyNo+"_rule"+(trLen-1)+"_dojDetails").after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.ruleExist")+"</span>"):pageId.find("#tot"+tbodyNo+"_rule"+(trLen-1)).after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.ruleExist")+"</span>"),isallow=!1,!1}}),!isallow)return!1}1==ischeck&&PMSV2Cycle.SelCustArr.set(tbodyNo,curArr)}if(PMSV2Cycle.curRule.size==curArr.size){for(var[key,val]of curArr)if(testVal=PMSV2Cycle.curRule.get(key),testVal!==val||void 0===testVal&&!map2.has(key)){PMSV2Cycle.curRule=curArr;break}}else PMSV2Cycle.curRule=curArr;return!0},changeHikeExpObj:function(eData){if(!eData||""!==eData.detail.selectedValue&&eData.detail.previousValue!=eData.detail.selectedValue){var pageId=settingsPage.container,id=$(eData.currentTarget).attr("id"),idArr=pageId.find("#"+id).parent().parent().attr("id").split("_"),tbodyid=idArr[0],ruleid=idArr[1],tID=pageId.find("#"+tbodyid+"_"+ruleid+"_option").closest(".zpl_paappslyhike").attr("id"),selectedVal=ZPeopleComponents.select("#"+tbodyid+"_"+ruleid+"_option").getValue();if(pageId.find("#"+tID).find(".ztextbox--error__label").remove(),-1==selectedVal)return pageId.find("#"+tbodyid+"_"+ruleid).after('<span elem="errorMsg" class="ztextbox--error__label" id="sel_opt_error">'+ZPI18N.getString("zp.selectcriteria")+"</span>"),!1;if("dojDetails"==idArr[2])if(2==selectedVal){ZPeopleComponents.datefield("#"+tbodyid+"_"+ruleid+"_dojSel").destroy(),pageId.find("#hkDojdateRangePicker").append(`<div id="${tbodyid}_${ruleid}_hkDoj"  data-for-element="#${tbodyid}_${ruleid}_dojSel"></div>`),pageId.find("#"+tbodyid+"_"+ruleid+"_dojDate").html(`<div class="ztextbox--group zh-alignright"><i class="ztextbox__icon PI_calendar"></i><input id="${tbodyid}_${ruleid}_dojSel" fld="dojRangeHide" class="ztextbox"></div>`),ZPeopleComponents.daterangepicker("#"+tbodyid+"_"+ruleid+"_hkDoj",{change:function(event,ui){pageId.find("#"+tbodyid+"_"+ruleid+"_dojSel").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker=pageId.find("#hkDojdateRangePicker").find("#"+tbodyid+"_"+ruleid+"_hkDoj");pageId.find("#"+tbodyid+"_"+ruleid+"_dojSel").on("click",function(){pageId.find("#"+tbodyid+"_"+ruleid+"_hkDoj").is(":visible")?ZPeopleComponents.daterangepicker(picker).close():ZPeopleComponents.daterangepicker(picker).open()})}else{2==eData.detail.previousValue?(ZPeopleComponents.daterangepicker("#"+tbodyid+"_"+ruleid+"_dojSel").destroy(),pageId.find("#"+tbodyid+"_"+ruleid+"_hkDoj").remove()):ZPeopleComponents.datefield("#"+tbodyid+"_"+ruleid+"_dojSel").destroy(),pageId.find("#"+tbodyid+"_"+ruleid+"_dojDate").html(`<input id="${tbodyid}_${ruleid}_dojSel" class="ztextbox">`);var effectiveDateOptions={calendarIcon:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none",pickerclose:PMSV2Cycle.calcRuleHike};ZPeopleComponents.datefield(pageId.find("#"+tbodyid+"_"+ruleid+"_dojSel"),effectiveDateOptions)}else if(5==selectedVal){var td=`<div id="${tbodyid}_${ruleid}_expTo" ><input type="text" class="form-control" value="" placeholder="${ZPI18N.getString("zp.years")}" id="${tbodyid}_${ruleid}_expTo_1" onchange="PMSV2Cycle.calcRuleHike();" onkeydown="return paCommonUtil.onNRKeyDown(this,event,'year');"></div>`;pageId.find("#"+tbodyid+"_"+ruleid+"_expFrom").after(td)}else pageId.find("#"+tbodyid+"_"+ruleid+"_expTo").remove();2==selectedVal&&"dojDetails"==idArr[2]||PMSV2Cycle.calcRuleHike()}},deleteAllRules:function(){},onChangeApplicableCurrency:function(eData){if(eData.fromUI){settingsPage.container;void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource}},onChangeApplicableFields:function(eData,id){var pageId=settingsPage.container;if(void 0!=eData&&!eData.fromUI){if(void 0==eData.type||"zdatefieldpickerclose"!=eData.type)return;var dojSelVal=pageId.find("#dojCrt").val(),returnedData="DOJ_UNTIL"==dojSelVal?ZPeopleComponents.datefield(pageId.find("#dojVal1")).getValue():"";if(""===returnedData&&"DOJ_UNTIL"!=dojSelVal&&(returnedData="DOJ_UNTIL"==(dojSelVal=pageId.find("#dojCrt_2").val())?ZPeopleComponents.datefield(pageId.find("#dojVal1_2")).getValue():""),"DOJ_UNTIL"!=dojSelVal)return;if(!(returnedData.dateString!=PMSV2Cycle.SELECTED_DOJUTIL_DATE||null!=PMSV2Cycle.SELECTED_DOJUTIL_DATE&&void 0==returnedData.dateString||null==PMSV2Cycle.SELECTED_DOJUTIL_DATE&&void 0!=returnedData.dateString))return;void 0==returnedData.dateString?PMSV2Cycle.SELECTED_DOJUTIL_DATE=null:PMSV2Cycle.SELECTED_DOJUTIL_DATE=returnedData.dateString}null!=id&&""!=id&&void 0!=id&&(PMSV2Cycle.saveApplicabilityValues(eData,id),PMSV2Cycle.isBudgetCalc=!0),null!=eData&&void 0!=eData&&(eData.fromUI||!eData.fromUI&&void 0!=eData.type&&"zdatefieldpickerclose"==eData.type)&&(PMSV2Cycle.saveApplicabilityValues(eData,id),(!eData.fromUI&&void 0!=eData.type&&"zdatefieldpickerclose"==eData.type||""!==eData.selectedValue&&eData.previousValue!=eData.selectedValue)&&(PMSV2Cycle.IS_SAL_HK_ENABLED||SalaryHikeV2Cycle.isSalaryHikeCycle)&&(PMSV2Cycle.isBudgetCalc=!0))},changeRuleType:function(eData){if(eData.fromUI){settingsPage.container;PMSV2Cycle.doChangeRuleType(eData.selectedValue)}},getSalaryDesignationLayout:function(){return'<tr id="rules_1"><td><div class="zpl_idiv w100"><textarea id="budgetDes_1" style="display: none;"></textarea></div></td><td><input type="text" id="ruleHike_1" class="ztextbox" value="" onkeydown="return PMSV2Cycle.onNRKeyDown(this,event,\'hike\');" onchange="PMSV2Cycle.calculateHike(this)"></td><td><input type="text" id="ruleHikeAmt_1" class="ztextbox" value="" disabled></td><td width="10%"> <div class="text-center"> <div class="zpl_hvr"> <i id="ruleDel_'+length+'" style="opacity: 0;" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" ></i> </div> </div> </td></tr>'},getSalaryTweLayout:function(){var html='<tr id="rules_1"><td><div class="zpl_idiv w200"><select id="expOpt_1" style="display: none;"></select></div></td>';return html+='<td><input type="text" id="expFrom_1" class="ztextbox" placeholder="'+ZPI18N.getString("zp.years")+'" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'year\');" onchange="PMSV2Cycle.checkExpYear(this)" value=""></td>',html+='<td class="DN" yearelem="hide"><input type="text" id="expTo_1" placeholder="'+ZPI18N.getString("zp.years")+'" class="ztextbox" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'year\');" onchange="PMSV2Cycle.checkExpYear(this)"></td>',html+='<td><input type="text" id="ruleHike_1" class="ztextbox" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'hike\');" onchange="PMSV2Cycle.checkExpHike(this)"></td>',html+='<td><input type="text" id="ruleHikeAmt_1" class="ztextbox" value="" disabled></td>',html+='<td width="10%"> <div class="text-center"> <div class="zpl_hvr"> <i id="ruleDel_'+length+'" style="opacity: 0;" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" ></i> </div> </div> </td></tr>'},doChangeRuleType:function(mode){var pageId=settingsPage.container,budgetData=PMSTmpl.BUDGET_CONFIG_DATA;pageId.find("#hikeAmountView").text(parseFloat(budgetData.totalcalcHikeAmount).toFixed(0));var totalAmt=Number(budgetData.totalcalcHikeAmount)+Number(budgetData.totalAmount);pageId.find("#totalAmountAfterHike").text(parseFloat(totalAmt).toFixed(0));var ruleDetails=budgetData.ruleDetails,hikeRuleType=budgetData.hikeRuleType;if(mode==PMSCommon.HIKE_DESIGNATION){if(pageId.find("#desRuleObj").attr("style","display: block"),pageId.find("#expRuleObj").css("display","none"),pageId.find("#desRuleObj textarea").length>0&&pageId.find("#desRuleObj textarea").each(function(index){ZPeopleComponents.tokenfield(pageId.find("#"+$(this).attr("id"))).destroy()}),PMSV2Cycle.EDIT_CYCLE_FLAG&&mode==hikeRuleType){var i=1;if(void 0!=ruleDetails&&0!=ruleDetails.length){var desTBodyContainer=pageId.find("#desRuleObj #desTBody");$.each(ruleDetails,function(index,data){var ruleData;ruleData=ruleDetails[index];var html='<tr id="rules_'+i+'"><td><div class="zpl_idiv w100"><textarea id="budgetDes_'+i+'" style="display: none;"></textarea></div></td>';html+='<td><input type="text" id="ruleHike_'+i+'" class="ztextbox" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'hike\');" onchange="PMSV2Cycle.calculateHike(this)"></td>',html+='<td><input type="text" id="ruleHikeAmt_'+i+'" class="ztextbox" value="" disabled></td><td width="10%"> <div class="text-center"> <div class="zpl_hvr">',html+=1==i?'<i id="ruleDel_'+i+'" style="opacity: 0;" title="'+ZPI18N.getString("zp.delete")+'" class="PI_delete"></i>':'<i id="ruleDel_'+i+'" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSV2Cycle.removeRule(this)"></i>',html+="</div> </div> </td></tr>",desTBodyContainer.append(html),desTBodyContainer.find("#ruleHike_"+i+",#ruleHikeAmt_"+i).val("");var desIds=[];$.each(ruleData.desList,function(index,data){if(PMSTmpl.DESIGNATION_LIST.hasOwnProperty(data)){var _singleObj={};_singleObj.name=ZPeople.decodeTxt(PMSTmpl.DESIGNATION_LIST[data].recName),_singleObj.id=data,desIds.push(_singleObj)}});var _tokenObj={},_options=[];$.each(PMSTmpl.DESIGNATION_LIST,function(index,data){if(PMSTmpl.DESIGNATION_SALARY.hasOwnProperty(data.recID)){var _singleObj={};_singleObj.name=ZPeople.decodeTxt(data.recName),_singleObj.id=data.recID,_options.push(_singleObj)}}),_tokenObj.data=_options,_tokenObj.contentType="text",_tokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_tokenObj.search={by:"name"},_tokenObj.allowDuplicateValues=!1,_tokenObj.values=desIds,_tokenObj.tokenadd=PMSV2Cycle.onhiketokenadd,_tokenObj.tokenremove=PMSV2Cycle.onhiketokenadd,ZPeopleComponents.tokenfield(desTBodyContainer.find("#budgetDes_"+i),_tokenObj),desTBodyContainer.find("#ruleHike_"+i).val(ruleData.hikePer),desTBodyContainer.find("#ruleHikeAmt_"+i).val(ruleData.hikeAmt),i++})}pageId.find("#hikePercentage").attr("tdVal",parseFloat(budgetData.hikePercentage).toFixed(2)),pageId.find("#hikePercentage").val(parseFloat(budgetData.hikePercentage).toFixed(2)+"%")}else{var _htm=PMSV2Cycle.getSalaryDesignationLayout();pageId.find("#desRuleObj #desTBody").html(_htm),pageId.find("#desRuleObj #desTBody").find("#ruleHike_1,#ruleHikeAmt_1").val("");var _tokenObj={},_options=[];$.each(PMSTmpl.DESIGNATION_LIST,function(index,data){if(PMSTmpl.DESIGNATION_SALARY.hasOwnProperty(data.recID)){var _singleObj={};_singleObj.name=ZPeople.decodeTxt(data.recName),_singleObj.id=data.recID,_options.push(_singleObj)}}),_tokenObj.data=_options,_tokenObj.contentType="text",_tokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_tokenObj.search={by:"name"},_tokenObj.allowDuplicateValues=!1,_tokenObj.tokenadd=PMSV2Cycle.onhiketokenadd,_tokenObj.tokenremove=PMSV2Cycle.onhiketokenadd,ZPeopleComponents.tokenfield(pageId.find("#budgetDes_1"),_tokenObj)}pageId.find("#hkBsdOnFld").html(ZPI18N.getString("zp.hikebasedon",[ZPI18N.getString("zp.designation")]))}else if(mode==PMSCommon.HIKE_DATE_OF_JOIN||mode==PMSCommon.HIKE_TOTAL_EXPERIENCE){if(pageId.find("#expRuleObj select").length>0&&pageId.find("#expRuleObj select").each(function(index){ZPeopleComponents.select(pageId.find("#"+$(this).attr("id"))).destroy()}),pageId.find("#expRuleObj").attr("style","display: block"),pageId.find("#desRuleObj").css("display","none"),pageId.find("#expRuleObj #expTBody").empty(),pageId.find("#expRuleObj #expTo_header").addClass("DN"),mode==PMSCommon.HIKE_DATE_OF_JOIN?pageId.find("#hikeRuleHeaderName").html(ZPI18N.getString("zp.dateofjoining")):pageId.find("#hikeRuleHeaderName").html(ZPI18N.getString("zp.totalworkexperience")),PMSV2Cycle.EDIT_CYCLE_FLAG&&mode==hikeRuleType){if(void 0!=ruleDetails&&0!=ruleDetails.length){i=1;$.each(ruleDetails,function(index,data){var ruleData={};ruleData=ruleDetails[index];var ruleComp='<tr id="rules_'+i+'"><td><div class="zpl_idiv w200"><select id="expOpt_'+i+'" style="display: none;"></select></div></td>';ruleComp+='<td><input type="text" id="expFrom_'+i+'" class="ztextbox" placeholder="'+ZPI18N.getString("zp.years")+'" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'year\');" onchange="PMSV2Cycle.checkExpYear(this)" value=""></td>',ruleComp+='<td class="DN" yearelem="hide"><input type="text" id="expTo_'+i+'" placeholder="'+ZPI18N.getString("zp.years")+'" class="ztextbox" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'year\');" onchange="PMSV2Cycle.checkExpYear(this)"></td>',ruleComp+='<td><input type="text" id="ruleHike_'+i+'" class="ztextbox" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'hike\');" onchange="PMSV2Cycle.checkExpHike(this)"></td>',ruleComp+='<td><input type="text" id="ruleHikeAmt_'+i+'" class="ztextbox" value="" disabled></td>',ruleComp+='<td width="10%"> <div class="text-center"> <div class="zpl_hvr">',ruleComp+=1==i?'<i id="ruleDel_'+i+'" style="opacity: 0;" title="'+ZPI18N.getString("zp.delete")+'" class="PI_delete"></i>':'<i id="ruleDel_'+i+'" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSV2Cycle.removeRule(this)"></i>',ruleComp+="</div> </div> </td></tr>",pageId.find("#expRuleObj #expTBody").append(ruleComp),pageId.find("#expRuleObj #expTBody").find("#expFrom_"+i+",#expTo_"+i+",#ruleHike_"+i+",#ruleHikeAmt_"+i).val("").text("");var _tokenObj={};_tokenObj.options=PMSV2Cycle.getTotalExpOption(),_tokenObj.contentType="text",_tokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},_tokenObj.value=ruleData.expDetails.condType,ZPeopleComponents.select(pageId.find("#rules_"+i+" #expOpt_"+i),_tokenObj),$(pageId.find("#rules_"+i+" #expOpt_"+i)).on("zselectchange",PMSV2Cycle.changeHikeExpObj),pageId.find("#rules_"+i+" #expFrom_"+i).val(ruleData.expDetails.condValue),ruleData.expDetails.hasOwnProperty("condValueTo")&&pageId.find("#rules_"+i+" #expTo_"+i).val(ruleData.expDetails.condValueTo),pageId.find("#rules_"+i+" #ruleHike_"+i).val(ruleData.hikePer),pageId.find("#rules_"+i+" #ruleHikeAmt_"+i).val(ruleData.hikeAmt),i++})}var container=pageId.find("#expRuleObj #expTBody"),ismodefive=!1;container.find("tr").each(function(){var selectObj=$(this).find("select");5==ZPeopleComponents.select(selectObj).getValue()&&(ismodefive=!0)}),ismodefive&&(container.find("tr").each(function(){var selectObj=$(this).find("select"),selectid=ZPeopleComponents.select(selectObj).getValue();$(this).find("[yearelem=hide]").removeClass("DN"),5!=selectid?$(this).find("[yearelem=hide] input").hide():$(this).find("[yearelem=hide] input").show()}),pageId.find("#expRuleObj #expTo_header").removeClass("DN")),pageId.find("#hikePercentage").attr("tdVal",parseFloat(budgetData.hikePercentage).toFixed(2)),pageId.find("#hikePercentage").val(parseFloat(budgetData.hikePercentage).toFixed(2)+"%")}else{_htm=PMSV2Cycle.getSalaryTweLayout();pageId.find("#expRuleObj #expTBody").html(_htm),pageId.find("#expRuleObj #expTBody").find("#expFrom_1,#expTo_1,#ruleHike_1,#ruleHikeAmt_1").val("").text(""),(_tokenObj={}).options=PMSV2Cycle.getTotalExpOption(),_tokenObj.contentType="text",_tokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},ZPeopleComponents.select(pageId.find("#expOpt_1"),_tokenObj),$(pageId.find("#expOpt_1")).on("zselectchange",PMSV2Cycle.changeHikeExpObj)}mode==PMSCommon.HIKE_DATE_OF_JOIN?pageId.find("#hkBsdOnFld").html(ZPI18N.getString("zp.hikebasedon",[ZPI18N.getString("zp.dateofjoining")])):pageId.find("#hkBsdOnFld").html(ZPI18N.getString("zp.hikebasedon",[ZPI18N.getString("zp.totalworkexperience")]))}mode==PMSCommon.HIKE_NO_RULE?pageId.find("#incPerLabel").html(PMSV2Cycle.ALLOCATEDHIKENAME+" "+ZPI18N.getString("zp.percentage")):pageId.find("#incPerLabel").html(ZPI18N.getString("zp.allocatedhikecriterianotmatch",[PMSV2Cycle.ALLOCATEDHIKENAME])),PMSV2Cycle.EDIT_CYCLE_FLAG||(PMSV2Cycle.onHikeChange(pageId.find("#hikePercentage"),1),pageId.find("#hikePercentage").val(""),pageId.find("#hikePercentage").attr("tdval",""))},onhiketokenadd:function(eData){PMSV2Cycle.calculateHike($(eData.target))},onHikeChange:function(obj,typeCalc){settingsPage.container;var hikeID=$(obj).attr("id"),container=settingsPage.container,parentDiv=$(obj).closest("[id=C_E_hike]"),totalAmount=container.find("#totalAmount").attr("totalAmount"),mode="1"===container.find("#hkBsdOn").val()?container.find("#hkFldType").val():container.find("#hkBsdOn").val();if("hikePercentage"===hikeID?("."!=(hikePer=$(obj).val())&&""!=hikePer||(hikePer="0"),hikePer=Number(hikePer.replace(/[^0-9\.]+/g,"")),hikeAmt=Number(totalAmount)*(hikePer/100)):"hikeAmount"===hikeID?(hikeAmt=$(obj).val(),hikePer=(hikeAmt=Number(hikeAmt.replace(/[^0-9\.]+/g,"")))/Number(totalAmount)*100):(hikeAmt=0,hikePer=0),void 0!=typeCalc&&2==typeCalc)return hikePerStr=hikePer.toFixed(2)+"%",$(parentDiv).find("#hikePercentage").val(hikePerStr),void $(parentDiv).find("#hikePercentage").attr("tdVal",hikePer);if(void 0==typeCalc&&mode!=PMSCommon.HIKE_NO_RULE){var defPer=hikePer;if(void 0!==defPer&&""!==defPer){var desHAmt=0,totalAmt=PMSTmpl.TOTAL_SALARY;mode==PMSCommon.HIKE_DESIGNATION?(container.find("#desRuleObj #desTBody").find("tr").length,container.find("#desRuleObj #desTBody").children().each(function(){let trID=$(this).attr("id").split("_");var currRule=$(this);let i=parseInt(trID[1]);var desList=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield($(currRule).find("#budgetDes_"+i)).getAllValues()),budgetHikePer=$(currRule).find("#ruleHike_"+i).val();if(void 0!=budgetHikePer&&""!=budgetHikePer&&void 0!=desList&&0!=desList.length){for(var desLen=desList.length,j=0;j<desLen;j++)totalAmt=Number(totalAmt)-Number(PMSTmpl.DESIGNATION_SALARY[desList[j]]);desHAmt+=Number($(currRule).find("#ruleHikeAmt_"+i).val())}}),totalAmt=Number(totalAmt)*(defPer/100),hikePerStr=Number(hikePer).toFixed(2)+"%",$(parentDiv).find("#hikePercentage").val(hikePerStr),$(parentDiv).find("#hikePercentage").attr("tdVal",hikePer),totalAmt=Number(totalAmt).toFixed(0),totalAmt=Number(totalAmt)+Number(desHAmt),container.find("#hikeAmountView").text(totalAmt),container.find("#totalAmountAfterHike").text(Number(PMSTmpl.TOTAL_SALARY)+Number(totalAmt))):(hikePerStr=Number(hikePer).toFixed(2)+"%",$(parentDiv).find("#hikePercentage").val(hikePerStr),$(parentDiv).find("#hikePercentage").attr("tdVal",hikePer),PMSV2Cycle.calculateTotalExpHike())}}else{var hikeAmt,hikePer;hikePerStr=hikePer.toFixed(2)+"%",$(parentDiv).find("#hikePercentage").val(hikePerStr),$(parentDiv).find("#hikePercentage").attr("tdVal",hikePer),"hikePercentage"===hikeID?("."==(hikePer=$(obj).val())&&(hikePer="0"),hikePer=Number(hikePer.replace(/[^0-9\.]+/g,"")),hikeAmt=Number(totalAmount)*(hikePer/100)):"hikeAmount"===hikeID?(hikeAmt=$(obj).val(),hikePer=(hikeAmt=Number(hikeAmt.replace(/[^0-9\.]+/g,"")))/Number(totalAmount)*100):(hikeAmt=0,hikePer=0),hikePerStr=hikePer.toFixed(2)+"%",$(parentDiv).find("#hikePercentage").val(hikePerStr),$(parentDiv).find("#hikePercentage").attr("tdVal",hikePer);var totalAmountAfterHike=Number(totalAmount)+Number(hikeAmt);$(parentDiv).find("#totalAmountAfterHike").text(PMSV2Cycle.adjustAmount(totalAmountAfterHike)),$(parentDiv).find("#hikeAmountView").text(PMSV2Cycle.adjustAmount(hikeAmt))}},adjustAmount:function(amount){if(void 0===amount||"NaN"==amount)return 0;var adjAmt=(amount=parseFloat(amount).toFixed(0)).toString();-1!==adjAmt.indexOf("-")?adjAmt="-"+adjAmt.substring(1,adjAmt.length):adjAmt=amount;return adjAmt},checkExpYear:function(obj,toCheck){var ruleNo=$(obj).attr("id").split("_")[1],container=settingsPage.container.find("#expRuleObj #expTBody"),currRule=container.find("#rules_"+ruleNo),currOptObj=container.find("#expOpt_"+ruleNo),currFromObj=container.find("#expFrom_"+ruleNo),currToObj=container.find("#expTo_"+ruleNo),curOpt=currOptObj.val();if(-1==curOpt)return currRule.find(".ztextbox--error__label").remove(),currRule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.selectcriteria")+"</span>"),!1;var curFrom=container.find("#expFrom_"+ruleNo).val();if(""===curFrom||void 0==curFrom)return currRule.find(".ztextbox--error__label").remove(),currRule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;curFrom=Number(curFrom.replace(/[^0-9]+/g,"")),currFromObj.val(curFrom);var curTo=container.find("#expTo_"+ruleNo).val();if(5==curOpt){if(void 0!=toCheck&&toCheck){if(""===curTo||void 0==curTo)return currRule.find(".ztextbox--error__label").remove(),currRule.closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.validyearerror")+"</span>"),!1;if(Number(curTo)<=Number(curFrom))return currRule.find(".ztextbox--error__label").remove(),currRule.closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.validfromtoyearerror")+"</span>"),!1}if(""!=curTo&&void 0!=curTo)curTo=Number(curTo.replace(/[^0-9]+/g,"")),currToObj.val(curTo);else if(void 0==toCheck&&(""==curTo||void 0==curTo))return!0}for(var length=container.find("tr").length,i=1;i<length;i++)if(ruleNo!=i){var opr=ZPeopleComponents.select(container.find("#expOpt_"+i)).getValue(),from=container.find("#expFrom_"+i).val(),to=container.find("#expTo_"+i).val();if(""==from||void 0==from)return container.find("#rules_"+i)(".ztextbox--error__label").remove(),container.find("#rules_"+i).find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.validfromtoyearerror")+"</span>"),!1;if(from=Number(from),5!=opr)""!=to&&void 0!=to||(to=from);else if(""==to||void 0==to)return currRule.find(".ztextbox--error__label").remove(),currRule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.validfromtoyearerror")+"</span>"),!1;if(to=Number(to),0==opr){if(curFrom==from&&(0==curOpt||3==curOpt||4==curOpt)||(1==curOpt||3==curOpt)&&from<curFrom||(2==curOpt||4==curOpt)&&from>curFrom||5==curOpt&&from>curFrom&&from<curTo)return currRule.find(".ztextbox--error__label").remove(),currRule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.pa.experienceerrormessage")+"</span>"),!1}else if(1==opr){if(curFrom<from||(1==curOpt||3==curOpt)&&from<=curFrom||5==curOpt&&curTo<from)return currRule.find(".ztextbox--error__label").remove(),currRule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.pa.experienceerrormessage")+"</span>"),!1}else if(2==opr){if(curFrom>from||(2==curOpt||4==curOpt)&&from>=curFrom||5==curOpt&&curTo>from)return currRule.find(".ztextbox--error__label").remove(),currRule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.pa.experienceerrormessage")+"</span>"),!1}else if(3==opr){if(curFrom<from||5!=curOpt&&2!=curOpt&&from==curFrom||(1==curOpt||3==curOpt)&&from<curFrom||5==curOpt&&curTo<from)return currRule.find(".ztextbox--error__label").remove(),currRule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.pa.experienceerrormessage")+"</span>"),!1}else if(4==opr){if(curFrom>from||5!=curOpt&&1!=curOpt&&from==curFrom||(2==curOpt||4==curOpt)&&from>curFrom||5==curOpt&&curTo>from)return currRule.find(".ztextbox--error__label").remove(),currRule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.pa.experienceerrormessage")+"</span>"),!1}else if(5==opr&&(curFrom>from&&curFrom<to||curTo>from&&curTo<to||(1==curOpt||3==curOpt)&&(curFrom>to||curFrom>from)||(2==curOpt||4==curOpt)&&(curFrom<to||curFrom<from)||5==curOpt&&curTo>from&&curFrom<to))return currRule.find(".ztextbox--error__label").remove(),currRule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.pa.experienceerrormessage")+"</span>"),!1}container.find(".ztextbox--error__label").remove();var hikePer=container.find("#ruleHike_"+ruleNo).val();return void 0!=hikePer&&""!=hikePer&&(void 0!=toCheck&&toCheck||void 0==toCheck)&&PMSV2Cycle.calculateExpHike(obj),!0},calculateExpHike:function(obj,hikeCalc){var pageId=settingsPage.container,ruleNo=$(obj).attr("id").split("_")[1],curTo="",container=pageId.find("#expRuleObj #expTBody"),hikePer=Number(container.find("#ruleHike_"+ruleNo).val()),parent=container.find("#rules_"+ruleNo),curOpt=container.find("#expOpt_"+ruleNo).val(),curFrom=Number(container.find("#expFrom_"+ruleNo).val()),hikeRuleExp={type:curOpt,from:curFrom,hikePer:hikePer},keyValue=curOpt+"_"+curFrom;5==curOpt&&(curTo=Number(container.find("#expTo_"+ruleNo).val()),hikeRuleExp.to=curTo,keyValue+="_"+curTo);$("#budConfId").val();var experienceKeyValue="totExp";PMSV2Cycle.CUR_HIKE_RULE==PMSCommon.HIKE_DATE_OF_JOIN&&(experienceKeyValue="curExp");let formDataT=new FormData;formDataT.append("hikeRuleExp",JSON.stringify(hikeRuleExp)),formDataT.append("experienceType",experienceKeyValue),formDataT.append("conreqcsr",csrfToken);var totalAmount=0;if(parseFloat(hikePer)>0){void 0==PMSTmpl.HIKE_EXP_STORE[keyValue]?(PMSV2Cycle.getApplicableCriObj(formDataT),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp?mode=cycleCalculateHikeForExp",data:formDataT,processData:!1,contentType:!1,success:function(resultData){void 0!=resultData.totalAmount&&(totalAmount=resultData.totalAmount,PMSTmpl.HIKE_EXP_STORE[keyValue+""]=resultData)}})):totalAmount=PMSTmpl.HIKE_EXP_STORE[keyValue].totalAmount;var totalHikeAmount=parseFloat(totalAmount)*parseFloat(hikePer)/100;if(container.find("#ruleHikeAmt_"+ruleNo).val(totalHikeAmount.toFixed(0)),parent.find(".ztextbox--error__label").remove(),PMSTmpl.HIKE_EXP_STORE.hasOwnProperty(keyValue)&&PMSTmpl.HIKE_EXP_STORE[keyValue].totalEmployees<=0)return parent.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.hikerulenoemployeeerror")+"</span>"),!1}else container.find("#ruleHikeAmt_"+ruleNo).val(0);return void 0==hikeCalc&&PMSV2Cycle.calculateTotalExpHike(),!0},calculateTotalExpHike:function(){for(var pageId=settingsPage.container,container=pageId.find("#expRuleObj #expTBody"),length=$(container).children().length,expHAmt=0,ruleHike=0,totalAmt=PMSTmpl.TOTAL_SALARY,i=1;i<=length;i++){var condType=ZPeopleComponents.select(container.find("#expOpt_"+i)).getValue(),expFrom=container.find("#expFrom_"+i).val(),expTo=container.find("#expTo_"+i).val(),hikePer=container.find("#ruleHike_"+i).val(),expKeyValue=condType+"_"+expFrom;if(void 0!=hikePer&&""!=hikePer&&void 0!=condType&&""!=condType&&void 0!=expFrom&&""!=expFrom){5==condType&&(expKeyValue+="_"+expTo);var salary=0;PMSTmpl.HIKE_EXP_STORE.hasOwnProperty(expKeyValue)&&(salary=PMSTmpl.HIKE_EXP_STORE[expKeyValue].totalAmount),totalAmt=Number(totalAmt)-Number(salary),ruleHike+=salary*(hikePer/100)}}expHAmt=Number(expHAmt).toFixed(0),ruleHike=Number(ruleHike).toFixed(0);var defPer=pageId.find("#hikePercentage").attr("tdVal");void 0!=defPer&&""!=defPer?(totalAmt=Number(totalAmt)*(defPer/100),totalAmt=Number(totalAmt).toFixed(0),totalAmt=Number(totalAmt)+Number(ruleHike)):totalAmt=Number(ruleHike),totalAmt=Number(totalAmt).toFixed(0),pageId.find("#hikeAmountView").text(totalAmt),pageId.find("#totalAmountAfterHike").text(Number(PMSTmpl.TOTAL_SALARY)+Number(totalAmt))},hasAnyChangeInRule:function(){var pageId=settingsPage.container;if(PMSV2Cycle.isChanged)return!0;var val1=Number(pageId.find("#hikePercentage").val().replace(/[^0-9\.]+/g,""));return""!=val1&&"0"!=val1},checkExpHike:function(obj){var pageId=settingsPage.container,ruleNo=$(obj).attr("id").split("_")[1],container=pageId.find("#expRuleObj #expTBody"),currRule=container.find("#ruleHike_"+ruleNo),hikePer=currRule.val();if(void 0==hikePer||""==hikePer)return currRule.find(".ztextbox--error__label").remove(),void currRule.find("select").parent().append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.pa.experienceerrormessage")+"</span>");hikePer=Number(hikePer.replace(/[^0-9\.]+/g,"")),container.find("#ruleHike_"+ruleNo).val(hikePer),PMSV2Cycle.checkExpYear(obj,!0)&&PMSV2Cycle.calculateExpHike(obj)},calculateHike:function(obj){var pageId=settingsPage.container,ruleNo=$(obj).attr("id").split("_")[1],container=pageId.find("#desRuleObj #desTBody"),hike=container.find("#ruleHike_"+ruleNo).val(),desList=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(pageId.find("#budgetDes_"+ruleNo)).getAllValues());if(void 0!=desList&&0!=desList.length&&void 0!=hike&&""!=hike){var ruleHike=0,totalAmt=PMSTmpl.TOTAL_SALARY;$.each(PMSTmpl.DESIGNATION_SALARY,function(key,value){-1!=desList.indexOf(key)&&(totalAmt=Number(totalAmt)-Number(value),ruleHike+=Number(value)*(hike/100))}),ruleHike=Number(ruleHike).toFixed(0),container.find("#ruleHikeAmt_"+ruleNo).val(ruleHike),container.find("#ruleHikeAmt_"+ruleNo).prop("disabled",!0);var desHAmt=0;pageId.find("#hkFldType").val()==PMSCommon.HIKE_DESIGNATION&&container.find("tr").length,container.children().each(function(){let trID=$(this).attr("id").split("_");var currRule=$(this);let i=parseInt(trID[1]);if(ruleNo!=i){var checkDesList=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield($(currRule).find("#budgetDes_"+i)).getAllValues()),hikePer=$(currRule).find("#ruleHike_"+i).val();if(void 0!=hikePer&&""!=hikePer&&void 0!=desList&&0!=desList.length){for(var desLen=checkDesList.length,j=0;j<desLen;j++){if(-1!=desList.indexOf(checkDesList[j]))return $(currRule).find(".ztextbox--error__label").remove(),void $(currRule).find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.pa.experienceerrormessage")+"</span>");desList.push(checkDesList[j]),totalAmt=Number(totalAmt)-Number(PMSTmpl.DESIGNATION_SALARY[checkDesList[j]])}desHAmt+=Number($(currRule).find("#ruleHikeAmt_"+i).val())}}}),container.find(".ztextbox--error__label").remove(),desHAmt=Number(desHAmt).toFixed(0);var defPer=pageId.find("#hikePercentage").attr("tdVal");void 0!=defPer&&""!=defPer?(totalAmt=Number(totalAmt)*(defPer/100),totalAmt=Number(totalAmt).toFixed(0),totalAmt=Number(totalAmt)+Number(desHAmt)+Number(ruleHike)):totalAmt=Number(desHAmt)+Number(ruleHike),totalAmt=Number(totalAmt).toFixed(0),pageId.find("#hikeAmountView").text(totalAmt),pageId.find("#totalAmountAfterHike").text(Number(PMSTmpl.TOTAL_SALARY)+Number(totalAmt))}},addRule:function(obj){var container=settingsPage.container,mode=container.find("#hkFldType").val(),length=0,oldNo=0;if(mode==PMSCommon.HIKE_DESIGNATION){length=container.find("#desRuleObj #desTBody").children().length;let lastTR=container.find("#desRuleObj #desTBody").children()[length-1];oldNo=$(lastTR).attr("id").split("_")[1]}else{length=container.find("#expRuleObj #expTBody").children().length;let lastTR=container.find("#expRuleObj #expTBody").children()[length-1];oldNo=$(lastTR).attr("id").split("_")[1]}let newNo=parseInt(oldNo)+1;if(mode==PMSCommon.HIKE_DESIGNATION){var hike=container.find("#desRuleObj #desTBody #ruleHike_"+oldNo).val(),prevDesList=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(container.find("#budgetDes_"+oldNo)).getAllValues()),rule=container.find("#desRuleObj #desTBody #rules_"+oldNo);if(void 0==prevDesList||0==prevDesList.length)return rule.find(".ztextbox--error__label").remove(),void rule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.chooseskillset",new Array(ZPI18N.getString("zp.designation")))+"</span>");if(void 0==hike||""==hike)return rule.find(".ztextbox--error__label").remove(),void rule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.validproposedhikepercentage")+"</span>");var desList=[];if($("#desRuleObj #desTBody textarea").each(function(){var des=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield($(this)).getAllValues());for(j=0;j<des.length;j++)desList.push(des[j])}),Object.keys(PMSTmpl.DESIGNATION_SALARY).length==desList.length)return void ZPeople.Message.failure(ZPI18N.getString("zp.designationalreadyadded"));var ruleHtiml='<tr id="rules_'+newNo+'"><td><div class="zpl_idiv w100"><textarea id="budgetDes_'+newNo+'" style="display: none;"></textarea></div></td><td><input type="text" value="" id="ruleHike_'+newNo+'" class="ztextbox" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'hike\');" onchange="PMSV2Cycle.calculateHike(this)"></td><td><input type="text" id="ruleHikeAmt_'+newNo+'" class="ztextbox" value="" disabled></td><td width="10%"> <div class="text-center"> <div class="zpl_hvr"> <i id="ruleDel_'+newNo+'" class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSV2Cycle.removeRule(this)"></i> </div> </div> </td></tr>';container.find("#desRuleObj #desTBody").find($("#rules_"+oldNo).after(ruleHtiml));var _tokenObj={},_options=[];$.each(PMSTmpl.DESIGNATION_LIST,function(index,value){if(-1==desList.indexOf(value.recID)&&PMSTmpl.DESIGNATION_SALARY.hasOwnProperty(value.recID)){var _singleObj={};_singleObj.name=ZPeople.decodeTxt(value.recName),_singleObj.id=value.recID,_options.push(_singleObj)}}),_tokenObj.data=_options,_tokenObj.contentType="text",_tokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_tokenObj.search={by:"name"},_tokenObj.allowDuplicateValues=!1,_tokenObj.tokenadd=PMSV2Cycle.onhiketokenadd,_tokenObj.tokenremove=PMSV2Cycle.onhiketokenadd,ZPeopleComponents.tokenfield(container.find("#budgetDes_"+newNo),_tokenObj)}else{rule=container.find("#expRuleObj #expTBody #rules_"+oldNo);if(void 0==(hike=container.find("#expRuleObj #expTBody #ruleHike_"+oldNo).val())||""==hike)return rule.find(".ztextbox--error__label").remove(),void rule.find("select").closest("td").append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.validproposedhikepercentage")+"</span>");if(0==container.find("#expRuleObj").find(".ztextbox--error__label").length){ruleHtiml='<tr id="rules_'+newNo+'"><td><div class="zpl_idiv w200"><select id="expOpt_'+newNo+'" style="display: none;"></select></div></td>';ruleHtiml+='<td><input type="text" id="expFrom_'+newNo+'" class="ztextbox" placeholder="'+ZPI18N.getString("zp.years")+'" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'year\');" onchange="PMSV2Cycle.checkExpYear(this)" value=""></td>',ruleHtiml+='<td class="DN" yearelem="hide"><input type="text" id="expTo_'+newNo+'" placeholder="'+ZPI18N.getString("zp.years")+'" class="ztextbox" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'year\');" onchange="PMSV2Cycle.checkExpYear(this)"></td>',ruleHtiml+='<td><input type="text" id="ruleHike_'+newNo+'" class="ztextbox" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'hike\');" onchange="PMSV2Cycle.checkExpHike(this)"></td>',ruleHtiml+='<td><input type="text" id="ruleHikeAmt_'+newNo+'" class="ztextbox" value="" disabled></td>',ruleHtiml+='<td width="10%"> <div class="text-center"> <div class="zpl_hvr"> <i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" id="ruleDel_'+newNo+'" onclick="PMSV2Cycle.removeRule(this)"></i> </div> </div> </td>',ruleHtiml+="</tr>",container.find("#expRuleObj #expTBody").find("#rules_"+oldNo).after(ruleHtiml)}(_tokenObj={}).options=PMSV2Cycle.getTotalExpOption(),_tokenObj.contentType="text",_tokenObj.dataMapping={label:"name",value:"id",informativeText:"name"},ZPeopleComponents.select(container.find("#expOpt_"+newNo),_tokenObj),$(container.find("#expOpt_"+newNo)).on("zselectchange",PMSV2Cycle.changeHikeExpObj)}},getSelectedDesignations:function(){var container=settingsPage.container,selectedList=[];container.find("#desRuleObj #desTBody").find("tr");return container.find("#desRuleObj #desTBody").find("tr").each(function(index){var textAreaId=$(this).find("textarea").attr("id"),desList=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(container.find("#"+textAreaId)).getAllValues());for(var i in desList)-1==selectedList.indexOf(desList[i])&&selectedList.push(desList[i])}),selectedList},reinitiatetokenfield:function(){var container=settingsPage.container,selectedList=PMSV2Cycle.getSelectedDesignations();container.find("#desRuleObj #desTBody").find("tr");container.find("#desRuleObj #desTBody").find("tr").each(function(index){var textAreaId=$(this).find("textarea").attr("id"),prevValues=ZPeopleComponents.tokenfield(container.find("#"+textAreaId)).getAllValues();$(container.find("#"+textAreaId)).unbind(),ZPeopleComponents.tokenfield(container.find("#"+textAreaId)).destroy();var _tokenObj={},_options=[];$.each(PMSTmpl.DESIGNATION_LIST,function(index,value){if(-1==selectedList.indexOf(value.recID)&&PMSTmpl.DESIGNATION_SALARY.hasOwnProperty(value.recID)){var _singleObj={};_singleObj.name=ZPeople.decodeTxt(value.recName),_singleObj.id=value.recID,_options.push(_singleObj)}}),_tokenObj.data=_options,_tokenObj.contentType="text",_tokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},_tokenObj.search={by:"name"},_tokenObj.allowDuplicateValues=!1,_tokenObj.tokenadd=PMSV2Cycle.onhiketokenadd,_tokenObj.tokenremove=PMSV2Cycle.onhiketokenadd,_tokenObj.values=prevValues,ZPeopleComponents.tokenfield(container.find("#"+textAreaId),_tokenObj)})},removeRule:function(obj){var container=settingsPage.container,ruleNo=$(obj).attr("id").split("_")[1];if(1!=ruleNo)if(container.find("#hkFldType").val()==PMSCommon.HIKE_DESIGNATION){var desList=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(container.find("#budgetDes_"+ruleNo)).getAllValues()),hikePer=container.find("#desRuleObj #desTBody #ruleHike_"+ruleNo).val();if(void 0!=hikePer&&""!=hikePer&&void 0!=desList&&0!=desList.length){for(var length=container.find("#desRuleObj #desTBody").find("tr").length,mappedDes=[],totalAmt=0,desLen=desList.length,totalSalary=PMSTmpl.TOTAL_SALARY,j=0;j<desLen;j++)mappedDes.push(desList[j]),totalAmt+=Number(PMSTmpl.DESIGNATION_SALARY[desList[j]]);var desHikeAmt=Number(totalAmt)*(hikePer/100);desHikeAmt=Number(desHikeAmt).toFixed(0);var desamt=container.find("#hikeAmountView").text();desamt=Number(desamt)-Number(desHikeAmt);var defPer=container.find("#hikePercentage").attr("tdVal");totalAmt=Number(totalAmt)*(defPer/100),totalAmt=Number(totalAmt).toFixed(0);var hikeamt=Number(desamt)+Number(totalAmt);totalSalary=Number(totalSalary)+Number(hikeamt),container.find("#hikeAmountView").text(hikeamt),container.find("#totalAmountAfterHike").text(totalSalary)}ZPeopleComponents.tokenfield(container.find(obj).closest("tr").find("textarea")).destroy(),container.find(obj).closest("tr").remove()}else{ZPeopleComponents.select(container.find(obj).closest("tr").find("select")).destroy(),container.find(obj).closest("tr").remove();length=container.find("#expRuleObj #expTBody").find("tr").length;for(var i=1;i<=length;i++)PMSV2Cycle.checkExpYear(container.find("#expRuleObj #expTBody #rules_"+i),!1),PMSV2Cycle.calculateExpHike(container.find("#expRuleObj #expTBody #rules_"+i),!0);PMSV2Cycle.calculateTotalExpHike()}},onPublishMethodAction:function(eData){var pageId=settingsPage.container;if(0===parseInt(pageId.find("[name=pubMtd]:checked").val())){ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker").destroy(),pageId.find("#cyPubMthTD").html('<div class="ztextbox--group zh-alignright"><i id="cyMnlPubPeriodID_Icon" class="ztextbox__icon PI_monthly"></i><input id="cyMnlPubPeriodID" class="ztextbox"></div>'),ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyMnlPubPeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker8=pageId.find("#cyMnlPubPrdPicker");pageId.find("#cyMnlPubPeriodID, #cyMnlPubPeriodID_Icon").on("click",function(){pageId.find("#cyMnlPubPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker8).close():ZPeopleComponents.daterangepicker(picker8).open()}),void 0!==PMSV2Cycle.SELECTED_TMPL&&null!==PMSV2Cycle.SELECTED_TMPL&&void 0!==PMSV2Cycle.SELECTED_TMPL.schedule&&null!==PMSV2Cycle.SELECTED_TMPL.schedule&&$.each(PMSV2Cycle.SELECTED_TMPL.schedule,function(index,data2){"REVIEW_PUBLISH"===data2.scheduleName&&"0"==PMSV2Cycle.SELECTED_TMPL.publishOption&&(ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker").setFromValue(data2.startdate),ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker").setToValue(data2.duedate))})}else{ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker").clearSelection(),ZPeopleComponents.daterangepicker("#cyMnlPubPrdPicker").destroy(),pageId.find("#cyPubMthTD").html('<div class="ztextbox--group zh-alignright"><input id="cyMnlPubWthTimeID" class="ztextbox" data-picker="true" data-clear-button="none" data-spin-buttons="none"></div>');let timeFormat=Calendar.is12HrFormat()?"hh:mm tt":"HH:mm",dTimeObj={format:dateFmt+" "+timeFormat,clearButton:"focus",calendarIcon:!0,calendarIconClassName:"ztextbox__icon PI_monthly"};ZPeopleComponents.datetimefield("#cyMnlPubWthTimeID",dTimeObj)}},changeOnUpload:function(id){var localFileInpBx=$('<div><input type="file"></div>');localFileInpBx.find("input").trigger("click"),localFileInpBx.find("input").off("change").on("change",function(event){var file=$(this)[0].files[0],mode="";"selfappFormid"==id?(PMSV2Cycle.SELF_FILE=file,mode="cycleself"):(PMSV2Cycle.GUIDE_FILE=file,mode="cycleguide");var fileName=ZPeople.escapeHtml(file.name),fileSize=file.size;if(fileName=fileName.replace("C:\\fakepath\\",""),fileSize>1e6*maxFileSize.split("MB")[0])ZPeopleComponents.AlertBanner.show({message:ZPI18N.getString("zp.filesizelimit",[maxFileSize]),type:"error",closeButton:!0,hideDelay:2e3});else{var fileExtn=fileName.substring(fileName.lastIndexOf(".")+1,fileName.length),attachFileHtml=PMSV2Cycle.getAttachFileHtml(fileName,fileExtn,mode);$("#"+id+"_beforeUpload").css("display","none"),$("#"+id+"_afterUpload").parent().css("display","block"),$("#"+id+"_afterUpload").append(attachFileHtml),$("#"+id+"_afterUpload").find("#currentFile").find(".zpl_prgbr").removeClass("DN"),progressJs("div[data-progressjs='fileUpload_Progress']").autoIncrease(8,10);var progressDiv=$("#"+id+"_afterUpload").find("div[data-progressjs='fileUpload_Progress']");progressJs("div[data-progressjs='fileUpload_Progress']").end(),progressDiv[0].style.width="100%"}})},getAttachFileHtml:function(fileName,fileType,mode){return'<div class="zpl_atchd"><div id="currentFile"><div class="zpl_atchimg"><i class="'+FilesCommon.getFileIcon(fileType)+'"></i></div><div class="zpl_atchdtl"><h4 id="attachedFileName">'+fileName+'</h4></div><div class="zpl_atchicn"><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSV2Cycle.removeFile(\''+mode+'\')"></i></div><div class="zpl_prgbr DN"><div><div data-progressjs="fileUpload_Progress" style="width:0%"></div></div></div></div></div>'},toggleFileFieldDisplay:function(id){var pageId=settingsPage.container,name="selfappForm";"selfappFileId"==id&&(name="selfapprfileList"),pageId.find("#"+id).find("#beforeUpload,#afterUpload").toggleClass("DN"),pageId.find("#"+id).find(".ZPFfile").html(""),pageId.find("#"+id).find(".ZPFfile").html('<input type="file" class="form-control" onchange="PMSOperation.changeOnUpload($(this).val(),\'localUpload\',\''+id+"',this)\" id='"+name+"'>"),"selfappFileId"==id?PMSV2Cycle.SEFLAPPRAISALFILEREMOVED=!0:PMSV2Cycle.GUIDELINEDOCREMOVED=!0},saveCycleConfig:function(){PMSV2Cycle.removeError(),PMSV2Cycle.getFormApprovalDetails(),PMSV2Cycle.DATEERROR=!1;var pageId=settingsPage.container;let isValid=!0;PMSV2Cycle.TAB_SCROLL=!1;let tabScrollFlg=!1;var formData=new FormData;let isBDValid=PMSV2Cycle.basicDetValidation();if(""!==pageId.find("#cyclePeriodID").val()){var dateVal=pageId.find("#cyclePeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cyclePeriodID","cyclefromDate","cycletoDate",formData,!1)}else PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.emptycycleperiod"),pageId.find("#cyclePeriodID"),2);if(!isBDValid||PMSV2Cycle.DATEERROR){let bdLi=pageId.find("[show=nwCylbasicDetDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}let cycleName=pageId.find("#cycleName").val().trim();formData.append("periodname",cycleName);let cycleDesc=pageId.find("#cycleDesc").val().trim();if(formData.append("description",cycleDesc),isSanmarUI&&(pageId.find("#cycleType").is(":checked")?formData.append("cycleType",2):formData.append("cycleType",1)),PMSV2Cycle.DATEERROR=!1,formData=PMSV2Cycle.dateValidationandSetParam(formData),PMSV2Cycle.DATEERROR&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylPeriodDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}if(PMSV2Cycle.DATEERROR=!1,formData=PMSV2Cycle.getApplicableCriObj(formData),PMSV2Cycle.DATEERROR&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylAppliDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}let isSelfEnable=PMSV2Cycle.IS_SELF_ENABLED;if(formData.append("selfAppraisalStatus",isSelfEnable),formData.append("selfappstatuschanged",isSelfEnable),formData.append("selfappstatus",isSelfEnable),isSelfEnable){let saMoVl=PMSV2Cycle.getModSelObj("saQtPmTBody","saQlPmTBody");saMoVl.length>0&&(formData.append("selfappJSON",JSON.stringify({moduleval:saMoVl})),formData.append("selfappJSONRatingComment",JSON.stringify(PMSV2Cycle.getModSelRtgCmtObj("saQtPmTBody","saQlPmTBody",saMoVl))))}let isMREnable=PMSV2Cycle.IS_MR_ENABLED;if(isMREnable){if(!PMSV2Cycle.mrValidation()&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylmrDetDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}formData.append("multiRaterJSON",JSON.stringify(PMSV2Cycle.getMRModSelObj(formData)))}else{var mrObj={isEnabled:!1};formData.append("multiRaterJSON",JSON.stringify(mrObj))}let paMoVl=PMSV2Cycle.getModSelObj("paQtPmTBody","paQlPmTBody");if(paMoVl.length>0&&(formData.append("reviewerJSON",JSON.stringify({moduleval:paMoVl})),formData.append("reviewerJSONRatingComment",JSON.stringify(PMSV2Cycle.getModSelRtgCmtObj("paQtPmTBody","paQlPmTBody",paMoVl)))),pageId.find("#reviewApprovalEnable").is(":checked")){if(formData.append("reviewApprovalEnable",!0),""==PMSV2Cycle.review_ApprConf||!PMSV2Cycle.review_ApprConf){let bdLi=pageId.find("[show=nwCylpaDetDiv]");PMSV2Cycle.tabSwitchAction(bdLi),isValid=!1,tabScrollFlg=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.configureapprovalforform",new Array(ZPI18N.getString("zp.review"))),pageId.find("#reviewApprConf div"),1)}}else formData.append("reviewApprovalEnable",!1);if(!PMSV2Cycle.rtgValidation()&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylratingDetDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}if(!!PMSV2Cycle.IS_MOD_WGT_ENABLED&&ZPeopleComponents.toggleswitch("#setModWgtID").getState()){let tObj={},trChd=pageId.find("#modWgtTBody").children();$.each(trChd,function(key,val){let inp=$(this).find("input"),cNm=$(inp).attr("compNme"),value=$(inp).val().trim();"KRA"===cNm?!isNaN(value)&&value.length>0&&(tObj.kra=parseInt(value)):"GOALS"===cNm?!isNaN(value)&&value.length>0&&(tObj.goal=parseInt(value)):"KRA_GOALS"===cNm?!isNaN(value)&&value.length>0&&(tObj.kragoal=parseInt(value)):"COMPETENCY"===cNm&&!isNaN(value)&&value.length>0&&(tObj.competency=parseInt(value))}),formData.append("moduleweightageJson",JSON.stringify(tObj))}let cnt=PMSV2Cycle.getCmtMdtyCnt();if(PMSV2Cycle.getModWgtRtgCnt().rtgCnt>0||PMSV2Cycle.isCRBasedCycle()){var ratingType={};let ratingDigits=parseInt(pageId.find("#ratingNoOfDigits").val()),chosenRtgType=pageId.find("#ratingType").val();if("starRating"===chosenRtgType&&(ratingType.type=0),"numberRating"===chosenRtgType&&(ratingType.type=1,ratingType.max=pageId.find("#mxVl").val()),"textRating"===chosenRtgType&&(ratingType.type=2,ratingType.max=PMSV2Cycle.textrating_name.length,ratingType.textRatingName=PMSV2Cycle.textrating_name,ratingType.textRatingValue=PMSV2Cycle.textrating_value),"customRating"===chosenRtgType)if(ratingType.type=3,ratingType.min=pageId.find("#mnVl").val(),PMSV2Cycle.isCRBasedCycle())if("range"===pageId.find("#rtgDetDiv ul").attr("rttype")){let origCnt=PMSV2Cycle.rating_keyarray.length;ratingType.max=parseInt(PMSV2Cycle.rating_maxRangeArray[origCnt-1])}else ratingType.max=PMSV2Cycle.rating_keyarray.length;else ratingType.max=pageId.find("#mxVl").val();ratingType.isNotApplicable=pageId.find("#notApplicable").is(":checked"),ratingType.isRoundOfRT=!1,ratingType.isIncNoDataMod=pageId.find("#isIncNoDataMod").is(":checked"),ratingType.noOfDigits=ratingDigits;let roundOff=pageId.find("#rtRndOffID").is(":checked");if((0===ratingType.noOfDigits||roundOff)&&(ratingType.isRoundOfRT=!0),cnt>0)""!==(minCmtLen=pageId.find("#cmtLenInp").val())&&(ratingType.minCommentLength=Number(minCmtLen));formData.append("ratingTypeJSON",JSON.stringify(ratingType));var averagehidearray=[];isSelfEnable&&pageId.find("#selfaveragehide").is(":checked")&&averagehidearray.push("SELF"),pageId.find("#reviewaveragehide").is(":checked")&&averagehidearray.push("REVIEW"),isMREnable&&pageId.find("#mraveragehide").is(":checked")&&averagehidearray.push("MR"),formData.append("hideAverageJSON",JSON.stringify(averagehidearray))}else{var minCmtLen;if((ratingType={}).type=0,ratingType.isNotApplicable=!0,ratingType.isRoundOfRT=!1,ratingType.isIncNoDataMod=!1,ratingType.noOfDigits=1,cnt>0)""!==(minCmtLen=pageId.find("#cmtLenInp").val())&&(ratingType.minCommentLength=Number(minCmtLen));formData.append("ratingTypeJSON",JSON.stringify(ratingType))}let isNormEnb=PMSV2Cycle.IS_NORM_ENABLED;var totalRating=PMSV2Cycle.rating_keyarray.length,rtgArr=[];if(totalRating>=1){let rtgType=pageId.find("#rtgDetDiv ul").attr("rttype");if(pageId.find("#rtgDetDiv ul").find("li[id^=li_]").each(function(){var param1={},series=parseInt($(this).attr("series")),getratingName=$(this).find(".zpl_cyclrgsr span").text();if(""!==getratingName){var getratingId=$(this).attr("rating_id");if(void 0!==getratingId&&getratingId.length>0&&(param1.ratingId=getratingId),param1.ratingName=getratingName,"range"===rtgType&&(void 0!=$(this).find("#rtMinSpn_"+series+" input").val()&&""!=$(this).find("#rtMinSpn_"+series+" input").val()&&(param1.ratingMinrange=$(this).find("#rtMinSpn_"+series+" input").val()),param1.ratingMaxRange=$(this).find("#rtMaxSpn_"+series+" input").val()),param1.ratingStar=totalRating,isNormEnb){var ratingPer=pageId.find("#normRtgDetDiv ul li").find("#nmRtMinInp_"+series).val();void 0!=ratingPer&&""!=ratingPer&&(param1.normalizPer=ratingPer,parseFloat(ratingPer))}totalRating--,rtgArr.push(param1)}}),formData.append("ratingDetails",JSON.stringify(rtgArr)),"range"===rtgType){let saModRtgCnt=PMSV2Cycle.getRtgCntWithOutMR("saQtPmTBody"),paModRtgCnt=PMSV2Cycle.getRtgCntWithOutMR("paQtPmTBody");var isChecked=!PMSV2Cycle.isCRBasedCycle()&&pageId.find("#isRatingLocked").is(":checked"),PALock=!1,SALock=!1;paModRtgCnt>0&&(PALock=!!isChecked),saModRtgCnt>0&&(SALock=!!isChecked),formData.append("paRatingLock",PALock),formData.append("saRatingLock",SALock)}else formData.append("paRatingLock",!1),formData.append("saRatingLock",!1)}let isNormEnable=PMSV2Cycle.IS_NORM_ENABLED;if(formData.append("normalizEnable",isNormEnable),isNormEnable){if(!PMSV2Cycle.normalizationValidation()&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylnrmDetDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}}let isBudgetEnable=PMSV2Cycle.IS_SAL_HK_ENABLED;if(isBudgetEnable){if(!PMSV2Cycle.hikeValidation()&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylhkDetDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}formData.append("budgetEnableInp",isBudgetEnable);var hikeDeciderID=pageId.find("#hkApprSel").val();formData.append("hikeDeciderInp",hikeDeciderID);let afterHikeApproval=pageId.find("#hkApproval").is(":checked");formData.append("afterHikeApprovalInp",afterHikeApproval);let promotionOnHike=pageId.find("#incProp").is(":checked");formData.append("promotionOnHikeInp",promotionOnHike);let hikePublishDt=ZPeopleComponents.datetimefield(pageId.find("#cyHkPushID")).getValue().dateString;if(void 0!==hikePublishDt){let hikePublishdateTime=Calendar.parseDate(Calendar.convertHourFormat(hikePublishDt),uidateFormat,!0),hikePublishdate=Calendar.parseDate(hikePublishDt,uidateFormat),fromDate=null,toDate=null,dateVal=pageId.find("#cyHkPeriodID").val();if(6===dateVal.split("-").length){let date=dateVal.split("-");fromDate=date[0]+"-"+date[1]+"-"+date[2],toDate=date[3]+"-"+date[4]+"-"+date[5]}else if(2===dateVal.split("-").length){let date=dateVal.split("-");fromDate=date[0],toDate=date[1]}let tdate="",fdate="";if(null!=fromDate&&(fdate=Calendar.parseDate(fromDate,uidateFormat)),null!=toDate&&(tdate=Calendar.parseDate(toDate,uidateFormat)),hikePublishdate<=tdate){PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.hikepublisherror",[PMSV2Cycle.HIKENAME]),pageId.find("#cyHkPushID-container"),2);let bdLi=pageId.find("[show=nwCylPeriodDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}else{if(hikePublishdateTime<new Date){let bdLi=pageId.find("[show=nwCylPeriodDiv]");PMSV2Cycle.tabSwitchAction(bdLi),PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.currentdatetimeerror",[PMSV2Cycle.HIKENAME]),pageId.find("#cyHkPushID-container"),2),tabScrollFlg=!0,flag=!0}}formData.append("hikePublishDate",hikePublishDt)}var budConfigObj=PMSV2Cycle.budgetConfigValidation();if(PMSV2Cycle.BUDGETCONFIGERROR&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylhkDetDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}else formData.append("budgetConfig",JSON.stringify(budConfigObj))}if(!PMSV2Cycle.publishValidation()&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylpubDetDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}if(!PMSV2Cycle.ESign.validateEsignConfiguration()&&!tabScrollFlg){let aLiDiv=pageId.find("[show=nwCylAppraisalLetterDiv]");PMSV2Cycle.tabSwitchAction(aLiDiv),tabScrollFlg=!0,isValid=!1}if(pageId.find("#enableAppraisalLetter").is(":checked")){formData.append("appraisalLetter",!0),formData.append("appraisalEsign",pageId.find("#apprLetSentEsign").is(":checked"));let configObj=PMSV2Cycle.ESign.getEsignConfigurationObj();delete configObj.isVaildSigner,formData.append("appraisalEsignConfig",JSON.stringify(configObj))}else formData.append("appraisalLetter",!1),formData.append("appraisalEsign",!1);let publishOption=parseInt(pageId.find("[name=pubMtd]:checked").val());if(formData.append("reviewPublishOption",publishOption),1===publishOption){let reviewPublishDate=ZPeopleComponents.datetimefield(pageId.find("#cyMnlPubWthTimeID")).getValue().dateString;void 0!==reviewPublishDate&&formData.append("reviewPublishDate",reviewPublishDate)}var fldPubData=ZPeopleComponents.tokenfield(pageId.find("#fldToPubID")).getAllValues(),actualSelVal=[];if(fldPubData.length>0)for(var i in fldPubData)actualSelVal.push(fldPubData[i].id);formData.append("publishfields",JSON.stringify(actualSelVal));var pubOwner=ZPeopleComponents.tokenfield(pageId.find("#pubAuthID")).getAllValues(),pubOwnerSelVal=[];if(pubOwner.length>0)for(var i in pubOwner)pubOwnerSelVal.push(pubOwner[i].id);var publisherObj={};if(null!=pubOwnerSelVal&&pubOwnerSelVal.length>0){var obj={},hasRT=!1,hasFinalizer=!1;for(i=0;i<pubOwnerSelVal.length;i++)2==pubOwnerSelVal[i]?hasRT=!0:3==pubOwnerSelVal[i]&&(hasFinalizer=!0);obj.reportingTo=hasRT,obj.finalizer=hasFinalizer,publisherObj.publishers=obj,formData.append("publisherJSON",JSON.stringify(publisherObj))}if(formData.append("sharefeedback",pageId.find("#empApprFdbkID").is(":checked")),null!==PMSV2Cycle.GUIDE_FILE&&formData.append("guidelines",PMSV2Cycle.GUIDE_FILE),null!==PMSV2Cycle.SELF_FILE&&formData.append("selfappForm",PMSV2Cycle.SELF_FILE),formData.append("selfappFormRemoved",PMSV2Cycle.SEFLAPPRAISALFILEREMOVED),formData.append("guidelinesFileRemoved",PMSV2Cycle.GUIDELINEDOCREMOVED),0==PMSV2Cycle.CLONE_CYCLE_FLAG&&0==PMSV2Cycle.EDIT_CYCLE_FLAG&&null!==PMSV2Cycle.SELECTED_TMPL&&void 0!==PMSV2Cycle.SELECTED_TMPL&&null!==PMSV2Cycle.SELECTED_TMPL&&Object.keys(PMSV2Cycle.SELECTED_TMPL).length>0?(null!=PMSV2Cycle.SELFAPPFORMFILEID?formData.append("selfappFormFileID",PMSV2Cycle.SELFAPPFORMFILEID):formData.append("selfappFormFileID",""),null!=PMSV2Cycle.GUIDELINESFILEID?formData.append("guidelinesFileID",PMSV2Cycle.GUIDELINESFILEID):formData.append("guidelinesFileID","")):(formData.append("selfappFormFileID",""),formData.append("guidelinesFileID","")),PMSV2Cycle.ISRATINGEDITOPEN&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylratingDetDiv]");PMSV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.saveratingbeforesubmit"),pageId.find("#rtgDetDiv"),1),isValid=!1}formData.append("conreqcsr",csrfToken);let apprObj=ZPA_Approvers.getApprovalConfigJson();if(formData.append("approvalConfigJSon",JSON.stringify(apprObj)),PMSV2Cycle.EDIT_CYCLE_FLAG)if(PMSV2Cycle.CLONE_CYCLE_FLAG){formData.append("modeval","add");let tmplVal=PMSV2Cycle.SELECTED_TMPL;formData.append("tmplID",tmplVal.configId)}else{let configID=pageId.find("#addCycleConfigDiv").attr("configid");formData.append("periodId",configID),formData.append("modeval","editConfig")}else{formData.append("modeval","add");let tmplVal=PMSV2Cycle.SELECTED_TMPL;null!=tmplVal&&formData.append("tmplID",tmplVal.configId)}if(PMSV2Cycle.IS_COURSE_ENABLE){var courseListing=pageId.find("#courseListView").is(":checked");formData.append("courseListing",courseListing?1:0),formData.append("isCourseSugg",courseListing&&pageId.find("#courseSuggestion").is(":checked")?1:0)}if(isValid){let cycleMode=PMSV2Cycle.isCRBasedCycle()?"addCRCycleConfig":"addCycleConfig";pageId.find("#cycleSaveBtn").attr("disabled","disabled"),$.ajax({url:"/performanceConfig.zp?mode="+cycleMode,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){pageId.find("#cycleSaveBtn").removeAttr("disabled"),"success"===data.msg?(PMSV2Cycle.SEFLAPPRAISALFILEREMOVED=!1,PMSV2Cycle.GUIDELINEDOCREMOVED=!1,ZPeople.Message.success(ZPI18N.getString("zp.cycleconfigsuccessmsg")),PMSV2Cycle.afterSave(data)):"PERIOD_NAME_EMPTY"===data.msg?(PMSV2Cycle.tabSwitchAction(pageId.find("[show=nwCylbasicDetDiv]")),PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.emptycycle"),pageId.find("#cycleName"))):"NAME_ALREADY_EXIST"===data.msg?(PMSV2Cycle.tabSwitchAction(pageId.find("[show=nwCylbasicDetDiv]")),PMSV2Cycle.showError(ZPI18N.getString("zp.duplicateSkill",[ZPI18N.getString("zp.salaryhikecyclename",[""])]),pageId.find("#cycleName"))):"Permission denied"===data.msg?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):"HIKE_DATE_EMPTY"===data.msg?PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.emptycycle"),pageId.find("#cyHkPeriodID")):"INVAILD_ESIGN_CONFIGURATION"==data.msg?(PMSV2Cycle.tabSwitchAction(pageId.find("[show=nwCylAppraisalLetterDiv]")),PMSV2Cycle.showError(ZPI18N.getString("zp.paesign.selectvaildmailmergedoc"),Layout.Page.container.find("#esignMailMergeselect"),1)):"INVAILD_ESIGN_SIGNER_CONFIGURATION"==data.msg?(PMSV2Cycle.tabSwitchAction(pageId.find("[show=nwCylAppraisalLetterDiv]")),PMSV2Cycle.showError(ZPI18N.getString("zp.paesign.selectvaildsigner"),Layout.Page.container.find("#apprEsignrecp_parent"))):"INVAILD_ESIGN_FIELD_CONFIGURATION"==data.msg?(PMSV2Cycle.tabSwitchAction(pageId.find("[show=nwCylAppraisalLetterDiv]")),PMSV2Cycle.showError(ZPI18N.getString("zp.paesign.signerfieldmissmatch"),Layout.Page.container.find("#esignMailMergeselect"),1)):"DATE_OF_CONFIRMATION"==data.msg?(PMSV2Cycle.tabSwitchAction(pageId.find("[show=nwCylAppliDiv]")),PMSV2Cycle.showError("Date Of Confirmation is not enabled",Layout.Page.container.find("#dojKey"),2)):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},error:function(err){pageId.find("#cycleSaveBtn").removeAttr("disabled"),ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))}})}else ZPeople.Message.failure(ZPI18N.getString("zp.cycle.errormsg.entermissingdetails"))},afterSave:function(data){if(PMSV2Cycle.destroyCyclePageComponents(),null!=data){PMSOperation.IS_ACTIVE_CYCLE_ONLY?PMSOperation.fetchConfigIDCycles(data.configId):(PMSOperation.IS_ACTIVE_CYCLE_ONLY=!0,PMSOperation.loadCycles(!0));let flg=!0;if(void 0!==data&&data.isBudgetEnable){let budgetData=data.budgetData;if("SUCCESS"===budgetData.status)if(-1===budgetData.configDetails.status)budgetData.salaryNotAvailable.length>0&&(PMSV2Cycle.showSalaryNotAvailableModal(budgetData),flg=!1)}}else{PMSV2Cycle.EDIT_CYCLE_FLAG=!1;let pageId=settingsPage.container;PMSOperationCommon.addClearCentreClass(!0),pageId.find("#cycleListingStatus_Filter li").unbind(),pageId.html(""),PMSOperation.getCycleTmplPage(),pageId.append(PMSOperation.CYCLE_LIST_TEMPLATE_PAGE);let cycleToggleFilter='<ul class="zpl_grpmnu" id="cycleListingStatus_Filter"><li id="activeCycle_toggle" status="1"><span>'+ZPI18N.getString("zp.activecycles")+'</span><div class="zpl_tg"><span id="activeCycleCount" count="0"><b></b></span></div></li><li id="completedCycle_toggle" status="2"><span>'+ZPI18N.getString("zp.completedcycles")+'</span><div class="zpl_tg"><span id="completedCycleCount" count="0"><b></b></span></div></li></ul>';pageId.find(".zpl_btnmnu .zpl_lft").html(cycleToggleFilter),PMSOperation.IS_ACTIVE_CYCLE_ONLY?pageId.find("#activeCycle_toggle").toggleClass("zpl_act"):pageId.find("#completedCycle_toggle").toggleClass("zpl_act"),pageId.find("#cycleListingStatus_Filter li").unbind(),pageId.find("#chooseTemplateDiv").hide(),pageId.find("#cycleListDiv").show(),settingsPage.container.find("#cycleTableBody").empty(),PMSOperation.initialSort=!1,PMSOperation.constructAppraisalConfList(PMSOperation.temp,pageId);new FireScrollBack(PMSOperation.cyfireScrollCallBack,settingsPage.container,"cyLstFS");PMSOperation.toggleCycleStatusFun()}},getSalaryDetails:function(configID){var params={mode:"getBudgetDetailsByConfigID",configID:configID};ZPeople.Request.send("/performanceConfig.zp",params,function(data){return"SUCCESS"!==data.status||(-1!==data.configDetails.status||(!(data.salaryNotAvailable.length>0)||(PMSV2Cycle.showSalaryNotAvailableModal(data),!1)))})},showSalaryNotAvailableModal:function(data){var popupTab=new Tab("SalaryNotMapped",function(){PMSV2Cycle.showSalNotAvlData(data)});PMSV2Cycle.SHOW_SAL_NOTAVAIL_MODAL=new sliderModal(ZPI18N.getString("zp.empsalarynotavailable"),popupTab),PMSV2Cycle.SHOW_SAL_NOTAVAIL_MODAL.setCloseCallback(function(){PMSV2Cycle.SHOW_SAL_NOTAVAIL_MODAL.remove(),PMSV2Cycle.FS_IDX=1}),PMSV2Cycle.SHOW_SAL_NOTAVAIL_MODAL.construct(),$(PMSV2Cycle.SHOW_SAL_NOTAVAIL_MODAL.sliderDiv).find(".zpl_mfoter").html("");var _footer='<button type="button" id="zp_modal_cancelbtn" onclick="PMSV2Cycle.closeSalNotAvlModal();" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.close")+"</button>";$(PMSV2Cycle.SHOW_SAL_NOTAVAIL_MODAL.sliderDiv).find(".zpl_mfoter").html(_footer)},closeSalNotAvlModal:function(){PMSV2Cycle.SHOW_SAL_NOTAVAIL_MODAL.close()},showSalNotAvlData:function(data){PMSV2Cycle.FS_IDX=1;var pageId=$(PMSV2Cycle.SHOW_SAL_NOTAVAIL_MODAL.sliderDiv),tableCont='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_tblres"><table class="zpl_tbl wd100_per"><thead><tr><th>Employee Name</th></tr></thead><tbody id="salNtAvlTBody">';"SUCCESS"===data.status&&(data.salaryNotAvailable.length>0&&$.each(data.salaryNotAvailEmpDetails,function(key,value){var personalDet=value.personalDetails;let tr='<tr><td><div class="zpl_em"><div class="zpl_emimg"><img src="'+personalDet.photo+'"></div><div class="zpl_emdts"><div><em>'+personalDet.empid+"</em><b>&nbsp;-&nbsp;"+personalDet.name+"</b></div><em>"+value.designationName+" - "+value.departmentName+"</em></div></div></td></tr>";tableCont+=tr}));tableCont+="</tbody></table></div></div></div>",pageId.find("#cardSalaryNotMapped").html(tableCont)},crfireScrollCallBack:function(){var params={mode:"getAssessorUsersByFreqSettAdmin",stDt:PMSOperation.CR_ST_DATE,iCnt:0,startIndex:PMSOperation.CR_FS_ST_IDX,reclimit:50,assessor:-1};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){var pageId=$(PMSOperation.SHOW_CR_MODAL.sliderDiv),cfsData=resultData.cfsData,empArr=cfsData.empArr,empDts=cfsData.empDts;if(!(void 0===empArr||empArr.length<=0)){settingsPage.fireScrollObj.crCmplList.reset();for(var avgData=cfsData.avgData,selfAvgData=avgData.selfAvg,revAvgData=avgData.assessorAvg,tableCont="",i=0;i<empArr.length;i++){var k=empArr[i],emp=empDts[k].personalDetails,selfAvgScr=void 0===selfAvgData?void 0:selfAvgData[k],revAvgScr=void 0===revAvgData?void 0:revAvgData[k];tableCont+=PMSOperation.constructCRDetRow(emp,selfAvgScr,revAvgScr)}pageId.find("#cardScoreView #crDtTBody").append(tableCont),PMSV2Cycle.FS_IDX=PMSV2Cycle.FS_IDX+empArr.length}})},getPublishDetails:function(configId,status){var _data="";return $.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getCyclePublishDetails",configId:configId,status:0,conreqcsr:csrfToken},success:function(data){_data=data}}),_data},processStatusView:function(configId,status,mode){let _data=PMSV2Cycle.getPublishDetails(configId,status),publishdata=_data.publishDetails;if(void 0!==publishdata&&""!=publishdata&&(PMSV2Cycle.REVIEWSTATUS_DATA=_data),void 0==PMSV2Cycle.appStatusSliderObj||0==Object.keys(PMSV2Cycle.appStatusSliderObj).length){let sliderTab=new Tab("publish_view",function(){$(PMSV2Cycle.appStatusSliderObj.sliderDiv).find("#cardpublish_view").html(ZPeople.LOADING_HTML)});PMSV2Cycle.appStatusSliderObj=new sliderModal(ZPI18N.getString("zp.appraisalstatus"),sliderTab),PMSV2Cycle.appStatusSliderObj.fullPageSize=!0,PMSV2Cycle.appStatusSliderObj._saveToggle=!1,PMSV2Cycle.appStatusSliderObj.ftExtraCls="DN",PMSV2Cycle.appStatusSliderObj.setCloseCallback(function(){PMSV2Cycle.IS_VIEW_STATUS_OPENED_FROM_CYCLELISTING&&PMSOperation.getUpdatedStatusCountForCycle(PMSV2Cycle.appStatusSliderObj.configId),PMSV2Cycle.appStatusSliderObj.remove(),PMSV2Cycle.appStatusSliderObj={},PMSV2Cycle.VIEW_STATUS_PAGE_PERIOD_STATUS=null,paCommonUtil.isSalaryHikeCyclePage()?window.location.hash="operations/performance/salarycycle":window.location.hash="operations/performance/cycle"}),PMSV2Cycle.appStatusSliderObj.configId=configId,PMSV2Cycle.appStatusSliderObj.construct()}PMSV2Cycle.getHikeTerms(),PMSOperation.getformDetails("appraisal"),PMSV2Cycle.appraisalCycleStatus=status,setTimeout(function(){PMSV2Cycle.BackupConfigId=configId;var isShowCycleBackup=_data.isShowCycleBackup;let _sliderDiv=$(PMSV2Cycle.appStatusSliderObj.sliderDiv);if(!_data.cycleData.isSalaryHikeCycle&&0==_data.performance.total)return void PMSOperationCommon.setNoData(_sliderDiv.find("#cardpublish_view"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null);if(_data.cycleData.isSalaryHikeCycle&&0==_data.hike.total)return void PMSOperationCommon.setNoData(_sliderDiv.find("#cardpublish_view"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null);$(PMSV2Cycle.appStatusSliderObj.sliderDiv).find(".zpl_mhder h4").text(ZPeople.decodeTxt(_data.cycleData.periodName));let appStatusEle="";appStatusEle=_data.cycleData.isSalaryHikeCycle?void 0!==_data.hike&&""!=_data.hike&&_data.hike.total>0?PMSV2Cycle.appraisalStatusDetails(_data.hike,_data.cycleData,isShowCycleBackup):"":void 0!==publishdata&&""!=publishdata&&publishdata.usercount>0?PMSV2Cycle.appraisalStatusDetails(_data.publishDetails,_data.cycleData,isShowCycleBackup):"",_sliderDiv.find("#cardpublish_view").html(""),_sliderDiv.find("#cardpublish_view").addClass("zpl_crdwthful"),_sliderDiv.find("#cardpublish_view").html(appStatusEle),_sliderDiv.find("#cardpublish_view #card_mainHeader").append('<form id="zp_cycle_backup" action="paCycleBackup.zp" method="post" name="zp_cycle_backup" style="display: none;"  target="exportresp"></form><div class="zpl_anulperid"><input type="hidden" id="configId" value="'+configId+'"/><div class="zpl_anulperidlft"><ul id="appstatuslft"></ul></div><div class="zpl_anulperidcnt" id="appstatusrgt"></div></div>'),_sliderDiv.find("#cardpublish_view").attr("configid",configId);let lftObj=PMSV2Cycle.constructAppLftObj(_data),leftElem=PMSV2Cycle.constructAppLft(lftObj);if(_sliderDiv.find("#cardpublish_view #appstatuslft").append($(leftElem)),$(PMSV2Cycle.appStatusSliderObj.sliderDiv).addClass("zpl_paappovrview"),_sliderDiv.find("#appstatuslft div[attr=progressWheelElement]").each(function(index){ZPeopleComponents.progresswheel($(this),{statusMessage:{text:$(this).attr("centretxt"),position:"center"}})}),_sliderDiv.find("#appstatuslft li").click(function(){_sliderDiv.find("#appstatuslft li").removeClass("zpl_act"),$(this).addClass("zpl_act"),PMSV2Cycle.switchLeftTab($(this).attr("id"))}),void 0==mode){let _cycleData=PMSV2Cycle.REVIEWSTATUS_DATA.cycleData;mode=_cycleData.selfEnabled?"selfAppraisalData":_cycleData.mrEnabled?"multiraterData":_cycleData.appraisalEnabled?"performanceData":_cycleData.hikeEnabled?"hikeData":_cycleData.isAppraisalLetterEnabled&&PMSV2Cycle.REVIEWSTATUS_DATA.isShowAppraisalLetterStatus?"appraisalLetter":"publishdata"}$(_sliderDiv.find("#appstatuslft #"+mode)).addClass("zpl_act"),PMSV2Cycle.switchLeftTab(mode)},500)},fetchReminderPendingList:function(configId,type){var _data="";let SearchText=void 0!=PMSV2Cycle.reminderslider&&void 0!=PMSV2Cycle.reminderslider.sliderDiv&&$(PMSV2Cycle.reminderslider.sliderDiv).find(".search-cmn").hasClass("opn")?$(PMSV2Cycle.reminderslider.sliderDiv).find("#CycleReminderSerachEmployee").val():"";return PMSOperation.REMINDER_POKE_PREV_SEARCHTEXT=SearchText,$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getReminderPendingList",type:type,configId:configId,startIndex:PMSV2Cycle.pendingStartIndx,searchText:SearchText,conreqcsr:csrfToken},success:function(data){_data=data}}),_data},searchReminderEmployees:function(obj){paCommonUtil.validateSearch(obj,"apprRemindPoke",PMSV2Cycle.CycleReminderSearchCallback,!0)},CycleReminderSearchCallback:function(){PMSV2Cycle.remindUserList=[],PMSV2Cycle.pendingStartIndx=1,PMSV2Cycle.tempRemindUserList=[],PMSV2Cycle.showReminderSlider(PMSV2Cycle.CYCLE_REMINDER_OBJ.type,PMSV2Cycle.CYCLE_REMINDER_OBJ.configId,PMSV2Cycle.CYCLE_REMINDER_OBJ.userCount,!0)},showReminderSlider:function(type,configId,userCount,isSearch){PMSV2Cycle.CYCLE_REMINDER_OBJ={},PMSV2Cycle.CYCLE_REMINDER_OBJ.type=type,PMSV2Cycle.CYCLE_REMINDER_OBJ.configId=configId,PMSV2Cycle.CYCLE_REMINDER_OBJ.userCount=userCount;let _data=PMSV2Cycle.fetchReminderPendingList(configId,type);PMSV2Cycle.pendingStartIndx=1;let sliderName="";if("0"==type?sliderName=PMSCommon.getFormName(PMSCommon.SELF_APPRAISAL_TABLE):"3"==type?sliderName=PMSV2Cycle.SALARYHIKENAME:"4"==type||"2"==type?sliderName=PMSV2Cycle.multiraterName:"1"==type&&(sliderName=ZPI18N.getString("zp.reviewerreview")),"PERMISSION_DENIED"===_data.MSG)ZPeople.Message.failure(ZPI18N.getString("zp.permdeniedremaindermail"));else if("FAILURE"===_data.MSG)ZPeople.Message.failure(ZPI18N.getString("zp.failedremaindermail"));else{let pendinglist=_data.PENDINGLIST;if(PMSV2Cycle.pendingStartIndx=_data.PENDINGLIST?pendinglist.length+1:PMSV2Cycle.pendingStartIndx,void 0!=isSearch&&isSearch)$(PMSV2Cycle.reminderslider.sliderDiv).find(".zpl_tblres").html(ZPeople.LOADING_HTML);else{let sliderTab=new Tab("reminderuserdetails",function(){});PMSV2Cycle.reminderslider=new sliderModal("",sliderTab),PMSV2Cycle.reminderslider._saveToggle=!1,PMSV2Cycle.reminderslider.ftExtraCls="DN",PMSV2Cycle.reminderslider.setCloseCallback(function(){PMSV2Cycle.reminderslider.remove(),PMSV2Cycle.reminderslider={},PMSV2Cycle.pendingStartIndx=1,PMSV2Cycle.tempRemindUserList=[]}),PMSV2Cycle.reminderslider.construct(),$(PMSV2Cycle.reminderslider.sliderDiv).find("#cardreminderuserdetails").html(ZPeople.LOADING_HTML)}PMSV2Cycle.constructReminderList(pendinglist,type,userCount,sliderName,isSearch)}},pendingListScroll:function(){let sliderId=$(PMSV2Cycle.reminderslider.sliderDiv),type=$(sliderId.find("#cardreminderuserdetails").children()[1]).attr("type"),_data=PMSV2Cycle.fetchReminderPendingList(PMSV2Cycle.BackupConfigId,type);if("PERMISSION_DENIED"===_data.MSG)ZPeople.Message.failure(ZPI18N.getString("zp.permdeniedremaindermail"));else if("FAILURE"===_data.MSG)ZPeople.Message.failure(ZPI18N.getString("zp.failedremaindermail"));else{let pendinglist=_data.PENDINGLIST;PMSV2Cycle.pendingStartIndx=_data.PENDINGLIST?PMSV2Cycle.pendingStartIndx+pendinglist.length+1:PMSV2Cycle.pendingStartIndx;let _dataHtm=PMSV2Cycle.listRowConstruct(pendinglist,type);if(""!=_dataHtm&&(sliderId.find("#pendinglisttbody").append(_dataHtm),PMSV2Cycle.includePendingList()),pendinglist.length>0&&100==pendinglist.length)new FireScrollBack(PMSV2Cycle.pendingListScroll,sliderId.find("#cardreminderuserdetails"),"pendinglist");else delete settingsPage.fireScrollObj.pendinglist}},constructReminderList:function(data,type,userCount,sliderName,isSearch){let sliderId=$(PMSV2Cycle.reminderslider.sliderDiv);if(void 0!=isSearch&&isSearch){let _htm='<table class="zpl_tbl wd100_per"><thead><tr><th style="width: 1%;">';_htm+='<div class="zcheckbox" onclick="PMSOperation.enableDisableAll(this)" id="remindallchkbox"><input id="remindall" type="checkbox" name="check" class="zcheckbox__helper"><label for="remindall" class="zcheckbox__label"></label></div>',_htm+="</th><th></th>","2"==type&&(_htm+='<th width="100">'+ZPI18N.getString("zp.pending")+"</th>"),_htm+='<th width="150"></th></tr></thead>',_htm+='<tbody id="pendinglisttbody"></tbody>',_htm+="</table>",$(PMSV2Cycle.reminderslider.sliderDiv).find(".zpl_tblres").html(_htm)}else{$(PMSV2Cycle.reminderslider.sliderDiv).find("#sliHdrDiv h4").html(sliderName);let _htm='<div class="zpl_btnmnu">';_htm+='<div class="search-cmn"> <i class="PI_lens"  title="'+ZPI18N.getString("zp.search")+'"></i>',_htm+='<input type="text" class="ztextbox" id="CycleReminderSerachEmployee" placeholder="'+ZPI18N.getString("zp.searchdata")+'" onkeyup="PMSV2Cycle.searchReminderEmployees(this,\'CycleReminder\')"> <i class="PI_cls" onclick="PMSOperation.clssearch(\'CycleReminder\')"></i> </div>',_htm+='<div class="actn_ovrly" style="z-index: 6;" id="CycleReminderMultiActionDiv"> <div><button class="zlabel  zlabel--blue zlabel--outline zlabel--medium" id="remindpokeallbtn" onclick="PMSV2Cycle.triggerReminder(this,\''+type+"', false , false);\">"+ZPI18N.getString("zp.reminder.remind")+'</button> </div> <i class="PI_cls" onclick="PMSOperation.removeAllIncludeUserMultiDeleteAction(\'CycleReminder\')"></i> </div>',_htm+='<div class="zpl_rgt"><span><label>'+ZPI18N.getString("zp.totalApllicableemployees")+'</label>&nbsp;:&nbsp;<b id="zp_pending_recordcount" class="">'+userCount+"</b></span>",_htm+='<button class="zlabel zlabel--blue zlabel--outline zlabel--medium" id="remindAllUsersBtn" onclick="PMSV2Cycle.triggerReminder(this,\''+type+"',true ,false)\">"+ZPI18N.getString("zp.cyclestatus.remindall")+"</button>",_htm+='<i class="zpl_ibg PI_lens" onclick="PMSOperation.opnsearch(\'CycleReminder\')" title="'+ZPI18N.getString("zp.search")+'"></i>',_htm+="</div></div>",_htm+='<div type="'+type+'"><div class="zpl_crdcnt">',_htm+='<div class="zpl_tblres"><table class="zpl_tbl wd100_per"><thead><tr><th style="width: 1%;">',_htm+='<div class="zcheckbox" onclick="PMSOperation.enableDisableAll(this)" id="remindallchkbox"><input id="remindall" type="checkbox" name="check" class="zcheckbox__helper"><label for="remindall" class="zcheckbox__label"></label></div>',_htm+="</th><th></th>","2"==type&&(_htm+='<th width="100">'+ZPI18N.getString("zp.pending")+"</th>"),_htm+='<th width="150"></th></tr></thead>',_htm+='<tbody id="pendinglisttbody"></tbody>',_htm+="</table></div></div></div>",sliderId.find("#cardreminderuserdetails").html(_htm)}let _dataHtm=PMSV2Cycle.listRowConstruct(data,type);if(""!=_dataHtm&&(sliderId.find("#pendinglisttbody").html(_dataHtm),PMSV2Cycle.includePendingList()),100==data.length)new FireScrollBack(PMSV2Cycle.pendingListScroll,sliderId.find("#cardreminderuserdetails"),"pendinglist");void 0!=isSearch&&isSearch&&0==$(PMSV2Cycle.reminderslider.sliderDiv).find(".zpl_tblres").find("#pendinglisttbody tr").length&&PMSOperationCommon.setNoData($(PMSV2Cycle.reminderslider.sliderDiv).find(".zpl_tblres"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null)},listRowConstruct:function(data,type){var _dataHtm="";return data.forEach(obj=>{PMSV2Cycle.tempRemindUserList.push(obj.erecNo),_dataHtm+='<tr id="'+obj.erecNo+'"><td><div class="zcheckbox"><input id="remind_'+obj.erecNo+'" type="checkbox" name="check" class="zcheckbox__helper"><label for="remind_'+obj.erecNo+'" class="zcheckbox__label"></label></div></td>',_dataHtm+='<td><div class="zpl_em">',_dataHtm+='<div class="zpl_emimg"><img src="'+obj.empPhoto+'"></div>',_dataHtm+='<div class="zpl_emdts"><div><em>'+obj.empId+" - </em><b>"+obj.name+"</b></div><em>"+obj.designationName+"</em></div>",_dataHtm+="</div> </td>","2"==type&&(_dataHtm+="<td><span>"+obj.pendingcnt+"</span></td>"),_dataHtm+='<td><div class="zpl_hvr"><button type="button" class="zlabel zlabel--blue zlabel--small zlabel--outline" onclick="PMSV2Cycle.triggerReminder(this,\''+type+"', false , true ,'"+obj.erecNo+"')\">"+ZPI18N.getString("zp.reminder.remind")+"</button></div></td></tr>"}),_dataHtm},includePendingList:function(){const remindAll=$(PMSV2Cycle.reminderslider.sliderDiv).find("#cardreminderuserdetails"),remindBtn=remindAll.find("#remindpokeallbtn");remindAll.find("tbody input[type='checkbox']").off().on("click",function(){const userId=$(this).closest("tr").attr("id");this.checked?(PMSV2Cycle.remindUserList.push(userId),remindBtn.prop("disabled",!1),PMSV2Cycle.remindUserList.length===PMSV2Cycle.tempRemindUserList.length&&remindAll.find("#remindallchkbox input").prop("checked",!0),remindAll.find("#CycleReminderMultiActionDiv").hasClass("opn")||remindAll.find("#CycleReminderMultiActionDiv").addClass("opn")):(PMSV2Cycle.remindUserList.splice(PMSV2Cycle.remindUserList.indexOf(userId),1),PMSV2Cycle.remindUserList.length<PMSV2Cycle.tempRemindUserList.length&&remindAll.find("#remindallchkbox input").prop("checked",!1),0==PMSV2Cycle.remindUserList.length&&(remindBtn.prop("disabled",!0),remindAll.find("#CycleReminderMultiActionDiv").hasClass("opn")&&remindAll.find("#CycleReminderMultiActionDiv").removeClass("opn")))})},triggerReminder:function(obj,type,isAll,isSingle,erecNo){if(isAll||$(PMSV2Cycle.reminderslider.sliderDiv).find("#remindall").is(":checked")){const pendingSlider=$(PMSV2Cycle.reminderslider.sliderDiv);switch(PMSV2Cycle.pendingAlert=new InfoAlertMessage,PMSV2Cycle.pendingAlert.title=ZPI18N.getString("zp.reminder.remind"),PMSV2Cycle.pendingAlert.despcription=isAll?ZPI18N.getString("zp.reminder.remindnotifidesall",new Array(pendingSlider.find("#zp_pending_recordcount").text())):ZPI18N.getString("zp.reminder.remindnotifidesc",new Array(PMSV2Cycle.remindUserList.length+"")),PMSV2Cycle.pendingAlert.handleESC=!0,PMSV2Cycle.pendingAlert.needButton=!0,PMSV2Cycle.pendingAlert,isAll?(PMSV2Cycle.pendingAlert.cancelButtonText=ZPI18N.getString("zp.cancel"),PMSV2Cycle.pendingAlert.yesButtonText=ZPI18N.getString("zp.cyclestatus.remindall"),PMSV2Cycle.pendingAlert.callback=function(){PMSV2Cycle.sendReminder(obj,type,!0,isSingle,erecNo)}):(PMSV2Cycle.pendingAlert.yesButtonText=ZPI18N.getString("zp.cyclestatus.remindselemp"),PMSV2Cycle.pendingAlert.callback=function(){PMSV2Cycle.sendReminder(obj,type,!1,isSingle,erecNo)}),PMSV2Cycle.pendingAlert.setCloseCallback=function(){PMSV2Cycle.pendingAlert.remove(),PMSV2Cycle.pendingAlert=null},PMSV2Cycle.pendingAlert.show(),type){case"0":PMSV2Cycle.pendingAlert.alertDiv.find(".cont").append('<p class="">'+ZPI18N.getString("zp.cyclestatus.remselfnote")+"</p>");break;case"1":PMSV2Cycle.pendingAlert.alertDiv.find(".cont").append('<p class="">'+ZPI18N.getString("zp.cyclestatus.remreviewnote")+"</p>");break;case"3":PMSV2Cycle.pendingAlert.alertDiv.find(".cont").append('<p class="">'+ZPI18N.getString("zp.cyclestatus.remhikenote")+"</p>");break;case"4":PMSV2Cycle.pendingAlert.alertDiv.find(".cont").append('<p class="">'+ZPI18N.getString("zp.cyclestatus.remmultiselectionnote",new Array(PMSV2Cycle.multiraterName))+"</p>");break;case"2":PMSV2Cycle.pendingAlert.alertDiv.find(".cont").append('<p class="">'+ZPI18N.getString("zp.cyclestatus.remmultifeedbacknote",new Array(PMSV2Cycle.multiraterName))+"</p>")}}else PMSV2Cycle.sendReminder(obj,type,!1,isSingle,erecNo)},sendReminder:(obj,type,isAll,isSingle,erecNo)=>{let parentDiv=$(PMSV2Cycle.appStatusSliderObj.sliderDiv).find("#cardpublish_view"),params={mode:"triggerReminder",configId:$(parentDiv).attr("configid"),type:type,conreqcsr:csrfToken};if($(obj).prop("disabled",!0),!isAll)if(isSingle){let list=[];list.push(erecNo),params.pendingUserReminderList=JSON.stringify(list)}else params.pendingUserReminderList=JSON.stringify(PMSV2Cycle.remindUserList);params.isRemindAll=isAll,$.post("/performanceConfig.zp",params,function(resultData){if($(obj).prop("disabled",!1),"SUCCESS"===resultData.MSG){null!=PMSV2Cycle.pendingAlert&&PMSV2Cycle.pendingAlert.close(),PMSV2Cycle.remindUserList=[];const remindAll=$(PMSV2Cycle.reminderslider.sliderDiv).find("#cardreminderuserdetails"),remindBtn=remindAll.find("#remindpokeallbtn");remindAll.find("#remindallchkbox input").prop("checked",!1),remindAll.find("#pendinglisttbody input").prop("checked",!1),remindBtn.prop("disabled",!0),ZPeople.Message.success(ZPI18N.getString("zp.successramindermail")),PMSOperation.removeAllIncludeUserMultiDeleteAction("CycleReminder")}else"PERMISSION_DENIED"===resultData.MSG?(ZPeople.Message.failure(ZPI18N.getString("zp.permdeniedremaindermail")),null!=PMSV2Cycle.pendingAlert&&PMSV2Cycle.pendingAlert.close()):"FAILURE"===resultData.MSG?ZPeople.Message.failure(ZPI18N.getString("zp.failedremaindermail")):"cycleclose_error"===resultData.MSG?(ZPeople.Message.failure(ZPI18N.getString("zp.processperiodclosedmsg")),null!=PMSV2Cycle.pendingAlert&&PMSV2Cycle.pendingAlert.close()):"COUNT_EXCEEDED"===resultData.MSG?"TRY_AFTER_1HR"==resultData.Remindmessage?ZPeople.Message.warning(ZPI18N.getString("zp.paremindallmsg1hr")):ZPeople.Message.warning(ZPI18N.getString("zp.paremindallmsg24hr")):"REMINDER_SCHEDLED"==resultData.MSG?ZPeople.Message.success(ZPI18N.getString("zp.paremindallmsg")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))})},backUpCycleData:function(mode,configId){var infoPopUp=new InfoAlertMessage;infoPopUp.title=ZPI18N.getString("zp.backupappraisalcycledata"),infoPopUp.despcription=ZPI18N.getString("zp.appraisalbackupinfo",new Array(PMSSetting.MULTIRATER_DISPLAY_NAME,PMSSetting.GOAL_DISPLAY_NAME,PMSSetting.KRA_DISPLAY_NAME,PMSSetting.COMPETENCY_DISPLAY_NAME,PMSSetting.QUS_ANS_DISPLAY_NAME)),infoPopUp.yesButtonText="export"==mode?ZPI18N.getString("zp.export"):ZPI18N.getString("zp.backuptxt"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){let formObj="";if("#operations/performance/cycle"==Layout.Page.hash){formObj=$(PMSV2Cycle.appStatusSliderObj.sliderDiv).find("#zp_cycle_backup").html("")}else{formObj=settingsPage.container.find("#zp_cycle_backup").html("")}configId=null!=configId?configId:PMSV2Cycle.BackupConfigId,formObj.append('<input type="hidden" value="xls" name="ftype"/>'),formObj.append('<input type="hidden" value="'+csrfToken+'" name="'+csrfParamName+'"/>'),formObj.append('<input type="hidden" value="cyclebackup" name="submode"/>'),formObj.append('<input type="hidden" value="true" name="isnewui"/>'),formObj.append('<input type="hidden" value="'+configId+'" name="configId"/>'),formObj.submit()},infoPopUp.show()},constructAppLft:function(arr){let _htm="";for(var i in arr){arr[i].completed>0&&Math.round(100*arr[i].completed/arr[i].total),_htm+='<li id="'+arr[i].liId+'"><div>',_htm+='<div class="zpl_cyclecht">',"selfAppraisalData"===arr[i].liId?_htm+='<div class="icnDv"><span class="PI_self_appraisal icn zpl_seclr2"></span></div>':"multiraterData"===arr[i].liId?_htm+='<div class="icnDv"><span class="PI_mutlirater icn zpl_seclr3"></span></div>':"performanceData"===arr[i].liId?_htm+='<div class="icnDv"><span class="PI_perfrm_rvw zpl_seclr4 icn"></span></div>':"hikeData"===arr[i].liId||"formhikeData"===arr[i].liId?_htm+='<div class="icnDv"><span class="PI_hike icn zpl_seclr5"></span></div>':"publishdata"===arr[i].liId?_htm+='<div class="icnDv"><span class="PI_publish zpl_seclr6 icn"></span></div>':"appraisalLetter"===arr[i].liId&&(_htm+='<div class="icnDv"><span class="PI_offer_letter zpl_seclr3 icn"></span></div>'),_htm+="</div>",_htm+='<div><span class="d-flexC"><b>'+arr[i].name+"</b>",arr[i].hasOwnProperty("date")&&(_htm+='<span class="zpl_dots"></span><em>'+arr[i].date+"</em>"),_htm+='</span><ul class="zpl_cylesta">';var complete=ZPI18N.getString("zp.completed"),pending=ZPI18N.getString("zp.pending");"publishdata"===arr[i].liId?(complete=ZPI18N.getString("zp.published"),pending=ZPI18N.getString("zp.unpublished")):"appraisalLetter"===arr[i].liId&&(complete=ZPI18N.getString("zp.sent"),pending=ZPI18N.getString("zp.notyetsent")),_htm+='<li><span class="zpl_dots blu"></span> <em>'+complete+"</em><span>"+arr[i].completed+"</span></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+pending+"</em><span>"+arr[i].pending+"</span></li>","publishdata"!==arr[i].liId&&("0"===arr[i].status?_htm+='<li><em class="org">'+ZPI18N.getString("zp.chkyettostart")+"</em></li>":"1"===arr[i].status?_htm+='<li><em class="blu">'+ZPI18N.getString("zp.inprogress")+"</em></li>":"2"===arr[i].status&&(_htm+='<li><em class="grn">'+ZPI18N.getString("zp.completed")+"</em></li>")),_htm+="</ul></div></div></li>"}return _htm},switchLeftTab:function(mode){$(PMSV2Cycle.appStatusSliderObj.sliderDiv).find("#cardpublish_view #appstatusrgt").empty(),"publishdata"==mode?PMSV2Cycle.constructPublishRgt(PMSV2Cycle.REVIEWSTATUS_DATA):"hikeData"==mode?PMSV2Cycle.constructHikeRgt(PMSV2Cycle.REVIEWSTATUS_DATA):"selfAppraisalData"==mode?PMSV2Cycle.constructSelfRgt(PMSV2Cycle.REVIEWSTATUS_DATA):"multiraterData"==mode?PMSV2Cycle.constructMultiRgt(PMSV2Cycle.REVIEWSTATUS_DATA):"performanceData"==mode?PMSV2Cycle.constructPerformanceRgt(PMSV2Cycle.REVIEWSTATUS_DATA):"formhikeData"==mode?PMSV2Cycle.constructPAFormHikeRgt(PMSV2Cycle.REVIEWSTATUS_DATA):"appraisalLetter"==mode&&PMSV2Cycle.constructAppraisalLetterRgt(PMSV2Cycle.REVIEWSTATUS_DATA)},constructAppLftObj:function(_data){let _publishdata=_data.publishDetails,_hikeData=_data.hike,_formhikeData=_data.SalaryHikeFormStatus,_selfAppraisalData=_data.selfAppraisal,_multiraterData=_data.multirater,_performance=_data.performance,_esignStatus=_data.esignStatus,_finalarr=[];if(void 0!==_selfAppraisalData&&""!=_selfAppraisalData){var selfJSON={};selfJSON.name=PMSCommon.getFormName(PMSCommon.SELF_APPRAISAL_TABLE)+" "+ZPI18N.getString("zp.status"),_selfAppraisalData.hasOwnProperty("fromDate")&&(selfJSON.date=_selfAppraisalData.fromDate+"&nbsp; "+ZPI18N.getString("zp.sto")+" &nbsp;"+_selfAppraisalData.toDate),selfJSON.completed=_selfAppraisalData.completedcount,selfJSON.pending=_selfAppraisalData.pendingcount,selfJSON.total=_selfAppraisalData.total,0==parseInt(selfJSON.completed)&&(selfJSON.status="0"),parseInt(selfJSON.completed)>0&&parseInt(selfJSON.pending)<parseInt(_selfAppraisalData.total)&&(selfJSON.status="1"),0==parseInt(selfJSON.pending)&&(selfJSON.status="2"),selfJSON.liId="selfAppraisalData",_finalarr.push(selfJSON)}if(void 0!==_multiraterData&&""!=_multiraterData){var multiJSON={};multiJSON.name=PMSV2Cycle.multiraterName+" "+ZPI18N.getString("zp.status"),_multiraterData.hasOwnProperty("fromDate")&&(multiJSON.date=_multiraterData.fromDate+"&nbsp; "+ZPI18N.getString("zp.sto")+" &nbsp;"+_multiraterData.toDate),multiJSON.completed=_multiraterData.completedcount,multiJSON.pending=_multiraterData.pendingcount,multiJSON.total=_multiraterData.total,0==parseInt(multiJSON.completed)&&(multiJSON.status="0"),parseInt(multiJSON.completed)>0&&parseInt(multiJSON.pending)<parseInt(_multiraterData.total)&&(multiJSON.status="1"),0==parseInt(multiJSON.pending)&&(multiJSON.status="2"),multiJSON.liId="multiraterData",_finalarr.push(multiJSON)}if(void 0!==_performance&&""!=_performance){var perfJSON={};perfJSON.name=ZPI18N.getString("zp.reviewerreview")+" "+ZPI18N.getString("zp.status"),_performance.hasOwnProperty("fromDate")&&(perfJSON.date=_performance.fromDate+"&nbsp; "+ZPI18N.getString("zp.sto")+" &nbsp;"+_performance.toDate),perfJSON.completed=_performance.completedcount,perfJSON.pending=_performance.pendingcount,perfJSON.total=_performance.total,0==parseInt(perfJSON.completed)&&(perfJSON.status="0"),parseInt(perfJSON.completed)>0&&parseInt(perfJSON.pending)<parseInt(_performance.total)&&(perfJSON.status="1"),0==parseInt(perfJSON.pending)&&(perfJSON.status="2"),perfJSON.liId="performanceData",_finalarr.push(perfJSON)}if(void 0!==_hikeData&&""!=_hikeData){var budgetJSON={};budgetJSON.name=PMSV2Cycle.SALARYHIKENAME+" "+ZPI18N.getString("zp.status"),_hikeData.hasOwnProperty("fromDate")&&(budgetJSON.date=_hikeData.fromDate+"&nbsp; "+ZPI18N.getString("zp.sto")+" &nbsp;"+_hikeData.toDate),budgetJSON.completed=_hikeData.completedcount,budgetJSON.pending=_hikeData.pendingcount,budgetJSON.total=_hikeData.total,0==parseInt(budgetJSON.completed)&&(budgetJSON.status="0"),parseInt(budgetJSON.completed)>0&&parseInt(budgetJSON.pending)<parseInt(_hikeData.total)&&(budgetJSON.status="1"),0==parseInt(budgetJSON.pending)&&(budgetJSON.status="2"),budgetJSON.liId="hikeData",_finalarr.push(budgetJSON)}if(void 0!==_formhikeData&&""!=_formhikeData&&void 0!=_formhikeData.salaryGivenCount&&_formhikeData.salaryGivenCount>0){var formHikeJSON={};formHikeJSON.name=PMSV2Cycle.SALARYHIKENAME+" "+ZPI18N.getString("zp.status"),formHikeJSON.completed=_formhikeData.salaryGivenCount,formHikeJSON.pending=_performance.total-_formhikeData.salaryGivenCount,formHikeJSON.total=_performance.total,0==parseInt(formHikeJSON.completed)&&(formHikeJSON.status="0"),parseInt(formHikeJSON.completed)>0&&parseInt(formHikeJSON.pending)<parseInt(formHikeJSON.total)&&(formHikeJSON.status="1"),0==parseInt(formHikeJSON.pending)&&(formHikeJSON.status="2"),formHikeJSON.liId="formhikeData",_finalarr.push(formHikeJSON)}if(void 0!==_publishdata&&""!=_publishdata&&_publishdata.usercount>0&&void 0!==_performance&&""!=_performance&&parseInt(_performance.completedcount)>0){var publishJSON={};publishJSON.name=ZPI18N.getString("zp.publishstatus"),_publishdata.hasOwnProperty("reviewPublishDt")?publishJSON.date=_publishdata.reviewPublishDt:_publishdata.hasOwnProperty("schedule")&&_publishdata.schedule.length>0&&(publishJSON.date=_publishdata.schedule[0].startdate+"&nbsp; "+ZPI18N.getString("zp.sto")+" &nbsp;"+_publishdata.schedule[0].duedate),publishJSON.total=parseInt(_publishdata.publishedcount)+parseInt(_publishdata.unpublishedcount),publishJSON.completed=_publishdata.publishedcount,publishJSON.pending=_publishdata.unpublishedcount,0==publishJSON.completed&&(publishJSON.status="0"),publishJSON.completed>0&&publishJSON.pending<_publishdata.readytoPublishCnt&&(publishJSON.status="1"),0!=publishJSON.completed&&0==publishJSON.pending&&(publishJSON.status="2"),publishJSON.liId="publishdata",_finalarr.push(publishJSON)}if(_data.cycleData.isAppraisalLetterEnabled&&_data.isShowAppraisalLetterStatus&&void 0!=_esignStatus&&""!=_esignStatus){var apprLetterJSON={};apprLetterJSON.name=ZPI18N.getString("zp.paesign.appraisalletters"),apprLetterJSON.total=_performance.total,_data.cycleData.isAppraisalEsignEnabled?(apprLetterJSON.completed=_esignStatus.Pending+_esignStatus.Completed+_esignStatus.PartiallyCompleted+_esignStatus.recalled+_esignStatus.expired+_esignStatus.decliend,apprLetterJSON.pending=apprLetterJSON.total-apprLetterJSON.completed):(apprLetterJSON.completed=_esignStatus.Completed,apprLetterJSON.pending=apprLetterJSON.total-apprLetterJSON.completed),0==apprLetterJSON.completed&&(apprLetterJSON.status="0"),apprLetterJSON.completed>0&&apprLetterJSON.pending>0&&(apprLetterJSON.status="1"),0!=apprLetterJSON.completed&&0==apprLetterJSON.pending&&(apprLetterJSON.status="2"),apprLetterJSON.liId="appraisalLetter",_finalarr.push(apprLetterJSON)}return _finalarr},appraisalStatusDetails:function(publishdata,cycleData,isShowCycleBackup){let totalAppraisee=0,pendingCount=0,completedCount=0;cycleData.isSalaryHikeCycle?(totalAppraisee=publishdata.total,pendingCount=publishdata.pendingcount,completedCount=publishdata.completedcount):(totalAppraisee=publishdata.usercount,pendingCount=publishdata.pendingcount,completedCount=publishdata.completedcount);let _htm='<div style="padding-right: 0 !important;" id="card_mainHeader"><div class="zpl_cylepridhdr">',appprocessperiod=cycleData.periodStart+"&nbsp; "+ZPI18N.getString("zp.sto")+" &nbsp;"+cycleData.periodEnd;if(cycleData.isSalaryHikeCycle?_htm+=' <div class="zpl_idiv"><span>'+ZPI18N.getString("zp.hikePeriod")+"&nbsp;:&nbsp;</span> <b>"+appprocessperiod+"</b> </div>":_htm+=' <div class="zpl_idiv"><span>'+ZPI18N.getString("zp.reviewprocessperiod")+"&nbsp;:&nbsp;</span> <b>"+appprocessperiod+"</b> </div>",null!=cycleData.cyclefromdate&&null!=cycleData.cycletoDate&&void 0!=cycleData.cyclefromdate&&void 0!=cycleData.cycletoDate&&""!=cycleData.cyclefromdate&&""!=cycleData.cycletoDate){let appCycleperiod=cycleData.cyclefromdate+"&nbsp; "+ZPI18N.getString("zp.sto")+" &nbsp;"+cycleData.cycletoDate;cycleData.isSalaryHikeCycle?_htm+='<div class="zpl_idiv"> <span>'+ZPI18N.getString("zp.salaryhikecycleperiod",[PMSV2Cycle.SALARYHIKENAME])+"&nbsp;:&nbsp;</span> <b>"+appCycleperiod+"</b> </div> ":_htm+='<div class="zpl_idiv"> <span>'+ZPI18N.getString("zp.AppEvalPeriod")+"&nbsp;:&nbsp;</span> <b>"+appCycleperiod+"</b> </div> "}return _htm+="</div>",_htm+='<div class="zpl_crd wd100_per"> <div class="zpl_crdcnt"> <div class="zpl_secn zpl_cyleprid">',_htm+='<div> <div class=""> <span>'+ZPI18N.getString("zp.totApprCnt")+" :</span> <b>"+totalAppraisee+"</b> </div> </div>",_htm+='<div> <ul class="zpl_cylesta"> <li> <span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.completed")+"</em><b>"+completedCount+'</b> </li> <li> <span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.pending")+"</em><b>"+pendingCount+"</b> </li> </ul> </div>",_htm+="<div>",isShowCycleBackup&&(_htm+='<button type="button" class="zlabel zlabel--blue zlabel--outline zlabel--medium" id="exportbtn" onclick="PMSV2Cycle.backUpCycleData(\'backup\',null);" ><i class="PI_exprt"> </i>'+ZPI18N.getString("zp.backuptxt")+"</button>"),5==cycleData.periodStatus?_htm+='<button type="button" id="reopenbtn" class="zlabel zlabel--blue zlabel--medium" onclick="PMSV2Cycle.startReopenCycle(\''+cycleData.configId+"','"+cycleData.periodStatus+"','"+pendingCount+"');\">"+ZPI18N.getString("zp.restartappraisal")+"</button>":_htm+='<button type="button" id="completebtn" class="zlabel zlabel--blue zlabel--medium" onclick="PMSV2Cycle.starAppraisalCompleteCycle(\''+cycleData.configId+"','"+cycleData.periodStatus+"','"+pendingCount+"');\">"+ZPI18N.getString("zp.processcompletecycle")+"</button>",_htm+="</div>",_htm+="</div></div></div></div>"},starAppraisalCompleteCycle:function(confId,status,pendingcount){if(0==pendingcount)PMSV2Cycle.changeCycleStatus(confId,PMSV2Cycle.cyleCompleteStatus,pendingcount);else{var infoPopUp=new InfoAlertMessage;if(infoPopUp.title="",SalaryHikeV2Cycle.isSalaryHikeCycle){var _htm=ZPI18N.getString("zp.completesalcycleconfirmmsgone")+"<br>"+ZPI18N.getString("zp.completesalcycleconfirmmsgtwo",new Array(pendingcount))+"<br>"+ZPI18N.getString("zp.completesalcycleconfirmmsgthree");infoPopUp.despcription=_htm}else{_htm=ZPI18N.getString("zp.completecycleconfirmmsgone")+"<br>"+ZPI18N.getString("zp.completecycleconfirmmsgtwo",new Array(pendingcount))+"<br>"+ZPI18N.getString("zp.completecycleconfirmmsgthree");infoPopUp.despcription=_htm}infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){PMSV2Cycle.changeCycleStatus(confId,PMSV2Cycle.cyleCompleteStatus,pendingcount)},infoPopUp.show()}},changeCycleStatus:function(confId,status,pendingcount){let pageId=settingsPage.container,_sliderDiv=$(PMSV2Cycle.appStatusSliderObj.sliderDiv);$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"changeCycleStatus",conreqcsr:csrfToken,configId:confId,status:status},success:function(data){let buttonid="";if(data.isCompleted){let cycleRowId="appraisal_row_"+confId;if(data.status==PMSV2Cycle.cyleActiveStatus){pageId.find("#"+cycleRowId+" #appraisal_status").html(ZPI18N.getString("zp.started")),5!==data.status&&pageId.find("#"+cycleRowId).find(".PI_edt").show(),PMSOperation.loadCycles(),SalaryHikeV2Cycle.isSalaryHikeCycle?ZPeople.Message.success(ZPI18N.getString("zp.restartsalcyclesuccess")):ZPeople.Message.success(ZPI18N.getString("zp.restartcyclesuccess"));let completebtn='<button id="completebtn" class="zlabel zlabel--blue zlabel--medium" onclick="PMSV2Cycle.starAppraisalCompleteCycle(\''+confId+"','"+data.status+"','"+pendingcount+'\');"  type="button">'+ZPI18N.getString("zp.processcompletecycle")+"</button>";$(completebtn).insertBefore(_sliderDiv.find("#reopenbtn")),buttonid="reopenbtn"}else{pageId.find("#"+cycleRowId+" #appraisal_status").html(ZPI18N.getString("zp.completed")),PMSOperation.loadCycles(),SalaryHikeV2Cycle.isSalaryHikeCycle?ZPeople.Message.success(ZPI18N.getString("zp.salcyclecompletedsuccess")):ZPeople.Message.success(ZPI18N.getString("zp.cyclecompletedsuccess")),5===data.status&&pageId.find("#"+cycleRowId).find(".PI_edt").hide();let reopenbtn='<button id="reopenbtn" class="zlabel zlabel--blue zlabel--medium" onclick="PMSV2Cycle.startReopenCycle(\''+confId+"','"+data.status+"','"+pendingcount+'\');" type="button">'+ZPI18N.getString("zp.restartappraisal")+"</button>";$(reopenbtn).insertBefore(_sliderDiv.find("#completebtn")),buttonid="completebtn"}PMSV2Cycle.appraisalCycleStatus=data.status,pageId.find("#"+cycleRowId+" .PI_draft").attr("onclick","PMSV2Cycle.processStatusView('"+confId+"','"+data.status+"')"),_sliderDiv.find("#"+buttonid).remove(),PMSV2Cycle.processStatusView(confId,PMSV2Cycle.appraisalCycleStatus)}}})},startReopenCycle:function(confId,status,pendingcount){var infoPopUp=new InfoAlertMessage;if(infoPopUp.title="",SalaryHikeV2Cycle.isSalaryHikeCycle){var _msg=ZPI18N.getString("zp.restartcycle")+"<br>"+ZPI18N.getString("zp.restartsalcyclemsg1");infoPopUp.despcription=_msg}else{_msg=ZPI18N.getString("zp.restartcycle")+"<br>"+ZPI18N.getString("zp.restartcyclemsg1");infoPopUp.despcription=_msg}infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){PMSV2Cycle.changeCycleStatus(confId,PMSV2Cycle.cyleActiveStatus,pendingcount)},infoPopUp.show()},constructPublishRgt:function(_data){let _sliderDiv=$(PMSV2Cycle.appStatusSliderObj.sliderDiv),_publishdata=_data.publishDetails;var hikeData=_data.hike;let _htm="";if(void 0!==_publishdata&&""!=_publishdata&&_publishdata.usercount>0){let completedpercent=0,publishedpercent=0;_publishdata.completedcount>0&&(completedpercent=100*_publishdata.completedcount/_publishdata.usercount,publishedpercent=100*_publishdata.publishedcount/_publishdata.readytoPublishCnt),_htm+='<div class="zpl_crd zpl_act" style="height: 102%;"><div class="zpl_crdcnt">',void 0!==hikeData&&""!=hikeData&&(_htm+='<div class="zpl_secn"><div><div class="zpl_gbox wd100_per">',_htm+="<div><p>"+ZPI18N.getString("zp.publishinfo",new Array(PMSV2Cycle.SALARYHIKENAME))+"</p></div></div></div></div>"),_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="pubPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.published")+"</em><b>"+_publishdata.publishedcount+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.unpublished")+"</em><b>"+_publishdata.unpublishedcount+"</b></li></ul>",_htm+="</div></div>",_htm+='<div class="zpl_secn"> <div> <div class="wd100_per">',void 0!=_publishdata.publishedcount&&_publishdata.publishedcount>0&&5!==_publishdata.periodStatus&&(_htm+="<div><h4></h4> <p>"+ZPI18N.getString("zp.unpublishinfo")+'&nbsp;<a class="u-link" onclick="PMSV2Cycle.getPublishedUserList(\''+_data.cycleData.configId+"');\">"+ZPI18N.getString("zp.clickhere")+"</a>&nbsp;"+ZPI18N.getString("zp.unpublishinfo1")+'</p> </div><div class="zpl_idiv"></div>'),_htm+='<div class="zpl_idiv"> <button type="button" id="publshbtn" class="zlabel zlabel--outline zlabel--medium zlabel--blue" onclick="PMSV2Cycle.publishthistouser(this,\''+_data.cycleData.configId+"','"+_data.cycleData.configId+"','cycle view');\">"+ZPI18N.getString("zp.publish")+"</button> </div> </div> </div> </div>",_htm+="</div> </div>",_sliderDiv.find("#cardpublish_view #appstatusrgt").empty().append($(_htm)),1!=_publishdata.ispublished&&0!=_publishdata.readytoPublishCnt||(_sliderDiv.find("#publshbtn").prop("disabled",!0).hide(),_sliderDiv.find("#publshbtn").text(ZPI18N.getString("zp.publish")))}void 0!==_publishdata&&""!=_publishdata&&_publishdata.usercount>0&&PMSV2Cycle.constructNonApprovalPieChart("pubPie",ZPI18N.getString("zp.publishstatus"),parseInt(_publishdata.publishedcount)+parseInt(_publishdata.unpublishedcount),_publishdata.publishedcount,_publishdata.unpublishedcount)},constructAppraisalLetterRgt:function(_data){let _sliderDiv=$(PMSV2Cycle.appStatusSliderObj.sliderDiv),_htm='<div class="zpl_crd zpl_act" style="height: 102%;">';if(_htm+="</div>",_htm+="</div> </div>",_sliderDiv.find("#cardpublish_view #appstatusrgt").empty().append($(_htm)),void 0!=_data.esignStatus){let esignpending=void 0!=_data.esignStatus.Pending?_data.esignStatus.Pending:0,completed=void 0!=_data.esignStatus.Completed?_data.esignStatus.Completed:0,partiallyCompleted=void 0!=_data.esignStatus.PartiallyCompleted?_data.esignStatus.PartiallyCompleted:0,recalled=void 0!=_data.esignStatus.recalled?_data.esignStatus.recalled:0,expired=void 0!=_data.esignStatus.expired?_data.esignStatus.expired:0,decliend=void 0!=_data.esignStatus.decliend?_data.esignStatus.decliend:0,letterNotSent=(void 0!=_data.performance&&void 0!=_data.performance.total?_data.performance.total:0)-(esignpending+completed+partiallyCompleted+recalled+expired+decliend);if(_data.cycleData.isAppraisalEsignEnabled){_sliderDiv.find("#cardpublish_view #appstatusrgt").find(".zpl_crd").append('<div class="zpl_secn" style="padding-left: 25px;"><div class="wd100_per"><h4>'+ZPI18N.getString("zp.paesign.appraisalletters")+"</h4></div></div>"),_sliderDiv.find("#cardpublish_view #appstatusrgt").find(".zpl_crd").append('<div class="zpl_crdcnt"> <div class="zpl_secn"> <div class="zpl_parevwstchat"> <div id="esignpie" style="width: 180px;height: 180px;" data-highcharts-chart="7"></div> <ul class="zpl_cylesta" id="esignPieStatus"> </ul> </div> </div> <div class="zpl_secn"> <div> <div class="wd100_per"> <div> <p><a class="u-link" onclick="PMSESign.showAppraisalEsignPages(\''+_data.cycleData.configId+"')\">"+ZPI18N.getString("zp.clickhere")+"</a>  "+ZPI18N.getString("zp.paesign.toviewapprlettersignstatus")+"</p> </div> </div> </div> </div> </div>");let html='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.paesign.yettosend")+"</em><b>"+letterNotSent+"</b></li>";html+='<li><span class="zpl_dots grnbg1"></span> <em>'+ZPI18N.getString("zp.paesign.signed")+"</em><b>"+completed+"</b></li>",html+='<li><span class="zpl_dots ylwbg"></span> <em>'+ZPI18N.getString("zp.pending")+"</em><b>"+esignpending+"</b></li>",html+=0!=partiallyCompleted?'<li><span class="zpl_dots orgbg"></span> <em>'+ZPI18N.getString("zp.paesign.docpartiallysigned")+" </em><b>"+partiallyCompleted+"</b></li>":"",html+=0!=recalled?'<li><span class="zpl_dots grybdr1"></span> <em>'+ZPI18N.getString("zp.recalled")+"</em><b>"+recalled+"</b></li>":"",html+=0!=expired?'<li><span class="zpl_dots redbglit"></span> <em>'+ZPI18N.getString("zp.expired")+"</em><b>"+expired+"</b></li>":"",html+=0!=decliend?'<li><span class="zpl_dots red"></span> <em>'+ZPI18N.getString("zp.declined")+"</em><b>"+decliend+"</b></li>":"",_sliderDiv.find("#esignPieStatus").append(html);let total=letterNotSent+esignpending+completed+partiallyCompleted+recalled+expired+decliend;PMSV2Cycle.constructesignPieChart(total,letterNotSent,esignpending,completed,partiallyCompleted,recalled,expired,decliend,!0,!0)}else if(_data.cycleData.isAppraisalLetterEnabled){_sliderDiv.find("#cardpublish_view #appstatusrgt").find(".zpl_crd").append('<div class="zpl_secn" style="padding-left: 25px;"><div class="wd100_per"><h4>'+ZPI18N.getString("zp.paesign.appraisalletters")+"</h4></div></div>"),_sliderDiv.find("#cardpublish_view #appstatusrgt").find(".zpl_crd").append('<div class="zpl_crdcnt"> <div class="zpl_secn"> <div class="zpl_parevwstchat"> <div id="esignpie" style="width: 180px;height: 180px;" data-highcharts-chart="7"></div> <ul class="zpl_cylesta" id="esignPieStatus"> </ul> </div> </div> <div class="zpl_secn"> <div> <div class="wd100_per"> <div> <p><a class="u-link" onclick="PMSESign.showAppraisalEsignPages(\''+_data.cycleData.configId+"')\">"+ZPI18N.getString("zp.clickhere")+"</a>  "+ZPI18N.getString("zp.paesign.toviewapprletterstatus")+"</p> </div> </div> </div> </div> </div>");let html='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.paesign.yettosend")+"</em><b>"+letterNotSent+"</b></li>";html+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.paesign.lettersent")+"</em><b>"+completed+"</b></li>",_sliderDiv.find("#esignPieStatus").append(html);let total=letterNotSent+completed;PMSV2Cycle.constructesignPieChart(total,letterNotSent,esignpending,completed,partiallyCompleted,recalled,expired,decliend,!0,!1)}}},percentageVal:function(val,total,otherval){var percentage=0;if(0==val)percentage=0;else{var percentage1=100*otherval/total;((percentage=100*val/total)<10||percentage1<10)&&(percentage=percentage<10?10:90,percentage=percentage1<10?90:10)}return percentage},constructesignPieChart:function(total,letterNotSent,esignpending,completed,partiallyCompleted,recalled,expired,decliend,isAppraisalLetterEnabled,isAppraisalEsignEnabled){Layout.Page.container.find("#esignpie").highcharts({chart:{plotBackgroundColor:null,plotBorderWidth:0,plotShadow:!1,margin:[0,0,0,0],spacingTop:0,spacingBottom:0,spacingLeft:0,spacingRight:0},colors:(()=>{let color=new Array;return color.push("#CCC"),isAppraisalEsignEnabled?(color.push("#0EBC6B"),color.push("#F1A82F"),partiallyCompleted>0&&color.push("#FF832B"),recalled>0&&color.push("#bfbfbf"),expired>0&&color.push("#ffd9da"),decliend>0&&color.push("#EC5158")):color.push("#0088ff"),color})(),title:{text:total+"<br> "+ZPI18N.getString("zp.total"),align:"center",verticalAlign:"middle",y:1},credits:{enabled:!1},tooltip:{backgroundColor:"rgba(255,255,255,0)",pointFormat:" <b>{point.custom}</b>"},plotOptions:{pie:{size:"100%",dataLabels:{enabled:!1,distance:-50,style:{fontWeight:"bold",color:"white"}},startAngle:0,endAngle:360,center:["50%","50%"]},series:{cursor:"pointer",point:{events:{click:function(){PMSV2Cycle.esignChartOnclick(this.series.userOptions.data,this.options.name)}}}}},exporting:{enabled:!1},series:[{type:"pie",name:"Appraisal",innerSize:"85%",data:(()=>{let data=new Array,Obj={};return Obj.name=ZPI18N.getString("zp.paesign.yettosend"),Obj.y=PMSV2Cycle.percentageVal(letterNotSent,total,total-letterNotSent),Obj.custom=letterNotSent,data.push(Obj),isAppraisalEsignEnabled?((Obj={}).name=ZPI18N.getString("zp.paesign.signed"),Obj.y=PMSV2Cycle.percentageVal(completed,total,total-completed),Obj.custom=completed,data.push(Obj),(Obj={}).name=ZPI18N.getString("zp.pending"),Obj.y=PMSV2Cycle.percentageVal(esignpending,total,total-esignpending),Obj.custom=esignpending,data.push(Obj),partiallyCompleted>0&&((Obj={}).name=ZPI18N.getString("zp.paesign.docpartiallysigned"),Obj.y=PMSV2Cycle.percentageVal(partiallyCompleted,total,total-partiallyCompleted),Obj.custom=partiallyCompleted,data.push(Obj)),recalled>0&&((Obj={}).name=ZPI18N.getString("zp.recalled"),Obj.y=PMSV2Cycle.percentageVal(recalled,total,total-recalled),Obj.custom=recalled,data.push(Obj)),expired>0&&((Obj={}).name=ZPI18N.getString("zp.expired"),Obj.y=PMSV2Cycle.percentageVal(expired,total,total-expired),Obj.custom=expired,data.push(Obj)),decliend>0&&((Obj={}).name=ZPI18N.getString("zp.declined"),Obj.y=PMSV2Cycle.percentageVal(decliend,total,total-decliend),Obj.custom=decliend,data.push(Obj))):((Obj={}).name=ZPI18N.getString("zp.paesign.lettersent"),Obj.y=PMSV2Cycle.percentageVal(completed,total,total-completed),Obj.custom=completed,data.push(Obj)),data})()}]})},esignChartOnclick:function(data,name){name==ZPI18N.getString("zp.completed")?PMSESign.showAppraisalEsignPages(PMSV2Cycle.appStatusSliderObj.configId,6):name==ZPI18N.getString("zp.pending")?PMSESign.showAppraisalEsignPages(PMSV2Cycle.appStatusSliderObj.configId,3):name==ZPI18N.getString("zp.paesign.docpartiallysigned")?PMSESign.showAppraisalEsignPages(PMSV2Cycle.appStatusSliderObj.configId,5):name==ZPI18N.getString("zp.recalled")?PMSESign.showAppraisalEsignPages(PMSV2Cycle.appStatusSliderObj.configId,7):name==ZPI18N.getString("zp.expired")?PMSESign.showAppraisalEsignPages(PMSV2Cycle.appStatusSliderObj.configId,8):name==ZPI18N.getString("zp.declined")?PMSESign.showAppraisalEsignPages(PMSV2Cycle.appStatusSliderObj.configId,9):name==ZPI18N.getString("zp.paesign.yettosend")?PMSESign.showAppraisalEsignPages(PMSV2Cycle.appStatusSliderObj.configId,12):name==ZPI18N.getString("zp.paesign.lettersent")&&PMSESign.showAppraisalEsignPages(PMSV2Cycle.appStatusSliderObj.configId,11)},getPublishedUserList:function(configId){let sliderTab=new Tab("publishedUserDetails",function(){});PMSV2Cycle.unpublishEmpSlider=new sliderModal(ZPI18N.getString("zp.publishedemployee"),sliderTab),PMSV2Cycle.unpublishEmpSlider.ftExtraCls="zpl_DNI",PMSV2Cycle.unpublishEmpSlider.setCloseCallback(function(){PMSV2Cycle.unPublishStIndx=1,PMSV2Cycle.unPublishSelConfigId=null,PMSV2Cycle.unpublishEmpSlider.remove()}),PMSV2Cycle.unpublishEmpSlider.construct(),$(PMSV2Cycle.unpublishEmpSlider.sliderDiv).find("#cardpublishedUserDetails").html(ZPeople.LOADING_HTML),PMSV2Cycle.unPublishStIndx=1,PMSV2Cycle.unPublishSelConfigId=null,PMSV2Cycle.getPublishedUserConstruct(configId,!1),PMSV2Cycle.selectedUnPublishUserCnt=0},getPublishedUserConstruct:function(configId,isFireScroll){Layout.Page.container;let _sliderDiv=$(PMSV2Cycle.unpublishEmpSlider.sliderDiv),resultData="";null==PMSV2Cycle.unPublishSelConfigId&&(PMSV2Cycle.unPublishSelConfigId=configId);let params={mode:"getPublishedUserDetails",configId:configId,startIndex:PMSV2Cycle.unPublishStIndx,conreqcsr:csrfToken};if($.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(data){resultData=data}}),""!=resultData&&void 0!=resultData&&resultData.length>0){PMSV2Cycle.unPublishStIndx+=resultData.length;let row="";if(isFireScroll||(row+='<div class="zpl_crd"> <div class="zpl_crdcnt"> <div class="zpl_tblres"> <table class="zpl_tbl wd100_per" id="publishedUserDetailsTable">',row+='<thead><tr> <th style="width: 5%;"><div class="zcheckbox" id="unpublishAllChk" onclick="PMSV2Cycle.enableAllUnPublishUser(this)"><input id="unpublishAllChkInp" type="checkbox" name="check" class="zcheckbox__helper"><label for="unpublishAllChkInp" class="zcheckbox__label"></label></div> ',row+='</th><th><button type="button" class="zlabel zlabel--blue  zlabel--outline disabled" id="unpublishAllbtn" onclick="PMSV2Cycle.unPublishAllUser()">'+ZPI18N.getString("zp.unpublishall")+'</button></th><th width="220"></th></tr></thead>',row+='<tbody id="publishedUserDetailsList">'),$.each(resultData,function(index,data){data.deptName=void 0==data.deptName?"":data.deptName,data.desName=void 0==data.desName?"":data.desName,row+='<tr id="'+data.erecNo+'"><td><div class="zcheckbox" ><input id="check_'+data.erecNo+'" onclick="PMSV2Cycle.selectUnPublisUser(this)" type="checkbox" name="check" class="zcheckbox__helper"><label for="check_'+data.erecNo+'" class="zcheckbox__label"></label></div></td>',row+='<td><div class="zpl_em"><div class="zpl_emimg"><img src="'+data.empPhoto+'"></div><div class="zpl_emdts"><div><em>'+data.empId+"&nbsp;-&nbsp;</em><b>"+data.empName+"</b></div><em>"+data.desName+"&nbsp;-&nbsp;"+data.deptName+"</em></div></div></td>",row+='<td><div class="zpl_hvr"><button type="button" class="zlabel zlabel--blue  zlabel--outline" onclick="PMSV2Cycle.unpublishUser(\''+data.erecNo+"')\">"+ZPI18N.getString("zp.lms.course.unpublish")+"</button></div></td></tr>"}),row+=isFireScroll?"":"</tbody></div></div></div></div>",isFireScroll?_sliderDiv.find("#publishedUserDetailsList").append(row):_sliderDiv.find("#cardpublishedUserDetails").html(row),resultData.length>0&&100==resultData.length)new FireScrollBack(PMSV2Cycle.unpublishFireScrollCallback,PMSV2Cycle.unpublishEmpSlider.sliderDiv.find("#cardpublishedUserDetails"),"unPublishLst");else delete settingsPage.fireScrollObj.unPublishLst}else isFireScroll||PMSOperationCommon.setNoData(_sliderDiv.find("#cardpublishedUserDetails"),ZPI18N.getString("zp.lookup.norecfound"),"zp_nd_record",null,null,null)},unpublishFireScrollCallback:function(){PMSV2Cycle.getPublishedUserConstruct(PMSV2Cycle.unPublishSelConfigId,!0)},unPublishAllUser:function(){let userArry=[];$(PMSV2Cycle.unpublishEmpSlider.sliderDiv).find("#publishedUserDetailsList").find("tr").each(function(){$(this).find('input[type="checkbox"]').prop("checked")&&userArry.push($(this).attr("id"))}),PMSV2Cycle.unPublishReqConfirm(userArry)},unpublishUser:function(uerId){let userArry=[];userArry.push(uerId),PMSV2Cycle.unPublishReqConfirm(userArry)},enableAllUnPublishUser:function(obj){Layout.Page.container;let _sliderDiv=$(PMSV2Cycle.unpublishEmpSlider.sliderDiv);$(obj).children("input").prop("checked")?(_sliderDiv.find("#publishedUserDetailsList").find("tr").find('input[type="checkbox"]').prop("checked",!0),_sliderDiv.find("#unpublishAllbtn").removeClass("disabled")):(_sliderDiv.find("#publishedUserDetailsList").find("tr").find('input[type="checkbox"]').prop("checked",!1),_sliderDiv.find("#unpublishAllbtn").addClass("disabled"))},unPublishReqConfirm:function(userArry){PMSV2Cycle.unPublishReqAccess(userArry)},unPublishReqAccess:function(userArry){let _sliderDiv=$(PMSV2Cycle.unpublishEmpSlider.sliderDiv),configId=$(PMSV2Cycle.appStatusSliderObj.sliderDiv).find("#configId").val(),params={mode:"unpublishRatingforUser",configId:configId,userErecnoArr:JSON.stringify(userArry),conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){void 0!=resultData.msg&&"success"==resultData.msg?(ZPeople.Message.success(ZPI18N.getString("zp.reviewunPublishsucess")),PMSV2Cycle.unPublishStIndx=1,PMSV2Cycle.selectedUnPublishUserCnt=0,_sliderDiv.find("#publishedUserDetailsList").html(""),PMSV2Cycle.getPublishedUserConstruct(configId,!0),PMSV2Cycle.processStatusView(configId,PMSV2Cycle.appraisalCycleStatus,"publishdata"),void 0!=resultData.unPublishNotAllowedList&&resultData.unPublishNotAllowedList.length>0&&PMSESign.openEsignRecallSlider(resultData,params,!1)):void 0!=resultData.msg&&"unpublish_esign_Failed"==resultData.msg?PMSESign.openEsignRecallSlider(resultData,params,!1):ZPeople.Message.warning(ZPI18N.getString("zp.permissiondenied"))})},selectUnPublisUser:function(obj){Layout.Page.container;let _sliderDiv=$(PMSV2Cycle.unpublishEmpSlider.sliderDiv),totalUser=_sliderDiv.find("#publishedUserDetailsList").find("tr").length;$(obj).prop("checked")?(_sliderDiv.find("#unpublishAllbtn").removeClass("disabled"),PMSV2Cycle.selectedUnPublishUserCnt+=1,totalUser==PMSV2Cycle.selectedUnPublishUserCnt&&_sliderDiv.find("#unpublishAllChk").find('input[type="checkbox"]').prop("checked",!0)):(PMSV2Cycle.selectedUnPublishUserCnt-=1,_sliderDiv.find("#unpublishAllChk").find('input[type="checkbox"]').prop("checked",!1),0==PMSV2Cycle.selectedUnPublishUserCnt&&_sliderDiv.find("#unpublishAllbtn").addClass("disabled"))},publishthistouser:function(objel,configId,usererecno,mode){if(void 0===usererecno||""===usererecno){if(!(PMSV2Cycle.pendingempSelf.length>0))return ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.nouserselected")),!1;usererecno=JSON.stringify(PMSV2Cycle.pendingempSelf)}else if("manageAppraiseeData"==mode){if(!(usererecno.length>0))return ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.nouserselected")),!1;usererecno=JSON.stringify(usererecno)}else{var usererecnoArr=new Array;usererecnoArr[0]=usererecno,usererecno=JSON.stringify(usererecnoArr)}let isShowAppraisalLetterPublishMsg=!1;if(isShowAppraisalLetterPublishMsg="manageAppraiseeData"==mode?AppraisalView[AppraisalView.getAppraisalViewMode()._mode].isAppraisalLetterEnabled&&0==AppraisalView[AppraisalView.getAppraisalViewMode()._mode].appraisalLetterSentActionType:PMSESign.isAppraisalLetterEnabled(PMSOperation.temp,configId)&&0==PMSESign.isAppraisalletterSentActionType(PMSOperation.temp,configId),void 0!==usererecno){var infoPopUp=new InfoAlertMessage;infoPopUp.title="";var _msg=ZPI18N.getString("zp.publishcnfmsg");infoPopUp.despcription=_msg,infoPopUp.centerHtml=ZPI18N.getString("zp.pareviewtemplate.publishinfomsg",["PMSPreview.showAppraiseeViewPreview('"+configId+"')"])+" "+(isShowAppraisalLetterPublishMsg?"<br><br>"+ZPI18N.getString("zp.paesign.publishinfomsg"):""),infoPopUp._centerDN="",infoPopUp.yesButtonText=ZPI18N.getString("zp.ok"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){var params={mode:"publishratingtouser",userEreco:usererecno,conreqcsr:csrfToken,cycleId:configId,formId:PMSOperation.performanceappFormDtl.formId,isFromNewUI:!0};$.post("/performanceConfig.zp",params,function(resultData){var parseObj=resultData;parseObj.length>0&&$.each(parseObj,function(index,data){if("published"===data.msg||"success"===data.msg){if(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.ratingpublishsuccess")),"cycle view"==mode)PMSV2Cycle.processStatusView(configId,PMSV2Cycle.appraisalCycleStatus,"publishdata");else if("manageAppraiseeData"==mode){const{_mode:_mode}=AppraisalView.getAppraisalViewMode();var divId=settingsPage.container.find("#manageDataStatus .zpl_act").attr("id");AppraisalView.cycleManageData.checkBoxAllSelect(null),AppraisalView.cycleManageData.showAppraiserReporteeView(AppraisalView.cycleManageData[_mode].selectedAppraiser,divId,!0)}}else"publish_err"===data.msg||"normalizationstart"===data.msg?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.appraisalpublisherr")):"server_error"===data.msg?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.ratingnotpublished")):"cycleclose_error"===data.msg?ZPeople.Message.showFailureMsg(data.message):"esignpublisherror"==data.msg?ZPeople.Message.failure(ZPI18N.getString("zpp.somethingwentwrong")):"INVAILD_ESIGN_FIELD_CONFIGURATION"==data.msg?ZPeople.Message.failure(ZPI18N.getString("zp.paesign.signerfieldmissmatch")):"esignpublishscheduled"==data.msg?ZPeople.Message.success(ZPI18N.getString("zp.paesign.esignpublishscheduled")):"noesignconfig"==data.msg&&ZPeople.Message.success(ZPI18N.getString("zp.paesign.noesignconfiguration"))})})},infoPopUp.show()}else ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.nouserselected"))},constructHikeRgt:function(_data){let _sliderDiv=$(PMSV2Cycle.appStatusSliderObj.sliderDiv),_hikeData=_data.hike,_budgetapproval=_data.budgetapproval,cyStatus=_data.cycleData.periodStatus,_htm="";if(void 0!==_hikeData&&""!=_hikeData){var extraDetails=!1;_htm+='<div class="zpl_crd zpl_act" style="height: 102%;"><div class="zpl_crdcnt">',_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="hkPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.completed")+"</em><b>"+_hikeData.completedcount+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.pending")+"</em><b>"+_hikeData.pendingcount+"</b></li></ul>",_htm+="</div></div>",5!==cyStatus&&_hikeData.pendingcount>0&&(_htm+='<div class="zpl_secn"><div><div class="zpl_gbox wd100_per"><div><h4>'+ZPI18N.getString("zp.reminder.remind")+"</h4><p>"+ZPI18N.getString("zp.formssubmitreminder",new Array(PMSV2Cycle.SALARYHIKENAME))+"</p></div>",_htm+='<div class="zpl_idiv"></div><div class="zpl_idiv"><button onclick="PMSV2Cycle.showReminderSlider(3, \''+_data.cycleData.configId+"','"+_hikeData.pendingcount+'\');" type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.reminder.remind")+"</button></div></div></div></div>"),void 0===_budgetapproval||""==_budgetapproval||0==_budgetapproval.completedcount&&0==_budgetapproval.pendingcount&&0==_budgetapproval.rejectedcount||(_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="hkAprPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.approved")+"</em><b>"+_budgetapproval.completedcount+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.pending")+"</em><b>"+_budgetapproval.pendingcount+"</b></li>",_htm+='<li><span class="zpl_dots red"></span> <em>'+ZPI18N.getString("zp.rejected")+"</em><b>"+_budgetapproval.rejectedcount+"</b></li></ul>",_htm+="</div></div>"),_hikeData.completedcount>0&&(_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="hkPubPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.pushed")+"</em><b>"+_hikeData.published+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.unpushed")+"</em><b>"+_hikeData.notpublished+"</b></li></ul>",_htm+="</div></div>",void 0!=_hikeData.extraMsg&&null!=_hikeData.extraMsg?(extraDetails=!0,_htm+='<div class="zpl_secn"><div><div class="wd100_per"><div><p>'+_hikeData.extraMsg+"</p></div> </div></div></div>",void 0!=_hikeData.showHikeAutoPushErrorMsg&&_hikeData.showHikeAutoPushErrorMsg&&(_htm+='<div class="zpl_secn"><div><div class="wd100_per"><div><p class="red">'+ZPI18N.getString("zp.hikeautopushnothappened")+"</p></div> </div></div></div>")):_hikeData.isSalaryDataSourceCompensation?_htm+='<div class="zpl_secn"> <div> <div class="zpl_gbox wd100_per"> <div class="zpl_idiv"> <button type="button" id="hikepublishbtn" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.performance.pushtocompensation")+"</button> </div> </div> </div> </div>":_htm+='<div class="zpl_secn"> <div> <div class="zpl_gbox wd100_per"> <div class="zpl_idiv"> <button type="button" id="hikepublishbtn" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.push")+"</button> </div> </div> </div> </div>",_htm+='<div class="zpl_secn"> <div> <div class="zpl_gbox wd100_per"> <div class="zpl_idiv"> <button type="button" id="hikestatusview" onclick="PMSOperation.showUserManagement(\'compensationsalaryhikestatus\',\''+PMSV2Cycle.REVIEWSTATUS_DATA.cycleData.configId+'\');" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.viewhikestatus")+"</button> </div> </div> </div> </div>"),_htm+="</div> </div>",_sliderDiv.find("#cardpublish_view #appstatusrgt").empty().append($(_htm)),extraDetails||(1==_hikeData.isPublished||0==_hikeData.count?(_sliderDiv.find("#hikepublishbtn").off("click"),_sliderDiv.find("#hikepublishbtn").prop("disabled",!0)):_sliderDiv.find("#hikepublishbtn").on("click",function(){PMSV2Cycle.publishHiketoUser(_hikeData.budgetId,_data.cycleData.configId,"hikeData")}))}void 0!==_hikeData&&""!=_hikeData&&(PMSV2Cycle.constructNonApprovalPieChart("hkPie",PMSV2Cycle.SALARYHIKENAME,_hikeData.total,_hikeData.completedcount,_hikeData.pendingcount),_hikeData.completedcount>0&&PMSV2Cycle.constructNonApprovalPieChart("hkPubPie",PMSV2Cycle.HIKENAME+" "+ZPI18N.getString("zp.pushed"),parseInt(_hikeData.published)+parseInt(_hikeData.notpublished),_hikeData.published,_hikeData.notpublished),void 0===_budgetapproval||""==_budgetapproval||0==_budgetapproval.completedcount&&0==_budgetapproval.pendingcount&&0==_budgetapproval.rejectedcount||PMSV2Cycle.constructApprovalPieChart("hkAprPie",ZPI18N.getString("zp.approvall"),_budgetapproval.total,_budgetapproval.completedcount,_budgetapproval.pendingcount,_budgetapproval.rejectedcount))},constructPAFormHikeRgt:function(_data){let _sliderDiv=$(PMSV2Cycle.appStatusSliderObj.sliderDiv),_formhikeData=_data.SalaryHikeFormStatus,_htm="";void 0!==_formhikeData&&""!=_formhikeData&&(_htm+='<div class="zpl_crd zpl_act" style="height: 102%;"><div class="zpl_crdcnt">',_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="fhkPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.completed")+"</em><b>"+_formhikeData.salaryGivenCount+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.pending")+"</em><b>"+(_data.performance.total-_formhikeData.salaryGivenCount)+"</b></li></ul>",_htm+="</div></div>",_formhikeData.salaryGivenCount>0&&(_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="fhkPubPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.pushed")+"</em><b>"+_formhikeData.salaryPublishedCount+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.unpushed")+"</em><b>"+_formhikeData.salaryNotPublishedCount+"</b></li></ul>",_htm+="</div></div>",void 0!=_data.isSalaryDataSourceCompensation&&_data.isSalaryDataSourceCompensation?_htm+='<div class="zpl_secn"> <div> <div class="zpl_gbox wd100_per"> <div class="zpl_idiv"> <button type="button" id="formhikepublishbtn" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.performance.pushtocompensation")+"</button> </div> </div> </div> </div>":_htm+='<div class="zpl_secn"> <div> <div class="zpl_gbox wd100_per"> <div class="zpl_idiv"> <button type="button" id="formhikepublishbtn" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.push")+"</button> </div> </div> </div> </div>",_htm+='<div class="zpl_secn"> <div> <div class="zpl_gbox wd100_per"> <div class="zpl_idiv"> <button type="button" id="hikestatusview" onclick="PMSOperation.showUserManagement(\'compensationsalaryhikestatus\',\''+PMSV2Cycle.REVIEWSTATUS_DATA.cycleData.configId+'\');" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.viewhikestatus")+"</button> </div> </div> </div> </div>"),_sliderDiv.find("#cardpublish_view #appstatusrgt").empty().append($(_htm)),_formhikeData.salaryGivenCount>0&&_sliderDiv.find("#formhikepublishbtn").on("click",function(){PMSV2Cycle.publishFormHiketoUser()})),void 0!==_formhikeData&&""!=_formhikeData&&(PMSV2Cycle.constructNonApprovalPieChart("fhkPie",PMSV2Cycle.SALARYHIKENAME,_data.performance.total,_formhikeData.salaryGivenCount,_data.performance.total-_formhikeData.salaryGivenCount),_formhikeData.salaryGivenCount>0&&PMSV2Cycle.constructNonApprovalPieChart("fhkPubPie",PMSV2Cycle.HIKENAME+" "+ZPI18N.getString("zp.pushed"),_data.performance.total,_formhikeData.salaryPublishedCount,_formhikeData.salaryNotPublishedCount))},publishFormHiketoUser:function(){PMSV2Cycle.getHikeTerms();var infoPopUp=new InfoAlertMessage;infoPopUp.title="";var _msg=ZPI18N.getString("zp.suretopushhike",[ZSEC.Encoder.encodeForHTML(ZPeople.decodeTxt(PMSV2Cycle.HIKENAME))]);infoPopUp.despcription=_msg,infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){var succmsg="",status=Number(PMSV2Cycle.appraisalCycleStatus);if(5==status)return ZPeople.Message.failure(ZPI18N.getString("zp.processperiodclosedmsg")),!1;$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"publishFormHikeToUser",status:status,configId:PMSV2Cycle.REVIEWSTATUS_DATA.cycleData.configId,conreqcsr:csrfToken},success:function(data){succmsg=data}}),"success"==succmsg.msg?(ZPeople.Message.success(ZPI18N.getString("zp.hikepushedsuccesfully",[ZPeople.escapeHtml(PMSV2Cycle.HIKENAME)])),PMSV2Cycle.processStatusView(PMSV2Cycle.REVIEWSTATUS_DATA.cycleData.configId,PMSV2Cycle.appraisalCycleStatus,"formhikeData")):"partiallysuccess"==succmsg.msg?(ZPeople.Message.success(ZPI18N.getString("zp.performance.hikepushedpartially")),PMSV2Cycle.processStatusView(PMSV2Cycle.REVIEWSTATUS_DATA.cycleData.configId,PMSV2Cycle.appraisalCycleStatus,"formhikeData")):"compdisabled"==succmsg.msg?ZPeople.Message.warning(ZPI18N.getString("zp.performance.compensationnotenabled")):"conflictusers"==succmsg.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.performance.errorwhilepushinghike")),PMSV2Cycle.processStatusView(PMSV2Cycle.REVIEWSTATUS_DATA.cycleData.configId,PMSV2Cycle.appraisalCycleStatus,"formhikeData")):"nousertopublish"==succmsg.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.performance.nouseravaforhikepush")),PMSV2Cycle.processStatusView(PMSV2Cycle.REVIEWSTATUS_DATA.cycleData.configId,PMSV2Cycle.appraisalCycleStatus,"formhikeData")):"cycleclosed"==succmsg.msg?ZPeople.Message.warning(ZPI18N.getString("zp.processperiodclosedmsg")):"cannot publish hike"==succmsg.msg?ZPeople.Message.failure("Unable to publish hike"):"SERVER_ERROR"==succmsg.msg?ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")):ZPeople.Message.failure("Permission denied")},infoPopUp.show()},publishHiketoUser:function(budgetId,configID,mode){PMSV2Cycle.getHikeTerms();var infoPopUp=new InfoAlertMessage;infoPopUp.title="";var _msg=ZPI18N.getString("zp.suretopushhike",[ZSEC.Encoder.encodeForHTML(ZPeople.decodeTxt(PMSV2Cycle.HIKENAME))]);infoPopUp.despcription=_msg,infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){var succmsg="",status=Number(PMSV2Cycle.appraisalCycleStatus);if(5==status)return ZPeople.Message.warning(ZPI18N.getString("zp.processperiodclosedmsg")),!1;$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"publishHikeToUser",status:status,budgetId:budgetId,conreqcsr:csrfToken},success:function(data){succmsg=data}}),"success"==succmsg.msg?(ZPeople.Message.success(ZPI18N.getString("zp.hikepushedsuccesfully",[PMSV2Cycle.HIKENAME])),PMSV2Cycle.processStatusView(configID,PMSV2Cycle.appraisalCycleStatus,mode)):"partiallysuccess"==succmsg.msg?(ZPeople.Message.success(ZPI18N.getString("zp.performance.hikepushedpartially")),PMSV2Cycle.processStatusView(configID,PMSV2Cycle.appraisalCycleStatus,mode)):"compdisabled"==succmsg.msg?ZPeople.Message.warning(ZPI18N.getString("zp.performance.compensationnotenabled")):"conflictusers"==succmsg.msg?(ZPeople.Message.warning(ZPI18N.getString("zp.performance.errorwhilepushinghike")),PMSV2Cycle.processStatusView(configID,PMSV2Cycle.appraisalCycleStatus,mode)):"nousertopublish"==succmsg.msg?(ZPeople.Message.success(ZPI18N.getString("zp.performance.nouseravaforhikepush")),PMSV2Cycle.processStatusView(configID,PMSV2Cycle.appraisalCycleStatus,mode)):"cycleclosed"==succmsg.msg?ZPeople.Message.warning(ZPI18N.getString("zp.processperiodclosedmsg")):"cannot publish hike"==succmsg.msg?ZPeople.Message.failure("Unable to publish hike"):"SERVER_ERROR"==succmsg.msg?ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")):ZPeople.Message.failure("Permission denied")},infoPopUp.show()},constructSelfRgt:function(_data){let _sliderDiv=$(PMSV2Cycle.appStatusSliderObj.sliderDiv),_selfAppraisal=_data.selfAppraisal,cyStatus=_data.cycleData.periodStatus,_htm="";if(void 0!==_selfAppraisal&&""!=_selfAppraisal){let completedpercent=0;_selfAppraisal.completedcount>0&&(completedpercent=100*_selfAppraisal.completedcount/_selfAppraisal.total),_htm+='<div class="zpl_crd zpl_act" style="height: 102%;"><div class="zpl_crdcnt">',_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="selfPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.completed")+"</em><b>"+_selfAppraisal.completedcount+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.pending")+"</em><b>"+_selfAppraisal.pendingcount+"</b></li></ul>",_htm+="</div></div>",5!==cyStatus&&_selfAppraisal.pendingcount>0&&(_htm+='<div class="zpl_secn"><div><div class="zpl_gbox wd100_per"><div><h4>'+ZPI18N.getString("zp.reminder.remind")+"</h4><p>"+ZPI18N.getString("zp.cyclestatus.selfreminderdesc")+"</p></div>",_htm+='<div class="zpl_idiv"></div><div class="zpl_idiv"><button onclick="PMSV2Cycle.showReminderSlider(0, \''+_data.cycleData.configId+"','"+_selfAppraisal.pendingcount+'\');" type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.reminder.remind")+"</button></div></div></div></div>"),_htm+="</div> </div>",_sliderDiv.find("#cardpublish_view #appstatusrgt").empty().append($(_htm)),PMSV2Cycle.constructNonApprovalPieChart("selfPie",PMSCommon.getFormName(PMSCommon.SELF_APPRAISAL_TABLE),_selfAppraisal.total,_selfAppraisal.completedcount,_selfAppraisal.pendingcount)}},constructMultiRgt:function(_data){let _sliderDiv=$(PMSV2Cycle.appStatusSliderObj.sliderDiv),_multirater=_data.mrSelection,cyStatus=_data.cycleData.periodStatus,_htm="";if(void 0!==_multirater&&""!=_multirater){let __multiRaterApproval=_data.multiRaterApproval,__multiRaterFeedback=_data.multiRaterFeedback,completedpercent=0;if(_multirater.completedcount>0&&(completedpercent=100*_multirater.completedcount/_multirater.total),_htm+='<div class="zpl_crd zpl_act"><div class="zpl_crdcnt">',_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="mrPubPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.cap.selected")+"</em><b>"+_multirater.completedcount+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.unselected")+"</em><b>"+_multirater.pendingcount+"</b></li></ul>",_htm+="</div></div>",5!==cyStatus&&_multirater.pendingcount>0&&(_htm+='<div class="zpl_secn"><div><div class="zpl_gbox wd100_per"><div><h4>'+ZPI18N.getString("zp.reminder.remind")+"</h4><p>"+ZPI18N.getString("zp.formssubmitreminder",new Array(PMSV2Cycle.multiraterName))+"</p></div>",_htm+='<div class="zpl_idiv"></div><div class="zpl_idiv"><button onclick="PMSV2Cycle.showReminderSlider(4, \''+_data.cycleData.configId+"','"+_multirater.pendingcount+'\');" type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.reminder.remind")+"</button></div></div></div></div>"),void 0!==__multiRaterApproval&&""!=__multiRaterApproval){let approvalpercent=0;__multiRaterApproval.completedcount>0&&(approvalpercent=100*__multiRaterApproval.completedcount/__multiRaterApproval.total),_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="mrAprPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.approved")+"</em><b>"+__multiRaterApproval.completedcount+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.pending")+"</em><b>"+__multiRaterApproval.pendingcount+"</b></li>",_htm+='<li><span class="zpl_dots red"></span> <em>'+ZPI18N.getString("zp.rejected")+"</em><b>"+__multiRaterApproval.rejectedcount+"</b></li></ul>",_htm+="</div></div>"}if(void 0!==__multiRaterFeedback&&""!=__multiRaterFeedback){let feedbackpercent=0;__multiRaterFeedback.completedcount>0&&(feedbackpercent=100*__multiRaterFeedback.completedcount/__multiRaterFeedback.total),_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="mrFdbkPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.completed")+"</em><b>"+__multiRaterFeedback.completedcount+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.pending")+"</em><b>"+__multiRaterFeedback.pendingcount+"</b></li></ul>",_htm+="</div></div>",5!==cyStatus&&__multiRaterFeedback.pendingcount>0&&(_htm+='<div class="zpl_secn"><div><div class="zpl_gbox wd100_per"><div><h4>'+ZPI18N.getString("zp.reminder.remind")+"</h4><p>"+ZPI18N.getString("zp.formssubmitreminder",new Array(PMSV2Cycle.multiraterName))+"</p></div>",_htm+='<div class="zpl_idiv"></div><div class="zpl_idiv"><button  onclick="PMSV2Cycle.showReminderSlider(2, \''+_data.cycleData.configId+"','"+__multiRaterFeedback.pendingcount+'\');" type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.reminder.remind")+"</button></div></div></div></div>")}_htm+="</div> </div>",_htm+="</div> </div>",_sliderDiv.find("#cardpublish_view #appstatusrgt").empty().append($(_htm)),PMSV2Cycle.constructNonApprovalPieChart("mrPubPie",ZPI18N.getString("zp.selection"),_multirater.total,_multirater.completedcount,_multirater.pendingcount),void 0!==__multiRaterApproval&&""!=__multiRaterApproval&&PMSV2Cycle.constructApprovalPieChart("mrAprPie",ZPI18N.getString("zp.approvall"),__multiRaterApproval.total,__multiRaterApproval.completedcount,__multiRaterApproval.pendingcount,__multiRaterApproval.rejectedcount),void 0!==__multiRaterFeedback&&""!=__multiRaterFeedback&&PMSV2Cycle.constructNonApprovalPieChart("mrFdbkPie",ZPI18N.getString("zp.feedback"),__multiRaterFeedback.total,__multiRaterFeedback.completedcount,__multiRaterFeedback.pendingcount)}},constructPerformanceRgt:function(_data){let _sliderDiv=$(PMSV2Cycle.appStatusSliderObj.sliderDiv),_performance=_data.performance,cyStatus=_data.cycleData.periodStatus,_htm="";if(void 0!==_performance&&""!=_performance){let completedpercent=0;_performance.completedcount>0&&(completedpercent=100*_performance.completedcount/_performance.total),_htm+='<div class="zpl_crd zpl_act" style="height: 102%;"><div class="zpl_crdcnt">',_htm+='<div class="zpl_secn">',_htm+='<div class="zpl_parevwstchat">',_htm+='<div id="paPie" style="width: 180px;height: 180px;"></div>',_htm+='<ul class="zpl_cylesta">',_htm+='<li><span class="zpl_dots blu"></span> <em>'+ZPI18N.getString("zp.completed")+"</em><b>"+_performance.completedcount+"</b></li>",_htm+='<li><span class="zpl_dots"></span> <em>'+ZPI18N.getString("zp.pending")+"</em><b>"+_performance.pendingcount+"</b></li></ul>",_htm+="</div></div>",5!==cyStatus&&_performance.pendingcount>0&&(_htm+='<div class="zpl_secn"><div><div class="zpl_gbox wd100_per"><div><h4>'+ZPI18N.getString("zp.reminder.remind")+"</h4><p>"+ZPI18N.getString("zp.formssubmitreminder",[ZPI18N.getString("zp.reviewerreview")])+"</p></div>",_htm+='<div class="zpl_idiv"></div><div class="zpl_idiv"><button onclick="PMSV2Cycle.showReminderSlider(1, \''+_data.cycleData.configId+"','"+_performance.pendingcount+'\');" type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue">'+ZPI18N.getString("zp.reminder.remind")+"</button></div></div></div></div>"),_htm+="</div> </div>",_sliderDiv.find("#cardpublish_view #appstatusrgt").empty().append($(_htm))}void 0!==_performance&&""!=_performance&&PMSV2Cycle.constructNonApprovalPieChart("paPie",ZPI18N.getString("zp.reviewerreview"),_performance.total,_performance.completedcount,_performance.pendingcount)},getHikeTerms:function(){null!=PMSV2Cycle.HIKENAME&&void 0!=PMSV2Cycle.HIKENAME&&null!=PMSV2Cycle.SALARYHIKENAME&&void 0!=PMSV2Cycle.SALARYHIKENAME&&null!=PMSV2Cycle.ALLOCATEDHIKENAME&&void 0!=PMSV2Cycle.ALLOCATEDHIKENAME&&null!=PMSV2Cycle.PROPOSEDHIKENAME&&void 0!=PMSV2Cycle.PROPOSEDHIKENAME||$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getHikeName",conreqcsr:csrfToken},success:function(data){PMSV2Cycle.setHikeTerms(data)}})},setHikeTerms:function(hikeTerms){ZPI18N.getString("zp.hike");PMSV2Cycle.HIKENAME=null!=hikeTerms.HIKE_NAME&&void 0!=hikeTerms.HIKE_NAME?hikeTerms.HIKE_NAME:ZPI18N.getString("zp.hike"),PMSV2Cycle.SALARYHIKENAME=null!=hikeTerms.SALARY_HIKE_NAME&&void 0!=hikeTerms.SALARY_HIKE_NAME?hikeTerms.SALARY_HIKE_NAME:ZPI18N.getString("zp.appraisalhike"),PMSV2Cycle.ALLOCATEDHIKENAME=null!=hikeTerms.ALLOCATED_HIKE_NAME&&void 0!=hikeTerms.ALLOCATED_HIKE_NAME?hikeTerms.ALLOCATED_HIKE_NAME:ZPI18N.getString("zp.budgeted"),PMSV2Cycle.PROPOSEDHIKENAME=null!=hikeTerms.PROPOSED_HIKE_NAME&&void 0!=hikeTerms.PROPOSED_HIKE_NAME?hikeTerms.PROPOSED_HIKE_NAME:ZPI18N.getString("zp.increment")},constructNonApprovalPieChart:function(elementID,titleNme,total,completedT,pendingT){var obj={chart:{type:"pie",margin:0,plotBorderWidth:0,plotShadow:!1,events:{load:function(event){event.target.reflow()}}},credits:{enabled:!1},exporting:{enabled:!1},title:{text:titleNme+'<br><span style="font-size:13px;color: #000000; display:block; text-align: center; font-weight: bold"> '+ZPI18N.getString("zp.total")+" : "+total+"</span>",verticalAlign:"middle",useHTML:!0,style:{fontSize:"12px"},x:.5*(this.chartWidth-(this.spacingLeft+this.spacingRight)),y:.5*(this.chartHeight-(this.spacingTop+this.spacingBottom)),floating:!0},plotOptions:{pie:{shadow:!1,center:["50%","50%"],size:"100%",allowPointSelect:!1,borderWidth:0,dataLabels:{enabled:!1}},series:{enableMouseTracking:!0,point:{events:{mouseOver:function(){clearTimeout(this.series.chart.title.mouseOutTimeOut),this.series.chart.title.update({text:""})},mouseOut:function(){var thisChart=this;this.series.chart.title.mouseOutTimeOut=setTimeout(function(){thisChart.series.chart.title.update({text:titleNme+'<br><span style="font-size:13px; color: #000000; display:block; text-align: center; font-weight: bold">'+ZPI18N.getString("zp.total")+" : "+total+"</span>"})},550)}}}}},tooltip:{enabled:!0,borderWidth:0,backgroundColor:"none",shadow:!1,style:{fontSize:"12px"},formatter:function(){var tooltipColor=this.point.isremaining?"#000000":this.point.color;this.series.chart.title.update({text:this.point.name+'<br><span style="font-size:13px; color: '+tooltipColor+'; display:block; text-align: center; font-weight: bold">'+this.point.y+"</span>"})},positioner:function(labelWidth,labelHeight){return{x:.5*(this.chart.chartWidth-labelWidth),y:.5*(this.chart.chartHeight-labelHeight)}}},series:[{data:[{y:completedT,color:"#0088ff",name:ZPI18N.getString("zp.completed")},{y:pendingT,color:"#CCC",name:ZPI18N.getString("zp.pending"),isremaining:!0}],innerSize:"85%"}]};Highcharts.chart(elementID,obj)},constructApprovalPieChart:function(elementID,titleNme,total,completedT,pendingT,rejectedT){var obj={chart:{type:"pie",margin:0,plotBorderWidth:0,plotShadow:!1,events:{load:function(event){event.target.reflow()}}},credits:{enabled:!1},exporting:{enabled:!1},title:{text:titleNme+'<br><span style="font-size:13px;color: #000000; display:block; text-align: center; font-weight: bold"> '+ZPI18N.getString("zp.total")+" : "+total+"</span>",verticalAlign:"middle",useHTML:!0,style:{fontSize:"12px"},x:.5*(this.chartWidth-(this.spacingLeft+this.spacingRight)),y:.5*(this.chartHeight-(this.spacingTop+this.spacingBottom)),floating:!0},plotOptions:{pie:{shadow:!1,center:["50%","50%"],size:"100%",allowPointSelect:!1,borderWidth:0,dataLabels:{enabled:!1}},series:{enableMouseTracking:!0,point:{events:{mouseOver:function(){clearTimeout(this.series.chart.title.mouseOutTimeOut),this.series.chart.title.update({text:""})},mouseOut:function(){var thisChart=this;this.series.chart.title.mouseOutTimeOut=setTimeout(function(){thisChart.series.chart.title.update({text:titleNme+'<br><span style="font-size:13px; color: #000000; display:block; text-align: center; font-weight: bold">'+ZPI18N.getString("zp.total")+" : "+total+"</span>"})},550)}}}}},tooltip:{enabled:!0,borderWidth:0,backgroundColor:"none",shadow:!1,style:{fontSize:"12px"},formatter:function(){var tooltipColor=this.point.isremaining?"#000000":this.point.color;this.series.chart.title.update({text:this.point.name+'<br><span style="font-size:13px; color: '+tooltipColor+'; display:block; text-align: center; font-weight: bold">'+this.point.y+"</span>"})},positioner:function(labelWidth,labelHeight){return{x:.5*(this.chart.chartWidth-labelWidth),y:.5*(this.chart.chartHeight-labelHeight)}}},series:[{data:[{y:completedT,color:"#0088ff",name:ZPI18N.getString("zp.approved")},{y:rejectedT,color:"#dc5c5d",name:ZPI18N.getString("zp.rejected")},{y:pendingT,color:"#CCC",name:ZPI18N.getString("zp.pending"),isremaining:!0}],innerSize:"85%"}]};Highcharts.chart(elementID,obj)},openReviewApprToggle:function(){let pageId=settingsPage.container,isNormEnb=PMSV2Cycle.IS_NORM_ENABLED;if(pageId.find('#reviewApprConf [elem="errorMsg"]').remove(),pageId.find("#reviewApprovalEnable").is(":checked")){if(isNormEnb){var infoPopUp=new InfoAlertMessage;infoPopUp.title="",infoPopUp.despcription=ZPI18N.getString("zp.alreadyNormalizationEnableErrMsg"),infoPopUp.yesButtonText=ZPI18N.getString("zp.yes"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.cancelCallback=function(){pageId.find("#reviewApprovalEnable").prop("checked",!1),pageId.find("#reviewApprConf").hide()},infoPopUp.show()}pageId.find("#reviewApprConf").show()}else pageId.find("#reviewApprConf").hide()},showHikeApprConf:function(){let pageId=settingsPage.container;pageId.find('#hkApprConf [elem="errorMsg"]').remove(),pageId.find("#hkApproval").is(":checked")?pageId.find("#hkApprConf").show():pageId.find("#hkApprConf").hide()},prevBtn:function(){let li=settingsPage.container.find(".zpl_mmnulft ul li.zpl_act").prev();PMSV2Cycle.tabSwitchAction(li)},nxtBtn:function(){let li=settingsPage.container.find(".zpl_mmnulft ul li.zpl_act").next();PMSV2Cycle.tabSwitchAction(li)},leftTabConstruct:function(){var pageId=settingsPage.container;let cnt=1,li="";for(let i=0;i<PMSV2Cycle.LEFT_TAB_ARRAY.length;i++){let t=PMSV2Cycle.LEFT_TAB_ARRAY[i],v=PMSV2Cycle.LEFT_TAB_K_V[t];if(void 0!==v){let cls="";1===cnt&&(cls="zpl_act"),li+='<li onclick="PMSV2Cycle.tabSwitchAction(this);" show="'+t+'" class="'+cls+'"><b>'+cnt+"</b><a>"+v+"</a></li>",cnt++}}pageId.find(".zpl_mmnulft ul").html(li),pageId.find("#nwCylbasicDetDiv").addClass("zpl_act"),pageId.find("#prevBtn").addClass("disabled"),pageId.find("#nxtBtn").removeClass("disabled"),-1!==PMSV2Cycle.LEFT_TAB_ARRAY.indexOf("nwCylsaDetDiv")?pageId.find("#nwCylmrSaFldDiv").show():pageId.find("#nwCylmrSaFldDiv").hide(),PMSV2Cycle.fldToPublish()},tabSwitchAction:function(li){let pageId=settingsPage.container,ul=$(li).parents("ul");$(ul).find(".zpl_act").removeClass("zpl_act"),$(li).addClass("zpl_act"),pageId.find(".zpl_mmnurgt").find("[sec=tab].zpl_act").removeClass("zpl_act");let actId=$(li).attr("show");pageId.find(".zpl_mmnurgt #"+actId).addClass("zpl_act"),"nwCylhkDetDiv"==actId&&PMSV2Cycle.isBudgetCalc&&(PMSV2Cycle.CLONE_CYCLE_FLAG||void 0==PMSV2Cycle.SELECTED_TMPL||void 0!=PMSV2Cycle.SELECTED_TMPL&&0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus)&&(PMSV2Cycle.onHikeBasedAction(),PMSV2Cycle.budgetResetCalcFunc());let s=pageId.find(".zpl_mmnulft ul li.zpl_act").attr("show");"nwCylhkDetDiv"==actId&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource&&(PMSV2Cycle.CLONE_CYCLE_FLAG||void 0==PMSV2Cycle.SELECTED_TMPL||void 0!=PMSV2Cycle.SELECTED_TMPL&&0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus)&&PMSV2Cycle.currencyErr(),"nwCylbasicDetDiv"===s?pageId.find("#prevBtn").addClass("disabled"):pageId.find("#prevBtn").removeClass("disabled"),"nwCylPeriodDiv"===s?pageId.find("#nxtBtn").addClass("disabled"):pageId.find("#nxtBtn").removeClass("disabled")},currencyErr:function(){let pageId=settingsPage.container;if(-1==pageId.find("#appCurrSelID").val()){let errobj=pageId.find("#empTypeAppliDiv");$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"}),ZPeopleComponents.select($("#appCurrSelID")).getElement().addClass("ztextbox__error"),pageId.find("#appCurrSelDiv").find(".ztextbox--error__label").remove(),pageId.find("#appCurrSelDiv").append('<span elem="errorMsg" class="ztextbox--error__label">Please select applicable currency</span>'),PMSV2Cycle.tabSwitchAction(pageId.find("[show=nwCylAppliDiv]")),ZPeople.Message.warning(ZPI18N.getString("zp.curreningWarnMsg"))}},postSelTgBtnAction:function(compName,status){if(1===status){let idx=PMSV2Cycle.LEFT_TAB_ARRAY.indexOf(compName+"_hide");PMSV2Cycle.LEFT_TAB_ARRAY[idx]=compName,PMSV2Cycle.leftTabConstruct()}else{let idx=PMSV2Cycle.LEFT_TAB_ARRAY.indexOf(compName);PMSV2Cycle.LEFT_TAB_ARRAY[idx]=compName+"_hide",PMSV2Cycle.leftTabConstruct()}"nwCylsaDetDiv"===compName?(PMSV2Cycle.resetModuleSelection("nwCylsaQtPmTBody"),PMSV2Cycle.resetModuleSelection("nwCylsaQlPmTBody")):"nwCylmrDetDiv"===compName&&(PMSV2Cycle.resetModuleSelection("nwCylmrQtPmTBody"),PMSV2Cycle.resetModuleSelection("nwCylmrQlPmTBody"),PMSV2Cycle.resetModuleSelection("nwCylmrTypeTBody")),PMSV2Cycle.rtgAction(),PMSV2Cycle.moduleRtgSelAction()},resetModuleSelection:function(tBodyID){let pageId=settingsPage.container,trChd=pageId.find("#"+tBodyID).children();$.each(trChd,function(k,v){let tg=$(this).find(".togbutton-js");$(this).find("input[type=checkbox]").each(function(){$(this)[0].checked=!1}),$(tg).ztoggleswitch("switchOff")});let pID=pageId.find("#"+tBodyID).parent("table").attr("id");pageId.find("input[showhidesec="+pID+"]").ztoggleswitch("switchOff")},toggleSelfUploadInput:function(mode){const pageId=settingsPage.container,uploadInput=pageId.find("#tempselffileupload"),selfdocuploadsec=pageId.find("#selfdocuploadsec");uploadInput.is(":checked")?selfdocuploadsec.removeClass("DN"):(selfdocuploadsec.addClass("DN"),PMSV2Cycle.removeFile(mode))},removeFile:function(mode){"cycleguide"==mode?(PMSV2Cycle.GUIDE_FILE=null,PMSV2Cycle.GUIDELINEDOCREMOVED=!0,null!=PMSV2Cycle.GUIDELINESFILEID&&(PMSV2Cycle.GUIDELINESFILEID=null),$("#guidelinesId_afterUpload").html(""),$("#guidelinesId_afterUpload").parent().css("display","none"),$("#guidelinesId_beforeUpload").css("display","block")):"cycleself"==mode&&(PMSV2Cycle.SELF_FILE=null,PMSV2Cycle.SEFLAPPRAISALFILEREMOVED=!0,null!=PMSV2Cycle.SELFAPPFORMFILEID&&(PMSV2Cycle.SELFAPPFORMFILEID=null),$("#selfappFormid_afterUpload").html(""),$("#selfappFormid_afterUpload").parent().css("display","none"),$("#selfappFormid_beforeUpload").css("display","block"))},isTemplateValueChangeCallback:function(leftTabChange){PMSV2Cycle.isCycleAddEditPageValueChangedInit(leftTabChange,!1,"settings/service/performance/appraisaltemplate")},isAppraisalCycleValueChangeCallback:function(leftTabChange){PMSV2Cycle.isCycleAddEditPageValueChangedInit(leftTabChange,!1,"operations/performance/cycle")},isSalaryCycleValueChangeCallback:function(leftTabChange){PMSV2Cycle.isCycleAddEditPageValueChangedInit(leftTabChange,!1,"operations/performance/salarycycle")},isSalaryHikeTabChangeCallback:function(leftTabChange){PMSV2Cycle.isCycleAddEditPageValueChangedInit(leftTabChange,!1,"performance/appraisal/salaryhike")},isCycleAddEditPageValueChangedInit:function(leftTabChange,isAfterSubmit,currentMode,isCycleInit){if(void 0!=isAfterSubmit&&isAfterSubmit||!PMSV2Cycle.isCycleAddEditPageValueChanged(currentMode))void 0!=currentMode&&PMSV2Cycle.destroyCycleConfigPageComponent(currentMode),leftTabChange();else{var infoAlertMessage=new InfoAlertMessage;infoAlertMessage.title="",infoAlertMessage.despcription=ZPI18N.getString("zp.cancelconfmsg"),infoAlertMessage.yesButtonText=ZPI18N.getString("zp.proceed"),infoAlertMessage.callback=function(obj){void 0!=currentMode&&PMSV2Cycle.destroyCycleConfigPageComponent(currentMode),leftTabChange()},infoAlertMessage.show(),void 0!=currentMode&&"operations/performance/cycle"==currentMode&&void 0!=isCycleInit&&isCycleInit&&(PMSOperation.skipHasChange=!0,window.location.hash="#operations/performance/cycle")}},destroyCycleConfigPageComponent:function(currentMode){"settings/service/performance/appraisaltemplate"==currentMode?PMSTmpl.destroyTmplPageComponents():"operations/performance/cycle"==currentMode?PMSV2Cycle.destroyCyclePageComponents():"operations/performance/salarycycle"==currentMode?SalaryHikeV2Cycle.destroyCyclePageComponents():"performance/appraisal/salaryhike"==currentMode&&BudgetView.deleteSalaryhikecomponents()},isCycleAddEditPageValueChanged:function(currentMode){PMSV2Cycle.CYCLE_PAGE_CONTAINER=null,PMSV2Cycle.CYCLE_EDIT_VALUE=null;let isChanged=!1;if(void 0==currentMode&&(currentMode=Layout.Page.currentmode),"settings/service/performance/appraisaltemplate"==currentMode){if(Layout.Page.container.find("#tmplConfigMainDiv").is(":visible")){PMSV2Cycle.IS_TEMPLATE=!0,PMSV2Cycle.CYCLE_PAGE_CONTAINER=Layout.Page.container.find("#tmplConfigMainDiv");let isAdd=void 0==PMSTmpl.EDIT_TMPL_DETAIL||null==PMSTmpl.EDIT_TMPL_DETAIL;PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD=isAdd,isAdd||(PMSV2Cycle.CYCLE_EDIT_VALUE=PMSTmpl.EDIT_TMPL_DETAIL);try{PMSTmpl.isValueChangedInTemplatePage()&&(isChanged=!0)}catch(e){console.log(e),isChanged=!1}}}else if(("operations/performance/cycle"==currentMode||"operations/performance/salarycycle"==currentMode)&&Layout.Page.container.find("#addCycleConfigDiv").is(":visible")){PMSV2Cycle.IS_TEMPLATE=!1,PMSV2Cycle.CYCLE_PAGE_CONTAINER=Layout.Page.container.find("#addCycleConfigDiv"),PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD=!(!PMSV2Cycle.CLONE_CYCLE_FLAG&&PMSV2Cycle.EDIT_CYCLE_FLAG),PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD||(PMSV2Cycle.CYCLE_EDIT_VALUE=PMSV2Cycle.SELECTED_TMPL);try{SalaryHikeV2Cycle.isSalaryHikeCycle?SalaryHikeV2Cycle.isSalaryHikeCycleValueChanged()&&(isChanged=!0):PMSV2Cycle.isAppraisalCycleValueChanged()&&(isChanged=!0)}catch(e){console.log(e),isChanged=!1}}return isChanged},getModuleRatingValue:function(element,divprefix,ratingdivprefix,qusdivPrefix){let obj={},modulelist=["GOALS","KRA","KRA_GOALS","COMPETENCY","QUS_ANS"];for(var index=0;index<modulelist.length;index++){let module=modulelist[index];$(element).find("#"+divprefix+"_"+module).length>0&&(obj[module]={},obj[module].isRatingEnabled="QUS_ANS"!=module&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+ratingdivprefix+"_"+module+"_rtChkBx").is(":checked"),obj[module].isRatingMdty="QUS_ANS"!=module&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+ratingdivprefix+"_"+module+"_rtMdty").is(":checked"),obj[module].isCommentEnabled="QUS_ANS"!=module?$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+ratingdivprefix+"_"+module+"_cmtChkBx").is(":checked"):$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+qusdivPrefix+"_"+module+"_cmtChkBx").is(":checked"),obj[module].isCommentMdty="QUS_ANS"!=module?$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+ratingdivprefix+"_"+module+"_cmtMdty").is(":checked"):$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+qusdivPrefix+"_"+module+"_cmtMdty").is(":checked"))}return obj},getMRTypeModuleRatingValue:function(mrTypeCompdivId,trIdPrefix,inputIdPrefix){let obj={},modulelist=["GOALS","KRA","KRA_GOALS","COMPETENCY","QUS_ANS"],elemetArr=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+mrTypeCompdivId).find("tr");for(var index=0;index<elemetArr.length;index++){let mrtypeelemet=elemetArr[index],id=$(mrtypeelemet).attr("id");mrtypeId=id.replace(trIdPrefix+"_module_choice_","");for(var arr=[],j=0;j<modulelist.length;j++){let module=modulelist[j];$(mrtypeelemet).find('[mrtypename="'+module+'"]').length>0&&$(mrtypeelemet).find("#"+inputIdPrefix+"_"+module+"_"+mrtypeId).is(":checked")&&arr.push(module)}arr.length>0&&(obj[mrtypeId]=arr)}return obj},isJSONObjectValueChanged:function(oldValueKey,newValueObj){if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){if(Object.keys(newValueObj).length>0)return!0}else{let oldValueObj=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]&&null!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]:{};if(Object.keys(oldValueObj).length>0||Object.keys(newValueObj).length>0){if(Object.keys(oldValueObj).length!=Object.keys(newValueObj).length)return!0;if(JSON.stringify(newValueObj)!==JSON.stringify(oldValueObj))return!0}}return!1},isArrayValueChanged:function(oldValueKey,newValueArr,isSort,isPublishField,isRatingSection,isApplicableSection,applicableJSONKey,isMonthSection){let defaultValue=[];if(void 0!=isPublishField&&isPublishField&&PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&PMSV2Cycle.isPARatingEnabled){let compIdObj=PMSV2Cycle.appraisalfields.find(obj=>"RATINGID"===obj.comp_columnname);void 0!=compIdObj&&void 0!=compIdObj.comp_id&&defaultValue.push(compIdObj.comp_id)}if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){if(void 0!=isPublishField&&isPublishField){if(PMSV2Cycle.isPARatingEnabled&&newValueArr.length>1)return!0;if(!PMSV2Cycle.isPARatingEnabled&&newValueArr.length>0)return!0}}else{let oldValArr=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]&&null!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]:defaultValue;if(void 0!=isApplicableSection&&isApplicableSection&&(oldValArr=oldValArr.map(item=>item[applicableJSONKey])),void 0!=isPublishField&&isPublishField&&(oldValArr=oldValArr.filter(item=>item!==PMSV2Cycle.CYCLE_EDIT_VALUE.managerRatingCompId)),oldValArr=[...new Set(oldValArr)],void 0!=isRatingSection&&isRatingSection&&(oldValArr=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE.moduleRatingType[oldValueKey]&&null!=PMSV2Cycle.CYCLE_EDIT_VALUE.moduleRatingType[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE.moduleRatingType[oldValueKey]:defaultValue),void 0!=isMonthSection&&isMonthSection&&(oldValArr=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE.applicableDateType&&void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE.applicableDateType[oldValueKey]&&null!=PMSV2Cycle.CYCLE_EDIT_VALUE.applicableDateType[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE.applicableDateType[oldValueKey]:defaultValue),oldValArr.length>0||newValueArr.length>0){if(oldValArr.length!=newValueArr.length)return!0;let sortedArr1=isSort?oldValArr.slice().sort():oldValArr.slice(),sortedArr2=isSort?newValueArr.slice().sort():newValueArr.slice();for(let i=0;i<sortedArr1.length;i++)if(sortedArr1[i]!=sortedArr2[i])return!0}}return!1},isFileInputChanged:function(NewFileObj,isRemoved){if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){if(null!=NewFileObj&&void 0!=NewFileObj.name)return!0}else if(isRemoved||null!=NewFileObj&&void 0!=NewFileObj.name)return!0;return!1},isInputFieldChanged:function(oldValueKey,newValue,defaultValue,isRatingSection){if(void 0==defaultValue&&(defaultValue=""),PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){if(void 0!=newValue&&newValue!=defaultValue)return!0}else{let oldVal=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]&&null!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]:defaultValue;if(void 0!=isRatingSection&&isRatingSection&&(oldVal=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE.moduleRatingType[oldValueKey]&&null!=PMSV2Cycle.CYCLE_EDIT_VALUE.moduleRatingType[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE.moduleRatingType[oldValueKey]:defaultValue),newValue!=ZPeople.decodeTxt(oldVal))return!0}return!1},isBooleanFieldChanged:function(oldValueKey,newValue,defaultValue,isRatingSection){if(void 0==defaultValue&&(defaultValue=!1),PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){if(void 0!=newValue&&Boolean(newValue)!=Boolean(defaultValue))return!0}else{let oldVal=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]&&null!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]:defaultValue;if(void 0!=isRatingSection&&isRatingSection&&(oldVal=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE.moduleRatingType[oldValueKey]&&null!=PMSV2Cycle.CYCLE_EDIT_VALUE.moduleRatingType[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE.moduleRatingType[oldValueKey]:defaultValue),Boolean(newValue)!=Boolean(oldVal))return!0}return!1},isModuleRatingChanged:function(element,divprefix,ratingdivprefix,qusdivperfix,oldValueKey,newValue){let modulelist=["GOALS","KRA","KRA_GOALS","COMPETENCY","QUS_ANS"];for(var index=0;index<modulelist.length;index++){let module=modulelist[index];if($(element).find("#"+divprefix+"_"+module).length>0){let isRatingEnabled="QUS_ANS"!=module&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+ratingdivprefix+"_"+module+"_rtChkBx").is(":checked"),isRatingMdty="QUS_ANS"!=module&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+ratingdivprefix+"_"+module+"_rtMdty").is(":checked"),isCommentEnabled="QUS_ANS"!=module?$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+ratingdivprefix+"_"+module+"_cmtChkBx").is(":checked"):$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+qusdivperfix+"_"+module+"_cmtChkBx").is(":checked"),isCommentMdty="QUS_ANS"!=module?$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+ratingdivprefix+"_"+module+"_cmtMdty").is(":checked"):$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+qusdivperfix+"_"+module+"_cmtMdty").is(":checked");if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD)return isRatingEnabled||isRatingMdty||isCommentEnabled||isCommentMdty;{let oldObj=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE.ratingCommentStatus[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE.ratingCommentStatus[oldValueKey]:{};if(void 0==oldObj[module])return isRatingEnabled||isRatingMdty||isCommentEnabled||isCommentMdty;{let newValueObj=newValue[module];if("QUS_ANS"!=module&&(Boolean(oldObj[module].isRatingEnabled)!=Boolean(newValueObj.isRatingEnabled)||Boolean(oldObj[module].isRatingMdty)!=Boolean(newValueObj.isRatingMdty)||Boolean(oldObj[module].isCommentEnabled)!=Boolean(newValueObj.isCommentEnabled)||Boolean(oldObj[module].isCommentMdty)!=Boolean(newValueObj.isCommentMdty)))return!0;if("QUS_ANS"==module&&(Boolean(oldObj[module].isCommentEnabled)!=Boolean(newValueObj.isCommentEnabled)||Boolean(oldObj[module].isCommentMdty)!=Boolean(newValueObj.isCommentMdty)))return!0}}}}return!1},isMRtypeModuleRatingChanged:function(divId,trIdPrefix,inputIdPrefix){if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){if($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+divId+" input:checked").length>0)return!0}else{let modulelist=["GOALS","KRA","KRA_GOALS","COMPETENCY","QUS_ANS"],elemetArr=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+divId).find("tr");for(var index=0;index<elemetArr.length;index++){let mrtypeelemet=elemetArr[index],id=$(mrtypeelemet).attr("id");mrtypeId=id.replace(trIdPrefix+"_module_choice_","");let mrTypeEnabledArr=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE.mrEnabledmodule&&void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE.mrEnabledmodule[mrtypeId]?PMSV2Cycle.CYCLE_EDIT_VALUE.mrEnabledmodule[mrtypeId]:[];for(var j=0;j<modulelist.length;j++){let module=modulelist[j];if($(mrtypeelemet).find('[mrtypename="'+module+'"]').length>0)if($(mrtypeelemet).find("#"+inputIdPrefix+"_"+module+"_"+mrtypeId).is(":checked")){if(-1==mrTypeEnabledArr.indexOf(module))return!0}else if(-1!=mrTypeEnabledArr.indexOf(module))return!0}}}},isReviewLevelChanged:function(oldValueKey,newValueArr){let oldValueArr=[];if(obj={},obj.apprType="REPORTING_TO",obj.noOfReportingToLevels=1,oldValueArr.push(obj),PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD||(oldValueArr=[],oldValueArr=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]),oldValueArr.length!=newValueArr.length)return!0;for(var index=0;index<newValueArr.length;index++){let newValObj=newValueArr[index],oldValObj=oldValueArr[index];if(newValObj.apprType!=oldValObj.apprType)return!0;if("REPORTING_TO"==newValObj.apprType){if(newValObj.noOfReportingToLevels!=oldValObj.noOfReportingToLevels)return!0}else if("SELECTED_USER"==newValObj.apprType&&newValObj.erecno!=oldValObj.erecno)return!0}return!1},isRatingValueChanged:function(oldvalueKey,newValueArr,isNormalizationEnabled){let oldValueArr=[];if(oldValueArr[0]={ratingName:ZPI18N.getString("zp.outstanding"),stars:5},oldValueArr[1]={ratingName:ZPI18N.getString("zp.excellent"),stars:4},oldValueArr[2]={ratingName:ZPI18N.getString("zp.satisfactory"),stars:3},oldValueArr[3]={ratingName:ZPI18N.getString("zp.needimprovement"),stars:2},oldValueArr[4]={ratingName:ZPI18N.getString("zp.unsatisfactory"),stars:1},PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD||(oldValueArr=[],oldValueArr=PMSV2Cycle.CYCLE_EDIT_VALUE[oldvalueKey].configArr),oldValueArr.length!=newValueArr.length)return!0;for(var index=0;index<newValueArr.length;index++){let newValObj=newValueArr[index],oldValObj=oldValueArr[index];if((PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD||PMSV2Cycle.IS_TEMPLATE)&&newValObj.ratingName!=oldValObj.ratingName)return!0;if((PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD||PMSV2Cycle.IS_TEMPLATE)&&newValObj.maxRange!=oldValObj.maxRange)return!0;if((PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD||PMSV2Cycle.IS_TEMPLATE)&&newValObj.minRange!=oldValObj.minRange)return!0;if((PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD||PMSV2Cycle.IS_TEMPLATE)&&newValObj.stars!=oldValObj.stars)return!0;if(isNormalizationEnabled)if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){if(""!=newValObj.norPer)return!0}else if(newValObj.norPer!=oldValObj.norPer)return!0}return!1},isApplicableValueChanged:function(isBudgetEnable){var dojSelVal=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#dojCrt").val(),dojSelVal_2=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#dojAppliDiv_2").is(":visible")?$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#dojCrt_2").val():"",applicableDateType=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE.applicableDateType?PMSV2Cycle.CYCLE_EDIT_VALUE.applicableDateType:{};if(!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&Object.keys(applicableDateType).length>0){var oldDOJ_Option=null;if(void 0!=applicableDateType.until&&""!=applicableDateType.until?oldDOJ_Option="DOJ_UNTIL":void 0!=applicableDateType.fromDate&&""!=applicableDateType.fromDate&&void 0!=applicableDateType.toDate&&""!=applicableDateType.toDate&&(oldDOJ_Option="DOJ_FRM_TO"),null!=oldDOJ_Option&&dojSelVal!=oldDOJ_Option&&(""==dojSelVal_2||dojSelVal_2!=oldDOJ_Option))return!0;if(void 0!=applicableDateType.months&&applicableDateType.months.length>0&&(oldDOJ_Option="DOJ_MTH"),null!=oldDOJ_Option&&dojSelVal!=oldDOJ_Option&&(""==dojSelVal_2||dojSelVal_2!=oldDOJ_Option))return!0}["dojSelVal","dojSelVal_2"].forEach(function(index,data){var selVal="dojSelVal"==data?dojSelVal:dojSelVal_2,selectId="dojSelVal"==data?"":"_2";if("DOJ_UNTIL"==selVal){let date=ZPeopleComponents.datefield($("#dojVal1"+selectId)).getValue(),oldValue=void 0!=applicableDateType.until?applicableDateType.until:"";if(PMSV2Cycle.isDateValueChanged("",date.dateString,!0,oldValue))return!0}else if("DOJ_FRM_TO"==selVal){let date=ZPeopleComponents.daterangepicker($("#cyApplFrmToPrdPicker"+selectId)).getFromValue().fromValueString,oldValue=void 0!=applicableDateType.fromDate?applicableDateType.fromDate:"";if(PMSV2Cycle.isDateValueChanged("",date,!0,oldValue))return!0;if(date=ZPeopleComponents.daterangepicker($("#cyApplFrmToPrdPicker"+selectId)).getToValue().toValueString,oldValue=void 0!=applicableDateType.toDate?applicableDateType.toDate:"",PMSV2Cycle.isDateValueChanged("",date,!0,oldValue))return!0}else if("DOJ_MTH"==selVal){let month=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#dojMthVal"+selectId).val();if(PMSV2Cycle.isArrayValueChanged("monthList",month,!0,!1,!1,!1,"",!0))return!0}});let empType=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("[keysel=APPL_EMPTYPE]").val();if(null===empType&&(empType=new Array),PMSV2Cycle.isArrayValueChanged("employeeType",empType,!0,!1,!1,!0,"typeId"))return!0;let desArr=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("[keysel=APPL_DES]").val();if(null===desArr&&(desArr=new Array),PMSV2Cycle.isArrayValueChanged("designation",desArr,!0,!1,!1,!0,"desId"))return!0;if(-1==PMSOperation.notSelectedApplicableKeys.indexOf("location")){let locArr=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("[keysel=APPL_LOC]").val();if(null!==locArr&&0!=locArr.length||(locArr=new Array),PMSV2Cycle.isArrayValueChanged("location",locArr,!0,!1,!1,!0,"locationId"))return!0}if(-1==PMSOperation.notSelectedApplicableKeys.indexOf("department")){let depArr=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("[keysel=APPL_DEP]").val();if(null!==depArr&&0!=depArr.length||(depArr=new Array),PMSV2Cycle.isArrayValueChanged("department",depArr,!0,!1,!1,!0,"departmentId"))return!0}if(-1==PMSOperation.notSelectedApplicableKeys.indexOf("role")){let roleArr=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("[keysel=APPL_ROLE]").val();if(null!==roleArr&&0!=roleArr.length||(roleArr=new Array),PMSV2Cycle.isArrayValueChanged("role",roleArr,!0,!1,!1,!0,"roleId"))return!0}if(PMSV2Cycle.isLevelEnabled&&-1==PMSOperation.notSelectedApplicableKeys.indexOf("level")){let levelArr=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("[keysel=APPL_LVL]").val();if(null!==levelArr&&0!=levelArr.length||(levelArr=new Array),PMSV2Cycle.isArrayValueChanged("level",levelArr,!0,!1,!1,!0,"lvlID"))return!0}if(-1==PMSOperation.notSelectedApplicableKeys.indexOf("customDate")){let cstKey=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#cstKey").val();if(PMSV2Cycle.isInputFieldChanged("customDateFCID",cstKey))return!0;let cstCrt=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#cstCrt").val(),cstCrtval="CST_DATE"==cstCrt?1:2;if(PMSV2Cycle.isInputFieldChanged("cdType",cstCrtval))return!0;if("CST_DATE"==cstCrt){if(PMSV2Cycle.isDateRangeValueChanged("cstVal","",!1,"customFromDate","customToDate"))return!0}else{let month=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#cstMthVal").val();if(PMSV2Cycle.isArrayValueChanged("customMonth",month,!0,!1,!1))return!0}}if(-1==PMSOperation.notSelectedApplicableKeys.indexOf("totalWrkExp")){let expcrt=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#expCrt").val();if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD||void 0==PMSV2Cycle.CYCLE_EDIT_VALUE.expFilter){if(-1!=expcrt)return!0}else if(SalaryHikeV2Cycle.isSalaryHikeCycle){if(PMSV2Cycle.CYCLE_EDIT_VALUE.expFilter[0].operator!=expcrt)return!0}else if(PMSV2Cycle.CYCLE_EDIT_VALUE.expFilter.operator!=expcrt)return!0;let from=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#expFrom").val(),to=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#expTo").val();if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD||void 0==PMSV2Cycle.CYCLE_EDIT_VALUE.expFilter){if(""!=from)return!0;if(5==expcrt&&""!=to)return!0}else if(SalaryHikeV2Cycle.isSalaryHikeCycle){if(PMSV2Cycle.CYCLE_EDIT_VALUE.expFilter.length>0){if(from!=PMSV2Cycle.CYCLE_EDIT_VALUE.expFilter[0].from)return!0;if(5==expcrt&&to!=PMSV2Cycle.CYCLE_EDIT_VALUE.expFilter[0].to)return!0}}else{if(from!=PMSV2Cycle.CYCLE_EDIT_VALUE.expFilter.from)return!0;if(5==expcrt&&to!=PMSV2Cycle.CYCLE_EDIT_VALUE.expFilter.to)return!0}}if((isBudgetEnable||SalaryHikeV2Cycle.isSalaryHikeCycle)&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource)if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){var currency=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#appCurrSelID").val();if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&"-1"!=currency)return!0}else if(0!=PMSV2Cycle.CYCLE_EDIT_VALUE.periodStatus&&5!=PMSV2Cycle.CYCLE_EDIT_VALUE.periodStatus){if((currency=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#appCurrSelID").val())!=PMSV2Cycle.CYCLE_EDIT_VALUE.compensationApplicableCurrency)return!0}return!1},isAppraisalCycleValueChanged:function(){let isCompleted=!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&5==PMSV2Cycle.CYCLE_EDIT_VALUE.periodStatus,isStarted=!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&(0==PMSV2Cycle.CYCLE_EDIT_VALUE.periodStatus||isCompleted),name=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#cycleName").val();if(PMSV2Cycle.isInputFieldChanged("periodName",name))return!0;if(discription=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#cycleDesc").val(),PMSV2Cycle.isInputFieldChanged("description",discription))return!0;if(PMSV2Cycle.isDateRangeValueChanged("cyclePeriodID","",!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD,"cyclefromdate","cycletoDate"))return!0;if(PMSV2Cycle.isFileInputChanged(PMSV2Cycle.GUIDE_FILE,PMSV2Cycle.GUIDELINEDOCREMOVED))return!0;let isSelfEnabled=PMSV2Cycle.IS_SELF_ENABLED,isMREnabled=PMSV2Cycle.IS_MR_ENABLED,isBudgetEnabled=PMSV2Cycle.IS_SAL_HK_ENABLED,isNormalizationEnabled=PMSV2Cycle.IS_NORM_ENABLED;if(!isStarted&&PMSV2Cycle.isApplicableValueChanged(isBudgetEnabled))return!0;let ratingCommentEnabledStatus={selfObj:{},mrObj:{},reviewObj:{}};if(isSelfEnabled){if(ratingCommentEnabledStatus.selfObj=PMSV2Cycle.getModuleRatingValue($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#saCrt"),"tr","saQtPmTBody","saQlPmTBody"),PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&PMSV2Cycle.isModuleRatingChanged($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#saCrt"),"tr","saQtPmTBody","saQlPmTBody","selfObj",ratingCommentEnabledStatus.selfObj))return!0;if(PMSV2Cycle.isFileInputChanged(PMSV2Cycle.SELF_FILE,PMSV2Cycle.SEFLAPPRAISALFILEREMOVED))return!0}if(isMREnabled){if(ratingCommentEnabledStatus.mrObj=PMSV2Cycle.getModuleRatingValue($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#mrCrt"),"tr","mrQtPmTBody","mrQlPmTBody"),PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&PMSV2Cycle.isModuleRatingChanged($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#mrCrt"),"tr","mrQtPmTBody","mrQlPmTBody","mrObj",ratingCommentEnabledStatus.mrObj))return!0;let isMrtypeComEnabled=ZPeopleComponents.toggleswitch($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#mrTypeID")).getState();if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&PMSV2Cycle.isBooleanFieldChanged("isMrtypeComEnabled",isMrtypeComEnabled))return!0;if(isMrtypeComEnabled&&PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&PMSV2Cycle.isMRtypeModuleRatingChanged("mrTypeTBody","mr","mrType"))return!0;let isAddReportee=ZPeopleComponents.toggleswitch($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#mrAutoPopulate")).getState(),mrchoice=parseInt($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("[name=mrSelRdBx]:checked").val());if(isAddReportee){if(1==mrchoice){mrchoice=4;let AnonymousFeedbackEnabeld=!$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#mrAnonID").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("showRaterByRM",AnonymousFeedbackEnabeld))return!0}else 2==mrchoice&&(mrchoice=5);let defaultmrType=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#mrTypeSelID").val();if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&PMSV2Cycle.isInputFieldChanged("defaultmrType",defaultmrType))return!0}let mrType=mrchoice;if(PMSV2Cycle.isInputFieldChanged("mrType",mrType,1))return!0;let mrMaxRater=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#maxrater").val();if(PMSV2Cycle.isInputFieldChanged("mrMaxRater",mrMaxRater))return!0;let mrMinRater=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#minrater").val();if(PMSV2Cycle.isInputFieldChanged("mrMinRater",mrMinRater))return!0;let showSelfApprForMR=!1;if(isSelfEnabled&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#selfApprViewForMR").is(":checked")&&(showSelfApprForMR=!0),isSelfEnabled&&PMSV2Cycle.isBooleanFieldChanged("showSelfApprForMR",showSelfApprForMR))return!0}if(ratingCommentEnabledStatus.reviewObj=PMSV2Cycle.getModuleRatingValue($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#nwCylpaDetDiv"),"tr","paQtPmTBody","paQlPmTBody"),PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&PMSV2Cycle.isModuleRatingChanged($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#nwCylpaDetDiv"),"tr","paQtPmTBody","paQlPmTBody","reviewObj",ratingCommentEnabledStatus.reviewObj))return!0;let apprObj=ZPA_Approvers.getApprovalConfigJson(),approvalArr=Object.values(apprObj);if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&PMSV2Cycle.isReviewLevelChanged("approvalArr",approvalArr))return!0;let reviewApprovalEnable=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#reviewApprovalEnable").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("reviewApprovalEnable",reviewApprovalEnable))return!0;let modWeightageObj={};if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&PMSV2Cycle.IS_MOD_WGT_ENABLED&&ZPeopleComponents.toggleswitch($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#setModWgtID")).getState()){let modwhtElement=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#modWgtTBody").find("input");for(var index=0;index<modwhtElement.length;index++)if(!$(modwhtElement[index]).hasClass("disabled")){modWeightageObj[$(modwhtElement[index]).attr("compnme")]=parseInt($(modwhtElement[index]).val())}if(PMSV2Cycle.isJSONObjectValueChanged("modWeightage",modWeightageObj))return!0}if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){let moduleRatingType={};if(moduleRatingType.isIncNoDataMod=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#isIncNoDataMod").is(":checked"),PMSV2Cycle.isBooleanFieldChanged("isIncNoDataMod",moduleRatingType.isIncNoDataMod,!1,!0))return!0;if(moduleRatingType.isNotApplicable=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#notApplicable").is(":checked"),PMSV2Cycle.isBooleanFieldChanged("isNotApplicable",moduleRatingType.isNotApplicable,!0,!0))return!0;if($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#cmtLenDiv").hasClass("DN")||(moduleRatingType.minCommentLength=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#cmtLenInp").val()),moduleRatingType.noOfDigits=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#ratingNoOfDigits").val(),PMSV2Cycle.isInputFieldChanged("noOfDigits",moduleRatingType.noOfDigits,1,!0))return!0;if(moduleRatingType.reviewRatingLock=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#isRatingLocked").is(":checked"),PMSV2Cycle.isBooleanFieldChanged("reviewRatingLock",moduleRatingType.reviewRatingLock,!0,!0))return!0;if(moduleRatingType.roundOfRT=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#rtRndOffID").is(":checked"),PMSV2Cycle.isBooleanFieldChanged("roundOfRT",moduleRatingType.roundOfRT,!1,!0))return!0;let ratingType=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#ratingType").val();if("starRating"==ratingType)moduleRatingType.type=0;else if("numberRating"==ratingType)moduleRatingType.type=1,moduleRatingType.min=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#mnVl").val(),moduleRatingType.max=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#MxVl").val();else if("textRating"==ratingType){moduleRatingType.type=2;let textRatingElement=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#cstTxtRtgID").find("input");moduleRatingType.max=textRatingElement.length;let textRatingName=[],textRatingValue=[];for(index=0;index<textRatingElement.length;index++){let inputelement=textRatingElement[textRatingElement.length-index-1];textRatingName.push($(inputelement).val()),textRatingValue.push(index+1)}if(moduleRatingType.textRatingName=textRatingName,moduleRatingType.textRatingValue=textRatingValue,PMSV2Cycle.isArrayValueChanged("textRatingName",moduleRatingType.textRatingName,!1,!1,!0))return!0}else moduleRatingType.type=3,moduleRatingType.min=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#MnVl").val(),moduleRatingType.max=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#MxVl").val();if(PMSV2Cycle.isInputFieldChanged("type",moduleRatingType.type,0,!0))return!0;if((1==moduleRatingType.type||2==moduleRatingType.type)&&PMSV2Cycle.isInputFieldChanged("min",moduleRatingType.min,void 0,!0))return!0;if((1==moduleRatingType.type||2==moduleRatingType.type)&&PMSV2Cycle.isInputFieldChanged("max",moduleRatingType.max,void 0,!0))return!0;if(3==moduleRatingType.type&&PMSV2Cycle.isInputFieldChanged("max",moduleRatingType.max,void 0,!0))return!0;let hideaverage=[];if(void 0!=PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.SELF&&PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.SELF&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#selfaveragehide").is(":checked")&&hideaverage.push("SELF"),void 0!=PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.MR&&PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.MR&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#mraveragehide").is(":checked")&&hideaverage.push("MR"),void 0!=PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.REVIEW&&PMSV2Cycle.IS_HIDE_AVERGE_ENABLED.REVIEW&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#reviewaveragehide").is(":checked")&&hideaverage.push("REVIEW"),PMSV2Cycle.isArrayValueChanged("hideaverage",hideaverage,!0))return!0}let cycleRatings=[];for(var i in PMSV2Cycle.rating_keyarray){let obj={},jindex=PMSV2Cycle.rating_keyarray.length-1-i;void 0==PMSV2Cycle.rating_maxRangeArray[jindex]||$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#modRtgDiv").hasClass("zpl_DNI")||(obj.maxRange=PMSV2Cycle.rating_maxRangeArray[jindex]),void 0==PMSV2Cycle.rating_minRangeArray[jindex]||$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#modRtgDiv").hasClass("zpl_DNI")||(obj.minRange=PMSV2Cycle.rating_minRangeArray[jindex]),isNormalizationEnabled&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#nmRtMinInp_"+jindex).length>0&&(obj.norPer=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#nmRtMinInp_"+jindex).val()),obj.ratingName=PMSV2Cycle.rating_keyarray[jindex],obj.stars=jindex+1,cycleRatings.push(obj)}if(PMSV2Cycle.isRatingValueChanged("cycleRatings",cycleRatings,isNormalizationEnabled))return!0;if(isBudgetEnabled){let hikeApprovalEnable=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#hkApproval").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("hikeApprovalEnable",hikeApprovalEnable))return!0;let hikeDecider=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#hkApprSel").val();if(PMSV2Cycle.isInputFieldChanged("hikeDecider",hikeDecider,-1))return!0;let promotionOnHikeEnabled=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#incProp").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("promotionOnHikeEnabled",promotionOnHikeEnabled))return!0;let hikeOption=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#hkBsdOn").find("[name=ruleOpt]:checked").val();if(PMSV2Cycle.isBudgetDetailsChanged(hikeOption))return!0}let publishOption=parseInt($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("[name=pubMtd]:checked").val());if(PMSV2Cycle.isInputFieldChanged("publishOption",publishOption))return!0;var fldPubData=ZPeopleComponents.tokenfield("#fldToPubID").getAllValues(),actualSelVal=[];if(fldPubData.length>0)for(var i in fldPubData)actualSelVal.push(fldPubData[i].id);if(PMSV2Cycle.isArrayValueChanged("compidarr",actualSelVal,!0,!0))return!0;var pubOwner=ZPeopleComponents.tokenfield("#pubAuthID").getAllValues(),pubOwnerSelVal=[];if(pubOwner.length>0)for(var i in pubOwner)pubOwnerSelVal.push(pubOwner[i].id);let publisherFinalizer=!1;-1!=pubOwnerSelVal.indexOf("3")&&(publisherFinalizer=!0);let publisherRM=!1;if(-1!=pubOwnerSelVal.indexOf("2")&&(publisherRM=!0),PMSV2Cycle.isBooleanFieldChanged("publisherFinalizer",publisherFinalizer))return!0;if(PMSV2Cycle.isBooleanFieldChanged("publisherRM",publisherRM))return!0;let shareFeedback=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#empApprFdbkID").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("shareFeedback",shareFeedback))return!0;$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#enableAppraisalLetter").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("",shareFeedback))return!0;if(PMSV2Cycle.isDateRangeValueChanged("cyPPeriodID","",!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD,"periodStart","periodEnd"))return!0;if(isSelfEnabled&&PMSV2Cycle.isDateRangeValueChanged("cySAPeriodID","Self Appraisal",!1))return!0;if(isMREnabled){if(PMSV2Cycle.isDateRangeValueChanged("cyMRSelPeriodID","MULTI_RATER_SELECTION",!1))return!0;if(PMSV2Cycle.isDateRangeValueChanged("cyMRFdBkPeriodID","Multi Rater",!1))return!0}if(PMSV2Cycle.isDateRangeValueChanged("cyRPeriodID","Appraisal",!1))return!0;if(isBudgetEnabled){if(PMSV2Cycle.isDateRangeValueChanged("cyHkPeriodID","",!1,"hikeFromDt","hikeToDt"))return!0;if(PMSV2Cycle.isDateAndTimeValueChanged("cyHkPushID","hikePublishDt"))return!0}if(isNormalizationEnabled&&PMSV2Cycle.isDateRangeValueChanged("cyNrmPeriodID","Normalization",!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD))return!0;if(2==publishOption){if(PMSV2Cycle.isDateRangeValueChanged("cyMnlPubWthTimeID","REVIEW_PUBLISH",!1))return!0}else if(PMSV2Cycle.isDateAndTimeValueChanged("cyMnlPubPeriodID","reviewPublishDt"))return!0;return!1},isDateRangeValueChanged:function(id,scheduleName,isManatory,oldValueFromKey,oldValueNewKey){if(""!==$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+id).val()){let oldFromDate=null,oldToDate=null,isSchedule=!1;if(""!=scheduleName&&!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){let dateArr=PMSV2Cycle.CYCLE_EDIT_VALUE.schedule.filter(schedule=>schedule.scheduleName===scheduleName);dateArr.length>0&&(oldFromDate=dateArr[0].startdate,oldToDate=dateArr[0].duedate),oldValueFromKey="",oldValueNewKey="",isSchedule=!0}var dateVal=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+id).val();let dateObj=PMSV2Cycle.getDateValueWithoutValidation(dateVal);if(PMSV2Cycle.isDateValueChanged(oldValueFromKey,dateObj.fromDate,isSchedule,oldFromDate))return!0;if(PMSV2Cycle.isDateValueChanged(oldValueNewKey,dateObj.toDate,isSchedule,oldToDate))return!0}else if(isManatory)return!0;return!1},getDateValueWithoutValidation:function(dateVal){let dateObj={};var fromDate=null,toDate=null;if(6===dateVal.split("-").length)fromDate=(date=dateVal.split("-"))[0]+"-"+date[1]+"-"+date[2],toDate=date[3]+"-"+date[4]+"-"+date[5];else if(2===dateVal.split("-").length){var date;fromDate=(date=dateVal.split("-"))[0],toDate=date[1]}return dateObj.fromDate=fromDate,dateObj.toDate=toDate,dateObj},isBudgetDetailsChanged:function(hikeOption,defaultValue){let hikePer=parseFloat($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#hikePercentage").val()).toFixed(2);if(PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){if(0!=hikeOption)return!0;if(void 0!=hikePer&&""!=hikePer&&"0"!=hikePer&&"0.00"!=hikePer)return!0}else{let budgetDetails=PMSV2Cycle.SELECTED_TMPL.budgetDetails;if(0==budgetDetails.typeArr.length&&0!=hikeOption)return!0;if(parseFloat(budgetDetails.hikePercentage).toFixed(2)!=parseFloat(hikePer).toFixed(2))return!0;if(budgetDetails.typeArr.length>0&&budgetDetails.typeArr!=PMSV2Cycle.CHOSEN_CUST_OPT)return!0;if(budgetDetails.typeArr.length>0){if(budgetDetails.ruleDetails.length-1!=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#custRules .zpl_paappslyhike").length)return!0;if(PMSV2Cycle.isCustomHkRuleChanged(budgetDetails))return!0}if(Boolean(budgetDetails.hikedeviationenable)!=Boolean($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#enablehikedeviation").is(":checked")))return!0;if(budgetDetails.hikedeviationenable&&parseFloat(budgetDetails.hikedeviationper)!=parseFloat($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#hikedeviationper").val()))return!0}return!1},isCustomHkRuleChanged:function(budgetDetails){let custOptLen=budgetDetails.typeArr.length,iter=(budgetDetails.ruleDetails.length,0);$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#custRules .zpl_paappslyhike").each(function(){let id=parseInt($(this).attr("series"));for(let i=0;i<custOptLen;i++){let type=PMSV2Cycle.CHOSEN_CUST_OPT[i];if(1==type||4==type){var arr;arr=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield("#tot"+id+"_rule"+i+"_option").getAllValues());var preselectVal=PMSV2Cycle.SELECTED_TMPL.budgetDetails.ruleDetails[iter].criteria[i][type];if(arr.length!=preselectVal!=val)return!0;for(let k=0;k<arr.length;k++)if(arr[k]!=preselectVal[k])return!0}else if(2==type||3==type&&!PMSV2Cycle.newDOJ){preselectVal=PMSV2Cycle.SELECTED_TMPL.budgetDetails.ruleDetails[iter].criteria[i][type];var val=Number($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tot"+id+"_rule"+i+"_expFrom_1").val());if(ZPeopleComponents.select("#tot"+id+"_rule"+i+"_option")!=preselectVal.condType)return!0;if($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tot"+id+"_rule"+i+"_expFrom_1").val()!=preselectVal.condValue||""==$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tot"+id+"_rule"+i+"_expFrom_1").val())return!0;if(2==preselectVal.condType&&($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tot"+id+"_rule"+i+"_expTo_1").val()!=preselectVal.condValue||""==$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tot"+id+"_rule"+i+"_expTo_1").val()))return!0}else if(3==type){preselectVal=PMSV2Cycle.SELECTED_TMPL.budgetDetails.ruleDetails[iter].criteria[i][type];var opt=ZPeopleComponents.select("#tot"+id+"_rule"+i+"_option").getValue();if(PMSV2Cycle.newDOJ){if(opt!=preselectVal.condType)return!0;val=2!=opt?ZPeopleComponents.datefield($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tot"+id+"_rule"+i+"_dojSel")).getValue().dateString:ZPeopleComponents.daterangepicker($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tot"+id+"_rule"+i+"_hkDoj")).getFromValue().fromValueString;if(2==opt){if(val!=preselectVal.condValue)return!0;if(ZPeopleComponents.daterangepicker($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tot"+id+"_rule"+i+"_hkDoj")).getToValue().toValueString!=preselectVal.condValueTo)return!0}else if(val!=preselectVal.condValue)return!0}}else if(5==type){if((val=ZPeopleComponents.select("#tot"+id+"_rule"+i+"_option").getValue())!=PMSV2Cycle.SELECTED_TMPL.budgetDetails.ruleDetails[iter].criteria[i][type])return!0}}iter++})},isDateValueChanged:function(oldValueKey,newValue,isSchedule,OldValue){if(newValue=""==newValue||void 0==newValue?null:newValue,PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){if(void 0!=newValue&&null!=newValue)return!0}else{let oldVal=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]&&null!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]:null;if(void 0!=isSchedule&&isSchedule&&(oldVal=OldValue),oldVal=""==oldVal?null:oldVal,null==newValue&&null!=oldVal)return!0;if(null!=newValue&&null==oldVal)return!0;if(null!=newValue&&null!=oldVal){if(!PMSV2Cycle.checkvalidDate(newValue))return!0;{let fdate=Calendar.parseDate(newValue,uidateFormat),folddate=Calendar.parseDate(oldVal,uidateFormat);if(new Date(fdate).getTime()!=new Date(folddate).getTime())return!0}}}return!1},isDateAndTimeValueChanged:function(id,oldValueKey){let newValue=ZPeopleComponents.datetimefield($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#"+id)).getValue().dateString;if(newValue=void 0==newValue?null:newValue,PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD){if(void 0!=newValue&&null!=newValue)return!0}else{let oldVal=void 0!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]&&null!=PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]?PMSV2Cycle.CYCLE_EDIT_VALUE[oldValueKey]:null;if(oldVal=""==oldVal||void 0==oldVal?null:oldVal,null==newValue&&null!=oldVal)return!0;if(null!=newValue&&null==oldVal)return!0;if(null!=newValue&&null!=oldVal&&new Date(newValue).getTime()!=new Date(oldVal).getTime())return!0}return!1},booleanChkRecalcSalary:function(){let pageId=settingsPage.container,selFld=pageId.find("#hkBsdOn").find("[name=ruleOpt]:checked").val(),hikePer=parseFloat(pageId.find("#hikePercentage").val()).toFixed(2),recalc=!1;return void 0!=hikePer&&""!=hikePer&&"0"!=hikePer&&"0.00"!=hikePer&&(recalc=!0),1==selFld&&PMSV2Cycle.CHOSEN_CUST_OPT.length>0&&(recalc=!0),recalc},recalculateSalaryOnApplChange:function(edata,obj){if(void 0!=edata){if(edata.fromUI||!edata.fromUI&&void 0!=edata.type&&"zdatefieldpickerclose"==edata.type||"dojCrt_2"==$(edata.element).attr("id")){PMSV2Cycle.booleanChkRecalcSalary()?(PMSV2Cycle.onChangeApplCloseflds(edata),PMSV2Cycle.showhkResetpopup(edata)):("dojCrt"==$(edata.element).attr("id")||"dojCrt_2"==$(edata.element).attr("id")?PMSOperation.onDojCrtSelect(edata):"cstCrt"==$(edata.element).attr("id")?PMSOperation.onCstCrtSelect(edata):"expCrt"==$(edata.element).attr("id")?PMSOperation.onExpCrtSelect(edata):"dojKey"==$(edata.element).attr("id")&&PMSOperation.onDateTypeSelect(edata),PMSV2Cycle.onChangeApplicableFields(edata))}}else if(void 0!=obj&&null!=obj){PMSV2Cycle.booleanChkRecalcSalary()&&PMSV2Cycle.isPopUprequiredForDeleteAppl(obj)?PMSV2Cycle.showhkResetpopup(edata,obj):PMSV2Cycle.deleteApplicableCriteria(obj)}},onChangeApplCloseflds:function(edata){let pageId=settingsPage.container;if(void 0!=edata.type&&"zdatefieldpickerclose"==edata.type){$(edata.element).attr("id");ZPeopleComponents.datefield(pageId.find("#dojVal1")).closePicker(),ZPeopleComponents.isComponent(pageId.find("#dojVal1_2"))&&ZPeopleComponents.datefield(pageId.find("#dojVal1_2")).closePicker()}else if("cyApplFrmToPrdPicker"==$(edata.element).attr("id")||"cyApplCstPrdPicker"==$(edata.element).attr("id"))ZPeopleComponents.daterangepicker(pageId.find("#"+$(edata.element).attr("id"))).close();else if(void 0!=$(edata.element).attr("id")){let id=$(edata.element).attr("id");ZPeopleComponents.select(pageId.find("#"+id)).close()}else if(void 0!=$(edata.element).parent().attr("id")){let id=$(edata.element).parent().attr("id");ZPeopleComponents.select(pageId.find("#"+id+" select[type=valFld]")).close()}},isPopUprequiredForDeleteAppl:function(obj){var id=$(obj).parent().attr("id").split("AppliDiv")[0];return!("location"!=id&&"role"!=id&&"department"!=id&&"level"!=id&&"customDate"!=id&&"totalWrkExp"!=id||!PMSV2Cycle.applObj.hasOwnProperty(id))},deleteApplObj:function(obj){var id=$(obj).parent().attr("id").split("AppliDiv")[0];"location"!=id&&"role"!=id&&"department"!=id&&"level"!=id&&"customDate"!=id&&"totalWrkExp"!=id||PMSV2Cycle.applObj.hasOwnProperty(id)&&(delete PMSV2Cycle.applObj[id],PMSV2Cycle.isBudgetCalc=!0)},recalcSalaryonInputfields:function(id){PMSV2Cycle.booleanChkRecalcSalary()?PMSV2Cycle.showhkResetpopup(null,null,id):PMSV2Cycle.onChangeApplicableFields(null,id)},saveApplicabilityValues:function(edata,id){let pageId=settingsPage.container;if(void 0!=edata&&"dojKey"==$(edata.element).attr("id"))PMSV2Cycle.applObj.hasOwnProperty("dateType")&&delete PMSV2Cycle.applObj.dateType,ZPeopleComponents.select(pageId.find("#dojKey")).setValue(edata.selectedValue);else if(void 0!=edata&&"dojCrt"==$(edata.element).attr("id"))PMSV2Cycle.applObj.hasOwnProperty("DOJfromTo")&&delete PMSV2Cycle.applObj.DOJfromTo,PMSV2Cycle.applObj.hasOwnProperty("DOJmonth")&&delete PMSV2Cycle.applObj.DOJmonth,PMSV2Cycle.applObj.hasOwnProperty("DOJ")&&delete PMSV2Cycle.applObj.DOJ,ZPeopleComponents.select(pageId.find("#dojCrt")).setValue(edata.selectedValue);else if(void 0!=edata&&"dojCrt_2"==$(edata.element).attr("id"))PMSV2Cycle.applObj.hasOwnProperty("DOJfromTo_2")&&delete PMSV2Cycle.applObj.DOJfromTo_2,PMSV2Cycle.applObj.hasOwnProperty("DOJmonth_2")&&delete PMSV2Cycle.applObj.DOJmonth_2,PMSV2Cycle.applObj.hasOwnProperty("DOJ_2")&&delete PMSV2Cycle.applObj.DOJ_2,ZPeopleComponents.select(pageId.find("#dojCrt_2")).setValue(edata.selectedValue);else if(void 0!=edata&&"dojMthVal"==$(edata.element).attr("id"))PMSV2Cycle.applObj.DOJmonth=edata.selectedValue;else if(void 0!=edata&&"dojMthVal_2"==$(edata.element).attr("id"))PMSV2Cycle.applObj.DOJmonth_2=edata.selectedValue;else if(void 0!=edata&&"cyApplFrmToPrdPicker"==$(edata.element).attr("id")){let arr=[];arr.push(edata.fromValueString),arr.push(edata.toValueString),PMSV2Cycle.applObj.DOJfromTo=arr}else if(void 0!=edata&&"cyApplFrmToPrdPicker_2"==$(edata.element).attr("id")){let arr=[];arr.push(edata.fromValueString),arr.push(edata.toValueString),PMSV2Cycle.applObj.DOJfromTo_2=arr}else if(void 0!=edata&&"zdatefieldpickerclose"==edata.type&&"DOJ_UNTIL"==pageId.find("#dojCrt").val())PMSV2Cycle.applObj.DOJ=ZPeopleComponents.datefield(pageId.find("#dojVal1")).getValue();else if(void 0!=edata&&"zdatefieldpickerclose"==edata.type&&"DOJ_UNTIL"==pageId.find("#dojCrt_2").val())PMSV2Cycle.applObj.DOJ_2=ZPeopleComponents.datefield(pageId.find("#dojVal1_2")).getValue();else if(void 0!=edata&&"empTypeAppliDiv"==$(edata.element).parent().attr("id"))PMSV2Cycle.applObj.empType=edata.selectedValue;else if(void 0!=edata&&"designationAppliDiv"==$(edata.element).parent().attr("id"))PMSV2Cycle.applObj.designation=edata.selectedValue;else if(void 0!=edata&&"departmentAppliDiv"==$(edata.element).parent().attr("id"))PMSV2Cycle.applObj.department=edata.selectedValue;else if(void 0!=edata&&"locationAppliDiv"==$(edata.element).parent().attr("id"))PMSV2Cycle.applObj.location=edata.selectedValue;else if(void 0!=edata&&"roleAppliDiv"==$(edata.element).parent().attr("id"))PMSV2Cycle.applObj.role=edata.selectedValue;else if(void 0!=edata&&"appCurrSelID"==$(edata.element).attr("id"))"-1"==edata.selectedValue?PMSV2Cycle.applObj.empcurrency=[]:PMSV2Cycle.applObj.empcurrency=edata.selectedValue;else if(void 0!=edata&&"expCrt"==$(edata.element).attr("id")||"totalWrkExpAppliDiv"==id){var obj={};void 0!=edata&&"expCrt"==$(edata.element).attr("id")&&ZPeopleComponents.select(pageId.find("#expCrt")).setValue(edata.selectedValue),obj.operator=ZPeopleComponents.select(pageId.find("#expCrt")).getValue(),obj.from=pageId.find("#expFrom").val(),"5"==obj.operator&&(obj.to=pageId.find("#expTo").val());let isAllow=!1;if("-1"!=obj.operator&&""!=obj.from&&(isAllow=!0,"5"==obj.operator&&""==obj.to&&(isAllow=!1)),isAllow){var arr=[];arr.push(obj),PMSV2Cycle.applObj.totalWrkExp=arr}}else if("customDateAppliDiv"==$(edata.element).parent().attr("id")||"customDateAppliDiv"==$(edata.element).parent().parent().attr("id")||"cyApplCstPrdPicker"==$(edata.element).attr("id")){delete PMSV2Cycle.applObj.customDate;obj={};let isAllow=!1,selType=ZPeopleComponents.select(pageId.find("#cstCrt")).getValue();obj.customDate=ZPeopleComponents.select(pageId.find("#cstKey")).getValue(),-1!=obj.customDate&&(isAllow=!0),isAllow&&("CST_DATE"==selType?(obj.seltype=0,obj.from=ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker").getFromValue(),obj.to=ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker").getToValue(),void 0!=obj.from&&void 0!=obj.to||(isAllow=!1)):(obj.selType=1,obj.month=ZPeopleComponents.select(pageId.find("#cstMthVal")).getValue(),void 0!=obj.month&&""!=obj.month||(isAllow=!1))),isAllow&&(PMSV2Cycle.applObj.customDate=obj)}},setDOJOldValues:function(){let pageId=settingsPage.container;PMSV2Cycle.applObj.hasOwnProperty("dateType")&&ZPeopleComponents.select(pageId.find("#dojKey")).setValue(PMSV2Cycle.applObj.dateType);if(PMSV2Cycle.applObj.hasOwnProperty("DOJfromTo")||PMSV2Cycle.applObj.hasOwnProperty("DOJfromTo_2")){var selectId=PMSV2Cycle.applObj.hasOwnProperty("DOJfromTo_2")?"_2":"";0!==pageId.find("#dojMthVal"+selectId).length&&ZPeopleComponents.select(pageId.find("#dojMthVal"+selectId)).destroy(),pageId.find("#dojValDiv"+selectId).html('<div id="dblDateCalDiv'+selectId+'" class="ztextbox--group zh-alignright"><i id="dojVal_Icon'+selectId+'" class="ztextbox__icon PI_monthly"></i><input style="width: 230px;" id="dojVal'+selectId+'" class="ztextbox"></div>'),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId,{change:function(event,ui){pageId.find("#dojVal").val(ui.fromValueString+"-"+ui.toValueString),PMSV2Cycle.onChangeApplicableFields(ui)},format:dateFmt,forElement:pageId.find("#dojValDiv"+selectId)});let picker9=pageId.find("#cyApplFrmToPrdPicker"+selectId);pageId.find("#dojVal"+selectId+", #dojVal_Icon"+selectId).on("click",function(){pageId.find("#cyApplFrmToPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker9).close():ZPeopleComponents.daterangepicker(picker9).open()});let obj=PMSV2Cycle.applObj.hasOwnProperty("DOJfromTo")?PMSV2Cycle.applObj.DOJfromTo:PMSV2Cycle.applObj.DOJfromTo_2;ZPeopleComponents.select(pageId.find("#dojCrt"+selectId)).setValue("DOJ_FRM_TO"),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId).setFromValue(obj.eligibledate),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId).setToValue(obj.eligibletodate),!0}else if(PMSV2Cycle.applObj.hasOwnProperty("DOJ")||PMSV2Cycle.applObj.hasOwnProperty("DOJ_2")){selectId=PMSV2Cycle.applObj.hasOwnProperty("DOJ_2")?"_2":"";0!==pageId.find("#dojMthVal"+selectId).length&&ZPeopleComponents.select(pageId.find("#dojMthVal"+selectId)).destroy(),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId).clearSelection(),pageId.find("#dojValDiv").html('<input id="dojVal1'+selectId+'" class="ztextbox" style="width: 230px;">');var effectiveDateOptions={calendarIcon:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none",pickerclose:PMSV2Cycle.booleanDOJBudgetCheck};ZPeopleComponents.datefield(pageId.find("#dojVal1"+selectId),effectiveDateOptions),PMSV2Cycle.SELECTED_DOJUTIL_DATE=null,pageId.find("#dojVal1"+selectId+"-container .zinputfield__textbox").attr("style","width:190px;"),ZPeopleComponents.select(pageId.find("#dojCrt"+selectId)).setValue("DOJ_UNTIL"),PMSV2Cycle.applObj.hasOwnProperty("DOJ")?(ZPeopleComponents.datefield(pageId.find("#dojVal1")).setValue(PMSV2Cycle.applOb.DOJ),PMSV2Cycle.SELECTED_DOJUTIL_DATE=PMSV2Cycle.applOb.DOJ):(ZPeopleComponents.datefield(pageId.find("#dojVal1_2")).setValue(PMSV2Cycle.applOb.DOJ_2),PMSV2Cycle.SELECTED_DOJUTIL_DATE=PMSV2Cycle.applOb.DOJ_2)}if(PMSV2Cycle.applObj.hasOwnProperty("DOJmonth")||PMSV2Cycle.applObj.hasOwnProperty("DOJmonth_2")){selectId=PMSV2Cycle.applObj.hasOwnProperty("DOJmonth_2")?"_2":"";0!==pageId.find("#dojMthVal"+selectId).length&&ZPeopleComponents.select(pageId.find("#dojMthVal"+selectId)).destroy(),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker"+selectId).clearSelection(),pageId.find("#dojValDiv").html('<select id="dojMthVal'+selectId+'" class="select-js" style="width: 230px;" type="dojVal" multiple="true"></select>'),PMSOperation.monthOptions("dojMthVal"+selectId),ZPeopleComponents.select(pageId.find("#dojCrt"+selectId)).setValue("DOJ_MTH"),ZPeopleComponents.select(pageId.find("#dojMthVal"+selectId)).setValue(PMSV2Cycle.applObj.DOJmonth)}},setApplicabilityOldValue:function(edata,id){let pageId=settingsPage.container;if(void 0==edata||"dojCrt"!=$(edata.element).attr("id")&&"dojCrt_2"!=$(edata.element).attr("id")||PMSV2Cycle.setDOJOldValues(edata),void 0!=edata&&"dojMthVal"==$(edata.element).attr("id"))ZPeopleComponents.select(pageId.find("#dojCrt")).setValue("DOJ_MTH"),ZPeopleComponents.select(pageId.find("#dojMthVal")).setValue(PMSV2Cycle.applObj.DOJmonth);else if(void 0!=edata&&"dojMthVal_2"==$(edata.element).attr("id"))ZPeopleComponents.select(pageId.find("#dojCrt_2")).setValue("DOJ_MTH"),ZPeopleComponents.select(pageId.find("#dojMthVal_2")).setValue(PMSV2Cycle.applObj.DOJmonth_2);else if(void 0!=edata&&"cyApplFrmToPrdPicker"==$(edata.element).attr("id"))ZPeopleComponents.select(pageId.find("#dojCrt")).setValue("DOJ_FRM_TO"),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker").setFromValue(PMSV2Cycle.applObj.DOJfromTo[0]),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker").setToValue(PMSV2Cycle.applObj.DOJfromTo[1]);else if(void 0!=edata&&"cyApplFrmToPrdPicker_2"==$(edata.element).attr("id"))ZPeopleComponents.select(pageId.find("#dojCrt_2")).setValue("DOJ_FRM_TO"),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker_2").setFromValue(PMSV2Cycle.applObj.DOJfromTo_2[0]),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker_2").setToValue(PMSV2Cycle.applObj.DOJfromTo_2[1]);else if(void 0!=edata&&"zdatefieldpickerclose"==edata.type&&"DOJ_UNTIL"==pageId.find("#dojCrt").val())ZPeopleComponents.select(pageId.find("#dojCrt")).setValue("DOJ_UNTIL"),void 0==PMSV2Cycle.applObj.DOJ?ZPeopleComponents.datefield(pageId.find("#dojVal1")).setValue(""):ZPeopleComponents.datefield(pageId.find("#dojVal1")).setValue(PMSV2Cycle.applObj.DOJ.dateString),PMSV2Cycle.SELECTED_DOJUTIL_DATE=PMSV2Cycle.applObj.DOJ;else if(void 0!=edata&&"zdatefieldpickerclose"==edata.type&&"DOJ_UNTIL"==pageId.find("#dojCrt_2").val())ZPeopleComponents.select(pageId.find("#dojCrt_2")).setValue("DOJ_UNTIL"),void 0==PMSV2Cycle.applObj.DOJ_2?ZPeopleComponents.datefield(pageId.find("#dojVal1_2")).setValue(""):ZPeopleComponents.datefield(pageId.find("#dojVal1_2")).setValue(PMSV2Cycle.applObj.DOJ.dateString),PMSV2Cycle.SELECTED_DOJUTIL_DATE=PMSV2Cycle.applObj.DOJ_2;else if(void 0!=edata&&"appCurrSelID"==$(edata.element).attr("id"))ZPeopleComponents.select(pageId.find("#appCurrSelID")).deselectAllOptions(),PMSV2Cycle.applObj.empCurrency.length>0?ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue(PMSV2Cycle.applObj.empCurrency):ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1");else if(void 0!=edata&&"empTypeAppliDiv"==$(edata.element).parent().attr("id"))ZPeopleComponents.select(pageId.find("[keysel=APPL_EMPTYPE]")).deselectAllOptions(),void 0!=PMSV2Cycle.applObj.empType&&ZPeopleComponents.select(pageId.find("[keysel=APPL_EMPTYPE]")).setValue(PMSV2Cycle.applObj.empType);else if(void 0!=edata&&"designationAppliDiv"==$(edata.element).parent().attr("id"))ZPeopleComponents.select(pageId.find("[keysel=APPL_DES]")).deselectAllOptions(),void 0!=PMSV2Cycle.applObj.designation&&ZPeopleComponents.select(pageId.find("[keysel=APPL_DES]")).setValue(PMSV2Cycle.applObj.designation);else if(void 0!=edata&&"departmentAppliDiv"==$(edata.element).parent().attr("id"))ZPeopleComponents.select(pageId.find("[keysel=APPL_DEP]")).deselectAllOptions(),void 0!=PMSV2Cycle.applObj.department&&ZPeopleComponents.select(pageId.find("[keysel=APPL_DEP]")).setValue(PMSV2Cycle.applObj.department);else if(void 0!=edata&&"locationAppliDiv"==$(edata.element).parent().attr("id"))ZPeopleComponents.select(pageId.find("[keysel=APPL_LOC]")).deselectAllOptions(),void 0!=PMSV2Cycle.applObj.location&&ZPeopleComponents.select(pageId.find("[keysel=APPL_LOC]")).setValue(PMSV2Cycle.applObj.location);else if(void 0!=edata&&"roleAppliDiv"==$(edata.element).parent().attr("id"))ZPeopleComponents.select(pageId.find("[keysel=APPL_ROLE]")).deselectAllOptions(),void 0!=PMSV2Cycle.applObj.role&&ZPeopleComponents.select(pageId.find("[keysel=APPL_ROLE]")).setValue(PMSV2Cycle.applObj.role);else if(void 0!=edata&&"levelAppliDiv"==$(edata.element).parent().attr("id"))ZPeopleComponents.select(pageId.find("[keysel=APPL_LVL]")).deselectAllOptions(),void 0!=PMSV2Cycle.applObj.level&&ZPeopleComponents.select(pageId.find("[keysel=APPL_LVL]")).setValue(PMSV2Cycle.applObj.level);else if(void 0!=edata&&"expCrt"==$(edata.element).attr("id")||"totalWrkExpAppliDiv"==id)if(void 0!=PMSV2Cycle.applObj.totalWrkExp){let obj=PMSV2Cycle.applObj.totalWrkExp[0];ZPeopleComponents.select(pageId.find("#expCrt")).setValue(obj.operator),pageId.find("#totalWrkExpAppliDiv").find("#expFrom").val(obj.from),"5"==obj.operator?(pageId.find("#totalWrkExpAppliDiv").find("#expTo").show(),pageId.find("#totalWrkExpAppliDiv").find("#expFrom").attr("style","width: 110px;"),pageId.find("#totalWrkExpAppliDiv").find("#expTo").val(obj.to)):(pageId.find("#totalWrkExpAppliDiv").find("#expTo").val(""),pageId.find("#totalWrkExpAppliDiv").find("#expTo").hide(),pageId.find("#totalWrkExpAppliDiv").find("#expFrom").attr("style","width: 230px;"))}else ZPeopleComponents.select(pageId.find("#totalWrkExpAppliDiv").find("#expCrt")).setValue("-1"),pageId.find("#expFrom").val("");else if(void 0!=edata&&("customDateAppliDiv"==$(edata.element).parent().attr("id")||"customDateAppliDiv"==$(edata.element).parent().parent().attr("id")||"cyApplCstPrdPicker"==$(edata.element).attr("id")))if(ZPeopleComponents.select(pageId.find("#customDateAppliDiv").find("#cstKey")).deselectAllOptions(),ZPeopleComponents.select(pageId.find("#customDateAppliDiv").find("#cstCrt")).setValue("CST_DATE"),void 0!=PMSV2Cycle.applObj.customDate){let obj=PMSV2Cycle.applObj.customDate;0==obj.selType?(ZPeopleComponents.select(pageId.find("#cstCrt")).setValue("CST_DATE"),ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker").setFromValue(obj.from),ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker").setToValue(obj.to)):(ZPeopleComponents.select(pageId.find("#cstCrt")).setValue("CST_MTH"),ZPeopleComponents.select(pageId.find("#cstMthVal")).setValue(obj.month)),ZPeopleComponents.select(pageId.find("#cstKey")).setValue(obj.customDate)}else ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker").clearSelection(),pageId.find("#cstVal").val("")},deleteonresetOldvalue:function(id){var val=id.split("AppliDiv")[0];pageId.find("#"+appliDivId).remove(),PMSOperation.notSelectedApplicableKeys.push(val),ZPeopleComponents.menu("#appliMenuList").showMenuItems(["#"+val]),pageId.find("#appliAddButton").removeClass("zpl_DNI")},showhkResetpopup:function(edata,obj,id){let pageId=settingsPage.container;var infoAlertMessage=new InfoAlertMessage;infoAlertMessage.title="",infoAlertMessage.despcription=ZPI18N.getString("zp.ruleApplicableTypeChange",[PMSV2Cycle.HIKENAME,PMSV2Cycle.HIKENAME]),infoAlertMessage.yesButtonText=ZPI18N.getString("zp.reset"),infoAlertMessage.callback=function(obj1){pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction(),PMSV2Cycle.isChanged=!1,PMSV2Cycle.empCntArr=new Map,void 0!=edata&&null!=edata&&("dojCrt"==$(edata.element).attr("id")||"dojCrt_2"==$(edata.element).attr("id")?PMSOperation.onDojCrtSelect(edata):"cstCrt"==$(edata.element).attr("id")?PMSOperation.onCstCrtSelect(edata):"expCrt"==$(edata.element).attr("id")&&PMSOperation.onExpCrtSelect(edata),PMSV2Cycle.saveApplicabilityValues(edata,id)),null!=id&&""!=id?PMSV2Cycle.saveApplicabilityValues(edata,id):null!=obj&&(PMSV2Cycle.deleteApplObj(obj),PMSV2Cycle.deleteApplicableCriteria(obj)),PMSV2Cycle.isBudgetCalc=!0,PMSV2Cycle.hikeAmtArr={},PMSV2Cycle.SelCustArr=new Map,PMSV2Cycle.isChanged=!1,PMSV2Cycle.curRule=new Map,PMSV2Cycle.isCycStarted=!1},infoAlertMessage.cancelCallback=(()=>{(void 0!=edata&&null!=edata||null!=id&&void 0!=id)&&PMSV2Cycle.setApplicabilityOldValue(edata,id)}),infoAlertMessage.show()},booleanBudgetCheck:function(){return!(!PMSV2Cycle.isApplAllowed||!SalaryHikeV2Cycle.isSalaryHikeCycle)||!(!PMSV2Cycle.isApplAllowed||!(PMSV2Cycle.EDIT_CYCLE_FLAG&&PMSV2Cycle.SELECTED_TMPL.budgetEnable||!PMSV2Cycle.EDIT_CYCLE_FLAG&&!PMSV2Cycle.CLONE_CYCLE_FLAG&&null!=PMSV2Cycle.SELECTED_TMPL&&PMSV2Cycle.SELECTED_TMPL.budgetEnable||!PMSV2Cycle.EDIT_CYCLE_FLAG&&!PMSV2Cycle.CLONE_CYCLE_FLAG&&PMSV2Cycle.IS_SAL_HK_ENABLED))},getCourseTabDetails:function(){var pId=settingsPage.container,compName="nwCylcourseDetDiv";if(PMSV2Cycle.IS_COURSE_ENABLE){let idx=PMSV2Cycle.LEFT_TAB_ARRAY.indexOf(compName+"_hide");PMSV2Cycle.LEFT_TAB_ARRAY[idx]=compName,PMSV2Cycle.leftTabConstruct()}else{let idx=PMSV2Cycle.LEFT_TAB_ARRAY.indexOf(compName);PMSV2Cycle.LEFT_TAB_ARRAY[idx]=compName+"_hide",PMSV2Cycle.leftTabConstruct()}pId.find("#nwCylcourseDetDiv .zcheckbox__helper").on("click",function(){pId.find("#courseListView").is(":checked")||pId.find("#courseSuggestion").prop("checked",!1)})},showHikedeviation:function(){let pageId=Layout.Page.container;pageId.find("#enablehikedeviation").is(":checked")?(pageId.find("#hikedeviationperDiv").removeClass("zpl_DNI"),pageId.find("#hikedeviationper").val("")):(pageId.find("#hikedeviationperDiv").addClass("zpl_DNI"),pageId.find("#hikedeviationper").val(""))},openViewStatus:function(configId,status){PMSV2Cycle.VIEW_STATUS_PAGE_PERIOD_STATUS=status,PMSV2Cycle.IS_VIEW_STATUS_OPENED_FROM_CYCLELISTING=!0,paCommonUtil.isSalaryHikeCyclePage()?window.location.hash="#operations/performance/salarycycle-viewstatus:"+configId:window.location.hash="#operations/performance/cycle-viewstatus:"+configId},openCycleViewStatusPage:function(){if(null!=PMSV2Cycle.VIEW_STATUS_PAGE_PERIOD_STATUS)PMSV2Cycle.processStatusView(Layout.Page.urlparam.viewstatus,PMSV2Cycle.VIEW_STATUS_PAGE_PERIOD_STATUS);else{var params={mode:"getConfigDetails",configId:Layout.Page.urlparam.viewstatus,conreqcsr:csrfToken};paCommonUtil.isSalaryHikeCyclePage()?params.mode="salaryCycleDetails":params.cyType=0,$.post("/performanceConfig.zp",params,function(resultData){PMSV2Cycle.processStatusView(Layout.Page.urlparam.viewstatus,resultData.periodStatus)})}}};PMSV2Cycle.ESign={SELECTED_USER:null,constructEsignFlow:function(){let pageId=Layout.Page.container;PMSESign.IS_APPRAISAL_LETTER_FEATURE_ENABLED&&(PMSV2Cycle.ESign.constructAppraisalLetterCycleConfigTab(),pageId.find("#apprESignConfigurationDiv").addClass("zpl_DNI"),pageId.find("#appraisalLetterConfigurationDiv").addClass("zpl_DNI"),pageId.find("#esignProceessEnableDiv").addClass("zpl_DNI"),pageId.find("#esignProceessHeader").addClass("zpl_DNI"),pageId.find("#appraisalLettersentActionTypeDiv").addClass("zpl_DNI"),pageId.find("#appraisalLetterActionTypeLock").addClass("zpl_DNI"),PMSV2Cycle.ESign.getAppraisalEsignConfigHtml(),PMSV2Cycle.ESign.constructCycleMailMergeSelect(),PMSV2Cycle.EDIT_CYCLE_FLAG||PMSV2Cycle.CLONE_CYCLE_FLAG?PMSV2Cycle.CLONE_CYCLE_FLAG?PMSV2Cycle.SELECTED_TMPL.isAppraisalLetterEnabled?PMSV2Cycle.ESign.constructEsignSignerConfiguration(!1):PMSV2Cycle.ESign.setEsigndefaultValueInCycleConfig():PMSV2Cycle.EDIT_CYCLE_FLAG&&!PMSV2Cycle.CLONE_CYCLE_FLAG&&(PMSV2Cycle.SELECTED_TMPL.isAppraisalLetterEnabled?(PMSV2Cycle.ESign.constructEsignSignerConfiguration(!0),PMSV2Cycle.SELECTED_TMPL.isAppraisalEsignEnabled&&!PMSESign.anyEsignConfigurationEnabled()&&ZPeople.Message.warning(ZPI18N.getString("zp.paesign.nosignintegrationenabled"))):(PMSV2Cycle.ESign.setEsigndefaultValueInCycleConfig(),PMSV2Cycle.SELECTED_TMPL.LockAppraisalLetterConfiguration&&PMSV2Cycle.ESign.toggleAllEsignSections(!1),!PMSV2Cycle.SELECTED_TMPL.LockAppraisalLetterConfiguration&&PMSV2Cycle.SELECTED_TMPL.isPublishProcessStarted&&(pageId.find("#appraisalLettersentActionTypeDiv").find(".zradiobutton").addClass("disabled"),pageId.find("#appraisalLetterActionTypeLock").removeClass("zpl_DNI"),pageId.find("#appraisalLetterActionTypeLock").attr("title",ZPI18N.getString("zp.paesign.sentactionTypemanuallockinfo")),pageId.find("#apprLetSentSeperate").prop("checked",!0),PMSV2Cycle.ESign.toggleSentActionTypeInfoMessage()))):PMSV2Cycle.ESign.setEsigndefaultValueInCycleConfig())},constructAppraisalLetterCycleConfigTab:function(){var compName="nwCylAppraisalLetterDiv";if(PMSESign.IS_APPRAISAL_LETTER_FEATURE_ENABLED){let idx=PMSV2Cycle.LEFT_TAB_ARRAY.indexOf(compName+"_hide");PMSV2Cycle.LEFT_TAB_ARRAY[idx]=compName,PMSV2Cycle.leftTabConstruct()}else{let idx=PMSV2Cycle.LEFT_TAB_ARRAY.indexOf(compName);PMSV2Cycle.LEFT_TAB_ARRAY[idx]=compName+"_hide",PMSV2Cycle.leftTabConstruct()}},toggleAppraisalLetterCheckBox:function(obj){let pageId=Layout.Page.container;if($(obj).is(":checked")){pageId.find("#appraisalLetterConfigurationDiv").removeClass("zpl_DNI"),pageId.find("#appraisalLettersentActionTypeDiv").removeClass("zpl_DNI"),PMSESign.APPRAISAL_ESIGN_ENABLED&&pageId.find("#esignProceessEnableDiv").removeClass("zpl_DNI"),pageId.find("#appraisalLettersendmsg").removeClass("zpl_DNI"),pageId.find("#apprLetSentEsign").is(":checked")?(pageId.find("#apprESignConfigurationDiv").removeClass("zpl_DNI"),pageId.find("#esignProceessHeader").removeClass("zpl_DNI")):(pageId.find("#apprESignConfigurationDiv").addClass("zpl_DNI"),pageId.find("#esignProceessHeader").addClass("zpl_DNI")),null!=PMSV2Cycle.SELECTED_TMPL&&!PMSV2Cycle.SELECTED_TMPL.LockAppraisalLetterConfiguration&&PMSV2Cycle.SELECTED_TMPL.isPublishProcessStarted&&pageId.find("#appraisalLetterActionTypeLock").removeClass("zpl_DNI")}else pageId.find("#appraisalLetterConfigurationDiv").addClass("zpl_DNI"),pageId.find("#appraisalLettersentActionTypeDiv").addClass("zpl_DNI"),pageId.find("#appraisalLetterActionTypeLock").addClass("zpl_DNI"),pageId.find("#esignProceessEnableDiv").addClass("zpl_DNI"),pageId.find("#apprESignConfigurationDiv").addClass("zpl_DNI"),pageId.find("#esignProceessHeader").addClass("zpl_DNI"),pageId.find("#appraisalLettersendmsg").addClass("zpl_DNI")},toggleAppraisalEsignProcess:function(){let pageId=Layout.Page.container;pageId.find("#apprLetSentEsign").is(":checked")?PMSESign.anyEsignConfigurationEnabled()&&PMSESign.APPRAISAL_ESIGN_ENABLED?(pageId.find("#apprESignConfigurationDiv").removeClass("zpl_DNI"),pageId.find("#esignProceessHeader").removeClass("zpl_DNI")):PMSESign.anyEsignConfigurationEnabled()?PMSESign.APPRAISAL_ESIGN_ENABLED&&(ZPeople.Message.warning(ZPI18N.getString("zp.paesign.esignnotenabled")),pageId.find("#apprLetSentEsign").prop("checked",!1)):(ZPeople.Message.warning(ZPI18N.getString("zp.paesign.nosignintegrationenabled")),pageId.find("#apprLetSentEsign").prop("checked",!1)):(pageId.find("#apprESignConfigurationDiv").addClass("zpl_DNI"),pageId.find("#esignProceessHeader").addClass("zpl_DNI"))},getAppraisalEsignConfigHtml:function(){let html='<div class="zpl_secn"> <div id="apprEsignrecpRows" class="zsortable"> <div id="apprEsignrecp_parent" style="margin-top: 15px;" class="zsortable__handle"> </div> <div id="addRowsDiv" style="margin-top: 15px;"> <div class="zpl_idiv"><a class="zpl_lnkbg" id="apprEsignAddRecp" onclick="PMSV2Cycle.ESign.apprESingaddRecp()">'+ZPI18N.getString("zp.zs.addrecp")+"</a></div> </div> </div> </div>";Layout.Page.container.find("#apprESignConfigurationDiv").html(""),Layout.Page.container.find("#apprESignConfigurationDiv").html(html)},apprESingaddRecp:function(){let pageId=Layout.Page.container,elements=pageId.find('[name="apprEsignrecp_row"]');if(3==elements.length)return PMSV2Cycle.showError(ZPI18N.getString("zp.paesign.maxsignercountreached"),Layout.Page.container.find("#apprEsignrecp_parent"),1),!1;let lastElement=elements.length>0?elements[elements.length-1]:"",newrowCnt=elements.length>0?parseInt($(lastElement).attr("number"))+1:1;pageId.find("#apprEsignrecp_parent").append(PMSV2Cycle.ESign.getAddrecpHtml(newrowCnt));let selOpt=pageId.find("#apprEsignrecpFormValue_"+newrowCnt);ZPeopleComponents.select(selOpt),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.ESign.signerGrpSelectONChange(edata)}),PMSV2Cycle.ESign.constructSignerDiv(newrowCnt)},getAddrecpHtml:function(newrowCnt){return'<div name="apprEsignrecp_row" class="zpl_idiv" number="'+newrowCnt+'"> <div class="zpl_rwfld w45"><input type="text" class="ztextbox" name="apprEsignrecp_row_input" disabled="" id="apprEsignrecp_row_'+newrowCnt+'" value="'+newrowCnt+'"></div> <div class="zpl_rwfld w200"><select type="text" name="apprEsignrecpFormValue" id="apprEsignrecpFormValue_'+newrowCnt+'" class="ztextbox" value="" style="display: none;">  <option value="2" id="2">'+ZPI18N.getString("zp.LookupField")+' </option><option value="1" id="1"> '+ZPI18N.getString("zp.emailaddressfield")+'</option> <option value="3" id="3">'+ZPI18N.getString("zp.esign.specuser")+' </option><option value="4" id="4">'+ZPI18N.getString("zp.depthead")+' </option> </select> </div> <div class="zpl_rwfld w300" id="apprEsign_SignerDiv'+newrowCnt+'"> </div> <div class="zpl_rwfld w100" style="min-width: 100px;width:auto"> <div class="zpl_hvr d-flex flt_n"><i id="apprEsigndeleteRecp" name="apprEsigndeleteRecp" class="PI_delete" onclick="PMSV2Cycle.ESign.apprEsigndeleteRecipient(this)" data-toggle="tooltip" title="'+ZPI18N.getString("zp.delete")+'"></i> </div> </div> </div>'},constructSignerDiv:function(newrowCnt){let pageId=Layout.Page.container,selectid="apprEsign_Signer"+newrowCnt+"select",select='<select id="'+selectid+'" class="select" style="display: none;"></select>',divId="apprEsign_SignerDiv"+newrowCnt;pageId.find("#"+selectid).length>0&&(ZPeopleComponents.isComponent(pageId.find("#"+selectid))&&ZPeopleComponents.select(pageId.find("#"+selectid)).destroy(),pageId.find("#"+selectid).remove()),pageId.find("#"+divId).append(select);var val=ZPeopleComponents.select("#apprEsignrecpFormValue_"+newrowCnt).getValue();PMSV2Cycle.ESign.createSelectComponentForEsignConfig(val,selectid)},createSelectComponentForEsignConfig:function(val,selectid){let pageId=Layout.Page.container,selOpt=pageId.find("#"+selectid);selOpt.empty(),"1"==val?($.each(PMSESign.ESIGN_SIGNER_EMAIL_FIELD_LIST,function(key,value){selOpt.append(jQuery("<option />",{value:value.id,id:value.id}).html(ZSEC.Encoder.encodeForHTML(value.name)))}),ZPeopleComponents.select(selOpt)):"2"==val?($.each(PMSESign.ESIGN_SIGNER_LOOKUP_LIST,function(key,value){selOpt.append(jQuery("<option />",{value:value.id,id:value.id}).html(ZSEC.Encoder.encodeForHTML(value.name)))}),ZPeopleComponents.select(selOpt)):"3"==val?null!=PMSV2Cycle.ESign.SELECTED_USER?UserUtils.createMangEmpSearchbox("",selectid,void 0,{pModal:pageId.find("#nwCylAppraisalLetterDiv"),initialSelection:!0,selectedUser:PMSV2Cycle.ESign.SELECTED_USER}):UserUtils.createMangEmpSearchbox("",selectid,void 0,{pModal:pageId.find("#nwCylAppraisalLetterDiv"),initialSelection:!1}):"4"==val&&$(selOpt).addClass("zpl_DNI")},signerGrpSelectONChange:function(eData){let selectNumber=eData.element.attr("id").replace("apprEsignrecpFormValue_","");PMSV2Cycle.ESign.constructSignerDiv(selectNumber)},apprEsigndeleteRecipient:function(obj){let parRowDiv=$(obj).parent().parent().parent(),rowNum=$(parRowDiv).attr("number"),signGrpId="apprEsignrecpFormValue_"+rowNum,signerSelectId="apprEsign_Signer"+rowNum+"select",pageId=Layout.Page.container;pageId.find("#"+signGrpId).length>0&&ZPeopleComponents.isComponent(pageId.find("#"+signGrpId))&&ZPeopleComponents.select(pageId.find("#"+signGrpId)).destroy(),pageId.find("#"+signerSelectId).length>0&&ZPeopleComponents.isComponent(pageId.find("#"+signerSelectId))&&ZPeopleComponents.select(pageId.find("#"+signerSelectId)).destroy(),parRowDiv.remove();let elements=pageId.find("[name=apprEsignrecp_row_input]");for(var i=0;i<elements.length;i++){let element=elements[i];$(element).attr("value",i+1)}},setEsigndefaultValueInCycleConfig:function(){let pageId=Layout.Page.container;pageId.find("#enableAppraisalLetter").prop("checked",!1),pageId.find("#apprLetSentPublish").prop("checked",!0),pageId.find("#apprLetSentEsign").prop("checked",!1),pageId.find("#appraisalLetterConfigurationDiv").addClass("zpl_DNI"),pageId.find("#esignProceessEnableDiv").addClass("zpl_DNI"),pageId.find("#apprESignConfigurationDiv").addClass("zpl_DNI"),pageId.find("#esignProceessHeader").addClass("zpl_DNI"),pageId.find("#appraisalLettersentActionTypeDiv").addClass("zpl_DNI"),pageId.find("#appraisalLetterActionTypeLock").addClass("zpl_DNI"),PMSV2Cycle.ESign.toggleSentActionTypeInfoMessage()},constructCycleMailMergeSelect:function(){let selOpt=Layout.Page.container.find("#esignMailMergeselect");selOpt.empty(),selOpt.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),$.each(PMSESign.PA_MAIL_MERGE_LIST,function(key,value){selOpt.append(jQuery("<option />",{value:value.tid,id:value.tid}).html(ZSEC.Encoder.encodeForHTML(value.fname)))}),ZPeopleComponents.select(selOpt)},validateEsignConfiguration:function(){if(Layout.Page.container.find("#enableAppraisalLetter").is(":checked")){let configObj=PMSV2Cycle.ESign.getEsignConfigurationObj(),isVaild=void 0!=configObj.isVaildSigner&&configObj.isVaildSigner;isVaild||(Layout.Page.container.find("[name=apprEsignrecp_row]").length>0?PMSV2Cycle.showError(ZPI18N.getString("zp.paesign.dublicatesignerconfig"),Layout.Page.container.find("#apprEsignrecp_parent")):PMSV2Cycle.showError(ZPI18N.getString("zp.paesign.selectvaildsigner"),Layout.Page.container.find("#apprEsignrecp_parent"))),""==Layout.Page.container.find("#esignDocName").val()&&(isVaild=!1,PMSV2Cycle.showError(ZPI18N.getString("zp.paesign.entervailddocname"),Layout.Page.container.find("#esignDocName")));let isVaildMailMergeId=void 0!=configObj.mailMergeId&&""!=configObj.mailMergeId&&"-1"!=configObj.mailMergeId;return isVaildMailMergeId||PMSV2Cycle.showError(ZPI18N.getString("zp.paesign.selectvaildmailmergedoc"),Layout.Page.container.find("#esignMailMergeselect"),1),isVaild&&isVaildMailMergeId}return!0},getEsignConfigurationObj:function(){let pageId=Layout.Page.container,elements=pageId.find("[name=apprEsignrecp_row]"),result={},signerArr=[],validateObj={},isVaild=!0,departmentheadVaild=!0,departmentheadCnt=0;if(pageId.find("#apprLetSentEsign").is(":checked")){for(var i=0;i<elements.length;i++){let element=elements[i],rowNum=$(element).attr("number"),signGrpId="apprEsignrecpFormValue_"+rowNum,signerSelectId="apprEsign_Signer"+rowNum+"select",obj={};obj.grpId=ZPeopleComponents.select("#"+signGrpId).getValue(),"4"==obj.grpId?(++departmentheadCnt>1&&(departmentheadVaild=!1),signerArr.push(obj)):(obj.signerId=ZPeopleComponents.select("#"+signerSelectId).getValue(),signerArr.push(obj),void 0==validateObj[obj.signerId]?validateObj[obj.signerId]="1":isVaild=!1)}0==elements.length&&(isVaild=!1),result.signerArr=signerArr}return result.isVaildSigner=isVaild&&departmentheadVaild,result.mailMergeId=ZPeopleComponents.select("#esignMailMergeselect").getValue(),result.esignDocName=pageId.find("#esignDocName").val(),result.apprletterSentActType=parseInt(pageId.find("[name=apprLetSentAction]:checked").val()),result},constructEsignSignerConfiguration:function(isEdit){let pageId=Layout.Page.container;if(pageId.find("#appraisalLetterConfigurationDiv").removeClass("zpl_DNI"),pageId.find("#appraisalLettersentActionTypeDiv").removeClass("zpl_DNI"),pageId.find("#esignProceessEnableDiv").removeClass("zpl_DNI"),pageId.find("#enableAppraisalLetter").prop("checked",!0),pageId.find("#esignDocName").val(PMSV2Cycle.SELECTED_TMPL.esignDocName),0==PMSV2Cycle.SELECTED_TMPL.apprLetterSentActionType?pageId.find("#apprLetSentPublish").prop("checked",!0):pageId.find("#apprLetSentSeperate").prop("checked",!0),ZPeopleComponents.select(pageId.find("#esignMailMergeselect")).setValue(PMSV2Cycle.SELECTED_TMPL.esignMailMergeId),PMSV2Cycle.SELECTED_TMPL.isAppraisalEsignEnabled){pageId.find("#apprESignConfigurationDiv").removeClass("zpl_DNI"),pageId.find("#esignProceessHeader").removeClass("zpl_DNI"),pageId.find("#apprLetSentEsign").prop("checked",!0);for(var index=0;index<PMSV2Cycle.SELECTED_TMPL.esignSignerArr.length;index++){let signGrpId="apprEsignrecpFormValue_"+(index+1),signerSelectId="apprEsign_Signer"+(index+1)+"select";PMSV2Cycle.ESign.SELECTED_USER=null,PMSV2Cycle.EDIT_CYCLE_FLAG&&"3"==PMSV2Cycle.SELECTED_TMPL.esignSignerArr[index].grpId&&(PMSV2Cycle.ESign.SELECTED_USER=PMSV2Cycle.SELECTED_TMPL.esignSignerArr[index].signerId),PMSV2Cycle.ESign.apprESingaddRecp(),ZPeopleComponents.select(pageId.find("#"+signGrpId)).setValue(PMSV2Cycle.SELECTED_TMPL.esignSignerArr[index].grpId),"1"!=PMSV2Cycle.SELECTED_TMPL.esignSignerArr[index].grpId&&"2"!=PMSV2Cycle.SELECTED_TMPL.esignSignerArr[index].grpId||ZPeopleComponents.select(pageId.find("#"+signerSelectId)).setValue(PMSV2Cycle.SELECTED_TMPL.esignSignerArr[index].signerId)}}else PMSESign.APPRAISAL_ESIGN_ENABLED?pageId.find("#apprLetSentEsign").prop("checked",!1):pageId.find("#esignProceessEnableDiv").addClass("zpl_DNI");isEdit&&PMSV2Cycle.SELECTED_TMPL.LockAppraisalLetterConfiguration&&PMSV2Cycle.ESign.toggleAllEsignSections(!1),isEdit&&!PMSV2Cycle.SELECTED_TMPL.LockAppraisalLetterConfiguration&&PMSV2Cycle.SELECTED_TMPL.isPublishProcessStarted&&(pageId.find("#appraisalLettersentActionTypeDiv").find(".zradiobutton").addClass("disabled"),pageId.find("#appraisalLetterActionTypeLock").removeClass("zpl_DNI"),pageId.find("#appraisalLetterActionTypeLock").attr("title",0==parseInt(pageId.find("[name=apprLetSentAction]:checked").val())?ZPI18N.getString("zp.paesign.sentactionTypeinfo"):ZPI18N.getString("zp.paesign.sentactionTypemanuallockinfo")),pageId.find("#apprLetSentSeperate").prop("checked",!0)),PMSV2Cycle.ESign.toggleSentActionTypeInfoMessage()},toggleAllEsignSections:function(enableSection){let pageId=Layout.Page.container;enableSection?(pageId.find("#AppraisalLetterandEsign").find(".zpl_secn").removeClass("disabled"),pageId.find("#apprletterconfiglocked").addClass("zpl_DNI"),pageId.find("#appraisalLettersentActionTypeDiv").find(".zradiobutton").removeClass("disabled"),pageId.find("#appraisalLetterActionTypeLock").addClass("zpl_DNI")):(pageId.find("#AppraisalLetterandEsign").find(".zpl_secn").addClass("disabled"),pageId.find("#apprletterconfiglocked").removeClass("zpl_DNI"),pageId.find("#appraisalLettersentActionTypeDiv").find(".zradiobutton").addClass("disabled"),pageId.find("#appraisalLetterActionTypeLock").removeClass("zpl_DNI"),pageId.find("#appraisalLetterActionTypeLock").attr("title",0==parseInt(pageId.find("[name=apprLetSentAction]:checked").val())?ZPI18N.getString("zp.paesign.sentactionTypeinfo"):ZPI18N.getString("zp.paesign.sentactionTypemanuallockinfo")),pageId.find("#apprletterconfiglocked em").text(ZPI18N.getString("zp.paesign.configlockmanualsent")))},refreshMailMergeList:function(){let params={mode:"getAppraisalMailMergeList",conreqcsr:csrfToken};ZPeople.Request.send("/performanceConfig.zp",params,PMSV2Cycle.ESign.reconstructMailMergeList)},reconstructMailMergeList:function(resultData){let pageId=Layout.Page.container;void 0!=resultData&&void 0!=resultData.msg&&"success"==resultData.msg&&void 0!=resultData.mailmergetemplateArr&&(ZPeopleComponents.isComponent(pageId.find("#esignMailMergeselect"))&&ZPeopleComponents.select(pageId.find("#esignMailMergeselect")).destroy(),PMSESign.PA_MAIL_MERGE_LIST=resultData.mailmergetemplateArr,PMSV2Cycle.ESign.constructCycleMailMergeSelect())},toggleSentActionTypeInfoMessage:function(){let pageId=Layout.Page.container;0==parseInt(pageId.find("[name=apprLetSentAction]:checked").val())?pageId.find("#appraisalLettersendmsg").find("#AppraisalLetterDocSendMsg em").text(ZPI18N.getString("zp.paesign.apprsendconfigmsg")):pageId.find("#appraisalLettersendmsg").find("#AppraisalLetterDocSendMsg em").text(ZPI18N.getString("zp.paesign.sentlettermanualmsg"))}};const SalaryHikeV2Cycle={isSalaryHikeCycle:!1,SALARY_CYCLE_CONFIG:null,LEFT_TAB_ARRAY:["nwCylbasicDetDiv","nwCylAppliDiv","nwCylhkDetDiv_hide","nwCylPeriodDiv"],LEFT_TAB_K_V:{},initSalaryCyclePageLoadFile:function(){PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)&&Layout.PageUtil.loadFiles(["approvalv5.min.js"],SalaryHikeV2Cycle.initCyclePageCheck)},initCyclePageCheck:function(){void 0!=settingsUrlProps.urlParamsArr.viewstatus?PMSV2Cycle.isCycleAddEditPageValueChangedInit(SalaryHikeV2Cycle.initSalaryCyclePage,!1,"operations/performance/salarycycle",!0):SalaryHikeV2Cycle.initSalaryCyclePage()},initSalaryCyclePage:()=>{var pageId=settingsPage.container;if(SalaryHikeV2Cycle.isSalaryHikeCycle||(PMSOperation.appraisalCycle=PMSOperation.temp,PMSOperation.temp=PMSOperation.SalaryHikeV2Cycle,PMSOperation.cyclelistTempSIndex=PMSOperation.CY_FS_ST_IDX,PMSOperation.cyclelistTempCycleStatusObj=PMSOperation.cycleStatusObj,PMSOperation.cyclelistTempIsActiveOnly=PMSOperation.IS_ACTIVE_CYCLE_ONLY),isPAdmin||appsettingsadmin||palocadm||appdataadmin)if(void 0!=settingsUrlProps.urlParamsArr.viewstatus)PMSV2Cycle.openCycleViewStatusPage();else{if(null!=PMSV2Cycle.appStatusSliderObj&&void 0!=PMSV2Cycle.appStatusSliderObj&&0!=Object.keys(PMSV2Cycle.appStatusSliderObj).length&&PMSV2Cycle.appStatusSliderObj.closeCallback(),PMSV2Cycle.IS_VIEW_STATUS_OPENED_FROM_CYCLELISTING)return void(PMSV2Cycle.IS_VIEW_STATUS_OPENED_FROM_CYCLELISTING=!1);PMSV2Cycle.IS_VIEW_STATUS_OPENED_FROM_CYCLELISTING=!1,pageId.find("#topSettMenu").remove(),SalaryHikeV2Cycle.destroyCyclePageComponents(),PMSV2Cycle.getHikeTerms(),pageId.find("#cycleListDiv").remove(),pageId.html("");let html='<div id="cycleListDiv">';html+='<div class="zpl_act">',html+='<div class="zpl_btnmnu">',html+='<div class="search-cmn"> <i class="PI_lens" title="Search"></i> <input type="text" class="ztextbox" id="salaryCyclesearch" placeholder="'+ZPI18N.getString("zp.searchdata")+'" onkeyup="PMSOperation.searchAppraisalCycles(this,\'SalaryCycle\')"> <i class="PI_cls" onclick="PMSOperation.clssearch(\'SalaryCycle\')" title="'+ZPI18N.getString("zp.close")+'"></i> </div>',html+='<div class="zpl_lft"></div>',html+='<div class="zpl_rgt">',(isPAdmin||appsettingsadmin)&&(html+='\t<button id="addAppSalCycle" data-popup-open="pa_ChooseTemplate" class="zlabel zlabel--blue zlabel--medium" onclick="SalaryHikeV2Cycle.showSalaryHikeV2CycleAddConfig();" title="'+ZPI18N.getString("zp.addsalaryhikecycle",new Array(PMSV2Cycle.SALARYHIKENAME))+'"><span class="zpl_ellipsis200">'+ZPI18N.getString("zp.addsalaryhikecycle",new Array(PMSV2Cycle.SALARYHIKENAME))+"</span></button>"),html+='<i class="zpl_ibg PI_lens" onclick="PMSOperation.opnsearch(\'SalaryCycle\')" title="'+ZPI18N.getString("zp.search")+'"></i>',html+="</div>",html+="</div>",html+='<div class="zpl_rgtcnt">',html+='\t<div class="zpl_crdlst zpl_crdlstfdr" id="cycleTableBody">',html+="</div>",html+='<div class="zpl_crdlst zpl_crdlstfdr zpl_DNI" id="CompeletedCycleTableBody" iscompletedcycle="true"></div>',html+="</div>",html+="</div>",html+="</div>",pageId.append(html);let cycleToggleFilter='<ul class="zpl_grpmnu" id="cycleListingStatus_Filter"><li id="activeCycle_toggle" status="1" class="zpl_act"><span>'+ZPI18N.getString("zp.activecycles")+'</span><div class="zpl_tg"><span id="activeCycleCount" count="0"><b></b></span></div></li><li id="completedCycle_toggle" status="2"><span>'+ZPI18N.getString("zp.completedcycles")+'</span><div class="zpl_tg"><span id="completedCycleCount" count="0"><b></b></span></div></li></ul>';pageId.find(".zpl_btnmnu .zpl_lft").html(cycleToggleFilter),SalaryHikeV2Cycle.isSalaryHikeCycle=!0,PMSOperation.IS_ACTIVE_CYCLE_ONLY=!0,PMSOperation.cycleStatusObj={},PMSOperation.loadCycles(),PMSSetting.getSelPerformanceModules(!0),SalaryHikeV2Cycle.updateSalaryCycleAddButton()}else OprCardMessage.setNoData(pageId,{text:ZPI18N.getString("zp.permissiondeniedtoaccessthispage"),className:"zp_nd_nodata",isAppend:!0})},updateSalaryCycleAddButton:()=>{void 0!=PMSSetting.SEL_ENABLED_MODULES.SALARY&&PMSSetting.SEL_ENABLED_MODULES.SALARY.enable?Layout.Page.container.find("#addAppSalCycle").removeClass("zpl_DNI"):Layout.Page.container.find("#addAppSalCycle").addClass("zpl_DNI")},showSalaryHikeV2CycleAddConfig:()=>{PMSV2Cycle.getHikeTerms(),null===SalaryHikeV2Cycle.SALARY_CYCLE_CONFIG&&$.ajax({type:"POST",async:!1,url:"/performance/view/salaryHikeCycleConfigurationPageV2",data:{conreqcsr:csrfToken},success:function(resultData){SalaryHikeV2Cycle.SALARY_CYCLE_CONFIG=resultData}}),settingsPage.container.html(SalaryHikeV2Cycle.SALARY_CYCLE_CONFIG),settingsPage.container.find("#hdrLbl").text(ZPI18N.getString("zp.addsalarycycle")),SalaryHikeV2Cycle.salaryHikeConfigload(),PMSV2Cycle.isApplAllowed=!0,PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck()},salaryHikeConfigload:function(){PMSV2Cycle.isApplAllowed=!1;var pageId=settingsPage.container;ZPeopleComponents.select(pageId.find(".select-js"),{dropdownList:{appendTo:pageId,fitForElement:!0}}),PMSV2Cycle.prerequisiteData(!0),SalaryHikeV2Cycle.registerActions(),SalaryHikeV2Cycle.defaultOption(),PMSV2Cycle.isBudgetCalc=!1,SalaryHikeV2Cycle.LEFT_TAB_ARRAY=["nwCylbasicDetDiv","nwCylAppliDiv","nwCylhkDetDiv","nwCylPeriodDiv"],SalaryHikeV2Cycle.LEFT_TAB_K_V={nwCylbasicDetDiv:ZPI18N.getString("zp.basicdetails"),nwCylAppliDiv:ZPI18N.getString("zp.applicability"),nwCylhkDetDiv:PMSV2Cycle.HIKENAME,nwCylPeriodDiv:ZPI18N.getString("zp.cycle.periodconfig")},SalaryHikeV2Cycle.leftTabConstruct();let timeFormat=Calendar.is12HrFormat()?"hh:mm tt":"HH:mm";ZPeopleComponents.datetimefield("#cyHkPushID").destroy();let dTimeObj={format:dateFmt+" "+timeFormat,clearButton:"focus",calendarIcon:!0,calendarIconClassName:"ztextbox__icon PI_monthly"};ZPeopleComponents.datetimefield("#cyHkPushID",dTimeObj);var effectiveDateOptions={calendarIcon:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none",pickerclose:PMSV2Cycle.booleanDOJBudgetCheck};ZPeopleComponents.datefield(pageId.find("#dojVal1"),effectiveDateOptions),PMSV2Cycle.onHikeBasedAction(),PMSV2Cycle.budgetResetCalcFunc(),SalaryHikeV2Cycle.dateRangeInitialization(),void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource&&pageId.find("#empCurrencyAppliDiv").show(),PMSOperationCommon.focus(pageId.find("#cycleName"))},registerActions:()=>{var pageId=settingsPage.container;PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck();let appliMenu=ZPeopleComponents.menu(pageId.find("#appliMenuList"),{forElement:pageId.find("#appliAddButton"),appendTo:pageId,itemclick:e=>{PMSV2Cycle.addApplicableCriteria(e)}});pageId.find("#appliAddButton").on("click",function(ev){appliMenu.show()}),pageId.find("#dojAppliDiv #dojCrt").on("zselectchange",function(event,eData){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(eData):(PMSOperation.onDojCrtSelect(eData),PMSV2Cycle.onChangeApplicableFields(eData))}),pageId.find("#dojKey").on("zselectchange",function(event,eData){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(eData):(PMSOperation.onDateTypeSelect(eData),PMSV2Cycle.onChangeApplicableFields(eData))}),pageId.find("#addCriDiv_DOJ").on("click",function(e){PMSV2Cycle.addDateOfApplicableCriteria(e)}),pageId.find("#dojAppliDiv_2 #dojCrt_2").on("zselectchange",function(event,eData){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(eData):(PMSOperation.onDojCrtSelect(eData),PMSV2Cycle.onChangeApplicableFields(eData))}),PMSV2Cycle.getHikeTerms(),pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction(),pageId.find("#hkFldType").on("zselectchange",function(event,eData){PMSV2Cycle.changeRuleType(eData)})},defaultOption:()=>{var pageId=settingsPage.container;let selOpt=pageId.find("#cycleAppliDiv_nw #empTypeAppliDiv select[type=valFld]");selOpt.empty(),$.each(PMSV2Cycle.ALL_EMPTYPES,function(key,value){selOpt.append(jQuery("<option />",{value:value.typeId,id:value.typeId}).html(value.typeName))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.allEmpTypes")}),selOpt.attr("keySel","APPL_EMPTYPE"),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)}),(selOpt=pageId.find("#cycleAppliDiv_nw #designationAppliDiv select[type=valFld]")).empty(),$.each(PMSV2Cycle.ALL_DESIGNATION,function(key,value){selOpt.append(jQuery("<option />",{value:value.desId,id:value.desId}).html(value.desName))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),ZPeopleComponents.select(selOpt).setAttributes({placeholder:ZPI18N.getString("zp.alldesignation")}),selOpt.attr("keySel","APPL_DES"),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)}),(selOpt=pageId.find("#hkApprSel")).empty(),selOpt.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),$.each(PMSV2Cycle.HIKE_EMP_LOOKUPS,function(key,value){selOpt.append(jQuery("<option />",{value:key,id:key}).html(value))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),(selOpt=pageId.find("#appCurrSelID")).empty(),void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?(selOpt.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),$.each(PMSV2Cycle.compensationData.config_currencies,function(key,value){selOpt.append(jQuery("<option />",{value:value.currencyid,id:value.currencyid}).html(value.currencystring))}),ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:pageId,fitForElement:!0}}),selOpt.on("zselectchange",function(event,edata){PMSV2Cycle.isBudgetCheck?PMSV2Cycle.recalculateSalaryOnApplChange(edata):PMSV2Cycle.onChangeApplicableFields(edata)})):pageId.find("#empCurrencyAppliDiv").hide(),PMSV2Cycle.IS_DATE_OF_CONFIRMATION_ENABLED?1==ZPeopleComponents.select($("#dojKey")).getOptions().length&&ZPeopleComponents.select(pageId.find("#dojKey")).addOption([{value:2,label:ZPI18N.getString("zp.dateofconfirmation")}]):ZPeopleComponents.select(pageId.find("#dojKey")).removeOption([2]),pageId.find("#enablehikedeviation").prop("checked",!1),PMSV2Cycle.showHikedeviation()},saveSalaryCycleConfig:function(){PMSV2Cycle.removeError(),PMSV2Cycle.getFormApprovalDetails(),PMSV2Cycle.DATEERROR=!1;var pageId=settingsPage.container;let isValid=!0;PMSV2Cycle.TAB_SCROLL=!1;let tabScrollFlg=!1;var formData=new FormData;let isBDValid=PMSV2Cycle.basicDetValidation();if(""!==pageId.find("#cyclePeriodID").val()){var dateVal=pageId.find("#cyclePeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cyclePeriodID","salCyclefromDate","salCycletoDate",formData,!1)}else PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.emptycycleperiod"),pageId.find("#cyclePeriodID"),2);if(!isBDValid||PMSV2Cycle.DATEERROR){let bdLi=pageId.find("[show=nwCylbasicDetDiv]");SalaryHikeV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}let cycleName=pageId.find("#cycleName").val().trim();formData.append("salaryperiodname",cycleName);let cycleDesc=pageId.find("#cycleDesc").val().trim();if(formData.append("salCycledescription",cycleDesc),PMSV2Cycle.DATEERROR=!1,formData=SalaryHikeV2Cycle.salCycledateValidationandSetParam(formData),PMSV2Cycle.DATEERROR&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylPeriodDiv]");SalaryHikeV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}if(PMSV2Cycle.DATEERROR=!1,formData=PMSV2Cycle.getApplicableCriObj(formData),PMSV2Cycle.DATEERROR&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylAppliDiv]");SalaryHikeV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}if(formData.has("applicable_date")&&(formData.append("salapplicable_date",formData.get("applicable_date")),formData.delete("applicable_date")),formData.has("applicable_todate")&&(formData.append("salapplicable_todate",formData.get("applicable_todate")),formData.delete("applicable_todate")),formData.has("applicable_currency")&&(formData.append("salCyclecompensationCurrencyId",formData.get("applicable_currency")),formData.delete("applicable_currency")),!PMSV2Cycle.hikeValidation()&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylhkDetDiv]");SalaryHikeV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}var hikeDeciderID=pageId.find("#hkApprSel").val();formData.append("salCyclehikeDeciderInp",hikeDeciderID);let afterHikeApproval=pageId.find("#hkApproval").is(":checked");formData.append("salCycleafterHikeApprovalInp",afterHikeApproval);let promotionOnHike=pageId.find("#incProp").is(":checked");formData.append("salCyclepromotionOnHikeInp",promotionOnHike);let salCycleShowPrevRatingInp=pageId.find("#showprevRating").is(":checked");formData.append("salCycleShowPrevRatingInp",salCycleShowPrevRatingInp);let hikePublishDt=ZPeopleComponents.datetimefield(pageId.find("#cyHkPushID")).getValue().dateString;if(void 0!==hikePublishDt){let hikePublishdateTime=Calendar.parseDate(Calendar.convertHourFormat(hikePublishDt),uidateFormat,!0),hikePublishdate=Calendar.parseDate(hikePublishDt,uidateFormat),fromDate=null,toDate=null,dateVal=pageId.find("#cyHkPeriodID").val();if(6===dateVal.split("-").length){let date=dateVal.split("-");fromDate=date[0]+"-"+date[1]+"-"+date[2],toDate=date[3]+"-"+date[4]+"-"+date[5]}else if(2===dateVal.split("-").length){let date=dateVal.split("-");fromDate=date[0],toDate=date[1]}let tdate="",fdate="";if(null!=fromDate&&(fdate=Calendar.parseDate(fromDate,uidateFormat)),null!=toDate&&(tdate=Calendar.parseDate(toDate,uidateFormat)),hikePublishdate<=tdate){let bdLi=pageId.find("[show=nwCylPeriodDiv]");SalaryHikeV2Cycle.tabSwitchAction(bdLi),PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.hikepublisherror",[PMSV2Cycle.HIKENAME]),pageId.find("#cyHkPushID-container"),2),tabScrollFlg=!0,isValid=!1}else{if(hikePublishdateTime<new Date){let bdLi=pageId.find("[show=nwCylPeriodDiv]");SalaryHikeV2Cycle.tabSwitchAction(bdLi),PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.currentdatetimeerror",[PMSV2Cycle.HIKENAME]),pageId.find("#cyHkPushID-container"),2),tabScrollFlg=!0,flag=!0}}formData.append("salCyclehikePublishDate",hikePublishDt)}var budConfigObj=PMSV2Cycle.budgetConfigValidation();if(PMSV2Cycle.BUDGETCONFIGERROR&&!tabScrollFlg){let bdLi=pageId.find("[show=nwCylhkDetDiv]");SalaryHikeV2Cycle.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}else formData.append("budgetConfig",JSON.stringify(budConfigObj));formData.append("conreqcsr",csrfToken),PMSV2Cycle.EDIT_CYCLE_FLAG?PMSV2Cycle.CLONE_CYCLE_FLAG?formData.append("modeval","add"):(formData.append("salCycleConfigId",PMSV2Cycle.SELECTED_TMPL.configId),formData.append("salCyclemodeval","editConfig")):formData.append("salCyclemodeval","add"),isValid?(pageId.find("#salCycleSaveBtn").attr("disabled","disabled"),$.ajax({url:"/performanceConfig.zp?mode=newaddSalaryHikeCycle",type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){pageId.find("#salCycleSaveBtn").removeAttr("disabled"),"success"===data.msg?(ZPeople.Message.success(ZPI18N.getString("zp.cycleconfigsuccessmsg")),SalaryHikeV2Cycle.afterSave(data)):"PERIOD_NAME_EMPTY"===data.msg?PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.emptycycle"),pageId.find("#cycleName")):"NAME_ALREADY_EXIST"===data.msg?PMSV2Cycle.showError(ZPI18N.getString("zp.duplicateSkill",[ZPI18N.getString("zp.salaryhikecyclename",[""])]),pageId.find("#cycleName")):"DATE_OF_CONFIRMATION"==data.msg?(SalaryHikeV2Cycle.tabSwitchAction(pageId.find("[show=nwCylAppliDiv]")),PMSV2Cycle.showError("Date Of Confirmation is not enabled",Layout.Page.container.find("#dojKey"),2)):"Permission denied"===data.msg?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},error:function(err){pageId.find("#salCycleSaveBtn").removeAttr("disabled"),ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))}})):ZPeople.Message.failure(ZPI18N.getString("zp.cycle.errormsg.entermissingdetails"))},salCycledateValidationandSetParam:function(formData){let pageId=settingsPage.container;if(void 0!=pageId.find("#cyHkPeriodID").val()&&""!==pageId.find("#cyHkPeriodID").val()){var dateVal=pageId.find("#cyHkPeriodID").val();PMSV2Cycle.setDateValues(dateVal,"cyHkPeriodID","salCyclehikefromDate","salCyclehiketoDate",formData,!1)}else PMSV2Cycle.DATEERROR=!0,PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.emptycycleperiod"),pageId.find("#cyHkPeriodID"),2);return formData},showEditSalaryCycleConfiguration:function(configId,mode){PMSV2Cycle.SELECTED_TMPL=null,PMSV2Cycle.isApplAllowed=!1,PMSV2Cycle.EDIT_CYCLE_FLAG="edit"===mode,PMSV2Cycle.CLONE_CYCLE_FLAG=!1;var params={mode:"salaryCycleDetails",configId:configId,conreqcsr:csrfToken};"clone"===mode&&(PMSV2Cycle.CLONE_CYCLE_FLAG=!0,PMSV2Cycle.EDIT_CYCLE_FLAG=!0,params.cycleMode="clone"),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(resultData){PMSV2Cycle.SELECTED_TMPL=resultData}}),SalaryHikeV2Cycle.showSalaryHikeV2CycleAddConfig(),SalaryHikeV2Cycle.setSalaryEditValues()},setSalaryEditValues:function(){let pageId=settingsPage.container,tmplVal=PMSV2Cycle.SELECTED_TMPL,isCycleEdit=PMSV2Cycle.EDIT_CYCLE_FLAG,isCycleClone=PMSV2Cycle.CLONE_CYCLE_FLAG;PMSV2Cycle.SELECTED_DOJUTIL_DATE=null;let fieldLockFlg=!1;if(PMSV2Cycle.isBudgetCalc=!1,PMSV2Cycle.APP_DEPARTMENT={},PMSV2Cycle.APP_DESIGNATION={},PMSV2Cycle.isApplAllowed=!1,PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck(),isCycleEdit){isCycleEdit&&!isCycleClone&&(pageId.find("#hdrLbl").html(ZPI18N.getString("zp.editappraisalcycle")),fieldLockFlg=!0);let cycNme=ZPeople.decodeTxt(tmplVal.periodName);if(isCycleClone&&(cycNme=cycNme+" ("+ZPI18N.getString("zp.clone")+")"),pageId.find("#cycleName").val(cycNme),pageId.find("#cycleDesc").val(ZPeople.decodeTxt(tmplVal.description)),pageId.find("#nwCylAppliDiv").addClass("zpl_act"),ZPeopleComponents.daterangepicker("#cyPrdPicker").setFromValue(tmplVal.salCycleFromDate),ZPeopleComponents.daterangepicker("#cyPrdPicker").setToValue(tmplVal.salCycleToDate),isCycleEdit&&!isCycleClone&&1==ZPeopleComponents.select(pageId.find("#dojKey")).getOptions().length&&ZPeopleComponents.select(pageId.find("#dojKey")).addOption([{value:2,label:ZPI18N.getString("zp.dateofconfirmation")}]),void 0!=tmplVal.applicableDateType){var applicableDateType=tmplVal.applicableDateType,setDateApplicable=!0;if(isCycleClone&&2==applicableDateType&&!PMSV2Cycle.IS_DATE_OF_CONFIRMATION_ENABLED&&(setDateApplicable=!1,ZPeopleComponents.select(pageId.find("#dojKey")).removeOption([2])),setDateApplicable){ZPeopleComponents.select(pageId.find("#dojKey")).setValue(applicableDateType.type);var isChanged=!1;if(PMSV2Cycle.applObj.dateType=applicableDateType.type,void 0!=applicableDateType.until)ZPeopleComponents.select(pageId.find("#dojCrt")).setValue("DOJ_UNTIL"),ZPeopleComponents.datefield(pageId.find("#dojVal1")).setValue(applicableDateType.until),PMSV2Cycle.SELECTED_DOJUTIL_DATE=applicableDateType.until,PMSV2Cycle.applObj.DOJ=applicableDateType.until,isChanged=!0;else if(void 0!=applicableDateType.fromDate&&void 0!=applicableDateType.toDate){ZPeopleComponents.select(pageId.find("#dojCrt")).setValue("DOJ_FRM_TO"),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker").setFromValue(applicableDateType.fromDate),ZPeopleComponents.daterangepicker("#cyApplFrmToPrdPicker").setToValue(applicableDateType.toDate),(arr=[]).push(applicableDateType.fromDate),arr.push(applicableDateType.toDate),PMSV2Cycle.applObj.DOJfromTo=arr,isChanged=!0}if(void 0!=applicableDateType.monthList&&applicableDateType.monthList.length>0){var selectId=isChanged?"_2":"";isChanged&&PMSV2Cycle.addDateOfApplicableCriteria(),ZPeopleComponents.select(pageId.find("#dojCrt"+selectId)).setValue("DOJ_MTH"),ZPeopleComponents.select(pageId.find("#dojMthVal"+selectId)).setValue(applicableDateType.monthList),isChanged?PMSV2Cycle.applObj.DOJmonth_2=applicableDateType.monthList:PMSV2Cycle.applObj.DOJmonth=applicableDateType.monthList}isChanged||PMSV2Cycle.deleteDateOfApplicableCriteria(),PMSV2Cycle.applObj.DOJType=applicableDateType}}var tempArr=new Array;if(tmplVal.empType.length>0&&""!==tmplVal.empType){for(i=0;i<tmplVal.empType.length;i++)tempArr.push(tmplVal.empType[i].typeId);ZPeopleComponents.select(pageId.find("[keysel=APPL_EMPTYPE]")).setValue(tempArr),PMSV2Cycle.applObj.empType=tempArr}else ZPeopleComponents.select(pageId.find("[keysel=APPL_EMPTYPE]")).setValue([]);if(tempArr=new Array,tmplVal.designation.length>0&&""!==tmplVal.designation){for(tempArr=new Array,i=0;i<tmplVal.designation.length;i++)tempArr.push(tmplVal.designation[i].desId);ZPeopleComponents.select(pageId.find("[keysel=APPL_DES]")).setValue(tempArr),PMSV2Cycle.applObj.designation=tempArr}else ZPeopleComponents.select(pageId.find("[keysel=APPL_DES]")).setValue([]);if(tmplVal.location.length>0&&""!==tmplVal.location){for(PMSV2Cycle.addApplicableCriteria(null,"location"),tempArr=new Array,i=0;i<tmplVal.location.length;i++)tempArr.push(tmplVal.location[i].locationId);ZPeopleComponents.select(pageId.find("[keysel=APPL_LOC]")).setValue(tempArr),PMSV2Cycle.applObj.location=tempArr}if(tmplVal.role.length>0&&""!==tmplVal.role){for(PMSV2Cycle.addApplicableCriteria(null,"role"),tempArr=new Array,i=0;i<tmplVal.role.length;i++)tempArr.push(tmplVal.role[i].roleId);ZPeopleComponents.select(pageId.find("[keysel=APPL_ROLE]")).setValue(tempArr),PMSV2Cycle.applObj.role=tempArr}if(tmplVal.department.length>0&&""!==tmplVal.department){for(PMSV2Cycle.addApplicableCriteria(null,"department"),tempArr=new Array,i=0;i<tmplVal.department.length;i++)tempArr.push(tmplVal.department[i].departmentId);PMSV2Cycle.applObj.department=tempArr,ZPeopleComponents.select(pageId.find("[keysel=APPL_DEP]")).setValue(tempArr)}if(tmplVal.level.length>0&&""!==tmplVal.level){for(PMSV2Cycle.addApplicableCriteria(null,"level"),tempArr=new Array,i=0;i<tmplVal.level.length;i++)tempArr.push(tmplVal.level[i].lvlID);PMSV2Cycle.applObj.level=tempArr,ZPeopleComponents.select(pageId.find("[keysel=APPL_LVL]")).setValue(tempArr)}if(void 0!=tmplVal.customDateFCID&&"-1"!=tmplVal.customDateFCID){var obj={};PMSV2Cycle.addApplicableCriteria(null,"customDate");var selType=tmplVal.cdType;tmplVal.cdType;"1"==selType?(obj.selType=0,ZPeopleComponents.select(pageId.find("#cstCrt")).setValue("CST_DATE"),ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker").setFromValue(tmplVal.customFromDate),ZPeopleComponents.daterangepicker("#cyApplCstPrdPicker").setToValue(tmplVal.customToDate),obj.from=tmplVal.customFromDate,obj.to=tmplVal.customToDate):(obj.selType=1,ZPeopleComponents.select(pageId.find("#cstCrt")).setValue("CST_MTH"),ZPeopleComponents.select(pageId.find("#cstMthVal")).setValue(tmplVal.customMonth),obj.month=tmplVal.customMonth),ZPeopleComponents.select(pageId.find("#cstKey")).setValue(tmplVal.customDateFCID),obj.customDate=tmplVal.customDateFCID,PMSV2Cycle.applObj.customDate=obj}if(void 0!=tmplVal.expFilter&&tmplVal.expFilter.length>0){PMSV2Cycle.addApplicableCriteria(null,"totalWrkExp");var expObj=tmplVal.expFilter,operator=expObj[0].operator,arr=[];(obj={}).operator=expObj[0].operator,obj.from=expObj[0].from,ZPeopleComponents.select(pageId.find("#expCrt")).setValue(operator),pageId.find("#expFrom").val(expObj[0].from),5==operator&&(obj.to=expObj[0].to,pageId.find("#expTo").val(expObj[0].to)),arr.push(obj),PMSV2Cycle.applObj.totalWrkExp=arr}if(pageId.find("#nwCylAppliDiv").removeClass("zpl_act"),null!=tmplVal.hikeFromDt&&null!=tmplVal.hikeToDt&&(ZPeopleComponents.daterangepicker("#cyHkPrdPicker").setFromValue(tmplVal.hikeFromDt),ZPeopleComponents.daterangepicker("#cyHkPrdPicker").setToValue(tmplVal.hikeToDt)),null!=tmplVal.hikePublishDt&&ZPeopleComponents.datetimefield(pageId.find("#cyHkPushID")).setValue(tmplVal.hikePublishDt),!isCycleClone&&isCycleEdit)if(void 0!=tmplVal.compensationApplicableCurrencyStr)if(0!=tmplVal.periodStatus&&5!=tmplVal.periodStatus)void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue(tmplVal.compensationApplicableCurrency),pageId.find("#appCurrSelDiv").find(".ztextbox--error__label").remove(),ZPeopleComponents.select($("#appCurrSelID")).getElement().removeClass("ztextbox__error"),PMSV2Cycle.applObj.empCurrency=tmplVal.compensationApplicableCurrency,pageId.find("#empCurrencyAppliDiv").show()):(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1"),pageId.find("#empCurrencyAppliDiv").hide());else if(0==pageId.find("#appCurrSelID").find("#"+tmplVal.compensationApplicableCurrency).length){var options=[{label:tmplVal.compensationApplicableCurrencyStr,value:tmplVal.compensationApplicableCurrency}];ZPeopleComponents.select(pageId.find("#appCurrSelID")).addOption(options),ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue(tmplVal.compensationApplicableCurrency),pageId.find("#appCurrSelDiv").find(".ztextbox--error__label").remove(),ZPeopleComponents.select($("#appCurrSelID")).getElement().removeClass("ztextbox__error"),pageId.find("#empCurrencyAppliDiv").show()}else ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue(tmplVal.compensationApplicableCurrency),pageId.find("#empCurrencyAppliDiv").show();else 0!=tmplVal.periodStatus&&5!=tmplVal.periodStatus&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1"),pageId.find("#empCurrencyAppliDiv").show()):(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1"),pageId.find("#empCurrencyAppliDiv").hide());else isCycleClone&&(void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue(tmplVal.compensationApplicableCurrency),pageId.find("#appCurrSelDiv").find(".ztextbox--error__label").remove(),ZPeopleComponents.select($("#appCurrSelID")).getElement().removeClass("ztextbox__error"),pageId.find("#empCurrencyAppliDiv").show()):pageId.find("#empCurrencyAppliDiv").hide());tmplVal.initBudgetLoad=!0;let budgetData=tmplVal.budgetDetails;budgetData.hikeRuleType;if(void 0!=PMSV2Cycle.applObj.designation&&0!=PMSV2Cycle.applObj.designation.length?PMSV2Cycle.APP_DESIGNATION=PMSV2Cycle.applObj.designation:PMSV2Cycle.APP_DESIGNATION=Object.keys(budgetData.designationList),void 0!=PMSV2Cycle.applObj.department&&0!=PMSV2Cycle.applObj.department.length?PMSV2Cycle.APP_DEPARTMENT=PMSV2Cycle.applObj.department:PMSV2Cycle.APP_DEPARTMENT=Object.keys(budgetData.departmentList),isCycleClone&&void 0==tmplVal.compensationApplicableCurrency&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource)pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction();else{var ruleDetails=budgetData.ruleDetails;PMSV2Cycle.hikeAmtArr={},PMSV2Cycle.SelCustArr=new Map,PMSV2Cycle.isChanged=!1,PMSV2Cycle.curRule=new Map,PMSV2Cycle.hikeAmtArr=budgetData.ruleAmt;let mode="add";PMSV2Cycle.isCycStarted=!1,isCycleClone||0!=PMSV2Cycle.SELECTED_TMPL.periodStatus?isCycleClone&&(mode="clone"):(PMSV2Cycle.isCycStarted=!0,mode="view"),pageId.find("#totalEmpCnt").text(budgetData.totalEmpCnt),pageId.find("#totalAmount").text(Number(budgetData.totalAmount).toFixed(2)),pageId.find("#totalAmount").attr("totalAmount",budgetData.totalAmount);let ruleLen=void 0!=ruleDetails&&ruleDetails.length>0?ruleDetails.length:0;if("view"==mode&&(ruleLen-=1),ruleLen>0?(PMSV2Cycle.hikeAmtObj={},"add"!=mode&&"view"!=mode||(PMSV2Cycle.hikeAmtObj=budgetData.ruleAmt),pageId.find("#hkBsdOn").find("#hikeBaseRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction(),PMSV2Cycle.buildCreatedCustomRules(budgetData,mode),pageId.find("#hikePercentage").val(parseFloat(budgetData.hikePercentage).toFixed(2))):(pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction()),"add"==mode||"clone"==mode){PMSV2Cycle.checkTempRule(),pageId.find("#hikePercentage").val(parseFloat(budgetData.hikePercentage).toFixed(2)),pageId.find("#totAmountView").text(parseFloat(budgetData.totalcalcHikeAmount).toFixed(2));var totalAmt=Number(budgetData.totalcalcHikeAmount)+Number(budgetData.totalAmount);pageId.find("#totalAmountAfterHike").text(parseFloat(totalAmt).toFixed(2))}else if("view"==mode){var hikeAmount=parseFloat(budgetData.totalAmountAfterHike)-Number(budgetData.totalAmount);pageId.find("#totalAmountAfterHike").text(parseFloat(budgetData.totalAmountAfterHike).toFixed(2)),pageId.find("#totAmountView").text(parseFloat(hikeAmount).toFixed(2)),pageId.find("#hikePercentage").val(parseFloat(budgetData.hikePercentage).toFixed(2)),pageId.find("#hkBsdOn").find("[name=ruleOpt]").prop("disabled",!0)}if("clone"==mode&&ruleLen>1){let lastid=pageId.find(".zpl_paappslyhike").last().attr("series");PMSV2Cycle.SelCustArr.delete(lastid.toString())}}PMSV2Cycle.isApplAllowed=!0,PMSV2Cycle.isBudgetCheck=PMSV2Cycle.booleanBudgetCheck()}if(!isCycleEdit&&!isCycleClone&&(void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1"),pageId.find("#empCurrencyAppliDiv").show()):(ZPeopleComponents.select(pageId.find("#appCurrSelID")).setValue("-1"),pageId.find("#empCurrencyAppliDiv").hide()),tmplVal.budgetEnable)){pageId.find("#hkBsdOn").find("#defaultOptRule").prop("checked",!0),PMSV2Cycle.onHikeBasedAction(),PMSV2Cycle.getNewCycleBudgetDetails();var budgetData=PMSTmpl.BUDGET_CONFIG_DATA;totalAmt=Number(budgetData.totalcalcHikeAmount)+Number(budgetData.totalAmount);pageId.find("#totalAmountAfterHike").text(parseFloat(totalAmt).toFixed(2)),pageId.find("#totalEmpCnt").text(budgetData.totalEmpCnt),pageId.find("#totalAmount").text(parseFloat(budgetData.totalAmount).toFixed(2)),pageId.find("#totAmountView").text(parseFloat(budgetData.totalcalcHikeAmount).toFixed(2))}void 0!==tmplVal.hikeDecider&&null!==tmplVal.hikeDecider&&ZPeopleComponents.select(pageId.find("#hkApprSel")).setValue(tmplVal.hikeDecider),tmplVal.hikeApprovalEnable?(pageId.find("#hkApproval").prop("checked",!0),pageId.find("#hkApprConf").show()):(pageId.find("#hkApproval").prop("checked",!1),pageId.find("#hkApprConf").hide()),tmplVal.promotionOnHikeEnabled?pageId.find("#incProp").prop("checked",!0):pageId.find("#incProp").prop("checked",!1),tmplVal.showprevrating?pageId.find("#showprevRating").prop("checked",!0):pageId.find("#showprevRating").prop("checked",!1),isCycleEdit&&!isCycleClone&&fieldLockFlg&&(0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus||(pageId.find("#nwCylAppliDiv").addClass("zpl_act"),pageId.find("#cycleAppliDiv_doj_nw").find("select").each(function(){ZPeopleComponents.select($(this)).setAttributes({disabled:!0})}),pageId.find("#cycleAppliDiv_doj_nw").find("input").each(function(){let idx=$(this).attr("id");"dojVal1"==idx||"dojVal1_2"==idx?ZPeopleComponents.isComponent($(this))&&ZPeopleComponents.datefield($(this)).setAttributes({disabled:!0}):"dojVal"===idx?ZPeopleComponents.isComponent(pageId.find("#cyApplFrmToPrdPicker"))&&pageId.find("#dojVal").addClass("disabled"):"dojVal_2"==idx&&ZPeopleComponents.isComponent(pageId.find("#cyApplFrmToPrdPicker_2"))&&pageId.find("#dojVal_2").addClass("disabled")}),pageId.find("#addCriDiv_DOJ").addClass("zpl_DNI"),pageId.find("#cycleAppliDiv_doj_nw .PI_delete").addClass("zpl_DNI"),pageId.find("#cycleAppliDiv_nw").find("select").each(function(){ZPeopleComponents.select($(this)).setAttributes({disabled:!0})}),pageId.find("#cycleAppliDiv_nw").find("input").each(function(){let idx=$(this).attr("id");"dojVal1"===idx?ZPeopleComponents.isComponent($(this))&&ZPeopleComponents.datefield($(this)).setAttributes({disabled:!0}):"cstVal"===idx?ZPeopleComponents.isComponent("#cyApplCstPrdPicker")&&pageId.find("#cstVal").addClass("disabled"):"dojVal"===idx?ZPeopleComponents.isComponent(pageId.find("#cyApplFrmToPrdPicker"))&&pageId.find("#dojVal").addClass("disabled"):"expFrom"===idx?pageId.find("#expFrom").addClass("disabled"):"expTo"===idx&&pageId.find("#expTo").addClass("disabled")}),pageId.find("#cycleAppliDiv_nw").find(".PI_delete").addClass("zpl_DNI"),pageId.find("#appliAddButton").addClass("zpl_DNI"),pageId.find("#nwCylAppliDiv").removeClass("zpl_act")),0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus||(ZPeopleComponents.select(pageId.find("#hkApprSel")).setAttribute("disabled","disabled"),pageId.find("#hkApproval").prop("disabled",!0),pageId.find("#incProp").prop("disabled",!0),pageId.find("#hkBsdOn").prop("disabled","disabled"),ZPeopleComponents.isComponent(pageId.find("#hkFldType"))&&ZPeopleComponents.select(pageId.find("#hkFldType")).setAttribute("disabled","disabled")),(PMSV2Cycle.CLONE_CYCLE_FLAG||0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus)&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource||ZPeopleComponents.select(pageId.find("#appCurrSelID")).setAttribute("disabled","disabled")),pageId.find("#enablehikedeviation").prop("checked",tmplVal.budgetDetails.hikedeviationenable),PMSV2Cycle.showHikedeviation(),tmplVal.budgetDetails.hikedeviationenable&&pageId.find("#hikedeviationper").val(parseFloat(tmplVal.budgetDetails.hikedeviationper).toFixed(2))},destroyCyclePageComponents:function(){var pageId=settingsPage.container;ZPeopleComponents.isComponent(pageId.find("#dojKey"))&&ZPeopleComponents.select(pageId.find("#dojKey")).destroy(),ZPeopleComponents.isComponent(pageId.find("#dojCrt"))&&ZPeopleComponents.select(pageId.find("#dojCrt")).destroy(),ZPeopleComponents.isComponent(pageId.find("#dojCrt_2"))&&ZPeopleComponents.select(pageId.find("#dojCrt_2")).destroy(),ZPeopleComponents.isComponent(pageId.find("#dojMthVal"))&&ZPeopleComponents.select(pageId.find("#dojMthVal")).destroy(),ZPeopleComponents.isComponent(pageId.find("#dojMthVal_2"))&&ZPeopleComponents.select(pageId.find("#dojMthVal_2")).destroy(),pageId.find("select[type=keyFld]").each(function(){ZPeopleComponents.select($(this)).destroy()}),pageId.find("select[type=crtFld]").each(function(){ZPeopleComponents.select($(this)).destroy()}),pageId.find("select[type=valFld]").each(function(){ZPeopleComponents.select($(this)).destroy()}),pageId.find("#customDateAppliDiv").length>0&&(ZPeopleComponents.select(pageId.find("#cstKey")).destroy(),ZPeopleComponents.select(pageId.find("#cstCrt")).destroy(),ZPeopleComponents.isComponent(pageId.find("#cstMthVal"))&&ZPeopleComponents.select(pageId.find("#cstMthVal")).destroy()),pageId.find("#totalWrkExpAppliDiv").length>0&&(ZPeopleComponents.select(pageId.find("#expKey")).destroy(),ZPeopleComponents.select(pageId.find("#expCrt")).destroy()),pageId.find("#appliMenuList").length>0&&ZPeopleComponents.menu("#appliMenuList").destroy(),$("#appliMenuList").remove(),pageId.find("#appCurrSelID").length>0&&ZPeopleComponents.select(pageId.find("#appCurrSelID")).destroy(),pageId.find("#hkApprSel").length>0&&ZPeopleComponents.select(pageId.find("#hkApprSel")).destroy(),pageId.find("#hkBsdOn").length>0&&ZPeopleComponents.select(pageId.find("#hkBsdOn")).destroy(),ZPeopleComponents.isComponent(pageId.find("#hkFldType"))&&ZPeopleComponents.select(pageId.find("#hkFldType")).destroy(),pageId.find("#chooseCustOpt").length>0&&ZPeopleComponents.tokenfield(pageId.find("#chooseCustOpt")).destroy(),pageId.find("#custRules").length>0&&($("#custRules select").each(function(){ZPeopleComponents.select($(this)).destroy()}),$("#custRules textarea").each(function(){ZPeopleComponents.tokenfield($(this)).destroy()}))},dateRangeInitialization:function(){var pageId=settingsPage.container;let tmplVal=PMSV2Cycle.SELECTED_TMPL,isCycleEdit=PMSV2Cycle.EDIT_CYCLE_FLAG;ZPeopleComponents.daterangepicker("#cyPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyclePeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt,fromValue:isCycleEdit?tmplVal.cyclefromdate:"",toValue:isCycleEdit?tmplVal.cycletoDate:""});var picker=pageId.find("#cyPrdPicker");pageId.find("#cyclePeriodID,#cyclePeriodID_Icon").on("click",function(){pageId.find("#cyPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker).close():ZPeopleComponents.daterangepicker(picker).open()}),ZPeopleComponents.daterangepicker("#cyHkPrdPicker",{change:function(event){var ui=event.detail;pageId.find("#cyHkPeriodID").val(ui.fromValueString+"-"+ui.toValueString)},format:dateFmt});let picker6=pageId.find("#cyHkPrdPicker");pageId.find("#cyHkPeriodID,#cyHkPeriodID_Icons").on("click",function(){pageId.find("#cyHkPrdPicker").is(":visible")?ZPeopleComponents.daterangepicker(picker6).close():ZPeopleComponents.daterangepicker(picker6).open()})},SalaryHikeConfigpageClose:function(){PMSV2Cycle.isCycleAddEditPageValueChangedInit(SalaryHikeV2Cycle.salarycyclePageClose)},salarycyclePageClose:function(){SalaryHikeV2Cycle.destroyCyclePageComponents(),settingsPage.container.html(""),SalaryHikeV2Cycle.initSalaryCyclePage()},startSalHikeCycleProcess:function(obj){let confId=$(obj).parents(".zpl_catlst").attr("configid");var params={mode:"getBudgetDetailsByConfigID",configID:confId};ZPeople.Request.send(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(data){let salDataAvlFlg=!0;data.isBudgetEnable?"SUCCESS"===data.status?-1===data.configDetails.status&&data.salaryNotAvailable.length>0?(PMSV2Cycle.showSalaryNotAvailableModal(data),salDataAvlFlg=!1):salDataAvlFlg=!0:salDataAvlFlg=!1:salDataAvlFlg=!0;if(salDataAvlFlg)if($(obj).prop("disabled",!0),void 0!==confId&&null!==confId&&""!=confId){var params={mode:"salaryCycleprepopulate",configId:confId,conreqcsr:csrfToken};$.post("/performanceConfig.zp",params,function(resultData){$(obj).prop("disabled",!1);var parseObj=resultData;parseObj.length>0&&$.each(parseObj,function(index,data){if("nousers"===data.msg)ZPeople.Message.warning(ZPI18N.getString("zp.nousersinconfig"));else if("permission denied"===data.msg)ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied"));else if("error"===data.msg)ZPeople.Message.failure(ZPI18N.getString("zp.errorinaddingconfig"));else if(void 0!==data.msg&&"success"==data.msg)PMSOperation.loadCycles(),ZPeople.Message.success(ZPI18N.getString("zp.startedsuccess"));else if("BUDGET_NOT_MAPPED"===data.msg){var hikename=ZPeople.decodeTxt(PMSV2Cycle.HIKENAME);ZPeople.Message.warning(ZPI18N.getString("zp.budgetnotmapped",[ZPeople.escapeHtml(hikename)]))}else if("BUDGET_NOT_APPROVED"===data.msg){var statusMsg="-1"===data.budgetApprovalStatus?ZPI18N.getString("zp.pending"):"0"===data.budgetApprovalStatus?ZPI18N.getString("zp.rejected"):ZPI18N.getString("zp.nostatus");ZPeople.Message.warning(ZPI18N.getString("zp.budgetstatus",[statusMsg]))}else"BUDGET_CURRENCY_NOT_CONFIGURED"===data.msg?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.performance.applicablecurrencynotconfigured")):"COMPENSATION_DISABLED"===data.msg?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.performance.addconfigcompensationdisabled")):"COMPENSATION_SALARY_DISABLED"===data.msg&&ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.performance.addconfigcompensationsalarydisable"))})})}else ZPeople.Message.failure(ZPI18N.getString("zp.datanotpopulated"))})},afterSave:function(data){if(SalaryHikeV2Cycle.destroyCyclePageComponents(),null!=data){settingsPage.container.html(""),SalaryHikeV2Cycle.initSalaryCyclePage();let flg=!0,budgetData=data.budgetData;if("SUCCESS"===budgetData.status)if(-1===budgetData.configDetails.status)budgetData.salaryNotAvailable.length>0&&(PMSV2Cycle.showSalaryNotAvailableModal(budgetData),flg=!1)}else PMSV2Cycle.EDIT_CYCLE_FLAG=!1,settingsPage.container.html(""),SalaryHikeV2Cycle.initSalaryCyclePage()},prevBtn:function(){let li=settingsPage.container.find(".zpl_mmnulft ul li.zpl_act").prev();SalaryHikeV2Cycle.tabSwitchAction(li)},nxtBtn:function(){let li=settingsPage.container.find(".zpl_mmnulft ul li.zpl_act").next();SalaryHikeV2Cycle.tabSwitchAction(li)},leftTabConstruct:function(){var pageId=settingsPage.container;let cnt=1,li="";for(let i=0;i<SalaryHikeV2Cycle.LEFT_TAB_ARRAY.length;i++){let t=SalaryHikeV2Cycle.LEFT_TAB_ARRAY[i],v=SalaryHikeV2Cycle.LEFT_TAB_K_V[t];if(void 0!==v){let cls="";1===cnt&&(cls="zpl_act"),li+='<li onclick="SalaryHikeV2Cycle.tabSwitchAction(this);" show="'+t+'" class="'+cls+'"><b>'+cnt+"</b><a>"+v+"</a></li>",cnt++}}pageId.find(".zpl_mmnulft ul").html(li),pageId.find("#nwCylbasicDetDiv").addClass("zpl_act"),pageId.find("#prevBtn").addClass("disabled"),pageId.find("#nxtBtn").removeClass("disabled")},tabSwitchAction:function(li){let pageId=settingsPage.container,ul=$(li).parents("ul");$(ul).find(".zpl_act").removeClass("zpl_act"),$(li).addClass("zpl_act"),pageId.find(".zpl_mmnurgt").find("[sec=tab].zpl_act").removeClass("zpl_act");let actId=$(li).attr("show");pageId.find(".zpl_mmnurgt #"+actId).addClass("zpl_act");let s=pageId.find(".zpl_mmnulft ul li.zpl_act").attr("show");"nwCylhkDetDiv"==s&&PMSV2Cycle.isBudgetCalc&&(PMSV2Cycle.CLONE_CYCLE_FLAG||void 0==PMSV2Cycle.SELECTED_TMPL||void 0!=PMSV2Cycle.SELECTED_TMPL&&0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus)&&(PMSV2Cycle.onHikeBasedAction(),PMSV2Cycle.budgetResetCalcFunc()),"nwCylhkDetDiv"==actId&&void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource&&(PMSV2Cycle.CLONE_CYCLE_FLAG||void 0==PMSV2Cycle.SELECTED_TMPL||void 0!=PMSV2Cycle.SELECTED_TMPL&&0!=PMSV2Cycle.SELECTED_TMPL.periodStatus&&5!=PMSV2Cycle.SELECTED_TMPL.periodStatus)&&PMSV2Cycle.currencyErr(),"nwCylbasicDetDiv"===s?pageId.find("#prevBtn").addClass("disabled"):pageId.find("#prevBtn").removeClass("disabled"),"nwCylPeriodDiv"===s?pageId.find("#nxtBtn").addClass("disabled"):pageId.find("#nxtBtn").removeClass("disabled")},postSelTgBtnAction:function(compName,status){if(1===status){let idx=SalaryHikeV2Cycle.LEFT_TAB_ARRAY.indexOf(compName+"_hide");SalaryHikeV2Cycle.LEFT_TAB_ARRAY[idx]=compName,SalaryHikeV2Cycle.leftTabConstruct()}else{let idx=SalaryHikeV2Cycle.LEFT_TAB_ARRAY.indexOf(compName);SalaryHikeV2Cycle.LEFT_TAB_ARRAY[idx]=compName+"_hide",SalaryHikeV2Cycle.leftTabConstruct()}},isSalaryHikeCycleValueChanged:function(){let isCompleted=!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&5==PMSV2Cycle.CYCLE_EDIT_VALUE.periodStatus,isStarted=!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD&&(0==PMSV2Cycle.CYCLE_EDIT_VALUE.periodStatus||isCompleted),name=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#cycleName").val();if(PMSV2Cycle.isInputFieldChanged("periodName",name))return!0;if(discription=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#cycleDesc").val(),PMSV2Cycle.isInputFieldChanged("description",discription))return!0;if(PMSV2Cycle.isDateRangeValueChanged("cyclePeriodID","",!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD,"salCycleFromDate","salCycleToDate"))return!0;if(!isStarted&&PMSV2Cycle.isApplicableValueChanged(!0))return!0;let hikeApprovalEnable=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#hkApproval").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("hikeApprovalEnable",hikeApprovalEnable))return!0;let hikeDecider=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#hkApprSel").val();if(PMSV2Cycle.isInputFieldChanged("hikeDecider",hikeDecider,-1))return!0;let promotionOnHikeEnabled=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#incProp").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("promotionOnHikeEnabled",promotionOnHikeEnabled))return!0;let showprevRating=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#showprevRating").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("showprevrating",showprevRating))return!0;let hikeOption=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#hkBsdOn").find("[name=ruleOpt]:checked").val();return!!PMSV2Cycle.isBudgetDetailsChanged(hikeOption)||(!!PMSV2Cycle.isDateRangeValueChanged("cyHkPeriodID","",!PMSV2Cycle.IS_CYCLE_PAGE_CHANGE_ADD,"hikeFromDt","hikeToDt")||!!PMSV2Cycle.isDateAndTimeValueChanged("cyHkPushID","hikePublishDt"))}};class OprCardMessage{static setNoData(container,options){let htmlContent='<div id="emptPage" class="zpl_crd wd100_per"><div class="zpl_Emptydata"><div><div class="zpl_emptimg '+options.className+'"></div>';options.text&&(htmlContent+="<h4>"+options.text+"</h4>"),options.subText&&(htmlContent+="<p>"+options.subText+"</p>"),options.buttonText&&(htmlContent+='<font><button class="zlabel zlabel--blue zlabel--medium">'+options.buttonText+"</button></font>"),htmlContent+="</div></div></div></div>",options.isAppend?container.append(htmlContent):container.html(htmlContent),"function"==typeof options.buttonCallback&&container.find("button").on("click",options.buttonCallback)}}var PMSCommon={PERFORMANCE_CONFIG_URL:"/performanceConfig.zp",MONTHLY:3,QUARTERLY:5,HALF_YEARLY:6,YEARLY:4,CFS_SELF:"CFS_SELF",CFS_REVIEWER:"CFS_REVIEWER",PENDING:"Pending",COMPLETED:"Completed",CFS_DAILY_NOTIFY_CONSTANTS:99,APPROVAL_LKUP:"APPROVALLKUP",CFS_LKUP:"CFSLKUP",STAR_RATING:0,NUMBER_RATING:1,TEXT_RATING:2,CUSTOM_RATING:3,EXCLUDE_RATING_VALUE:-1,KRA_SORT_DEFAULT:0,KRA_SORT_WEIGHTAGE_ASC:1,HIKE_NO_RULE:0,HIKE_DESIGNATION:1,HIKE_TOTAL_EXPERIENCE:2,HIKE_DATE_OF_JOIN:3,HIKE_DEPARTMENT:4,HIKE_RATING:5,HIKE_NAME:"HIKE_NAME",ALLOCATED_HIKE_NAME:"ALLOCATED_HIKE_NAME",PROPOSED_HIKE_NAME:"PROPOSED_HIKE_NAME",SALARY_HIKE_NAME:"SALARY_HIKE_NAME",PA_GOAL_SETTINGS_NEWJOINEE_SELF_NOTIFY:"PA_GOAL_SETTINGS_NEWJOINEE_SELF_NOTIFY",PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY:"PA_GOAL_SETTINGS_NEWJOINEE_RM_NOTIFY",APPRAISAL_CYCLE_COMMENCE:"APPRAISAL_PROCESS_COMMENCE_NOTIFY",PA_REVIEW_COMMENCE:"REVIEW_COMMENCE_NOTIFY",PA_REVIEW_END:"REVIEW_END_NOTIFY",SALARY_HIKE_PUSH_NOTIFY:"SALARY_HIKE_PUSH_NOTIFY",SKILLSET_TAG_EMP:"SKILLSET_TAG_EMP",SKILLSET_TAG_RM:"SKILLSET_TAG_RM",SKILLSET_UPGRADE_EMP:"SKILLSET_UPGRADE_EMP",SKILLSET_UPGRADE_RM:"SKILLSET_UPGRADE_RM",SECTION_GOAL_ACCESS:"GOAL_ACCESS",SECTION_SKILL_ACCESS:"SKILL_PERMISSION",SECTION_SKILLSCORE_CONFIGURABLE:"SKILLSCORE_CONFIGURABLE",SECTION_SKILLSET_APPROVAL:"SKILLSET_APPROVAL",SECTION_SKILL_MATRIX:"SKILL_MATRIX",SECTION_MRTYPE:"MULTIRATER_TYPE",SECTION_NOTIFICATION:"NOTIFICATION",SECTION_CERTIFICATION_MANDATORY:"CERTIFICATION_MANDATORY",SECTION_UPGRADEREASON_MANDATORY:"SKILL_UPGRADEREASON_MANDATORY",SECTION_EXPORT_PERMISSION:"EXPORT_PERMISSION",SECTION_SALARY_HIKE:"SALARYHIKEINPUT",SECTION_SKIP_REVIEW:"SKIP_REVIEW",SECTION_HIDESELFAPPRAISALREVIEW:"SELFAPPRAISAL_HIDE_FORREVIEWER",SECTION_ACCEPTANCEDATA:"ACCEPTANCE",SECTION_TABNAME_CHANGED:"TAB_NAME_CHANGE",SECTION_EXCLUDE_NOTICE_EMPLOYEE:"EXCLUDE_NOTICE_EMPLOYEE",SECTION_EXCLUDE_PROBATION_EMPLOYEE:"EXCLUDE_PROBATION_EMPLOYEE",SECTION_CYCLE_DELETE_RESTRICTION:"CYCLE_DELETE_RESTRICTION",SECTION_MODULESRATING_MAILMERGE:"MODULES_RATING_MAILMERGE",SECTION_KRA_ACCESS:"KRA_PERMISSION",SECTION_KRA_APPROVAL:"KRA_APPROVAL",SECTION_SKILLWEIGHTAGE:"SKILL_WEIGHTAGE",NOR_REASON_ENABLE:"NORMALIZATION_REASON_ENABLE",NOR_REASON_MANDATORY:"NORMALIZATION_REASON_MANDATORY",SECTION_NORMALIZATION:"SECTION_NORMALIZATION",COURSE_DETAIL:"LIST_COURSE_TO_REVIEWER",SECTION_COURSE_DETAILS:"SECTION_COURSE_DETAILS",SECTION_CUSTOM_ADMIN:"SECTION_CUSTOM_ADMIN",REVIEWER_RESTRICTION_IN_MR:"REVIEWER_CANNOT_BE_MR",SECTION_GOALPRIORITY:"SECTION_GOALPRIORITY",RESTRICT_SKILLSET_WEIGHTAGE_VALIDATION:"RESTRICT_SKILLSET_WEIGHTAGE_VALIDATION",SECTION_APPRAISAL_ESIGN:"APPRAISAL_ESIGN",SECTION_CR_BASED_APPRAISAL_CYCLE:"CR_BASED_APPRAISAL_CYCLE",GOAL_FORM_NAME:null,SELF_APPRAISAL_FORM_NAME:null,MULTIRATERNAME:"MULTIRATER",GOALSHEETNAME:"GOALSHEETNAME",SELF_APPRAISAL_TABLE:"P_SelfAppraisal",GOAL_TABLE:"P_Goals",ismanager:!1,getNotificationTypes:function(){return[PMSCommon.APPRAISAL_CYCLE_COMMENCE,PMSCommon.PA_REVIEW_COMMENCE,PMSCommon.PA_REVIEW_END,PMSCommon.SALARY_HIKE_PUSH_NOTIFY,PMSCommon.SKILLSET_TAG_EMP,PMSCommon.SKILLSET_TAG_RM,PMSCommon.SKILLSET_UPGRADE_EMP,PMSCommon.SKILLSET_UPGRADE_RM]},getFormName:function(formName){if(null===formName||void 0===formName)return"";var params={mode:"getFormDetailsNew",formName:formName};return formName===PMSCommon.GOAL_TABLE?PMSCommon.getGoalFormName(formName,params):formName===PMSCommon.SELF_APPRAISAL_TABLE?PMSCommon.getSelfAppraisalFormName(formName,params):void 0},getGoalFormName:function(formName,params){return null===PMSCommon.GOAL_FORM_NAME&&ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(data){void 0!==data.formDispname?PMSCommon.GOAL_FORM_NAME=data.formDispname:PMSCommon.GOAL_FORM_NAME=ZPI18N.getString("zp.goals")}),PMSCommon.GOAL_FORM_NAME},getSelfAppraisalFormName:function(formName,params){return null===PMSCommon.SELF_APPRAISAL_FORM_NAME&&ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(data){void 0!==data.formDispname?PMSCommon.SELF_APPRAISAL_FORM_NAME=data.formDispname:PMSCommon.SELF_APPRAISAL_FORM_NAME=ZPI18N.getString("zp.selfappraisal")}),PMSCommon.SELF_APPRAISAL_FORM_NAME},Export:{EXPACK_MODAL:null,popupId:"exportPopup_PA",cardId:"cardexportPopup_PA",moduleType:"",view:"",ALLOWED_FORMAT:new Array("pdf","xls","xlsx","csv"),inclusetabmodes:["employeesalary","appraisal_form"],showExportPopup:function(callback,mode){var modelLen=$("#"+PMSCommon.Export.modelId).length;let isPasswordProtected=PMS_MOD_Export.isPasswordProtected(mode);var popupTab=new Tab(PMSCommon.Export.popupId,function(){if(0==modelLen){var popup="";if(popup+='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_Emptydata"><div><div class="zpl_mdexprtimg smll"></div><h4>'+ZPI18N.getString("zp.choosefileformattoexport")+'</h4><div class="zpl_secn"><div>',isPasswordProtected||(popup+='<div class="zradiobutton zradiobutton--horizontal"><input id="expFormat_xls" type="radio" name="zp_ftype" class="zradiobutton__helper" value="xls" checked><label onclick="PMSCommon.Export.toggleCheckBox(\'expFormat_xls\', false);" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.xls")+"</span></label></div>"),popup+='<div class="zradiobutton zradiobutton--horizontal"><input id="expFormat_xlsx" type="radio" name="zp_ftype" class="zradiobutton__helper" value="xlsx"><label onclick="PMSCommon.Export.toggleCheckBox(\'expFormat_xlsx\', false);" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.xlsx")+"</span></label></div>",isPasswordProtected||(popup+='<div class="zradiobutton zradiobutton--horizontal"><input id="expFormat_csv" type="radio" name="zp_ftype" class="zradiobutton__helper" value="csv"><label onclick="PMSCommon.Export.toggleCheckBox(\'expFormat_csv\', false);" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.csv")+'</span></label></div><div class="zradiobutton zradiobutton--horizontal"><input id="expFormat_tsv" type="radio" name="zp_ftype" class="zradiobutton__helper"  value="tsv"><label onclick="PMSCommon.Export.toggleCheckBox(\'expFormat_tsv\', false);" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.tsv")+"</span></label></div>"),$("#"+PMSCommon.Export.cardId).html(popup),isPasswordProtected&&$("#"+PMSCommon.Export.cardId).find("#expFormat_xlsx").prop("checked",!0),PMSCommon.Export.inclusetabmodes.includes(mode)){let inclEle='<div class="zpl_secn"><div><div class="zcheckbox">';inclEle+='<input type="checkbox" id="zp_export_inctabularsec" class="zcheckbox__helper">',inclEle+='<label class="zcheckbox__label" for="zp_export_inctabularsec">'+ZPI18N.getString("zp.includetabulardata")+"</label></div></div></div>",$("#"+PMSCommon.Export.cardId).find(".zpl_crdcnt").append(inclEle)}if("appraisalEmployees"==mode)if(SalaryHikeV2Cycle.isSalaryHikeCycle){let inclEle='<div class="zpl_secn"><div><div class="zcheckbox">';inclEle+="<label>"+ZPI18N.getString("zp.salarycycleexport")+"</label></div></div></div>",$("#"+PMSCommon.Export.cardId).find(".zpl_crdcnt").append(inclEle)}else{let inclEle='<div class="zpl_secn"><div><div class="zcheckbox">';inclEle+="<label>"+ZPI18N.getString("zp.appraisalcycleexport")+"</label></div></div></div>",$("#"+PMSCommon.Export.cardId).find(".zpl_crdcnt").append(inclEle)}}},function(){"function"==typeof callback?callback(mode):PMSCommon.Export.EXPACK_MODAL.close()}),popupName=ZPI18N.getString("zp.exportas",[""]);PMSCommon.Export.EXPACK_MODAL=new popupModal(popupName,popupTab),PMSCommon.Export.EXPACK_MODAL.save=ZPI18N.getString("zp.export"),PMSCommon.Export.EXPACK_MODAL.setCloseCallback(function(){PMSCommon.Export.EXPACK_MODAL.remove()}),PMSCommon.Export.EXPACK_MODAL.construct()},toggleCheckBox:(id,isCurrentContainer)=>{const pageCont=$(PMSCommon.Export.EXPACK_MODAL.sliderDiv);let isChecked;(isChecked=pageCont.find("#"+id).prop("checked"))||pageCont.find("#"+id).prop("checked",!0)},exportModuleMapping:function(){var popCont=$(PMSCommon.Export.EXPACK_MODAL.sliderDiv),pageId=settingsPage.container,path="selfappraisalExport.zp?submode=exportModuleMapping";path+="&ftype="+popCont.find("input[name=zp_ftype]:checked").val();var modtype,compType=PMSCommon.Export.moduleType;if(0==compType){var modVal=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue();"designation"==modVal?modtype=1:"domain"==modVal?modtype=3:"department"==modVal?modtype=2:"desDep"==modVal&&(modtype=4)}else 1==compType?modtype=ZPeopleComponents.select(pageId.find("#desdepselect")).getValue():2==compType&&(modtype=ZPeopleComponents.select(pageId.find("#compdesdepsel2")).getValue());path+="&modtype="+modtype,path+="&cmpType="+compType;var form=document.createElement("form");form.id="skexport";var logexport=document.createElement("input");form.setAttribute("method","post"),form.setAttribute("action",path),logexport.setAttribute("type","hidden"),logexport.setAttribute("name","conreqcsr"),logexport.setAttribute("value",csrfToken),form.appendChild(logexport),document.body.appendChild(form),form.submit(),form.reset(),PMSCommon.Export.EXPACK_MODAL.close()},exportdata:function(mode){var popCont=$(PMSCommon.Export.EXPACK_MODAL.sliderDiv),frmId=(settingsPage.container,""),viewid="",formElm=document.createElement("form");formElm.id="exp_form",formElm.name="ExportForm";var path="",ftype=popCont.find("input[name=zp_ftype]:checked").val(),includeTabular=popCont.find("#zp_export_inctabularsec").find("input[type=checkbox]").prop("checked");if(path="ExportData.do?approvalStatus=all&ftype="+ftype,"kraForm"==mode)PMSOperation.getformDetails("kraForm"),path+="&hrmsform="+(frmId=PMSOperation.kraformDtl.formId)+"&viewID="+(viewid=PMSOperation.kraformDtl.viewId),path+="&selectedView="+(0==parseInt(ZPeopleComponents.select($(PMSOperation.moduleLibraryslider.sliderDiv).find("#kraView")).getValue())?"kra":"userKra");else if("competency_form"==mode)PMSOperation.getformDetails("competency_form"),path+="&hrmsform="+(frmId=PMSOperation.competencyformDtl.formId)+"&viewID="+(viewid=PMSOperation.competencyformDtl.viewId);else if("skillform"==mode)PMSOperation.getformDetails("skillform"),path+="&hrmsform="+(frmId=PMSOperation.skillsformDtl.formId)+"&viewID="+(viewid=PMSOperation.skillsformDtl.viewId);else if("multiraterform"==mode){PMSOperation.getformDetails("multirater"),frmId=PMSOperation.multiraterDtl.formId,viewid=PMSOperation.multiraterDtl.viewId;const pageId=Layout.Page.container;void 0!=ZPeopleComponents.select(pageId.find("#applicableType")).getValue()&&null!=ZPeopleComponents.select(pageId.find("#applicableType")).getValue()&&""!=ZPeopleComponents.select(pageId.find("#applicableType")).getValue()&&(path+="&customAdminGrpId="+ZPeopleComponents.select(pageId.find("#applicableType")).getValue());let mode="PAMultirater";"performance_appraisal_userlisting"==Layout.Page.urlmode&&(mode="PAMultiraterReviewer"),path+="&filtermode="+mode+"&hrmsform="+frmId+"&viewID="+viewid,path+="&configId="+ZPeopleComponents.select(pageId.find("#configuration_sel")).getValue(),"performance_appraisal_userlisting"==Layout.Page.urlmode&&(path+="&managerId="+erecno),path+="&status=1"}else if("teambudgetform"==mode&&(PMSOperation.getformDetails("teambudgetform"),frmId=PMSOperation.teambudgetformDtl.formId,viewid=PMSOperation.teambudgetformDtl.viewId,"performance_appraisal_salaryhike"==Layout.Page.urlmode)){const pageId=Layout.Page.container;let configIds=ZPeopleComponents.select(pageId.find("#siSalaryCycle")).getValue();const managerId=-1;null!=managerId&&void 0!=managerId&&""!=managerId&&"-1"!=managerId&&(path+="&managerId="+managerId),null!=configIds&&void 0!=configIds&&""!=configIds&&"-1"!=configIds&&(path+="&configId="+configIds),path+="&hrmsform="+frmId+"&viewID="+viewid}(null==includeTabular||0!=includeTabular&&1!=includeTabular)&&(includeTabular=!1),path+="&typeOfView=all&includeTabular="+includeTabular;var inputval=document.createElement("input");formElm.setAttribute("target","exportresp"),formElm.setAttribute("method","post"),formElm.setAttribute("action",path),inputval.setAttribute("type","hidden"),inputval.setAttribute("name",csrfParamName),inputval.setAttribute("value",csrfToken),formElm.appendChild(inputval),document.body.appendChild(formElm),formElm.submit(),formElm.reset(),PMSCommon.Export.EXPACK_MODAL.close()}},autosave:{clearelement:function(headerObj){$(headerObj).find(".zpl_atosv").length>0&&(autosavecnt=$(headerObj).find(".zpl_atosv > .zpl_atocnt"),$(headerObj).find(".zpl_atosv").parent().remove())},enableHdrBtn:function(headerObj){headerObj.find(":button").length>0&&headerObj.find(":button").css("display","block")}},showHidePermissionDenied:function(isShow){var page=settingsPage.container;isShow?(PermissionDenied.show(),PMSCommon.showHideLoadingPage(!1),page.find(".zpl_rgtcnt").hide()):(PermissionDenied.remove(),page.find(".zpl_rgtcnt").show())},showHideLoadingPage:function(isShow,apndToPageChilde){var page=settingsPage.container;isShow?apndToPageChilde?(page.find(".zpl_container").append(ZPeople.LOADING_HTML),page.find(".zpl_container .zpl_iwrpr").hide()):(page.append(ZPeople.LOADING_HTML),page.find(".zpl_rgtcnt").hide()):(page.find("#zp_page_loading").remove(),apndToPageChilde?page.find(".zpl_container .zpl_iwrpr").show():page.find(".zpl_rgtcnt").show()),load=null}},PMSTmpl={DESIGNATION_LIST:{},DEPARTMENT_LIST:{},DESIGNATION_SALARY:{},DESIGNATION_OPT:null,BUDGET_CONFIG_DATA:null,BUDGET_LIST_DATA:null,HIKE_EXP_STORE:{},TOTAL_SALARY:0,ISRATINGEDITOPEN:!1,ON_LOAD_PAGE:null,LEFT_TAB_ARRAY:["tmplbasicDetDiv","tmplsaDetDiv_hide","tmplmrDetDiv_hide","tmplpaDetDiv","tmplratingDetDiv","tmplhkDetDiv_hide","tmplnrmDetDiv_hide","tmplpubDetDiv"],LEFT_TAB_K_V:{},MR_NAME:"",HK_NAME:"",HIKE_NAME:"",EDIT_TMPL_DETAIL:null,ALREADY_SEL_VAL:[],FILE:null,IS_MOD_WHT_ENABLED:!1,IS_MIN_CMT_LEN_ENABLED:!1,IS_HIDE_AVERGE_ENABLED:{},tmplColors:["tmpCV1","tmpCV5","tmpCV6","tmpCV7","tmpCV8","tmpCV9","tmpCV10","tmpCV11"],openAddTemplate:function(reset,tmplObj){var pageId=settingsPage.container;pageId.find("#popTmplCreBtn").removeAttr("disabled"),PMSTmpl.ALREADY_SEL_VAL=[],reset&&(PMSTmpl.EDIT_TMPL_DETAIL=null),null===PMSTmpl.ON_LOAD_PAGE&&$.ajax({type:"POST",async:!1,url:"/performance/view/tmplConfigPage",data:{conreqcsr:csrfToken},success:function(resultData){PMSTmpl.ON_LOAD_PAGE=resultData}}),pageId.html(PMSTmpl.ON_LOAD_PAGE),pageId.find("#tmplhdrLbl").html(ZPI18N.getString("zp.create")+" "+ZPI18N.getString("zp.template")),PMSTmpl.load(),void 0!==tmplObj&&(PMSTmpl.setPopUpValues(tmplObj),PMSTmpl.nxtBtn())},setPopUpValues:function(tmplObj){var pageId=settingsPage.container;pageId.find("#tmplcTmplNameID").val(tmplObj.nme),pageId.find("#tmplcTmplDescID").val(tmplObj.desc),tmplObj.sa?pageId.find("#tmplsaTglBtnFstCrtDiv").addClass("zpl_act"):pageId.find("#tmplsaTglBtnFstCrtDiv").removeClass("zpl_act"),PMSTmpl.postSelTgBtnAction(pageId.find("#tmplsaTglBtnFstCrtDiv")),tmplObj.mr?pageId.find("#tmplmrTglBtnFstCrtDiv").addClass("zpl_act"):pageId.find("#tmplmrTglBtnFstCrtDiv").removeClass("zpl_act"),PMSTmpl.postSelTgBtnAction(pageId.find("#tmplmrTglBtnFstCrtDiv")),tmplObj.hk?pageId.find("#tmplhikeTglBtnFstCrtDiv").addClass("zpl_act"):pageId.find("#tmplhikeTglBtnFstCrtDiv").removeClass("zpl_act"),PMSTmpl.postSelTgBtnAction(pageId.find("#tmplhikeTglBtnFstCrtDiv")),tmplObj.norm&&PMSV2Cycle.isPARatingEnabled?pageId.find("#tmplnormTglBtnFstCrtDiv").addClass("zpl_act"):pageId.find("#tmplnormTglBtnFstCrtDiv").removeClass("zpl_act"),PMSTmpl.postSelTgBtnAction(pageId.find("#tmplnormTglBtnFstCrtDiv"))},openEditTemplate:function(obj){PMSTmpl.ALREADY_SEL_VAL=[];let configId=$(obj).parent("tr").attr("tmplid");$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getConfigDetails",configId:configId,cyType:1,conreqcsr:csrfToken},success:function(resultData){PMSTmpl.EDIT_TMPL_DETAIL=resultData}}),PMSTmpl.openAddTemplate(!1),PMSTmpl.setTmplValues()},openEditTemplateFrmCart:function(obj,frmObj){PMSTmpl.ALREADY_SEL_VAL=[];let configId=void 0;configId=frmObj?$(obj).parents("li").attr("tmplid"):obj,$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:{mode:"getConfigDetails",configId:configId,cyType:1,conreqcsr:csrfToken},success:function(resultData){PMSTmpl.EDIT_TMPL_DETAIL=resultData}}),PMSTmpl.openAddTemplate(!1),PMSTmpl.setTmplValues()},load:function(){var pageId=settingsPage.container;$(pageId.find(".togbutton-js")).ztoggleswitch({size:"medium"}),appsettingsadmin?pageId.find(".PI_widgt_custm").addClass("zpl_DNI"):pageId.find(".PI_widgt_custm").removeClass("zpl_DNI"),ZPeopleComponents.select(pageId.find(".select-js")),PMSTmpl.ISRATINGEDITOPEN=!1,PMSV2Cycle.prerequisiteData(!1),PMSTmpl.registerActions(),PMSTmpl.defaultOption(),PMSTmpl.LEFT_TAB_ARRAY=["tmplbasicDetDiv","tmplsaDetDiv_hide","tmplmrDetDiv_hide","tmplpaDetDiv","tmplratingDetDiv","tmplnrmDetDiv_hide","tmplhkDetDiv_hide","tmplpubDetDiv"],PMSTmpl.LEFT_TAB_K_V={tmplbasicDetDiv:ZPI18N.getString("zp.basicdetails"),tmplsaDetDiv:ZPI18N.getString("zp.selfappraisal"),tmplmrDetDiv:PMSTmpl.MR_NAME,tmplpaDetDiv:ZPI18N.getString("zp.reviewerreview"),tmplratingDetDiv:ZPI18N.getString("zp.lms.reports.rating"),tmplnrmDetDiv:ZPI18N.getString("zp.normalization"),tmplhkDetDiv:PMSTmpl.HK_NAME,tmplpubDetDiv:ZPI18N.getString("zp.publishconfiguration")},PMSTmpl.leftTabConstruct(),PMSTmpl.buildQuantitativeParam(),PMSTmpl.constructModWgt(),PMSTmpl.constructRatingSection(),PMSTmpl.rtgAction(),PMSTmpl.showHideCmtLenDiv(),pageId.find("#tmplcycleRevSelectionDiv").html(ZPA_Approval.ContainerBody.APPROVER),ZPA_Approvers.formfield=void 0,void 0!==PMSV2Cycle.INIT_SETTINGS&&void 0!==PMSV2Cycle.INIT_SETTINGS.emplookup&&Object.keys(PMSV2Cycle.INIT_SETTINGS.emplookup).length>0&&(ZPA_Approvers.formfield=[],$.each(PMSV2Cycle.INIT_SETTINGS.emplookup,function(key,value){var formfield={};formfield.id=key,formfield.displayName=value,ZPA_Approvers.formfield.push(formfield)})),ZPA_Approvers.reset(),pageId.find("#add_level .zpl_lnkbg").html(ZPI18N.getString("zp.addcomponents",[ZPI18N.getString("zp.reviewerlevel")]));let chdLen=pageId.find("#tmplcycleRevSelectionDiv").find("#approver_body").children();chdLen.length>0&&$(chdLen[0]).find(".zpl_rwicn").attr("style","opacity: 0;"),$(pageId.find(".togbutton-js")).ztoggleswitch({size:"medium"});["#tmplsaQntParmDiv","#tmplmrQntParmDiv","#tmplpaQntParmDiv","#tmplsaRQMdtDiv","#tmplmrRQMdtDiv","#tmplmrTypeDiv","#tmplpaRQMdtDiv","#tmplmrSelTypeDiv","#tmplmodWgtSecDiv"].forEach(id=>{if($(id).hasClass("disabled")){$(id).find("[role=switch]").css("pointer-events","none")}}),PMSV2Cycle.isPARatingEnabled||pageId.find("#tmplnormTglBtnFstCrtDiv").hide()},destroyTmplPageComponents:function(){var pageId=settingsPage.container;pageId.find("#tmplpubAuthID").length>0&&ZPeopleComponents.tokenfield(pageId.find("#tmplpubAuthID")).destroy(),pageId.find("#tmplfldToPubID").length>0&&ZPeopleComponents.tokenfield(pageId.find("#tmplfldToPubID")).destroy(),pageId.find("#tmplratingType").length>0&&ZPeopleComponents.select(pageId.find("#tmplratingType")).destroy(),pageId.find("#tmplratingNoOfDigits").length>0&&ZPeopleComponents.select(pageId.find("#tmplratingNoOfDigits")).destroy(),pageId.find("#tmplmrTypeSelID").length>0&&ZPeopleComponents.select(pageId.find("#tmplmrTypeSelID")).destroy(),pageId.find("#tmplhkApprSel").length>0&&ZPeopleComponents.select(pageId.find("#tmplhkApprSel")).destroy()},pageClose:function(isAfterSubmit){PMSV2Cycle.isCycleAddEditPageValueChangedInit(PMSTmpl.TemplatePageClose,isAfterSubmit)},TemplatePageClose:function(){PMSTmpl.destroyTmplPageComponents(),PMSSetting.appraisalTemplateInit(!0)},registerActions:function(){var pageId=settingsPage.container;ZPeopleComponents.toggleswitch(pageId.find("#tmplsaModRtDetID")).setAttributes({change:PMSTmpl.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#tmplmrModRtDetID")).setAttributes({change:PMSTmpl.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#tmplpaModRtDetID")).setAttributes({change:PMSTmpl.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#tmplsaRQID")).setAttributes({change:PMSTmpl.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#tmplmrRQID")).setAttributes({change:PMSTmpl.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#tmplmrTypeID")).setAttributes({change:PMSTmpl.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#tmplpaRQID")).setAttributes({change:PMSTmpl.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#tmplmrAutoPopulate")).setAttributes({change:PMSTmpl.showDisabledTgBtnAction}),ZPeopleComponents.toggleswitch(pageId.find("#tmplsetModWgtID")).setAttributes({change:PMSTmpl.showDisabledTgBtnAction}),pageId.find("#tmplratingType").on("zselectchange",function(event,eData){PMSTmpl.onRatingTypeAction(eData)}),pageId.find("#tmplratingNoOfDigits").on("zselectchange",function(event,eData){PMSTmpl.onRatingTypeAction(eData)}),pageId.find("#tmplhkBsdOn").on("zselectchange",function(event,eData){PMSTmpl.onHikeBasedAction(eData)}),pageId.find("[name=mrSelRdBx]").unbind("click"),pageId.find("[name=mrSelRdBx]").bind("click",function(){pageId.find('#tmplmrEmpRepToSecDiv [elem="errorMsg"]').remove(),"2"===pageId.find("[name=mrSelRdBx]:checked").attr("value")?pageId.find("[hide=mrEmpSel]").hide():pageId.find("[hide=mrEmpSel]").show()})},defaultOption:function(){var pageId=settingsPage.container;pageId.find("#tmplsaModRtDetID").ztoggleswitch("switchOff"),pageId.find("#tmplsaQntParmDiv").addClass("disabled"),pageId.find("#tmplmrModRtDetID").ztoggleswitch("switchOff"),pageId.find("#tmplmrQntParmDiv").addClass("disabled"),pageId.find("#tmplpaModRtDetID").ztoggleswitch("switchOff"),pageId.find("#tmplpaQntParmDiv").addClass("disabled"),pageId.find("#tmplsaRQID").ztoggleswitch("switchOff"),pageId.find("#tmplsaRQMdtDiv").addClass("disabled"),pageId.find("#tmplmrRQID").ztoggleswitch("switchOff"),pageId.find("#tmplmrRQMdtDiv").addClass("disabled"),pageId.find("#tmplmrTypeID").ztoggleswitch("switchOff"),pageId.find("#tmplmrTypeDiv").addClass("disabled"),pageId.find("#tmplpaRQID").ztoggleswitch("switchOff"),pageId.find("#tmplpaRQMdtDiv").addClass("disabled"),pageId.find("#tmplmrAutoPopulate").ztoggleswitch("switchOff"),pageId.find("#tmplmrSelTypeDiv").addClass("disabled"),pageId.find("#tmplsetModWgtID").ztoggleswitch("switchOff"),pageId.find("#tmplmodWgtSecDiv").addClass("disabled");var selOpt1=pageId.find("#tmplmrTypeSelID");selOpt1.empty(),selOpt1.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),Object.keys(PMSV2Cycle.mrtypes).length>1&&$.each(PMSV2Cycle.mrtypes,function(key,value){1!=key&&selOpt1.append(jQuery("<option />",{value:key,id:key}).html(value))}),ZPeopleComponents.select(selOpt1),pageId.find("#tmplmrRepToRdBx").prop("checked",!0),pageId.find("[hide=mrEmpSel]").hide(),selOpt=pageId.find("#tmplhkApprSel"),selOpt.empty(),selOpt.append(jQuery("<option />",{value:-1,id:-1}).text(ZPI18N.getString("zp.select"))),$.each(PMSV2Cycle.HIKE_EMP_LOOKUPS,function(key,value){selOpt.append(jQuery("<option />",{value:key,id:key}).html(value))}),ZPeopleComponents.select(selOpt),pageId.find("#tmplMnlRdBtn").prop("checked",!0),PMSTmpl.pubRtgAllower(),PMSTmpl.fldToPublish()},onClickFormCustomisation:function(obj){if(appsettingsadmin)return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")),!1;let type=$(obj).attr("typeSel"),formId="",extraObj={isCustomizationOnlyAllowed:!0};"sa"===type?(PMSImport.getformDetails("selfappraisal"),formId=PMSImport.selfappFormDtl.formId):"mr"===type?(PMSOperation.getformDetails("multirater"),formId=PMSOperation.multiraterDtl.formId):"pa"===type?(PMSOperation.getformDetails("appraisal"),formId=PMSOperation.performanceappFormDtl.formId):"hk"===type&&(PMSImport.getformDetails("salary"),formId=PMSImport.salaryFormDtl.formId),""!==formId&&void 0!==formId&&formId.length>0&&FormCustomNew.loadForm(void 0,formId,extraObj)},pubRtgAllower:function(){let pageId=settingsPage.container,publisherFinalizer=null!==PMSTmpl.EDIT_TMPL_DETAIL&&PMSTmpl.EDIT_TMPL_DETAIL.publisherFinalizer,publisherRM=null!==PMSTmpl.EDIT_TMPL_DETAIL&&PMSTmpl.EDIT_TMPL_DETAIL.publisherRM,selLst=[];var pubAuth=pageId.find("#tmplpubAuthID");pubAuth.empty();var dataObj={},optLst=[],optObj={};optObj.name=ZPI18N.getString("zp.reportingmanager"),optObj.id="2",optLst.push(optObj),publisherRM&&selLst.push(optObj),(optObj={}).name=ZPI18N.getString("zp.finalizer"),optObj.id="3",optLst.push(optObj),publisherFinalizer&&selLst.push(optObj),dataObj.data=optLst,dataObj.contentType="text",dataObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},dataObj.search={by:"name"},dataObj.allowDuplicateValues=!1,dataObj.values=selLst,dataObj.dropdownList={itemType:"checkbox"},ZPeopleComponents.tokenfield(pubAuth,dataObj)},fldToPublish:function(){let pageId=settingsPage.container;var appfield_ele=pageId.find("#tmplfldToPubID");if(ZPeopleComponents.isComponent(appfield_ele)){PMSTmpl.ALREADY_SEL_VAL=[];let alreadySelVal=ZPeopleComponents.tokenfield(appfield_ele).getAllValues();if(alreadySelVal.length>0)for(var i in alreadySelVal)PMSTmpl.ALREADY_SEL_VAL.push(alreadySelVal[i].id);ZPeopleComponents.tokenfield(appfield_ele).destroy()}appfield_ele.html("");var optLst=[],selLst=[];let grpNme=ZPI18N.getString("zp.perfapprfield"),selArrID=null!==PMSTmpl.EDIT_TMPL_DETAIL?PMSTmpl.EDIT_TMPL_DETAIL.compidarr:[];if(PMSTmpl.ALREADY_SEL_VAL.length>0)for(var i in PMSTmpl.ALREADY_SEL_VAL)selArrID.push(PMSTmpl.ALREADY_SEL_VAL[i]);let rtgAdded=!1;if($.each(PMSV2Cycle.appraisalfields,function(ind,val){if("USERERECNO"!=val.comp_columnname){let optObj={};optObj.name=val.comp_dispname,optObj.id=val.comp_id,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(val.comp_id)&&("RATINGID"==val.comp_columnname&&(rtgAdded=!0),selLst.push(optObj))}if(null!==PMSTmpl.EDIT_TMPL_DETAIL&&-1==selArrID.indexOf(val.comp_id)&&(rtgAdded=!0),!rtgAdded&&"RATINGID"==val.comp_columnname){let optObj={};optObj.name=val.comp_dispname,optObj.id=val.comp_id,optObj.grpnme=grpNme,-1===selLst.indexOf(val.comp_id)&&selLst.push(optObj)}}),null!==PMSV2Cycle.APPRAISALTABULARFIELDS&&PMSV2Cycle.APPRAISALTABULARFIELDS.length>0&&$.each(PMSV2Cycle.APPRAISALTABULARFIELDS,function(index,data){let grpNme=data.secName;$.each(data.compDetails,function(index,comData){let optObj={};optObj.name=comData.comp_dispname,optObj.id=comData.comp_id,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(comData.comp_id)&&selLst.push(optObj)})}),pageId.find("#tmplmrTglBtnFstCrtDiv").hasClass("zpl_act")){let grpNme=ZPI18N.getString("zp.mrfield",[ZPeople.decodeTxt(PMSTmpl.MR_NAME)]);$.each(PMSV2Cycle.multiraterfields,function(ind,val){if("MODIFIEDBY"!=val.comp_columnname&&"MODIFIEDTIME"!=val.comp_columnname&&"FEEDBACK_STATUS"!=val.comp_columnname&&"OWNER"!=val.comp_columnname&&"CREATEDTIME"!=val.comp_columnname&&"DESCRIPTION"!=val.comp_columnname){let optObj={};optObj.name=val.comp_dispname,optObj.id=val.comp_id,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(val.comp_id)&&selLst.push(optObj)}})}let tySelRtgObj=PMSTmpl.getModWgtRtgCmtCntObj(!0),isSelfRtg=!1,isMrRtg=!1,isPaRtg=!1;if(void 0!==tySelRtgObj&&(void 0!==tySelRtgObj.sa&&(tySelRtgObj.sa.modCnt>0&&(tySelRtgObj.sa.modRtgCnt>0||tySelRtgObj.sa.modCmtCnt>0)||void 0!==tySelRtgObj.sa.QusAns&&tySelRtgObj.sa.QusAns)&&(isSelfRtg=!0),void 0!==tySelRtgObj.mr&&(tySelRtgObj.mr.modCnt>0&&(tySelRtgObj.mr.modRtgCnt>0||tySelRtgObj.mr.modCmtCnt>0)||void 0!==tySelRtgObj.mr.QusAns&&tySelRtgObj.mr.QusAns)&&(isMrRtg=!0),void 0!==tySelRtgObj.pa&&(tySelRtgObj.pa.modCnt>0&&(tySelRtgObj.pa.modRtgCnt>0||tySelRtgObj.pa.modCmtCnt>0)||void 0!==tySelRtgObj.pa.QusAns&&tySelRtgObj.pa.QusAns)&&(isPaRtg=!0)),isSelfRtg||isMrRtg||isPaRtg){if(grpNme=ZPI18N.getString("zp.moduleratings"),void 0!=PMSV2Cycle.userRatingComponent&&isSelfRtg){let optObj={};optObj.name=ZPI18N.getString("zp.userrating"),optObj.id=PMSV2Cycle.userRatingComponent.comp_id,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(PMSV2Cycle.userRatingComponent.comp_id)&&selLst.push(optObj)}if(void 0!=PMSV2Cycle.managerRatingComponent){let typeArr=null!==PMSTmpl.EDIT_TMPL_DETAIL?PMSTmpl.EDIT_TMPL_DETAIL.typearr:[];if(typeArr.length>0)for(var i in typeArr)selArrID.push(parseInt(typeArr[i]));if(isMrRtg){let optObj={};optObj.name=ZPI18N.getString("zp.raterRating"),optObj.id=1,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(1)&&selLst.push(optObj),(optObj={}).name=ZPI18N.getString("zp.ratercomment"),optObj.id=4,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(4)&&selLst.push(optObj)}if(isPaRtg){let optObj={};if(optObj.name=ZPI18N.getString("zp.reviewRating"),optObj.id=2,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(2)){selLst.push(optObj);let finScrObj={};finScrObj.name=ZPI18N.getString("zp.fnlReviewScorecard"),finScrObj.id=3,finScrObj.grpnme=ZPI18N.getString("zp.moduleratings"),optLst.push(finScrObj),-1!==selArrID.indexOf(3)&&selLst.push(finScrObj)}(optObj={}).name=ZPI18N.getString("zp.reviewcomment"),optObj.id=5,optObj.grpnme=grpNme,optLst.push(optObj),-1!==selArrID.indexOf(5)&&selLst.push(optObj)}}}dataObj={},dataObj.data=optLst,dataObj.contentType="text",dataObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name",groupLabel:"grpnme"},dataObj.search={by:"name"},dataObj.allowDuplicateValues=!1,dataObj.values=selLst,dataObj.dropdownList={itemType:"checkbox",isTextHTMLEncoded:!0},dataObj.isLabelHTMLEncoded=!0,dataObj.tokenadd=PMSTmpl.onUpdatefldToPublish,dataObj.tokenremove=PMSTmpl.onUpdatefldToPublish,ZPeopleComponents.tokenfield(appfield_ele,dataObj)},onUpdatefldToPublish:function(event){var appfield_ele=settingsPage.container.find("#tmplfldToPubID");let selPubFieldsIds=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(appfield_ele).getAllValues()),optsData=ZPeopleComponents.tokenfield("#tmplfldToPubID").getAttributes().data,scoreCardIndex=optsData.findIndex(opts=>3==opts.id);if(-1==scoreCardIndex&&-1!=selPubFieldsIds.indexOf(2)){let optObj={};optObj.name=ZPI18N.getString("zp.fnlReviewScorecard"),optObj.id=3,optObj.grpnme=ZPI18N.getString("zp.moduleratings"),optsData.push(optObj),ZPeopleComponents.tokenfield("#tmplfldToPubID").setAttributes({data:optsData})}else-1==selPubFieldsIds.indexOf(2)&&-1!=scoreCardIndex&&(optsData.splice(scoreCardIndex,1),ZPeopleComponents.tokenfield("#tmplfldToPubID").removeTokens([3]),ZPeopleComponents.tokenfield("#tmplfldToPubID").setAttributes({data:optsData}))},setTmplValues:function(){let pageId=settingsPage.container,tmplVal=PMSTmpl.EDIT_TMPL_DETAIL;if(pageId.find("#tmplhdrLbl").html(ZPI18N.getString("zp.edittemp")),pageId.find("#tmplCELbl").html(ZPI18N.getString("zp.basicdetails")),pageId.find("#tmplCEDescLbl").html(ZPI18N.getString("zp.cycletemplate.headerdesc",[ZPI18N.getString("zp.edit")])),pageId.find("#tmplcTmplNameID").val(ZPeople.decodeTxt(tmplVal.periodName)),pageId.find("#tmplcTmplDescID").val(ZPeople.decodeTxt(tmplVal.description)),pageId.find("#tmplcTmplNameID").focus(),tmplVal.isSelfAppraisalEnabled?pageId.find("#tmplsaTglBtnFstCrtDiv").addClass("zpl_act"):pageId.find("#tmplsaTglBtnFstCrtDiv").removeClass("zpl_act"),PMSTmpl.postSelTgBtnAction(pageId.find("#tmplsaTglBtnFstCrtDiv")),tmplVal.multiRaterEnabled?pageId.find("#tmplmrTglBtnFstCrtDiv").addClass("zpl_act"):pageId.find("#tmplmrTglBtnFstCrtDiv").removeClass("zpl_act"),PMSTmpl.postSelTgBtnAction(pageId.find("#tmplmrTglBtnFstCrtDiv")),tmplVal.budgetEnable?pageId.find("#tmplhikeTglBtnFstCrtDiv").addClass("zpl_act"):pageId.find("#tmplhikeTglBtnFstCrtDiv").removeClass("zpl_act"),PMSTmpl.postSelTgBtnAction(pageId.find("#tmplhikeTglBtnFstCrtDiv")),tmplVal.normalizationEnable&&PMSV2Cycle.isPARatingEnabled?pageId.find("#tmplnormTglBtnFstCrtDiv").addClass("zpl_act"):pageId.find("#tmplnormTglBtnFstCrtDiv").removeClass("zpl_act"),PMSTmpl.postSelTgBtnAction(pageId.find("#tmplnormTglBtnFstCrtDiv")),"null"!==tmplVal.selfappraisalform&&""!==tmplVal.selfappraisalform){var filename=tmplVal.selfappraisalformDisname,fileExtn=filename.substring(filename.lastIndexOf(".")+1,filename.length),attachFileHtml=PMSTmpl.getAttachFileHtml(decodeURIComponent(ZPeople.decodeTxt(filename)),fileExtn,"tmpl");pageId.find("#beforeUpload").css("display","none"),pageId.find("#afterUpload").parent().css("display","block"),pageId.find("#afterUpload").append(attachFileHtml),pageId.find("#tempselffileupload").prop("checked",!0),pageId.find("#selfdocuploadsec").removeClass("DN")}let rtgCmVl=tmplVal.ratingCommentStatus;if(void 0!==rtgCmVl&&null!==rtgCmVl&&Object.keys(rtgCmVl).length>0){let saVl=rtgCmVl.selfObj;Object.keys(saVl).length>0&&PMSTmpl.setCheckBx("tmplsaModRtDetID","tmplsaQtPmTBody","tmplsaRQID","tmplsaQlPmTBody",saVl);let mrVl=rtgCmVl.mrObj;Object.keys(mrVl).length>0&&PMSTmpl.setCheckBx("tmplmrModRtDetID","tmplmrQtPmTBody","tmplmrRQID","tmplmrQlPmTBody",mrVl);let paVl=rtgCmVl.reviewObj;Object.keys(paVl).length>0&&PMSTmpl.setCheckBx("tmplpaModRtDetID","tmplpaQtPmTBody","tmplpaRQID","tmplpaQlPmTBody",paVl)}if(void 0!=PMSV2Cycle.mrTypeData&&PMSV2Cycle.mrTypeData.isMrtypeComEnabled&&void 0!=tmplVal.mrTypebasedmodule&&tmplVal.mrTypebasedmodule){pageId.find("#tmplmrTypeID").ztoggleswitch("switchOn");let showHideDiv=pageId.find("#tmplmrTypeID").attr("showhidesec");pageId.find("#"+showHideDiv).removeClass("disabled")}if(void 0!=PMSV2Cycle.mrTypeData&&PMSV2Cycle.mrTypeData.isMrtypeComEnabled){let mrTypeObj=tmplVal.mrEnabledmodule;if(void 0!==mrTypeObj&&null!==mrTypeObj&&Object.keys(mrTypeObj).length>0){$.each(mrTypeObj,function(k,v){if("1"!==k)PMSTmpl.setMRTypeCheckBx(k,v)});let child=pageId.find("#tmplmrQtPmTBody").children();PMSTmpl.mrTypeShowHide($(child[0]))}}if(tmplVal.multiRaterEnabled){let mrType=tmplVal.mrType,isMRAutoPopulateChk=!1;tmplVal.mrType>3&&(isMRAutoPopulateChk=!0,mrType=tmplVal.mrType-3,pageId.find("#tmplmrAutoPopulate").ztoggleswitch("switchOn")),void 0!=PMSV2Cycle.mrTypeData&&PMSV2Cycle.mrTypeData.isMrtypeComEnabled&&void 0!=PMSV2Cycle.mrtypes&&void 0!=PMSV2Cycle.mrtypes[tmplVal.defaultmrType]?ZPeopleComponents.select(pageId.find("#tmplmrTypeSelID")).setValue(tmplVal.defaultmrType):ZPeopleComponents.select(pageId.find("#tmplmrTypeSelID")).setValue(-1),isMRAutoPopulateChk?pageId.find("#tmplmrSelTypeDiv").removeClass("disabled"):pageId.find("#tmplmrSelTypeDiv").addClass("disabled"),pageId.find("#tmplminrater").val(tmplVal.mrMinRater),pageId.find("#tmplmaxrater").val(tmplVal.mrMaxRater),1===mrType?(pageId.find("[hide=mrEmpSel]").show(),pageId.find("#tmplmrEmpRepToRdBx").prop("checked",!0),pageId.find("#tmplmrRepToRdBx").prop("checked",!1),pageId.find("#tmplmrAnonID").prop("checked",!tmplVal.showRaterByRM)):2===mrType&&(pageId.find("#tmplmrRepToRdBx").prop("checked",!0),pageId.find("#tmplmrEmpRepToRdBx").prop("checked",!1),pageId.find("[hide=mrEmpSel]").hide()),tmplVal.isSelfAppraisalEnabled?(tmplVal.showSelfApprForMR?pageId.find("#tmplselfApprViewForMR").prop("checked",!0):pageId.find("#tmplselfApprViewForMR").prop("checked",!1),pageId.find("#tmplmrSaFldDiv").show()):pageId.find("#tmplmrSaFldDiv").hide()}ZPA_Approvers.loadApprovers(tmplVal.approvalArr),tmplVal.reviewApprovalEnable?(pageId.find("#tmplreviewApprovalEnable").prop("checked",!0),pageId.find("#tmplreviewApprConf").show()):(pageId.find("#tmplreviewApprovalEnable").prop("checked",!1),pageId.find("#tmplreviewApprConf").hide());let retObj=PMSTmpl.getModWgtRtgCmtCntObj(!1),modWgtObj=tmplVal.modWeightage,isShowModWgt=retObj.sa.modRtgCnt>=2||retObj.mr.modRtgCnt>=2||retObj.pa.modRtgCnt>=2;if((isShowModWgt=!(!isShowModWgt||!PMSV2Cycle.IS_FINALSCORE_ENABLED))&&void 0!==modWgtObj&&null!==modWgtObj&&Object.keys(modWgtObj).length>0){var actModuleObj=PMSSetting.SEL_ENABLED_MODULES;let constructModWht=function(moduleObj,compId){let _whtHtml="",moduleWht=modWgtObj[moduleObj.compName];return void 0!==moduleWht&&null!==moduleWht&&""!==moduleWht&&(_whtHtml="<tr><td>"+moduleObj.displayName+'</td><td><input compNme="'+moduleObj.compName+'" id="'+compId+'" type="text" class="ztextbox w60" value="'+moduleWht+'" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'moduleWeightage\');"></td></tr>'),_whtHtml},_htm=constructModWht(actModuleObj.GOALS,"tmplgoalMWgtID");if(_htm+=constructModWht(actModuleObj.KRA,"tmplkraMWgtID"),_htm+=constructModWht(actModuleObj.KRA_GOALS,"tmplkgMWgtID"),""!=(_htm+=constructModWht(actModuleObj.COMPETENCY,"tmplcompMWgtID"))){pageId.find("#tmplmodWgtTBody").html(_htm),pageId.find("#tmplsetModWgtID").ztoggleswitch("switchOn");let showHideDiv=pageId.find("#tmplsetModWgtID").attr("showhidesec");pageId.find("#"+showHideDiv).removeClass("disabled"),PMSTmpl.IS_MOD_WHT_ENABLED=!0,pageId.find("#tmplmodWgtDiv").show()}else pageId.find("#tmplsetModWgtID").ztoggleswitch("switchOff"),pageId.find("#tmplmodWgtDiv").hide(),PMSTmpl.IS_MOD_WHT_ENABLED=!1}else isShowModWgt?pageId.find("#tmplmodWgtDiv").show():pageId.find("#tmplmodWgtDiv").hide(),PMSTmpl.IS_MOD_WHT_ENABLED=!1;PMSTmpl.modWgtAction();let cnt=PMSTmpl.getCmtMdtyCnt();if(cnt>0){let cmtLen=tmplVal.moduleRatingType.minCommentLength;pageId.find("#tmplcmtLenDiv").removeClass("DN"),PMSTmpl.IS_MIN_CMT_LEN_ENABLED=!0,""!==cmtLen&&pageId.find("#tmplcmtLenInp").val(cmtLen)}else pageId.find("#tmplcmtLenDiv").addClass("DN"),PMSTmpl.IS_MIN_CMT_LEN_ENABLED=!1,pageId.find("#tmplcmtLenInp").val("");if((retObj=PMSTmpl.getModWgtRtgCnt()).rtgCnt>0){pageId.find("#tmplmodRtgDiv,#tmploverallRtgDiv").removeClass("zpl_DNI");let modRtgObj=tmplVal.moduleRatingType;if(void 0!==modRtgObj&&null!==modRtgObj&&Object.keys(modRtgObj).length>0){pageId.find("#tmplmodRtgDiv,#tmploverallRtgDiv").removeClass("zpl_DNI");let noOfDig=modRtgObj.noOfDigits;0===modRtgObj.type?(ZPeopleComponents.select(pageId.find("#tmplratingType")).setValue("starRating"),pageId.find("#tmplNumRtgDiv,#tmplTxtRtgDiv").hide()):1===modRtgObj.type?(ZPeopleComponents.select(pageId.find("#tmplratingType")).setValue("numberRating"),pageId.find("#tmplTxtRtgDiv").hide(),pageId.find("#tmplNumRtgDiv").show(),pageId.find("#tmplMnVl").val(1).addClass("disabled"),pageId.find("#tmplMxVl").val(modRtgObj.max)):2===modRtgObj.type?(ZPeopleComponents.select(pageId.find("#tmplratingType")).setValue("textRating"),pageId.find("#tmplNumRtgDiv").hide(),pageId.find("#tmplTxtRtgDiv").show(),PMSTmpl.getTextRatingSec(!0,!0,!0,!0)):3===modRtgObj.type&&(ZPeopleComponents.select(pageId.find("#tmplratingType")).setValue("customRating"),pageId.find("#tmplTxtRtgDiv").hide(),pageId.find("#tmplNumRtgDiv").show(),pageId.find("#tmplMnVl").val(modRtgObj.min).removeClass("disabled"),pageId.find("#tmplMxVl").val(modRtgObj.max)),ZPeopleComponents.select(pageId.find("#tmplratingNoOfDigits")).setValue(noOfDig),modRtgObj.isNotApplicable?pageId.find("#tmplnotApplicable").prop("checked",!0):pageId.find("#tmplnotApplicable").prop("checked",!1),modRtgObj.roundOfRT?pageId.find("#tmplrtRndOffID").prop("checked",!0):pageId.find("#tmplrtRndOffID").prop("checked",!1),modRtgObj.isIncNoDataMod?pageId.find("#tmplisIncNoDataMod").prop("checked",!0):pageId.find("#tmplisIncNoDataMod").prop("checked",!1);let tySelRtgObj=PMSTmpl.getModWgtRtgCmtCntObj(!1);PMSTmpl.saEnableDisable(tySelRtgObj),PMSTmpl.mrEnableDisable(tySelRtgObj),PMSTmpl.paEnableDisable(tySelRtgObj);for(let i=0;i<tmplVal.hideaverage.length;i++)"SELF"===tmplVal.hideaverage[i]&&pageId.find("#tmplselfaveragehide").prop("checked",!0),"MR"===tmplVal.hideaverage[i]&&pageId.find("#tmplmraveragehide").prop("checked",!0),"REVIEW"===tmplVal.hideaverage[i]&&pageId.find("#tmplreviewaveragehide").prop("checked",!0)}PMSTmpl.constructRatingSec(!0,void 0,!0),tmplVal.paRatingLock||tmplVal.saRatingLock?pageId.find("#tmplisRatingLocked").prop("checked",!0):pageId.find("#tmplisRatingLocked").prop("checked",!1)}else cnt>0?(pageId.find("[name=tmplRatingSecn]").addClass("zpl_DNI"),pageId.find("#tmplmodRtgDiv").removeClass("zpl_DNI")):pageId.find("#tmplmodRtgDiv,#tmploverallRtgDiv").addClass("zpl_DNI"),PMSTmpl.constructRatingSec(!0,void 0,!0);tmplVal.budgetEnable&&(void 0!==tmplVal.hikeDecider&&null!==tmplVal.hikeDecider&&ZPeopleComponents.select(pageId.find("#tmplhkApprSel")).setValue(tmplVal.hikeDecider),tmplVal.hikeApprovalEnable?(pageId.find("#tmplhkApproval").prop("checked",!0),pageId.find("#tmplhkApprConf").show()):(pageId.find("#tmplhkApproval").prop("checked",!1),pageId.find("#tmplhkApprConf").hide()),tmplVal.promotionOnHikeEnabled?pageId.find("#tmplincProp").prop("checked",!0):pageId.find("#tmplincProp").prop("checked",!1)),0===parseInt(tmplVal.publishOption)?pageId.find("#tmplMnlRdBtn").prop("checked",!0):pageId.find("#tmplAutoRdBtn").prop("checked",!0),pageId.find("#tmplempApprFdbkID").prop("checked",tmplVal.shareFeedback),PMSTmpl.pubRtgAllower(),PMSTmpl.fldToPublish()},setMRTypeCheckBx:function(k,v){let pageId=settingsPage.container,enableTg=!1;for(let i=0;i<v.length;i++){let idx="tmplmrType_"+v[i]+"_"+k;pageId.find("#"+idx).prop("checked",!0),enableTg=!0}return enableTg},setCheckBx:function(qtTg,qtTBody,qlTg,qlTBody,mdVl){let pageId=settingsPage.container;$.each(mdVl,function(k,v){let idx="",enableTg=!1,tBody=qtTBody;if("QUS_ANS"===k&&(tBody=qlTBody),v.isRatingEnabled&&(idx=tBody+"_"+k+"_rtChkBx",pageId.find("#"+idx).prop("checked",!0),enableTg=!0),v.isRatingMdty&&(idx=tBody+"_"+k+"_rtMdty",pageId.find("#"+idx).prop("checked",!0),enableTg=!0),v.isCommentEnabled&&(idx=tBody+"_"+k+"_cmtChkBx",pageId.find("#"+idx).prop("checked",!0),enableTg=!0),v.isCommentMdty&&(idx=tBody+"_"+k+"_cmtMdty",pageId.find("#"+idx).prop("checked",!0),enableTg=!0),enableTg){idx=tBody+"_"+k,pageId.find("#"+idx).ztoggleswitch("switchOn"),tBody=qtTg,"QUS_ANS"===k&&(tBody=qlTg),pageId.find("#"+tBody).ztoggleswitch("switchOn");let showHideDiv=pageId.find("#"+tBody).attr("showhidesec");pageId.find("#"+showHideDiv).removeClass("disabled"),pageId.find("#"+showHideDiv).find("[role=switch]").css("pointer-events","")}})},tabSwitchAction:function(li){let pageId=settingsPage.container,ul=$(li).parents("ul");$(ul).find(".zpl_act").removeClass("zpl_act"),$(li).addClass("zpl_act"),pageId.find(".zpl_mmnurgt").find("[sec=tab].zpl_act").removeClass("zpl_act");let actId=$(li).attr("show");pageId.find(".zpl_mmnurgt #"+actId).addClass("zpl_act");let s=pageId.find(".zpl_mmnulft ul li.zpl_act").attr("show");"tmplbasicDetDiv"===s?pageId.find("#prevBtn").addClass("disabled"):pageId.find("#prevBtn").removeClass("disabled"),"tmplpubDetDiv"===s?pageId.find("#nxtBtn").addClass("disabled"):pageId.find("#nxtBtn").removeClass("disabled")},prevBtn:function(){let li=settingsPage.container.find(".zpl_mmnulft ul li.zpl_act").prev();PMSTmpl.tabSwitchAction(li)},nxtBtn:function(){let li=settingsPage.container.find(".zpl_mmnulft ul li.zpl_act").next();PMSTmpl.tabSwitchAction(li)},leftTabConstruct:function(){var pageId=settingsPage.container;let cnt=1,li="";for(let i=0;i<PMSTmpl.LEFT_TAB_ARRAY.length;i++){let t=PMSTmpl.LEFT_TAB_ARRAY[i],v=PMSTmpl.LEFT_TAB_K_V[t];if(void 0!==v){let cls="";1===cnt&&(cls="zpl_act"),li+='<li onclick="PMSTmpl.tabSwitchAction(this);" show="'+t+'" class="'+cls+'"><b>'+cnt+"</b><a>"+v+"</a></li>",cnt++}}pageId.find(".zpl_mmnulft ul").html(li),pageId.find("#tmplbasicDetDiv").addClass("zpl_act"),pageId.find("#prevBtn").addClass("disabled"),pageId.find("#nxtBtn").removeClass("disabled"),-1!==PMSTmpl.LEFT_TAB_ARRAY.indexOf("tmplsaDetDiv")?pageId.find("#tmplmrSaFldDiv").show():pageId.find("#tmplmrSaFldDiv").hide(),PMSTmpl.fldToPublish()},selTgBtnAction:function(obj){$(obj).hasClass("zpl_act")?$(obj).removeClass("zpl_act"):$(obj).addClass("zpl_act"),PMSTmpl.postSelTgBtnAction(obj)},postSelTgBtnAction:function(obj){var compName=$(obj).attr("val"),status=$(obj).hasClass("zpl_act")?1:0;settingsPage.container;if("tmplnrmDetDiv"!=compName||1!==status||PMSV2Cycle.isPARatingEnabled||(status=0),1===status){let idx=PMSTmpl.LEFT_TAB_ARRAY.indexOf(compName+"_hide");PMSTmpl.LEFT_TAB_ARRAY[idx]=compName,PMSTmpl.leftTabConstruct()}else{let idx=PMSTmpl.LEFT_TAB_ARRAY.indexOf(compName);PMSTmpl.LEFT_TAB_ARRAY[idx]=compName+"_hide",PMSTmpl.leftTabConstruct()}"tmplsaDetDiv"===compName?(PMSTmpl.resetModuleSelection("tmplsaQtPmTBody"),PMSTmpl.resetModuleSelection("tmplsaQlPmTBody")):"tmplmrDetDiv"===compName&&(PMSTmpl.resetModuleSelection("tmplmrQtPmTBody"),PMSTmpl.resetModuleSelection("tmplmrQlPmTBody"),PMSTmpl.resetModuleSelection("tmplmrTypeTBody")),PMSTmpl.rtgAction(!1,!0),PMSTmpl.moduleRtgSelAction()},selTgBtnAction_Old:function(event,data){var compName=data.element.attr("val"),status=data.state?1:0;settingsPage.container;if(1===status){let idx=PMSTmpl.LEFT_TAB_ARRAY.indexOf(compName+"_hide");PMSTmpl.LEFT_TAB_ARRAY[idx]=compName,PMSTmpl.leftTabConstruct()}else{let idx=PMSTmpl.LEFT_TAB_ARRAY.indexOf(compName);PMSTmpl.LEFT_TAB_ARRAY[idx]=compName+"_hide",PMSTmpl.leftTabConstruct()}"tmplsaDetDiv"===compName?(PMSTmpl.resetModuleSelection("tmplsaQtPmTBody"),PMSTmpl.resetModuleSelection("tmplsaQlPmTBody")):"tmplmrDetDiv"===compName&&(PMSTmpl.resetModuleSelection("tmplmrQtPmTBody"),PMSTmpl.resetModuleSelection("tmplmrQlPmTBody"),PMSTmpl.resetModuleSelection("tmplmrTypeTBody")),PMSTmpl.rtgAction(),PMSTmpl.moduleRtgSelAction()},resetModuleSelection:function(tBodyID){let pageId=settingsPage.container,trChd=pageId.find("#"+tBodyID).children();$.each(trChd,function(k,v){let tg=$(this).find(".togbutton-js");$(this).find("input[type=checkbox]").each(function(){$(this)[0].checked=!1}),$(tg).ztoggleswitch("switchOff")});let pID=pageId.find("#"+tBodyID).parent("table").attr("id");pageId.find("input[showhidesec="+pID+"]").ztoggleswitch("switchOff")},moduleRtgSelAction:function(){settingsPage.container;let tySelRtgObj=PMSTmpl.getModWgtRtgCmtCntObj(!1);PMSTmpl.saEnableDisable(tySelRtgObj),PMSTmpl.mrEnableDisable(tySelRtgObj),PMSTmpl.paEnableDisable(tySelRtgObj),PMSTmpl.fldToPublish()},saEnableDisable:function(tySelRtgObj){let pageId=settingsPage.container,selfObj=tySelRtgObj.sa;void 0!==selfObj&&selfObj.modCnt>0&&selfObj.modRtgCnt>0?(pageId.find("#tmplselfaveragehide").parent().parent().show(),PMSTmpl.IS_HIDE_AVERGE_ENABLED.SELF=!0):(pageId.find("#tmplselfaveragehide").parent().parent().hide(),PMSTmpl.IS_HIDE_AVERGE_ENABLED.SELF=!1)},mrEnableDisable:function(tySelRtgObj){let pageId=settingsPage.container,mrObj=tySelRtgObj.mr;void 0!==mrObj&&mrObj.modCnt>0&&mrObj.modRtgCnt>0?(pageId.find("#tmplmraveragehide").parent().parent().show(),PMSTmpl.IS_HIDE_AVERGE_ENABLED.MR=!0):(pageId.find("#tmplmraveragehide").parent().parent().hide(),PMSTmpl.IS_HIDE_AVERGE_ENABLED.MR=!1)},paEnableDisable:function(tySelRtgObj){let pageId=settingsPage.container,paObj=tySelRtgObj.pa;void 0!==paObj&&paObj.modCnt>0&&paObj.modRtgCnt>0?(pageId.find("#tmplreviewaveragehide").parent().parent().show(),PMSTmpl.IS_HIDE_AVERGE_ENABLED.REVIEW=!0):(pageId.find("#tmplreviewaveragehide").parent().parent().hide(),PMSTmpl.IS_HIDE_AVERGE_ENABLED.REVIEW=!1)},showDisabledTgBtnAction:function(event,data){if(!event.detail.fromUI)return;var secName=data.element.attr("showhidesec"),status=data.state?1:0,pageId=settingsPage.container;let proceedFlag=!0;if("tmplmrTypeDiv"===secName){let isMRQtPmEnabled=ZPeopleComponents.toggleswitch(pageId.find("#tmplmrModRtDetID")).getState(),isMRQlPmEnabled=ZPeopleComponents.toggleswitch(pageId.find("#tmplmrRQID")).getState();if(isMRQtPmEnabled||isMRQlPmEnabled){let child=pageId.find("#tmplmrQtPmTBody").children();PMSTmpl.mrTypeShowHide($(child[0]))}else proceedFlag=!1,$(data.element).ztoggleswitch("switchOff")}if(proceedFlag){let tBodyID=pageId.find("#"+secName).find("tbody").attr("id");if(1===status){if(pageId.find("#"+secName).removeClass("disabled"),"tmplmodWgtSecDiv"!==secName){let retObj=PMSTmpl.getModWgtRtgCmtCntObj();PMSTmpl.enableDisableAll(tBodyID,"on");let isRefreshRtg=PMSTmpl.isRefreshRatingRange(secName,void 0,retObj,0);PMSTmpl.rtgAction(isRefreshRtg)}}else pageId.find("#"+secName).addClass("disabled"),"tmplmodWgtSecDiv"!==secName&&PMSTmpl.enableDisableAll(tBodyID,"off")}PMSTmpl.moduleRtgSelAction()},enableDisableAll:function(id,onOff,isRefreshRtg){var pageId=settingsPage.container;let txt="switchOff",inpCndt="input[type=checkbox]",retObj=null;"on"===onOff&&(txt="switchOn",inpCndt="tmplmrTypeTBody"===id?"input[type=checkbox]":"input[enb=true]",retObj=PMSTmpl.getModWgtRtgCmtCntObj(!0));let isRtgAction=!1,trList=pageId.find("#"+id).children();if($.each(trList,function(k,v){$(this).find(".togbutton-js").ztoggleswitch(txt),$(this).find(".togbutton-js").next().css("pointer-events","off"==onOff?"none":""),$(this).find(inpCndt).each(function(){"on"===onOff?$(this)[0].checked=!0:(-1===$(this)[0].getAttribute("id").indexOf("_rtChkBx")||isRtgAction||(isRtgAction=$(this)[0].checked),$(this)[0].checked=!1)}),PMSTmpl.mrTypeShowHide(this)}),"off"===onOff&&(retObj=PMSTmpl.getModWgtRtgCmtCntObj(!0)),"off"!==onOff||"tmplsaQntParmDiv"!==id&&"tmplsaQtPmTBody"!==id&&"tmplpaQntParmDiv"!==id&&"tmplpaQtPmTBody"!==id&&"tmplmrQntParmDiv"!==id&&"tmplmrQtPmTBody"!==id||(isRefreshRtg=void 0==isRefreshRtg?isRtgAction:isRefreshRtg),isRefreshRtg=(void 0==isRefreshRtg||!0===isRefreshRtg)&&PMSTmpl.isRefreshRatingRange(id,void 0,retObj,0),PMSTmpl.rtgAction(isRefreshRtg),PMSTmpl.moduleRtgSelAction(),"tmplmrQtPmTBody"===id||"tmplmrQlPmTBody"===id){ZPeopleComponents.toggleswitch(pageId.find("#tmplmrTypeID")).getState()&&retObj.mr.modCnt<=0&&!retObj.mr.QusAns&&(pageId.find("#tmplmrTypeID").ztoggleswitch("switchOff"),pageId.find("#tmplmrTypeDiv").addClass("disabled"),PMSTmpl.enableDisableAll("tmplmrTypeTBody","off"))}},enableDisableModule:function(event,data){if(!event.detail.fromUI)return;var pageId=settingsPage.container,status=data.state?1:0;let retObj=null;1===status&&(retObj=PMSTmpl.getModWgtRtgCmtCntObj(!0));let obj=$(event.detail.element),tr=$(obj).parents("tr"),tBodyName=$(obj).attr("id").split("_")[0],inpCndt=1===status?"input[enb=true]":"input[type=checkbox]",moduleObj={};$(tr).find(inpCndt).each(function(){0==Object.getOwnPropertyNames(moduleObj).length&&(moduleObj.compName=$(this)[0].getAttribute("compname"));let chkBoxId=$(this)[0].getAttribute("id");"QUS_ANS"!==moduleObj.compName?-1!==chkBoxId.indexOf("_rtChkBx")&&(moduleObj.isRatingAction=$(this)[0].checked):moduleObj.isRatingAction=!1,$(this)[0].checked=1===status}),PMSTmpl.mrTypeShowHide(tr),0===status&&(retObj=PMSTmpl.getModWgtRtgCmtCntObj(!0));let isRefreshRtg=PMSTmpl.isRefreshRatingRange(tBodyName,moduleObj,retObj,0);if(PMSTmpl.rtgAction(isRefreshRtg),PMSTmpl.moduleRtgSelAction(),PMSTmpl.onModuleEnableDisableAllAction(obj,!1),"tmplmrQtPmTBody"===tBodyName||"tmplmrQlPmTBody"===tBodyName){ZPeopleComponents.toggleswitch(pageId.find("#tmplmrTypeID")).getState()&&retObj.mr.modCnt<=0&&!retObj.mr.QusAns&&(pageId.find("#tmplmrTypeID").ztoggleswitch("switchOff"),pageId.find("#tmplmrTypeDiv").addClass("disabled"),PMSTmpl.enableDisableAll("tmplmrTypeTBody","off"))}},mrTypeShowHide:function(tr){let tBody=$(tr).parents("tbody"),tBodyID=$(tBody).attr("id");if("tmplmrQtPmTBody"===tBodyID||"tmplmrQlPmTBody"===tBodyID){var pageId=settingsPage.container;let trChild=pageId.find("#tmplmrQtPmTBody").children();$.each(trChild,function(k,v){let togObj=$(this).find(".togbutton-js"),modName=$(togObj).attr("modname");ZPeopleComponents.toggleswitch(togObj).getState()?pageId.find("#tmplmrTypeDiv [mrtypename="+modName+"]").show():pageId.find("#tmplmrTypeDiv [mrtypename="+modName+"]").hide()});let trChild1=pageId.find("#tmplmrQlPmTBody").children();$.each(trChild1,function(k,v){let togObj=$(this).find(".togbutton-js"),modName=$(togObj).attr("modname");ZPeopleComponents.toggleswitch(togObj).getState()?pageId.find("#tmplmrTypeDiv [mrtypename="+modName+"]").show():pageId.find("#tmplmrTypeDiv [mrtypename="+modName+"]").hide()})}},buildQuantitativeParam:function(){let tmplVal=PMSTmpl.EDIT_TMPL_DETAIL,saMod=null,mrMod=null,paMod=null;void 0!==tmplVal&&null!==tmplVal&&(saMod=tmplVal.SA_moduleVal,mrMod=tmplVal.MR_moduleVal,paMod=tmplVal.Reviewer_moduleVal),PMSTmpl.showQuantitativeParam("tmplsaQtPmTBody","tmplsaQlPmTBody",saMod),PMSTmpl.showQuantitativeParam("tmplmrQtPmTBody","tmplmrQlPmTBody",mrMod),PMSTmpl.showQuantitativeParam("tmplpaQtPmTBody","tmplpaQlPmTBody",paMod)},showQuantitativeParam:function(qtPmTBodyID,qlPmTBodyID,selData){var pageId=settingsPage.container,actModuleObj=PMSSetting.SEL_ENABLED_MODULES,kraObj=actModuleObj.KRA,goalObj=actModuleObj.GOALS,kgObj=actModuleObj.KRA_GOALS,comptObj=actModuleObj.COMPETENCY;PMSSetting.SEL_ENABLED_MODULES.KRA_GOALS.displayName=kraObj.displayName+" vs "+goalObj.displayName;var tr="";let ids=[];1===kgObj.enable?(tr+=PMSTmpl.getQtPmRowNew(qtPmTBodyID,kgObj),ids.push(qtPmTBodyID+"_"+kgObj.compName)):(1===kraObj.enable&&(tr+=PMSTmpl.getQtPmRowNew(qtPmTBodyID,kraObj),ids.push(qtPmTBodyID+"_"+kraObj.compName)),1===goalObj.enable&&(tr+=PMSTmpl.getQtPmRowNew(qtPmTBodyID,goalObj),ids.push(qtPmTBodyID+"_"+goalObj.compName))),1===comptObj.enable&&(tr+=PMSTmpl.getQtPmRowNew(qtPmTBodyID,comptObj),ids.push(qtPmTBodyID+"_"+comptObj.compName)),""===tr||0===tr.length?pageId.find("#"+qtPmTBodyID).html(ZPI18N.getString("zp.performance.nomodulemsg")):pageId.find("#"+qtPmTBodyID).html(tr);let QusAns=PMSSetting.SEL_ENABLED_MODULES.QUS_ANS;let reQObj={compName:"QUS_ANS",displayName:void 0!=QusAns.displayName?QusAns.displayName:ZPI18N.getString("zp.questionnaire")};if(pageId.find("#"+qlPmTBodyID).html(PMSTmpl.getQtPmRowNew(qlPmTBodyID,reQObj)),ids.push(qlPmTBodyID+"_"+reQObj.compName),PMSTmpl.moduleToggleAction(ids),"tmplmrQtPmTBody"===qtPmTBodyID)if(void 0!=PMSV2Cycle.mrTypeData&&PMSV2Cycle.mrTypeData.isMrtypeComEnabled){if(void 0===selData||null===selData||selData.length<=0){let th="<tr><th>"+ZPI18N.getString("zp.parameter")+"</th>";1===kgObj.enable?th+="<th mrtypename="+kgObj.compName+">"+kgObj.displayName+"</th>":(1===kraObj.enable&&(th+="<th mrtypename="+kraObj.compName+">"+kraObj.displayName+"</th>"),1===goalObj.enable&&(th+="<th mrtypename="+goalObj.compName+">"+goalObj.displayName+"</th>")),1===comptObj.enable&&(th+="<th mrtypename="+comptObj.compName+">"+comptObj.displayName+"</th>"),th+="<th mrtypename="+reQObj.compName+">"+reQObj.displayName+"</th>",pageId.find("#tmplmrTypeTHead").html(th);let tr="",cnt=0;$.each(PMSV2Cycle.mrtypes,function(index,data){if(0!=cnt){if(tr+='<tr id="tmplmr_module_choice_'+index+'"><td><span>'+data+"</span></td>",1===kgObj.enable){let idx="tmplmrType_"+kgObj.compName+"_"+index;tr+="<td mrtypename="+kgObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+kgObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>'}else{if(1===kraObj.enable){let idx="tmplmrType_"+kraObj.compName+"_"+index;tr+="<td mrtypename="+kraObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+kraObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>'}if(1===goalObj.enable){let idx="tmplmrType_"+goalObj.compName+"_"+index;tr+="<td mrtypename="+goalObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+goalObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>'}}if(1===comptObj.enable){let idx="tmplmrType_"+comptObj.compName+"_"+index;tr+="<td mrtypename="+comptObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+comptObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>'}let idx="tmplmrType_"+reQObj.compName+"_"+index;tr+="<td mrtypename="+reQObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+reQObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>',tr+="</tr>"}cnt+=1}),pageId.find("#tmplmrTypeTBody").html(tr)}else{let th="<tr><th>"+ZPI18N.getString("zp.parameter")+"</th>";for(let i=0;i<selData.length;i++){let m=selData[i];if("QUS_ANS"!==m){let modObj=PMSSetting.SEL_ENABLED_MODULES[m];th+="<th mrtypename="+modObj.compName+">"+modObj.displayName+"</th>"}}th+="<th mrtypename="+reQObj.compName+">"+reQObj.displayName+"</th>",pageId.find("#tmplmrTypeTHead").html(th);let tr="",cnt=0;$.each(PMSV2Cycle.mrtypes,function(index,data){if(0!=cnt){tr+='<tr id="tmplmr_module_choice_'+index+'"><td><span>'+data+"</span></td>";for(let i=0;i<selData.length;i++){let m=selData[i];if("QUS_ANS"!==m){let modObj=PMSSetting.SEL_ENABLED_MODULES[m],idx="tmplmrType_"+modObj.compName+"_"+index;tr+="<td mrtypename="+modObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+modObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>'}}let idx="tmplmrType_"+reQObj.compName+"_"+index;tr+="<td mrtypename="+reQObj.compName+'><div class="zcheckbox"><input id='+idx+' modname="'+reQObj.compName+'" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idx+' class="zcheckbox__label"></label></div></td>',tr+="</tr>"}cnt+=1}),pageId.find("#tmplmrTypeTBody").html(tr)}pageId.find("#tmplmrTypeIDSecDiv").show(),pageId.find("#tmplmrTypeSecDiv").show(),pageId.find("#tmplmrSelTypeDiv").show()}else pageId.find("#tmplmrTypeIDSecDiv").hide(),pageId.find("#tmplmrTypeSecDiv").hide(),pageId.find("#tmplmrSelTypeDiv").hide()},moduleToggleAction:function(ids){var pageId=settingsPage.container;$.each(ids,function(k,v){ZPeopleComponents.toggleswitch(pageId.find("#"+v)).setAttributes({change:PMSTmpl.enableDisableModule})})},getQtPmRowNew:function(prefix,obj){let rtShowFlg=!0;-1!==prefix.indexOf("QlPmTBody")&&(rtShowFlg=!1);let section="";"tmplsaQtPmTBody"===prefix||"tmplsaQlPmTBody"===prefix?section="sa":"tmplmrQtPmTBody"===prefix||"tmplmrQlPmTBody"===prefix?section="mr":"tmplpaQtPmTBody"!==prefix&&"tmplpaQlPmTBody"!==prefix||(section="pa");let rtgCntFlg="tmplmrQtPmTBody"===prefix?"":"rtgcnt=yes",mdtyLbl=ZPI18N.getString("zp.lms.mandatory"),cmnPfx=prefix+"_"+obj.compName,tr='<tr id="tmpltr_'+obj.compName+'">';if(tr+='<td><div class="zpl_idiv"><div class="zpl_tgl"><input id='+cmnPfx+" sect="+section+' modname="'+obj.compName+'" class="togbutton-js" style="display: none;">'+obj.displayName+'</div></div><div class="zpl_idiv"><em class="zpl_tgllftml">'+mdtyLbl+"</em></div></td>",rtShowFlg){let idPfx=cmnPfx+"_rtChkBx";tr+='<td><div class="zpl_idiv j-cnt-cntr"><div class="zcheckbox"><input id='+idPfx+" sect="+section+' enb=true compname="'+obj.compName+'" modname="'+obj.compName+'_Rating" '+rtgCntFlg+"  depid="+cmnPfx+' onclick="PMSTmpl.qtChkBox(this);" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idPfx+' class="zcheckbox__label"></label></div></div>',tr+='<div class="zpl_idiv j-cnt-cntr"><div class="zcheckbox"><input id='+(idPfx=cmnPfx+"_rtMdty")+" depid="+cmnPfx+' compname="'+obj.compName+'" onclick="PMSTmpl.mdtyChkBox(this);" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idPfx+' class="zcheckbox__label"></label></div></div></td>'}let idPfx1=cmnPfx+"_cmtChkBx";return tr+='<td><div class="zpl_idiv j-cnt-cntr"><div class="zcheckbox"><input id='+idPfx1+" sect="+section+' compname="'+obj.compName+'" enb=true depid='+cmnPfx+' onclick="PMSTmpl.qtChkBox(this);" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idPfx1+' class="zcheckbox__label"></label></div></div>',tr+='<div class="zpl_idiv j-cnt-cntr"><div class="zcheckbox"><input id='+(idPfx1=cmnPfx+"_cmtMdty")+" depid="+cmnPfx+' cmtmdty=true compname="'+obj.compName+'" onclick="PMSTmpl.mdtyChkBox(this);" type="checkbox" name="check" class="zcheckbox__helper"><label for='+idPfx1+' class="zcheckbox__label"></label></div></div></td>',tr+="</tr>"},mdtyChkBox:function(obj){var pageId=settingsPage.container,val=$(obj).prop("checked"),id=$(obj).attr("id");let tBodyName=id.split("_")[0],compname=$(obj).attr("compname"),isalreadyCheck=!1;if(val){var modId=$(obj).attr("depid");pageId.find("#"+modId).prop("checked",val),-1!==id.indexOf("_rtMdty")?(isalreadyCheck=pageId.find("#"+modId+"_rtChkBx").is(":checked"),pageId.find("#"+modId+"_rtChkBx").prop("checked",val),pageId.find("#"+modId).ztoggleswitch("switchOn")):-1!==id.indexOf("_cmtMdty")&&(pageId.find("#"+modId+"_cmtChkBx").prop("checked",val),pageId.find("#"+modId).ztoggleswitch("switchOn"))}let retObj=PMSTmpl.getModWgtRtgCmtCntObj(),isRefreshRtg=!1;val&&(isRefreshRtg=PMSTmpl.isRefreshRatingRange(tBodyName,{compName:compname,isRatingAction:-1!==id.indexOf("_rtMdty"),isMandatoryAction:!0,prevRatingEnabled:isalreadyCheck},retObj,1)),PMSTmpl.rtgAction(isRefreshRtg),PMSTmpl.moduleRtgSelAction()},showHideCmtLenDiv:function(){var pageId=settingsPage.container;PMSTmpl.getCmtMdtyCnt()>0?(pageId.find("#tmplcmtLenDiv").removeClass("DN"),PMSTmpl.IS_MIN_CMT_LEN_ENABLED=!0):(pageId.find("#tmplcmtLenDiv").addClass("DN"),pageId.find("#tmplcmtLenInp").val(""),PMSTmpl.IS_MIN_CMT_LEN_ENABLED=!1)},onModuleEnableDisableAllAction:function(obj,isRefreshRtg){let table=$(obj).parents("table"),elements=table.find(".togbutton-js");var isAllEnable=!1;if($.each(elements,function(k,v){ZPeopleComponents.toggleswitch($(this)).getState()&&(isAllEnable=!0)}),!isAllEnable){let togObj=$(obj).parents("table").parent().parent().prev().find(".togbutton-js");ZPeopleComponents.toggleswitch(togObj).switchOff();let tBodyID=$(obj).parents("tbody").attr("id");table.addClass("disabled"),PMSTmpl.enableDisableAll(tBodyID,"off",isRefreshRtg)}},qtChkBox:function(obj){var pageId=settingsPage.container,val=$(obj).prop("checked");let txt=val?"switchOn":"switchOff",id=$(obj).attr("id"),tBodyName=id.split("_")[0];var modId=$(obj).attr("depid");let compname=$(obj).attr("compname");if(val)pageId.find("#"+modId).ztoggleswitch(txt);else if(-1!==id.indexOf("_rtChkBx"))pageId.find("#"+modId+"_rtMdty").prop("checked",val),pageId.find("#"+modId+"_cmtChkBx").prop("checked")||pageId.find("#"+modId).ztoggleswitch(txt);else if(-1!==id.indexOf("_cmtChkBx")){pageId.find("#"+modId+"_cmtMdty").prop("checked",val),pageId.find("#"+modId+"_rtChkBx").prop("checked")||pageId.find("#"+modId).ztoggleswitch(txt)}let retObj=PMSTmpl.getModWgtRtgCmtCntObj(!0),isRefreshRtg=PMSTmpl.isRefreshRatingRange(tBodyName,{compName:compname,isRatingAction:-1!==id.indexOf("_rtChkBx"),isMandatoryAction:!1},retObj,val?1:0);if(PMSTmpl.rtgAction(isRefreshRtg),PMSTmpl.moduleRtgSelAction(),"tmplmrQtPmTBody"===tBodyName||"tmplmrQlPmTBody"===tBodyName){let tr=$(obj).parents("tr");PMSTmpl.mrTypeShowHide(tr),ZPeopleComponents.toggleswitch(pageId.find("#tmplmrTypeID")).getState()&&retObj.mr.modCnt<=0&&!retObj.mr.QusAns&&(pageId.find("#tmplmrTypeID").ztoggleswitch("switchOff"),pageId.find("#tmplmrTypeDiv").addClass("disabled"),PMSTmpl.enableDisableAll("tmplmrTypeTBody","off"))}PMSTmpl.onModuleEnableDisableAllAction(obj,!1)},modTDChkBox:function(obj){var pageId=settingsPage.container,val=$(obj).prop("checked"),pId=$(obj).attr("id");val?(pageId.find("#tmpl"+pId+"_rtChkBx").prop("checked",val),pageId.find("#tmpl"+pId+"_cmtChkBx").prop("checked",val)):(pageId.find("#tmpl"+pId+"_rtChkBx").prop("checked",val),pageId.find("#tmpl"+pId+"_rtMdty").prop("checked",val),pageId.find("#tmpl"+pId+"_cmtChkBx").prop("checked",val),pageId.find("#tmpl"+pId+"_cmtMdty").prop("checked",val)),PMSTmpl.rtgAction(),PMSTmpl.moduleRtgSelAction()},constructModWgt:function(){let pageId=settingsPage.container,actModuleObj=PMSSetting.SEL_ENABLED_MODULES,constructModWht=function(moduleObj,compId){let _whtHtml="";return 1===moduleObj.enable&&(_whtHtml="<tr><td>"+moduleObj.displayName+'</td><td><input compNme="'+moduleObj.compName+'" id="'+compId+'" type="text" class="ztextbox w60" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'moduleWeightage\');"></td></tr>'),_whtHtml},_htm="";1===actModuleObj.KRA_GOALS.enable?_htm=constructModWht(actModuleObj.KRA_GOALS,"tmplkgMWgtID"):(_htm=constructModWht(actModuleObj.GOALS,"tmplgoalMWgtID"),_htm+=constructModWht(actModuleObj.KRA,"tmplkraMWgtID")),""!=(_htm+=constructModWht(actModuleObj.COMPETENCY,"tmplcompMWgtID"))&&pageId.find("#tmplmodWgtTBody").html(_htm)},onRatingTypeAction:function(eData){if(!eData.fromUI)return;if(eData&&(""===eData.selectedValue||eData.previousValue==eData.selectedValue))return;var pageId=settingsPage.container;let selRtgTpe=eData.selectedValue,eleId=$(eData.element)[0].getAttribute("id");if(pageId.find("#tmplMnVl").removeClass("ztextbox__error"),pageId.find("#tmplMxVl").removeClass("ztextbox__error"),pageId.find("#tmplNumRtgDiv [elem=errorMsg]").remove(),pageId.find("#tmplrtgSecDiv [elem=errorMsg]").remove(),"tmplratingType"===eleId)"starRating"===selRtgTpe?pageId.find("#tmplNumRtgDiv,#tmplTxtRtgDiv").hide():"numberRating"===selRtgTpe?(pageId.find("#tmplTxtRtgDiv").hide(),pageId.find("#tmplNumRtgDiv").show(),pageId.find("#tmplMnVl").val(1).addClass("disabled"),pageId.find("#tmplMxVl").val(5)):"textRating"===selRtgTpe?(pageId.find("#tmplNumRtgDiv").hide(),pageId.find("#tmplTxtRtgDiv").show(),PMSTmpl.getTextRatingSec(!0,!0,!0,!0)):"customRating"===selRtgTpe&&(pageId.find("#tmplTxtRtgDiv").hide(),pageId.find("#tmplNumRtgDiv").show(),pageId.find("#tmplMnVl").val(0).removeClass("disabled"),pageId.find("#tmplMxVl").val(10)),PMSTmpl.constructRatingSec(!0);else{"customRating"===pageId.find("#tmplratingType").val()?(PMSTmpl.updateRatingRangeValue(),PMSTmpl.constructRatingSec(!1)):PMSTmpl.constructRatingSec(!0)}},rtgAction:function(refresh,isUpdateNorm){var pageId=settingsPage.container;let retObj=PMSTmpl.getModWgtRtgCmtCntObj(!1);PMSV2Cycle.IS_FINALSCORE_ENABLED&&(retObj.sa.modRtgCnt>=2||retObj.mr.modRtgCnt>=2||retObj.pa.modRtgCnt>=2)?(pageId.find("#tmplmodWgtDiv").show(),PMSTmpl.IS_MOD_WHT_ENABLED=!0,PMSTmpl.modWgtAction()):(pageId.find("#tmplmodWgtDiv").hide(),PMSTmpl.IS_MOD_WHT_ENABLED=!1);let rtgCnt=(retObj=PMSTmpl.getModWgtRtgCnt()).rtgCnt,cnt=PMSTmpl.getCmtMdtyCnt();rtgCnt>0||cnt>0?(rtgCnt>0?pageId.find("#tmploverallRtgDiv, [name=tmplRatingSecn]").removeClass("zpl_DNI"):pageId.find("[name=tmplRatingSecn]").addClass("zpl_DNI"),pageId.find("#tmplmodRtgDiv").removeClass("zpl_DNI")):pageId.find("#tmplmodRtgDiv,#tmploverallRtgDiv").addClass("zpl_DNI"),PMSTmpl.constructRatingSec(void 0===refresh||refresh,isUpdateNorm),PMSTmpl.showHideCmtLenDiv()},modWgtAction:function(){let pageId=settingsPage.container,actModuleObj=PMSSetting.SEL_ENABLED_MODULES,chkConstrucModWgt=function(moduleObj,wgtId){let compName=moduleObj.compName;if(pageId.find("input[modname="+compName+"_Rating]").is(":checked")){if(0===pageId.find("#tmplmodWgtTBody #"+wgtId).length){let _wgtHtm="<tr><td>"+moduleObj.displayName+'</td><td><input compNme="'+compName+'" id="'+wgtId+'" type="text" class="ztextbox w60" value="" onkeydown="return paCommonUtil.onNRKeyDown(this,event,\'moduleWeightage\');"></td></tr>';"GOALS"===compName||"KRA_GOALS"===compName?pageId.find("#tmplmodWgtTBody").prepend(_wgtHtm):"COMPETENCY"===compName?pageId.find("#tmplmodWgtTBody").append(_wgtHtm):"KRA"===compName&&(0===pageId.find("#tmplmodWgtTBody #tmplgoalMWgtID").length?pageId.find("#tmplmodWgtTBody").prepend(_wgtHtm):$(_wgtHtm).insertAfter(pageId.find("#tmplmodWgtTBody #tmplgoalMWgtID").closest("tr")))}pageId.find("#"+wgtId).removeClass("disabled").removeAttr("disabled")}else pageId.find("#"+wgtId).addClass("disabled").attr("disabled","true"),pageId.find("#"+wgtId).val("")};chkConstrucModWgt(actModuleObj.GOALS,"tmplgoalMWgtID"),chkConstrucModWgt(actModuleObj.KRA,"tmplkraMWgtID"),chkConstrucModWgt(actModuleObj.KRA_GOALS,"tmplkgMWgtID"),chkConstrucModWgt(actModuleObj.COMPETENCY,"tmplcompMWgtID")},getCmtMdtyCnt:function(){let rtgCnt=0,rtgChilds=settingsPage.container.find("input[cmtmdty=true]");return $.each(rtgChilds,function(k,v){$(this).prop("checked")&&(rtgCnt+=1)}),rtgCnt},getRtgCntWithOutMR:function(tBodyID){let pageId=settingsPage.container,rtgCnt=0,rtgChilds=pageId.find("input[rtgcnt=yes]");return void 0!==tBodyID&&(rtgChilds=pageId.find("#"+tBodyID+" input[rtgcnt=yes]")),$.each(rtgChilds,function(k,v){$(this).prop("checked")&&(rtgCnt+=1)}),rtgCnt},getModWgtRtgCnt:function(){let rtgCnt=0,modInc=[],rtgChilds=settingsPage.container.find("input[id*=_rtChkBx]");return $.each(rtgChilds,function(k,v){let state=$(this).prop("checked"),cNm=$(this).attr("compname");state&&(rtgCnt+=1,-1===modInc.indexOf(cNm)&&modInc.push(cNm))}),{modInc:modInc,rtgCnt:rtgCnt}},getTypeWiseRtgCnt:function(withQA){let pageId=settingsPage.container,typeWsRtg={sa:0,mr:0,pa:0},rtgChilds=pageId.find("input[modname=KRA]");return $.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked");if(void 0!==compNme&&state){let t=typeWsRtg[compNme];typeWsRtg[compNme]=t+1}}),rtgChilds=pageId.find("input[modname=GOALS]"),$.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked");if(void 0!==compNme&&state){let t=typeWsRtg[compNme];typeWsRtg[compNme]=t+1}}),rtgChilds=pageId.find("input[modname=KRA_GOALS]"),$.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked");if(void 0!==compNme&&state){let t=typeWsRtg[compNme];typeWsRtg[compNme]=t+1}}),rtgChilds=pageId.find("input[modname=COMPETENCY]"),$.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked");if(void 0!==compNme&&state){let t=typeWsRtg[compNme];typeWsRtg[compNme]=t+1}}),withQA&&(rtgChilds=pageId.find("input[modname=QUS_ANS]"),$.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked");if(void 0!==compNme&&state){let t=typeWsRtg[compNme];typeWsRtg[compNme]=t+1}})),typeWsRtg},getModWgtRtgCmtCntObj:function(withQA){let pageId=settingsPage.container,finalObj={},selfObj={modCnt:0,modRtgCnt:0,modCmtCnt:0},mrObj={modCnt:0,modRtgCnt:0,modCmtCnt:0},paObj={modCnt:0,modRtgCnt:0,modCmtCnt:0},updateObjCnt=(compName,isModEnabled,isRtgEnabled,isCmtEnabled,isQA)=>{let tmpObj=void 0;if("sa"===compName?tmpObj=selfObj:"mr"===compName?tmpObj=mrObj:"pa"===compName&&(tmpObj=paObj),void 0!==compName&&void 0!==tmpObj){if(isModEnabled&&!isQA){let orgCnt=tmpObj.modCnt;tmpObj.modCnt=orgCnt+1,isRtgEnabled&&(orgCnt=tmpObj.modRtgCnt,tmpObj.modRtgCnt=orgCnt+1),isCmtEnabled&&(orgCnt=tmpObj.modCmtCnt,tmpObj.modCmtCnt=orgCnt+1)}isQA&&(tmpObj.QusAns=isModEnabled)}},moduleCompStatus=modName=>{let rtgChilds=pageId.find("input[modname="+modName+"]");$.each(rtgChilds,function(k,v){let compNme=$(this).attr("sect"),state=$(this).prop("checked"),id=$(this).attr("id"),isRtgEnabled=!1,isCmtEnabled=!1;if(void 0!==compNme&&state&&"QUS_ANS"!==modName){let rtgChkId=id+"_rtChkBx";isRtgEnabled=pageId.find("#"+rtgChkId).prop("checked"),rtgChkId=id+"_cmtChkBx",isCmtEnabled=pageId.find("#"+rtgChkId).prop("checked"),updateObjCnt(compNme,state,isRtgEnabled,isCmtEnabled,!1)}"QUS_ANS"===modName&&updateObjCnt(compNme,state,isRtgEnabled,isCmtEnabled,!0)})};return moduleCompStatus("KRA"),moduleCompStatus("GOALS"),moduleCompStatus("KRA_GOALS"),moduleCompStatus("COMPETENCY"),withQA&&moduleCompStatus("QUS_ANS"),finalObj.sa=selfObj,finalObj.mr=mrObj,finalObj.pa=paObj,finalObj},getModSelObj:function(qtPmTBody,qlPmtTBody){let pageId=settingsPage.container,modVl=[],tgChilds=pageId.find("#"+qtPmTBody).find(".togbutton-js");return $.each(tgChilds,function(k,v){let state=ZPeopleComponents.toggleswitch(this).getState(),modnm=$(this).attr("modname");state&&modVl.push(modnm)}),tgChilds=pageId.find("#"+qlPmtTBody).find(".togbutton-js"),$.each(tgChilds,function(k,v){let state=ZPeopleComponents.toggleswitch(this).getState(),modnm=$(this).attr("modname");state&&modVl.push(modnm)}),modVl},getModSelRtgCmtObj:function(qtPmTBody,qlPmtTBody,enabledModArr){let pageId=settingsPage.container,modVl={};for(let i=0;i<enabledModArr.length;i++){let m=enabledModArr[i],chkChilds=pageId.find("#"+qtPmTBody).find("input[type=checkbox][compname="+m+"]");"QUS_ANS"===m&&(chkChilds=pageId.find("#"+qlPmtTBody).find("input[type=checkbox][compname="+m+"]"));let mvObj=PMSTmpl.buildModVlObj(chkChilds,m);modVl[m]={isRatingEnabled:mvObj.isRatingEnabled,isRatingMdty:mvObj.isRatingMdty,isCommentEnabled:mvObj.isCommentEnabled,isCommentMdty:mvObj.isCommentMdty}}return modVl},buildModVlObj:function(chkChilds,m){let isRatingEnabled=!1,isCommentEnabled=!1,isRatingMdty=!1,isCommentMdty=!1;return $.each(chkChilds,function(k,v){let idx=$(this).attr("id");-1!==idx.indexOf("_rtChkBx")?isRatingEnabled=$(this).prop("checked"):"QUS_ANS"===m&&(isRatingEnabled=!0),-1!==idx.indexOf("_rtMdty")?isRatingMdty=$(this).prop("checked"):"QUS_ANS"===m&&(isRatingMdty=!0),-1!==idx.indexOf("_cmtChkBx")&&(isCommentEnabled=$(this).prop("checked")),-1!==idx.indexOf("_cmtMdty")&&(isCommentMdty=$(this).prop("checked"))}),{isRatingEnabled:isRatingEnabled,isRatingMdty:isRatingMdty,isCommentEnabled:isCommentEnabled,isCommentMdty:isCommentMdty}},getMRModSelObj:function(){let pageId=settingsPage.container,mrObj={isEnabled:!0};mrObj.mrTemplateId=PMSV2Cycle.mrTemplateId;let isAddReporteeFlg=ZPeopleComponents.toggleswitch(pageId.find("#tmplmrAutoPopulate")).getState(),mrChoice=parseInt(pageId.find("[name=mrSelRdBx]:checked").val());if(mrObj.MRchoice=mrChoice,mrObj.minrater=pageId.find("#tmplminrater").val(),mrObj.maxrater=pageId.find("#tmplmaxrater").val(),1==mrChoice){var showRaterByRM=pageId.find("#tmplmrAnonID").is(":checked");mrObj.showRaterByRM=!showRaterByRM,isAddReporteeFlg&&(mrObj.MRchoice=4)}if(isAddReporteeFlg){var defaulttype=pageId.find("#tmplmrTypeSelID").val();null!=PMSV2Cycle.mrTypeData&&PMSV2Cycle.mrTypeData.isMrtypeComEnabled&&PMSV2Cycle.mrTypeData.isMrtypeMandatary?"-1"!=defaulttype&&(mrObj.defaultmrtype=defaulttype):mrObj.defaultmrtype=defaulttype}isAddReporteeFlg&&2==mrObj.MRchoice&&(mrObj.MRchoice=5);let isSfApprVw=pageId.find("#tmplselfApprViewForMR").is(":checked");mrObj.showSelfApprForMR=!!isSfApprVw;let isMRTypeEnable=ZPeopleComponents.toggleswitch(pageId.find("#tmplmrTypeID")).getState();if(mrObj.isMRtypeModules=isMRTypeEnable,isMRTypeEnable){let mrArr=[],hd={},mrMoVl=PMSTmpl.getModSelObj("tmplmrQtPmTBody","tmplmrQlPmTBody"),mrMoVlDet={};mrMoVl.length>0&&(hd.optionID="1",hd.moduleVal=mrMoVl,mrMoVlDet=PMSTmpl.getModSelRtgCmtObj("tmplmrQtPmTBody","tmplmrQlPmTBody",mrMoVl),hd.mrJSONRatingComment=mrMoVlDet),mrArr.push(hd),$.each(PMSV2Cycle.mrtypes,function(index,data){let t={};var ratingstatus={};if("1"!==index){let mVl=[];t.optionID=index;let tdChild=pageId.find("#tmplmr_module_choice_"+index).find("input[type=checkbox]:checked");$.each(tdChild,function(k,v){let mNm=$(this).attr("modname");-1!==mrMoVl.indexOf(mNm)&&("KRA"!==mNm&&"GOALS"!==mNm&&"KRA_GOALS"!==mNm&&"COMPETENCY"!==mNm&&"QUS_ANS"!==mNm||(mVl.push(mNm),ratingstatus[mNm]={},ratingstatus[mNm].isRatingEnabled=mrMoVlDet[mNm].isRatingEnabled,ratingstatus[mNm].isRatingMdty=mrMoVlDet[mNm].isRatingMdty,ratingstatus[mNm].isCommentEnabled=mrMoVlDet[mNm].isCommentEnabled,ratingstatus[mNm].isCommentMdty=mrMoVlDet[mNm].isCommentMdty))}),t.mrJSONRatingComment=ratingstatus,t.moduleVal=mVl,mrArr.push(t)}}),mrObj.ModuleTypeData=mrArr}else{let mrMoVl=PMSTmpl.getModSelObj("tmplmrQtPmTBody","tmplmrQlPmTBody");mrMoVl.length>0&&(mrObj.moduleVal=mrMoVl,mrObj.mrJSONRatingComment=PMSTmpl.getModSelRtgCmtObj("tmplmrQtPmTBody","tmplmrQlPmTBody",mrMoVl))}return mrObj},constructRatingSection:function(){settingsPage.container;PMSTmpl.getRatingSec(!0,!0,!0,!0)},getTextRatingSec:function(refresh,add,edit,del){let pageId=settingsPage.container,ul='<div class="zpl_idiv flex-wrap">';if(refresh){let modRtgObj=null!==PMSTmpl.EDIT_TMPL_DETAIL?PMSTmpl.EDIT_TMPL_DETAIL.moduleRatingType:null;if(void 0!==modRtgObj&&null!==modRtgObj&&Object.keys(modRtgObj).length>0&&2===modRtgObj.type){PMSV2Cycle.textrating_name=modRtgObj.textRatingName,PMSV2Cycle.textrating_value=modRtgObj.textRatingValue;for(let itr=0;itr<PMSV2Cycle.textrating_name.length;itr++)PMSV2Cycle.textrating_name[itr]=ZPeople.decodeTxt(PMSV2Cycle.textrating_name[itr])}else PMSV2Cycle.textrating_name=[ZPI18N.getString("zp.unsatisfactory"),ZPI18N.getString("zp.needimprovement"),ZPI18N.getString("zp.satisfactory"),ZPI18N.getString("zp.excellent"),ZPI18N.getString("zp.outstanding")],PMSV2Cycle.textrating_value=[1,2,3,4,5]}let editOnClick="";for(let i=PMSV2Cycle.textrating_name.length-1;i>=0;i--){let rtgName=PMSV2Cycle.textrating_name[i];editOnClick=edit?'<input type="text" class="ztextbox" rtgNme="'+rtgName+'" value="'+rtgName+'" onchange="PMSTmpl.editTxtRtgFocusOut(this);">':'<span rtgNme="'+rtgName+'">'+rtgName+"</span>",ul+='<div class="zpl_iputgrp zpl_iputgrpcls" rtgNme="'+rtgName+'"><span>'+PMSV2Cycle.textrating_value[i]+"</span>"+editOnClick+'<i class="PI_cls" onclick="PMSTmpl.onDelTxtRtg(this);"></i></div>'}ul+="</div>",add&&(ul+='<div class="zpl_idiv" id="addTxtRtgBtn"><a class="zpl_lnkbg" onclick="PMSTmpl.newTxtRtgDiv();">'+ZPI18N.getString("zp.addrating")+"</a></div>"),pageId.find("#tmplCstTxtRtgID").html(ul),PMSV2Cycle.textrating_name.length>=10&&pageId.find("#addTxtRtgBtn").addClass("zpl_DNI"),PMSTmpl.constructRatingSec(refresh)},newTxtRtgDiv:function(){let pageId=settingsPage.container;if(PMSTmpl.validateTextRatingName()){let newDiv='<div class="zpl_iputgrp zpl_iputgrpcls"><span>'+[PMSV2Cycle.textrating_name.length+1]+'</span><input id="newTxtRtgInp" type="text" class="ztextbox" value="" onchange="PMSTmpl.newTxtRtgFocusOut();"><i class="PI_cls" onclick="PMSTmpl.onDelTxtRtg(this);"></i></div>';pageId.find("#tmplCstTxtRtgID .zpl_idiv.flex-wrap").prepend(newDiv),pageId.find("#addTxtRtgBtn").addClass("disabled"),pageId.find("#newTxtRtgInp").trigger("focus")}},showTxtRtgErrorMsg:function(isEmptyName,obj){let pageId=settingsPage.container,msg="";msg=isEmptyName?ZPI18N.getString("zp.ratingmandatory"):ZPI18N.getString("zp.ratinglengtherror"),$(obj).addClass("ztextbox__error"),$('<span elem="errorMsg" class="ztextbox--error__label">'+msg+"</span>").insertBefore(pageId.find("#addTxtRtgBtn")),$(pageId.find("#addTxtRtgBtn").siblings())[0].scrollIntoView({behavior:"smooth",block:"center"})},validateTextRatingName:function(){let isValid=!0,isEmptyName=!1,pageId=settingsPage.container,txtRatingChild=pageId.find("#tmplTxtRtgDiv #tmplCstTxtRtgID .zpl_iputgrp"),errorObj=void 0;return $(txtRatingChild).each(function(index,obj){let rtgName=$(obj).find("input").val().trim();(void 0===rtgName||""===rtgName||rtgName.length>50)&&(void 0!==rtgName&&""!==rtgName||(isEmptyName=!0),isValid=!1,void 0===errorObj&&(errorObj=$(obj).find("input")))}),pageId.find("#tmplCstTxtRtgID [elem=errorMsg]").remove(),pageId.find("#tmplCstTxtRtgID").find("input").removeClass("ztextbox__error"),isValid||PMSTmpl.showTxtRtgErrorMsg(isEmptyName,errorObj),isValid},newTxtRtgFocusOut:function(){let pageId=settingsPage.container,newRtg=pageId.find("#newTxtRtgInp").val().trim();pageId.find("#tmplCstTxtRtgID").find("input").removeClass("ztextbox__error"),pageId.find("#tmplCstTxtRtgID [elem=errorMsg]").remove(),void 0!==newRtg&&""!==newRtg&&newRtg.length<=50?(PMSV2Cycle.textrating_name.push(ZPeople.escapeHtml(newRtg)),PMSV2Cycle.textrating_value.push(PMSV2Cycle.textrating_name.length),pageId.find("#addTxtRtgBtn").removeClass("disabled"),PMSTmpl.getTextRatingSec(!1,!0,!0,!0)):PMSTmpl.showTxtRtgErrorMsg(void 0===newRtg||""===newRtg,pageId.find("#newTxtRtgInp"))},editTxtRtgFocusOut:function(obj){let pageId=settingsPage.container,rtgName=$(obj).val().trim();if(pageId.find("#tmplCstTxtRtgID").find("input").removeClass("ztextbox__error"),pageId.find("#tmplCstTxtRtgID [elem=errorMsg]").remove(),void 0!==rtgName&&""!==rtgName&&rtgName.length<=50){let oldRtgName=$(obj).attr("rtgnme"),index=PMSV2Cycle.textrating_name.indexOf(ZPeople.escapeHtml(oldRtgName));PMSV2Cycle.textrating_name[index]=ZPeople.escapeHtml(rtgName),PMSTmpl.getTextRatingSec(!1,!0,!0,!0)}else PMSTmpl.showTxtRtgErrorMsg(void 0===rtgName||""===rtgName,obj)},onDelTxtRtg:function(obj){if(PMSV2Cycle.textrating_name.filter(Boolean).length<=3)ZPeople.Message.warning(ZPI18N.getString("zp.minratreq"));else{let mainDiv=$(obj).parents("div"),rtgNme=$(mainDiv).attr("rtgNme"),pageId=settingsPage.container;if(pageId.find("#tmplCstTxtRtgID").find("input").removeClass("ztextbox__error"),pageId.find("#tmplCstTxtRtgID [elem=errorMsg]").remove(),void 0!=rtgNme&&""!=rtgNme){let idx=PMSV2Cycle.textrating_name.indexOf(ZPeople.escapeHtml(rtgNme));-1!==idx&&(PMSV2Cycle.textrating_name.splice(idx,1),PMSV2Cycle.textrating_value.splice(PMSV2Cycle.textrating_value.length-1,1))}}PMSTmpl.getTextRatingSec(!1,!0,!0,!0)},parseCycleRatings:function(){let cycleRtgArr=PMSTmpl.EDIT_TMPL_DETAIL.cycleRatings.configArr,cnt=0;PMSV2Cycle.rating_keyarray=[],PMSV2Cycle.rating_idarray=[],PMSV2Cycle.rating_minRangeArray=[],PMSV2Cycle.rating_maxRangeArray=[],PMSV2Cycle.rating_normPerArray=[];for(let i=cycleRtgArr.length-1;i>=0;i--)PMSV2Cycle.rating_keyarray[cnt]=cycleRtgArr[i].ratingName,PMSV2Cycle.rating_idarray[cnt]=cycleRtgArr[i].ratingId,void 0!==cycleRtgArr[i].minRange&&(PMSV2Cycle.rating_minRangeArray[cnt]=cycleRtgArr[i].minRange),void 0!==cycleRtgArr[i].maxRange&&(PMSV2Cycle.rating_maxRangeArray[cnt]=cycleRtgArr[i].maxRange),PMSV2Cycle.rating_normPerArray[cnt]=cycleRtgArr[i].norPer,cnt+=1},isDiffRating:function(data){let rtnFlg=!1;if(null!==data&&void 0!==data&&Object.keys(data).length>0){let rtgCmVl=data.ratingCommentStatus;if(void 0!==rtgCmVl&&null!==rtgCmVl&&Object.keys(rtgCmVl).length>0){let paVl=rtgCmVl.reviewObj;if($.each(paVl,function(k,v){if(v.isRatingEnabled)return rtnFlg=!0,!1}),rtnFlg)return!0;if(paVl=rtgCmVl.selfObj,$.each(paVl,function(k,v){if(v.isRatingEnabled)return rtnFlg=!0,!1}),rtnFlg)return!0;paVl=rtgCmVl.mrObj,$.each(paVl,function(k,v){if(v.isRatingEnabled)return rtnFlg=!0,!1})}else rtnFlg=!1}else rtnFlg=!1;return rtnFlg},isRefreshRatingRange:function(tBodyName,moduleObj,rtgCntObj,refreshCnt){let checkRefresh=!1,isRefresh=!1,isMultiRater=!1,isSelfAppr=!1,isPaAppr=!1;if("tmplsaQntParmDiv"!==tBodyName&&"tmplsaQtPmTBody"!==tBodyName&&"tmplpaQntParmDiv"!==tBodyName&&"tmplpaQtPmTBody"!==tBodyName&&"tmplmrQntParmDiv"!==tBodyName&&"tmplmrQtPmTBody"!==tBodyName||(checkRefresh=!0,"tmplsaQntParmDiv"===tBodyName||"tmplsaQtPmTBody"===tBodyName?isSelfAppr=!0:"tmplpaQntParmDiv"===tBodyName||"tmplpaQtPmTBody"===tBodyName?isPaAppr=!0:"tmplmrQntParmDiv"!==tBodyName&&"tmplmrQtPmTBody"!==tBodyName||(isMultiRater=!0)),void 0!==moduleObj&&void 0!==moduleObj.compName&&void 0!==moduleObj.isRatingAction&&(checkRefresh="QUS_ANS"!==moduleObj.compName&&1==moduleObj.isRatingAction&&(void 0===moduleObj.isMandatoryAction||!moduleObj.isMandatoryAction||!moduleObj.prevRatingEnabled)),checkRefresh){let saCnt=0,paCnt=0,mrCnt=0,rfrCnt=parseInt(refreshCnt);if(void 0!==rtgCntObj){let moduleCnt=modCntObj=>void 0!==modCntObj&&void 0!==modCntObj.modRtgCnt?parseInt(modCntObj.modRtgCnt):0;saCnt=moduleCnt(rtgCntObj.sa),paCnt=moduleCnt(rtgCntObj.pa),mrCnt=moduleCnt(rtgCntObj.mr)}if(PMSV2Cycle.IS_FINALSCORE_ENABLED&&(PMSV2Cycle.isSARatingEnabled||PMSV2Cycle.isPARatingEnabled))if(isSelfAppr&&!PMSV2Cycle.isSARatingEnabled)isRefresh=0===paCnt&&saCnt+mrCnt===rfrCnt;else if(isPaAppr&&!PMSV2Cycle.isPARatingEnabled)isRefresh=0===saCnt&&paCnt+mrCnt===rfrCnt;else if(isMultiRater)isRefresh=0===saCnt&&0===paCnt&&mrCnt===rfrCnt;else{let totRtgCnt=PMSV2Cycle.isSARatingEnabled?saCnt:0;isRefresh=(totRtgCnt+=PMSV2Cycle.isPARatingEnabled?paCnt:0)===rfrCnt}else isRefresh=saCnt+paCnt+mrCnt===rfrCnt}return isRefresh},constructRatingSec:function(refresh,isUpdateNorm,isSetTmplValue){let pageId=settingsPage.container,saModRtgCnt=PMSTmpl.getRtgCntWithOutMR("tmplsaQtPmTBody"),paModRtgCnt=PMSTmpl.getRtgCntWithOutMR("tmplpaQtPmTBody");if(PMSV2Cycle.IS_FINALSCORE_ENABLED&&(PMSV2Cycle.isSARatingEnabled&&saModRtgCnt>=1||PMSV2Cycle.isPARatingEnabled&&paModRtgCnt>=1)){PMSTmpl.getRatingWthRangeSec(refresh,isUpdateNorm,isSetTmplValue),pageId.find("#tmplisRatingLockedDiv").show(),0===parseInt(pageId.find("#tmplratingNoOfDigits").val())?pageId.find("#tmplrtRndOffID").parent().parent().hide():pageId.find("#tmplrtRndOffID").parent().parent().show()}else PMSTmpl.getRatingSec(refresh,isSetTmplValue),pageId.find("#tmplisRatingLockedDiv").hide()},getRatingSec:function(refresh,isSetTmplValue){let pageId=settingsPage.container,ul='<ul class="zpl_cyclrg" rttype="default">',chosenRtgType=pageId.find("#tmplratingType").val();if(refresh){let modRtgObj=null!==PMSTmpl.EDIT_TMPL_DETAIL?PMSTmpl.EDIT_TMPL_DETAIL.moduleRatingType:null,selValChk=0;"starRating"===chosenRtgType?selValChk=0:"numberRating"===chosenRtgType?selValChk=1:"textRating"===chosenRtgType?selValChk=2:"customRating"===chosenRtgType&&(selValChk=3),isSetTmplValue&&void 0!==modRtgObj&&null!==modRtgObj&&Object.keys(modRtgObj).length>0&&modRtgObj.type===selValChk?PMSTmpl.parseCycleRatings():(PMSV2Cycle.rating_keyarray=[ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.unsatisfactory")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.needimprovement")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.satisfactory")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.excellent")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.outstanding"))],PMSV2Cycle.rating_idarray=[],PMSV2Cycle.rating_normPerArray=[])}let add=!1,edit=!1,del=!1;if(PMSTmpl.getModWgtRtgCnt().rtgCnt>0){var len=PMSV2Cycle.rating_keyarray.filter(Boolean).length;if("starRating"===chosenRtgType)add=!1,edit=!0,del=!1;else if("numberRating"===chosenRtgType){let mx=parseInt(pageId.find("#tmplMxVl").val());mx===len?(add=!1,edit=!0,del=!1):mx<len?(add=!1,edit=!0,del=!0):mx>len&&(add=!0,edit=!0,del=!1)}else if("textRating"===chosenRtgType){let txtlen=pageId.find("#tmplCstTxtRtgID").find(".zpl_idiv.flex-wrap").children().length;txtlen===len?(add=!1,edit=!0,del=!1):txtlen<len?(add=!1,edit=!0,del=!0):txtlen>len&&(add=!0,edit=!0,del=!1)}else"customRating"===chosenRtgType&&(add=!0,edit=!0,del=!0)}else{(len=PMSV2Cycle.rating_keyarray.filter(Boolean).length)<10&&(add=!0),edit=!0,del=!0}let editOnClick="";edit&&(editOnClick='onclick="PMSTmpl.onEditOpen(this);"'),add&&(ul+='<li id="tmpladdRtgOpt"><a class="zpl_lnkbg" rttype="default" onclick="PMSTmpl.addRatingRow(this);">'+ZPI18N.getString("zp.addrating")+"</a></li>");for(let i=PMSV2Cycle.rating_keyarray.length-1;i>=0;i--){let rtgName=PMSV2Cycle.rating_keyarray[i];ul+='<li  class="zpl_editmode" id="tmplli_'+i+'" rttype="default" series="'+i+'" rating_id="'+(-1!==PMSV2Cycle.rating_idarray.indexOf(i)?PMSV2Cycle.rating_idarray[i]:"")+'"><div class="zpl_cyclrgsr"><span class="'+PMSV2Cycle.rating_keyarray_color[i]+'" rtgNme="'+rtgName+'" '+editOnClick+">"+rtgName+'</span></div><div class="zpl_hvr"><i class="PI_tick grn forEdt DNI" onclick="PMSTmpl.onEditClose(this);"></i><i class="PI_cls red forEdt DNI" onclick="PMSTmpl.closeRatingLi(this);"></i>',del&&(ul+='<i class="PI_delete forDel" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSTmpl.onDeleteRtg(this);"></i>'),ul+="</div></li>"}ul+="</ul>",pageId.find("#tmplrtgDetDiv").html(ul),PMSTmpl.getNormalizationRatingSection()},getRatingWthRangeSec:function(refresh,isUpdateNorm,isSetTmplValue){PMSTmpl.ISRATINGEDITOPEN=!1;let pageId=settingsPage.container,ratingDigits=parseInt(pageId.find("#tmplratingNoOfDigits").val());pageId.find("#tmplrtRndOffID").is(":checked")&&(ratingDigits=0);let chosenRtgType=pageId.find("#tmplratingType").val(),isCstRtgType="customRating"===chosenRtgType;if(refresh){let modRtgObj=null!==PMSTmpl.EDIT_TMPL_DETAIL?PMSTmpl.EDIT_TMPL_DETAIL.moduleRatingType:null,isRangeEnabled=null===PMSTmpl.EDIT_TMPL_DETAIL||PMSTmpl.EDIT_TMPL_DETAIL.cycleRatings.isRatingRangeEnabled,selValChk=0;"starRating"===chosenRtgType?selValChk=0:"numberRating"===chosenRtgType?selValChk=1:"textRating"===chosenRtgType?selValChk=2:"customRating"===chosenRtgType&&(selValChk=3),isSetTmplValue&&void 0!==modRtgObj&&null!==modRtgObj&&Object.keys(modRtgObj).length>0&&modRtgObj.type===selValChk&&PMSTmpl.isDiffRating(PMSTmpl.EDIT_TMPL_DETAIL)&&isRangeEnabled?PMSTmpl.parseCycleRatings():(PMSV2Cycle.rating_idarray=[],PMSV2Cycle.rating_normPerArray=[],PMSV2Cycle.rating_keyarray=[ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.unsatisfactory")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.needimprovement")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.satisfactory")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.excellent")),ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.outstanding"))],PMSV2Cycle.rating_minRangeArray=0===ratingDigits?isCstRtgType?[0,3,5,7,9]:[0,1,2,3,4]:1===ratingDigits?isCstRtgType?[0,2.1,4.1,6.1,8.1]:[0,1.1,2.1,3.1,4.1]:isCstRtgType?[0,2.01,4.01,6.01,8.01]:[0,1.01,2.01,3.01,4.01],PMSV2Cycle.rating_maxRangeArray=isCstRtgType?[2,4,6,8,10]:[1,2,3,4,5])}let add=!1,edit=!1,del=!1;var len=PMSV2Cycle.rating_keyarray.filter(Boolean).length,type=PMSCommon.STAR_RATING;if("starRating"===chosenRtgType)add=!1,edit=!0,del=!1,type=PMSCommon.STAR_RATING;else if("numberRating"===chosenRtgType){pageId.find("#tmplMnVl").val(1).addClass("disabled");let mx=parseInt(pageId.find("#tmplMxVl").val());mx===len?(add=!1,edit=!0,del=!1):mx<len?(add=!1,edit=!0,del=!0):mx>len&&(add=!0,edit=!0,del=!1),type=PMSCommon.NUMBER_RATING,mx}else if("textRating"===chosenRtgType){let txtlen=pageId.find("#tmplCstTxtRtgID").find(".zpl_idiv.flex-wrap").children().length;txtlen===len?(add=!1,edit=!0,del=!1):txtlen<len?(add=!1,edit=!0,del=!0):txtlen>len&&(add=!0,edit=!0,del=!1),type=PMSCommon.TEXT_RATING,PMSV2Cycle.textrating_name.length}else"customRating"===chosenRtgType&&(add=!0,edit=!0,del=!0,type=PMSCommon.CUSTOM_RATING,len);let ul='<ul class="zpl_cyclrg" rttype="range">',editOnClick="";edit&&(editOnClick='onclick="PMSTmpl.onEditOpen(this);"'),add&&(ul+='<li id="tmpladdRtgOpt"><a class="zpl_lnkbg" rttype="range" onclick="PMSTmpl.addRatingRow(this);">'+ZPI18N.getString("zp.addrating")+"</a></li>");for(let i=PMSV2Cycle.rating_keyarray.length-1;i>=0;i--){let rtgName=PMSV2Cycle.rating_keyarray[i],minValT=PMSV2Cycle.rating_minRangeArray.length>0&&void 0!=PMSV2Cycle.rating_minRangeArray[i]?parseFloat(PMSV2Cycle.rating_minRangeArray[i]).toFixed(ratingDigits):parseFloat(0).toFixed(ratingDigits),maxValT=PMSV2Cycle.rating_maxRangeArray.length>0&&void 0!=PMSV2Cycle.rating_maxRangeArray[i]?parseFloat(PMSV2Cycle.rating_maxRangeArray[i]).toFixed(ratingDigits):parseFloat(0).toFixed(ratingDigits);ul+='<li class="zpl_editmode" id="tmplli_'+i+'" rttype="range" series="'+i+'" rating_id="'+(-1!==PMSV2Cycle.rating_idarray.indexOf(i)?PMSV2Cycle.rating_idarray[i]:"")+'"><div class="zpl_cyclrgsr"><span class="'+PMSV2Cycle.rating_keyarray_color[i]+'" rtgNme="'+rtgName+'" '+editOnClick+">"+rtgName+"</span></div>",ul+='<div class="zpl_cyclrgvlu">';var digits=parseInt(ratingDigits);let inpCls="w60";type===PMSCommon.CUSTOM_RATING&&(inpCls="w80",digits=parseInt(ratingDigits)+3),0===ratingDigits&&type!==PMSCommon.CUSTOM_RATING||(ul+='<div id="tmplrtMinSpn_'+i+'" minV="'+minValT+'" '+editOnClick+'><input id="tmplrtMinInp" name="minRangeInp" onkeydown="return PMSTmpl.onNRKeyDown(this,event,\''+digits+'\')" onkeyup="PMSTmpl.validateNewMinrange(this)" type="text" class="'+inpCls+' ztextbox" value="'+minValT+'"></div><em>-</em>'),ul+='<div id="tmplrtMaxSpn_'+i+'" maxV="'+maxValT+'" '+editOnClick+'><input id="tmplrtMaxInp" name="maxRangeInp" onkeydown="return PMSTmpl.onNRKeyDown(this,event,\''+digits+'\')" onkeyup="PMSTmpl.validateNewMaxrange(this)" type="text" class="ztextbox '+inpCls+'" value="'+maxValT+'"></div></div>',ul+='<div class="zpl_hvr"><i class="PI_tick grn forEdt DNI" onclick="PMSTmpl.onEditClose(this);"></i><i class="PI_cls red forEdt DNI" onclick="PMSTmpl.closeRatingLi(this);"></i>',del&&(ul+='<i class="PI_delete forDel" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSTmpl.onDeleteRtg(this);"></i>'),ul+="</div></li>"}ul+="</ul>",pageId.find("#tmplrtgDetDiv").html(ul),(refresh||isUpdateNorm)&&PMSTmpl.getNormalizationRatingSection()},rtgMinMaxFocusOut:function(obj){let pageId=settingsPage.container,chosenRtgType=pageId.find("#tmplratingType").val(),elemId=$(obj).attr("id"),isValidScore=!0;if(pageId.find("#tmplMxVl, #tmplMnVl").removeClass("ztextbox__error"),pageId.find("#tmplNumRtgDiv [elem=errorMsg]").remove(),(isValidScore="tmplMnVl"===elemId?PMSTmpl.validateMinScore(pageId.find("#tmplMnVl"),!0):PMSTmpl.validateMaxScore(pageId.find("#tmplMxVl"),!0))&&"tmplMnVl"!==elemId?isValidScore=PMSTmpl.validateMinScore(pageId.find("#tmplMnVl"),!0):isValidScore&&(isValidScore=PMSTmpl.validateMaxScore(pageId.find("#tmplMxVl"),!0)),!isValidScore)return!1;"customRating"===chosenRtgType&&PMSTmpl.updateRatingRangeValue(),PMSTmpl.constructRatingSec(!1)},updateRatingRangeValue:function(){let pageId=settingsPage.container;PMSV2Cycle.rating_minRangeArray=[],PMSV2Cycle.rating_maxRangeArray=[];let chosenRtgType=pageId.find("#tmplratingType").val(),mn=0,mx=void 0;var allowedratings=mx="textRating"===chosenRtgType?PMSV2Cycle.textrating_name.length:parseInt(pageId.find("#tmplMxVl").val().trim());"customRating"===chosenRtgType&&(allowedratings=mx-(mn=parseInt(pageId.find("#tmplMnVl").val().trim())));var currentNoOfRatings=PMSV2Cycle.rating_keyarray.length,min=mn,max=min+parseFloat((allowedratings/currentNoOfRatings).toFixed(1)),increment=parseFloat((allowedratings/currentNoOfRatings).toFixed(1));let ratingDigits=parseInt(pageId.find("#tmplratingNoOfDigits").val());$("#tmplrtRndOffID").is(":checked")&&(ratingDigits=0);for(let i=0;i<currentNoOfRatings;i++)PMSV2Cycle.rating_minRangeArray.push(min),PMSV2Cycle.rating_maxRangeArray.push(max),0==min||min==parseInt(pageId.find("#tmplMnVl").val().trim())?1===ratingDigits?min=parseFloat((min+increment+.1).toFixed(1)):2===ratingDigits?min=parseFloat((min+increment+.01).toFixed(2)):0===ratingDigits&&(min=parseFloat(min+increment+1)):(min=parseFloat((min+increment).toFixed(parseInt(ratingDigits))),0===ratingDigits&&(min=max+1)),(max=parseFloat((max+increment).toFixed(1)))>parseInt(pageId.find("#tmplMxVl").val().trim())&&(max=parseFloat(parseInt(pageId.find("#tmplMxVl").val().trim())))},getNormalizationRatingSection:function(){let pageId=settingsPage.container,ul='<ul class="zpl_cyclrg">',editData=(null!==PMSTmpl.EDIT_TMPL_DETAIL?PMSTmpl.EDIT_TMPL_DETAIL.cycleRatings.configArr:[]).length>0;for(let i=PMSV2Cycle.rating_keyarray.length-1;i>=0;i--){let v="";editData&&void 0!==PMSV2Cycle.rating_normPerArray[i]&&(v='value="'+PMSV2Cycle.rating_normPerArray[i]+'"'),ul+='<li id="tmplli_'+i+'"><div class="zpl_cyclrgsr"><span class="'+PMSV2Cycle.rating_keyarray_color[i]+'">'+PMSV2Cycle.rating_keyarray[i]+'</span></div><div class="zpl_cyclrgvlu"><div class="ztextbox--group ztextbox--zicon zpl_inpticfild" style="min-width: 100px;"><span class="ztextbox__icon">%</span><input id="tmplnmRtMinInp_'+i+'" type="text" class="ztextbox w100" '+v+' placeholder="0" value="0"></div></div></li>'}pageId.find("#tmplnormRtgDetDiv").html(ul)},onDeleteRtg:function(obj){if(PMSV2Cycle.rating_keyarray.length<=3)return void ZPeople.Message.warning(ZPI18N.getString("zp.minratreq"));let li=$(obj).parents("li"),rtgNme=$(li).find(".zpl_cyclrgsr span").attr("rtgNme"),idx=PMSV2Cycle.rating_keyarray.indexOf(ZSEC.Encoder.encodeForHTML(rtgNme));-1!==idx&&(PMSV2Cycle.rating_keyarray.splice(idx,1),PMSV2Cycle.rating_minRangeArray.splice(-1,1),PMSV2Cycle.rating_maxRangeArray.splice(-1,1)),$(obj).parent().find(".PI_tick").hasClass("DNI")||$(obj).parent().find(".PI_cls").hasClass("DNI")||(PMSTmpl.ISRATINGEDITOPEN=!1),"default"===$(li).attr("rttype")?PMSTmpl.getRatingSec(!1):(PMSTmpl.updateRatingRangeValue(),PMSTmpl.getRatingWthRangeSec(!1,!0))},roundOffAction:function(){var pageId=settingsPage.container;if($("#tmplrtRndOffID").is(":checked")){"customRating"===pageId.find("#tmplratingType").val()&&PMSTmpl.updateRatingRangeValue()}PMSTmpl.constructRatingSec(!1)},addRatingRow:function(obj){let ul=$(obj).parents("ul");if(!PMSTmpl.ISRATINGEDITOPEN){let rtType=$(obj).attr("rttype"),newLi="";var pageId=settingsPage.container;let chosenRtgType=pageId.find("#tmplratingType").val(),ratingDigits=parseInt(pageId.find("#tmplratingNoOfDigits").val()),roundOff=pageId.find("#tmplrtRndOffID").is(":checked");if($(pageId).find("#tmplrtgDetDiv [name=minRangeInp]").attr("disabled",!0),$(pageId).find("#tmplrtgDetDiv [name=maxRangeInp]").attr("disabled",!0),roundOff&&(ratingDigits=0),"default"===rtType)newLi='<li class="zpl_editmode" rttype="default"><div class="zpl_cyclrgsr"><span><input type="text" id="newRtgName" class="ztextbox" placeholder="'+ZPI18N.getString("zp.newrtgph")+'"></span></div><div class="zpl_hvr"><i class="PI_tick grn forEdt" onclick="PMSTmpl.onAddRating(this);"></i><i class="PI_cls red forEdt" onclick="PMSTmpl.onAddRatingClose(this);"></i></div></li>',pageId.find("#tmplisRatingLockedDiv").hide();else{var digits=parseInt(ratingDigits);let inpCls="w60";"customRating"===chosenRtgType&&(inpCls="w80",digits=parseInt(ratingDigits)+3),newLi='<li class="zpl_editmode" rttype="range"><div class="zpl_cyclrgsr"><span><input type="text" id="newRtgName" class="ztextbox" placeholder="'+ZPI18N.getString("zp.newrtgph")+'"></span></div><div class="zpl_cyclrgvlu">',0===ratingDigits&&"customRating"!==chosenRtgType||(newLi+='<div id="tmplrtMinSpn"><input onkeydown="return PMSTmpl.onNRKeyDown(this,event,\''+digits+'\')" id="tmplrtMinInp" name="minRangeInp" type="text" class="ztextbox '+inpCls+'" placeholder="'+ZPI18N.getString("zp.min")+'"></div><em>-</em>'),newLi+='<div id="tmplrtMaxSpn"><input onkeydown="return PMSTmpl.onNRKeyDown(this,event,\''+digits+'\')" id="tmplrtMaxInp" name="maxRangeInp" type="text" class="ztextbox '+inpCls+'" placeholder="'+ZPI18N.getString("zp.max")+'"></div></div><div class="zpl_hvr"><i class="PI_tick grn forEdt" onclick="PMSTmpl.onAddRating(this);"></i><i class="PI_cls red forEdt" onclick="PMSTmpl.onAddRatingClose(this);"></i></div></li>',pageId.find("#tmplisRatingLockedDiv").show()}$(ul).find("#tmpladdRtgOpt").after(newLi),pageId.find("#newRtgName").trigger("focus"),PMSTmpl.ISRATINGEDITOPEN=!0}},onAddRating:function(obj){let showErrorMsg=msg=>{let errobj=pageId.find("#tmplrtgDetDiv").parent();$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+msg+"</span>"),$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"})};(pageId=settingsPage.container).find('[elem="errorMsg"]').remove();let li=$(obj).parents("li"),rtgType=$(li).attr("rttype"),rtgNme=$(li).find(".zpl_cyclrgsr span input").val().trim();if(rtgNme.length<=0)showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.ratingnamemandatory"));else{if("default"===rtgType)PMSV2Cycle.rating_keyarray.push(ZSEC.Encoder.encodeForHTML(rtgNme)),PMSTmpl.getRatingSec(!1);else{var pageId=settingsPage.container;let li=$(obj).parents("li"),ratingDigits=parseInt(pageId.find("#tmplratingNoOfDigits").val());pageId.find("#tmplrtRndOffID").is(":checked")&&(ratingDigits=0);var fixedDigits=0,incVal=0;1===ratingDigits?(fixedDigits=1,incVal=.1):2==ratingDigits&&(fixedDigits=2,incVal=.01);var parent=$(obj).parent().parent(),next=$(obj).parent().parent().next(),allowedMinrange=(parseFloat($(next).find('[name="minRangeInp"]').val())+incVal).toFixed(fixedDigits);let chosenRtgType=pageId.find("#tmplratingType").val();var max=5,min=0;"customRating"===chosenRtgType&&(min=parseInt(pageId.find("#tmplMnVl").val())),"numberRating"===chosenRtgType||"customRating"===chosenRtgType?max=parseInt(pageId.find("#tmplMxVl").val()):"textRating"===chosenRtgType&&(max=pageId.find("#tmplCstTxtRtgID").find(".zpl_idiv.flex-wrap").children().length);var minRange="";void 0!=$(parent).find('[name="minRangeInp"]').val()&&(minRange=$(parent).find('[name="minRangeInp"]').val().trim());var maxRange=$(parent).find('[name="maxRangeInp"]').val().trim();if(("0"!=ratingDigits||"customRating"===chosenRtgType)&&""==minRange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangemandatory"));if(""==maxRange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangemandatory"));if(minRange=parseFloat(minRange),maxRange=parseFloat(maxRange),isNaN(minRange)&&("0"!=ratingDigits||"customRating"===chosenRtgType))return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangenumber"));if(isNaN(maxRange))return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangenumber"));if(min>minRange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[min]));if(minRange>max||maxRange>max)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxminrangelesserthan",[max]));if(("0"!=ratingDigits||"customRating"===chosenRtgType)&&minRange>maxRange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangelesserthanmaxrange"));if("0"==ratingDigits&&"customRating"!==chosenRtgType&&maxRange<=$(next).find('[name="maxRangeInp"]').val())return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[$(next).find('[name="maxRangeInp"]').val()]));if(minRange==maxRange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangecannotbeequalmaxrange"));if(minRange<=allowedMinrange)return void showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[allowedMinrange]));0===parseInt(ratingDigits)&&(incVal=1);let nwMin=$(li).find("#tmplrtMinSpn input").val(),nwMax=$(li).find("#tmplrtMaxSpn input").val();""===rtgNme||""===nwMin&&0!==parseInt(ratingDigits)||""===nwMax||(""==nwMin||isNaN(nwMin)||(PMSV2Cycle.rating_maxRangeArray[PMSV2Cycle.rating_keyarray.length-1]=parseFloat(nwMin-incVal).toFixed(fixedDigits),PMSV2Cycle.rating_minRangeArray.push(parseFloat(nwMin).toFixed(fixedDigits))),PMSV2Cycle.rating_keyarray.push(ZSEC.Encoder.encodeForHTML(rtgNme)),PMSV2Cycle.rating_maxRangeArray.push(parseFloat(nwMax).toFixed(fixedDigits)),PMSTmpl.getRatingWthRangeSec(!1,!0))}PMSTmpl.ISRATINGEDITOPEN=!1}},onAddRatingClose:function(obj){let li=$(obj).parents("li");$(li).remove(),PMSTmpl.ISRATINGEDITOPEN=!1;let pageId=settingsPage.container;$(pageId).find("#tmplrtgDetDiv [name=minRangeInp]").attr("disabled",!1),$(pageId).find("#tmplrtgDetDiv [name=maxRangeInp]").attr("disabled",!1),$(pageId).find("#tmplrtgDetDiv").parent().find("[elem=errorMsg]").remove()},onEditOpen:function(obj){if(!PMSTmpl.ISRATINGEDITOPEN){PMSTmpl.ISRATINGEDITOPEN=!0;let pageId=settingsPage.container,li=$(obj).parents("li"),rtgType=(parseInt(pageId.find("#tmplratingNoOfDigits").val()),$(li).attr("rttype")),rtgNme=$(li).find(".zpl_cyclrgsr span").text();if($(li).find(".zpl_cyclrgsr span").html('<input type="text" class="ztextbox" value="'+ZSEC.Encoder.encodeForHTMLAttribute(rtgNme)+'">'),"range"===rtgType){let series=$(li).attr("series");$(li).find("#tmplrtMinSpn_"+series+" input").removeAttr("name"),$(li).find("#tmplrtMaxSpn_"+series+" input").removeAttr("name"),$(pageId).find("#tmplrtgDetDiv [name=minRangeInp]").attr("disabled",!0),$(pageId).find("#tmplrtgDetDiv [name=maxRangeInp]").attr("disabled",!0),$(li).find("#tmplrtMinSpn_"+series+" input").attr("disabled",!1),$(li).find("#tmplrtMaxSpn_"+series+" input").attr("disabled",!1)}$(li).find(".forEdt").removeClass("DNI"),$(li).find(".zpl_cyclrgsr span").removeAttr("onclick"),"SPAN"==$(obj).prop("nodeName")?$(obj).parent().find("input").focus():$(obj).focus()}},onEditClose:function(obj){let pageId=settingsPage.container,li=$(obj).parents("li"),rtgType=$(li).attr("rttype"),series=$(li).attr("series"),ratingDigits=parseInt(pageId.find("#tmplratingNoOfDigits").val()),oldRtgNme=$(li).find(".zpl_cyclrgsr span").attr("rtgNme"),newRtgNme=$(li).find(".zpl_cyclrgsr span input").val().trim(),roundOff=pageId.find("#tmplrtRndOffID").is(":checked");if(newRtgNme.length<=0)ZPeople.Message.warning(ZPI18N.getString("zp.cycle.errormsg.ratingnamemandatory"));else{roundOff&&(ratingDigits=0);var fixedDigits=0,incVal=1;if(1===ratingDigits)fixedDigits=1,incVal=.1;else if(2==ratingDigits)fixedDigits=2,incVal=.01;var errorFlag=!1;if("range"===rtgType&&((errorFlag=PMSTmpl.validateNewMinrange($(li).find("#tmplrtMinSpn_"+series+" input")))||(errorFlag=PMSTmpl.validateNewMaxrange($(li).find("#tmplrtMaxSpn_"+series+" input")))),!errorFlag){let idx=PMSV2Cycle.rating_keyarray.indexOf(ZSEC.Encoder.encodeForHTML(oldRtgNme));if(-1!==idx&&(newRtgNme!=ZSEC.Encoder.encodeForHTML(oldRtgNme)&&(PMSV2Cycle.rating_keyarray[idx]=ZSEC.Encoder.encodeForHTML(newRtgNme),$(li).find(".zpl_cyclrgsr span").attr("rtgNme",ZSEC.Encoder.encodeForHTML(newRtgNme))),$(li).find(".zpl_cyclrgsr span").attr("rtgNme",newRtgNme),"range"===rtgType)){let oldMin=$(li).find("#tmplrtMinSpn_"+series).attr("minv"),oldMax=$(li).find("#tmplrtMaxSpn_"+series).attr("maxv"),nwMin=$(li).find("#tmplrtMinSpn_"+series+" input").val(),nwMax=$(li).find("#tmplrtMaxSpn_"+series+" input").val();nwMin!=oldMin&&(PMSV2Cycle.rating_minRangeArray[idx]=parseFloat(nwMin).toFixed(fixedDigits),PMSV2Cycle.rating_maxRangeArray[idx-1]=parseFloat(nwMin-incVal).toFixed(fixedDigits)),nwMax!=oldMax&&(PMSV2Cycle.rating_maxRangeArray[idx]=parseFloat(nwMax).toFixed(fixedDigits),idx<PMSV2Cycle.rating_maxRangeArray.length-1&&(PMSV2Cycle.rating_minRangeArray[idx+1]=(parseFloat(nwMax)+parseFloat(incVal)).toFixed(fixedDigits)))}PMSTmpl.ISRATINGEDITOPEN=!1,"range"===rtgType?PMSTmpl.getRatingWthRangeSec(!1,!0):PMSTmpl.getRatingSec(!1,!0,!0,!0)}}},onNRKeyDown:function(val,evt,mode,extramode){var charCode=evt.which?evt.which:evt.keyCode;if(8===charCode||9===charCode||37===charCode||39===charCode)return!0;var value=val.value,splitArr=value.split(".");return!(value.length>2&&"2"!=mode&&"3"!=mode&&"4"!=mode&&"5"!=mode)&&((!(value.length>3)||"2"!=mode&&"3"!=mode)&&(!(value.length>1&&"0"==mode)&&(!(value.length>4&&"4"==mode)&&(!(value.length>5&&"5"==mode)&&((!(splitArr.length>1)||"0"!=mode&&"3"!=mode)&&((!(splitArr.length>1&&splitArr[1].length>0)||"1"!=mode&&"4"!=mode)&&((!(splitArr.length>1&&splitArr[1].length>1)||"2"!=mode&&"5"!=mode)&&(46==charCode||190==charCode||110==charCode?-1===value.indexOf("."):!(charCode>31&&(charCode<48||charCode>57&&charCode<96||charCode>105))&&!(splitArr.length>1&&splitArr[1].length>0&&splitArr[0].length>0&&"2"!=mode&&"3"!=mode&&"4"!=mode&&"5"!=mode)))))))))},onRatingScoreMaxMinKeyDown:function(val,evt){let mode="3";return"numberRating"===settingsPage.container.find("#tmplratingType").val()&&(mode="0"),PMSTmpl.onNRKeyDown(val,evt,mode)},validateMinScore:function(obj,isShowMsg){let showErrorMsg=msg=>{let errobj=$(obj).parent().parent();$(obj).addClass("ztextbox__error"),$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+msg+"</span>"),$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"})};var pageId=settingsPage.container,minScore=$(obj).val().trim();isShowMsg&&($(obj).removeClass("ztextbox__error"),$(obj).parent().parent().find("[elem=errorMsg]").remove());let ratingDigits=parseInt(pageId.find("#tmplratingNoOfDigits").val()),roundOff=pageId.find("#tmplrtRndOffID").is(":checked"),chosenRtgType=pageId.find("#tmplratingType").val();return roundOff&&(ratingDigits="0"),""==minScore?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangemandatory")),!1):(minScore=Number(minScore),isNaN(minScore)?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangenumber")),!1):Number.isInteger(minScore)?minScore<0?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangenotnegative")),!1):minScore>=parseInt($("#tmplMxVl").val())?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangelesserthan",[$("#tmplMxVl").val()])),!1):!("0"==ratingDigits&&"customRating"===chosenRtgType&&Number($("#tmplMxVl").val())-minScore<PMSV2Cycle.rating_keyarray.length)||(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minandmaxrangediffgreaterthan",[PMSV2Cycle.rating_keyarray.length])),!1):(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minrangenotdecimal")),!1))},validateMaxScore:function(obj,isShowMsg){let showErrorMsg=msg=>{let errobj=$(obj).parent().parent();$(obj).addClass("ztextbox__error"),$(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+msg+"</span>"),$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"})};var pageId=settingsPage.container,maxScore=$(obj).val().trim();isShowMsg&&($(obj).removeClass("ztextbox__error"),$(obj).parent().parent().find("[elem=errorMsg]").remove());let ratingDigits=parseInt(pageId.find("#tmplratingNoOfDigits").val()),roundOff=pageId.find("#tmplrtRndOffID").is(":checked"),chosenRtgType=pageId.find("#tmplratingType").val(),maxValueAllowed=10;return"customRating"===chosenRtgType&&(maxValueAllowed=1e3),roundOff&&(ratingDigits="0"),""==maxScore?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangemandatory")),!1):(maxScore=Number(maxScore),isNaN(maxScore)?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangenumber")),!1):Number.isInteger(maxScore)?maxScore<=parseInt($("#tmplMnVl").val())?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangegreaterthan",[$("#tmplMnVl").val()])),!1):"numberRating"===chosenRtgType&&maxScore<=2?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangegreaterthan",[2])),!1):maxScore>maxValueAllowed?(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangelesserthan",[maxValueAllowed])),!1):!("0"==ratingDigits&&"customRating"===chosenRtgType&&maxScore-Number($("#tmplMnVl").val())<PMSV2Cycle.rating_keyarray.length)||(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.minandmaxrangediffgreaterthan",[PMSV2Cycle.rating_keyarray.length])),!1):(isShowMsg&&showErrorMsg(ZPI18N.getString("zp.cycle.errormsg.maxrangenotdecimal")),!1))},validateNewMinrange:function(obj){var errorFlag=!1,errMsg="";let pageId=settingsPage.container;if(pageId.find('[elem="errorMsg"]').remove(),void 0===$(obj).val())return;var minValue=$(obj).val().trim(),maxValue=""!=$(obj).parent().parent().find("#tmplrtMaxInp").val()?$(obj).parent().parent().find("#tmplrtMaxInp").val().trim():"";let ratingDigits=parseInt(pageId.find("#tmplratingNoOfDigits").val()),roundOff=pageId.find("#tmplrtRndOffID").is(":checked"),chosenRtgType=pageId.find("#tmplratingType").val();roundOff&&(ratingDigits=0);var fixedDigits=0,incVal=1;if(1===ratingDigits)fixedDigits=1,incVal=.1;else if(2==ratingDigits)fixedDigits=2,incVal=.01;var checkMin=!1;0==ratingDigits&&"customRating"!==chosenRtgType||(checkMin=!0);var child=$(obj).parent().parent().parent().next();checkMin&&""==minValue&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangemandatory")),minValue=parseFloat(minValue),checkMin&&isNaN(minValue)&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangenumber"));var series=$(child).attr("series"),nextRowMin=""!=$(child).find("#tmplrtMinSpn_"+series+" input").val()?$(child).find("#tmplrtMinSpn_"+series+" input").val():"";if(!errorFlag&&0!=ratingDigits&&minValue<=(parseFloat(nextRowMin)+parseFloat(incVal)).toFixed(fixedDigits)?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[(parseFloat(nextRowMin)+parseFloat(incVal)).toFixed(fixedDigits)])):!errorFlag&&0==ratingDigits&&"customRating"===chosenRtgType&&minValue<=parseFloat(nextRowMin).toFixed(fixedDigits)?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthan",[parseFloat(nextRowMin).toFixed(fixedDigits)])):!errorFlag&&checkMin&&""==nextRowMin&&minValue<0?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthanorequal",[0])):!errorFlag&&"customRating"===chosenRtgType&&""==nextRowMin&&minValue<parseInt(pageId.find("#tmplMnVl").val())?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangegreaterthanorequal",[pageId.find("#tmplMnVl").val()])):!errorFlag&&checkMin&&""!=maxValue&&minValue>=maxValue&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.minrangelesserthan",[maxValue])),errorFlag){let errobj=pageId.find("#tmplrtgDetDiv").parent();return $(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>"),$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"}),$(obj).parent().parent().parent().find(".PI_tick").css("opacity","0.4"),$(obj).parent().parent().parent().find(".PI_tick").css("cursor","not-allowed"),$(obj).parent().parent().parent().find(".PI_tick").removeAttr("onclick"),errorFlag}return $(obj).parent().parent().parent().find(".PI_tick").css("opacity",""),$(obj).parent().parent().parent().find(".PI_tick").css("cursor",""),$(obj).parent().parent().parent().find(".PI_tick").attr("onclick","PMSTmpl.onEditClose(this);"),errorFlag},validateNewMaxrange:function(obj){var errorFlag=!1,errMsg="";let pageId=settingsPage.container;pageId.find('[elem="errorMsg"]').remove();var maxValue=$(obj).val().trim(),minValue=0;void 0!==$(obj).parent().parent().find("#tmplrtMinInp").val()&&(minValue=$(obj).parent().parent().find("#tmplrtMinInp").val().trim());let ratingDigits=parseInt(pageId.find("#tmplratingNoOfDigits").val()),roundOff=pageId.find("#tmplrtRndOffID").is(":checked"),chosenRtgType=pageId.find("#tmplratingType").val();var max=5;"numberRating"===chosenRtgType||"customRating"===chosenRtgType?max=pageId.find("#tmplMxVl").val():"textRating"===chosenRtgType&&(max=pageId.find("#tmplCstTxtRtgID").find(".zpl_idiv.flex-wrap").children().length),roundOff&&(ratingDigits=0);var fixedDigits=0,incVal=0;1===ratingDigits?(fixedDigits=1,incVal=.1):2==ratingDigits&&(fixedDigits=2,incVal=.01);var parent=$(obj).parent().parent().parent().prev(),child=$(obj).parent().parent().parent().next();""==(maxValue=parseFloat(maxValue))&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangemandatory")),isNaN(maxValue)&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangenumber"));var series=$(parent).attr("series"),parentMax=""!=$(parent).find("#tmplrtMaxSpn_"+series+" input").val()?$(parent).find("#tmplrtMaxSpn_"+series+" input").val():"",chseries=$(child).attr("series");if(!errorFlag&&""!=parentMax&&void 0!=parentMax&&maxValue>=(parseFloat(parentMax)-parseFloat(incVal)).toFixed(fixedDigits)?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangelesserthan",[(parseFloat(parentMax)-parseFloat(incVal)).toFixed(fixedDigits)])):!errorFlag&&(""==parentMax||void 0==parentMax)&&maxValue>max?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangelesserthanorequal",[max])):!errorFlag&&("0"!=ratingDigits||"customRating"===chosenRtgType)&&maxValue<=minValue?(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangegreaterthan",[minValue])):!errorFlag&&"0"==ratingDigits&&maxValue<=$(child).find("#tmplrtMaxSpn_"+chseries+" input").val()&&(errorFlag=!0,errMsg=ZPI18N.getString("zp.cycle.errormsg.maxrangegreaterthan",[$(child).find("#tmplrtMaxSpn_"+chseries+" input").val()])),errorFlag){let errobj=pageId.find("#tmplrtgDetDiv").parent();return $(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>"),$(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"}),$(obj).parent().parent().parent().find(".PI_tick").css("opacity","0.4"),$(obj).parent().parent().parent().find(".PI_tick").css("cursor","not-allowed"),$(obj).parent().parent().parent().find(".PI_tick").removeAttr("onclick"),errorFlag}return $(obj).parent().parent().parent().find(".PI_tick").css("opacity",""),$(obj).parent().parent().parent().find(".PI_tick").css("cursor",""),$(obj).parent().parent().parent().find(".PI_tick").attr("onclick","PMSTmpl.onEditClose(this);"),errorFlag},closeRatingLi:function(obj){let li=$(obj).parents("li"),series=$(li).attr("series"),rtgNme=$(li).find(".zpl_cyclrgsr span").attr("rtgNme"),min=$(li).find("#tmplrtMinSpn_"+series).attr("minV"),max=$(li).find("#tmplrtMaxSpn_"+series).attr("maxV"),pageId=settingsPage.container;pageId.find('[elem="errorMsg"]').remove(),PMSTmpl.ISRATINGEDITOPEN=!1,$(li).find(".zpl_cyclrgsr span").html(ZSEC.Encoder.encodeForHTML(rtgNme)),$(li).find("#tmplrtMinSpn_"+series+" input").val(min),$(li).find("#tmplrtMaxSpn_"+series+" input").val(max),$(li).find("#tmplrtMinSpn_"+series+" input").attr("name","minRangeInp"),$(li).find("#tmplrtMaxSpn_"+series+" input").attr("name","maxRangeInp"),$(pageId).find("#tmplrtgDetDiv [name=minRangeInp]").attr("disabled",!1),$(pageId).find("#tmplrtgDetDiv [name=maxRangeInp]").attr("disabled",!1),$(li).find(".forEdt").addClass("DNI"),$(li).find(".zpl_cyclrgsr span").attr("onclick","PMSTmpl.onEditOpen(this)"),$(li).find("#tmplrtMinSpn_"+series).attr("onclick","PMSTmpl.onEditOpen(this)"),$(li).find("#tmplrtMaxSpn_"+series).attr("onclick","PMSTmpl.onEditOpen(this)"),$(li).find(".PI_tick").css("opacity",""),$(li).find(".PI_tick").css("cursor",""),$(li).find(".PI_tick").attr("onclick","PMSTmpl.onEditClose(this);")},onHikeBasedAction:function(eData){if(!eData||""!==eData.selectedValue&&eData.previousValue!=eData.selectedValue){var pageId=settingsPage.container;"0"===eData.selectedValue?pageId.find("[fld=hide]").hide():pageId.find("[fld=hide]").show()}},hasAnyChangeInRule:function(){var container=settingsPage.container;if(PMSV2Cycle.CUR_HIKE_RULE==PMSCommon.HIKE_DESIGNATION)for(var desRuleObj=container.find("#desRuleObj"),length=desRuleObj.find("tbody").length,i=1;i<length;i++){if(""!=(rules=desRuleObj.find("#rules_"+i)).find("#budgetDes_"+i).val()||""!=rules.find("#ruleHike_"+i).val())return!0}else{var expRuleObj=container.find("#expRuleObj");for(length=expRuleObj.find("tbody").length,i=1;i<length;i++){var rules;if("-1"!=(rules=expRuleObj.find("#rules_"+i)).find("#expOpt_"+i).val()||""!=rules.find("#expFrom_"+i).val()||""!=rules.find("#expTo_"+i).val()||""!=rules.find("#ruleHike_"+i).val())return!0}}return!1},showError:function(errMsg,obj){$(obj).addClass("ztextbox__error"),0==$(obj).parent().find('[elem="errorMsg"]').length?$(obj).parent().append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>"):$(obj).parent().find('[elem="errorMsg"]').text(errMsg),$(obj)[0].scrollIntoView({behavior:"smooth",block:"center"})},removeError:function(){let pageId=settingsPage.container;pageId.find(".ztextbox__error").removeClass("ztextbox__error"),pageId.find('[elem="errorMsg"]').remove()},changeOnUpload:function(filename,mode,id,obj){var localFileInpBx=$('<div><input type="file"></div>');localFileInpBx.find("input").trigger("click"),localFileInpBx.find("input").off("change").on("change",function(event){var file=$(this)[0].files[0];PMSTmpl.FILE=file;var fileName=ZPeople.escapeHtml(file.name),fileSize=file.size;if(fileName=fileName.replace("C:\\fakepath\\",""),fileSize>1e6*maxFileSize.split("MB")[0])ZPeopleComponents.AlertBanner.show({message:ZPI18N.getString("zp.filesizelimit",[maxFileSize]),type:"error",closeButton:!0,hideDelay:2e3});else{var fileExtn=fileName.substring(fileName.lastIndexOf(".")+1,fileName.length),attachFileHtml=PMSTmpl.getAttachFileHtml(fileName,fileExtn,"tmpl");$("#beforeUpload").css("display","none"),$("#afterUpload").parent().css("display","block"),$("#afterUpload").append(attachFileHtml),$("#afterUpload").find("#currentFile").find(".zpl_prgbr").removeClass("DN"),progressJs("div[data-progressjs='fileUpload_Progress']").autoIncrease(8,10);var progressDiv=$("#afterUpload").find("div[data-progressjs='fileUpload_Progress']");progressJs("div[data-progressjs='fileUpload_Progress']").end(),progressDiv[0].style.width="100%"}})},getAttachFileHtml:function(fileName,fileType,mode){return'<div class="zpl_atchd"><div id="currentFile"><div class="zpl_atchimg"><i class="'+FilesCommon.getFileIcon(fileType)+'"></i></div><div class="zpl_atchdtl"><h4 id="attachedFileName">'+fileName+'</h4></div><div class="zpl_atchicn"><i class="PI_delete" title="'+ZPI18N.getString("zp.delete")+'" onclick="PMSTmpl.removeFile(\''+mode+'\')"></i></div><div class="zpl_prgbr DN"><div><div data-progressjs="fileUpload_Progress" style="width:0%"></div></div></div></div></div>'},removeFile:function(mode){"tmpl"==mode?(PMSTmpl.FILE=null,PMSV2Cycle.SEFLAPPRAISALFILEREMOVED=!0,$("#afterUpload").html(""),$("#afterUpload").parent().css("display","none"),$("#beforeUpload").css("display","block")):"cycleguide"==mode?(PMSV2Cycle.GUIDE_FILE=null,PMSV2Cycle.GUIDELINEDOCREMOVED=!0,null!=PMSV2Cycle.GUIDELINESFILEID&&(PMSV2Cycle.GUIDELINESFILEID=null),$("#guidelinesId_afterUpload").html(""),$("#guidelinesId_afterUpload").parent().css("display","none"),$("#guidelinesId_beforeUpload").css("display","block")):"cycleself"==mode&&(PMSV2Cycle.SELF_FILE=null,PMSV2Cycle.SEFLAPPRAISALFILEREMOVED=!0,null!=PMSV2Cycle.SELFAPPFORMFILEID&&(PMSV2Cycle.SELFAPPFORMFILEID=null),$("#selfappFormid_afterUpload").html(""),$("#selfappFormid_afterUpload").parent().css("display","none"),$("#selfappFormid_beforeUpload").css("display","block"))},toggleFileFieldDisplay:function(id){var pageId=settingsPage.container;PMSV2Cycle.SEFLAPPRAISALFILEREMOVED=!1,pageId.find("#"+id).find("#beforeUpload,#afterUpload").toggleClass("DN"),pageId.find("#"+id).find(".ZPFfile").html(""),pageId.find("#"+id).find(".ZPFfile").html('<input type="file" class="form-control" onchange="PMSTmpl.changeOnUpload($(this).val(),\'localUpload\',\''+id+"',this)\" id='selfappForm'>"),PMSV2Cycle.SEFLAPPRAISALFILEREMOVED=!0},toggleSelfUploadInput:function(){const pageId=settingsPage.container,uploadInput=pageId.find("#tempselffileupload"),selfdocuploadsec=pageId.find("#selfdocuploadsec");uploadInput.is(":checked")?selfdocuploadsec.removeClass("DN"):(selfdocuploadsec.addClass("DN"),PMSTmpl.removeFile("tmpl"))},basicDetValidation:function(){const pageId=settingsPage.container;let isValid=!0;return[{id:"#tmplcTmplNameID",name:ZPI18N.getString("zp.templatename")},{id:"#popTmplNme",name:ZPI18N.getString("zp.templatename")},{id:"#popTmplDesc",name:ZPI18N.getString("zp.template ")+ZPI18N.getString("zp.description")},{id:"#tmplcTmplDescID",name:ZPI18N.getString("zp.template ")+ZPI18N.getString("zp.description")}].forEach(input=>{const elem=pageId.find(input.id);if(elem.length>0){const val=elem.val().trim();if(val||"#tmplcTmplNameID"!==input.id&&"#popTmplNme"!==input.id||(isValid=!1,PMSTmpl.showError(ZPI18N.getString("zp.tmplnameerr"),elem)),val.length>250&&("#tmplcTmplNameID"===input.id||"#popTmplNme"===input.id)&&(isValid=!1,PMSTmpl.showError(ZPI18N.getString("zp.fieldpropertymaxlength",[input.name,"250 characters"]),elem)),("#tmplcTmplNameID"===input.id||"#popTmplNme"===input.id)&&void 0!==PMSSetting.LOAD_TMPL_DATA.data&&PMSSetting.LOAD_TMPL_DATA.data.length>0){let isValidName=!1;$.each(PMSSetting.LOAD_TMPL_DATA.data,function(index,tmpObj){void 0!=tmpObj&&void 0!=tmpObj.cycleName&&tmpObj.rawCycleName===val&&(null===PMSTmpl.EDIT_TMPL_DETAIL||null!==PMSTmpl.EDIT_TMPL_DETAIL&&PMSTmpl.EDIT_TMPL_DETAIL.configId!==tmpObj.configID)&&(isValidName=!0)}),isValidName&&(isValid=!1,PMSTmpl.showError(ZPI18N.getString("zp.duplicateSkill",[ZPI18N.getString("zp.templatename")]),elem))}val.length>5e3&&("#popTmplDesc"===input.id||"#tmplcTmplDescID"===input.id)&&(isValid=!1,PMSTmpl.showError(ZPI18N.getString("zp.fieldpropertymaxlength",[input.name,"5000 characters"]),elem))}}),isValid},mrValidation:function(){let pageId=settingsPage.container,isValid=!0;if(ZPeopleComponents.toggleswitch(pageId.find("#tmplmrAutoPopulate")).getState()&&("-1"===pageId.find("#tmplmrTypeSelID").val()&&void 0!=PMSV2Cycle.mrTypeData&&PMSV2Cycle.mrTypeData.isMrtypeComEnabled&&PMSV2Cycle.mrTypeData.isMrtypeMandatary)){isValid=!1;let errMsg=ZPI18N.getString("zp.selectmrtype",[PMSTmpl.MR_NAME]),obj=pageId.find("#tmplmrTypeSelID").parent();$(obj).parent().append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>"),$(obj)[0].scrollIntoView({behavior:"smooth",block:"center"})}if(1===parseInt(pageId.find("[name=mrSelRdBx]:checked").val())&&(""==PMSV2Cycle.isMR_apprConf||!PMSV2Cycle.isMR_apprConf)){isValid=!1;let obj=pageId.find("[tit=mrapprconfig]");$(obj).parent().append('<span elem="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.mrapprerrmsg")+"</span>"),$(obj)[0].scrollIntoView({behavior:"smooth",block:"center"})}let errMsg="",mnHghBox="",mxHghBox="",mnTmp=pageId.find("#tmplminrater").val().trim(),mxTmp=pageId.find("#tmplmaxrater").val().trim();if(""===mnTmp||""===mxTmp)""===mnTmp&&(mnHghBox=!0),""===mxTmp&&(mxHghBox=!0),errMsg=ZPI18N.getString("zp.mrcounterror1"),isValid=!1;else{let min=parseInt(mnTmp),max=parseInt(mxTmp);isNaN(min)||isNaN(max)?(errMsg=ZPI18N.getString("zp.fieldupdate.numbererror"),isValid=!1):min<=0||max<=0?(errMsg=ZPI18N.getString("zp.mrcounterror1"),isValid=!1,mnHghBox=!0,mxHghBox=!0):min>=max?(errMsg=ZPI18N.getString("zp.mrcounterror2"),isValid=!1,mnHghBox=!0):max>120&&(errMsg=ZPI18N.getString("zp.mrcounterror3"),isValid=!1,mxHghBox=!0)}if(errMsg.length>0){let obj=pageId.find("#tmplminrater").parent();mnHghBox&&pageId.find("#tmplminrater").addClass("ztextbox__error"),mxHghBox&&pageId.find("#tmplmaxrater").addClass("ztextbox__error"),$(obj).after('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>"),$(obj)[0].scrollIntoView({behavior:"smooth",block:"center"})}return isValid},validateRatingRange:function(){let isValidRtgRng=!0;return settingsPage.container.find("#tmplrtgDetDiv ul").children().each(function(index,curRow){let curMin=$(curRow).find("#tmplrtMinInp").val();if(parseInt($(curRow).attr("series"))>0){let pervRow=$(curRow).next();$(pervRow).find("#tmplrtMaxInp").val()>curMin&&(isValidRtgRng=!1)}}),isValidRtgRng},rtgValidation:function(){let pageId=settingsPage.container,isValid=!0;if(!("display: none;"===pageId.find("#tmplmodWgtDiv").attr("style"))&&ZPeopleComponents.toggleswitch("#tmplsetModWgtID").getState()){let validateModuleWeightage=compId=>{let isValidWeight=!0;if(void 0!==pageId.find("#tmplmodWgtSecDiv #"+compId)[0]&&!pageId.find("#tmplmodWgtSecDiv #"+compId).hasClass("disabled")){let value=pageId.find("#tmplmodWgtSecDiv #"+compId).val();(null===value||isNaN(value)||parseInt(value)<0||parseInt(value)>100)&&(isValidWeight=!1)}return isValidWeight};var actModuleObj=PMSSetting.SEL_ENABLED_MODULES,kraObj=actModuleObj.KRA,goalObj=actModuleObj.GOALS,kgObj=actModuleObj.KRA_GOALS,comptObj=actModuleObj.COMPETENCY;let modWgtTBody=pageId.find("#tmplmodWgtTBody"),moduleIds=[{id:"tmplkgMWgtID",name:kgObj.displayName},{id:"tmplkraMWgtID",name:kraObj.displayName},{id:"tmplgoalMWgtID",name:goalObj.displayName},{id:"tmplcompMWgtID",name:comptObj.displayName}];if(moduleIds.some(({id:id})=>{let value=pageId.find("#tmplmodWgtSecDiv #"+id).val();return null!==value&&!isNaN(value)&&parseInt(value)>0})){for(const{id:id,name:name}of moduleIds)if(!validateModuleWeightage(id)){PMSV2Cycle.showError(ZPI18N.getString("zp.pleaseenterweightage",[name]),$(modWgtTBody).parent(),2),isValid=!1;break}}else PMSV2Cycle.showError(ZPI18N.getString("zp.atleastonemoduleweightage"),$(modWgtTBody).parent(),2),isValid=!1;if(isValid){let trChd=$(modWgtTBody).children(),k=0,g=0,c=0,kg=0;$.each(trChd,function(key,val){let inp=$(this).find("input"),cNm=$(inp).attr("compNme"),value=$(inp).val().trim();"KRA"===cNm?!isNaN(value)&&value.length>0&&(k=parseFloat(value)):"GOALS"===cNm?!isNaN(value)&&value.length>0&&(g=parseFloat(value)):"KRA_GOALS"===cNm?!isNaN(value)&&value.length>0&&(kg=parseFloat(value)):"COMPETENCY"===cNm&&!isNaN(value)&&value.length>0&&(c=parseFloat(value))}),100!==k+g+kg+c&&(isValid=!1,PMSV2Cycle.showError(ZPI18N.getString("zp.setweightageerr"),$(modWgtTBody).parent(),2))}}let errMsg1="";if(PMSTmpl.getModWgtRtgCnt().rtgCnt>0){let isValidScore=!0,chosenRtgType=pageId.find("#tmplratingType").val();if(pageId.find("#tmplMxVl, #tmplMnVl").removeClass("ztextbox__error"),pageId.find("#tmplNumRtgDiv [elem=errorMsg], #tmplCstTxtRtgID [elem=errorMsg]").remove(),"numberRating"===chosenRtgType?isValidScore=PMSTmpl.validateMaxScore(pageId.find("#tmplMxVl"),!0):"customRating"===chosenRtgType?(isValidScore=PMSTmpl.validateMinScore(pageId.find("#tmplMnVl"),!0))&&(isValidScore=PMSTmpl.validateMaxScore(pageId.find("#tmplMxVl"),!0)):"textRating"===chosenRtgType&&(isValidScore=PMSTmpl.validateTextRatingName()),isValid=!1===isValidScore?isValidScore:isValid,PMSV2Cycle.rating_keyarray.length>=1){PMSTmpl.getRtgCntWithOutMR("tmplsaQtPmTBody"),PMSTmpl.getRtgCntWithOutMR("tmplpaQtPmTBody");let validateRatingRange=(orgRtgCnt,maxRtgRange)=>"range"===pageId.find("#tmplrtgDetDiv ul").attr("rttype")&&Number(PMSV2Cycle.rating_maxRangeArray[orgRtgCnt-1])!==maxRtgRange,chosenRtgType=pageId.find("#tmplratingType").val();if("numberRating"===chosenRtgType){var origCnt=PMSV2Cycle.rating_keyarray.length;let max=parseInt(pageId.find("#tmplMxVl").val().trim());if(""==max||isNaN(max))errMsg1=ZPI18N.getString("zp.cycle.errormsg.maxrangemandatory");else if(origCnt!==max)(arr=[]).push(max),errMsg1=ZPI18N.getString("zp.addratingerror",new Array(arr.toString()));else validateRatingRange(origCnt,max)&&(errMsg1=ZPI18N.getString("zp.cycle.errormsg.maxrangeequalto",new Array(max.toString())))}else if("textRating"===chosenRtgType){origCnt=PMSV2Cycle.rating_keyarray.length;var arr,max=PMSV2Cycle.textrating_name.length;if(origCnt!==max)(arr=[]).push(max),errMsg1=ZPI18N.getString("zp.addratingerror",new Array(arr.toString()));else validateRatingRange(origCnt,max)&&(errMsg1=ZPI18N.getString("zp.cycle.errormsg.maxrangeequalto",new Array(max.toString())))}else if("customRating"===chosenRtgType){origCnt=PMSV2Cycle.rating_keyarray.length;var maxScore=$("#tmplMxVl").val(),minScore=$("#tmplMnVl").val();if(""==minScore||""==maxScore||isNaN(minScore)||isNaN(maxScore))errMsg1=ZPI18N.getString("zp.cycle.errormsg.minormaxrangemandatory");else{maxScore=Number(maxScore),minScore=Number(minScore);var origScore=Number(PMSV2Cycle.rating_maxRangeArray[origCnt-1]);maxScore<origScore&&(errMsg1=ZPI18N.getString("zp.addscoreerror",new Array(maxScore.toString()))),minScore>(origScore=Number(PMSV2Cycle.rating_minRangeArray[0]))&&(errMsg1=ZPI18N.getString("zp.addminscoreerror",new Array(minScore.toString()))),""===errMsg1&&validateRatingRange(origCnt,maxScore)&&(errMsg1=ZPI18N.getString("zp.cycle.errormsg.maxrangeequalto",new Array(maxScore.toString())))}}else if("starRating"===chosenRtgType){let maxScore=5;validateRatingRange(5,maxScore)&&(errMsg1=ZPI18N.getString("zp.cycle.errormsg.maxrangeequalto",new Array(maxScore.toString())))}}else errMsg1=ZPI18N.getString("zp.minratreq");errMsg1.length>0&&(isValid=!1,PMSV2Cycle.showError(errMsg1,pageId.find("#tmplrtgDetDiv"),1)),PMSTmpl.validateRatingRange()||(isValid=!1,PMSV2Cycle.showError(ZPI18N.getString("zp.cycle.errormsg.validmaxminrange"),pageId.find("#tmplrtgDetDiv"),1))}if(!pageId.find("#tmplcmtLenDiv").hasClass("DN")){let errCmtMsg="",minCmtVal=pageId.find("#tmplcmtLenInp").val();if(""!==minCmtVal){var minCmtLen=Number(minCmtVal);isNaN(minCmtLen)?errCmtMsg=ZPI18N.getString("zp.fieldupdate.numbererror"):minCmtLen<=0?errCmtMsg=ZPI18N.getString("zp.cycle.errormsg.mincmtlengthgreaterthan",[0]):minCmtLen>1e3&&(errCmtMsg=ZPI18N.getString("zp.cycle.errormsg.mincmtlengthlesserthan",[1e3])),errCmtMsg.length>0&&(isValid=!1,PMSV2Cycle.showError(errCmtMsg,pageId.find("#tmplcmtLenInp"),2))}}return isValid},normalizationValidation:function(){let pageId=settingsPage.container,isValid=!0,errMsg="";var totalNomalizPer=0;let chkTotPerFlg=!0;if(PMSV2Cycle.rating_keyarray.length>=1){pageId.find("#tmplrtgDetDiv ul").attr("rttype");pageId.find("#tmplrtgDetDiv ul").find("li[id^=tmplli_]").each(function(){var series=parseInt($(this).attr("series")),ratingPer=pageId.find("#tmplnormRtgDetDiv ul li").find("#tmplnmRtMinInp_"+series).val();void 0!=ratingPer&&""!=ratingPer?totalNomalizPer+=parseFloat(ratingPer):(errMsg=ZPI18N.getString("zp.ratingDistributionerr"),chkTotPerFlg=!1)})}if(chkTotPerFlg&&(totalNomalizPer>100||totalNomalizPer<100)&&(errMsg=ZPI18N.getString("zp.setRatingdisterr")),errMsg.length>0){isValid=!1;let obj=pageId.find("#tmplnormRtgDetDiv").parent();$(obj).append('<span elem="errorMsg" class="ztextbox--error__label">'+errMsg+"</span>"),$(obj)[0].scrollIntoView({behavior:"smooth",block:"center"})}return isValid},hikeValidation:function(){let pageId=settingsPage.container,isValid=!0;if(pageId.find("#tmplhikeTglBtnFstCrtDiv").hasClass("zpl_act"))if(1===PMSSetting.SEL_ENABLED_MODULES.SALARY.enable||void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationEnabled&&PMSV2Cycle.compensationData.isCompensationEnabled){var hikeDeciderID=pageId.find("#tmplhkApprSel").val();if(void 0===hikeDeciderID||"-1"===hikeDeciderID){isValid=!1;let obj=pageId.find("#tmplhkApprSel").parent();$(obj).parent().append('<span elem="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.selecthikedecider",[PMSTmpl.HIKE_NAME])+"</span>"),$(obj)[0].scrollIntoView({behavior:"smooth",block:"center"})}if(pageId.find("#tmplhkApproval").is(":checked")&&(""==PMSV2Cycle.isBudget_apprConf||!PMSV2Cycle.isBudget_apprConf)){isValid=!1;let obj=pageId.find("#tmplhkApprConf");$(obj).append('<span elem="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.configureapprovalforform",new Array(ZPeople.escapeHtml(PMSV2Cycle.teamBudgetFormName)))+"</span>"),$(obj)[0].scrollIntoView({behavior:"smooth",block:"center"})}}else isValid=!1,void 0!=PMSV2Cycle.compensationData&&void 0!=PMSV2Cycle.compensationData.isCompensationDataSource&&PMSV2Cycle.compensationData.isCompensationDataSource?ZPeople.Message.failure(ZPI18N.getString("zp.performance.addconfigcompensationdisabled")):ZPeople.Message.failure(ZPI18N.getString("zp.enablesalaryform"));return isValid},publishValidation:function(){let pageId=settingsPage.container,isValid=!0;var fldPubData=ZPeopleComponents.tokenfield(pageId.find("#tmplfldToPubID")).getAllValues(),actualSelVal=[];if(fldPubData.length>0)for(var i in fldPubData)actualSelVal.push(fldPubData[i].id);if(null===actualSelVal||0===actualSelVal.length){isValid=!1;let obj=pageId.find("#tmplfldToPubID").parent();$(obj).parent().append('<span elem="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.selectatleastonefieldmsg")+"</span>"),$(obj)[0].scrollIntoView({behavior:"smooth",block:"center"})}var pubOwner=ZPeopleComponents.tokenfield(pageId.find("#tmplpubAuthID")).getAllValues(),pubOwnerSelVal=[];if(pubOwner.length>0)for(var i in pubOwner)pubOwnerSelVal.push(pubOwner[i].id);return isValid},save:function(){PMSTmpl.removeError(),PMSV2Cycle.getFormApprovalDetails();let pageId=settingsPage.container,isValid=!0,tabScrollFlg=!1;var formData=new FormData;if(null!=PMSTmpl.FILE&&formData.append("selfappForm",PMSTmpl.FILE),formData.append("selfappFormRemoved",PMSV2Cycle.SEFLAPPRAISALFILEREMOVED),!PMSTmpl.basicDetValidation()){let bdLi=pageId.find("[show=tmplbasicDetDiv]");PMSTmpl.tabSwitchAction(bdLi),tabScrollFlg=!0,isValid=!1}let tmplNm=pageId.find("#tmplcTmplNameID").val().trim();formData.append("periodname",tmplNm);let tmplDesc=pageId.find("#tmplcTmplDescID").val().trim();formData.append("description",tmplDesc);let isSelfEnable=pageId.find("#tmplsaTglBtnFstCrtDiv").hasClass("zpl_act");if(formData.append("selfAppraisalStatus",isSelfEnable),formData.append("selfappstatuschanged",isSelfEnable),formData.append("selfappstatus",isSelfEnable),isSelfEnable){let saMoVl=PMSTmpl.getModSelObj("tmplsaQtPmTBody","tmplsaQlPmTBody");saMoVl.length>0&&(formData.append("selfappJSON",JSON.stringify({moduleval:saMoVl})),formData.append("selfappJSONRatingComment",JSON.stringify(PMSTmpl.getModSelRtgCmtObj("tmplsaQtPmTBody","tmplsaQlPmTBody",saMoVl))))}let isMREnable=pageId.find("#tmplmrTglBtnFstCrtDiv").hasClass("zpl_act");if(isMREnable){if(!PMSTmpl.mrValidation()&&!tabScrollFlg){let mrLi=pageId.find("[show=tmplmrDetDiv]");PMSTmpl.tabSwitchAction(mrLi),tabScrollFlg=!0,isValid=!1}formData.append("multiRaterJSON",JSON.stringify(PMSTmpl.getMRModSelObj()))}else{var mrObj={isEnabled:!1};formData.append("multiRaterJSON",JSON.stringify(mrObj))}let paMoVl=PMSTmpl.getModSelObj("tmplpaQtPmTBody","tmplpaQlPmTBody");if(paMoVl.length>0&&(formData.append("reviewerJSON",JSON.stringify({moduleval:paMoVl})),formData.append("reviewerJSONRatingComment",JSON.stringify(PMSTmpl.getModSelRtgCmtObj("tmplpaQtPmTBody","tmplpaQlPmTBody",paMoVl)))),!PMSTmpl.rtgValidation()&&!tabScrollFlg){let rtgLi=pageId.find("[show=tmplratingDetDiv]");PMSTmpl.tabSwitchAction(rtgLi),tabScrollFlg=!0,isValid=!1}if(!("display: none;"===pageId.find("#tmplmodWgtDiv").attr("style"))&&ZPeopleComponents.toggleswitch("#tmplsetModWgtID").getState()){let tObj={},trChd=pageId.find("#tmplmodWgtTBody").children();$.each(trChd,function(key,val){let inp=$(this).find("input"),cNm=$(inp).attr("compNme"),value=$(inp).val().trim();"KRA"===cNm?!isNaN(value)&&value.length>0&&(tObj.kra=parseInt(value)):"GOALS"===cNm?!isNaN(value)&&value.length>0&&(tObj.goal=parseInt(value)):"KRA_GOALS"===cNm?!isNaN(value)&&value.length>0&&(tObj.kragoal=parseInt(value)):"COMPETENCY"===cNm&&!isNaN(value)&&value.length>0&&(tObj.competency=parseInt(value))}),formData.append("moduleweightageJson",JSON.stringify(tObj))}if(PMSTmpl.ISRATINGEDITOPEN){let rtgLi=pageId.find("[show=tmplratingDetDiv]");PMSTmpl.tabSwitchAction(rtgLi);let errobj=pageId.find("#tmplrtgDetDiv").parent();return $(errobj).append('<span elem="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.saveratingbeforesubmit")+"</span>"),void $(errobj)[0].scrollIntoView({behavior:"smooth",block:"center"})}if(PMSTmpl.getModWgtRtgCnt().rtgCnt>0){var ratingType={};let ratingDigits=parseInt(pageId.find("#tmplratingNoOfDigits").val()),chosenRtgType=pageId.find("#tmplratingType").val();"starRating"===chosenRtgType&&(ratingType.type=0),"numberRating"===chosenRtgType&&(ratingType.type=1,ratingType.max=pageId.find("#tmplMxVl").val()),"textRating"===chosenRtgType&&(ratingType.type=2,ratingType.max=PMSV2Cycle.textrating_name.length,ratingType.textRatingName=PMSV2Cycle.textrating_name,ratingType.textRatingValue=PMSV2Cycle.textrating_value),"customRating"===chosenRtgType&&(ratingType.type=3,ratingType.min=pageId.find("#tmplMnVl").val(),ratingType.max=pageId.find("#tmplMxVl").val()),ratingType.isNotApplicable=pageId.find("#tmplnotApplicable").is(":checked"),ratingType.isRoundOfRT=!1,ratingType.isIncNoDataMod=pageId.find("#tmplisIncNoDataMod").is(":checked"),ratingType.noOfDigits=ratingDigits;let roundOff=pageId.find("#tmplrtRndOffID").is(":checked");if((0===ratingType.noOfDigits||roundOff)&&(ratingType.isRoundOfRT=!0),!pageId.find("#tmplcmtLenDiv").hasClass("DN"))""!==(minCmtLen=pageId.find("#tmplcmtLenInp").val().trim())&&(ratingType.minCommentLength=minCmtLen);formData.append("ratingTypeJSON",JSON.stringify(ratingType));var averagehidearray=[];isSelfEnable&&pageId.find("#tmplselfaveragehide").is(":checked")&&averagehidearray.push("SELF"),pageId.find("#tmplreviewaveragehide").is(":checked")&&averagehidearray.push("REVIEW"),isMREnable&&pageId.find("#tmplmraveragehide").is(":checked")&&averagehidearray.push("MR"),formData.append("hideAverageJSON",JSON.stringify(averagehidearray))}else{ratingType={type:0,isNotApplicable:!0,isRoundOfRT:!1,isIncNoDataMod:!1,noOfDigits:1};var minCmtLen;if(!pageId.find("#tmplcmtLenDiv").hasClass("DN"))""!==(minCmtLen=pageId.find("#tmplcmtLenInp").val().trim())&&(ratingType.minCommentLength=minCmtLen);formData.append("ratingTypeJSON",JSON.stringify(ratingType))}let isNormEnb=pageId.find("#tmplnormTglBtnFstCrtDiv").hasClass("zpl_act");var totalRating=PMSV2Cycle.rating_keyarray.length,rtgArr=[];if(totalRating>=1){let rtgType=pageId.find("#tmplrtgDetDiv ul").attr("rttype");if(pageId.find("#tmplrtgDetDiv ul").find("li[id^=tmplli_]").each(function(){var param1={},series=parseInt($(this).attr("series")),getratingName=$(this).find(".zpl_cyclrgsr span").text();if(""!==getratingName){var getratingId=$(this).attr("rating_id");if(void 0!==getratingId&&getratingId.length>0&&(param1.ratingId=getratingId),param1.ratingName=getratingName,"range"===rtgType&&(void 0!=$(this).find("#tmplrtMinSpn_"+series+" input").val()&&""!=$(this).find("#tmplrtMinSpn_"+series+" input").val()&&(param1.ratingMinrange=$(this).find("#tmplrtMinSpn_"+series+" input").val()),param1.ratingMaxRange=$(this).find("#tmplrtMaxSpn_"+series+" input").val()),param1.ratingStar=totalRating,isNormEnb){var ratingPer=pageId.find("#tmplnormRtgDetDiv ul li").find("#tmplnmRtMinInp_"+series).val();void 0!=ratingPer&&""!=ratingPer&&(param1.normalizPer=ratingPer,parseFloat(ratingPer))}totalRating--,rtgArr.push(param1)}}),formData.append("ratingDetails",JSON.stringify(rtgArr)),"range"===rtgType){let saModRtgCnt=PMSTmpl.getRtgCntWithOutMR("tmplsaQtPmTBody"),paModRtgCnt=PMSTmpl.getRtgCntWithOutMR("tmplpaQtPmTBody");var isChecked=pageId.find("#tmplisRatingLocked").is(":checked"),PALock=!1,SALock=!1;paModRtgCnt>0&&(PALock=!!isChecked),saModRtgCnt>0&&(SALock=!!isChecked),formData.append("paRatingLock",PALock),formData.append("saRatingLock",SALock)}else formData.append("paRatingLock",!1),formData.append("saRatingLock",!1)}let isNormEnable=pageId.find("#tmplnormTglBtnFstCrtDiv").hasClass("zpl_act");if(formData.append("normalizEnable",isNormEnable),isNormEnable){if(!PMSTmpl.normalizationValidation()&&!tabScrollFlg){let nrLi=pageId.find("[show=tmplnrmDetDiv]");PMSTmpl.tabSwitchAction(nrLi),tabScrollFlg=!0,isValid=!1}}let isBudgetEnable=pageId.find("#tmplhikeTglBtnFstCrtDiv").hasClass("zpl_act");if(isBudgetEnable){if(!PMSTmpl.hikeValidation()&&!tabScrollFlg){let hkLi=pageId.find("[show=tmplhkDetDiv]");PMSTmpl.tabSwitchAction(hkLi),tabScrollFlg=!0,isValid=!1}formData.append("budgetEnableInp",isBudgetEnable);var hikeDeciderID=pageId.find("#tmplhkApprSel").val();formData.append("hikeDeciderInp",hikeDeciderID);let afterHikeApproval=pageId.find("#tmplhkApproval").is(":checked");formData.append("afterHikeApprovalInp",afterHikeApproval);let promotionOnHike=pageId.find("#tmplincProp").is(":checked");formData.append("promotionOnHikeInp",promotionOnHike)}if(!PMSTmpl.publishValidation()&&!tabScrollFlg){let pubLi=pageId.find("[show=tmplpubDetDiv]");PMSTmpl.tabSwitchAction(pubLi),tabScrollFlg=!0,isValid=!1}let publishOption=parseInt(pageId.find("[name=tmplpubMtd]:checked").val());formData.append("reviewPublishOption",publishOption);var fldPubData=ZPeopleComponents.tokenfield(pageId.find("#tmplfldToPubID")).getAllValues(),actualSelVal=[];if(fldPubData.length>0)for(var i in fldPubData)actualSelVal.push(fldPubData[i].id);formData.append("publishfields",JSON.stringify(actualSelVal));var pubOwner=ZPeopleComponents.tokenfield(pageId.find("#tmplpubAuthID")).getAllValues(),pubOwnerSelVal=[];if(pubOwner.length>0)for(var i in pubOwner)pubOwnerSelVal.push(pubOwner[i].id);var publisherObj={};if(null!=pubOwnerSelVal&&pubOwnerSelVal.length>0){var obj={},hasRT=!1,hasFinalizer=!1;for(i=0;i<pubOwnerSelVal.length;i++)2==pubOwnerSelVal[i]?hasRT=!0:3==pubOwnerSelVal[i]&&(hasFinalizer=!0);obj.reportingTo=hasRT,obj.finalizer=hasFinalizer,publisherObj.publishers=obj,formData.append("publisherJSON",JSON.stringify(publisherObj))}formData.append("sharefeedback",pageId.find("#tmplempApprFdbkID").is(":checked")),null===PMSTmpl.EDIT_TMPL_DETAIL?formData.append("modeval","add"):(formData.append("modeval","editConfig"),formData.append("periodId",PMSTmpl.EDIT_TMPL_DETAIL.configId));let apprObj=ZPA_Approvers.getApprovalConfigJson();if(formData.append("approvalConfigJSon",JSON.stringify(apprObj)),formData.append("conreqcsr",csrfToken),pageId.find("#tmplreviewApprovalEnable").is(":checked")){if(formData.append("reviewApprovalEnable",!0),""==PMSV2Cycle.review_ApprConf||!PMSV2Cycle.review_ApprConf){isValid=!1;let rtgLi=pageId.find("[show=tmplpaDetDiv]");PMSTmpl.tabSwitchAction(rtgLi);let objT=pageId.find("#tmplreviewApprConf");$(objT).append('<span elem="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.configureapprovalforform",new Array(ZPI18N.getString("zp.review")))+"</span>"),$(objT)[0].scrollIntoView({behavior:"smooth",block:"center"})}}else formData.append("reviewApprovalEnable",!1);isValid?(pageId.find("#tmplSubmit").attr("disabled","disabled"),$.ajax({url:"/performanceConfig.zp?mode=addTmplConfig",type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){if(pageId.find("#tmplSubmit").removeAttr("disabled"),"success"===data.msg){PMSV2Cycle.SEFLAPPRAISALFILEREMOVED=!1;const isEdit=null!==PMSTmpl.EDIT_TMPL_DETAIL,successMessage=isEdit?ZPI18N.getString("zp.survey.template.edited.successfully")+"!!":ZPI18N.getString("zp.templateconfigsuccessmsg"),updateAfterSubmit=!!isEdit;ZPeople.Message.success(successMessage),PMSTmpl.updateAfterSubmit(updateAfterSubmit,data),PMSTmpl.pageClose(!0)}else"PERIOD_NAME_EMPTY"===data.msg?(PMSTmpl.tabSwitchAction(pageId.find("[show=tmplbasicDetDiv]")),PMSTmpl.showError(ZPI18N.getString("zp.tmplnameerr"),pageId.find("#tmplcTmplNameID"))):"NAME_ALREADY_EXIST"===data.msg?(PMSTmpl.tabSwitchAction(pageId.find("[show=tmplbasicDetDiv]")),PMSTmpl.showError(ZPI18N.getString("zp.duplicateSkill",[ZPI18N.getString("zp.templatename")]),pageId.find("#tmplcTmplNameID"))):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},error:function(err){pageId.find("#tmplSubmit").removeAttr("disabled"),ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))}})):ZPeople.Message.failure(ZPI18N.getString("zp.cycle.errormsg.entermissingdetails"))},updateAfterSubmit:function(isEdit,tmplData){const selectedIndex=PMSSetting.LOAD_TMPL_DATA.data.findIndex(obj=>obj.configID===tmplData.configId);isEdit?-1!==selectedIndex&&PMSSetting.LOAD_TMPL_DATA.data.splice(selectedIndex,1,tmplData.data[0]):PMSSetting.LOAD_TMPL_DATA.data.unshift(tmplData.data[0])},openReviewApprToggle:function(){let pageId=settingsPage.container,isNormEnb=pageId.find("#tmplnormTglBtnFstCrtDiv").hasClass("zpl_act");if(pageId.find('#tmplreviewApprConf [elem="errorMsg"]').remove(),pageId.find("#tmplreviewApprovalEnable").is(":checked")){if(isNormEnb){var infoPopUp=new InfoAlertMessage;infoPopUp.title="",infoPopUp.despcription=ZPI18N.getString("zp.alreadyNormalizationEnableErrMsg"),infoPopUp.yesButtonText=ZPI18N.getString("zp.yes"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.cancelCallback=function(){pageId.find("#tmplreviewApprovalEnable").prop("checked",!1),pageId.find("#tmplreviewApprConf").hide()},infoPopUp.show()}pageId.find("#tmplreviewApprConf").show()}else pageId.find("#tmplreviewApprConf").hide()},showHikeApprConf:function(){let pageId=settingsPage.container;pageId.find('#tmplhkApprConf [elem="errorMsg"]').remove(),pageId.find("#tmplhkApproval").is(":checked")?pageId.find("#tmplhkApprConf").show():pageId.find("#tmplhkApprConf").hide()},isValueChangedInTemplatePage:function(){let name=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplcTmplNameID").val();if(PMSV2Cycle.isInputFieldChanged("periodName",name))return!0;let discription=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplcTmplDescID").val();if(PMSV2Cycle.isInputFieldChanged("description",discription))return!0;let isSelfEnabled=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplsaTglBtnFstCrtDiv").hasClass("zpl_act");if(PMSV2Cycle.isBooleanFieldChanged("isSelfAppraisalEnabled",isSelfEnabled))return!0;let isMREnabled=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplmrTglBtnFstCrtDiv").hasClass("zpl_act");if(PMSV2Cycle.isBooleanFieldChanged("multiRaterEnabled",isMREnabled))return!0;let isBudgetEnabled=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplhikeTglBtnFstCrtDiv").hasClass("zpl_act");if(PMSV2Cycle.isBooleanFieldChanged("budgetEnable",isBudgetEnabled))return!0;let isNormalizationEnabled=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplnormTglBtnFstCrtDiv").hasClass("zpl_act");if(PMSV2Cycle.isBooleanFieldChanged("normalizationEnable",isNormalizationEnabled))return!0;let ratingCommentEnabledStatus={selfObj:{},mrObj:{},reviewObj:{}};if(isSelfEnabled){if(ratingCommentEnabledStatus.selfObj=PMSV2Cycle.getModuleRatingValue($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplsaCrt"),"tmpltr","tmplsaQtPmTBody","tmplsaQlPmTBody"),PMSV2Cycle.isModuleRatingChanged($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplsaCrt"),"tmpltr","tmplsaQtPmTBody","tmplsaQlPmTBody","selfObj",ratingCommentEnabledStatus.selfObj))return!0;if(PMSV2Cycle.isFileInputChanged(PMSTmpl.FILE,PMSV2Cycle.SEFLAPPRAISALFILEREMOVED))return!0}if(isMREnabled){if(ratingCommentEnabledStatus.mrObj=PMSV2Cycle.getModuleRatingValue($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplmrCrt"),"tmpltr","tmplmrQtPmTBody","tmplmrQlPmTBody"),PMSV2Cycle.isModuleRatingChanged($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplmrCrt"),"tmpltr","tmplmrQtPmTBody","tmplmrQlPmTBody","mrObj",ratingCommentEnabledStatus.mrObj))return!0;let isMrtypeComEnabled=ZPeopleComponents.toggleswitch($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplmrTypeID")).getState();if(PMSV2Cycle.isBooleanFieldChanged("mrTypebasedmodule",isMrtypeComEnabled))return!0;if(isMrtypeComEnabled&&PMSV2Cycle.isMRtypeModuleRatingChanged("tmplmrTypeTBody","tmplmr","tmplmrType"))return!0;let isAddReportee=ZPeopleComponents.toggleswitch($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplmrAutoPopulate")).getState(),mrchoice=parseInt($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("[name=mrSelRdBx]:checked").val());if(isAddReportee){1==mrchoice?mrchoice=4:2==mrchoice&&(mrchoice=5);let defaultmrType=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplmrTypeSelID").val();if(PMSV2Cycle.isInputFieldChanged("defaultmrType",defaultmrType))return!0}let mrType=mrchoice;if(PMSV2Cycle.isInputFieldChanged("mrType",mrType))return!0;let mrMaxRater=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplmaxrater").val();if(isMREnabled&&PMSV2Cycle.isInputFieldChanged("mrMaxRater",mrMaxRater))return!0;let mrMinRater=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplminrater").val();if(isMREnabled&&PMSV2Cycle.isInputFieldChanged("mrMinRater",mrMinRater))return!0;let showSelfApprForMR=!1;if(isSelfEnabled&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplselfApprViewForMR").is(":checked")&&(showSelfApprForMR=!0),isSelfEnabled&&PMSV2Cycle.isBooleanFieldChanged("showSelfApprForMR",showSelfApprForMR))return!0}if(ratingCommentEnabledStatus.reviewObj=PMSV2Cycle.getModuleRatingValue($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplpaDetDiv"),"tmpltr","tmplpaQtPmTBody","tmplpaQlPmTBody"),PMSV2Cycle.isModuleRatingChanged($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplpaDetDiv"),"tmpltr","tmplpaQtPmTBody","tmplpaQlPmTBody","reviewObj",ratingCommentEnabledStatus.reviewObj))return!0;let apprObj=ZPA_Approvers.getApprovalConfigJson(),approvalArr=Object.values(apprObj);if(PMSV2Cycle.isReviewLevelChanged("approvalArr",approvalArr))return!0;let reviewApprovalEnable=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplreviewApprovalEnable").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("reviewApprovalEnable",reviewApprovalEnable))return!0;let modWeightageObj={};if(PMSTmpl.IS_MOD_WHT_ENABLED&&ZPeopleComponents.toggleswitch($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplsetModWgtID")).getState()){let modwhtElement=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplmodWgtTBody").find("input");for(var index=0;index<modwhtElement.length;index++)if(!$(modwhtElement[index]).hasClass("disabled")){modWeightageObj[$(modwhtElement[index]).attr("compnme")]=parseInt($(modwhtElement[index]).val())}}if(PMSV2Cycle.isJSONObjectValueChanged("modWeightage",modWeightageObj))return!0;let moduleRatingType={};if(moduleRatingType.isIncNoDataMod=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplisIncNoDataMod").is(":checked"),PMSV2Cycle.isBooleanFieldChanged("isIncNoDataMod",moduleRatingType.isIncNoDataMod,!1,!0))return!0;if(moduleRatingType.isNotApplicable=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplnotApplicable").is(":checked"),PMSV2Cycle.isBooleanFieldChanged("isNotApplicable",moduleRatingType.isNotApplicable,!0,!0))return!0;if(PMSTmpl.IS_MIN_CMT_LEN_ENABLED&&(moduleRatingType.minCommentLength=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplcmtLenInp").val(),PMSV2Cycle.isInputFieldChanged("minCommentLength",moduleRatingType.minCommentLength,0,!0)))return!0;if(moduleRatingType.noOfDigits=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplratingNoOfDigits").val(),PMSV2Cycle.isInputFieldChanged("noOfDigits",moduleRatingType.noOfDigits,1,!0))return!0;if(moduleRatingType.reviewRatingLock=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplisRatingLocked").is(":checked"),PMSV2Cycle.isBooleanFieldChanged("reviewRatingLock",moduleRatingType.reviewRatingLock,!1,!0))return!0;if(moduleRatingType.roundOfRT=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplrtRndOffID").is(":checked"),PMSV2Cycle.isBooleanFieldChanged("roundOfRT",moduleRatingType.roundOfRT,!1,!0))return!0;let ratingType=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplratingType").val();if("starRating"==ratingType)moduleRatingType.type=0;else if("numberRating"==ratingType)moduleRatingType.type=1,moduleRatingType.min=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplMnVl").val(),moduleRatingType.max=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplMxVl").val();else if("textRating"==ratingType){moduleRatingType.type=2;let textRatingElement=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplCstTxtRtgID").find("input");moduleRatingType.max=textRatingElement.length;let textRatingName=[],textRatingValue=[];for(index=0;index<textRatingElement.length;index++){let inputelement=textRatingElement[textRatingElement.length-index-1];textRatingName.push($(inputelement).val()),textRatingValue.push(index+1)}if(moduleRatingType.textRatingName=textRatingName,moduleRatingType.textRatingValue=textRatingValue,PMSV2Cycle.isArrayValueChanged("textRatingName",moduleRatingType.textRatingName,!1,!1,!0))return!0}else moduleRatingType.type=3,moduleRatingType.min=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplMnVl").val(),moduleRatingType.max=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplMxVl").val();if(PMSV2Cycle.isInputFieldChanged("type",moduleRatingType.type,0,!0))return!0;if((1==moduleRatingType.type||2==moduleRatingType.type)&&PMSV2Cycle.isInputFieldChanged("min",moduleRatingType.min,void 0,!0))return!0;if((1==moduleRatingType.type||2==moduleRatingType.type)&&PMSV2Cycle.isInputFieldChanged("max",moduleRatingType.max,void 0,!0))return!0;if(3==moduleRatingType.type&&PMSV2Cycle.isInputFieldChanged("max",moduleRatingType.max,void 0,!0))return!0;let hideaverage=[];if(void 0!=PMSTmpl.IS_HIDE_AVERGE_ENABLED.SELF&&PMSTmpl.IS_HIDE_AVERGE_ENABLED.SELF&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplselfaveragehide").is(":checked")&&hideaverage.push("SELF"),void 0!=PMSTmpl.IS_HIDE_AVERGE_ENABLED.MR&&PMSTmpl.IS_HIDE_AVERGE_ENABLED.MR&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplmraveragehide").is(":checked")&&hideaverage.push("MR"),void 0!=PMSTmpl.IS_HIDE_AVERGE_ENABLED.REVIEW&&PMSTmpl.IS_HIDE_AVERGE_ENABLED.REVIEW&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplreviewaveragehide").is(":checked")&&hideaverage.push("REVIEW"),PMSV2Cycle.isArrayValueChanged("hideaverage",hideaverage,!0))return!0;let cycleRatings=[];for(var i in PMSV2Cycle.rating_keyarray){let obj={},jindex=PMSV2Cycle.rating_keyarray.length-1-i;void 0!=PMSV2Cycle.rating_maxRangeArray[jindex]&&(obj.maxRange=PMSV2Cycle.rating_maxRangeArray[jindex]),void 0!=PMSV2Cycle.rating_minRangeArray[jindex]&&(obj.minRange=PMSV2Cycle.rating_minRangeArray[jindex]),isNormalizationEnabled&&$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplnmRtMinInp_"+jindex).length>0&&(obj.norPer=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplnmRtMinInp_"+jindex).val()),obj.ratingName=PMSV2Cycle.rating_keyarray[jindex],obj.stars=jindex+1,cycleRatings.push(obj)}if(PMSV2Cycle.isRatingValueChanged("cycleRatings",cycleRatings,isNormalizationEnabled))return!0;if(isBudgetEnabled){let hikeApprovalEnable=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplhkApproval").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("hikeApprovalEnable",hikeApprovalEnable))return!0;let hikeDecider=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplhkApprSel").val();if(PMSV2Cycle.isInputFieldChanged("hikeDecider",hikeDecider))return!0;let promotionOnHikeEnabled=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplincProp").is(":checked");if(PMSV2Cycle.isBooleanFieldChanged("promotionOnHikeEnabled",promotionOnHikeEnabled))return!0}let publishOption=parseInt($(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("[name=tmplpubMtd]:checked").val());if(PMSV2Cycle.isInputFieldChanged("publishOption",publishOption))return!0;var fldPubData=ZPeopleComponents.tokenfield("#tmplfldToPubID").getAllValues(),actualSelVal=[];if(fldPubData.length>0)for(var i in fldPubData)actualSelVal.push(fldPubData[i].id);if(PMSV2Cycle.isArrayValueChanged("compidarr",actualSelVal,!0,!0))return!0;var pubOwner=ZPeopleComponents.tokenfield("#tmplpubAuthID").getAllValues(),pubOwnerSelVal=[];if(pubOwner.length>0)for(var i in pubOwner)pubOwnerSelVal.push(pubOwner[i].id);let publisherFinalizer=!1;-1!=pubOwnerSelVal.indexOf("3")&&(publisherFinalizer=!0);let publisherRM=!1;if(-1!=pubOwnerSelVal.indexOf("2")&&(publisherRM=!0),PMSV2Cycle.isBooleanFieldChanged("publisherFinalizer",publisherFinalizer))return!0;if(PMSV2Cycle.isBooleanFieldChanged("publisherRM",publisherRM))return!0;let shareFeedback=$(PMSV2Cycle.CYCLE_PAGE_CONTAINER).find("#tmplempApprFdbkID").is(":checked");return!!PMSV2Cycle.isBooleanFieldChanged("shareFeedback",shareFeedback)}},PMSUserwiseSearch={ENABLED_MODULES:{},getNewPerformanceModules:function(){if(null===PMSUserwiseSearch.ENABLED_MODULES||Object.keys(PMSUserwiseSearch.ENABLED_MODULES).length<=0){ZPeople.Request.sendAsyncPost("/performanceConfig.zp",{mode:"getPerformanceModules"},function(resultData){PMSUserwiseSearch.ENABLED_MODULES=resultData.perfModules})}},redirect:function(recId,isFromPopup){PMSUserwiseSearch.getNewPerformanceModules(),void 0!==AppraisalConfig.InitResult&&0!=Object.keys(AppraisalConfig.InitResult).length||AppraisalConfig.fetchInit();let url=Layout.Page.currentmode.includes("operations")?"#operations/performance/user/":"#performance/myteamuser/";isFromPopup&&"true"===isFromPopup?(paCommonUtil.isFromUserPopup=!0,paCommonUtil.previousURLBackup=Layout.Page.hash):(paCommonUtil.isFromUserPopup=!1,paCommonUtil.previousURLBackup="");let actModuleObj=PMSUserwiseSearch.ENABLED_MODULES,smy=actModuleObj.SUMMARY;var fdb=actModuleObj.FEEDBACK,competency=actModuleObj.COMPETENCY,skillS=actModuleObj.SKILLSET,kraObj=actModuleObj.KRA,goalObj=actModuleObj.GOALS,kgObj=actModuleObj.KRA_GOALS,isKraEnable=1===kraObj.enable,isGoalEnable=1===goalObj.enable,isKraGlEnable=1===kgObj.enable;isKraEnable||isKraGlEnable?window.location.href=url+"kra-user:"+recId+"/configId:"+-1:isGoalEnable?window.location.href=url+"goals-user:"+recId+"/configId:"+-1:1===skillS.enable?window.location.href=url+"skillset-user:"+recId+"/configId:"+-1:1===competency.enable?window.location.href=url+"competency-user:"+recId+"/configId:"+-1:1===fdb.enable?window.location.href=url+"feedback-user:"+recId+"/configId:"+-1:1===smy.enable&&(window.location.href=url+"summary-user:"+recId+"/configId:"+-1)}};const PMSCycleManageData={cycleManageDataSliderObj:{},salaryhikeManageDataSliderObj:{},salaryHikeSliderObj:{},isSalaryHikeView:!1,statusObj:{},isAppraiseeSearch:!1,isRefreshManageAppraisee:!1,previouslySearchedText:"",reviewLevelSliderObj:{},reviewlevel:0,isPARatingEnabled:!1,ConstructRecList:function(){var pageId=settingsPage.container;const{_mode:_mode}=AppraisalView.getAppraisalViewMode();let recIds="",checkboxDiv=void 0;checkboxDiv=AppraisalView[_mode].isListView?pageId.find("tbody#appraisalemps").find("input[type='checkbox']:checked"):pageId.find("#manageDataAppraiseelisttbody").find("input:checked");for(let index=0;index<checkboxDiv.length;index++){let data=checkboxDiv[index],recId=void 0;recId=AppraisalView[_mode].isListView?$(data).closest("tr").attr("pa_id"):$(data).parent().attr("id"),recIds+=0==index?recId:","+recId}return recIds}};PMSCycleManageData.salaryHikeCycle={openSalaryHikeView:function(hikeAppraiser,isAfterSubmit){let configId=PMSCycleManageData.salaryhikeManageDataSliderObj.appraisalConfigId;if(void 0!=PMSCycleManageData.salaryHikeSliderObj.remove&&(BudgetView.deleteSalaryhikecomponents(),PMSCycleManageData.salaryHikeSliderObj.remove()),PMSCycleManageData.salaryHikeSliderObj={},0==Object.keys(PMSCycleManageData.salaryHikeSliderObj).length){var sliderTab=new Tab("SalaryHikeView",function(){$("#cardSalaryHikeView").html('<div class="zpl_act zpl_tbllftfxd zpl_tblfxd zpl_tblpahike" style="overflow-x: auto;--tblfxdhgt: 0;"><div class="zpl_rgtcnt"><div class="zpl_tblres" id="tbody"></div></div></div>')});let userInfo=ZPeople.getUserDetailsById(hikeAppraiser),_username=userInfo.notFound?ZPI18N.getString("zp.unknownuser"):userInfo.name,_userempid=userInfo.notFound?"":userInfo.name,tabName=PMSV2Cycle.SALARYHIKENAME+" "+ZPI18N.getString("zp.of")+" "+_username+" "+_userempid;PMSCycleManageData.salaryHikeSliderObj=new sliderModal(tabName,sliderTab),PMSCycleManageData.salaryHikeSliderObj.fullPageSize=!0,PMSCycleManageData.salaryHikeSliderObj._saveToggle=!0,PMSCycleManageData.salaryHikeSliderObj.setCloseCallback(function(){$(PMSCycleManageData.salaryHikeSliderObj.sliderDiv).find("#tHeading select").each(function(index,element){const attrid=$(element).attr("id");ZPeopleComponents.isComponent($(PMSCycleManageData.salaryHikeSliderObj.sliderDiv).find("#"+attrid))&&ZPeopleComponents.select($(PMSCycleManageData.salaryHikeSliderObj.sliderDiv).find("#"+attrid)).destroy()}),void 0!=PMSCycleManageData.salaryHikeSliderObj.remove&&PMSCycleManageData.salaryHikeSliderObj.remove(),PMSCycleManageData.salaryHikeSliderObj={}}),PMSCycleManageData.salaryHikeSliderObj.construct()}PMSCycleManageData.salaryHikeSliderObj.appraisalConfigId=configId,PMSCycleManageData.salaryHikeSliderObj.hikeAppraiser=hikeAppraiser,PMSCycleManageData.salaryHikeSliderObj.startIndex=1,$("#tabSalaryHikeView").find("#sliFootDiv").html(PMSCycleManageData.salaryHikeCycle.getSalaryHikeBottomHtml());let cycleData=PMSOperation.temp,cycleIndex=cycleData.findIndex(obj=>obj.configId===configId);"-1"!=cycleIndex&&0==$(PMSCycleManageData.salaryHikeSliderObj.sliderDiv).find(".zpl_dots").length&&$(PMSCycleManageData.salaryHikeSliderObj.sliderDiv).find("#sliHdrDiv").find("h4").after('<span class="zpl_dots M0I"></span><div class="zpl_ellipsis250" style="max-inline-size: 400px !important;" title="'+cycleData[cycleIndex].periodName+'">'+cycleData[cycleIndex].periodName+"</div>"),PMSCycleManageData.salaryHikeCycle.salaryHikeView(isAfterSubmit)},getSalaryHikeBottomHtml:function(){return BudgetView.getHikeTerms(),'<div class="DNI" id="budgetpagination"><div class="zpl_rhtpgn DNI"  id="budgetInfoFooter"><div class="zpl_lftpgn"><span class="d-flexclmcap5" id="recordCount"><label >'+ZPI18N.getString("zp.totalrecordcount")+' :</label><b> 10</b></span></div><div class="zpl_admclr_rgt"><div  id="orgBudget"> <span class="w200 zpl_ellipsis" title="allocatedHike">'+AppraisalConfig.ALLOCATEDHIKENAME+'</span><span><b>0 - 0</b></span></div><div id="recBudget"><span class="w200 zpl_ellipsis" title="proposedHike">'+AppraisalConfig.PROPOSEDHIKENAME+'</span><span><b>0 - 0</b></span></div><div id="diffBudget"><span class="a-itm-cntr d-flexclmcap5">'+ZPI18N.getString("zp.difference")+'<i id="summaryStatus" title="" style="display: none;"></i></span><span><b>0 | 0</b></span></div><div class="d-flexM" id="reviewSheetCreateDiv"><button class="zlabel zlabel--blue zlabel--medium" >'+ZPI18N.getString("zp.sendforapproval")+'</button></div><div class="d-flexM" id="reviewSheetNA"><button class="zlabel zlabel--blue zlabel--medium" >'+ZPI18N.getString("zp.submit")+"</button></div></div></div></div>"},salaryHikeView:function(isAfterSubmit){let resultData;var params={mode:"getSalaryHikeView",configId:PMSCycleManageData.salaryHikeSliderObj.appraisalConfigId,hikeAppraiser:PMSCycleManageData.salaryHikeSliderObj.hikeAppraiser,conreqcsr:csrfToken};if($.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(data){resultData=data}}),void 0!=isAfterSubmit&&isAfterSubmit&&void 0!=resultData&&void 0!=resultData.dataJson){var isCompleted=!1;for(let index=0;index<resultData.dataJson.length;index++)isCompleted=void 0!=resultData.dataJson[index].approvalStatus&&"1"==resultData.dataJson[index].approvalStatus;isCompleted&&(settingsPage.container.find("#"+PMSCycleManageData.salaryHikeSliderObj.hikeAppraiser).find("td:last").removeClass("ylw").addClass("grn"),settingsPage.container.find("#"+PMSCycleManageData.salaryHikeSliderObj.hikeAppraiser).find("td:last").html(ZPI18N.getString("zp.completed")))}void 0!=resultData.configDetails&&void 0!=resultData.configDetails.isPromotionEnabled&&resultData.configDetails.isPromotionEnabled?BudgetView.isPromotionEnabled=!0:BudgetView.isPromotionEnabled=!1;let otherDetails={scrollaction:!1},param={};param.configID=PMSCycleManageData.salaryHikeSliderObj.appraisalConfigId,param.cycleStatus="1",param.selMgr=resultData.hikedecider;var pageId=paCommonUtil.getLayout();pageId.find("#salarysplitcont").find("#tHeading select").each(function(index,element){const attrid=$(element).attr("id");ZPeopleComponents.isComponent(pageId.find("#"+attrid))&&ZPeopleComponents.select(pageId.find("#"+attrid)).destroy()}),BudgetView.newConstructSalarySplitUpData(resultData,param,otherDetails),$(PMSCycleManageData.salaryHikeSliderObj.sliderDiv).find("#tHeading").find("th:first").attr("style","z-index: 3;"),resultData.isAllowedToEdit||($(PMSCycleManageData.salaryHikeSliderObj.sliderDiv).find("#reviewSheetCreateDiv button").remove(),$(PMSCycleManageData.salaryHikeSliderObj.sliderDiv).find("#reviewSheetNA button").remove())},showSalaryHikeManageData:function(configId){PMSV2Cycle.getHikeTerms(),PMSCycleManageData.previouslySearchedText="",void 0!=PMSCycleManageData.salaryhikeManageDataSliderObj.remove&&PMSCycleManageData.salaryhikeManageDataSliderObj.remove();let cycleIndex=PMSOperation.temp.findIndex(obj=>obj.configId===configId),periodName="";if("-1"!=cycleIndex&&(periodName=PMSOperation.temp[cycleIndex].periodName),PMSCycleManageData.salaryhikeManageDataSliderObj={},PMSCycleManageData.isSalaryHikeView=!0,0==Object.keys(PMSCycleManageData.salaryhikeManageDataSliderObj).length){var sliderTab=new Tab("salaryhikeManageData",function(){_htm='<div class="zpl_btnmnu"><div class="search-cmn opn"><i class="PI_lens" title="Search"></i><input type="text" class="ztextbox" id="salaryHikeDecider" placeholder="'+ZPI18N.getString("zp.searchhikeappraiser")+'"></div><div class="zpl_rgt"></div></div><div id="manageSalaryTable" class="zpl_tblres"></div>',$("#cardsalaryhikeManageData").html(_htm)});PMSCycleManageData.salaryhikeManageDataSliderObj=new sliderModal(ZPI18N.getString("zp.managesalaryhike",[PMSV2Cycle.SALARYHIKENAME]),sliderTab),PMSCycleManageData.salaryhikeManageDataSliderObj.largeSize=!0,PMSCycleManageData.salaryhikeManageDataSliderObj._saveToggle=!1,PMSCycleManageData.salaryhikeManageDataSliderObj.setCloseCallback(function(){PMSOperation.getUpdatedStatusCountForCycle(PMSCycleManageData.salaryhikeManageDataSliderObj.appraisalConfigId),PMSCycleManageData.salaryhikeManageDataSliderObj.remove(),PMSCycleManageData.salaryhikeManageDataSliderObj={}}),PMSCycleManageData.salaryhikeManageDataSliderObj.construct()}$(PMSCycleManageData.salaryhikeManageDataSliderObj.sliderDiv).find("#sliFootDiv").addClass("DNI");var pageId=$(PMSCycleManageData.salaryhikeManageDataSliderObj.sliderDiv);if(0==pageId.find(".zpl_dots").length){let cycleData=PMSOperation.temp,cycleIndex=cycleData.findIndex(obj=>obj.configId===configId);"-1"!=cycleIndex&&(pageId.find("#sliHdrDiv").find("div:first").addClass("d-flexC"),pageId.find("#sliHdrDiv").find("h4").after('<span class="zpl_dots"></span><div class="zpl_ellipsis250" style="max-inline-size: 400px !important;" title="'+cycleData[cycleIndex].periodName+'">'+cycleData[cycleIndex].periodName+"</div>"))}pageId.find("#sliHdrDiv").find("#sliderCls").before('<div class="zpl_mhderrgt"><div class="zpl_topgrpmnu d-flex" style="margin-bottom: 0px;"><ul class="zpl_grpmnu"><li id="hikeGroupby" onclick="PMSCycleManageData.salaryHikeCycle.changeManageSalaryHikeView(this)" class="zpl_act">'+ZPI18N.getString("zp.appraiserview")+'</li><li id="allemp" onclick="PMSCycleManageData.salaryHikeCycle.changeManageSalaryHikeView(this)">'+ZPI18N.getString("zp.local.EmployeeView")+"</li></ul> </div></div>"),PMSCycleManageData.salaryhikeManageDataSliderObj.appraisalConfigId=configId,PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex=1,PMSCycleManageData.salaryHikeCycle.salaryHikeManageDataConstruction()},salaryHikeManageDataConstruction:function(isSearch,searchVal,Scroll){var resultData={};if(void 0!=Scroll&&Scroll){if(!PMSCycleManageData.salaryhikeManageDataSliderObj.triggerAppraiserFS)return!1}else PMSCycleManageData.salaryhikeManageDataSliderObj.triggerAppraiserFS=!0;var pageId=$(PMSCycleManageData.salaryhikeManageDataSliderObj.sliderDiv),params={mode:"getCycleManageDataAppraiser",configId:PMSCycleManageData.salaryhikeManageDataSliderObj.appraisalConfigId,sIndex:PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex,conreqcsr:csrfToken,isSalaryView:!0};if(void 0!=isSearch&&isSearch?params.searchval=searchVal:void 0!=(searchVal=pageId.find("#salaryHikeDecider").val())&&""!=searchVal&&(params.searchval=searchVal),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(data){resultData=data}}),1==PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex&&0==resultData.appraiser.length)return pageId.find(".zpl_tblres").html(""),PMSOperationCommon.setNoData(pageId.find(".zpl_tblres"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null),!1;1==PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex&&pageId.find(".zpl_tblres").html('<table class="zpl_tbl wd100_per"><thead><tr><th width="500">'+ZPI18N.getString("zp.hikeDecider")+"</th><th>"+ZPI18N.getString("zp.totalappraisee")+"</th><th>"+ZPI18N.getString("zp.difference")+"</th><th>"+ZPI18N.getString("zp.status")+'</th></tr></thead><tbody id="SalaryHikeManagedataTbody"></tbody></tbody></table>'),PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex+=resultData.appraiser.length;var html="";if(resultData.appraiser.length>0){for(var index=0;index<resultData.appraiser.length;index++){let data=resultData.appraiser[index];html+='<tr id="'+data.recordId+'" onclick="PMSCycleManageData.salaryHikeCycle.openSalaryHikeView(\''+data.recordId+'\')"><td width="500"><div class="zpl_em"><div class="zpl_emimg"  module="pms" popup="user" empid="'+data.zuid+'"><img src="'+data.empPhoto+'"></div>',data.empId&&-1!=data.empId.indexOf("_deleted")?html+='<div class="zpl_emdts"><div><b>'+data.name+"</b></div>":html+='<div class="zpl_emdts"><div><em>'+data.empId+" - </em><b>"+data.name+"</b></div>",html+="</div></td>",html+="<td>"+data.totalEmp+'</td><td id="diff_'+data.recordId+'" class="'+(data.difference>0?"grn":data.difference<0?"red":"")+'">'+BudgetView.adjustAmount(data.difference)+"</td>",void 0!=data.completedPer&&"100"==data.completedPer?html+='<td class="grn">'+ZPI18N.getString("zp.completed")+"</td>":html+='<td class="ylw">'+ZPI18N.getString("zp.pending")+" </td>",html+="</tr>"}pageId.find("#SalaryHikeManagedataTbody").append(html),pageId.find("#salaryHikeDecider").unbind("keyup"),pageId.find("#salaryHikeDecider").keyup(function(event){paCommonUtil.validateSearch($(PMSCycleManageData.salaryhikeManageDataSliderObj.sliderDiv).find("#salaryHikeDecider"),"salaryHikeSearch",PMSCycleManageData.salaryHikeCycle.searchSalaryCycleManageDataAppraiser)}),pageId.find("#manageSalaryTable").unbind("scroll"),pageId.find("#cardsalaryhikeManageData").unbind("scroll"),pageId.find("#cardsalaryhikeManageData").scroll(function(){var widHei=$(this).height();this.scrollHeight<=$(this).scrollTop()+widHei+25&&PMSCycleManageData.salaryHikeCycle.salaryHikeManageDataConstruction(!1,void 0,!0)})}else PMSCycleManageData.salaryhikeManageDataSliderObj.triggerAppraiserFS=!1,void 0!=Scroll&&Scroll||(pageId.find(".zpl_tblres").html(""),PMSOperationCommon.setNoData(pageId.find(".zpl_tblres"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null))},searchSalaryCycleManageDataAppraiser:function(){var pageId=$(PMSCycleManageData.salaryhikeManageDataSliderObj.sliderDiv),searchval=pageId.find("#salaryHikeDecider").val();PMSCycleManageData.previouslySearchedText=searchval,PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex=1,pageId.find(".zpl_tblres").html(""),PMSCycleManageData.salaryHikeCycle.salaryHikeManageDataConstruction(!0,searchval,!1)},changeManageSalaryHikeView:function(obj){if(!$(obj).hasClass("zpl_act")){var pageId=$(PMSCycleManageData.salaryhikeManageDataSliderObj.sliderDiv);pageId.find("#salaryHikeDecider").val(""),PMSCycleManageData.previouslySearchedText="",PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex=1,pageId.find("#manageSalaryTable").html(""),$(obj).addClass("zpl_act");let id=$(obj).attr("id");"hikeGroupby"==id?(pageId.find("#manageSalaryTable").removeClass(),pageId.find("#manageSalaryTable").removeAttr("style"),pageId.find("#manageSalaryTable").addClass("zpl_tblres"),pageId.find("#allemp").removeClass("zpl_act"),pageId.find("#salaryHikeDecider").attr("placeholder",ZPI18N.getString("zp.searchhikeappraiser")),PMSCycleManageData.salaryHikeCycle.salaryHikeManageDataConstruction()):"allemp"==id&&(pageId.find("#manageSalaryTable").removeClass(),pageId.find("#manageSalaryTable").removeAttr("style"),pageId.find("#manageSalaryTable").addClass("zpl_act"),pageId.find("#manageSalaryTable").addClass("zpl_tbllftfxd"),pageId.find("#manageSalaryTable").addClass("zpl_tblfxd"),pageId.find("#manageSalaryTable").addClass("zpl_tblpahike"),pageId.find("#manageSalaryTable").attr("style","overflow-x: auto;--tblfxdhgt: 0;"),pageId.find("#salaryHikeDecider").attr("placeholder",ZPI18N.getString("zp.searchappraisee")),pageId.find("#hikeGroupby").removeClass("zpl_act"),PMSCycleManageData.salaryHikeCycle.salaryHikeManageDataAppraiseeViewConstruction())}},salaryHikeManageDataAppraiseeViewConstruction:function(isSearch,searchVal,Scroll){BudgetView.getHikeTerms();var resultData={};if(void 0!=Scroll&&Scroll){if(!PMSCycleManageData.salaryhikeManageDataSliderObj.triggerAppraiserFS)return!1}else PMSCycleManageData.salaryhikeManageDataSliderObj.triggerAppraiserFS=!0;var pageId=$(PMSCycleManageData.salaryhikeManageDataSliderObj.sliderDiv),params={mode:"getSalaryHikeAppraiseelist",configId:PMSCycleManageData.salaryhikeManageDataSliderObj.appraisalConfigId,sIndex:PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex,conreqcsr:csrfToken};if(void 0!=isSearch&&isSearch?params.searchval=searchVal:void 0!=(searchVal=pageId.find("#salaryHikeDecider").val())&&""!=searchVal&&(params.searchval=searchVal),$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(data){resultData=data}}),1==PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex&&0==resultData.appraisee.length)return pageId.find("#manageSalaryTable").html(""),PMSOperationCommon.setNoData(pageId.find("#manageSalaryTable"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null),!1;let isPromotionEnabled=void 0!=resultData.isPromotionEnabled&&resultData.isPromotionEnabled;if(1==PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex){pageId.find("#manageSalaryTable").html('<div class="zpl_rgtcnt"><div class="zpl_tblres" id="manageSalaryAppraiseeViewDiv"><table class="zpl_tbl reg_tbl" id="manageSalaryAppraiseeViewTable"><thead id="manageSalaryAppraiseeViewThead"></thead><tbody id="manageSalaryAppraiseeViewTbody"></tbody></table></div></div>');let thead="",currencyCode=void 0!=resultData.currencyCode?resultData.currencyCode:"";thead='<tr><th class="mw300" style="z-index: 3;">'+ZPI18N.getString("zp.employee")+" </th>",thead+='<th class="mw300">'+ZPI18N.getString("zp.hikeDecider")+" </th>",thead+='<th class="mw150">'+ZPI18N.getString("zp.status")+" </th>",thead+='<th class="mw150">'+ZPI18N.getString("zp.salary")+currencyCode+" </th>",isPromotionEnabled&&(thead+='<th class="mw300">'+ZPI18N.getString("zp.proposedpromotion")+" </th>"),thead+='<th class="tblthead"><table class="zpl_tblcntr zpl_itbl"><thead><tr><th class="zpl_tblbrbtm" colspan="2">'+AppraisalConfig.ALLOCATEDHIKENAME+"</th></tr>",thead+='<tr><th class="mw150">'+ZPI18N.getString("zp.percentage")+'</th><th class="mw180">'+ZPI18N.getString("zp.amount")+"</th></tr> </thead></table></th>",thead+='<th class="tblthead"><table class="zpl_tblcntr zpl_itbl"><thead><tr><th class="zpl_tblbrbtm" colspan="2">'+AppraisalConfig.PROPOSEDHIKENAME+"</th></tr>",thead+='<tr><th class="mw150">'+ZPI18N.getString("zp.percentage")+'</th><th class="mw180">'+ZPI18N.getString("zp.amount")+"</th></tr></thead></table></th>",thead+='<th class="mw150">'+ZPI18N.getString("zp.revised")+" "+ZPI18N.getString("zp.salary")+"</th>",thead+='<th class="tblthead"><table class="zpl_tblcntr zpl_itbl"><thead><tr><th class="zpl_tblbrbtm" colspan="2">'+ZPI18N.getString("zp.difference")+"</th></tr>",thead+='<tr><th class="mw150">'+ZPI18N.getString("zp.percentage")+'</th><th class="mw180">'+ZPI18N.getString("zp.amount")+"</th></tr></thead></table></th>",thead+='<th class="mw150">'+ZPI18N.getString("zp.Justification")+"</th></tr>",pageId.find("#manageSalaryAppraiseeViewThead").append(thead)}PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex+=resultData.appraisee.length;var html="";if(resultData.appraisee.length>0){for(var index=0;index<resultData.appraisee.length;index++){let data=resultData.appraisee[index];html+='<tr id="'+data.recordId+'">',html+='<td class="mw300"><div class="zpl_em"><div class="zpl_emimg" module="pms" popup="user" empid="'+data.empzuid+'"><img src="'+data.empPhoto+'"></div><div class="zpl_emdts"><div><em>'+data.empId+" - </em><b>"+data.empName+"</div><em></em></b></div></div></td>",html+='<td class="mw300">'+data.apprId+" - "+data.apprName+" </td>","1"==data.statusClr?html+='<td><span class="grn">'+data.statusText+"</span></td>":"-1"==data.statusClr?html+='<td><span class="red">'+data.statusText+"</span></td>":html+='<td><span class="ylw">'+data.statusText+"</span></td>";let totalSalary=parseFloat(data.salary).toFixed(0),totalApprovedBudget=parseFloat(data.approAmt).toFixed(0),totalApprBudPer=parseFloat(data.approPer),totalApprovedBudgetPercentageStr=parseFloat(totalApprBudPer).toFixed(2)+"%",totalActualHike=parseFloat(data.proposedAmt).toFixed(0),totalActHikePer=parseFloat(data.proposedPer),totalActualHikePercentageStr=parseFloat(totalActHikePer).toFixed(2)+"%",diff=parseFloat(totalApprovedBudget)-parseFloat(totalActualHike);diff=parseFloat(diff).toFixed(0);let diffPer=parseFloat(totalApprBudPer)-parseFloat(totalActHikePer),diffPercentageStr=(diffPer=parseFloat(diffPer).toFixed(2))+"%",revisedSalary=parseFloat(totalSalary)+parseFloat(totalActualHike);html+='<td class="mw150">'+BudgetView.adjustAmount(totalSalary)+" </td>",isPromotionEnabled&&(html+='<td class="mw300">'+BudgetView.getDesignation(data.promotedDesignationId)+" </td>"),html+='<td class="tblbody"><table class="zpl_itbl zpl_tblcntr"><tbody><tr><td class="mw150"><span>'+totalApprovedBudgetPercentageStr+'</span></td><td class="mw180"><span>'+totalApprovedBudget+"</span></td></tr></tbody></table></td>",html+='<td class="tblbody"><table class="zpl_itbl zpl_tblcntr"><tbody><tr><td class="mw150"><span>'+totalActualHikePercentageStr+'</span></td><td class="mw180"><span>'+BudgetView.adjustAmount(totalActualHike)+"</span></td></tr></tbody></table></td>",html+='<td class="mw150">'+BudgetView.adjustAmount(revisedSalary)+"</td>",html+='<td class="tblbody"><table class="zpl_itbl zpl_tblcntr"><tbody><tr><td class="mw150"><span>'+diffPercentageStr+'</span></td><td class="mw180"><span>'+BudgetView.adjustAmount(diff)+"</span></td></tr></tbody></table></td>",html+='<td class="mw150">'+(void 0!==data.justification&&"null"!==data.justification?$.trim(data.justification):"")+"</td></tr>"}pageId.find("#manageSalaryAppraiseeViewTbody").append(html),pageId.find("#salaryHikeDecider").unbind("keyup"),pageId.find("#salaryHikeDecider").keyup(function(event){paCommonUtil.validateSearch($(PMSCycleManageData.salaryhikeManageDataSliderObj.sliderDiv).find("#salaryHikeDecider"),"salaryHikeSearch",PMSCycleManageData.salaryHikeCycle.searchSalaryCycleAppraiseeView)}),pageId.find("#cardsalaryhikeManageData").unbind("scroll"),pageId.find("#manageSalaryTable").unbind("scroll"),pageId.find("#manageSalaryTable").scroll(function(){var widHei=$(this).height();this.scrollHeight<=$(this).scrollTop()+widHei+25&&PMSCycleManageData.salaryHikeCycle.salaryHikeManageDataAppraiseeViewConstruction(!1,void 0,!0)})}else PMSCycleManageData.salaryhikeManageDataSliderObj.triggerAppraiserFS=!1,void 0!=Scroll&&Scroll||(pageId.find("#manageSalaryTable").html(""),PMSOperationCommon.setNoData(pageId.find("#manageSalaryTable"),ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null))},searchSalaryCycleAppraiseeView:function(){var pageId=$(PMSCycleManageData.salaryhikeManageDataSliderObj.sliderDiv),searchval=pageId.find("#salaryHikeDecider").val();PMSCycleManageData.previouslySearchedText=searchval,PMSCycleManageData.salaryhikeManageDataSliderObj.startIndex=1,pageId.find("#manageSalaryTable").html(""),PMSCycleManageData.salaryHikeCycle.salaryHikeManageDataAppraiseeViewConstruction(!0,searchval,!1)}},PMSCycleManageData.reviewLevel={showReviewLevelSlider:function(selUser,event){event.stopPropagation();const{_mode:_mode}=AppraisalView.getAppraisalViewMode();if(void 0!=PMSCycleManageData.reviewLevelSliderObj.remove&&PMSCycleManageData.reviewLevelSliderObj.remove(),PMSCycleManageData.reviewLevelSliderObj={},0==Object.keys(PMSCycleManageData.reviewLevelSliderObj).length){var sliderTab=new Tab("appraisalreviewlevel",function(){_htm='<div class="zpl_tblres" id="selInfo"></div><div class="zpl_tblres" id="reviewInfo"></div>',$("#cardappraisalreviewlevel").html(_htm)}),userDetails=ZPeople.getUserDetailsById(selUser);PMSCycleManageData.reviewLevelSliderObj=new sliderModal(ZPI18N.getString("zp.reviewlevelofemp",new Array(userDetails.name)),sliderTab),PMSCycleManageData.reviewLevelSliderObj.ftExtraCls="DN",PMSCycleManageData.reviewLevelSliderObj.fullPageSize=!1,PMSCycleManageData.reviewLevelSliderObj.mediumSize=!0,PMSCycleManageData.reviewLevelSliderObj._saveToggle=!1,PMSCycleManageData.reviewLevelSliderObj.setCloseCallback(function(){const{_mode:_mode}=AppraisalView.getAppraisalViewMode();PMSCycleManageData.reviewLevelSliderObj.remove(),PMSCycleManageData.reviewLevelSliderObj={},AppraisalView[_mode].isListView?AppraisalView[_mode].isRefreshListViewPage&&AppraisalView.refreshListView():AppraisalView.cycleManageData[_mode].isRefreshManageAppraisee&&AppraisalView.cycleManageData.refreshManageAppraisalDataPage()}),PMSCycleManageData.reviewLevelSliderObj.construct()}PMSCycleManageData.reviewLevel.constructReviewLevelInit(AppraisalView[_mode].sel_configId,selUser)},constructReviewLevelInit:function(configId,selUser){ApprReview.isModulePage=!1,PMSCycleManageData.reviewLevelSliderObj.sliderDiv.find("#cardappraisalreviewlevel .zpl_tblres").html(ZPeople.LOADING_HTML);var pageId=Layout.Page.container;if(AppraisalView.IS_SELF_HIDE)pageId.find("#cardappraisalreviewlevel #selInfo").addClass("zpl_DNI"),pageId.find("#cardappraisalreviewlevel #selInfo").html("");else{let params={mode:"getselfAppraisalDetails",erecNo:selUser,cycleId:configId,conreqcsr:csrfToken};$.ajax({type:"POST",async:!1,url:"/performanceConfig.zp",data:params,success:function(resultData){pageId.find("#cardappraisalreviewlevel #selInfo").removeClass("zpl_DNI");let header='<table class="zpl_tbl wd100_per"><thead><tr><th width="300">'+ZPI18N.getString("zp.selfappraisal")+"</th>";header+='<th width="150">'+ZPI18N.getString("zp.status")+"</th>",header+='<th></th></tr></thead><tbody id="selfBody"></tbody></tbody></table>',pageId.find("#cardappraisalreviewlevel #selInfo").html(header);var userDtl=AppraisalView[AppraisalView.constant.oprAppraisal].appraiseeData[selUser];let body='<tr><td><div class="zpl_em"><div class="zpl_emimg"><img src="'+userDtl[0].empPhoto+'"/></div><div class="zpl_emds"><div><em>'+userDtl[0].empId+" - </em><b>"+userDtl[0].name+"</b></div></div></td>";if("no_records"===resultData.msg)body+='<td><span class="ylw">'+ZPI18N.getString("zp.pending")+"</td><td></td>";else{var adminAccess=appdataadmin||isadmin;body+='<td><span class="grn">'+ZPI18N.getString("zp.completed")+'</td><td><ul class="zpl_lstbdrlne"><li><a class="blu" onclick="SelfAppr.form.viewandeditrecord(\'\',this,\''+selUser+"','selfappraisal','','"+configId+"','"+resultData.completedCycles[0].recordId+"');\">"+ZPI18N.getString("zp.view")+"</a></li>",5!=resultData.completedCycles[0].configstatus&&(adminAccess||resultData.isAppViewAllowed)&&void 0!=resultData.completedCycles[0].isDraft?body+='<li><a class="red" onclick="PMSCycleManageData.reviewLevel.delSelfForManageAppraisal(\''+resultData.completedCycles[0].recordId+"');\">"+ZPI18N.getString("zp.delete")+"</a></li></ul></ul></td>":body+="</ul></ul></td>",SelfAppr.util.SELFAPPRAISALDETAILBYCONFIGID[configId]=resultData.completedCycles[0],PR.reviewKeysObject.selfRatingLock[configId]=resultData.completedCycles[0].ratingLock,SelfAppr.util.SELFAPPRAISALRATINGFIELDENABLE=resultData.ratingEnable,SelfAppr.util.FINALSCORECARDENABLE=resultData.scoreCardEnable,SelfAppr.util.MODULEINCULDEFORSACYCLELIST=resultData.moduleInCycle}pageId.find("#selfBody").html(body)}})}let params={mode:"getReviewers",employee:selUser,isModulePage:ApprReview.isModulePage,conreqcsr:csrfToken};params.cycleId=configId,$.post("/performanceConfig.zp",params,function(resultData){PMSCycleManageData.reviewLevelSliderObj.sliderDiv.find("#cardappraisalreviewlevel #reviewInfo").html(""),AppraisalConfig.IS_APPVIEW_ALLOWED=void 0!==resultData.isAppViewAllowed&&resultData.isAppViewAllowed,void 0!=resultData.sanmarRoleUser&&null!=resultData.sanmarRoleUser?ApprReview.Reviewer.OTHERROLEUSERS=resultData.sanmarRoleUser:ApprReview.Reviewer.OTHERROLEUSERS=!1,void 0!=resultData.isReviewQuestionEnabled?ApprReview.isReviewQuestionEnabledConfig=resultData.isReviewQuestionEnabled:ApprReview.isReviewQuestionEnabledConfig=!1,AppraisalConfig.selectconfigId=configId,AppraisalConfig.selectUsererecno=selUser,void 0!=resultData.isLocUser&&resultData.isLocUser?AppraisalConfig.isLocUser=!0:AppraisalConfig.isLocUser=!1,ApprReview.Util.HAS_REVIEW=!1,ApprReview.Util.HAS_RATING=!1,ApprReview.Util.HAS_COMMENT=!1;ApprReview.Util.REVIEWLEVEL_DETAILS=resultData.reviewdetails;let parseObj=resultData.reviewdetails,selfNotCompleted=!1;if(parseObj.length>0&&void 0===parseObj[0].msg){let levelsobj=parseObj[0].levelslist[0].userslist;ApprReview.Reviewer.levelsobj=levelsobj;let showselfExtend=!1;void 0!=parseObj[0].showselfExtend&&null!=parseObj[0].showselfExtend&&1==parseObj[0].showselfExtend&&(showselfExtend=!0),void 0!=parseObj[0].selfNotCompleted&&null!=parseObj[0].selfNotCompleted&&1==parseObj[0].selfNotCompleted&&(AppraisalConfig.formUtil.getformDetails("selfappraisal"),selfNotCompleted=!0);let msg=parseObj[0].lockErrorMessage[0].message,lockmsg=msg.split(" ");msg=ZPI18N.getString("zp.review")+"&nbsp;"+ZPI18N.getString("zp.period"),void 0!=lockmsg[2]&&void 0!=lockmsg[4]?msg+="<span>"+lockmsg[2]+" - "+lockmsg[4]+"</span>":msg=ZPI18N.getString("zp.processperiodlockmsg");let userList=[];$.each(levelsobj,function(index,data){void 0===data.userErecno&&void 0!==data.prev_lev_Erecno?userList.push(data.prev_lev_Erecno):void 0!==data.userErecno&&void 0===data.prev_lev_Erecno&&userList.push(data.userErecno)});let userDataList=ZPeople.getUserDetailsByIds(userList);PMSCycleManageData.reviewLevel.constructReviewLevel(resultData,userDataList,msg,selUser)}})},constructReviewLevel:function(resultData,userDataList,msg,selUser){let pageId=PMSCycleManageData.reviewLevelSliderObj.sliderDiv,parseObj=resultData.reviewdetails;var levelsobj=parseObj[0].levelslist[0].userslist;let reviewlocakperiod=void 0!=parseObj[0]&&parseObj[0].reviewperiodlock,noOfUnskippedLevel=levelsobj.length-parseObj[0].noOfSkippedLevel;var adminAccess=isPAdmin||appdataadmin||palocadm&&AppraisalConfig.isLocUser;pageId.find("#cardappraisalreviewlevel #reviewInfo").html("");let header='<table class="zpl_tbl wd100_per"><thead><tr><th width="300">'+ZPI18N.getString("zp.reviewer")+"</th>";header+='<th width="150">'+ZPI18N.getString("zp.status")+"</th>",header+='<th></th></tr></thead><tbody id="reviewleveltbody"></tbody></tbody></table>',pageId.find("#reviewInfo").html(header);let count=0,isReviewed=!1,reviewComp=!1;ApprReview.Util.HAS_REVIEW=!1;let selfNotCompleted=!1;void 0!=parseObj[0].selfNotCompleted&&null!=parseObj[0].selfNotCompleted&&1==parseObj[0].selfNotCompleted&&(selfNotCompleted=!0);let approvalLevelData="",uname="";if($.each(levelsobj,function(index,data){count+=1;let hideUnskip=!1,isReview=!1;void 0===data.userErecno&&void 0!==data.prev_lev_Erecno?userDtl=ZPeople.getUserDetailsByIdInList(data.prev_lev_Erecno,userDataList):void 0!==data.userErecno&&void 0===data.prev_lev_Erecno&&(userDtl=ZPeople.getUserDetailsByIdInList(data.userErecno,userDataList)),""!==userDtl&&void 0!=userDtl&&(uname=userDtl.name),void 0==userDtl&&(userDtl={},userDtl.name="",userDtl.avatar="",userDtl.empid="",userDtl.usererec=data.userErecno);let userHtml="",statusHtml="",actionHtml="";statusHtml='<span class="ylw">'+ZPI18N.getString("zp.pending")+"</span>",adminAccess&&"firstlevel"===data.statusoflevel&&(userHtml='<div class="zpl_em"><div class="zpl_emimg"><img src="'+userDtl.avatar+'"></div><div class="zpl_emdts"> <div><em>'+userDtl.empid+" - </em><b>"+userDtl.name+"</b></div> </div></div>",actionHtml+=reviewlocakperiod?' <li><a class="blu" onclick="ApprReview.Reviewer.showchangeReviewerdiv(this,\''+data.appraisalId+"','"+data.level+"','change');\">"+ZPI18N.getString("zp.changereviewer")+"</a></li>":adminAccess?' <li><a class="ylw">'+ZPI18N.getString("zp.processperiodlockmsg")+"</a></li>":' <li><a class="ylw">'+msg+"</a></li>",!isSanmarUI&&reviewlocakperiod&&"yes"===data.isnxtlevelexist&&count<noOfUnskippedLevel&&noOfUnskippedLevel>1&&("APPRAISER_CHOOSEN_BY_LASTLEVEL"!==levelsobj[levelsobj.length-1].configtype||noOfUnskippedLevel>2||isReviewed)&&(actionHtml+=' <li ><a class="blu" onclick="ApprReview.Reviewer.showSkipReview(this);">'+ZPI18N.getString("zp.skip")+"</a></li>"),reviewlocakperiod&&selfNotCompleted?(actionHtml+=" <li><a class=\"blu\" onclick=\"ApprReview.Reviewer.selfNotCompletePopup(this,'appraisal','"+selUser+"');\">"+ZPI18N.getString("zp.review")+"</a></li>",isReview=!0,ApprReview.Util.HAS_REVIEW=!0):reviewlocakperiod&&(actionHtml+=" <li><a class=\"blu\" onclick=\"ApprReview.Reviewer.showeditreviewpage(this,'appraisal','"+selUser+"');\">"+ZPI18N.getString("zp.review")+"</a></li>",isReview=!0,ApprReview.Util.HAS_REVIEW=!0)),void 0!==data.statusoflevel&&"prDform"===data.statusoflevel&&(userHtml='<div class="zpl_em"><div class="zpl_emdts"> <div><b>PRD</b></div> </div></div>',statusHtml='<span class="grn">'+ZPI18N.getString("zp.completed")+"</span>",actionHtml+=' <li><a class="blu" onclick="NewPASanmar.addPrdComment(\''+data.recordId+"','"+data.formId+"','"+data.viewId+"','"+data.tableName+"');\">"+ZPI18N.getString("zp.view")+"</a></li>"),"previous_level_yetto_add"===data.statusoflevel&&"REPORTING_TO"===data.configtype&&(userHtml='<div class="zpl_em"><div class="zpl_emimg"><img src="'+userDtl.avatar+'"></div><div class="zpl_emdts"> <div><em>'+userDtl.empid+" - </em><b>"+userDtl.name+"</b></div> </div></div>",!isSanmarUI&&reviewlocakperiod&&(adminAccess||AppraisalConfig.IS_APPVIEW_ALLOWED)&&noOfUnskippedLevel>1&&("APPRAISER_CHOOSEN_BY_LASTLEVEL"!==levelsobj[levelsobj.length-1].configtype||noOfUnskippedLevel>2||isReviewed)&&(actionHtml+=' <li><a class="blu" onclick="ApprReview.Reviewer.showSkipReview(this);">'+ZPI18N.getString("zp.skip")+"</a></li>")),void 0===data.statusoflevel||"previous_level_yetto_add"!==data.statusoflevel||"SELECTED_USER"!==data.configtype&&"FORM_FIELD"!==data.configtype&&"DEPARTMENT_HEAD_OF_LOGIN_USER"!==data.configtype&&"PROJECT_MANAGER_APPROVAL"!==data.configtype||(userHtml='<div class="zpl_em"><div class="zpl_emimg"><img src="'+userDtl.avatar+'"></div><div class="zpl_emdts"> <div><em>'+userDtl.empid+" - </em><b>"+userDtl.name+"</b></div> </div></div>",!isSanmarUI&&reviewlocakperiod&&(adminAccess||AppraisalConfig.IS_APPVIEW_ALLOWED)&&noOfUnskippedLevel>1&&("APPRAISER_CHOOSEN_BY_LASTLEVEL"!==levelsobj[levelsobj.length-1].configtype||noOfUnskippedLevel>2||isReviewed)&&(actionHtml+=' <li><a class="blu" onclick="ApprReview.Reviewer.showSkipReview(this);">'+ZPI18N.getString("zp.skip")+"</a></li>")),void 0!==data.statusoflevel&&"previous_level_yetto_add"===data.statusoflevel&&"APPRAISER_CHOOSEN_BY_LASTLEVEL"===data.configtype&&(userHtml='<div class="zpl_em" title="'+ZPI18N.getString("zp.yettofinallevelappraiser")+'"><div class="zpl_emimg"></div><div class="zpl_emdts"> <div><em></em><b>?</b></div> </div></div>',erecno===userDtl.usererec||adminAccess?actionHtml+=reviewlocakperiod?' <li><a class="blu" onclick="ApprReview.Reviewer.showchangeReviewerdiv(this,\''+data.appraisalId+"','"+data.level+"','add');\">"+ZPI18N.getString("zp.addreviewer")+"</a></li>":adminAccess?' <li><a class="ylw">'+ZPI18N.getString("zp.processperiodlockmsg")+"</a></li>":' <li><a class="ylw">'+msg+"</a></li>":actionHtml+=' <li><a class="ylw">'+uname+" "+ZPI18N.getString("zp.willchoosereviewer")+"</a></li>"),void 0!==data.statusoflevel&&"previous_level_yetto_rate"===data.statusoflevel&&"APPRAISER_CHOOSEN_BY_LASTLEVEL"===data.configtype&&(userHtml='<div class="zpl_em" title="'+ZPI18N.getString("zp.yettofinallevelappraiser")+'"><div class="zpl_emimg"></div><div class="zpl_emdts"> <div><em></em><b>?</b></div> </div></div>',actionHtml+=' <li><a class="ylw">'+uname+" "+ZPI18N.getString("zp.willchoosereviewer")+"</a></li>"),-1===data.statusoflevel&&"APPRAISER_CHOOSEN_BY_LASTLEVEL"===data.configtype&&(userHtml='<div class="zpl_em" title="'+ZPI18N.getString("zp.yettofinallevelappraiser")+'"><div class="zpl_emimg"></div><div class="zpl_emdts"> <div><em></em><b>?</b></div> </div></div>',erecno===userDtl.usererec||adminAccess?actionHtml+=reviewlocakperiod?' <li><a class="blu" onclick="ApprReview.Reviewer.showchangeReviewerdiv(this,\''+data.appraisalId+"','"+data.level+"','add');\">"+ZPI18N.getString("zp.addreviewer")+"</a></li>":adminAccess?' <li><a class="ylw">'+ZPI18N.getString("zp.processperiodlockmsg")+"</a></li>":' <li><a class="ylw">'+msg+"</a></li>":actionHtml+=' <li><a class="ylw">'+ZPI18N.getString("zp.willchoosereviewer")+"</a></li>"),void 0===data.statusoflevel||"1"!==data.statusoflevel&&"2"!==data.statusoflevel||(finallevelData=data,userHtml='<div class="zpl_em"><div class="zpl_emimg"><img src="'+userDtl.avatar+'"></div><div class="zpl_emdts"> <div><em>'+userDtl.empid+" - </em><b>"+userDtl.name+"</b></div> </div></div>",""!==data.ratingval?RatingHtml="<span><a>"+data.ratingval+"</a></span>":isSanmarUI&&isPAdmin&&(actionHtml+=' <li><a class="blu" onclick="ApprReview.Reviewer.showchangeReviewerdiv(this,\''+data.appraisalId+"','"+data.level+"','change');\">"+ZPI18N.getString("zp.changereviewer")+"</a></li>"),actionHtml+=' <li><a class="blu" onclick="ApprReview.Util.viewandeditrecord(\''+data.level+"',this,'"+selUser+"','appraisal');\">"+ZPI18N.getString("zp.view")+"</a></li>",statusHtml='<span class="grn">'+ZPI18N.getString("zp.completed")+"</span>",reviewComp=!0,isReviewed=!0,hideUnskip=!0),void 0===data.statusoflevel||"0"!==data.statusoflevel&&"-3"!==data.statusoflevel&&"-4"!==data.statusoflevel||(userHtml='<div class="zpl_em"><div class="zpl_emimg"><img src="'+userDtl.avatar+'"></div><div class="zpl_emdts"> <div><em>'+userDtl.empid+" - </em><b>"+userDtl.name+"</b></div> </div></div>",""!==data.ratingval?RatingHtml="<span><a>"+data.ratingval+"</a></span>":isSanmarUI&&isPAdmin?actionHtml+=' <li><a class="blu" onclick="ApprReview.Reviewer.showchangeReviewerdiv(this,\''+data.appraisalId+"','"+data.level+"','change');\">"+ZPI18N.getString("zp.changereviewer")+"</a></li>":!isSanmarUI&&(adminAccess||AppraisalConfig.IS_APPVIEW_ALLOWED)&&reviewlocakperiod&&noOfUnskippedLevel>1&&("APPRAISER_CHOOSEN_BY_LASTLEVEL"!==levelsobj[levelsobj.length-1].configtype||noOfUnskippedLevel>2||isReviewed)&&(actionHtml+=' <li><a class="blu" onclick="ApprReview.Reviewer.showSkipReview(this);">'+ZPI18N.getString("zp.skip")+"</a></li>"),erecno===userDtl.usererec&&reviewlocakperiod&&data.shwreviewbtn&&selfNotCompleted?(actionHtml+=" <li><a class=\"blu\" onclick=\"ApprReview.Reviewer.selfNotCompletePopup(this,'appraisal','"+selUser+"');\">"+ZPI18N.getString("zp.review")+"</a></li>",isReview=!0,ApprReview.Util.HAS_REVIEW=!0):erecno===userDtl.usererec&&reviewlocakperiod&&data.shwreviewbtn?(actionHtml+=" <li><a class=\"blu\" onclick=\"ApprReview.Reviewer.showeditreviewpage(this,'appraisal','"+selUser+"');\">"+ZPI18N.getString("zp.review")+"</a></li>",isReview=!0,ApprReview.Util.HAS_REVIEW=!0):adminAccess||AppraisalConfig.IS_APPVIEW_ALLOWED&&reviewlocakperiod?reviewlocakperiod&&data.shwreviewbtn?reviewlocakperiod&&data.shwreviewbtn&&selfNotCompleted?(actionHtml+=" <li><a class=\"blu\" onclick=\"ApprReview.Reviewer.selfNotCompletePopup(this,'appraisal','"+selUser+"');\">"+ZPI18N.getString("zp.review")+"</a></li>",isReview=!0,ApprReview.Util.HAS_REVIEW=!0):(actionHtml+=" <li><a class=\"blu\" onclick=\"ApprReview.Reviewer.showeditreviewpage(this,'appraisal','"+selUser+"');\">"+ZPI18N.getString("zp.review")+"</a></li>",isReview=!0,ApprReview.Util.HAS_REVIEW=!0):reviewlocakperiod||(actionHtml+=' <li><a class="ylw">'+ZPI18N.getString("zp.processperiodlockmsg")+"</a></li>"):reviewlocakperiod||erecno!==userDtl.usererec||(actionHtml+=' <li><a class="blu"></a></li>')),"-1"===data.statusoflevel&&(userHtml='<div class="zpl_em"><div class="zpl_emimg"><img src="'+userDtl.avatar+'"></div><div class="zpl_emdts"> <div><em>'+userDtl.empid+" - </em><b>"+userDtl.name+"</b></div> </div></div>",""!==data.ratingval?RatingHtml="<span><a>"+data.ratingval+"</a></span>":isSanmarUI&&isPAdmin&&(actionHtml+=' <li><a class="blu" onclick="ApprReview.Reviewer.showchangeReviewerdiv(this,\''+data.appraisalId+"','"+data.level+"','change');\">"+ZPI18N.getString("zp.changereviewer")+"</a></li>"),actionHtml+=' <li><a class="blu" onclick="ApprReview.Util.viewandeditrecord(\''+data.level+"',this,'"+selUser+"','appraisal');\">"+ZPI18N.getString("zp.view")+"</a></li>",statusHtml='<span class="grn">'+ZPI18N.getString("zp.completed")+"</span>",isReviewed=!0,hideUnskip=!0),"-5"===data.statusoflevel&&(userHtml='<div class="zpl_em"><div class="zpl_emimg"><img src="'+userDtl.avatar+'"></div><div class="zpl_emdts"> <div><em>'+userDtl.empid+" - </em><b>"+userDtl.name+"</b></div> </div></div>",isSanmarUI||!reviewlocakperiod||!adminAccess&&!AppraisalConfig.IS_APPVIEW_ALLOWED||reviewComp||(actionHtml+=' <li name="unskipReview"><a class="blu" onclick="ApprReview.Reviewer.showSkipReview(this,true);">'+ZPI18N.getString("zp.undoskip")+"</a></li>"),statusHtml="<span>"+ZPI18N.getString("zp.skiped")+"</span>"),row="<tr><td>"+userHtml+"</td>",row+="<td>"+statusHtml+"</td>",row+='<td><ul class="zpl_lstbdrlne">'+actionHtml+" </ul></td></tr>",row=$(row),row.data("dataval",data),row.data("userDtl",userDtl),row.attr("isReview",isReview),pageId.find("#reviewleveltbody").append(row),$($(row).find(".zpl_dots")[0]).remove(),hideUnskip&&$('[name="unskipReview"]').hide(),void 0!=data.reviewApprovalEnable&&1==data.reviewApprovalEnable&&void 0!=data.approvalStatus&&"1"!=data.approvalStatus&&(approvalLevelData=data)}),""!=approvalLevelData){let reviewApprDiv=pageId.find("#reviewleveltbody tr:last").find("td:last"),html="";html=void 0!=approvalLevelData.approvalStatus&&"0"==approvalLevelData.approvalStatus?'<li><a id="sendapproval" class="blu" title="'+ZPI18N.getString("zp.approvalRejReviewMsg")+'" ownerid="'+approvalLevelData.userErecno+'" raterid="'+approvalLevelData.userErecno+'" onclick="ApprReview.Util.viewandeditrecord(\''+approvalLevelData.level+"',this,'"+selUser+"','appraisal');\">"+ZPI18N.getString("zp.resendTxt")+"</a></li>":void 0!=approvalLevelData.approvalStatus&&"-1"==approvalLevelData.approvalStatus?'<li><a class="ylw" title="'+ZPI18N.getString("zp.reviewApprovalPendMsg")+'" >'+ZPI18N.getString("zp.waitforapproval")+"</a></li>":void 0!=approvalLevelData.approvalStatus&&"1"==approvalLevelData.approvalStatus?'<li><a class="grn" title="'+ZPI18N.getString("zp.reviewApproved")+'" >'+ZPI18N.getString("zp.reviewApproved")+"</a></li>":'<li><a id="sendapproval" class="blu" title="'+ZPI18N.getString("zp.reviewApprovalSendMsg")+'" onclick="ApprReview.Approval.sendApprovalForFinalRecord(\''+approvalLevelData.appraisalId+"','"+approvalLevelData.configId+"');\">"+ZPI18N.getString("zp.sendforapproval")+"</a></li>",reviewApprDiv.find(".zpl_lstbdrlne").append(html)}},delSelfForManageAppraisal:function(recordId1){var deleteSelfInfo=new DeleteAlertMessage;deleteSelfInfo.title="",deleteSelfInfo.despcription=ZPI18N.getString("zp.deleteconfirmmessage"),deleteSelfInfo.yesButtonText=ZPI18N.getString("zp.confirm"),deleteSelfInfo.callback=function(){var params={mode:"delselfApp",recordId:recordId1,conreqcsr:csrfToken,erecNo:AppraisalConfig.selectUsererecno};$.post("/performanceConfig.zp",params,function(resultData){if(void 0!==resultData)if(resultData.flag){let pageId=Layout.Page.container;ZPeople.Message.success(ZPI18N.getString("zp.recorddeletedsuccessfully")),pageId.find("#selInfo").remove()}else ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied"))})},deleteSelfInfo.show()}},PMSReminderConfig={PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG:"PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG",REMINDER_TYPE:["PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG"],REMINDER_CONFIG:{},WEEKLY_REMINDER:"1",START_DATE:"2",REMINDER_CONFIG_TYPE:{1:ZPI18N.getString("zp.pareminder.everyweek"),2:ZPI18N.getString("zp.sdate")},EVERY_WEEK_OPTION:{1:ZPI18N.getString("zp.sunday"),2:ZPI18N.getString("zp.monday"),3:ZPI18N.getString("zp.tuesday"),4:ZPI18N.getString("zp.wednesday"),5:ZPI18N.getString("zp.thursday"),6:ZPI18N.getString("zp.friday"),7:ZPI18N.getString("zp.saturday")},setReminderConfiguration:function(resultData,reminderType){PMSReminderConfig.REMINDER_CONFIG[reminderType]=resultData},deleteReminderConfiguration:function(reminderType){delete PMSReminderConfig.REMINDER_CONFIG[reminderType]},isSkippedConfigType:function(reminderType,configType){return reminderType==PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG&&configType==PMSReminderConfig.START_DATE},constructReminderRow:function(reminderType,count){let rowhtml="";rowhtml+='<div class="zpl_idiv" Count="'+count+'" id="'+reminderType+"_"+count+'">\t<div id="'+reminderType+"_"+count+'_Div1"><select id="'+reminderType+"_"+count+'_ConfigTypeselect">';for(const key in PMSReminderConfig.REMINDER_CONFIG_TYPE)PMSReminderConfig.REMINDER_CONFIG_TYPE.hasOwnProperty(key)&&!PMSReminderConfig.isSkippedConfigType(reminderType,key)&&(rowhtml+='<option value="'+key+'">'+PMSReminderConfig.REMINDER_CONFIG_TYPE[key]+"</option>");return rowhtml+="</select></div>",rowhtml+='<div id="'+reminderType+"_"+count+'_Div2"></div><div id="'+reminderType+"_"+count+'_Div3"></div></div>'},insertReminderRow:function(reminderType,count){var html=PMSReminderConfig.constructReminderRow(reminderType,count);Layout.Page.container.find("#"+reminderType).append(html),ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigTypeselect"),1==Layout.Page.container.find("#"+reminderType+"_"+count+"_ConfigTypeselect").find("option").length&&ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigTypeselect").setAttribute("disabled","disabled"),Layout.Page.container.find("#"+reminderType+"_"+count+"_ConfigTypeselect").on("zselectchange",PMSReminderConfig.onChangeReminderConfigTypeSelect),PMSReminderConfig.constrctSecondaryDiv(reminderType,count)},constrctSecondaryDiv:function(reminderType,count){if(Layout.Page.container.find("#"+reminderType+"_"+count+"_Div2").html(""),Layout.Page.container.find("#"+reminderType+"_"+count+"_Div3").html(""),ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigTypeselect").getValue()==PMSReminderConfig.WEEKLY_REMINDER){let html='<select id="'+reminderType+"_"+count+'_ConfigSecMulselect" class="select" type="valFld" data-show-search-field="true" style="display: none;width: 230px;" multiple="true">';for(const key in PMSReminderConfig.EVERY_WEEK_OPTION)html+='<option value="'+key+'">'+PMSReminderConfig.EVERY_WEEK_OPTION[key]+"</option>";html+="</select>",Layout.Page.container.find("#"+reminderType+"_"+count+"_Div2").html(html);let selOpt=Layout.Page.container.find("#"+reminderType+"_"+count+"_ConfigSecMulselect");ZPeopleComponents.select(selOpt,{dropdownList:{appendTo:Layout.Page.container,fitForElement:!0}}),Layout.Page.container.find("#"+reminderType+"_"+count+"_ConfigSecMulselect").on("zselectchange",PMSReminderConfig.onChangeReminderConfigSecSelect)}},onChangeReminderConfigSecSelect:function(event){let reminderType="",count="";for(var index=0;index<PMSReminderConfig.REMINDER_TYPE.length;index++){var key=PMSReminderConfig.REMINDER_TYPE[index],id=$(event.currentTarget).attr("id");-1!=id.indexOf(key)&&(reminderType=key,count=id.replace(key+"_","").replace("_ConfigSecMulselect",""))}reminderType==PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG&&PMSSetting.goalSettingNewJoineeValueChange()},constructReminderSection:function(reminderType){if(void 0!=PMSReminderConfig.REMINDER_CONFIG[reminderType]){let configArr=PMSReminderConfig.REMINDER_CONFIG[reminderType];for(var index=0;index<configArr.length;index++)if(!PMSReminderConfig.isSkippedConfigType(reminderType,configArr[index].reminderConfigType)){let count=index+1;PMSReminderConfig.insertReminderRow(reminderType,count),PMSReminderConfig.setValueSingleRow(reminderType,count,configArr[index])}}else PMSReminderConfig.insertReminderRow(reminderType,1)},setValueSingleRow:function(reminderType,count,configObj){ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigTypeselect").setValue(configObj.reminderConfigType),configObj.reminderConfigType==PMSReminderConfig.WEEKLY_REMINDER&&ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigSecMulselect").setValue(configObj.reminderConfigDetails)},removeReminderRow:function(reminderType,count){let reminderConfigType=ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigTypeselect").getValue();ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigTypeselect").destroy(),reminderConfigType==PMSReminderConfig.WEEKLY_REMINDER&&ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigSecMulselect").destroy(),Layout.Page.container.find("#"+reminderType+"_"+count).remove()},removeAllReminderRow:function(reminderType){let elementArr=Layout.Page.container.find("#"+reminderType).find(".zpl_idiv");for(var index=0;index<elementArr.length;index++){let element=elementArr[index],count=$(element).attr("Count");PMSReminderConfig.removeReminderRow(reminderType,count)}Layout.Page.container.find("#"+reminderType).html("")},getExecutionTime:function(reminderType){let exeTime=ZPeopleComponents.timefield(Layout.Page.container.find("#"+reminderType+"_exeTime")).getValue().dateString;if(-1!=timeFormat.indexOf("hh")){let[timePart,period]=exeTime.split(" "),[hours,minutes]=timePart.split(":");hours=parseInt(hours,10),"PM"===period&&12!==hours?hours+=12:"AM"===period&&12===hours&&(hours=0),exeTime=(hours=hours<10?"0"+hours:hours)+":"+minutes}return exeTime},getCurrentRowObj:function(reminderType,count){let reminderConfigObj={};return reminderConfigObj.reminderConfigType=ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigTypeselect").getValue(),reminderConfigObj.executiontime=PMSReminderConfig.getExecutionTime(reminderType),reminderConfigObj.reminderConfigType==PMSReminderConfig.WEEKLY_REMINDER&&(reminderConfigObj.weeklyDays=ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigSecMulselect").getValue()),reminderConfigObj},getReminderConfig:function(reminderType){let reminderConfigArr=new Array,elementArr=Layout.Page.container.find("#"+reminderType).find(".zpl_idiv");for(var index=0;index<elementArr.length;index++){let element=elementArr[index],count=$(element).attr("Count");reminderConfigArr.push(PMSReminderConfig.getCurrentRowObj(reminderType,count))}if(reminderType==PMSReminderConfig.PA_GOAL_SETTINGS_NEWJOINEE_REMINDER_CONFIG&&Layout.Page.container.find("#newjoineedojnotification").is(":checked")){let reminderConfigObj={};reminderConfigObj.reminderConfigType=PMSReminderConfig.START_DATE,reminderConfigObj.executiontime=PMSReminderConfig.getExecutionTime(reminderType),reminderConfigArr.push(reminderConfigObj)}return reminderConfigArr},onChangeReminderConfigTypeSelect:function(event){let reminderType="",count="";for(var index=0;index<PMSReminderConfig.REMINDER_TYPE.length;index++){var key=PMSReminderConfig.REMINDER_TYPE[index],id=$(event.currentTarget).attr("id");-1!=id.indexOf(key)&&(reminderType=key,count=id.replace(key+"_","").replace("_ConfigTypeselect",""))}""!=reminderType&&(Layout.Page.container.find("#"+reminderType+"_"+count+"_Div2").find("#"+reminderType+"_"+count+"_ConfigSecMulselect").length>0&&ZPeopleComponents.select(Layout.Page.container.find("#"+reminderType+"_"+count+"_Div2").find("#"+reminderType+"_"+count+"_ConfigSecMulselect")).destroy(),PMSReminderConfig.constrctSecondaryDiv(reminderType,count))},valiateReminderRow:function(reminderType,count,markInvalid){let isValid=!0;if(ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigTypeselect").getValue()==PMSReminderConfig.WEEKLY_REMINDER){ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigSecMulselect").getValue().length<=0&&(isValid=!1,markInvalid&&ZPeopleComponents.select("#"+reminderType+"_"+count+"_ConfigSecMulselect").getElement().addClass("ztextbox__error"))}return isValid},valiateReminderSection:function(reminderType,markInvalid){let isValidSection=!0,elementArr=Layout.Page.container.find("#"+reminderType).find(".zpl_idiv");for(var index=0;index<elementArr.length;index++){let element=elementArr[index],count=$(element).attr("Count");PMSReminderConfig.valiateReminderRow(reminderType,count,markInvalid)||(isValidSection=!1)}let exeTime=ZPeopleComponents.timefield(Layout.Page.container.find("#"+reminderType+"_exeTime")).getValue().dateString;return-1==exeTime.indexOf("HH")&&-1==exeTime.indexOf("hh")&&-1==exeTime.indexOf("mm")||(isValidSection=!1),isValidSection},isValueChanged:function(reminderType){let reminderConfigArr=PMSReminderConfig.getReminderConfig(reminderType),oldReminderConfigArr=void 0!=PMSReminderConfig.REMINDER_CONFIG[reminderType]?PMSReminderConfig.REMINDER_CONFIG[reminderType]:new Array;if(0==reminderConfigArr.length&&0==oldReminderConfigArr.length)return!1;if(reminderConfigArr.length!=oldReminderConfigArr.length)return!0;for(var index=0;index<reminderConfigArr.length;index++){let reminderConfig=reminderConfigArr[index],oldReminderConfig=oldReminderConfigArr[index];if(reminderConfig.reminderConfigType!=oldReminderConfig.reminderConfigType)return!0;if(reminderConfig.executiontime!=oldReminderConfig.executiontime)return!0;if(reminderConfig.reminderConfigType==PMSReminderConfig.WEEKLY_REMINDER){if(reminderConfig.weeklyDays.length!=oldReminderConfig.weeklyDays.length)return!0;{let arr1=reminderConfig.weeklyDays.sort(),arr2=oldReminderConfig.weeklyDays.sort();for(let i=0;i<arr1.length;i++)if(arr1[i]!==arr2[i])return!0}}}return!1}};