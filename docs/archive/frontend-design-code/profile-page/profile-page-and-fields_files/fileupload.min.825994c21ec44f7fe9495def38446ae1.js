CloudPicker={fileObj:"",uploadMode:"cloud",sliderModelId:"",callback:"",extraProps:{},bodyHTML:function(cloudPickerUrl){return void 0!=cloudPickerUrl?'<div id="cloud_picker" class="zpl_mdl zpl_mcenter zpl_mopen" data-modal-box="center" style="z-index:999"><div class="zpl_minr"><div class="zpl_mhder"><div><h4>'+ZPI18N.getString("zp.files.uploadfromcloud")+'</h4></div><a class="_cls PI_cls" onClick=CloudPicker.closePopup("cloud_picker")></a></div><div class="zpl_mcnt zpl_fm"><form><iframe frameborder="0" style="width:100%; height:530px;" src='+cloudPickerUrl+'></iframe></form></div><div class="zpl_mfoter"></div></div></div>':'<div id="cloud_picker" class="zpl_mdl zpl_mcenter zpl_mopen" data-modal-box="center" style="z-index:999"><div class="zpl_minr"><div class="zpl_mhder"><div><h4>'+ZPI18N.getString("zp.files.uploadfromcloud")+'</h4></div><a class="_cls PI_cls" onClick=CloudPicker.closePopup("cloud_picker")></a></div><div class="zpl_mcnt zpl_fm"><form><iframe frameborder="0" style="width:100%; height:530px;" src='+ZPeople.cloudPickerGadgetsUrl+'></iframe></form></div><div class="zpl_mfoter"></div></div></div>'},init:function(id,fn,origin,extraProps){CloudPicker.sliderModelId=id,CloudPicker.callback=fn,CloudPicker.cloudUploadOrigin=origin,null!=extraProps&&void 0!=extraProps&&""!=extraProps&&(CloudPicker.extraProps=extraProps)},execute:function(docObj){CloudPicker.closePopup(),CloudPicker.fileObj=docObj,CloudPicker.callback(CloudPicker.extraProps)},construct:function(cloudPickerUrl){""==CloudPicker.sliderModelId?$(settingsPage.mainWrapId).append(CloudPicker.bodyHTML(cloudPickerUrl)):$("#"+CloudPicker.sliderModelId).append(CloudPicker.bodyHTML(cloudPickerUrl)),window.addEventListener("message",CloudPicker.cloudPickercallBack)},closePopup:function(){$("#cloud_picker").remove(),window.removeEventListener("message",CloudPicker.cloudPickercallBack)},getFileObj:function(){return CloudPicker.fileObj},cloudPickercallBack:function(e){if(e.origin===gadgetsUrl){var data=e.data;if("closePicker"===data)return void CloudPicker.closePopup();var DataModelProviders={ZOHODOCS:"zohodocs",GDRIVE:"gdrive",DROPBOX:"dropbox",EVERNOTE:"evernote",BOX:"box",OFFICE365:"office365",ONEDRIVE:"onedrive"},docObj={},totalFiles=0,uploadedDocObj={};if(void 0!=data.doc&&(docObj=data.doc),void 0!=data.totalFiles){if(1===(totalFiles=data.totalFiles)&&void 0!=data.doc){if(void 0!=docObj[DataModelProviders.GDRIVE].accountId)(uploadedDocObj=docObj[DataModelProviders.GDRIVE].files[0]).accountId=docObj[DataModelProviders.GDRIVE].accountId,uploadedDocObj.provider=DataModelProviders.GDRIVE;else if(void 0!=docObj[DataModelProviders.DROPBOX].accountId)(uploadedDocObj=docObj[DataModelProviders.DROPBOX].files[0]).accountId=docObj[DataModelProviders.DROPBOX].accountId,uploadedDocObj.provider=DataModelProviders.DROPBOX;else if(void 0!=docObj[DataModelProviders.EVERNOTE].accountId)(uploadedDocObj=docObj[DataModelProviders.EVERNOTE].files[0]).accountId=docObj[DataModelProviders.EVERNOTE].accountId,uploadedDocObj.provider=DataModelProviders.EVERNOTE;else if(void 0!=docObj[DataModelProviders.BOX].accountId)(uploadedDocObj=docObj[DataModelProviders.BOX].files[0]).accountId=docObj[DataModelProviders.BOX].accountId,uploadedDocObj.provider=DataModelProviders.BOX;else if(void 0!=docObj[DataModelProviders.ONEDRIVE].accountId){var files=docObj[DataModelProviders.ONEDRIVE].files[0];uploadedDocObj.accountId=docObj[DataModelProviders.ONEDRIVE].accountId,uploadedDocObj.docId=files.id,uploadedDocObj.docName=files.name,uploadedDocObj.mimeType=files.file.mimeType,uploadedDocObj.provider=DataModelProviders.ONEDRIVE}var docName=uploadedDocObj.docName,docType=void 0!=uploadedDocObj.docType?uploadedDocObj.docType:"";docName.indexOf(".")<0&&("document"===docType||"writer"===docType?docName+=".docx":"presentation"===docType||"zohoshow"===docType?docName+=".pptx":"spreadsheet"===docType||"zohosheet"===docType?docName+=".xlsx":"pdf"===docType&&(docName+=".pdf")),uploadedDocObj.docName=docName}else if(totalFiles>1&&void 0!=data.doc){var uploadedDocObjarray=[],fileIndex=0;void 0!=docObj[DataModelProviders.GDRIVE].accountId&&$.each(docObj[DataModelProviders.GDRIVE].files,function(ind,files){uploadedDocObjarray[fileIndex]=files,uploadedDocObjarray[fileIndex].accountId=docObj[DataModelProviders.GDRIVE].accountId,uploadedDocObjarray=CloudPicker.cloudPickerFileType(uploadedDocObjarray,fileIndex,DataModelProviders.GDRIVE),fileIndex+=1}),void 0!=docObj[DataModelProviders.DROPBOX].accountId&&$.each(docObj[DataModelProviders.DROPBOX].files,function(ind,files){uploadedDocObjarray[fileIndex]=files,uploadedDocObjarray[fileIndex].accountId=docObj[DataModelProviders.DROPBOX].accountId,uploadedDocObjarray=CloudPicker.cloudPickerFileType(uploadedDocObjarray,fileIndex,DataModelProviders.DROPBOX),fileIndex+=1}),void 0!=docObj[DataModelProviders.EVERNOTE].accountId&&$.each(docObj[DataModelProviders.EVERNOTE].files,function(ind,files){uploadedDocObjarray[fileIndex]=files,uploadedDocObjarray[fileIndex].accountId=docObj[DataModelProviders.EVERNOTE].accountId,uploadedDocObjarray=CloudPicker.cloudPickerFileType(uploadedDocObjarray,fileIndex,DataModelProviders.EVERNOTE),fileIndex+=1}),void 0!=docObj[DataModelProviders.BOX].accountId&&$.each(docObj[DataModelProviders.BOX].files,function(ind,files){uploadedDocObjarray[fileIndex]=files,uploadedDocObjarray[fileIndex].accountId=docObj[DataModelProviders.BOX].accountId,uploadedDocObjarray=CloudPicker.cloudPickerFileType(uploadedDocObjarray,fileIndex,DataModelProviders.BOX),fileIndex+=1}),void 0!=docObj[DataModelProviders.ONEDRIVE].accountId&&$.each(docObj[DataModelProviders.ONEDRIVE].files,function(ind,files){uploadedDocObjarray[fileIndex]={},uploadedDocObjarray[fileIndex].accountId=docObj[DataModelProviders.ONEDRIVE].accountId,uploadedDocObjarray[fileIndex].docId=files.id,uploadedDocObjarray[fileIndex].docName=files.name,uploadedDocObjarray[fileIndex].mimeType=files.file.mimeType,uploadedDocObjarray=CloudPicker.cloudPickerFileType(uploadedDocObjarray,fileIndex,DataModelProviders.ONEDRIVE),fileIndex+=1}),uploadedDocObj.values=uploadedDocObjarray}CloudPicker.execute(JSON.stringify(uploadedDocObj))}}},cloudPickerFileType:function(uploadedDocObj,value,source){var docNames=uploadedDocObj[value],docName=docNames.docName,docType=void 0!=docNames.docType?docNames.docType:"";return docName.indexOf(".")<0&&("document"==docType||"writer"==docType?docName+=".docx":"presentation"==docType||"zohoshow"==docType?docName+=".pptx":"spreadsheet"==docType||"zohosheet"==docType?docName+=".xlsx":"pdf"==docType&&(docName+=".pdf")),uploadedDocObj[value].provider=source,uploadedDocObj[value].docName=docName,uploadedDocObj}},WorkDriveInt={fileObj:"",chainCallBack:void 0,showWorkDriveModal:function(workDriveOrigin,fcId,ele,isImage,callBack){if(0==$("head").find('script[src="'+ZPeople.STATIC_CDN+'/personal/stable/jsapps/workdrive-third-party/workdrive-frame-sdk.js"]').length){var script=document.createElement("script");return script.type="text/javascript",script.readyState?script.onreadystatechange=function(){"loaded"!==script.readyState&&"complete"!==script.readyState||(script.onreadystatechange=null,WorkDriveInt.showWorkDriveModal(workDriveOrigin,fcId,ele,isImage,callBack))}:script.onload=function(){WorkDriveInt.showWorkDriveModal(workDriveOrigin,fcId,ele,isImage,callBack)},script.src=ZPeople.STATIC_CDN+"/personal/stable/jsapps/workdrive-third-party/workdrive-frame-sdk.js",void document.head.appendChild(script)}var rowNum="1",isGridTabular=!1;"true"==$(ele).closest("[istabular]").attr("istabular")&&("true"==$(ele).closest("[isgrid]").attr("isgrid")?(isGridTabular=!0,rowNum=$(ele).closest('[id="zp_tabular_row"]').attr("row")):rowNum=$(ele).closest('[isgrid="false"]').attr("row"));var workdriveinstance=new WorkDrive,Options={service:"zohopeople"};Options.WDDomainURL=workDriveUrl,Options.height="75%",Options.width="50%",Options.responseCallBack=WorkDriveInt.saveWorkDrive,Options.showCloseIcon=!0,Options.canShare=!0,Options.disableFolderSelection=!0,"fileimport"==workDriveOrigin?Options.countToSelectMaxFiles=50:"TTProjectDashBoard"==workDriveOrigin&&(Options.countToSelectMaxFiles=5);var shareOptions={showshareDialog:!0},shareFields={collaboratorShare:!1,teamShare:!0,orgShare:!0};shareFields.externalShare=null==isImage||void 0===isImage||"true"!=isImage||"Forms"!==workDriveOrigin,shareFields.linkOnly=!0,shareOptions.shareFields=shareFields,shareOptions.defaultShare="teamShare",Options.shareOptions=shareOptions;var obj={};obj.workDriveOrigin=workDriveOrigin,obj.fcId=fcId,obj.rowNum=rowNum,obj.isGridTabular=isGridTabular,callBack&&(WorkDriveInt.chainCallBack=callBack),Options.handBackObj=obj,Options.componentType="pick",workdriveinstance.loadPicker(Options)},saveWorkDrive:function(object){$("body").find("#zp_upload_wd").removeClass("active");var filesModel=(object=JSON.parse(JSON.stringify(object))).callbackDataFromWorkDrive.fileModel[0],docDispName=filesModel.name,obj={};object.type=filesModel.type,object.fileName=docDispName,object.permalink=object.callbackDataFromWorkDrive.permissionModel[0].link;var origin=object.callbackDataFromWorkDrive.handbackobj.workDriveOrigin;if(WorkDriveInt.fileObj=object,"Forms"===origin)(obj={}).type=object.type,obj.permalink=object.permalink,obj.fileName=object.fileName,obj.fcId=object.callbackDataFromWorkDrive.handbackobj.fcId,obj.rowNum=object.callbackDataFromWorkDrive.handbackobj.rowNum,ZP5Form.FILEUPLOAD_IMAGES.workDriveCallBack(obj);else if("AddCgyRef"==origin){(obj={}).type=object.type,obj.fileName=object.fileName,obj.permalink=object.permalink,casesSettings.CategoryModal.referenceFileRowHtml(obj,"workDriveUpload")}else if("AddCase"==origin){(obj={}).type=object.type,obj.fileName=object.fileName,obj.permalink=object.permalink,obj.labelName="case_attachment",CasesFiles.zohoUpload(obj)}else if("AddFAQ"==origin){(obj={}).type=object.type,obj.fileName=object.fileName,obj.permalink=object.permalink,obj.labelName="attachment",CasesFilesCommon.setFileBoxAndTag("workDriveUpload",obj,"attachment")}else if("fileimport"===origin){for(var mainObj=Layout.Page.container.find("div#import_hrfileDiv"),filesList=object.callbackDataFromWorkDrive.fileModel,importarray=[],i=0;i<filesList.length;i++){(importobj={}).fileName=filesList[i].name,importobj.permalink=obj.permalink,importarray.push(importobj)}Files.importWDarray=importarray;var len=object.callbackDataFromWorkDrive.fileModel.length;mainObj.find("#importFileName").empty().text(len+" Files"),mainObj.find("#beforeUpload").hasClass("DN")||mainObj.find("#beforeUpload").toggleClass("DN"),mainObj.find("#afterUpload").hasClass("DN")&&mainObj.find("#afterUpload").toggleClass("DN"),mainObj.find("#folderImp").parent().parent().addClass("DN")}else if("TTProjectDashBoard"===origin){mainObj=Layout.Page.container.find("div#import_hrfileDiv"),filesList=object.callbackDataFromWorkDrive.permissionModel;var fileArray=[];for(i=0;i<filesList.length;i++){(importobj={}).name=filesList[i].fileName,importobj.filePath=filesList[i].link,fileArray.push(importobj)}Timetracker.projectDashboard.DashboardAttachments.workDriveCallBack(fileArray)}else if("TT_Timesheets"===origin){var importobj;(importobj={}).name=object.fileName,importobj.filePath=object.permalink,Timetracker.util.addFileNameAttachment(importobj,"workDriveUpload")}else{if("Leave"==origin){var leaveObj={};return leaveObj.name=object.fileName,leaveObj.fileUrl=object.permalink,void LeaveGrant.File.onWorkdriveFilePick(leaveObj,"workdrive")}"Files"==origin?(obj.type=filesModel.type,obj.fileName=docDispName,obj.permalink=object.callbackDataFromWorkDrive.permissionModel[0].link,FileUpload.WorkDrive.upload(obj)):WorkDriveInt.chainCallBack&&(WorkDriveInt.chainCallBack(object.callbackDataFromWorkDrive),WorkDriveInt.chainCallBack=void 0)}},openWDFiles:function(obj,isOnboarding){var url;url=isOnboarding?obj.filePath:Layout.Page.container.find(obj).parent().data().ldata.filePath,window.open(url)},appendFrameOrigin:function(url){var frameOrigin=window.location.protocol+"//"+window.location.host,zohoOneOrigin=ZPUnifieduiUtil.getZOFrameOriginUrl();return null!=zohoOneOrigin&&void 0!=zohoOneOrigin&&""!=zohoOneOrigin&&(frameOrigin+=","+zohoOneOrigin),-1==url.indexOf("?")?url+="?frameorigin="+frameOrigin:url+="&frameorigin="+frameOrigin,url}};class LightBox{constructor(fileName){this.fileId="",this.fileName=fileName,this.headerNote="",this.needPrint=!1,this.needDownload=!1,this.infoIconNeed=!1,this.infoContent={},this.isImage=!1,this.isVideo=!1,this.viewUrl="",this.imageOrigHeight="",this.imageOrigWidth="",this.maxHeight="",this.maxWidth="",this.extraProps={}}setDownloadCallback(downloadCallBack){this.downloadCallBack=downloadCallBack}setPrintCallback(printCallBack){this.printCallBack=printCallBack}setFileLoadCallBack(onFileLoadCallBack){this.onFileLoadCallBack=onFileLoadCallBack}async show(){this.mainWrapId=ZPUtil.isV5SettingsUrl()?$(settingsPage.mainWrapId):Layout.Page.container.closest(".main-wrp"),this.headerHtml='<div class="zpl_Lbx_hdr">'+(""!=this.headerNote?'<div class="zpl_info trns"><i class="PI_info"></i><span>'+this.headerNote+"<span></div>":"")+'<div class="zpl_Lbx_ttl"><h6>'+this.fileName+'</h6></div><div id="lightBox_cls" class="zpl_Lbx_cls"><span><i class="PI_cls"></i><em>esc</em></span></div></div>',this.viewUrl&&(this.viewUrl=await ZPEncrypt.Encryption.getIframeUrl(this.viewUrl)),this.isImage?(this.zoomBar='<div class="zpl_Lbx_zom"><div><span>200%</span><div><i class="PI_plus"></i><input id="zoomRange" type="range" min="0" max="200" value="0" oninput=""><i class="PI_minus"></i></div><span>0%</span></div></div>',this.BodyHtml='<div class="zpl_Lbx_bdy zpl_Lbximg"><div class="zpl_Lbx_pv"><img id="imgLBx" src="'+this.viewUrl+'" fileid="'+this.fileId+'" scrolling="auto" style="position:relative;display:none"></div>'+this.zoomBar+"</div>"):this.isVideo?this.BodyHtml='<div class="zpl_Lbx_bdy"><div class="zpl_Lbx_pv zpl_pv100"><video fileid="'+this.fileId+'" controls="" preload="auto" autoplay="" src="'+this.viewUrl+'" controlslist="nodownload" style="height: 100%;"></video></div></div>':this.BodyHtml='<div class="zpl_Lbx_bdy"><iframe id="nonImgLBx" fileid="'+this.fileId+'" src="'+this.viewUrl+'" scrolling="auto" style="border: none; margin: 0pt;" frameborder="0" height="100%" width="100%"></iframe></div>',this.infoHtml=this.infoIconNeed?'<div class="zpl_Lbx_drp"><span><i class="PI_info" data-title-position="top" title="'+ZPI18N.getString("zp.info")+'"></i></span><div class="zpl_Lbx_drpmnu TBDD">'+this.constructInfoHtml()+"</div></div>":"",this.footerHtml='<div class="zpl_Lbx_ftr"><div class="zpl_Lbx_act">'+this.infoHtml+(this.isImage?'<i id="magnifier_Lbx" class="PI_mgnfr" data-title-position="top" title="'+ZPI18N.getString("zp.pdf.zoom")+'"></i>':"")+(1==this.needDownload?'<i id="download_Lbx" class="PI_downld" data-title-position="top" title="'+ZPI18N.getString("zp.Download")+'"></i>':"")+(1==this.needPrint?'<i id="print_Lbx"class="PI_print" data-title-position="top" title="'+ZPI18N.getString("zp.print")+'"></i>':"")+"</div></div>";var lightBoxHtml='<div id="lightBoxCont" class="zpl_Lbx">';lightBoxHtml+=this.headerHtml,lightBoxHtml+=this.BodyHtml,lightBoxHtml+=this.footerHtml,lightBoxHtml+="</div>",this.mainWrapId.append(lightBoxHtml),(Object.keys(this.extraProps).length>0&&void 0!=this.extraProps.fileExtn&&"txt"==this.extraProps.fileExtn.toLowerCase()||this.fileName.toLowerCase().indexOf(".txt")>-1)&&this.mainWrapId.find("#lightBoxCont").find(".zpl_Lbx_bdy").addClass("whtbg");var getThis=this;$(window.document,this.mainWrapId.find("#lightBoxCont").contents()).on("keyup",function(e){27==e.keyCode&&getThis.close()}),this.mainWrapId.find("#lightBoxCont").find("#lightBox_cls").off().on("click",function(){getThis.close()}),this.mainWrapId.find("#lightBoxCont").find(".zpl_Lbx_drp").find(".PI_info").on("click",function(){getThis.mainWrapId.find("#lightBoxCont").find(".zpl_Lbx_drp").toggleClass("opn")}),this.mainWrapId.find("#lightBoxCont").find("#download_Lbx").on("click",function(){getThis._callCallback(getThis.downloadCallBack)}),this.mainWrapId.find("#lightBoxCont").find("#print_Lbx").on("click",function(){getThis._callCallback(getThis.printCallBack)}),this.isImage?(this.mainWrapId.find("#lightBoxCont").find("#imgLBx").on("load",function(){getThis.onLoad(!1),getThis._callCallback(getThis.onFileLoadCallBack)}),$(window).on("resize",function(){getThis.onLoad(!0)}),this.mainWrapId.find("#lightBoxCont").find("#magnifier_Lbx").off().on("click",function(){getThis.magnifyFile(this)}),this.mainWrapId.find("#lightBoxCont").find("#zoomRange").on("input",function(){getThis.zoomFile()})):this.mainWrapId.find("#lightBoxCont").find("#nonImgLBx").on("load",function(){getThis._callCallback(getThis.onFileLoadCallBack)})}_callCallback(callback){void 0!=callback&&""!=callback&&"function"==typeof callback&&callback(this)}onLoad(mode){var zoomBar=$("#lightBoxCont").find(".zpl_Lbx_bdy").find("#zoomRange");if(0==parseInt(zoomBar.val())||!mode){var containerSize=$(window.document).find("#lightBoxCont").find(".zpl_Lbx_bdy");this.maxHeight=containerSize.height()-50+"px",this.maxWidth=containerSize.width()-150+"px";var contentPv=$(window.document).find(".zpl_Lbx_bdy").find(".zpl_Lbx_pv");contentPv.css("max-height",this.maxHeight),contentPv.css("max-width",this.maxWidth);var imageCont=$(window.document).find(".zpl_Lbx_bdy").find("#imgLBx");imageCont.css("max-height",this.maxHeight),imageCont.css("max-width",this.maxWidth),imageCont.css("display","block"),this.imageOrigHeight=imageCont.height(),this.imageOrigWidth=imageCont.width()}}close(){this.mainWrapId.find("#lightBoxCont").remove(),window.location.hash.indexOf("files/viewfile")>-1&&(window.location.hash="")}constructInfoHtml(){var infoDiv="",info=this.infoContent;if(void 0!=info&&Object.keys(info).length>0){infoDiv="<ul>";for(var infoKeys=Object.keys(info),i=0;i<=infoKeys.length-1;i++){var key=infoKeys[i];infoDiv+="<li><span>"+key+"</span><em>"+info[key]+"</em></li>"}infoDiv+="</ul>"}return infoDiv}magnifyFile(ele){var img,glass,zoom=Number("2"),bw=3;if($(ele).toggleClass("sel"),$(ele).attr("class").indexOf("sel")>=0){function hideMagnifier(){glass.style.display="none"}function showMagnifier(e){glass.style.display="block";var pos,x,y,w=glass.offsetWidth/2,h=glass.offsetHeight/2;e.preventDefault(),pos=function(e){var a,x=0,y=0;return a=img[0].getBoundingClientRect(),x=e.pageX-a.left,y=e.pageY-a.top,x-=window.pageXOffset,y-=window.pageYOffset,{x:x,y:y}}(e),x=pos.x,y=pos.y,glass.style.left=x-w+"px",glass.style.top=y-h+"px";img[0].getBoundingClientRect().left,img[0].getBoundingClientRect().top;var tempXPos=0;tempXPos=-(x*zoom-w+bw)<=0?-(x*zoom-w+bw):w-(x*zoom-bw);var tempYPos=0;tempYPos=-(y*zoom-h+bw)<=0?-(y*zoom-h+bw):h-(y*zoom-bw),glass.style.backgroundPosition=tempXPos+"px "+tempYPos+"px"}0==$("#lightBoxCont").find(".zpl_Lbx_bdy").find("#magnifiedView").length&&(img=$("#lightBoxCont").find(".zpl_Lbx_bdy").find("#imgLBx"),(glass=document.createElement("DIV")).setAttribute("id","magnifiedView"),glass.setAttribute("class","zpl_Lbx_mgn"),img.parent().append(glass),glass.style.backgroundImage="url('"+this.viewUrl+"')",glass.style.backgroundRepeat="no-repeat",glass.style.backgroundSize=img.width()*zoom+"px "+img.height()*zoom+"px",glass.addEventListener("mousemove",showMagnifier),img.on("mousemove",showMagnifier),glass.addEventListener("mouseout",hideMagnifier),img.on("mouseout",hideMagnifier))}else $("#lightBoxCont").find(".zpl_Lbx_bdy").find("#magnifiedView").remove()}zoomFile(){$("#lightBoxCont").find(".zpl_Lbx_bdy").find("#magnifiedView").remove(),$("#lightBoxCont").find("#magnifier_Lbx").removeClass("sel");var zoomBar=$("#lightBoxCont").find(".zpl_Lbx_bdy").find("#zoomRange"),imageCont=$("#lightBoxCont").find(".zpl_Lbx_bdy").find("#imgLBx"),zoomVal=parseInt(zoomBar.val()),val=(zoomBar.val()-zoomBar.attr("min"))/(zoomBar.attr("max")-zoomBar.attr("min"));zoomBar.css("background-image","-webkit-gradient(linear, left top, right top, color-stop("+val+", #ffffff), color-stop("+val+", #787878))");var imgZoomHeight=parseInt(this.imageOrigHeight)+parseInt(zoomVal),imgZoomWidth=parseInt(this.imageOrigWidth)+parseInt(zoomVal),imgmaxheight=0!=zoomVal?parseInt(this.maxHeight)+parseInt(zoomVal):this.maxHeight,imgmaxwidth=0!=zoomVal?parseInt(this.maxWidth)+parseInt(zoomVal):this.maxWidth;imageCont.css("max-height",imgmaxheight+"px"),imageCont.css("max-width",imgmaxwidth+"px"),this.imageOrigHeight>this.imageOrigWidth?(imageCont.height(imgZoomHeight+"px"),imageCont.width("auto")):(imageCont.height("auto"),imageCont.width(imgZoomWidth+"px"))}}var LightBoxAddOns={isFrameAvailable:function(fileId){return(ZPUtil.isV5SettingsUrl()?$(settingsPage.mainWrapId):Layout.Page.container.closest(".main-wrp")).find("#lightBoxCont").find("[fileid='"+fileId+"']").length>0},setFrameUrl:async function(fileId,frameURL){var mainWrapId=ZPUtil.isV5SettingsUrl()?$(settingsPage.mainWrapId):Layout.Page.container.closest(".main-wrp");LightBoxAddOns.isFrameAvailable(fileId)&&mainWrapId.find("#lightBoxCont").find("[fileid='"+fileId+"']").attr("src",await ZPEncrypt.Encryption.getIframeUrl(frameURL))}},PreviewEngineConversion={generatePreview:function(event){if("PreviewEngine"==event.data.source&&"404"==event.data.code){var cliMsgParam=decodeURIComponent(atob(event.data.cliMsgParam)),cliJSON=JSON.parse(cliMsgParam),fileId=event.data.requestedFileId,moduleName=cliJSON.moduleName,formData=new FormData;if(formData.append("conreqcsr",csrfToken),formData.append("fileId",fileId),formData.append("module",moduleName),"Forms"==moduleName){["formId","recordId","fcId"].forEach(param=>formData.append(param,cliJSON[param]))}$.ajax({url:"/zpfiles/operations/generatePreview",type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){ZPeople.Message.success(ZPI18N.getString("zp.generatingpreview"))},error:function(req){ZPeople.Message.failure(ZPI18N.getString("zp.genaratepreviewerr"))}})}else"PreviewEngine"==event.data.source&&"202"==event.data.code&&ZPeople.Message.success(ZPI18N.getString("zp.generatingpreview"))},getStatusCallBackFromPE:function(val){var fileId=val.fileId,module=val.module;LightBoxAddOns.isFrameAvailable(fileId)&&("files"==module?FilesUtil.Preview.setFrameURL(val):"forms"==module&&ZP5Form.FILEUPLOAD_IMAGES.LightBox.wmsCallBack(val))}};FilesUtil={FILETYPE:{ORGFILE:1,EMPFILE:0,PERSFILE:2},folderDataArr:[],isCachedCat:!1,isCachedPerm:!1,locRoleData:[[],[],!1],departmentList:[[],!1],settingsAdmin:!1,rolesJson:[],isEnterprise:!1,isreportingTo:!1,hasAllReporteePerm:!1,isFolderView:!1,loginUserRoleCheck:-1,isDeptLead:!1,isOrgStructureEnabled:!1,isCachedPerm_OP:!1,compdisname:ZPI18N.getString("zp.files.operations.orgfile"),addcompdisnameBtn:ZPI18N.getString("zp.addcomponents",new Array(ZPI18N.getString("zp.organizationfiles"))),addcompdisname:ZPI18N.getString("zp.addcomponents",new Array(ZPI18N.getString("zp.files.operations.orgfile"))),editcompdisname:ZPI18N.getString("zp.module.edit",new Array(ZPI18N.getString("zp.files.operations.orgfile"))),hrfiledisname:ZPI18N.getString("zp.files.operations.empfile"),addhrfiledisnameBtn:ZPI18N.getString("zp.addcomponents",new Array(ZPI18N.getString("zp.newemployeefiles"))),addhrfiledisname:ZPI18N.getString("zp.addcomponents",new Array(ZPI18N.getString("zp.files.operations.empfile"))),edithrfiledisname:ZPI18N.getString("zp.module.edit",new Array(ZPI18N.getString("zp.files.operations.empfile"))),imphrfiledisname:ZPI18N.getString("zp.importemployeefiles"),hrFilesRename:0,companyFilesRename:1,compActivityLogDisname:"",hrActivityLogDisname:"",sharingOpts:{Entity:[],Department:[],Division:[],Unit:[],Location:[]},isOrgShareFetched:!1,fetchDataSettingsPage:function(){if(!FilesUtil.isCachedPerm){var formData=new FormData;formData.append("conreqcsr",csrfToken),$.ajax({url:"/zpfiles/settings/initialData",type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){void 0!=resultData[1]&&(FilesUtil.settingsAdmin=resultData[1].settingsAdmin,FilesUtil.rolesJson=resultData[1].rolesJson,FilesUtil.isEnterprise=resultData[1].isEnterprise,FilesUtil.Geo.isConfigured=resultData[1].isGeoEnabled,FilesUtil.isCachedPerm=!0)}})}},fetchDataOperationPage:function(){var resultData=ZPeople.Module.getData();void 0!=resultData&&Object.keys(resultData).length>0&&(resultData.hasOwnProperty("loginUserRoleCheck")&&(FilesUtil.loginUserRoleCheck=resultData.loginUserRoleCheck),resultData.hasOwnProperty("isOrgStructureEnabled")&&(FilesUtil.isOrgStructureEnabled=resultData.isOrgStructureEnabled),resultData.hasOwnProperty("isGeoEnabled")&&(FilesUtil.Geo.isConfigured=resultData.isGeoEnabled),resultData.hasOwnProperty("isreportingTo")&&(FilesUtil.isreportingTo=resultData.isreportingTo),resultData.hasOwnProperty("hasAllReporteePerm")&&(FilesUtil.hasAllReporteePerm=resultData.hasAllReporteePerm),resultData.hasOwnProperty("isFolderView")&&(FilesUtil.isFolderView=resultData.isFolderView),resultData.hasOwnProperty("isDeptLead")&&(FilesUtil.isDeptLead=resultData.isDeptLead)),FilesUtil.loadTabName()},getLayoutModuleParam:function(){return{modulePrefix:"files"}},loadTabName:function(){FilesUtil.compActivityLogDisname=ZPI18N.getString("zp.organizationfiles"),FilesUtil.hrActivityLogDisname=ZPI18N.getString("zp.newemployeefiles");var resultData=ZPeople.Module.getData();if(void 0!=resultData&&Object.keys(resultData).length>0&&resultData.hasOwnProperty("getDispName")){var dispNameData=resultData.getDispName;$.each(dispNameData,function(tabkey,tabvalue){tabvalue.hasOwnProperty(FilesUtil.companyFilesRename)&&(FilesUtil.compdisname=tabvalue[FilesUtil.companyFilesRename],FilesUtil.compActivityLogDisname=tabvalue[FilesUtil.companyFilesRename],FilesUtil.addcompdisnameBtn=ZPI18N.getString("zp.addcomponents",new Array(FilesUtil.compdisname)),FilesUtil.addcompdisname=FilesUtil.addcompdisnameBtn,FilesUtil.editcompdisname=ZPI18N.getString("zp.module.edit",new Array(FilesUtil.compdisname))),tabvalue.hasOwnProperty(FilesUtil.hrFilesRename)&&(FilesUtil.hrfiledisname=tabvalue[FilesUtil.hrFilesRename],FilesUtil.hrActivityLogDisname=tabvalue[FilesUtil.hrFilesRename],FilesUtil.addhrfiledisnameBtn=ZPI18N.getString("zp.addcomponents",new Array(FilesUtil.hrfiledisname)),FilesUtil.addhrfiledisname=FilesUtil.addhrfiledisnameBtn,FilesUtil.edithrfiledisname=ZPI18N.getString("zp.module.edit",new Array(FilesUtil.hrfiledisname)),FilesUtil.imphrfiledisname=ZPI18N.getString("zp.importfor",new Array(FilesUtil.hrfiledisname)))})}},getFolderList:function(start,page,search,id){if(!FilesUtil.IP.isRestricted&&!FilesUtil.Geo.isRestricted){if(void 0!=FilesUtil.folderDataArr[page-1]&&(null==search||void 0==search||""==search))return 1==Number(page)&&"-1"==FilesUtil.folderDataArr[0][0].id&&(FilesUtil.folderDataArr[0][0].name="files_placeUnder"==id?"/":ZPI18N.getString("zp.select")),FilesUtil.folderDataArr[Number(page-1)];var folderList=[],formData=new FormData;formData.append("conreqcsr",csrfToken),formData.append("filesNewUI",!0),formData.append("start",start),null!=search&&void 0!=search&&""!=search&&formData.append("name",search),null!=FilesUtil.Geo.position&&"true"===FilesUtil.doNeedToGetLocation&&FilesUtil.Geo.position!=FilesUtil.Geo.blocked&&(formData.append("latitude",FilesUtil.Geo.position.coords.latitude),formData.append("longitude",FilesUtil.Geo.position.coords.longitude)),$.ajax({url:"/zpfiles/operations/getGroupByAllFolders",type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){if(void 0!=resultData[0]&&resultData[0].code==FilesUtil.IP.errorCode)FilesUtil.IP.showError(!1);else if(void 0!=resultData[0]&&resultData[0].code==FilesUtil.Geo.errorCode)FilesUtil.Geo.showError(!1);else if(void 0!=resultData[1]&&($.each(resultData[1],function(key,value){folderList.push({name:value.CatName,value:value.CatID,id:value.CatID})}),2==page&&folderList.length>0&&folderList.shift(),null==search||void 0==search||""==search)){if(1==Number(page)){if("files_placeUnder"==id)var defaultVal={name:"/",value:"-1",id:"-1"};else defaultVal={name:ZPI18N.getString("zp.select"),value:"-1",id:"-1"};folderList.length<=0?folderList.push(defaultVal):folderList.unshift(defaultVal)}FilesUtil.folderDataArr.push(folderList)}}})}return folderList},resetAllFolderDD:function(){FilesUtil.folderDataArr=[],ZPeopleComponents.isComponent($("#files_placeUnder"))&&ZPeopleComponents.select($("#files_placeUnder")).refresh(),ZPeopleComponents.isComponent($("#addOrgFile_Folder"))&&ZPeopleComponents.select($("#addOrgFile_Folder")).refresh(),ZPeopleComponents.isComponent($("#addEmpFile_Folder"))&&ZPeopleComponents.select($("#addEmpFile_Folder")).refresh(),ZPeopleComponents.isComponent($("#imp_addEmpFile_Folder"))&&ZPeopleComponents.select($("#imp_addEmpFile_Folder")).refresh(),ZPeopleComponents.isComponent($("#filterOrgFile_Folder_loc"))&&ZPeopleComponents.select($("#filterOrgFile_Folder_loc")).refresh(),ZPeopleComponents.isComponent($("#filterOrgFile_Folder_ent"))&&ZPeopleComponents.select($("#filterOrgFile_Folder_ent")).refresh(),ZPeopleComponents.isComponent($("#filterOrgFile_Folder_unit"))&&ZPeopleComponents.select($("#filterOrgFile_Folder_unit")).refresh(),ZPeopleComponents.isComponent($("#filterOrgFile_Folder_div"))&&ZPeopleComponents.select($("#filterOrgFile_Folder_div")).refresh(),ZPeopleComponents.isComponent($("#filterOrgFile_Folder_dept"))&&ZPeopleComponents.select($("#filterOrgFile_Folder_dept")).refresh(),ZPeopleComponents.isComponent($("#filterEmpFile_Folder_all"))&&ZPeopleComponents.select($("#filterEmpFile_Folder_all")).refresh()},getLocationList:function(){return 0==FilesUtil.locRoleData[2]&&FilesUtil.fetchLocRoleList(),FilesUtil.locRoleData[0]},getRoleList:function(){return 0==FilesUtil.locRoleData[2]&&FilesUtil.fetchLocRoleList(),FilesUtil.locRoleData[1]},getDepartmentList:function(){if(0==FilesUtil.departmentList[1]&&!FilesUtil.IP.isRestricted&&!FilesUtil.Geo.isRestricted){var formData=new FormData;formData.append("conreqcsr",csrfToken),formData=FilesUtil.Geo.setLatLongParams(formData,!0),$.ajax({url:"/zpfiles/operations/getDepartmentList",type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){if(FilesUtil.departmentList[1]=!0,void 0!=resultData[0]&&resultData[0].code==FilesUtil.IP.errorCode)FilesUtil.IP.showError(!1);else if(void 0!=resultData[0]&&resultData[0].code==FilesUtil.Geo.errorCode)FilesUtil.Geo.showError(!1);else if(void 0!=resultData[1]){var deptList=[];deptList.push({name:ZPI18N.getString("zp.all"),value:"-1",id:"-1"}),$.each(resultData[1],function(key,val){deptList.push({name:val.Value,value:val.Id,id:val.Id})}),FilesUtil.departmentList[0]=deptList}}})}return FilesUtil.departmentList[0]},fetchLocRoleList:function(){if(!FilesUtil.IP.isRestricted&&!FilesUtil.Geo.isRestricted){var formData=new FormData;formData.append("conreqcsr",csrfToken),formData=FilesUtil.Geo.setLatLongParams(formData,!0),$.ajax({url:"/zpfiles/operations/getLocationsAndRoles",type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){if(FilesUtil.locRoleData[2]=!0,void 0!=resultData[0]&&resultData[0].code==FilesUtil.IP.errorCode)FilesUtil.IP.showError(!1);else if(void 0!=resultData[0]&&resultData[0].code==FilesUtil.Geo.errorCode)FilesUtil.Geo.showError(!1);else if(void 0!=resultData[1]){var locList=[];locList.push({name:ZPI18N.getString("zp.all"),value:"-1",id:"-1"}),$.each(resultData[1].location,function(key,value){locList.push({name:value.NAME,value:value.ID,id:value.ID})}),FilesUtil.locRoleData[0]=locList;var roleList=[];$.each(resultData[1].rolesJson,function(key,value){roleList.push({name:value,value:key,id:key})}),FilesUtil.locRoleData[1]=roleList}}})}},getSharingOptsList:function(){if(!FilesUtil.IP.isRestricted&&!FilesUtil.Geo.isRestricted&&!FilesUtil.isOrgShareFetched){var formData=new FormData;formData.append("isOrgStrEnabled",isOrgStructureEnabled),formData.append("conreqcsr",csrfToken),formData=FilesUtil.Geo.setLatLongParams(formData,!0),$.ajax({url:"/zpfiles/operations/getShareWithOpts",type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){null!=resultData&&void 0!=resultData&&(FilesUtil.sharingOpts=resultData[1],FilesUtil.isOrgShareFetched=!0)}})}}},FilesUtil.Page={orgListViewData:{Ent:[0,!0,{},!1],Unit:[0,!0,{},!1],Div:[0,!0,{},!1],Dept:[0,!0,{},!1],Loc:[0,!0,{},!1]},orgCatViewData:{Ent:[0,!0,{},!1],Unit:[0,!0,{},!1],Div:[0,!0,{},!1],Dept:[0,!0,{},!1],Loc:[0,!0,{},!1]},orgSubCatViewData:{Ent:[0,!0,{},!1,"3",!0,{},0,!0],Unit:[0,!0,{},!1,"3",!0,{},0,!0],Div:[0,!0,{},!1,"3",!0,{},0,!0],Dept:[0,!0,{},!1,"3",!0,{},0,!0],Loc:[0,!0,{},!1,"3",!0,{},0,!0]},empListViewData:{All:[0,!0,{},!1]},empCatViewData:{All:[0,!0,{},!1]},empSubCatViewData:{All:[0,!0,{},!1,"3",!0,{},0,!0]},pageIdMap:{ENT:"_ent",UNIT:"_unit",DIV:"_div",DEPT:"_dept",LOC:"_loc",ALL:"_all",MYDEPT:"_mydept"},orgListViewData_mod:{Org:[0,!0,{},!1],Mydept:[0,!0,{},!1]},orgCatViewData_mod:{Org:[0,!0,{},!1],Mydept:[0,!0,{},!1]},orgSubCatViewData_mod:{Org:[0,!0,{},!1,"3",!0,{},0,!0],Mydept:[0,!0,{},!1,"3",!0,{},0,!0]},empListViewData_mod:{My:[0,!0,{},!1],Role:[0,!0,{},!1],Sub:[0,!0,{},!1],Team:[0,!0,{},!1]},empCatViewData_mod:{My:[0,!0,{},!1],Role:[0,!0,{},!1],Sub:[0,!0,{},!1],Team:[0,!0,{},!1]},empSubCatViewData_mod:{My:[0,!0,{},!1,"3",!0,{},0,!0],Role:[0,!0,{},!1,"3",!0,{},0,!0],Sub:[0,!0,{},!1,"3",!0,{},0,!0],Team:[0,!0,{},!1,"3",!0,{},0,!0]},pageIdMap_mod:{ORG:"_org",MY:"_my",ROLE:"_role",PERS:"_pers",SUB:"_sub",TEAM:"_team",MYDEPT:"_mydept"},persListViewData:{Pers:[0,!0,{},!1,"3",!0]},orgListViewData_pol:{Org:[0,!0,{},!1]},orgCatViewData_pol:{Org:[0,!0,{},!1]},orgSubCatViewData_pol:{Org:[0,!0,{},!1,"3",!0,{},0,!0]},pageIdMap_pol:{ORG:"_pol"},isPolicyPage:function(){var isPolicyPage=!1;return settingsUrlProps.url.indexOf("policyfiles")>-1&&(isPolicyPage=!0),isPolicyPage},isModulePage:function(){var isModule=!1;return(settingsUrlProps.url.indexOf("files/myfile")>-1||FilesUtil.Page.isTeamMainPage()||settingsUrlProps.url.indexOf("files/orgfile")>-1||FilesUtil.Page.isPolicyPage())&&(isModule=!0),isModule},isTeamMainPage:function(){return settingsUrlProps.url.indexOf("files/team")>-1},isDeptTeamPage:function(){return settingsUrlProps.url.indexOf("files/team/dept")>-1},getTabGroup:function(){var fileType="";return settingsUrlProps.niceUrl.indexOf("/files/ent")>-1||settingsUrlProps.niceUrl.indexOf("/files/unit")>-1||settingsUrlProps.niceUrl.indexOf("/files/div")>-1||settingsUrlProps.niceUrl.indexOf("/files/dept")>-1||settingsUrlProps.niceUrl.indexOf("/files/loc")>-1||settingsUrlProps.niceUrl.indexOf("files/orgfile")>-1||settingsUrlProps.niceUrl.indexOf("/policyfiles")>-1||settingsUrlProps.niceUrl.indexOf("files/team/dept")>-1?fileType="1":settingsUrlProps.niceUrl.indexOf("/files/all")>-1||settingsUrlProps.niceUrl.indexOf("myfile/me")>-1||settingsUrlProps.niceUrl.indexOf("myfile/role")>-1||FilesUtil.Page.isTeamMainPage()?fileType="0":settingsUrlProps.niceUrl.indexOf("myfile/pers")>-1&&(fileType="2"),fileType},getParentContainer:function(){var parentContainer="";return settingsUrlProps.niceUrl.indexOf("/files/ent")>-1?parentContainer=FilesUtil.Page.pageIdMap.ENT:settingsUrlProps.niceUrl.indexOf("/files/unit")>-1?parentContainer=FilesUtil.Page.pageIdMap.UNIT:settingsUrlProps.niceUrl.indexOf("/files/div")>-1?parentContainer=FilesUtil.Page.pageIdMap.DIV:settingsUrlProps.niceUrl.indexOf("/files/dept")>-1?parentContainer=FilesUtil.Page.pageIdMap.DEPT:settingsUrlProps.niceUrl.indexOf("/files/loc")>-1?parentContainer=FilesUtil.Page.pageIdMap.LOC:settingsUrlProps.niceUrl.indexOf("/files/all")>-1?parentContainer=FilesUtil.Page.pageIdMap.ALL:settingsUrlProps.niceUrl.indexOf("myfile/me")>-1?parentContainer=FilesUtil.Page.pageIdMap_mod.MY:settingsUrlProps.niceUrl.indexOf("files/team/dept")>-1?parentContainer=FilesUtil.Page.pageIdMap_mod.MYDEPT:settingsUrlProps.niceUrl.indexOf("files/team/all")>-1?parentContainer=FilesUtil.Page.pageIdMap_mod.SUB:settingsUrlProps.niceUrl.indexOf("files/team/members/user")>-1?parentContainer=FilesUtil.Page.pageIdMap_mod.TEAM:settingsUrlProps.niceUrl.indexOf("myfile/role")>-1?parentContainer=FilesUtil.Page.pageIdMap_mod.ROLE:settingsUrlProps.niceUrl.indexOf("files/orgfile")>-1?parentContainer=FilesUtil.Page.pageIdMap_mod.ORG:settingsUrlProps.niceUrl.indexOf("myfile/pers")>-1?parentContainer=FilesUtil.Page.pageIdMap_mod.PERS:settingsUrlProps.niceUrl.indexOf("/policyfiles")>-1&&(parentContainer=FilesUtil.Page.pageIdMap_pol.ORG),parentContainer},getPageId:function(){var parentContainer=FilesUtil.Page.getParentContainer(),tabGroup=FilesUtil.Page.getTabGroup(),divId="";if("1"===tabGroup)divId="orgFile";else if("0"===tabGroup)divId="empFile";else if("2"===tabGroup)return"persFileListView"+parentContainer;return settingsUrlProps.url.indexOf("-catId")>-1?divId+"SubList"+parentContainer:FilesUtil.Page.isFolderViewPage()?divId+"List"+parentContainer:divId+"ListView"+parentContainer},getListPageData:function(parentContainer){return parentContainer==FilesUtil.Page.pageIdMap.ENT?FilesUtil.Page.orgListViewData.Ent:parentContainer==FilesUtil.Page.pageIdMap.UNIT?FilesUtil.Page.orgListViewData.Unit:parentContainer==FilesUtil.Page.pageIdMap.DIV?FilesUtil.Page.orgListViewData.Div:parentContainer==FilesUtil.Page.pageIdMap.DEPT?FilesUtil.Page.orgListViewData.Dept:parentContainer==FilesUtil.Page.pageIdMap.LOC?FilesUtil.Page.orgListViewData.Loc:parentContainer==FilesUtil.Page.pageIdMap.ALL?FilesUtil.Page.empListViewData.All:parentContainer==FilesUtil.Page.pageIdMap_mod.MY?FilesUtil.Page.empListViewData_mod.My:parentContainer==FilesUtil.Page.pageIdMap_mod.MYDEPT?FilesUtil.Page.orgListViewData_mod.Mydept:parentContainer==FilesUtil.Page.pageIdMap_mod.SUB?FilesUtil.Page.empListViewData_mod.Sub:parentContainer==FilesUtil.Page.pageIdMap_mod.TEAM?FilesUtil.Page.empListViewData_mod.Team:parentContainer==FilesUtil.Page.pageIdMap_mod.ROLE?FilesUtil.Page.empListViewData_mod.Role:parentContainer==FilesUtil.Page.pageIdMap_mod.ORG?FilesUtil.Page.orgListViewData_mod.Org:parentContainer==FilesUtil.Page.pageIdMap_mod.PERS?FilesUtil.Page.persListViewData.Pers:parentContainer==FilesUtil.Page.pageIdMap_pol.ORG?FilesUtil.Page.orgListViewData_pol.Org:void 0},getFolderPageData:function(parentContainer){return parentContainer==FilesUtil.Page.pageIdMap.ENT?FilesUtil.Page.orgCatViewData.Ent:parentContainer==FilesUtil.Page.pageIdMap.UNIT?FilesUtil.Page.orgCatViewData.Unit:parentContainer==FilesUtil.Page.pageIdMap.DIV?FilesUtil.Page.orgCatViewData.Div:parentContainer==FilesUtil.Page.pageIdMap.DEPT?FilesUtil.Page.orgCatViewData.Dept:parentContainer==FilesUtil.Page.pageIdMap.LOC?FilesUtil.Page.orgCatViewData.Loc:parentContainer==FilesUtil.Page.pageIdMap.ALL?FilesUtil.Page.empCatViewData.All:parentContainer==FilesUtil.Page.pageIdMap_mod.MY?FilesUtil.Page.empCatViewData_mod.My:parentContainer==FilesUtil.Page.pageIdMap_mod.SUB?FilesUtil.Page.empCatViewData_mod.Sub:parentContainer==FilesUtil.Page.pageIdMap_mod.TEAM?FilesUtil.Page.empCatViewData_mod.Team:parentContainer==FilesUtil.Page.pageIdMap_mod.ROLE?FilesUtil.Page.empCatViewData_mod.Role:parentContainer==FilesUtil.Page.pageIdMap_mod.MYDEPT?FilesUtil.Page.orgCatViewData_mod.Mydept:parentContainer==FilesUtil.Page.pageIdMap_mod.ORG?FilesUtil.Page.orgCatViewData_mod.Org:parentContainer==FilesUtil.Page.pageIdMap_pol.ORG?FilesUtil.Page.orgCatViewData_pol.Org:void 0},getPageData:function(parentContainer,mode){if("1"==mode)return FilesUtil.Page.isListView()||"2"==FilesUtil.Page.getTabGroup()?FilesUtil.Page.getListPageData(parentContainer):FilesUtil.Page.getFolderPageData(parentContainer);if("2"==mode){if(parentContainer==FilesUtil.Page.pageIdMap.ENT)return FilesUtil.Page.orgSubCatViewData.Ent;if(parentContainer==FilesUtil.Page.pageIdMap.UNIT)return FilesUtil.Page.orgSubCatViewData.Unit;if(parentContainer==FilesUtil.Page.pageIdMap.DIV)return FilesUtil.Page.orgSubCatViewData.Div;if(parentContainer==FilesUtil.Page.pageIdMap.DEPT)return FilesUtil.Page.orgSubCatViewData.Dept;if(parentContainer==FilesUtil.Page.pageIdMap.LOC)return FilesUtil.Page.orgSubCatViewData.Loc;if(parentContainer==FilesUtil.Page.pageIdMap.ALL)return FilesUtil.Page.empSubCatViewData.All;if(parentContainer==FilesUtil.Page.pageIdMap_mod.MY)return FilesUtil.Page.empSubCatViewData_mod.My;if(parentContainer==FilesUtil.Page.pageIdMap_mod.SUB)return FilesUtil.Page.empSubCatViewData_mod.Sub;if(parentContainer==FilesUtil.Page.pageIdMap_mod.TEAM)return FilesUtil.Page.empSubCatViewData_mod.Team;if(parentContainer==FilesUtil.Page.pageIdMap_mod.ROLE)return FilesUtil.Page.empSubCatViewData_mod.Role;if(parentContainer==FilesUtil.Page.pageIdMap_mod.MYDEPT)return FilesUtil.Page.orgSubCatViewData_mod.Mydept;if(parentContainer==FilesUtil.Page.pageIdMap_mod.ORG)return FilesUtil.Page.orgSubCatViewData_mod.Org;if(parentContainer==FilesUtil.Page.pageIdMap_pol.ORG)return FilesUtil.Page.orgSubCatViewData_pol.Org}},getFileExtn:function(fileExtn,filePath,UploadSource,isWorkDriveFile){return-1!=filePath.lastIndexOf(".")&&(fileExtn=(fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length)).toLowerCase()),void 0!=isWorkDriveFile?1!=isWorkDriveFile&&"true"!=isWorkDriveFile||(fileExtn="workdrive"):(void 0!=workDriveUrl&&filePath.indexOf(workDriveUrl)>-1||void 0!=writerUrl&&filePath.indexOf(writerUrl)>-1||void 0!=sheetUrl&&filePath.indexOf(sheetUrl)>-1||void 0!=showUrl&&filePath.indexOf(showUrl)>-1||"1"==UploadSource)&&(fileExtn="workdrive"),ZPeople.IsNumeric(filePath)&&(fileExtn=fileExtn.toLowerCase()),void 0==fileExtn&&-1!=filePath.indexOf("_signed")&&filePath.indexOf("_signed")>=-1&&-1!=filePath.lastIndexOf(".")&&(fileExtn=(fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length)).toLowerCase()),fileExtn},isListView:function(){return settingsUrlProps.url.indexOf("-catId")<=0&&!FilesUtil.Page.isFolderViewPage()},isFolderViewPage:function(){return!(settingsUrlProps.url.indexOf("files/myfile/pers")>-1)&&(settingsUrlProps.url.indexOf("viewType")<=0?FilesUtil.isFolderView:"1"!==settingsUrlProps.urlParamsArr.viewType&&("2"===settingsUrlProps.urlParamsArr.viewType||void 0))},isTeamPage:function(){return"files/team/members"===settingsUrlProps.niceUrl&&settingsUrlProps.url.indexOf("viewType")<=0&&settingsUrlProps.url.indexOf("catId")<=0}},FilesUtil.Preview={checkifJSON:function(ele){try{JSON.parse(ele)}catch(e){return!1}return!0},isDocOrPptFileExtn:function(fileExtn){var isSupported=!1;return"doc"!==fileExtn&&"docx"!==fileExtn&&"odt"!==fileExtn&&"rtf"!==fileExtn&&"ppt"!==fileExtn&&"pps"!==fileExtn&&"pptx"!==fileExtn||(isSupported=!0),isSupported},isFilesPreviewEnabled:function(filePath){return!(1!=isPreviewAllowed_Files&&!ZPeople.IsNumeric(filePath))},isViewZBasedFile:function(filePath,fileExtn){return!("xls"!==fileExtn&&"xlsx"!==fileExtn&&"xlsm"!==fileExtn&&"sxc"!==fileExtn&&"ods"!==fileExtn&&"csv"!==fileExtn&&"tsv"!==fileExtn&&"sxw"!==fileExtn&&"odp"!==fileExtn&&"sxi"!==fileExtn&&!FilesUtil.Preview.isDocOrPptFileExtn(fileExtn))&&(!FilesUtil.Preview.isDocOrPptFileExtn(fileExtn)||!FilesUtil.Preview.isFilesPreviewEnabled(filePath))},getZBasedFileURL:function(previewData){var fileURL="";if(!FilesUtil.IP.isRestricted&&!FilesUtil.Geo.isRestricted){var formData=new FormData;formData.append("conreqcsr",csrfToken),formData.append("fileId",previewData.extraProps.fileId),FilesUtil.Preview.isDocOrPptFileExtn(previewData.fileExtn)&&formData.append("isGeneratePreview",!0),formData=FilesUtil.Geo.setLatLongParams(formData,!0),$.ajax({url:"/zpfiles/operations/viewZBasedFile",type:"POST",data:formData,contentType:!1,processData:!1,success:function(resultData){void 0!=resultData[1]&&(fileURL=FilesUtil.Preview.viewZBasedFileCallBack(resultData,previewData.extraProps.fileId,previewData.fileExtn))}})}return fileURL},frameURL:function(previewData){if(FilesUtil.Preview.isViewZBasedFile(previewData.extraProps.filePath,previewData.fileExtn)||void 0!=previewData.fileType&&"5"==previewData.fileType)return FilesUtil.Preview.getZBasedFileURL(previewData);var url="",fileId=previewData.extraProps.fileId,fileExtn=previewData.fileExtn;return!FilesUtil.Preview.isFilesPreviewEnabled(previewData.extraProps.filePath)||"pdf"!=fileExtn&&"tif"!=fileExtn&&"docx"!=fileExtn&&"doc"!=fileExtn&&"rtf"!=fileExtn&&"odt"!=fileExtn&&"rtf"!==fileExtn&&"pptx"!=fileExtn&&"ppt"!=fileExtn?"mov"==fileExtn||"wmv"==fileExtn||"mpeg"==fileExtn||"mpg"==fileExtn||"mp4"==fileExtn||"webm"==fileExtn||"webmv"==fileExtn?url=FilesUtil.Preview.constructUDSPReviewURL(previewData):("workdrive"==fileExtn?url=WorkDriveInt.appendFrameOrigin(previewData.extraProps.filePath):(url="/viewFile?fileId="+fileId+"&latitude="+FilesUtil.Geo.latLongParam.latitude+"&longitude="+FilesUtil.Geo.latLongParam.longitude,"undefined"==contextPath||"null"==contextPath||url.startsWith("/"+contextPath)||(url="/"+contextPath+url,url=FilesUtil.Preview.appendFrameOrigin(url))),"pdf"!==fileExtn&&"PDF"!==fileExtn||(url=FilesUtil.Preview.constructPreviewUrl(fileId,fileExtn))):url=FilesUtil.Preview.constructPreviewUrl(fileId,fileExtn),LightBoxAddOns.setFrameUrl(fileId,url),url},appendFrameOrigin:function(url){var frameOrigin=window.location.protocol+"//"+window.location.host,zohoOneOrigin=ZPUnifieduiUtil.getZOFrameOriginUrl();return null!=zohoOneOrigin&&void 0!=zohoOneOrigin&&""!=zohoOneOrigin&&(frameOrigin+=","+zohoOneOrigin),url+="&frameorigin="+frameOrigin},constructPreviewUrl:function(fileId,fileExtn){if("pdf"==fileExtn){url="/pdfViewer.zp?fileId="+fileId,"undefined"==contextPath||"null"==contextPath||url.startsWith("/"+contextPath)||(url="/"+contextPath+url);var frameOrigin=window.location.protocol+"//"+window.location.host;null!=(zohoOneOrigin=ZPUnifieduiUtil.getZOFrameOriginUrl())&&void 0!=zohoOneOrigin&&""!=zohoOneOrigin&&(frameOrigin+=","+zohoOneOrigin),url+="&frameorigin="+frameOrigin,null!=FilesUtil.Geo.latLongParam.latitude&&void 0!=FilesUtil.Geo.latLongParam.latitude&&""!=FilesUtil.Geo.latLongParam.latitude&&(url+="&latitude="+FilesUtil.Geo.latLongParam.latitude),null!=FilesUtil.Geo.latLongParam.longitude&&void 0!=FilesUtil.Geo.latLongParam.longitude&&""!=FilesUtil.Geo.latLongParam.longitude&&(url+="&longitude="+FilesUtil.Geo.latLongParam.longitude)}else{"tif"==fileExtn?url="/pdf/"+previewServiceId+"/"+fileId+"?":"docx"!=fileExtn&&"doc"!=fileExtn&&"rtf"!=fileExtn&&"odt"!=fileExtn&&"pptx"!=fileExtn&&"ppt"!=fileExtn||(url="/preview/"+previewServiceId+"/"+fileId+"?");var zohoOneOrigin;frameOrigin=window.location.protocol+"//"+window.location.host;null!=(zohoOneOrigin=ZPUnifieduiUtil.getZOFrameOriginUrl())&&void 0!=zohoOneOrigin&&""!=zohoOneOrigin&&(frameOrigin+=","+zohoOneOrigin),url=previewServerUrl+url+"frameorigin="+frameOrigin;var params={};params.portalId=_LOGGEDIN_ACCZSOID,params.moduleName="Files",params.files_userIp=userIp,null!=FilesUtil.Geo.latLongParam.latitude&&void 0!=FilesUtil.Geo.latLongParam.latitude&&""!=FilesUtil.Geo.latLongParam.latitude&&(params.files_latitude=FilesUtil.Geo.latLongParam.latitude),null!=FilesUtil.Geo.latLongParam.longitude&&void 0!=FilesUtil.Geo.latLongParam.longitude&&""!=FilesUtil.Geo.latLongParam.longitude&&(params.files_longitude=FilesUtil.Geo.latLongParam.longitude),url=url+"&cli-msg="+encodeURIComponent(btoa(JSON.stringify(params)))}return url},viewZBasedFileCallBack:function(resultData,fileId,fileExtn){var url;if(!resultData.hasOwnProperty("fail"))return $.each(resultData[1],function(index,data){url=void 0!=data.url&&null!=data.url&&"previewengine"==data.url?FilesUtil.Preview.constructPreviewUrl(fileId,fileExtn):"writer"===data.fileforformat?(url=data.url.replace("<script language='javascript'>window.location.href='","")).replace("';<\/script>",""):data.url}),LightBoxAddOns.setFrameUrl(fileId,url),url;ZPeople.Message.failure(resultData.fail)},constructUDSPReviewURL:function(previewData){var fileId=previewData.extraProps.fileId,filePath=previewData.extraProps.filePath,fileName=previewData.extraProps.fileName,downloadJSON={mode:"files"};downloadJSON.portalId=_LOGGEDIN_ACCZSOID;var extraDetails={};extraDetails.fileId=fileId,extraDetails.fileName=fileName,extraDetails.filePath=filePath,extraDetails.files_userIp=userIp,downloadJSON.extraDtls=extraDetails,void 0!=ZPeople.zaid&&(downloadJSON.zaid=ZPeople.zaid),downloadJSON.isInline=!0;var downloadURL=UDS_DOWNLOAD_URL+"/webdownload?x-service="+UDS_DOWNLOAD_SERVICE_CODE+"&event-id="+fileId+"&x-cli-msg="+encodeURIComponent(JSON.stringify(downloadJSON));return void 0!=ZPeople.zaid&&(downloadURL+="&x-cli-zaid="+ZPeople.zaid),downloadURL},setFrameURL:function(val){var fileId=val.fileId,fileformat=val.fileformat,url=FilesUtil.Preview.constructPreviewUrl(fileId,fileformat);LightBoxAddOns.setFrameUrl(fileId,url)},getPreviewURLForMail:function(){var fileId=settingsUrlProps.urlParamsArr.fileId;FilesHome.Activity.fetchDataForPreview(fileId),(ZPUtil.isV5SettingsUrl()?$(settingsPage.mainWrapId):Layout.Page.container.closest(".main-wrp")).find("#lightBoxCont").find("#lightBox_cls").click(function(){window.location.hash=""})}},FilesUtil.IP={errorCode:"8206",isRestricted:!1,showError:function(isAlert){if(FilesUtil.IP.isRestricted=!0,isAlert)ZPeople.Message.failure(ZPI18N.getString("zp.files.operations.iprestricted"));else{if(settingsUrlProps.niceUrl.indexOf("/hrdocuments")<=0){var parentContainer=FilesUtil.Page.getParentContainer(),dataMode=settingsUrlProps.url.indexOf("-catId")>-1?"2":"1",pageElement=FilesUtil.Page.getPageData(parentContainer,dataMode);pageElement[1]=!1,settingsUrlProps.url.indexOf("-catId")>-1&&(pageElement[8]=!1)}settingsPage.container.find("#noDataIconWpr").removeClass("zpl_DNI"),settingsPage.container.find("#noDataIconWpr").prev().addClass("zpl_DNI"),new EmptyPages("zp_nd_iprestrict",ZPI18N.getString("zp.files.operations.iprestricted"),"",settingsPage.container.find("#noDataIconWpr")).show()}}},FilesUtil.LoadPage={isLocationPageLoaded:!1,isDepartmentPageLoaded:!1,isDivisionPageLoaded:!1,isUnitPageLoaded:!1,isEntityPageLoaded:!1,isAllFilesPageLoaded:!1,isHrDocumentsPageLoaded:!1,isMyFileLoaded:!1,isMyRoleFileLoaded:!1,isMyPersFileLoaded:!1,isDeptFilesLoaded:!1,isRepFilesLoaded:!1,isSpecRepFilesLoaded:!1,isOrgFileLoaded:!1,isPolicyFileLoaded:!1,init:function(){if(FilesUtil.LoadPage.getPageFlagValue()){if(settingsUrlProps.niceUrl.indexOf("/hrdocuments")<=0){if(window.location.href.indexOf("operations/files/all-viewType:1/empId:")>-1||window.location.href.indexOf("operations/files/all-viewType:2/empId:")>-1){var parentContainer=FilesUtil.Page.getParentContainer();(subPageElement=FilesUtil.Page.getPageData(parentContainer,"1"))[0]=0,subPageElement[1]=!0,subPageElement[3]=!0}if(window.location.href.indexOf("files/team/members/user-viewType:1/empId")>-1||window.location.href.indexOf("files/team/members/user-viewType:2/empId")>-1){var subPageElement;parentContainer=FilesUtil.Page.getParentContainer();(subPageElement=FilesUtil.Page.getPageData(parentContainer,"1"))[0]=0,subPageElement[1]=!0,subPageElement[3]=!0}FilesOperations.FolderListing.getData()}}else FilesUtil.LoadPage.setPageFlagValue(),FilesUtil.Geo.init()},getPageFlagValue:function(){return settingsUrlProps.niceUrl.indexOf("operations/files/ent")>-1?FilesUtil.LoadPage.isEntityPageLoaded:settingsUrlProps.niceUrl.indexOf("operations/files/unit")>-1?FilesUtil.LoadPage.isUnitPageLoaded:settingsUrlProps.niceUrl.indexOf("operations/files/div")>-1?FilesUtil.LoadPage.isDivisionPageLoaded:settingsUrlProps.niceUrl.indexOf("operations/files/dept")>-1?FilesUtil.LoadPage.isDepartmentPageLoaded:settingsUrlProps.niceUrl.indexOf("operations/files/loc")>-1?FilesUtil.LoadPage.isLocationPageLoaded:settingsUrlProps.niceUrl.indexOf("operations/files/all")>-1?FilesUtil.LoadPage.isAllFilesPageLoaded:settingsUrlProps.niceUrl.indexOf("operations/files/hrdocuments")>-1?FilesUtil.LoadPage.isHrDocumentsPageLoaded:settingsUrlProps.niceUrl.indexOf("files/myfile/me")>-1?FilesUtil.LoadPage.isMyFileLoaded:settingsUrlProps.niceUrl.indexOf("files/myfile/role")>-1?FilesUtil.LoadPage.isMyRoleFileLoaded:settingsUrlProps.niceUrl.indexOf("files/myfile/pers")>-1?FilesUtil.LoadPage.isMyPersFileLoaded:settingsUrlProps.niceUrl.indexOf("files/team/dept")>-1?FilesUtil.LoadPage.isDeptFilesLoaded:settingsUrlProps.niceUrl.indexOf("files/team/all")>-1?FilesUtil.LoadPage.isRepFilesLoaded:settingsUrlProps.niceUrl.indexOf("files/team/members/user")>-1?FilesUtil.LoadPage.isSpecRepFilesLoaded:settingsUrlProps.niceUrl.indexOf("files/orgfile")>-1?FilesUtil.LoadPage.isOrgFileLoaded:settingsUrlProps.niceUrl.indexOf("home/organization/policyfiles")>-1?FilesUtil.LoadPage.isPolicyFileLoaded:void 0},setPageFlagValue:function(){settingsUrlProps.niceUrl.indexOf("operations/files/ent")>-1?FilesUtil.LoadPage.isEntityPageLoaded=!0:settingsUrlProps.niceUrl.indexOf("operations/files/unit")>-1?FilesUtil.LoadPage.isUnitPageLoaded=!0:settingsUrlProps.niceUrl.indexOf("operations/files/div")>-1?FilesUtil.LoadPage.isDivisionPageLoaded=!0:settingsUrlProps.niceUrl.indexOf("operations/files/dept")>-1?FilesUtil.LoadPage.isDepartmentPageLoaded=!0:settingsUrlProps.niceUrl.indexOf("operations/files/loc")>-1?FilesUtil.LoadPage.isLocationPageLoaded=!0:settingsUrlProps.niceUrl.indexOf("operations/files/all")>-1?FilesUtil.LoadPage.isAllFilesPageLoaded=!0:settingsUrlProps.niceUrl.indexOf("operations/files/hrdocuments")>-1?FilesUtil.LoadPage.isHrDocumentsPageLoaded=!0:settingsUrlProps.niceUrl.indexOf("files/myfile/me")>-1?FilesUtil.LoadPage.isMyFileLoaded=!0:settingsUrlProps.niceUrl.indexOf("files/myfile/role")>-1?FilesUtil.LoadPage.isMyRoleFileLoaded=!0:settingsUrlProps.niceUrl.indexOf("files/myfile/pers")>-1?FilesUtil.LoadPage.isMyPersFileLoaded=!0:settingsUrlProps.niceUrl.indexOf("files/team/dept")>-1?FilesUtil.LoadPage.isDeptFilesLoaded=!0:settingsUrlProps.niceUrl.indexOf("files/team/all")>-1?FilesUtil.LoadPage.isRepFilesLoaded=!0:settingsUrlProps.niceUrl.indexOf("files/team/members/user")>-1?FilesUtil.LoadPage.isSpecRepFilesLoaded=!0:settingsUrlProps.niceUrl.indexOf("files/orgfile")>-1?FilesUtil.LoadPage.isOrgFileLoaded=!0:settingsUrlProps.niceUrl.indexOf("home/organization/policyfiles")>-1&&(FilesUtil.LoadPage.isPolicyFileLoaded=!0)}},FilesUtil.Geo={errorCode:"8205",isConfigured:!1,isRestricted:!1,latLongParam:{latitude:"",longitude:""},isFetched:!1,isBlocked:!1,init:function(){FilesUtil.Geo.isConfigured&&!FilesUtil.Geo.isFetched?navigator.geolocation.getCurrentPosition(FilesUtil.Geo.successcallback,FilesUtil.Geo.errorcallback):settingsUrlProps.niceUrl.indexOf("/hrdocuments")>-1?HRDocumentFiles.init():(FilesOperations.FolderListing.init(),FilesOperations.FolderListing.getData())},successcallback:function(position){FilesUtil.Geo.latLongParam.latitude=position.coords.latitude,FilesUtil.Geo.latLongParam.longitude=position.coords.longitude,FilesUtil.Geo.isFetched=!0;var formData=new FormData;formData.append("conreqcsr",csrfToken),formData=FilesUtil.Geo.setLatLongParams(formData,!0),$.ajax({url:"/zpfiles/operations/checkLoginUserGeoPerm",type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(data){null!=data&&void 0!=data&&void 0!=data[1]&&(FilesUtil.Geo.isRestricted=data[1].isGeoRestrictedUser)},error:function(req){FilesUtil.Geo.isRestricted=!0}}),settingsUrlProps.niceUrl.indexOf("/hrdocuments")>-1?HRDocumentFiles.init():(FilesOperations.FolderListing.init(),FilesOperations.FolderListing.getData())},errorcallback:function(error){FilesUtil.Geo.isBlocked=!0,FilesUtil.Geo.showError(!1)},setLatLongParams:function(params,isFormData){return null!=isFormData&&void 0!=isFormData&&1==isFormData?(""!=FilesUtil.Geo.latLongParam.latitude&&params.append("latitude",FilesUtil.Geo.latLongParam.latitude),""!=FilesUtil.Geo.latLongParam.longitude&&params.append("longitude",FilesUtil.Geo.latLongParam.longitude)):(""!=FilesUtil.Geo.latLongParam.latitude&&(params.latitude=FilesUtil.Geo.latLongParam.latitude),""!=FilesUtil.Geo.latLongParam.longitude&&(params.longitude=FilesUtil.Geo.latLongParam.longitude)),params},showError:function(isAlert){if(FilesUtil.Geo.isRestricted=!0,isAlert)ZPeople.Message.failure(ZPI18N.getString("zp.files.operations.georestricted"));else if(FilesUtil.Geo.isBlocked){noDataClass="zp_nd_locat",noDataTitle=ZPI18N.getString("zp.files.operations.allowloc"),new EmptyPages(noDataClass,noDataTitle,"",settingsPage.container).show()}else{if(settingsUrlProps.niceUrl.indexOf("/hrdocuments")<=0){var parentContainer=FilesUtil.Page.getParentContainer(),dataMode=settingsUrlProps.url.indexOf("-catId")>-1?"2":"1",pageElement=FilesUtil.Page.getPageData(parentContainer,dataMode);pageElement[1]=!1,settingsUrlProps.url.indexOf("-catId")>-1&&(pageElement[8]=!1)}var mainPageId="#fileFolderViewCntWpr",subPageId="#fileSubFolderViewCntWpr";settingsUrlProps.niceUrl.indexOf("/hrdocuments")<=0&&(FilesUtil.Page.isListView()?(settingsPage.container.find(mainPageId).addClass("zpl_DNI"),settingsPage.container.find(subPageId).addClass("zpl_DNI"),settingsPage.container.find("#fileListViewCntWpr").removeClass("zpl_DNI")):settingsUrlProps.url.indexOf("-catId")>-1?(settingsPage.container.find("#fileListViewCntWpr").addClass("zpl_DNI"),settingsPage.container.find(mainPageId).addClass("zpl_DNI"),settingsPage.container.find(subPageId).removeClass("zpl_DNI")):FilesUtil.Page.isFolderViewPage()&&(settingsPage.container.find(subPageId).addClass("zpl_DNI"),settingsPage.container.find("#fileListViewCntWpr").addClass("zpl_DNI"),settingsPage.container.find(mainPageId).removeClass("zpl_DNI")));var noDataContainer=FilesOperations.DataPage.getNoDataContainer();settingsUrlProps.niceUrl.indexOf("/hrdocuments")>-1&&(noDataContainer=settingsPage.container),noDataContainer.find("#noDataIconWpr").removeClass("zpl_DNI"),noDataContainer.find("#noDataIconWpr").prev().addClass("zpl_DNI");var noDataClass="zp_nd_georestrict",noDataTitle=ZPI18N.getString("zp.files.operations.georestricted");new EmptyPages(noDataClass,noDataTitle,"",noDataContainer.find("#noDataIconWpr")).show()}}},FilesUtil.TabPanel={init:function(){var panelJSON=FilesUtil.TabPanel.initPanel_ShareWith(),details=FilesUtil.TabPanel.constructPanelData();panelJSON.tabs=details,panelJSON.forElement="#"+panelJSON.forEleId,panelJSON.listboxOptions={dataMapping:{id:"Id",value:"Id",text:"Value"},showSearchField:!0,search:{by:"Value",criteria:"contains"},searchFieldOptions:{placeholder:ZPI18N.getString("zp.search")}},ZPeopleComponents.tabbedlistboxpopup("#"+panelJSON.id,panelJSON)},initPanel_ShareWith:function(){var tabPanelObj={id:"orgFile_shareWithPanel",forEleId:"orgFile_shareWith",appendTo:"#tabaddOrgFile",select:ZPA_TabbedListBox.selectCallback,deselect:ZPA_TabbedListBox.deselectCallback,targetId:"shareWith_SelectedOpts",changenotification:ZPA_TabbedListBox.changeNotify,type:ZPA_TabbedListBox.ORG_STRUCTURE};return FilesUtil.Page.isDeptTeamPage()||(tabPanelObj.className="notfy",tabPanelObj.footer=ZPA_TabbedListBox.getFooterHtml(ZPI18N.getString("zp.sharetoorg"))),tabPanelObj},constructPanelData:function(){var id="",tabArr=[],tabJSON={};return FilesUtil.getSharingOptsList(),isOrgStructureEnabled&&!FilesUtil.Page.isDeptTeamPage()&&(ZPeople.orgStructureTagMap.entity&&null!=FilesUtil.sharingOpts.Entity&&void 0!=FilesUtil.sharingOpts.Entity&&0!=FilesUtil.sharingOpts.Entity.length&&((tabJSON={}).id=id="Entity",tabJSON.label=ZPeople.orgStructureDispNameMap.entity,tabJSON.panelId=id+"_panel",tabJSON.items=FilesUtil.sharingOpts.Entity,tabArr.push(tabJSON)),ZPeople.orgStructureTagMap.unit&&null!=FilesUtil.sharingOpts.Unit&&void 0!=FilesUtil.sharingOpts.Unit&&0!=FilesUtil.sharingOpts.Unit.length&&((tabJSON={}).id=id="Business_unit",tabJSON.label=ZPeople.orgStructureDispNameMap.unit,tabJSON.panelId=id+"_panel",tabJSON.items=FilesUtil.sharingOpts.Unit,tabArr.push(tabJSON)),ZPeople.orgStructureTagMap.division&&null!=FilesUtil.sharingOpts.Division&&void 0!=FilesUtil.sharingOpts.Division&&0!=FilesUtil.sharingOpts.Division.length&&((tabJSON={}).id=id="Division",tabJSON.label=ZPeople.orgStructureDispNameMap.division,tabJSON.panelId=id+"_panel",tabJSON.items=FilesUtil.sharingOpts.Division,tabArr.push(tabJSON))),(tabJSON={}).id=id="Department",tabJSON.label=ZPeople.orgStructureDispNameMap.department,tabJSON.panelId=id+"_panel",tabJSON.items=FilesUtil.sharingOpts.Department,tabArr.push(tabJSON),FilesUtil.Page.isDeptTeamPage()||((tabJSON={}).id=id="LocationName",tabJSON.label=ZPI18N.getString("zp.location"),tabJSON.panelId=id+"_panel",tabJSON.items=FilesUtil.sharingOpts.Location,tabArr.push(tabJSON)),tabArr},constructTabListValues:function(data,tagInputObj,targetDiv){if(0==Object.keys(data).length){var childTagJson={id:"NotifyAll",value:ZPI18N.getString("zp.sharetoorg")};ZPA_TabbedListBox.appendRecipientTag(tagInputObj,targetDiv,{id:"NOTIFY_ALL",value:""},childTagJson)}else{var keyIdPairJson={Entity:{id:"Entity",dispVal:ZPeople.orgStructureDispNameMap.entity},Unit:{id:"Business_unit",dispVal:ZPeople.orgStructureDispNameMap.unit},Division:{id:"Division",dispVal:ZPeople.orgStructureDispNameMap.division},Department:{id:"Department",dispVal:ZPeople.orgStructureDispNameMap.department},Location:{id:"LocationName",dispVal:ZPI18N.getString("zp.location")}};$.each(keyIdPairJson,function(i,childTagJObj){data.hasOwnProperty(i)&&$.each(data[i],function(key,val){var parentJson=keyIdPairJson[i],parentTagJson={id:parentJson.id,value:parentJson.dispVal},childTagJson={id:key,value:ZSEC.Encoder.encodeForHTML(val)};ZPA_TabbedListBox.appendRecipientTag(tagInputObj,targetDiv,parentTagJson,childTagJson)})})}}},FilesUtil.componentInit={folderListDropdown:function(id){if(!ZPeopleComponents.isComponent("#"+id)){var tokenObj={contentType:"text",dataMapping:{label:"name",informativeText:"name",value:"id",id:"id"},search:{by:["name"],highlightKeyword:!0,delay:250}};0!==FilesUtil.loginUserRoleCheck&&1!==FilesUtil.loginUserRoleCheck||(tokenObj.cacheData=!1,tokenObj.serverSearch=!0,tokenObj.lazyLoading=!0),tokenObj.messages={noResults:ZPI18N.getString("zp.nomatchesfound")},tokenObj.viewPerPage=25,tokenObj.isLabelHTMLEncoded=!1,tokenObj.dropdownList={fitForElement:!0,moveOnScroll:!0,isTextHTMLEncoded:!1},tokenObj.dataSource={search:function(params){return new Promise(function(search,reject){var startIndex=params.pages>1?25*Number(params.pages-1):0,folderArr=FilesUtil.getFolderList(startIndex,params.pages,params.query,id),moreData=!0;if((2!=params.pages&&folderArr.length<25||2==params.pages&&folderArr.length<24)&&(moreData=!1),1==params.pages&&("addOrgFile_Folder"==id||"addEmpFile_Folder"==id||"imp_addEmpFile_Folder"==id)){var btnId=id+"_AddNewCatBtn";ZPeopleComponents.isComponent("#"+btnId)||(ZPeopleComponents.select($("#"+id)).addOption({innerHTML:"<button id='"+btnId+"' class='zlabel zlabel--blue zlabel--outline zlabel--medium zpl_btncnt'>"+ZPI18N.getString("zp.addcat")+"</button>",isFooter:!0}),ZPeopleComponents.button($("#"+btnId),{click:FilesUtil.FolderModel.addEditFolder}))}respObj={results:folderArr,more:moreData},search(respObj)})},paginated:!0};var selectVal="files_placeUnder"==id?"/":ZPI18N.getString("zp.select");0==settingsPage.container.find("#"+id).length?(ZPeopleComponents.select($("#"+id),tokenObj),ZPeopleComponents.select($("#"+id)).setValue({id:"-1",name:selectVal})):(ZPeopleComponents.select(settingsPage.container.find("#"+id),tokenObj),ZPeopleComponents.select(settingsPage.container.find("#"+id)).setValue({id:"-1",name:selectVal}))}},toggleCheckBox:function(id,isCurrentContainer){var pageCont=FilesUtil.Page.getPageId(),tabGroup=FilesUtil.Page.getTabGroup(),parentContainer=FilesUtil.Page.getParentContainer();(isCurrentContainer&&settingsUrlProps.url.indexOf("-catId")>-1&&("1"===tabGroup?pageCont="orgFileSubList_List"+parentContainer:"0"===tabGroup&&(pageCont="empFileSubList_List"+parentContainer)),isCurrentContainer)?settingsPage.container.find("#"+pageCont).find("#"+id).prop("checked")?settingsPage.container.find("#"+pageCont).find("#"+id).prop("checked",!1):settingsPage.container.find("#"+pageCont).find("#"+id).prop("checked",!0):$("#"+id).prop("checked")?$("#"+id).prop("checked",!1):$("#"+id).prop("checked",!0)}},FilesUtil.Breadcrump={setDetail:function(catTree,parentContainer){var Breadcrumbs={};if(FilesUtil.Page.isModulePage()||FilesUtil.Page.isPolicyPage()){var value=catTree[catTree.length-1];Breadcrumbs[value.CatID]=value.CatName}else $.each(catTree,function(key,value){Breadcrumbs[value.CatID]=value.CatName});parentContainer==FilesUtil.Page.pageIdMap.ENT?FilesUtil.Page.orgSubCatViewData.Ent[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap.UNIT?FilesUtil.Page.orgSubCatViewData.Unit[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap.DIV?FilesUtil.Page.orgSubCatViewData.Div[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap.DEPT?FilesUtil.Page.orgSubCatViewData.Dept[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap.LOC?FilesUtil.Page.orgSubCatViewData.Loc[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap.ALL?FilesUtil.Page.empSubCatViewData.All[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap_mod.MY?FilesUtil.Page.empSubCatViewData_mod.My[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap_mod.ROLE?FilesUtil.Page.empSubCatViewData_mod.Role[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap_mod.SUB?FilesUtil.Page.empSubCatViewData_mod.Sub[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap_mod.TEAM?FilesUtil.Page.empSubCatViewData_mod.Team[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap_mod.MYDEPT?FilesUtil.Page.orgSubCatViewData_mod.Mydept[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap_mod.ORG?FilesUtil.Page.orgSubCatViewData_mod.Org[6]=Breadcrumbs:parentContainer==FilesUtil.Page.pageIdMap_pol.ORG&&(FilesUtil.Page.orgSubCatViewData_pol.Org[6]=Breadcrumbs),FilesUtil.Breadcrump.constructBreadcrumbs()},constructBreadcrumbs:function(catId){var catPathObj={},pageId="",parentContainer=FilesUtil.Page.getParentContainer();if(settingsUrlProps.niceUrl.indexOf("files/folders")>-1)catPathObj=FilesGeneralSettings.settingsCatPath,pageId=settingsPage.container.find("#categoryPath_settings");else{catPathObj=FilesUtil.Page.getPageData(parentContainer,"2")[6];parentContainer=FilesUtil.Page.getParentContainer();(pageId=settingsPage.container.find("#topMenu_breadCrump")).removeClass("zpl_DNI")}var breadCrumbs="";if(parentContainer==FilesUtil.Page.pageIdMap.ALL){var searchEmpDetails=FilesOperations.EmpFiles.EmpSearch.getPageData();null!=searchEmpDetails[2]&&void 0!=searchEmpDetails[2]&&"-1"!=searchEmpDetails[2]&&(breadCrumbs+='<div><div class="zpl_em"><div class="zpl_emimg zpl_cpd"><img src="'+searchEmpDetails[3]+'" data-title-position="bottom-left" title="'+ZSEC.Encoder.encodeForHTMLAttribute(searchEmpDetails[4])+'"></div></div></div>'),breadCrumbs+='<div onclick="FilesUtil.Breadcrump.reverseNavigationBreadcrumbs(\'home\',undefined,true)"; data-title-position="bottom" title="'+ZPI18N.getString("zp.home")+'"><a><i class="PI_fil_home"></i></a></div>'}else breadCrumbs+='<div onclick="FilesUtil.Breadcrump.reverseNavigationBreadcrumbs(\'home\',undefined,true)"; data-title-position="bottom" title="'+ZPI18N.getString("zp.home")+'"><a><i class="PI_fil_home"></i></a></div>';if(1==Object.keys(catPathObj).length)breadCrumbs+="<div><span>"+catPathObj[Object.keys(catPathObj)[0]]+"</span></div>";else if(2==Object.keys(catPathObj).length)breadCrumbs+="<div><span onclick=\"FilesUtil.Breadcrump.reverseNavigationBreadcrumbs('other','"+Object.keys(catPathObj)[0]+"',true)\">"+catPathObj[Object.keys(catPathObj)[0]]+"</span></div>",breadCrumbs+="<div><span>"+catPathObj[Object.keys(catPathObj)[1]]+"</span></div>";else{breadCrumbs+="<div><span onclick=\"FilesUtil.Breadcrump.reverseNavigationBreadcrumbs('other','"+Object.keys(catPathObj)[0]+"',true)\">"+catPathObj[Object.keys(catPathObj)[0]]+"</span></div>",breadCrumbs+='<i id="settings_BrdCrmp'+parentContainer+'" onclick="FilesUtil.Breadcrump.showMoreBreadCrump(this)" class="zpl_ibg PI_more" data-display-type="callout" data-title-position="bottom" title="'+ZPI18N.getString("zp.files.operations.prevfolders")+'"></i>';var lastBreadCrumb=Object.keys(catPathObj).length-1;breadCrumbs+="<div><span>"+catPathObj[Object.keys(catPathObj)[lastBreadCrumb]]+"</span></div>"}pageId.html(breadCrumbs)},showMoreBreadCrump:function(eve){var catPathObj={};if(settingsUrlProps.niceUrl.indexOf("files/folders")>-1)catPathObj=FilesGeneralSettings.settingsCatPath;else{var parentContainer=FilesUtil.Page.getParentContainer();catPathObj=FilesUtil.Page.getPageData(parentContainer,"2")[6]}for(var sharedToList=[],i=0;i<Object.keys(catPathObj).length;i++){var catKey=Object.keys(catPathObj)[i],catValue=catPathObj[catKey];i>0&&i<Object.keys(catPathObj).length-1&&sharedToList.push({id:catKey,label:catValue})}var divId="folderBreadcrump",forElement=eve.id;FilesOperations.MoreOption.showMoreMenu(divId,forElement,FilesOperations.MoreOption.getMenuObject(divId),sharedToList,!0)},reverseNavigationBreadcrumbs:function(mode,catId){if("home"===mode)settingsUrlProps.niceUrl.indexOf("files/folders")>-1?(settingsPage.container.find("#categoryPath_settings").empty(),FilesGeneralSettings.FolderSearch.subPageReset(),FilesGeneralSettings.FolderSearch.mainPageReset(),settingsPage.container.find("#settings_subcatList").addClass("zpl_DNI"),settingsPage.container.find("#settings_catList").removeClass("zpl_DNI"),settingsPage.container.find("#noDataIconWpr").addClass("zpl_DNI"),settingsPage.container.find("#searchFolder").removeClass("opn"),FilesGeneralSettings.fetchCategoryForSetting()):FilesOperations.FolderListing.redirectToListView("-1");else if("other"===mode){var newCatPath={},catPathObj={};if(settingsUrlProps.niceUrl.indexOf("files/folders")>-1)FilesGeneralSettings.settingsCurrentCatId=catId,newCatPath={},catPathObj=FilesGeneralSettings.settingsCatPath,settingsPage.container.find("#searchFolder").removeClass("opn");else{newCatPath={};var parentContainer=FilesUtil.Page.getParentContainer();catPathObj=FilesUtil.Page.getPageData(parentContainer,"2")[6]}for(var i=0;i<Object.keys(catPathObj).length;i++){var catKey=Object.keys(catPathObj)[i],catValue=catPathObj[catKey];if(catKey==catId){if(0==i&&(newCatPath[catKey]=catValue),catPathObj=newCatPath,settingsPage.container.scrollTop(0),settingsUrlProps.niceUrl.indexOf("files/folders")>-1)FilesGeneralSettings.settingsCatPath=catPathObj,FilesGeneralSettings.redirectToSubView(catId);else(parentContainer=FilesUtil.Page.getParentContainer())==FilesUtil.Page.pageIdMap.ENT?FilesUtil.Page.orgSubCatViewData.Ent[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap.UNIT?FilesUtil.Page.orgSubCatViewData.Unit[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap.DIV?FilesUtil.Page.orgSubCatViewData.Div[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap.DEPT?FilesUtil.Page.orgSubCatViewData.Dept[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap.LOC?FilesUtil.Page.orgSubCatViewData.Loc[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap.ALL?FilesUtil.Page.empSubCatViewData.All[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap_mod.MY?FilesUtil.Page.empSubCatViewData_mod.My[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap_mod.ROLE?FilesUtil.Page.empSubCatViewData_mod.Role[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap_mod.SUB?FilesUtil.Page.empSubCatViewData_mod.Sub[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap_mod.TEAM?FilesUtil.Page.empSubCatViewData_mod.Team[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap_mod.MYDEPT?FilesUtil.Page.orgSubCatViewData_mod.Mydept[6]=catPathObj:parentContainer==FilesUtil.Page.pageIdMap_pol.ORG&&(FilesUtil.Page.orgSubCatViewData_pol.Org[6]=catPathObj),FilesOperations.FolderListing.redirectToListView(catId);break}newCatPath[catKey]=catValue}}}},FilesUtil.FolderModel={modelId:"tabaddFolderPopUp_Files",popupId:"addFolderPopUp_Files",cardId:"cardaddFolderPopUp_Files",currentEditCatId:"",subFolderView_parentCatDetails:["-1","/"],ADDFOLDER_POPUP_MODAL:null,addPopup:function(){$(settingsPage.mainWrapId).find("#"+FilesUtil.FolderModel.cardId).html().trim();var html='<form><div class="zpl_crd"><div class="zpl_crdcnt">';html+='<div class="zpl_secn"> <div> <label class="zpl_mtry">'+ZPI18N.getString("zp.lms.base.foldername")+'</label> </div> <div> <input id="addFolderName" type="text" class="ztextbox" placeholder="'+ZPI18N.getString("zp.enterCategory")+'"></div> </div>',html+='<div id="placeUnderWpr" class="zpl_secn zpl_DNI"> <div> <label>'+ZPI18N.getString("zp.placedunder",new Array(""))+'</label> </div> <div> <select id="files_placeUnder" data-show-search-field="true"></select> </div> </div>',html+="</form></div></div>",$(settingsPage.mainWrapId).find("#"+FilesUtil.FolderModel.cardId).html(html)},closeAddFolder:function(){ZPeopleComponents.isComponent(settingsPage.container.find("#files_placeUnder"))&&ZPeopleComponents.select(settingsPage.container.find("#files_placeUnder")).destroy(),FilesUtil.FolderModel.ADDFOLDER_POPUP_MODAL.remove()},addEditFolder:function(mode,parentFolderId){if(FilesUtil.IP.isRestricted)FilesUtil.IP.showError(!0);else if(FilesUtil.Geo.isRestricted)FilesUtil.Geo.showError(!0);else{FilesUtil.FolderModel.currentEditCatId="edit"==mode&&null!=parentFolderId&&void 0!=parentFolderId&&""!=parentFolderId?parentFolderId:"",FilesUtil.FolderModel.popupName="edit"===mode?ZPI18N.getString("zp.files.settings.editfolder"):ZPI18N.getString("zp.addcat");var popupTab=new Tab(FilesUtil.FolderModel.popupId,FilesUtil.FolderModel.addPopup,FilesUtil.FolderModel.updateCategory);FilesUtil.FolderModel.ADDFOLDER_POPUP_MODAL=new popupModal(FilesUtil.FolderModel.popupName,popupTab),FilesUtil.FolderModel.ADDFOLDER_POPUP_MODAL.save=ZPI18N.getString("zp.save"),FilesUtil.FolderModel.ADDFOLDER_POPUP_MODAL.cancel=ZPI18N.getString("zp.cancel"),FilesUtil.FolderModel.ADDFOLDER_POPUP_MODAL.setCloseCallback(FilesUtil.FolderModel.closeAddFolder),FilesUtil.FolderModel.ADDFOLDER_POPUP_MODAL.construct(),$(settingsPage.mainWrapId).find("#"+FilesUtil.FolderModel.modelId).find(".zpl_mhder").find("h4").text(FilesUtil.FolderModel.popupName),FilesUtil.componentInit.folderListDropdown("files_placeUnder");var cardId=$(settingsPage.mainWrapId).find("#"+FilesUtil.FolderModel.cardId);if(cardId.find(".ztextbox--error__label").remove(),cardId.find(".ztextbox__error").removeClass("ztextbox__error"),cardId.find("#addFolderName").focus(),"edit"!=mode)cardId.find("#addFolderName").val(""),cardId.find("#placeUnderWpr").removeClass("zpl_DNI"),settingsUrlProps.niceUrl.indexOf("files/folders")>-1?ZPeopleComponents.select(cardId.find("#files_placeUnder")).setValue({id:FilesUtil.FolderModel.subFolderView_parentCatDetails[0],name:FilesUtil.FolderModel.subFolderView_parentCatDetails[1]}):ZPeopleComponents.select(cardId.find("#files_placeUnder")).setValue({id:"-1",name:"/"});else{cardId.find("#placeUnderWpr").addClass("zpl_DNI");var editFolderName="";if(settingsUrlProps.niceUrl.indexOf("files/folders")>-1){editFolderName="";editFolderName="-1"===FilesUtil.FolderModel.subFolderView_parentCatDetails[0]?settingsPage.container.find("#settings_catList").find("#catLi_"+parentFolderId).find(".zpl_Fldtl").find("h5").text():settingsPage.container.find("#settings_subcatList").find("#catLi_"+parentFolderId).find(".zpl_Fldtl").find("h5").text()}else{var pageId=FilesUtil.Page.getPageId();editFolderName=settingsPage.container.find("#"+pageId).find("#catLi_"+parentFolderId).find("h5").text()}null!=editFolderName&&void 0!=editFolderName&&""!=editFolderName&&cardId.find("#addFolderName").val(editFolderName)}}},updateCategory:function(){if(FilesUtil.IP.isRestricted)FilesUtil.IP.showError(!1);else if(FilesUtil.Geo.isRestricted)FilesUtil.Geo.showError(!1);else if(FilesUtil.settingsAdmin||0===FilesUtil.loginUserRoleCheck||1===FilesUtil.loginUserRoleCheck){var mode="add";null!=FilesUtil.FolderModel.currentEditCatId&&void 0!=FilesUtil.FolderModel.currentEditCatId&&""!=FilesUtil.FolderModel.currentEditCatId&&"-1"!=FilesUtil.FolderModel.currentEditCatId&&(mode="edit");var cardId=$(settingsPage.mainWrapId).find("#"+FilesUtil.FolderModel.cardId),newCatName=cardId.find("#addFolderName").val().trim();if(cardId.find("#addFolderName_exist_error").remove(),""===newCatName)return cardId.find("#addFolderName").addClass("ztextbox__error"),cardId.find("#addFolderName").after('<span class="ztextbox--error__label" id="addFolderName_exist_error">'+ZPI18N.getString("zp.enterCategory")+"</span>"),!0,!1;if(-1!=newCatName.indexOf("<")||-1!=newCatName.indexOf(">")||-1!=newCatName.indexOf("&lt;")||-1!=newCatName.indexOf("&gt;"))return cardId.find("#addFolderName").addClass("ztextbox__error"),cardId.find("#addFolderName").after('<span class="ztextbox--error__label" id="addFolderName_exist_error">'+ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.catName")))+"</span>"),!0,!1;if(null!=newCatName&&void 0!=newCatName&&"/"===newCatName)return cardId.find("#addFolderName").addClass("ztextbox__error"),cardId.find("#addFolderName").after('<span class="ztextbox--error__label" id="addFolderName_exist_error">'+ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.lms.base.foldername")))+"</span>"),!0,!1;if(newCatName.length>250)return cardId.find("#addFolderName").addClass("ztextbox__error"),cardId.find("#addFolderName").after('<span class="ztextbox--error__label" id="addFolderName_exist_error">'+ZPI18N.getString("zp.files.settings.foldernamelimit")+"</span>"),!0,!1;var formData=new FormData;if(formData.append("newCatName",newCatName),"edit"===mode)formData.append("catId",FilesUtil.FolderModel.currentEditCatId);else{var parentCatId=ZPeopleComponents.select($("#files_placeUnder")).getValue();formData.append("parentCatId",parentCatId)}formData.append(csrfParamName,csrfToken),$.ajax({url:"/zpfiles/settings/updateFolder",type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){if(void 0!=data[1]){FilesUtil.Page.getPageId();if(FilesUtil.resetAllFolderDD(),"edit"===mode)settingsUrlProps.niceUrl.indexOf("files/folders")>-1?(settingsPage.container.find("#addFolderBtn").removeClass("zpl_DNI"),"-1"===FilesUtil.FolderModel.subFolderView_parentCatDetails[0]?settingsPage.container.find("#settings_catList").find("#catLi_"+data[1].CatID).find(".zpl_Fldtl").find("h5").text(newCatName):settingsPage.container.find("#settings_subcatList").find("#catLi_"+data[1].CatID).find(".zpl_Fldtl").find("h5").text(newCatName)):FilesOperations.Page.reloadOtherPages(),ZPeople.Message.success(ZPI18N.getString("zp.files.settings.editfoldermsg"));else{if(settingsUrlProps.niceUrl.indexOf("files/folders")>-1){var setPageId="";"-1"!=parentCatId&&parentCatId==parentCatId?setPageId="settings_subcatList":"-1"===parentCatId&&(setPageId="settings_catList"),settingsPage.container.find("#noDataIconWpr").hasClass("zpl_DNI")||(settingsPage.container.find("#noDataIconWpr").addClass("zpl_DNI"),settingsPage.container.find("#"+setPageId).removeClass("zpl_DNI"));var row=FilesGeneralSettings.constructFolderHtml(data[1].CatID,data[1].CatName);settingsPage.container.find("#"+setPageId).prepend(row),settingsPage.container.find("#addFolderBtn").removeClass("zpl_DNI")}else{var tabGroup=FilesUtil.Page.getTabGroup();"1"===tabGroup||"0"===tabGroup?FilesUtil.FolderModel.setNewFolderValInSelect(data[1].CatID,data[1].CatName):ZPA_Esign.setNewFolderValInSelect(data[1].CatID,data[1].CatName)}ZPeople.Message.success(ZPI18N.getString("zp.folderaddedsucc"))}FilesUtil.FolderModel.ADDFOLDER_POPUP_MODAL.close()}},error:function(req){var errResponse=req.responseJSON[1];8113!==req.status&&500!==req.status&&8006!==req.status||ZPeople.Message.failure(errResponse.msg)}})}else ZPeople.Message.failure(ZPI18N.getString("zp.files.operations.permdeny"))},setNewFolderValInSelect:function(val,name){var eleId="";"1"===FilesUtil.Page.getTabGroup()?(eleId="addOrgFile_Folder",settingsPage.container.find("#esignorg").hasClass("zpl_mopen")&&(eleId="agrselect_Cat")):eleId=settingsPage.container.find("#tabimpEmpFile").hasClass("zpl_mopen")?"imp_addEmpFile_Folder":settingsPage.container.find("#tabesignfiles").hasClass("zpl_mopen")?"agrselect_Cat":"addEmpFile_Folder",null!=val&&void 0!=val&&""!=val&&-1!=val&&""!=eleId&&ZPeopleComponents.select(settingsPage.container.find("#"+eleId)).setValue({id:val,name:name})},deleteFolderPopup:function(catId){if(FilesUtil.IP.isRestricted)FilesUtil.IP.showError(!1);else if(FilesUtil.Geo.isRestricted)FilesUtil.Geo.showError(!1);else if(FilesUtil.settingsAdmin||0===FilesUtil.loginUserRoleCheck||1===FilesUtil.loginUserRoleCheck){settingsPage.container;var deleteAlertMessage=new DeleteAlertMessage;deleteAlertMessage.title=ZPI18N.getString("zp.files.operations.deletefolder"),deleteAlertMessage.despcription=ZPI18N.getString("zp.files.operations.deletefolderinfo"),deleteAlertMessage.yesButtonText=ZPI18N.getString("zp.confirm"),deleteAlertMessage.cancelButtonText=ZPI18N.getString("zp.cancel"),deleteAlertMessage.callback=function(obj){var formData=new FormData;formData.append("deleteCatId",catId),formData.append(csrfParamName,csrfToken),$.ajax({url:"/zpfiles/settings/deleteFolder",type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){if(void 0!=data[1]){if(settingsUrlProps.niceUrl.indexOf("files/folders")>-1){var setPageId="";setPageId="-1"===FilesUtil.FolderModel.subFolderView_parentCatDetails[0]?"settings_catList":"settings_subcatList",settingsPage.container.find("#"+setPageId).find("#catLi_"+catId).remove(),settingsPage.container.find("#"+setPageId).is(":empty")&&(settingsPage.container.find("#noDataIconWpr").removeClass("zpl_DNI"),settingsPage.container.find("#"+setPageId).addClass("zpl_DNI"),settingsPage.container.find("#addFolderBtn").addClass("zpl_DNI"))}else FilesOperations.Page.reloadOtherPages();ZPeople.Message.success(ZPI18N.getString("zp.files.operations.folderdelinfo")),FilesUtil.resetAllFolderDD()}},error:function(req){var errResponse=req.responseJSON[1];ZPeople.Message.failure(errResponse.msg)}})},deleteAlertMessage.show()}}},FilesUtil.MandatoryFiles={MANDACK_MODAL:null,modelId:"tabmandAck_Files",cardId:"cardmandAck_Files",constructCard:function(data,length){var fileId=data.id,fileName=data.name,fileExtn=FilesUtil.Page.getFileExtn(data.additional_info.fileExtn,data.additional_info.filePath,data.additional_info.UploadSource,data.additional_info.isWorkDriveFile),fileIconClass=FileUpload.getFileIcon(fileExtn),deadLineDays=data.ends_in,row='<div><i class="'+fileIconClass+'"></i></div><div class="zpl_msp-dts zpl_cp"><div class="zpl_msp-name zpl_clamp-1" onclick="FilesHome.Activity.fetchDataForPreview(\''+fileId+'\');"><span class="zpl_msp-title">'+ZSEC.Encoder.encodeForHTML(fileName)+"</span></div>";return void 0!=data.is_completed&&""!=data.is_completed&&1==data.is_completed?row+='</div><div class="zpl_msp-act"><div class="zpl_hvr zpl_hvrsw"><i class="PI_tick2_fil grn zpl_h3"></i></div></div>':(row+='<span class="zpl_flex-a-c zpl_gap-1">',row+=deadLineDays<0?'<span class="red">'+ZPI18N.getString("zp.overdue")+"</span>":0==deadLineDays?'<span class="red">'+ZPI18N.getString("zp.duetoday")+"</span>":1==deadLineDays?"<span>"+ZPI18N.getString("zp.dayleft",new Array(deadLineDays+""))+"</span>":"<span>"+ZPI18N.getString("zp.daysleft",new Array(deadLineDays+""))+"</span>",row+="</span></div>",row+='<div class="zpl_msp-act">',row+=1==length?'<div class="zpl_hvr zpl_hvrsw">':'<div class="zpl_hvr">',row+='<button id="mySpace_files_ack_'+fileId+'" class="zlabel zlabel--blue zlabel--medium zlabel--primary" onclick="FilesHome.Activity.fetchDataForPreview(\''+fileId+"');\">"+ZPI18N.getString("zp.files.operations.viewandack")+"</button></div></div>"),row}};var FileUpload={uploadFileEleId:"",udsParams:{fileId:"-1",fileVersion:"",fileName:""},uploadMode:"",uploadFieldDivId:"",attachementDivId:"",attachFileNameDiv:"",fileExtn:"",getAttachFileHtml:function(fileName,fileType){return'<div class="zpl_atchd"><div id="currentFile"><div class="zpl_atchimg"><i class="'+FileUpload.getFileIcon(fileType)+'"></i></div><div class="zpl_atchdtl"><h4 id="attachedFileName">'+ZSEC.Encoder.encodeForHTML(fileName)+'</h4></div><div class="zpl_atchicn"><i class="PI_delete" onclick="FileUpload.removeFile()"></i></div><div class="zpl_prgbr zpl_DNI"><div><div data-progressjs="fileUpload_Progress" style="width:0%"></div></div></div></div></div>'},getFileIcon:function(fileExtn){void 0==fileExtn&&(fileExtn="pdf");return"pdf"===(fileExtn=fileExtn.toLowerCase())?"PI_ft_pdf":"xls"===fileExtn||"xlsx"===fileExtn||"xlsm"===fileExtn||"sxc"===fileExtn||"ods"===fileExtn||"csv"===fileExtn||"tsv"===fileExtn?"PI_ft_xls":"htm"===fileExtn||"html"===fileExtn?"PI_ft_html":"doc"===fileExtn||"docx"===fileExtn||"sxw"===fileExtn||"odt"===fileExtn||"rtf"===fileExtn?"PI_ft_doc":"ppt"===fileExtn||"pps"===fileExtn||"odp"===fileExtn||"sxi"===fileExtn||"pptx"===fileExtn?"PI_ft_ppt":"zip"===fileExtn?"PI_ft_zip":"mp3"===fileExtn||"mp4a"===fileExtn||"wav"===fileExtn?"PI_ft_mp3":"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn?"PI_ft_img":"workdrive"===fileExtn?"PI_workdrive":"txt"===fileExtn?"PI_ft_txt":"mov"==fileExtn||"wmv"==fileExtn||"mpeg"==fileExtn||"mpg"==fileExtn||"mp4"==fileExtn||"webm"==fileExtn||"webmv"==fileExtn?"PI_ft_mov":"PI_ft_unknwn"},checkFileSize:function(fileSize){var isFileSizeValid=!0;return fileSize>("imp_empFile_uploadFileDiv"==FileUpload.uploadFieldDivId?1e6*maxFileSizeForImport.split("MB")[0]:1e6*maxFileSize_filesModule.split("MB")[0])&&(isFileSizeValid=!1),isFileSizeValid},onSelect:function(eve){FileUpload.resetUploadParams(),FileUpload.uploadMode="localUpload",FileUpload.uploadFileEleId=eve.id,FileUpload.setFileDivIds();var localFileInpBx=$('<div><input type="file"></div>');FileUpload.uploadFileEleId.indexOf("imp_addEmpFile_localUpload")>-1&&(localFileInpBx=$('<div><input type="file" accept=".zip"></div>')),localFileInpBx.find("input").trigger("click"),localFileInpBx.find("input").off("change").on("change",function(event){var file=$(this)[0].files[0],fileName=file.name,fileSize=file.size;if(fileName=fileName.replace("C:\\fakepath\\",""),!FileUpload.checkFileSize(fileSize)){var errFileSize=maxFileSize_filesModule;return"imp_empFile_uploadFileDiv"==FileUpload.uploadFieldDivId&&(errFileSize=maxFileSizeForImport),void ZPeopleComponents.AlertBanner.show({message:ZPI18N.getString("zp.filesizelimit",[errFileSize]),type:"error",closeButton:!0,hideDelay:2e3})}var fileExtn=fileName.substring(fileName.lastIndexOf(".")+1,fileName.length);FileUpload.attachFile(fileName,fileExtn),FileUpload.showProgressBar(),FileUpload.udsParams.fileName=fileName,FileUpload.fileExtn=fileExtn,FileUpload.uploadFileByXHR(file)})},uploadFileByXHR:function(file){var xhr=new XMLHttpRequest,uploadId_files=lmsfileuploaddownload.generateUniqueKey();xhr.upload.uploadId=uploadId_files;var udsUploadApi=UPLOAD_URL+"/"+UDS_UPLOAD_SERVICE_CODE+"/ver1/stream/upload";xhr.open("post",udsUploadApi,!0),xhr.setRequestHeader("x-assured-response",!0),xhr.setRequestHeader("x-streammode","1"),xhr.setRequestHeader("x-fclient-version","2"),xhr.setRequestHeader("app-info",JSON.stringify({portalId:_LOGGEDIN_ACCZSOID,moduleName:"Files"})),xhr.setRequestHeader("file-info",JSON.stringify({fileName:encodeURIComponent(file.name),contentType:file.type,fileSize:file.size})),xhr.setRequestHeader("upload-id",uploadId_files),xhr.withCredentials=!0,xhr.onreadystatechange=function(oEvent){if(4==xhr.readyState)if(200===xhr.status){var responseObj=JSON.parse(xhr.response);FileUpload.uploadCallBack(responseObj)}else 200!==xhr.status&&FileUpload.failureCallBack(params)},xhr.send(file)},uploadSuccessBar:function(){var progressDiv=$("#"+FileUpload.attachementDivId).find("div[data-progressjs='fileUpload_Progress']");progressJs("div[data-progressjs='fileUpload_Progress']").end(),progressDiv[0].style.width="100%"},uploadCallBack:function(uploadedFileInfo){if(this.uploadedFileInfo=uploadedFileInfo,uploadedFileInfo.fileInfo){var fileInfo=uploadedFileInfo.fileInfo;FileUpload.udsParams.fileId=fileInfo.fileId,FileUpload.udsParams.fileVersion=fileInfo.fileVersion,FileUpload.uploadSuccessBar()}else"Failure"==uploadedFileInfo.status&&FileUpload.failureCallBack(uploadedFileInfo)},failureCallBack:function(uploadedFileInfo){var antivirus=!1;null!=uploadedFileInfo.message&&void 0!=uploadedFileInfo.message&&""!=uploadedFileInfo.message&&("Virus Found"==uploadedFileInfo.message?antivirus=!0:uploadedFileInfo.message),$("#"+FileUpload.attachementDivId).find("#currentFile").addClass("zpl_flerr");var progressDiv=$.find("div[data-progressjs='fileUpload_Progress']");progressJs("div[data-progressjs='fileUpload_Progress']").kill(),progressDiv[0].style.width="100%",$("#"+FileUpload.attachementDivId).find("#attachedFileName").after('<p><span><i class="IC-reload" onclick="FileUpload.removeFile()">'+ZPI18N.getString("zp.retry")+"</i></span></p>"),antivirus?ZPeopleComponents.AlertBanner.show({message:ZPI18N.getString("zp.lms.messages.virusfound"),type:"error",closeButton:!0,hideDelay:2e3}):ZPeopleComponents.AlertBanner.show({message:ZPI18N.getString("zp.fileuploaderror"),type:"error",closeButton:!0,hideDelay:2e3})},generateUniqueKey:function(){return(new Date).getTime()+""+erecno},setFileDivIds:function(){var tabGroup=FilesUtil.Page.getTabGroup();"1"==tabGroup||settingsUrlProps.url.indexOf("/hrdocuments")>-1?(FileUpload.uploadFieldDivId="orgFile_uploadFileDiv",FileUpload.attachementDivId="orgfile_uploaded",FileUpload.attachFileNameDiv="addOrgFile_fileName"):"0"==tabGroup?FileUpload.uploadFileEleId.indexOf("imp_addEmpFile_localUpload")>-1?(FileUpload.uploadFieldDivId="imp_empFile_uploadFileDiv",FileUpload.attachementDivId="imp_empfile_uploaded"):(FileUpload.uploadFieldDivId="empFile_uploadFileDiv",FileUpload.attachementDivId="empfile_uploaded",FileUpload.attachFileNameDiv="addEmpFile_fileName"):("2"==tabGroup||settingsUrlProps.url.indexOf("myspace/overview-files")>-1)&&(FileUpload.uploadFieldDivId="persFile_uploadFileDiv",FileUpload.attachementDivId="persfile_uploaded",FileUpload.attachFileNameDiv="addPersFile_fileName")},attachFile:function(fileName,fileExtn){FileUpload.setFileDivIds(),""!=FileUpload.attachFileNameDiv&&$("#"+FileUpload.attachFileNameDiv).val(fileName);var attachFileHtml=FileUpload.getAttachFileHtml(fileName,fileExtn);$("#"+FileUpload.uploadFieldDivId).addClass("zpl_DNI"),$("#"+FileUpload.attachementDivId).parent().removeClass("zpl_DNI"),$("#"+FileUpload.attachementDivId).append(attachFileHtml)},showProgressBar:function(){$("#"+FileUpload.attachementDivId).find("#currentFile").find(".zpl_prgbr").removeClass("zpl_DNI"),progressJs("div[data-progressjs='fileUpload_Progress']").autoIncrease(8,10)},removeFile:function(){""!=FileUpload.attachementDivId&&""!==FileUpload.uploadFieldDivId&&($("#"+FileUpload.attachementDivId).html(""),$("#"+FileUpload.attachementDivId).parent().addClass("zpl_DNI"),$("#"+FileUpload.uploadFieldDivId).removeClass("zpl_DNI")),FileUpload.resetUploadParams()},resetUploadParams:function(){FileUpload.udsParams.fileId="-1",FileUpload.udsParams.fileVersion="",FileUpload.udsParams.fileName="",FileUpload.uploadMode="",FileUpload.fileExtn=""}};FileUpload.CloudPicker={UPLOADOBJ:{},showModal:function(){FileUpload.uploadMode="cloudUpload",FileUpload.setFileDivIds(),CloudPicker.init("",FileUpload.CloudPicker.uploadCloudFile),CloudPicker.construct()},uploadCloudFile:function(){var obj=JSON.parse(CloudPicker.getFileObj()),fileName=obj.docName,fileExtn=fileName.substring(fileName.lastIndexOf(".")+1,fileName.length);FileUpload.attachFile(decodeURIComponent(fileName),fileExtn),FileUpload.showProgressBar(),FileUpload.CloudPicker.UPLOADOBJ=obj,FileUpload.uploadSuccessBar()}},FileUpload.WorkDrive={UPLOADOBJ:{},showModal:function(){FileUpload.uploadMode="workDriveUpload",FileUpload.setFileDivIds(),WorkDriveInt.showWorkDriveModal("Files")},upload:function(obj){FileUpload.attachFile(obj.fileName,"workdrive"),FileUpload.showProgressBar(),FileUpload.WorkDrive.UPLOADOBJ=obj,FileUpload.uploadSuccessBar()}};