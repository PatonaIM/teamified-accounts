var regularization_operation={pageId:void 0,fireScrollObj:null,isAllLevelApprove:!1,approvalType:0,isFromImport:!1,regDate:null,leavePageErecno:void 0,currentErecno:void 0,init:function(viewPage){regularization_operation.initializeReqVariables(),settingsPage.fireScrollObj[Att_Common_Operations.myRequestPageId]?regularization_operation.fireScrollObj=settingsPage.fireScrollObj[Att_Common_Operations.myRequestPageId]:(regularization_operation.fireScrollObj=new FireScrollBack(regularization_operation.getReqOnScroll,"#"+Att_Common_Operations.myRequestPageId,Att_Common_Operations.myRequestPageId),regularization_operation[Att_Common_Operations.myRequestPageId+"SIndex"]=0),viewPage&&regularization_operation.getAttendanceRegDetails(void 0,void 0,Att_Common_Operations.approvalCloseCallBack),Att_Common_Operations.myRequestPage.children().length<2?(regularization_operation.constructRegPage(Att_Common_Operations.myRequestPage),regularization_operation.currentErecno=Layout.Page.urlparam.id?Layout.Page.urlparam.id:regularization_operation.currentErecno):Att_Common_Operations.isSingleUserTeamPage()&&Layout.Page.urlparam.id&&(void 0==regularization_operation.currentErecno||regularization_operation.currentErecno!=Layout.Page.urlparam.id)&&($("#"+Att_Common_Operations.myRequestPageId).html(""),regularization_operation.currentErecno=Layout.Page.urlparam.id,regularization_operation.constructRegPage(Att_Common_Operations.myRequestPage)),landingPage.addClass("zpl_tblfxd zpl_crdwthful"),landingPage.find(".actn_ovrly .PI_cls").trigger("click"),Att_Common_Operations.closeFilterifOpen()},initRegReqFromEntry:function(){regularization_operation.initializeReqVariables(),regularization_operation.constructRequestReg()},isRegReasonsEnabled:function(){return ZPeople.Module.MODULE_DATA.attendance.isRegReasonsEnabled},initializeReqVariables:function(){isManageAttendanceData=ZPeople.Module.MODULE_DATA.attendance.isManageAttedance,repMan=ZPeople.Module.MODULE_DATA.attendance.isLeadForShift,isEmpChooseApp=ZPeople.Module.MODULE_DATA.attendance.isEmpChooseApp,spocRegView=ZPeople.Module.MODULE_DATA.attendance.isSPOCEntryViewAllowed,isRegConfigured=ZPeople.Module.MODULE_DATA.attendance.isRegConfigured,isadmin&&(isManageAttendanceData=!0)},constructRegPopUpfromLeave:function(date,month,year,erecno){if(Att_Common_Operations.isModuleDataLoaded)regularization_operation.initializeReqVariables(),landingPage=settingsPage.container,regularization_operation.leavePageErecno=erecno,regularization_operation.constructRequestReg(void 0,date,month,year,!0);else{var params={initmodule:JSON.stringify({modulePrefix:"attendance"})};ZPeople.Request.send("/gettabdetails/initpage",params,function(result){result.initmodule&&(ZPeople.Module.MODULE_DATA.attendance=result.initmodule,Att_Common_Operations.isModuleDataLoaded=!0,regularization_operation.constructRegPopUpfromLeave(date,month,year,erecno))})}},getReqOnScroll:function(){regularization_operation[Att_Common_Operations.myRequestPageId+"SIndex"]+=Att_Common_Operations.recordsPerReq,regularization_operation.getData(!0)},constructRegPage:function(page){var extraDetails={pageId:"reg"},html='<div class="zpl_btnmnu">',deleteIconHtml='<div class="actn_ovrly">';deleteIconHtml+='<div><button class="zlabel zlabel--red zlabel--medium"  onclick="Att_Common_Operations.deleteConfirm(\''+ZPI18N.getString("zp.regdeletetitle")+"', '"+ZPI18N.getString("zp.regdeletemsg")+"', '"+ZPI18N.getString("zp.confirm")+"','"+JSON.stringify(extraDetails).replace(/'/g,"&apos;").replace(/"/g,"&quot;")+"')\" >"+ZPI18N.getString("zp.delete")+"</button></div>",deleteIconHtml+='<i class="PI_cls" onclick="Att_Common_Operations.changeCheckBox(this, \'removeAll\')" title="'+ZPI18N.getString("zp.close")+'"></i>',html+=deleteIconHtml+="</div>",html+="<div></div>",html+='<div class="j-cnt-cntr"><div class="zpl_inav"><i class="PI_alft tooltip-js blu zpl_cp" onclick="regularization_operation.getData(false, true, -1)"></i>  <i class="PI_monthly" id="regCalNav"></i><i class="PI_argt tooltip-js blu zpl_cp" onclick="regularization_operation.getData(false, true, 1)"></i></div><div elem="dateNavigator" id="ZPAtt_regReq_dateNav"></div></div>',html+='<div class="zpl_rgt">',(Att_Common_Operations.isOwnPage()||isadmin||!Att_Common_Operations.isSingleUserTeamPage()&&!Att_Common_Operations.isTeamReqPage()&&(Att_Common_Operations.isRequestPage()||Att_Common_Operations.isSelfReqPage())||(Att_Common_Operations.isSingleUserTeamPage()||Att_Common_Operations.isTeamReqPage())&&ZPeople.Module.MODULE_DATA.attendance.entryEditAllowed)&&(html+='<button class="zlabel zlabel--blue zlabel--medium" aria-label="'+ZPI18N.getString("zp.addrequests")+'" tabindex="0" onclick="regularization_operation.constructRequestReg();">'+ZPI18N.getString("zp.addrequests")+"</button>"),html+='<i class="zpl_ibg PI_fltr" aria-label="'+ZPI18N.getString("zp.filter")+'" tabindex="0" title="'+ZPI18N.getString("zp.filter")+'" onclick ="Att_Common_Operations.changeFilterClass();"></i>',html+=Att_Common_Operations.getMoreOptionHtml(),html+='</div></div><div class="zpl_rgtcnt"><div class="zpl_tblres"  id="ZPAtt_RegMyReq">',html+='<table class="zpl_tbl reg_tbl" id= "ZPAtt_RegMyReqDetails"><thead><tr id="ZPAtt_RegMyReqHeader">',html+='<th id="ZPAtt_RegMyReqHeader_checkBox"><div class="zcheckbox"><input id="regRequestAll" type="checkbox" name="check" value="" class="zcheckbox__helper" onchange="Att_Common_Operations.changeCheckBox(this, \'all\')"><label for="regRequestAll" class="zcheckbox__label"></label></div></th>',html+="<th>"+ZPI18N.getString("zp.employee"),Att_Common_Operations.isSelfReqPage()||(html+='<div class="zpl_icncnt"><i class="PI_sort tooltip-js" id="regEmpSort" data-menu-id="sortDropdown" title='+ZPI18N.getString("zp.sort")+"></i></div>"),html+='</th><th class="tblthead"><table class="zpl_tblcntr zpl_itbl wd100_per"><thead><tr><th class="w200" rowspan="2">'+ZPI18N.getString("zp.workedday")+'</th> <th class="w300" colspan="2">'+ZPI18N.getString("zp.hourslog")+'</th><th class="w300" colspan="2">'+ZPI18N.getString("zp.status")+'</th> <th class="w200" rowspan="2" id="ZPAtt_RegMyReqHeader_Reason">'+ZPI18N.getString("zp.reason")+'</th></tr><tr><th class="w150">'+ZPI18N.getString("zp.old")+'</th> <th class="w150">'+ZPI18N.getString("zp.new")+'</th><th class="w150">'+ZPI18N.getString("zp.old")+'</th><th class="w150">'+ZPI18N.getString("zp.new")+"</th></tr></thead></table></th>",html+="<th>"+ZPI18N.getString("zp.approvalstatus")+'</th></tr></thead><tbody id="ZPAtt_RegMyReqBody"></tbody></table></div></div>',html+=Att_Common_Operations.getFilterHtml(),html+='<div><button id="addPolicy1" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="regularization_operation.getData(false, true);">'+ZPI18N.getString("zp.apply")+'</button> <button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="Att_Common_Operations.resetFilterOptions()">'+ZPI18N.getString("zp.reset")+"</button></div>";var moreOpt=[{type:"import",name:ZPI18N.getString("zp.import"),callback:"regularization_operation.Import.construct"},{type:"export",name:ZPI18N.getString("zp.export"),callback:"Att_Common_Operations.Export.construct"},{type:"download",name:ZPI18N.getString("zp.downloadpdf"),callback:"Att_Common_Operations.ExportPDF.construct"},{type:"print",name:ZPI18N.getString("zp.print"),callback:"Att_Common_Operations.print"}];page.append(html),Att_Common_Operations.appendTopStatusAndEmpFilter(),Att_Common_Operations.moreOptionMenu(moreOpt),Att_Common_Operations.initializeTooltip(),Att_Common_Operations.addClickEventAndCallBack(page.find(".CR-sort"),regularization_operation.sort),Att_Common_Operations.constructFilterDropdown(page),regularization_operation.getData(),page.parent().parent().attr({"aria-label":ZPI18N.getString("zp.common.tabname",[ZPI18N.getString("zp.regularization")]),tabindex:"0"})},deleteRegList:function(listId){var params={mode:"deleteRegList",listId:listId,conreqcsr:csrfToken},page=landingPage;$.post("/AttendanceAction.zp",params,function(resultData){if(void 0!=resultData&&"success"==resultData.status){if(page.find("#ZPAtt_RegMyReq").is(":visible")){for(var deleted_Id=listId.split(","),i=0;i<deleted_Id.length;i++)page.find("#ZPAtt_RegMyReq").find("#list-"+deleted_Id[i]).remove();0===page.find("#ZPAtt_RegMyReqBody tr").length&&(page.find(".zpl_rgtcnt").children().hide(),0===page.find(".zpl_rgtcnt").find("#emptPage").length?(page.find(".zpl_rgtcnt").append('<div id="emptyDivCnt"></div>'),Att_Common_Operations.emptyPages(ZPI18N.getString("zp.nodatamsg",new Array(ZPI18N.getString("zp.sregularization"))))):page.find(".zpl_rgtcnt").find("#emptyDivCnt").show()),page.find("#ZPAtt_RegMyReqDetails").find("thead input[type=checkbox]:enabled").prop("checked",!1),page.find(".actn_ovrly").removeClass("opn")}ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.regdeletesuccessmsg"))}else ModuleComp.Msg.showFailureMsg(resultData.message)})},setApprovalSett:function(data){regularization_operation.approvalSett=data},getAttendanceRegDetails:function(formId,recordId,closeCallBack){if(Att_Common_Operations.isModuleDataLoaded){var title=ZPI18N.getString("zp.myrequests"),html='<div class="zpl_crd"><div class="zpl_crdcnt oh">';html+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.employeename")+"</label></div>",html+='<div  id="ZPAtt_Reg_userName"><span><b></b></span></div></div>',html+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.date")+"</label></div>",html+='<div id="attendRegDispDate"><span><b></b></span></div></div>',html+='<div class="zpl_secn" id="attachMentDiv" style="display: none;"><div><label>'+ZPI18N.getString("zp.attachment")+"</label></div>",html+='<div class="zpl_atchd"><div><div class="zpl_atchimg"><i id="fileExtIcon"></i></div>',html+='<div class="zpl_atchdtl" id="attachMentName"></div>',html+='<div class="zpl_atchicn"><a class="download-link" download><i class="PI_downld"></i></a></div></div></div></div>',html+='<div class="zpl_secn"><div><div class="zpl_tblres ova">',html+='<table class="zpl_tbl reg_tbl zpl_nocrsor" id="attRegDetTable">',html+='<thead id="attendanceRegListHeader">',html+='<tr><th class="tblthead"><table class="zpl_tblcntr zpl_itbl"><thead><tr><th class="mw150" rowspan="2">'+ZPI18N.getString("zp.workedday")+"</th>",html+='<th  class="mw200" colspan="2">'+ZPI18N.getString("zp.checkin")+"</th>",html+='<th  class="mw200" colspan="2">'+ZPI18N.getString("zp.checkout")+"</th>",html+='<th  class="mw200" colspan="2">'+ZPI18N.getString("zp.hourslog")+"</th>",html+='<th  class="mw200" colspan="2">'+ZPI18N.getString("zp.status")+'</th><th class="w150" rowspan="2" id="attendanceRegListHeader_Reason">'+ZPI18N.getString("zp.reason")+'</th><th class="mw150" rowspan="2">'+ZPI18N.getString("zp.description")+"</th>",html+='<th id="approveChkBox" rowspan="2" class="mw150"><div id="regBulkApprovalRej" style="display:none"><i id="regAllApprove" title="Approve" class="PI_tick2_fil grn S18" onClick="regularization_operation.allcheckAppRej(this,true);"></i></div><div id="regApprovalState">'+ZPI18N.getString("zp.approvalstatus")+"</div></th></tr>",html+='<tr><th class="mw100">'+ZPI18N.getString("zp.old")+'</th><th class="mw100">'+ZPI18N.getString("zp.new")+'</th><th class="mw100">'+ZPI18N.getString("zp.old")+'</th><th class="mw100">'+ZPI18N.getString("zp.new")+'</th><th class="mw100">'+ZPI18N.getString("zp.old")+'</th><th class="mw100">'+ZPI18N.getString("zp.new")+'</th><th class="mw100">'+ZPI18N.getString("zp.old")+'</th><th class="mw100">'+ZPI18N.getString("zp.new")+"</th></tr>",html+="</thead></table></th></tr></thead>",html+='<tbody id= "attendanceRegListBody"></tbody></table></div></div></div></div></div>';var footerHtml='<div class="zpl_mfoter d-flexclmcap" id="ZPAtt_Reg_AppHierarchy">';footerHtml+='<div class="d-flexC flexclmcap12 zpl_DNI" id="zp_appproval_comment_div"><div><label>'+ZPI18N.getString("zp.comment")+'</label></div><div class="flex-grow"><textarea type="text" placeholder="" rows="4" class="ztextbox" id="zp_appproval_comment_text"></textarea></div></div>',footerHtml+='<div class="zpl_btnsplt"><div id="splitApprovalButtons">',footerHtml+='<button type="button" class="zlabel zlabel--green zlabel--medium DN" approvaltype="1"  id="zp_appproval_approve_btn" onclick="regularization_operation.approveRejCommentClbck(this);">'+ZPI18N.getString("zp.approve")+"</button>",footerHtml+='<button type="button" class="zlabel zlabel--blue zlabel--outline zlabel--medium DN" approvaltype="1"  id="zp_appproval_all_approve_btn" onclick="regularization_operation.approveRejCommentClbck(this);">'+ZPI18N.getString("zp.approveall")+"</button>",footerHtml+='<button type="button" class="zlabel zlabel--red  zlabel--medium DN" approvaltype="0"  id="zp_appproval_reject_btn" onclick="regularization_operation.approveRejCommentClbck(this);">'+ZPI18N.getString("zp.rejectall")+"</button>",footerHtml+='<button type="button" class="zlabel zlabel--outline zlabel--medium DN" id="cancelRegIndividual">'+ZPI18N.getString("zp.cancelreg")+"</button>",footerHtml+='<button type="button" class="zlabel zlabel--outline zlabel--medium DN" id="zp_appproval_approveRej_Confirm">'+ZPI18N.getString("zp.confirm")+"</button>",footerHtml+='<button type="button" class="zlabel zlabel--outline zlabel--medium DN" id="zp_modal_whitebtn">'+ZPI18N.getString("zp.close")+"</button>",footerHtml+="</div></div></div>";var modal=ModuleComp.Modal.setup({id:"ZPAtt_Reg_Details",type:1,header:title,body:html,backdrop:!1,deleteOnHide:!0,modalClass:"zpl_mlg",footer:footerHtml,hiddenCallback:closeCallBack,closeonEsc:!0});$(ZPeople.LOADING_HTML).insertAfter(modal.find(".zpl_mhder"));modal.find("#headeropt").append($('<div id="headerApprovalBtn"></div>')),ZP5Form.LAYOUT=modal,ZP5Form.CURRFORM_PARAM={},formId||(formId=Att_Common_Operations.attReqViewFormId,recordId=Att_Common_Operations.attReqViewRecId),regularization_operation.approvalSett||OPApprovals.Common.Settings.fetchApprovalSettings(formId,!1,regularization_operation.setApprovalSett),ZP5Form.CURRFORM_PARAM.formId=formId,ZP5Form.CURRFORM_PARAM.recordId=recordId,ZP5Form.CURRFORM_PARAM.tableName="P_AttendanceReg";var param={mode:"getAttendanceDetails",recordId:recordId,formId:formId,conreqcsr:csrfToken};if(void 0!=Att_Common_Operations.myRequestPage&&Att_Common_Operations.myRequestPage.length>0){var filter=Att_Common_Operations.myRequestPage.find(".zpl_fltr");Att_Common_Operations.getEmpProfDateofExitFilter(filter,param,"reg")}$.post("/AttendanceAction.zp",param,function(result){ZP5Form.LAYOUT.find("#zp_page_loading").remove();var formDetailsmap={isadmin:isManageAttendanceData};if(ZP5Form.getFormsOperation(ZP5Form.CURRFORM_PARAM.formId).updateFormConf(formDetailsmap),Attendance.Entry.currentApprover=!1,Attendance.Entry.isRecordOwner=!1,result.approvalDetails&&(result.approvalDetails.isfromAttendence=!0,result.approvalDetails.isOwner&&(Attendance.Entry.currentApprover=!0),result.approvalDetails.recOwner&&(Attendance.Entry.isRecordOwner=!0,OPApprovals.Common.RecordOwner.setOwner(result.details.recordId,result.approvalDetails.recOwner),result.approvalDetails.recordowner.erecno&&OPApprovals.Common.RecordOwner.setOwner(result.details.recordId,result.approvalDetails.recordowner.erecno))),result.details){var empName=result.details.employeeName+" - "+$("<div/>").text(result.details.employeeId).html(),dateHtml=result.details.startDate;if(result.details.endDate&&(dateHtml+='<span class="ZPuscr">-</span>'+result.details.endDate),modal.find("#ZPAtt_Reg_userName span b").html(empName),modal.find("#attendRegDispDate span b").html(dateHtml),regularization_operation.removeAndAddClass(modal.find("#attendanceRegListHeader #regAllApprove"),"gry","grn",ZPI18N.getString("zp.clicktoreject")),modal.find("#regBulkApprovalRej").hide(),modal.find("#regApprovalState").show(),result.approvalDetails&&-1==result.approvalDetails.currentApprovalStatus&&Attendance.Entry.currentApprover&&(modal.find("#regApprovalState").hide(),modal.find("#regBulkApprovalRej").show()),regularization_operation.isRegReasonsEnabled()?modal.find("#attendanceRegListHeader #attendanceRegListHeader_Reason").show():modal.find("#attendanceRegListHeader #attendanceRegListHeader_Reason").hide(),result.details.attachMentId&&result.details.fileName){modal.find("#attachMentDiv").show();var attachMentHtml="<h4>"+result.details.fileName+"</h4>";if(result.details.fileSize){let readableSize="";attachMentHtml+="<p><span>"+(readableSize=result.details.fileSize>=1048576?(result.details.fileSize/1048576).toFixed(2)+" MB":(result.details.fileSize/1024).toFixed(2)+" KB")+"</span></p>"}var fileIconClass="";result.details.fileExtenstion&&(fileIconClass=Att_Common_Operations.getFileIcon(result.details.fileExtenstion),modal.find("#attachMentDiv #fileExtIcon").removeClass(),modal.find("#attachMentDiv #fileExtIcon").addClass(fileIconClass)),modal.find("#attachMentDiv").find("#attachMentName").html(attachMentHtml);var attachMentId=result.details.attachMentId,filePath=result.details.filePath;filePath?(fileIconClass||(fileIconClass=Att_Common_Operations.getFileIconBasedOnFilePath(filePath),modal.find("#attachMentDiv #fileExtIcon").removeClass(),modal.find("#attachMentDiv #fileExtIcon").addClass(fileIconClass)),modal.find("#attachMentDiv").find(".download-link").attr("href",filePath).attr("target","_blank")):modal.find("#attachMentDiv").find(".download-link").on("click",function(e){e.preventDefault(),Att_Common_Operations.downloadFile(attachMentId)})}else modal.find("#attachMentDiv").hide();$.each(result.details.regDetails,function(ind,regDetails){var oldIn=regDetails.intime?regDetails.intime:"-",oldOut=regDetails.outtime?regDetails.outtime:"-",newIn=regDetails.new_intime?regDetails.new_intime:"-",newOut=regDetails.new_outtime?regDetails.new_outtime:"-",reason=regDetails.reason?regDetails.reason:"-",desc=regDetails.desc?regDetails.desc:"-",regDetailsId=regDetails.regDetailsId?regDetails.regDetailsId:"",oldTotHrs="-"!==regDetails.totalHours?Attendance.disHours(regDetails.totalHours/60):regDetails.totalHours,regTableCons='<tr id="regRow"><td class="tblbody"><table class="zpl_tblcntr zpl_itbl"><tbody><tr><td class="mw150"><span>'+regDetails.originday+"</span></td>";if(regTableCons+='<td class="mw100"><span>'+oldIn+'</span></td><td class="mw100"><span>'+newIn+"</span></td>",regTableCons+='<td class="mw100"><span>'+oldOut+'</span></td><td class="mw100"><span>'+newOut+"</span></td>",regTableCons+='<td class="mw100"><span>'+oldTotHrs+'</span></td><td class="mw100"><span>'+Attendance.disHours(regDetails.new_totalHours/60)+"</span></td>",regTableCons+='<td class="mw100"><span>'+Attendance.Reg.statI18nInReg(regDetails.att_status)+'</span></td><td class="mw100"><span>'+Attendance.Reg.statI18nInReg(regDetails.new_status)+"</span></td>",regularization_operation.isRegReasonsEnabled()&&(regTableCons+='<td class="mw150"><span>'+reason+"</span></td>"),regTableCons+='<td class="mw150"><span>'+desc+"</span></td>",modal.find("#attendanceRegListHeader #approveChkBox").hide(),""!==regDetailsId)if(modal.find("#attendanceRegListHeader #approveChkBox").show(),result.approvalDetails)if(-1==result.approvalDetails.currentApprovalStatus&&Attendance.Entry.currentApprover){var cls="";1==result.details.regDetails.length&&(modal.find("#attendanceRegListHeader #approveChkBox").hide(),cls="DNI"),regTableCons+='<td class="mw150 '+cls+'">';var approveRejectClass="gry",approveRejectTitle=ZPI18N.getString("zp.clicktoapprove");1==regDetails.status||-1==regDetails.status?(approveRejectClass="grn",approveRejectTitle=ZPI18N.getString("zp.clicktoreject")):regularization_operation.removeAndAddClass(modal.find("#attendanceRegListHeader #regAllApprove"),"grn","gry",ZPI18N.getString("zp.clicktoapprove")),regTableCons+='<i id="indApprRejSelect" title="'+approveRejectTitle+'" regId="'+regDetailsId+'" class="PI_tick2_fil '+approveRejectClass+' S18" onClick="regularization_operation.allcheckAppRej(this);"></i></td>'}else void 0!=result.approvalDetails.canceledRecord&&1==result.approvalDetails.canceledRecord?regTableCons+='<td class="mw150"><span>'+ZPI18N.getString("zp.cancelled")+"</span></td>":1!=regDetails.status||Attendance.Entry.isRecordOwner&&1!=result.approvalDetails.currentApprovalStatus&&0!=result.approvalDetails.currentApprovalStatus?0!=regDetails.status||Attendance.Entry.isRecordOwner&&1!=result.approvalDetails.currentApprovalStatus&&0!=result.approvalDetails.currentApprovalStatus?regTableCons+='<td class="mw150"><span>'+ZPI18N.getString("zp.waitingmsg")+"</span></td>":regTableCons+='<td class="mw150"><span>'+ZPI18N.getString("zp.rejected")+"</span></td>":regTableCons+='<td class="mw150"><span>'+ZPI18N.getString("zp.approved")+"</span></td>";else 2==regDetails.status?regTableCons+='<td class="mw150">'+ZPI18N.getString("zp.cancelled")+"</td>":-2==regDetails.status?regTableCons+='<td class="mw150">'+ZPI18N.getString("zp.submitted")+"</td>":regTableCons+='<td class="mw150">'+ZPI18N.getString("zp.approved")+"</td>";regTableCons+="</tr></tbody></table></td></tr>",modal.find("#attendanceRegListBody").append(regTableCons)}),modal.find("#attendanceRegListHeader").show(),void 0!=result.details.isCancelPermitted&&1==result.details.isCancelPermitted&&(modal.find("#cancelRegIndividual").removeClass("DN"),modal.find("#ZPAtt_Reg_AppHierarchy").find("#zp_appproval_approve_btn, #zp_appproval_reject_btn, #zp_appproval_all_approve_btn").hide(),modal.find("#ZPAtt_Reg_AppHierarchy").find("#zp_appproval_comment_div").addClass("zpl_DNI")),void 0!=result.details.isClosePermitted&&1==result.details.isClosePermitted&&modal.find("#zp_modal_whitebtn").removeClass("DN"),regularization_operation.approvalAttendDets=result;var layoutParam,apprParam=void 0;result.approvalDetails&&(apprParam=new ApprovalParam(ZP5Form.CURRFORM_PARAM.formId,ZP5Form.CURRFORM_PARAM.recordId,ZP5Form.CURRFORM_PARAM.tableName,result.approvalDetails.currentApprovalStatus,isManageAttendanceData),regularization_operation.approvalSett&&apprParam.setApprovalSettings(regularization_operation.approvalSett),layoutParam=new LayoutParam(ZP5Form.LAYOUT,ZP5Form.LAYOUT.find(".zpl_mhder"),ZP5Form.LAYOUT.find(".zpl_mfoter"),"Attendance"),apprRecHeader=new ApprovalRecordHeader(apprParam,layoutParam,{isRecordApprover:result.isRecordApprover,isPrimaryApprover:result.approvalDetails.isPrimaryAppr,isResubmitApplicable:!1}),apprRecHeader.show(),-1==result.approvalDetails.currentApprovalStatus&&((result.approvalDetails.isPrimaryAppr||isadmin&&result.isRecordApprover)&&modal.find("#ZPAtt_Reg_AppHierarchy").find("#zp_appproval_approve_btn, #zp_appproval_reject_btn").show(),isadmin&&result.approvalDetails.pending&&result.approvalDetails.pending.length>0&&modal.find("#ZPAtt_Reg_AppHierarchy").find("#zp_appproval_all_approve_btn").show()),0!=result.approvalDetails.currentApprovalStatus&&-4!=result.approvalDetails.currentApprovalStatus||modal.find("#ZPAtt_Reg_AppHierarchy").find("#zp_appproval_comment_div").addClass("zpl_DNI")),modal.find("#cancelRegIndividual").on("click",function(){var extraDetails={};apprParam&&(extraDetails.apprParam=apprParam),layoutParam&&(extraDetails.layoutParam=layoutParam),extraDetails.modalId="Reg",extraDetails.cancelId=result.details.recordId,extraDetails.detailId="ZPAtt_RegMyReqDetails",extraDetails.cancelReasonMandatory=void 0!==ZPeople.Module.MODULE_DATA.attendance.isRegCancelReason&&!0===ZPeople.Module.MODULE_DATA.attendance.isRegCancelReason;var body='<div class="form-group"><p class="text-center MB15">'+ZPI18N.getString("zp.confirmregcancel")+'</p></div><div class="form-group" id="cancel_reason"><div class="col-sm-12"><textarea type="text"  placeholder="Reason For Cancellation" rows="4" class="ztextbox" id="zp_cancel_comment_text"></textarea><span class="red text-center MT5 DN" id="cancel_reason_error" style="width: 100%;"></span></div></div>';Att_Common_Operations.cancelRequest(body,ZPI18N.getString("zp.cancelregrequest"),Att_Common_Operations.cancelReq,extraDetails)}),result.details&&-2==result.details&&modal.find("#ZPAtt_Reg_AppHierarchy").find("#zp_appproval_comment_div").addClass("zpl_DNI")}else $("#"+Layout.Page.pageId+" #ZPAtt_Reg_Details div.modal-body ").empty().append('<div class="ZPNdata"><i id="norecfoundimg"></i><p class="no-para"><br>'+ZPI18N.getString("zp.norec")+"<br></p></div>"),Attendance.noDataImg(8,"CR-nodata",Layout.Page.container.find(".ZPNdata #norecfoundimg"))})}else{var params={initmodule:JSON.stringify({modulePrefix:"attendance"})};ZPeople.Request.send("/gettabdetails/initpage",params,function(result){result.initmodule&&(ZPeople.Module.MODULE_DATA.attendance=result.initmodule,Att_Common_Operations.isModuleDataLoaded=!0,regularization_operation.getAttendanceRegDetails(formId,recordId,closeCallBack))})}},approveRejCommentClbck:function(obj){if(obj){var formLayoutID=ZP5Form.LAYOUT.find("#ZPAtt_Reg_AppHierarchy");formLayoutID.find("#zp_appproval_comment_div").removeClass("zpl_DNI"),formLayoutID.find("zp_appproval_approveRej_Confirm").removeAttr("class"),regularization_operation.approvalType=obj.getAttribute("approvaltype");var id=obj.getAttribute("id"),btnclass="zp_appproval_all_approve_btn"==id?"zlabel zlabel--blue zlabel--outline zlabel--medium":"zlabel zlabel--green zlabel--medium";0==regularization_operation.approvalType&&(btnclass="zlabel zlabel--red  zlabel--medium "),formLayoutID.find("#zp_appproval_approve_btn, #zp_appproval_reject_btn, #zp_appproval_all_approve_btn").hide(),formLayoutID.find("#zp_appproval_approveRej_Confirm").attr("class",btnclass),regularization_operation.isAllLevelApprove="zp_appproval_all_approve_btn"==id,formLayoutID.find("#zp_appproval_approveRej_Confirm").off("click").on("click",regularization_operation.confirmApprovalRejClbk)}},confirmApprovalRejClbk:function(){let apprParam=new ApprovalParam(ZP5Form.CURRFORM_PARAM.formId,ZP5Form.CURRFORM_PARAM.recordId,ZP5Form.CURRFORM_PARAM.tableName,regularization_operation.approvalType,isManageAttendanceData);regularization_operation.approvalSett&&apprParam.setApprovalSettings(regularization_operation.approvalSett);var formLayout=ZP5Form.LAYOUT.find("#ZPAtt_Reg_AppHierarchy");formLayout.find("#cmtErrMsg").remove();var commentBoxObj=formLayout.find("#zp_appproval_comment_div").find("#zp_appproval_comment_text");commentBoxObj.removeClass("ztextbox__error");var comment=commentBoxObj.val();if((regularization_operation.approvalSett.isApprMandatory&&"1"===regularization_operation.approvalType||regularization_operation.approvalSett.isRejMandatory&&"0"===regularization_operation.approvalType)&&""===comment.trim())commentBoxObj.addClass("ztextbox__error"),$('<div id="cmtErrMsg" class="ztextbox--error__label MB10">'+ZPI18N.getString("zp.apprCmtMandatoryErr")+"</div>").insertAfter(commentBoxObj);else{let layoutParam=new LayoutParam(ZP5Form.LAYOUT,ZP5Form.LAYOUT.find(".zpl_mhder"),ZP5Form.LAYOUT.find(".zpl_mfoter"),"Attendance"),approveRejObj=new ApproveReject(apprParam,layoutParam,regularization_operation.approvalType,comment,regularization_operation.isAllLevelApprove);regularization_operation.appRejRegDetails(approveRejObj)}},removeAndAddClass:function(obj,classToBeRemoved,classToBeAdded,titleToBeChanged){void 0===classToBeRemoved&&""===classToBeRemoved||$(obj).removeClass(classToBeRemoved),void 0===classToBeAdded&&""===classToBeAdded||$(obj).addClass(classToBeAdded),void 0===titleToBeChanged&&""===titleToBeChanged||$(obj).attr("title",titleToBeChanged)},allcheckAppRej:function(obj,isAllChanged){var modal=settingsPage.container.find("#ZPAtt_Reg_Details"),grayColorTitle=ZPI18N.getString("zp.clicktoapprove"),greenColorTitle=ZPI18N.getString("zp.clicktoreject");isAllChanged?$(obj).hasClass("grn")?(regularization_operation.removeAndAddClass(obj,"grn","gry",grayColorTitle),regularization_operation.removeAndAddClass(modal.find("#attendanceRegListBody tr #indApprRejSelect"),"grn","gry",grayColorTitle)):(regularization_operation.removeAndAddClass(obj,"gry","grn",greenColorTitle),regularization_operation.removeAndAddClass(modal.find("#attendanceRegListBody tr #indApprRejSelect"),"gry","grn",greenColorTitle)):($(obj).hasClass("grn")?regularization_operation.removeAndAddClass(obj,"grn","gry",grayColorTitle):regularization_operation.removeAndAddClass(obj,"gry","grn",greenColorTitle),modal.find("#attendanceRegListBody tr #indApprRejSelect.grn").length===modal.find("#attendanceRegListBody tr #indApprRejSelect").length?regularization_operation.removeAndAddClass(modal.find("#attendanceRegListHeader #regAllApprove"),"gry","grn",greenColorTitle):regularization_operation.removeAndAddClass(modal.find("#attendanceRegListHeader #regAllApprove"),"grn","gry",grayColorTitle))},constructRequestReg:function(obj,date,month,year,isFromLeave){var html='<div class="zpl_crd"><div class="zpl_crdcnt">';regularization_operation.regDate=null,!isFromLeave&&regularization_operation.leavePageErecno&&(regularization_operation.leavePageErecno=null),date&&month&&year&&(regularization_operation.regDate=year+"-"+month+"-"+date),Att_Common_Operations.isSelfReqPage()||isFromLeave||(html+='<div class="zpl_secn w400"><div><label for="regEmps">'+ZPI18N.getString("zp.employeename")+"</label></div>",html+='<div id="test"><select id="regEmps" initCurrUser=true class="select-js" style="display: none;"></select></div><span id="employeeErr"class="ztextbox--error__label"></span></div>'),Attendance.Entry&&"tabler"==Attendance.Entry.selectedPageView&&(Attendance.Entry.selectedRowIndex=$(obj).parent().parent().parent().index()),html+='<div class="zpl_secn w450"><div><label for="regPeriod">'+ZPI18N.getString("zp.period")+"</label></div>",html+='<div><select id="regPeriod" onchange="regularization_operation.constructDates(true);"></select></div></div>',html+='<div class="zpl_secn zpl_idivingrp w450"><div><div><label for="regStartDate">'+ZPI18N.getString("zp.date")+'</label><label class="zpl_op0"></label></div></div>',html+='<div><div><input id="regStartDate"/>',html+='<input id="regEndDate"/></div><span class="ztextbox--error__label DN" id="lesserFromDate">'+ZPI18N.getString("zp.greaterfromdate")+"</span></div></div>",isEmpChooseApp&&(html+='<div class="zpl_secn zpl_secn w450" id="ZPAtt_reg_chooseAppr"><div><label>'+ZPI18N.getString("zp.selectapprover")+"</label></div>",html+='<div><select id="ZPAtt_reg_approverId" class="select-js" style="display: none;"></select><span id="emptyErrMsg" class="ztextbox--error__label"></span></div>',html+="</div>"),html+='<div class="zpl_secn w400"><div id="regAttachementLabel"><label>'+ZPI18N.getString("zp.attachment")+'</label></div><div class="zpl_upld tmpslct">',html+='<div class="zpl_atchd" style="display: none;" id="afterUpload"></div><div id="beforeUpload" class="zpl_fldrp"><h5><a class="zpl_lnk" name="regFileuploadelem"><i class="PI_desktop"></i>'+ZPI18N.getString("zp.files.desktop")+'<input type="file" elem="fileuploadInput" style="display:none" class=""  type="file" accept=".xls,.csv,.xlsx,.jpeg,.png,.jpg,.pdf,.doc,.docs,.txt"/><input type="hidden" id="filename"/></a>',isWorkdriveAllowed&&(html+='/<a class="zpl_lnk" name="fileuploadelem" onclick="Att_Common_Operations.showWorkDriveModal(this,\'REG\')"><i class="PI_workdrive zpl_icnobg"></i>'+ZPI18N.getString("zp.workdrive")+"</a>"),ZPeople.isChinaSetup||(html+='/<a class="zpl_lnk" onclick="Att_Common_Operations.showCloudPickerModal(\''+ZPeople.cloudPickerGadgetsUrl+"','REG')\"><i class=\"PI_cloud\"></i>"+ZPI18N.getString("zp.others")+"</a>"),html+="</h5></div><p><span>"+ZPI18N.getString("zp.filessuported")+": PDF, XLS, DOC, Image</span><span>"+ZPI18N.getString("zp.impmaxsize")+': 5MB</span></p><span id="attachMentError" class="ztextbox--error__label"></span></div></div>',html+='<div class="zpl_secn"><div><div class="zpl_tblres ova">',html+='<table class="zpl_tbl zpl_tblcntr wd100_per" id="attRegTable"> <thead><tr><th scope="col" class="zpl_w120">'+ZPI18N.getString("zp.workedday")+'</th><th scope="col" class="zpl_mtry zpl_w280">'+ZPI18N.getString("zp.checkin")+"</th>",html+='<th scope="col"  class="zpl_mtry zpl_w280">'+ZPI18N.getString("zp.checkout")+'</th><th scope="col" class="zpl_w120" >'+ZPI18N.getString("zp.totalhours")+'</th> <th scope="col" class="zpl_w280" id="header1"></th> <th scope="col"  id="header2" style="display:none"></th></tr></thead>',html+='<tbody id= "attRegTableBody"><tr id="attDetailsListRow" class="DNI"><td id="attRegDateDiv" scope="row" tabindex="0"> <span id="monthDateValue"></span>',html+='<em class id="dayValue"></em></td><td><input data-ctype="zdatetimefield" id="check-in"><span id="fromTimeErr"class="ztextbox--error__label"></span></td><td> <input data-ctype="zdatetimefield" id="check-out" borderTag="true" class="datepicker"><span id="toTimeErr"class="ztextbox--error__label"></span></td><td><span id="total_hrs"></span></td><td id="reg_req_reasonanddesc1"></td><td id="reg_req_reasonanddesc2"></td></tr></tbody></table></div></div></div></div></div>';var footerHtml='<div class="zpl_mfoter zpl_btnsplt" id="ZPAtt_Reg_AppHierarchy"><div><button type="button" class="zlabel zlabel--blue zlabel--medium" approvaltype="0"  id="zp_modal_blubtn" tabindex="0" aria-label="'+ZPI18N.getString("zp.submit")+'">'+ZPI18N.getString("zp.submit")+"</button>";footerHtml+='<button type="button" class="zlabel zlabel--outline zlabel--medium" id="zp_modal_whitebtn" tabindex="0" aria-label="'+ZPI18N.getString("zp.cancel")+"."+ZPI18N.getString("zp.common.cancelpopup")+'"> '+ZPI18N.getString("zp.cancel")+"</button></div>",footerHtml+='<div><div class="zpl_lftpgn"><div class="zpl_viewdays">',footerHtml+='<div class="zpl_dytyp lv_bdr5"><span>'+ZPI18N.getString("zp.tt.unpaidleave")+"</span></div>",footerHtml+='<div class="zpl_dytyp lv_bdr6"><span>'+ZPI18N.getString("zp.absent")+"</span></div>",footerHtml+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.tt.paidleave")+"</span></div>",footerHtml+='<div class="zpl_dytyp lv_bdr3"><span>'+ZPI18N.getString("zp.onduty")+"</span></div>",footerHtml+='<div class="zpl_dytyp lv_bdr8"><span>'+ZPI18N.getString("zp.weekend")+"</span></div>",footerHtml+='<div class="zpl_dytyp lv_bdr1"><span>'+holiday_disName+"</span></div>",footerHtml+="</div></div></div></div>";var modal=ModuleComp.Modal.setup({id:"addreglsn",type:1,header:ZPI18N.getString("zp.request")+" "+ZPI18N.getString("zp.regularization"),body:html,backdrop:!1,deleteOnHide:!0,modalClass:"zpl_mlg",successCallback:regularization_operation.addRegRequest,hiddenCallback:regularization_operation.destroyZComp,footer:footerHtml,customBodyAttr:{id:"reg_cards"},closeonEsc:!0});Att_Common_Operations.isSelfReqPage()||modal.find("#s2id_regEmps")[0]||isFromLeave||ModuleAdmin.consResetEmpSearch("regEmps",modal,!0),modal.find('[name="regFileuploadelem"]').on("click",function(event){"fileuploadInput"!=$(event.target).attr("elem")&&$(event.target).closest("[name='regFileuploadelem']").find("[elem=fileuploadInput]").trigger("click")}),modal.find('[elem="fileuploadInput"]').off("change").on("change",function(event){Att_Common_Operations.onFileUpload(event,"REG")}),modal.find("#reg_cards").css("position","relative");var dropdownListOption={height:"300px",appendTo:"#reg_cards"};Att_Common_Operations.isSelfReqPage()||isFromLeave||(ZPeopleComponents.select(modal.find("#regEmps")).setAttribute("showSearchField",!0),ZPeopleComponents.select(modal.find("#regEmps")).setAttribute("dropdownList",dropdownListOption));var options=[];options.push({label:ZPI18N.getString("zp.cday"),value:0}),options.push({label:ZPI18N.getString("zp.week"),value:1}),options.push({label:ZPI18N.getString("zp.month"),value:2}),options.push({label:ZPI18N.getString("zp.custom"),value:3}),ZPeopleComponents.select(modal.find("#regPeriod")).setAttributes({options:options,multiple:!1,dropdownList:{appendTo:"#reg_cards"}}),modal.find("#regPeriod").on("zselectchange",Att_Common_Operations.handleOnChangeEvent);var dateOptions={calendarIcon:!0,calendarIconUIType:"button",showPickerOnFocus:!0,format:dateFmt,picker:!0,datestep:0,spinButtons:"none",clearButton:"none",pickerOptions:{appendTo:"#reg_cards"},pickerclose:Att_Common_Operations.handleOnChangeEvent};ZPeopleComponents.datefield(modal.find("#regStartDate"),dateOptions),ZPeopleComponents.datefield(modal.find("#regEndDate"),dateOptions),ZPeopleComponents.select(modal.find("#regPeriod")).setValues("0"),Att_Common_Operations.isSelfReqPage()||isFromLeave||modal.find("#regEmps").on("zselectchange",Att_Common_Operations.handleOnChangeEvent),isEmpChooseApp&&(modal.find("#s2id_ZPAtt_reg_approverId")[0]||(ModuleAdmin.consResetEmpSearch("ZPAtt_reg_approverId",modal,!0),ZPeopleComponents.select(modal.find("#ZPAtt_reg_approverId")).setAttribute("showSearchField",!0)),Att_Common_Operations.isSelfReqPage()||isFromLeave||ZPeopleComponents.select(modal.find("#regEmps")).setAttribute("dropdownList",{appendTo:"#reg_cards"}),modal.find("#ZPAtt_reg_approverId").on("zselectchange",Att_Common_Operations.removeErrClass)),modal.attr({"aria-label":ZPI18N.getString("zp.common.addreqpage"),tabindex:"0"}),modal.focus()},addRegRequest:function(obj){var modal=landingPage.find("#addreglsn");modal.find(".zpl_mfoter #zp_modal_blubtn").prop("disabled",!0);var formData=new FormData;formData.append("conreqcsr",csrfToken);var isEmpChooseApp=ZPeople.Module.MODULE_DATA.attendance.isEmpChooseApp,paramErecno="";if(paramErecno=regularization_operation.leavePageErecno?regularization_operation.leavePageErecno:Att_Common_Operations.isSelfReqPage()?AttendanceTeam.getSelfReqPageErecno():ZPeopleComponents.select(modal.find("#regEmps")).getValue(),modal.find("#attachMentError").html(""),!paramErecno)return modal.find("#employeeErr").text(ZPI18N.getString("zp.selectEmployeeName")),modal.find("#regEmps").addClass("ztextbox__error"),modal.find("#reg_cards").scrollTop(0),void modal.find(".zpl_mfoter #zp_modal_blubtn").prop("disabled",!1);formData.append("erecno",paramErecno);let dataObj={},isBothInOutMissingErr=[],reasonUnSelectedErr=[],desccharacterlimit=[],isOldEntriesAvailable=!1,isRegReasonsEnabled=regularization_operation.isRegReasonsEnabled(),isAllEmpty=!0;if(isEmpChooseApp){var chosenErecno=Att_Common_Operations.getEmpChosenApprErecno(modal,"ZPAtt_reg_approverId");if(""===chosenErecno)return void modal.find(".zpl_mfoter #zp_modal_blubtn").prop("disabled",!1);formData.append("empChoosenApprErecno",chosenErecno)}let idx=-1;modal.find("#attRegTableBody tr:gt(0):visible").each(function(){idx++;var userInputJson={},reasonanddesc={},originDate=$(this).find("#attRegDateDiv").attr("date_orgformat");userInputJson.fromTime=ZPeopleComponents.datetimefield($(this).find("#check-in-"+idx)).getValue().dateString,void 0!==userInputJson.fromTime&&""!==userInputJson.fromTime&&(userInputJson.fromTime=userInputJson.fromTime.replace(",","")),userInputJson.toTime=ZPeopleComponents.datetimefield($(this).find("#check-out-"+idx)).getValue().dateString,void 0!==userInputJson.toTime&&""!==userInputJson.toTime&&(userInputJson.toTime=userInputJson.toTime.replace(",",""));let desc=$(this).find("#reg_req_desc").val().trim();if(isRegReasonsEnabled){var reasonSelect=ZPeopleComponents.select($(this).find("#reg_req_reason_"+idx)).getValue();reasonanddesc.reason=ZPeople.Module.MODULE_DATA.attendance.regReasons[reasonSelect]}""!==desc&&(reasonanddesc.desc=desc),(reasonanddesc.desc||reasonanddesc.reason)&&(userInputJson.reasonanddesc=reasonanddesc),userInputJson.oldAttDataForDay=regularization_operation.getDayRecordJson.regDetails[originDate],isOldEntriesAvailable||""===userInputJson.fromTime&&""===userInputJson.toTime||(isOldEntriesAvailable=!0);let resultJson=Attendance.Entry.getAttRegJson(userInputJson);if("1"===resultJson.errorType)isBothInOutMissingErr.push(originDate);else if("2"===resultJson.errorType)reasonUnSelectedErr.push(originDate),dataObj[originDate]=resultJson;else{if("3"===resultJson.errorType)return void(isAllEmpty=!1);"4"===resultJson.errorType?(desccharacterlimit.push(originDate),dataObj[originDate]=resultJson):Object.keys(resultJson).length>0&&(dataObj[originDate]=resultJson)}}),formData.append("fdate",ZPeopleComponents.datefield(modal.find("#regStartDate")).getValue().dateString),""===ZPeopleComponents.datefield(modal.find("#regEndDate")).getAttribute("className")&&formData.append("tdate",ZPeopleComponents.datefield(modal.find("#regEndDate")).getValue().dateString),modal.find("#attRegTableBody tr[errorDispRow=true]").css("height","44px"),modal.find("#attRegTableBody #fromTimeErr").html("");let errorMsg=ZPI18N.getString("zp.selectregreason"),isErrorShown=!1;for(let errDate in reasonUnSelectedErr){isErrorShown=!0;let dateId=reasonUnSelectedErr[errDate].replace(/\//g,"\\/");regularization_operation.errorMsgConst(modal,dateId,"reasonErr",errorMsg)}errorMsg=ZPI18N.getString("zp.descriptioncharlimit",new Array("500"));for(let errDate in desccharacterlimit){isErrorShown=!0;let dateId=desccharacterlimit[errDate].replace(/\//g,"\\/");modal.find("#attRegTableBody").find("#"+dateId).find("#reg_req_desc").addClass("ztextbox__error"),regularization_operation.errorMsgConst(modal,dateId,"descErr",errorMsg)}if(0==Object.keys(dataObj).length){errorMsg=ZPI18N.getString("zp.inoutempty");for(let errDate in isBothInOutMissingErr){isErrorShown=!0;let dateId=isBothInOutMissingErr[errDate].replace(/\//g,"\\/");regularization_operation.errorMsgConst(modal,dateId,"fromTimeErr",errorMsg)}isErrorShown||(isErrorShown=!0,errorMsg=isAllEmpty?ZPI18N.getString("zp.inoutempty"):ZPI18N.getString("zp.nochangesmade"),ModuleComp.Msg.showFailureMsg(errorMsg))}isErrorShown?modal.find(".zpl_mfoter #zp_modal_blubtn").prop("disabled",!1):($(obj).attr("disabled","true"),formData.append("dataObj",JSON.stringify(dataObj)),modal.find('[elem="fileuploadInput"]')&&Att_Common_Operations.appendUploadfile(formData,"regAttachment","REG"),$.ajax({url:"/AttendanceAction.zp?mode=bulkAttendReg",type:"POST",data:formData,processData:!1,contentType:!1,success:function(rdata){if($(obj).prop("disabled",!1),modal.find(".zpl_mfoter #zp_modal_blubtn").prop("disabled",!1),rdata.errorDates)for(var errDate in rdata.errorDates){var dateId=errDate.replace(/\//g,"\\/");regularization_operation.errorMsgConst(modal,dateId,"fromTimeErr",rdata.errorDates[errDate])}else if(rdata.errorToDates)for(var errDate in rdata.errorToDates){dateId=errDate.replace(/\//g,"\\/");regularization_operation.errorMsgConst(modal,dateId,"toTimeErr",rdata.errorDates[errDate])}else if(rdata.message)$("#"+Layout.Page.pageId+" #ZPAtt_reg_fromTime").parent().next().next().html(ZPI18N.getString("zp.greaterfromdate"));else if("totalHrsExceeded"!==rdata.error)if("not allowed for this day"!==rdata.error)if(rdata.error&&"8026"==rdata.code)modal.find("#attachMentError").html(rdata.error);else if(rdata.error)ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.unabletoprocess"));else if("hh:mm a"!==timeFormat?Attendance.timeFormatIs12hr=!1:Attendance.timeFormatIs12hr=!0,settingsPage.isFromEmbedAddReq)if(isFromMsTeams=void 0!=Attendance&&Attendance.isFromMsteams,isFromMsTeams){modal.find(".zpl_mfoter #zp_modal_blubtn").prop("disabled",!0);var closeData={message:ZPI18N.getString("zp.recordsubmitted")};microsoftTeams.getContext(context=>{microsoftTeams.tasks.submitTask(closeData)})}else ModuleComp.Modal.hide("addreglsn"),modal.parent().append('<div class="d-flexM zpl_Emptydata"><div><div role="status" class="zalertbanner zalertbanner--success"><span class="zalertbanner__text">'+ZPI18N.getString("zp.recordaddedsuccessfully")+"</span></div></div></div>");else ModuleComp.Modal.hide("addreglsn"),ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.regaddsuccessmsg")),Att_Common_Operations.isMySpaceMyShiftPage()?MySpaceShift.init():Att_Common_Operations.isAttListViewPage()?Attendance.Entry.getList(Attendance.Entry.selectedView,Attendance.Entry.preMonth):regularization_operation.getData(!1,!1);else ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.notallowedthisday"));else ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.totalhrsreached"))}}))},errorMsgConst:function(modal,dateId,element,errormsg){modal.find("#attRegTableBody #"+dateId).attr("errorDispRow",!0),modal.find("#attRegTableBody #"+dateId).css("height","70px"),modal.find("#attRegTableBody").find("#"+dateId).find("#"+element).html(""),modal.find("#attRegTableBody").find("#"+dateId).find("#"+element).html(errormsg)},destroyZComp:function(){var modal=landingPage.find("#addreglsn");Att_Common_Operations.isSelfReqPage()||null!=regularization_operation.leavePageErecno||ZPeopleComponents.select(modal.find("#regEmps")).destroy(),ZPeopleComponents.select(modal.find("#regPeriod")).destroy(),ZPeopleComponents.datefield(modal.find("#regStartDate")).destroy(),ZPeopleComponents.datefield(modal.find("#regEndDate")).destroy(),isEmpChooseApp&&ZPeopleComponents.select(modal.find("#ZPAtt_reg_approverId")).destroy(),regularization_operation.destroyTimeField(),regularization_operation.leavePageErecno=null},destroyTimeField:function(){for(var modal=landingPage.find("#addreglsn"),i=0;i<regularization_operation.addReqCount;i++){if(0==modal.find("#check-in-"+i).length)return;ZPeopleComponents.datetimefield(modal.find("#check-in-"+i)).destroy(),ZPeopleComponents.datetimefield(modal.find("#check-out-"+i)).destroy(),0!=modal.find("#reg_req_reason_"+i).length&&ZPeopleComponents.select(modal.find("#reg_req_reason_"+i)).destroy()}},constructDates:function(isDateRangeChanged,eventChangefromUI){var param={mode:"getAttFiloInfo",conreqcsr:csrfToken,isAddRegRequest:!0},modal=landingPage.find("#addreglsn");modal.find("#employeeErr").text(""),modal.find("#attRegTable").hide(),0===modal.find(".zpl_tblres").find("#zp_page_loading").length&&modal.find("#attRegTable").parent().append(ZPeople.LOADING_HTML),modal.find("#lesserFromDate").addClass("DN");var fromDate=ZPeopleComponents.datefield(modal.find("#regStartDate")).getValue().dateString,toDate=ZPeopleComponents.datefield(modal.find("#regEndDate")).getValue().dateString,dateFromAtt=!1;if(isDateRangeChanged&&regularization_operation.regDate&&(fromDate=moment(regularization_operation.regDate,"YYYY-MM-DD").format(dateFmt.toUpperCase()),param.fromDate=fromDate,dateFromAtt=!eventChangefromUI||dateFromAtt),!0===isDateRangeChanged||""!=fromDate&&""!=toDate){if(!0!==isDateRangeChanged||dateFromAtt)param.fromDate=fromDate,"DN"===ZPeopleComponents.datefield(modal.find("#regEndDate")).getAttribute("className")&&void 0!==fromDate&&ZPeopleComponents.datefield(modal.find("#regEndDate")).setValue(param.fromDate),""===ZPeopleComponents.datefield(modal.find("#regEndDate")).getAttribute("className")&&toDate!==fromDate&&(param.toDate=toDate);else{if(param.rangeType=ZPeopleComponents.select(modal.find("#regPeriod")).getValue(),0==param.rangeType)ZPeopleComponents.datefield(modal.find("#regStartDate")).setAttributes({disabled:!1}),settingsPage.isFromEmbedAddReq&&ZPeopleComponents.datefield(modal.find("#regStartDate")).setAttributes({width:""});else{if(3==param.rangeType)return ZPeopleComponents.datefield(modal.find("#regStartDate")).setAttributes({disabled:!1}),ZPeopleComponents.datefield(modal.find("#regEndDate")).setAttributes({disabled:!1}),settingsPage.isFromEmbedAddReq&&(ZPeopleComponents.datefield(modal.find("#regStartDate")).setAttributes({width:""}),ZPeopleComponents.datefield(modal.find("#regEndDate")).setAttributes({width:""})),ZPeopleComponents.datefield(modal.find("#regEndDate")).setAttribute("className",""),modal.find("#attRegTable").show(),void modal.find(".zpl_tblres").find("#zp_page_loading").remove();ZPeopleComponents.datefield(modal.find("#regStartDate")).setAttributes({disabled:!0}),ZPeopleComponents.datefield(modal.find("#regEndDate")).setAttributes({disabled:!0})}1==param.rangeType&&(param.weekStarts=weekstarts)}regularization_operation.leavePageErecno?param.erecno=regularization_operation.leavePageErecno:!Att_Common_Operations.isSelfReqPage()&&ZPeopleComponents.select(modal.find("#regEmps")).getValue()?param.erecno=ZPeopleComponents.select(modal.find("#regEmps")).getValue():AttendanceTeam.getSelfReqPageErecno()&&(param.erecno=AttendanceTeam.getSelfReqPageErecno()),$.post("/AttendanceAction.zp",param,function(rdata){if(rdata.dateError){var errorMsg="zp.datewithinonemonth";"lesserFromDate"==rdata.dateError&&(errorMsg="zp.greaterfromdate"),modal.find("#lesserFromDate").text(ZPI18N.getString(errorMsg)),modal.find("#lesserFromDate").removeClass("DN"),modal.find(".zpl_tblres").find("#zp_page_loading").remove()}else rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.unabletoprocess")):rdata.regDetails&&(regularization_operation.getDayRecordJson=rdata,regularization_operation.destroyTimeField(),regularization_operation.consRegPopup(isDateRangeChanged,rdata.isPopulateReqd));rdata.isAttachMentManadatory&&modal.find("#regAttachementLabel").addClass("zpl_mtry")})}},consRegPopup:function(isDateRangeChanged,isPopulateReqd){var modal=landingPage.find("#addreglsn");modal.find("#attRegTable").show(),modal.find(".zpl_tblres").find("#zp_page_loading").remove(),modal.find("#attRegTableBody > tr").slice(1).remove();var dayList=regularization_operation.getDayRecordJson.regDetails.dayList;for(var i in ZPeopleComponents.datefield(modal.find("#regStartDate")).setValue(regularization_operation.getDayRecordJson.regDetails.startDate),ZPeopleComponents.datefield(modal.find("#regEndDate")).setValue(regularization_operation.getDayRecordJson.regDetails.endDate),!0===isDateRangeChanged&&regularization_operation.getDayRecordJson.regDetails.endDate==regularization_operation.getDayRecordJson.regDetails.startDate?ZPeopleComponents.datefield(modal.find("#regEndDate")).setAttribute("className","DN"):!0===isDateRangeChanged&&(ZPeopleComponents.datefield(modal.find("#regEndDate")).setAttribute("className",""),modal.find("#regStartDate").attr("placeholder",ZPI18N.getString("zp.from")),settingsPage.isFromEmbedAddReq&&ZPeopleComponents.datefield(modal.find("#regEndDate")).setAttribute("width","")),regularization_operation.addReqCount=0,dayList){var attDataForDay=regularization_operation.getDayRecordJson.regDetails[dayList[i]],row=modal.find("#attDetailsListRow").clone();$(row).find("#check-in").attr("id","check-in-"+i),$(row).find("#check-out").attr("id","check-out-"+i);var colorClass="";if(attDataForDay.isPaidLeave?colorClass+=" lv_bdr9":attDataForDay.isUnPaidLeave?colorClass+=" lv_bdr5":attDataForDay.isOnDuty?colorClass+=" lv_bdr3":attDataForDay.isWeekend?colorClass+=" lv_bdr8":attDataForDay.isHoliday?colorClass+=" lv_bdr1":attDataForDay.isAbsent&&(colorClass+=" lv_bdr6"),$(row).find('[borderTag="true"]').addClass(colorClass),$(row).find("#monthDateValue").text(attDataForDay.dispMonthDate),$(row).find("#dayValue").text(attDataForDay.dispDay),$(row).find("#attRegDateDiv").attr("date_orgformat",dayList[i]),regularization_operation.isRegReasonsEnabled()){modal.find("#attRegTable").find("#header1").addClass("zpl_mtry").html(ZPI18N.getString("zp.reason")),modal.find("#attRegTable").find("#header2").html(ZPI18N.getString("zp.description")),modal.find("#attRegTable").find("#header2").show();var txt='<select id="reg_req_reason_'+i+'" class="w300"></select><span class="ztextbox--error__label" id="reasonErr"></span>';$(row).find("#reg_req_reasonanddesc1").html(txt),$(row).find("#reg_req_reasonanddesc2").html(regularization_operation.getDescriptionHTML())}else modal.find("#attRegTable").find("#header1").html(ZPI18N.getString("zp.description")),modal.find("#attRegTable").find("#header2").hide(),$(row).find("#reg_req_reasonanddesc1").html(regularization_operation.getDescriptionHTML());$(row).attr("id",dayList[i]),$(row).removeClass("DNI"),modal.find("#attRegTableBody").append(row);var addedCont=modal.find("#attRegTableBody").find("tr:last-child"),maxDt=Calendar.parseDate(dayList[i],uidateFormat);maxDt.setDate(maxDt.getDate()+1);var endDate=Calendar.formatDate(maxDt).toString(),options={picker:!0,width:"250px",calendarIcon:!0,calendarIconUIType:"button",showPickerOnFocus:!0,format:dateFmt+" "+timeFormat.replace("a","tt"),spinButtons:"none",clearButton:"none",className:colorClass,pickerclose:Att_Common_Operations.handleOnChangeEvent};settingsPage.isFromEmbedAddReq&&(options.width="");var pickerInOptions={pickerOptions:{minDate:dayList[i],maxDate:endDate,forElement:"#check-in-"+i,appendTo:"#reg_cards"}},pickerOutOptions={pickerOptions:{minDate:dayList[i],maxDate:endDate,forElement:"#check-out-"+i,appendTo:"#reg_cards"}};if(ZPeopleComponents.datetimefield(addedCont.find("#check-in-"+i)).setAttributes(options),ZPeopleComponents.datetimefield(addedCont.find("#check-in-"+i)).setAttributes(pickerInOptions),ZPeopleComponents.datetimefield(addedCont.find("#check-out-"+i)).setAttributes(options),ZPeopleComponents.datetimefield(addedCont.find("#check-out-"+i)).setAttributes(pickerOutOptions),attDataForDay.fromdate&&ZPeopleComponents.datetimefield(addedCont.find("#check-in-"+i)).setValue(attDataForDay.fDate+" "+attDataForDay.fromdate),attDataForDay.todate&&ZPeopleComponents.datetimefield(addedCont.find("#check-out-"+i)).setValue(attDataForDay.tDate+" "+attDataForDay.todate),attDataForDay.totalhrs>=0&&$(row).find("#total_hrs").html(Attendance.disHours(parseInt(attDataForDay.totalhrs/60),!0)),regularization_operation.isRegReasonsEnabled())(options=[]).push({label:$("<div/>").text(ZPI18N.getString("zp.select")).html(),value:-1}),$.each(ZPeople.Module.MODULE_DATA.attendance.regReasons,function(index,data){options.push({label:data,value:index})}),ZPeopleComponents.select(addedCont.find("#reg_req_reason_"+i)).setAttributes({options:options,multiple:!1,dropdownList:{appendTo:"#reg_cards"}}),ZPeopleComponents.select(addedCont.find("#reg_req_reason_"+i)).setValue(-1);void 0!=isPopulateReqd&&1==isPopulateReqd&&$(row).find("#reg_req_reason_"+i).on("zselectchange",function(e){regularization_operation.autoPopulateOtherValidEntries(e,dayList,modal)}),$(row).attr("id",dayList[i])}regularization_operation.addReqCount=dayList.length,modal.find("#attRegTableBody").fadeIn()},getDescriptionHTML:function(){let html='<input type="text"  class="ztextbox" id="reg_req_desc" placeholder="'+ZPI18N.getString("zp.description")+'" onchange="regularization_operation.checkSingleRowCharacterLimit($(this))">';return html+='<span class="ztextbox--error__label" id="descErr"></span>'},checkSingleRowCharacterLimit:function(element){let modal=landingPage.find("#addreglsn"),dateId=element.closest("tr").attr("id"),rowElement=modal.find("#attRegTableBody #"+dateId);element.val().trim().length<=500&&(element.removeClass("ztextbox__error"),rowElement.attr("errorDispRow",!1),rowElement.css("height","0px"),rowElement.find("#descErr").html(""))},autoPopulateOtherValidEntries:function(e,dayList,modal){var index=$(e.target).closest("tr").index()-1,val=e.val,len=dayList.length,attRegTableBody=modal.find("#attRegTableBody"),isPreviousInvalid=!0,reached=!1;if(!regularization_operation.isRegularisationEntryInValid($(attRegTableBody.find("tr")[index+1]),index))for(j=0;j<len;j++){var row=$(attRegTableBody.find("tr")[j+1]),isCurrentInvalid=regularization_operation.isRegularisationEntryInValid(row,j),isCurrenEntryFilled=regularization_operation.isRegularisationEntryFilled(row,j);index==j?!isCurrentInvalid&&isPreviousInvalid&&(reached=!0,ZPeopleComponents.select(row.find("#reg_req_reason_"+j)).setValue(val)):reached&&index<j&&!isCurrentInvalid&&!isCurrenEntryFilled&&ZPeopleComponents.select(row.find("#reg_req_reason_"+j)).setValue(val),isPreviousInvalid=isPreviousInvalid&&isCurrentInvalid}},isRegularisationEntryInValid:function(row,index){var currFromDate=ZPeopleComponents.datetimefield(row.find("#check-in-"+index)).getValue().dateString,currToDate=ZPeopleComponents.datetimefield(row.find("#check-out-"+index)).getValue().dateString;return""==currFromDate||void 0==currFromDate||""==currToDate||void 0==currToDate},isRegularisationEntryFilled:function(row,index){return"-1"!=ZPeopleComponents.select(row.find("#reg_req_reason_"+index)).getValue()},regFILOChanged:function(obj){var tableRow=$(obj).closest("tr"),idx=obj.attr("id").split("-").pop(),regFromTime=ZPeopleComponents.datetimefield(tableRow.find("#check-in-"+idx)).getValue().dateString,regToTime=ZPeopleComponents.datetimefield(tableRow.find("#check-out-"+idx)).getValue().dateString,attDate=tableRow.attr("id"),maxDt=Calendar.parseDate(attDate,uidateFormat);maxDt.setDate(maxDt.getDate()+1);var nextDate=Calendar.formatDate(maxDt);if(tableRow.find("#fromTimeErr").text(""),tableRow.find("#toTimeErr").text(""),tableRow.removeAttr("style"),tableRow.find("#total_hrs").html(""),void 0!==regFromTime){var regFormatTime=regFromTime.split(" ")[1]+" "+regFromTime.split(" ")[2],regFromHours=parseInt(regFormatTime.split(":")[0],10),regFromMin=parseInt(regFormatTime.split(":")[1],10),invalidFromTime=!1;if(invalidFromTime=Attendance.timeFormatIs12hr?regFromHours>12||invalidFromTime:regFromHours>23||invalidFromTime,invalidFromTime=regFromMin>60||invalidFromTime)return tableRow.attr("errorDispRow",!0),tableRow.css("height","70px"),void tableRow.find("#fromTimeErr").text(ZPI18N.getString("zp.attendance.regInvalidFromEntry"))}if(void 0!==regToTime){regFormatTime=regToTime.split(" ")[1]+" "+regToTime.split(" ")[2];var regToHours=parseInt(regFormatTime.split(":")[0],10),regToMin=parseInt(regFormatTime.split(":")[1],10),invalidToTime=!1;if(invalidToTime=Attendance.timeFormatIs12hr?regToHours>12||invalidToTime:regToHours>23||invalidToTime,invalidToTime=regToMin>60||invalidToTime)return tableRow.attr("errorDispRow",!0),tableRow.css("height","70px"),void tableRow.find("#toTimeErr").text(ZPI18N.getString("zp.attendance.regInvalidToEntry"))}if(void 0!==regFromTime&&void 0!==regToTime){var regFromDate=Calendar.parseDate(regFromTime.split(" ")[0],uidateFormat),regToDate=Calendar.parseDate(regToTime.split(" ")[0],uidateFormat),parse_attDate=Calendar.parseDate(attDate,uidateFormat),parse_nextDate=Calendar.parseDate(nextDate,uidateFormat),isFromNextDay=regFromDate.valueOf()==parse_nextDate.valueOf(),isToNextday=regToDate.valueOf()==parse_nextDate.valueOf();if(regFromDate<parse_attDate||regFromDate>parse_nextDate)return tableRow.attr("errorDispRow",!0),tableRow.css("height","70px"),void tableRow.find("#fromTimeErr").text(ZPI18N.getString("zp.attendance.regInvalidDate"));if(regToDate<parse_attDate||regToDate>parse_nextDate)return tableRow.attr("errorDispRow",!0),tableRow.css("height","70px"),void tableRow.find("#toTimeErr").text(ZPI18N.getString("zp.attendance.regInvalidDate"));if(regFromTime=regFromTime.split(" ")[1]+" "+regFromTime.split(" ")[2],regToTime=regToTime.split(" ")[1]+" "+regToTime.split(" ")[2],regFromTime=Attendance.Common.convertTimerInputToMinsOrSecs(regFromTime),regToTime=Attendance.Common.convertTimerInputToMinsOrSecs(regToTime),regToDate>regFromDate&&regToTime>regFromTime)return tableRow.attr("errorDispRow",!0),tableRow.css("height","70px"),void tableRow.find("#fromTimeErr").text(ZPI18N.getString("zp.timeexceeded24"));if(regFromDate.getTime()==regToDate.getTime()&&regToTime<regFromTime||regFromDate>regToDate)return tableRow.attr("errorDispRow",!0),tableRow.css("height","70px"),void tableRow.find("#fromTimeErr").text(ZPI18N.getString("zp.inshouldbebeforeout"));isFromNextDay&&(regFromTime+=1440),isToNextday&&(regToTime+=1440);var regDets=regularization_operation.getDayRecordJson.regDetails[attDate];if(ZPeople.Module.MODULE_DATA.attendance.isMultiRegRecAllowed)regularization_operation.getTotHrsExcludingAutoBreaks(regFromTime,regToTime,attDate,tableRow,"getTotalHoursForMultiReg");else if(regDets.isAutoBreakConf)regularization_operation.getTotHrsExcludingAutoBreaks(regFromTime,regToTime,attDate,tableRow,"excludeAutoBreaksForReg");else{var shiftAllowedTimings=regDets.shiftAllowedTimings,totalHours=Att_Common_Operations.getTotalHoursBasedOnShift(shiftAllowedTimings,regFromTime,regToTime),payHours=totalHours;regDets.isNewBreakConf||(payHours-=regDets.breakTime)<0&&(payHours=0),tableRow.find("#total_hrs").html(Attendance.disHours(parseInt(totalHours),!0))}}},getTotHrsExcludingAutoBreaks:function(regFromTime,regToTime,attendDate,tableRow,mode){var param={mode:mode},modal=landingPage.find("#addreglsn");param[csrfParamName]=csrfToken;var input={};if(input.regFromTime=regFromTime,input.regToTime=regToTime,input.attendDate=attendDate,tableRow.attr("errorDispRow",!1),tableRow.css("height","0px"),tableRow.find("#fromTimeErr").html(""),regFromTime&&regToTime&&regToTime<regFromTime)return tableRow.attr("errorDispRow",!0),tableRow.css("height","70px"),void tableRow.find("#fromTimeErr").html(ZPI18N.getString("zp.inshouldbebeforeout"));if(regularization_operation.leavePageErecno)input.erecno=regularization_operation.leavePageErecno;else if(Att_Common_Operations.isSelfReqPage())input.erecno=erecno,null!=Attendance.Entry.erecno&&(input.erecno=Attendance.Entry.erecno);else{var erecVal=ZPeopleComponents.select(modal.find("#regEmps")).getValue();isManageAttendanceData&&erecVal&&""!=erecVal&&"0"!==erecVal?input.erecno=erecVal:input.erecno=erecno}param.input=JSON.stringify(input),$.post("/AttendanceAction.zp",param,function(rdata){void 0!=rdata.totalHours&&tableRow.find("#total_hrs").html(Attendance.disHours(parseInt(rdata.totalHours/60),!0))})},getData:function(isScroll,fromSubmit,navigate,page){page=Att_Common_Operations.myRequestPage;isScroll||(page.find(".actn_ovrly .PI_cls").trigger("click"),page.find(".zpl_rgtcnt").find("#ZPAtt_RegMyReq").hide()),!isScroll&&Att_Common_Operations.isFilterOpen()&&Att_Common_Operations.changeFilterClass();var param={mode:"getMyRequest",conreqcsr:csrfToken};navigate&&(param.navigate=navigate);var filter=page.find(".zpl_fltr");if(Att_Common_Operations.getSortParams(param),Att_Common_Operations.getMyRequestDateFilter(param,filter),page.find("#regCalNav").off().on("click",function(event){Att_Common_Operations.setUpMonthlyNavCalendar(event,this)}),!param.error){if(Att_Common_Operations.getFilterValues(filter,param),regularization_operation.isRegReasonsEnabled()){var reasonVal=Number(ZPeopleComponents.select(filter.find("#"+Att_Common_Operations.getFilterDivId()+"FilterReason")).getValue());regularization_operation.isRegReasonsEnabled()&&-3!==reasonVal&&(param.regReason=ZPeople.Module.MODULE_DATA.attendance.regReasons[reasonVal])}isScroll?param.startIndex=regularization_operation[Att_Common_Operations.myRequestPageId+"SIndex"]+1:(regularization_operation[Att_Common_Operations.myRequestPageId+"SIndex"]=0,page.find(".zpl_tbl").scrollTop(0),fromSubmit&&page.find(".zpl_rgtcnt").find("#emptyDivCnt").is(":visible")&&page.find(".zpl_rgtcnt").find("#emptyDivCnt").hide(),page.find("#ZPAtt_RegMyReqDetails").hide(),0===landingPage.find(".zpl_rgtcnt").find("#zp_page_loading").length&&landingPage.find(".zpl_rgtcnt").append(ZPeople.LOADING_HTML)),$.post("/AttendanceAction.zp",param,function(resultData){if(page.find(".zpl_rgtcnt").find("#emptyDivCnt").hide(),landingPage.find(".zpl_rgtcnt").find("#zp_page_loading").remove(),resultData.error)"exceeded dates"===resultData.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.datewithinthreemonth")):"error in end date"===resultData.error&&ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.greaterfromdate"));else{var dateNav=page.find(".zpl_btnmnu").find("#ZPAtt_regReq_dateNav");Att_Common_Operations.setDatePeriodVal(filter,resultData),resultData.dispMonth?dateNav.html("<b>"+resultData.dispMonth+"</b>"):dateNav.html("<b>"+Attendance.datesInHeader(resultData.fDate,resultData.tDate)+"</b>"),resultData.list.length===Att_Common_Operations.recordsPerReq?regularization_operation.fireScrollObj.reset():regularization_operation.fireScrollObj.fireScrollCalled=!0,regularization_operation.isEditAllowedForSub=resultData.isEditAllowedForSub,regularization_operation.constructList(resultData,isScroll)}})}},constructList:function(resultData,isScroll){var result=resultData.list,hideDel=resultData.hideDel,page=landingPage,tslisttbody=landingPage.find("#ZPAtt_RegMyReqBody");isScroll||tslisttbody.empty(),regularization_operation.isFromImport?regularization_operation.isFromImport=!1:TimelySettings.constructTopFilter(),regularization_operation.isRegReasonsEnabled()?landingPage.find("#ZPAtt_RegMyReqHeader #ZPAtt_RegMyReqHeader_Reason").show():landingPage.find("#ZPAtt_RegMyReqHeader #ZPAtt_RegMyReqHeader_Reason").hide(),isManageAttendanceData||landingPage.find("#ZPAtt_RegMyReqHeader #ZPAtt_RegMyReqHeader_checkBox").remove(),$.each(result,function(ind,regDetails){var tbody='<tr id="list-'+regDetails.recordId+'" recordId="'+regDetails.recordId+'">',isCheckBoxAdded=!1;!isManageAttendanceData||regDetails.isSubOrdinate||regDetails.erecno===erecno&&hideDel?isManageAttendanceData&&(regDetails.erecno===erecno&&hideDel||regDetails.isSubOrdinate)&&(tbody+='<td> <div class="zcheckbox disabled"><input type="checkbox" name="check" id="'+regDetails.recordId+'" class="zcheckbox__helper" approvalStatus='+regDetails.status+' val="'+regDetails.recordId+'" onclick="Att_Common_Operations.changeCheckBox(this,\'single\')" disabled="true"><label for= "'+regDetails.recordId+'" class="zcheckbox__label"></label></div></td>',isCheckBoxAdded=!0):(tbody+='<td> <div class="zcheckbox"><input type="checkbox" name="check" value=""  id="'+regDetails.recordId+'" class="zcheckbox__helper" approvalStatus='+regDetails.status+' val="'+regDetails.recordId+'" onclick="Att_Common_Operations.changeCheckBox(this,\'single\')"><label for= "'+regDetails.recordId+'" class="zcheckbox__label"></label></div></td>',isCheckBoxAdded=!0),tbody+='<td><div class="zpl_em"><div class="zpl_emimg"><img src='+regDetails.empPhoto+'></div><div class="zpl_emdts"><div class="tooltip-js" data-title-position="bottom" title="'+regDetails.employeeName+'"><em>'+$("<div/>").text(regDetails.employeeId).html()+" - </em><b>"+regDetails.employeeName+"</b></div></div></div></td>";var regDetsHasRejectedData=!1;tbody+='<td class="tblbody"><table class="zpl_tblcntr zpl_itbl wd100_per">',$.each(regDetails.regDetails,function(index,data){var reason=data.reason?data.reason:"-",oldTotHrs="-"!==data.totalHours?Attendance.disHours(data.totalHours/60):data.totalHours;tbody+="<tbody><tr>",tbody+='<td class="w200"><span>'+data.originday+"</span></td>",tbody+='<td class="w150"><span>'+oldTotHrs+"</span></td>",tbody+='<td class="w150"><span>'+Attendance.disHours(data.new_totalHours/60)+"</span></td>",tbody+='<td class="w150"><span>'+Attendance.Reg.statI18nInReg(data.att_status)+"</span></td>",tbody+='<td class="w150"><span>'+Attendance.Reg.statI18nInReg(data.new_status)+"</span></td>",regularization_operation.isRegReasonsEnabled()&&(tbody+='<td style="width: 200px;" class="w200"><span>'+reason+"</span></td>"),tbody+="</tr>",0==data.status&&(regDetsHasRejectedData=!0)}),tbody+="</tbody></table></td>";var appStatus="";if(1===regDetails.status){var dispStr=regDetsHasRejectedData?ZPI18N.getString("zp.partiallyapproved"):ZPI18N.getString("zp.approved");appStatus='<span class="'+(regDetsHasRejectedData?"org":"grn")+'" id = "zp_RegApproval_approvereject">'+dispStr+"</span>"}else 0===regDetails.status?appStatus='<span class="red" id = "zp_RegApproval_approvereject" >'+ZPI18N.getString("zp.rejected")+"</span>":-1===regDetails.status||regDetails.status===zpconst.ApprovalStatus.CancellationPending?appStatus=3===regDetails.regDetails.currentApprovalStatus?'<span class="org"  id ="zp_RegApproval_approvereject">'+ZPI18N.getString("zp.waitingnextlevel")+"</span>":'<span class="org"  id ="zp_RegApproval_approvereject">'+ZPI18N.getString("zp.waitingmsg")+"</span>":-2===regDetails.status?appStatus='<span class="org" id = "zp_RegApproval_approvereject">'+ZPI18N.getString("zp.submitted")+"</span>":2===regDetails.status&&(appStatus='<span class="red" id = "zp_RegApproval_approvereject">'+ZPI18N.getString("zp.cancelled")+"</span>");tbody+='<td id="appStatusTd">'+appStatus+"</td></tr>",tbody=$(tbody),tslisttbody.append(tbody),isCheckBoxAdded?tbody.on("click","td:not(:first-child)",function(){window.location.href="#"+landingPageURL+"/viewmyrequest-formId:"+regDetails.formId+"/recordId:"+regDetails.recordId}):tbody.on("click","td",function(){window.location.href="#"+landingPageURL+"/viewmyrequest-formId:"+regDetails.formId+"/recordId:"+regDetails.recordId})}),0===tslisttbody.children().length?0===page.find(".zpl_rgtcnt").find("#emptPage").length?(page.find(".zpl_rgtcnt").append('<div id="emptyDivCnt"></div>'),Att_Common_Operations.emptyPages(ZPI18N.getString("zp.nodatamsg",new Array(ZPI18N.getString("zp.sregularization"))))):page.find(".zpl_rgtcnt").find("#emptyDivCnt").show():(page.find("#ZPAtt_RegMyReqDetails").show(),page.find(".zpl_rgtcnt").find("#ZPAtt_RegMyReq").show(),page.find(".zpl_rgtcnt").find("#emptyDivCnt").hide())},appRejRegDetails:function(approveRejectObj){var regIdSelList=[],modal=settingsPage.container.find("#ZPAtt_Reg_Details"),isUpdationNeeded=!1,appAttDet=regularization_operation.approvalAttendDets;if(appAttDet&&appAttDet.details&&appAttDet.details.regDetails&&appAttDet.details.regDetails.length>0){appAttDet.details.regDetails[0].regDetailsId&&(isUpdationNeeded=!0);var regid=approveRejectObj.approvalParams.getRecordId(),status=approveRejectObj.status;if(1==(OPApprovals.APPROVAL_DETAILS[regid]?OPApprovals.APPROVAL_DETAILS[regid].approvalAction:0)?(regIdSelList.push(regid),isUpdationNeeded=!1):modal.find("#attendanceRegListBody tr #indApprRejSelect").each(function(){$(this).hasClass("grn")&&1==status&&regIdSelList.push($(this).attr("regid"))}),1==status&&0===regIdSelList.length&&isUpdationNeeded)return modal.find("[name='approvalBtn']").attr("disabled",!1),modal.find("#zp_approvereject_box").show(),modal.find("#zp_approval_confirm_btn").removeClass("disabled"),void ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.selectatleastoneregtoapprove"));var param={mode:"addAppStatusInRegDets",conreqcsr:csrfToken};param.recId=regid,param.isUpdationNeeded=isUpdationNeeded,regIdSelList.length>0&&(param.regIdSelList=JSON.stringify(regIdSelList)),param.approvalStatus=status,param.isAllLevelApprove=approveRejectObj.isApproveAllLevel,param.comment=approveRejectObj.comment,param.formId=approveRejectObj.approvalParams.getFormId(),$.post("/AttendanceAction.zp",param,function(rdata){if(!rdata.success&&1==rdata.errorCode)return modal.find("#zp_approvereject_box").find("#zp_approval_confirm_btn").removeClass("disabled"),modal.find("#ZPAtt_Reg_AppHierarchy").find("#zp_appproval_approve_btn, #zp_appproval_reject_btn").show(),void ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.record.approval.immutableinfo"));approveRejectObj.approveRejectDtlCallBack(rdata,param),void 0!=rdata&&void 0!=rdata.approvalJson&&void 0!=rdata.approvalJson.processed&&rdata.approvalJson.processed.length>0&&1==rdata.approvalJson.processed[0].approvalStatus&&(modal.find("#cancelRegIndividual").removeClass("DN"),modal.find("#ZPAtt_Reg_AppHierarchy").find("#zp_appproval_approve_btn, #zp_appproval_reject_btn, #zp_appproval_all_approve_btn, #zp_appproval_approveRej_Confirm").hide()),modal.find("#zp_modal_whitebtn").addClass("DN"),modal.find("#ZPAtt_Reg_AppHierarchy").find("#zp_appproval_comment_div").addClass("zpl_DNI"),modal.find("#ZPAtt_Reg_AppHierarchy").find("#zp_appproval_approveRej_Confirm").hide(),Att_Common_Operations.postRecStatChange(rdata.approvalJson,"Reg",ZPI18N.getString("zp.nodatamsg",new Array(ZPI18N.getString("zp.sregularization"))),param.recId,modal.find("#regAllApprove").hasClass("gry"))})}},Import:{construct:function(){$.post("/AttendanceAction.zp",{mode:"getPendingImportInfo",type:"RegMyRequest",conreqcsr:csrfToken},function(rdata){"empty"!==rdata.tableInfo.tableHeaders&&Attendance.ImportNew.partialImportedDataShow(rdata.tableInfo)}),Attendance.ImportNew.details={},Attendance.ImportNew.details.fileSlider=regularization_operation.Import.getImportSlider,Attendance.ImportNew.details.getMappingSliderHtml=regularization_operation.Import.getMappingSliderHtml,Attendance.ImportNew.details.getVerifySliderHtml=regularization_operation.Import.getVerifySliderHtml,Attendance.ImportNew.details.getImportSummaryHtml=regularization_operation.Import.getImportSummaryHtml,Attendance.ImportNew.details.autoMappingFields=regularization_operation.Import.autoMappingFields,Attendance.ImportNew.details.hideUnHideDateFmt=regularization_operation.Import.hideUnHideDateFmt,Attendance.ImportNew.details.submitMapping=regularization_operation.Import.submitRegMapping,Attendance.ImportNew.details.module="RegMyRequest",Attendance.ImportNew.construct()},getImportSlider:function(){var content='<div class="zpl_crd" id="importCont"><div id="importFileDiv1" class="zpl_crdcnt">'+Attendance.ImportNew.getPendingImportHtmlSecn()+'<div class="zpl_secn"><div><div class="zpl_upld"><div class="zpl_fldrp"><div class="zpl_mdimprtimg"></div><h4>'+ZPI18N.getString("zp.fileimported")+"</h4><p>"+ZPI18N.getString("zp.formfomtsupportxlscsv")+'</p><div><input style="display:none" type="file" accept=".xls,.xlsx,.csv" elem="AttConfigImportFile"><button elem="AttConfigImportButton" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.importfile")+"</button></div><p>"+ZPI18N.getString("zp.maxfilesize")+'</p><p elem="filehelp"><a elem="downloadSampleTemplate" onclick="regularization_operation.Import.downloadSample();"><b>'+ZPI18N.getString("zp.shiftmapping.sampleFileImport")+"</b></a></p></div></div></div></div>";return content+='<div class="zpl_secn"><div><h5>'+ZPI18N.getString("zp.supportedformats")+"</h5></div>",content+='<div class="zpl_tblres"><table class="zpl_tbl wd100_per">',content+="<thead><tr><th></th><th>A</th><th>B</th><th>C</th><th>D</th><th>E(Optional)</th><th>F</th>",content+="</tr></thead>",content+="<tbody><tr><td><span>1</span></td>",content+="<td><span>"+ZPI18N.getString("zp.emailemployeeid")+"</span></td>",content+="<td><span>"+ZPI18N.getString("zp.date")+"</span></td>",content+="<td><span>"+ZPI18N.getString("zp.checkin")+"</span></td>",content+="<td><span>"+ZPI18N.getString("zp.checkout")+"</span></td>",content+="<td><span>"+ZPI18N.getString("zp.description")+"</span></td>",content+="<td><span>"+ZPI18N.getString("zp.reason")+"</span></td>",content+="</tr>",content+="<tr><td><span>2</span></td>",content+="<td><span>tony@zillum.com</span></td>",content+="<td><span>02/04/2015</span></td>",content+="<td><span>09:15 AM</span></td>",content+="<td><span>06:00 PM</span></td>",content+="<td><span>desc</span></td>",content+="<td><span>Reason as per settings, if configured</span></td></tr>",content+="<tr><td><span>3</span></td>",content+="<td><span>ZCON001</span></td>",content+="<td><span>03/04/2015</span></td>",content+="<td><span>09:15 AM</span></td>",content+="<td><span>05:55 PM</span></td>",content+="<td><span>desc</span></td>",content+="<td><span>Reason as per settings, if configured</span></td></tr>",content+="</tbody></table></div></div></div>",content+='<div id="importFileDiv2" class="zpl_crdcnt DN"><div class="zpl_secn"><div><div class="zpl_upld"><div class="zpl_fldrp"><div class="zpl_mdimprtimg"></div><i class="IC-docs blu" style="font-size: 28px;"></i><h4 elem="importFormConfigfileName"></h4><input style="display:none" type="file" accept=".xls,.xlsx,.csv" elem="AttConfigImportFile"><button elem="AttfileUploadedButton" class="zlabel zlabel--blue zlabel--medium"></button></div></div></div></div></div></div><div class="DN" id="loadingImportDiv"></div>',content+="</div>"},hideUnHideDateFmt:function(cont){cont.find("#date_fmtReg").find("label").removeClass("zpl_mtry"),"csv"===Attendance.ImportNew.fileFormat&&cont.find("#date_fmtReg").find("label").addClass("zpl_mtry")},getMappingSliderHtml:function(){var html='<div class="zpl_btnmnu"><div><ul class="zpl_grpmnu"><li elem="mapUnMapDiv"  class="zpl_act" value="All">All</li><li  elem="mapUnMapDiv" value="Mapped">'+ZPI18N.getString("zp.mapping")+' <div id="mappedNo"><b></b></div></li><li  elem="mapUnMapDiv" value="Unmapped">'+ZPI18N.getString("zp.unmapped")+' <div id="unMappedNo"><b></b></div></li></ul></div><div class="zpl_rgt"><button data-popup-open="import_Resetfields" class="zlabel zlabel--red zlabel--medium zlabel--outline" onclick="Att_Common_Operations.confirmpopUp(\'AttImportReset\', Attendance.ImportNew.resetFields,undefined,1);">Reset fields</button></div></div><div class="zpl_rgtcnt zpl_crdwthful"><div class="zpl_crd"><div class="zpl_crdcnt zpl_colpanls" data-toggle-button-position="right" aria-multiselectable="true"><div id="Attimport_mapping_collapseDiv"><div><div <h4="">Basic information</div> </div><div><div class="zpl_secn zpl_twoclum" elem="rowContainer"><div><div  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.emailemployeeid")+'</label><select class="select-js" id="ZPAtt_reg_importIds_map" style="display: none;"></select></div></div><div><div  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.date")+'</label><div class="d-flexcap a-itm-cntr"><select id="ZPAtt_reg_importDate_map" class="select-js" style="display: none;"></select></div></div></div></div><div class="zpl_secn zpl_twoclum" elem="rowContainer"><div><div  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.checkin")+'</label><select id="ZPAtt_reg_importCheckIn_map" class="select-js" style="display: none;"></select></div></div><div><div  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.checkout")+'</label><div class="d-flexcap a-itm-cntr"><select id="ZPAtt_reg_importCheckOut_map" class="select-js" style="display: none;"></select></div></div></div></div><div class="zpl_secn zpl_twoclum" elem="rowContainer"><div><div  elem="mappingFieldDiv"><label>'+ZPI18N.getString("zp.description")+'</label><select id="ZPAtt_reg_importDescription_map" class="select-js" style="display: none;"></select></div></div><div><div id="date_fmtReg"  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.dateformat")+'</label><div class="d-flexcap a-itm-cntr"><select id="ZPAtt_reg_importDateFor_map" class="select-js" style="display: none;"></select></div></div></div></div>';return regularization_operation.isRegReasonsEnabled()&&(html+='<div class="zpl_secn zpl_twoclum" elem="rowContainer">',html+='<div><div  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.reason")+'</label><select id="ZPAtt_reg_importReason_map" class="select-js" style="display: none;"></select></div>',html+="</div></div>"),html},getVerifySliderHtml:function(){var html='<div class="zpl_rgtcnt zpl_crdwthful"><div class="zpl_crd"><div class="zpl_crdcnt zpl_colpanls" data-toggle-button-position="right" aria-multiselectable="true"><div id="Attimport_verify_collapseDiv"><div><div><h4="">Basic information</div></div><div><div class="zpl_secn zpl_twoclum" elem="rowContainer"><div><div  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.emailemployeeid")+'</label><select class="select-js" id="ZPAtt_reg_importIds" style="display: none;"></select></div></div><div><div  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.date")+'</label><div class="d-flexcap a-itm-cntr"><select id="ZPAtt_reg_importDate" class="select-js" style="display: none;"></select></div></div></div></div><div class="zpl_secn zpl_twoclum" elem="rowContainer"><div><div  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.checkin")+'</label><select id="ZPAtt_reg_importCheckIn" class="select-js" style="display: none;"></select></div></div><div><div  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.checkout")+'</label><div class="d-flexcap a-itm-cntr"><select id="ZPAtt_reg_importCheckOut" class="select-js" style="display: none;"></select></div></div></div></div><div class="zpl_secn zpl_twoclum" elem="rowContainer"><div><div  elem="mappingFieldDiv"><label>'+ZPI18N.getString("zp.description")+'</label><select id="ZPAtt_reg_importDescription" class="select-js" style="display: none;"></select></div></div><div><div id="date_fmtReg"  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.dateformat")+'</label><div class="d-flexcap a-itm-cntr"><select id="ZPAtt_reg_importDateFor" class="select-js" style="display: none;"></select></div></div></div></div>';return regularization_operation.isRegReasonsEnabled()&&(html+='<div><div class="zpl_secn zpl_twoclum" elem="rowContainer">',html+='<div  elem="mappingFieldDiv"><label class="zpl_mtry">'+ZPI18N.getString("zp.reason")+'</label><select id="ZPAtt_reg_importReason" class="select-js" style="display: none;"></select></div>',html+="</div></div>"),html},getImportSummaryHtml:function(resultData){var html='<div class="zpl_imprtrecordvw"><div class="zpl_secn"><div><div class="zpl_imprtrecord"><div><i class="IC-task-chk grn"></i>The selected file has been imported successfully</div><button type="button" class="zlabel zlabel--blue zlabel--medium" onclick="Att_Common_Operations.viewRecords()">View records</button></div></div></div></div><div class="zpl_btnmnu"><div><ul class="zpl_grpmnu"><li>'+ZPI18N.getString("zp.noOfTot")+"<b>"+resultData.msg.totalCount+"</b></li><li>"+ZPI18N.getString("zp.noOfAdd")+"<b>"+resultData.msg.successCount+"</b></li><li>"+ZPI18N.getString("zp.noOfSkip")+"<b>"+(resultData.msg.errorCount?resultData.msg.errorCount:0)+"</b></li><li>"+ZPI18N.getString("zp.noOfErr")+"<b>"+(resultData.msg.errorCount?resultData.msg.errorCount:0)+"</b></li></ul></div></div>";if(regularization_operation.isFromImport=!0,regularization_operation.getData(!1),resultData.msg.emptyEmpIds&&resultData.msg.emptyEmpIds.length>0||resultData.msg.skippedEmpInfo&&resultData.msg.skippedEmpInfo.length>0){if(html+=' <div class="zpl_rgtcnt"><div class="zpl_tblres wd100_per"><table class="zpl_tbl"><thead><tr><th>'+ZPI18N.getString("zp.errorDetails")+"</th><th></th></tr></thead><tbody>",resultData.msg.skippedEmpInfo.length>0){var skipped="",length=resultData.msg.skippedEmpInfo.length;for(i=0;i<length;i++)skipped=""==skipped?resultData.msg.skippedEmpInfo[i]:skipped+","+resultData.msg.skippedEmpInfo[i];html+="<tr><td><span>"+ZPI18N.getString("zp.invalidempinfo")+"</td><td>"+skipped+"</span></td></tr>"}if(resultData.msg.emptyEmpIds.length>0){skipped="",length=resultData.msg.emptyEmpIds.length;for(i=0;i<length;i++)skipped=""==skipped?resultData.msg.emptyEmpIds[i]:skipped+","+resultData.msg.emptyEmpIds[i];html+="<tr><td><span>"+ZPI18N.getString("zp.emptyempids")+"</td><td>"+skipped+"</span></td></tr>"}html+="</tbody></table></div></div>"}if(resultData.msg.errorInfo&&Object.keys(resultData.msg.errorInfo).length>0){html+=' <div class="zpl_rgtcnt"><div class="zpl_tblres wd100_per"> <table class="zpl_tbl"><thead><tr><th>'+ZPI18N.getString("zp.rownoofquickimport")+"</th><th>"+ZPI18N.getString("zp.errorDetails")+"</th></tr></thead><tbody>";var errorRowInfo=resultData.msg.errorRowInfo;errorRowInfo.sort(function(a,b){return a-b});for(var errInfo=resultData.msg.errorInfo,temp=0;temp<Object.keys(errInfo).length;temp++){var rNo=errorRowInfo[temp];errInfo[rNo];html+="<tr><td><span>"+rNo+"</td><td>"+errInfo[rNo]+"</span></td></tr>"}html+="</tbody></table></div></div>"}return html},submitRegMapping:function(){var container=Attendance.ImportNew.importContainer.find("#Attimport_verify_card"),si_Id=ZPeopleComponents.select(container.find("#ZPAtt_reg_importIds")).getValue(),si_Date=ZPeopleComponents.select(container.find("#ZPAtt_reg_importDate")).getValue(),si_punchIn=ZPeopleComponents.select(container.find("#ZPAtt_reg_importCheckIn")).getValue(),si_punchOut=ZPeopleComponents.select(container.find("#ZPAtt_reg_importCheckOut")).getValue(),si_reason=-1;regularization_operation.isRegReasonsEnabled()&&(si_reason=ZPeopleComponents.select(container.find("#ZPAtt_reg_importReason")).getValue());var si_desc=ZPeopleComponents.select(container.find("#ZPAtt_reg_importDescription")).getValue();if(""!==si_Id&&"-1"!==si_Id&&""!==si_Date&&"-1"!==si_Date&&""!==si_reason&&"-1"!==si_reason&&""!==si_punchIn&&"-1"!==si_punchIn&&""!==si_punchOut&&"-1"!==si_punchOut){var param={mode:"regImportMapping",mailId:si_Id,date:si_Date,punchInId:si_punchIn,punchOutId:si_punchOut,reasonId:si_reason,descId:""==si_desc?0:si_desc,conreqcsr:csrfToken,modeVal:"Operations"};"-1"!==ZPeopleComponents.select(container.find("#ZPAtt_reg_importDateFor")).getValue()&&(param.dateFormat=ZPeopleComponents.select(container.find("#ZPAtt_reg_importDateFor")).getValue()),"csv"!==Attendance.ImportNew.fileFormat||param.dateFormat?(Attendance.ImportNew.importContainer.find("#Attimport_summary_card").html(ZPeople.LOADING_HTML),$.post("/AttendanceAction.zp",param,function(resultData){Attendance.ImportNew.importSummary(resultData)})):Attendance.ImportNew.showFailureMsgForImport()}else Attendance.ImportNew.showFailureMsgForImport()},autoMappingFields:function(cont,rArray){for(var i in rArray)-1!==rArray[i].toLowerCase().indexOf("in")?ZPeopleComponents.select(cont.find("#ZPAtt_reg_importCheckIn_map")).setValue(i):-1!==rArray[i].toLowerCase().indexOf("out")?ZPeopleComponents.select(cont.find("#ZPAtt_reg_importCheckOut_map")).setValue(i):-1!==rArray[i].toLowerCase().indexOf("employee")||-1!==rArray[i].toLowerCase().indexOf("id")||-1!==rArray[i].toLowerCase().indexOf("user")?ZPeopleComponents.select(cont.find("#ZPAtt_reg_importIds_map")).setValue(i):-1!==rArray[i].toLowerCase().indexOf("date")?ZPeopleComponents.select(cont.find("#ZPAtt_reg_importDate_map")).setValue(i):-1!==rArray[i].toLowerCase().indexOf("description")?ZPeopleComponents.select(cont.find("#ZPAtt_reg_importDescription_map")).setValue(i):-1!==rArray[i].toLowerCase().indexOf("reason")&&0!==cont.find("#ZPAtt_reg_importReason_map").length&&ZPeopleComponents.select(cont.find("#ZPAtt_reg_importReason_map")).setValue(i)},downloadSample:function(){var formObj=$("<form id='ZPLeave_exp_form' action='AttendanceAction.zp?mode=regImport_template' method='post' target='exportresp1' style='display:none'/>").html("");formObj.append('<input type="hidden" value="'+csrfToken+'" name="conreqcsr"/>'),$("body").append(formObj),formObj.submit()}}};