var ZPDashboard={};(ZPDashboard={INITIATEWIDGETS:!0,handleAttendance:function(){},widgetPageRefresh:function(){ZPDashboard.INITIATEWIDGETS=!0,Attendance.Dashboard.DailyReport.data=null,ZPDashboard.Widget.loadModule()},isAdminSettingsPage:function(){return"admin_formslayout_widgets"===Layout.Page.urlmode},isOrgBased:function(){return ZPeople.Module.getData().isOrgBased},init:function(){$("#zp_d_wrow").children().remove();let container=Layout.Page.container,dashMainCont=container.find("#zp_d_wrow");0==dashMainCont.length?container.append($('<div class="Scrcont" style="top:135px !important"id="zp_dash_maincont"><div class="dash-main zp_DHC" id="zp_d_cmain"><div class="zprow" id="zp_d_wrow"></div></div></div>')):dashMainCont.empty(),ZPDashboard.loadTopBand(),1==ZPDashboard.Widget.MODULEDATAREFRESH&&ZPDashboard.Widget.loadModule()},getUserId:function(userId){return void 0===userId&&void 0!==Layout.Page.urlparam.userId&&(userId=Layout.Page.urlparam.userId),void 0===userId&&(userId=ZPeople.CURR_USER.usererec),userId},loadTopBand:function(){if(ZPTabs.isTabHidden("timetracker")?Layout.Page.container.find("#zp_d_timelog").remove():Layout.Page.container.find("#zp_d_timelog").on("click",function(){Timetracker.timelogs.Operations.formAddEditView(null,null,null,!1,!0)}),ZPTabs.isTabHidden("leavetracker"))Layout.Page.container.find("#zp_d_addleave").remove();else{var form_name=ZPeople.Module.getData().form_name.leave;Layout.Page.container.find("#zp_d_addleave").on("click",Leave.add),ZPeople.Module.getData().leave.allowAdd?Layout.Page.container.find("#apply_leave").append(ZPI18N.getString("zp.apply.context.leave")+" "+form_name):Layout.Page.container.find("#zp_d_addleave").addClass("DN")}void 0!=ZPeople.Module.getData().feedbackName.displayName&&(ZPFeeds.PMS.FormUtil.FeedbackName=ZPeople.Module.getData().feedbackName.displayName)},getResponse:function(resultData){resultData.trialpackStatus?(Layout.Page.container.find("#trailEnable").show(),Layout.Page.container.find("#trialDisable").hide(),Layout.Page.container.find("#licenseDueDate").text(ZPI18N.getString("zp.nextPaymentOn",[resultData.trialDueDays])),Layout.Page.container.find("#percentageTrial").attr("style","width:"+resultData.trialpercentage+"%"),Layout.Page.container.find("#trialDays").text(ZPI18N.getString("zp.daysleft",[resultData.trialDays])),Dashboard.planId=resultData.planId,Dashboard.trialDueDate=resultData.trialDueDays):(Layout.Page.container.find("#trialDisable").show(),Layout.Page.container.find("#trailEnable").hide(),Dashboard.planId=resultData.planId,"1"==resultData.planId&&$("#TrailinFree").show(),Layout.Page.container.find("#trialName").text(resultData.planName),null!=resultData.trialDueDays&&"Free"!=resultData.planName&&Layout.Page.container.find("#dueDate").text(ZPI18N.getString("zp.nextDueDate",[resultData.trialDueDays])))}}).Widget={URL:"/widget/",MODULEDATAREFRESH:!1,List:{BDAY:"BIRTHDAY",NJOIN:"NEWHIRES",TEAM:"DEPARTMENT_MEMBERS",WFAV:"FAVORITES",QLINKS:"QUICKLINKS",PAPP:"PENDING_APPROVALS",TASKS:"MYPENDINGTASKS",DANN:"ANNOUNCEMENTS",LEAVEREPORT:"LEAVEREPORT",HOLIDAYLIST:"HOLIDAYLIST",LEAVEONTODAY:"LEAVEONTODAY",EMPLOYEE_GROWTH_PER_YEAR:"EMPLOYEE_GROWTH_PER_YEAR",HIRING_ATTRITION:"HIRING_ATTRITION",TIMELOGS:"TIMELOGS",HR_CASE_REPORT:"HR_CASE_REPORT",TIMESHEETS:"TIMESHEETS",PENDINGJOBS:"PENDINGJOBS",BILLABLE_NONBILLABLE:"BILLABLE_NONBILLABLE",GOALS:"GOALS",APPRAISAL:"APPRAISAL",YEARLY_HIRING_ATTRITION:"YEARLY_HIRING_ATTRITION",FILES:"FILES",WORK_ANNIVERSARY:"WORK_ANNIVERSARY",WEDDING_ANNIVERSARY:"WEDDING_ANNIVERSARY",ENPS_SURVEY:"ENPS_SURVEY",RECRUIT_REFRL:"MYREFERRALS"},loadModule:function(){if(0==$("#custom_widget").length){var menu=$('<div class="zpl_treefilt" id="custom_widget"><i id="zp_d_refdash" class="PI_refresh zpl_c-p" onclick="ZPDashboard.widgetPageRefresh()" data-placement="bottom" title="'+ZPI18N.getString("zp.refresh")+'"></i><i id="zp_d_cdash" class="PI_widgt_custm zpl_c-p" onclick="ZPDashboard.Widget.showCustomize()" data-placement="bottom" title="'+ZPI18N.getString("zp.customizewidgets")+'"></i></div>');Layout.Page.container.prepend(menu)}if(ZPeople.reloadDashAttData&&(ZPeople.isMyspace()?TAMSUtil.Attendance.getCurrDayStatus():ZPeople.reloadAttDataFunction(),ZPeople.reloadDashAttData=!1),1==ZPDashboard.Widget.MODULEDATAREFRESH)if(1==ZPDashboard.INITIATEWIDGETS)ZPDashboard.init();else{ZPeople.Request.send(ZPDashboard.Widget.URL+"getWidgetInfo",{},function(data){1==data.success&&void 0!==data.widgets&&(ZPeople.Module.getData().widgets=data.widgets,ZPeople.Module.getData().isOrgBased=data.isOrgBased,ZPDashboard.Widget.load())})}else 1==ZPDashboard.INITIATEWIDGETS&&(ZPDashboard.INITIATEWIDGETS=!1,ZPDashboard.Widget.load())},load:function(){$("#zp_d_wrow").children().remove();var widArr=ZPeople.Module.getData().widgets;if(1==ZPDashboard.isOrgBased()&&!isTabCustomAdmin){let customizeIcon=Layout.Page.container.find("#zp_d_cdash");customizeIcon.attr("onclick",""),customizeIcon.removeClass("zpl_c-p "),customizeIcon.addClass("zpl_disabl").attr("title",ZPI18N.getString("zp.admindisinfo"))}widArr.length>0&&(ZPDashboard.Widget.registerWidget(),$.each(widArr,function(ind,widget){widget.isHidden||ZPDashboard.Widget.initiateWidget(widget)})),0==Layout.Page.container.find("#zp_d_wrow").children().length&&0==Layout.Page.container.find("#zpdash_nodata").length&&Layout.Page.container.find("#zp_d_cmain").prepend(ZPDashboard.components.nodataHtml(void 0,void 0,void 0,"zpdash_nodata")),ZPDashboard.Widget.MODULEDATAREFRESH=!1},initiateWidget:function(widget,pos){var conf=ZPDashboard.Widget.getConfiguration(widget.key);if(void 0!==conf){var layout=ZPDashboard.Widget.layout(conf,widget);if(layout.data("conf",conf),layout.data("widget",widget),void 0!==pos)if(0===pos)Layout.Page.container.find("#zp_d_wrow").prepend(layout);else{var child=Layout.Page.container.find("#zp_d_wrow").children()[pos];void 0!==child?layout.insertBefore($(child)):Layout.Page.container.find("#zp_d_wrow").append(layout)}else Layout.Page.container.find("#zp_d_wrow").append(layout);0==Layout.Page.container.find("#zp_d_wrow").children().length&&0==Layout.Page.container.find("#zpdash_nodata").length?Layout.Page.container.find("#zp_d_cmain").prepend(ZPDashboard.components.nodataHtml(void 0,void 0,void 0,"zpdash_nodata")):Layout.Page.container.find("#zp_d_wrow").children().length>0&&Layout.Page.container.find("#zp_d_cmain").find("#zpdash_nodata").remove(),ZPUtil.Validation.isFunction(conf.firecback)&&ZPDashboard.Widget.registerFireScroll(layout),ZPDashboard.Widget.loadData(widget.key,conf)}},getConfiguration:function(widName){var conf={};return widName===ZPDashboard.Widget.List.BDAY||widName===ZPDashboard.Widget.List.NJOIN||widName===ZPDashboard.Widget.List.TEAM||widName===ZPDashboard.Widget.List.WFAV||widName===ZPDashboard.Widget.List.FILES||widName===ZPDashboard.Widget.List.QLINKS||widName===ZPDashboard.Widget.List.WORK_ANNIVERSARY||widName===ZPDashboard.Widget.List.WEDDING_ANNIVERSARY?(conf={type:1,outerClass:"zp-sm-4"},widName===ZPDashboard.Widget.List.BDAY||widName===ZPDashboard.Widget.List.NJOIN||widName===ZPDashboard.Widget.List.WORK_ANNIVERSARY||widName===ZPDashboard.Widget.List.WEDDING_ANNIVERSARY?(conf.dColClass="BNDiv ",conf.bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div")):widName===ZPDashboard.Widget.List.FILES?(conf.type=3,conf.outerClass="zp-sm-6",conf.dColClass=" ",conf.callback=FILECABINET.dashBoardInit,conf.bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body OHI","div")):widName===ZPDashboard.Widget.List.QLINKS?(isadmin&&(conf.addicon='<i class="IC-plus-round" id="zpdash_qlinkadd"></i>',conf.bodyClass=ZPDashboard.Widget.constructDivElement(void 0,"Qklinks dash-body","ul")),conf.dColClass=" ",conf.bodyClass=ZPDashboard.Widget.constructDivElement(void 0,"Qklinks dash-body","ul")):widName===ZPDashboard.Widget.List.WFAV||widName===ZPDashboard.Widget.List.TEAM?(conf.dColClass=" ",conf.bodyClass=ZPDashboard.Widget.constructDivElement(void 0,"sst-edt dash-body Dfav listView","ul"),widName===ZPDashboard.Widget.List.TEAM&&(conf.bodyClass+=ZPDashboard.Widget.constructDivElement(void 0,"dash-body tile_vw gridView DN","ul"))):widName===ZPDashboard.Widget.List.NJOIN||widName===ZPDashboard.Widget.List.WORK_ANNIVERSARY||widName===ZPDashboard.Widget.List.WEDDING_ANNIVERSARY?(conf.dColClass=" ",conf.bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div")):(conf.dColClass=" ",conf.bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body nomo Dfav","div")),widName!==ZPDashboard.Widget.List.NJOIN&&widName!==ZPDashboard.Widget.List.TEAM&&widName!==ZPDashboard.Widget.List.WFAV||(conf.firecback=ZPDashboard.Widget.getMore)):widName===ZPDashboard.Widget.List.WATT?(conf={type:2,outerClass:"zp-sm-4",dColClass:" ",callback:Attendance.Dashboard.WeeklyData.getCurWeekData}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div"):widName===ZPDashboard.Widget.List.ATTREPORT?(conf={type:2,outerClass:"zp-sm-6",dColClass:" ",callback:Attendance.Dashboard.DailyReport.getAttDailyReport}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body nomo Cht","div"):widName===ZPDashboard.Widget.List.ATT_DASH_SUMMARY?(conf={type:2,outerClass:"zp-sm-4 zp-xs-12",dColClass:"",callback:Attendance.Dashboard.DailyReport.getDashboardSummRep}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body P20","div"):widName===ZPDashboard.Widget.List.LEAVEREPORT?(conf={type:2,outerClass:"zp-sm-4",dColClass:" ",callback:Leave.Dashboard.LeaveReport.get}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div"):widName===ZPDashboard.Widget.List.HOLIDAYLIST?(conf={type:2,outerClass:"zp-sm-4",dColClass:" ",callback:Leave.Dashboard.Holiday.get}).bodyClass=ZPDashboard.Widget.constructDivElement(void 0,"hdaylist dash-body","ul"):widName===ZPDashboard.Widget.List.LEAVEONTODAY?(conf={type:2,outerClass:"zp-sm-4",dColClass:"lv_emps",callback:Leave.Dashboard.LeaveOnTodayReport.get}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div"):widName===ZPDashboard.Widget.List.EMPLOYEE_GROWTH_PER_YEAR?(conf={type:3,outerClass:"zp-sm-6",dColClass:" ",callback:ZPDashboard.AdminWidgets.getEmployeeGrowth}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div"):widName===ZPDashboard.Widget.List.HIRING_ATTRITION?(conf={type:3,outerClass:"zp-sm-6",dColClass:" ",callback:ZPDashboard.AdminWidgets.getHiringAttrition}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div"):widName===ZPDashboard.Widget.List.TIMELOGS?(conf={type:3,outerClass:"zp-sm-6",dColClass:"  Tlogs",callback:Timetracker.Widgets.Timelogs.getTimelogs,tltcback:Timetracker.Widgets.Timelogs.getDashHeader}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div"):widName===ZPDashboard.Widget.List.HR_CASE_REPORT?conf=void 0:widName===ZPDashboard.Widget.List.TIMESHEETS?(conf={type:3,outerClass:"zp-sm-6",dColClass:"  tsht",callback:Timetracker.Widgets.Timesheets.getTimesheetList,tltcback:Timetracker.Widgets.Timesheets.getDashHeader,firecback:Timetracker.Widgets.Timesheets.FireScroll.loadMoreData}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div"):widName===ZPDashboard.Widget.List.PENDINGJOBS?(conf={type:3,outerClass:"zp-sm-6",dColClass:"  jobspend Kras",callback:Timetracker.Widgets.PendingJobs.getJobs,tltcback:Timetracker.Widgets.PendingJobs.getDashHeader,firecback:Timetracker.Widgets.PendingJobs.FireScroll.loadMoreData}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div"):widName===ZPDashboard.Widget.List.BILLABLE_NONBILLABLE?(conf={type:3,outerClass:"zp-sm-6",dColClass:" ",callback:Timetracker.Widgets.BillableNonBillable.getTimelogData,tltcback:Timetracker.Widgets.BillableNonBillable.getDashHeader}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body nomo Cht","div"):widName===ZPDashboard.Widget.List.GOALS?(conf={type:3,outerClass:"zp-sm-6",dColClass:"gls",callback:PADashboard.Goal.getDashboardGoals,firecback:PADashboard.Goal.showMoreDashboardGoalList,tltcback:PADashboard.Goal.goalsHeader}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div"):widName===ZPDashboard.Widget.List.APPRAISAL?(conf={type:3,outerClass:"zp-sm-6",dColClass:"gls",callback:PADashboard.PendingActy.getReviewPendingData,firecback:PADashboard.PendingActy.loadMoreData,tltcback:PADashboard.PendingActy.reviewHeader}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","div"):widName===ZPDashboard.Widget.List.YEARLY_HIRING_ATTRITION?(conf={type:3,outerClass:"zp-sm-12",callback:ZPDashboard.AdminWidgets.getYearlyHiringAttrition}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body ","div"):widName===ZPDashboard.Widget.List.PAPP?(conf={type:3,outerClass:"zp-sm-4",dColClass:" ",firecback:ZPApprovals.approvalFireScrollAction}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"Aprvlists dash-body","ul"):widName===ZPDashboard.Widget.List.TASKS?(conf={type:3,outerClass:"zp-sm-6",dColClass:" ",firecback:ZPTaskWidget.fireScroll}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body","ul"):widName===ZPDashboard.Widget.List.DANN?((conf={type:3,outerClass:"zp-sm-4 ZPDBT",dColClass:" ",callback:Announcement.Dashboard.getAnnouncementList,firecback:ZPDashboard.Widget.getMore}).bodyClass=ZPDashboard.Widget.constructDivElement(void 0,"Anlists dash-body","ul"),isAnnAdmin&&(conf.addicon='<i class="IC-plus-round" id="zpdash_annadd"></i>')):widName===ZPDashboard.Widget.List.ENPS_SURVEY?(conf={type:2,outerClass:"zp-sm-4",dColClass:" ",callback:ZDOMEEAPI.api.constructSurveyWidget}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body P20","div"):widName===ZPDashboard.Widget.List.RECRUIT_REFRL?(conf={type:3,outerClass:"zp-sm-12",dColClass:"  zp-refl"}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body ","div"):widName.indexOf("SIGMA_")>-1?(conf={type:3,outerClass:"zp-sm-6",callback:ZPWidget.constructdashboardWidget,sigmaWidName:widName}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body ","div"):(conf={type:3,outerClass:"zp-sm-6"}).bodyClass=ZPDashboard.Widget.constructDivElement(widName,"dash-body ","div"),conf},constructDivElement:function(widName,className,type){return"div"===type?'<div id="'+widName+'" class="'+className+' "> '+ZPeople.LOADING_HTML+" </div>":void 0!==widName?'<ul id="'+widName+'" class="'+className+'">'+ZPeople.LOADING_HTML+" </ul>":'<ul class="'+className+'">'+ZPeople.LOADING_HTML+" </ul>"},layout:function(json,widget){let inlineStyle=widget.key===ZPDashboard.Widget.List.RECRUIT_REFRL?'style="clear: left;"':"";var lout=$('<div class="'+json.outerClass+'" name="'+widget.key+'" widget="true" tabindex="0" aria-label="'+ZSEC.Encoder.encodeForHTML(widget.name)+'" widId="'+widget.widId+'" '+inlineStyle+'><div class="dash-col '+("BIRTHDAY"===widget.key?"bdayBG ":"")+(void 0!=json.dColClass?json.dColClass:"")+'">'+(json.disableHeader?"":'<div class="dash-head hicon'+(1!=ZPDashboard.isOrgBased()?" IC-drag":"")+'"'+("BIRTHDAY"===widget.key?'bdayBG"':"")+'"><h3 class="dash-title" tabindex="0"   title="'+ZSEC.Encoder.encodeForHTML(widget.name)+'">'+ZSEC.Encoder.encodeForHTML(widget.name)+(ZPUtil.Validation.isEmpty(json.addicon)?"":json.addicon)+"</h3>"+("DEPARTMENT_MEMBERS"===widget.key?'<div class="widswch"><div class="sel IC-list-v " id="listView" onclick="ZPDashboard.Widget.switchDeptMembersView(this)"></div><div class="IC-apps" id="gridView" onclick="ZPDashboard.Widget.switchDeptMembersView(this)"></div></div>':"")+'<span class="cout DN" id="zpdash_widgetcnt"><b>'+(void 0!==widget.count&&widget.count>0?widget.count:"")+"</b></span></div>")+(json.bodyClass?json.bodyClass:"")+(void 0!=json.footer?json.footer:"")+"</div></div>");(ZPUtil.Validation.isFunction(json.tltcback)&&lout.find(".dash-head").html(json.tltcback(widget)),widget.key===ZPDashboard.Widget.List.PAPP)&&lout.find(".dash-head").html('<h3 class="dash-title">'+ZSEC.Encoder.encodeForHTML(widget.name)+'</h3><span class="cout">'+ZPI18N.getString("zp.pending")+'<span id="zp_pappr_count"><b>0</b></span></span>');return lout},switchDeptMembersView:function(event){var obj=Layout.Page.container.find('[name="'+ZPDashboard.Widget.List.TEAM+'"]');if("listView"===event.id){obj.find(".listView").removeClass("DN"),obj.find("#listView").addClass("sel"),obj.find(".gridView").addClass("DN"),obj.find("#gridView").removeClass("sel"),obj.find(".listView").scrollTop(0);var length=obj.find(".listView li").length;if(obj.attr("count",length),obj.removeAttr("triggered"),0==length){obj.find(".listView").html(ZPeople.LOADING_HTML);var params={widget:ZPDashboard.Widget.List.TEAM},mode="getWidget";ZPeople.Request.send(ZPDashboard.Widget.URL+mode,params,ZPDashboard.Widget.construct,Layout.Page.container.find("[name="+ZPDashboard.Widget.List.TEAM+"]"))}}else{obj.find(".listView").addClass("DN"),obj.find("#listView").removeClass("sel"),obj.find(".gridView").removeClass("DN"),obj.find("#gridView").addClass("sel"),obj.find(".gridView").scrollTop(0),obj.removeAttr("triggered");length=obj.find(".gridView li").length;if(obj.attr("count",length),0==length){obj.find(".gridView").html(ZPeople.LOADING_HTML);params={widget:ZPDashboard.Widget.List.TEAM,isGridView:!0},mode="getWidget";ZPeople.Request.send(ZPDashboard.Widget.URL+mode,params,ZPDashboard.Widget.construct,Layout.Page.container.find("[name="+ZPDashboard.Widget.List.TEAM+"]"))}}},getCollabPerson:function(result,widName,widget,isMore){var widObj=Layout.Page.container.find("[name="+widName+"]"),widHtml=$('<div class="dtls"></div>'),list=result.list,inerHtml="";$.each(list,function(ind,info){var yearsserved,userDtl=list[ind];yearsserved=widName===ZPDashboard.Widget.List.WORK_ANNIVERSARY?userDtl.workAnn:userDtl.weddAnn,list[ind].yearcnt=ZPUtil.getSuffixforNumber(yearsserved),inerHtml+='<div class="Uinfo" eno="'+userDtl.eno+'" tabindex="0" userId="'+userDtl.zuid+'"> <div class="Bd-usrimg"> <img src="'+userDtl.photo+'" class="Usrimg"> <div cstus="true" uid="'+userDtl.zuid+'"> </div> </div> <div class="Udts"> <h6 class="CP"> <b ><span class="usrID">'+userDtl.eid+"&nbsp;-&nbsp;</span>"+userDtl.name+"</b> </h6> <span>"+(ZPUtil.Validation.isEmpty(userDtl.desname)?"":userDtl.desname)+(ZPUtil.Validation.isEmpty(userDtl.dpname)||ZPUtil.Validation.isEmpty(userDtl.desname)?"":"&nbsp;-&nbsp;")+(ZPUtil.Validation.isEmpty(userDtl.dpname)?"":userDtl.dpname)+"</span> <span>"+(ZPUtil.Validation.isEmpty(userDtl.locName)?"":userDtl.locName)+(ZPUtil.Validation.isEmpty(userDtl.locName)||ZPUtil.Validation.isEmpty(userDtl.divName)?"":"&nbsp;-&nbsp;")+(ZPUtil.Validation.isEmpty(userDtl.divName)?"":userDtl.divName)+'</span> <div class="usr_cl"> '+(ZPUtil.Validation.isEmpty(userDtl.extn)?"":'<span class="MR20"><i class="IC-phone"></i>'+userDtl.extn+"</span>")+(ZPUtil.Validation.isEmpty(userDtl.mobile)?"":' <span><i class="IC-mobi"></i>'+userDtl.mobile+"</span>")+" </div> </div> </div>"}),inerHtml=$(inerHtml);var temp=$("<div></div>");temp.append(inerHtml);var tempList=[],len=list.length;return widObj.attr("count")&&(len+=parseInt(widObj.attr("count"))),widObj.attr("count",len),isMore?(tempList=widObj.data("list"),tempList=ZPUtil.mergeArrays(tempList,list,!0,!0)):tempList=list,widObj.data("list",tempList),inerHtml=temp.children(),isMore?(widObj.find(".dtls").append(inerHtml),widHtml=widObj.find(".dtls")):widHtml.append(inerHtml),widHtml.find(".Uinfo").unbind("click"),widHtml.find(".Uinfo").on("click",function(){var type=5;if($(this).siblings("[isdisabled=true]").length>0)return;widName===ZPDashboard.Widget.List.NJOIN?type=6:widName===ZPDashboard.Widget.List.WORK_ANNIVERSARY?type=8:widName===ZPDashboard.Widget.List.WEDDING_ANNIVERSARY&&(type=9),$(this).addClass("disabled"),$(this).attr("isdisabled",!0);let usererec=$(this).attr("eno");ZPUsers.manageCollabPopup(Layout.Page.pageContWrapper.find(".main-wrp:visible"),widName,result,type,usererec,void 0,void 0,"list",!0,()=>{$(this).removeClass("disabled"),$(this).removeAttr("isdisabled")})}),widHtml},create:function(result,widName){var widHtml,widObj=Layout.Page.container.find("[name="+widName+"]");if(result&&void 0!==result.count&&0!==result.count){var count=widName===ZPDashboard.Widget.List.TASKS?result.count[0].count:result.count;Layout.Page.container.find("[name="+widName+"]").find("#zpdash_widgetcnt").removeClass("DN"),Layout.Page.container.find("[name="+widName+"]").find("#zpdash_widgetcnt").children().text(count)}else Layout.Page.container.find("[name="+widName+"]").find("#zpdash_widgetcnt").addClass("DN"),Layout.Page.container.find("[name="+widName+"]").find("#zpdash_widgetcnt").children().html("");if(widName===ZPDashboard.Widget.List.BDAY||widName===ZPDashboard.Widget.List.NJOIN||widName===ZPDashboard.Widget.List.WORK_ANNIVERSARY||widName===ZPDashboard.Widget.List.WEDDING_ANNIVERSARY){Layout.Page.container.find("[name="+widName+"]").find("#zpdash_widgetcnt").addClass("DN");var widget=Layout.Page.container.find("[name="+widName+"]").data("widget");if(void 0!==result.list&&result.list.length>0)widHtml=ZPDashboard.Widget.getCollabPerson(result,widName,widget);else{var param,key="zp.nonewhiresfound",imgClass="CR-tt-clients",imgPath=8;widName===ZPDashboard.Widget.List.BDAY?(key="zp.nobirthdaytoday",imgClass="CR-db-birthday",imgPath=4):widName!==ZPDashboard.Widget.List.WORK_ANNIVERSARY&&widName!==ZPDashboard.Widget.List.WEDDING_ANNIVERSARY||(key="zp.noanniversarytoday",param=[ZPI18N.getString(widName===ZPDashboard.Widget.List.WEDDING_ANNIVERSARY?"zp.wedding":"zp.work")],imgClass="CR-nodata",imgPath=6),widHtml=ZPUtil.newNoDataHTML(imgClass,imgPath,ZPI18N.getString(key,param),void 0,void 0)}}else if(widName===ZPDashboard.Widget.List.TEAM||widName===ZPDashboard.Widget.List.WFAV)if(widName!==ZPDashboard.Widget.List.WFAV&&widName!==ZPDashboard.Widget.List.TEAM&&(widHtml=$('<ul class="sst-edt"></ul>')),void 0!==result.list&&result.list.length>0)if(widName===ZPDashboard.Widget.List.WFAV||widName===ZPDashboard.Widget.List.TEAM)if(widName===ZPDashboard.Widget.List.TEAM){widObj.find(".gridView").find("#zp_page_loading").remove();var listClass=Layout.Page.container.find(".dash-head").find("#listView").attr("class");widHtml=void 0!==listClass?-1!==listClass.indexOf("sel")?ZPDashboard.Widget.getListHtml(result.list,widObj,widName):ZPDashboard.Widget.getGridViewHtml(result.list,widObj,widName):ZPDashboard.Widget.getListHtml(result.list,widObj,widName)}else widHtml=ZPDashboard.Widget.getListHtml(result.list,widObj,widName);else widHtml.append(ZPDashboard.Widget.getListHtml(result.list,widObj,widName));else{key="zp.norec",imgClass="CR-nodata",imgPath=6;widName===ZPDashboard.Widget.List.WFAV&&(key="zp.nofavoritefound",imgClass="CR-db-nofav",imgPath=8),widHtml=ZPUtil.newNoDataHTML(imgClass,imgPath,ZPI18N.getString(key),void 0,void 0)}else if(widName===ZPDashboard.Widget.List.DANN)result=result.announcementList,widHtml=ZPDashboard.Widget.constructAnnouncementList(widObj,widName,result);else if(widName===ZPDashboard.Widget.List.PAPP)if(7e3===result.code){for(var ids=[],len=result.message.length,apprList=result.message,apInd=0;apInd<len;apInd++)ids.push(apprList[apInd].recordOwnerErecno);apprList.length<21?$("#zp_pappr_count").html("<b>"+apprList.length+"</b>"):($("#zp_pappr_count").html("<span> <a>#</a> </span>"),$("#zp_pappr_count").on("click",function(){ZPApprovals.getPendingCount()}));var fireScrollParam={action:"myApprovals",mode:"viewApprovals",approvalStatus:"pending",empStatus:zpconst.EmployeeStatus.activeemprecord};ZPDashboard.Widget.constructApprDashBoardRow(result,fireScrollParam,widHtml)}else 7024===result.code&&(widHtml=CommonTemplates.noDataSVG("",!0,ZPI18N.getString("zp.norec"),!1));else if(widName===ZPDashboard.Widget.List.TASKS)ZPTaskWidget.construct(result);else if(widName===ZPDashboard.Widget.List.QLINKS&&void 0!==result){var listHtml="";if((len=result.length)>0){for(var ind=0;ind<len;ind++)listHtml+='<li id="'+result[ind].linkId+'" seq="'+result[ind].seq+'" fld="quickLnk"><a href="'+result[ind].url+'" target="_blank">'+(isadmin?'<i fld="drag" class="PI_drag gr6 zpl_pr1"></i>':"")+'<i class="Qkicon CR-link "><i class="path1"></i><i class="path2"></i></i>'+result[ind].name+"</a>"+(isadmin?'<span id="zp_quicklink_act" class="Qklnks_act"><i id="zp_quicklink_edit" title="Edit" class="IC-pen MR5 gry"></i><i id="zp_quicklink_delete" title="Delete" class="IC-delete  gry"></i><input type="hidden" value="'+result[ind].linkId+'" lname="'+result[ind].name+'" lurl="'+result[ind].url+'" id="zp_quicklink_id"></span>':"")+"</li>";(widHtml=$(listHtml)).find("#zp_quicklink_edit").on("click",function(){var datObj=$(this).siblings("#zp_quicklink_id");ZPDashboard.Widget.constructQlinkModal(!0,ZPeople.escapeHtml(datObj.attr("lname")),ZPeople.escapeHtml(datObj.attr("lurl")),datObj.val())}),widHtml.find("#zp_quicklink_delete").on("click",function(){ZPDashboard.Widget.deleteQlink($(this))})}else widHtml=listHtml=$(ZPUtil.newNoDataHTML("CR-db-nolink",8,ZPI18N.getString("zp.noquicklinks"),void 0,"noQckLink"));isadmin&&widObj.find("#zpdash_qlinkadd").on("click",function(){ZPDashboard.Widget.constructQlinkModal(!1)})}if(widName===ZPDashboard.Widget.List.RECRUIT_REFRL)if(void 0!==result.list&&result.list.length>0){$('<table class="table table-hover wd100_per"><thead><tr><td width="40%"><span class="bld">Candidate Name</span></td><td width="30%"><span class="bld">Job Opening</span></td><td width="30%"><span class="bld">Candidate Status</span></td></tr></thead></table>').insertBefore("div#MYREFERRALS"),result.hasOwnProperty("referralLink")&&($("div[name='MYREFERRALS']").find("#zpdash_widgetcnt > b").remove(),$("div[name='MYREFERRALS']").find("#zpdash_widgetcnt").append('<a data-toggle="tooltip" data-placement="bottom" title="View all" data-original-title="View all" href="'+result.referralLink+'" target="_blank"><i class="PI_redirect  MR10 CP S14"></i></a>'),$("div[name='MYREFERRALS']").find("#zpdash_widgetcnt").removeClass("DN")),widHtml='<table class="table table-hover wd100_per" id="referrals"><tbody>';for(ind=0;ind<result.list.length;ind++){widHtml+='<tr><td width="40%" class="VT"><div class="blk">'+result.list[ind].candidateName+'</div><span class="S12">'+result.list[ind].candidateEmail+'</span></td><td width="30%">',jobDetSize=result.list[ind].jobDetails.length;for(var job=0;job<jobDetSize;job++)widHtml+='<div class="ht40" style="'+(0==job?"":"display: none;")+'"><div class="'+result.list[ind].jobDetails[job].jobStatusColor+'">'+result.list[ind].jobDetails[job].jobOpening,0==job&&jobDetSize>1&&(showmore='<span><a name="showmore" class="ML10" onclick="ZPDashboard.Widget.showMoreReferralData(this,'+jobDetSize+')">+'+(jobDetSize-1)+" "+ZPI18N.getString("zp.smore")+"</a></span>",widHtml+=showmore),widHtml+="</div>"+(result.list[ind].jobDetails[0].hasOwnProperty("isJobClosed")?'<span class="S12">'+(result.list[ind].jobDetails[job].isJobClosed?ZPI18N.getString("zp.closed"):ZPI18N.getString("zp.open"))+"</span>":"")+"</div>";widHtml+='</td><td width="30%">';for(job=0;job<result.list[ind].jobDetails.length;job++)widHtml+='<div class="ht40" style="'+(0==job?"":"display: none;")+'"><div class="'+result.list[ind].jobDetails[job].candStatusColor+'">'+result.list[ind].jobDetails[job].candidateStatus+"</div></div>";widHtml+="</td></tr>"}widHtml+="</tbody></table>"}else key="zp.noreffound",imgClass="CR-users",imgPath=9,btnHtml='<a class="btn btn-primary" target="_blank" href="'+result.referralLink+'">'+ZPI18N.getString("zp.refButton")+"</a>",widHtml=ZPUtil.newNoDataHTML(imgClass,imgPath,ZPI18N.getString(key),void 0,void 0),widHtml=$(widHtml).find("#zp_views_nodata").parent().append(btnHtml);return widHtml},showMoreReferralData:function(ele,size){$(ele).closest("div.ht40").siblings("div.ht40").toggle(),$(ele).closest("td").siblings("td").find("div.ht40:not(:first)").toggle(),1==$(ele).closest("td").siblings("td").find("div.ht40 :visible").length?$(ele).text("+"+(size-1)+" "+ZPI18N.getString("zp.smore")):$(ele).text(ZPI18N.getString("zp.showless"))},constructApprDashBoardRow:function(result,param,widHtml){if(7e3===result.code){widHtml=void 0!=widHtml?widHtml:Layout.Page.container.find("[name="+ZPDashboard.Widget.List.PAPP+"]").find(".Aprvlists");var resultDataLength=result.message.length;21==resultDataLength&&(resultDataLength-=1);for(var ahtml="",index=0;index<resultDataLength;index++){var apObj=result.message[index],formName=1==apObj.approvalAction?apObj.formName+"-("+ZPI18N.getString("zp.cancelrequest")+")":apObj.formName;ahtml='<li id="zp_appr_'+apObj.recordId+'" formid="'+apObj.formId+'" recordid="'+apObj.recordId+'" tablename="'+apObj.tableName+'"><img src="'+apObj.employeePhotoUrl+'" class="Usrimg" popup="user" empid="'+apObj.recordOwnerZUID+'"><div class="lisnam"><div class="ZPAUname">'+formName+'</div><div class="ZPAUct">'+apObj.requestedOn+"</div></div></li>",widHtml.append(ahtml)}widHtml.find("li").off("click").on("click",function(){ZPDashboard.Widget.Actions.loadApprovalRecord($(this).attr("formid"),$(this).attr("recordid"),$(this).attr("tablename")),$(this).off("click")}),ApprovalList.setFireScollCount(result,param,!0)}},constructAnnouncementList:function(widObj,widName,result,isMore){if(Object.keys(result).length>0)widHtml="",$.each(result,function(){var listData="";if(void 0!==this.categories&&this.categories.length>0)for(var clsclr=1,length=this.categories.length,i=0;i<length;i++)void 0!==Announcement.CATEGORIES[this.categories[i]]&&(listData+='<li class="clrBg'+(0!=(clsclr=(i+1)%7)?clsclr:clsclr+1)+'"><span class="textClr">'+Announcement.CATEGORIES[this.categories[i]]+"</span></li>");var tempHtml='<li id="'+this.announcementId+'" class = "Econt zp_AnCat"><div><span class="ellipsis">'+this.subject+"</span>"+(""!==listData?'<ul class="ann_category">'+listData+"</ul>":"")+'<span class="cdate">'+ZPDateTime.getDateDisplayFormat(this.postedTime)+'</span></div><img src="'+(ZPUtil.Validation.isEmpty(this.photo)?ZPeople.getResourceURL(imageUrl+"user.png"):this.photo)+'" class="Usrimg FR"></li>';widHtml+=tempHtml});else if(1!=isMore){var ndHtml=ZPUtil.newNoDataHTML("CR-db-anno",5,ZPI18N.getString("zp.noannouncements",[Announcement.TABDISPNAME]),void 0,void 0);widHtml=$(ndHtml)}var count=parseInt(void 0!==widObj.attr("count")?widObj.attr("count"):0);return widObj.attr("count",0!==count?count+Object.keys(result).length:Object.keys(result).length),widObj.find("#zpdash_annadd").off("click").on("click",function(){Announcement.getLocationsAndCategories(),Announcement.Construction.constructAddOrEditAnnouncementPage(Layout.Page.hash)}),widHtml},constructQlinkModal:function(isEdit,linkName,linkUrl,linkId){var bodyHtml="";bodyHtml=isEdit?'<div class="Main-lists"><form class="form-horizontal pad " role="form" id="addform"><div class="form-group"><label class="control-label col-sm-3">'+ZPI18N.getString("zp.linkname")+':</label><div class="col-sm-7"><input id="zp_qlinkname" type="text" '+(void 0!==linkId?'value="'+linkName+'"':"")+' class="form-control"></div></div><div class="form-group"><label class="control-label col-sm-3">'+ZPI18N.getString("zp.linkurl")+':</label><div class="col-sm-7"><input id="zp_qlinkurl" '+(void 0!==linkId?'value="'+linkUrl+'"':"")+' type="text" class="form-control"></div></div>'+(void 0!==linkId?'<input type="hidden" value="'+linkId+'" id="zp_qlinkid">':"")+"</form></div>":'<div class="Main-lists"><form class="form-horizontal pad " role="form" id="addform"><div class="form-group"><label class="control-label col-sm-3">'+ZPI18N.getString("zp.linkname")+':</label><div class="col-sm-7"><input id="zp_qlinkname" type="text" value="" class="form-control"></div></div><div class="form-group"><label class="control-label col-sm-3">'+ZPI18N.getString("zp.linkurl")+':</label><div class="col-sm-7"><input id="zp_qlinkurl" value="" type="text" class="form-control"></div></div></form></div>';var modal=ZPeople.BSModal.get({id:"zp_dash_qlink",type:5,header:ZPI18N.getString("zp.widget.quicklinks"),body:"",iconClass:"IC-lnk",iconParenClass:"Tbc",isConfirm:!0,body:bodyHtml,deleteOnHide:!0,footer:'<div class="modal-footer text-center"><button type="button" id="zp_modal_blubtn" class="btn btn-primary" >'+ZPI18N.getString("zp.save")+'</button><button type="button" class="btn btn-default" data-dismiss="modal" aria-label="Close">'+ZPI18N.getString("zp.cancel")+"</button></div>",modalClass:"member-modal QLmdl",removeModalClass:"DelMdl",successCallback:ZPDashboard.Widget.addOrUpdateQlink});ZPeople.BSModal.show(modal)},addOrUpdateQlink:function(){var step2modal=Layout.Page.parentContainer.find("#zp_dash_qlink").find("#step1");let name=step2modal.find("#zp_qlinkname").val(),url=step2modal.find("#zp_qlinkurl").val();if(!step2modal.find("span").is(":visible")){if(ZPUtil.Validation.isEmpty(name))return void step2modal.find("#zp_qlinkname").after('<span class="ERR MT5">'+ZPI18N.getString("zp.entervalidlinkname")+"</span>");if(name>50)return void step2modal.find("#zp_qlinkname").after('<span class="ERR MT5">'+ZPI18N.getString("zp.namelenghtwarn")+"</span>");if(ZPUtil.Validation.isEmpty(url))return void step2modal.find("#zp_qlinkurl").after('<span class="ERR MT5">'+ZPI18N.getString("zp.entervalidlinkurl")+"</span>");if(url.length>1e3)return void step2modal.find("#zp_qlinkurl").after('<span class="ERR MT5">'+ZPI18N.getString("zp.lengthwarning",[ZPI18N.getString("zp.linkurl"),1e3])+"</span>")}var linkId;ZPeople.BSModal.hide("zp_dash_qlink"),step2modal.find("#zp_qlinkid").length>0&&!ZPUtil.Validation.isEmpty(step2modal.find("#zp_qlinkid").val())&&(linkId=step2modal.find("#zp_qlinkid").val());var params={linkURL:encodeURIComponent(url),linkName:name,linkId:linkId};ZPeople.Request.send(ZPDashboard.Widget.URL+"addQuickLinks",params,ZPDashboard.Widget.handleQuickLinkresponse),step2modal.find("#zp_qlinkname,#zp_qlinkurl").val("")},deleteQlink:function(Obj){var params={linkId:Obj.siblings("#zp_quicklink_id").val()};ZPeople.Request.send(ZPDashboard.Widget.URL+"deleteQuickLinks",params,ZPDashboard.Widget.handleQuickLinkresponse)},handleQuickLinkresponse:function(data,params){if(data.success){if("ADD_QUICKLINK"===params.MODE){let message=params.linkId?ZPI18N.getString("zp.qlinkupdatedsuccessfully"):ZPI18N.getString("zp.qlinkaddedsuccessfully");ZPeople.Message.showSuccessMsg(message)}else ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.linkdeletedsuccessfully"));ZPDashboard.Widget.refreshQLinkWidget(data,params)}else ZPeople.Message.failure(data.message?data.message:ZPI18N.getString("zp.sorryservererror"))},refreshQLinkWidget:function(data,params){var outerObj=Layout.Page.container.find('[name="QUICKLINKS"]');if(data.success)if("ADD_QUICKLINK"===params.MODE){var qlink=data.qlinks[0],qlinkObj=outerObj.find("ul").find("#"+qlink.linkId),listHtml='<li id="'+qlink.linkId+'" seq="'+qlink.seq+'" fld="quickLnk"><a href="'+qlink.url+'" target="_blank">'+(isadmin?'<i fld="drag" class="PI_drag gr6 zpl_pr1"></i>':"")+'<i class="Qkicon CR-link MR5"><i class="path1"></i><i class="path2"></i></i>'+qlink.name+"</a>"+(isadmin?'<span id="zp_quicklink_action" class="Qklnks_act"><i id="zp_quicklink_edit" title="Edit" class="IC-pen MR5 gry"></i><i id="zp_quicklink_delete" title="Delete" class="IC-delete  gry"></i><input type="hidden" value="'+qlink.linkId+'" lname="'+qlink.name+'" lurl="'+qlink.url+'" id="zp_quicklink_id"></span>':"")+"</li>";void 0!==params.linkId?qlinkObj.replaceWith(listHtml):0==outerObj.find("#noQckLink").length?outerObj.find(".Qklinks").append(listHtml):outerObj.find(".Qklinks").html(listHtml),(qlinkObj=outerObj.find("ul").find("#"+qlink.linkId)).find("#zp_quicklink_edit").on("click",function(){var datObj=$(this).siblings("#zp_quicklink_id");ZPDashboard.Widget.constructQlinkModal(!0,ZPeople.escapeHtml(datObj.attr("lname")),ZPeople.escapeHtml(datObj.attr("lurl")),datObj.val())}),qlinkObj.find("#zp_quicklink_delete").on("click",function(){ZPDashboard.Widget.deleteQlink($(this))})}else{(qlinkObj=outerObj.find("ul").find("#"+data.linkId)).remove(),0==outerObj.find("ul").children().length&&outerObj.find("ul").html(ZPUtil.newNoDataHTML("CR-db-nolink ",8,ZPI18N.getString("zp.noquicklinks"),void 0,"noQckLink"))}},updateQuickLinkSequance:(container,id,oldSeq,newSeq)=>{let param={linkId:id,oldSeq:oldSeq,newSeq:newSeq};ZPeople.Request.send("/orgspace/rearrangequicklinks",param,function(response,param){if(200==response.code){let downward=param.newSeq>param.oldSeq,from=downward?param.oldSeq:param.newSeq,to=downward?param.newSeq:param.oldSeq;container.find('[fld="quickLnk"]').filter(function(){return parseInt($(this).attr("seq"))>=from&&parseInt($(this).attr("seq"))<=to}).each(function(){let temp=$(this),tId=temp.attr("id"),seq=parseInt(temp.attr("seq"));tId==param.linkId?temp.attr("seq",param.newSeq):downward?temp.attr("seq",seq-1):temp.attr("seq",seq+1)})}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.reorderquicklinkfailermessagee"))})},getListHtml:function(list,widObj,widName){for(var listHtml="",len=list.length,ind=0;ind<len;ind++){var userDtl=list[ind];listHtml+='<li tabindex="0"><a><img src="'+userDtl.photo+'" class="Usrimg FL"><div class="ZPUsrDt" id="'+userDtl.eno+'"><span class="usrDts"><span class="usrEmpID">'+userDtl.eid+"&nbsp;-&nbsp;</span>"+userDtl.name+"</span>"+(ZPUtil.Validation.isEmpty(userDtl.mobile)?"":'<span class="sse-mn  IC-mobi">'+userDtl.mobile+"</span>")+(ZPUtil.Validation.isEmpty(userDtl.extn)?"":'<span class="sse-mn IC-phone">'+userDtl.extn+"</span>")+"</div>"+(userDtl.zuid!==_LOGGEDIN_ZUID&&"true"==ZPeople.ISCHAT?'<div class="DBhover">'+ZPUtil.getICONHtml("PI_pharw",2,["uid="+userDtl.zuid,'tabindex="0"','chat_comm="true"'])+"</div>":"")+"</a></li>"}return(listHtml=$(listHtml)).find(".ZPUsrDt").on("click",function(){ZPeople.getUserPage(this.id)}),widObj.attr("count")&&(len+=parseInt(widObj.attr("count"))),widObj.attr("count",len),listHtml},getGridViewHtml:function(list,widObj,widName){for(var gridHtml="",len=list.length,ind=0;ind<len;ind++){var userDtl=list[ind];ind%6==0&&(gridHtml+="<ul>"),gridHtml+='<li title="'+userDtl.name+'"><img src="'+userDtl.photo+'" class="dept_mmbrs gridview"  id="'+userDtl.eno+'" ></li>',(ind+1)%6!=0&&ind+1!=len||(gridHtml+="</ul>")}return(gridHtml=$(gridHtml)).find(".gridview").on("click",function(event){var obj=$(this).parent().parent().parent(),prevSelId=obj.find(".Dpt_usrdtls").attr("id"),curSelId=$(this).attr("id");if(void 0!=prevSelId&&prevSelId!=curSelId&&obj.find("img#"+prevSelId).removeClass("sel"),-1==$(this).attr("class").indexOf("sel")){$(this).addClass("sel"),obj.find(".Dpt_usrdtls").remove();var userDts=ZPeople.getUserDetailsById(curSelId);if(void 0!=userDts&&null!=userDts){var mobile=ZPUtil.Validation.isEmpty(userDts.mobile)?"":'<span class="sse-mn IC-mobi ">'+userDts.mobile+"</span>",extn=ZPUtil.Validation.isEmpty(userDts.extension)?"":'<span class="sse-mn IC-phone ">'+userDts.extension+"</span>",chat=userDts.id!==_LOGGEDIN_ZUID&&"true"==ZPeople.ISCHAT?'<div class="DBhover"><i class="CR-cmsg" uid="'+userDts.id+'" isChat="true"><i class="path1"></i><i class="path2"></i></i></div>':"";$(this).parent().parent().after('<div class="Dpt_usrdtls CP" id="'+userDts.usererec+'"><span class="usrDts"> <span class="usrEmpID">'+userDts.empid+"</span> - "+userDts.name+" </span>"+mobile+extn+chat+"</div>"),$(".Dpt_usrdtls").hide(),$(".Dpt_usrdtls").slideDown(),$(".Dpt_usrdtls").on("click",SelfService.get)}}else $(".Dpt_usrdtls").slideUp(),$(this).removeClass("sel")}),widObj.attr("count")&&(len+=parseInt(widObj.attr("count"))),widObj.attr("count",len),gridHtml},getNodata:function(message,enbBtn,btnVal){return'<div class="dash-noimg"><img '+(ZPeople.ISResellerConsole?'style="width: 100;"':"")+'src="'+ZPeople.getResourceURL(newUIImageUrl+"zpbee.png")+'" alt=""><h5>'+message+"</h5>"+(enbBtn?'<button class="btn btn-default">'+btnVal+"</button>":"")+"</div>"},proceedToLoad:function(name){var winhei=$(window).height(),scrolltop=$(document).scrollTop(),widget=Layout.Page.container.find("[name="+name+"]"),widtop=widget.offset().top;widget.height();return widtop>scrolltop-50&&scrolltop+winhei>widtop},registerWidget:function(isAdminSetting){Layout.Page.container.find(".dash-main").on("scroll",function(){ZPDashboard.Widget.loadData()}),$(window).on("resize",function(){ZPDashboard.Widget.loadData()}),1!=ZPDashboard.isOrgBased()&&Layout.Page.container.find("#zp_d_wrow").sortable({containment:"#zp_d_cmain",placeholder:"dash-placeholder",handle:".IC-drag ",update:function(event,ui){var itemId=$(ui.item).attr("widId"),param={};Layout.Page.container.find("#zp_d_wrow").children().each(function(ind,obj){itemId==$(this).attr("widId")&&(param.widId=itemId,param.seq=ind+1)}),ZPDashboard.Widget.Actions.updateWidgetSequence(param)}})},loadData:function(name){(void 0!==name?Layout.Page.container.find("[name="+name+"]"):Layout.Page.container.find("[widget=true]")).each(function(){if("true"!==$(this).attr("loaded")){name=$(this).attr("name");var conf=$(this).data("conf");ZPDashboard.Widget.proceedToLoad(name,conf)&&($(this).attr("loaded",!0),ZPDashboard.Widget.get(name,conf))}})},get:function(name,widget){if(ZPUtil.Validation.isFunction(widget.callback))widget.sigmaWidName?widget.callback(widget.sigmaWidName):widget.callback();else{var params={widget:name};if(name==ZPDashboard.Widget.List.RECRUIT_REFRL){var additionalInfo=$("div[name="+ZPDashboard.Widget.List.RECRUIT_REFRL+"]").data("widget").additionalInfo;void 0!=additionalInfo&&(params.additionalInfo=JSON.stringify(additionalInfo))}ZPeople.Request.send(ZPDashboard.Widget.URL+"getWidget",params,ZPDashboard.Widget.construct,widget)}},construct:function(data,param){ZPDashboard.Widget.show(param.widget,ZPDashboard.Widget.create(data[param.widget],param.widget))},show:function(name,html){Layout.Page.container.find("[name="+name+"]").find("#zp_page_loading").remove();var classname=".dash-body",listClass=Layout.Page.container.find(".dash-head").find("#listView").attr("class");name===ZPDashboard.Widget.List.TEAM&&(classname=void 0!==listClass?-1!==listClass.indexOf("sel")?".dash-body.listView":".dash-body.gridView":".dash-body.listView");let container=Layout.Page.container.find("[name="+name+"]").find(classname);container.html(html),"ANNOUNCEMENTS"===name?Layout.Page.container.find("[name="+name+"]").find(".dash-body").find("li").on("click",function(){window.location.href="#"+Announcement.URLCONTEXT+"announcements/list/view-annId:"+$(this).attr("id")}):"QUICKLINKS"==name&&isadmin&&container.sortable({handle:'[fld="drag"]',placeholder:"zpl_qklnk",update:function(e,ui){let itemId=$(ui.item).attr("id"),oldSeq=parseInt($(ui.item).attr("seq")),newSeq=$(ui.item).index()+1;ZPDashboard.Widget.updateQuickLinkSequance(container,itemId,oldSeq,newSeq)}})},registerFireScroll:function(layout){layout.find(".dash-body").on("scroll",function(){var widHei=$(this).height();this.scrollHeight<$(this).scrollTop()+widHei+25&&(void 0===layout.attr("triggered")||"false"===layout.attr("triggered"))&&(layout.attr("triggered","true"),layout.data("conf").firecback($(layout[0]).attr("name")))})},getMore:function(name,start){var params={widget:name,start:parseInt(Layout.Page.container.find("[name="+name+"]").attr("count"))+1};if(name===ZPDashboard.Widget.List.TEAM){var gridClass=Layout.Page.container.find(".dash-head").find("#gridView").attr("class"),totalCount=Layout.Page.container.find("[name="+params.widget+"]").find("#zpdash_widgetcnt").text();if(Layout.Page.container.find("[name="+params.widget+"]").attr("count")==totalCount)return;-1!==gridClass.indexOf("sel")&&(params.isGridView=!0)}ZPeople.Request.send(ZPDashboard.Widget.URL+"getWidget",params,ZPDashboard.Widget.consturctMore)},consturctMore:function(result,params){if(params.widget!==ZPDashboard.Widget.List.DANN){if(void 0!==result[params.widget]&&result[params.widget].list.length>0){var widName=params.widget,widget=Layout.Page.container.find("[name="+widName+"]").data("widget"),widObj=Layout.Page.container.find("[name="+params.widget+"]");if(widName===ZPDashboard.Widget.List.BDAY||widName===ZPDashboard.Widget.List.NJOIN||widName===ZPDashboard.Widget.List.WORK_ANNIVERSARY||widName===ZPDashboard.Widget.List.WEDDING_ANNIVERSARY)ZPDashboard.Widget.getCollabPerson(result[params.widget],widName,widget,!0);else if(params.widget!==ZPDashboard.Widget.List.NJOIN){if(params.widget===ZPDashboard.Widget.List.TEAM)-1===Layout.Page.container.find(".dash-head").find("#gridView").attr("class").indexOf("sel")?widObj.find("ul.sst-edt.listView").append(ZPDashboard.Widget.getListHtml(result[params.widget].list,widObj,params.widget)):widObj.find("ul.gridView").append(ZPDashboard.Widget.getGridViewHtml(result[params.widget].list,widObj,params.widget));else widObj.find("ul.sst-edt").append(ZPDashboard.Widget.getListHtml(result[params.widget].list,widObj,params.widget))}else widObj.find("#"+params.widget).append(ZPDashboard.Widget.getListHtml(result[params.widget].list,widObj,params.widget));widObj.attr("triggered","false")}}else if(params.widget===ZPDashboard.Widget.List.DANN){if(void 0!==result[params.widget]&&result[params.widget].announcementList.length>0)(widObj=Layout.Page.container.find("[name="+params.widget+"]")).find(".dash-body").append(ZPDashboard.Widget.constructAnnouncementList(widObj,params.widget,result[params.widget].announcementList,!0)),"ANNOUNCEMENTS"===params.widget&&Layout.Page.container.find("[name="+params.widget+"]").find(".dash-body").find("li").on("click",function(){window.location.href="#"+Announcement.URLCONTEXT+"announcements/list/view-annId:"+$(this).attr("id")}),widObj.attr("triggered","false")}},showCustomize:function(){var c=Layout.Page.container;if(0==c.find("#zp_d_cw").length){var wids=ZPeople.Module.getData();if(void 0!==wids.widgets){var widHtml='<div class="wid-cust actsw" id="zp_d_cw"><h5 tabindex="0">'+ZPI18N.getString("zp.customizewidgets")+'<button aria-label="Close" class="close closeicon" type="button"><div class="IC-cls-1px red CP"></div></button></h5> <div class="zpcustwidtab"> <div id="widgetTabs"> </div> </div> </div>';c.find("#custom_widget").append(widHtml),c.find("#zp_d_cw").find(".closeicon").on("click",ZPDashboard.Widget.closeWidCustModal),c.find("#zp_d_cw").parent("li").addClass("sel"),ZPDashboard.isOrgBased()||(c.find("#zp_d_cw #widgetTabs").prepend(' <a id="myTab" class="sel">'+ZPI18N.getString("zp.myWidgets")+" </a>"),c.find("#zp_d_cw").append(ZPDashboard.Widget.setWidgets(wids.widgets,"myWidgets")),c.find("#zp_d_cw #myWidgets").find(".cmn-toggle-small").on("click",function(){var isHidden=!0;$(this).is(":checked")&&(isHidden=!1);var params={widgetId:$(this).attr("widId"),isHidden:isHidden};ZPeople.Request.send(ZPDashboard.Widget.URL+"enableDisableWidget",params,ZPDashboard.Widget.enableDisableWidgetResp)}),c.find("#zp_d_cw #myWidgets ul").sortable({placeholder:"plchldr",update:function(e,w){var lkey,element=w.item[0],widsObj=c.find("#zp_d_cw #myWidgets ul").children(),param={},itemId=$(element).attr("widId");widsObj.each(function(ind,obj){var name=$(this).attr("cus_name"),widId=$(this).attr("widId");itemId==widId&&(param.widId=itemId,param.seq=ind+1),0===ind?c.find("#zp_d_wrow").prepend(c.find("#zp_d_wrow").find("[name="+name+"]")):c.find("#zp_d_wrow").find("[name="+lkey+"]").after(c.find("#zp_d_wrow").find("[name="+name+"]")),lkey=name}),ZPDashboard.Widget.Actions.updateWidgetSequence(param,!0);var name=$(element).attr("cus_name");ZPDashboard.Widget.loadData(name)}}).disableSelection()),isTabCustomAdmin&&(c.find("#zp_d_cw #widgetTabs").append('<a id="adminTab">'+ZPI18N.getString("zp.orgWidgets")+" </a>"),ZPDashboard.isOrgBased()?(c.find("#zp_d_cw #widgetTabs").prepend(' <a id="myTab">'+ZPI18N.getString("zp.myWidgets")+" </a>"),c.find("#zp_d_cw #widgetTabs #adminTab").addClass("sel"),c.find("#zp_d_cw #widgetTabs #myTab").addClass("disabled"),ZPDashboard.Widget.customizeAdminWidgets()):(c.find("#zp_d_cw #widgetTabs #myTab").on("click",ZPDashboard.Widget.showMyWidgets),c.find("#zp_d_cw #widgetTabs #adminTab").on("click",ZPDashboard.Widget.showAdminWidgets)))}}},setWidgets:function(widgets,widgetTabId){var widHtml='<div id="'+widgetTabId+'" class="zpcustwid-wrap"> <ul class="ui-sortable">';return $.each(widgets,function(){ZPUtil.Validation.isEmpty(this.name)||"Cases"==this.name||(widHtml+='<li cus_name="'+this.key+'" widId="'+this.widId+'"><span class="wid-name">'+ZSEC.Encoder.encodeForHTML(this.name)+"</span>","adminWidgets"==widgetTabId&&(widHtml+='<i class="CR-edit CP gry"></i>'),widHtml+='<label class="btnactive "><input widId="'+this.widId+'" class="cmn-toggle-small cmn-toggle-round-small" type="checkbox" '+(this.isHidden?"":"checked")+'><span class="M0"></span></label></li>')}),widHtml+="</ul> </div>"},showAdminWidgets:function(){var pageId=Layout.Page.container;pageId.find("#zp_d_cw").length>0&&(pageId.find("#zp_d_cw").find("#myWidgets").hide(),pageId.find("#zp_d_cw #myTab").removeClass("sel"),pageId.find("#zp_d_cw #adminTab").addClass("sel"),pageId.find("#zp_d_cw #adminWidgets").length>0?pageId.find("#zp_d_cw").find("#adminWidgets").show():ZPDashboard.Widget.customizeAdminWidgets())},showMyWidgets:function(){var pageId=Layout.Page.container;pageId.find("#zp_d_cw").length>0&&(pageId.find("#zp_d_cw").find("#adminWidgets").hide(),pageId.find("#zp_d_cw #adminTab").removeClass("sel"),pageId.find("#zp_d_cw #myTab").addClass("sel"),pageId.find("#zp_d_cw").find("#myWidgets").show())},customizeAdminWidgets:function(){if(isTabCustomAdmin){var pageId=Layout.Page.container;if(pageId.find("#zp_d_cw").length>0){pageId.find("#zp_d_cw").append(ZPeople.LOADING_HTML);ZPeople.Request.send(ZPDashboard.Widget.URL+"getAllWidgets",{},function(resultValues){if(void 0!=resultValues){pageId.find("#zp_d_cw #zp_page_loading").remove(),pageId.find("#zp_d_cw").append(ZPDashboard.Widget.setWidgets(resultValues.widgets,"adminWidgets"));var orgWidgets='<div class="zpcustwid"><div><span>'+ZPI18N.getString("zp.orgbaseddashboard")+' </span><label class="btnactive"><input id="orgWideWidget" class="cmn-toggle-small cmn-toggle-round-small" type="checkbox"'+(resultValues.isOrgBased?"checked":"")+'><span class="M0"></span></label></div></div>';pageId.find("#zp_d_cw #adminWidgets").prepend(orgWidgets),pageId.find("#zp_d_cw #adminWidgets #orgWideWidget").on("change",function(){ZPDashboard.AdminCustomization.confirmOrgTypeChange($(this))}),pageId.find("#zp_d_cw #adminWidgets ul li input").on("click",function(){ZPDashboard.Widget.toggleAdminWidget($(this))}),pageId.find("#zp_d_cw #adminWidgets ul li i").on("click",function(){ZPDashboard.Widget.editAdminWidget($(this))}),pageId.find("#zp_d_cw #adminWidgets ul").sortable({update:function(e,w){var element=w.item[0],widsObj=pageId.find("#zp_d_cw #adminWidgets ul").children(),param={},itemId=$(element).attr("widId");widsObj.each(function(ind,obj){var widId=$(this).attr("widId");itemId==widId&&(param.widgetId=itemId,param.seq=ind+1)}),ZPDashboard.Widget.reorderWidgets(param)}}).disableSelection()}})}}},reorderWidgets:function(params){ZPeople.Request.send(ZPDashboard.Widget.URL+"updateWidgetSequenceForOrg",params,function(resultValues){void 0!==resultValues&&1==resultValues.success?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.widgetReordered")),ZPDashboard.isOrgBased()&&ZPDashboard.AdminCustomization.setModuleDataRefresh(!0,"adminWidgets")):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.widgetUpdateFail"))})},toggleAdminWidget:function(thisValue){var isEnabled=$(thisValue).is(":checked"),params={widgetId:$(thisValue).attr("widid"),isHidden:!isEnabled};ZPeople.Request.send(ZPDashboard.Widget.URL+"enableDisableWidgetForOrg",params,function(resultValues){if(void 0!==resultValues&&1==resultValues.success){var msgVal=isEnabled?"zp.widgetEnabled":"zp.widgetDisabled";ZPeople.Message.showSuccessMsg(ZPI18N.getString(msgVal)),ZPDashboard.isOrgBased()&&ZPDashboard.AdminCustomization.setModuleDataRefresh(!0,"adminWidgets")}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.widgetUpdateFail"))})},editAdminWidget:function(thisValue){var thisParent=thisValue.parent(),widgetName=$(thisParent).find("span.wid-name");$(thisParent).prepend('<input class="form-control W180 ML10 FL M5" value="'+ZSEC.Encoder.encodeForHTML($(widgetName).text())+'" id="updateWidget">'),$(widgetName).addClass("DNI"),$(thisParent).find("label").addClass("DNI"),$(thisParent).find("i").hide(),$(thisParent).append('<span class="wid-act" id="updateWidgetAction"> <span class="IC-tick grn MR10 CP" id="zptab_update"> </span> <span class="IC-cls red CP" id="zptab_close"> </span> </span>'),$(thisParent).find("#zptab_update").on("click",function(){ZPDashboard.Widget.updateWidgetName($(this))}),$(thisParent).find("#zptab_close").on("click",function(){ZPDashboard.Widget.closeUpdate($(this))})},updateWidgetName:function(thisValue){var thisParent=thisValue.parent().parent(),params={widgetId:$(thisParent).attr("widid"),widname:$(thisParent).find("input#updateWidget").val()};ZPeople.Request.send(ZPDashboard.Widget.URL+"renameWidgetForOrg",params,function(resultValues,params,thisParent){void 0!==resultValues&&1==resultValues.success?($(thisParent).find("span.wid-name").html(resultValues.name),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.widgetRenamed")),ZPDashboard.isOrgBased()&&ZPDashboard.AdminCustomization.setModuleDataRefresh(!0,"adminWidgets")):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.widgetUpdateFail"))},$(thisParent)),ZPDashboard.Widget.closeUpdate($(thisValue))},closeUpdate:function(thisValue){var thisParent=thisValue.parent().parent();$(thisParent).find("input#updateWidget").remove(),$(thisParent).find("span.wid-name").removeClass("DNI"),$(thisParent).find("label").removeClass("DNI"),$(thisParent).find("i").show(),$(thisParent).find("span#updateWidgetAction").remove()},closeWidCustModal:function(){var c=Layout.Page.container;c.find("#zp_d_cw").parent("li").addClass("sel"),c.find("#zp_d_cw").remove()},enableDisableWidgetResp:function(data,params){if(void 0!==data&&data.success){var widget,widArr=ZPeople.Module.getData(),index=0;if($.each(widArr.widgets,function(ind,wid){if(wid.widId===params.widgetId)return widArr.widgets[ind].isHidden=params.isHidden,widget=widArr.widgets[ind],!1;wid.isHidden||index++}),0===Layout.Page.container.find("[name="+widget.key+"]").length)void 0!==widget&&ZPDashboard.Widget.initiateWidget(widget,index);else Layout.Page.container.find("#zp_d_cw #myWidgets").find("[cus_name="+widget.key+"]").find(".cmn-toggle-small").is(":checked")?ZPDashboard.Widget.initiateWidget(widget,index):(Layout.Page.container.find("#zp_d_wrow").find("[name="+widget.key+"]").remove(),0==Layout.Page.container.find("#zp_d_wrow").children().length&&0==Layout.Page.container.find("#zpdash_nodata").length?Layout.Page.container.find("#zp_d_cmain").prepend(ZPDashboard.components.nodataHtml(void 0,void 0,void 0,"zpdash_nodata")):Layout.Page.container.find("#zp_d_wrow").children().length>0&&Layout.Page.container.find("#zp_d_cmain").find("#zpdash_nodata").remove())}}},ZPDashboard.Widget.Actions={loadApprovalRecord:function(formId,recordId,tableName){var mode;"P_TimesheetList"===tableName?mode="Timesheet":"P_EmployeeLeave"===tableName?mode="Leave":"P_AttendanceReg"===tableName?mode="Attendance":"P_PermissionDetails"===tableName?mode="AttendancePermissions":"P_ShiftMappingForm"===tableName?mode="Shift":"P_AttendanceOD"===tableName?mode="AttendanceOD":"P_Compensatory"===tableName?mode="Compensatory":"P_LeaveGrant"===tableName?mode="LeaveGrant":"P_GoalSheet"==tableName?mode="Goal":"P_ReviewApprovalSheet"==tableName?mode="Review":"P_MultiRater_Approval"===tableName?mode="Rater":"P_Budget_Splitup"==tableName?mode="Reviewsheet":tableName===Compensation.CONSTANTS.SALARY_REVISION_TABLE_NAME?mode=Compensation.CONSTANTS.SALARY_REVISION_PC_NAME:"dc_EmployeePhotoChanges"===tableName?mode="ProfilePic":0===tableName.indexOf("dc_")&&(mode="Transfer"),ApprovalList.viewApprovalPopup(formId,recordId,!1,mode)},updateWidgetSequence:function(movedObj,isFromList){var widArr=ZPeople.Module.getData().widgets,isAllowed=!1;if($.each(widArr,function(ind,wid){return isFromList?(isAllowed=!0,!1):(wid.widId!==movedObj.widId&&wid.isHidden&&ind+1<movedObj.seq&&(movedObj.seq=movedObj.seq+1),ind+1==movedObj.seq?(isAllowed=!0,!1):void 0)}),isAllowed){var params={widgetId:movedObj.widId,seq:movedObj.seq};ZPeople.Request.send(ZPDashboard.Widget.URL+"updateSequence",params,ZPDashboard.Widget.Actions.refreshModuleWidgetData,movedObj),ZPDashboard.Widget.closeWidCustModal()}},refreshModuleWidgetData:function(data,params,widObj){1==data.success&&void 0!=data.widgets&&(ZPeople.Module.getData().widgets=data.widgets)}},ZPDashboard.User={get:function(){var id=erecno;return id=void 0===id?erecno:id,ZPeople.getUserDetailsById(id)}},ZPDashboard.AdminWidgets={url:"/adminWidgets.zp",months:["zp.january","zp.february","zp.march","zp.april","zp.may","zp.june","zp.july","zp.august","zp.september","zp.october","zp.november","zp.december"],months_Short:["zp.jan","zp.feb","zp.mar","zp.apr","zp.may","zp.jun","zp.jul","zp.aug","zp.sep","zp.oct","zp.nov","zp.dec"],textContents:{three_Months:"zp.widget.three_Months",six_Months:"zp.widget.six_Months",Quaters:"zp.quarterly"},hiring_Attrition:{},getEmployeeGrowth:function(){ZPeople.Request.send(ZPDashboard.AdminWidgets.url,{MODE:"GET",widgetname:"EMPLOYEE_GROWTH_PER_YEAR"},ZPDashboard.AdminWidgets.construct_line_chart,"EMPLOYEE_GROWTH_PER_YEAR","Employee growth per year")},getHiringAttrition:function(key,subMode){void 0==key&&(key="three_Months"),void 0==subMode&&(subMode="hiring");var params={MODE:"GET",widgetname:"HIRING_ATTRITION",key:key,subMode:subMode};ZPeople.Request.send(ZPDashboard.AdminWidgets.url,params,ZPDashboard.AdminWidgets.constructHiringAndAttrition)},getYearlyHiringAttrition:function(){ZPeople.Request.send(ZPDashboard.AdminWidgets.url,{MODE:"GET",widgetname:"YEARLY_HIRING_ATTRITION"},ZPDashboard.AdminWidgets.construct_hire_att_line_chart,"YEARLY_HIRING_ATTRITION","")},constructHiringAndAttrition:function(data,params,keyval){var ele=Layout.Page.container.find('div[name="HIRING_ATTRITION"]');if(data.isSuccess){for(var key=params.key,resultArr=(params.mode,[]),data1=data.data,i=0;i<data1.length;i++){var result={},data2=data1[i];key=data2.name;if("Quaters"==params.key){var key1=key.split("-");key=ZPI18N.getString(ZPDashboard.AdminWidgets.months_Short[key1[0]])+"-"+ZPI18N.getString(ZPDashboard.AdminWidgets.months_Short[key1[1]])}else key=ZPI18N.getString(ZPDashboard.AdminWidgets.months[key]);result.key=key,result.value=data2.value,resultArr.push(result)}var res={};res.data=resultArr,res.Success=!0,$(ele).find(".dash-head").find(".dash-title").siblings().remove(),$(ele).find(".dash-head").find(".dash-title").after('<div class="widswch" id="hiring_attr_icon" style="right:35%;"><div class="" name="hiring" onclick="ZPDashboard.AdminWidgets.changeHiringAttr(this)"><i class="IC-walkin S20"></i></div><div class="" name="attr" onclick="ZPDashboard.AdminWidgets.changeHiringAttr(this)"><i class="IC-walkout S20"></i></div></div><div class="widsel2 dropdown"><div data-toggle="dropdown" class="CP"><span id="hiring_attr_value" key="'+params.key+'">'+ZPI18N.getString(ZPDashboard.AdminWidgets.textContents[params.key])+'</span><i class="IC-so-down-arr"></i></div><ul value="'+params.key+'" class="dropdown-menu ZPCmn-Arrow top gray TBDD rt"><li value="three_Months" onclick="ZPDashboard.AdminWidgets.changehiring_attr_dur(this)"><a>'+ZPI18N.getString(ZPDashboard.AdminWidgets.textContents.three_Months)+'</a></li><li value="six_Months" onclick="ZPDashboard.AdminWidgets.changehiring_attr_dur(this)"><a>'+ZPI18N.getString(ZPDashboard.AdminWidgets.textContents.six_Months)+'</a></li><li value="Quaters" onclick="ZPDashboard.AdminWidgets.changehiring_attr_dur(this)"><a>'+ZPI18N.getString(ZPDashboard.AdminWidgets.textContents.Quaters)+"</a></li></ul></div>"),$(ele).find(".dash-body").addClass("nomo Cht"),$(ele).find(".dash-body").html('<div id="hiringattrition" style="width: 90%; height: 250px; margin:20px 20px 0 20px;" data-highcharts-chart="4"></div>'),$(ele).find("#hiring_attr_icon").find('div[name="'+params.subMode+'"]').addClass("sel"),ZPDashboard.AdminWidgets.construct_bar_chart(res,params,"hiringattrition","")}else $(ele).html(ZPDashboard.Widget.getNodata(ZPI18N.getString("zp.norec")))},changeHiringAttr:function(ele){var name=Layout.Page.container.find(ele).attr("name"),key=Layout.Page.container.find("#hiring_attr_value").attr("key");ZPDashboard.AdminWidgets.getHiringAttrition(key,name)},changehiring_attr_dur:function(ele){var name=Layout.Page.container.find("#hiring_attr_icon").find('div[class="sel"]').attr("name"),value=Layout.Page.container.find(ele).attr("value");ZPDashboard.AdminWidgets.getHiringAttrition(value,name)},construct_bar_chart:function(data,params,id,title){var deptdata=[],countdata=[],count1=0,ele=Layout.Page.container.find("#"+id);if(data.Success){for(var res=data.data,i=0;i<res.length;i++){var resultobj=res[i],deptname=resultobj.key,count=resultobj.value;deptdata.push(deptname),countdata.push(count),count1+=1}count1<=10&&"deptCount"==id?Layout.Page.container.find('div[name="DEPARTMENT_USER_COUNT"]').attr("class","col-sm-6"):count1>25&&"deptCount"==id&&(Layout.Page.container.find('div[name="DEPARTMENT_USER_COUNT"]').attr("class","col-sm-12"),Layout.Page.container.find('div[name="DEPARTMENT_USER_COUNT"]').find("#deptCount").attr("style","overflow-x:auto;overflow-y:auto;height:260px;width:inherit")),$(ele).highcharts({title:{text:title},exporting:{enabled:!1},xAxis:{categories:deptdata},yAxis:{title:{text:ZPI18N.getString("zp.userscount")}},credits:{enabled:!1},series:[{type:"column",colorByPoint:!0,data:countdata,showInLegend:!1,name:ZPI18N.getString("zp.user(s)")}]})}else $(ele).html(ZPDashboard.Widget.getNodata(ZPI18N.getString("zp.norec")))},construct_line_chart:function(data,params,id,title,exportenable){var ele=Layout.Page.container.find("#"+id);if(data.isSuccess){for(var dataarray=data.data,xaxis=[],yaxis=[],i=0;i<dataarray.length;i++){var dataObject=dataarray[i];xaxis.push(dataObject.name),yaxis.push(dataObject.value)}$(ele).highcharts({chart:{type:"area",backgroundColor:"transparent"},title:{text:title},exporting:{enabled:!1},legend:{enabled:!1},colors:["#8eddce","#bcc9d4"],xAxis:{categories:xaxis},yAxis:{title:{text:ZPI18N.getString("zp.userscount")},plotLines:[{value:0,width:1}]},credits:{enabled:!1},series:[{name:ZPI18N.getString("zp.user(s)"),data:yaxis}]})}else $(ele).html(ZPDashboard.Widget.getNodata(ZPI18N.getString("zp.norec")));exportenable||(Layout.Page.container.find(".highcharts-credits").remove(),Layout.Page.container.find(".highcharts-button").remove())},construct_hire_att_line_chart:function(data,params,id,title){var ele=Layout.Page.container.find("#"+id);if(data.isSuccess){for(var Joiningdata=data.joiningdata,Attrdata=data.attritiondata,xaxis=[],joining_yaxis=[],attr_yaxis=[],i=0;i<Joiningdata.length;i++){var dataObject=Joiningdata[i];xaxis.push(dataObject.name),joining_yaxis.push(dataObject.value)}for(i=0;i<Attrdata.length;i++){dataObject=Attrdata[i];attr_yaxis.push(dataObject.value)}$(ele).highcharts({chart:{type:"line"},title:{text:title},xAxis:{categories:xaxis},exporting:{enabled:!1},yAxis:{title:{text:ZPI18N.getString("zp.widget.percentageofhiring_attrition")}},plotOptions:{line:{dataLabels:{enabled:!0},enableMouseTracking:!1}},series:[{name:ZPI18N.getString("zp.Hirings"),data:joining_yaxis},{name:ZPI18N.getString("zp.Attrition"),data:attr_yaxis}]})}else $(ele).html(ZPDashboard.Widget.getNodata(ZPI18N.getString("zp.norec")));Layout.Page.container.find(".highcharts-credits").remove(),Layout.Page.container.find(".highcharts-button").remove()}},ZPDashboard.Profile={changeZuidUrl:function(id){var newhash;if(void 0!==id){var usrDtl=ZPeople.getUserDetailsById(id,!1,!0);newhash=void 0!==usrDtl&&void 0!==usrDtl.usererec?"#home/dashboard/profile-userId:"+usrDtl.usererec:"#home/dashboard/profile"}return newhash},setUpdateRecordsinFields:function(userDtl,aboutUser){var currPageObj=$("#home-dashboard");ZPForm.CURRFORM_PARAM.recordId!==erecno&&(currPageObj=$("#home-dashboard-userId-"+ZPForm.CURRFORM_PARAM.recordId)),currPageObj.find("[ref_labelName=ref_UserName]").html("<a>"+userDtl.name+"</a>"),currPageObj.find("[ref_labelName=ref_UserDesignation]").html(userDtl.designation).removeClass("DN"),currPageObj.find("[ref_labelName=ref_UserDepartment]").html(ZPUtil.Validation.isEmpty(userDtl.deptName)?"":'<a href="#organization/directory/department-deptId:'+userDtl.deptId+'">'+userDtl.deptName+"</a>"),void 0!==aboutUser&&(currPageObj.find("[ref_labelName = ref_AboutMe]").html(aboutUser).removeClass("DN"),Layout.Page.parentContainer.find("#zp_dash_left_panel").find('[data-popover="true"]').each(function(){$(this).popover("destroy"),$(this).data("content",aboutUser)}),Layout.Page.parentContainer.find("#zp_dash_left_panel").popover({selector:"[data-popover].popHover",trigger:"hover",placement:"bottom",delay:{show:50,hide:50}})),currPageObj.find("[ref_labelName=ref_UserLocation]").html(userDtl.location).parent().removeClass("DN"),currPageObj.find("[ref_labelName=ref_UserEmpId]").html(userDtl.empid),currPageObj.find("[ref_labelName=ref_UserEmailId]").html("<a href='mailto:"+userDtl.email+"'>"+userDtl.email+"</a>"),currPageObj.find("[ref_labelName=ref_UserWorkLocation]").html(userDtl.workLoc),currPageObj.find("[ref_labelName=ref_UserExtension]").html(userDtl.extension),currPageObj.find("[ref_labelName=ref_UserMobile]").html(userDtl.mobile)}};var HRCASEWIDGETS={MyRequest:"REQ",MyCases:"MCASE",MyReqCount:"",MyCasesCount:"",getMyCasesWidget:function(){var pageId=$("#"+Layout.Page.pageId);if($.isEmptyObject(ZPTabs.getSelectedTab("hrcase")))pageId.find('[name="HR_CASE_REPORT"]').addClass("DN");else if(-1!=JSON.stringify(ZPTabs.getSelectedTab("hrcase")).indexOf("hrcase/list")){var tabHtml='<ul class="dash-tabs" role="tablist"><li class="" href="#MReq" id="myreq" data-toggle="tab">'+ZPI18N.getString("zp.myrequests")+'</li><li class="active" href="#MCas" id="mycase" data-toggle="tab">'+ZPI18N.getString("zp.mycases")+"</li></ul>";tabHtml+='<div class="tab-content"><ul id="MReq" class="sst-edt zp_HRcase"  scroll="enable"></ul><ul id="MCas" class="sst-edt zp_HRcase active" scroll="enable"></ul>',pageId.find("#HR_CASE_REPORT").html(tabHtml),pageId.find("#HR_CASE_REPORT").find("li#myreq,li#mycase").on("click",function(){var type="myreq"==$(this).attr("id")?HRCASEWIDGETS.MyRequest:HRCASEWIDGETS.MyCases;setTimeout(function(){HRCASEWIDGETS.fetchCasesList("",1,type)},300)}),HRCASEWIDGETS.fetchCasesList("",1,HRCASEWIDGETS.MyCases)}else{tabHtml='<ul class="sst-edt zp_HRcase" id="MReq" scroll="enable"><ul>';pageId.find("#HR_CASE_REPORT").html(tabHtml),HRCASEWIDGETS.fetchCasesList("",1,HRCASEWIDGETS.MyRequest)}},fetchCasesList:function(mode,index,type){var pageId=$("#"+Layout.Page.pageId),myCasesDiv=pageId.find("#HR_CASE_REPORT").find("#MCas"),myReqDiv=pageId.find("#HR_CASE_REPORT").find("#MReq");if(myCasesDiv.length<=0||myReqDiv.hasClass("active")&&type!=HRCASEWIDGETS.MyCases){var caselength=myReqDiv.find("li[caseid]").length,jsonObj={status:"1",index:index=void 0!=index?index:caselength+1},params={method:"myHrCasesRequest",myCaseRequestJson:JSON.stringify(jsonObj),conreqcsr:csrfToken};1==index&&myReqDiv.html(ZPeople.LOADING_HTML),ZPeople.Request.send("/myHrCasesRequest.zp",params,function(result){HRCASEWIDGETS.constructCaserow(result,HRCASEWIDGETS.MyRequest,index)}),HRCASEWIDGETS.MyReqCount=""==HRCASEWIDGETS.MyReqCount?0:HRCASEWIDGETS.MyReqCount,pageId.find("#zp_hrcase_count").text(HRCASEWIDGETS.MyReqCount),myReqDiv.removeClass("zp_dyn"),myCasesDiv.addClass("zp_dyn")}else{caselength=myCasesDiv.find("li[caseid]").length,jsonObj={requestorErecno:"",query:"",status:"1",index:index=void 0!=index?index:caselength+1},params={method:"myHrCases",myCasesJson:JSON.stringify(jsonObj),conreqcsr:csrfToken};1==index&&myCasesDiv.html(ZPeople.LOADING_HTML),ZPeople.Request.send("/myHrCases.zp",params,function(result){HRCASEWIDGETS.constructCaserow(result,HRCASEWIDGETS.MyCases,index)}),HRCASEWIDGETS.MyCasesCount=""==HRCASEWIDGETS.MyCasesCount?0:HRCASEWIDGETS.MyCasesCount,pageId.find("#zp_hrcase_count").text(HRCASEWIDGETS.MyCasesCount),myCasesDiv.removeClass("zp_dyn"),myReqDiv.addClass("zp_dyn")}},constructCaserow:function(result,mode,index){var pageId=$("#"+Layout.Page.pageId),bodyUl=(JSON.stringify(ZPTabs.getSelectedTab("hrcase")),mode==HRCASEWIDGETS.MyRequest?pageId.find("#MReq"):pageId.find("#MCas"));mode==HRCASEWIDGETS.MyRequest?pageId.find("#MCas"):pageId.find("#MReq");if($.each(result.statusCount,function(i,v){if(v.systemValue==HRCase.OPEN_SID)return pageId.find("#zp_hrcase_count").text(v.count),void(mode==HRCASEWIDGETS.MyRequest?HRCASEWIDGETS.MyReqCount=v.count:HRCASEWIDGETS.MyCasesCount=v.count)}),mode==HRCASEWIDGETS.MyRequest&&""==HRCASEWIDGETS.MyReqCount?HRCASEWIDGETS.MyReqCount=0:mode==HRCASEWIDGETS.MyCases&&""==HRCASEWIDGETS.MyCasesCount&&(HRCASEWIDGETS.MyCasesCount=0),0!=result.hrcaseList.length){var caserow="";$.each(result.hrcaseList,function(key,value){var tooltip=value.requestor.name,sourceUrl=value.requestor.employeePhoto,altText="",imgDiv=CommonTemplates.returnImgDiv(sourceUrl,altText,"",tooltip);mode==HRCASEWIDGETS.MyRequest&&(value.hasOwnProperty("agent")?(tooltip=""!=(sourceUrl=value.agent.hasOwnProperty("employeePhoto")?value.agent.employeePhoto:"")?value.agent.name:value.agent.details,altText=ZPeople.escapeHtml(CommonTemplates.getAltText(ZPeople.decodeTxt(tooltip))),imgDiv=CommonTemplates.returnImgDiv(sourceUrl,altText,"",tooltip)):(sourceUrl=ZPeople.getResourceURL(imageUrl+"user.png"),tooltip="",altText="",imgDiv="<div>"+CommonTemplates.returnImgDiv(sourceUrl,altText,"",tooltip)+'<i class="IC-pending"></i></div>')),caserow+='<li caseid="'+value.recordId+'"><a>'+imgDiv+'<div class="ZPUsrDt"><span class="DB MB5 ZPElips blk"><span class="MR5">'+value.caseId+"</span>"+value.subject+'</span><span class="sse-mn MR5">'+value.requestedTime+"</span></div><i></i></a></li>"}),1==index&&bodyUl.empty(),bodyUl.append(caserow),bodyUl.find("[caseid]").off("click").on("click",function(){$.isEmptyObject(HRCase.PRIORITY)&&HRCases.getPriorityList(),HRCase.DetailedView.newviewCaseDetails($(this).attr("caseid"))})}else 1==index&&bodyUl.html('<li class="NoFiles">'+CommonTemplates.noDataSVG("",!0,ZPI18N.getString("zp.norec"))+"</li>");result.isNextAvailable&&ZPeople.FireScroll.reset()}};ZPDashboard.AdvAnalytics={getZRDashboardsSubTabObj:function(){void 0===ZPDashboard.AdvAnalytics.custDashboardEnabled&&(ZPTabs.getSubTabs("home",!0).forEach(function(subtab){"ZohoReportsDashboards"===subtab.tabName&&(ZPDashboard.AdvAnalytics.custDashboardEnabled=!0,ZPDashboard.AdvAnalytics.isCurrUserAdvAnAdmin=subtab.isCurrUserAdvAnAdmin,ZPDashboard.AdvAnalytics.selDashboardsArray=subtab.formArr)}),void 0===ZPDashboard.AdvAnalytics.custDashboardEnabled&&(ZPDashboard.AdvAnalytics.custDashboardEnabled=!1))},showCustDashboardSelPage:function(event){if(event.stopPropagation(),ZPDashboard.AdvAnalytics.getZRDashboardsSubTabObj(),ZPDashboard.AdvAnalytics.custDashboardEnabled&&ZPDashboard.AdvAnalytics.isCurrUserAdvAnAdmin){if(0==$("#zp_custdashboardselmodal").length){var modal=ZPeople.BSModal.get({id:"zp_custdashboardselmodal",type:1,headerHtml:'<h6 class="addPopTitle">'+ZPI18N.getString("zp.advan.zrdashboards")+'</h6><a data-dismiss="modal" class="close" type="button"><i class="IC-cls-1px red S21 CP"></i></a>',body:ZPeople.LOADING_HTML,closeonEsc:!1,overwriteModalClass:!0,modalClass:"modal popRgtModel popLtModel popLEModel",removeModalClass:"fade ZPmdl",deleteOnHide:!0,isWrapperAppend:!0,buttonValue:ZPI18N.getString("zp.save"),successCallback:ZPDashboard.AdvAnalytics.saveSelectedDashboards,hiddenCallback:function(){$("body").removeClass("modal-openL modal-openLE")}});"0"===ZPeople.USER_CUST_SETTINGS.USER_TAB_MINIMIZE?$("body").addClass("modal-openLE"):$("body").addClass("modal-openL"),$("#zp_custdashboardselmodal .modal-footer").addClass("text-left").find("#zp_modal_blubtn").addClass("disabled").siblings().remove(),$("#zp_custdashboardselmodal .modal-footer").append('<a id="repDbLink" href="" target="_blank" rel="noreferrer" class="btn btn-link FR disabled">'+ZPI18N.getString("zp.advan.accesszr")+"</a>"),ZPeople.BSModal.show(modal)}else $("#zp_custdashboardselmodal #zp_modal_body").html(ZPeople.LOADING_HTML);$("body").on("click",function(event){0!==$("#zp_custdashboardselmodal").length&&"ZRDshbrdsTab"!==$(event.target).attr("id")&&"zp_custdashboardselmodal"!==$(event.target).attr("id")&&0===$(event.target).parents("#ZRDshbrdsTab").length&&0===$(event.target).parents("#zp_custdashboardselmodal").length&&ZPeople.BSModal.hide("zp_custdashboardselmodal")}),ZPDashboard.AdvAnalytics.isCurrUserAdvAnAdmin&&!ZPeople.ADV_AN_DASHBOARD_REQ_SUCCESS?ZPeople.Request.send("/integrations/advAnalytics/getAllDashboardsList",{},function(resultData){ZPeople.ADV_AN_DASHBOARD_REQ_SUCCESS=!0,void 0!==resultData&&1===resultData[0]&&void 0!==resultData[1]&&null!==resultData[1]&&resultData[1].length>0?(ZPeople.allAdvAnDashboardsArray=resultData[1],ZPDashboard.AdvAnalytics.populateCustDashboardSelModalBody(resultData[1],ZPDashboard.AdvAnalytics.selDashboardsArray)):ZPDashboard.AdvAnalytics.showNoDashboardsFound()},void 0,function(){ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.reports.defaulterrormessage"))}):ZPDashboard.AdvAnalytics.isCurrUserAdvAnAdmin&&void 0!==ZPeople.allAdvAnDashboardsArray&&ZPeople.allAdvAnDashboardsArray.length>0?ZPDashboard.AdvAnalytics.populateCustDashboardSelModalBody(ZPeople.allAdvAnDashboardsArray,ZPDashboard.AdvAnalytics.selDashboardsArray):ZPDashboard.AdvAnalytics.showNoDashboardsFound()}},populateCustDashboardSelModalBody:function(allDashboards,selDashboards){var selDashboardIds=[];void 0!==selDashboards&&$.each(selDashboards,function(index,selDashboardObj){selDashboardIds.push(selDashboardObj.zrRepId)});var dbId,bodyHtml='<ul class="tabList">';if($.each(allDashboards,function(index,dashboardObj){dbId=dashboardObj.dbId;var dashboardPreviewUrl=reportsIntegUrl+"/ZDBDataSheetView.cc?OBJID="+dashboardObj.id;bodyHtml+='<li id="zrRep'+dashboardObj.id+'" zrRepId="'+dashboardObj.id+'" zrRepName="'+ZSEC.Encoder.encodeForHTMLAttribute(dashboardObj.name)+'"',bodyHtml+='><div class="mvr"><a href="'+dashboardPreviewUrl+'" target="_blank" rel="noreferrer">'+ZSEC.Encoder.encodeForHTML(dashboardObj.name)+'</a></div><div class="checkbox"><input type="checkbox"'+(selDashboardIds.includes(dashboardObj.id)?" checked":"")+"><label></label></div></li>"}),bodyHtml+="</ul>",$("#zp_custdashboardselmodal #zp_modal_body").html(bodyHtml),$("#zp_custdashboardselmodal #zp_modal_blubtn").removeClass("disabled"),$("#zp_custdashboardselmodal #zp_modal_body ul").on("click","i",function(event){$(this).closest("li").toggleClass("sel")}),void 0!==dbId){var dbUrl=reportsIntegUrl+"/ZDBDataSheetView.cc?DBID="+dbId;$("#zp_custdashboardselmodal #repDbLink").attr("href",dbUrl).removeClass("disabled")}},saveSelectedDashboards:function(){$("#zp_custdashboardselmodal #zp_modal_blubtn").addClass("disabled");var selDashArray=[];$("#zp_custdashboardselmodal #zp_modal_body ul li input:checked").each(function(index,selObj){var selDashObj={};selDashObj.id=$(selObj).closest("li").attr("zrRepId"),selDashObj.name=$(selObj).closest("li").attr("zrRepName"),selDashArray.push(selDashObj)}),ZPeople.Request.send("/integrations/advAnalytics/addSelDashboards",{selDashboardsArray:JSON.stringify(selDashArray)},function(resultData){void 0!==resultData&&1===resultData[0]?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.advan.selsavesuccess")),ZPDashboard.AdvAnalytics.selDashboardsArray=resultData[1],ZPTabs.TAB_JSON[1].subtabs.forEach(function(subtab){"ZohoReportsDashboards"===subtab.tabName&&(subtab.formArr=resultData[1])}),"home"==ZPTabs.getSelectedTab().tname&&(ZPTabs.constructSubtabsBasedOnHash(),$("#ZRDshbrdsTab").trigger("click"))):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.advan.selsavefailure")),ZPeople.BSModal.hide("zp_custdashboardselmodal")},void 0,function(){ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.advan.selsavefailure")),ZPeople.BSModal.hide("zp_custdashboardselmodal")})},loadCustDashboardViewPage:function(){ZPDashboard.AdvAnalytics.getZRDashboardsSubTabObj();var zrRepId,zrRepName,zpRepId=Layout.Page.urlparam.id;if(void 0!==ZPDashboard.AdvAnalytics.selDashboardsArray&&ZPDashboard.AdvAnalytics.selDashboardsArray.forEach(function(selDashboardObj){if(selDashboardObj.zpRepId==zpRepId)return zrRepId=selDashboardObj.zrRepId,zrRepName=selDashboardObj.displayName,!0}),void 0===zrRepId)Layout.Page.container.html('<div class="Scrcont zp-fdbg"><div class="text-center MT50"><img src="'+ZPeople.getResourceURL(newUIImageUrl+"zpbee.png")+'" alt="" class="W200"><h5>'+ZPI18N.getString("zp.advan.nodashboardexists")+"</h5></div></div>");else{var custDashboardUrl=reportsIntegUrl+"/ZDBDataSheetView.cc?OBJID="+zrRepId;Layout.Page.container.html('<div class="ZPPhed well"><div class="row"><h5 class="ZP-TopBarTitle">'+$("<div/>").text(zrRepName).html()+'</h5></div></div><div class="Scrcont" style="top:100px;overflow:hidden;"><iframe width="100%" height="100%" src="'+custDashboardUrl+'"></iframe></div>')}},showNoDashboardsFound:function(){$("#zp_custdashboardselmodal #zp_modal_body").html('<div class="Scrcont zp-fdbg"><div class="text-center MT50"><img src="'+ZPeople.getResourceURL(newUIImageUrl+"zpbee.png")+'" alt="" class="W120"><h5>'+ZPI18N.getString("zp.advan.nodashboardinzr")+"</h5></div></div>")}},ZPDashboard.AdminCustomization={WIDGETOBJ:{},initPage:function(){$("#zp_d_wrow").children().remove();var dashHtml=$('<div class="ZPD-Mact"> <div class="lft"><div> <h6 class="MT5I FL">'+ZPI18N.getString("zp.orgbaseddashboard")+'</h6> <label class="btnactive chkBxSwitch MT5"> <input class="cmn-toggle-small cmn-toggle-round-small" id="zpdash_orgType_dash" type="checkbox" > <span class="M0"></span> </label> </div>  </div> <div class="rgt"></div> </div><div class="Scrcont " id="zp_dash_maincont"><div class="dash-main zp_DHC zp_SA-edit" id="zp_d_cmain_sett"><div class="zprow" id="zp_d_wrow"></div><div class="zp_SA-dhead"> <h5>Disabled Widgets</h5> </div><div class="zprow zp_SA-dwid" id="zp_disabled_wrow"></div></div></div>');Layout.Page.container.html(dashHtml)},getInitialValues:function(){ZPeople.Request.send(ZPDashboard.Widget.URL+"getAllWidgets",{},ZPDashboard.AdminCustomization.load)},load:function(data){if(ZPDashboard.AdminCustomization.initPage(),1==data.success){ZPDashboard.INITIATEWIDGETS=!0,1==data.isOrgBased?Layout.Page.container.find(".ZPD-Mact").find("#zpdash_orgType_dash")[0].checked=!0:Layout.Page.container.find(".ZPD-Mact").find("#zpdash_orgType_dash").prop("checked",!1),Layout.Page.container.find(".ZPD-Mact").find("#zpdash_orgType_dash").on("change",function(){ZPDashboard.AdminCustomization.confirmOrgTypeChange($(this))});var widArr=data.widgets;ZPDashboard.AdminCustomization.WIDGETOBJ=data.widgets,widArr.length>0&&(ZPDashboard.AdminCustomization.registerWidget(),$.each(widArr,function(ind,widget){widget.isHidden?ZPDashboard.AdminCustomization.initiateWidget(widget,ind,!0):ZPDashboard.AdminCustomization.initiateWidget(widget,ind)}))}},getWidgetObj:function(widId){var widObj,widArr=ZPDashboard.AdminCustomization.WIDGETOBJ;return $.each(widArr,function(ind,wid){if(wid.widId===widId)return widObj=wid,!1}),widObj},layout:function(json,widget){var lout=$('<div class="'+json.outerClass+'" name="'+widget.key+'" widget="true" widId="'+widget.widId+'"><div class="dash-col '+("BIRTHDAY"===widget.key?"bdayBG ":"")+(void 0!=json.dColClass?json.dColClass:"")+'"><div class="zp_SA-head hicon IC-drag"> <h3 class="SA-title"  title="'+ZSEC.Encoder.encodeForHTML(widget.name)+'" >'+ZSEC.Encoder.encodeForHTML(widget.name)+' <i class="IC-pen ML5 zp_titEdt" id="zpdash_adSet_edit"></i> </h3><input type="text" class="form-control zp_edtInp DNI" id="zpdas_wid_rename"> <span class="cout"> <label class="btnactive chkBxSwitch "> <input class="cmn-toggle-small cmn-toggle-round-small"  type="checkbox"'+(1==widget.isHidden?"":" checked=true ")+' id="zpdash_adSett_enbdisbtn"> <span class="M0"></span> </label> </span> </div>'+(json.bodyClass?json.bodyClass:"")+"</div></div>");return lout.find("#zpdas_wid_rename").val(widget.name),lout},registerWidget:function(){Layout.Page.container.find(".dash-main").on("scroll",function(){ZPDashboard.Widget.loadData()}),$(window).on("resize",function(){ZPDashboard.Widget.loadData()}),Layout.Page.container.find("#zp_d_wrow").sortable({containment:"#zp_d_cmain_sett",placeholder:"dash-placeholder",handle:".IC-drag ",update:function(event,ui){var itemId=$(ui.item).attr("widId"),param={};Layout.Page.container.find("#zp_d_wrow").children().each(function(ind,obj){itemId==$(this).attr("widId")&&(param.widId=itemId,param.seq=ind+1)}),ZPDashboard.AdminCustomization.updateWidgetSequence(param)}})},initiateWidget:function(widget,pos,isdisabled){var conf=ZPDashboard.Widget.getConfiguration(widget.key),layout=ZPDashboard.AdminCustomization.layout(conf,widget,!0);if(layout.data("conf",conf),layout.data("widget",widget),layout.find("#zpdash_adSet_edit").on("click",function(e){e.stopPropagation(),ZPDashboard.AdminCustomization.toggleEditView(widget,$(this))}),layout.find("#zpdash_adSett_enbdisbtn").on("click",function(){ZPDashboard.AdminCustomization.enabledisableWidget(widget,$(this))}),layout.find("#zpdas_wid_rename").on("blur",function(){ZPDashboard.AdminCustomization.renameWidget(widget,$(this))}),layout.find("#zpdas_wid_rename").on("change",function(){ZPDashboard.AdminCustomization.renameWidget(widget,$(this))}),void 0!==pos){var cont=Layout.Page.container.find("#zp_d_wrow");if(1==isdisabled&&(cont=Layout.Page.container.find("#zp_disabled_wrow")),0===pos)cont.prepend(layout);else{var child=cont.children()[pos];void 0!==child?layout.insertBefore($(child)):cont.append(layout)}}else Layout.Page.container.find("#zp_d_wrow").append(layout);0==Layout.Page.container.find("#zp_disabled_wrow").children().length?(Layout.Page.container.find(".zp_SA-dhead").addClass("DN"),Layout.Page.container.find("#zp_disabled_wrow").addClass("DN")):(Layout.Page.container.find("#zp_disabled_wrow").removeClass("DN"),Layout.Page.container.find(".zp_SA-dhead").removeClass("DN")),ZPDashboard.Widget.loadData(widget.key,conf)},hideAllInput:function(){Layout.Page.container.find(".zp_edtInp").addClass("DNI"),Layout.Page.container.find(".SA-title").removeClass("DNI")},toggleEditView:function(widget,Obj){if(ZPDashboard.AdminCustomization.hideAllInput(),Obj.length>0){var cont=Obj.parents(".dash-col");cont.find(".SA-title").addClass("DNI"),cont.find("#zpdas_wid_rename").removeClass("DNI"),cont.find("#zpdas_wid_rename").trigger("focus")}},renameWidget:function(widget,Obj){var newname=$(Obj).val();if(widget=ZPDashboard.AdminCustomization.getWidgetObj(widget.widId),void 0!==newname&&!ZPUtil.Validation.isEmpty(newname)&&newname.length<=50){widget.name!==newname?ZPeople.Request.send(ZPDashboard.Widget.URL+"renameWidgetForOrg",{widgetId:widget.widId,widname:newname},ZPDashboard.AdminCustomization.handlerenamewidget,{widget:widget}):ZPDashboard.AdminCustomization.hideAllInput()}else ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.namelenghtwarn")),$(Obj).val(widget.name),$(Obj).trigger("focus")},handlerenamewidget:function(data,param,otherDtl){if(1==data.success){ZPDashboard.AdminCustomization.setModuleDataRefresh(!0);var cont=Layout.Page.container.find("[name='"+otherDtl.widget.key+"']");cont.find(".SA-title").html(data.name+'<i class="IC-pen ML5 zp_titEdt" id="zpdash_adSet_edit"></i>'),otherDtl.widget.name=data.name,cont.find(".SA-title").find("#zpdash_adSet_edit").on("click",function(e){e.stopPropagation(),ZPDashboard.AdminCustomization.toggleEditView(otherDtl.widget,$(this))}),cont.find("#zpdas_wid_rename").val(ZPeople.decodeTxt(data.name)),ZPDashboard.AdminCustomization.updateTowidObj(otherDtl.widget),ZPDashboard.AdminCustomization.hideAllInput()}},updateTowidObj:function(widgetObj){var widArr=ZPDashboard.AdminCustomization.WIDGETOBJ;$.each(widArr,function(ind,widget){if(widget.key==widgetObj.key)return ZPDashboard.AdminCustomization.WIDGETOBJ[ind]=widgetObj,!1})},enabledisableWidget:function(widget,Obj){var isHidden=!0;Obj.is(":checked")&&(isHidden=!1);(widget=ZPDashboard.AdminCustomization.getWidgetObj(widget.widId)).isHidden!=isHidden&&ZPeople.Request.send(ZPDashboard.Widget.URL+"enableDisableWidgetForOrg",{widgetId:widget.widId,isHidden:isHidden},ZPDashboard.AdminCustomization.enableDisableWidgetResp,{widget:widget})},enableDisableWidgetResp:function(data,params,otherdtl){if(void 0!==data&&data.success){ZPDashboard.AdminCustomization.setModuleDataRefresh(!0);var widget,widArr=ZPDashboard.AdminCustomization.WIDGETOBJ,index=0;$.each(widArr,function(ind,wid){if(wid.widId===params.widgetId)return widArr[ind].isHidden=params.isHidden,widget=widArr[ind],!1;1!=wid.isHidden&&index++});var scrollTop=0;0===Layout.Page.container.find("#zp_d_wrow").find("[name="+widget.key+"]").length?void 0!==widget&&(ZPDashboard.AdminCustomization.initiateWidget(widget,index),Layout.Page.container.find("#zp_disabled_wrow").find("[name="+widget.key+"]").length>0&&Layout.Page.container.find("#zp_disabled_wrow").find("[name="+widget.key+"]").remove(),scrollTop=$(Layout.Page.container.find("#zp_d_wrow").find("[name="+widget.key+"]")).offset().top-100):(Layout.Page.container.find("#zp_d_wrow").find("[name="+widget.key+"]").remove(),ZPDashboard.AdminCustomization.initiateWidget(widget,index,!0),scrollTop=$(Layout.Page.container.find("#zp_disabled_wrow").find("[name="+widget.key+"]")).offset().top+150),Layout.Page.container.find("#zp_d_cmain_sett").scrollTop(scrollTop),0==Layout.Page.container.find("#zp_disabled_wrow").children().length?(Layout.Page.container.find(".zp_SA-dhead").addClass("DN"),Layout.Page.container.find("#zp_disabled_wrow").addClass("DN")):(Layout.Page.container.find("#zp_disabled_wrow").removeClass("DN"),Layout.Page.container.find(".zp_SA-dhead").removeClass("DN"))}},updateWidgetSequence:function(movedObj){var widArr=ZPDashboard.AdminCustomization.WIDGETOBJ,isAllowed=!1;$.each(widArr,function(ind,wid){if(wid.widId!==movedObj.widId&&wid.isHidden&&ind+1<movedObj.seq&&(movedObj.seq=movedObj.seq+1),ind+1==movedObj.seq)return isAllowed=!0,!1});isAllowed&&ZPeople.Request.send(ZPDashboard.Widget.URL+"updateWidgetSequenceForOrg",{MODE:"UPDATE_WIDGETSEQ_FORORG",widgetId:movedObj.widId,seq:movedObj.seq},ZPDashboard.AdminCustomization.handleUpdateSequence)},manageSequenceUpdate:function(params){ZPDashboard.AdminCustomization.WIDGETOBJ},handleUpdateSequence:function(data,params,otherDtl){1==data.success&&(ZPDashboard.AdminCustomization.setModuleDataRefresh(!0),void 0!=data.widgets&&(ZPDashboard.AdminCustomization.WIDGETOBJ=data.widgets))},confirmOrgTypeChange:function(Obj){$(Obj).is(":checked")?($(Obj).prop("checked",!1),ZPDashboard.components.alertPopup(ZPI18N.getString("zp.mandateOrgWidget"),ZPI18N.getString("zp.orgtypedashenbmsg"),ZPDashboard.AdminCustomization.changeOrgBasedDashboard,$(Obj).prop("id"))):($(Obj).prop("checked",!0),ZPDashboard.components.alertPopup(ZPI18N.getString("zp.disableOrgWidget"),ZPI18N.getString("zp.orgtypedashdismsg"),ZPDashboard.AdminCustomization.changeOrgBasedDashboard,$(Obj).prop("id")))},changeOrgBasedDashboard:function(id){var Obj=Layout.Page.container.find("#"+id);if(void 0!==Obj){var isEnabled=!1;$(Obj).is(":checked")||(isEnabled=!0),ZPeople.Request.send(ZPDashboard.Widget.URL+"changeOrgTypeDashboard",{enable:isEnabled},ZPDashboard.AdminCustomization.handleEnableOrgType,id)}},handleEnableOrgType:function(data,params,id){if(void 0!==data&&1==data.success){var Obj=Layout.Page.container.find("#"+id);data.isEnabled?($(Obj).prop("checked",!0),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.orgtypedashenabled"))):($(Obj).prop("checked",!1),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.orgtypedashdisabled"))),ZPDashboard.AdminCustomization.setModuleDataRefresh(!0,id)}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.widgetUpdateFail"))},setModuleDataRefresh:function(isTrue,id){isTrue&&(ZPDashboard.Widget.MODULEDATAREFRESH=!0,ZPDashboard.INITIATEWIDGETS=!1),"orgWideWidget"==id&&(ZPDashboard.Widget.closeWidCustModal(),ZPDashboard.init()),"adminWidgets"==id&&ZPDashboard.Widget.loadModule()}},ZPDashboard.components={alertPopup:function(header,content,successCallback,param){let popup=$(`<div data-modal-box="alrtinfo" id="customwidgetmodal" class="zpl_mdl zpl_malrtmsg zpl_mopen">\n            <div class="zpl_minr">\n                <a class="_cls PI_cls"></a>\n                <div class="zpl_mcnt">\n\n                    <div class="alert_contain">\n                        <i class="ico info"></i>\n                        <div class="cont">\n                            <h3>${header}</h3>\n                            <p>${content}\n                            </p>\n                        </div>\n                    </div>\n                </div>\n                <div class="zpl_mfoter">\n                    <button type="button" id="customwidgetsubmit" class="zlabel zlabel--yellow zlabel--medium MR10">${ZPI18N.getString("zp.confirm")}</button>\n                    <button type="button" id="customwidgetclose" class="zlabel zlabel--outline zlabel--medium">${ZPI18N.getString("zp.cancel")}</button>\n                </div>\n            </div>\n        </div>`);popup.find(".PI_cls,#customwidgetclose").on("click",()=>{$(document.body).find("#customwidgetmodal").remove()}),popup.find("#customwidgetsubmit").on("click",()=>{$(document.body).find("#customwidgetmodal").remove(),successCallback(param)}),$(document.body).append(popup)},nodataHtml:(className,message,info,id)=>{let html=$('<div class="zpl_crdcnt"><div class="zpl_Emptydata"><div><div class="zpl_emptimg '+(ZPUtil.Validation.isEmpty(className)?"zp_nd_nodata":className)+'"></div><h4>'+(ZPUtil.Validation.isEmpty(message)?ZPI18N.getString("zp.nodatafound"):message)+"</h4><p>"+(ZPUtil.Validation.isEmpty(info)?"":info)+"</p></div></div></div>");return ZPUtil.Validation.isEmpty(id)||html.attr("id",id),html}},Attendance.Dashboard={},Attendance.Dashboard.consWidget=function(name,html){var layout=$(Attendance.Dashboard.pageLayout()).find("[name="+name+"]");layout.find("#zp_page_loading").remove(),layout.find(".dash-body").html(html)},Attendance.Dashboard.pageLayout=function(){return"admin-formslayout-widgets"!==Layout.Page.pageId?"true"===is5_0Enabled?"#home-organization-dashboard":"#home-dashboard":"#admin-formslayout-widgets"},Attendance.Dashboard.WeeklyData={premonth:0,currWeekData:{},refCount:0,getCurWeekData:function(isNaN){var params={mode:"getCurWeekDataForDashboard",premonth:0};isNaN&&(params.isNaN=Attendance.Dashboard.WeeklyData.currWeekData.offset+"/"+Attendance.Dashboard.WeeklyData.currWeekData.time),ZPeople.Request.send("AttendanceAction.zp",params,function(response){Attendance.Dashboard.WeeklyData.buildHTML(response)})},buildHTML:function(data){Attendance.Dashboard.WeeklyData.currWeekData=data,Attendance.timeFormatIs12hr=-1!==data.dateFormat.indexOf("hh:mm a"),Attendance.isWebCoOrdMandatory=void 0!==data.isWebCoOrdMandatory&&data.isWebCoOrdMandatory,Attendance.isTrackLocationEnabled=void 0!==data.isTrackLocationEnabled&&data.isTrackLocationEnabled,Attendance.isAllowToCapturePhotoInWeb=void 0!==data.isAllowToCapturePhotoInWeb&&data.isAllowToCapturePhotoInWeb,Attendance.isAllowToVerifyUserInWeb=void 0!==data.isAllowToVerifyUserInWeb&&data.isAllowToVerifyUserInWeb;var attBodyContent=Attendance.Dashboard.WeeklyData.consAttWeekBody(data);Attendance.Dashboard.consWidget("ATTENDANCE",attBodyContent),Attendance.Dashboard.WeeklyData.consToolTip();var currDate=moment(data.date,dateFmt.toUpperCase())._d;currDate=currDate.getDate()+" "+months[currDate.getMonth()]+" "+currDate.getFullYear(),$(Attendance.Dashboard.pageLayout()).find("#ZPAtt_Dash_CurrDate").html(currDate),Attendance.Dashboard.WeeklyData.setTime("first"),Attendance.Dashboard.widgetTimer=void 0,Attendance.Dashboard.WeeklyData.getCurrRunningTime(Attendance.Dashboard.WeeklyData.addsecs,Attendance.Dashboard.WeeklyData.hasaddsecs),Attendance.Dashboard.WeeklyData.consAttHeader()},consToolTip:function(){var layout=$(Attendance.Dashboard.pageLayout()),toolTip=layout.find("#ZPAtt_Dashboard_tooltip").hide(),progresCont=layout.find("#ZPAtt_dashboard_dayCont .prgrs-event"),beforeCont=this.befTitleVal,afterCont=this.afterTitleVal;""!==beforeCont&&progresCont.eq(0).off("mouseenter mouseleave").on("mouseenter",function(){toolTip.show().css("left","-13px").html(beforeCont)}).on("mouseleave",function(){toolTip.hide()}),""!==afterCont&&progresCont.eq(1).off("mouseenter mouseleave").on("mouseenter",function(){toolTip.show().css("left","inherit").css("right","-21px").html(afterCont)}).on("mouseleave",function(){toolTip.hide()})},consAttHeader:function(){var layout=$(Attendance.Dashboard.pageLayout());if(!layout.find('[name="ATTENDANCE"]').find(".widswch")[0]){var html="<div class='widswch'><div onclick=Attendance.Dashboard.WeeklyData.toggleViews(this) class='sel IC-today'></div>";return html+="<div onclick=Attendance.Dashboard.WeeklyData.toggleViews(this) class='IC-week'></div></div>",layout.find('[name="ATTENDANCE"]').find(".dash-title").after(html),layout.find("#ZPAtt_dashboard_weekCont").hide(),void layout.find("#ZPAtt_dashboard_dayCont").show()}Attendance.Dashboard.WeeklyData.toggleViews(layout.find('[name="ATTENDANCE"]').find(".widswch .sel")[0])},toggleViews:function(obj){var layout=$(Attendance.Dashboard.pageLayout());$(obj).parent().find(".sel").removeClass("sel"),$(obj).addClass("sel"),layout.find("#ZPAtt_dashboard_weekCont, #ZPAtt_dashboard_dayCont").hide(),0===$(obj).index()?layout.find("#ZPAtt_dashboard_dayCont").show():layout.find("#ZPAtt_dashboard_weekCont").show()},todayIndex:null,addsecs:0,hasaddsecs:!0,firstCheckInLefPos:0,currRunningTime:null,display_sec:0,currDayList:{},consAttWeekBody:function(data){var list=data.dayList,html="<table class='table table-hover atlist' id='ZPAtt_dashboard_weekCont'><tbody>";for(var index in list){for(var attData=list[index],status=attData.status,transStat="",splittedStatus=status.split(", "),len=0;len<splittedStatus.length;len++)transStat=""===transStat?$("<div/>").text(Attendance.statusI18n(splittedStatus[len])).html():transStat+", "+$("<div/>").text(Attendance.statusI18n(splittedStatus[len])).html();var day=days[attData.day-1],date=attData.attDate.split("-")[2],entries=data.entries[attData.attDate],todayCls="";if(attData.isToday&&(todayCls="sel",Attendance.Dashboard.WeeklyData.currDayList=attData),html+="<tr><td width='75' class='"+todayCls+"'>"+day+"<span> "+date+" </span></td>","Absent"!==status&&"0.5 day Present, 0.5 day Absent"!==status||list[index].isToday||!(!entries[0]||entries.length>0&&!entries[entries.length-1].allowPunchOut))if(-1===status.indexOf("Present")&&0===entries.length)-1!==status.indexOf("Weekend")?html+="<td colspan='3'><div class='lingr wkend-bg'><span>"+transStat+"</span></div></td>":-1!==status.indexOf("Holiday")||-1!==status.indexOf("(Restricted)")||-1!==status.indexOf("(Restricted Holiday)")&&-1===status.indexOf("Present")?html+="<td colspan='3'><div class='lingr holiday-bg'><span>"+transStat+"</span></div></td>":-1!==status.indexOf("Paid Leave")?html+="<td colspan='3'><div class='lingr leave-bg'><span>"+transStat+"</span></div></td>":-1!==status.indexOf("On Duty")?html+="<td colspan='3'><div class='lingr onduty-bg'><span>"+transStat+"</span></div></td>":-1!==status.indexOf("Unpaid Leave")?html+="<td colspan='3'><div class='lingr lop-bg'><span>"+transStat+"</span></div></td>":html+="<td colspan='3'><div class='lingr' style='background-color:#f6f7f8'></div></td>";else{var earlyLateIn=attData.filo.earlyLateCheckIn;if(earlyLateIn){var colClass="grn";-1!==earlyLateIn.indexOf("-")?colClass="red":earlyLateIn="+"+earlyLateIn,html+="<td class='"+colClass+"'>"+earlyLateIn+"</td>"}else html+="<td></td>";html+="<td width='145'>",attData.filo.ftime&&(html+=attData.filo.ftime),html+=" - ",attData.filo.ttime&&(html+=attData.filo.ttime);var earlyLateOut=attData.filo.earlyLateCheckOut;if(earlyLateOut){colClass="grn";-1!==earlyLateOut.indexOf("-")?colClass="red":earlyLateOut="+"+earlyLateOut,html+="<td class='"+colClass+"'>"+earlyLateOut+"</td>"}else html+="<td></td>"}else html+="<td colspan='3'><div class='lingr absent-bg'><span>"+transStat+"</span></div></td>";if(html+="</tr>",!data.allowedToCheckIn&&entries.length>0&&entries[entries.length-1].allowPunchOut){var finVal=entries[entries.length-1];void 0!==finVal.totalSecs&&(Attendance.Dashboard.WeeklyData.display_sec=finVal.totalSecs),void 0!==finVal.addSecs?(Attendance.Dashboard.WeeklyData.addsecs=finVal.addSecs,Attendance.Dashboard.WeeklyData.temp_tsecs=0,Attendance.Dashboard.WeeklyData.hasaddsecs=!1):(Attendance.Dashboard.WeeklyData.addsecs=finVal.tsecs,Attendance.Dashboard.WeeklyData.hasaddsecs=!0)}}return html+="</tbody></table>",html+=Attendance.Dashboard.WeeklyData.consAttCurrDayBody()},befTitleVal:"",afterTitleVal:"",consAttCurrDayBody:function(){var data=Attendance.Dashboard.WeeklyData.currWeekData,dayList=Attendance.Dashboard.WeeklyData.currDayList,filo=dayList.filo,shiftDet=dayList.shift,fromShift=shiftDet.fTime,toShift=shiftDet.tTime,dateFormat=data.dateFormat.split(" - ")[0],barLeftPos=0,barWidth=0,colCls="present-bg",status=dayList.status,befEntInDot="",befEntOutDot="",afterEntInDot="",afterEntOutDot="";if(this.befTitleVal=this.afterTitleVal="",""!==status&&-1===status.indexOf("Present"))-1!==status.indexOf("Weekend")?colCls="wkend-bg":-1!==status.indexOf("Holiday")||-1!==status.indexOf("(Restricted)")||-1!==status.indexOf("(Restricted Holiday)")&&-1===status.indexOf("Present")?colCls="holiday-bg":-1!==status.indexOf("Paid Leave")?colCls="leave-bg":-1!==status.indexOf("On Duty")?colCls="onduty-bg":-1!==status.indexOf("Unpaid Leave")&&(colCls="lop-bg"),barWidth=100;else{if(filo.fdate){var date=filo.fdate,time=filo.ftime;(barLeftPos=Attendance.Dashboard.WeeklyData.leftPositionCalc(time,date,dayList.ldate,fromShift,toShift,dateFormat))>100?(barLeftPos=100,afterEntInDot=afterEntOutDot=colCls,this.afterTitleVal="<li class='grn'><b class='ZPbold PR'>"+time+" </b></li>"):barLeftPos<0&&(barLeftPos=0,befEntInDot=befEntOutDot=colCls,this.befTitleVal="<li class='grn'><b class='ZPbold PR'>"+time+" </b></li>"),Attendance.Dashboard.WeeklyData.firstCheckInLefPos=barLeftPos}if(filo.tdate){var tdate=filo.tdate,ttime=filo.ttime,toBarLeftPos=Attendance.Dashboard.WeeklyData.leftPositionCalc(ttime,tdate,dayList.ldate,fromShift,toShift,dateFormat);toBarLeftPos>100?(toBarLeftPos=100,afterEntInDot=colCls,afterEntOutDot="absent-bg",this.afterTitleVal+="<li class='red'><b class='ZPbold PR'>"+ttime+" </b></li>"):toBarLeftPos<0&&(toBarLeftPos=0,befEntOutDot="absent-bg",this.befTitleVal+="<li class='red'><b class='ZPbold PR'>"+ttime+" </b></li>"),(barWidth=toBarLeftPos-barLeftPos)<0&&(barWidth=0)}}var bodyCont="<div id='ZPAtt_dashboard_dayCont'>";data.allowUIEntry||(bodyCont+="<div class='anots'><input type='text' class='tfld' id='ZPAtt_Dash_checkinNotes' placeholder='"+ZPI18N.getString("zp.addnotes")+"'>");var inOutCls="in",isCheckIn=!0,earlyLateText=ZPI18N.getString("zp.yetToCheckIn"),timerIcon="<div class='SP-timelg'></div>";return data.allowedToCheckIn||data.isBreakRunning||(inOutCls="out",isCheckIn=!1,earlyLateText=ZPI18N.getString("zp.yettocheckout"),timerIcon="<div class='timelg-img'><img class='CP' src='"+ZPeople.getResourceURL(newUIImageUrl+"timelog3.gif")+"'></div>"),data.allowUIEntry||(bodyCont+="<button class='"+inOutCls+" chlodIng' onclick='Attendance.Dashboard.WeeklyData.updateCheckOut("+isCheckIn+")'>",bodyCont+="<svg viewBox='25 25 50 50' class='DN'><circle cx='50' cy='50' r='20'></circle></svg>"+timerIcon,bodyCont+=ZPI18N.getString("zp.check"+inOutCls),bodyCont+="<span id='ZPAtt_Dash_CurrTime'></span></button>",bodyCont+="</div>"),bodyCont+="<div class='ctim'><h2 id='ZPAtt_Dash_CurrDayTHrs'></h2><span id='ZPAtt_Dash_CurrDate'></span>",filo.earlyLateCheckIn&&(earlyLateText=ZPI18N.getString("zp.earlyby",new Array(filo.earlyLateCheckIn))+" "+ZPI18N.getString("zp.hrs"+filo.earlyLateCheckIn),-1!==filo.earlyLateCheckIn.indexOf("-")&&(earlyLateText=ZPI18N.getString("zp.lateby",new Array(filo.earlyLateCheckIn.substring(1)))+" "+ZPI18N.getString("zp.hrs"+filo.earlyLateCheckIn))),bodyCont+="<em class='org'>"+earlyLateText+"</em>",bodyCont+="</div>",bodyCont+="<div class='abar'><div class='ZP-progresstable'><div class='prgrs-event'>",bodyCont+="<div class='progress-start max-prgrs-dot "+befEntInDot+"'></div><div class='progress-middle prgrs-dot "+befEntInDot+"'></div><div class='progress-end max-prgrs-dot "+befEntOutDot+"'></div></div>",bodyCont+="<div class='attbar'><div class='progress cust-bar'>",bodyCont+="<div class='custom-progress-bar "+colCls+"' id='ZPAtt_Dashboard_progBar' style='left:"+barLeftPos+"%; width:"+barWidth+"%;'></div>",bodyCont+="</div></div>",bodyCont+="<div class='prgrs-event TRI'>",bodyCont+="<div class='progress-start max-prgrs-dot "+afterEntInDot+"'></div><div class='progress-middle prgrs-dot "+afterEntInDot+"'></div><div class='progress-end max-prgrs-dot "+afterEntOutDot+"'></div>",bodyCont+="</div><ul class='dropdown-menu progress-menu' id='ZPAtt_Dashboard_tooltip'></ul></div>",bodyCont+="<div class='atim'>",bodyCont+=$("<div/>").text(shiftDet.sName).html(),bodyCont+="<div class='lf'>"+Attendance.disTime(fromShift,!0)+"</div>",bodyCont+="<div class='rt'>"+Attendance.disTime(toShift,!0)+"</div>",bodyCont+="</div>",bodyCont+="</div></div>"},setTime:function(rec){var sysTime=new Date;null!==rec&&"first"===rec&&(diffTime=sysTime.getTime()-Attendance.Dashboard.WeeklyData.currWeekData.time,clearInterval(Attendance.Dashboard.WeeklyData.timer),Attendance.Dashboard.WeeklyData.timer=setInterval(Attendance.Dashboard.WeeklyData.setTime,1e3),oldTime=sysTime.getTime()),oldTime=sysTime.getTime(),sysTime.setTime(sysTime.getTime()-diffTime+36e5*Attendance.Dashboard.WeeklyData.currWeekData.offset);var hours=sysTime.getUTCHours(),mins=sysTime.getUTCMinutes(),seconds=sysTime.getUTCSeconds();if(isNaN(hours)||isNaN(mins)||isNaN(seconds)){if(Attendance.Dashboard.WeeklyData.refCount<2)return clearInterval(Attendance.Dashboard.WeeklyData.timer),Attendance.Dashboard.WeeklyData.refCount+=1,Attendance.Dashboard.CurrStatus.getCurrDayStatus(),void Attendance.Dashboard.WeeklyData.getCurWeekData(!0)}else 2==Attendance.Dashboard.WeeklyData.refCount&&(Attendance.Dashboard.WeeklyData.refCount=0);if("hh:mm a"===timeFormat){var aa=ZPI18N.getString("zp.am");hours>=12&&(aa=ZPI18N.getString("zp.pm"),hours-=12),0===hours&&(hours=12)}else aa="";Attendance.Dashboard.WeeklyData.currRunningTime=Attendance.disTwoDigit(hours)+":"+Attendance.disTwoDigit(mins)+" "+aa.toLowerCase();var currTime=Attendance.disTwoDigit(hours)+":"+Attendance.disTwoDigit(mins)+":"+Attendance.disTwoDigit(seconds)+" "+aa.toLowerCase();$(Attendance.Dashboard.pageLayout()).find('[name="ATTENDANCE"]').find("#ZPAtt_Dash_CurrTime").html(currTime)},temp_tsecs:0,display_sec:0,lastRefTime:0,getCurrRunningTime:function(addSecs,store){if("admin-formslayout-widgets"!==Layout.Page.pageId){clearInterval(Attendance.Dashboard.WeeklyData.setCurrTime);var curTime=(new Date).getTime();if(addSecs<0)return;if(!addSecs&&0!==addSecs){var diffSec=void 0!=Attendance.Dashboard.widgetTimer?(curTime-Attendance.Dashboard.widgetTimer)/1e3:0;addSecs=diffSec>1?diffSec-1+1:1}store?(Attendance.Dashboard.WeeklyData.totalsecs=addSecs,Attendance.Dashboard.WeeklyData.display_sec=addSecs,Attendance.Dashboard.WeeklyData.temp_tsecs=0):(Attendance.Dashboard.WeeklyData.temp_tsecs+=addSecs,Attendance.Dashboard.WeeklyData.totalsecs=Attendance.Dashboard.WeeklyData.display_sec+Attendance.Dashboard.WeeklyData.temp_tsecs);var sec=parseInt(Attendance.Dashboard.WeeklyData.totalsecs%60),min=parseInt((Attendance.Dashboard.WeeklyData.totalsecs-sec)/60%60),hrs=parseInt((Attendance.Dashboard.WeeklyData.totalsecs-min)/3600),per=Attendance.Dashboard.WeeklyData.totalsecs/60/60/10*100;per>100&&(per=100),per+="%";var time=Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+":"+Attendance.disTwoDigit(sec)+" "+ZPI18N.getString("zp.hrs"),data=Attendance.Dashboard.WeeklyData.currWeekData,currDayList=Attendance.Dashboard.WeeklyData.currDayList,layout=$(Attendance.Dashboard.pageLayout());if(data.allowedToCheckIn||data.isBreakRunning){var tsecs=Attendance.disHours(currDayList.tsecs/60)+" "+ZPI18N.getString("zp.hrs");layout.find("#ZPAtt_Dash_CurrDayTHrs").html(tsecs)}else if(parseInt(Attendance.Dashboard.WeeklyData.totalsecs)>=86400){var temp=Math.round((curTime-Attendance.Dashboard.WeeklyData.lastRefTime)/1e3);if(0==Attendance.Dashboard.WeeklyData.lastRefTime||temp>=36e3)return void(Attendance.Dashboard.WeeklyData.lastRefTime=curTime)}else layout.find("#ZPAtt_Dash_CurrDayTHrs").html(time),Attendance.Dashboard.WeeklyData.setCurrTime=setInterval(Attendance.Dashboard.WeeklyData.getCurrRunningTime,1e3);if(layout.find("#ZPAtt_Dashboard_progBar").hasClass("present-bg")&&!data.allowedToCheckIn){var currDate=data.date,attDate=currDayList.ldate,fromShift=currDayList.shift.fTime,toShift=currDayList.shift.tTime,currTimeLeftPos=Attendance.Dashboard.WeeklyData.leftPositionCalc(Attendance.Dashboard.WeeklyData.currRunningTime,currDate,attDate,fromShift,toShift,data.dateFormat.split(" - ")[0]);currTimeLeftPos>=100?currTimeLeftPos=100:currTimeLeftPos<=0&&(currTimeLeftPos=0);var barWidth=currTimeLeftPos-Attendance.Dashboard.WeeklyData.firstCheckInLefPos;barWidth<0&&(barWidth=0),layout.find("#ZPAtt_Dashboard_progBar").css("width",barWidth+"%").attr("class","custom-progress-bar present-bg progress-bar-striped active")}Attendance.Dashboard.widgetTimer=curTime}},updateCheckOut:function(isCheckin){var layout=$(Attendance.Dashboard.pageLayout()),currTimePar=layout.find("#ZPAtt_Dash_CurrTime").parent();currTimePar.attr("disabled",!0),currTimePar.find("div").hide(),currTimePar.find("svg").show();var statBut=layout.find("#ZPD_Top_Att_Stat");statBut.attr("disabled",!0),statBut.find(".IC-clock").hide(),statBut.find("svg").show(),ZPeople.reloadSelfServAtt=!0,isCheckin?Attendance.Entry.punchIn():Attendance.Entry.punchOut()},leftPositionCalc:function(time,date,orgDate,fromShift,toShift,dateFormat){var shiftDiffTime;shiftDiffTime=toShift>fromShift?(toShift-fromShift)/60:24-(fromShift-toShift)/60;var time_hr=parseInt(time.slice(0,2),10);"AM"!==time.slice(6,8).trim()&&"am"!==time.slice(6,8).trim()||12!==time_hr?"PM"!==time.slice(6,8).trim()&&"pm"!==time.slice(6,8).trim()||12===time_hr||(time_hr+=12):time_hr=0;var time_min=parseInt(time.slice(3,5),10),temphour=time_hr-fromShift/60,per=(3600*temphour+60*time_min)/60/60/shiftDiffTime*100;return dateFormat=dateFormat.toUpperCase(),date=new Date(moment(date,dateFormat)._d),orgDate=new Date(moment(orgDate,dateFormat)._d),per<0&&fromShift>toShift&&60*time_hr<=toShift?per=(3600*(temphour+24)+60*time_min)/60/60/shiftDiffTime*100:date.getTime()>orgDate.getTime()?per=101:date.getTime()<orgDate.getTime()&&(per=-1),per}},Attendance.Dashboard.CurrStatus={addsecs:0,hasaddsecs:!0,currDayData:null,display_sec:0,getCurrDayStatus:function(){if(-1!==ZPTabs.ACTIVE_TABARR.indexOf("attendance")){var layout=$(Attendance.Dashboard.pageLayout()),param={mode:"getStatus",conreqcsr:csrfToken};$.post("/AttendanceAction.zp",param,function(rdata){if(isBrkRunning=rdata.isBreakRunning,layout.find("#ZPD_Top_Att_Stat").parent().hide(),!rdata.allowUIEntry){layout.find("#ZPD_Top_Att_Stat").parent().show();var checkInOutBut=layout.find("#ZPD_Top_Att_Stat").attr("class","in CP").removeAttr("disabled").attr("onclick","Attendance.Dashboard.CurrStatus.updateCheckOut(true)");if(checkInOutBut.removeAttr("style").html(ZPI18N.getString("zp.checkin")+"<svg viewBox='25 25 50 50' class='DN'><circle cx='50' cy='50' r='20'></circle></svg><div class='IC-clock S16'></div>"),Attendance.Dashboard.CurrStatus.currDayData=rdata.response,!1===rdata.allowedToCheckIn&&!rdata.isBreakRunning){(checkInOutBut=layout.find("#ZPD_Top_Att_Stat").attr("class","out CP").removeAttr("disabled").attr("onclick","Attendance.Dashboard.CurrStatus.updateCheckOut()")).removeAttr("style").html(ZPI18N.getString("zp.checkout")+"<svg viewBox='25 25 50 50' class='DN'><circle cx='50' cy='50' r='20'></circle></svg><div class='IC-clock S16'></div>");var entries=rdata.response,finVal=entries[entries.length-1];void 0!==finVal.totalSecs&&(Attendance.Dashboard.CurrStatus.display_sec=finVal.totalSecs),entries.length>0&&void 0!==finVal.addSecs?(Attendance.Dashboard.CurrStatus.addsecs=finVal.addSecs,Attendance.Dashboard.CurrStatus.temp_tsecs=0,Attendance.Dashboard.CurrStatus.hasaddsecs=!1):(Attendance.Dashboard.CurrStatus.addsecs=finVal.tsecs,Attendance.Dashboard.CurrStatus.hasaddsecs=!0)}Attendance.Dashboard.DashboardTimer=void 0,Attendance.Dashboard.CurrStatus.getCurrRunningTime(Attendance.Dashboard.CurrStatus.addsecs,Attendance.Dashboard.CurrStatus.hasaddsecs,rdata.allowedToCheckIn,rdata.isBreakRunning),Attendance.isWebCoOrdMandatory=void 0!==rdata.isWebCoOrdMandatory&&rdata.isWebCoOrdMandatory,Attendance.isTrackLocationEnabled=void 0!==rdata.isTrackLocationEnabled&&rdata.isTrackLocationEnabled,Attendance.isAllowToCapturePhotoInWeb=void 0!==rdata.isAllowToCapturePhotoInWeb&&rdata.isAllowToCapturePhotoInWeb,Attendance.isAllowToVerifyUserInWeb=void 0!==rdata.isAllowToVerifyUserInWeb&&rdata.isAllowToVerifyUserInWeb}}).fail(function(data){Attendance.Entry.refreshPage(data)})}},updateCheckOut:function(isCheckin){var layout=$(Attendance.Dashboard.pageLayout());if(!layout.find("#ZPD_Top_Att_Stat")[0].hasAttribute("disabled")){var statBut=layout.find("#ZPD_Top_Att_Stat");statBut.attr("disabled",!0),statBut.find(".IC-clock").hide(),statBut.find("svg").show();var widgetBut=layout.find("#ZPAtt_Dash_CurrTime");if(widgetBut.length>0){var widgetParBut=widgetBut.parent();widgetParBut.prop("disabled",!0),widgetParBut.find("div").hide(),widgetParBut.find("svg").show()}ZPeople.reloadSelfServAtt=!0,isCheckin?Attendance.Entry.punchIn():Attendance.Entry.punchOut()}},temp_tsecs:0,display_sec:0,lastRefTime:0,getCurrRunningTime:function(addSecs,store,allowedToCheckIn,isBreakRunning){clearInterval(Attendance.Dashboard.CurrStatus.setCurrTime);var curTime=(new Date).getTime();if(!(addSecs<0)){if(!addSecs&&0!==addSecs){var diffSec=void 0!=Attendance.Dashboard.DashboardTimer?(curTime-Attendance.Dashboard.DashboardTimer)/1e3:0;addSecs=diffSec>1?diffSec-1+1:1}store?(Attendance.Dashboard.CurrStatus.totalsecs=addSecs,Attendance.Dashboard.CurrStatus.display_sec=addSecs,Attendance.Dashboard.CurrStatus.temp_tsecs=0):(Attendance.Dashboard.CurrStatus.temp_tsecs+=addSecs,Attendance.Dashboard.CurrStatus.totalsecs=Attendance.Dashboard.CurrStatus.display_sec+Attendance.Dashboard.CurrStatus.temp_tsecs);var sec=parseInt(Attendance.Dashboard.CurrStatus.totalsecs%60),min=parseInt((Attendance.Dashboard.CurrStatus.totalsecs-sec)/60%60),hrs=parseInt((Attendance.Dashboard.CurrStatus.totalsecs-min)/3600),per=Attendance.Dashboard.CurrStatus.totalsecs/60/60/10*100;per>100&&(per=100),per+="%";var time=Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+":"+Attendance.disTwoDigit(sec)+" "+ZPI18N.getString("zp.hrs"),layout=$(Attendance.Dashboard.pageLayout());if(allowedToCheckIn||isBreakRunning){var totSecs=0;Attendance.Dashboard.CurrStatus.currDayData[Attendance.Dashboard.CurrStatus.currDayData.length-1]&&(totSecs=Attendance.Dashboard.CurrStatus.currDayData[Attendance.Dashboard.CurrStatus.currDayData.length-1].totalSecs),layout.find("#ZPD_Top_Att_THrs").html(Attendance.disHours(totSecs/60)+" "+ZPI18N.getString("zp.hrs"))}else if(parseInt(Attendance.Dashboard.CurrStatus.totalsecs)>=86400){var temp=Math.round((curTime-Attendance.Dashboard.CurrStatus.lastRefTime)/1e3);if(0==Attendance.Dashboard.CurrStatus.lastRefTime||temp>=36e3)return Attendance.Dashboard.CurrStatus.lastRefTime=curTime,void ZPeople.reloadAttDataFunction()}else layout.find("#ZPD_Top_Att_THrs").html(time),Attendance.Dashboard.CurrStatus.setCurrTime=setInterval(Attendance.Dashboard.CurrStatus.getCurrRunningTime,1e3);Attendance.Dashboard.DashboardTimer=curTime}}},Attendance.Dashboard.DailyReport={getAttDailyReport:function(){Attendance.Dashboard.DailyReport.getDailyRepData("ATTENDANCEREPORT")},getDashboardSummRep:function(){Attendance.Dashboard.DailyReport.getDailyRepData("ATT_DASH_SUMMARY")},getDailyRepData:function(widget){if(Attendance.Dashboard.DailyReport.data)"ATT_DASH_SUMMARY"===widget?Attendance.Dashboard.DailyReport.buildDashSummHTML():Attendance.Dashboard.DailyReport.buildHTML();else{ZPeople.Request.send("AttendanceAction.zp",{mode:"getAttDailyReportforDashboard"},function(response){Attendance.Dashboard.DailyReport.data=response,"ATT_DASH_SUMMARY"===widget?Attendance.Dashboard.DailyReport.buildDashSummHTML():Attendance.Dashboard.DailyReport.buildHTML()},{})}},buildDashSummHTML:function(){var report=Attendance.Dashboard.DailyReport.data.report,layout=Layout.Page.container.find("[name=ATT_DASH_SUMMARY]"),dateToShow=Attendance.Dashboard.DailyReport.getDateToShow(report.userDate),dashHead=layout.find(".dash-head");dashHead.find(".att_dsmry").remove(),dashHead.append('<div class="att_dsmry">'+dateToShow+"</div>");var dataHtml=layout.find("#ATT_DASH_SUMMARY");dataHtml.children().remove();var count=isNaN(report.usersCheckedIn)?0:report.usersCheckedIn,html='<div class="sum_crd"><div><span class="grn">'+count+"</span>"+ZPI18N.getString("zp.userscheckedin",new Array(""))+"</div></div>";html+='<div class="sum_crd"><div><span class="grn">'+(count=isNaN(report.userInStatusCount)?0:report.userInStatusCount)+"</span>"+ZPI18N.getString("zp.usersinside")+"</div></div>",html+='<div class="sum_crd"><div><span class="red">'+(count=isNaN(report.usersYetToCheckIn)?0:report.usersYetToCheckIn)+"</span>"+ZPI18N.getString("zp.usersyettocheckin",new Array(""))+"</div></div>",html+='<div class="sum_crd"><div><span class="leave-clr">'+(count=isNaN(report.leaveCount)?0:report.leaveCount)+"</span>"+ZPI18N.getString("zp.usersonpaidleave")+"</div></div>",html+='<div class="sum_crd"><div><span class="wkend-clr">'+(count=isNaN(report.weekendCount)?0:report.weekendCount)+"</span>"+ZPI18N.getString("zp.usersonweekend")+"</div></div>",html+='<div class="sum_crd"><div><span class="lop-clr">'+(count=isNaN(report.lop_leaveCount)?0:report.lop_leaveCount)+"</span>"+ZPI18N.getString("zp.usersonunpaidleave")+"</div></div>",html+='<div class="sum_crd"><div><span class="holiday-clr">'+(count=isNaN(report.holidayCount)?0:report.holidayCount)+"</span>"+ZPI18N.getString("zp.usersonholiday")+"</div></div>",html+='<div class="sum_crd"><div><span class="onduty-clr">'+(count=isNaN(report.ondutyCount)?0:report.ondutyCount)+"</span>"+ZPI18N.getString("zp.usersonduty")+"</div></div>",dataHtml.append(html)},getDateToShow:function(userDate){var temp=moment(userDate,dateFmt.toUpperCase())._d.toString();return temp.substring(0,3)+","+temp.substring(4,10)},buildHTML:function(){var data=Attendance.Dashboard.DailyReport.data,attBodyContent=Attendance.Dashboard.DailyReport.consAttReport(data);Attendance.Dashboard.consWidget("ATTENDANCEREPORT",attBodyContent);var currDate=Attendance.Dashboard.DailyReport.getDateToShow(data.report.userDate),rep=$(Attendance.Dashboard.pageLayout()).find('[name="ATTENDANCEREPORT"]');rep.find(".dash-title #attCurrDate").remove(),rep.find(".dash-title").append("<span id=attCurrDate>  ("+currDate+")</span>");var absents=data.report.absentCount,presents=data.report.presentCount,weekend=data.report.weekendCount,holiday=data.report.holidayCount,leave=data.report.leaveCount,onduty=data.report.ondutyCount,lop=data.report.lop_leaveCount,lists=(new Highcharts.Chart({chart:{renderTo:"ZPAtt_dashborad_dailyReport",type:"pie",plotShadow:!1,spacingBottom:0,spacingTop:0,spacingLeft:0,spacingRight:0,width:215,height:215},credits:{enabled:!1},title:{text:data.report.totalCount+"<br>"+ZPI18N.getString("zp.totalusers"),align:"center",verticalAlign:"middle",floating:!0,y:1},tooltip:{percentageDecimals:0,pointFormat:"{point.name} ,<b>{point.percentage:.2f}%</b>"},legend:{enabled:!1},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:30,dataLabels:{enabled:!1,formatter:function(){return this.point.name+","+this.point.y},style:{fontWeight:"normal",fontSize:"12px",fontFamily:"Verdana, sans-serif",color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"}}}},exporting:{enabled:!1},series:[{type:"pie",innerSize:"50%",data:[[ZPI18N.getString("zp.absent"),absents],[ZPI18N.getString("zp.holiday"),holiday],[ZPI18N.getString("zp.leavetype.paid")+" "+ZPI18N.getString("zp.leave"),leave],[ZPI18N.getString("zp.present"),presents],[ZPI18N.getString("zp.weekend"),weekend],[ZPI18N.getString("zp.onduty"),onduty],[ZPI18N.getString("zp.leavetype.unpaid")+" "+ZPI18N.getString("zp.leave"),lop]],colors:["#f0989a","#9cc6e5","#fccaa1","#b2d7ad","#ffe5a3","#b6a7d2","#e95b6d"]}]}),$(Attendance.Dashboard.pageLayout()).find("#ZPAtt_dashboard_dailyRep_list b"));lists.eq(0).html(data.report.totalCount),lists.eq(1).html(data.report.presentCount),lists.eq(2).html(data.report.ondutyCount),lists.eq(3).html(data.report.leaveCount),lists.eq(4).html(data.report.absentCount),lists.eq(5).html(data.report.lop_leaveCount),lists.eq(6).html(data.report.holidayCount),lists.eq(7).html(data.report.regWeekendCount),data.report.isStatWkndConfigForOrg&&(lists.eq(8).html(data.report.statWeekendCount),lists.eq(9).html(data.report.nonStatWeekendCount))},consAttReport:function(data){var html='<div class="pie-data" id="ZPAtt_dashborad_dailyReport" style="width: 250px; height: 250px; margin:20px 20px 0 20px; float:left;"></div>';return html+="<div></div>",html+='<ul class="rt" id="ZPAtt_dashboard_dailyRep_list"><li><div class="cod" style="background-color:#c5c5c5;"></div>'+ZPI18N.getString("zp.totalusers")+"<b></b></li>",html+='<li><div class="cod present-bg"></div>'+ZPI18N.getString("zp.present")+"<b></b></li>",html+='<li><div class="cod onduty-bg"></div>'+ZPI18N.getString("zp.onduty")+"<b></b></li>",html+='<li><div class="cod leave-bg"></div>'+ZPI18N.getString("zp.leavetype.paid")+" "+ZPI18N.getString("zp.leave")+"<b></b></li>",html+='<li><div class="cod absent-bg"></div>'+ZPI18N.getString("zp.absent")+"<b></b></li>",html+='<li><div class="cod lop-bg"></div>'+ZPI18N.getString("zp.leavetype.unpaid")+" "+ZPI18N.getString("zp.leave")+"<b></b></li>",html+='<li><div class="cod holiday-bg"></div>'+ZPI18N.getString("zp.holiday")+"<b></b></li>",html+='<li><div class="cod wkend-bg"></div>'+ZPI18N.getString("zp.weekend")+"<b></b></li>",data.report.isStatWkndConfigForOrg&&(html+='<li><div class="cod wkend-bg"></div>'+ZPI18N.getString("zp.statwknd")+"<b></b></li>",html+='<li><div class="cod wkend-bg"></div>'+ZPI18N.getString("zp.nonstatwknd")+"<b></b></li>"),html+="</ul>"}},Leave.Dashboard={},Leave.Dashboard.LeaveReport={get:function(){var params={key:"report_yearly",leaveyear:0};params.employee=erecno,params.repType="dashboard",ZPeople.Request.send(Leave.Report.url,params,function(response){Leave.Dashboard.LeaveReport.buildHTML(response.data.report[0],response.data.allowAdd)},{})},reportTemplate:'<div class="dash-col"><div class="dash-head"><i class="hicon IC-drag"></i><h3 class="dash-title"></h3></div><div class="dash-body"></div></div>',buildHTML:function(report,allowAdd){var reportHTML=$(Leave.Dashboard.LeaveReport.reportTemplate),ltypReports="";if(!report||_.isEmpty(report.leavetypes))ltypReports=ZPUtil.newNoDataHTML("CR-nodata-rpt","path6",ZPI18N.getString("zp.noreportsmsg"));else{ltypReports=$('<ul class="lclist"></ul>');report.leavetypes.forEach(function(leavetype,idx){var leaveunit=leavetype.isdayleave?" "+ZPI18N.getString("zp.days"):" "+ZPI18N.getString("zp.hours"),li=ZP.create("li"),taken=(ZP.optValue(leavetype,"allowed",0),ZP.optValue(leavetype,"taken",0)),available=ZP.optValue(leavetype,"available",0),circle=ZP.create("div",{class:"pie-circle progressElement zprogress zprogress--circle",id:"chart_"+idx,"data-toggle":"true","data-html":"true",title:"<ul class='Avdata'><li>"+ZPI18N.getString("zp.available")+" <span>"+available+"</span></li><li>"+ZPI18N.getString("zp.leave.view.taken")+" <span>"+taken+"</span></li></ul>","data-placement":"right"}),lrep=ZP.create("div",{class:"lvdetail"});lrep.appendChild(ZP.create("h6",{class:"lvname",text:ZPeople.decodeTxt(leavetype.name)})),2!=leavetype.type&&!leavetype.doNotDisplayBalance&&lrep.appendChild(ZP.create("span",{class:"lvavail",text:ZPI18N.getString("zp.available")+" "+available+leaveunit})),allowAdd&&2!=leavetype.type&&lrep.appendChild(ZP.create("i",{class:"IC-plus-round grn ZP-AddLeave"})),li.appendChild(circle),li.appendChild(ZP.create("span",{class:"circle_val",text:taken,style:"color:"+leavetype.dbcolor}));var chart_data=[];0==taken?chart_data.push({y:available>0?available:1,name:"Point2",color:"#DBDBDB"}):available<=0?chart_data.push({y:taken,name:"Point1",color:leavetype.dbcolor}):available>0&&taken>0&&(chart_data.push({y:taken,name:"Point1",color:leavetype.dbcolor}),chart_data.push({y:available,name:"Point2",color:"#DBDBDB"})),$(circle).highcharts({chart:{type:"pie",width:"40",height:"40",margin:[-30,-30,-30,-30]},plotOptions:{pie:{allowPointSelect:!1,size:"100%",dataLabels:{enabled:!1}},column:{pointPadding:0,borderWidth:0}},title:{enabled:!1,text:""},credits:{enabled:!1},tooltip:{enabled:!1},exporting:{enabled:!1},yAxis:{title:{text:"Total percent market share"}},series:[{data:chart_data,size:"30%",innerSize:"80%",dataLabels:{enabled:!1},states:{hover:{enabled:!1}}}]}),li.appendChild(lrep),$(circle).tooltip(),$(li).data("leavetypeid",leavetype.leavetypeid),$(li).find(".ZP-AddLeave").on("click",function(){var leavetype=$(this).parents("li").data("leavetypeid");new LeaveForm({initLeaveType:leavetype}).add()}),ltypReports.append(li)});var yearTxt=report.report_from+" - "+report.report_to;yearTxt=ZPI18N.getString("zp.leave.dashboard.leavechart",["Leave",yearTxt])}return ZPDashboard.Widget.show("LEAVEREPORT",ltypReports),reportHTML}},Leave.Dashboard.LeaveOnTodayReport={key:"report_ontoday",get:function(container,date){var params={key:Leave.Dashboard.LeaveOnTodayReport.key};ZPeople.Request.send(Leave.Report.url,params,function(response){Leave.Dashboard.LeaveOnTodayReport.buildHTML(response)},{})},buildHTML:function(response){if(void 0!=response.leavetype&&Object.keys(response.leavetype).length>0){var widObj=Layout.Page.container.find("[name=LEAVEONTODAY]"),html='<div class="empnLv_lst">',count=0;$.each(response.leavetype,function(key,val){html+='<div class="lvelst"><span class="LT'+val.leave_color+'"></span>'+ZSEC.Encoder.encodeForHTML(val.leave_name)+"</div>";var data=response.data[key];void 0!==data&&Object.keys(data).length>0&&$.each(data,function(ind,emp){count++,html+='<div class="zpusImg ZP-Employee"><img class="img-26" src="'+emp.empphoto+'"> <div class="zpusImg_nme"><span><b>'+ZSEC.Encoder.encodeForHTML(emp.emp_id)+" - </b>"+ZSEC.Encoder.encodeForHTML(emp.emp_name)+"</span></div> </div>"})}),html+="</div>",ZPDashboard.Widget.show("LEAVEONTODAY",html),widObj.find("#zpdash_widgetcnt").removeClass("DN").find("b").text(count)}else html=""+ZPUtil.newNoDataHTML(void 0,void 0,ZPI18N.getString("zp.widget.onleavetodaynodatamsg")),ZPDashboard.Widget.show("LEAVEONTODAY",html)}},Leave.Dashboard.DayLeaveReport={get:function(container,date){var params={key:Leave.Report.Day.key,display:0};params.date=date,ZPeople.Request.send(Leave.Report.url,params,function(response){var reportHTML=Leave.Dashboard.DayLeaveReport.buildHTML(response.data);container.append(reportHTML)},{})},reportTemplate:'<div class="dash-col"><div class="dash-head"><i class="hicon IC-drag"></i><h3 class="dash-title">Leave Activity</h3></div><div class="dash-body has-dashfoot"><div class="pie-data" style="width: 215px; height: 215px; margin: 0 auto"></div></div><div class="dash-footer"><ul class="ATdtlist"></ul></div></div>',buildHTML:function(count_arr){var reportHTML=$(Leave.Dashboard.DayLeaveReport.reportTemplate),chart_data=[],footer=$("<li></li>"),totalUsers=0;for(var indx in count_arr){var count_json=count_arr[indx],ltyp_div=ZP.create("div",{class:"ATdt",style:"border-color:"+count_json.leavetype_color});ltyp_div.appendChild(ZP.create("span",{text:count_json.noofusers,class:"Acount"})),ltyp_div.appendChild(ZP.create("span",{text:count_json.leavetype_name,class:"Atype"})),footer.append(ltyp_div),totalUsers+=count_json.noofusers,chart_data.push({y:count_json.noofusers,name:count_json.leavetype_name,color:count_json.leavetype_color})}return reportHTML.find(".dash-footer>ul").append(footer),reportHTML.find(".pie-data").highcharts({chart:{type:"pie",width:"400",height:"400",plotBackgroundColor:null,plotBorderWidth:0,plotShadow:!1,margin:[0,0,0,0],spacingTop:0,spacingBottom:0,spacingLeft:0,spacingRight:0},credits:{enabled:!1},title:{text:totalUsers+"<br> Total users",align:"center",verticalAlign:"middle",y:1},tooltip:{percentageDecimals:2,pointFormat:"{point.name} ,<b>{point.percentage:.2f}%</b>"},plotOptions:{pie:{size:"100%",dataLabels:{enabled:!1,distance:-30,style:{fontWeight:"bold",color:"white"}},startAngle:0,endAngle:360,center:["50%","50%"]}},exporting:{enabled:!1},series:[{type:"pie",name:"Browser share",innerSize:"50%",data:chart_data}]}),reportHTML}},Leave.Dashboard.Holiday={get:function(container){var params={method:"view",reqFor:"list_view",get_upcoming:!0,applicableFor:1};ZPeople.Request.send("listHolidays.zp",params,function(response){Leave.Dashboard.Holiday.buildHTML(response)},{})},hdayTemplate:'<div class="dash-col"><div class="dash-head"><i class="hicon IC-drag"></i><h3 class="dash-title"></h3></div><div class="dash-body"></div></div>',buildHTML:function(data){var hdayHTML=$(Leave.Dashboard.Holiday.hdayTemplate),holidays="";return _.isEmpty(data)?(holidays=ZPUtil.newNoDataHTML(),ZPDashboard.Widget.show("HOLIDAYLIST",holidays)):(holidays=$('<ul class="hdaylist"></ul>'),_.each(data,function(hday,idx){var daydetails=hday.daydetails;_.each(daydetails,function(detail){holidays.append(Leave.Dashboard.Holiday.getDataDiv(hday,detail)),detail.ishalfday?.5:1})}),ZPDashboard.Widget.show("HOLIDAYLIST",holidays.html())),hdayHTML},getDataDiv:function(hday,detail){var date=Calendar.parseDate(detail.dis_date,uidateFormat),li=ZP.create("li",{class:"hdaydiv"}),hdname=ZP.create("div",{class:"hdname MT8",text:ZPeople.decodeTxt(hday.name)}),hdate=ZP.create("div",{class:"hdate",text:date.getDate()+" - "+months[date.getMonth()]}),hdday=ZP.create("span",{text:daysFull[date.getDay()]}),homeDtls=ZPeople.Module.MODULE_DATA.home,holidayClassifyType=void 0!=hday.classificationType?hday.classificationType:0,restrictedHolidayName=void 0!=homeDtls?homeDtls.holiday.restrictedHolidayName:void 0;if(1===holidayClassifyType||2===holidayClassifyType){var hClassname=void 0!=hday.holidayClassificationName?hday.holidayClassificationName:"";""!=(hClassname=1===holidayClassifyType&&restrictedHolidayName?restrictedHolidayName:hClassname)&&hdname.appendChild(ZP.create("span",{text:"("+hClassname+")"}))}return hdate.appendChild(hdday),li.appendChild(hdname),li.appendChild(hdate),li}},Timetracker.Widgets={pageLayout:function(){return"admin-formslayout-widgets"!==Layout.Page.pageId?"#home-dashboard":"#admin-formslayout-widgets"},Timelogs:{totalLoggedHours:0,currentTimelogDate:null,getTimelogs:function(string_date){Timetracker.util.setUserErecno(erecno),Timetracker.generalSettings.getSyncTimesheetSettings();var layoutId=Layout.Page.container;Timetracker.timelogs.widgetLoaded&&0!==$(layoutId).find("#dashboardTimelogsNavBar").length?$(layoutId).find("#day"+Timetracker.Widgets.Timelogs.currentTimelogDate.getDate()).removeClass("sel"):ZPDashboard.Widget.show(Timetracker.constants.widgets.TIMELOGS,Timetracker.Widgets.Timelogs.getWeekTemplate()),$(layoutId).find("#dashboardTimelogs").html(ZPeople.LOADING_HTML),Timetracker.Widgets.Timelogs.currentTimelogDate=string_date?new Date(string_date):Calendar.getCurrentDate(),$(layoutId).find("#day"+Timetracker.Widgets.Timelogs.currentTimelogDate.getDate()).addClass("sel"),Timetracker.timelogs.widgetLoaded=!0;var params={mode:"getTimesheet",userErecNo:erecno,isTimerDetails:!0,jobId:0,projectId:0,clientId:0,approvalStatus:0,conreqcsr:csrfToken};params.fromDate=params.toDate=Calendar.formatDate(Timetracker.Widgets.Timelogs.currentTimelogDate),ZPeople.Request.send(Timetracker.constants.URL,params,function(resultData){var obj=Timetracker.Widgets.Timelogs.buildTimelogsHTML(resultData);void 0!=obj&&$(layoutId).find("#dashboardTimelogs").html(obj),$(layoutId).find("#dashboardTimelogs").scrollTop(0),$(layoutId).find("#dashTimelogTotalHours").html(ZPI18N.getString("zp.totalhours")+" <b>"+Calendar.minstohrs(Timetracker.Widgets.Timelogs.totalLoggedHours)+"</b>")})},getDashHeader:function(widget){return Timetracker.util.allowAddingTimelogs()?'<h3 class="dash-title">'+widget.name+' <i class="IC-plus-round S16 ML5 grn" id="addtimelogicon" onclick="Timetracker.timelogs.Operations.formAddEditView(null,null,null,true,true);"></i></h3><span class="cout" id="dashTimelogTotalHours">'+ZPI18N.getString("zp.totalhours")+"</span>":'<h3 class="dash-title">'+widget.name+' </h3><span class="cout" id="dashTimelogTotalHours">'+ZPI18N.getString("zp.totalhours")+"</span>"},getWeekTemplate:function(){var daysObject=[ZPI18N.getString("zp.sun"),ZPI18N.getString("zp.mon"),ZPI18N.getString("zp.tue"),ZPI18N.getString("zp.wed"),ZPI18N.getString("zp.thu"),ZPI18N.getString("zp.fri"),ZPI18N.getString("zp.sat")],currentWeek=Calendar.getCurrentWeekdays(),currentWeekNavBar='<div id="dashboardTimelogsNavBar"><ul class="Dnav">';for(var i in currentWeek)currentWeekNavBar+='<li id="day'+currentWeek[i].getDate()+'" onclick="Timetracker.Widgets.Timelogs.getTimelogs(\''+currentWeek[i]+"')\"><b>"+currentWeek[i].getDate()+"</b>"+daysObject[currentWeek[i].getDay()]+"</li>";return currentWeekNavBar+='</ul></div><div id="dashboardTimelogs" class="tlogscrl"></div>',$(currentWeekNavBar)},buildTimelogsHTML:function(response){var template;return Timetracker.Widgets.Timelogs.totalLoggedHours=0,response&&0!==response.length?(template=$("<tbody></tbody>"),$.each(response,function(index,data){Timetracker.Widgets.Timelogs.totalLoggedHours+=data.hours;var htmlTemplate='<tr id="dashTimelog'+data.timelogId+'">';htmlTemplate+=Timetracker.Widgets.Timelogs.constructSingleTimelogRow(data),htmlTemplate+="</tr>";var element=$(htmlTemplate);element.data("data",data),template.append(element)}),template=$('<table class="table table-hover"></table>').append(template)):(Timetracker.Util.showHideNoData({msg:ZPI18N.getString("zp.notimelogs"),div:Layout.Page.container.find("#TIMELOGS"),divId:"dashboardTimelogs"}),Timetracker.util.removeLoading(Layout.Page.container.find("#TIMELOGS"))),template},constructSingleTimelogRow:function(data){var singleRowHtml="";if(data.isEditAllowed?singleRowHtml+='<td class="CP" onclick="Timetracker.timelogs.Operations.formAddEditView(null,\''+data.timelogId+"',true);\">":singleRowHtml+="<td>",singleRowHtml+=data.jobName+"<span>",data.projectName&&(singleRowHtml+='<span class="timelg-dot">.</span>'+data.projectName),singleRowHtml+="</span></td>",!0===data.isCurrentlyRunning)singleRowHtml+='<td width="100"><span id="dashboard_timer">'+Calendar.minstohrs(data.hours)+"</span></td>";else{if(singleRowHtml+='<td width="100"><b',"1"===data.type||1===data.type)singleRowHtml+='data-placement="bottom" data-toggle="tooltip" data-original-title="'+(data.fromTimeInTimeFormat+"-"+data.toTimeInTimeFormat)+'"';singleRowHtml+='class="ZP_Font" >'+Calendar.minstohrs(data.hours)+"</b></td>"}if("2"===data.type)if(!0===data.isCurrentlyRunning){Timetracker.timelogs.currentTimerJobData||Timetracker.timelogs.timer.timerTime(data);var timerObj=data.timearr[data.timearr.length-1];singleRowHtml+='<td width="75"><img width="18" class="tymass CP S18" src="'+ZPeople.getResourceURL(newUIImageUrl+"timelog2.gif")+'" tId = "'+data.timelogId+'" timerId = "'+timerObj.timerId+'" onclick="Timetracker.timelogs.timer.pauseclock(this)"></img></td>'}else Calendar.equalsTo(Timetracker.Widgets.Timelogs.currentTimelogDate,Calendar.getCurrentDate())?singleRowHtml+='<td width="75"><i class="IC-player grn S18" tId = "'+data.timelogId+'" onclick="Timetracker.timelogs.timer.nextStart(this)"></i></td>':singleRowHtml+='<td width="75"></td>';else singleRowHtml+="<td></td>";return singleRowHtml}},Timesheets:{getTimesheetList:function(){Timetracker.util.setUserErecno(erecno),Timetracker.Widgets.FireScroll.resetFireScroll(Timetracker.constants.widgets.TIMESHEETS),Layout.Page.container.find('[name="TIMESHEETS"]').attr("triggered",!0),Layout.Page.container.find("#dashboardTimesheets").scrollTop(0);var params=Timetracker.Widgets.Timesheets.getParamsToFetchTimesheet();Layout.Page.container.find("#"+Timetracker.constants.widgets.TIMESHEETS).html(ZPeople.LOADING_HTML),ZPeople.Request.send(Timetracker.constants.URL,params,function(result){Timetracker.Widgets.Timesheets.buildTimesheetHTML(result)})},getParamsToFetchTimesheet:function(){var params={mode:"getTimesheetList",tslstatus:-3,tslerecno:erecno,isCountNeeded:!0,conreqcsr:csrfToken};return params.sIndex=Timetracker.Widgets.FireScroll.getFetchCount(Timetracker.constants.widgets.TIMESHEETS),params.limit=25,params},getDashHeader:function(widget){return'<h3 class="dash-title">'+widget.name+'</h3><span class="cout" id="dashTotalTimesheets"></span>'},buildTimesheetHTML:function(response){if(response&&response.timesheetArr&&0!==response.timesheetArr.length){var htmlTemplate=$('<table class="table table-hover" id="dashboardTimesheets"><tbody></tbody></table>');$.each(response.timesheetArr,function(index,data){var timesheetDiv=Timetracker.Widgets.Timesheets.constructTimesheetRow(data);htmlTemplate.find("tbody").append(timesheetDiv)}),ZPDashboard.Widget.show(Timetracker.constants.widgets.TIMESHEETS,htmlTemplate),Timetracker.Widgets.FireScroll.setFetchCount(Timetracker.constants.widgets.TIMESHEETS,response.timesheetArr.length),0!==response.timesheetCount&&Layout.Page.container.find("#dashTotalTimesheets").html("<b>"+response.timesheetCount+"</b>")}else Timetracker.util.appendEmptyData(ZPI18N.getString("zp.noreqsubmitted"),{widget:Timetracker.constants.widgets.TIMESHEETS,classname:"CR-tt-mysubmit",path:"path6"})},constructTimesheetRow:function(data){var htmlTemplate='<tr><td width="65">';return 0===data.status?htmlTemplate+='<i class="IC-r-close red S20"></i></td>':1===data.status?htmlTemplate+='<i class="IC-rou-tik grn S20"></i></td>':-1===data.status?htmlTemplate+='<i class="IC-rou-tik gry S20"></i></td>':htmlTemplate+='<i class="IC-draft gry S18"></i></td>',htmlTemplate+='<td><div class="zp-fdimg" title="'+data.timesheetName+'"><img src="'+data.userPhoto+'" class="Usrimglis" title="'+data.employeeName+'"><div class="CP" id="widgetTsheet">'+data.timesheetName+"</div></div></td>",data.fromDate===data.toDate?htmlTemplate+='<td width="100"><em>'+data.fromDate+"</em></td>":htmlTemplate+='<td width="100"><em>'+data.fromDate+" - "+data.toDate+"</em></td>",htmlTemplate+='<td width="100"><em><span>'+Calendar.minstohrs(data.totalHours)+"</span><br>"+ZPI18N.getString("zp.submittedhrs")+"</em></td>",htmlTemplate+='<td width="100"><em><span>'+Calendar.minstohrs(data.approvedTotalHours)+"</span><br>"+ZPI18N.getString("zp.approvedhrs")+"</em></td></tr>",(htmlTemplate=$(htmlTemplate)).find("#widgetTsheet").one("click",function(event){Timetracker.timesheet.getTimesheetDetails(data.formId,data.recordId)}),htmlTemplate},FireScroll:{loadMoreData:function(){var params=Timetracker.Widgets.Timesheets.getParamsToFetchTimesheet();ZPeople.Request.send(Timetracker.constants.URL,params,Timetracker.Widgets.Timesheets.FireScroll.constructFireScrollHTML)},constructFireScrollHTML:function(result,params){if(result&&result.timesheetArr){Timetracker.Widgets.FireScroll.setFetchCount(Timetracker.constants.widgets.TIMESHEETS,result.timesheetArr.length);var dashboardTimesheets=$("#"+Timetracker.constants.widgets.TIMESHEETS).find("table").find("tbody");$.each(result.timesheetArr,function(index,data){var timesheetDiv=Timetracker.Widgets.Timesheets.constructTimesheetRow(data);dashboardTimesheets.append(timesheetDiv)})}}}},PendingJobs:{getJobs:function(){Timetracker.util.setUserErecno(erecno),Timetracker.Widgets.FireScroll.resetFireScroll(Timetracker.constants.widgets.PENDINGJOBS);var params=Timetracker.Widgets.PendingJobs.getParamsToFetchPendingJobs();Layout.Page.container.find("#"+Timetracker.constants.widgets.PENDINGJOBS).html(ZPeople.LOADING_HTML),ZPeople.Request.send("/timesheetDispAction.zp",params,function(result){Timetracker.Widgets.PendingJobs.buildJobsWidgetHTML(params,result)})},getParamsToFetchPendingJobs:function(){var params={mode:"getSchedule",submode:"schedule",jobStatus:"0",projectId:"0",assignedBy:"0",assignedTo:erecno,fetchLoggedHrs:!0,conreqcsr:csrfToken};return params.sIndex=Timetracker.Widgets.FireScroll.getFetchCount(Timetracker.constants.widgets.PENDINGJOBS),params.limit=25,0===params.sIndex&&(params.getCurrentUserPendingJobCount=!0),params},getDashHeader:function(widget){return'<h3 class="dash-title">'+widget.name+'<i class="IC-plus-round S16 ML5 grn" onclick="Timetracker.jobs.Operations.formAddEditView();"></i></h3><span class="cout" id="dashTotalPendingJobs"></span>'},buildJobsWidgetHTML:function(params,response){if(response&&response.schArr&&0!==response.schArr.length){var htmlTemplate='<table class="table table-hover" id="dashboardPendingJobs"><tbody>';htmlTemplate+=Timetracker.Widgets.PendingJobs.constructJobRows(response.schArr),htmlTemplate+="</tbody></table>",ZPDashboard.Widget.show(Timetracker.constants.widgets.PENDINGJOBS,htmlTemplate),Timetracker.Widgets.FireScroll.setFetchCount(Timetracker.constants.widgets.PENDINGJOBS,response.schArr.length),response.jobCount&&0===params.sIndex&&(Layout.Page.container.find("#dashTotalPendingJobs").data("count",response.jobCount),Layout.Page.container.find("#dashTotalPendingJobs").html("<b>"+response.jobCount+"</b>"))}else Timetracker.util.appendEmptyData(ZPI18N.getString("zp.norec"),{widget:Timetracker.constants.widgets.PENDINGJOBS,classname:"CR-tt-jobs",path:"path6"})},constructJobRows:function(response){var htmlTemplate="";return $.each(response,function(index,data){data.projectId?htmlTemplate+='<tr id="dashboardJob'+data.jobId+'" projectId="'+data.projectId+'">':htmlTemplate+='<tr id="dashboardJob'+data.jobId+'">',htmlTemplate+='<td width="20"><i class="IC-rou-tik gry S20" onclick="Timetracker.jobs.Operations.changeJobStatus(\''+data.jobId+"',1,'"+data.owner+"',this)\"></i></td><td class=\"CP\" onclick=\"Timetracker.jobs.Operations.formAddEditView('','"+data.jobId+"',true)\">"+data.jobName+"</td>",data.fromDate?htmlTemplate+='<td width="100"><em>'+data.fromDate+"</em></td>":htmlTemplate+='<td width="100"><em>'+ZPI18N.getString("zp.nostartdate")+"</em></td>",data.toDate?htmlTemplate+='<td width="100"><em>'+data.toDate+"</em></td>":htmlTemplate+='<td width="100"><em>'+ZPI18N.getString("zp.noenddate")+"</em></td>",htmlTemplate+='<td width="120"><div class="Pjbs">';var totalmins,totalhrs;data.totalhours||(data.totalhours=0),totalmins=data.totalhours%60,totalhrs=(data.totalhours-totalmins)/60;var temppercent="width:0%";if(temppercent=0!==data.totalhours&&data.totalhours?void 0!==data.hours&&0===data.hours?"width:0%":void 0!==data.hours&&data.totalhours>=data.hours?"width:100%":void 0===data.hours&&void 0!==data.totalhours?"width:100%":"width:"+100*data.totalhours/data.hours+"%":"width:0%",htmlTemplate+="<div>"+totalhrs+ZPI18N.getString("zp.hrs")+" "+totalmins+ZPI18N.getString("zp.mins")+"</div>",htmlTemplate+='<div class="progress cust-bar"><div class="custom-progress-bar holiday-bg" style="left: 0%; '+temppercent+';"></div></div>',void 0!==data.hours){var mins=data.hours%60,hrs=(data.hours-mins)/60;htmlTemplate+='<span class="DB">'+hrs+ZPI18N.getString("zp.hrs")+" "+mins+ZPI18N.getString("zp.mins")+"</span>"}htmlTemplate+="</div></td></tr>"}),htmlTemplate},FireScroll:{loadMoreData:function(){var params=Timetracker.Widgets.PendingJobs.getParamsToFetchPendingJobs();ZPeople.Request.send("/timesheetDispAction.zp",params,Timetracker.Widgets.PendingJobs.FireScroll.constructFireScrollHTML)},constructFireScrollHTML:function(result,params){if(result&&result.schArr){Timetracker.Widgets.FireScroll.setFetchCount(Timetracker.constants.widgets.PENDINGJOBS,result.schArr.length);var rowsHtml=Timetracker.Widgets.PendingJobs.constructJobRows(result.schArr);$("#"+Timetracker.constants.widgets.PENDINGJOBS).find("table").append(rowsHtml)}}}},BillableNonBillable:{getTimelogData:function(){Timetracker.util.setUserErecno(erecno);var params={mode:"getTimesheet",userErecNo:erecno,conreqcsr:csrfToken},currentWeek=Calendar.getCurrentWeek();params.fromDate=Calendar.formatDate(currentWeek.from),params.toDate=Calendar.formatDate(currentWeek.to),ZPeople.Request.send(Timetracker.constants.URL,params,function(result){Timetracker.Widgets.BillableNonBillable.buildHTML(result)})},getDashHeader:function(widget){var currentWeek=Calendar.getCurrentWeek();return'<h3 class="dash-title">'+widget.name+" ("+Timetracker.timelogs.getDateinTSformat(currentWeek.from)+" - "+Timetracker.timelogs.getDateinTSformat(currentWeek.to)+")</h3>"},buildHTML:function(response){if(response&&0!==response.length){var arr=Timetracker.Widgets.BillableNonBillable.getValues(response),htmlTemplate='<div class="pie-data" id="BillableNonBillableChart" style="width: 250px; height: 250px; margin:0px 20px 0 20px; float:left;"></div><ul class="rt">';htmlTemplate+='<li><div class="cod" style="background-color:#40e2bb;"></div> '+ZPI18N.getString("zp.billable")+" <b>"+Calendar.minstohrs(arr[0][1])+" "+ZPI18N.getString("zp.hrs")+'</b></li><li><div class="cod" style="background-color:#ff6e70;"></div> '+ZPI18N.getString("zp.nonbillable")+" <b>"+Calendar.minstohrs(arr[1][1])+" "+ZPI18N.getString("zp.hrs")+"</b></li></ul>",ZPDashboard.Widget.show(Timetracker.constants.widgets.BILLABLE_NONBILLABLE,htmlTemplate);var centerTxt=Calendar.minstohrs(arr[0][1]+arr[1][1])+" <br>"+ZPI18N.getString("zp.totalhours");Timetracker.Widgets.BillableNonBillable.constructChart(arr,centerTxt)}else Timetracker.util.appendEmptyData(ZPI18N.getString("zp.noreportsyet"),{widget:Timetracker.constants.widgets.BILLABLE_NONBILLABLE,classname:"CR-nodata-rpt",path:"path6"})},getValues:function(response){var billableHours=0,nonBillableHours=0;$.each(response,function(index,data){0===data.billableStatus?billableHours+=data.hours:nonBillableHours+=data.hours});var arr=[];return arr[0]=new Array(ZPI18N.getString("zp.billable"),billableHours),arr[1]=new Array(ZPI18N.getString("zp.nonbillable"),nonBillableHours),arr},constructChart:function(arr,txt){new Highcharts.Chart({chart:{renderTo:"BillableNonBillableChart",type:"pie",plotShadow:!1,width:250,height:250},credits:{enabled:!1},title:{text:txt,align:"center",verticalAlign:"middle",y:0},tooltip:{percentageDecimals:0,pointFormat:"{point.name} ,<b>{point.percentage:.2f}%</b>"},legend:{enabled:!1},exporting:{enabled:!1},plotOptions:{pie:{allowPointSelect:!1,cursor:"pointer",dataLabels:{connectorWidth:0,enabled:!1},colors:["#40e2bb","#ff6e70"]}},series:[{type:"pie",data:arr,innerSize:"55%"}]})}},FireScroll:{MAX_FETCH_COUNT:{PENDINGJOBS:25,TIMESHEETS:25},FETCHED_DATA_COUNT:{PENDINGJOBS:0,TIMESHEETS:0},resetFireScroll:function(widgetName){widgetName&&(Timetracker.Widgets.FireScroll.FETCHED_DATA_COUNT[widgetName]=0,Layout.Page.container.find('[name="'+widgetName+'"]').removeAttr("triggered"))},setFetchCount:function(widgetName,count){void 0!=count&&widgetName&&(count===Timetracker.Widgets.FireScroll.MAX_FETCH_COUNT[widgetName]?Layout.Page.container.find('[name="'+widgetName+'"]').attr("triggered",!1):Layout.Page.container.find('[name="'+widgetName+'"]').attr("triggered",!0),Timetracker.Widgets.FireScroll.FETCHED_DATA_COUNT[widgetName]+=count)},getFetchCount:function(widgetName){return widgetName?0===Timetracker.Widgets.FireScroll.FETCHED_DATA_COUNT[widgetName]?Timetracker.Widgets.FireScroll.FETCHED_DATA_COUNT[widgetName]:Timetracker.Widgets.FireScroll.FETCHED_DATA_COUNT[widgetName]+1:0}}};var loginUserRoleCheck=-1,isreportingTo=!1,FILECABINET={COMPANY_FILE:"1",HR_FILE:"0",filesCnt:0,lastFileReqCnt:0,filesCntCF:0,filesCntHF:0,initCFcnt:0,initHFCnt:0,isMoreCompanyFiles:!0,isMoreHRFiles:!0,isCfCached:!1,isHrCached:!1,isGeoEnabled:!1,FILETYPE_HR:0,FILETYPE_COMPANY:1,Filestabname:[],dashBoardInit:function(data){var pageId=Layout.Page.container.find("div[name=FILES]");pageId.find(".dash-title").after(FILECABINET.constructHeaderHtml()),pageId.find("div#FILES").html(FILECABINET.constructBodyHtml()),FILECABINET.isHrCached=!1,FILECABINET.isCfCached=!1,FILECABINET.getFiles(FILECABINET.COMPANY_FILE),pageId.find("div#FILES").find("li#cf,li#hf").on("click",function(){FILECABINET.filesCnt=0;var fileType="cf"===$(this).attr("id")?FILECABINET.COMPANY_FILE:FILECABINET.HR_FILE;fileType===FILECABINET.COMPANY_FILE&&!0===FILECABINET.isCfCached&&(pageId.find("#cnt_box").find("b").text(FILECABINET.initCFcnt),pageId.find("ul#CF").show(),pageId.find("ul#HF").hide()),fileType===FILECABINET.HR_FILE&&(!0===FILECABINET.isHrCached?(pageId.find("#cnt_box").find("b").text(FILECABINET.initHFCnt),pageId.find("ul#HF").show(),pageId.find("ul#CF").hide()):(FILECABINET.getFiles(fileType),FILECABINET.showFilesCount(fileType)))});var fType=pageId.find("#cf").attr("class").indexOf("active")>-1?FILECABINET.COMPANY_FILE:FILECABINET.HR_FILE;FILECABINET.showFilesCount(fType)},constructHeaderHtml:function(){return'<span class="cout" id="cnt_box">'+ZPI18N.getString("zp.totalfiles")+"<b>0</b></span>"},constructBodyHtml:function(){var hrfiledisname=ZPI18N.getString("zp.newemployeefiles"),compdisname=ZPI18N.getString("zp.organizationfiles"),bodyHtml='<ul class="dash-tabs" role="tablist">',result=[],params={methodName:"getTabName",conreqcsr:csrfToken};return ZPeople.Request.sendAsyncPost("/fileCabinetAction.zp",params,function(resultData){result=resultData,$.each(result,function(idx,obj){Object.keys(obj)==FILECABINET.FILETYPE_HR?hrfiledisname=obj[Object.keys(obj)]:Object.keys(obj)==FILECABINET.FILETYPE_COMPANY&&(compdisname=obj[Object.keys(obj)])})}),bodyHtml+='<li class="active" id="cf" data-toggle="tab">'+ZSEC.Encoder.encodeForHTML(compdisname)+"</li>",bodyHtml+='<li class="" id="hf" data-toggle="tab">'+ZSEC.Encoder.encodeForHTML(hrfiledisname)+"</li>",bodyHtml+="</ul>",bodyHtml+='<div id="filesCont" class="tab-content">',bodyHtml+='<ul class="filelist tab-pane active" id="CF" onscroll="FILECABINET.getMoreFiles()">',bodyHtml+="</ul>",bodyHtml+='<ul class="filelist tab-pane active" id="HF" onscroll="FILECABINET.getMoreFiles()">',bodyHtml+="</ul>",bodyHtml+="</div>"},constructFilesResp:function(data,paramsObj,isScroll){var fileRows="",pageId=Layout.Page.container.find("div[name=FILES]"),mainPageId=paramsObj.fileType===FILECABINET.COMPANY_FILE?pageId.find("ul#CF"):pageId.find("ul#HF"),hideElm=paramsObj.fileType===FILECABINET.COMPANY_FILE?pageId.find("ul#HF"):pageId.find("ul#CF");if(pageId.find("div#FILES").find("div#PENDING_APPROVALS").remove(),paramsObj.fileType===FILECABINET.COMPANY_FILE?FILECABINET.isCfCached=!0:FILECABINET.isHrCached=!0,ZPSetupCommon.isEmpty(isScroll)&&mainPageId.html(""),data.hasOwnProperty("fail")){pageId.find("div#FILES").empty();new EmptyPages("zp_nd_georestrict",data.fail,"",pageId.find("div#FILES")).show()}else{if(void 0==data[1])return fileRows='<li class="listFiles text-center MT20 MB20"><p>'+ZPI18N.getString("zp.iprestricted")+"</p></li>",mainPageId.append(fileRows).show(),void hideElm.hide();data[1].length<24?paramsObj.fileType===FILECABINET.COMPANY_FILE?FILECABINET.isMoreCompanyFiles=!1:FILECABINET.isMoreHRFiles=!1:paramsObj.fileType===FILECABINET.COMPANY_FILE?FILECABINET.isMoreCompanyFiles=!0:FILECABINET.isMoreHRFiles=!0,data[1].length>0?($.each(data[1],function(index,obj){var fileIcon,fileExtn=obj.fileExtn,fileID=(obj.fileName,obj.fileID),filePath=obj.filePath,UploadSource=obj.UploadSource;fileExtn=FilesUtil.Page.getFileExtn(fileExtn,filePath,UploadSource);obj.fileExtn=fileExtn,fileIcon="pdf"===fileExtn?'<i class="IC-pdf MR5"></i>':"xls"===fileExtn||"xlsx"===fileExtn||"xlsm"===fileExtn||"sxc"===fileExtn||"ods"===fileExtn||"csv"===fileExtn||"tsv"===fileExtn?'<i class="IC-xls-new MR5"></i>':"htm"===fileExtn||"html"===fileExtn?'<i class="IC-code MR5"></i>':"doc"===fileExtn||"docx"===fileExtn||"sxw"===fileExtn||"odt"===fileExtn||"rtf"===fileExtn?'<i class="IC-doc MR5"></i>':"ppt"===fileExtn||"pps"===fileExtn||"odp"===fileExtn||"sxi"===fileExtn||"pptx"===fileExtn?'<i class="IC-ppt MR5"></i>':"zip"===fileExtn?'<i class="IC-zip MR5"></i>':"mp3"===fileExtn||"mp4a"===fileExtn||"wav"===fileExtn?'<i class="IC-mp3 MR5"></i>':"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn?'<i class="IC-jpg MR5"></i>':"workdrive"===fileExtn?'<i class="IC-wd MR5"></i>':'<i class="IC-doc MR5"></i>';var rowId="",mode="";paramsObj.fileType===FILECABINET.COMPANY_FILE?(rowId="companyfileTr_"+obj.fileID,mode="company"):(rowId="hrfileTr_"+obj.fileID,mode="hr"),fileRows='<li class="listFiles" id="'+rowId+'" fileId="'+obj.fileID+'" onmouseover="FILECABINET.isDownload(\''+rowId+"','"+mode+"')\"><a onclick=\"FILECABINET.showPreview(this,'"+rowId+"','"+mode+"','"+obj.filePath+"', 2)\">"+fileIcon+ZSEC.Encoder.encodeForHTML(obj.fileName)+'</a><i style="display:none;" class="CR-imprt zpl_cp dlod" onclick="FilesOperations.DownloadPrint.downloadFile(\''+fileID+"');\"></i></li>",(fileRows=$(fileRows)).data("ldata",obj),mainPageId.append(fileRows)}),FILECABINET.filesCnt=FILECABINET.filesCnt+data[1].length,FILECABINET.lastFileReqCnt=data[1].length,paramsObj.fileType===FILECABINET.COMPANY_FILE?FILECABINET.filesCntCF=FILECABINET.filesCntCF+data[1].length:FILECABINET.filesCntHF=FILECABINET.filesCntHF+data[1].length):0==mainPageId.find("li").length&&("true"==is5_0Enabled?ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nofiles"),pageId.find("div#FILES")):ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nofiles"),mainPageId)),mainPageId.show(),hideElm.hide()}},getFiles:function(fileType,isScroll){var params={methodName:"getAllFiles",fileType:fileType,filterBy:"my",start:isScroll?"1"===fileType?FILECABINET.filesCntCF+1:FILECABINET.filesCntHF+1:1,isDashBoard:!0,isFileSortDesc:!0};if("true"==is5_0Enabled&&(params.isFromModule=!0),isGeoEnabled&&"true"===doNeedToGetLocation){navigator.geolocation.getCurrentPosition(function(position){params.latitude=position.coords.latitude,params.longitude=position.coords.longitude,ZPeople.Request.send(Files.ACTION.URL,params,FILECABINET.constructFilesResp,params)},function(){ZPeople.Request.send(Files.ACTION.URL,params,FILECABINET.constructFilesResp,params)})}else ZPeople.Request.send(Files.ACTION.URL,params,FILECABINET.constructFilesResp,isScroll)},downloadFile:function(thisObj){var fileId=$(thisObj).closest("li").attr("fileId");if(isGeoEnabled&&"true"===doNeedToGetLocation){navigator.geolocation.getCurrentPosition(function(position){window.open("/people/download?fileId="+fileId+"&longitude="+position.coords.longitude+"&latitude="+position.coords.latitude)},function(){window.open("/people/download?fileId="+fileId)})}else window.open("/download?fileId="+fileId)},showFilesCount:function(fileType){ZPeople.Request.send(Files.ACTION.URL,{methodName:"filesCnt",fileType:fileType,start:"1"},FILECABINET.setFilesCnt)},setFilesCnt:function(filesCount){var pageId=Layout.Page.container.find("div[name=FILES]");(pageId.find("li#hf").attr("class").indexOf("active")>-1?FILECABINET.HR_FILE:FILECABINET.COMPANY_FILE)===FILECABINET.COMPANY_FILE?(FILECABINET.initCFcnt=filesCount[1].filesCount,pageId.find("#cnt_box").find("b").text(FILECABINET.initCFcnt)):(FILECABINET.initHFCnt=filesCount[1].filesCount,pageId.find("#cnt_box").find("b").text(FILECABINET.initHFCnt)),loginUserRoleCheck=filesCount[1].permission,isreportingTo=filesCount[1].isreportingTo},isDownload:function(fileId,mode){var data=Layout.Page.container.find("div[name=FILES]").find("#"+fileId).data().ldata;"hr"===mode?(-1!=loginUserRoleCheck||0===data.fileConfident&&data.fileOwnerID===erecno||isreportingTo&&1===data.isreportingTo)&&Layout.Page.container.find("div[name=FILES]").find("#"+fileId).find(".dlod").show():"company"===mode&&(-1==loginUserRoleCheck&&!0!==data.allowDownload||Layout.Page.container.find("div[name=FILES]").find("#"+fileId).find(".dlod").show())},isScrollEnd:function(){var pageId=Layout.Page.container.find("div[name=FILES]"),scrollContent=pageId.find("li#cf").attr("class").indexOf("active")>-1?pageId.find("ul#CF"):pageId.find("ul#HF");return scrollContent.prop("scrollTop")>0&&scrollContent.prop("scrollTop")+scrollContent.innerHeight()===scrollContent.prop("scrollHeight")},getMoreFiles:function(){var fileType=Layout.Page.container.find("div[name=FILES]").find("li#hf").attr("class").indexOf("active")>-1?FILECABINET.HR_FILE:FILECABINET.COMPANY_FILE;"1"===fileType?FILECABINET.isScrollEnd()&&FILECABINET.isMoreCompanyFiles&&FILECABINET.getFiles(fileType,!0):"0"===fileType&&FILECABINET.isScrollEnd()&&FILECABINET.isMoreHRFiles&&FILECABINET.getFiles(fileType,!0)},showPreview:function(obj,rowId,mode,filePath,type){"true"==is5_0Enabled?FilesOperations.Preview.initLightBox(obj):1===type?window.open(filePath):(Layout.Page.pageContWrapper.parent().prepend(Files.constructPreview(rowId,"DashBoard")),Files.viewFile(obj,mode,isGeoEnabled,doNeedToGetLocation))}},Files={newCategoryList:{},isTab:"",isIprestricted:!1,isGeorestricted:!1,isAllowGeo:!1,importWDarray:[],sharingOpts:{Entity:{},Department:{},Division:{},Unit:{},Location:{}},isOrgShareFetched:!1,settingsCurrentCatId:-1,settingsCatPath:{},compFilesBreadcrumb:{},allFileBreadcrumb:{},subFileBreadcrumb:{},myFileBreadcrumb:{},roleFileBreadcrumb:{},empListForFilesCnt:[],actEmpSearchObj:[],inactEmpSearchObj:[],logDisEmpSearchObj:[],subEmpSearchObj:[],allsubEmpSearchObj:[],isInactEmpInit:[!0,!0,!0],isLogDisEmpInit:[!0,!0,!0],isAllSubEmpInit:[!0,!0,!0],isSubEmpInit:[!0,!0,!0],isActEmpSearch:!0,isInactEmpSearch:!0,isLogDisEmpSearch:!0,isSubEmpSearch:!0,isAllSubEmpSearch:!0,previewFileData:[],previewVideoFType:["mov","wmv","flv","mpeg","mpg","mp4","webm","webmv","avi","vob","mkv"],compdisname:ZPI18N.getString("zp.organizationfiles"),addcompdisname:ZPI18N.getString("zp.addorganizationfiles"),editcompdisname:ZPI18N.getString("zp.editorganizationfiles"),hrfiledisname:ZPI18N.getString("zp.newemployeefiles"),addhrfiledisname:ZPI18N.getString("zp.addemployeefiles"),edithrfiledisname:ZPI18N.getString("zp.editemployeefiles"),orgListViewData:{Org:[0,!1,{},!1,"3",!0]},orgCatViewData:{Org:[0,!0,void 0,!1]},orgSubCatViewData:{Org:[0,!0,void 0,!1]},empListViewData:{All:[0,!1,{},!1,"3",!0],Sub:[0,!1,{},!1,"3",!0],My:[0,!1,{},!1,"3",!0],Role:[0,!1,{},!1,"3",!0]},empCatViewData:{All:[0,!0,void 0,!1],Sub:[0,!0,void 0,!1],My:[0,!0,void 0,!1],Role:[0,!0,void 0,!1]},empSubCatViewData:{All:[0,!0,void 0,!1],Sub:[0,!0,void 0,!1],My:[0,!0,void 0,!1],Role:[0,!0,void 0,!1]},persListViewData:{Pers:[0,!1,{},!1,"3",!0]},reportsData:{PF:[0,!0,{}],Ack:[0,!0,{}],AckDetails:[0,!0,-1]},settings:{Cat:[0,!0],SubCat:[0,!0]},keyPairIdJson:{system:{id:"system",dispVal:ZPI18N.getString("zp.users")}},ackPrv:{},udsParams:{fileId:"-1",fileVersion:""},isCachedCat:!1,employeeData:null,inactiveEmployeeData:null,roleData:{},allowDownload:null,Fname:null,Lname:null,empid:null,labelnameVsdispname:null,locationName_Arr:{},imgOrgHeight:800,esignimgOrgHeight:800,printFileId:null,isCachedCatList:!1,rowNum:"1",hrFilesRename:0,companyFilesRename:1,personalFilesAccessRoles:21,personalFilesAccessEmployees:22,personalFilesDeniedRoles:23,personalFilesDeniedEmployees:24,mailmergeAccess:28,empFilesAllReportees:30,isFolderViewDefault:31,persFilesCountPerUser:32,mailmergeAccesscheckbox:!1,companyFilesReport:!1,companyFileId:null,fromcompFilesReportPage:!1,previousUrl:null,mailmergeAccessVal:!1,deleteConfig:25,addConfig:26,updateConfig:27,fileNameforCR:"",isEsignatureAllowedFlag:null,orgStructureTagMap:{},hrDocumentList:!1,isMMTaddedCompFile:"",mmtempCompRid:"",cloudpickerFCID:null,IMPORT:{cancelnewCategory:function(){var mainObj=Layout.Page.container.find("div#import_hrfileDiv");mainObj.find("#cancel_hrCat_btn,#hrnewCategory,#new_hrCatDIV,#hrcategory_err").hide(),mainObj.find("input#hrnewCategory").next("span#errormsg").remove(),mainObj.find("#s2id_hrselect_Cat,#hrzp_add_Cat").show(),mainObj.find("#agrselect_Cat").select2("val","select")}},Geo:{position:null,blocked:"blocked",positionBlocked:function(){null===this.position&&(this.position=this.blocked)}},ACTION:{URL:"/fileCabinetAction.zp",PERSONAL_FILE:4,VIEW_FILE:3,HR_FILE:2,COMPANY_FILE:1},ackView:{header:'<div class="ZPack_hdr"><ul><li><b>'+ZPI18N.getString("zp.filename")+'</b><span id="ackFileName"></span></li><li><b>'+ZPI18N.getString("zp.totalacknowledgement")+'</b><span id="ackFileCount" class="red bld S16"></span></li></ul></div><div class="ZPack_accpt"><p><b id="ackTitle"></b></p><button id="ackSubmit" data-dismiss="modal" onclick="Files.Reports.addAcknowledgement(undefined,false,true);"class="btn btn-primary"></button></div><button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="Files.Reports.closeAckModal();"><span aria-hidden="true"><div class="IC-cls-1px red S21 CP"></div></span></button></div>',bodymainContent:'<div class="ZPListing"><div id="ackDetailListing" class="Scrcont" scroll="enabled"></div></div>'},loadTabName:function(fileType){if("1"===fileType&&Files.compdisname===ZPI18N.getString("zp.organizationfiles")||"0"===fileType&&Files.hrfiledisname===ZPI18N.getString("zp.newemployeefiles")){var formData=new FormData;formData.append("methodName","getDispName"),formData.append("conreqcsr",csrfToken),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){void 0!==resultData[1]&&resultData[1].length>0&&$.each(resultData[1],function(tabkey,tabvalue){tabvalue.hasOwnProperty(Files.companyFilesRename)&&"1"===fileType&&(Files.compdisname=tabvalue[Files.companyFilesRename],Files.addcompdisname=ZPI18N.getString("zp.add")+" "+Files.compdisname,Files.editcompdisname=ZPI18N.getString("zp.edit")+" "+Files.compdisname),tabvalue.hasOwnProperty(Files.hrFilesRename)&&"0"===fileType&&(Files.hrfiledisname=tabvalue[Files.hrFilesRename],Files.addhrfiledisname=ZPI18N.getString("zp.add")+" "+Files.hrfiledisname,Files.edithrfiledisname=ZPI18N.getString("zp.edit")+" "+Files.hrfiledisname),tabvalue.hasOwnProperty(Files.personalFilesAccessRoles)&&(Files.personalFilesAccessRolesVal=tabvalue[Files.personalFilesAccessRoles]),tabvalue.hasOwnProperty(Files.personalFilesAccessEmployees)&&(Files.personalFilesAccessEmployeesVal=tabvalue[Files.personalFilesAccessEmployees]),tabvalue.hasOwnProperty(Files.personalFilesDeniedRoles)&&(Files.employeeFilesDeniedRolesVal=tabvalue[Files.personalFilesDeniedRoles]),tabvalue.hasOwnProperty(Files.personalFilesDeniedEmployees)&&(Files.employeeFilesDeniedEmployeesVal=tabvalue[Files.personalFilesDeniedEmployees])})}})}-1===Layout.Page.hash.indexOf("files/companyfile/view")&&Layout.Page.container.find("#addCompany_Bar").find(".bc").find("span").html(ZSEC.Encoder.encodeForHTML(Files.compdisname)),Layout.Page.container.find("#companyCatView").find(".bc").find("span").html(ZSEC.Encoder.encodeForHTML(Files.compdisname)),Layout.Page.container.find("#import_hrfileDiv").find("#addFile_header").html(ZSEC.Encoder.encodeForHTML(ZPI18N.getString("zp.import")+" "+Files.hrfiledisname)),"0"===fileType&&(Layout.Page.container.find("#filterEntity").html(ZPeople.orgStructureDispNameMap.entity),Layout.Page.container.find("#filterUnit").html(ZPeople.orgStructureDispNameMap.unit),Layout.Page.container.find("#filterDivision").html(ZPeople.orgStructureDispNameMap.division),Layout.Page.container.find("#filterDept").html(ZPeople.orgStructureDispNameMap.department))},isFilesPreviewEnabled:function(mode){var filePath=Files.previewFileData[1];return!(1!=isPreviewAllowed_Files&&!ZPeople.IsNumeric(filePath)||"Forms"==mode)},isViewZBasedFile:function(fileName,mode){return Layout.Page.hash.indexOf("#files/hrdocuments/listview")>-1&&"hr"==mode&&"docx"==fileName||!(Layout.Page.hash.indexOf("#files/hrdocuments/listview")>-1&&"hrdocPdf"==mode)&&(-1!=fileName.lastIndexOf(".")&&(fileName=(fileName=fileName.substr(fileName.lastIndexOf(".")+1,fileName.length)).toLowerCase()),("xls"===fileName||"xlsx"===fileName||"xlsm"===fileName||"sxc"===fileName||"ods"===fileName||"csv"===fileName||"tsv"===fileName||"sxw"===fileName||"odp"===fileName||"sxi"===fileName||"doc"===fileName||"docx"===fileName||"odt"===fileName||"rtf"===fileName||"ppt"===fileName||"pps"===fileName||"pptx"===fileName)&&("doc"!==fileName&&"docx"!==fileName&&"odt"!==fileName&&"rtf"!==fileName&&"ppt"!==fileName&&"pps"!==fileName&&"pptx"!==fileName||(null!=isPreviewAllowed&&void 0!=isPreviewAllowed&&0!=isPreviewAllowed||"Forms"!==mode)&&(!Files.isFilesPreviewEnabled(mode)||"Forms"===mode)))},viewFile:function(obj,mode,fileParams){var data=[],fileId="",filePath="";if("feed"==mode||"onboarding"==mode)1==(data=obj).fileType?mode="company":0==data.fileType&&(mode="hr");else if("Forms"==mode){fileParams=JSON.parse(decodeURIComponent(fileParams));var fileName=$(obj).attr("filename");filePath=$(obj).attr("filepath"),fileId=null!=fileParams.impId&&void 0!=fileParams.impId?filePath:-1==filePath.indexOf("_")?fileParams.fcId+"z"+filePath:fileParams.formId+"z"+fileParams.recordId+"z"+fileParams.fcId,data={allowDownload:!0,fileConfident:0,fileID:fileId,fileName:fileName,filePath:filePath},fileParams.hasOwnProperty("fileId")&&(data.fileUploadId=fileParams.fileId)}else data=Layout.Page.container.find(obj).parent().data().ldata;filePath=data.filePath,fileId=data.fileID,5==data.fileType&&""!=Files.mmtempCompRid&&(filePath=Files.mmtempCompRid,Layout.Page.container.find(obj).parent().data().ldata.filePath=Files.mmtempCompRid),Files.previewFileData[0]=fileId,Files.previewFileData[1]=filePath,Files.allowDownload=data.allowDownload,Files.printFileId=fileId;var fileDownload=data.fileConfident;fileName=filePath;if("Forms"!=mode&&5!=data.fileType||(fileName=data.fileName),null==fileName||""==fileName||void 0==fileName||"undefined"==fileName)fileName=data.fileName;else{fileName=-1!=fileName.lastIndexOf(".")||-1!=fileName.lastIndexOf(".")?(fileName=fileName.substr(fileName.lastIndexOf(".")+1,fileName.length)).toLowerCase():"Forms"!==mode&&ZPeople.IsNumeric(filePath)?data.fileExtn.toLowerCase():"";var pageId="";if(pageId="onboarding"==mode?Layout.Page.container:Layout.Page.pageContWrapper.parent(),5==data.fileType&&"hrdocPdf"==mode&&(fileName="pdf"),null!=fileName&&""!=fileName&&void 0!=fileName){$("#viewFileFrame").attr("src",""),$("#viewFileFrame").height(" "),pageId.find("#viewPreviewFileDiv").removeClass("DN"),pageId.find("#freeze").show(),0===pageId.find("#viewPreviewFileDiv,.content-pv").find("#zp_page_loading").length&&("xls"===fileName||"xlsx"===fileName||"xlsm"===fileName||"sxc"===fileName||"ods"===fileName||"csv"===fileName||"tsv"===fileName||"doc"===fileName||"docx"===fileName||"sxw"===fileName||"odt"===fileName||"rtf"===fileName||"ppt"===fileName||"pps"===fileName||"odp"===fileName||"sxi"===fileName||"pptx"===fileName?$(ZPeople.LOADING_HTML).insertBefore(pageId.find(".content-body")):"jpg"===fileName||"jpeg"===fileName||"gif"===fileName||"png"===fileName||"pdf"===fileName?pageId.find(".content-pv").append(ZPeople.LOADING_HTML):pageId.find("#viewPreviewFileDiv").find("#preview_body").addClass("pv-txt"));if($(window.document).find("#viewPreviewFileDiv").height($(window).height()+"px"),pageId.find("#viewPreviewFileDiv").is(":visible")){var contentpv="";$(window).on("resize",function(){$(window.document).find("#viewPreviewFileDiv").height($(window).height()+"px"),$(window.document).find("#viewFileFrame").height($("#viewPreviewFileDiv").height()-110+"px"),0!=$(window.document).find("#imageviewFrame").length&&((contentpv=$(window.document).find("#imageviewFrame").parent()).css("max-height",$("#viewPreviewFileDiv").height()-60+"px"),contentpv.css("max-width",$("#viewPreviewFileDiv").width()-300+"px"))})}if("Forms"==mode)if(pageId.find("i[id=filePrint]").hide(),Files.isViewZBasedFile(fileName,mode)){fileParams.portalId=_LOGGEDIN_ACCZSOID,fileParams.moduleName="Forms",delete fileParams.original;var params="mode=viewZBasedFile&fileId="+fileId+"&"+csrfParamName+"="+csrfToken+"&cli-msg="+encodeURIComponent(btoa(JSON.stringify(fileParams)));ZPeople.Request.send(ZPForm.URL,params,this.viewFileCallBack,mode)}else data.hasOwnProperty("fileUploadId")&&(fileParams.fileUploadId=data.fileUploadId),fileParams.fileId=fileId,Files.foundLocation("",3,fileParams,mode,void 0,fileName);else setTimeout(function(){if(Files.isViewZBasedFile(fileName,mode)){pageId.find("i[id=filePrint]").hide();var params="methodName=viewZBasedFile&fileId="+fileId+"&"+csrfParamName+"="+csrfToken,pageLoaded=!1,isBlocked=!1;isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position?(navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position,Files.foundLocation(position,3,params,mode,"",fileName)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.foundLocation("block",3,params,mode,"",fileName)}),pageId.find("div#viewPreviewFileDiv").on("click",function(){Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||(pageLoaded=!0,Files.foundLocation("",3,params,mode,"",fileName))})):(Files.setLatitudeLongitude(params),Files.foundLocation("",3,params,mode,"",fileName))}else{!1===data.allowDownload&&1==fileDownload?pageId.find("i[id=filePrint]").hide():pageId.find("i[id=filePrint]").show(),params=fileId,"4"==data.fileType&&-1==data.filePath.indexOf("Document")&&-1==data.filePath.indexOf("FileCabinet")&&((params=[]).fileType="4",params.fileId=data.fileId,params.filePath=ZPeople.getResourceURL(pdfUrl+data.filePath));pageLoaded=!1,isBlocked=!1;isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position?(navigator.geolocation.getCurrentPosition(function(position){Files.Geo.position=position,pageLoaded=!0,Files.foundLocation(position,3,params,mode,fileName,fileDownload,data.fileName,data.filePath)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.foundLocation("block",3,params,mode,fileName,fileDownload,data.fileName,data.filePath)}),pageId.find("div#viewPreviewFileDiv").on("click",function(){"hrdocPdf"==mode&&pageId.find("#add_hrdocInnerDivLoading").html(ZPeople.LOADING_HTML),Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||(pageLoaded=!0,Files.foundLocation("",3,params,mode,fileName,fileDownload,data.fileName,data.filePath))})):(Files.setLatitudeLongitude(params),Files.foundLocation("",3,params,mode,"",fileName,fileDownload,data.fileName,data.filePath))}},1e3)}else{var url="/download?fileId="+fileId;"undefined"!=contextPath&&"null"!=contextPath&&(url="/"+contextPath+url),window.open("/people"+url)}}},viewFileCallBack:function(resultData,params,mode){Layout.Page.container.find("#zp_page_loading").remove(),resultData.hasOwnProperty("fail")?ZPeople.Message.showFailureMsg(resultData.fail):$.each(resultData[1],function(index,data){var url;url="writer"===data.fileforformat?(url=data.url.replace("<script language='javascript'>window.location.href='","")).replace("';<\/script>",""):data.url,Files.setUrlIframeToViewFile(url,mode)})},setUrlIframeToViewFile:function(url,mode,fileExtn){$(".content-pv").find("#zp_page_loading").remove(),url.startsWith("https:")||"undefined"==contextPath||"null"==contextPath||url.startsWith("/"+contextPath)||(url="/"+contextPath+url),"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn?($("#imageviewFrame").attr("src",url),$("#imageviewFrame").off("load"),$("#imageviewFrame").on("load",function(){Files.imgOrgHeight=$("#imageviewFrame").height(),Preview.imgOrgHeight=$("#imageviewFrame").height()})):($("#viewFileFrame").attr("src",url),$(window.document).find("#viewFileFrame").height($("#viewPreviewFileDiv").height()-120+"px"))},constructHeaderFooterForPreview:function(identifier,mode,fileParams){var fileType,data="",fileId="",filePath="",fileExtn="",viewFileDiv="",sharedTo="",aggId="";if("ESign"==mode)data=identifier;else if("DashBoard"===mode)data=Layout.Page.container.find("div[name=FILES]").find("#"+identifier).data().ldata;else if("Feeds"===mode)data=Files.getFileDetailsForFeeds(identifier+"");else if("Forms"===mode){fileParams=JSON.parse(decodeURIComponent(fileParams));var fileName=ZSEC.Encoder.encodeForHTML($(identifier).attr("filename"));data={allowDownload:!0,fileConfident:0,fileID:fileId=-1==(filePath=$(identifier).attr("filepath")).indexOf("_")?fileParams.fcId+"z"+filePath:fileParams.formId+"z"+fileParams.recordId+"z"+fileParams.fcId,fileName:fileName,filePath:filePath}}else data="HRCase"==mode?fileParams:"zp_offboarding"==mode?fileParams:Layout.Page.container.find("#"+identifier).data().ldata;if(fileId=data.fileID,fileExtn=(filePath=data.filePath).substr(filePath.lastIndexOf(".")+1,filePath.length),"Forms"!==mode&&"Esign"!==mode&&(ZPeople.IsNumeric(filePath)&&(fileExtn=data.fileExtn.toLowerCase()),-1!=filePath.indexOf("_signed")&&filePath.indexOf("_signed")>=-1&&-1!=filePath.lastIndexOf(".")&&(fileExtn=(fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length)).toLowerCase())),fileType=data.fileType,data.allowDownload,viewFileDiv="",sharedTo="","ESign"==mode&&(aggId=data.aggId),viewFileDiv+="<div class='content-box cbmodal' id='viewPreviewFileDiv' fileId='"+data.fileID+"' style='display:block;'>",viewFileDiv+="<div class='content-header'>",viewFileDiv+="<h6 class='addPopTitle'id='viewfileHeader'>"+data.fileName+"</h6>",viewFileDiv+="<button aria-label='Close' data-dismiss='modal' class='close' type='button' onclick='Files.closeDiv()'><span aria-hidden='true'><div class='IC-cls S18 CP'></div></span></button></div>",viewFileDiv+="<div id='preview_body' class='content-body'></div>",viewFileDiv+="<div id='preview_footer' class='content-footer'>",viewFileDiv+="<div id='moreActions' class='actions'>","Forms"===mode){viewFileDiv+="<div class='dropdown FL PR ZPCusDrs ZPPdrop cust-dm'>",viewFileDiv+="<div class='dropdown-menu ZPCmn-Arrow bottom gray TBDD'>";var info="<li><span>"+ZPI18N.getString("zp.type")+"</span><em>"+fileExtn+"</em></li>";if("2"!=fileType){if(void 0==data.fileOwnerName&&void 0==data.fileRoleName&&void 0==data.fileLocationName?sharedTo="<em>"+ZPI18N.getString("zp.all")+"</em>":data.fileOwnerName?sharedTo="<em>"+ZPeople.escapeHtml(ZPeople.decodeTxt(data.fileOwnerName))+"</em>":data.fileRoleName?sharedTo=data.fileRoleNameNew.length>1?Files.getSharedToForPreview(data.fileRoleNameNew):"<em>"+ZPeople.escapeHtml(ZPeople.decodeTxt(data.fileRoleNameNew))+"</em>":data.fileLocationName&&(sharedTo=data.fileLocationNameNew.length>1?Files.getSharedToForPreview(data.fileLocationNameNew):"<em>"+ZPeople.escapeHtml(ZPeople.decodeTxt(data.fileLocationName))+"</em>"),"ESign"!==mode){var Category="";Category=data.fileCatNameNew&&data.fileCatNameNew.length>1?Files.getSharedToForPreview(data.fileCatNameNew):"<em>"+data.fileCatName+"</em>"}"ESign"!==mode&&("1"==fileType?info+="<li><span>"+ZPI18N.getString("zp.location")+"</span>"+sharedTo+"</li>":"0"==fileType&&(info+="<li><span>"+ZPI18N.getString("zp.sharedto",new Array(""))+"</span>"+sharedTo+"</li>"),info+="<li><span>"+ZPI18N.getString("zp.folder")+"</span>"+Category+"</li>")}info+="<li><span>"+ZPI18N.getString("zp.owner")+"</span><em>"+ZPeople.escapeHtml(ZPeople.decodeTxt(data.fileCreateByName))+"</em></li>",info+="ESign"==mode?"<li><span>Sent Date</span><em>"+data.fileDate+"</em></li>":"<li><span>"+ZPI18N.getString("zp.filemodified",new Array(""))+"</span><em>"+data.fileModifiedDate+"</em></li>",null!==data.fileDesc&&void 0!==data.fileDesc&&""!==data.fileDesc&&(info+="<li><span>"+ZPI18N.getString("zp.description")+"</span><em>"+ZPeople.escapeHtml(data.fileDesc)+"</em></li>"),viewFileDiv+="<ul>"+info+"</ul></div></div>"}"ESign"==mode?(viewFileDiv+='<i class="CR-imprt" onclick=Agreements.downloadAttachement(this,"'+aggId+'","download","'+encodeURIComponent(data.fileName)+'","'+encodeURIComponent(data.filePath)+'")></i>',viewFileDiv+='<i id="filePrint" class="IC-print" onclick="Files.printFile()"></i>'):"hr"==mode&&"4"==data.fileType&&-1==data.filePath.indexOf("Document")&&-1==data.filePath.indexOf("FileCabinet")?(viewFileDiv+='<i class="CR-imprt" onclick=Files.downloadCompHandbook("'+fileId+'")></i>',viewFileDiv+='<i id="filePrint" class="IC-print" onclick="Files.printFile()"></i>'):"Forms"===mode?(viewFileDiv+='<i class="CR-imprt" onclick="window.open(\''+ZPForm.constructDownloadLink(fileParams)+"');\"></i>",viewFileDiv+='<i id="filePrint" class="IC-print" onclick="Files.printFile()"></i>'):"HRCase"===mode?viewFileDiv+='<i class="CR-imprt" onclick="casesFiles.getFileDownload(event,\''+data.fileId+"','"+data.recordId+"','"+data.fType+"',"+data.hasOwnProperty("previewFileId")+')"></i>':"zp_offboarding"==mode?(viewFileDiv+='<i class="CR-imprt" onclick=Files.downloadFilecabinet(\'html\',"'+fileId+'", "'+encodeURIComponent(data.filePath)+'", "'+encodeURIComponent(data.fileName)+'")></i>',viewFileDiv+='<i id="filePrint" class="IC-print" onclick="Files.printFile()"></i>'):"0"!=fileType&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||void 0!=data.fileRoleName)&&!0!==data.allowDownload||(viewFileDiv+='<i class="CR-imprt" onclick=Files.downloadFilecabinet(\'html\',"'+fileId+'", "'+encodeURIComponent(data.filePath)+'", "'+encodeURIComponent(data.fileName)+'")></i>',viewFileDiv+='<i id="filePrint" class="IC-print" onclick="Files.printFile()"></i>'),viewFileDiv+="</div></div>",$("#page-wrapper").append(viewFileDiv)},constructViewDiv:function(identifier,mode,fileParams){if($("#wrapper").addClass("ZPMprw"),0===$("#page-wrapper").find("#viewPreviewFileDiv").length){Files.constructHeaderFooterForPreview(identifier,mode,fileParams);var data=[];if("ESign"==mode)data=identifier;else if("DashBoard"===mode)data=Layout.Page.container.find("div[name=FILES]").find("#"+identifier).data().ldata;else if("Feeds"===mode)data=Files.getFileDetailsForFeeds(identifier+"");else if("Forms"===mode){fileParams=JSON.parse(decodeURIComponent(fileParams));var fileName=$(identifier).attr("filename"),filePath=$(identifier).attr("filepath");data={allowDownload:!0,fileConfident:0,fileID:-1==filePath.indexOf("_")?fileParams.fcId+"z"+filePath:fileParams.formId+"z"+fileParams.recordId+"z"+fileParams.fcId,fileName:fileName,filePath:filePath,fileType:0}}else data="HRCase"===mode?fileParams:"zp_offboarding"==mode?fileParams:Layout.Page.container.find("#"+identifier).data().ldata;data.fileType;$("#preview_body").html("<iframe  src='' id='viewFileFrame' name='viewFileFrame' scrolling='auto' style='border: none; margin: 0pt;' frameborder='0' height='0' scrolling='no' width='100%' ></iframe>")}else Layout.Page.pageContWrapper.parent().find("#viewPreviewFileDiv").css("display","block")},constructImageDiv:function(identifier,mode,fileParams){if($("#wrapper").addClass("ZPMprw"),0===$("#page-wrapper").find("#viewPreviewFileDiv").length){Files.constructHeaderFooterForPreview(identifier,mode,fileParams);var constructBody="<div class='content-pv' style='max-height: 610px; max-width: 1265px; border: 1px solid #fff; color: #fff;'>";constructBody+="<img src='' id='imageviewFrame' name='imageviewFrame' scrolling='auto' style='position:relative;max-height: 610px; max-width: 1265px;'/>",$("#preview_body").html(constructBody);var footer="<div class='cf-zoom'>";footer+="<span><i class='IC-mins'></i><em class='DB'>0%</em></span>",footer+="<div><input  id='zoomRange' class='inputRange' type='range' min='0' max='200' value='0' oninput=Files.zoomFile('"+mode+"')><em id='zoomval' class='DB'>0%</em></div>",footer+="<span><i class='IC-plus-big'></i><em class='DB'>200%</em></span></div>",$("#preview_footer").prepend(footer),$("#moreActions").prepend('<i id="magnify_files" class="CR-magnifier" onclick="Files.magnifyFileView()"></i>')}else Layout.Page.pageContWrapper.parent().find("#viewPreviewFileDiv").css("display","block")},getvalues:function(jsonData){var data="";if(null!=jsonData&&Object.keys(jsonData).length>0){var keys=Object.keys(jsonData);for(var i in keys)i!==(data+=jsonData[keys[i]]).length-1&&(data+=",")}return data},constructPreview:function(identifier,mode){var data="";if("DashBoard"===mode)data=Layout.Page.container.find("div[name=FILES]").find("#"+identifier).data().ldata;else if("Feeds"===mode){if(("string"==typeof(data=Files.getFileDetailsForFeeds(identifier+""))||data instanceof String)&&data.indexOf("Don't have permission to view the File")>-1)return}else data="Onboarding"===mode?identifier:Layout.Page.container.find("#"+identifier).data().ldata;var previewData={};if(previewData.fileId=data.fileID+"",previewData.fileName=ZPeople.escapeHtml(ZPeople.decodeTxt(data.fileName)),previewData.filePath=data.filePath,"Onboarding"!=mode){var sharedTo,fileType=data.fileType,filePath=data.filePath,fileName=data.fileName;"4"!=fileType&&"5"!=fileType||(fileName=fileName.substr(0,fileName.lastIndexOf(".")),"5"==fileType&&""!=Files.mmtempCompRid&&(Layout.Page.container.find("#"+identifier).data().ldata.filePath=Files.mmtempCompRid,filePath=Files.mmtempCompRid)),sharedTo=ZPI18N.getString("zp.sharedto",new Array(""));var fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length);ZPeople.IsNumeric(filePath)?(fileExtn=data.fileExtn.toLowerCase(),previewData.fileExtn=fileExtn.toLowerCase()):fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length),-1!=filePath.indexOf("_signed")&&filePath.indexOf("_signed")>=-1&&-1!=filePath.lastIndexOf(".")&&(fileExtn=(fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length)).toLowerCase()),"5"==fileType&&(fileExtn="docx",previewData.fileType=data.fileType),"4"==fileType&&(previewData.fileType=data.fileType);var info={};if(info[ZPI18N.getString("zp.type")]=ZPeople.escapeHtml(fileExtn),"2"!=fileType){if("1"===fileType){if(!isOrgStructureEnabled)if(void 0==data.fileOwnerName&&void 0==data.fileRoleName&&void 0==data.fileLocationName&&void 0==data.fileDepartmentName)info[sharedTo]=ZPI18N.getString("zp.all");else{var nodes="";if(data.fileLocationName&&0==Object.keys(data.fileLocationName).length&&data.fileDepartmentName&&0==Object.keys(data.fileDepartmentName).length)nodes+=ZPI18N.getString("zp.all");else{var tempData=Object.assign(data.fileLocationName,data.fileDepartmentName),nodeStr=Files.getvalues(tempData);nodes=nodeStr.length>1?Files.getSharedToForPreview(nodeStr):ZPeople.escapeHtml(ZPeople.decodeTxt(nodeStr))}info[sharedTo]=nodes}}else if("5"==fileType||"4"==fileType)info[ZPI18N.getString("zp.owner")]=ZPeople.escapeHtml("System");else if(data.fileOwnerName)info[sharedTo]=ZPeople.escapeHtml(ZPeople.decodeTxt(data.fileOwnerName));else if(data.fileRoleName){var roleName="";roleName=data.fileRoleNameNew.length>1?Files.getSharedToForPreview(data.fileRoleNameNew):ZPeople.escapeHtml(ZPeople.decodeTxt(data.fileRoleNameNew)),info[sharedTo]=roleName}info[ZPI18N.getString("zp.folder")]=data.fileCatNameNew}"5"!=fileType&&"4"!=fileType&&(info[ZPI18N.getString("zp.owner")]=ZPeople.escapeHtml(ZPeople.decodeTxt(data.fileCreateByName))),info[ZPI18N.getString("zp.filemodified",new Array(""))]=data.fileModifiedDate,"0"==fileType?(-1!=loginUserRoleCheck&&void 0==data.fileRoleName||0===data.fileConfident&&void 0!==data.fileOwnerName&&data.fileOwnerID===erecno||void 0!==data.fileRoleName&&(0===data.fileConfident||0==loginUserRoleCheck||1==loginUserRoleCheck)||void 0!==isreportingTo&&!0===isreportingTo&&1===data.isreportingTo)&&(previewData.allowDownload=!0,previewData.allowPrint=!0):"0"!=loginUserRoleCheck&&"1"!=loginUserRoleCheck&&!0!==data.allowDownload||(previewData.allowDownload=!0,previewData.allowPrint=!0),null!==data.fileDesc&&void 0!==data.fileDesc&&""!==data.fileDesc&&(info[ZPI18N.getString("zp.description")]=ZPeople.decodeTxt(data.fileDesc)),previewData.info=info,"1"!=fileType&&"0"!=fileType||(previewData.fileAcknowledge=data.fileAcknowledge,previewData.isLoginUserAck=data.isLoginUserAck,previewData.fileType=fileType,previewData.isEmpFileAck=data.isEmpFileAck,previewData.fileOwner=data.fileOwnerID,"Feeds"===mode&&(previewData.isFeeds=!0,previewData.isUserSharedNodeCheck=data.isUserSharedNodeCheck))}else if("0"!=fileType||"0"!=loginUserRoleCheck&&"1"!=loginUserRoleCheck&&!0!==data.allowDownload||(previewData.allowDownload=!0,previewData.allowPrint=!0),ZPeople.IsNumeric(data.filePath)){fileExtn=data.fileExtn.toLowerCase();previewData.fileExtn=fileExtn.toLowerCase()}"hrdocPdf"==mode?Preview.showPreview(previewData,mode):"Onboarding"==mode?Preview.showPreview(previewData,mode):Preview.showPreview(previewData,"files")},constructPreviewUrl:function(mode,params,fileExtn){var fileId="";if("Forms"==mode?(fileId=params.fileId,fileUploadId=params.fileUploadId):"agreement"==mode?fileId=params.fileId:"HRCase"==mode?fileId=params.filePath:"zp_offboarding"==mode?fileId=params.fileId:"hr"==mode&&void 0!=params.fileType&&"4"==params.fileType?mode="HRFormTemp":fileId=params,"pdf"==fileExtn)url="Forms"==mode?"/pdfViewer.zp?formFileId="+fileId+"&mode="+mode+"&fcId="+params.fcId+"&formId="+params.formId+"&recordId="+params.recordId+(void 0!=fileUploadId?"&fileId="+fileUploadId:""):"HRCase"==mode?"/pdfViewer.zp?fPath="+fileId+"&mode="+mode+"&fileId="+params.fileId+"&recordId="+params.recordId+"&fType="+params.fType:"hrdocPdf"==mode?"/pdfViewer.zp?fileId="+fileId+"&isNotPrevEngURL="+!0:"HRFormTemp"==mode?params.filePath:"/pdfViewer.zp?fileId="+fileId;else{"tif"==fileExtn?url="/pdf/"+previewServiceId+"/"+fileId+"?":"docx"==fileExtn||"doc"==fileExtn||"rtf"==fileExtn||"odt"==fileExtn||"pptx"==fileExtn||"ppt"==fileExtn?url="/preview/"+previewServiceId+"/"+fileId+"?":-1!=Files.previewVideoFType.indexOf(fileExtn)&&(url="/video/"+previewServiceId+"/"+fileId+"/dash_manifest?");var frameOrigin=window.location.protocol+"//"+window.location.host,zohoOneOrigin=ZPeople.UnifiedUI.getZOFrameOriginUrl();null!=zohoOneOrigin&&void 0!=zohoOneOrigin&&""!=zohoOneOrigin&&(frameOrigin+=","+zohoOneOrigin),url=previewServerUrl+url+"frameorigin="+frameOrigin,params.portalId=_LOGGEDIN_ACCZSOID,"Forms"==mode?(params.moduleName="Forms",params.hasOwnProperty("fileUploadId")?(params.fileId=params.fileUploadId,delete params.fileUploadId):delete params.fileId,delete params.original):"HRCase"==mode?params.moduleName="HRCase":mode==zp_offboarding?params.moduleName="zp_offboarding":"agreement"==mode?(params.moduleName="Files",params.portalId=_LOGGEDIN_ACCZSOID,params.files_userIp=userIp):((params={}).moduleName="Files",params.portalId=_LOGGEDIN_ACCZSOID,params.files_userIp=userIp),url=url+"&cli-msg="+encodeURIComponent(btoa(JSON.stringify(params)))}return url},generatePreview:function(event){if("PreviewEngine"==event.data.source&&"404"==event.data.code){if(null!=isPreviewAllowed&&void 0!=isPreviewAllowed&&1==isPreviewAllowed&&null!=Files.previewFileData[0]&&void 0!=Files.previewFileData[0]&&""!=Files.previewFileData[0]&&null!=Files.previewFileData[1]&&void 0!=Files.previewFileData[1]&&""!=Files.previewFileData[1]){var formData=new FormData;formData.append("methodName","generatePreview"),formData.append("conreqcsr",csrfToken),formData.append("fileId",Files.previewFileData[0]),formData.append("filePath",Files.previewFileData[1]);return $.ajax({url:Files.ACTION.URL,type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){void 0!==resultData[1]&&ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.generatingpreview"))},error:function(req){ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.genaratepreviewerr"))}}),url}ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.genaratepreviewerr"))}else"PreviewEngine"==event.data.source&&"202"==event.data.code&&ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.generatingpreview"))},closeDiv:function(isEsc,event){$("#viewFileFrame").attr("src",""),$("#viewPreviewFileDiv").remove(),$("#wrapper").removeClass("ZPMprw")},magnifyFileView:function(){var img,glass,zoom=Number("2"),bw=3;if(document.getElementById("magnify_files").classList.toggle("sel"),"CR-magnifier sel"==$("#magnify_files").attr("class")){function hideMagnifier(){glass.style.display="none"}function showMagnifier(e){glass.style.display="block";var pos,x,y,w=glass.offsetWidth/2,h=glass.offsetHeight/2;e.preventDefault(),pos=function(e){var a,x=0,y=0;return e=e||window.event,a=img.getBoundingClientRect(),x=e.pageX-a.left,y=e.pageY-a.top,x-=window.pageXOffset,y-=window.pageYOffset,{x:x,y:y}}(e),x=pos.x,y=pos.y,glass.style.left=x-w+"px",glass.style.top=y-h+"px";img.getBoundingClientRect().left,img.getBoundingClientRect().top;var tempXPos=0;tempXPos=-(x*zoom-w+bw)<=0?-(x*zoom-w+bw):w-(x*zoom-bw);var tempYPos=0;tempYPos=-(y*zoom-h+bw)<=0?-(y*zoom-h+bw):h-(y*zoom-bw),glass.style.backgroundPosition=tempXPos+"px "+tempYPos+"px"}0==$("#page-wrapper").find("#viewPreviewFileDiv").find("#magnifyFiles").length&&(img=document.getElementById("imageviewFrame"),(glass=document.createElement("DIV")).setAttribute("id","magnifyFiles"),glass.setAttribute("class","files-magnifier-glass"),img.parentElement.insertBefore(glass,img),glass.style.backgroundImage="url('"+img.src+"')",glass.style.backgroundRepeat="no-repeat",glass.style.backgroundSize=img.width*zoom+"px "+img.height*zoom+"px",glass.addEventListener("mousemove",showMagnifier),img.addEventListener("mousemove",showMagnifier),glass.addEventListener("mouseout",hideMagnifier),img.addEventListener("mouseout",hideMagnifier))}else $("#page-wrapper").find("#viewPreviewFileDiv").find("#magnifyFiles").remove()},zoomFile:function(mode){$("#page-wrapper").find("#viewPreviewFileDiv").find("#magnifyFiles").remove(),$("#magnify_files").removeClass("sel");var zoomVal=parseInt($("#zoomRange").val()),val=($("#zoomRange").val()-$("#zoomRange").attr("min"))/($("#zoomRange").attr("max")-$("#zoomRange").attr("min"));if(Layout.Page.container.find("#zoomRange").css("background-image","-webkit-gradient(linear, left top, right top, color-stop("+val+", #ffffff), color-stop("+val+", #787878))"),$("#zoomval").text(zoomVal+"%"),"ESign"===mode)var imgOrigHeight=parseInt(Files.esignimgOrgHeight)+parseInt(zoomVal);else imgOrigHeight=parseInt(Files.imgOrgHeight)+parseInt(zoomVal);var imgmaxheight=parseInt(610)+parseInt(zoomVal),imgmaxwidth=parseInt(1265)+parseInt(zoomVal);0!=zoomVal?($("#imageviewFrame").css("max-height",imgmaxheight+"px"),$("#imageviewFrame").css("max-width",imgmaxwidth+"px"),$("#imageviewFrame").height(imgOrigHeight+"px"),$("#imageviewFrame").width("auto")):($("#imageviewFrame").css("max-height","610px"),$("#imageviewFrame").css("max-width","1465px"),$("#imageviewFrame").height(imgOrigHeight+"px"),$("#imageviewFrame").width("auto"))},printFile:function(fromFiles){var viewUrl="/viewFile?fileId="+Files.printFileId;if(fromFiles&&(viewUrl="/pdfViewer.zp?fileId="+Files.printFileId),"undefined"!=contextPath&&"null"!=contextPath&&(viewUrl="/"+contextPath+viewUrl),!0===Files.allowDownload){window.open(viewUrl).print()}else{var params={methodName:"getDownloadPermission",fileId:Files.printFileId,fileType:1,conreqcsr:csrfToken};$.post("/fileCabinetAction.zp",params,function(resultData){1==resultData[1]?window.open(viewUrl).print():alert("Access denied")})}},updateReloadParams:function(fileType){"1"===fileType?(Files.orgListViewData.Org[3]=!0,Files.orgCatViewData.Org[3]=!0):(Files.empListViewData.All[3]=!0,Files.empCatViewData.All[3]=!0,Files.empListViewData.Sub[3]=!0,Files.empCatViewData.Sub[3]=!0,Files.empListViewData.My[3]=!0,Files.empCatViewData.My[3]=!0,Files.empListViewData.Role[3]=!0,Files.empCatViewData.Role[3]=!0)},setFilterView:function(searchParams){return void 0!=searchParams.entityId?searchParams.filterView="entity":void 0!=searchParams.unitId?searchParams.filterView="unit":void 0!=searchParams.divisionId?searchParams.filterView="division":void 0!=searchParams.deptId?searchParams.filterView="department":searchParams.filterView="location",searchParams},reloadPage:function(){setTimeout(function(){Files.setSearchValuesInDiv(),Files.searchFileBreadcrumbs(),-1!==Layout.Page.hash.indexOf("files/companyfile/listview")&&!0===Files.orgListViewData.Org[3]&&0!==Files.orgListViewData.Org[0]?(Files.orgListViewData.Org[0]=0,Files.orgListViewData.Org[1]=!0,Layout.Page.container.find("#comp_fileListing").html(""),Files.orgListViewData.Org[2].methodName="getAllFiles",Files.orgListViewData.Org[2].start=Files.orgListViewData.Org[0],Files.orgListViewData.Org[2]=Files.setFilterView(Files.orgListViewData.Org[2]),Files.getCompanyfilesListing()):-1!==Layout.Page.hash.indexOf("files/companyfile/catview")&&!0===Files.orgCatViewData.Org[3]&&0!==Files.orgCatViewData.Org[0]&&(Files.orgCatViewData.Org[0]=0,Files.orgCatViewData.Org[1]=!0,Files.setFilterView(Files.orgListViewData.Org[2]),Layout.Page.container.find("#companyFilesCategoryView").find("#CFCatView").html(""),Files.showCategoryView()),-1!==Layout.Page.hash.indexOf("files/hrfile/all/listview")&&!0===Files.empListViewData.All[3]&&0!==Files.empListViewData.All[0]?(Files.empListViewData.All[0]=0,Files.empListViewData.All[1]=!0,Layout.Page.container.find("#hr_allfileList").html(""),Files.empListViewData.All[2].methodName="getAllFiles",Files.empListViewData.All[2].start=Files.empListViewData.All[0],Files.getHrfilesListing()):-1!==Layout.Page.hash.indexOf("files/hrfile/all/catview")&&!0===Files.empCatViewData.All[3]&&0!==Files.empCatViewData.All[0]&&(Files.empCatViewData.All[0]=0,Files.empCatViewData.All[1]=!0,Layout.Page.container.find("#allFilesCategoryView").find("#HFCatView").html(""),Files.showCategoryView()),-1!==Layout.Page.hash.indexOf("files/hrfile/sub/listview")&&!0===Files.empListViewData.Sub[3]&&0!==Files.empListViewData.Sub[0]?(Files.empListViewData.Sub[0]=0,Files.empListViewData.Sub[1]=!0,Layout.Page.container.find("#hr_allfileList").html(""),Files.empListViewData.Sub[2].methodName="getAllFiles",Files.empListViewData.Sub[2].start=Files.empListViewData.Sub[0],Files.getHrfilesListing()):-1!==Layout.Page.hash.indexOf("files/hrfile/sub/catview")&&!0===Files.empCatViewData.Sub[3]&&0!==Files.empCatViewData.Sub[0]&&(Files.empCatViewData.Sub[0]=0,Files.empCatViewData.Sub[1]=!0,Layout.Page.container.find("#subFilesCategoryView").find("#HFCatView").html(""),Files.showCategoryView()),-1!==Layout.Page.hash.indexOf("files/hrfile/my/listview")&&!0===Files.empListViewData.My[3]&&0!==Files.empListViewData.My[0]?(Files.empListViewData.My[0]=0,Files.empListViewData.My[1]=!0,Layout.Page.container.find("#hr_allfileList").html(""),Files.empListViewData.My[2].methodName="getAllFiles",Files.empListViewData.My[2].start=Files.empListViewData.My[0],Files.getHrfilesListing()):-1!==Layout.Page.hash.indexOf("files/hrfile/my/catview")&&!0===Files.empCatViewData.My[3]&&0!==Files.empCatViewData.My[0]&&(Files.empCatViewData.My[0]=0,Files.empCatViewData.My[1]=!0,Layout.Page.container.find("#myFilesCategoryView").find("#HFCatView").html(""),Files.showCategoryView()),-1!==Layout.Page.hash.indexOf("files/hrfile/role/listview")&&!0===Files.empListViewData.Role[3]&&0!==Files.empListViewData.Role[0]?(Files.empListViewData.Role[0]=0,Files.empListViewData.Role[1]=!0,Layout.Page.container.find("#hr_allfileList").html(""),Files.empListViewData.Role[2].methodName="getAllFiles",Files.empListViewData.Role[2].start=Files.empListViewData.My[0],Files.getHrfilesListing()):-1!==Layout.Page.hash.indexOf("files/hrfile/role/catview")&&!0===Files.empCatViewData.Role[3]&&0!==Files.empCatViewData.Role[0]&&(Files.empCatViewData.Role[0]=0,Files.empCatViewData.Role[1]=!0,Layout.Page.container.find("#roleFilesCategoryView").find("#HFCatView").html(""),Files.showCategoryView())},500)},setSearchValuesInDiv:function(){var searchParams={};-1!==Layout.Page.hash.indexOf("files/companyfile")&&(searchParams=Files.orgListViewData.Org[2],Object.keys(searchParams).length>0&&(null!==searchParams.isExpiredFilesView&&""!==searchParams.isExpiredFilesView&&!0===searchParams.isExpiredFilesView?Layout.Page.container.find("#companyFileViewType").select2("val","1"):Layout.Page.container.find("#companyFileViewType").select2("val","0"),null!==searchParams.locationId&&"-1"!==searchParams.locationId?Layout.Page.container.find("#search_location").select2("val",searchParams.locationId):Layout.Page.container.find("#search_location").select2("val","-1"),null!==searchParams.catId&&"-1"!==searchParams.catId?Layout.Page.container.find("#companysearch_cat").select2("val",searchParams.catId):Layout.Page.container.find("#companysearch_cat").select2("val","-1"),null!==searchParams.fromDate&&""!=searchParams.fromDate&&"-1"!=searchParams.fromDate?Layout.Page.container.find("#companysearch_fromDate").val(searchParams.fromDate):Layout.Page.container.find("#companysearch_fromDate").val(""),null!==searchParams.toDate&&""!=searchParams.toDate&&"-1"!=searchParams.toDate?Layout.Page.container.find("#companysearch_toDate").val(searchParams.toDate):Layout.Page.container.find("#companysearch_toDate").val(""),null!=searchParams.searchFileName&&""!=searchParams.searchFileName?Layout.Page.container.find("#search_CFname").val(searchParams.searchFileName):Layout.Page.container.find("#search_CFname").val(""),null!=searchParams.searchFileExtn&&""!=searchParams.searchFileExtn?Layout.Page.container.find("#search_CFextn").select2("val",Files.fetchFileTypeByExtn(searchParams.searchFileExtn)):Layout.Page.container.find("#search_CFextn").select2("val","-1")),Files.clearAndSetEntityFields()),-1!==Layout.Page.hash.indexOf("files/hrfile")&&(-1!==Layout.Page.hash.indexOf("files/hrfile/all")?(searchParams=Files.empListViewData.All[2],Object.keys(searchParams).length>0&&(null!==searchParams.filterBy||""!==searchParams.filterBy?"all"===searchParams.filterBy?(Layout.Page.container.find("#fileTypeData").select2("val","0"),Files.setSearchEmpData(),Layout.Page.container.find("#roleSelect_Div").hide(),Layout.Page.container.find("#activeEmpSearch").show(),Layout.Page.container.find("#inactiveEmpSearch").hide(),Layout.Page.container.find("#logDisEmpSearch").hide(),Layout.Page.container.find("#roleBasedHeader").hide(),Layout.Page.container.find("#roleViewfilter").hide()):"inactiveemp"===searchParams.filterBy?(Layout.Page.container.find("#fileTypeData").select2("val","5"),Files.setSearchEmpData(),Layout.Page.container.find("#roleSelect_Div").hide(),Layout.Page.container.find("#activeEmpSearch").hide(),Layout.Page.container.find("#inactiveEmpSearch").show(),Layout.Page.container.find("#logDisEmpSearch").hide(),Layout.Page.container.find("#roleBasedHeader").hide(),Layout.Page.container.find("#roleViewfilter").hide()):"logindisabled"===searchParams.filterBy?(Layout.Page.container.find("#fileTypeData").select2("val","8"),Files.setSearchEmpData(),Layout.Page.container.find("#roleSelect_Div").hide(),Layout.Page.container.find("#activeEmpSearch").hide(),Layout.Page.container.find("#inactiveEmpSearch").hide(),Layout.Page.container.find("#logDisEmpSearch").show(),Layout.Page.container.find("#roleBasedHeader").hide(),Layout.Page.container.find("#roleViewfilter").hide()):"allrole"===searchParams.filterBy&&(Layout.Page.container.find("#fileTypeData").select2("val","3"),null!==searchParams.roleId&&"-1"!==searchParams.roleId&&(Files.getRoleList("search_role"),Layout.Page.container.find("#search_role").select2("val",searchParams.roleId)),Layout.Page.container.find("#roleSelect_Div").show(),Layout.Page.container.find("#activeEmpSearch").hide(),Layout.Page.container.find("#inactiveEmpSearch").hide(),Layout.Page.container.find("#logDisEmpSearch").hide(),Layout.Page.container.find("#roleBasedHeader").show(),Layout.Page.container.find("#roleViewfilter").show()):Layout.Page.container.find("#fileTypeData").select2("val","0"))):-1!==Layout.Page.hash.indexOf("files/hrfile/sub")?(searchParams=Files.empListViewData.Sub[2],Object.keys(searchParams).length>0&&(null!==searchParams.filterBy||""!==searchParams.filterBy?"subordinates"===searchParams.filterBy?(Layout.Page.container.find("#fileTypeData").select2("val","6"),Files.setSearchEmpData(),Layout.Page.container.find("#subEmpSearch").show(),Layout.Page.container.find("#allsubEmpSearch").hide()):"allsubordinates"===searchParams.filterBy&&(Layout.Page.container.find("#fileTypeData").select2("val","7"),Files.setSearchEmpData(),Layout.Page.container.find("#allsubEmpSearch").show(),Layout.Page.container.find("#subEmpSearch").hide()):Layout.Page.container.find("#fileTypeData").select2("val","6"))):-1!==Layout.Page.hash.indexOf("files/hrfile/my")?(searchParams=Files.empListViewData.My[2],Object.keys(searchParams).length>0&&(null===searchParams.filterBy&&""===searchParams.filterBy||Layout.Page.container.find("#fileTypeData").select2("val","1"))):-1!==Layout.Page.hash.indexOf("files/hrfile/role")&&(searchParams=Files.empListViewData.Role[2],Object.keys(searchParams).length>0&&(null===searchParams.filterBy&&""===searchParams.filterBy||Layout.Page.container.find("#fileTypeData").select2("val","4"))),Object.keys(searchParams).length>0&&(null!==searchParams.catId&&"-1"!==searchParams.catId?Layout.Page.container.find("#search_cat").select2("val",searchParams.catId):Layout.Page.container.find("#search_cat").select2("val","-1"),null!==searchParams.locationId&&void 0!==searchParams.locationId&&"-1"!==searchParams.locationId?Layout.Page.container.find("#search_locationHr").select2("val",searchParams.locationId):Layout.Page.container.find("#search_locationHr").select2("val","-1"),null!==searchParams.fromDate&&""!=searchParams.fromDate&&"-1"!=searchParams.fromDate?Layout.Page.container.find("#hrsearch_fromDate").val(searchParams.fromDate):Layout.Page.container.find("#hrsearch_fromDate").val(""),null!==searchParams.toDate&&""!=searchParams.toDate&&"-1"!=searchParams.toDate?Layout.Page.container.find("#hrsearch_toDate").val(searchParams.toDate):Layout.Page.container.find("#hrsearch_toDate").val(""),null!=searchParams.searchFileName&&""!=searchParams.searchFileName?Layout.Page.container.find("#search_HFname").val(searchParams.searchFileName):Layout.Page.container.find("#search_HFname").val(""),null!=searchParams.searchFileExtn&&""!=searchParams.searchFileExtn?Layout.Page.container.find("#search_HFextn").select2("val",Files.fetchFileTypeByExtn(searchParams.searchFileExtn)):Layout.Page.container.find("#search_HFextn").select2("val","-1"))),void 0!==searchParams.entityId&&null!==searchParams.entityId?"-1"!==searchParams.entityId&&Layout.Page.container.find("#s2id_zp_views_employeeentity").select2("val",searchParams.entityId):Layout.Page.container.find("#s2id_zp_views_employeeentity").select2("val","-1"),void 0!==searchParams.unitId&&null!==searchParams.unitId?"-1"!==searchParams.unitId&&Layout.Page.container.find("#s2id_zp_views_employeeunit").select2("val",searchParams.unitId):Layout.Page.container.find("#s2id_zp_views_employeeunit").select2("val","-1"),void 0!==searchParams.divisionId&&null!==searchParams.divisionId?"-1"!==searchParams.divisionId&&Layout.Page.container.find("#s2id_zp_views_employeedivision").select2("val",searchParams.divisionId):Layout.Page.container.find("#s2id_zp_views_employeedivision").select2("val","-1"),void 0!==searchParams.deptId&&null!==searchParams.deptId?"-1"!==searchParams.deptId&&Layout.Page.container.find("#s2id_zp_views_employeedepartment").select2("val",searchParams.deptId):Layout.Page.container.find("#s2id_zp_views_employeedepartment").select2("val","-1"),-1!==Layout.Page.hash.indexOf("files/personalfile")&&(searchParams=Files.reportsData.PF[2],Object.keys(searchParams).length>0&&(null!==searchParams.fromDate&&""!=searchParams.fromDate&&"-1"!=searchParams.fromDate&&Layout.Page.container.find("#search_fromDate").val(searchParams.fromDate),null!==searchParams.toDate&&""!=searchParams.toDate&&"-1"!=searchParams.toDate&&Layout.Page.container.find("#search_toDate").val(searchParams.toDate),null!=searchParams.searchFileName&&""!=searchParams.searchFileName&&Layout.Page.container.find("#search_PFname").val(searchParams.searchFileName),null!=searchParams.searchFileExtn&&""!=searchParams.searchFileExtn&&Layout.Page.container.find("#search_PFextn").select2("val",searchParams.searchFileExtn)))},setSearchEmpData:function(){-1!==Layout.Page.hash.indexOf("/all")?"0"===Layout.Page.container.find("#fileTypeData").val()&&Files.actEmpSearchObj.length>0?(Layout.Page.container.find("#actEmpPhoto_Files").show(),Layout.Page.container.find("#inactEmpPhoto_Files").hide(),Layout.Page.container.find("#logdisEmpPhoto_Files").hide(),Layout.Page.container.find("input[id=search_ActEmp]").val(Files.actEmpSearchObj[0]),Layout.Page.container.find("#actEmpPhoto_Files").attr("src",Files.actEmpSearchObj[1]),Layout.Page.container.find("#s2id_search_ActEmp").find("span").html(Files.actEmpSearchObj[2])):"5"===Layout.Page.container.find("#fileTypeData").val()?((-1!==Layout.Page.hash.indexOf("#files/hrfile/all/list")&&!1!==Files.isInactEmpInit[0]||-1!==Layout.Page.hash.indexOf("#files/hrfile/all/cat")&&!1!==Files.isInactEmpInit[1]||-1!==Layout.Page.hash.indexOf("#files/hrfile/all/view")&&!1!==Files.isInactEmpInit[2])&&Files.initEmployeeSearch(),Files.inactEmpSearchObj.length>0&&(Layout.Page.container.find("#inactEmpPhoto_Files").show(),Layout.Page.container.find("#actEmpPhoto_Files").hide(),Layout.Page.container.find("#logdisEmpPhoto_Files").hide(),Layout.Page.container.find("input[id=search_InactEmp]").val(Files.inactEmpSearchObj[0]),Layout.Page.container.find("#inactEmpPhoto_Files").attr("src",Files.inactEmpSearchObj[1]),Layout.Page.container.find("#s2id_search_InactEmp").find("span").html(Files.inactEmpSearchObj[2]))):"8"===Layout.Page.container.find("#fileTypeData").val()&&((-1!==Layout.Page.hash.indexOf("#files/hrfile/all/list")&&!1!==Files.isLogDisEmpInit[0]||-1!==Layout.Page.hash.indexOf("#files/hrfile/all/cat")&&!1!==Files.isLogDisEmpInit[1]||-1!==Layout.Page.hash.indexOf("#files/hrfile/all/view")&&!1!==Files.isLogDisEmpInit[2])&&Files.initEmployeeSearch(),Files.logDisEmpSearchObj.length>0&&(Layout.Page.container.find("#logdisEmpPhoto_Files").show(),Layout.Page.container.find("#inactEmpPhoto_Files").hide(),Layout.Page.container.find("#actEmpPhoto_Files").hide(),Layout.Page.container.find("input[id=search_LogDisEmp]").val(Files.logDisEmpSearchObj[0]),Layout.Page.container.find("#logdisEmpPhoto_Files").attr("src",Files.logDisEmpSearchObj[1]),Layout.Page.container.find("#s2id_search_LogDisEmp").find("span").html(Files.logDisEmpSearchObj[2]))):-1!==Layout.Page.hash.indexOf("/sub")&&("7"===Layout.Page.container.find("#fileTypeData").val()?((-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/list")&&!1!==Files.isAllSubEmpInit[0]||-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/cat")&&!1!==Files.isAllSubEmpInit[1]||-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/view")&&!1!==Files.isAllSubEmpInit[2])&&Files.initEmployeeSearch(),Files.allsubEmpSearchObj.length>0&&(Layout.Page.container.find("#allsubEmpPhoto_Files").show(),Layout.Page.container.find("#subEmpPhoto_Files").hide(),Layout.Page.container.find("input[id=search_AllSubEmp]").val(Files.allsubEmpSearchObj[0]),Layout.Page.container.find("#allsubEmpPhoto_Files").attr("src",Files.allsubEmpSearchObj[1]),Layout.Page.container.find("#s2id_search_AllSubEmp").find("span").html(Files.allsubEmpSearchObj[2]))):("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&Files.subEmpSearchObj.length>0&&((-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/list")&&!1!==Files.isSubEmpInit[0]||-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/cat")&&!1!==Files.isSubEmpInit[1]||-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/view")&&!1!==Files.isSubEmpInit[2])&&Files.initEmployeeSearch(),Files.subEmpSearchObj.length>0&&(Layout.Page.container.find("#subEmpPhoto_Files").show(),Layout.Page.container.find("#allsubEmpPhoto_Files").hide(),Layout.Page.container.find("input[id=search_SubEmp]").val(Files.subEmpSearchObj[0]),Layout.Page.container.find("#subEmpPhoto_Files").attr("src",Files.subEmpSearchObj[1]),Layout.Page.container.find("#s2id_search_SubEmp").find("span").html(Files.subEmpSearchObj[2]))))},opnclsSearchBreadcrumbs:function(mode,isFromReset){"open"===mode&&(-1!==Layout.Page.hash.indexOf("companyfile")&&""!==Layout.Page.container.find("#filter_params_orgfiles").html()||-1!==Layout.Page.hash.indexOf("hrfile")&&""!==Layout.Page.container.find("#filter_params_hrfiles").html()||-1!==Layout.Page.hash.indexOf("personalfile/listview")&&""!==Layout.Page.container.find("#filter_params_persfiles").html()||-1!==Layout.Page.hash.indexOf("report/personalfile")&&""!==Layout.Page.container.find("#filter_params_pfreports").html()||-1!==Layout.Page.hash.indexOf("report/acknowledge")&&""!==Layout.Page.container.find("#filter_params_ackreports").html()||-1!==Layout.Page.hash.indexOf("zohosign/documentlistview")&&(""!==Layout.Page.container.find("#filter_params_docFiles").html()||""!==Layout.Page.container.find("#wf_filter_params_docFiles").html())||-1!==Layout.Page.hash.indexOf("docusign/doculistview")&&""!==Layout.Page.container.find("#filter_params_envFiles").html()||-1!==Layout.Page.hash.indexOf("adobesign/agreementslistview")&&""!==Layout.Page.container.find("#filter_params_agreeFiles").html()||-1!==Layout.Page.hash.indexOf("zohosign/templatelistview")&&""!==Layout.Page.container.find("#filter_params_tempFiles").html())?(-1!==Layout.Page.hash.indexOf("companyfile")&&($("#page-wrapper").addClass("filter-container"),-1!==Layout.Page.hash.indexOf("listview")?0==Layout.Page.container.find("#nocompanyFilesDiv").find(".ZPNdata").length&&Layout.Page.container.find("#compfiles_list").addClass("expand"):-1!==Layout.Page.hash.indexOf("catview")?(0==Layout.Page.container.find("#nocompanyFilesDiv").find(".ZPNdata").length&&Layout.Page.container.find("#compfiles_list").addClass("expand"),Layout.Page.container.find("#companyFilesCategoryView").find(".ZPListingHdr").removeClass("DN"),Layout.Page.container.find("#loadingGridDiv").find(".ZPListingHdr").removeClass("DN")):-1!==Layout.Page.hash.indexOf("view-categoryId")&&Layout.Page.container.find("#catListCFDiv").find(".ZPListingHdr:first").removeClass("DN"),Layout.Page.container.find(".filter-results").show()),-1!==Layout.Page.hash.indexOf("hrfile")&&($("#page-wrapper").addClass("filter-container"),-1!==Layout.Page.hash.indexOf("listview")?0==Layout.Page.container.find("#nohrFilesDiv").find(".ZPNdata").length&&Layout.Page.container.find("#hr_fileListing").addClass("expand"):-1!==Layout.Page.hash.indexOf("/all/catview")?(0==Layout.Page.container.find("#nohrFilesDiv").find(".ZPNdata").length&&Layout.Page.container.find("#hr_fileListing").addClass("expand"),Layout.Page.container.find("#allFilesCategoryView").find(".ZPListingHdr").removeClass("DN"),Layout.Page.container.find("#loadingGridDiv").find(".ZPListingHdr").removeClass("DN")):-1!==Layout.Page.hash.indexOf("/sub/catview")?(0==Layout.Page.container.find("#nohrFilesDiv").find(".ZPNdata").length&&Layout.Page.container.find("#hr_fileListing").addClass("expand"),Layout.Page.container.find("#subFilesCategoryView").find(".ZPListingHdr").removeClass("DN"),Layout.Page.container.find("#loadingGridDiv").find(".ZPListingHdr").removeClass("DN")):-1!==Layout.Page.hash.indexOf("/my/catview")?(0==Layout.Page.container.find("#nohrFilesDiv").find(".ZPNdata").length&&Layout.Page.container.find("#hr_fileListing").addClass("expand"),Layout.Page.container.find("#myFilesCategoryView").find(".ZPListingHdr").removeClass("DN"),Layout.Page.container.find("#loadingGridDiv").find(".ZPListingHdr").removeClass("DN")):-1!==Layout.Page.hash.indexOf("/role/catview")?(0==Layout.Page.container.find("#nohrFilesDiv").find(".ZPNdata").length&&Layout.Page.container.find("#hr_fileListing").addClass("expand"),Layout.Page.container.find("#roleFilesCategoryView").find(".ZPListingHdr").removeClass("DN"),Layout.Page.container.find("#loadingGridDiv").find(".ZPListingHdr").removeClass("DN")):-1!==Layout.Page.hash.indexOf("view-categoryId")&&Layout.Page.container.find("#catListHFDiv").find(".ZPListingHdr:first").removeClass("DN"),Layout.Page.container.find(".filter-results").show()),-1!==Layout.Page.hash.indexOf("personalfile/listview")&&($("#page-wrapper").addClass("filter-container"),Layout.Page.container.find("#persfiles_list").addClass("expand"),Layout.Page.container.find(".filter-results").show()),-1!==Layout.Page.hash.indexOf("report/personalfile")&&($("#page-wrapper").addClass("filter-container"),Layout.Page.container.find("#pfreporthdr").addClass("expand"),Layout.Page.container.find(".filter-results").show()),-1!==Layout.Page.hash.indexOf("report/acknowledge")&&($("#page-wrapper").addClass("filter-container"),Layout.Page.container.find("#ackreporthdr").addClass("expand"),Layout.Page.container.find(".filter-results").show()),-1!==Layout.Page.hash.indexOf("files/zohosign/documentlistview")&&($("#page-wrapper").addClass("filter-container"),Layout.Page.container.find("#documents_listingpage").addClass("expand"),Layout.Page.container.find("#WFStatus_listingpage").addClass("expand"),Layout.Page.container.find(".filter-results").show(),Layout.Page.container.find("#wfreportsfilter .filter-results").show()),-1!==Layout.Page.hash.indexOf("files/adobesign/agreementslistview")&&($("#page-wrapper").addClass("filter-container"),Layout.Page.container.find("#agreements_listingpage").addClass("expand"),Layout.Page.container.find(".filter-results").show()),-1!==Layout.Page.hash.indexOf("files/docusign/doculistview")&&($("#page-wrapper").addClass("filter-container"),Layout.Page.container.find("#envelopes_listingpage").addClass("expand"),Layout.Page.container.find(".filter-results").show()),-1!==Layout.Page.hash.indexOf("files/zohosign/templatelistview")&&($("#page-wrapper").addClass("filter-container"),Layout.Page.container.find("#signtemplate_listingpage").addClass("expand"),Layout.Page.container.find(".filter-results").show())):"close"===mode&&(-1!==Layout.Page.hash.indexOf("companyfile")&&(null!==isFromReset&&void 0!==isFromReset&&!1!==isFromReset||($("#page-wrapper").removeClass("filter-container"),-1!==Layout.Page.hash.indexOf("listview")?Layout.Page.container.find("#compfiles_list").removeClass("expand"):-1!==Layout.Page.hash.indexOf("catview")?(Layout.Page.container.find("#compfiles_list").removeClass("expand"),Layout.Page.container.find("#companyFilesCategoryView").find(".ZPListingHdr").addClass("DN"),Layout.Page.container.find("#loadingGridDiv").find(".ZPListingHdr").addClass("DN")):-1!==Layout.Page.hash.indexOf("view-categoryId")&&Layout.Page.container.find("#catListCFDiv").find(".ZPListingHdr:first").addClass("DN"),Layout.Page.container.find(".filter-results").hide())),-1!==Layout.Page.hash.indexOf("hrfile")&&($("#page-wrapper").removeClass("filter-container"),-1!==Layout.Page.hash.indexOf("listview")?Layout.Page.container.find("#hr_fileListing").removeClass("expand"):-1!==Layout.Page.hash.indexOf("/all/catview")?(Layout.Page.container.find("#hr_fileListing").removeClass("expand"),Layout.Page.container.find("#allFilesCategoryView").find(".ZPListingHdr").addClass("DN"),Layout.Page.container.find("#loadingGridDiv").find(".ZPListingHdr").addClass("DN")):-1!==Layout.Page.hash.indexOf("/sub/catview")?(Layout.Page.container.find("#hr_fileListing").removeClass("expand"),Layout.Page.container.find("#subFilesCategoryView").find(".ZPListingHdr").addClass("DN"),Layout.Page.container.find("#loadingGridDiv").find(".ZPListingHdr").addClass("DN")):-1!==Layout.Page.hash.indexOf("/my/catview")?(Layout.Page.container.find("#hr_fileListing").removeClass("expand"),Layout.Page.container.find("#myFilesCategoryView").find(".ZPListingHdr").addClass("DN"),Layout.Page.container.find("#loadingGridDiv").find(".ZPListingHdr").addClass("DN")):-1!==Layout.Page.hash.indexOf("/role/catview")?(Layout.Page.container.find("#hr_fileListing").removeClass("expand"),Layout.Page.container.find("#roleFilesCategoryView").find(".ZPListingHdr").addClass("DN"),Layout.Page.container.find("#loadingGridDiv").find(".ZPListingHdr").addClass("DN")):-1!==Layout.Page.hash.indexOf("view-categoryId")&&Layout.Page.container.find("#catListHFDiv").find(".ZPListingHdr:first").addClass("DN"),Layout.Page.container.find(".filter-results").hide()),-1!==Layout.Page.hash.indexOf("personalfile/listview")&&($("#page-wrapper").removeClass("filter-container"),Layout.Page.container.find("#persfiles_list").removeClass("expand"),Layout.Page.container.find(".filter-results").hide()),-1!==Layout.Page.hash.indexOf("report/personalfile")&&(Layout.Page.container.find("#select_employeelisting").select2("val","-Select-"),$("#page-wrapper").removeClass("filter-container"),Layout.Page.container.find("#pfreporthdr").removeClass("expand"),Layout.Page.container.find(".filter-results").hide()),-1!==Layout.Page.hash.indexOf("report/acknowledge")&&($("#page-wrapper").removeClass("filter-container"),Layout.Page.container.find("#ackreporthdr").removeClass("expand"),Layout.Page.container.find(".filter-results").hide()),-1!==Layout.Page.hash.indexOf("files/zohosign/documentlistview")&&($("#page-wrapper").removeClass("filter-container"),Layout.Page.container.find("#documents_listingpage").removeClass("expand"),Layout.Page.container.find("#WFStatus_listingpage").removeClass("expand"),Layout.Page.container.find("#wfreportsfilter .filter-results").hide(),Layout.Page.container.find(".filter-results").hide()),-1!==Layout.Page.hash.indexOf("files/docusign/doculistview")&&($("#page-wrapper").removeClass("filter-container"),Layout.Page.container.find("#envelopes_listingpage").removeClass("expand"),Layout.Page.container.find(".filter-results").hide()),-1!==Layout.Page.hash.indexOf("files/adobesign/agreementslistview")&&($("#page-wrapper").removeClass("filter-container"),Layout.Page.container.find("#agreements_listingpage").removeClass("expand"),Layout.Page.container.find(".filter-results").hide()),-1!==Layout.Page.hash.indexOf("files/zohosign/templatelistview")&&($("#page-wrapper").removeClass("filter-container"),Layout.Page.container.find("#signtemplate_listingpage").removeClass("expand"),Layout.Page.container.find(".filter-results").hide()))},checkToShowMore:function(keyId){var isMoreParamPresent=!1,totalWidth=Layout.Page.container.find("#"+keyId).parent().outerWidth(!0);if(0==totalWidth)return!1;var leftWidth=totalWidth-210,rect=Layout.Page.container.find("#"+keyId)[0].getBoundingClientRect();return(rect.width?rect.width:rect.right-rect.left)>=leftWidth&&(isMoreParamPresent=!0),isMoreParamPresent},showMoreFilter:function(keyId){Files.checkToShowMore(keyId)?(Layout.Page.container.find("#"+keyId).parent().find("#shwfilter").show(),Layout.Page.container.find("#"+keyId).parent().find("#shwfilter").show()):Layout.Page.container.find("#"+keyId).parent().find("#shwfilter").hide()},showFilterOpts:function(keyId){Layout.Page.container.find("#"+keyId).parent().parent().toggleClass("expand"),$("#page-wrapper").toggleClass("shwresult")},searchFileBreadcrumbs:function(){var searchParams={},empfileSearch={},keyId="";if(-1!==Layout.Page.hash.indexOf("companyfile"))keyId="filter_params_orgfiles",empfileSearch=Files.orgListViewData.Org[2],Object.keys(empfileSearch).length>0&&null!==empfileSearch.isExpiredFilesView&&""!==empfileSearch.isExpiredFilesView&&void 0!==empfileSearch.isExpiredFilesView&&!0===empfileSearch.isExpiredFilesView&&(searchParams[ZPI18N.getString("zp.applicable")]=ZPI18N.getString("zp.expiredcompfiles")),void 0!==empfileSearch.locationId&&null!==empfileSearch.locationId?"-1"!==empfileSearch.locationId?searchParams[ZPI18N.getString("zp.location")]=Files.locationName_Arr[empfileSearch.locationId]:searchParams[ZPI18N.getString("zp.location")]=ZPI18N.getString("zp.all"):0==Object.keys(empfileSearch).length&&(searchParams[ZPI18N.getString("zp.location")]=ZPI18N.getString("zp.all")),void 0!==empfileSearch.entityId&&null!==empfileSearch.entityId&&(searchParams[ZPI18N.getString("zp.component")]=ZPeople.orgStructureDispNameMap.entity,"-1"!==empfileSearch.entityId&&(searchParams[ZPeople.orgStructureDispNameMap.entity]=empfileSearch.entityName)),void 0!==empfileSearch.unitId&&null!==empfileSearch.unitId&&(searchParams[ZPI18N.getString("zp.component")]=ZPeople.orgStructureDispNameMap.unit,"-1"!==empfileSearch.unitId&&(searchParams[ZPeople.orgStructureDispNameMap.unit]=empfileSearch.unitName)),void 0!==empfileSearch.divisionId&&null!==empfileSearch.divisionId&&(searchParams[ZPI18N.getString("zp.component")]=ZPeople.orgStructureDispNameMap.division,"-1"!==empfileSearch.divisionId&&(searchParams[ZPeople.orgStructureDispNameMap.division]=empfileSearch.divisionName)),void 0!==empfileSearch.deptId&&null!==empfileSearch.deptId&&(searchParams[ZPI18N.getString("zp.component")]=ZPeople.orgStructureDispNameMap.department,"-1"!==empfileSearch.deptId&&(searchParams[ZPeople.orgStructureDispNameMap.department]=empfileSearch.deptName));else if(-1!==Layout.Page.hash.indexOf("hrfile")){if(keyId="filter_params_hrfiles",-1!==Layout.Page.hash.indexOf("files/hrfile")){empfileSearch={};-1!==Layout.Page.hash.indexOf("files/hrfile/all")?(empfileSearch=Files.empListViewData.All[2],Object.keys(empfileSearch).length>0&&(null!==empfileSearch.filterBy||""!==empfileSearch.filterBy&&void 0!==empfileSearch.filterBy)&&("inactiveemp"===empfileSearch.filterBy?searchParams[ZPI18N.getString("zp.applicable")]=ZPI18N.getString("zp.inactiveemployeebase"):"logindisabled"===empfileSearch.filterBy?searchParams[ZPI18N.getString("zp.applicable")]=ZPI18N.getString("zp.logindisabledbased"):"allrole"===empfileSearch.filterBy&&(searchParams[ZPI18N.getString("zp.applicable")]=ZPI18N.getString("zp.rolebase"),null!==empfileSearch.roleId&&"-1"!==empfileSearch.roleId&&(searchParams[ZPI18N.getString("zp.role")]=rolesJson[empfileSearch.roleId])))):-1!==Layout.Page.hash.indexOf("files/hrfile/sub")?(empfileSearch=Files.empListViewData.Sub[2],Object.keys(empfileSearch).length>0&&(null!==empfileSearch.filterBy||""!==empfileSearch.filterBy&&void 0!==empfileSearch.filterBy)&&"subordinates"===empfileSearch.filterBy&&null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!0===hasAllReporteePerm&&(searchParams[ZPI18N.getString("zp.applicable")]=ZPI18N.getString("zp.directreportees"))):-1!==Layout.Page.hash.indexOf("files/hrfile/my")?empfileSearch=Files.empListViewData.My[2]:-1!==Layout.Page.hash.indexOf("files/hrfile/role")&&(empfileSearch=Files.empListViewData.Role[2])}null!==empfileSearch.locationId&&"-1"!==empfileSearch.locationId&&void 0!==empfileSearch.locationId&&(searchParams[ZPI18N.getString("zp.location")]=Files.locationName_Arr[empfileSearch.locationId]),isOrgStructureEnabled&&(null!==empfileSearch.entityId&&void 0!==empfileSearch.entityId&&"-1"!==empfileSearch.entityId&&(searchParams[ZPeople.orgStructureDispNameMap.entity]=empfileSearch.entityName),null!==empfileSearch.unitId&&void 0!==empfileSearch.unitId&&"-1"!==empfileSearch.unitId&&(searchParams[ZPeople.orgStructureDispNameMap.unit]=empfileSearch.unitName),null!==empfileSearch.divisionId&&void 0!==empfileSearch.divisionId&&"-1"!==empfileSearch.divisionId&&(searchParams[ZPeople.orgStructureDispNameMap.division]=empfileSearch.divisionName)),null!==empfileSearch.deptId&&void 0!==empfileSearch.deptId&&"-1"!==empfileSearch.deptId&&(searchParams[ZPeople.orgStructureDispNameMap.department]=empfileSearch.deptName)}else-1!==Layout.Page.hash.indexOf("personalfile/listview")?(keyId="filter_params_persfiles",empfileSearch=Files.persListViewData.Pers[2]):-1!==Layout.Page.hash.indexOf("report/personalfile")?(keyId="filter_params_pfreports",empfileSearch=Files.reportsData.PF[2]):-1!==Layout.Page.hash.indexOf("report/acknowledge")&&(keyId="filter_params_ackreports",empfileSearch=Files.reportsData.Ack[2]);if(Object.keys(empfileSearch).length>0&&(-1===Layout.Page.hash.indexOf("view-categoryId")&&null!==empfileSearch.catId&&"-1"!==empfileSearch.catId&&void 0!==empfileSearch.catId&&(searchParams[ZPI18N.getString("zp.folder")]=Files.newCategoryList[empfileSearch.catId]),null!==empfileSearch.fromDate&&""!=empfileSearch.fromDate&&"-1"!=empfileSearch.fromDate&&void 0!==empfileSearch.fromDate&&(searchParams[ZPI18N.getString("zp.from")]=empfileSearch.fromDate),null!==empfileSearch.toDate&&""!=empfileSearch.toDate&&"-1"!=empfileSearch.toDate&&void 0!==empfileSearch.toDate&&(searchParams[ZPI18N.getString("zp.to")]=empfileSearch.toDate),null!==empfileSearch.searchFileName&&""!=empfileSearch.searchFileName&&void 0!==empfileSearch.searchFileName&&(searchParams[ZPI18N.getString("zp.filename")]=empfileSearch.searchFileName),null!=empfileSearch.searchFileExtn&&""!=empfileSearch.searchFileExtn&&void 0!==empfileSearch.searchFileExtn&&(searchParams[ZPI18N.getString("zp.filesextn")]=Files.fetchFileTypeByExtn(empfileSearch.searchFileExtn,"type")),-1!==Layout.Page.hash.indexOf("report/personalfile"))){if(null!==empfileSearch.employeeId&&""!==empfileSearch.employeeId&&void 0!==empfileSearch.employeeId&&"-1"!==empfileSearch.employeeId){var empDetails=ZP.getUserDetailsById(Layout.Page.container.find("#select_employeelisting").val());searchParams[ZPI18N.getString("zp.employee")]=empDetails.name}null!=empfileSearch.searchFileExtn&&""!=empfileSearch.searchFileExtn&&void 0!=empfileSearch.searchFileExtn&&(searchParams[ZPI18N.getString("zp.filesextn")]=Layout.Page.container.find("#s2id_search_PFReportsExtn").find("span").html())}if(Object.keys(searchParams).length>0){var resultHtml="";searchParams.hasOwnProperty(ZPI18N.getString("zp.component"))&&delete searchParams[ZPI18N.getString("zp.location")],$.each(searchParams,function(key,val){-1!==Layout.Page.hash.indexOf("companyfile")&&key===ZPI18N.getString("zp.location")&&val===ZPI18N.getString("zp.all")?(resultHtml+="<span value='"+key+"'>"+key+"&nbsp;&nbsp; : &nbsp;&nbsp;"+ZPeople.escapeHtml(ZPeople.decodeTxt(val))+"</span>",1==Object.keys(searchParams).length&&Layout.Page.container.find("#orgFileReset").hide()):key!==ZPI18N.getString("zp.location")&&key!==ZPI18N.getString("zp.component")&&key!==ZPI18N.getString("zp.folder")?(val=ZSEC.Encoder.encodeForHTML(val),resultHtml+="<span value='"+key+"'>"+key+"&nbsp;&nbsp; : &nbsp;&nbsp;"+val+"<i onclick='Files.removeSearchBreadcrumbs(this)'></i></span>",Layout.Page.container.find("#orgFileReset").show()):(resultHtml+="<span value='"+key+"'>"+key+"&nbsp;&nbsp; : &nbsp;&nbsp;"+ZPeople.escapeHtml(ZPeople.decodeTxt(val))+"<i onclick='Files.removeSearchBreadcrumbs(this)'></i></span>",Layout.Page.container.find("#orgFileReset").show())}),Layout.Page.container.find("#"+keyId).html(resultHtml),Files.showMoreFilter(keyId),Files.opnclsSearchBreadcrumbs("open")}else-1===Layout.Page.hash.indexOf("settings/categorylistview")&&(Layout.Page.container.find("#"+keyId).html(""),Files.opnclsSearchBreadcrumbs("close"))},clearAllOrgParams:function(){void 0!=Files.orgCatViewData.Org[2]&&(Files.orgCatViewData.Org[2].entityId=void 0,Files.orgCatViewData.Org[2].entityName="",Files.orgCatViewData.Org[2].unitId=void 0,Files.orgCatViewData.Org[2].unitName="",Files.orgCatViewData.Org[2].divisionId=void 0,Files.orgCatViewData.Org[2].divisionName="",Files.orgCatViewData.Org[2].deptId=void 0,Files.orgCatViewData.Org[2].deptName=""),void 0!=Files.orgListViewData.Org[2]&&(Files.orgListViewData.Org[2].entityId=void 0,Files.orgListViewData.Org[2].entityName="",Files.orgListViewData.Org[2].unitId=void 0,Files.orgListViewData.Org[2].unitName="",Files.orgListViewData.Org[2].divisionId=void 0,Files.orgListViewData.Org[2].divisionName="",Files.orgListViewData.Org[2].deptId=void 0,Files.orgListViewData.Org[2].deptName=""),Layout.Page.container.find("#s2id_zp_views_employeeentity").find("span").text(""),Layout.Page.container.find("#s2id_zp_views_employeeunit").find("span").text(""),Layout.Page.container.find("#s2id_zp_views_employeedivision").find("span").text(""),Layout.Page.container.find("#s2id_zp_views_employeedepartment").find("span").text("")},clearBreadCrumbOrgstr:function(obj,searchParams){if(void 0==obj)return Files.clearAllOrgParams(),void Layout.Page.container.find("#selectorgStructEntities").select2("val","location");Layout.Page.container.find(obj).parent().attr("value")===ZPeople.orgStructureDispNameMap.entity&&(Layout.Page.container.find("#s2id_zp_views_employeeentity").select2("val","-1"),void 0!=searchParams&&(searchParams.entityId="-1",searchParams.entityName=""),Files.orgListViewData.Org[2].entityId="-1",Files.orgListViewData.Org[2].entityName="",Files.empListViewData.All[2].entityId="-1",Files.empListViewData.All[2].entityName="",Layout.Page.container.find("#zp_views_employeeentity").val("")),Layout.Page.container.find(obj).parent().attr("value")===ZPeople.orgStructureDispNameMap.unit&&(Layout.Page.container.find("#s2id_zp_views_employeeunit").select2("val","-1"),void 0!=searchParams&&(searchParams.unitId="-1",searchParams.unitName=""),Files.orgListViewData.Org[2].unitId="-1",Files.orgListViewData.Org[2].unitName="",Files.empListViewData.All[2].unitId="-1",Files.empListViewData.All[2].unitName="",Layout.Page.container.find("#zp_views_employeeunit").val("")),Layout.Page.container.find(obj).parent().attr("value")===ZPeople.orgStructureDispNameMap.division&&(Layout.Page.container.find("#s2id_zp_views_employeedivision").select2("val","-1"),void 0!=searchParams&&(searchParams.divisionId="-1",searchParams.divisionName=""),Files.orgListViewData.Org[2].divisionId="-1",Files.orgListViewData.Org[2].divisionName="",Files.empListViewData.All[2].divisionId="-1",Files.empListViewData.All[2].divisionName="",Layout.Page.container.find("#zp_views_employeedivision").val("")),Layout.Page.container.find(obj).parent().attr("value")===ZPeople.orgStructureDispNameMap.department&&(Layout.Page.container.find("#s2id_zp_views_employeedepartment").select2("val","-1"),void 0!=searchParams&&(searchParams.deptId="-1",searchParams.deptName=""),Files.orgListViewData.Org[2].deptId="-1",Files.orgListViewData.Org[2].deptName="",Files.empListViewData.All[2].deptId="-1",Files.empListViewData.All[2].deptName="",Layout.Page.container.find("#zp_views_employeedepartment").val("")),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.component")&&(Files.clearAllOrgParams(),Layout.Page.container.find("#selectorgStructEntities").select2("val","location"))},removeSearchBreadcrumbs:function(obj){var documentfiltrId="filter_params_docFiles";if(-1!==Layout.Page.hash.indexOf("companyfile"))Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.folder")&&(Layout.Page.container.find("#companysearch_cat").select2("val","-1"),Files.orgListViewData.Org[2].catId="-1"),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.applicable")&&(Layout.Page.container.find("#companyFileViewType").select2("val","0"),Files.orgListViewData.Org[2].isExpiredFilesView=!1),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.location")&&(Layout.Page.container.find("#search_location").select2("val","-1"),Files.orgListViewData.Org[2].locationId="-1"),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.from")&&(Layout.Page.container.find("#companysearch_fromDate").val(""),Files.orgListViewData.Org[2].fromDate=""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.to")&&(Layout.Page.container.find("#companysearch_toDate").val(""),Files.orgListViewData.Org[2].toDate=""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.filename")&&(Layout.Page.container.find("#search_CFname").val(""),Files.orgListViewData.Org[2].searchFileName=""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.filesextn")&&(Layout.Page.container.find("#search_CFextn").select2("val","-1"),Files.orgListViewData.Org[2].searchFileExtn=""),Files.clearBreadCrumbOrgstr(obj,Files.orgListViewData.Org[2]);else if(-1!==Layout.Page.hash.indexOf("hrfile")){var searchParams={};-1!==Layout.Page.hash.indexOf("files/hrfile/all")?searchParams=Files.empListViewData.All[2]:-1!==Layout.Page.hash.indexOf("files/hrfile/sub")?searchParams=Files.empListViewData.Sub[2]:-1!==Layout.Page.hash.indexOf("files/hrfile/my")?searchParams=Files.empListViewData.My[2]:-1!==Layout.Page.hash.indexOf("files/hrfile/role")&&(searchParams=Files.empListViewData.Role[2]),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.folder")&&(Layout.Page.container.find("#search_cat").select2("val","-1"),searchParams.catId="-1"),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.location")&&(Layout.Page.container.find("#search_locationHr").select2("val","-1"),searchParams.locationId="-1"),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.applicable")&&(-1!==Layout.Page.hash.indexOf("hrfile/all")?(Layout.Page.container.find("#fileTypeData").select2("val","0"),searchParams.filterBy="all"):-1!==Layout.Page.hash.indexOf("hrfile/my")?(Layout.Page.container.find("#fileTypeData").select2("val","1"),searchParams.filterBy="my"):-1!==Layout.Page.hash.indexOf("hrfile/sub")&&(null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!0===hasAllReporteePerm?(Layout.Page.container.find("#fileTypeData").select2("val","7"),searchParams.filterBy="allsubordinates"):(Layout.Page.container.find("#fileTypeData").select2("val","6"),searchParams.filterBy="subordinates"))),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.role")&&(Layout.Page.container.find("#search_role").select2("val","-1"),searchParams.roleId="-1"),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.from")&&(Layout.Page.container.find("#hrsearch_fromDate").val(""),searchParams.fromDate=""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.to")&&(Layout.Page.container.find("#hrsearch_toDate").val(""),searchParams.toDate=""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.filename")&&(Layout.Page.container.find("#search_HFname").val(""),searchParams.searchFileName=""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.filesextn")&&(Layout.Page.container.find("#search_HFextn").select2("val","-1"),searchParams.searchFileExtn=""),-1!==Layout.Page.hash.indexOf("files/hrfile/all")?Files.empListViewData.All[2]=searchParams:-1!==Layout.Page.hash.indexOf("files/hrfile/sub")?Files.empListViewData.Sub[2]=searchParams:-1!==Layout.Page.hash.indexOf("files/hrfile/my")?Files.empListViewData.My[2]=searchParams:-1!==Layout.Page.hash.indexOf("files/hrfile/role")&&(Files.empListViewData.Role[2]=searchParams),Files.clearBreadCrumbOrgstr(obj,searchParams)}else if(-1!==Layout.Page.hash.indexOf("personalfile/listview"))Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.from")&&Layout.Page.container.find("#personalsearch_fromDate").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.to")&&Layout.Page.container.find("#personalsearch_toDate").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.filename")&&Layout.Page.container.find("#search_PFname").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.filesextn")&&Layout.Page.container.find("#search_PFextn").select2("val","-1");else if(-1!==Layout.Page.hash.indexOf("report/personalfile"))Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.filesextn")&&Layout.Page.container.find("#search_PFReportsExtn").select2("val","-1"),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.employee")&&Layout.Page.container.find("#select_employeelisting").select2("val","-Select-");else if(-1!==Layout.Page.hash.indexOf("report/acknowledge"))Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.from")&&Layout.Page.container.find("#acksearch_fromDate").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.to")&&Layout.Page.container.find("#acksearch_toDate").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.filename")&&Layout.Page.container.find("#search_ackname").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.filesextn")&&Layout.Page.container.find("#search_ackextn").select2("val","-1");else if(-1!==Layout.Page.hash.indexOf("files/zohosign/documentlistview")){if(Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.to")&&Layout.Page.container.find("#doc_sentto").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.from")&&Layout.Page.container.find("#doc_sentfrom").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.name")&&Layout.Page.container.find("input#search_documentname").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.status")&&Layout.Page.container.find("select#search_status").select2("val","select"),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.folder")&&Layout.Page.container.find("select#search_cat").select2("val","select"),"wf_To"===Layout.Page.container.find(obj).parent().attr("value")&&(documentfiltrId="wf_filter_params_docFiles",Layout.Page.container.find("#doc_sentto").val("")),"wf_From"===Layout.Page.container.find(obj).parent().attr("value")&&(documentfiltrId="wf_filter_params_docFiles",Layout.Page.container.find("#doc_sentfrom").val("")),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.wfstatus")&&(documentfiltrId="wf_filter_params_docFiles",Layout.Page.container.find("select#search_wfstatus").select2("val","select")),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.formname")&&(documentfiltrId="wf_filter_params_docFiles",Layout.Page.container.find("input#emailId_search").val(""),Layout.Page.container.find("#emailIdsearch").addClass("DNI"),Layout.Page.container.find("select#search_form").select2("val","select")),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.emailid")){documentfiltrId="wf_filter_params_docFiles",Layout.Page.container.find("input#emailId_search").val("");var tableName=$("#search_form").find("option:selected").attr("tablename");"P_Employee"!=tableName&&"P_Candidate"!=tableName||Layout.Page.container.find("#emailIdsearch").addClass("DNI")}if(Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.historyExportRecordId")&&(documentfiltrId="wf_filter_params_docFiles",Layout.Page.container.find("input#recordId_search").val("")),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.triggeredby")&&(documentfiltrId="wf_filter_params_docFiles",Layout.Page.container.find("select#search_perfrmdemp").select2("val","select")),"View Type"===Layout.Page.container.find(obj).parent().attr("value"))return documentfiltrId="wf_filter_params_docFiles",void Zohosign.resetFilter()}else-1!==Layout.Page.hash.indexOf("files/adobesign/agreementslistview")?(Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.to")&&Layout.Page.container.find("#agree_sentto").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.from")&&Layout.Page.container.find("#agree_sentfrom").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.name")&&Layout.Page.container.find("input#search_agname").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.status")&&Layout.Page.container.find("select#search_status").select2("val","select"),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.folder")&&Layout.Page.container.find("select#search_cat").select2("val","select")):-1!==Layout.Page.hash.indexOf("files/docusign/doculistview")?(Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.to")&&Layout.Page.container.find("#env_sentto").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.from")&&Layout.Page.container.find("#env_sentfrom").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.name")&&Layout.Page.container.find("input#search_envelopename").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.status")&&Layout.Page.container.find("select#search_status").select2("val","select"),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.folder")&&Layout.Page.container.find("select#search_cat").select2("val","select")):-1!==Layout.Page.hash.indexOf("files/zohosign/templatelistview")&&(Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.to")&&Layout.Page.container.find("#temp_sentto").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.from")&&Layout.Page.container.find("#temp_sentfrom").val(""),Layout.Page.container.find(obj).parent().attr("value")===ZPI18N.getString("zp.name")&&Layout.Page.container.find("input#search_view").val(""));Layout.Page.container.find(obj).parent().remove();var keyId="";-1!==Layout.Page.hash.indexOf("companyfile")?keyId="filter_params_orgfiles":-1!==Layout.Page.hash.indexOf("hrfile")?keyId="filter_params_hrfiles":-1!==Layout.Page.hash.indexOf("personalfile/listview")?keyId="filter_params_persfiles":-1!==Layout.Page.hash.indexOf("report/personalfile")?keyId="filter_params_pfreports":-1!==Layout.Page.hash.indexOf("report/acknowledge")?keyId="filter_params_ackreports":-1!==Layout.Page.hash.indexOf("files/zohosign/documentlistview")?keyId=documentfiltrId:-1!==Layout.Page.hash.indexOf("files/docusign/doculistview")?keyId="filter_params_envFiles":-1!==Layout.Page.hash.indexOf("files/adobesign/agreementslistview")?keyId="filter_params_agreeFiles":-1!==Layout.Page.hash.indexOf("zohosign/templatelistview")&&(keyId="filter_params_tempFiles"),""===Layout.Page.container.find("#"+keyId).html()&&Files.opnclsSearchBreadcrumbs("close",!0),Files.setSearchValuesInDiv(),-1!==Layout.Page.hash.indexOf("companyfile")?-1!==Layout.Page.hash.indexOf("listview")||-1!==Layout.Page.hash.indexOf("/view-categoryId")?Files.searchCompanyFiles():-1!==Layout.Page.hash.indexOf("catview")&&Files.searchCatView("1"):-1!==Layout.Page.hash.indexOf("hrfile")?-1!==Layout.Page.hash.indexOf("listview")||-1!==Layout.Page.hash.indexOf("view-categoryId")?Files.searchHrFiles():-1!==Layout.Page.hash.indexOf("catview")&&Files.searchCatView("0"):-1!==Layout.Page.hash.indexOf("personalfile/listview")?Files.searchPersonalFiles():-1!==Layout.Page.hash.indexOf("report/personalfile")?Files.Reports.searchPFReports():-1!==Layout.Page.hash.indexOf("report/acknowledge")?Files.Reports.searchAcknowledgement():-1!==Layout.Page.hash.indexOf("files/zohosign/documentlistview")?"wf_filter_params_docFiles"==documentfiltrId?Zohosign.getDocumentList("","","search","","","","WorkFlowReports"):Zohosign.getDocumentList("","","search"):-1!==Layout.Page.hash.indexOf("files/adobesign/agreementslistview")?Agreements.getAgreementsList(0,"search",!0):-1!==Layout.Page.hash.indexOf("files/docusign/doculistview")?Envelope.getEnvelopeList("","","search"):-1!==Layout.Page.hash.indexOf("files/zohosign/templatelistview")&&Zohosign.getETemplateList("","","search")},resetBreadCrumbs:function(){Files.resetVals(),Files.clearBreadCrumbOrgstr(),-1!==Layout.Page.hash.indexOf("companyfile/listview")||-1!==Layout.Page.hash.indexOf("companyfile/view")?Files.searchCompanyFiles():-1!==Layout.Page.hash.indexOf("companyfile/catview")?Files.searchCatView("1"):-1!==Layout.Page.hash.indexOf("hrfile")?-1!==Layout.Page.hash.indexOf("/listview")||-1!==Layout.Page.hash.indexOf("/view")?Files.searchHrFiles():-1!==Layout.Page.hash.indexOf("/catview")&&Files.searchCatView("0"):-1!==Layout.Page.hash.indexOf("personalfile/listview")?Files.searchPersonalFiles():-1!==Layout.Page.hash.indexOf("report/personalfile")?Files.Reports.searchPFReports():-1!==Layout.Page.hash.indexOf("report/acknowledge")?Files.Reports.searchAcknowledgement():-1!==Layout.Page.hash.indexOf("files/zohosign/documentlistview")?Zohosign.resetFilter():-1!==Layout.Page.hash.indexOf("files/adobesign/agreementslistview")?Agreements.resetFilter():-1!==Layout.Page.hash.indexOf("files/docusign/doculistview")?Envelope.resetFilter():-1!==Layout.Page.hash.indexOf("files/zohosign/templatelistview")&&Zohosign.resetEsignTempFilter(),Files.opnclsSearchBreadcrumbs("close",!0)},getFileDetailsForFeeds:function(fileId){var formData=new FormData;formData.append("methodName","getFileDetailsForFeeds"),formData.append("conreqcsr",csrfToken),formData.append("fileId",fileId);var result={};return $.ajax({url:Files.ACTION.URL,type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){void 0!==resultData[1]&&(result=resultData[1])}}),result[0]},changefileType:function(mode){"employee"===mode?(Layout.Page.container.find("#roleFilePermsDiv").hide(),Layout.Page.container.find("#empFilePermsDiv").show(),Layout.Page.container.find("#empSelect_Div,#confidentSelect_Div,#reportingtoSelect_Div").show(),Layout.Page.container.find("#roleSelect_Div").hide(),Layout.Page.container.find("#isEmpDownload_Div").show(),Layout.Page.container.find("#isRMDownload_Div").show(),null!=ZPeople.orgStructureTagMap&&(!0===ZPeople.orgStructureTagMap.entity&&Layout.Page.container.find("#employee_entity").parent().removeClass("DNI"),!0===ZPeople.orgStructureTagMap.unit&&Layout.Page.container.find("#employee_unit").parent().removeClass("DNI"),!0===ZPeople.orgStructureTagMap.division&&Layout.Page.container.find("#employee_division").parent().removeClass("DNI"),!0===ZPeople.orgStructureTagMap.department&&Layout.Page.container.find("#employee_department").parent().removeClass("DNI")),Layout.Page.container.find("#locViewfilter").show()):"role"===mode?(Layout.Page.container.find("#empFilePermsDiv").hide(),Layout.Page.container.find("#roleFilePermsDiv").show(),Layout.Page.container.find("#roleSelect_Div").show(),Layout.Page.container.find("#empSelect_Div,#confidentSelect_Div,#reportingtoSelect_Div").hide(),Layout.Page.container.find("#isEmpDownload_Div").hide(),Layout.Page.container.find("#isRMDownload_Div").hide(),null!=ZPeople.orgStructureTagMap&&(!0===ZPeople.orgStructureTagMap.entity&&Layout.Page.container.find("#employee_entity").parent().addClass("DNI"),!0===ZPeople.orgStructureTagMap.unit&&Layout.Page.container.find("#employee_unit").parent().addClass("DNI"),!0===ZPeople.orgStructureTagMap.division&&Layout.Page.container.find("#employee_division").parent().addClass("DNI"),!0===ZPeople.orgStructureTagMap.department&&Layout.Page.container.find("#employee_department").parent().addClass("DNI")),Layout.Page.container.find("#locViewfilter").hide()):"filterView"===mode&&("3"===Layout.Page.container.find("#fileTypeData").val()?(Layout.Page.container.find("#roleViewfilter").show(),null!=ZPeople.orgStructureTagMap&&(!0===ZPeople.orgStructureTagMap.entity&&Layout.Page.container.find("#employee_entity").parent().addClass("DNI"),!0===ZPeople.orgStructureTagMap.unit&&Layout.Page.container.find("#employee_unit").parent().addClass("DNI"),!0===ZPeople.orgStructureTagMap.division&&Layout.Page.container.find("#employee_division").parent().addClass("DNI"),!0===ZPeople.orgStructureTagMap.department&&Layout.Page.container.find("#employee_department").parent().addClass("DNI")),Layout.Page.container.find("#locViewfilter").hide()):(Layout.Page.container.find("#roleViewfilter").hide(),null!=ZPeople.orgStructureTagMap&&(!0===ZPeople.orgStructureTagMap.entity&&Layout.Page.container.find("#employee_entity").parent().removeClass("DNI"),!0===ZPeople.orgStructureTagMap.unit&&Layout.Page.container.find("#employee_unit").parent().removeClass("DNI"),!0===ZPeople.orgStructureTagMap.division&&Layout.Page.container.find("#employee_division").parent().removeClass("DNI"),!0===ZPeople.orgStructureTagMap.department&&Layout.Page.container.find("#employee_department").parent().removeClass("DNI")),Layout.Page.container.find("#locViewfilter").show()))},switchBulkImport:function(mode){"1"===mode?(Layout.Page.container.find("#import_hrfileDiv").find(".addFile").show(),Layout.Page.container.find("#import_hrfileDiv").find("#empSelect_Div").hide(),Layout.Page.container.find("#import_hrfileDiv").find("#manyEmpNote").removeClass("DN"),Layout.Page.container.find("#import_hrfileDiv").find("#specEmpNote").text(ZPI18N.getString("zp.files.importnote6",new Array(Files.hrfiledisname))),Layout.Page.container.find("#import_hrfileDiv").find("#specEmpNote").addClass("DN")):"2"===mode?(Layout.Page.container.find("#import_hrfileDiv").find(".addFile").hide(),Layout.Page.container.find("#import_hrfileDiv").find("#select_employeelisting").select2(),Files.constructemp_addrev("activeEmp"),Layout.Page.container.find("#import_hrfileDiv").find("#empSelect_Div").show(),Layout.Page.container.find("#import_hrfileDiv").find("#select_employeelisting").select2("val","-Select-"),Layout.Page.container.find("#import_hrfileDiv").find("#manyEmpNote").addClass("DN"),Layout.Page.container.find("#import_hrfileDiv").find("#specEmpNote").text(ZPI18N.getString("zp.files.importnote6",new Array(Files.hrfiledisname))),Layout.Page.container.find("#import_hrfileDiv").find("#specEmpNote").removeClass("DN")):"3"===mode?Layout.Page.container.find("#import_hrfileDiv").find("#catforImport_Div").show():"4"===mode&&Layout.Page.container.find("#import_hrfileDiv").find("#catforImport_Div").hide()},importBulkHrFiles:function(){if(0==loginUserRoleCheck||1==loginUserRoleCheck)if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.updateHRFile(form)},function(){isBlocked=!0,Files.Geo.positionBlocked(),Files.updateHRFile(form)}),isBlocked||$(document).on("click",function(e){Files.Geo.positionBlocked(),-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||!ZPSetupCommon.isEmpty($(e.target).attr("class"))&&$(e.target).text()===ZPI18N.getString("zp.submit")||(pageLoaded=!0,Files.updateHRFile(form))})}else{var mainObj=Layout.Page.container.find("div#import_hrfileDiv"),fileObj=mainObj.find("input#uploadfile")[0].files[0],error=!1,isShareReportingTo="0",isConfidential="0",isacknowledge="0";!0===mainObj.find("#isAcknowledge").is(":checked")&&(isacknowledge="1"),!1===mainObj.find("#isUserShared").is(":checked")&&(isConfidential="1"),!0===mainObj.find("#isUserShared").is(":checked")&&!1===mainObj.find("#isEmpDownload").is(":checked")&&(isConfidential="2"),!0===mainObj.find("#isReportingTo").is(":checked")&&(isShareReportingTo="1"),!0===mainObj.find("#isReportingTo").is(":checked")&&!1===mainObj.find("#isRMDownload").is(":checked")&&(isShareReportingTo="2");var isFolderImport=!!mainObj.find("input#folderImp").is(":checked"),isEmpwiseImp=!!mainObj.find("input#specEmpImp").is(":checked"),desc=mainObj.find("#fileDesc").val(),catId=mainObj.find("select#hrselect_Cat").val(),notifyMail=!!mainObj.find("input#notify").is(":checked"),notifyFeeds=!!mainObj.find("input#notifyFeeds").is(":checked"),formData=new FormData,fileId=Files.udsParams.fileId,fileVersion=Files.udsParams.fileVersion,maxSizeForImport=1e6*maxFileSizeForImport.split("MB")[0];if(formData.append("methodName","bulkImport"),formData.append("conreqcsr",csrfToken),formData.append("fileName",mainObj.find("#importFileName").text()),formData.append("importFileId",fileId),formData.append("fileVersion",fileVersion),formData.append("fileDesc",desc),formData.append("fileType","0"),mainObj.find("span#errormsg,span#hrcategory_err").remove(),formData.append("notifyToall",notifyMail),formData.append("notifyFeeds",notifyFeeds),formData.append("isAcknowledgement",isacknowledge),formData.append("confidential",isConfidential),formData.append("isreportingTo",isShareReportingTo),formData.append("isFolderImport",isFolderImport),formData.append("isEmpwiseImp",isEmpwiseImp),-1==desc.indexOf("<")&&-1==desc.indexOf(">")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.description")))),error=!0),fileObj?fileObj.type.indexOf("zip")>-1?fileObj.size>maxSizeForImport&&(error=!0,mainObj.find("div#err").after('<span class="ERR" id="errormsg">'+ZPI18N.getString("zp.filesizelimit",[maxFileSizeForImport])+"</span>")):(error=!0,mainObj.find("div#err").after('<span class="ERR" id="errormsg">'+ZPI18N.getString("zp.fileimportformat")+"</span>")):"workDriveUpload"==Files.uploadMode?(formData.append("uploadFromWD",JSON.stringify(Files.importWDarray)),formData.append("uploadMode",Files.uploadMode)):(error=!0,mainObj.find("div#err").after('<span class="ERR" id="errormsg">'+ZPI18N.getString("zp.choosefile")+"</span>")),fileObj&&"localUpload"==Files.uploadMode&&"-1"==Files.udsParams.fileId&&(error=!0,ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.fileuploaderror"))),!isFolderImport)if(mainObj.find("div#s2id_hrselect_Cat").is(":visible"))"-1"===catId||null===catId||""===catId?(error=!0,mainObj.find("select#hrselect_Cat").after('<span class="ERR" id="hrcategory_err">'+ZPI18N.getString("zp.selectcategory")+"</span>")):formData.append("catId",catId);else{var newCatName=mainObj.find("input#hrnewCategory").val();mainObj.find("input#hrnewCategory").is(":visible")&&ZPSetupCommon.isEmpty(newCatName)?(error=!0,mainObj.find("#hrnewCategory").after('<span class="ERR" id="hrcategory_err">'+ZPI18N.getString("zp.enterCategory")+"</span>")):(-1==newCatName.indexOf("<")&&-1==newCatName.indexOf(">")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.folder")))),error=!0),mainObj.find("#hrselect_Cat").parent().find("span#hrcategory_err").remove(),formData.append("newCatName",newCatName))}if(isEmpwiseImp){var empId=Layout.Page.container.find("#import_hrfileDiv").find("#select_employeelisting").val();null!==empId&&void 0!==empId&&"-Select-"!==empId&&"-1"!==empId&&formData.append("employeeId",empId)}else{var formatfields=[],firstfieldvalue=mainObj.find("#firstfield").val(),secondfieldvalue=mainObj.find("#secondfield").val(),thirdfieldvalue=mainObj.find("#thirdfield").val(),importformatseparator=null;null!=firstfieldvalue&&" "!=firstfieldvalue&&""!=firstfieldvalue?($("#choosefileformat_err").remove(),null!=firstfieldvalue&&$.each(labelnameVsdispname,function(key,value){value==firstfieldvalue&&formatfields.push(key)}),null!=secondfieldvalue&&" "!=secondfieldvalue&&""!=secondfieldvalue&&"undefined"!=typeof Fname&&"undefined"!=typeof Lname&&"undefined"!=typeof empid&&(secondfieldvalue===Fname||secondfieldvalue===Lname||secondfieldvalue===empid?$.each(labelnameVsdispname,function(key,value){value==secondfieldvalue&&formatfields.push(key)}):"-"!==secondfieldvalue&&"_"!==secondfieldvalue||(importformatseparator=secondfieldvalue)),null!=thirdfieldvalue&&" "!=thirdfieldvalue&&""!=thirdfieldvalue&&"undefined"!=typeof Fname&&"undefined"!=typeof Lname&&"undefined"!=typeof empid&&(thirdfieldvalue===Fname||thirdfieldvalue===Lname||thirdfieldvalue===empid?$.each(labelnameVsdispname,function(key,value){value==thirdfieldvalue&&formatfields.push(key)}):"-"!==thirdfieldvalue&&"_"!==thirdfieldvalue||(importformatseparator=thirdfieldvalue)),formData.append("listOfFields",formatfields),null!=importformatseparator?formData.append("importformatseparator",importformatseparator):formData.append("importformatseparator","")):(error=!0,$("#choosefileformat_err").remove(),mainObj.find("#firstfield").after('<span class="ERR" id="choosefileformat_err" style="padding-top:10px">'+ZPI18N.getString("zp.enterfileformat")+"</span>"))}if(error)return;if(mainObj.find(".ZPUFile").find("div[data-progressjs]").length>0&&(null==Files.uploadMode||""===Files.uploadMode||"workDriveUpload"==!Files.uploadMode))return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.fileuploadInProgress",new Array(ZPI18N.getString("zp.description"))));isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(formData.append("latitude",Files.Geo.position.coords.latitude),formData.append("longitude",Files.Geo.position.coords.longitude)),mainObj.find("div#zp_page_loading").show(),mainObj.find("form#hrfileupload").hide(),mainObj.find("button#bulk_import_click").addClass("disabled"),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.importfilesnotify")),mainObj.modal("hide")},error:function(req){mainObj.modal("hide");var errResponse=req.responseJSON[1];8103!==req.status&&8101!==req.status&&500!==req.status&&8110!==req.status&&7570!==req.status||ZPeople.Message.showFailureMsg(errResponse.msg)}})}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"))},constructAddHRFile:function(){var addpage='<div aria-labelledby="myModalLabel" role="dialog"  id="add_hrfileDiv" class="modal popRgtModel ZPRpanel" aria-hidden="false"><div role="document" class="modal-dialog"><div class="modal-content"><div class="modal-header"><h6 class="addPopTitle" id="addFile_header"></h6>';if(MMtemplte.templateAddHR?addpage+='<button type="button" onclick=MMtemplte.constructTemplateList("form",null,null,this,"Download") class="close" data-dismiss="modal" aria-label="Close" ><span aria-hidden="true"><div class="IC-cls-1px red S21 CP"></div></span></button> </div><div class="modal-body" id="add_hrfileInnerDivLoading"></div><div class="modal-body DN" id="add_hrfileInnerDiv">':addpage+='<button type="button" class="close" data-dismiss="modal" aria-label="Close" ><span aria-hidden="true"><div class="IC-cls-1px red S21 CP"></div></span></button> </div><div class="modal-body" id="add_hrfileInnerDivLoading"></div><div class="modal-body DN" id="add_hrfileInnerDiv">',addpage+='<iframe style="display:none" src="'+ZPeople.getResourceURL(htmlUrl+"blank.html")+'"  name="uploadframe" scrolling="auto" width="0" height="0" frameborder="0" ></iframe><form  class="form-horizontal pad" method="post"  enctype="multipart/form-data" name="hrfileupload" id="hrfileupload" target="uploadframe">',addpage+='<div class="form-group" id="hr_fileField"><label class="control-label col-sm-3 zp_mdt"><font>'+ZPI18N.getString("zp.file")+'</font></label> <div class="col-sm-6"> <div class="ZPUFile"><div class="ZPUlft" id="beforeUpload"><span>'+ZPI18N.getString("zp.upload")+ZPI18N.getString("zp.files.from")+'</span><div class="ZPCfile"><span>'+ZPI18N.getString("zp.files.desktop")+'</span><div class="ZPFfile OH"><input type="file" class="form-control" onchange="Files.changeOnUpload($(this).val(), "localUpload")" name="uploadfile" id="uploadfile"></div></div>',ZPeople.isChinaSetup||(addpage+='<span class="dgry ML2 MR2">'+ZPI18N.getString("zp.or")+'</span><a onclick="Files.showCloudPickerModal(ZPeople.cloudPickerGadgetsUrl)">'+ZPI18N.getString("zp.others")+"</a>"),addpage+='</div><div class="ZPUlft DN" id="afterUpload"><span id="drop_file"><span></span><i class="IC-cls-r red" onclick="Files.toggleFileFieldDisplay()"></i></span></div></div> <div class="ZPMxlt PSI"><i data-content="<p>'+ZPI18N.getString("zp.maxfileuploadsize")+'</p>" aria-describedby="popover574870"  data-popover="true" data-html="true" data-toggle="popover" data-placement="bottom" class="IC-info S18 gry form-icon popHover"></i></div></div></div>',addpage+='<div id="fileName" class="form-group"><label class="control-label col-sm-3">'+ZPI18N.getString("zp.filename")+'</label><div class="col-sm-6"><input type="name"  class="form-control"></div></div>',addpage+='<div class="form-group"> <label class="control-label col-sm-3">'+ZPI18N.getString("zp.applicable")+'</label><div class="col-sm-6"><div class="MB10" id="empBased"><label class="radio DIB MR10"><input id="zp_hrfile_employeebaseID" type="radio" name="apdate" onClick="Files.changefileType("employee")"><span>'+ZPI18N.getString("zp.employeebase")+"</span></label>",MMtemplte.templateAddHR||0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(addpage+='<label class="radio DIB MR10"><input id="zp_hrfile_roleID" type="radio" name="apdate" onClick="Files.changefileType("role")"><span>'+ZPI18N.getString("zp.rolebase")+"</span></label>"),addpage+='</div></div></div><div class="form-group" id="empSelect_Div"><label class="control-label col-sm-3">'+ZPI18N.getString("zp.employee")+'</label><div class="col-sm-6" id="outerEmp"><select  id="select_employeelisting"></select></div></div>',!MMtemplte.templateAddHR&&(0==loginUserRoleCheck||1==loginUserRoleCheck)){addpage+='<div class="form-group" id="roleSelect_Div" style="display:none"><label class="control-label col-sm-3">'+ZPI18N.getString("zp.role")+'</label><div class="col-sm-6" id="role_select" ><select  id="select_role" multiple placeholder="Select">';for(var i=0;i<roleTypes.length;i++)addpage+='<option value="'+roleTypes.roleId+'">'+roleType.roleName+"</option>";addpage+="</select></div></div>"}return addpage+='<div class="form-group" id="confidentSelect_Div"><div class="col-sm-offset-3 col-sm-6"><label class="checkbox DIB MBI5"><input id="isconfident" type="checkbox"><span>'+ZPI18N.getString("zp.confidential")+'</span></label></div></div><div class="form-group" id="reportingtoSelect_Div">',addpage+='<div class="col-sm-offset-3 col-sm-6"><label class="checkbox DIB MBI5"><input id="isReportingTo" type="checkbox"><span>'+ZPI18N.getString("zp.sharereporting")+"</span></label></div></div>",addpage+='<div class="form-group"><label class="control-label col-sm-3">'+ZPI18N.getString("zp.description")+'</label><div class="col-sm-6"><textarea class="form-control" rows="5" style="max-width:100%;" id="fileDesc"></textarea></div></div>',addpage+='<div class="form-group"><label class="control-label col-sm-3 zp_mdt"><font>'+ZPI18N.getString("zp.folder")+'</font></label> <div class="col-sm-6" id="hrCatselect">',addpage+='<select id="hrselect_Cat" placeholder="Select" onchange="Files.clearErrmsg("hrcategory_err")"></select><input type="name" class="form-control" id="hrnewCategory" style="display:none"></div>',addpage+='<div class="col-sm-3" id="cancel_hrCat_btn" style="display:none"><input type="button" onclick=Files.cancelnewCategory("hr") class="btn btn-default btn-sm MT5" value="'+ZPI18N.getString("zp.cancel")+'"></div></div>',addpage+='<div class="form-group"> <div class="col-sm-offset-3 col-sm-6"><label class="checkbox DIB MBI5"><input id="notify" type="checkbox"><span>'+ZPI18N.getString("zp.notifyemail")+"</span></label></div></div>",addpage+='<div class="form-group"><div class="col-sm-offset-3 col-sm-6"><label class="checkbox DIB MBI5"><input id="notifyFeeds" type="checkbox"><span>'+ZPI18N.getString("zp.notifyFeeds")+"</span></label></div></div>",addpage+='<input type="hidden" value="" name="conreqcsr" id="formBizcpn"/><input type="hidden" value="0" name="editFileId" id="editFileId"/></form></div>',addpage+='<div id="submithrfile" class="modal-footer text-left"><button class="btn btn-primary" type="button"   onclick="Files.updateHRFile()">'+ZPI18N.getString("zp.submit")+"</button>",MMtemplte.templateAddHR?addpage+='<button class="btn btn-default" onclick=MMtemplte.constructTemplateList("form",null,null,this,"Download") type="button" class="close" data-dismiss="modal" aria-label="Close" >'+ZPI18N.getString("zp.cancel")+"</button></div>":addpage+='<button class="btn btn-default" hide - data-dismiss="modal"   type="button">'+ZPI18N.getString("zp.cancel")+"</button></div>",addpage+="</div></div></div>"},showAddHRFile:function(mode,obj,submode){var empBased,pageId;if($("#add_hrfileInnerDiv").find("input[type=checkbox]").prop("checked",!1),"mailmerge"==mode?(pageId=$("#page-wrapper").find("#add_hrfileDiv"),empBased=$("#page-wrapper").find("#add_hrfileDiv").find("#empBased")):(pageId=Layout.Page.hash.indexOf("#selfservice/user/files")>-1?Layout.Page.parentContainer.parent().find("#add_hrfileDiv"):Layout.Page.container.find("#add_hrfileDiv"),empBased=Layout.Page.hash.indexOf("selfservice/user/files")>-1?Layout.Page.parentContainer.parent().find("#add_hrfileDiv").find("#empBased"):Layout.Page.container.find("#add_hrfileDiv").find("#empBased")),Files.isIprestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")),pageId.find("#add_hrfileDiv").modal("hide");else if(Files.isGeorestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));else{pageId.find("#select_employeelisting").select2(),pageId.modal("show"),pageId.find("#add_hrfileInnerDivLoading").html(ZPeople.LOADING_HTML),pageId.find("#add_hrfileInnerDiv").hide(),pageId.find(".modal-footer").show(),pageId.find(".ERR").remove(),Files.cancelnewCategory("hr"),pageId.find(empBased.find("input"))[0].checked=!0,pageId.find("#select_role").select2({placeholder:ZPI18N.getString("zp.select")}),"mailmerge"!=mode&&(pageId.find("#isUserShared")[0].checked=!0,pageId.find("#isEmpDownload")[0].checked=!0,pageId.find("#isRMDownload")[0].checked=!1,pageId.find("#roleDownload")[0].checked=!0),pageId.find("#notify")[0].checked=!1;var isNewUI=ZPeople.isZPNewUI();if("edit"===mode){pageId.find("#hrselect_Cat").html(""),pageId.find("#uploadfile").val(""),Files.FilescatList("hr","hrselect_Cat","s2id_hrselect_Cat"),isNewUI?pageId.find("#addFile_header").html(ZSEC.Encoder.encodeForHTML(Files.edithrfiledisname)):pageId.find("#addFile_header").html(ZPI18N.getString("zp.edithrfiles"));var editData=$(obj).parent().parent().parent().data().ldata;"uploadmode"==submode?(pageId.find("#hr_fileField").show(),Files.changeOnUpload(ZPeople.decodeTxt(editData.fileName),"localUpload")):pageId.find("#hr_fileField").hide(),pageId.find("#fileName").val(ZPeople.decodeTxt(editData.fileName)),"null"!==editData.fileDesc&&void 0!==editData.fileDesc&&pageId.find("#fileDesc").val(ZPeople.decodeTxt(editData.fileDesc)),pageId.find("#hrselect_Cat").select2("val",editData.fileCategoryID),pageId.find("#filetype").val(editData.fileType),pageId.find("#editFileId").val(editData.fileID),1===editData.fileAcknowledge?pageId.find("#isAcknowledge").prop("checked",!0):pageId.find("#isAcknowledge").prop("checked",!1),""!==editData.fileOwnerID&&void 0!==editData.fileOwnerID?(pageId.find(empBased.find("input"))[0].checked=!0,void 0!==pageId.find(empBased.find("input"))[1]&&(pageId.find(empBased.find("input"))[1].checked=!1),pageId.find("#empSelect_Div,#confidentSelect_Div,#reportingtoSelect_Div").show(),pageId.find("#roleSelect_Div").hide(),pageId.find("#select_employeelisting").select2("val",editData.fileOwnerID),Layout.Page.container.find("#roleFilePermsDiv").hide(),Layout.Page.container.find("#empFilePermsDiv").show(),1===editData.fileConfident?(pageId.find("#isUserShared")[0].checked=!1,pageId.find("#isEmpDownload")[0].checked=!1):2===editData.fileConfident?(pageId.find("#isUserShared")[0].checked=!0,pageId.find("#isEmpDownload")[0].checked=!1):(pageId.find("#isUserShared")[0].checked=!0,pageId.find("#isEmpDownload")[0].checked=!0),1===editData.isreportingTo?(pageId.find("#isReportingTo")[0].checked=!0,pageId.find("#isRMDownload")[0].checked=!0):2===editData.isreportingTo?(pageId.find("#isReportingTo")[0].checked=!0,pageId.find("#isRMDownload")[0].checked=!1):(pageId.find("#isReportingTo")[0].checked=!1,pageId.find("#isRMDownload")[0].checked=!1)):(pageId.find(".select2-input").css("width","100%"),pageId.find("#select_role").select2({placeholder:ZPI18N.getString("zp.select")}),pageId.find(empBased.find("input"))[0].checked=!1,pageId.find(empBased.find("input"))[1].checked=!0,pageId.find("#roleSelect_Div").show(),pageId.find("#empSelect_Div,#confidentSelect_Div,#reportingtoSelect_Div").hide(),pageId.find("#select_role").select2("val",editData.fileRoleID),Layout.Page.container.find("#empFilePermsDiv").hide(),Layout.Page.container.find("#roleFilePermsDiv").show(),1===editData.fileConfident?pageId.find("#roleDownload")[0].checked=!1:pageId.find("#roleDownload")[0].checked=!0)}else if("mailmerge"==mode){var wrapperId=$("#page-wrapper"),recordId=Layout.Page.hash.split("recordId:")[1];void 0==recordId&&(recordId=ZPForm.CURRFORM_PARAM.recordId),ZPSetupCommon.isEmpty(recordId)&&(recordId=Layout.Page.hash.indexOf("home/dashboard/feeds")>-1?pageId.find("input#recordId").val():wrapperId.find("#download_mailmerge").attr("recordId"));var modalObj=wrapperId.find("#download_mailmerge"),formId=ZPSetupCommon.isEmpty(Layout.Page.urlparam.formId)?modalObj.attr("formId"):Layout.Page.urlparam.formId;void 0==formId&&(formId=ZPForm.CURRFORM_PARAM.formId),isNewUI?pageId.find("#addFile_header").html(ZSEC.Encoder.encodeForHTML(Files.addhrfiledisname)):pageId.find("#addFile_header").html(ZPI18N.getString("zp.addhrfiles")),pageId.find(empBased.find("input")).checked=!1,void 0!==pageId.find(empBased.find("input"))[1]?(pageId.find(empBased.find("input"))[1].checked=!0,pageId.find("#empSelect_Div,#confidentSelect_Div,#reportingtoSelect_Div").hide(),pageId.find("#roleSelect_Div").show()):(pageId.find(empBased.find("input"))[0].checked=!0,pageId.find("#empSelect_Div,#confidentSelect_Div,#reportingtoSelect_Div").show()),pageId.find("#beforeUpload").addClass("DN"),pageId.find("#afterUpload").removeClass("DN"),pageId.find("#drop_file").addClass("DN"),pageId.find("#hr_fileField").addClass("DN"),pageId.find("#fileName").addClass("DN"),pageId.find("#fileDesc").val(""),pageId.find("#hrselect_Cat").select2("val",""),pageId.find("#uploadfile").val(""),pageId.find("#editFileId").val("0"),pageId.find("#hrselect_Cat").html(""),Files.FilescatList("hr","hrselect_Cat","s2id_hrselect_Cat","",formId),pageId.find("#hrCatselect").select2("val","Select"),pageId.find("#select_employeelisting").select2("val","-Select-")}else if(pageId.find("#select_role").select2({placeholder:ZPI18N.getString("zp.select")}),2==loginUserRoleCheck?pageId.find("#select_employeelisting").select2("val","-Select-"):pageId.find("#select_employeelisting").select2("val",erecno),isNewUI?pageId.find("#addFile_header").html(ZSEC.Encoder.encodeForHTML(Files.addhrfiledisname)):pageId.find("#addFile_header").html(ZPI18N.getString("zp.addhrfiles")),"0"===Layout.Page.container.find("#fileTypeData").val()||"5"===Layout.Page.container.find("#fileTypeData").val()||-1!==Layout.Page.hash.indexOf("hrfile/sub")||-1!==Layout.Page.hash.indexOf("hrfile/my")?(pageId.find(empBased.find("input"))[0].checked=!0,void 0!==pageId.find(empBased.find("input"))[1]&&(pageId.find(empBased.find("input"))[1].checked=!1),pageId.find("#empSelect_Div,#confidentSelect_Div,#reportingtoSelect_Div").show(),pageId.find("#isEmpDownload_Div,#isRMDownload_Div").show(),pageId.find("#roleSelect_Div").hide(),pageId.find("#select_role").select2("val",""),Layout.Page.container.find("#empFilePermsDiv").show(),Layout.Page.container.find("#roleFilePermsDiv").hide()):(pageId.find(empBased.find("input"))[0].checked=!1,void 0!==pageId.find(empBased.find("input"))[1]?(pageId.find(empBased.find("input"))[1].checked=!0,pageId.find("#empSelect_Div,#confidentSelect_Div,#reportingtoSelect_Div").hide(),pageId.find("#isEmpDownload_Div,#isRMDownload_Div").hide(),pageId.find("#roleSelect_Div").show(),pageId.find("#select_role").select2("val",""),Layout.Page.container.find("#empFilePermsDiv").hide(),Layout.Page.container.find("#roleFilePermsDiv").show()):(pageId.find(empBased.find("input"))[0].checked=!0,pageId.find("#empSelect_Div,#confidentSelect_Div,#reportingtoSelect_Div").show(),Layout.Page.container.find("#empFilePermsDiv").show(),Layout.Page.container.find("#roleFilePermsDiv").hide())),pageId.find("#beforeUpload").removeClass("DN"),pageId.find("#afterUpload").addClass("DN"),pageId.find("#hr_fileField").show(),pageId.find("#fileName").val(""),pageId.find("#fileDesc").val(""),pageId.find("#hrselect_Cat").select2("val",""),pageId.find("#uploadfile").val(""),pageId.find("#editFileId").val("0"),pageId.find("#hrselect_Cat").html(""),Files.FilescatList("hr","hrselect_Cat","s2id_hrselect_Cat"),pageId.find("#hrselect_Cat").select2("val",[-1]),-1!==Layout.Page.hash.indexOf("/view")){var categoryId=Layout.Page.urlparam.categoryId;pageId.find("#hrselect_Cat").select2("val",categoryId)}pageId.find("#add_hrfileInnerDivLoading").hide(),pageId.find("#add_hrfileInnerDiv").show(),Files.uploadMode="",Files.uploadedDocObj={},pageId.find(".select2-input").css("width","100%")}},allowDownloadOptsHrFiles:function(mode,isImport){var pageId=Layout.Page.hash.indexOf("#selfservice/user/files")>-1?Layout.Page.parentContainer.parent().find("#add_hrfileDiv"):Layout.Page.container.find("#add_hrfileDiv");void 0!=isImport&&!0===isImport&&(pageId=Layout.Page.container.find("#import_hrfileDiv")),"1"===mode?pageId.find("#isUserShared")[0].checked?pageId.find("#isEmpDownload_Div").show():pageId.find("#isEmpDownload_Div").hide():"2"===mode?pageId.find("#isReportingTo")[0].checked?pageId.find("#isRMDownload")[0].checked=!0:pageId.find("#isRMDownload")[0].checked=!1:"3"===mode&&pageId.find("#isRMDownload")[0].checked&&(pageId.find("#isReportingTo")[0].checked=!0)},searchHrFiles:function(mapPos,mode){var errflag=!1,searchbyCat="-1",searchbyEmp="-1",searchbyLoc="-1",searchbyRoleId=Layout.Page.container.find("#search_role").val(),searchbyInactiveEmp="-1",searchbyLogDisEmp="-1",searchbySubEmp="-1",searchbyAllSubEmp="-1",searchbyEntity="-1",searchbyUnit="-1",searchbyDivision="-1",searchbyDept="-1";"-1"!==searchbyRoleId&&void 0!==searchbyRoleId&&(searchbyEmp="-1"),-1!==Layout.Page.hash.indexOf("view-categoryId")?searchbyCat=Layout.Page.urlparam.categoryId:""!==Layout.Page.container.find("#search_cat").val()&&null!==Layout.Page.container.find("#search_cat").val()&&void 0!==Layout.Page.container.find("#search_cat").val()&&(searchbyCat=Layout.Page.container.find("#search_cat").val()),""!==Layout.Page.container.find("#search_ActEmp").val()&&null!==Layout.Page.container.find("#search_ActEmp").val()&&void 0!==Layout.Page.container.find("#search_ActEmp").val()&&(searchbyEmp=Layout.Page.container.find("#search_ActEmp").val()),""!==Layout.Page.container.find("#search_locationHr").val()&&null!==Layout.Page.container.find("#search_locationHr").val()&&void 0!==Layout.Page.container.find("#search_locationHr").val()&&(searchbyLoc=Layout.Page.container.find("#search_locationHr").val()),""===Layout.Page.container.find("#search_role").val()&&(searchbyRoleId="-1"),""!==Layout.Page.container.find("#search_InactEmp").val()&&null!==Layout.Page.container.find("#search_InactEmp").val()&&void 0!==Layout.Page.container.find("#search_InactEmp").val()&&(searchbyInactiveEmp=Layout.Page.container.find("#search_InactEmp").val()),""!==Layout.Page.container.find("#search_LogDisEmp").val()&&null!==Layout.Page.container.find("#search_LogDisEmp").val()&&void 0!==Layout.Page.container.find("#search_LogDisEmp").val()&&(searchbyLogDisEmp=Layout.Page.container.find("#search_LogDisEmp").val()),""!==Layout.Page.container.find("#search_SubEmp").val()&&null!==Layout.Page.container.find("#search_SubEmp").val()&&void 0!==Layout.Page.container.find("#search_SubEmp").val()&&(searchbySubEmp=Layout.Page.container.find("#search_SubEmp").val()),""!==Layout.Page.container.find("#search_AllSubEmp").val()&&null!==Layout.Page.container.find("#search_AllSubEmp").val()&&void 0!==Layout.Page.container.find("#search_AllSubEmp").val()&&(searchbyAllSubEmp=Layout.Page.container.find("#search_AllSubEmp").val()),isOrgStructureEnabled&&(null!==Layout.Page.container.find("#zp_views_employeeentity").val()&&void 0!==Layout.Page.container.find("#zp_views_employeeentity").val()&&""!==Layout.Page.container.find("#zp_views_employeeentity").val()&&"-1"!==Layout.Page.container.find("#zp_views_employeeentity").val()&&(searchbyEntity=Layout.Page.container.find("#zp_views_employeeentity").val()),null!==Layout.Page.container.find("#zp_views_employeeunit").val()&&void 0!==Layout.Page.container.find("#zp_views_employeeunit").val()&&""!==Layout.Page.container.find("#zp_views_employeeunit").val()&&"-1"!==Layout.Page.container.find("#zp_views_employeeunit").val()&&(searchbyUnit=Layout.Page.container.find("#zp_views_employeeunit").val()),null!==Layout.Page.container.find("#zp_views_employeedivision").val()&&void 0!==Layout.Page.container.find("#zp_views_employeedivision").val()&&""!==Layout.Page.container.find("#zp_views_employeedivision").val()&&"-1"!==Layout.Page.container.find("#zp_views_employeedivision").val()&&(searchbyDivision=Layout.Page.container.find("#zp_views_employeedivision").val()),null!==Layout.Page.container.find("#zp_views_employeedepartment").val()&&void 0!==Layout.Page.container.find("#zp_views_employeedepartment").val()&&""!==Layout.Page.container.find("#zp_views_employeedepartment").val()&&"-1"!==Layout.Page.container.find("#zp_views_employeedepartment").val()&&(searchbyDept=Layout.Page.container.find("#zp_views_employeedepartment").val()));var searchFileName="";""!=Layout.Page.container.find("#search_HFname").val()&&void 0!=Layout.Page.container.find("#search_HFname").val()&&(searchFileName=Layout.Page.container.find("#search_HFname").val());var searchFileExtn="";if(""!=Layout.Page.container.find("#search_HFextn").val()&&void 0!=Layout.Page.container.find("#search_HFextn").val()&&"-1"!=Layout.Page.container.find("#search_HFextn").val()){var fileExtnType=Layout.Page.container.find("#search_HFextn").val();searchFileExtn=Files.fetchFileExtn(fileExtnType)}var fromDate="";fromDate=""!=Layout.Page.container.find("#hrsearch_fromDate").val()&&void 0!=Layout.Page.container.find("#hrsearch_fromDate").val()&&0!=Layout.Page.container.find("#hrsearch_fromDate").val()?Layout.Page.container.find("#hrsearch_fromDate").val():"-1";var toDate="";(toDate=""!=Layout.Page.container.find("#hrsearch_toDate").val()&&void 0!=Layout.Page.container.find("#hrsearch_toDate").val()&&0!=Layout.Page.container.find("#hrsearch_toDate").val()?Layout.Page.container.find("#hrsearch_toDate").val():"-1","-1"==fromDate&&""==fromDate||"-1"==toDate&&""==toDate)||!1===Files.searchWithDateValidation(Layout.Page.container.find("#hrsearch_fromDate").val(),Layout.Page.container.find("#hrsearch_toDate").val())&&(errflag=!0);if(errflag)return!1;"#files/fileView/hrfileslistview"===Layout.Page.hash||"#files/hrfile/all/listview"===Layout.Page.hash?(Files.empListViewData.All[0]=0,Files.empListViewData.All[1]=!0,Files.empCatViewData.All[3]=!0,Files.empSubCatViewData.All[3]=!0,Layout.Page.container.find("#hr_allfileList").html("")):"#files/hrfile/sub/listview"===Layout.Page.hash?(Files.empListViewData.Sub[0]=0,Files.empListViewData.Sub[1]=!0,Files.empCatViewData.Sub[3]=!0,Files.empSubCatViewData.Sub[3]=!0,Layout.Page.container.find("#hr_allfileList").html("")):"#files/hrfile/my/listview"===Layout.Page.hash?(Files.empListViewData.My[0]=0,Files.empListViewData.My[1]=!0,Files.empCatViewData.My[3]=!0,Files.empSubCatViewData.My[3]=!0,Layout.Page.container.find("#hr_allfileList").html("")):"#files/hrfile/role/listview"===Layout.Page.hash&&(Files.empListViewData.Role[0]=0,Files.empListViewData.Role[1]=!0,Files.empCatViewData.Role[3]=!0,Files.empSubCatViewData.Role[3]=!0,Layout.Page.container.find("#hr_allfileList").html("")),-1!==Layout.Page.hash.indexOf("view-categoryId")&&(Layout.Page.container.find("#hr_allfileList").find(".ZPNdata ").length>0&&(Layout.Page.container.find("#catListHFDiv").find("#hr_allfileList").html(""),Files.constructTopBar("0")),Layout.Page.container.find("#hr_fileListing").nextAll(".ZPListingUL").remove(),Layout.Page.container.find("#catListHFDiv").find("#hr_fileListing").show(),-1!==Layout.Page.hash.indexOf("#files/hrfile/all/view")?(Files.empSubCatViewData.All[0]=0,Files.empSubCatViewData.All[1]=!0,Files.empCatViewData.All[3]=!0,Files.empListViewData.All[3]=!0):-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/view")?(Files.empSubCatViewData.Sub[0]=0,Files.empSubCatViewData.Sub[1]=!0,Files.empCatViewData.Sub[3]=!0,Files.empListViewData.Sub[3]=!0):-1!==Layout.Page.hash.indexOf("#files/hrfile/my/view")?(Files.empSubCatViewData.My[0]=0,Files.empSubCatViewData.My[1]=!0,Files.empCatViewData.My[3]=!0,Files.empListViewData.My[3]=!0):-1!==Layout.Page.hash.indexOf("#files/hrfile/role/view")&&(Files.empSubCatViewData.Role[0]=0,Files.empSubCatViewData.Role[1]=!0,Files.empCatViewData.Role[3]=!0,Files.empListViewData.Role[3]=!0));var filterBy="";if("0"===Layout.Page.container.find("#fileTypeData").val()&&(filterBy="all",Layout.Page.container.find("#isEmpDownload_Div").show(),Layout.Page.container.find("#isRMDownload_Div").show()),"3"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(filterBy="allrole",Layout.Page.container.find("#isEmpDownload_Div").hide(),Layout.Page.container.find("#isRMDownload_Div").hide())),"5"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(filterBy="inactiveemp",searchbyEmp=searchbyInactiveEmp)),"8"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(filterBy="logindisabled",searchbyEmp=searchbyLogDisEmp)),-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/")&&("7"===Layout.Page.container.find("#fileTypeData").val()?(filterBy="allsubordinates",searchbyEmp=searchbyAllSubEmp):(filterBy="subordinates",searchbyEmp=searchbySubEmp)),-1!==Layout.Page.hash.indexOf("#files/hrfile/my/")&&(filterBy="my"),-1!==Layout.Page.hash.indexOf("#files/hrfile/role")&&(filterBy="myrole"),isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&ZPSetupCommon.isEmpty(mode)&&ZPSetupCommon.isEmpty(mapPos)){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.searchHrFiles(position,"search")},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.searchHrFiles("block","search")}),isBlocked||$(document).on("click",function(e){Files.Geo.positionBlocked(),-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||!ZPSetupCommon.isEmpty($(e.target).attr("class"))&&$(e.target).text()===ZPI18N.getString("zp.search")||(pageLoaded=!0,Files.searchHrFiles("","search"))})}else{var searchObj={catId:searchbyCat,employeeId:searchbyEmp,locationId:searchbyLoc,filterBy:filterBy,fileType:"0",methodName:"getAllFiles",roleId:searchbyRoleId,conreqcsr:csrfToken,searchFileName:searchFileName,searchFileExtn:searchFileExtn};isOrgStructureEnabled&&(searchObj.entityId=searchbyEntity,searchObj.unitId=searchbyUnit,searchObj.divisionId=searchbyDivision,searchObj.deptId=searchbyDept,searchObj.entityName=Layout.Page.container.find("#s2id_zp_views_employeeentity").find("span").text(),searchObj.unitName=Layout.Page.container.find("#s2id_zp_views_employeeunit").find("span").text(),searchObj.divisionName=Layout.Page.container.find("#s2id_zp_views_employeedivision").find("span").text(),searchObj.deptName=Layout.Page.container.find("#s2id_zp_views_employeedepartment").find("span").text()),null!=fromDate&&void 0!==fromDate&&""!==fromDate&&"-1"!==fromDate&&(searchObj.fromDate=fromDate),null!=toDate&&void 0!==toDate&&""!==toDate&&"-1"!==toDate&&(searchObj.toDate=toDate),-1!==Layout.Page.hash.indexOf("#files/hrfile/all")?(searchObj.start=Files.empListViewData.All[0],Files.empListViewData.All[2]=searchObj,Files.setLatitudeLongitude(Files.empListViewData.All[2])):-1!==Layout.Page.hash.indexOf("#files/hrfile/sub")?(searchObj.start=Files.empListViewData.Sub[0],Files.empListViewData.Sub[2]=searchObj,Files.setLatitudeLongitude(Files.empListViewData.Sub[2])):-1!==Layout.Page.hash.indexOf("#files/hrfile/my")?(searchObj.start=Files.empListViewData.My[0],Files.empListViewData.My[2]=searchObj,Files.setLatitudeLongitude(Files.empListViewData.My[2])):-1!==Layout.Page.hash.indexOf("#files/hrfile/role")&&(searchObj.start=Files.empListViewData.Role[0],Files.empListViewData.Role[2]=searchObj,Files.setLatitudeLongitude(Files.empListViewData.Role[2])),-1!==Layout.Page.hash.indexOf("#files/hrfile/all/view")?(searchObj.start=Files.empSubCatViewData.All[0],Files.empListViewData.All[2]=searchObj,Files.setLatitudeLongitude(Files.empListViewData.All[2])):-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/view")?(searchObj.start=Files.empSubCatViewData.Sub[0],Files.empListViewData.Sub[2]=searchObj,Files.setLatitudeLongitude(Files.empListViewData.Sub[2])):-1!==Layout.Page.hash.indexOf("#files/hrfile/my/view")?(searchObj.start=Files.empSubCatViewData.My[0],Files.empListViewData.My[2]=searchObj,Files.setLatitudeLongitude(Files.empListViewData.My[2])):-1!==Layout.Page.hash.indexOf("#files/hrfile/role/view")&&(searchObj.start=Files.empSubCatViewData.Role[0],Files.empListViewData.Role[2]=searchObj,Files.setLatitudeLongitude(Files.empListViewData.Role[2])),"5"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(-1!==Layout.Page.hash.indexOf("#files/hrfile/all/list")&&!1!==Files.isInactEmpInit[0]||-1!==Layout.Page.hash.indexOf("#files/hrfile/all/cat")&&!1!==Files.isInactEmpInit[1]||-1!==Layout.Page.hash.indexOf("#files/hrfile/all/view")&&!1!==Files.isInactEmpInit[2])&&Files.initEmployeeSearch()),"8"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(-1!==Layout.Page.hash.indexOf("#files/hrfile/all/list")&&!1!==Files.isLogDisEmpInit[0]||-1!==Layout.Page.hash.indexOf("#files/hrfile/all/cat")&&!1!==Files.isLogDisEmpInit[1]||-1!==Layout.Page.hash.indexOf("#files/hrfile/all/view")&&!1!==Files.isLogDisEmpInit[2])&&Files.initEmployeeSearch()),-1!==Layout.Page.hash.indexOf("#files/hrfile/sub")&&("7"===Layout.Page.container.find("#fileTypeData").val()?((-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/list")&&!1!==Files.isAllSubEmpInit[0]||-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/cat")&&!1!==Files.isAllSubEmpInit[1]||-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/view")&&!1!==Files.isAllSubEmpInit[2])&&Files.initEmployeeSearch(),Layout.Page.container.find("#allsubEmpSearch").show(),Layout.Page.container.find("#subEmpSearch").hide()):((-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/list")&&!1!==Files.isSubEmpInit[0]||-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/cat")&&!1!==Files.isSubEmpInit[1]||-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/view")&&!1!==Files.isSubEmpInit[2])&&Files.initEmployeeSearch(),Layout.Page.container.find("#allsubEmpSearch").hide(),Layout.Page.container.find("#subEmpSearch").show())),-1===Layout.Page.hash.indexOf("catview")&&Files.getHrfilesListing(void 0,"fromSearch"),Files.hideHRFilter()}},updateHRFile:function(form){if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.updateHRFile(form)},function(){isBlocked=!0,Files.Geo.positionBlocked(),Files.updateHRFile(form)}),isBlocked||$(document).on("click",function(e){Files.Geo.positionBlocked(),-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||!ZPSetupCommon.isEmpty($(e.target).attr("class"))&&$(e.target).text()===ZPI18N.getString("zp.submit")||(pageLoaded=!0,Files.updateHRFile(form))})}else{var pageId;(pageId=MMtemplte.templateAddHR?$("#page-wrapper").find("#add_hrfileDiv"):Layout.Page.hash.indexOf("selfservice/user/files")>-1?Layout.Page.parentContainer.parent().find("#add_hrfileDiv"):Layout.Page.container.find("#add_hrfileDiv")).find(".ERR").remove();var uploadFile=pageId.find("#uploadfile").val(),fileName=pageId.find("#fileName").val(),fileDesc=pageId.find("#fileDesc").val(),errflag=!1,fileforempID="-1",role="-1",confidential="0",isreportingTo="0",isacknowledge="0",catId="",newCatName="";!0===pageId.find(pageId.find("#empBased").find("input"))[0].checked&&(fileforempID=pageId.find("#select_employeelisting").val()),void 0!==pageId.find(pageId.find("#empBased").find("input"))[1]&&!0===pageId.find(pageId.find("#empBased").find("input"))[1].checked&&""===(role=pageId.find("#select_role").val())&&(pageId.find("#role_select").append('<span class="ERR" errmsg="mailids" id="hrrole_err">'+ZPI18N.getString("zp.selrole")+"</span>"),errflag=!0);var notifyToall=!1;!0===pageId.find("#notify").is(":checked")&&(notifyToall=!0);var notifyFeeds=!!pageId.find("input#notifyFeeds").is(":checked");void 0!==pageId.find(pageId.find("#empBased").find("input"))[1]&&!0===pageId.find(pageId.find("#empBased").find("input"))[1].checked?!1===pageId.find("#roleDownload").is(":checked")&&(confidential="1"):(!1===pageId.find("#isUserShared").is(":checked")&&(confidential="1"),!0===pageId.find("#isUserShared").is(":checked")&&!1===pageId.find("#isEmpDownload").is(":checked")&&(confidential="2")),!0===pageId.find("#isReportingTo").is(":checked")&&(isreportingTo="1"),!0===pageId.find("#isReportingTo").is(":checked")&&!1===pageId.find("#isRMDownload").is(":checked")&&(isreportingTo="2"),!0===pageId.find("#isAcknowledge").is(":checked")&&(isacknowledge="1"),pageId.find("#formBizcpn").val(csrfToken);var editFileId=pageId.find("#editFileId").val();-1!=fileName.indexOf(",")&&(fileName=fileName.replace(/,/g,"_")),""==fileName&&(pageId.find("#fileName").after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.emptyfilename")+"</strong></span>"),errflag=!0),"0"!=editFileId&&""==uploadFile&&pageId.find("#beforeUpload").is(":visible")&&(pageId.find("#drop_file").parent().parent().after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.choosefile")+"</strong></span>"),errflag=!0),MMtemplte.templateAddHR||""!=uploadFile||"0"!=editFileId||"cloudUpload"==Files.uploadMode||"workDriveUpload"==Files.uploadMode||(pageId.find("#drop_file").parent().parent().after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.choosefile")+"</strong></span>"),errflag=!0),fileDesc.length>250&&(pageId.find("#fileDesc").parent().append('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.desclength")+"</strong></span>"),errflag=!0),pageId.find("#s2id_hrselect_Cat").is(":visible")&&(""==pageId.find("#hrselect_Cat").toString().trim()||"undefined"==catId||"-1"==pageId.find("#hrselect_Cat").val()||null==pageId.find("#hrselect_Cat").val()?(pageId.find("#hrCatselect").append('<span class="ERR" errmsg="mailids" id="hrcategory_err">'+ZPI18N.getString("zp.selectcategory")+"</span>"),errflag=!0):""!=pageId.find("#hrselect_Cat").val()&&(catId=pageId.find("#hrselect_Cat").val(),pageId.find("#hrcategory_err").hide())),pageId.find("#hrnewCategory").is(":visible")&&(pageId.find("#hrcategory_err").hide(),""===pageId.find("#hrnewCategory").val().trim()?(pageId.find("#hrCatselect").append('<span class="ERR" errmsg="mailids" id="hrcategory_err">'+ZPI18N.getString("zp.selectcategory")+"</span>"),errflag=!0):""!=pageId.find("#hrnewCategory").val()&&(newCatName=pageId.find("#hrnewCategory").val(),pageId.find("#hrcategory_err").hide())),-1==fileName.indexOf("<")&&-1==fileName.indexOf(">")&&-1==fileName.indexOf("&lt;")&&-1==fileName.indexOf("&gt;")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.filename")))),errflag=!0),-1==fileDesc.indexOf("<")&&-1==fileDesc.indexOf(">")&&-1==fileDesc.indexOf("&lt;")&&-1==fileDesc.indexOf("&gt;")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.description")))),errflag=!0),-1==newCatName.indexOf("<")&&-1==newCatName.indexOf(">")&&-1==newCatName.indexOf("&lt;")&&-1==newCatName.indexOf("&gt;")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.folder")))),errflag=!0),null!=newCatName&&void 0!=newCatName&&"/"===newCatName&&(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.avoidslash")),errflag=!0);var fileObj=pageId.find("#uploadfile")[0].files[0],maxFileSizeforAdd=1e6*maxFileSize.split("MB")[0];if(fileObj&&fileObj.size>maxFileSizeforAdd&&(errflag=!0,ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesizelimit",[maxFileSize]))),fileObj&&"localUpload"==Files.uploadMode&&"-1"==Files.udsParams.fileId&&(errflag=!0,ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.fileuploaderror"))),errflag)return!1;if(Files.isIprestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));else if(Files.isGeorestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));else{var formData=new FormData;if(MMtemplte.templateAddHR){var wrapperId=$("#page-wrapper"),modalObj=wrapperId.find("#download_mailmerge"),viewType=modalObj.find("input[name=mmPdftype]:checked").val(),recordId=Layout.Page.hash.split("recordId:")[1];void 0==recordId&&(recordId=ZPForm.CURRFORM_PARAM.recordId),ZPSetupCommon.isEmpty(recordId)&&(recordId=Layout.Page.hash.indexOf("home/dashboard/feeds")>-1?pageId.find("input#recordId").val():wrapperId.find("#download_mailmerge").attr("recordId"));var formId=ZPSetupCommon.isEmpty(Layout.Page.urlparam.formId)?modalObj.attr("formId"):Layout.Page.urlparam.formId;void 0==formId&&(formId=ZPForm.CURRFORM_PARAM.formId);var docType=modalObj.find("input#select_pdf").is(":checked")?"pdf":"docx",templateId=modalObj.find("select#choose_template_form").val();formData.append("formId",formId),formData.append("docType",docType),formData.append("viewType",viewType),formData.append("templateId",templateId),formData.append("recordId",recordId),Files.uploadMode="mailmerge"}formData.append("methodName","addFile"),formData.append("conreqcsr",csrfToken),formData.append("fileName",fileName),formData.append("fileDesc",fileDesc),formData.append("fileType","0"),formData.append("catId",catId),formData.append("editFileId",editFileId),formData.append("notifyToall",notifyToall),formData.append("notifyFeeds",notifyFeeds),formData.append("confidential",confidential),formData.append("isAcknowledgement",isacknowledge),formData.append("newCatName",newCatName),formData.append("roleId",role),formData.append("employeeId",fileforempID),formData.append("isreportingTo",isreportingTo),formData.append("uploadMode",Files.uploadMode),fileObj&&"localUpload"==Files.uploadMode&&(formData.append("importFileId",Files.udsParams.fileId),formData.append("fileVersion",Files.udsParams.fileVersion)),Layout.Page.hash.indexOf("files/companyfile/listview")>-1&&formData.append("isNewui",!0),isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(formData.append("latitude",Files.Geo.position.coords.latitude),formData.append("longitude",Files.Geo.position.coords.longitude)),"cloudUpload"==Files.uploadMode&&formData.append("cloudUploadDoc",JSON.stringify(Files.uploadedDocObj)),"workDriveUpload"==Files.uploadMode&&formData.append("WDUploadDoc",JSON.stringify(Files.uploadedDocObj)),"localUpload"!=Files.uploadMode&&void 0!==pageId.find("#uploadfile")[0].files[0]&&formData.append("uploadfile",pageId.find("#uploadfile")[0].files[0]),newcatexist=!1,null!=newCatName&&""!=newCatName&&(newcatexist=!0),pageId.find("#add_hrfileInnerDivLoading").show(),pageId.find("#add_hrfileInnerDivLoading").html(ZPeople.LOADING_HTML),pageId.find("#add_hrfileInnerDiv").hide(),pageId.find(".modal-footer").hide(),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){Files.updateReloadParams("0"),pageId.modal("hide"),"-1"!==role&&""!==role?-1!==Layout.Page.hash.indexOf("listview")||-1!==Layout.Page.hash.indexOf("view-categoryId")?Files.getHrfilesListing("add","role","Sucess",newcatexist,editFileId):-1!==Layout.Page.hash.indexOf("listview")&&Files.showCategoryView("add","role","Sucess",newcatexist,editFileId):-1!==Layout.Page.hash.indexOf("listview")||-1!==Layout.Page.hash.indexOf("view-categoryId")?Files.getHrfilesListing("add","all","Sucess",newcatexist,editFileId):-1!==Layout.Page.hash.indexOf("listview")?Files.showCategoryView("add","all","Sucess",newcatexist,editFileId):-1!==Layout.Page.hash.indexOf("selfservice/user/files")?Files.SelfService.fetchSelfServiceFiles("opnRecent"):MMtemplte.templateAddHR&&(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.addfile")),MMtemplte.constructTemplateList("form",null,null,this,"Download"))},error:function(req){var errResponse=req.responseJSON[1];8103!==req.status&&8101!==req.status&&500!==req.status||ZPeople.Message.showFailureMsg(errResponse.msg),pageId.modal("hide")}})}}},fetchHrFilesListing:function(){Files.hideHRFilter(),Agreements.funcToOpenFilter(),Agreements.isCancelAgr?Agreements.isCancelAgr=!1:(("#files/hrfile/all/listview"===Layout.Page.hash&&Object.keys(Files.empListViewData.All[2]).length>0||"#files/hrfile/sub/listview"===Layout.Page.hash&&Object.keys(Files.empListViewData.Sub[2]).length>0||"#files/hrfile/my/listview"===Layout.Page.hash&&Object.keys(Files.empListViewData.My[2]).length>0||"#files/hrfile/role/listview"===Layout.Page.hash&&Object.keys(Files.empListViewData.Role[2]).length>0)&&$("#page-wrapper").addClass("filter-container"),"#files/fileView/hrfileslistview"===Layout.Page.hash||"#files/hrfile/all/listview"===Layout.Page.hash||"#selfservice/user/files"===Layout.Page.hash||"#files/hrfile/sub/listview"===Layout.Page.hash||"#files/hrfile/my/listview"===Layout.Page.hash||0===Layout.Page.container.find("tbody#hr_allfileList").find("tr").length?("#files/hrfile/all/listview"===Layout.Page.hash&&(0===Files.empListViewData.All[0]||!0===Files.empListViewData.All[3])||"#files/hrfile/sub/listview"===Layout.Page.hash&&(0===Files.empListViewData.Sub[0]||!0===Files.empListViewData.Sub[3])||"#files/hrfile/my/listview"===Layout.Page.hash&&0===Files.empListViewData.My[0]||!0===Files.empListViewData.My[3]||"#files/hrfile/role/listview"===Layout.Page.hash&&0===Files.empListViewData.Role[0]||!0===Files.empListViewData.Role[3])&&("#files/fileView/hrfileslistview"===Layout.Page.hash||"#files/hrfile/all/listview"===Layout.Page.hash?(Files.empListViewData.All[0]=0,Files.empListViewData.All[1]=!0):"#files/hrfile/sub/listview"===Layout.Page.hash?(Files.empListViewData.Sub[0]=0,Files.empListViewData.Sub[1]=!0):"#files/hrfile/my/listview"===Layout.Page.hash?(Files.empListViewData.My[0]=0,Files.empListViewData.My[1]=!0):"#files/hrfile/role/listview"===Layout.Page.hash&&(Files.empListViewData.Role[0]=0,Files.empListViewData.Role[1]=!0),Files.chooseViewFilterOption(),Layout.Page.hash.indexOf("selfservice/user/files")>-1&&((isadmin||SelfService.Profile.checkPermissionForSFilesByUserId(SelfService.getUserId()))&&0===Layout.Page.container.find("#hr_addbtn").length&&Layout.Page.container.find("#addHR_Bar").append('<button class="btn btn-primary btnPlus FR" id="hr_addbtn" type="button" onclick="Files.getAddFileElms()">'+ZPI18N.getString("zp.add")+"</button>"),$("#selfservice-user").find(".Scrcont").find("#hr_fileListing").attr("scroll","disabled")),Layout.Page.container.find("#hr_allfileList").html(""),Files.getHrfilesListing()):"#selfservice/user/files"!==Layout.Page.hash&&(-1!==Layout.Page.hash.indexOf("createEnvelope")||Layout.Page.hash.indexOf("envelopeId:")>-1?Files.Esign.getEnvelopeListpage():-1!==Layout.Page.hash.indexOf("createDocument")||Layout.Page.hash.indexOf("documentId:")>-1?Files.Esign.getDocumentsListPage("hr"):Files.Esign.getAgreementsListPage("hr")),Files.getcatList("hr"),Files.constructemp_addrev("activeEmp"))},getHrfilesListing:function(obj,mode,msg,newcat,editFileId){if(Layout.Page.hash.indexOf("selfservice/user/files")>-1?$("#selfservice-user").find(".Scrcont").attr("scroll","enabled"):Layout.Page.container.find("#hr_allfileList").attr("scroll","enabled"),Files.setSearchEmpData(),"add"==obj&&(Layout.Page.container.find("#hr_fileListing").scrollTop(0),"#files/hrfile/all/listview"===Layout.Page.hash?(Layout.Page.container.find("#hr_allfileList").html(""),Files.empListViewData.All[0]=0,Files.empListViewData.All[1]=!0):"#files/hrfile/sub/listview"===Layout.Page.hash?(Layout.Page.container.find("#hr_allfileList").html(""),Files.empListViewData.Sub[0]=0,Files.empListViewData.Sub[1]=!0):"#files/hrfile/my/listview"===Layout.Page.hash?(Layout.Page.container.find("#hr_allfileList").html(""),Files.empListViewData.My[0]=0,Files.empListViewData.My[1]=!0):"#files/hrfile/role/listview"===Layout.Page.hash&&(Layout.Page.container.find("#hr_allfileList").html(""),Files.empListViewData.Role[0]=0,Files.empListViewData.Role[1]=!0),-1!==Layout.Page.hash.indexOf("/all/view-categoryId")&&(Layout.Page.container.find("#hr_allfileList").find("#hr_fileListing").nextAll().remove(),Layout.Page.container.find("#hr_allfileList").find("#hr_fileListing").remove(),Layout.Page.container.find("#hr_allfileList").find(".ZPNdata").remove(),Files.constructTopBar("0"),Files.empSubCatViewData.All[0]=0,Files.empSubCatViewData.All[1]=!0),-1!==Layout.Page.hash.indexOf("/sub/view-categoryId")&&(Layout.Page.container.find("#hr_allfileList").find("#hr_fileListing").nextAll().remove(),Layout.Page.container.find("#hr_allfileList").find("#hr_fileListing").remove(),Layout.Page.container.find("#hr_allfileList").find(".ZPNdata").remove(),Files.constructTopBar("0"),Files.empSubCatViewData.Sub[0]=0,Files.empSubCatViewData.Sub[1]=!0),-1!==Layout.Page.hash.indexOf("/my/view-categoryId")&&(Layout.Page.container.find("#hr_allfileList").find("#hr_fileListing").nextAll().remove(),Layout.Page.container.find("#hr_allfileList").find("#hr_fileListing").remove(),Layout.Page.container.find("#hr_allfileList").find(".ZPNdata").remove(),Files.constructTopBar("0"),Files.empSubCatViewData.My[0]=0,Files.empSubCatViewData.My[1]=!0),-1!==Layout.Page.hash.indexOf("/role/view-categoryId")&&(Layout.Page.container.find("#hr_allfileList").find("#hr_fileListing").nextAll().remove(),Layout.Page.container.find("#hr_allfileList").find("#hr_fileListing").remove(),Layout.Page.container.find("#hr_allfileList").find(".ZPNdata").remove(),Files.constructTopBar("0"),Files.empSubCatViewData.Role[0]=0,Files.empSubCatViewData.Role[1]=!0)),"Sucess"==msg)"0"!==editFileId?ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatefile")):ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.addfile"));else if("copy"==msg)ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.copyfile"));else if("move"==msg)ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.movefile"));else if("imported"===msg)ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.filesimported"));else if("Error"==msg)return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.invalidmsg"));-1===Layout.Page.hash.indexOf("selfservice/user/files")&&Layout.Page.container.find("#hr_allfileList").find(".ZPListingUL").length<=0&&-1===Layout.Page.hash.indexOf("/view")&&(Layout.Page.container.find("#hr_allfileList").hide(),Layout.Page.container.find("#nohrFilesDiv").show(),Layout.Page.container.find("#nohrFilesDiv").html(ZPeople.LOADING_HTML)),$("body").popover({selector:"[data-popover].popHover",trigger:"click hover",placement:"right",delay:{show:50,hide:50}}),Layout.Page.container.find("#hr_multiselDel").hide(),Layout.Page.container.find("#addHR_Bar").show(),Layout.Page.container.find("#fileTypeData").select2();var type="";if("0"!==Layout.Page.container.find("#fileTypeData").val()&&"all"!=mode||(0!=loginUserRoleCheck&&1!=loginUserRoleCheck&&2!=loginUserRoleCheck||(type="all",Layout.Page.container.find("#activeEmpSearch").show(),Layout.Page.container.find("#inactiveEmpSearch").hide(),Layout.Page.container.find("#logDisEmpSearch").hide(),Layout.Page.container.find("#roleBasedHeader").hide(),Layout.Page.container.find("#roleViewfilter").hide()),Layout.Page.container.find("#fileTypeData").select2("val","0")),"1"!==Layout.Page.container.find("#fileTypeData").val()&&-1===Layout.Page.hash.indexOf("#files/hrfile/my")||(type="my",Layout.Page.container.find("#fileTypeData").select2("val","1")),-1!==Layout.Page.hash.indexOf("#files/hrfile/sub")&&("7"===Layout.Page.container.find("#fileTypeData").val()?(type="allsub",Layout.Page.container.find("#allsubEmpSearch").show(),Layout.Page.container.find("#subEmpSearch").hide()):("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&(type="sub",Layout.Page.container.find("#subEmpSearch").show(),Layout.Page.container.find("#allsubEmpSearch").hide())),"3"!==Layout.Page.container.find("#fileTypeData").val()&&"role"!=mode||(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(type="allrole",Layout.Page.container.find("#activeEmpSearch").hide(),Layout.Page.container.find("#inactiveEmpSearch").hide(),Layout.Page.container.find("#logDisEmpSearch").hide(),Layout.Page.container.find("#roleBasedHeader").show(),Layout.Page.container.find("#roleViewfilter").show()),Layout.Page.container.find("#fileTypeData").select2("val","3")),"4"!==Layout.Page.container.find("#fileTypeData").val()&&-1===Layout.Page.hash.indexOf("#files/hrfile/role")||(type="myrole"),"5"!==Layout.Page.container.find("#fileTypeData").val()&&"inactiveemp"!=mode||(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(type="inactiveemp",Layout.Page.container.find("#activeEmpSearch").hide(),Layout.Page.container.find("#inactiveEmpSearch").show(),Layout.Page.container.find("#logDisEmpSearch").hide(),Layout.Page.container.find("#roleBasedHeader").hide(),Layout.Page.container.find("#roleViewfilter").hide()),Layout.Page.container.find("#fileTypeData").select2("val","5")),"8"!==Layout.Page.container.find("#fileTypeData").val()&&"logindisabled"!=mode||(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(type="logindisabled",Layout.Page.container.find("#activeEmpSearch").hide(),Layout.Page.container.find("#inactiveEmpSearch").hide(),Layout.Page.container.find("#logDisEmpSearch").show(),Layout.Page.container.find("#roleBasedHeader").hide(),Layout.Page.container.find("#roleViewfilter").hide()),Layout.Page.container.find("#fileTypeData").select2("val","8")),Files.isTab=type,Layout.Page.container.find("#hrfilterdiv").is(":visible")?Layout.Page.hash.indexOf("files/fileView/companyfileslistview")>-1&&Layout.Page.container.find("#page-wrapper").removeClass("Nbar2").addClass("Nbar2F"):Layout.Page.hash.indexOf("files/fileView/companyfileslistview")>-1&&Layout.Page.container.find("#page-wrapper").removeClass("Nbar2F").addClass("Nbar2"),1==Files.empListViewData.All[1]||1==Files.empListViewData.Sub[1]||1==Files.empListViewData.My[1]||1==Files.empSubCatViewData.All[1]||1==Files.empSubCatViewData.Sub[1]||1==Files.empSubCatViewData.My[1]||"fromSearch"===mode){if((0==loginUserRoleCheck||1==loginUserRoleCheck||2==loginUserRoleCheck)&&"all"===type){Layout.Page.container.find("#myfile").removeClass("sel"),Layout.Page.container.find("#subfile").removeClass("sel"),Layout.Page.container.find("#rolefile").removeClass("sel"),Layout.Page.container.find("#myrolefile").removeClass("sel");var params={methodName:"getAllFiles",fileType:0,start:Files.empListViewData.All[0],filterBy:"all",conreqcsr:csrfToken}}if("my"===type){Layout.Page.container.find("#myfile").addClass("sel"),Layout.Page.container.find("#subfile").removeClass("sel"),Layout.Page.container.find("#rolefile").removeClass("sel"),Layout.Page.container.find("#myrolefile").removeClass("sel"),Layout.Page.container.find("#hr_all").removeClass("sel");params={methodName:"getAllFiles",fileType:0,start:Files.empListViewData.My[0],filterBy:"my",conreqcsr:csrfToken}}if("sub"===type){Layout.Page.container.find("#subfile").addClass("sel"),Layout.Page.container.find("#myfile").removeClass("sel"),Layout.Page.container.find("#rolefile").removeClass("sel"),Layout.Page.container.find("#myrolefile").removeClass("sel");params={methodName:"getAllFiles",fileType:0,start:Files.empListViewData.Sub[0],filterBy:"subordinates",conreqcsr:csrfToken}}if("allsub"===type){Layout.Page.container.find("#subfile").addClass("sel"),Layout.Page.container.find("#myfile").removeClass("sel"),Layout.Page.container.find("#rolefile").removeClass("sel"),Layout.Page.container.find("#myrolefile").removeClass("sel");params={methodName:"getAllFiles",fileType:0,start:Files.empListViewData.Sub[0],filterBy:"allsubordinates",conreqcsr:csrfToken}}if("allrole"===type||"myrole"===type){Layout.Page.container.find("#rolefile").addClass("sel"),Layout.Page.container.find("#myrolefile").addClass("sel"),Layout.Page.container.find("#myfile").removeClass("sel"),Layout.Page.container.find("#hr_all").removeClass("sel"),Layout.Page.container.find("#subfile").removeClass("sel");var start=0;"#files/hrfile/all/listview"===Layout.Page.hash||"allrole"===type?start=Files.empListViewData.All[0]:"#files/hrfile/role/listview"!==Layout.Page.hash&&"myrole"!==type||(start=Files.empListViewData.Role[0]);params={methodName:"getAllFiles",fileType:0,start:start,filterBy:type,conreqcsr:csrfToken}}if((0==loginUserRoleCheck||1==loginUserRoleCheck)&&"inactiveemp"===type){Layout.Page.container.find("#myfile").removeClass("sel"),Layout.Page.container.find("#subfile").removeClass("sel"),Layout.Page.container.find("#rolefile").removeClass("sel"),Layout.Page.container.find("#myrolefile").removeClass("sel");params={methodName:"getAllFiles",fileType:0,start:Files.empListViewData.All[0],filterBy:"inactiveemp",conreqcsr:csrfToken}}if((0==loginUserRoleCheck||1==loginUserRoleCheck)&&"logindisabled"===type){Layout.Page.container.find("#myfile").removeClass("sel"),Layout.Page.container.find("#subfile").removeClass("sel"),Layout.Page.container.find("#rolefile").removeClass("sel"),Layout.Page.container.find("#myrolefile").removeClass("sel");params={methodName:"getAllFiles",fileType:0,start:Files.empListViewData.All[0],filterBy:"logindisabled",conreqcsr:csrfToken}}var pageLoaded=!1,isBlocked=!1,isNewCat=!(!newcat&&Files.isCachedCat);Layout.Page.hash.indexOf("selfservice/user/files")>-1&&(params.ERECNO=SelfService.getUserId());var searchObj={};-1!==Layout.Page.hash.indexOf("#files/hrfile/all")&&Object.keys(Files.empListViewData.All[2]).length>0?(Files.empListViewData.All[2].methodName="getAllFiles",-1!==Layout.Page.hash.indexOf("#files/hrfile/all/listview")?Files.empListViewData.All[2].start=Files.empListViewData.All[0]:Files.empListViewData.All[2].start=Files.empSubCatViewData.All[0],searchObj=Files.empListViewData.All[2]):-1!==Layout.Page.hash.indexOf("#files/hrfile/sub")&&Object.keys(Files.empListViewData.Sub[2]).length>0?(Files.empListViewData.Sub[2].methodName="getAllFiles",-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/listview")?Files.empListViewData.Sub[2].start=Files.empListViewData.Sub[0]:Files.empListViewData.Sub[2].start=Files.empSubCatViewData.Sub[0],searchObj=Files.empListViewData.Sub[2]):-1!==Layout.Page.hash.indexOf("#files/hrfile/my")&&Object.keys(Files.empListViewData.My[2]).length>0?(Files.empListViewData.My[2].methodName="getAllFiles",-1!==Layout.Page.hash.indexOf("#files/hrfile/my/listview")?Files.empListViewData.My[2].start=Files.empListViewData.My[0]:Files.empListViewData.My[2].start=Files.empSubCatViewData.My[0],searchObj=Files.empListViewData.My[2]):-1!==Layout.Page.hash.indexOf("#files/hrfile/role")&&Object.keys(Files.empListViewData.Role[2]).length>0&&(Files.empListViewData.Role[2].methodName="getAllFiles",-1!==Layout.Page.hash.indexOf("#files/hrfile/role/listview")?Files.empListViewData.Role[2].start=Files.empListViewData.Role[0]:Files.empListViewData.Role[2].start=Files.empSubCatViewData.Role[0],searchObj=Files.empListViewData.Role[2]),Files.searchFileBreadcrumbs(),Layout.Page.container.find("#hr_fileListing").find(".ZPListingUL").show(),isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position?(navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Object.keys(searchObj).length>0||"fromSearch"===mode?Files.foundLocation(position,2,searchObj,mode,isNewCat):Files.foundLocation(position,2,params,mode,isNewCat)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Object.keys(searchObj).length>0||"fromSearch"===mode?Files.foundLocation("block",2,searchObj,mode,isNewCat):Files.foundLocation("block",2,params,mode,isNewCat)}),$(document).on("click",function(e){Files.Geo.positionBlocked(),isBlocked||!(Layout.Page.hash.indexOf("files/fileView/hrfileslistview")>-1||Layout.Page.hash.indexOf("files/hrfile/all/listview")>-1)||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||$(e.target).text()===ZPI18N.getString("zp.search")||void 0===$(e.target)||-1!==$(e.target).attr("class").indexOf("select2")||(pageLoaded=!0,Object.keys(searchObj).length>0||"fromSearch"===mode?Files.foundLocation("",2,searchObj,mode,isNewCat):Files.foundLocation("",2,params,mode,isNewCat))})):Object.keys(searchObj).length>0||"fromSearch"===mode?Files.foundLocation("",2,searchObj,mode,isNewCat):(Files.setLatitudeLongitude(params),Files.foundLocation("",2,params,mode,isNewCat))}},getHrFilesCallBack:function(resultData,params,otherDtls){if(resultData.hasOwnProperty("fail")&&Layout.Page.hash.indexOf("files/hrfile/")>-1)return Layout.Page.container.find("#nohrFilesDiv").find("#zp_page_loading").hide(),void(-1!==Layout.Page.hash.indexOf("view-categoryId")?(Layout.Page.container.find("#hr_fileListing").nextAll(".ZPListingUL").remove(),Layout.Page.container.find("#catListHFDiv").find("#hr_fileListing").hide(),0==Layout.Page.container.find(".ZPBoxListing").find("ul").length&&Files.showNodataMsg("subCatView")):-1!==Layout.Page.hash.indexOf("listview")&&(Layout.Page.container.find("#zp_page_loading").remove(),Files.showNodataMsg("hr_filesmsg")));if(void 0!==resultData[1]){var isfirescrollListView=!1;"#files/fileView/hrfileslistview"!==Layout.Page.hash&&"#files/hrfile/all/listview"!==Layout.Page.hash||!Files.empListViewData.All[1]?"#files/hrfile/sub/listview"===Layout.Page.hash&&Files.empListViewData.Sub[1]?isfirescrollListView=!0:"#files/hrfile/my/listview"===Layout.Page.hash&&Files.empListViewData.My[1]?isfirescrollListView=!0:"#files/hrfile/role/listview"===Layout.Page.hash&&Files.empListViewData.Role[1]&&(isfirescrollListView=!0):isfirescrollListView=!0;var isfirescrollSubCatView=!1;Files.empSubCatViewData.All[1]&&-1!==Layout.Page.hash.indexOf("/all/view-categoryId")&&(isfirescrollSubCatView=!0),Files.empSubCatViewData.Sub[1]&&-1!==Layout.Page.hash.indexOf("/sub/view-categoryId")&&(isfirescrollSubCatView=!0),Files.empSubCatViewData.My[1]&&-1!==Layout.Page.hash.indexOf("/my/view-categoryId")&&(isfirescrollSubCatView=!0),Files.empSubCatViewData.Role[1]&&-1!==Layout.Page.hash.indexOf("/role/view-categoryId")&&(isfirescrollSubCatView=!0),!1!==isfirescrollListView&&-1!==Layout.Page.hash.indexOf("listview")?(Files.hrFilelistView(resultData[1],otherDtls.mode),void 0!=otherDtls.newCat&&otherDtls.newCat&&Files.getcatList("hr",params.latitude,params.longitude,!0)):!1===isfirescrollSubCatView||-1===Layout.Page.hash.indexOf("/all/view")&&-1===Layout.Page.hash.indexOf("/sub/view")&&-1===Layout.Page.hash.indexOf("/my/view")&&-1===Layout.Page.hash.indexOf("/role/view")||(Files.hrFilelistView(resultData[1],otherDtls.mode),void 0!=otherDtls.newCat&&otherDtls.newCat&&Files.getcatList("hr",params.latitude,params.longitude,!0))}else Files.isIprestrict(resultData),Files.hrFilelistView()},hrFilelistView:function(resultData,mode){Layout.Page.container.find("#nohrFilesDiv").find("#zp_page_loading").remove();var pageId=Layout.Page.container.find("#hr_allfileList");if(Files.isIprestricted){Layout.Page.container.find("#nohrFilesDiv").hide(),Layout.Page.container.find("#hr_allfileList").show();row='<ul class="ZPListingUL">';row+='<li class="text-center">'+ZPI18N.getString("zp.iprestricted")+"</li></ul>",pageId.append(row)}else{var parseObj=resultData;parseObj.length;if(parseObj.length<25?(parseObj.length,-1!==Layout.Page.hash.indexOf("hrfile/all/view-categoryId")?Files.empSubCatViewData.All[1]=!1:-1!==Layout.Page.hash.indexOf("hrfile/sub/view-categoryId")?Files.empSubCatViewData.Sub[1]=!1:-1!==Layout.Page.hash.indexOf("hrfile/my/view-categoryId")?Files.empSubCatViewData.My[1]=!1:-1!==Layout.Page.hash.indexOf("hrfile/role/view-categoryId")?Files.empSubCatViewData.Role[1]=!1:"#files/fileView/hrfileslistview"===Layout.Page.hash||"#files/hrfile/all/listview"===Layout.Page.hash?Files.empListViewData.All[1]=!1:"#files/hrfile/sub/listview"===Layout.Page.hash?Files.empListViewData.Sub[1]=!1:"#files/hrfile/my/listview"===Layout.Page.hash?Files.empListViewData.My[1]=!1:"#files/hrfile/role/listview"===Layout.Page.hash&&(Files.empListViewData.Role[1]=!1)):-1!==Layout.Page.hash.indexOf("hrfile/all/view-categoryId")?Files.empSubCatViewData.All[1]=!0:-1!==Layout.Page.hash.indexOf("hrfile/sub/view-categoryId")?Files.empSubCatViewData.Sub[1]=!0:-1!==Layout.Page.hash.indexOf("hrfile/my/view-categoryId")?Files.empSubCatViewData.My[1]=!0:-1!==Layout.Page.hash.indexOf("hrfile/role/view-categoryId")?Files.empSubCatViewData.Role[1]=!0:"#files/fileView/hrfileslistview"===Layout.Page.hash||"#files/hrfile/all/listview"===Layout.Page.hash?Files.empListViewData.All[1]=!0:"#files/hrfile/sub/listview"===Layout.Page.hash?Files.empListViewData.Sub[1]=!0:"#files/hrfile/my/listview"===Layout.Page.hash?Files.empListViewData.My[1]=!0:"#files/hrfile/role/listview"===Layout.Page.hash&&(Files.empListViewData.Role[1]=!0),Files.isGeorestricted=!1,void 0!=pageId.find("tr#geo_err")&&pageId.find("tr#geo_err").length>0&&pageId.find("tr#geo_err").remove(),parseObj.length>0){ZPeople.FireScroll.reset(),Layout.Page.container.find("#hr_allfileList").show(),Layout.Page.container.find("#nohrFilesDiv").hide();for(var i=0;i<parseObj.length;i++){var data=parseObj[i];Files.isIprestricted=!1;var fileExtn=data.filePath,filePath=data.filePath,fileName=data.fileName,fileID=data.fileID;(data.filePath.indexOf(workDriveUrl)>-1||data.filePath.indexOf(writerUrl)>-1||data.filePath.indexOf(sheetUrl)>-1||data.filePath.indexOf(showUrl)>-1||"1"==data.UploadSource)&&(fileExtn="workdrive"),-1!=fileExtn.lastIndexOf(".")&&(fileExtn=(fileExtn=fileExtn.substr(fileExtn.lastIndexOf(".")+1,fileExtn.length)).toLowerCase()),ZPeople.IsNumeric(filePath)&&(fileExtn=data.fileExtn.toLowerCase()),-1!=filePath.indexOf("_signed")&&filePath.indexOf("_signed")>=-1&&-1!=filePath.lastIndexOf(".")&&(fileExtn=(fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length)).toLowerCase());var row='<ul class="ZPListingUL" id="hrfileTr_'+fileID+'" fileName = "'+fileName+'" fileID = "'+fileID+'" agreementId = "'+data.agreementId+'" uploadFileExtn = "'+fileExtn+'" isLoginUserAck = '+data.isLoginUserAck+" isEmpFileAck = "+data.isEmpFileAck+">";-1!=loginUserRoleCheck&&(row+='<li class="check"><div class="checkbox"><input type="checkbox" id="'+data.fileID+'" onclick="Files.checkParticularfiles(this,\'hr\')"><label class="MT3"></label></div></li>'),data.filePath.indexOf(workDriveUrl)>-1||data.filePath.indexOf(writerUrl)>-1||data.filePath.indexOf(sheetUrl)>-1||data.filePath.indexOf(showUrl)>-1||"1"==data.UploadSource?row+='<li class="name" id="hrfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'" onclick="Files.openWDFiles(this)">':row+='<li class="name" id="hrfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'" onclick="Layout.Page.pageContWrapper.parent().prepend(Files.constructPreview(\'hrfileTr_'+data.fileID+"','files'));Files.viewFile(this,'hr')\">",row+="pdf"===fileExtn?'<i class="IC-pdf"></i>':"xls"===fileExtn||"xlsx"===fileExtn||"xlsm"===fileExtn||"sxc"===fileExtn||"ods"===fileExtn||"csv"===fileExtn||"tsv"===fileExtn?'<i class="IC-xls-new"></i>':"htm"===fileExtn||"html"===fileExtn?'<i class="IC-code"></i>':"doc"===fileExtn||"docx"===fileExtn||"sxw"===fileExtn||"odt"===fileExtn||"rtf"===fileExtn?'<i class="IC-doc"></i>':"ppt"===fileExtn||"pps"===fileExtn||"odp"===fileExtn||"sxi"===fileExtn||"pptx"===fileExtn?'<i class="IC-ppt"></i>':"zip"===fileExtn?'<i class="IC-zip"></i>':"mp3"===fileExtn||"mp4a"===fileExtn||"wav"===fileExtn?'<i class="IC-mp3"></i>':"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn?'<i class="IC-jpg"></i>':"workdrive"==fileExtn?'<i class="IC-wd"></i>':'<i class="IC-doc"></i>',1===data.fileConfident&&(row+='<i class="CR-lock MR5" title="" data-placement="right" data-toggle="tooltip" data-original-title="Confidential"></i>'),row+='<span href="javascript:;" title="'+ZPeople.escapeHtml(ZPeople.decodeTxt(fileName))+'" class="ellip">'+ZPeople.escapeHtml(ZPeople.decodeTxt(fileName))+"</span>",row+="</li>",row+=Files.Reports.acknowledgementStatus(data.fileID,data.fileAcknowledge,data.fileOwnerID,data.isEmpFileAck,data.isLoginUserAck,!1,data);if(void 0===data.fileOwnerName&&void 0===data.fileRoleName?ZPI18N.getString("zp.all"):void 0!==data.fileOwnerName?data.fileOwnerName:void 0!==data.fileRoleName&&data.fileRoleName,void 0==data.fileOwnerName&&void 0==data.fileRoleName&&void 0==data.fileLocationName?row+="<li><span>"+ZPI18N.getString("zp.all")+"</span></li>":data.fileOwnerName?row+="<li><span>"+data.fileOwnerName+"</span></li>":data.fileRoleName?data.fileRoleNameNew.length>1?(row+='<li><span class="btn-sm FL">'+data.fileRoleNameNew.toString().split(",")[0]+"</span>",row+='<div class=" dropdown ZPCusDrs  FL  ML5 "><div data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+=Files.getAllSharedLocRole(data.fileRoleNameNew),row+="</div></li>"):row+="<li><span>"+data.fileRoleNameNew+"</span></li>":data.fileLocationName&&(row+="<li>"+data.fileLocationName+"</li>"),data.fileCatNameNew.length>1?(row+='<li><span class="btn-sm FL">'+data.fileCatNameNew.toString().split(",")[0]+"</span>",row+='<div class=" dropdown ZPCusDrs  FL  ML5 "><div data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+=Files.getAllSharedLocRole(data.fileCatNameNew),row+="</div></li>"):row+="<li><span>"+data.fileCatName+"</span></li>",row+="<li>"+data.fileModifiedDate+"</li>",-1===Layout.Page.hash.indexOf("selfservice/user/files")){var actionIcs="";if(0==loginUserRoleCheck||1==loginUserRoleCheck||2==loginUserRoleCheck&&""==data.fileRoleID){var previewIc;void 0!=data.module&&(previewIc="3"===data.module||"4"===data.module?'<li class="PR5 CP" onclick=Envelope.getEnvelopePreview("'+data.agreementId+'")><i id="send_agrmnt" data-toggle="modal" class="IC-send-file S14 grn FR MR15 "></i>'+ZPI18N.getString("zp.documentdtls")+"</li>":"1"===data.module||"2"===data.module?'<li class="PR5 CP" onclick=Agreements.getAgreementPreview("'+data.agreementId+'")><i id="send_agrmnt" data-toggle="modal" class="IC-send-file S14 grn FR MR15"></i>'+ZPI18N.getString("zp.documentdtls")+"</li>":'<li class="PR5 CP" onclick=Zohosign.getDocumentPreview("'+data.agreementId+'")><i id="send_agrmnt" data-toggle="modal" class="IC-send-file S14 grn FR MR15"></i>'+ZPI18N.getString("zp.documentdtls")+"</li>"),void 0==isAnySignConfigured&&Zohosign.getEsignConfigurations(),Zohosign.populateDocumentView();var esignAdmin=0==loginUserRoleCheck||1==loginUserRoleCheck||2==loginUserRoleCheck&&""==data.fileRoleID,sendAgreementAction="";sendAgreementAction=esignAdmin&&isAnySignConfigured&&isAdobeConfig&&ZPSetupCommon.isEmpty(data.agreementId)&&-1!==Agreements.adobeCompatibleExtns.indexOf(fileExtn)?'<i id="send_agrmnt" data-toggle="modal" class="IC-adobe" title="'+ZPI18N.getString("zp.requestsignature")+'"></i>':!esignAdmin||!isAdobeConfig&&"true"!=Zohosign.hasAdobesignRecord||"1"!==data.module&&"2"!==data.module?"":previewIc;var sendEnvelopeAction="";sendEnvelopeAction=esignAdmin&&isAnySignConfigured&&isDocuConfig&&ZPSetupCommon.isEmpty(data.agreementId)&&-1!==Envelope.add.docuCompatibleExtns.indexOf(fileExtn)?'<i id="send_envelope" data-toggle="modal" class="IC-docu" title="'+ZPI18N.getString("zp.requestsignature")+'"></i>':!esignAdmin||!isDocuConfig&&"true"!=Zohosign.hasDocusignRecord||"3"!==data.module&&"4"!==data.module?"":previewIc;var sendDocumentAction="";sendDocumentAction=esignAdmin&&isAnySignConfigured&&isZSConfig&&ZPSetupCommon.isEmpty(data.agreementId)&&-1!==Zohosign.add.docuCompatibleExtns.indexOf(fileExtn)?'<i id="send_document" data-toggle="modal" class="IC-zohosign" title="'+ZPI18N.getString("zp.requestsignature")+'"></i>':!esignAdmin||!isZSConfig&&"true"!=Zohosign.hasZohosignRecord||"5"!==data.module&&"6"!==data.module?"":previewIc,data.hasOwnProperty("agreementId")&&!ZPSetupCommon.isEmpty(data.agreementId)?(""!==sendAgreementAction?actionIcs+="<li>"+sendAgreementAction+"</li>":""!==sendEnvelopeAction?actionIcs+="<li>"+sendEnvelopeAction+"</li>":""!==sendDocumentAction&&(actionIcs+="<li>"+sendDocumentAction+"</li>"),actionIcs="3"===data.module||"4"===data.module?sendEnvelopeAction:"1"===data.module||"2"===data.module?sendAgreementAction:sendDocumentAction):""!==sendAgreementAction&&void 0!==sendAgreementAction?actionIcs+='<li class="PR5" onclick=Agreements.openAgrModal("hr","'+data.fileID+'")>'+sendAgreementAction+ZPI18N.getString("zp.requestsignature")+"</li>":""!==sendEnvelopeAction&&void 0!==sendEnvelopeAction?actionIcs+='<li class="PR5" onclick=Envelope.openCreateEnvelopeModal("hr","'+data.fileID+'")>'+sendEnvelopeAction+ZPI18N.getString("zp.requestsignature")+"</li>":""!==sendDocumentAction&&void 0!==sendDocumentAction&&(actionIcs+='<li class="PR5" onclick=Zohosign.openCreateDocumentModal("hr","'+data.fileID+'")>'+sendDocumentAction+ZPI18N.getString("zp.requestsignature")+"</li>")}0!=loginUserRoleCheck&&1!=loginUserRoleCheck||1!==data.fileAcknowledge||(actionIcs+="<li onclick=\"FilesLite.Reports.ackFileDetailReport.getAcknowledgementDetails('"+data.fileID+'\');"><i class="IC-user-tick"></i>'+ZPI18N.getString("zp.viewack")+"</li>"),row+='<li class="actions">',-1!=loginUserRoleCheck&&(row+='<div id="action_confirm_btn" class="DN"><button class="btn btn-default btn-sm FR" onclick="Files.cancelDelRecConfirm(this, \'ZPAtt_entryDel_Action\');">'+ZPI18N.getString("zp.cancel")+"</button><button  class=\"btn btn-danger btn-sm FR MR10\" onclick=\"Files.deleteFiles('single','"+data.fileID+"',this,'hr')\">"+ZPI18N.getString("zp.confirm")+"</button></div>"),row+='<div class="FL">',""===data.fileDesc||void 0===data.fileDesc?row+="<i onmouseover='Files.hideCompFilesOptions(this)' data-popover='true' data-html='true' data-placement='bottom' data-content='<span class=\"DB S13\"><b>"+ZPI18N.getString("zp.reports.createdby")+' : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileCreateByName)+"</p></span>' class='CR-info popHover'></i>":row+="<i onmouseover='Files.hideCompFilesOptions(this)' data-popover='true' data-html='true' data-placement='bottom' data-content='<span class=\"DB S13\"><b>"+ZPI18N.getString("zp.reports.createdby")+' : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileCreateByName)+'</p></span><br> <span class="DB S13"><b>Description : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileDesc)+"</p></span>' class='CR-info popHover'></i>",(-1!=loginUserRoleCheck&&void 0==data.fileRoleName||0===data.fileConfident&&void 0!==data.fileOwnerName&&data.fileOwnerID===erecno||void 0!==data.fileRoleName&&(0===data.fileConfident||0==loginUserRoleCheck||1==loginUserRoleCheck)||void 0!==isreportingTo&&!0===isreportingTo&&1===data.isreportingTo)&&-1==data.filePath.indexOf(workDriveUrl)&&-1==data.filePath.indexOf(writerUrl)&&-1==data.filePath.indexOf(sheetUrl)&&-1==data.filePath.indexOf(showUrl)&&"1"!=data.UploadSource&&(row+='<i class="CR-imprt" onclick="Files.downloadFilecabinet(this)" name="deleteElm"></i>'),actionIcs.isEmpty||""===actionIcs||void 0===actionIcs||(row+='<div id="moreOptionsParDiv" class="dropdown ZPCusDrs  FL  ML10"><div data-hover="dropdown" data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+='<ul class="dropdown-menu ZPCmn-Arrow top gray CP" id="moreFileOperations">'+actionIcs+"</div>"),row+='</div><div class="FR">',null!=data.fileActions.isEditPerm&&void 0!=data.fileActions.isEditPerm&&!0===data.fileActions.isEditPerm&&(ZPSetupCommon.isEmpty(data.agreementId)?row+="<i onclick=\"Files.showAddHRFile('edit',this, 'uploadmode')\" class=\"CR-edit\"></i>":row+='<i onclick="Files.showAddHRFile(\'edit\',this)" class="CR-edit"></i>'),null!=data.fileActions.isDeletePerm&&void 0!=data.fileActions.isDeletePerm&&!0===data.fileActions.isDeletePerm&&(row+='<i onclick="Files.deleteRecConfirm(this, \'action_confirm_btn\');" class="CR-delete"></i>')}row+="</div>",row+="</ul>",(row=$(row)).data("ldata",data),pageId.append(row)}}else{var isfirescroll=!0;("#files/fileView/hrfileslistview"!==Layout.Page.hash&&"#files/hrfile/all/listview"!==Layout.Page.hash||Files.empListViewData.All[1])&&("#files/hrfile/sub/listview"!==Layout.Page.hash||Files.empListViewData.Sub[1])&&("#files/hrfile/my/listview"!==Layout.Page.hash||Files.empListViewData.My[1])&&("#files/hrfile/role/listview"!==Layout.Page.hash||Files.empListViewData.Role[1])?(-1!==Layout.Page.hash.indexOf("/all/view-categoryId")&&!Files.empSubCatViewData.All[1]||-1!==Layout.Page.hash.indexOf("/sub/view-categoryId")&&!Files.empSubCatViewData.Sub[1]||-1!==Layout.Page.hash.indexOf("/my/view-categoryId")&&!Files.empSubCatViewData.My[1]||-1!==Layout.Page.hash.indexOf("/role/view-categoryId")&&!Files.empSubCatViewData.Role[1])&&(isfirescroll=!1):isfirescroll=!1,!1===isfirescroll&&-1!==Layout.Page.hash.indexOf("view-categoryId")?(Layout.Page.container.find("#hr_fileListing").nextAll(".ZPListingUL").remove(),Layout.Page.container.find("#catListHFDiv").find("#hr_fileListing").hide(),0==Layout.Page.container.find(".ZPBoxListing").find("ul").length&&Files.showNodataMsg("subCatView")):!1===isfirescroll&&-1!==Layout.Page.hash.indexOf("listview")&&(Layout.Page.container.find("#zp_page_loading").remove(),Files.showNodataMsg("hr_filesmsg")),Layout.Page.container.find("#hr_multiselDel").hide(),Layout.Page.container.find("#addHR_Bar").show()}}-1!==Layout.Page.hash.indexOf("createAgreement")||-1!==Layout.Page.hash.indexOf("agreementId:")?Files.Esign.getAgreementsListPage("hr"):Layout.Page.hash.indexOf("createEnvelope")>-1||-1!==Layout.Page.hash.indexOf("envelopeId:")?Files.Esign.getEnvelopeListpage():(Layout.Page.hash.indexOf("createDocument")>-1||-1!==Layout.Page.hash.indexOf("documentId:"))&&Files.Esign.getDocumentsListPage("hr"),Object.keys(Files.empListViewData.All[2]).length>0&&-1!==Layout.Page.hash.indexOf("hrfile/all/view-categoryId")?(0==Files.empSubCatViewData.All[0]?Files.empSubCatViewData.All[0]=25:Files.empSubCatViewData.All[0]=Files.empSubCatViewData.All[0]+24,Files.empListViewData.All[2].start=Files.empSubCatViewData.All[0],!0===Files.empSubCatViewData.All[3]&&(Files.empSubCatViewData.All[3]=!1)):Object.keys(Files.empListViewData.Sub[2]).length>0&&-1!==Layout.Page.hash.indexOf("hrfile/sub/view-categoryId")?(0==Files.empSubCatViewData.Sub[0]?Files.empSubCatViewData.Sub[0]=25:Files.empSubCatViewData.Sub[0]=Files.empSubCatViewData.Sub[0]+24,Files.empListViewData.Sub[2].start=Files.empSubCatViewData.Sub[0],!0===Files.empSubCatViewData.Sub[3]&&(Files.empSubCatViewData.Sub[3]=!1)):Object.keys(Files.empListViewData.My[2]).length>0&&-1!==Layout.Page.hash.indexOf("hrfile/my/view-categoryId")?(0==Files.empSubCatViewData.My[0]?Files.empSubCatViewData.My[0]=25:Files.empSubCatViewData.My[0]=Files.empSubCatViewData.My[0]+24,Files.empListViewData.My[2].start=Files.empSubCatViewData.My[0],!0===Files.empSubCatViewData.My[3]&&(Files.empSubCatViewData.My[3]=!1)):Object.keys(Files.empListViewData.Role[2]).length>0&&-1!==Layout.Page.hash.indexOf("hrfile/role/view-categoryId")?(0==Files.empSubCatViewData.Role[0]?Files.empSubCatViewData.Role[0]=25:Files.empSubCatViewData.Role[0]=Files.empSubCatViewData.Role[0]+24,Files.empListViewData.Role[2].start=Files.empSubCatViewData.Role[0],!0===Files.empSubCatViewData.Role[3]&&(Files.empSubCatViewData.Role[3]=!1)):"#files/fileView/hrfileslistview"===Layout.Page.hash||"#files/hrfile/all/listview"===Layout.Page.hash?(0==Files.empListViewData.All[0]?Files.empListViewData.All[0]=25:Files.empListViewData.All[0]=Files.empListViewData.All[0]+24,Object.keys(Files.empListViewData.All[2]).length>0&&(Files.empListViewData.All[2].start=Files.empListViewData.All[0]),!0===Files.empListViewData.All[3]&&(Files.empListViewData.All[3]=!1)):"#files/hrfile/sub/listview"===Layout.Page.hash?(0==Files.empListViewData.Sub[0]?Files.empListViewData.Sub[0]=25:Files.empListViewData.Sub[0]=Files.empListViewData.Sub[0]+24,Object.keys(Files.empListViewData.Sub[2]).length>0&&(Files.empListViewData.Sub[2].start=Files.empListViewData.Sub[0]),!0===Files.empListViewData.Sub[3]&&(Files.empListViewData.Sub[3]=!1)):"#files/hrfile/my/listview"===Layout.Page.hash?(0==Files.empListViewData.My[0]?Files.empListViewData.My[0]=25:Files.empListViewData.My[0]=Files.empListViewData.My[0]+24,Object.keys(Files.empListViewData.My[2]).length>0&&(Files.empListViewData.My[2].start=Files.empListViewData.My[0]),!0===Files.empListViewData.My[3]&&(Files.empListViewData.My[3]=!1)):"#files/hrfile/role/listview"===Layout.Page.hash&&(0==Files.empListViewData.Role[0]?Files.empListViewData.Role[0]=25:Files.empListViewData.Role[0]=Files.empListViewData.Role[0]+24,Object.keys(Files.empListViewData.Role[2]).length>0&&(Files.empListViewData.Role[2].start=Files.empListViewData.Role[0]),!0===Files.empListViewData.Role[3]&&(Files.empListViewData.Role[3]=!1))},getAddFileElms:function(data){var parentCont=Layout.Page.parentContainer.parent();0===parentCont.find("#add_hrfileDiv").length&&ZPeople.Request.send("/getSelfserviceHrFilesView.zp",{isAdd:"true"},Files.getAddFileElms),0===parentCont.find("#add_hrfileDiv").length&&parentCont.append(data),Files.showAddHRFile(),Files.getcatList("profile")},getSharingOptsList:function(){if(!1===Files.isOrgShareFetched){var formData=new FormData;formData.append("methodName","getOrgComponents"),formData.append("isOrgStrEnabled",isOrgStructureEnabled),formData.append("conreqcsr",csrfToken),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){Files.isOrgShareFetched=!0,void 0!==resultData[1]&&(Files.sharingOpts=resultData[1])}})}},getfirstLvlNode:function(shareOpts){var node="Location";return Object.keys(shareOpts.Entity).length>0?node="Entity":Object.keys(shareOpts.Unit).length>0?node="Unit":Object.keys(shareOpts.Division).length>0?node="Division":Object.keys(shareOpts.Department).length>0&&(node="Department"),node},showOrgSharingOpts:function(){isOrgStructureEnabled||(Files.sharingOpts.Entity={},Files.sharingOpts.Unit={},Files.sharingOpts.Division={});var nodeData=Files.sharingOpts,firstNode=Files.getfirstLvlNode(Files.sharingOpts),keyIdPairJson={Entity:{id:"Entity",dispVal:ZPeople.decodeTxt(ZPeople.orgStructureDispNameMap.entity)},Unit:{id:"Business_unit",dispVal:ZPeople.decodeTxt(ZPeople.orgStructureDispNameMap.unit)},Division:{id:"Division",dispVal:ZPeople.decodeTxt(ZPeople.orgStructureDispNameMap.division)},Department:{id:"Department",dispVal:ZPeople.decodeTxt(ZPeople.orgStructureDispNameMap.department)},Location:{id:"LocationName",dispVal:ZPI18N.getString("zp.location")}};keyIdPairJson[firstNode].Class="tab-pane fade active in",keyIdPairJson[firstNode].parentClass="active";var multiTagTriggerKeyObj=Layout.Page.container.find("#orgShareList"),menuBox=AutomationCommon.contructMbox(nodeData,keyIdPairJson);if(0==loginUserRoleCheck||1==loginUserRoleCheck){var footerDiv='<div class="popover-footer"><div class="inlRadio" nottitle="Notify All" data-toggle="tooltip" data-original-title="" title=""><label class="checkbox"><input name="notifyAll" onclick="TemplateCommon.notifyAll(this,\'orgShareOptList\')" type="checkbox"><span>'+ZPI18N.getString("zp.sharetoorg")+"</span></label></div></div>";menuBox.append(footerDiv)}void 0===$(multiTagTriggerKeyObj).data("bs.popover")?$(multiTagTriggerKeyObj).setPopOver({callback:TaskConfig.taskOwnerCallBackAction,html:$(menuBox),targetId:Layout.Page.pageId+" #orgShareOptList",keyname:"name=list-group-item",multi:!0}):$(multiTagTriggerKeyObj).setContent($(menuBox)),selectedTagPopover("orgShareOptList",multiTagTriggerKeyObj),$(multiTagTriggerKeyObj).popover("show")},setOrgFileShareOpts:function(data){if(void 0!==data){var firstNode=Files.getfirstLvlNode(Files.sharingOpts),keyIdPairJson={Entity:{id:"Entity",dispVal:ZPeople.decodeTxt(ZPeople.orgStructureDispNameMap.entity)},Unit:{id:"Business_unit",dispVal:ZPeople.decodeTxt(ZPeople.orgStructureDispNameMap.unit)},Division:{id:"Division",dispVal:ZPeople.decodeTxt(ZPeople.orgStructureDispNameMap.division)},Department:{id:"Department",dispVal:ZPeople.decodeTxt(ZPeople.orgStructureDispNameMap.department)},Location:{id:"LocationName",dispVal:ZPI18N.getString("zp.location")}};if(keyIdPairJson[firstNode].Class="tab-pane fade active in",keyIdPairJson[firstNode].parentClass="active",$.each(data,function(parentKey,childTagJObj){var parentTagJson={id:keyIdPairJson[parentKey].id,value:keyIdPairJson[parentKey].dispVal};$.each(childTagJObj,function(childId,value){var childTagJson={id:childId,value:decodeHTML(value),attr:childId};Layout.Page.container.find("#orgShareOptList").tagInput(parentTagJson,[childTagJson])})}),0===Object.keys(data).length){Layout.Page.container.find("#optList").html(""),Layout.Page.container.find("#optList").addClass("disabled");var notifyAll='<div ptagid="NotifyAll" attr="undefined" class="taggroup"><p tagname=""></p>';notifyAll+='<span ctagid="NotifyAll" class="spntag" attr="NotifyAll">'+ZPI18N.getString("zp.sharetoorg")+'<i name="closeIc" class="IC-cls-1px"></i></span></div>',Layout.Page.container.find("#optList").html(notifyAll)}}},showAddcompanyFile:function(mode,obj,submode){if($("#add_companyfileInnerDiv").find("input[type=checkbox]").prop("checked",!1),Files.isIprestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")),Layout.Page.container.find("#add_companyfileDiv").modal("hide");else if(Files.isGeorestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")),Layout.Page.container.find("#add_companyfileDiv").modal("hide");else if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.showAddcompanyFile(mode,obj)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.showAddcompanyFile(mode,obj)}),$(document).on("click",function(e){Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||-1!==$(e.target).attr("class").indexOf("btn")||-1!==$(e.target).attr("class").indexOf("IC")||(pageLoaded=!0,Files.showAddcompanyFile(mode,obj))})}else{var longitude="",latitude="";isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(latitude=Files.Geo.position.coords.latitude,longitude=Files.Geo.position.coords.longitude);var pageId=Layout.Page.container.find("#add_companyfileDiv");pageId.modal("show"),pageId.find("#add_companyfileInnerDivLoading").html(ZPeople.LOADING_HTML),pageId.find("#add_companyfileInnerDiv").hide(),pageId.find(".modal-footer").show(),pageId.find(".ERR").remove(),pageId.find("#select_location").select2(),Files.cancelnewCategory("company"),pageId.find("#notify")[0].checked=!1;var isNewUI=ZPeople.isZPNewUI();if(Files.getSharingOptsList(),"edit"===mode){pageId.find("#companyselect_Cat").html(""),pageId.find("#uploadfile").val(""),Files.FilescatList("company","companyselect_Cat","s2id_companyselect_Cat"),isNewUI?pageId.find("#addFile_header").html(ZSEC.Encoder.encodeForHTML(Files.editcompdisname)):pageId.find("#addFile_header").html(ZPI18N.getString("zp.editcompanyfiles"));var editData=$(obj).parent().parent().parent().data().ldata;"uploadmode"==submode?(pageId.find("#comp_fileField").show(),Files.changeOnUpload(ZPeople.decodeTxt(editData.fileName),"localUpload")):pageId.find("#comp_fileField").hide(),pageId.find("#fileName").val(ZPeople.decodeTxt(editData.fileName)),editData.isSystem?pageId.find("#fileName").addClass("dvfrmlist disabled"):pageId.find("#fileName").removeClass("dvfrmlist disabled"),"null"!==editData.fileDesc&&void 0!==editData.fileDesc&&pageId.find("#fileDesc").val(ZPeople.decodeTxt(editData.fileDesc)),"null"!=editData.validUntildate&&void 0!=editData.validUntildate&&null!=editData.validUntildate&&0!=editData.validUntildate?pageId.find("#validityDate").val(editData.validUntildate):pageId.find("#validityDate").val(""),pageId.find("#companyselect_Cat").select2("val",editData.fileCategoryID),pageId.find("#filetype").val(editData.fileType),pageId.find("#editFileId").val(editData.fileID);var editValue="-1";(editData.fileType=""!==editData.fileLocationID)&&(editValue=editData.fileLocationID),0==editData.fileLocationID.length&&(editValue="-1"),Files.getLocationList("select_location","edit",editValue,latitude,longitude,!0),Layout.Page.container.find("#optList").html(""),Layout.Page.container.find("#optList").removeClass("disabled"),1===editData.fileConfident?pageId.find("#isDownload").prop("checked",!1):pageId.find("#isDownload").prop("checked",!0),1===editData.fileAcknowledge?pageId.find("#isAcknowledge").prop("checked",!0):pageId.find("#isAcknowledge").prop("checked",!1),Files.setOrgFileShareOpts(editData.fileOrgStructure)}else{if(pageId.find("#isDownload").prop("checked",!0),isNewUI?pageId.find("#addFile_header").html(ZSEC.Encoder.encodeForHTML(Files.addcompdisname)):pageId.find("#addFile_header").html(ZPI18N.getString("zp.addcompanyfiles")),pageId.find("#beforeUpload").removeClass("DN"),pageId.find("#afterUpload").addClass("DN"),pageId.find("#comp_fileField").show(),pageId.find("#fileName").val(""),pageId.find("#fileDesc").val(""),pageId.find("#uploadfile").val(""),pageId.find("#validityDate").val(""),pageId.find("#companyselect_Cat").select2("val",""),pageId.find("#editFileId").val("0"),pageId.find("#companyselect_Cat").html(""),Files.FilescatList("company","companyselect_Cat","s2id_companyselect_Cat"),pageId.find("#companyselect_Cat").select2("val",[-1]),-1!==Layout.Page.hash.indexOf("/view")){var categoryId=Layout.Page.urlparam.categoryId;pageId.find("#companyselect_Cat").select2("val",categoryId)}var value="-1";2==loginUserRoleCheck&&(value="1"),Files.getLocationList("select_location","add",value,latitude,longitude,!0),Layout.Page.container.find("#optList").html(""),Layout.Page.container.find("#optList").removeClass("disabled")}pageId.find("#add_companyfileInnerDivLoading").hide(),pageId.find("#add_companyfileInnerDiv").show(),Files.uploadMode="",Files.uploadedDocObj={}}pageId.find(".select2-input").css("width","100%")},searchCompanyFiles:function(mapPos,mode){var errflag=!1,searchbyCat="-1";searchbyCat=-1!==Layout.Page.hash.indexOf("#files/companyfile/view")?Layout.Page.urlparam.categoryId:Layout.Page.container.find("#companysearch_cat").val();var searchbyLocationId=Layout.Page.container.find("#search_location").val();-1==loginUserRoleCheck&&(searchbyLocationId=_LOGGEDIN_LOCID),void 0===Layout.Page.container.find("#search_location").val()&&(searchbyLocationId="-1");var fromDate="";fromDate=""!=Layout.Page.container.find("#companysearch_fromDate").val()&&void 0!=Layout.Page.container.find("#companysearch_fromDate").val()&&0!=Layout.Page.container.find("#companysearch_fromDate").val()?Layout.Page.container.find("#companysearch_fromDate").val():"-1";var toDate="";toDate=""!=Layout.Page.container.find("#companysearch_toDate").val()&&void 0!=Layout.Page.container.find("#companysearch_toDate").val()&&0!=Layout.Page.container.find("#companysearch_toDate").val()?Layout.Page.container.find("#companysearch_toDate").val():"-1";var searchFileName="";""!=Layout.Page.container.find("#search_CFname").val()&&void 0!=Layout.Page.container.find("#search_CFname").val()&&(searchFileName=Layout.Page.container.find("#search_CFname").val());var searchbyEntity,searchbyUnit,searchbyDivision,searchbyDept,searchFileExtn="";if(""!=Layout.Page.container.find("#search_CFextn").val()&&void 0!=Layout.Page.container.find("#search_CFextn").val()){var fileExtnType=Layout.Page.container.find("#search_CFextn").val();searchFileExtn=Files.fetchFileExtn(fileExtnType)}if(null!==Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeeentity").val()&&void 0!==Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeeentity").val()&&""!==Layout.Page.container.find("#zp_views_employeeentity").val()&&(searchbyEntity=Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeeentity").val()),null!==Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeeunit").val()&&void 0!==Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeeunit").val()&&""!==Layout.Page.container.find("#zp_views_employeeunit").val()&&(searchbyUnit=Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeeunit").val()),null!==Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeedivision").val()&&void 0!==Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeedivision").val()&&""!==Layout.Page.container.find("#zp_views_employeedivision").val()&&(searchbyDivision=Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeedivision").val()),null!==Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeedepartment").val()&&void 0!==Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeedepartment").val()&&""!==Layout.Page.container.find("#zp_views_employeedepartment").val()&&(searchbyDept=Layout.Page.container.find("#companyfilterdiv").find("#zp_views_employeedepartment").val()),"0"==loginUserRoleCheck&&"1"==loginUserRoleCheck||("Entity"!=Layout.Page.container.find("#selectorgStructEntities").val()||null!=searchbyEntity&&void 0!=searchbyEntity||(searchbyEntity="-1"),"Business_unit"!=Layout.Page.container.find("#selectorgStructEntities").val()||null!=searchbyUnit&&void 0!=searchbyUnit||(searchbyUnit="-1"),"Division"!=Layout.Page.container.find("#selectorgStructEntities").val()||null!=searchbyDivision&&void 0!=searchbyDivision||(searchbyDivision="-1"),"Department"!=Layout.Page.container.find("#selectorgStructEntities").val()||null!=searchbyDept&&void 0!=searchbyDept||(searchbyDept="-1")),!1===Files.searchWithDateValidation(Layout.Page.container.find("#companysearch_fromDate").val(),Layout.Page.container.find("#companysearch_toDate").val())&&(errflag=!0),errflag)return!1;if("#files/companyfile/listview"===Layout.Page.hash&&(Files.orgListViewData.Org[1]=!0,Files.orgListViewData.Org[0]=0,Files.orgCatViewData.Org[3]=!0,Files.orgSubCatViewData.Org[3]=!0,Layout.Page.container.find("#comp_fileListing").html("")),-1!==Layout.Page.hash.indexOf("#files/companyfile/view")&&(Files.orgSubCatViewData.Org[1]=!0,Files.orgSubCatViewData.Org[0]=0,Files.orgCatViewData.Org[3]=!0,Files.orgListViewData.Org[3]=!0,Layout.Page.container.find("#comp_fileListing").find(".ZPNdata ").length>0&&(Layout.Page.container.find("#catListCFDiv").find("#comp_fileListing").html(""),Files.constructTopBar("1")),Layout.Page.container.find("#catListCFDiv").find("#compfiles_list").show(),Layout.Page.container.find("#compfiles_list").nextAll(".ZPListingUL").remove()),isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&ZPSetupCommon.isEmpty(mode)){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.searchCompanyFiles(position,"search")},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.searchCompanyFiles("","search")}),isBlocked||$(document).on("click",function(e){Files.Geo.positionBlocked(),-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||!ZPSetupCommon.isEmpty($(e.target).attr("class"))&&$(e.target).text()===ZPI18N.getString("zp.search")||(pageLoaded=!0,Files.searchCompanyFiles("","search"))})}else{var isExpiredFilesView=!1;"1"===Layout.Page.container.find("#companyFileViewType").val()?isExpiredFilesView=!0:"0"===Layout.Page.container.find("#companyFileViewType").val()&&(isExpiredFilesView=!1),Files.orgListViewData.Org[2]={catId:searchbyCat,methodName:"getAllFiles",fileType:1,locationId:searchbyLocationId,conreqcsr:csrfToken,searchFileName:searchFileName,searchFileExtn:searchFileExtn,isExpiredFilesView:isExpiredFilesView},null!=fromDate&&void 0!==fromDate&&""!==fromDate&&"-1"!==fromDate&&(Files.orgListViewData.Org[2].fromDate=fromDate),null!=toDate&&void 0!==toDate&&""!==toDate&&"-1"!==toDate&&(Files.orgListViewData.Org[2].toDate=toDate),-1!==Layout.Page.hash.indexOf("#files/companyfile/listview")&&(Files.orgListViewData.Org[2].start=Files.orgListViewData.Org[0]),-1!==Layout.Page.hash.indexOf("#files/companyfile/view")&&(Files.orgListViewData.Org[2].start=Files.orgSubCatViewData.Org[0]),"Entity"==Layout.Page.container.find("#selectorgStructEntities").val()&&(Files.orgListViewData.Org[2].entityId=searchbyEntity,null!=searchbyEntity&&void 0!=searchbyEntity&&"-1"!=searchbyEntity&&(Files.orgListViewData.Org[2].entityName=Layout.Page.container.find("#s2id_zp_views_employeeentity").find("span").text())),"Business_unit"==Layout.Page.container.find("#selectorgStructEntities").val()&&(Files.orgListViewData.Org[2].unitId=searchbyUnit,null!=searchbyUnit&&void 0!=searchbyUnit&&"-1"!=searchbyUnit&&(Files.orgListViewData.Org[2].unitName=Layout.Page.container.find("#s2id_zp_views_employeeunit").find("span").text())),"Division"==Layout.Page.container.find("#selectorgStructEntities").val()&&(Files.orgListViewData.Org[2].divisionId=searchbyDivision,null!=searchbyDivision&&void 0!=searchbyDivision&&"-1"!=searchbyDivision&&(Files.orgListViewData.Org[2].divisionName=Layout.Page.container.find("#s2id_zp_views_employeedivision").find("span").text())),"Department"==Layout.Page.container.find("#selectorgStructEntities").val()&&(Files.orgListViewData.Org[2].deptId=searchbyDept,null!=searchbyDept&&void 0!=searchbyDept&&"-1"!=searchbyDept&&(Files.orgListViewData.Org[2].deptName=Layout.Page.container.find("#s2id_zp_views_employeedepartment").find("span").text())),"-1"==loginUserRoleCheck&&void 0!=searchbyEntity&&void 0!=searchbyUnit&&void 0!=searchbyDept&&void 0!=searchbyDivision&&(Files.orgListViewData.Org[2].locationId="-1"),Files.orgListViewData.Org[2]=Files.setFilterView(Files.orgListViewData.Org[2]),Files.setLatitudeLongitude(Files.orgListViewData.Org[2]),Files.getCompanyfilesListing("fromSearch"),Files.hideCompanyFilter()}},updateCompanyFile:function(form,foundLocation,latitude,longitude){if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&!foundLocation){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.updateCompanyFile(form,pageLoaded,position.coords.latitude,position.coords.longitude)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.updateCompanyFile(form,pageLoaded,"","")}),isBlocked||$(document).on("click",function(e){Files.Geo.positionBlocked(),-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||!ZPSetupCommon.isEmpty($(e.target).attr("class"))&&$(e.target).text()===ZPI18N.getString("zp.submit")||(pageLoaded=!0,Files.updateCompanyFile(form,pageLoaded,"",""))})}else{Layout.Page.container.find(".ERR").remove();var pageId=Layout.Page.container.find("#add_companyfileDiv"),uploadFile=pageId.find("#uploadfile").val(),fileName=pageId.find("#fileName").val(),fileDesc=pageId.find("#fileDesc").val(),validityDate=pageId.find("#validityDate").val(),errflag=!1,isDownload="0",isacknowledge="0",fileExtn=fileName.substr(fileName.lastIndexOf(".")+1,fileName.length).toLowerCase();!1===pageId.find("#isDownload").is(":checked")&&(isDownload="1"),!0===pageId.find("#isAcknowledge").is(":checked")&&(isacknowledge="1");var location="",catId="",newCatName="",notifyToall=!1,notifyAllFeeds=!1;pageId.find("#formBizcpn").val(csrfToken);var editFileId=pageId.find("#editFileId").val();if(!0===pageId.find("#notify").is(":checked")&&(notifyToall=!0),!0===pageId.find("#notifyFeeds").is(":checked")&&(notifyAllFeeds=!0),-1!=fileName.indexOf(",")&&(fileName=fileName.replace(/,/g,"_")),-1!=fileName.indexOf(",")&&(fileName=fileName.replace(/,/g,"")),"exe"==fileExtn&&(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.exefileerror")),errflag=!0),""==fileName&&(pageId.find("#fileName").after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.emptyfilename")+"</strong></span>"),errflag=!0),"0"!=editFileId&&""==uploadFile&&pageId.find("#beforeUpload").is(":visible")&&(pageId.find("#drop_file").parent().parent().after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.choosefile")+"</strong></span>"),errflag=!0),""==uploadFile&&"0"==editFileId&&"cloudUpload"!=Files.uploadMode&&"workDriveUpload"!=Files.uploadMode&&(pageId.find("#drop_file").parent().parent().after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.choosefile")+"</strong></span>"),errflag=!0),fileDesc.length>250&&(pageId.find("#fileDesc").parent().append('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.desclength")+"</strong></span>"),errflag=!0),pageId.find("#s2id_companyselect_Cat").is(":visible")&&(""==pageId.find("#companyselect_Cat").toString().trim()||"undefined"==catId||"-1"==pageId.find("#companyselect_Cat").val()||null==pageId.find("#companyselect_Cat").val()?(pageId.find("#companyCatselect").append('<span class="ERR" errmsg="mailids" id="companycategory_err" >'+ZPI18N.getString("zp.selectcategory")+"</span>"),errflag=!0):""==pageId.find("#companyselect_Cat").val()&&null!=pageId.find("#companyselect_Cat").val()||(catId=pageId.find("#companyselect_Cat").val(),pageId.find("#companycategory_err").hide())),pageId.find("#companynewCategory").is(":visible")&&(pageId.find("#companycategory_err").hide(),""===pageId.find("#companynewCategory").val().trim()?(pageId.find("#companyCatselect").append('<span class="ERR" errmsg="mailids" id="companycategory_err" >'+ZPI18N.getString("zp.selectcategory")+"</span>"),errflag=!0):""!=pageId.find("#companynewCategory").val()&&(newCatName=pageId.find("#companynewCategory").val(),pageId.find("#companycategory_err").hide())),""!=pageId.find("#validityDate").val()&&void 0!=pageId.find("#validityDate").val()&&0!=pageId.find("#validityDate").val()){var validityDateval=pageId.find("#validityDate").val();"-1"!=dateFmt.indexOf("MMM")&&(validityDateval=validityDateval.replace(/-/g," "));var currentdatelong=Calendar.getCurrentDate().getTime();new Date(validityDateval).getTime()<currentdatelong?(pageId.find("#validityDate").parent().append('<span  errmsg="mailids" id="errormsgvalid" class="ERR">'+ZPI18N.getString("zp.validuntilerr")+"</strong></span>"),errflag=!0):pageId.find("#errormsgvalid").hide()}-1==fileName.indexOf("<")&&-1==fileName.indexOf(">")&&-1==fileName.indexOf("&lt;")&&-1==fileName.indexOf("&gt;")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.filename")))),errflag=!0),-1==fileDesc.indexOf("<")&&-1==fileDesc.indexOf(">")&&-1==fileName.indexOf("&lt;")&&-1==fileName.indexOf("&gt;")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.description")))),errflag=!0),-1==newCatName.indexOf("<")&&-1==newCatName.indexOf(">")&&-1==newCatName.indexOf("&lt;")&&-1==newCatName.indexOf("&gt;")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.folder")))),errflag=!0),null!=newCatName&&void 0!=newCatName&&"/"===newCatName&&(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.avoidslash")),errflag=!0);var OrgStructDetails=Layout.Page.container.find("#orgShareOptList").getTagConfig();-1!=loginUserRoleCheck&&(null==OrgStructDetails||void 0===OrgStructDetails||jQuery.isEmptyObject(OrgStructDetails)?(pageId.find("#orgShareOptList").after('<span errmsg="mailids" id="errormsgorg" class="ERR">'+ZPI18N.getString("zp.orgstructerr")+"</strong></span>"),errflag=!0):(OrgStructDetails.hasOwnProperty("NotifyAll")&&(OrgStructDetails.LocationName=["-1"],delete OrgStructDetails.NotifyAll),pageId.find("#errormsgorg").hide(),OrgStructDetails.hasOwnProperty("LocationName")&&(location=OrgStructDetails.LocationName)));var fileObj=pageId.find("#uploadfile")[0].files[0],maxFileSizeforAdd=1e6*maxFileSize.split("MB")[0];if(fileObj&&fileObj.size>maxFileSizeforAdd&&(errflag=!0,ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesizelimit",[maxFileSize]))),fileObj&&"localUpload"==Files.uploadMode&&"-1"==Files.udsParams.fileId&&(errflag=!0,ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.fileuploaderror"))),errflag)return!1;if(Files.isIprestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));else{var formData=new FormData;formData.append("methodName","addFile"),formData.append("conreqcsr",csrfToken),formData.append("fileName",fileName),formData.append("fileDesc",fileDesc),formData.append("fileType","1"),null!=location&&void 0!=location&&""!=location&&formData.append("locationId",location),formData.append("catId",catId),formData.append("editFileId",editFileId),formData.append("notifyToall",notifyToall),formData.append("notifyFeeds",notifyAllFeeds),formData.append("newCatName",newCatName),formData.append("confidential",isDownload),formData.append("isAcknowledgement",isacknowledge),formData.append("uploadMode",Files.uploadMode),fileObj&&"localUpload"==Files.uploadMode&&(formData.append("importFileId",Files.udsParams.fileId),formData.append("fileVersion",Files.udsParams.fileVersion)),null!=validityDate&&void 0!==validityDate&&""!==validityDate&&-1!==validityDate&&formData.append("validityDate",validityDate),Layout.Page.hash.indexOf("files/companyfile/listview")>-1&&formData.append("isNewui",!0),isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(formData.append("latitude",Files.Geo.position.coords.latitude),formData.append("longitude",Files.Geo.position.coords.longitude)),"cloudUpload"==Files.uploadMode&&formData.append("cloudUploadDoc",JSON.stringify(Files.uploadedDocObj)),"workDriveUpload"==Files.uploadMode&&formData.append("WDUploadDoc",JSON.stringify(Files.uploadedDocObj)),"localUpload"!==Files.uploadMode&&void 0!==pageId.find("#uploadfile")[0].files[0]&&formData.append("uploadfile",pageId.find("#uploadfile")[0].files[0]),null==OrgStructDetails||jQuery.isEmptyObject(OrgStructDetails)||formData.append("orgStructureDetails",JSON.stringify(OrgStructDetails)),newcatexist=!1,null!=newCatName&&""!=newCatName&&(newcatexist=!0),pageId.find("#add_companyfileInnerDivLoading").show(),pageId.find("#add_companyfileInnerDivLoading").html(ZPeople.LOADING_HTML),pageId.find("#add_companyfileInnerDiv").hide(),pageId.find(".modal-footer").hide(),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){Files.resetVals(),Files.updateReloadParams("1"),Layout.Page.container.find("#add_companyfileDiv").modal("hide"),newcatexist&&null!=newCatName&&void 0!=newCatName&&"/"!=newCatName&&""!=newCatName&&(Files.newCategoryList[data[1].CatID]=data[1].CatName),"#files/companyfile/listview"===Layout.Page.hash||-1!==Layout.Page.hash.indexOf("view-categoryId")?Files.getCompanyfilesListing("addCompany","Sucess",newcatexist,editFileId):"#files/companyfile/catview"===Layout.Page.hash&&Files.showCategoryView("add",void 0,"Sucess",newcatexist,editFileId)},error:function(req){var errResponse=req.responseJSON[1];8103!==req.status&&8101!==req.status&&500!==req.status||ZPeople.Message.showFailureMsg(errResponse.msg),pageId.modal("hide")}})}}},getFilesListing:function(){Agreements.funcToOpenFilter(),Agreements.isCancelAgr?Agreements.isCancelAgr=!1:(Files.hideCompanyFilter(),"#files/companyfile/listview"===Layout.Page.hash&&(Object.keys(Files.orgListViewData.Org[2]).length>0||!0===Files.orgListViewData.Org[3])&&$("#page-wrapper").addClass("filter-container"),"#files/fileView/companyfileslistview"===Layout.Page.hash||"#files/companyfile/listview"===Layout.Page.hash||-1!==Layout.Page.hash.indexOf("companyfileslistview-add")||0===Layout.Page.container.find("tbody#comp_fileList").find("tr").length?0===Files.orgListViewData.Org[0]&&(Files.orgListViewData.Org[0]=0,Files.orgListViewData.Org[1]=!0,Layout.Page.container.find("#comp_fileListing").html(""),Files.getLocationList(),Files.getCompanyfilesListing(),-1!==Layout.Page.hash.indexOf("companyfileslistview-add")&&Files.showAddcompanyFile()):Files.Esign.getAgreementsListPage("company"))},getCompanyfilesListing:function(mode,msg,newcat,editFileId){if(Layout.Page.container.find("#comp_fileListing").attr("scroll","enabled"),"addCompany"!=mode&&"change"!=mode||(Layout.Page.container.find("#comp_fileListing").scrollTop(0),"#files/companyfile/listview"===Layout.Page.hash&&(Layout.Page.container.find("#comp_fileListing").html(""),Files.orgListViewData.Org[0]=0,Files.orgListViewData.Org[1]=!0),-1!==Layout.Page.hash.indexOf("/view-categoryId")&&(Layout.Page.container.find("#comp_fileListing").find("#compfiles_list").nextAll().remove(),Layout.Page.container.find("#comp_fileListing").find("#compfiles_list").remove(),Layout.Page.container.find("#comp_fileListing").find(".ZPNdata").remove(),Files.constructTopBar("1"),Files.orgSubCatViewData.Org[0]=0,Files.orgSubCatViewData.Org[1]=!0)),"Sucess"==msg)"0"!==editFileId?ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatefile")):ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.addfile"));else if("copy"==msg)ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.copyfile"));else if("move"==msg)ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.movefile"));else if("Error"==msg)return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.invalidmsg"));if(Layout.Page.container.find("#comp_fileListing").find(".ZPListingUL").length<=0&&-1===Layout.Page.hash.indexOf("/view")&&(Layout.Page.container.find("#nocompanyFilesDiv").show(),Layout.Page.container.find("#comp_fileListing").hide(),Layout.Page.container.find("#nocompanyFilesDiv").html(ZPeople.LOADING_HTML)),$("body").popover({selector:"[data-popover].popHover",trigger:"click hover",placement:"right",delay:{show:50,hide:50}}),Layout.Page.container.find("#companyFileViewType").select2(),Layout.Page.container.find("#company_multiselDel").hide(),Layout.Page.container.find("#addCompany_Bar").show(),Files.closeCopyMoveDiv(),1==Files.orgListViewData.Org[1]||1==Files.orgSubCatViewData.Org[1]||Object.keys(Files.orgListViewData.Org[2]).length>0||"fromSearch"===mode){var params={};Object.keys(Files.orgListViewData.Org[2]).length>0||"fromSearch"===mode?(Files.orgListViewData.Org[2].methodName="getAllFiles",params=Files.orgListViewData.Org[2]):(params={methodName:"getAllFiles",fileType:1,start:Files.orgListViewData.Org[0],conreqcsr:csrfToken},"1"===Layout.Page.container.find("#companyFileViewType").val()?params.isExpiredFilesView=!0:"0"===Layout.Page.container.find("#companyFileViewType").val()&&(params.isExpiredFilesView=!1)),-1!==Layout.Page.hash.indexOf("view-categoryId")?params.start=Files.orgSubCatViewData.Org[0]:params.start=Files.orgListViewData.Org[0],Files.searchFileBreadcrumbs(),Layout.Page.container.find("#compfiles_list").find(".ZPListingUL").show();var pageLoaded=!1,isBlocked=!1,isNewCat=!(!newcat&&Files.isCachedCat);isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position?(navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.foundLocation(position,1,params,null,isNewCat)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.foundLocation("block",1,params,null,isNewCat)}),$(document).on("click",function(e){Files.Geo.positionBlocked(),!isBlocked&&Layout.Page.hash.indexOf("/listview")>-1&&!pageLoaded&&$(e.target).text()!==ZPI18N.getString("zp.search")&&void 0!==$(e.target)&&-1===$(e.target).attr("class").indexOf("select2")&&(pageLoaded=!0,Files.foundLocation("",1,params,null,isNewCat))})):(Files.setLatitudeLongitude(params),Files.foundLocation("",1,params,null,isNewCat))}},getCompanyFilesCallBack:function(resultData,params,newCat){var respObj;if(resultData.hasOwnProperty("fail")&&Layout.Page.hash.indexOf("/companyfile")>-1)return Layout.Page.container.find("#nocompanyFilesDiv").find("#zp_page_loading").hide(),void(-1!==Layout.Page.hash.indexOf("view-categoryId")&&0===Files.orgSubCatViewData.Org[0]?(Layout.Page.container.find("#compfiles_list").nextAll(".ZPListingUL").remove(),Layout.Page.container.find("#catListCFDiv").find("#compfiles_list").hide(),0==Layout.Page.container.find(".ZPBoxListing").find("ul").length&&Files.showNodataMsg("subCatView")):-1!==Layout.Page.hash.indexOf("companyfile/listview")&&0===Files.orgListViewData.Org[0]&&Files.showNodataMsg("company_filesmsg"));void 0!==(respObj=resultData[1])?-1==Layout.Page.hash.indexOf("view-categoryId")||0!==Files.orgSubCatViewData.Org[0]&&!1===Files.orgSubCatViewData.Org[1]?-1==Layout.Page.hash.indexOf("view-categoryId")&&!1!==Files.orgListViewData.Org[1]&&(Files.companyfilelistView(respObj),void 0!=newCat&&newCat&&Files.getcatList("company",params.latitude,params.longitude,!0)):(Files.companyfilelistView(respObj),void 0!=newCat&&newCat&&Files.getcatList("company",params.latitude,params.longitude,!0)):(Files.isIprestrict(resultData),Files.companyfilelistView())},companyfilelistView:function(resultData,mode){Layout.Page.container.find("#nocompanyFilesDiv").find("#zp_page_loading").remove();var pageId=Layout.Page.container.find("#comp_fileListing");if(Files.isIprestricted){Layout.Page.container.find("#nocompanyFilesDiv").hide(),Layout.Page.container.find("#comp_fileListing").show();row='<ul class="ZPListingUL">';row+='<li class="text-center">'+ZPI18N.getString("zp.iprestricted")+"</li></ul>",pageId.append(row)}else{var parseObj=resultData,dataLimit=parseObj.length;if(parseObj.length<25?(dataLimit=parseObj.length,-1!==Layout.Page.hash.indexOf("view-categoryId")?Files.orgSubCatViewData.Org[1]=!1:-1!==Layout.Page.hash.indexOf("companyfile/listview")&&(Files.orgListViewData.Org[1]=!1)):(dataLimit=parseObj.length-1,-1!==Layout.Page.hash.indexOf("view-categoryId")?Files.orgSubCatViewData.Org[1]=!0:-1!==Layout.Page.hash.indexOf("companyfile/listview")&&(Files.orgListViewData.Org[1]=!0)),Files.isGeorestricted=!1,parseObj.length>0){void 0!=pageId.find("ul#geo_err")&&pageId.find("ul#geo_err").length>0&&pageId.find("ul#geo_err").remove(),ZPeople.FireScroll.reset(),Layout.Page.container.find("#comp_fileListing").show(),Layout.Page.container.find("#nocompanyFilesDiv").hide();for(var i=0;i<dataLimit;i++){var data=parseObj[i];Files.isIprestricted=!1;var fileExtn=data.filePath,filePath=data.filePath,fileName=data.fileName;-1!=fileExtn.lastIndexOf(".")&&(fileExtn=(fileExtn=fileExtn.substr(fileExtn.lastIndexOf(".")+1,fileExtn.length)).toLowerCase()),(data.filePath.indexOf(workDriveUrl)>-1||data.filePath.indexOf(writerUrl)>-1||data.filePath.indexOf(sheetUrl)>-1||data.filePath.indexOf(showUrl)>-1||"1"==data.UploadSource)&&(fileExtn="workdrive"),ZPeople.IsNumeric(filePath)&&(fileExtn=data.fileExtn.toLowerCase()),-1!=filePath.indexOf("_signed")&&filePath.indexOf("_signed")>=-1&&-1!=filePath.lastIndexOf(".")&&(fileExtn=(fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length)).toLowerCase());var row='<ul class="ZPListingUL" id="compfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'"  uploadFileExtn = "'+fileExtn+'" isLoginUserAck = '+data.isLoginUserAck+">";-1!=loginUserRoleCheck&&(row+='<li class="check"><div class="checkbox"><input type="checkbox" id="'+data.fileID+'" onclick="Files.checkParticularfiles(this,\'company\')"><label class="MT3"></label></div></li>'),data.filePath.indexOf(workDriveUrl)>-1||data.filePath.indexOf(writerUrl)>-1||data.filePath.indexOf(sheetUrl)>-1||data.filePath.indexOf(showUrl)>-1||"1"==data.UploadSource?row+='<li class="name" id="compfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'" onclick="Files.openWDFiles(this)">':row+='<li class="name" id="compfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'" onclick="Layout.Page.pageContWrapper.parent().prepend(Files.constructPreview(\'compfileTr_'+data.fileID+"','files'));Files.viewFile(this,'company')\">",row+="pdf"===fileExtn?'<i class="IC-pdf"></i>':"xls"===fileExtn||"xlsx"===fileExtn||"xlsm"===fileExtn||"sxc"===fileExtn||"ods"===fileExtn||"csv"===fileExtn||"tsv"===fileExtn?'<i class="IC-xls-new"></i>':"htm"===fileExtn||"html"===fileExtn?'<i class="IC-code"></i>':"doc"===fileExtn||"docx"===fileExtn||"sxw"===fileExtn||"odt"===fileExtn||"rtf"===fileExtn?'<i class="IC-doc"></i>':"ppt"===fileExtn||"pps"===fileExtn||"odp"===fileExtn||"sxi"===fileExtn||"pptx"===fileExtn?'<i class="IC-ppt"></i>':"zip"===fileExtn?'<i class="IC-zip"></i>':"mp3"===fileExtn||"mp4a"===fileExtn||"wav"===fileExtn?'<i class="IC-mp3"></i>':"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn?'<i class="IC-jpg"></i>':"workdrive"===fileExtn?'<i class="IC-wd"></i>':'<i class="IC-doc"></i>',row+='<span href="javascript:;" title="'+ZPeople.escapeHtml(ZPeople.decodeTxt(fileName))+'" class="ellip">'+ZPeople.escapeHtml(ZPeople.decodeTxt(fileName))+"</span></li>",row+=Files.Reports.acknowledgementStatus(data.fileID,data.fileAcknowledge,void 0,void 0,data.isLoginUserAck,!1,data);void 0===data.fileLocationName?ZPI18N.getString("zp.all"):void 0!==data.fileLocationName&&data.fileLocationName;var filterView=jQuery.isEmptyObject(Files.orgListViewData.Org[2])?"":Files.orgListViewData.Org[2].filterView;if(jQuery.isEmptyObject(data.fileOrgStructure))row+="<li><span>"+ZPI18N.getString("zp.all")+"</span></li>";else if(void 0!=filterView&&filterView.indexOf("entity")>-1){var entityNames=[];for(var id in data.fileOrgStructure.Entity)entityNames.push(data.fileOrgStructure.Entity[id]);entityNames.length>1?(row+='<li><span class="btn-sm FL">'+entityNames[0]+"</span>",row+='<div class=" dropdown ZPCusDrs  FL  ML5 "><div data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+=Files.getAllSharedLocRole(entityNames),row+="</div></li>"):row+="<li><span>"+entityNames[0]+"</span></li>"}else if(void 0!=filterView&&filterView.indexOf("unit")>-1){var unitNames=[];for(var id in data.fileOrgStructure.Unit)unitNames.push(data.fileOrgStructure.Unit[id]);unitNames.length>1?(row+='<li><span class="btn-sm FL">'+unitNames[0]+"</span>",row+='<div class=" dropdown ZPCusDrs  FL  ML5 "><div data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+=Files.getAllSharedLocRole(unitNames),row+="</div></li>"):row+="<li><span>"+unitNames[0]+"</span></li>"}else if(void 0!=filterView&&filterView.indexOf("department")>-1){var deparmentNames=[];for(var id in data.fileOrgStructure.Department)deparmentNames.push(data.fileOrgStructure.Department[id]);deparmentNames.length>1?(row+='<li><span class="btn-sm FL">'+deparmentNames[0]+"</span>",row+='<div class=" dropdown ZPCusDrs  FL  ML5 "><div data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+=Files.getAllSharedLocRole(deparmentNames),row+="</div></li>"):row+="<li><span>"+deparmentNames[0]+"</span></li>"}else if(void 0!=filterView&&filterView.indexOf("division")>-1){var divisionNames=[];for(var id in data.fileOrgStructure.Division)divisionNames.push(data.fileOrgStructure.Division[id]);divisionNames.length>1?(row+='<li><span class="btn-sm FL">'+divisionNames[0]+"</span>",row+='<div class=" dropdown ZPCusDrs  FL  ML5 "><div data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+=Files.getAllSharedLocRole(divisionNames),row+="</div></li>"):row+="<li><span>"+divisionNames[0]+"</span></li>"}else{var locationNames=[];for(var id in data.fileOrgStructure.Location)locationNames.push(data.fileOrgStructure.Location[id]);locationNames.length>1?(row+='<li><span class="btn-sm FL">'+locationNames[0]+"</span>",row+='<div class=" dropdown ZPCusDrs  FL  ML5 "><div data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+=Files.getAllSharedLocRole(locationNames),row+="</div></li>"):row+="<li><span>"+locationNames[0]+"</span></li>"}data.fileCatNameNew.length>1?(row+='<li><span class="btn-sm FL">'+data.fileCatNameNew.toString().split(",")[0]+"</span>",row+='<div class=" dropdown ZPCusDrs  FL  ML5 "><div data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+=Files.getAllSharedLocRole(data.fileCatNameNew),row+="</div></li>"):row+="<li><span>"+data.fileCatName+"</span></li>",row+="<li>"+data.fileModifiedDate+"</li>",row+='<li class="actions">',-1!=loginUserRoleCheck&&(row+='<div id="action_confirm_btn" class="DN"><button class="btn btn-default btn-sm FR" onclick="Files.cancelDelRecConfirm(this);">'+ZPI18N.getString("zp.cancel")+"</button><button  class=\"btn btn-danger btn-sm FR MR10\" onclick=\"Files.deleteFiles('single','"+data.fileID+"',this,'company')\">"+ZPI18N.getString("zp.confirm")+"</button></div>"),row+='<div class="FL">',""===data.fileDesc||void 0===data.fileDesc?row+="<i onmouseover='Files.hideCompFilesOptions(this)' data-popover='true' data-html='true' data-placement='bottom' data-content='<span class=\"DB S13\"><b>"+ZPI18N.getString("zp.reports.createdby")+' : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileCreateByName)+"</p></span>' class='CR-info popHover'></i>":row+="<i onmouseover='Files.hideCompFilesOptions(this)' data-popover='true' data-html='true' data-placement='bottom' data-content='<span class=\"DB S13\"><b>"+ZPI18N.getString("zp.reports.createdby")+' : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileCreateByName)+'</p></span><br> <span class="DB S13"><b>Description : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileDesc)+"</p></span>' class='CR-info popHover'></i>","0"!=loginUserRoleCheck&&"1"!=loginUserRoleCheck||-1!=data.filePath.indexOf(workDriveUrl)||-1!=data.filePath.indexOf(writerUrl)||-1!=data.filePath.indexOf(sheetUrl)||-1!=data.filePath.indexOf(showUrl)||"1"==data.UploadSource?-1==data.filePath.indexOf(workDriveUrl)&&-1==data.filePath.indexOf(writerUrl)&&-1==data.filePath.indexOf(sheetUrl)&&-1==data.filePath.indexOf(showUrl)&&"1"!=data.UploadSource&&!0===data.allowDownload&&(row+='<i class="CR-imprt" onclick="Files.downloadFilecabinet(this)" name="deleteElm"></i>'):row+='<i class="CR-imprt" onclick="Files.downloadFilecabinet(this)" name="deleteElm"></i>',void 0==isAnySignConfigured&&Zohosign.getEsignConfigurations(),null==Files.isEsignatureAllowedFlag&&Files.isEsignatureAllowed(),0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(row+='<div id="moreOptionsParDiv" class="dropdown ZPCusDrs  FL  ML10"><div data-hover="dropdown" data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+='<ul class="dropdown-menu ZPCmn-Arrow top gray" id="moreFileOperations">',row+='<li onclick="Files.copyUrl(this)"><i class="IC-copy"></i>'+ZPI18N.getString("zp.copyUrl")+"</li>",1===data.fileAcknowledge&&(row+='<li class="divider"></li><li onclick="FilesLite.Reports.ackFileDetailReport.getAcknowledgementDetails(\''+data.fileID+'\');"><i class="IC-user-tick"></i>'+ZPI18N.getString("zp.viewack")+"</li>"),-1!=Zohosign.zsignEtxns.indexOf(fileExtn)&&null!=data.fileActions.isEditPerm&&void 0!=data.fileActions.isEditPerm&&!0===data.fileActions.isEditPerm&&(Files.isEsignatureAllowedFlag&&isZSConfig&&(row+='<li class="divider"></li>'),void 0!=data.signTemplateId&&isZSConfig?Files.isEsignatureAllowedFlag&&(row+='<li id= "reqSign" onclick="Zohosign.loadActionData(\''+data.signTemplateId+"');Zohosign.loadSignTemplate('"+data.fileID+"','"+data.signTemplateId+"','"+data.fileLocationID+"','"+Files.splitToString(data.fileOrgStructure.Entity)+"','"+Files.splitToString(data.fileOrgStructure.Unit)+"','"+Files.splitToString(data.fileOrgStructure.Division)+"','"+Files.splitToString(data.fileOrgStructure.Department)+'\')"><i class="IC-zohosign"></i>'+ZPI18N.getString("zp.requestsignature")+"</li>",row+='<li id= "editSign" onclick=Zohosign.openCreateDocumentModal("hr",\''+data.fileID+"');Zohosign.loadActionData('"+data.signTemplateId+'\',true);><i class="CR-edit"></i>'+ZPI18N.getString("zp.editsignature")+"</li>"):Files.isEsignatureAllowedFlag&&isZSConfig&&(row+='<li id= "setupSign"  dept=\''+Files.splitToString(data.fileOrgStructure.Department)+"' ent='"+Files.splitToString(data.fileOrgStructure.Entity)+"' unit ='"+Files.splitToString(data.fileOrgStructure.Unit)+"' divi='"+Files.splitToString(data.fileOrgStructure.Division)+"' locID='"+data.fileLocationID+"' onclick=Zohosign.openCreateDocumentModal(\"hr\",'"+data.fileID+'\')><i class="IC-setting-l"></i>'+ZPI18N.getString("zp.setupsignature")+"</li>"),data.hasOwnProperty("compAgreementID")&&(2==loginUserRoleCheck&&ZPSetupCommon.isEmpty(data.fileLocationID)||0==loginUserRoleCheck||1==loginUserRoleCheck)&&(Files.isEsignatureAllowedFlag||(row+='<li class="divider"></li>'),row+='<li id= "viewcompReport" class="CP" onclick="Files.showViewReport(\''+data.fileID+'\')"><i class="IC-chart"></i>'+ZPI18N.getString("zp.viewreport")+"</li>")),row+="</ul></div>"),row+='</div><div class="FR">',null!=data.fileActions.isEditPerm&&void 0!=data.fileActions.isEditPerm&&!0===data.fileActions.isEditPerm&&(void 0==data.signTemplateId?row+="<i onclick=\"Files.showAddcompanyFile('edit',this, 'uploadmode')\" class=\"CR-edit\"></i>":row+='<i onclick="Files.showAddcompanyFile(\'edit\',this)" class="CR-edit"></i>'),null!=data.fileActions.isDeletePerm&&void 0!=data.fileActions.isDeletePerm&&!0===data.fileActions.isDeletePerm&&(row+='<i onclick="Files.deleteRecConfirm(this, \'action_confirm_btn\');" class="CR-delete"></i>'),row+="</div>",row+="</ul>",(row=$(row)).data("ldata",data),pageId.append(row)}-1!==Layout.Page.hash.indexOf("createAgreement")&&Files.Esign.getAgreementsListPage("company")}else-1!==Layout.Page.hash.indexOf("view-categoryId")?Files.orgSubCatViewData.Org[1]=!1:-1!==Layout.Page.hash.indexOf("companyfile/listview")&&(Files.orgListViewData.Org[1]=!1),-1!==Layout.Page.hash.indexOf("view-categoryId")&&0===Files.orgSubCatViewData.Org[0]?(Layout.Page.container.find("#compfiles_list").nextAll(".ZPListingUL").remove(),Layout.Page.container.find("#catListCFDiv").find("#compfiles_list").hide(),0==Layout.Page.container.find(".ZPBoxListing").find("ul").length&&Files.showNodataMsg("subCatView")):-1!==Layout.Page.hash.indexOf("companyfile/listview")&&0===Files.orgListViewData.Org[0]&&Files.showNodataMsg("company_filesmsg"),Layout.Page.container.find("#company_multiselDel").hide(),Layout.Page.container.find("#addCompany_Bar").show(),Files.closeCopyMoveDiv()}Object.keys(Files.orgListViewData.Org[2]).length>0&&-1!==Layout.Page.hash.indexOf("view-categoryId")?(0==Files.orgSubCatViewData.Org[0]?Files.orgSubCatViewData.Org[0]=25:Files.orgSubCatViewData.Org[0]=Files.orgSubCatViewData.Org[0]+24,Files.orgListViewData.Org[2].start=Files.orgSubCatViewData.Org[0]):-1!==Layout.Page.hash.indexOf("#files/companyfile/listview")&&Object.keys(Files.orgListViewData.Org[2]).length>0?(Files.orgListViewData.Org[0]=Files.orgListViewData.Org[0]+25,Files.orgListViewData.Org[2].start=Files.orgListViewData.Org[0]):-1!==Layout.Page.hash.indexOf("#files/companyfile/listview")&&(0==Files.orgListViewData.Org[0]?Files.orgListViewData.Org[0]=25:Files.orgListViewData.Org[0]=Files.orgListViewData.Org[0]+24),-1!==Layout.Page.hash.indexOf("#files/companyfile/listview")&&!0===Files.orgListViewData.Org[3]&&(Files.orgListViewData.Org[3]=!1)},splitToString:function(param){var dataArray="";if(void 0!=param)for(key in Object.keys(param))key>0&&(dataArray+=","),dataArray+=Object.keys(param)[key];return dataArray},showAddPersonalFile:function(mode,obj){if(Files.isIprestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")),Layout.Page.container.find("#add_personalfileDiv").modal("hide");else if(Files.isGeorestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")),Layout.Page.container.find("#add_personalfileDiv").modal("hide");else if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.showAddPersonalFile(mode,obj)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.showAddPersonalFile(mode,obj)}),$(document).on("click",function(e){Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||-1!==$(e.target).attr("class").indexOf("btn")||-1!==$(e.target).attr("class").indexOf("IC")||(pageLoaded=!0,Files.showAddPersonalFile(mode,obj))})}else{isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(Files.Geo.position.coords.latitude,Files.Geo.position.coords.longitude);var pageId=Layout.Page.container.find("#add_personalfileDiv");pageId.modal("show"),pageId.find("#add_personalfileInnerDivLoading").html(ZPeople.LOADING_HTML),pageId.find("#add_personalfileDiv").find("#add_personalfileInnerDiv").hide(),pageId.find(".modal-footer").show(),pageId.find(".ERR").remove();ZPeople.isZPNewUI();if("edit"===mode){pageId.find("#uploadfile").val(""),pageId.find("#addFile_header").html(ZPI18N.getString("zp.editpersonalfiles"));var editData=$(obj).parent().parent().parent().data().ldata;pageId.find("#pers_fileField").hide(),pageId.find("#fileName").val(ZPeople.decodeTxt(editData.fileName)),"null"!==editData.fileDesc&&void 0!==editData.fileDesc&&pageId.find("#fileDesc").val(ZPeople.decodeTxt(editData.fileDesc)),pageId.find("#filetype").val(editData.fileType),pageId.find("#editFileId").val(editData.fileID)}else pageId.find("#addFile_header").html(ZPI18N.getString("zp.addpersonalfiles")),pageId.find("#beforeUpload").removeClass("DN"),pageId.find("#afterUpload").addClass("DN"),pageId.find("#pers_fileField").show(),pageId.find("#fileName").val(""),pageId.find("#fileDesc").val(""),pageId.find("#uploadfile").val(""),pageId.find("#editFileId").val("0");pageId.find("#add_personalfileInnerDivLoading").hide(),pageId.find("#add_personalfileInnerDiv").show(),Files.uploadMode="",Files.uploadedDocObj={}}Layout.Page.container.find(".select2-input").css("width","100%")},updatePersonalFile:function(form,foundLocation,latitude,longitude){if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&!foundLocation){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.updatePersonalFile(form,pageLoaded,position.coords.latitude,position.coords.longitude)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.updatePersonalFile(form,pageLoaded,"","")}),isBlocked||$(document).on("click",function(e){Files.Geo.positionBlocked(),-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||!ZPSetupCommon.isEmpty($(e.target).attr("class"))&&$(e.target).text()===ZPI18N.getString("zp.submit")||(pageLoaded=!0,Files.updatePersonalFile(form,pageLoaded,"",""))})}else{Layout.Page.container.find(".ERR").remove();var pageId=Layout.Page.container.find("#add_personalfileDiv"),uploadFile=pageId.find("#uploadfile").val(),fileName=pageId.find("#fileName").val(),fileDesc=pageId.find("#fileDesc").val(),errflag=!1;Layout.Page.container.find("#formBizcpn").val(csrfToken);var editFileId=pageId.find("#editFileId").val();if(""==fileName)fileName=(fileName=pageId.find("#uploadfile").val()).substr(0,fileName.indexOf("."));-1!=fileName.indexOf(",")&&(fileName=fileName.replace(/,/g,"_")),-1!=fileName.indexOf(",")&&(fileName=fileName.replace(/,/g,"")),""==fileName&&(pageId.find("#fileName").after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.emptyfilename")+"</strong></span>"),errflag=!0),"0"!=editFileId&&""==uploadFile&&pageId.find("#beforeUpload").is(":visible")&&(pageId.find("#drop_file").parent().parent().after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.choosefile")+"</strong></span>"),errflag=!0),""==uploadFile&&"0"==editFileId&&"cloudUpload"!=Files.uploadMode&&(pageId.find("#drop_file").parent().parent().after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.choosefile")+"</strong></span>"),errflag=!0),fileDesc.length>250&&(pageId.find("#fileDesc").parent().append('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.desclength")+"</strong></span>"),errflag=!0),-1==fileName.indexOf("<")&&-1==fileName.indexOf(">")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.filename")))),errflag=!0),-1==fileDesc.indexOf("<")&&-1==fileDesc.indexOf(">")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.description")))),errflag=!0);var fileObj=Layout.Page.container.find("#add_personalfileDiv").find("#uploadfile")[0].files[0],maxFileSizeforAdd=1e6*maxFileSize.split("MB")[0];if(fileObj&&fileObj.size>maxFileSizeforAdd&&(errflag=!0,ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesizelimit",[maxFileSize]))),fileObj&&"localUpload"==Files.uploadMode&&"-1"==Files.udsParams.fileId&&(errflag=!0,ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.fileuploaderror"))),errflag)return!1;if(Files.isIprestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));else{var formData=new FormData;formData.append("methodName","addFile"),formData.append("conreqcsr",csrfToken),formData.append("fileName",fileName),formData.append("fileDesc",fileDesc),formData.append("fileType","2"),formData.append("editFileId",editFileId),formData.append("uploadMode",Files.uploadMode),fileObj&&"localUpload"==Files.uploadMode&&(formData.append("importFileId",Files.udsParams.fileId),formData.append("fileVersion",Files.udsParams.fileVersion)),isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(formData.append("latitude",Files.Geo.position.coords.latitude),formData.append("longitude",Files.Geo.position.coords.longitude)),"cloudUpload"==Files.uploadMode&&formData.append("cloudUploadDoc",JSON.stringify(Files.uploadedDocObj)),"localUpload"!==Files.uploadMode&&void 0!==Layout.Page.container.find("#add_personalfileDiv").find("#uploadfile")[0].files[0]&&formData.append("uploadfile",Layout.Page.container.find("#add_personalfileDiv").find("#uploadfile")[0].files[0]),Layout.Page.hash.indexOf("selfservice/user/files")>-1&&formData.append("ERECNO",SelfService.getUserId()),pageId.find("#add_personalfileInnerDivLoading").show(),pageId.find("#add_personalfileInnerDivLoading").html(ZPeople.LOADING_HTML),pageId.find("#add_personalfileInnerDiv").hide(),pageId.find(".modal-footer").hide(),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){Layout.Page.container.find("#add_personalfileDiv").modal("hide"),Files.resetVals(),-1!==Layout.Page.hash.indexOf("selfservice/user/files")?Files.SelfService.fetchSelfServiceFiles():(Layout.Page.container.find("#persfilesSS").html(""),Files.getPersonalfilesListing("addPersonal","Sucess",editFileId))},error:function(req){var errResponse=req.responseJSON[1];8103!==req.status&&8101!==req.status&&500!==req.status||ZPeople.Message.showFailureMsg(errResponse.msg),pageId.modal("hide")}})}}},fetchPersonalFilesListing:function(){Files.persListViewData.Pers[0]=0,Files.persListViewData.Pers[1]=!0,Layout.Page.container.find("#pers_fileListing").html(""),Files.getPersonalfilesListing()},getPersonalfilesListing:function(mode,msg,editFileId){if(Layout.Page.container.find("#pers_fileListing").attr("scroll","enabled"),"addPersonal"==mode&&(Layout.Page.container.find("#pers_fileListing").scrollTop(0),Layout.Page.container.find("#pers_fileListing").html(""),Files.persListViewData.Pers[0]=0,Files.persListViewData.Pers[1]=!0),"Sucess"==msg)"0"!==editFileId?ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatefile")):ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.addfile"));else if("Error"==msg)return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.invalidmsg"));if(Layout.Page.container.find("#pers_fileListing").find(".ZPListingUL").length<=0&&(Layout.Page.container.find("#noPersonalFilesDiv").show(),Layout.Page.container.find("#pers_fileListing").hide(),Layout.Page.container.find("#noPersonalFilesDiv").html(ZPeople.LOADING_HTML)),$("body").popover({selector:"[data-popover].popHover",trigger:"click hover",placement:"right",delay:{show:50,hide:50}}),Layout.Page.container.find("#personal_multiselDel").hide(),Layout.Page.container.find("#addPersonal_Bar").show(),!0===Files.persListViewData.Pers[1]||Object.keys(Files.persListViewData.Pers[2]).length>0){var params={};params=Object.keys(Files.persListViewData.Pers[2]).length>0||"fromSearch"===mode?Files.persListViewData.Pers[2]:{methodName:"getAllFiles",fileType:2,start:Files.persListViewData.Pers[0],conreqcsr:csrfToken},Files.searchFileBreadcrumbs(),Layout.Page.container.find("#persfiles_list").find(".ZPListingUL").show();var pageLoaded=!1,isBlocked=!1;isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position?(navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.foundLocation(position,4,params,null)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.foundLocation("block",4,params,null)}),$(document).on("click",function(e){Files.Geo.positionBlocked(),!isBlocked&&Layout.Page.hash.indexOf("/listview")>-1&&!pageLoaded&&$(e.target).text()!==ZPI18N.getString("zp.search")&&void 0!==$(e.target)&&-1===$(e.target).attr("class").indexOf("select2")&&(pageLoaded=!0,Files.foundLocation("",4,params,null))})):(Files.setLatitudeLongitude(params),Files.foundLocation("",4,params,null))}},getPersonalFilesCallBack:function(resultData,params){var respObj;if(resultData.hasOwnProperty("fail")){Files.isGeorestricted=!0;var row='<ul class="ZPListingUL" id="geo_err">';row+='<li class="text-center">'+ZPI18N.getString("zp.georestricted")+"</li></ul>";var pageId=Layout.Page.container.find("#noPersonalFilesDiv");return pageId.html(row),pageId.show(),Layout.Page.container.find("#noPersonalFilesDiv").hide(),void ZPeople.Message.showFailureMsg(resultData.fail)}void 0!==(respObj=resultData[1])&&!0===Files.persListViewData.Pers[1]?Files.personalfilelistView(respObj):(Files.isIprestrict(resultData),Files.personalfilelistView())},personalfilelistView:function(resultData,mode){Layout.Page.container.find("#noPersonalFilesDiv").find("#zp_page_loading").remove();var pageId=Layout.Page.container.find("#pers_fileListing");if(Files.isIprestricted){Layout.Page.container.find("#noPersonalFilesDiv").hide(),Layout.Page.container.find("#persfiles_list").show();row='<ul class="ZPListingUL">';row+='<li class="text-center">'+ZPI18N.getString("zp.iprestricted")+"</li></ul>",pageId.append(row)}else{var parseObj=resultData,dataLimit=parseObj.length;if(parseObj.length<25?(Files.persListViewData.Pers[1]=!1,dataLimit=parseObj.length):(Files.persListViewData.Pers[1]=!0,dataLimit=parseObj.length-1),Files.isGeorestricted=!1,parseObj.length>0){void 0!=pageId.find("ul#geo_err")&&pageId.find("ul#geo_err").length>0&&pageId.find("tr#geo_err").remove(),ZPeople.FireScroll.reset(),Layout.Page.container.find("#pers_fileListing").show(),Layout.Page.container.find("#noPersonalFilesDiv").hide();for(var i=0;i<dataLimit;i++){var data=parseObj[i];Files.isIprestricted=!1;var fileExtn=data.filePath,filePath=data.filePath,fileName=data.fileName;-1!=fileExtn.lastIndexOf(".")&&(fileExtn=(fileExtn=fileExtn.substr(fileExtn.lastIndexOf(".")+1,fileExtn.length)).toLowerCase()),ZPeople.IsNumeric(filePath)&&(fileExtn=data.fileExtn.toLowerCase()),-1!=filePath.indexOf("_signed")&&filePath.indexOf("_signed")>=-1&&-1!=filePath.lastIndexOf(".")&&(fileExtn=(fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length)).toLowerCase());var row='<ul class="ZPListingUL" id="persfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'"  uploadFileExtn = "'+fileExtn+'">';row+='<li class="check"><div class="checkbox"><input type="checkbox" id="'+data.fileID+'" onclick="Files.checkParticularfiles(this,\'personal\')"><label class="MT3"></label></div></li>',row+='<li class="name" id="persfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'" onclick="Layout.Page.pageContWrapper.parent().prepend(Files.constructPreview(\'persfileTr_'+data.fileID+"','files'));Files.viewFile(this,'personal')\">",row+="pdf"===fileExtn?'<i class="IC-pdf"></i>':"xls"===fileExtn||"xlsx"===fileExtn||"xlsm"===fileExtn||"sxc"===fileExtn||"ods"===fileExtn||"csv"===fileExtn||"tsv"===fileExtn?'<i class="IC-xls-new"></i>':"htm"===fileExtn||"html"===fileExtn?'<i class="IC-code"></i>':"doc"===fileExtn||"docx"===fileExtn||"sxw"===fileExtn||"odt"===fileExtn||"rtf"===fileExtn?'<i class="IC-doc"></i>':"ppt"===fileExtn||"pps"===fileExtn||"odp"===fileExtn||"sxi"===fileExtn||"pptx"===fileExtn?'<i class="IC-ppt"></i>':"zip"===fileExtn?'<i class="IC-zip"></i>':"mp3"===fileExtn||"mp4a"===fileExtn||"wav"===fileExtn?'<i class="IC-mp3"></i>':"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn?'<i class="IC-jpg"></i>':'<i class="IC-doc"></i>',row+='<span href="javascript:;" title="'+ZPeople.escapeHtml(ZPeople.decodeTxt(fileName))+'" class="ellip">'+ZPeople.escapeHtml(ZPeople.decodeTxt(fileName))+"</span></li>",row+="<li>"+data.fileModifiedDate+"</li>",row+="<li>"+data.fileSize+"</li>",row+='<li class="actions">',row+='<div id="action_confirm_btn" class="DN"><button class="btn btn-default btn-sm FR" onclick="Files.cancelDelRecConfirm(this);">'+ZPI18N.getString("zp.cancel")+"</button><button  class=\"btn btn-danger btn-sm FR MR10\" onclick=\"Files.deleteFiles('single','"+data.fileID+"',this,'personal')\">"+ZPI18N.getString("zp.confirm")+"</button></div>",row+='<div class="FL">',""===data.fileDesc||void 0===data.fileDesc?row+="<i data-popover='true' data-html='true' data-placement='bottom' data-content='<span class=\"DB S13\"><b>"+ZPI18N.getString("zp.reports.createdby")+' : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileCreateByName)+"</p></span>' class='CR-info popHover'></i>":row+="<i data-popover='true' data-html='true' data-placement='bottom' data-content='<span class=\"DB S13\"><b>"+ZPI18N.getString("zp.reports.createdby")+' : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileCreateByName)+'</p></span><br> <span class="DB S13"><b>Description : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileDesc)+"</p></span>' class='CR-info popHover'></i>",row+='<i class="CR-imprt" onclick="Files.downloadFilecabinet(this)" name="deleteElm"></i>',row+='</div><div class="FR">',null!=data.fileActions.isEditPerm&&void 0!=data.fileActions.isEditPerm&&!0===data.fileActions.isEditPerm&&(row+='<i onclick="Files.showAddPersonalFile(\'edit\',this)" class="CR-edit"></i>'),null!=data.fileActions.isDeletePerm&&void 0!=data.fileActions.isDeletePerm&&!0===data.fileActions.isDeletePerm&&(row+='<i onclick="Files.deleteRecConfirm(this, \'action_confirm_btn\');" class="CR-delete"></i>'),row+="</div>",row+="</ul>",(row=$(row)).data("ldata",data),pageId.append(row)}}else Files.showNodataMsg("personal_filesmsg")}0==Files.persListViewData.Pers[0]?Files.persListViewData.Pers[0]=25:Files.persListViewData.Pers[0]=Files.persListViewData.Pers[0]+24+1},registerPersonalFilesFilter:function(){Layout.Page.container.find("#show_hide_personalfile_filter, #show_hide_personalfile_filter .ZPRdlt").each(function(){this.onclick=function(){if(Files.isIprestricted||Files.isGeorestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));else if(!Files.isIprestricted&&!Files.isGeorestricted){Layout.Page.container.find("#personalfilterdiv").is(":visible")?(Layout.Page.container.find("#show_hide_personalfile_filter").toggleClass("sel"),$("#page-wrapper").removeClass("Nbar2F").addClass("Nbar5")):($("#page-wrapper").addClass("Nbar2F").removeClass("NBar5"),Layout.Page.container.find("#show_hide_personalfile_filter").toggleClass("sel")),Layout.Page.container.find("#search_PFextn").select2();var extnVal=Layout.Page.container.find("#search_PFextn").val();null==extnVal||void 0==extnVal||""==extnVal?Layout.Page.container.find("#search_PFextn").select2("val","-1"):Layout.Page.container.find("#search_PFextn").select2("val",extnVal),Files.openClsFilter("#show_hide_personalfile_filter"),Layout.Page.container.find("#personalfilterdiv").slideToggle(100)}}}),Layout.Page.container.find("#show_hide_personalfile_filter").on("mouseover",function(){Layout.Page.container.find(this).find(".IC-filter").toggleClass("sel")}),Layout.Page.container.find("#show_hide_personalfile_filter").on("mouseout",function(){Layout.Page.container.find(this).find(".IC-filter").toggleClass("sel")})},hidePersonalFileFilter:function(){Layout.Page.container.find("#personalfilterdiv").hide(),Layout.Page.container.find("#show_hide_personalfile_filter").removeClass("sel"),Files.searchFileBreadcrumbs()},searchPersonalFiles:function(mapPos,mode){Files.persListViewData.Pers[1]=!0,Files.persListViewData.Pers[0]=0,Layout.Page.container.find("#pers_fileListing").html("");var errflag=!1,fromDate="";fromDate=""!=Layout.Page.container.find("#personalsearch_fromDate").val()&&void 0!=Layout.Page.container.find("#personalsearch_fromDate").val()&&0!=Layout.Page.container.find("#personalsearch_fromDate").val()?Layout.Page.container.find("#personalsearch_fromDate").val():"-1";var toDate="";toDate=""!=Layout.Page.container.find("#personalsearch_toDate").val()&&void 0!=Layout.Page.container.find("#personalsearch_toDate").val()&&0!=Layout.Page.container.find("#personalsearch_toDate").val()?Layout.Page.container.find("#personalsearch_toDate").val():"-1";var searchFileName="";""!=Layout.Page.container.find("#search_PFname").val()&&void 0!=Layout.Page.container.find("#search_PFname").val()&&(searchFileName=Layout.Page.container.find("#search_PFname").val());var searchFileExtn="";if(""!=Layout.Page.container.find("#search_PFextn").val()&&void 0!=Layout.Page.container.find("#search_PFextn").val()){var fileExtnType=Layout.Page.container.find("#search_PFextn").val();searchFileExtn=Files.fetchFileExtn(fileExtnType)}if(!1===Files.searchWithDateValidation(Layout.Page.container.find("#personalsearch_fromDate").val(),Layout.Page.container.find("#personalsearch_toDate").val())&&(errflag=!0),errflag)return!1;if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&ZPSetupCommon.isEmpty(mode)){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.searchPersonalFiles(position,"search")},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.searchPersonalFiles("","search")}),isBlocked||$(document).on("click",function(e){Files.Geo.positionBlocked(),-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||!ZPSetupCommon.isEmpty($(e.target).attr("class"))&&$(e.target).text()===ZPI18N.getString("zp.search")||(pageLoaded=!0,Files.searchPersonalFiles("","search"))})}else Files.persListViewData.Pers[2]={methodName:"getAllFiles",start:Files.persListViewData.Pers[0],fileType:2,conreqcsr:csrfToken,searchFileName:searchFileName,searchFileExtn:searchFileExtn},null!=fromDate&&void 0!==fromDate&&""!==fromDate&&"-1"!==fromDate&&(Files.persListViewData.Pers[2].fromDate=fromDate),null!=toDate&&void 0!==toDate&&""!==toDate&&"-1"!==toDate&&(Files.persListViewData.Pers[2].toDate=toDate),Files.setLatitudeLongitude(Files.orgListViewData.Org[2]),Files.searchFileBreadcrumbs(),Files.getPersonalfilesListing(),Files.hidePersonalFileFilter()},constructCopyMoveFilesDropDown:function(isFile,op_type){Files.closeCopyMoveDiv();var dropdown="";if("copy"===op_type?dropdown='<div class="two-col"><div class="ZPmvHdr">'+ZPI18N.getString("zp.files.copyfile")+'<i class="IC-cls" onclick="Files.closeCopyMoveDiv()"></i></div>':"move"===op_type&&(dropdown='<div class="two-col"><div class="ZPmvHdr">'+ZPI18N.getString("zp.files.movefile")+'<i class="IC-cls" onclick="Files.closeCopyMoveDiv()"></i></div>'),dropdown+='<form role="form">',-1!==Layout.Page.hash.indexOf("#files/companyfile")&&"0"===Layout.Page.container.find("#companyFileViewType").val()||-1!==Layout.Page.hash.indexOf("#files/hrdocuments/listview")?("copy"===op_type?dropdown+='<div class="form-group" ><label>'+ZPI18N.getString("zp.copyto")+"</label>":"move"===op_type&&(dropdown+='<div class="form-group" ><label>'+ZPI18N.getString("zp.moveto")+"</label>"),dropdown+='<div><select id="cm_comp" onchange="Files.copyMoveCompntDiv()" placeholder="select"></select></div>',dropdown+='</div><div class="form-group DNI" id="cm_compname" ></div>'):(dropdown+='<div class="form-group zp_fm" label="role_ID" id="cm_roleId"><label>'+ZPI18N.getString("zp.role")+"</label>",dropdown+='<div><select id="cm_role" placeholder="select"></select></div>',dropdown+="</div>"),dropdown+='</form><div class="ZPmvFtr"><span class="btn btn-primary" onclick="Files.copyMoveFiles(\''+isFile+"','"+op_type+"')\">"+ZPI18N.getString("zp.submit")+"</span></div></div>","copy"===op_type?""===Layout.Page.container.find("#copy_container").html()&&Layout.Page.container.find("#copy_container").append(dropdown):"move"===op_type&&""===Layout.Page.container.find("#move_container").html()&&Layout.Page.container.find("#move_container").append(dropdown),"company"===isFile||"hrdocuments"===isFile||"hrmergedocuments"===isFile){"company"===isFile?Layout.Page.container.find("#company_multiselDel").addClass("open"):Layout.Page.container.find("#doc_multiselDel").addClass("open");var opt='<option value="Location">'+ZPI18N.getString("zp.location")+"</option>";opt+='<option value="Department">'+ZPeople.orgStructureDispNameMap.department+"</option>",isOrgStructureEnabled&&null!=ZPeople.orgStructureTagMap&&(!0===ZPeople.orgStructureTagMap.entity&&(opt+='<option value="Entity">'+ZPeople.orgStructureDispNameMap.entity+"</option>"),!0===ZPeople.orgStructureTagMap.unit&&(opt+='<option value="Business_unit">'+ZPeople.orgStructureDispNameMap.unit+"</option>"),!0===ZPeople.orgStructureTagMap.division&&(opt+='<option value="Division">'+ZPeople.orgStructureDispNameMap.division+"</option>")),Layout.Page.container.find("#cm_comp").select2(),Layout.Page.container.find("#cm_comp").append(opt),Layout.Page.container.find("#cm_comp").prepend('<option value="0"> -Select- </option>'),Layout.Page.container.find("#cm_comp").select2("val","0")}else Layout.Page.container.find("#hr_multiselDel").addClass("open"),Layout.Page.container.find("#cm_role").select2(),Files.getRoleList("cm_role"),Layout.Page.container.find("#cm_role").prepend('<option value="-1">-Select-</option>'),Layout.Page.container.find("#cm_role").select2("val","-1")},copyMoveCompntDiv:function(){var componentType=Layout.Page.container.find("#cm_comp").val(),div="";Layout.Page.container.find("#cm_compval").parent().remove(),Layout.Page.container.find("#cm_compname label").remove();var option='<option value="0"> -Select- </option>';if(componentType.indexOf("Location")>-1)div="<label>"+ZPI18N.getString("zp.location")+'</label><div><select id="cm_compval" placeholder="select"></select></div>',null!=Files.locationName_Arr&&$.each(Files.locationName_Arr,function(id,data){option+='<option value="'+id+'">'+data+"</option>"});else if(componentType.indexOf("Department")>-1)div="<label>"+ZPeople.orgStructureDispNameMap.department+'</label><div><select id="cm_compval" placeholder="select"></select></div>',null!=Files.sharingOpts.Department&&$.each(Files.sharingOpts.Department,function(id,data){option+='<option value="'+id+'">'+data+"</option>"});else if(componentType.indexOf("Entity")>-1)div="<label>"+ZPeople.orgStructureDispNameMap.entity+'</label><div><select id="cm_compval" placeholder="select"></select></div>',null!=Files.sharingOpts.Entity&&$.each(Files.sharingOpts.Entity,function(id,data){option+='<option value="'+id+'">'+data+"</option>"});else if(componentType.indexOf("Business_unit")>-1)div="<label>"+ZPeople.orgStructureDispNameMap.unit+'</label><div><select id="cm_compval" placeholder="select"></select></div>',null!=Files.sharingOpts.Unit&&$.each(Files.sharingOpts.Unit,function(id,data){option+='<option value="'+id+'">'+data+"</option>"});else{if(!(componentType.indexOf("Division")>-1))return void Layout.Page.container.find("#cm_compname").addClass("DNI");div="<label>"+ZPeople.orgStructureDispNameMap.division+'</label><div><select id="cm_compval" placeholder="select"></select></div>',null!=Files.sharingOpts.Division&&$.each(Files.sharingOpts.Division,function(id,data){option+='<option value="'+id+'">'+data+"</option>"})}Layout.Page.container.find("#cm_compname").append(div),Layout.Page.container.find("#cm_compval").append(option),Layout.Page.container.find("#cm_compval").select2(),Layout.Page.container.find("#cm_compval").select2("val","0"),Layout.Page.container.find("#cm_compname").removeClass("DNI")},copyMoveFiles:function(isFile,op_type){if(0==loginUserRoleCheck||1==loginUserRoleCheck){Layout.Page.container.find(".ERR").remove();var files="",fileType=1;"company"===isFile?(files=Layout.Page.container.find("#comp_fileListing").find("input[type='checkbox']:checked"),fileType=1):"hrdocuments"===isFile||"hrmergedocuments"===isFile?(files=Layout.Page.container.find("#hrdoc_list").find("input[type='checkbox']:checked"),"hrdocuments"===isFile?fileType=4:"hrmergedocuments"===isFile&&(fileType=5)):(files=Layout.Page.container.find("#hr_allfileList").find("input[type='checkbox']:checked"),fileType=0);var isempty=!1,component="",componentValue="",role="",roleId="";"company"===isFile||"hrdocuments"===isFile||"hrmergedocuments"===isFile?null!==(component=Layout.Page.container.find("#cm_comp").val())&&void 0!==component&&""!==component&&"0"!==component?null!=(componentValue=Layout.Page.container.find("#cm_compval").val())&&void 0!=componentValue&&""!=componentValue&&"0"!=componentValue||(Layout.Page.container.find("#s2id_cm_compval").parent().append('<span class="ERR" errmsg="mailids" id="selectlocation_err" >'+ZPI18N.getString("zp.nocomponenterror",new Array(op_type))+"</span>"),isempty=!0):(Layout.Page.container.find("#s2id_cm_comp").parent().append('<span class="ERR" errmsg="mailids" id="selectlocation_err" >'+ZPI18N.getString("zp.nocomponenterror",new Array(op_type))+"</span>"),isempty=!0):(roleId="",null!==(role=Layout.Page.container.find("#cm_role").val())&&void 0!==role&&""!==role&&"-1"!==role?roleId=role.toString():(Layout.Page.container.find("#s2id_cm_role").parent().append('<span class="ERR" errmsg="mailids" id="hrrole_err">'+ZPI18N.getString("zp.selrole")+"</span>"),isempty=!0));var formData=new FormData;if(formData.append("methodName","copyMoveFiles"),formData.append("conreqcsr",csrfToken),formData.append("fileType",fileType),formData.append("fileOperationMode",op_type),!isempty){if(null!==op_type&&void 0!==op_type&&"copy"===op_type){var cmcompJson={},cmRoleJson={},comp_fileId=[],role_FileId=[];if(1===fileType){for(var i=0;i<files.length;i++){var filedata=Layout.Page.container.find("#compfileTr_"+$(files[i]).attr("id")).data().ldata;null!==componentValue&&void 0!==componentValue&&""!==componentValue&&(component.indexOf("Location")>=-1?$.inArray(componentValue,filedata.fileLocationID)<=-1&&comp_fileId.push($(files[i]).attr("id")):component.indexOf("Entity")>=-1?void 0!==filedata.fileOrgStructure.Entity&&null!==filedata.fileOrgStructure.Entity&&""!==filedata.fileOrgStructure.Entity&&$.inArray(componentValue,filedata.fileOrgStructure.Entity)<=-1&&comp_fileId.push($(files[i]).attr("id")):component.indexOf("Department")>=-1?void 0!==filedata.fileOrgStructure.Department&&null!==filedata.fileOrgStructure.Department&&""!==filedata.fileOrgStructure.Department&&$.inArray(componentValue,filedata.fileOrgStructure.Department)<=-1&&comp_fileId.push($(files[i]).attr("id")):component.indexOf("Business_unit")>=-1?void 0!==filedata.fileOrgStructure.Unit&&null!==filedata.fileOrgStructure.Unit&&""!==filedata.fileOrgStructure.Unit&&$.inArray(componentValue,filedata.fileOrgStructure.Unit)<=-1&&comp_fileId.push($(files[i]).attr("id")):component.indexOf("Division")>=-1&&void 0!==filedata.fileOrgStructure.Division&&null!==filedata.fileOrgStructure.Division&&""!==filedata.fileOrgStructure.Division&&$.inArray(componentValue,filedata.fileOrgStructure.Division)<=-1&&comp_fileId.push($(files[i]).attr("id")))}null!==componentValue&&void 0!==componentValue&&""!==componentValue&&null!==comp_fileId&&void 0!==comp_fileId&&comp_fileId.length>0&&(cmcompJson[componentValue]=comp_fileId)}if(0===fileType){for(i=0;i<files.length;i++){filedata=Layout.Page.container.find("#hrfileTr_"+$(files[i]).attr("id")).data().ldata;""!==roleId&&void 0!==roleId&&null!==roleId&&$.inArray(roleId,filedata.fileRoleID)<=-1&&role_FileId.push($(files[i]).attr("id"))}null!==roleId&&void 0!==roleId&&""!==roleId&&null!==role_FileId&&void 0!==role_FileId&&role_FileId.length>0&&(cmRoleJson[roleId]=role_FileId)}null!==cmcompJson&&void 0!==cmcompJson&&Object.keys(cmcompJson).length>0&&formData.append("cmcompJson",JSON.stringify(cmcompJson)),null!==cmRoleJson&&void 0!==cmRoleJson&&Object.keys(cmRoleJson).length>0&&formData.append("copyRoleJson",JSON.stringify(cmRoleJson))}if(null!==op_type&&void 0!==op_type&&"move"===op_type){var fileID="";for(i=0;i<files.length;i++)fileID+=$(files[i]).attr("id"),i!==files.length-1&&(fileID+=",");formData.append("moveFileId",fileID),null!==componentValue&&void 0!==componentValue&&""!==componentValue&&formData.append("moveCompVal",componentValue),null!==roleId&&void 0!==roleId&&""!==roleId&&formData.append("roleId",roleId)}null!==component&&void 0!==component&&""!==component&&formData.append("component",component),formData.append("fileSortByType",Files.orgListViewData.Org[4]),formData.append("isFileSortDesc",Files.orgListViewData.Org[5]),isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(formData.append("latitude",Files.Geo.position.coords.latitude),formData.append("longitude",Files.Geo.position.coords.longitude)),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){Files.resetVals(),"company"===isFile?Files.getCompanyfilesListing("addCompany",op_type):"hrdocuments"===isFile||"hrmergedocuments"===isFile?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.movefile")),Layout.Page.container.find("#doc_multiselDel").removeClass("open"),Layout.Page.container.find("#hrdoc_list ul[fileid="+fileID+"]").remove(),Layout.Page.container.find("#doc_multiselDel").removeClass("open"),Layout.Page.container.find("#doc_multiselDel").hide(),Layout.Page.container.find("#doc_HeaderBar").show()):Files.getHrfilesListing("add",void 0,op_type)},error:function(req){var errResponse=req.responseJSON[1];8103!==req.status&&8101!==req.status&&500!==req.status||ZPeople.Message.showFailureMsg(errResponse.msg)}})}}},closeCopyMoveDiv:function(){Layout.Page.container.find("#move_container").html(""),Layout.Page.container.find("#copy_container").html(""),Layout.Page.container.find("#company_multiselDel").removeClass("open"),"files_hrdocuments_listview"==Layout.Page.urlmode&&Layout.Page.container.find("#doc_multiselDel").removeClass("open")},exportFiles:function(mode){$("#confirmationPopup").modal("show"),$("#confirmationPopup").modal({backdrop:"static",keyboard:!1}),$("#textConfirmationPopupHeader").html("").append(ZPI18N.getString("zp.zpalert")),$("#textConfirmationPopupBody").html("").append(ZPI18N.getString("zp.files.exportfilespopup")),$("#confirmConfirmationPopup").html("").append(ZPI18N.getString("zp.confirm")),$("#confirmConfirmationPopup").off("click"),$("#cancelConfirmationPopup").off("click"),$("#confirmConfirmationPopup").on("click",function(event){if(0==loginUserRoleCheck||1==loginUserRoleCheck){var url="",formData=new FormData;"companyfiles"==mode?(url=Files.ACTION.URL,formData.append("methodName","exportFilesAsZip"),formData.append("fileType",1),formData.append("start",1)):"hrfiles"==mode?(url=Files.ACTION.URL,formData.append("methodName","exportFilesAsZip"),formData.append("fileType",0),formData.append("start",1)):"agreements"==mode?(url="/adobeSignActions.zp",formData.append("action","exportAgreementsAsZip"),formData.append("startInd",1)):"envelopes"==mode?(url="/docuSignActions.zp",formData.append("action","exportEnvelopesAsZip"),formData.append("startInd",1)):"documents"==mode&&(url="/zpzsign/exportDocumentsAsZip",formData.append("action","exportDocumentsAsZip"),formData.append("startInd",1)),formData.append("conreqcsr",csrfToken),formData.append("limit",200),$.ajax({url:url,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.exportfilesnotify"))},error:function(req){var errResponse=req.responseJSON[1];8103!==req.status&&8101!==req.status&&500!==req.status||ZPeople.Message.showFailureMsg(errResponse.msg)}})}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"))})},initEmployeeSearch:function(){var ele="",searchMode="",selectedUserDiv="",defaultValue={};-1!=loginUserRoleCheck&&-1!==Layout.Page.hash.indexOf("/all")&&("0"===Layout.Page.container.find("#fileTypeData").val()?(ele="search_ActEmp",searchMode="FILES_ACTIVEEMP",selectedUserDiv="actEmpPhoto_Files"):"5"===Layout.Page.container.find("#fileTypeData").val()?(ele="search_InactEmp",searchMode="FILES_INACTIVEEMP",selectedUserDiv="inactEmpPhoto_Files"):"8"===Layout.Page.container.find("#fileTypeData").val()&&(ele="search_LogDisEmp",searchMode="FILES_LOGINDISABLEDEMP",selectedUserDiv="logdisEmpPhoto_Files"),defaultValue={id:"-1",text:ZPI18N.getString("zp.allemployees"),html:ZPI18N.getString("zp.allemployees")}),isreportingTo&&-1!==Layout.Page.hash.indexOf("/sub")&&("7"===Layout.Page.container.find("#fileTypeData").val()?(ele="search_AllSubEmp",searchMode="FILES_ALLSUBEMP",selectedUserDiv="allsubEmpPhoto_Files"):("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&(ele="search_SubEmp",searchMode="FILES_SUBEMP",selectedUserDiv="subEmpPhoto_Files"),defaultValue={id:"-1",text:ZPI18N.getString("zp.allsubordinates"),html:ZPI18N.getString("zp.allsubordinates")});var json={id:Layout.Page.container.find("#"+ele).attr("id"),inpFormat:"select",initCurrentUser:!1,type:1,limit:10,searchMode:searchMode,searchType:"emp",initialSelection:defaultValue,defaultOption:defaultValue};"FILES_ACTIVEEMP"===searchMode&&-1!==Layout.Page.hash.indexOf("/all")?(ZPComponents.Search.reset(json,!0),ZPComponents.Search.create(json)):"FILES_INACTIVEEMP"===searchMode&&-1!==Layout.Page.hash.indexOf("/all")?(ZPComponents.Search.reset(json,!0),ZPComponents.Search.create(json)):"FILES_LOGINDISABLEDEMP"===searchMode&&-1!==Layout.Page.hash.indexOf("/all")?(ZPComponents.Search.reset(json,!0),ZPComponents.Search.create(json)):"FILES_SUBEMP"===searchMode&&-1!==Layout.Page.hash.indexOf("/sub")?(ZPComponents.Search.reset(json,!0),ZPComponents.Search.create(json)):"FILES_ALLSUBEMP"===searchMode&&-1!==Layout.Page.hash.indexOf("/sub")&&(ZPComponents.Search.reset(json,!0),ZPComponents.Search.create(json));var selectedVal=Layout.Page.container.find("#"+ele).val();"undefined"!==selectedVal&&"null"!==selectedVal&&"-1"!==selectedVal||(Layout.Page.container.find("#"+selectedUserDiv).hide(),-1===Layout.Page.hash.indexOf("/all")||null!==Files.empListViewData.All[2].employeeId&&""!==Files.empListViewData.All[2].employeeId&&"-1"!==Files.empListViewData.All[2].employeeId&&void 0!==Files.empListViewData.All[2].employeeId?-1===Layout.Page.hash.indexOf("/sub")||null!==Files.empListViewData.Sub[2].employeeId&&void 0!=Files.empListViewData.Sub[2].employeeId&&""!==Files.empListViewData.Sub[2].employeeId&&"-1"!==Files.empListViewData.Sub[2].employeeId||("7"===Layout.Page.container.find("#fileTypeData").val()?(Files.allsubEmpSearchObj=[],-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/list")&&Files.isAllSubEmpInit[0]?Files.isAllSubEmpInit[0]=!1:-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/cat")&&Files.isAllSubEmpInit[1]?Files.isAllSubEmpInit[1]=!1:-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/view")&&Files.isAllSubEmpInit[2]&&(Files.isAllSubEmpInit[2]=!1)):("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&(Files.subEmpSearchObj=[],-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/list")&&Files.isSubEmpInit[0]?Files.isSubEmpInit[0]=!1:-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/cat")&&Files.isSubEmpInit[1]?Files.isSubEmpInit[1]=!1:-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/view")&&Files.isSubEmpInit[2]&&(Files.isSubEmpInit[2]=!1))):"0"===Layout.Page.container.find("#fileTypeData").val()?Files.actEmpSearchObj=[]:"5"===Layout.Page.container.find("#fileTypeData").val()?(Files.inactEmpSearchObj=[],-1!==Layout.Page.hash.indexOf("#files/hrfile/all/list")&&Files.isInactEmpInit[0]?Files.isInactEmpInit[0]=!1:-1!==Layout.Page.hash.indexOf("#files/hrfile/all/cat")&&Files.isInactEmpInit[1]?Files.isInactEmpInit[1]=!1:-1!==Layout.Page.hash.indexOf("#files/hrfile/all/view")&&Files.isInactEmpInit[2]&&(Files.isInactEmpInit[2]=!1)):"8"===Layout.Page.container.find("#fileTypeData").val()&&(Files.logDisEmpSearchObj=[],-1!==Layout.Page.hash.indexOf("#files/hrfile/all/list")&&Files.isLogDisEmpInit[0]?Files.isLogDisEmpInit[0]=!1:-1!==Layout.Page.hash.indexOf("#files/hrfile/all/cat")&&Files.isLogDisEmpInit[1]?Files.isLogDisEmpInit[1]=!1:-1!==Layout.Page.hash.indexOf("#files/hrfile/all/view")&&Files.isLogDisEmpInit[2]&&(Files.isLogDisEmpInit[2]=!1)))},searchEmployee:function(){var ele="",selectedUserDiv="";-1!=loginUserRoleCheck&&-1!==Layout.Page.hash.indexOf("/all")&&("0"===Layout.Page.container.find("#fileTypeData").val()?(ele="search_ActEmp",selectedUserDiv="actEmpPhoto_Files"):"5"===Layout.Page.container.find("#fileTypeData").val()?(ele="search_InactEmp",selectedUserDiv="inactEmpPhoto_Files"):"8"===Layout.Page.container.find("#fileTypeData").val()&&(ele="search_LogDisEmp",selectedUserDiv="logdisEmpPhoto_Files")),isreportingTo&&-1!==Layout.Page.hash.indexOf("/sub")&&("7"===Layout.Page.container.find("#fileTypeData").val()?(ele="search_AllSubEmp",selectedUserDiv="allsubEmpPhoto_Files"):("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&(ele="search_SubEmp",selectedUserDiv="subEmpPhoto_Files"));Layout.Page.container.find("#"+ele).attr("id");var selectedVal=Layout.Page.container.find("#"+ele).val();if("undefined"===selectedVal||"null"===selectedVal||"-1"===selectedVal)Layout.Page.container.find("#"+selectedUserDiv).hide(),-1!==Layout.Page.hash.indexOf("/all")?"0"===Layout.Page.container.find("#fileTypeData").val()?Files.actEmpSearchObj=[]:"5"===Layout.Page.container.find("#fileTypeData").val()?Files.inactEmpSearchObj=[]:"8"===Layout.Page.container.find("#fileTypeData").val()&&(Files.logDisEmpSearchObj=[]):-1!==Layout.Page.hash.indexOf("/sub")&&("7"===Layout.Page.container.find("#fileTypeData").val()?Files.allsubEmpSearchObj=[]:("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&(Files.subEmpSearchObj=[]));else{Layout.Page.container.find("#"+selectedUserDiv).show();var empObj=ZP.getUserDetailsById(selectedVal);Layout.Page.container.find("#"+selectedUserDiv).attr("src",empObj.photo),-1!==Layout.Page.hash.indexOf("/all")?"0"===Layout.Page.container.find("#fileTypeData").val()?(Files.actEmpSearchObj[0]=selectedVal,Files.actEmpSearchObj[1]=empObj.photo,Files.actEmpSearchObj[2]=ZPeople.escapeHtml(empObj.name)):"5"===Layout.Page.container.find("#fileTypeData").val()?(Files.inactEmpSearchObj[0]=selectedVal,Files.inactEmpSearchObj[1]=empObj.photo,Files.inactEmpSearchObj[2]=ZPeople.escapeHtml(empObj.name)):"8"===Layout.Page.container.find("#fileTypeData").val()&&(Files.logDisEmpSearchObj[0]=selectedVal,Files.logDisEmpSearchObj[1]=empObj.photo,Files.logDisEmpSearchObj[2]=ZPeople.escapeHtml(empObj.name)):-1!==Layout.Page.hash.indexOf("/sub")&&("7"===Layout.Page.container.find("#fileTypeData").val()?(Files.allsubEmpSearchObj[0]=selectedVal,Files.allsubEmpSearchObj[1]=empObj.photo,Files.allsubEmpSearchObj[2]=ZPeople.escapeHtml(empObj.name)):("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&(Files.subEmpSearchObj[0]=selectedVal,Files.subEmpSearchObj[1]=empObj.photo,Files.subEmpSearchObj[2]=ZPeople.escapeHtml(empObj.name)))}-1!==Layout.Page.hash.indexOf("/all")&&"0"===Layout.Page.container.find("#fileTypeData").val()&&Files.isActEmpSearch||-1!==Layout.Page.hash.indexOf("/all")&&"5"===Layout.Page.container.find("#fileTypeData").val()&&Files.isInactEmpSearch||-1!==Layout.Page.hash.indexOf("/all")&&"8"===Layout.Page.container.find("#fileTypeData").val()&&Files.isLogDisEmpSearch||-1!==Layout.Page.hash.indexOf("/sub")&&("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&Files.isSubEmpSearch||-1!==Layout.Page.hash.indexOf("/sub")&&"7"===Layout.Page.container.find("#fileTypeData").val()&&Files.isAllSubEmpSearch?-1!==Layout.Page.hash.indexOf("listview")?Files.searchHrFiles():Files.searchCatView("0"):-1!==Layout.Page.hash.indexOf("/all")?"0"!==Layout.Page.container.find("#fileTypeData").val()||Files.isActEmpSearch?"5"!==Layout.Page.container.find("#fileTypeData").val()||Files.isInactEmpSearch?"8"!==Layout.Page.container.find("#fileTypeData").val()||Files.isLogDisEmpSearch||(Files.isLogDisEmpSearch=!0):Files.isInactEmpSearch=!0:Files.isActEmpSearch=!0:-1!==Layout.Page.hash.indexOf("/sub")&&("7"!==Layout.Page.container.find("#fileTypeData").val()||Files.isAllSubEmpSearch?"6"!==Layout.Page.container.find("#fileTypeData").val()&&(null===hasAllReporteePerm||void 0===hasAllReporteePerm||!1!==hasAllReporteePerm)||Files.isSubEmpSearch||(Files.isSubEmpSearch=!0):Files.isAllSubEmpSearch=!0)},constructActiveEmp:function(mode,result,optStr){"activeEmp"!==mode&&"filteremp"!==mode||$.each(Files.employeeData.empList,function(sindex,data1){(Layout.Page.hash.indexOf("selfservice/user/files")>-1&&(ZPSetupCommon.isEmpty(SelfService.getUserId())||!ZPSetupCommon.isEmpty(SelfService.getUserId())&&data1.ERECNO==SelfService.getUserId())||-1===Layout.Page.hash.indexOf("selfservice/user/files"))&&(result+='<option value="'+data1.ERECNO+'">'+data1.EMPNAME+",&nbsp;"+data1.EMPID+"</option>")}),optStr.html(result)},constructInactiveEmp:function(result,optStr){null!==Files.inactiveEmployeeData&&($.each(Files.inactiveEmployeeData.empList,function(index,data1){(Layout.Page.hash.indexOf("selfservice/user/files")>-1&&(ZPSetupCommon.isEmpty(SelfService.getUserId())||!ZPSetupCommon.isEmpty(SelfService.getUserId())&&data1.ERECNO==SelfService.getUserId())||-1===Layout.Page.hash.indexOf("selfservice/user/files"))&&(result+='<option value="'+data1.ERECNO+'">'+data1.EMPNAME+",&nbsp;"+data1.EMPID+"</option>")}),optStr.html(result))},constructemp_addrev:function(mode,isadd,editedid,value){"filteremp"===mode?Layout.Page.container.find("#search_ActEmpFiles").html(""):"filterInactiveEmp"===mode?Layout.Page.container.find("#search_inactiveEmp").html(""):Layout.Page.container.find("#select_employeelisting").html("");var optStr="";optStr="filteremp"===mode?Layout.Page.container.find("#search_ActEmpFiles"):"filterInactiveEmp"===mode?Layout.Page.container.find("#search_inactiveEmp"):Layout.Page.hash.indexOf("selfservice/user/files")>-1?Layout.Page.parentContainer.parent().find("#select_employeelisting"):Layout.Page.container.find("#import_hrfileDiv").hasClass("in")?Layout.Page.container.find("#import_hrfileDiv").find("#select_employeelisting"):Layout.Page.container.find("#select_employeelisting");var result=Layout.Page.hash.indexOf("selfservice/user/files")>-1?"":'<option value="-Select-">-'+ZPI18N.getString("zp.select")+"-</option>",emp_mode="";"inactive_emp"===mode||"filterInactiveEmp"===mode?emp_mode="GET_MODULE_INACTIVE_EMP_LIST":"activeEmp"===mode&&(emp_mode="GET_MODULE_EMP_LIST");var params={mode:emp_mode,module:"File_Data",conreqcsr:csrfToken};"activeEmp"!==mode&&"filteremp"!==mode||(null===Files.employeeData?$.post("/commonAction.zp",params,function(resultData){Files.employeeData=resultData,Files.constructActiveEmp(mode,result,optStr)}):null!==Files.employeeData&&Files.constructActiveEmp(mode,result,optStr),void 0!==value&&""!==value&&null!==value&&value!==ZPI18N.getString("zp.select")?Layout.Page.container.find("#search_ActEmpFiles").select2("val",value):Layout.Page.container.find("#search_ActEmpFiles").select2({placeholder:ZPI18N.getString("zp.select")})),"filterInactiveEmp"===mode&&(null===Files.inactiveEmployeeData?$.post("/commonAction.zp",params,function(resultData){Files.inactiveEmployeeData=resultData,Files.constructInactiveEmp(result,optStr)}):null!==Files.inactiveEmployeeData&&Files.constructInactiveEmp(result,optStr),void 0!==value&&""!==value&&null!==value&&value!==ZPI18N.getString("zp.select")?Layout.Page.container.find("#search_inactiveEmp").select2("val",value):Layout.Page.container.find("#search_inactiveEmp").select2({placeholder:ZPI18N.getString("zp.select")}))},foundLocation:function(position,action,params,mode,newCat,fileExtn,fileDownload,fileName,filePath){var isCompanyHBOrgTemp=Layout.Page.hash.indexOf("#files/hrdocuments/listview")>-1&&"hr"==mode&&"docx"==fileExtn;switch(action){case Files.ACTION.VIEW_FILE:if(isCompanyHBOrgTemp||null==isPreviewAllowed||void 0==isPreviewAllowed||1!=isPreviewAllowed||"Forms"!=mode)if(isCompanyHBOrgTemp||"hrdocPdf"==mode||!Files.isFilesPreviewEnabled(mode)||"pdf"!=fileExtn&&"tif"!=fileExtn&&"docx"!=fileExtn&&"doc"!=fileExtn&&"rtf"!=fileExtn&&"odt"!=fileExtn&&"rtf"!==fileExtn&&"pptx"!=fileExtn&&"ppt"!=fileExtn)if(params.indexOf("methodName")>-1||isCompanyHBOrgTemp)null!==Files.Geo.position&&"true"===doNeedToGetLocation&&"block"!==Files.Geo.position&&(params+="&latitude="+Files.Geo.position.coords.latitude,params+="&longitude="+Files.Geo.position.coords.longitude),ZPeople.Request.send(Files.ACTION.URL,params,this.viewFileCallBack,mode);else{var url="/viewFile?fileId="+params;null!==Files.Geo.position&&"true"===doNeedToGetLocation&&"block"!==Files.Geo.position&&(url+="&latitude="+Files.Geo.position.coords.latitude+"&longitude="+Files.Geo.position.coords.longitude),Layout.Page.container.find("#zp_page_loading").remove(),"pdf"!==fileExtn&&"PDF"!==fileExtn||(url=Files.constructPreviewUrl(mode,params,fileExtn)),Files.setUrlIframeToViewFile(url,mode,fileExtn)}else url=Files.constructPreviewUrl(mode,params,fileExtn),Files.setUrlIframeToViewFile(url,mode);else"jpg"==fileExtn||"jpeg"==fileExtn||"gif"==fileExtn||"png"==fileExtn?(delete params.fileId,url=ZPForm.constructDownloadLink(params),Files.setUrlIframeToViewFile(url,mode,fileExtn)):(url=Files.constructPreviewUrl(mode,params,fileExtn),Files.setUrlIframeToViewFile(url,mode));break;case Files.ACTION.HR_FILE:if(-1!==Layout.Page.hash.indexOf("hrfile/all")?(params.fileSortByType=Files.empListViewData.All[4],params.isFileSortDesc=Files.empListViewData.All[5]):-1!==Layout.Page.hash.indexOf("hrfile/sub")?(params.fileSortByType=Files.empListViewData.Sub[4],params.isFileSortDesc=Files.empListViewData.Sub[5]):-1!==Layout.Page.hash.indexOf("hrfile/my")?(params.fileSortByType=Files.empListViewData.My[4],params.isFileSortDesc=Files.empListViewData.My[5]):-1!==Layout.Page.hash.indexOf("hrfile/role")&&(params.fileSortByType=Files.empListViewData.Role[4],params.isFileSortDesc=Files.empListViewData.Role[5]),("#files/fileView/hrfileslistview"===Layout.Page.hash||"#files/hrfile/all/listview"===Layout.Page.hash)&&!1!==Files.empListViewData.All[1]||"#selfservice/user/files"===Layout.Page.hash||"#files/hrfile/sub/listview"===Layout.Page.hash&&!1!==Files.empListViewData.Sub[1]||"#files/hrfile/my/listview"===Layout.Page.hash&&!1!==Files.empListViewData.My[1]||"#files/hrfile/role/listview"===Layout.Page.hash&&!1!==Files.empListViewData.Role[1])Files.setLatitudeLongitude(params),ZPeople.Request.send(Files.ACTION.URL,params,Files.getHrFilesCallBack,{newCat:newCat,mode:mode},Files.getHrFilesCallBack);else if("#files/hrfile/all/catview"===Layout.Page.hash&&!1!==Files.empCatViewData.All[1]||"#files/hrfile/sub/catview"===Layout.Page.hash&&!1!==Files.empCatViewData.Sub[1]||"#files/hrfile/my/catview"===Layout.Page.hash&&!1!==Files.empCatViewData.My[1]||"#files/hrfile/role/catview"===Layout.Page.hash&&!1!==Files.empCatViewData.Role[1]){Files.setLatitudeLongitude(params),null!=(method=params.methodName)&&void 0!=method&&""!=method&&"getGridView"==method&&ZPeople.Request.send(Files.ACTION.URL,params,Files.getCatViewCallBack,{newCat:newCat,mode:mode})}else(-1===Layout.Page.hash.indexOf("/all/view-categoryId")||0!==Files.empSubCatViewData.All[0]&&!1===Files.empSubCatViewData.All[1])&&(-1===Layout.Page.hash.indexOf("/sub/view-categoryId")||0!==Files.empSubCatViewData.Sub[0]&&!1===Files.empSubCatViewData.Sub[1])&&(-1===Layout.Page.hash.indexOf("/my/view-categoryId")||0!==Files.empSubCatViewData.My[0]&&!1===Files.empSubCatViewData.My[1])&&(-1===Layout.Page.hash.indexOf("/role/view-categoryId")||0!==Files.empSubCatViewData.Role[0]&&!1===Files.empSubCatViewData.Role[1])||(Files.setLatitudeLongitude(params),ZPeople.Request.send(Files.ACTION.URL,params,Files.getHrFilesCallBack,{newCat:newCat,mode:mode},Files.getHrFilesCallBack));break;case Files.ACTION.COMPANY_FILE:if(params.fileSortByType=Files.orgListViewData.Org[4],params.isFileSortDesc=Files.orgListViewData.Org[5],-1!==Layout.Page.hash.indexOf("companyfile/listview")&&!1!==Files.orgListViewData.Org[1])Files.setLatitudeLongitude(params),ZPeople.Request.send(Files.ACTION.URL,params,Files.getCompanyFilesCallBack,newCat,Files.getCompanyFilesCallBack);else if(-1!==Layout.Page.hash.indexOf("companyfile/catview")&&!1!==Files.orgCatViewData.Org[1]){var method;Files.setLatitudeLongitude(params),null!=(method=params.methodName)&&void 0!=method&&""!=method&&"getGridView"==method&&ZPeople.Request.send(Files.ACTION.URL,params,Files.getCatViewCallBack,newCat)}else-1==Layout.Page.hash.indexOf("view-categoryId")||0!==Files.orgSubCatViewData.Org[0]&&!1===Files.orgSubCatViewData.Org[1]||(Files.setLatitudeLongitude(params),ZPeople.Request.send(Files.ACTION.URL,params,Files.getCompanyFilesCallBack,newCat,Files.getCompanyFilesCallBack));break;case Files.ACTION.PERSONAL_FILE:params.fileSortByType=Files.persListViewData.Pers[4],params.isFileSortDesc=Files.persListViewData.Pers[5],Files.setLatitudeLongitude(params),ZPeople.Request.send(Files.ACTION.URL,params,Files.getPersonalFilesCallBack)}},setLatitudeLongitude:function(params){isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(params.latitude=Files.Geo.position.coords.latitude,params.longitude=Files.Geo.position.coords.longitude)},registerFileInput:function(){Layout.Page.container.find("input[type=file]").on("change",function(){var filename=$(this).val();filename.length>40&&(filename=filename.slice(0,40)+" ..."),$(this).siblings("span#drop_file").html(ZPeople.escapeHtml(filename))})},showNodataMsg:function(mode){if("company_filesmsg"===mode)Layout.Page.container.find("#nocompanyFilesDiv").show(),Layout.Page.container.find("#compfiles_list").find(".ZPListingUL").hide(),Layout.Page.container.find("#comp_fileListing").hide(),ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nofiles"),Layout.Page.container.find("#nocompanyFilesDiv")),Layout.Page.container.find("#compfiles_list").removeClass("expand");else if("hr_filesmsg"===mode)Layout.Page.container.find("#nohrFilesDiv").show(),Layout.Page.container.find("#hr_fileListing").find(".ZPListingUL").hide(),Layout.Page.container.find("#hr_allfileList").hide(),ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nofiles"),Layout.Page.container.find("#nohrFilesDiv")),Layout.Page.container.find("#hr_fileListing").removeClass("expand");else if("personal_filesmsg"===mode)Layout.Page.container.find("#noPersonalFilesDiv").show(),Layout.Page.container.find("#pers_fileListing").hide(),ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nofiles"),Layout.Page.container.find("#noPersonalFilesDiv"));else if("subCatView"===mode)Layout.Page.container.find("#EmpListHFDiv").hide(),-1!==Layout.Page.hash.indexOf("companyfile")?(Layout.Page.container.find("#comp_fileListing").show(),ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nodatafound"),Layout.Page.container.find("#comp_fileListing"))):(Layout.Page.container.find("#hr_allfileList").show(),ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nodatafound"),Layout.Page.container.find("#hr_allfileList")));else if("gridView"===mode){var pageId="";-1!==Layout.Page.hash.indexOf("companyfile")&&(pageId=Layout.Page.container.find("#companyFilesCategoryView").find(".ZPListingHdr")),-1!==Layout.Page.hash.indexOf("hrfile")&&(-1!==Layout.Page.hash.indexOf("/all/catview")?pageId=Layout.Page.container.find("#allFilesCategoryView").find(".ZPListingHdr"):-1!==Layout.Page.hash.indexOf("/sub/catview")?pageId=Layout.Page.container.find("#subFilesCategoryView").find(".ZPListingHdr"):-1!==Layout.Page.hash.indexOf("/my/catview")?pageId=Layout.Page.container.find("#myFilesCategoryView").find(".ZPListingHdr"):-1!==Layout.Page.hash.indexOf("/role/catview")&&(pageId=Layout.Page.container.find("#roleFilesCategoryView").find(".ZPListingHdr"))),Layout.Page.container.find("#loadingGridDiv").html(""),Layout.Page.container.find("#loadingGridDiv").show();var search='<div class="ZPListingHdr">'+pageId.html()+"</div>";Layout.Page.container.find("#loadingGridDiv").append(search),ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nodatafound"),Layout.Page.container.find("#loadingGridDiv"))}else"reports"===mode?(Layout.Page.container.find("#pf_reportListing").find("#zp_page_loading").remove(),ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nodatafound"),Layout.Page.container.find("#pf_reportListing"))):"hrdocuments"===mode?(Layout.Page.container.find("#hrdoc_norecords .ctable").remove(),Zohosign.newuinohrDocrecords(ZPI18N.getString("zp.nodatafound"))):"acknowledgment"===mode?(Layout.Page.container.find("#ack_reportListing").find("#zp_page_loading").remove(),ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nodatafound"),Layout.Page.container.find("#ack_reportListing"))):"ackDetails"===mode&&(Layout.Page.container.find("#ackDetailListing").find("#zp_page_loading").remove(),ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nodatafound"),Layout.Page.container.find("#ackDetailListing")))},clearErrmsg:function(id){$("#"+id).remove()},getRoleList:function(id){var roleOpt="";if(null===Files.roleData||0===Object.keys(Files.roleData).length){var roleList=JSON.stringify(rolesJson),roles=JSON.parse(roleList);Files.roleData=roles}for(var roleKeys=Object.keys(Files.roleData),role=0;role<roleKeys.length;role++){var roleId=roleKeys[role];roleOpt+="<option value='"+roleId+"'>"+Files.roleData[roleId]+"</option>"}Layout.Page.container.find("#"+id).append(roleOpt)},fetchCategoryForSetting:function(){if(Layout.Page.hash.indexOf("files/settings/categorylistview")>-1&&isSettingsAdmin)if($("#zp-tlevel-files-settings").remove(),0===Files.settings.Cat[0]&&Layout.Page.container.find("#settings_catList").html(ZPeople.LOADING_HTML),isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&!0===Files.settings.Cat[1]){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.fetchCategoryForSetting("catlistview",position.coords.latitude,position.coords.longitude,!0)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.fetchCategoryForSetting("catlistview","","",!0)}),$(document).on("click",function(){Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||(pageLoaded=!0,Files.fetchCategoryForSetting("catlistview","","",!0))})}else if(void 0!==Files.settingsCurrentCatId&&null!==Files.settingsCurrentCatId&&""!==Files.settingsCurrentCatId&&-1!==Files.settingsCurrentCatId)Files.settingsSubCatView(Files.settingsCurrentCatId);else if(!0===Files.settings.Cat[1]){var params={methodName:"getCategoriesForSettings",conreqcsr:csrfToken,start:Files.settings.Cat[0]};Files.setLatitudeLongitude(params),$.post(Files.ACTION.URL,params,function(resultData){resultData.hasOwnProperty("fail")?Files.isGeorestricted=!0:Files.isGeorestricted=!1,void 0!==resultData[1].subCategory?(resultData[1].subCategory.length>0&&ZPeople.FireScroll.reset(),Files.categoryListView(resultData[1].subCategory),resultData[1].length<51?Files.settings.Cat[1]=!1:Files.settings.Cat[1]=!0,Files.settings.Cat[0]+=51):Files.isIprestrict(resultData)})}},initSubCatSettings:function(catId){Layout.Page.container.find("#settings_subcatList").html(""),Files.settings.SubCat[0]=0,Files.settingsSubCatView(catId)},settingsSubCatView:function(catId){if(Layout.Page.hash.indexOf("files/settings/categorylistview")>-1&&isSettingsAdmin){Layout.Page.container.find("#settings_subcatList").show(),Layout.Page.container.find("#settings_catList").hide();var pageId=Layout.Page.container.find("#settings_subcatList"),row="";if(0===Files.settings.SubCat[0])if(Files.isIprestricted||Files.isGeorestricted)if(Files.isGeorestricted&&-1!==Layout.Page.hash.indexOf("files/settings/categorylistview"))Layout.Page.container.find("div.Scrcont").prepend('<table class="table table-hover MB0I" id="category_listerrmsg"><tbody><tr class="ZPLRow"><td colspan="8" align="center">Operation restricted in this Geographical range</td></tr></tbody></table>');else{var row1='<li class="text-center">'+ZPI18N.getString("zp.iprestricted")+"</li>";pageId.append(row1)}else row+='<li class="col-sm-3" onclick="Files.showAddFileCategory()">',row+='<div id="add_Cat" class="dtable"><div class="fileType add"><i class="CR-add"></i></div>',row+='<div class="fileDtl"><b>'+ZPI18N.getString("zp.addcat")+"</b></div>",row+="</div></li>";var params={methodName:"getCategoriesForSettings",conreqcsr:csrfToken,parentCatId:catId,start:Files.settings.SubCat[0]};Files.settingsCurrentCatId=catId,Files.setLatitudeLongitude(params),$.post(Files.ACTION.URL,params,function(resultData){if(resultData.hasOwnProperty("fail"))ZPeople.Message.showFailureMsg(resultData.fail);else if(resultData[1].hasOwnProperty("fail"))ZPeople.Message.showWarningMsg(resultData[1].fail);else{if(void 0!==resultData[1]){resultData[1].subCategory.length>0&&ZPeople.FireScroll.reset();var Breadcrumbs={};$.each(resultData[1].catTree,function(key,value){Breadcrumbs[value.CatID]=value.CatName}),Files.settingsCatPath=Breadcrumbs;var start=0;0!=Files.settings.SubCat[0]&&(start=1);for(var catArr=resultData[1].subCategory,i=start;i<catArr.length;i++){var catData=catArr[i],key=catData.CatID,value=catData.CatName;row+='<li id="catLi_'+key+'">',row+='<div  id="cat_'+key+'" class="dtable"><div class="fileType" onclick="Files.initSubCatSettings(\''+key+"')\">",row+='<i class="CR-fld"><i class="path1"><i class="path2"></i></i></i></div>',value="General"===value||"general"===value?ZPI18N.getString("zp.general"):value,row+='<div class="fileDtl" onclick="Files.initSubCatSettings(\''+key+"')\"><b>"+value+"</b></div>","General"!==value&&"general"!==value&&value!==ZPI18N.getString("zp.general")&&(row+='</div><div id="catAction_'+key+'" class="actions">',row+="<span><i onclick=\"Files.showeditCategory('"+key+'\')" class="CR-edit ">',row+="</i><i onclick=\"Files.deleteCategory('"+key+'\',this)" class="CR-delete"></i></span>'),row+="</div>",row+="</li>"}resultData[1].length<51?Files.settings.SubCat[1]=!1:Files.settings.SubCat[1]=!0,Files.settings.SubCat[0]+=51,Files.constructBreadcrumbs()}pageId.append(row)}})}},getCatSettingsOnScroll:function(){void 0!==Files.settingsCurrentCatId&&null!==Files.settingsCurrentCatId&&""!==Files.settingsCurrentCatId&&-1!==Files.settingsCurrentCatId?Files.settingsSubCatView(Files.settingsCurrentCatId):Files.fetchCategoryForSetting()},categoryListView:function(data){Layout.Page.container.find("#zp_page_loading").remove(),Layout.Page.container.find("#settings_subcatList").hide(),Layout.Page.container.find("#settings_catList").show();var pageId=Layout.Page.container.find("#settings_catList");Layout.Page.container.find("table#category_listerrmsg").remove();var row="";if(0===Files.settings.Cat[0])if(Files.isIprestricted||Files.isGeorestricted)if(Files.isGeorestricted&&-1!==Layout.Page.hash.indexOf("files/settings/categorylistview"))Layout.Page.container.find("div.Scrcont").prepend('<table class="table table-hover MB0I" id="category_listerrmsg"><tbody><tr class="ZPLRow"><td colspan="8" align="center">Operation restricted in this Geographical range</td></tr></tbody></table>');else{var row1='<li class="text-center">'+ZPI18N.getString("zp.iprestricted")+"</li>";pageId.append(row1)}else row+='<li class="col-sm-3">',row+='<div id="add_Cat" class="dtable" onclick="Files.showAddFileCategory()"><div class="fileType add"><i class="CR-add"></i></div>',row+='<div class="fileDtl"><b>'+ZPI18N.getString("zp.addcat")+"</b></div>",row+="</div></li>";var start=0;0!=Files.settings.Cat[0]&&(start=1);for(var i=start;i<data.length;i++){var catData=data[i],key=catData.CatID,value=catData.CatName;row+='<li id="catLi_'+key+'">',row+='<div  id="cat_'+key+'" class="dtable"><div class="fileType" onclick="Files.initSubCatSettings(\''+key+"')\">",row+='<i class="CR-fld"><i class="path1"><i class="path2"></i></i></i></div>',row+='<div class="fileDtl" onclick="Files.initSubCatSettings(\''+key+"')\"><b>"+(value="General"===value||"general"===value?ZPI18N.getString("zp.general"):value)+"</b></div>","General"!==value&&"general"!==value&&value!==ZPI18N.getString("zp.general")&&(row+='</div><div id="catAction_'+key+'" class="actions">',row+="<span><i onclick=\"Files.showeditCategory('"+key+'\')" class="CR-edit ">',row+="</i><i onclick=\"Files.deleteCategory('"+key+'\',this)" class="CR-delete"></i></span>'),row+="</div>",row+="</li>"}row=$(row),pageId.append(row)},fetchPlaceUnderCatList:function(){var obj=Layout.Page.container.find("#settings_addcatplaceunder,#settings_editcatplaceunder");obj.select2(),obj.html(""),null!=Files.newCategoryList&&void 0!=Files.newCategoryList&&0!=Object.keys(Files.newCategoryList).length||Files.getcatList();for(var opt="",catArr=Object.keys(Files.newCategoryList),i=catArr.length-1;i>=0;i--){var key=catArr[i];opt+='<option value="'+key+'">'+Files.newCategoryList[key]+"</option>"}obj.append('<option value="-1">/</option>'),obj.append(opt)},showAddFileCategory:function(mode){Layout.Page.container.find("#newsettingCategory").val(""),"cancel"===mode?(Layout.Page.container.find(".ERR").remove(),Layout.Page.container.find("#addCategoryDiv").removeClass("active")):(Files.fetchPlaceUnderCatList(),Layout.Page.container.find("#addCategoryDiv").addClass("active"),void 0!==Files.settingsCurrentCatId&&null!==Files.settingsCurrentCatId&&""!==Files.settingsCurrentCatId?Layout.Page.container.find("#settings_addcatplaceunder").select2("val",Files.settingsCurrentCatId):Layout.Page.container.find("#settings_addcatplaceunder").select2("val","-1"),$("#newsettingCategory").trigger("focus"))},showeditCategory:function(id,mode){if("cancel"===mode)Layout.Page.container.find(".ERR").remove(),Layout.Page.container.find("#editCategoryDiv").removeClass("active");else{Layout.Page.container.find("#editCategoryDiv").addClass("active"),Layout.Page.container.find("#saveEditCat").off("click").on("click",function(){Files.updateCategory("edit","",id)});var cat_Name=$("#cat_"+id).text();$("#editsettingCategory").val(cat_Name),$("#editsettingCategory").keyup(function(event){13===event.keyCode&&Files.updateCategory("edit","",id)})}},canceleditCategory:function(id){Layout.Page.container.find("#editCat_"+id).next("#errormsg").hide(),Layout.Page.container.find("#catAction_"+id).parent().removeClass("sel")},constructCatForSettings:function(catID,parentCatId,catName,mode){var row="";"add"===mode&&(row+='<li id="catLi_'+catID+'">'),row+='<div  id="cat_'+catID+'" class="dtable"><div class="fileType" onclick="Files.initSubCatSettings(\''+catID+"')\">",row+='<i class="CR-fld"><i class="path1"><i class="path2"></i></i></i></div>',value="General"===catName||"general"===catName?ZPI18N.getString("zp.general"):catName,row+='<div class="fileDtl" onclick="Files.initSubCatSettings(\''+catID+"')\"><b>"+catName+"</b></div>","General"!==catName&&"general"!==catName&&catName!==ZPI18N.getString("zp.general")&&(row+='</div><div id="catAction_'+catID+'" class="actions">',row+="<span><i onclick=\"Files.showeditCategory('"+catID+'\')" class="CR-edit ">',row+="</i><i onclick=\"Files.deleteCategory('"+catID+'\',this)" class="CR-delete"></i></span>'),row+="</div>","add"===mode&&(row+="</li>"),Number(parentCatId)===Number(Files.settingsCurrentCatId)?"add"===mode&&(null!==Files.settingsCurrentCatId&&void 0!==Files.settingsCurrentCatId&&-1!==Files.settingsCurrentCatId?Layout.Page.container.find("#settings_subcatList li:eq(0)").after(row):Layout.Page.container.find("#settings_catList li:eq(0)").after(row)):"edit"===mode&&Layout.Page.container.find("#catLi_"+catID).html(row)},updateCategory:function(mode,isFile,id,foundLocation,latitude,longitude){if(isSettingsAdmin){Layout.Page.container.find(".ERR").remove();var foundLoc=!1,isBlocked=!1;if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&!foundLocation)navigator.geolocation.getCurrentPosition(function(position){foundLoc=!0,Files.Geo.position=position,Files.updateCategory(mode,isFile,id,foundLoc,position.coords.latitude,position.coords.longitude)},function(){isBlocked=!0,foundLoc=!0,Files.Geo.positionBlocked(),Files.updateCategory(mode,isFile,id,foundLoc,"","")}),isBlocked||$(document).on("click",function(e){if(Files.Geo.positionBlocked(),-1!==navigator.userAgent.indexOf("Firefox")&&!foundLoc&&(ZPSetupCommon.isEmpty($(e.target).attr("class"))||-1===$(e.target).attr("class").indexOf("IC-tick")&&-1===$(e.target).attr("class").indexOf("IC-cls")&&$(e.target).attr("class").indexOf("CR-delete")&&$(e.target).attr("class").indexOf("CR-edit")&&$(e.target).text()!==ZPI18N.getString("zp.addcat")))return foundLoc=!0,void Files.updateCategory(mode,isFile,id,foundLoc,"","")});else if("add"===mode||"settingadd"===mode){var newCatName="",appendId="";if("company"===isFile||"hr"===isFile){if("company"===isFile?(newCatName=Layout.Page.container.find("#companynewCategory").val().trim(),appendId="#companyselect_Cat"):"hr"===isFile&&(newCatName=Layout.Page.container.find("#hrnewCategory").val().trim(),appendId="#hrselect_Cat"),""===newCatName)return!0,Layout.Page.container.find("#"+appendId).append('<span class="ERR" errmsg="mailids" id="companycategory_err" >'+ZPI18N.getString("zp.selectcategory")+"</span>"),!0,!1;if("settingadd"!==mode&&(-1!=newCatName.indexOf("<")||-1!=newCatName.indexOf(">")||-1!=newCatName.indexOf("&lt;")||-1!=newCatName.indexOf("&gt;")))return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.folder")))),!0,!1;if(null!=newCatName&&void 0!=newCatName&&"/"===newCatName)return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.avoidslash")),!0,!1}if("settingadd"===mode){if(""===(newCatName=Layout.Page.container.find("#newsettingCategory").val().trim()))return Layout.Page.container.find("#newsettingCategory").after('<span  errmsg="mailids" id="errormsg" class="ERR"><strong>'+ZPI18N.getString("zp.enterCategory")+"</strong></span>"),!0,!1;if(-1!=newCatName.indexOf("<")||-1!=newCatName.indexOf(">")||-1!=newCatName.indexOf("&lt;")||-1!=newCatName.indexOf("&gt;"))return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.catName")))),!0,!1;if(null!=newCatName&&void 0!=newCatName&&"/"===newCatName)return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.avoidslash")),!0,!1}var parentCatId=Layout.Page.container.find("#settings_addcatplaceunder").val();(formData=new FormData).append("methodName","updateCategory"),formData.append("newCatName",newCatName),formData.append("parentCatId",parentCatId),formData.append(csrfParamName,csrfToken),isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(formData.append("latitude",Files.Geo.position.coords.latitude),formData.append("longitude",Files.Geo.position.coords.longitude)),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){if("settingadd"===mode&&void 0!==data[1]){Files.newCategoryList[data[1].CatID]=data[1].CatName,Layout.Page.container.find("#addCategoryDiv").removeClass("active"),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.folderaddedsucc"));var catID=data[1].CatID,catName=data[1].CatName;null!==Files.settingsCurrentCatId&&void 0!==Files.settingsCurrentCatId&&-1!==Files.settingsCurrentCatId?Layout.Page.container.find("#settings_subcatList"):Layout.Page.container.find("#settings_catList"),Files.constructCatForSettings(catID,parentCatId,catName,"add")}},error:function(req){var errResponse=req.responseJSON[1];8113!==req.status&&500!==req.status&&8006!==req.status||ZPeople.Message.showFailureMsg(errResponse.msg)}})}else if("edit"==mode){var formData,editCatName=$("#editsettingCategory").val().trim(),editcatId=id;if(""===editCatName)return Layout.Page.container.find("#editsettingCategory").after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.enterCategory")+"</strong></span>"),!0,!1;if(-1!=editCatName.indexOf("<")||-1!=editCatName.indexOf(">")||-1!=editCatName.indexOf("&lt;")||-1!=editCatName.indexOf("&gt;"))return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.catName")))),!0,!1;if(null!=editCatName&&void 0!=editCatName&&"/"===editCatName)return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.avoidslash")),!0,!1;(formData=new FormData).append("methodName","updateCategory"),formData.append("newCatName",editCatName),formData.append("catId",editcatId),formData.append(csrfParamName,csrfToken),isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(formData.append("latitude",Files.Geo.position.coords.latitude),formData.append("longitude",Files.Geo.position.coords.longitude)),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,contentType:!1,processData:!1,success:function(resultData){Layout.Page.container.find("#editCategoryDiv").removeClass("active"),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.foldermodifiedsucc"));var catID=editcatId;delete Files.newCategoryList[catID];var catName=resultData[1].CatName;Files.newCategoryList[resultData[1].CatID]=catName,Files.constructCatForSettings(catID,parentCatId,catName,"edit"),Layout.Page.container.find("#catLi_"+id).find(".fileDtl").find("b").html(catName)},error:function(req){var errResponse=req.responseJSON[1];8113!==req.status&&500!==req.status&&8006!==req.status||ZPeople.Message.showFailureMsg(errResponse.msg)}}),$("#cat_"+id).show(),$("#edit_"+id).hide()}}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"))},deleteCategory:function(catId,thisObj){if(isSettingsAdmin)if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position){var foundLoc=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){foundLoc=!0,Files.Geo.position=position,Files.deleteCategory(catId,null)},function(){isBlocked=!0,foundLoc=!0,Files.Geo.positionBlocked(),Files.deleteCategory(catId,null)}),isBlocked||$(document).on("click",function(e){if(Files.Geo.positionBlocked(),-1!==navigator.userAgent.indexOf("Firefox")&&!foundLoc&&(ZPSetupCommon.isEmpty($(e.target).attr("class"))||-1===$(e.target).attr("class").indexOf("CR-delete")))return foundLoc=!0,void Files.deleteCategory(catId,null)})}else{$("#confirmationPopup");$("#confirmationPopup").modal({backdrop:"static",keyboard:!1}),$("#confirmConfirmationPopup").removeClass("btn-primary").addClass("btn-danger"),$("#confirmConfirmationPopup").html("").append(ZPI18N.getString("zp.delete")),$("#textConfirmationPopupBody").html(ZPI18N.getString("zp.reallydeleteCategory")),$("#confirmConfirmationPopup").off("click"),$("#cancelConfirmationPopup").off("click");$("#confirmConfirmationPopup").on("click",function(event){var formData=new FormData;formData.append("methodName","deleteCategory"),formData.append("deleteCatId",catId),formData.append(csrfParamName,csrfToken),isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(formData.append("latitude",Files.Geo.position.coords.latitude),formData.append("longitude",Files.Geo.position.coords.longitude)),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.folderdeletedsucc")),$("#catLi_"+catId).remove(),delete Files.newCategoryList[catId]},error:function(req){var errResponse=req.responseJSON[1];ZPeople.Message.showFailureMsg(errResponse.msg)}})}),$("#cancelConfirmationPopup").on("click",function(event){$("#confirmationPopup").modal("hide")})}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"))},getcatList:function(mode,formId){if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&Object.keys(Files.newCategoryList).length<=0){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.getcatList("catlistview",position.coords.latitude,position.coords.longitude,!0)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.getcatList("catlistview","","",!0)}),$(document).on("click",function(){Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||(pageLoaded=!0,Files.getcatList("catlistview","","",!0))})}else{if(Object.keys(Files.newCategoryList).length<=0){Files.isCachedCat=!0;var formData=new FormData;void 0!=formId&&null!=formId&&""!=formId&&formData.append("formId",formId),formData.append("methodName","getGroupByAllCategories"),formData.append("conreqcsr",csrfToken),null!==Files.Geo.position&&"true"===doNeedToGetLocation&&Files.Geo.position!==Files.Geo.blocked&&(formData.append("latitude",Files.Geo.position.coords.latitude),formData.append("longitude",Files.Geo.position.coords.longitude)),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){void 0!==resultData[1]?$.each(resultData[1],function(key,value){Files.newCategoryList[value.CatID]=value.CatName,"profile"===mode&&"<option value = '"+value.CatID+"'>"+value.CatName+"</option>"}):Files.isIprestrict(resultData)}})}else"profile"===mode&&$.each(Files.newCategoryList,function(catId,catName){"profile"===mode&&"<option value = '"+catId+"'>"+catName+"</option>"})}},FilescatList:function(mode,optid,id,val,formId){var obj,filter_catId="",opt="";"search_catlist"===mode?(opt='<option value="-1">'+ZPI18N.getString("zp.all")+"</option>",filter_catId=optid):(opt='<option value="-1">'+ZPI18N.getString("zp.select")+"</option>",Layout.Page.container.find("#"+id).select2("val","-1")),obj=MMtemplte.templateAddHR?$("#page-wrapper"):Layout.Page.container,"import"===mode&&(obj=obj.find("div#import_hrfileDiv")),obj.find("#"+optid).select2(),obj.find("#"+optid).append(opt),obj.find("#"+optid).select2({placeholder:ZPI18N.getString("zp.select")}),null!=Files.newCategoryList&&void 0!=Files.newCategoryList&&0!=Object.keys(Files.newCategoryList).length||Files.getcatList("",formId);for(var catArr=Object.keys(Files.newCategoryList),i=catArr.length-1;i>=0;i--){var key=catArr[i];opt='<option value="'+key+'">'+Files.newCategoryList[key]+"</option>";obj.find("#"+optid).append(opt)}if((0==loginUserRoleCheck||1==loginUserRoleCheck)&&-1===Layout.Page.hash.indexOf("files/settings/categorylistview")){opt='<button class="btn btn-primary" onclick="Files.shownewCategory(\''+mode+'\')" data-toggle="modal" >'+ZPI18N.getString("zp.addcat")+"</button>";null!=id&&void 0!=id&&obj.find("#"+id).find(".select2-results").after(opt)}null!=filter_catId&&""!=filter_catId&&filter_catId&&void 0!=filter_catId&&(null!=val&&""!=val&&void 0!=val?obj.find("#"+filter_catId).select2("val",val):obj.find("#"+filter_catId).select2("val","-1"))},shownewCategory:function(mode,type){var modalObj;"company"===mode?((modalObj=Layout.Page.container.find("div#add_companyfileDiv")).find("#cancel_Cat_btn").show(),modalObj.find("#companynewCategory").val($(".select2-drop-active input:visible").val()),$(".select2-drop-active").hide(),modalObj.find("#companyselect_Cat").val(""),modalObj.find("#companynewCategory,#new_compCatDIV").show(),modalObj.find("#s2id_companyselect_Cat,#companyzp_add_Cat,#companycategory_err").hide()):((modalObj=ZPSetupCommon.isEmpty(mode)||"import"!==mode?MMtemplte.templateAddHR?$("#page-wrapper").find("#add_hrfileDiv"):Layout.Page.container.find("div#add_hrfileDiv"):Layout.Page.container.find("div#import_hrfileDiv")).find("#cancel_hrCat_btn").show(),modalObj.find("#hrnewCategory").val($(".select2-drop-active input:visible").val()),$(".select2-drop-active").hide(),modalObj.find("#hrnewCategory,#new_hrCatDIV").show(),modalObj.find("#s2id_hrselect_Cat,#hrzp_add_Cat,#hrcategory_err").hide())},cancelnewCategory:function(mode){if("company"===mode)Layout.Page.container.find("#cancel_Cat_btn,#companynewCategory,#new_compCatDIV,#companycategory_err").hide(),Layout.Page.container.find("#s2id_companyselect_Cat,#companyzp_add_Cat").show(),Layout.Page.container.find("#companyselect_Cat").select2("val",[-1]);else if("hrdoc"===mode)Layout.Page.container.find("#cancel_Cat_btn,#hrdocnewCategory,#new_hrdocCatDIV,#hrdoccategory_err").hide(),Layout.Page.container.find("#s2id_hrdocselect_Cat,#hrdoczp_add_Cat").show(),Layout.Page.container.find("#hrdocselect_Cat").select2("val",[-1]);else{var modalObj;(modalObj=MMtemplte.templateAddHR?$("#page-wrapper").find("#add_hrfileDiv"):Layout.Page.container.find("div#add_hrfileDiv")).find("#cancel_hrCat_btn,#hrnewCategory,#new_hrCatDIV,#hrcategory_err").hide(),modalObj.find("#s2id_hrselect_Cat,#hrzp_add_Cat").show(),modalObj.find("#hrselect_Cat").select2("val",[-1])}},uploadOnChange:function(obj){var filename=obj.value;Layout.Page.container.find("#fileName").val(filename.replace("C:\\fakepath\\","")),Files.uploadMode="localUpload",""!==filename&&$("#errormsg").remove()},hideLocations:function(container){var locations;""!==container&&void 0!==container&&null!==container||(container="select_location"),locations=Layout.Page.container.find("#"+container).select2("data");var id_arr=[];if($.each(locations,function(index,value){id_arr.push(locations[index].id)}),-1==id_arr[0]&&id_arr.length>1){var showLoc=[];$.each(id_arr,function(index,value){0!=index&&showLoc.push(value)}),Layout.Page.container.find("#"+container).select2("val",showLoc)}-1==id_arr[id_arr.length-1]&&id_arr.length>1&&Layout.Page.container.find("#"+container).select2("val","-1")},getLocationList:function(id,mode,val){""!=id&&void 0!=id||(id="search_location");var optstr=Layout.Page.container.find("#"+id);if(Layout.Page.container.find("#"+id).html(""),Layout.Page.container.find("#"+id).select2(),0==loginUserRoleCheck||1==loginUserRoleCheck||"search_location"===id||"search_locationHr"===id){var opt='<option value="-1">'+ZPI18N.getString("zp.all")+"</option>";optstr.append(opt),Layout.Page.container.find("#"+id).select2("val","-1")}else 2==loginUserRoleCheck&&(Layout.Page.container.find(".select2-default").css("width","100%"),Layout.Page.container.find("#select_location").select2({placeholder:ZPI18N.getString("zp.select")}),Layout.Page.container.find("#select_location").select2("val",_LOGGEDIN_LOCID));if(null===Files.locationName_Arr||Object.keys(Files.locationName_Arr).length<=0){if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position){var pageLoaded=!1,isBlocked=!1;return navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.getLocationList()},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.getLocationList()}),void $(document).on("click",function(e){Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||-1!==$(e.target).attr("class").indexOf("btn")||-1!==$(e.target).attr("class").indexOf("IC")||(pageLoaded=!0,Files.getLocationList())})}var params={methodName:"getLocations",conreqcsr:csrfToken};null!==Files.Geo.position&&"true"===doNeedToGetLocation&&Files.Geo.position!==Files.Geo.blocked&&(params.latitude=Files.Geo.position.coords.latitude,params.longitude=Files.Geo.position.coords.longitude),Files.setLatitudeLongitude(params),$.post(Files.ACTION.URL,params,function(resultData){"string"==typeof resultData&&resultData.indexOf("fail")>-1?ZPeople.Message.showFailureMsg(JSON.parse(resultData).fail):void 0!==resultData[1]?($.each(resultData[1],function(index,data){Files.locationName_Arr[data.ID]=data.NAME;var opt='<option value="'+data.ID+'">'+data.NAME+"</option>";optstr.append(opt),Layout.Page.container.find("#select_location").select2("val",val),2==loginUserRoleCheck?Layout.Page.container.find("#select_location").select2("val",data.ID):"cm_loc"!==id&&Layout.Page.container.find("#select_location").select2("val","-1")}),void 0!==val&&""!==val&&null!==val&&Layout.Page.container.find("#select_location").select2("val",val)):Files.isIprestrict(resultData)})}else $.each(Files.locationName_Arr,function(locId,locName){var opt='<option value="'+locId+'">'+locName+"</option>";optstr.append(opt),2==loginUserRoleCheck?Layout.Page.container.find("#select_location").select2("val",locId):void 0==val&&""==val&&"cm_loc"!==id&&Layout.Page.container.find("#select_location").select2("val","-1")}),void 0!==val&&""!==val&&null!==val&&Layout.Page.container.find("#select_location").select2("val",val)},isIprestrict:function(resultData){$.each(resultData,function(index,data){""!==data.ip&&void 0!==data.ip?Files.isIprestricted=!0:Files.isIprestricted=!1})},getSharedToForPreview:function(data){var row="<em>",array=data.toString().split(",");for(var i in array)row+="<strong>"+array[i]+"</strong>";return row+="</em>"},getAllSharedLocRole:function(fileLocationNameNew){var row='<ul class="dropdown-menu ZPCmn-Arrow top gray">',array=fileLocationNameNew;for(var i in array)(array[i].indexOf("<")||array[i].indexOf(">")||array[i].indexOf("&lt;")||-1!=array[i].indexOf("&gt;"))&&(array[i]=array[i].replace(/<|>|<!|&lt;|&gt;/g,"")),row+="<li>"+array[i]+"</li>";return row+="</ul>"},isEditable:function(arr1,arr2){return 0==$(arr1).not(arr2).length&&0!=$(arr2).length&&0!=$(arr1).length},downloadFilecabinet:function(obj,viewfileId,filePath,fileName){var fileId="";if("html"!==obj){var data=$(obj).parent().parent().parent().data().ldata;fileId=data.fileID;filePath=data.filePath,fileName=decodeHTML(data.fileName)}else fileId=viewfileId,filePath=decodeURIComponent(filePath),fileName=decodeURIComponent(fileName);var pageLoaded=!1,isBlocked=!1;if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position)navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position;var downloadJSON={mode:"files"};downloadJSON.portalId=_LOGGEDIN_ACCZSOID;var extraDetails={};extraDetails.fileId=fileId,extraDetails.fileName=fileName,extraDetails.filePath=filePath,extraDetails.files_userIp=userIp,extraDetails.isOnboarding=ZPeople.onBoardingStatus,downloadJSON.extraDtls=extraDetails,void 0!=ZPeople.zaid&&(downloadJSON.zaid=ZPeople.zaid);var downloadURL=UDS_DOWNLOAD_URL+"/webdownload?x-service="+UDS_DOWNLOAD_SERVICE_CODE+"&event-id="+fileId+"&x-cli-msg="+encodeURIComponent(JSON.stringify(downloadJSON));void 0!=ZPeople.zaid&&(downloadURL+="&x-cli-zaid="+ZPeople.zaid),window.open(downloadURL)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked();var downloadJSON={mode:"files"};downloadJSON.portalId=_LOGGEDIN_ACCZSOID;var extraDetails={};extraDetails.fileId=fileId,extraDetails.fileName=fileName,extraDetails.filePath=filePath,extraDetails.files_userIp=userIp,extraDetails.isOnboarding=ZPeople.onBoardingStatus,downloadJSON.extraDtls=extraDetails,void 0!=ZPeople.zaid&&(downloadJSON.zaid=ZPeople.zaid);var downloadURL=UDS_DOWNLOAD_URL+"/webdownload?x-service="+UDS_DOWNLOAD_SERVICE_CODE+"&event-id="+fileId+"&x-cli-msg="+encodeURIComponent(JSON.stringify(downloadJSON));void 0!=ZPeople.zaid&&(downloadURL+="&x-cli-zaid="+ZPeople.zaid),window.open(downloadURL)}),isBlocked||$(document).on("click",function(e){if(Files.Geo.positionBlocked(),-1!==navigator.userAgent.indexOf("Firefox")&&!pageLoaded&&(ZPSetupCommon.isEmpty($(e.target).attr("class"))||-1===$(e.target).attr("class").indexOf("CR-imprt"))&&(ZPSetupCommon.isEmpty($(e.target).attr("name"))||!ZPSetupCommon.isEmpty($(e.target).attr("name"))&&"deleteElm"!==$(e.target).attr("name"))){pageLoaded=!0;var downloadJSON={mode:"files"};downloadJSON.portalId=_LOGGEDIN_ACCZSOID;var extraDetails={};extraDetails.fileId=fileId,extraDetails.fileName=fileName,extraDetails.filePath=filePath,extraDetails.files_userIp=userIp,extraDetails.isOnboarding=ZPeople.onBoardingStatus,downloadJSON.extraDtls=extraDetails,void 0!=ZPeople.zaid&&(downloadJSON.zaid=ZPeople.zaid);var downloadURL=UDS_DOWNLOAD_URL+"/webdownload?x-service="+UDS_DOWNLOAD_SERVICE_CODE+"&event-id="+fileId+"&x-cli-msg="+encodeURIComponent(JSON.stringify(downloadJSON));void 0!=ZPeople.zaid&&(downloadURL+="&x-cli-zaid="+ZPeople.zaid),window.open(downloadURL)}});else{var downloadJSON={mode:"files"};downloadJSON.portalId=_LOGGEDIN_ACCZSOID;var extraDetails={};extraDetails.fileId=fileId,extraDetails.fileName=fileName,extraDetails.filePath=filePath,extraDetails.files_userIp=userIp,extraDetails.isOnboarding=ZPeople.onBoardingStatus,downloadJSON.extraDtls=extraDetails,void 0!=ZPeople.zaid&&(downloadJSON.zaid=ZPeople.zaid);var downloadURL=UDS_DOWNLOAD_URL+"/webdownload?x-service="+UDS_DOWNLOAD_SERVICE_CODE+"&event-id="+fileId+"&x-cli-msg="+encodeURIComponent(JSON.stringify(downloadJSON));void 0!=ZPeople.zaid&&(downloadURL+="&x-cli-zaid="+ZPeople.zaid),window.open(downloadURL)}},downloadCompHandbook:function(fileId){var url="/download?fileId="+fileId;"undefined"!=contextPath&&"null"!=contextPath&&(url="/"+contextPath+url),null!==Files.Geo.position&&"true"===doNeedToGetLocation&&Files.Geo.position!==Files.Geo.blocked&&(url+="&latitude="+Files.Geo.position.coords.latitude+"&longitude="+Files.Geo.position.coords.longitude),window.open("/people"+url)},copyUrl:function(obj){var data=$(obj).parent().parent().parent().parent().parent().data().ldata,fileId=data.fileID,isPdf=!1,fileExtn="",filePath=data.filePath;ZPeople.IsNumeric(filePath)?fileExtn=data.fileExtn.toLowerCase():-1!=filePath.lastIndexOf(".")&&(fileExtn=(fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length)).toLowerCase()),null!=fileExtn&&void 0!=fileExtn&&""!=fileExtn&&"pdf"==fileExtn&&(isPdf=!0);var successCopy,curdomain=document.domain,tempInput=document.createElement("input");tempInput.style="position: absolute; left: -1000px; top: -1000px";var url="";if(isPdf)url="/pdfViewer.zp?fileId="+fileId;else url="/viewFile?fileId="+fileId;"undefined"!=contextPath&&"null"!=contextPath&&(url="/"+contextPath+url),tempInput.value="https://"+curdomain+url,document.body.appendChild(tempInput),tempInput.select(),document.execCommand("copy"),document.body.removeChild(tempInput);try{!1===(successCopy=document.execCommand("copy"))?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.copyfailed")):ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.copysuccess"))}catch(exception){successCopy=!1,ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.copyfailed"))}return successCopy},showIPErrorAlert:function(){return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.iprestricted")),!1},registerCompanyFilesFilter:function(){Layout.Page.container.find("#show_hide_companyfile_filter, #show_hide_companyfile_filter .ZPRdlt").each(function(){this.onclick=function(){if(Files.isIprestricted||Files.isGeorestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));else if(!Files.isIprestricted&&!Files.isGeorestricted){if(Layout.Page.container.find("#companyfilterdiv").is(":visible")){var addc=Layout.Page.hash.indexOf("files/fileView")>-1?"Nbar2":"Nbar5";$("#page-wrapper").removeClass("Nbar2F").addClass(addc)}else{var remc=Layout.Page.hash.indexOf("files/fileView")>-1?"Nbar2":"Nbar5";$("#page-wrapper").addClass("Nbar2F").removeClass(remc)}Layout.Page.container.find("#search_location").select2();var Loc_value=Layout.Page.container.find("#search_location").val();if(Files.getLocationList("search_location",void 0,Loc_value),Layout.Page.container.find("#companyFileViewType").select2(),Object.keys(Files.orgListViewData.Org[2]).length>0)Layout.Page.container.find("#companysearch_cat").find("option").remove(),Files.FilescatList("search_catlist","companysearch_cat"),Layout.Page.container.find("#search_CFextn").select2(),Files.setSearchValuesInDiv();else{var cat_value=Layout.Page.container.find("#companysearch_cat").val();Layout.Page.container.find("#companysearch_cat").find("option").remove(),Files.FilescatList("search_catlist","companysearch_cat",void 0,cat_value),Layout.Page.container.find("#search_CFextn").select2();var extnVal=Layout.Page.container.find("#search_CFextn").val();null==extnVal||void 0==extnVal||""==extnVal?Layout.Page.container.find("#search_CFextn").select2("val","-1"):Layout.Page.container.find("#search_CFextn").select2("val",extnVal)}Layout.Page.container.find("#show_hide_companyfile_filter").toggleClass("sel"),Files.openClsFilter("#show_hide_companyfile_filter"),Layout.Page.container.find("#companyfilterdiv").slideToggle(100)}},Files.showEntityFields(),Files.getSharingOptsList(),Files.setFilesOrgStructureFields(Files.sharingOpts);var selopt='<option value="location">'+ZPI18N.getString("zp.location")+"</option>";Layout.Page.container.find("#selectorgStructEntities").html(""),Layout.Page.container.find("#orgStructEntities").parent().removeClass("DNI"),isOrgStructureEnabled||0==loginUserRoleCheck||1==loginUserRoleCheck?(!0===ZPeople.orgStructureTagMap.entity&&(selopt+='<option value="Entity">'+ZPeople.orgStructureDispNameMap.entity+"</option>"),!0===ZPeople.orgStructureTagMap.unit&&(selopt+='<option value="Business_unit">'+ZPeople.orgStructureDispNameMap.unit+"</option>"),!0===ZPeople.orgStructureTagMap.division&&(selopt+='<option value="Division">'+ZPeople.orgStructureDispNameMap.division+"</option>"),!0!==ZPeople.orgStructureTagMap.department&&0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(selopt+='<option value="Department">'+ZPeople.orgStructureDispNameMap.department+"</option>")):selopt+='<option value="Department">'+ZPeople.orgStructureDispNameMap.department+"</option>",Layout.Page.container.find("#selectorgStructEntities").append(selopt),Layout.Page.container.find("#selectorgStructEntities").select2(location)}),Layout.Page.container.find("#show_hide_companyfile_filter").on("mouseover",function(){Layout.Page.container.find(this).find(".IC-filter").toggleClass("sel")}),Layout.Page.container.find("#show_hide_companyfile_filter").on("mouseout",function(){Layout.Page.container.find(this).find(".IC-filter").toggleClass("sel")})},hideCompanyFilter:function(){Layout.Page.container.find("#companyfilterdiv").hide(),Layout.Page.container.find("#show_hide_companyfile_filter").removeClass("sel"),Files.searchFileBreadcrumbs()},searchWithDateValidation:function(fromDate,toDate){var currentdatelong,fromDatelong="",toDatelong="";return currentdatelong=new Date(moment(moment().format(dateFmt.toUpperCase()),dateFmt.toUpperCase())).getTime(),null!=fromDate&&void 0!=fromDate&&""!=fromDate&&(fromDatelong=new Date(moment(fromDate,dateFmt.toUpperCase())).getTime()),null!=toDate&&void 0!=toDate&&""!=toDate&&(toDatelong=new Date(moment(toDate,dateFmt.toUpperCase())).getTime()),fromDatelong>toDatelong&&""!=fromDatelong&&""!=toDatelong?(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.fromDateIsGreater")),!1):!(fromDatelong>currentdatelong||toDatelong>currentdatelong)||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.invaliddateentry")),!1)},fetchFileExtn:function(fileExtn){var extnList="";return"1"===fileExtn?extnList="doc,docx,sxw,odt,rtf":"2"===fileExtn?extnList="xls,xlsx,sxc,ods,csv,tsv":"3"===fileExtn?extnList="ppt,pps,odp,ods,sxi,pptx":"4"===fileExtn?extnList="pdf":"5"===fileExtn?extnList="jpg,jpeg,gif,png":"6"===fileExtn?extnList="mp3,mp4a,wav":"7"===fileExtn&&(extnList="mp4"),extnList},fetchFileTypeByExtn:function(fileExtn,mode){var extnType="",FileType="";return"doc,docx,sxw,odt,rtf"===fileExtn?(extnType="1",FileType=ZPI18N.getString("zp.zs.documents")):"xls,xlsx,sxc,ods,csv,tsv"===fileExtn?(extnType="2",FileType=ZPI18N.getString("zp.spreadsheets")):"ppt,pps,odp,ods,sxi,pptx"===fileExtn?(extnType="3",FileType=ZPI18N.getString("zp.presentations")):"pdf"===fileExtn?(extnType="4",FileType=ZPI18N.getString("zp.pdf")):"jpg,jpeg,gif,png"===fileExtn?(extnType="5",FileType=ZPI18N.getString("zp.images")):"mp3,mp4a,wav"===fileExtn?(extnType="6",FileType=ZPI18N.getString("zp.audio")):"mp4"===fileExtn&&(extnType="7",FileType=ZPI18N.getString("zp.video")),"type"===mode?FileType:extnType},checkAll:function(obj,mode){var chk=obj.checked;"company"===mode?chk?(Layout.Page.container.find("#comp_fileListing").find("input[type=checkbox]").each(function(){Layout.Page.container.find(this).attr("disabled")||Layout.Page.container.find(this).prop("checked",!0)}),"0"!==Layout.Page.container.find("#companyFileViewType").val()?(Layout.Page.container.find("#copyFiles").hide(),Layout.Page.container.find("#moveFiles").hide()):(Layout.Page.container.find("#copyFiles").show(),Layout.Page.container.find("#moveFiles").show()),Layout.Page.container.find("#company_multiselDel").show(),Layout.Page.container.find("#addCompany_Bar").hide()):(Layout.Page.container.find("#company_multiselDel").hide(),Layout.Page.container.find("#addCompany_Bar").show(),Files.closeCopyMoveDiv(),Layout.Page.container.find("#comp_fileListing").find("input[type=checkbox]:checked").each(function(){Layout.Page.container.find(this).prop("checked",!1)})):"hr"===mode?chk?(Layout.Page.container.find("#hr_allfileList").find("input[type=checkbox]").each(function(){Layout.Page.container.find(this).attr("disabled")||Layout.Page.container.find(this).prop("checked",!0)}),"3"!==Layout.Page.container.find("#fileTypeData").val()&&-1==Layout.Page.hash.indexOf("hrfile/role/")?(Layout.Page.container.find("#copyFiles").hide(),Layout.Page.container.find("#moveFiles").hide()):(Layout.Page.container.find("#copyFiles").show(),Layout.Page.container.find("#moveFiles").show()),Layout.Page.container.find("#hr_multiselDel").show(),Layout.Page.container.find("#addHR_Bar").hide()):(Layout.Page.container.find("#hr_allfileList").find("input[type=checkbox]:checked").each(function(){Layout.Page.container.find(this).prop("checked",!1)}),Layout.Page.container.find("#hr_multiselDel").hide(),Layout.Page.container.find("#addHR_Bar").show(),Files.closeCopyMoveDiv()):"personal"===mode&&(chk?(Layout.Page.container.find("#pers_fileListing").find("input[type=checkbox]").each(function(){Layout.Page.container.find(this).attr("disabled")||Layout.Page.container.find(this).prop("checked",!0)}),Layout.Page.container.find("#personal_multiselDel").show(),Layout.Page.container.find("#addPersonal_Bar").hide()):(Layout.Page.container.find("#personal_multiselDel").hide(),Layout.Page.container.find("#addPersonal_Bar").show(),Layout.Page.container.find("#pers_fileListing").find("input[type=checkbox]:checked").each(function(){Layout.Page.container.find(this).prop("checked",!1)})))},checkParticularfiles:function(obj,mode){if(obj.checked)if("company"===mode){Layout.Page.container.find("#company_multiselDel").show(),Layout.Page.container.find("#addCompany_Bar").hide(),Layout.Page.container.find("#comp_fileListing").find('input[type="checkbox"]:checked').length===Layout.Page.container.find("#comp_fileListing").find('input[type="checkbox"]').length&&Layout.Page.container.find("#companyfile_checkallbox").prop("checked",!0);for(files=Layout.Page.container.find("#comp_fileListing").find("input[type='checkbox']:checked"),i=0;i<files.length;i++){fileID=$(files[i]).attr("id"),compRow=Layout.Page.container.find("#compfileTr_"+fileID).data().ldata;if(!jQuery.isEmptyObject(compRow.fileOrgStructure)){Layout.Page.container.find("#copyFiles").show();break}Layout.Page.container.find("#copyFiles").hide()}}else"hr"===mode?(Layout.Page.container.find("#hr_multiselDel").show(),"3"!==Layout.Page.container.find("#fileTypeData").val()&&-1==Layout.Page.hash.indexOf("hrfile/role/")?(Layout.Page.container.find("#copyFiles").hide(),Layout.Page.container.find("#moveFiles").hide()):(Layout.Page.container.find("#copyFiles").show(),Layout.Page.container.find("#moveFiles").show()),Layout.Page.container.find("#addHR_Bar").hide(),Layout.Page.container.find("#hr_allfileList").find('input[type="checkbox"]:checked').length===Layout.Page.container.find("#hr_allfileList").find('input[type="checkbox"]').length&&Layout.Page.container.find("#hrfile_checkallbox").prop("checked",!0)):"personal"===mode&&(Layout.Page.container.find("#personal_multiselDel").show(),Layout.Page.container.find("#addPersonal_Bar").hide(),Layout.Page.container.find("#pers_fileListing").find('input[type="checkbox"]:checked').length===$("#pers_fileListing").find('input[type="checkbox"]').length&&Layout.Page.container.find("#persfile_checkallbox").prop("checked",!0));else if("company"===mode){if(0==Layout.Page.container.find("#comp_fileListing").find('input[type="checkbox"]:checked').length)Layout.Page.container.find("#companyfile_checkallbox").prop("checked",!1),Layout.Page.container.find("#company_multiselDel").hide(),Layout.Page.container.find("#addCompany_Bar").show(),Files.closeCopyMoveDiv();else if(Layout.Page.container.find("#comp_fileListing").find('input[type="checkbox"]:checked').length>0){if(Layout.Page.container.find("#companyfile_checkallbox").prop("checked",!1),"0"!==Layout.Page.container.find("#companyFileViewType").val())Layout.Page.container.find("#copyFiles").hide(),Layout.Page.container.find("#moveFiles").hide();else{Layout.Page.container.find("#copyFiles").show(),Layout.Page.container.find("#moveFiles").show();for(var files=Layout.Page.container.find("#comp_fileListing").find("input[type='checkbox']:checked"),i=0;i<files.length;i++){var fileID=$(files[i]).attr("id"),compRow=Layout.Page.container.find("#compfileTr_"+fileID).data().ldata;if(!jQuery.isEmptyObject(compRow.fileOrgStructure)){Layout.Page.container.find("#copyFiles").show();break}Layout.Page.container.find("#copyFiles").hide()}}Layout.Page.container.find("#company_multiselDel").show(),Layout.Page.container.find("#addCompany_Bar").hide()}}else"hr"===mode?0==Layout.Page.container.find("#hr_allfileList").find('input[type="checkbox"]:checked').length?(Layout.Page.container.find("#hrfile_checkallbox").prop("checked",!1),Layout.Page.container.find("#hr_multiselDel").hide(),Layout.Page.container.find("#addHR_Bar").show(),Files.closeCopyMoveDiv()):Layout.Page.container.find("#hr_allfileList").find('input[type="checkbox"]:checked').length>0&&(Layout.Page.container.find("#hrfile_checkallbox").prop("checked",!1),"3"!==Layout.Page.container.find("#fileTypeData").val()&&-1==Layout.Page.hash.indexOf("hrfile/role/")?(Layout.Page.container.find("#copyFiles").hide(),Layout.Page.container.find("#moveFiles").hide()):(Layout.Page.container.find("#copyFiles").show(),Layout.Page.container.find("#moveFiles").show()),Layout.Page.container.find("#hr_multiselDel").show(),Layout.Page.container.find("#addHR_Bar").hide()):"personal"===mode&&(0==Layout.Page.container.find("#pers_fileListing").find('input[type="checkbox"]:checked').length?(Layout.Page.container.find("#persfile_checkallbox").prop("checked",!1),Layout.Page.container.find("#personal_multiselDel").hide(),Layout.Page.container.find("#addPersonal_Bar").show()):$("#pers_fileListing").find('input[type="checkbox"]:checked').length>0&&(Layout.Page.container.find("#persfile_checkallbox").prop("checked",!1),Layout.Page.container.find("#personal_multiselDel").show(),Layout.Page.container.find("#addPersonal_Bar").hide()))},deleteRecConfirm:function(Obj,toggleId){$(Obj).parent().parent().find(".FL").removeClass("DB"),$(Obj).parent().parent().find(".FL").addClass("DN"),$(Obj).parent().removeClass("DB"),$(Obj).parent().addClass("DN"),$(Obj).parent().parent().find("#action_confirm_btn").parent().addClass("sel"),$(Obj).parent().parent().find("#action_confirm_btn").addClass("DB"),$(Obj).parent().parent().find("#action_confirm_btn").removeClass("DN")},cancelDelRecConfirm:function(Obj){$(Obj).parent().removeClass("DB"),$(Obj).parent().addClass("DN"),$(Obj).parent().parent().find("#action_confirm_btn").parent().removeClass("sel"),$(Obj).parent().parent().find(".FL").removeClass("DN"),$(Obj).parent().parent().find(".FL").addClass("DB"),$(Obj).parent().parent().find(".FR").removeClass("DN"),$(Obj).parent().parent().find(".FR").addClass("DB")},deleteFiles:function(mode,deletefileID,obj,isFile){if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.deleteFiles(mode,deletefileID,obj,isFile)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.deleteFiles(mode,deletefileID,obj,isFile)}),isBlocked||$(document).on("click",function(e){Files.Geo.positionBlocked(),-1!==navigator.userAgent.indexOf("Firefox")&&!pageLoaded&&(ZPSetupCommon.isEmpty($(e.target).attr("class"))||$(e.target).text()!==ZPI18N.getString("zp.confirm")&&$(e.target).text()!==ZPI18N.getString("zp.cancel")&&$(e.target).text()!==ZPI18N.getString("zp.delete"))&&(pageLoaded=!0,Files.deleteFiles(mode,deletefileID,obj,isFile))})}else if("multiple"===mode)$("#confirmationPopup").modal("show"),$("#confirmationPopup").modal({backdrop:"static",keyboard:!1}),$("#textConfirmationPopupHeader").html("").append(ZPI18N.getString("zp.zpalert")),$("#textConfirmationPopupBody").html("").append(ZPI18N.getString("zp.deleteRecord")),$("#confirmConfirmationPopup").html("").append(ZPI18N.getString("zp.delete")),$("#confirmConfirmationPopup").off("click"),$("#cancelConfirmationPopup").off("click"),$("#confirmConfirmationPopup").on("click",function(event){var files="";"company"===isFile?files=Layout.Page.container.find("#comp_fileListing").find("ul[id^='compfileTr_']").find("input[type='checkbox']:checked"):"hr"===isFile?files=Layout.Page.container.find("#hr_allfileList").find("ul[id^='hrfileTr_']").find("input[type='checkbox']:checked"):"personal"===isFile?files=Layout.Page.container.find("#pers_fileListing").find("ul[id^='persfileTr_']").find("input[type='checkbox']:checked"):"hrdocuments"!==isFile&&"hrmergedocuments"!==isFile||(files=Layout.Page.container.find("#hrdoclistingdiv").find("ul[fileid]").find("input[type='checkbox']:checked"));for(var fileID="",i=0;i<files.length;i++)fileID+=$(files[i]).attr("id"),i!==files.length-1&&(fileID+=",");var params="methodName=deleteFiles&deleteFileId="+fileID+"&"+csrfParamName+"="+csrfToken;isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(params+="&latitude="+Files.Geo.position.coords.latitude+"&longitude="+Files.Geo.position.coords.longitude),"personal"===isFile&&(params+="&fileType=2"),"hrdocuments"===isFile&&(params+="&fileType=4"),"hrmergedocuments"===isFile&&(params+="&fileType=5");var list=fileID.split(","),fileName=[];if("personal"!==isFile&&2==loginUserRoleCheck){$.each(list,function(index,value){var compObj=Layout.Page.container.find("#comp_fileListing").find("li[fileid="+value+"]");if(void 0!=$(compObj).data()&&!1===$(compObj).parent().data().ldata.fileActions.isDeletePerm&&fileName.push($(compObj).parent().data().ldata.fileName),"hr"===isFile){var empfileObj=Layout.Page.container.find("#hr_allfileList").find("li[fileid="+value+"]").parent().data().ldata;if(0==empfileObj.fileRoleID.length&&!empfileObj.fileActions.isDeletePerm)return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")),void fileName.push(empfileObj.fileName)}}),0!=fileName.length&&"company"===isFile&&ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.multiplelocations",new Array(fileName)));var fileTypeData=Layout.Page.container.find("#s2id_fileTypeData").find("a").find("span").text();"hr"===isFile&&fileTypeData==ZPI18N.getString("zp.sharedmyrole")&&ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"))}0==fileName.length&&$.post(Files.ACTION.URL,params,function(resultData){resultData.hasOwnProperty("fail")?ZPeople.Message.showFailureMsg(resultData.fail):"company"===isFile?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.deletedfile")),Files.getCompanyfilesListing("change"),Layout.Page.container.find("#company_multiselDel").hide(),Layout.Page.container.find("#addCompany_Bar").show(),Files.closeCopyMoveDiv()):"hr"===isFile?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.deletedfile")),Files.getHrfilesListing("add"),Layout.Page.container.find("#hr_multiselDel").hide(),Layout.Page.container.find("#addHR_Bar").show()):"personal"===isFile?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.deletedfile")),Files.getPersonalfilesListing("addPersonal"),Layout.Page.container.find("#personal_multiselDel").hide(),Layout.Page.container.find("#addPersonal_Bar").show()):"hrdocuments"!==isFile&&"hrmergedocuments"!==isFile||(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.deletedfile")),$.each(list,function(index,value){Layout.Page.container.find("#hrdoc_list ul[fileid="+value+"]").remove()}),0===Layout.Page.container.find("#hrdoc_list").find("ul").length&&(Layout.Page.container.find("#hrdoc_norecords .ctable").remove(),Zohosign.newuinohrDocrecords(ZPI18N.getString("zp.nodatafound"))),Layout.Page.container.find("#doc_multiselDel").hide(),Layout.Page.container.find("#doc_HeaderBar").show())})}),$("#cancelConfirmationPopup").on("click",function(event){$("#confirmationPopup").modal("hide")});else{var params="methodName=deleteFiles&deleteFileId="+deletefileID+"&"+csrfParamName+"="+csrfToken;isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(params+="&latitude="+Files.Geo.position.coords.latitude+"&longitude="+Files.Geo.position.coords.longitude),"personal"===isFile&&(params+="&fileType=2"),"hrdocuments"===isFile&&(params+="&fileType=4"),"hrmergedocuments"===isFile&&(params+="&fileType=5"),$.post(Files.ACTION.URL,params,function(resultData){resultData.hasOwnProperty("fail")?ZPeople.Message.showFailureMsg(resultData.fail):"company"===isFile?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.deletedfile")),Layout.Page.container.find("#compfileTr_"+deletefileID).remove(),0===Layout.Page.container.find("#comp_fileListing").find("ul").length&&(Files.showNodataMsg("company_filesmsg"),Layout.Page.container.find("#company_multiselDel").hide(),Layout.Page.container.find("#addCompany_Bar").show(),Files.closeCopyMoveDiv())):"hr"===isFile?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.deletedfile")),Layout.Page.container.find("#hrfileTr_"+deletefileID).remove(),0===Layout.Page.container.find("#hr_allfileList").find("ul").length&&(Files.showNodataMsg("hr_filesmsg"),Layout.Page.container.find("#hr_multiselDel").hide(),Layout.Page.container.find("#addHR_Bar").show())):"personal"===isFile?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.deletedfile")),Layout.Page.container.find("#persfileTr_"+deletefileID).remove(),0===Layout.Page.container.find("#pers_fileListing").find("ul").length&&(Files.showNodataMsg("personal_filesmsg"),Layout.Page.container.find("#personal_multiselDel").hide(),Layout.Page.container.find("#addPersonal_Bar").show())):"hrdocuments"!==isFile&&"hrmergedocuments"!==isFile||(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.deletedfile")),Layout.Page.container.find("#hrdoc_list ul[fileid="+deletefileID+"]").remove(),0===Layout.Page.container.find("#hrdoc_list").find("ul").length&&(Layout.Page.container.find("#hrdoc_norecords .ctable").remove(),Zohosign.newuinohrDocrecords(ZPI18N.getString("zp.nodatafound")),Layout.Page.container.find("#doc_multiselDel").hide(),Layout.Page.container.find("#doc_HeaderBar").show()))})}},chooseViewFilterOption:function(mode){"0"===Layout.Page.container.find("#fileTypeData").val()?($("#search_role").select2("val","-1"),Layout.Page.container.find("#roleViewfilter").hide(),Layout.Page.container.find("#empViewfilter").show(),Layout.Page.container.find("#inactiveEmpViewfilter").hide()):"5"===Layout.Page.container.find("#fileTypeData").val()?(Layout.Page.container.find("#empViewfilter").hide(),Layout.Page.container.find("#roleViewfilter").hide(),Layout.Page.container.find("#inactiveEmpViewfilter").show()):"3"===Layout.Page.container.find("#fileTypeData").val()?($("#search_role").select2("val","-1"),Layout.Page.container.find("#empViewfilter").hide(),Layout.Page.container.find("#inactiveEmpViewfilter").hide(),Layout.Page.container.find("#roleViewfilter").show()):(Layout.Page.container.find("#empViewfilter").show(),Layout.Page.container.find("#inactiveEmpViewfilter").hide(),Layout.Page.container.find("#roleViewfilter").hide())},registerHrFilesFilter:function(){Layout.Page.container.find("#show_hide_hrfile_filter, #hrfilterdiv .ZPRdlt").each(function(){this.onclick=function(){if(Files.isIprestricted||Files.isGeorestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));else if(!Files.isIprestricted&&!Files.isGeorestricted){if(Layout.Page.container.find("#hrfilterdiv").is(":visible")){Layout.Page.container.find("#show_hide_hrfile_filter").toggleClass("sel");var addc=Layout.Page.hash.indexOf("files/fileView")>-1?"Nbar2":"Nbar5";$("#page-wrapper").addClass(addc).removeClass("Nbar2F")}else{var remc=Layout.Page.hash.indexOf("files/fileView")>-1?"Nbar2":"Nbar5";$("#page-wrapper").addClass("Nbar2F").removeClass(remc),Layout.Page.container.find("#show_hide_hrfile_filter").toggleClass("sel")}Files.openClsFilter("#show_hide_hrfile_filter"),Layout.Page.container.find("#hrfilterdiv").slideToggle(100);var searchData={};if(-1!==Layout.Page.hash.indexOf("/all")?searchData=Files.empListViewData.All[2]:-1!==Layout.Page.hash.indexOf("/sub")?searchData=Files.empListViewData.Sub[2]:-1!==Layout.Page.hash.indexOf("/my")?searchData=Files.empListViewData.My[2]:-1!==Layout.Page.hash.indexOf("/role")&&(searchData=Files.empListViewData.Role[2]),Object.keys(searchData).length>0)Layout.Page.container.find("#search_cat").find("option").remove(),Files.FilescatList("search_catlist","search_cat"),Layout.Page.container.find("#search_HFextn").select2(),Files.setSearchValuesInDiv();else{var cat_value=Layout.Page.container.find("#search_cat").val();Layout.Page.container.find("#search_cat").find("option").remove(),Files.FilescatList("search_catlist","search_cat",void 0,cat_value),Layout.Page.container.find("#search_HFextn").select2();var extnVal=Layout.Page.container.find("#search_HFextn").val();null==extnVal||void 0==extnVal||""==extnVal?Layout.Page.container.find("#search_HFextn").select2("val","-1"):Layout.Page.container.find("#search_HFextn").select2("val",extnVal)}}}}),Layout.Page.container.find("#show_hide_hrfile_filter").on("mouseover",function(){$(this).find(".IC-filter").toggleClass("sel")}),Layout.Page.container.find("#search_cat").select2(),Layout.Page.container.find("#search_role").select2(),isOrgStructureEnabled&&(ZPeople.OrgTree.showFilter(),null!=ZPeople.orgStructureTagMap&&(!0===ZPeople.orgStructureTagMap.entity&&Layout.Page.container.find("#employee_entity").parent().removeClass("DNI"),!0===ZPeople.orgStructureTagMap.unit&&Layout.Page.container.find("#employee_unit").parent().removeClass("DNI"),!0===ZPeople.orgStructureTagMap.division&&Layout.Page.container.find("#employee_division").parent().removeClass("DNI"),!0===ZPeople.orgStructureTagMap.department&&Layout.Page.container.find("#employee_department").parent().removeClass("DNI"))),!0===ZPeople.orgStructureTagMap.department&&Layout.Page.container.find("#employee_department").parent().removeClass("DNI"),Layout.Page.container.find("#hrfilterdiv").find("#search_locationHr").select2(),Files.getLocationList("search_locationHr")},hideHRFilter:function(){Layout.Page.container.find("#hrfilterdiv").hide(),Layout.Page.container.find("#show_hide_hrfile_filter").removeClass("sel"),Files.searchFileBreadcrumbs()},openClsFilter:function(id){var rmClass,addCls;Layout.Page.container.find(id).attr("class").indexOf("sel")<=-1?(rmClass="Nbar5",addCls="Nbar2F",Files.opnclsSearchBreadcrumbs("open")):(rmClass="Nbar2F",addCls="Nbar5",Files.opnclsSearchBreadcrumbs("close")),Layout.Page.container.find("div#filter").addClass("TEbnd"),$("#page-wrapper").removeClass(rmClass).addClass(addCls),-1!==Layout.Page.hash.indexOf("hrfile")&&Object.keys(Files.empListViewData.All[2]).length>0&&(Layout.Page.container.find("#search_cat").find("option").remove(),Files.FilescatList("search_catlist","search_cat",void 0),Layout.Page.container.find("#search_HFextn").select2(),Files.setSearchValuesInDiv()),-1!==Layout.Page.hash.indexOf("companyfile")&&Object.keys(Files.orgListViewData.Org[2]).length>0&&(Layout.Page.container.find("#companysearch_cat").find("option").remove(),Files.FilescatList("search_catlist","companysearch_cat"),Layout.Page.container.find("#search_CFextn").select2(),Files.setSearchValuesInDiv())},resetVals:function(){Layout.Page.container.find("#companysearch_cat").select2("val","-1"),Layout.Page.container.find("#search_cat").select2("val","-1"),Layout.Page.container.find("#companyFileViewType").select2("val","0"),Layout.Page.container.find("#search_ActEmp").select2("val","-1"),Layout.Page.container.find("#search_InactEmp").select2("val","-1"),Layout.Page.container.find("#search_role").select2("val","-1"),Layout.Page.container.find("#search_location").select2("val","-1"),Layout.Page.container.find("#search_locationHr").select2("val","-1"),Layout.Page.container.find("#companysearch_fromDate").val(""),Layout.Page.container.find("#companysearch_toDate").val(""),Layout.Page.container.find("#hrsearch_fromDate").val(""),Layout.Page.container.find("#hrsearch_toDate").val(""),Layout.Page.container.find("#search_CFname").val(""),Layout.Page.container.find("#search_CFextn").select2("val","-1"),Layout.Page.container.find("#search_HFname").val(""),Layout.Page.container.find("#search_HFextn").select2("val","-1"),-1!==Layout.Page.hash.indexOf("hrfile/all")?Layout.Page.container.find("#fileTypeData").select2("val","0"):-1!==Layout.Page.hash.indexOf("hrfile/my")?Layout.Page.container.find("#fileTypeData").select2("val","1"):-1!==Layout.Page.hash.indexOf("hrfile/sub")&&(null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!0===hasAllReporteePerm?Layout.Page.container.find("#fileTypeData").select2("val","7"):Layout.Page.container.find("#fileTypeData").select2("val","6")),Layout.Page.container.find("#personalsearch_fromDate").val(""),Layout.Page.container.find("#personalsearch_toDate").val(""),Layout.Page.container.find("#search_PFname").val(""),Layout.Page.container.find("#search_PFextn").select2("val","-1"),Layout.Page.container.find("#select_employeelisting").select2("val","-Select-"),Layout.Page.container.find("#search_PFReportsExtn").select2("val","-1"),Layout.Page.container.find("#acksearch_fromDate").val(""),Layout.Page.container.find("#acksearch_toDate").val(""),Layout.Page.container.find("#search_ackname").val(""),Layout.Page.container.find("#search_ackextn").select2("val","-1"),"#files/companyfile/listview"===Layout.Page.hash&&(Files.orgCatViewData.Org[3]=!0,Files.orgSubCatViewData.Org[3]=!0),"#files/companyfile/catview"===Layout.Page.hash&&(Files.orgListViewData.Org[3]=!0,Files.orgSubCatViewData.Org[3]=!0,Layout.Page.container.find("#companyFilesCategoryView").find(".ZPListingHdr").removeClass("expand")),-1!==Layout.Page.hash.indexOf("#files/companyfile/view")&&(Files.orgCatViewData.Org[3]=!0,Files.orgListViewData.Org[3]=!0),"#files/fileView/hrfileslistview"===Layout.Page.hash||"#files/hrfile/all/listview"===Layout.Page.hash?(Files.empCatViewData.All[3]=!0,Files.empSubCatViewData.All[3]=!0):"#files/hrfile/sub/listview"===Layout.Page.hash?(Files.empCatViewData.Sub[3]=!0,Files.empSubCatViewData.Sub[3]=!0):"#files/hrfile/my/listview"===Layout.Page.hash?(Files.empCatViewData.My[3]=!0,Files.empSubCatViewData.My[3]=!0):"#files/hrfile/role/listview"===Layout.Page.hash&&(Files.empCatViewData.Role[3]=!0,Files.empSubCatViewData.Role[3]=!0),"#files/hrfile/all/catview"===Layout.Page.hash?(Files.empListViewData.All[3]=!0,Files.empSubCatViewData.All[3]=!0,Layout.Page.container.find("#allFilesCategoryView").find(".ZPListingHdr").removeClass("expand")):"#files/hrfile/sub/catview"===Layout.Page.hash?(Files.empListViewData.Sub[3]=!0,Files.empSubCatViewData.Sub[3]=!0,Layout.Page.container.find("#subFilesCategoryView").find(".ZPListingHdr").removeClass("expand")):"#files/hrfile/my/catview"===Layout.Page.hash?(Files.empListViewData.My[3]=!0,Files.empSubCatViewData.My[3]=!0,Layout.Page.container.find("#myFilesCategoryView").find(".ZPListingHdr").removeClass("expand")):"#files/hrfile/role/catview"===Layout.Page.hash&&(Files.empListViewData.Role[3]=!0,Files.empSubCatViewData.Role[3]=!0,Layout.Page.container.find("#roleFilesCategoryView").find(".ZPListingHdr").removeClass("expand")),-1!==Layout.Page.hash.indexOf("#files/hrfile/all/view")?(Files.empCatViewData.All[3]=!0,Files.empListViewData.All[3]=!0):-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/view")?(Files.empCatViewData.Sub[3]=!0,Files.empListViewData.Sub[3]=!0):-1!==Layout.Page.hash.indexOf("#files/hrfile/my/view")?(Files.empCatViewData.My[3]=!0,Files.empListViewData.My[3]=!0):-1!==Layout.Page.hash.indexOf("#files/hrfile/role/view")&&(Files.empCatViewData.Role[3]=!0,Files.empListViewData.Role[3]=!0),isOrgStructureEnabled&&(Layout.Page.container.find("#s2id_zp_views_employeeentity").select2("val","-1"),Layout.Page.container.find("#s2id_zp_views_employeeunit").select2("val","-1"),Layout.Page.container.find("#s2id_zp_views_employeedivision").select2("val","-1"),Layout.Page.container.find("#s2id_zp_views_employeedepartment").select2("val","-1"),Layout.Page.container.find("#selectorgStructEntities").select2("val","location"),Layout.Page.container.find("#filesOrgStructure").addClass("DNI"),Layout.Page.container.find("#roleViewfilter").show()),$("#page-wrapper").removeClass("shwresult")},constructTopBar:function(fileType){var topBar="";topBar+="1"===fileType?'<div class="ZPListingHdr MT20" id="compfiles_list">':'<div class="ZPListingHdr MT20" id="hr_fileListing">',topBar+='<ul class="ZPListingUL">',-1!=loginUserRoleCheck&&(topBar+='<li class="check">',topBar+="1"===fileType?'<div class="checkbox"><input type="checkbox" id="companyfile_checkallbox" onclick="Files.checkAll(this,\'company\');"><label></label></div>':'<div class="checkbox"><input type="checkbox" id="hrfile_checkallbox" onclick="Files.checkAll(this,\'hr\');"><label></label></div>',topBar+="</li>"),"1"===fileType?(topBar+='<li class="name">'+ZPI18N.getString("zp.filename")+'<i id="CFSort1" class="sort-img" title="Sort By Descending" onclick="Files.toggleSortBy(this,\'1\')"></i></li>',topBar+='<li class="W60"></li><li>'+ZPI18N.getString("zp.reports.viewsharetitle")+"</li>"):(topBar+='<li class="name">'+ZPI18N.getString("zp.filename")+'<i id="HFSort1" class="sort-img" title="Sort By Descending" onclick="Files.toggleSortBy(this,\'0\')"></i></li>',topBar+='<li class="W60"></li><li>'+ZPI18N.getString("zp.sharedto",new Array(""))+"</li>"),topBar+="<li>"+ZPI18N.getString("zp.folder")+"</li>",topBar+="1"===fileType?"<li>"+ZPI18N.getString("zp.filemodified",new Array(""))+'<i id="CFSort3" class="sort-img" title="Sort By Descending" onclick="Files.toggleSortBy(this,\'1\')"></i></li>':"<li>"+ZPI18N.getString("zp.filemodified",new Array(""))+'<i id="HFSort3" class="sort-img" title="Sort By Descending" onclick="Files.toggleSortBy(this,\'0\')"></i></li>',topBar+='<li class="actions"></li></ul></div>',"1"===fileType?Layout.Page.container.find("#comp_fileListing").append(topBar):Layout.Page.container.find("#hr_allfileList").append(topBar);var sortEle="",sortClass="sort-d";"1"===fileType?(sortEle="CFSort"+Files.orgListViewData.Org[4],Files.orgListViewData.Org[5]||(sortClass="sort-u")):-1!==Layout.Page.hash.indexOf("hrfile/all")?(sortEle="HFSort"+Files.empListViewData.All[4],Files.empListViewData.All[5]||(sortClass="sort-u")):-1!==Layout.Page.hash.indexOf("hrfile/sub")?(sortEle="HFSort"+Files.empListViewData.Sub[4],Files.empListViewData.Sub[5]||(sortClass="sort-u")):-1!==Layout.Page.hash.indexOf("hrfile/my")?(sortEle="HFSort"+Files.empListViewData.My[4],Files.empListViewData.My[5]||(sortClass="sort-u")):-1!==Layout.Page.hash.indexOf("hrfile/role")&&(sortEle="HFSort"+Files.empListViewData.Role[4],Files.empListViewData.Role[5]||(sortClass="sort-u")),Layout.Page.container.find("#"+sortEle).addClass(sortClass)},consXMLdata:function(data){var fileUsage="",userStorageSpace="",params={action:"getFileUsage",conreqcsr:csrfToken};$.post("/zohoSignActions.zp",params,function(resultData){$.each(resultData[1],function(index,data){fileUsage=data.fileUsageSpace;var totalMbSpace="",totaldisplayName="",freespaceDisplayName="",usedspaceDisplayName="",usedSpaceCnt="";if(0==(userStorageSpace=data.userStorage)){var totalbytes=1073741824;totalMbSpace="250 MB ";var total=250;usedSpaceCnt=used=Files.truncateVal(fileUsage/1024/1024);var free=total-used;freespaceDisplayName=total===used||used>total?"0 MB ":total-used+" MB ",usedspaceDisplayName=used+" MB "}else{totaldisplayName=userStorageSpace+" GB ";totalbytes=1073741824;1!=userStorageSpace&&(totalbytes*=userStorageSpace),totalbytes,totaldisplayName=fileUsage<totalbytes?Files.truncateVal(fileUsage/1024/1024)+" MB ":Files.truncateVal(fileUsage/1073741824)+" GB ",totalMbSpace=userStorageSpace+" GB ";total="";var used="";free="";(fileUsage===totalbytes||fileUsage>totalbytes)&&(used=Files.truncateVal(fileUsage/1073741824),freespaceDisplayName="0 GB",usedspaceDisplayName=Files.truncateVal(fileUsage/1073741824)+" GB ",usedSpaceCnt=used,free=0),fileUsage<totalbytes&&(total=1024*userStorageSpace,fileUsage<1073741824&&1073741824!==fileUsage?usedspaceDisplayName=(used=Files.truncateVal(fileUsage/1024/1024))+" MB":(usedspaceDisplayName=(used=Files.truncateVal(fileUsage/1073741824))+" GB",used=1024*used*1024*1024),usedSpaceCnt=used,(free=Files.truncateVal(total-Files.truncateVal(fileUsage/1024/1024)))<1024?(totaldisplayName=free+" MB",free*=1024,freespaceDisplayName=void 0!=totaldisplayName.toString().split(".")[1]?totaldisplayName.split(".")[0]+"."+totaldisplayName.toString().split(".")[1][0]+" MB":totaldisplayName):(totaldisplayName=Files.truncateVal(free/1024)+" GB",free=1024*free*1024,freespaceDisplayName=void 0!=totaldisplayName.toString().split(".")[1]?totaldisplayName.split(".")[0]+"."+totaldisplayName.toString().split(".")[1][0]+totaldisplayName.toString().split(".")[1][1]+" GB":totaldisplayName),totalMbSpace=total<1024?userStorageSpace+" MB":userStorageSpace+" GB")}Layout.Page.container.find("#zp_page_loading").remove();new Highcharts.Chart({chart:{renderTo:"fileUsageChart",type:"pie",plotShadow:!1,spacingBottom:10,spacingTop:10,spacingLeft:30,spacingRight:10,width:460,height:400},credits:{enabled:!1},title:{text:""},tooltip:{percentageDecimals:2,pointFormat:"{point.name} ,<b>{point.percentage:.2f}%</b>"},legend:{enabled:!1},exporting:{enabled:!1,filename:"File Usage Report"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",depth:30,dataLabels:{enabled:!0,formatter:function(){return this.point.name+","+this.point.x},style:{fontWeight:"normal",fontSize:"12px",fontFamily:"Verdana, sans-serif",color:Highcharts.theme&&Highcharts.theme.contrastTextColor||"black"}}}},series:[{data:[{name:ZPI18N.getString("zp.usedSpace"),x:usedspaceDisplayName,y:Math.round(usedSpaceCnt),color:"#9cc6e5",sliced:!0},{name:ZPI18N.getString("zp.freespace"),x:freespaceDisplayName,y:Math.round(free),color:"#b2d7ad"}],startAngle:225}]});$("#totspaceCountId").html(totalMbSpace),$("#usageCountId").html(usedspaceDisplayName),$("#freeCountId").html(freespaceDisplayName)})})},truncateVal:function(num){var nAdj=Math.pow(10,2);return Math.floor(num*nAdj)/nAdj},changeOnUpload:function(filename,mode){var pageId="";if(pageId=Layout.Page.hash.indexOf("selfservice/user/files")>-1?(pageId=Layout.Page.parentContainer.parent()).find("#add_hrfileDiv").hasClass("in")?Layout.Page.parentContainer.parent().find("#add_hrfileDiv"):Layout.Page.parentContainer.parent().find("#add_personalfileDiv"):Layout.Page.hash.indexOf("/hrfile/all/view")>-1||Layout.Page.hash.indexOf("/hrfile/all/catview")>-1?Layout.Page.container.find("#add_hrfileDiv"):Layout.Page.container,"localUpload"==mode&&(filename=filename.replace("C:\\fakepath\\","")),"localUploadmultiple"==mode){if(Files.uploadMode="localUpload",Layout.Page.hash.indexOf("workflow/actions/esign/")>-1||Layout.Page.hash.indexOf("workflow/esign/add")>-1||Layout.Page.hash.indexOf("workflow/list/add")>-1||Layout.Page.hash.indexOf("workflow/list/edit")>-1||Layout.Page.hash.indexOf("workflow/esign/edit")>-1||Layout.Page.hash.indexOf("customaction/add")>-1||Layout.Page.hash.indexOf("customaction/edit")>-1){for(var fileCount=filename.length,i=0;i<fileCount;i++){var newfilename=filename[i].name,filedetails=filename[i];newfilename=newfilename.replace("C:\\fakepath\\",""),!Layout.Page.container.find(".zsign-doc").length>0&&(Layout.Page.container.find("#tempfileform").after('<div class="zsign-doc" id ="multiple_files"></div>'),$("#multiple_files").sortable(),$("#multiple_files").disableSelection()),Layout.Page.container.find(".zsign-doc").append("<span><b>"+ZSEC.Encoder.encodeForHTML(newfilename)+'</b><i class="IC-cls" onclick = "Files.deleteSelection(this)"></i></span>');for(var multiplefiles=Layout.Page.container.find(".zsign-doc").find("span"),multiplefilesDetails=Layout.Page.container.find(".zsign-doc").find("span").find("b"),j=0,l=multiplefiles.length;j<l;j++)""!=!multiplefiles[j].getAttribute("id")&&multiplefilesDetails[j].innerText==newfilename&&Layout.Page.container.find(multiplefiles[j]).data("filedetails",filedetails)}Zohosign.clearFileUpload()}}else if("cloudmultipleUpload"==mode){if(!$.isEmptyObject(filename)&&(Files.uploadedDocObj=filename.values,Layout.Page.hash.indexOf("workflow/actions/esign/")>-1||Layout.Page.hash.indexOf("admin/automation/workflow")>-1||Layout.Page.hash.indexOf("workflow/esign/add")>-1||Layout.Page.hash.indexOf("workflow/list/add")>-1||Layout.Page.hash.indexOf("workflow/list/edit")>-1||Layout.Page.hash.indexOf("workflow/esign/edit")>-1||Layout.Page.hash.indexOf("customaction/add")>-1||Layout.Page.hash.indexOf("customaction/edit")>-1)){var recordCount;if(void 0==filename.values){var filenamedup=[];filenamedup.values=[],filenamedup.values.push(filename),filename=filenamedup,recordCount=1}else recordCount=Object.keys(filename.values).length;for(var r=0;r<recordCount;r++){var docid=filename.values[r].docId,docDispName=decodeURIComponent(filename.values[r].docName);filename.values[r].docName=docDispName,!Layout.Page.container.find(".zsign-doc").length>0&&(Layout.Page.container.find("#tempfileform").after('<div class="zsign-doc" id ="multiple_files"></div>'),$("#multiple_files").sortable(),$("#multiple_files").disableSelection()),Layout.Page.container.find(".zsign-doc").append("<span><b>"+ZSEC.Encoder.encodeForHTML(docDispName)+'</b><i class="IC-cls" onclick = "Files.deleteSelection(this)"></i></span>');for(multiplefiles=Layout.Page.container.find(".zsign-doc").find("span"),multiplefilesDetails=Layout.Page.container.find(".zsign-doc").find("span").find("b"),j=0,l=multiplefiles.length;j<l;j++)""!=!multiplefiles[j].getAttribute("id")&&multiplefilesDetails[j].innerText==docDispName&&(Layout.Page.container.find(multiplefiles[j]).data("docid",docid),Layout.Page.container.find(multiplefiles[j]).data("cloudfileDetails",JSON.stringify(filename.values[r])))}Zohosign.clearFileUpload()}}else pageId.find("#drop_file span").text(filename),pageId.find("#fileName").val(filename),Files.uploadMode=mode,""!==filename&&$("#errormsg").remove(),pageId.find("#beforeUpload").hasClass("DN")||pageId.find("#beforeUpload").toggleClass("DN"),pageId.find("#afterUpload").hasClass("DN")&&pageId.find("#afterUpload").toggleClass("DN")},deleteSelection:function(obj,flag){if(flag){if(Zohosign.isfromOrgFiles){var id=$(obj).parent().attr("id");Layout.Page.container.find("#zsignEmpSel").find("div#"+id).remove();var allSelectedIds=Layout.Page.container.find("#signFileDivInput").attr("selectedids"),result=allSelectedIds.split(",");0==allSelectedIds.indexOf(id)?result.length>1&&(id+=","):id=","+id,allSelectedIds=allSelectedIds.replace(id,""),Layout.Page.container.find("#signFileDivInput").attr("selectedids",allSelectedIds)}else if(Layout.Page.hash.indexOf("workflow/actions/esign/add")>-1||Layout.Page.hash.indexOf("workflow/list/edit")>-1||Layout.Page.hash.indexOf("workflow/actions/esign/edit")>-1||Layout.Page.hash.indexOf("customaction/add")>-1||Layout.Page.hash.indexOf("customaction/edit")>-1){var len=Layout.Page.container.find(".zsign-doc").find("span").find("b").toArray(),lenparent=Layout.Page.container.find(".zsign-doc").find("span").toArray();for(i in len)len[i].innerText==obj.innerText&&lenparent[i].remove()}}else Layout.Page.container.find(obj).parent().remove()},toggleFileFieldDisplay:function(){Files.udsParams.fileId="-1",Files.udsParams.fileVersion="",Layout.Page.container.find("#beforeUpload,#afterUpload").toggleClass("DN"),Layout.Page.container.find("input[id=uploadfile]:visible").val(""),Layout.Page.container.find("#fileName").val(""),Files.uploadMode="",Files.uploadedDocObj={},Layout.Page.container.find("#folderImp").parent().parent().hasClass("DN")&&Layout.Page.container.find("#folderImp").parent().parent().removeClass("DN"),UDS_UPLOAD_IS_ACTIVE&&progressJs("div[data-progressjs='uploadfile']").kill()},showWorkDriveModal:function(workDriveOrigin,fcId,ele,isImage){if(0==$("head").find('script[src="'+ZPeople.STATIC_CDN+'/personal/stable/jsapps/workdrive-third-party/workdrive-frame-sdk.js"]').length){var script=document.createElement("script");return script.type="text/javascript",script.readyState?script.onreadystatechange=function(){"loaded"!==script.readyState&&"complete"!==script.readyState||(script.onreadystatechange=null,Files.showWorkDriveModal(workDriveOrigin,fcId,ele,isImage))}:script.onload=function(){Files.showWorkDriveModal(workDriveOrigin,fcId,ele,isImage)},script.src=ZPeople.STATIC_CDN+"/personal/stable/jsapps/workdrive-third-party/workdrive-frame-sdk.js",void document.head.appendChild(script)}rowNum="1","true"==$(ele).closest("[istabular]").attr("istabular")&&("true"==$(ele).closest("[isgrid]").attr("isgrid")?rowNum=$(ele).closest('[id="zp_tabular_row"]').attr("row"):rowNum=$(ele).closest('[isgrid="false"]').attr("row"));var workdriveinstance=new WorkDrive,Options={service:"zohopeople"};Options.WDDomainURL=workDriveUrl,Options.height="75%",Options.width="50%",Options.responseCallBack=Files.saveWorkDrive,Options.showCloseIcon=!0,Options.canShare=!0,"fileimport"==workDriveOrigin?Options.countToSelectMaxFiles=50:"TTProjectDashBoard"==workDriveOrigin&&(Options.countToSelectMaxFiles=5);var shareOptions={showshareDialog:!0},shareFields={collaboratorShare:!1,teamShare:!0,orgShare:!0};shareFields.externalShare=null==isImage||void 0===isImage||"true"!=isImage||"Forms"!==workDriveOrigin,shareFields.linkOnly=!0,shareOptions.shareFields=shareFields,shareOptions.defaultShare="teamShare",Options.shareOptions=shareOptions;var obj={};obj.workDriveOrigin=workDriveOrigin,obj.fcId=fcId,Options.handBackObj=obj,Options.componentType="pick",workdriveinstance.loadPicker(Options)},saveWorkDrive:function(object){$("body").find("#zp_upload_wd").removeClass("active");var filesModel=(object=JSON.parse(JSON.stringify(object))).callbackDataFromWorkDrive.fileModel[0],docDispName=filesModel.name,obj={};obj.type=filesModel.type,obj.fileName=docDispName,Files.uploadMode="workDriveUpload",obj.permalink=object.callbackDataFromWorkDrive.permissionModel[0].link;var origin=object.callbackDataFromWorkDrive.handbackobj.workDriveOrigin;if("Forms"===origin){var fcId=object.callbackDataFromWorkDrive.handbackobj.fcId,labelName=Layout.Page.container.find("#zp_field_outer_"+fcId).attr("folabel");if(ZPForm.FORM_COMPONENTS[fcId].fieldType!==ZPForm.Field.IMAGE||ZPUtil.isAllowedFormatForImage(docDispName))obj.labelName=labelName,obj.rowNum=rowNum,ZPForm.Field.removeFileUploadDoc(labelName,rowNum),ZPForm.FORMFILEUPLOAD.push(obj),Layout.Page.container.find("[row="+rowNum+"]").find("#zp_field_outer_"+fcId).find("#afterUpload").html('<div><span></span><i class="IC-cls-1px" onclick="ZPForm.Field.toggleFileFieldDisplay(this, \''+labelName+"')\"></i></div>"),Layout.Page.container.find("[row="+rowNum+"]").find("#zp_field_outer_"+fcId).find("#afterUpload div span").text(docDispName),Layout.Page.container.find("[row="+rowNum+"]").find("#zp_field_outer_"+fcId).find("#beforeUpload,#afterUpload").toggleClass("DN");else{var errors={};errors[labelName]=ZPI18N.getString("zp.allowedimagetypes"),errors.row=rowNum,ZPForm.Field.markFieldAsError(labelName,errors)}}else if("AddHRCase"===origin||"AddFAQFiles"===origin)Files.uploadedDocObj=obj,obj.labelName="AddHRCase"===object.callbackDataFromWorkDrive.handbackobj.workDriveOrigin?HRCases.HRCASE_FILEUPLOAD_LABELNAME:HRCases.FAQ_FILEUPLOAD_LABELNAME,HRCaseFileTag.addFileTag(docDispName,obj,origin);else if("HRCategory"===origin)Files.uploadedDocObj=obj,HRCategory.ConfigureCategory.setFileDetails(JSON.stringify(obj),docDispName,HRCategory.calledObject,Files.uploadMode);else if("fileimport"===origin){for(var mainObj=Layout.Page.container.find("div#import_hrfileDiv"),filesList=object.callbackDataFromWorkDrive.fileModel,importarray=[],i=0;i<filesList.length;i++){(importobj={}).fileName=filesList[i].name,importobj.permalink=obj.permalink,importarray.push(importobj)}Files.importWDarray=importarray;var len=object.callbackDataFromWorkDrive.fileModel.length;mainObj.find("#importFileName").empty().text(len+" Files"),mainObj.find("#beforeUpload").hasClass("DN")||mainObj.find("#beforeUpload").toggleClass("DN"),mainObj.find("#afterUpload").hasClass("DN")&&mainObj.find("#afterUpload").toggleClass("DN"),mainObj.find("#folderImp").parent().parent().addClass("DN")}else if("TTProjectDashBoard"===origin){mainObj=Layout.Page.container.find("div#import_hrfileDiv"),filesList=object.callbackDataFromWorkDrive.permissionModel;var fileArray=[];for(i=0;i<filesList.length;i++){(importobj={}).name=filesList[i].fileName,importobj.filePath=filesList[i].link,fileArray.push(importobj)}Timetracker.projectDashboard.DashboardAttachments.setSelectedAttachments(!1,fileArray)}else if("TT_Timesheets"===origin){var importobj;(importobj={}).name=obj.fileName,importobj.filePath=obj.permalink,Timetracker.util.addFileNameAttachment(importobj,"workDriveUpload")}else{if("Leave"==origin)return void LeaveComponents.API.FilePicker.wdHandler.onPick(obj);Files.uploadedDocObj=obj,Files.changeOnUpload(docDispName,"workDriveUpload")}},openWDFiles:function(obj,isOnboarding){var url;url=isOnboarding?obj.filePath:Layout.Page.container.find(obj).parent().data().ldata.filePath,window.open(url)},showCloudPickerModal:function(cloudPickerUrl,cloudUploadOrigin,ele,fcId){Files.cloudpickerFCID=fcId,rowNum="1","true"==$(ele).closest("[istabular]").attr("istabular")&&("true"==$(ele).closest("[isgrid]").attr("isgrid")?rowNum=$(ele).closest('[id="zp_tabular_row"]').attr("row"):rowNum=$(ele).closest('[isgrid="false"]').attr("row")),this.cloudUploadOrigin=cloudUploadOrigin;var pageId=!ZPForm.isEmbedForm&&Layout.Page.hash.indexOf("selfservice/user/files")>-1?Layout.Page.parentContainer.parent():Layout.Page.container;if(0==pageId.find("#zp_upload_from_cloud").length){var modal='<div class="modal modal-import fade ZPsecModal" id="zp_upload_from_cloud" aria-labelledby="modal"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><a data-dismiss="modal" class="IC-cls-1px red close" onclick="Files.hideCloudPickerModal()"></a><h4 class="modal-title">Upload Logo</h4></div><div class="modal-body"><iframe frameborder="0" style="width:100%;height:530px;" src=""></iframe></div></div></div></div>';ZPForm.isEmbedForm?($("body").append(modal),$("#zp_upload_from_cloud .modal-header h4").text("Upload from cloud services")):(pageId.append(modal),pageId.find("#zp_upload_from_cloud .modal-header h4").text("Upload from cloud services"))}ZPForm.isEmbedForm?($("#zp_upload_from_cloud .modal-body iframe").attr("src",cloudPickerUrl),$("#zp_upload_from_cloud").modal("show")):(pageId.find("#zp_upload_from_cloud .modal-body iframe").attr("src",cloudPickerUrl),pageId.find("#zp_upload_from_cloud").modal("show")),window.addEventListener("message",Files.cloudPickercallBack)},cloudPickercallBack:function(e){if(e.origin===gadgetsUrl){var data=e.data;if("closePicker"===data)return void Files.hideCloudPickerModal();var DataModelProviders={ZOHODOCS:"zohodocs",GDRIVE:"gdrive",DROPBOX:"dropbox",EVERNOTE:"evernote",BOX:"box",OFFICE365:"office365",ONEDRIVE:"onedrive"},docObj={},totalFiles=0,uploadedDocObj={};if(void 0!=data.doc&&(docObj=data.doc),void 0!=data.totalFiles){if(1===(totalFiles=data.totalFiles)&&void 0!=data.doc){if(void 0!=docObj[DataModelProviders.GDRIVE].accountId)(uploadedDocObj=docObj[DataModelProviders.GDRIVE].files[0]).accountId=docObj[DataModelProviders.GDRIVE].accountId,uploadedDocObj.provider=DataModelProviders.GDRIVE;else if(void 0!=docObj[DataModelProviders.DROPBOX].accountId)(uploadedDocObj=docObj[DataModelProviders.DROPBOX].files[0]).accountId=docObj[DataModelProviders.DROPBOX].accountId,uploadedDocObj.provider=DataModelProviders.DROPBOX;else if(void 0!=docObj[DataModelProviders.EVERNOTE].accountId)(uploadedDocObj=docObj[DataModelProviders.EVERNOTE].files[0]).accountId=docObj[DataModelProviders.EVERNOTE].accountId,uploadedDocObj.provider=DataModelProviders.EVERNOTE;else if(void 0!=docObj[DataModelProviders.BOX].accountId)(uploadedDocObj=docObj[DataModelProviders.BOX].files[0]).accountId=docObj[DataModelProviders.BOX].accountId,uploadedDocObj.provider=DataModelProviders.BOX;else if(void 0!=docObj[DataModelProviders.ONEDRIVE].accountId){var files=docObj[DataModelProviders.ONEDRIVE].files[0];uploadedDocObj.accountId=docObj[DataModelProviders.ONEDRIVE].accountId,uploadedDocObj.docId=files.id,uploadedDocObj.docName=files.name,uploadedDocObj.mimeType=files.file.mimeType,uploadedDocObj.provider=DataModelProviders.ONEDRIVE}var docName=uploadedDocObj.docName,docType=void 0!=uploadedDocObj.docType?uploadedDocObj.docType:"";docName.indexOf(".")<0&&("document"===docType||"writer"===docType?docName+=".docx":"presentation"===docType||"zohoshow"===docType?docName+=".pptx":"spreadsheet"===docType||"zohosheet"===docType?docName+=".xlsx":"pdf"===docType&&(docName+=".pdf")),uploadedDocObj.docName=docName}else if(totalFiles>1&&void 0!=data.doc){var uploadedDocObjarray=[],fileIndex=0;void 0!=docObj[DataModelProviders.GDRIVE].accountId&&$.each(docObj[DataModelProviders.GDRIVE].files,function(ind,files){uploadedDocObjarray[fileIndex]=files,uploadedDocObjarray[fileIndex].accountId=docObj[DataModelProviders.GDRIVE].accountId,uploadedDocObjarray=Files.cloudPickerFileType(uploadedDocObjarray,fileIndex,DataModelProviders.GDRIVE),fileIndex+=1}),void 0!=docObj[DataModelProviders.DROPBOX].accountId&&$.each(docObj[DataModelProviders.DROPBOX].files,function(ind,files){uploadedDocObjarray[fileIndex]=files,uploadedDocObjarray[fileIndex].accountId=docObj[DataModelProviders.DROPBOX].accountId,uploadedDocObjarray=Files.cloudPickerFileType(uploadedDocObjarray,fileIndex,DataModelProviders.DROPBOX),fileIndex+=1}),void 0!=docObj[DataModelProviders.EVERNOTE].accountId&&$.each(docObj[DataModelProviders.EVERNOTE].files,function(ind,files){uploadedDocObjarray[fileIndex]=files,uploadedDocObjarray[fileIndex].accountId=docObj[DataModelProviders.EVERNOTE].accountId,uploadedDocObjarray=Files.cloudPickerFileType(uploadedDocObjarray,fileIndex,DataModelProviders.EVERNOTE),fileIndex+=1}),void 0!=docObj[DataModelProviders.BOX].accountId&&$.each(docObj[DataModelProviders.BOX].files,function(ind,files){uploadedDocObjarray[fileIndex]=files,uploadedDocObjarray[fileIndex].accountId=docObj[DataModelProviders.BOX].accountId,uploadedDocObjarray=Files.cloudPickerFileType(uploadedDocObjarray,fileIndex,DataModelProviders.BOX),fileIndex+=1}),void 0!=docObj[DataModelProviders.ONEDRIVE].accountId&&$.each(docObj[DataModelProviders.ONEDRIVE].files,function(ind,files){uploadedDocObjarray[fileIndex]={},uploadedDocObjarray[fileIndex].accountId=docObj[DataModelProviders.ONEDRIVE].accountId,uploadedDocObjarray[fileIndex].docId=files.id,uploadedDocObjarray[fileIndex].docName=files.name,uploadedDocObjarray[fileIndex].mimeType=files.file.mimeType,uploadedDocObjarray=Files.cloudPickerFileType(uploadedDocObjarray,fileIndex,DataModelProviders.ONEDRIVE),fileIndex+=1}),uploadedDocObj.values=uploadedDocObjarray}Files.saveCloudPickerDocDetails(JSON.stringify(uploadedDocObj),Files.cloudpickerFCID)}}},cloudPickerFileType:function(uploadedDocObj,value,source){var docNames=uploadedDocObj[value],docName=docNames.docName,docType=void 0!=docNames.docType?docNames.docType:"";return docName.indexOf(".")<0&&("document"==docType||"writer"==docType?docName+=".docx":"presentation"==docType||"zohoshow"==docType?docName+=".pptx":"spreadsheet"==docType||"zohosheet"==docType?docName+=".xlsx":"pdf"==docType&&(docName+=".pdf")),uploadedDocObj[value].provider=source,uploadedDocObj[value].docName=docName,uploadedDocObj},hideCloudPickerModal:function(){var pageId=!ZPForm.isEmbedForm&&Layout.Page.hash.indexOf("selfservice/user/files")>-1?Layout.Page.parentContainer.parent():Layout.Page.container;ZPForm.isEmbedForm?($("#zp_upload_from_cloud .modal-body iframe").attr("src",""),$("#zp_upload_from_cloud").modal("hide"),ZPForm.LAYOUT.show()):(pageId.find("#zp_upload_from_cloud .modal-body iframe").attr("src",""),pageId.find("#zp_upload_from_cloud").modal("hide")),window.removeEventListener("message",Files.cloudPickercallBack)},saveCloudPickerDocDetails:function(docObj,fcId){if(Files.hideCloudPickerModal(),"gdrive"!=(docObj=JSON.parse(docObj)).provider||void 0==docObj.mimeType||"application/vnd.google-apps.folder"!=docObj.mimeType){Files.uploadedDocObj=docObj;var docDispName=decodeURIComponent(docObj.docName);if("Forms"===this.cloudUploadOrigin){var labelName=Layout.Page.container.find("#zp_field_outer_"+fcId).attr("folabel");if(ZPForm.FORM_COMPONENTS[fcId].fieldType!==ZPForm.Field.IMAGE||ZPUtil.isAllowedFormatForImage(docDispName))docObj.labelName=labelName,docObj.rowNum=rowNum,ZPForm.Field.removeFileUploadDoc(labelName,rowNum),ZPForm.FORMFILEUPLOAD.push(docObj),Files.uploadMode="cloudUpload",Layout.Page.container.find("[row="+rowNum+"]").find("#zp_field_outer_"+fcId).find("#afterUpload").html('<div><span></span><i class="IC-cls-1px" onclick="ZPForm.Field.toggleFileFieldDisplay(this, \''+labelName+"')\"></i></div>"),Layout.Page.container.find("[row="+rowNum+"]").find("#zp_field_outer_"+fcId).find("#afterUpload div span").text(docDispName),Layout.Page.container.find("[row="+rowNum+"]").find("#zp_field_outer_"+fcId).find("#beforeUpload,#afterUpload").toggleClass("DN");else{var errors={};errors[labelName]=ZPI18N.getString("zp.allowedimagetypes"),errors.row=rowNum,ZPForm.Field.markFieldAsError(labelName,errors)}}else if("HRCase"===this.cloudUploadOrigin)Files.uploadMode="cloudUpload",Layout.Page.container.find("#afterUpload").empty().append('<div id="addedFile" class="zp_Tg"><span>'+docDispName+'</span><i class="IC-cls" onclick="HRCatalogList.removeTag(this)"></i></div>'),Layout.Page.container.find("#afterUpload #addedFile").last().data("uploadedFile",docObj);else{if("AddHRCase"===this.cloudUploadOrigin||"AddFAQFiles"===this.cloudUploadOrigin)return Files.uploadMode="cloudUpload",docObj.labelName="AddHRCase"===this.cloudUploadOrigin?HRCases.HRCASE_FILEUPLOAD_LABELNAME:HRCases.FAQ_FILEUPLOAD_LABELNAME,void HRCaseFileTag.addFileTag(docDispName,docObj,this.cloudUploadOrigin);if("HRCategory"===this.cloudUploadOrigin)Files.uploadMode="cloudUpload",HRCategory.ConfigureCategory.setFileDetails(JSON.stringify(docObj),docDispName,HRCategory.calledObject,Files.uploadMode);else if("TEMPLATE"===this.cloudUploadOrigin)TemplateCommon.changeOnUpload(docDispName,"cloudUpload");else if("ZohoSign"==this.cloudUploadOrigin&&(Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("admin/automation/workflow")>-1||Layout.Page.hash.indexOf("workflow/list/edit")>-1||Layout.Page.hash.indexOf("workflow/list/add")>-1||Layout.Page.hash.indexOf("workflow/esign/add")>-1||Layout.Page.hash.indexOf("workflow/esign/edit")>-1||Layout.Page.hash.indexOf("customaction/add")>-1||Layout.Page.hash.indexOf("customaction/edit")>-1))Files.changeOnUpload(docObj,"cloudmultipleUpload");else if("LMS"==this.cloudUploadOrigin)lmsfileaction.cloudUploadHandler(docObj,lmsfileaction.activeCloudObject);else if("TT_Projects"==this.cloudUploadOrigin)docObj.docName=docDispName,Timetracker.projectDashboard.DashboardAttachments.setSelectedAttachments(docObj);else if("TT_Timesheets"==this.cloudUploadOrigin)docObj.docName=docDispName,Timetracker.util.addFileNameAttachment(docObj,"cloudUpload");else if("Leave"==this.cloudUploadOrigin)docObj.docName=docDispName,LeaveComponents.API.FilePicker.cloudHandler.onPick(docObj);else{if("addreopenfile"==this.cloudUploadOrigin)return Files.uploadMode="cloudUpload",void ZPOnboarding.addFileTag(docDispName,docObj,this.cloudUploadOrigin);Files.changeOnUpload(docDispName,"cloudUpload")}}}else ZPeople.Message.showWarningMsg("Folder upload not supported. Please choose a valid file")},searchCatView:function(fileType){"1"===fileType?(Files.searchCompanyFiles(void 0,void 0),Files.orgCatViewData.Org[0]=0,Files.orgCatViewData.Org[1]=!0,Layout.Page.container.find("#companyFilesCategoryView").find("#CFCatView").html(""),Files.orgListViewData.Org[3]=!0,Files.orgSubCatViewData.Org[3]=!0):"0"===fileType&&(Files.searchHrFiles(void 0,void 0),"#files/hrfile/all/catview"===Layout.Page.hash?(Files.empCatViewData.All[0]=0,Files.empCatViewData.All[1]=!0,Layout.Page.container.find("#allFilesCategoryView").find("#HFCatView").html(""),Files.empListViewData.All[3]=!0,Files.empSubCatViewData.All[3]=!0,"0"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck&&2!=loginUserRoleCheck||(Layout.Page.container.find("#activeEmpSearch").show(),Layout.Page.container.find("#inactiveEmpSearch").hide(),Layout.Page.container.find("#logDisEmpSearch").hide(),Layout.Page.container.find("#roleBasedHeader").hide(),Layout.Page.container.find("#roleViewfilter").hide())),-1!==Layout.Page.hash.indexOf("#files/hrfile/sub")&&("7"===Layout.Page.container.find("#fileTypeData").val()?(Layout.Page.container.find("#allsubEmpSearch").show(),Layout.Page.container.find("#subEmpSearch").hide()):("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&(Layout.Page.container.find("#subEmpSearch").show(),Layout.Page.container.find("#allsubEmpSearch").hide())),"3"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(Layout.Page.container.find("#activeEmpSearch").hide(),Layout.Page.container.find("#inactiveEmpSearch").hide(),Layout.Page.container.find("#logDisEmpSearch").hide(),Layout.Page.container.find("#roleBasedHeader").show(),Layout.Page.container.find("#roleViewfilter").show())),"5"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(Layout.Page.container.find("#activeEmpSearch").hide(),Layout.Page.container.find("#inactiveEmpSearch").show(),Layout.Page.container.find("#logDisEmpSearch").hide(),Layout.Page.container.find("#roleBasedHeader").hide(),Layout.Page.container.find("#roleViewfilter").hide())),"8"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(Layout.Page.container.find("#activeEmpSearch").hide(),Layout.Page.container.find("#inactiveEmpSearch").hide(),Layout.Page.container.find("#logDisEmpSearch").show(),Layout.Page.container.find("#roleBasedHeader").hide(),Layout.Page.container.find("#roleViewfilter").hide()))):"#files/hrfile/sub/catview"===Layout.Page.hash?(Files.empCatViewData.Sub[0]=0,Files.empCatViewData.Sub[1]=!0,Layout.Page.container.find("#subFilesCategoryView").find("#HFCatView").html(""),Files.empListViewData.Sub[3]=!0,Files.empSubCatViewData.Sub[3]=!0):"#files/hrfile/my/catview"===Layout.Page.hash?(Files.empCatViewData.My[0]=0,Files.empCatViewData.My[1]=!0,Layout.Page.container.find("#myFilesCategoryView").find("#HFCatView").html(""),Files.empListViewData.My[3]=!0,Files.empSubCatViewData.My[3]=!0):"#files/hrfile/role/catview"===Layout.Page.hash&&(Files.empCatViewData.Role[0]=0,Files.empCatViewData.Role[1]=!0,Layout.Page.container.find("#roleFilesCategoryView").find("#HFCatView").html(""),Files.empListViewData.Role[3]=!0,Files.empSubCatViewData.Role[3]=!0)),Files.showCategoryView()},fetchCategoryListing:function(){"#files/companyfile/catview"===Layout.Page.hash?0===Files.orgCatViewData.Org[0]&&(Layout.Page.container.find("#companyFilesCategoryView").hide(),Layout.Page.container.find("#loadingGridDiv").show(),Layout.Page.container.find("#loadingGridDiv").html(ZPeople.LOADING_HTML),Files.getLocationList(),Files.FilescatList("search_catlist","companysearch_cat"),Layout.Page.container.find("#search_CFextn").select2(),Files.showCategoryView()):-1!==Layout.Page.hash.indexOf("/hrfile")&&(Files.FilescatList("search_catlist","search_cat"),Layout.Page.container.find("#search_HFextn").select2(),Files.constructemp_addrev("activeEmp"),-1!==Layout.Page.hash.indexOf("hrfile/all/catview")&&0===Files.empCatViewData.All[0]?(Layout.Page.container.find("#allFilesCategoryView").hide(),Layout.Page.container.find("#loadingGridDiv").show(),Layout.Page.container.find("#loadingGridDiv").html(ZPeople.LOADING_HTML),Files.showCategoryView()):-1!==Layout.Page.hash.indexOf("hrfile/sub/catview")&&0===Files.empCatViewData.Sub[0]?(Layout.Page.container.find("#subFilesCategoryView").hide(),Layout.Page.container.find("#loadingGridDiv").show(),Layout.Page.container.find("#loadingGridDiv").html(ZPeople.LOADING_HTML),Files.showCategoryView()):-1!==Layout.Page.hash.indexOf("hrfile/my/catview")&&0===Files.empCatViewData.My[0]?(Layout.Page.container.find("#myFilesCategoryView").hide(),Layout.Page.container.find("#loadingGridDiv").show(),Layout.Page.container.find("#loadingGridDiv").html(ZPeople.LOADING_HTML),Files.showCategoryView()):-1!==Layout.Page.hash.indexOf("hrfile/role/catview")&&0===Files.empCatViewData.Role[0]&&(Layout.Page.container.find("#roleFilesCategoryView").hide(),Layout.Page.container.find("#loadingGridDiv").show(),Layout.Page.container.find("#loadingGridDiv").html(ZPeople.LOADING_HTML),Files.showCategoryView()))},showCategoryView:function(obj,mode,msg,newcat,editFileId){if(Layout.Page.container.find("#loadingGridDiv").hide(),"add"===obj&&("#files/companyfile/catview"===Layout.Page.hash?(Files.orgCatViewData.Org[0]=0,Files.orgCatViewData.Org[1]=!0,Layout.Page.container.find("#companyFilesCategoryView").find("#CFCatView").html("")):"#files/hrfile/all/catview"===Layout.Page.hash?(Files.empCatViewData.All[0]=0,Files.empCatViewData.All[1]=!0,Layout.Page.container.find("#allFilesCategoryView").find("#HFCatView").html("")):"#files/hrfile/sub/catview"===Layout.Page.hash?(Files.empCatViewData.Sub[0]=0,Files.empCatViewData.Sub[1]=!0,Layout.Page.container.find("#subFilesCategoryView").find("#HFCatView").html("")):"#files/hrfile/my/catview"===Layout.Page.hash?(Files.empCatViewData.My[0]=0,Files.empCatViewData.My[1]=!0,Layout.Page.container.find("#myFilesCategoryView").find("#HFCatView").html("")):"#files/hrfile/role/catview"===Layout.Page.hash&&(Files.empCatViewData.Role[0]=0,Files.empCatViewData.Role[1]=!0,Layout.Page.container.find("#roleFilesCategoryView").find("#HFCatView").html(""))),"Sucess"===msg)"0"!==editFileId?ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatefile")):ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.addfile"));else if("imported"===msg)ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.filesimported"));else if("Error"==msg)return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.invalidmsg"));var fileType="",filterBy="",isExpiredFilesView=!1,startIndex=0,params={methodName:"getGridView",conreqcsr:csrfToken};"#files/companyfile/catview"===Layout.Page.hash&&0!==Object.keys(Files.orgListViewData.Org[2]).length?(fileType="1",(params=Files.orgListViewData.Org[2]).methodName="getGridView",params.start=Files.orgCatViewData.Org[0],Files.orgListViewData.Org[2]=params,Files.hideCompanyFilter()):"#files/hrfile/all/catview"===Layout.Page.hash&&0!==Object.keys(Files.empListViewData.All[2]).length?(fileType="0",(params=Files.empListViewData.All[2]).methodName="getGridView",params.start=Files.empCatViewData.All[0],Files.empListViewData.All[2]=params,Files.hideHRFilter(),Files.searchFileBreadcrumbs()):"#files/hrfile/sub/catview"===Layout.Page.hash&&0!==Object.keys(Files.empListViewData.Sub[2]).length?(fileType="0",(params=Files.empListViewData.Sub[2]).methodName="getGridView",params.start=Files.empCatViewData.Sub[0],Files.empListViewData.Sub[2]=params,Files.hideHRFilter(),Files.searchFileBreadcrumbs()):"#files/hrfile/my/catview"===Layout.Page.hash&&0!==Object.keys(Files.empListViewData.My[2]).length?(fileType="0",(params=Files.empListViewData.My[2]).methodName="getGridView",params.start=Files.empCatViewData.My[0],Files.empListViewData.My[2]=params,Files.hideHRFilter(),Files.searchFileBreadcrumbs()):"#files/hrfile/role/catview"===Layout.Page.hash&&0!==Object.keys(Files.empListViewData.Role[2]).length?(fileType="0",(params=Files.empListViewData.Role[2]).methodName="getGridView",params.start=Files.empCatViewData.Role[0],Files.empListViewData.Role[2]=params,Files.hideHRFilter(),Files.searchFileBreadcrumbs()):("#files/companyfile/catview"===Layout.Page.hash||-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?(fileType="1","0"===Layout.Page.container.find("#companyFileViewType").val()?isExpiredFilesView=!1:"1"===Layout.Page.container.find("#companyFileViewType").val()&&(isExpiredFilesView=!0),startIndex=Files.orgCatViewData.Org[0],params.isExpiredFilesView=isExpiredFilesView):"#files/hrfile/all/catview"===Layout.Page.hash?(fileType="0","0"===Layout.Page.container.find("#fileTypeData").val()?filterBy="all":"3"===Layout.Page.container.find("#fileTypeData").val()?filterBy="allrole":"5"===Layout.Page.container.find("#fileTypeData").val()&&(filterBy="inactiveemp"),startIndex=Files.empCatViewData.All[0],params.filterBy=filterBy):"#files/hrfile/sub/catview"===Layout.Page.hash?(fileType="0",startIndex=Files.empCatViewData.Sub[0],"7"===Layout.Page.container.find("#fileTypeData").val()?(params.filterBy="allsubordinates",Layout.Page.container.find("#allsubEmpSearch").show(),Layout.Page.container.find("#subEmpSearch").hide()):("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&(params.filterBy="subordinates",Layout.Page.container.find("#allsubEmpSearch").hide(),Layout.Page.container.find("#subEmpSearch").show())):"#files/hrfile/my/catview"===Layout.Page.hash?(fileType="0",filterBy="my",startIndex=Files.empCatViewData.My[0],params.filterBy=filterBy):"#files/hrfile/role/catview"===Layout.Page.hash&&(fileType="0",filterBy="myrole",startIndex=Files.empCatViewData.Role[0],params.filterBy=filterBy),params.fileType=fileType,params.start=startIndex,Files.setLatitudeLongitude(params)),"#files/companyfile/catview"===Layout.Page.hash&&Files.searchFileBreadcrumbs(),Files.setSearchEmpData();var pageLoaded=!1,isBlocked=!1,isNewCat=!(!newcat&&Files.isCachedCat);isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position?(navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,"1"===fileType?Files.foundLocation(position,Files.ACTION.COMPANY_FILE,params,mode,isNewCat):Files.foundLocation(position,Files.ACTION.HR_FILE,params,mode,isNewCat)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),"1"===fileType?Files.foundLocation("block",Files.ACTION.COMPANY_FILE,params,mode,isNewCat):Files.foundLocation("block",Files.ACTION.HR_FILE,params,mode,isNewCat)}),$(document).on("click",function(e){Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||$(e.target).text()===ZPI18N.getString("zp.search")||void 0===$(e.target)||-1!==$(e.target).attr("class").indexOf("select2")||(pageLoaded=!0,"1"===fileType?Files.foundLocation("",Files.ACTION.COMPANY_FILE,mode,isNewCat):Files.foundLocation("",Files.ACTION.HR_FILE,mode,isNewCat))})):"1"===fileType?Files.foundLocation("",Files.ACTION.COMPANY_FILE,params,mode,isNewCat):Files.foundLocation("",Files.ACTION.HR_FILE,params,mode,isNewCat)},getCatViewCallBack:function(resultData,params,otherDtls){if(resultData.hasOwnProperty("fail")){var pageId="";"#files/companyfile/catview"===Layout.Page.hash&&(Layout.Page.container.find("#companyFilesCategoryView").show(),pageId=Layout.Page.container.find("#companyFilesCategoryView").find(".Scrcont")),"#files/hrfile/all/catview"===Layout.Page.hash?(Layout.Page.container.find("#allFilesCategoryView").show(),pageId=Layout.Page.container.find("#allFilesCategoryView").find(".Scrcont")):"#files/hrfile/sub/catview"===Layout.Page.hash?(Layout.Page.container.find("#subFilesCategoryView").show(),pageId=Layout.Page.container.find("#subFilesCategoryView").find(".Scrcont")):"#files/hrfile/my/catview"===Layout.Page.hash?(Layout.Page.container.find("#myFilesCategoryView").show(),pageId=Layout.Page.container.find("#myFilesCategoryView").find(".Scrcont")):"#files/hrfile/role/catview"===Layout.Page.hash&&(Layout.Page.container.find("#roleFilesCategoryView").show(),pageId=Layout.Page.container.find("#roleFilesCategoryView").find(".Scrcont")),Files.isGeorestricted=!0;var row='<ul class="ZPListingUL" id="geo_err">';return row+='<li class="text-center">'+ZPI18N.getString("zp.georestricted")+"</li></tr>",Layout.Page.container.find("#loadingGridDiv").find("#zp_page_loading").remove(),pageId.html(row),pageId.show(),Layout.Page.container.find("#loadingGridDiv").hide(),void ZPeople.Message.showFailureMsg(resultData.fail)}void 0!==resultData[1]?("#files/companyfile/catview"===Layout.Page.hash&&!0===Files.orgCatViewData.Org[1]&&(ZPeople.FireScroll.reset(),Files.constructCatView(resultData[1],params),void 0!=otherDtls.newCat&&otherDtls.newCat&&Files.getcatList("company",params.latitude,params.longitude,!0)),("#files/hrfile/all/catview"===Layout.Page.hash&&!0===Files.empCatViewData.All[1]||"#files/hrfile/sub/catview"===Layout.Page.hash&&!0===Files.empCatViewData.Sub[1]||"#files/hrfile/my/catview"===Layout.Page.hash&&!0===Files.empCatViewData.My[1]||"#files/hrfile/role/catview"===Layout.Page.hash&&!0===Files.empCatViewData.Role[1])&&(ZPeople.FireScroll.reset(),Files.constructCatView(resultData[1],params),void 0!=otherDtls.newCat&&otherDtls.newCat&&Files.getcatList("hr",params.latitude,params.longitude,!0))):(Files.isIprestrict(resultData),Files.constructCatView())},constructCatView:function(viewObj,params){if(Files.isIprestricted){pageId="";Layout.Page.container.find("#loadingGridDiv").hide(),"#files/companyfile/catview"===Layout.Page.hash&&(Layout.Page.container.find("#companyFilesCategoryView").show(),pageId=Layout.Page.container.find("#companyFilesCategoryView").find(".Scrcont")),"#files/hrfile/all/catview"===Layout.Page.hash?(Layout.Page.container.find("#allFilesCategoryView").show(),pageId=Layout.Page.container.find("#allFilesCategoryView").find(".Scrcont")):"#files/hrfile/sub/catview"===Layout.Page.hash?(Layout.Page.container.find("#subFilesCategoryView").show(),pageId=Layout.Page.container.find("#subFilesCategoryView").find(".Scrcont")):"#files/hrfile/my/catview"===Layout.Page.hash?(Layout.Page.container.find("#myFilesCategoryView").show(),pageId=Layout.Page.container.find("#myFilesCategoryView").find(".Scrcont")):"#files/hrfile/role/catview"===Layout.Page.hash&&(Layout.Page.container.find("#roleFilesCategoryView").show(),pageId=Layout.Page.container.find("#roleFilesCategoryView").find(".Scrcont")),pageId.show();row='<ul class="ZPListingUL">';row+='<li class="text-center">'+ZPI18N.getString("zp.iprestricted")+"</li></ul>",pageId.prepend(row)}else{var pageId="",fileType=params.fileType,start=0,filterBy=params.filterBy;if(Layout.Page.container.find("#loadingGridDiv").find("#zp_page_loading").remove(),Layout.Page.container.find("#loadingGridDiv").hide(),"1"==fileType?($("#companyFilesCategoryView").show(),pageId=$("#CFCatView"),0!=Files.orgCatViewData.Org[0]?start=1:pageId.html("")):"0"==fileType&&("all"===filterBy||"allrole"===filterBy||"inactiveemp"===filterBy||"logindisabled"===filterBy?($("#allFilesCategoryView").show(),pageId=$("#allFilesCategoryView").find("#HFCatView"),0!=Files.empCatViewData.All[0]?start=1:pageId.html("")):"subordinates"===filterBy||"allsubordinates"===filterBy?($("#subFilesCategoryView").show(),pageId=$("#subFilesCategoryView").find("#HFCatView"),0!=Files.empCatViewData.Sub[0]?start=1:pageId.html("")):"my"===filterBy?($("#myFilesCategoryView").show(),pageId=$("#myFilesCategoryView").find("#HFCatView"),0!=Files.empCatViewData.My[0]?start=1:pageId.html("")):"myrole"===filterBy&&($("#roleFilesCategoryView").show(),pageId=$("#roleFilesCategoryView").find("#HFCatView"),0!=Files.empCatViewData.Role[0]?start=1:pageId.html(""))),viewObj.length<201?"1"===fileType?(Files.orgCatViewData.Org[1]=!1,Files.orgCatViewData.Org[0]=0,ZPeople.FireScroll.reset()):"0"===fileType&&("all"===filterBy||"allrole"===filterBy||"inactiveemp"===filterBy||"logindisabled"===filterBy?Files.empCatViewData.All[1]=!1:"subordinates"===filterBy||"allsubordinates"===filterBy?Files.empCatViewData.Sub[1]=!1:"my"===filterBy?Files.empCatViewData.My[1]=!1:"myrole"===filterBy&&(Files.empCatViewData.Role[1]=!1),ZPeople.FireScroll.reset()):"1"===fileType?Files.orgCatViewData.Org[1]=!0:"0"===fileType&&("all"===filterBy||"allrole"===filterBy||"inactiveemp"===filterBy||"logindisabled"===filterBy?Files.empCatViewData.All[1]=!0:"subordinates"===filterBy||"allsubordinates"===filterBy?Files.empCatViewData.Sub[1]=!0:"my"===filterBy?Files.empCatViewData.My[1]=!0:"myrole"===filterBy&&(Files.empCatViewData.Role[1]=!0)),void 0!==viewObj&&viewObj.length>0){for(var row="",i=start;i<viewObj.length;i++){var value=viewObj[i];row+='<li id="catLi_'+value.CatID+'" onclick="Files.redirectToListView(\''+value.CatID+'\')"><div class="dtable"><div class="fileType">',row+='<i class="CR-fld"><i class="path1"><i class="path2"></i></i></i></div>',row+='<div class="fileDtl"><b>'+value.CatName+"</b></div></div></li>"}pageId.append(row)}else Layout.Page.container.find("#zp_page_loading").remove(),Files.showNodataMsg("gridView")}"1"===fileType?(0==Files.orgCatViewData.Org[0]?Files.orgCatViewData.Org[0]=201:Files.orgCatViewData.Org[0]=Files.orgCatViewData.Org[0]+200,!0===Files.orgCatViewData.Org[3]&&(Files.orgCatViewData.Org[3]=!1)):"0"===fileType&&("all"===filterBy||"allrole"===filterBy||"inactiveemp"===filterBy||"logindisabled"===filterBy?(0==Files.empCatViewData.All[0]?Files.empCatViewData.All[0]=201:Files.empCatViewData.All[0]=Files.empCatViewData.All[0]+200,!0===Files.empCatViewData.All[3]&&(Files.empCatViewData.All[3]=!1)):"subordinates"===filterBy||"allsubordinates"===filterBy?(0==Files.empCatViewData.Sub[0]?Files.empCatViewData.Sub[0]=201:Files.empCatViewData.Sub[0]=Files.empCatViewData.Sub[0]+200,!0===Files.empCatViewData.Sub[3]&&(Files.empCatViewData.Sub[3]=!1)):"my"===filterBy?(0==Files.empCatViewData.My[0]?Files.empCatViewData.My[0]=201:Files.empCatViewData.My[0]=Files.empCatViewData.My[0]+200,!0===Files.empCatViewData.My[3]&&(Files.empCatViewData.My[3]=!1)):"myrole"===filterBy&&(0==Files.empCatViewData.Role[0]?Files.empCatViewData.Role[0]=201:Files.empCatViewData.Role[0]=Files.empCatViewData.Role[0]+200,!0===Files.empCatViewData.Role[3]&&(Files.empCatViewData.Role[3]=!1)))},redirectToListView:function(Id){"#files/companyfile/catview"===Layout.Page.hash||-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("/"))+"/view-categoryId:"+Id:"#files/hrfile/all/catview"===Layout.Page.hash||-1!==Layout.Page.hash.indexOf("hrfile/all/view-categoryId")?window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("#"))+"#files/hrfile/all/view-categoryId:"+Id:"#files/hrfile/sub/catview"===Layout.Page.hash||-1!==Layout.Page.hash.indexOf("hrfile/sub/view-categoryId")?window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("#"))+"#files/hrfile/sub/view-categoryId:"+Id:"#files/hrfile/my/catview"===Layout.Page.hash||-1!==Layout.Page.hash.indexOf("hrfile/my/view-categoryId")?window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("#"))+"#files/hrfile/my/view-categoryId:"+Id:"#files/hrfile/role/catview"!==Layout.Page.hash&&-1===Layout.Page.hash.indexOf("hrfile/role/view-categoryId")||(window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("#"))+"#files/hrfile/role/view-categoryId:"+Id)},subCategoryView:function(){var fileType="",catId=Layout.Page.urlparam.categoryId,empId="-1",startIndex=0,searchParamsCache={};if(-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId"))if(Object.keys(Files.orgListViewData.Org[2]).length>0)Files.orgSubCatViewData.Org[0]=0,Files.orgListViewData.Org[2].start=Files.orgSubCatViewData.Org[0],Files.orgListViewData.Org[2].catId=catId,searchParamsCache=Files.orgListViewData.Org[2];else{searchParamsCache.methodName="getAllFiles",searchParamsCache.conreqcsr=csrfToken,searchParamsCache.catId=catId,searchParamsCache.searchFileExtn="";var isExpiredFilesView=!1;"0"===Layout.Page.container.find("#companyFileViewType").val()?isExpiredFilesView=!1:"1"===Layout.Page.container.find("#companyFileViewType").val()&&(isExpiredFilesView=!0),Files.orgSubCatViewData.Org[0]=0,startIndex=Files.orgSubCatViewData.Org[0],searchParamsCache.fileType=1,searchParamsCache.locationId="-1",searchParamsCache.start=startIndex,searchParamsCache.isExpiredFilesView=isExpiredFilesView,searchParamsCache.fileSortByType=Files.orgListViewData.Org[4],searchParamsCache.isFileSortDesc=Files.orgListViewData.Org[5],Files.setLatitudeLongitude(searchParamsCache),Files.orgListViewData.Org[2]=searchParamsCache}else if(-1!==Layout.Page.hash.indexOf("hrfile"))if(Layout.Page.container.find("#fileTypeData").select2(),Files.constructemp_addrev("activeEmp"),-1!==Layout.Page.hash.indexOf("hrfile/all/view-categoryId")&&Object.keys(Files.empListViewData.All[2]).length>0)Files.empSubCatViewData.All[0]=0,Files.empListViewData.All[2].start=Files.empSubCatViewData.All[0],Files.empListViewData.All[2].catId=catId,searchParamsCache=Files.empListViewData.All[2];else if(-1!==Layout.Page.hash.indexOf("hrfile/sub/view-categoryId")&&Object.keys(Files.empListViewData.Sub[2]).length>0)Files.empSubCatViewData.Sub[0]=0,Files.empListViewData.Sub[2].start=Files.empSubCatViewData.Sub[0],Files.empListViewData.Sub[2].catId=catId,searchParamsCache=Files.empListViewData.Sub[2];else if(-1!==Layout.Page.hash.indexOf("hrfile/my/view-categoryId")&&Object.keys(Files.empListViewData.My[2]).length>0)Files.empSubCatViewData.My[0]=0,Files.empListViewData.My[2].start=Files.empSubCatViewData.My[0],Files.empListViewData.My[2].catId=catId,searchParamsCache=Files.empListViewData.My[2];else if(-1!==Layout.Page.hash.indexOf("hrfile/role/view-categoryId")&&Object.keys(Files.empListViewData.Role[2]).length>0)Files.empSubCatViewData.Role[0]=0,Files.empListViewData.Role[2].start=Files.empSubCatViewData.Role[0],Files.empListViewData.Role[2].catId=catId,searchParamsCache=Files.empListViewData.Role[2];else{searchParamsCache.methodName="getAllFiles",searchParamsCache.conreqcsr=csrfToken,searchParamsCache.catId=catId,searchParamsCache.searchFileExtn="",Layout.Page.container.find("#fileTypeData").select2();var filterBy="";-1!==Layout.Page.hash.indexOf("/all/view-categoryId")&&("0"===Layout.Page.container.find("#fileTypeData").val()&&(filterBy="all",empId=Files.actEmpSearchObj[0]),"3"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(filterBy="allrole")),"5"===Layout.Page.container.find("#fileTypeData").val()&&(0!=loginUserRoleCheck&&1!=loginUserRoleCheck||(filterBy="inactiveemp",empId=Files.inactEmpSearchObj[0])),Files.empSubCatViewData.All[0]=0,startIndex=Files.empSubCatViewData.All[0]),-1!==Layout.Page.hash.indexOf("/sub/view-categoryId")&&("7"===Layout.Page.container.find("#fileTypeData").val()?(filterBy="allsubordinates",empId=Files.subEmpSearchObj[0]):("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&(filterBy="subordinates",empId=Files.subEmpSearchObj[0]),Files.empSubCatViewData.Sub[0]=0,startIndex=Files.empSubCatViewData.Sub[0]),-1!==Layout.Page.hash.indexOf("/my/view-categoryId")&&(filterBy="my",Files.empSubCatViewData.My[0]=0,startIndex=Files.empSubCatViewData.My[0]),-1!==Layout.Page.hash.indexOf("/role/view-categoryId")&&(filterBy="myrole",Files.empSubCatViewData.Role[0]=0,startIndex=Files.empSubCatViewData.Role[0]),searchParamsCache.fileType=0,searchParamsCache.start=startIndex,searchParamsCache.employeeId=empId,searchParamsCache.filterBy=filterBy,searchParamsCache.roleId="-1",-1!==Layout.Page.hash.indexOf("hrfile/all")?(searchParamsCache.fileSortByType=Files.empListViewData.All[4],searchParamsCache.isFileSortDesc=Files.empListViewData.All[5]):-1!==Layout.Page.hash.indexOf("hrfile/sub")?(searchParamsCache.fileSortByType=Files.empListViewData.Sub[4],searchParamsCache.isFileSortDesc=Files.empListViewData.Sub[5]):-1!==Layout.Page.hash.indexOf("hrfile/my")?(searchParamsCache.fileSortByType=Files.empListViewData.My[4],searchParamsCache.isFileSortDesc=Files.empListViewData.My[5]):-1!==Layout.Page.hash.indexOf("hrfile/role")&&(searchParamsCache.fileSortByType=Files.empListViewData.Role[4],searchParamsCache.isFileSortDesc=Files.empListViewData.Role[5]),0==Object.keys(Files.empListViewData.All[2]).length&&-1!==Layout.Page.hash.indexOf("/all/view-categoryId")&&(Files.empListViewData.All[2]=searchParamsCache),0==Object.keys(Files.empListViewData.Sub[2]).length&&-1!==Layout.Page.hash.indexOf("/sub/view-categoryId")&&(Files.empListViewData.Sub[2]=searchParamsCache),0==Object.keys(Files.empListViewData.My[2]).length&&-1!==Layout.Page.hash.indexOf("/my/view-categoryId")&&(Files.empListViewData.My[2]=searchParamsCache),0==Object.keys(Files.empListViewData.Role[2]).length&&-1!==Layout.Page.hash.indexOf("/role/view-categoryId")&&(Files.empListViewData.Role[2]=searchParamsCache)}-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?(Files.hideCompanyFilter(),Layout.Page.container.find("#comp_fileListing").html(""),Layout.Page.container.find("#CFCatView").html(""),fileType="1",Layout.Page.container.find("#companyFileViewType").select2()):-1===Layout.Page.hash.indexOf("files/hrfile")&&-1===Layout.Page.hash.indexOf("hrfile/catview-employeeId")||(Files.hideHRFilter(),Layout.Page.container.find("#catListHFDiv").show(),Layout.Page.container.find("#hr_allfileList").html(""),fileType="0"),0===startIndex&&(Layout.Page.container.find("#noSubCatEmpDiv").show(),Layout.Page.container.find("#noSubCatEmpDiv").html(ZPeople.LOADING_HTML),Layout.Page.container.find("#EmpListHFDiv").hide()),Files.setSearchValuesInDiv();var params=searchParamsCache;params.methodName="subCategoryView",params.isView="catview",params.parentCatId=catId,$.post(Files.ACTION.URL,params,function(resultData){resultData.hasOwnProperty("fail")?Files.isGeorestricted=!0:Files.isGeorestricted=!1;var Breadcrumbs={};$.each(resultData[1].catTree,function(key,value){Breadcrumbs[value.CatID]=value.CatName}),-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?Files.compFilesBreadcrumb=Breadcrumbs:-1!==Layout.Page.hash.indexOf("hrfile")&&(-1!==Layout.Page.hash.indexOf("all/view-categoryId")?Files.allFileBreadcrumb=Breadcrumbs:-1!==Layout.Page.hash.indexOf("sub/view-categoryId")?Files.subFileBreadcrumb=Breadcrumbs:-1!==Layout.Page.hash.indexOf("my/view-categoryId")?Files.myFileBreadcrumb=Breadcrumbs:-1!==Layout.Page.hash.indexOf("role/view-categoryId")&&(Files.roleFileBreadcrumb=Breadcrumbs)),0===startIndex&&(void 0===resultData[1].subCategory||resultData[1].subCategory.length<=0)&&(void 0===resultData[1].subCatFiles||resultData[1].subCatFiles.length<=0)?(Layout.Page.container.find("#noSubCatEmpDiv").find("#zp_page_loading").remove(),Layout.Page.container.find("#noSubCatEmpDiv").hide(),Files.showNodataMsg("subCatView")):Layout.Page.container.find("#noSubCatEmpDiv").hide(),void 0!==resultData[1].subCategory&&resultData[1].subCategory.length>0&&Files.constructSubCatView(resultData[1].subCategory),void 0!==resultData[1].subCatFiles&&resultData[1].subCatFiles.length>0?-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?(Files.constructTopBar("1"),Files.companyfilelistView(resultData[1].subCatFiles)):(Files.constructTopBar("0"),Files.hrFilelistView(resultData[1].subCatFiles)):-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?(Files.orgSubCatViewData.Org[0]=Files.orgSubCatViewData.Org[0]+25,Files.orgSubCatViewData.Org[1]=!1):-1!==Layout.Page.hash.indexOf("hrfile")&&(-1!==Layout.Page.hash.indexOf("all/view-categoryId")?(Files.empSubCatViewData.All[0]=Files.empSubCatViewData.All[0]+25,Files.empSubCatViewData.All[1]=!1):-1!==Layout.Page.hash.indexOf("sub/view-categoryId")?(Files.empSubCatViewData.Sub[0]=Files.empSubCatViewData.Sub[0]+25,Files.empSubCatViewData.Sub[1]=!1):-1!==Layout.Page.hash.indexOf("my/view-categoryId")?(Files.empSubCatViewData.Sub[0]=Files.empSubCatViewData.Sub[0]+25,Files.empSubCatViewData.My[1]=!1):-1!==Layout.Page.hash.indexOf("role/view-categoryId")&&(Files.empSubCatViewData.Role[0]=Files.empSubCatViewData.Role[0]+25,Files.empSubCatViewData.Role[1]=!1)),"1"===fileType?(Layout.Page.container.find("#catListCFDiv").show(),Layout.Page.container.find("#catListCFDiv").find("#comp_fileListing").show()):(Layout.Page.container.find("#catListHFDiv").show(),Layout.Page.container.find("#catListHFDiv").find("#hr_allfileList").show()),Files.constructBreadcrumbs()}),Files.searchFileBreadcrumbs()},constructSubCatView:function(viewObj){var pageId="";"#files/companyfile/catview"===Layout.Page.hash||-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?pageId=Layout.Page.container.find("#comp_fileListing"):-1===Layout.Page.hash.indexOf("#files/hrfile")&&-1===Layout.Page.hash.indexOf("catview-categoryId")||(pageId=Layout.Page.container.find("#hr_allfileList")),pageId.html("");var row="";if(row+='<div class="ZPBoxListing oHide MT20"><ul>',void 0!==viewObj&&viewObj!=={}&&viewObj.length>0){for(var i=0;i<viewObj.length;i++){var value=viewObj[i];row+='<li id="catLi_'+value.CatID+'" onclick="Files.redirectToListView(\''+value.CatID+'\')"><div class="dtable"><div class="fileType">',row+='<i class="CR-fld"><i class="path1"><i class="path2"></i></i></i></div>',row+='<div class="fileDtl"><b>'+value.CatName+"</b></div></div></li>"}row+="</ul></div>",pageId.append(row)}},constructBreadcrumbs:function(catId){var catPathObj={},pageId="";if(-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?(catPathObj=Files.compFilesBreadcrumb,pageId=Layout.Page.container.find("#addCompany_Bar").find("#categoryPath_settings"),Layout.Page.container.find("#addCompany_Bar").find("#categoryPath_settings").show(),Layout.Page.container.find("#addCompany_Bar").find("#categoryPath_settingsDef").hide(),Layout.Page.container.find("#addCompany_Bar").find("#moreCatList").html("")):-1!==Layout.Page.hash.indexOf("hrfile")?(-1!==Layout.Page.hash.indexOf("all/view-categoryId")?catPathObj=Files.allFileBreadcrumb:-1!==Layout.Page.hash.indexOf("sub/view-categoryId")?catPathObj=Files.subFileBreadcrumb:-1!==Layout.Page.hash.indexOf("my/view-categoryId")?catPathObj=Files.myFileBreadcrumb:-1!==Layout.Page.hash.indexOf("role/view-categoryId")&&(catPathObj=Files.roleFileBreadcrumb),pageId=Layout.Page.container.find("#addHR_Bar").find("#categoryPath_settings"),Layout.Page.container.find("#addHR_Bar").find("#categoryPath_settings").show(),Layout.Page.container.find("#addHR_Bar").find("#categoryPath_settingsDef").hide(),Layout.Page.container.find("#addHR_Bar").find("#moreCatList").html("")):(catPathObj=Files.settingsCatPath,pageId=Layout.Page.container.find("#categoryPath_settings"),Layout.Page.container.find("#categoryPath_settings").show(),Layout.Page.container.find("#categoryPath_settingsDef").hide(),Layout.Page.container.find("#moreCatList").html("")),null!==catPathObj||void 0!==catPathObj||0!==Object.keys(catPathObj).length){var breadCrumbs="",empPhotoObj="";-1!==Layout.Page.hash.indexOf("/all/view")&&("0"===Layout.Page.container.find("#fileTypeData").val()&&""!==Layout.Page.container.find("#actEmpPhoto_Files").attr("src")?empPhotoObj=Files.actEmpSearchObj:"5"===Layout.Page.container.find("#fileTypeData").val()&&""!==Layout.Page.container.find("#inactEmpPhoto_Files").attr("src")?empPhotoObj=Files.inactEmpSearchObj:"8"===Layout.Page.container.find("#fileTypeData").val()&&""!==Layout.Page.container.find("#logdisEmpPhoto_Files").attr("src")&&(empPhotoObj=Files.logDisEmpSearchObj)),-1!==Layout.Page.hash.indexOf("/sub/view")&&("7"===Layout.Page.container.find("#fileTypeData").val()&&""!==Layout.Page.container.find("#allsubEmpPhoto_Files").attr("src")?empPhotoObj=Files.allsubEmpSearchObj:("6"===Layout.Page.container.find("#fileTypeData").val()||null!==hasAllReporteePerm&&void 0!==hasAllReporteePerm&&!1===hasAllReporteePerm)&&""!==Layout.Page.container.find("#subEmpPhoto_Files").attr("src")&&(empPhotoObj=Files.subEmpSearchObj)),null!==empPhotoObj&&void 0!==empPhotoObj&&empPhotoObj.length>0?(breadCrumbs="<span onclick=\"Files.reverseNavigationBreadcrumbs('home',undefined,true)\";>",breadCrumbs+='<div class="fileType ph">',breadCrumbs+='<img src="'+empPhotoObj[1]+'">',breadCrumbs+="</div></span>"):breadCrumbs='<span><i class="CR-home" onclick="Files.reverseNavigationBreadcrumbs(\'home\',undefined,true)";></i></span>',Object.keys(catPathObj).length>2&&(breadCrumbs+='<span><i class="IC-ar-rgt"></i></span><span class="ddDummy"></span>');for(var i=0;i<Object.keys(catPathObj).length;i++){var catKey=Object.keys(catPathObj)[i],catValue=catPathObj[catKey];if(i>=Object.keys(catPathObj).length-2)breadCrumbs+='<span><i class="IC-ar-rgt"></i></span>',i==Object.keys(catPathObj).length-1?breadCrumbs+="<span onclick=\"Files.reverseNavigationBreadcrumbs('other','"+catKey+"',false)\">"+catValue+"</span>":breadCrumbs+="<span class=\"link\" onclick=\"Files.reverseNavigationBreadcrumbs('other','"+catKey+"',true)\">"+catValue+"</span>";else-1!==Layout.Page.hash.indexOf("all/view-categoryId")?Layout.Page.container.find("#addHR_Bar").find("#morecategoryPath_settingsDef").show():Layout.Page.container.find("#morecategoryPath_settingsDef").show(),Layout.Page.container.find("#moreCatList").append("<li onclick=\"Files.reverseNavigationBreadcrumbs('other','"+catKey+'\',true)"><a data-toggle="modal" data-target="#ZPimport"><i class="CR-folder DIB"></i>'+catValue+"</a></li>")}pageId.html(breadCrumbs)}},reverseNavigationBreadcrumbs:function(mode,catId,isClickable){if(!0===isClickable)if("home"===mode)-1!==Layout.Page.hash.indexOf("all/view-categoryId")?Layout.Page.container.find("#addHR_Bar").find("#morecategoryPath_settingsDef").hide():Layout.Page.container.find("#morecategoryPath_settingsDef").hide(),-1!==Layout.Page.hash.indexOf("settings/categorylistview")&&(Layout.Page.container.find("#categoryPath_settings").hide(),Layout.Page.container.find("#categoryPath_settingsDef").show(),Files.settingsCurrentCatId=-1),-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?(Files.compFilesBreadcrumb={},"none"===$("#companyFilesCategoryView").find(".filter-results").css("display")&&(Files.orgListViewData.Org[2].catId="-1"),window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("#"))+"#files/companyfile/catview"):-1!==Layout.Page.hash.indexOf("all/view-categoryId")?(Files.allFileBreadcrumb={},"none"===$("#allFilesCategoryView").find(".filter-results").css("display")&&(Files.empListViewData.All[2].catId="-1"),window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("#"))+"#files/hrfile/all/catview"):-1!==Layout.Page.hash.indexOf("sub/view-categoryId")?(Files.subFileBreadcrumb={},"none"===$("#subFilesCategoryView").find(".filter-results").css("display")&&(Files.empListViewData.Sub[2].catId="-1"),window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("#"))+"#files/hrfile/sub/catview"):-1!==Layout.Page.hash.indexOf("my/view-categoryId")?(Files.myFileBreadcrumb={},"none"===$("#myFilesCategoryView").find(".filter-results").css("display")&&(Files.empListViewData.My[2].catId="-1"),window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("#"))+"#files/hrfile/my/catview"):-1!==Layout.Page.hash.indexOf("role/view-categoryId")?(Files.roleFileBreadcrumb={},"none"===$("#roleFilesCategoryView").find(".filter-results").css("display")&&(Files.empListViewData.Role[2].catId="-1"),window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("#"))+"#files/hrfile/role/catview"):(Files.settingsCatPath={},Layout.Page.container.find("#settings_subcatList").hide(),Layout.Page.container.find("#settings_catList").show()),Files.reloadPage();else if("other"===mode){Files.settingsCurrentCatId=catId;var newCatPath={},catPathObj={};catPathObj=-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?Files.compFilesBreadcrumb:-1!==Layout.Page.hash.indexOf("all/view-categoryId")?Files.allFileBreadcrumb:-1!==Layout.Page.hash.indexOf("sub/view-categoryId")?Files.subFileBreadcrumb:-1!==Layout.Page.hash.indexOf("my/view-categoryId")?Files.myFileBreadcrumb:-1!==Layout.Page.hash.indexOf("role/view-categoryId")?Files.roleFileBreadcrumb:Files.settingsCatPath;for(var i=0;i<Object.keys(catPathObj).length;i++){var catKey=Object.keys(catPathObj)[i],catValue=catPathObj[catKey];if(catKey===catId){0==i&&(newCatPath[catKey]=catValue),catPathObj=newCatPath,-1!==Layout.Page.hash.indexOf("companyfile/view-categoryId")?Files.redirectToListView(catId):-1!==Layout.Page.hash.indexOf("all/view-categoryId")?Files.redirectToListView(catId):-1!==Layout.Page.hash.indexOf("sub/view-categoryId")?Files.redirectToListView(catId):-1!==Layout.Page.hash.indexOf("my/view-categoryId")?Files.redirectToListView(catId):-1!==Layout.Page.hash.indexOf("role/view-categoryId")?Files.redirectToListView(catId):(Files.settingsCatPath=catPathObj,Files.initSubCatSettings(catId)),Object.keys(catPathObj).length<=2&&(-1!==Layout.Page.hash.indexOf("all/view-categoryId")?Layout.Page.container.find("#addHR_Bar").find("#morecategoryPath_settingsDef").hide():Layout.Page.container.find("#morecategoryPath_settingsDef").hide());break}newCatPath[catKey]=catValue}}},toggleSortBy:function(ele,fileType){var list=[];"1"===fileType?(list=Layout.Page.container.find(ele).parent().parent().find("li").find("[id^='CFSort']"),Files.orgListViewData.Org[4]=ele.id.substring(ele.id.length-1)):"0"===fileType?(list=Layout.Page.container.find(ele).parent().parent().find("li").find("[id^='HFSort']"),-1!==Layout.Page.hash.indexOf("hrfile/all")?Files.empListViewData.All[4]=ele.id.substring(ele.id.length-1):-1!==Layout.Page.hash.indexOf("hrfile/sub")?Files.empListViewData.Sub[4]=ele.id.substring(ele.id.length-1):-1!==Layout.Page.hash.indexOf("hrfile/my")?Files.empListViewData.My[4]=ele.id.substring(ele.id.length-1):-1!==Layout.Page.hash.indexOf("hrfile/role")&&(Files.empListViewData.Role[4]=ele.id.substring(ele.id.length-1))):"2"===fileType&&(list=Layout.Page.container.find(ele).parent().parent().find("li").find("[id^='PFSort']"),Files.persListViewData.Pers[4]=ele.id.substring(ele.id.length-1));for(var i=0;i<list.length;i++)list[i].id!==ele.id?Layout.Page.container.find(list[i]).removeClass("sort-u sort-d"):ele.classList.contains("sort-u")?(Layout.Page.container.find(ele).removeClass("sort-u"),Layout.Page.container.find(ele).addClass("sort-d"),Layout.Page.container.find(ele).attr("title","Sort By Descending"),"1"===fileType?Files.orgListViewData.Org[5]=!0:"0"===fileType?-1!==Layout.Page.hash.indexOf("hrfile/all")?Files.empListViewData.All[5]=!0:-1!==Layout.Page.hash.indexOf("hrfile/sub")?Files.empListViewData.Sub[5]=!0:-1!==Layout.Page.hash.indexOf("hrfile/my")?Files.empListViewData.My[5]=!0:-1!==Layout.Page.hash.indexOf("hrfile/role")&&(Files.empListViewData.Role[5]=!0):"2"===fileType&&(Files.persListViewData.Pers[5]=!0)):ele.classList.contains("sort-d")?(Layout.Page.container.find(ele).removeClass("sort-d"),Layout.Page.container.find(ele).addClass("sort-u"),Layout.Page.container.find(ele).attr("title","Sort By Ascending"),"1"===fileType?Files.orgListViewData.Org[5]=!1:"0"===fileType?-1!==Layout.Page.hash.indexOf("hrfile/all")?Files.empListViewData.All[5]=!1:-1!==Layout.Page.hash.indexOf("hrfile/sub")?Files.empListViewData.Sub[5]=!1:-1!==Layout.Page.hash.indexOf("hrfile/my")?Files.empListViewData.My[5]=!1:-1!==Layout.Page.hash.indexOf("hrfile/role")&&(Files.empListViewData.Role[5]=!1):"2"===fileType&&(Files.persListViewData.Pers[5]=!1)):(Layout.Page.container.find(ele).attr("title","Sort By Descending"),Layout.Page.container.find(ele).removeClass("sort-u sort-d"),Layout.Page.container.find(ele).addClass("sort-d"),"1"===fileType?Files.orgListViewData.Org[5]=!0:"0"===fileType?-1!==Layout.Page.hash.indexOf("hrfile/all")?Files.empListViewData.All[5]=!0:-1!==Layout.Page.hash.indexOf("hrfile/sub")?Files.empListViewData.Sub[5]=!0:-1!==Layout.Page.hash.indexOf("hrfile/my")?Files.empListViewData.My[5]=!0:-1!==Layout.Page.hash.indexOf("hrfile/role")&&(Files.empListViewData.Role[5]=!0):"2"===fileType&&(Files.persListViewData.Pers[5]=!0));"1"===fileType?(-1!==Layout.Page.hash.indexOf("view-categoryId")?(Files.orgSubCatViewData.Org[0]=0,Files.orgSubCatViewData.Org[1]=!0):(Files.orgListViewData.Org[0]=0,Files.orgListViewData.Org[1]=!0),Files.getCompanyfilesListing("addCompany")):"0"===fileType&&("#files/fileView/hrfileslistview"===Layout.Page.hash||"#files/hrfile/all/listview"===Layout.Page.hash?(Files.empListViewData.All[0]=0,Files.empListViewData.All[1]=!0):"#files/hrfile/sub/listview"===Layout.Page.hash?(Files.empListViewData.Sub[0]=0,Files.empListViewData.Sub[1]=!0):"#files/hrfile/my/listview"===Layout.Page.hash?(Files.empListViewData.My[0]=0,Files.empListViewData.My[1]=!0):"#files/hrfile/role/listview"===Layout.Page.hash&&(Files.empListViewData.Role[0]=0,Files.empListViewData.Role[1]=!0),-1!==Layout.Page.hash.indexOf("#files/hrfile/all/view")?(Files.empSubCatViewData.All[0]=0,Files.empSubCatViewData.All[1]=!0):-1!==Layout.Page.hash.indexOf("#files/hrfile/sub/view")?(Files.empSubCatViewData.Sub[0]=0,Files.empSubCatViewData.Sub[1]=!0):-1!==Layout.Page.hash.indexOf("#files/hrfile/my/view")?(Files.empSubCatViewData.My[0]=0,Files.empSubCatViewData.My[1]=!0):-1!==Layout.Page.hash.indexOf("#files/hrfile/role/view")&&(Files.empSubCatViewData.Role[0]=0,Files.empSubCatViewData.Role[1]=!0),Files.getHrfilesListing("add")),"2"===fileType&&(Files.resetVals(),Files.persListViewData.Pers[0]=0,Files.persListViewData.Pers[1]=!0,Files.getPersonalfilesListing("addPersonal"))},ChangeImportFileName:function(){var mainObj=Layout.Page.container.find("div#import_hrfileDiv"),fName=mainObj.find("#importFileName").val();fName=fName.replace("C:\\fakepath\\",""),mainObj.find("#importdUploadedFName").empty().text(fName)},imprtFrmtOptboxhandle:function(id){var mainObj=Layout.Page.container.find("div#import_hrfileDiv");"firstfieldicon"==id?null==mainObj.find("#firstfield").val()||""==mainObj.find("#firstfield").val()?(!0,mainObj.find("#choosefileformat_err").remove(),mainObj.find("#firstfield").after('<span class="ERR" id="choosefileformat_err" style="padding-top:10px">'+ZPI18N.getString("zp.enterfileformat")+"</span>")):(mainObj.find("#choosefileformat_err").remove(),mainObj.find("#secondfield").css("display","block"),mainObj.find("#secondfieldicon").css("display","block"),mainObj.find("#"+id).css("display","none"),mainObj.find("#secondsubicon").show()):"secondfieldicon"==id&&(null==mainObj.find("#secondfield").val()||""==mainObj.find("#secondfield").val()?(!0,mainObj.find("#choosefileformat_err").remove(),mainObj.find("#secondfield").after('<span class="ERR" id="choosefileformat_err" style="padding-top:10px">'+ZPI18N.getString("zp.enterfileformat")+"</span>")):(mainObj.find("#choosefileformat_err").remove(),mainObj.find("#thirdfield").css("display","block"),mainObj.find("#"+id).css("display","none"),mainObj.find("#secondsubicon").hide(),mainObj.find("#thirdsubicon").show()))},removeIconHandle:function(id){var value,mainObj=Layout.Page.container.find("div#import_hrfileDiv");"secondsubicon"==id?(value="<"+mainObj.find("#secondfield").val()+">",mainObj.find("#secondfield").val(""),mainObj.find("#secondfield").css("display","none"),mainObj.find("#secondfieldicon").css("display","none"),mainObj.find("#"+id).css("display","none"),mainObj.find("#firstfieldicon").css("display","block")):"thirdsubicon"==id&&(value="<"+mainObj.find("#thirdfield").val()+">",mainObj.find("#thirdfield").val(""),mainObj.find("#thirdfield").css("display","none"),mainObj.find("#"+id).css("display","none"),mainObj.find("#secondfieldicon").css("display","block"),mainObj.find("#secondsubicon").show()),mainObj.find("#choosefileformat_err").is(":visible")&&mainObj.find("#choosefileformat_err").remove(),frmtexmple=mainObj.find("#exmpSpan").text(),-1!=frmtexmple.lastIndexOf(value)&&mainObj.find("#exmpSpan").text(frmtexmple.substr(0,frmtexmple.lastIndexOf(value)))},showFormatOptions:function(classname,field,obj){labelnameVsdispname=JSON.parse($(obj).attr("labelnameVsdispname")),Fname=labelnameVsdispname.FirstName,Lname=labelnameVsdispname.LastName,empid=labelnameVsdispname.EmployeeID,$('input[name="firstfield"]').prop("readonly",!1);var format_map={};if(format_map[Fname]='<li><div class="MT3"><label class="radio DIB PT8 MR10"><input  value = "'+labelnameVsdispname.FirstName+'"  name="'+field+'" type="radio" onchange="Files.getval(this)"><span class="ML2">'+ZSEC.Encoder.encodeForHTML(labelnameVsdispname.FirstName)+"</span></label></div></li>",format_map[Lname]='<li><div class="MT3"><label class="radio DIB PT8 MR10"><input value = "'+labelnameVsdispname.LastName+'" name = "'+field+'" type="radio" onchange="Files.getval(this)"><span class="ML2">'+ZSEC.Encoder.encodeForHTML(labelnameVsdispname.LastName)+"</span></label></div></li>",format_map[empid]='<li><div class="MT3"><label class="radio DIB PT8 MR10"><input  value = "'+labelnameVsdispname.EmployeeID+'" name ="'+field+'" type="radio" onchange="Files.getval(this)"><span class="ML2">'+ZSEC.Encoder.encodeForHTML(labelnameVsdispname.EmployeeID)+"</span></label></div> </li>","firstfield"==field){var optionId=$(Layout.Page.container.find(".ZPapplCb")[0]),option="<ul>";values=[],secondfield=Layout.Page.container.find("#secondfield").val()," "!=secondfield&&values.push(Layout.Page.container.find("#secondfield").val())," "!=Layout.Page.container.find("#thirdfield").val()&&""!=Layout.Page.container.find("#thirdfield").val()&&null!=Layout.Page.container.find("#thirdfield").val()&&values.push(Layout.Page.container.find("#thirdfield").val());var firstfieldvalue=Layout.Page.container.find("#firstfield").val();0!=values.length&&$.each(values,function(index,value){delete format_map[value]}),$.each(format_map,function(key,value){option+=value}),option+="</ul>",optionId.html(option),""!=firstfieldvalue&&Layout.Page.container.find("input[name='firstfield'][value= '"+firstfieldvalue+"']").prop("checked",!0)}else{var fieldvalue=Layout.Page.container.find("#"+field).val(),valueslist=[];if("secondfield"==field)optionId=$(Layout.Page.container.find(".rhttabscrl")[0]);else if("thirdfield"==field)optionId=$(Layout.Page.container.find(".rhttabscrl")[1]);Layout.Page.container.find("."+classname).parent().addClass("active");var filedidslist=["firstfield","secondfield","thirdfield"];option='<div class="tab-content" ><div role="tabpanel" class="tab-pane active" id="dvLeaveTracker"><div><div class="ZPapplCb">';option+="<ul>",filedidslist=$.grep(filedidslist,function(value){return value!=field}),$.each(filedidslist,function(index,value){valuefield=Layout.Page.container.find("#"+value).val()," "!=value&&null!=value&&void 0!=value&&valueslist.push(valuefield)}),$.each(valueslist,function(index,value){"fileformat"==classname&&delete format_map[value]}),"fileformat"==classname?("none"==Layout.Page.container.find("#thirdfield").css("display")&&"-"!=Layout.Page.container.find("#secondfield").val()&&"_"!=Layout.Page.container.find("#secondfield").val()&&Layout.Page.container.find("#secondfieldicon").css("display","block"),Layout.Page.container.find(".separator").parent().removeClass("active"),$.each(format_map,function(key,value){option+=value})):"separator"==classname&&(Layout.Page.container.find("#secondfieldicon").css("display","none"),"thirdfield"!=field&&Layout.Page.container.find("#thirdfield").css("display","none"),Layout.Page.container.find("#thirdfield").val(""),Layout.Page.container.find(".fileformat").parent().removeClass("active"),option+='<li><div class="MT3"><label class="radio DIB PT8 MR10"><input value = "_" name ="'+field+'" type="radio" onchange="Files.getval(this)"><span class="ML2">Underscore( _ )</span></label></div></li>',option+='<li><div class="MT3"><label class="radio DIB PT8 MR10"><input value = "-" name ="'+field+'" type="radio"  onchange="Files.getval(this)"><span class="ML2">Hyphen(-)</span></label></div></li>'),option+="</ul></div></div></div></div>",optionId.html(option),""!=fieldvalue&&Layout.Page.container.find("input[name='"+field+"'][value= '"+fieldvalue+"']").prop("checked",!0)}Layout.Page.container.find('input[name="firstfieldname"]').prop("readonly",!0)},getval:function(me){var mainObj=Layout.Page.container.find("div#import_hrfileDiv"),value=$(me).attr("name");Layout.Page.container.find("#"+value).val($("input[name="+value+"]:checked").val());var firstfieldvalue=Layout.Page.container.find("#firstfield").val(),secondfieldvalue=Layout.Page.container.find("#secondfield").val(),thirdfieldvalue=Layout.Page.container.find("#thirdfield").val(),example="";null!=firstfieldvalue&&" "!=firstfieldvalue&&""!=firstfieldvalue&&(example=example+"<"+firstfieldvalue+">"),null!=secondfieldvalue&&" "!=secondfieldvalue&&""!=secondfieldvalue&&(example=example+" <"+secondfieldvalue+">"),null!=thirdfieldvalue&&" "!=thirdfieldvalue&&""!=thirdfieldvalue&&(example=example+" <"+thirdfieldvalue+">");var values=[];values.push(firstfieldvalue),values.push(secondfieldvalue),values.push(thirdfieldvalue),(values.includes("-")||values.includes("_"))&&(example+=" <documentname>"),Layout.Page.container.find("#exmpSpan").text(example),"-"==secondfieldvalue||"_"==secondfieldvalue||""==secondfieldvalue||"secondfield"!=value||mainObj.find("#thirdfield").is(":visible")||Layout.Page.container.find("#secondfieldicon").css("display","block")},showImportHRFile:function(catList){var mainObj=Layout.Page.container.find("div#import_hrfileDiv");mainObj.find("#firstfieldicon").css("display","block"),mainObj.find("#secondfield").css("display","none"),mainObj.find("#thirdfield").css("display","none"),mainObj.find("#secondfieldicon").css("display","none"),mainObj.find("#secondfieldicon").css("display","none"),mainObj.find("#secondsubicon").hide(),mainObj.find("#thirdsubicon").hide(),mainObj.find("#dropdownpropthird").on("click",function(event){event.stopPropagation()}),mainObj.find("#dropdownpropsec").on("click",function(event){event.stopPropagation()}),mainObj.find("#dropdownpropfirst").on("click",function(event){event.stopPropagation()}),mainObj.find("#firstfield").val(""),mainObj.find("#secondfield").val(""),mainObj.find("#thirdfield").val(""),mainObj.find("#exmpSpan").text("- - - - - "),Files.isIprestricted?(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")),Layout.Page.container.find("#add_hrfileDiv").modal("hide")):Files.isGeorestricted?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")):(mainObj.find("select#hrselect_Cat").html(""),Files.FilescatList("import","hrselect_Cat","s2id_hrselect_Cat"),mainObj.find("button#bulk_import_click").removeClass("disabled"),mainObj.find("#importErrDiv,#error_count").remove(),mainObj.find("select#hrselect_Cat").select2("val","-1"),mainObj.find(".ERR").remove(),mainObj.find("div#afterUpload").addClass("DN"),mainObj.find("input#hrnewCategory,div#cancel_hrCat_btn").hide(),mainObj.find("div#beforeUpload").removeClass("DN"),mainObj.find("textarea#fileDesc,input#uploadfile").val(""),mainObj.find("div#zp_page_loading").hide(),mainObj.find("form#hrfileupload").show(),mainObj.find("#isUserShared")[0].checked=!0,mainObj.find("#isEmpDownload")[0].checked=!0,mainObj.find("#folderImp").parent().parent().hasClass("DN")&&mainObj.find("#folderImp").parent().parent().removeClass("DN"),mainObj.modal()),Layout.Page.container.find(".select2-focusser").css("width","100%")},showEntityFields:function(){Layout.Page.container.find("#companyfilterdiv");Layout.Page.container.find("#roleViewfilter").hide(),Layout.Page.container.find("#filesOrgStructure").addClass("DNI"),Layout.Page.container.find("#filesOrgStructure").find("select").html("");var lbl="",idVal="",name="";if("location"!==Layout.Page.container.find("#selectorgStructEntities").val()&&Layout.Page.container.find("#search_location").select2("val","-1"),"location"==Layout.Page.container.find("#selectorgStructEntities").val())return Layout.Page.container.find("#roleViewfilter").show(),void Layout.Page.container.find("#filesOrgStructure").children().find("select").attr("id",idVal);"Entity"==Layout.Page.container.find("#selectorgStructEntities").val()?(lbl=ZPeople.orgStructureDispNameMap.entity,idVal="zp_views_employeeentity",name="entity",Layout.Page.container.find("#filesOrgStructure").children().attr("id","employee_entity_files"),Layout.Page.container.find("#employee_entity_files").find("select").append(Files.setKeyValues(Files.orgStructureTagMap.entity))):"Business_unit"==Layout.Page.container.find("#selectorgStructEntities").val()?(lbl=ZPeople.orgStructureDispNameMap.unit,idVal="zp_views_employeeunit",name="unit",Layout.Page.container.find("#filesOrgStructure").children().attr("id","employee_unit_files"),Layout.Page.container.find("#employee_unit_files").find("select").append(Files.setKeyValues(Files.orgStructureTagMap.unit))):"Division"==Layout.Page.container.find("#selectorgStructEntities").val()?(lbl=ZPeople.orgStructureDispNameMap.division,idVal="zp_views_employeedivision",name="division",Layout.Page.container.find("#filesOrgStructure").children().attr("id","employee_division_files"),Layout.Page.container.find("#employee_division_files").find("select").append(Files.setKeyValues(Files.orgStructureTagMap.division))):"Department"==Layout.Page.container.find("#selectorgStructEntities").val()&&(lbl=ZPeople.orgStructureDispNameMap.department,idVal="zp_views_employeedepartment",name="department",Layout.Page.container.find("#filesOrgStructure").children().attr("id","employee_department_files"),Layout.Page.container.find("#employee_department_files").find("select").append(Files.setKeyValues(Files.orgStructureTagMap.department))),Layout.Page.container.find("#selectedCompLbl").text(ZPeople.decodeTxt(lbl)),"2"!=loginUserRoleCheck||isOrgStructureEnabled?"2"==loginUserRoleCheck&&isOrgStructureEnabled?"entity"==name?null!=Files.orgStructureTagMap.entity&&void 0!=Files.orgStructureTagMap.entity&&0!=Object.keys(Files.orgStructureTagMap.entity).length&&Layout.Page.container.find("#filesOrgStructure").removeClass("DNI"):"unit"==name?null!=Files.orgStructureTagMap.unit&&void 0!=Files.orgStructureTagMap.unit&&0!=Object.keys(Files.orgStructureTagMap.unit).length&&Layout.Page.container.find("#filesOrgStructure").removeClass("DNI"):"division"==name?null!=Files.orgStructureTagMap.division&&void 0!=Files.orgStructureTagMap.division&&0!=Object.keys(Files.orgStructureTagMap.division).length&&Layout.Page.container.find("#filesOrgStructure").removeClass("DNI"):"department"==name&&null!=Files.orgStructureTagMap.department&&void 0!=Files.orgStructureTagMap.department&&0!=Object.keys(Files.orgStructureTagMap.department).length&&Layout.Page.container.find("#filesOrgStructure").removeClass("DNI"):"-1"==loginUserRoleCheck||isOrgStructureEnabled?isOrgStructureEnabled&&Layout.Page.container.find("#filesOrgStructure").removeClass("DNI"):Layout.Page.container.find("#filesOrgStructure").removeClass("DNI"):"location"==name&&Layout.Page.container.find("#filesOrgStructure").removeClass("DNI"),Layout.Page.container.find("#filesOrgStructure").children().find("select").attr("id",idVal),Layout.Page.container.find("#filesOrgStructure").children().find("select").attr("name",name),""!=idVal&&Layout.Page.container.find("#companyfilterdiv").find("#"+idVal).select2()},clearAndSetEntityFields:function(thisObj){Files.showEntityFields()},setFilesOrgStructureFields:function(values){0!=Object.keys(values.Entity).length&&(Files.orgStructureTagMap.entity=values.Entity),0!=Object.keys(values.Department).length&&(Files.orgStructureTagMap.department=values.Department),0!=Object.keys(values.Division).length&&(Files.orgStructureTagMap.division=values.Division),0!=Object.keys(values.Unit).length&&(Files.orgStructureTagMap.unit=values.Unit)},setFilesOrgOptions:function(){},setKeyValues:function(dataObj){var option="<option value='-1' selected='selected'>"+ZPI18N.getString("zp.all")+"</option>";return ZPSetupCommon.isEmpty(dataObj)?"":(Object.keys(dataObj).length>0&&$.each(dataObj,function(key,value){option+='<option value="'+key+'">'+value+"</option>"}),option)},displaySelectedComponent:function(values){void 0!=values.Entity&&(Layout.Page.container.find("#employee_entity_files").select2(values.Entity),Files.orgStructureTagMap.entity=values.Entity),void 0!=values.Department&&(Layout.Page.container.find("#employee_department_files").select2(values.Department),Files.orgStructureTagMap.department=values.Department),void 0!=values.Division&&(Layout.Page.container.find("#employee_division_files").select2(values.Division),Files.orgStructureTagMap.division=values.Division),void 0!=values.Unit&&(Layout.Page.container.find("#employee_unit_files").select2(values.Unit),Files.orgStructureTagMap.unit=values.Unit)},SelfService:{fetchSelfServiceFiles:function(mode){if(Layout.Page.container.find("#filesSSmainDiv").hide(),Layout.Page.container.find("#noSubCatEmpDiv").show(),Layout.Page.container.find("#noSubCatEmpDiv").html(ZPeople.LOADING_HTML),Layout.Page.container.find("#hr_allfileList").html(""),Layout.Page.container.find("#pers_fileListing").html(""),null!=SelfService.getUserId()&&SelfService.getUserId()!==erecno&&(-1!==loginUserRoleCheck?Layout.Page.container.find("#ssAddPersFile").hide():Layout.Page.container.find("#addSSFiles").hide(),Layout.Page.container.find("#pers_fileListing").hide(),Layout.Page.container.find("#pf_SSHeader").hide()),isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position){Files.isGeorestricted=!0;var row='<ul class="ZPListingUL" id="geo_err">';row+='<li class="text-center">'+ZPI18N.getString("zp.georestricted")+"</li></ul>",Layout.Page.container.find("#noSubCatEmpDiv").find("#zp_page_loading").remove();var pageId=Layout.Page.container.find("#noSubCatEmpDiv");return pageId.html(row),pageId.show(),void Layout.Page.container.find("#filesSSmainDiv").hide()}var formData=new FormData;if(formData.append("methodName","getFilesForSelfService"),formData.append("conreqcsr",csrfToken),formData.append("isView","catview"),formData.append("filterBy","my"),formData.append("fileType",0),formData.append("start",0),formData.append("fileSortByType",3),formData.append("isFileSortDesc",!0),formData.append("ERECNO",SelfService.getUserId()),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){if(void 0==resultData[1]){var row='<ul class="ZPListingUL" id="geo_err">';return row+='<li class="text-center">'+ZPI18N.getString("zp.iprestricted")+"</li></ul>",Layout.Page.container.find("#noSubCatEmpDiv").find("#zp_page_loading").remove(),(pageId=Layout.Page.container.find("#noSubCatEmpDiv")).html(row),pageId.show(),void Layout.Page.container.find("#filesSSmainDiv").hide()}if((void 0===resultData[1].subCategory||resultData[1].subCategory.length<=0)&&(void 0===resultData[1].subCatFiles||resultData[1].subCatFiles.length<=0))Layout.Page.container.find("#noSubCatEmpDiv").find("#zp_page_loading").remove(),Layout.Page.container.find(".catHead").hide(),ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.nofiles"),Layout.Page.container.find("#noSubCatEmpDiv"));else if(void 0===resultData[1].subCatFiles||0==resultData[1].subCatFiles.length){var pageId=Layout.Page.container.find("#pers_fileListing"),nodata='<ul class="ZPListingUL noData">';nodata+='<li class="name"><span class="S16 dgry">'+ZPI18N.getString("zp.nofiles")+"</span></li>",nodata+="</ul>",pageId.html($(nodata))}else if(void 0===resultData[1].subCategory||0==resultData[1].subCategory.length){var pageId=Layout.Page.container.find("#hr_allfileList");nodata='<ul class="ZPListingUL noData">';nodata+='<li class=""><span class="S16 dgry">'+ZPI18N.getString("zp.nodatafound")+"</span></li>",nodata+="</ul>",pageId.html($(nodata))}void 0!==resultData[1].subCategory&&resultData[1].subCategory.length>0&&(Layout.Page.container.find("#noSubCatEmpDiv").hide(),Layout.Page.container.find("#filesSSmainDiv").show(),Files.SelfService.catForSelfService(resultData[1].subCategory)),isPFilesAllowed&&void 0!==resultData[1].subCatFiles&&resultData[1].subCatFiles.length>0&&(Layout.Page.container.find("#noSubCatEmpDiv").hide(),Layout.Page.container.find("#filesSSmainDiv").show(),Files.SelfService.SelfServiceFileRows(resultData[1].subCatFiles,void 0,!0))}}),Files.constructemp_addrev("activeEmp"),null!==mode&&void 0!==mode&&"opnRecent"===mode){var ele=Layout.Page.container.find("#hr_allfileList ul:first-child").attr("id"),firstCatId=ele.substring(ele.indexOf("_")+1,ele.length+1);Files.SelfService.fetchSSFilesByCatId(firstCatId)}},fetchSSFilesByCatId:function(catId){if(Layout.Page.container.find("#hrfileSS_"+catId).toggleClass("open"),null!=SelfService.getUserId()&&SelfService.getUserId()!==erecno&&(Layout.Page.container.find("#pers_fileListing").hide(),Layout.Page.container.find("#pf_SSHeader").hide()),Layout.Page.container.find("#hrfileSS_"+catId).hasClass("open")){var formData=new FormData;formData.append("methodName","subCategoryView"),formData.append("catId",catId),formData.append("parentCatId",catId),formData.append("conreqcsr",csrfToken),formData.append("isView","catview"),formData.append("filterBy","my"),formData.append("fileType",0),formData.append("start",0),formData.append("fileSortByType",3),formData.append("isFileSortDesc",!0),formData.append("ERECNO",SelfService.getUserId()),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){var childWrapper='<div class="catListChild"></div>';if(childWrapper=$(childWrapper),$(childWrapper).insertAfter(Layout.Page.container.find("#hrfileSS_"+catId)),Layout.Page.container.find("#hrfileSS_"+catId).find("#folderOpnCls").removeClass("CR-fld"),Layout.Page.container.find("#hrfileSS_"+catId).find("#folderOpnCls").addClass("CR-fld-opn"),void 0!==resultData[1].subCategory&&resultData[1].subCategory.length>0&&Files.SelfService.catForSelfService(resultData[1].subCategory,catId),void 0!==resultData[1].subCatFiles&&resultData[1].subCatFiles.length>0&&Files.SelfService.SelfServiceFileRows(resultData[1].subCatFiles,catId),(void 0===resultData[1].subCategory||resultData[1].subCategory.length<=0)&&(void 0===resultData[1].subCatFiles||resultData[1].subCatFiles.length<=0)){var ndPageId=Layout.Page.container.find("#hrfileSS_"+catId),row='<div class="catListChild" style="">';row+='<ul class="ZPListingUL"><li class=""><span class="S14 dgry ML35">'+ZPI18N.getString("zp.nofiles")+"</span></li>",row+="</ul></div>",$(row).insertAfter(ndPageId)}}})}else Layout.Page.container.find("#hrfileSS_"+catId).next(".catListChild").remove(),Layout.Page.container.find("#hrfileSS_"+catId).find("#folderOpnCls").addClass("CR-fld"),Layout.Page.container.find("#hrfileSS_"+catId).find("#folderOpnCls").removeClass("CR-fld-opn")},catForSelfService:function(MyFilesCatList,catId){var pageId="";null!==catId&&void 0!==catId&&"-1"!==catId?((pageId=Layout.Page.container.find("#hrfileSS_"+catId).next(".catListChild")).toggleClass("open"),Layout.Page.container.find("#hrfileSS_"+catId).find("#folderOpnCls").removeClass("CR-fld"),Layout.Page.container.find("#hrfileSS_"+catId).find("#folderOpnCls").addClass("CR-fld-opn")):pageId=Layout.Page.container.find("#hr_allfileList");for(var i=0;i<MyFilesCatList.length;i++){var row="",value=MyFilesCatList[i];row+='<ul id="hrfileSS_'+value.CatID+'" class="ZPListingUL" onclick="Files.SelfService.fetchSSFilesByCatId(\''+value.CatID+"')\">",row+='<li class="name">',row+='<div class="fileType"><i id="folderOpnCls" class="CR-fld"><i class="path1"><i class="path2"></i></i></i></div>',row+='<div class="nameDtl"><span class="ellip">'+value.CatName+"</span>",row+="</div></li></ul>",row=$(row),pageId.append(row)}},SelfServiceFileRows:function(fileObj,catId,isPersFile){var pageId="";null!==catId&&void 0!==catId&&"-1"!==catId&&(pageId=Layout.Page.container.find("#hrfileSS_"+catId).next(".catListChild")),void 0!==isPersFile&&null!==isPersFile&&isPersFile&&(pageId=Layout.Page.container.find("#pers_fileListing"));for(var i=0;i<fileObj.length;i++){var row="",data=fileObj[i];Files.isIprestricted=!1;var fileExtn=data.filePath,filePath=data.filePath,fileName=data.fileName,fileID=data.fileID;if(-1!=fileExtn.lastIndexOf(".")&&(fileExtn=(fileExtn=fileExtn.substr(fileExtn.lastIndexOf(".")+1,fileExtn.length)).toLowerCase()),ZPeople.IsNumeric(filePath)&&(fileExtn=data.fileExtn.toLowerCase()),-1!=filePath.indexOf("_signed")&&filePath.indexOf("_signed")>=-1&&-1!=filePath.lastIndexOf(".")&&(fileExtn=(fileExtn=filePath.substr(filePath.lastIndexOf(".")+1,filePath.length)).toLowerCase()),void 0!==isPersFile&&null!==isPersFile&&isPersFile?(row='<ul class="ZPListingUL" id="persfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'"  uploadFileExtn = "'+fileExtn+'">',row+='<li class="name" id="persfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'" onclick="Layout.Page.pageContWrapper.parent().prepend(Files.constructPreview(\'persfileTr_'+data.fileID+"','files'));Files.viewFile(this,'personal')\">"):(row+='<ul class="ZPListingUL" id="hrfileTr_'+fileID+'" fileName = "'+fileName+'" fileID = "'+fileID+'" agreementId = "'+data.agreementId+'" uploadFileExtn = "'+fileExtn+'" isLoginUserAck = '+data.isLoginUserAck+" isEmpFileAck = "+data.isEmpFileAck+">",data.filePath.indexOf(workDriveUrl)>-1||data.filePath.indexOf(writerUrl)>-1||data.filePath.indexOf(sheetUrl)>-1||data.filePath.indexOf(showUrl)>-1||"1"==data.UploadSource?(fileExtn="workdrive",row+='<li class="name" id="hrfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'" onclick="Files.openWDFiles(this)">'):row+='<li class="name" id="hrfileTr_'+data.fileID+'" fileName = "'+fileName+'" fileID = "'+data.fileID+'" onclick="Layout.Page.pageContWrapper.parent().prepend(Files.constructPreview(\'hrfileTr_'+data.fileID+"','files'));Files.viewFile(this,'hr')\">"),row+="pdf"===fileExtn?'<i class="IC-pdf"></i>':"xls"===fileExtn||"xlsx"===fileExtn||"xlsm"===fileExtn||"sxc"===fileExtn||"ods"===fileExtn||"csv"===fileExtn||"tsv"===fileExtn?'<i class="IC-xls-new"></i>':"htm"===fileExtn||"html"===fileExtn?'<i class="IC-code"></i>':"doc"===fileExtn||"docx"===fileExtn||"sxw"===fileExtn||"odt"===fileExtn||"rtf"===fileExtn?'<i class="IC-doc"></i>':"ppt"===fileExtn||"pps"===fileExtn||"odp"===fileExtn||"sxi"===fileExtn||"pptx"===fileExtn?'<i class="IC-ppt"></i>':"zip"===fileExtn?'<i class="IC-zip"></i>':"mp3"===fileExtn||"mp4a"===fileExtn||"wav"===fileExtn?'<i class="IC-mp3"></i>':"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn?'<i class="IC-jpg"></i>':"workdrive"===fileExtn?'<i class="IC-wd"></i>':'<i class="IC-doc"></i>',void 0===isPersFile||null==isPersFile&&!isPersFile){var previewIc;1===data.fileConfident&&(row+='<i class="CR-lock MR5" title="" data-placement="right" data-toggle="tooltip" data-original-title="Confidential"></i>'),row+='<div class="nameDtl">',row+='<span href="javascript:;" title="'+ZPeople.escapeHtml(ZPeople.decodeTxt(fileName))+'" class="ellip">'+ZPeople.escapeHtml(ZPeople.decodeTxt(fileName))+"</span>",row+='<span class="S13">'+ZPI18N.getString("zp.modifiedonby",[data.fileModifiedDate,""])+'<em class="blk">'+data.fileCreateByName+"</em></span>",row+="</div></li>",void 0!=data.module&&(previewIc="3"===data.module||"4"===data.module?'<li class="PR5 CP" onclick=Envelope.getEnvelopePreview("'+data.agreementId+'")><i id="send_agrmnt" data-toggle="modal" class="IC-send-file S14 grn FR MR15"></i>'+ZPI18N.getString("zp.documentdtls")+"</li>":"1"===data.module||"2"===data.module?'<li class="PR5 CP" onclick=Agreements.getAgreementPreview("'+data.agreementId+'")><i id="send_agrmnt" data-toggle="modal" class="IC-send-file S14 grn FR MR15"></i>'+ZPI18N.getString("zp.documentdtls")+"</li>":'<li class="PR5 CP" onclick=Zohosign.getDocumentPreview("'+data.agreementId+'")><i id="send_agrmnt" data-toggle="modal" class="IC-send-file S14 grn FR MR15"></i>'+ZPI18N.getString("zp.documentdtls")+"</li>"),void 0==isAnySignConfigured&&Zohosign.getEsignConfigurations();var esignAdmin=0==loginUserRoleCheck||1==loginUserRoleCheck||2==loginUserRoleCheck&&""==data.fileRoleID;Zohosign.populateDocumentView();var sendAgreementAction="";sendAgreementAction=(esignAdmin=0==loginUserRoleCheck||1==loginUserRoleCheck||2==loginUserRoleCheck&&""==data.fileRoleID)&&isAnySignConfigured&&isAdobeConfig&&ZPSetupCommon.isEmpty(data.agreementId)&&-1!==Agreements.adobeCompatibleExtns.indexOf(fileExtn)?'<i id="send_agrmnt" data-toggle="modal" class="IC-adobe" title="'+ZPI18N.getString("zp.requestsignature")+'"></i>':!esignAdmin||!isAdobeConfig&&"true"!=Zohosign.hasAdobesignRecord||"1"!==data.module&&"2"!==data.module?"":previewIc;var sendEnvelopeAction="";sendEnvelopeAction=esignAdmin&&isAnySignConfigured&&isDocuConfig&&ZPSetupCommon.isEmpty(data.agreementId)&&-1!==Envelope.add.docuCompatibleExtns.indexOf(fileExtn)?'<i id="send_envelope" data-toggle="modal" class="IC-docu" title="'+ZPI18N.getString("zp.requestsignature")+'"></i>':!esignAdmin||!isDocuConfig&&"true"!=Zohosign.hasDocusignRecord||"3"!==data.module&&"4"!==data.module?"":previewIc;var sendDocumentAction="";sendDocumentAction=esignAdmin&&isAnySignConfigured&&isZSConfig&&ZPSetupCommon.isEmpty(data.agreementId)&&-1!==Zohosign.add.docuCompatibleExtns.indexOf(fileExtn)?'<i id="send_document" data-toggle="modal" class="IC-zohosign" title="'+ZPI18N.getString("zp.requestsignature")+'"></i>':!esignAdmin||!isZSConfig&&"true"!=Zohosign.hasZohosignRecord||"5"!==data.module&&"6"!==data.module?"":previewIc;var actionIcs="";data.hasOwnProperty("agreementId")&&!ZPSetupCommon.isEmpty(data.agreementId)?(""!==sendAgreementAction?actionIcs+="<li>"+sendAgreementAction+"</li>":""!==sendEnvelopeAction?actionIcs+="<li>"+sendEnvelopeAction+"</li>":""!==sendDocumentAction&&(actionIcs+="<li>"+sendDocumentAction+"</li>"),actionIcs="3"===data.module||"4"===data.module?sendEnvelopeAction:"1"===data.module||"2"===data.module?sendAgreementAction:sendDocumentAction):""!==sendAgreementAction&&void 0!==sendAgreementAction?actionIcs+='<li class="PR5"  onclick=Agreements.openAgrModal("hr","'+data.fileID+'")>'+sendAgreementAction+ZPI18N.getString("zp.requestsignature")+"</li>":""!==sendEnvelopeAction&&void 0!==sendEnvelopeAction?actionIcs+='<li class="PR5"  onclick=Envelope.openCreateEnvelopeModal("hr","'+data.fileID+'")>'+sendEnvelopeAction+ZPI18N.getString("zp.requestsignature")+"</li>":""!==sendDocumentAction&&void 0!==sendDocumentAction&&(actionIcs+='<li class="PR5"  onclick=Zohosign.openCreateDocumentModal("hr","'+data.fileID+'")>'+sendDocumentAction+ZPI18N.getString("zp.requestsignature")+"</li>"),row+='<li class="actions">',-1!=loginUserRoleCheck&&(row+='<div id="action_confirm_btn" class="DN"><button class="btn btn-default btn-sm FR" onclick="Files.cancelDelRecConfirm(this, \'ZPAtt_entryDel_Action\');">'+ZPI18N.getString("zp.cancel")+"</button><button  class=\"btn btn-danger btn-sm FR MR10\" onclick=\"Files.deleteFiles('single','"+data.fileID+"',this,'hr')\">"+ZPI18N.getString("zp.confirm")+"</button></div>"),row+='<div class="FL">',""===data.fileDesc||void 0===data.fileDesc?row+="<i onmouseover='Files.hideCompFilesOptions(this)' data-popover='true' data-html='true' data-placement='bottom' data-content='<span class=\"DB S13\"><b>"+ZPI18N.getString("zp.reports.createdby")+' : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileCreateByName)+"</p></span>' class='CR-info popHover'></i>":row+="<i onmouseover='Files.hideCompFilesOptions(this)' data-popover='true' data-html='true' data-placement='bottom' data-content='<span class=\"DB S13\"><b>"+ZPI18N.getString("zp.reports.createdby")+' : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileCreateByName)+'</p></span><br> <span class="DB S13"><b>Description : </b> <p class="MT3">'+ZPeople.escapeHtml(data.fileDesc)+"</p></span>' class='CR-info popHover'></i>",(-1!=loginUserRoleCheck||0===data.fileConfident&&void 0!==data.fileOwnerName&&data.fileOwnerID===erecno||void 0!==data.fileRoleName&&0===data.fileConfident||void 0!==isreportingTo&&!0===isreportingTo&&1===data.isreportingTo)&&-1==data.filePath.indexOf(workDriveUrl)&&-1==data.filePath.indexOf(writerUrl)&&-1==data.filePath.indexOf(sheetUrl)&&-1==data.filePath.indexOf(showUrl)&&(row+='<i class="CR-imprt" onclick="Files.downloadFilecabinet(this)" name="deleteElm"></i>'),actionIcs.isEmpty||""===actionIcs||void 0===actionIcs||(row+='<div id="moreOptionsParDiv" class="dropdown ZPCusDrs  FL  ML10"><div data-hover="dropdown" data-toggle="dropdown" class="btn btn-sm btn-lgray moreDt"><i class="IC-more"></i></div>',row+='<ul class="dropdown-menu ZPCmn-Arrow top gray CP" id="moreFileOperations">'+actionIcs+"</div>"),row+='</div><div class="FR">',null!=data.fileActions.isEditPerm&&void 0!=data.fileActions.isEditPerm&&!0===data.fileActions.isEditPerm&&(ZPSetupCommon.isEmpty(data.agreementId)?row+="<i onclick=\"Files.showAddHRFile('edit',this, 'uploadmode')\" class=\"CR-edit\"></i>":row+='<i onclick="Files.showAddHRFile(\'edit\',this)" class="CR-edit"></i>'),null!=data.fileActions.isDeletePerm&&void 0!=data.fileActions.isDeletePerm&&!0===data.fileActions.isDeletePerm&&(row+='<i onclick="Files.deleteRecConfirm(this, \'action_confirm_btn\');" class="CR-delete"></i>')}else row+='<div class="nameDtl">',row+='<span href="javascript:;" title="'+ZPeople.escapeHtml(ZPeople.decodeTxt(fileName))+'" class="ellip">'+ZPeople.escapeHtml(ZPeople.decodeTxt(fileName))+"</span>",row+='<span class="S13">'+ZPI18N.getString("zp.modifiedonby",[data.fileModifiedDate,""])+'<em class="blk">'+data.fileCreateByName+"</em></span>",row+="</div></li>",row+='<li class="actions">',row+='<div id="action_confirm_btn" class="DN"><button class="btn btn-default btn-sm FR" onclick="Files.cancelDelRecConfirm(this);">'+ZPI18N.getString("zp.cancel")+"</button><button  class=\"btn btn-danger btn-sm FR MR10\" onclick=\"Files.deleteFiles('single','"+data.fileID+"',this,'personal')\">"+ZPI18N.getString("zp.confirm")+"</button></div>",row+='<div class="FL">',""!==data.fileDesc&&void 0!==data.fileDesc&&(row+="<i data-popover='true' data-placement='bottom' data-html='true' data-content='<span class=\"DB S13\"><b>Description : </b> <p class=\"MT3\">"+ZPeople.escapeHtml(data.fileDesc)+"</p></span>' class='CR-info popHover'></i>"),row+='<i class="CR-imprt" onclick="Files.downloadFilecabinet(this)" name="deleteElm"></i>',row+='</div><div class="FR">',row+='<i onclick="Files.showAddPersonalFile(\'edit\',this)" class="CR-edit"></i><i onclick="Files.deleteRecConfirm(this, \'action_confirm_btn\');" class="CR-delete"></i>',row+="</div>";row+="</ul>",(row=$(row)).data("ldata",data),pageId.append(row)}}},hideViewReport:function(){window.location.href=Files.previousUrl,Files.resetReportChanges()},resetReportChanges:function(){Files.previousUrl=null,Files.companyFileId=null,Zohosign.docStartindex=1,Files.companyFilesReport=!1,Layout.Page.container.find("#exportasZip").show(),Zohosign.reportSliderclose=!1},showViewReport:function(fileId){"files_zohosign_templatelistview"==Layout.Page.urlmode?Files.fileNameforCR=Layout.Page.container.find("#"+fileId).find("span:first").text():Files.fileNameforCR=Layout.Page.container.find("#compfileTr_"+fileId).attr("filename"),Files.previousUrl=Layout.Page.hash,Files.companyFilesReport=!0,Files.companyFileId=fileId,Files.fromcompFilesReportPage=!0,window.location.href="#files/zohosign/documentlistview"},displayCompFilesOptions:function(thisObj){$(thisObj).addClass("open"),$(thisObj).find("div").attr("aria-expanded",!0)},hideCompFilesOptions:function(thisObj){$(thisObj).parent("div").find("#moreOptionsParDiv").hasClass("open")&&($(thisObj).parent("div").find("#moreOptionsParDiv").removeClass("open"),$(thisObj).parent("div").find("#moreOptionsParDiv").find("div").removeAttr("aria-expanded",!0),$(thisObj).removeClass("open"),$(thisObj).find("div").attr("aria-expanded",!1))},isEsignatureAllowed:function(){$.ajax({type:"POST",async:!1,url:"/zohoSignActions.zp",data:{action:"isEsignatureAllowed",conreqcsr:csrfToken},success:function(data){Files.isEsignatureAllowedFlag=data[1][0]}})},Reports:{getPersonalFilesReports:function(){if(Layout.Page.hash.indexOf("files/report/personalfile")>-1&&(0===loginUserRoleCheck||1===loginUserRoleCheck))if(0===Files.reportsData.PF[0]&&Layout.Page.container.find("#pf_reportListing").html(ZPeople.LOADING_HTML),isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&!0===Files.reportsData.PF[1]){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked()}),$(document).on("click",function(){Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||(pageLoaded=!0)})}else if(!0===Files.reportsData.PF[1]){var params={methodName:"getFileReports",conreqcsr:csrfToken,start:Files.reportsData.PF[0]};Object.keys(Files.reportsData.PF[2]).length>0&&(null!==Files.reportsData.PF[2].employeeId&&void 0!==Files.reportsData.PF[2].employeeId&&"-1"!=Files.reportsData.PF[2].employeeId&&(params.employeeId=Files.reportsData.PF[2].employeeId),null!==Files.reportsData.PF[2].searchFileExtn&&void 0!==Files.reportsData.PF[2].searchFileExtn&&""!=Files.reportsData.PF[2].searchFileExtn&&(params.searchFileExtn=Files.reportsData.PF[2].searchFileExtn)),Files.setLatitudeLongitude(params),$.post(Files.ACTION.URL,params,function(resultData){resultData.hasOwnProperty("fail")?Files.isGeorestricted=!0:Files.isGeorestricted=!1,void 0!==resultData[1]?(resultData[1].length<24?Files.reportsData.PF[1]=!1:Files.reportsData.PF[1]=!0,resultData[1].length>0?(ZPeople.FireScroll.reset(),Files.Reports.constructPFReportRows(resultData[1])):0===Files.reportsData.PF[0]&&Files.showNodataMsg("reports"),0==Files.reportsData.PF[0]?Files.reportsData.PF[0]=25:Files.reportsData.PF[0]+=24):Files.isIprestrict(resultData)})}},constructPFReportRows:function(data){Layout.Page.container.find("#pf_reportListing").find("#zp_page_loading").remove();for(var pageId=Layout.Page.container.find("#pf_reportListing"),row="",i=0;i<data.length;i++){var value=data[i];row+='<ul class="ZPListingUL"><li class="name nameL"><div class="fileType BGtxt"><img src="'+value.EmpPhoto+'"></div>',row+='<div class="DIB"><span><em class="dgry">'+ZSEC.Encoder.encodeForHTML(value.EmpId)+' -</em><em class="bld ML2">'+value.EmpName+'</em></span><span class="DB S13 MT5">',value.FilesCount>1?row+='<span class="FL">'+value.FilesCount+" "+ZPI18N.getString("zp.files")+"</span>":row+='<span class="FL">'+value.FilesCount+" "+ZPI18N.getString("zp.file")+"</span>",row+="</span></div></li>",row+='<li class="tsize"> <span class="sze"><i class="CR-storage"></i>'+value.TotalSize+'</span><span class="divider"></span><div class="per">',row+='<span class="ZPprobar progress"><span class="progress-bar ZPprogrs PR" style="width: '+value.UsageRatio+'"></span></span>';var percentage=value.UsageRatio;percentage.split("%")[0]<1?row+='<span class="FL"> < 1% </span></div></li></ul>':row+='<span class="FL">'+percentage+"</span></div></li></ul>"}row=$(row),pageId.append(row)},registerPFReportsFilter:function(){Layout.Page.container.find("#show_hide_pfReport_filter, #show_hide_pfReport_filter .ZPRdlt").each(function(){this.onclick=function(){Files.isIprestricted||Files.isGeorestricted?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")):Files.isIprestricted||Files.isGeorestricted||(Layout.Page.container.find("#pfreportsfilterdiv").is(":visible")?(Layout.Page.container.find("#show_hide_pfReport_filter").toggleClass("sel"),$("#page-wrapper").removeClass("Nbar2F").addClass("Nbar5")):($("#page-wrapper").addClass("Nbar2F").removeClass("NBar5"),Layout.Page.container.find("#show_hide_pfReport_filter").toggleClass("sel")),Layout.Page.container.find("#select_employeelisting").select2(),Files.constructemp_addrev("activeEmp"),Layout.Page.container.find("#select_employeelisting").select2("val","-Select-"),Layout.Page.container.find("#search_PFReportsExtn").select2(),Files.openClsFilter("#show_hide_pfReport_filter"),Layout.Page.container.find("#pfreportsfilterdiv").slideToggle(100))}}),Layout.Page.container.find("#show_hide_pfReport_filter").on("mouseover",function(){Layout.Page.container.find(this).find(".IC-filter").toggleClass("sel")}),Layout.Page.container.find("#show_hide_pfReport_filter").on("mouseout",function(){Layout.Page.container.find(this).find(".IC-filter").toggleClass("sel")})},hidePFReportsFilter:function(){Layout.Page.container.find("#pfreportsfilterdiv").hide(),Layout.Page.container.find("#show_hide_pfReport_filter").removeClass("sel"),Files.searchFileBreadcrumbs()},searchPFReports:function(){var empId=Layout.Page.container.find("#select_employeelisting").select2("val");null!==empId&&void 0!==empId&&"-Select-"!==empId||(empId="-1");var searchFileExtn="";if(""!=Layout.Page.container.find("#search_PFReportsExtn").val()&&void 0!=Layout.Page.container.find("#search_PFReportsExtn").val()){var fileExtnType=Layout.Page.container.find("#search_PFReportsExtn").val();searchFileExtn=Files.fetchFileExtn(fileExtnType)}Files.reportsData.PF[0]=0,Files.reportsData.PF[1]=!0,Files.reportsData.PF[2].employeeId=empId,Files.reportsData.PF[2].searchFileExtn=searchFileExtn,Files.searchFileBreadcrumbs(),Files.Reports.getPersonalFilesReports(),Files.Reports.hidePFReportsFilter()},getAcknowledgmentPage:function(){if(Layout.Page.hash.indexOf("files/report/acknowledge")>-1&&(0===loginUserRoleCheck||1===loginUserRoleCheck))if(0===Files.reportsData.Ack[0]&&(Layout.Page.container.find("#ack_reportListing").html(ZPeople.LOADING_HTML),ZPeople.FireScroll.init(Files.Reports.getAcknowledgmentPage,"acknowledge_default")),isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&!0===Files.reportsData.Ack[1]){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked()}),$(document).click(function(){Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||(pageLoaded=!0)})}else if(!0===Files.reportsData.Ack[1]){if(Object.keys(Files.reportsData.Ack[2]).length>0)var params=Files.reportsData.Ack[2];else params={methodName:"acknowledgdeReports",conreqcsr:csrfToken,start:Files.reportsData.Ack[0]};Files.setLatitudeLongitude(params),$.post(Files.ACTION.URL,params,function(resultData){resultData.hasOwnProperty("fail")?Files.isGeorestricted=!0:Files.isGeorestricted=!1,void 0!==resultData[1]?(resultData[1].length<24?Files.reportsData.Ack[1]=!1:Files.reportsData.Ack[1]=!0,resultData[1].length>0?(ZPeople.FireScroll.reset(),Files.Reports.acknowledgementRows(resultData[1])):0===Files.reportsData.Ack[0]&&Files.showNodataMsg("acknowledgment"),0==Files.reportsData.Ack[0]?Files.reportsData.Ack[0]=25:Files.reportsData.Ack[0]=Files.reportsData.Ack[0]+24):Files.isIprestrict(resultData)})}},acknowledgementRows:function(data){Layout.Page.container.find("#ack_reportListing").find("#zp_page_loading").remove();for(var pageId=Layout.Page.container.find("#ack_reportListing"),row="",i=0;i<data.length;i++){var value=data[i];row+='<ul id="ackRow_'+value.FILEID+'" isUserSharedNodeCheck="'+value.isUserSharedNodeCheck+'" class="ZPListingUL" data-toggle="modal" data-target="#acklistC" onclick="FilesLite.Reports.ackFileDetailReport.getAcknowledgementDetails(\''+value.FILEID+"');\">",row+='<li class="name"><span class="ellip">'+value.FILENAME+"</span></li>",row+='<li class="red"><b>'+value.AcknowledgeCount+"</b></li></ul>"}row=$(row),pageId.append(row)},confirmAcknowledgement:function(fileId,isEmpBasedFile){var myrevokeStatus=Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".ZPack").hasClass("ack_pndng");$("#confirmationPopup").modal("show"),$("#confirmationPopup").modal({backdrop:"static",keyboard:!1}),myrevokeStatus?($("#textConfirmationPopupHeader").html("").append(ZPI18N.getString("zp.files.ackpopuptitle")),$("#textConfirmationPopupBody").html("").append(ZPI18N.getString("zp.wanttoacknowledge")),$("#confirmConfirmationPopup").html("").append(ZPI18N.getString("zp.confirm"))):($("#textConfirmationPopupHeader").html("").append(ZPI18N.getString("zp.files.revokeacktitle")),$("#textConfirmationPopupBody").html("").append(ZPI18N.getString("zp.wantotrevokeack")),$("#confirmConfirmationPopup").html("").append(ZPI18N.getString("zp.confirm"))),$("#confirmConfirmationPopup").unbind("click"),$("#cancelConfirmationPopup").unbind("click"),$("#confirmConfirmationPopup").click(function(event){Files.Reports.addAcknowledgement(fileId,isEmpBasedFile)}),$("#cancelConfirmationPopup").click(function(event){$("#confirmationPopup").modal("hide")})},checkAckNodes:function(fileId,rowData){var isUserSharedNodeCheck=!1;if("#files/report/acknowledge"===Layout.Page.hash)isUserSharedNodeCheck=Layout.Page.container.find("#acknowledge_default").find("#ack_reportListing").find("#ackRow_"+fileId).attr("isusersharednodecheck");else if(Object.keys(Files.ackPrv).length>0)null!=Files.ackPrv.isFromFeeds&&void 0!=Files.ackPrv.isFromFeeds&&1==Files.ackPrv.isFromFeeds&&(isUserSharedNodeCheck=Files.ackPrv.isUserSharedNodeCheck);else if(Layout.Page.hash.indexOf("/listview")>-1||Layout.Page.hash.indexOf("/view-categoryId")>-1||Layout.Page.hash.indexOf("selfservice/user/files")>-1||Layout.Page.hash.indexOf("home/dashboard")>-1){if(null==rowData||void 0==rowData)if(Layout.Page.hash.indexOf("#home/dashboard")>-1)rowData=Layout.Page.container.find("div[name=FILES]").find("li[fileId='"+fileId+"']").data().ldata;else rowData=Layout.Page.container.find("ul[fileId='"+fileId+"']").data().ldata;if(1===rowData.fileType){var sharedNodes=rowData.fileOrgStructure;0==Object.keys(sharedNodes).length?isUserSharedNodeCheck=!0:(null!==sharedNodes.Entity&&void 0!==sharedNodes.Entity&&""!==sharedNodes.Entity&&ZPeople.CURR_USER.entityId in sharedNodes.Entity&&(isUserSharedNodeCheck=!0),null!==sharedNodes.Unit&&void 0!==sharedNodes.Unit&&""!==sharedNodes.Unit&&ZPeople.CURR_USER.unitId in sharedNodes.Unit&&(isUserSharedNodeCheck=!0),null!==sharedNodes.Division&&void 0!==sharedNodes.Division&&""!==sharedNodes.Division&&ZPeople.CURR_USER.divId in sharedNodes.Division&&(isUserSharedNodeCheck=!0),null!==sharedNodes.Department&&void 0!==sharedNodes.Department&&""!==sharedNodes.Department&&ZPeople.CURR_USER.deptId in sharedNodes.Department&&(isUserSharedNodeCheck=!0),null!==sharedNodes.Location&&void 0!==sharedNodes.Location&&""!==sharedNodes.Location&&ZPeople.CURR_USER.locId in sharedNodes.Location&&(isUserSharedNodeCheck=!0))}else{if(null!==rowData.fileOwnerID&&void 0!==rowData.fileOwnerID&&""!==rowData.fileOwnerID)rowData.fileOwnerID===erecno&&(isUserSharedNodeCheck=!0);else rowData.fileRoleID.includes(ZPeople.CURR_USER.roleId)&&(isUserSharedNodeCheck=!0)}}else isUserSharedNodeCheck=!(1!=rowData&&!ZPeople.onBoardingStatus);return isUserSharedNodeCheck},acknowledgementStatus:function(fileId,fileAck,fileOwner,isEmpFileAck,isLoginUserAck,isFromPreview,rowData,extraProps){var pageId=Layout.Page.container.find("ul[fileId='"+fileId+"']"),isFromFeeds=!1;null!=extraProps&&void 0!=extraProps&&Object.keys(extraProps).length>0?extraProps.isFromFeeds&&(Files.ackPrv=extraProps,isFromFeeds=!0):Files.ackPrv={},1!=isFromFeeds&&(Layout.Page.hash.indexOf("#files/report/acknowledge")>-1?(isEmpFileAck=pageId.attr("isEmpFileAck"),isLoginUserAck=pageId.attr("isLoginUserAck")):Layout.Page.hash.indexOf("#home/dashboard")>-1&&(isEmpFileAck=(rowData=Layout.Page.container.find("div[name=FILES]").find("li[fileId='"+fileId+"']").data().ldata).isEmpFileAck,isLoginUserAck=rowData.isLoginUserAck,fileAck=rowData.fileAcknowledge));var row="";return 1===fileAck||"1"===fileAck?null!==fileOwner&&void 0!==fileOwner&&""!==fileOwner?Files.Reports.checkAckNodes(fileId,rowData)?null!==isFromPreview&&void 0!==isFromPreview&&1==isFromPreview?"true"===isEmpFileAck.toString()?(row+='<div class="ack_chck"><label class="checkbox FL MR20"><input id="ack_chckBox" type="checkbox" checked="true" onclick="Files.Reports.addAcknowledgement(\''+fileId+"',true, false);\">",row+='<span class="ML5">'+ZPI18N.getString("zp.ackread")+"</span></label></div>"):(row+='<div class="ack_chck"><label class="checkbox FL MR20"><input id="ack_chckBox" type="checkbox" onclick="Files.Reports.addAcknowledgement(\''+fileId+"',true, false);\">",row+='<span class="ML5">'+ZPI18N.getString("zp.ackread")+"</span></label></div>"):"true"===isEmpFileAck.toString()?row+='<li class="W60 ZPack ack_actv" onclick="Files.Reports.confirmAcknowledgement(\''+fileId+'\',true);"><i class="CR-ack-success"></i></li>':row+='<li class="W60 ZPack ack_pndng" onclick="Files.Reports.confirmAcknowledgement(\''+fileId+'\',true);"><i class="CR-ack-pending"></i></li>':null!==isFromPreview&&void 0!==isFromPreview&&1==isFromPreview?"true"===isEmpFileAck.toString()?(row+='<div class="ack_chck"><label class="checkbox FL MR20"><input id="ack_chckBox" type="checkbox" checked="true" disabled>',row+='<span class="ML5">'+ZPI18N.getString("zp.ackread")+"</span></label></div>"):(row+='<div class="ack_chck"><label class="checkbox FL MR20"><input id="ack_chckBox" type="checkbox" disabled>',row+='<span class="ML5">'+ZPI18N.getString("zp.ackread")+"</span></label></div>"):"true"===isEmpFileAck.toString()?row+='<li class="W60 ZPack ack_actv"><i class="CR-ack-success"></i></li>':row+='<li class="W60 ZPack ack_nactv"><i class="CR-ack-success"></i></li>':null!==isFromPreview&&void 0!==isFromPreview&&1==isFromPreview?Files.Reports.checkAckNodes(fileId,rowData)?"true"===isLoginUserAck.toString()?(row+='<div class="ack_chck"><label class="checkbox FL MR20"><input id="ack_chckBox" type="checkbox" checked="true" onclick="Files.Reports.addAcknowledgement(\''+fileId+"',false,false);\">",row+='<span class="ML5">'+ZPI18N.getString("zp.ackread")+"</span></label></div>"):(row+='<div class="ack_chck"><label class="checkbox FL MR20"><input id="ack_chckBox" type="checkbox" onclick="Files.Reports.addAcknowledgement(\''+fileId+"',false,false);\">",row+='<span class="ML5">'+ZPI18N.getString("zp.ackread")+"</span></label></div>"):"true"===isLoginUserAck.toString()?(row+='<div class="ack_chck"><label class="checkbox FL MR20"><input id="ack_chckBox" type="checkbox" checked="true" disabled>',row+='<span class="ML5">'+ZPI18N.getString("zp.ackread")+"</span></label></div>"):(row+='<div class="ack_chck"><label class="checkbox FL MR20"><input id="ack_chckBox" type="checkbox" disabled>',row+='<span class="ML5">'+ZPI18N.getString("zp.ackread")+"</span></label></div>"):Files.Reports.checkAckNodes(fileId,rowData)?"true"===isLoginUserAck.toString()?row+='<li class="W60 ZPack ack_actv" onclick="Files.Reports.confirmAcknowledgement(\''+fileId+'\',false);"><i class="CR-ack-success"></i></li>':row+='<li class="W60 ZPack ack_pndng" onclick="Files.Reports.confirmAcknowledgement(\''+fileId+'\',false);"><i class="CR-ack-pending"></i></li>':"true"===isLoginUserAck.toString()?row+='<li class="W60 ZPack ack_actv"><i class="CR-ack-success"></i></li>':row+='<li class="W60 ZPack ack_nactv"><i class="CR-ack-success"></i></li>':null!=isFromPreview&&void 0!=isFromPreview&&0!=isFromPreview||(row+='<li class="W60 ZPack"></li>'),row},addAcknowledgement:function(fileId,isEmpBasedFile,isFromDetailsPage){var ackCheck="",isRevoke=!1;ackCheck=null!==isEmpBasedFile&&void 0!==isEmpBasedFile&&1==isEmpBasedFile?Object.keys(Files.ackPrv).length>0&&null!=Files.ackPrv.isFromFeeds&&void 0!=Files.ackPrv.isFromFeeds&&1==Files.ackPrv.isFromFeeds?Files.ackPrv.isEmpFileAck:Layout.Page.container.find("ul[fileId='"+fileId+"']").attr("isEmpFileAck"):null!==isFromDetailsPage&&void 0!==isFromDetailsPage&&1==isFromDetailsPage?Layout.Page.container.find("div#ackFileReport").attr("isLoginUserAck"):ZPeople.onBoardingStatus?Layout.Page.container.find("#onBoardingRightPane").find("li#"+fileId).attr("isLoginUserAck"):Object.keys(Files.ackPrv).length>0&&null!=Files.ackPrv.isFromFeeds&&void 0!=Files.ackPrv.isFromFeeds&&1==Files.ackPrv.isFromFeeds?Files.ackPrv.isLoginUserAck:Layout.Page.container.find("ul[fileId='"+fileId+"']").attr("isLoginUserAck"),Layout.Page.hash.indexOf("#home/dashboard")>-1&&(rowData=Layout.Page.container.find("div[name=FILES]").find("li[fileId='"+fileId+"']").data().ldata,ackCheck=rowData.isLoginUserAck),isRevoke="true"===ackCheck||!0===ackCheck;var fileType="";null!==isFromDetailsPage&&void 0!==isFromDetailsPage&&1==isFromDetailsPage&&(fileId=Layout.Page.container.find("div#ackFileReport").attr("fileId"),fileType=Layout.Page.container.find("div#ackFileReport").attr("fileType"));var isUserSharedNodeCheck=!1;if(null!==(isUserSharedNodeCheck=null!==isFromDetailsPage&&void 0!==isFromDetailsPage&&1==isFromDetailsPage?Layout.Page.container.find("#ackFilesReportBody").find("#ackRow_"+fileId).attr("isusersharednodecheck"):Files.Reports.checkAckNodes(fileId,void 0))&&void 0!==isUserSharedNodeCheck&&(0==isUserSharedNodeCheck||"false"==isUserSharedNodeCheck)){var id="alert-danger",outerCont=$("#top_message_outer");if($("#top_message_outer").children("div").is(":visible")){var prevId=$("#top_message_outer").children("div").attr("id");ZPeople.Message.clearTimeout(),ZPeople.Message.fadeMessage(prevId)}return outerCont.html('<div class="alert Apos '+id+'" id="'+id+'" style="z-index:1002";">'+ZPI18N.getString("zp.permissiondenied")+'<button class="close" type="button" onclick="ZPeople.Message.fadeMessage()"><span><div class="IC-cls-1px gry S10"></div></span></button></div>'),outerCont.find("."+id).fadeIn(300),void ZPeople.Message.setMessageTime(id,5e3)}var params={methodName:"addAcknowledgement",fileId:fileId,isRevoke:isRevoke,conreqcsr:csrfToken};Files.setLatitudeLongitude(params),$.post(Files.ACTION.URL,params,function(resultData){if(void 0!==resultData[1]){if(!0!==resultData[1])return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));if(!0===isRevoke)if(null!==isEmpBasedFile&&void 0!==isEmpBasedFile&&1==isEmpBasedFile)Layout.Page.hash.indexOf("#home/dashboard")>-1?Layout.Page.container.find("div[name=FILES]").find("li[fileId='"+fileId+"']").data().ldata.isEmpFileAck=!1:Object.keys(Files.ackPrv).length>0&&null!=Files.ackPrv.isFromFeeds&&void 0!=Files.ackPrv.isFromFeeds&&1==Files.ackPrv.isFromFeeds?Files.ackPrv.isEmpFileAck=!1:(Layout.Page.container.find("ul[fileId='"+fileId+"']").attr("isEmpFileAck","false"),Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".CR-ack-success").parent().removeClass("ack_actv").addClass("ack_pndng"),Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".ack_pndng").find("i").removeClass("CR-ack-success").addClass("CR-ack-pending"),Layout.Page.container.find("ul[fileId='"+fileId+"']").data().ldata.isEmpFileAck=!1);else if(null!==isFromDetailsPage&&void 0!==isFromDetailsPage&&1==isFromDetailsPage){Layout.Page.container.find("div#ackFileReport").attr("isLoginUserAck","false"),FilesLite.Reports.ackFileDetailReport.closeAckModal();var ackCnt=Layout.Page.container.find("#ackRow_"+fileId).find(".red").find("b").html();Layout.Page.container.find("#ackRow_"+fileId).find(".red").find("b").html(parseInt(ackCnt)-1),-1===Layout.Page.hash.indexOf("listview")&&-1===Layout.Page.hash.indexOf("/view")||(Layout.Page.container.find("ul[fileId='"+fileId+"']").attr("isLoginUserAck","false"),Layout.Page.container.find("ul[fileId='"+fileId+"']").data().ldata.isLoginUserAck=!1,Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".CR-ack-success").parent().removeClass("ack_actv").addClass("ack_pndng"),Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".ack_pndng").find("i").removeClass("CR-ack-success").addClass("CR-ack-pending"))}else Layout.Page.hash.indexOf("#home/dashboard")>-1?Layout.Page.container.find("div[name=FILES]").find("li[fileId='"+fileId+"']").data().ldata.isLoginUserAck=!1:Object.keys(Files.ackPrv).length>0&&null!=Files.ackPrv.isFromFeeds&&void 0!=Files.ackPrv.isFromFeeds&&1==Files.ackPrv.isFromFeeds?Files.ackPrv.isLoginUserAck=!1:ZPeople.onBoardingStatus?ZPOnboarding.acknowledgeResponse(fileId,"false","CR-ack-pending","ack-pnding"):(Layout.Page.container.find("ul[fileId='"+fileId+"']").attr("isLoginUserAck","false"),Layout.Page.container.find("ul[fileId='"+fileId+"']").data().ldata.isLoginUserAck=!1,Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".CR-ack-success").parent().removeClass("ack_actv").addClass("ack_pndng"),Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".ack_pndng").find("i").removeClass("CR-ack-success").addClass("CR-ack-pending"));else if(null!==isEmpBasedFile&&void 0!==isEmpBasedFile&&1==isEmpBasedFile)Layout.Page.hash.indexOf("#home/dashboard")>-1?Layout.Page.container.find("div[name=FILES]").find("li[fileId='"+fileId+"']").data().ldata.isEmpFileAck=!0:Object.keys(Files.ackPrv).length>0&&null!=Files.ackPrv.isFromFeeds&&void 0!=Files.ackPrv.isFromFeeds&&1==Files.ackPrv.isFromFeeds?Files.ackPrv.isEmpFileAck=!0:(Layout.Page.container.find("ul[fileId='"+fileId+"']").attr("isEmpFileAck","true"),Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".CR-ack-pending").parent().removeClass("ack_pndng").addClass("ack_actv"),Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".ack_actv").find("i").removeClass("CR-ack-pending").addClass("CR-ack-success"),Layout.Page.container.find("ul[fileId='"+fileId+"']").data().ldata.isEmpFileAck=!0);else if(null!==isFromDetailsPage&&void 0!==isFromDetailsPage&&1==isFromDetailsPage){Layout.Page.container.find("div#ackFileReport").attr("isLoginUserAck","true"),FilesLite.Reports.ackFileDetailReport.closeAckModal();ackCnt=Layout.Page.container.find("#ackRow_"+fileId).find(".red").find("b").html();Layout.Page.container.find("#ackRow_"+fileId).find(".red").find("b").html(parseInt(ackCnt)+1),-1===Layout.Page.hash.indexOf("listview")&&-1===Layout.Page.hash.indexOf("/view")||(Layout.Page.container.find("ul[fileId='"+fileId+"']").attr("isLoginUserAck","true"),Layout.Page.container.find("ul[fileId='"+fileId+"']").data().ldata.isLoginUserAck=!0,Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".CR-ack-pending").parent().removeClass("ack_pndng").addClass("ack_actv"),Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".ack_actv").find("i").removeClass("CR-ack-pending").addClass("CR-ack-success"))}else Layout.Page.hash.indexOf("#home/dashboard")>-1?Layout.Page.container.find("div[name=FILES]").find("li[fileId='"+fileId+"']").data().ldata.isLoginUserAck=!0:Object.keys(Files.ackPrv).length>0&&null!=Files.ackPrv.isFromFeeds&&void 0!=Files.ackPrv.isFromFeeds&&1==Files.ackPrv.isFromFeeds?Files.ackPrv.isLoginUserAck=!0:ZPeople.onBoardingStatus?ZPOnboarding.acknowledgeResponse(fileId,"true","CR-ack-success","ack-actv"):(Layout.Page.container.find("ul[fileId='"+fileId+"']").attr("isLoginUserAck","true"),Layout.Page.container.find("ul[fileId='"+fileId+"']").data().ldata.isLoginUserAck=!0,Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".CR-ack-pending").parent().removeClass("ack_pndng").addClass("ack_actv"),Layout.Page.container.find("ul[fileId='"+fileId+"']").find(".ack_actv").find("i").removeClass("CR-ack-pending").addClass("CR-ack-success"));if("1"==fileType?(Files.orgListViewData.Org[0]=0,Files.orgListViewData.Org[1]=!0):null!==isEmpBasedFile&&void 0!==isEmpBasedFile&&1==isEmpBasedFile?(Files.empListViewData.All[0]=0,Files.empListViewData.All[1]=!0,Files.empListViewData.Sub[0]=0,Files.empListViewData.Sub[1]=!0,Files.empListViewData.My[0]=0,Files.empListViewData.My[1]=!0):(Files.empListViewData.Role[0]=0,Files.empListViewData.Role[1]=!0),1==isRevoke)if(null!=Layout.Page.pageContWrapper&&Layout.Page.pageContWrapper.parent().find("#viewPreviewFileDiv").is(":visible")){var id="alert-success",outerCont=$("#top_message_outer");if($("#top_message_outer").children("div").is(":visible")){var prevId=$("#top_message_outer").children("div").attr("id");ZPeople.Message.clearTimeout(),ZPeople.Message.fadeMessage(prevId)}outerCont.html('<div class="alert Apos '+id+'" id="'+id+'" style="z-index:1002";">'+ZPI18N.getString("zp.acknowledgerevoked")+'<button class="close" type="button" onclick="ZPeople.Message.fadeMessage()"><span><div class="IC-cls-1px gry S10"></div></span></button></div>'),outerCont.find("."+id).fadeIn(300),ZPeople.Message.setMessageTime(id,5e3)}else ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.acknowledgerevoked"));else if(null!=Layout.Page.pageContWrapper&&Layout.Page.pageContWrapper.parent().find("#viewPreviewFileDiv").is(":visible")){id="alert-success",outerCont=$("#top_message_outer");if($("#top_message_outer").children("div").is(":visible")){prevId=$("#top_message_outer").children("div").attr("id");ZPeople.Message.clearTimeout(),ZPeople.Message.fadeMessage(prevId)}outerCont.html('<div class="alert Apos '+id+'" id="'+id+'" style="z-index:1002";">'+ZPI18N.getString("zp.acknowledgedsuccess")+'<button class="close" type="button" onclick="ZPeople.Message.fadeMessage()"><span><div class="IC-cls-1px gry S10"></div></span></button></div>'),outerCont.find("."+id).fadeIn(300),ZPeople.Message.setMessageTime(id,5e3)}else ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.acknowledgedsuccess"))}})},closeAckModal:function(){Files.reportsData.AckDetails[0]=0,Files.reportsData.AckDetails[1]=!0,Files.reportsData.AckDetails[2]=-1,Layout.Page.container.find("#ack_reportListing").find("ul").removeClass("seltd")},registerAckFilter:function(){Layout.Page.container.find("#show_hide_acknowledgement_filter, #show_hide_acknowledgement_filter .ZPRdlt").each(function(){this.onclick=function(){if(Files.isIprestricted||Files.isGeorestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));else if(!Files.isIprestricted&&!Files.isGeorestricted){Layout.Page.container.find("#ackfilterdiv").is(":visible")?(Layout.Page.container.find("#show_hide_acknowledgement_filter").toggleClass("sel"),$("#page-wrapper").removeClass("Nbar2F").addClass("Nbar5")):($("#page-wrapper").addClass("Nbar2F").removeClass("NBar5"),Layout.Page.container.find("#show_hide_acknowledgement_filter").toggleClass("sel")),Layout.Page.container.find("#search_ackextn").select2();var extnVal=Layout.Page.container.find("#search_ackextn").val();null==extnVal||void 0==extnVal||""==extnVal?Layout.Page.container.find("#search_ackextn").select2("val","-1"):Layout.Page.container.find("#search_ackextn").select2("val",extnVal),Files.openClsFilter("#show_hide_acknowledgement_filter"),Layout.Page.container.find("#ackfilterdiv").slideToggle(100)}}}),Layout.Page.container.find("#show_hide_acknowledgement_filter").mouseover(function(){Layout.Page.container.find(this).find(".IC-filter").toggleClass("sel")}),Layout.Page.container.find("#show_hide_acknowledgement_filter").mouseout(function(){Layout.Page.container.find(this).find(".IC-filter").toggleClass("sel")})},hideAckFilter:function(){Layout.Page.container.find("#ackfilterdiv").hide(),Layout.Page.container.find("#show_hide_acknowledgement_filter").removeClass("sel"),Files.searchFileBreadcrumbs()},searchAcknowledgement:function(){Files.reportsData.Ack[1]=!0,Files.reportsData.Ack[0]=0,Layout.Page.container.find("#ack_reportListing").html("");var errflag=!1,fromDate="";fromDate=""!=Layout.Page.container.find("#acksearch_fromDate").val()&&void 0!=Layout.Page.container.find("#acksearch_fromDate").val()&&0!=Layout.Page.container.find("#acksearch_fromDate").val()?Layout.Page.container.find("#acksearch_fromDate").val():"-1";var toDate="";toDate=""!=Layout.Page.container.find("#acksearch_toDate").val()&&void 0!=Layout.Page.container.find("#acksearch_toDate").val()&&0!=Layout.Page.container.find("#acksearch_toDate").val()?Layout.Page.container.find("#acksearch_toDate").val():"-1";var searchFileName="";""!=Layout.Page.container.find("#search_ackname").val()&&void 0!=Layout.Page.container.find("#search_ackname").val()&&(searchFileName=Layout.Page.container.find("#search_ackname").val());var searchFileExtn="";if(""!=Layout.Page.container.find("#search_ackextn").val()&&void 0!=Layout.Page.container.find("#search_ackextn").val()){var fileExtnType=Layout.Page.container.find("#search_ackextn").val();searchFileExtn=Files.fetchFileExtn(fileExtnType)}if(!1===Files.searchWithDateValidation(Layout.Page.container.find("#acksearch_fromDate").val(),Layout.Page.container.find("#acksearch_toDate").val())&&(errflag=!0),errflag)return!1;if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&ZPSetupCommon.isEmpty(mode)){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.searchAcknowledgement(position,"search")},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.searchAcknowledgement("","search")}),isBlocked||$(document).click(function(e){Files.Geo.positionBlocked(),-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||!ZPSetupCommon.isEmpty($(e.target).attr("class"))&&$(e.target).text()===ZPI18N.getString("zp.search")||(pageLoaded=!0,Files.searchAcknowledgement("","search"))})}else Files.reportsData.Ack[2]={methodName:"acknowledgdeReports",start:Files.reportsData.Ack[0],conreqcsr:csrfToken,searchFileName:searchFileName,searchFileExtn:searchFileExtn},null!=fromDate&&void 0!==fromDate&&""!==fromDate&&"-1"!==fromDate&&(Files.reportsData.Ack[2].fromDate=fromDate),null!=toDate&&void 0!==toDate&&""!==toDate&&"-1"!==toDate&&(Files.reportsData.Ack[2].toDate=toDate),Files.setLatitudeLongitude(Files.reportsData.Ack[2]),Files.searchFileBreadcrumbs(),Files.Reports.getAcknowledgmentPage(),Files.Reports.hideAckFilter()}},openHelp:function(){window.open("https://www.zoho.com/people/help/adminguide/company-files.html#hrformsandtemplates")},Esign:{getAgreementsListPage:function(mode,isFromEmployeeView,isMailMerge){Agreements.selectedRecpForm=null,$("#zp-contwrap-files-zohosign").removeClass("zp_files"),Zohosign.isfromFilterView&&Layout.Page.container.find("#zp_esign_view").select2("val","2");var pageId=Layout.Page.container;if(Agreements.funcToOpenFilter(),0==$("#filter_params").find("span").length&&$("#page-wrapper").removeClass("filter-container"),"#files/fileView/agreementslistview"===Layout.Page.hash||"#files/adobesign/agreementslistview"===Layout.Page.hash&"hr"!=mode)$("#page-wrapper").addClass("filter-container"),Agreements.isCachedAgrList||Agreements.getAgreementsList(null,null,!1);else if(-1!==Layout.Page.hash.indexOf("agreementId:")){var agrID=pageId.find("div#viewAgreementModal").attr("agrId");ZPSetupCommon.isEmpty(agrID)&&(agrID=Layout.Page.hash.split("agreementId:")[1]),-1===Layout.Page.hash.indexOf("agreementslistview")||Agreements.isCachedAgrList||Agreements.getAgreementsList(null,null,!1),Agreements.getAgreementPreview(agrID)}else if(-1!==Layout.Page.hash.indexOf("createAgreement")||"company"===mode||"hr"===mode||isFromEmployeeView){Agreements.openAgreement(mode,isFromEmployeeView,isMailMerge);var createAgrModal=pageId.find("div#createAgreementModal"),inputFile=createAgrModal.find("input#agmntFile"),inputType="agreements"===mode||ZPSetupCommon.isEmpty(mode)?"file":"text";if(inputFile.prop("type",inputType),Agreements.isCachedAgrList||!ZPSetupCommon.isEmpty(mode)||isFromEmployeeView||Agreements.getAgreementsList(null,null,!1),!ZPSetupCommon.isEmpty(mode)&&("company"===mode||"hr"===mode)){var getFileNameObj="company"===mode?$("tbody#comp_fileList"):$("tbody#hr_allfileList");null==Agreements.fileId&&(Agreements.fileId=Layout.Page.hash.split("createAgreement:")[1]),null==Agreements.fileName&&(Agreements.fileName=getFileNameObj.find("tr[fileID="+Agreements.fileId+"]").attr("fileName")),createAgrModal.find("span#drop_file").text(Agreements.fileName),createAgrModal.data({fileId:Agreements.fileId})}}(("#files/fileView/agreementslistview"===Layout.Page.hash||"#files/adobesign/agreementslistview"===Layout.Page.hash)&&!Agreements.isFilterCached||Agreements.isFromEmployeeView&&!Agreements.isFormCatListCached||void 0!=createAgrModal&&0===createAgrModal.find("div#s2id_agrselect_Cat").length)&&(0==Object.keys(Files.newCategoryList).length?ZPeople.Request.sendAsyncPost("/fileCabinetAction.zp",{methodName:"getCategoryList",conreqcsr:csrfToken},Agreements.openFilter):Agreements.openFilter(Files.newCategoryList)),Agreements.constructLanguage(),"agreements"===mode&&pageId.find("i#agrm_filterIc").attr("class").indexOf("ZPFilsel")>-1&&$("div#page-wrapper").attr("class","Nbar2F")},getEnvelopeListpage:function(mode,isFromFormView,isMailMerge){$("#zp-contwrap-files-zohosign").removeClass("zp_files"),Zohosign.isfromFilterView&&Layout.Page.container.find("#zp_esign_view").select2("val","4");var pageId=Layout.Page.container;if("cancel"===mode){if(Envelope.selectedRecpForm=null,pageId.find("div#createEnvelopeModal").removeClass("PopMdxModel l0"),0==$("#filter_params").find("span").length&&$("#page-wrapper").removeClass("filter-container"),Envelope.isFromFormView&&-1==Layout.Page.hash.indexOf("-envelopeId"))return;if(Layout.Page.hash.indexOf("-formId:")>-1)return void Layout.Page.container.find("div#viewEnvelopeModal").modal("hide");if(Layout.Page.hash.indexOf("-envelopeId")>-1||-1!==Layout.Page.hash.indexOf("-createEnvelope"))return void(window.location.href=Layout.Page.hash.split("-")[0])}else{-1!==Layout.Page.hash.indexOf("-createEnvelope")||"hr"==mode?Envelope.openEnvModal("","",isFromFormView):Layout.Page.hash.indexOf("envelopeId:")>-1?Envelope.getEnvelopePreview():(Layout.Page.hash.indexOf("-formId:")>-1||Layout.Page.hash.indexOf("-formLinkName:")>-1||Layout.Page.hash.indexOf("selfservice/user")>-1)&&Envelope.openEnvModal(isFromFormView,isMailMerge);var createEnvModal=pageId.find("div#createEnvelopeModal");"#files/fileView/doculistview"!==Layout.Page.hash&&"#files/docusign/doculistview"!==Layout.Page.hash||$("#page-wrapper").addClass("filter-container"),(("#files/fileView/doculistview"===Layout.Page.hash||"#files/docusign/doculistview"===Layout.Page.hash)&&!Envelope.isFilterCached||Envelope.isFromEmployeeView&&!Envelope.isFormCatListCached||void 0!=createEnvModal&&0===createEnvModal.find("div#s2id_agrselect_Cat").length)&&(0==Object.keys(Files.newCategoryList).length?ZPeople.Request.sendAsyncPost("/fileCabinetAction.zp",{methodName:"getCategoryList",conreqcsr:csrfToken},Envelope.openFilter):Envelope.openFilter(Files.newCategoryList))}!Envelope.isCachedEnvelopeList&&Layout.Page.hash.indexOf("doculistview")>-1&&($("#page-wrapper").addClass("filter-container"),Envelope.getEnvelopeList())},getDocumentsListPage:function(mode,isFromFormView){if($("#zp-contwrap-files-zohosign").removeClass("zp_files"),Zohosign.isfromFilterView&&Layout.Page.container.find("#zp_esign_view").select2("val","6"),"cancel"===mode){var pageId=Layout.Page.container;if(Zohosign.selectedRecpForm=null,Zohosign.editSignTempId="",pageId.find("div#createDocumentModal").removeClass("PopMdxModel l0"),0==$("#filter_params").find("span").length&&$("#page-wrapper").removeClass("filter-container"),Zohosign.isFromFormView&&-1==Layout.Page.hash.indexOf("-documentId"))return;if(Layout.Page.hash.indexOf("-formId:")>-1)return void Layout.Page.container.find("div#viewDocumentModal").modal("hide");if(Layout.Page.hash.indexOf("-documentId")>-1||-1!==Layout.Page.hash.indexOf("-createDocument"))return void(window.location.href=Layout.Page.hash.split("-")[0]);if(-1!==Layout.Page.hash.indexOf("files/companyfile"))return}else{if(-1!==Layout.Page.hash.indexOf("-createDocument")||"hr"==mode)Zohosign.openEnvModal("","","","","",isFromFormView);else{if(Layout.Page.hash.indexOf("documentId:")>-1)return void Zohosign.getDocumentPreview();void 0==Layout.Page.urlparam.formId&&void 0==Layout.Page.urlparam.formLinkName||void 0==Layout.Page.urlparam.recordId||isFromFormView?(void 0!=ZPForm.CURRFORM_PARAM.formId||Layout.Page.hash.indexOf("-formId:")>-1||Layout.Page.hash.indexOf("-formLinkName:")>-1||Layout.Page.hash.indexOf("selfservice/user")>-1)&&Zohosign.openEnvModal(isFromFormView):void 0!=Layout.Page.urlparam.formLinkName?ZPApprovals.viewApprovalPopup(Layout.Page.urlparam.formLinkName,Layout.Page.urlparam.recordId,!0):ZPApprovals.viewApprovalPopup(Layout.Page.urlparam.formId,Layout.Page.urlparam.recordId,!1)}Zohosign.isCachedCatList||(0==Object.keys(Files.newCategoryList).length?ZPeople.Request.sendAsyncPost("/fileCabinetAction.zp",{methodName:"getCategoryList",conreqcsr:csrfToken},Zohosign.openFilter):Zohosign.openFilter(Files.newCategoryList))}!isFromFormView&&Layout.Page.hash.indexOf("documentlistview")>-1&&$("#page-wrapper").addClass("filter-container"),(!Zohosign.isCachedDocumentList&&Layout.Page.hash.indexOf("documentlistview")>-1&&0==Zohosign.reportSliderclose||Files.fromcompFilesReportPage&&"cancel"!=mode&&0==Zohosign.reportSliderclose)&&(Files.fromcompFilesReportPage&&Zohosign.resetFilterOptions(),Zohosign.getDocumentList(),null==Files.companyFileId&&(Files.fromcompFilesReportPage=!1)),Zohosign.reportSliderclose=!1},getEsignTemplatesList:function(mode){if(hrdocAccess&&(void 0==isAnySignConfigured&&Zohosign.getEsignConfigurations(),null==Files.isEsignatureAllowedFlag&&Files.isEsignatureAllowed(),isZSConfig)){if(Zohosign.checkZSFeature(),!Files.isEsignatureAllowedFlag)return Zohosign.getZSPaymentURL(),void Zohosign.showUpgradePage();if(!Zohosign.zsFeatureList.templates)return Zohosign.getZSPaymentURL(),void Zohosign.showUpgradePage();Zohosign.hideUpgrade(),Layout.Page.hash.indexOf("templatelistview")>-1&&$("#page-wrapper").addClass("filter-container"),!Zohosign.isCachedTempList&&Layout.Page.hash.indexOf("templatelistview")>-1&&($("#page-wrapper").addClass("filter-container"),Zohosign.getETemplateList())}},getHrDocumentList:function(mode){if(hrdocAccess){if(""==Files.isMMTaddedCompFile){var params={methodName:"checkandAddMMCompHandbook",fileType:5,isFileSortDesc:!0,conreqcsr:csrfToken};ZPeople.Request.send("/fileCabinetAction.zp",params,Files.Esign.setMMTemplatePath)}if(Layout.Page.hash.indexOf("files/hrdocuments/listview")>-1&&$("#page-wrapper").addClass("filter-container"),!Files.hrDocumentList){if(Files.getSharingOptsList(),Layout.Page.hash.indexOf("files/hrdocuments/listview")>-1){$("#page-wrapper").addClass("filter-container");params={methodName:"getAllFiles",fileType:4,start:1,isFileSortDesc:!0,conreqcsr:csrfToken};ZPeople.Request.sendAsyncPost("/fileCabinetAction.zp",params,Zohosign.constructHRDocumentsList)}Files.hrDocumentList=!0}$("#zp-contwrap-files-hrdocuments").addClass("zp_files")}},setMMTemplatePath:function(data){null!=(data=data[1])&&(void 0==data.config&&(Files.isMMTaddedCompFile=!0),void 0!=data.filePath&&(Files.mmtempCompRid=data.filePath),Files.isMMTaddedCompFile=!0)},firescrollTrigger:function(mode){(Layout.Page.hash.indexOf("selfservice/user/files")>-1?$("#selfservice-user").find("[scroll=enabled]"):Layout.Page.parentContainer.find("[scroll=enabled]")).on("scroll",function(){if(ZPeople.FireScroll.getFireScrollPropertie().triggered)return!1;var actualDivHeight=this.scrollHeight,scrollPosition=$(this).scrollTop()+$(window).height();"document"==mode?actualDivHeight<scrollPosition&&1==Zohosign.documentFirescroll&&1==Zohosign.documentFirescroll&&(ZPeople.FireScroll.getFireScrollPropertie().triggered=!0,Zohosign.getDocumentList("",-1,"click")):"envelope"==mode?actualDivHeight<scrollPosition&&1==Envelope.envelopeFirescroll&&1==Envelope.envelopeFirescroll&&(ZPeople.FireScroll.getFireScrollPropertie().triggered=!0,Envelope.getEnvelopeList("",-1,"click")):"agreement"==mode?actualDivHeight<scrollPosition&&1==Agreements.agreeFirescroll&&1==Agreements.agreeFirescroll&&(ZPeople.FireScroll.getFireScrollPropertie().triggered=!0,Agreements.getAgreementsList("",-1,"click")):"wfreports"==mode?actualDivHeight<scrollPosition&&1==Zohosign.documentFirescroll&&1==Zohosign.documentFirescroll&&(ZPeople.FireScroll.getFireScrollPropertie().triggered=!0,Zohosign.getDocumentList("",-1,"click","","","","WorkFlowReports")):"zsigntemplates"==mode&&actualDivHeight<scrollPosition&&1==Zohosign.tempFirescroll&&1==Zohosign.tempFirescroll&&(ZPeople.FireScroll.getFireScrollPropertie().triggered=!0,Zohosign.getETemplateList("",-1,"click"))})},toggleSortSign:function(ele,module){var sortOrder=!1,sortColumn="";list="5"==module?Layout.Page.container.find(ele).parent().parent().find("li").find("[id^='DSort']"):"1"==module?Layout.Page.container.find(ele).parent().parent().find("li").find("[id^='ASort']"):Layout.Page.container.find(ele).parent().parent().find("li").find("[id^='ESort']");for(var i=0;i<list.length;i++)list[i].id!==ele.id?Layout.Page.container.find(list[i]).removeClass("sort-u sort-d"):ele.classList.contains("sort-u")?(Layout.Page.container.find(ele).removeClass("sort-u"),Layout.Page.container.find(ele).addClass("sort-d"),Layout.Page.container.find(ele).attr("title","Sort By Ascending")):ele.classList.contains("sort-d")?(Layout.Page.container.find(ele).removeClass("sort-d"),Layout.Page.container.find(ele).addClass("sort-u"),Layout.Page.container.find(ele).attr("title","Sort By Descending")):(Layout.Page.container.find(ele).attr("title","Sort By Ascending"),Layout.Page.container.find(ele).removeClass("sort-u sort-d"),Layout.Page.container.find(ele).addClass("sort-d"));var sortedID=Layout.Page.container.find(ele).attr("id");sortColumn="DSortName"==sortedID||"ASortName"==sortedID||"ESortName"==sortedID?"NAME":"DSortComp"==sortedID||"ASortComp"==sortedID||"ESortComp"==sortedID?"COMPLETED_DATE":"SENT_DATE",sortOrder=!!ele.classList.contains("sort-u"),"5"==module?Zohosign.getDocumentList("","","sort",!0,sortOrder,sortColumn):"1"==module?Agreements.getAgreementsList("","sort","","",!0,sortOrder,sortColumn):Envelope.getEnvelopeList("","","sort",!0,sortOrder,sortColumn)},getSortColumn:function(sortedID){return"DSortName"==sortedID||"ASortName"==sortedID||"ESortName"==sortedID?"NAME":"DSortComp"==sortedID||"ASortComp"==sortedID||"ESortComp"==sortedID?"COMPLETED_DATE":"SENT_DATE"},constructActivityDetailsDiv:function(){var EsignActDiv='<div class="fileActModal" id="activityDiv"><div class="modal-dialog" role="document">';EsignActDiv+='<div class="modal-content"><div class="modal-header"><h6 class="addPopTitle">Activity</h6><span class="actions">',EsignActDiv+='<button id="activityCls" class="close" type="button">',EsignActDiv+='<span><i class="IC-cls-1px" onclick="Files.Esign.showHideActivityData(\'close\')"></i></span></button></span></div>',EsignActDiv+='<div class="modal-body"><div class="Scrcont"><div class="aclog_cont"><div id="actDetails" class="aclog_detl"></div></div></div></div></div></div></div>',$(EsignActDiv).insertAfter(Layout.Page.container.find("#modalRight"))},showHideActivityData:function(mode){"open"===mode?Layout.Page.container.find("#activityDiv").addClass("db"):Layout.Page.container.find("#activityDiv").removeClass("db")},fileIcons:function(fileExtn){return"pdf"===fileExtn?"pdf":"xls"===fileExtn||"xlsx"===fileExtn||"sxc"===fileExtn||"ods"===fileExtn||"csv"===fileExtn||"tsv"===fileExtn?"xls-new":"htm"===fileExtn||"html"===fileExtn?"htm":"doc"===fileExtn||"docx"===fileExtn||"sxw"===fileExtn||"odt"===fileExtn||"rtf"===fileExtn?"doc":"ppt"===fileExtn||"pps"===fileExtn||"odp"===fileExtn||"sxi"===fileExtn||"pptx"===fileExtn?"ppt":"zip"===fileExtn?"zip":"mp3"===fileExtn||"mp4a"===fileExtn||"wav"===fileExtn?"mp3":"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn?"jpg":"doc"},checkAllRows:function(obj,mode){var chk=obj.checked,fileListingdiv="";fileListingdiv="hrdocuments"==mode||"hrmergedocuments"===mode?"#hrdoc_list":"zsigntemplates"==mode?"#signtemplate_list":"documents"==mode?"#documents_list":"agreements"==mode?"#agreements_list":"#envelopes_list",chk?(files=Layout.Page.container.find(fileListingdiv).find("input[type=checkbox]"),files.each(function(){Layout.Page.container.find(this).attr("disabled")||Layout.Page.container.find(this).prop("checked",!0)}),Layout.Page.container.find("#doc_multiselDel").show(),Layout.Page.container.find("#doc_HeaderBar").hide()):(Layout.Page.container.find("#doc_multiselDel").hide(),Layout.Page.container.find("#doc_HeaderBar").show(),files=Layout.Page.container.find(fileListingdiv).find("input[type=checkbox]:checked"),files.each(function(){Layout.Page.container.find(this).prop("checked",!1)}))},checkParticularFiles:function(obj,mode){var chk=obj.checked,fileListingdiv="",mod_checkallbox=";";"hrdocuments"==mode||"hrmergedocuments"==mode?(fileListingdiv="#hrdoc_list",mod_checkallbox="hrdoc_checkallbox"):"zsigntemplates"==mode?(fileListingdiv="#signtemplate_list",mod_checkallbox="template_checkallbox"):"documents"==mode?(fileListingdiv="#documents_list",mod_checkallbox="documents_checkallbox"):"agreements"==mode?(fileListingdiv="#agreements_list",mod_checkallbox="agreements_checkallbox"):(fileListingdiv="#envelopes_list",mod_checkallbox="envelopes_checkallbox"),chk?(Layout.Page.container.find("#doc_multiselDel").show(),"hrdocuments"!=mode&&"hrmergedocuments"!=mode||Layout.Page.container.find("#moveFiles").addClass("DN"),Layout.Page.container.find("#moveHrdoc").addClass("DN"),Layout.Page.container.find("#moveHrdoc").removeClass("DN"),Layout.Page.container.find("#doc_HeaderBar").hide(),Layout.Page.container.find(fileListingdiv).find('input[type="checkbox"]:checked').length===Layout.Page.container.find(fileListingdiv).find('input[type="checkbox"]').length&&Layout.Page.container.find(mod_checkallbox).prop("checked",!0)):0==Layout.Page.container.find(fileListingdiv).find('input[type="checkbox"]:checked').length?(Layout.Page.container.find(mod_checkallbox).prop("checked",!1),Layout.Page.container.find("#doc_multiselDel").hide(),Layout.Page.container.find("#doc_HeaderBar").show()):Layout.Page.container.find(fileListingdiv).find('input[type="checkbox"]:checked').length>0&&(Layout.Page.container.find(mod_checkallbox).prop("checked",!1),Layout.Page.container.find("#doc_multiselDel").show(),Layout.Page.container.find("#doc_HeaderBar").hide())},deleteRecConfirm:function(Obj,toggleId){$(Obj).parent().removeClass("DB"),$(Obj).parent().addClass("DN"),$(Obj).parent().parent().find("div.FL").addClass("DB"),$(Obj).parent().parent().find("div.FL").removeClass("DN"),$(Obj).parent().parent().addClass("sel"),$(Obj).parent().parent().find("div.FL").find("#action_confirm_btn").addClass("DB"),$(Obj).parent().parent().find("div.FL").find("#action_confirm_btn").removeClass("DN")},cancelDelRecConfirm:function(Obj){$(Obj).parent().parent().removeClass("DB"),$(Obj).parent().parent().addClass("DN"),$(Obj).parent().parent().removeClass("sel"),$(Obj).parent().parent().parent().find(".FR").removeClass("DN"),$(Obj).parent().parent().parent().find(".FR").addClass("DB")}},showEdithrdocuments:function(mode,obj,submode,comphandId){if(Preview.closeDiv(),$("#add_hrdocInnerDiv").find("input[type=checkbox]").prop("checked",!1),Files.isIprestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")),Layout.Page.container.find("#add_hrdocDiv").modal("hide");else if(Files.isGeorestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied")),Layout.Page.container.find("#add_hrdocDiv").modal("hide");else if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.showAddcompanyFile(mode,obj)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.showAddcompanyFile(mode,obj)}),$(document).on("click",function(e){Files.Geo.positionBlocked(),isBlocked||-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||-1!==$(e.target).attr("class").indexOf("btn")||-1!==$(e.target).attr("class").indexOf("IC")||(pageLoaded=!0,Files.showAddcompanyFile(mode,obj))})}else{var longitude="",latitude="";isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(latitude=Files.Geo.position.coords.latitude,longitude=Files.Geo.position.coords.longitude);var pageId=Layout.Page.container.find("#add_hrdocDiv");if(pageId.modal("show"),pageId.find("#add_hrdocInnerDivLoading").html(ZPeople.LOADING_HTML),pageId.find("#add_hrdocInnerDiv").hide(),pageId.find(".modal-footer").show(),pageId.find(".ERR").remove(),pageId.find("#select_location").select2(),Files.cancelnewCategory("hrdoc"),pageId.find("#notify")[0].checked=!1,"edit"===mode){var editData;if(pageId.find("#hrdocselect_Cat").html(""),Files.FilescatList("company","hrdocselect_Cat","s2id_hrdocselect_Cat"),pageId.find("#addFile_header").html(ZSEC.Encoder.encodeForHTML(Files.addcompdisname)),editData=void 0!=comphandId&&""!=comphandId?Layout.Page.container.find("#"+comphandId).parent().parent().parent().data().ldata:Layout.Page.container.find(obj).parent().parent().parent().parent().parent().data().ldata,pageId.find("#filetype").val(editData.fileType),"5"==editData.fileType){var fileName=editData.fileName;editData.fileName=fileName.substr(0,fileName.lastIndexOf(" Template")),editData.fileName=editData.fileName+".pdf"}Files.changeOnUpload(ZPeople.decodeTxt(editData.fileName),"localUpload"),pageId.find("#fileName").val(ZPeople.decodeTxt(editData.fileName)),"4"==editData.fileType?pageId.find("#fileName").addClass("dvfrmlist disabled"):pageId.find("#fileName").removeClass("dvfrmlist disabled"),"null"!==editData.fileDesc&&void 0!==editData.fileDesc&&pageId.find("#fileDesc").val(ZPeople.decodeTxt(editData.fileDesc)),pageId.find("#hrdocselect_Cat").select2("val",editData.fileCategoryID),pageId.find("#editFileId").val(editData.fileID);var editValue="-1";"1"==editData.fileType&&""!==editData.fileLocationID&&(editValue=editData.fileLocationID),0==editData.fileLocationID.length&&(editValue="-1"),Files.getLocationList("select_location","edit",editValue,latitude,longitude,!0),Layout.Page.container.find("#optList").html(""),Layout.Page.container.find("#optList").removeClass("disabled"),1===editData.fileConfident?pageId.find("#isDownload").prop("checked",!1):pageId.find("#isDownload").prop("checked",!0),Files.setOrgFileShareOpts(editData.fileOrgStructure)}pageId.find("#add_hrdocInnerDivLoading").hide(),pageId.find("#add_hrdocInnerDiv").show(),Files.uploadMode="",Files.uploadedDocObj={}}pageId.find(".select2-input").css("width","100%"),"5"==editData.fileType&&(editData.fileName=fileName)},updateHrdocFile:function(form,foundLocation,latitude,longitude){if(isGeoEnabled&&"true"===doNeedToGetLocation&&null===Files.Geo.position&&!foundLocation){var pageLoaded=!1,isBlocked=!1;navigator.geolocation.getCurrentPosition(function(position){pageLoaded=!0,Files.Geo.position=position,Files.updateCompanyFile(form,pageLoaded,position.coords.latitude,position.coords.longitude)},function(){isBlocked=!0,pageLoaded=!0,Files.Geo.positionBlocked(),Files.updateCompanyFile(form,pageLoaded,"","")}),isBlocked||$(document).on("click",function(e){Files.Geo.positionBlocked(),-1===navigator.userAgent.indexOf("Firefox")||pageLoaded||!ZPSetupCommon.isEmpty($(e.target).attr("class"))&&$(e.target).text()===ZPI18N.getString("zp.submit")||(pageLoaded=!0,Files.updateCompanyFile(form,pageLoaded,"",""))})}else{Layout.Page.container.find(".ERR").remove();var fileType,pageId=Layout.Page.container.find("#add_hrdocDiv"),uploadFile=pageId.find("#uploadfile").val(),fileName=pageId.find("#fileName").val(),fileDesc=pageId.find("#fileDesc").val(),validityDate=pageId.find("#validityDate").val(),errflag=!1;fileType=pageId.find("#filetype").val();var isDownload="0",fileExtn=fileName.substr(fileName.lastIndexOf(".")+1,fileName.length).toLowerCase();!1===pageId.find("#isDownload").is(":checked")&&(isDownload="1");var location="",catId="",newCatName="",notifyToall=!1,notifyAllFeeds=!1;pageId.find("#formBizcpn").val(csrfToken);var editFileId=pageId.find("#editFileId").val();if(!0===pageId.find("#notify").is(":checked")&&(notifyToall=!0),!0===pageId.find("#notifyFeeds").is(":checked")&&(notifyAllFeeds=!0),-1!=fileName.indexOf(",")&&(fileName=fileName.replace(/,/g,"_")),-1!=fileName.indexOf(",")&&(fileName=fileName.replace(/,/g,"")),"exe"==fileExtn&&(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.exefileerror")),errflag=!0),""==fileName&&(pageId.find("#fileName").after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.emptyfilename")+"</strong></span>"),errflag=!0),"0"!=editFileId&&""==uploadFile&&pageId.find("#beforeUpload").is(":visible")&&(pageId.find("#drop_file").parent().parent().after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.choosefile")+"</strong></span>"),errflag=!0),""==uploadFile&&"0"==editFileId&&"cloudUpload"!=Files.uploadMode&&"workDriveUpload"!=Files.uploadMode&&(pageId.find("#drop_file").parent().parent().after('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.choosefile")+"</strong></span>"),errflag=!0),fileDesc.length>250&&(pageId.find("#fileDesc").parent().append('<span  errmsg="mailids" id="errormsg" class="ERR">'+ZPI18N.getString("zp.desclength")+"</strong></span>"),errflag=!0),pageId.find("#s2id_hrdocselect_Cat").is(":visible")&&(""==pageId.find("#hrdocselect_Cat").toString().trim()||"undefined"==catId||"-1"==pageId.find("#hrdocselect_Cat").val()||null==pageId.find("#hrdocselect_Cat").val()?(pageId.find("#hrdocCatselect").append('<span class="ERR" errmsg="mailids" id="hrdoccategory_err" >'+ZPI18N.getString("zp.selectcategory")+"</span>"),errflag=!0):""==pageId.find("#hrdocselect_Cat").val()&&null!=pageId.find("#hrdocselect_Cat").val()||(catId=pageId.find("#hrdocselect_Cat").val(),pageId.find("#hrdoccategory_err").hide())),pageId.find("#hrdocnewCategory").is(":visible")&&(pageId.find("#hrdoccategory_err").hide(),""===pageId.find("#hrdocnewCategory").val().trim()?(pageId.find("#hrdocCatselect").append('<span class="ERR" errmsg="mailids" id="hrdoccategory_err" >'+ZPI18N.getString("zp.selectcategory")+"</span>"),errflag=!0):""!=pageId.find("#hrdocnewCategory").val()&&(newCatName=pageId.find("#hrdocnewCategory").val(),pageId.find("#hrdoccategory_err").hide())),""!=pageId.find("#validityDate").val()&&void 0!=pageId.find("#validityDate").val()&&0!=pageId.find("#validityDate").val()){var validityDateval=pageId.find("#validityDate").val();"-1"!=dateFmt.indexOf("MMM")&&(validityDateval=validityDateval.replace(/-/g," "));var currentdatelong=Calendar.getCurrentDate().getTime();new Date(validityDateval).getTime()<currentdatelong?(pageId.find("#validityDate").parent().append('<span  errmsg="mailids" id="errormsgvalid" class="ERR">'+ZPI18N.getString("zp.validuntilerr")+"</strong></span>"),errflag=!0):pageId.find("#errormsgvalid").hide()}-1==fileName.indexOf("<")&&-1==fileName.indexOf(">")&&-1==fileName.indexOf("&lt;")&&-1==fileName.indexOf("&gt;")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.filename")))),errflag=!0),-1==fileDesc.indexOf("<")&&-1==fileDesc.indexOf(">")&&-1==fileName.indexOf("&lt;")&&-1==fileName.indexOf("&gt;")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.description")))),errflag=!0),-1==newCatName.indexOf("<")&&-1==newCatName.indexOf(">")&&-1==newCatName.indexOf("&lt;")&&-1==newCatName.indexOf("&gt;")||(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesexcludesplchars",new Array(ZPI18N.getString("zp.folder")))),errflag=!0),null!=newCatName&&void 0!=newCatName&&"/"===newCatName&&(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.avoidslash")),errflag=!0);var OrgStructDetails=Layout.Page.container.find("#orgShareOptList").getTagConfig();if(-1!=loginUserRoleCheck&&(null==OrgStructDetails||void 0===OrgStructDetails||jQuery.isEmptyObject(OrgStructDetails)?(pageId.find("#orgShareOptList").after('<span errmsg="mailids" id="errormsgorg" class="ERR">'+ZPI18N.getString("zp.orgstructerr")+"</strong></span>"),errflag=!0):(OrgStructDetails.hasOwnProperty("NotifyAll")&&(OrgStructDetails.LocationName=["-1"],delete OrgStructDetails.NotifyAll),pageId.find("#errormsgorg").hide(),OrgStructDetails.hasOwnProperty("LocationName")&&(location=OrgStructDetails.LocationName))),errflag)return!1;if(Files.isIprestricted)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.permissiondenied"));else{var formData=new FormData;formData.append("methodName","addFile"),formData.append("conreqcsr",csrfToken),formData.append("fileName",fileName),formData.append("fileDesc",fileDesc),formData.append("fileType",fileType),null!=location&&void 0!=location&&""!=location&&formData.append("locationId",location),formData.append("catId",catId),formData.append("editFileId",editFileId),formData.append("notifyToall",notifyToall),formData.append("notifyFeeds",notifyAllFeeds),formData.append("newCatName",newCatName),formData.append("confidential",isDownload),formData.append("uploadMode",Files.uploadMode),null!=validityDate&&void 0!==validityDate&&""!==validityDate&&-1!==validityDate&&formData.append("validityDate",validityDate),formData.append("isNewui",!0),isGeoEnabled&&"true"===doNeedToGetLocation&&null!==Files.Geo.position&&Files.Geo.position!==Files.Geo.blocked&&(formData.append("latitude",Files.Geo.position.coords.latitude),formData.append("longitude",Files.Geo.position.coords.longitude)),"cloudUpload"==Files.uploadMode&&formData.append("cloudUploadDoc",JSON.stringify(Files.uploadedDocObj)),"workDriveUpload"==Files.uploadMode&&formData.append("WDUploadDoc",JSON.stringify(Files.uploadedDocObj)),void 0!==pageId.find("#uploadfile")[0].files[0]&&formData.append("uploadfile",pageId.find("#uploadfile")[0].files[0]),null==OrgStructDetails||jQuery.isEmptyObject(OrgStructDetails)||formData.append("orgStructureDetails",JSON.stringify(OrgStructDetails)),newcatexist=!1,null!=newCatName&&""!=newCatName&&(newcatexist=!0),pageId.find("#add_hrdocInnerDivLoading").show(),pageId.find("#add_hrdocInnerDivLoading").html(ZPeople.LOADING_HTML),pageId.find("#add_hrdocInnerDiv").hide(),pageId.find(".modal-footer").hide();ZPeople.Request.sendAsyncPost("/zohoSignActions.zp",{action:"checkAndAddSignTemplates"}),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){Layout.Page.container.find("#add_hrdocDiv").modal("hide"),newcatexist&&null!=newCatName&&void 0!=newCatName&&"/"!=newCatName&&""!=newCatName&&(Files.newCategoryList[data[1].CatID]=data[1].CatName),"5"!=fileType&&Layout.Page.container.find("#hrdoc_list ul[fileid="+editFileId+"]").remove(),0===Layout.Page.container.find("#hrdoc_listingpage").find("ul").length&&Files.showNodataMsg("hrdocuments"),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.addfile"))},error:function(req){var errResponse=req.responseJSON[1];void 0!=errResponse&&errResponse.hasOwnProperty("errorCode")&&6014==errResponse.errorCode&&ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.mmmailfailureerrormessadmin",new Array(errResponse.msg))),8103!==req.status&&8101!==req.status&&500!==req.status||ZPeople.Message.showFailureMsg(errResponse.msg),pageId.modal("hide")}})}}},FilesSettings:{keyPairIdJson:{system:{id:"system",dispVal:ZPI18N.getString("zp.users"),Class:"tab-pane fade active in",parentClass:"active"},roles:{id:"roles",dispVal:ZPI18N.getString("zp.rolelist")}},fileGeneralSettings:function(){if(Layout.Page.hash.indexOf("files/settings/filesettings")>-1){$("#zp-tlevel-files-settings").remove();ZPeople.Request.sendAsyncPost("/fileCabinetAction.zp",{methodName:"getDispName",conreqcsr:csrfToken},Files.FilesSettings.onPageload)}},onPageload:function(data){var pageDiv=Layout.Page.container.find("#generalsettings"),empObj={id:"filesEmpDD",data:function(initObj){return EmployeeDropdown.getEmpList($(initObj).val(),"emp","FILES_ACTIVEEMP",[],{},!0)},checkbox:!0},roleData=[];$.each(rolesJson,function(index,value){var param1={};param1.id=value.ID,param1.value=value.NAME,"Admin"!==value.NAME&&roleData.push(param1)});var roleObj={id:"filesRoleDD",data:roleData,checkbox:!0};CommonTemplates.getSelectMenu(empObj,Layout.Page.container.find("#persFileAllowDiv"),{id:"pfAllowEmp",placeholder:ZPI18N.getString("zp.selectemployees")},{isMandatory:!1}),CommonTemplates.getSelectMenu(roleObj,Layout.Page.container.find("#persFileAllowRoleDiv"),{id:"pfAllowRole",placeholder:ZPI18N.getString("zp.selectroles")},{isMandatory:!1}),CommonTemplates.getSelectMenu(empObj,Layout.Page.container.find("#empFileRestrictDiv"),{id:"empfileDenyEmp",placeholder:ZPI18N.getString("zp.selectemployees")},{isMandatory:!1}),CommonTemplates.getSelectMenu(roleObj,Layout.Page.container.find("#empFileRestrictRoleDiv"),{id:"empfileDenyRole",placeholder:ZPI18N.getString("zp.selectroles")},{isMandatory:!1}),Layout.Page.container.find("#files_folder").prop("checked",!1),Layout.Page.container.find("#files_list").prop("checked",!0),$.each(data[1],function(index,eachData){if(eachData.hasOwnProperty(Files.hrFilesRename)&&(Layout.Page.container.find("#hrFileName").text(eachData[Files.hrFilesRename]),Layout.Page.container.find("#hrFileRestrictText").html(ZPI18N.getString("zp.hrfiles.restrict",new Array(eachData[Files.hrFilesRename])))),eachData.hasOwnProperty(Files.personalFilesAccessEmployees)&&isEnterprise){var personalFilesAccessEmployeesVal=eachData[Files.personalFilesAccessEmployees];-1==personalFilesAccessEmployeesVal?Files.FilesSettings.toggleAllEmpPer(Layout.Page.container.find("#allPfEmpChk"),"1"):(Files.FilesSettings.constructPermittedUsers("emp",personalFilesAccessEmployeesVal,"pfAllowEmp"),Files.FilesSettings.toggleAllEmpPer(Layout.Page.container.find("#PfEmpChk"),"2.1"))}if(eachData.hasOwnProperty(Files.personalFilesAccessRoles)&&isEnterprise){var personalFilesAccessRolesVal=eachData[Files.personalFilesAccessRoles];-1!==personalFilesAccessRolesVal&&(Files.FilesSettings.constructPermittedUsers("role",personalFilesAccessRolesVal,"pfAllowRole"),Files.FilesSettings.toggleAllEmpPer(Layout.Page.container.find("#PfRoleChk"),"2.2"))}if(eachData.hasOwnProperty(Files.personalFilesDeniedEmployees)){var employeeFilesDeniedEmployeesVal=eachData[Files.personalFilesDeniedEmployees];-1==employeeFilesDeniedEmployeesVal?Files.FilesSettings.toggleAllEmpPer(Layout.Page.container.find("#allHrfEmpChk"),"3"):(Files.FilesSettings.constructPermittedUsers("emp",employeeFilesDeniedEmployeesVal,"empfileDenyEmp"),Files.FilesSettings.toggleAllEmpPer(Layout.Page.container.find("#hrfEmpChk"),"4.1"))}if(eachData.hasOwnProperty(Files.personalFilesDeniedRoles)){var employeeFilesDeniedRolesVal=eachData[Files.personalFilesDeniedRoles];-1!==employeeFilesDeniedRolesVal&&(Files.FilesSettings.constructPermittedUsers("role",employeeFilesDeniedRolesVal,"empfileDenyRole"),Files.FilesSettings.toggleAllEmpPer(Layout.Page.container.find("#hrfRoleChk"),"4.2"))}if(eachData.hasOwnProperty(Files.empFilesAllReportees)&&("true"===eachData[Files.empFilesAllReportees]?pageDiv.find("#allReporteePerm").addClass("IC-chk-box2"):pageDiv.find("#allReporteePerm").removeClass("IC-chk-box2")),eachData.hasOwnProperty(Files.isFolderViewDefault)&&("true"===eachData[Files.isFolderViewDefault]?(Layout.Page.container.find("#files_list").prop("checked",!1),Layout.Page.container.find("#files_folder").prop("checked",!0)):(Layout.Page.container.find("#files_folder").prop("checked",!1),Layout.Page.container.find("#files_list").prop("checked",!0))),eachData.hasOwnProperty(Files.persFilesCountPerUser)){var pfCount=eachData[Files.persFilesCountPerUser];null!==pfCount&&void 0!==pfCount&&""!==pfCount&&Layout.Page.container.find("#pfUserCount").val(pfCount)}}),void 0!==Layout.Page.container.find("#hrFileName").text()&&""!==Layout.Page.container.find("#hrFileName").text()||(Layout.Page.container.find("#hrFileName").text(ZPI18N.getString("zp.newemployeefiles")),Layout.Page.container.find("#hrFileRestrictText").html(ZPI18N.getString("zp.hrfiles.restrict",new Array(ZPI18N.getString("zp.empfiles")))))},constructPermittedUsers:function(mode,idArr,parentDiv){if(null!=mode&&void 0!=mode&&"emp"===mode){for(var selectedValObj=[],i=0;i<idArr.length;i++){var id=Object.keys(idArr[i])[0],userDetails=ZPeople.getUserDetailsById(id);selectedValObj.push({id:id,text:userDetails.empid+" "+userDetails.name,imageAlt:ZPeople.escapeHtml(CommonTemplates.getAltText(ZPeople.decodeTxt(userDetails.empid+" "+userDetails.name))),image:userDetails.avatar})}selectedValObj.length>0&&Layout.Page.container.find("#"+parentDiv).zpselect({selectedVal:selectedValObj,isMandatory:!1,checkbox:!0})}else if(null!=mode&&void 0!=mode&&"role"===mode){for(selectedValObj=[],i=0;i<idArr.length;i++){id=Object.keys(idArr[i])[0];selectedValObj.push({id:id,text:Object.values(idArr[i])[0]})}selectedValObj.length>0&&Layout.Page.container.find("#"+parentDiv).zpselect({selectedVal:selectedValObj,isMandatory:!1,checkbox:!0})}},toggleAllEmpPer:function(ele,mode){$(ele).toggleClass("IC-chk-box2"),"1"===mode?$(ele).hasClass("IC-chk-box2")&&(Layout.Page.container.find("#PfEmpChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#PfRoleChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#PfEmpChk").parent().parent().parent().addClass("dsbl"),Layout.Page.container.find("#PfRoleChk").parent().parent().parent().addClass("dsbl")):"2.1"===mode||"2.2"===mode?$(ele).hasClass("IC-chk-box2")?(Layout.Page.container.find("#allPfEmpChk").removeClass("IC-chk-box2"),"2.1"!==mode||Layout.Page.container.find("#PfRoleChk").hasClass("IC-chk-box2")?"2.2"!==mode||Layout.Page.container.find("#PfEmpChk").hasClass("IC-chk-box2")?$(ele).parent().parent().parent().removeClass("dsbl"):(Layout.Page.container.find("#PfEmpChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#PfEmpChk").parent().parent().parent().addClass("dsbl"),Layout.Page.container.find("#PfRoleChk").parent().parent().parent().removeClass("dsbl")):(Layout.Page.container.find("#PfRoleChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#PfRoleChk").parent().parent().parent().addClass("dsbl"),Layout.Page.container.find("#PfEmpChk").parent().parent().parent().removeClass("dsbl"))):$(ele).parent().parent().parent().addClass("dsbl"):"3"===mode?$(ele).hasClass("IC-chk-box2")&&(Layout.Page.container.find("#hrfEmpChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#hrfRoleChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#hrfEmpChk").parent().parent().parent().addClass("dsbl"),Layout.Page.container.find("#hrfRoleChk").parent().parent().parent().addClass("dsbl")):"4.1"!==mode&&"4.2"!==mode||($(ele).hasClass("IC-chk-box2")?(Layout.Page.container.find("#allHrfEmpChk").removeClass("IC-chk-box2"),"4.1"!==mode||Layout.Page.container.find("#hrfRoleChk").hasClass("IC-chk-box2")?"4.2"!==mode||Layout.Page.container.find("#hrfEmpChk").hasClass("IC-chk-box2")?$(ele).parent().parent().parent().removeClass("dsbl"):(Layout.Page.container.find("#hrfEmpChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#hrfEmpChk").parent().parent().parent().addClass("dsbl"),Layout.Page.container.find("#hrfRoleChk").parent().parent().parent().removeClass("dsbl")):(Layout.Page.container.find("#hrfRoleChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#hrfRoleChk").parent().parent().parent().addClass("dsbl"),Layout.Page.container.find("#hrfEmpChk").parent().parent().parent().removeClass("dsbl"))):$(ele).parent().parent().parent().addClass("dsbl"))},submitSettings:function(){var rolesJson=[],configDetails={},allEmpPF=Layout.Page.container.find("#allPfEmpChk").hasClass("IC-chk-box2"),allEmpHrF=Layout.Page.container.find("#allHrfEmpChk").hasClass("IC-chk-box2"),mailmergeChkbox=Layout.Page.container.find("#mailmergeaccess").hasClass("IC-chk-box2"),empPF=Layout.Page.container.find("#PfEmpChk").hasClass("IC-chk-box2"),rolePF=Layout.Page.container.find("#PfRoleChk").hasClass("IC-chk-box2"),empHrF=Layout.Page.container.find("#hrfEmpChk").hasClass("IC-chk-box2"),roleHrF=Layout.Page.container.find("#hrfRoleChk").hasClass("IC-chk-box2"),pfAccessEmp=Layout.Page.container.find("#pfAllowEmp").attr("selectedIds"),pfAccessRole=Layout.Page.container.find("#pfAllowRole").attr("selectedIds"),empfileAccessEmp=Layout.Page.container.find("#empfileDenyEmp").attr("selectedIds"),empfileAccessRole=Layout.Page.container.find("#empfileDenyRole").attr("selectedIds"),allReporteePerm=Layout.Page.container.find("#allReporteePerm").hasClass("IC-chk-box2");null!=allEmpPF&&void 0!=allEmpPF&&!0===allEmpPF&&isEnterprise?((configDetails={}).KEYNAME=Files.personalFilesAccessEmployees,configDetails.KEYVALUE=-1,rolesJson.push(configDetails),(configDetails={}).KEYNAME=Files.personalFilesAccessRoles,configDetails.KEYVALUE=-1,rolesJson.push(configDetails)):(null!=empPF&&void 0!=empPF&&!0===empPF&&null!==pfAccessEmp&&isEnterprise?((configDetails={}).KEYNAME=Files.personalFilesAccessEmployees,configDetails.KEYVALUE=pfAccessEmp,rolesJson.push(configDetails)):null!=empPF&&void 0!=empPF&&!1===empPF&&isEnterprise&&((configDetails={}).KEYNAME=Files.personalFilesAccessEmployees,configDetails.KEYVALUE="",rolesJson.push(configDetails)),null!=rolePF&&void 0!=rolePF&&!0===rolePF&&null!==pfAccessRole&&isEnterprise?((configDetails={}).KEYNAME=Files.personalFilesAccessRoles,configDetails.KEYVALUE=pfAccessRole,rolesJson.push(configDetails)):null!=rolePF&&void 0!=rolePF&&!1===rolePF&&isEnterprise&&((configDetails={}).KEYNAME=Files.personalFilesAccessRoles,configDetails.KEYVALUE="",rolesJson.push(configDetails))),null!=allEmpHrF&&void 0!=allEmpHrF&&!0===allEmpHrF?((configDetails={}).KEYNAME=Files.personalFilesDeniedEmployees,configDetails.KEYVALUE=-1,rolesJson.push(configDetails),(configDetails={}).KEYNAME=Files.personalFilesDeniedRoles,configDetails.KEYVALUE=-1,rolesJson.push(configDetails)):(null!=empHrF&&void 0!=empHrF&&!0===empHrF&&null!==empfileAccessEmp?((configDetails={}).KEYNAME=Files.personalFilesDeniedEmployees,configDetails.KEYVALUE=empfileAccessEmp,rolesJson.push(configDetails)):null!=empHrF&&void 0!=empHrF&&!1===empHrF&&((configDetails={}).KEYNAME=Files.personalFilesDeniedEmployees,configDetails.KEYVALUE="",rolesJson.push(configDetails)),null!=roleHrF&&void 0!=roleHrF&&!0===roleHrF&&null!==empfileAccessRole?((configDetails={}).KEYNAME=Files.personalFilesDeniedRoles,configDetails.KEYVALUE=empfileAccessRole,rolesJson.push(configDetails)):null!=roleHrF&&void 0!=roleHrF&&!1===roleHrF&&((configDetails={}).KEYNAME=Files.personalFilesDeniedRoles,configDetails.KEYVALUE="",rolesJson.push(configDetails))),configDetails={},null!=mailmergeChkbox&&void 0!=mailmergeChkbox&&(configDetails.KEYNAME=Files.mailmergeAccess,configDetails.KEYVALUE=Files.mailmergeAccessVal,rolesJson.push(configDetails)),configDetails={},null!=allReporteePerm&&void 0!=allReporteePerm&&(configDetails.KEYNAME=Files.empFilesAllReportees,configDetails.KEYVALUE=allReporteePerm,rolesJson.push(configDetails)),configDetails={},Layout.Page.container.find("input#files_folder").is(":checked")?(configDetails.KEYNAME=Files.isFolderViewDefault,configDetails.KEYVALUE=!0,rolesJson.push(configDetails)):Layout.Page.container.find("input#files_list").is(":checked")&&(configDetails.KEYNAME=Files.isFolderViewDefault,configDetails.KEYVALUE=!1,rolesJson.push(configDetails)),configDetails={};var pfCnt=Layout.Page.container.find("input#pfUserCount").val();null!==pfCnt&&void 0!==pfCnt&&(configDetails.KEYNAME=Files.persFilesCountPerUser,configDetails.KEYVALUE=pfCnt,rolesJson.push(configDetails));var formData=new FormData,dataArray=[];for(key in rolesJson)dataArray.push(rolesJson[key]);dataArray.length>0&&formData.append("filesConfig",JSON.stringify(dataArray)),formData.entries().next().done?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.selectcheckbox")):(formData.append("conreqcsr",csrfToken),formData.append("methodName","addorUpdateFilesConfig"),$.ajax({url:"/fileCabinetAction.zp",type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.ttsettingssaved"))},error:function(req){ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror"))}}))},resetSettings:function(){Layout.Page.container.find("#allPfEmpChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#PfEmpChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#PfRoleChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#allHrfEmpChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#hrfEmpChk").removeClass("IC-chk-box2"),Layout.Page.container.find("#hrfRoleChk").removeClass("IC-chk-box2"),Files.FilesSettings.fileGeneralSettings()},editFilenames:function(thisObj){Layout.Page.container;var selectedClass=$(thisObj).parent().parent().attr("class");if(void 0==selectedClass||""==selectedClass){$(thisObj).parent().parent().addClass("sel");var originalFilename=$(thisObj).parent().parent().find(".dtable .fileDtl strong").text();$(thisObj).parent().parent().find(".dtable b input").attr("value",originalFilename)}},removeChanges:function(thisObj){$(thisObj).parent().parent().parent().removeClass("sel")},saveFornow:function(thisObj){var newFilename=$(thisObj).parent().parent().parent().find(".dtable b input").val();$(thisObj).parent().parent().parent().find(".dtable .fileDtl strong").text(newFilename),$(thisObj).parent().parent().parent().find(".dtable b input").attr("value",newFilename),$(thisObj).parent().parent().parent().find(".dtable .fileDtl strong").attr("value",newFilename),$(thisObj).parent().parent().parent().removeClass("sel")},getTagConfig:function(thisObj){var tagConfigJson={},pTag=$(thisObj).find("[pTagId]");return $(pTag).each(function(ind,obj){var childTagArray=[],childTagValue={};$($(obj).find("[cTagId]")).each(function(ind,childObj){childTagValue.id=$(childObj).attr("attr"),childTagValue.value=$(childObj).text(),childTagArray.push(childTagValue)}),0!==$(obj).find("[cTagId]").length&&(tagConfigJson[$(obj).attr("pTagId")]=childTagArray)}),tagConfigJson},mailMergeaccess:function(){var pageDiv=Layout.Page.container.find("#generalsettings");pageDiv.find("#mailmergeaccess").hasClass("IC-chk-box2")?(Files.mailmergeAccessVal=!1,pageDiv.find("#mailmergeaccess").removeClass("IC-chk-box2")):(Files.mailmergeAccessVal=!0,pageDiv.find("#mailmergeaccess").addClass("IC-chk-box2"))},getFileTabName:function(fileType){if(Files.compdisname===ZPI18N.getString("zp.organizationfiles")&&Files.hrfiledisname===ZPI18N.getString("zp.newemployeefiles")){var formData=new FormData;formData.append("methodName","getDispName"),formData.append("all",!1),formData.append("conreqcsr",csrfToken),$.ajax({url:Files.ACTION.URL,type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){void 0!==resultData[1]&&resultData[1].length>0&&$.each(resultData[1],function(tabkey,tabvalue){!tabvalue.hasOwnProperty(Files.companyFilesRename)||void 0!=fileType&&"1"!==fileType||(Files.compdisname=tabvalue[1],Files.addcompdisname=ZPI18N.getString("zp.add")+" "+Files.compdisname,Files.editcompdisname=ZPI18N.getString("zp.edit")+" "+Files.compdisname),!tabvalue.hasOwnProperty(Files.hrFilesRename)||void 0!=fileType&&"0"!==fileType||(Files.hrfiledisname=tabvalue[0],Files.addhrfiledisname=ZPI18N.getString("zp.add")+" "+Files.hrfiledisname,Files.edithrfiledisname=ZPI18N.getString("zp.edit")+" "+Files.hrfiledisname)})}})}}}},Preview={imgOrgHeight:800,constructInfoList:function(data){var row="<em>",array=data.toString().split(",");for(var i in array)row+="<strong>"+array[i]+"</strong>";return row+="</em>"},constructHeaderFooterForPreview:function(data,mode){var fileId,filePath,allowDownload,viewFileDiv="";if(fileId=data.fileId,filePath=data.filePath,allowDownload=data.allowDownload,allowPrint=data.allowPrint,void 0!=data.aggId&&data.aggId,void 0!=data.fileType&&"4"==data.fileType&&-1==data.filePath.indexOf("Document")&&(mode="HRFormTemp"),viewFileDiv+="<div class='content-box cbmodal' id='viewPreviewFileDiv' style='display:block;'>",viewFileDiv+="<div class='content-header'>",viewFileDiv+="<h6 class='addPopTitle'id='viewfileHeader'>"+data.fileName+"</h6>",viewFileDiv+="<button aria-label='Close' data-dismiss='modal' class='close' type='button' onclick='Preview.closeDiv()'><span aria-hidden='true'><div class='IC-cls S18 CP'></div></span></button></div>",viewFileDiv+="<div id='preview_body' class='content-body'></div>",viewFileDiv+="<div id='preview_footer' class='content-footer'>","files"===mode)if(null!==data.isFeeds&&void 0!==data.isFeeds&&1==data.isFeeds){var extraProps={};extraProps.isFromFeeds=data.isFeeds,extraProps.isUserSharedNodeCheck=data.isUserSharedNodeCheck,extraProps.isEmpFileAck=data.isEmpFileAck,extraProps.isLoginUserAck=data.isLoginUserAck,viewFileDiv+=Files.Reports.acknowledgementStatus(fileId,data.fileAcknowledge,data.fileOwner,data.isEmpFileAck,data.isLoginUserAck,!0,void 0,extraProps)}else viewFileDiv+=Files.Reports.acknowledgementStatus(fileId,data.fileAcknowledge,data.fileOwner,data.isEmpFileAck,data.isLoginUserAck,!0);if(viewFileDiv+="<div id='moreActions' class='actions'>","hrdocPdf"==mode&&(viewFileDiv+='<a href="javascript:;" onclick=Files.showEdithrdocuments("edit",this,"uploadmode",\''+fileId+'\') class="zp_atOfbt FL" >'+ZPI18N.getString("zp.addtocompfiles",new Array(Files.compdisname))+"</a>"),viewFileDiv+="<div class='dropdown FL PR ZPCusDrs ZPPdrop cust-dm'><span class='CP dropdown-toggle upload' data-toggle='dropdown' aria-expanded='false'>",null!==data.info&&void 0!==data.info&&(viewFileDiv+="<i class='CR-info S12 ML5'></i>"),viewFileDiv+="</span><div class='dropdown-menu ZPCmn-Arrow bottom gray TBDD'>","Onboarding"!=mode){var infoDiv="",info=data.info;if(void 0!=info&&Object.keys(info).length>0){for(var infoKeys=Object.keys(info),i=0;i<=infoKeys.length-1;i++){var key=infoKeys[i],value=info[key];if(Array.isArray(value))infoDiv+="<li><span>"+key+"</span>"+Preview.constructInfoList(value)+"</li>";else key==ZPI18N.getString("zp.description")?infoDiv+="<li><span>"+key+"</span><em class='flWd'>"+value+"</em></li>":infoDiv+="<li><span>"+key+"</span><em>"+value+"</em></li>"}viewFileDiv+="<ul>"+infoDiv+"</ul>"}}if(viewFileDiv+="</div></div>","ESign"==mode&&(viewFileDiv+='<i class="CR-imprt" onclick=Agreements.downloadAttachement(this,"'+fileId+'","download","'+encodeURIComponent(data.fileName)+'","'+encodeURIComponent(data.filePath)+'")></i>'),!0===allowDownload&&!0===allowPrint)if("Forms"===mode)viewFileDiv+='<i class="CR-imprt" onclick="window.open(\''+ZPForm.constructDownloadLink(fileParams)+"');\"></i>",viewFileDiv+='<i id="filePrint" class="IC-print" onclick="Files.printFile()"></i>';else if("HRCase"===mode)viewFileDiv+='<i class="CR-imprt" onclick="casesFiles.getFileDownload(event,\''+data.fileId+"','"+data.recordId+"','"+data.fType+"',"+data.hasOwnProperty("previewFileId")+')"></i>';else if("revisionletter"===mode)viewFileDiv+=`<i class="CR-imprt" onclick="Compensation.RevisionLetters.download('${data.recordId}');"></i>`;else{viewFileDiv+=Layout.Page.hash.indexOf("#files/hrdocuments/listview")>-1&&"5"==data.fileType?'<i class="CR-imprt" onclick=Files.downloadCompHandbook("'+fileId+'")></i>':"HRFormTemp"==mode?'<i class="CR-imprt" onclick=Files.downloadCompHandbook("'+fileId+'")></i>':'<i class="CR-imprt" onclick=Files.downloadFilecabinet(\'html\',"'+fileId+'","'+encodeURIComponent(filePath)+'","'+encodeURIComponent(data.fileName)+'")></i>',"hrdocPdf"!=mode&&(viewFileDiv+='<i id="filePrint" class="IC-print" onclick="Files.printFile()"></i>')}viewFileDiv+="</div></div>",$("#page-wrapper").append(viewFileDiv)},showPreview:function(data,mode){var fileExtn=data.filePath;if(void 0!=fileExtn&&-1!=fileExtn.lastIndexOf(".")&&(fileExtn=(fileExtn=fileExtn.substr(fileExtn.lastIndexOf(".")+1,fileExtn.length)).toLowerCase()),null!=data.filePath&&void 0!=data.filePath&&-1==data.filePath.indexOf("/")&&-1==data.filePath.indexOf("\\")&&(fileExtn=data.fileExtn),Preview.constructHeaderFooterForPreview(data,mode),"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn||"gif"===fileExtn){var constructBody="<div class='content-pv' style='max-height: 610px; max-width: 1265px; color: #fff;'>";constructBody+="<img src='' id='imageviewFrame' name='imageviewFrame' scrolling='auto' style='position:relative;max-height: 610px; max-width: 1265px;'/>",$("#preview_body").html(constructBody);var footer="<div class='cf-zoom'>";footer+="<span><i class='IC-mins'></i><em class='DB'>0%</em></span>",footer+="<div><input  id='zoomRange' class='inputRange' type='range' min='0' max='200' value='0' oninput=Preview.zoomFile()><em id='zoomval' class='DB'>0%</em></div>",footer+="<span><i class='IC-plus-big'></i><em class='DB'>200%</em></span></div>",$("#preview_footer").prepend(footer),$("#moreActions").prepend('<i id="magnify_files" class="CR-magnifier" onclick="Preview.magnifyFileView()"></i>')}else{constructBody="<iframe  src='' id='viewFileFrame' name='viewFileFrame' scrolling='auto' style='border: none; margin: 0pt;' frameborder='0' height='0' scrolling='no' width='100%' ></iframe>";$("#preview_body").html(constructBody)}},closeDiv:function(isEsc,event){$("#viewPreviewFileDiv").remove(),$("#wrapper").removeClass("ZPMprw")},magnifyFileView:function(){var img,glass,zoom=Number("2"),bw=3;if(document.getElementById("magnify_files").classList.toggle("sel"),"CR-magnifier sel"==$("#magnify_files").attr("class")){function hideMagnifier(){glass.style.display="none"}function showMagnifier(e){glass.style.display="block";var pos,x,y,w=glass.offsetWidth/2,h=glass.offsetHeight/2;e.preventDefault(),pos=function(e){var a,x=0,y=0;return e=e||window.event,a=img.getBoundingClientRect(),x=e.pageX-a.left,y=e.pageY-a.top,x-=window.pageXOffset,y-=window.pageYOffset,{x:x,y:y}}(e),x=pos.x,y=pos.y,glass.style.left=x-w+"px",glass.style.top=y-h+"px";img.getBoundingClientRect().left,img.getBoundingClientRect().top;var tempXPos=0;tempXPos=-(x*zoom-w+bw)<=0?-(x*zoom-w+bw):w-(x*zoom-bw);var tempYPos=0;tempYPos=-(y*zoom-h+bw)<=0?-(y*zoom-h+bw):h-(y*zoom-bw),glass.style.backgroundPosition=tempXPos+"px "+tempYPos+"px"}0==$("#page-wrapper").find("#viewFileDiv").find("#magnifyFiles").length&&(img=document.getElementById("imageviewFrame"),(glass=document.createElement("DIV")).setAttribute("id","magnifyFiles"),glass.setAttribute("class","files-magnifier-glass"),img.parentElement.insertBefore(glass,img),glass.style.backgroundImage="url('"+img.src+"')",glass.style.backgroundRepeat="no-repeat",glass.style.backgroundSize=img.width*zoom+"px "+img.height*zoom+"px",glass.addEventListener("mousemove",showMagnifier),img.addEventListener("mousemove",showMagnifier),glass.addEventListener("mouseout",hideMagnifier),img.addEventListener("mouseout",hideMagnifier))}else $("#page-wrapper").find("#viewFileDiv").find("#magnifyFiles").remove()},zoomFile:function(){$("#page-wrapper").find("#viewFileDiv").find("#magnifyFiles").remove(),$("#magnify_files").removeClass("sel");var zoomVal=parseInt($("#zoomRange").val()),val=($("#zoomRange").val()-$("#zoomRange").attr("min"))/($("#zoomRange").attr("max")-$("#zoomRange").attr("min"));Layout.Page.container.find("#zoomRange").css("background-image","-webkit-gradient(linear, left top, right top, color-stop("+val+", #ffffff), color-stop("+val+", #787878))"),$("#zoomval").text(zoomVal+"%");var imgOrigHeight=parseInt(Preview.imgOrgHeight)+parseInt(zoomVal),imgmaxheight=parseInt(610)+parseInt(zoomVal),imgmaxwidth=parseInt(1265)+parseInt(zoomVal);0!=zoomVal?($("#imageviewFrame").css("max-height",imgmaxheight+"px"),$("#imageviewFrame").css("max-width",imgmaxwidth+"px"),$("#imageviewFrame").height(imgOrigHeight+"px"),$("#imageviewFrame").width("auto")):($("#imageviewFrame").css("max-height","610px"),$("#imageviewFrame").css("max-width","1465px"),$("#imageviewFrame").height(imgOrigHeight+"px"),$("#imageviewFrame").width("auto"))}};ZPeople.Team={ReporteeList:[],pageLayout:void 0,gridLength:{},tableLength:{},erecno:{},ReporteListObj:[],filterObj:{},ModuleDataList:{},initObj:{},reporteePageMode:void 0,count:{},empObj:void 0,ReporteePageConf:{home:{submode:"home",onclickCallback:()=>ZPeople.getUserPage,kanbanOnClickCallback:()=>ZPeople.Team.Components.teamPageKanban,kanbanArrayCallback:()=>ZPeople.Team.Components.teamPageKanbanArray,filterRequired:!0,filterDetails:{DEPARTMENT:{label:ZPI18N.getString("zp.department"),allLabel:ZPI18N.getString("zp.alldepartment")},DESIGNATION:{label:ZPI18N.getString("zp.designation"),allLabel:ZPI18N.getString("zp.alldesignation")}},multipleView:!0,tableModuleDetailsCallback:()=>ZPeople.Team.Table.getData,tableModuleHeader:()=>ZPeople.Team.Table.getHeader,isSearchNeeded:!0},files:{submode:"files",onclickCallback:()=>FilesOperations.FolderListing.checkAndUpdateView},userprofile:{submode:"userprofile",onclickCallback:()=>ZPeople.getUserPage},peerView:{submode:"peerView",onclickCallback:()=>ZPeople.getUserPage,repManagerNeeded:!0,skipDirectAll:!0,skipTraversal:!0},lms:{submode:"lms-team",onclickCallback:()=>myTeamHandlers.handleCard,filterRequired:!0,filterDetails:{DESIGNATION:{label:ZPI18N.getString("zp.designation"),allLabel:ZPI18N.getString("zp.alldesignation")}},multipleView:!0,isSearchNeeded:!0,profileLastRowHeader:()=>()=>"",profileLastRowHtml:()=>()=>"",afterLoadCallback:()=>lmsTeam.afterLoadCallBack,skipTableAttnStatus:!0}},currReporteePageConf:null,init:function(key,empObj){if(ZPeople.Team.reporteePageMode=key||ZPTabs.currMainTab,ZPeople.Team.currReporteePageConf=ZPeople.Team.ReporteePageConf[ZPeople.Team.reporteePageMode],ZPeople.Team.pageLayout=Layout.Page.container,ZPeople.Team.empObj=empObj,ZPeople.FireScroll.getFireScrollPropertie().triggered=!0,ZPeople.Team.initObj[ZPeople.Team.reporteePageMode])if(ZPeople.Team.empObj)if("peerView"!=ZPeople.Team.currReporteePageConf.submode){if(!ZPeople.Team.currReporteePageConf.skipDirectAll){var pageId=ZPeople.Team.reporteePageMode+"-team";ZPeople.Team.Filter.viewMode[ZPeople.Team.reporteePageMode]=ZPeople.Team.pageLayout.find("#"+pageId+"-reporteeType li.zpl_act").attr("repType"),ZPeople.Team.Reportee.getSubordinate(ZPeople.Team.pageLayout.find(".subFilterIcn:last").attr("userId"))}}else ZPeople.Team.erecno[ZPeople.Team.reporteePageMode]=ZPeople.Team.empObj.usererec,ZPeople.Team.refreshData();else ZPeople.Team.refreshData();else{ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode]=[],ZPeople.Team.ModuleDataList[ZPeople.Team.reporteePageMode]={},ZPeople.Team.erecno[ZPeople.Team.reporteePageMode]=ZPeople.Team.empObj?ZPeople.Team.empObj.usererec:erecno,ZPeople.Team.initObj[ZPeople.Team.reporteePageMode]=!0,ZPeople.Team.gridLength[ZPeople.Team.reporteePageMode]=0,ZPeople.Team.tableLength[ZPeople.Team.reporteePageMode]=0,ZPeople.Team.pageLayout.attr("startInd",0),ZPeople.Team.pageLayout.attr("view","grid");var param={};ZPeople.Team.currReporteePageConf.skipDirectAll||(param.isInit=!0,ZPeople.Team.currReporteePageConf.filterRequired&&(param.filtersNeeded=JSON.stringify(Object.keys(ZPeople.Team.currReporteePageConf.filterDetails)))),param.needCount=!0,ZPeople.Team.currReporteePageConf.repManagerNeeded&&(param.repManagersNeeded=!0);var wrap=ZPeople.Team.pageLayout.find("#zpl_kban_switch");if(0!=wrap.length)return void ZPeople.Team.Filter.doFilter();wrap=$('<div id="zplContDiv" class="zpl_container"><div class="zpl_iwrpr" tabindex="0" aria-label="'+ZPI18N.getString("zp.wcag.reporteepage")+'"><div class="zpl_iwrprrgt"><div class="zpl_act zpl_tblfxd" scroll="enabled" id="zpl_kban_switch"></div></div></div></div>'),ZPeople.Team.Filter.viewMode[ZPeople.Team.reporteePageMode]=0,ZPeople.Team.pageLayout.html(wrap),(wrap=wrap.find("#zpl_kban_switch")).append($('<div class="zpl_rgtcnt zpl_mdltmvw"><div id="cards_view" class="zpl_emcrdlst" tabindex="0" aria-label="'+ZPI18N.getString("zp.wcag.proceedingtolist",[ZPI18N.getString("zp.reportees")])+'"></div></div>'));var viewContainer=wrap.find(".zpl_rgtcnt.zpl_mdltmvw");viewContainer.append($('<div id="team_tableview" class="zpl_rgtcnt DNI">')),viewContainer.append($('<div id="team_kanbanview" hor-scroll="0" class="zpl_emptkban_view DNI">')),ZPeople.Team.getEmployee(param,ZPeople.Team.initPage,ZPeople.Team.initPage,!0)}},initPage:function(status){var wrap=ZPeople.Team.pageLayout.find("#zpl_kban_switch");if(status){var pageId=ZPeople.Team.reporteePageMode+"-team";ZPeople.FireScroll.init(ZPeople.Team.getEmployee,void 0,{isScroll:!0}),ZPeople.FireScroll.getFireScrollPropertie().triggered=!0;var banner=$('<div class="zpl_btnmnu"><div class="zpl_lft"><div class="zpl_brdcrmp"></div></div>'+(ZPeople.Team.currReporteePageConf.isSearchNeeded?'<div class="search-cmn" id="'+pageId+'_srchDiv"><i class="PI_lens"></i><input type="text" class="ztextbox" id="'+pageId+'_empSearch" placeholder="'+ZPI18N.getString("zp.searchemployee")+'"><i id="'+pageId+'_clsSrch" class="PI_cls" role="button" aria-label="'+ZPI18N.getString("zp.search")+'" tabindex="0"></i></div>':"")+'<div id="'+pageId+'-btn_wrap" class="zpl_rgt">'+(ZPeople.Team.currReporteePageConf.skipDirectAll?'<ul class="zpl_grpmnu" aria-label="'+ZPI18N.getString("zp.sort")+'" role="tablist"><li tabindex="0" role="tab"><span>'+ZPI18N.getString("zp.members")+'</span><div class="zpl_tg"><span id="tm_count"></span></div></li></ul>':'<ul class="zpl_grpmnu" id="'+pageId+'-reporteeType"><li class="zpl_act" repType="0" tabindex="0" role="tab"><span>'+ZPI18N.getString("zp.local.Direct")+'</span><div class="zpl_tg"><span id="dCnt">'+ZPeople.Team.count.DIRECT+'</span></div></li><li tabindex="0" role="tab" repType="1"><span>'+ZPI18N.getString("zp.all")+'</span><div class="zpl_tg"><span id="aCnt">'+ZPeople.Team.count.ALL+"</span></div></li></ul>")+'<div class="grpbtn"></div>'+(ZPeople.Team.currReporteePageConf.isSearchNeeded?'<i class="zpl_ibg PI_lens" role="button" aria-label="'+ZPI18N.getString("zp.search")+'" tabindex="0" id="'+pageId+'_srchIcn" title="'+ZPI18N.getString("zp.searchemployee")+'" ></i>':"")+"</div></div>");banner.find("#"+pageId+"-reporteeType li").on("click",function(){$(this).siblings().removeClass("zpl_act"),$(this).addClass("zpl_act"),ZPeople.Team.Filter.doFilter()});var btnwrapGrp=banner.find("#"+pageId+"-btn_wrap .grpbtn");if((ZPeople.Team.currReporteePageConf.multipleView||void 0!=ZPeople.Team.currReporteePageConf.kanbanOnClickCallback)&&btnwrapGrp.append('<i class="PI_cardview zpl_act" tabindex="0" role="button" aria-label="'+ZPI18N.getString("zp.gridview")+'" title="'+ZPI18N.getString("zp.gridview")+'" type="grid"></i>'),ZPeople.Team.currReporteePageConf.multipleView&&btnwrapGrp.append('<i class="PI_listview" tabindex="0" role="button" aria-label="'+ZPI18N.getString("zp.listview")+'" title="'+ZPI18N.getString("zp.listview")+'" type="table"></i>'),ZPeople.Team.currReporteePageConf.filterRequired&&banner.find("#"+pageId+"-btn_wrap").append('<i class="zpl_ibg PI_fltr" tabindex="0" aria-haspopup="dialog" role="button" aria-label="'+ZPI18N.getString("zp.listview")+'" title="'+ZPI18N.getString("zp.filter")+'" onclick="ZPeople.Team.Filter.toggleFilter()"></i>'),wrap.prepend(banner),void 0!=ZPeople.Team.currReporteePageConf.kanbanOnClickCallback){var menuWrapId=pageId+"-filter_menuwrap",kanban=$('<i class="PI_kanban" id="kanban-icn" title="'+ZPI18N.getString("zp.kanbanview")+'" tabindex="0" role="button" aria-label="'+ZPI18N.getString("zp.kanbanview")+'" type="kanban"><div id="'+menuWrapId+'"></div></i>');btnwrapGrp.append(kanban);var menuList=ZPeopleComponents.menu(ZPeople.Team.pageLayout.find("#"+menuWrapId),{forElement:ZPeople.Team.pageLayout.find("#kanban-icn"),itemclick:ZPeople.Team.Filter.changeView,className:"zpl_drpdwn",appendTo:ZPeople.Team.pageLayout.find("#zpl_kban_switch")});ZPeople.Team.currReporteePageConf.kanbanArrayCallback()().forEach(function(menuObjs){menuList.addMenuItem(menuObjs)}),kanban.on("click",function(){ZPeopleComponents.menu(ZPeople.Team.pageLayout.find("#"+menuWrapId)).show()})}if(banner.find(".PI_cardview,.PI_listview").on("click",function(targer){ZPeople.Team.Filter.changeView(targer)}),ZPeople.Team.currReporteePageConf.isSearchNeeded){var timeout=null;banner.find("#"+pageId+"_empSearch").off("keyup").on("keyup",function(){clearTimeout(timeout),timeout=setTimeout(function(){ZPeople.Team.Filter.doFilter()},500)}),banner.find("#"+pageId+"_clsSrch").off("click").on("click",function(){banner.find("#"+pageId+"_empSearch").val(""),banner.find("#"+pageId+"_srchDiv").removeClass("opn"),ZPeople.Team.Filter.doFilter()}),banner.find("#"+pageId+"_srchIcn").off("click").on("click",function(){banner.find("#"+pageId+"_srchDiv").addClass("opn"),banner.find("#"+pageId+"_empSearch").focus()})}var empObj=ZPeople.Team.empObj?ZPeople.Team.empObj:ZPeople.CURR_USER;ZPeople.Team.currReporteePageConf.repManagerNeeded||banner.find("div.zpl_brdcrmp").prepend(ZPeople.Team.Components.userFilter(empObj.avatar,empObj.usererec,empObj.name,empObj.empid))}else wrap.html(ZPeople.Team.Components.noData)},refreshData:function(){"peerView"==ZPeople.Team.currReporteePageConf.submode&&(ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode]=[]),ZPeople.Team.Filter.doFilter()},clearPreviousData:function(){var wrap=ZPeople.Team.pageLayout.find("#zpl_kban_switch"),gridContainer=wrap.find("#cards_view"),tblContainer=wrap.find("#team_tableview");gridContainer.empty(),tblContainer.empty(),tblContainer.append(ZPeople.Team.Components.tableViewContainer()),ZPeople.Team.gridLength[ZPeople.Team.reporteePageMode]=0,ZPeople.Team.tableLength[ZPeople.Team.reporteePageMode]=0,ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode]=[]},constructRepManager:function(repObj){repObj.forEach(function(empObj){ZPeople.Team.pageLayout.find("div.zpl_brdcrmp").prepend(ZPeople.Team.Components.userFilter(empObj.EMPLOYEEPHOTO,empObj.ENO,ZSEC.Encoder.encodeForHTML(empObj.EMPLOYEENAME),ZSEC.Encoder.encodeForHTML(empObj.EMPLOYEEID),!0))}),ZPeople.Team.pageLayout.find(".subFilterIcn:last .zpl_emdts").removeClass("DNI")},setLoading:function(viewType,wrap,param){"kanban"==viewType?param.scrollDiv.append("<div id='loadingWrap'>"+ZPeople.LOADING_HTML+"</div>"):"table"==viewType?wrap.find("#team_tableview .zpl_tblres").append('<div id="loadingWrap">'+ZPeople.LOADING_HTML+"</div>"):wrap.find(".zpl_rgtcnt.zpl_mdltmvw").append('<div id="loadingWrap">'+ZPeople.LOADING_HTML+"</div>")},profileFirescroll:function(){var pageId=ZPeople.Team.reporteePageMode+"-team",param={isScroll:!0};param.selectedReportees=ZPeople.Team.pageLayout.find("#"+pageId+"-reporteeType li.zpl_act").attr("repType"),ZPeople.Team.getEmployee(param)},getEmployee:function(param,calback,failcallBack,initLoad){var pageId=ZPeople.Team.reporteePageMode+"-team",wrap=ZPeople.Team.pageLayout.find("#zpl_kban_switch"),viewType=ZPeople.Team.pageLayout.attr("view");param&&param.isScroll?ZPeople.Team.setLoading(viewType,wrap,param):wrap.append(ZPeople.LOADING_HTML);var extParam=ZPeople.Team.Reportee.setParams(param),filterObj=extParam.filterValues;ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode].length>extParam.startIndex&&"kanban"!=viewType&&"peerView"!=ZPeople.Team.currReporteePageConf.submode?(extParam.refreshAttendance=!0,extParam.refreshData=!0):!(extParam.startIndex<ZPeople.Team.ReporteeList.length&&"kanban"!=viewType)||filterObj&&0!=filterObj.length||extParam.selectedReportees>0||extParam.searchedTerm&&""!=extParam.searchedTerm||ZPeople.CURR_USER.usererec!=extParam.erecno||"peerView"==ZPeople.Team.currReporteePageConf.submode||(extParam.refreshAttendance=!0);var changeViewBtn=wrap.find("#"+pageId+"-filterBanner,#"+pageId+"-btn_wrap");changeViewBtn.addClass("disabled"),extParam.submode=ZPeople.Team.currReporteePageConf.submode,ZPeople.Request.send("/team/getReporteeDetails",extParam,function(response,param){changeViewBtn.removeClass("disabled");var searchEle=wrap.find("#"+pageId+"_empSearch");if(0==searchEle.length||(void 0!=param.searchedTerm?param.searchedTerm:"")==searchEle.val()){if(void 0!=extParam.searchedTerm&&0==extParam.startIndex&&ZPeople.Team.clearPreviousData(),!response.EmpData||$.isEmptyObject(response.EmpData.EmpDetails)&&!extParam.refreshAttendance&&"kanban"!=viewType||param.selectedReportees&&param.selectedReportees!=ZPeople.Team.Filter.viewMode[ZPeople.Team.reporteePageMode])ZPUtil.Validation.isFunction(calback)&&failcallBack(!1),ZPeople.Team.pageLayout.find("#zpl_kban_switch #zp_page_loading,#loadingWrap").remove();else{if("kanban"!=viewType){var length=param.refreshAttendance?Object.keys(response.EmpData.refreshData).length:response.EmpData.EmpDetails.length;ZPeople.Team.pageLayout.attr("startInd",param.startIndex+length),param.refreshAttendance||filterObj&&0!=filterObj.length||extParam.selectedReportees>0||extParam.searchedTerm&&""!=extParam.searchedTerm||ZPeople.CURR_USER.usererec!=extParam.erecno||"peerView"==ZPeople.Team.currReporteePageConf.submode||(ZPeople.Team.ReporteListObj.push(...response.EmpData.EmpDetails),ZPeople.Team.ReporteeList.push.apply(ZPeople.Team.ReporteeList,response.EmpData.EmpDetails.map(({ENO:ENO})=>ENO)),response.EmpData.COUNT&&(ZPeople.Team.count=response.EmpData.COUNT)),param.refreshData?ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode].slice(param.startIndex,param.startIndex+50).forEach(function(data){response.EmpData.refreshData[data.ENO]&&Object.assign(data,response.EmpData.refreshData[data.ENO])}):response.EmpData.EmpDetails?ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode].push(...response.EmpData.EmpDetails):ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode].push(...ZPeople.Team.ReporteListObj.slice(param.startIndex,param.startIndex+50)),Object.assign(ZPeople.Team.ModuleDataList[ZPeople.Team.reporteePageMode],response.EmpData.ModuleDetails)}ZPUtil.Validation.isFunction(calback)&&(calback(!0),ZPeople.Team.currReporteePageConf.filterRequired&&wrap.append(ZPeople.Team.Filter.constructFilter())),response.EmpData.repManagers&&ZPeople.Team.constructRepManager(response.EmpData.repManagers),"kanban"==viewType?wrap.find("#team_kanbanview").attr("hor-scroll")==param.kanbanPageIndex&&ZPeople.Team.Reportee.constructKanbanView(response.EmpData,param):ZPeople.Team.show(),ZPeople.Team.currReporteePageConf.skipDirectAll&&response.EmpData.COUNT&&wrap.find("#tm_count").html(response.EmpData.COUNT),response.EmpData.COUNT&&(wrap.find("#dCnt").html(response.EmpData.COUNT.DIRECT),wrap.find("#aCnt").html(response.EmpData.COUNT.ALL))}initLoad&&void 0!=ZPeople.Team.currReporteePageConf.afterLoadCallback&&ZPeople.Team.currReporteePageConf.afterLoadCallback()()}})},show:function(){var ConWrap=ZPeople.Team.pageLayout.find("#zpl_kban_switch"),empData=[],viewType=ZPeople.Team.pageLayout.attr("view"),container=ConWrap.find(".zpl_rgtcnt.zpl_mdltmvw .zpl_emcrdlst");if("grid"==viewType?(empData=$.isEmptyObject(ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode])?ZPeople.Team.ReporteListObj.slice(ZPeople.Team.gridLength[ZPeople.Team.reporteePageMode],ZPeople.Team.gridLength[ZPeople.Team.reporteePageMode]+50):ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode].slice(ZPeople.Team.gridLength[ZPeople.Team.reporteePageMode],ZPeople.Team.gridLength[ZPeople.Team.reporteePageMode]+50),ZPeople.Team.gridLength[ZPeople.Team.reporteePageMode]=ZPeople.Team.gridLength[ZPeople.Team.reporteePageMode]+=empData.length):(empData=$.isEmptyObject(ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode])?ZPeople.Team.ReporteListObj.slice(ZPeople.Team.tableLength[ZPeople.Team.reporteePageMode],ZPeople.Team.gridLength[ZPeople.Team.reporteePageMode]+50):ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode].slice(ZPeople.Team.tableLength[ZPeople.Team.reporteePageMode],ZPeople.Team.tableLength[ZPeople.Team.reporteePageMode]+50),ZPeople.Team.tableLength[ZPeople.Team.reporteePageMode]=ZPeople.Team.tableLength[ZPeople.Team.reporteePageMode]+=empData.length,container=ConWrap.find("#team_tableview tbody")),ConWrap.find("#zp_page_loading,#loadingWrap").remove(),!$.isEmptyObject(empData)&&(empData.forEach(function(EmpObj){var obj=ZPeople.Team.constructReportees(EmpObj,viewType);void 0!=ZPeople.Team.currReporteePageConf.onclickCallback&&obj.on("click",function(){"PI_subordinates"!=event.target.className&&ZPeople.Team.currReporteePageConf.onclickCallback()(EmpObj.ENO)}),container.append(obj)}),50==empData.length)){ZPeople.FireScroll.getFireScrollPropertie().triggered=!1;var scrolldiv="peerView"!=ZPeople.Team.reporteePageMode&&"userprofile"!=ZPeople.Team.reporteePageMode?ConWrap:ConWrap.parents('[pageid="'+ZPeople.Team.erecno[ZPeople.Team.reporteePageMode]+'"]');if(scrolldiv.height()&&scrolldiv.prop("scrollHeight")<=scrolldiv.height()){var calbackparam={isScroll:!0};ZPeople.Team.Filter.setFilterParam(calbackparam),ZPeople.Team.getEmployee(calbackparam)}}},constructReportees:function(EmpObj,viewType){var thirdRow="";if(ZPeople.Team.currReporteePageConf.profileLastRowHtml)thirdRow=ZPeople.Team.currReporteePageConf.profileLastRowHtml()(ZPeople.Team.ModuleDataList[ZPeople.Team.reporteePageMode][EmpObj.ENO]);else if(EmpObj.leaveAttStat){var leaveAttStat=ZPeople.decodeTxt(EmpObj.leaveAttStat),colourClass=Attendance.setClassToShowStatus(EmpObj.colourCode);Attendance.isLeaveAvail(EmpObj.colourCode)&&(leaveAttStat=EmpObj.leaveAttStat),thirdRow='<span class="'+colourClass+' ">'+leaveAttStat+"</span>",void 0!=EmpObj.checkInBuilding&&""!=EmpObj.checkInBuilding&&"table"!=viewType&&(thirdRow+="<em class='zpl_dots'></em>",thirdRow+="<span class='zpl_flexaligngap1 zpl_ellipsis'><i class='PI_building "+colourClass+" tooltip-js' title='"+EmpObj.checkInBuilding+"'></i>",thirdRow+="<em class='"+colourClass+" zpl_ellipsis' title='"+EmpObj.checkInBuilding+"'>"+EmpObj.checkInBuilding+"</em></span>")}if("grid"==viewType){var ModuleHtml="";return ZPeople.Team.currReporteePageConf.gridModuleDetailsCallback&&(ModuleHtml=ZPeople.Team.currReporteePageConf.gridModuleDetailsCallback()(ZPeople.Team.ModuleDataList[ZPeople.Team.reporteePageMode][EmpObj.ENO])),ZPeople.Team.Components.gridContent(EmpObj.EMPLOYEEPHOTO,EmpObj.EMPLOYEEID,EmpObj.EMPLOYEENAME,EmpObj.DESIGNATION,thirdRow,EmpObj.ENO,EmpObj.subAvilable,ModuleHtml,EmpObj.ZUID)}return"table"==viewType?ZPeople.Team.Components.tableContent(EmpObj,thirdRow,EmpObj.ENO,EmpObj.subAvilable):ZPeople.Team.Components.kanbanCards(EmpObj.EMPLOYEEPHOTO,EmpObj.EMPLOYEEID,EmpObj.EMPLOYEENAME,EmpObj.DESIGNATION,thirdRow,EmpObj.ENO,EmpObj.subAvilable,EmpObj.ZUID)},loadEmployeeFrom:function(){ZP5Views.callback()}},ZPeople.Team.Table={getData:(erecno,empdata)=>"<td><span>"+(ZPUtil.Validation.isEmpty(empdata.EMPLOYEEMAILALIAS)||"null"==empdata.EMPLOYEEMAILALIAS?"":empdata.EMPLOYEEMAILALIAS)+"</span></td><td><span>"+(ZPUtil.Validation.isEmpty(empdata.DATEOFJOINING)||"null"==empdata.DATEOFJOINING?"":empdata.DATEOFJOINING)+"</span></td>",getHeader:()=>"<th>"+ZPI18N.getString("zp.mail")+"</th><th>"+ZPI18N.getString("zp.local.Dateofjoining")+"</th>"},ZPeople.Team.Resigned={page:void 0,startIndex:0,filter:{PERIOD:0},init:function(){ZPeople.Team.Resigned.page=Layout.Page.container;var wrap=ZPeople.Team.Resigned.page.find("#resigned-wrap");0==wrap.length&&(wrap=$('<div id="zplContDiv" class="zpl_container"><div class="zpl_iwrpr"><div class="zpl_iwrprrgt"><div class="zpl_act zpl_tblfxd" scroll="enabled" id="resigned-wrap"></div></div></div></div>'),ZPeople.Team.Resigned.page.html(wrap),ZPeople.Team.Resigned.getResignedEmployee(!0))},pageInit:function(){var wrap=ZPeople.Team.Resigned.page.find("#resigned-wrap"),banner=$('<div class="zpl_btnmnu"><div class="zpl_lft"><div class="zpl_brdcrmp"><div class="subFilterIcn" userId="'+ZPeople.CURR_USER.usererec+'"><span class="zpl_em" tabindex="0" aria-label="'+ZPeople.CURR_USER.empid+" "+ZPeople.CURR_USER.name+'"><div class="zpl_emimg"><img class="zpl_emimg" src="'+ZPeople.CURR_USER.avatar+'"></div><div class="zpl_emdts zpl_ellipsis"><div>'+ZPeople.CURR_USER.empid+" - <b>"+ZPeople.CURR_USER.name+'</b></div></div></span></div></div></div><div id="btn_wrap" class="zpl_rgt"><ul class="zpl_grpmnu" id="ex-emp-reporteeType"><li class="zpl_act" repType="0"><span>'+ZPI18N.getString("zp.local.Direct")+'</span><div class="zpl_tg"><span id="dCnt">0</span></div></li><li repType="1"><span>'+ZPI18N.getString("zp.all")+'</span><div class="zpl_tg"><span id="aCnt">0</span></div></li></ul><i class="zpl_ibg PI_fltr" title="'+ZPI18N.getString("zp.filter")+'" onclick="ZPeople.Team.Resigned.toggleResignedFilter()"></i></div></div>');banner.find("#ex-emp-reporteeType li").on("click",function(){$(this).hasClass("zpl_act")||($(this).siblings().removeClass("zpl_act"),$(this).addClass("zpl_act"),ZPeople.Team.Resigned.startIndex=0,wrap.find("#cards_view").empty(),ZPeople.Team.Resigned.getResignedEmployee(!1,!0))}),wrap.append(banner),wrap.append(ZPeople.Team.Components.filterBanner("resigned")),wrap.append($('<div class="zpl_rgtcnt zpl_mdltmvw"><div id="cards_view" class="zpl_emcrdlst"></div></div>')),wrap.append('<div id="resFilter" class="zpl_fltr"><div><div class="zpl_fltrhd"><h5>'+ZPI18N.getString("zp.filter")+'</h5><i class="PI_cls" title="'+ZPI18N.getString("zp.close")+'" onclick="ZPeople.Team.Resigned.toggleResignedFilter()"></i></div></div><div class="zpl_fltrcnt"><div><div class="zpl_fltclps fltopn"><div id="field_container" class="zpl_fltrlst"><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.period")+'</label></div><div><select id="resignedPeriodFilter"></select></div></div><div class="zpl_secn DNI" id="dateRangePickerFieldDiv"><div><label>'+ZPI18N.getString("zp.range")+'</label></div><div><div class="ztextbox--group zh-alignright" id="periodRangePickerParent"><i class="ztextbox__icon PI_monthly"></i><input style="width: 230px;" id="dateRangeInput" class="ztextbox" placeholder="'+dateFmt+" - "+dateFmt+'"></div><div id="periodRangePicker"></div></div></div></div></div></div></div><div><button id="apl_filter" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="ZPeople.Team.Resigned.applyFilter()">'+ZPI18N.getString("zp.apply")+'</button><button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="ZPeople.Team.Resigned.resetFilter()">'+ZPI18N.getString("zp.reset")+"</button></div></div>");let selectOptions={dataMapping:{label:"label",text:"label",value:"value"},dropdownList:{width:"fit-content"},options:[{label:"5 "+ZPI18N.getString("zp.common.years"),value:"0"},{label:"1 "+ZPI18N.getString("zp.year"),value:"1"},{label:"6 "+ZPI18N.getString("zp.leave.customize.months"),value:"2"},{label:ZPI18N.getString("zp.custom"),value:"3"}],selectedValue:0,change:function(event,data){"3"==data.selectedValue?wrap.find("#dateRangePickerFieldDiv").removeClass("DNI"):wrap.find("#dateRangePickerFieldDiv").addClass("DNI")}};ZPeopleComponents.select(wrap.find("#resignedPeriodFilter"),selectOptions),new FireScrollBack(ZPeople.Team.Resigned.getResignedEmployee,wrap,"team-resigned-fs");wrap.find("#resigned-filterBanner").html('<li><label class="M0I">'+ZPI18N.getString("zp.period")+" :</label><span>5 "+ZPI18N.getString("zp.common.years")+"</span></li>"),wrap.find("#resigned-filterBanner>li").off("click").on("click",ZPeople.Team.Resigned.toggleResignedFilter),wrap.find("#periodRangePickerParent").off("click").on("click",function(){ZPeopleComponents.daterangepicker(wrap.find("#periodRangePicker"),{forElement:"#periodRangePickerParent",minDate:moment().subtract(5,"years").format("YYYY-MM-DD"),maxDate:moment().format("YYYY-MM-DD"),format:"yyyy-MM-dd",change:(event,data)=>{wrap.find("#dateRangeInput").val(moment(data.fromValueString).format(dateFmt.toUpperCase())+" - "+moment(data.toValueString).format(dateFmt.toUpperCase())).attr("fromDate",data.fromValueString).attr("toDate",data.toValueString)}}).open()})},toggleResignedFilter:function(){ZPeople.Team.Resigned.page.find("#resigned-wrap").toggleClass("zpl_fltr_flt")},applyFilter:function(){var wrap=ZPeople.Team.Resigned.page.find("#resigned-wrap");ZPeople.Team.Resigned.page.find("#resigned-wrap").find("#cards_view").empty(),ZPeople.Team.Resigned.startIndex=0;let PeriodFilter=ZPeopleComponents.select(wrap.find("#resignedPeriodFilter"));ZPeople.Team.Resigned.filter.PERIOD=PeriodFilter.getValue();let label=PeriodFilter.getOptionData()[0].label;if(wrap.find("#resigned-filterBanner").html('<li><label class="M0I">'+ZPI18N.getString("zp.period")+" :</label><span>"+label+"</span></li>"),"3"==ZPeople.Team.Resigned.filter.PERIOD){if(ZPeople.Team.Resigned.filter.fromDate=wrap.find("#dateRangeInput").attr("fromDate"),ZPeople.Team.Resigned.filter.toDate=wrap.find("#dateRangeInput").attr("toDate"),!ZPeople.Team.Resigned.filter.fromDate||!ZPeople.Team.Resigned.filter.toDate)return void ZPeople.Team.Resigned.resetFilter();wrap.find("#resigned-filterBanner").append('<li><label class="M0I">'+ZPI18N.getString("zp.fromdate")+" :</label><span>"+moment(ZPeople.Team.Resigned.filter.fromDate).format(dateFmt.toUpperCase())+"</span></li>"),wrap.find("#resigned-filterBanner").append('<li><label class="M0I">'+ZPI18N.getString("zp.todate")+" :</label><span>"+moment(ZPeople.Team.Resigned.filter.toDate).format(dateFmt.toUpperCase())+"</span></li>")}else delete ZPeople.Team.Resigned.filter.fromDate,delete ZPeople.Team.Resigned.filter.toDate;wrap.find("#resigned-filterBanner>li").off("click").on("click",ZPeople.Team.Resigned.toggleResignedFilter),ZPeople.Team.Resigned.getResignedEmployee(!1,!0)},resetFilter:function(){var wrap=ZPeople.Team.Resigned.page.find("#resigned-wrap");ZPeopleComponents.select(wrap.find("#resignedPeriodFilter")).setValue(0),ZPeople.Team.Resigned.applyFilter()},getResignedEmployee:function(isInit,reconstruct){var wrap=ZPeople.Team.Resigned.page.find("#resigned-wrap"),param={erecno:ZPeople.CURR_USER.usererec,submode:"resigned",startIndex:ZPeople.Team.Resigned.startIndex};param.needCount=isInit||reconstruct,param.selectedReportees=ZPeople.Team.Resigned.page.find("#ex-emp-reporteeType li.zpl_act").attr("repType"),param.filterValues=JSON.stringify(ZPeople.Team.Resigned.filter),wrap.find(".zpl_rgtcnt.zpl_mdltmvw").append('<div id="loadingWrap">'+ZPeople.LOADING_HTML+"</div>"),ZPeople.Request.send("/team/getReporteeDetails",param,function(response,param){if(wrap.find("#loadingWrap").remove(),isInit&&ZPeople.Team.Resigned.pageInit(),$.isEmptyObject(response.EmpData.EmpDetails))reconstruct||isInit&&response.EmpData.COUNT.ALL>0?ZPeople.Team.Resigned.page.find("#cards_view").removeClass("zpl_emcrdlst").html(ZPeople.Team.Components.noDataOnFilter):isInit&&wrap.html(ZPeople.Team.Components.noData);else{50==response.EmpData.EmpDetails.length&&settingsPage.fireScrollObj["team-resigned-fs"].reset(),ZPeople.Team.Resigned.startIndex+=response.EmpData.EmpDetails.length;var container=wrap.find("#cards_view").addClass("zpl_emcrdlst");response.EmpData.EmpDetails.forEach(function(EmpObj){var obj=ZPeople.Team.Resigned.ConstructCards(EmpObj.EMPLOYEEPHOTO,EmpObj.EMPLOYEEID,EmpObj.EMPLOYEENAME,EmpObj.DESIGNATION,EmpObj.DATEOFEXIT,EmpObj.EXPERIENCE);container.append(obj)})}param.needCount&&(wrap.find("#dCnt").html(response.EmpData&&response.EmpData.COUNT?response.EmpData.COUNT.DIRECT:0),wrap.find("#aCnt").html(response.EmpData&&response.EmpData.COUNT?response.EmpData.COUNT.ALL:0))})},ConstructCards:function(EMPLOYEEPHOTO,EMPLOYEEID,EMPLOYEENAME,DESIGNATION,DOE,EXPERIENCE){return $('<div class="zpl_dfcrd zpl_tmusrcrd"><div class="zpl_emcrdcnt" aria-label="'+ZSEC.Encoder.encodeForHTML(EMPLOYEEID)+" - "+ZSEC.Encoder.encodeForHTML(EMPLOYEENAME)+" "+DESIGNATION+'" tabindex="0"><div class="zpl_em"><div class="zpl_emimg"><img src="'+EMPLOYEEPHOTO+'"></div><div class="zpl_emdts zpl_ellipsis"><div>'+ZSEC.Encoder.encodeForHTML(EMPLOYEEID)+' - <b title="'+ZSEC.Encoder.encodeForHTML(EMPLOYEENAME)+'">'+ZSEC.Encoder.encodeForHTML(EMPLOYEENAME)+"</b></div><div><em>"+DESIGNATION+'</em></div></div></div></div><div class="zpl_empTmInfo d-flexclmcap20"><div class="d-flexclmcap20"><div class="zpl_spltbrdR d-flexclmcap5 flex-dirC"><em>'+ZPI18N.getString("zp.relieveddate")+":</em><b>"+DOE+'</b></div></div><div><div class="zpl_tg"><span class="flex-dirC"><b>'+ZPI18N.getString("zp.experience")+"</b><em>"+(EXPERIENCE/12>=1?Math.floor(EXPERIENCE/12)+" "+ZPI18N.getString("zp.wftbayears"):EXPERIENCE+" "+ZPI18N.getString("zp.wftbamonths"))+"</em></span></div></div></div></div>")}},ZPeople.Team.Filter={isRefreshNeed:!1,viewMode:{},searchCache:{},constructFilter:function(){var pageId=ZPeople.Team.reporteePageMode+"-team",fieldContainer=ZPeople.Team.pageLayout.find("#"+pageId+"_filter #field_container");if(0==fieldContainer.length){var html=$(ZPeople.Team.Components.filterContainer(pageId+"_filter","ZPeople.Team.Filter.doFilter()","ZPeople.Team.Filter.resetFilter()"));fieldContainer=html.find("#field_container")}var filterArr=Object.keys(ZPeople.Team.currReporteePageConf.filterDetails);for(var key in filterArr)ZPeople.Team.Filter.constructFields(filterArr[key],fieldContainer,pageId);return html},constructFields:function(fieldName,container,pageId){ZPeople.Team.currReporteePageConf.submode;var fieldDisName,fieldId,optionLabel="label",optionValue="value",prop={submode:fieldName};if(ZPeople.Team.currReporteePageConf.filterDetails&&ZPeople.Team.currReporteePageConf.filterDetails[fieldName]&&(fieldId=pageId+"_"+fieldName,fieldDisName=ZPeople.Team.currReporteePageConf.filterDetails[fieldName].label,optionLabel=fieldName+"NAME",optionValue=fieldName+"ID"),0==container.find("#"+fieldId).length){var fieldHtml=$(`\n\t\t\t\t\t<div class="zpl_secn">\n\t\t\t\t\t<div><label>${fieldDisName}</label></div>\n\t\t\t\t\t<div><select id="${fieldId}"></select></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t`);container.append(fieldHtml),ZPeopleComponents.select(fieldHtml.find("#"+fieldId),{dataMapping:{label:optionLabel,text:optionLabel,value:optionValue},dropdownList:{width:"fit-content"},showSearchField:!0,placeholder:ZPeople.Team.currReporteePageConf.filterDetails[fieldName].allLabel,search:{delay:200},serverSearch:!0,cacheData:!1,dataSource:{search:e=>new Promise(function(search,reject){let params={};params.submode=prop.submode,params.query=e.query,params.erecno=ZPeople.Team.erecno[ZPeople.Team.reporteePageMode],params.repType=ZPeople.Team.Filter.viewMode[ZPeople.Team.reporteePageMode],ZPeople.Request.send("/team/getFilterSearchData",params,resultData=>{resultData.filterArr&&search({results:resultData.filterArr,more:!1})})})}})}ZPeopleComponents.select(container.find("#"+fieldId)).removeAllOptions()},toggleFilter:function(){ZPeople.Team.pageLayout.find("#zpl_kban_switch").toggleClass("zpl_fltr_flt")},resetFilter:function(){var pageId=ZPeople.Team.reporteePageMode+"-team";Object.keys(ZPeople.Team.currReporteePageConf.filterDetails).filter(fid=>{var id=pageId+"_"+fid,filterData=ZPeople.Team.pageLayout.find("#zpl_kban_switch #"+pageId+"_filter #"+id);0!=filterData.length&&ZPeopleComponents.select(filterData).deselectAllOptions()}),ZPeople.Team.Filter.doFilter()},doFilter:function(){var pageId=ZPeople.Team.reporteePageMode+"-team";ZPeople.FireScroll.getFireScrollPropertie().triggered=!0,ZPeople.Team.pageLayout.attr("startInd",0);var param={},wrap=ZPeople.Team.pageLayout.find("#zpl_kban_switch");wrap.find("#"+pageId+"-fltvw").remove();var gridContainer=wrap.find("#cards_view"),tblContainer=wrap.find("#team_tableview"),applyBtn=wrap.find("#"+pageId+"_filter #apl_filter");ZPeople.Team.pageLayout.find("#team_kanbanview").attr("hor-scroll",0),applyBtn.addClass("disabled"),ZPeople.Team.Filter.setFilterParam(param);var calbackparam={};if((calbackparam=Object.assign({},param)).isScroll=!0,param.needCount=!0,gridContainer.empty(),tblContainer.empty(),wrap.find("#team_kanbanview").empty(),"kanban"==ZPeople.Team.pageLayout.attr("view")&&(ZPeople.Team.Filter.isRefreshNeed=!0,param.isInit=!0),ZPeople.Team.gridLength[ZPeople.Team.reporteePageMode]=0,ZPeople.Team.tableLength[ZPeople.Team.reporteePageMode]=0,ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode]=[],"kanban"!=ZPeople.Team.pageLayout.attr("view"))ZPeople.Team.getEmployee(param,function(status,extraParam){tblContainer.empty(),wrap.find("#dCnt").html(ZPeople.Team.count.DIRECT),wrap.find("#aCnt").html(ZPeople.Team.count.ALL),gridContainer.addClass("zpl_emcrdlst"),tblContainer.addClass("zpl_rgtcnt"),ZPeople.FireScroll.init(ZPeople.Team.getEmployee,void 0,calbackparam),ZPeople.FireScroll.getFireScrollPropertie().triggered=!0,tblContainer.append(ZPeople.Team.Components.tableViewContainer()),applyBtn.removeClass("disabled")},function(){wrap.find("#dCnt").html(0),wrap.find("#aCnt").html(0),ZPeople.Team.pageLayout.find("#zpl_kban_switch #zp_page_loading,#loadingWrap").remove(),gridContainer.removeClass("zpl_emcrdlst"),tblContainer.removeClass("zpl_rgtcnt"),gridContainer.append(ZPeople.Team.Components.noDataOnFilter),tblContainer.append(ZPeople.Team.Components.noDataOnFilter),applyBtn.removeClass("disabled")});else{wrap.data("filterType");applyBtn.removeClass("disabled"),ZPeople.Team.currReporteePageConf.kanbanOnClickCallback()(param)}},setFilterParam:function(param){var pageId=ZPeople.Team.reporteePageMode+"-team",wrap=ZPeople.Team.pageLayout.find("#zpl_kban_switch"),filterObj={};if(ZPeople.Team.currReporteePageConf.filterRequired){Object.keys(ZPeople.Team.currReporteePageConf.filterDetails).filter(fid=>{var id=pageId+"_"+fid,filterData=wrap.find("#"+pageId+"_filter #"+id);if(0!=filterData.length){var component=ZPeopleComponents.select(filterData),value=component.getValue(),filterName="";if(0!=value){filterName=ZPeople.Team.currReporteePageConf.filterDetails[fid].label,filterObj[fid]=value;var filterTxt=component.getElement().text().trim(),filetrlist=wrap.find("#"+pageId+"-filterBanner");(filetrlist=0==filetrlist.length?$(ZPeople.Team.Components.filterBanner(pageId)).insertAfter(wrap.find(".zpl_btnmnu")).find("#"+pageId+"-filterBanner"):filetrlist).find("#"+id).remove(),filetrlist.append(ZPeople.Team.Components.filterData(id,filterName,filterTxt))}}});var searchEle=wrap.find("#"+pageId+"_empSearch");0!=searchEle.length&&(param.searchedTerm=searchEle.val()),param.filterValues=JSON.stringify(filterObj)}ZPeople.Team.currReporteePageConf.skipDirectAll||(param.selectedReportees=ZPeople.Team.pageLayout.find("#"+pageId+"-reporteeType li.zpl_act").attr("repType"),param.selectedReportees!=ZPeople.Team.Filter.viewMode[ZPeople.Team.reporteePageMode]&&(param.isInit=!0,ZPeople.Team.Filter.viewMode[ZPeople.Team.reporteePageMode]=param.selectedReportees)),"kanban"==ZPeople.Team.pageLayout.attr("view")&&(param.filterType=ZPeople.Team.pageLayout.find("#zpl_kban_switch").data("filterType"))},changeView:function(element,data){var param={},viewType=$(element.target).attr("type");data&&(viewType=$(data.forElement).attr("type"),param.filterType=data.filterType),param.isInit=!0;var ConWrap=ZPeople.Team.pageLayout.find("#zpl_kban_switch"),filterType=ConWrap.data("filterType"),viewButtons=ConWrap.find(".zpl_btnmnu .grpbtn");if(ConWrap.scrollTop(0),"grid"==viewType&&ZPeople.Team.pageLayout.attr("view")!=viewType)ConWrap.removeClass("zpl_emptkban_switch"),ZPeople.Team.pageLayout.attr("view","grid"),ConWrap.find("#team_tableview,#team_kanbanview").addClass("DNI"),ConWrap.find("#cards_view").removeClass("DNI zpl_Empdatafxd"),viewButtons.find(".PI_cardview").addClass("zpl_act").siblings().removeClass("zpl_act"),ZPeople.Team.Filter.isRefreshNeed?(ZPeople.Team.Filter.isRefreshNeed=!1,ZPeople.Team.Filter.doFilter()):ZPeople.Team.refreshData();else if("table"==viewType&&ZPeople.Team.pageLayout.attr("view")!=viewType){ConWrap.removeClass("zpl_emptkban_switch"),viewButtons.find(".PI_listview").addClass("zpl_act").siblings().removeClass("zpl_act"),ZPeople.Team.pageLayout.attr("view","table");var teamTbl=ConWrap.find("#team_tableview");ConWrap.find("#cards_view,#team_kanbanview").addClass("DNI"),0==teamTbl.find(".zpl_tblres").length&&(ZPeople.Team.filterObj[ZPeople.Team.reporteePageMode].length>0||ZPeople.Team.ReporteListObj.length>0)&&teamTbl.append($(ZPeople.Team.Components.tableViewContainer())),teamTbl.removeClass("DNI zpl_Empdatafxd"),ZPeople.Team.Filter.isRefreshNeed?(ZPeople.Team.Filter.isRefreshNeed=!1,ZPeople.Team.Filter.doFilter()):ZPeople.Team.refreshData()}else if("kanban"==viewType&&ZPeople.Team.pageLayout.attr("view")!=viewType||filterType!=data.filterType){viewButtons.find(".PI_kanban").addClass("zpl_act").siblings().removeClass("zpl_act"),ConWrap.data("filterType",data.filterType),ZPeople.Team.pageLayout.attr("view","kanban"),ConWrap.find("#team_tableview,#cards_view").addClass("DNI"),ConWrap.find("#team_kanbanview").empty(),ConWrap.find("#team_kanbanview").removeClass("DNI zpl_Emptydata"),ConWrap.find("#team_kanbanview").attr("hor-scroll",0);var filterParam={};ZPeople.Team.Filter.setFilterParam(filterParam),ZPeople.Team.currReporteePageConf.kanbanOnClickCallback()(filterParam,element)}},removeFilter:function(id){var pageId=ZPeople.Team.reporteePageMode+"-team",filterData=ZPeople.Team.pageLayout.find("#zpl_kban_switch #"+pageId+"_filter #"+id);0!=filterData.length&&(ZPeopleComponents.select(filterData).deselectAllOptions(),ZPeople.Team.Filter.doFilter())}},ZPeople.Team.Reportee={getSubordinate:function(erecno,img,name,empId){var container=ZPeople.Team.pageLayout.find("#zpl_kban_switch");"kanban"==ZPeople.Team.pageLayout.attr("view")&&(ZPeople.Team.Filter.isRefreshNeed=!0),img&&(ZPeople.Team.pageLayout.find("[userId="+ZPeople.Team.erecno[ZPeople.Team.reporteePageMode]+"].subFilterIcn .zpl_emdts.zpl_ellipsis").addClass("DNI"),$(ZPeople.Team.Components.userFilter(img,erecno,ZSEC.Encoder.encodeForHTML(name),ZSEC.Encoder.encodeForHTML(empId))).insertAfter(container.find('[userid="'+ZPeople.Team.erecno[ZPeople.Team.reporteePageMode]+'"]'))),ZPeople.Team.erecno[ZPeople.Team.reporteePageMode]=erecno,ZPeople.Team.Filter.doFilter()},constructKanbanView:function(response,param){var wrapper=ZPeople.Team.pageLayout.find("#zpl_kban_switch"),kanbanWrp=wrapper.find("#team_kanbanview");param.isInit&&(wrapper.addClass("zpl_emptkban_switch"),delete param.needCount,kanbanWrp.empty(),kanbanWrp.removeClass("zpl_Emptydata"));var dataArr=[];param&&param.filterType&&response[param.filterType]&&(dataArr=response[param.filterType]),param.isScroll=!0,wrapper.find("#zp_page_loading,#loadingWrap").remove();var knbnfs={};for(let i=0;i<dataArr.length;i++){let dataObj=dataArr[i],key=dataObj.id;var obj=dataObj.data;if(obj.LABLE){var wrap=kanbanWrp.find("#wrap_"+key),container=wrap.find("#bdy_"+key);if(param.scrollDiv=wrap,knbnfs["fs"+key]=Object.assign({},param),0==wrap.length)kanbanWrp.append(ZPeople.Team.Components.kanbanViewContainer(key,obj.LABLE,obj.COUNT)),wrap=kanbanWrp.find("#wrap_"+key),container=wrap.find("#bdy_"+key),wrap.attr("startInd",0),knbnfs["fs"+key].scrollDiv=param.scrollDiv=wrap,ZPeople.Team.getEmployee(knbnfs["fs"+key]);else if(wrap.attr("startInd",parseInt(param.startIndex)+obj.LIST.length),50==obj.LIST.length)(settingsPage.fireScrollObj["fswrap_"+key]?settingsPage.fireScrollObj["fswrap_"+key]:new FireScrollBack(()=>ZPeople.Team.getEmployee(knbnfs["fs"+key]),wrap,"fswrap_"+key)).reset();obj.LIST&&obj.LIST.forEach(function(empObj){var obj=ZPeople.Team.constructReportees(empObj,"kanban");void 0!=ZPeople.Team.currReporteePageConf.onclickCallback&&obj.on("click",function(){"PI_subordinates"!=event.target.className&&ZPeople.Team.currReporteePageConf.onclickCallback()(empObj.ENO)}),container.append(obj)})}}if(param.isInit&&0==dataArr.length&&(kanbanWrp.addClass("zpl_Emptydata"),wrapper.removeClass("zpl_emptkban_switch"),kanbanWrp.html(ZPeople.Team.Components.noDataOnFilter)),param.isInit&&(kanbanWrp.find("#team_kanban_pagination").remove(),parseInt(kanbanWrp.attr("hor-scroll"))>0||response.nextPageAvailable)){var filterParam={};ZPeople.Team.Filter.setFilterParam(filterParam);let carouselarws=$('<div class="zpl_carouselarws" id="team_kanban_pagination"></div>');if(parseInt(kanbanWrp.attr("hor-scroll"))>0){let left=$('<div><i class="PI_fil_arwlft"></i></div>').on("click",function(){kanbanWrp.empty(),kanbanWrp.removeClass("DNI zpl_Emptydata"),kanbanWrp.attr("hor-scroll",parseInt(kanbanWrp.attr("hor-scroll"))-4),ZPeople.Team.currReporteePageConf.kanbanOnClickCallback()(filterParam)});carouselarws.append(left)}if(response.nextPageAvailable){let right=$('<div><i class="PI_fil_arwrgt"></i></div>').on("click",function(){kanbanWrp.empty(),kanbanWrp.removeClass("DNI zpl_Emptydata"),kanbanWrp.attr("hor-scroll",parseInt(kanbanWrp.attr("hor-scroll"))+4),ZPeople.Team.currReporteePageConf.kanbanOnClickCallback()(filterParam)});carouselarws.append(right)}kanbanWrp.prepend(carouselarws)}delete param.isInit},setParams:function(param){var extParam={},ConWrap=ZPeople.Team.pageLayout.find("#zpl_kban_switch");param&&(extParam=param);var viewType=ZPeople.Team.pageLayout.attr("view");if(extParam.viewType=viewType,extParam.erecno=ZPeople.Team.erecno[ZPeople.Team.reporteePageMode],param.isScroll&&delete extParam.isInit,ConWrap.data("filterType")&&(extParam.filterType=ConWrap.data("filterType")),"kanban"==viewType){if(extParam.startIndex=0,param&&param.scrollDiv){var scrollDiv=param.scrollDiv,selectedType=scrollDiv.attr("id").replace("wrap_",""),filterObj={};"SENIORITY"==extParam.filterType?filterObj.SENIORITY=selectedType:"DESIGNATION"==extParam.filterType?filterObj.DESIGNATION=selectedType:"DEPARTMENT"==extParam.filterType?filterObj.DEPARTMENT=selectedType:"STREAM"==extParam.filterType&&(filterObj.STREAM=selectedType),extParam.filterValues=JSON.stringify(filterObj),extParam.startIndex=scrollDiv.attr("startInd")}extParam.kanbanPageIndex=ZPeople.Team.pageLayout.find("#team_kanbanview").attr("hor-scroll")}else extParam.startIndex=parseInt(ZPeople.Team.pageLayout.attr("startInd"));return delete extParam.scrollDiv,extParam},getProfileheaderParam:()=>{let param={mode:"reportees",employee:ZPeople.Team&&ZPeople.Team.erecno[ZPeople.Team.reporteePageMode]?ZPeople.Team.erecno[ZPeople.Team.reporteePageMode]:erecno};var pageId=ZPeople.Team.reporteePageMode+"-team";return param.reporteeType=$(ZPeople.Team.pageLayout).find("#"+pageId+"-reporteeType li.zpl_act").attr("repType"),param}},ZPeople.Team.PeerView={show:userId=>{var userObject={};userObject=userId?ZPeople.getUserDetailsById(userId):ZPeople.CURR_USER,0==Layout.Page.container.find("#zpl_kban_switch").length&&(ZPeople.Team.initObj[ZPeople.Team.reporteePageMode]=!1),ZPeople.Team.init("peerView",userObject)}},ZPeople.Team.Components={filterBanner:function(pageid){return`<div class="zpl_fltrvw" id="${pageid}-fltvw"><div> <ul id="${pageid}-filterBanner" class="zpl_fltrvwlst M0I"></ul> </div></div>`},filterData:function(id,lable,value){return'<li id="'+id+'"><label class="M0I">'+ZSEC.Encoder.encodeForHTML(lable)+" :</label><span>"+ZSEC.Encoder.encodeForHTML(value)+'</span><a class="PI_cls" onclick="ZPeople.Team.Filter.removeFilter(\''+id+"')\"></a></li>"},teamPageKanban:function(param,event){param.isInit=!0,param.needCount=!0,ZPeople.Team.getEmployee(param)},teamPageKanbanArray:function(){return[{label:ZPI18N.getString("zp.seniority"),filterType:"SENIORITY",index:0},{label:ZPI18N.getString("zp.department"),filterType:"DEPARTMENT",index:1},{label:ZPI18N.getString("zp.designation"),filterType:"DESIGNATION",index:2}]},tableContent:function(empObj,attStatus,erec,subAvlSts){var element=$('<tr><td><div class="zpl_em" tabindex="0" aria-label="'+ZSEC.Encoder.encodeForHTML(empObj.EMPLOYEEID)+" "+ZSEC.Encoder.encodeForHTML(empObj.EMPLOYEENAME)+'"><div class="zpl_emimg"><img class="zpl_emimg" src="'+empObj.EMPLOYEEPHOTO+'"></div><div class="zpl_emdts"><div><em>'+ZSEC.Encoder.encodeForHTML(empObj.EMPLOYEEID)+' - </em><b title="'+ZSEC.Encoder.encodeForHTML(empObj.EMPLOYEENAME)+'">'+ZSEC.Encoder.encodeForHTML(empObj.EMPLOYEENAME)+'</b></div></div><div class="MLauto zpl_hvr zpl_hvrsw" name="buttons" ></div></div></td>'+(ZPeople.Team.currReporteePageConf.skipTableAttnStatus?"":"<td><span>"+attStatus+"</span></td>")+"<td><span>"+empObj.DESIGNATION+"</span></td></tr>");return ZPeople.Team.currReporteePageConf.tableModuleDetailsCallback&&$(element).append(ZPeople.Team.currReporteePageConf.tableModuleDetailsCallback()(ZPeople.Team.ModuleDataList[ZPeople.Team.reporteePageMode][erec],empObj)),subAvlSts&&1!=ZPeople.Team.Filter.viewMode[ZPeople.Team.reporteePageMode]&&!ZPeople.Team.currReporteePageConf.skipTraversal&&element.find("[name=buttons]").append(ZPeople.Team.Components.subFilterIcn(empObj.EMPLOYEEPHOTO,erec,empObj.EMPLOYEENAME,empObj.EMPLOYEEID)),element},gridContent:function(EMPLOYEEPHOTO,EMPLOYEEID,EMPLOYEENAME,DESIGNATION,attStatus,erec,subAvlSts,moduleHtml,ZUID){var element=$('<div class="zpl_dfcrd zpl_tmusrcrd"><div class="zpl_emcrdcnt"  tabindex="0" aria-label="'+ZSEC.Encoder.encodeForHTML(EMPLOYEEID)+" "+ZSEC.Encoder.encodeForHTML(EMPLOYEENAME)+'"><div class="zpl_em"><div class="zpl_emimg"><img src="'+EMPLOYEEPHOTO+'">'+(ZUID?'<span cstus="true" uid="'+ZUID+'"></span>':"")+'</div><div class="zpl_emdts zpl_ellipsis"><div>'+ZSEC.Encoder.encodeForHTML(EMPLOYEEID)+' - <b title="'+ZSEC.Encoder.encodeForHTML(EMPLOYEENAME)+'">'+ZSEC.Encoder.encodeForHTML(EMPLOYEENAME)+"</b></div><div><em>"+DESIGNATION+'</em></div><div class="zpl_flex-a-c">'+attStatus+'</div></div><div class="MLauto d-flexclm4 zpl_hvr zpl_hvrsw" name="buttons"></div></div></div></div>');return"true"==ZPeople.ISCHAT&&ZUID&&ZPeople.CURRENT_ZUID!=ZUID&&element.find("[name=buttons]").append('<i title="'+ZPI18N.getString("zp.chatandcall")+'" uid="'+ZUID+'" chat_comm="true" class="PI_pharw" aria-label="'+ZPI18N.getString("zp.options")+":"+ZPI18N.getString("zp.chatsettings.chat")+", "+ZPI18N.getString("zp.chatsettings.audiocall")+","+ZPI18N.getString("zp.chatsettings.videocall")+'" tabindex="0" aria-haspopup="true" role="button" ></i>'),subAvlSts&&1!=ZPeople.Team.Filter.viewMode[ZPeople.Team.reporteePageMode]&&!ZPeople.Team.currReporteePageConf.skipTraversal&&element.find("[name=buttons]").append(ZPeople.Team.Components.subFilterIcn(EMPLOYEEPHOTO,erec,EMPLOYEENAME,EMPLOYEEID)),moduleHtml&&element.append(moduleHtml),element},noDataOnFilter:'<div class="zpl_Emptydata"> <div> <div class="zpl_emptimg zp_nd_empprfl"></div> <h4>'+ZPI18N.getString("zp.nofilterrecord")+"</h4></div> </div>",tableViewContainer:function(){var moduleHeader="";if(ZPeople.Team.currReporteePageConf.tableModuleHeader)moduleHeader=ZPeople.Team.currReporteePageConf.tableModuleHeader()();var profileLastHead="<th>"+ZPI18N.getString("zp.status")+"</th>";return ZPeople.Team.currReporteePageConf.profileLastRowHeader&&(profileLastHead=ZPeople.Team.currReporteePageConf.profileLastRowHeader()()),'<div class="zpl_tblres"><table class="zpl_tbl"><thead><tr><th>'+ZPI18N.getString("zp.employee")+"</th>"+profileLastHead+"<th>"+ZPI18N.getString("zp.designation")+"</th>"+moduleHeader+"</tr></thead><tbody></tbody></table></div>"},filterContainer:function(filterId,applyCallback,resetCallback){return'<div id="'+filterId+'" class="zpl_fltr"><div><div class="zpl_fltrhd"><h5>'+ZPI18N.getString("zp.filter")+'</h5><i class="PI_cls" title="'+ZPI18N.getString("zp.close")+'" onclick="ZPeople.Team.Filter.toggleFilter()"></i></div></div><div class="zpl_fltrcnt"><div><div class="zpl_fltclps fltopn"><div id="field_container" class="zpl_fltrlst"></div></div></div></div><div><button id="apl_filter" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="'+applyCallback+'">'+ZPI18N.getString("zp.apply")+'</button><button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="'+resetCallback+'">'+ZPI18N.getString("zp.reset")+"</button></div></div>"},noData:'<div id="deptNoData" class="zpl_crd zpl_nodata"> <div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div> <div class="zpl_emptimg zp_nd_nodata"></div> <h4>'+ZPI18N.getString("zp.nodatafound")+"</h4> <p></p> </div> </div> </div> </div>",kanbanViewContainer:function(divitionId,divitionName,count){return'<div id="wrap_'+divitionId+'" class="zpl_emptkban_lst"><div><div class="zpl_emptkban_hder"><h5>'+ZSEC.Encoder.encodeForHTML(divitionName)+"</h5><span>"+count+'</span></div><div id="bdy_'+divitionId+'" class="zpl_emptkban_bdy"></div></div></div>'},kanbanCards:function(EMPLOYEEPHOTO,EMPLOYEEID,EMPLOYEENAME,DESIGNATION,attStatus,erec,subAvlSts,ZUID){var element=$('<div class="zpl_dfcrd zpl_tmusrcrd"><div class="zpl_emcrdcnt"  tabindex="0" aria-label="'+ZSEC.Encoder.encodeForHTML(EMPLOYEEID)+" "+ZSEC.Encoder.encodeForHTML(EMPLOYEENAME)+'"><div class="zpl_em"><div class="zpl_emimg"><img src="'+EMPLOYEEPHOTO+'">'+(ZUID?'<span cstus="true" uid="'+ZUID+'"></span>':"")+'</div><div class="zpl_emdts zpl_ellipsis" style=""><div>'+ZSEC.Encoder.encodeForHTML(EMPLOYEEID)+' - <b title="'+ZSEC.Encoder.encodeForHTML(EMPLOYEENAME)+'">'+ZSEC.Encoder.encodeForHTML(EMPLOYEENAME)+"</b></div><div><em>"+DESIGNATION+'</em></div><div class="zpl_flex-a-c">'+attStatus+'</div></div><div class="MLauto d-flexclm4 zpl_hvr zpl_hvrsw" name="buttons"></div></div></div></div></div>');return"true"==ZPeople.ISCHAT&&ZUID&&element.find("[name=buttons]").append('<i title="'+ZPI18N.getString("zp.chatandcall")+'" uid="'+ZUID+'" chat_comm="true" class="PI_pharw" aria-label="'+ZPI18N.getString("zp.options")+":"+ZPI18N.getString("zp.chatsettings.chat")+", "+ZPI18N.getString("zp.chatsettings.audiocall")+","+ZPI18N.getString("zp.chatsettings.videocall")+'" tabindex="0" aria-haspopup="true" role="button"></i>'),subAvlSts&&1!=ZPeople.Team.Filter.viewMode[ZPeople.Team.reporteePageMode]&&!ZPeople.Team.currReporteePageConf.skipTraversal&&element.find("[name=buttons]").append(ZPeople.Team.Components.subFilterIcn(EMPLOYEEPHOTO,erec,EMPLOYEENAME,EMPLOYEEID)),element},userFilter:function(img,erecno,name,empId,isDummy){var filter=$('<div class="subFilterIcn" userId="'+erecno+'"><span tabindex="0" aria-label="'+empId+" "+name+'" class="zpl_em '+(isDummy?"CPD":"")+'"><div class="zpl_emimg"><img class="zpl_emimg" src="'+img+'"></div><div class="zpl_emdts zpl_ellipsis '+(isDummy?"DNI":"")+'"><div>'+empId+" - <b>"+name+"</b></div></div></span></div>");return isDummy||filter.on("click",function(){erecno!=ZPeople.Team.erecno[ZPeople.Team.reporteePageMode]&&(ZPeople.Team.pageLayout.find("[userId="+erecno+"]").nextAll(".subFilterIcn").remove(),$(this).find(".zpl_emdts.zpl_ellipsis").removeClass("DNI"),ZPeople.Team.Reportee.getSubordinate(erecno))}),filter},subFilterIcn:function(img,erecno,name,empID){return $('<i class="PI_subordinates" role="button" aria-label="'+ZPI18N.getString("zp.subordinate")+'" tabindex="0" title="'+ZPI18N.getString("zp.subordinate")+'"></i>').on("click",function(){ZPeople.Team.Reportee.getSubordinate(erecno,img,name,empID)})}},ZPeople.TeamSpace={isInit:!1,teamWidgetConf:[{widid:"TEAMMATES_ONLEAVE",callback:()=>TAMSUtil.UserSpace.Leave.createTeamMateLeaveCard,param:{type:"icon",mode:"TEAMMATES_ONLEAVE",header:ZPI18N.getString("zp.teammateonleavewid")},position:"right"},{widid:"DEP_RECENT_IN",callback:()=>UserWidget.cardsView.createCard,param:{type:"list",mode:"DEP_RECENT_IN",header:ZPI18N.getString("zp.widget.recently_checkin")},position:"right",isStatic:!0,widgetId:"depRecentIN"},{widid:"DEP_WORK_ANN",callback:()=>UserWidget.cardsView.createCard,param:{type:"icon",mode:"DEP_WORK_ANN",header:ZPI18N.getString("zp.widget.work_anniversary")},position:"right",loadFile:[],isStatic:!0},{widid:"DEP_NEW_HIRES",callback:()=>UserWidget.cardsView.createCard,param:{type:"list",mode:"DEP_NEW_HIRES",header:ZPI18N.getString("zp.widget.newhires")},position:"right",isStatic:!0},{widid:"DEPT_MEMB_BDAY_BUDDIES",callback:()=>UserWidget.cardsView.createCard,param:{type:"list",mode:"DEPT_MEMB_BDAY_BUDDIES",header:ZPI18N.getString("zp.BirthdayBuddy")},position:"right",isStatic:!0},{widid:"DEPT_FILES",loadFile:["fileshome.min.js"],callback:()=>FilesHome.FilesTeamDeptTab.loadFiles,param:{mode:"DEPT_FILES"},position:"right",isStatic:!0},{widid:"LMS_COURSE_CARD",loadFile:["lmsWidget.min.js"],callback:()=>lmsWidget.course.createCard,param:{mode:"widget"},position:"right",isStatic:!1}],WidgetHideConf:{DEP_WORK_ANN:!0,DEP_NEW_HIRES:!0,DEPT_MEMB_BDAY_BUDDIES:!0,DEPT_FILES:!0},pageConf:{messages:{initallback:()=>ZPFeeds.initPageComponents,callback:()=>ZPFeeds.get,fireScrollCallback:()=>ZPFeeds.getMoreFeeds},group:{initallback:()=>ZPFeeds.initPageComponents,callback:()=>ZPFeeds.get,fireScrollCallback:()=>ZPFeeds.getMoreFeeds},surveys:{callback:()=>ZDOMEEAPI.api.teamSpaceCardCallback}},STATUSLIST:[ZPI18N.getString("zp.officein"),ZPI18N.getString("zp.remotein"),ZPI18N.getString("zp.in"),ZPI18N.getString("zp.defprestat"),ZPI18N.getString("zp.yetToCheckIn"),ZPI18N.getString("zp.out"),ZPI18N.getString("zp.break"),ZPI18N.getString("zp.onduty"),"",ZPI18N.getString("zp.weekend"),ZPI18N.getString("zp.statwknd"),ZPI18N.getString("zp.nonstatwknd"),""],colourCLass:["pfsbgbdr_onln","pfsbgbdr_onln","pfsbgbdr_onln","pfsbgbdr_onln","pfsbgbdr_out","pfsbgbdr_out","pfsbgbdr_out","pfsbgbdr_onduty","pfsbgbdr_lv","pfsbgbdr_wkend","pfsbgbdr_wkend","pfsbgbdr_wkend","pfsbgbdr_hlday"],show:()=>{if(ZPeople.TeamSpace.isInit)TAMSUtil.UserSpace.Attendance.updateAttTeamSpaceCards(!0);else{Layout.Page.container.html('<div class="zpl_Emptydata">'+ZPeople.LOADING_HTML+"</div>");let param={},pageObj={pageId:"dep_space"};param.tltab='{"submode":"dep-space"}',param.mode="DEPSPACE",ZPeople.Request.send("/teamspaceAction.zp",param,function(response,param,layout){let depData=response.depdata,container=ZPeople.TeamSpace.spaceWrap(response.tltabs);if(response.isWorkAnnAllowed&&(ZPeople.TeamSpace.WidgetHideConf.DEP_WORK_ANN=!1),response.isNJAllowed&&(ZPeople.TeamSpace.WidgetHideConf.DEP_NEW_HIRES=!1),response.isBdayAllowed&&(ZPeople.TeamSpace.WidgetHideConf.DEPT_MEMB_BDAY_BUDDIES=!1),ZPeople.TeamSpace.WidgetHideConf.DEPT_FILES=!1,layout.html(container),ZPeople.TeamSpace.Page=layout,container.find("section .zpl_myprofcnt").prepend(ZPeople.TeamSpace.tab(pageObj.pageId,response.tltabs)),depData&&depData.isFound){let depInfo=$('<div class="zpl_myprof-bsinfo" tabindex="0" aria-label="'+ZPI18N.getString("zp.deptname")+" - "+ZSEC.Encoder.encodeForHTML(depData.depname)+'"></div>');container.find(".zpl_mspace_wrap").prepend(depInfo);let depIcon=ZPeople.TeamSpace.getDepIcon(depData.depname),depCard=ZPeople.TeamSpace.depInfo(depIcon,depData.depname,depData.depmail);if(depInfo.append(depCard),ZPeople.TeamSpace.STATUSLIST[12]=holiday_disName===ZPI18N.getString("zp.holidays")?ZPI18N.getString("zp.holiday"):holiday_disName,ZPeople.TeamSpace.STATUSLIST[8]=response.formname,ZPeople.TeamSpace.STATUSLIST[0]=response.officeINdName?response.officeINdName:ZPeople.TeamSpace.STATUSLIST[0],ZPeople.TeamSpace.STATUSLIST[1]=response.remoteINdName?response.remoteINdName:ZPeople.TeamSpace.STATUSLIST[1],response.teamCount){var teamAvailHeadhtml="";response.showSubordinateStatus?teamAvailHeadhtml='<span id="statusCountFilter" onclick="TAMSUtil.UserSpace.Attendance.showHideStatusFilter()"><h5><a class="d-inle-flex zpl_drpdwn-js">'+ZPI18N.getString("zp.teamavail")+"</a></h5></span>":teamAvailHeadhtml+='<span id="statusCountFilter" class="zpl_msp-title"><h5>'+ZPI18N.getString("zp.teamavail")+"</h5></span>";let card=$('<div class="zpl_msplst" tabindex="0" id="teamAvailability"><div class="zpl_msp-crdlst">'+teamAvailHeadhtml+'<div class="zpl_msp-crdcnt"><div field="statusCountList" class="zpl_msp-lstview zpl_tmloclst" tabindex="0"></div></div></div></div>'),cardcont=card.find('[field="statusCountList"]');if(response.showSubordinateStatus){var html='<div id="statusCountFilterOptions" class="zpl_drpdwn zmenu zmenu--iconwithtext"><ul>';html+='<li data-action="TAMSUtil.UserSpace.Attendance.getTeamMembersCount"><span class="zmenu__text">'+ZPI18N.getString("zp.teamavail")+"</span></li>",html+='<li data-action="TAMSUtil.UserSpace.Attendance.getDirectReporteesCount"><span class="zmenu__text">'+ZPI18N.getString("zp.drepavail")+"</span></li>",html+='<li data-action="TAMSUtil.UserSpace.Attendance.getAllReporteesCount"><span class="zmenu__text">'+ZPI18N.getString("zp.arepavail")+"</span></li>",html+="</ul></div>",layout.append(html),ZPeopleComponents.menu("#statusCountFilterOptions",{forElement:"#statusCountFilter",contentType:"text",appendTo:layout})}ZPeople.TeamSpace.STATUSLIST.forEach(function(currStat,index){let currStatData=response.teamCount[ZSEC.Encoder.encodeForHTML(currStat)];void 0!==currStatData&&cardcont.append(ZPeople.TeamSpace.createTeamCountTag(currStat,currStatData,ZPeople.TeamSpace.colourCLass[index],index))}),depInfo.append(card),card.find('[type="team_count"]').on("click",function(){ZPeople.TeamSpace.showUserList({header:ZSEC.Encoder.encodeForHTML($(this).attr("header")),status:ZSEC.Encoder.encodeForHTML($(this).attr("header")),mode:"GETUSERLISTBYSTATUS"})})}if(response.locDetails){let teamcountcard=$('<div class="zpl_mspteams" tabindex="0" aria-label="'+ZPI18N.getString("zp.teamstrength")+" "+response.locDetails.total+'"><div><label>'+ZPI18N.getString("zp.teamstrength")+'</label><div><a class="member_cnt"><b>'+response.locDetails.total+"</b></a></div></div></div>");teamcountcard.find(".member_cnt").on("click",function(){ZPeople.TeamSpace.showUserList({header:ZPI18N.getString("zp.common.teammembers"),location:"ALL"})});let card=$('<div class="zpl_msplst"><div class="zpl_msp-crdlst"><h5>'+ZPI18N.getString("zp.locationdiversity")+'</h5><div class="zpl_msp-crdcnt"><div field="locList" class="zpl_msp-lstview zpl_tmloclst" tabindex="0"></div></div></div></div>'),cardcont=card.find('[field="locList"]');$.each(response.locDetails.countList,function(index,data){cardcont.append(ZPeople.TeamSpace.createLocationTag(data.label,data.count,data.locid))}),depCard.append(teamcountcard),depInfo.append(card),card.find('[type="loc_count"]').on("click",function(){ZPeople.TeamSpace.showUserList({header:ZSEC.Encoder.encodeForHTML($(this).attr("header")),location:$(this).attr("loc")})})}response.streamDetails&&response.streamDetails.isEnabled&&ZPeople.TeamSpace.LeftSideCards.construct(depInfo,response.streamDetails,"stream",ZPI18N.getString("zp.streams"),"GETUSERLISTBYSTREAM",{id:"id",label:"label",count:"count"}),ZPeople.TeamSpace.creatCards(),FilesHome.FilesTeamDeptTab.loadFiles()}ZPeople.TeamSpace.selectTab()},Layout.Page.container),ZPeople.TeamSpace.isInit=!0}ZPeople.TeamSpace.selectTab()},LeftSideCards:{tag:(name,count,id)=>'<div elem="tagDiv"><label tabindex="0" title="'+ZSEC.Encoder.encodeForHTML(name)+'" elem="tagLabel">'+ZSEC.Encoder.encodeForHTML(name)+'</label><a><b elem="tagCount" tagId="'+id+'">'+count+"</b></a></div>",construct:(container,details,containerId,header,listMode,paramkeys)=>{if(details&&details.total>0){let card=$('<div id="sideCard'+containerId+'" class="zpl_msplst"><div class="zpl_msp-crdlst"><h5>'+header+'</h5><div class="zpl_msp-crdcnt"><div field="'+containerId+'List" class="zpl_msp-lstview zpl_tmloclst" tabindex="0"></div></div></div></div>'),cont=card.find('[field="'+containerId+'List"]');$.each(details.countList,function(index,data){cont.append(ZPeople.TeamSpace.LeftSideCards.tag(data[paramkeys.label],data[paramkeys.count],data[paramkeys.id]))}),container.append(card),card.find('[elem="tagCount"]').on("click",function(){let labelName=$(this).parents("[elem=tagDiv]").find("[elem=tagLabel]").text(),id=$(this).attr("tagId"),dts={labelName:ZSEC.Encoder.encodeForHTML(labelName)};id&&"0"!=id&&"null"!=id&&(dts.id=id),ZPeople.TeamSpace.LeftSideCards.showUsers(dts,containerId,listMode)})}},showUsers:(dtls,id,mode)=>{let param={mode:mode},extdtls={};dtls.id&&(param[id]=dtls.id);let modal=UserWidget.Components.userListModel(dtls.labelName,dtls.id+"_pop",!0,ZPeople.TeamSpace.LeftSideCards.searchUser,extdtls);Layout.Page.pageContWrapper.append(modal),extdtls.param=param,extdtls.container=modal.find("tbody"),extdtls.mode=dtls.id,extdtls.reqParamName=id,ZPeople.FireScroll.init(ZPeople.TeamSpace.LeftSideCards.getUsersList,dtls.id+"_pop",extdtls),ZPeople.TeamSpace.LeftSideCards.getUsersList(extdtls)},searchUser:(model,params,searchStr)=>{let prevSearchStr=params.param.searchStr;if(ZPUtil.Validation.isEmpty(searchStr)?delete params.param.searchStr:params.param.searchStr=searchStr,void 0!=prevSearchStr&&prevSearchStr!=params.param.searchStr||params.param.searchStr&&void 0==prevSearchStr&&params.param.searchStr.length>1){let container=$(params.container);container.empty(),container.removeAttr("start"),ZPeople.TeamSpace.LeftSideCards.getUsersList(params,!0)}},getUsersList:(dtls,isSearch)=>{let params={};dtls.param&&(params={...dtls.param});let start=$(dtls.container).attr("start");start?(params.start=start,dtls.container.append('<div class="zpl_Emptydata loader">'+ZPeople.LOADING_HTML+"</div>")):dtls.container.append('<div class="loader zpl_crd zpl_nodata"><div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div><div class="zpl_emptimg ">'+ZPeople.LOADING_HTML+"</div> </div> </div> </div></div>"),ZPeople.Request.send("/commonAction.zp",params,function(response,param){dtls.container.find(".loader").remove(),$(dtls.container).attr("start",response.nxtsrt),isSearch&&dtls.container.empty(),response.more&&(ZPeople.FireScroll.getFireScrollPropertie(params[dtls.reqParamName]?params[dtls.reqParamName]:"null").triggered=!1),void 0!=params.start||void 0!=response.userList&&0!=response.userList.length||dtls.container.append('<div class="zpl_crd zpl_nodata"><div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div><div class="zpl_emptimg zp_nd_cases"></div><p>'+ZPI18N.getString("zp.nosearchemployeefound")+"</p> </div> </div> </div></div>"),response.userList&&response.userList.forEach(function(data){dtls.container.append(UserWidget.Components.userListRow(data,ZPeople.getUserPage,data.eno))})})}},spaceWrap:tabs=>$('<div class="zpl_container ovh"><div class="zpl_mspace_out zpl_mspace-fulwid zpl_tspace" tabindex="0" aria-label="'+ZPI18N.getString("zp.wcag.teamspacetitle")+'"> <div id="dep_space" tabindex="0" aria-label="'+ZPI18N.getString("zp.wcag.teamspacepage")+'" class="zpl_myprofhd"><div class="zpl_myprofhd-acts"></div></div><div class="zpl_mspace_wrap"><section class="mspace_cntwrap"><div class="zpl_myprofcnt"><div id="dep_space_contentWrap" class="zpl_tabcnt" scroll="enabled"></div></div></section></div></div></div>'),tab:(pageId,tabObj)=>{let tabElement=$('<div class="mspace_actband"><div id="'+pageId+'_usertabcontainer" class="nav_container"><ul id="tlvlTab" class="zpl_tabpane"></ul></div></div>'),ul=tabElement.find("ul#tlvlTab"),groupTabs=ZPeople.TeamSpace.Page.find("#dep_space_contentWrap #groupTbs");return tabObj.forEach(function(tabObj){let tab=$('<li tabId="'+tabObj.tabId+'" isTab="true" class=""><a '+(tabObj.tabURL?'taburl="'+tabObj.tabURL+'"':"")+">"+tabObj.tabName+"</a></li>");tab.on("click",function(){tabObj.tabURL&&(window.location.hash=tabObj.tabURL)}),tabObj.isGroup&&(tab.attr("isGroup",!0),0==groupTabs.length&&(groupTabs=$('<div id="groupTbs"></div>'),ZPeople.TeamSpace.Page.find("#dep_space_contentWrap").prepend(groupTabs)),groupTabs.append(ZPeople.TeamSpace.getGroupTab(tabObj))),ul.append(tab)}),tabElement},getGroupTab:groupTab=>{let fieldId=groupTab.tabId+"_optn",wrap=$('<div id="'+groupTab.tabId+'_groupTb" class="zpl_btnmnu"><div><select id="'+fieldId+'"></select><div class="zpl_selchklstall" id="EditGroup"></div></div><div class="zpl_rgt" id="group_details"></div></div>'),filesDatas={dataMapping:{label:"tabName",text:"tabName",value:"tabURL",id:"tabId"},dropdownList:{width:"fit-content"},change:ZPeople.TeamSpace.changeGroup,showSearchField:!0,search:{delay:200}};"true"==ZPeople.isDepartmentLead&&(groupTab.tabArray.push({separator:!0}),groupTab.tabArray.push({id:"add_newGroup",isFooter:!0,innerHTML:'<button onclick="Group.addGroup()" class="zlabel zlabel--outline zlabel--small zpl_btncnt">'+ZPI18N.getString("zp.addgroup")+"</button>"}));var selectComponent=ZPeopleComponents.select(wrap.find("#"+fieldId),filesDatas);return selectComponent.removeAllOptions(),groupTab.tabArray&&groupTab.tabArray.length>0&&selectComponent.addOption(groupTab.tabArray),wrap},depInfo:(icon,depName,depMailId)=>{return $('<div><figure><div><div class="zpl_pichr"><span>'+icon+'</span></div></div><figcaption><div class="zpl_em"><div class="zpl_emdts"><div class="CP" title="'+ZSEC.Encoder.encodeForHTMLAttribute(depName)+'"><b>'+ZSEC.Encoder.encodeForHTML(depName)+"</b></div><div><a "+(depMailId?'href="mailto:'+ZSEC.Encoder.encodeForHTMLAttribute(depMailId)+'" title="'+ZSEC.Encoder.encodeForHTMLAttribute(depMailId)+'"':"")+">"+(depMailId?ZSEC.Encoder.encodeForHTML(depMailId):"")+"</a></div></div></div></figcaption></figure></div>")},createLocationTag:(locName,count,locId)=>'<div><label tabindex="0">'+ZSEC.Encoder.encodeForHTML(locName)+'</label><a><b type="loc_count" header="'+ZSEC.Encoder.encodeForHTMLAttribute(locName)+'" loc="'+locId+'">'+count+"</b></a></div>",createTeamCountTag:(statusDname,count,clrclass,index)=>'<div id="attStatus_'+index+'"><label class= "pfsbdr_onlylft '+clrclass+'">'+ZSEC.Encoder.encodeForHTML(statusDname)+'</label><a><b type="team_count" header="'+ZSEC.Encoder.encodeForHTMLAttribute(statusDname)+'" statusindex="'+index+'">'+count+"</b></a></div>",getDepIcon:depName=>{let splitedName=depName.split(" "),icnLetter=splitedName[0][0].toUpperCase();return splitedName[1]&&(icnLetter+=splitedName[1][0].toUpperCase()),icnLetter},selectTab:()=>{let tab;if(!ZPeople.TeamSpace.Page)return;var tabUl=ZPeople.TeamSpace.Page.find("#tlvlTab");if(tabUl.find(".zpl_act").removeClass("zpl_act"),tabUl.find("[taburl]").each(function(idx){-1!=window.location.hash.indexOf($(this).attr("taburl").split(":")[0])&&(tab=$(this).parents("li"))}),void 0==tab)return void $("#zp-tlevel-home-team").children().eq(0).find("a").click();$(tab).addClass("zpl_act");let isGroup=tab.attr("isGroup"),tabid=tab.attr("tabId");if("true"==isGroup){isGroup=!0;let zcomp=ZPeopleComponents.select($("#"+tabid+"_optn"));zcomp&&(zcomp.setValue(window.location.hash.slice(1)),tabid=zcomp.getOptions()[zcomp.selectedIndex].tabId)}ZPeople.TeamSpace.changeView(tabid,isGroup),TAMSUtil.UserSpace.Attendance.setAttTeamUpdateInterval=setInterval(TAMSUtil.UserSpace.Attendance.updateAttTeamSpaceCards,9e5),document.addEventListener("visibilitychange",TAMSUtil.UserSpace.Attendance.setTimeOutforTeamSpaceCards)},changeView:(tabId,isgroup)=>{if(!tabId)return;let pageConatiner=ZPeople.TeamSpace.Page.find("#dep_space_contentWrap"),conwrap=pageConatiner.find("#"+tabId),confId=tabId;ZPUtil.Validation.isEmpty(confId)||-1==confId.indexOf("group_")||(confId="group"),Layout.Page.container=conwrap,settingsPage.container=conwrap;let pageConf=ZPeople.TeamSpace.pageConf[confId];conwrap&&0!=conwrap.length||(conwrap=$('<div id="'+tabId+'"></div>'),pageConatiner.append(conwrap),conwrap.removeClass("DN").siblings().addClass("DN"),isgroup&&ZPeople.TeamSpace.Page.find("#dep_space_contentWrap #groupTbs").removeClass("DN"),Layout.Page.container=conwrap,settingsPage.container=conwrap,pageConf&&pageConf.initallback&&pageConf.initallback()(conwrap)),conwrap.removeClass("DN").siblings().addClass("DN"),isgroup&&ZPeople.TeamSpace.Page.find("#dep_space_contentWrap #groupTbs").removeClass("DN"),pageConf&&pageConf.callback&&("messages"==tabId?(ZPUtil.Validation.isEmpty(ZPeople.CURR_USER.deptId)&&conwrap.html('<div id="emptPage" class="zpl_crd zpl_nodata"> <div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div> <div class="zpl_emptimg zp_nd_deprtmnt"></div> <h4>'+ZPI18N.getString("ZP.departmentNotAssigned")+"</h4> <p></p> </div> </div> </div> </div>"),pageConf.callback()()):"#home/team/space-group"==window.location.hash?conwrap.html('<div id="emptPage" class="zpl_crd zpl_nodata"> <div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div> <div class="zpl_emptimg zp_nd_users"></div> <h4>'+ZPI18N.getString("zp.noassowithgrp")+"</h4> <p></p> </div> </div> </div> </div>"):pageConf.callback()(conwrap)),ZPeople.FireScroll.getFireScrollPropertie().triggered=!0,pageConf&&pageConf.fireScrollCallback&&(ZPeople.FireScroll.init(pageConf.fireScrollCallback()),ZPeople.FireScroll.getFireScrollPropertie().triggered=!1)},changeGroup:(event,data)=>{window.location.hash=data.value},creatCards:()=>{let rigthDiv=ZPeople.TeamSpace.Page.find("section aside.zpl_sidewrap"),leftDiv=ZPeople.TeamSpace.Page.find("div.zpl_myprof-bsinfo");ZPeople.TeamSpace.teamWidgetConf.forEach(function(data){if(!ZPeople.TeamSpace.WidgetHideConf[data.widid])if("right"==data.position&&data.callback){0==rigthDiv.length&&(rigthDiv=$('<aside class="zpl_sidewrap"></aside>'),ZPeople.TeamSpace.Page.find("section").append(rigthDiv));let widget=ZPeople.TeamSpace.createWidgetWrap(data.widgetId,data.isStatic);rigthDiv.append(widget),data.loadFile?Layout.PageUtil.loadFiles(data.loadFile,function(){data.callback()(widget,data.param)}):data.callback()(widget,data.param)}else if("left"==data.position&&data.callback){let widget=ZPeople.TeamSpace.createWidgetWrap(data.widgetId,data.isStatic);leftDiv.append(widget),data.loadFile?Layout.PageUtil.loadFiles(data.loadFile,function(){data.callback()(widget,data.param)}):data.callback()(widget,data.param)}})},infoCard:userObj=>{let info=$('<div class="zpl_em zpl_msprpthd"><div class="zpl_emimg"><img alt="" src="'+userObj.avatar+'"></div><div class="zpl_emdts"><div class="tooltip-js zpl_link" data-content-type="callout" title="'+userObj.name+'"><em>'+userObj.empid+" - </em><b>"+userObj.name+"</b></div><div><em>"+ZPI18N.getString("zp.dept")+"</em></div></div></div>");return info.find(".zpl_link").on("click",()=>{ZPeople.getUserPage(userObj.usererec)}),info},showUserList:dtls=>{let param={},extdtls={};"null"!=dtls.location&&(param.location=dtls.location),"null"!=dtls.status&&(param.status=dtls.status),param.mode="GETUSERLISTBYLOC",dtls.mode&&(param.mode=dtls.mode),dtls.header&&(param.header=dtls.header),"GETUSERLISTBYSTATUS"==param.mode&&void 0!=TAMSUtil.UserSpace.Attendance.dataSelect&&(param.dataSelect=TAMSUtil.UserSpace.Attendance.dataSelect);var dtsid=dtls.location?dtls.location:dtls.statusIndex;let model=UserWidget.Components.userListModel(dtls.header,dtsid+"_pop",!0,ZPeople.TeamSpace.searchUser,extdtls,!1,param.mode);Layout.Page.pageContWrapper.append(model),extdtls.param=param,extdtls.container="GETUSERLISTBYSTATUS"==param.mode?model.find("#listEmpByStatus"):model.find("tbody"),extdtls.mode=dtsid,"GETUSERLISTBYSTATUS"!=param.mode&&ZPeople.FireScroll.init(ZPeople.TeamSpace.getUserList,dtsid+"_pop",extdtls),ZPeople.TeamSpace.getUserList(extdtls)},searchUser:(model,params,searchStr)=>{let prevSearchStr=params.param.searchStr;if(ZPUtil.Validation.isEmpty(searchStr)?delete params.param.searchStr:params.param.searchStr=searchStr,void 0!=prevSearchStr&&prevSearchStr!=params.param.searchStr||params.param.searchStr&&void 0==prevSearchStr&&params.param.searchStr.length>1){let container=$(params.container);container.empty(),container.removeAttr("start"),ZPeople.TeamSpace.getUserList(params,!0)}},getUserList:(dtls,isSearch)=>{let params={};dtls.param&&(params={...dtls.param});let start=$(dtls.container).attr("start");start?(params.start=start,dtls.container.append('<div class="zpl_Emptydata loader">'+ZPeople.LOADING_HTML+"</div>")):dtls.container.append('<div class="loader zpl_nodata"><div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div><div class="zpl_emptimg ">'+ZPeople.LOADING_HTML+"</div> </div> </div> </div></div>"),ZPeople.Request.send("/commonAction.zp",params,function(response,param){if(dtls.container.find(".loader").remove(),$(dtls.container).attr("start",response.nxtsrt),isSearch&&dtls.container.empty(),response.more&&(ZPeople.FireScroll.getFireScrollPropertie(params.location?params.location:param.statusIndex?param.statusIndex:"null").triggered=!1),void 0!=params.start||(void 0!=response.userList&&0!=response.userList.length||"GETUSERLISTBYSTATUS"==params.mode)&&("GETUSERLISTBYSTATUS"!=params.mode||0!==Object.keys(response.userList).length||response.buildIngUserList&&0!==Object.keys(response.buildIngUserList).length)||dtls.container.append('<div class="zpl_crd zpl_nodata"><div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div><div class="zpl_emptimg zp_nd_cases"></div><p>'+ZPI18N.getString("zp.nosearchemployeefound")+"</p> </div> </div> </div></div>"),"GETUSERLISTBYSTATUS"==params.mode){var buildingHtml="";if(response.buildIngUserList){var buildingNames=Object.keys(response.buildIngUserList);buildingNames.length>0&&buildingNames.forEach(function(buildIng){buildingHtml+='<span class="d-flexC zpl_mv3"><b>'+buildIng+"</b></span>",buildingHtml+='<div class="zpl_tblres mdl_maxhgt" scroll="enabled"><table class="zpl_tbl wd100_per"><tbody>';var erecoNoList=response.buildIngUserList[buildIng];erecoNoList&&erecoNoList.forEach(function(employeeDetails){buildingHtml+=TAMSUtil.UserSpace.Attendance.userListRow(employeeDetails,ZPeople.getUserPage,employeeDetails.eno)[0].outerHTML}),buildingHtml+="</tbody></table></div>"})}if(response.userList)Object.keys(response.userList).length>0&&(buildingHtml+='<span class="d-flexC zpl_mv3"><b>'+param.header+"</b></span>",buildingHtml+='<div class="zpl_tblres mdl_maxhgt" scroll="enabled"><table class="zpl_tbl wd100_per"><tbody>',response.userList.forEach(function(employeeDetails){buildingHtml+=TAMSUtil.UserSpace.Attendance.userListRow(employeeDetails,ZPeople.getUserPage,employeeDetails.eno)[0].outerHTML}),buildingHtml+="</tbody></table></div>");dtls.container.append(buildingHtml)}else response.userList&&response.userList.forEach(function(data){dtls.container.append(UserWidget.Components.userListRow(data,ZPeople.getUserPage,data.eno))})})},createWidgetWrap:(widgetId,isStatic)=>{let widWrap=$(`<div tabindex="0" class="zpl_msplst ${isStatic?"":"zpl_DNI"}"><div divtype="container" class="zpl_msp-crdlst"></div></div>`);return ZPUtil.Validation.isEmpty(widgetId)||widWrap.attr("id",widgetId),widWrap}},ZPeople.Team_Department={isDepChanged:!1,page:void 0,fromSearch:!0,currentMode:void 0,init:function(deptId,erecno){ZPeople.Team_Department.currentMode=Layout.Page.currentmode,ZPeople.Team_Department.fromSearch="home/team/myteam"!=ZPeople.Team_Department.currentMode;var param={};param.erecno=erecno||ZPeople.CURR_USER.usererec,param.deptId=deptId||ZPeople.CURR_USER.deptId,ZPeople.Team_Department.page=Layout.Page.container;var wrap=ZPeople.Team_Department.page.find("#team_department");if(0==wrap.length){let locFilterId=param.erecno+"_"+ZPeople.Team_Department.currentMode.replaceAll("/","_");var selectid="depSel-"+(erecno?"s-"+erecno:"h-"+ZPeople.CURR_USER.usererec);wrap=$('<div class=" '+(deptId?"":"zpl_container")+'" id="team_department"><div class="zpl_iwrpr" tabindex="0" aria-label="'+ZPI18N.getString("zp.wcag.teamdepartmentpage")+'"><div class="zpl_iwrprrgt"><div class="zpl_act zpl_tblfxd zpl_tmdept"><div class="zpl_rgtcnt"><div class="zpl_dfcrd zpl_tmusrcrd DN" role="button" tabindex="0" id="depDetailsCard"><div class="zpl_emcrdcnt" id="depDetails"><div class="zpl_tmdeptlft"><div class="zpl_slct"><select data-width="250" class="zselectbox select-js" id="'+selectid+'"></select></div><div class="zpl_slct"><select data-width="250" class="zselectbox select-js" id="locfilter_'+locFilterId+'"></select></div></div><div class="zpl_em" id="depHeaddetails"><div class="zpl_emdts zpl_ellipsis"><div id="depHeadName"></div><div><em id="depHeadDes"></em></div></div></div><div><h6 id="deptCount"></h6><em>'+ZPI18N.getString("zp.members")+'</em></div></div></div><div class="zpl_emcrdlst zpl_tmember" tabindex="0" aria-label="'+ZPI18N.getString("zp.wcag.proceedingtolist",[ZPI18N.getString("zp.department")])+'" id="depList"></div></div></div></div></div></div>'),ZPeople.Team_Department.page.html(wrap),wrap.prepend("<div id='loadingWrap'>"+ZPeople.LOADING_HTML+"</div>"),param.isInit=!0,param.locNeeded=!0,param.location="ALL",ZPeople.Team_Department.isDepChanged=!0,ZPeople.Team_Department.getDepartment(param,selectid)}else param.refreshStatus=!0,param.deptId=wrap.find("#depDetails").attr("departmentId"),ZPeople.Team_Department.getDepartment(param)},getDepartment:function(param,selectid,location){var wrap=ZPeople.Team_Department.page.find("#team_department"),depList=ZPeople.Team_Department.page.find("#depList").addClass("DN");param.mode="DEPARTMENT_MEMBERS",location&&"null"!=location&&(param.location=location);let locFilterId=param.erecno+"_"+ZPeople.Team_Department.currentMode.replaceAll("/","_");ZPeople.Request.send("/commonAction.zp",param,function(resultData){if(ZPeople.Team_Department.isDepChanged&&resultData.success){let option=[];resultData.locDetails.countList.length>1&&option.push({label:ZPI18N.getString("zp.alllocaction"),locid:"ALL",count:resultData.locDetails.total});let fldOption={change:ZPeople.Team_Department.doFilter,dataMapping:{label:"label",text:"label",value:"locid",id:"locid",informativeText:"count"},dropdownList:{width:"fit-content"},showSearchField:!0,search:{delay:200}},locFltr=ZPeopleComponents.select(wrap.find("#locfilter_"+locFilterId),fldOption);option.push(...resultData.locDetails.countList),locFltr.removeAllOptions(),option.length>0?(locFltr.addOption(option),locFltr.setValue(option[0].locid),locFltr.setAttribute("disabled",!1)):locFltr.setAttribute("disabled",!0)}if(ZPeople.Team_Department.isDepChanged=!1,wrap.find("#loadingWrap").remove(),wrap.find("#depDetailsCard").removeClass("DN"),wrap.find("#deptNoData").remove(),depList.removeClass("DN"),resultData.success)if(resultData.departmentData){var json={},photo=void 0,eno="",name="",desName="",eid="";if(void 0!=resultData.departmentData.treeLen&&resultData.departmentData.treeLen>0){resultData.departmentData.treeLen;var teamHead=resultData.departmentData.teamHead;data=resultData.departmentData.tree[0],photo=data.photo,eno=data.eno,name=data.name,eid=data.eid,desName=data.desname,data.eno===teamHead&&(desName=ZPI18N.getString("zp.depthead"))}else if(resultData.departmentData.headDetails){var headObj=resultData.departmentData.headDetails;photo=headObj.photo,eno=headObj.eno,name=headObj.name,eid=headObj.eid,desName=ZPI18N.getString("zp.depthead")}var memcount=resultData.departmentData.teamData?resultData.departmentData.teamData.length:0,photoHtml=photo?'<div class="zpl_emimg"> <img src="'+photo+'" ></div>':"",headDetailHtml="<em>"+eid+"</em> - <b>"+name+"</b>";if(wrap.find("#depDetailsCard").attr("aria-label",`${name?`${ZPI18N.getString("zp.depthead")}:${name}.`:""} ${ZPI18N.getString("zp.totalmembers")}: ${memcount}`),wrap.find("#depDetails").attr("departmentId",param.deptId),wrap.find("#depHeaddetails").attr("usereid",eno),wrap.find("#depHeaddetails .zpl_emimg").remove(),wrap.find("#depHeaddetails").prepend(photoHtml),wrap.find("#depHeadName").html(headDetailHtml),wrap.find("#depHeadDes").html(desName),wrap.find("#deptCount").html(memcount),param.isInit){var prop={options:[],dataMapping:{label:"DEPARTMENTNAME",value:"DEPARTMENTID",optgroupLabel:"type",options:"options"},change:(event,data)=>{depList.empty(),depList.parent().append("<div id='loadingWrap'>"+ZPeople.LOADING_HTML+"</div>"),ZPeople.Team_Department.isDepChanged=!0,ZPeople.Team_Department.getDepartment({deptId:data.value,erecno:param.erecno,location:"ALL",locNeeded:!0})},selectedValue:param.deptId};resultData.departmentList.parentDepList&&prop.options.push({type:ZPI18N.getString("zp.parentdeptment"),options:resultData.departmentList.parentDepList}),prop.options.push({type:ZPI18N.getString("zp.mydeptment"),options:resultData.departmentList.myDeptList}),resultData.departmentList.subDeptList&&prop.options.push({type:ZPI18N.getString("zp.subdeptment"),options:resultData.departmentList.subDeptList}),ZPeopleComponents.select(wrap.find("#"+selectid),prop)}if(depList.empty(),resultData.departmentData.teamData){for(var cnt=(userList=resultData.departmentData.teamData).length,userCnt=0;userCnt<cnt;userCnt++){var userInfo=userList[userCnt],desiId=ZPUtil.Validation.isEmpty(userInfo.desid)?"empty":userInfo.desid,existJson=json[desiId];void 0===existJson&&((existJson={}).html="",existJson.count=0,existJson.totalCount=0,existJson.name=userInfo.desname,json[desiId]=existJson);var streamId=ZPUtil.Validation.isEmpty(userInfo.streamId)?"empty":userInfo.streamId,streamJson=json[desiId][streamId];void 0===streamJson&&((streamJson={}).html="",streamJson.count=0,streamJson.name=userInfo.stream,json[desiId][streamId]=streamJson);var attStatus="";if(resultData.departmentData.attStatus)attStatus=ZPeople.Team_Department.getAttendanceStatusHtml(resultData.departmentData.attStatus,userInfo.eno);var html='<div class="zpl_em" tabindex="0" aria-label="'+userInfo.eid+" "+userInfo.name+'" id="'+userInfo.eno+'" usereid="'+userInfo.eno+'"><div class="zpl_emimg"><img src="'+userInfo.photo+'"></div><div class="zpl_emdts zpl_ellipsis"><div><em>'+userInfo.eid+"</em> - <b>"+userInfo.name+"</b></div><div><em>"+(ZPUtil.Validation.isEmpty(userInfo.mobile)?(ZPUtil.Validation.isEmpty(userInfo.mobile)||ZPUtil.Validation.isEmpty(userInfo.mobile)?"":"|")+!ZPUtil.Validation.isEmpty(userInfo.mobile)?userInfo.mobile:"":userInfo.mobile)+'</em></div></div><div class="zpl_emchat">'+attStatus+'</div><div hvr="true" class="zpl_hvr">'+(userInfo.zuid!==_LOGGEDIN_ZUID&&"true"==ZPeople.ISCHAT?ZPUtil.getICONHtml("PI_pharw",void 0,["uid="+userInfo.zuid,'tabindex="0"','chat_comm="true"','title="'+ZPI18N.getString("zp.chatandcall")+'"','aria-label="'+ZPI18N.getString("zp.chatandcall")+'"','role="button"']):"")+"</div></div>";"empty"!==streamId?(streamJson.html+=html,streamJson.count++):(existJson.html+=html,existJson.count++),existJson.totalCount++}for(var desId in json){var appObj=json[desId];if(null!==appObj){html='<div class="zpl_dfcrd" tabindex="0"><div class="zpl_tmtitle"><h5>'+(ZPUtil.Validation.isEmpty(appObj.name)?ZPI18N.getString("zp.untitled"):appObj.name)+'</h5><div class="zpl_tg"><span><b>'+appObj.totalCount+'</b></span></div></div><div class="zpl_emlst">  ';if(appObj.totalCount===appObj.count)html+=appObj.html;else{for(var streamObj=void 0,sortedKeys=Object.keys(appObj).sort(),index=0;index<sortedKeys.length;index++)void 0!==(streamObj=appObj[sortedKeys[index]])&&null!==streamObj&&"object"==typeof streamObj&&(ZPUtil.Validation.isEmpty(streamObj.name)||(html+='<div class="zpl_tmsubtitle"><h6>'+streamObj.name+'</h6><div class="zpl_tg"><span><b>'+streamObj.count+"</b></span></div></div>",html+=streamObj.html));""!==appObj.html&&(html+='<div class="zpl_tmsubtitle"><h6> - </h6><div class="zpl_tg"><span><b>'+appObj.count+"</b></span></div></div>",html+=appObj.html)}depList.append(html+"</div></div>")}}wrap.find("[usereid]").on("click",function(event){event.target.hasAttribute("ischat")?event.stopPropagation():ZPeople.getUserPage(this.getAttribute("usereid"))})}else depList.after('<div id="deptNoData" class="zpl_crd zpl_nodata"> <div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div> <div class="zpl_emptimg zp_nd_nodata"></div> <h4>'+ZPI18N.getString("zp.nodatafound")+"</h4> <p></p> </div> </div> </div> </div>")}else{var userList=wrap.find("[usereid]");resultData.refreshData.attStatus&&$.each(userList,function(i,user){var userEle=$(user),eid=userEle.attr("usereid"),attStatus=ZPeople.Team_Department.getAttendanceStatusHtml(resultData.refreshData.attStatus,eid);userEle.find(".zpl_emchat").html(attStatus)})}else ZPUtil.Validation.isEmpty(ZPeople.CURR_USER.deptId)&&(wrap.find("#depDetailsCard").addClass("DNI"),depList.after('<div id="deptNoData" class="zpl_crd zpl_nodata"> <div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div> <div class="zpl_emptimg zp_nd_nodata"></div> <h4>'+ZPI18N.getString("zp.nodatafound")+"</h4> <p></p> </div> </div> </div> </div>"))})},doFilter:(event,data)=>{if(ZPUtil.Validation.isEmpty(data.value)||ZPeople.Team_Department.isDepChanged)return;var depList=ZPeople.Team_Department.page.find("#depList").addClass("DN");let depId=ZPeople.Team_Department.page.find("#depDetails").attr("departmentid");depList.empty(),depList.parent().append("<div id='loadingWrap'>"+ZPeople.LOADING_HTML+"</div>"),ZPeople.Team_Department.getDepartment({deptId:depId,erecno:ZPeople.Team_Department.fromSearch?ZPUserProfile.info.getUserId():ZPeople.CURR_USER.usererec},void 0,data.value)},getAttendanceStatusHtml:function(obj,erec){var attStatus="",leaveAttStat=obj[erec+"_curStat"];if(leaveAttStat){leaveAttStat=ZPeople.decodeTxt(leaveAttStat);var colourClass=Attendance.setClassToShowStatus(obj[erec+"_colourCode"]);Attendance.isLeaveAvail(obj[erec+"_colourCode"])&&(leaveAttStat=obj[erec+"_curStat"]),attStatus='<span class="'+colourClass+' zpl_ellipsis">'+leaveAttStat+"</span>"}return attStatus}};class NavBar{constructor(){this.tabArray=null,this.navbarDiv=null,this.contentDiv=null,this.callBack=null,this.activeTabId=null,this.tabOptions=null,this.moreTabOptions=null,this.isTabConstructed=!1}init(isFromUpdateArray){this.renderNavBar(),this.isTabConstructed=!0;let tabObj=this.getTabObjBasedOnHash();this.toggleTab(tabObj,isFromUpdateArray,!0)}handleTabs(tabArray,navWrapId,contentDiv,callBack,tabOptions,moreTabOptions){if(this.isTabConstructed){let tabObj=this.getTabObjBasedOnHash();this.toggleTab(tabObj)}else{if(!tabArray||0==tabArray.length)return;this.tabArray=tabArray,this.navbarDiv=document.getElementById(navWrapId),this.contentDiv=document.getElementById(contentDiv),this.callBack=callBack,this.activeTabId=null,this.tabOptions=tabOptions,this.moreTabOptions=moreTabOptions,this.init()}}renderNavBar(){this.tabArray.forEach(tabObj=>{const listItem=document.createElement("li");var idsplit;if(null!=this.tabOptions&&null!=this.tabOptions.itemClass&&listItem.classList.add(this.tabOptions.itemClass),idsplit=-1!=tabObj.tabURL.indexOf(":")?(idsplit=tabObj.tabURL.split(":")[0]).replace(/\/|-/g,"_"):tabObj.tabURL.replace(/\/|-/g,"_"),tabObj._tabId=idsplit,tabObj.isHidden)return;listItem.dataset.tabId=tabObj._tabId,listItem.setAttribute("id",tabObj._tabId);const listHash=document.createElement("a");listHash.textContent=tabObj.tabName,listHash.setAttribute("href","#"+tabObj.tabURL),listItem.appendChild(listHash),this.navbarDiv.querySelector("ul").appendChild(listItem)})}updateTabArray(tabArray){this.tabArray=[],this.tabArray=tabArray,this.isTabConstructed=!1,this.navbarDiv.querySelector("ul").innerHTML="",this.init(!0)}toggleTab(tabObj,isFromUpdateArray,fromInit){let isInit=!1;if(tabObj.isHidden)return this.contentDiv.querySelector("#"+tabObj.contentDivId)&&(this.contentDiv.querySelector("#"+tabObj.contentDivId).remove(),delete tabObj.contentDivId),tabObj=this.tabArray[0],void(window.location.hash=tabObj.tabURL);"contentDivId"in tabObj||(this.createContentDiv(tabObj),isInit=!0),this.activeTabId=tabObj._tabId,this.navbarDiv.querySelector("ul").querySelectorAll("li").forEach(item=>{const id=item.dataset.tabId;var tab=this.getTabObjectForId(id);if(null==tab||!tab.hasOwnProperty("contentDivId"))return;const contentDiv=document.getElementById(tab.contentDivId),tglClass=null!=this.tabOptions&&null!=this.tabOptions.toggleClass?this.tabOptions.toggleClass:"active";id===tabObj._tabId?(item.classList.add(tglClass),contentDiv.classList.remove("DN")):(item.classList.remove(tglClass),contentDiv.classList.add("DN"))}),fromInit&&null!=this.moreTabOptions&&this.moreTabs(),isFromUpdateArray||this.callBack(tabObj,isInit)}createContentDiv(tabObj){const tabContentDiv=document.createElement("div");tabContentDiv.id=`${tabObj._tabId}${-1!=tabObj.tabURL.indexOf("-")?"_"+ZPeople.getUserId():""}-contentWrp`,tabContentDiv.classList.add("DN"),this.contentDiv.appendChild(tabContentDiv),tabObj.contentDivId=tabContentDiv.id}getTabObjBasedOnHash(){const hash=window.location.hash.slice(1),tabObj=this.tabArray.find(tabObj=>-1!=hash.indexOf(tabObj.tabURL));return null!=tabObj?tabObj:this.tabArray[0]}moreTabs(){this.navbarDiv.querySelector("ul").setAttribute("resize-id",this.moreTabOptions.id),ZPNewTabs.registerResize(this.moreTabOptions.id,this.moreTabOptions.parentEle,this.moreTabOptions.activeClass,this.moreTabOptions.gap,this.moreTabOptions.nextId,this.moreTabOptions.callback)}getTabObjectForId(id){return this.tabArray.find(tabObj=>tabObj._tabId==id)}hashChangeCallback(){null!=this.moreTabOptions&&ZPeopleComponents.menu(document.getElementById(this.moreTabOptions.id+"-more"))&&ZPeopleComponents.menu(document.getElementById(this.moreTabOptions.id+"-more")).hide()}}ZPNavBar={instances:{},getInstance:function(instanceId){return null!=ZPNavBar.instances[instanceId]?ZPNavBar.instances[instanceId]:(ZPNavBar.instances[instanceId]=new NavBar,ZPNavBar.instances[instanceId])}},ZPUsers={pageMode:"",parentContainer:"",initUsersPage:function(ele){var key;ZPUsers.parentContainer=ele||Layout.Page.container.append('<div class="zpl_container"></div>').find(".zpl_container"),ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").removeClass(".zpl_mdltmvw"),ZPUsers.parentContainer.attr("loaded","true"),ZPUsers.parentContainer.html('<div class="zpl_iwrpr"><div class="zpl_iwrprrgt"><div class="zpl_act zpl_tblfxd" scroll="enabled" id="zpuser_hdr_wrp"><div class="zpl_rgtcnt" id="zpuser_cnt_wrpr"></div></div></div></div>'),Layout.Page.currentmode===ZPNewTabs.URL.getUrl("organization/birthdayfolks")?(key="BIRTHDAY_BUDDIES",ZPUsers.parentContainer.find(".zpl_iwrpr").attr({tabindex:"0","aria-label":ZPI18N.getString("zp.wcag.birthdayfolkstitle")})):Layout.Page.currentmode===ZPNewTabs.URL.getUrl("organization/newhires")?(key="NEW_HIRES",ZPUsers.parentContainer.find(".zpl_iwrpr").attr({tabindex:"0","aria-label":ZPI18N.getString("zp.wcag.newhirestitle")})):"home/team/circles"===Layout.Page.currentmode&&(key="FAVORITES"),ZPUsers.setHeader(key)},showMoreList:function(){if(5!==ZPUsers.Bday.CURRVIEWTYPE){ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").removeAttr("more");var start=ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").attr("start");ZPUsers.getUsersList(start,!0)}},setHeader:function(key){var topMenuHTML;"BIRTHDAY_BUDDIES"===key&&(topMenuHTML=ZPUsers.searchBarComponent()+'<div class="zpl_idiv" tabindex="0" aria-haspopup="true" aria-expanded="false" aria-label="'+ZPI18N.getString("zp.wcag.optionwithcount",[4])+":"+ZPI18N.getString("zp.today")+","+ZPI18N.getString("zp.thismonth")+","+ZPI18N.getString("zp.favorites")+","+ZPI18N.getString("zp.mydepartment")+'"><select class="select-js" id="brDayFolksDropdown"></select> </div> <div class="zpl_cntrdv" id="date_navigator" tabindex="0"></div> <div class="zpl_rgt"><i class="zpl_ibg PI_lens" tabindex="0" role="button" aria-label="Search" onclick="ZPUsers.toggleSearchBar(this)"></i></div>',ZPUsers.parentContainer.find("#zpuser_hdr_wrp").prepend('<div class="zpl_btnmnu">'+topMenuHTML+"</div>"),ZPUsers.addDrpDwn("#brDayFolksDropdown",[ZPI18N.getString("zp.today"),ZPI18N.getString("zp.thismonth"),ZPI18N.getString("zp.favorites"),ZPI18N.getString("zp.mydepartment")]))},addDrpDwn:function(id,items){var options={className:"zdropdownlist__item",optionclick:ZPUsers.drpDownCallback,options:items.map((value,index)=>({label:value}))};ZPeopleComponents.select(document.querySelector(id),options)},drpDownCallback:function(event){switch(event.detail.optionData.label){case ZPI18N.getString("zp.today"):ZPUsers.Bday.todaysBdayFolksView();break;case ZPI18N.getString("zp.thismonth"):ZPUsers.Bday.monthBdayFolksView();break;case ZPI18N.getString("zp.favorites"):ZPUsers.Bday.myFavBdayFolksView();break;case ZPI18N.getString("zp.mydepartment"):ZPUsers.Bday.myDeptBdayFolksView()}},getUsersList:function(start,more,ele){var key;ZPUsers.parentContainer=ele||Layout.Page.container;var params={};Layout.Page.currentmode===ZPNewTabs.URL.getUrl("organization/birthdayfolks")?(key=ZPUsers.Bday.getCurrentView(),5===ZPUsers.Bday.CURRVIEWTYPE&&(params.version5=!0,params.monthOfBdate=ZPUsers.Bday.monthNamesShort.indexOf(ZPUsers.Bday.monthView.month),params.yearOfBdate=ZPUsers.Bday.monthView.year)):Layout.Page.currentmode===ZPNewTabs.URL.getUrl("organization/newhires")?key="NEW_HIRES":"home/team/circles"===Layout.Page.currentmode&&(key="FAVORITES"),more&&(params.start=start),params.end=24,ZPUsers.pageMode=key,params.mode=key,more?ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").find(".bdy_flks_wrpr").append(ZPeople.LOADING_HTML):"FAVORITES"!=key&&ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").html(ZPeople.LOADING_HTML),ZPeople.Request.send("/getUserList.zp",params,ZPUsers.constructList,more)},getNoDataPage:function(imgClass,text,message){return'<div id="emptPage" class="zpl_crd zpl_nodata"> <div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div> <div class="zpl_emptimg '+imgClass+'"></div> <h4>'+ZPI18N.getString(text)+"</h4> <p>"+ZPI18N.getString(message)+"</p> </div> </div> </div> </div>"},userSearchFrmBox:function(event,Obj){13!=event.keyCode||ZPUtil.Validation.isEmpty(Obj.value)||ZPUsers.submitUserSearch(Obj.value)},submitUserSearch:function(searchString){var params={mode:"SEARCH_USER_ON_BDAY_BUDDIES"};ZPUsers.pageMode=params.mode,params.searchStr=searchString,ZPeople.FireScroll.reset(),ZPUsers.parentContainer.find(".Scrcont").html(ZPeople.LOADING_HTML),ZPUsers.parentContainer=Layout.Page.container,ZPeople.Request.send("/getUserList.zp",params,ZPUsers.constructList,!1)},searchBarComponent:function(){return'<div class="search-cmn"><i class="PI_lens"></i><input type="text" class="ztextbox" id="bdayBuddySearch" placeholder="'+ZPI18N.getString("zp.searchemployee")+'" onkeyup="ZPUsers.userSearchFrmBox(event,this)"><i class="PI_cls" onclick="ZPUsers.toggleSearchBar()"></i></div>'},toggleSearchBar:function(){if(ZPUsers.parentContainer.find("#bdayBuddySearch").parent().hasClass("opn"))ZPUsers.getUsersList(),ZPUsers.parentContainer.find("#bdayBuddySearch").parent().removeClass("opn");else{let searchDiv=ZPUsers.parentContainer.find("#bdayBuddySearch");searchDiv.parent().addClass("opn"),searchDiv.focus()}},constructList:function(data,param,more){if(more?ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").find("#zp_page_loading").remove():ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").html('<div class="zpl_flks_crdlst zpl_emcrdlst" '+("NEW_HIRES"===param.mode?'role="list" aria-label="'+ZPI18N.getString("zp.wcag.proceedingtolist",[ZPI18N.getString("zp.newhires")])+'"':"BIRTHDAY_BUDDIES"===param.mode||"BIRTHDAY_BUDDIES_MONTH"===param.mode?'role="list" aria-label="'+ZPI18N.getString("zp.wcag.proceedingtolist",[ZPI18N.getString("zp.birthdayfolks")])+'"':"")+"></div>"),!more&&("BIRTHDAY_BUDDIES"===param.mode||"BIRTHDAY_BUDDIES_MONTH"===param.mode))if(1===ZPUsers.Bday.CURRVIEWTYPE){var extraParams=data.dateStringJson;if(void 0!=extraParams&&void 0!==extraParams.dayOfBdate&&void 0!==extraParams.monthOfBdate&&void 0!==extraParams.yearOfBdate){Calendar.setCurrentDate(extraParams.yearOfBdate,extraParams.monthOfBdate,extraParams.dayOfBdate);let date=Calendar.formatDate(Calendar.currrentDate);ZPUsers.parentContainer.find("#date_navigator").html('<div class="zpl_inav ZP-YearPager"><i id="previousIcon"" class="PI_alft tooltip-js blu CP" title="Previous" tabindex="0" aria-label="'+ZPI18N.getString("zp.wcag.changeprev",[ZPI18N.getString("zp.smallperiod")])+'" role="button"></i><i class="PI_monthly" id="dateIcon" onclick="Calendar.setUpCalendar(event,this, -1, null, ZPUsers.Bday.submitCalendar)" aria-haspopup="true" aria-label="'+ZPI18N.getString("zp.selectdate")+'" tabindex="0"></i><i id="nextIcon" class="PI_argt tooltip-js blu CP" title="Next" tabindex="0" aria-label="'+ZPI18N.getString("zp.wcag.changenext",[ZPI18N.getString("zp.smallperiod")])+'" role="button"></i></div><b id="currYr"selind="0">'+date+"</b>"),ZPUsers.parentContainer.find("#date_navigator").attr({"aria-label":ZPI18N.getString("zp.wcag.periodselectiontext",[date])}),ZPUsers.parentContainer.find("#previousIcon").attr("onclick","ZPUsers.Bday.previousOrNextDate("+extraParams.yearOfBdate+", "+extraParams.monthOfBdate+", "+extraParams.dayOfBdate+", true)"),ZPUsers.parentContainer.find("#nextIcon").attr("onclick","ZPUsers.Bday.previousOrNextDate("+extraParams.yearOfBdate+", "+extraParams.monthOfBdate+", "+extraParams.dayOfBdate+", false)")}}else 5===ZPUsers.Bday.CURRVIEWTYPE&&(ZPUsers.parentContainer.find("#previousIcon").attr("onclick",'ZPUsers.Bday.peekCalander(null,null,null,"previous")'),ZPUsers.parentContainer.find("#nextIcon").attr("onclick",'ZPUsers.Bday.peekCalander(null,null,null,"next")'),ZPUsers.parentContainer.find("#currYr").text(ZPUsers.Bday.monthView.month+" - "+ZPUsers.Bday.monthView.year),ZPUsers.parentContainer.find("#date_navigator").attr({"aria-label":ZPI18N.getString("zp.wcag.periodselectiontext",[ZPUsers.Bday.monthView.month+" - "+ZPUsers.Bday.monthView.year])}));if(more||"NO_DATA"!==data.message&&void 0!==data.result){if(void 0!==data.result&&data.result.length>0){var type=6;"BIRTHDAY_BUDDIES"!==param.mode&&"DEPT_MEMB_BDAY_BUDDIES"!==param.mode&&"FAVORITES_ON_BDAY_BUDDIES"!==param.mode&&"SEARCH_USER_ON_BDAY_BUDDIES"!==param.mode&&"BIRTHDAY_BUDDIES_MONTH"!==param.mode||(type=5),$.each(data.result,function(ind,info){"BIRTHDAY_BUDDIES"!==param.mode&&"NEW_HIRES"!==param.mode&&"BIRTHDAY_BUDDIES_MONTH"!==param.mode||void 0!==data.collaPostDtl&&void 0!==data.collaPostDtl[this.zuid+"_"+("BIRTHDAY_BUDDIES"===param.mode?"5":"6")]&&(!0,data.collaPostDtl[this.zuid+"_"+("BIRTHDAY_BUDDIES"===param.mode?"5":"6")]);var userObj;if(this.leaveAttStat){var leaveAttStat=ZPeople.decodeTxt(this.leaveAttStat),colourClass=Attendance.setClassToShowStatus(this.colourCode);Attendance.isLeaveAvail(this.colourCode)&&(leaveAttStat=this.leaveAttStat),'<span class="'+colourClass+'">'+leaveAttStat+"</span>"}else'<span class="'+(this.isUserAvailable?"grn":"red")+'">'+(this.isUserAvailable?ZPI18N.getString("zp.in"):ZPI18N.getString("zp.out"))+"</span>";if("BIRTHDAY_BUDDIES"===param.mode||"DEPT_MEMB_BDAY_BUDDIES"===param.mode||"FAVORITES_ON_BDAY_BUDDIES"===param.mode||"SEARCH_USER_ON_BDAY_BUDDIES"===param.mode||"NEW_HIRES"===param.mode||"BIRTHDAY_BUDDIES_MONTH"===param.mode){let alreadyWished=void 0!==data.collaPostDtl&&void 0!==data.collaPostDtl[info.zuid+"_"+type],isNeedWish=info.eno!==erecno&&("BIRTHDAY_BUDDIES"==param.mode||"NEW_HIRES"==param.mode);info.alreadyWished=alreadyWished,userObj=UserWidget.Components.getUserCard(info,isNeedWish?()=>{ZPUsers.manageCollabPopup(ZPUsers.parentContainer,ZPUsers.pageMode,data,type,info.eno,()=>{ZPUsers.getUsersList()})}:ZPeople.getUserPage,param.mode,info.eno,isNeedWish?"wish":"",data.isFavoriteAllowed)}else"FAVORITES"===param.mode&&(userObj=UserWidget.Components.getUserCard(info,()=>{ZPeople.getUserPage(info.eno)},void 0,info,"status",data.isFavoriteAllowed));ZPUsers.parentContainer.find("#zpuser_cnt_wrpr .zpl_emcrdlst").append(userObj)}),data.more&&(ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").attr("more","true"),ZPeople.FireScroll.reset()),ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").attr("start",data.nxtsrt)}}else{let imgClass="zp_nd_brthbud",message="";"BIRTHDAY_BUDDIES"===param.mode||"DEPT_MEMB_BDAY_BUDDIES"===param.mode||"FAVORITES_ON_BDAY_BUDDIES"===param.mode||"SEARCH_USER_ON_BDAY_BUDDIES"===param.mode||"BIRTHDAY_BUDDIES_MONTH"===param.mode?key="zp.nobirthdaybuddies":"NEW_HIRES"===param.mode?(key="zp.nonewhiresfound",imgClass="zp_nd_empprfl"):"FAVORITES"===param.mode&&(message="zp.addyourfavouriteascircles",key="zp.nocircleyet",imgClass="zp_nd_users"),"PERMISSION_DENIED"===data.message?(imgClass="zp_nd_permission",key="zp.permissiondeinedtoview",ZPUsers.parentContainer.find(".zpl_btnmnu").addClass("DNI")):ZPUsers.parentContainer.find(".zpl_btnmnu").removeClass("DNI"),ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").html(ZPUsers.getNoDataPage(imgClass,key,message))}},favouriteAction:function(Obj,erecno,isfav){var title,successMsg,params={};params.mode=isfav?"removemyFavorites":"markasFav",params.erecnos=erecno;var isFav=!1;ZPeople.Request.send("/favouriteaction.zp",params,function(data){(Obj=Obj.find("#zp_addfav")).hasClass("org")?(Obj.removeClass("org").addClass("gry"),title=ZPI18N.getString("zp.markascircle"),successMsg="zp.removedfromcirclemsgsuccess"):(isFav=!0,Obj.removeClass("gry").addClass("org"),title=ZPI18N.getString("zp.unmarkfromcircles"),successMsg="zp.addedascirclemsgsuccess"),Obj.off("click"),Obj.on("click",function(){ZPUsers.favouriteAction($(this),erecno,isFav)}),Obj.attr("title",title),ZPeople.Message.success(ZPI18N.getString(successMsg)),"FAVORITES_ON_BDAY_BUDDIES"===ZPUsers.Bday.getCurrentView()&&ZPUsers.getUsersList()})},getModelHtml:function(){return'<div class="zpl_mdl zpl_msm zpl_mopen" id="zpl_brd_flks_modal" isChanged="false"> \n\t\t\t\t\t<div class="zpl_minr"> \n\t\t\t\t\t\t<div class="zpl_mhder"> \n\t\t\t\t\t\t\t<a class="_cls PI_cls zpl_brd_flks_close"></a> \n\t\t\t\t\t\t</div> \n\t\t\t\t\t\t<div class="zpl_mcnt zpl_fm zpl_mdlfolks"> \n\t\t\t\t\t\t\t<div class="zpl_crd zpl_wishpop"> \n\t\t\t\t\t\t\t\t<div class="zpl_crdcnt" id="zp_modal_body"> </div> \n\t\t\t\t\t\t\t</div> \n\t\t\t\t\t\t\t<div class="zpl_crd zpl_wishbg">\n\t\t\t\t\t\t\t\t<div class="zpl_crdcnt" id="colleagues_lst"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div> \n\t\t\t\t</div>'},closeCollabModal:function(container,closeModalCallback,clsParam){let isChanged=container.find("#zpl_brd_flks_modal").attr("isChanged");container.find("#zpl_brd_flks_modal").remove(),void 0!=closeModalCallback&&"true"==isChanged&&closeModalCallback(clsParam)},manageCollabPopup:async function(container,mode,data,type,erecno,closeModalCallback,clsParam,key,needCollaPostDtl,callBack){if(needCollaPostDtl)try{let userArr=[],userlist=data.result;if(key&&(userlist=data[key]),Object.keys(userlist).length>0){$.each(userlist,function(){"null"!==this.zuid&&-1!=this.zuid&&void 0!==this.zuid?userArr.push(this.zuid):"null"!==this.id&&-1!=this.id&&void 0!==this.id&&userArr.push(this.id)});let res=await $.ajax({url:"/commonAction.zp",method:"POST",data:{conreqcsr:csrfToken,userIds:JSON.stringify(userArr),mode:"GET_COLLABSTATUS",type:type}});data.collaPostDtl=res}}catch(error){console.error("An error occurred: ",error)}callBack=ZPUtil.Validation.isFunction(callBack)?callBack:()=>{},container.append(ZPUsers.getModelHtml()),container.find(".zpl_brd_flks_close").on("click",()=>{ZPUsers.closeCollabModal(container,closeModalCallback,clsParam),callBack()}),callBack(),ZPUsers.listCollabList(container,mode,data,type,erecno,key)},listCollabList:function(container,mode,data,type,erecno,key){var bodyHtml="";let userlist=data.result;var seldata;key&&(userlist=data[key]),bodyHtml=`\n\t\t\t<div class="zpl_secn">\n               \t<span><b>${"NEW_HIRES"==mode?ZPI18N.getString("zp.files.operations.selemp"):ZPI18N.getString("zp.wishyourbuddies")}</b></span>\n               \t<div class="zpl_avatarimgwish" id="collabList"></div>\n            </div>`,bodyHtml=$(bodyHtml),void 0==data.collaPostDtl&&(data.collaPostDtl={}),$.each(userlist,function(ind,info){let alreadyWished=void 0!==data.collaPostDtl&&void 0!==data.collaPostDtl[this.zuid+"_"+type];info.alreadyWished=alreadyWished,bodyHtml.find("#collabList").append($('<div class="zpl_em '+(erecno===this.eno?'zpl_actimg"':'"')+'" userId="'+this.zuid+'" eno="'+this.eno+'"><div class="zpl_emimg"><img src="'+this.photo+'">'+(alreadyWished?'<i class="PI_tick2_fil"></i>':"")+"</div></div>").data({user:info,wishes:void 0!==data.collaPostDtl&&void 0!==data.collaPostDtl[this.zuid+"_"+type]?data.collaPostDtl[this.zuid+"_"+type]:"undefined"}).on("click",function(){$(this).siblings().removeClass("zpl_actimg"),$(this).addClass("zpl_actimg"),ZPUsers.setUserBody(container,mode,$(this).data(),type,data.collaPostDtl)}))}),container.find("#zpl_brd_flks_modal").find("#colleagues_lst").html(bodyHtml),0==bodyHtml.find("#collabList").find("div.zpl_actimg").length?($($(bodyHtml.find("#collabList").find("div.zpl_em")[0])).addClass("zpl_actimg"),seldata=$(bodyHtml.find("#collabList").find("div.zpl_em")[0]).data()):seldata=$(bodyHtml.find("#collabList").find("div.zpl_em.zpl_actimg")[0]).data(),ZPUsers.setUserBody(container,mode,seldata,type,data.collaPostDtl)},setUserBody:function(container,mode,data,type,collaPostDtl){var user=data.user,wishes=data.wishes,modal=container.find("#zpl_brd_flks_modal");modal.find("#card").remove(),modal.find("#bday_date").remove();var userObj=$(ZPUsers.getCollabModalCard(mode,data));modal.find("#zp_modal_body").prepend(userObj);"WORK_ANNIVERSARY"==mode&&void 0!==data.user.yearcnt&&data.user.yearcnt;var placeholder="";placeholder="WORK_ANNIVERSARY"==mode?ZPUsers.checkWhetherNeedToWish(wishes,mode,data,"zp.happyworkanniversary",modal,placeholder):ZPUsers.checkWhetherNeedToWish(wishes,mode,data,"zp.happybirthday",modal,placeholder),"NEW_HIRES"!=mode&&(void 0!=user.displaydate&&modal.find("#zp_modal_body").prepend(`<div class="zpl_tg" id="bday_date"><b>${user.displaydate.split(" ")[0]}</b><span>${user.displaydate.split(" ")[1]}</span></div>`),modal.find("#bday_modal_photo").addClass("zpl_bday")),modal.find("#card").on("click",function(event){"bdwish_txtarea"!=event.target.id&&"bdwish"!=event.target.id&&"submit"!=event.target.id&&ZPeople.getUserPage(user.eno)}),modal.find("#zp_modal_body #bdwish").find("#submit").remove(),modal.find("#zp_modal_body").find("#bdwish").html('<textarea tabindex="0" id="bdwish_txtarea" class="ztextbox" data-zbp-bound="true" spellcheck="false" rows="5"></textarea>'),user.eno==erecno||user.alreadyWished||modal.find("#zp_modal_body").find("#bdwish").append($(`<div><button type="button" id="submit" class="zlabel zpl_fr zlabel--blue zlabel--medium zbutton zbutton--medium zbutton--primary" aria-label="${ZPI18N.getString("zp.wcag.sendmsgorpressesc")}">${ZPI18N.getString("zp.send")}</button></div>`).on("click",()=>ZPUsers.sendCollabWishes(modal.find("#bdwish textarea").val(),data,type,container,collaPostDtl))),modal.find("#zp_modal_body").find("#bdwish").find("textarea").attr("placeholder",placeholder),modal.find("#zp_modal_body").find("#bdwish").find("textarea").focus(),user.alreadyWished&&modal.find("#zp_modal_body #bdwish textarea").addClass("disabled")},checkWhetherNeedToWish:function(wishes,mode,data,selfusermsg,modal,placeholder){var checkWorkAnniversary,anniplaceholder="",anniplaceholderother="",widget="zp..widget.birthday";return"WORK_ANNIVERSARY"==mode&&(anniplaceholder="zp.anniversaryplacehlder",anniplaceholderother="zp.anniversaryplacehlderother",widget="zp.work",checkWorkAnniversary=void 0!==data.user.yearcnt&&"-"!==data.user.yearcnt),"undefined"!=data.wishes?placeholder=data.wishes:data.user.eno==erecno?placeholder=checkWorkAnniversary?ZPI18N.getString(anniplaceholder,[data.user.yearcnt,ZPI18N.getString(widget)]):ZPI18N.getString(selfusermsg):(modal.find("#bdwish").removeClass("DNI"),null!==data.user.zuid&&"null"!==data.user.zuid&&-1!=data.user.zuid?placeholder=checkWorkAnniversary?ZPI18N.getString(anniplaceholderother,[ZPeople.decodeTxt(data.user.name),data.user.yearcnt,ZPI18N.getString(widget)]):ZPI18N.getString("zp.entermessage"):modal.find("#zp_modal_body").find("#bdwish").html("")),placeholder},getCollabModalCard:function(mode,data){var user=data.user;return`<div class="zpl_secn" id="card">\n\t\t\t\t\t<div class="zpl_em">\n\t\t\t\t\t\t<div class="zpl_emimg" id="bday_modal_photo">\n\t\t\t\t\t\t\t<img src="${user.photo}">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div> \n\t\t\t\t\t<div class="zpl_emrole"> \n\t\t\t\t\t\t<span id="uname">\n\t\t\t\t\t\t\t<em>${user.eid}</em>\n\t\t\t\t\t\t\t - \n\t\t\t\t\t\t\t<b>${user.name}</b>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t${ZPUtil.Validation.isEmpty(user.desname)?"":"<em>"+user.desname+"</em>"}\n\t\t\t\t\t\t${ZPUtil.Validation.isEmpty(user.dpname)?"":'<em class="txttrim">'+user.dpname+"</em>"}\n\t\t\t\t\t\t<a href="mailto:${user.email}" class="txttrim">${user.email}</a>\n\t\t\t\t\t\t${ZPUtil.Validation.isEmpty(user.wloc)?"":"<em>"+user.wloc+"</em>"}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="bdaymsg" id="bdwish"> </div>\n\t\t\t\t</div>`},undefinedToEmpty:function(value){return void 0===value&&(value=""),value},sendCollabWishes:function(status,userData,type,container,collaPostDtl){let user=userData.user;if(!ZPUtil.Validation.isEmpty(status)&&-1!=user.zuid){var params={collabStatus:status,postedTo:user.zuid,type:type};container.find("#zp_modal_body #bdwish #submit").append('<i id="loader" class="zbutton__icon zbutton--loader "><svg class="zbutton__svg zbutton__loader zeffects--rotate" width="100%" height="100%"> <circle class="circle__track" cx="8px" cy="8px" r="8px"></circle> <circle class="circle__load" cx="8px" cy="8px" r="8px"></circle> </svg></i>').addClass("disabled"),ZPeople.Request.send("/postCollaborationStatus.zp",params,function(data){void 0!==data&&200===data.result?(container.find("#zpl_brd_flks_modal").attr("isChanged","true"),container.find("#zp_modal_body #bdwish textarea").addClass("disabled"),container.find("#zp_modal_body #bdwish #submit").addClass("disabled DNI"),container.find("#colleagues_lst #collabList div[userid="+user.zuid+"] .zpl_emimg").append("<i class='PI_tick2_fil'></i>"),user.alreadyWished=!0,userData.wishes=status,collaPostDtl&&(collaPostDtl[user.zuid+"_"+type]=status),"5"==params.type?ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.birthdaymsgsuccess")):"6"==params.type&&ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.welcomemsgsuccess"))):void 0!==data&&409==data.result?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.youalreadypostedwish")):void 0!==data&&403==data.result?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.adminerrormsg")):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.rebranderrinaction")),200!==data.result&&container.find("#zp_modal_body #bdwish #submit").removeClass("disabled").find("#loader").remove()})}},Bday:{calObj:void 0,monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],CURRVIEWTYPE:1,getCurrentView:function(){if(Layout.Page.currentmode===ZPNewTabs.URL.getUrl("organization/birthdayfolks")){var key="BIRTHDAY_BUDDIES";return 3===ZPUsers.Bday.CURRVIEWTYPE?key="FAVORITES_ON_BDAY_BUDDIES":4===ZPUsers.Bday.CURRVIEWTYPE?key="DEPT_MEMB_BDAY_BUDDIES":5===ZPUsers.Bday.CURRVIEWTYPE&&(key="BIRTHDAY_BUDDIES_MONTH"),key}},initCurrentActiveView:function(view){if(ZPUsers.parentContainer.find("#date_navigator").removeClass("DNI"),"daily_view"===view)ZPUsers.parentContainer.find("#date_navigator").html('<div class="zpl_inav ZP-YearPager"><i id="previousIcon"" class="PI_alft tooltip-js blu CP" title="Previous"></i><i class="PI_monthly" id="dateIcon"></i><i id="nextIcon" class="PI_argt tooltip-js blu CP" title="Next"></i></div><b id="currYr"selind="0">'+Calendar.getCurrentDate(!0)+"</b>"),ZPUsers.parentContainer.find("#date_navigator").attr({"aria-label":ZPI18N.getString("zp.wcag.periodselectiontext",[Calendar.getCurrentDate(!0)])});else if("mydept_view"===view||"fav_view"===view)ZPUsers.parentContainer.find("#date_navigator").addClass("DNI");else if("month_view"===view){let date=Calendar.getCurrentDate(!1),calObj=new NewCalendar.calObj;calObj.curYear=(new Date).getFullYear(),calObj.curMonth=(new Date).getMonth(),calObj.curDate=(new Date).getDate(),NewCalendar.initCalendar(calObj),ZPUsers.Bday.monthView={calObj:calObj,month:Calendar.months[date.getMonth()],year:date.getFullYear()},ZPUsers.parentContainer.find("#date_navigator").html('<div class="zpl_inav ZP-YearPager"><i id="previousIcon" class="PI_alft tooltip-js blu CP" title="Previous"></i><i class="PI_monthly" id="dateIcon" onclick="Calendar.setUpCalendar(event, this, 2, undefined, ZPUsers.Bday.peekCalander)";></i><i id="nextIcon" class="PI_argt tooltip-js blu CP" title="Next"></i></div><b id="currYr"selind="0"></b>')}},todaysBdayFolksView:function(){ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").removeClass("ZPcalvw-mtnT"),ZPUsers.Bday.CURRVIEWTYPE=1,ZPUsers.Bday.initCurrentActiveView("daily_view"),ZPUsers.getUsersList()},monthBdayFolksView:function(){ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").html('<div id="zp_common_userlisting"></div>'),ZPUsers.Bday.CURRVIEWTYPE=5,ZPUsers.Bday.initCurrentActiveView("month_view"),ZPUsers.getUsersList()},peekCalander:function(date,obj,data,mode){let index=ZPUsers.Bday.monthNamesShort.indexOf(ZPUsers.Bday.monthView.month);if("previous"==mode){let month=index>0?ZPUsers.Bday.monthNamesShort[index-1]:null;null==month?(ZPUsers.Bday.monthView.month=ZPUsers.Bday.monthNamesShort[ZPUsers.Bday.monthNamesShort.length-1],ZPUsers.Bday.monthView.year=ZPUsers.Bday.monthView.year-1):ZPUsers.Bday.monthView.month=month}else if("next"==mode){let month=ZPUsers.Bday.monthNamesShort[index+1]?ZPUsers.Bday.monthNamesShort[index+1]:null;null==month?(ZPUsers.Bday.monthView.month=ZPUsers.Bday.monthNamesShort[0],ZPUsers.Bday.monthView.year=parseInt(ZPUsers.Bday.monthView.year)+1):ZPUsers.Bday.monthView.month=month}else ZPUsers.parentContainer.find("#dateIcon").text(""),ZPUsers.Bday.monthView.month=ZPUsers.Bday.monthNamesShort[data.clickedMonth],ZPUsers.Bday.monthView.year=data.clickedYear;ZPUsers.getUsersList()},birthdayFolksMonthView:function(calObj){if(void 0===calObj){(calObj=new NewCalendar.calObj).curYear=(new Date).getFullYear(),calObj.curMonth=(new Date).getMonth(),calObj.curDate=(new Date).getDate(),calObj.calcontId="monthcalendardiv",calObj.outerdivId="zp_common_userlisting",calObj.daysObj={empty:"zpcalempty",weekend:"zpcalweek",day:"zpcaldays",today:"zpcaltoday",leave:"zpcalholi"},calObj.divid="caldiv",calObj.callback=ZPUsers.Bday.birthdayFolksMonthView,calObj.mode="bday",calObj.tdonclick=null,calObj.prearrow="IC-ar-lft",calObj.nextarrow="IC-ar-rgt",ZPUsers.Bday.calObj=calObj,NewCalendar.initCalendar(calObj)}else{ZPUsers.parentContainer.find("#currYr").text(ZPUsers.Bday.monthNamesShort[calObj.curMonth]+"-"+calObj.curYear),ZPUsers.parentContainer.find("#date_navigator").attr({"aria-label":ZPI18N.getString("zp.wcag.periodselectiontext",[ZPUsers.Bday.monthNamesShort[calObj.curMonth]+"-"+calObj.curYear])}),ZPUsers.parentContainer.find("#previousIcon").attr("onclick","NewCalendar.previousMonth(ZPUsers.Bday.month.calObj)"),ZPUsers.parentContainer.find("#nextIcon").attr("onclick","NewCalendar.nextMonth(ZPUsers.Bday.month.calObj)");var params={mode:"BIRTHDAY_BUDDIES_MONTH"};params.monthOfBdate=calObj.curMonth,params.yearOfBdate=calObj.curYear,params.conreqcsr=csrfToken,$.post("/getUserList.zp",params,function(resultData){var resData=new Array;for(var key in resultData.result){for(var rData={},empArray=resultData.result[key],htmlTxt='<div class="ZP-monthcol"><div class="Dmems"><div class=" dropdown ZPcalsDt ZPCusDrs"><ul>',i=0;i<empArray.length;i++){var empData=empArray[i];i<4&&(htmlTxt+='<li><a class="P0I"><img popup="user" empid="'+empData.empErecno+'"  isusrzuid="false" src="'+empData.empPhoto+'"></a></li>'),4===i&&(htmlTxt=htmlTxt+'<li class="viewall" onclick="ZPUsers.Bday.showBdayListModal(this)"><span class="mrtxt">+'+(empArray.length-3)+"</span></li>")}htmlTxt+="</ul></div></div></div>",rData.date=key,(htmlTxt=$(htmlTxt).data("empList",empArray)).data("date"," "+ZPUsers.Bday.monthNamesShort[calObj.curMonth]+"-"+calObj.curYear),rData.txt=htmlTxt,resData.push(rData)}NewCalendar.populateData(calObj,resData)})}},showBdayListModal:function(obj){for(var empList=$(obj).parents(".ZP-monthcol").data("empList"),Obj='<div class="Main-lists"><div class="row"><div class="Div-lists col-sm-12">',usrCnt=0;usrCnt<empList.length;usrCnt++){var empData=empList[usrCnt];Obj+='<div class="Activity" id="zp_empName" empId="'+empData.empErecno+'"><img class="Usrimg FL" src="'+empData.empPhoto+'"> <div class="Rdetail"> <h5>'+empData.empName+"</h5> </div></div>"}Obj+="</div></div></div>",ZPeople.BSModal.show(ZPeople.BSModal.get({id:"zp_bdaymon_modal",type:4,headerHtml:'<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"><div class="IC-cls-1px red S21 CP"></div></span></button><h4  class="modal-title" id="myModalLabel">'+$(obj).parents(".ZP-monthcol").data("date")+"</h4>",body:Obj,disableFooter:!0,modalClass:"member-modal ZPMorMdl",removeModalClass:"DelMdl",deleteOnHide:!0})),$("#zp_bdaymon_modal").find("[id='zp_empName']").on("click",function(){ZPeople.getUserPage($(this).attr("empId"))})},submitMonthCalendar:function(curDate){ZPUsers.Bday.calObj.curMonth=curDate.getMonth(),ZPUsers.Bday.calObj.curYear=curDate.getFullYear(),NewCalendar.constructCalendar(ZPUsers.Bday.calObj),ZPUsers.Bday.birthdayFolksMonthView(ZPUsers.Bday.calObj)},myFavBdayFolksView:function(){ZPUsers.Bday.CURRVIEWTYPE=3,ZPUsers.Bday.initCurrentActiveView("fav_view"),ZPUsers.getUsersList()},myDeptBdayFolksView:function(id){ZPUsers.Bday.CURRVIEWTYPE=4,ZPUsers.Bday.initCurrentActiveView("mydept_view"),ZPUsers.getUsersList()},previousOrNextDate:function(year,month,day,isPrevious){var workDate={};workDate.day=new Date(year,month,day),workDate=isPrevious?Calendar.getPreviousDay(workDate):Calendar.getNextDay(workDate),ZPUsers.Bday.submitCalendar(workDate.day)},submitCalendar:function(curDate){var params={mode:"BIRTHDAY_BUDDIES"};params.dayOfBdate=curDate.getDate(),params.monthOfBdate=curDate.getMonth(),params.yearOfBdate=curDate.getFullYear(),ZPeople.FireScroll.reset(),ZPUsers.parentContainer.find("#zpuser_cnt_wrpr").html(ZPeople.LOADING_HTML),ZPUsers.parentContainer=Layout.Page.container,ZPeople.Request.send("/getUserList.zp",params,ZPUsers.constructList,!1)}}};var PMSUserwiseSearch={ENABLED_MODULES:{},getNewPerformanceModules:function(){if(null===PMSUserwiseSearch.ENABLED_MODULES||Object.keys(PMSUserwiseSearch.ENABLED_MODULES).length<=0){ZPeople.Request.sendAsyncPost("/performanceConfig.zp",{mode:"getPerformanceModules"},function(resultData){PMSUserwiseSearch.ENABLED_MODULES=resultData.perfModules})}},redirect:function(recId,isFromPopup){PMSUserwiseSearch.getNewPerformanceModules(),void 0!==AppraisalConfig.InitResult&&0!=Object.keys(AppraisalConfig.InitResult).length||AppraisalConfig.fetchInit();let url=Layout.Page.currentmode.includes("operations")?"#operations/performance/user/":"#performance/myteamuser/";isFromPopup&&"true"===isFromPopup?(paCommonUtil.isFromUserPopup=!0,paCommonUtil.previousURLBackup=Layout.Page.hash):(paCommonUtil.isFromUserPopup=!1,paCommonUtil.previousURLBackup="");let actModuleObj=PMSUserwiseSearch.ENABLED_MODULES,smy=actModuleObj.SUMMARY;var fdb=actModuleObj.FEEDBACK,competency=actModuleObj.COMPETENCY,skillS=actModuleObj.SKILLSET,kraObj=actModuleObj.KRA,goalObj=actModuleObj.GOALS,kgObj=actModuleObj.KRA_GOALS,isKraEnable=1===kraObj.enable,isGoalEnable=1===goalObj.enable,isKraGlEnable=1===kgObj.enable;isKraEnable||isKraGlEnable?window.location.href=url+"kra-user:"+recId+"/configId:"+-1:isGoalEnable?window.location.href=url+"goals-user:"+recId+"/configId:"+-1:1===skillS.enable?window.location.href=url+"skillset-user:"+recId+"/configId:"+-1:1===competency.enable?window.location.href=url+"competency-user:"+recId+"/configId:"+-1:1===fdb.enable?window.location.href=url+"feedback-user:"+recId+"/configId:"+-1:1===smy.enable&&(window.location.href=url+"summary-user:"+recId+"/configId:"+-1)}};