PMSExport={configurationData:null,EXPORTSLIDERID:"exportslide",exportslider:{},goalFormDtl:[],kraformDtl:[],kraUsrformDtl:[],competencyformDtl:[],competencyUsrformDtl:[],userSkillMapformDtl:[],skillsformDtl:[],performanceappFormDtl:[],multiraterDtl:[],appraisalfields:null,appraiseeRefFormCompId:null,relatedfiledarr:[],fieldarr:[],selfappFormDtl:[],teambudgetformDtl:[],multiraterName:null,salaryHikeName:null,kraDispName:null,compDispName:null,skillDispName:null,goalDispName:null,intiateExport:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){let pageId=settingsPage.container;if(pageId.html(""),pageId.html(ZPeople.LOADING_HTML),null==PMSExport.configurationData){null!=PMSExport.multiraterName&&null!=PMSExport.hikeName||PMSExport.getExportDisplayName("cycle");let params={mode:"getAppConfListForExport",conreqcsr:csrfToken};$.post(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(resultData){void 0!=resultData&&resultData.hasOwnProperty("appConfList")?(PMSExport.configurationData=resultData.appConfList,null!=PMSExport.configurationData&&PMSExport.configurationData.length>0?PMSExport.setCycleCollapsiblepanels():PMSOperationCommon.setNoData(pageId,ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null)):"permission_denied"===resultData.msg?pageId.html(ZPI18N.getString("zp.permissiondeniedtoaccessthispage")):"Performance module is disabled"===resultData.msg&&pageId.html(ZPI18N.getString("zp.tabdisabled",[ZPI18N.getString("zp.performance")]))})}else PMSExport.setCycleCollapsiblepanels()}},getExportDisplayName:function(submode){var params={mode:"getExportDisplayName",subMode:submode};ZPeople.Request.sendAsyncPost(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(data){"cycle"==submode?(PMSExport.multiraterName=data.MULTIRATER,PMSExport.hikeName=data.HIKE_NAME):(PMSExport.kraDispName=data.KRA,PMSExport.compDispName=data.COMPETENCY,PMSExport.skillDispName=data.SKILLSET,PMSExport.goalDispName=data.GOALS)})},setCycleCollapsiblepanels:function(){let pageId=settingsPage.container,panelid="",_htm="";"#operations/performance/export/activecycles"==Layout.Page.hash?(_htm=PMSExport.loadActiveCycles(),panelid="activeCycles"):"#operations/performance/export/completedcycles"==Layout.Page.hash?(_htm=PMSExport.loadCompletedCycles(),panelid="completedCycles"):"#operations/performance/export/activesalarycycles"==Layout.Page.hash?(_htm=PMSExport.loadActiveSalaryCycles(),panelid="activeSalaryCycles"):"#operations/performance/export/completedsalarycycles"==Layout.Page.hash&&(_htm=PMSExport.loadCompletedSalaryCycles(),panelid="completedSalaryCycles"),""!=_htm?pageId.html(_htm):PMSOperationCommon.setNoData(pageId,ZPI18N.getString("zp.norecfound"),"no_data_found",null,null,null),""!=panelid&&""!=_htm&&(ZPeopleComponents.collapsiblepanels(pageId.find("#"+panelid),{toggleButtonPosition:"right",isActive:!1}),ZPeopleComponents.collapsiblepanels(pageId.find("#"+panelid)).expandPanel("#"+$(pageId.find("#"+panelid+" div")[0]).attr("id")))},cyclePanelConstruction:function(data){let constructExportDesc=desc=>(desc.length>75&&(desc=desc.slice(0,75)+".."),desc);var typeDesc="";let _htm='<div class="zpl_collapsepanel zpl_tblcolpanl" id="'+data.configId+'" is-active="false">';return _htm+='<div class="zpl_tgsprt"><h5 class="zpl_tgl">'+data.periodName+"</h5></div>",_htm+='<div class="zpl_collapsecontent" style=""><div class="zpl_secn zpl_grdcrdlst">',void 0!=data.isSalaryHikeCycle&&data.isSalaryHikeCycle||(typeDesc=ZPI18N.getString("zp.paexport.completecycleddesc"),_htm+='<div class="zpl_gbox"> <div> <h4 title="'+ZPI18N.getString("zp.paexport.completecycledetails")+'" ><span class="zpl_ellipsis">'+ZPI18N.getString("zp.paexport.completecycledetails")+'</span></h4> <p title="'+typeDesc+'">'+constructExportDesc(typeDesc)+'</p> </div> <div class="zpl_idiv"></div> <div class="zpl_idiv"><form id="zp_cycle_backup" action="paCycleBackup.zp" method="post" name="zp_cycle_backup" style="display: none;"  target="exportresp"></form><button type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue" onclick="PMSV2Cycle.backUpCycleData(\'export\',\''+data.configId+'\')" title="'+ZPI18N.getString("zp.export")+'">'+ZPI18N.getString("zp.export")+"</button> </div> </div>",typeDesc=ZPI18N.getString("zp.paexport.reviewdetailsdesc"),_htm+='<div class="zpl_gbox"> <div> <h4 title="'+ZPI18N.getString("zp.paexport.reviewdetails")+'" ><span class="zpl_ellipsis">'+ZPI18N.getString("zp.paexport.reviewdetails")+'</span></h4> <p title="'+typeDesc+'">'+constructExportDesc(typeDesc)+'</p> </div> <div class="zpl_idiv"></div> <div class="zpl_idiv"><button type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue" onclick="PMSExport.exportAppraisalData(\'appraisal_form\',\''+data.configId+'\')" title="'+ZPI18N.getString("zp.export")+'">'+ZPI18N.getString("zp.export")+"</button> </div> </div>"),void 0!=data.selfAppraisalEnabled&&data.selfAppraisalEnabled&&(typeDesc=ZPI18N.getString("zp.paexport.selfappraisaldesc"),_htm+='<div class="zpl_gbox"> <div> <h4 title="'+ZPI18N.getString("zp.paexport.selfappraisal")+'" ><span class="zpl_ellipsis">'+ZPI18N.getString("zp.paexport.selfappraisal")+'</span></h4> <p title="'+typeDesc+'">'+constructExportDesc(typeDesc)+'</p> </div> <div class="zpl_idiv"></div> <div class="zpl_idiv"><button type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue" onclick="PMSExport.exportAppraisalData(\'selfappraisal\',\''+data.configId+'\')" title="'+ZPI18N.getString("zp.export")+'">'+ZPI18N.getString("zp.export")+"</button> </div> </div>"),void 0!=data.multiRaterEnabled&&data.multiRaterEnabled&&(typeDesc=ZPI18N.getString("zp.paexport.multiraterdetailsdesc",[PMSExport.multiraterName]),_htm+='<div class="zpl_gbox"> <div> <h4 title="'+ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.multiraterName])+'" ><span class="zpl_ellipsis">'+ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.multiraterName])+'</span></h4> <p title="'+typeDesc+'">'+constructExportDesc(typeDesc)+'</p> </div> <div class="zpl_idiv"></div> <div class="zpl_idiv"><button type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue" onclick="PMSExport.exportAppraisalData(\'multiraterform\',\''+data.configId+'\')" title="'+ZPI18N.getString("zp.export")+'">'+ZPI18N.getString("zp.export")+"</button> </div> </div>"),void 0!=data.salaryHikeEnabled&&data.salaryHikeEnabled&&(typeDesc=ZPI18N.getString("zp.paexport.multiraterdetailsdesc",[PMSExport.hikeName]),_htm+='<div class="zpl_gbox"> <div> <h4 title="'+ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.hikeName])+'" ><span class="zpl_ellipsis">'+ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.hikeName])+'</span></h4> <p title="'+typeDesc+'">'+constructExportDesc(typeDesc)+'</p> </div> <div class="zpl_idiv"></div> <div class="zpl_idiv"><button type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue" onclick="PMSExport.exportAppraisalData(\'teambudgetform\',\''+data.configId+'\')" title="'+ZPI18N.getString("zp.export")+'">'+ZPI18N.getString("zp.export")+"</button> </div> </div>"),_htm+="</div></div>",_htm+="</div>"},loadActiveCycles:function(){let configData=PMSExport.configurationData,_htm="";for(let i in configData)configData[i].isSalaryHikeCycle||"0"!=configData[i].periodStatus&&"4"!=configData[i].periodStatus||(_htm+=PMSExport.cyclePanelConstruction(configData[i]));return""!=_htm&&(_htm='<div class="zpl_rgtcnt"><div id="activeCycles">'+_htm+"</div></div>"),_htm},loadCompletedCycles:function(){let configData=PMSExport.configurationData,_htm="";for(let i in configData)configData[i].isSalaryHikeCycle||"5"!=configData[i].periodStatus||(_htm+=PMSExport.cyclePanelConstruction(configData[i]));return""!=_htm&&(_htm='<div class="zpl_rgtcnt"><div id="completedCycles">'+_htm+"</div></div>"),_htm},loadActiveSalaryCycles:function(){let configData=PMSExport.configurationData,_htm="";for(let i in configData)!configData[i].isSalaryHikeCycle||"0"!=configData[i].periodStatus&&"4"!=configData[i].periodStatus||(_htm+=PMSExport.cyclePanelConstruction(configData[i]));return""!=_htm&&(_htm='<div class="zpl_rgtcnt"><div id="activeSalaryCycles">'+_htm+"</div></div>"),_htm},loadCompletedSalaryCycles:function(){let configData=PMSExport.configurationData,_htm="";for(let i in configData)configData[i].isSalaryHikeCycle&&"5"==configData[i].periodStatus&&(_htm+=PMSExport.cyclePanelConstruction(configData[i]));return""!=_htm&&(_htm='<div class="zpl_rgtcnt"><div id="completedSalaryCycles">'+_htm+"</div></div>"),_htm},handleExportResponse:function(json){json.isExclude&&json.isSuccess&&json.isScheduled?void 0!=json.isEsignRecallExclude&&json.isEsignRecallExclude?PMSESign.recallAppraisalLetterAndExcludeUser():PMSOperation.excludeReviewedEmp():json.isSuccess&&json.isScheduled?ZPeople.Message.success(ZPI18N.getString("zp.appraisalexportschedulemsg")):void 0!==json.MSG&&"PERMISSION_DENIED"===json.MSG?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},handleCFSExportResponse:function(json){json.isSuccess&&json.isScheduled?ZPeople.Message.success(ZPI18N.getString("zp.cfsexportschedulemsg")):void 0!==json.MSG&&"PERMISSION_DENIED"===json.MSG?ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied")):void 0!==json.MSG?ZPeople.Message.failure(ZPI18N.getString("zp.serrviceconflict.commonerror",[ZPeople.peopleSupportEmail])):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},intiateModuleExportCards:function(mode){let pageId=settingsPage.container;pageId.html(""),pageId.html(ZPeople.LOADING_HTML);let _htm='<div class="zpl_rgtcnt"><div class="zpl_secn zpl_grdcrdlst">';return _htm+='<div id="module"> <div class="zpl_gbox zpl_gboxwhtbg"><div><h4 id="moduleheader"><span class="zpl_ellipsis"></span></h4> <p id="moduleexpdesc"></p> </div>',_htm+='<div class="zpl_idiv"></div> <div class="zpl_idiv"> <button type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue" title="'+ZPI18N.getString("zp.export")+'">'+ZPI18N.getString("zp.export")+"</button> </div> </div> </div>","goal"!=mode&&(_htm+='<div id="moduleuserexport"> <div class="zpl_gbox zpl_gboxwhtbg"><div><h4 id="moduleuserexportheader"><span class="zpl_ellipsis"></span></h4> <p id="moduleuserexportdesc"></p> </div>',_htm+='<div class="zpl_idiv"></div> <div class="zpl_idiv"> <button type="button" class="zlabel zlabel--outline zlabel--medium zlabel--blue" title="'+ZPI18N.getString("zp.export")+'">'+ZPI18N.getString("zp.export")+"</button> </div> </div> </div>"),_htm+="</div></div>",pageId.html(""),pageId.html(_htm),_htm},initiateModuleExport:function(){if(PMSGettingStarted.gettingStartedInit(PMSGettingStarted.OPERATION_PAGE)){let pageId=settingsPage.container,mode="",modeForm="",modeUserForm="";pageId.html(""),pageId.html(ZPeople.LOADING_HTML),null!=PMSExport.kraDispName&&null!=PMSExport.compDispName&&null!=PMSExport.skillDispName&&null!=PMSExport.goalDispName||PMSExport.getExportDisplayName("module");let params={mode:"paTabAccess",conreqcsr:csrfToken};$.post(PMSCommon.PERFORMANCE_CONFIG_URL,params,function(data){if(void 0!==data)if(data.isPerfTabEnb&&data.isPerfPageAccess){let constructExportDesc=desc=>(desc.length>75&&(desc=desc.slice(0,75)+".."),desc);var moduleDesc="";"#operations/performance/export/kraexport"==Layout.Page.hash&&0==AppraisalConfig.formUtil.kraformDtl.length?(mode="KRA",modeForm="kraForm",modeUserForm="kraUserform",PMSExport.intiateModuleExportCards(mode),pageId.find("#moduleheader span").text(ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.kraDispName])),pageId.find("#moduleheader").attr("title",ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.kraDispName])),moduleDesc=ZPI18N.getString("zp.paexport.evaluationmethoddesc",[PMSExport.kraDispName]),pageId.find("#moduleexpdesc").text(constructExportDesc(moduleDesc)),pageId.find("#moduleexpdesc").attr("title",moduleDesc),pageId.find("#moduleuserexportheader span").text(ZPI18N.getString("zp.paexport.evaluationempwisehdr",[PMSExport.kraDispName])),pageId.find("#moduleuserexportheader").attr("title",ZPI18N.getString("zp.paexport.evaluationempwisehdr",[PMSExport.kraDispName])),moduleDesc=ZPI18N.getString("zp.paexport.evaluationempwisedsc",[PMSExport.kraDispName]),pageId.find("#moduleuserexportdesc").text(constructExportDesc(moduleDesc)),pageId.find("#moduleuserexportdesc").attr("title",moduleDesc)):"#operations/performance/export/competencyexport"==Layout.Page.hash&&0==AppraisalConfig.formUtil.competencyformDtl.length?(mode="COMPETENCY",modeForm="competency_form",modeUserForm="competencyUserform",PMSExport.intiateModuleExportCards(mode),pageId.find("#moduleheader span").text(ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.compDispName])),pageId.find("#moduleheader").attr("title",ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.compDispName])),moduleDesc=ZPI18N.getString("zp.paexport.evaluationmethoddesc",[PMSExport.compDispName]),pageId.find("#moduleexpdesc").text(constructExportDesc(moduleDesc)),pageId.find("#moduleexpdesc").attr("title",moduleDesc),pageId.find("#moduleuserexportheader span").text(ZPI18N.getString("zp.paexport.evaluationempwisehdr",[PMSExport.compDispName])),pageId.find("#moduleuserexportheader").attr("title",ZPI18N.getString("zp.paexport.evaluationempwisehdr",[PMSExport.compDispName])),moduleDesc=ZPI18N.getString("zp.paexport.evaluationempwisedsc",[PMSExport.compDispName]),pageId.find("#moduleuserexportdesc").text(constructExportDesc(moduleDesc)),pageId.find("#moduleuserexportdesc").attr("title",moduleDesc)):"#operations/performance/export/skillexport"==Layout.Page.hash&&0==AppraisalConfig.formUtil.skillsformDtl.length?(mode="SKILL",modeForm="skillform",modeUserForm="userSkillMap",PMSExport.intiateModuleExportCards(mode),pageId.find("#moduleheader span").text(ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.skillDispName])),pageId.find("#moduleheader").attr("title",ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.skillDispName])),moduleDesc=ZPI18N.getString("zp.paexport.evaluationmethoddesc",[PMSExport.skillDispName]),pageId.find("#moduleexpdesc").text(constructExportDesc(moduleDesc)),pageId.find("#moduleexpdesc").attr("title",moduleDesc),pageId.find("#moduleuserexportheader span").text(ZPI18N.getString("zp.paexport.evaluationempwisehdr",[PMSExport.skillDispName])),pageId.find("#moduleuserexportheader").attr("title",ZPI18N.getString("zp.paexport.evaluationempwisehdr",[PMSExport.skillDispName])),moduleDesc=ZPI18N.getString("zp.paexport.evaluationempwisedsc",[PMSExport.skillDispName]),pageId.find("#moduleuserexportdesc").text(constructExportDesc(moduleDesc)),pageId.find("#moduleuserexportdesc").attr("title",moduleDesc)):"#operations/performance/export/goalexport"==Layout.Page.hash&&(mode="goal",modeForm="goal",PMSExport.intiateModuleExportCards(mode),pageId.find("#moduleheader span").text(ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.goalDispName])),pageId.find("#moduleheader").attr("title",ZPI18N.getString("zp.leave.report.leavedetails",[PMSExport.goalDispName])),moduleDesc=ZPI18N.getString("zp.pa.export.compcyclebacupdesc"),pageId.find("#moduleexpdesc").text(constructExportDesc(moduleDesc)),pageId.find("#moduleexpdesc").attr("title",moduleDesc)),pageId.find("#module button").click(function(){AppraisalConfig.formUtil.getformDetails(modeForm),PMSExport.showExportSlider(mode);let isPasswordProtected=PMS_MOD_Export.isPasswordProtected(modeForm),popDiv=$("#card"+PMSExport.EXPORTSLIDERID);popDiv.html(""),popDiv.append(PMSExport.cardExportType(isPasswordProtected)),"goal"==mode&&(popDiv.append(PMSExport.exportTubularSection()),popDiv.append(PMSExport.employeeSelect()),PMSOperationCommon.populateUsers("employees_sel",null,{maxAllowedValues:25},!0,popDiv,"token",!1,popDiv)),isPasswordProtected&&$(popDiv).find("#expFormat_xlsx").prop("checked",!0)}),pageId.find("#moduleuserexport button").click(function(){AppraisalConfig.formUtil.getformDetails(modeUserForm),PMSExport.showExportSlider(modeUserForm);let popDiv=$("#card"+PMSExport.EXPORTSLIDERID);popDiv.html(""),popDiv.append(PMSExport.cardExportType()),"goal"==mode&&popDiv.append(PMSExport.exportTubularSection()),popDiv.append(PMSExport.employeeSelect()),PMSOperationCommon.populateUsers("employees_sel",null,{maxAllowedValues:25},!0,popDiv,"token",!1,popDiv)})}else void 0!==data.msg&&"Performance module is disabled"===data.msg||!data.isPerfTabEnb?pageId.html(ZPI18N.getString("zp.tabdisabled",[ZPI18N.getString("zp.performance")])):pageId.html(ZPI18N.getString("zp.permissiondeniedtoaccessthispage"));else"Performance module is disabled"===data.msg&&pageId.html(ZPI18N.getString("zp.tabdisabled",[ZPI18N.getString("zp.performance")]))})}},cardExportType:function(ispasswordProtectedFile){let ispasswordProtected=void 0!=ispasswordProtectedFile&&ispasswordProtectedFile,_htm="";return _htm+='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn "><div><h5>'+ZPI18N.getString("zp.assessment.exportas")+"</h5></div>",_htm+="<div>",ispasswordProtected||(_htm+='<div class="zradiobutton zradiobutton--horizontal">',_htm+='<input type="radio" name="zp_ftype" id="expFormat_xls" class="zradiobutton__helper" checked="" value="xls">',_htm+='<label for="expFormat_xls" class="zradiobutton__label">',_htm+='<span class="zradiobutton__text"> '+ZPI18N.getString("zp.xls")+" </span></label></div>"),_htm+='<div class="zradiobutton zradiobutton--horizontal">',_htm+='<input type="radio" id="expFormat_xlsx" name="zp_ftype" class="zradiobutton__helper" value="xlsx">',_htm+='<label for="expFormat_xlsx" class="zradiobutton__label">',_htm+='<span class="zradiobutton__text">'+ZPI18N.getString("zp.xlsx")+"</span></label></div>",ispasswordProtected||(_htm+='<div class="zradiobutton zradiobutton--horizontal">',_htm+='<input id="expFormat_csv"type="radio" name="zp_ftype" class="zradiobutton__helper" value="csv">',_htm+='<label for="expFormat_csv" class="zradiobutton__label">',_htm+='<span class="zradiobutton__text">'+ZPI18N.getString("zp.csv")+"</span></label></div>",_htm+='<div class="zradiobutton zradiobutton--horizontal"><input id="expFormat_tsv" type="radio" name="zp_ftype" class="zradiobutton__helper" value="tsv">',_htm+='<label for="expFormat_tsv" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.tsv")+"</span></label>",_htm+="</div></div></div></div></div>"),_htm},cardAllORFINALtype:function(configId){let hasMultilevel=!1;if(paCommonUtil.isManageAppraisalPAImportExport()){const{_mode:_mode}=AppraisalView.getAppraisalViewMode();AppraisalView[_mode].reviewlevel>1&&(hasMultilevel=!0)}else for(let i in PMSExport.configurationData)PMSExport.configurationData[i].configId==configId&&void 0!=PMSExport.configurationData[i].nooflevels&&PMSExport.configurationData[i].nooflevels>1&&(hasMultilevel=!0);if(hasMultilevel){let _htm='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn "><div><h5>'+ZPI18N.getString("zp.choosereview")+"</h5></div>";return _htm+="<div>",_htm+='<div class="zradiobutton zradiobutton--horizontal">',_htm+='<input type="radio" name="zp_reviewtype" id="appraisalExportallrecord" class="zradiobutton__helper" checked="" value="allRecord">',_htm+='<label for="appraisalExportallrecord" class="zradiobutton__label">',_htm+='<span class="zradiobutton__text"> '+ZPI18N.getString("zp.alllevelreview")+" </span></label></div>",_htm+='<div class="zradiobutton zradiobutton--horizontal">',_htm+='<input type="radio" name="zp_reviewtype" id="appraisalExportfinalrecord" class="zradiobutton__helper" checked="" value="finalReview">',_htm+='<label for="appraisalExportfinalrecord" class="zradiobutton__label">',_htm+='<span class="zradiobutton__text"> '+ZPI18N.getString("zp.finallevelreview")+" </span></label></div>",_htm+="</div></div></div></div>"}return""},exportTubularSection:function(){let _htm='<div class="zpl_crd" id="zp_export_inctabularsec"><div class="zpl_crdcnt"><div class="zpl_secn ">';return _htm+="<div><h5>Tabular Section</h5></div>",_htm+='<div><div class="zcheckbox"><input id="inctabularsec" type="checkbox" name="check" class="zcheckbox__helper">',_htm+='<label for="inctabularsec" class="zcheckbox__label">'+ZPI18N.getString("zp.includetabulardata")+"</label>",_htm+="</div></div> </div></div></div>"},showExportSlider:function(module,config_id){PMSExport.exportslider=new sliderModal(ZPI18N.getString("zp.assessment.exportas"),new Tab(PMSExport.EXPORTSLIDERID,function(){},function(){void 0!=$(PMSExport.exportslider.sliderDiv).find("input[name=zp_ftype]:checked").val()&&("KRA"==module?PMSExport.exportModuleData("kraForm"):"COMPETENCY"==module?PMSExport.exportModuleData("competency_form"):"SKILL"==module?PMSExport.exportModuleData("skillform"):"appraisal_form"==module||"multiraterform"==module||"selfappraisal"==module||"teambudgetform"==module?PMSExport.exportData(module,config_id):"kraUserform"!=module&&"competencyUserform"!=module&&"userSkillMap"!=module&&"goal"!=module||PMSExport.exportModuleUserData(module))})),PMSExport.exportslider.save=ZPI18N.getString("zp.proceed"),PMSExport.exportslider.setCloseCallback(function(){let popDiv=$("#card"+PMSExport.EXPORTSLIDERID);ZPeopleComponents.isComponent(popDiv.find("#employees_sel"))&&ZPeopleComponents.tokenfield(popDiv.find("#employees_sel")).destroy(),ZPeopleComponents.isComponent(popDiv.find("#appraiser_sel"))&&ZPeopleComponents.select(popDiv.find("#appraiser_sel")).destroy(),PMSExport.fieldarr=[],PMSExport.exportslider.remove(),PMSExport.exportslider={}}),PMSExport.exportslider.construct()},exportModuleData:function(mode){let sliderObj=$(PMSExport.exportslider.sliderDiv),frmId="",viewid="",formElm=document.createElement("form");formElm.id="exp_form",formElm.name="ExportForm";let path="",ftype=sliderObj.find("input[name=zp_ftype]:checked").val(),includeTabular=sliderObj.find("#zp_export_inctabularsec").find("input[type=checkbox]").prop("checked");path="ExportData.do?approvalStatus=all&ftype="+ftype,"kraForm"==mode?(path+="&hrmsform="+(frmId=AppraisalConfig.formUtil.kraformDtl.formId)+"&viewID="+(viewid=AppraisalConfig.formUtil.kraformDtl.viewId),path+="&selectedView=kra"):"competency_form"==mode?path+="&hrmsform="+(frmId=AppraisalConfig.formUtil.competencyformDtl.formId)+"&viewID="+(viewid=AppraisalConfig.formUtil.competencyformDtl.viewId):"skillform"==mode?path+="&hrmsform="+(frmId=AppraisalConfig.formUtil.skillsformDtl.formId)+"&viewID="+(viewid=AppraisalConfig.formUtil.skillsformDtl.viewId):"goal"==mode&&(path+="&hrmsform="+(frmId=AppraisalConfig.formUtil.goalFormDtl.formId)+"&viewID="+(viewid=AppraisalConfig.formUtil.goalFormDtl.viewId)),(null==includeTabular||0!=includeTabular&&1!=includeTabular)&&(includeTabular=!1),path+="&typeOfView=all&includeTabular="+includeTabular;let inputval=document.createElement("input");formElm.setAttribute("target","exportresp"),formElm.setAttribute("method","post"),formElm.setAttribute("action",path),inputval.setAttribute("type","hidden"),inputval.setAttribute("name",csrfParamName),inputval.setAttribute("value",csrfToken),formElm.appendChild(inputval),document.body.appendChild(formElm),formElm.submit(),formElm.reset(),PMSExport.exportslider.close()},empAfterTokenAdd:function(){let sliderObj=$(PMSExport.exportslider.sliderDiv);sliderObj.find("#empselerr").hide(),ZPeopleComponents.isComponent(sliderObj.find("#employees_sel"))&&ZPeopleComponents.tokenfield(sliderObj.find("#employees_sel")).setAttributes({className:""})},exportModuleUserData:function(mode){let sliderObj=$(PMSExport.exportslider.sliderDiv);sliderObj.find("#empselerr").hide(),ZPeopleComponents.isComponent(sliderObj.find("#employees_sel"))&&(ZPeopleComponents.tokenfield(sliderObj.find("#employees_sel")).setAttributes({className:""}),sliderObj.find("#employees_sel").on("ztokenfieldtokenadd",PMSExport.empAfterTokenAdd),sliderObj.find("#employees_sel").on("ztokenfieldtokenremove",PMSSetting.empAfterTokenAdd));let frmId="",viewid="",formElm=document.createElement("form");formElm.id="exp_form",formElm.name="ExportForm";let path="",ftype=sliderObj.find("input[name=zp_ftype]:checked").val(),includeTabular=sliderObj.find("#zp_export_inctabularsec").find("input[type=checkbox]").prop("checked");path="ExportData.do?approvalStatus=all&ftype="+ftype,"userSkillMap"==mode&&(path="selfappraisalExport.zp?submode=alluserskill&ftype="+ftype),"kraUserform"==mode?(path+="&hrmsform="+(frmId=AppraisalConfig.formUtil.kraUsrformDtl.formId)+"&viewID="+(viewid=AppraisalConfig.formUtil.kraUsrformDtl.viewId),path+="&filtermode=KRAuser"):"competencyUserform"==mode?(path+="&hrmsform="+(frmId=AppraisalConfig.formUtil.competencyUsrformDtl.formId)+"&viewID="+(viewid=AppraisalConfig.formUtil.competencyUsrformDtl.viewId),path+="&filtermode=Competencyuser"):"goal"==mode&&(path+="&hrmsform="+(frmId=AppraisalConfig.formUtil.goalFormDtl.formId)+"&viewID="+(viewid=AppraisalConfig.formUtil.goalFormDtl.viewId),path+="&filtermode=Goals&status=1&configId=-1"),(null==includeTabular||0!=includeTabular&&1!=includeTabular)&&(includeTabular=!1),"userSkillMap"!=mode&&(path+="&typeOfView=all&includeTabular="+includeTabular),ZPeopleComponents.tokenfield($(sliderObj).find("#employees_sel")).getAllValues().length>0?path+="&employeeArr="+encodeURIComponent(JSON.stringify(PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield($(sliderObj).find("#employees_sel")).getAllValues()))):"kraUserform"!=mode&&"goal"!=mode&&"competencyUserform"!=mode&&"userSkillMap"!=mode||(path+="&isAllData=true");let inputval=document.createElement("input");formElm.setAttribute("target","exportresp"),formElm.setAttribute("method","post"),formElm.setAttribute("action",path),inputval.setAttribute("type","hidden"),inputval.setAttribute("name",csrfParamName),inputval.setAttribute("value",csrfToken),formElm.appendChild(inputval),document.body.appendChild(formElm),formElm.submit(),formElm.reset(),PMSExport.exportslider.close()},dataRadioHtml:function(){let _htm='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn ">';return _htm+="<div><h5>Which data has to be exported</h5></div>",_htm+='<div><div class="zradiobutton zradiobutton--horizontal">',_htm+='<input type="radio" id="myDataExprt" checked="" class="zradiobutton__helper">',_htm+='<label for="myDataExprt" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.mydata")+"</span></label></div>",_htm+='<div class="zradiobutton zradiobutton--horizontal"><input type="radio" id="allDataExprt" class="zradiobutton__helper">',_htm+='<label for="allDataExprt" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.allaccessibledata")+"</span>",_htm+="</label></div></div> </div></div></div>"},employeeSelect:function(){let _htm='<div class="zpl_crd" id="zp_export_employee"><div class="zpl_crdcnt"><div class="zpl_secn ">';return _htm+="<div><h5>"+ZPI18N.getString("zp.employee")+"</h5></div>",_htm+='<div class="w300"><textarea id="employees_sel" searchmode="PA_PEERSVIEW" style="display: none;"></textarea><span class="ztextbox--error__label" id="empselerr" style="display : none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div> </div></div></div>"},paFormemployeeSelect:function(){let _htm='<div class="zpl_crd" id="zp_export_paform_employee"><div class="zpl_crdcnt"><div class="zpl_secn ">';return _htm+="<div><h5>"+ZPI18N.getString("zp.employee")+"</h5></div>",_htm+='<div class="w300"><textarea id="employees_sel" searchmode="PA_APPRAISALREVIEW" style="display: none;"></textarea><span class="ztextbox--error__label" id="empselerr" style="display : none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div> </div></div></div>"},paFormAppraiseeSelect:function(){let _htm='<div class="zpl_crd" id="zp_export_paform_appraiser"><div class="zpl_crdcnt"><div class="zpl_secn ">';return _htm+="<div><h5>"+ZPI18N.getString("zp.reviewer")+"</h5></div>",_htm+='<div class="w300"><textarea id="appraiser_sel" searchmode="APPRAISALREVIEWMANG" style="display: none;"></textarea><span class="ztextbox--error__label" id="apprselerr" style="display : none">'+ZPI18N.getString("zp.plsselectvalues")+"</span></div> </div></div></div>"},allFiledsHtmlContainer:function(){let _htm='<div class="zpl_crd" id="zp_export_inctabularsec"><div class="zpl_crdhdr zpl_crdhdrcnt">';return _htm+='<div> <div class="zpl_idiv"><b>'+ZPI18N.getString("zp.selectfieldtoexport")+"</b></div> </div> <div>",_htm+='<div class="zpl_search zpl_srchsml w300"> <input id="appraiseefieldssearch" placeholder="'+ZPI18N.getString("zp.search")+'" type="text" class="ztextbox" onkeyup="PMSExport.searchAppraiseeFields(this)"> <i class="PI_lens"></i> </div> </div> </div>',_htm+='<div class="zpl_crdcnt"> <div class="zpl_tblres"> <table class="zpl_tbl wd100_per"> <thead> <tr> <th width="40"> <div class="zcheckbox"> <input id="appraisalfield_all" type="checkbox" name="check" class="zcheckbox__helper" onchange="PMSExport.enablefieldscheckbox(this,false);"> <label for="appraisalfield_all" class="zcheckbox__label"></label> </div> </th> <th>Field Name</th> </tr> </thead>',_htm+='<tbody id="appraisalfield_list"></tbody>',_htm+="</table></div></div></div>"},searchAppraiseeFields:function(key){let popDiv=$("#card"+PMSExport.EXPORTSLIDERID),strval=$(key).val();strval=strval.trim();let arr=PMSOperation.SearchComponent(PMSExport.appraisalfields,strval,"comp_dispname");popDiv.find("#appraisalfield_list").html(""),$.each(arr,function(index,data){popDiv.find("#appraisalfield_list").append('<tr id="'+data.comp_id+'"> <td> <div class="zcheckbox"> <input id="appfield_'+data.comp_id+'" type="checkbox" name="check" class="zcheckbox__helper" onchange="PMSExport.enablefieldscheckbox(this,true);"> <label for="appfield_'+data.comp_id+'" class="zcheckbox__label"></label> </div> </td> <td><span>'+data.comp_dispname+"</span></td> </tr>");for(let i in PMSExport.fieldarr)if(PMSExport.fieldarr[i]==data.comp_id){popDiv.find("#"+data.comp_id+" input[type=checkbox]").prop("checked",!0);break}})},exportAppraisalData:function(mode,config_id){AppraisalConfig.formUtil.getformDetails(mode),PMSExport.showExportSlider(mode,config_id);let popDiv=$("#card"+PMSExport.EXPORTSLIDERID);popDiv.append(ZPeople.LOADING_HTML);let isPasswordProtected=PMS_MOD_Export.isPasswordProtected(mode);"multiraterform"==mode||"selfappraisal"==mode?(popDiv.html(""),popDiv.append(PMSExport.cardExportType(isPasswordProtected)),popDiv.append(PMSExport.exportTubularSection())):"teambudgetform"==mode?(popDiv.html(""),popDiv.append(PMSExport.cardExportType(isPasswordProtected))):"appraisal_form"==mode&&$.post(PMSCommon.PERFORMANCE_CONFIG_URL,{mode:"getappraisalfields",conreqcsr:csrfToken,submode:"export",viewId:AppraisalConfig.formUtil.performanceappFormDtl.viewId},function(resultData){void 0!=resultData.appraisalfields&&(resultData.appraisalfields.length>0&&(PMSExport.appraisalfields=resultData.appraisalfields),void 0!=resultData.relatedFileds&&(PMSExport.relatedfiledarr=resultData.relatedFileds),void 0!=resultData.appFormCompId&&(PMSExport.appraiseeRefFormCompId=resultData.appFormCompId),popDiv.html(""),popDiv.append(PMSExport.cardExportType(isPasswordProtected)),popDiv.append(PMSExport.cardAllORFINALtype(config_id)),paCommonUtil.isManageAppraisalPAImportExport()&&(popDiv.append(PMSExport.paFormemployeeSelect()),PMSOperationCommon.populateUsers("employees_sel",null,{maxAllowedValues:25},!0,popDiv,"token",!1,popDiv),popDiv.append(PMSExport.paFormAppraiseeSelect()),PMSOperationCommon.populateUsers("appraiser_sel",null,{defaultText:ZPI18N.getString("zp.select")},!1,popDiv,"select",!1,popDiv)),popDiv.append(PMSExport.allFiledsHtmlContainer()),$.each(PMSExport.appraisalfields,function(index,data){popDiv.find("#appraisalfield_list").append('<tr id="'+data.comp_id+'"> <td> <div class="zcheckbox"> <input id="appfield_'+data.comp_id+'" type="checkbox" name="check" class="zcheckbox__helper" onchange="PMSExport.enablefieldscheckbox(this,true);"> <label for="appfield_'+data.comp_id+'" class="zcheckbox__label"></label> </div> </td> <td><span>'+data.comp_dispname+"</span></td> </tr>")}),isPasswordProtected&&$(popDiv).find("#expFormat_xlsx").prop("checked",!0))}),isPasswordProtected&&$(popDiv).find("#expFormat_xlsx").prop("checked",!0)},enablefieldscheckbox:function(obj,singlechk){let popDiv=$("#card"+PMSExport.EXPORTSLIDERID),tempArr=new Array;if(singlechk){let numberOfChecked=popDiv.find("#appraisalfield_list input:checkbox:checked").length,numberNotChecked=popDiv.find("#appraisalfield_list input:checkbox").length-numberOfChecked;if($(obj).prop("checked")){if(PMSExport.fieldarr.push($(obj).attr("id").split("_")[1]),PMSExport.appraiseeRefFormCompId===$(obj).attr("id").split("_")[1])for(let i=0;i<PMSExport.relatedfiledarr.length;i++)PMSExport.fieldarr.push(PMSExport.relatedfiledarr[i]);0!=numberNotChecked||popDiv.find("#appraisalfield_all").prop("checked")||popDiv.find("#appraisalfield_all").prop("checked",!0)}else{if(0!=numberNotChecked&&popDiv.find("#appraisalfield_all").prop("checked")&&popDiv.find("#appraisalfield_all").prop("checked",!1),PMSExport.appraiseeRefFormCompId===$(obj).attr("id").split("_")[1])for(let i=0;i<PMSExport.relatedfiledarr.length;i++)PMSExport.fieldarr.pop(PMSExport.relatedfiledarr[i]);for(let i=0;i<PMSExport.fieldarr.length;i++)PMSExport.fieldarr[i]!=$(obj).attr("id").split("_")[1]&&tempArr.push(PMSExport.fieldarr[i]);PMSExport.fieldarr=tempArr}}else if(PMSExport.fieldarr=new Array,$(obj).prop("checked")){$(popDiv.find("#appraisalfield_list input")).each(function(){$(this).prop("checked",!0),PMSExport.fieldarr.push($(this).attr("id").split("_")[1])});for(let i=0;i<PMSExport.relatedfiledarr.length;i++)PMSExport.fieldarr.push(PMSExport.relatedfiledarr[i])}else $(popDiv.find("#appraisalfield_list input")).each(function(){$(this).prop("checked",!1)})},exportData:function(mode,config_id){let sliderObj=$("#card"+PMSExport.EXPORTSLIDERID),frmId="",viewid="",formElm=document.createElement("form");formElm.id="exp_form",formElm.name="ExportForm";let path="",finalrecordOnly=!1,ftype=sliderObj.find("input[name=zp_ftype]:checked").val(),includeTabular=sliderObj.find("#zp_export_inctabularsec input[type=checkbox]").prop("checked");if(void 0==includeTabular&&(includeTabular=!1),path="ExportData.do?approvalStatus=all&ftype="+ftype,"appraisal_form"===mode){if(frmId=AppraisalConfig.formUtil.performanceappFormDtl.formId,viewid=AppraisalConfig.formUtil.performanceappFormDtl.viewId,null!=PMSExport.fieldarr&&PMSExport.fieldarr.length>0&&(path+="&selectedfields="+PMSExport.fieldarr),sliderObj.find("#appraisalExportfinalrecord").length>0&&"finalReview"==sliderObj.find("input[name=zp_reviewtype]:checked").val()&&(finalrecordOnly=!0),path+="&isFinalRecordOnly="+finalrecordOnly,"performance_appraisal_userlisting"==Layout.Page.urlmode){let fromexp=ZPeopleComponents.select(Layout.Page.container.find("#exp_from")).getValue(),toexp=ZPeopleComponents.select(Layout.Page.container.find("#exp_to")).getValue(),empIds=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(Layout.Page.container.find("#employees_sel")).getAllValues()),searchStr=0==empIds.length?["-1"]:empIds,caGrpId=null;ZPeopleComponents.isComponent(Layout.Page.container.find("#applicableType"))&&(caGrpId=ZPeopleComponents.select(Layout.Page.container.find("#applicableType")).getValue());let status=ZPeopleComponents.select(Layout.Page.container.find("#appraisalStatus_sel")).getValue(),managerId=erecno,configIds=ZPeopleComponents.select(Layout.Page.container.find("#configuration_sel")).getValue();null!=managerId&&void 0!=managerId&&""!=managerId&&"-1"!=managerId&&(path+="&managerId="+managerId),null!=configIds&&void 0!=configIds&&""!=configIds&&"-1"!=configIds&&(path+="&configId="+configIds),void 0!=searchStr&&null!=searchStr&&""!=searchStr&&"-1"!=searchStr&&empIds.length>0&&(path+="&employeeArr="+encodeURIComponent(JSON.stringify(searchStr))),null!=status&&void 0!=status&&""!=status&&(path+="&status="+status),null!=fromexp&&void 0!=fromexp&&""!=fromexp&&"-1"!=fromexp&&(path+="&fromexp="+fromexp),null!=toexp&&void 0!=toexp&&""!=toexp&&"-1"!=toexp&&(path+="&toexp="+toexp),null!=caGrpId&&void 0!=caGrpId&&""!=caGrpId&&(path+="&customAdminGrpId="+caGrpId),path+="&filtermode=fromAppraiseeView",path+="&isModuleReportNeeded=true"}else if(paCommonUtil.isManageAppraisalPAImportExport()){let empIds=PMSOperation.iterateTokenFieldValues(ZPeopleComponents.tokenfield(Layout.Page.container.find("#employees_sel")).getAllValues()),searchStr=0==empIds.length?["-1"]:empIds;void 0!=searchStr&&null!=searchStr&&""!=searchStr&&"-1"!=searchStr&&empIds.length>0&&(path+="&employeeArr="+encodeURIComponent(JSON.stringify(searchStr)));let managerId=ZPeopleComponents.select(Layout.Page.container.find("#appraiser_sel")).getValue();null!=managerId&&void 0!=managerId&&""!=managerId&&"-1"!=managerId&&(path+="&managerId="+managerId)}}else"multiraterform"==mode?(frmId=AppraisalConfig.formUtil.multiraterDtl.formId,viewid=AppraisalConfig.formUtil.multiraterDtl.viewId,path+="&filtermode=PAMultirater",path+="&status=5"):"selfappraisal"==mode?(frmId=AppraisalConfig.formUtil.selfappFormDtl.formId,viewid=AppraisalConfig.formUtil.selfappFormDtl.viewId):"teambudgetform"==mode&&(frmId=AppraisalConfig.formUtil.teambudgetformDtl.formId,viewid=AppraisalConfig.formUtil.teambudgetformDtl.viewId,path+="&filtermode=AppraisalReport",path+="&status=1");if(path+="&hrmsform="+frmId+"&viewID="+viewid,"performance_appraisal_userlisting"==Layout.Page.urlmode)path+="&typeOfView=all&includeTabular="+includeTabular;else if(paCommonUtil.isManageAppraisalPAImportExport()){path+="&ispaStatusReport=true&repType=adminReports";let empStatus=["19"];path+="&empStatusArr="+encodeURIComponent(JSON.stringify(empStatus)),path+="&configId="+config_id+"&typeOfView=all&includeTabular=true&isModuleReportNeeded=true"}else{path+="&ispaStatusReport=true&repType=adminReports";let empStatus=["19"];path+="&empStatusArr="+encodeURIComponent(JSON.stringify(empStatus)),path+="&configId="+config_id+"&typeOfView=all&includeTabular="+includeTabular}let inputval=document.createElement("input");formElm.setAttribute("target","exportresp"),formElm.setAttribute("method","post"),formElm.setAttribute("action",path),inputval.setAttribute("type","hidden"),inputval.setAttribute("name",csrfParamName),inputval.setAttribute("value",csrfToken),formElm.appendChild(inputval),document.body.appendChild(formElm),formElm.submit(),formElm.reset(),PMSExport.exportslider.close()}};