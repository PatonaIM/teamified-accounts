var ZPA_Esign={templateEdit:!1,formId:null,zsignCompatibleExtns:"pdf, jpg, jpeg, doc, docx, png, odf, rtf, dotx, txt, tex, sxw",recpRowId:0,managerAdded:!1,IS_LOADED:!1,tabNumList:[],ZSignTempList:[],fileNameList:new Set,initPage:function(formId){if(!ZPA_Esign.IS_LOADED){var pageId=ZPA_Common.getParentPageId();ZPA_Common.Loader.appendPageLoading(pageId);var body='<div name="action_body" class="zpl_tblres"><table class="zpl_tbl"><thead><tr><th width="400">'+ZPI18N.getString("zp.name")+"</th><th>"+ZPI18N.getString("zp.esign.formname")+'</th><th width="80"></th></tr></thead><tbody>';pageId.children("[name=action_body]").remove(),pageId.find("[id=emptPage]").remove(),void 0!=formId&&""!=formId&&(settingsUrlProps.niceUrl.lastIndexOf("/workflow")>-1?formId=ZPeopleComponents.select("#"+ZPA_Common.getFormListId(ZP_Automation_Mode.WORKFLOW)).getValue():settingsUrlProps.niceUrl.lastIndexOf("/esign")>-1&&(formId=ZPeopleComponents.select("#"+ZPA_Common.getFormListId(ZP_Automation_Mode.ESIGN)).getValue())),formId=void 0!=formId&&""!=formId?formId:0;var serviceName=ZPA_Common.getServiceName();if(void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),isZSConfig){var params={formId:formId,conreqcsr:csrfToken};serviceName!=ZPA_Common.COMMON_SERVICE&&(params.serviceName=serviceName),$.post("/zpzsign/getEsignConfigTemplates",params,function(data){if(0==data[1].length){settingsPage.container.find("#add_esign").hide();var emptyPageObj=new EmptyPages(ZPA_Common.getEmptyPageIcon(ZP_Automation_Mode.ESIGN),ZPA_Common.getEmptyPageTitle(ZP_Automation_Mode.ESIGN),ZPA_Common.getEmptyPageDesc(ZP_Automation_Mode.ESIGN),pageId.find(".zpl_rgtcnt"));emptyPageObj.setButton(ZPI18N.getString("zp.add")+" "+ZPI18N.getString("zp.esign.wf.tabname"),ZPA_Esign.add),ZPA_Common.Loader.removePageLoading(pageId),emptyPageObj.show()}else pageId.find("#emptPage").remove(),data=data[1],$.each(data,function(index,row){body+="<tr onclick=\"ZPA_Esign.edit('"+this.cid+"', '"+this.fid+'\')" cid="'+this.cid+'" formid="'+this.fid+'"><td><span>'+row.name+"</span></td><td><span>"+row.fname+'</span></td><td width="10%"><div class="zpl_hvr"><i action="delete" title="'+ZPI18N.getString("zp.delete")+'" data-title-display-type="callout" class="PI_delete" recordId="'+this.cid+'"  onclick="ZPA_Common.deleteConfirmationPopup(this, \'esign\' , Zsign.deleteEsignConfig)"></i></div></td></tr>'}),body+="</tbody></table></div>",ZPA_Common.Loader.removePageLoading(pageId),settingsPage.container.find("#add_esign").show(),pageId.append(body);ZPA_Esign.IS_LOADED=!0})}else if(!isDocuConfig&&!isAdobeConfig){pageId.append('<div class="zpl_rgtcnt"><div class="zpl_tblres"><div id="configureZsignIcon"></div></div></div>');var emptyhtml=new EmptyPages("zp_nd_integration",ZPI18N.getString("zp.automation.addesignbuttontext"),"",settingsPage.container.find("#configureZsignIcon"));emptyhtml.buttonName=ZPI18N.getString("zp.automation.addesignbuttontext"),emptyhtml.btnCallback=function(){window.location.href=window.location.href.substring(0,window.location.href.lastIndexOf("#")+1)+"settings/service/marketplace/zohoapplications"},ZPA_Common.Loader.removePageLoading(pageId),emptyhtml.show()}}},localUpload:function(){var inputElement=document.getElementById("uploadESFile");$(inputElement).off("change").on("change",function(e){var filename=this.value;filename=filename.replace("C:\\fakepath\\",""),ZPA_Esign.fileUploadList=this.files[0],ZPA_Esign.uploadMode="localUpload",ZPA_Esign.attachmentConstructor(ZPA_Esign.fileUploadList)}),$(inputElement).trigger("click")},cloudUpload:function(){ZPA_Esign.resetuploadValues(),CloudPicker.init("",ZPA_Esign.attachmentConstructor,"esign"),CloudPicker.construct(),ZPA_Esign.uploadMode="cloud"},openFilter:function(formData){Zsign.folderList.length<=0?$.ajax({url:"/fileCabinetAction.zp",type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){if(Zsign.isCachedCatList=!1,Zsign.folderList.length<=0){var list=resultData[1];list.unshift({CatID:"-1",CatName:ZPI18N.getString("zp.select")}),Zsign.folderList=list,$.each(resultData[1],function(index,categoriesObj){Zsign.folderListObj[categoriesObj.CatID]=categoriesObj.CatName})}Zsign.isfromFormReport?Zsign.Forms.createFolderComp():ZPA_Esign.createFolderComp()}}):Zsign.isfromFormReport?Zsign.Forms.createFolderComp():ZPA_Esign.createFolderComp()},getPageIdForFolder:function(){return"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")?$("#esignorg_card"):"tab-files-esigndocuments"==settingsPage.container[0].id?$("#esign_card"):void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):"0"==FilesUtil.Page.getTabGroup()?$("#cardesignfiles"):Zsign.isfromFormReport?$(settingsPage.mainWrapId):$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId)},createFolderComp:function(){var createAgr=ZPA_Esign.getPageIdForFolder();0==createAgr.length&&"tab-files-esigndocuments"==settingsPage.container[0].id&&(createAgr=$("#zsignPageFlt"));var tokenObj={options:Zsign.folderList,dataMapping:{label:"CatName",value:"CatID"},showSearchField:!0,isLabelHTMLEncoded:!0,dropdownList:{appendTo:createAgr,fitForElement:!0,moveOnScroll:!0,isTextHTMLEncoded:!0},bodyItemVisibleCount:3,viewPerPage:4,lazyLoading:!0};if(createAgr.find("#agrselect_Cat").length>0){ZPeopleComponents.isComponent("#agrselect_Cat")&&ZPeopleComponents.select($("#agrselect_Cat")).destroy(),ZPeopleComponents.select(createAgr.find("#agrselect_Cat"),tokenObj);var btnId="agrselect_Cat_AddNewCatBtn";ZPeopleComponents.isComponent("#"+btnId)&&ZPeopleComponents.button($("#"+btnId)).destroy(),ZPeopleComponents.select(createAgr.find("#agrselect_Cat")).addOption({innerHTML:"<button id='"+btnId+"' class='zlabel zlabel--blue zlabel--outline zlabel--medium zpl_btncnt'>"+ZPI18N.getString("zp.addcat")+"</button>",isFooter:!0}),ZPeopleComponents.button($("#"+btnId),{click:FilesUtil.FolderModel.addEditFolder})}else ZPeopleComponents.isComponent("#search_cat")||ZPeopleComponents.select(settingsPage.container.find("#search_cat"),tokenObj)},setNewFolderValInSelect:function(val,CatName){if(null!=val&&void 0!=val&&""!=val&&-1!=val){var createAgr=ZPA_Esign.getPageIdForFolder(),options=[{CatName:CatName,CatID:val}];ZPeopleComponents.select(createAgr.find("#agrselect_Cat")).addOption(options),ZPeopleComponents.select(createAgr.find("#agrselect_Cat")).setValue(val),Zsign.folderList.push({options:options})}},updateFolderList:function(){Zsign.folderList=[];var createAgr=ZPA_Esign.getPageIdForFolder();if(ZPeopleComponents.isComponent(createAgr.find("#agrselect_Cat"))){ZPeopleComponents.select(createAgr.find("#agrselect_Cat")).destroy();var formData=new FormData;formData.append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),ZPA_Esign.openFilter(formData)}},setFormTemplates:function(cJson){var pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId),templateJArray=cJson.messageTemplateJArray,selectObj=pageId.find("#fTempOpt");if(ZPeopleComponents.isComponent("#fTempOpt")&&ZPeopleComponents.select(selectObj).removeAllOptions(),$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("select#fTempOpt").length>0){$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("select#fTempOpt").on("zselectchange",Zsign.templateChangeAct);var messtknObj={options:ZPA_Esign.constructMMTempListJSON(templateJArray),dataMapping:{label:"label",value:"value",id:"id",text:"text"},showSearchField:!0,isLabelHTMLEncoded:!0,dropdownList:{appendTo:$("#esignThirdBdyCont"),fitForElement:!0,moveOnScroll:!0,isTextHTMLEncoded:!0}};ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("select#fTempOpt"),messtknObj),void 0!=cJson.templateId&&ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("select#fTempOpt")).setAttribute("selectedValue",cJson.templateId),Zsign.templateChangeAct()}},lookupopt:function(LookupList,params,LookupId){ZPA_Esign.LookupList=LookupList[1];var createAgr="";createAgr=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId),$.each(LookupList,function(key,value){ZPSetupCommon.isEmpty(LookupId)||(ZPeopleComponents.select(createAgr.find("select#hrfileopt")).addOption(ZPA_Esign.fetchEmpLookup()),ZPeopleComponents.select(createAgr.find("select#hrfileopt")).setAttribute("selectedValue",LookupId),createAgr.find("#optotherbtn").attr("Checked","Checked"),createAgr.find("#hrfileoptdiv").removeClass("DNI"))})},constructFormFieldsJSON:function(dataObj,noSelect){var option=[{id:"-1",fileId:"-1",value:"-1",label:ZPI18N.getString("zp.select")}];return void 0!=noSelect&&""!=noSelect&&null!=noSelect&&1==noSelect&&(option=[]),ZPSetupCommon.isEmpty(dataObj)||Object.keys(dataObj).length>0&&$.each(dataObj,function(value,label){option.push({label:label,value:value,id:value,fileId:value})}),option},fetchEmpLookup:function(){var formId="";formId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId?ZP5Form.getFormClassObj().getParams().formId:void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?ZP5Form.getCurrFormsOperation().formId:$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("select#fname").val(),void 0!=ZPA_Esign.LookupList&&""!=ZPA_Esign.LookupList&&(void 0==ZPA_Esign.LookupList&&""==ZPA_Esign.LookupList||formId==ZPA_Esign.LookupList.formId)||ZPeople.Request.sendAsyncPost("/fileCabinetAction.zp",{methodName:"getEsignCongifDtls",conreqcsr:csrfToken,formId:formId},ZPA_Esign.lookupopt);var lookuplist=ZPA_Esign.LookupList.emplookup,employeelookupOpt=[{id:"-1",value:"-1",label:ZPI18N.getString("zp.select")}];return $.each(lookuplist,function(value,label){employeelookupOpt.push({label:label,value:value})}),employeelookupOpt},dropHandler:function(ev){if(ev.preventDefault(),ev.dataTransfer.items)for(var i=0;i<ev.dataTransfer.items.length;i++)if("file"===ev.dataTransfer.items[i].kind){ZPA_Esign.uploadMode="localUpload",Zsign.fileUploadObj=ev.dataTransfer.items[i].getAsFile(),ZPA_Esign.attachmentConstructor(Zsign.fileUploadObj)}},attachmentConstructor:function(obj){var isFromAutomation=!1,pageId="";void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?pageId=$("#esignforms_card"):(pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId),isFromAutomation=!0);var fileName="",fileSize="",id="",source="",isAdd=!0,fileIcon="PI_file";if(void 0!=obj&&void 0!=obj.detail)isAdd="true"==$(obj.detail.item).attr("aria-selected"),fileName=obj.detail.itemData.label,id=obj.detail.itemData.value,void 0!=obj.detail.itemData.source?source=obj.detail.itemData.source:void 0!=obj.detail.itemData.tempId?(source="ztemplate",id=obj.detail.itemData.tempId,fileIcon="PI_Template"):void 0!=obj.detail.itemData.fileId?(source="fileupload",fileIcon="PI_file_upload"):void 0!=obj.detail.itemData.rid?(source="templates",fileIcon="PI_mail_merge"):void 0!=obj.detail.itemData.cloud&&(source="cloud",fileIcon="PI_cloud");else if("cloud"==ZPA_Esign.uploadMode){var fileObj=JSON.parse(CloudPicker.getFileObj());fileName=decodeURIComponent(fileObj.docName);source=ZPA_Esign.uploadMode,fileIcon="PI_cloud"}else void 0!=ZPA_Esign.uploadMode&&"localUpload"==ZPA_Esign.uploadMode?(source=ZPA_Esign.uploadMode,fileName=obj.name,void 0!=obj.size&&(fileSize=ZP_Mailmerge.bytesToSize(obj.size)),fileIcon="PI_desktop"):(fileName=obj.name,id=obj.id,"fileupload"==(source=obj.source)?fileIcon="PI_file_upload":"templates"==source?fileIcon="PI_mail_merge":"ztemplate"==source&&(fileIcon="PI_Template"));if(!isAdd){for(var eleSize=$("[name='fileOutDiv']").find(".zpl_atchdtl h4").length,q=0;q<eleSize;q++)if($($("[name='fileOutDiv']").find(".zpl_atchdtl h4")[q]).attr("selId")==id)if($("[name='fileOutDiv']").find(".zpl_atchdtl h4")[q].closest("[name='fileOutDiv']").remove(),ZPA_Esign.fileNameList.delete(fileName),"ztemplate"==source){if(0==pageId.find("#zsignTempAttac .zpl_atchd").find("div").length)return pageId.find("#zsignTempAttac").addClass("DN"),ZPA_Esign.Slider.removeMergeFields(),Zsign.recpRowsReset(),void(Zsign.zSignData="")}else if(0==pageId.find("#attachments .zpl_atchd").find("div").length)return pageId.find("#attachments").addClass("DN"),void $("#mailmergeInfo").remove();var eleList=$($("[name='fileOutDiv']").find(".zpl_atchdtl h4")),noOfTemp=0;return $.each(eleList,function(_index,ele){"templates"==$(ele).attr("source")&&(noOfTemp++,$("#mailmergeInfo").removeClass("DN"))}),void(eleList.length>0&&0==noOfTemp&&$("#mailmergeInfo").remove())}if(pageId.find("#uploadSection #errorMsg").length>0&&pageId.find("#uploadSection #errorMsg").remove(),void 0!=fileName){if(isAdd){if(ZPA_Esign.fileNameList.has(fileName)){$(pageId.find("#attachments .zpl_atchd").find("[name='fileOutDiv']"));return void ZPeople.Message.failure(ZPI18N.getString("zp.esign.duplicatefile",new Array(fileName)))}ZPA_Esign.fileNameList.add(fileName)}var html='<div name="fileOutDiv"><div class="zpl_atchimg"><i class="'+fileIcon+'"></i></div>';html+='<div class="zpl_atchdtl"><h4 id="fileName" data-toggle="tooltip" title="'+ZSEC.Encoder.encodeForHTML(fileName)+'" data-placement="bottom" source ="'+source+'" selId="'+id+'">'+ZSEC.Encoder.encodeForHTML(fileName)+'</h4><p><span id="fileSize">'+fileSize+"</span></p></div>",html+='<div class="zpl_atchicn"><i class="PI_delete" onclick="ZPA_Esign.deleteAttachment(this)"></i></div>'}if(isFromAutomation||(pageId.find("#uploadSection").children().eq(0).addClass("DN"),pageId.find("#uploadSection").children().eq(1).addClass("DN"),ZPA_Esign.resetFileErrorborder()),"ztemplate"==source&&pageId.find("#uploadSectionBody_zsigntemp").addClass("DNI"),pageId.find("#attachments #errorMsg").length>0&&pageId.find("#attachments #errorMsg").remove(),pageId.find("#zsignTempAttach #errorMsg").length>0&&pageId.find("#zsignTempAttach #errorMsg").remove(),!isFromAutomation&&(pageId.find("#attachments .zpl_atchd").find("[name=fileOutDiv]").length>0||pageId.find("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length>0))return($("#attachments .zpl_atchd").find("[name=fileOutDiv]").length>0||$("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length>0)&&("fileupload"==source?ZPeopleComponents.dropdownlist(document.getElementById("fileRoleOptionsList")).deselect({value:obj.detail.itemData.value}):"templates"==source?ZPeopleComponents.dropdownlist(document.getElementById("TemplateOptionsList")).deselect({id:obj.detail.itemData.value}):"ztemplate"==source&&ZPeopleComponents.dropdownlist(document.getElementById("zsignTempOptionsList")).deselect({id:obj.detail.itemData.tempId})),pageId.find("#attachments").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.onefileselection")+"</span>"),void pageId.find("#zsignTempAttach").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.onefileselection")+"</span>");if("ztemplate"==source)ZPA_Esign.getZSignTempValues(id),pageId.find("[name='recpName']").parent().removeClass("DN"),pageId.find("#zsignTempAttach").removeClass("DN"),pageId.find("#attachments").addClass("DN"),pageId.find("#uploadSectionBody").addClass("DNI"),pageId.find("#zsignTempAttach .zpl_atchd").append(html);else{if(pageId.find("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length>0){var selId=$($("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]")[0]).find(".zpl_atchdtl h4").attr("selId");ZPeopleComponents.dropdownlist("#zsignTempOptionsList").deselect({id:selId}),pageId.find("#zsignTempAttach").addClass("DN"),pageId.find("#uploadSectionBody").removeClass("DNI")}pageId.find("[name='recpName']").parent().addClass("DN"),pageId.find("#zsignTempAttach").addClass("DN"),pageId.find("#uploadSectionBody").removeClass("DNI"),isFromAutomation||pageId.find("#uploadSectionBody").addClass("DNI"),pageId.find("#attachments").removeClass("DN"),pageId.find("#attachments .zpl_atchd").append(html);var multiplefilesDetails=pageId.find("#attachments .zpl_atchd .zpl_atchdtl");if(0!=multiplefilesDetails.length)for(var j=0,l=multiplefilesDetails.length;j<l;j++)"cloud"==source?""!=!multiplefilesDetails[j].getAttribute("selId")&&$(multiplefilesDetails[j]).find("#fileName")[0].innerText==fileName&&$(multiplefilesDetails[j]).data("cloudfileDetails",fileObj):""!=!multiplefilesDetails[j].getAttribute("selId")&&$(multiplefilesDetails[j]).find("#fileName")[0].innerText==fileName&&(1==Object.keys(obj).length?$(multiplefilesDetails[j]).data("filename",obj):$(multiplefilesDetails[j]).data("filedetails",obj))}"templates"==source&&ZP_Mailmerge.getLicenseDetails(ZPA_Esign.setMMCreditInfoZsign)},setMMCreditInfoZsign:function(){$("#uploadSectionBody_zsigntemp").after(ZP_Mailmerge.creditsHtml($("#uploadSectionBody_zsigntemp").parent()))},resetZSTempValues:function(){var pageId;void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(pageId=$("#esignforms_card")).find("#document_name").val(""):(pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId),isFromAutomation=!0,$("#esbdy_tempdetail").length>0&&$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("#document_name").val(""),pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId)),pageId.find("#datefieldOptions").addClass("DNI"),pageId.find("#datefieldOptionscont").addClass("DNI"),pageId.find("#deadlinegrp").addClass("DNI"),pageId.find("#deadlineLabel").addClass("DNI"),pageId.find("#expiry_in_days_div").addClass("DNI"),pageId.find("#showExpiryOptions").prop("checked",!1),pageId.find("#expiry_in_days").val(""),pageId.find("#reminder_freqdayscnt").val(""),pageId.find("#reminder_check").prop("checked",!1),pageId.find("#reminder_freq").addClass("DN")},deleteAttachment:function(thisObj){var pageId="",isFromAutomation=!1;void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?pageId=$("#esignforms_card"):(pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId),isFromAutomation=!0);var selId=$(thisObj).closest("[name='fileOutDiv']").find(".zpl_atchdtl h4").attr("selId"),source=$(thisObj).closest("[name='fileOutDiv']").find(".zpl_atchdtl h4").attr("source"),zsignTempSel=pageId.find("#input_esignTempUpload").attr("checked"),fileTemp=pageId.find("#input_esignDefUpload").attr("checked");if("ztemplate"==source){ZPeopleComponents.dropdownlist(document.getElementById("zsignTempOptionsList")).deselect({id:selId});for(var mfLen=pageId.find($("#mergeFields").find("select")).length,mf=0;mf<mfLen;mf++){var id=pageId.find($("#mergeFields").find("select"))[mf].id;ZPeopleComponents.select(pageId.find("#"+id)).destroy()}pageId.find($("#zsMergeSec")).remove(),Zsign.recpRowsReset(),ZPA_Esign.resetZSTempValues(),Zsign.zSignData=""}else"fileupload"==source?ZPeopleComponents.dropdownlist("#fileRoleOptionsList").deselect({value:selId}):"templates"==source&&(ZPeopleComponents.dropdownlist("#TemplateOptionsList").deselect({id:selId}),isFromAutomation||$("#mailmergeInfo").remove());var fileName=$(pageId.find($(thisObj).closest("[name='fileOutDiv']")).find(".zpl_atchdtl #fileName")).text();if(pageId.find($(thisObj).closest("[name='fileOutDiv']")).remove(),0==pageId.find("#attachments .zpl_atchd").find("div").length&&(pageId.find("#attachments").addClass("DN"),pageId.find("#uploadSection").children().eq(0).removeClass("DN"),pageId.find("#uploadSection").children().eq(1).removeClass("DN")),0==pageId.find("#zsignTempAttach .zpl_atchd").find("div").length&&pageId.find("#zsignTempAttach").addClass("DN"),fileTemp?pageId.find("#uploadSectionBody").removeClass("DNI"):zsignTempSel&&pageId.find("#uploadSectionBody_zsigntemp").removeClass("DNI"),"templates"==source){var eleList=$($("[name='fileOutDiv']").find(".zpl_atchdtl h4")),noOfTemp=0;eleList.length>0&&$.each(eleList,function(_index,ele){"templates"==$(ele).attr("source")&&(noOfTemp++,$("#mailmergeInfo").removeClass("DN"))}),isFromAutomation&&0==noOfTemp&&$("#mailmergeInfo").remove()}ZPA_Esign.resetFileErrorborder(),ZPA_Esign.fileNameList.has(fileName)&&ZPA_Esign.fileNameList.delete(fileName)},setDocumentNameList:function(){var messtknObj={sort:!0,viewPerPage:4,lazyLoading:!0,filterByCSSSelector:!1,items:ZPA_Esign.constructFormFieldsJSON(Zsign.textfield.formId,!0),dataMapping:{text:"label",name:"label",value:"value",groupLabel:"viewtype",id:"value"},contentType:"text",sortOrder:"asc",hideCheckbox:!0,showSearchField:!0,position:"left",search:{by:"label",criteria:"contains",highlightKeyword:!0},searchFieldOptions:{placeholder:"Search",clearButton:!1},title:"Fields ",focusItemOnItemMouseover:!0,itemclick:ZPA_Esign.addDocNamefield,bodyItemVisibleCount:3,dropdownList:{appendTo:$("#esignThirdBdyCont"),fitForElement:!0,moveOnScroll:!0}};ZPeopleComponents.dropdownlist("#documentNameList",messtknObj)},changeCallbackConf:function(){var formId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("select#fname").val();Zsign.getFormCompFields(formId,"workflow"),ZPeopleComponents.dropdownlist(document.getElementById("fileRoleOptionsList")).destroy(),ZPeopleComponents.dropdownlist("#fileRoleOptionsList",{sort:!0,viewPerPage:4,lazyLoading:!0,filterByCSSSelector:!1,items:ZPA_Esign.constructFormFieldsJSON(Zsign.fileuploadfield.formId,!0),dataMapping:{text:"label",name:"label",value:"value",groupLabel:"viewtype",id:"value",fileId:"value"},contentType:"text",sortOrder:"asc",showSearchField:!0,position:"bottom",search:{by:"label",criteria:"contains",highlightKeyword:!0},searchFieldOptions:{placeholder:"Search",clearButton:!1},title:ZPI18N.getString("zp.fileupload"),focusItemOnItemMouseover:!0,itemclick:ZPA_Esign.attachmentConstructor,dropdownList:{itemType:"checkbox"},bodyItemVisibleCount:3,checkbox:!0,checkedIconPosition:"left",multiple:!0})},configCallback:function(){var model=ZPA_Esign.Slider.esflowModal;if(ZPA_Esign.isCardInitialLoad(model,"cardInitialsetup")){$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).append(ZPA_Common.Cards.construct("esbdy_conf",ZPA_Esign.containerBody.CONFIGURATION,ZPI18N.getString("zp.esign.wf.initialsetup"),ZPI18N.getString("zp.esigncontent1"))),$("#esbdy_conf").find(".zpl_crdcnt").attr("id","esignFirstBdyCont");var formData=new FormData;formData.append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),ZPA_Esign.openFilter(formData);var selectedFormId="",dataMapOptions="";settingsUrlProps.niceUrl.lastIndexOf("/workflow")>-1?dataMapOptions=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.WORKFLOW,ZPA_Common.getServiceName())]:settingsUrlProps.niceUrl.lastIndexOf("/esign")>-1?dataMapOptions=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.ESIGN,ZPA_Common.getServiceName())]:settingsUrlProps.niceUrl.lastIndexOf("/custombutton")>-1&&(dataMapOptions=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.CUSTOMACTION,ZPA_Common.getServiceName())]),ZPA_Esign.templateEdit&&(""!=selectedFormId&&"0"!=selectedFormId||(selectedFormId=ZPA_Esign.editData[1][0].fid));var formListProp={options:dataMapOptions,dataMapping:{label:"dispName",value:"formId"},change:Zsign.changeConfiguration,showSearchField:!0,viewPerPage:4,lazyLoading:!0,bodyItemVisibleCount:3,dropdownList:{appendTo:$("#esignFirstBdyCont"),fitForElement:!0,moveOnScroll:!0}};null!=selectedFormId&&""!=selectedFormId&&(formListProp.selectedValue=selectedFormId);var formId="";if(ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("select#fname"),formListProp),$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("#uploadSection").removeClass("DN"),$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("#attachments").addClass("DN"),ZPeopleComponents.isComponent("#formList"))formId=ZPeopleComponents.select("#formList").value;else if(settingsUrlProps.niceUrl.lastIndexOf("/workflow")>-1)formId=ZPeopleComponents.select("#workflow_formList").value;else if(settingsUrlProps.niceUrl.lastIndexOf("/esign")>-1)formId=ZPeopleComponents.select("#"+ZPA_Common.getFormListId(ZP_Automation_Mode.ESIGN)).getValue();else if(settingsUrlProps.niceUrl.lastIndexOf("/custombutton")>-1){var container=ZPA_Common.getMainContainer().find("#tabCustomActionTab");formId=ZPeopleComponents.select(container.find("#custombutton_formList")).getValue()}ZPA_Esign.templateEdit?""!=formId&&"0"!=formId||(formId=ZPA_Esign.editData[1][0].fid):"0"==formId&&(formId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("select#fname").val()),""==selectedFormId&&ZPeopleComponents.select("#fname").setAttribute("selectedValue",formId),Zsign.getFormCompFields(formId,"workflow"),ZP_Mailmerge.constructMMTempList("workflow",formId,"1","","","",ZPA_Esign.setconfigCallbackData),Zsign.checkZSFeature(),Zsign.zsFeatureList.templates&&ZPA_Esign.getZSignTemplates(),ZPeopleComponents.dropdownlist("#zsignTempOptionsList",{sort:!0,viewPerPage:4,lazyLoading:!0,filterByCSSSelector:!1,items:ZPA_Esign.constructZSignTempList(ZPA_Esign.ZSignTempList),selectionLimit:1,dataMapping:{text:"label",name:"label",value:"id",groupLabel:"viewtype",id:"id"},contentType:"text",sortOrder:"asc",showSearchField:!0,position:"bottom",search:{by:"label",criteria:"contains",highlightKeyword:!0},searchFieldOptions:{placeholder:"Search",clearButton:!1},title:ZPI18N.getString("zp.esign.zsigntemplate"),focusItemOnItemMouseover:!0,itemclick:ZPA_Esign.attachmentConstructor,dropdownList:{itemType:"checkbox"},bodyItemVisibleCount:3,checkbox:!0,multiple:!1}),ZPeopleComponents.dropdownlist("#fileRoleOptionsList",{sort:!0,viewPerPage:4,lazyLoading:!0,filterByCSSSelector:!1,items:ZPA_Esign.constructFormFieldsJSON(Zsign.fileuploadfield.formId,!0),dataMapping:{text:"label",name:"label",value:"value",groupLabel:"viewtype",id:"value",fileId:"value"},contentType:"text",sortOrder:"asc",showSearchField:!0,position:"bottom",search:{by:"label",criteria:"contains",highlightKeyword:!0},searchFieldOptions:{placeholder:"Search",clearButton:!1},title:ZPI18N.getString("zp.esign.fileuploadfield"),focusItemOnItemMouseover:!0,itemclick:ZPA_Esign.attachmentConstructor,dropdownList:{itemType:"checkbox"},bodyItemVisibleCount:3,checkbox:!0,checkedIconPosition:"left",multiple:!0})}},assignMMTempInDropDwn:function(){ZPeopleComponents.dropdownlist(document.getElementById("TemplateOptionsList")).destroy(),ZPeopleComponents.dropdownlist("#TemplateOptionsList",{sort:!0,viewPerPage:4,lazyLoading:!0,bodyItemVisibleCount:3,filterByCSSSelector:!1,items:ZPA_Esign.constructTempListJSON(ZP_Mailmerge.templateIds),dataMapping:{text:"label",name:"label",value:"id",groupLabel:"viewtype",id:"id"},contentType:"text",sortOrder:"asc",showSearchField:!0,position:"bottom",search:{by:"label",criteria:"contains",highlightKeyword:!0},searchFieldOptions:{placeholder:"Search",clearButton:!1},title:ZPI18N.getString("zp.esign.mailmerge.small"),focusItemOnItemMouseover:!0,itemclick:ZPA_Esign.attachmentConstructor,dropdownList:{itemType:"checkbox"},checkbox:!0,checkedIconPosition:"left",multiple:!0})},setconfigCallbackData:function(){ZPeopleComponents.dropdownlist("#TemplateOptionsList",{sort:!0,viewPerPage:4,lazyLoading:!0,filterByCSSSelector:!1,items:ZPA_Esign.constructTempListJSON(ZP_Mailmerge.templateIds),dataMapping:{text:"label",name:"label",value:"id",groupLabel:"viewtype",id:"id"},contentType:"text",sortOrder:"asc",showSearchField:!0,position:"bottom",search:{by:"label",criteria:"contains",highlightKeyword:!0},searchFieldOptions:{placeholder:"Search",clearButton:!1},title:ZPI18N.getString("zp.esign.mailmerge.small"),focusItemOnItemMouseover:!0,itemclick:ZPA_Esign.attachmentConstructor,dropdownList:{itemType:"checkbox"},bodyItemVisibleCount:3,checkbox:!0,checkedIconPosition:"left",multiple:!0}),ZPA_Esign.toggleUploadSection(1),ZPA_Esign.templateEdit&&$.each(ZPA_Esign.editData[1],function(_index,eachData){$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("#config_name").val(ZPeople.decodeTxt(eachData.name));var info=eachData.info;if($("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("#uploadSection").removeClass("DN"),$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("#attachments").removeClass("DN"),info.hasOwnProperty(Zsign.DOCUMENT_COUNT))for(var w=0;w<info[Zsign.DOCUMENT_COUNT];w++){if(info.hasOwnProperty(Zsign.LOCAL_FILEPATH_ORDER))for(var lfo=JSON.parse(info[Zsign.LOCAL_FILEPATH_ORDER]),t=0;t<lfo.length;t++)lfo[t].order==w&&Zsign.addFileFields(lfo[t].filePath);if(1==info.hasOwnProperty(Zsign.TEMPLATE_FORMFIELDS_ORDER)){var tfo=JSON.parse(info[Zsign.TEMPLATE_FORMFIELDS_ORDER]),dropdown=document.getElementById("TemplateOptionsList");for(t=0;t<tfo.length;t++)if(tfo[t].order==w){var contObj=[],itemplateIdval=tfo[t].templateIdval;Zsign.addTemplate("templates",itemplateIdval),contObj.push({id:itemplateIdval}),ZPeopleComponents.dropdownlist(dropdown).setValues(contObj,{clearOtherValues:!0})}}if(info.hasOwnProperty(Zsign.FILEUPLOAD_FILEDS_ORDER)){var ffo=JSON.parse(info[Zsign.FILEUPLOAD_FILEDS_ORDER]);for(t=0;t<ffo.length;t++)if(ffo[t].order==w){var ifilepathval=ffo[t].filepathval;Zsign.addTemplate("filepath",ifilepathval)}dropdown=document.getElementById("fileRoleOptionsList");for(var formFieldArr=ZPA_Esign.editData[1][0].info[4].split(","),formFieldLen=ZPA_Esign.editData[1][0].info[4].split(",").length,i=(contObj=[],0);i<formFieldLen;i++)contObj.push({value:formFieldArr[i]});ZPeopleComponents.dropdownlist(dropdown).setValues(contObj,{clearOtherValues:!0})}}else if(1==info.hasOwnProperty(Zsign.TEMPLATE_ID)){dropdown=document.getElementById("TemplateOptionsList");info[Zsign.TEMPLATE_ID].toString().split(",").length>0&&$.each(info[Zsign.TEMPLATE_ID].toString().split(","),function(_index,tempid){Zsign.addTemplate("templates",tempid)});var templateArr=ZPA_Esign.editData[1][0].info[Zsign.TEMPLATE_ID].split(","),templateArrLen=ZPA_Esign.editData[1][0].info[Zsign.TEMPLATE_ID].split(",").length;for(contObj=[],i=0;i<templateArrLen;i++)contObj.push({id:templateArr[i]});ZPeopleComponents.dropdownlist(dropdown).setValues(contObj,{clearOtherValues:!0})}if(info.hasOwnProperty(Zsign.ZSIGNTEMPLATEID)){ZPA_Esign.toggleUploadSection(2),info[Zsign.ZSIGNTEMPLATEID].toString().split(",").length>0&&$.each(info[Zsign.ZSIGNTEMPLATEID].toString().split(","),function(_index,tempid){Zsign.addTemplate("ztemplate",tempid)});dropdown=document.getElementById("zsignTempOptionsList");var zsignTemplateId=ZPA_Esign.editData[1][0].info[Zsign.ZSIGNTEMPLATEID];ZPeopleComponents.dropdownlist(dropdown).setValue({id:zsignTemplateId})}info.hasOwnProperty(Zsign.CATID)&&ZPeopleComponents.select($("#agrselect_Cat")).setValue(ZPA_Esign.editData[1][0].info[Zsign.CATID]),$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("#privateNote").val(eachData.privateNote)}),ZPA_Esign.assignMMTempInDropDwn()},deleteRecipient:function(thisObj){ZPA_Esign.managerAdded=!1;var pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId),rowID=$(thisObj).closest(".zpl_idiv").find("[name='recp_row_input']")[0].id,ele=rowID.substring(rowID.length-1);if(pageId.find("#recpRows").find("[name='recp_parent']").length<=1)ZPeople.Message.failure(ZPI18N.getString("zp.esign.selectrecp"));else{if(5==ZPeopleComponents.select("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpFormValue]")[0].id).value&&!0,ZPeopleComponents.select("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpType]")[0].id).destroy(),pageId.find("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpType]")[0].id).remove(),ZPeopleComponents.select("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpLocale]")[0].id).destroy(),pageId.find("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpLocale]")[0].id).remove(),ZPeopleComponents.select("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpFormValue]")[0].id).destroy(),pageId.find("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpFormValue]")[0].id).remove(),ZPeopleComponents.select("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpFieldValue]")[0].id).destroy(),pageId.find("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpFieldValue]")[0].id).remove(),void 0!=$("#"+rowID).parents("[name=recp_row]").find("[name=verifyOn]")[0]&&$($("#"+rowID).parents("[name=recp_row]").find("[name=verifyOn]")[0].id).length>0){var eleId=$("#"+rowID).parents("[name=recp_row]").find("[name=verifyOn]")[0].id;ZPeopleComponents.toggleswitch("#"+eleId).destroy(),pageId.find("#"+eleId).remove()}if($("#verifyOn_"+ele).length>0){var verId=$("#verifyOn_"+ele)[0].id;$("#verifyOn_"+ele).attr("toRemove",!1),ZPeopleComponents.isComponent($("#"+verId))&&ZPeopleComponents.toggleswitch($("#"+verId)).destroy(),$("#tabauthPopup_"+ele).remove(),$("#cardauthPopup_"+ele).remove()}if($("#privateMesspop_"+ele).length>0&&($("#privateMesspop_"+ele).val(""),$("#tabprivMessPopup_"+ele).remove()),$(thisObj).closest(".zpl_idiv").next("[name='hostRow']").length>0){if(pageId.find("#"+hostId).remove(),void 0!=$("#"+rowID).parents("[name=recp_row]").find("[name=hostRow]")[0]&&$("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=hostRow]")[0].id).length>0){var hostId=$("#"+rowID).parents("[name=recp_row]").find("[name=hostRow]")[0].id;ZPeopleComponents.select("#"+hostId).destroy()}$(thisObj).closest(".zpl_idiv").next("[name='hostRow']").remove()}$(thisObj).closest(".zpl_idiv").parent().remove(),ZPA_Esign.sortOrder(thisObj,ele);var row=pageId.find("#recpRows").find("[name=recp_row]");$.each(row,function(_rowLen,val){"5"==$(val).find("[name=recpFormValue]").val()&&(ZPA_Esign.managerAdded=!0)})}},updateDetailsZT:function(pageId){ZPA_Esign.recpDetailsZT(pageId),ZPA_Esign.tempDetailsZT(pageId),ZPA_Esign.otherDetailsZT(pageId)},tempDetailsZT:function(){var pageId="";pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId),($("#esbdy_tempdetail").length>0||void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&pageId.find("#document_name").val(Zsign.zSignData[1].data.template_name)},recpDetailsZT:function(pageId){if(pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId),($("#esbdy_recp").length>0||void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&(ZPA_Esign.templateEdit||void 0!=Zsign.zSignData&&""!=Zsign.zSignData)&&void 0!=Zsign.zSignData&&""!=Zsign.zSignData){void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(ZPeopleComponents.button("#addRecpbtn").setAttribute("disabled",!0),$("#addRecpbtn").removeAttr("onclick")):(ZPeopleComponents.button("#addUserbtn").setAttribute("disabled",!0),$("#addUserbtn").removeAttr("onclick")),pageId.find("#signing_order").prop("disabled",!0),Zsign.zSignData[1].data.is_sequential?pageId.find("#signing_order").prop("checked",!0):pageId.find("#signing_order").prop("checked",!1);for(var k=0;k<Zsign.zSignData[1][4].length;k++){var recpTempInfo=Zsign.zSignData[1][4][k];0!==k?void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?Zsign.addRecpRows("userbtnId",k):ZPA_Esign.Slider.addRecp(k):0==$(pageId.find("[name='recp_row']")[k]).length&&(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?Zsign.addRecpRows("userbtnId",k):ZPA_Esign.Slider.addRecp(k));var currRow="";(currRow=(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview"),$(pageId.find("[name='recp_row']")[k]))).find("[name='recpType']").append(ZPA_Esign.Slider.recType());var curRowComp=currRow.find("[name='recpType']"),zsignType=1;if("SIGN"==recpTempInfo.action_type)zsignType=1;else if("VIEW"==recpTempInfo.action_type)zsignType=2;else if("APPROVER"==recpTempInfo.action_type)zsignType=3;else if("INPERSONSIGN"==recpTempInfo.action_type){zsignType=4;var hostEmail=recpTempInfo.recipient_email}if(ZPeopleComponents.select(curRowComp).setAttributes({selectedValue:zsignType,disabled:!0}),ZPeopleComponents.select(currRow.find("[name='recpFormValue']").append(ZPA_Esign.Slider.recpFormOptions),{change:ZPA_Esign.Slider.showRecipientfldOpt}),""!=recpTempInfo.recipient_email&&void 0!=recpTempInfo.empDetails){ZPeopleComponents.select(currRow.find("#recpFormValue_"+k)).setAttributes({selectedValue:"3",disabled:!0});var selectedValObj={id:recpTempInfo.empDetails.usererec,value:recpTempInfo.empDetails.empid+" "+recpTempInfo.empDetails.name,image:recpTempInfo.empDetails.avatar,title:recpTempInfo.empDetails.empid+" "+recpTempInfo.empDetails.name};ZPeopleComponents.select(currRow.find("[name='recpFieldValue']")).setAttributes({selectedValue:selectedValObj,disabled:!0})}ZPeopleComponents.select(currRow.find("[name='recpLocale']").append(ZPA_Esign.Slider.recpLocale)),void 0!=recpTempInfo.language?ZPeopleComponents.select(currRow.find("[name='recpLocale']")).setAttributes({selectedValue:recpTempInfo.language}):ZPeopleComponents.select(currRow.find("[name='recpLocale']")).setAttributes({selectedValue:"en"}),currRow.find("[name='recpName']").parent().removeClass("DN"),currRow.find("[name='recpName']").val(recpTempInfo.role),currRow.find("[name='recpName']").attr("disabled","disabled"),currRow.find("[name='recpName']").attr("title",recpTempInfo.role),currRow.find(".PI_delete").addClass("DNI"),4==zsignType&&ZPeopleComponents.select(currRow.parent().find("[name='hostRow']").find("[name='recpHost']")).setAttribute("selectedValue",hostEmail)}}},recpCallback:function(){var pageId="",model=ZPA_Esign.Slider.esflowModal;if(pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1||ZPA_Esign.isCardInitialLoad(model,"cardRecipients")){$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId).append(ZPA_Common.Cards.construct("esbdy_recp",ZPA_Esign.containerBody.RECIPIENTS,ZPI18N.getString("zp.reciepents"),ZPI18N.getString("zp.esigncontent2"))),$("#esbdy_recp").find(".zpl_crdcnt").attr("id","esignSecBdyCont"),ZPeopleComponents.button("#addUserbtn",{click:ZPA_Esign.Slider.addRecp}),ZPA_Esign.Slider.addRecp(0);var addManagerDiv='<div id="addRowsDiv" style="margin-top: 15px;"><div class="zpl_idiv"><a class="zpl_lnkbg" id="addUserbtn" onclick=ZPA_Esign.Slider.addRecp()>'+ZPI18N.getString("zp.zs.addrecp")+"</a></div></div>";if($("#esbdy_recp").find("#recpRows").append(addManagerDiv),ZPA_Esign.recpDetailsZT(pageId),(void 0!=Zsign.zSignData&&""!=Zsign.zSignData||ZPA_Esign.templateEdit)&&void 0!=ZPA_Esign.editData&&""!=ZPA_Esign.editData){var info=ZPA_Esign.editData[1][0].info;if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData||!info.hasOwnProperty(Zsign.IS_SEQ)||info[Zsign.IS_SEQ]&&pageId.find("#signing_order").attr("Checked","Checked"),info.hasOwnProperty(Zsign.RECIPIENT_INFO)){for(var recInfo=JSON.parse(info[Zsign.RECIPIENT_INFO]),t=0;t<recInfo.length;t++)for(var i=0;i<recInfo.length;i++)if(t==recInfo[i][Zsign.RECIPIENT_ORDER]){0===t||void 0!=Zsign.zSignData&&""!=Zsign.zSignData||("5"==recInfo[i][Zsign.RECIPIENT_FIELD_TYPE]?ZPA_Esign.Slider.addRecp("","manager"):ZPA_Esign.Slider.addRecp(t));var currRow=$(pageId.find("[name='recp_row']")[recInfo[i][Zsign.RECIPIENT_ORDER]]);void 0!=Zsign.zSignData&&""!=Zsign.zSignData||currRow.find("select#recpType_"+t).append(ZPA_Esign.Slider.recType());var curRowComp=currRow.find("#recpType_"+t);if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData||(ZPeopleComponents.select(curRowComp).setAttribute("selectedValue",recInfo[i][Zsign.RECIPIENT_TYPE]),ZPeopleComponents.select(currRow.find("select#recpFormValue_"+t).append(ZPA_Esign.Slider.recpFormOptions),{change:ZPA_Esign.Slider.showRecipientfldOpt}),ZPeopleComponents.select(currRow.find("select#recpLocale_"+t).append(ZPA_Esign.Slider.recpLocale))),void 0!=recInfo[i][Zsign.RECIPIENT_FIELD_TYPE]){if(void 0==Zsign.zSignData||""==Zsign.zSignData||void 0!=Zsign.zSignData&&""==Zsign.zSignData[1][4][i].recipient_email){if(ZPeopleComponents.select(currRow.find("#recpFormValue_"+t)).setAttribute("selectedValue",recInfo[i][Zsign.RECIPIENT_FIELD_TYPE]),void 0!=Zsign.zSignData&&""!=Zsign.zSignData||currRow.find("[name='recpName']").val(recInfo[i][Zsign.RECIPIENT_ID]),"1"==recInfo[i][Zsign.RECIPIENT_FIELD_TYPE])ZPeopleComponents.select(currRow.find("#recpFieldValue_"+t)).setAttribute("selectedValue",recInfo[i][Zsign.EMAIL_FORM_FIELD_TYPE]);else if("2"==recInfo[i][Zsign.RECIPIENT_FIELD_TYPE])ZPeopleComponents.select(currRow.find("#recpFieldValue_"+t)).setAttribute("selectedValue",recInfo[i][Zsign.RECORD_OWNER_FIELD_TYPE]);else if("3"==recInfo[i][Zsign.RECIPIENT_FIELD_TYPE]){var empId=recInfo[i][Zsign.USER_EMAIL_FIELD_TYPE],userDetails=ZPeople.getUserDetailsById(empId),selectedValObj={id:empId,value:userDetails.empid+" "+userDetails.name,image:userDetails.avatar};ZPeopleComponents.select(currRow.find("#recpFieldValue_"+t)).setAttributes({selectedValue:selectedValObj})}4==recInfo[i][Zsign.RECIPIENT_TYPE]&&ZPeopleComponents.select($("#recpHost_"+i)).setAttribute("selectedValue",recInfo[i][Zsign.RECIPIENT_HOST])}void 0!=Zsign.zSignData&&""!=Zsign.zSignData||ZPeopleComponents.select(currRow.find("#recpLocale_"+t)).setAttribute("selectedValue",recInfo[i][Zsign.RECIPIENT_LOCALE]);var priv=recInfo[i][Zsign.RECIPIENT_PRIVATE_MESSAGE];void 0!=priv&&""!=priv&&ZPA_Esign.showPrivateMsgPop("",i,!0);var verify=recInfo[0][Zsign.RECIPIENT_VERIFY];void 0!=verify&&""!=verify&&verify&&ZPA_Esign.showAuthCodePop("",i,!0)}else ZPeopleComponents.select(currRow.find("#recpFormValue_"+t)).setAttribute("selectedValue","1"),void 0!=Zsign.zSignData&&""!=Zsign.zSignData||ZPeopleComponents.select(currRow.find("#recpFieldValue_"+t)).setAttribute("selectedValue",recInfo[i][Zsign.RECIPIENT_ID]),ZPeopleComponents.sortable("#recpRows",{region:"parent",cancelOnEscKey:!0,restrictExternalItem:!0,change:ZPA_Esign.sortOrder,items:"div[name='recp_parent']",handle:".PI_drag",axis:"y"})}}else info.hasOwnProperty(Zsign.RECP)&&(info[Zsign.RECP].split(",").length>1?$.each(info[Zsign.RECP].split(","),function(index,recp){1!==index&&ZPA_Esign.Slider.addRecp();var currRow=$(pageId.find("[name='recp_row']")[index]);currRow.find("#recpList").select2("val",recp),currRow.find("#recp_type").select2("val",Zsign.SIGNER)}):(pageId.find("div[name='recp_row']").find("#recpList").select2("val",info[Zsign.RECP]),pageId.find("#recp_type").select2("val",Zsign.SIGNER))),info.hasOwnProperty(Zsign.CC)&&(info[Zsign.CC].split(",").length>1?$.each(info[Zsign.CC].split(","),function(index,cc){(1!==index||info.hasOwnProperty(Zsign.RECP))&&ZPA_Esign.Slider.addRecp();var currRow=$(pageId.find("[name='recp_row']")[index]);currRow.find("#recpList").select2("val",cc),currRow.find("#recp_type").select2("val",Zsign.VIEWER)}):(ZPA_Esign.Slider.addRecp(),pageId.find("div[name='recp_row']:last").find("#recpList").select2("val",info[Zsign.CC]),info.hasOwnProperty(Zsign.CC)&&pageId.find("div[name='recp_row']:last").find("#recp_type").select2("val",Zsign.VIEWER))),info.hasOwnProperty(Zsign.APPROVE)&&(info[Zsign.APPROVER].split(",").length>1?$.each(info[Zsign.APPROVE].split(","),function(index,appr){(1!==index||info.hasOwnProperty(Zsign.APPROVER))&&ZPA_Esign.Slider.addRecp();var currRow=$(pageId.find("[name='recp_row']")[index]);currRow.find("#recpList").select2("val",appr),currRow.find("#recp_type").select2("val",Zsign.APPROVER)}):(ZPA_Esign.Slider.addRecp(),pageId.find("div[name='recp_row']:last").find("#recpList").select2("val",info[Zsign.APPROVE]),info.hasOwnProperty(Zsign.APPROVE)&&pageId.find("div[name='recp_row']:last").find("#recp_type").select2("val",Zsign.APPROVER)))}}},tempDetailsCallback:function(){var pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId),model=ZPA_Esign.Slider.esflowModal;if(ZPA_Esign.isCardInitialLoad(model,"cardDocumentdetails")){$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).append(ZPA_Common.Cards.construct("esbdy_tempdetail",ZPA_Esign.containerBody.DETAILS,ZPI18N.getString("zp.files.operations.documentdtls"),ZPI18N.getString("zp.esign.displaydetailsdesc"))),$("#esbdy_tempdetail").find(".zpl_crdcnt").attr("id","esignThirdBdyCont");var formId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("select#fname").val();if(ZPA_Esign.setDocumentNameList(),void 0!=Zsign.zSignData&&""!=Zsign.zSignData&&pageId.find("#document_name").val(Zsign.zSignData[1].data.template_name),ZPA_Esign.templateEdit){var info=ZPA_Esign.editData[1][0].info;if(Zsign.getTemplates(formId,info[Zsign.EMAIL_TEMPLATE]),info.hasOwnProperty(Zsign.DOC_NAME)){var docVal=info[Zsign.DOC_NAME];$.each(Zsign.textfield.formId,function(fcId,value){docVal.indexOf(fcId)>-1&&(docVal=docVal.replaceAll(fcId,"${"+value+"}"))}),pageId.find("#document_name").val(docVal)}}else Zsign.getTemplates(formId)}},otherDetailsZT:function(pageId){($("#esbdy_options").length>0||void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&void 0!=Zsign.zSignData&&""!=Zsign.zSignData&&(pageId.find("#datefieldOptions").addClass("DNI"),pageId.find("#datefieldOptionscont").removeClass("DNI"),pageId.find("#deadlinegrp").addClass("DNI"),pageId.find("#deadlineLabel").addClass("DNI"),pageId.find("#expiry_in_days_div").removeClass("DNI"),pageId.find("#showExpiryOptions").prop("checked",!0),pageId.find("#expiry_in_days").val(Zsign.zSignData[1].data.expiration_days),0!=Zsign.zSignData[1].data.reminder_period&&(pageId.find("#reminder_freqdayscnt").val(Zsign.zSignData[1].data.reminder_period),pageId.find("#reminder_check").attr("Checked","Checked"),pageId.find("#reminder_freq").removeClass("DN")))},otherDetailsCallback:function(){var pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId),model=ZPA_Esign.Slider.esflowModal;if(ZPA_Esign.isCardInitialLoad(model,"cardAdditionaloptions")){pageId.append(ZPA_Common.Cards.construct("esbdy_options",ZPA_Esign.containerBody.OPTIONS,ZPI18N.getString("zp.esign.additionaloptions"),ZPI18N.getString("zp.esigncontent4"))),$("#esbdy_options").find(".zpl_crdcnt").attr("id","esignFourBdyCont"),dateMapOptions=ZPA_Esign.constructFormFieldsJSON(Zsign.dateFields.formId);var dateFieldProp={options:dateMapOptions,dataMapping:{label:"label",value:"value",value:"id",value:"fileId"},dropdownList:{appendTo:$("#esignFourBdyCont"),fitForElement:!0,moveOnScroll:!0}};ZPeopleComponents.select(pageId.find("select#dateFieldOpt"),dateFieldProp),dataMapOptions=ZPA_Esign.constructFormFieldsJSON(Zsign.fileuploadfield.formId,null,!0);var formFieldProp={options:dataMapOptions,dataMapping:{label:"label",value:"value",value:"id",value:"fileId"},dropdownList:{appendTo:$("#esignFourBdyCont"),fitForElement:!0,moveOnScroll:!0}};if(ZPeopleComponents.select(pageId.find("select#addtoformfieldselect"),formFieldProp),Zsign.attachLookupOpts($("#esignFourBdyCont"),pageId.find("select#hrfileopt")),void 0==Zsign.notifyAccess&&Zsign.getZSDocConfiguration(),Zsign.notifyAccess&&ZPeopleComponents.tokenfield("#zsignNotifyUsers",ZPA_Esign.constructSearchList()),ZPeopleComponents.datefield("#esignFourBdyCont #deadline",{format:dateFmt,pickerOptions:{appendTo:"#esignFourBdyCont #dlParent",fitForElement:!0,moveOnScroll:!0}}),pageId.find("[id=notifyDiv]").addClass("DN"),(ZPA_Esign.templateEdit||void 0!=Zsign.zSignData&&""!=Zsign.zSignData)&&(void 0!=Zsign.zSignData&&""!=Zsign.zSignData?ZPA_Esign.otherDetailsZT(pageId):(pageId.find("#datefieldOptions").removeClass("DNI"),pageId.find("#datefieldOptionscont").removeClass("DNI"),pageId.find("#deadlinegrp").removeClass("DNI"),pageId.find("#deadlineLabel").removeClass("DNI"),pageId.find("#expiry_in_days_div").addClass("DNI"),pageId.find("#expiry_in_days").val("")),void 0!=ZPA_Esign.editData&&""!=ZPA_Esign.editData)){var info=ZPA_Esign.editData[1][0].info;if(Zsign.notifyAccess&&(pageId.find("[id=notifyDiv]").removeClass("DN"),void 0!=info&&void 0!=info[Zsign.USERLISTARRAY])){var options={};options.values=Zsign.returnEmpUserList(info[Zsign.USERLISTARRAY].system),ZPeopleComponents.tokenfield(document.getElementById("zsignNotifyUsers")).setAttributes(options),pageId.find("#notify_Mail").attr("Checked","Checked"),Zsign.displayUsers()}if(info.hasOwnProperty(Zsign.DEADLINE)?(pageId.find("#showExpiryOptions").attr("Checked","Checked"),pageId.find("input#deadline").removeClass("DNI"),ZPeopleComponents.datefield(pageId.find("#deadline")).setValue(info[Zsign.DEADLINE].replace("23:59:59","")),pageId.find("#deadlineLabel").removeClass("DNI"),pageId.find("#datefieldOptionscont").removeClass("DNI"),pageId.find("#datefieldOptions").removeClass("DNI"),pageId.find("#deadlinegrp").addClass("DNI"),pageId.find("#expdateid").attr("Checked","Checked"),pageId.find("#expiry_in_days_div").addClass("DNI"),pageId.find("#expiry_in_days").val("")):info.hasOwnProperty(Zsign.DATELOOKUPID)?(pageId.find("#showExpiryOptions").attr("Checked","Checked"),pageId.find("#datelookupid").attr("Checked","Checked"),pageId.find("#datefieldOptions").removeClass("DNI"),pageId.find("#datefieldOptionscont").removeClass("DNI"),pageId.find("#deadlinegrp").removeClass("DNI"),pageId.find("#deadlineLabel").addClass("DNI"),info.hasOwnProperty(Zsign.DEADLINEDAYS)&&pageId.find("#deadlinedays").val(info[Zsign.DEADLINEDAYS]),info.hasOwnProperty(Zsign.DATEFILED)&&ZPeopleComponents.select(pageId.find("#dateFieldOpt")).setAttribute("selectedValue",info[Zsign.DATEFILED]),pageId.find("#expiry_in_days_div").addClass("DNI"),pageId.find("#expiry_in_days").val("")):info.hasOwnProperty(Zsign.EXPINDAYS)?(pageId.find("#datefieldOptions").addClass("DNI"),pageId.find("#datefieldOptionscont").removeClass("DNI"),pageId.find("#deadlinegrp").addClass("DNI"),pageId.find("#deadlineLabel").addClass("DNI"),pageId.find("#expiry_in_days_div").removeClass("DNI"),pageId.find("#showExpiryOptions").prop("checked",!0),pageId.find("#expiry_in_days").val(info[Zsign.EXPINDAYS])):(pageId.find("#datefieldOptionscont").addClass("DNI"),pageId.find("#datefieldOptions").addClass("DNI"),pageId.find("#deadlinegrp").addClass("DNI"),pageId.find("#deadlineLabel").addClass("DNI")),info.hasOwnProperty(Zsign.REMINDER_FREQDAYS)&&0!=info[Zsign.REMINDER_FREQDAYS]&&(pageId.find("#reminder_freqdayscnt").val(info[Zsign.REMINDER_FREQDAYS]),pageId.find("#reminder_check").attr("Checked","Checked"),pageId.find("#reminder_freq").removeClass("DN")),info.hasOwnProperty(Zsign.SYNCTOHRFILES)){if(info[Zsign.SYNCTOHRFILES]&&pageId.find("#synctohrfiles").attr("Checked","Checked"),info.hasOwnProperty(Zsign.HRFILE_OPT_VAL))if(pageId.find("#synctypeOptions").removeClass("DNI"),1==info[Zsign.HRFILE_OPT_VAL].length)pageId.find("#optrecordbtn").attr("Checked","Checked"),pageId.find("#hrfileoptdiv").addClass("DNI");else{pageId.find("#hrfileoptdiv").removeClass("DNI"),pageId.find("#optotherbtn").attr("Checked","Checked");var otherdetails=info[Zsign.HRFILE_OPT_VAL]}ZPeopleComponents.select(pageId.find("select#hrfileopt")).setAttribute("selectedValue",otherdetails)}else pageId.find("#hrfileoptdiv").addClass("DNI"),pageId.find("#synctypeOptions").addClass("DNI");info.hasOwnProperty(Zsign.REDSUCCESS)&&pageId.find("[id=redSuccess]").val(encodeURI(info[Zsign.REDSUCCESS])),info.hasOwnProperty(Zsign.REDLATER)&&pageId.find("[id=redLater]").val(encodeURI(info[Zsign.REDLATER])),info.hasOwnProperty(Zsign.REDDECLINE)&&pageId.find("[id=redDeclined]").val(encodeURI(info[Zsign.REDDECLINE])),info.hasOwnProperty(Zsign.REDCOMPLETED)&&pageId.find("[id=redCompleted]").val(encodeURI(info[Zsign.REDCOMPLETED])),info.hasOwnProperty(Zsign.ADDTOFILEUPLOAD)&&ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("#addtoformfieldselect")).setAttribute("selectedValue",info[Zsign.ADDTOFILEUPLOAD])}}var fullpageId=$("#AddE-SignFlowModal");model=ZPA_Esign.Slider.esflowModal;ZPA_Esign.isCardInitialLoad(model,"cardInitialsetup")||ZPA_Esign.isCardInitialLoad(model,"cardRecipients")||ZPA_Esign.isCardInitialLoad(model,"cardDocumentdetails")||ZPA_Esign.isCardInitialLoad(model,"cardAdditionaloptions")||Zsign.enableSaveBtn(fullpageId,"saveButton")},constructSearchList:function(){var tokenObj={};tokenObj.dataSource={search:function(params){return new Promise(function(success){success({results:EmployeeSearch.getEmpList(params.query,"emp","FILES_ESIGNLIST",[],{},!1,"",!0),more:!1})})},paginated:!0,serverSearch:!0},tokenObj.placeholder=ZPI18N.getString("zp.searchemployee");var dataMapping={value:"id",text:"value",id:"zuid",image:"image",emailId:"emailId"};return tokenObj.dataMapping=dataMapping,tokenObj.tokens={contentType:"image-text"},tokenObj.isLabelHTMLEncoded=!0,tokenObj.dropdownList={fitForElement:!0,moveOnScroll:!0,contentType:"image-text",isTextHTMLEncoded:!0,itemType:"checkbox",appendTo:$("#esignFourBdyCont")},tokenObj.search={retainKeyword:!1,by:["emailId","value","zuid"],minKeywordLength:"1",highlightKeyword:!0,showNoResultsMessage:!0},tokenObj.messages={noResults:ZPI18N.getString("zp.nomatchesfound")},tokenObj},constructEmpListJSON:function(dataObj){var option=[];return ZPSetupCommon.isEmpty(dataObj)||Object.keys(dataObj).length>0&&$.each(dataObj,function(value,objJSON){option.push({label:objJSON.value,value:objJSON.id,imageURL:objJSON.image,image:objJSON.image,zuid:objJSON.zuid,email:objJSON.emailId})}),option},constructEmpRecpListJSON:function(dataObj){var option=[];return ZPSetupCommon.isEmpty(dataObj)||Object.keys(dataObj).length>0&&$.each(dataObj,function(value,objJSON){option.push({label:objJSON.value,value:objJSON.id})}),option},constructTempListJSON:function(dataObj){var option=[];return ZPSetupCommon.isEmpty(dataObj)||Object.keys(dataObj).length>0&&$.each(dataObj,function(value,objJSON){option.push({label:objJSON.fname,value:objJSON.tid,formId:objJSON.formId,rid:objJSON.rid,url:objJSON.url,id:objJSON.tid})}),option},constructZSignTempList:function(dataObj){var option=[];return ZPSetupCommon.isEmpty(dataObj)||Object.keys(dataObj).length>0&&$.each(dataObj,function(value,objJSON){option.push({label:ZPeople.decodeTxt(objJSON.templateName),value:objJSON.templateId,tempId:objJSON.templateId,recordId:objJSON.templateId,id:objJSON.templateId})}),option},constructZSignUserList:function(dataObj){var option=[];return ZPSetupCommon.isEmpty(dataObj)||Object.keys(dataObj).length>0&&$.each(dataObj,function(value,objJSON){option.push({label:objJSON,value:value,id:value})}),option},constructMMTempListJSON:function(dataObj,htmlObj,isSelect){var option=[{id:"-1",value:"",label:ZPI18N.getString("zp.select")}];return ZPSetupCommon.isEmpty(dataObj)||Object.keys(dataObj).length>0&&$.each(dataObj,function(value,objJSON){option.push({label:objJSON.TEMPLATE_NAME,text:objJSON.TEMPLATE,id:objJSON.TEMPLATEID,value:objJSON.TEMPLATEID})}),option},setZsignTempList:function(dataObj){dataObj=dataObj[1],ZPA_Esign.ZSignTempList=dataObj},getZSignTemplates:function(formId){var params={limit:200,startInd:1};ZPSetupCommon.isEmpty(formId)||(params.formId=formId),ZPeople.Request.sendAsyncPost("/zpzsign/getZSignTemplates",params,ZPA_Esign.setZsignTempList,"",ZPA_Esign.failureZsignTempList)},failureZsignTempList:function(error){var responseJson=error.responseJSON[1];"8026"==responseJson.errorCode&&ZPeople.Message.failure(responseJson.msg),"500"==responseJson.errorCode||"4003"==responseJson.errorCode?void 0!=responseJson.msg?ZPeople.Message.failure(responseJson.msg):ZPeople.Message.failure(error.statusText):"8006"==responseJson.errorCode&&ZPeople.Message.failure(responseJson.msg)},showdocDropdown:function(){var dropdown=document.getElementById("documentNameList");"none"==$("#documentNameList").css("display")?(ZPeopleComponents.dropdownlist(dropdown).open({forElement:"#documentNameListDP"}),$(dropdown).find("ul li").length<3&&$(dropdown).find("ul").attr("style","height:fit-content")):ZPeopleComponents.dropdownlist(dropdown).close()},showfileuploadDropdown:function(){var dropdown=document.getElementById("fileRoleOptionsList");"none"==$("#fileRoleOptionsList").css("display")?(ZPeopleComponents.dropdownlist(dropdown).open({forElement:"#fileRoleOptions"}),$(dropdown).find("ul li").length<3&&$(dropdown).find("ul").attr("style","height:fit-content")):ZPeopleComponents.dropdownlist(dropdown).close()},showZsignDropdown:function(){var dropdown=document.getElementById("zsignTempOptionsList");"none"==$("#zsignTempOptionsList").css("display")?(ZPeopleComponents.dropdownlist(dropdown).open({forElement:"#zsignTempList"}),$(dropdown).find("ul li").length<3&&$(dropdown).find("ul").attr("style","height:fit-content")):ZPeopleComponents.dropdownlist(dropdown).close()},showTemplateDropdown:function(){var dropdown=document.getElementById("TemplateOptionsList");"none"==$("#TemplateOptionsList").css("display")?(ZPeopleComponents.dropdownlist(dropdown).open({forElement:"#tempRoleOptions"}),$(dropdown).find("ul li").length<3&&$(dropdown).find("ul").attr("style","height:fit-content")):ZPeopleComponents.dropdownlist(dropdown).close()},addDocNamefield:function(event){var selectedValue=event.detail.itemData.label;selectedValue="${"+selectedValue+"}";var existingVal=$("#document_name").val();existingVal+=selectedValue,$("#document_name").val(existingVal)},addTempfield:function(event){var selectedValue=event.detail.itemData.label;selectedValue="${"+selectedValue+"}";var existingVal=$("#document_name").val();existingVal+=selectedValue,$("#document_name").val(existingVal)},add:function(mode){if(ZPA_Common.validateAddConfig()){Zsign.resetFormSliderValues();var action=ZPI18N.getString("zp.add");"edit"==mode&&(ZPA_Esign.templateEdit=!0,action=ZPI18N.getString("zp.edit"));var tab1=new Tab(ZPI18N.getString("zp.esign.wf.initialsetup"),ZPA_Esign.configCallback);tab1.cardId="cardInitialsetup";var tab2=new Tab(ZPI18N.getString("zp.reciepents"),ZPA_Esign.recpCallback);tab2.cardId="cardRecipients";var tab3=new Tab(ZPI18N.getString("zp.files.operations.documentdtls"),ZPA_Esign.tempDetailsCallback);tab3.cardId="cardDocumentdetails";var tab4=new Tab(ZPI18N.getString("zp.esign.additionaloptions"),ZPA_Esign.otherDetailsCallback);if(tab4.cardId="cardAdditionaloptions",tab1.validate=ZPA_Esign.validateTab1,tab2.validate=ZPA_Esign.validateTab2,tab3.validate=ZPA_Esign.validateTab3,tab4.validate=ZPA_Esign.validateTab4,ZPA_Esign.Slider.esflowModal=new fullPageModal(action+" "+ZPI18N.getString("zp.esign.wf.tabname"),tab1,tab2,tab3,tab4),ZPA_Esign.Slider.esflowModal.topNavigation=!0,ZPA_Esign.Slider.esflowModal._nextToggle=!0,ZPA_Esign.Slider.esflowModal._previousToggle=!0,ZPA_Esign.Slider.esflowModal.setSaveCallback(function(){ZPA_Esign.saveEsignTabData()}),ZPA_Esign.Slider.esflowModal.setCloseCallback(function(){ZPA_Esign.closeCallback()}),ZPA_Esign.Slider.esflowModal.construct(0),"edit"==mode)$(settingsPage.mainWrapId).find("#EditE-SignFlowModal").find(".zpl_mhder").find("h4").text(ZPI18N.getString("zp.edit")+" "+ZPI18N.getString("zp.esign.wf.tabname")),ZPeopleComponents.select("#fname").setAttribute("disabled",!0);else{$(settingsPage.mainWrapId).find("#AddE-SignFlowModal").find(".zpl_mhder").find("h4").text(ZPI18N.getString("zp.add")+" "+ZPI18N.getString("zp.esign.wf.tabname")),ZPeopleComponents.select("#fname").setAttribute("disabled",!1);var pageId=$("#AddE-SignFlowModal");Zsign.disableSaveBtn(pageId,"saveButton")}}},closeCallback:function(){ZPA_Esign.Slider.removeElementsfn()},edit:function(templateId){var params={recordId:templateId+"",isFromNewUI:!0};ZPeople.Request.sendAsyncPost("/zpzsign/getEsignConfigTemplates",params,ZPA_Esign.loadEditData),ZPA_Esign.add("edit")},loadEditData:function(dataObj,params){ZPA_Esign.editData=dataObj},getCurrentMode:function(){var wrapId=settingsPage.consWrapId,currentMode=ZP_Automation_Mode.ESIGN;return void 0!=wrapId&&wrapId.indexOf("newsettings")>=0&&(currentMode=ZP_Automation_Mode.ESIGN),currentMode},sortOrder:function(thisObj,startIndex){for(var elementId=0,recpRows=($("#esbdy_recp").find("#recpRows").find("[name='recp_row']").length,$("#esbdy_recp").find("#recpRows").find("[name='recp_row']"));elementId<recpRows.length;elementId++){0;var recpElement=$("#esbdy_recp").find("#recpRows").find("[name='recp_row']")[elementId];$(recpElement).find("[name='recp_row_input']")[0].id="recp_row_"+elementId;var elementValue=elementId;elementValue++,$(recpElement).find("[name='recp_row_input']").val(elementValue),$(recpElement).find("[name='recp_row_input']")[0].setAttribute("value",elementValue)}},savePrivateMsgCodeConf:function(thisObj){var rowID=$(thisObj)[0].sliderDiv[0].id,startIndex=rowID.substring(rowID.length-1),row=$("#recp_row_"+startIndex).parent().parent();0==row.length&&(row=$("#recpFormValue_"+startIndex).parent().parent());var input_privateNote=$("#privateMesspop_"+startIndex).val(),obj={};if(obj.privateMsg=input_privateNote,row.data("pdata",obj),"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")){var newDataObj=row.data().tdata;void 0!=newDataObj&&(newDataObj.private_notes=input_privateNote,row.data("tdata",newDataObj))}thisObj.close()},showPrivateMsgPop:function(thisObj,indx,dontShow){$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId);var startIndex="";if(void 0==indx){var rowID=$(thisObj).closest(".zpl_idiv").find("[name='recp_row_input']")[0].id;startIndex=rowID.substring(rowID.length-1)}else startIndex=indx;if(0==$("#privateMesspop_"+startIndex).length){var popupTab=new Tab("privMessPopup_"+startIndex,function(){var popcon='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.esign.privatenotedesc")+'</label></div><div><textarea id="privateMesspop_'+startIndex+'" rows="6" class="ztextbox" maxlength="1024"></textarea></div></div></div></div>';$("#cardprivMessPopup_"+startIndex).html(popcon)},function(getThis){getThis.close()});if(popupTab.validate=ZPA_Esign.savePrivateMsgCodeConf,ZPA_Esign.PrivatePOPUP=new popupModal(ZPI18N.getString("zp.esign.privatenotehdr"),popupTab),ZPA_Esign.PrivatePOPUP.construct(),$("#privateMesspop_"+startIndex).focus(),void 0!=dontShow&&dontShow&&($("#tabprivMessPopup_"+startIndex).removeClass("zpl_mopen"),$("#cardprivMessPopup_"+startIndex).removeClass("zpl_mopen")),ZPA_Esign.templateEdit||void 0!=Zsign.zSignData&&""!=Zsign.zSignData)if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData){var priv=Zsign.zSignData[1][4][startIndex].private_notes;$("#privateMesspop_"+startIndex).val(priv)}else{var info=ZPA_Esign.editData[1][0].info;if(info.hasOwnProperty(Zsign.RECIPIENT_INFO)){var recInfo=JSON.parse(info[Zsign.RECIPIENT_INFO]);$("#privateMesspop_"+startIndex).val(recInfo[startIndex][Zsign.RECIPIENT_PRIVATE_MESSAGE])}}}else{var popval=$("#privateMesspop_"+startIndex).val(),savedPriv=($("#recp_row_"+startIndex).parent().parent(),$("#recpFormValue_"+startIndex).parent().parent().data().pdata);void 0!=savedPriv&&""!=savedPriv&&void 0!=savedPriv.privateMsg?$("#privateMesspop_"+startIndex).val(savedPriv.privateMsg):void 0!=popval&&""!=popval?$("#privateMesspop_"+startIndex).val(popval):$("#privateMesspop_"+startIndex).val(""),$("#tabprivMessPopup_"+startIndex).addClass("zpl_mopen"),$("#privateMesspop_"+startIndex).focus(),$("#cardprivMessPopup_"+startIndex).addClass("zpl_mopen")}},saveAuthCodeConf:function(thisObj){var rowID=$(thisObj)[0].sliderDiv[0].id,startIndex=rowID.substring(rowID.length-1),row=$("#recp_row_"+startIndex).parent().parent();0==row.length&&(row=$("#recpFormValue_"+startIndex).parent().parent());var obj={};if(obj.verify=ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).getAttributes().checked,row.data("ldata",obj),"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")){var newDataObj=row.data().tdata;void 0!=newDataObj&&(newDataObj.verify_recipient=obj.verify,obj.verify&&(newDataObj.verification_type="EMAIL"),row.data("tdata",newDataObj))}thisObj.close()},showAuthCodePop:function(thisObj,indx,dontShow){var startIndex="";$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId);if(void 0==indx){var rowID=$(thisObj).closest(".zpl_idiv").find("[name='recp_row_input']")[0].id;startIndex=rowID.substring(rowID.length-1)}else startIndex=indx;$("#recp_row_"+startIndex).parent().parent();if(0==$("#verifyOn_"+startIndex).length||$("#verifyOn_"+startIndex).length>0&&"false"==$("#verifyOn_"+startIndex).attr("toRemove")){var popupTab=new Tab("authPopup_"+startIndex,function(){var popcon='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div class="zpl_tgl"><input toRemove=true id="verifyOn_'+startIndex+'" class="togbutton-js"><label>'+ZPI18N.getString("zp.esign.otpdesc")+"</label></div></div></div></div>";popcon+="</div>",$("#cardauthPopup_"+startIndex).html(popcon),ZPeopleComponents.toggleswitch("#verifyOn_"+startIndex)},function(getThis){getThis.close()});if(popupTab.validate=ZPA_Esign.saveAuthCodeConf,ZPA_Esign.AuthCodePOPUP=new popupModal(ZPI18N.getString("zp.esign.otphdr"),popupTab),ZPA_Esign.AuthCodePOPUP.construct(),void 0!=dontShow&&dontShow&&($("#tabauthPopup_"+startIndex).removeClass("zpl_mopen"),$("#cardauthPopup_"+startIndex).removeClass("zpl_mopen")),ZPA_Esign.templateEdit||void 0!=Zsign.zSignData&&""!=Zsign.zSignData)if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData){var ver_rec=Zsign.zSignData[1][4][startIndex].verify_recipient;"EMAIL"==Zsign.zSignData[1][4][startIndex].verification_type&&ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).setAttribute("on",ver_rec)}else{if((info=ZPA_Esign.editData[1][0].info).hasOwnProperty(Zsign.RECIPIENT_INFO)){var recInfo=JSON.parse(info[Zsign.RECIPIENT_INFO]);ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).setAttribute("on",recInfo[startIndex][Zsign.RECIPIENT_VERIFY])}}}else{if(ZPA_Esign.templateEdit||void 0!=Zsign.zSignData&&""!=Zsign.zSignData)if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData){var savedAuth=$("#recpFormValue_"+startIndex).parent().parent().data().ldata;if(void 0!=savedAuth&&""!=savedAuth&&void 0!=savedAuth.verify)savedAuth.verify?ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).switchOn():ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).switchOff();else{ver_rec=Zsign.zSignData[1][4][startIndex].verify_recipient;"EMAIL"==Zsign.zSignData[1][4][startIndex].verification_type&&ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).setAttribute("on",ver_rec)}}else{var info;if((info=ZPA_Esign.editData[1][0].info).hasOwnProperty(Zsign.RECIPIENT_INFO)){recInfo=JSON.parse(info[Zsign.RECIPIENT_INFO]);ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).setAttribute("on",recInfo[startIndex][Zsign.RECIPIENT_VERIFY])}}$("#tabauthPopup_"+startIndex).addClass("zpl_mopen"),$("#cardauthPopup_"+startIndex).addClass("zpl_mopen")}},getZSignTempValues:function(signTemplateId){var params={conreqcsr:csrfToken,signTemplateId:signTemplateId,needAllData:!0};ZPeople.Request.sendAsyncPost("/zpzsign/getTemplateActionIds",params,ZPA_Esign.setZSignTempValues,null,ZPA_Esign.failedCallBack)},setZSignTempValues:function(data,_params){var pageId="",isFromAutomation=!1;ZPA_Esign.Slider.removeZTElementsfn(),Zsign.zSignData=data,void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(pageId=$("#esignforms_card")).find("#document_name").val(Zsign.zSignData[1].data.template_name):(pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId),isFromAutomation=!0,$("#esbdy_tempdetail").length>0&&$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("#document_name").val(Zsign.zSignData[1].data.template_name));var zsignprofileurl=Zsign.zSignData[1].data.settings_profile,dataLeng=Zsign.zSignData[1][9].length;if(dataLeng>0){var consHTML='<div class="zpl_crd" id="zsMergeSec">';consHTML+='<div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.mergefields")+"</h4></div></div>",consHTML+='<div class="zpl_crdcnt">',consHTML+='<div class="zpl_secn">',consHTML+='<div class="zpl_info">',consHTML+="<h6><span>"+ZPI18N.getString("zp.info")+"</span></h6>",consHTML+="<ul>",consHTML+="<li><em>"+ZPI18N.getString("zp.esign.mergenote1",new Array(zsignprofileurl))+"</em></li>",consHTML+="<li><em>"+ZPI18N.getString("zp.esign.mergenote2")+"</em></li>",consHTML+="<li><em>"+ZPI18N.getString("zp.esign.mergenote3")+"</em></li>",consHTML+="</ul>",consHTML+="</div>",consHTML+="</div>",consHTML+='<div class="zpl_secn zpl_gbox d-flex" id="mergeFields">',consHTML+='<div id="mergeFieldsTable" class="zpl_itbl"><table><tbody><tr>',consHTML+='<td width="300"><b>'+ZPI18N.getString("zp.zohosign")+"</b></td>",consHTML+="<td><b>"+ZPI18N.getString("zpeople")+"</b></td>",consHTML+="</tr></tbody></table></div>",consHTML+="</div></div></div>",isFromAutomation?$("#esbdy_conf").after(consHTML):$("#basicDetails").after(consHTML)}for(var itr=0;itr<dataLeng;itr++){var label=Zsign.zSignData[1][9][itr].label,datatype=Zsign.zSignData[1][9][itr].type,field_id=Zsign.zSignData[1][9][itr].field_id,is_mandatory=Zsign.zSignData[1][9][itr].is_mandatory,classNm="";is_mandatory&&(classNm="zpl_mtry");var html='<div class="zpl_secn zpl_mailtmp"><div><label name="mergeFieldsList" class="'+classNm+'" fid="'+field_id+'" data-mandtry='+is_mandatory+">"+label+"</label></div>";if(html+='<div><select type="text" id="'+field_id+'" datatype="'+datatype+'" data-mandtry='+is_mandatory+' labelName="'+label+'" class="ztextbox" value=""></select></div>',html+="</div>",$("#mergeFieldsTable").after(html),ZPA_Esign.templateEdit)var info=ZPA_Esign.editData[1][0].info;if("checkbox"==datatype){if(Object.keys(Zsign.checkboxfields.formId).length>0?ZPeopleComponents.select($("#"+field_id)).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.checkboxfields.formId)):ZPeopleComponents.select($("#"+field_id)),ZPA_Esign.templateEdit&&info.hasOwnProperty(Zsign.PREFILL_FIELDS_DATA))for(var recInfo=JSON.parse(info[Zsign.PREFILL_FIELDS_DATA]),t=0;t<recInfo.length;t++)if(field_id==recInfo[t][Zsign.PREFILL_FIELDID]){ZPeopleComponents.select($("#"+field_id)).setAttribute("selectedValue",recInfo[t][Zsign.PREFILL_VALUE]);break}}else if("textfield"==datatype){if(Object.keys(Zsign.textfield.formId).length>0?ZPeopleComponents.select($("#"+field_id)).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.textfield.formId)):ZPeopleComponents.select($("#"+field_id)),ZPA_Esign.templateEdit&&info.hasOwnProperty(Zsign.PREFILL_FIELDS_DATA))for(recInfo=JSON.parse(info[Zsign.PREFILL_FIELDS_DATA]),t=0;t<recInfo.length;t++)if(field_id==recInfo[t][Zsign.PREFILL_FIELDID]){ZPeopleComponents.select($("#"+field_id)).setAttribute("selectedValue",recInfo[t][Zsign.PREFILL_VALUE]);break}}else if("dropdown"==datatype){if(Object.keys(Zsign.dropdownfields.formId).length>0?ZPeopleComponents.select($("#"+field_id)).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.dropdownfields.formId)):ZPeopleComponents.select($("#"+field_id)),ZPA_Esign.templateEdit&&info.hasOwnProperty(Zsign.PREFILL_FIELDS_DATA))for(recInfo=JSON.parse(info[Zsign.PREFILL_FIELDS_DATA]),t=0;t<recInfo.length;t++)if(field_id==recInfo[t][Zsign.PREFILL_FIELDID]){ZPeopleComponents.select($("#"+field_id)).setAttribute("selectedValue",recInfo[t][Zsign.PREFILL_VALUE]);break}}else if("datefield"==datatype){if(Object.keys(Zsign.dateFields.formId).length>0?ZPeopleComponents.select($("#"+field_id)).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.dateFields.formId)):ZPeopleComponents.select($("#"+field_id)),ZPA_Esign.templateEdit&&info.hasOwnProperty(Zsign.PREFILL_FIELDS_DATA))for(recInfo=JSON.parse(info[Zsign.PREFILL_FIELDS_DATA]),t=0;t<recInfo.length;t++)if(field_id==recInfo[t][Zsign.PREFILL_FIELDID]){ZPeopleComponents.select($("#"+field_id)).setAttribute("selectedValue",recInfo[t][Zsign.PREFILL_VALUE]);break}}else if("radiogroup"==datatype&&(Object.keys(Zsign.radiofields.formId).length>0?ZPeopleComponents.select($("#"+field_id)).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.radiofields.formId)):ZPeopleComponents.select($("#"+field_id)),ZPA_Esign.templateEdit&&info.hasOwnProperty(Zsign.PREFILL_FIELDS_DATA)))for(recInfo=JSON.parse(info[Zsign.PREFILL_FIELDS_DATA]),t=0;t<recInfo.length;t++)if(field_id==recInfo[t][Zsign.PREFILL_FIELDID]){ZPeopleComponents.select($("#"+field_id)).setAttribute("selectedValue",recInfo[t][Zsign.PREFILL_VALUE]);break}}ZPA_Esign.updateDetailsZT(pageId),Zsign.zSignData[1].data.signerFieldForAllRecp||!(void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1||isFromAutomation)||ZPeople.Message.warning(ZPI18N.getString("zp.addsignerfields"))},failedCallBack:function(data,params){},setDeliveryOpt:function(thisObj){$(thisObj).value},resetErrorborder:function(thisObj){$(thisObj).removeClass("ztextbox__error")},resetAllErrorborder:function(){$("span[id=errorMsg]").remove(),$(".ztextbox__error").removeClass("ztextbox__error"),$(".zpl_erorbx").removeClass("zpl_erorbx")},resetFileErrorborder:function(){$("#uploadSectionBody #drop_area").removeClass("fldrp_err"),$("#uploadSectionBody_zsigntemp #drop_area").removeClass("fldrp_err")},setCommonEsignformData:function(){var formData=new FormData;if(formData.append("isNewUI",!0),formData.append("conreqcsr",csrfToken),formData.append("action","saveEsignConfig"),ZPA_Esign.templateEdit){var configId=ZPA_Esign.editData[1][0].cid;ZPSetupCommon.isEmpty(configId)||formData.append("recordId",configId)}var formId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("select#fname").val();formData.append("formId",formId);var configName=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("#config_name").val();return ZPSetupCommon.isEmpty(configName)||formData.append("config_name",configName),ZPA_Esign.editData&&formData.append("saveTabOnEdit",!0),formData},validateTab1:function(formData,save){void 0!=save&&save||(formData=ZPA_Esign.setCommonEsignformData()),ZPA_Esign.resetAllErrorborder(),ZPA_Esign.resetFileErrorborder();var err=!1,pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId),configName=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("#config_name").val();if(ZPSetupCommon.isEmpty(configName)&&(pageId.find("#config_name").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.esign.enterflowname")+"</span>"),pageId.find("#config_name").addClass("ztextbox__error"),err=!0),pageId.find("#agrselect_newCatName").is(":visible")){var newCatName=pageId.find("#agrselect_newCatName").val().trim();formData.append("newCatName",newCatName)}else{var catId=ZPeopleComponents.select(pageId.find("#agrselect_Cat")).getValue();ZPSetupCommon.isEmpty(catId)||"select"==catId||"-1"==catId||""==catId?(pageId.find("#agrselect_Cat").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.esignfoldererr")+"</span>"),ZPeopleComponents.select(pageId.find("#agrselect_Cat")).getElement().addClass("ztextbox__error"),err=!0):formData.append("catId",catId)}var noOfAtth=0,isZTemp=!1,zsignTempSel=pageId.find("#input_esignTempUpload").attr("checked"),fileTemp=pageId.find("#input_esignDefUpload").attr("checked");zsignTempSel&&$("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length>0?(noOfAtth=$("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length,isZTemp=!0):fileTemp&&(noOfAtth=$("#attachments .zpl_atchd").find("[name=fileOutDiv]").length),0==noOfAtth?(fileTemp?$("#uploadSectionBody #drop_area").addClass("fldrp_err"):zsignTempSel&&($("#uploadSectionBody_zsigntemp #drop_area").addClass("fldrp_err"),Zsign.checkZSFeature(),Zsign.zsFeatureList.templates||(ZPA_Esign.toggleUploadSection(1),$("#uploadSectionBody #drop_area").addClass("fldrp_err"))),pageId.find("#uploadSection").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.esign.uploadonedoc")+"</span>"),err=!0):fileTemp&&noOfAtth>5&&(ZPeople.Message.failure(ZPI18N.getString("zp.zs.maxdocuploads")),err=!0);for(var selectedFiles,selectedFilesfromdb,ztemplateOriginalFields,fileuploadFields=[],fileuploadFieldsoriginal=[],templateFields=[],templateoriginalFields=[],selectedFilesOrder=[],selectedFilesfromdborder=[],selectedcloudOrder=[],selectedcloudFilesarray=[],selectedFilesfromdbarray=[],templateFieldsval={},fileFieldsval={},itr=0;itr<noOfAtth;itr++){var selId=$($("#attachments .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("selId"),source=$($("#attachments .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("source");templateFieldsval={},fileFieldsval={};isZTemp&&(selId=$($("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("selId"),source=$($("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("source"));var multiplefilesDetails=pageId.find("#attachments .zpl_atchd .zpl_atchdtl");if(void 0!=$(multiplefilesDetails[itr]).data("filename")&&(selectedFilesfromdb=$(multiplefilesDetails[itr]).data("filename").name),"localUpload"==source){selectedFiles=$(multiplefilesDetails[itr]).data("filedetails"),formData.append("selectedFiles",selectedFiles);var selectedFilesOrderval={};selectedFilesOrderval.order=itr,selectedFilesOrderval.filepathstring=$(multiplefilesDetails[itr]).data("filedetails").name,selectedFilesOrder.push(selectedFilesOrderval),ZPA_Esign.Uploadsource=source}else if("cloud"==source){var selectedcloudFiles;if(void 0!=(selectedcloudFiles=$(multiplefilesDetails[itr]).data("cloudfileDetails"))){selectedcloudFilesarray.push(selectedcloudFiles);var selectedFilescloudOrderval={};selectedFilescloudOrderval.order=itr,selectedFilescloudOrderval.filepathstring=$(multiplefilesDetails[itr]).data("cloudfileDetails").docName,selectedcloudOrder.push(selectedFilescloudOrderval)}}else"fileupload"==source?(fileFieldsval.order=itr,fileFieldsval.filepathval=selId,fileuploadFields.push(fileFieldsval),fileuploadFieldsoriginal.push(selId)):"templates"==source?(templateFieldsval.order=itr,templateFieldsval.templateIdval=selId,templateFields.push(templateFieldsval),templateoriginalFields.push(selId)):"ztemplate"==source&&(ztemplateOriginalFields=selId,ZPA_Esign.resetuploadValues());if(void 0!=selectedFilesfromdb&&""!=selectedFilesfromdb){var selectedFilesfromdbobjorder={};selectedFilesfromdbarray.push(selectedFilesfromdb),selectedFilesfromdbobjorder.order=itr,selectedFilesfromdbobjorder.filepathstring=selectedFilesfromdb,selectedFilesfromdborder.push(selectedFilesfromdbobjorder),selectedFilesfromdb=""}}fileuploadFields.length>0&&(formData.append("fileList",fileuploadFieldsoriginal),formData.append("fileListarray",JSON.stringify(fileuploadFields))),templateFields.length>0&&(formData.append("templateIdorder",JSON.stringify(templateFields)),formData.append("templateId",templateoriginalFields)),void 0!=ztemplateOriginalFields&&ztemplateOriginalFields.length>0&&formData.append("ztemplateId",ztemplateOriginalFields),formData.append("document_length",noOfAtth),0!=selectedFilesOrder.length&&formData.append("selectedFilesOrder",JSON.stringify(selectedFilesOrder)),0!=selectedFilesfromdbarray.length&&(formData.append("selectedFilesfromdbarray",JSON.stringify(selectedFilesfromdbarray)),formData.append("selectedFilesfromdborder",JSON.stringify(selectedFilesfromdborder)));var dataArray=[];for(key in selectedcloudFilesarray)dataArray.push(selectedcloudFilesarray[key]);0!=dataArray.length&&(formData.append("selectedcloudFilesarray",JSON.stringify(dataArray)),formData.append("selectedcloudOrder",JSON.stringify(selectedcloudOrder))),ZPSetupCommon.isEmpty(ZPA_Esign.Uploadsource)||formData.append("uploadMode",ZPA_Esign.Uploadsource);var preFillFields=[];if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData){for(var mergeFieldListLen=$("label[name=mergeFieldsList]").length,i=0;i<mergeFieldListLen;i++){var preFillFieldsVal={},prefill_id=$($("label[name=mergeFieldsList]")[i]).attr("fid"),prefill_val=$("#"+prefill_id).val(),mandtry=$($("label[name=mergeFieldsList]")[i]).data("mandtry");if(null!=prefill_val)preFillFieldsVal[Zsign.PREFILL_FIELDID]=prefill_id,preFillFieldsVal[Zsign.PREFILL_VALUE]=prefill_val,preFillFieldsVal[Zsign.PREFILL_DATATYPE]=$("#"+prefill_id).attr("datatype"),preFillFieldsVal[Zsign.PREFILL_LABEL]=$("#"+prefill_id).attr("labelName"),preFillFields.push(preFillFieldsVal);else if(mandtry){if(0==ZPeopleComponents.select($("#"+prefill_id)).getOptions().length){var dt=$("#"+prefill_id).attr("datatype");$("#"+prefill_id).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.addffandchoose",[dt,dt])+"</span>")}else $("#"+prefill_id).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.ffselerr")+"</span>");ZPeopleComponents.select(pageId.find("#"+prefill_id)).getElement().addClass("ztextbox__error"),err=!0}}if(0!=preFillFields.length&&formData.append("preFillFieldsData",JSON.stringify(preFillFields)),!Zsign.zSignData[1].data.signerFieldForAllRecp){err=!0;var params={conreqcsr:csrfToken,signTemplateId:ztemplateOriginalFields,needAllData:!1};$.ajax({url:"/zpzsign/getTemplateActionIds",type:"POST",data:params,success:function(data){Zsign.setSignerFieldForAllRecp(data),Zsign.zSignData[1].data.signerFieldForAllRecp||(err=!0,ZAlertBanner.show({message:ZPI18N.getString("zp.addsignerfields"),type:"error",hideDelay:1e4,animation:{show:{name:"slideDown",duration:500},hide:{name:"slideUp",duration:500}},icon:!0,hideDelay:4e3,closeButton:!0,beforeshow:ZPeople.Message.beforeShow}))},failure:function(data){Zsign.failedCallBack(data)}})}}return err||(save||ZPA_Esign.Slider.esflowModal.nextTab(!0),formData)},validateTab2:function(formData,save){void 0!=save&&save||(formData=ZPA_Esign.setCommonEsignformData()),ZPA_Esign.resetAllErrorborder();var err=!1,pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId);formData.append("signing_order",$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId).find("[id=signing_order]").is(":checked"));var recpNameLen=pageId.find('[id^="recpName"]').length,recipientDetails=[],userObject=[],recpHost=null;if(recpNameLen>0)for(var ele=0;ele<recpNameLen;ele++){var recpOrder=ele,eleId=pageId.find("[name=recpName]")[ele].id.split("_")[1],recpName=pageId.find("#recpName_"+eleId).val(),recpFormValue=pageId.find("#recpFormValue_"+eleId).val(),recpFieldValue=pageId.find("#recpFieldValue_"+eleId).val(),errMsg="";null==recpFormValue&&(errMsg=ZPI18N.getString("zp.emplookuperr"),pageId.find("#recpFormValue_"+eleId).parent().parent().addClass("zpl_erorbx"),pageId.find("#recpFormValue_"+eleId).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),ZPeopleComponents.select(pageId.find("#recpFormValue_"+eleId)).getElement().addClass("ztextbox__error"),err=!0),"-1"!=recpFieldValue&&null!=recpFieldValue||"5"==recpFormValue||(1==recpFormValue?errMsg=ZPI18N.getString("zp.selectemailfield"):2==recpFormValue?errMsg=ZPI18N.getString("zp.emplookuperr"):3==recpFormValue&&(errMsg=ZPI18N.getString("zp.userselecterr")),pageId.find("#recpFieldValue_"+eleId).parent().parent().addClass("zpl_erorbx"),pageId.find("#recpFieldValue_"+eleId).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),ZPeopleComponents.select(pageId.find("#recpFieldValue_"+eleId)).getElement().addClass("ztextbox__error"),err=!0),5==recpFormValue&&(Zsign.isDynamicUserAdded(pageId)||(pageId.find("#recpFormValue_"+eleId).parent().parent().addClass("zpl_erorbx"),pageId.find("#recpFormValue_"+eleId).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.esign.selectlookupformanager")+"</span>"),ZPeopleComponents.select(pageId.find("#recpFormValue_"+eleId)).getElement().addClass("ztextbox__error"),err=!0));var recpType=pageId.find("#recpType_"+eleId).val(),recpLocale=ZPeopleComponents.select(pageId.find("#recpLocale_"+eleId)).getValue(),privateMessage=$("#privateMesspop_"+eleId).val(),verifyOn=void 0;if(0!=$("#verifyOn_"+eleId).length&&(verifyOn=ZPeopleComponents.toggleswitch($("#verifyOn_"+eleId)).getAttributes().checked))var delType=1;recpHost=null,4==recpType&&null==(recpHost=pageId.find("#recpHost_"+eleId).val())&&(errMsg=ZPI18N.getString("zp.zohosignusererr"),pageId.find("#recpHost_"+eleId).parent().parent().addClass("zpl_erorbx"),pageId.find("#recpHost_"+eleId).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),ZPeopleComponents.select(pageId.find("#recpHost_"+eleId)).getElement().addClass("ztextbox__error"),err=!0),5==recpFormValue&&(managerEle=$("#recpFormValue_"+ele),0);var recipientDetailsObject={};recipientDetailsObject[Zsign.RECIPIENT_ID]=recpName,recipientDetailsObject[Zsign.RECIPIENT_ORDER]=recpOrder,recipientDetailsObject[Zsign.RECIPIENT_FIELD_TYPE]=recpFormValue,1==recpFormValue?recipientDetailsObject[Zsign.EMAIL_FORM_FIELD_TYPE]=recpFieldValue:2==recpFormValue?recipientDetailsObject[Zsign.RECORD_OWNER_FIELD_TYPE]=recpFieldValue:3==recpFormValue&&(""!=recpFieldValue&&0==Object.keys(userObject).length&&userObject.push(recpFieldValue),recipientDetailsObject[Zsign.USER_EMAIL_FIELD_TYPE]=recpFieldValue),recipientDetailsObject[Zsign.RECIPIENT_TYPE]=recpType,recipientDetailsObject[Zsign.RECIPIENT_LOCALE]=recpLocale,recipientDetailsObject[Zsign.RECIPIENT_PRIVATE_MESSAGE]=privateMessage,void 0!=verifyOn&&(recipientDetailsObject[Zsign.RECIPIENT_VERIFY]=verifyOn,recipientDetailsObject[Zsign.RECIPIENT_DELIVERY_TYPE]=delType),null!=recpHost&&(recipientDetailsObject[Zsign.RECIPIENT_HOST]=recpHost),recipientDetails.push(recipientDetailsObject)}return ZPSetupCommon.isEmpty(recipientDetails)||formData.append("recipientDetails",JSON.stringify(recipientDetails)),ZPSetupCommon.isEmpty(userObject)||formData.append("userObject",userObject),err||(save||ZPA_Esign.Slider.esflowModal.nextTab(!0),formData)},validateTab3:function(formData,save){ZPA_Esign.resetAllErrorborder(),void 0!=save&&save||(formData=ZPA_Esign.setCommonEsignformData());var err=!1,pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId),docNameIds="",documentName=$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("#document_name").val();if(ZPSetupCommon.isEmpty(documentName))pageId.find("#document_name").addClass("ztextbox__error"),pageId.find("#document_name").parent().parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.zs.documentnameempty")+"</span>"),err=!0;else{var index=0;$.each(Zsign.textfield.formId,function(fcId,fieldName){documentName.indexOf("${"+fieldName+"}")>-1&&(documentName=documentName.replaceAll("${"+fieldName+"}",fcId),0!==index&&(docNameIds+=","),docNameIds+=fcId,index++)})}formData.append("docNameList",docNameIds),formData.append("document_name",ZPSetupCommon.isEmpty(documentName)?"":documentName);var ele=ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("#fTempOpt"));let automation_message="";return void 0!=(ele._selected?ele._selected[0]:void 0)&&(automation_message=$(ele._selected[0]).attr("id")),formData.append("automation_message",ZPSetupCommon.isEmpty(automation_message)||-1==automation_message?"":automation_message),err||(save||ZPA_Esign.Slider.esflowModal.nextTab(!0),formData)},validateTab4:function(formData,save){void 0!=save&&save||(formData=ZPA_Esign.setCommonEsignformData()),ZPA_Esign.resetAllErrorborder();var err=!1,pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId),expirationDays=ZPeopleComponents.datefield("#deadline").getValue().dateString,noOfDays=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("#deadlinedays").val(),expInDays=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("#expiry_in_days").val(),showExpiryOptions=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("#showExpiryOptions").is(":checked");if(formData.append("showExpiryOptions",showExpiryOptions),""!=expInDays&&formData.append("expInDays",expInDays),"1"==$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input[id='expdateid']:checked").val()&&showExpiryOptions)if(formData.append("expdateid",!0),void 0!=expirationDays){var lastDate=moment(expirationDays,dateFmt.toUpperCase()).format("DD-MMM-YYYY").split("-"),month=Calendar.months.indexOf(lastDate[1])+1,lDate=lastDate[2]+"/"+month+"/"+lastDate[0];if("NaN"===Date.parse(lDate).toString()||moment(lDate).diff(moment().format("YYYY/MM/DD"),"days")<=0){err=!0;var errMessage="";errMessage="NaN"===Date.parse(lDate).toString()?ZPI18N.getString("zp.validdateerr"):ZPI18N.getString("zp.validuntilerr"),ZPeopleComponents.datefield(pageId.find("#deadline")).getElement().addClass("ztextbox__error"),pageId.find("#deadline").parent().parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMessage+"</span>")}formData.append("deadline",expirationDays)}else ZPeopleComponents.datefield(pageId.find("#deadline")).getElement().addClass("ztextbox__error"),pageId.find("#deadline").parent().parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.selectexpdate")+"</span>"),err=!0;if("on"==$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input[id='datelookupid']:checked").val()&&showExpiryOptions){formData.append("datelookupid",!0),ZPSetupCommon.isEmpty(noOfDays)?formData.append("noOfDays",0):(noOfDays<0?(ZPeopleComponents.select(pageId.find("#dateFieldOpt")).getElement().addClass("ztextbox__error"),pageId.find("#dateFieldOpt").parent().parent().parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.validvalue")+"</span>"),err=!0):noOfDays>99&&(err=!0,ZPeopleComponents.select(pageId.find("#dateFieldOpt")).getElement().addClass("ztextbox__error"),pageId.find("#dateFieldOpt").parent().parent().parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.zohosignexplimit")+"</span>")),formData.append("noOfDays",noOfDays));var dateField=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("#dateFieldOpt").val();"-1"!=dateField?formData.append("dateField",dateField):(ZPeopleComponents.select(pageId.find("#dateFieldOpt")).getElement().addClass("ztextbox__error"),pageId.find("#dateFieldOpt").parent().parent().parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.selectexpdate")+"</span>"),err=!0)}formData.append("reminder",$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input#reminder_check").is(":checked"));var freqReminder=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input#reminder_freqdayscnt").val();0!=(freqReminder=ZPSetupCommon.isEmpty(freqReminder)?"0":freqReminder)&&(freqReminder>=1&&freqReminder<=98?formData.append("reminder_freqdays",freqReminder):(pageId.find("#reminder_freq").addClass("ztextbox__error"),pageId.find("#reminder_freq").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.zohosignreminderlimit")+"</span>"),err=!0));var synctohrfiles=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("[id=synctohrfiles]").is(":checked");if(null!=synctohrfiles&&0!=synctohrfiles){formData.append("synctohrfiles",!0);var hrfileoptval="",optrecordbtn=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("[id=optrecordbtn]:checked").val(),optotherbtn=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("[id=optotherbtn]:checked").val();void 0!=optrecordbtn&&""!=optrecordbtn||void 0!=optotherbtn&&""!=optotherbtn?"on"==optrecordbtn?hrfileoptval=1:"on"==optotherbtn&&("-1"==$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("select#hrfileopt").val()||"null"==$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("select#hrfileopt").val()?(pageId.find("#hrfileoptdiv").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.lookupfielderr")+"</span>"),ZPeopleComponents.select(pageId.find("#hrfileopt")).getElement().addClass("ztextbox__error"),err=!0):hrfileoptval=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("select#hrfileopt").val()):(pageId.find("#hrfileoptdiv").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.zs.anyopt")+"</span>"),err=!0),ZPSetupCommon.isEmpty(hrfileoptval)||"-1"==hrfileoptval||formData.append("hrfileoptval",hrfileoptval.toString())}var addtofileupload=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("#addtoformfieldselect").val();"-1"!=addtofileupload&&null!=addtofileupload&&formData.append("addtofileupload",addtofileupload);var redSuccess=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input#redSuccess").val(),redCompleted=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input#redCompleted").val(),redDeclined=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input#redDeclined").val(),redLater=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input#redLater").val();if(void 0!=redSuccess&&0!=redSuccess.length&&formData.append("redSuccess",redSuccess),void 0!=redCompleted&&0!=redCompleted.length&&formData.append("redCompleted",redCompleted),void 0!=redDeclined&&0!=redDeclined.length&&formData.append("redDeclined",redDeclined),void 0!=redLater&&0!=redLater.length&&formData.append("redLater",redLater),!ZPA_Esign.validation(formData))return void 0!=Zsign.userListArray&&0!=Zsign.userListArray.length&&formData.append("userListArray",Zsign.userListArray),err||(save||ZPA_Esign.Slider.esflowModal.nextTab(!0),formData)},saveEsignTabData:function(){var formData=ZPA_Esign.setCommonEsignformData(),model=ZPA_Esign.Slider.esflowModal,formId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("select#fname").val();ZPA_Esign.isCardInitialLoad(model,"cardInitialsetup")||(formData=ZPA_Esign.validateTab1(formData,!0),-1==ZPA_Esign.tabNumList.indexOf("1")&&ZPA_Esign.tabNumList.push("1"),1!=formData)?ZPA_Esign.isCardInitialLoad(model,"cardRecipients")||(formData=ZPA_Esign.validateTab2(formData,!0),-1==ZPA_Esign.tabNumList.indexOf("2")&&ZPA_Esign.tabNumList.push("2"),1!=formData)?ZPA_Esign.isCardInitialLoad(model,"cardDocumentdetails")||(formData=ZPA_Esign.validateTab3(formData,!0),-1==ZPA_Esign.tabNumList.indexOf("3")&&ZPA_Esign.tabNumList.push("3"),1!=formData)?ZPA_Esign.isCardInitialLoad(model,"cardAdditionaloptions")||(formData=ZPA_Esign.validateTab4(formData,!0),-1==ZPA_Esign.tabNumList.indexOf("4")&&ZPA_Esign.tabNumList.push("4"),1!=formData)?(formData.append("tabNumList",ZPA_Esign.tabNumList),$.ajax({url:"/zpzsign/saveEsignConfig",type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){if(ZPA_Esign.templateEdit?ZPeople.Message.success(ZPI18N.getString("zp.esignflowupdsucc")):ZPeople.Message.success(ZPI18N.getString("zp.esignflowaddsucc")),ZPA_Esign.closeCallback(),ZPA_Esign.resetuploadValues(),settingsUrlProps.niceUrl.lastIndexOf("/custombutton")>-1||settingsUrlProps.niceUrl.lastIndexOf("/workflow")>-1)ZPA_Actions.callBackActions(ZP_Automation_Mode.ESIGN,data[1]);else{var pageId=ZPA_Common.getParentPageId();if(pageId.find("tr[cid='"+data[1].confId+"']").length>0)$(pageId.find("tr[cid='"+data[1].confId+"']").find("td")[0]).find("span").html(data[1].confName);else{var esignFormId=ZPeopleComponents.select("#"+ZPA_Common.getFormListId(ZP_Automation_Mode.ESIGN)).getValue();if(0==esignFormId||formId==esignFormId){var dataObj=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.ESIGN,ZPA_Common.getServiceName())],formName="";if($.each(dataObj,function(_indx,val){val.formId!=formId||(formName=val.dispName)}),pageId.find("[id=emptPage]").length>0){pageId.find("[id=emptPage]").remove();var body='<div name="action_body" class="zpl_tblres"><table class="zpl_tbl"><thead><tr><th width="400">'+ZPI18N.getString("zp.name")+"</th><th>"+ZPI18N.getString("zp.esign.formname")+'</th><th width="80"></th></tr></thead><tbody>';pageId.append(body),settingsPage.container.find("#add_esign").show()}var newRec="<tr onclick=\"ZPA_Esign.edit('"+data[1].confId+"', '"+formId+'\')" cid="'+data[1].confId+'" formid="'+formId+'"><td><span>'+data[1].confName+"</span></td><td><span>"+ZSEC.Encoder.encodeForHTML(formName)+'</span></td><td width="10%"><div class="zpl_hvr"><i action="delete" title="'+ZPI18N.getString("zp.delete")+'" data-title-display-type="callout" class="PI_delete" recordId="'+data[1].confId+'"  onclick="ZPA_Common.deleteConfirmationPopup(this, \'esign\', Zsign.deleteEsignConfig)"></i></div></td></tr>';pageId.find("div[name=action_body]").find("tbody").append(newRec)}}}},error:function(data){var pageId=ZPA_Common.getParentPageId();if(-1!=data.responseText.search("File size is greater than allocated limit")||8100==data.responseJSON[1].errorCode){var errorMsg=data.responseJSON[1].msg.substring(data.responseJSON[1].msg.indexOf("-")+1);return ZPA_Esign.Slider.esflowModal.showTab(1),ZPeople.Message.failure(errorMsg),void Zsign.enableSaveBtn(pageId,"sliderSbt")}if(-1!=data.responseText.search("mailmerge")){errorMsg="";return errorMsg=JSON.parse(JSON.parse(req.responseText)[1].msg).error.message,ZPeople.Message.failure(errorMsg),void Zsign.enableSaveBtn(pageId,"sliderSbt")}if(400!==data.status){var errResponse=data.responseJSON[1];if(8026==errResponse.errorCode||9999==errResponse.errorCode||9995==errResponse.errorCode||9994==errResponse.errorCode||9996==errResponse.errorCode||8100==errResponse.errorCode||8101==errResponse.errorCode||7569==errResponse.errorCode)return ZPeople.Message.failure(errResponse.msg),void Zsign.enableSaveBtn(pageId,"sliderSbt");"string"==typeof errResponse.msg&&ZPeople.Message.failure(errResponse.msg)}else{if("PATTERN_NOT_MATCHED"==data.responseJSON.code){var textParam=ZPI18N.getString("zp.field");"document_name"!=data.responseJSON.paramName&&"config_name"!=data.responseJSON.paramName||(textParam=ZPI18N.getString("zp.esign.docname")),"document_message"!=req.responseJSON.paramName&&"automation_message"!=data.responseJSON.paramName||(textParam=ZPI18N.getString("zp.message")),ZPeople.Message.failure(ZPI18N.getString("zp.entervalidinputforesign",new Array(textParam)))}else if("MORE_THAN_MAX_LENGTH"==data.responseJSON.code){if("automation_message"==data.responseJSON.paramName)return void ZPA_Esign.Slider.esflowModal.showTab(3)}else ZPeople.Message.failure(data.responseJSON.error);Zsign.enableSaveBtn(pageId,"saveButton")}}})):ZPA_Esign.Slider.esflowModal.showTab(4):ZPA_Esign.Slider.esflowModal.showTab(3):ZPA_Esign.Slider.esflowModal.showTab(2):ZPA_Esign.Slider.esflowModal.showTab(1)},resetuploadValues:function(){ZPA_Esign.Uploadsource="",ZPA_Esign.uploadMode=""},validation:function(formData){$(".ERR").remove();var err=!1,pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId),redSuccess=(maxFileSize.split("MB")[0],$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input#redSuccess").val()),redCompleted=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input#redCompleted").val(),redDeclined=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input#redDeclined").val(),redLater=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("input#redLater").val();Zsign.checkZSFeature(),Zsign.getZSPaymentURL();var urlregex=new RegExp("^(ht|f)tp(s?)://[-.w]*(/?)([a-zA-Z0-9-.?,:'/\\+=&amp;%$#_@]*)?$");void 0!=redSuccess&&0!=redSuccess.length&&(Zsign.zsFeatureList.redirection?urlregex.test(redSuccess)||(errMsg=ZPI18N.getString("zp.cbtmapacturlempty"),err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton")>-1?(pageId.find("#redSuccess").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),pageId.find("#redSuccess").addClass("ztextbox__error")):(pageId.find("#redSuccess").addClass("ztextbox__error"),pageId.find("#redSuccess").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"))):(errMsg=ZPI18N.getString("zp.zsign.redirectionerr",new Array(Zsign.zsignPricingUrl)),err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),pageId.find("#redSuccess").addClass("ztextbox__error"),pageId.find("#redSuccess").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"))),void 0!=redCompleted&&0!=redCompleted.length&&(Zsign.zsFeatureList.redirection?urlregex.test(redCompleted)||(err=!0,errMsg=ZPI18N.getString("zp.cbtmapacturlempty"),Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),pageId.find("#redCompleted").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),pageId.find("#redCompleted").addClass("ztextbox__error")):(errMsg=ZPI18N.getString("zp.zsign.redirectionerr",new Array(Zsign.zsignPricingUrl)),err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),pageId.find("#redCompleted").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),pageId.find("#redCompleted").addClass("ztextbox__error"))),void 0!=redDeclined&&0!=redDeclined.length&&(Zsign.zsFeatureList.redirection?urlregex.test(redDeclined)||(err=!0,errMsg=ZPI18N.getString("zp.cbtmapacturlempty"),Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),pageId.find("#redDeclined").addClass("ztextbox__error"),pageId.find("#redDeclined").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>")):(errMsg=ZPI18N.getString("zp.zsign.redirectionerr",new Array(Zsign.zsignPricingUrl)),err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),pageId.find("#redDeclined").addClass("ztextbox__error"),pageId.find("#redDeclined").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"))),void 0!=redLater&&0!=redLater.length&&(Zsign.zsFeatureList.redirection?urlregex.test(redLater)||(err=!0,errMsg=ZPI18N.getString("zp.cbtmapacturlempty"),Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton")>-1?(pageId.find("#redLater").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),pageId.find("#redLater").addClass("ztextbox__error")):(pageId.find("#redLater").addClass("ztextbox__error"),pageId.find("#redLater").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"))):(errMsg=ZPI18N.getString("zp.zsign.redirectionerr",new Array(Zsign.zsignPricingUrl)),err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),pageId.find("#redLater").addClass("ztextbox__error"),pageId.find("#redLater").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>")));var userListArray=[];if($("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("#notify_Mail").is(":checked")){var userList=ZPeopleComponents.tokenfield(document.getElementById("zsignNotifyUsers")).getAllValues();0==userList.length&&(err=!0,ZPeopleComponents.tokenfield(pageId.find("#zsignNotifyUsers")).getElement().addClass("ztextbox__error"),pageId.find("#zsignNotifyUsers").parent().parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.notifyusererr")+"</span>"));for(var i=0,l=userList.length;i<l;i++){var userErecNo=$(userList)[i].id;userListArray.push(userErecNo)}0!=userListArray.length&&(Zsign.userListArray=JSON.stringify(userListArray))}else Zsign.userListArray="";return err},toggleUploadSection:function(type){var fromForm=!1,pageId=$("#esignforms_card");void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(pageId=$("#esignforms_card"),fromForm=!0):pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId),1==type?($("#mailmergeInfo").removeClass("DN"),pageId.find("#input_esignTempUpload").attr("checked",!1),pageId.find("#input_esignDefUpload").attr("checked",!0),pageId.find("#uploadSectionBody_zsigntemp").addClass("DNI"),pageId.find("#uploadSectionBody").removeClass("DNI"),pageId.find("#attachments").find("h5").text(ZPI18N.getString("zp.esign.uploadedfiles")),pageId.find("#zsignTempAttach").addClass("DN"),pageId.find("#attachments").find(".zpl_atchd").html().trim().length>0?pageId.find("#attachments").removeClass("DN"):pageId.find("#attachments").addClass("DN"),fromForm&&pageId.find("#zsignFormat").removeClass("DN")):2==type&&($("#mailmergeInfo").addClass("DN"),pageId.find("#input_esignDefUpload").attr("checked",!1),pageId.find("#input_esignTempUpload").attr("checked",!0),pageId.find("#uploadSectionBody").addClass("DNI"),0==pageId.find("#zsignTempAttach .zpl_atchd").find("div").length&&pageId.find("#uploadSectionBody_zsigntemp").removeClass("DNI"),pageId.find("#attachments").addClass("DN"),pageId.find("#zsignTempAttach").find(".zpl_atchd").html().trim().length>0?pageId.find("#zsignTempAttach").removeClass("DN"):pageId.find("#zsignTempAttach").addClass("DN"),fromForm&&pageId.find("#zsignFormat").addClass("DN"),Zsign.checkZSFeature(),Zsign.zsFeatureList.templates||(pageId.find("#uploadSectionBody_zsigntemp").addClass("disabled"),Zsign.getZSPaymentURL(),ZAlertBanner.show({message:ZPI18N.getString("zp.zsign.unsupported",new Array(ZPI18N.getString("zp.templates"),Zsign.zsignPricingUrl)),type:"warning",hideDelay:1e4,closeButton:!0,icon:!0,animation:{show:{name:"slideDown",duration:500},hide:{name:"slideUp",duration:500}},icon:!0,pauseOnMouseOver:!0,hideDelay:4e3,closeButton:!0,beforeshow:ZPeople.Message.beforeShow})))},isCardInitialLoad:function(model,cardId){return 0==model.modalDiv.find("#cardRightDiv").find("#"+cardId).children().length}};ZPA_Esign.Slider={removeMergeFields:function(cPageId){var pageId;if((pageId=void 0!=cPageId?$(cPageId):Zsign.getEsignPageId()).find($("#mergeFields")).length>0)for(var merLeng=pageId.find($("#mergeFields").find(".zpl_secn.zpl_mailtmp")).length,l=0;l<merLeng;l++){var fieldId=pageId.find($($($("#mergeFields").find(".zpl_secn.zpl_mailtmp"))[l]).find("div")[1]).find("select")[0].id;ZPeopleComponents.select(pageId.find("#"+fieldId)).destroy()}pageId.find($("#zsMergeSec")).remove()},removeZTElementsfn:function(){var pageId="";if(pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1||$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).has("div").length>0){if(pageId.find("#attachments .zpl_atchd").find("[name='fileOutDiv']").length>0){var dataObj=pageId.find("#attachments .zpl_atchd").find("[name='fileOutDiv']");$.each(dataObj,function(index,_value){var source=$(dataObj[index]).find(".zpl_atchdtl").find("#fileName").attr("source"),selId=$(dataObj[index]).find(".zpl_atchdtl").find("#fileName").attr("selid");"templates"==source?ZPeopleComponents.dropdownlist(document.getElementById("TemplateOptionsList")).deselect({id:selId}):"fileupload"==source&&ZPeopleComponents.dropdownlist(document.getElementById("fileRoleOptionsList")).deselect({value:selId})})}if(pageId.find("#zsignTempAttach .zpl_atchd").find("[name='fileOutDiv']").length>0){dataObj=pageId.find("#zsignTempAttach .zpl_atchd").find("[name='fileOutDiv']");var selId=$(dataObj[0]).find(".zpl_atchdtl").find("#fileName").attr("selid");ZPeopleComponents.dropdownlist(document.getElementById("zsignTempOptionsList")).deselect({id:selId}),pageId.find($("#zsignTempAttach").find("[name='fileOutDiv']")).remove()}ZPA_Esign.Slider.removeMergeFields()}if(ZPA_Esign.recpRowId=0,(pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId)).find("#signing_order").removeAttr("Checked"),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1||$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId).has("div").length>0){var recprowLen=$("#esbdy_recp").find("#recpRows").find("[name='recp_row']").length;if(recprowLen>0)for(var ele=0;ele<recprowLen;ele++){var eleId=pageId.find("[name=recpType]")[ele].id.split("_")[1];if(ZPeopleComponents.isComponent(pageId.find("#"+$('[id^="recpType"]')[eleId].id))&&ZPeopleComponents.select(pageId.find("#"+$('[id^="recpType"]')[eleId].id)).destroy(),ZPeopleComponents.isComponent(pageId.find("#"+$('[id^="recpLocale"]')[eleId].id))&&ZPeopleComponents.select(pageId.find("#"+$('[id^="recpLocale"]')[eleId].id)).destroy(),ZPeopleComponents.isComponent(pageId.find("#"+$('[id^="recpFormValue"]')[eleId].id))&&ZPeopleComponents.select(pageId.find("#"+$('[id^="recpFormValue"]')[eleId].id)).destroy(),ZPeopleComponents.isComponent(pageId.find("#"+$('[id^="recpFieldValue"]')[eleId].id))&&ZPeopleComponents.select(pageId.find("#"+$('[id^="recpFieldValue"]')[eleId].id)).destroy(),$("#privateMesspop_"+eleId).length>0&&($("#privateMesspop_"+eleId).val(""),$("#tabprivMessPopup_"+eleId).remove()),$("#verifyOn_"+eleId).length>0){var verId=$("#verifyOn_"+eleId)[0].id;$("#verifyOn_"+eleId).attr("toRemove",!1),ZPeopleComponents.isComponent($("#"+verId))&&ZPeopleComponents.toggleswitch($("#"+verId)).destroy(),$("#tabauthPopup_"+eleId).remove(),$("#cardauthPopup_"+eleId).remove()}if(pageId.find($("#recpHost_"+eleId)).length>0){var hostId=pageId.find($("#recpHost_"+eleId))[0].id;ZPeopleComponents.isComponent(pageId.find("#"+hostId))&&ZPeopleComponents.select(pageId.find("#"+hostId)).destroy(),pageId.find("#"+hostId).parent().parent().closest("[name='hostRow']").remove()}}if(recprowLen>0)for(ele=0;ele<recprowLen;ele++){eleId=pageId.find("[name=recpName]")[0].id.split("_")[1];pageId.find($("#recpName_"+eleId)).length>0&&pageId.find($("#recpName_"+eleId)).parent().parent().remove()}}void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1||$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).has("div").length>0&&ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("select#fTempOpt")).destroy(),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?pageId=$("#esignforms_card"):(pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId),$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).has("div").length>0&&(ZPeopleComponents.select(pageId.find("select#hrfileopt")).destroy(),ZPeopleComponents.select(pageId.find("select#dateFieldOpt")).destroy(),ZPeopleComponents.select(pageId.find("select#addtoformfieldselect")).destroy(),ZPeopleComponents.tokenfield(pageId.find("#zsignNotifyUsers")).destroy()))},removeElementsfn:function(){$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).has("div").length>0&&(ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("select#fname")).destroy(),ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("select#agrselect_Cat")).destroy(),$("#"+ZPA_Esign.Slider.esflowModal.tabs[0].cardId).find("#config_name").val("")),ZPA_Esign.Slider.removeZTElementsfn(),ZPA_Esign.Slider.esflowModal.remove(),ZPA_Esign.editData="",ZPA_Esign.templateEdit=!1,Zsign.resetSliderValues(),ZPA_Esign.tabNumList=[],ZPA_Esign.fileNameList=new Set},recpLocale:function(){var recpLocale='<option value="zh">Chinese</option>';return recpLocale+='<option value="nl">Dutch</option>',recpLocale+='<option value="en">English</option>',recpLocale+='<option value="fr">French</option>',recpLocale+='<option value="de">German</option>',recpLocale+='<option value="it">Italian</option>',recpLocale+='<option value="ja">Japanese</option>',recpLocale+='<option value="pl">Polish</option>',recpLocale+='<option value="pt">Portuguese</option>',recpLocale+='<option value="ru">Russian</option>',recpLocale+='<option value="es">Spanish</option>',recpLocale+='<option value="sv">Swedish</option>',recpLocale+='<option value="ar">Arabic</option>',recpLocale+='<option value="he">Hebrew</option>'},setLocaleForRecp:function(attachDiv){return{options:ZPA_Esign.Slider.recpLocaleList(),dataMapping:{label:"label",value:"value"},showSearchField:!0,viewPerPage:12,lazyLoading:!0,bodyItemVisibleCount:3,dropdownList:{appendTo:attachDiv,fitForElement:!0,moveOnScroll:!0}}},setTypeForRecp:function(attachDiv){return{options:ZPA_Esign.Slider.recTypeList(),dataMapping:{label:"label",value:"value"},change:ZPA_Esign.Slider.constructHost,showSearchField:!0,viewPerPage:4,lazyLoading:!0,bodyItemVisibleCount:3,dropdownList:{appendTo:attachDiv,fitForElement:!0,moveOnScroll:!0}}},recpFormOptions:function(type){var recpFormOptions='<option value="1">'+ZPI18N.getString("zp.emailaddressfield")+"</option>";return isZSConfig&&(recpFormOptions+='<option value="2">'+ZPI18N.getString("zp.esign.lookupfield")+'</option><option value="3">'+ZPI18N.getString("zp.esign.specuser")+"</option>",recpFormOptions+='<option value="5">'+ZPI18N.getString("zp.manager")+"</option>"),"manager"==type&&(recpFormOptions='<option value="5">'+ZPI18N.getString("zp.manager")+"</option>"),recpFormOptions},recType:function(){var recpType='<option value="1">'+ZPI18N.getString("zp.sign")+'</option><option value="2">'+ZPI18N.getString("zp.view")+"</option>";return isZSConfig&&(Zsign.checkZSFeature(),Zsign.zsFeatureList.approver&&(recpType+='<option value="3">'+ZPI18N.getString("zp.approve")+"</option>"),Zsign.zsFeatureList.in_person_signing&&(recpType+='<option value="4">'+ZPI18N.getString("zp.inperson")+"</option>")),recpType},recTypeList:function(){var recpType=[{value:1,label:ZPI18N.getString("zp.sign")},{value:2,label:ZPI18N.getString("zp.view")}];return isZSConfig&&(Zsign.checkZSFeature(),Zsign.zsFeatureList.approver&&recpType.push({value:3,label:ZPI18N.getString("zp.approve")}),Zsign.zsFeatureList.in_person_signing&&recpType.push({value:4,label:ZPI18N.getString("zp.inperson")})),recpType},recpLocaleList:function(){var recpLocaleList=[];return recpLocaleList.push({value:"zh",label:"Chinese"}),recpLocaleList.push({value:"nl",label:"Dutch"}),recpLocaleList.push({value:"en",label:"English"}),recpLocaleList.push({value:"fr",label:"French"}),recpLocaleList.push({value:"de",label:"German"}),recpLocaleList.push({value:"it",label:"Italian"}),recpLocaleList.push({value:"ja",label:"Japanese"}),recpLocaleList.push({value:"pl",label:"Polish"}),recpLocaleList.push({value:"pt",label:"Portuguese"}),recpLocaleList.push({value:"ru",label:"Russian"}),recpLocaleList.push({value:"es",label:"Spanish"}),recpLocaleList.push({value:"sv",label:"Swedish"}),recpLocaleList.push({value:"ar",label:"Arabic"}),recpLocaleList.push({value:"he",label:"Hebrew"}),recpLocaleList},deliveryType:function(){var deliveryType={};return deliveryType[1]=ZPI18N.getString("zp.mail"),deliveryType},showRecipientfldOpt:function(thisObj){ZPA_Esign.resetAllErrorborder(),ZPA_Esign.managerAdded=!1;var pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId),id=$($(thisObj.detail.element[0].closest("[name='recp_row']")).find("[name='recpFieldValue']"))[0].id,eleID=id.substring(id.length-1);if($("#recpEmailValue_"+eleID).addClass("DN"),$("#"+id).removeClass("DN"),pageId.find("#"+id).parent().find("#emrepmngr").addClass("DNI"),1==thisObj.detail.element.val())ZPeopleComponents.select(pageId.find("#"+id)).removeAllOptions(),ZPeopleComponents.select(pageId.find("#"+id)).destroy(),Object.keys(Zsign.emailidfield.formId).length>0?ZPeopleComponents.select(pageId.find("#"+id)).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.emailidfield.formId)):ZPeopleComponents.select(pageId.find("#"+id));else if(2==thisObj.detail.element.val())ZPeopleComponents.select(pageId.find("#"+id)).removeAllOptions(),ZPeopleComponents.select(pageId.find("#"+id)).destroy(),Zsign.attachLookupOpts(pageId,pageId.find("#"+id));else if(3==thisObj.detail.element.val())if(ZPeopleComponents.isComponent(pageId.find("#"+id))){ZPeopleComponents.select(pageId.find("#"+id)).removeAllOptions();var options=Zsign.constructAddEmpListSel();ZPeopleComponents.select(pageId.find("#"+id)).setAttributes(options)}else ZPeopleComponents.select(pageId.find("#"+id),Zsign.constructAddEmpListSel());else 5==thisObj.detail.element.val()&&($("#recpEmailValue_"+eleID).addClass("DN"),ZPeopleComponents.select(pageId.find("#"+id)).removeAllOptions(),ZPeopleComponents.select(pageId.find("#"+id)).destroy(),$("#"+id).addClass("DN"),pageId.find("#"+id).parent().find("#emrepmngr").removeClass("DNI"));var row=pageId.find("#recpRows").find("[name=recp_row]");$.each(row,function(_rowLen,val){"5"==$(val).find("[name=recpFormValue]").val()&&(ZPA_Esign.managerAdded=!0)})},constructHost:function(thisObj){var selId=$("#"+thisObj.detail.container[0].id).parent("div.zpl_rwfld").find("[name=recpType]")[0].id,elementDiv=$("#esbdy_recp"),formId="";"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")?elementDiv=$("#esignorg_card"):"tab-files-esigndocuments"==settingsPage.container[0].id?elementDiv=$("#esign_card"):void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(elementDiv=$("#esignforms_card"),formId=void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId?ZP5Form.getCurrFormsOperation().formId:ZP5Form.getFormClassObj().getParams().formId):"0"==FilesUtil.Page.getTabGroup()&&(elementDiv=$("#cardesignfiles"));var index=selId.split("_")[1];if("4"==thisObj.detail.value){if(null==Zsign.ZsignUserList){var params={conreqcsr:csrfToken,formId:formId};$.ajax({url:"/zpzsign/getZSignUserList",type:"POST",data:params,success:function(data){Zsign.setZSignUserList(data),ZPeopleComponents.isComponent(elementDiv.find($("#recpHost_"+index)))&&ZPeopleComponents.select(elementDiv.find($("#recpHost_"+index))).removeAllOptions(),ZPeopleComponents.select(elementDiv.find($("#recpHost_"+index))).addOption(ZPA_Esign.constructZSignUserList(Zsign.ZsignUserList)),ZPeopleComponents.select(elementDiv.find($("#recpHost_"+index))).setAttribute("selectedValue",thisObj.detail.selectedValue),$(elementDiv.find("#recpHost_"+index).closest("div[name=hostRow]")).removeClass("DNI")},failure:function(data){Zsign.failedCallBack(data)}})}ZPeopleComponents.isComponent(elementDiv.find($("#recpHost_"+index)))&&ZPeopleComponents.select(elementDiv.find($("#recpHost_"+index))).removeAllOptions(),ZPeopleComponents.select(elementDiv.find($("#recpHost_"+index))).addOption(ZPA_Esign.constructZSignUserList(Zsign.ZsignUserList)),ZPeopleComponents.select(elementDiv.find($("#recpHost_"+index))).setAttribute("selectedValue",thisObj.detail.selectedValue),$(elementDiv.find("#recpHost_"+index).closest("div[name=hostRow]")).removeClass("DNI")}else $(elementDiv.find("#recpHost_"+index).closest("div[name=hostRow]")).addClass("DNI")},addRecp:function(index,value){if(void 0==(index=ZPA_Esign.recpRowId)||void 0!=index&&void 0==index.detail||!index.detail.isMenuButton){var lengthRow=$("#esbdy_recp").find("#recpRows").find("[name='recp_row']").length;void 0!=index&&""!=index||(index=lengthRow);var recp='<div name="recp_parent" style="margin-top: 15px;"><div name="recp_row" class="zpl_idiv"><div class="zpl_rwfld w20 d-flexC j-cnt-cntr"><i class="PI_drag gry"></i></div><div class="zpl_rwfld w45">';if(recp+='<input type="text" class="ztextbox" name="recp_row_input" disabled id="recp_row_'+index+'" value='+($("#esbdy_recp").find("#recpRows").find("[name='recp_row']").length+1)+'></div><div class="zpl_rwfld w100"><input type="text" name="recpName" id="recpName_'+index+'" class="ztextbox" style="width: 100%;" placeholder="'+ZPI18N.getString("zp.role")+'">',recp+="</div>",recp+='<div class="zpl_rwfld w200"><select type="text"  name="recpFormValue" id="recpFormValue_'+index+'" class="ztextbox" value=""></select>',recp+='</div><div class="zpl_rwfld w300"><select type="text" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5" name="recpFieldValue" id="recpFieldValue_'+index+'" class="ztextbox" value=""></select>',recp+='<div name="emrepmngr" id="emrepmngr" class="DNI zlabel zlabel--medium is-disabled w250">'+ZPI18N.getString("zp.esign.lookupreportingmanager")+"</div>",recp+="</div>",recp+='<div class="zpl_rwfld w150"><select type="text" id="recpType_'+index+'" name="recpType" class="ztextbox" value="" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="4"></select>',recp+="</div>",recp+='<div class="zpl_rwfld w150">',recp+='<select type="text" name="recpLocale" id="recpLocale_'+index+'" class="ztextbox" value="" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5" ></select>',recp+="</div>",recp+='<div class="zpl_rwfld w100" style="min-width: 100px;width:auto"><div class="zpl_hvr d-flex flt_n"><i class="PI_file_encrypt" onclick="ZPA_Esign.showPrivateMsgPop(this)" data-toggle="tooltip" title="'+ZPI18N.getString("zp.esign.privatenotehdr")+'" ></i><i class="PI_key" onclick="ZPA_Esign.showAuthCodePop(this)" data-toggle="tooltip" title="'+ZPI18N.getString("zp.esign.authentication")+'" ></i><i id="deleteRecp" name="deleteRecp" class="PI_delete" onclick="ZPA_Esign.deleteRecipient(this)" data-toggle="tooltip" title="'+ZPI18N.getString("zp.delete")+'"></i></div></div>',recp+="</div>",recp+='<div class="zpl_idiv DNI" name="hostRow" style="padding-left: 25px;"><div class="zpl_rwfld" style="width: 60px;"><div class="zlabel zlabel--medium is-disabled">'+ZPI18N.getString("zp.host")+'</div></div><div class="zpl_rwfld"><select type="text" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5" name="recpHost" id="recpHost_'+index+'" class="ztextbox" value="" onclick="ZPA_Esign.resetErrorborder(this)"></select></div></div></div>',0==index?0==$("#esbdy_recp").find("#recpRows").find("#addRowsDiv").length?$("#esbdy_recp").find("#recpRows").append(recp):$("#esbdy_recp").find("#addRowsDiv").before(recp):$("#esbdy_recp").find("#recpRows").find("#addRowsDiv").before(recp),void 0==value&&(value="userbtnId"),"userbtnId"==value||"manager"==value){var selectedEle=$($("#esbdy_recp").find("#recpRows").find("div[name=recp_row]")).last();if(selectedEle.length>0){selectedEle.find("#recpName_"+index).parent().addClass("DN");var recTypeProp={options:ZPA_Esign.Slider.recTypeList(),dataMapping:{label:"label",value:"value"},change:ZPA_Esign.Slider.constructHost,showSearchField:!0,viewPerPage:4,lazyLoading:!0,bodyItemVisibleCount:3,dropdownList:{appendTo:$("#esignSecBdyCont"),fitForElement:!0,moveOnScroll:!0}};if(ZPeopleComponents.select(selectedEle.find("select[name=recpType]"),recTypeProp),ZPeopleComponents.select(selectedEle.find("select[name=recpFormValue]").append(ZPA_Esign.Slider.recpFormOptions(value))),"userbtnId"==value){$("select[name=recpFormValue]").on("zselectchange",ZPA_Esign.Slider.showRecipientfldOpt),ZPeopleComponents.isComponent(selectedEle.find("[name=recpFieldValue]"))&&ZPeopleComponents.select(selectedEle.find("[name=recpFieldValue]")).removeAllOptions(),Object.keys(Zsign.emailidfield.formId).length>0?ZPeopleComponents.select(selectedEle.find("[name=recpFieldValue]")).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.emailidfield.formId)):ZPeopleComponents.select(selectedEle.find("[name=recpFieldValue"));ZPeopleComponents.select(selectedEle.find("[name=recpFieldValue]"),{dropdownList:{direction:"bottom-right"}}),selectedEle.find("#emrepmngr").addClass("DNI")}else if("manager"==value){selectedEle.find("[name=recpName]").val("Manager");var recpFieldValue=$($("[name='recpFieldValue']").last())[0].id;$("#"+recpFieldValue).addClass("DNI"),selectedEle.find("#emrepmngr").removeClass("DNI")}ZPeopleComponents.select(selectedEle.find("select[name=recpLocale]").append(ZPA_Esign.Slider.recpLocale)),ZPeopleComponents.select(selectedEle.find("select[name=recpLocale]")).setAttribute("selectedValue","en")}}ZPeopleComponents.sortable($("#cardRecipients").find("#recpRows"),{region:"parent",cancelOnEscKey:!0,restrictExternalItem:!0,change:ZPA_Esign.sortOrder,items:"div[name='recp_parent']",handle:".PI_drag",axis:"y"})}ZPA_Esign.recpRowId++}},ZPA_Esign.containerBody={CONFIGURATION:'<div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.formname")+'</label></div><div><select type="text" id="fname" class="ztextbox" value=""></select></div></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.flowname")+'</label></div><div><input type="text" id="config_name" placeholder="" autocomplete="off" class="ztextbox"></div></div><div class="zpl_secn DN" id="uploadSection"><div id="uploadSectionHeader"><label class="zpl_mtry">'+ZPI18N.getString("zp.files.operations.selectfile")+'</label></div><div class="zpl_secn"><div><div class="zradiobutton zradiobutton--horizontal"><input id="input_esignDefUpload" type="radio" name="esignUploadType" class="zradiobutton__helper" checked><label onclick="ZPA_Esign.toggleUploadSection(1);" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.uploaddoc")+'</span></label></div><div class="zradiobutton zradiobutton--horizontal"><input id="input_esignTempUpload" type="radio" name="esignUploadType" class="zradiobutton__helper"><label onclick="ZPA_Esign.toggleUploadSection(2);" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.esign.zsigntemplate")+'</span></label></div></div></div><div id="uploadSectionBody" class="zpl_upld zpl_gbox"><div id="drop_area" ondrop="event.stopPropagation(); event.preventDefault(); ZPA_Esign.dropHandler(event)" ondragover="event.preventDefault();" class="zpl_fldrp"><h5><div class="zpl_flupld_img"></div><div name="fileRoleOptions" id="fileRoleOptions" onclick="ZPA_Esign.showfileuploadDropdown()" class="zselectbox select-js has-focus has-mfocus flslct wauto"><option>'+ZPI18N.getString("zp.esign.fileuploadfield")+'</option><i class="zselectbox__icon zselectbox__arrowicon"><svg class="zselectbox__arrow" focusable="false"><use xlink:href="#zc__svg--downarrow"></use></svg></i></div><div id="fileRoleOptionsList" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5"></div><div id="tempRoleOptions" onclick=ZPA_Esign.showTemplateDropdown() class="zselectbox select-js has-focus has-mfocus flslct wauto"><option>'+ZPI18N.getString("zp.esign.mailmerge.small")+'</option><i class="zselectbox__icon zselectbox__arrowicon"><svg class="zselectbox__arrow" focusable="false"><use xlink:href="#zc__svg--downarrow"></use></svg></i></div><div id="TemplateOptionsList" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5"></div><input id="uploadESFile" type="file" data-text="Desktop" style="display:none;"><a id="localUpload" onclick="ZPA_Esign.localUpload()" class="zpl_lnk"><i class="PI_case"></i>'+ZPI18N.getString("zp.files.desktop")+'</a> / <a class="zpl_lnk" onClick="ZPA_Esign.cloudUpload()"><i class="PI_cloud"></i>'+ZPI18N.getString("zp.files.cloud")+'</a></h5></div><p><span><span id="zsignFormat">'+ZPI18N.getString("zp.filessuported")+" : "+ZPA_Esign.zsignCompatibleExtns+'</span><span> Maximum size: 5MB</span></p></div><div id="uploadSectionBody_zsigntemp" class="zpl_upld zpl_gbox DNI"><div id="drop_area" ondrop="event.stopPropagation(); event.preventDefault();" ondragover="event.preventDefault();" class="zpl_fldrp"><h5><div class="zpl_flupld_img"></div><div id="zsignTempList" onclick=ZPA_Esign.showZsignDropdown() class="zselectbox select-js has-focus has-mfocus flslct wauto" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5" ><option >'+ZPI18N.getString("zp.esign.zsigntemplate")+'</option><i class="zselectbox__icon zselectbox__arrowicon"><svg class="zselectbox__arrow" focusable="false"><use xlink:href="#zc__svg--downarrow"></use></svg></i></div><div id="zsignTempOptionsList"></div></h5></div><p><span> Maximum size: 5MB</span></p></div><div class="zpl_secn DN" id="attachments"><div><h5>'+ZPI18N.getString("zp.esign.uploadedfiles")+'</h5></div><div class="zpl_atchd"></div></div><div class="zpl_secn DN" id="zsignTempAttach"><div><h5>'+ZPI18N.getString("zp.esign.seltemp")+'</h5></div><div class="zpl_atchd"></div></div></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select type="text" id="agrselect_Cat" class="ztextbox" value=""></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+"</div></div></div></div></div></div></div>",RECIPIENTS:'<div class="zpl_secn d-flexC j-cnt-btwen"><div><div class="zcheckbox"><input id="signing_order" type="checkbox" name="check" class="zcheckbox__helper"><label for="signing_order" class="zcheckbox__label">'+ZPI18N.getString("zp.zsignsendinorder")+'</label></div></div></div><div class="zpl_secn"><div id="recpRows"></div></div>',DETAILS:'<div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div class="d-flex"><input type="text" id="document_name" placeholder="" class="ztextbox" autocomplete="off"></input><div class="w60 d-flexM"><i type="button" onclick="ZPA_Esign.showdocDropdown()" id="documentNameListDP" class="zpl_ibg zpl_drpdwn-js PI_addlist"></i></div><div id="documentNameList"></div></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><select type="text" id="fTempOpt" class="ztextbox" value=""></select></div></div><div class="zpl_secn"><div><div id="msgTemplate" style="border: 1px solid #dcdcdc;width: 100%; min-height: 100px; border-radius: 4px; padding:10px"></div></div></div>',OPTIONS:'<div class="zpl_secn"><div><div class="chkdectxt"><div class="zcheckbox" onclick="Zsign.showExpiryOptions(this)"><input id="showExpiryOptions"  type="checkbox" name="check"  class="zcheckbox__helper"><label for="showExpiryOptions" class="zcheckbox__label">'+ZPI18N.getString("zp.havedeadlineforsigning")+'</label></div></div></div><div class="zpl_tbox DNI" id="datefieldOptionscont"><div class="zpl_gbox"><div id="datefieldOptions"><div class="zradiobutton zradiobutton--horizontal" onclick="Zsign.showDateLookup(this)"><input type="radio" name="datelookup" id="datelookupid"  class="zradiobutton__helper"><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.esign.datelookup")+'</span></label></div><div class="zradiobutton zradiobutton--horizontal" onclick="Zsign.showDateLookup(this)"><input type="radio" name="datelookup" id="expdateid" value="1" class="zradiobutton__helper"><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.date")+'</span></label></div></div><div class="zpl_idiv" id="deadlinegrp"><div>'+ZPI18N.getString("zp.esign.selectdatelookupp")+'</div><div><input type="text" id="deadlinedays" autocomplete="off" class="ztextbox w60" placeholder="0"></div><div>'+ZPI18N.getString("zp.esign.daysafter")+'</div><div><select type="text" id="dateFieldOpt" class="ztextbox" value=""></select></div></div><div class="DNI" id="deadlineLabel"><div id="dlParent" style="position: relative;"><input name="deadline" data-format="date-short" data-calendar-icon="true" data-picker="true" data-clear-button="none" data-spin-buttons="none" data-width="258" class="DNI" id="deadline" autocomplete="off"></div></div><div id="expiry_in_days_div" class="DNI"><div class="zpl_idiv"><div><input type="text" id="expiry_in_days" autocomplete="off" class="ztextbox w60" placeholder="0"></div><div>'+ZPI18N.getString("zp.days")+'</div></div></div></div></div></div><div class="zpl_secn"><div><div class="chkdectxt"><div class="zcheckbox" onclick="Zsign.setDaysForReminder()"><input id="reminder_check" type="checkbox" name="check" class="zcheckbox__helper"><label for="reminder_check" class="zcheckbox__label">'+ZPI18N.getString("zp.esignremindertxt")+'</label></div></div></div><div id="reminder_freq" class="zpl_tbox DN"><div class="zpl_gbox"><div class="zpl_idiv"><div>'+ZPI18N.getString("zp.sendreminderonce",new Array(""))+'</div><div><input type="text" id="reminder_freqdayscnt" autocomplete="off" class="ztextbox w60" placeholder="0"></div><div></div>'+ZPI18N.getString("zp.days")+'</div></div></div></div><div class="zpl_secn DN" id="notifyDiv"><div><div class="chkdectxt"><div class="zcheckbox"><input id="notify_Mail" onclick="Zsign.displayUsers(event)" type="checkbox" name="check" class="zcheckbox__helper"><label for="notify_Mail" class="zcheckbox__label">'+ZPI18N.getString("zp.esignnotifyuser")+'</label></div></div></div><div class="zpl_tbox DN"><div class="zpl_gbox"><textarea id="zsignNotifyUsers"></textarea></div></div></div><div class="zpl_secn"><div><div class="chkdectxt"><div class="zcheckbox" onclick="Zsign.showOptions(this)"><input id="synctohrfiles" type="checkbox" name="check" class="zcheckbox__helper"><label for="synctohrfiles" class="zcheckbox__label">'+ZPI18N.getString("zp.addtohrfiles",new Array(""))+'</label></div></div></div><div class="zpl_tbox DNI" id="synctypeOptions"><div class="zpl_gbox"><div><div class="zradiobutton zradiobutton--horizontal" onclick="Zsign.showEmployeeLookup(this)"><input type="radio" id="optrecordbtn" name="optchosdrdbtn" class="zradiobutton__helper" ><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.esign.primarylookup")+'</span></label></div><div class="zradiobutton zradiobutton--horizontal" onclick="Zsign.showEmployeeLookup(this)"><input id="optotherbtn" type="radio" name="optchosdrdbtn" class="zradiobutton__helper"><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.emplookup")+'</span></label></div></div><div class="zpl_idiv DNI" id="hrfileoptdiv"><div><label>'+ZPI18N.getString("zp.esign.selectfield")+'</label></div><div><select type="text" id="hrfileopt" class="ztextbox" value=""></select></div></div></div></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.addtoformfield")+'</label></div><select type="text" id="addtoformfieldselect" class="ztextbox" value=""></select></div></div></div><div class="zpl_crd"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.redirectionheader")+"</h4><p>"+ZPI18N.getString("zp.redirectioncontent")+'</p></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectsuccess")+'</label></div><div><input type="text" placeholder="" autocomplete="off" id="redSuccess" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectlater")+'</label></div><div><input type="text" placeholder="" autocomplete="off" id="redLater" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectdecline")+'</label></div><div><input type="text" placeholder="" autocomplete="off" id="redDeclined" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectcomplete")+'</label></div><div><input type="text" placeholder="" autocomplete="off" id="redCompleted" class="ztextbox"></div></div></div></div>'},Zsign={add:{bodyNewSlider:'<div class="zpl_crd" id="basicDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.filedetails")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn" id="uploadSection"><div><h6 class="zpl_mtry">'+ZPI18N.getString("zp.esign.uploadfile")+'</h6></div><div><div class="zpl_upld"><div id="drop_area" ondrop="event.stopPropagation(); event.preventDefault(); Zsign.dropHandler(event)" ondragover="event.preventDefault();" class="zpl_fldrp"><h5><div class="zpl_flupld_img"></div><input id="uploadFile" type="file" data-text="Desktop" style="display: none" /><a id="localUpload" class="zpl_lnk"><i class="PI_case"></i>'+ZPI18N.getString("zp.files.desktop")+'</a> / <a class="zpl_lnk" onClick="CloudPicker.construct()"><i class="PI_cloud"></i>'+ZPI18N.getString("zp.files.cloud")+"</a></h5></div><p><span>"+ZPI18N.getString("zp.filessuported")+" : "+ZPA_Esign.zsignCompatibleExtns+'</span><span> Maximum size: 5MB</span></p></div></div></div><div class="zpl_secn" id="attachments"></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select id="agrselect_Cat"></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+'</div></div></div></div></div></div><div class="zpl_crd" id="docHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div><input id="document_name" autocomplete="off" type="text" class="ztextbox" /></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><textarea class="ztextbox" id="document_message" autocomplete="off" rows="3"></textarea></div></div></div></div><div class="zpl_crd" id="recpHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn d-flexC j-cnt-btwen"><div><div class="zcheckbox"><input id="signing_order" type="checkbox" name="signing_order" class="zcheckbox__helper"><label for="signing_order" class="zcheckbox__label">'+ZPI18N.getString("zp.zsignsendinorder")+'</label></div></div><div class="d-flexC"></div></div><div class="zpl_secn"><div id="recp_rows"><div id="addbttnrow" style="margin-top: 15px;" class="zpl_idiv"><div class="w20"></div><a class="zpl_lnkbg" id="addRecpbtn" onclick=Zsign.addRecpRows("userbtnId")> '+ZPI18N.getString("zp.esign.addrecp")+'</a></div></div></div></div></div><div id="moreSettings" class="DN"><div class="zpl_crd" id="optionHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.additionaloptions")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.havedeadlineforsigning")+'</label></div><div id="dlParent" style="position: relative;"><input name="deadline" id="deadline" data-format="date-short" data-calendar-icon="true" data-picker="true" data-clear-button="none" data-spin-buttons="none" data-width="258" style="display: none;"></div></div><div class="zpl_secn"><div class="chkdectxt"><div class="zcheckbox"><input id="reminder_check" type="checkbox" name="reminder_check" value="" class="zcheckbox__helper"><label class="zcheckbox__label" onclick="Zsign.setZSDaysForReminder();" >'+ZPI18N.getString("zp.esignremindertxt")+'</label></div><div id="reminder_setting" class="zpl_gbox" style="display: none"><div class="zpl_idiv"><div>'+ZPI18N.getString("zp.sendreminderonce",new Array(""))+' &nbsp; </div><div><input name="reminder_freqdayscnt" id="reminder_freqdayscnt" autocomplete="off" type="text" class="ztextbox w60" placeholder="0"></div><div>&nbsp; '+ZPI18N.getString("zp.days")+'</div></div></div></div></div></div></div><div class="zpl_crd" id="redirection"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.redirectionheader")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_info"><em>'+ZPI18N.getString("zp.redirectioncontent")+'</em></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectsuccess")+'</label></div><div><input type="text" name="redSuccess" id="redSuccess" autocomplete="off" placeholder="" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectlater")+'</label></div><div><input type="text" placeholder="" name="redLater" id="redLater" autocomplete="off" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectdecline")+'</label></div><div><input name="redDeclined" id="redDeclined" autocomplete="off" type="text" placeholder="" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectcomplete")+'</label></div><div><input type="text" name="redCompleted" id="redCompleted" autocomplete="off" placeholder="" class="ztextbox"></div></div></div></div></div><a val="0" onclick=Zsign.expColSettings("esign_card") id="setting_lnk">'+ZPI18N.getString("zp.showoptions")+'</a><div class="embed-iframe" id="embed_iframe" style= "display:none; top: 70px;width: 100%;height: 100%;padding-bottom: 20px;padding-right: 20px;"><iframe src="" name="createDocumentResp" style=" width: 100%; height: 100%; border: 1px solid var(--brdr_gry); "></iframe></div>',bodyNewFormsSlider:'<div class="zpl_crd" id="basicDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.filedetails")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn" id="uploadSection"><div id="uploadSectionHeader"><label class="zpl_mtry">'+ZPI18N.getString("zp.files.operations.selectfile")+'</label></div><div class="zpl_secn"><div><div class="zradiobutton zradiobutton--horizontal"><input id="input_esignDefUpload" type="radio" name="esignUploadType" class="zradiobutton__helper" checked><label onclick="ZPA_Esign.toggleUploadSection(1);" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.uploaddoc")+'</span></label></div><div class="zradiobutton zradiobutton--horizontal"><input id="input_esignTempUpload" type="radio" name="esignUploadType" class="zradiobutton__helper"><label onclick="ZPA_Esign.toggleUploadSection(2);" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.esign.zsigntemplate")+'</span></label></div></div></div><div id="uploadSectionBody" class="zpl_upld zpl_gbox"><div id="drop_area" ondrop="event.stopPropagation(); event.preventDefault();" ondragover="event.preventDefault();" class="zpl_fldrp"><h5><div class="zpl_flupld_img"></div><div name="fileRoleOptions" id="fileRoleOptions" onclick="ZPA_Esign.showfileuploadDropdown()" class="zselectbox select-js has-focus has-mfocus flslct wauto"><option>'+ZPI18N.getString("zp.esign.fileuploadfield")+'</option><i class="zselectbox__icon zselectbox__arrowicon"><svg class="zselectbox__arrow" focusable="false"><use xlink:href="#zc__svg--downarrow"></use></svg></i></div><div id="fileRoleOptionsList"></div><div id="tempRoleOptions" onclick=ZPA_Esign.showTemplateDropdown() class="zselectbox select-js has-focus has-mfocus flslct wauto"><option>'+ZPI18N.getString("zp.esign.mailmerge.small")+'</option><i class="zselectbox__icon zselectbox__arrowicon"><svg class="zselectbox__arrow" focusable="false"><use xlink:href="#zc__svg--downarrow"></use></svg></i></div><div id="TemplateOptionsList"></div></h5></div><p><span id="zsignFormat">'+ZPI18N.getString("zp.filessuported")+" : "+ZPA_Esign.zsignCompatibleExtns+'</span><span> Maximum size: 5MB</span></p></div><div id="uploadSectionBody_zsigntemp" class="zpl_upld zpl_gbox DNI"><div id="drop_area" ondrop="event.stopPropagation(); event.preventDefault();" ondragover="event.preventDefault();" class="zpl_fldrp"><h5><div class="zpl_flupld_img"></div><div id="zsignTempList" onclick=ZPA_Esign.showZsignDropdown() class="zselectbox select-js has-focus has-mfocus flslct wauto"><option >'+ZPI18N.getString("zp.esign.zsigntemplate")+'</option><i class="zselectbox__icon zselectbox__arrowicon"><svg class="zselectbox__arrow" focusable="false"><use xlink:href="#zc__svg--downarrow"></use></svg></i></div><div id="zsignTempOptionsList"></div></h5></div><p><span> Maximum size: 5MB</span></p></div><div class="zpl_secn DN" id="attachments"><div><h5>'+ZPI18N.getString("zp.uploadfile")+'</h5></div><div class="zpl_atchd"></div></div><div class="zpl_secn DN" id="zsignTempAttach"><div><h5>'+ZPI18N.getString("zp.esign.seltemp")+'</h5></div><div class="zpl_atchd"></div></div></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select id="agrselect_Cat"></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+'</div></div></div></div></div></div></div></div></div><div class="zpl_crd" id="docHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div><input id="document_name" autocomplete="off" type="text" class="ztextbox" /></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><textarea class="ztextbox" id="document_message" autocomplete="off" rows="3"></textarea></div></div></div></div><div class="zpl_crd" id="recpHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn d-flexC j-cnt-btwen"><div><div class="zcheckbox"><input id="signing_order" type="checkbox" name="signing_order" class="zcheckbox__helper"><label for="signing_order" class="zcheckbox__label">'+ZPI18N.getString("zp.zsignsendinorder")+'</label></div></div><div class="d-flexC"></div></div><div class="zpl_secn"><div id="recp_rows"><div id="addbttnrow" style="margin-top: 15px;" class="zpl_idiv"><div class="w20"></div><a class="zpl_lnkbg" id="addRecpbtn" onclick=Zsign.addRecpRows("userbtnId")> '+ZPI18N.getString("zp.esign.addrecp")+'</a></div></div></div></div></div><div id="moreSettings" class="DN"><div class="zpl_crd" id="optionHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.additionaloptions")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><div class="chkdectxt"><div class="zcheckbox" onclick="Zsign.showExpiryOptions(this)"><input id="showExpiryOptions"  type="checkbox" name="showExpiryOptions" class="zcheckbox__helper"><label for="showExpiryOptions" class="zcheckbox__label">'+ZPI18N.getString("zp.havedeadlineforsigning")+'</label></div></div></div><div class="zpl_tbox DNI" id="datefieldOptionscont"><div class="zpl_gbox"><div id="datefieldOptions"  class="DNI"><div><div class="zradiobutton zradiobutton--horizontal" onclick="Zsign.showDateLookup(this)"><input type="radio" name="datelookup" id="datelookupid"  class="zradiobutton__helper"><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.datelookup")+'</span></label></div><div class="zradiobutton zradiobutton--horizontal" onclick="Zsign.showDateLookup(this)"><input type="radio" name="datelookup" id="expdateid" value="1" class="zradiobutton__helper"><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.date")+'</span></label></div></div></div><div class="zpl_idiv" id="deadlinegrp"><div>'+ZPI18N.getString("zp.selectdatelookup")+'</div><div><input type="text" id="deadlinedays" class="ztextbox w60" placeholder="0"></div><div>'+ZPI18N.getString("zp.daysafter")+'</div><div><select type="text" id="dateFieldOpt" class="ztextbox" value=""></select></div></div><div class="DNI" id="deadlineLabel"><div id="dlParent" style="position: relative;"><input name="deadline" data-format="date-short" data-calendar-icon="true" data-picker="true" data-clear-button="none" data-spin-buttons="none" data-width="258" class="DNI" id="deadline" autocomplete="off" onclick="Calendar.setUpCalendar(event,this)" caltype="popup" placeholder="Choose Date" type="text"></div></div><div id="expiry_in_days_div" class="DNI"><div class="zpl_idiv"><div><input type="text" id="expiry_in_days" class="ztextbox w60" placeholder="0"></div><div>'+ZPI18N.getString("zp.days")+'</div></div></div></div></div></div><div class="zpl_secn"><div><div class="chkdectxt"><div class="zcheckbox" onclick="Zsign.setDaysForReminder()"><input id="reminder_check" type="checkbox" name="reminder_check" class="zcheckbox__helper"><label for="reminder_check" class="zcheckbox__label">'+ZPI18N.getString("zp.esignremindertxt")+'</label></div></div></div><div id="reminder_freq" class="zpl_tbox DN"><div class="zpl_gbox"><div class="zpl_idiv"><div>'+ZPI18N.getString("zp.sendreminderonce",new Array(""))+'</div><div><input type="text" id="reminder_freqdayscnt" autocomplete="off" class="ztextbox w60" placeholder="0"></div><div>'+ZPI18N.getString("zp.days")+'</div></div></div></div></div><div class="zpl_secn"><div><div class="chkdectxt"><div class="zcheckbox" onclick="Zsign.showOptions(this)"><input id="synctohrfiles" type="checkbox" name="synctohrfiles" class="zcheckbox__helper"><label for="synctohrfiles" class="zcheckbox__label">'+ZPI18N.getString("zp.addtohrfiles",new Array(""))+'</label></div></div></div><div class="zpl_tbox DNI" id="synctypeOptions"><div class="zpl_gbox"><div><div class="zradiobutton zradiobutton--horizontal" onclick="Zsign.showEmployeeLookup(this)"><input type="radio" id="optrecordbtn" name="optchosdrdbtn" class="zradiobutton__helper" ><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.recordowner")+'</span></label></div><div class="zradiobutton zradiobutton--horizontal" onclick="Zsign.showEmployeeLookup(this)"><input id="optotherbtn" type="radio" name="optchosdrdbtn" class="zradiobutton__helper"><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.employeelookup")+'</span></label></div></div><div class="zpl_idiv DNI" id="hrfileoptdiv"><div><label>'+ZPI18N.getString("zp.selectlookup")+'</label></div><div><select type="text" id="hrfileopt" class="ztextbox" value=""></select></div></div></div></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.addtoformfield")+'</label></div><select type="text" id="addtoformfieldselect" class="ztextbox" value=""></select></div></div></div><div class="zpl_crd" id="redirection"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.redirectionheader")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_info"><em>'+ZPI18N.getString("zp.redirectioncontent")+'</em></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectsuccess")+'</label></div><div><input type="text" name="redSuccess" id="redSuccess" autocomplete="off" placeholder="" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectlater")+'</label></div><div><input type="text" placeholder="" name="redLater" id="redLater" autocomplete="off" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectdecline")+'</label></div><div><input name="redDeclined" id="redDeclined" autocomplete="off" type="text" placeholder="" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectcomplete")+'</label></div><div><input type="text" name="redCompleted" id="redCompleted" autocomplete="off" placeholder="" class="ztextbox"></div></div></div></div></div></div><a val="0" onclick=Zsign.expColSettings("esignforms_card") id="setting_lnk">'+ZPI18N.getString("zp.showoptions")+'</a><div class="embed-iframe" id="embed_iframe" style="display: none;top: 70px;width: 100%;height: 100%;padding-bottom: 20px;padding-right: 20px;"><iframe src="" name="createDocumentResp" style=" width: 100%; height: 100%; border: 1px solid var(--brdr_gry); "></iframe></div>',bodyNewOrgSlider:'<div class="zpl_crd" id="basicDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.templatedetails")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn" id="uploadSection"><div><h6 class="zpl_mtry">'+ZPI18N.getString("zp.files.operations.attachedfile")+'</h6></div></div><div class="zpl_secn" id="attachments"></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select id="agrselect_Cat"></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+'</div></div></div></div></div></div><div class="zpl_crd" id="docHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div><input id="document_name" autocomplete="off" type="text" class="ztextbox" /></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><textarea class="ztextbox" id="document_message" autocomplete="off" rows="3"></textarea></div></div></div></div><div class="zpl_crd" id="recpHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt" id="recipientsSec"><div class="zpl_secn d-flexC j-cnt-btwen"><div><div class="zcheckbox"><input id="signing_order" type="checkbox" name="signing_order" class="zcheckbox__helper"><label for="signing_order" class="zcheckbox__label">'+ZPI18N.getString("zp.zsignsendinorder")+'</label></div></div><div class="d-flexC"></div></div><div class="zpl_secn"><div id="recp_rows"><div id="addbttnrow" style="margin-top: 15px;" class="zpl_idiv"><div class="w20"></div><a class="zpl_lnkbg" id="addRecpbtn" onclick=Zsign.addRecpRows("userbtnId")> '+ZPI18N.getString("zp.esign.addrecp")+'</a></div></div></div></div></div><div class="zpl_crd" id="optionHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.additionaloptions")+'</h4></div></div><div class="zpl_crdcnt" id="expirySec"><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.deadlineindays")+'</label></div><div><input name="noOfDays" id="noOfDays" class="ztextbox w60"></div></div><div class="zpl_secn"><div class="chkdectxt"><div class="zcheckbox"><input id="reminder_check" type="checkbox" name="reminder_check" value="" class="zcheckbox__helper"><label class="zcheckbox__label" onclick="Zsign.setZSDaysForReminder();" >'+ZPI18N.getString("zp.esignremindertxt")+'</label></div></div><div id="reminder_setting" style="display: none" class="zpl_tbox"><div class="zpl_gbox"><div class="zpl_idiv"><div>'+ZPI18N.getString("zp.sendreminderonce",new Array(""))+' &nbsp; </div><div><input name="reminder_freqdayscnt" autocomplete="off" id="reminder_freqdayscnt" type="text" class="ztextbox w60" placeholder="0"></div><div>&nbsp; '+ZPI18N.getString("zp.days")+'</div></div></div></div></div></div></div></div><div class="embed-iframe" id="embed_iframe" style="top: 70px;width: 100%;height: 100%;padding-bottom: 20px;padding-right: 20px;"><iframe src="" name="createDocumentResp" style=" width: 100%; height: 100%; border: 1px solid var(--brdr_gry); "></iframe></div>',bodyFilesSlider:'<div class="zpl_crd" id="basicDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.filedetails")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn" id="uploadSection"><div><h6 id="attachmentHdrSendSign" class="zpl_mtry">'+ZPI18N.getString("zp.esign.uploadfile")+'</h6></div></div><div class="zpl_secn" id="attachments"></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select id="agrselect_Cat"></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+'</div></div></div></div></div></div><div class="zpl_crd" id="docHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div><input id="document_name" autocomplete="off" type="text" class="ztextbox" /></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><textarea class="ztextbox" id="document_message" autocomplete="off" rows="3"></textarea></div></div></div></div><div class="zpl_crd" id="recpHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn d-flexC j-cnt-btwen"><div><div class="zcheckbox"><input id="signing_order" type="checkbox" name="signing_order" class="zcheckbox__helper"><label for="signing_order" class="zcheckbox__label">'+ZPI18N.getString("zp.zsignsendinorder")+'</label></div></div><div class="d-flexC"></div></div><div class="zpl_secn"><div id="recp_rows"><div id="addbttnrow" style="margin-top: 15px;" class="zpl_idiv"><div class="w20"></div><a class="zpl_lnkbg" id="addRecpbtn" onclick=Zsign.addRecpRows("userbtnId")> '+ZPI18N.getString("zp.esign.addrecp")+'</a></div></div></div></div></div><div id="moreSettings" class="DN"><div class="zpl_crd" id="optionHeader"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.additionaloptions")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><label>'+ZPI18N.getString("zp.havedeadlineforsigning")+'</label></div><div class="zpl_secn"><div id="dlParent" style="position: relative;"><input name="deadline" id="deadline" data-format="date-short" data-calendar-icon="true" data-picker="true" data-clear-button="none" data-spin-buttons="none" data-width="258" style="display: none;"></div></div><div class="zpl_secn"><div class="chkdectxt"><div class="zcheckbox"><input id="reminder_check" type="checkbox" name="reminder_check" value="" class="zcheckbox__helper"><label class="zcheckbox__label" onclick="Zsign.setZSDaysForReminder();" >'+ZPI18N.getString("zp.esignremindertxt")+'</label></div></div><div id="reminder_setting" class="zpl_tbox" style="display: none"><div class="zpl_gbox"><div class="zpl_idiv"><div>'+ZPI18N.getString("zp.sendreminderonce",new Array(""))+' &nbsp; </div><div><input name="reminder_freqdayscnt" id="reminder_freqdayscnt" autocomplete="off" type="text" placeholder="0" class="ztextbox w60"></div><div>&nbsp; '+ZPI18N.getString("zp.days")+'</div></div></div></div></div></div></div><div class="zpl_crd" id="redirection"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.redirectionheader")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_info"><em>'+ZPI18N.getString("zp.redirectioncontent")+'</em></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectsuccess")+'</label></div><div><input type="text" name="redSuccess" id="redSuccess" autocomplete="off" placeholder="" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectlater")+'</label></div><div><input type="text" placeholder="" name="redLater" id="redLater" autocomplete="off" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectdecline")+'</label></div><div><input name="redDeclined" id="redDeclined" autocomplete="off" type="text" placeholder="" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.redirectcomplete")+'</label></div><div><input type="text" name="redCompleted" id="redCompleted" autocomplete="off" placeholder="" class="ztextbox"></div></div></div></div></div><a val="0" onclick=Zsign.expColSettings("cardesignfiles") id="setting_lnk">'+ZPI18N.getString("zp.showoptions")+'</a><div class="embed-iframe" id="embed_iframe" style="display:none;top: 70px;width: 100%;height: 100%;padding-bottom: 20px;padding-right: 20px;"><iframe src="" name="createDocumentResp" style=" width: 100%; height: 100%; border: 1px solid var(--brdr_gry); "></iframe></div>',docuCompatibleExtns:["as","asl","asp","doc","docm","docx","dot","dotm","dotx","htm","html","pdf","pdx","rtf","txt","wpd","wps","wpt","dps","dpt","pot","potx","pps","ppt","pptm","pptx","csv","et","ett","xls","xlsm","xlsx","xlt","emz","svg","svgz","vdx","vss","vst","bmp","cdr","dcx","gif","ico","jpg","jpeg","pct","pic","png","rgb","sam","tga","tif","tiff","wpg"],adobeCompatibleExtns:["pdf","doc","docx","xls","pdf","xlsx","ppt","pptx","jpg","png","gif","tif","txt","rtf"]},newRecordDetails:{},fileId:null,emailidfield:{},fileuploadfield:{},fileUploadObj:{},textfield:{},dateFields:{},checkboxfields:{},dropdownfields:{},radiofields:{},editData:null,isFromFormView:!1,isMMerge:!1,isCachedDocumentList:!1,isCachedCatList:!1,SIGNER:"1",VIEWER:"2",APPROVER:"3",INPERSONSIGNER:"4",DOC_NAME:"6",DOC_MESSAGE:"7",CATID:"8",DEADLINE:"9",VALIDUNTIL:"10",REMINDER:"11",RECP:"16",EXPIRE_DAYS:"21",DOC_SUBJECT:"20",REMINDER_FREQDAYS:"22",EXPIRE_CHECK:"23",CC:"26",NOTES:"28",TEMPLATE_ID:"29",DOCTYPE:"30",EMAIL_TEMPLATE:"32",IS_SEQ:"34",LOCAL_FILEPATH:"37",FILEUPLOAD_FILEDS:"4",DOCUMENT_COUNT:"42",LOCAL_FILEPATH_ORDER:"41",FILEUPLOAD_FILEDS_ORDER:"40",TEMPLATE_FORMFIELDS_ORDER:"38",SYNCTOHRFILES:"44",HRFILE_OPT_VAL:"45",RECIPIENT_ID:"46",RECIPIENT_ORDER:"47",RECIPIENT_TYPE:"48",RECIPIENT_INFO:"49",REDSUCCESS:"51",REDLATER:"52",REDDECLINE:"53",REDCOMPLETED:"54",SHOWEXPIRYOPTIONS:"55",DATELOOKUPID:"56",EXPIRYDATEID:"57",DATEFILED:"58",DEADLINEDAYS:"59",ADDTOFILEUPLOAD:"60",APPROVE:"61",USERLISTARRAY:"64",RECIPIENT_PRIVATE_MESSAGE:"68",RECIPIENT_VERIFY:"69",RECIPIENT_LOCALE:"71",RECIPIENT_ROLE_NAME:"72",RECIPIENT_DELIVERY_TYPE:"73",RECIPIENT_HOST:"74",RECIPIENT_FIELD_TYPE:"75",EMAIL_FORM_FIELD_TYPE:"76",RECORD_OWNER_FIELD_TYPE:"77",USER_EMAIL_FIELD_TYPE:"78",ZSIGNTEMPLATEID:"79",PREFILL_FIELDID:"86",PREFILL_VALUE:"87",PREFILL_DATATYPE:"88",PREFILL_FIELDS_DATA:"89",PREFILL_LABEL:"90",ACTION_ID:"92",EXPINDAYS:"93",ALLOWADMINTOKEN:"94",docsubject:[],docname:[],recpdtls:{},isCancel:!1,isWorkflow:!1,docStartindex:0,documentFirescroll:!1,isfromOrgFiles:!1,signFileId:"",signTemplateId:"",locationId:"",compfileId:"",esignmodule:"",reportSliderclose:!1,locId:"",entityId:"",unitId:"",departmentId:"",divisionId:"",recordAgreementList:[],scrolled:0,zsFeatureList:"",zohoSignPlan:"",tempFirescroll:!1,templateStartindex:0,isCachedTempList:!1,actionNames:[],paymentUrl:"",peoplePaymentUrl:"",zsignPricingUrl:"",hasZohosignRecord:"",hasAdobesignRecord:"",hasDocusignRecord:"",isfromFilterView:!1,overAllUserList:"",userListArray:"",editSignTempId:"",compSignFileId:"",zsignEtxns:["pdf","jpg","jpeg","png","doc","docx","html","htm","tex","txt","sxw","odt","rtf"],selectedRecpForm:null,sliderModelId:"",ZSignData:{},docfireScrollUniqID:"esigndocfireScroll",tempfireScrollUniqID:"esigntempfireScroll",comfireScrollUniqID:"esigncompfireScroll",initZDFilter:!1,initZTFilter:!1,ZsignUserList:null,recordId:null,documentId:null,folderList:[],folderListObj:{},showEsignDropDownList:!1,previousCompfileID:"",delZSActionId:[],recpRowId:0,managerAdded:!1,ESIGN_FORMS_RECORD_IDS:[],EMPLOYEE_TEMPLATE:"Employee",isfromFormReport:!1,allowAdminToken:"",ZSDocDtls:"",isFromOnbView:!1,noRecords:!1,getEsignPageId:function(){$("#esign_card");return void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")?$("#esignorg_card"):"0"==FilesUtil.Page.getTabGroup()?$("#cardesignfiles"):"tab-files-esigndocuments"==settingsPage.container[0].id?$("#esign_card"):ZPA_Esign.templateEdit?$("#EditE-SignFlowModal"):$("#AddE-SignFlowModal")},deleteRecipient:function(thisObj){Zsign.managerAdded=!1;var pageId=Zsign.getEsignPageId();if("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")||!(pageId.find("#recp_rows").find("[name='recp_parent']").length<=1)){("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen"))&&Zsign.delZSTempEmp(thisObj);var rowID=$(thisObj).closest(".zpl_idiv").find("[name='recpName']")[0].id,ele=rowID.substring(rowID.length-1);if(5==ZPeopleComponents.select("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpFormValue]")[0].id).value&&!0,ZPeopleComponents.select("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpType]")[0].id).destroy(),pageId.find("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpType]")[0].id).remove(),ZPeopleComponents.select("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpFormValue]")[0].id).destroy(),pageId.find("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpFormValue]")[0].id).remove(),ZPeopleComponents.select("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpFieldValue]")[0].id).destroy(),pageId.find("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpFieldValue]")[0].id).remove(),isZSConfig){if(ZPeopleComponents.select("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpLocale]")[0].id).destroy(),pageId.find("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpLocale]")[0].id).remove(),$("#recpEmailValue_"+ele).length>0&&pageId.find("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=recpEmailValue]")[0].id).remove(),void 0!=$("#"+rowID).parents("[name=recp_row]").find("[name=verifyOn]")[0]&&$($("#"+rowID).parents("[name=recp_row]").find("[name=verifyOn]")[0].id).length>0){var eleId=$("#"+rowID).parents("[name=recp_row]").find("[name=verifyOn]")[0].id;ZPeopleComponents.toggleswitch("#"+eleId).destroy(),pageId.find("#"+eleId).remove()}if($("#privateMesspop_"+ele).length>0&&($("#privateMesspop_"+ele).val(""),$("#tabprivMessPopup_"+ele).remove()),$("#verifyOn_"+ele).length>0){var verId=$("#verifyOn_"+ele)[0].id;$("#verifyOn_"+ele).attr("toRemove",!1),ZPeopleComponents.isComponent($("#"+verId))&&ZPeopleComponents.toggleswitch($("#"+verId)).destroy(),$("#tabauthPopup_"+ele).remove(),$("#cardauthPopup_"+ele).remove()}if($(thisObj).closest(".zpl_idiv").next("[name='hostRow']").length>0){if(pageId.find("#"+hostId).remove(),void 0!=$("#"+rowID).parents("[name=recp_row]").find("[name=hostRow]")[0]&&$("#"+$("#"+rowID).parents("[name=recp_row]").find("[name=hostRow]")[0].id).length>0){var hostId=$("#"+rowID).parents("[name=recp_row]").find("[name=hostRow]")[0].id;ZPeopleComponents.select("#"+hostId).destroy()}$(thisObj).closest(".zpl_idiv").next("[name='hostRow']").remove()}}var row=pageId.find("#recp_rows").find("[name=recp_row]");$.each(row,function(rowLen,val){"5"==$(val).find("[name=recpFormValue]").val()&&(Zsign.managerAdded=!0)}),$(thisObj).closest(".zpl_idiv").parent().remove(),Zsign.sortOrder(event,ele)}else ZPeople.Message.failure(ZPI18N.getString("zp.esign.selectrecp"))},sortOrder:function(thisObj,startIndex){var pageId=Zsign.getEsignPageId(),elementId=0;"object"!=typeof startIndex&&(elementId=startIndex);pageId.find("#recp_rows").find("[name='recp_row']").length;for(var recpRows=pageId.find("#recp_rows").find("[name='recp_row']");elementId<recpRows.length;elementId++){pageId.find("#recp_rows").find("[name='recp_row']")[elementId];0}},addRecpRows:function(value,index,actionId){index=Zsign.recpRowId;var pageId=Zsign.getEsignPageId();void 0==index&&(index=pageId.find("#recp_rows").find("[name='recp_row']").length);void 0==value&&(value="userbtnId");var html="";if(html+=void 0!=actionId?'<div name="recp_parent" style="margin-top: 15px;"><div class="zpl_idiv" name="recp_row" actionId='+actionId+">":'<div name="recp_parent" style="margin-top: 15px;"><div class="zpl_idiv" name="recp_row">',html+='<div class="zpl_rwfld w20"><i class="PI_drag gry"></i></div>',html+='<div class="zpl_rwfld w100"><input id="recpName_'+index+'" name="recpName" type="text" class="ztextbox" placeholder="'+ZPI18N.getString("zp.role")+'"></div>',isZSConfig?(html+='<div class="zpl_rwfld w200"><select type="text"  name="recpFormValue" id="recpFormValue_'+index+'" class="ztextbox" value=""></select></div>',html+='<div class="zpl_rwfld w300"><input name="recpEmailValue" autocomplete="off" id="recpEmailValue_'+index+'" type="text" class="ztextbox"><select type="text"  name="recpFieldValue" id="recpFieldValue_'+index+'" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5" class="ztextbox DN" value=""></select>'):(html+='<div class="zpl_rwfld"><select type="text"  name="recpFormValue" id="recpFormValue_'+index+'" class="ztextbox" value=""></select></div>',html+='<div class="zpl_rwfld"><input name="recpEmailValue" autocomplete="off" id="recpEmailValue_'+index+'" type="text" class="ztextbox"><select type="text"  name="recpFieldValue" id="recpFieldValue_'+index+'" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5" class="ztextbox DN" value=""></select>'),isZSConfig){var repText=ZPI18N.getString("zp.employeesreportingmanager");(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&(repText=ZPI18N.getString("zp.esign.lookupreportingmanager")),html+='<div name="emrepmngr" id="emrepmngr" class="DNI zlabel zlabel--medium is-disabled w250">'+repText+"</div>"}html+="</div>",isZSConfig?html+='<div class="zpl_rwfld w150"><select name="recpType" id="recpType_'+index+'" role="listbox" tabindex="0" title="" class="zselectbox"></select></div>':html+='<div class="zpl_rwfld"><select name="recpType" id="recpType_'+index+'" role="listbox" tabindex="0" title="" class="zselectbox"></select></div>',isZSConfig&&(html+='<div class="zpl_rwfld w150"><select name="recpLocale" id="recpLocale_'+index+'" class="ztextbox" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5" ></select></div>',html+='<div class="zpl_hvr d-flex flt_n"  style="min-width: 100px;width:auto"><i class="PI_file_encrypt" data-toggle="tooltip" title="'+ZPI18N.getString("zp.esign.privatenotehdr")+'" onclick="Zsign.showPrivateMsgPop(this)"></i><i class="PI_key" onclick="Zsign.showAuthCodePop(this)" data-toggle="tooltip" title="'+ZPI18N.getString("zp.esign.authentication")+'"></i>'),(isAdobeConfig||isDocuConfig)&&(html+='<div class="zpl_hvr d-flex flt_n">'),("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen"))&&0==index?html+='<i class="PI_delete disabled" disabled></i>':html+='<i class="PI_delete" onclick="Zsign.deleteRecipient(this)" data-toggle="tooltip" title="'+ZPI18N.getString("zp.delete")+'"></i>',html+="</div>",html+="</div>",isZSConfig&&(html+='<div class="zpl_idiv DNI" name="hostRow" style="padding-left: 25px;"><div class="zpl_rwfld w60"><div class="zlabel zlabel--medium is-disabled">'+ZPI18N.getString("zp.host")+'</div></div><div class="zpl_rwfld"><select type="text" data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5" name="recpHost" id="recpHost_'+index+'" class="ztextbox" value=""></select></div></div>'),html+="</div>",("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen"))&&0==index?pageId.find("#recp_rows").before(html):pageId.find("#addbttnrow").before(html);var t=index,selectedEle=$(pageId.find("#recp_rows").find("div[name=recp_row]").last());if(("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen"))&&0==t&&(selectedEle=$(pageId.find("div[name=recp_parent]").first())),"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")?selectedEle.find("#recpName_"+t).parent().removeClass("DN"):selectedEle.find("#recpName_"+t).parent().addClass("DN"),ZPeopleComponents.select(selectedEle.find("select[name=recpType]").append(ZPA_Esign.Slider.recType())),ZPeopleComponents.select(selectedEle.find("select[name=recpFormValue]")).addOption(Zsign.recpFormOptions(value,t)),("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen"))&&0==t){ZPeopleComponents.select(selectedEle.find("#recpEmailValue_0")).removeAllOptions();var options=[{label:ZPI18N.getString("zp.applicableemployees"),value:"-1"}];ZPeopleComponents.select(selectedEle.find("#recpEmailValue_0")).addOption(options),ZPeopleComponents.select(selectedEle.find("#recpEmailValue_0")).setValue("-1"),ZPeopleComponents.select(selectedEle.find("#recpEmailValue_0")).setAttribute("disabled",!0),selectedEle.find("#recpFieldValue_0").addClass("DN"),ZPeopleComponents.select(selectedEle.find("#recpFormValue_0")).setAttribute("disabled",!0),selectedEle.find("#recpName_0").val(Zsign.EMPLOYEE_TEMPLATE),selectedEle.find("#recpName_0").addClass("disabled")}if("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")?0!==t&&selectedEle.find("#recpFormValue_"+t).on("zselectchange",Zsign.showRecipientfldOpt):selectedEle.find("#recpFormValue_"+t).on("zselectchange",Zsign.showRecipientfldOpt),"userbtnId"==value){if(ZPeopleComponents.isComponent(selectedEle.find("[name=recpFieldValue]"))&&ZPeopleComponents.select(selectedEle.find("[name=recpFieldValue]")).removeAllOptions(),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)Object.keys(Zsign.emailidfield.formId).length>0?ZPeopleComponents.select(selectedEle.find("[name=recpFieldValue]")).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.emailidfield.formId)):ZPeopleComponents.select(selectedEle.find("[name=recpFieldValue]"));else{options=Zsign.constructAddEmpListSel();ZPeopleComponents.select(selectedEle.find("[name=recpFieldValue]")).setAttributes(options)}selectedEle.find("#emrepmngr").addClass("DNI")}if("manager"==value){var role=ZPI18N.getString("zp.manager");selectedEle.find("[name=recpName]").val(role),ZPeopleComponents.select(selectedEle.find("#recpFormValue_"+t)).setValue("5")}if("userbtnId"==value){var recp_optionList=ZPeopleComponents.select(selectedEle.find("#recpFormValue_"+index)).getOptions();ZPeopleComponents.select(selectedEle.find("#recpFormValue_"+index)).setValue(recp_optionList[0].value)}isZSConfig&&(selectedEle.find("select[name=recpType]").on("zselectchange",ZPA_Esign.Slider.constructHost),ZPeopleComponents.select(selectedEle.find("select[name=recpLocale]").append(ZPA_Esign.Slider.recpLocale)),ZPeopleComponents.select(selectedEle.find("select[name=recpLocale]")).setAttribute("selectedValue","en")),("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen"))&&0==t||ZPeopleComponents.sortable("#recp_rows",{region:"parent",cancelOnEscKey:!0,restrictExternalItem:!0,change:ZPA_Esign.sortOrder,items:"div[name='recp_parent']",handle:".PI_drag",axis:"y"}),Zsign.recpRowId++},getPrivateNotesFromZsignResp:function(thisObj,actionId){var data;if(null!=actionId&&void 0!=actionId&&""!=actionId){if(void 0!=(data=$("#esignorg_card").find("div[actionid='"+actionId+"']").data().tdata))return data.private_notes}else if(void 0!=(data=$(thisObj).closest(".zpl_idiv").data().tdata))return data.private_notes},getVerifyRecpFromZsignResp:function(thisObj,actionId){if(null!=actionId&&void 0!=actionId&&""!=actionId){var verify_recp=!1;void 0!=(data=$("#esignorg_card").find("div[actionid='"+actionId+"']").data().tdata)&&data.verify_recipient&&"EMAIL"==data.verification_type&&(verify_recp=!0)}else{var data;verify_recp=!1;void 0!=(data=$(thisObj).closest(".zpl_idiv").data().tdata)&&data.verify_recipient&&"EMAIL"==data.verification_type&&(verify_recp=!0)}return verify_recp},showPrivateMsgPop:function(thisObj){var pageId=$("#esign_card");"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")?pageId=$("#esignorg_card"):"0"==FilesUtil.Page.getTabGroup()?pageId=$("#cardesignfiles"):(settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1&&void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId||void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId)&&(pageId=$("#esignforms_card"));var rowID=$(thisObj).closest(".zpl_idiv").find("[name='recpFormValue']")[0].id,startIndex=rowID.substring(rowID.length-1);if(0==$("#privateMesspop_"+startIndex).length){var popupTab=new Tab("privMessPopup_"+startIndex,function(){var popcon='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.esign.privatenotedesc")+'</label></div><div><textarea id="privateMesspop_'+startIndex+'" rows="6" class="ztextbox" maxlength="1024"></textarea></div></div></div></div>';$("#cardprivMessPopup_"+startIndex).html(popcon)},function(getThis){getThis.close()});if(popupTab.validate=ZPA_Esign.savePrivateMsgCodeConf,ZPA_Esign.PrivatePOPUP=new popupModal(ZPI18N.getString("zp.esign.privatenotehdr"),popupTab),ZPA_Esign.PrivatePOPUP.construct(),$("#privateMesspop_"+startIndex).focus(),ZPA_Esign.templateEdit||void 0!=Zsign.zSignData&&""!=Zsign.zSignData)if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData){var priv=Zsign.zSignData[1][4][startIndex].private_notes;$("#privateMesspop_"+startIndex).val(priv)}else{if((info=ZPA_Esign.editData[1][0].info).hasOwnProperty(Zsign.RECIPIENT_INFO)){var recInfo=JSON.parse(info[Zsign.RECIPIENT_INFO]);$("#privateMesspop_"+startIndex).val(recInfo[startIndex][Zsign.RECIPIENT_PRIVATE_MESSAGE])}}}else{if(ZPA_Esign.templateEdit||void 0!=Zsign.zSignData&&""!=Zsign.zSignData)if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData){var defpriv=Zsign.zSignData[1][4][startIndex].private_notes,savedPriv=pageId.find("#recpFormValue_"+startIndex).parent().parent().data().pdata;void 0!=savedPriv&&""!=savedPriv&&void 0!=savedPriv.privateMsg?$("#privateMesspop_"+startIndex).val(savedPriv.privateMsg):$("#privateMesspop_"+startIndex).val(defpriv)}else{var info;if((info=ZPA_Esign.editData[1][0].info).hasOwnProperty(Zsign.RECIPIENT_INFO)){recInfo=JSON.parse(info[Zsign.RECIPIENT_INFO]);$("#privateMesspop_"+startIndex).val(recInfo[startIndex][Zsign.RECIPIENT_PRIVATE_MESSAGE])}}$(rowID).parent().parent();$("#tabprivMessPopup_"+startIndex).addClass("zpl_mopen"),$("#privateMesspop_"+startIndex).focus(),$("#cardprivMessPopup_"+startIndex).addClass("zpl_mopen")}if("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")){var editVal=Zsign.getPrivateNotesFromZsignResp(thisObj);void 0!=editVal&&null!=editVal&&""!=editVal&&$("#privateMesspop_"+startIndex).val(editVal)}},showAuthCodePop:function(thisObj,indx,dontShow){var startIndex="",pageId=$("#esign_card");if("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")?pageId=$("#esignorg_card"):"0"==FilesUtil.Page.getTabGroup()?pageId=$("#cardesignfiles"):(settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1&&void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId||void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId)&&(pageId=$("#esignforms_card")),void 0==indx){var rowID=$(thisObj).closest(".zpl_idiv").find("[name='recpFormValue']")[0].id;startIndex=rowID.substring(rowID.length-1)}else startIndex=indx;$(rowID).parent().parent();if(0==$("#verifyOn_"+startIndex).length||$("#verifyOn_"+startIndex).length>0&&"false"==$("#verifyOn_"+startIndex).attr("toRemove")){var popupTab=new Tab("authPopup_"+startIndex,function(){var popcon='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div class="zpl_tgl"><input toRemove=true id="verifyOn_'+startIndex+'" class="togbutton-js"><label>'+ZPI18N.getString("zp.esign.otpdesc")+"</label></div></div></div></div>";popcon+="</div>",$("#cardauthPopup_"+startIndex).html(popcon),ZPeopleComponents.toggleswitch("#verifyOn_"+startIndex)},function(getThis){getThis.close()});if(popupTab.validate=ZPA_Esign.saveAuthCodeConf,ZPA_Esign.AuthCodePOPUP=new popupModal(ZPI18N.getString("zp.esign.otphdr"),popupTab),ZPA_Esign.AuthCodePOPUP.construct(),void 0!=dontShow&&dontShow&&($("#tabauthPopup_"+startIndex).removeClass("zpl_mopen"),$("#cardauthPopup_"+startIndex).removeClass("zpl_mopen")),ZPA_Esign.templateEdit||void 0!=Zsign.zSignData&&""!=Zsign.zSignData)if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData){var ver_rec=Zsign.zSignData[1][4][startIndex].verify_recipient;"EMAIL"==Zsign.zSignData[1][4][startIndex].verification_type&&ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).setAttribute("on",ver_rec)}else{if((info=ZPA_Esign.editData[1][0].info).hasOwnProperty(Zsign.RECIPIENT_INFO)){var recInfo=JSON.parse(info[Zsign.RECIPIENT_INFO]);ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).setAttribute("on",recInfo[startIndex][Zsign.RECIPIENT_VERIFY])}}}else{if(ZPA_Esign.templateEdit||void 0!=Zsign.zSignData&&""!=Zsign.zSignData)if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData){var savedAuth=pageId.find("#recpFormValue_"+startIndex).parent().parent().data().ldata;if(void 0!=savedAuth&&""!=savedAuth&&void 0!=savedAuth.verify)savedAuth.verify?ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).switchOn():ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).switchOff();else{ver_rec=Zsign.zSignData[1][4][startIndex].verify_recipient;"EMAIL"==Zsign.zSignData[1][4][startIndex].verification_type&&ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).setAttribute("on",ver_rec)}}else{var info;if((info=ZPA_Esign.editData[1][0].info).hasOwnProperty(Zsign.RECIPIENT_INFO)){recInfo=JSON.parse(info[Zsign.RECIPIENT_INFO]);ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).setAttribute("on",recInfo[startIndex][Zsign.RECIPIENT_VERIFY])}}$("#tabauthPopup_"+startIndex).addClass("zpl_mopen"),$("#cardauthPopup_"+startIndex).addClass("zpl_mopen")}if("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")){var editVal=Zsign.getVerifyRecpFromZsignResp(thisObj);void 0!=editVal&&null!=editVal&&""!=editVal&&1==editVal&&ZPeopleComponents.toggleswitch($("#verifyOn_"+startIndex)).switchOn()}},showRecipientfldOpt:function(thisObj){Zsign.managerAdded=!1;var pageId="";pageId=settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1&&void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId||void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId?$("#esignforms_card"):"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")?$("#esignorg_card"):"0"==FilesUtil.Page.getTabGroup()?$("#cardesignfiles"):$("#esign_card");var id=$($(thisObj.detail.element[0].closest("[name='recp_row']")).find("[name='recpFieldValue']"))[0].id,eleID=id.substring(id.length-1),emailId=$($(thisObj.detail.element[0].closest("[name='recp_row']")).find("[name='recpEmailValue']"))[0].id;if(pageId.find("#"+id).parent().find("#emrepmngr").addClass("DNI"),4==thisObj.detail.element.val())$("#"+emailId).removeClass("DN"),ZPeopleComponents.isComponent(pageId.find("#"+id))&&ZPeopleComponents.select(pageId.find("#"+id)).removeAllOptions(),ZPeopleComponents.select(pageId.find("#"+id)).destroy(),$("#"+id).addClass("DN");else if(3==thisObj.detail.element.val())if($("#"+emailId).addClass("DN"),$("#"+id).removeClass("DN"),ZPeopleComponents.isComponent(pageId.find("#"+id))){ZPeopleComponents.select(pageId.find("#"+id)).removeAllOptions();var options=Zsign.constructAddEmpListSel();ZPeopleComponents.select(pageId.find("#"+id)).setAttributes(options)}else ZPeopleComponents.select(pageId.find("#"+id),Zsign.constructAddEmpListSel());else 1==thisObj.detail.element.val()?($("#"+emailId).addClass("DN"),$("#"+id).removeClass("DN"),ZPeopleComponents.select(pageId.find("#"+id)).removeAllOptions(),ZPeopleComponents.select(pageId.find("#"+id)).destroy(),Object.keys(Zsign.emailidfield.formId).length>0?ZPeopleComponents.select(pageId.find("#"+id)).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.emailidfield.formId)):ZPeopleComponents.select(pageId.find("#"+id))):2==thisObj.detail.element.val()?($("#"+emailId).addClass("DN"),$("#"+id).removeClass("DN"),ZPeopleComponents.select(pageId.find("#"+id)).removeAllOptions(),ZPeopleComponents.select(pageId.find("#"+id)).destroy(),Zsign.attachLookupOpts(pageId,pageId.find("#"+id))):6==thisObj.detail.element.val()?($("#"+emailId).addClass("DN"),ZPeopleComponents.select(pageId.find("#"+id)).removeAllOptions(),ZPeopleComponents.select(pageId.find("#"+id)).destroy(),$("#"+id).addClass("DN")):5==thisObj.detail.element.val()&&($("#recpEmailValue_"+eleID).addClass("DN"),ZPeopleComponents.select(pageId.find("#"+id)).removeAllOptions(),ZPeopleComponents.select(pageId.find("#"+id)).destroy(),$("#"+id).addClass("DN"),pageId.find("#"+id).parent().find("#emrepmngr").removeClass("DNI"));5==thisObj.detail.element.val()?(pageId.find("#recpName_"+eleID).val(ZPI18N.getString("zp.manager")),pageId.find("#recpName_"+eleID).addClass("disabled")):6==thisObj.detail.element.val()?(pageId.find("#recpName_"+eleID).val(ZPI18N.getString("zp.employee")),pageId.find("#recpName_"+eleID).addClass("disabled")):(pageId.find("#recpName_"+eleID).val(""),pageId.find("#recpName_"+eleID).removeClass("disabled"));var row=pageId.find("#recp_rows").find("[name=recp_row]");$.each(row,function(rowLen,val){"5"==$(val).find("[name=recpFormValue]").val()&&(Zsign.managerAdded=!0)})},constructUserFieldsJSON:function(){var empObj_data=function(initObj){var query=$(initObj).val();return query=void 0==query||""==query?"*":query,EmployeeSearch.getEmpList(query,"emp","FILES_ESIGNLIST",[],{},!1,"",!0)};Zsign.selectEmployee,Zsign.unSelectEmployee,ZPArrow.BOTTOM_CENTER;return empObj_data("#searchList")},recpFormOptions:function(type,index){var optionList=[];if(settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1&&void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId||void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId){var optionVal={label:ZPI18N.getString("zp.emailaddressfield"),value:"1"};if(optionList.push(optionVal),isZSConfig&&!Zsign.isDynamicUserAdded()){optionVal={label:ZPI18N.getString("zp.esign.lookupfield"),value:"2"};optionList.push(optionVal)}}if(isZSConfig){if("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen"))if(0==index){optionVal={label:ZPI18N.getString("zp.employee"),value:"6"};optionList.push(optionVal)}else{optionVal={label:ZPI18N.getString("zp.esign.specuser"),value:"3"};optionList.push(optionVal)}else{optionVal={label:ZPI18N.getString("zp.specificemail"),value:"4"};optionList.push(optionVal);optionVal={label:ZPI18N.getString("zp.esign.specuser"),value:"3"};optionList.push(optionVal)}if(!Zsign.isManagerAdded()&&(Zsign.isfromZSignTemplates()||"0"!=FilesUtil.Page.getTabGroup()&&"tab-files-esigndocuments"!=settingsPage.container[0].id)){optionVal={label:ZPI18N.getString("zp.manager"),value:"5"};optionList.push(optionVal)}}else if(isAdobeConfig||isDocuConfig){optionVal={label:ZPI18N.getString("zp.specificemail"),value:"4"};optionList.push(optionVal)}return optionList},isManagerAdded:function(){for(var isManagerSelected=!1,recepList=Zsign.getEsignPageId().find("select[id^='recpFormValue_']"),i=0;i<recepList.length;i++){if(5==$(recepList[i]).val()){isManagerSelected=!0;break}}return isManagerSelected},isDynamicUserAdded:function(pageId){if(void 0==pageId||0==pageId.length)pageId=Zsign.getEsignPageId();for(var isUserSelected=!1,recepList=pageId.find("select[id^='recpFormValue_']"),i=0;i<recepList.length;i++){var recpOpt=$(recepList[i]).val();if(2==recpOpt||6==recpOpt){isUserSelected=!0;break}}return isUserSelected},constructMailId:function(configJson,tagInputObj){var dispValJson=$.extend({},TemplateCommon.keyPairIdJson,{constantVal:{id:"constantVal",dispVal:ZPI18N.getString("zp.contactemail")}}),keyNameList=[dispValJson.system.id];$.each(keyNameList,function(i,keyVal){configJson.hasOwnProperty(keyVal)&&$.each(configJson[keyVal],function(key,val){var parentJson=dispValJson[keyVal],parentTagJson={id:parentJson.id,value:parentJson.dispVal},childTagJson={id:key,value:val,attr:key};$(tagInputObj).tagInput(parentTagJson,[childTagJson],TemplateCommon.newConstant)}),TemplateCommon.newConstant($(tagInputObj))})},getTemplates:function(formId,tempId){var params={mode:ZP_Automation_Mode.ESIGN,formId:formId.toString(),method:"getTemplates",conreqcsr:csrfToken};$.ajax({url:"/getTemplates.zp",type:"POST",data:params,success:function(datas){ZPSetupCommon.isEmpty(tempId)||(datas.templateId=tempId),ZPA_Esign.setFormTemplates(datas)}})},getFormCompFields:function(formId,mode){var emailidfieldArr={},fileuploadfieldArr={},checkboxfieldArr={},dropdownfieldArr={},radiofieldArr={},textField={},textLabelField={},dateFields={},formCompData=ZP5Form.getFormsOperation(formId).getFormComponentData();$.ajax({type:"POST",async:!1,url:"/formAction.zp",data:{mode:"getFormComponents",conreqcsr:csrfToken,formId:formId},success:function(data){formCompData=data}});var formComp=formCompData.message;$.each(formComp.formComponentDetails,function(_index){this.isTabular||($.each(this.column1,function(_index,_fieldData){if(this.fieldType==FormConstants.FieldType.EMAIL_ADDRESS){var fcId=this.formComponentId;emailidfieldArr[fcId]=ZPeople.decodeTxt(this.displayName)}else if(this.fieldType==FormConstants.FieldType.FILE_UPLOAD){fcId=this.formComponentId;fileuploadfieldArr[fcId]=ZPeople.decodeTxt(this.displayName)}else if(this.fieldType==FormConstants.FieldType.TEXT){fcId=this.formComponentId;textField[fcId]=ZPeople.decodeTxt(this.displayName),textLabelField[fcId]=ZPeople.decodeTxt(this.labelName)}else if(this.fieldType==FormConstants.FieldType.DATE){fcId=this.formComponentId;dateFields[fcId]=ZPeople.decodeTxt(this.displayName)}else if(this.fieldType==FormConstants.FieldType.CHECK_BOX){fcId=this.formComponentId;checkboxfieldArr[fcId]=ZPeople.decodeTxt(this.displayName)}else if(this.displayType==FormConstants.FieldType.RADIO_DISPLYTYPE){fcId=this.formComponentId;radiofieldArr[fcId]=ZPeople.decodeTxt(this.displayName)}else if(this.fieldType==FormConstants.FieldType.PICKLIST){fcId=this.formComponentId;dropdownfieldArr[fcId]=ZPeople.decodeTxt(this.displayName)}}),$.each(this.column2,function(_index,_fieldData){if(this.fieldType==FormConstants.FieldType.EMAIL_ADDRESS){var fcId=this.formComponentId;emailidfieldArr[fcId]=ZPeople.decodeTxt(this.displayName)}else if(this.fieldType==FormConstants.FieldType.FILE_UPLOAD){fcId=this.formComponentId;fileuploadfieldArr[fcId]=ZPeople.decodeTxt(this.displayName)}else if(this.fieldType==FormConstants.FieldType.TEXT){fcId=this.formComponentId;textField[fcId]=ZPeople.decodeTxt(this.displayName),textLabelField[fcId]=ZPeople.decodeTxt(this.labelName)}else if(this.fieldType==FormConstants.FieldType.DATE){fcId=this.formComponentId;dateFields[fcId]=ZPeople.decodeTxt(this.displayName)}else if(this.fieldType==FormConstants.FieldType.CHECK_BOX){fcId=this.formComponentId;checkboxfieldArr[fcId]=ZPeople.decodeTxt(this.displayName)}else if(this.displayType==FormConstants.FieldType.RADIO_DISPLYTYPE){fcId=this.formComponentId;radiofieldArr[fcId]=ZPeople.decodeTxt(this.displayName)}else if(this.fieldType==FormConstants.FieldType.PICKLIST){fcId=this.formComponentId;dropdownfieldArr[fcId]=ZPeople.decodeTxt(this.displayName)}}))}),Zsign.emailidfield.formId=emailidfieldArr,Zsign.fileuploadfield.formId=fileuploadfieldArr,Zsign.textfield.formId=textField,Zsign.dateFields.formId=dateFields,Zsign.checkboxfields.formId=checkboxfieldArr,Zsign.dropdownfields.formId=dropdownfieldArr,Zsign.radiofields.formId=radiofieldArr,Zsign.currentformId=formId,ZP_Mailmerge.textLabelfield.formId=textLabelField},constructFormFields:function(dataObj,_htmlObj,isSelect){if(ZPSetupCommon.isEmpty(dataObj))return"";var option="";return isSelect&&(option="<option value='0' selected='selected'>"+ZPI18N.getString("zp.select")+"</option>"),Object.keys(dataObj).length>0&&$.each(dataObj,function(key,value){option+='<option value="'+key+'">'+value+"</option>"}),option},setZSignUserList:function(data){Zsign.ZsignUserList=data[1].userList},changeConfiguration:function(formId){var pageId="",isFromAutomation=!1;if(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?pageId=$("#esignforms_card"):(pageId=settingsPage.container,isFromAutomation=!0),pageId.find("#templates").html(""),ZPeople.IsNumeric(formId)||(formId=formId.detail.selectedValue,ZP_Mailmerge.constructMMTempList("workflow",formId,"1","","","",ZPA_Esign.assignMMTempInDropDwn)),isFromAutomation||pageId.find("#recpList").html(Zsign.constructFormFields(Zsign.emailidfield.formId)),isFromAutomation){if(pageId.find("#document_name").html(Zsign.constructFormFields(Zsign.textfield.formId)),pageId.find("#document_name").val(""),pageId.find("#attachments .zpl_atchd").find("[name='fileOutDiv']").length>0){var attObject=$(pageId.find("#attachments .zpl_atchd").find("[name='fileOutDiv']"));$.each(attObject,function(index,attObjectItem){var attachedFileName=$($(attObjectItem)[index]).find(".zpl_atchdtl").text();ZPA_Esign.fileNameList.has(attachedFileName)&&ZPA_Esign.fileNameList.delete(attachedFileName)}),pageId.find("#attachments .zpl_atchd").find("[name='fileOutDiv']").remove(),pageId.find("#attachments").addClass("DN")}pageId.find("#zsignTempAttach .zpl_atchd").find("[name='fileOutDiv']").length>0&&(pageId.find("#zsignTempAttach .zpl_atchd").find("[name='fileOutDiv']").remove(),pageId.find("#zsignTempAttach").addClass("DN"),pageId.find("#uploadSectionBody_zsigntemp").removeClass("DNI"))}pageId.find("#formRole").val(),pageId.find("#dateFieldOpt").val(),isFromAutomation?(Zsign.getTemplates(formId),ZPA_Esign.changeCallbackConf(),pageId.find("div[name=recp_row]").remove(),!ZPA_Esign.templateEdit&&$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId)[0].hasChildNodes()&&ZPA_Esign.Slider.addRecp(0)):Zsign.addRecp(null,null,!0),void 0!=Zsign.emailidfield.formId&&(Object.keys(Zsign.emailidfield.formId).length===pageId.find("[name=recp_row]").length?pageId.find("#add_recplnk").hide():pageId.find("#add_recplnk").show()),pageId.find("#formRole").html(Zsign.constructFormFields(Zsign.fileuploadfield.formId)),isFromAutomation?($("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("#document_name")&&(ZPeopleComponents.isComponent("#documentNameList")&&ZPeopleComponents.dropdownlist("#documentNameList").destroy(),Object.keys(Zsign.textfield.formId).length>0?ZPA_Esign.setDocumentNameList():ZPeopleComponents.dropdownlist($("#documentNameList"))),0!=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("select#dateFieldOpt").length&&(ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("select#dateFieldOpt")).removeAllOptions(),Object.keys(Zsign.dateFields.formId).length>0?ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("select#dateFieldOpt")).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.dateFields.formId)):ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("select#dateFieldOpt"))),0!=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("select#addtoformfieldselect").length&&(ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("select#addtoformfieldselect")).removeAllOptions(),Object.keys(Zsign.fileuploadfield.formId).length>0&&ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId).find("select#addtoformfieldselect")).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.fileuploadfield.formId,null,!0)))):(Object.keys(Zsign.dateFields.formId).length>0?ZPeopleComponents.select(pageId.find($("#dateFieldOpt"))).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.dateFields.formId)):ZPeopleComponents.select(pageId.find($("#dateFieldOpt"))),Object.keys(Zsign.fileuploadfield.formId).length>0?ZPeopleComponents.select(pageId.find("select#addtoformfieldselect")).addOption(ZPA_Esign.constructFormFieldsJSON(Zsign.fileuploadfield.formId,null,!0)):ZPeopleComponents.select(pageId.find("select#addtoformfieldselect")));var formData=new FormData;formData.append("methodName","getEsignCongifDtls"),formData.append("conreqcsr",csrfToken),formData.append("formId",formId),$.ajax({url:"fileCabinetAction.zp",type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){Zsign.lookupopt(data)}})},addTemplate:function(getLiObj,tempId){var tempName,id,source;!settingsPage.container.find(".zsign-doc").length>0&&(settingsPage.container.find("#tempfileform").after('<div class="zsign-doc" id ="multiple_files"></div>'),$("#multiple_files").sortable(),$("#multiple_files").disableSelection()),"templates"==getLiObj?$.each(ZP_Mailmerge.templateIds,function(key,value){value.tid==tempId&&(tempName=value.fname,id=tempId,source=getLiObj)}):"ztemplate"==getLiObj?$.each(ZPA_Esign.ZSignTempList,function(key,value){value.templateId==tempId&&(tempName=value.templateName,id=tempId,source=getLiObj)}):$.each(Zsign.fileuploadfield.formId,function(key,value){key==tempId&&(tempName=value,id=key,source="fileupload")});var obj={};obj.name=tempName,obj.id=id,obj.source=source,ZPA_Esign.attachmentConstructor(obj)},clearFileUpload:function(){settingsPage.container.find("#upload_files").val("")},setZSFeatureList:function(data){Zsign.zsFeatureList=data[1].features},checkZSFeature:function(){""==Zsign.zsFeatureList&&ZPeople.Request.sendAsyncPost("/zpzsign/getZSignFeatureList",{conreqcsr:csrfToken},Zsign.setZSFeatureList)},getZSPaymentURL:function(){""==Zsign.paymentUrl&&ZPeople.Request.sendAsyncPost("/zpzsign/getSubscriptionDetails",{conreqcsr:csrfToken},Zsign.setZohoSignPaymentURL)},setZohoSignPaymentURL:function(data){Zsign.paymentUrl=data[1].payment_url,Zsign.peoplePaymentUrl=data[1].peoplepayment_url,Zsign.zsignPricingUrl=data[1].zsignPricing_url},sendDocument:function(){var err=!1,innerForm=!1,isFromForm=!1,pageId="",sliderId="",isFromZSTemplate=!1;if(Zsign.isFromFormView=!1,"tab-files-esigndocuments"==settingsPage.container[0].id){var parentId=$("#tab-files-esigndocuments").parent().parent().parent();0!=parentId.find("#esigntemplatesParent").length&&parentId.find("#esigntemplatesParent").hasClass("zpl_mopen")&&(isFromZSTemplate=!0)}void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(pageId=$("#esignforms_card"),sliderId=$("#esignforms"),isFromForm=!0,Zsign.isFromFormView=!0,void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId&&(innerForm=!0)):"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate?(pageId=$("#esignorg_card"),sliderId=$("#esignorg")):"0"==FilesUtil.Page.getTabGroup()?(pageId=$("#cardesignfiles"),sliderId=$("#tabesignfiles")):(pageId=$("#esign_card"),sliderId=$("#esign")),$(".ERR").remove(),Zsign.disableSaveBtn(pageId,"sliderSbt");var formData=new FormData;("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate)&&(ZPSetupCommon.isEmpty(Zsign.editSignTempId)||formData.append("signTemplateId",Zsign.editSignTempId),formData.append("isTemplate",!0),formData.append("signing_order",pageId.find("[name=signing_order]").is(":checked")),formData.append("is_sequencial",pageId.find("[name=signing_order]").is(":checked"))),settingsUrlProps.url.indexOf("operations/files/esigndocuments")>-1&&!isFromZSTemplate&&(formData.append("signing_order",pageId.find("[name=signing_order]").is(":checked")),formData.append("is_sequencial",pageId.find("[name=signing_order]").is(":checked")));var documentMessage=pageId.find("#document_message").val(),documentName=pageId.find("#document_name").val(),doc=settingsPage.container.find("#uploadfile");null!=Zsign.selectedRecpForm&&(recpList=Zsign.selectedRecpForm);var expirationDays,dateField=pageId.find("#dateFieldOpt").val(),addtofileupload=pageId.find("#addtoformfieldselect").val(),docNameIds="",redSuccess=pageId.find("input#redSuccess").val(),redCompleted=pageId.find("input#redCompleted").val(),redDeclined=pageId.find("input#redDeclined").val(),redLater=pageId.find("input#redLater").val();if(isFromForm){var isZTemp=!1,noOfAtth=0;if((noOfAtth=$("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length)>0?isZTemp=!0:noOfAtth=$("#attachments .zpl_atchd").find("[name=fileOutDiv]").length,0!=noOfAtth){for(var itr=0;itr<noOfAtth;itr++){var selId=$($("#attachments .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("selId"),source=$($("#attachments .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("source"),templateFieldsval={},fileFieldsval={},templateFields=[],templateoriginalFields=[],fileuploadFields=[],fileuploadFieldsoriginal=[];isZTemp&&(selId=$($("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("selId"),source=$($("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("source")),"fileupload"==source?(fileFieldsval.order=itr,fileFieldsval.filepathval=selId,fileuploadFields.push(fileFieldsval),fileuploadFieldsoriginal.push(selId)):"templates"==source&&(templateFieldsval.order=itr,templateFieldsval.templateIdval=selId,templateFields.push(templateFieldsval),templateoriginalFields.push(selId))}if("ztemplate"==source){if(void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1&&!Zsign.zSignData[1].data.signerFieldForAllRecp){var params={conreqcsr:csrfToken,signTemplateId:selId};$.ajax({url:"/zpzsign/getTemplateActionIds",type:"POST",data:params,success:function(data){Zsign.setSignerFieldForAllRecp(data),Zsign.zSignData[1].data.signerFieldForAllRecp||ZPeople.Message.failure(ZPI18N.getString("zp.addsignerfields"))},failure:function(data){Zsign.failedCallBack(data)}})}ztemplateOriginalFields=selId,ZPA_Esign.resetuploadValues()}fileuploadFields.length>0?(formData.append("fileListarray",JSON.stringify(fileuploadFields)),formData.append("fileList",fileuploadFieldsoriginal)):templateFields.length>0?formData.append("templateId",templateoriginalFields):void 0!=ztemplateOriginalFields&&ztemplateOriginalFields.length>0&&formData.append("ztemplateId",ztemplateOriginalFields)}for(var preFillFields=[],mergeFieldListLen=$("label[name=mergeFieldsList]").length,i=0;i<mergeFieldListLen;i++){var preFillFieldsVal={},prefill_id=$($("label[name=mergeFieldsList]")[i]).attr("fid"),prefill_val=$("#"+prefill_id).val();null!=prefill_val&&(preFillFieldsVal[Zsign.PREFILL_FIELDID]=prefill_id,preFillFieldsVal[Zsign.PREFILL_VALUE]=prefill_val,preFillFieldsVal[Zsign.PREFILL_DATATYPE]=$("#"+prefill_id).attr("datatype"),preFillFieldsVal[Zsign.PREFILL_LABEL]=$("#"+prefill_id).attr("labelName"),preFillFields.push(preFillFieldsVal))}0!=preFillFields.length&&formData.append("preFillFieldsData",JSON.stringify(preFillFields))}if(formData.append("conreqcsr",csrfToken),formData.append("reminder",pageId.find("input#reminder_check").is(":checked")),pageId.find("input#reminder_check").is(":checked")){var freqReminder=pageId.find("#reminder_freqdayscnt").val();0!=(freqReminder=ZPSetupCommon.isEmpty(freqReminder)?"0":freqReminder)&&formData.append("reminder_freqdays",freqReminder)}if("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate?(noOfDays=pageId.find("#noOfDays").val(),ZPeople.IsNumeric(noOfDays)&&formData.append("noOfDays",noOfDays)):"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=$("#deadline").length&&void 0!=(expirationDays=ZPeopleComponents.datefield(document.getElementById("deadline")).getValue().dateString)&&formData.append("deadline",expirationDays),isFromForm||Zsign.isFromFormView||Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("workflow/list")>-1||Layout.Page.hash.indexOf("custombutton/add")>-1||Layout.Page.hash.indexOf("custombutton/edit")>-1){var showExpiryOptions=pageId.find("[name=showExpiryOptions]").is(":checked");if(formData.append("showExpiryOptions",showExpiryOptions),isZTemp){var expInDays=pageId.find("#expiry_in_days").val();ZPSetupCommon.isEmpty(expInDays)||formData.append("expInDays",expInDays)}else{if("on"==pageId.find("input[id='datelookupid']:checked").val()&&showExpiryOptions){formData.append("datelookupid",!0);var noOfDays=pageId.find("#deadlinedays").val();ZPSetupCommon.isEmpty(noOfDays)?formData.append("noOfDays",0):formData.append("noOfDays",noOfDays);dateField=pageId.find("#dateFieldOpt").val();formData.append("dateField",dateField)}"1"==pageId.find("input[id='expdateid']:checked").val()&&showExpiryOptions&&(formData.append("expdateid",!0),void 0!=(expirationDays=ZPeopleComponents.datefield(document.getElementById("deadline")).getValue().dateString)&&formData.append("deadline",expirationDays))}if(formData.append("signing_order",pageId.find("[name=signing_order]").is(":checked")),formData.append("is_sequencial",pageId.find("[name=signing_order]").is(":checked")),!ZPSetupCommon.isEmpty(documentName)){var index=0;$.each(Zsign.textfield.formId,function(fcId,fieldName){documentName.indexOf("${"+fieldName+"}")>-1&&(documentName=documentName.replaceAll("${"+fieldName+"}",fcId),0!==index&&(docNameIds+=","),docNameIds+=fcId,index++)})}formData.append("docNameList",docNameIds)}if(Zsign.validation(isFromForm))Zsign.enableSaveBtn(pageId,"sliderSbt");else{void 0!=Zsign.userListArray&&0!=Zsign.userListArray.length&&formData.append("userListArray",Zsign.userListArray),void 0!=redSuccess&&0!=redSuccess.length&&formData.append("redSuccess",redSuccess),void 0!=redCompleted&&0!=redCompleted.length&&formData.append("redCompleted",redCompleted),void 0!=redDeclined&&0!=redDeclined.length&&formData.append("redDeclined",redDeclined),void 0!=redLater&&0!=redLater.length&&formData.append("redLater",redLater),isFromForm||"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate||"0"==FilesUtil.Page.getTabGroup()?!("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate)||ZPSetupCommon.isEmpty(Zsign.editSignTempId)&&ZPSetupCommon.isEmpty(Zsign.compSignFileId)?"0"==FilesUtil.Page.getTabGroup()&&formData.append("fileId",Zsign.compfileId):formData.append("fileId",Zsign.compSignFileId):(doc=Zsign.fileUploadObj,void 0!=Zsign.fileUploadObj.name&&formData.append("fileList",doc)),isFromForm||"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate||(ZPSetupCommon.isEmpty(ZPA_Esign.Uploadsource)||formData.append("uploadMode",ZPA_Esign.Uploadsource),!ZPSetupCommon.isEmpty(CloudPicker.fileObj)&&void 0!=CloudPicker.fileObj.length&&Layout.Page.hash.indexOf("#operations/files/esigndocuments")>-1&&formData.append("cloudUploadDoc",CloudPicker.fileObj)),ZPSetupCommon.isEmpty(ZPA_Esign.uploadMode)||formData.append("uploadMode",ZPA_Esign.uploadMode),isFromForm&&!innerForm?(formData.append("action","scheduleSendDocuments"),reqUrl="/zpzsign/scheduleSendDocuments"):("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate)&&!ZPSetupCommon.isEmpty(Zsign.editSignTempId)?(reqUrl="/zpzsign/editZohoSignTemplate",0!=Zsign.delZSActionId.length&&formData.append("delZSActionId",JSON.stringify(Zsign.delZSActionId))):settingsPage.isEnabled&&(formData.append("action","sendDocument"),reqUrl="/zpzsign/sendDocument"),formData.append("isNewUI",!0);var recpNameLen=$('[name^="recpFormValue"]').length,recipientDetails=[];if(recpNameLen>0)for(var ele=0;ele<recpNameLen;ele++){var selid=pageId.find("[name=recpFormValue]")[ele].id.split("_")[1],recpOrder=ele;if(isFromForm||"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate)var recpName=pageId.find($("#recpName_"+selid)).val(),action_id=pageId.find($("#recpName_"+selid)).parent().parent().attr("actionId");var recpFormValue=pageId.find($("#recpFormValue_"+selid)).val(),recpFieldValue="";pageId.find($("#recpFieldValue_"+selid)).hasClass("DN")||(recpFieldValue=ZPeopleComponents.select(pageId.find("#recpFieldValue_"+selid)).getValue()),4==recpFormValue&&(null!=(recpFieldValue=pageId.find($("#recpEmailValue_"+selid)).val())&&""!=recpFieldValue?(err=Adobesign.validateMailIds(recpFieldValue,pageId.find("#recpFieldValue_"+selid),ZPI18N.getString("zp.entervalidemailaddress")))&&pageId.find($("#recpEmailValue_"+selid)).addClass("ztextbox__error"):pageId.find($("#recpEmailValue_"+selid)).addClass("ztextbox__error"));var errMsg="";"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate?0!=ele&&(null!=recpFieldValue&&""!=recpFieldValue||"5"==recpFormValue||"6"==recpFormValue||("3"==recpFormValue&&(errMsg=ZPI18N.getString("zp.userselecterr")),pageId.find("#recpFieldValue_"+selid).parent().parent().addClass("zpl_erorbx"),pageId.find("#recpFieldValue_"+selid).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),ZPeopleComponents.select(pageId.find("#recpFieldValue_"+selid)).getElement().addClass("ztextbox__error"),err=!0)):null!=recpFieldValue&&""!=recpFieldValue&&"-1"!=recpFieldValue||"5"==recpFormValue||"6"==recpFormValue||("1"==recpFormValue?errMsg=ZPI18N.getString("zp.selectemailfield"):"2"==recpFormValue?errMsg=ZPI18N.getString("zp.emplookuperr"):"3"==recpFormValue?errMsg=ZPI18N.getString("zp.userselecterr"):"4"==recpFormValue&&(errMsg=ZPI18N.getString("zp.entervalidemailaddress")),"4"!==recpFormValue&&ZPeopleComponents.select(pageId.find("#recpFieldValue_"+selid)).getElement().addClass("ztextbox__error"),pageId.find("#recpFieldValue_"+selid).parent().parent().addClass("zpl_erorbx"),pageId.find("#recpFieldValue_"+selid).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),err=!0),5==recpFormValue&&(Zsign.isDynamicUserAdded()||(pageId.find("#recpFormValue_"+selid).parent().parent().addClass("zpl_erorbx"),pageId.find("#recpFormValue_"+selid).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.esign.selectlookupformanager")+"</span>"),ZPeopleComponents.select(pageId.find("#recpFormValue_"+selid)).getElement().addClass("ztextbox__error"),err=!0));var recpType=pageId.find($("#recpType_"+selid)).val(),recpLocale=ZPeopleComponents.select(pageId.find("#recpLocale_"+selid)).getValue(),privateMessage=void 0;if(void 0==(action_id=pageId.find($("#recpName_"+selid)).parent().parent().attr("actionId"))||ZPSetupCommon.isEmpty(Zsign.editSignTempId)){var pdata=pageId.find("#recpFormValue_"+selid).parent().parent().data().pdata;void 0!=pdata&&null!=pdata&&""!=pdata&&(privateMessage=pdata.privateMsg)}else privateMessage=Zsign.getPrivateNotesFromZsignResp(void 0,action_id);var verifyOn=void 0;if(void 0==(action_id=pageId.find($("#recpName_"+selid)).parent().parent().attr("actionId"))||ZPSetupCommon.isEmpty(Zsign.editSignTempId)){var ldata=pageId.find("#recpFormValue_"+selid).parent().parent().data().ldata;if(void 0!=ldata&&null!=ldata&&""!=ldata&&(verifyOn=ldata.verify))delType=1}else{action_id=pageId.find($("#recpName_"+selid)).parent().parent().attr("actionId");if(verifyOn=Zsign.getVerifyRecpFromZsignResp(void 0,action_id))var delType=1}if(2==recpType&&0==ele&&(errMsg=ZPI18N.getString("zp.zs.firstrolesigner"),pageId.find("#recpType_"+selid).parent().parent().addClass("zpl_erorbx"),pageId.find("#recpType_"+selid).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),ZPeopleComponents.select(pageId.find("#recpType_"+selid)).getElement().addClass("ztextbox__error"),err=!0),4==recpType){var recpHost=pageId.find("#recpHost_"+selid).val();null==recpHost&&(errMsg=ZPI18N.getString("zp.zohosignusererr"),pageId.find("#recpHost_"+selid).parent().parent().addClass("zpl_erorbx"),pageId.find("#recpHost_"+selid).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),ZPeopleComponents.select(pageId.find("#recpHost_"+selid)).getElement().addClass("ztextbox__error"),err=!0)}5==recpFormValue&&($("#recpFormValue_"+selid),0);var recipientDetailsObject={};(isFromForm||"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate)&&(recipientDetailsObject[Zsign.RECIPIENT_ID]=recpName,void 0!=action_id&&(recipientDetailsObject[Zsign.ACTION_ID]=action_id)),recipientDetailsObject[Zsign.RECIPIENT_ORDER]=recpOrder,recipientDetailsObject[Zsign.RECIPIENT_FIELD_TYPE]=recpFormValue,1==recpFormValue?recipientDetailsObject[Zsign.EMAIL_FORM_FIELD_TYPE]=recpFieldValue:2==recpFormValue?recipientDetailsObject[Zsign.RECORD_OWNER_FIELD_TYPE]=recpFieldValue:3==recpFormValue?recipientDetailsObject[Zsign.USER_EMAIL_FIELD_TYPE]=recpFieldValue:4==recpFormValue&&(recipientDetailsObject[Zsign.RECIPIENT_ID]=recpFieldValue),recipientDetailsObject[Zsign.RECIPIENT_TYPE]=recpType,recipientDetailsObject[Zsign.RECIPIENT_LOCALE]=recpLocale,recipientDetailsObject[Zsign.RECIPIENT_PRIVATE_MESSAGE]=privateMessage,void 0!=verifyOn&&(recipientDetailsObject[Zsign.RECIPIENT_VERIFY]=verifyOn,recipientDetailsObject[Zsign.RECIPIENT_DELIVERY_TYPE]=delType),4==recpType&&(recipientDetailsObject[Zsign.RECIPIENT_HOST]=recpHost),recipientDetails.push(recipientDetailsObject)}if(ZPSetupCommon.isEmpty(recipientDetails)?(errMsg=ZPI18N.getString("zp.selectemailidfield"),pageId.find("#recp_rows").before('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),err=!0):formData.append("recipientDetails",JSON.stringify(recipientDetails)),!err){if(formData.append("document_message",ZPSetupCommon.isEmpty(documentMessage)?"":documentMessage),void 0!=addtofileupload&&0!=addtofileupload&&formData.append("addtofileupload",addtofileupload),formData.append("document_name",ZPSetupCommon.isEmpty(documentName)?"":documentName),pageId.find("#agrselect_newCatName").is(":visible")){var newCatName=pageId.find("#agrselect_newCatName").val().trim();formData.append("newCatName",newCatName)}else{var catId=ZPeopleComponents.select(pageId.find("#agrselect_Cat")).getValue();formData.append("catId",catId)}var synctohrfiles=pageId.find("[name=synctohrfiles]").is(":checked");if(null!=synctohrfiles&&0!=synctohrfiles){formData.append("synctohrfiles",!0);var hrfileoptval="",optrecordbtn=pageId.find("[id=optrecordbtn]:checked").val(),optotherbtn=pageId.find("[id=optotherbtn]:checked").val();if(!(void 0!=optrecordbtn&&""!=optrecordbtn||void 0!=optotherbtn&&""!=optotherbtn))return pageId.find("#moreSettings").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.zs.anyopt")+"</span>"),void(err=!0);if("on"==optrecordbtn)hrfileoptval=1;else if("on"==optotherbtn){if(null==pageId.find("select#hrfileopt").val()||"Select"==pageId.find("select#hrfileopt").val())return pageId.find("#hrfileoptdiv").after('<div class="ERR MT2" id="errorMsg">'+ZPI18N.getString("zp.lookupfielderr")+"</div>"),void(err=!0);hrfileoptval=pageId.find("select#hrfileopt").val()}ZPSetupCommon.isEmpty(hrfileoptval)||formData.append("hrfileoptval",hrfileoptval.toString())}pageId.find("form#createDocumentForm").hide(),"sendDocument"==formData.get("action")&&(pageId.find("#setting_lnk").parent().hide(),pageId.find("#setting_lnk").hide()),isFromForm?(formData.append("relatedModule","6"),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId?(formData.append("recordId",ZP5Form.getFormClassObj().getParams().recordId),formData.append("recList",ZP5Form.getFormClassObj().getParams().recordId),formData.append("formId",ZP5Form.getFormClassObj().getParams().formId)):(formData.append("recList",Zsign.ESIGN_FORMS_RECORD_IDS.toString()),formData.append("formId",ZP5Form.getCurrFormsOperation().formId)),formData.append("docType","pdf"),innerForm&&($("#esignforms #sliFootDiv #sliderCancel").hide(),$("#esignforms #sliFootDiv #sliderSbt").hide(),$("#esignforms_card").hide())):"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate?($("#esignorg #sliFootDiv #sliderCancel").hide(),$("#esignorg #sliFootDiv #slidernxt").hide(),$("#esignorg #sliFootDiv #sliderSbt").hide(),pageId.find("#basicDetails, #docHeader, #recpHeader,#optionHeader, #moreSettings, #zsMergeSec").addClass("DNI")):"0"==FilesUtil.Page.getTabGroup()?($("#tabesignfiles #sliFootDiv #sliderCancel").hide(),$("#tabesignfiles #sliFootDiv #sliderSbt").hide(),$("#cardesignfiles").hide()):($("#esign #sliFootDiv #sliderCancel").hide(),$("#esign #sliFootDiv #sliderSbt").hide(),pageId.find("#basicDetails, #docHeader, #recpHeader,#optionHeader, #moreSettings").addClass("DNI")),0==pageId.parent().find("#zp_page_loading").length&&pageId.after(ZPeople.LOADING_HTML),err||$.ajax({url:reqUrl,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){ZPA_Esign.resetuploadValues();var pageId=settingsPage.container;if(Zsign.selectedRecpForm=null,isFromForm&&!innerForm)return Zsign.closePopup("esignforms"),Zsign.removeElementsfn(),$("#recordActionsContainer #recordActionClose").trigger("click"),void ZPeople.Message.success(ZPI18N.getString("zp.documentscheduled"));if("1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate){Zsign.delZSActionId=[];data[1].templates.template_id;var signURL=data[1].tempURL;return pageId.parent().find("div#zp_page_loading").remove(),$("iframe[name='createDocumentResp']").attr("src",signURL).show(),$("div#embed_iframe").show(),$("div#esignorg_card").show(),$("#esignorg").addClass("zpl_mfull"),void("1"==FilesUtil.Page.getTabGroup()&&0==$("td[fileid="+Zsign.compSignFileId+"]").find("#moreFileOperations").find("#reqSign").length&&(Zsign.locId=pageId.find("#comp_fileListing").find("#compfileTr_"+Zsign.compSignFileId).find("#moreFileOperations").find("#setupSign").attr("locID"),Zsign.divisionId=pageId.find("#comp_fileListing").find("#compfileTr_"+Zsign.compSignFileId).find("#moreFileOperations").find("#setupSign").attr("divi"),Zsign.unitId=pageId.find("#comp_fileListing").find("#compfileTr_"+Zsign.compSignFileId).find("#moreFileOperations").find("#setupSign").attr("unit"),Zsign.departmentId=pageId.find("#comp_fileListing").find("#compfileTr_"+Zsign.compSignFileId).find("#moreFileOperations").find("#setupSign").attr("dept"),Zsign.entityId=pageId.find("#comp_fileListing").find("#compfileTr_"+Zsign.compSignFileId).find("#moreFileOperations").find("#setupSign").attr("ent"),Zsign.compfileId="",Zsign.locId="",Zsign.divisionId="",Zsign.departmentId="",Zsign.entityId="",Zsign.unitId=""))}data[1].hasOwnProperty("newCategoryname")&&Zsign.folderList.length>0&&(Zsign.folderListObj[data[1].catId]=ZSEC.Encoder.encodeForHTML(data[1].newCategoryname),settingsPage.container.find("select#search_cat").append("<option value='"+data[1].catId+"'>"+ZSEC.Encoder.encodeForHTML(data[1].newCategoryname)+"</option>"));var embedUrlArray;embedUrlArray=data[1].request_url.split("#");var frameOrigin=window.location.protocol+"//"+window.location.host,zohoOneOrigin=ZPUnifieduiUtil.getZOFrameOriginUrl();null!=zohoOneOrigin&&void 0!=zohoOneOrigin&&""!=zohoOneOrigin&&(frameOrigin+=","+zohoOneOrigin);var embedUrl=embedUrlArray[0]+"?frameorigin="+frameOrigin+"#"+embedUrlArray[1];if(isFromForm?$("#esignforms").addClass("zpl_mfull"):"0"==FilesUtil.Page.getTabGroup()?$("#tabesignfiles").addClass("zpl_mfull"):"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate?$("#esignorg").addClass("zpl_mfull"):$("#esign").addClass("zpl_mfull"),pageId.parent().find("div#zp_page_loading").remove(),$("iframe[name='createDocumentResp']").attr("src",embedUrl).show(),pageId.find("button#close_btn").show(),$("div#embed_iframe").show(),Zsign.loadIframe(data[1]),pageId.find("#basicDetails, #docHeader, #recpHeader,#optionHeader, #moreSettings, #zsMergeSec").addClass("DNI"),$("#redirection").hide(),pageId.find("div#sliFootDiv").hide(),pageId.find("button#footer_submit").hide(),-1===Layout.Page.hash.indexOf("-formId")&&-1===Layout.Page.hash.indexOf("files/hrfile")){var viewObj=settingsPage.container.find("#documents_list_form"),relobj=settingsPage.container.find("#anchor_single_doc_list");viewObj.is(":visible")&&(relobj.hasClass("collapsed")||relobj.addClass("collapsed"),viewObj.slideUp())}},error:function(req){if(pageId.parent().find("div#zp_page_loading").remove(),pageId.find("form#createDocumentForm,div#sliFootDiv").show(),$("div#sliFootDiv").show(),innerForm&&($("#esignforms #sliFootDiv #sliderCancel").show(),$("#esignforms #sliFootDiv #sliderSbt").show(),$("#esignforms_card").show()),pageId.find("#basicDetails, #docHeader, #recpHeader,#optionHeader, #moreSettings, #zsMergeSec").removeClass("DNI"),$(pageId).find("#redirection").show(),$(sliderId).find("#sliFootDiv #sliderCancel").show(),$(sliderId).find("#sliFootDiv #sliderSbt").show(),$(sliderId).find("#sliFootDiv #slidernxt").show(),$(pageId).show(),-1==req.responseText.search("File size is greater than allocated limit")){if(-1!=req.responseText.search("mailmerge")){var errorMsg;return errorMsg=JSON.parse(JSON.parse(req.responseText)[1].msg).error.message,ZPeople.Message.failure(errorMsg),void Zsign.enableSaveBtn(pageId,"sliderSbt")}if(400!==req.status){var errResponse=req.responseJSON[1];if(8026==errResponse.errorCode||9999==errResponse.errorCode||9995==errResponse.errorCode||9994==errResponse.errorCode||9996==errResponse.errorCode||8100==errResponse.errorCode||8101==errResponse.errorCode||7569==errResponse.errorCode)return ZPeople.Message.failure(errResponse.msg),void Zsign.enableSaveBtn(pageId,"sliderSbt");if(6013==errResponse.errorCode)return ZPeople.Message.failure(ZPI18N.getString("zp.mmmailfailuresubject")),void Zsign.enableSaveBtn(pageId,"sliderSbt");if(6014==errResponse.errorCode)return ZPeople.Message.failure(ZPI18N.getString("zp.mmmailfailureerrormessadmin")),void Zsign.enableSaveBtn(pageId,"sliderSbt");if(7566==errResponse.errorCode){ZPeople.isChinaSetup||document.domain.substring(document.domain.lastIndexOf(".")+1);return ZPeople.Message.failure(ZPI18N.getString("zp.zs.zsaccexist")),void Zsign.enableSaveBtn(pageId,"sliderSbt")}if("string"==typeof errResponse.msg)ZPeople.Message.failure(errResponse.msg),settingsPage.container.find("div#zp_page_loading").remove();else{var dispMsg,validationMsg=errResponse.msg;"7541"!=errResponse.errorCode&&"9991"!=errResponse.errorCode||(isFromForm?innerForm&&($("#esignforms #sliFootDiv #sliderCancel").show(),$("#esignforms #sliFootDiv #sliderSbt").show()):"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&isFromZSTemplate?($("#esignorg #sliFootDiv #sliderCancel").show(),$("#esignorg #sliFootDiv #sliderSbt").show()):"0"==FilesUtil.Page.getTabGroup()?($("#tabesignfiles #sliFootDiv #sliderCancel").show(),$("#tabesignfiles #sliFootDiv #sliderSbt").show()):($("#esign #sliFootDiv #sliderCancel").show(),$("#esign #sliFootDiv #sliderSbt").show()));if(void 0==validationMsg&&"9991"==errResponse.errorCode)return ZPeople.Message.failure(ZPI18N.getString("zp.manageremailempty")),void Zsign.enableSaveBtn(pageId,"sliderSbt");if(validationMsg.hasOwnProperty("ef")){var dispName="<p>";$.each(validationMsg.ef,function(mailId,errorCompList){$.each(errorCompList,function(index,errId){var optElm=$("[id=zp_field_outer_"+errId+"]").parent().find("div label").text();-1===dispName.indexOf(optElm)&&(index>0&&(dispName+=","),dispName+=optElm)})}),dispMsg=dispName+=" is not available for this/these record(s) </p>"}else validationMsg.hasOwnProperty("extnerr")?dispMsg=ZPI18N.getString("zp.fileformaterr"):validationMsg.hasOwnProperty("disbaled")?dispMsg=validationMsg.disbaled:validationMsg.hasOwnProperty("limitEx")?dispMsg=validationMsg.limitEx:ZPeople.Message.failure(req.statusText);void 0!=dispMsg&&ZPeople.Message.failure(dispMsg),Zsign.enableSaveBtn(pageId,"sliderSbt")}}else{if("PATTERN_NOT_MATCHED"==req.responseJSON.code){var textParam=ZPI18N.getString("zp.field");"document_name"!=req.responseJSON.paramName&&"config_name"!=req.responseJSON.paramName||(textParam=ZPI18N.getString("zp.esign.docname")),"document_message"!=req.responseJSON.paramName&&"automation_message"!=req.responseJSON.paramName||(textParam=ZPI18N.getString("zp.message")),ZPeople.Message.failure(ZPI18N.getString("zp.entervalidinputforesign",new Array(textParam)))}else ZPeople.Message.failure(req.responseJSON.error);Zsign.enableSaveBtn(pageId,"sliderSbt")}}else{for(var filename=req.responseJSON[1].msg.substring(req.responseJSON[1].msg.indexOf("-")+1),spanCount=pageId.find("#multiple_files").find("span").length,q=0;q<spanCount;q++)if(pageId.find("#multiple_files").find("span").find("b")[q].innerHTML==filename)return $('<div class="ERR ML15 MT2" id="errorMsg">'+ZPI18N.getString("zp.maxfilesize")+"</div>").insertAfter(pageId.find("#multiple_files").find("span")[q]),void Zsign.enableSaveBtn(pageId,"sliderSbt");Zsign.enableSaveBtn(pageId,"sliderSbt")}}})}}},closePopup:function(id){$("#"+id).removeClass("zpl_mopen")},loadIframe:function(data){var serviceName="",pageId=$("#esign"),cardId="esign_card";if(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1||"0"==FilesUtil.Page.getTabGroup())void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),cardId="esignforms_card",isZSConfig?serviceName="ZohoSign":isAdobeConfig?serviceName="AdobeSign":isDocuConfig&&(serviceName="DocuSign");else{var viewtype=ZPeopleComponents.select(document.getElementById("zp_esign_view")).getValue();"4"==viewtype?serviceName="DocuSign":"6"==viewtype?serviceName="ZohoSign":"2"==viewtype&&(serviceName="AdobeSign")}void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(cardId="esignforms_card",pageId=$("#esignforms"),$("#esignforms_card").show()):"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&Zsign.isfromZSignTemplates()?(cardId="esignorg_card",pageId=$("#esignorg")):"0"==FilesUtil.Page.getTabGroup()?(cardId="cardesignfiles",pageId=$("#tabesignfiles")):settingsPage.isEnabled&&(cardId="esign_card",pageId=$("#esign"));data.requests;pageId.find("iframe[name='createDocumentResp']").one("load",function(){if("true"===$(this).attr("drafted")){if(Zsign.closePopup(cardId),pageId.show(),ZPeople.Message.success(ZPI18N.getString("zp.docadddsucc")),Zsign.removeElementsfn(),-1===Layout.Page.hash.indexOf("-formId")&&(-1==Layout.Page.hash.indexOf("view-formLinkName:")&&(window.location.href=Layout.Page.hash.split("-createDocument")[0]),Zsign.newRecordDetails={isAgreementSent:"true",module:data.MODULE,agreeid:data.recordId}),pageId.find("iframe[name='createDocumentResp']").attr("drafted","false"),pageId.attr("id").indexOf("files-Zsign-documentlistview")>-1||"esign_card"==cardId.trim()){var envName=settingsPage.container.find("input#search_documentname").val(),catId=ZPeopleComponents.select(settingsPage.container.find("select#search_cat")).getValue();"-1"==catId&&(catId=data.catId);var status=ZPeopleComponents.select(settingsPage.container.find("#search_status")).getValue(),name=data.name,newCatId=data.catId,ownerId=data.ownerId;if(!(catId!=newCatId&&""!=catId&&"select"!=catId&&void 0!=catId||"Draft"!=status&&""!=status&&"select"!=status&&void 0!=status||-1==name.indexOf(envName)&&""!=envName))data.OWN=ZSEC.Encoder.encodeForHTML(data.OWN),data.name=ZSEC.Encoder.encodeForHTML(name),data.ownerId=ZSEC.Encoder.encodeForHTML(ownerId),settingsPage.container.find("#documents_list").prepend(Zsign.constructDocumentData(data,"single",serviceName)),settingsPage.container.find("#create_agr").removeClass("DN"),settingsPage.container.find("#zsignTempListIcon").removeClass("DNI");var uniPageId=settingsPage.container;0===uniPageId.find("#documents_list tr").length?uniPageId.find("#document_norecords").removeClass("DNI"):(uniPageId.find("#document_norecords").addClass("DNI"),uniPageId.find("#documents_list").removeClass("DN"),uniPageId.find("#documents_listingpage").removeClass("DN"),1===uniPageId.find("#documents_list ul").length&&uniPageId.find("#documents_listingpage").addClass("expand"))}pageId.removeClass("zpl_mfull"),pageId.removeClass("zpl_mopen")}else $(this).attr("drafted","true"),pageId.show(),$("#"+cardId).show(),Zsign.loadIframe(data)})},sendReminder:function(_thisObj){var agrmntID=Zsign.documentId,params={conreqcsr:csrfToken,recordIdList:agrmntID};void 0!=ZP5Form.getFormClassObj()?(params.moduleType="2",params.recList=Zsign.recordId,void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId?params.formId=ZP5Form.getFormClassObj().getParams().formId:params.formId=ZP5Form.getCurrFormsOperation().formId):(params.moduleType="1",params.fileId=Zsign.companyFileId),ZPeople.Request.send("/zpzsign/sendReminder",params,Zsign.handleSendReminder,null,Zsign.failedCallBack)},failedCallBack:function(error,params,otherdetails){var responseJson=error.responseJSON[1];"500"==responseJson.errorCode||"4003"==responseJson.errorCode?("4003"==responseJson.errorCode&&($("#sliderSbt").addClass("disabled"),$("#slidernxt").addClass("disabled")),void 0!=responseJson.msg?ZPeople.Message.failure(responseJson.msg):ZPeople.Message.failure(error.statusText),Layout.Page.hash.indexOf("files/fileView/documentlistview")>-1&&settingsPage.container.find("div#agmnt_footer").hide()):"8006"==responseJson.errorCode&&(ZPeople.Message.failure(responseJson.msg),Layout.Page.hash.indexOf("files/fileView/documentlistview")>-1&&$("#files-Zsign-documentlistview").addClass("DN"))},handleSendReminder:function(data){"success"===data[1].status?ZPeople.Message.success(ZPI18N.getString("zp.remindersent")):"Error"===data[1].status&&(void 0!=data[1].message?ZPeople.Message.failure(data[1].message):ZPeople.Message.failure(ZPI18N.getString("zp.remindernotsent")))},getESignList(p1,p2,p3){var viewType=settingsPage.container.find("#search_view").val(),serviceCode=ZPeopleComponents.select(document.getElementById("zp_esign_view")).getValue();"2"==serviceCode?Adobesign.getAgreementsList(0,"search",!0,"","","",""):"4"==serviceCode?Docusign.getEnvelopeList("",-1,"search","","","",""):"6"==serviceCode&&"WorkFlowReports"==viewType?Zsign.getDocumentList("","","search","","","","WorkFlowReports"):"6"==serviceCode&&Zsign.getDocumentList("","","search")},getDocumentList:function(e,modeType,event,sortDefined,sortOrderval,sortColumnval,viewType,serviceName){Zsign.initZDFilterComp(serviceName),settingsPage.container.find("#doc_multiselDel").addClass("DNI"),settingsPage.container.find("#documents_checkallbox").prop("checked",!1),$("body").popover({selector:"[data-popover].popHover",trigger:"click hover",placement:"bottom",delay:{show:50,hide:50}});if(void 0!=viewType&&"WorkFlowReports"==viewType?($("#exportList").addClass("DN"),"getWFDocuments",settingsPage.container.find("#documents_table").addClass("DN"),settingsPage.container.find("#document_norecords").addClass("DNI"),settingsPage.container.find("#documents_list").addClass("DN"),ZPeopleComponents.select("#search_status").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_cat").setAttribute("selectedValue",ZPI18N.getString("zp.select")),settingsPage.container.find("#search_documentname").val("")):($("#exportList").removeClass("DN"),settingsPage.container.find("#wfdocuments_table").addClass("DN"),settingsPage.container.find("#wfdocument_norecords").addClass("DNI"),settingsPage.container.find("#wfdocuments_list").addClass("DN"),ZPeopleComponents.select("#search_wfstatus").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_form").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_perfrmdemp").setAttribute("selectedValue",ZPI18N.getString("zp.select")),settingsPage.container.find("#recordId_search").val(""),settingsPage.container.find("#emailId_search").val("")),void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),"search"!=event&&"reset"!=event||Adobesign.hideAndShowFilterIC("close"),void 0!=e&&13===e.keyCode||ZPSetupCommon.isEmpty(e)){Zsign.documentFirescroll=!1,Zsign.getFireScrollDocumentList(event,sortDefined,sortOrderval,sortColumnval,"6")}},getFireScrollDocumentList:function(event,sortDefined,sortOrderval,sortColumnval,serviceCode){var pageId=settingsPage.container,contentBody="";contentBody=pageId.find("#documents_list");var methodName="getDocuments",viewType=settingsPage.container.find("#search_view").val();void 0==serviceCode&&(serviceCode=ZPeopleComponents.select(document.getElementById("zp_esign_view")).getValue()),6==serviceCode&&void 0!=viewType&&"WorkFlowReports"==viewType?(methodName="getWFDocuments",contentBody=pageId.find("#wfdocuments_list")):"4"==serviceCode?methodName="getEnvelopes":"2"==serviceCode&&(methodName="getAgreementsList"),Zsign.FilesOperations.fromcompFilesReportPage&&(pageId.find("#wfdocuments_list ul").remove(),pageId.find("#documents_list ul").remove());var envName=pageId.find("input#search_documentname").val(),catId=ZPeopleComponents.select(pageId.find("select#search_cat")).getValue(),catName=ZPeopleComponents.select($("#search_cat")).getElement().find(".zselectbox__text").text(),status=pageId.find("select#search_status").val(),wfstatus=pageId.find("select#search_wfstatus").val(),formId=pageId.find("select#search_form").val(),emailID=pageId.find("input#emailId_search").val(),recordId=pageId.find("input#recordId_search").val(),formName=ZPeopleComponents.select($("#search_form")).getElement().find(".zselectbox__text").text(),perfrmdbyId=pageId.find("select#search_perfrmdemp").val(),perfrmdbyName=ZPeopleComponents.select($("#search_perfrmdemp")).getElement().find(".zselectbox__text").text(),startInd=ZPSetupCommon.isEmpty(contentBody.data("start"))?1:contentBody.data("start");"search"==event||"reset"==event||"sort"==event?(Zsign.documentFirescroll=!1,contentBody.empty(),Zsign.docStartindex=1):1==Zsign.documentFirescroll?0==Zsign.docStartindex?Zsign.docStartindex=25:Zsign.docStartindex=Zsign.docStartindex+24:Zsign.docStartindex=1,startInd=Zsign.docStartindex;var sortColumn="",sortOrder=!1,getSortColumn="",fileId="",searchParams={};Zsign.FilesOperations.companyFilesReport&&(fileId=Zsign.FilesOperations.companyFileId,""!=Zsign.previousCompfileID&&Zsign.previousCompfileID==Zsign.FilesOperations.companyFileId||(event="reset",Zsign.docStartindex=1,startInd=Zsign.docStartindex),Zsign.previousCompfileID=Zsign.FilesOperations.companyFileId);for(var toggleFields=settingsPage.container.find(".PI_sort"),i=0;i<toggleFields.length;i++){if(settingsPage.container.find("#"+toggleFields[i].id).hasClass("asc")){getSortColumn=settingsPage.container.find("#"+toggleFields[i].id).attr("id"),sortColumn=Zsign.Esign.getSortColumn(getSortColumn),sortOrder=!0;break}if(settingsPage.container.find("#"+toggleFields[i].id).hasClass("desc")){getSortColumn=settingsPage.container.find("#"+toggleFields[i].id).attr("id"),sortColumn=Zsign.Esign.getSortColumn(getSortColumn),sortOrder=!1;break}}""==sortColumn&&(void 0==sortDefined||""==sortDefined?(sortColumn="SENT_DATE",settingsPage.container.find("#sort_sentDate").addClass("desc")):(sortOrder=sortOrderval,sortColumn=sortColumnval));var sentFrom=ZPeopleComponents.datefield(document.getElementById("doc_sentfrom")).getValue().dateString,sentTo=ZPeopleComponents.datefield(document.getElementById("doc_sent_to_btn")).getValue().dateString;if(""==sentFrom||0==sentFrom||void 0==sentFrom)sentFrom="-1";else{var fromText=ZPI18N.getString("zp.from");void 0!=viewType&&"WorkFlowReports"==viewType&&(fromText="wf_From"),searchParams[fromText]=sentFrom}if(""==sentTo||0==sentTo||void 0==sentTo)sentTo="-1";else{var toText=ZPI18N.getString("zp.to");void 0!=viewType&&"WorkFlowReports"==viewType&&(toText="wf_To"),searchParams[toText]=sentTo}var params={action:methodName,limit:24,startInd:startInd,sortOrder:sortOrder,sortColumn:sortColumn,sentFrom:sentFrom,sentTo:sentTo,fileId:fileId};params.conreqcsr=csrfToken,Zsign.FilesOperations.fromcompFilesReportPage&&(params.type="files"),ZPSetupCommon.isEmpty(envName)||("2"==serviceCode?params.agreementName=envName:"4"==serviceCode?params.envelopeName=envName:params.documentName=envName,searchParams[ZPI18N.getString("zp.name")]=envName),ZPSetupCommon.isEmpty(emailID)||(params.recipients=emailID,searchParams[ZPI18N.getString("zp.emailid")]=emailID),ZPSetupCommon.isEmpty(recordId)||(params.recordId=recordId),ZPSetupCommon.isEmpty(recordId)||""===recordId||(searchParams[ZPI18N.getString("zp.historyExportRecordId")]=recordId),ZPSetupCommon.isEmpty(catId)||"select"===catId||"-1"===catId||(params.catId=catId),ZPSetupCommon.isEmpty(catName)||"Select"===catName||(searchParams[ZPI18N.getString("zp.folder")]=catName),ZPSetupCommon.isEmpty(status)||"select"===status||(params.status=status,searchParams[ZPI18N.getString("zp.status")]=status),ZPSetupCommon.isEmpty(wfstatus)||"select"===wfstatus||(params.wfstatus=wfstatus,searchParams[ZPI18N.getString("zp.wfstatus")]=wfstatus),ZPSetupCommon.isEmpty(formId)||formId.toLowerCase()!==ZPI18N.getString("zp.select").toLowerCase()&&(params.formId=formId,searchParams[ZPI18N.getString("zp.formname")]=formName),ZPSetupCommon.isEmpty(perfrmdbyId)||perfrmdbyId.toLowerCase()===ZPI18N.getString("zp.select").toLowerCase()||(params.perfmerecno=perfrmdbyId),ZPSetupCommon.isEmpty(perfrmdbyName)||perfrmdbyName.toLowerCase()===ZPI18N.getString("zp.select").toLowerCase()||(searchParams[ZPI18N.getString("zp.triggeredby")]=perfrmdbyName),void 0!=viewType&&"WorkFlowReports"==viewType&&(searchParams[ZPI18N.getString("zp.viewtype")]=ZPI18N.getString("zp.esign.wf.tabname2"));Zsign.breadcrumb_construct(searchParams);var otherData={serviceCode:serviceCode,event:event};if(6==serviceCode&&void 0!=viewType&&"WorkFlowReports"==viewType?$.ajax({url:"/zpzsign/getWFDocuments",type:"POST",data:params,async:!1,success:function(datas){Zsign.constructWFDocumentList(datas)}}):6==serviceCode?$.ajax({url:"/zpzsign/getDocuments",type:"POST",data:params,async:!1,success:function(datas){Zsign.constructDocumentList(datas,params,otherData)},failure:function(datas){Zsign.failedCallBack(datas)}}):"2"==serviceCode?$.ajax({url:"/adobesign/getAgreementsList",type:"POST",data:params,async:!1,success:function(datas){Zsign.constructDocumentList(datas,params,otherData)},failure:function(datas){Zsign.failedCallBack(datas)}}):"4"==serviceCode&&$.ajax({url:"/docusign/getEnvelopes",type:"POST",data:params,async:!1,success:function(datas){Zsign.constructDocumentList(datas,params,otherData)},failure:function(datas){Zsign.failedCallBack(datas)}}),1==Zsign.documentFirescroll)new FireScrollBack(Zsign.getFireScrollDocumentList,pageId,Zsign.docfireScrollUniqID)},showFilterOpts:function(keyId){settingsPage.container.find("#WFStatus_listingpage").toggleClass("expand"),$("#page-wrapper").toggleClass("shwresult")},getETemplateList:function(e,modeType,event,sortDefined,sortOrderval,sortColumnval,viewType){Zsign.initZTFilterComp(),void 0==isAnySignConfigured&&Zsign.getEsignConfigurations();var pageId=$("#esigntemplatesParent");(Zsign.FilesOperations.companyFilesReport,"search"!=event&&"reset"!=event||(pageId.find("#signtemplate_list").empty(),Adobesign.hideAndShowFilterIC("close")),void 0!=e&&13===e.keyCode||ZPSetupCommon.isEmpty(e))&&(Zsign.templateStartindex=1,Zsign.tempFirescroll=!1,pageId.find("#signtemplate_list").data({start:"1"}),Zsign.getFireScrollTemplatesList(event,sortDefined,sortOrderval,sortColumnval))},constructHRDocumentsList:function(data,params){var agreementsListElms="",pageId=settingsPage.container;pageId.find("#agrm_filterIc").addClass("DNI"),contentBody=pageId.find("#hrdoc_list");pageId.find("div#no_recfound_img").remove(),0===data[1].length?(settingsPage.container.find("#hrdoc_norecords .ctable").remove(),Zsign.newuinohrDocrecords(ZPI18N.getString("zp.nodatafound"))):(pageId.find("div#hrdoc_list").removeClass("DN"),pageId.find("div#hrdoc_listingpage").removeClass("DN"),pageId.find("div#temp_norecords").removeClass("Scrcont"),pageId.find("div#temp_norecords").addClass("DN"),$.each(data[1],function(index,obj){obj.hasOwnProperty("limit")||(agreementsListElms=Zsign.constructHRDocuments(obj),contentBody.append(agreementsListElms))}),Zsign.setCatName(data[1]),contentBody.data({start:params.startInd}),pageId.find("div#temp_footer").removeClass("DN"))},getFireScrollTemplatesList:function(evnt,sortDefined,sortOrderval,sortColumnval,serviceCode){var pageId=$("#esigntemplatesParent"),contentBody="";contentBody=pageId.find("#signtemplate_list");var envName=pageId.find("input#search_view").val(),startInd=ZPSetupCommon.isEmpty(contentBody.data("start"))?1:contentBody.data("start"),searchParams={},temp_sentfrom_Val=ZPeopleComponents.datefield(document.getElementById("temp_sentfrom")).getValue().dateString,temp_sentto_Val=ZPeopleComponents.datefield(document.getElementById("temp_sentto")).getValue().dateString;""!=temp_sentfrom_Val&&0!=temp_sentfrom_Val&&void 0!=temp_sentfrom_Val?(sentFrom=temp_sentfrom_Val,searchParams[ZPI18N.getString("zp.from")]=temp_sentfrom_Val):sentFrom="-1";""!=temp_sentto_Val&&0!=temp_sentto_Val&&void 0!=temp_sentto_Val?(sentTo=temp_sentto_Val,searchParams[ZPI18N.getString("zp.to")]=temp_sentto_Val):sentTo="-1";limit=24,"search"==evnt||"reset"==evnt?(contentBody.empty(),Zsign.templateStartindex=1,startInd=1):1==Zsign.tempFirescroll&&(0==Zsign.templateStartindex?Zsign.templateStartindex=25:Zsign.templateStartindex=Zsign.templateStartindex+24,startInd=Zsign.templateStartindex);var params={limit:limit,startInd:startInd,sentFrom:sentFrom,sentTo:sentTo,conreqcsr:csrfToken,noModuleCheck:!0};ZPSetupCommon.isEmpty(envName)||(params.documentName=envName,searchParams[ZPI18N.getString("zp.name")]=envName),Zsign.breadcrumb_construct(searchParams),$.ajax({url:"/zpzsign/getSignTemplates",type:"POST",data:params,success:function(data){if(Zsign.constructSignTemplateList(data,params),1==Zsign.tempFirescroll)new FireScrollBack(Zsign.getFireScrollTemplatesList,$("#zsignIdScroll"),Zsign.tempfireScrollUniqID)},failure:function(data){Zsign.failedCallBack(data)}})},constructSignTemplateList:function(data,params){var pageId=$("#esigntemplatesParent");contentBody=$("#signtemplate_list"),pageId.find("#agrm_filterIc").removeClass("DNI");settingsPage.container.find("#create_agr").removeClass("DN"),settingsPage.container.find("#zsignTempListIcon").removeClass("DNI"),pageId.find("div#no_recfound_img").remove(),Zsign.isCachedTempList=!0;var listCount=data[1].length-1;1===data[1].length&&contentBody.find(".ZPListingUL").length>1?Zsign.tempFirescroll=!1:0===data[1].length?(pageId.find("table#signtemplate_table").addClass("DN"),Zsign.newuinorecordsSigntemp()):(pageId.find("table#signtemplate_table").removeClass("DN"),pageId.find("tbody#signtemplate_list").removeClass("DN"),pageId.find("#signtemplate_table").removeClass("DN"),pageId.find("div#temp_norecords").addClass("DN"),data[1].length<24?Zsign.tempFirescroll=!1:Zsign.tempFirescroll=!0,$.each(data[1],function(index,obj){if(obj.hasOwnProperty("limit")){var limitCnt,start=obj.start;limitCnt=1===start?listCount>1?listCount:start:listCount>1?listCount+start-1:start,data.length<=1&&(start=0,limitCnt=0),pageId.find("span#zp_view_page_cnt").html(start+"&nbsp;-&nbsp;"+limitCnt),contentBody.data({start:start,next:obj.nexpage})}else{var row=Zsign.constructtemplateData(obj);(row=$(row)).data("ldata",obj),contentBody.append(row)}}),Zsign.setCatName(data[1]),contentBody.data({start:params.startInd}),pageId.find("div#temp_footer").removeClass("DN"))},constructWFDocumentList:function(data,params){var pageId=settingsPage.container,row="";data[1].length<24?Zsign.documentFirescroll=!1:Zsign.documentFirescroll=!0,0===data[1].length&&0===pageId.find("#wfdocuments_list tr").length?(settingsPage.container.find("#wfdocument_norecords .ctable").remove(),Zsign.newuinorecordswf(),pageId.find("#wfdocuments_list").addClass("DN"),pageId.find("#wfdocuments_table").addClass("DN")):(pageId.find("#wfdocument_norecords").addClass("DNI"),pageId.find("#wfdocuments_list").removeClass("DN"),pageId.find("#wfdocuments_table").removeClass("DN")),$.each(data[1],function(index,obj){if(!obj.hasOwnProperty("limit")){var status="Failure";obj.s&&(status="Success"),void 0==obj.e&&(obj.e=""),row+='<tr onclick=Zsign.viewApprovalPopup("'+obj.fid+'","'+obj.rcid+'",false) >',row+='<td class="tsize" >'+obj.wn+"</td>",row+='<td class="tsize" >'+ZSEC.Encoder.encodeForHTML(obj.esignName)+"</td>",row+="<td>"+ZSEC.Encoder.encodeForHTML(obj.formnm)+"</td>",row+="<td>"+ZSEC.Encoder.encodeForHTML(obj.perfnm)+"</td>",row+="<td>"+obj.time+"</td>",obj.s?row+='<td><span class="'+"grn d-flexclmcap5"+'">'+status+"</span></td>":(row+="<td><span class="+"red"+">"+status,row+='</span><i class="PI_info popHover red" data-title-position="auto" data-title-display-type="callout" title="'+ZPI18N.getString("zp.error")+" : "+ZPeople.escapeHtml(obj.e)+'"></i></td>'),row+="</tr>"}}),pageId.find("#wfdocuments_list").append(row)},populateDocumentView:function(){if(ZPSetupCommon.isEmpty(Zsign.hasZohosignRecord)){var params={conreqcsr:csrfToken};$.ajax({url:"/zpzsign/getEsignActivityOptions",type:"POST",data:params,async:!1,success:function(data){data=data[1].servicesConfigured,Zsign.hasZohosignRecord=data.hasZohosignActivity,Zsign.hasAdobesignRecord=data.hasAdobesignActivity,Zsign.hasDocusignRecord=data.hasDocusignActivity}})}},setEsignViewfilter:function(id,container){var signhtmlOpt="",eleId="#"+id,eleCont=eleId+"-container",parentContainer=settingsPage.container;void 0!=container&&(parentContainer=container),Zsign.countOfservices=0,parentContainer.find(eleId).html(""),(Zsign.hasZohosignRecord||isZSConfig)&&(signhtmlOpt+='<option id="6" value="6">'+ZPI18N.getString("zp.zohosign")+"</option>",Zsign.countOfservices++),(Zsign.hasAdobesignRecord||isAdobeConfig)&&(signhtmlOpt+='<option id="2" value="2">'+ZPI18N.getString("zp.adobeesign")+"</option>",Zsign.countOfservices++),(Zsign.hasDocusignRecord||isDocuConfig)&&(signhtmlOpt+='<option id="4" value="4">'+ZPI18N.getString("zp.docusign")+"</option>",Zsign.countOfservices++),parentContainer.find(eleId).html(signhtmlOpt),void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),parentContainer.find(eleId).on("zselectoptionclick",Zsign.loadReadView),isZSConfig||Zsign.isReadView&&Zsign.hasZohosignRecord?ZPeopleComponents.select(document.getElementById(id)).setValue(6):isAdobeConfig||Zsign.isReadView&&Zsign.hasAdobesignRecord?ZPeopleComponents.select(document.getElementById(id)).setValue(2):(isDocuConfig||Zsign.isReadView&&Zsign.hasDocusignRecord)&&ZPeopleComponents.select(document.getElementById(id)).setValue(4),Zsign.countOfservices>1?(Zsign.showEsignDropDownList=!0,parentContainer.find(eleCont).removeClass("DN")):parentContainer.find(eleCont).addClass("DN")},loadReadView:function(id){id=id.currentTarget.id,Zsign.isfromFilterView=!0;var serviceName="",viewtype=ZPeopleComponents.select(document.getElementById(id)).getValue();"zp_esign_viewfmv"==id?(Zsign.Forms.resetFilterOptions(),Zsign.Forms.searchAgreementsRecord(),Zsign.Forms.setEsignRecordId()):Zsign.resetFilterOptions(),"4"==viewtype?(serviceName="DocuSign","zp_esign_viewfmv"!=id&&(Zsign.constructZDocumentList(serviceName,viewtype),Zsign.Esign.getEnvelopeListpage("","","",serviceName))):"6"==viewtype?(serviceName="ZohoSign","zp_esign_viewfmv"!=id&&(Zsign.constructZDocumentList(serviceName,viewtype),Zsign.Esign.getDocumentsListPage("","",serviceName))):"2"==viewtype&&(serviceName="AdobeSign","zp_esign_viewfmv"!=id&&(Zsign.constructZDocumentList(serviceName,viewtype),Zsign.Esign.getAgreementsListPage("","","",serviceName)))},constructDocumentList:function(data,params,otherData){var agreementsListElms="",pageId=settingsPage.container,contentBody="",serviceCode=otherData.serviceCode,event=otherData.event;if(null!=Zsign.FilesOperations.companyFileId)settingsPage.container.find("#create_agr").addClass("DN"),settingsPage.container.find("#zsignTempListIcon").addClass("DNI"),settingsPage.container.find("#docfoldergroup").hide(),settingsPage.container.find("#search_nameHeader").hide(),settingsPage.container.find("#search_documentname").hide(),settingsPage.container.find("#exportasZip").hide(),settingsPage.container.find("#fileCompTitle").remove(),settingsPage.container.find("#doc_multiselDel").before('<div id="fileCompTitle"><span class="d-flexC"><b>'+ZPI18N.getString("zp.viewreportfor")+'</b><span class="zpl_dots"></span><em>'+Zsign.FilesOperations.fileNameforCR+"</em></span></div>"),settingsPage.container.find("#fileCompTitle").addClass("ML30 S16"),settingsPage.container.find("#zp_esign_view-container").addClass("DN"),settingsPage.container.find("#right_options_esign").addClass("DNI"),0!=settingsPage.container.find("#compBackbtn").length?settingsPage.container.find("#compBackbtn").show():settingsPage.container.find("#fileCompTitle").before("<i class='PI_back' id='compBackbtn' onclick='Zsign.FilesOperations.hideViewReport()'></i>");else{settingsPage.container.find("#create_agr").removeClass("DN"),6==serviceCode&&(settingsPage.container.find("#zsignTempListIcon").removeClass("DNI"),"Expired"==params.status||"Sent"==params.status?$("#extendbulk").removeClass("DN"):$("#extendbulk").addClass("DN"),"Sent"==params.status?$("#recallbulk").removeClass("DN"):$("#recallbulk").addClass("DN")),settingsPage.container.find("#right_options_esign").removeClass("DNI"),Zsign.countOfservices>1&&settingsPage.container.find("#zp_esign_view-container").removeClass("DN"),Zsign.populateDocumentView(),void 0==isZohoReadView&&Zsign.getReadView(),settingsPage.container.find("#search_nameHeader").show(),settingsPage.container.find("#search_documentname").show(),settingsPage.container.find("#exportasZip").show(),settingsPage.container.find("#docfoldergroup").show();var contHTML="<p class='LH18I'>"+ZPI18N.getString("zp.doctabinfo")+"</p>";settingsPage.container.find("#doc_HeaderBar .col-sm-7 .bc").find("span").remove(),settingsPage.container.find("#doc_HeaderBar .col-sm-7 .bc").append('<span class="ML5 bld S16">'+ZPI18N.getString("zp.esignature")+'<i data-popover="true" data-html="true" class="PI_info S18 gry ML10 popHover" title="" data-content="'+contHTML+'"></i></span>'),settingsPage.container.find("#compBackbtn").hide(),settingsPage.container.find("#fileCompTitle").hide()}contentBody=pageId.find("#documents_list");pageId.find("div#no_recfound_img").remove(),Zsign.isCachedDocumentList=!0;var listCount=data[1].length-1;if(1===data[1].length&&contentBody.find(".ZPListingUL").length>1)Zsign.documentFirescroll=!1;else if(1===data[1].length){"search"!=event&&(settingsPage.container.find("#create_agr").addClass("DN"),6!=serviceCode?settingsPage.container.find("#zsignTempListIcon").addClass("DNI"):settingsPage.container.find("#zsignTempListIcon").removeClass("DNI")),settingsPage.container.find("#document_norecords .ctable").remove();var noButton=!0;""!=event&&"reset"!=event||(noButton=!1),Zsign.newuinorecords(noButton),Zsign.noRecords=!0}else Zsign.noRecords=!1,pageId.find("div#document_norecords").addClass("DNI"),pageId.find("div#documents_list").removeClass("DN"),pageId.find("div#documents_table").removeClass("DN"),Zsign.documentFirescroll=!(listCount<24),$.each(data[1],function(index,obj){if(obj.hasOwnProperty("limit")){var limitCnt,start=obj.start;limitCnt=1===start?listCount>1?listCount:start:listCount>1?listCount+start-1:start,data.length<=1&&(start=0,limitCnt=0),1==start&&(!0,contentBody.empty()),pageId.find("span#zp_view_page_cnt").html(start+"&nbsp;-&nbsp;"+limitCnt),contentBody.data({start:start,next:obj.nexpage})}else null!=Zsign.FilesOperations.companyFileId?agreementsListElms+=Zsign.constructDocumentData(obj,"compfiles"):agreementsListElms+=Zsign.constructDocumentData(obj)}),contentBody.append(agreementsListElms),Zsign.setCatName(data[1]),contentBody.data({start:params.startInd}),pageId.find("div#document_footer").removeClass("DN"),settingsPage.container.find("#create_agr").removeClass("DN"),6==serviceCode&&settingsPage.container.find("#zsignTempListIcon").removeClass("DNI"),isZohoReadView&&!isZSConfig&&6==serviceCode?(settingsPage.container.find("#create_agr").addClass("DN"),settingsPage.container.find("#zsignTempListIcon").addClass("DNI")):isAdobeReadView&&!isAdobeConfig&&2==serviceCode?(settingsPage.container.find("#create_agr").addClass("DN"),settingsPage.container.find("#zsignTempListIcon").addClass("DNI")):isDocuReadView&&!isDocuConfig&&4==serviceCode&&(settingsPage.container.find("#create_agr").addClass("DN"),settingsPage.container.find("#zsignTempListIcon").addClass("DNI")),6!=serviceCode&&settingsPage.container.find("#zsignTempListIcon").addClass("DNI");null!=!Zsign.FilesOperations.companyFileId&&Zsign.populateDocumentView()},getReadView:function(){void 0!=isAdobeReadView&&void 0!=isDocuReadView&&void 0!=isZohoReadView||(Zsign.populateDocumentView(),$.ajax({type:"POST",async:!1,url:"/zpzsign/loginUserRolecheckAccess",data:{conreqcsr:csrfToken},success:function(data){isAdobeReadView=data[1].isAdobeReadView,isDocuReadView=data[1].isDocuReadView,isZohoReadView=data[1].isZohoReadView}}))},constructDocumentData:function(obj,mode,serviceName){var row="";if(Zsign.isRecordOpened||($("#documents_table").removeClass("DN"),$("#documents_list").removeClass("DN"),$("#document_norecords").addClass("DNI")),void 0==obj){$("#documents_table").addClass("DN"),$("#documents_list").addClass("DN");var pageDiv=$("[id=document_norecords]");let emptyPage=new EmptyPages("zp_nd_esign",ZPI18N.getString("zp.lookup.norecfound"),"",pageDiv);return emptyPage.setButton(ZPI18N.getString("zp.requestsignature"),Zsign.constructSendForSign),emptyPage.show(),row}ZPSetupCommon.isEmpty(obj.catId)||obj.catId;var statusCls,status,ARID,agreementId,owner,completeDate,sentDate,categoryName,ownerId,size,agName=ZPSetupCommon.isEmpty(obj.name)?"[No name]":obj.name;"DocuSign"==serviceName&&(agName=ZPeople.decodeTxt(obj.name));var repName=[];if("single"==mode)if("AdobeSign"==serviceName&&null!=obj.agreementId?(status="Out for Signature",ARID=obj.ARID,agreementId=obj.agreementId,owner=obj.owner,ownerId=obj.ownerId):"DocuSign"==serviceName&&null!=obj.envelopeId?(status="Sent",ARID=obj.recordId,agreementId=obj.envelopeId,owner=ZPeople.decodeTxt(obj.OWN),ownerId=ZPeople.decodeTxt(obj.ownerId)):(status="Draft",ARID=obj.recordId,agreementId=obj.requests.document_ids[0].document_id,owner=obj.OWN,ownerId=obj.ownerId),sentDate=obj.SD,"DocuSign"==serviceName&&(sentDate=obj.statusDateTime),completeDate="",obj.topRecipient,categoryName=Zsign.folderListObj[obj.catId],statusCls="org","AdobeSign"==serviceName||"DocuSign"==serviceName){size=obj.recipients.length;for(var i=0;i<size;i++)0==i&&obj.recipients[i],repName.push(obj.recipients[i])}else{size=obj.requests.actions.length;for(i=0;i<size;i++)0==i&&obj.requests.actions[i].recipient_email,repName.push(obj.requests.actions[i].recipient_email)}else ARID=obj.ARID,agreementId=obj.agreementId,owner=obj.owner,ownerId=obj.ownerId,sentDate=obj.sentDate,repName=obj.recipients,obj.topRecipient,completeDate=obj.completeDate,categoryName=Zsign.folderListObj[obj.catId],statusCls="Sent"===obj.status||"Out for Signature"===obj.status||"Draft"===obj.status?"org":"Completed"===obj.status||"Signed"===obj.status?"grn d-flexclmcap5":"red",status=obj.status;var recordid="";void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams()&&void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId&&(recordid=ZP5Form.getFormClassObj().getParams().recordId),""==owner&&(owner=ZPI18N.getString("zp.deleteduser"),ownerId="");var isCancelled="Cancelled / Declined"===obj.status;"formsHeader"==mode&&(row+="<th>"+ZPI18N.getString("zp.esign.docname")+"</th>",row+="<th>"+ZPI18N.getString("zp.reciepents")+"</th>",row+="<th>"+ZPI18N.getString("zp.datesent",new Array(""))+"</th>",row+="<th>"+ZPI18N.getString("zp.folder")+"</th>",row+="<th>"+ZPI18N.getString("zp.status")+"</th>",row+="<th>"+ZPI18N.getString("zp.actions")+"</th>"),row+='<tr documentId="'+ARID+'" isCancelled='+isCancelled+' envIdStr = "'+agreementId+'">',"forms"!=mode&&"formsHeader"!=mode&&(row+='<td><div class="zcheckbox" onclick=Zsign.Esign.checkParticularFiles(this,"documents");><input type="checkbox" name="check" value="" class="zcheckbox__helper"><label class="zcheckbox__label"></label></div></td>'),null!=obj.recipientPhoto?row+='<td><div class="zpl_em" ><div class="zpl_emimg"><img src="'+obj.recipientPhoto+'"></div>':row+='<td><div class="zpl_em" ><div class="zpl_emimg"><img src="'+obj.senderPhoto+'"></div>',"forms"==mode||"formsHeader"==mode?"3"===obj.module||"4"===obj.module?row+='<div class="zpl_emdts txttrim w200" onclick=Docusign.getEnvelopePreview(\''+ARID+"','"+recordid+"')><div onmouseover=Zsign.mouseEnterFunction()><b>"+agName+" </b></div>":"5"===obj.module||"6"===obj.module?row+='<div class="zpl_emdts txttrim w200" onclick=Zsign.getDocumentPreview(\''+ARID+"','"+recordid+"')><div onmouseover=Zsign.mouseEnterFunction()><b>"+agName+" </b></div>":row+='<div class="zpl_emdts txttrim w200" onclick=Adobesign.getAgreementPreview(\''+ARID+"','"+recordid+"')><div onmouseover=Zsign.mouseEnterFunction()><b>"+agName+" </b></div>":row+="compfiles"==mode?""==ownerId?'<div class="zpl_emdts txttrim w200" onclick=Zsign.getDocumentViewPage(this,\''+ARID+"')><div onmouseover=Zsign.mouseEnterFunction()><b>"+agName+" </b><em>"+ZSEC.Encoder.encodeForHTML(owner)+"</em></div>":'<div class="zpl_emdts txttrim w200" onclick=Zsign.getDocumentViewPage(this,\''+ARID+"')><div onmouseover=Zsign.mouseEnterFunction()><b>"+agName+" </b><em>"+ownerId+"-</em><em>"+owner+"</em></div>":'<div class="zpl_emdts txttrim w200" onclick=Zsign.getDocumentViewPage(this,\''+ARID+"')><div onmouseover=Zsign.mouseEnterFunction()><b>"+agName+" </b></div>","compfiles"!=mode&&(row+=""==ownerId?"<span><em>"+owner+"</em></span>":"<span><em>"+ownerId+" </em><em>"+owner+"</em></span>"),row+="</div></div></td>";var repId=repName;return obj.hasOwnProperty("recipients")&&(repId=obj.recipients.length>0&&obj.recipients[0].includes("Email:")?obj.recipients[0].substring(obj.recipients[0].indexOf(":")+1):obj.recipients),repName.length>1?(row+="<td>",row+='<div class="zpl_tg"><span onmouseover=Zsign.mouseEnterFunction()>'+repName.toString().split(",")[0]+"</span></div>",repName.length>9?row+='<div id="recpTo_'+agreementId+'" onclick="Zsign.Esign.showMoreRecepients(\''+repId+"','"+agreementId+'\');" class="zpl_tg"><span>9+</span></div>':row+='<div id="recpTo_'+agreementId+'" onclick="Zsign.Esign.showMoreRecepients(\''+repId+"','"+agreementId+'\');" class="zpl_tg"><span>+'+(repName.length-1)+"</span></div>",row+="</td>"):row+='<td><div class="zpl_tg" onmouseover=Zsign.mouseEnterFunction()><span>'+repId.toString().split(",")[0]+"</span></div></td>",row+='<td class="w200"><span id="sentOn">'+sentDate+"</span></td>",row+='<td id="cat_nm"><span onmouseover=Zsign.mouseEnterFunction() class="txttrim w150">'+categoryName+"</span></td>",row+=null!==completeDate&&void 0!==completeDate&&""!==completeDate?'<td class="w200" name="env_status"><span class="'+statusCls+'">'+status+"</span><span>"+completeDate+"</span></td>":'<td class="w200" name="env_status"><span class='+statusCls+">"+status+"</span></td>",row+='<td><div class="text-center"><div class="zpl_hvr">',"forms"!=mode&&"formsHeader"!=mode&&(row+='<i class="PI_downld" data-title-position="bottom" title="'+ZPI18N.getString("zp.Download")+'" onclick=Adobesign.downloadAttachement(this,"'+ARID+'","download") ></i>'),row+='<i class="PI_delete" data-title-position="bottom" title="'+ZPI18N.getString("zp.delete")+'" onclick=Zsign.deleteAgreementConfirm(Zsign.deleteAgreementRecord,this,"last","1");></i></div>',row+="</div></div></td></div>"},constructtemplateData:function(obj,mode){var row="";if(void 0==obj)return row+=ZPA_Esign.emptyData("temp_norecords",ZPI18N.getString("zp.lookup.norecfound"));var owner,createdDate,ownerId,isSystem,name=ZPSetupCommon.isEmpty(obj.name)?"[No name]":obj.name;name.lastIndexOf(".")>0&&(name=name.substring(0,name.lastIndexOf(".")));return obj.tempId,owner=obj.owner,ownerId=obj.ownerId,createdDate=obj.createdDate,isSystem=obj.isSystem,row+="<tr tempid='"+obj.tempId+'\'><td><div class="zcheckbox" onclick=Zsign.Esign.checkParticularFiles(this,"zsigntemplates");><input type="checkbox" name="check" value="" class="zcheckbox__helper"><label class="zcheckbox__label"></label></div></td>',row+='<td><div class="d-flexC d-flexclmcap10" id=\''+obj.fileID+"' onclick=\"Zsign.loadActionData('"+obj.tempId+"');Zsign.loadSignTemplate('"+obj.fileID+"','"+obj.tempId+"')\" name="+name+'><span class="PI_ft_pdf"></span>',isSystem?row+='<span class="d-flexM flex-dirC a-itm-left"><span>'+name+"</span><em>"+ZPI18N.getString("zp.createdon")+" "+createdDate+" "+ZPI18N.getString("zp.by")+" "+ZPI18N.getString("zp.systemdetect")+"</em></span>":void 0==ownerId&&""==createdDate?row+='<span class="d-flexM flex-dirC a-itm-left"><span>'+name+"</span><em>-</em></span>":""!=createdDate&&(row+='<span class="d-flexM flex-dirC a-itm-left"><span>'+name+" </span><em>"+ZPI18N.getString("zp.createdon")+" "+createdDate+" "+ZPI18N.getString("zp.by")+" "+owner+"</em></span>"),row+="</div></td>",row+='<td width="10%"><div class="text-center"><div id="hii" class="zpl_hvr"><i class="PI_more" onclick=Zsign.showtemdp(this)></i><div class="DN" id="moreOptionsParDiv" data-type="list" data-content-type="icon-text" data-direction="bottom-right">',row+='<ul id="moreFileOperations"><li id="reqSign" onclick="Zsign.loadActionData(\''+obj.tempId+"');Zsign.loadSignTemplate('"+obj.fileID+"','"+obj.tempId+'\')" data-icon-class="PI_sign">'+ZPI18N.getString("zp.requestsignature")+"</li>",row+='<li id= "editSign" onclick=Zsign.constructSendForOrgSign("edit",\''+obj.fileID+"','"+obj.tempId+'\'); data-icon-class="PI_edt">'+ZPI18N.getString("zp.esign.editsignature")+"</li>",row+="</ul></div>",row+='<i class="PI_delete" onclick=Zsign.deleteAgreementConfirm(Zsign.deleteZSignTemp,this,"last","2")></i></div></div></td></tr>'},showtemdp:function(thisObj){var thisTD=$(thisObj).closest("td");ZPeopleComponents.menu(thisTD.find("#moreOptionsParDiv")).appendTo=thisTD,ZPeopleComponents.menu(thisTD.find("#moreOptionsParDiv")).viewport=$("#tab-files-esigntemplates"),ZPeopleComponents.menu(thisTD.find("#moreOptionsParDiv")).setAttribute("width",250),ZPeopleComponents.menu(thisTD.find("#moreOptionsParDiv")).show({forElement:thisObj})},showUpgradePage:function(){Zsign.zstemplate.init(),$("#zp-contwrap-files-Zsign").addClass("zp_files"),settingsPage.container.find("#signtempdisp").addClass("DN"),settingsPage.container.find("#zsignsubscriptionLink").attr("href",Zsign.paymentUrl)},hideUpgrade:function(){settingsPage.container.find("#upgradediv").addClass("DN"),$("#zp-contwrap-files-Zsign").removeClass("zp_files"),settingsPage.container.find("#signtempdisp").removeClass("DN")},constructDataForPreview:function(isImage,filePath,fileOwner,name,recepient,documentId,sentDate,aggId,mode,thisObj,fileType){var agreementdtls=[];agreementdtls.fileId=aggId,agreementdtls.filePath=decodeURIComponent(filePath),agreementdtls.fileType=void 0!=fileType?fileType:3,agreementdtls.allowDownload=!0,agreementdtls.fileCreateByName=decodeURIComponent(fileOwner),agreementdtls.fileName=decodeURIComponent(name),agreementdtls.sharedTo=recepient,agreementdtls.fileDate=sentDate,agreementdtls.aggId=aggId,agreementdtls.mode=mode,agreementdtls.isImage=isImage;var fileExtn=agreementdtls.filePath.substring(agreementdtls.filePath.lastIndexOf(".")+1,agreementdtls.filePath.length),info={};info[ZPI18N.getString("zp.owner")]=ZPeople.escapeHtml(agreementdtls.fileCreateByName),info[ZPI18N.getString("zp.zs.Sentdate")]=agreementdtls.fileDate,info[ZPI18N.getString("zp.type")]=fileExtn,agreementdtls.info=info,Zsign.Esign.viewAttachment(agreementdtls,thisObj)},resetFilter:function(){Zsign.resetFilterOptions();var serviceCode=ZPeopleComponents.select(document.getElementById("zp_esign_view")).getValue();"6"==serviceCode?Zsign.getDocumentList("","","reset"):"2"==serviceCode?Adobesign.getAgreementsList(0,"reset",!0):Docusign.getEnvelopeList("","","reset")},resetFilterOptions:function(){var pageId=settingsPage.container;ZPeopleComponents.select("select#search_view").setAttribute("selectedValue","ESignatureDocuments"),pageId.find("#search_documentname").val(""),ZPeopleComponents.datefield(document.getElementById("doc_sent_to_btn")).setAttribute("value",""),ZPeopleComponents.datefield(document.getElementById("doc_sentfrom")).setAttribute("value",""),ZPeopleComponents.select("#search_status").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_cat").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_wfstatus").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_form").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_perfrmdemp").setAttribute("selectedValue",ZPI18N.getString("zp.select")),pageId.find("#recordId_search").val(""),pageId.find("#emailId_search").val("")},resetEsignTempFilter:function(){Zsign.resetFilterEsignTempOptions(),Zsign.getETemplateList("","","reset")},resetFilterEsignTempOptions:function(){$("#esigntemplatesParent").find("#search_view").val(""),ZPeopleComponents.datefield(document.getElementById("temp_sentto")).setAttribute("value",""),ZPeopleComponents.datefield(document.getElementById("temp_sentfrom")).setAttribute("value","")},resetSliderValues:function(){Zsign.zSignData="",ZPA_Esign.fileNameList=new Set},resetFormSliderValues:function(){void 0!=ZP5Form.getFormClassObj()&&(ZP5Form.getFormClassObj().getParams().formId=void 0),ZP5Form.getCurrFormsOperation().formId=void 0},isCandidateEmployee:function(){settingsPage.container.find("input#emailId_search").val(""),settingsPage.container.find("input#recordId_search").val(""),settingsPage.container.find("#emailIdsearch").addClass("DNI");var tableName=$("#search_form").find("option:selected").attr("tablename");"P_Employee"!=tableName&&"P_Candidate"!=tableName||(settingsPage.container.find("#emailIdsearch").removeClass("DNI"),settingsPage.container.find("#emailId_search").removeClass("DNI"))},searchStatusSign:function(serviceCode){ZPeopleComponents.select("#search_status").removeAllOptions(),ZPeopleComponents.select("#search_status").destroy(),ZPeopleComponents.select($("select#search_status").append(Zsign.searchstatus(serviceCode)))},searchAgreementsRecord:function(){settingsPage.container.find("button#reset_envBtn").removeClass("DN");var viewtype=settingsPage.container.find("#search_view").val(),serviceCode=ZPeopleComponents.select(document.getElementById("zp_esign_view")).getValue();Zsign.searchStatusSign(serviceCode),ZPeopleComponents.datefield(document.getElementById("doc_sentfrom")).setAttribute("value",""),ZPeopleComponents.datefield(document.getElementById("doc_sent_to_btn")).setAttribute("value",""),"6"==serviceCode&&"WorkFlowReports"==viewtype?(settingsPage.container.find("#search_view_flt").removeClass("DNI"),settingsPage.container.find("#search_nameHeader").hasClass("DNI")||settingsPage.container.find("#search_nameHeader").addClass("DNI"),settingsPage.container.find("#docfoldergroup").hasClass("DNI")||settingsPage.container.find("#docfoldergroup").addClass("DNI"),settingsPage.container.find("#esignstatus").hasClass("DNI")||settingsPage.container.find("#esignstatus").addClass("DNI"),settingsPage.container.find("#esignwfstatus").hasClass("DNI")&&settingsPage.container.find("#esignwfstatus").removeClass("DNI"),settingsPage.container.find("#formlist").hasClass("DNI")&&settingsPage.container.find("#formlist").removeClass("DNI"),settingsPage.container.find("#perfrmdbylist").hasClass("DNI")&&settingsPage.container.find("#perfrmdbylist").removeClass("DNI"),settingsPage.container.find("#recordIdsearch").hasClass("DNI")&&settingsPage.container.find("#recordIdsearch").removeClass("DNI")):"6"==serviceCode?("#operations/files/esigntemplates"==Layout.Page.hash&&settingsPage.container.find("#search_view_flt").removeClass("DNI"),settingsPage.container.find("#search_nameHeader").hasClass("DNI")&&settingsPage.container.find("#search_nameHeader").removeClass("DNI"),settingsPage.container.find("#fromDatefilter").hasClass("DNI")&&settingsPage.container.find("#fromDatefilter").removeClass("DNI"),settingsPage.container.find("#toDatefilter").hasClass("DNI")&&settingsPage.container.find("#toDatefilter").removeClass("DNI"),settingsPage.container.find("#docfoldergroup").hasClass("DNI")&&settingsPage.container.find("#docfoldergroup").removeClass("DNI"),settingsPage.container.find("#esignstatus").hasClass("DNI")&&settingsPage.container.find("#esignstatus").removeClass("DNI"),settingsPage.container.find("#esignwfstatus").hasClass("DNI")||settingsPage.container.find("#esignwfstatus").addClass("DNI"),settingsPage.container.find("#formlist").hasClass("DNI")||settingsPage.container.find("#formlist").addClass("DNI"),settingsPage.container.find("#perfrmdbylist").hasClass("DNI")||settingsPage.container.find("#perfrmdbylist").addClass("DNI"),settingsPage.container.find("#emailIdsearch").hasClass("DNI")||settingsPage.container.find("#emailIdsearch").addClass("DNI"),settingsPage.container.find("#recordIdsearch").hasClass("DNI")||settingsPage.container.find("#recordIdsearch").addClass("DNI")):"#operations/files/esigntemplates"==Layout.Page.hash?settingsPage.container.find("#search_view_flt").removeClass("DNI"):"4"!=serviceCode&&"2"!=serviceCode||(settingsPage.container.find("#docfoldergroup").removeClass("DNI"),settingsPage.container.find("#search_nameHeader").removeClass("DNI"),settingsPage.container.find("#esignstatus").removeClass("DNI"),settingsPage.container.find("#recordIdsearch").addClass("DNI"),settingsPage.container.find("#emailIdsearch").addClass("DNI"),settingsPage.container.find("#perfrmdbylist").addClass("DNI"),settingsPage.container.find("#formlist").addClass("DNI"),settingsPage.container.find("#esignwfstatus").addClass("DNI"),settingsPage.container.find("#search_view_flt").addClass("DNI"))},getDocumentViewPage:function(thisObj,recId){settingsUrlProps.url.indexOf("-documentId")>-1&&(window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("-documentId"))),window.location.href=Layout.Page.hash+"-documentId:"+recId},getDocumentPreview:function(agreementId,thisObj,mode,fileId){var agrId,moduleType,formId,recId;-1===Layout.Page.hash.indexOf("-formId:")&&(agrId=Layout.Page.hash.split("documentId:")[1]),Layout.Page.hash.indexOf("esigndocuments-documentId")>-1||Layout.Page.hash.indexOf("documentlistview-documentId")>-1||-1!==Layout.Page.hash.indexOf("hrfile")?moduleType="1":Layout.Page.hash.indexOf("-formId:")>-1?("form",moduleType="2",agrId=agreementId,void 0==(recId=ZP5Form.getFormClassObj().getParams().recordId)&&(recId=$(thisObj).closest("tr").attr("recordId")),formId=Layout.Page.urlparam.formId):(moduleType="2","form",void 0!=agreementId&&(agrId=agreementId),recId=thisObj,formId=Layout.Page.urlparam.formId),(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&(formId=ZP5Form.getCurrFormsOperation().formId),void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams()&&void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId&&(recId=ZP5Form.getFormClassObj().getParams().recordId),-1===Layout.Page.hash.indexOf("hrfile")&&"selffiles"!=mode||void 0!=agreementId&&(recId=agrId=agreementId,moduleType="1");var paramObj={conreqcsr:csrfToken,documentId:agrId,formId:formId};void 0!=fileId&&(paramObj.fileId=fileId,paramObj.type="files",moduleType="1"),paramObj.moduleType=moduleType,Zsign.isfromFormReport||(paramObj.recordId=recId),$.ajax({url:"/zpzsign/getDocumentStatus",type:"POST",data:paramObj,success:function(data){Zsign.constructDocumentInfo(data,paramObj,agrId)},failure:function(data){Zsign.failedCallBack(data)}})},viewRecipients:function(obj){$(obj).hasClass("open")?($(obj).removeClass("open"),$(obj).next("#zpl_esignOpn").addClass("DNI")):($(obj).addClass("open"),$(obj).next("#zpl_esignOpn").removeClass("DNI"))},getsingleRecordconst:function(obj){var relobj=$($($(obj[0]).find("div")[4]).find("div")[1]),recordid=ZP5Form.getFormClassObj().getParams().recordId,formId=ZP5Form.getFormClassObj().getParams().formId,viewObj=$(relobj).parent().parent().parent().find("#documents_table");if($.ajax({type:"POST",async:!1,url:"/zpzsign/getEsignRecords",data:{conreqcsr:csrfToken,recordId:recordid,formId:formId},success:function(data){Zsign.recordAgreementList=data[1].agreementList}}),void 0==isAdobeReadView&&(Zsign.populateDocumentView(),$.ajax({type:"POST",async:!1,url:"/zpzsign/loginUserRolecheckAccess",data:{conreqcsr:csrfToken},success:function(data){isAdobeReadView=data[1].isAdobeReadView,isDocuReadView=data[1].isDocuReadView,isZohoReadView=data[1].isZohoReadView}})),""!=Zsign.recordAgreementList&&void 0!=Zsign.recordAgreementList&&!ZPSetupCommon.isEmpty(Zsign.recordAgreementList)&&Zsign.recordAgreementList.length>0){for(var recordIdArr="",recCount=Zsign.recordAgreementList.length,i=0;i<recCount;i++)i>=1&&(recordIdArr+=","),recordIdArr+=Zsign.recordAgreementList[i];$.ajax({type:"POST",async:!1,url:"/zpzsign/getDocuments",data:{action:"getDocuments",conreqcsr:csrfToken,recList:recordid,limit:24,startInd:1,sortOrder:void 0,recordIdList:recordIdArr,sortColumn:void 0,sentFrom:void 0,sentTo:void 0,isDocuSign:!1,isZohoSign:!1,noModuleCheck:!0,type:"form",formId:formId},success:function(data){var formData=new FormData;formData.append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&formData.append("formId",ZP5Form.getFormClassObj().getParams().formId),void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams().recordId&&void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId?formData.append("recordId",ZP5Form.getFormClassObj().getParams().recordId):Zsign.ESIGN_FORMS_RECORD_IDS.length>0&&formData.append("recList",Zsign.ESIGN_FORMS_RECORD_IDS.toString()),ZPA_Esign.openFilter(formData,!0);var agreementsListElms="",relobj=$($($(obj[0]).find("div")[4]).find("div")[1]),viewObj=$(relobj).parent().parent().parent().find("#documents_table");if(data[1].length>0)$.each(data[1],function(index,obj){obj.hasOwnProperty("limit")||(agreementsListElms+=0==index?Zsign.constructDocumentData(obj,"formsHeader"):Zsign.constructDocumentData(obj,"forms"))}),viewObj='<table class="zpl_tbl wd100_per" id="documents_table">'+agreementsListElms+"</table>",obj.find("#viewsContainer").parent().parent().removeClass("zpl_tblovh"),obj.find("#recordContainer").append(viewObj);else{agreementsListElms='<thead><tr id="formsHeader">';agreementsListElms+="<th>"+ZPI18N.getString("zp.esign.docname")+"</th>",agreementsListElms+='<th width="300">'+ZPI18N.getString("zp.reciepents")+"</th>",agreementsListElms+='<th width="125">'+ZPI18N.getString("zp.datesent",new Array(""))+"</th>",agreementsListElms+="<th>"+ZPI18N.getString("zp.folder")+"</th>",agreementsListElms+='<th width="125">'+ZPI18N.getString("zp.status")+"</th>",agreementsListElms+='<th width="125">'+ZPI18N.getString("zp.actions")+"</th>",viewObj='<table class="zpl_tbl wd100_per" id="documents_table">'+(agreementsListElms+="</tr></thead>")+"</table>",emptyHtml='<div class="zpl_frmclm zpl_frmclmview"><div class="zpl_Emptydata mt10"><div><p>'+ZPI18N.getString("zp.lookup.norecfound")+"</p></div></div></div>",obj.find("#viewsContainer").parent().parent().removeClass("zpl_tblovh"),obj.find("#recordContainer").append(viewObj),obj.find("#recordContainer").append(emptyHtml)}}}),Zsign.recordAgreementList=""}else{var agreementsListElms='<thead><tr id="formsHeader">';agreementsListElms+="<th>"+ZPI18N.getString("zp.esign.docname")+"</th>",agreementsListElms+='<th width="300">'+ZPI18N.getString("zp.reciepents")+"</th>",agreementsListElms+='<th width="125">'+ZPI18N.getString("zp.datesent",new Array(""))+"</th>",agreementsListElms+="<th>"+ZPI18N.getString("zp.folder")+"</th>",agreementsListElms+='<th width="125">'+ZPI18N.getString("zp.status")+"</th>",agreementsListElms+='<th width="125">'+ZPI18N.getString("zp.actions")+"</th>",viewObj='<table class="zpl_tbl wd100_per" id="documents_table">'+(agreementsListElms+="</tr></thead>")+"</table>",emptyHtml='<div class="zpl_frmclm zpl_frmclmview"><div class="zpl_Emptydata mt10"><div><p>'+ZPI18N.getString("zp.lookup.norecfound")+"</p></div></div></div>",obj.find("#viewsContainer").parent().parent().removeClass("zpl_tblovh"),obj.find("#recordContainer").append(viewObj),obj.find("#recordContainer").append(emptyHtml)}},getsingleRecordconstold:function(obj){obj=$(obj).parent();var relobj=$(obj).find("a"),viewObj=(ZP5Form.getFormClassObj().getParams().recordId,$(relobj).parent().parent().parent().find("#documents_list_form"));if(viewObj.is(":visible"))return relobj.hasClass("collapsed")||relobj.addClass("collapsed"),void viewObj.slideUp();if($(viewObj).find(".ZPListingUL").children().length>0)return relobj.removeClass("collapsed"),void viewObj.slideDown();$(relobj).parent().parent().parent().find("#documents_list_form").remove();var recorddetails=settingsPage.container.find("#zp_view_record_"+ZP5Form.getFormClassObj().getParams().recordId).closest("tr")[0],aggreeID=(ZP5Form.getFormClassObj().getParams().recordId,""),agreementsListElms="",esignmodule="";if(void 0==recorddetails&&void 0!=Zsign.newRecordDetails.agreeid?(aggreeID=Zsign.newRecordDetails.agreeid,esignmodule=Zsign.newRecordDetails.module):void 0!=settingsPage.container.find("#zp_view_record_"+ZP5Form.getFormClassObj().getParams().recordId).closest("tr")[0]?(aggreeID=settingsPage.container.find("#zp_view_record_"+ZP5Form.getFormClassObj().getParams().recordId).closest("tr")[0].getAttribute("agreeId"),esignmodule=settingsPage.container.find("#zp_view_record_"+ZP5Form.getFormClassObj().getParams().recordId).closest("tr")[0].getAttribute("module")):(aggreeID=null,esignmodule=null),"undefined"!=aggreeID&&"null"!=aggreeID&&null!=aggreeID){var isDocuSign=!1,isZohoSign=!0;1!=esignmodule&&2!=esignmodule||(isZohoSign=!1),4!=esignmodule&&3!=esignmodule||(isDocuSign=!0),$.ajax({type:"POST",async:!1,url:"/zpzsign/getDocuments",data:{action:"getDocuments",conreqcsr:csrfToken,limit:24,startInd:1,sortOrder:void 0,sortColumn:void 0,sentFrom:void 0,sentTo:void 0,documentId:aggreeID,isDocuSign:isDocuSign,isZohoSign:isZohoSign},success:function(data){agreementsListElms=Zsign.constructDocumentData(data,"forms"),relobj.removeClass("collapsed"),viewObj='<div class="ZPListing ZPLagree" id="documents_list_form">'+agreementsListElms+"</div>",$(relobj).parent().parent().parent().append(viewObj)}})}else agreementsListElms='<h4 class="ZPNdt text-center" id="zp_views_nodata">'+ZPI18N.getString("zp.lookup.norecfound")+"</h4>",istElms='<h4 class="ZPNdt text-center" id="zp_views_nodata">'+ZPI18N.getString("zp.lookup.norecfound")+"</h4>",relobj.removeClass("collapsed"),viewObj='<div class="ZPListing ZPLagree" id="documents_list_form">'+agreementsListElms+"</div>",$(relobj).parent().parent().parent().append(viewObj)},showOptDropdown:function(){var dropdown=document.getElementById("signOptListDrop");"none"==$("#signOptListDrop").css("display")?ZPeopleComponents.dropdownlist(dropdown).open({forElement:"#signOptList"}):ZPeopleComponents.dropdownlist(dropdown).close()},showExportDropdown:function(){"none"==$("#exportOptListDrop").css("display")?ZPeopleComponents.menu("#exportOptListDrop").show():ZPeopleComponents.menu("#exportOptListDrop").hide()},constructDocumentInfo:function(infoData,params,documentId){var content="",documentInfo=infoData[1],sliderParams={},expired=!1,recalled=!1,sent=!1;if(documentInfo.hasOwnProperty("DINFO")){var ownerInfo=documentInfo.DINFO;content=`<div class="zpl_crd">\n\t\t\t<div class="zpl_crdcnt">\n\t\t\t\t<div>\n\t\t\t\t\t<table class="zpl_dtails">\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div class="zpl_usrpfl">\n\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrdtls">\n\t\t\t\t\t\t\t\t\t\t\t<span id="agName"><b>${ZSEC.Encoder.encodeForHTML(ownerInfo.name)}</b> </span><em id="doc_sent_date">${ownerInfo.sentDate}</em>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div class="zpl_em">\n\t\t\t\t\t\t\t\t\t\t<div class="zpl_emdts">\n\t\t\t\t\t\t\t\t\t\t\t<div id="agOwner"><b>${ZSEC.Encoder.encodeForHTML(ownerInfo.owner)}</b></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="zpl_emimg"><img id="senderProfile" src="${ownerInfo.senderPhoto}"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div class="zpl_usrpfl">\n\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrdtls">\n\t\t\t\t\t\t\t\t\t\t\t<span><b>${ZPI18N.getString("zp.status")}</b> </span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class="d-flexC">\n\t\t\t\t\t\t\t\t\t<div id="signDocStatus" >`,"-"===ownerInfo.completeDate||null===ownerInfo.completeDate||void 0===ownerInfo.completeDate||""===ownerInfo.completeDate||"COMPLETED"!=ownerInfo.status.toUpperCase()&&"SIGNED"!==ownerInfo.status.toUpperCase()?"EXPIRED"==ownerInfo.status.toUpperCase()||"RECALLED"==ownerInfo.status.toUpperCase()?(content+=`<span class="red d-flexclmcap5 j-cnt-rgt">${ownerInfo.status}</span><span class=""></span>`,"RECALLED"==ownerInfo.status.toUpperCase()?recalled=!0:"EXPIRED"==ownerInfo.status.toUpperCase()&&(expired=!0)):"SENT"==ownerInfo.status.toUpperCase()||"OUT FOR SIGNATURE"==ownerInfo.status.toUpperCase()?(content+=`<span class="org d-flexclmcap5 j-cnt-rgt">${ownerInfo.status}</span><span class=""></span>`,sent=!0):"Cancelled / Declined"==ownerInfo.status&&(content+=`<span class="red d-flexclmcap5 j-cnt-rgt">${ownerInfo.status}</span><span class=""></span>`,cancelled=!0,recalled=!0):(content+=`<span class="grn d-flexclmcap5 j-cnt-rgt"><font class="PI_tick2_fil grn"></font>${ownerInfo.status}</span><span id="completed_date" class="">${ownerInfo.completeDate}</span>`,!0),content+="</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>",recalled&&(content+=`<tr id="recall_reason">\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div class="zpl_usrpfl">\n\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrdtls">\n\t\t\t\t\t\t\t\t\t\t\t<span><b>${ZPI18N.getString("zp.reason")}</b> </span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class="d-flexC zpl_h-100">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<span id="reasonCont" class="">${ownerInfo.reason}</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>`),content+=`<tr id="doc_lastdate">\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div class="zpl_usrpfl">\n\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrdtls">\n\t\t\t\t\t\t\t\t\t\t\t<span><b>${ZPI18N.getString("zp.deadlineforsigning")}</b> </span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td class="d-flexC">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<span id="deadLine" class="">${ownerInfo.lastDate}</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr id="doc_message">\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<div class="zpl_usrpfl">\n\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrdtls">\n\t\t\t\t\t\t\t\t\t\t\t<span><b>${ZPI18N.getString("zp.message")}</b> </span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t\t<div id="message_field" class="zpl_secn M0I">\n                       <div class="M0I">\n                         <div class="zpl_msgTmpView">${ownerInfo.message}</div>\n                       </div>\n                    </div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="zpl_secn">\n                <div>\n                    <h5>${ZPI18N.getString("zp.reciepents")}</h5>\n                </div>`;for(var recp_len=Object.keys(documentInfo.RINFO).length,i=0;i<recp_len;i++)for(var flag=0,j=0;j<recp_len;j++){var recepientInfo=documentInfo.RINFO[Object.keys(documentInfo.RINFO)[j]];if(i==recepientInfo.RO-1){var recpIcon="PI_sign cirIcon";content+=`<div class="zpl_QAcstm zpl_crdwthful zpl_docRec">\n\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_secn zpl_crd">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_crdcnt CP" onclick=Zsign.viewRecipients(this)>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="d-flexC">                                \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="d-flex j-cnt-btwen wd100_per">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_em w250">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_emimg">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="zpl_pichr">${recepientInfo.RN.charAt(0).toUpperCase()}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_emdts"  data-toggle="tooltip" title="`+recepientInfo.RN+`" data-placement="bottom" >\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<em>${recepientInfo.RN}</em>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>`,recpIcon="APPROVER"==recepientInfo.RT?"PI_file_apprvl cirIcon":"SIGNER"==recepientInfo.RT?"PI_sign cirIcon":"INPERSON"==recepientInfo.RT?"PI_sign cirIcon":"PI_eye cirIcon",content+=`<div class="d-flexM"><i class="${recpIcon}" data-toggle="tooltip" title=${recepientInfo.RT} data-placement="bottom"></i></div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrpfl">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrdtls">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="w80"><b>${ZPI18N.getString("zp.status")}</b> </span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<em>`,void 0!=recepientInfo.RS&&(void 0!=recepientInfo.RH&&null!=recepientInfo.RH&&1==recepientInfo.RH?content+=`${ZPI18N.getString("zp.esign.signedinperson")}`:content+=`${recepientInfo.RS}`),content+=`</em>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="d-flexM">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="PI_abtm"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div id="zpl_esignOpn" class="DNI">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_crdcnt d-flex j-cnt-btwen">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrpfl w250">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrdtls">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span><b>${ZPI18N.getString("zp.type")}</b> </span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<em>${recepientInfo.RT}</em>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrpfl">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrdtls">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span><b>${ZPI18N.getString("zp.reciepentorder")}</b> </span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<em>${recepientInfo.RO}</em>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrpfl">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrdtls">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span><b>${ZPI18N.getString("zp.esign.reciepentdelivered")}</b> </span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<em>${recepientInfo.RDD}</em>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>`,flag=1;break}if(1==flag)break}content+=`</div>\n\t\t\t\t\t\t\t<div class="zpl_secn">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<h4>${ZPI18N.getString("zp.attachments")}</h4>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="zpl_crdcnt>\n\t\t\t\t\t\t\t\t\t<div class="zpl_secn">\n\t\t\t\t\t\t\t\t\t\t<div class="zpl_atchd">`;var attachmentDtls=documentInfo.AINFO;$.each(attachmentDtls,function(pkId,attachmentsDtls){var encodeFileName=encodeURIComponent(attachmentsDtls.fileName),encodeFilePath=encodeURIComponent(attachmentsDtls.fP),fileEObj="",fileExtn=(fileEObj=""==attachmentsDtls.fP?encodeFileName:encodeFilePath).substring(fileEObj.lastIndexOf(".")+1,fileEObj.length).toLowerCase(),isImage=(Zsign.Esign.fileIcons(fileExtn),!1);-1!=["jpg","jpeg","gif","png","gif"].indexOf(fileExtn)&&(isImage=!0);var fileIconClass=Zsign.Esign.getFileIcon(fileExtn);content+='<div>\n\t\t\t\t\t \t<div class="zpl_atchimg" onclick=Zsign.constructDataForPreview('+isImage+',"'+encodeFilePath+'","'+encodeURIComponent(documentInfo.DINFO.owner)+'","'+encodeFileName+'","'+documentInfo.RINFO.RN+'","'+documentId.recordId+'","'+documentInfo.DINFO.sentDate+'","'+pkId+'","view")>\n\t\t\t\t\t\t\t<i class=\''+fileIconClass+'\'></i>\n\t\t\t\t\t \t</div>\n\t\t\t\t\t \t<div class="zpl_atchdtl" onclick=Zsign.constructDataForPreview('+isImage+',"'+encodeFilePath+'","'+encodeURIComponent(documentInfo.DINFO.owner)+'","'+encodeFileName+'","'+documentInfo.RINFO.RN+'","'+documentId.recordId+'","'+documentInfo.DINFO.sentDate+'","'+pkId+'","view")>\n\t\t\t\t\t\t\t<h4 data-toggle="tooltip" title="'+attachmentsDtls.fileName+`" data-placement="bottom" id="fileName">${attachmentsDtls.fileName}</h4>\n\t\t\t\t\t\t \t<p><span>${attachmentsDtls.ED}</span></p>\n\t\t\t\t\t \t</div>\n\t\t\t\t\t \t<div class="zpl_atchicn">\n\t\t\t\t\t\t\t<i class="PI_downld" data-title-position="bottom" title="`+ZPI18N.getString("zp.Download")+`" onclick=Adobesign.downloadAttachement(this,"${pkId}","download","${encodeFileName}","${encodeFilePath}");></i>\n\t\t\t\t\t \t</div>\n\t\t\t\t \t</div>`}),content+="</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>";var timeline=documentInfo.EINFO;timeline[0].ED.split(" ")[0].split("-")[2];content+=`<div class="zpl_secn"><div class="zpl_crd">  \n\t\t\t\t\t\t\t\t<div class="zpl_crdhdr">\n\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t<h4>${ZPI18N.getString("zp.activity")}</h4>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="zpl_crdcnt">\n\t\t\t\t\t\t\t\t\t<div class="zpl_tmln zpl_adhstry wd100_per zpl_esigntmln">`;for(i=0;i<timeline.length;i++){timeline[i].ED.split("-")[0],timeline[i].ED.split("-")[1],timeline[i].ED.split("-")[2];var time=timeline[i].ED.split(" ")[1],activityTitle=timeline[i].N,activityDesc=timeline[i].EDESC;content+=`<div class="zpl_tmlnrow">\n\t\t\t\t\t\t\t\t\t<div class="zpl_tmlnrgt">\n\t\t\t\t\t\t\t\t\t\t<div class="zpl_crd">\n\t\t\t\t\t\t\t\t\t\t\t<div class="">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrpfl">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_usrdtls">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<em>${activityTitle}</em><span><b>${activityDesc}</b> </span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_edtdst">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<em>${timeline[i].ED} </em>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3c!--em>Edited : ${time} </em--\x3e\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>  \n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>`}content+="</div></div></div></div>"}else content=`${ZPI18N.getString("zp.lookup.norecfound")}`;sliderParams.id="esign_detail",sliderParams.cardId="esign_detail_card";var containerId=$("#modal_Container");sliderParams.callback=function(){containerId.find("#"+sliderParams.cardId).html(content)},sliderModalObj=new sliderModal(ZPI18N.getString("zp.documentdtls"),sliderParams),sliderModalObj.setCloseCallback(function(){ZPeopleComponents.isComponent("#signOptListDrop")&&ZPeopleComponents.dropdownlist("#signOptListDrop").destroy(),Zsign.closeExpiryPop(),Zsign.Esign.getDocumentsListPage("cancel"),sliderModalObj.remove(),isZSConfig?(Zsign.documentId="",Zsign.recordId=""):isAdobeConfig?(Adobesign.documentId="",Adobesign.recordId=""):isDocuConfig&&(Docusign.documentId="",Docusign.recordId="")});var headerContent="<div><h4>"+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4> </div> <div class="zpl_mhderrgt"><div id="signOptList" onclick=Zsign.showOptDropdown() class="" data-title-position="bottom" title="'+ZPI18N.getString("zp.files.operations.moreactions")+'" aria-expanded="false"><i type="button" data-menu-id="ddmore" class="zpl_ibg zpl_drpdwn-js PI_more"></i></div><div id="signOptListDrop"></div></div><a id="sliderCls" class="_cls PI_cls"></a>',footerContent='<button id="sliderCancel" type="button" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.close")+"</button>";sliderModalObj.setContainerAsBody(!0),sliderModalObj.construct(headerContent,footerContent),0!==ownerInfo.message.length&&"-"!==ownerInfo.message||($("#doc_message").addClass("DN"),$("#message_field").addClass("DN")),0!==ownerInfo.lastDate.length&&"-"!==ownerInfo.lastDate||$("#doc_lastdate").addClass("DN"),void 0==isZohoReadView&&Zsign.getReadView(),$("#signOptList").addClass("DN");var paramObj={agrId:documentId};void 0!=params.recordId&&""!=params.recordId&&(paramObj.recList=params.recordId),void 0!=params.fileId&&""!=params.fileId&&(paramObj.fileId=params.fileId),Zsign.setDropDownOptions(expired,sent,paramObj)},setDropDownOptions:function(expired,sent,documentIdObj,recalled){void 0==expired&&void 0==sent&&void 0==recalled&&(expired=!1,sent=!0),void 0==recalled&&(recalled=!1),ZPeopleComponents.isComponent("#signOptListDrop")&&ZPeopleComponents.dropdownlist("#signOptListDrop").destroy();var extraOptions=[],executeMethod="";if(expired||sent){var agrId=documentIdObj.hasOwnProperty("agrId")?documentIdObj.agrId:documentIdObj.recordIdList,fileId=documentIdObj.hasOwnProperty("fileId")?documentIdObj.fileId:null,recordId=documentIdObj.recList;void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),!isZohoReadView&&isZSConfig?(Zsign.documentId=agrId,Zsign.recordId=recordId,Zsign.companyFileId=fileId,$("#signOptList").removeClass("DN"),expired?recalled||(extraOptions[0]=ZPI18N.getString("zp.extenddeadline")):(extraOptions[0]=ZPI18N.getString("zp.extenddeadline"),extraOptions[1]=ZPI18N.getString("zp.sendreminder"),extraOptions[2]=ZPI18N.getString("zp.recalldocument")),executeMethod=Zsign.executeActions):!isAdobeReadView&&isAdobeConfig?(Adobesign.documentId=agrId,Adobesign.recordId=recordId,Adobesign.companyFileId=fileId,expired||(extraOptions[0]=ZPI18N.getString("zp.esign.sendreminder"),extraOptions[1]=ZPI18N.getString("zp.esign.recalldocument")),$("#signOptList").removeClass("DN"),executeMethod=Adobesign.executeAdobeSignActions):!isDocuReadView&&isDocuConfig?(void 0!=agrId.envId?Docusign.documentId=agrId.envId:Docusign.documentId=agrId,Docusign.companyFileId=fileId,Docusign.recordId=recordId,extraOptions[0]=ZPI18N.getString("zp.canceldocument"),$("#signOptList").removeClass("DN"),executeMethod=Docusign.executeDocusignActions):$("#signOptList").addClass("DN"),ZPeopleComponents.dropdownlist("#signOptListDrop",{filterByCSSSelector:!1,items:Zsign.constructZsignOptionsJSON(extraOptions),selectionLimit:1,dataMapping:{text:"label",name:"label",value:"id",id:"id"},contentType:"text",hideCheckbox:!0,position:"bottom-right",focusItemOnItemMouseover:!0,itemclick:executeMethod,width:"170px"})}else $("#signOptList").addClass("DN")},executeActions:function(obj){"exportMode"==obj.detail.id?Zsign.Files.exportFiles("documents"):0==obj.detail.itemData.id?Zsign.showExpiryPop(!1):1==obj.detail.itemData.id?Zsign.showPopup(obj,Zsign.sendReminder,ZPI18N.getString("zp.esign.remindrecptitle"),ZPI18N.getString("zp.esign.remindrecpdesc"),ZPI18N.getString("zp.confirm"),3):2==obj.detail.itemData.id?(obj.bulk=!1,Zsign.showRecalPop(obj)):"exportModefmv"==obj.detail.id&&Zsign.Forms.exportFiles("esigndocuments")},showRecalPop:function(bulk){if(bulk&&1==bulk)var obj={bulk:!0};Zsign.showPopup(obj,Zsign.cancelDocument,ZPI18N.getString("zp.esign.recalldoctitle"),ZPI18N.getString("zp.esign.recalldocdesc"),ZPI18N.getString("zp.recall"),MP.Popup.Type.DELETE,Zsign.recallModal(),!1)},showPopup:function(thisObj,callbackFn,headingTxt,messageTxt,buttonMessageTxt,type,centerHtml,removeAfterYes){let parameter={thisObj:thisObj=void 0!=thisObj?thisObj:""};var alertMsgObj=new InfoAlertMessage;1==type?alertMsgObj=new SuccessAlertMessage:2==type?alertMsgObj=new DeleteAlertMessage:3==type&&(alertMsgObj=new InfoAlertMessage),alertMsgObj.title=headingTxt,alertMsgObj.despcription=messageTxt,alertMsgObj.setCallback(callbackFn),alertMsgObj.removeAfterYes=void 0==removeAfterYes||removeAfterYes,null!=centerHtml&&alertMsgObj.setCenterHtml(centerHtml),alertMsgObj.yesButtonText=buttonMessageTxt,alertMsgObj.cancelButtonText=ZPI18N.getString("zp.cancel"),alertMsgObj.parameter=parameter,alertMsgObj.show()},constructZsignOptionsJSON:function(dataObj,htmlObj,isSelect){var option=[];return ZPSetupCommon.isEmpty(dataObj)||Object.keys(dataObj).length>0&&$.each(dataObj,function(value,objJSON){option.push({label:objJSON,value:objJSON,id:value})}),option},deleteAgreementConfirm:function(callbackFn,thisObj,position,mode){settingsPage.container;"2"==mode&&$("#esigntemplatesParent");var callbackSetFn=callbackFn;void 0==callbackFn&&Zsign.deleteAgreementRecord;let parameter={thisObj:thisObj=void 0!=thisObj?thisObj:"",position:position=void 0!=position?position:"first"};var hdr="",desc="";"1"==mode?(hdr=ZPI18N.getString("zp.esign.deletedochdr"),desc=ZPI18N.getString("zp.esign.deletedocdesc")):"2"==mode&&(hdr=ZPI18N.getString("zp.esign.deletetemphdr"),desc=ZPI18N.getString("zp.esign.deletetempdesc"));var deleteAlertMessage=new DeleteAlertMessage;deleteAlertMessage.title=hdr,deleteAlertMessage.despcription=desc,deleteAlertMessage.yesButtonText=ZPI18N.getString("zp.delete"),deleteAlertMessage.cancelButtonText=ZPI18N.getString("zp.cancel"),deleteAlertMessage.parameter=parameter,deleteAlertMessage.callback=callbackSetFn,deleteAlertMessage.show()},deleteZSignTemp:function(obj){var pageId=$("#esigntemplatesParent"),parameter=obj.parameter,thisObj=parameter.thisObj,recordIdArr="",moduleType="";if("first"==parameter.position)for(var deleteArray=pageId.find("#signtemplate_list").find('input[type="checkbox"]:checked'),deleteCount=deleteArray.length,i=0;i<deleteCount;i++)i>=1&&(recordIdArr+=","),recordIdArr+=pageId.find(deleteArray[i]).parent().parent().parent().attr("tempid");else moduleType="2",recordIdArr=$(thisObj).closest("tr").attr("tempid");ZPeople.Request.send("/zpzsign/deleteZSignTemplate",{conreqcsr:csrfToken,recordIdList:recordIdArr,recordId:"",moduleType:moduleType,formId:""},Zsign.deleteCallBack,thisObj)},deleteAgreementRecord:function(obj){var thisObj=obj.parameter.thisObj,recordIdArr="",moduleType="",formId="",recordId="";if("first"==obj.parameter.position)for(var deleteArray=settingsPage.container.find("#documents_list").find('input[type="checkbox"]:checked'),deleteCount=deleteArray.length,i=0;i<deleteCount;i++)i>=1&&(recordIdArr+=","),recordIdArr+=settingsPage.container.find(deleteArray[i]).parent().parent().parent().attr("documentid");else(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId||Layout.Page.hash.indexOf("-formId:")>-1)&&(void 0===(formId=Layout.Page.urlparam.formId)&&(formId=ZP5Form.getFormClassObj().getParams().formId),formId=formId,recordId=ZP5Form.getFormClassObj().getParams().recordId),moduleType="2",recordIdArr=$(thisObj).closest("tr").attr("documentId");ZPeople.Request.send("/zpzsign/deleteDocument",{conreqcsr:csrfToken,recordIdList:recordIdArr,recordId:recordId,moduleType:moduleType,formId:formId},Zsign.deleteCallBack,thisObj)},deleteCallBack:function(data,params,thisObj){var pageId=settingsPage.container,isFromSignTemplate=!1;if("deleteZSignTemplate"==params.action&&(pageId=$("#esigntemplatesParent"),isFromSignTemplate=!0),data[1].isDeleted){if(void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),$(pageId.find("#documents_list").find('input[type="checkbox"]:checked').length)[0]>0&&!isFromSignTemplate)$(pageId.find("#documents_list").find('input[type="checkbox"]:checked')).closest("tr").remove(),settingsPage.container.find("#doc_multiselDel").addClass("DNI"),settingsPage.container.find("#doc_HeaderBar").show();else if(2!==pageId.find("#recordContainer").find("#documents_table").find("tr").length||isFromSignTemplate)$(pageId.find("#signtemplate_list").find('input[type="checkbox"]:checked').length)[0]>0&&isFromSignTemplate?($(pageId.find("#signtemplate_list").find('input[type="checkbox"]:checked')).closest("tr").remove(),pageId.find("#template_checkallbox").parent().find("input[type=checkbox]:checked").prop("checked",!1),pageId.find("#doc_multiselDel").addClass("DNI"),pageId.find("#doc_HeaderBar").show()):$(pageId.find("#hrdoc_list").find('input[type="checkbox"]:checked').length)[0]>0&&!isFromSignTemplate?($(pageId.find("#hrdoc_list").find('input[type="checkbox"]:checked')).closest("tr").remove(),settingsPage.container.find("#doc_multiselDel").addClass("DNI"),settingsPage.container.find("#doc_HeaderBar").show()):$(thisObj).closest("tr").remove();else{var esignDocumentmethod="";isAdobeConfig?esignDocumentmethod='ZPView.sendForSignDocs("adobe")':isDocuConfig?esignDocumentmethod='ZPView.sendForSignDocs("")':isZSConfig&&(esignDocumentmethod='ZPView.sendForSignDocs("zsign","true")');var headerToggle=$(thisObj).parent().parent().parent().parent().parent().parent().find("a")[0];$(headerToggle).after('<div id ="bigPlusforSign" class="PI_plus togg-plus"onclick='+esignDocumentmethod+"></div>"),settingsPage.container.find("#anchor_single_doc_list").addClass("collapsed"),$(thisObj).closest("#documents_list_form").remove(),0==params.formId.length||isFromSignTemplate||($(thisObj).closest("tr").remove(),emptyHtml='<div class="zpl_frmclm zpl_frmclmview"><div class="zpl_Emptydata mt10"><div><p>'+ZPI18N.getString("zp.lookup.norecfound")+"</p></div></div></div>",pageId.find("#recordContainer").append(emptyHtml))}if(0!==pageId.find("#documents_list").find("tr").length||isFromSignTemplate||0!==params.formId.length)0===pageId.find("#signtemplate_list").find("tr").length&&isFromSignTemplate?(Zsign.newuinorecordsSigntemp(),pageId.find("#signtemplate_list").addClass("DN"),pageId.find("#signtemplate_table").addClass("DN")):0!==pageId.find("#hrdoc_list").find("tr").length||"files_hrdocuments_listview"!=Layout.Page.urlmode||isFromSignTemplate||(settingsPage.container.find("#temp_norecords .ctable").remove(),Zsign.newuinohrDocrecords(),pageId.find("#hrdoc_list").addClass("DN"),pageId.find("#hrdoc_listingpage").addClass("DN"),pageId.find("#hrdoc_listingpage").removeClass("expand"));else{settingsPage.container.find("#document_norecords .ctable").remove();var noButton=!1;Zsign.isReadView&&Zsign.hasZohosignRecord&&(noButton=!1),Zsign.newuinorecords(noButton),Zsign.noRecords=!0,pageId.find("#documents_list").addClass("DN"),pageId.find("#documents_listingpage").addClass("DN"),pageId.find("#documents_listingpage").removeClass("expand"),settingsPage.container.find("#create_agr").addClass("DN"),settingsPage.container.find("#zsignTempListIcon").addClass("DNI")}"deleteZSignTemplate"==params.action?ZPeople.Message.success(ZPI18N.getString("zp.zs.signtempdeletedsuccessfully")):ZPeople.Message.success(ZPI18N.getString("zp.zs.documentdeletedsuccessfully"))}else"deleteZSignTemplate"==params.action?ZPeople.Message.failure(ZPI18N.getString("zp.zs.signtempnotdeleted")):ZPeople.Message.failure(ZPI18N.getString("zp.zs.documentnotdeleted"))},noFilesFoundConst:function(imageName,norecMess,id,buttonValue,methodName){var pageDiv=$("[id="+id+"]"),newImageName=void 0!=imageName&&""!=imageName?imageName:"zp_nd_nodata",newNorecMessage=void 0!=norecMess&&""!=norecMess?norecMess:ZPI18N.getString("zp.lookup.norecfound");let emptyPage=new EmptyPages(newImageName,newNorecMessage,"",pageDiv);void 0!=buttonValue&&""!=buttonValue&&emptyPage.setButton(buttonValue,methodName),emptyPage.show()},newuinorecords:function(noButton){var pageId=settingsPage.container;pageId.find("div#documents_list").addClass("DN"),pageId.find("#document_norecords").removeClass("DNI"),pageId.find("#document_norecords").empty(),pageId.find("#documents_table").addClass("DN");var currScrollContObj=pageId.find("#document_norecords");void 0!=noButton&&noButton?currScrollContObj.append(Zsign.noFilesFoundConst("zp_nd_esign","","document_norecords")):currScrollContObj.append(Zsign.noFilesFoundConst("zp_nd_esign","","document_norecords",ZPI18N.getString("zp.esign.requestsignature"),Zsign.constructSendForSign))},newuinorecordswf:function(noButton){var pageId=settingsPage.container;pageId.find("div#wfdocuments_table").addClass("DN"),pageId.find("#wfdocument_norecords").removeClass("DNI"),pageId.find("#wfdocument_norecords").empty(),pageId.find("#wfdocuments_table").addClass("DN"),pageId.find("#wfdocument_norecords").append(Zsign.noFilesFoundConst("","","wfdocument_norecords","","",""))},newuinorecordsSigntemp:function(noButton){var pageId=$("#esigntemplatesParent");pageId.find("tbody#signtemplate_list").addClass("DN"),pageId.find("#temp_norecords").removeClass("DN"),pageId.find("#temp_norecords").empty(),pageId.find("#signtemplate_table").addClass("DN"),pageId.find("#temp_norecords").append(Zsign.noFilesFoundConst("","","temp_norecords","",""))},newuinohrDocrecords:function(value){var pageId=settingsPage.container;pageId.find("div#hrdoc_list").addClass("DN"),pageId.find("div#hrdoc_listingpage").addClass("DN"),pageId.find("#hrdoc_listingpage").removeClass("expand"),pageId.find("#hrdoc_norecords").removeClass("DN"),pageId.find("#hrdoc_norecords").addClass("Scrcont"),pageId.find("#hrdoc_norecords").append(Zsign.noFilesFoundConst("","","hrdoc_norecords","",""))},validation:function(isFromForm){ZPA_Esign.resetAllErrorborder();var searchElem=$("#esign_card");isFromForm?searchElem=$("#esignforms_card"):"1"==FilesUtil.Page.getTabGroup()||Zsign.isfromZSignTemplates()?searchElem=$("#esignorg_card"):"0"==FilesUtil.Page.getTabGroup()&&(searchElem=$("#cardesignfiles"));var recipientsElms=searchElem.find("*[id=recpList]"),document_name_elm=searchElem.find("#document_name").val(),document_message_len=searchElem.find("#document_message").val(),redSuccess=(searchElem.find("input[name='deadline']").val(),searchElem.find("select#templates").val(),searchElem.find("input#redSuccess").val()),redCompleted=searchElem.find("input#redCompleted").val(),redDeclined=searchElem.find("input#redDeclined").val(),redLater=searchElem.find("input#redLater").val();$(".ERR").remove();var err=!1,maxSize=1e6*maxFileSize.split("MB")[0],maxSize_new=maxFileSizeBytes_filesModule;Zsign.checkZSFeature(),Zsign.getZSPaymentURL();var urlregex=new RegExp("^(ht|f)tp(s?)://[-.w]*(/?)([a-zA-Z0-9-.?,:'/\\+=&amp;%$#_@]*)?$");if(void 0!=redSuccess&&0!=redSuccess.length&&(Zsign.zsFeatureList.redirection?urlregex.test(redSuccess)||(errMsg=ZPI18N.getString("zp.redirectionerr"),err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton")>-1?(searchElem.find("#redSuccess").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),searchElem.find("#redSuccess").addClass("ztextbox__error")):(searchElem.find("#redSuccess").addClass("ztextbox__error"),searchElem.find("#redSuccess").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"))):(errMsg=ZPI18N.getString("zp.zsign.redirectionerr",new Array(Zsign.zsignPricingUrl)),err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),searchElem.find("#redSuccess").addClass("ztextbox__error"),searchElem.find("#redSuccess").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"))),void 0!=redCompleted&&0!=redCompleted.length&&(Zsign.zsFeatureList.redirection?urlregex.test(redCompleted)||(err=!0,errMsg=ZPI18N.getString("zp.redirectionerr"),Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),searchElem.find("#redCompleted").addClass("ztextbox__error"),searchElem.find("#redCompleted").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>")):(errMsg=ZPI18N.getString("zp.zsign.redirectionerr",new Array(Zsign.zsignPricingUrl)),err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),searchElem.find("#redCompleted").addClass("ztextbox__error"),searchElem.find("#redCompleted").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"))),void 0!=redDeclined&&0!=redDeclined.length&&(Zsign.zsFeatureList.redirection?urlregex.test(redDeclined)||(err=!0,errMsg=ZPI18N.getString("zp.redirectionerr"),Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),searchElem.find("#redDeclined").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),searchElem.find("#redDeclined").addClass("ztextbox__error")):(errMsg=ZPI18N.getString("zp.zsign.redirectionerr",new Array(Zsign.zsignPricingUrl)),err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton")>-1?(searchElem.find("#redDeclined").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),searchElem.find("#redDeclined").addClass("ztextbox__error")):(searchElem.find("#redDeclined").addClass("ztextbox__error"),searchElem.find("#redDeclined").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>")))),void 0!=redLater&&0!=redLater.length&&(Zsign.zsFeatureList.redirection?urlregex.test(redLater)||(err=!0,errMsg=ZPI18N.getString("zp.redirectionerr"),Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton")>-1?(searchElem.find("#redLater").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),searchElem.find("#redLater").addClass("ztextbox__error")):(searchElem.find("#redLater").addClass("ztextbox__error"),searchElem.find("#redLater").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"))):(errMsg=ZPI18N.getString("zp.zsign.redirectionerr",new Array(Zsign.zsignPricingUrl)),err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton")>-1?(searchElem.find("#redLater").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),searchElem.find("#redLater").addClass("ztextbox__error")):(searchElem.find("#redLater").addClass("ztextbox__error"),searchElem.find("#redLater").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>")))),isFromForm){if(noOfAtth=$("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length,noOfAtth>0?!0:noOfAtth=$("#attachments .zpl_atchd").find("[name=fileOutDiv]").length,0==noOfAtth){var zsignTempSel=searchElem.find("#input_esignTempUpload").attr("checked");searchElem.find("#input_esignDefUpload").attr("checked")?$("#uploadSectionBody #drop_area").addClass("fldrp_err"):zsignTempSel&&($("#uploadSectionBody_zsigntemp #drop_area").addClass("fldrp_err"),Zsign.checkZSFeature(),Zsign.zsFeatureList.templates||(ZPA_Esign.toggleUploadSection(1),$("#uploadSectionBody #drop_area").addClass("fldrp_err"))),searchElem.find("#uploadSection").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.esign.uploadonedoc")+"</span>"),err=!0}}if(!Zsign.isFromFormView&&-1!==Layout.Page.hash.indexOf("#operations/files/esigndocuments")&&!Zsign.isfromZSignTemplates()){var agmntFile=Zsign.fileUploadObj;if(void 0!=agmntFile.name||"cloudUpload"===ZPA_Esign.uploadMode){if("cloudUpload"===ZPA_Esign.uploadMode)(ZPSetupCommon.isEmpty(CloudPicker.fileObj)||void 0==CloudPicker.fileObj.length)&&(err=!0);else if("1"==FilesUtil.Page.getTabGroup()||Zsign.isfromZSignTemplates()||"0"==FilesUtil.Page.getTabGroup()?agmntFile.size>maxSize_new?(err=!0,searchElem.find("#uploadfile").closest("div#err_div").after('<span class="ERR" id="errorMsg">'+ZPI18N.getString("zp.customizedfilesizelimit",new Array(maxFileSize_filesModule))+"</span>")):searchElem.find("#uploadfile").closest("div#err_div").next("span#errorMsg").remove():agmntFile.size>maxSize?(err=!0,searchElem.find("#uploadfile").closest("div#err_div").after('<span class="ERR" id="errorMsg">'+ZPI18N.getString("zp.customizedfilesizelimit",new Array(maxFileSize))+"</span>")):searchElem.find("#uploadfile").closest("div#err_div").next("span#errorMsg").remove(),!err){var fileName=agmntFile.name,fileExtn=fileName.substring(fileName.lastIndexOf(".")+1,fileName.length);-1===Zsign.zsignEtxns.indexOf(fileExtn.toLowerCase())&&(err=!0,searchElem.find("#attachments").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.zs.choosepdffile")+"</span>"))}}else err=!0,searchElem.find("#uploadSection").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.choosedoc")+"</span>")}if(ZPSetupCommon.isEmpty(document_name_elm)){err=!0;var errMsg=ZPI18N.getString("zp.zs.documentnameempty");Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton")>-1?searchElem.find("#document_name").closest("#docNameInputTag").next("div[name=errorMsg]").append('<span class="ERR" id="errorMsg">'+errMsg+"</span>"):(searchElem.find("#document_name").addClass("ztextbox__error"),searchElem.find("#document_name").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"))}if(ZPSetupCommon.isEmpty(document_name_elm)||(-1==document_name_elm.indexOf("<")&&-1==document_name_elm.indexOf(">")||(searchElem.find("#document_name").addClass("ztextbox__error"),searchElem.find("#document_name").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.esign.docname")," > < "))+"</span>"),err=!0),document_name_elm.length>100&&(err=!0,Layout.Page.hash.indexOf("workflow/actions/esign")>-1||Layout.Page.hash.indexOf("custombutton"),searchElem.find("#document_name").addClass("ztextbox__error"),searchElem.find("#document_name").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.lengthvalidation",new Array(ZPI18N.getString("zp.esign.docname"),100))+"</span>"))),!ZPSetupCommon.isEmpty(document_message_len)&&document_message_len.length>=5e3&&(err=!0,(!Layout.Page.hash.indexOf("workflow/actions/esign")>-1&&!Layout.Page.hash.indexOf("automation/workflow/list")>-1||Layout.Page.hash.indexOf("custombutton")>-1)&&(searchElem.find("#document_message").addClass("ztextbox__error"),searchElem.find("#document_message").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.lengthvalidation",new Array(ZPI18N.getString("zp.message"),5e3))+"</span>"))),!settingsPage.isEnabled&&settingsUrlProps.url.indexOf("settings/")>-1&&!Zsign.isWorkflow&&"files_companyfile_listview"!=Layout.Page.urlmode&&"files_companyfile_view"!=Layout.Page.urlmode){var recipientsMailIds=recipientsElms.val();if(ZPSetupCommon.isEmpty(recipientsMailIds)||"select"===recipientsMailIds){err=!0;errMsg=recipientsElms.is("input")?ZPI18N.getString("zp.entervalidemailaddress"):ZPI18N.getString("zp.selectemailidfield");searchElem.find("#recpList").after('<span class="ERR" id="errorMsg">'+errMsg+"</span>")}else recipientsElms.is("input")&&(err=Adobesign.validateMailIds(recipientsMailIds.split(","),searchElem.find("#recpList"),ZPI18N.getString("zp.entervalidemailaddress")))}if(searchElem.find("#agrselect_newCatName").is(":visible")){var newCatName=searchElem.find("#agrselect_newCatName").val().trim();""==newCatName?(searchElem.find("#agrselect_newCatName").addClass("ztextbox__error"),searchElem.find("#agrselect_newCatName").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.enterCategory")+"</span>"),err=!0):-1!=newCatName.indexOf("<")||-1!=newCatName.indexOf(">")||-1!=newCatName.indexOf("&lt;")||-1!=newCatName.indexOf("&gt;")?(searchElem.find("#agrselect_newCatName").addClass("ztextbox__error"),searchElem.find("#agrselect_newCatName").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.folder"))," > < ")+"</span>"),err=!0):null!=newCatName&&void 0!=newCatName&&"/"===newCatName&&(searchElem.find("#agrselect_newCatName").addClass("ztextbox__error"),searchElem.find("#agrselect_newCatName").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.lms.base.foldername"))," / ")+"</span>"),err=!0)}else{var catId=ZPeopleComponents.select(searchElem.find("#agrselect_Cat")).getValue();""!=catId&&"-1"!=catId||(ZPeopleComponents.select(searchElem.find("#agrselect_Cat")).getElement().addClass("ztextbox__error"),searchElem.find("#agrselect_Cat").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.foldernameempty")+"</span>"),err=!0)}if(0!=$("#deadline").length){var deadLine=ZPeopleComponents.datefield(document.getElementById("deadline")).getValue().dateString;if(!ZPSetupCommon.isEmpty(deadLine)&&(-1==Layout.Page.hash.indexOf("workflow")||(Layout.Page.hash.indexOf("workflow")>-1||Layout.Page.hash.indexOf("custombutton")>-1)&&"1"==searchElem.find("input[id='expdateid']:checked").val()&&showExpiryOptions)){var lastDate=moment(deadLine,dateFmt.toUpperCase()).format("DD-MMM-YYYY").split("-"),month=Calendar.months.indexOf(lastDate[1])+1,lDate=lastDate[2]+"/"+month+"/"+lastDate[0];if("NaN"===Date.parse(lDate).toString()||moment(lDate).diff(moment().format("YYYY/MM/DD"),"days")<=0){err=!0;var errMessage="";errMessage="NaN"===Date.parse(lDate).toString()?ZPI18N.getString("zp.holiday.dateerror"):ZPI18N.getString("zp.validuntilerr"),ZPeopleComponents.datefield(searchElem.find("#deadline")).getElement().addClass("ztextbox__error"),searchElem.find("input[name='deadline']").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMessage+"</span>"),settingsPage.container.find("#setting_lnk").attr("val","1"),settingsPage.container.find("#moreSettings").removeClass("DN"),settingsPage.container.find("#moreSettings").removeAttr("style"),settingsPage.container.find("#setting_lnk").text(ZPI18N.getString("zp.hide"))}else searchElem.find("input[name='deadline']").parent().find("span#errorMsg").remove();var warnRecp=ZPSetupCommon.isEmpty(warnRecp)?"0":searchElem.find("input[name='freq_warn']").val()}}if(Layout.Page.hash.indexOf("workflow")>-1||Layout.Page.hash.indexOf("custombutton")>-1){var recpList=[],recpType=[];$.each(searchElem.find("[name=recp_row]"),function(index,elm){recpList.indexOf($(elm).find("#recpList").val())>-1?(err=!0,searchElem.find("[name=recp_row]").last().append('<span class="ERR" id="errorMsg">'+ZPI18N.getString("zp.zs.diffrecp")+"</span>")):searchElem.find("[name=recp_row]").last().find("span#errorMsg").remove(),recpType.push($(elm).find("#recp_type").val()),recpList.push($(elm).find("#recpList").val())}),"1"!=recpType[0]&&"3"!=recpType[0]&&(err=!0,searchElem.find("[name=recp_row]").last().append('<span class="ERR" id="errorMsg">'+ZPI18N.getString("zp.zs.firstrecnotview")+"</span>")),err||-1===recpType.indexOf("3")&&(-1===recpType.indexOf("1")?(err=!0,searchElem.find("[name=recp_row]").last().append('<span class="ERR" id="errorMsg">'+ZPI18N.getString("zp.zs.atleastonesigner")+"</span>")):searchElem.find("[name=recp_row]").last().find("span#errorMsg").remove())}if(Zsign.isFromFormView||Layout.Page.hash.indexOf("workflow")>-1||Layout.Page.hash.indexOf("custombutton")>-1){var dateField=searchElem.find("#dateFieldOpt").val(),noOfDays=searchElem.find("#deadlinedays").val();ZPSetupCommon.isEmpty(noOfDays)||(noOfDays<0||noOfDays>99?(err=!0,searchElem.find("#deadlinegrp").addClass("ztextbox__error"),searchElem.find("#deadlinegrp").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.zohosignexplimit")+"</span>")):searchElem.find("#deadlinegrp").removeClass("ztextbox__error"));var showExpiryOptions=searchElem.find("[name=showExpiryOptions]").is(":checked");null==dateField&&"on"==$("input[id='datelookupid']:checked").val()&&showExpiryOptions&&(err=!0,searchElem.find("#deadlinegrp").addClass("ztextbox__error"),searchElem.find("#deadlinegrp").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.nodatelookup")+"</span>")),"1"==searchElem.find("input[id='expdateid']:checked").val()&&showExpiryOptions&&ZPSetupCommon.isEmpty(deadLine)&&(err=!0,searchElem.find("#deadlinegrp").addClass("ztextbox__error"),searchElem.find("#deadlinegrp").parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.selectexpdate")+"</span>"))}for(var mergeFieldListLen=$("label[name=mergeFieldsList]").length,i=0;i<mergeFieldListLen;i++){var prefill_id=$($("label[name=mergeFieldsList]")[i]).attr("fid"),prefill_val=$("#"+prefill_id).val(),mandtry=$($("label[name=mergeFieldsList]")[i]).data("mandtry");if(null==prefill_val&&mandtry){if(0==ZPeopleComponents.select($("#"+prefill_id)).getOptions().length){var dt=$("#"+prefill_id).attr("datatype");$("#"+prefill_id).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.addffandchoose",[dt,dt])+"</span>")}else $("#"+prefill_id).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.ffselerr")+"</span>");ZPeopleComponents.select(searchElem.find("#"+prefill_id)).getElement().addClass("ztextbox__error"),err=!0}}if(searchElem.find("input#reminder_check").is(":checked")||Layout.Page.hash.indexOf("custombutton")>-1){var freqReminder=searchElem.find("input#reminder_freqdayscnt").val();0!=(freqReminder=ZPSetupCommon.isEmpty(freqReminder)?"0":freqReminder)&&(freqReminder<0||freqReminder>98)&&(searchElem.find("#reminder_setting").append('<span class="ERR" id="errorMsg">'+ZPI18N.getString("zp.zohosignreminderlimit")+"</span>"),err=!0)}return err},validateMailIds:function(mailIds,obj,msg){mailIds.length<=50?$.each(mailIds,function(ind,mailId){if(!ZPUtil.Validation.isEmail(mailId))return!0,obj.after('<span class="ERR" id="errorMsg">'+msg+"</span>"),!1;obj.next("span#errorMsg").remove()}):(!0,$("div#createAgreementModal").find("#recpList").after('<span class="ERR" id="errorMsg">'+ZPI18N.getString("zp.maildidslengthunlimit")+"</span>"))},setDaysForReminder:function(mode){var checkBox,pageId="",isFromAutomation=!1;(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?pageId=$("#esignforms_card"):-1!=Layout.Page.hash.indexOf("#operations/files/esigndocuments")?pageId=$("#esign_card"):"0"==FilesUtil.Page.getTabGroup()?pageId=$("#cardesignfiles"):(isFromAutomation=!0,pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId)),ZPSetupCommon.isEmpty(mode))?((checkBox=pageId.find("#reminder_check")).prop("checked",!checkBox.prop("checked")),checkBox.is(":checked")?isFromAutomation?(pageId.find("div#reminder_freq").removeClass("DN"),pageId.find("div#reminder_setting").removeClass("DN"),pageId.find("div#reminder_freq,div#reminder_setting").removeClass("disabled")):(pageId.find("div#reminder_freq").removeClass("disabled"),pageId.find("div#reminder_freq").removeClass("DN"),pageId.find("div#reminder_setting").removeClass("disabled")):isFromAutomation?(pageId.find("div#reminder_freq").addClass("DN"),pageId.find("div#reminder_setting").addClass("DN"),pageId.find("div#reminder_freq,div#reminder_setting").addClass("disabled")):(pageId.find("div#reminder_freq").addClass("disabled"),pageId.find("div#reminder_freq").addClass("DN"),pageId.find("div#reminder_setting").addClass("disabled"))):((checkBox=pageId.find("#expire_check")).prop("checked",!checkBox.prop("checked")),checkBox.is(":checked")?pageId.find("div#expire_setting,div#warning").removeClass("disabled"):pageId.find("div#expire_setting,div#warning").addClass("disabled"))},addAdminPermissions:function(serviceName){var params={action:"updateAdminTokenUsage",conreqcsr:csrfToken,serviceName:serviceName,allowAdminToken:!0};ZPeople.Request.send("/zpzsign/updateAdminTokenUsage",params,Zsign.addAdminPermCallback)},addAdminPermCallback:function(obj){Zsign.allowAdminToken=obj.allowAdminToken},getAllowAdminToken:function(serviceName){if(ZPSetupCommon.isEmpty(Zsign.allowAdminToken)){var params={conreqcsr:csrfToken,serviceName:serviceName};ZPeople.Request.send("/zpzsign/getAllowAdminToken",params,function(data){Zsign.allowAdminToken=data[1][Zsign.ALLOWADMINTOKEN],Zsign.allowAdminToken||$("#recallWithcheck").removeClass("DNI")})}},cancelDocument:function(thisbulk){$("#yesBtn").addClass("disabled"),ZPA_Esign.resetAllErrorborder();var bulk=!1;thisbulk&&1==thisbulk?bulk=!0:void 0!=thisbulk.parameter&&void 0!=thisbulk.parameter.thisObj.bulk&&(bulk=thisbulk.parameter.thisObj.bulk);var moduleType,recList,recordId=Zsign.documentId,formId="",reason=$("textarea#recallReason").val();if(ZPSetupCommon.isEmpty(reason))return $("textarea#recallReason").parent().append('<span id="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.enterreason")+"</span>"),$("textarea#recallReason").addClass("ztextbox__error"),void $("#yesBtn").removeClass("disabled");if(reason.length>250)return ZPeople.Message.warning(ZPI18N.getString("zp.lengthwarning",[ZPI18N.getString("zp.reason"),250])),void $("#yesBtn").removeClass("disabled");var documentIdList="",documentArray=settingsPage.container.find("#documents_list").find('input[type="checkbox"]:checked'),documentCount=documentArray.length;if(documentCount>100)return ZPeople.Message.warning(ZPI18N.getString("zp.cancelexceed",new Array("100"))),void $("#yesBtn").removeClass("disabled");for(var i=0;i<documentCount;i++)i>=1&&(documentIdList+=","),documentIdList+=settingsPage.container.find(documentArray[i]).parent().parent().parent().attr("documentid");var params={conreqcsr:csrfToken};void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(formId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId?ZP5Form.getFormClassObj().getParams().formId:ZP5Form.getCurrFormsOperation().formId,moduleType="2",recList=Zsign.recordId):(moduleType="1",params.fileId=Zsign.companyFileId),bulk?(params.documentIdList=documentIdList,params.bulk=!0):params.recordIdList=recordId,params.moduleType=moduleType,params.formId=formId,params.recList=recList,params.reason=reason,$.ajax({url:"/zpzsign/cancelDocument",type:"POST",data:params,success:function(data){Zsign.cancelCallback(data,params,thisbulk)},failure:function(data){Zsign.failedCallBack(data)}})},cancelCallback:function(data,params,thisbulk){var pageId=settingsPage.container;if("success"===data[1].status){if(Object.keys(data[1].not_recalledList).length>0){var totalCount=Object.keys(data[1].not_recalledList).length,documentNames=[],more="";Object.values(data[1].not_recalledList).length>=5?(Object.values(Object.values(data[1].not_recalledList)).forEach(obj=>{documentNames.length<=5&&documentNames.push(ZSEC.Encoder.encodeForJavaScript(Object.values(obj)))}),Object.values(data[1].not_recalledList).length>5&&(more="+ "+(totalCount-5))):Object.values(Object.values(data[1].not_recalledList)).forEach(obj=>{documentNames.push(ZSEC.Encoder.encodeForJavaScript(Object.values(obj)))}),ZPeople.Message.warning(ZPI18N.getString("zp.cancelpartialfail",new Array(documentNames,more)))}var row="";pageId=settingsPage.container;if(void 0!=data[1].recalledList){if(void 0!=params.documentIdList&&(Object.values(Object.values(data[1].recalledList)).forEach(obj=>{-1!=Layout.Page.hash.indexOf("#operations/files/esigndocuments")&&((row=$("#documents_list").find("tr[documentid='"+Object.keys(obj)+"'] td[name='env_status']")).html("<span class='red'>"+ZPI18N.getString("zp.recalled")+"</span>"),row.closest("tr").attr("isCancelled",!1))}),Zsign.Esign.removeDeleteWhiteBand("documents")),"Sent"==settingsPage.container.find("select#search_status").val()&&Zsign.getESignList("","","search"),void 0!=params.recordIdList&&(row=-1!=Layout.Page.hash.indexOf("files/hrfile")||-1!=Layout.Page.hash.indexOf("selfservice/user/files")?pageId.find("ul[documentId='"+params.recordIdList+"'] li[name='env_status']"):pageId.find("ul[documentid='"+params.recordIdList+"'] li[name='env_status']"),-1!=Layout.Page.hash.indexOf("#operations/files/esigndocuments")&&(row=$("#documents_list").find("tr[documentid='"+params.recordIdList+"'] td[name='env_status']")),row.html("<span class='red'>"+ZPI18N.getString("zp.recalled")+"</span>"),row.closest("tr").attr("isCancelled",!1)),Zsign.zsignActionTriggersliders()){var cancelstatus="<span class='red'>"+ZPI18N.getString("zp.recalled")+"</span>";(row=pageId.find("tr[documentId='"+params.recordIdList+"'] td[name='env_status']")).html(cancelstatus),$("#esign_detail_card").find("#signDocStatus").html(cancelstatus),row.closest("tr").attr("isCancelled",!0)}ZPeople.Message.success(ZPI18N.getString("zp.documentrecalled")),Zsign.setDropDownOptions(!1,!1)}}else void 0!=data[1].message?ZPeople.Message.failure(data[1].message):ZPeople.Message.failure(ZPI18N.getString("zp.docnotrecall"));$("#yesBtn").removeClass("disabled"),thisbulk.remove()},zsignActionTriggersliders:function(){var zsignTriggerloc=!1;return(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1||-1!=settingsUrlProps.url.indexOf("files/esigndocuments")||"0"==FilesUtil.Page.getTabGroup()||"1"==FilesUtil.Page.getTabGroup())&&(zsignTriggerloc=!0),zsignTriggerloc},setCatName:function(dataObj){var pageId=settingsPage.container;$.each(dataObj,function(index,documentDtls){var catId=ZPSetupCommon.isEmpty(documentDtls.catId)?"0":documentDtls.catId,categoryName=pageId.find("select#search_cat").find("option[value='"+catId+"']").text();pageId.find("#documents_list").find("ul[documentid='"+documentDtls.ARID+"'] span#cat_nm").text(categoryName)})},mainPageAct:function(option){!0===option&&ZPACommon.getUrlMode()===NewWorkFlow.MODE?AutomationCommon.showHidePage("[automationPages=esignConfigPage]","slide"):!0===option?AutomationCommon.showHidePage("[automationPages=esignConfigPage]"):AutomationCommon.showHidePage("[automationPages=esignConfigPage]",!0)},close:function(){switch(Zsign.mainPageAct(),settingsPage.container.find("#setting_lnk").attr("val","0"),settingsPage.container.find("#moreSettings").removeAttr("style"),Layout.Page.hash.indexOf("workflow/list")>-1&&(settingsPage.container.find("#form_view").removeAttr("fid"),settingsPage.container.find("#form_view").removeAttr("cid")),settingsPage.container.find("#moreSettings").hasClass("DN")||settingsPage.container.find("#moreSettings").addClass("DN"),settingsPage.container.find("#setting_lnk").text(ZPI18N.getString("zp.showoptions")),settingsPage.container.find("#esignTempList").show(),ZPACommon.getUrlMode()){case NewWorkFlow.MODE:NewWorkFlow.callbackByAction(ZP_Automation_Mode.ESIGN,{cancel:!0});break;case CustomAction.MODE:CustomAction.callbackByAction(ZP_Automation_Mode.ESIGN,{cancel:!0});break;default:Zsign.isCancel=!0,settingsPage.container.find("#esignTempList").toggleClass("DN"),window.location.href="#admin/automation/workflow/actions/esign"}},templateChangeAct:function(){var pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId);if($("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("select#fTempOpt").find("option:selected").length>0){var templateData=ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("#fTempOpt"))._selected[0].optData.text,id=$(ZPeopleComponents.select($("#"+ZPA_Esign.Slider.esflowModal.tabs[2].cardId).find("#fTempOpt"))._selected[0]).attr("id");templateData=ZPeople.decodeTxt(templateData),pageId.find("#msgTemplate").html(templateData)}ZPSetupCommon.isEmpty(templateData)||"-1"==id?pageId.find("#msgTemplate").addClass("DN"):pageId.find("#msgTemplate").removeClass("DN")},editTemplateConfig:function(){return esign.openWorkFlowEsignModal("edit")},addRecp:function(thisObj,action,isFilterMode){var pageId=settingsPage.container;if(!ZPSetupCommon.isEmpty(action)&&"mins"===action)return $(thisObj).closest("[name=recp_row]").remove(),void pageId.find("#add_recplnk").show();if(void 0!=Zsign.emailidfield.formId&&Object.keys(Zsign.emailidfield.formId).length>pageId.find("[name=recp_row]").length){var recpOption=Zsign.constructFormFields(Zsign.emailidfield.formId),addRecpElm='<div class="zp_fm" name="recp_row">';addRecpElm+='<div class="criteria-field">',addRecpElm+='<i class="ri"></i>',addRecpElm+='<div class="actions" id="action_icon">',isFilterMode||(addRecpElm+='<i class="PI_minus" onclick=Zsign.addRecp(this,"mins")></i>'),addRecpElm+="</div>",addRecpElm+='<div class="col-sm-6"><select id="recpList" placeholder="'+ZPI18N.getString("role")+'" class="select2" tabindex="-1">'+recpOption+"</select></div>",addRecpElm+='<div class="col-sm-6"><select id="recp_type" placeholder="'+ZPI18N.getString("role")+'" class="select2" tabindex="-1"><option value="1">'+ZPI18N.getString("zp.sign")+'</option><option value="2">'+ZPI18N.getString("zp.view")+"</option>",Zsign.checkZSFeature(),Zsign.zsFeatureList.approver&&(addRecpElm+='<option value="3">'+ZPI18N.getString("zp.approve")+"</option>"),Zsign.zsFeatureList.in_person_signing&&(addRecpElm+='<option value="4">'+ZPI18N.getString("zp.inperson")+"</option>"),addRecpElm+="</select></div>",addRecpElm+="</div>",addRecpElm+="</div>",$(addRecpElm).insertBefore(pageId.find("#add_recplnk"));var recpSelect=$(addRecpElm).find("#recpList");$(recpSelect.find("option:nth-child("+parseInt(pageId.find("[name=recp_row]").length-1)+")")).attr("selected","selected")}void 0!=Zsign.emailidfield.formId&&Object.keys(Zsign.emailidfield.formId).length===pageId.find("[name=recp_row]").length&&pageId.find("#add_recplnk").hide()},addFileFields:function(filename){var docDispName=filename.substring(filename.lastIndexOf("/")+1),obj={};obj.name=docDispName,ZPA_Esign.attachmentConstructor(obj)},expColSettings:function(id){"1"===$("#"+id).find("#setting_lnk").attr("val")?($("#"+id).find("#moreSettings").slideUp("fast"),$("#"+id).find("#setting_lnk").attr("val","0"),$("#"+id).find("#setting_lnk").text(ZPI18N.getString("zp.showoptions"))):($("#"+id).find("#moreSettings").slideDown("fast"),setTimeout(function(){$("#"+id).find("#setting_lnk").attr("val","1"),$("#"+id).find("#setting_lnk").text(ZPI18N.getString("zp.hide"))},500))},deleteEsignConfig:function(thisObj){var delIcObj=thisObj.delIcObj,params={recordId:$(delIcObj).attr("recordId")};ZPeople.Request.send("/zpzsign/deleteEsign",params,Zsign.handleCallBackDelete)},handleCallBackDelete:function(data,params){if("success"===data[1].response){ZPeople.Message.success(ZPI18N.getString("zp.esigndeleted"));var configId=params.recordId,pageId=ZPA_Common.getParentPageId();if(pageId.find("tbody").find("tr[cid='"+configId+"']").remove(),0===pageId.find("div[name=action_body]").find("tbody tr").length){$("#add_esign").hide(),pageId.children("[name=action_body]").remove();var emptyPageObj=new EmptyPages(ZPA_Common.getEmptyPageIcon(ZP_Automation_Mode.ESIGN),ZPA_Common.getEmptyPageTitle(ZP_Automation_Mode.ESIGN),"",pageId.find(".zpl_rgtcnt"));emptyPageObj.setButton(ZPI18N.getString("zp.add")+" "+ZPI18N.getString("zp.esign.wf.tabname"),ZPA_Esign.add),emptyPageObj.show()}}else ZPA_Common.showCannotDeleteModal(ZP_Automation_Mode.ESIGN,data[1].wfmapping)},showFields:function(thisObj){AutomationCommon.getFormFieldsHtml().clone();settingsPage.container.find("#addDocNameField,#addSubjectField").popover({html:!0,content:function(){return Zsign.showFieldsHtml(settingsPage.container.find("#addDocNameField,#addSubjectField"))}}),$("body").on("click",function(e){0===$(".popover").has(e.target).length&&0===$(settingsPage.container.find("#addDocNameField,#addSubjectField")).has(e.target).length&&$(settingsPage.container.find("#addDocNameField,#addSubjectField")).popover("hide")})},showFieldsHtml:function(clickObj){var data=Zsign.textfield.formId,headerDiv=$('<div class="tabvertical tabselectsingle" srcTxt="true"><div class="dvPopsearch"><div class="inputsearch"> <input class="form-control" type="search" placeholder="'+ZPI18N.getString("Select")+'" id="temp_search"> </div></div><ul class="list-group ulRecipient" role="tablist" id="listBody"> </ul></div>');if($.isEmptyObject(data)){var noRecords="<div class='col-md-12 P20'><span>"+ZPI18N.getString("zp.norecfound")+"</span></div>";headerDiv.find("#listBody").html(noRecords)}else{headerDiv.find("#listBody").html(""),headerDiv.find("#listBody").prepend("<li class='head'><span class='ZPbold'>"+ZPI18N.getString("zp.fields")+"</span></li>");var fieldDetails={};$.each(data,function(fieldId,fieldName){var cloneLi=$('<li name="list-group-item"><span data-toggle="tab" role="tab" name="mOpt"></span></li>').clone();cloneLi.find("[name=mOpt]").text(decodeHTML(fieldName)),cloneLi.find("[name=mOpt]").attr({id:fieldId,val:fieldId}),cloneLi.on("click",function(){$(this).addClass("sel").siblings().removeClass("sel");var getInput="subjectInputTag"===$(this).closest("[name='popover_div']").attr("id")?settingsPage.container.find("#document_subject"):settingsPage.container.find("#document_name"),getField="${"+$(this).find("span[name=mOpt]").text()+"}",fcId=$(this).find("[name=mOpt]").attr("id"),actualVal="";-1===$(this).attr("class").indexOf("sel")?getInput.val(getInput.val().replace(getField,"")):(fieldDetails[fcId]=getField,ZPSetupCommon.isEmpty(getField)?getInput.val(getInput.val()+""+getField):getInput.val(getInput.val()+getField),ZPSetupCommon.isEmpty(actualVal)||""==actualVal||(actualVal+=","),"addSubjectField"===$(clickObj).attr("id")?Zsign.docsubject.push(fcId):Zsign.docname.push(fcId))}),headerDiv.find("#listBody").append(cloneLi)})}return headerDiv},constructSearchList:function(){var tokenObj={};tokenObj.dataSource={search:function(params){return new Promise(function(success){success({results:EmployeeSearch.getEmpList(params.query,"emp","FILES_ESIGNLIST",[],{},!1,"",!0),more:!1})})},paginated:!0,serverSearch:!0},tokenObj.placeholder=ZPI18N.getString("zp.searchemployee");var dataMapping={value:"id",text:"value",id:"zuid",image:"image",emailId:"emailId"};return tokenObj.dataMapping=dataMapping,tokenObj.tokens={contentType:"image-text"},tokenObj.isLabelHTMLEncoded=!0,tokenObj.dropdownList={fitForElement:!0,moveOnScroll:!0,contentType:"image-text",isTextHTMLEncoded:!0,itemType:"checkbox",appendTo:$("#cardfilesSendSign")},tokenObj.search={retainKeyword:!1,by:["emailId","value","zuid"],minKeywordLength:"1",highlightKeyword:!0,showNoResultsMessage:!0},tokenObj.messages={noResults:ZPI18N.getString("zp.nomatchesfound")},tokenObj},loadSignTemplate:function(fileID,tempId,locId,entityId,unitId,divisionId,departmentId){OWNER_LIST={},$(".main-wrp").addClass("services"),Zsign.isfromOrgFiles=!0,Zsign.signTemplateId=tempId,Zsign.locationId=locId,Zsign.entityId=entityId,Zsign.unitId=unitId,Zsign.divisionId=divisionId,Zsign.departmentId=departmentId,Zsign.signFileId=fileID;var formData={};""!=locId&&void 0!=locId&&(formData.locationIdlist=locId),""!=Zsign.entityId&&void 0!=Zsign.entityId&&(formData.legalEntityIdlist=Zsign.entityId),""!=Zsign.unitId&&void 0!=Zsign.unitId&&(unitIds=Zsign.unitId,formData.businessUnitIdlist,Zsign.unitId),""!=Zsign.divisionId&&void 0!=Zsign.divisionId&&(formData.divisionIdlist=Zsign.divisionId),""!=Zsign.departmentId&&void 0!=Zsign.departmentId&&(formData.departmentIdlist=Zsign.departmentId),ZPeopleComponents.tokenfield("#signFileDivInput",Zsign.constructSearchList())},sendForSignByTemplateHTML:function(){var contTxt=ZPI18N.getString("zp.esign.sendtoallemp");Zsign.isfromZSignTemplates()&&(contTxt=ZPI18N.getString("zp.sendtoallemployees"));var content='<div class="zpl_crd" id="basicDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.templatedetails")+'</h4></div></div><div class="zpl_crdcnt"><div><h6>'+ZPI18N.getString("zp.name")+'</h6><div class="zpl_secn"><div><label id ="templateName"></label></div><div></div></div></div></div></div>';content+='<div class="zpl_crd" id="recipientsSec"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt">',content+='<div class="zpl_secn"><div><div class="zradiobutton"><input id="sendtoAll" type="radio"  name="sendfromFilesRB" class="zradiobutton__helper" checked onclick="Zsign.showhidesffOptions(this)"><label id="sendToAll_Label" for="sendtoAll" class="zradiobutton__label"><span class="zradiobutton__text">'+contTxt+"</span></label></div></div>",content+='<div class="zradiobutton"><input id="sendtoEmp" type="radio" name="sendfromFilesRB" class="zradiobutton__helper" onclick="Zsign.showhidesffOptions(this)"><label for="sendtoEmp" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.esign.sendtospecemp")+"</span></label></div>",content+='<div class="DNI zpl_gbox d-flex" id="empListcont"><div><textarea class="tokenfieldId-js" id="signFileDivInput" placeholder="'+ZPI18N.getString("zp.searchemployee")+'"></textarea>',content+='</div></div></div><div class="zpl_secn" id="extraRecipient"></div></div>',$(settingsPage.mainWrapId).find("#cardfilesSendSign").html(content)},listZSignMergeFields:function(data,params){var actionData=data[1].data;$("#templateName").text(actionData.template_name);var settings_profile=actionData.settings_profile;if(void 0!=data[1][9]){var dataLeng=data[1][9].length;if(dataLeng>0){var consHTML='<div id="zsMergeSec">';consHTML+='<div class="zpl_crdcnt">',consHTML+='<div class="zpl_secn"><div><h4>'+ZPI18N.getString("zp.esign.mergefields")+"</h4></div>",consHTML+='<div class="zpl_info">',consHTML+="<h6><span>"+ZPI18N.getString("zp.info")+"</span></h6>",consHTML+="<ul>",consHTML+="<li><em>"+ZPI18N.getString("zp.esign.mergenote1",new Array(settings_profile))+"</em></li>",consHTML+="<li><em>"+ZPI18N.getString("zp.esign.mergenote2")+"</em></li>",consHTML+="<li><em>"+ZPI18N.getString("zp.esign.mergenote3")+"</em></li>",consHTML+="</ul>",consHTML+="</div>",consHTML+="</div>",consHTML+='<div class="zpl_secn zpl_gbox d-flex" id="mergeFields">',consHTML+='<div id="mergeFieldsTable" class="zpl_itbl"><table><tbody><tr>',consHTML+='<td width="300"><b>'+ZPI18N.getString("zp.zohosign")+"</b></td>",consHTML+="<td><b>"+ZPI18N.getString("zpeople")+"</b></td>",consHTML+="</tr></tbody></table></div>",consHTML+="</div></div></div>",$("#basicDetails").append(consHTML)}for(var itr=0;itr<dataLeng;itr++){var label=data[1][9][itr].label,datatype=data[1][9][itr].type,field_id=data[1][9][itr].field_id,is_mandatory=data[1][9][itr].is_mandatory,classNm="";is_mandatory&&(classNm="zpl_mtry");var html='<div class="zpl_secn zpl_mailtmp"><div><label name="mergeFieldsList" class="'+classNm+'" fid="'+field_id+'" data-mandtry='+is_mandatory+">"+label+"</label></div>";html+='<div><input type="text" id="'+field_id+'" datatype="'+datatype+'" data-mandtry='+is_mandatory+' labelName="'+label+'" class="ztextbox" value=""></div>',html+="</div>",$("#mergeFieldsTable").append(html)}}},disableSaveBtn:function(pageId,btnId){pageId.find("#"+btnId).prop("disabled",!0)},enableSaveBtn:function(pageId,btnId){setTimeout(function(){pageId.find("#"+btnId).removeAttr("disabled")},500)},viewApprovalPopup:function(fid,rcid){ApprovalList.viewApprovalPopup(fid,rcid,!1),Zsign.isRecordOpened=!0},loadActionData:function(signTemplateId){if(0==$(settingsPage.mainWrapId).find("#tabfilesSendSign").length){var popupTab=new Tab("filesSendSign",Zsign.sendForSignByTemplateHTML,Zsign.scheduleSignTemplate);Zsign.SENDBYTEMPLATE=new sliderModal(ZPI18N.getString("zp.requestsignature"),popupTab),Zsign.SENDBYTEMPLATE.save=ZPI18N.getString("zp.send"),Zsign.SENDBYTEMPLATE.cancel=ZPI18N.getString("zp.cancel"),Zsign.SENDBYTEMPLATE.setCloseCallback(function(){Zsign.removeOFSignElementsfn(),Zsign.SENDBYTEMPLATE.remove()})}Zsign.SENDBYTEMPLATE.construct();var params={conreqcsr:csrfToken,signTemplateId:signTemplateId,needAllData:!0};$.ajax({url:"/zpzsign/getTemplateActionIds",type:"POST",data:params,success:function(data){Zsign.setActionNames(data,params)},failure:function(data){Zsign.failedCallBack(data)}})},showhidesffOptions:function(thisObj){"sendtoAll"==thisObj.id?(ZPeopleComponents.tokenfield(document.getElementById("signFileDivInput")).setAttributes({disabled:!0}),$("#empListcont").addClass("DNI")):"sendtoEmp"==thisObj.id&&(ZPeopleComponents.tokenfield(document.getElementById("signFileDivInput")).setAttributes({disabled:!1}),$("#empListcont").removeClass("DNI"))},removeOFSignElementsfn:function(){ZPeopleComponents.tokenfield("#signFileDivInput").destroy()},callActionData:function(signTemplateId,compSignFileId,isEdit){Zsign.delZSActionId=[];var params={conreqcsr:csrfToken,signTemplateId:signTemplateId,needAllData:!0};Zsign.actionNames=[],Zsign.editSignTempId=signTemplateId,Zsign.compSignFileId=compSignFileId,$.ajax({url:"/zpzsign/getTemplateActionIds",type:"POST",data:params,success:function(data){Zsign.setActionNames(data,params,isEdit)},failure:function(data){Zsign.failedCallBack(data)}})},delZSTempEmp:function(getThis){$("#esign_card");"1"!=FilesUtil.Page.getTabGroup()&&"tab-files-esigntemplates"!=settingsPage.container[0].id||$("#esignorg_card");var delActionId=$(getThis).closest("div[name=recp_row]").attr("actionId");void 0!=delActionId&&Zsign.delZSActionId.push(delActionId)},setSignerFieldForAllRecp:function(data){Zsign.signerFieldForAllRecp=!1;var actionData=data[1].data;Zsign.signerFieldForAllRecp=actionData.signerFieldForAllRecp,void 0!=Zsign.zSignData&&void 0!=Zsign.zSignData[1]&&void 0!=Zsign.zSignData[1].data.signerFieldForAllRecp&&(Zsign.zSignData[1].data.signerFieldForAllRecp=actionData.signerFieldForAllRecp)},setActionNames:function(data,params,isEdit){var pageId=Zsign.getEsignPageId();Zsign.signerFieldForAllRecp=!1,Zsign.actionNames=[];var actionValues=data[1][4],actionData=data[1].data,expDays=actionData.expiration_days,isSeq=actionData.is_sequential,notes=actionData.notes,reminder=actionData.reminder_period,tempName=actionData.template_name,catId=actionData.CatID;actionData.settings_profile;if(Zsign.hidePopupForSend=!1,Zsign.signerFieldForAllRecp=actionData.signerFieldForAllRecp,isEdit){(pageId=$("#esignorg_card")).find("#signing_order").prop("checked",isSeq),pageId.find("#document_message").html(notes),reminder>=1&&(pageId.find("#reminder_check").prop("checked",!0),pageId.find("input[name=reminder_freqdayscnt]").val(reminder),pageId.find("#reminder_setting, #reminder_freq").show()),pageId.find("input[name=noOfDays]").val(expDays),pageId.find("#document_name").val(tempName),ZPSetupCommon.isEmpty(catId)||ZPeopleComponents.select(pageId.find("select#agrselect_Cat")).setAttribute("selectedValue",catId);var recpCount=0,options=Zsign.constructAddEmpListSel();Object.keys(actionValues).length>0&&$.each(actionValues,function(_key,value){"Manager"==value.role||"MANAGER"==value.role||value.role==ZPI18N.getString("zp.manager")?Zsign.addRecpRows("manager",recpCount,value.action_id):Zsign.addRecpRows("userbtnId",recpCount,value.action_id);var currRow=$(pageId.find("[name='recp_row']")[recpCount]),curRowComp=currRow.find("#recpType_"+recpCount),zsignType=1;if("SIGN"==value.action_type?zsignType=1:"VIEW"==value.action_type?zsignType=2:"APPROVER"==value.action_type?zsignType=3:"INPERSONSIGN"==value.action_type&&(zsignType=4),ZPeopleComponents.select(curRowComp).setAttributes({selectedValue:zsignType}),void 0!=value.language?ZPeopleComponents.select(currRow.find("#recpLocale_"+recpCount)).setAttributes({selectedValue:value.language}):ZPeopleComponents.select(currRow.find("#recpLocale_"+recpCount)).setAttribute("selectedValue","en"),""!=value.recipient_email&&void 0!=value.recipient_email){if("Manager"!=value.role&&"MANAGER"!=value.role&&value.role!=ZPI18N.getString("zp.manager")){4==zsignType&&value.ishost?value.in_person_email:value.recipient_email,ZPeopleComponents.select(currRow.find("#recpFormValue_"+recpCount)).setAttribute("selectedValue","3"),ZPeopleComponents.select(currRow.find("#recpFieldValue_"+recpCount)).removeAllOptions(),ZPeopleComponents.select(currRow.find("#recpFieldValue_"+recpCount)).setAttributes(options);var selectedValObj={id:value.empDetails.usererec,value:value.empDetails.empid+" "+value.empDetails.name,image:value.empDetails.avatar};ZPeopleComponents.select(currRow.find("#recpFieldValue_"+recpCount)).setAttributes({selectedValue:selectedValObj})}if(4==zsignType&&value.ishost){var hostEmail=value.recipient_email,hostRow=$(pageId.find("[name='hostRow']")[recpCount]);ZPeopleComponents.select(hostRow.find("#recpHost_"+recpCount)).setAttributes({selectedValue:hostEmail})}}else"Manager"==value.role||"MANAGER"==value.role||value.role==ZPI18N.getString("zp.manager")?ZPeopleComponents.select(pageId.find("#recpFormValue_"+recpCount)).setAttribute("selectedValue","5"):ZPeopleComponents.select(pageId.find("#recpFormValue_"+recpCount)).setAttribute("selectedValue","6");0==recpCount?(pageId.find("#recpName_"+recpCount).val(ZPI18N.getString("zp.employee")),pageId.find("#recpName_"+recpCount).addClass("disabled")):"Manager"==value.role||"MANAGER"==value.role||value.role==ZPI18N.getString("zp.manager")?(pageId.find("#recpName_"+recpCount).val(ZPI18N.getString("zp.manager")),pageId.find("#recpName_"+recpCount).addClass("disabled")):(4==zsignType&&value.ishost?currRow.find("[name='recpName']").val(value.in_person_name):currRow.find("[name='recpName']").val(value.role),pageId.find("#recpName_"+recpCount).removeClass("disabled")),"1"!=FilesUtil.Page.getTabGroup()&&"tab-files-esigntemplates"!=settingsPage.container[0].id||currRow.data("tdata",value),recpCount++})}else{(pageId=$("#cardfilesSendSign")).find("#extraRecipient").html(""),pageId.find("#extraRecipient").addClass("DN");var constructVal="<div><h5>"+ZPI18N.getString("zp.requiresignfrom")+'</h5></div><div class="MT20">';Object.keys(actionValues).length>1&&($.each(actionValues,function(key,value){"Employee"!==value.role&&"SIGNER"!==value.role&&("Manager"==value.role?constructVal+='<div class="zpl_tg"><span>'+value.role+"</span></div>":void 0!=value.role&&""!=value.role?constructVal+='<div class="zpl_tg"><span>'+value.role+"</span></div>":value.ishost?constructVal+='<div class="zpl_tg"><span>'+value.in_person_email+"</span></div>":constructVal+='<div class="zpl_tg"><span>'+value.recipient_email+"</span></div>"),Zsign.actionNames.push(value)}),constructVal+="</div>",pageId.find("#extraRecipient").append(constructVal),pageId.find("#extraRecipient").removeClass("DN")),Zsign.listZSignMergeFields(data,params)}if(0==actionData.signerFieldForAllRecp&&!isEdit)return Zsign.hidePopupForSend=!0,void ZAlertBanner.show({message:ZPI18N.getString("zp.addsignerfields"),type:"warning",hideDelay:1e4,closeButton:!0,icon:!0,animation:{show:{name:"slideDown",duration:500},hide:{name:"slideUp",duration:500}},icon:!0,hideDelay:4e3,closeButton:!0,beforeshow:ZPeople.Message.beforeShow})},clearSendTemplate:function(){settingsPage.container.find("#reqSignDiv").removeClass("active"),$(".main-wrp").removeClass("services"),settingsPage.container.find("#empRoleOptions span").remove(),settingsPage.container.find("#sendtoAll").is(":checked")&&(settingsPage.container.find("#empRoleOptions").popover("toggleEnabled"),settingsPage.container.find("#sendtoAll").prop("checked",!1),settingsPage.container.find("#signFileDiv").addClass("zp_opLw")),settingsPage.container.find("#empRoleOptions").removeClass("dvfrmlistBD"),settingsPage.container.find("#signFileDivInput").attr("selectedids",""),Zsign.isfromOrgFiles=!1,OWNER_LIST={}},sendToAll:function(){settingsPage.container.find("#empRoleOptions").popover("toggleEnabled"),settingsPage.container.find("#empRoleOptions").hasClass("dvfrmlistBD")?settingsPage.container.find("#empRoleOptions").removeClass("dvfrmlistBD"):settingsPage.container.find("#empRoleOptions").addClass("dvfrmlistBD")},scheduleSignTemplate:function(){$("#tabfilesSendSign").find("#sliderSbt").prop("disabled",!0),ZPA_Esign.resetAllErrorborder();var emailErecList="",tempId=Zsign.signTemplateId,fileID=Zsign.signFileId,locationId=Zsign.locationId,sendtoAll=$("#sendtoAll").is(":checked"),sendtoEmp=$("#sendtoEmp").is(":checked"),formData=new FormData;if(sendtoAll)""!=locationId&&void 0!=locationId&&formData.append("locationId",locationId),""!=Zsign.entityId&&void 0!=Zsign.entityId&&formData.append("entityId",Zsign.entityId),""!=Zsign.unitId&&void 0!=Zsign.unitId&&formData.append("unitId",Zsign.unitId),""!=Zsign.divisionId&&void 0!=Zsign.divisionId&&formData.append("divisionId",Zsign.divisionId),""!=Zsign.departmentId&&void 0!=Zsign.departmentId&&formData.append("departmentId",Zsign.departmentId);else if(sendtoEmp){emailErecList="";var emailErecListItems=ZPeopleComponents.tokenfield(document.getElementById("signFileDivInput")).getAllValues();if(0==emailErecListItems.length&&!sendtoAll)return ZPeople.Message.failure(ZPI18N.getString("zp.selectemployee")),void $("#tabfilesSendSign").find("#sliderSbt").removeAttr("disabled");for(var i=0,l=emailErecListItems.length;i<l;i++){var userErecNo=$(emailErecListItems)[i].id;0!==i&&(emailErecList+=","),emailErecList+=userErecNo}}var err=!1,preFillFields=[],mergeFieldListLen=(pageId=$("#cardfilesSendSign")).find("label[name=mergeFieldsList]").length;for(i=0;i<mergeFieldListLen;i++){var preFillFieldsVal={},prefill_id=pageId.find(pageId.find("label[name=mergeFieldsList]")[i]).attr("fid"),prefill_val=pageId.find("#"+prefill_id).val(),mandtry=pageId.find(pageId.find("label[name=mergeFieldsList]")[i]).data("mandtry");null!=prefill_val&&""!=prefill_val?(preFillFieldsVal[Zsign.PREFILL_FIELDID]=prefill_id,preFillFieldsVal[Zsign.PREFILL_VALUE]=prefill_val,preFillFieldsVal[Zsign.PREFILL_DATATYPE]=pageId.find("#"+prefill_id).attr("datatype"),preFillFieldsVal[Zsign.PREFILL_LABEL]=pageId.find("#"+prefill_id).attr("labelName"),preFillFields.push(preFillFieldsVal)):mandtry&&($("#"+prefill_id).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.ffselerr")+"</span>"),pageId.find("#"+prefill_id).addClass("ztextbox__error"),err=!0)}if(err)return $("#tabfilesSendSign").find("#sliderSbt").removeAttr("disabled"),err;if(!Zsign.signerFieldForAllRecp){var params={conreqcsr:csrfToken,signTemplateId:tempId};if($.ajax({url:"/zpzsign/getTemplateActionIds",type:"POST",data:params,success:function(data){Zsign.setSignerFieldForAllRecp(data)},failure:function(data){Zsign.failedCallBack(data)}}),!Zsign.signerFieldForAllRecp)return ZAlertBanner.show({message:ZPI18N.getString("zp.addsignerfields"),type:"error",hideDelay:1e4,closeButton:!0,icon:!0,animation:{show:{name:"slideDown",duration:500},hide:{name:"slideUp",duration:500}},icon:!0,hideDelay:4e3,closeButton:!0,beforeshow:ZPeople.Message.beforeShow}),void $("#tabfilesSendSign").find("#sliderSbt").removeAttr("disabled")}0!=preFillFields.length&&formData.append("preFillFieldsData",JSON.stringify(preFillFields)),formData.append("fileId",fileID),formData.append("conreqcsr",csrfToken),formData.append("signTemplateId",tempId),formData.append("emailErecList",ZPSetupCommon.isEmpty(emailErecList)?"":emailErecList),formData.append("isNewUI",!0);var pageId=settingsPage.container;if($.ajax({url:"/zpzsign/scheduleZohoSignTemplate",type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){Zsign.SENDBYTEMPLATE.close(),ZPeople.Message.success(ZPI18N.getString("zp.documentscheduled"))},error:function(req){if(pageId.parent().find("div#zp_page_loading").remove(),pageId.find("form#createDocumentForm,div#ca_footer").show(),400===req.status){if(void 0!=req.responseJSON)return ZPeople.Message.failure(req.responseJSON.error),void $("#tabfilesSendSign").find("#sliderSbt").removeAttr("disabled");ZPeople.Message.failure(ZPI18N.getString("zp.internalservererror"))}if(void 0!=req.responseJSON){var errResponse=req.responseJSON[1];if(8026==errResponse.errorCode||8006==errResponse.errorCode)return ZPeople.Message.failure(errResponse.msg),void $("#tabfilesSendSign").find("#sliderSbt").removeAttr("disabled")}else $("#tabfilesSendSign").find("#sliderSbt").removeAttr("disabled"),ZPeople.Message.failure(ZPI18N.getString("zp.internalservererror"))}}),"#files/Zsign/templatelistview"!=Layout.Page.hash&&0==pageId.find("#comp_fileListing").find("#compfileTr_"+fileID).find("#moreFileOperations").find("#viewcompReport").length){var comphtml='<li id= "viewcompReport" onclick="Zsign.FilesOperations.showViewReport(\''+fileID+'\')"><i class="PI_chart"></i>'+ZPI18N.getString("zp.esign.viewreport")+"</li>";pageId.find("#comp_fileListing").find("#compfileTr_"+fileID).find("#moreFileOperations").append(comphtml)}},showEmployeeLookup:function(thisObj){var pageId="";pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId),"optrecordbtn"==$(thisObj).find("input").attr("id")?(pageId.find("#optotherbtn").removeAttr("Checked"),pageId.find($(thisObj).find("input")).prop("checked",!0)):"optotherbtn"==$(thisObj).find("input").attr("id")&&(pageId.find("#optrecordbtn").removeAttr("Checked"),pageId.find($(thisObj).find("input")).prop("checked",!0)),"on"==pageId.find("#optotherbtn:checked").val()?pageId.find("#hrfileoptdiv").removeClass("DNI"):"on"==pageId.find("#optrecordbtn:checked").val()&&pageId.find("#hrfileoptdiv").addClass("DNI")},showDateLookup:function(thisObj){var pageId="";pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId),"datelookupid"==$(thisObj).find("input").attr("id")?(pageId.find("input#deadline").addClass("DNI"),pageId.find("#deadlineLabel").addClass("DNI"),pageId.find("#expdateid").removeAttr("Checked"),$(thisObj).find("input").attr("Checked","Checked")):"expdateid"==$(thisObj).find("input").attr("id")&&(pageId.find("#datelookupid").removeAttr("Checked"),pageId.find("input#deadline").removeClass("DNI"),pageId.find("#deadlineLabel").removeClass("DNI"),$(thisObj).find("input").attr("Checked","Checked")),"1"!=pageId.find("#expdateid:checked").val()?(pageId.find("#deadlineLabel").addClass("DNI"),pageId.find("#deadlinegrp").removeClass("DNI")):"1"==pageId.find("#expdateid:checked").val()&&(pageId.find("#deadlineLabel").removeClass("DNI"),pageId.find("#deadlinegrp").next("#errorMsg").remove(),pageId.find("#deadlinegrp").addClass("DNI"))},lookupopt:function(LookupList){ZPA_Esign.LookupList=LookupList[1];var createAgr="";0!=(createAgr=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId)).find("select#hrfileopt").length&&(ZPeopleComponents.select(createAgr.find("select#hrfileopt")).destroy(),Zsign.attachLookupOpts(createAgr,createAgr.find("select#hrfileopt"))),createAgr.find("#optotherbtn").prop("checked",!0),createAgr.find("#hrfileoptdiv").removeClass("DNI")},attachLookupOpts:function(appendToID,compId){var empLookupProp={options:ZPA_Esign.fetchEmpLookup(),dataMapping:{label:"label",value:"value"},showSearchField:!0,isLabelHTMLEncoded:!0,dropdownList:{appendTo:appendToID,fitForElement:!0,moveOnScroll:!0,isTextHTMLEncoded:!0}};ZPeopleComponents.select(compId,empLookupProp)},showOptions:function(me){var pageId="",id=((pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId)).find("#synctypeOptions"),$(me).find("input").attr("id"));1==pageId.find("[id="+id+"]").is(":checked")?("on"!=pageId.find("#optotherbtn:checked").val()&&pageId.find("#optrecordbtn").prop("checked",!0),pageId.find("#synctypeOptions").removeClass("DNI"),Zsign.showEmployeeLookup()):(pageId.find("#synctypeOptions").addClass("DNI"),pageId.find("#hrfileoptdiv").addClass("DNI"))},showExpiryOptions:function(me){var pageId="",optionholder=(pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId)).find("#datefieldOptions"),id=$(me).find("input").attr("id");if(1==pageId.find("[id="+id+"]").is(":checked")){if(void 0!=ZPA_Esign.editData&&""!=ZPA_Esign.editData){var info=ZPA_Esign.editData[1][0].info;if(!info.hasOwnProperty(Zsign.DEADLINE)&&!info.hasOwnProperty(Zsign.DATELOOKUPID)&&void 0!=Zsign.zSignData&&""!=Zsign.zSignData)return pageId.find("#expiry_in_days_div").removeClass("DNI"),void pageId.find("#datefieldOptionscont").removeClass("DNI")}else if(void 0!=Zsign.zSignData&&""!=Zsign.zSignData)return pageId.find("#datefieldOptionscont").removeClass("DNI"),pageId.find("#expiry_in_days").val(Zsign.zSignData[1].data.expiration_days),void pageId.find("#expiry_in_days_div").removeClass("DNI");optionholder.removeClass("DNI"),pageId.find("#datefieldOptionscont").removeClass("DNI"),"1"!=pageId.find("#expdateid:checked").val()?(pageId.find("#datelookupid").attr("Checked","Checked"),pageId.find("#deadlinegrp").removeClass("DNI")):(pageId.find("#expdateid").attr("Checked","Checked"),pageId.find("#deadlineLabel").removeClass("DNI"))}else optionholder.addClass("DNI"),pageId.find("#datefieldOptionscont").addClass("DNI"),pageId.find("#deadlinegrp").addClass("DNI"),pageId.find("#deadlineLabel").addClass("DNI"),pageId.find("#datefieldOptions").addClass("DNI"),pageId.find("#expiry_in_days_div").addClass("DNI")},isEsignatureAllowed:function(){$.ajax({type:"POST",async:!1,url:"/zpzsign/isEsignatureAllowed",data:{conreqcsr:csrfToken},success:function(data){Zsign.FilesOperations.isEsignatureAllowedFlag=data[1][0]}})},getEsignConfigurations:function(async){void 0==async&&(async=!1),isAnySignConfigured=!1,isZSConfig=!1,isAdobeConfig=!1,isDocuConfig=!1,$.ajax({type:"POST",async:async,url:"/zpzsign/getEsignConfigurations",data:{conreqcsr:csrfToken},success:function(data){data[1].isAnySignConfigured&&(isAnySignConfigured=!0),data[1].servicesConfigured.ZohoSign?isZSConfig=!0:data[1].servicesConfigured.AdobeSign?isAdobeConfig=!0:data[1].servicesConfigured.DocuSign&&(isDocuConfig=!0),data[1].filespermission&&(Zsign.loginUserRoleCheck=data[1].filespermission)}})},extendExpiry:function(bulk){$("#sliderSbt").addClass("disabled"),$("#cardnewExpiryPopup").find(".ztextbox--error__label").remove(),$("#cardnewExpiryPopup").find(".ztextbox__error").removeClass("ztextbox__error");var expiryDate=ZPeopleComponents.datefield("#newExpiry").getValue().dateString;if(void 0==expiryDate||!ZPUtil.Validation.isDate(expiryDate))return $("#newExpiry").parent().parent().addClass("zpl_erorbx"),$("#newExpiry").parent().parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.holiday.dateerror")+"</span>"),ZPeopleComponents.datefield("#newExpiry").getElement().addClass("ztextbox__error"),void $("#sliderSbt").removeClass("disabled");var agrmntID=Zsign.documentId,documentIdList="",documentArray=settingsPage.container.find("#documents_list").find('input[type="checkbox"]:checked'),documentCount=documentArray.length;if(documentCount>100)return ZPeople.Message.warning(ZPI18N.getString("zp.extendexpiryexceed",new Array("100"))),void $("#sliderSbt").removeClass("disabled");for(var i=0;i<documentCount;i++)i>=1&&(documentIdList+=","),documentIdList+=settingsPage.container.find(documentArray[i]).parent().parent().parent().attr("documentid");var params={conreqcsr:csrfToken,expiryDate:expiryDate};if(bulk?(params.documentIdList=documentIdList,params.bulk=!0):params.recordIdList=agrmntID,void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(params.moduleType="2",params.recList=Zsign.recordId,void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId?params.formId=ZP5Form.getFormClassObj().getParams().formId:params.formId=ZP5Form.getCurrFormsOperation().formId):params.moduleType="1",""==expiryDate||void 0==expiryDate||0==expiryDate)return ZPeopleComponents.datefield($("#newExpiry")).getElement().addClass("ztextbox__error"),$("#newExpiry").parent().append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.entervaliddate")+"</span>"),void $("#sliderSbt").removeClass("disabled");"-1"!=dateFmt.indexOf("MMM")&&(expiryDate=expiryDate.replace(/-/g," "));var currentdatelong=Calendar.getCurrentDate().getTime();if(new Date(expiryDate).getTime()<currentdatelong)return ZPeopleComponents.datefield($("#newExpiry")).getElement().addClass("ztextbox__error"),void $("#newExpiry").parent().append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.validuntilerr")+"</span>");$.ajax({url:"/zpzsign/extendExpiry",type:"PUT",data:params,success:function(data){Zsign.handleExtendExpiry(data,params)},failure:function(data){Zsign.failedCallBack(data)}})},handleExtendExpiry:function(data,params){if("success"===data[1].status){if(Object.keys(data[1].not_extendedList).length>0){var totalCount=Object.keys(data[1].not_extendedList).length,documentNames=[],more="";Object.values(data[1].not_extendedList).length>=5?(Object.values(Object.values(data[1].not_extendedList)).forEach(obj=>{documentNames.length<=5&&documentNames.push(ZSEC.Encoder.encodeForJavaScript(Object.values(obj)))}),Object.values(data[1].not_extendedList).length>5&&(more="+ "+(totalCount-5))):Object.values(Object.values(data[1].not_extendedList)).forEach(obj=>{documentNames.push(ZSEC.Encoder.encodeForJavaScript(Object.values(obj)))}),ZPeople.Message.warning(ZPI18N.getString("zp.extendexpirypartialfail",new Array(documentNames,more)))}else ZPeople.Message.success(ZPI18N.getString("zp.deadlineextended"));var row="",pageId=settingsPage.container;void 0!=data[1].extendedList&&(void 0!=params.documentIdList&&(Object.values(Object.values(data[1].extendedList)).forEach(obj=>{-1!=Layout.Page.hash.indexOf("#operations/files/esigndocuments")&&((row=$("#documents_list").find("tr[documentid='"+Object.keys(obj)+"'] td[name='env_status']")).html("<span class='org'>"+ZPI18N.getString("zp.sent")+"</span>"),row.closest("tr").attr("isCancelled",!1))}),"Expired"==settingsPage.container.find("select#search_status").val()&&Zsign.getESignList("","","search"),Zsign.Esign.removeDeleteWhiteBand("documents")),void 0!=params.recordIdList&&(row=-1!=Layout.Page.hash.indexOf("files/hrfile")||-1!=Layout.Page.hash.indexOf("selfservice/user/files")?pageId.find("ul[documentId='"+params.recordIdList+"'] li[name='env_status']"):pageId.find("ul[documentid='"+params.recordIdList+"'] li[name='env_status']"),-1!=Layout.Page.hash.indexOf("#operations/files/esigndocuments")&&(row=$("#documents_list").find("tr[documentid='"+params.recordIdList+"'] td[name='env_status']")),row.html("<span class='org'>"+ZPI18N.getString("zp.sent")+"</span>"),row.closest("tr").attr("isCancelled",!1)),$("#showExp").attr("onclick","Zsign.showExpiryPop('"+params.bulk+"')"),$("#deadLine").text(data[1].uiDate),$("#signDocStatus").html('<span class="org d-flexclmcap5 j-cnt-rgt">'+ZPI18N.getString("zp.sent")+"</span>"),Zsign.setDropDownOptions(!1,!0,params))}else"Error"===data[1].status&&(void 0!=data[1].message?ZPeople.Message.failure(data[1].message):ZPeople.Message.failure(ZPI18N.getString("zp.deadlinenotextended")));$("#sliderSbt").removeClass("disabled"),Zsign.closeExpiryPop()},closeExpiryPop:function(){$("#tabnewExpiryPopup").removeClass("zpl_mopen")},ExpiryModal:function(bulk){var html="";return html+='<div class="zpl_crd"><div class="zpl_crdcnt">',bulk||(html+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.currentdeadline")+'</label></div><div><input id="existExpiry" data-format="'+dateFmt+'" data-picker="true" data-calendar-icon="true" data-spin-buttons="none" data-disabled="true"></div></div>'),html+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.newdeadline")+'</label></div><div><input id="newExpiry" data-format="'+dateFmt+'" data-picker="true" data-calendar-icon="true" data-spin-buttons="none"></div></div></div></div>'},recallModal:function(){var html='<div class="zpl_secn wd100_per">';return html+='<div><textarea class="ztextbox" id="recallReason" autocomplete="off" rows="3" placeholder="'+ZPI18N.getString("zp.enterthereason")+'"></textarea></div>',html+="</div>"},showExpiryPop:function(bulk){if(0!=$("#verifyOn").length)ZPA_Esign.PrivatePOPUP.remove();else if(0==$("#verifyOn").length){var popupTab=new Tab("newExpiryPopup",function(){var popcon=Zsign.ExpiryModal(bulk);$("#cardnewExpiryPopup").html(popcon),ZPeopleComponents.isComponent("#existExpiry")||ZPeopleComponents.datefield($("#existExpiry")),ZPeopleComponents.isComponent("#newExpiry")||ZPeopleComponents.datefield($("#newExpiry"))},function(getThis){getThis.close()});popupTab.validate=function(){Zsign.extendExpiry(bulk)},ZPA_Esign.PrivatePOPUP=new popupModal(ZPI18N.getString("zp.extenddeadline"),popupTab),ZPA_Esign.PrivatePOPUP.save=ZPI18N.getString("zp.modify"),ZPA_Esign.PrivatePOPUP.setContainerAsBody(!0),ZPA_Esign.PrivatePOPUP.construct()}$("#newExpiry").val("");var tommor=new Date;if(tommor.setDate(tommor.getDate()+1),tommor.getDateBy(dateFmt),bulk)bulk&&ZPeopleComponents.datefield($("#newExpiry")).setValue(tommor);else{var deadline=$("#deadLine").text();if(void 0!=deadline)ZPeopleComponents.datefield($("#existExpiry")).setValue(deadline),ZPeopleComponents.datefield($("#newExpiry")).setValue(deadline),"Expired"==$("#signDocStatus").text()&&ZPeopleComponents.datefield($("#newExpiry")).setValue(tommor);else{var agrmntID=settingsPage.container.find("div#viewDocumentModal").attr("documentId");settingsPage.isEnabled&&settingsUrlProps.url.indexOf("operations/files")>-1&&(agrmntID=Layout.Page.hash.split("documentId:")[1]);var params={conreqcsr:csrfToken,documentId:agrmntID,updateExp:!0};$.ajax({url:"/zpzsign/getDocumentDetailsOrUpdateExpiry",type:"POST",data:params,success:function(data){Zsign.setExpiryDate(data)},failure:function(data){Zsign.failedCallBack(data)}})}}"#selfservice/user/files"!=Layout.Page.hash?settingsPage.container.find("#extendExpdiv").addClass("active"):$("#extendExpdiv").addClass("active"),Zsign.showOtherOptions()},showOtherOptions:function(){$("#showExpdropdown").toggleClass("open")},hideOtherOptions:function(){$("#showExpdropdown").removeClass("open")},setExpiryDate:function(data){data[1].expdate?ZPeopleComponents.datefield($("#existExpiry")).setValue(data[1].expdate):ZPeopleComponents.datefield($("#existExpiry")).clearAll()},loadMAddrPopUp:function(getThis,tagId){$(getThis).data("data")||(Zsign.initiatePopOver(),$(getThis).popover("show")),TemplateCommon.selectMalertAddr(tagId,$(getThis))},initiatePopOver:function(){var data={},pageDiv=$("#"+AutomationCommon.getCurrentPageId());settingsPage.container,ZPACommon.getMode();pageDiv.find("#newTemplateDiv").show();var keyPairIdJson="";keyPairIdJson=JSON.parse(JSON.stringify(TemplateCommon.keyPairIdJson));var employeeObjs={},userList=ZPeople.getUserListData();$.each(userList,function(cnt,empObj){"false"===empObj.isNonUser&&"false"===empObj.isMobileUser&&(employeeObjs[empObj.usererec]=empObj.name+" "+empObj.empid)});var fromObj=pageDiv.find("#fromMailAddr"),getFromList=fromObj.find("option").map(function(){return-1!==$(this).val().indexOf("ORGEMAIL")?JSON.parse($(this).val()).ID:$(this).val()}).get();$.each(data.fromEmailDtls,function(key,obj){if(-1===$.inArray(obj.orgEmailSetId,getFromList)){var opt=$("<option>",{value:'{"ID":"'+obj.orgEmailSetId+'","KEY":"ORGEMAIL"}',text:ZPI18N.getString("zp.orgemailtag")+" ("+obj.ORG_EMAIL+")"});fromObj.append(opt)}}),pageDiv.find("#fromAdd").data("domains",data.verifiedDom),data.system=employeeObjs,keyPairIdJson.system.Class="tab-pane fade active in",keyPairIdJson.system.parentClass="active";var popOverObjs=pageDiv.find("[targetid]");$.each(popOverObjs,function(i,obj){$(obj).attr("targetid");var addrPopOverHtml=AutomationCommon.contructMbox(data,keyPairIdJson,obj),popOverContent=$(addrPopOverHtml).clone();void 0===$(obj).data("bs.popover")?$(obj).setPopOver({callback:TemplateCommon.msgTempAddrFn,html:popOverContent,targetId:$(obj).attr("targetid"),keyname:"name=list-group-item",multi:!0}):$(obj).setContent(popOverContent)}),$(popOverObjs).data("data",!0)},displayUsers:function(){var pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[3].cardId);pageId.find("#notify_Mail").is(":checked")?pageId.find("#zsignNotifyUsers").parent().parent().removeClass("DN"):pageId.find("#zsignNotifyUsers").parent().parent().addClass("DN")},getZSignUserIntegDetails:function(){var params={conreqcsr:csrfToken};$.ajax({url:"/zpzsign/getZsignIntegDetails",type:"POST",data:params,success:function(data){Zsign.constructZSignUserSlider(data)},failure:function(data){Zsign.failedCallBack(data)}})},constructZSignUserSlider:function(integData){var pageId=settingsPage.container;Zsign.integDtls=integData,Zsign.initialintegDtls=integData;ZPI18N.getString("zp.searchemployee");for(var bodyHtml='<div id="zsign" class="zpl_mdl zpl_mmd zpl_mopen" data-modal-box="config_Zsign"><div class="zpl_minr"><div class="zpl_mhder"><div><h4>'+ZPI18N.getString("zp.zohosign")+'</h4><p class="zpl_secn">'+ZPI18N.getString("zp.ztoken1")+'</p></div><a class="_cls PI_cls" onClick="IntegrationSettings.close(\'zsign\')"></a></div><div class="zpl_mcnt"><div class="zpl_info"><h6>'+ZPI18N.getString("zp.ztokennoteheader")+"</h6><ul><li><em>"+ZPI18N.getString("zp.tokennote1")+"</em></li><li><em>"+ZPI18N.getString("zp.tokennote2")+"</em></li><li><em>"+ZPI18N.getString("zp.tokennote3")+'</em></li></ul></div><div class="zpl_secn"></div><div class=""><div class="zpl_tblfxd"><div class="zpl_btnmnu"><div class="zpl_rgt"><button onclick="Zsign.addUserPopup();" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.activeacct")+'</button></div><div id="doc_multiselDel" class="actn_ovrly"><div><button onclick="Zsign.removeUserToken();" class="zlabel zlabel--red zlabel--medium">'+ZPI18N.getString("zp.delete")+'</button></div><i class="PI_cls" onclick="Zsign.Esign.removeDeleteWhiteBand(\'zsignAddToken\');"></i></div></div><div class="zpl_rgtcnt"><div class="zpl_tblres wd100_per"><table class="zpl_tbl clm40"><thead><tr><th width="50"><div onclick="Zsign.Esign.checkAllRows(this,\'zsignAddToken\');" class="zcheckbox"><input id="addToken_chkBxAll" type="checkbox" name="check" value="" class="zcheckbox__helper"><label class="zcheckbox__label"></label></div></th><th>'+ZPI18N.getString("zp.activeaccounts")+"</th><th>"+ZPI18N.getString("zp.lms.gradeSetting.status")+'</th></tr></thead><tbody id="zsignTokenListing">',x=0;x<Zsign.integDtls[1].resp.length;x++)void 0!=Zsign.integDtls[1].resp[x].tobeDeleted&&Zsign.integDtls[1].resp[x].tobeDeleted||(bodyHtml+='<tr zuid="'+Zsign.integDtls[1].resp[x].zuid+'" status="'+Zsign.integDtls[1].resp[x].status+'"><td><div onclick="Zsign.Esign.checkParticularFiles(this,\'zsignAddToken\');" class="zcheckbox"><input type="checkbox" name="check" class="zcheckbox__helper"><label class="zcheckbox__label"></label></div></td><td><div class="zpl_em"><div class="zpl_emimg"><img src='+Zsign.integDtls[1].resp[x].empPhoto+'></div><div class="zpl_emdts"><div><em>'+ZSEC.Encoder.encodeForHTML(Zsign.integDtls[1].resp[x].empId)+"-</em><b>"+ZSEC.Encoder.encodeForHTML(Zsign.integDtls[1].resp[x].empName)+"</b></div><em>"+Zsign.integDtls[1].resp[x].email+"</em></div></div></td>",void 0==Zsign.integDtls[1].resp[x].inZohoSign?bodyHtml=bodyHtml+'<td class="red>'+ZPI18N.getString("zp.inactive")+" "+ZPI18N.getString("zp.in")+" "+ZPI18N.getString("zp.zohosign")+"</td>":void 0==Zsign.integDtls[1].resp[x].status?bodyHtml=bodyHtml+'<td class="red>'+ZPI18N.getString("zp.inactive")+"</td>":1==Zsign.integDtls[1].resp[x].status?bodyHtml=bodyHtml+'<td class="grn">'+ZPI18N.getString("zp.active")+"</td>":0==Zsign.integDtls[1].resp[x].status&&(bodyHtml=bodyHtml+'<td class="org">'+ZPI18N.getString("zp.emailsent")+"</td>"),0);bodyHtml+='</tbody></table></div></div></div></div></div><div class="zpl_mfoter zpl_mfotrht"><button type="button" revokeAll="true" onclick="Zsign.revokePopup(IntegrationSettings.revokeAuthenticatedService,this);" name="ZohoSign" class="zlabel zlabel--red zlabel--medium">'+ZPI18N.getString("zp.gtrevoke")+"</button></div></div></div>",pageId.append(bodyHtml)},addUserPopup:function(){var popupTab=new Tab("addZsignUser",Zsign.addUserHTML,Zsign.saveZsignUser);Zsign.ADDUSER=new popupModal(ZPI18N.getString("zp.activeacct"),popupTab),Zsign.ADDUSER.save=ZPI18N.getString("zp.confirm"),Zsign.ADDUSER.cancel=ZPI18N.getString("zp.cancel"),Zsign.ADDUSER.setCloseCallback(function(){Zsign.closeAddUser()}),Zsign.ADDUSER.construct(),ZPeopleComponents.tokenfield(settingsPage.container.find("#zsignUserDD"),Zsign.constructAddEmpList())},addUserHTML:function(){var html='<form><div class="zpl_crd"><div class="zpl_crdcnt">';html+='<div class="zpl_secn"><div><textarea id="zsignUserDD" class="tokenfieldId-js DN" style="width: 100%;"></textarea></div></div>',html+="</form></div></div>",$(settingsPage.mainWrapId).find("#cardaddZsignUser").html(html)},closeAddUser:function(){ZPeopleComponents.isComponent(settingsPage.container.find("#zsignUserDD"))&&ZPeopleComponents.tokenfield(settingsPage.container.find("#zsignUserDD")).destroy(),Zsign.ADDUSER.remove()},constructAddEmpList:function(){var tokenObj={};tokenObj.dataSource={search:function(params){return new Promise(function(success){success({results:EmployeeSearch.getEmpList(params.query,"emp","FILES_ESIGNLIST",[],{},!1,"",!0),more:!1})})},paginated:!0,serverSearch:!0},tokenObj.placeholder=ZPI18N.getString("zp.select");var dataMapping={value:"id",text:"value",id:"zuid",image:"image",emailId:"emailId"};return tokenObj.dataMapping=dataMapping,tokenObj.tokens={contentType:"image-text"},tokenObj.isLabelHTMLEncoded=!0,tokenObj.dropdownList={fitForElement:!0,moveOnScroll:!0,contentType:"image-text",isTextHTMLEncoded:!0,itemType:"checkbox"},tokenObj.search={retainKeyword:!1,by:["emailId","value","zuid"],minKeywordLength:"1",highlightKeyword:!0,showNoResultsMessage:!0},tokenObj.messages={noResults:ZPI18N.getString("zp.nomatchesfound")},tokenObj},constructAddEmpListSel:function(ele){var tokenObj={};tokenObj.dataSource={search:function(params){return new Promise(function(success){success({results:EmployeeSearch.getEmpList(params.query,"emp","FILES_ESIGNLIST",[],{},!1,"",!0),more:!1})})},paginated:!0,serverSearch:!0},tokenObj.placeholder=ZPI18N.getString("zp.select");var dataMapping={label:"value",value:"id",image:"image",email:"emailId"};return tokenObj.dataMapping=dataMapping,tokenObj.contentType="image-text",tokenObj.isLabelHTMLEncoded=!0,tokenObj.dropdownList={fitForElement:!0,moveOnScroll:!0,contentType:"image-text",isTextHTMLEncoded:!0},tokenObj.search={retainKeyword:!1,by:["emailId","value","zuid"],minKeywordLength:"1",highlightKeyword:!0,showNoResultsMessage:!0},tokenObj.messages={noResults:ZPI18N.getString("zp.nomatchesfound")},tokenObj},constructEmpTriggFilter:function(options){var tokenObj={};tokenObj.options=options,tokenObj.placeholder=ZPI18N.getString("zp.select");var dataMapping={label:"EMPNAME",value:"ERECNO"};return tokenObj.dataMapping=dataMapping,tokenObj.contentType="text",tokenObj.isLabelHTMLEncoded=!0,tokenObj.dropdownList={fitForElement:!0,moveOnScroll:!0,contentType:"text",isTextHTMLEncoded:!0},tokenObj.viewPerPage=4,tokenObj.lazyLoading=!0,tokenObj.bodyItemVisibleCount=3,tokenObj},constructFormList:function(options){var tokenObj={};tokenObj.options=options,tokenObj.placeholder=ZPI18N.getString("zp.select");var dataMapping={label:"dispName",tableName:"tableName",value:"formId"};return tokenObj.dataMapping=dataMapping,tokenObj.contentType="text",tokenObj.showSearchField=!0,tokenObj.dropdownList={fitForElement:!0,moveOnScroll:!0,contentType:"text"},tokenObj.messages={noResults:ZPI18N.getString("zp.nomatchesfound")},tokenObj.viewPerPage=4,tokenObj.lazyLoading=!0,tokenObj.bodyItemVisibleCount=3,tokenObj},saveZsignUser:function(){var existingList=settingsPage.container.find("#zsignTokenListing").find("tr"),tempArr=[],tobeAdded=[],idArray=ZPeopleComponents.tokenfield(settingsPage.container.find("#zsignUserDD")).getSelectedValuesId();if(!(idArray.length<=0)){for(var i=0;i<existingList.length;i++)tempArr.push($(existingList[i]).attr("zuid"));for(i=0;i<idArray.length;i++){var zuid=idArray[i];jQuery.inArray(zuid,tempArr)<=-1&&tobeAdded.push(zuid)}if(tobeAdded.length>0){var params={action:"scheduleTokenMail",conreqcsr:csrfToken,zuidArray:tobeAdded.toString()};$.ajax({url:"/zpzsign/scheduleTokenMail",type:"POST",data:params,success:function(data){Zsign.zsignGenerateTokenResp(data)},failure:function(data){Zsign.failedCallBack(data)}})}Zsign.closeAddUser()}},zsignGenerateTokenResp:function(resp){resp[1]?(ZPeople.Message.success(ZPI18N.getString("zp.zstokenschedule")),$(settingsPage.mainWrapId).find("#tabaddZsignUser").removeClass("zpl_mopen"),IntegrationSettings.close("zsign")):ZPeople.Message.failure(ZPI18N.getString("zp.lms.messages.unexpectederror"))},removeUserToken:function(){var deleteZuidArr=[],activeUserCount=settingsPage.container.find("#zsignTokenListing").find("tr[status='1']").length,deleteActiveZuidList=settingsPage.container.find("#zsignTokenListing").find("tr[status='1']").find("input[type='checkbox']:checked"),deleteZuidList=settingsPage.container.find("#zsignTokenListing").find("tr").find("input[type='checkbox']:checked");settingsPage.container.find("#zsignTokenListing").find("tr").find("input[type='checkbox']:checked").closest("tr")[0].getAttribute("status");if(deleteActiveZuidList.length!=activeUserCount){for(var i=0;i<deleteZuidList.length;i++){$(deleteZuidList[i]).parent().parent().parent().attr("status");deleteZuidArr.push($(deleteZuidList[i]).parent().parent().parent().attr("zuid"))}var params={action:"scheduleTokenMail",conreqcsr:csrfToken,delzuidArray:deleteZuidArr.toString()};$.ajax({url:"/zpzsign/scheduleTokenMail",type:"POST",data:params,success:function(data){Zsign.removeTokenCallback(data)},failure:function(data){Zsign.failedCallBack(data)}})}else ZPeople.Message.failure(ZPI18N.getString("zp.retainoneactiveuser"))},removeTokenCallback:function(resp){resp[1]?(ZPeople.Message.success(ZPI18N.getString("zp.deletetokenschedule")),IntegrationSettings.close("zsign")):ZPeople.Message.failure(ZPI18N.getString("zp.lms.messages.unexpectederror"))},revokePopup:function(callbackfn,zsObj){var deletePopUp=new DeleteAlertMessage;deletePopUp.title=ZPI18N.getString("zp.revokealltokens"),deletePopUp.despcription=ZPI18N.getString("zp.revokealltokensmess"),deletePopUp.yesButtonText=ZPI18N.getString("zp.confirm"),deletePopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),deletePopUp.callback=callbackfn,deletePopUp.parameter=zsObj,deletePopUp.show()},constructESignList:function(){settingsPage.container.html("")},constructZSTempList:function(){0==settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.append('<div id="esigntemplatesParent" class="zpl_mdl zpl_mlg zpl_mopen" data-modal-box="rightlarge"></div>');var pageId=$("#esigntemplatesParent");pageId.html("");var conhtml='<div class="zpl_minr" id="zsigntempList"><div class="zpl_mhder"><div><h4>'+ZPI18N.getString("zp.templates")+'</h4></div><a class="_cls PI_cls" onclick="Zsign.openZSTemplateSlider(\'close\')"></a></div><div class="zpl_mcnt zpl_fm" id="zsignIdScroll">';conhtml+='<div class="zpl_btnmnu P0I"><div id="doc_multiselDel" class="actn_ovrly DNI"><div class="zlabel zlabel--red zlabel--medium" onclick="Zsign.deleteAgreementConfirm(Zsign.deleteZSignTemp,undefined,\'first\',\'2\');">'+ZPI18N.getString("zp.delete")+'</div><i class="PI_cls" onclick="Zsign.Esign.removeDeleteWhiteBand(\'zsigntemplates\');"></i></div><div class="zpl_rgt">',conhtml+='<i class="zpl_ibg PI_fltr" onclick="Adobesign.hideAndShowFilterIC()"></i></div></div><div class="zpl_fltrvw DN"><div><ul class="zpl_fltrvwlst"></ul></div><div class="d-flexcap MLauto"><a class="red" onclick="Zsign.breadcrumb_remove(undefined, \'true\')">'+ZPI18N.getString("zp.reset")+"</a></div>",conhtml+='</div><div class="zpl_rgtcnt P0I"><div class="zpl_tblres"><table class="zpl_tbl" id="signtemplate_table"><thead><tr><th width="30">',conhtml+='<div class="zcheckbox" onclick=Zsign.Esign.checkAllRows(this,\'zsigntemplates\')><input type="checkbox" id="template_checkallbox"  class="zcheckbox__helper" name="check" value=""><label class="zcheckbox__label"></label></div>',conhtml+="</th><th>"+ZPI18N.getString("zp.templatename")+"</th> <th>"+ZPI18N.getString("zp.actions")+'</th></tr></thead><tbody id="signtemplate_list"><div class="DN" id="temp_norecords"></div></tbody>',conhtml+="</table></div></div>",conhtml+='<div class="zpl_fltr"><div><div class="zpl_fltrhd"><h5>'+ZPI18N.getString("zp.filter")+'</h5><i class="PI_cls" onclick="Adobesign.hideAndShowFilterIC(\'close\')"></i></div></div>',conhtml+='<div class="zpl_fltrcnt"><div><div class="zpl_fltclps fltopn"><div class="zpl_fltrlst"><div class="zpl_secn" id="search_view_flt"><div><label>'+ZPI18N.getString("zp.esign.docname")+"</label></div>",conhtml+='<div><div class=""><input placeholder='+ZPI18N.getString("zp.esign.docname")+' type="search" autocomplete="off" class="ztextbox" id="search_view" oninput="Zsign.searchAgreementsRecord()" onkeyup="Zsign.getETemplateList(event)"></div></div></div>',conhtml+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.from")+"</label></div>",conhtml+='<div><div class=""><input id="temp_sentfrom" data-format="date-short" data-calendar-icon="true" data-picker="true" data-clear-button="none" data-spin-buttons="none" data-width="258" style="display: none;"></div></div></div>',conhtml+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.to")+'</label></div><div><div class=""><input id="temp_sentto" data-format="date-short" data-calendar-icon="true" data-picker="true" data-clear-button="none" data-spin-buttons="none" data-width="258" style="display: none;"></div></div></div>',conhtml+='</div></div></div></div><div><button id="filtersubmit" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="Zsign.getETemplateList(\'\',\'\',\'search\')">'+ZPI18N.getString("zp.search")+"</button>",conhtml+='<button type="button" id="reset_envBtn" class="zlabel zlabel--outline zlabel--medium" onclick="Zsign.resetEsignTempFilter()">'+ZPI18N.getString("zp.reset")+"</button></div></div></div></div>",pageId.append(conhtml),settingsPage.container.addClass("zpl_tblfxd")},setZSDaysForReminder:function(mode){var checkBox;settingsPage.container;ZPSetupCommon.isEmpty(mode)?((checkBox=$("input#reminder_check")).prop("checked",!checkBox.prop("checked")),checkBox.is(":checked")?$("#reminder_setting, #reminder_freq").show():$("#reminder_setting, #reminder_freq").hide()):((checkBox=$("input#expire_check")).prop("checked",!checkBox.prop("checked")),checkBox.is(":checked")?$("#expire_setting, #warning").show():$("#expire_setting, #warning").hide())},showRemainderMode:function(mode){settingsPage.container;if(ZPSetupCommon.isEmpty(mode))(checkBox=$("input#reminder_check")).prop("checked",!checkBox.prop("checked")),checkBox.is(":checked")?($("#reminderrbtn").removeClass("disabled"),$("#weekly").removeAttr("Checked"),$("#daily").attr("Checked","Checked")):$("#reminderrbtn").addClass("disabled");else if("flow"===mode){(checkBox=$("input#senderSign")).prop("checked",!checkBox.prop("checked")),checkBox.is(":checked")?($("#senderSignFlow").removeClass("disabled"),$("#lastSign").removeAttr("Checked"),$("#firstSign").attr("Checked","Checked")):$("#senderSignFlow").addClass("disabled")}else if("preview"===mode){var checkBox;(checkBox=$("input#previewDoc")).prop("checked",!checkBox.prop("checked"))}},dropHandler:function(ev){if(ev.preventDefault(),ev.dataTransfer.items)for(var i=0;i<ev.dataTransfer.items.length;i++)if("file"===ev.dataTransfer.items[i].kind){ZPA_Esign.Uploadsource="localUpload",Zsign.fileUploadObj=ev.dataTransfer.items[i].getAsFile(),Zsign.attachmentConstructor(Zsign.fileUploadObj,"localUpload")}},attachmentConstructor:function(obj,uploadMode){var fileName="",fileSize="",id="",fileIconClass="PI_ft_unknwn";if(void 0!=obj&&void 0!=obj.detail){if(!("true"==$(obj.detail.item).attr("aria-selected")))return void($("[name='fileOutDiv']").find(".zpl_atchdtl h4").attr("selId")==obj.detail.itemData.tempId&&Zsign.deleteAttachment());id=obj.detail.itemData.value,void 0!=obj.detail.itemData.tempId&&(uploadMode="ztemplate",id=obj.detail.itemData.tempId)}if(void 0!=uploadMode&&"localUpload"===uploadMode)fileName=obj.name,fileSize=ZP_Mailmerge.bytesToSize(obj.size),fileIconClass="PI_desktop";else if(void 0!=uploadMode&&"ztemplate"==uploadMode)fileName=obj.detail.itemData.label,fileIconClass="PI_Template";else if(void 0!=CloudPicker.fileObj&&"zsign"==CloudPicker.cloudUploadOrigin){ZPA_Esign.uploadMode="cloudUpload",fileIconClass="PI_cloud";var fileObj=JSON.parse(CloudPicker.fileObj);if("gdrive"==fileObj.provider&&void 0!=fileObj.mimeType&&"application/vnd.google-apps.folder"==fileObj.mimeType)return void ZPeople.Message.warning("Folder upload not supported. Please choose a valid file");fileName=decodeURIComponent(fileObj.docName)}fileName.split(".").pop();var html="<div><h5>"+ZPI18N.getString("zp.attachmentfiles")+'</h5></div><div><div class="zpl_atchd"><div name="fileOutDiv"><div class="zpl_atchimg"><i class='+fileIconClass+'></i></div><div class="zpl_atchdtl"><h4 id="fileName" source ="'+uploadMode+'" selId="'+id+'" data-toggle="tooltip" title="'+ZSEC.Encoder.encodeForHTML(fileName)+'" data-placement="bottom" >'+ZSEC.Encoder.encodeForHTML(fileName)+'</h4><p><span id="fileSize">'+fileSize+'</span></p></div><div class="zpl_atchicn"><i class="PI_delete" onclick="Zsign.deleteAttachment(this)"></i></div></div></div>';document.getElementById("uploadSection").style.display="none",document.getElementById("attachments").innerHTML=html,"ztemplate"==uploadMode&&Zsign.getZSignTempValues(id)},attachmentSignTempConstructor:function(id,fileName){var extension=fileName.split(".").pop(),html='<div><div class="zpl_atchd"><div name="fileOutDiv" class="disabledbg"><div class="zpl_atchimg"><i class='+Zsign.Esign.getFileIcon(extension)+'></i></div><div class="zpl_atchdtl"><h4 id="fileName" >'+ZSEC.Encoder.encodeForHTML(fileName)+'</h4></div><div class="zpl_atchicn"></div></div></div>';$("#"+id).find("#attachments").append(html)},deleteAttachment:function(thisObj){$(thisObj).closest("[name='fileOutDiv']").find(".zpl_atchdtl h4").attr("selId"),$(thisObj).closest("[name='fileOutDiv']").find(".zpl_atchdtl h4").attr("source");document.getElementById("uploadSection").style.display="block",document.getElementById("attachments").innerHTML="",ZPA_Esign.resetuploadValues(),Zsign.fileUploadObj={}},recpRowsReset:function(){ZPA_Esign.recpRowId=0,Zsign.recpRowId=0;var pageId="",isEsign=!1;if(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(pageId=$("#esignforms_card"),ZPeopleComponents.button(pageId.find("#addRecpbtn")).setAttribute("disabled",!1),pageId.find("#addRecpbtn").attr("onclick",'Zsign.addRecpRows("userbtnId")')):(pageId=$("#"+ZPA_Esign.Slider.esflowModal.tabs[1].cardId)).find("#addUserbtn").length>0&&(ZPeopleComponents.button(pageId.find("#addUserbtn")).setAttribute("disabled",!1),isEsign=!0,pageId.find("#addUserbtn").attr("onclick","ZPA_Esign.Slider.addRecp()")),pageId.has("div").length>0){var recprowLen=pageId.find("#recp_rows").find("[name='recp_row']").length;if(isEsign&&(recprowLen=$("#esbdy_recp").find("#recpRows").find("[name='recp_row']").length),recprowLen>0)for(var ele=0;ele<recprowLen;ele++){var selId=pageId.find("[name='recpType']")[ele].id.split("_")[1];if(ZPeopleComponents.isComponent(pageId.find("#recpType_"+selId))&&ZPeopleComponents.select(pageId.find("#recpType_"+selId)).destroy(),isZSConfig&&ZPeopleComponents.isComponent(pageId.find("#recpLocale_"+selId))&&ZPeopleComponents.select(pageId.find("#recpLocale_"+selId)).destroy(),ZPeopleComponents.isComponent(pageId.find("#recpFormValue_"+selId))&&ZPeopleComponents.select(pageId.find("#recpFormValue_"+selId)).destroy(),ZPeopleComponents.isComponent(pageId.find("#recpFieldValue_"+selId))&&ZPeopleComponents.select(pageId.find("#recpFieldValue_"+selId)).destroy(),isZSConfig){if(pageId.find("#verifyOn_"+selId).length>0){var verId=pageId.find("#verifyOn_"+selId)[0].id;pageId.find("#verifyOn_"+selId).attr("toRemove",!1),ZPeopleComponents.isComponent(pageId.find("#"+verId))&&ZPeopleComponents.toggleswitch(pageId.find("#"+verId)).destroy()}if(pageId.find("#recpHost_"+selId).length>0){var hostId=pageId.find("#recpHost_"+selId)[0].id;ZPeopleComponents.isComponent(pageId.find("#"+hostId))&&ZPeopleComponents.select(pageId.find("#"+hostId)).destroy(),pageId.find("#"+hostId).parent().parent().closest("[name='hostRow']").remove()}$("#privateMesspop_"+selId).length>0&&($("#privateMesspop_"+selId).val(""),$("#tabprivMessPopup_"+selId).remove())}}if(isZSConfig){var recpNameLen=pageId.find($('[id^="recpName"]')).length;if(recpNameLen>0)for(ele=0;ele<recpNameLen;ele++){var eleId=pageId.find("[name=recpName]")[0].id.split("_")[1];pageId.find($("#recpName_"+eleId)).length>0&&pageId.find($("#recpName_"+ele)).parent().parent().remove()}}}void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?Zsign.addRecpRows("userbtnId"):ZPA_Esign.Slider.addRecp(0)},removeElementsfn:function(){Zsign.recpRowId=0,Zsign.editSignTempId="",Zsign.compSignFileId="",Zsign.selectedRecpForm=null;var pageId="";if(pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")?$("#esignorg_card"):"0"==FilesUtil.Page.getTabGroup()?$("#cardesignfiles"):$("#esign_card"),ZPeopleComponents.select(pageId.find("select#agrselect_Cat")).destroy(),isZSConfig&&(pageId.find("#signing_order").removeAttr("Checked"),pageId.find("select#hrfileopt").length>0&&ZPeopleComponents.select(pageId.find("select#hrfileopt")).destroy(),pageId.find("select#dateFieldOpt").length>0&&ZPeopleComponents.select(pageId.find("select#dateFieldOpt")).destroy(),pageId.find("select#addtoformfieldselect").length>0&&ZPeopleComponents.select(pageId.find("select#addtoformfieldselect")).destroy(),pageId.find("select#hrfileopt").length>0&&ZPeopleComponents.select(pageId.find("select#hrfileopt")).destroy()),pageId.has("div").length>0){var recprowLen=$('[name^="recp_row"]').length;if(recprowLen>0)for(var ele=0;ele<recprowLen;ele++){var eleId=pageId.find("[name=recpType]")[ele].id.split("_")[1];if(ZPeopleComponents.isComponent(pageId.find("#"+$('[id^="recpType"]')[eleId].id))&&ZPeopleComponents.select(pageId.find("#"+$('[id^="recpType"]')[eleId].id)).destroy(),isZSConfig&&ZPeopleComponents.isComponent(pageId.find("#"+$('[id^="recpLocale"]')[eleId].id))&&ZPeopleComponents.select(pageId.find("#"+$('[id^="recpLocale"]')[eleId].id)).destroy(),ZPeopleComponents.isComponent(pageId.find("#"+$('[id^="recpEmailValue"]')[eleId].id))&&ZPeopleComponents.select(pageId.find("#"+$('[id^="recpEmailValue"]')[eleId].id)).destroy(),ZPeopleComponents.isComponent(pageId.find("#"+$('[id^="recpFormValue"]')[eleId].id))&&ZPeopleComponents.select(pageId.find("#"+$('[id^="recpFormValue"]')[eleId].id)).destroy(),ZPeopleComponents.isComponent(pageId.find("#"+$('[id^="recpFieldValue"]')[eleId].id))&&ZPeopleComponents.select(pageId.find("#"+$('[id^="recpFieldValue"]')[eleId].id)).destroy(),isZSConfig){if($("#verifyOn_"+ele).length>0){var verId=$("#verifyOn_"+ele)[0].id;$("#verifyOn_"+ele).attr("toRemove",!1),ZPeopleComponents.isComponent($("#"+verId))&&ZPeopleComponents.toggleswitch($("#"+verId)).destroy(),$("#tabauthPopup_"+ele).remove(),$("#cardauthPopup_"+ele).remove()}if($("#privateMesspop_"+eleId).length>0&&($("#privateMesspop_"+eleId).val(""),$("#tabprivMessPopup_"+eleId).remove()),pageId.find($("#recpHost_"+eleId)).length>0){var hostId=pageId.find($("#recpHost_"+eleId))[0].id;ZPeopleComponents.isComponent(pageId.find("#"+hostId))&&ZPeopleComponents.select(pageId.find("#"+hostId)).destroy()}}}if(isZSConfig){var recpNameLen=pageId.find($('[id^="recpName"]')).length;if(recpNameLen>0)for(ele=0;ele<recpNameLen;ele++)if(void 0!=pageId.find("[name=recpType]")[ele]){eleId=pageId.find("[name=recpType]")[ele].id.split("_")[1];pageId.find($("#recpName_"+eleId)).parent().parent().remove()}pageId.find($('[name="emrepmngr"]')).length>0&&pageId.find($('[name="emrepmngr"]')).remove(),ZPA_Esign.Slider.removeMergeFields()}else isAdobeConfig&&ZPeopleComponents.select(pageId.find("#selectLang")).destroy()}pageId.parent().parent().remove(),Zsign.resetSliderValues()},assignMMTempInDropDwn:function(){ZPeopleComponents.dropdownlist("#TemplateOptionsList",{sort:!0,viewPerPage:4,lazyLoading:!0,filterByCSSSelector:!1,items:ZPA_Esign.constructTempListJSON(ZP_Mailmerge.templateIds),selectionLimit:1,dataMapping:{text:"label",name:"label",value:"id",groupLabel:"viewtype",id:"id"},contentType:"text",sortOrder:"asc",showSearchField:!0,position:"bottom",search:{by:"label",criteria:"contains",highlightKeyword:!0},searchFieldOptions:{placeholder:"Search",clearButton:!1},title:ZPI18N.getString("zp.esign.mailmerge.small"),focusItemOnItemMouseover:!0,itemclick:ZPA_Esign.attachmentConstructor,dropdownList:{itemType:"checkbox"},bodyItemVisibleCount:3,checkbox:!0,checkedIconPosition:"left",multiple:!1})},initilizeFormComponents:function(formId){Zsign.getFormCompFields(formId,"workflow"),ZP_Mailmerge.constructMMTempList("workflow",formId,"1","","","",Zsign.assignMMTempInDropDwn),ZPeopleComponents.dropdownlist("#fileRoleOptionsList",{sort:!0,viewPerPage:4,lazyLoading:!0,filterByCSSSelector:!1,items:ZPA_Esign.constructFormFieldsJSON(Zsign.fileuploadfield.formId,!0),selectionLimit:1,dataMapping:{text:"label",name:"label",value:"value",groupLabel:"viewtype",id:"value",fileId:"value"},contentType:"text",sortOrder:"asc",showSearchField:!0,position:"bottom",search:{by:"label",criteria:"contains",highlightKeyword:!0},searchFieldOptions:{placeholder:"Search",clearButton:!1},title:ZPI18N.getString("zp.esign.fileuploadfield"),focusItemOnItemMouseover:!0,itemclick:ZPA_Esign.attachmentConstructor,dropdownList:{itemType:"checkbox"},bodyItemVisibleCount:3,checkbox:!0,checkedIconPosition:"left",multiple:!1}),isZSConfig&&(Zsign.checkZSFeature(),Zsign.zsFeatureList.templates&&ZPA_Esign.getZSignTemplates(formId),ZPeopleComponents.dropdownlist("#zsignTempOptionsList",{sort:!0,viewPerPage:4,"lazyLoading\t":!0,filterByCSSSelector:!1,items:ZPA_Esign.constructZSignTempList(ZPA_Esign.ZSignTempList),selectionLimit:1,dataMapping:{text:"label",name:"label",value:"id",groupLabel:"viewtype",id:"id"},contentType:"text",sortOrder:"asc",showSearchField:!0,position:"bottom",search:{by:"label",criteria:"contains",highlightKeyword:!0},searchFieldOptions:{placeholder:"Search",clearButton:!1},title:ZPI18N.getString("zp.esign.zsigntemplate"),focusItemOnItemMouseover:!0,itemclick:ZPA_Esign.attachmentConstructor,dropdownList:{itemType:"checkbox"},bodyItemVisibleCount:3,checkbox:!0,checkedIconPosition:"left",multiple:!1}),Zsign.changeConfiguration(formId))},constructSendForOrgSign:function(mode,fileId,templateId){Zsign.resetFormSliderValues();var formData=new FormData,sliderParams={id:"esignorg",cardId:"esignorg_card"},content=Zsign.add.bodyNewOrgSlider;sliderParams.callback=function(){$(settingsPage.mainWrapId).find("#"+sliderParams.cardId).html(content)},sliderModalObj=new sliderModal(ZPI18N.getString("zp.setupsignature"),sliderParams),sliderModalObj.mediumSize=!0,sliderModalObj.setCloseCallback(function(){Zsign.removeElementsfn(),sliderModalObj.remove()});var footerContent='<button id="slidernxt" onclick=Zsign.sendDocument() type="button" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.save")+'</button> <button id="sliderCancel" type="button" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.cancel")+"</button>";sliderModalObj.construct(void 0,footerContent),$("#esignorg_card").removeClass("zpl_fm"),"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")||"edit"===mode?$(settingsPage.mainWrapId).find("#esignorg").find("#sliHdrDiv").find("h4").text(ZPI18N.getString("zp.editsignature")):$(settingsPage.mainWrapId).find("#esignorg").find("#sliHdrDiv").find("h4").text(ZPI18N.getString("zp.setupsignature")),(formData=new FormData).append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),ZPA_Esign.openFilter(formData),"edit"!=mode&&Zsign.addRecpRows("userbtnId",0),$("#optionHeader").show(),$("#recpHeader").show(),$("#esignorg #sliFootDiv #sliderCancel").show(),$("#esignorg #sliFootDiv #slidernxt").show(),$("#esignorg_card").show(),$("#esignorg").removeClass("zpl_mfull"),$("#esignorg div#embed_iframe").hide(),$("#esignorg #basicDetails").removeClass("DNI"),$("#esignorg #docHeader").removeClass("DNI"),$("#esignorg #recipientsSec").removeClass("DNI"),$("#esignorg #otherOptsec").removeClass("DNI"),$("#esignorg #expirySec").removeClass("DNI"),$("#esignorg #sliFootDiv #sliderSbt").unbind().click(Zsign.setSendDocumentFn);var fileName="";"1"==FilesUtil.Page.getTabGroup()?fileName=$("td[fileid="+fileId+"]").attr("filename"):"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")&&(fileName=$("td div[id="+fileId+"]").attr("name")),Zsign.compSignFileId=fileId,"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")&&(fileName=settingsPage.container.find("tr[tempid="+templateId+"]").data().ldata.name),Zsign.attachmentSignTempConstructor(sliderParams.cardId,fileName),"edit"==mode&&Zsign.callActionData(templateId,fileId,!0)},sendForSignDocs:function(formId,recordIds){recordIds.length>20?ZPeople.Message.failure(ZPI18N.getString("zp.formagreementlimitexceed")):Zsign.constructSendForFormsSign("forms",formId,recordIds)},constructSendForFormsSign:function(modeVal,formId,recordIds){var formData=new FormData,sliderParams={},innerForm=!1;void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId&&(innerForm=!0),sliderParams.id="esignforms",CloudPicker.init("esignforms",Zsign.attachmentConstructor),sliderParams.cardId="esignforms_card";var content="";void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),isAdobeConfig?(content+=Adobesign.add.bodyNewFormsSlider,content+=Adobesign.add.bodyCont):isDocuConfig?(content+=Docusign.add.bodyNewFormsSlider,content+=Docusign.add.bodyCont):isZSConfig&&(content+=Zsign.add.bodyNewFormsSlider),sliderParams.callback=function(){$(settingsPage.mainWrapId).find("#"+sliderParams.cardId).html(content)},sliderModalObj=new sliderModal(ZPI18N.getString("zp.esign.requestsignature"),sliderParams),sliderModalObj.mediumSize=!0,sliderModalObj.setCloseCallback(function(){Zsign.removeElementsfn(),sliderModalObj.remove()});var footerContent='<button id="sliderSbt" type="button" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.send")+'</button> <button id="sliderCancel" type="button" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.cancel")+"</button>";if(sliderModalObj.construct(void 0,footerContent),(formData=new FormData).append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),null!=formId&&void 0!=formId&&formData.append("formId",formId),null!=recordIds&&void 0!=recordIds&&formData.append("recList",recordIds),ZPA_Esign.openFilter(formData),Zsign.initilizeFormComponents(formId),$("#esignforms_card").removeClass("zpl_fm"),Zsign.addRecpRows("userbtnId",0),$("#optionHeader").show(),$("#recpHeader").show(),$("#basicDetails").show(),$("#docHeader").show(),$("#redirection").show(),isAdobeConfig){var langOptions=Adobesign.constructLanguage();ZPeopleComponents.select("#esignforms_card #selectLang",langOptions),ZPeopleComponents.select("#esignforms_card #selectLang").setAttribute("selectedValue","en_US"),innerForm?$("#esignforms_card #showDocPreview").removeClass("zpl_op5 zpl_evntno"):$("#esignforms_card #showDocPreview").addClass("zpl_op5 zpl_evntno")}ZPeopleComponents.datefield("#esignforms_card #deadline",{format:dateFmt,pickerOptions:{appendTo:"#esignforms_card #dlParent"}}),$("#esignforms").removeClass("zpl_mfull"),$("#esignforms #sliFootDiv").show(),$("#esignforms #sliFootDiv #sliderCancel").show(),$("#esignforms #sliFootDiv #sliderSbt").show(),$("#esignforms_card").show(),$("#esignforms #sliFootDiv #sliderSbt").unbind().click(Zsign.setSendDocumentFn),$("#esignforms").attr("style","z-index: 105;"),$("#tabaddFolderPopUp_Files").attr("style","z-index: 106;")},setSendDocumentFn:function(){isAdobeConfig?Adobesign.createAgreement():isDocuConfig?Docusign.sendEnvelope():isZSConfig&&Zsign.sendDocument()},constructSendForSign:function(){Zsign.resetFormSliderValues();var pageId="";pageId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?$("#esignforms_card"):"1"==FilesUtil.Page.getTabGroup()||"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")?$("#esignorg_card"):"0"==FilesUtil.Page.getTabGroup()?$("#cardesignfiles"):$("#esign_card");var formData=new FormData,sliderParams={id:"esign"};CloudPicker.init("esign",Zsign.attachmentConstructor,"zsign"),sliderParams.cardId="esign_card";var content="";void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),isAdobeConfig?(content+=Adobesign.add.bodyFormCont,content+=Adobesign.add.bodyCont):isDocuConfig?(content+=Docusign.add.bodyFormCont,content+=Docusign.add.bodyCont):isZSConfig&&(content+=Zsign.add.bodyNewSlider),sliderParams.callback=function(){$(settingsPage.mainWrapId).find("#"+sliderParams.cardId).html(content)},sliderModalObj=new sliderModal(ZPI18N.getString("zp.esign.requestsignature"),sliderParams),sliderModalObj.mediumSize=!0,sliderModalObj.setCloseCallback(function(){Zsign.removeElementsfn(),sliderModalObj.remove()});var footerContent='<button id="sliderSbt" type="button" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.send")+'</button> <button id="sliderCancel" type="button" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.cancel")+"</button>";if(sliderModalObj.construct(void 0,footerContent),(formData=new FormData).append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&formData.append("formId",ZP5Form.getCurrFormsOperation().formId),void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams().recordId&&void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId?formData.append("recordId",ZP5Form.getFormClassObj().getParams().recordId):Zsign.ESIGN_FORMS_RECORD_IDS.length>0&&formData.append("recList",Zsign.ESIGN_FORMS_RECORD_IDS.toString()),ZPA_Esign.openFilter(formData),$("#esign_card").removeClass("zpl_fm"),Zsign.addRecpRows("userbtnId",0),$("#esign_card").show(),pageId.find("#basicDetails, #docHeader, #recpHeader,#optionHeader, #moreSettings").removeClass("DNI"),$("#redirection").show(),isAdobeConfig){var langOptions=Adobesign.constructLanguage();ZPeopleComponents.select("#esign_card #selectLang",langOptions),ZPeopleComponents.select("#esign_card #selectLang").setAttribute("selectedValue","en_US")}document.getElementById("localUpload").addEventListener("click",function(){ZPA_Esign.uploadMode="localUpload",$("#esign_card #uploadFile").trigger("click")},!1),document.getElementById("uploadFile").addEventListener("change",function(){Zsign.fileUploadObj=this.files[0],Zsign.attachmentConstructor(Zsign.fileUploadObj,ZPA_Esign.uploadMode)},!1),ZPeopleComponents.datefield("#esign_card #deadline",{format:dateFmt,pickerOptions:{appendTo:"#esign_card #dlParent"}}),$("#esign #sliFootDiv #sliderCancel").show(),$("#esign #sliFootDiv #sliderSbt").show(),$("#esign #sliFootDiv #sliderSbt").unbind().click(Zsign.setSendDocumentFn)},constructSendForFilesSign:function(fileId){Zsign.resetFormSliderValues();var formData=new FormData,content="";void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),isAdobeConfig?(content+=Adobesign.add.bodyNewFilesSlider,content+=Adobesign.add.bodyCont):isDocuConfig?(content+=Docusign.add.bodyNewFilesSlider,content+=Docusign.add.bodyCont):isZSConfig&&(content+=Zsign.add.bodyFilesSlider);var popupTab=new Tab("esignfiles",function(){$(settingsPage.mainWrapId).find("#cardesignfiles").html(content)},Zsign.sendDocument);$("#tabesignfiles #sliFootDiv").show(),sliderModalObj=new sliderModal(ZPI18N.getString("zp.esign.requestsignature"),popupTab),sliderModalObj.mediumSize=!0,sliderModalObj.setCloseCallback(function(){Zsign.removeElementsfn(),sliderModalObj.remove()});var footerContent='<button id="sliderSbt" type="button" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.send")+'</button> <button id="sliderCancel" type="button" class="zlabel zlabel--outline zlabel--medium">'+ZPI18N.getString("zp.cancel")+"</button>";if(sliderModalObj.construct(void 0,footerContent),sliderModalObj.construct(),settingsUrlProps.url.indexOf("-catId")>-1?$(settingsPage.mainWrapId).find("#cardesignfiles").find("#attachmentHdrSendSign").text(ZPI18N.getString("zp.files.operations.attachedfile")):$(settingsPage.mainWrapId).find("#cardesignfiles").find("#attachmentHdrSendSign").text(ZPI18N.getString("zp.esign.uploadfile")),$("#cardesignfiles").removeClass("zpl_fm"),$("#esignfiles").removeClass("zpl_mfull"),Zsign.addRecpRows("userbtnId",0),$("#cardesignfiles").show(),$("#optionHeader").show(),$("#recpHeader").show(),$("#basicDetails").show(),$("#docHeader").show(),$("#redirection").show(),(formData=new FormData).append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&formData.append("formId",ZP5Form.getCurrFormsOperation().formId),void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams().recordId&&void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId?formData.append("recordId",ZP5Form.getFormClassObj().getParams().recordId):Zsign.ESIGN_FORMS_RECORD_IDS.length>0&&formData.append("recList",Zsign.ESIGN_FORMS_RECORD_IDS.toString()),ZPA_Esign.openFilter(formData),isAdobeConfig){var langOptions=Adobesign.constructLanguage();ZPeopleComponents.select("#cardesignfiles #selectLang",langOptions),ZPeopleComponents.select("#cardesignfiles #selectLang").setAttribute("selectedValue","en_US")}ZPeopleComponents.datefield("#cardesignfiles #deadline",{format:dateFmt,pickerOptions:{appendTo:"#cardesignfiles #dlParent"}}),Zsign.compfileId=fileId;var fileName=$("td[fileid="+fileId+"]").attr("filename");Zsign.attachmentSignTempConstructor("cardesignfiles",fileName),$("#tabesignfiles #sliFootDiv #sliderCancel").show(),$("#tabesignfiles #sliFootDiv #sliderSbt").show(),$("#tabesignfiles #sliFootDiv #sliderSbt").unbind().click(Zsign.setSendDocumentFn)},openZSTemplateSlider:function(mode){var parentId=settingsPage.container;void 0==mode||""==mode||"close"!=mode?0==parentId.find("#esigntemplatesParent").length?Zsign.zsTempInit():parentId.find("#esigntemplatesParent").addClass("zpl_mopen"):parentId.find("#esigntemplatesParent").removeClass("zpl_mopen")},setExpiryPop:function(serviceCode){var method;return"2"==serviceCode?method=Adobesign.showRecalPop(!0):"4"==serviceCode?method=Docusign.showRecalPop(!0):"6"==serviceCode&&(method=Zsign.showRecalPop(!0)),method},constructZDocumentList:function(serviceName,serviceCode){var pageId=settingsPage.container;if(0==pageId.find("#doc_multiselDel").length){pageId.html("");var conhtml='<div class="zpl_btnmnu"><div id="doc_multiselDel" class="DNI actn_ovrly"><div><div class="zlabel zlabel--red zlabel--medium" onclick=Zsign.deleteAgreementConfirm(Zsign.deleteAgreementRecord,this,"first","1")>'+ZPI18N.getString("zp.delete")+'</div><div id="extendbulk" class="DN zlabel zlabel--blue zlabel--outline zlabel--medium" onclick=Zsign.showExpiryPop(true)>'+ZPI18N.getString("zp.extend")+'</div><div id="recallbulk" class="DN zlabel zlabel--blue zlabel--outline zlabel--medium" onclick="Zsign.showRecalPop(true)">'+ZPI18N.getString("zp.recall")+'</div></div><i class="PI_cls" onclick="Zsign.Esign.removeDeleteWhiteBand(\'documents\');"></i></div><div><select class="ztextbox" id="zp_esign_view"></select></div><div id="right_options_esign" class="zpl_rgt">';conhtml+='<button data-popup-open="file_addEsign" id="create_agr" class="zlabel zlabel--blue zlabel--medium" onclick="Zsign.constructSendForSign()">'+ZPI18N.getString("zp.requestsignature")+"</button>",conhtml+='<i class="zpl_ibg PI_fltr" onclick="Adobesign.hideAndShowFilterIC()" data-title-position="bottom" title="'+ZPI18N.getString("zp.filter")+'"></i><i class="zpl_ibg PI_Template DNI"  id="zsignTempListIcon" data-title-position="bottom" title="'+ZPI18N.getString("zp.templates")+'" onclick="Zsign.openZSTemplateSlider()"></i><div id="exportList" onClick="Zsign.showExportDropdown()" class="" aria-expanded="false" data-title-position="bottom" title="'+ZPI18N.getString("zp.files.operations.moreactions")+'"><i type="button" data-menu-id="ddmore" class="zpl_ibg zpl_drpdwn-js PI_more"></i></div><div id="exportOptListDrop"></div></div></div></div>',conhtml+='<div class="zpl_fltrvw DN"><div><ul class="zpl_fltrvwlst"></ul></div><div class="d-flexcap MLauto"><a class="red" onclick="Zsign.breadcrumb_remove(undefined, \'true\')">'+ZPI18N.getString("zp.reset")+"</a></div></div>",conhtml+='<div class="zpl_rgtcnt"><div class="zpl_tblres"><table class="zpl_tbl" id="documents_table"><thead><tr><th width="30">',conhtml+='<div class="zcheckbox" onclick=Zsign.Esign.checkAllRows(this,\'documents\')><input type="checkbox" id="documents_checkallbox" name="check" value="" class="zcheckbox__helper"><label class="zcheckbox__label"></label></div>',conhtml+="</th><th>"+ZPI18N.getString("zp.esign.docname")+'<div class="zpl_icncnt"><i id="sort_fileName" class="PI_sort" data-title-position="bottom" title="'+ZPI18N.getString("zp.sort")+'" onclick="Zsign.Esign.toggleSortSign(this,\''+serviceCode+"');\"></i></div></th><th>"+ZPI18N.getString("zp.reciepents")+"</th><th>"+ZPI18N.getString("zp.datesent",new Array(""))+'<div class="zpl_icncnt"><i id="sort_sentDate" class="PI_sort" data-title-position="bottom" title="'+ZPI18N.getString("zp.sort")+'" onclick="Zsign.Esign.toggleSortSign(this,\''+serviceCode+"');\"></i></div></th><th>"+ZPI18N.getString("zp.folder")+"</th><th>"+ZPI18N.getString("zp.status")+'</th><th style="min-width: 120px;">'+ZPI18N.getString("zp.actions")+'</th></tr></thead><tbody id="documents_list"><div class="DNI" id="document_norecords"></div></tbody>',conhtml+='</table><table class="zpl_tbl DN" id="wfdocuments_table"><thead><tr>',conhtml+="<th>"+ZPI18N.getString("zp.workflow.workflowname")+"</th><th>"+ZPI18N.getString("zp.esignconfigname")+"</th><th>"+ZPI18N.getString("zp.formname")+"</th><th>"+ZPI18N.getString("zp.triggeredby")+"</th><th>"+ZPI18N.getString("zp.executedtime")+"</th><th>"+ZPI18N.getString("zp.status")+"</th>",conhtml+='</tr></thead><tbody id="wfdocuments_list"><div class="DNI" id="wfdocument_norecords"></div></tbody>',conhtml+="</table></div></div>",conhtml+='<div id="zsignPageFlt" class="zpl_fltr"><div><div class="zpl_fltrhd"><h5>'+ZPI18N.getString("zp.filter")+'</h5><i class="PI_cls" onclick="Adobesign.hideAndShowFilterIC(\'close\')"></i></div>',conhtml+='<div class="zpl_secn" id="search_view_flt"><div><label>'+ZPI18N.getString("zp.view")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_view"></select></div></div></div>',conhtml+='<div class="zpl_fltrcnt"><div><div class="zpl_fltclps fltopn"><div class="zpl_fltrlst">',conhtml+='<div class="zpl_secn" id="esignwfstatus"><div><label>'+ZPI18N.getString("zp.status")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_wfstatus"></select></div></div>',conhtml+='<div class="zpl_secn" id="formlist"><div><label>'+ZPI18N.getString("zp.formname")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_form"></select></div></div>',conhtml+='<div class="zpl_secn" id="emailIdsearch"><div><label>'+ZPI18N.getString("zp.email")+'</label></div><div class=""><input placeholder="'+ZPI18N.getString("zp.email")+'" type="search" autocomplete="off" class="ztextbox" id="emailId_search"></div></div>',conhtml+='<div class="zpl_secn" id="recordIdsearch"><div><label>'+ZPI18N.getString("zp.historyExportRecordId")+'</label></div><div class=""><input placeholder="'+ZPI18N.getString("zp.enterrecordid")+'" type="search" autocomplete="off" class="ztextbox" id="recordId_search"></div></div>',conhtml+='<div class="zpl_secn" id="perfrmdbylist"><div><label>'+ZPI18N.getString("zp.triggeredby")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_perfrmdemp" type="text"  data-show-search-field="true" filterByCSSSelector="false" dropdownList.position="bottom" data-lazy-loading="true" data-view-per-page ="5" class="ztextbox" value=""></select></div></div>',conhtml+='<div class="zpl_secn" id="search_nameHeader"><div><label>'+ZPI18N.getString("zp.esign.docname")+"</label></div>",conhtml+='<div class=""><input placeholder='+ZPI18N.getString("zp.esign.docname")+' type="search" autocomplete="off" class="ztextbox" id="search_documentname"></div></div><div class="zpl_secn" id="docfoldergroup"><div><label>'+ZPI18N.getString("zp.folder")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_cat"></select></div></div>',conhtml+='<div class="zpl_secn" id="esignstatus"><div><label>'+ZPI18N.getString("zp.status")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_status"></select></div></div>',conhtml+='<div class="zpl_secn" id="fromDatefilter"><div><label>'+ZPI18N.getString("zp.from")+"</label>",conhtml+='</div><div><input name="doc_sentfrom" data-format="date-short" data-calendar-icon="true" data-picker="true"  data-clear-button="none"  data-spin-buttons="none" data-width="258" id="doc_sentfrom" autocomplete="off" onclick="Calendar.setUpCalendar(event,this)" caltype="popup" placeholder="Choose Date" type="text">',conhtml+="</div></div>",conhtml+='<div class="zpl_secn" id="toDatefilter"><div><label>'+ZPI18N.getString("zp.to")+'</label></div><div><input id="doc_sent_to_btn" data-format="date-short" data-calendar-icon="true" data-picker="true" data-clear-button="none" data-spin-buttons="none" data-width="258" style="display: none;">',conhtml+='</div></div></div></div></div></div><div><button id="filtersubmit" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="Zsign.getESignList(\'\',\'\',\'search\')">'+ZPI18N.getString("zp.search")+"</button>",conhtml+='<button type="button" id="reset_envBtn" class="zlabel zlabel--outline zlabel--medium" onclick="Zsign.resetFilter();Zsign.searchAgreementsRecord();">'+ZPI18N.getString("zp.reset")+"</button></div></div>",pageId.append(conhtml),settingsPage.container.addClass("zpl_tblfxd"),Zsign.setEsignViewfilter("zp_esign_view");var id="exportMode";ZPI18N.getString("zp.export");let actionsList=[];actionsList.push({id:"exportMode",label:ZPI18N.getString("zp.export"),iconClass:"PI_exprt"}),id="exportOptListDrop";var tokenObj={direction:"bottom-right",contentType:"icon-text",forElement:"#exportList"};tokenObj.itemclick=Zsign.Esign.exportFiles,ZPeopleComponents.createMenu(id,actionsList,tokenObj)}},zsTempInit:function(){var params={conreqcsr:csrfToken};$.ajax({url:"/zpzsign/getZSTemplatesConfig",type:"POST",data:params,success:function(data){Zsign.setZSTempConfiguration(data),Zsign.constructZSTempList(),Zsign.Esign.getEsignTemplatesList()},failure:function(data){Zsign.failedCallBack(data)}})},getZSDocConfiguration:function(){if(""==Zsign.ZSDocDtls){var params={conreqcsr:csrfToken};$.ajax({url:"/zpzsign/getZSDocumentsConfig",type:"POST",data:params,success:function(data){Zsign.setZSDocConfiguration(data)},failure:function(data){Zsign.failedCallBack(data)}}),ZPeople.Request.sendAsyncPost("/zpzsign/getZSDocumentsConfig",{conreqcsr:csrfToken},Zsign.setZSDocConfiguration)}},zsDocumentsInit:function(){settingsPage.container.html(""),Zsign.getZSDocConfiguration();var serviceName="ZohoSign",serviceCode="6";void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),isAdobeConfig?(serviceName="AdobeSign",serviceCode="2"):isDocuConfig&&(serviceName="DocuSign",serviceCode="4"),Zsign.constructZDocumentList(serviceName,serviceCode),isAdobeConfig||Zsign.isReadView&&Zsign.hasAdobesignRecord?Zsign.Esign.getAgreementsListPage("","","",serviceName):isDocuConfig||Zsign.isReadView&&Zsign.hasDocusignRecord?Zsign.Esign.getEnvelopeListpage("","","",serviceName):(isZSConfig||Zsign.isReadView&&Zsign.hasZohosignRecord)&&Zsign.Esign.getDocumentsListPage("","",serviceName)},searchstatus:function(serviceCode){var searchstatus='<option value="select">'+ZPI18N.getString("zp.select")+"</option>";return void 0!=serviceCode&&"4"==serviceCode?(searchstatus+='<option value="Sent">'+ZPI18N.getString("zp.sent")+"</option>",searchstatus+='<option value="Completed">'+ZPI18N.getString("zp.completed")+"</option>",searchstatus+='<option value="Cancelled / Declined">'+ZPI18N.getString("zp.cancelordeclined")+"</option>"):void 0!=serviceCode&&"2"==serviceCode?(searchstatus+='<option value="Out for Signature">'+ZPI18N.getString("zp.status0")+"</option>",searchstatus+='<option value="Signed">'+ZPI18N.getString("zp.status1")+"</option>",searchstatus+='<option value="Cancelled / Decline">'+ZPI18N.getString("zp.cancelordeclined")+"</option>"):(searchstatus+='<option value="Draft">'+ZPI18N.getString("zp.draft")+"</option>",searchstatus+='<option value="Sent">'+ZPI18N.getString("zp.sent")+"</option>",searchstatus+='<option value="Completed">'+ZPI18N.getString("zp.completed")+"</option>",searchstatus+='<option value="Declined">'+ZPI18N.getString("zp.declined")+"</option>",searchstatus+='<option value="Recalled">'+ZPI18N.getString("zp.recalled")+"</option>",searchstatus+='<option value="Expired">'+ZPI18N.getString("zp.expired")+"</option>"),searchstatus},searchZsignview:function(){var zsignView='<option value="ESignatureDocuments">'+ZPI18N.getString("zp.esign.wf.Esignature2")+"</option>";return zsignView+='<option value="WorkFlowReports">'+ZPI18N.getString("zp.esign.wf.tabname2")+"</option>"},searchZsignWFStatus:function(){var ZsignWFStatus='<option value="select">'+ZPI18N.getString("zp.select")+"</option>";return ZsignWFStatus+='<option value="Success">'+ZPI18N.getString("zp.success")+"</option>",ZsignWFStatus+='<option value="Fail">'+ZPI18N.getString("zp.failure")+"</option>"},searchZsignFormList:function(){if(void 0==Zsign.FormList){var ZsignFormList=[];ZsignFormList.push({dispName:ZPI18N.getString("zp.select"),formId:ZPI18N.getString("zp.select"),tableName:""}),Zsign.getFormList(ZP_Automation_Mode.WORKFLOW),ZsignFormList=ZsignFormList.concat(Zsign.FormList),Zsign.FormList=ZsignFormList}return Zsign.constructFormList(Zsign.FormList)},getFormList:function(mode,serviceName){var param={method:"getFormList",mode:mode,conreqcsr:csrfToken};ZPA_Common.isNotNull(serviceName)&&(param.serviceName=serviceName),ZPA_Common.isNotNull(Zsign.FormList)||$.ajax({url:"/formlist.zp",type:"POST",data:param,async:!1,success:function(data){var result=[];$.each(data,function(index,formDtl){var formObj=formDtl;formObj.dispName=decodeHTML(formDtl.dispName),result.push(formObj)}),Zsign.FormList=result}})},populateZsignTriggerbyList:function(){if(void 0==Zsign.Esign.employeeData){Zsign.Esign.employeeData=[],Zsign.Esign.employeeData.push({EMPNAME:ZPI18N.getString("zp.select"),ERECNO:ZPI18N.getString("zp.select")});var params={mode:"GET_MODULE_EMP_LIST",module:"File_Data",conreqcsr:csrfToken};$.ajax({url:"/commonAction.zp",type:"POST",data:params,async:!1,success:function(data){Zsign.Esign.employeeData=Zsign.Esign.employeeData.concat(data.empList)}})}return Zsign.constructEmpTriggFilter(Zsign.Esign.employeeData)},isCandidateEmployee:function(){settingsPage.container.find("input#emailId_search").val(""),settingsPage.container.find("input#recordId_search").val(""),settingsPage.container.find("#emailIdsearch").addClass("DNI");var tableName=$("#search_form").find("option:selected")[0].optData.tableName;"P_Employee"!=tableName&&"P_Candidate"!=tableName||settingsPage.container.find("#emailIdsearch").removeClass("DNI")},initZDFilterComp:function(serviceName){if(!Zsign.initZDFilter){ZPeopleComponents.datefield("#doc_sentfrom",{format:dateFmt}),ZPeopleComponents.datefield("#doc_sent_to_btn",{format:dateFmt});var formData=new FormData;formData.append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&formData.append("formId",ZP5Form.getCurrFormsOperation().formId),void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams().recordId&&void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId?formData.append("recordId",ZP5Form.getFormClassObj().getParams().recordId):Zsign.ESIGN_FORMS_RECORD_IDS.length>0&&formData.append("recList",Zsign.ESIGN_FORMS_RECORD_IDS.toString()),ZPA_Esign.openFilter(formData),ZPeopleComponents.select(settingsPage.container.find("#search_wfstatus")).removeAllOptions(),ZPeopleComponents.select(settingsPage.container.find("#search_wfstatus")).destroy(),ZPeopleComponents.select(settingsPage.container.find("#search_wfstatus").append(Zsign.searchZsignWFStatus)),ZPeopleComponents.select("#search_form").removeAllOptions(),ZPeopleComponents.select("#search_form").destroy();var formOptions=Zsign.searchZsignFormList();ZPeopleComponents.select(settingsPage.container.find("#search_form")).setAttributes(formOptions),settingsPage.container.find("#search_form").on("zselectoptionclick",Zsign.isCandidateEmployee),ZPeopleComponents.select("#search_perfrmdemp").removeAllOptions(),ZPeopleComponents.select("#search_perfrmdemp").destroy();var options=Zsign.populateZsignTriggerbyList();ZPeopleComponents.select(settingsPage.container.find("#search_perfrmdemp")).setAttributes(options),ZPeopleComponents.select(settingsPage.container.find("#search_view")).removeAllOptions(),ZPeopleComponents.select(settingsPage.container.find("#search_view")).destroy(),ZPeopleComponents.select(settingsPage.container.find("#search_view").append(Zsign.searchZsignview)),settingsPage.container.find("#search_view").on("zselectoptionclick",Zsign.searchAgreementsRecord),ZPeopleComponents.select("#search_status").removeAllOptions(),ZPeopleComponents.select("#search_status").destroy(),ZPeopleComponents.select($("select#search_status").append(Zsign.searchstatus)),Zsign.searchAgreementsRecord(),Zsign.initZDFilter=!0}},initZTFilterComp:function(){Zsign.initZTFilter||(ZPeopleComponents.datefield("#temp_sentfrom",{format:dateFmt}),ZPeopleComponents.datefield("#temp_sentto",{format:dateFmt}),Zsign.initZTFilter=!0)},setZSTempConfiguration:function(data){settingsPage.container;var servicesParams=data[1];Zsign.ZSTempConfDtls=data[1],Zsign.isChinaSetup=servicesParams.isChinaSetup,Zsign.maxFileSize=servicesParams.maxFileSize,Zsign.isNewUI=servicesParams.isNewUI,Zsign.isAdmin=servicesParams.isAdmin,Zsign.loginUserRoleCheck=servicesParams.loginUserRoleCheck,Zsign.hrdocAccess=servicesParams.hrdocAccess},setZSDocConfiguration:function(data){settingsPage.container;var servicesParams=data[1];Zsign.ZSDocDtls=data[1],Zsign.isChinaSetup=servicesParams.isChinaSetup,Zsign.maxFileSize=servicesParams.maxFileSize,Zsign.isNewUI=servicesParams.isNewUI,Zsign.isAdmin=servicesParams.isAdmin,Zsign.loginUserRoleCheck=servicesParams.loginUserRoleCheck,Zsign.hasZohosignRecord=servicesParams.hasZohosignRecord,Zsign.hasAdobesignRecord=servicesParams.hasAdobesignRecord,Zsign.hasDocusignRecord=servicesParams.hasDocusignRecord,Zsign.isReadView=servicesParams.isReadView,Zsign.ZSCheckAdminAccess=servicesParams.ZSCheckAdminAccess,Zsign.notifyAccess=servicesParams.notifyAccess},isfromZSignTemplates:function(){return"tab-files-esigndocuments"==settingsPage.container[0].id&&0!=settingsPage.container.find("#esigntemplatesParent").length&&settingsPage.container.find("#esigntemplatesParent").hasClass("zpl_mopen")},returnEmpUserList:function(empArr){var selectedValObj=[];if(!isEmpty(empArr))for(var leng=Object.keys(empArr).length,i=0;i<leng;i++){var erecno=Object.keys(empArr)[i];selectedValObj.push({id:erecno,value:empArr[erecno].empid+" "+empArr[erecno].name,image:empArr[erecno].avatar,zuid:empArr[erecno].id,emailId:empArr[erecno].email})}return selectedValObj},Esign:{getAgreementsListPage:function(mode,isFromEmployeeView,isMailMerge,serviceName){Adobesign.selectedRecpForm=null,$("#zsignTempListIcon").addClass("DNI"),$("#zp-contwrap-files-zohosign").removeClass("zp_files");var pageId=settingsPage.container;if(Adobesign.funcToOpenFilter(),0==$("#filter_params").find("span").length&&$("#page-wrapper").removeClass("filter-container"),"operations/files/esigndocuments"===settingsUrlProps.url&"hr"!=mode)$("#page-wrapper").addClass("filter-container"),Adobesign.getAgreementsList(null,"",!1,"","","",""),Zsign.searchAgreementsRecord();else if(-1!==settingsUrlProps.url.indexOf("documentId:")){var agrID=pageId.find("div#esign_detail").attr("agrId");ZPSetupCommon.isEmpty(agrID)&&(agrID=settingsUrlProps.url.split("documentId:")[1]),-1!==settingsUrlProps.url.indexOf("esigndocuments")&&Adobesign.getAgreementsList(null,null,!1,"","","",""),Adobesign.getAgreementPreview(agrID)}else if(-1!==settingsUrlProps.url.indexOf("createAgreement")||"company"===mode||"hr"===mode||isFromEmployeeView){Adobesign.openAgreement(mode,isFromEmployeeView,isMailMerge);var createAgrModal=pageId.find("div#esign"),inputFile=createAgrModal.find("input#agmntFile"),inputType="agreements"===mode||ZPSetupCommon.isEmpty(mode)?"file":"text";if(inputFile.prop("type",inputType),ZPSetupCommon.isEmpty(mode)&&!isFromEmployeeView&&Adobesign.getAgreementsList(null,null,!1,"","","",""),!ZPSetupCommon.isEmpty(mode)&&("company"===mode||"hr"===mode)){var getFileNameObj="company"===mode?$("tbody#comp_fileList"):$("tbody#hr_allfileList");null==Adobesign.fileId&&(Adobesign.fileId=settingsUrlProps.url.split("createAgreement:")[1]),null==Adobesign.fileName&&(Adobesign.fileName=getFileNameObj.find("tr[fileID="+Adobesign.fileId+"]").attr("fileName")),createAgrModal.find("span#drop_file").text(Adobesign.fileName),createAgrModal.data({fileId:Adobesign.fileId})}}if("operations/files/esigndocuments"===settingsUrlProps.url&&!Adobesign.isFilterCached||Adobesign.isFromEmployeeView&&!Adobesign.isFormCatListCached||void 0!=createAgrModal&&ZComponent.select(createAgrModal.find("#agrselect_cat")).getValue()){var formData=new FormData;formData.append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),ZPA_Esign.openFilter(formData)}Adobesign.constructLanguage(),"agreements"===mode&&pageId.find("i#agrm_filterIc").attr("class").indexOf("ZPFilsel")>-1&&$("div#page-wrapper").attr("class","Nbar2F")},getEnvelopeListpage:function(mode,isFromFormView,isMailMerge,serviceName){$("#zp-contwrap-files-zohosign").removeClass("zp_files"),$("#zsignTempListIcon").addClass("DNI");var pageId=settingsPage.container;if("cancel"===mode){if(Docusign.selectedRecpForm=null,pageId.find("div#esign").removeClass("PopMdxModel l0"),0==$("#filter_params").find("span").length&&$("#page-wrapper").removeClass("filter-container"),Docusign.isFromFormView&&-1==settingsUrlProps.url.indexOf("-documentId"))return;if(settingsUrlProps.url.indexOf("-formId:")>-1)return void settingsPage.container.find("div#esign_detail").modal("hide");if(settingsUrlProps.url.indexOf("-documentId")>-1||-1!==settingsUrlProps.url.indexOf("-createEnvelope"))return void(window.location.href=Layout.Page.hash.split("-")[0])}else{-1!==settingsUrlProps.url.indexOf("-createEnvelope")||"hr"==mode?Envelope.openEnvModal("","",isFromFormView):settingsUrlProps.url.indexOf("documentId:")>-1?Docusign.getEnvelopePreview():(settingsUrlProps.url.indexOf("-formId:")>-1||settingsUrlProps.url.indexOf("-formLinkName:")>-1||settingsUrlProps.url.indexOf("selfservice/user")>-1)&&Envelope.openEnvModal(isFromFormView,isMailMerge);var createEnvModal=pageId.find("div#esign");if("#files/docusign/doculistview"===settingsUrlProps.url&&$("#page-wrapper").addClass("filter-container"),"operations/files/esigndocuments"===settingsUrlProps.url&&!Envelope.isFilterCached||Envelope.isFromEmployeeView&&!Envelope.isFormCatListCached||void 0!=createEnvModal&&0!=createEnvModal.length&&ZComponent.select(createEnvModal.find("#agrselect_Cat")).getValue()){var formData=new FormData;formData.append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),ZPA_Esign.openFilter(formData)}}!settingsUrlProps.url.indexOf("doculistview")>-1&&($("#page-wrapper").addClass("filter-container"),Docusign.getEnvelopeList("","","","","","","",serviceName),Zsign.searchAgreementsRecord())},getDocumentsListPage:function(mode,isFromFormView,serviceName){var serviceCode;if(ZPeopleComponents.isComponent("#zp_esign_view")&&(serviceCode=ZPeopleComponents.select(document.getElementById("zp_esign_view")).getValue()),$("#tab-files-esigndocuments").removeClass("DNI"),$("#tab-files-esigntemplates").addClass("DNI"),$("#zp-contwrap-files-zohosign").removeClass("zp_files"),"cancel"===mode){if(Zsign.selectedRecpForm=null,Zsign.editSignTempId="",0==$("#filter_params").find("span").length&&$("#page-wrapper").removeClass("filter-container"),Zsign.isFromFormView&&-1==settingsUrlProps.url.indexOf("-documentId"))return;if(settingsUrlProps.url.indexOf("-formId:")>-1)return void settingsPage.container.find("div#viewDocumentModal").modal("hide");if(settingsUrlProps.url.indexOf("-documentId")>-1||-1!==settingsUrlProps.url.indexOf("-createDocument"))return void(window.location.href=window.location.hash.substring(0,window.location.hash.lastIndexOf("-")));if(-1!==settingsUrlProps.url.indexOf("files/companyfile")||settingsUrlProps.url.indexOf("-formLinkName:")>-1)return}else{if(-1!==settingsUrlProps.url.indexOf("-createDocument")||"hr"==mode)Zsign.openEnvModal("","","","","",isFromFormView);else{if(settingsUrlProps.url.indexOf("documentId:")>-1)return void Zsign.getDocumentPreview();void 0==settingsUrlProps.urlParamsArr.formId&&void 0==settingsUrlProps.urlParamsArr.formLinkName||void 0==settingsUrlProps.urlParamsArr.recordId||isFromFormView||(void 0!=settingsUrlProps.urlParamsArr.formLinkName?ZPApprovals.viewApprovalPopup(settingsUrlProps.urlParamsArr.formLinkName,settingsUrlProps.urlParamsArr.recordId,!0):ZPApprovals.viewApprovalPopup(settingsUrlProps.urlParamsArr.formId,settingsUrlProps.urlParamsArr.recordId,!1))}if(!Zsign.isCachedCatList&&0==Zsign.folderList.length){var formData=new FormData;formData.append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),ZPA_Esign.openFilter(formData)}}!isFromFormView&&settingsUrlProps.url.indexOf("operations/files/esigndocuments")>-1&&$("#page-wrapper").addClass("filter-container"),(!Zsign.isCachedDocumentList&&settingsUrlProps.url.indexOf("operations/files/esigndocuments")>-1&&0==Zsign.reportSliderclose||Zsign.FilesOperations.fromcompFilesReportPage&&"cancel"!=mode&&0==Zsign.reportSliderclose)&&($("#zsignTempListIcon").removeClass("DNI"),Zsign.FilesOperations.fromcompFilesReportPage&&Zsign.resetFilterOptions(),Zsign.getDocumentList("","","","","","","",serviceName),Zsign.searchAgreementsRecord(),null==Zsign.FilesOperations.companyFileId&&(Zsign.FilesOperations.fromcompFilesReportPage=!1)),!Zsign.isCachedDocumentList&&settingsUrlProps.url.indexOf("operations/files/esigndocuments")>-1&&($("#zsignTempListIcon").removeClass("DNI"),Zsign.searchAgreementsRecord(),isZohoReadView&&!isZSConfig&&6==serviceCode&&(settingsPage.container.find("#create_agr").addClass("DN"),settingsPage.container.find("#zsignTempListIcon").addClass("DNI"))),Zsign.reportSliderclose=!1},getEsignTemplatesList:function(mode){$("#esigntemplatesParent");if($("#esigntemplatesParent").removeClass("DNI"),Zsign.hrdocAccess&&(void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),null==Zsign.FilesOperations.isEsignatureAllowedFlag&&Zsign.isEsignatureAllowed(),isZSConfig)){if(Zsign.checkZSFeature(),!Zsign.FilesOperations.isEsignatureAllowedFlag)return void Zsign.showUpgradePage();if(!Zsign.zsFeatureList.templates)return void Zsign.showUpgradePage();Zsign.hideUpgrade(),Zsign.getETemplateList()}},toggleSortSign:function(ele,module){for(var sortOrder=!1,sortColumn="",toggleFields=settingsPage.container.find(".PI_sort"),i=0;i<toggleFields.length;i++)toggleFields[i].id!==ele.id?settingsPage.container.find("#"+toggleFields[i].id).removeClass("asc").removeClass("desc"):ele.classList.contains("desc")?settingsPage.container.find(ele).removeClass("desc").addClass("asc"):settingsPage.container.find(ele).removeClass("asc").addClass("desc");sortColumn="sort_fileName"==settingsPage.container.find(ele).attr("id")?"NAME":"SENT_DATE",ele.classList.contains("desc")?sortOrder=!1:ele.classList.contains("asc")&&(sortOrder=!0),void 0!=module&&""!=module&&("6"==module?Zsign.getDocumentList("","","sort",!0,sortOrder,sortColumn):"2"==module?Adobesign.getAgreementsList("","sort","","",!0,sortOrder,sortColumn):Docusign.getEnvelopeList("","","sort",!0,sortOrder,sortColumn))},getSortColumn:function(sortedID){return"sort_fileName"==sortedID?"NAME":"SENT_DATE"},fileIcons:function(fileExtn){return"pdf"===fileExtn?"pdf":"xls"===fileExtn||"xlsx"===fileExtn||"sxc"===fileExtn||"ods"===fileExtn||"csv"===fileExtn||"tsv"===fileExtn?"xls-new":"htm"===fileExtn||"html"===fileExtn?"htm":"doc"===fileExtn||"docx"===fileExtn||"sxw"===fileExtn||"odt"===fileExtn||"rtf"===fileExtn?"doc":"ppt"===fileExtn||"pps"===fileExtn||"odp"===fileExtn||"sxi"===fileExtn||"pptx"===fileExtn?"ppt":"zip"===fileExtn?"zip":"mp3"===fileExtn||"mp4a"===fileExtn||"wav"===fileExtn?"mp3":"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn?"jpg":"doc"},checkAllRows:function(obj,mode){var pageId=settingsPage.container,checkBoxParam=$(obj).find("input");checkBoxParam.prop("checked",!checkBoxParam.prop("checked"));var chk=$(obj).find("input").prop("checked"),fileListingdiv="";"hrdocuments"==mode||"hrmergedocuments"===mode?fileListingdiv="#hrdoc_list":"zsigntemplates"==mode?(pageId=$("#esigntemplatesParent"),fileListingdiv="#signtemplate_list"):"documents"==mode?fileListingdiv="#documents_list":"zsignAddToken"==mode&&(fileListingdiv="#zsignTokenListing"),chk?(pageId.find(fileListingdiv).find("input[type=checkbox]").prop("checked",!0),pageId.find("#doc_multiselDel").removeClass("DNI").addClass("opn")):(pageId.find("#doc_multiselDel").addClass("DNI"),pageId.find(fileListingdiv).find("input[type=checkbox]:checked").prop("checked",!1),Zsign.Esign.removeDeleteWhiteBand(mode))},checkParticularFiles:function(obj,mode){var pageId=settingsPage.container,checkBoxParam=$(obj).find("input");checkBoxParam.prop("checked",!checkBoxParam.prop("checked"));var chk=$(obj).find("input").prop("checked"),fileListingdiv="",mod_checkallbox=";";"hrdocuments"==mode||"hrmergedocuments"==mode?(fileListingdiv="#hrdoc_list",mod_checkallbox="hrdoc_checkallbox"):"zsigntemplates"==mode?(pageId=$("#esigntemplatesParent"),fileListingdiv="#signtemplate_list",mod_checkallbox="template_checkallbox"):"documents"==mode?(fileListingdiv="#documents_list",mod_checkallbox="documents_checkallbox"):"zsignAddToken"==mode&&(fileListingdiv="#zsignTokenListing",mod_checkallbox="addToken_chkBxAll"),chk?(pageId.find("#doc_multiselDel").removeClass("DNI").addClass("opn"),"hrdocuments"!=mode&&"hrmergedocuments"!=mode||pageId.find("#moveFiles").addClass("DN"),pageId.find(fileListingdiv).find('input[type="checkbox"]:checked').length===pageId.find(fileListingdiv).find('input[type="checkbox"]').length&&pageId.find(mod_checkallbox).prop("checked",!0)):0==pageId.find(fileListingdiv).find('input[type="checkbox"]:checked').length?(pageId.find(mod_checkallbox).prop("checked",!1),pageId.find("#doc_multiselDel").addClass("DNI")):pageId.find(fileListingdiv).find('input[type="checkbox"]:checked').length>0&&(pageId.find(mod_checkallbox).prop("checked",!1),pageId.find("#doc_multiselDel").removeClass("DNI").addClass("opn"))},removeDeleteWhiteBand:function(mode){var pageId=settingsPage.container;"zsigntemplates"==mode?(pageId=$("#esigntemplatesParent"),fileListingdiv="signtemplate_list",mod_checkallbox="template_checkallbox"):"documents"==mode?(fileListingdiv="documents_list",mod_checkallbox="documents_checkallbox"):"zsignAddToken"==mode&&(fileListingdiv="zsignTokenListing",mod_checkallbox="addToken_chkBxAll"),pageId.find("#doc_multiselDel").removeClass("opn"),pageId.find("#"+mod_checkallbox).prop("checked",!1),pageId.find("#"+fileListingdiv).find("input[type=checkbox]:checked").prop("checked",!1)},initLightBox:function(data){Zsign.LightBox=new LightBox(ZSEC.Encoder.encodeForHTML(data.fileName)),Zsign.LightBox.viewUrl=data.url,Zsign.LightBox.isImage=data.isImage,Zsign.LightBox.needPrint=!1,Zsign.LightBox.needDownload=data.allowDownload,Zsign.LightBox.setDownloadCallback(Zsign.Esign.downloadFromLightBox),Zsign.LightBox.extraProps=data,Zsign.LightBox.infoIconNeed=!0,Zsign.LightBox.infoContent=data.info,void 0!=data.extraProps&&null!=data.extraProps.footerBtn&&void 0!=data.extraProps.footerBtn&&1==data.extraProps.footerBtn&&Zsign.LightBox.setFileLoadCallBack(HRDocumentFiles.showAddToOrgFile),Zsign.LightBox.show()},downloadFromLightBox:function(data){void 0!=data.extraProps.mode&&("hr"==data.extraProps.mode&&5==data.extraProps.fileType||"hrdocPdf"==data.extraProps.mode||4==data.extraProps.fileType)?HRDocumentFiles.downloadCompHandbook(data.extraProps.fileId):Adobesign.downloadAttachement(this,data.extraProps.fileId,"download",data.fileName,data.extraProps.filePath)},viewAttachment:function(details,obj){var fileExtn,recordId,formId,mode=details.mode,fileName=details.fileName,filePath=details.filePath,viewfileId=details.fileId;void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams().recordId?(recordId=ZP5Form.getFormClassObj().getParams().recordId,formId=ZP5Form.getFormClassObj().getParams().formId):void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1&&(formId=ZP5Form.getCurrFormsOperation().formId,void 0==(recordId=$("div#viewDocumentModal").attr("recordId"))&&(recordId=$("div#viewEnvelopeModal").attr("recordId")),void 0==recordId&&(recordId=$("div#viewAgreementModal").attr("recordId")));var fileEObj="";fileEObj=""!=filePath?filePath:fileName,ZPSetupCommon.isEmpty(fileEObj)||(fileExtn=fileEObj.substring(fileEObj.lastIndexOf(".")+1,fileEObj.length));var isPolicy="5"==obj;if(void 0!=fileEObj&&"-1"==fileEObj.lastIndexOf(".")&&isPolicy&&(fileExtn="docx"),5==details.fileType&&""!=HRDocumentFiles.mmtempCompRid&&(filePath=HRDocumentFiles.mmtempCompRid),5!==details.fileType){var viewParams={},url="";if("download"===mode||"xls"!==fileExtn&&"xlsx"!==fileExtn&&"doc"!==fileExtn&&"docx"!==fileExtn&&"rtf"!==fileExtn&&"ppt"!==fileExtn&&"pptx"!==fileExtn){url="";if(url="download"===mode||"pdf"!==fileExtn&&"PDF"!==fileExtn?"viewFile?&mode=agreement":"pdfViewer.zp?mode=agreement",ZPSetupCommon.isEmpty(viewfileId)||(url+="&fileId="+viewfileId,viewParams.fileId=viewfileId),(void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams().recordId||settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&(Zsign.isfromFormReport||(url+="&recordId="+recordId,viewParams.recordId=recordId),url+="&formId="+formId,viewParams.formId=formId),"hrdocPdf"!=mode&&"hr"!=mode||(4==details.fileType&&(viewParams.filePath=details.filePath,viewParams.fileType=details.fileType),url=Zsign.Esign.constructPreviewUrl(mode,viewParams,fileExtn)),"download"===mode)return url+="&action=download",void window.open(url)}else if(FilesUtil.Preview.isViewZBasedFile(fileName,fileExtn)){var params={action:"viewFiles",conreqcsr:csrfToken,fileId:viewfileId,recordId:recordId,formId:Layout.Page.urlparam.formId,isPolicy:isPolicy};ZPeople.Request.sendAsyncPost("/adobesign/viewFiles",params,Adobesign.viewAttachmentFile,fileName,Adobesign.failedCallBack),url=params.url}else if(FilesUtil.Preview.isFilesPreviewEnabled(filePath))if("docx"!=fileExtn&&"doc"!=fileExtn&&"rtf"!==fileExtn&&"pptx"!=fileExtn&&"ppt"!=fileExtn||(viewParams.mode="agreement",viewParams.fileId=viewfileId,viewParams.recordId=recordId,viewParams.formId=Layout.Page.urlparam.formId,viewParams.isPolicy=isPolicy),"pdf"==fileExtn)url="/pdfViewer.zp?fileId="+viewfileId;else{"tif"==fileExtn?url="/pdf/"+previewServiceId+"/"+viewfileId+"?":"docx"!=fileExtn&&"doc"!=fileExtn&&"rtf"!=fileExtn&&"odt"!=fileExtn&&"pptx"!=fileExtn&&"ppt"!=fileExtn||(url="/preview/"+previewServiceId+"/"+viewfileId+"?");var frameOrigin=window.location.protocol+"//"+window.location.host,zohoOneOrigin=ZPUnifieduiUtil.getZOFrameOriginUrl();null!=zohoOneOrigin&&void 0!=zohoOneOrigin&&""!=zohoOneOrigin&&(frameOrigin+=","+zohoOneOrigin),url=previewServerUrl+url+"frameorigin="+frameOrigin,viewParams.portalId=_LOGGEDIN_ACCZSOID,viewParams.moduleName="Files",viewParams.portalId=_LOGGEDIN_ACCZSOID,viewParams.files_userIp=userIp,url=url+"&cli-msg="+encodeURIComponent(btoa(JSON.stringify(viewParams)))}}else{var extraProps={};extraProps.fileId=viewfileId,extraProps.fileName=fileName,extraProps.filePath=filePath,details.fileExtn=fileExtn,details.extraProps=extraProps,details.isFromMergeNMove?(extraProps.footerBtn=!0,url=Zsign.Esign.constructPreviewUrl("hrdocPdf",details,"pdf")):url=FilesUtil.Preview.frameURL(details)}details.url=url,Zsign.Esign.initLightBox(details)},constructPreviewUrl:function(mode,params,fileExtn){var fileId=params.fileId,fileType=void 0!=params?params.fileType:void 0,filePath=void 0!=params?params.filePath:void 0;if("pdf"==fileExtn)void 0!=fileType&&"4"==fileType&&void 0!=filePath&&-1==filePath.indexOf("Document")?url=ZPeople.getResourceURL(pdfUrl+params.filePath):url="hrdocPdf"==mode?"/pdfViewer.zp?fileId="+fileId+"&isNotPrevEngURL="+!0:"/pdfViewer.zp?fileId="+fileId;else{"tif"==fileExtn?url="/pdf/"+previewServiceId+"/"+fileId+"?":"docx"!=fileExtn&&"doc"!=fileExtn&&"rtf"!=fileExtn&&"odt"!=fileExtn&&"pptx"!=fileExtn&&"ppt"!=fileExtn||(url="/preview/"+previewServiceId+"/"+fileId+"?");var frameOrigin=window.location.protocol+"//"+window.location.host,zohoOneOrigin=ZPUnifieduiUtil.getZOFrameOriginUrl();null!=zohoOneOrigin&&void 0!=zohoOneOrigin&&""!=zohoOneOrigin&&(frameOrigin+=","+zohoOneOrigin),url=previewServerUrl+url+"frameorigin="+frameOrigin,params.portalId=_LOGGEDIN_ACCZSOID,"agreement"==mode?(params.moduleName="Files",params.portalId=_LOGGEDIN_ACCZSOID,params.files_userIp=userIp):((params={}).moduleName="Files",params.portalId=_LOGGEDIN_ACCZSOID,params.files_userIp=userIp),url=url+"&cli-msg="+encodeURIComponent(btoa(JSON.stringify(params)))}return url},showMoreRecepients:function(repName,agId){var recpNameArr=repName.toString().split(","),recpList=[];for(i=1;i<recpNameArr.length;++i)recpList.push({id:i,label:recpNameArr[i]});var divId="to_Recep",forElementId="recpTo_"+agId;ZPeopleComponents.isComponent("#"+divId)&&(ZPeopleComponents.menu($("#"+divId)).destroy(),$("#"+divId).remove());var tokenObj={direction:"bottom",displayType:"box",contentType:"text"};tokenObj.forElement="#"+forElementId,tokenObj.itemclick=Zsign.FilesOperations.initAction,ZPeopleComponents.createMenu(divId,recpList,tokenObj),ZPeopleComponents.menu("#"+divId).show()},exportFiles:function(){if(Zsign.noRecords)ZPeople.Message.failure(ZPI18N.getString("zp.nofilesexport"));else if(FilesUtil.IP.isRestricted)FilesUtil.IP.showError(!0);else if(FilesUtil.Geo.isRestricted)FilesUtil.Geo.showError(!0);else if(isadmin){var viewtype=ZPeopleComponents.select(document.getElementById("zp_esign_view")).getValue(),url="",methodName="";"2"==viewtype?(url="/adobesign/exportAgreementsAsZip",methodName="exportAgreementsAsZip"):"4"==viewtype?(url="/docusign/exportEnvelopesAsZip",methodName="exportEnvelopesAsZip"):"6"==viewtype&&(url="/zpzsign/exportDocumentsAsZip",methodName="exportDocumentsAsZip");var formData=new FormData,pageId=settingsPage.container,envName=pageId.find("input#search_documentname").val(),catId=ZPeopleComponents.select(pageId.find("select#search_cat")).getValue(),status=pageId.find("select#search_status").val(),sentFrom=ZPeopleComponents.datefield(document.getElementById("doc_sentfrom")).getValue().dateString,sentTo=ZPeopleComponents.datefield(document.getElementById("doc_sent_to_btn")).getValue().dateString;""==sentFrom||0==sentFrom||void 0==sentFrom?sentFrom="-1":formData.append("sentFrom",sentFrom),""==sentTo||0==sentTo||void 0==sentTo?sentTo="-1":formData.append("sentTo",sentTo),ZPSetupCommon.isEmpty(catId)||"select"===catId||"-1"===catId||formData.append("catId",catId),ZPSetupCommon.isEmpty(status)||"select"===status||formData.append("status",status),ZPSetupCommon.isEmpty(envName)||formData.append("documentName",envName),formData.append("action",methodName),formData.append("conreqcsr",csrfToken),formData.append("startInd",1),formData.append("limit",24),formData=FilesUtil.Geo.setLatLongParams(formData,!0),$.ajax({url:url,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){ZPeople.Message.success(ZPI18N.getString("zp.exportfilesnotify"))},error:function(req){var errResponse=req.responseJSON[1];8103!==req.status&&8101!==req.status&&500!==req.status||ZPeople.Message.failure(errResponse.msg)}})}else ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied"))},getFileIcon:function(fileExtn){return"pdf"===(fileExtn=fileExtn.toLowerCase())?"PI_ft_pdf":"xls"===fileExtn||"xlsx"===fileExtn||"xlsm"===fileExtn||"sxc"===fileExtn||"ods"===fileExtn||"csv"===fileExtn||"tsv"===fileExtn?"PI_ft_xls":"htm"===fileExtn||"html"===fileExtn?"PI_ft_html":"doc"===fileExtn||"docx"===fileExtn||"sxw"===fileExtn||"odt"===fileExtn||"rtf"===fileExtn?"PI_ft_doc":"ppt"===fileExtn||"pps"===fileExtn||"odp"===fileExtn||"sxi"===fileExtn||"pptx"===fileExtn?"PI_ft_ppt":"zip"===fileExtn?"PI_ft_zip":"mp3"===fileExtn||"mp4a"===fileExtn||"wav"===fileExtn?"PI_ft_mp3":"jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn?"PI_ft_img":"workdrive"===fileExtn?"PI_workdrive":"txt"===fileExtn?"PI_ft_txt":"mp4"===fileExtn?"PI_ft_mov":"PI_ft_unknwn"}},breadcrumb_construct:function(searchParams){var moreFilter=[],pageId=$("#tab-files-esigndocuments");if(Zsign.isfromZSignTemplates()&&(pageId=settingsPage.container.find("#esigntemplatesParent")),Zsign.isfromFormReport&&(pageId=$("#esignform_list_card")),$(pageId.find(".zpl_fltrvwlst")[0]).empty(),Object.keys(searchParams).length>0){$(pageId.find(".zpl_fltrvw")[0]).removeClass("DN");var resultHtml="",label="";$.each(searchParams,function(key,val){"wf_To"==key?(label=key,key=ZPI18N.getString("zp.to")):"wf_From"==key&&(label=key,key=ZPI18N.getString("zp.from")),val=ZSEC.Encoder.encodeForHTML(val),$(pageId.find(".zpl_fltrvwlst")[0]).width()<$(pageId.find(".zpl_fltrvw")[0]).width()-540?(resultHtml='<li><label value="'+label+'">'+key+"&nbsp;:&nbsp;</label><span>"+val+'</span><a class="PI_cls" onclick="Zsign.breadcrumb_remove(\''+key+"')\"></a></li>",$(pageId.find(".zpl_fltrvwlst")[0]).append(resultHtml)):(resultHtml='<label value="'+label+'">'+key+"&nbsp;:&nbsp;</label><span>"+val+'</span><a class="PI_cls" onclick="Zsign.breadcrumb_remove(\''+key+"')\"></a>",moreFilter.push(resultHtml))}),moreFilter.length>0&&Zsign.breadcrumb_showMoreIcon(moreFilter)}else $(pageId.find(".zpl_fltrvw")[0]).addClass("DN")},breadcrumb_remove:function(key,isReset){Zsign.isfromFormReport?(Zsign.Forms.removeZsignBreadCrumb(key,isReset),Zsign.Forms.getESignList()):Zsign.isfromZSignTemplates()?(Zsign.removeZsignTemplateBreadCrumb(key,isReset),Zsign.getETemplateList("","","search")):(Zsign.removeZsignBreadCrumb(key,isReset),Zsign.getESignList())},breadcrumb_reset:function(){Zsign.isfromFormReport?Zsign.Forms.resetFilter():Zsign.isfromZSignTemplates()?(Zsign.resetEsignTempFilter(),Zsign.getETemplateList("","","search")):Zsign.resetFilter()},breadcrumb_showMoreIcon:function(moreListHTML){var divId="moreFilterIcontab-files-esigndocuments";settingsPage.container.find(".zpl_fltrvwlst").append('<li id="moreFilterIcontab-files-esigndocuments" class="zpl_mre zpl_drpdwn-js zh-radiusbottom"><i class="PI_more d-flex"></i></li>');var filterlist=[];$.each(moreListHTML,function(key,html){filterlist.push({itemType:"custom",innerHTML:html})}),FilesOperations.MoreOption.showMoreMenu("morefilterOpttab-files-esigndocuments",divId,FilesOperations.MoreOption.getMenuObject(divId),filterlist,!1)},removeZsignTemplateBreadCrumb:function(key,isReset){var pageId=$("#esigntemplatesParent");void 0==key||isReset?Zsign.resetFilterEsignTempOptions():key==ZPI18N.getString("zp.name")?pageId.find("#search_view").val(""):key==ZPI18N.getString("zp.from")?ZPeopleComponents.datefield(document.getElementById("temp_sentfrom")).setAttribute("value",""):key==ZPI18N.getString("zp.to")&&ZPeopleComponents.datefield(document.getElementById("temp_sentto")).setAttribute("value","")},removeZsignBreadCrumb:function(key,isReset){var pageId=settingsPage.container;void 0==key||isReset||key==ZPI18N.getString("zp.viewtype")?(ZPeopleComponents.select("select#search_view").setAttribute("selectedValue","ESignatureDocuments"),Zsign.resetFilter(),Zsign.searchAgreementsRecord()):key==ZPI18N.getString("zp.name")?pageId.find("#search_documentname").val(""):key==ZPI18N.getString("zp.from")?ZPeopleComponents.datefield(document.getElementById("doc_sentfrom")).setAttribute("value",""):key==ZPI18N.getString("zp.to")?ZPeopleComponents.datefield(document.getElementById("doc_sent_to_btn")).setAttribute("value",""):key==ZPI18N.getString("zp.emailid")?pageId.find("#emailId_search").val(""):key==ZPI18N.getString("zp.historyExportRecordId")?pageId.find("#recordId_search").val(""):key==ZPI18N.getString("zp.folder")?ZPeopleComponents.select("#search_cat").setAttribute("selectedValue",ZPI18N.getString("zp.select")):key==ZPI18N.getString("zp.status")?ZPeopleComponents.select("#search_status").setAttribute("selectedValue",ZPI18N.getString("zp.select")):key==ZPI18N.getString("zp.wfstatus")?ZPeopleComponents.select("#search_wfstatus").setAttribute("selectedValue",ZPI18N.getString("zp.select")):key==ZPI18N.getString("zp.formname")?(pageId.find("#emailId_search").val(""),pageId.find("#emailId_search").addClass("DNI"),settingsPage.container.find("#emailIdsearch").addClass("DNI"),ZPeopleComponents.select("#search_form").setAttribute("selectedValue",ZPI18N.getString("zp.select"))):key==ZPI18N.getString("zp.triggeredby")&&ZPeopleComponents.select("#search_perfrmdemp").setAttribute("selectedValue",ZPI18N.getString("zp.select"))},mouseEnterFunction:function(){let elementToCheck=event.target;event.target.offsetWidth<event.target.scrollWidth&&!$(elementToCheck).attr("title")&&($(elementToCheck).attr("title",$(elementToCheck).text()),$(elementToCheck).attr("data-title-position","auto"),$(elementToCheck).attr("data-title-display-type","callout"))}},Zsign.FilesOperations={isEsignatureAllowedFlag:null,previousUrl:null,companyFilesReport:!1,companyFileId:null,fromcompFilesReportPage:!1,fileNameforCR:"",splitToString:function(param){var dataArray="";if(void 0!=param)for(key in Object.keys(param))key>0&&(dataArray+=","),dataArray+=Object.keys(param)[key];return dataArray},showViewReport:function(fileId){1==FilesUtil.Page.getTabGroup()&&(Zsign.FilesOperations.fileNameforCR=settingsPage.container.find("#orgFileTr_"+fileId).attr("filename")),Zsign.FilesOperations.previousUrl=Layout.Page.hash,Zsign.FilesOperations.companyFilesReport=!0,Zsign.FilesOperations.companyFileId=fileId,Zsign.FilesOperations.fromcompFilesReportPage=!0,window.location.href="#operations/files/esigndocuments"},hideViewReport:function(){window.location.href=Zsign.FilesOperations.previousUrl,Zsign.FilesOperations.resetReportChanges()},resetReportChanges:function(){Zsign.FilesOperations.previousUrl=null,Zsign.FilesOperations.companyFileId=null,Zsign.docStartindex=1,Zsign.FilesOperations.companyFilesReport=!1,$("#exportasZip").show(),Zsign.reportSliderclose=!1},showActionMenu_Org:function(rowData,actionsList){return-1!=Zsign.zsignEtxns.indexOf(rowData.fileExtn)&&null!=rowData.fileActions.isEditPerm&&void 0!=rowData.fileActions.isEditPerm&&!0===rowData.fileActions.isEditPerm&&(void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),null==Zsign.FilesOperations.isEsignatureAllowedFlag&&Zsign.isEsignatureAllowed(),void 0!=rowData.signTemplateId&&isZSConfig?Zsign.FilesOperations.isEsignatureAllowedFlag&&(actionsList.push({id:"reqSign",label:ZPI18N.getString("zp.requestsignature"),iconClass:"PI_sign",fileId:rowData.fileID,signTemplateId:rowData.signTemplateId,fileLocationID:rowData.fileLocationID.toString(),entity:Zsign.FilesOperations.splitToString(rowData.fileOrgStructure.Entity),unit:Zsign.FilesOperations.splitToString(rowData.fileOrgStructure.Unit),division:Zsign.FilesOperations.splitToString(rowData.fileOrgStructure.Division),department:Zsign.FilesOperations.splitToString(rowData.fileOrgStructure.Department)}),actionsList.push({id:"editSign",label:ZPI18N.getString("zp.esign.editsignature"),fileId:rowData.fileID,iconClass:"PI_edt",signTemplateId:rowData.signTemplateId})):Zsign.FilesOperations.isEsignatureAllowedFlag&&isZSConfig&&actionsList.push({id:"setupSign",label:ZPI18N.getString("zp.setupsignature"),fileId:rowData.fileID,iconClass:"PI_setting"}),rowData.hasOwnProperty("compAgreementID")&&(2==FilesUtil.loginUserRoleCheck&&ZPSetupCommon.isEmpty(rowData.fileLocationID)||0==FilesUtil.loginUserRoleCheck||1==FilesUtil.loginUserRoleCheck)&&actionsList.push({id:"viewcompReport",label:ZPI18N.getString("zp.esign.viewreport"),fileId:rowData.fileID,iconClass:"PI_chart"})),actionsList},showActionMenu_Emp:function(data,actionsList){var fileExtn=FilesUtil.Page.getFileExtn(data.fileExtn,data.filePath,data.UploadSource);void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),Zsign.populateDocumentView();var esignAdmin=0==FilesUtil.loginUserRoleCheck||1==FilesUtil.loginUserRoleCheck||2==FilesUtil.loginUserRoleCheck&&""==data.fileRoleID;return data.hasOwnProperty("agreementId")&&!ZPSetupCommon.isEmpty(data.agreementId)?"1"===data.module||"2"===data.module?!esignAdmin||!isAdobeConfig&&"true"!=Zsign.hasAdobesignRecord||"1"!==data.module&&"2"!==data.module||actionsList.push({id:"signedDocDetails_empFiles",label:ZPI18N.getString("zp.documentdtls"),iconClass:"PI_sndfile",agreementId:data.agreementId,module:data.module,fileId:data.fileID}):"3"===data.module||"4"===data.module?!esignAdmin||!isDocuConfig&&"true"!=Zsign.hasDocusignRecord||"3"!==data.module&&"4"!==data.module||actionsList.push({id:"signedDocDetails_empFiles",label:ZPI18N.getString("zp.documentdtls"),iconClass:"PI_sndfile",agreementId:data.agreementId,module:data.module,fileId:data.fileID}):"5"!==data.module&&"6"!==data.module||!esignAdmin||!isZSConfig&&"true"!=Zsign.hasZohosignRecord||"5"!==data.module&&"6"!==data.module||actionsList.push({id:"signedDocDetails_empFiles",label:ZPI18N.getString("zp.documentdtls"),iconClass:"PI_sndfile",agreementId:data.agreementId,module:data.module,fileId:data.fileID}):esignAdmin&&isAnySignConfigured&&isAdobeConfig&&ZPSetupCommon.isEmpty(data.agreementId)&&-1!==Adobesign.adobeCompatibleExtns.indexOf(fileExtn)?actionsList.push({id:"sendForSign_empFiles",label:ZPI18N.getString("zp.requestsignature"),iconClass:"PI_sign",fileId:data.fileID,module:data.module}):esignAdmin&&isAnySignConfigured&&isDocuConfig&&ZPSetupCommon.isEmpty(data.agreementId)&&-1!==Docusign.add.docuCompatibleExtns.indexOf(fileExtn)?actionsList.push({id:"sendForSign_empFiles",label:ZPI18N.getString("zp.requestsignature"),iconClass:"PI_sign",fileId:data.fileID,module:data.module}):esignAdmin&&isAnySignConfigured&&isZSConfig&&ZPSetupCommon.isEmpty(data.agreementId)&&-1!==Zsign.add.docuCompatibleExtns.indexOf(fileExtn)&&actionsList.push({id:"sendForSign_empFiles",label:ZPI18N.getString("zp.requestsignature"),iconClass:"PI_sign",fileId:data.fileID,module:data.module}),actionsList},initAction:function(event){var optId=event.detail.id;if("reqSign"==optId){var fileId=event.detail.fileId,signTemplateId=event.detail.signTemplateId,fileLocationID=event.detail.fileLocationID,entity=event.detail.entity,unit=event.detail.unit,division=event.detail.division,department=event.detail.department;Zsign.loadActionData(signTemplateId),Zsign.loadSignTemplate(fileId,signTemplateId,fileLocationID,entity,unit,division,department)}else if("editSign"==optId){fileId=event.detail.fileId,signTemplateId=event.detail.signTemplateId;Zsign.constructSendForOrgSign("edit",fileId,signTemplateId)}else if("setupSign"==optId){fileId=event.detail.fileId;Zsign.constructSendForOrgSign("",fileId)}else if("viewcompReport"==optId){fileId=event.detail.fileId;Zsign.FilesOperations.showViewReport(fileId)}else if("signedDocDetails_empFiles"===optId){var documentid=event.detail.agreementId;fileId=event.detail.fileId;Zsign.getDocumentPreview(documentid,"","",fileId)}else if("sendForSign_empFiles"===optId){fileId=event.detail.fileId;Zsign.constructSendForFilesSign(fileId)}}},Zsign.zstemplate={init:function(){var pageId=$("#zsignIdScroll"),param={conreqcsr:csrfToken};$.ajax({url:"/zpzsign/getSubscriptionDetails",type:"POST",data:param,async:!1,success:function(result){var data=result[1];Zsign.peoplePaymentUrl=data.peoplepayment_url,Zsign.paymentUrl=data.payment_url,Zsign.zsignPricingUrl=data.zsignPricing_url,html='<div class="zpl_rgtcnt zpl_crdwthful"><div class="zpl_crd"><div class="zpl_crdcnt"><div class="zsignOvrvw zpl_secn"><div class="zpl_Emptydata"><div><div class="emptImg-bg"><div class="zpl_emptimg zp_nd_mailmrgtemp"></div></div><h1>'+ZPI18N.getString("zp.esignaturetemplates")+"</h1><p>"+ZPI18N.getString("zp.esignaturetempmsg")+'</p><b class="d-flexcap j-cnt-cntr">'+ZPI18N.getString("zp.helpvideo")+'<a class="d-flexclmcap5" href="https://www.youtube.com/watch?v=h82GWjg8aSw" target="_blank"><i class="PI_redirect"></i>'+ZPI18N.getString("zp.esigntemplate")+"</a></b></div></div>",html+='<div class="zsign_planRow"><div class="zpl_crdlst">\n\t\t\t\t\t\t <div class="zpl_catlst">\n                                <div class="zpl_intelst">\n                                   <div class="zppl"></div>\n                                </div>\n                               <div>\n                                    <h5>'+ZPI18N.getString("zpeople")+"</h5>\n                                    <p>"+ZPI18N.getString("zp.enterpriseplan")+'</p>\n                               </div>\n                               <div class="zlabel zlabel--blue zlabel--medium" id="subscriptionLink" onclick="window.open(\''+Zsign.peoplePaymentUrl+"')\">"+ZPI18N.getString("zp.upgrade")+"</div>\n                         </div>",html+='<div class="zpl_catlst">\n                                <div class="zpl_intelst">\n                                   <div class="zsgn"></div>\n                                </div>\n                                <div>\n                                   <h5>'+ZPI18N.getString("zp.zohosign")+"</h5>\n                                   <p>"+ZPI18N.getString("zp.zsign.higherplans",new Array(Zsign.zsignPricingUrl))+'</p>\n                                </div>\n                                <div class="zlabel zlabel--blue zlabel--medium" id="zsignsubscriptionLink" onclick="window.open(\''+Zsign.paymentUrl+"')\">"+ZPI18N.getString("zp.upgrade")+"</div>\n                       </div>",html+="</div></div></div></div></div></div>",pageId.html(html)}})}},Zsign.Forms={initZDFilter:!1,documentFirescroll:!1,docfireScrollUniqID:"esignformsdocfireScroll",init:function(){if(Zsign.isfromFormReport=!0,0==$("body #modal_Container").find("#esignform_list_card").length){Zsign.getZSDocConfiguration();void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),isAdobeConfig?("AdobeSign","2"):isDocuConfig&&("DocuSign","4");var sliderParams={},content=Zsign.Forms.constructDocumentHeader();sliderParams.id="esignform_list",sliderParams.cardId="esignform_list_card",sliderParams.callback=function(){$("body #modal_Container").find("#"+sliderParams.cardId).html(content),Zsign.Forms.initFormEsignDocumentHeader()},Zsign.Forms.esListModal=new sliderModal(ZPI18N.getString("zp.esignature"),sliderParams),Zsign.Forms.esListModal.fullPageSize=!0,Zsign.Forms.esListModal.setContainerAsBody(!0),Zsign.Forms.esListModal.setCloseCallback(function(){Zsign.Forms.closeCallback()}),Zsign.Forms.esListModal.construct(void 0,"")}Zsign.Forms.getESignList()},closeCallback:function(){Zsign.Forms.resetElementsfn(),Zsign.Forms.removeElementsfn(),Zsign.Forms.esListModal.remove(),$("#esignform_list").remove(),Zsign.isfromFormReport=!1},resetElementsfn:function(){},removeElementsfn:function(){var formPageId=$("#esignform_list");ZPeopleComponents.isComponent(formPageId.find("select#agrselect_Catfmv"))&&ZPeopleComponents.select(formPageId.find("select#agrselect_Catfmv")).destroy(),ZPeopleComponents.isComponent(formPageId.find("select#zp_esign_viewfmv"))&&ZPeopleComponents.select(formPageId.find("select#zp_esign_viewfmv")).destroy(),ZPeopleComponents.isComponent(formPageId.find("select#search_viewfmv"))&&ZPeopleComponents.select(formPageId.find("select#search_viewfmv")).destroy(),ZPeopleComponents.isComponent(formPageId.find("select#search_statusfmv"))&&ZPeopleComponents.select(formPageId.find("select#search_statusfmv")).destroy(),ZPeopleComponents.isComponent(formPageId.find("select#doc_sentfromfmv"))&&ZPeopleComponents.datefield(formPageId.find("select#doc_sentfromfmv")).destroy(),ZPeopleComponents.isComponent(formPageId.find("select#doc_sent_to_btnfmv"))&&ZPeopleComponents.datefield(formPageId.find("select#doc_sent_to_btnfmv")).destroy(),ZPeopleComponents.isComponent(formPageId.find("select#search_wfstatusfmv"))&&ZPeopleComponents.select(formPageId.find("select#search_wfstatusfmv")).destroy(),ZPeopleComponents.isComponent(formPageId.find("select#search_perfrmdempfmv"))&&ZPeopleComponents.select(formPageId.find("select#search_perfrmdempfmv")).destroy(),ZPeopleComponents.isComponent(formPageId.find("select#search_catfmv"))&&ZPeopleComponents.select(formPageId.find("select#search_catfmv")).destroy()},constructDocumentHeader:function(){var conhtml='<div class="zpl_mmnu"><div class="zpl_mmnurgt P0I" id="esignRepScrollID"><div class="zpl_tblfxd zpl_act"><div class="zpl_btnmnu"><div><select class="w200 ztextbox" id="zp_esign_viewfmv"></select></div><div id="right_options_esignfmv" class="zpl_rgt">';return conhtml+='<i class="zpl_ibg PI_fltr" onclick="Adobesign.hideAndShowFilterIC()" data-title-position="bottom" title="'+ZPI18N.getString("zp.filter")+'"></i>',conhtml+="</div></div>",conhtml+='<div class="zpl_fltrvw DN"><div><ul class="zpl_fltrvwlst"></ul></div><div class="d-flexcap MLauto"><a class="red" onclick="Zsign.breadcrumb_remove(undefined, \'true\')">'+ZPI18N.getString("zp.reset")+"</a></div></div>",conhtml+='<div class="zpl_rgtcnt"><div class="zpl_tblres"><table class="zpl_tbl" id="documents_tablefmv"><thead><tr>',conhtml+="<th>"+ZPI18N.getString("zp.esign.docname")+'<div class="zpl_icncnt"><i id="sort_fileNamefmv" class="PI_sort" data-title-position="bottom" title="'+ZPI18N.getString("zp.sort")+'" onclick="Zsign.Forms.toggleSortSign(this);"></i></div></th><th>'+ZPI18N.getString("zp.reciepents")+"</th><th>"+ZPI18N.getString("zp.datesent",new Array(""))+'<div class="zpl_icncnt"><i id="sort_sentDatefmv" class="PI_sort" data-title-position="bottom" title="'+ZPI18N.getString("zp.sort")+'" onclick="Zsign.Forms.toggleSortSign(this);"></i></div></th><th>'+ZPI18N.getString("zp.folder")+"</th><th>"+ZPI18N.getString("zp.status")+'</th><th style="min-width: 120px;">'+ZPI18N.getString("zp.actions")+'</th></tr></thead><tbody id="documents_listfmv"><div class="DNI" id="document_norecordsfmv"></div></tbody>',conhtml+='</table><table class="zpl_tbl DN" id="wfdocuments_tablefmv"><thead><tr>',conhtml+="<th>"+ZPI18N.getString("zp.workflow.workflowname")+"</th><th>"+ZPI18N.getString("zp.esignconfigname")+"</th><th>"+ZPI18N.getString("zp.formname")+"</th><th>"+ZPI18N.getString("zp.triggeredby")+"</th><th>"+ZPI18N.getString("zp.executedtime")+"</th><th>"+ZPI18N.getString("zp.status")+"</th>",conhtml+='</tr></thead><tbody id="wfdocuments_listfmv"><div class="DNI" id="wfdocument_norecordsfmv"></div></tbody>',conhtml+="</table></div></div>",conhtml+='<div id="zsignFormFilterdiv" class="zpl_fltr"><div><div class="zpl_fltrhd"><h5>'+ZPI18N.getString("zp.filter")+'</h5><i class="PI_cls" onclick="Adobesign.hideAndShowFilterIC(\'close\')"></i></div>',conhtml+='<div class="zpl_secn" id="search_view_fltfmv"><div><label>'+ZPI18N.getString("zp.view")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_viewfmv"></select></div></div></div>',conhtml+='<div class="zpl_fltrcnt"><div><div class="zpl_fltclps fltopn"><div class="zpl_fltrlst">',conhtml+='<div class="zpl_secn" id="esignwfstatusfmv"><div><label>'+ZPI18N.getString("zp.status")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_wfstatusfmv"></select></div></div>',conhtml+='<div class="zpl_secn" id="emailIdsearchfmv"><div><label>'+ZPI18N.getString("zp.email")+'</label></div><div class=""><input placeholder="'+ZPI18N.getString("zp.email")+'" type="search" autocomplete="off" class="ztextbox" id="emailId_searchfmv"></div></div>',conhtml+='<div class="zpl_secn" id="recordIdsearchfmv"><div><label>'+ZPI18N.getString("zp.historyExportRecordId")+'</label></div><div class=""><input placeholder="'+ZPI18N.getString("zp.enterrecordid")+'" type="search" autocomplete="off" class="ztextbox" id="recordId_searchfmv"></div></div>',conhtml+='<div class="zpl_secn" id="perfrmdbylistfmv"><div><label>'+ZPI18N.getString("zp.triggeredby")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_perfrmdempfmv"></select></div></div>',conhtml+='<div class="zpl_secn" id="search_nameHeaderfmv"><div><label>'+ZPI18N.getString("zp.esign.docname")+"</label></div>",conhtml+='<div class=""><input placeholder='+ZPI18N.getString("zp.esign.docname")+' type="search" autocomplete="off" class="ztextbox" id="search_documentnamefmv"></div></div><div class="zpl_secn" id="docfoldergroupfmv"><div><label>'+ZPI18N.getString("zp.folder")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_catfmv"></select></div></div>',conhtml+='<div class="zpl_secn" id="esignstatusfmv"><div><label>'+ZPI18N.getString("zp.status")+'</label></div><div><select placeholder="'+ZPI18N.getString("zp.select")+'" id="search_statusfmv"></select></div></div>',conhtml+='<div class="zpl_secn" id="fromDatefilterfmv"><div><label>'+ZPI18N.getString("zp.from")+"</label>",conhtml+='</div><div><input name="doc_sentfrom" data-format="date-short" data-calendar-icon="true" data-picker="true"  data-clear-button="none"  data-spin-buttons="none" data-width="258" id="doc_sentfromfmv" autocomplete="off" onclick="Calendar.setUpCalendar(event,this)" caltype="popup" placeholder="Choose Date" type="text">',conhtml+="</div></div>",conhtml+='<div class="zpl_secn" id="toDatefilterfmv"><div><label>'+ZPI18N.getString("zp.to")+'</label></div><div><input id="doc_sent_to_btnfmv" data-format="date-short" data-calendar-icon="true" data-picker="true" data-clear-button="none" data-spin-buttons="none" data-width="258" style="display: none;">',conhtml+='</div></div></div></div></div></div><div><button id="filtersubmitfmv" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="Zsign.Forms.getESignList()">'+ZPI18N.getString("zp.search")+"</button>",conhtml+='<button type="button" id="reset_envBtnfmv" class="zlabel zlabel--outline zlabel--medium" onclick="Zsign.Forms.resetFilter();Zsign.Forms.searchAgreementsRecord();">'+ZPI18N.getString("zp.reset")+"</button></div></div></div></div></div></div>"},initFormEsignDocumentHeader:function(){Zsign.setEsignViewfilter("zp_esign_viewfmv",$("#esignform_list")),settingsPage.container.addClass("zpl_tblfxd"),Zsign.Forms.initZDFormFilterComp()},initZDFormFilterComp:function(serviceName){var pageId=$("#esignform_list");ZPeopleComponents.datefield("#doc_sentfromfmv",{format:dateFmt}),ZPeopleComponents.datefield("#doc_sent_to_btnfmv",{format:dateFmt});var formData=new FormData;formData.append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),formData.append("formId",ZP5Form.getCurrFormsOperation().formId),ZPA_Esign.openFilter(formData),ZPeopleComponents.select(pageId.find("#search_wfstatusfmv")).removeAllOptions(),ZPeopleComponents.select(pageId.find("#search_wfstatusfmv")).destroy(),ZPeopleComponents.select(pageId.find("#search_wfstatusfmv").append(Zsign.searchZsignWFStatus)),ZPeopleComponents.select("#search_perfrmdempfmv").removeAllOptions(),ZPeopleComponents.select("#search_perfrmdempfmv").destroy(),ZPeopleComponents.select(pageId.find("#search_perfrmdempfmv").append(Zsign.populateZsignTriggerbyList)),ZPeopleComponents.select(pageId.find("#search_viewfmv")).removeAllOptions(),ZPeopleComponents.select(pageId.find("#search_viewfmv")).destroy(),ZPeopleComponents.select(pageId.find("#search_viewfmv").append(Zsign.searchZsignview)),pageId.find("#search_viewfmv").on("zselectoptionclick",Zsign.Forms.searchAgreementsRecord),ZPeopleComponents.select("#search_statusfmv").removeAllOptions(),ZPeopleComponents.select("#search_statusfmv").destroy(),ZPeopleComponents.select($("select#search_statusfmv").append(Zsign.searchstatus)),Zsign.Forms.searchAgreementsRecord()},searchAgreementsRecord:function(){var pageId=$("#esignform_list");pageId.find("button#reset_envBtnfmv").removeClass("DN");var viewtype=pageId.find("#search_viewfmv").val(),serviceCode=ZPeopleComponents.select(document.getElementById("zp_esign_viewfmv")).getValue();Zsign.Forms.searchStatusSign(serviceCode),ZPeopleComponents.datefield(document.getElementById("doc_sentfromfmv")).setAttribute("value",""),ZPeopleComponents.datefield(document.getElementById("doc_sent_to_btnfmv")).setAttribute("value",""),pageId.find("#search_view_fltfmv").removeClass("DNI"),"6"==serviceCode&&"WorkFlowReports"==viewtype?(settingsPage.container.find("#search_view_fltfmv").removeClass("DNI"),pageId.find("#search_nameHeaderfmv").hasClass("DNI")||pageId.find("#search_nameHeaderfmv").addClass("DNI"),pageId.find("#docfoldergroupfmv").hasClass("DNI")||pageId.find("#docfoldergroupfmv").addClass("DNI"),pageId.find("#esignstatusfmv").hasClass("DNI")||pageId.find("#esignstatusfmv").addClass("DNI"),pageId.find("#esignwfstatusfmv").hasClass("DNI")&&pageId.find("#esignwfstatusfmv").removeClass("DNI"),pageId.find("#perfrmdbylistfmv").hasClass("DNI")&&pageId.find("#perfrmdbylistfmv").removeClass("DNI"),pageId.find("#recordIdsearchfmv").hasClass("DNI")&&pageId.find("#recordIdsearchfmv").removeClass("DNI")):"6"==serviceCode?(pageId.find("#search_nameHeaderfmv").hasClass("DNI")&&pageId.find("#search_nameHeaderfmv").removeClass("DNI"),pageId.find("#fromDatefilterfmv").hasClass("DNI")&&pageId.find("#fromDatefilterfmv").removeClass("DNI"),pageId.find("#toDatefilterfmv").hasClass("DNI")&&pageId.find("#toDatefilterfmv").removeClass("DNI"),pageId.find("#docfoldergroupfmv").hasClass("DNI")&&pageId.find("#docfoldergroupfmv").removeClass("DNI"),pageId.find("#esignstatusfmv").hasClass("DNI")&&pageId.find("#esignstatusfmv").removeClass("DNI"),pageId.find("#esignwfstatusfmv").hasClass("DNI")||pageId.find("#esignwfstatusfmv").addClass("DNI"),pageId.find("#perfrmdbylistfmv").hasClass("DNI")||pageId.find("#perfrmdbylistfmv").addClass("DNI"),pageId.find("#emailIdsearchfmv").hasClass("DNI")||pageId.find("#emailIdsearchfmv").addClass("DNI"),pageId.find("#recordIdsearchfmv").hasClass("DNI")||pageId.find("#recordIdsearchfmv").addClass("DNI")):"4"!=serviceCode&&"2"!=serviceCode||(pageId.find("#docfoldergroupfmv").removeClass("DNI"),pageId.find("#search_nameHeaderfmv").removeClass("DNI"),pageId.find("#esignstatusfmv").removeClass("DNI"),pageId.find("#recordIdsearchfmv").addClass("DNI"),pageId.find("#emailIdsearchfmv").addClass("DNI"),pageId.find("#perfrmdbylistfmv").addClass("DNI"),pageId.find("#esignwfstatusfmv").addClass("DNI"),pageId.find("#search_view_fltfmv").addClass("DNI"))},searchStatusSign:function(serviceCode){ZPeopleComponents.select("#search_statusfmv").removeAllOptions(),ZPeopleComponents.select("#search_statusfmv").destroy(),ZPeopleComponents.select($("select#search_statusfmv").append(Zsign.searchstatus(serviceCode)))},setEsignRecordId:function(){if(void 0!=ZP5Views.currViewRecObj&&void 0!=ZP5Views.currViewRecObj.message.recordDetails){var recordIdList="",data=ZP5Views.currViewRecObj.message.recordDetails;$.each(data,function(index,obj){""!=recordIdList&&(recordIdList+=","),recordIdList+=obj.recordId})}Zsign.Forms.getEsignRecordList(recordIdList)},createFolderComp:function(){var createAgr=$("#esignform_list_card"),tokenObj={options:Zsign.folderList,dataMapping:{label:"CatName",value:"CatID"},showSearchField:!0,isLabelHTMLEncoded:!0,viewPerPage:4,lazyLoading:!0,bodyItemVisibleCount:3,dropdownList:{appendTo:"#zsignFormFilterdiv",fitForElement:!0,isTextHTMLEncoded:!0}};createAgr.find("#agrselect_Catfmv").length>0?(ZPeopleComponents.isComponent("select#agrselect_Catfmv")&&ZPeopleComponents.select($("#agrselect_Catfmv")).destroy(),ZPeopleComponents.select(createAgr.find("#agrselect_Catfmv"),tokenObj)):ZPeopleComponents.isComponent("#search_catfmv")||ZPeopleComponents.select(createAgr.find("#search_catfmv"),tokenObj)},getEsignRecordList:function(event){var serviceCode=ZPeopleComponents.select(document.getElementById("zp_esign_viewfmv")).getValue(),methodName="getDocuments",url="/zpzsign/zohoSignModule";6==serviceCode&&void 0!=viewType&&"WorkFlowReports"==viewType?(url="/zpzsign/zohoSignModule/getWFDocuments",methodName="getWFDocuments",contentBody=pageId.find("#wfdocuments_listfmv")):"4"==serviceCode?(methodName="getEnvelopes",url="/docusign/docuSignModule"):"2"==serviceCode&&(methodName="getAgreementsList",url="/adobesign/adobeSignModule");var formData=ZP5Views.getViewParams(!0);formData.action=methodName,formData.conreqcsr=csrfToken,formData.isFormEsignReport=!0,formData.startInd=1,formData.limit=24,formData.mode="fetchEsignRecords",formData.conreqcsr=csrfToken,$.ajax({type:"POST",async:!1,url:url,data:formData,success:function(data){Zsign.Forms.constructDocumentList(data,formData,event)},error:function(data){Zsign.failedCallBack(data)}})},handleEsignRecords:function(data){Zsign.Forms.records=data},constructDocumentList:function(data,params,event){var agreementsListElms="",pageId=$("#esignform_list"),contentBody="";pageId.find("#create_agrfmv").removeClass("DN"),pageId.find("#right_options_esignfmv").removeClass("DNI"),Zsign.populateDocumentView(),void 0==isZohoReadView&&Zsign.getReadView(),pageId.find("#search_nameHeaderfmv").show(),pageId.find("#search_documentnamefmv").show(),pageId.find("#exportasZipfmv").show(),pageId.find("#docfoldergroupfmv").show();var contHTML="<p class='LH18I'>"+ZPI18N.getString("zp.doctabinfo")+"</p>";pageId.find("#doc_HeaderBarfmv .col-sm-7 .bc").find("span").remove(),pageId.find("#doc_HeaderBarfmv .col-sm-7 .bc").append('<span class="ML5 bld S16">'+ZPI18N.getString("zp.esignature")+'<i data-popover="true" data-html="true" class="PI_info S18 gry ML10 popHover" title="" data-content="'+contHTML+'"></i></span>'),pageId.find("#compBackbtnfmv").hide(),pageId.find("#fileCompTitlefmv").hide(),contentBody=pageId.find("#documents_listfmv");pageId.find("div#no_recfound_imgfmv").remove(),Zsign.isCachedDocumentList=!0;var listCount=data[1].length-1;1===data[1].length&&contentBody.find(".ZPListingUL").length>1?Zsign.Forms.documentFirescroll=!1:1===data[1].length?("search"!=event&&pageId.find("#create_agrfmv").addClass("DN"),pageId.find("#document_norecordsfmv .ctable").remove(),Zsign.Forms.newuinorecords(!0)):(pageId.find("div#document_norecordsfmv").addClass("DNI"),pageId.find("div#documents_listfmv").removeClass("DN"),pageId.find("div#documents_tablefmv").removeClass("DN"),Zsign.Forms.documentFirescroll=!(listCount<24),$.each(data[1],function(index,obj){if(obj.hasOwnProperty("limit")){var limitCnt,start=obj.start;limitCnt=1===start?listCount>1?listCount:start:listCount>1?listCount+start-1:start,data.length<=1&&(start=0,limitCnt=0),1==start&&(!0,contentBody.empty()),pageId.find("span#zp_view_page_cntfmv").html(start+"&nbsp;-&nbsp;"+limitCnt),contentBody.data({start:start,next:obj.nexpage})}else{var serviceName;"4"==obj.module?serviceName="DocuSign":"6"==obj.module?serviceName="ZohoSign":"2"==obj.module&&(serviceName="AdobeSign"),agreementsListElms+=Zsign.Forms.constructDocumentData(obj,"forms",serviceName)}}),contentBody.append(agreementsListElms),Zsign.setCatName(data[1]),contentBody.data({start:params.startInd}),pageId.find("div#document_footerfmv").removeClass("DN"),pageId.find("#create_agrfmv").removeClass("DN")),Zsign.populateDocumentView()},showExportDropdown:function(){"none"==$("#exportOptListDropfmv").css("display")?ZPeopleComponents.menu("#exportOptListDropfmv").show():ZPeopleComponents.menu("#exportOptListDropfmv").hide()},newuinorecords:function(noButton){var pageId=$("#esignform_list_card");pageId.find("#documents_listfmv").addClass("DN"),pageId.find("#document_norecordsfmv").removeClass("DNI"),pageId.find("#document_norecordsfmv").empty(),pageId.find("#documents_tablefmv").addClass("DN");var currScrollContObj=pageId.find("#document_norecordsfmv");void 0!=noButton&&noButton?currScrollContObj.append(Zsign.noFilesFoundConst("zp_nd_esign","","document_norecordsfmv")):currScrollContObj.append(Zsign.noFilesFoundConst("zp_nd_esign","","document_norecordsfmv",ZPI18N.getString("zp.esign.requestsignature"),Zsign.constructSendForSign))},newuinorecordswf:function(noButton){var pageId=$("#esignform_list_card");pageId.find("#wfdocuments_tablefmv").addClass("DN"),pageId.find("#wfdocument_norecordsfmv").removeClass("DNI"),pageId.find("#wfdocument_norecordsfmv").empty(),pageId.find("#wfdocuments_tablefmv").addClass("DN"),pageId.find("#wfdocument_norecordsfmv").append(Zsign.noFilesFoundConst("","","wfdocument_norecordsfmv","","",""))},constructDocumentData:function(obj,mode,serviceName){var row="";if($("#documents_tablefmv").removeClass("DN"),$("#documents_listfmv").removeClass("DN"),$("#document_norecordsfmv").addClass("DNI"),void 0==obj){$("#documents_tablefmv").addClass("DN"),$("#documents_listfmv").addClass("DN");var pageDiv=$("[id=document_norecordsfmv]");let emptyPage=new EmptyPages("zp_nd_esign",ZPI18N.getString("zp.lookup.norecfound"),"",pageDiv);return emptyPage.setButton(ZPI18N.getString("zp.requestsignature"),Zsign.constructSendForSign),emptyPage.show(),row}ZPSetupCommon.isEmpty(obj.catId)||obj.catId;var statusCls,status,ARID,agreementId,owner,completeDate,sentDate,categoryName,ownerId,size,agName=ZPSetupCommon.isEmpty(obj.name)?"[No name]":obj.name;"DocuSign"==serviceName&&(agName=ZPeople.decodeTxt(obj.name));var repName=[];if("single"==mode)if("AdobeSign"==serviceName&&null!=obj.agreementId?(status="Out for Signature",ARID=obj.ARID,agreementId=obj.agreementId,owner=obj.owner):"DocuSign"==serviceName&&null!=obj.envelopeId?(status="Sent",ARID=obj.recordId,agreementId=obj.envelopeId,owner=ZPeople.decodeTxt(obj.OWN)):(status="Draft",ARID=obj.recordId,agreementId=obj.requests.document_ids[0].document_id,owner=obj.OWN),ownerId=ZPeople.decodeTxt(obj.ownerId),sentDate=obj.SD,"DocuSign"==serviceName&&(sentDate=obj.statusDateTime),completeDate="",obj.topRecipient,categoryName=Zsign.folderListObj[obj.catId],statusCls="org","AdobeSign"==serviceName||"DocuSign"==serviceName){size=obj.recipients.length;for(var i=0;i<size;i++)0==i&&obj.recipients[i],repName.push(obj.recipients[i])}else{size=obj.requests.actions.length;for(i=0;i<size;i++)0==i&&obj.requests.actions[i].recipient_email,repName.push(obj.requests.actions[i].recipient_email)}else ARID=obj.ARID,agreementId=obj.agreementId,owner=obj.owner,ownerId=obj.ownerId,sentDate=obj.sentDate,repName=obj.recipients,obj.topRecipient,completeDate=obj.completeDate,categoryName=Zsign.folderListObj[obj.catId],statusCls="Sent"===obj.status||"Out for Signature"===obj.status||"Draft"===obj.status?"org":"Completed"===obj.status||"Signed"===obj.status?"grn d-flexclmcap5":"red",status=obj.status;var recordid="";void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams()&&void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId&&(recordid=ZP5Form.getFormClassObj().getParams().recordId),""==owner&&(owner=ZPI18N.getString("zp.deleteduser"),ownerId="");var isCancelled="Cancelled / Declined"===obj.status;return"formsHeader"==mode&&(row+="<th>"+ZPI18N.getString("zp.esign.docname")+"</th>",row+='<th width="300">'+ZPI18N.getString("zp.reciepents")+"</th>",row+='<th width="125">'+ZPI18N.getString("zp.datesent",new Array(""))+"</th>",row+="<th>"+ZPI18N.getString("zp.folder")+"</th>",row+='<th width="125">'+ZPI18N.getString("zp.status")+"</th>",row+='<th width="125">'+ZPI18N.getString("zp.actions")+"</th>"),row+='<tr documentId="'+ARID+'" isCancelled='+isCancelled+' envIdStr = "'+agreementId+'">',null!=obj.recipientPhoto?row+='<td><div class="zpl_em" ><div class="zpl_emimg"><img src="'+obj.recipientPhoto+'"></div>':row+='<td><div class="zpl_em" ><div class="zpl_emimg"><img src="'+obj.senderPhoto+'"></div>',"3"===obj.module||"4"===obj.module?row+='<div class="zpl_emdts txttrim w300" onclick=Docusign.getEnvelopePreview(\''+ARID+"','"+recordid+"')><div onmouseover=Zsign.mouseEnterFunction()><b>"+agName+" </b></div>":"5"===obj.module||"6"===obj.module?row+='<div class="zpl_emdts txttrim w300" onclick=Zsign.getDocumentPreview(\''+ARID+"','"+recordid+"')><div onmouseover=Zsign.mouseEnterFunction()><b>"+agName+" </b></div>":row+='<div class="zpl_emdts txttrim w300" onclick=Adobesign.getAgreementPreview(\''+ARID+"','"+recordid+"')><div onmouseover=Zsign.mouseEnterFunction()><b>"+agName+" </b></div>",row+=""==ownerId?"<span><em>"+owner+"</em></span>":"<span><em>"+ownerId+" </em><em>"+owner+"</em></span>",row+="</div></div></td>",repName.length>1?(row+="<td>",row+='<div class="zpl_tg"><span onmouseover=Zsign.mouseEnterFunction()>'+repName.toString().split(",")[0]+"</span></div>",repName.length>9?row+='<div id="recpTo_fmv_'+agreementId+'" onclick="Zsign.Esign.showMoreRecepients(\''+repName+"','"+agreementId+'\');" class="zpl_tg"><span>9+</span></div>':row+='<div id="recpTo_fmv_'+agreementId+'" onclick="Zsign.Esign.showMoreRecepients(\''+repName+"','"+agreementId+'\');" class="zpl_tg"><span>+'+(repName.length-1)+"</span></div>",row+="</td>"):row+='<td><div class="zpl_tg" ><span onmouseover=Zsign.mouseEnterFunction()>'+repName.toString().split(",")[0]+"</span></div></td>",row+='<td><span id="sentOnfmv">'+sentDate+"</span></td>",row+='<td id="cat_nmfmv"><span class="txttrim w150" onmouseover=Zsign.mouseEnterFunction()>'+categoryName+"</span></td>",row+=null!==completeDate&&void 0!==completeDate&&""!==completeDate?'<td name="env_statusfmv"><span class="'+statusCls+'">'+status+"</span><span>"+completeDate+"</span></td>":'<td name="env_statusfmv"><span class='+statusCls+">"+status+"</span></td>",row+='<td><div class="text-center"><div class="zpl_hvr">',"forms"!=mode&&"formsHeader"!=mode&&(row+='<i class="PI_downld" data-title-position="bottom" title="'+ZPI18N.getString("zp.Download")+'" onclick=Adobesign.downloadAttachement(this,"'+ARID+'","download") ></i>'),row+='<i class="PI_delete" data-title-position="bottom" title="'+ZPI18N.getString("zp.delete")+'" onclick=Zsign.deleteAgreementConfirm(Zsign.deleteAgreementRecord,this,"last","1");></i></div>',row+="</div></div></td></div>"},exportFiles:function(){if(FilesUtil.IP.isRestricted)FilesUtil.IP.showError(!0);else if(FilesUtil.Geo.isRestricted)FilesUtil.Geo.showError(!0);else{var infoPopUp=new InfoAlertMessage;infoPopUp.title=ZPI18N.getString("zp.files.operations.exportalert",new Array(ZPI18N.getString("zp.zs.documents").toLowerCase())),infoPopUp.despcription=ZPI18N.getString("zp.files.operations.exportinfo"),infoPopUp.yesButtonText=ZPI18N.getString("zp.confirm"),infoPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),infoPopUp.callback=function(){if(isadmin){var formData=new FormData;formData.append("conreqcsr",csrfToken),formData.append("startInd",1),formData.append("limit",24),formData.append("isFormEsignReport",!0),formData=FilesUtil.Geo.setLatLongParams(formData,!0),$.ajax({url:"/zpzsign/exportDocumentsAsZip",type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){ZPeople.Message.success(ZPI18N.getString("zp.exportfilesnotify"))},error:function(req){var errResponse=req.responseJSON[1];8103!==req.status&&8101!==req.status&&500!==req.status||ZPeople.Message.failure(errResponse.msg)}})}else ZPeople.Message.failure(ZPI18N.getString("zp.permissiondenied"))},infoPopUp.show()}},getESignList(){var viewType=$("#esignform_list").find("#search_viewfmv").val();"6"==ZPeopleComponents.select(document.getElementById("zp_esign_viewfmv")).getValue()&&"WorkFlowReports"==viewType?Zsign.Forms.getDocumentList("","","search","","","","WorkFlowReports"):Zsign.Forms.getDocumentList("","","search")},getDocumentList:function(e,modeType,event,sortDefined,sortOrderval,sortColumnval,viewType,serviceName){Zsign.Forms.initZDFilterComp();var pageId=$("#esignform_list");void 0!=viewType&&"WorkFlowReports"==viewType?(methodName="getWFDocuments",pageId.find("#documents_tablefmv").addClass("DN"),pageId.find("#document_norecordsfmv").addClass("DNI"),pageId.find("#documents_listfmv").addClass("DN"),ZPeopleComponents.select("#search_statusfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_catfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")),pageId.find("#search_documentnamefmv").val("")):(pageId.find("#wfdocuments_tablefmv").addClass("DN"),pageId.find("#wfdocument_norecordsfmv").addClass("DNI"),pageId.find("#wfdocuments_listfmv").addClass("DN"),ZPeopleComponents.select("#search_wfstatusfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_perfrmdempfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")),pageId.find("#recordId_searchfmv").val(""),pageId.find("#emailId_searchfmv").val("")),void 0==isAnySignConfigured&&Zsign.getEsignConfigurations(),"search"!=event&&"reset"!=event||Adobesign.hideAndShowFilterIC("close");var serviceCode=ZPeopleComponents.select(document.getElementById("zp_esign_viewfmv")).getValue();(void 0!=e&&13===e.keyCode||ZPSetupCommon.isEmpty(e))&&(Zsign.Forms.documentFirescroll=!1,Zsign.Forms.getFireScrollDocumentList(event,sortDefined,sortOrderval,sortColumnval,serviceCode))},getFireScrollDocumentList:function(event,sortDefined,sortOrderval,sortColumnval,serviceCode){var pageId=$("#esignform_list_card"),containerBody=$("#esignform_list"),contentBody=pageId.find("#documents_listfmv"),methodName="getDocuments",viewType=containerBody.find("#search_viewfmv").val();void 0==serviceCode&&(serviceCode=ZPeopleComponents.select(document.getElementById("zp_esign_viewfmv")).getValue()),6==serviceCode&&void 0!=viewType&&"WorkFlowReports"==viewType?(methodName="getWFDocuments",contentBody=pageId.find("#wfdocuments_listfmv")):"4"==serviceCode?methodName="getEnvelopes":"2"==serviceCode&&(methodName="getAgreementsList");var formId=ZP5Form.getCurrFormsOperation().formId,envName=pageId.find("input#search_documentnamefmv").val(),catId=ZPeopleComponents.select(pageId.find("select#search_catfmv")).getValue(),catName=ZPeopleComponents.select($("#search_catfmv")).getElement().find(".zselectbox__text").text(),status=pageId.find("select#search_statusfmv").val(),wfstatus=pageId.find("select#search_wfstatusfmv").val(),emailID=pageId.find("input#emailId_searchfmv").val(),recordId=pageId.find("input#recordId_searchfmv").val(),perfrmdbyId=pageId.find("select#search_perfrmdempfmv").val(),perfrmdbyName=ZPeopleComponents.select($("#search_perfrmdempfmv")).getElement().find(".zselectbox__text").text(),startInd=ZPSetupCommon.isEmpty(contentBody.data("start"))||contentBody.data("start");"search"==event||"reset"==event||"sort"==event?(Zsign.Forms.documentFirescroll=!1,contentBody.empty(),Zsign.Forms.docStartindex=1):1==Zsign.Forms.documentFirescroll?0==Zsign.Forms.docStartindex?Zsign.Forms.docStartindex=25:Zsign.Forms.docStartindex=Zsign.Forms.docStartindex+24:Zsign.Forms.docStartindex=1,startInd=Zsign.Forms.docStartindex;for(var sortColumn="",sortOrder=!1,getSortColumn="",searchParams={},toggleFields=pageId.find(".PI_sort"),i=0;i<toggleFields.length;i++){if(pageId.find("#"+toggleFields[i].id).hasClass("asc")){getSortColumn=pageId.find("#"+toggleFields[i].id).attr("id"),sortColumn=Zsign.Forms.getSortColumn(getSortColumn),sortOrder=!0;break}if(pageId.find("#"+toggleFields[i].id).hasClass("desc")){getSortColumn=pageId.find("#"+toggleFields[i].id).attr("id"),sortColumn=Zsign.Forms.getSortColumn(getSortColumn),sortOrder=!1;break}}""==sortColumn&&(void 0==sortDefined||""==sortDefined?(sortColumn="SENT_DATE",containerBody.find("#sort_sentDatefmv").addClass("desc")):(sortOrder=sortOrderval,sortColumn=sortColumnval));var sentFrom=ZPeopleComponents.datefield(document.getElementById("doc_sentfromfmv")).getValue().dateString,sentTo=ZPeopleComponents.datefield(document.getElementById("doc_sent_to_btnfmv")).getValue().dateString;if(""==sentFrom||0==sentFrom||void 0==sentFrom)sentFrom="-1";else{var fromText=ZPI18N.getString("zp.from");void 0!=viewType&&"WorkFlowReports"==viewType&&(fromText="wf_From"),searchParams[fromText]=sentFrom}if(""==sentTo||0==sentTo||void 0==sentTo)sentTo="-1";else{var toText=ZPI18N.getString("zp.to");void 0!=viewType&&"WorkFlowReports"==viewType&&(toText="wf_To"),searchParams[toText]=sentTo}var params=ZP5Views.getViewParams(!0);params.action="getDocuments",params.startInd=startInd,params.limit=24,params.mode="fetchEsignRecords",params.action=methodName,params.sortOrder=sortOrder,params.sortColumn=sortColumn,params.sentFrom=sentFrom,params.sentTo=sentTo,params.conreqcsr=csrfToken,ZPSetupCommon.isEmpty(envName)||("2"==serviceCode?params.agreementName=envName:"4"==serviceCode?params.envelopeName=envName:params.documentName=envName,searchParams[ZPI18N.getString("zp.name")]=envName),ZPSetupCommon.isEmpty(emailID)||(params.recipients=emailID,searchParams[ZPI18N.getString("zp.emailid")]=emailID),ZPSetupCommon.isEmpty(recordId)||(params.recordId=recordId),ZPSetupCommon.isEmpty(recordId)||""===recordId||(searchParams[ZPI18N.getString("zp.historyExportRecordId")]=recordId),ZPSetupCommon.isEmpty(catId)||"select"===catId||"-1"===catId||(params.catId=catId),ZPSetupCommon.isEmpty(catName)||"Select"===catName||(searchParams[ZPI18N.getString("zp.folder")]=catName),ZPSetupCommon.isEmpty(status)||"select"===status||(params.status=status,searchParams[ZPI18N.getString("zp.status")]=status),ZPSetupCommon.isEmpty(wfstatus)||"select"===wfstatus||(params.wfstatus=wfstatus,searchParams[ZPI18N.getString("zp.wfstatus")]=wfstatus),ZPSetupCommon.isEmpty(formId)||(params.formId=formId),ZPSetupCommon.isEmpty(perfrmdbyId)||"select"===perfrmdbyId||(params.perfmerecno=perfrmdbyId),params.isFormEsignReport=!0,ZPSetupCommon.isEmpty(perfrmdbyName)||"Select"===perfrmdbyName||(searchParams[ZPI18N.getString("zp.triggeredby")]=perfrmdbyName),void 0!=viewType&&"WorkFlowReports"==viewType&&(searchParams[ZPI18N.getString("zp.viewtype")]=ZPI18N.getString("zp.esign.wf.tabname2"));Zsign.breadcrumb_construct(searchParams);if(6==serviceCode&&void 0!=viewType&&"WorkFlowReports"==viewType?$.ajax({url:"/zpzsign/zohoSignModule/getWFDocuments",type:"POST",data:params,async:!1,success:function(datas){Zsign.Forms.constructWFDocumentList(datas)}}):6==serviceCode?$.ajax({url:"/zpzsign/zohoSignModule",type:"POST",data:params,async:!1,success:function(datas){Zsign.Forms.constructDocumentList(datas,params,event)},failure:function(datas){Zsign.failedCallBack(datas)}}):"2"==serviceCode?$.ajax({url:"/adobesign/adobeSignModule",type:"POST",data:params,async:!1,success:function(datas){Zsign.Forms.constructDocumentList(datas,params,event)},failure:function(){this.failedCallBack}}):"4"==serviceCode&&$.ajax({url:"/docusign/docuSignModule",type:"POST",data:params,async:!1,success:function(datas){Zsign.Forms.constructDocumentList(datas,params,event)},failure:function(){this.failedCallBack}}),1==Zsign.Forms.documentFirescroll){var fireScrollId=$("#esignRepScrollID");new FireScrollBack(Zsign.Forms.getFireScrollDocumentList,fireScrollId,Zsign.Forms.docfireScrollUniqID)}},resetFilter:function(){Zsign.Forms.resetFilterOptions();var serviceCode=ZPeopleComponents.select(document.getElementById("zp_esign_viewfmv")).getValue();"6"==serviceCode?Zsign.Forms.getDocumentList("","","reset"):"2"==serviceCode?Adobesign.Forms.getAgreementsList(0,"reset",!0):Docusign.Forms.getEnvelopeList("","","reset")},resetFilterOptions:function(){var pageId=$("#esignform_list_card");ZPeopleComponents.select("select#search_viewfmv").setAttribute("selectedValue","ESignatureDocuments"),pageId.find("#search_documentnamefmv").val(""),ZPeopleComponents.datefield(document.getElementById("doc_sent_to_btnfmv")).setAttribute("value",""),ZPeopleComponents.datefield(document.getElementById("doc_sentfromfmv")).setAttribute("value",""),ZPeopleComponents.select("#search_statusfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_catfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_wfstatusfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")),ZPeopleComponents.select("#search_perfrmdempfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")),pageId.find("#recordId_searchfmv").val(""),pageId.find("#emailId_searchfmv").val("")},constructWFDocumentList:function(data,params){var pageId=$("#esignform_list_card"),row="";data[1].length<24?Zsign.Forms.documentFirescroll=!1:Zsign.Forms.documentFirescroll=!0,0===data[1].length&&0===pageId.find("#wfdocuments_listfmv tr").length?(settingsPage.container.find("#wfdocument_norecordsfmv .ctable").remove(),Zsign.Forms.newuinorecordswf(),pageId.find("#wfdocuments_listfmv").addClass("DN"),pageId.find("#wfdocuments_tablefmv").addClass("DN")):(pageId.find("#wfdocument_norecordsfmv").addClass("DNI"),pageId.find("#wfdocuments_listfmv").removeClass("DN"),pageId.find("#wfdocuments_tablefmv").removeClass("DN")),$.each(data[1],function(index,obj){if(!obj.hasOwnProperty("limit")){var status="Failure";obj.s&&(status="Success"),void 0==obj.e&&(obj.e=""),row+='<tr onclick=Zsign.viewApprovalPopup("'+obj.fid+'","'+obj.rcid+'",false) >',row+='<td class="tsize" >'+obj.wn+"</td>",row+='<td class="tsize" >'+ZSEC.Encoder.encodeForHTML(obj.esignName)+"</td>",row+="<td>"+ZSEC.Encoder.encodeForHTML(obj.formnm)+"</td>",row+="<td>"+ZSEC.Encoder.encodeForHTML(obj.perfnm)+"</td>",row+="<td>"+obj.time+"</td>",obj.s?row+='<td><span class="'+"grn d-flexclmcap5"+'">'+status+"</span></td>":(row+="<td><span class="+"red"+">"+status,row+='</span><i class="PI_info popHover red" data-title-position="auto" data-title-display-type="callout" title="'+ZPI18N.getString("zp.error")+" : "+ZPeople.escapeHtml(obj.e)+'"></i></td>'),row+="</tr>"}}),pageId.find("#wfdocuments_listfmv").append(row)},initZDFilterComp:function(serviceName){var pageId=$("#esignform_list");if(!Zsign.Forms.initZDFilter){ZPeopleComponents.datefield("#doc_sentfromfmv",{format:dateFmt}),ZPeopleComponents.datefield("#doc_sent_to_btnfmv",{format:dateFmt});var formData=new FormData;formData.append("methodName","getCategoryList"),formData.append("conreqcsr",csrfToken),formData.append("formId",ZP5Form.getCurrFormsOperation().formId),ZPA_Esign.openFilter(formData),ZPeopleComponents.select(pageId.find("#search_wfstatusfmv")).removeAllOptions(),ZPeopleComponents.select(pageId.find("#search_wfstatusfmv")).destroy(),ZPeopleComponents.select(pageId.find("#search_wfstatusfmv").append(Zsign.searchZsignWFStatus)),ZPeopleComponents.select("#search_perfrmdempfmv").removeAllOptions(),ZPeopleComponents.select("#search_perfrmdempfmv").destroy(),ZPeopleComponents.select(pageId.find("#search_perfrmdempfmv").append(Zsign.populateZsignTriggerbyList)),ZPeopleComponents.select(pageId.find("#search_viewfmv")).removeAllOptions(),ZPeopleComponents.select(pageId.find("#search_viewfmv")).destroy(),ZPeopleComponents.select(pageId.find("#search_viewfmv").append(Zsign.searchZsignview)),settingsPage.container.find("#search_viewfmv").on("zselectoptionclick",Zsign.Forms.searchAgreementsRecord),ZPeopleComponents.select("#search_statusfmv").removeAllOptions(),ZPeopleComponents.select("#search_statusfmv").destroy(),ZPeopleComponents.select($("select#search_statusfmv").append(Zsign.searchstatus)),Zsign.Forms.searchAgreementsRecord(),Zsign.Forms.initZDFilter=!0}},removeZsignBreadCrumb:function(key,isReset){var pageId=$("#esignform_list_card");void 0==key||isReset||key==ZPI18N.getString("zp.viewtype")?(ZPeopleComponents.select("select#search_viewfmv").setAttribute("selectedValue","ESignatureDocuments"),Zsign.Forms.resetFilter(),Zsign.Forms.searchAgreementsRecord()):key==ZPI18N.getString("zp.name")?pageId.find("#search_documentnamefmv").val(""):key==ZPI18N.getString("zp.from")?ZPeopleComponents.datefield(document.getElementById("doc_sentfromfmv")).setAttribute("value",""):key==ZPI18N.getString("zp.to")?ZPeopleComponents.datefield(document.getElementById("doc_sent_to_btnfmv")).setAttribute("value",""):key==ZPI18N.getString("zp.emailid")?pageId.find("#emailId_searchfmv").val(""):key==ZPI18N.getString("zp.historyExportRecordId")?pageId.find("#recordId_searchfmv").val(""):key==ZPI18N.getString("zp.folder")?ZPeopleComponents.select("#search_catfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")):key==ZPI18N.getString("zp.status")?ZPeopleComponents.select("#search_statusfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")):key==ZPI18N.getString("zp.wfstatus")?ZPeopleComponents.select("#search_wfstatusfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select")):key==ZPI18N.getString("zp.formname")?(pageId.find("#emailId_searchfmv").val(""),pageId.find("#emailId_searchfmv").addClass("DNI"),settingsPage.container.find("#emailIdsearchfmv").addClass("DNI"),ZPeopleComponents.select("#search_formfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select"))):key==ZPI18N.getString("zp.triggeredby")&&ZPeopleComponents.select("#search_perfrmdempfmv").setAttribute("selectedValue",ZPI18N.getString("zp.select"))},toggleSortSign:function(ele){var module=ZPeopleComponents.select(document.getElementById("zp_esign_viewfmv")).getValue(),sortOrder=!1,sortColumn="",pageId=$("#esignform_list");Zsign.isFromFormReport&&(pageId=$("#esignform_list_card"));for(var toggleFields=pageId.find(".PI_sort"),i=0;i<toggleFields.length;i++)toggleFields[i].id!==ele.id?pageId.find("#"+toggleFields[i].id).removeClass("asc").removeClass("desc"):ele.classList.contains("desc")?pageId.find(ele).removeClass("desc").addClass("asc"):pageId.find(ele).removeClass("asc").addClass("desc");sortColumn="sort_fileNamefmv"==pageId.find(ele).attr("id")?"NAME":"SENT_DATE",ele.classList.contains("desc")?sortOrder=!1:ele.classList.contains("asc")&&(sortOrder=!0),void 0!=module&&""!=module&&("6"==module?Zsign.Forms.getDocumentList("","","sort",!0,sortOrder,sortColumn):"2"==module?Adobesign.getAgreementsList("","sort","","",!0,sortOrder,sortColumn):Docusign.getEnvelopeList("","","sort",!0,sortOrder,sortColumn))},getSortColumn:function(sortedID){return"sort_fileNamefmv"==sortedID?"NAME":"SENT_DATE"}};var Adobesign={norecElm:'<tr><td class="text-center" colspan="7">'+ZPI18N.getString("zp.norecfound")+"</td></tr>",isFilterCached:!1,adobeCompatibleExtns:["pdf","doc","docx","xls","pdf","xlsx","ppt","pptx","jpg","png","gif","tif","txt","rtf"],fileName:null,fileId:null,isSendAgreement:!1,isCancelAgr:!1,isFilterOpen:!1,emailidfield:{},fileuploadfield:{},isFormCatListCached:!1,isChinaSetup:!1,recordId:null,agreeStartindex:0,agreeFirescroll:!1,selectedRecpForm:null,documentId:null,add:{header:'<h6 id="agreementHeader" class="addPopTitle">'+ZPI18N.getString("zp.requestsignature")+'</h6><button aria-label="Close" data-dismiss="modal" onclick="Adobesign.getAgreementsListPage()" class="close" id="close_btn" type="button"><span aria-hidden="true"><div class="PI_cls red S21 CP"></div></span></button>',bodyFormCont:'<div class="zpl_crd"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.filedetails")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn" id="uploadSection"><div><h6 class="zpl_mtry">'+ZPI18N.getString("zp.esign.uploadfile")+'</h6></div><div><div class="zpl_upld"><div id="drop_area" ondrop="event.stopPropagation(); event.preventDefault(); Zsign.dropHandler(event)" ondragover="event.preventDefault();" class="zpl_fldrp"><h5><div class="zpl_flupld_img"></div><input id="uploadFile" type="file" data-text="Desktop" style="display: none" /><a id="localUpload" class="zpl_lnk"><i class="PI_case"></i>'+ZPI18N.getString("zp.files.desktop")+'</a>/<a class="zpl_lnk" onClick="CloudPicker.construct()"><i class="PI_cloud"></i>'+ZPI18N.getString("zp.files.cloud")+"</a></h5></div><p><span>"+ZPI18N.getString("zp.supportedfiles")+"</span><span>"+ZPI18N.getString("zp.impmaxsize")+': 5MB</span></p></div></div></div><div class="zpl_secn" id="attachments"></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select id="agrselect_Cat"></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+'</div></div></div></div></div></div></div></div></div><div class="zpl_crd" id="docDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div><input id="document_name" type="text" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><textarea class="ztextbox" id="document_message" rows="3"></textarea></div></div></div></div><div class="zpl_crd"><div class="zpl_crdhdr" id="recpHeader"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div id="recp_rows" ><div id="addbttnrow" style="margin-top: 15px;" class="zpl_idiv">    <div class="w20"></div><a class="zpl_lnkbg" id="addRecpbtn" onclick=Zsign.addRecpRows("userbtnId")> '+ZPI18N.getString("zp.esign.addrecp")+"</a></div></div></div></div></div></div></div></div>",bodyCont:'<div class="zpl_crd"><div class="zpl_crdhdr" id="optionHeader"><div><h4>'+ZPI18N.getString("zp.esign.additionaloptions")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><label>'+ZPI18N.getString("zp.local.Expirydate")+'</label><div id="dlParent" style="position: relative;"><input id="deadline" data-format="date-short" data-calendar-icon="true" data-picker="true" data-clear-button="none" data-spin-buttons="none" data-width="258" style="display:none"></div></div><div class="zpl_secn"><div class="zcheckbox"><input id="reminder_check" type="checkbox" name="check" value="" class="zcheckbox__helper"><label class="zcheckbox__label" onclick="Zsign.showRemainderMode()">'+ZPI18N.getString("zp.sendreminders")+'</label></div><div id="reminderrbtn" class="zpl_tbox disabled"><div><div class="zradiobutton zradiobutton--horizontal" onclick="Adobesign.showReminder(this)"><input type="radio" name="reminder" value="1" id="daily" checked="Checked" class="zradiobutton__helper" ><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.daily")+'</span></label></div><div class="zradiobutton zradiobutton--horizontal" onclick="Adobesign.showReminder(this)"><input type="radio" id="weekly" value="2" name="reminder" class="zradiobutton__helper"><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.weeklybackup")+'</span></label></div></div></div><div class="" id="remindRecp" style=""></div><div class="zcheckbox"><input id="senderSign" type="checkbox" name="check" value="" class="zcheckbox__helper"><label class="zcheckbox__label" onclick=Zsign.showRemainderMode("flow")>'+ZPI18N.getString("zp.selfsignature")+'</label></div><div id="my_sign" class="" style=""><div id="senderSignFlow" class="zpl_tbox disabled"><div><div class="zradiobutton zradiobutton--horizontal" onclick="Adobesign.toggleSignFlowDiv(this)"><input type="radio" name="signature_flow" value="1" id="firstSign" class="zradiobutton__helper" ><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.firstsigner")+'</span></label></div><div class="zradiobutton zradiobutton--horizontal" onclick="Adobesign.toggleSignFlowDiv(this)"><input type="radio" id="lastSign" value="2" name="signature_flow" class="zradiobutton__helper"><label class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.lastsigner")+'</span></label></div></div></div></div><div class="zcheckbox" id="showDocPreview" ><input type="checkbox" id="previewDoc" name="check" value="" class="zcheckbox__helper"><label class="zcheckbox__label" onclick=Zsign.showRemainderMode("preview")>'+ZPI18N.getString("zp.showdocumentpreview")+'</label></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.language")+'</label></div><div><select id="selectLang"><option>'+ZPI18N.getString("zp.lms.messages.choose")+'</option><option data-separator="Boolean"> </option></ata-separator="Boolean"> </option> </select></div></div></div></div><div class="embed-iframe" id="embed_iframe" style="display:none; top: 70px;width: 100%;height: 100%;padding-bottom: 20px;padding-right: 20px;"><iframe src="" name="createAgmntResp" style=" width: 100%; height: 100%; border: 1px solid var(--brdr_gry); "></iframe></div>',bodyNewFormsSlider:'<div class="zpl_crd" id="basicDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.filedetails")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn" id="uploadSection"><div><h6 class="zpl_mtry">'+ZPI18N.getString("zp.esign.uploadfile")+'</h6></div><div><div class="zpl_upld"><div class="zpl_fldrp"><h5><div name="fileRoleOptions" id="fileRoleOptions" onclick="ZPA_Esign.showfileuploadDropdown()" class="zselectbox select-js has-focus has-mfocus flslct wauto"><option>'+ZPI18N.getString("zp.esign.fileuploadfield")+'</option><i class="zselectbox__icon zselectbox__arrowicon"><svg class="zselectbox__arrow" focusable="false"><use xlink:href="#zc__svg--downarrow"></use></svg></i></div><div id="fileRoleOptionsList"></div><div id="tempRoleOptions" onclick="ZPA_Esign.showTemplateDropdown()" class="zselectbox select-js has-focus has-mfocus flslct wauto"><option>'+ZPI18N.getString("zp.esign.mailmerge.small")+'</option><i class="zselectbox__icon zselectbox__arrowicon"><svg class="zselectbox__arrow" focusable="false"><use xlink:href="#zc__svg--downarrow"></use></svg></i></div><div id="TemplateOptionsList"></div></h5></div><p><span>'+ZPI18N.getString("zp.supportedfiles")+"</span><span> "+ZPI18N.getString("zp.impmaxsize")+': 5MB</span></p></div></div><div class="zpl_secn DN" id="attachments"><div><h5>'+ZPI18N.getString("zp.attachmentfiles")+'</h5></div><div class="zpl_atchd"></div></div><div class="zpl_secn DN" id="zsignTempAttach"><div><h5>'+ZPI18N.getString("zp.esign.seltemp")+'</h5></div><div class="zpl_atchd"></div></div></div><div class="zpl_secn" id="attachments"></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select id="agrselect_Cat"></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+'</div></div></div></div></div></div></div></div></div><div class="zpl_crd" id="docDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div><input id="document_name" type="text" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><textarea class="ztextbox" id="document_message" rows="3"></textarea></div></div></div></div><div class="zpl_crd"><div class="zpl_crdhdr" id="recpHeader"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div id="recp_rows"><div id="addbttnrow" style="margin-top: 15px;" class="zpl_idiv"><div class="w20"></div><a class="zpl_lnkbg" id="addRecpbtn" onclick=Zsign.addRecpRows("userbtnId")> '+ZPI18N.getString("zp.esign.addrecp")+"</a></div></div></div></div></div></div></div></div>",bodyNewFilesSlider:'<div class="zpl_crd" id="basicDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.filedetails")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn" id="uploadSection"><div><h5>'+ZPI18N.getString("zp.files.operations.attachedfile")+'</h5></div></div><div class="zpl_secn" id="attachments"></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select id="agrselect_Cat"></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+'</div></div></div></div></div></div></div></div></div><div class="zpl_crd" id="docDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div><input id="document_name" type="text" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><textarea class="ztextbox" id="document_message" rows="3"></textarea></div></div></div></div><div class="zpl_crd"><div class="zpl_crdhdr" id="recpHeader"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div id="recp_rows"><div id="addbttnrow" style="margin-top: 15px;" class="zpl_idiv"><div class="w20"></div><a class="zpl_lnkbg" id="addRecpbtn" onclick=Zsign.addRecpRows("userbtnId")>'+ZPI18N.getString("zp.esign.addrecp")+"</a></div></div></div></div></div></div></div></div>",footer:'<div id="ca_footer" class="modal-footer text-left"><button onclick="Adobesign.createAgreement(this)" id="footer_submit" type="button" class="btn btn-primary">'+ZPI18N.getString("zp.send")+'</button><button type="button" onclick="Adobesign.getAgreementsListPage()" id="footer_close" data-dismiss="modal" class="btn btn-default">'+ZPI18N.getString("zp.canceldocument")+"</button></div>"},openAgreement:function(mode,isFromEmployeeView){Adobesign.selectedRecpForm=null,Adobesign.isFromEmployeeView=isFromEmployeeView;var file_elm,pageId=Layout.Page.container,searchElm=pageId.find("div#createAgreementModal");if(0===searchElm.length?ZPeople.BSModal.setup({id:"createAgreementModal",type:22,modalClass:"popRgtModel",headerHtml:Adobesign.add.header,body:Adobesign.add.bodyCont,footer:Adobesign.add.footer}):(ZPeople.BSModal.setup({id:"createAgreementModal",type:2,modalClass:"popRgtModel"}),searchElm.removeClass("PopMdxModel l0"),searchElm.find("form#createAgmntForm,div#ca_footer,#close_btn,button#footer_submit").show(),searchElm.find("button#footer_close").text(ZPI18N.getString("zp.cancel")),searchElm.find("input[class='form-control'],textarea#document_message").val(""),searchElm.find("input[type='checkbox']").prop("checked",!1),searchElm.find("div#my_sign,div#remindRecp").hide(),searchElm.find("div#afterUpload").addClass("DN"),searchElm.find("div#beforeUpload").removeClass("DN"),searchElm.find("div#zp_page_loading").remove(),searchElm.find("iframe[name='createAgmntResp']").hide(),searchElm.find("input#uploadfile").val(""),searchElm.find("form#createAgmntForm input[type='text'] textarea").val(""),pageId.find("i#agrm_filterIc").attr("class","PI_fltr S18 CP FR ML20 MT5 gry"),searchElm.find("span#errormsg").remove(),searchElm.find("div#cancel_hrCat_btn,input#hrnewCategory").hide()),pageId.find("input#previewDoc").closest("label.checkbox").removeClass("disabled"),pageId.find("div#createAgreementModal").find("div#err_div").parent().remove(),pageId.find("div#createAgreementModal").find("select#uploadfile").parent().remove(),pageId.find("div#createAgreementModal").find("span#drop_file").parent().remove(),pageId.find("div#createAgreementModal").find("#recpList").remove(),pageId.find("div#createAgreementModal").find("#recp").empty(),isFromEmployeeView){var formId;formId=null!=Layout.Page.container.attr("id").match(/[\d]+$/)?Layout.Page.container.attr("id").match(/[\d]+$/).toString():ZP5Form.getFormClassObj().getParams().formId;var emailidfieldArr={},fileuploadfieldArr={},formCompData=ZPForm.FORM_COMPONENT_DATA[formId];void 0===formCompData&&$.ajax({type:"POST",async:!1,url:"/formAction.zp",data:{mode:"getFormComponents",conreqcsr:csrfToken,formId:formId},success:function(data){formCompData=data}});var formComp=formCompData.message;$.each(formComp.formComponentDetails,function(index){this.isTabular||($.each(this.column1,function(index,fieldData){if(this.fieldType==FormConstants.FieldType.EMAIL_ADDRESS){var fcId=this.formComponentId;emailidfieldArr[fcId]=this.displayName}else if(this.fieldType==FormConstants.FieldType.FILE_UPLOAD){fcId=this.formComponentId;fileuploadfieldArr[fcId]=this.displayName}}),$.each(this.column2,function(index,fieldData){if(this.fieldType==FormConstants.FieldType.EMAIL_ADDRESS){var fcId=this.formComponentId;emailidfieldArr[fcId]=this.displayName}else if(this.fieldType==FormConstants.FieldType.FILE_UPLOAD){fcId=this.formComponentId;fileuploadfieldArr[fcId]=this.displayName}}))}),Adobesign.emailidfield.formId=emailidfieldArr,Adobesign.fileuploadfield.formId=fileuploadfieldArr;var option='<option value="select">'+ZPI18N.getString("zp.select")+"</option>";Object.keys(Adobesign.fileuploadfield.formId).length>0&&$.each(Adobesign.fileuploadfield.formId,function(key,value){option+='<option value="'+key+'">'+value+"</option>"}),file_elm='<div class="col-sm-6"> <div class=""> <select id="uploadfile" fieldtype="26" name="file_lbl">'+option+"</select></div> </div>";var multiselin=pageId.find("div#createAgreementModal").find("#recp").find("select"),recpOption="";0!=multiselin.length&&void 0!=multiselin||(Object.keys(Adobesign.emailidfield.formId).length>0&&$.each(Adobesign.emailidfield.formId,function(key,value){recpOption+='<option value="'+key+'">'+value+"</option>"}),pageId.find("div#createAgreementModal").find("#recp").append('<select multiple placeholder = "Select fields containing Mail IDs" id="recpList" fieldtype="26" name="recipients">'+recpOption+"</select>"));var recList=[];$.each(pageId.find("table#zp_views_records_table tbody").find("input[id='zp_view_sel_record']:checked"),function(index,elm){recList.push($(elm).closest("tr").attr("recordId"))}),0==recList&&recList.push(ZP5Form.getFormClassObj().getParams().recordId),pageId.find("div#files_list").show(),pageId.find("div#template_grp").hide(),pageId.find("div#createAgreementModal").data({recList:recList}),pageId.find("input#previewDoc").closest("label.checkbox").addClass("disabled");var hashFormId=Layout.Page.hash.split("formId:")[1];void 0==hashFormId?(hashFormId=ZP5Form.getFormClassObj().getParams().formId,pageId.find("div#createAgreementModal").data({formId:hashFormId}),pageId.find("input#previewDoc").closest("label.checkbox").removeClass("disabled")):pageId.find("div#createAgreementModal").data({formId:hashFormId.substring(0,hashFormId.indexOf("/"))})}else pageId.find("div#createAgreementModal").find("#recp").append('<input placeholder="'+ZPI18N.getString("zp.entercommalist")+'" name="recipients" id="recpList" autocomplete="off" class="form-control">'),file_elm='<div class="col-sm-6"> <div class="ZPFFcus"> <span id="drop_file" class="txttrim">'+ZPI18N.getString("zp.integchoosefile")+'</span> <input name="agmntFile" id="uploadfile" onchange="Adobesign.setFIlename(this)" class="ZPFfile form-control"> </div> </div>';if(pageId.find("form#createAgmntForm").find("div#selectDoc,div#file_format").remove(),pageId.find("div#createAgreementModal").find("label#file_lbl").after(file_elm),isFromEmployeeView){pageId.find("div#createAgreementModal").find("label#file_lbl").parent().find("select").select2();var $eventSelect=pageId.find("div#createAgreementModal").find("#recpList").parent().find("select");$eventSelect.select2(),Adobesign.selectedRecpForm=[],Adobesign.selectedRecpForm=pageId.find("div#createAgreementModal").find("#recpList").val(),$eventSelect.on("change.select2",function(e){if(void 0!=e.added)Adobesign.selectedRecpForm.push(e.added.id);else if(void 0!=e.removed){const index=Adobesign.selectedRecpForm.indexOf(e.removed.id);index>-1&&Adobesign.selectedRecpForm.splice(index,1)}});var docType='<div id="selectDoc" style="" class="form-group"> <label class="control-label col-sm-3 Matry"><sup>*</sup>'+ZPI18N.getString("zp.sendfrom",new Array(""))+'</label> <div class="col-sm-6"> <label class="radio DIB MR8" onclick="Adobesign.showFilesElm()"><input checked="checked" value="1" type="radio" name="esign"><span class="ML2">'+ZPI18N.getString("zp.signoptnfromform")+'</span></label> <label class="radio DIB MR8" onclick="Adobesign.showFilesElm()" id="template_list"><input value="2" id="from_mm" type="radio" name="esign"><span class="ML2">'+ZPI18N.getString("zp.mmerge")+'</span></label> </div> </div><div class="form-group DN" id="file_format"><label class="control-label col-sm-3 Matry"><sup>*</sup>'+ZPI18N.getString("zp.selectformat")+'</label> <div class="col-sm-8"><div class="inlRadio"><label class="radio tagbgmail" onclick=MMtemplte.showViewType("1")><input name="1" checked="" id="select_pdf" type="radio"><span>'+ZPI18N.getString("zp.pdf")+'</span></label> <label class="radio tagbgmail" onclick=MMtemplte.showViewType("2")><input name="1" type="radio"><span>'+ZPI18N.getString("zp.docx")+"</span></label> </div></div><div></div></div>";pageId.find("form#createAgmntForm").find("div#selectDoc,div#file_format").remove(),pageId.find("form#createAgmntForm").prepend(docType),ZP_Mailmerge.constructMMTempList("form",null,null,null,null,!0)}else!isChinaSetup&&Layout.Page.hash.indexOf("agreementslistview-createAgreement")>-1&&pageId.find("div#createAgreementModal").find("input#uploadfile").parent().after(Envelope.add.cloud);var popUpDiv=pageId.find("#maxPopup"),toopTipDiv='<i data-content="<p>'+ZPI18N.getString("zp.maxfileuploadsize",[maxFileSize])+'</p>" data-popover="true" data-html="true" data-toggle="popover" data-placement="bottom" class="PI_info S18 gry form-icon popHover" data-original-title="" title=""></i>';popUpDiv.append(toopTipDiv)},setFIlename:function(thisObj){var fileObj=$(thisObj)[0].files[0];Layout.Page.container.find("div#createAgreementModal").find("span#drop_file").text(fileObj.name)},showFilesElm:function(type){var pageId=Layout.Page.container,modalObj=pageId.find("div#createAgreementModal");"envelope"===type?modalObj=pageId.find("div#createEnvelopeModal"):"document"===type&&(modalObj=pageId.find("div#createDocumentModal")),"1"===modalObj.find("input[name='esign']:checked").val()?(modalObj.find("div#files_list").show(),modalObj.find("div#template_grp").hide(),modalObj.find("div#file_format").addClass("DN")):(modalObj.find("div#files_list").hide(),modalObj.find("div#template_grp").show(),modalObj.find("div#file_format").removeClass("DN"))},openAgrModal:function(mode,thisObj){var returnHash,createAgrModal=Layout.Page.container.find("div#createAgreementModal");if(Adobesign.fileName=null,Adobesign.fileId=null,"Nbar2F"===$("div#page-wrapper").attr("class")&&(Adobesign.isFilterOpen=!0),"agreements"===mode)returnHash=Layout.Page.hash.indexOf("files/fileView/agreementslistview")>-1?"#files/fileView/agreementslistview-createAgreement":"#files/adobesign/agreementslistview-createAgreement",createAgrModal.find("input#uploadfile").attr("type","file");else{var fileId,fileName;fileId=thisObj,fileName=Layout.Page.container.find("div#hr_allfileList").find("ul[fileID="+fileId+"]").attr("fileName"),createAgrModal.find("input#uploadfile").attr("type","text"),Adobesign.fileName=fileName,Adobesign.fileId=fileId,Adobesign.isSendAgreement=!0,returnHash=Layout.Page.hash}window.location.href=returnHash,Zsign.Esign.getAgreementsListPage(mode)},createAgreement:function(thisElm){var reqUrl,err=!1,innerForm=!1,isFile=!1,formData=new FormData,isFromForm=!1,fileID=null,createAgr=$("#esign_card");Adobesign.isFromFormView=!1;var recipientsElms=createAgr.find("#recpFormValue_"+ele);$(".ztextbox--error__label").remove(),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(createAgr=$("#esignforms_card"),sliderId=$("#esignforms"),isFromForm=!0,Adobesign.isFromFormView=!0,void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId&&(innerForm=!0)):"0"==FilesUtil.Page.getTabGroup()?(createAgr=$("#cardesignfiles"),fileID=Zsign.compfileId,formData.append("fileId",fileID)):createAgr=$("#esign_card"),formData.append("isNewUI",!0);var recpNameLen=$('[name^="recpFormValue"]').length,recipientDetails=[];if(!Adobesign.validation(isFromForm)){if(recpNameLen>0)for(var ele=0;ele<recpNameLen;ele++){var recpOrder=ele,recpFormValue=ZPeopleComponents.select(createAgr.find("#recpFormValue_"+ele)).getValue(),recpFieldValue=ZPeopleComponents.select("#recpFieldValue_"+ele).getValue(),errMsg="",recpType=$("#recpType_"+ele).val(),recipientDetailsObject={};recipientDetailsObject[Zsign.RECIPIENT_ORDER]=recpOrder,recipientDetailsObject[Zsign.RECIPIENT_FIELD_TYPE]=recpFormValue,1==recpFormValue&&(recipientDetailsObject[Zsign.EMAIL_FORM_FIELD_TYPE]=recpFieldValue),recipientDetailsObject[Zsign.RECIPIENT_TYPE]=recpType,4==recpFormValue&&(null!=(recpFieldValue=createAgr.find("#recpEmailValue_"+ele).val())&&""!=recpFieldValue?(err=Adobesign.validateMailIds(recpFieldValue,$("#recpEmailValue_"+ele),ZPI18N.getString("zp.entervalidemailaddress")))&&createAgr.find($("#recpEmailValue_"+ele)).addClass("ztextbox__error"):(Adobesign.validateMailIds(recpFieldValue,$("#recpEmailValue_"+ele),ZPI18N.getString("zp.entervalidemailaddress")),createAgr.find($("#recpEmailValue_"+ele)).addClass("ztextbox__error"),err=!0),recipientDetailsObject[Zsign.RECIPIENT_ID]=recpFieldValue),recipientDetails.push(recipientDetailsObject),Adobesign.isFromFormView&&(null!=recpFieldValue&&""!=recpFieldValue||("1"==recpFormValue&&(errMsg=ZPI18N.getString("zp.selectemailfield")),"4"!==recpFormValue&&ZPeopleComponents.select(createAgr.find("#recpFieldValue_"+ele)).getElement().addClass("ztextbox__error"),createAgr.find("#recpFieldValue_"+ele).parent().parent().addClass("zpl_erorbx"),createAgr.find("#recpFieldValue_"+ele).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),err=!0))}if(ZPSetupCommon.isEmpty(recipientDetails)?(errMsg=ZPI18N.getString("zp.selectemailidfield"),createAgr.find("#recp_rows").before('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),err=!0):formData.append("recipientDetails",JSON.stringify(recipientDetails)),!err){if(Adobesign.isFromEmployeeView)createAgr.find("#uploadFile").val();else if("0"!=FilesUtil.Page.getTabGroup()&&"1"!=FilesUtil.Page.getTabGroup()){var agmntFile=Zsign.fileUploadObj;"file"===$(agmntFile).attr("type")&&(agmntFile=agmntFile.files[0],isFile=!0),isFile=!0;var recipientsMailIds=recipientsElms.val();null!=Adobesign.selectedRecpForm&&(recipientsMailIds=Adobesign.selectedRecpForm),this.constructMailFmt(recipientsMailIds)}var signature_flow,agreement_name=createAgr.find("#document_name").val(),agreement_message=createAgr.find("#document_message").val(),deadline=ZPeopleComponents.datefield(document.getElementById("deadline")).getValue().dateString,reminder=createAgr.find("#remindRecp").find("label :checked").val(),needsendersign=createAgr.find("#senderSign").is(":checked");$("#senderSign").is(":checked")&&($("#firstSign").is(":checked")?signature_flow="1":$("#lastSign").is(":checked")&&(signature_flow="2"));var preview_document=createAgr.find("#previewDoc").is(":checked");if(createAgr.find("#agrselect_newCatName").is(":visible")){var newCatName=createAgr.find("#agrselect_newCatName").val().trim();formData.append("newCatName",newCatName)}else{var catId=ZPeopleComponents.select(createAgr.find("#agrselect_Cat")).getValue();formData.append("catId",catId)}var language=$("select#selectLang").val();if($("#conreqcsr").val(csrfToken),isFile&&void 0!=agmntFile&&formData.append("agmntFile",agmntFile),formData.append("conreqcsr",csrfToken),formData.append("agreement_message",agreement_message),void 0!=deadline&&formData.append("deadline",deadline),formData.append("needsendersign",needsendersign),void 0!=signature_flow&&formData.append("signature_flow",signature_flow),formData.append("preview_document",preview_document),ZPSetupCommon.isEmpty(ZPA_Esign.uploadMode)||formData.append("uploadMode",ZPA_Esign.uploadMode),!ZPSetupCommon.isEmpty(CloudPicker.fileObj)&&void 0!=CloudPicker.fileObj.length&&Layout.Page.hash.indexOf("#operations/files/esigndocuments")>-1&&formData.append("cloudUploadDoc",CloudPicker.fileObj),ZPSetupCommon.isEmpty(language)||"select"===language||formData.append("language",language),ZPSetupCommon.isEmpty(reminder)||formData.append("reminder",reminder),ZPSetupCommon.isEmpty(agreement_name)&&createAgr.find("#document_name").val(createAgr.find("span#drop_file").text()),formData.append("agreement_name",$("#document_name").val()),isFromForm){innerForm?(formData.append("action","sendAgreement"),reqUrl="/adobesign/sendAgreement"):(formData.append("action","scheduleSendAgreement"),reqUrl="/adobesign/scheduleSendAgreement");var noOfAtth=$("#attachments .zpl_atchd").find("[name=fileOutDiv]").length;if(0==noOfAtth)return void createAgr.find("#attachments").append('<div class="ztextbox--error__label ML15 MT2" id="errormsg">'+ZPI18N.getString("zp.esign.uploadonedoc")+"</div>");for(var itr=0;itr<noOfAtth;itr++){var selId=$($("#attachments .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("selId"),source=$($("#attachments .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("source"),templateFieldsval={},fileFieldsval={},templateFields=[],templateoriginalFields=[],fileuploadFields=[],fileuploadFieldsoriginal=[];"fileupload"==source?(fileFieldsval.order=itr,fileFieldsval.filepathval=selId,fileuploadFields.push(fileFieldsval),fileuploadFieldsoriginal.push(selId)):"templates"==source&&(templateFieldsval.order=itr,templateFieldsval.templateIdval=selId,templateFields.push(templateFieldsval),templateoriginalFields.push(selId))}fileuploadFields.length>0?formData.append("fileList",fileuploadFieldsoriginal):templateFields.length>0&&formData.append("templateId",templateoriginalFields),isFromForm&&(formData.append("relatedModule","2"),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId?(formData.append("recordId",ZP5Form.getFormClassObj().getParams().recordId),formData.append("recList",ZP5Form.getFormClassObj().getParams().recordId),formData.append("formId",ZP5Form.getFormClassObj().getParams().formId)):(formData.append("recList",Zsign.ESIGN_FORMS_RECORD_IDS.toString()),formData.append("formId",ZP5Form.getCurrFormsOperation().formId)),formData.append("docType","pdf"),innerForm&&(!0,$("#esignforms #sliFootDiv #sliderCancel").hide(),$("#esignforms #sliFootDiv #sliderSbt").hide(),createAgr.find(".zpl_crd").hide()))}else"0"==FilesUtil.Page.getTabGroup()?($("#esignorg #sliFootDiv #sliderCancel").hide(),$("#esignorg #sliFootDiv #slidernxt").hide(),$("#esignorg_card").hide(),createAgr.find(".zpl_crd").hide(),!0,formData.append("action","sendAgreement"),reqUrl="/adobesign/sendAgreement"):($("#esign #sliFootDiv #sliderCancel").hide(),$("#esign #sliFootDiv #sliderSbt").hide(),createAgr.find(".zpl_crd").hide(),createAgr.find("#basicDetails, #docHeader, #recpHeader,#optionHeader, #moreSettings").addClass("DNI"),!0,formData.append("action","sendAgreement"),reqUrl="/adobesign/sendAgreement");formData.append("innerForm",innerForm),0==createAgr.parent().find("#zp_page_loading").length&&createAgr.after(ZPeople.LOADING_HTML),err||$.ajax({url:reqUrl,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){ZPA_Esign.resetuploadValues();var agreementResp=data[1];if(Adobesign.selectedRecpForm=null,isFromForm&&!innerForm){ZPeople.Message.success(ZPI18N.getString("zp.documentscheduled")),Layout.Page.container.find("#zp_views_formrecactions").attr("style","display:block");var formRowsObj=Layout.Page.container.find("table#zp_views_records_table tbody");return formRowsObj.find("input#zp_view_sel_record").prop("checked",!1),$.each(void 0,function(index,recId){formRowsObj.find("tr[recordid="+recId+"]").attr("isAgreementSent","true"),formRowsObj.find("tr[recordid="+recId+"]").attr("module",data[1].MODULE),formRowsObj.find("tr[recordid="+recId+"]").attr("agreeid",data[1].recordId)}),Layout.Page.container.find("div#zp_view_record_delete").hide(),Zsign.closePopup("esignforms"),Zsign.removeElementsfn(),$("#recordActionsContainer").removeClass("opn"),settingsPage.container.find($("#recordActions")).find("input").removeAttr("checked"),void settingsPage.container.find($("#recordContainer")).find("input").removeAttr("checked")}Zsign.newRecordDetails.agreeid=data[1].ARID,Zsign.newRecordDetails.module=data[1].MODULE,$("div#zp_page_loading").remove(),isFromForm?($("#esignforms").addClass("zpl_mfull"),$("#esignforms #sliFootDiv").show(),$("#esignforms #sliFootDiv #sliderCancel").show(),$("#esignforms #sliFootDiv #sliderCancel").text(ZPI18N.getString("zp.close")),$("#esignforms #sliFootDiv").addClass("zpl_mfoter zpl_btnsplt")):"0"==FilesUtil.Page.getTabGroup()?($("#esignfiles #sliFootDiv").hide(),$("#tabesignfiles").addClass("zpl_mfull"),$("#tabesignfiles #sliFootDiv").show(),$("#tabesignfiles #sliFootDiv #sliderSbt").hide(),$("#tabesignfiles #sliFootDiv #sliderCancel").show(),$("#tabesignfiles #sliFootDiv #sliderCancel").text(ZPI18N.getString("zp.close")),$("#tabesignfiles #sliFootDiv").addClass("zpl_mfoter zpl_btnsplt")):($("#esign").addClass("zpl_mfull"),$("#esign #sliFootDiv").show(),$("#esign #sliFootDiv #sliderCancel").show(),$("#esign #sliFootDiv #sliderCancel").text(ZPI18N.getString("zp.close")),$("#esign #sliFootDiv").addClass("zpl_mfoter zpl_btnsplt")),$("#optionHeader").hide(),$("#recpHeader").hide(),createAgr.find("button#close_btn").show(),$("iframe[name='createAgmntResp']").css("display","block"),$("iframe[name='createAgmntResp']").attr("src",agreementResp.url),$("#embed_iframe").show(),createAgr.find("div#zp_modal_body").addClass("NomdlFoot"),createAgr.addClass("PopMdxModel l0");agreementResp.status;if(-1===Layout.Page.hash.indexOf("-formId")&&-1===Layout.Page.hash.indexOf("files/hrfile")&&-1===Layout.Page.hash.indexOf("files/adobesign/agreementslistview")){var viewObj=Layout.Page.container.find("#documents_list_form"),relobj=Layout.Page.container.find("#anchor_single_doc_list");viewObj.is(":visible")&&(relobj.hasClass("collapsed")||relobj.addClass("collapsed"),viewObj.slideUp())}if(null!=fileID){var sendFileObj=$("tr[fileID="+fileID+"]");sendFileObj.find("i#send_agrmnt").addClass("grn"),sendFileObj.find("span#send_envelope").hide(),sendFileObj.attr("agreementId",agreementResp.ARID)}if(-1!==Layout.Page.hash.indexOf("operations/files/esigndocuments")){var pageId=settingsPage.container,envName=pageId.find("input#search_agname").val(),catId=pageId.find("select#search_cat").val(),status=pageId.find("select#search_status").val(),name=agreementResp.name,newCatId=agreementResp.catId,newStatus=ZPI18N.getString("zp.status0");pageId.find("#documents_list");pageId.attr("id").indexOf("esign_card")>-1&&$("#tab-files-esigndocuments #documents_list"),pageId.find("#documents_list").prepend(Zsign.constructDocumentData(agreementResp,"single","AdobeSign")),catId!=newCatId&&""!=catId&&"select"!=catId||status!=newStatus&&""!=status&&"select"!=status||-1==name.indexOf(envName)&&""!=envName||(agreementResp.name=ZSEC.Encoder.encodeForHTML(agreementResp.name),agreementResp.OWN=ZSEC.Encoder.encodeForHTML(agreementResp.OWN),agreementResp.ownerId=ZSEC.Encoder.encodeForHTML(agreementResp.ownerId),0===pageId.find("#agreements_list ul").length?(pageId.find("#agreement_norecords").removeClass("DN"),pageId.find("#agreement_norecords").addClass("Scrcont")):(pageId.find("#agreement_norecords .ctable").remove(),pageId.find("#agreement_norecords").removeClass("Scrcont"),pageId.find("#agreements_list").removeClass("DN"),pageId.find("#agreements_listingpage").removeClass("DN"),1===pageId.find("#agreements_list ul").length&&pageId.find("#agreements_listingpage").addClass("expand")))}},error:function(req){if(createAgr.parent().find("div#zp_page_loading").remove(),createAgr.find("form#createAgmntForm,div#ca_footer").show(),innerForm&&($("#esignforms #sliFootDiv #sliderCancel").show(),$("#esignforms #sliFootDiv #sliderSbt").show(),$("#esignforms_card").show()),400!==req.status){var errResponse=req.responseJSON[1];if(6013!=errResponse.errorCode)if(6014!=errResponse.errorCode){if(-1!=req.responseText.search("mailmerge")){var errorMsg;return errorMsg=JSON.parse(JSON.parse(req.responseText)[1].msg).error.message,void ZPeople.Message.failure(errorMsg)}if("string"==typeof errResponse.msg)ZPeople.Message.failure(errResponse.msg),$("div#zp_page_loading").remove(),createAgr.find("div#ca_footer,button#close_btn,#createAgmntForm").show();else{var dispMsg,validationMsg=errResponse.msg;if(validationMsg.hasOwnProperty("ef")){var dispName="<p>";$.each(validationMsg.ef,function(mailId,errorCompList){$.each(errorCompList,function(index,errId){var optElm=$("#viewsContainer").find("th[id="+errId+"]");-1===dispName.indexOf(optElm.text())&&(index>0&&(dispName+=","),dispName+=optElm.text())})}),dispMsg=dispName+=" is not available for this/these record(s) </p>"}else validationMsg.hasOwnProperty("extnerr")?dispMsg=ZPI18N.getString("zp.fileformaterr"):validationMsg.hasOwnProperty("disbaled")?dispMsg=validationMsg.disbaled:validationMsg.hasOwnProperty("limitEx")?dispMsg=validationMsg.limitEx:ZPeople.Message.failure(req.statusText);void 0!=dispMsg&&ZPeople.Message.failure(dispMsg)}}else ZPeople.Message.failure(ZPI18N.getString("zp.mmmailfailureerrormessadmin"));else ZPeople.Message.failure(ZPI18N.getString("zp.mmmailfailuresubject"))}else ZPeople.Message.failure(req.responseJSON.error)}})}}},validation:function(isFromForm){ZPA_Esign.resetAllErrorborder();var createAgr=$("#esign_card");isFromForm?createAgr=$("#esignforms_card"):"0"==FilesUtil.Page.getTabGroup()&&(createAgr=$("#cardesignfiles"));var agr_name_elm=createAgr.find("input#document_name").val(),agr_sub=createAgr.find("#document_message").val();$(".ztextbox--error__label").remove();var err=!1,maxSize=1e6*maxFileSize.split("MB")[0];if(!Adobesign.isFromForm&&-1!==Layout.Page.hash.indexOf("#operations/files/esigndocuments")){var agmntFile=Zsign.fileUploadObj;if(void 0!=agmntFile.name||"cloudUpload"===ZPA_Esign.uploadMode){if("cloudUpload"===ZPA_Esign.uploadMode)(ZPSetupCommon.isEmpty(CloudPicker.fileObj)||void 0==CloudPicker.fileObj.length)&&(err=!0);else if(agmntFile.size>maxSize?(err=!0,createAgr.find("#uploadFile").closest("div#err_div").after('<span class="ztextbox--error__label" id="errormsg">'+ZPI18N.getString("zp.customizedfilesizelimit",new Array(maxFileSize))+"</span>")):createAgr.find("#uploadFile").closest("div#err_div").next("span#errormsg").remove(),!err){var fileName=agmntFile.name,fileExtn=fileName.substr(fileName.lastIndexOf(".")+1,fileName.length);-1===Zsign.zsignEtxns.indexOf(fileExtn.toLowerCase())&&(err=!0,createAgr.find("#attachments").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.zs.choosepdffile")+"</span>"))}}else err=!0,createAgr.find("#uploadSection").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.choosedoc")+"</span>")}var noOfAtth=0;if(Adobesign.isFromEmployeeView&&($("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length>0?(noOfAtth=$("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length,!0):noOfAtth=$("#attachments .zpl_atchd").find("[name=fileOutDiv]").length,0==noOfAtth?(createAgr.find("#uploadSection").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.esign.uploadonedoc")+"</span>"),err=!0):noOfAtth>5&&(ZPeople.Message.failure(ZPI18N.getString("zp.zs.maxdocuploads")),err=!0)),createAgr.find("#agrselect_newCatName").is(":visible")){var newCatName=createAgr.find("#agrselect_newCatName").val().trim();""==newCatName?(createAgr.find("#agrselect_newCatName").addClass("ztextbox__error"),createAgr.find("#agrselect_newCatName").parent().append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.enterCategory")+"</span>"),err=!0):-1!=newCatName.indexOf("<")||-1!=newCatName.indexOf(">")||-1!=newCatName.indexOf("&lt;")||-1!=newCatName.indexOf("&gt;")?(ZPeople.Message.failure(ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.folder"))," > < ")),err=!0):null!=newCatName&&void 0!=newCatName&&"/"===newCatName&&(ZPeople.Message.failure(ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.lms.base.foldername"))," / ")),err=!0)}else{var catId=ZPeopleComponents.select(createAgr.find("#agrselect_Cat")).getValue();""!=catId&&"-1"!=catId||(ZPeopleComponents.select(createAgr.find("#agrselect_Cat")).getElement().addClass("ztextbox__error"),settingsPage.container.find("#agrselect_Cat").parent().append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.foldernameempty")+"</span>"),err=!0)}if((recipientsMailIds=createAgr.find('[name^="recpFormValue_"]').length)>0)for(var ele=0;ele<recipientsMailIds;ele++){var recipientsMailIds=ZPeopleComponents.select(createAgr.find("#recpFormValue_"+ele)).getValue();if(ZPSetupCommon.isEmpty(recipientsMailIds)||"-1"===recipientsMailIds){err=!0;var errMsg=ZPI18N.getString("zp.entervalidemailaddress");createAgr.find("#recpEmailValue_"+ele).parent().parent().addClass("zpl_erorbx"),createAgr.find("#recpEmailValue_"+ele).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>")}else if(Adobesign.validateMailIds(recipientsMailIds,createAgr.find("#recpEmailValue_"+ele),ZPI18N.getString("zp.entervalidemailaddress"))){err=!0;errMsg=ZPI18N.getString("zp.entervalidemailaddress");createAgr.find("#recpEmailValue_"+ele).parent().parent().addClass("zpl_erorbx"),createAgr.find("#recpEmailValue_"+ele).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>")}}var deadLine=ZPeopleComponents.datefield(document.getElementById("deadline")).getValue().dateString;if(!ZPSetupCommon.isEmpty(deadLine)){var lastDate=moment(deadLine,dateFmt.toUpperCase()).format("DD-MMM-YYYY").split("-"),month=Calendar.months.indexOf(lastDate[1])+1,lDate=lastDate[2]+"/"+month+"/"+lastDate[0];"NaN"===Date.parse(lDate).toString()||moment(lDate).diff(moment(),"days")<0?(err=!0,createAgr.find("input#deadline").after('<span class="ztextbox--error__label" id="errormsg">'+ZPI18N.getString("zp.holiday.dateerror")+"</span>")):createAgr.find("input#deadline").parent().find("span#errormsg").remove()}return ZPSetupCommon.isEmpty(createAgr.find("input#document_name").val())&&(err=!0,createAgr.find("#document_name").after('<span class="ztextbox--error__label" id="errormsg">'+ZPI18N.getString("zp.zs.documentnameempty")+"</span>"),createAgr.find("#document_name").addClass("ztextbox__error")),agr_name_elm.length>100&&(createAgr.find("#document_name").after('<span id="errormsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.lengthvalidation",new Array(ZPI18N.getString("zp.name"),100))+"</span>"),err=!0),-1==agr_name_elm.indexOf("<")&&-1==agr_name_elm.indexOf(">")||(ZPeople.Message.failure(ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.zs.documentname"))," > < ")),err=!0),agr_sub.length>1e3&&(createAgr.find("#document_message").after('<span id="errormsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.lengthvalidation",new Array(ZPI18N.getString("zp.message"),1e3))+"</span>"),err=!0),err},validateMailIds:function(mailId,obj,msg){var err=!1;if(mailId.length<=50){if(!ZPUtil.Validation.isEmail(mailId))return err=!0,obj.parent().parent().addClass("zpl_erorbx"),obj.parent().append('<span class="ztextbox--error__label" id="errorMsg">'+msg+"</span>"),err}else err=!0,obj.parent().parent().addClass("zpl_erorbx"),obj.parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.maildidslengthunlimit")+"</span>");return err},showRemindersMode:function(){Layout.Page.container;var createAgr=$("div#createAgreementModal"),reminderElm=createAgr.find("div#remindRecp");reminderElm.toggle(),createAgr.find("input#reminder_check").is(":checked")?$(reminderElm.find("input[name='reminder']")[0]).prop("checked",!0):$(reminderElm.find("input[name='reminder']")[0]).prop("checked",!1)},constructMailFmt:function(mailIds){var builtMailFmt="";return $.each(mailIds,function(index,mailId){builtMailFmt+="Email:"+mailId+":SIGNER",index!==mailIds.length-1&&(builtMailFmt+=",")}),builtMailFmt},getAgreementsListPage:function(mode){var returnHash;(Adobesign.recordId="",Layout.Page.container.find("div#createAgreementModal").removeClass("PopMdxModel l0"),-1!==Layout.Page.hash.indexOf("createAgreement")||-1!==Layout.Page.hash.indexOf("agreementId:"))&&(Layout.Page.container.find("div#viewAgreementModal").removeAttr("agrid"),Adobesign.isSendAgreement=!1,"Nbar2F"===$("div#page-wrapper").attr("class")&&(Adobesign.isFilterOpen=!0),-1===Layout.Page.hash.indexOf("agreementslistview")&&(Adobesign.isCancelAgr=!0),-1!==Layout.Page.hash.indexOf("files/fileView/hrfileslistview")?returnHash="#files/fileView/hrfileslistview":-1!==Layout.Page.hash.indexOf("files/hrfile/hrfileslistview")?returnHash="#files/hrfile/hrfileslistview":-1!==Layout.Page.hash.indexOf("files/fileView/companyfileslistview")?returnHash="#files/fileView/companyfileslistview":-1!==Layout.Page.hash.indexOf("files/companyfile/companyfileslistview")?returnHash="#files/companyfile/companyfileslistview":-1!==Layout.Page.hash.indexOf("files/fileView/agreementslistview")?returnHash="#files/fileView/agreementslistview":-1!==Layout.Page.hash.indexOf("files/adobesign/agreementslistview")&&(returnHash="#files/adobesign/agreementslistview"),window.location.href=returnHash)},funcToOpenFilter:function(){Adobesign.isFilterOpen&&($("div#page-wrapper").attr("class","Nbar2F"),Adobesign.isFilterOpen=!1)},toggleSignFlowDiv:function(thisObj){settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?pageId=$("#esignforms_card"):pageId=$("#esign_card"),"firstSign"==$(thisObj).find("input").attr("id")?(pageId.find("#lastSign").removeAttr("Checked"),$(thisObj).find("input").attr("Checked","Checked")):"lastSign"==$(thisObj).find("input").attr("id")&&(pageId.find("#firstSign").removeAttr("Checked"),$(thisObj).find("input").attr("Checked","Checked"))},getAgreementsList:function(modeCnt,evnt,isAjax,e,sortDefined,sortOrderval,sortColumnval){$("#exportList").removeClass("DN");Zsign.initZDFilterComp("AdobeSign"),settingsPage.container.find("#doc_multiselDel").addClass("DNI"),settingsPage.container.find("#documents_checkallbox").prop("checked",!1),void 0==isAnySignConfigured&&Zsign.getEsignConfigurations();var pageId=settingsPage.container;if("search"!=evnt&&"reset"!=evnt||Adobesign.hideAndShowFilterIC("close"),ZPSetupCommon.isEmpty(e)||!ZPSetupCommon.isEmpty(e)&&13===e.keyCode){Zsign.docStartindex=1,Zsign.documentFirescroll=!1,pageId.find("#documents_list").data({start:"1"}),Zsign.getFireScrollDocumentList(evnt,sortDefined,sortOrderval,sortColumnval,"2")}},setCatName:function(dataObj){var pageId=Layout.Page.container;$.each(dataObj,function(index,agreementDtls){var catId=ZPSetupCommon.isEmpty(agreementDtls.catId)?"0":agreementDtls.catId,categoryName=pageId.find("select#search_cat").find("option[value='"+catId+"']").text();pageId.find("#agreements_list").find("ul[agreementId='"+agreementDtls.ARID+"'] span#cat_nm").text(categoryName)})},getTotalRecordCount:function(){var pageId=Layout.Page.container,catId=pageId.find("select#search_cat").val(),status=pageId.find("select#search_status").val(),params={action:"getAgreementsRecordCount",conreqcsr:csrfToken,agreementName:pageId.find("input#search_agname").val()};"select"!==catId&&(params.catId=catId),"select"!==status&&(params.status=status),ZPeople.Request.send("/adobeSignActions.zp",params,Adobesign.showTotalCnt)},constructLanguage:function(){var languageList=[],formData=new FormData;return formData.append("action","getLanguagesList"),formData.append("conreqcsr",csrfToken),$.ajax({url:"/adobesign/getLanguagesList",type:"POST",data:formData,async:!1,contentType:!1,processData:!1,success:function(resultData){if(void 0!==resultData[1]){$.each(resultData[1],function(key,value){var languages=value.split("=");languageList.push({id:languages[0],name:languages[1]})})}}}),{options:languageList,dataMapping:{label:"name",value:"id"}}},getAgreementViewPage:function(thisObj,mode){var agreementId;agreementId=$(thisObj).closest("ul").attr("agreementId"),window.location.href=Layout.Page.hash+"-agreementId:"+agreementId},showTotalCnt:function(data){var pageId=Layout.Page.container;data?(pageId.find("span#agreement_totalcnt").text(data.count).removeClass("hide"),pageId.find("a#zp_views_recordcount").addClass("hide")):(pageId.find("span#agreement_totalcnt").addClass("hide"),pageId.find("a#zp_views_recordcount").removeClass("hide"))},hideAndShowFilterIC:function(mode){var parentId;Layout.Page.hash.indexOf("operations/files/esigndocuments")>-1?0!=(parentId=$("#tab-files-esigndocuments").parent().parent().parent()).find("#esigntemplatesParent").length&&parentId.find("#esigntemplatesParent").hasClass("zpl_mopen")?$("#zsigntempList").hasClass("zpl_fltr_flt")&&"close"==mode?$("#zsigntempList").removeClass("zpl_fltr_flt"):(void 0==mode||void 0!=mode&&"close"!=mode)&&($("#zsigntempList").addClass("zpl_fltr_flt"),Zsign.initZTFilterComp()):$("#tab-files-esigndocuments").hasClass("zpl_fltr_flt")&&"close"==mode?$("#tab-files-esigndocuments").removeClass("zpl_fltr_flt"):(void 0==mode||void 0!=mode&&"close"!=mode)&&$("#tab-files-esigndocuments").addClass("zpl_fltr_flt"):void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1&&((parentId=$("#esignform_list_card")).hasClass("zpl_fltr_flt")&&"close"==mode?parentId.removeClass("zpl_fltr_flt"):(void 0==mode||void 0!=mode&&"close"!=mode)&&(parentId.addClass("zpl_fltr_flt"),Zsign.initZTFilterComp()))},resetFilter:function(){var pageId=Layout.Page.container;pageId.find("#filter_params_agreeFiles").find("span").remove(),Zsign.breadcrumb_remove();var filterOptions=pageId.find("#search_cat,#search_status");filterOptions.select2("val","select"),filterOptions.trigger("change"),pageId.find("#agree_sentfrom").val(""),pageId.find("#agree_sentto").val(""),pageId.find("#search_agname").val(""),Adobesign.getAgreementsList(0,"reset",!0)},searchAgreementsRecord:function(){Layout.Page.container.find("button#reset_agrBtn").removeClass("DN")},getAgreementPreview:function(agreementId,thisObj,mode){var formId,agrId,recId,moduleType;agrId=agreementId,-1===settingsUrlProps.url.indexOf("-formId:")&&(agrId=settingsUrlProps.url.split("documentId:")[1]),settingsUrlProps.url.indexOf("esigndocuments-documentId")>-1||-1!==settingsUrlProps.url.indexOf("hrfile")?moduleType="1":settingsUrlProps.url.indexOf("-formId:")>-1||void 0!=ZP5Form.getCurrFormsOperation()||void 0!=ZP5Form.getFormClassObj()?(moduleType="2",agrId=agreementId,recId=$(thisObj).closest("tr").attr("recordId"),void 0===(formId=settingsUrlProps.urlParams.formId)&&void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId&&(recId=ZP5Form.getFormClassObj().getParams().recordId,formId=ZP5Form.getFormClassObj().getParams().formId),void 0===formId&&void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&(formId=ZP5Form.getCurrFormsOperation().formId)):(moduleType="2",void 0!=agreementId&&(agrId=agreementId),recId=thisObj,formId=settingsUrlProps.urlParams.formId),(-1!==settingsUrlProps.url.indexOf("hrfile")||settingsUrlProps.url.indexOf("esigndocuments-documentId")>-1||"selffiles"==mode)&&void 0!=agreementId&&(recId=agrId=agreementId,moduleType="1"),Adobesign.recordId=recId;var paramObj={action:"getAgreementStatus",conreqcsr:csrfToken,agreementId:agrId,moduleType:moduleType,formId:formId};Zsign.isfromFormReport||(paramObj.recordId=recId),ZPeople.Request.send("/adobesign/getAgreementStatus",paramObj,Zsign.constructDocumentInfo,agrId,Adobesign.failedCallBack)},setAgreementsDtlsValue:function(agreementId){var pageId=Layout.Page.container,currRow=$("tr[agreementId='"+agreementId+"']");$.each(pageId.find("div#agrmnt_dtlsview").find("div[name='formGrp']"),function(index,obj){var insertValueObj=$(obj).find("span"),key_name=insertValueObj.attr("id");insertValueObj.text(currRow.data(key_name))})},downloadAttachement:function(obj,viewfileId,mode,fileName,filePath){var fileExtn,recordId;Layout.Page.container;fileName=decodeURIComponent(fileName),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId?recordId=ZP5Form.getFormClassObj().getParams().recordId:(void 0==(recordId=$("div#viewDocumentModal").attr("recordId"))&&(recordId=$("div#viewEnvelopeModal").attr("recordId")),void 0==recordId&&(recordId=$("div#viewAgreementModal").attr("recordId")));var fileEObj="";fileEObj=""!=filePath?filePath:fileName,ZPSetupCommon.isEmpty(fileEObj)||(fileExtn=fileEObj.substr(fileEObj.lastIndexOf(".")+1,fileEObj.length));var isPolicy="5"==obj;void 0!=fileEObj&&"-1"==fileEObj.lastIndexOf(".")&&isPolicy&&(fileExtn="docx");var viewParams={};if("download"===mode||"xls"!==fileExtn&&"xlsx"!==fileExtn&&"doc"!==fileExtn&&"docx"!==fileExtn&&"rtf"!==fileExtn&&"ppt"!==fileExtn&&"pptx"!==fileExtn){var url="";if(url="download"===mode||"pdf"!==fileExtn&&"PDF"!==fileExtn?"viewFile?&mode=agreement":"pdfViewer.zp?mode=agreement",ZPSetupCommon.isEmpty(viewfileId)||(url+="&fileId="+viewfileId,viewParams.fileId=viewfileId),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId||Layout.Page.hash.indexOf("-formId:")>-1){url+="&recordId="+recordId,viewParams.recordId=recordId;var formId=Layout.Page.urlparam.formId;void 0===formId&&(formId=ZP5Form.getFormClassObj().getParams().formId),url+="&formId="+formId,viewParams.formId=formId}if("download"===mode)return url+="&action=download",void window.open(url);if("jpg"===fileExtn||"jpeg"===fileExtn||"gif"===fileExtn||"png"===fileExtn||"gif"===fileExtn){var iframe=$("#imageviewFrame"),viewAgrDiv=$("#viewPreviewFileDiv");$(window.document).find("#viewPreviewFileDiv").height($(window).height()+"px"),$(window).on("resize",function(){if(iframe.height(" "),viewAgrDiv.height(" "),$(window.document).find("#viewPreviewFileDiv").height($(window).height()+"px"),0!=$(window.document).find("#imageviewFrame").length){var contentpv=$(window.document).find("#imageviewFrame").parent();contentpv.css("max-height",$("#viewPreviewFileDiv").height()-43+"px"),contentpv.css("max-width",$("#viewPreviewFileDiv").width()-300+"px")}}),iframe.html(""),iframe.attr("src",""),iframe.attr("src",decodeURIComponent(url)),$("#imageviewFrame").off("load"),$("#imageviewFrame").on("load",function(){Files.esignimgOrgHeight=$("#imageviewFrame").height()})}else{iframe=$("#viewFileFrame"),viewAgrDiv=$("#viewPreviewFileDiv");$(window.document).find("#viewPreviewFileDiv").height($(window).height()+"px"),$(window).on("resize",function(){iframe.height(" "),viewAgrDiv.height(" "),$(window.document).find("#viewPreviewFileDiv").height($(window).height()+"px"),esignviewFrame=$(window.document).find("#viewFileFrame"),esignviewFrame.height($("#viewPreviewFileDiv").height()-43+"px")}),iframe.html(""),iframe.attr("src",""),iframe.attr("src",decodeURIComponent(url)),esignviewFrame=$(window.document).find("#viewFileFrame"),esignviewFrame.height($("#viewPreviewFileDiv").height()-43+"px")}}else FilesUtil.Preview.isViewZBasedFile(filePath,fileExtn)?ZPeople.Request.send("/adobesign/viewFiles",{action:"viewFiles",conreqcsr:csrfToken,fileId:viewfileId,recordId:recordId,formId:Layout.Page.urlparam.formId,isPolicy:isPolicy},Adobesign.viewAttachmentFile,fileName,Adobesign.failedCallBack):FilesUtil.Preview.isFilesPreviewEnabled(filePath)&&("docx"!=fileExtn&&"doc"!=fileExtn&&"rtf"!==fileExtn&&"pptx"!=fileExtn&&"ppt"!=fileExtn||(viewParams.mode="agreement",viewParams.fileId=viewfileId,viewParams.recordId=recordId,viewParams.formId=Layout.Page.urlparam.formId,viewParams.isPolicy=isPolicy),url=Zsign.Esign.constructPreviewUrl("agreement",viewParams,fileExtn),Files.setUrlIframeToViewFile(url,mode))},viewAttachmentFile:function(data,paramsObj,fileNm){var url,pageId=settingsPage.container;if(data=data[0],pageId.find("#zp_page_loading").remove(),"writer"===data.fileforformat)url=(url=data.url.replace("<script language='javascript'>window.location.href='","")).replace("';<\/script>","");else{data.url.indexOf("https"),data.url.indexOf("false");url=data.url}paramsObj.url=url},reasonToCancelAgrPopUp:function(thisObj){var pageId=Layout.Page.container;pageId.find("div#agr_reason_popup").modal(),pageId.find("span#errormsg").remove(),pageId.find("input#cancel_reason").val(""),pageId.find("a#cancel_confirmBtn").removeClass("disabled")},cancelAgreement:function(thisObj){var pageId=settingsPage.container,reason=pageId.find("input#recallReason").val();if(pageId.find("span#errormsg").remove(),-1!=settingsUrlProps.url.indexOf("files/esigndocuments"))var agrmntID=Adobesign.documentId;else agrmntID=Adobesign.documentId;var moduleType,formId="";$(thisObj).addClass("disabled");var paramObj={action:"cancelAgreement",conreqcsr:csrfToken,agreementId:agrmntID,reason:reason};void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(formId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId?ZP5Form.getFormClassObj().getParams().formId:ZP5Form.getCurrFormsOperation().formId,moduleType="2",paramObj.formId=formId,paramObj.recordIdList=agrmntID,paramObj.recList=Adobesign.recordId):(moduleType="1",paramObj.fileId=Adobesign.companyFileId),paramObj.moduleType=moduleType,ZPeople.Request.send("/adobesign/cancelAgreement",paramObj,Adobesign.handleCancelAgreement,null,Adobesign.failedCallBack)},handleCancelAgreement:function(data,params){var pageId=settingsPage.container;if(pageId.find("a#cancel_confirmBtn").removeClass("disabled"),data.isCancelled){var row="";row=-1!=settingsUrlProps.url.indexOf("files/esigndocuments")?pageId.find("tr[documentId='"+params.agreementId+"'] td[name='env_status']"):pageId.find("tr[documentid='"+params.agreementId+"'] td[name='env_status']");var cancelstatus="<span class='red'>"+ZPI18N.getString("zp.cancelordeclined")+"</span>";$("#esign_detail_card").find("#signDocStatus").html(cancelstatus),pageId.find("div#agr_reason_popup").modal("hide"),row.html('<span class="red">'+ZPI18N.getString("zp.cancelordeclined")+"</span>"),$("div#sliHdrDiv").find("#signOptList").hide(),row.closest("tr").attr("isCancelled",!0),ZPeople.Message.success(ZPI18N.getString("zp.documentcancelled"))}else ZPeople.Message.failure(ZPI18N.getString("zp.docnotcancel"))},sendReminder:function(_thisObj){var params={action:"sendReminder",conreqcsr:csrfToken};if(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1){params.moduleType="2";var formId=ZP5Form.getCurrFormsOperation().formId;params.recList=Adobesign.recordId,params.formId=formId,params.recordId=Adobesign.recordId,params.agreementRecordid=Adobesign.documentId,params.recordIdList=Adobesign.documentId}else params.moduleType="1",params.fileId=Adobesign.companyFileId,params.recordId=Adobesign.documentId;ZPeople.Request.send("/adobesign/sendReminder",params,Adobesign.handleSendReminder,null,Adobesign.failedCallBack)},handleSendReminder:function(data){"success"===data.status?ZPeople.Message.success(ZPI18N.getString("zp.remindersent")):ZPeople.Message.failure(ZPI18N.getString("zp.remindernotsent"))},deleteAgreementRecord:function(thisObj,position){var recordIdArr="",moduleType="",formId="",recordId="";if("first"==position)for(var deleteArray=Layout.Page.container.find("#agreements_list").find('input[type="checkbox"]:checked'),deleteCount=deleteArray.length,i=0;i<deleteCount;i++)i>=1&&(recordIdArr+=","),recordIdArr+=Layout.Page.container.find(deleteArray[i]).parent().parent().parent().attr("agreementId");else(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId||Layout.Page.hash.indexOf("-formId:")>-1)&&(void 0===(formId=Layout.Page.urlparam.formId)&&(formId=ZP5Form.getFormClassObj().getParams().formId),formId=formId,recordId=ZP5Form.getFormClassObj().getParams().recordId),moduleType="2",recordIdArr=$(thisObj).closest("ul").attr("agreementId");ZPeople.Request.send("/adobesign/deleteAgreement",{action:"deleteAgreement",conreqcsr:csrfToken,recordIdList:recordIdArr,moduleType:moduleType,recordId:recordId,formId:formId},Adobesign.deleteCallBack,thisObj,Adobesign.failedCallBack)},deleteCallBack:function(data,params,thisObj){var pageId=Layout.Page.container;data.isDeleted?($(pageId.find("#agreements_list").find('input[type="checkbox"]:checked').length)[0]>0?($(pageId.find("#agreements_list").find('input[type="checkbox"]:checked')).closest("ul").remove(),Layout.Page.container.find("#doc_multiselDel").addClass("DNI"),Layout.Page.container.find("#doc_HeaderBar").show()):$(thisObj).closest("ul").remove(),0===pageId.find("#agreements_list").find("ul").length&&(Layout.Page.container.find("#agreement_norecords .ctable").remove(),Adobesign.newuinorecords(),pageId.find("#agreements_list").addClass("DN"),pageId.find("#agreements_listingpage").addClass("DN"),pageId.find("#agreements_listingpage").removeClass("expand")),ZPeople.Message.success(ZPI18N.getString("zp.zs.documentdeletedsuccessfully"))):ZPeople.Message.failure(ZPI18N.getString("zp.zs.documentnotdeleted"))},newuinorecords:function(){var pageId=Layout.Page.container;Layout.Page.container.find("#no_agree_rec").remove(),pageId.find("div#agreements_list").addClass("DN"),pageId.find("#agreements_listingpage").removeClass("expand"),pageId.find("#agreement_norecords").addClass("Scrcont"),pageId.find("div#agreements_listingpage").addClass("DN"),pageId.find("#agreement_norecords").removeClass("DN");pageId.find("#agreement_norecords")},failedCallBack:function(error){"500"==error.responseJSON[1].errorCode&&(ZPeople.Message.failure(error.statusText),(Layout.Page.hash.indexOf("files/fileView/agreementslistview")>-1||Layout.Page.hash.indexOf("files/adobesign/agreementslistview")>-1)&&Layout.Page.container.find("div#agmnt_footer").hide())},showReminder:function(thisObj){settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?pageId=$("#esignforms_card"):pageId=$("#esign_card"),"daily"==$(thisObj).find("input").attr("id")?(pageId.find("#weekly").removeAttr("Checked"),$(thisObj).find("input").attr("Checked","Checked")):"weekly"==$(thisObj).find("input").attr("id")&&(pageId.find("#daily").removeAttr("Checked"),$(thisObj).find("input").attr("Checked","Checked"))},executeAdobeSignActions:function(obj){if(0==obj.detail.itemData.id)Zsign.showPopup(obj,Adobesign.sendReminder,ZPI18N.getString("zp.confirmremind"),ZPI18N.getString("zp.confirmremind"),ZPI18N.getString("zp.confirm"),MP.Popup.Type.INFO);else if(1==obj.detail.itemData.id){Zsign.showPopup(obj,Adobesign.cancelAgreement,ZPI18N.getString("zp.esign.recalldoctitle"),ZPI18N.getString("zp.esign.recalldocdesc"),ZPI18N.getString("zp.confirm"),MP.Popup.Type.DELETE,'<div class="zpl_secn wd50_per"><div><input type="text" placeholder="type..." id="recallReason" class="ztextbox"></div></div>')}}};Adobesign.Forms={getAgreementsList:function(modeCnt,evnt,isAjax,e,sortDefined,sortOrderval,sortColumnval){Zsign.Forms.initZDFilterComp("AdobeSign"),void 0==isAnySignConfigured&&Zsign.getEsignConfigurations();var pageId=settingsPage.container;if("search"!=evnt&&"reset"!=evnt||Adobesign.hideAndShowFilterIC("close"),ZPSetupCommon.isEmpty(e)||!ZPSetupCommon.isEmpty(e)&&13===e.keyCode){Zsign.Forms.docStartindex=1,Zsign.Forms.documentFirescroll=!1,pageId.find("#documents_list").data({start:"1"}),Zsign.Forms.getFireScrollDocumentList(evnt,sortDefined,sortOrderval,sortColumnval,"2")}}};var SignUtil={setValuesForMailMergeDocument:function(isCacheModel){var option='<option value="select">'+ZPI18N.getString("zp.all")+"</option>";return $.each(MMtemplte.templateList.templateDetails,function(index,obj){option+='<option value="'+obj.tid+'">'+obj.fname+"</option>"}),labelTxt=ZPI18N.getString("zp.selecttemplate"),file_elm='<div class="col-sm-6" id="fileElm"> <div class=""> <select id="uploadfile" fieldtype="26" name="rid">'+option+"</select></div> </div>",{labelTxt:labelTxt,file_elm:file_elm}}};Docusign={add:{bodyFormCont:'<div class="zpl_crd"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.filedetails")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn" id="uploadSection"><div><h6 class="zpl_mtry">'+ZPI18N.getString("zp.esign.uploadfile")+'</h6></div><div><div class="zpl_upld"><div id="drop_area" ondrop="event.stopPropagation(); event.preventDefault(); Zsign.dropHandler(event)" ondragover="event.preventDefault();" class="zpl_fldrp"><h5><div class="zpl_flupld_img"></div><input id="uploadFile" type="file" data-text="Desktop" style="display: none" /><a id="localUpload" class="zpl_lnk"><i class="PI_case"></i>'+ZPI18N.getString("zp.files.desktop")+'</a>/<a class="zpl_lnk" onClick="CloudPicker.construct()"><i class="PI_cloud"></i>'+ZPI18N.getString("zp.files.cloud")+"</a></h5></div><p><span>"+ZPI18N.getString("zp.supportedfiles")+"</span><span>"+ZPI18N.getString("zp.impmaxsize")+': 5MB/span></p></div></div></div><div class="zpl_secn" id="attachments"></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select id="agrselect_Cat"></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+'</div></div></div></div></div></div><div class="zpl_crd" id="docDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div><input id="document_name" type="text" class="ztextbox"></div></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.subject")+'</label></div><div><input id="document_subject" type="text" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><textarea class="ztextbox" id="document_message" rows="3"></textarea></div></div></div></div><div class="zpl_crd"><div class="zpl_crdhdr" id="recpHeader"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div id="recp_rows"><div id="addbttnrow" style="margin-top: 15px;" class="zpl_idiv"><div class="w20"></div><a class="zpl_lnkbg" id="addRecpbtn" onclick=Zsign.addRecpRows("userbtnId")> '+ZPI18N.getString("zp.esign.addrecp")+"</a></div></div></div></div></div></div></div></div>",bodyCont:'<div class="zpl_crd"><div class="zpl_crdhdr" id="optionHeader"><div><h4>'+ZPI18N.getString("zp.esign.additionaloptions")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div class="zcheckbox"><input id="reminder_check" type="checkbox" name="reminder_check" value="" class="zcheckbox__helper"><label class="zcheckbox__label" onclick="Zsign.setDaysForReminder()">'+ZPI18N.getString("zp.reminder")+'</label></div><div class="zpl_tbox disabled" id="reminder_setting"><div class="zpl_idiv"><div>'+ZPI18N.getString("zp.sendreminderafter",new Array(""))+'</div><div><input id="reminder_dayscnt" type="text" placeholder="" class="ztextbox w60"></div><div>'+ZPI18N.getString("zp.wfdays")+'</div></div></div><div class="zpl_tbox disabled" id="reminder_freq"><div class="zpl_idiv"><div>'+ZPI18N.getString("zp.sendreminderonce",new Array(""))+'</div><div><input type="text" id="reminder_freqdayscnt" placeholder="" class="ztextbox w60"></div><div>'+ZPI18N.getString("zp.wfdays")+'</div></div></div></div><div class="zpl_secn"><div class="zcheckbox"><input type="checkbox" id="expire_check" name="expire_check" value="" class="zcheckbox__helper"><label class="zcheckbox__label" onclick=Zsign.setDaysForReminder("expire")>'+ZPI18N.getString("zp.expiry")+'</label></div><div class="zpl_tbox disabled" id="expire_setting"><div class="zpl_idiv"><div>'+ZPI18N.getString("zp.local.Expirydate")+'</div><div id="dlParent" style="position: relative;"><input id="deadline" data-format="date-short" data-calendar-icon="true" data-picker="true" data-clear-button="none" data-spin-buttons="none" data-width="258" style="display: none;"></div></div></div><div class="zpl_tbox disabled" id="warning"><div class="zpl_idiv"><div>'+ZPI18N.getString("zp.es.notifyrecipients")+'</div><div><input  id="freq_warn" type="text" placeholder="" class="ztextbox w60"></div><div>'+ZPI18N.getString("zp.daysbeforeexpiry")+'</div></div></div></div></div></div><div class="embed-iframe" id="embed_iframe" style="display:none; top: 70px;width: 100%;height: 100%;padding-bottom: 20px;padding-right: 20px;"><iframe src="" name="createDocumentResp" style=" width: 100%; height: 100%; border: 1px solid var(--brdr_gry); "></iframe></div>',bodyNewFormsSlider:'<div class="zpl_crd" id="basicDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.filedetails")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn" id="uploadSection"><div><h6 class="zpl_mtry">'+ZPI18N.getString("zp.esign.uploadfile")+'</h6></div><div><div class="zpl_upld"><div id="drop_area" ondrop="event.stopPropagation(); event.preventDefault(); ZP_Mailmerge.dropHandler(event)" ondragover="event.preventDefault();" class="zpl_fldrp"><h5><img src="../images/nodata/fileupload.png" alt=""><div name="fileRoleOptions" id="fileRoleOptions" onclick="ZPA_Esign.showfileuploadDropdown()" class="zselectbox select-js has-focus has-mfocus flslct wauto"><option>'+ZPI18N.getString("zp.esign.fileuploadfield")+'</option><i class="zselectbox__icon zselectbox__arrowicon"><svg class="zselectbox__arrow" focusable="false"><use xlink:href="#zc__svg--downarrow"></use></svg></i></div><div id="fileRoleOptionsList"></div><div id="tempRoleOptions" onclick=ZPA_Esign.showTemplateDropdown() class="zselectbox select-js has-focus has-mfocus flslct wauto"><option>'+ZPI18N.getString("zp.esign.mailmerge.small")+'</option><i class="zselectbox__icon zselectbox__arrowicon"><svg class="zselectbox__arrow" focusable="false"><use xlink:href="#zc__svg--downarrow"></use></svg></i></div><div id="TemplateOptionsList"></div></div><p><span>'+ZPI18N.getString("zp.supportedfiles")+"</span><span> "+ZPI18N.getString("zp.impmaxsize")+': 5MB</span></p></div></div><div class="zpl_secn DN" id="attachments"><div><h5>'+ZPI18N.getString("zp.attachmentfiles")+'</h5></div><div class="zpl_atchd"></div></div></div>   <div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select id="agrselect_Cat"></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+'</div></div></div></div></div></div></div><div class="zpl_crd" id="docDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div><input id="document_name" type="text" class="ztextbox"></div></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.subject")+'</label></div><div><input id="document_subject" type="text" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><textarea class="ztextbox" id="document_message" rows="3"></textarea></div></div></div></div><div class="zpl_crd"><div class="zpl_crdhdr" id="recpHeader"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div id="recp_rows"><div id="addbttnrow" style="margin-top: 15px;" class="zpl_idiv"><div class="w20"></div><a class="zpl_lnkbg" id="addRecpbtn" onclick=Zsign.addRecpRows("userbtnId")> '+ZPI18N.getString("zp.esign.addrecp")+"</a></div></div></div></div></div></div></div></div>",bodyNewFilesSlider:'<div class="zpl_crd" id="basicDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.esign.filedetails")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn" id="uploadSection"><div><h5>'+ZPI18N.getString("zp.files.operations.attachedfile")+'</h5></div></div><div class="zpl_secn" id="attachments"></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.folder")+'</label></div><div><select id="agrselect_Cat"></select></div><div class="zpl_idiv  zpl_erorbx DNI"><div><input id="agrselect_newCatName" placeholder="'+ZPI18N.getString("zp.enterCategory")+'" type="text" class="ztextbox w300"></div><div><div onclick="ZPA_Esign.cancelNewCat();" class="zlabel zlabel--red zlabel--outline zlabel--small">'+ZPI18N.getString("zp.cancel")+'</div></div></div></div></div></div></div><div class="zpl_crd" id="docDetails"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.files.operations.documentdtls")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.esign.docname")+'</label></div><div><input id="document_name" type="text" class="ztextbox"></div></div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.subject")+'</label></div><div><input id="document_subject" type="text" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.message")+'</label></div><div><textarea class="ztextbox" id="document_message" rows="3"></textarea></div></div></div></div><div class="zpl_crd"><div class="zpl_crdhdr" id="recpHeader"><div><h4>'+ZPI18N.getString("zp.reciepents")+'</h4></div></div><div class="zpl_crdcnt"><div class="zpl_secn"><div id="recp_rows"><div id="addbttnrow" style="margin-top: 15px;" class="zpl_idiv"><div class="w20"></div><a class="zpl_lnkbg" id="addRecpbtn" onclick=Zsign.addRecpRows("userbtnId")> '+ZPI18N.getString("zp.esign.addrecp")+"</a></div></div></div></div></div></div></div></div>",docuCompatibleExtns:["as","asl","asp","doc","docm","docx","dot","dotm","dotx","htm","html","pdf","pdx","rtf","txt","wpd","wps","wpt","dps","dpt","pot","potx","pps","ppt","pptm","pptx","csv","et","ett","xls","xlsm","xlsx","xlt","emz","svg","svgz","vdx","vss","vst","bmp","cdr","dcx","gif","ico","jpg","jpeg","pct","pic","png","rgb","sam","tga","tif","tiff","wpg"]},fileId:null,emailidfield:{},fileuploadfield:{},isFromFormView:!1,isCachedCatList:!1,isMMerge:!1,recordId:null,envelopeStartindex:0,envelopeFirescroll:!1,selectedRecpForm:null,recordId:null,documentId:null,openCreateEnvelopeModal:function(mode,thisObj){"hr"!==mode?Layout.Page.hash:Layout.Page.hash.indexOf("#files/hrfile")>-1?Layout.Page.hash:(Layout.Page.hash,$(thisObj).closest("tr").attr("fileID")),Zsign.Esign.getEnvelopeListpage("hr",thisObj)},constructFormFields:function(dataObj,htmlObj){if(!ZPSetupCommon.isEmpty(dataObj)){var option="";return Object.keys(dataObj).length>0&&$.each(dataObj,function(key,value){option+='<option value="'+key+'">'+value+"</option>"}),option}ZPA_Esign.openFilter(Zsign.folderList);var popUpDiv=pageId.find("#maxPopup"),toopTipDiv='<i data-content="<p>'+ZPI18N.getString("zp.maxfileuploadsize",[maxFileSize])+'</p>" data-popover="true" data-html="true" data-toggle="popover" data-placement="bottom" class="PI_info S18 gry form-icon popHover" title=""></i>';popUpDiv.append(toopTipDiv)},sendEnvelope:function(){var err=!1,innerForm=!1,fileID=(Zsign.fileUploadObj,null),formData=new FormData,isFromForm=!1;Docusign.isFromFormView=!1,void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(pageId=$("#esignforms_card"),sliderId=$("#esignforms"),isFromForm=!0,Docusign.isFromFormView=!0,void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId&&(innerForm=!0)):"0"==FilesUtil.Page.getTabGroup()?(pageId=$("#cardesignfiles"),fileID=Zsign.compfileId,formData.append("fileId",fileID)):pageId=$("#esign_card"),formData.append("innerForm",innerForm),formData.append("isNewUI",!0);var recpNameLen=$('[name^="recpFormValue"]').length,recipientDetails=[];if(!Docusign.validation(isFromForm)){if(recpNameLen>0)for(var ele=0;ele<recpNameLen;ele++){var recpOrder=ele,recpFormValue=ZPeopleComponents.select(pageId.find("#recpFormValue_"+ele)).getValue(),recpFieldValue=ZPeopleComponents.select("#recpFieldValue_"+ele).getValue(),errMsg="",recpType=$("#recpType_"+ele).val(),recipientDetailsObject={};if(recipientDetailsObject[Zsign.RECIPIENT_ORDER]=recpOrder,recipientDetailsObject[Zsign.RECIPIENT_FIELD_TYPE]=recpFormValue,1==recpFormValue&&(recipientDetailsObject[Zsign.EMAIL_FORM_FIELD_TYPE]=recpFieldValue),4==recpFormValue){if(null!=(recpFieldValue=pageId.find("#recpEmailValue_"+ele).val())&&""!=recpFieldValue){errMsg=ZPI18N.getString("zp.entervalidemailaddress");(err=Docusign.validateMailIds(recpFieldValue,$("#recpEmailValue_"+ele),ZPI18N.getString("zp.entervalidemailaddress")))&&pageId.find($("#recpEmailValue_"+ele)).addClass("ztextbox__error")}else Docusign.validateMailIds(recpFieldValue,$("#recpEmailValue_"+ele),ZPI18N.getString("zp.entervalidemailaddress")),pageId.find($("#recpEmailValue_"+ele)).addClass("ztextbox__error"),err=!0;recipientDetailsObject[Zsign.RECIPIENT_ID]=recpFieldValue}recipientDetailsObject[Zsign.RECIPIENT_TYPE]=recpType,recipientDetails.push(recipientDetailsObject),Docusign.isFromFormView&&(null!=recpFieldValue&&""!=recpFieldValue||("1"==recpFormValue&&(errMsg=ZPI18N.getString("zp.selectemailfield")),"4"!==recpFormValue&&ZPeopleComponents.select(pageId.find("#recpFieldValue_"+ele)).getElement().addClass("ztextbox__error"),pageId.find("#recpFieldValue_"+ele).parent().parent().addClass("zpl_erorbx"),pageId.find("#recpFieldValue_"+ele).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),err=!0))}if(ZPSetupCommon.isEmpty(recipientDetails)?(errMsg=ZPI18N.getString("zp.selectemailidfield"),pageId.find("#recp_rows").before('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>"),err=!0):formData.append("recipientDetails",JSON.stringify(recipientDetails)),!err){var envelopeName=pageId.find("#document_name").val(),envelopeSubject=$("#document_subject").val(),envelopeMessage=pageId.find("#document_message").val();pageId.find("#dateFieldOpt").val();if(formData.append("conreqcsr",csrfToken),formData.append("envelope_subject",envelopeSubject),formData.append("envelope_message",envelopeMessage),formData.append("reminder",$("input#reminder_check").is(":checked")),$("input#reminder_check").is(":checked")){var firstReminder=$("div#reminder_dayscnt input").val();firstReminder=ZPSetupCommon.isEmpty(firstReminder)?"0":firstReminder,formData.append("first_reminder",firstReminder);var freqReminder=$("#reminder_freqdayscnt").val();freqReminder=ZPSetupCommon.isEmpty(freqReminder)?"0":freqReminder,formData.append("reminder_freqdays",freqReminder)}if(formData.append("expire_check",$("input#expire_check").is(":checked")),$("input#expire_check").is(":checked")){var expirationDays=ZPeopleComponents.datefield(document.getElementById("deadline")).getValue().dateString,freqWarnDays=$("#freq_warn").val();freqWarnDays=ZPSetupCommon.isEmpty(freqWarnDays)?"0":freqWarnDays,formData.append("freq_warn",freqWarnDays),void 0!=expirationDays&&formData.append("deadline",expirationDays)}if(isFromForm||"0"==FilesUtil.Page.getTabGroup()||(doc=Zsign.fileUploadObj,!0&&void 0!=doc&&formData.append("envelope",doc)),ZPSetupCommon.isEmpty(ZPA_Esign.uploadMode)||formData.append("uploadMode",ZPA_Esign.uploadMode),!ZPSetupCommon.isEmpty(CloudPicker.fileObj)&&void 0!=CloudPicker.fileObj.length&&Layout.Page.hash.indexOf("#operations/files/esigndocuments")>-1&&formData.append("cloudUploadDoc",CloudPicker.fileObj),pageId.find("#agrselect_newCatName").is(":visible")){var newCatName=pageId.find("#agrselect_newCatName").val().trim();formData.append("newCatName",newCatName)}else{var catId=ZPeopleComponents.select(pageId.find("#agrselect_Cat")).getValue();formData.append("catId",catId)}if(ZPSetupCommon.isEmpty(envelopeName)||formData.append("envelopeName",envelopeName),isFromForm){Layout.Page.hash.indexOf("view-recordId:")>0?(innerForm=!0,formData.append("action","sendEnvelope"),reqUrl="/docusign/sendEnvelope"):(isFromForm||-1==Layout.Page.hash.indexOf("selfservice/user"))&&(formData.append("action","scheduleSendEnvelopes"),reqUrl="/docusign/scheduleSendEnvelopes");var noOfAtth=$("#attachments .zpl_atchd").find("[name=fileOutDiv]").length;if(0==noOfAtth)return void pageId.find("#attachments").append('<div class="ztextbox--error__label ML15 MT2" id="errormsg">'+ZPI18N.getString("zp.esign.uploadonedoc")+"</div>");for(var itr=0;itr<noOfAtth;itr++){var selId=$($("#attachments .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("selId"),source=$($("#attachments .zpl_atchd").find("[name=fileOutDiv]")[itr]).find(".zpl_atchdtl h4").attr("source"),templateFieldsval={},fileFieldsval={},templateFields=[],templateoriginalFields=[],fileuploadFields=[],fileuploadFieldsoriginal=[];"fileupload"==source?(fileFieldsval.order=itr,fileFieldsval.filepathval=selId,fileuploadFields.push(fileFieldsval),fileuploadFieldsoriginal.push(selId)):"templates"==source&&(templateFieldsval.order=itr,templateFieldsval.templateIdval=selId,templateFields.push(templateFieldsval),templateoriginalFields.push(selId))}fileuploadFields.length>0?formData.append("fileList",fileuploadFieldsoriginal):templateFields.length>0&&formData.append("templateId",templateoriginalFields),isFromForm&&(formData.append("relatedModule","4"),void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId?(formData.append("recordId",ZP5Form.getFormClassObj().getParams().recordId),formData.append("recList",ZP5Form.getFormClassObj().getParams().recordId),formData.append("formId",ZP5Form.getFormClassObj().getParams().formId)):(formData.append("recList",Zsign.ESIGN_FORMS_RECORD_IDS.toString()),formData.append("formId",ZP5Form.getCurrFormsOperation().formId)),formData.append("docType","pdf"),innerForm&&($("#esignforms #sliFootDiv #sliderCancel").hide(),$("#esignforms #sliFootDiv #sliderSbt").hide(),$("#esignforms_card").hide()))}else"0"==FilesUtil.Page.getTabGroup()?($("#esignorg #sliFootDiv #sliderCancel").hide(),$("#esignorg #sliFootDiv #slidernxt").hide(),$("#esignorg_card").hide(),pageId.find(".zpl_crd").hide(),formData.append("action","sendEnvelope"),reqUrl="/docusign/sendEnvelope"):($("#esign #sliFootDiv #sliderCancel").hide(),$("#esign #sliFootDiv #sliderSbt").hide(),$("#esign_card").hide(),formData.append("action","sendEnvelope"),reqUrl="/docusign/sendEnvelope");0==pageId.parent().find("#zp_page_loading").length&&pageId.after(ZPeople.LOADING_HTML),err||$.ajax({url:reqUrl,type:"POST",data:formData,contentType:!1,processData:!1,success:function(data){if(Docusign.selectedRecpForm=null,ZPA_Esign.resetuploadValues(),isFromForm&&!innerForm){ZPeople.Message.success(ZPI18N.getString("zp.documentscheduled")),pageId.find("#zp_views_formrecactions").attr("style","display:block");var formRowsObj=pageId.find("table#zp_views_records_table tbody");return formRowsObj.find("input#zp_view_sel_record").prop("checked",!1),$.each(void 0,function(index,recId){formRowsObj.find("tr[recordid="+recId+"]").attr("isAgreementSent","true"),formRowsObj.find("tr[recordid="+recId+"]").attr("module",data[1].MODULE),formRowsObj.find("tr[recordid="+recId+"]").attr("agreeid",data[1].recordId)}),Layout.Page.container.find("div#zp_view_record_delete").hide(),Zsign.closePopup("esignforms"),Zsign.removeElementsfn(),void $("#recordActionsContainer #recordActionClose").trigger("click")}if(Zsign.newRecordDetails.agreeid=data[1].recordId,Zsign.newRecordDetails.module=data[1].MODULE,$("iframe[name='createDocumentResp']").attr("src",data[1].uri).show(),isFromForm?($("#esignforms").addClass("zpl_mfull"),$("#esignforms #sliFootDiv").hide(),$("#esignforms_card").show(),$("#esignforms").find(".zpl_crd").hide()):"0"==FilesUtil.Page.getTabGroup()?($("#tabesignfiles").addClass("zpl_mfull"),$("#tabesignfiles #sliFootDiv").hide()):($("#esign").addClass("zpl_mfull"),$("#esign #sliFootDiv").hide()),$("div#zp_page_loading").remove(),$("div#embed_iframe").show(),$("#esign_card").show(),$("#esign_card").find(".zpl_crd").hide(),$("#optionHeader").hide(),$("#recpHeader").hide(),Zsign.loadIframe(data[1]),pageId.find("div#ca_footer").hide(),pageId.find("div#zp_modal_body").addClass("NomdlFoot"),pageId.find("button#footer_submit").hide(),null!=fileID){pageId.find("ul[fileid="+fileID+"]").find("i#send_envelope").addClass("grn"),pageId.find("ul[fileid="+fileID+"]").find("i#send_envelope").parent().attr("onclick","Envelope.getEnvelopePreview('"+data[1].recordId+"','','selffiles')"),pageId.find("ul[fileid="+fileID+"]").find("i#send_envelope").removeClass(),pageId.find("ul[fileid="+fileID+"]").find("i#send_envelope").addClass("IC-send-file S14 grn FR MR15"),pageId.find("ul[fileid="+fileID+"]").find("i#send_envelope").attr("title",ZPI18N.getString("zp.files.operations.documentdtls"));var ele=pageId.find("ul[fileid="+fileID+"]").find("i#send_envelope");pageId.find("ul[fileid="+fileID+"]").find("i#send_envelope").parent().text(ZPI18N.getString("zp.files.operations.documentdtls")),pageId.find("ul[fileid="+fileID+"]").find(".PR5").append(ele)}if(-1===Layout.Page.hash.indexOf("-formId")&&-1===Layout.Page.hash.indexOf("files/hrfile")&&-1===Layout.Page.hash.indexOf("operations/files/esigndocuments")){var viewObj=Layout.Page.container.find("#documents_list_form"),relobj=Layout.Page.container.find("#anchor_single_doc_list");viewObj.is(":visible")&&(relobj.hasClass("collapsed")||relobj.addClass("collapsed"),viewObj.slideUp())}},error:function(req){if(pageId.parent().find("div#zp_page_loading").remove(),pageId.find("form#createDocumentResp,div#ca_footer").show(),innerForm&&($("#esignforms #sliFootDiv #sliderCancel").show(),$("#esignforms #sliFootDiv #sliderSbt").show(),$("#esignforms_card").show()),400!==req.status){var errResponse=req.responseJSON[1];if(6013!=errResponse.errorCode)if(6014!=errResponse.errorCode){if(-1!=req.responseText.search("mailmerge")){var errorMsg;return errorMsg=JSON.parse(JSON.parse(req.responseText)[1].msg).error.message,void ZPeople.Message.failure(errorMsg)}if("string"==typeof errResponse.msg)ZPeople.Message.failure(errResponse.msg),Layout.Page.container.find("div#zp_page_loading").remove();else{var dispMsg,validationMsg=errResponse.msg;if(validationMsg.hasOwnProperty("ef")){var dispName="<p>";$.each(validationMsg.ef,function(mailId,errorCompList){$.each(errorCompList,function(index,errId){var optElm=$("#viewsContainer").find("th[id="+errId+"]");-1===dispName.indexOf(optElm.text())&&(index>0&&(dispName+=","),dispName+=optElm.text())})}),dispMsg=dispName+=" is not available for this/these record(s) </p>"}else validationMsg.hasOwnProperty("extnerr")?dispMsg=ZPI18N.getString("zp.fileformaterr"):validationMsg.hasOwnProperty("disbaled")?dispMsg=validationMsg.disbaled:validationMsg.hasOwnProperty("limitEx")?dispMsg=validationMsg.limitEx:ZPeople.Message.failure(req.statusText);void 0!=dispMsg&&ZPeople.Message.failure(dispMsg)}}else ZPeople.Message.failure(ZPI18N.getString("zp.mmmailfailureerrormessadmin"));else ZPeople.Message.failure(ZPI18N.getString("zp.mmmailfailuresubject"))}else ZPeople.Message.failure(req.responseJSON.error)}})}}},getEnvelopeList:function(e,modeType,event,sortDefined,sortOrderval,sortColumnval){$("#exportList").removeClass("DN");Zsign.initZDFilterComp("DocuSign"),settingsPage.container.find("#doc_multiselDel").addClass("DNI"),settingsPage.container.find("#documents_checkallbox").prop("checked",!1),void 0==isAnySignConfigured&&Zsign.getEsignConfigurations();var pageId=settingsPage.container;if("search"!=event&&"reset"!=event||Adobesign.hideAndShowFilterIC("close"),void 0!=e&&13===e.keyCode||ZPSetupCommon.isEmpty(e)){Zsign.docStartindex=1,Zsign.documentFirescroll=!1,pageId.find("#documents_list").data({start:"1"}),Zsign.documentFirescroll=!1,Zsign.getFireScrollDocumentList(event,sortDefined,sortOrderval,sortColumnval,"4")}},newuinorecords:function(){var pageId=Layout.Page.container;pageId.find("div#envelopes_list").addClass("DN"),pageId.find("div#envelopes_listingpage").addClass("DN"),pageId.find("#envelopes_listingpage").removeClass("expand"),pageId.find("#envelope_norecords").addClass("Scrcont"),pageId.find("#envelope_norecords").removeClass("DN");pageId.find("#envelope_norecords")},resetFilter:function(){var pageId=Layout.Page.container;pageId.find("#filter_params_envFiles").find("span").remove(),Zsign.breadcrumb_remove();var filterOptions=pageId.find("#search_cat,#search_status");filterOptions.select2("val","select"),filterOptions.trigger("change"),pageId.find("#search_envelopename").val(""),pageId.find("#env_sentto").val(""),pageId.find("#env_sentfrom").val(""),Envelope.getEnvelopeList("","","reset")},searchAgreementsRecord:function(){Layout.Page.container.find("button#reset_envBtn").removeClass("DN")},getEnvelopeViewPage:function(thisObj,recId){var envId;Envelope.recordId="",envId=ZPSetupCommon.isEmpty(thisObj)?recId:$(thisObj).closest("ul").attr("envelopeId"),window.location.href=Layout.Page.hash+"-envelopeId:"+envId},getEnvelopePreview:function(agreementId,thisObj,mode){var agrId,moduleType,formId,recId;agrId=agreementId,-1===Layout.Page.hash.indexOf("-formId:")&&(agrId=settingsUrlProps.url.split("documentId:")[1]),(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1)&&(formId=ZP5Form.getCurrFormsOperation().formId),void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams()&&void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId&&(recId=ZP5Form.getFormClassObj().getParams().recordId),settingsUrlProps.url.indexOf("esigndocuments-documentId")>-1||-1!==settingsUrlProps.url.indexOf("hrfile")?moduleType="1":(settingsUrlProps.url.indexOf("-formId:")>-1||void 0!=ZP5Form.getCurrFormsOperation()||void 0!=ZP5Form.getFormClassObj())&&(moduleType="2",formId=settingsUrlProps.urlParams.formId,agrId=agreementId,recId=$(thisObj).closest("tr").attr("recordId"),void 0===formId&&void 0!=ZP5Form.getFormClassObj()&&null!=ZP5Form.getFormClassObj().getParams()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId&&(recId=ZP5Form.getFormClassObj().getParams().recordId,formId=ZP5Form.getFormClassObj().getParams().formId),void 0===formId&&void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&(formId=ZP5Form.getCurrFormsOperation().formId),void 0==recId&&(recId=thisObj)),-1===settingsUrlProps.url.indexOf("hrfile")&&"selffiles"!=mode||void 0!=agreementId&&(recId=agrId=agreementId,moduleType="1"),Docusign.recordId=recId;var paramObj={action:"getEnvelopeStatus",conreqcsr:csrfToken,envelopeId:agrId,moduleType:moduleType,formId:formId};Zsign.isfromFormReport||(paramObj.recordId=recId),ZPeople.Request.send("/docusign/getEnvelopeStatus",paramObj,Zsign.constructDocumentInfo,{envId:agrId,recordId:recId})},deleteAgreementRecord:function(thisObj,position){var recordIdArr="",moduleType="",formId="",recordId="";if("first"==position)for(var deleteArray=Layout.Page.container.find("#envelopes_list").find('input[type="checkbox"]:checked'),deleteCount=deleteArray.length,i=0;i<deleteCount;i++)i>=1&&(recordIdArr+=","),recordIdArr+=Layout.Page.container.find(deleteArray[i]).parent().parent().parent().attr("envelopeId");else(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().recordId||Layout.Page.hash.indexOf("-formId:")>-1)&&(void 0===(formId=Layout.Page.urlparam.formId)&&(formId=ZP5Form.getFormClassObj().getParams().formId),formId=formId,recordId=ZP5Form.getFormClassObj().getParams().recordId),moduleType="2",recordIdArr=$(thisObj).closest("ul").attr("envelopeId");ZPeople.Request.send("/docusign/deleteEnvelope",{action:"deleteEnvelope",conreqcsr:csrfToken,recordIdList:recordIdArr,recordId:recordId,moduleType:moduleType,formId:formId},Envelope.deleteCallBack,thisObj)},deleteCallBack:function(data,params,thisObj){var pageId=Layout.Page.container;data[1].isDeleted?($(pageId.find("#envelopes_list").find('input[type="checkbox"]:checked').length)[0]>0?($(pageId.find("#envelopes_list").find('input[type="checkbox"]:checked')).closest("ul").remove(),Layout.Page.container.find("#doc_multiselDel").addClass("DNI"),Layout.Page.container.find("#doc_HeaderBar").show()):$(thisObj).closest("ul").remove(),0===pageId.find("#envelopes_list").find("ul").length&&(Layout.Page.container.find("#envelope_norecords .ctable").remove(),Envelope.newuinorecords(),pageId.find("#envelopes_list").addClass("DN"),pageId.find("#envelopes_listingpage").addClass("DN"),pageId.find("#docenvelopes_listingpageuments_listingpage").removeClass("expand")),ZPeople.Message.success(ZPI18N.getString("zp.zs.documentdeletedsuccessfully"))):ZPeople.Message.failure(ZPI18N.getString("zp.zs.documentnotdeleted"))},validation:function(isFromForm){ZPA_Esign.resetAllErrorborder();Layout.Page.container;var createAgr=$("#esign_card");isFromForm?createAgr=$("#esignforms_card"):"0"==FilesUtil.Page.getTabGroup()&&(createAgr=$("#cardesignfiles"));var agmntFile=Zsign.fileUploadObj,envelope_name_elm=(createAgr.find("*[id=recpList]"),createAgr.find("#document_name").val()),envelopeSubject=(createAgr.find("input[name='deadline']").val(),createAgr.find("input#document_subject").val()),envelopeMessage=createAgr.find("textarea#document_message").val();$(".ztextbox--error__label").remove();var err=!1;if(!Docusign.isFromForm&&-1!==settingsUrlProps.url.indexOf("operations/files/esigndocuments"))if(void 0!=agmntFile.name||"cloudUpload"===ZPA_Esign.uploadMode){if(agmntFile&&(agmntFile.size>5e6?(err=!0,createAgr.find("#uploadFile").closest("div#err_div").after('<span class="ztextbox--error__label" id="errormsg">'+ZPI18N.getString("zp.agreementfilesizelimit")+"</span>")):createAgr.find("#uploadFile").closest("div#err_div").next("span#errormsg").remove()),!err){var fileExtn=createAgr.find("div#attachments").find("h4").text();fileExtn=fileExtn.substr(fileExtn.lastIndexOf(".")+1,fileExtn.length),-1===Envelope.add.docuCompatibleExtns.indexOf(fileExtn.toLowerCase())?(err=!0,createAgr.find("#uploadFile").closest("div#err_div").after('<span class="ztextbox--error__label" id="errormsg">'+ZPI18N.getString("zp.choosepdffile")+"</span>")):createAgr.find("#uploadFile").closest("div#err_div").next("span#errormsg").remove()}}else err=!0,createAgr.find("#uploadSection").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.choosedoc")+"</span>");if(ZPSetupCommon.isEmpty(envelope_name_elm)){err=!0;var errMsg=ZPI18N.getString("zp.zs.envelopenameempty");createAgr.find("#document_name").after('<span class="ztextbox--error__label" id="errormsg">'+errMsg+"</span>")}envelope_name_elm.length>100&&(createAgr.find("#document_name").after('<span  errmsg="mailids" id="errormsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.lengthvalidation",new Array(ZPI18N.getString("zp.name"),100))+"</strong></span>"),err=!0),!ZPSetupCommon.isEmpty(envelopeSubject)&&envelopeSubject.length>100&&(createAgr.find("#document_subject").after('<span  errmsg="mailids" id="errormsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.lengthvalidation",new Array(ZPI18N.getString("zp.subject"),100))+"</strong></span>"),err=!0),-1==envelope_name_elm.indexOf("<")&&-1==envelope_name_elm.indexOf(">")||(ZPeople.Message.failure(ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.name"))," > < ")),err=!0),envelopeMessage.length>1e3&&(createAgr.find("#document_message").after('<span  errmsg="mailids" id="errormsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.lengthvalidation",new Array(ZPI18N.getString("zp.message"),1e3))+"</strong></span>"),err=!0);var noOfAtth=0;if(Docusign.isFromFormView&&($("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length>0?(noOfAtth=$("#zsignTempAttach .zpl_atchd").find("[name=fileOutDiv]").length,!0):noOfAtth=$("#attachments .zpl_atchd").find("[name=fileOutDiv]").length,0==noOfAtth?(createAgr.find("#uploadSection").append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.esign.uploadonedoc")+"</span>"),err=!0):noOfAtth>5&&(ZPeople.Message.failure(ZPI18N.getString("zp.zs.maxdocuploads")),err=!0)),(recipientsMailIds=createAgr.find('[name^="recpFormValue_"]').length)>0)for(var ele=0;ele<recipientsMailIds;ele++){var recipientsMailIds=ZPeopleComponents.select(createAgr.find("#recpFormValue_"+ele)).getValue();if(ZPSetupCommon.isEmpty(recipientsMailIds)||"-1"===recipientsMailIds){err=!0;errMsg=ZPI18N.getString("zp.entervalidemailaddress");createAgr.find("#recpEmailValue_"+ele).parent().parent().addClass("zpl_erorbx"),createAgr.find("#recpEmailValue_"+ele).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>")}else if(Docusign.validateMailIds(recipientsMailIds,createAgr.find("#recpEmailValue_"+ele),ZPI18N.getString("zp.entervalidemailaddress"))){err=!0;errMsg=ZPI18N.getString("zp.entervalidemailaddress");createAgr.find("#recpEmailValue_"+ele).parent().parent().addClass("zpl_erorbx"),createAgr.find("#recpEmailValue_"+ele).parent().append('<span class="ztextbox--error__label" id="errorMsg">'+errMsg+"</span>")}}if(createAgr.find("#agrselect_newCatName").is(":visible")){var newCatName=createAgr.find("#agrselect_newCatName").val().trim();""==newCatName?(createAgr.find("#agrselect_newCatName").addClass("ztextbox__error"),createAgr.find("#agrselect_newCatName").parent().append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.enterCategory")+"</span>"),err=!0):-1!=newCatName.indexOf("<")||-1!=newCatName.indexOf(">")||-1!=newCatName.indexOf("&lt;")||-1!=newCatName.indexOf("&gt;")?(ZPeople.Message.failure(ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.lms.base.foldername"))," > < ")),err=!0):null!=newCatName&&void 0!=newCatName&&"/"===newCatName&&(ZPeople.Message.failure(ZPI18N.getString("zp.files.operations.avoidchar",new Array(ZPI18N.getString("zp.lms.base.foldername"))," / ")),err=!0)}else{var catId=ZPeopleComponents.select(createAgr.find("#agrselect_Cat")).getValue();""!=catId&&"-1"!=catId||(ZPeopleComponents.select(createAgr.find("#agrselect_Cat")).getElement().addClass("ztextbox__error"),createAgr.find("#agrselect_Cat").parent().append('<span class="ztextbox--error__label">'+ZPI18N.getString("zp.foldernameempty")+"</span>"),err=!0)}var smc=createAgr.find("#copyList").val();ZPSetupCommon.isEmpty(smc)||(smc.split(",").length>50?createAgr.find("#copyList").after('<span class="ztextbox--error__label" id="errormsg" errmsg="mailids">'+ZPI18N.getString("zp.maildidslengthunlimit")+"</span>"):(createAgr.find("#copyList").parent().find("span#errormsg").remove(),Envelope.validateMailIds(smc.split(","),createAgr.find("#copyList"),ZPI18N.getString("zp.entervalidemailaddress"))));var deadLine=createAgr.find("input[name='deadline']").val();if(!ZPSetupCommon.isEmpty(deadLine)){var lastDate=moment(deadLine,dateFmt.toUpperCase()).format("DD-MMM-YYYY").split("-"),month=Calendar.months.indexOf(lastDate[1])+1,lDate=lastDate[2]+"/"+month+"/"+lastDate[0];"NaN"===Date.parse(lDate).toString()||moment(lDate).diff(moment(),"days")<0?(err=!0,createAgr.find("input[name='deadline']").after('<span class="ztextbox--error__label" id="errormsg">'+ZPI18N.getString("zp.holiday.dateerror")+"</span>")):createAgr.find("input[name='deadline']").parent().find("span#errormsg").remove();var warnRecp=ZPSetupCommon.isEmpty(warnRecp)?"0":createAgr.find("input[name='freq_warn']").val()}return ZPSetupCommon.isEmpty(createAgr.find("input#document_subject").val())&&(err=!0,createAgr.find("#document_subject").after('<span class="ztextbox--error__label" id="errormsg">'+ZPI18N.getString("zp.entersubname")+"</span>"),createAgr.find("#document_subject").addClass("ztextbox__error")),ZPSetupCommon.isEmpty(createAgr.find("input#document_name").val())&&(err=!0,createAgr.find("#document_name").after('<span class="ztextbox--error__label" id="errormsg">'+ZPI18N.getString("zp.zs.documentnameempty")+"</span>"),createAgr.find("#document_name").addClass("ztextbox__error")),err},validateMailIds:function(mailIds,obj,msg){var err=!1;if(mailIds.length<=50){if(!ZPUtil.Validation.isEmail(mailIds))return err=!0,obj.parent().parent().addClass("zpl_erorbx"),obj.parent().append('<span class="ztextbox--error__label" id="errorMsg">'+msg+"</span>"),err}else err=!0,obj.parent().parent().addClass("zpl_erorbx"),obj.parent().append('<span class="ztextbox--error__label" id="errorMsg">'+ZPI18N.getString("zp.maildidslengthunlimit")+"</span>");return err},setDaysForReminder:function(mode){var pageId=Layout.Page.container;ZPSetupCommon.isEmpty(mode)?pageId.find("div#createEnvelopeModal").find("input#reminder_check").is(":checked")?pageId.find("div#createEnvelopeModal").find("div#reminder_setting,div#reminder_freq").show():pageId.find("div#createEnvelopeModal").find("div#reminder_setting,div#reminder_freq").hide():pageId.find("div#createEnvelopeModal").find("input#expire_check").is(":checked")?pageId.find("div#createEnvelopeModal").find("div#expire_setting,div#warning").show():pageId.find("div#createEnvelopeModal").find("div#expire_setting,div#warning").hide()},cancelEnvelope:function(thisbulk,isFromPA){var moduleType;$("#yesBtn").addClass("disabled"),ZPA_Esign.resetAllErrorborder();var recList,params={conreqcsr:csrfToken},formId="";void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1?(formId=void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId?ZP5Form.getFormClassObj().getParams().formId:ZP5Form.getCurrFormsOperation().formId,moduleType="2",recList=Docusign.recordId,params.recordIdList=Docusign.documentId):(moduleType="1",params.fileId=Docusign.companyFileId),ZPSetupCommon.isEmpty(formId)||(params.formId=formId),params.moduleType=moduleType,params.envelopeId=Docusign.documentId;var reason=$("textarea#recallReason").val();return ZPSetupCommon.isEmpty(reason)?($("textarea#recallReason").parent().append('<span id="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.enterreason")+"</span>"),$("textarea#recallReason").addClass("ztextbox__error"),void $("#yesBtn").removeClass("disabled")):reason.length>200?(ZPeople.Message.warning(ZPI18N.getString("zp.lengthwarning",[ZPI18N.getString("zp.reason"),200])),void $("#yesBtn").removeClass("disabled")):(params.recList=recList,params.reason=reason,void $.ajax({url:"/docusign/cancelEnvelope",type:"POST",data:params,success:function(data){Docusign.cancelCallback(data,Docusign.documentId,thisbulk)},failure:Docusign.failedCallBack}))},cancelCallback:function(data,recordId,thisbulk){if(data[1]){var row="";row=(-1!=Layout.Page.hash.indexOf("operations/organization/employee/listview")||-1!=Layout.Page.hash.indexOf("files/hrfile")||Layout.Page.hash.indexOf("selfservice/user/files"),$("tr[documentid='"+recordId+"'] td[name='env_status']")),$("div#esign_detail").find("#signDocStatus").html("<span class='red d-flexclmcap5 j-cnt-rgt'>Cancelled / Declined</span>"),row.html("<span class='red'>Cancelled / Declined</span>"),row.closest("tr").attr("isCancelled",!0),ZPeople.Message.success(ZPI18N.getString("zp.documentcancelled"))}else ZPeople.Message.failure(ZPI18N.getString("zp.docnotcancel"));$("#yesBtn").removeClass("disabled"),thisbulk.remove()},failedCallBack:function(error){var responseJson=error.responseJSON[1];"500"==responseJson.errorCode&&(void 0!=responseJson.msg?ZPeople.Message.failure(responseJson.msg):ZPeople.Message.failure(error.statusText),Layout.Page.hash.indexOf("files/fileView/documentlistview")>-1&&settingsPage.container.find("div#agmnt_footer").hide())},getTotalRecordCount:function(){var pageId=Layout.Page.container,params={conreqcsr:csrfToken,action:"getEnvelopeRecordCount"};params.envelopeName=pageId.find("input#search_envelopename").val(),"select"!==pageId.find("select#search_cat").val()&&(params.catId=pageId.find("select#search_cat").val()),"select"!==pageId.find("select#search_status").val()&&(params.status=pageId.find("select#search_status").val()),ZPeople.Request.send("/docuSignActions.zp",params,Envelope.showCount)},showCount:function(data){var pageId=Layout.Page.container;data?(pageId.find("span#envelope_totalcnt").text(data.count).removeClass("hide"),pageId.find("a#zp_views_recordcount").addClass("hide")):(pageId.find("span#envelope_totalcnt").addClass("hide"),pageId.find("a#zp_views_recordcount").removeClass("hide"))},setCatName:function(dataObj){var pageId=Layout.Page.container;$.each(dataObj,function(index,envelopeDtls){var catId=ZPSetupCommon.isEmpty(envelopeDtls.catId)?"0":envelopeDtls.catId,categoryName=pageId.find("select#search_cat").find("option[value='"+catId+"']").text();pageId.find("#envelopes_list").find("ul[envelopeId='"+envelopeDtls.ARID+"'] span#cat_nm").text(categoryName)})},executeDocusignActions:function(obj){0==obj.detail.itemData.id&&(obj.bulk=!1,Docusign.showRecalPop(obj))},recallModal:function(){var html='<div class="zpl_secn wd100_per">';return html+='<div><textarea class="ztextbox" id="recallReason" autocomplete="off" rows="3" placeholder="'+ZPI18N.getString("zp.enterthereason")+'"></textarea></div>',html+='<div class="zpl_secn d-flexC j-cnt-btwen"><div id="recallWithcheck" class="DNI"><div class="zcheckbox" id="recallWithcheckdiv"><input id="recallWithAdminTkn" type="checkbox" name="recallWithAdminTkn" class="zcheckbox__helper"><label for="recallWithAdminTkn" class="zcheckbox__label">Allow users to use Integration token for Admin Operations</label></div></div><div class="d-flexC"></div></div>',html+="</div>"},showRecalPop:function(bulk){var bulkTrigger=!(!bulk||1!=bulk);if(bulkTrigger)var obj={bulk:!0,isFromPA:!0};var cancelMethod=bulkTrigger?Docusign.cancelEnvelopeInBulk:Docusign.cancelEnvelope;Zsign.showPopup(obj,cancelMethod,ZPI18N.getString("zp.esign.recalldoctitle"),ZPI18N.getString("zp.esign.recalldocdesc"),ZPI18N.getString("zp.recall"),MP.Popup.Type.DELETE,Docusign.recallModal(),!1)},cancelEnvelopeInBulk:function(thisbulk,isFromPA){var moduleType;$("#yesBtn").addClass("disabled"),ZPA_Esign.resetAllErrorborder();var bulk=!1;thisbulk&&1==thisbulk?bulk=!0:void 0!=thisbulk.parameter&&void 0!=thisbulk.parameter.thisObj.bulk&&(bulk=thisbulk.parameter.thisObj.bulk,thisbulk.parameter.thisObj.isFromPA);var recList,params={conreqcsr:csrfToken,action:"cancelEnvelopeInBulk"},formId="",documentIdList="",reason=$("textarea#recallReason").val();if(ZPSetupCommon.isEmpty(reason))return $("textarea#recallReason").parent().append('<span id="errorMsg" class="ztextbox--error__label">'+ZPI18N.getString("zp.enterreason")+"</span>"),$("textarea#recallReason").addClass("ztextbox__error"),void $("#yesBtn").removeClass("disabled");if(reason.length>200)return ZPeople.Message.warning(ZPI18N.getString("zp.lengthwarning",[ZPI18N.getString("zp.reason"),200])),void $("#yesBtn").removeClass("disabled");if(void 0!=ZP5Form.getFormClassObj()&&void 0!=ZP5Form.getFormClassObj().getParams().formId||void 0!=ZP5Form.getCurrFormsOperation()&&void 0!=ZP5Form.getCurrFormsOperation().formId&&settingsUrlProps.niceUrl.lastIndexOf("/listview")>-1){formId=ZP5Form.getFormClassObj().getParams().formId;moduleType="2",recList=Docusign.documentId}else moduleType="1";var documentArray=settingsPage.container.find("#documents_list").find('input[type="checkbox"]:checked'),documentCount=documentArray.length;if(documentCount>100)return ZPeople.Message.warning(ZPI18N.getString("zp.cancelexceed",new Array("100"))),void $("#yesBtn").removeClass("disabled");for(var i=0;i<documentCount;i++)i>=1&&(documentIdList+=","),documentId=settingsPage.container.find(documentArray[i]).parent().parent().parent().attr("documentid"),documentIdList+=documentId;documentCount<=0&&(params.envelopeId=Docusign.documentId),params.moduleType=moduleType,ZPSetupCommon.isEmpty(formId)||(params.formId=formId),params.recList=recList,params.reason=reason,bulk?(params.documentIdList=documentIdList,params.bulk=!0):params.documentId=recordId,$.ajax({url:"/docusign/cancelEnvelopeInBulk",type:"POST",data:params,success:function(data){Docusign.cancelBkCallback(data,params,thisbulk)},failure:Docusign.failedCallBack})},cancelBkCallback:function(data,params,thisbulk){Layout.Page.container;var bulk=!1;thisbulk&&1==thisbulk?bulk=!0:void 0!=thisbulk&&void 0!=thisbulk.parameter&&void 0!=thisbulk.parameter.thisObj.bulk&&(bulk=thisbulk.parameter.thisObj.bulk),data[1]?bulk&&ZPeople.Message.success(ZPI18N.getString("zp.scheduledmsg")):ZPeople.Message.failure(ZPI18N.getString("zp.docnotcancel")),$("#yesBtn").removeClass("disabled"),thisbulk.remove()}},Docusign.Forms={getEnvelopeList:function(e,modeType,event,sortDefined,sortOrderval,sortColumnval){Zsign.Forms.initZDFilterComp("DocuSign"),void 0==isAnySignConfigured&&Zsign.getEsignConfigurations();var pageId=settingsPage.container;if("search"!=event&&"reset"!=event||Adobesign.hideAndShowFilterIC("close"),void 0!=e&&13===e.keyCode||ZPSetupCommon.isEmpty(e)){Zsign.Forms.docStartindex=1,Zsign.Forms.documentFirescroll=!1,pageId.find("#documents_list").data({start:"1"}),Zsign.Forms.documentFirescroll=!1,Zsign.Forms.getFireScrollDocumentList(event,sortDefined,sortOrderval,sortColumnval,"4")}}};