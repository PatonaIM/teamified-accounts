var ColorPicker;!function(Q,L){"object"==typeof module&&module.exports?module.exports=Q.document?L(Q):L:Q.Highcharts=L(Q)}("undefined"!=typeof window?window:this,function(Q){var a,G,E,H,v,k,q,L=(a=void 0===Q?window:Q,G=a.document,E=a.navigator&&a.navigator.userAgent||"",H=G&&G.createElementNS&&!!G.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,v=/(edge|msie|trident)/i.test(E)&&!a.opera,k=/Firefox/.test(E),q=k&&4>parseInt(E.split("Firefox/")[1],10),a.Highcharts?a.Highcharts.error(16,!0):{product:"Highstock",version:"6.0.4",deg2rad:2*Math.PI/360,doc:G,hasBidiBug:q,hasTouch:G&&void 0!==G.documentElement.ontouchstart,isMS:v,isWebKit:/AppleWebKit/.test(E),isFirefox:k,isTouchDevice:/(Mobile|Android|Windows Phone)/.test(E),SVG_NS:"http://www.w3.org/2000/svg",chartCount:0,seriesTypes:{},symbolSizes:{},svg:H,win:a,marginNames:["plotTop","marginRight","marginBottom","plotLeft"],noop:function(){},charts:[]});!function(a){a.timers=[];var G=a.charts,E=a.doc,H=a.win;a.error=function(v,k){if(v=a.isNumber(v)?"Highcharts error #"+v+": www.highcharts.com/errors/"+v:v,k)throw Error(v);H.console&&console.log(v)},a.Fx=function(a,k,q){this.options=k,this.elem=a,this.prop=q},a.Fx.prototype={dSetter:function(){var u,a=this.paths[0],k=this.paths[1],q=[],w=this.now,t=a.length;if(1===w)q=this.toD;else if(t===k.length&&1>w)for(;t--;)u=parseFloat(a[t]),q[t]=isNaN(u)?k[t]:w*parseFloat(k[t]-u)+u;else q=k;this.elem.attr("d",q,null,!0)},update:function(){var a=this.elem,k=this.prop,q=this.now,w=this.options.step;this[k+"Setter"]?this[k+"Setter"]():a.attr?a.element&&a.attr(k,q,null,!0):a.style[k]=q+this.unit,w&&w.call(a,q,this)},run:function(v,k,q){var w=this,t=w.options,u=function(a){return!u.stopped&&w.step(a)},z=H.requestAnimationFrame||function(a){setTimeout(a,13)},m=function(){for(var g=0;g<a.timers.length;g++)a.timers[g]()||a.timers.splice(g--,1);a.timers.length&&z(m)};v===k?(delete t.curAnim[this.prop],t.complete&&0===a.keys(t.curAnim).length&&t.complete.call(this.elem)):(this.startTime=+new Date,this.start=v,this.end=k,this.unit=q,this.now=this.start,this.pos=0,u.elem=this.elem,u.prop=this.prop,u()&&1===a.timers.push(u)&&z(m))},step:function(v){var q,k=+new Date,w=this.options,t=this.elem,u=w.complete,z=w.duration,m=w.curAnim;return t.attr&&!t.element?v=!1:v||k>=z+this.startTime?(this.now=this.end,this.pos=1,this.update(),q=m[this.prop]=!0,a.objectEach(m,function(a){!0!==a&&(q=!1)}),q&&u&&u.call(t),v=!1):(this.pos=w.easing((k-this.startTime)/z),this.now=this.start+(this.end-this.start)*this.pos,this.update(),v=!0),v},initPath:function(v,k,q){function w(a){var b,c;for(r=a.length;r--;)b="M"===a[r]||"L"===a[r],c=/[a-zA-Z]/.test(a[r+3]),b&&c&&a.splice(r+1,0,a[r+1],a[r+2],a[r+1],a[r+2])}function t(a,b){for(;a.length<c;){a[0]=b[c-a.length];var n=a.slice(0,e);[].splice.apply(a,[0,0].concat(n)),l&&(n=a.slice(a.length-e),[].splice.apply(a,[a.length,0].concat(n)),r--)}a[0]="M"}function u(a,r){for(var n=(c-a.length)/e;0<n&&n--;)(b=a.slice().splice(a.length/C-e,e*C))[0]=r[c-e-n*e],f&&(b[e-6]=b[e-2],b[e-5]=b[e-1]),[].splice.apply(a,[a.length/C,0].concat(b)),l&&n--}k=k||"";var z,c,b,r,m=v.startX,g=v.endX,f=-1<k.indexOf("C"),e=f?7:3;k=k.split(" "),q=q.slice();var I,l=v.isArea,C=l?2:1;if(f&&(w(k),w(q)),m&&g){for(r=0;r<m.length;r++){if(m[r]===g[0]){z=r;break}if(m[0]===g[g.length-m.length+r]){z=r,I=!0;break}}void 0===z&&(k=[])}return k.length&&a.isNumber(z)&&(c=q.length+z*C*e,I?(t(k,q),u(q,k)):(t(q,k),u(k,q))),[k,q]}},a.Fx.prototype.fillSetter=a.Fx.prototype.strokeSetter=function(){this.elem.attr(this.prop,a.color(this.start).tweenTo(a.color(this.end),this.pos),null,!0)},a.extend=function(a,k){var q;for(q in a||(a={}),k)a[q]=k[q];return a},a.merge=function(){var v,q,k=arguments,w={},t=function(u,q){return"object"!=typeof u&&(u={}),a.objectEach(q,function(m,g){!a.isObject(m,!0)||a.isClass(m)||a.isDOMElement(m)?u[g]=q[g]:u[g]=t(u[g]||{},m)}),u};for(!0===k[0]&&(w=k[1],k=Array.prototype.slice.call(k,2)),q=k.length,v=0;v<q;v++)w=t(w,k[v]);return w},a.pInt=function(a,k){return parseInt(a,k||10)},a.isString=function(a){return"string"==typeof a},a.isArray=function(a){return"[object Array]"===(a=Object.prototype.toString.call(a))||"[object Array Iterator]"===a},a.isObject=function(v,k){return!(!v||"object"!=typeof v||k&&a.isArray(v))},a.isDOMElement=function(v){return a.isObject(v)&&"number"==typeof v.nodeType},a.isClass=function(v){var k=v&&v.constructor;return!(!a.isObject(v,!0)||a.isDOMElement(v)||!k||!k.name||"Object"===k.name)},a.isNumber=function(a){return"number"==typeof a&&!isNaN(a)&&1/0>a&&-1/0<a},a.erase=function(a,k){for(var q=a.length;q--;)if(a[q]===k){a.splice(q,1);break}},a.defined=function(a){return void 0!==a&&null!==a},a.attr=function(v,k,q){var w;return a.isString(k)?a.defined(q)?v.setAttribute(k,q):v&&v.getAttribute&&(w=v.getAttribute(k)):a.defined(k)&&a.isObject(k)&&a.objectEach(k,function(a,u){v.setAttribute(u,a)}),w},a.splat=function(v){return a.isArray(v)?v:[v]},a.syncTimeout=function(a,k,q){if(k)return setTimeout(a,k,q);a.call(0,q)},a.pick=function(){var k,q,a=arguments,w=a.length;for(k=0;k<w;k++)if(void 0!==(q=a[k])&&null!==q)return q},a.css=function(v,k){a.isMS&&!a.svg&&k&&void 0!==k.opacity&&(k.filter="alpha(opacity="+100*k.opacity+")"),a.extend(v.style,k)},a.createElement=function(v,k,q,w,t){v=E.createElement(v);var u=a.css;return k&&a.extend(v,k),t&&u(v,{padding:0,border:"none",margin:0}),q&&u(v,q),w&&w.appendChild(v),v},a.extendClass=function(v,k){var q=function(){};return q.prototype=new v,a.extend(q.prototype,k),q},a.pad=function(a,k,q){return Array((k||2)+1-String(a).length).join(q||0)+a},a.relativeLength=function(a,k,q){return/%$/.test(a)?k*parseFloat(a)/100+(q||0):parseFloat(a)},a.wrap=function(a,k,q){var v=a[k];a[k]=function(){var a=Array.prototype.slice.call(arguments),u=arguments,z=this;return z.proceed=function(){v.apply(z,arguments.length?arguments:u)},a.unshift(v),a=q.apply(this,a),z.proceed=null,a}},a.getTZOffset=function(v){var k=a.Date;return 6e4*(k.hcGetTimezoneOffset&&k.hcGetTimezoneOffset(v)||k.hcTimezoneOffset||0)},a.dateFormat=function(v,k,q){if(!a.defined(k)||isNaN(k))return a.defaultOptions.lang.invalidDate||"";v=a.pick(v,"%Y-%m-%d %H:%M:%S");var t=new(w=a.Date)(k-a.getTZOffset(k)),u=t[w.hcGetHours](),z=t[w.hcGetDay](),m=t[w.hcGetDate](),g=t[w.hcGetMonth](),f=t[w.hcGetFullYear](),e=a.defaultOptions.lang,c=e.weekdays,b=e.shortWeekdays,r=a.pad,w=a.extend({a:b?b[z]:c[z].substr(0,3),A:c[z],d:r(m),e:r(m,2," "),w:z,b:e.shortMonths[g],B:e.months[g],m:r(g+1),y:f.toString().substr(2,2),Y:f,H:r(u),k:u,I:r(u%12||12),l:u%12||12,M:r(t[w.hcGetMinutes]()),p:12>u?"AM":"PM",P:12>u?"am":"pm",S:r(t.getSeconds()),L:r(Math.round(k%1e3),3)},a.dateFormats);return a.objectEach(w,function(a,b){for(;-1!==v.indexOf("%"+b);)v=v.replace("%"+b,"function"==typeof a?a(k):a)}),q?v.substr(0,1).toUpperCase()+v.substr(1):v},a.formatSingle=function(v,k){var q=/\.([0-9])/,w=a.defaultOptions.lang;return/f$/.test(v)?(q=(q=v.match(q))?q[1]:-1,null!==k&&(k=a.numberFormat(k,q,w.decimalPoint,-1<v.indexOf(",")?w.thousandsSep:""))):k=a.dateFormat(v,k),k},a.format=function(v,k){for(var t,u,z,m,f,q="{",w=!1,g=[];v&&-1!==(q=v.indexOf(q));){if(t=v.slice(0,q),w){for(m=(u=(t=t.split(":")).shift().split(".")).length,f=k,z=0;z<m;z++)f&&(f=f[u[z]]);t.length&&(f=a.formatSingle(t.join(":"),f)),g.push(f)}else g.push(t);v=v.slice(q+1),q=(w=!w)?"}":"{"}return g.push(v),g.join("")},a.getMagnitude=function(a){return Math.pow(10,Math.floor(Math.log(a)/Math.LN10))},a.normalizeTickInterval=function(v,k,q,w,t){var u,z=v;for(u=v/(q=a.pick(q,1)),k||(k=t?[1,1.2,1.5,2,2.5,3,4,5,6,8,10]:[1,2,2.5,5,10],!1===w&&(1===q?k=a.grep(k,function(a){return 0==a%1}):.1>=q&&(k=[1/q]))),w=0;w<k.length&&(z=k[w],!(t&&z*q>=v||!t&&u<=(k[w]+(k[w+1]||k[w]))/2));w++);return a.correctFloat(z*q,-Math.round(Math.log(.001)/Math.LN10))},a.stableSort=function(a,k){var v,t,q=a.length;for(t=0;t<q;t++)a[t].safeI=t;for(a.sort(function(a,t){return 0===(v=k(a,t))?a.safeI-t.safeI:v}),t=0;t<q;t++)delete a[t].safeI},a.arrayMin=function(a){for(var k=a.length,q=a[0];k--;)a[k]<q&&(q=a[k]);return q},a.arrayMax=function(a){for(var k=a.length,q=a[0];k--;)a[k]>q&&(q=a[k]);return q},a.destroyObjectProperties=function(v,k){a.objectEach(v,function(a,w){a&&a!==k&&a.destroy&&a.destroy(),delete v[w]})},a.discardElement=function(v){var k=a.garbageBin;k||(k=a.createElement("div")),v&&k.appendChild(v),k.innerHTML=""},a.correctFloat=function(a,k){return parseFloat(a.toPrecision(k||14))},a.setAnimation=function(v,k){k.renderer.globalAnimation=a.pick(v,k.options.chart.animation,!0)},a.animObject=function(v){return a.isObject(v)?a.merge(v):{duration:v?500:0}},a.timeUnits={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:24192e5,year:314496e5},a.numberFormat=function(v,k,q,w){v=+v||0,k=+k;var z,m,t=a.defaultOptions.lang,u=(v.toString().split(".")[1]||"").split("e")[0].length,g=v.toString().split("e");return-1===k?k=Math.min(u,20):a.isNumber(k)?k&&g[1]&&0>g[1]&&(0<=(z=k+ +g[1])?(g[0]=(+g[0]).toExponential(z).split("e")[0],k=z):(g[0]=g[0].split(".")[0]||0,v=20>k?(g[0]*Math.pow(10,g[1])).toFixed(k):0,g[1]=0)):k=2,m=(Math.abs(g[1]?g[0]:v)+Math.pow(10,-Math.max(k,u)-1)).toFixed(k),z=3<(u=String(a.pInt(m))).length?u.length%3:0,q=a.pick(q,t.decimalPoint),w=a.pick(w,t.thousandsSep),v=(0>v?"-":"")+(z?u.substr(0,z)+w:""),v+=u.substr(z).replace(/(\d{3})(?=\d)/g,"$1"+w),k&&(v+=q+m.slice(-k)),g[1]&&0!=+v&&(v+="e"+g[1]),v},Math.easeInOutSine=function(a){return-.5*(Math.cos(Math.PI*a)-1)},a.getStyle=function(v,k,q){return"width"===k?Math.min(v.offsetWidth,v.scrollWidth)-a.getStyle(v,"padding-left")-a.getStyle(v,"padding-right"):"height"===k?Math.min(v.offsetHeight,v.scrollHeight)-a.getStyle(v,"padding-top")-a.getStyle(v,"padding-bottom"):(H.getComputedStyle||a.error(27,!0),(v=H.getComputedStyle(v,void 0))&&(v=v.getPropertyValue(k),a.pick(q,"opacity"!==k)&&(v=a.pInt(v))),v)},a.inArray=function(v,k){return(a.indexOfPolyfill||Array.prototype.indexOf).call(k,v)},a.grep=function(v,k){return(a.filterPolyfill||Array.prototype.filter).call(v,k)},a.find=Array.prototype.find?function(a,k){return a.find(k)}:function(a,k){var q,w=a.length;for(q=0;q<w;q++)if(k(a[q],q))return a[q]},a.map=function(a,k){for(var q=[],w=0,t=a.length;w<t;w++)q[w]=k.call(a[w],a[w],w,a);return q},a.keys=function(v){return(a.keysPolyfill||Object.keys).call(void 0,v)},a.reduce=function(v,k,q){return(a.reducePolyfill||Array.prototype.reduce).call(v,k,q)},a.offset=function(a){var k=E.documentElement;return{top:(a=a.parentElement?a.getBoundingClientRect():{top:0,left:0}).top+(H.pageYOffset||k.scrollTop)-(k.clientTop||0),left:a.left+(H.pageXOffset||k.scrollLeft)-(k.clientLeft||0)}},a.stop=function(v,k){for(var q=a.timers.length;q--;)a.timers[q].elem!==v||k&&k!==a.timers[q].prop||(a.timers[q].stopped=!0)},a.each=function(v,k,q){return(a.forEachPolyfill||Array.prototype.forEach).call(v,k,q)},a.objectEach=function(a,k,q){for(var w in a)a.hasOwnProperty(w)&&k.call(q,a[w],w,a)},a.addEvent=function(v,k,q){var w,t,u=v.addEventListener||a.addEventListenerPolyfill;return v.hcEvents&&!Object.prototype.hasOwnProperty.call(v,"hcEvents")&&(t={},a.objectEach(v.hcEvents,function(a,m){t[m]=a.slice(0)}),v.hcEvents=t),w=v.hcEvents=v.hcEvents||{},u&&u.call(v,k,q,!1),w[k]||(w[k]=[]),w[k].push(q),function(){a.removeEvent(v,k,q)}},a.removeEvent=function(v,k,q){function w(g,f){var e=v.removeEventListener||a.removeEventListenerPolyfill;e&&e.call(v,g,f,!1)}function t(){var g,f;v.nodeName&&(k?(g={})[k]=!0:g=z,a.objectEach(g,function(a,c){if(z[c])for(f=z[c].length;f--;)w(c,z[c][f])}))}var u,m,z=v.hcEvents;z&&(k?(u=z[k]||[],q?(-1<(m=a.inArray(q,u))&&(u.splice(m,1),z[k]=u),w(k,q)):(t(),z[k]=[])):(t(),v.hcEvents={}))},a.fireEvent=function(v,k,q,w){var t,u,z;if(t=v.hcEvents,q=q||{},E.createEvent&&(v.dispatchEvent||v.fireEvent))(t=E.createEvent("Events")).initEvent(k,!0,!0),a.extend(t,q),v.dispatchEvent?v.dispatchEvent(t):v.fireEvent(k,t);else if(t)for(u=(t=t[k]||[]).length,q.target||a.extend(q,{preventDefault:function(){q.defaultPrevented=!0},target:v,type:k}),k=0;k<u;k++)(z=t[k])&&!1===z.call(v,q)&&q.preventDefault();w&&!q.defaultPrevented&&w(q)},a.animate=function(v,k,q){var w,u,z,m,t="";a.isObject(q)||(q={duration:(m=arguments)[2],easing:m[3],complete:m[4]}),a.isNumber(q.duration)||(q.duration=400),q.easing="function"==typeof q.easing?q.easing:Math[q.easing]||Math.easeInOutSine,q.curAnim=a.merge(k),a.objectEach(k,function(g,f){a.stop(v,f),z=new a.Fx(v,q,f),u=null,"d"===f?(z.paths=z.initPath(v,v.d,k.d),z.toD=k.d,w=0,u=1):v.attr?w=v.attr(f):(w=parseFloat(a.getStyle(v,f))||0,"opacity"!==f&&(t="px")),u||(u=g),u&&u.match&&u.match("px")&&(u=u.replace(/px/g,"")),z.run(w,u,t)})},a.seriesType=function(v,k,q,w,t){var u=a.getOptions(),z=a.seriesTypes;return u.plotOptions[v]=a.merge(u.plotOptions[k],q),z[v]=a.extendClass(z[k]||function(){},w),z[v].prototype.type=v,t&&(z[v].prototype.pointClass=a.extendClass(a.Point,t)),z[v]},a.uniqueKey=function(){var a=Math.random().toString(36).substring(2,9),k=0;return function(){return"highcharts-"+a+"-"+k++}}(),H.jQuery&&(H.jQuery.fn.highcharts=function(){var v=[].slice.call(arguments);if(this[0])return v[0]?(new(a[a.isString(v[0])?v.shift():"Chart"])(this[0],v[0],v[1]),this):G[a.attr(this[0],"data-highcharts-chart")]})}(L),function(a){var G=a.each,E=a.isNumber,H=a.map,v=a.merge,k=a.pInt;a.Color=function(q){if(!(this instanceof a.Color))return new a.Color(q);this.init(q)},a.Color.prototype={parsers:[{regex:/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/,parse:function(a){return[k(a[1]),k(a[2]),k(a[3]),parseFloat(a[4],10)]}},{regex:/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,parse:function(a){return[k(a[1]),k(a[2]),k(a[3]),1]}}],names:{none:"rgba(255,255,255,0)",white:"#ffffff",black:"#000000"},init:function(q){var k,t,u,z;if((this.input=q=this.names[q&&q.toLowerCase?q.toLowerCase():""]||q)&&q.stops)this.stops=H(q.stops,function(m){return new a.Color(m[1])});else if(q&&q.charAt&&"#"===q.charAt()&&(k=q.length,q=parseInt(q.substr(1),16),7===k?t=[(16711680&q)>>16,(65280&q)>>8,255&q,1]:4===k&&(t=[(3840&q)>>4|(3840&q)>>8,(240&q)>>4|240&q,(15&q)<<4|15&q,1])),!t)for(u=this.parsers.length;u--&&!t;)(k=(z=this.parsers[u]).regex.exec(q))&&(t=z.parse(k));this.rgba=t||[]},get:function(a){var u,q=this.input,t=this.rgba;return this.stops?((u=v(q)).stops=[].concat(u.stops),G(this.stops,function(t,m){u.stops[m]=[u.stops[m][0],t.get(a)]})):u=t&&E(t[0])?"rgb"===a||!a&&1===t[3]?"rgb("+t[0]+","+t[1]+","+t[2]+")":"a"===a?t[3]:"rgba("+t.join(",")+")":q,u},brighten:function(a){var q,t=this.rgba;if(this.stops)G(this.stops,function(t){t.brighten(a)});else if(E(a)&&0!==a)for(q=0;3>q;q++)t[q]+=k(255*a),0>t[q]&&(t[q]=0),255<t[q]&&(t[q]=255);return this},setOpacity:function(a){return this.rgba[3]=a,this},tweenTo:function(a,k){var t=this.rgba,u=a.rgba;return u.length&&t&&t.length?k=((a=1!==u[3]||1!==t[3])?"rgba(":"rgb(")+Math.round(u[0]+(t[0]-u[0])*(1-k))+","+Math.round(u[1]+(t[1]-u[1])*(1-k))+","+Math.round(u[2]+(t[2]-u[2])*(1-k))+(a?","+(u[3]+(t[3]-u[3])*(1-k)):"")+")":k=a.input||"none",k}},a.color=function(k){return new a.Color(k)}}(L),function(a){var G,E,H=a.addEvent,v=a.animate,k=a.attr,q=a.charts,w=a.color,t=a.css,u=a.createElement,z=a.defined,m=a.deg2rad,g=a.destroyObjectProperties,f=a.doc,e=a.each,c=a.extend,b=a.erase,r=a.grep,l=a.hasTouch,C=a.inArray,I=a.isArray,x=a.isFirefox,F=a.isMS,n=a.isObject,B=a.isString,J=a.isWebKit,A=a.merge,d=a.noop,p=a.objectEach,D=a.pick,h=a.pInt,y=a.removeEvent,P=a.stop,M=a.svg,O=a.SVG_NS,N=a.symbolSizes,R=a.win;G=a.SVGElement=function(){return this},c(G.prototype,{opacity:1,SVG_NS:O,textProps:"direction fontSize fontWeight fontFamily fontStyle color lineHeight width textAlign textDecoration textOverflow textOutline".split(" "),init:function(a,h){this.element="span"===h?u(h):f.createElementNS(this.SVG_NS,h),this.renderer=a},animate:function(K,h,d){return 0!==(h=a.animObject(D(h,this.renderer.globalAnimation,!0))).duration?(d&&(h.complete=d),v(this,K,h)):(this.attr(K,null,d),h.step&&h.step.call(this)),this},colorGradient:function(h,d,y){var b,c,l,n,r,f,S,M,C,D,B,K=this.renderer,g=[];h.radialGradient?c="radialGradient":h.linearGradient&&(c="linearGradient"),c&&(l=h[c],r=K.gradients,S=h.stops,D=y.radialReference,I(l)&&(h[c]=l={x1:l[0],y1:l[1],x2:l[2],y2:l[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===c&&D&&!z(l.gradientUnits)&&(n=l,l=A(l,K.getRadialAttr(D,n),{gradientUnits:"userSpaceOnUse"})),p(l,function(a,h){"id"!==h&&g.push(h,a)}),p(S,function(a){g.push(a)}),r[g=g.join(",")]?D=r[g].attr("id"):(l.id=D=a.uniqueKey(),r[g]=f=K.createElement(c).attr(l).add(K.defs),f.radAttr=n,f.stops=[],e(S,function(h){0===h[1].indexOf("rgba")?(b=a.color(h[1]),M=b.get("rgb"),C=b.get("a")):(M=h[1],C=1),h=K.createElement("stop").attr({offset:h[0],"stop-color":M,"stop-opacity":C}).add(f),f.stops.push(h)})),B="url("+K.url+"#"+D+")",y.setAttribute(d,B),y.gradient=g,h.toString=function(){return B})},applyTextOutline:function(h){var d,y,c,p,l,K=this.element;if(-1!==h.indexOf("contrast")&&(h=h.replace(/contrast/g,this.renderer.getContrast(K.style.fill))),h=h.split(" "),y=h[h.length-1],(c=h[0])&&"none"!==c&&a.svg){for(this.fakeTS=!0,h=[].slice.call(K.getElementsByTagName("tspan")),this.ySetter=this.xSetter,c=c.replace(/(^[\d\.]+)(.*?)$/g,function(a,h,K){return 2*h+K}),l=h.length;l--;)"highcharts-text-outline"===(d=h[l]).getAttribute("class")&&b(h,K.removeChild(d));p=K.firstChild,e(h,function(a,h){0===h&&(a.setAttribute("x",K.getAttribute("x")),h=K.getAttribute("y"),a.setAttribute("y",h||0),null===h&&K.setAttribute("y",0)),a=a.cloneNode(1),k(a,{class:"highcharts-text-outline",fill:y,stroke:y,"stroke-width":c,"stroke-linejoin":"round"}),K.insertBefore(a,p)})}},attr:function(a,h,d,y){var K,c,e,n,b=this.element,l=this;return"string"==typeof a&&void 0!==h&&(K=a,(a={})[K]=h),"string"==typeof a?l=(this[a+"Getter"]||this._defaultGetter).call(this,a,b):(p(a,function(h,K){e=!1,y||P(this,K),this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)$/.test(K)&&(c||(this.symbolAttr(a),c=!0),e=!0),!this.rotation||"x"!==K&&"y"!==K||(this.doTransform=!0),e||((n=this[K+"Setter"]||this._defaultSetter).call(this,h,K,b),this.shadows&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(K)&&this.updateShadows(K,h,n))},this),this.afterSetters()),d&&d(),l},afterSetters:function(){this.doTransform&&(this.updateTransform(),this.doTransform=!1)},updateShadows:function(a,h,d){for(var K=this.shadows,y=K.length;y--;)d.call(K[y],"height"===a?Math.max(h-(K[y].cutHeight||0),0):"d"===a?this.d:h,a,K[y])},addClass:function(a,h){var K=this.attr("class")||"";return-1===K.indexOf(a)&&(h||(a=(K+(K?" ":"")+a).replace("  "," ")),this.attr("class",a)),this},hasClass:function(a){return-1!==C(a,(this.attr("class")||"").split(" "))},removeClass:function(a){return this.attr("class",(this.attr("class")||"").replace(a,""))},symbolAttr:function(a){var h=this;e("x y r start end width height innerR anchorX anchorY".split(" "),function(K){h[K]=D(a[K],h[K])}),h.attr({d:h.renderer.symbols[h.symbolName](h.x,h.y,h.width,h.height,h)})},clip:function(a){return this.attr("clip-path",a?"url("+this.renderer.url+"#"+a.id+")":"none")},crisp:function(a,h){var d;return h=h||a.strokeWidth||0,d=Math.round(h)%2/2,a.x=Math.floor(a.x||this.x||0)+d,a.y=Math.floor(a.y||this.y||0)+d,a.width=Math.floor((a.width||this.width||0)-2*d),a.height=Math.floor((a.height||this.height||0)-2*d),z(a.strokeWidth)&&(a.strokeWidth=h),a},css:function(a){var b,l,d=this.styles,y={},K=this.element,e="",n=!d,A=["textOutline","textOverflow","width"];return a&&a.color&&(a.fill=a.color),d&&p(a,function(a,h){a!==d[h]&&(y[h]=a,n=!0)}),n&&(d&&(a=c(d,y)),b=this.textWidth=a&&a.width&&"auto"!==a.width&&"text"===K.nodeName.toLowerCase()&&h(a.width),this.styles=a,b&&!M&&this.renderer.forExport&&delete a.width,F&&!M?t(this.element,a):(l=function(a,h){return"-"+h.toLowerCase()},p(a,function(a,h){-1===C(h,A)&&(e+=h.replace(/([A-Z])/g,l)+":"+a+";")}),e&&k(K,"style",e)),this.added&&("text"===this.element.nodeName&&this.renderer.buildText(this),a&&a.textOutline&&this.applyTextOutline(a.textOutline))),this},strokeWidth:function(){return this["stroke-width"]||0},on:function(a,h){var d=this,y=d.element;return l&&"click"===a?(y.ontouchstart=function(a){d.touchEventFired=Date.now(),a.preventDefault(),h.call(y,a)},y.onclick=function(a){(-1===R.navigator.userAgent.indexOf("Android")||1100<Date.now()-(d.touchEventFired||0))&&h.call(y,a)}):y["on"+a]=h,this},setRadialReference:function(a){var h=this.renderer.gradients[this.element.gradient];return this.element.radialReference=a,h&&h.radAttr&&h.animate(this.renderer.getRadialAttr(a,h.radAttr)),this},translate:function(a,h){return this.attr({translateX:a,translateY:h})},invert:function(a){return this.inverted=a,this.updateTransform(),this},updateTransform:function(){var a=this.translateX||0,h=this.translateY||0,d=this.scaleX,y=this.scaleY,b=this.inverted,c=this.rotation,p=this.matrix,e=this.element;b&&(a+=this.width,h+=this.height),a=["translate("+a+","+h+")"],z(p)&&a.push("matrix("+p.join(",")+")"),b?a.push("rotate(90) scale(-1,1)"):c&&a.push("rotate("+c+" "+D(this.rotationOriginX,e.getAttribute("x"),0)+" "+D(this.rotationOriginY,e.getAttribute("y")||0)+")"),(z(d)||z(y))&&a.push("scale("+D(d,1)+" "+D(y,1)+")"),a.length&&e.setAttribute("transform",a.join(" "))},toFront:function(){var a=this.element;return a.parentNode.appendChild(a),this},align:function(a,h,d){var y,c,K,p,l,n,e={};return K=(c=this.renderer).alignedObjects,a?(this.alignOptions=a,this.alignByTranslate=h,(!d||B(d))&&(this.alignTo=y=d||"renderer",b(K,this),K.push(this),d=null)):(a=this.alignOptions,h=this.alignByTranslate,y=this.alignTo),d=D(d,c[y],c),y=a.align,c=a.verticalAlign,K=(d.x||0)+(a.x||0),p=(d.y||0)+(a.y||0),"right"===y?l=1:"center"===y&&(l=2),l&&(K+=(d.width-(a.width||0))/l),e[h?"translateX":"x"]=Math.round(K),"bottom"===c?n=1:"middle"===c&&(n=2),n&&(p+=(d.height-(a.height||0))/n),e[h?"translateY":"y"]=Math.round(p),this[this.placed?"animate":"attr"](e),this.placed=!0,this.alignAttr=e,this},getBBox:function(a,h){var d,b,l,A,M,y=this.renderer,p=this.element,K=this.styles,n=this.textStr,r=y.cache,f=y.cacheKeys;if(b=(h=D(h,this.rotation))*m,l=K&&K.fontSize,z(n)&&(-1===(M=n.toString()).indexOf("<")&&(M=M.replace(/[0-9]/g,"0")),M+=["",h||0,l,K&&K.width,K&&K.textOverflow].join()),M&&!a&&(d=r[M]),!d){if(p.namespaceURI===this.SVG_NS||y.forExport){try{(A=this.fakeTS&&function(a){e(p.querySelectorAll(".highcharts-text-outline"),function(h){h.style.display=a})})&&A("none"),d=p.getBBox?c({},p.getBBox()):{width:p.offsetWidth,height:p.offsetHeight},A&&A("")}catch(T){}(!d||0>d.width)&&(d={width:0,height:0})}else d=this.htmlGetBBox();if(y.isSVG&&(a=d.width,y=d.height,K&&"11px"===K.fontSize&&17===Math.round(y)&&(d.height=y=14),h&&(d.width=Math.abs(y*Math.sin(b))+Math.abs(a*Math.cos(b)),d.height=Math.abs(y*Math.cos(b))+Math.abs(a*Math.sin(b)))),M&&0<d.height){for(;250<f.length;)delete r[f.shift()];r[M]||f.push(M),r[M]=d}}return d},show:function(a){return this.attr({visibility:a?"inherit":"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(a){var h=this;h.animate({opacity:0},{duration:a||150,complete:function(){h.attr({y:-9999})}})},add:function(a){var y,h=this.renderer,d=this.element;return a&&(this.parentGroup=a),this.parentInverted=a&&a.inverted,void 0!==this.textStr&&h.buildText(this),this.added=!0,(!a||a.handleZ||this.zIndex)&&(y=this.zIndexSetter()),y||(a?a.element:h.box).appendChild(d),this.onAdd&&this.onAdd(),this},safeRemoveChild:function(a){var h=a.parentNode;h&&h.removeChild(a)},destroy:function(){var a=this,h=a.element||{},d=a.renderer.isSVG&&"SPAN"===h.nodeName&&a.parentGroup,y=h.ownerSVGElement;if(h.onclick=h.onmouseout=h.onmouseover=h.onmousemove=h.point=null,P(a),a.clipPath&&y&&(e(y.querySelectorAll("[clip-path],[CLIP-PATH]"),function(h){h.getAttribute("clip-path").match(RegExp('[("]#'+a.clipPath.element.id+'[)"]'))&&h.removeAttribute("clip-path")}),a.clipPath=a.clipPath.destroy()),a.stops){for(y=0;y<a.stops.length;y++)a.stops[y]=a.stops[y].destroy();a.stops=null}for(a.safeRemoveChild(h),a.destroyShadows();d&&d.div&&0===d.div.childNodes.length;)h=d.parentGroup,a.safeRemoveChild(d.div),delete d.div,d=h;return a.alignTo&&b(a.renderer.alignedObjects,a),p(a,function(h,d){delete a[d]}),null},shadow:function(a,h,d){var b,c,e,l,K,n,y=[],p=this.element;if(a){if(!this.shadows){for(l=D(a.width,3),K=(a.opacity||.15)/l,n=this.parentInverted?"(-1,-1)":"("+D(a.offsetX,1)+", "+D(a.offsetY,1)+")",b=1;b<=l;b++)c=p.cloneNode(0),e=2*l+1-2*b,k(c,{isShadow:"true",stroke:a.color||"#000000","stroke-opacity":K*b,"stroke-width":e,transform:"translate"+n,fill:"none"}),d&&(k(c,"height",Math.max(k(c,"height")-e,0)),c.cutHeight=e),h?h.element.appendChild(c):p.parentNode&&p.parentNode.insertBefore(c,p),y.push(c);this.shadows=y}}else this.destroyShadows();return this},destroyShadows:function(){e(this.shadows||[],function(a){this.safeRemoveChild(a)},this),this.shadows=void 0},xGetter:function(a){return"circle"===this.element.nodeName&&("x"===a?a="cx":"y"===a&&(a="cy")),this._defaultGetter(a)},_defaultGetter:function(a){return a=D(this[a+"Value"],this[a],this.element?this.element.getAttribute(a):null,0),/^[\-0-9\.]+$/.test(a)&&(a=parseFloat(a)),a},dSetter:function(a,h,d){a&&a.join&&(a=a.join(" ")),/(NaN| {2}|^$)/.test(a)&&(a="M 0 0"),this[h]!==a&&(d.setAttribute(h,a),this[h]=a)},dashstyleSetter:function(a){var d,y=this["stroke-width"];if("inherit"===y&&(y=1),a=a&&a.toLowerCase()){for(d=(a=a.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",")).length;d--;)a[d]=h(a[d])*y;a=a.join(",").replace(/NaN/g,"none"),this.element.setAttribute("stroke-dasharray",a)}},alignSetter:function(a){this.alignValue=a,this.element.setAttribute("text-anchor",{left:"start",center:"middle",right:"end"}[a])},opacitySetter:function(a,h,d){this[h]=a,d.setAttribute(h,a)},titleSetter:function(a){var h=this.element.getElementsByTagName("title")[0];h||(h=f.createElementNS(this.SVG_NS,"title"),this.element.appendChild(h)),h.firstChild&&h.removeChild(h.firstChild),h.appendChild(f.createTextNode(String(D(a),"").replace(/<[^>]*>/g,"")))},textSetter:function(a){a!==this.textStr&&(delete this.bBox,this.textStr=a,this.added&&this.renderer.buildText(this))},fillSetter:function(a,h,d){"string"==typeof a?d.setAttribute(h,a):a&&this.colorGradient(a,h,d)},visibilitySetter:function(a,h,d){"inherit"===a?d.removeAttribute(h):this[h]!==a&&d.setAttribute(h,a),this[h]=a},zIndexSetter:function(a,d){var p,l,n,A,y=this.renderer,b=this.parentGroup,c=(b||y).element||y.box,e=this.element;y=c===y.box;if(p=this.added,z(a)&&(e.zIndex=a,a=+a,this[d]===a&&(p=!1),this[d]=a),p){for((a=this.zIndex)&&b&&(b.handleZ=!0),A=(d=c.childNodes).length-1;0<=A&&!l;A--)p=(b=d[A]).zIndex,n=!z(p),b!==e&&(0>a&&n&&!y&&!A?(c.insertBefore(e,d[A]),l=!0):(h(p)<=a||n&&(!z(a)||0<=a))&&(c.insertBefore(e,d[A+1]||null),l=!0));l||(c.insertBefore(e,d[y?3:0]||null),l=!0)}return l},_defaultSetter:function(a,h,d){d.setAttribute(h,a)}}),G.prototype.yGetter=G.prototype.xGetter,G.prototype.translateXSetter=G.prototype.translateYSetter=G.prototype.rotationSetter=G.prototype.verticalAlignSetter=G.prototype.rotationOriginXSetter=G.prototype.rotationOriginYSetter=G.prototype.scaleXSetter=G.prototype.scaleYSetter=G.prototype.matrixSetter=function(a,h){this[h]=a,this.doTransform=!0},G.prototype["stroke-widthSetter"]=G.prototype.strokeSetter=function(a,h,d){this[h]=a,this.stroke&&this["stroke-width"]?(G.prototype.fillSetter.call(this,this.stroke,"stroke",d),d.setAttribute("stroke-width",this["stroke-width"]),this.hasStroke=!0):"stroke-width"===h&&0===a&&this.hasStroke&&(d.removeAttribute("stroke"),this.hasStroke=!1)},E=a.SVGRenderer=function(){this.init.apply(this,arguments)},c(E.prototype,{Element:G,SVG_NS:O,init:function(a,h,d,y,b,c){var p,e;p=(y=this.createElement("svg").attr({version:"1.1",class:"highcharts-root"}).css(this.getStyle(y))).element,a.appendChild(p),k(a,"dir","ltr"),-1===a.innerHTML.indexOf("xmlns")&&k(p,"xmlns",this.SVG_NS),this.isSVG=!0,this.box=p,this.boxWrapper=y,this.alignedObjects=[],this.url=(x||J)&&f.getElementsByTagName("base").length?R.location.href.replace(/#.*?$/,"").replace(/<[^>]*>/g,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",this.createElement("desc").add().element.appendChild(f.createTextNode("Created with Highstock 6.0.4")),this.defs=this.createElement("defs").add(),this.allowHTML=c,this.forExport=b,this.gradients={},this.cache={},this.cacheKeys=[],this.imgCount=0,this.setSize(h,d,!1),x&&a.getBoundingClientRect&&((h=function(){t(a,{left:0,top:0}),e=a.getBoundingClientRect(),t(a,{left:Math.ceil(e.left)-e.left+"px",top:Math.ceil(e.top)-e.top+"px"})})(),this.unSubPixelFix=H(R,"resize",h))},getStyle:function(a){return this.style=c({fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Arial, Helvetica, sans-serif',fontSize:"12px"},a)},setStyle:function(a){this.boxWrapper.css(this.getStyle(a))},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;return this.box=null,this.boxWrapper=this.boxWrapper.destroy(),g(this.gradients||{}),this.gradients=null,a&&(this.defs=a.destroy()),this.unSubPixelFix&&this.unSubPixelFix(),this.alignedObjects=null},createElement:function(a){var h=new this.Element;return h.init(this,a),h},draw:d,getRadialAttr:function(a,h){return{cx:a[0]-a[2]/2+h.cx*a[2],cy:a[1]-a[2]/2+h.cy*a[2],r:h.r*a[2]}},getSpanWidth:function(a,h){var d=a.getBBox(!0).width;return!M&&this.forExport&&(d=this.measureSpanWidth(h.firstChild.data,a.styles)),d},applyEllipsis:function(a,h,d,y){var p,A,b=a.rotation,c=d,e=0,l=d.length,n=function(a){h.removeChild(h.firstChild),a&&h.appendChild(f.createTextNode(a))};if(a.rotation=0,A=(c=this.getSpanWidth(a,h))>y){for(;e<=l;)p=Math.ceil((e+l)/2),n(c=d.substring(0,p)+"…"),c=this.getSpanWidth(a,h),e===l?e=l+1:c>y?l=p-1:e=p;0===l&&n("")}return a.rotation=b,A},escapes:{"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},buildText:function(a){var A,K,C,g,R,q,d=a.element,y=this,b=y.forExport,c=D(a.textStr,"").toString(),l=-1!==c.indexOf("<"),n=d.childNodes,B=k(d,"x"),x=a.styles,m=a.textWidth,N=x&&x.lineHeight,P=x&&x.textOutline,F=x&&"ellipsis"===x.textOverflow,I=x&&"nowrap"===x.whiteSpace,u=x&&x.fontSize,J=n.length,z=(x=m&&!a.added&&this.box,function(a){var b;return b=/(px|em)$/.test(a&&a.style.fontSize)?a.style.fontSize:u||y.style.fontSize||12,N?h(N):y.fontMetrics(b,a.getAttribute("style")?a:d).h}),w=function(a){return p(y.escapes,function(h,d){a=a.replace(new RegExp(h,"g"),d)}),a};if((R=[c,F,I,N,P,u,m].join())!==a.textCache){for(a.textCache=R;J--;)d.removeChild(n[J]);l||P||F||m||-1!==c.indexOf(" ")?(A=/<.*class="([^"]+)".*>/,K=/<.*style="([^"]+)".*>/,C=/<.*href="([^"]+)".*>/,x&&x.appendChild(d),c=l?c.replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g):[c],c=r(c,function(a){return""!==a}),e(c,function(h,c){var p,l=0;h=h.replace(/^\s+|\s+$/g,"").replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),p=h.split("|||"),e(p,function(h){if(""!==h||1===p.length){var r,D,e={},n=f.createElementNS(y.SVG_NS,"tspan");if(A.test(h)&&(r=h.match(A)[1],k(n,"class",r)),K.test(h)&&(D=h.match(K)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),k(n,"style",D)),C.test(h)&&!b&&(k(n,"onclick",'location.href="'+h.match(C)[1]+'"'),k(n,"class","highcharts-anchor"),t(n,{cursor:"pointer"}))," "!==(h=w(h.replace(/<[a-zA-Z\/](.|\n)*?>/g,"")||" "))){if(n.appendChild(f.createTextNode(h)),l?e.dx=0:c&&null!==B&&(e.x=B),k(n,e),d.appendChild(n),!l&&q&&(!M&&b&&t(n,{display:"block"}),k(n,"dy",z(n))),m){e=h.replace(/([^\^])-/g,"$1- ").split(" "),r=1<p.length||c||1<e.length&&!I;var N,x=[],P=z(n),S=a.rotation;for(F&&(g=y.applyEllipsis(a,n,h,m));!F&&r&&(e.length||x.length);)a.rotation=0,h=(N=y.getSpanWidth(a,n))>m,void 0===g&&(g=h),h&&1!==e.length?(n.removeChild(n.firstChild),x.unshift(e.pop())):(e=x,x=[],e.length&&!I&&(n=f.createElementNS(O,"tspan"),k(n,{dy:P,x:B}),D&&k(n,"style",D),d.appendChild(n)),N>m&&(m=N)),e.length&&n.appendChild(f.createTextNode(e.join(" ").replace(/- /g,"-")));a.rotation=S}l++}}}),q=q||d.childNodes.length}),g&&a.attr("title",a.textStr),x&&x.removeChild(d),P&&a.applyTextOutline&&a.applyTextOutline(P)):d.appendChild(f.createTextNode(w(c)))}},getContrast:function(a){return 510<(a=w(a).rgba)[0]+a[1]+a[2]?"#000000":"#FFFFFF"},button:function(a,h,d,y,b,p,e,l,n){var M,C,D,K,r=this.label(a,h,d,n,null,null,null,null,"button"),f=0;return r.attr(A({padding:8,r:2},b)),b=A({fill:"#f7f7f7",stroke:"#cccccc","stroke-width":1,style:{color:"#333333",cursor:"pointer",fontWeight:"normal"}},b),M=b.style,delete b.style,p=A(b,{fill:"#e6e6e6"},p),C=p.style,delete p.style,e=A(b,{fill:"#e6ebf5",style:{color:"#000000",fontWeight:"bold"}},e),D=e.style,delete e.style,l=A(b,{style:{color:"#cccccc"}},l),K=l.style,delete l.style,H(r.element,F?"mouseover":"mouseenter",function(){3!==f&&r.setState(1)}),H(r.element,F?"mouseout":"mouseleave",function(){3!==f&&r.setState(f)}),r.setState=function(a){1!==a&&(r.state=f=a),r.removeClass(/highcharts-button-(normal|hover|pressed|disabled)/).addClass("highcharts-button-"+["normal","hover","pressed","disabled"][a||0]),r.attr([b,p,e,l][a||0]).css([M,C,D,K][a||0])},r.attr(b).css(c({cursor:"default"},M)),r.on("click",function(a){3!==f&&y.call(r,a)})},crispLine:function(a,h){return a[1]===a[4]&&(a[1]=a[4]=Math.round(a[1])-h%2/2),a[2]===a[5]&&(a[2]=a[5]=Math.round(a[2])+h%2/2),a},path:function(a){var h={fill:"none"};return I(a)?h.d=a:n(a)&&c(h,a),this.createElement("path").attr(h)},circle:function(a,h,d){return a=n(a)?a:{x:a,y:h,r:d},(h=this.createElement("circle")).xSetter=h.ySetter=function(a,h,d){d.setAttribute("c"+h,a)},h.attr(a)},arc:function(a,h,d,y,b,c){return n(a)?(h=(y=a).y,d=y.r,a=y.x):y={innerR:y,start:b,end:c},(a=this.symbol("arc",a,h,d,d,y)).r=d,a},rect:function(a,h,d,y,b,c){b=n(a)?a.r:b;var p=this.createElement("rect");return a=n(a)?a:void 0===a?{}:{x:a,y:h,width:Math.max(d,0),height:Math.max(y,0)},void 0!==c&&(a.strokeWidth=c,a=p.crisp(a)),a.fill="none",b&&(a.r=b),p.rSetter=function(a,h,d){k(d,{rx:a,ry:a})},p.attr(a)},setSize:function(a,h,d){var y=this.alignedObjects,b=y.length;for(this.width=a,this.height=h,this.boxWrapper.animate({width:a,height:h},{step:function(){this.attr({viewBox:"0 0 "+this.attr("width")+" "+this.attr("height")})},duration:D(d,!0)?void 0:0});b--;)y[b].align()},g:function(a){var h=this.createElement("g");return a?h.attr({class:"highcharts-"+a}):h},image:function(a,h,d,y,b){var p={preserveAspectRatio:"none"};return 1<arguments.length&&c(p,{x:h,y:d,width:y,height:b}),(p=this.createElement("image").attr(p)).element.setAttributeNS?p.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):p.element.setAttribute("hc-svg-href",a),p},symbol:function(a,h,d,y,b,p){var n,x,B,l=this,A=/^url\((.*?)\)$/,r=A.test(a),M=!r&&(this.symbols[a]?a:"circle"),C=M&&this.symbols[M],g=z(h)&&C&&C.call(this.symbols,Math.round(h),Math.round(d),y,b,p);return C?((n=this.path(g)).attr("fill","none"),c(n,{symbolName:M,x:h,y:d,width:y,height:b}),p&&c(n,p)):r&&(x=a.match(A)[1],(n=this.image(x)).imgwidth=D(N[x]&&N[x].width,p&&p.width),n.imgheight=D(N[x]&&N[x].height,p&&p.height),B=function(){n.attr({width:n.width,height:n.height})},e(["width","height"],function(a){n[a+"Setter"]=function(a,h){var d={},y=this["img"+h],b="width"===h?"translateX":"translateY";this[h]=a,z(y)&&(this.element&&this.element.setAttribute(h,y),this.alignByTranslate||(d[b]=((this[h]||0)-y)/2,this.attr(d)))}}),z(h)&&n.attr({x:h,y:d}),n.isImg=!0,z(n.imgwidth)&&z(n.imgheight)?B():(n.attr({width:0,height:0}),u("img",{onload:function(){var a=q[l.chartIndex];0===this.width&&(t(this,{position:"absolute",top:"-999em"}),f.body.appendChild(this)),N[x]={width:this.width,height:this.height},n.imgwidth=this.width,n.imgheight=this.height,n.element&&B(),this.parentNode&&this.parentNode.removeChild(this),l.imgCount--,!l.imgCount&&a&&a.onload&&a.onload()},src:x}),this.imgCount++)),n},symbols:{circle:function(a,h,d,y){return this.arc(a+d/2,h+y/2,d/2,y/2,{start:0,end:2*Math.PI,open:!1})},square:function(a,h,d,y){return["M",a,h,"L",a+d,h,a+d,h+y,a,h+y,"Z"]},triangle:function(a,h,d,y){return["M",a+d/2,h,"L",a+d,h+y,a,h+y,"Z"]},"triangle-down":function(a,h,d,y){return["M",a,h,"L",a+d,h,a+d/2,h+y,"Z"]},diamond:function(a,h,d,y){return["M",a+d/2,h,"L",a+d,h+y/2,a+d/2,h+y,a,h+y/2,"Z"]},arc:function(a,h,d,y,b){var p=b.start,c=b.r||d,e=b.r||y||d,n=b.end-.001;d=b.innerR,y=D(b.open,.001>Math.abs(b.end-b.start-2*Math.PI));var l=Math.cos(p),A=Math.sin(p),r=Math.cos(n);n=Math.sin(n);return c=["M",a+c*l,h+e*A,"A",c,e,0,b=.001>b.end-p-Math.PI?0:1,1,a+c*r,h+e*n],z(d)&&c.push(y?"M":"L",a+d*r,h+d*n,"A",d,d,0,b,0,a+d*l,h+d*A),c.push(y?"":"Z"),c},callout:function(a,h,d,y,b){var n,p=Math.min(b&&b.r||0,d,y),c=p+6,e=b&&b.anchorX;return b=b&&b.anchorY,n=["M",a+p,h,"L",a+d-p,h,"C",a+d,h,a+d,h,a+d,h+p,"L",a+d,h+y-p,"C",a+d,h+y,a+d,h+y,a+d-p,h+y,"L",a+p,h+y,"C",a,h+y,a,h+y,a,h+y-p,"L",a,h+p,"C",a,h,a,h,a+p,h],e&&e>d?b>h+c&&b<h+y-c?n.splice(13,3,"L",a+d,b-6,a+d+6,b,a+d,b+6,a+d,h+y-p):n.splice(13,3,"L",a+d,y/2,e,b,a+d,y/2,a+d,h+y-p):e&&0>e?b>h+c&&b<h+y-c?n.splice(33,3,"L",a,b+6,a-6,b,a,b-6,a,h+p):n.splice(33,3,"L",a,y/2,e,b,a,y/2,a,h+p):b&&b>y&&e>a+c&&e<a+d-c?n.splice(23,3,"L",e+6,h+y,e,h+y+6,e-6,h+y,a+p,h+y):b&&0>b&&e>a+c&&e<a+d-c&&n.splice(3,3,"L",e-6,h,e,h-6,e+6,h,d-p,h),n}},clipRect:function(h,d,y,b){var p=a.uniqueKey(),c=this.createElement("clipPath").attr({id:p}).add(this.defs);return(h=this.rect(h,d,y,b,0).add(c)).id=p,h.clipPath=c,h.count=0,h},text:function(a,h,d,y){var b={};return!y||!this.allowHTML&&this.forExport?(b.x=Math.round(h||0),d&&(b.y=Math.round(d)),(a||0===a)&&(b.text=a),a=this.createElement("text").attr(b),y||(a.xSetter=function(a,h,d){var b,c,y=d.getElementsByTagName("tspan"),p=d.getAttribute(h);for(c=0;c<y.length;c++)(b=y[c]).getAttribute(h)===p&&b.setAttribute(h,a);d.setAttribute(h,a)}),a):this.html(a,h,d)},fontMetrics:function(a,d){return a=a||d&&d.style&&d.style.fontSize||this.style&&this.style.fontSize,{h:d=24>(a=/px/.test(a)?h(a):/em/.test(a)?parseFloat(a)*(d?this.fontMetrics(null,d.parentNode).f:16):12)?a+3:Math.round(1.2*a),b:Math.round(.8*d),f:a}},rotCorr:function(a,h,d){var y=a;return h&&d&&(y=Math.max(y*Math.cos(h*m),4)),{x:-a/3*Math.sin(h*m),y:y}},label:function(h,d,b,p,n,l,r,f,M){var x,B,F,t,I,u,K,R,k,w,S,v,W,C=this,D=C.g("button"!==M&&"label"),g=D.text=C.text("",0,0,r).attr({zIndex:1}),m=0,N=3,P=0,O={},q=/^url\((.*?)\)$/.test(p),J=q;M&&D.addClass("highcharts-"+M),J=q,w=function(){return(R||0)%2/2},S=function(){var a=g.element.style,h={};B=(void 0===F||void 0===t||K)&&z(g.textStr)&&g.getBBox(),D.width=(F||B.width||0)+2*N+P,D.height=(t||B.height||0)+2*N,k=N+C.fontMetrics(a&&a.fontSize,g).b,J&&(x||(D.box=x=C.symbols[p]||q?C.symbol(p):C.rect(),x.addClass(("button"===M?"":"highcharts-label-box")+(M?" highcharts-"+M+"-box":"")),x.add(D),a=w(),h.x=a,h.y=(f?-k:0)+a),h.width=Math.round(D.width),h.height=Math.round(D.height),x.attr(c(h,O)),O={})},v=function(){var h,a=P+N;h=f?0:k,z(F)&&B&&("center"===K||"right"===K)&&(a+={center:.5,right:1}[K]*(F-B.width)),a===g.x&&h===g.y||(g.attr("x",a),void 0!==h&&g.attr("y",h)),g.x=a,g.y=h},W=function(a,h){x?x.attr(a,h):O[a]=h},D.onAdd=function(){g.add(D),D.attr({text:h||0===h?h:"",x:d,y:b}),x&&z(n)&&D.attr({anchorX:n,anchorY:l})},D.widthSetter=function(h){F=a.isNumber(h)?h:null},D.heightSetter=function(a){t=a},D["text-alignSetter"]=function(a){K=a},D.paddingSetter=function(a){z(a)&&a!==N&&(N=D.padding=a,v())},D.paddingLeftSetter=function(a){z(a)&&a!==P&&(P=a,v())},D.alignSetter=function(a){(a={left:0,center:.5,right:1}[a])!==m&&(m=a,B&&D.attr({x:I}))},D.textSetter=function(a){void 0!==a&&g.textSetter(a),S(),v()},D["stroke-widthSetter"]=function(a,h){a&&(J=!0),R=this["stroke-width"]=a,W(h,a)},D.strokeSetter=D.fillSetter=D.rSetter=function(a,h){"r"!==h&&("fill"===h&&a&&(J=!0),D[h]=a),W(h,a)},D.anchorXSetter=function(a,h){n=D.anchorX=a,W(h,Math.round(a)-w()-I)},D.anchorYSetter=function(a,h){l=D.anchorY=a,W(h,a-u)},D.xSetter=function(a){D.x=a,m&&(a-=m*((F||B.width)+2*N)),I=Math.round(a),D.attr("translateX",I)},D.ySetter=function(a){u=D.y=Math.round(a),D.attr("translateY",u)};var aa=D.css;return c(D,{css:function(a){if(a){var h={};a=A(a),e(D.textProps,function(d){void 0!==a[d]&&(h[d]=a[d],delete a[d])}),g.css(h)}return aa.call(D,a)},getBBox:function(){return{width:B.width+2*N,height:B.height+2*N,x:B.x-N,y:B.y-N}},shadow:function(a){return a&&(S(),x&&x.shadow(a)),D},destroy:function(){y(D.element,"mouseenter"),y(D.element,"mouseleave"),g&&(g=g.destroy()),x&&(x=x.destroy()),G.prototype.destroy.call(D),D=C=S=v=W=null}})}}),a.Renderer=E}(L),function(a){var G=a.attr,E=a.createElement,H=a.css,v=a.defined,k=a.each,q=a.extend,w=a.isFirefox,t=a.isMS,u=a.isWebKit,z=a.pick,m=a.pInt,g=a.SVGRenderer,f=a.win,e=a.wrap;q(a.SVGElement.prototype,{htmlCss:function(a){var b=this.element;return(b=a&&"SPAN"===b.tagName&&a.width)&&(delete a.width,this.textWidth=b,this.updateTransform()),a&&"ellipsis"===a.textOverflow&&(a.whiteSpace="nowrap",a.overflow="hidden"),this.styles=q(this.styles,a),H(this.element,a),this},htmlGetBBox:function(){var a=this.element;return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,e=this.translateX||0,l=this.translateY||0,f=this.x||0,g=this.y||0,x=this.textAlign||"left",F={left:0,center:.5,right:1}[x],n=this.styles;if(H(b,{marginLeft:e,marginTop:l}),this.shadows&&k(this.shadows,function(a){H(a,{marginLeft:e+1,marginTop:l+1})}),this.inverted&&k(b.childNodes,function(d){a.invertChild(d,b)}),"SPAN"===b.tagName){var B=this.rotation,t=m(this.textWidth),A=n&&n.whiteSpace,d=[B,x,b.innerHTML,this.textWidth,this.textAlign].join();d!==this.cTT&&(n=a.fontMetrics(b.style.fontSize).b,v(B)&&this.setSpanRotation(B,F,n),H(b,{width:"",whiteSpace:A||"nowrap"}),b.offsetWidth>t&&/[ \-]/.test(b.textContent||b.innerText)&&H(b,{width:t+"px",display:"block",whiteSpace:A||"normal"}),this.getSpanCorrection(b.offsetWidth,n,F,B,x)),H(b,{left:f+(this.xCorr||0)+"px",top:g+(this.yCorr||0)+"px"}),u&&(n=b.offsetHeight),this.cTT=d}}else this.alignOnAdd=!0},setSpanRotation:function(a,b,e){var c={},r=this.renderer.getTransformKey();c[r]=c.transform="rotate("+a+"deg)",c[r+(w?"Origin":"-origin")]=c.transformOrigin=100*b+"% "+e+"px",H(this.element,c)},getSpanCorrection:function(a,b,e){this.xCorr=-a*e,this.yCorr=-b}}),q(g.prototype,{getTransformKey:function(){return t&&!/Edge/.test(f.navigator.userAgent)?"-ms-transform":u?"-webkit-transform":w?"MozTransform":f.opera?"-o-transform":""},html:function(a,b,r){var c=this.createElement("span"),f=c.element,g=c.renderer,x=g.isSVG,m=function(a,b){k(["opacity","visibility"],function(c){e(a,c+"Setter",function(a,d,c,e){a.call(this,d,c,e),b[c]=d})})};return c.textSetter=function(a){a!==f.innerHTML&&delete this.bBox,this.textStr=a,f.innerHTML=z(a,""),c.htmlUpdateTransform()},x&&m(c,c.element.style),c.xSetter=c.ySetter=c.alignSetter=c.rotationSetter=function(a,b){"align"===b&&(b="textAlign"),c[b]=a,c.htmlUpdateTransform()},c.attr({text:a,x:Math.round(b),y:Math.round(r)}).css({fontFamily:this.style.fontFamily,fontSize:this.style.fontSize,position:"absolute"}),f.style.whiteSpace="nowrap",c.css=c.htmlCss,x&&(c.add=function(a){var b,e=g.box.parentNode,n=[];if(this.parentGroup=a){if(!(b=a.div)){for(;a;)n.push(a),a=a.parentGroup;k(n.reverse(),function(a){function d(h,d){a[d]=h,t?l[g.getTransformKey()]="translate("+(a.x||a.translateX)+"px,"+(a.y||a.translateY)+"px)":"translateX"===d?l.left=h+"px":l.top=h+"px",a.doTransform=!0}var l,h=G(a.element,"class");h&&(h={className:h}),b=a.div=a.div||E("div",h,{position:"absolute",left:(a.translateX||0)+"px",top:(a.translateY||0)+"px",display:a.display,opacity:a.opacity,pointerEvents:a.styles&&a.styles.pointerEvents},b||e),l=b.style,q(a,{classSetter:function(a){return function(h){this.element.setAttribute("class",h),a.className=h}}(b),on:function(){return n[0].div&&c.on.apply({element:n[0].div},arguments),a},translateXSetter:d,translateYSetter:d}),m(a,l)})}}else b=e;return b.appendChild(f),c.added=!0,c.alignOnAdd&&c.htmlUpdateTransform(),c}),c}})}(L),function(a){function E(){var u,t=a.defaultOptions.global,k=t.useUTC,m=k?"getUTC":"get",g=k?"setUTC":"set",f="Minutes Hours Day Date Month FullYear".split(" "),e=f.concat(["Milliseconds","Seconds"]);for(a.Date=u=t.Date||w.Date,u.hcTimezoneOffset=k&&t.timezoneOffset,u.hcGetTimezoneOffset=function(){var t=a.defaultOptions.global,u=w.moment;if(t.timezone){if(u)return function(a){return-u.tz(a,t.timezone).utcOffset()};a.error(25)}return t.useUTC&&t.getTimezoneOffset}(),u.hcHasTimeZone=!(!u.hcTimezoneOffset&&!u.hcGetTimezoneOffset),u.hcMakeTime=function(a,b,e,l,f,g){var c;return k?(c=u.UTC.apply(0,arguments),c+=v(c)):c=new u(a,b,q(e,1),q(l,0),q(f,0),q(g,0)).getTime(),c},t=0;t<f.length;t++)u["hcGet"+f[t]]=m+f[t];for(t=0;t<e.length;t++)u["hcSet"+e[t]]=g+e[t]}var H=a.color,v=a.getTZOffset,k=a.merge,q=a.pick,w=a.win;a.defaultOptions={colors:"#7cb5ec #434348 #90ed7d #f7a35c #8085e9 #f15c80 #e4d354 #2b908f #f45b5b #91e8e1".split(" "),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January February March April May June July August September October November December".split(" "),shortMonths:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),decimalPoint:".",numericSymbols:"kMGTPE".split(""),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:" "},global:{useUTC:!0},chart:{borderRadius:0,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacing:[10,10,15,10],resetZoomButton:{theme:{zIndex:6},position:{align:"right",x:-10,y:10}},width:null,height:null,borderColor:"#335cad",backgroundColor:"#ffffff",plotBorderColor:"#cccccc"},title:{text:"Chart title",align:"center",margin:15,widthAdjust:-44},subtitle:{text:"",align:"center",widthAdjust:-44},plotOptions:{},labels:{style:{position:"absolute",color:"#333333"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderColor:"#999999",borderRadius:0,navigation:{activeColor:"#003399",inactiveColor:"#cccccc"},itemStyle:{color:"#333333",fontSize:"12px",fontWeight:"bold",textOverflow:"ellipsis"},itemHoverStyle:{color:"#000000"},itemHiddenStyle:{color:"#cccccc"},shadow:!1,itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},squareSymbol:!0,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"45%"},style:{position:"absolute",backgroundColor:"#ffffff",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:a.svg,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},footerFormat:"",padding:8,snap:a.isTouchDevice?25:10,backgroundColor:H("#f7f7f7").setOpacity(.85).get(),borderWidth:1,headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{point.color}">●</span> {series.name}: <b>{point.y}</b><br/>',shadow:!0,style:{color:"#333333",cursor:"default",fontSize:"12px",pointerEvents:"none",whiteSpace:"nowrap"}},credits:{enabled:!0,href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#999999",fontSize:"9px"},text:"Highcharts.com"}},a.setOptions=function(t){return a.defaultOptions=k(!0,a.defaultOptions,t),E(),a.defaultOptions},a.getOptions=function(){return a.defaultOptions},a.defaultPlotOptions=a.defaultOptions.plotOptions,E()}(L),function(a){var G=a.correctFloat,E=a.defined,H=a.destroyObjectProperties,v=a.isNumber,k=a.merge,q=a.pick,w=a.deg2rad;a.Tick=function(a,u,k,m){this.axis=a,this.pos=u,this.type=k||"",this.isNewLabel=this.isNew=!0,k||m||this.addLabel()},a.Tick.prototype={addLabel:function(){var l,a=this.axis,u=a.options,z=a.chart,m=a.categories,g=a.names,f=this.pos,e=u.labels,b=f===(c=a.tickPositions)[0],r=f===c[c.length-1],c=(g=m?q(m[f],g[f],f):f,m=this.label,c.info);a.isDatetimeAxis&&c&&(l=u.dateTimeLabelFormats[c.higherRanks[f]||c.unitName]),this.isFirst=b,this.isLast=r,u=a.labelFormatter.call({axis:a,chart:z,isFirst:b,isLast:r,dateTimeLabelFormat:l,value:a.isLog?G(a.lin2log(g)):g,pos:f}),E(m)?m&&m.attr({text:u}):(this.labelLength=(this.label=m=E(u)&&e.enabled?z.renderer.text(u,0,0,e.useHTML).css(k(e.style)).add(a.labelGroup):null)&&m.getBBox().width,this.rotation=0)},getLabelSize:function(){return this.label?this.label.getBBox()[this.axis.horiz?"height":"width"]:0},handleOverflow:function(a){var F,t=this.axis,k=t.options.labels,m=a.x,g=t.chart.chartWidth,f=t.chart.spacing,e=q(t.labelLeft,Math.min(t.pos,f[3])),c=(f=q(t.labelRight,Math.max(t.isRadial?0:t.pos+t.len,g-f[1])),this.label),b=this.rotation,r={left:0,center:.5,right:1}[t.labelAlign||c.attr("align")],l=c.getBBox().width,C=t.getSlotWidth(),I=C,x=1,n={};b||!1===k.overflow?0>b&&m-r*l<e?F=Math.round(m/Math.cos(b*w)-e):0<b&&m+r*l>f&&(F=Math.round((g-m)/Math.cos(b*w))):(g=m+(1-r)*l,m-r*l<e?I=a.x+I*(1-r)-e:g>f&&(I=f-a.x+I*r,x=-1),(I=Math.min(C,I))<C&&"center"===t.labelAlign&&(a.x+=x*(C-I-r*(C-Math.min(l,I)))),(l>I||t.autoRotation&&(c.styles||{}).width)&&(F=I)),F&&(n.width=F,(k.style||{}).textOverflow||(n.textOverflow="ellipsis"),c.css(n))},getPosition:function(a,k,q,m){var g=this.axis,f=g.chart,e=m&&f.oldChartHeight||f.chartHeight;return{x:a?g.translate(k+q,null,null,m)+g.transB:g.left+g.offset+(g.opposite?(m&&f.oldChartWidth||f.chartWidth)-g.right-g.left:0),y:a?e-g.bottom+g.offset-(g.opposite?g.height:0):e-g.translate(k+q,null,null,m)-g.transB}},getLabelPosition:function(a,k,q,m,g,f,e,c){var b=this.axis,r=b.transA,l=b.reversed,C=b.staggerLines,t=b.tickRotCorr||{x:0,y:0},x=g.y,F=m||b.reserveSpaceDefault?0:-b.labelOffset*("center"===b.labelAlign?.5:1);return E(x)||(x=0===b.side?q.rotation?-8:-q.getBBox().height:2===b.side?t.y+8:Math.cos(q.rotation*w)*(t.y-q.getBBox(!1,0).height/2)),a=a+g.x+F+t.x-(f&&m?f*r*(l?-1:1):0),k=k+x-(f&&!m?f*r*(l?1:-1):0),C&&(q=e/(c||1)%C,b.opposite&&(q=C-q-1),k+=b.labelOffset/C*q),{x:a,y:Math.round(k)}},getMarkPath:function(a,k,q,m,g,f){return f.crispLine(["M",a,k,"L",a+(g?0:-q),k+(g?q:0)],m)},renderGridLine:function(a,k,q){var m=this.axis,g=m.options,f=this.gridLine,e={},c=this.pos,b=this.type,r=m.tickmarkOffset,l=m.chart.renderer,C=b?b+"Grid":"grid",t=g[C+"LineWidth"],x=g[C+"LineColor"];g=g[C+"LineDashStyle"];f||(e.stroke=x,e["stroke-width"]=t,g&&(e.dashstyle=g),b||(e.zIndex=1),a&&(e.opacity=0),this.gridLine=f=l.path().attr(e).addClass("highcharts-"+(b?b+"-":"")+"grid-line").add(m.gridGroup)),!a&&f&&(a=m.getPlotLinePath(c+r,f.strokeWidth()*q,a,!0))&&f[this.isNew?"attr":"animate"]({d:a,opacity:k})},renderMark:function(a,k,z){var m=this.axis,g=m.options,f=m.chart.renderer,e=this.type,c=e?e+"Tick":"tick",b=m.tickSize(c),r=this.mark,l=!r,C=a.x;a=a.y;var t=q(g[c+"Width"],!e&&m.isXAxis?1:0);g=g[c+"Color"];b&&(m.opposite&&(b[0]=-b[0]),l&&(this.mark=r=f.path().addClass("highcharts-"+(e?e+"-":"")+"tick").add(m.axisGroup),r.attr({stroke:g,"stroke-width":t})),r[l?"attr":"animate"]({d:this.getMarkPath(C,a,b[0],r.strokeWidth()*z,m.horiz,f),opacity:k}))},renderLabel:function(a,k,z,m){var f=(g=this.axis).horiz,e=g.options,c=this.label,b=e.labels,r=b.step,g=g.tickmarkOffset,l=!0,C=a.x;a=a.y,c&&v(C)&&(c.xy=a=this.getLabelPosition(C,a,c,f,b,g,m,r),this.isFirst&&!this.isLast&&!q(e.showFirstLabel,1)||this.isLast&&!this.isFirst&&!q(e.showLastLabel,1)?l=!1:!f||b.step||b.rotation||k||0===z||this.handleOverflow(a),r&&m%r&&(l=!1),l&&v(a.y)?(a.opacity=z,c[this.isNewLabel?"attr":"animate"](a),this.isNewLabel=!1):(c.attr("y",-9999),this.isNewLabel=!0))},render:function(a,k,z){var g=(m=this.axis).horiz,f=this.getPosition(g,this.pos,m.tickmarkOffset,k),e=f.x,c=f.y,m=g&&e===m.pos+m.len||!g&&c===m.pos?-1:1;z=q(z,1),this.isActive=!0,this.renderGridLine(k,z,m),this.renderMark(f,z,m),this.renderLabel(f,k,z,a),this.isNew=!1},destroy:function(){H(this,this.axis)}}}(L);var Z=function(a){var G=a.addEvent,E=a.animObject,H=a.arrayMax,v=a.arrayMin,k=a.color,q=a.correctFloat,w=a.defaultOptions,t=a.defined,u=a.deg2rad,z=a.destroyObjectProperties,m=a.each,g=a.extend,f=a.fireEvent,e=a.format,c=a.getMagnitude,b=a.grep,r=a.inArray,l=a.isArray,C=a.isNumber,I=a.isString,x=a.merge,F=a.normalizeTickInterval,n=a.objectEach,B=a.pick,J=a.removeEvent,A=a.splat,d=a.syncTimeout,p=a.Tick,D=function(){this.init.apply(this,arguments)};return a.extend(D.prototype,{defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,labels:{enabled:!0,style:{color:"#666666",cursor:"default",fontSize:"11px"},x:0},maxPadding:.01,minorTickLength:2,minorTickPosition:"outside",minPadding:.01,startOfWeek:1,startOnTick:!1,tickLength:10,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",title:{align:"middle",style:{color:"#666666"}},type:"linear",minorGridLineColor:"#f2f2f2",minorGridLineWidth:1,minorTickColor:"#999999",lineColor:"#ccd6eb",lineWidth:1,gridLineColor:"#e6e6e6",tickColor:"#ccd6eb"},defaultYAxisOptions:{endOnTick:!0,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8},maxPadding:.05,minPadding:.05,startOnTick:!0,title:{rotation:270,text:"Values"},stackLabels:{allowOverlap:!1,enabled:!1,formatter:function(){return a.numberFormat(this.total,-1)},style:{fontSize:"11px",fontWeight:"bold",color:"#000000",textOutline:"1px contrast"}},gridLineWidth:1,lineWidth:0},defaultLeftAxisOptions:{labels:{x:-15},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:15},title:{rotation:90}},defaultBottomAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},defaultTopAxisOptions:{labels:{autoRotation:[-45],x:0},title:{rotation:0}},init:function(a,d){var h=d.isX,y=this;y.chart=a,y.horiz=a.inverted&&!y.isZAxis?!h:h,y.isXAxis=h,y.coll=y.coll||(h?"xAxis":"yAxis"),y.opposite=d.opposite,y.side=d.side||(y.horiz?y.opposite?0:2:y.opposite?1:3),y.setOptions(d);var b=this.options,c=b.type;y.labelFormatter=b.labels.formatter||y.defaultLabelFormatter,y.userOptions=d,y.minPixelPadding=0,y.reversed=b.reversed,y.visible=!1!==b.visible,y.zoomEnabled=!1!==b.zoomEnabled,y.hasNames="category"===c||!0===b.categories,y.categories=b.categories||y.hasNames,y.names=y.names||[],y.plotLinesAndBandsGroups={},y.isLog="logarithmic"===c,y.isDatetimeAxis="datetime"===c,y.positiveValuesOnly=y.isLog&&!y.allowNegativeLog,y.isLinked=t(b.linkedTo),y.ticks={},y.labelEdge=[],y.minorTicks={},y.plotLinesAndBands=[],y.alternateBands={},y.len=0,y.minRange=y.userMinRange=b.minRange||b.maxZoom,y.range=b.range,y.offset=b.offset||0,y.stacks={},y.oldStacks={},y.stacksTouched=0,y.max=null,y.min=null,y.crosshair=B(b.crosshair,A(a.options.tooltip.crosshairs)[h?0:1],!1),d=y.options.events,-1===r(y,a.axes)&&(h?a.axes.splice(a.xAxis.length,0,y):a.axes.push(y),a[y.coll].push(y)),y.series=y.series||[],a.inverted&&!y.isZAxis&&h&&void 0===y.reversed&&(y.reversed=!0),n(d,function(a,h){G(y,h,a)}),y.lin2log=b.linearToLogConverter||y.lin2log,y.isLog&&(y.val2lin=y.log2lin,y.lin2val=y.lin2log)},setOptions:function(a){this.options=x(this.defaultOptions,"yAxis"===this.coll&&this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],x(w[this.coll],a))},defaultLabelFormatter:function(){var A,h=this.axis,d=this.value,b=h.categories,c=this.dateTimeLabelFormat,n=(p=w.lang).numericSymbols,p=p.numericSymbolMagnitude||1e3,l=n&&n.length,r=h.options.labels.format;h=h.isLog?Math.abs(d):h.tickInterval;if(r)A=e(r,this);else if(b)A=d;else if(c)A=a.dateFormat(c,d);else if(l&&1e3<=h)for(;l--&&void 0===A;)h>=(b=Math.pow(p,l+1))&&0==10*d%b&&null!==n[l]&&0!==d&&(A=a.numberFormat(d/b,-1)+n[l]);return void 0===A&&(A=1e4<=Math.abs(d)?a.numberFormat(d,-1):a.numberFormat(d,-1,void 0,"")),A},getSeriesExtremes:function(){var a=this,d=a.chart;a.hasVisibleSeries=!1,a.dataMin=a.dataMax=a.threshold=null,a.softThreshold=!a.isXAxis,a.buildStacks&&a.buildStacks(),m(a.series,function(h){if(h.visible||!d.options.chart.ignoreHiddenSeries){var p,y=h.options,c=y.threshold;a.hasVisibleSeries=!0,a.positiveValuesOnly&&0>=c&&(c=null),a.isXAxis?(y=h.xData).length&&(h=v(y),p=H(y),C(h)||h instanceof Date||(y=b(y,C),h=v(y)),a.dataMin=Math.min(B(a.dataMin,y[0],h),h),a.dataMax=Math.max(B(a.dataMax,y[0],p),p)):(h.getExtremes(),p=h.dataMax,h=h.dataMin,t(h)&&t(p)&&(a.dataMin=Math.min(B(a.dataMin,h),h),a.dataMax=Math.max(B(a.dataMax,p),p)),t(c)&&(a.threshold=c),(!y.softThreshold||a.positiveValuesOnly)&&(a.softThreshold=!1))}})},translate:function(a,d,b,c,p,e){var h=this.linkedParent||this,y=1,n=0,l=c?h.oldTransA:h.transA;c=c?h.oldMin:h.min;var A=h.minPixelPadding;return p=(h.isOrdinal||h.isBroken||h.isLog&&p)&&h.lin2val,l||(l=h.transA),b&&(y*=-1,n=h.len),h.reversed&&(n-=(y*=-1)*(h.sector||h.len)),d?(a=(a*y+n-A)/l+c,p&&(a=h.lin2val(a))):(p&&(a=h.val2lin(a)),a=C(c)?y*(a-c)*l+n+y*A+(C(e)?l*e:0):void 0),a},toPixels:function(a,d){return this.translate(a,!1,!this.horiz,null,!0)+(d?0:this.pos)},toValue:function(a,d){return this.translate(a-(d?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,d,b,c,p){var n,l,f,h=this.chart,y=this.left,e=this.top,A=b&&h.oldChartHeight||h.chartHeight,r=b&&h.oldChartWidth||h.chartWidth;n=this.transB;var D=function(a,h,d){return(a<h||a>d)&&(c?a=Math.min(Math.max(h,a),d):f=!0),a};return p=B(p,this.translate(a,null,null,b)),a=b=Math.round(p+n),n=l=Math.round(A-p-n),C(p)?this.horiz?(n=e,l=A-this.bottom,a=b=D(a,y,y+this.width)):(a=y,b=r-this.right,n=l=D(n,e,e+this.height)):(f=!0,c=!1),f&&!c?null:h.renderer.crispLine(["M",a,n,"L",b,l],d||1)},getLinearTickPositions:function(a,d,b){var h,y=q(Math.floor(d/a)*a);b=q(Math.ceil(b/a)*a);var p,c=[];if(q(y+a)===y&&(p=20),this.single)return[d];for(d=y;d<=b&&(c.push(d),(d=q(d+a,p))!==h);)h=d;return c},getMinorTickInterval:function(){var a=this.options;return!0===a.minorTicks?B(a.minorTickInterval,"auto"):!1===a.minorTicks?null:a.minorTickInterval},getMinorTickPositions:function(){var a=this,d=a.options,b=a.tickPositions,c=a.minorTickInterval,p=[],e=a.pointRangePadding||0,n=a.min-e,l=(e=a.max+e)-n;if(l&&l/c<a.len/3)if(a.isLog)m(this.paddedTicks,function(h,d,y){d&&p.push.apply(p,a.getLogTickPositions(c,y[d-1],y[d],!0))});else if(a.isDatetimeAxis&&"auto"===this.getMinorTickInterval())p=p.concat(a.getTimeTicks(a.normalizeTimeTickInterval(c),n,e,d.startOfWeek));else for(d=n+(b[0]-n)%c;d<=e&&d!==p[0];d+=c)p.push(d);return 0!==p.length&&a.trimTicks(p),p},adjustForMinRange:function(){var c,p,e,n,l,A,f,a=this.options,d=this.min,b=this.max;this.isXAxis&&void 0===this.minRange&&!this.isLog&&(t(a.min)||t(a.max)?this.minRange=null:(m(this.series,function(a){for(A=a.xData,n=a.xIncrement?1:A.length-1;0<n;n--)l=A[n]-A[n-1],(void 0===e||l<e)&&(e=l)}),this.minRange=Math.min(5*e,this.dataMax-this.dataMin))),b-d<this.minRange&&(p=this.dataMax-this.dataMin>=this.minRange,c=[d-(c=((f=this.minRange)-b+d)/2),B(a.min,d-c)],p&&(c[2]=this.isLog?this.log2lin(this.dataMin):this.dataMin),b=[(d=H(c))+f,B(a.max,d+f)],p&&(b[2]=this.isLog?this.log2lin(this.dataMax):this.dataMax),(b=v(b))-d<f&&(c[0]=b-f,c[1]=B(a.min,b-f),d=H(c))),this.min=d,this.max=b},getClosest:function(){var a;return this.categories?a=1:m(this.series,function(h){var d=h.closestPointRange,y=h.visible||!h.chart.options.chart.ignoreHiddenSeries;!h.noSharedTooltip&&t(d)&&y&&(a=t(a)?Math.min(a,d):d)}),a},nameToX:function(a){var c,h=l(this.categories),d=h?this.categories:this.names,b=a.options.x;return a.series.requireSorting=!1,t(b)||(b=!1===this.options.uniqueNames?a.series.autoIncrement():r(a.name,d)),-1===b?h||(c=d.length):c=b,void 0!==c&&(this.names[c]=a.name),c},updateNames:function(){var a=this;0<this.names.length&&(this.names.length=0,this.minRange=this.userMinRange,m(this.series||[],function(h){h.xIncrement=null,h.points&&!h.isDirtyData||(h.processData(),h.generatePoints()),m(h.points,function(d,b){var y;d.options&&(void 0!==(y=a.nameToX(d))&&y!==d.x&&(d.x=y,h.xData[b]=y))})}))},setAxisTranslation:function(a){var c,h=this,d=h.max-h.min,b=h.axisPointRange||0,p=0,e=0,n=h.linkedParent,l=!!h.categories,A=h.transA,r=h.isXAxis;(r||l||b)&&(c=h.getClosest(),n?(p=n.minPointOffset,e=n.pointRangePadding):m(h.series,function(a){var d=l?1:r?B(a.options.pointRange,c,0):h.axisPointRange||0;a=a.options.pointPlacement,b=Math.max(b,d),h.single||(p=Math.max(p,I(a)?0:d/2),e=Math.max(e,"on"===a?0:d))}),n=h.ordinalSlope&&c?h.ordinalSlope/c:1,h.minPointOffset=p*=n,h.pointRangePadding=e*=n,h.pointRange=Math.min(b,d),r&&(h.closestPointRange=c)),a&&(h.oldTransA=A),h.translationSlope=h.transA=A=h.options.staticScale||h.len/(d+e||1),h.transB=h.horiz?h.left:h.bottom,h.minPixelPadding=A*p},minFromRange:function(){return this.max-this.range},setTickInterval:function(h){var z,w,v,E,d=this,b=d.chart,p=d.options,e=d.isLog,n=d.log2lin,l=d.isDatetimeAxis,A=d.isXAxis,r=d.isLinked,D=p.maxPadding,g=p.minPadding,x=p.tickInterval,k=p.tickPixelInterval,I=d.categories,J=d.threshold,u=d.softThreshold;l||I||r||this.getTickAmount(),v=B(d.userMin,p.min),E=B(d.userMax,p.max),r?(d.linkedParent=b[d.coll][p.linkedTo],b=d.linkedParent.getExtremes(),d.min=B(b.min,b.dataMin),d.max=B(b.max,b.dataMax),p.type!==d.linkedParent.options.type&&a.error(11,1)):(!u&&t(J)&&(d.dataMin>=J?(z=J,g=0):d.dataMax<=J&&(w=J,D=0)),d.min=B(v,z,d.dataMin),d.max=B(E,w,d.dataMax)),e&&(d.positiveValuesOnly&&!h&&0>=Math.min(d.min,B(d.dataMin,d.min))&&a.error(10,1),d.min=q(n(d.min),15),d.max=q(n(d.max),15)),d.range&&t(d.max)&&(d.userMin=d.min=v=Math.max(d.dataMin,d.minFromRange()),d.userMax=E=d.max,d.range=null),f(d,"foundExtremes"),d.beforePadding&&d.beforePadding(),d.adjustForMinRange(),!(I||d.axisPointRange||d.usePercentage||r)&&t(d.min)&&t(d.max)&&(n=d.max-d.min)&&(!t(v)&&g&&(d.min-=n*g),!t(E)&&D&&(d.max+=n*D)),C(p.softMin)&&!C(d.userMin)&&(d.min=Math.min(d.min,p.softMin)),C(p.softMax)&&!C(d.userMax)&&(d.max=Math.max(d.max,p.softMax)),C(p.floor)&&(d.min=Math.max(d.min,p.floor)),C(p.ceiling)&&(d.max=Math.min(d.max,p.ceiling)),u&&t(d.dataMin)&&(J=J||0,!t(v)&&d.min<J&&d.dataMin>=J?d.min=J:!t(E)&&d.max>J&&d.dataMax<=J&&(d.max=J)),d.tickInterval=d.min===d.max||void 0===d.min||void 0===d.max?1:r&&!x&&k===d.linkedParent.options.tickPixelInterval?x=d.linkedParent.tickInterval:B(x,this.tickAmount?(d.max-d.min)/Math.max(this.tickAmount-1,1):void 0,I?1:(d.max-d.min)*k/Math.max(d.len,k)),A&&!h&&m(d.series,function(a){a.processData(d.min!==d.oldMin||d.max!==d.oldMax)}),d.setAxisTranslation(!0),d.beforeSetTickPositions&&d.beforeSetTickPositions(),d.postProcessTickInterval&&(d.tickInterval=d.postProcessTickInterval(d.tickInterval)),d.pointRange&&!x&&(d.tickInterval=Math.max(d.pointRange,d.tickInterval)),h=B(p.minTickInterval,d.isDatetimeAxis&&d.closestPointRange),!x&&d.tickInterval<h&&(d.tickInterval=h),l||e||x||(d.tickInterval=F(d.tickInterval,null,c(d.tickInterval),B(p.allowDecimals,!(.5<d.tickInterval&&5>d.tickInterval&&1e3<d.max&&9999>d.max)),!!this.tickAmount)),this.tickAmount||(d.tickInterval=d.unsquish()),this.setTickPositions()},setTickPositions:function(){var d,a=this.options,b=a.tickPositions;d=this.getMinorTickInterval();var c=a.tickPositioner,p=a.startOnTick,e=a.endOnTick;this.tickmarkOffset=this.categories&&"between"===a.tickmarkPlacement&&1===this.tickInterval?.5:0,this.minorTickInterval="auto"===d&&this.tickInterval?this.tickInterval/5:d,this.single=this.min===this.max&&t(this.min)&&!this.tickAmount&&(parseInt(this.min,10)===this.min||!1!==a.allowDecimals),this.tickPositions=d=b&&b.slice(),!d&&((d=this.isDatetimeAxis?this.getTimeTicks(this.normalizeTimeTickInterval(this.tickInterval,a.units),this.min,this.max,a.startOfWeek,this.ordinalPositions,this.closestPointRange,!0):this.isLog?this.getLogTickPositions(this.tickInterval,this.min,this.max):this.getLinearTickPositions(this.tickInterval,this.min,this.max)).length>this.len&&((d=[d[0],d.pop()])[0]===d[1]&&(d.length=1)),this.tickPositions=d,c&&(c=c.apply(this,[this.min,this.max])))&&(this.tickPositions=d=c),this.paddedTicks=d.slice(0),this.trimTicks(d,p,e),this.isLinked||(this.single&&2>d.length&&(this.min-=.5,this.max+=.5),b||c||this.adjustTickAmount())},trimTicks:function(a,d,b){var h=a[0],c=a[a.length-1],p=this.minPointOffset||0;if(!this.isLinked){if(d&&-1/0!==h)this.min=h;else for(;this.min-p>a[0];)a.shift();if(b)this.max=c;else for(;this.max+p<a[a.length-1];)a.pop();0===a.length&&t(h)&&!this.options.tickPositions&&a.push((c+h)/2)}},alignToOthers:function(){var d,a={},b=this.options;return!1===this.chart.options.chart.alignTicks||!1===b.alignTicks||this.isLog||m(this.chart[this.coll],function(h){var b=h.options;b=[h.horiz?b.left:b.top,b.width,b.height,b.pane].join();h.series.length&&(a[b]?d=!0:a[b]=1)}),d},getTickAmount:function(){var a=this.options,d=a.tickAmount,b=a.tickPixelInterval;!t(a.tickInterval)&&this.len<b&&!this.isRadial&&!this.isLog&&a.startOnTick&&a.endOnTick&&(d=2),!d&&this.alignToOthers()&&(d=Math.ceil(this.len/b)+1),4>d&&(this.finalTickAmt=d,d=5),this.tickAmount=d},adjustTickAmount:function(){var a=this.tickInterval,d=this.tickPositions,b=this.tickAmount,c=this.finalTickAmt,p=d&&d.length,e=B(this.threshold,this.softThreshold?0:null);if(this.hasData()){if(p<b){for(;d.length<b;)d.length%2||this.min===e?d.push(q(d[d.length-1]+a)):d.unshift(q(d[0]-a));this.transA*=(p-1)/(b-1),this.min=d[0],this.max=d[d.length-1]}else p>b&&(this.tickInterval*=2,this.setTickPositions());if(t(c)){for(a=b=d.length;a--;)(3===c&&1==a%2||2>=c&&0<a&&a<b-1)&&d.splice(a,1);this.finalTickAmt=void 0}}},setScale:function(){var a,d;this.oldMin=this.min,this.oldMax=this.max,this.oldAxisLength=this.len,this.setAxisSize(),d=this.len!==this.oldAxisLength,m(this.series,function(d){(d.isDirtyData||d.isDirty||d.xAxis.isDirty)&&(a=!0)}),d||a||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax||this.alignToOthers()?(this.resetStacks&&this.resetStacks(),this.forceRedraw=!1,this.getSeriesExtremes(),this.setTickInterval(),this.oldUserMin=this.userMin,this.oldUserMax=this.userMax,this.isDirty||(this.isDirty=d||this.min!==this.oldMin||this.max!==this.oldMax)):this.cleanStacks&&this.cleanStacks()},setExtremes:function(a,d,b,c,p){var h=this,e=h.chart;b=B(b,!0),m(h.series,function(a){delete a.kdTree}),p=g(p,{min:a,max:d}),f(h,"setExtremes",p,function(){h.userMin=a,h.userMax=d,h.eventArgs=p,b&&e.redraw(c)})},zoom:function(a,d){var h=this.dataMin,b=this.dataMax,c=this.options,p=Math.min(h,B(c.min,h));c=Math.max(b,B(c.max,b));return a===this.min&&d===this.max||(this.allowZoomOutside||(t(h)&&(a<p&&(a=p),a>c&&(a=c)),t(b)&&(d<p&&(d=p),d>c&&(d=c))),this.displayBtn=void 0!==a||void 0!==d,this.setExtremes(a,d,!1,void 0,{trigger:"zoom"})),!0},setAxisSize:function(){var d=this.chart,c=(b=this.options).offsets||[0,0,0,0],p=this.horiz,e=this.width=Math.round(a.relativeLength(B(b.width,d.plotWidth-c[3]+c[1]),d.plotWidth)),n=this.height=Math.round(a.relativeLength(B(b.height,d.plotHeight-c[0]+c[2]),d.plotHeight)),l=this.top=Math.round(a.relativeLength(B(b.top,d.plotTop+c[0]),d.plotHeight,d.plotTop)),b=this.left=Math.round(a.relativeLength(B(b.left,d.plotLeft+c[3]),d.plotWidth,d.plotLeft));this.bottom=d.chartHeight-n-l,this.right=d.chartWidth-e-b,this.len=Math.max(p?e:n,0),this.pos=p?b:l},getExtremes:function(){var a=this.isLog,d=this.lin2log;return{min:a?q(d(this.min)):this.min,max:a?q(d(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(a){var d=this.isLog,h=this.lin2log,b=d?h(this.min):this.min;d=d?h(this.max):this.max;return null===a?a=b:b>a?a=b:d<a&&(a=d),this.translate(a,0,1,0,1)},autoLabelAlign:function(a){return 15<(a=(B(a,0)-90*this.side+720)%360)&&165>a?"right":195<a&&345>a?"left":"center"},tickSize:function(a){var d=this.options,h=d[a+"Length"],b=B(d[a+"Width"],"tick"===a&&this.isXAxis?1:0);if(b&&h)return"inside"===d[a+"Position"]&&(h=-h),[h,b]},labelMetrics:function(){var a=this.tickPositions&&this.tickPositions[0]||0;return this.chart.renderer.fontMetrics(this.options.labels.style&&this.options.labels.style.fontSize,this.ticks[a]&&this.ticks[a].label)},unsquish:function(){var e,A,f,a=this.options.labels,d=this.horiz,b=this.tickInterval,c=b,p=this.len/(((this.categories?1:0)+this.max-this.min)/b),n=a.rotation,l=this.labelMetrics(),r=Number.MAX_VALUE,D=function(a){return(a=1<(a/=p||1)?Math.ceil(a):1)*b};return d?(f=!a.staggerLines&&!a.step&&(t(n)?[n]:p<B(a.autoRotationLimit,80)&&a.autoRotation))&&m(f,function(a){var d;(a===n||a&&-90<=a&&90>=a)&&((d=(A=D(Math.abs(l.h/Math.sin(u*a))))+Math.abs(a/360))<r&&(r=d,e=a,c=A))}):a.step||(c=D(l.h)),this.autoRotation=f,this.labelRotation=B(e,n),c},getSlotWidth:function(){var a=this.chart,d=this.horiz,b=this.options.labels,c=Math.max(this.tickPositions.length-(this.categories?0:1),1),p=a.margin[3];return d&&2>(b.step||0)&&!b.rotation&&(this.staggerLines||1)*this.len/c||!d&&(b.style&&parseInt(b.style.width,10)||p&&p-a.spacing[3]||.33*a.chartWidth)},renderUnsquish:function(){var D,C,B,a=this.chart,d=a.renderer,b=this.tickPositions,c=this.ticks,p=this.options.labels,e=this.horiz,n=this.getSlotWidth(),l=Math.max(1,Math.round(n-2*(p.padding||5))),A={},r=this.labelMetrics(),f=p.style&&p.style.textOverflow,g=0;if(I(p.rotation)||(A.rotation=p.rotation||0),m(b,function(a){(a=c[a])&&a.labelLength>g&&(g=a.labelLength)}),this.maxLabelLength=g,this.autoRotation)g>l&&g>r.h?A.rotation=this.labelRotation:this.labelRotation=0;else if(n&&(D={width:l+"px"},!f))for(D.textOverflow="clip",C=b.length;!e&&C--;)B=b[C],(l=c[B].label)&&(l.styles&&"ellipsis"===l.styles.textOverflow?l.css({textOverflow:"clip"}):c[B].labelLength>n&&l.css({width:n+"px"}),l.getBBox().height>this.len/b.length-(r.h-r.f)&&(l.specCss={textOverflow:"ellipsis"}));A.rotation&&(D={width:(g>.5*a.chartHeight?.33*a.chartHeight:a.chartHeight)+"px"},f||(D.textOverflow="ellipsis")),(this.labelAlign=p.align||this.autoLabelAlign(this.labelRotation))&&(A.align=this.labelAlign),m(b,function(a){var d=(a=c[a])&&a.label;d&&(d.attr(A),D&&d.css(x(D,d.specCss)),delete d.specCss,a.rotation=A.rotation)}),this.tickRotCorr=d.rotCorr(r.b,this.labelRotation||0,0!==this.side)},hasData:function(){return this.hasVisibleSeries||t(this.min)&&t(this.max)&&this.tickPositions&&0<this.tickPositions.length},addTitle:function(a){var p,d=this.chart.renderer,h=this.horiz,b=this.opposite,c=this.options.title;this.axisTitle||((p=c.textAlign)||(p=(h?{low:"left",middle:"center",high:"right"}:{low:b?"right":"left",middle:"center",high:b?"left":"right"})[c.align]),this.axisTitle=d.text(c.text,0,0,c.useHTML).attr({zIndex:7,rotation:c.rotation||0,align:p}).addClass("highcharts-axis-title").css(c.style).add(this.axisGroup),this.axisTitle.isNew=!0),c.style.width||this.isRadial||this.axisTitle.css({width:this.len}),this.axisTitle[a?"show":"hide"](!0)},generateTick:function(a){var d=this.ticks;d[a]?d[a].addLabel():d[a]=new p(this,a)},getOffset:function(){var f,D,x,a=this,b=(d=a.chart).renderer,c=a.options,p=a.tickPositions,e=a.ticks,l=a.horiz,A=a.side,r=d.inverted&&!a.isZAxis?[1,0,3,2][A]:A,g=0,C=0,F=c.title,k=c.labels,q=0,I=d.axisOffset,d=d.clipOffset,J=[-1,1,1,-1][A],u=c.className,z=a.axisParent,v=this.tickSize("tick");f=a.hasData(),a.showAxis=D=f||B(c.showEmpty,!0),a.staggerLines=a.horiz&&k.staggerLines,a.axisGroup||(a.gridGroup=b.g("grid").attr({zIndex:c.gridZIndex||1}).addClass("highcharts-"+this.coll.toLowerCase()+"-grid "+(u||"")).add(z),a.axisGroup=b.g("axis").attr({zIndex:c.zIndex||2}).addClass("highcharts-"+this.coll.toLowerCase()+" "+(u||"")).add(z),a.labelGroup=b.g("axis-labels").attr({zIndex:k.zIndex||7}).addClass("highcharts-"+a.coll.toLowerCase()+"-labels "+(u||"")).add(z)),f||a.isLinked?(m(p,function(d,h){a.generateTick(d,h)}),a.renderUnsquish(),a.reserveSpaceDefault=0===A||2===A||{1:"left",3:"right"}[A]===a.labelAlign,B(k.reserveSpace,"center"===a.labelAlign||null,a.reserveSpaceDefault)&&m(p,function(a){q=Math.max(e[a].getLabelSize(),q)}),a.staggerLines&&(q*=a.staggerLines),a.labelOffset=q*(a.opposite?-1:1)):n(e,function(a,d){a.destroy(),delete e[d]}),F&&F.text&&!1!==F.enabled&&(a.addTitle(D),D&&!1!==F.reserveSpace&&(a.titleOffset=g=a.axisTitle.getBBox()[l?"height":"width"],x=F.offset,C=t(x)?0:B(F.margin,l?5:10))),a.renderLine(),a.offset=J*B(c.offset,I[A]),a.tickRotCorr=a.tickRotCorr||{x:0,y:0},b=0===A?-a.labelMetrics().h:2===A?a.tickRotCorr.y:0,C=Math.abs(q)+C,q&&(C=C-b+J*(l?B(k.y,a.tickRotCorr.y+8*J):k.x)),a.axisTitleMargin=B(x,C),I[A]=Math.max(I[A],a.axisTitleMargin+g+J*a.offset,C,f&&p.length&&v?v[0]+J*a.offset:0),c=c.offset?0:2*Math.floor(a.axisLine.strokeWidth()/2),d[r]=Math.max(d[r],c)},getLinePath:function(a){var d=this.chart,h=this.opposite,b=this.offset,c=this.horiz,p=this.left+(h?this.width:0)+b;b=d.chartHeight-this.bottom-(h?this.height:0)+b;return h&&(a*=-1),d.renderer.crispLine(["M",c?this.left:p,c?b:this.top,"L",c?d.chartWidth-this.right:p,c?b:d.chartHeight-this.bottom],a)},renderLine:function(){this.axisLine||(this.axisLine=this.chart.renderer.path().addClass("highcharts-axis-line").add(this.axisGroup),this.axisLine.attr({stroke:this.options.lineColor,"stroke-width":this.options.lineWidth,zIndex:7}))},getTitlePosition:function(){var a=this.horiz,d=this.left,b=this.top,c=this.len,p=this.options.title,e=a?d:b,n=this.opposite,l=this.offset,A=p.x||0,r=p.y||0,f=this.axisTitle,D=this.chart.renderer.fontMetrics(p.style&&p.style.fontSize,f);f=Math.max(f.getBBox(null,0).height-D.h-1,0),c={low:e+(a?0:c),middle:e+c/2,high:e+(a?c:0)}[p.align],d=(a?b+this.height:d)+(a?1:-1)*(n?-1:1)*this.axisTitleMargin+[-f,f,D.f,-f][this.side];return{x:a?c+A:d+(n?this.width:0)+l+A,y:a?d+r-(n?this.height:0)+l:c+r}},renderMinorTick:function(a){var d=this.chart.hasRendered&&C(this.oldMin),b=this.minorTicks;b[a]||(b[a]=new p(this,a,"minor")),d&&b[a].isNew&&b[a].render(null,!0),b[a].render(null,!1,1)},renderTick:function(a,d){var b=this.isLinked,h=this.ticks,c=this.chart.hasRendered&&C(this.oldMin);(!b||a>=this.min&&a<=this.max)&&(h[a]||(h[a]=new p(this,a)),c&&h[a].isNew&&h[a].render(d,!0,.1),h[a].render(d))},render:function(){var u,z,b=this,c=b.chart,e=b.options,l=b.isLog,A=b.lin2log,r=b.isLinked,f=b.tickPositions,D=b.axisTitle,g=b.ticks,x=b.minorTicks,B=b.alternateBands,F=e.stackLabels,k=e.alternateGridColor,q=b.tickmarkOffset,t=b.axisLine,I=b.showAxis,J=E(c.renderer.globalAnimation);b.labelEdge.length=0,b.overlap=!1,m([g,x,B],function(a){n(a,function(a){a.isActive=!1})}),(b.hasData()||r)&&(b.minorTickInterval&&!b.categories&&m(b.getMinorTickPositions(),function(a){b.renderMinorTick(a)}),f.length&&(m(f,function(a,d){b.renderTick(a,d)}),q&&(0===b.min||b.single)&&(g[-1]||(g[-1]=new p(b,-1,null,!0)),g[-1].render(-1))),k&&m(f,function(d,h){z=void 0!==f[h+1]?f[h+1]+q:b.max-q,0==h%2&&d<b.max&&z<=b.max+(c.polar?-q:q)&&(B[d]||(B[d]=new a.PlotLineOrBand(b)),u=d+q,B[d].options={from:l?A(u):u,to:l?A(z):z,color:k},B[d].render(),B[d].isActive=!0)}),b._addedPlotLB||(m((e.plotLines||[]).concat(e.plotBands||[]),function(a){b.addPlotBandOrLine(a)}),b._addedPlotLB=!0)),m([g,x,B],function(a){var b,h=[],p=J.duration;n(a,function(a,d){a.isActive||(a.render(d,!1,0),a.isActive=!1,h.push(d))}),d(function(){for(b=h.length;b--;)a[h[b]]&&!a[h[b]].isActive&&(a[h[b]].destroy(),delete a[h[b]])},a!==B&&c.hasRendered&&p?p:0)}),t&&(t[t.isPlaced?"animate":"attr"]({d:this.getLinePath(t.strokeWidth())}),t.isPlaced=!0,t[I?"show":"hide"](!0)),D&&I&&(e=b.getTitlePosition(),C(e.y)?(D[D.isNew?"attr":"animate"](e),D.isNew=!1):(D.attr("y",-9999),D.isNew=!0)),F&&F.enabled&&b.renderStackTotals(),b.isDirty=!1},redraw:function(){this.visible&&(this.render(),m(this.plotLinesAndBands,function(a){a.render()})),m(this.series,function(a){a.isDirty=!0})},keepProps:"extKey hcEvents names series userMax userMin".split(" "),destroy:function(a){var c,d=this,b=d.stacks,h=d.plotLinesAndBands;if(a||J(d),n(b,function(a,d){z(a),b[d]=null}),m([d.ticks,d.minorTicks,d.alternateBands],function(a){z(a)}),h)for(a=h.length;a--;)h[a].destroy();for(c in m("stackTotalGroup axisLine axisTitle axisGroup gridGroup labelGroup cross".split(" "),function(a){d[a]&&(d[a]=d[a].destroy())}),d.plotLinesAndBandsGroups)d.plotLinesAndBandsGroups[c]=d.plotLinesAndBandsGroups[c].destroy();n(d,function(a,b){-1===r(b,d.keepProps)&&delete d[b]})},drawCrosshair:function(a,d){var b,p,h=this.crosshair,c=B(h.snap,!0),e=this.cross;a||(a=this.cross&&this.cross.e),this.crosshair&&!1!==(t(d)||!c)?(c?t(d)&&(p=this.isXAxis?d.plotX:this.len-d.plotY):p=a&&(this.horiz?a.chartX-this.pos:this.len-a.chartY+this.pos),t(p)&&(b=this.getPlotLinePath(d&&(this.isXAxis?d.x:B(d.stackY,d.y)),null,null,null,p)||null),t(b)?(d=this.categories&&!this.isRadial,e||(this.cross=e=this.chart.renderer.path().addClass("highcharts-crosshair highcharts-crosshair-"+(d?"category ":"thin ")+h.className).attr({zIndex:B(h.zIndex,2)}).add(),e.attr({stroke:h.color||(d?k("#ccd6eb").setOpacity(.25).get():"#cccccc"),"stroke-width":B(h.width,1)}).css({"pointer-events":"none"}),h.dashStyle&&e.attr({dashstyle:h.dashStyle})),e.show().attr({d:b}),d&&!h.width&&e.attr({"stroke-width":this.transA}),this.cross.e=a):this.hideCrosshair()):this.hideCrosshair()},hideCrosshair:function(){this.cross&&this.cross.hide()}}),a.Axis=D}(L);return function(a){var G=a.Axis,E=a.Date,H=a.dateFormat,v=a.defaultOptions,k=a.defined,q=a.each,w=a.extend,t=a.getMagnitude,u=a.getTZOffset,z=a.normalizeTickInterval,m=a.pick,g=a.timeUnits;G.prototype.getTimeTicks=function(a,e,c,b){var t,J,A,r=[],l={},f=v.global.useUTC,x=new E(e-Math.max(u(e),u(c))),F=E.hcMakeTime,n=a.unitRange,B=a.count;if(k(e)){x[E.hcSetMilliseconds](n>=g.second?0:B*Math.floor(x.getMilliseconds()/B)),n>=g.second&&x[E.hcSetSeconds](n>=g.minute?0:B*Math.floor(x.getSeconds()/B)),n>=g.minute&&x[E.hcSetMinutes](n>=g.hour?0:B*Math.floor(x[E.hcGetMinutes]()/B)),n>=g.hour&&x[E.hcSetHours](n>=g.day?0:B*Math.floor(x[E.hcGetHours]()/B)),n>=g.day&&x[E.hcSetDate](n>=g.month?1:B*Math.floor(x[E.hcGetDate]()/B)),n>=g.month&&(x[E.hcSetMonth](n>=g.year?0:B*Math.floor(x[E.hcGetMonth]()/B)),t=x[E.hcGetFullYear]()),n>=g.year&&x[E.hcSetFullYear](t-t%B),n===g.week&&x[E.hcSetDate](x[E.hcGetDate]()-x[E.hcGetDay]()+m(b,1)),t=x[E.hcGetFullYear](),b=x[E.hcGetMonth]();var d=x[E.hcGetDate](),p=x[E.hcGetHours]();for(e=x.getTime(),E.hcHasTimeZone&&(A=(!f||!!E.hcGetTimezoneOffset)&&(c-e>4*g.month||u(e)!==u(c)),J=u(x),x=new E(e+J)),f=x.getTime(),e=1;f<c;)r.push(f),f=n===g.year?F(t+e*B,0):n===g.month?F(t,b+e*B):!A||n!==g.day&&n!==g.week?A&&n===g.hour?F(t,b,d,p+e*B,0,0,J)-J:f+n*B:F(t,b,d+e*B*(n===g.day?1:7)),e++;r.push(f),n<=g.hour&&1e4>r.length&&q(r,function(a){0==a%18e5&&"000000000"===H("%H%M%S%L",a)&&(l[a]="day")})}return r.info=w(a,{higherRanks:l,totalRange:n*B}),r},G.prototype.normalizeTimeTickInterval=function(a,e){var c=e||[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1,2]],["week",[1,2]],["month",[1,2,3,4,6]],["year",null]];e=c[c.length-1];var l,b=g[e[0]],r=e[1];for(l=0;l<c.length&&(e=c[l],b=g[e[0]],r=e[1],!(c[l+1]&&a<=(b*r[r.length-1]+g[c[l+1][0]])/2));l++);return b===g.year&&a<5*b&&(r=[1,2,5]),{unitRange:b,count:a=z(a/b,r,"year"===e[0]?Math.max(t(a/b),1):1),unitName:e[0]}}}(L),function(a){var G=a.Axis,E=a.getMagnitude,H=a.map,v=a.normalizeTickInterval,k=a.pick;G.prototype.getLogTickPositions=function(a,w,t,u){var q=this.options,m=this.len,g=this.lin2log,f=this.log2lin,e=[];if(u||(this._minorAutoInterval=null),.5<=a)a=Math.round(a),e=this.getLinearTickPositions(a,w,t);else if(.08<=a){var c,b,r,l,C;for(m=Math.floor(w),q=.3<a?[1,2,4]:.15<a?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];m<t+1&&!C;m++)for(b=q.length,c=0;c<b&&!C;c++)(r=f(g(m)*q[c]))>w&&(!u||l<=t)&&void 0!==l&&e.push(l),l>t&&(C=!0),l=r}else w=g(w),t=g(t),a=u?this.getMinorTickInterval():q.tickInterval,a=k("auto"===a?null:a,this._minorAutoInterval,q.tickPixelInterval/(u?5:1)*(t-w)/((u?m/this.tickPositions.length:m)||1)),a=v(a,null,E(a)),e=H(this.getLinearTickPositions(a,w,t),f),u||(this._minorAutoInterval=a/5);return u||(this.tickInterval=a),e},G.prototype.log2lin=function(a){return Math.log(a)/Math.LN10},G.prototype.lin2log=function(a){return Math.pow(10,a)}}(L),function(a,G){var E=a.arrayMax,H=a.arrayMin,v=a.defined,k=a.destroyObjectProperties,q=a.each,w=a.erase,t=a.merge,u=a.pick;a.PlotLineOrBand=function(a,m){this.axis=a,m&&(this.options=m,this.id=m.id)},a.PlotLineOrBand.prototype={render:function(){var k=this,m=k.axis,g=m.horiz,f=k.options,e=f.label,c=k.label,b=f.to,r=f.from,l=f.value,C=v(r)&&v(b),q=v(l),x=k.svgElem,F=!x,n=[],B=f.color,J=u(f.zIndex,0),A=f.events,d=(n={class:"highcharts-plot-"+(C?"band ":"line ")+(f.className||"")},{}),p=m.chart.renderer,D=C?"bands":"lines",h=m.log2lin;if(m.isLog&&(r=h(r),b=h(b),l=h(l)),q?(n={stroke:B,"stroke-width":f.width},f.dashStyle&&(n.dashstyle=f.dashStyle)):C&&(B&&(n.fill=B),f.borderWidth&&(n.stroke=f.borderColor,n["stroke-width"]=f.borderWidth)),d.zIndex=J,D+="-"+J,(B=m.plotLinesAndBandsGroups[D])||(m.plotLinesAndBandsGroups[D]=B=p.g("plot-"+D).attr(d).add()),F&&(k.svgElem=x=p.path().attr(n).add(B)),q)n=m.getPlotLinePath(l,x.strokeWidth());else{if(!C)return;n=m.getPlotBandPath(r,b,f)}return F&&n&&n.length?(x.attr({d:n}),A&&a.objectEach(A,function(a,d){x.on(d,function(a){A[d].apply(k,[a])})})):x&&(n?(x.show(),x.animate({d:n})):(x.hide(),c&&(k.label=c=c.destroy()))),e&&v(e.text)&&n&&n.length&&0<m.width&&0<m.height&&!n.flat?(e=t({align:g&&C&&"center",x:g?!C&&4:10,verticalAlign:!g&&C&&"middle",y:g?C?16:10:C?6:-4,rotation:g&&!C&&90},e),this.renderLabel(e,n,C,J)):c&&c.hide(),k},renderLabel:function(a,m,g,f){var e=this.label,c=this.axis.chart.renderer;e||((e={align:a.textAlign||a.align,rotation:a.rotation,class:"highcharts-plot-"+(g?"band":"line")+"-label "+(a.className||"")}).zIndex=f,this.label=e=c.text(a.text,0,0,a.useHTML).attr(e).add(),e.css(a.style)),f=m.xBounds||[m[1],m[4],g?m[6]:m[1]],m=m.yBounds||[m[2],m[5],g?m[7]:m[2]],g=H(f),c=H(m),e.align(a,!1,{x:g,y:c,width:E(f)-g,height:E(m)-c}),e.show()},destroy:function(){w(this.axis.plotLinesAndBands,this),delete this.axis,k(this)}},a.extend(G.prototype,{getPlotBandPath:function(a,m){var r,g=this.getPlotLinePath(m,null,null,!0),f=this.getPlotLinePath(a,null,null,!0),e=[],c=this.horiz,b=1;if(a=a<this.min&&m<this.min||a>this.max&&m>this.max,f&&g)for(a&&(r=f.toString()===g.toString(),b=0),a=0;a<f.length;a+=6)c&&g[a+1]===f[a+1]?(g[a+1]+=b,g[a+4]+=b):c||g[a+2]!==f[a+2]||(g[a+2]+=b,g[a+5]+=b),e.push("M",f[a+1],f[a+2],"L",f[a+4],f[a+5],g[a+4],g[a+5],g[a+1],g[a+2],"z"),e.flat=r;return e},addPlotBand:function(a){return this.addPlotBandOrLine(a,"plotBands")},addPlotLine:function(a){return this.addPlotBandOrLine(a,"plotLines")},addPlotBandOrLine:function(k,m){var g=new a.PlotLineOrBand(this,k).render(),f=this.userOptions;return g&&(m&&(f[m]=f[m]||[],f[m].push(k)),this.plotLinesAndBands.push(g)),g},removePlotBandOrLine:function(a){for(var m=this.plotLinesAndBands,g=this.options,f=this.userOptions,e=m.length;e--;)m[e].id===a&&m[e].destroy();q([g.plotLines||[],f.plotLines||[],g.plotBands||[],f.plotBands||[]],function(c){for(e=c.length;e--;)c[e].id===a&&w(c,c[e])})},removePlotBand:function(a){this.removePlotBandOrLine(a)},removePlotLine:function(a){this.removePlotBandOrLine(a)}})}(L,Z),function(a){var G=a.dateFormat,E=a.each,H=a.extend,v=a.format,k=a.isNumber,q=a.map,w=a.merge,t=a.pick,u=a.splat,z=a.syncTimeout,m=a.timeUnits;a.Tooltip=function(){this.init.apply(this,arguments)},a.Tooltip.prototype={init:function(a,f){this.chart=a,this.options=f,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.split=f.split&&!a.inverted,this.shared=f.shared||this.split},cleanSplit:function(a){E(this.chart.series,function(f){var e=f&&f.tt;e&&(!e.isActive||a?f.tt=e.destroy():e.isActive=!1)})},getLabel:function(){var a=this.chart.renderer,f=this.options;return this.label||(this.split?this.label=a.g("tooltip"):(this.label=a.label("",0,0,f.shape||"callout",null,null,f.useHTML,null,"tooltip").attr({padding:f.padding,r:f.borderRadius}),this.label.attr({fill:f.backgroundColor,"stroke-width":f.borderWidth}).css(f.style).shadow(f.shadow)),this.label.attr({zIndex:8}).add()),this.label},update:function(a){this.destroy(),w(!0,this.chart.options.tooltip.userOptions,a),this.init(this.chart,w(!0,this.options,a))},destroy:function(){this.label&&(this.label=this.label.destroy()),this.split&&this.tt&&(this.cleanSplit(this.chart,!0),this.tt=this.tt.destroy()),clearTimeout(this.hideTimer),clearTimeout(this.tooltipTimeout)},move:function(a,f,e,c){var b=this,r=b.now,l=!1!==b.options.animation&&!b.isHidden&&(1<Math.abs(a-r.x)||1<Math.abs(f-r.y)),g=b.followPointer||1<b.len;H(r,{x:l?(2*r.x+a)/3:a,y:l?(r.y+f)/2:f,anchorX:g?void 0:l?(2*r.anchorX+e)/3:e,anchorY:g?void 0:l?(r.anchorY+c)/2:c}),b.getLabel().attr(r),l&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){b&&b.move(a,f,e,c)},32))},hide:function(a){var f=this;clearTimeout(this.hideTimer),a=t(a,this.options.hideDelay,500),this.isHidden||(this.hideTimer=z(function(){f.getLabel()[a?"fadeOut":"hide"](),f.isHidden=!0},a))},getAnchor:function(a,f){var e,x,F,c=this.chart,b=c.inverted,r=c.plotTop,l=c.plotLeft,g=0,m=0;return e=(a=u(a))[0].tooltipPos,this.followPointer&&f&&(void 0===f.chartX&&(f=c.pointer.normalize(f)),e=[f.chartX-c.plotLeft,f.chartY-r]),e||(E(a,function(a){x=a.series.yAxis,F=a.series.xAxis,g+=a.plotX+(!b&&F?F.left-l:0),m+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!b&&x?x.top-r:0)}),g/=a.length,m/=a.length,e=[b?c.plotWidth-m:g,this.shared&&!b&&1<a.length&&f?f.chartY-r:b?c.plotHeight-g:m]),q(e,Math.round)},getPosition:function(a,f,e){var g,c=this.chart,b=this.distance,r={},l=c.inverted&&e.h||0,m=["y",c.chartHeight,f,e.plotY+c.plotTop,c.plotTop,c.plotTop+c.plotHeight],x=["x",c.chartWidth,a,e.plotX+c.plotLeft,c.plotLeft,c.plotLeft+c.plotWidth],F=!this.followPointer&&t(e.ttBelow,!c.inverted==!!e.negative),k=function(a){var d=m;m=x,x=d,g=a},A=function(){!1!==function(a,c,e,h,n,A){var d=e<h-b,p=h+b+e<c,f=h-b-e;if(h+=b,F&&p)r[a]=h;else if(!F&&d)r[a]=f;else if(d)r[a]=Math.min(A-e,0>f-l?f:f-l);else{if(!p)return!1;r[a]=Math.max(n,h+l+e>c?h:h+l)}}.apply(0,m)?!1!==function(a,c,e,h){var d;return h<b||h>c-b?d=!1:r[a]=h<e/2?1:h>c-e/2?c-e-2:h-e/2,d}.apply(0,x)||g||(k(!0),A()):g?r.x=r.y=0:(k(!0),A())};return(c.inverted||1<this.len)&&k(),A(),r},defaultFormatter:function(a){var e,f=this.points||u(this);return(e=(e=[a.tooltipFooterHeaderFormatter(f[0])]).concat(a.bodyFormatter(f))).push(a.tooltipFooterHeaderFormatter(f[0],!0)),e},refresh:function(a,f){var e,b,l,c=this.options,r=a,g={},m=[];e=c.formatter||this.defaultFormatter;var x;g=this.shared;c.enabled&&(clearTimeout(this.hideTimer),this.followPointer=u(r)[0].series.tooltipOptions.followPointer,f=(l=this.getAnchor(r,f))[0],b=l[1],!g||r.series&&r.series.noSharedTooltip?g=r.getLabelConfig():(E(r,function(a){a.setState("hover"),m.push(a.getLabelConfig())}),(g={x:r[0].category,y:r[0].y}).points=m,r=r[0]),this.len=m.length,g=e.call(g,this),x=r.series,this.distance=t(x.tooltipOptions.distance,16),!1===g?this.hide():(e=this.getLabel(),this.isHidden&&e.attr({opacity:1}).show(),this.split?this.renderSplit(g,u(a)):(c.style.width||e.css({width:this.chart.spacingBox.width}),e.attr({text:g&&g.join?g.join(""):g}),e.removeClass(/highcharts-color-[\d]+/g).addClass("highcharts-color-"+t(r.colorIndex,x.colorIndex)),e.attr({stroke:c.borderColor||r.color||x.color||"#666666"}),this.updatePosition({plotX:f,plotY:b,negative:r.negative,ttBelow:r.ttBelow,h:l[2]||0})),this.isHidden=!1))},renderSplit:function(g,f){var e=this,c=[],b=this.chart,r=b.renderer,l=!0,m=this.options,k=0,x=this.getLabel();a.isString(g)&&(g=[!1,g]),E(g.slice(0,f.length+1),function(a,n){if(!1!==a){var g=(n=f[n-1]||{isHeader:!0,plotX:f[0].plotX}).series||e,C=g.tt,A=n.series||{},d="highcharts-color-"+t(n.colorIndex,A.colorIndex,"none");C||(g.tt=C=r.label(null,null,null,"callout",null,null,m.useHTML).addClass("highcharts-tooltip-box "+d).attr({padding:m.padding,r:m.borderRadius,fill:m.backgroundColor,stroke:m.borderColor||n.color||A.color||"#333333","stroke-width":m.borderWidth}).add(x)),C.isActive=!0,C.attr({text:a}),C.css(m.style).shadow(m.shadow),A=(a=C.getBBox()).width+C.strokeWidth(),n.isHeader?(k=a.height,A=Math.max(0,Math.min(n.plotX+b.plotLeft-A/2,b.chartWidth-A))):A=n.plotX+b.plotLeft-t(m.distance,16)-A,0>A&&(l=!1),a=(n.series&&n.series.yAxis&&n.series.yAxis.pos)+(n.plotY||0),a-=b.plotTop,c.push({target:n.isHeader?b.plotHeight+k:a,rank:n.isHeader?1:0,size:g.tt.getBBox().height+1,point:n,x:A,tt:C})}}),this.cleanSplit(),a.distribute(c,b.plotHeight+k),E(c,function(a){var c=a.point,e=c.series;a.tt.attr({visibility:void 0===a.pos?"hidden":"inherit",x:l||c.isHeader?a.x:c.plotX+b.plotLeft+t(m.distance,16),y:a.pos+b.plotTop,anchorX:c.isHeader?c.plotX+b.plotLeft:c.plotX+e.xAxis.pos,anchorY:c.isHeader?a.pos+b.plotTop-15:c.plotY+e.yAxis.pos})})},updatePosition:function(a){var f=this.chart,e=this.getLabel();e=(this.options.positioner||this.getPosition).call(this,e.width,e.height,a);this.move(Math.round(e.x),Math.round(e.y||0),a.plotX+f.plotLeft,a.plotY+f.plotTop)},getDateFormat:function(a,f,e,c){var r,l,b=G("%m-%d %H:%M:%S.%L",f),g={millisecond:15,second:12,minute:9,hour:6,day:3},k="millisecond";for(l in m){if(a===m.week&&+G("%w",f)===e&&"00:00:00.000"===b.substr(6)){l="week";break}if(m[l]>a){l=k;break}if(g[l]&&b.substr(g[l])!=="01-01 00:00:00.000".substr(g[l]))break;"week"!==l&&(k=l)}return l&&(r=c[l]),r},getXDateFormat:function(a,f,e){f=f.dateTimeLabelFormats;var c=e&&e.closestPointRange;return(c?this.getDateFormat(c,a.x,e.options.startOfWeek,f):f.day)||f.year},tooltipFooterHeaderFormatter:function(a,f){f=f?"footer":"header";var e=a.series,c=e.tooltipOptions,b=c.xDateFormat,r=e.xAxis,l=r&&"datetime"===r.options.type&&k(a.key),g=c[f+"Format"];return l&&!b&&(b=this.getXDateFormat(a,c,r)),l&&b&&E(a.point&&a.point.tooltipDateKeys||["key"],function(a){g=g.replace("{point."+a+"}","{point."+a+":"+b+"}")}),v(g,{point:a,series:e})},bodyFormatter:function(a){return q(a,function(a){var e=a.series.tooltipOptions;return(e[(a.point.formatPrefix||"point")+"Formatter"]||a.point.tooltipFormatter).call(a.point,e[(a.point.formatPrefix||"point")+"Format"])})}}}(L),function(a){var G=a.addEvent,E=a.attr,H=a.charts,v=a.color,k=a.css,q=a.defined,w=a.each,t=a.extend,u=a.find,z=a.fireEvent,m=a.isObject,g=a.offset,f=a.pick,e=a.splat,c=a.Tooltip;a.Pointer=function(a,c){this.init(a,c)},a.Pointer.prototype={init:function(a,e){this.options=e,this.chart=a,this.runChartClick=e.chart.events&&!!e.chart.events.click,this.pinchDown=[],this.lastValidTouch={},c&&(a.tooltip=new c(a,e.tooltip),this.followTouchMove=f(e.tooltip.followTouchMove,!0)),this.setDOMEvents()},zoomOption:function(a){var c=(b=this.chart).options.chart,e=c.zoomType||"",b=b.inverted;/touch/.test(a.type)&&(e=f(c.pinchType,e)),this.zoomX=a=/x/.test(e),this.zoomY=e=/y/.test(e),this.zoomHor=a&&!b||e&&b,this.zoomVert=e&&!b||a&&b,this.hasZoom=a||e},normalize:function(a,c){var b;return b=a.touches?a.touches.length?a.touches.item(0):a.changedTouches[0]:a,c||(this.chartPosition=c=g(this.chart.container)),t(a,{chartX:Math.round(b.pageX-c.left),chartY:Math.round(b.pageY-c.top)})},getCoordinates:function(a){var b={xAxis:[],yAxis:[]};return w(this.chart.axes,function(c){b[c.isXAxis?"xAxis":"yAxis"].push({axis:c,value:c.toValue(a[c.horiz?"chartX":"chartY"])})}),b},findNearestKDPoint:function(a,c,e){var b;return w(a,function(a){var l=!(a.noSharedTooltip&&c)&&0>a.options.findNearestPointBy.indexOf("y");if(a=a.searchPoint(e,l),(l=m(a,!0))&&!(l=!m(b,!0))){l=b.distX-a.distX;var r=b.dist-a.dist,n=(a.series.group&&a.series.group.zIndex)-(b.series.group&&b.series.group.zIndex);l=0<(0!==l&&c?l:0!==r?r:0!==n?n:b.series.index>a.series.index?-1:1)}l&&(b=a)}),b},getPointFromEvent:function(a){a=a.target;for(var b;a&&!b;)b=a.point,a=a.parentNode;return b},getChartCoordinatesFromPoint:function(a,c){var e=(b=a.series).xAxis,b=b.yAxis,r=f(a.clientX,a.plotX);if(e&&b)return c?{chartX:e.len+e.pos-r,chartY:b.len+b.pos-a.plotY}:{chartX:r+e.pos,chartY:a.plotY+b.pos}},getHoverData:function(b,c,e,g,k,x,F){var n,l=[],r=F&&F.isBoosting;return g=!(!g||!b),F=c&&!c.stickyTracking?[c]:a.grep(e,function(a){return a.visible&&!(!k&&a.directTouch)&&f(a.options.enableMouseTracking,!0)&&a.stickyTracking}),c=(n=g?b:this.findNearestKDPoint(F,k,x))&&n.series,n&&(k&&!c.noSharedTooltip?(F=a.grep(e,function(a){return a.visible&&!(!k&&a.directTouch)&&f(a.options.enableMouseTracking,!0)&&!a.noSharedTooltip}),w(F,function(a){var d=u(a.points,function(a){return a.x===n.x&&!a.isNull});m(d)&&(r&&(d=a.getPoint(d)),l.push(d))})):l.push(n)),{hoverPoint:n,hoverSeries:c,hoverPoints:l}},runPointActions:function(b,c){var n,e=this.chart,r=e.tooltip&&e.tooltip.options.enabled?e.tooltip:void 0,g=!!r&&r.shared,m=(x=c||e.hoverPoint)&&x.series||e.hoverSeries,x=(m=this.getHoverData(x,m,e.series,!!c||m&&m.directTouch&&this.isDirectTouch,g,b,{isBoosting:e.isBoosting})).hoverPoint;if(n=m.hoverPoints,c=(m=m.hoverSeries)&&m.tooltipOptions.followPointer,g=g&&m&&!m.noSharedTooltip,x&&(x!==e.hoverPoint||r&&r.isHidden)){if(w(e.hoverPoints||[],function(b){-1===a.inArray(b,n)&&b.setState()}),w(n||[],function(a){a.setState("hover")}),e.hoverSeries!==m&&m.onMouseOver(),e.hoverPoint&&e.hoverPoint.firePointEvent("mouseOut"),!x.series)return;x.firePointEvent("mouseOver"),e.hoverPoints=n,e.hoverPoint=x,r&&r.refresh(g?n:x,b)}else c&&r&&!r.isHidden&&(x=r.getAnchor([{}],b),r.updatePosition({plotX:x[0],plotY:x[1]}));this.unDocMouseMove||(this.unDocMouseMove=G(e.container.ownerDocument,"mousemove",function(b){var c=H[a.hoverChartIndex];c&&c.pointer.onDocumentMouseMove(b)})),w(e.axes,function(c){var e=f(c.crosshair.snap,!0),l=e?a.find(n,function(a){return a.series[c.coll]===c}):void 0;l||!e?c.drawCrosshair(b,l):c.hideCrosshair()})},reset:function(a,c){var b=this.chart,r=b.hoverSeries,f=b.hoverPoint,g=b.hoverPoints,m=b.tooltip,n=m&&m.shared?g:f;a&&n&&w(e(n),function(b){b.series.isCartesian&&void 0===b.plotX&&(a=!1)}),a?m&&n&&(m.refresh(n),f&&(f.setState(f.state,!0),w(b.axes,function(a){a.crosshair&&a.drawCrosshair(null,f)}))):(f&&f.onMouseOut(),g&&w(g,function(a){a.setState()}),r&&r.onMouseOut(),m&&m.hide(c),this.unDocMouseMove&&(this.unDocMouseMove=this.unDocMouseMove()),w(b.axes,function(a){a.hideCrosshair()}),this.hoverX=b.hoverPoints=b.hoverPoint=null)},scaleGroups:function(a,c){var e,b=this.chart;w(b.series,function(l){e=a||l.getPlotBox(),l.xAxis&&l.xAxis.zoomEnabled&&l.group&&(l.group.attr(e),l.markerGroup&&(l.markerGroup.attr(e),l.markerGroup.clip(c?b.clipRect:null)),l.dataLabelsGroup&&l.dataLabelsGroup.attr(e))}),b.clipRect.attr(c||b.clipBox)},dragStart:function(a){var b=this.chart;b.mouseIsDown=a.type,b.cancelClick=!1,b.mouseDownX=this.mouseDownX=a.chartX,b.mouseDownY=this.mouseDownY=a.chartY},drag:function(a){var d,b=this.chart,c=b.options.chart,e=a.chartX,f=a.chartY,g=this.zoomHor,m=this.zoomVert,n=b.plotLeft,B=b.plotTop,k=b.plotWidth,A=b.plotHeight,p=this.selectionMarker,D=this.mouseDownX,h=this.mouseDownY,y=c.panKey&&a[c.panKey+"Key"];p&&p.touch||(e<n?e=n:e>n+k&&(e=n+k),f<B?f=B:f>B+A&&(f=B+A),this.hasDragged=Math.sqrt(Math.pow(D-e,2)+Math.pow(h-f,2)),10<this.hasDragged&&(d=b.isInsidePlot(D-n,h-B),b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&d&&!y&&!p&&(this.selectionMarker=p=b.renderer.rect(n,B,g?1:k,m?1:A,0).attr({fill:c.selectionMarkerFill||v("#335cad").setOpacity(.25).get(),class:"highcharts-selection-marker",zIndex:7}).add()),p&&g&&(e-=D,p.attr({width:Math.abs(e),x:(0<e?0:e)+D})),p&&m&&(e=f-h,p.attr({height:Math.abs(e),y:(0<e?0:e)+h})),d&&!p&&c.panning&&b.pan(a,c.panning)))},drop:function(a){var b=this,c=this.chart,e=this.hasPinched;if(this.selectionMarker){var A,f={originalEvent:a,xAxis:[],yAxis:[]},g=this.selectionMarker,m=g.attr?g.attr("x"):g.x,n=g.attr?g.attr("y"):g.y,B=g.attr?g.attr("width"):g.width,u=g.attr?g.attr("height"):g.height;(this.hasDragged||e)&&(w(c.axes,function(d){if(d.zoomEnabled&&q(d.min)&&(e||b[{xAxis:"zoomX",yAxis:"zoomY"}[d.coll]])){var c=d.horiz,l="touchend"===a.type?d.minPixelPadding:0,h=d.toValue((c?m:n)+l);c=d.toValue((c?m+B:n+u)-l);f[d.coll].push({axis:d,min:Math.min(h,c),max:Math.max(h,c)}),A=!0}}),A&&z(c,"selection",f,function(a){c.zoom(t(a,e?{animation:!1}:null))})),this.selectionMarker=this.selectionMarker.destroy(),e&&this.scaleGroups()}c&&(k(c.container,{cursor:c._cursor}),c.cancelClick=10<this.hasDragged,c.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(a){2!==a.button&&(a=this.normalize(a),this.zoomOption(a),a.preventDefault&&a.preventDefault(),this.dragStart(a))},onDocumentMouseUp:function(b){H[a.hoverChartIndex]&&H[a.hoverChartIndex].pointer.drop(b)},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition;a=this.normalize(a,c),!c||this.inClass(a.target,"highcharts-tracker")||b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)||this.reset()},onContainerMouseLeave:function(b){var c=H[a.hoverChartIndex];c&&(b.relatedTarget||b.toElement)&&(c.pointer.reset(),c.pointer.chartPosition=null)},onContainerMouseMove:function(b){var c=this.chart;q(a.hoverChartIndex)&&H[a.hoverChartIndex]&&H[a.hoverChartIndex].mouseIsDown||(a.hoverChartIndex=c.index),(b=this.normalize(b)).returnValue=!1,"mousedown"===c.mouseIsDown&&this.drag(b),!this.inClass(b.target,"highcharts-tracker")&&!c.isInsidePlot(b.chartX-c.plotLeft,b.chartY-c.plotTop)||c.openMenu||this.runPointActions(b)},inClass:function(a,c){for(var b;a;){if(b=E(a,"class")){if(-1!==b.indexOf(c))return!0;if(-1!==b.indexOf("highcharts-container"))return!1}a=a.parentNode}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries;a=a.relatedTarget||a.toElement,this.isDirectTouch=!1,!b||!a||b.stickyTracking||this.inClass(a,"highcharts-tooltip")||this.inClass(a,"highcharts-series-"+b.index)&&this.inClass(a,"highcharts-tracker")||b.onMouseOut()},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,e=b.plotLeft,f=b.plotTop;a=this.normalize(a),b.cancelClick||(c&&this.inClass(a.target,"highcharts-tracker")?(z(c.series,"click",t(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(t(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-e,a.chartY-f)&&z(b,"click",a)))},setDOMEvents:function(){var b=this,c=b.chart.container,e=c.ownerDocument;c.onmousedown=function(a){b.onContainerMouseDown(a)},c.onmousemove=function(a){b.onContainerMouseMove(a)},c.onclick=function(a){b.onContainerClick(a)},this.unbindContainerMouseLeave=G(c,"mouseleave",b.onContainerMouseLeave),a.unbindDocumentMouseUp||(a.unbindDocumentMouseUp=G(e,"mouseup",b.onDocumentMouseUp)),a.hasTouch&&(c.ontouchstart=function(a){b.onContainerTouchStart(a)},c.ontouchmove=function(a){b.onContainerTouchMove(a)},a.unbindDocumentTouchEnd||(a.unbindDocumentTouchEnd=G(e,"touchend",b.onDocumentTouchEnd)))},destroy:function(){var b=this;b.unDocMouseMove&&b.unDocMouseMove(),this.unbindContainerMouseLeave(),a.chartCount||(a.unbindDocumentMouseUp&&(a.unbindDocumentMouseUp=a.unbindDocumentMouseUp()),a.unbindDocumentTouchEnd&&(a.unbindDocumentTouchEnd=a.unbindDocumentTouchEnd())),clearInterval(b.tooltipTimeout),a.objectEach(b,function(a,c){b[c]=null})}}}(L),function(a){var G=a.charts,E=a.each,H=a.extend,v=a.map,k=a.noop,q=a.pick;H(a.Pointer.prototype,{pinchTranslate:function(a,k,q,v,m,g){this.zoomHor&&this.pinchTranslateDirection(!0,a,k,q,v,m,g),this.zoomVert&&this.pinchTranslateDirection(!1,a,k,q,v,m,g)},pinchTranslateDirection:function(a,k,q,v,m,g,f,e){var x,F,y,c=this.chart,b=a?"x":"y",r=a?"X":"Y",l="chart"+r,C=a?"width":"height",t=c["plot"+(a?"Left":"Top")],n=e||1,B=c.inverted,u=c.bounds[a?"h":"v"],A=1===k.length,d=k[0][l],p=q[0][l],D=!A&&k[1][l],h=!A&&q[1][l];(q=function(){!A&&20<Math.abs(d-D)&&(n=e||Math.abs(p-h)/Math.abs(d-D)),F=(t-p)/n+d,x=c["plot"+(a?"Width":"Height")]/n})(),(k=F)<u.min?(k=u.min,y=!0):k+x>u.max&&(k=u.max-x,y=!0),y?(p-=.8*(p-f[b][0]),A||(h-=.8*(h-f[b][1])),q()):f[b]=[p,h],B||(g[b]=F-t,g[C]=x),g=B?1/n:n,m[C]=x,m[b]=k,v[B?a?"scaleY":"scaleX":"scale"+r]=n,v["translate"+r]=g*t+(p-g*d)},pinch:function(a){var t=this,u=t.chart,w=t.pinchDown,m=a.touches,g=m.length,f=t.lastValidTouch,e=t.hasZoom,c=t.selectionMarker,b={},r=1===g&&(t.inClass(a.target,"highcharts-tracker")&&u.runTrackerClick||t.runChartClick),l={};1<g&&(t.initiated=!0),e&&t.initiated&&!r&&a.preventDefault(),v(m,function(a){return t.normalize(a)}),"touchstart"===a.type?(E(m,function(a,b){w[b]={chartX:a.chartX,chartY:a.chartY}}),f.x=[w[0].chartX,w[1]&&w[1].chartX],f.y=[w[0].chartY,w[1]&&w[1].chartY],E(u.axes,function(a){if(a.zoomEnabled){var b=u.bounds[a.horiz?"h":"v"],c=a.minPixelPadding,e=a.toPixels(q(a.options.min,a.dataMin)),n=a.toPixels(q(a.options.max,a.dataMax)),l=Math.max(e,n);b.min=Math.min(a.pos,Math.min(e,n)-c),b.max=Math.max(a.pos+a.len,l+c)}}),t.res=!0):t.followTouchMove&&1===g?this.runPointActions(t.normalize(a)):w.length&&(c||(t.selectionMarker=c=H({destroy:k,touch:!0},u.plotBox)),t.pinchTranslate(w,m,b,c,l,f),t.hasPinched=e,t.scaleGroups(b,l),t.res&&(t.res=!1,this.reset(!1,0)))},touch:function(k,t){var v,u=this.chart;u.index!==a.hoverChartIndex&&this.onContainerMouseLeave({relatedTarget:!0}),a.hoverChartIndex=u.index,1===k.touches.length?(k=this.normalize(k),u.isInsidePlot(k.chartX-u.plotLeft,k.chartY-u.plotTop)&&!u.openMenu?(t&&this.runPointActions(k),"touchmove"===k.type&&(v=!!(t=this.pinchDown)[0]&&4<=Math.sqrt(Math.pow(t[0].chartX-k.chartX,2)+Math.pow(t[0].chartY-k.chartY,2))),q(v,!0)&&this.pinch(k)):t&&this.reset()):2===k.touches.length&&this.pinch(k)},onContainerTouchStart:function(a){this.zoomOption(a),this.touch(a,!0)},onContainerTouchMove:function(a){this.touch(a)},onDocumentTouchEnd:function(k){G[a.hoverChartIndex]&&G[a.hoverChartIndex].pointer.drop(k)}})}(L),function(a){var G=a.addEvent,E=a.charts,H=a.css,v=a.doc,k=a.extend,q=a.noop,w=a.Pointer,t=a.removeEvent,u=a.win,z=a.wrap;if(!a.hasTouch&&(u.PointerEvent||u.MSPointerEvent)){var m={},g=!!u.PointerEvent,e=function(c,b,e,l){"touch"!==c.pointerType&&c.pointerType!==c.MSPOINTER_TYPE_TOUCH||!E[a.hoverChartIndex]||(l(c),(l=E[a.hoverChartIndex].pointer)[b]({type:e,target:c.currentTarget,preventDefault:q,touches:function(){var c=[];return c.item=function(a){return this[a]},a.objectEach(m,function(a){c.push({pageX:a.pageX,pageY:a.pageY,target:a.target})}),c}()}))};k(w.prototype,{onContainerPointerDown:function(a){e(a,"onContainerTouchStart","touchstart",function(a){m[a.pointerId]={pageX:a.pageX,pageY:a.pageY,target:a.currentTarget}})},onContainerPointerMove:function(a){e(a,"onContainerTouchMove","touchmove",function(a){m[a.pointerId]={pageX:a.pageX,pageY:a.pageY},m[a.pointerId].target||(m[a.pointerId].target=a.currentTarget)})},onDocumentPointerUp:function(a){e(a,"onDocumentTouchEnd","touchend",function(a){delete m[a.pointerId]})},batchMSEvents:function(a){a(this.chart.container,g?"pointerdown":"MSPointerDown",this.onContainerPointerDown),a(this.chart.container,g?"pointermove":"MSPointerMove",this.onContainerPointerMove),a(v,g?"pointerup":"MSPointerUp",this.onDocumentPointerUp)}}),z(w.prototype,"init",function(a,b,e){a.call(this,b,e),this.hasZoom&&H(b.container,{"-ms-touch-action":"none","touch-action":"none"})}),z(w.prototype,"setDOMEvents",function(a){a.apply(this),(this.hasZoom||this.followTouchMove)&&this.batchMSEvents(G)}),z(w.prototype,"destroy",function(a){this.batchMSEvents(t),a.call(this)})}}(L),function(a){var G=a.addEvent,E=a.css,H=a.discardElement,v=a.defined,k=a.each,q=a.isFirefox,w=a.marginNames,t=a.merge,u=a.pick,z=a.setAnimation,m=a.stableSort,g=a.win,f=a.wrap;a.Legend=function(a,c){this.init(a,c)},a.Legend.prototype={init:function(a,c){this.chart=a,this.setOptions(c),c.enabled&&(this.render(),G(this.chart,"endResize",function(){this.legend.positionCheckboxes()}))},setOptions:function(a){var c=u(a.padding,8);this.options=a,this.itemStyle=a.itemStyle,this.itemHiddenStyle=t(this.itemStyle,a.itemHiddenStyle),this.itemMarginTop=a.itemMarginTop||0,this.padding=c,this.initialItemY=c-5,this.itemHeight=this.maxItemWidth=0,this.symbolWidth=u(a.symbolWidth,16),this.pages=[]},update:function(a,c){var b=this.chart;this.setOptions(t(!0,this.options,a)),this.destroy(),b.isDirtyLegend=b.isDirtyBox=!0,u(c,!0)&&b.redraw()},colorizeItem:function(a,c){a.legendGroup[c?"removeClass":"addClass"]("highcharts-legend-item-hidden");var b=this.options,e=a.legendItem,l=a.legendLine,f=a.legendSymbol,g=this.itemHiddenStyle.color,m=(b=c?b.itemStyle.color:g,c&&a.color||g),k=a.options&&a.options.marker,n={fill:m};e&&e.css({fill:b,color:b}),l&&l.attr({stroke:m}),f&&(k&&f.isMarker&&(n=a.pointAttribs(),c||(n.stroke=n.fill=g)),f.attr(n))},positionItem:function(a){var b=(c=this.options).symbolPadding,c=!c.rtl,l=(e=a._legendItemPos)[0],e=e[1],f=a.checkbox;(a=a.legendGroup)&&a.element&&a.translate(c?l:this.legendWidth-l-2*b-4,e),f&&(f.x=l,f.y=e)},destroyItem:function(a){var c=a.checkbox;k(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy())}),c&&H(a.checkbox)},destroy:function(){function a(a){this[a]&&(this[a]=this[a].destroy())}k(this.getAllItems(),function(c){k(["legendItem","legendGroup"],a,c)}),k("clipRect up down pager nav box title group".split(" "),a,this),this.display=null},positionCheckboxes:function(){var c,a=this.group&&this.group.alignAttr,b=this.clipHeight||this.legendHeight,f=this.titleHeight;a&&(c=a.translateY,k(this.allItems,function(e){var g,l=e.checkbox;l&&(g=c+f+l.y+(this.scrollOffset||0)+3,E(l,{left:a.translateX+e.checkboxOffset+l.x-20+"px",top:g+"px",display:g>c-6&&g<c+b-6?"":"none"}))},this))},renderTitle:function(){var a=this.options,c=this.padding,b=a.title,f=0;b.text&&(this.title||(this.title=this.chart.renderer.label(b.text,c-3,c-4,null,null,null,a.useHTML,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group)),f=(a=this.title.getBBox()).height,this.offsetWidth=a.width,this.contentGroup.attr({translateY:f})),this.titleHeight=f},setText:function(e){var c=this.options;e.legendItem.attr({text:c.labelFormat?a.format(c.labelFormat,e):c.labelFormatter.call(e)})},renderItem:function(a){var c=this.chart,b=c.renderer,e=this.options,l="horizontal"===e.layout,f=this.symbolWidth,g=e.symbolPadding,m=this.itemStyle,k=this.itemHiddenStyle,n=this.padding,B=l?u(e.itemDistance,20):0,q=!e.rtl,A=e.width,d=e.itemMarginBottom||0,p=this.itemMarginTop,D=a.legendItem,h=!a.series,y=!h&&a.series.drawLegendSymbol?a.series:a,v=y.options,M=this.createCheckboxForItem&&v&&v.showCheckbox,w=(v=f+g+B+(M?20:0),e.useHTML),N=a.options.className;D||(a.legendGroup=b.g("legend-item").addClass("highcharts-"+y.type+"-series highcharts-color-"+a.colorIndex+(N?" "+N:"")+(h?" highcharts-series-"+a.index:"")).attr({zIndex:1}).add(this.scrollGroup),a.legendItem=D=b.text("",q?f+g:-g,this.baseline||0,w).css(t(a.visible?m:k)).attr({align:q?"left":"right",zIndex:2}).add(a.legendGroup),this.baseline||(f=m.fontSize,this.fontMetrics=b.fontMetrics(f,D),this.baseline=this.fontMetrics.f+3+p,D.attr("y",this.baseline)),this.symbolHeight=e.symbolHeight||this.fontMetrics.f,y.drawLegendSymbol(this,a),this.setItemEvents&&this.setItemEvents(a,D,w),M&&this.createCheckboxForItem(a)),this.colorizeItem(a,a.visible),m.width||D.css({width:(e.itemWidth||e.width||c.spacingBox.width)-v}),this.setText(a),b=D.getBBox(),m=a.checkboxOffset=e.itemWidth||a.legendItemWidth||b.width+v,this.itemHeight=b=Math.round(a.legendItemHeight||b.height||this.symbolHeight),l&&this.itemX-n+m>(A||c.spacingBox.width-2*n-e.x)&&(this.itemX=n,this.itemY+=p+this.lastLineHeight+d,this.lastLineHeight=0),this.maxItemWidth=Math.max(this.maxItemWidth,m),this.lastItemY=p+this.itemY+d,this.lastLineHeight=Math.max(b,this.lastLineHeight),a._legendItemPos=[this.itemX,this.itemY],l?this.itemX+=m:(this.itemY+=p+b+d,this.lastLineHeight=b),this.offsetWidth=A||Math.max((l?this.itemX-n-(a.checkbox?0:B):m)+n,this.offsetWidth)},getAllItems:function(){var a=[];return k(this.chart.series,function(c){var b=c&&c.options;c&&u(b.showInLegend,!v(b.linkedTo)&&void 0,!0)&&(a=a.concat(c.legendItems||("point"===b.legendType?c.data:c)))}),a},getAlignment:function(){var a=this.options;return a.floating?"":a.align.charAt(0)+a.verticalAlign.charAt(0)+a.layout.charAt(0)},adjustMargins:function(a,c){var b=this.chart,e=this.options,l=this.getAlignment();l&&k([/(lth|ct|rth)/,/(rtv|rm|rbv)/,/(rbh|cb|lbh)/,/(lbv|lm|ltv)/],function(f,g){f.test(l)&&!v(a[g])&&(b[w[g]]=Math.max(b[w[g]],b.legend[(g+1)%2?"legendHeight":"legendWidth"]+[1,-1,-1,1][g]*e[g%2?"x":"y"]+u(e.margin,12)+c[g]+(0===g?b.titleOffset+b.options.title.margin:0)))})},render:function(){var l,g,q,x,a=this,c=a.chart,b=c.renderer,f=a.group,F=a.box,n=a.options,B=a.padding;a.itemX=B,a.itemY=a.initialItemY,a.offsetWidth=0,a.lastItemY=0,f||(a.group=f=b.g("legend").attr({zIndex:7}).add(),a.contentGroup=b.g().attr({zIndex:1}).add(f),a.scrollGroup=b.g().add(a.contentGroup)),a.renderTitle(),l=a.getAllItems(),m(l,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)}),n.reversed&&l.reverse(),a.allItems=l,a.display=g=!!l.length,a.lastLineHeight=0,k(l,function(b){a.renderItem(b)}),q=(n.width||a.offsetWidth)+B,x=a.lastItemY+a.lastLineHeight+a.titleHeight,x=a.handleOverflow(x),x+=B,F||(a.box=F=b.rect().addClass("highcharts-legend-box").attr({r:n.borderRadius}).add(f),F.isNew=!0),F.attr({stroke:n.borderColor,"stroke-width":n.borderWidth||0,fill:n.backgroundColor||"none"}).shadow(n.shadow),0<q&&0<x&&(F[F.isNew?"attr":"animate"](F.crisp.call({},{x:0,y:0,width:q,height:x},F.strokeWidth())),F.isNew=!1),F[g?"show":"hide"](),a.legendWidth=q,a.legendHeight=x,k(l,function(b){a.positionItem(b)}),g&&(b=c.spacingBox,/(lth|ct|rth)/.test(a.getAlignment())&&(b=t(b,{y:b.y+c.titleOffset+c.options.title.margin})),f.align(t(n,{width:q,height:x}),!0,b)),c.isResizing||this.positionCheckboxes()},handleOverflow:function(a){var m,p,c=this,e=(b=this.chart).renderer,l=this.options,f=l.y,g=this.padding,b=b.spacingBox.height+("top"===l.verticalAlign?-f:f)-g,F=(f=l.maxHeight,this.clipRect),n=l.navigation,B=u(n.animation,!0),q=n.arrowSize||12,A=this.nav,d=this.pages,D=this.allItems,h=function(a){"number"==typeof a?F.attr({height:a}):F&&(c.clipRect=F.destroy(),c.contentGroup.clip()),c.contentGroup.div&&(c.contentGroup.div.style.clip=a?"rect("+g+"px,9999px,"+(g+a)+"px,0)":"auto")};return"horizontal"!==l.layout||"middle"===l.verticalAlign||l.floating||(b/=2),f&&(b=Math.min(b,f)),d.length=0,a>b&&!1!==n.enabled?(this.clipHeight=m=Math.max(b-20-this.titleHeight-g,0),this.currentPage=u(this.currentPage,1),this.fullHeight=a,k(D,function(a,b){var c=a._legendItemPos[1],h=Math.round(a.legendItem.getBBox().height),e=d.length;(!e||c-d[e-1]>m&&(p||c)!==d[e-1])&&(d.push(p||c),e++),a.pageIx=e-1,p&&(D[b-1].pageIx=e-1),b===D.length-1&&c+h-d[e-1]>m&&(d.push(c),a.pageIx=e),c!==p&&(p=c)}),F||(F=c.clipRect=e.clipRect(0,g,9999,0),c.contentGroup.clip(F)),h(m),A||(this.nav=A=e.g().attr({zIndex:1}).add(this.group),this.up=e.symbol("triangle",0,0,q,q).on("click",function(){c.scroll(-1,B)}).add(A),this.pager=e.text("",15,10).addClass("highcharts-legend-navigation").css(n.style).add(A),this.down=e.symbol("triangle-down",0,0,q,q).on("click",function(){c.scroll(1,B)}).add(A)),c.scroll(0),a=b):A&&(h(),this.nav=A.destroy(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),a},scroll:function(a,c){var b=this.pages,e=b.length;a=this.currentPage+a;var l=this.clipHeight,f=this.options.navigation,g=this.pager,m=this.padding;a>e&&(a=e),0<a&&(void 0!==c&&z(c,this.chart),this.nav.attr({translateX:m,translateY:l+this.padding+7+this.titleHeight,visibility:"visible"}),this.up.attr({class:1===a?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"}),g.attr({text:a+"/"+e}),this.down.attr({x:18+this.pager.getBBox().width,class:a===e?"highcharts-legend-nav-inactive":"highcharts-legend-nav-active"}),this.up.attr({fill:1===a?f.inactiveColor:f.activeColor}).css({cursor:1===a?"default":"pointer"}),this.down.attr({fill:a===e?f.inactiveColor:f.activeColor}).css({cursor:a===e?"default":"pointer"}),this.scrollOffset=-b[a-1]+this.initialItemY,this.scrollGroup.animate({translateY:this.scrollOffset}),this.currentPage=a,this.positionCheckboxes())}},a.LegendSymbolMixin={drawRectangle:function(a,c){var b=a.symbolHeight,e=a.options.squareSymbol;c.legendSymbol=this.chart.renderer.rect(e?(a.symbolWidth-b)/2:0,a.baseline-b+1,e?b:a.symbolWidth,b,u(a.options.symbolRadius,b/2)).addClass("highcharts-point").attr({zIndex:3}).add(c.legendGroup)},drawLineMarker:function(a){var k,c=this.options,b=c.marker,e=a.symbolWidth,l=a.symbolHeight,f=l/2,g=this.chart.renderer,m=this.legendGroup;a=a.baseline-Math.round(.3*a.fontMetrics.b),k={"stroke-width":c.lineWidth||0},c.dashStyle&&(k.dashstyle=c.dashStyle),this.legendLine=g.path(["M",0,a,"L",e,a]).addClass("highcharts-graph").attr(k).add(m),b&&!1!==b.enabled&&(c=Math.min(u(b.radius,f),f),0===this.symbol.indexOf("url")&&(b=t(b,{width:l,height:l}),c=0),this.legendSymbol=b=g.symbol(this.symbol,e/2-c,a-c,2*c,2*c,b).addClass("highcharts-point").add(m),b.isMarker=!0)}},(/Trident\/7\.0/.test(g.navigator.userAgent)||q)&&f(a.Legend.prototype,"positionItem",function(a,c){var b=this,e=function(){c._legendItemPos&&a.call(b,c)};e(),setTimeout(e)})}(L),function(a){var G=a.addEvent,E=a.animate,H=a.animObject,v=a.attr,k=a.doc,q=a.Axis,w=a.createElement,t=a.defaultOptions,u=a.discardElement,z=a.charts,m=a.css,g=a.defined,f=a.each,e=a.extend,c=a.find,b=a.fireEvent,r=a.grep,l=a.isNumber,C=a.isObject,I=a.isString,x=a.Legend,F=a.marginNames,n=a.merge,B=a.objectEach,J=a.Pointer,A=a.pick,d=a.pInt,p=a.removeEvent,D=a.seriesTypes,h=a.splat,y=a.svg,P=a.syncTimeout,M=a.win,O=a.Chart=function(){this.getArgs.apply(this,arguments)};a.chart=function(a,d,b){return new O(a,d,b)},e(O.prototype,{callbacks:[],getArgs:function(){var a=[].slice.call(arguments);(I(a[0])||a[0].nodeName)&&(this.renderTo=a.shift()),this.init(a[0],a[1])},init:function(d,b){var c,h,p=d.series,e=d.plotOptions||{};for(h in d.series=null,(c=n(t,d)).plotOptions)c.plotOptions[h].tooltip=e[h]&&n(e[h].tooltip)||void 0;c.tooltip.userOptions=d.chart&&d.chart.forExport&&d.tooltip.userOptions||d.tooltip,c.series=d.series=p,this.userOptions=d,h=(d=c.chart).events,this.margin=[],this.spacing=[],this.bounds={h:{},v:{}},this.labelCollectors=[],this.callback=b,this.isResizing=0,this.options=c,this.axes=[],this.series=[],this.hasCartesianSeries=d.showAxes;var l=this;l.index=z.length,z.push(l),a.chartCount++,h&&B(h,function(a,d){G(l,d,a)}),l.xAxis=[],l.yAxis=[],l.pointCount=l.colorCounter=l.symbolCounter=0,l.firstRender()},initSeries:function(d){var b=this.options.chart;return(b=D[d.type||b.type||b.defaultSeriesType])||a.error(17,!0),(b=new b).init(this,d),b},orderSeries:function(a){var d=this.series;for(a=a||0;a<d.length;a++)d[a]&&(d[a].index=a,d[a].name=d[a].name||"Series "+(d[a].index+1))},isInsidePlot:function(a,d,b){var c=b?d:a;return a=b?a:d,0<=c&&c<=this.plotWidth&&0<=a&&a<=this.plotHeight},redraw:function(d){var A,g,m,c=this.axes,h=this.series,p=this.pointer,n=this.legend,l=this.isDirtyLegend,y=this.hasCartesianSeries,D=this.isDirtyBox,r=this.renderer,x=r.isHidden(),B=[];for(this.setResponsive&&this.setResponsive(!1),a.setAnimation(d,this),x&&this.temporaryDisplay(),this.layOutTitles(),d=h.length;d--;)if((m=h[d]).options.stacking&&(A=!0,m.isDirty)){g=!0;break}if(g)for(d=h.length;d--;)(m=h[d]).options.stacking&&(m.isDirty=!0);f(h,function(a){a.isDirty&&"point"===a.options.legendType&&(a.updateTotals&&a.updateTotals(),l=!0),a.isDirtyData&&b(a,"updatedData")}),l&&n.options.enabled&&(n.render(),this.isDirtyLegend=!1),A&&this.getStacks(),y&&f(c,function(a){a.updateNames(),a.setScale()}),this.getMargins(),y&&(f(c,function(a){a.isDirty&&(D=!0)}),f(c,function(a){var d=a.min+","+a.max;a.extKey!==d&&(a.extKey=d,B.push(function(){b(a,"afterSetExtremes",e(a.eventArgs,a.getExtremes())),delete a.eventArgs})),(D||A)&&a.redraw()})),D&&this.drawChartBox(),b(this,"predraw"),f(h,function(a){(D||a.isDirty)&&a.visible&&a.redraw(),a.isDirtyData=!1}),p&&p.reset(!0),r.draw(),b(this,"redraw"),b(this,"render"),x&&this.temporaryDisplay(!0),f(B,function(a){a.call()})},get:function(a){function d(d){return d.id===a||d.options&&d.options.id===a}var b,p,h=this.series;for(b=c(this.axes,d)||c(this.series,d),p=0;!b&&p<h.length;p++)b=c(h[p].points||[],d);return b},getAxes:function(){var a=this,b=(d=this.options).xAxis=h(d.xAxis||{}),d=d.yAxis=h(d.yAxis||{});f(b,function(a,d){a.index=d,a.isX=!0}),f(d,function(a,d){a.index=d}),b=b.concat(d),f(b,function(d){new q(a,d)})},getSelectedPoints:function(){var a=[];return f(this.series,function(d){a=a.concat(r(d.data||[],function(a){return a.selected}))}),a},getSelectedSeries:function(){return r(this.series,function(a){return a.selected})},setTitle:function(a,d,b){var p,c=this,h=c.options;p=h.title=n({style:{color:"#333333",fontSize:h.isStock?"16px":"18px"}},h.title,a),h=h.subtitle=n({style:{color:"#666666"}},h.subtitle,d),f([["title",a,p],["subtitle",d,h]],function(a,d){var b=a[0],h=c[b],p=a[1];a=a[2],h&&p&&(c[b]=h=h.destroy()),a&&!h&&(c[b]=c.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,class:"highcharts-"+b,zIndex:a.zIndex||4}).add(),c[b].update=function(a){c.setTitle(!d&&a,d&&a)},c[b].css(a.style))}),c.layOutTitles(b)},layOutTitles:function(a){var b,d=0,c=this.renderer,h=this.spacingBox;f(["title","subtitle"],function(a){var n,b=this[a],p=this.options[a];a="title"===a?-3:p.verticalAlign?0:d+2,b&&(n=p.style.fontSize,n=c.fontMetrics(n,b).b,b.css({width:(p.width||h.width+p.widthAdjust)+"px"}).align(e({y:a+n},p),!1,"spacingBox"),p.floating||p.verticalAlign||(d=Math.ceil(d+b.getBBox(p.useHTML).height)))},this),b=this.titleOffset!==d,this.titleOffset=d,!this.isDirtyBox&&b&&(this.isDirtyBox=b,this.hasRendered&&A(a,!0)&&this.isDirtyBox&&this.redraw())},getChartSize:function(){var b=(d=this.options.chart).width,d=d.height,c=this.renderTo;g(b)||(this.containerWidth=a.getStyle(c,"width")),g(d)||(this.containerHeight=a.getStyle(c,"height")),this.chartWidth=Math.max(0,b||this.containerWidth||600),this.chartHeight=Math.max(0,a.relativeLength(d,this.chartWidth)||(1<this.containerHeight?this.containerHeight:400))},temporaryDisplay:function(d){var b=this.renderTo;if(d)for(;b&&b.style;)b.hcOrigStyle&&(a.css(b,b.hcOrigStyle),delete b.hcOrigStyle),b.hcOrigDetached&&(k.body.removeChild(b),b.hcOrigDetached=!1),b=b.parentNode;else for(;b&&b.style&&(k.body.contains(b)||b.parentNode||(b.hcOrigDetached=!0,k.body.appendChild(b)),("none"===a.getStyle(b,"display",!1)||b.hcOricDetached)&&(b.hcOrigStyle={display:b.style.display,height:b.style.height,overflow:b.style.overflow},d={display:"block",overflow:"hidden"},b!==this.renderTo&&(d.height=0),a.css(b,d),b.offsetWidth||b.style.setProperty("display","block","important")),(b=b.parentNode)!==k.body););},setClassName:function(a){this.container.className="highcharts-container "+(a||"")},getContainer:function(){var b,p,n,c=this.options,h=c.chart;b=this.renderTo;var A,f=a.uniqueKey();b||(this.renderTo=b=h.renderTo),I(b)&&(this.renderTo=b=k.getElementById(b)),b||a.error(13,!0),p=d(v(b,"data-highcharts-chart")),l(p)&&z[p]&&z[p].hasRendered&&z[p].destroy(),v(b,"data-highcharts-chart",this.index),b.innerHTML="",h.skipClone||b.offsetWidth||this.temporaryDisplay(),this.getChartSize(),p=this.chartWidth,n=this.chartHeight,A=e({position:"relative",overflow:"hidden",width:p+"px",height:n+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},h.style),this.container=b=w("div",{id:f},A,b),this._cursor=b.style.cursor,this.renderer=new(a[h.renderer]||a.Renderer)(b,p,n,null,h.forExport,c.exporting&&c.exporting.allowHTML),this.setClassName(h.className),this.renderer.setStyle(h.style),this.renderer.chartIndex=this.index},getMargins:function(a){var d=this.spacing,b=this.margin,c=this.titleOffset;this.resetMargins(),c&&!g(b[0])&&(this.plotTop=Math.max(this.plotTop,c+this.options.title.margin+d[0])),this.legend&&this.legend.display&&this.legend.adjustMargins(b,d),this.extraMargin&&(this[this.extraMargin.type]=(this[this.extraMargin.type]||0)+this.extraMargin.value),this.adjustPlotArea&&this.adjustPlotArea(),a||this.getAxisMargins()},getAxisMargins:function(){var a=this,d=a.axisOffset=[0,0,0,0],b=a.margin;a.hasCartesianSeries&&f(a.axes,function(a){a.visible&&a.getOffset()}),f(F,function(c,h){g(b[h])||(a[c]+=d[h])}),a.setChartSize()},reflow:function(d){var b=this,c=b.options.chart,h=b.renderTo,p=g(c.width)&&g(c.height),e=c.width||a.getStyle(h,"width");c=c.height||a.getStyle(h,"height"),h=d?d.target:M;p||b.isPrinting||!e||!c||h!==M&&h!==k||(e===b.containerWidth&&c===b.containerHeight||(clearTimeout(b.reflowTimeout),b.reflowTimeout=P(function(){b.container&&b.setSize(void 0,void 0,!1)},d?100:0)),b.containerWidth=e,b.containerHeight=c)},initReflow:function(){var d,a=this;d=G(M,"resize",function(d){a.reflow(d)}),G(a,"destroy",d)},setSize:function(d,c,h){var p=this,e=p.renderer;p.isResizing+=1,a.setAnimation(h,p),p.oldChartHeight=p.chartHeight,p.oldChartWidth=p.chartWidth,void 0!==d&&(p.options.chart.width=d),void 0!==c&&(p.options.chart.height=c),p.getChartSize(),((d=e.globalAnimation)?E:m)(p.container,{width:p.chartWidth+"px",height:p.chartHeight+"px"},d),p.setChartSize(!0),e.setSize(p.chartWidth,p.chartHeight,h),f(p.axes,function(a){a.isDirty=!0,a.setScale()}),p.isDirtyLegend=!0,p.isDirtyBox=!0,p.layOutTitles(),p.getMargins(),p.redraw(h),p.oldChartHeight=null,b(p,"resize"),P(function(){p&&b(p,"endResize",null,function(){--p.isResizing})},H(d).duration)},setChartSize:function(a){var l,A,g,y,d=this.inverted,b=this.renderer,c=this.chartWidth,h=this.chartHeight,p=this.options.chart,e=this.spacing,n=this.clipOffset;this.plotLeft=l=Math.round(this.plotLeft),this.plotTop=A=Math.round(this.plotTop),this.plotWidth=g=Math.max(0,Math.round(c-l-this.marginRight)),this.plotHeight=y=Math.max(0,Math.round(h-A-this.marginBottom)),this.plotSizeX=d?y:g,this.plotSizeY=d?g:y,this.plotBorderWidth=p.plotBorderWidth||0,this.spacingBox=b.spacingBox={x:e[3],y:e[0],width:c-e[3]-e[1],height:h-e[0]-e[2]},this.plotBox=b.plotBox={x:l,y:A,width:g,height:y},c=2*Math.floor(this.plotBorderWidth/2),d=Math.ceil(Math.max(c,n[3])/2),b=Math.ceil(Math.max(c,n[0])/2),this.clipBox={x:d,y:b,width:Math.floor(this.plotSizeX-Math.max(c,n[1])/2-d),height:Math.max(0,Math.floor(this.plotSizeY-Math.max(c,n[2])/2-b))},a||f(this.axes,function(a){a.setAxisSize(),a.setAxisTranslation()})},resetMargins:function(){var a=this,d=a.options.chart;f(["margin","spacing"],function(b){var c=d[b],h=C(c)?c:[c,c,c,c];f(["Top","Right","Bottom","Left"],function(c,p){a[b][p]=A(d[b+c],h[p])})}),f(F,function(d,b){a[d]=A(a.margin[b],a.spacing[b])}),a.axisOffset=[0,0,0,0],a.clipOffset=[0,0,0,0]},drawChartBox:function(){var n,y,a=this.options.chart,d=this.renderer,b=this.chartWidth,c=this.chartHeight,h=this.chartBackground,p=this.plotBackground,e=this.plotBorder,l=this.plotBGImage,A=a.backgroundColor,f=a.plotBackgroundColor,g=a.plotBackgroundImage,D=this.plotLeft,m=this.plotTop,r=this.plotWidth,x=this.plotHeight,B=this.plotBox,k=this.clipRect,F=this.clipBox,q="animate";h||(this.chartBackground=h=d.rect().addClass("highcharts-background").add(),q="attr"),y=(n=a.borderWidth||0)+(a.shadow?8:0),A={fill:A||"none"},(n||h["stroke-width"])&&(A.stroke=a.borderColor,A["stroke-width"]=n),h.attr(A).shadow(a.shadow),h[q]({x:y/2,y:y/2,width:b-y-n%2,height:c-y-n%2,r:a.borderRadius}),q="animate",p||(q="attr",this.plotBackground=p=d.rect().addClass("highcharts-plot-background").add()),p[q](B),p.attr({fill:f||"none"}).shadow(a.plotShadow),g&&(l?l.animate(B):this.plotBGImage=d.image(g,D,m,r,x).add()),k?k.animate({width:F.width,height:F.height}):this.clipRect=d.clipRect(F),q="animate",e||(q="attr",this.plotBorder=e=d.rect().addClass("highcharts-plot-border").attr({zIndex:1}).add()),e.attr({stroke:a.plotBorderColor,"stroke-width":a.plotBorderWidth||0,fill:"none"}),e[q](e.crisp({x:D,y:m,width:r,height:x},-e.strokeWidth())),this.isDirtyBox=!1},propFromSeries:function(){var b,h,p,a=this,d=a.options.chart,c=a.options.series;f(["inverted","angular","polar"],function(e){for(b=D[d.type||d.defaultSeriesType],p=d[e]||b&&b.prototype[e],h=c&&c.length;!p&&h--;)(b=D[c[h].type])&&b.prototype[e]&&(p=!0);a[e]=p})},linkSeries:function(){var a=this,d=a.series;f(d,function(a){a.linkedSeries.length=0}),f(d,function(d){var b=d.options.linkedTo;I(b)&&(b=":previous"===b?a.series[d.index-1]:a.get(b))&&b.linkedParent!==d&&(b.linkedSeries.push(d),d.linkedParent=b,d.visible=A(d.options.visible,b.options.visible,d.visible))})},renderSeries:function(){f(this.series,function(a){a.translate(),a.render()})},renderLabels:function(){var a=this,b=a.options.labels;b.items&&f(b.items,function(c){var h=e(b.style,c.style),p=d(h.left)+a.plotLeft,n=d(h.top)+a.plotTop+12;delete h.left,delete h.top,a.renderer.text(c.html,p,n).attr({zIndex:2}).css(h).add()})},render:function(){var c,h,p,a=this.axes,d=this.renderer,b=this.options;this.setTitle(),this.legend=new x(this,b.legend),this.getStacks&&this.getStacks(),this.getMargins(!0),this.setChartSize(),b=this.plotWidth,c=this.plotHeight=Math.max(this.plotHeight-21,0),f(a,function(a){a.setScale()}),this.getAxisMargins(),h=1.1<b/this.plotWidth,p=1.05<c/this.plotHeight,(h||p)&&(f(a,function(a){(a.horiz&&h||!a.horiz&&p)&&a.setTickInterval(!0)}),this.getMargins()),this.drawChartBox(),this.hasCartesianSeries&&f(a,function(a){a.visible&&a.render()}),this.seriesGroup||(this.seriesGroup=d.g("series-group").attr({zIndex:3}).add()),this.renderSeries(),this.renderLabels(),this.addCredits(),this.setResponsive&&this.setResponsive(),this.hasRendered=!0},addCredits:function(a){var d=this;(a=n(!0,this.options.credits,a)).enabled&&!this.credits&&(this.credits=this.renderer.text(a.text+(this.mapCredits||""),0,0).addClass("highcharts-credits").on("click",function(){a.href&&(M.location.href=a.href)}).attr({align:a.position.align,zIndex:8}).css(a.style).add().align(a.position),this.credits.update=function(a){d.credits=d.credits.destroy(),d.addCredits(a)})},destroy:function(){var n,d=this,c=d.axes,h=d.series,e=d.container,l=e&&e.parentNode;for(b(d,"destroy"),d.renderer.forExport?a.erase(z,d):z[d.index]=void 0,a.chartCount--,d.renderTo.removeAttribute("data-highcharts-chart"),p(d),n=c.length;n--;)c[n]=c[n].destroy();for(this.scroller&&this.scroller.destroy&&this.scroller.destroy(),n=h.length;n--;)h[n]=h[n].destroy();f("title subtitle chartBackground plotBackground plotBGImage plotBorder seriesGroup clipRect credits pointer rangeSelector legend resetZoomButton tooltip renderer".split(" "),function(a){var b=d[a];b&&b.destroy&&(d[a]=b.destroy())}),e&&(e.innerHTML="",p(e),l&&u(e)),B(d,function(a,b){delete d[b]})},isReadyToRender:function(){var a=this;return!(!y&&M==M.top&&"complete"!==k.readyState)||(k.attachEvent("onreadystatechange",function(){k.detachEvent("onreadystatechange",a.firstRender),"complete"===k.readyState&&a.firstRender()}),!1)},firstRender:function(){var a=this,d=a.options;a.isReadyToRender()&&(a.getContainer(),b(a,"init"),a.resetMargins(),a.setChartSize(),a.propFromSeries(),a.getAxes(),f(d.series||[],function(d){a.initSeries(d)}),a.linkSeries(),b(a,"beforeRender"),J&&(a.pointer=new J(a,d)),a.render(),!a.renderer.imgCount&&a.onload&&a.onload(),a.temporaryDisplay(!0))},onload:function(){f([this.callback].concat(this.callbacks),function(a){a&&void 0!==this.index&&a.apply(this,[this])},this),b(this,"load"),b(this,"render"),g(this.index)&&!1!==this.options.chart.reflow&&this.initReflow(),this.onload=null}})}(L),function(a){var G,E=a.each,H=a.extend,v=a.erase,k=a.fireEvent,q=a.format,w=a.isArray,t=a.isNumber,u=a.pick,z=a.removeEvent;a.Point=G=function(){},a.Point.prototype={init:function(a,g,f){return this.series=a,this.color=a.color,this.applyOptions(g,f),a.options.colorByPoint?(g=a.options.colors||a.chart.options.colors,this.color=this.color||g[a.colorCounter],g=g.length,f=a.colorCounter,a.colorCounter++,a.colorCounter===g&&(a.colorCounter=0)):f=a.colorIndex,this.colorIndex=u(this.colorIndex,f),a.chart.pointCount++,this},applyOptions:function(a,g){var f=this.series,e=f.options.pointValKey||f.pointValKey;return a=G.prototype.optionsToObject.call(this,a),H(this,a),this.options=this.options?H(this.options,a):a,a.group&&delete this.group,e&&(this.y=this[e]),this.isNull=u(this.isValid&&!this.isValid(),null===this.x||!t(this.y,!0)),this.selected&&(this.state="select"),"name"in this&&void 0===g&&f.xAxis&&f.xAxis.hasNames&&(this.x=f.xAxis.nameToX(this)),void 0===this.x&&f&&(this.x=void 0===g?f.autoIncrement(this):g),this},optionsToObject:function(a){var g={},f=this.series,e=f.options.keys,c=e||f.pointArrayMap||["y"],b=c.length,m=0,l=0;if(t(a)||null===a)g[c[0]]=a;else if(w(a))for(!e&&a.length>b&&("string"===(f=typeof a[0])?g.name=a[0]:"number"===f&&(g.x=a[0]),m++);l<b;)e&&void 0===a[m]||(g[c[l]]=a[m]),m++,l++;else"object"==typeof a&&(g=a,a.dataLabels&&(f._hasPointLabels=!0),a.marker&&(f._hasPointMarkers=!0));return g},getClassName:function(){return"highcharts-point"+(this.selected?" highcharts-point-select":"")+(this.negative?" highcharts-negative":"")+(this.isNull?" highcharts-null-point":"")+(void 0!==this.colorIndex?" highcharts-color-"+this.colorIndex:"")+(this.options.className?" "+this.options.className:"")+(this.zone&&this.zone.className?" "+this.zone.className.replace("highcharts-negative",""):"")},getZone:function(){var e,g=(a=this.series).zones,a=a.zoneAxis||"y",f=0;for(e=g[f];this[a]>=e.value;)e=g[++f];return e&&e.color&&!this.options.color&&(this.color=e.color),e},destroy:function(){var f,a=this.series.chart,g=a.hoverPoints;for(f in a.pointCount--,g&&(this.setState(),v(g,this),g.length||(a.hoverPoints=null)),this===a.hoverPoint&&this.onMouseOut(),(this.graphic||this.dataLabel)&&(z(this),this.destroyElements()),this.legendItem&&a.legend.destroyItem(this),this)this[f]=null},destroyElements:function(){for(var g,a=["graphic","dataLabel","dataLabelUpper","connector","shadowGroup"],f=6;f--;)this[g=a[f]]&&(this[g]=this[g].destroy())},getLabelConfig:function(){return{x:this.category,y:this.y,color:this.color,colorIndex:this.colorIndex,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},tooltipFormatter:function(a){var g=this.series,f=g.tooltipOptions,e=u(f.valueDecimals,""),c=f.valuePrefix||"",b=f.valueSuffix||"";return E(g.pointArrayMap||["y"],function(f){f="{point."+f,(c||b)&&(a=a.replace(f+"}",c+f+"}"+b)),a=a.replace(f+"}",f+":,."+e+"f}")}),q(a,{point:this,series:this.series})},firePointEvent:function(a,g,f){var e=this,c=this.series.options;(c.point.events[a]||e.options&&e.options.events&&e.options.events[a])&&this.importEvents(),"click"===a&&c.allowPointSelect&&(f=function(a){e.select&&e.select(null,a.ctrlKey||a.metaKey||a.shiftKey)}),k(this,a,g,f)},visible:!0}}(L),function(a){var G=a.addEvent,E=a.animObject,H=a.arrayMax,v=a.arrayMin,k=a.correctFloat,q=a.Date,w=a.defaultOptions,t=a.defaultPlotOptions,u=a.defined,z=a.each,m=a.erase,g=a.extend,f=a.fireEvent,e=a.grep,c=a.isArray,b=a.isNumber,r=a.isString,l=a.merge,C=a.objectEach,I=a.pick,x=a.removeEvent,F=a.splat,n=a.SVGElement,B=a.syncTimeout,J=a.win;a.Series=a.seriesType("line",null,{lineWidth:2,allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},marker:{lineWidth:0,lineColor:"#ffffff",radius:4,states:{hover:{animation:{duration:50},enabled:!0,radiusPlus:2,lineWidthPlus:1},select:{fillColor:"#cccccc",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:{align:"center",formatter:function(){return null===this.y?"":a.numberFormat(this.y,-1)},style:{fontSize:"11px",fontWeight:"bold",color:"contrast",textOutline:"1px contrast"},verticalAlign:"bottom",x:0,y:0,padding:5},cropThreshold:300,pointRange:0,softThreshold:!0,states:{hover:{animation:{duration:50},lineWidthPlus:1,marker:{},halo:{size:10,opacity:.25}},select:{marker:{}}},stickyTracking:!0,turboThreshold:1e3,findNearestPointBy:"x"},{isCartesian:!0,pointClass:a.Point,sorted:!0,requireSorting:!0,directTouch:!1,axisTypes:["xAxis","yAxis"],colorCounter:0,parallelArrays:["x","y"],coll:"series",init:function(a,d){var c,e,b=this,h=a.series;b.chart=a,b.options=d=b.setOptions(d),b.linkedSeries=[],b.bindAxes(),g(b,{name:d.name,state:"",visible:!1!==d.visible,selected:!0===d.selected}),c=d.events,C(c,function(a,d){G(b,d,a)}),(c&&c.click||d.point&&d.point.events&&d.point.events.click||d.allowPointSelect)&&(a.runTrackerClick=!0),b.getColor(),b.getSymbol(),z(b.parallelArrays,function(a){b[a+"Data"]=[]}),b.setData(d.data,!1),b.isCartesian&&(a.hasCartesianSeries=!0),h.length&&(e=h[h.length-1]),b._i=I(e&&e._i,-1)+1,a.orderSeries(this.insert(h))},insert:function(a){var c,d=this.options.index;if(b(d)){for(c=a.length;c--;)if(d>=I(a[c].options.index,a[c]._i)){a.splice(c+1,0,this);break}-1===c&&a.unshift(this),c+=1}else a.push(this);return I(c,a.length-1)},bindAxes:function(){var e,b=this,d=b.options,c=b.chart;z(b.axisTypes||[],function(h){z(c[h],function(a){e=a.options,(d[h]===e.index||void 0!==d[h]&&d[h]===e.id||void 0===d[h]&&0===e.index)&&(b.insert(a.series),b[h]=a,a.isDirty=!0)}),b[h]||b.optionalAxis===h||a.error(18,!0)})},updateParallelArrays:function(a,d){var c=a.series,e=arguments,h=b(d)?function(b){var h="y"===b&&c.toYData?c.toYData(a):a[b];c[b+"Data"][d]=h}:function(a){Array.prototype[d].apply(c[a+"Data"],Array.prototype.slice.call(e,2))};z(c.parallelArrays,h)},autoIncrement:function(){var c,b=this.options,d=this.xIncrement,e=b.pointIntervalUnit,h=0;d=I(d,b.pointStart,0);return this.pointInterval=c=I(this.pointInterval,b.pointInterval,1),e&&(b=new q(d),"day"===e?b=+b[q.hcSetDate](b[q.hcGetDate]()+c):"month"===e?b=+b[q.hcSetMonth](b[q.hcGetMonth]()+c):"year"===e&&(b=+b[q.hcSetFullYear](b[q.hcGetFullYear]()+c)),q.hcHasTimeZone&&(h=a.getTZOffset(b)-a.getTZOffset(d)),c=b-d+h),this.xIncrement=d+c,d},setOptions:function(a){var d=this.chart,b=d.options,c=b.plotOptions,h=(d.userOptions||{}).plotOptions||{},e=c[this.type];return this.userOptions=a,d=l(e,c.series,a),this.tooltipOptions=l(w.tooltip,w.plotOptions.series&&w.plotOptions.series.tooltip,w.plotOptions[this.type].tooltip,b.tooltip.userOptions,c.series&&c.series.tooltip,c[this.type].tooltip,a.tooltip),this.stickyTracking=I(a.stickyTracking,h[this.type]&&h[this.type].stickyTracking,h.series&&h.series.stickyTracking,!(!this.tooltipOptions.shared||this.noSharedTooltip)||d.stickyTracking),null===e.marker&&delete d.marker,this.zoneAxis=d.zoneAxis,a=this.zones=(d.zones||[]).slice(),!d.negativeColor&&!d.negativeFillColor||d.zones||a.push({value:d[this.zoneAxis+"Threshold"]||d.threshold||0,className:"highcharts-negative",color:d.negativeColor,fillColor:d.negativeFillColor}),a.length&&u(a[a.length-1].value)&&a.push({color:this.color,fillColor:this.fillColor}),d},getCyclic:function(a,d,b){var c,h=this.chart,p=this.userOptions,e=a+"Index",n=a+"Counter",l=b?b.length:I(h.options.chart[a+"Count"],h[a+"Count"]);d||(c=I(p[e],p["_"+e]),u(c)||(h.series.length||(h[n]=0),p["_"+e]=c=h[n]%l,h[n]+=1),b&&(d=b[c])),void 0!==c&&(this[e]=c),this[a]=d},getColor:function(){this.options.colorByPoint?this.options.color=null:this.getCyclic("color",this.options.color||t[this.type].color,this.chart.options.colors)},getSymbol:function(){this.getCyclic("symbol",this.options.marker.symbol,this.chart.options.symbols)},drawLegendSymbol:a.LegendSymbolMixin.drawLineMarker,setData:function(e,d,p,n){var g,h=this,l=h.points,f=l&&l.length||0,A=h.options,D=h.chart,m=null,x=h.xAxis,B=A.turboThreshold,k=this.xData,q=this.yData,F=(g=h.pointArrayMap)&&g.length;if(g=(e=e||[]).length,d=I(d,!0),!1!==n&&g&&f===g&&!h.cropped&&!h.hasGroupedData&&h.visible)z(e,function(a,d){l[d].update&&a!==A.data[d]&&l[d].update(a,!1,null,!1)});else{if(h.xIncrement=null,h.colorCounter=0,z(this.parallelArrays,function(a){h[a+"Data"].length=0}),B&&g>B){for(p=0;null===m&&p<g;)m=e[p],p++;if(b(m))for(p=0;p<g;p++)k[p]=this.autoIncrement(),q[p]=e[p];else if(c(m))if(F)for(p=0;p<g;p++)m=e[p],k[p]=m[0],q[p]=m.slice(1,F+1);else for(p=0;p<g;p++)m=e[p],k[p]=m[0],q[p]=m[1];else a.error(12)}else for(p=0;p<g;p++)void 0!==e[p]&&(m={series:h},h.pointClass.prototype.applyOptions.apply(m,[e[p]]),h.updateParallelArrays(m,p));for(q&&r(q[0])&&a.error(14,!0),h.data=[],h.options.data=h.userOptions.data=e,p=f;p--;)l[p]&&l[p].destroy&&l[p].destroy();x&&(x.minRange=x.userMinRange),h.isDirty=D.isDirtyBox=!0,h.isDirtyData=!!l,p=!1}"point"===A.legendType&&(this.processData(),this.generatePoints()),d&&D.redraw(p)},processData:function(b){var h,d=this.xData,c=this.yData,e=d.length;h=0;var n,l,g,f=this.xAxis;g=(A=this.options).cropThreshold;var k,q,m=this.getExtremesFromAll||A.getExtremesFromAll,x=this.isCartesian,A=f&&f.val2lin,B=f&&f.isLog,r=this.requireSorting;if(x&&!this.isDirty&&!f.isDirty&&!this.yAxis.isDirty&&!b)return!1;for(f&&(k=(b=f.getExtremes()).min,q=b.max),x&&this.sorted&&!m&&(!g||e>g||this.forceCrop)&&(d[e-1]<k||d[0]>q?(d=[],c=[]):(d[0]<k||d[e-1]>q)&&(d=(h=this.cropData(this.xData,this.yData,k,q)).xData,c=h.yData,h=h.start,n=!0)),g=d.length||1;--g;)0<(e=B?A(d[g])-A(d[g-1]):d[g]-d[g-1])&&(void 0===l||e<l)?l=e:0>e&&r&&(a.error(15),r=!1);this.cropped=n,this.cropStart=h,this.processedXData=d,this.processedYData=c,this.closestPointRange=l},cropData:function(a,d,b,c){var l,h=a.length,p=0,e=h,n=I(this.cropShoulder,1);for(l=0;l<h;l++)if(a[l]>=b){p=Math.max(0,l-n);break}for(b=l;b<h;b++)if(a[b]>c){e=b+n;break}return{xData:a.slice(p,e),yData:d.slice(p,e),start:p,end:e}},generatePoints:function(){var c,g,x,r,d=(a=this.options).data,b=this.data,h=this.processedXData,e=this.processedYData,n=this.pointClass,l=h.length,f=this.cropStart||0,m=this.hasGroupedData,a=a.keys,B=[];for(b||m||((b=[]).length=d.length,b=this.data=b),a&&m&&(this.options.keys=!1),r=0;r<l;r++)g=f+r,m?(x=(new n).init(this,[h[r]].concat(F(e[r])))).dataGroup=this.groupMap[r]:(x=b[g])||void 0===d[g]||(b[g]=x=(new n).init(this,d[g],h[r])),x&&(x.index=g,B[r]=x);if(this.options.keys=a,b&&(l!==(c=b.length)||m))for(r=0;r<c;r++)r!==f||m||(r+=l),b[r]&&(b[r].destroyElements(),b[r].plotX=void 0);this.data=b,this.points=B},getExtremes:function(a){var e,g,A,m,r,d=this.yAxis,p=this.processedXData,h=[],n=0,l=(e=this.xAxis.getExtremes()).min,f=e.max;for(e=(a=a||this.stackedYData||this.processedYData||[]).length,r=0;r<e;r++)if(A=p[r],m=a[r],g=(b(m,!0)||c(m))&&(!d.positiveValuesOnly||m.length||0<m),A=this.getExtremesFromAll||this.options.getExtremesFromAll||this.cropped||(p[r+1]||A)>=l&&(p[r-1]||A)<=f,g&&A)if(g=m.length)for(;g--;)"number"==typeof m[g]&&(h[n++]=m[g]);else h[n++]=m;this.dataMin=v(h),this.dataMax=H(h)},translate:function(){this.processedXData||this.processData(),this.generatePoints();var B,q,F,t,a=this.options,d=a.stacking,c=this.xAxis,e=c.categories,h=this.yAxis,n=this.points,l=n.length,f=!!this.modifyValue,g=a.pointPlacement,m="between"===g||b(g),r=a.threshold,x=a.startFromThreshold?r:0,C=Number.MAX_VALUE;for("between"===g&&(g=.5),b(g)&&(g*=I(a.pointRange||c.pointRange)),a=0;a<l;a++){var J=n[a],v=J.x,w=J.y;q=J.low;var E,z=d&&h.stacks[(this.negStacks&&w<(x?0:r)?"-":"")+this.stackKey];h.positiveValuesOnly&&null!==w&&0>=w&&(J.isNull=!0),J.plotX=B=k(Math.min(Math.max(-1e5,c.translate(v,0,0,0,1,g,"flags"===this.type)),1e5)),d&&this.visible&&!J.isNull&&z&&z[v]&&(t=this.getStackIndicator(t,v,this.index),q=(w=(E=z[v]).points[t.key])[0],w=w[1],q===x&&t.key===z[v].base&&(q=I(r,h.min)),h.positiveValuesOnly&&0>=q&&(q=null),J.total=J.stackTotal=E.total,J.percentage=E.total&&J.y/E.total*100,J.stackY=w,E.setOffset(this.pointXOffset||0,this.barW||0)),J.yBottom=u(q)?h.translate(q,0,1,0,1):null,f&&(w=this.modifyValue(w,J)),J.plotY=q="number"==typeof w&&1/0!==w?Math.min(Math.max(-1e5,h.translate(w,0,1,0,1)),1e5):void 0,J.isInside=void 0!==q&&0<=q&&q<=h.len&&0<=B&&B<=c.len,J.clientX=m?k(c.translate(v,0,0,0,1,g)):B,J.negative=J.y<(r||0),J.category=e&&void 0!==e[J.x]?e[J.x]:J.x,J.isNull||(void 0!==F&&(C=Math.min(C,Math.abs(B-F))),F=B),J.zone=this.zones.length&&J.getZone()}this.closestPointRangePx=C},getValidPoints:function(a,d){var b=this.chart;return e(a||this.points||[],function(a){return!(d&&!b.isInsidePlot(a.plotX,a.plotY,b.inverted))&&!a.isNull})},setClip:function(a){var d=this.chart,b=this.options,c=d.renderer,h=d.inverted,e=this.clipBox,n=e||d.clipBox,l=this.sharedClipKey||["_sharedClip",a&&a.duration,a&&a.easing,n.height,b.xAxis,b.yAxis].join(),f=d[l],g=d[l+"m"];f||(a&&(n.width=0,h&&(n.x=d.plotSizeX),d[l+"m"]=g=c.clipRect(h?d.plotSizeX+99:-99,h?-d.plotLeft:-d.plotTop,99,h?d.chartWidth:d.chartHeight)),d[l]=f=c.clipRect(n),f.count={length:0}),a&&!f.count[this.index]&&(f.count[this.index]=!0,f.count.length+=1),!1!==b.clip&&(this.group.clip(a||e?f:d.clipRect),this.markerGroup.clip(g),this.sharedClipKey=l),a||(f.count[this.index]&&(delete f.count[this.index],--f.count.length),0===f.count.length&&l&&d[l]&&(e||(d[l]=d[l].destroy()),d[l+"m"]&&(d[l+"m"]=d[l+"m"].destroy())))},animate:function(a){var c,d=this.chart,b=E(this.options.animation);a?this.setClip(b):((a=d[c=this.sharedClipKey])&&a.animate({width:d.plotSizeX,x:0},b),d[c+"m"]&&d[c+"m"].animate({width:d.plotSizeX+99,x:0},b),this.animate=null)},afterAnimate:function(){this.setClip(),f(this,"afterAnimate"),this.finishedAnimating=!0},drawPoints:function(){var b,c,h,e,l,f,g,r,a=this.points,d=this.chart,n=this.options.marker,m=this[this.specialGroup]||this.markerGroup,x=I(n.enabled,!!this.xAxis.isRadial||null,this.closestPointRangePx>=2*n.radius);if(!1!==n.enabled||this._hasPointMarkers)for(b=0;b<a.length;b++)e=(c=a[b]).graphic,l=c.marker||{},f=!!c.marker,h=x&&void 0===l.enabled||l.enabled,g=c.isInside,h&&!c.isNull?(h=I(l.symbol,this.symbol),c.hasImage=0===h.indexOf("url"),r=this.markerAttribs(c,c.selected&&"select"),e?e[g?"show":"hide"](!0).animate(r):g&&(0<r.width||c.hasImage)&&(c.graphic=e=d.renderer.symbol(h,r.x,r.y,r.width,r.height,f?l:n).add(m)),e&&e.attr(this.pointAttribs(c,c.selected&&"select")),e&&e.addClass(c.getClassName(),!0)):e&&(c.graphic=e.destroy())},markerAttribs:function(a,d){var b=this.options.marker,c=a.marker||{},h=I(c.radius,b.radius);return d&&(b=b.states[d],d=c.states&&c.states[d],h=I(d&&d.radius,b&&b.radius,h+(b&&b.radiusPlus||0))),a.hasImage&&(h=0),a={x:Math.floor(a.plotX)-h,y:a.plotY-h},h&&(a.width=a.height=2*h),a},pointAttribs:function(a,d){var b=this.options.marker,h=(c=a&&a.options)&&c.marker||{},e=this.color,n=c&&c.color,l=a&&a.color,c=I(h.lineWidth,b.lineWidth);return a=a&&a.zone&&a.zone.color,e=n||a||l||e,a=h.fillColor||b.fillColor||e,e=h.lineColor||b.lineColor||e,d&&(b=b.states[d],d=h.states&&h.states[d]||{},c=I(d.lineWidth,b.lineWidth,c+I(d.lineWidthPlus,b.lineWidthPlus,0)),a=d.fillColor||b.fillColor||a,e=d.lineColor||b.lineColor||e),{stroke:e,"stroke-width":c,fill:a}},destroy:function(){var h,l,g,a=this,d=a.chart,b=/AppleWebKit\/533/.test(J.navigator.userAgent),e=a.data||[];for(f(a,"destroy"),x(a),z(a.axisTypes||[],function(d){(g=a[d])&&g.series&&(m(g.series,a),g.isDirty=g.forceRedraw=!0)}),a.legendItem&&a.chart.legend.destroyItem(a),h=e.length;h--;)(l=e[h])&&l.destroy&&l.destroy();a.points=null,clearTimeout(a.animationTimeout),C(a,function(a,d){a instanceof n&&!a.survive&&a[b&&"group"===d?"hide":"destroy"]()}),d.hoverSeries===a&&(d.hoverSeries=null),m(d.series,a),d.orderSeries(),C(a,function(d,b){delete a[b]})},getGraphPath:function(a,d,b){var p,f,c=this,h=c.options,e=h.step,n=[],l=[];return(p=(a=a||c.points).reversed)&&a.reverse(),(e={right:1,center:2}[e]||e&&3)&&p&&(e=4-e),!h.connectNulls||d||b||(a=this.getValidPoints(a)),z(a,function(p,g){var m=p.plotX,r=p.plotY,A=a[g-1];(p.leftCliff||A&&A.rightCliff)&&!b&&(f=!0),p.isNull&&!u(d)&&0<g?f=!h.connectNulls:p.isNull&&!d?f=!0:(0===g||f?g=["M",p.plotX,p.plotY]:c.getPointSpline?g=c.getPointSpline(a,p,g):e?(g=1===e?["L",A.plotX,r]:2===e?["L",(A.plotX+m)/2,A.plotY,"L",(A.plotX+m)/2,r]:["L",m,A.plotY]).push("L",m,r):g=["L",m,r],l.push(p.x),e&&l.push(p.x),n.push.apply(n,g),f=!1)}),n.xMap=l,c.graphPath=n},drawGraph:function(){var a=this,d=this.options,b=(this.gappedPath||this.getGraphPath).call(this),c=[["graph","highcharts-graph",d.lineColor||this.color,d.dashStyle]];z(this.zones,function(b,e){c.push(["zone-graph-"+e,"highcharts-graph highcharts-zone-graph-"+e+" "+(b.className||""),b.color||a.color,b.dashStyle||d.dashStyle])}),z(c,function(c,e){var h=c[0],p=a[h];p?(p.endX=a.preventGraphAnimation?null:b.xMap,p.animate({d:b})):b.length&&(a[h]=a.chart.renderer.path(b).addClass(c[1]).attr({zIndex:1}).add(a.group),p={stroke:c[2],"stroke-width":d.lineWidth,fill:a.fillGraph&&a.color||"none"},c[3]?p.dashstyle=c[3]:"square"!==d.linecap&&(p["stroke-linecap"]=p["stroke-linejoin"]="round"),p=a[h].attr(p).shadow(2>e&&d.shadow)),p&&(p.startX=b.xMap,p.isArea=b.isArea)})},applyZones:function(){var h,e,l,x,B,q,F,t,C,a=this,d=this.chart,b=d.renderer,c=this.zones,n=this.clips||[],f=this.graph,g=this.area,m=Math.max(d.chartWidth,d.chartHeight),r=this[(this.zoneAxis||"y")+"Axis"],k=d.inverted,u=!1;c.length&&(f||g)&&r&&void 0!==r.min&&(B=r.reversed,q=r.horiz,f&&f.hide(),g&&g.hide(),x=r.getExtremes(),z(c,function(c,p){h=B?q?d.plotWidth:0:q?0:r.toPixels(x.min),h=Math.min(Math.max(I(e,h),0),m),e=Math.min(Math.max(Math.round(r.toPixels(I(c.value,x.max),!0)),0),m),u&&(h=e=r.toPixels(x.max)),F=Math.abs(h-e),t=Math.min(h,e),C=Math.max(h,e),r.isXAxis?(l={x:k?C:t,y:0,width:F,height:m},q||(l.x=d.plotHeight-l.x)):(l={x:0,y:k?C:t,width:m,height:F},q&&(l.y=d.plotWidth-l.y)),k&&b.isVML&&(l=r.isXAxis?{x:0,y:B?t:C,height:l.width,width:d.chartWidth}:{x:l.y-d.plotLeft-d.spacingBox.x,y:0,width:l.height,height:d.chartHeight}),n[p]?n[p].animate(l):(n[p]=b.clipRect(l),f&&a["zone-graph-"+p].clip(n[p]),g&&a["zone-area-"+p].clip(n[p])),u=c.value>x.max}),this.clips=n)},invertGroups:function(a){function d(){z(["group","markerGroup"],function(d){b[d]&&(c.renderer.isVML&&b[d].attr({width:b.yAxis.len,height:b.xAxis.len}),b[d].width=b.yAxis.len,b[d].height=b.xAxis.len,b[d].invert(a))})}var h,b=this,c=b.chart;b.xAxis&&(h=G(c,"resize",d),G(b,"destroy",h),d(),b.invertGroups=d)},plotGroup:function(a,d,b,c,h){var e=this[a],p=!e;return p&&(this[a]=e=this.chart.renderer.g().attr({zIndex:c||.1}).add(h)),e.addClass("highcharts-"+d+" highcharts-series-"+this.index+" highcharts-"+this.type+"-series "+(u(this.colorIndex)?"highcharts-color-"+this.colorIndex+" ":"")+(this.options.className||"")+(e.hasClass("highcharts-tracker")?" highcharts-tracker":""),!0),e.attr({visibility:b})[p?"attr":"animate"](this.getPlotBox()),e},getPlotBox:function(){var a=this.chart,d=this.xAxis,b=this.yAxis;return a.inverted&&(d=b,b=this.xAxis),{translateX:d?d.left:a.plotLeft,translateY:b?b.top:a.plotTop,scaleX:1,scaleY:1}},render:function(){var b,a=this,d=a.chart,c=a.options,h=!!a.animate&&d.renderer.isSVG&&E(c.animation).duration,e=a.visible?"inherit":"hidden",n=c.zIndex,l=a.hasRendered,f=d.seriesGroup,g=d.inverted;b=a.plotGroup("group","series",e,n,f),a.markerGroup=a.plotGroup("markerGroup","markers",e,n,f),h&&a.animate(!0),b.inverted=!!a.isCartesian&&g,a.drawGraph&&(a.drawGraph(),a.applyZones()),a.drawDataLabels&&a.drawDataLabels(),a.visible&&a.drawPoints(),a.drawTracker&&!1!==a.options.enableMouseTracking&&a.drawTracker(),a.invertGroups(g),!1===c.clip||a.sharedClipKey||l||b.clip(d.clipRect),h&&a.animate(),l||(a.animationTimeout=B(function(){a.afterAnimate()},h)),a.isDirty=!1,a.hasRendered=!0},redraw:function(){var a=this.chart,d=this.isDirty||this.isDirtyData,b=this.group,c=this.xAxis,h=this.yAxis;b&&(a.inverted&&b.attr({width:a.plotWidth,height:a.plotHeight}),b.animate({translateX:I(c&&c.left,a.plotLeft),translateY:I(h&&h.top,a.plotTop)})),this.translate(),this.render(),d&&delete this.kdTree},kdAxisArray:["clientX","plotY"],searchPoint:function(a,d){var b=this.xAxis,c=this.yAxis,h=this.chart.inverted;return this.searchKDTree({clientX:h?b.len-a.chartY+b.pos:a.chartX-b.pos,plotY:h?c.len-a.chartX+c.pos:a.chartY-c.pos},d)},buildKDTree:function(){this.buildingKdTree=!0;var d=this,b=-1<d.options.findNearestPointBy.indexOf("y")?2:1;delete d.kdTree,B(function(){d.kdTree=function a(b,c,e){var h,p;if(p=b&&b.length)return h=d.kdAxisArray[c%e],b.sort(function(a,d){return a[h]-d[h]}),{point:b[p=Math.floor(p/2)],left:a(b.slice(0,p),c+1,e),right:a(b.slice(p+1),c+1,e)}}(d.getValidPoints(null,!d.directTouch),b,b),d.buildingKdTree=!1},d.options.kdNow?0:1)},searchKDTree:function(a,d){var c=this,h=this.kdAxisArray[0],e=this.kdAxisArray[1],n=d?"distX":"dist";if(d=-1<c.options.findNearestPointBy.indexOf("y")?2:1,this.kdTree||this.buildingKdTree||this.buildKDTree(),this.kdTree)return function b(a,d,p,l){var m,r,f=d.point,g=c.kdAxisArray[p%l],x=f;return r=u(a[h])&&u(f[h])?Math.pow(a[h]-f[h],2):null,m=u(a[e])&&u(f[e])?Math.pow(a[e]-f[e],2):null,m=(r||0)+(m||0),f.dist=u(m)?Math.sqrt(m):Number.MAX_VALUE,f.distX=u(r)?Math.sqrt(r):Number.MAX_VALUE,m=0>(g=a[g]-f[g])?"left":"right",r=0>g?"right":"left",d[m]&&(x=(m=b(a,d[m],p+1,l))[n]<x[n]?m:f),d[r]&&Math.sqrt(g*g)<x[n]&&(x=(a=b(a,d[r],p+1,l))[n]<x[n]?a:x),x}(a,this.kdTree,d,d)}})}(L),function(a){var G=a.Axis,E=a.Chart,H=a.correctFloat,v=a.defined,k=a.destroyObjectProperties,q=a.each,w=a.format,t=a.objectEach,u=a.pick,z=a.Series;a.StackItem=function(a,g,f,e,c){var b=a.chart.inverted;this.axis=a,this.isNegative=f,this.options=g,this.x=e,this.total=null,this.points={},this.stack=c,this.rightCliff=this.leftCliff=0,this.alignOptions={align:g.align||(b?f?"left":"right":"center"),verticalAlign:g.verticalAlign||(b?"middle":f?"bottom":"top"),y:u(g.y,b?4:f?14:-6),x:u(g.x,b?f?-6:6:0)},this.textAlign=g.textAlign||(b?f?"right":"left":"center")},a.StackItem.prototype={destroy:function(){k(this,this.axis)},render:function(a){var g=this.options,f=(f=g.format)?w(f,this):g.formatter.call(this);this.label?this.label.attr({text:f,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(f,null,null,g.useHTML).css(g.style).attr({align:this.textAlign,rotation:g.rotation,visibility:"hidden"}).add(a)},setOffset:function(a,g){var e=(f=this.axis).chart,c=f.translate(f.usePercentage?100:this.total,0,0,0,1),f=f.translate(0);f=Math.abs(c-f);a=e.xAxis[0].translate(this.x)+a,c=this.getStackBox(e,this,a,c,g,f),(g=this.label)&&(g.align(this.alignOptions,null,c),c=g.alignAttr,g[!1===this.options.crop||e.isInsidePlot(c.x,c.y)?"show":"hide"](!0))},getStackBox:function(a,g,f,e,c,b){var m=g.axis.reversed,l=a.inverted;return a=a.plotHeight,g=g.isNegative&&!m||!g.isNegative&&m,{x:l?g?e:e-b:f,y:l?a-f-c:g?a-e-b:a-e,width:l?b:c,height:l?c:b}}},E.prototype.getStacks=function(){var a=this;q(a.yAxis,function(a){a.stacks&&a.hasVisibleSeries&&(a.oldStacks=a.stacks)}),q(a.series,function(g){!g.options.stacking||!0!==g.visible&&!1!==a.options.chart.ignoreHiddenSeries||(g.stackKey=g.type+u(g.options.stack,""))})},G.prototype.buildStacks=function(){var e,a=this.series,g=u(this.options.reversedStacks,!0),f=a.length;if(!this.isXAxis){for(this.usePercentage=!1,e=f;e--;)a[g?e:f-e-1].setStackedPoints();for(e=0;e<f;e++)a[e].modifyStacks()}},G.prototype.renderStackTotals=function(){var a=this.chart,g=a.renderer,f=this.stacks,e=this.stackTotalGroup;e||(this.stackTotalGroup=e=g.g("stack-labels").attr({visibility:"visible",zIndex:6}).add()),e.translate(a.plotLeft,a.plotTop),t(f,function(a){t(a,function(a){a.render(e)})})},G.prototype.resetStacks=function(){var a=this,g=a.stacks;a.isXAxis||t(g,function(f){t(f,function(e,c){e.touched<a.stacksTouched?(e.destroy(),delete f[c]):(e.total=null,e.cumulative=null)})})},G.prototype.cleanStacks=function(){var a;this.isXAxis||(this.oldStacks&&(a=this.stacks=this.oldStacks),t(a,function(a){t(a,function(a){a.cumulative=a.total})}))},z.prototype.setStackedPoints=function(){if(this.options.stacking&&(!0===this.visible||!1===this.chart.options.chart.ignoreHiddenSeries)){var t,A,d,p,D,h,y,m=this.processedXData,g=this.processedYData,f=[],e=g.length,b=(c=this.options).threshold,r=u(c.startFromThreshold&&b,0),l=c.stack,c=c.stacking,k=this.stackKey,q="-"+k,x=this.negStacks,F=this.yAxis,n=F.stacks,B=F.oldStacks;for(F.stacksTouched+=1,D=0;D<e;D++)h=m[D],y=g[D],p=(t=this.getStackIndicator(t,h,this.index)).key,n[d=(A=x&&y<(r?0:b))?q:k]||(n[d]={}),n[d][h]||(B[d]&&B[d][h]?(n[d][h]=B[d][h],n[d][h].total=null):n[d][h]=new a.StackItem(F,F.options.stackLabels,A,h,l)),d=n[d][h],null!==y?(d.points[p]=d.points[this.index]=[u(d.cumulative,r)],v(d.cumulative)||(d.base=p),d.touched=F.stacksTouched,0<t.index&&!1===this.singleStacks&&(d.points[p][0]=d.points[this.index+","+h+",0"][0])):d.points[p]=d.points[this.index]=null,"percent"===c?(A=A?k:q,x&&n[A]&&n[A][h]?(A=n[A][h],d.total=A.total=Math.max(A.total,d.total)+Math.abs(y)||0):d.total=H(d.total+(Math.abs(y)||0))):d.total=H(d.total+(y||0)),d.cumulative=u(d.cumulative,r)+(y||0),null!==y&&(d.points[p].push(d.cumulative),f[D]=d.cumulative);"percent"===c&&(F.usePercentage=!0),this.stackedYData=f,F.oldStacks={}}},z.prototype.modifyStacks=function(){var c,a=this,g=a.stackKey,f=a.yAxis.stacks,e=a.processedXData,b=a.options.stacking;a[b+"Stacker"]&&q([g,"-"+g],function(g){for(var r,m,l=e.length;l--;)r=e[l],c=a.getStackIndicator(c,r,a.index,g),(m=(r=f[g]&&f[g][r])&&r.points[c.key])&&a[b+"Stacker"](m,r,l)})},z.prototype.percentStacker=function(a,g,f){g=g.total?100/g.total:0,a[0]=H(a[0]*g),a[1]=H(a[1]*g),this.stackedYData[f]=a[1]},z.prototype.getStackIndicator=function(a,g,f,e){return!v(a)||a.x!==g||e&&a.key!==e?a={x:g,index:0,key:e}:a.index++,a.key=[f,g,a.index].join(),a}}(L),function(a){var G=a.addEvent,E=a.animate,H=a.Axis,v=a.createElement,k=a.css,q=a.defined,w=a.each,t=a.erase,u=a.extend,z=a.fireEvent,m=a.inArray,g=a.isNumber,f=a.isObject,e=a.isArray,c=a.merge,b=a.objectEach,r=a.pick,l=a.Point,C=a.Series,I=a.seriesTypes,x=a.setAnimation,F=a.splat;u(a.Chart.prototype,{addSeries:function(a,b,c){var e,d=this;return a&&(b=r(b,!0),z(d,"addSeries",{options:a},function(){e=d.initSeries(a),d.isDirtyLegend=!0,d.linkSeries(),b&&d.redraw(c)})),e},addAxis:function(a,b,e,l){var d=b?"xAxis":"yAxis",p=this.options;return a=c(a,{index:this[d].length,isX:b}),b=new H(this,a),p[d]=F(p[d]||{}),p[d].push(a),r(e,!0)&&this.redraw(l),b},showLoading:function(a){var b=this,c=b.options,e=b.loadingDiv,d=c.loading,p=function(){e&&k(e,{left:b.plotLeft+"px",top:b.plotTop+"px",width:b.plotWidth+"px",height:b.plotHeight+"px"})};e||(b.loadingDiv=e=v("div",{className:"highcharts-loading highcharts-loading-hidden"},null,b.container),b.loadingSpan=v("span",{className:"highcharts-loading-inner"},null,e),G(b,"redraw",p)),e.className="highcharts-loading",b.loadingSpan.innerHTML=a||c.lang.loading,k(e,u(d.style,{zIndex:10})),k(b.loadingSpan,d.labelStyle),b.loadingShown||(k(e,{opacity:0,display:""}),E(e,{opacity:d.style.opacity||.5},{duration:d.showDuration||0})),b.loadingShown=!0,p()},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&(b.className="highcharts-loading highcharts-loading-hidden",E(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){k(b,{display:"none"})}})),this.loadingShown=!1},propsRequireDirtyBox:"backgroundColor borderColor borderWidth margin marginTop marginRight marginBottom marginLeft spacing spacingTop spacingRight spacingBottom spacingLeft borderRadius plotBackgroundColor plotBackgroundImage plotBorderColor plotBorderWidth plotShadow shadow".split(" "),propsRequireUpdateSeries:"chart.inverted chart.polar chart.ignoreHiddenSeries chart.type colors plotOptions tooltip".split(" "),update:function(a,e,l){var f,h,n=this,d={credits:"addCredits",title:"setTitle",subtitle:"setSubtitle"},p=a.chart,x=[];p&&(c(!0,n.options.chart,p),"className"in p&&n.setClassName(p.className),("inverted"in p||"polar"in p)&&(n.propFromSeries(),f=!0),"alignTicks"in p&&(f=!0),b(p,function(a,d){-1!==m("chart."+d,n.propsRequireUpdateSeries)&&(h=!0),-1!==m(d,n.propsRequireDirtyBox)&&(n.isDirtyBox=!0)}),"style"in p&&n.renderer.setStyle(p.style)),a.colors&&(this.options.colors=a.colors),a.plotOptions&&c(!0,this.options.plotOptions,a.plotOptions),b(a,function(a,b){n[b]&&"function"==typeof n[b].update?n[b].update(a,!1):"function"==typeof n[d[b]]&&n[d[b]](a),"chart"!==b&&-1!==m(b,n.propsRequireUpdateSeries)&&(h=!0)}),w("xAxis yAxis zAxis series colorAxis pane".split(" "),function(d){a[d]&&(w(F(a[d]),function(a,b){(b=q(a.id)&&n.get(a.id)||n[d][b])&&b.coll===d&&(b.update(a,!1),l&&(b.touched=!0)),!b&&l&&("series"===d?n.addSeries(a,!1).touched=!0:"xAxis"!==d&&"yAxis"!==d||(n.addAxis(a,"xAxis"===d,!1).touched=!0))}),l&&w(n[d],function(a){a.touched?delete a.touched:x.push(a)}))}),w(x,function(a){a.remove(!1)}),f&&w(n.axes,function(a){a.update({},!1)}),h&&w(n.series,function(a){a.update({},!1)}),a.loading&&c(!0,n.options.loading,a.loading),f=p&&p.width,p=p&&p.height,g(f)&&f!==n.chartWidth||g(p)&&p!==n.chartHeight?n.setSize(f,p):r(e,!0)&&n.redraw()},setSubtitle:function(a){this.setTitle(void 0,a)}}),u(l.prototype,{update:function(a,b,c,e){function d(){p.applyOptions(a),null===p.y&&h&&(p.graphic=h.destroy()),f(a,!0)&&(h&&h.element&&a&&a.marker&&void 0!==a.marker.symbol&&(p.graphic=h.destroy()),a&&a.dataLabels&&p.dataLabel&&(p.dataLabel=p.dataLabel.destroy()),p.connector&&(p.connector=p.connector.destroy())),l=p.index,n.updateParallelArrays(p,l),m.data[l]=f(m.data[l],!0)||f(a,!0)?p.options:a,n.isDirty=n.isDirtyData=!0,!n.fixedBox&&n.hasCartesianSeries&&(g.isDirtyBox=!0),"point"===m.legendType&&(g.isDirtyLegend=!0),b&&g.redraw(c)}var l,p=this,n=p.series,h=p.graphic,g=n.chart,m=n.options;b=r(b,!0),!1===e?d():p.firePointEvent("update",{options:a},d)},remove:function(a,b){this.series.removePoint(m(this,this.series.data),a,b)}}),u(C.prototype,{addPoint:function(a,b,c,e){var f,g,x,k,d=this.options,p=this.data,n=this.chart,h=(h=this.xAxis)&&h.hasNames&&h.names,l=d.data,m=this.xData;if(b=r(b,!0),f={series:this},this.pointClass.prototype.applyOptions.apply(f,[a]),k=f.x,x=m.length,this.requireSorting&&k<m[x-1])for(g=!0;x&&m[x-1]>k;)x--;this.updateParallelArrays(f,"splice",x,0,0),this.updateParallelArrays(f,x),h&&f.name&&(h[k]=f.name),l.splice(x,0,a),g&&(this.data.splice(x,0,null),this.processData()),"point"===d.legendType&&this.generatePoints(),c&&(p[0]&&p[0].remove?p[0].remove(!1):(p.shift(),this.updateParallelArrays(f,"shift"),l.shift())),this.isDirtyData=this.isDirty=!0,b&&n.redraw(e)},removePoint:function(a,b,c){var e=this,d=e.data,p=d[a],n=e.points,h=e.chart,l=function(){n&&n.length===d.length&&n.splice(a,1),d.splice(a,1),e.options.data.splice(a,1),e.updateParallelArrays(p||{series:e},"splice",a,1),p&&p.destroy(),e.isDirty=!0,e.isDirtyData=!0,b&&h.redraw()};x(c,h),b=r(b,!0),p?p.firePointEvent("remove",null,l):l()},remove:function(a,b,c){function e(){d.destroy(),p.isDirtyLegend=p.isDirtyBox=!0,p.linkSeries(),r(a,!0)&&p.redraw(b)}var d=this,p=d.chart;!1!==c?z(d,"remove",null,e):e()},update:function(a,b){var f,e=this,n=e.chart,d=e.userOptions,p=e.oldType||e.type,l=a.type||d.type||n.options.chart.type,h=I[p].prototype,g=["group","markerGroup","dataLabelsGroup"],m=["navigatorSeries","baseSeries"],x=e.finishedAnimating&&{animation:!1};if(Object.keys&&"data"===Object.keys(a).toString())return this.setData(a.data,b);for(f in m=g.concat(m),w(m,function(a){m[a]=e[a],delete e[a]}),a=c(d,x,{index:e.index,pointStart:e.xData[0]},{data:e.options.data},a),e.remove(!1,null,!1),h)e[f]=void 0;u(e,I[l||p].prototype),w(m,function(a){e[a]=m[a]}),e.init(n,a),a.zIndex!==d.zIndex&&w(g,function(d){e[d]&&e[d].attr({zIndex:a.zIndex})}),e.oldType=p,n.linkSeries(),r(b,!0)&&n.redraw(!1)}}),u(H.prototype,{update:function(a,b){var e=this.chart;a=e.options[this.coll][this.options.index]=c(this.userOptions,a),this.destroy(!0),this.init(e,u(a,{events:void 0})),e.isDirtyBox=!0,r(b,!0)&&e.redraw()},remove:function(a){for(var b=this.chart,c=this.coll,n=this.series,d=n.length;d--;)n[d]&&n[d].remove(!1);t(b.axes,this),t(b[c],this),e(b.options[c])?b.options[c].splice(this.options.index,1):delete b.options[c],w(b[c],function(a,d){a.options.index=d}),this.destroy(),b.isDirtyBox=!0,r(a,!0)&&b.redraw()},setTitle:function(a,b){this.update({title:a},b)},setCategories:function(a,b){this.update({categories:a},b)}})}(L),function(a){var G=a.color,E=a.each,H=a.map,v=a.pick,k=a.Series;(0,a.seriesType)("area","line",{softThreshold:!1,threshold:0},{singleStacks:!1,getStackPoints:function(k){var r,C,q=[],u=[],w=this.xAxis,m=this.yAxis,g=m.stacks[this.stackKey],f={},e=this.index,c=m.series,b=c.length,l=v(m.options.reversedStacks,!0)?1:-1;if(k=k||this.points,this.options.stacking){for(C=0;C<k.length;C++)k[C].leftNull=k[C].rightNull=null,f[k[C].x]=k[C];a.objectEach(g,function(a,b){null!==a.total&&u.push(b)}),u.sort(function(a,b){return a-b}),r=H(c,function(){return this.visible}),E(u,function(a,c){var n,k,x=0;if(f[a]&&!f[a].isNull)q.push(f[a]),E([-1,1],function(m){var x=1===m?"rightNull":"leftNull",d=0,p=g[u[c+m]];if(p)for(C=e;0<=C&&C<b;)(n=p.points[C])||(C===e?f[a][x]=!0:r[C]&&(k=g[a].points[C])&&(d-=k[1]-k[0])),C+=l;f[a][1===m?"rightCliff":"leftCliff"]=d});else{for(C=e;0<=C&&C<b;){if(n=g[a].points[C]){x=n[1];break}C+=l}x=m.translate(x,0,1,0,1),q.push({isNull:!0,plotX:w.translate(a,0,0,0,1),x:a,plotY:x,yBottom:x})}})}return q},getGraphPath:function(a){var g,f,r,x,q=k.prototype.getGraphPath,w=(u=this.options).stacking,m=this.yAxis,e=[],c=[],b=this.index,l=m.stacks[this.stackKey],C=u.threshold,I=m.getThreshold(u.threshold),u=u.connectNulls||"percent"===w,F=function(n,f,g){var x=a[n];n=w&&l[x.x].points[b];var d=x[g+"Null"]||0;g=x[g+"Cliff"]||0;var p,k;x=!0;g||d?(p=(d?n[0]:n[1])+g,k=n[0]+g,x=!!d):!w&&a[f]&&a[f].isNull&&(p=k=C),void 0!==p&&(c.push({plotX:r,plotY:null===p?I:m.getThreshold(p),isNull:x,isCliff:!0}),e.push({plotX:r,plotY:null===k?I:m.getThreshold(k),doCurve:!1}))};for(a=a||this.points,w&&(a=this.getStackPoints(a)),g=0;g<a.length;g++)f=a[g].isNull,r=v(a[g].rectPlotX,a[g].plotX),x=v(a[g].yBottom,I),(!f||u)&&(u||F(g,g-1,"left"),f&&!w&&u||(c.push(a[g]),e.push({x:g,plotX:r,plotY:x})),u||F(g,g+1,"right"));return g=q.call(this,c,!0,!0),e.reversed=!0,(f=q.call(this,e,!0,!0)).length&&(f[0]="L"),f=g.concat(f),q=q.call(this,c,!1,u),f.xMap=g.xMap,this.areaPath=f,q},drawGraph:function(){this.areaPath=[],k.prototype.drawGraph.apply(this);var a=this,q=this.areaPath,u=this.options,z=[["area","highcharts-area",this.color,u.fillColor]];E(this.zones,function(m,g){z.push(["zone-area-"+g,"highcharts-area highcharts-zone-area-"+g+" "+m.className,m.color||a.color,m.fillColor||u.fillColor])}),E(z,function(m){var g=m[0],f=a[g];f?(f.endX=a.preventGraphAnimation?null:q.xMap,f.animate({d:q})):(f=a[g]=a.chart.renderer.path(q).addClass(m[1]).attr({fill:v(m[3],G(m[2]).setOpacity(v(u.fillOpacity,.75)).get()),zIndex:0}).add(a.group)).isArea=!0,f.startX=q.xMap,f.shiftUnit=u.step?2:1})},drawLegendSymbol:a.LegendSymbolMixin.drawRectangle})}(L),function(a){var G=a.pick;(a=a.seriesType)("spline","line",{},{getPointSpline:function(a,H,v){var t,u,z,m,k=H.plotX,q=H.plotY,w=a[v-1];if(v=a[v+1],w&&!w.isNull&&!1!==w.doCurve&&!H.isCliff&&v&&!v.isNull&&!1!==v.doCurve&&!H.isCliff){a=w.plotY,z=v.plotX;var g=0;u=(1.5*q+a)/2.5,m=(1.5*q+(v=v.plotY))/2.5,(z=(1.5*k+z)/2.5)!==(t=(1.5*k+w.plotX)/2.5)&&(g=(m-u)*(z-k)/(z-t)+q-m),m+=g,(u+=g)>a&&u>q?m=2*q-(u=Math.max(a,q)):u<a&&u<q&&(m=2*q-(u=Math.min(a,q))),m>v&&m>q?u=2*q-(m=Math.max(v,q)):m<v&&m<q&&(u=2*q-(m=Math.min(v,q))),H.rightContX=z,H.rightContY=m}return H=["C",G(w.rightContX,w.plotX),G(w.rightContY,w.plotY),G(t,k),G(u,q),k,q],w.rightContX=w.rightContY=null,H}})}(L),function(a){var G=a.seriesTypes.area.prototype;(0,a.seriesType)("areaspline","spline",a.defaultPlotOptions.area,{getStackPoints:G.getStackPoints,getGraphPath:G.getGraphPath,drawGraph:G.drawGraph,drawLegendSymbol:a.LegendSymbolMixin.drawRectangle})}(L),function(a){var G=a.animObject,E=a.color,H=a.each,v=a.extend,k=a.isNumber,q=a.merge,w=a.pick,t=a.Series,u=a.seriesType,z=a.svg;u("column","line",{borderRadius:0,crisp:!0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{halo:!1,brightness:.1},select:{color:"#cccccc",borderColor:"#000000"}},dataLabels:{align:null,verticalAlign:null,y:null},softThreshold:!1,startFromThreshold:!0,stickyTracking:!1,tooltip:{distance:6},threshold:0,borderColor:"#ffffff"},{cropShoulder:0,directTouch:!0,trackerGroups:["group","dataLabelsGroup"],negStacks:!0,init:function(){t.prototype.init.apply(this,arguments);var a=this,g=a.chart;g.hasRendered&&H(g.series,function(f){f.type===a.type&&(f.isDirty=!0)})},getColumnMetrics:function(){var b,a=this,g=a.options,f=a.xAxis,e=a.yAxis,c=f.reversed,r={},l=0;!1===g.grouping?l=1:H(a.chart.series,function(c){var g,n=c.options,f=c.yAxis;c.type!==a.type||!c.visible&&a.chart.options.chart.ignoreHiddenSeries||e.len!==f.len||e.pos!==f.pos||(n.stacking?(b=c.stackKey,void 0===r[b]&&(r[b]=l++),g=r[b]):!1!==n.grouping&&(g=l++),c.columnIndex=g)});var k=Math.min(Math.abs(f.transA)*(f.ordinalSlope||g.pointRange||f.closestPointRange||f.tickInterval||1),f.len),q=k*g.groupPadding,x=(k-2*q)/(l||1);g=Math.min(g.maxPointWidth||f.len,w(g.pointWidth,x*(1-2*g.pointPadding)));return a.columnMetrics={width:g,offset:(x-g)/2+(q+((a.columnIndex||0)+(c?1:0))*x-k/2)*(c?-1:1)},a.columnMetrics},crispCol:function(a,g,f,e){var c=this.chart,r=-((b=this.borderWidth)%2?.5:0),b=b%2?.5:1;return c.inverted&&c.renderer.isVML&&(b+=1),this.options.crisp&&(f=Math.round(a+f)+r,f-=a=Math.round(a)+r),e=Math.round(g+e)+b,r=.5>=Math.abs(g)&&.5<e,e-=g=Math.round(g)+b,r&&e&&(--g,e+=1),{x:a,y:g,width:f,height:e}},translate:function(){var a=this,g=a.chart,f=a.options,e=a.dense=2>a.closestPointRange*a.xAxis.transA,c=(e=a.borderWidth=w(f.borderWidth,e?0:1),a.yAxis),b=f.threshold,r=a.translatedThreshold=c.getThreshold(b),l=w(f.minPointLength,5),k=a.getColumnMetrics(),q=k.width,x=a.barW=Math.max(q,1+2*e),F=a.pointXOffset=k.offset;g.inverted&&(r-=.5),f.pointPadding&&(x=Math.ceil(x)),t.prototype.translate.apply(a),H(a.points,function(e){var m,n=w(e.yBottom,r),f=999+Math.abs(n),k=(f=Math.min(Math.max(-f,e.plotY),c.len+f),e.plotX+F),d=x,p=Math.min(f,n),h=Math.max(f,n)-p;l&&Math.abs(h)<l&&(h=l,m=!c.reversed&&!e.negative||c.reversed&&e.negative,e.y===b&&a.dataMax<=b&&c.min<b&&(m=!m),p=Math.abs(p-r)>l?n-l:r-(m?l:0)),e.barX=k,e.pointWidth=q,e.tooltipPos=g.inverted?[c.len+c.pos-g.plotLeft-f,a.xAxis.len-k-d/2,h]:[k+d/2,f+c.pos-g.plotTop,h],e.shapeType="rect",e.shapeArgs=a.crispCol.apply(a,e.isNull?[k,r,d,0]:[k,p,d,h])})},getSymbol:a.noop,drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,drawGraph:function(){this.group[this.dense?"addClass":"removeClass"]("highcharts-dense-data")},pointAttribs:function(a,g){var e,f=this.options;e=(c=this.pointAttrToOptions||{}).stroke||"borderColor";var b=c["stroke-width"]||"borderWidth",r=a&&a.color||this.color,l=a&&a[e]||f[e]||this.color||r,k=a&&a[b]||f[b]||this[b]||0,c=f.dashStyle;return a&&this.zones.length&&(r=a.getZone(),r=a.options.color||r&&r.color||this.color),g&&(g=(a=q(f.states[g],a.options.states&&a.options.states[g]||{})).brightness,r=a.color||void 0!==g&&E(r).brighten(a.brightness).get()||r,l=a[e]||l,k=a[b]||k,c=a.dashStyle||c),e={fill:r,stroke:l,"stroke-width":k},c&&(e.dashstyle=c),e},drawPoints:function(){var b,a=this,g=this.chart,f=a.options,e=g.renderer,c=f.animationLimit||250;H(a.points,function(r){var l=r.graphic;k(r.plotY)&&null!==r.y?(b=r.shapeArgs,l?l[g.pointCount<c?"animate":"attr"](q(b)):r.graphic=l=e[r.shapeType](b).add(r.group||a.group),f.borderRadius&&l.attr({r:f.borderRadius}),l.attr(a.pointAttribs(r,r.selected&&"select")).shadow(f.shadow,null,f.stacking&&!f.borderRadius),l.addClass(r.getClassName(),!0)):l&&(r.graphic=l.destroy())})},animate:function(a){var l,g=this,f=this.yAxis,e=g.options,c=this.chart.inverted,b={},r=c?"translateX":"translateY";z&&(a?(b.scaleY=.001,a=Math.min(f.pos+f.len,Math.max(f.pos,f.toPixels(e.threshold))),c?b.translateX=a-f.len:b.translateY=a,g.group.attr(b)):(l=g.group.attr(r),g.group.animate({scaleY:1},v(G(g.options.animation),{step:function(a,c){b[r]=l+c.pos*(f.pos-l),g.group.attr(b)}})),g.animate=null))},remove:function(){var a=this,g=a.chart;g.hasRendered&&H(g.series,function(f){f.type===a.type&&(f.isDirty=!0)}),t.prototype.remove.apply(a,arguments)}})}(L),function(a){(a=a.seriesType)("bar","column",null,{inverted:!0})}(L),function(a){var G=a.Series;(a=a.seriesType)("scatter","line",{lineWidth:0,findNearestPointBy:"xy",marker:{enabled:!0},tooltip:{headerFormat:'<span style="color:{point.color}">●</span> <span style="font-size: 0.85em"> {series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>"}},{sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","markerGroup","dataLabelsGroup"],takeOrdinalPosition:!1,drawGraph:function(){this.options.lineWidth&&G.prototype.drawGraph.call(this)}})}(L),function(a){var G=a.deg2rad,E=a.isNumber,H=a.pick,v=a.relativeLength;a.CenteredSeriesMixin={getCenter:function(){var m,g,a=this.options,q=this.chart,w=2*(a.slicedOffset||0),t=q.plotWidth-2*w,u=(q=q.plotHeight-2*w,a.center),z=(u=[H(u[0],"50%"),H(u[1],"50%"),a.size||"100%",a.innerSize||0],Math.min(t,q));for(m=0;4>m;++m)g=u[m],a=2>m||2===m&&/%$/.test(g),u[m]=v(g,[t,q,z,u[2]][m])+(a?w:0);return u[3]>u[2]&&(u[3]=u[2]),u},getStartAndEndRadians:function(a,q){return a=E(a)?a:0,q=E(q)&&q>a&&360>q-a?q:a+360,{start:G*(a+-90),end:G*(q+-90)}}}}(L),function(a){var G=a.addEvent,E=a.CenteredSeriesMixin,H=a.defined,v=a.each,k=a.extend,q=E.getStartAndEndRadians,w=a.inArray,t=a.noop,u=a.pick,z=a.Point,m=a.Series,g=a.seriesType,f=a.setAnimation;g("pie","line",{center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.isNull?void 0:this.point.name},x:0},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,stickyTracking:!1,tooltip:{followPointer:!0},borderColor:"#ffffff",borderWidth:1,states:{hover:{brightness:.1,shadow:!1}}},{isCartesian:!1,requireSorting:!1,directTouch:!0,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],axisTypes:[],pointAttribs:a.seriesTypes.column.prototype.pointAttribs,animate:function(a){var c=this,b=c.points,e=c.startAngleRad;a||(v(b,function(a){var b=a.graphic,l=a.shapeArgs;b&&(b.attr({r:a.startR||c.center[3]/2,start:e,end:e}),b.animate({r:l.r,start:l.start,end:l.end},c.options.animation))}),c.animate=null)},updateTotals:function(){var a,l,c=0,b=this.points,f=b.length,g=this.options.ignoreHiddenPoint;for(a=0;a<f;a++)l=b[a],c+=g&&!l.visible?0:l.isNull?0:l.y;for(this.total=c,a=0;a<f;a++)(l=b[a]).percentage=0<c&&(l.visible||!g)?l.y/c*100:0,l.total=c},generatePoints:function(){m.prototype.generatePoints.call(this),this.updateTotals()},translate:function(a){this.generatePoints();var f,g,x,t,d,D,c=0,e=(b=this.options).slicedOffset,l=e+(b.borderWidth||0),k=q(b.startAngle,b.endAngle),n=this.startAngleRad=k.start,m=(k=(this.endAngleRad=k.end)-n,this.points),A=b.dataLabels.distance,b=b.ignoreHiddenPoint,p=m.length;for(a||(this.center=a=this.getCenter()),this.getX=function(d,b,c){return x=Math.asin(Math.min((d-a[1])/(a[2]/2+c.labelDistance),1)),a[0]+(b?-1:1)*Math.cos(x)*(a[2]/2+c.labelDistance)},d=0;d<p;d++)(D=m[d]).labelDistance=u(D.options.dataLabels&&D.options.dataLabels.distance,A),this.maxLabelDistance=Math.max(this.maxLabelDistance||0,D.labelDistance),f=n+c*k,b&&!D.visible||(c+=D.percentage/100),g=n+c*k,D.shapeType="arc",D.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:Math.round(1e3*f)/1e3,end:Math.round(1e3*g)/1e3},(x=(g+f)/2)>1.5*Math.PI?x-=2*Math.PI:x<-Math.PI/2&&(x+=2*Math.PI),D.slicedTranslation={translateX:Math.round(Math.cos(x)*e),translateY:Math.round(Math.sin(x)*e)},g=Math.cos(x)*a[2]/2,t=Math.sin(x)*a[2]/2,D.tooltipPos=[a[0]+.7*g,a[1]+.7*t],D.half=x<-Math.PI/2||x>Math.PI/2?1:0,D.angle=x,f=Math.min(l,D.labelDistance/5),D.labelPos=[a[0]+g+Math.cos(x)*D.labelDistance,a[1]+t+Math.sin(x)*D.labelDistance,a[0]+g+Math.cos(x)*f,a[1]+t+Math.sin(x)*f,a[0]+g,a[1]+t,0>D.labelDistance?"center":D.half?"right":"left",x]},drawGraph:null,drawPoints:function(){var b,f,l,g,a=this,c=a.chart.renderer,m=a.options.shadow;m&&!a.shadowGroup&&(a.shadowGroup=c.g("shadow").add(a.group)),v(a.points,function(e){if(f=e.graphic,e.isNull)f&&(e.graphic=f.destroy());else{g=e.shapeArgs,b=e.getTranslate();var r=e.shadowGroup;m&&!r&&(r=e.shadowGroup=c.g("shadow").add(a.shadowGroup)),r&&r.attr(b),l=a.pointAttribs(e,e.selected&&"select"),f?f.setRadialReference(a.center).attr(l).animate(k(g,b)):(e.graphic=f=c[e.shapeType](g).setRadialReference(a.center).attr(b).add(a.group),e.visible||f.attr({visibility:"hidden"}),f.attr(l).attr({"stroke-linejoin":"round"}).shadow(m,r)),f.addClass(e.getClassName())}})},searchPoint:t,sortByAngle:function(a,c){a.sort(function(a,e){return void 0!==a.angle&&(e.angle-a.angle)*c})},drawLegendSymbol:a.LegendSymbolMixin.drawRectangle,getCenter:E.getCenter,getSymbol:t},{init:function(){z.prototype.init.apply(this,arguments);var c,a=this;return a.name=u(a.name,"Slice"),G(a,"select",c=function(b){a.slice("select"===b.type)}),G(a,"unselect",c),a},isValid:function(){return a.isNumber(this.y,!0)&&0<=this.y},setVisible:function(a,c){var b=this,e=b.series,l=e.chart,f=e.options.ignoreHiddenPoint;c=u(c,f),a!==b.visible&&(b.visible=b.options.visible=a=void 0===a?!b.visible:a,e.options.data[w(b,e.data)]=b.options,v(["graphic","dataLabel","connector","shadowGroup"],function(c){b[c]&&b[c][a?"show":"hide"](!0)}),b.legendItem&&l.legend.colorizeItem(b,a),a||"hover"!==b.state||b.setState(""),f&&(e.isDirty=!0),c&&l.redraw())},slice:function(a,c,b){var e=this.series;f(b,e.chart),u(c,!0),this.sliced=this.options.sliced=H(a)?a:!this.sliced,e.options.data[w(this,e.data)]=this.options,this.graphic.animate(this.getTranslate()),this.shadowGroup&&this.shadowGroup.animate(this.getTranslate())},getTranslate:function(){return this.sliced?this.slicedTranslation:{translateX:0,translateY:0}},haloPath:function(a){var c=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(c.x,c.y,c.r+a,c.r+a,{innerR:this.shapeArgs.r-1,start:c.start,end:c.end})}})}(L),function(a){var G=a.addEvent,E=a.arrayMax,H=a.defined,v=a.each,k=a.extend,q=a.format,w=a.map,t=a.merge,u=a.noop,z=a.pick,m=a.relativeLength,g=a.Series,f=a.seriesTypes,e=a.stableSort;a.distribute=function(a,b){function c(a,b){return a.target-b.target}var l,k,f=!0,g=a,x=[];for(k=0,l=a.length;l--;)k+=a[l].size;if(k>b){for(e(a,function(a,b){return(b.rank||0)-(a.rank||0)}),k=l=0;k<=b;)k+=a[l].size,l++;x=a.splice(l-1,a.length)}for(e(a,c),a=w(a,function(a){return{size:a.size,targets:[a.target],align:z(a.align,.5)}});f;){for(l=a.length;l--;)f=a[l],k=(Math.min.apply(0,f.targets)+Math.max.apply(0,f.targets))/2,f.pos=Math.min(Math.max(0,k-f.size*f.align),b-f.size);for(l=a.length,f=!1;l--;)0<l&&a[l-1].pos+a[l-1].size>a[l].pos&&(a[l-1].size+=a[l].size,a[l-1].targets=a[l-1].targets.concat(a[l].targets),a[l-1].align=.5,a[l-1].pos+a[l-1].size>b&&(a[l-1].pos=b-a[l-1].size),a.splice(l,1),f=!0)}l=0,v(a,function(a){var b=0;v(a.targets,function(){g[l].pos=a.pos+b,b+=g[l].size,l++})}),g.push.apply(g,x),e(g,c)},g.prototype.drawDataLabels=function(){var k,x,n,B,b=this,e=b.options,f=e.dataLabels,g=b.points,m=b.hasRendered||0,u=z(f.defer,!!e.animation),A=b.chart.renderer;(f.enabled||b._hasPointLabels)&&(b.dlProcessOptions&&b.dlProcessOptions(f),B=b.plotGroup("dataLabelsGroup","data-labels",u&&!m?"hidden":"visible",f.zIndex||6),u&&(B.attr({opacity:+m}),m||G(b,"afterAnimate",function(){b.visible&&B.show(!0),B[e.animation?"animate":"attr"]({opacity:1},{duration:200})})),x=f,v(g,function(d){var p,h,g,F,l=d.dataLabel,r=d.connector,m=!l;k=d.dlOptions||d.options&&d.options.dataLabels,(p=z(k&&k.enabled,x.enabled)&&!d.isNull)&&(p=!0===function(a,b){var d=b.filter;return!d||(b=d.operator,a=a[d.property],d=d.value,">"===b&&a>d||"<"===b&&a<d||">="===b&&a>=d||"<="===b&&a<=d||"=="===b&&a==d||"==="===b&&a===d)}(d,k||f)),p&&(f=t(x,k),h=d.getLabelConfig(),F=f[d.formatPrefix+"Format"]||f.format,n=H(F)?q(F,h):(f[d.formatPrefix+"Formatter"]||f.formatter).call(h,f),F=f.style,h=f.rotation,F.color=z(f.color,F.color,b.color,"#000000"),"contrast"===F.color&&(d.contrastColor=A.getContrast(d.color||b.color),F.color=f.inside||0>z(d.labelDistance,f.distance)||e.stacking?d.contrastColor:"#000000"),e.cursor&&(F.cursor=e.cursor),g={fill:f.backgroundColor,stroke:f.borderColor,"stroke-width":f.borderWidth,r:f.borderRadius||0,rotation:h,padding:f.padding,zIndex:1},a.objectEach(g,function(a,d){void 0===a&&delete g[d]})),!l||p&&H(n)?p&&H(n)&&(l?g.text=n:(l=d.dataLabel=h?A.text(n,0,-9999).addClass("highcharts-data-label"):A.label(n,0,-9999,f.shape,null,null,f.useHTML,null,"data-label")).addClass(" highcharts-data-label-color-"+d.colorIndex+" "+(f.className||"")+(f.useHTML?"highcharts-tracker":"")),l.attr(g),l.css(F).shadow(f.shadow),l.added||l.add(B),b.alignDataLabel(d,l,f,null,m)):(d.dataLabel=l=l.destroy(),r&&(d.connector=r.destroy()))}))},g.prototype.alignDataLabel=function(a,b,e,f,g){var q,c=this.chart,l=c.inverted,r=z(a.dlBox&&a.dlBox.centerX,a.plotX,-9999),n=z(a.plotY,-9999),m=b.getBBox(),t=e.rotation,d=e.align,p=this.visible&&(a.series.forceDL||c.isInsidePlot(r,Math.round(n),l)||f&&c.isInsidePlot(r,l?f.x+1:f.y+f.height-1,l)),D="justify"===z(e.overflow,"justify");p&&(q=e.style.fontSize,q=c.renderer.fontMetrics(q,b).b,f=k({x:l?this.yAxis.len-n:r,y:Math.round(l?this.xAxis.len-r:n),width:0,height:0},f),k(e,{width:m.width,height:m.height}),t?(D=!1,r=c.renderer.rotCorr(q,t),r={x:f.x+e.x+f.width/2+r.x,y:f.y+e.y+{top:0,middle:.5,bottom:1}[e.verticalAlign]*f.height},b[g?"attr":"animate"](r).attr({align:d}),n=180<(n=(t+720)%360)&&360>n,"left"===d?r.y-=n?m.height:0:"center"===d?(r.x-=m.width/2,r.y-=m.height/2):"right"===d&&(r.x-=m.width,r.y-=n?0:m.height)):(b.align(e,null,f),r=b.alignAttr),D?a.isLabelJustified=this.justifyDataLabel(b,e,r,m,f,g):z(e.crop,!0)&&(p=c.isInsidePlot(r.x,r.y)&&c.isInsidePlot(r.x+m.width,r.y+m.height)),e.shape&&!t)&&b[g?"attr":"animate"]({anchorX:l?c.plotWidth-a.plotY:a.plotX,anchorY:l?c.plotHeight-a.plotX:a.plotY}),p||(b.attr({y:-9999}),b.placed=!1)},g.prototype.justifyDataLabel=function(a,b,e,f,g,k){var r,m,c=this.chart,l=b.align,n=b.verticalAlign,q=a.box?0:a.padding||0;return 0>(r=e.x+q)&&("right"===l?b.align="left":b.x=-r,m=!0),(r=e.x+f.width-q)>c.plotWidth&&("left"===l?b.align="right":b.x=c.plotWidth-r,m=!0),0>(r=e.y+q)&&("bottom"===n?b.verticalAlign="top":b.y=-r,m=!0),(r=e.y+f.height-q)>c.plotHeight&&("top"===n?b.verticalAlign="bottom":b.y=c.plotHeight-r,m=!0),m&&(a.placed=!k,a.align(b,null,g)),m},f.pie&&(f.pie.prototype.drawDataLabels=function(){var e,t,p,D,h,y,M,O,N,G,c=this,b=c.data,f=c.chart,k=c.options.dataLabels,m=z(k.connectorPadding,10),x=z(k.connectorWidth,1),q=f.plotWidth,n=f.plotHeight,u=c.center,A=u[2]/2,d=u[1],w=[[],[]],K=[0,0,0,0];c.visible&&(k.enabled||c._hasPointLabels)&&(v(b,function(a){a.dataLabel&&a.visible&&a.dataLabel.shortened&&(a.dataLabel.attr({width:"auto"}).css({width:"auto",textOverflow:"clip"}),a.dataLabel.shortened=!1)}),g.prototype.drawDataLabels.apply(c),v(b,function(a){a.dataLabel&&a.visible&&(w[a.half].push(a),a.dataLabel._pos=null)}),v(w,function(b,l){var g,r,B,x=b.length,t=[];if(x)for(c.sortByAngle(b,l-.5),0<c.maxLabelDistance&&(g=Math.max(0,d-A-c.maxLabelDistance),r=Math.min(d+A+c.maxLabelDistance,f.plotHeight),v(b,function(a){0<a.labelDistance&&a.dataLabel&&(a.top=Math.max(0,d-A-a.labelDistance),a.bottom=Math.min(d+A+a.labelDistance,f.plotHeight),B=a.dataLabel.getBBox().height||21,a.positionsIndex=t.push({target:a.labelPos[1]-a.top+B/2,size:B,rank:a.y})-1)}),a.distribute(t,r+B-g)),G=0;G<x;G++)r=(e=b[G]).positionsIndex,h=e.labelPos,p=e.dataLabel,N=!1===e.visible?"hidden":"inherit",O=g=h[1],t&&H(t[r])&&(void 0===t[r].pos?N="hidden":(y=t[r].size,O=e.top+t[r].pos)),delete e.positionIndex,M=k.justify?u[0]+(l?-1:1)*(A+e.labelDistance):c.getX(O<e.top+2||O>e.bottom-2?g:O,l,e),p._attr={visibility:N,align:h[6]},p._pos={x:M+k.x+({left:m,right:-m}[h[6]]||0),y:O+k.y-10},h.x=M,h.y=O,z(k.crop,!0)&&(D=p.getBBox().width,g=null,M-D<m?(g=Math.round(D-M+m),K[3]=Math.max(g,K[3])):M+D>q-m&&(g=Math.round(M+D-q+m),K[1]=Math.max(g,K[1])),0>O-y/2?K[0]=Math.max(Math.round(y/2-O),K[0]):O+y/2>n&&(K[2]=Math.max(Math.round(O+y/2-n),K[2])),p.sideOverflow=g)}),0===E(K)||this.verifyDataLabelOverflow(K))&&(this.placeDataLabels(),x&&v(this.points,function(a){var d;t=a.connector,(p=a.dataLabel)&&p._pos&&a.visible&&0<a.labelDistance?(N=p._attr.visibility,(d=!t)&&(a.connector=t=f.renderer.path().addClass("highcharts-data-label-connector  highcharts-color-"+a.colorIndex).add(c.dataLabelsGroup),t.attr({"stroke-width":x,stroke:k.connectorColor||a.color||"#666666"})),t[d?"attr":"animate"]({d:c.connectorPath(a.labelPos)}),t.attr("visibility",N)):t&&(a.connector=t.destroy())}))},f.pie.prototype.connectorPath=function(a){var b=a.x,c=a.y;return z(this.options.dataLabels.softConnector,!0)?["M",b+("left"===a[6]?5:-5),c,"C",b,c,2*a[2]-a[4],2*a[3]-a[5],a[2],a[3],"L",a[4],a[5]]:["M",b+("left"===a[6]?5:-5),c,"L",a[2],a[3],"L",a[4],a[5]]},f.pie.prototype.placeDataLabels=function(){v(this.points,function(a){var b=a.dataLabel;b&&a.visible&&((a=b._pos)?(b.sideOverflow&&(b._attr.width=b.getBBox().width-b.sideOverflow,b.css({width:b._attr.width+"px",textOverflow:"ellipsis"}),b.shortened=!0),b.attr(b._attr),b[b.moved?"animate":"attr"](a),b.moved=!0):b&&b.attr({y:-9999}))},this)},f.pie.prototype.alignDataLabel=u,f.pie.prototype.verifyDataLabelOverflow=function(a){var g,b=this.center,c=this.options,e=c.center,f=c.minSize||80,k=null!==c.size;return k||(null!==e[0]?g=Math.max(b[2]-Math.max(a[1],a[3]),f):(g=Math.max(b[2]-a[1]-a[3],f),b[0]+=(a[3]-a[1])/2),null!==e[1]?g=Math.max(Math.min(g,b[2]-Math.max(a[0],a[2])),f):(g=Math.max(Math.min(g,b[2]-a[0]-a[2]),f),b[1]+=(a[0]-a[2])/2),g<b[2]?(b[2]=g,b[3]=Math.min(m(c.innerSize||0,g),g),this.translate(b),this.drawDataLabels&&this.drawDataLabels()):k=!0),k}),f.column&&(f.column.prototype.alignDataLabel=function(a,b,e,f,k){var c=this.chart.inverted,l=a.series,r=a.dlBox||a.shapeArgs,n=z(a.below,a.plotY>z(this.translatedThreshold,l.yAxis.len)),m=z(e.inside,!!this.options.stacking);r&&(0>(f=t(r)).y&&(f.height+=f.y,f.y=0),0<(r=f.y+f.height-l.yAxis.len)&&(f.height-=r),c&&(f={x:l.yAxis.len-f.y-f.height,y:l.xAxis.len-f.x-f.width,width:f.height,height:f.width}),m||(c?(f.x+=n?0:f.width,f.width=0):(f.y+=n?f.height:0,f.height=0))),e.align=z(e.align,!c||m?"center":n?"right":"left"),e.verticalAlign=z(e.verticalAlign,c||m?"middle":n?"top":"bottom"),g.prototype.alignDataLabel.call(this,a,b,e,f,k),a.isLabelJustified&&a.contrastColor&&a.dataLabel.css({color:a.contrastColor})})}(L),function(a){var G=a.Chart,E=a.each,H=a.objectEach,v=a.pick;(a=a.addEvent)(G.prototype,"render",function(){var a=[];E(this.labelCollectors||[],function(k){a=a.concat(k())}),E(this.yAxis||[],function(k){k.options.stackLabels&&!k.options.stackLabels.allowOverlap&&H(k.stacks,function(k){H(k,function(k){a.push(k.label)})})}),E(this.series||[],function(k){var q=k.options.dataLabels,t=k.dataLabelCollections||["dataLabel"];(q.enabled||k._hasPointLabels)&&!q.allowOverlap&&k.visible&&E(t,function(q){E(k.points,function(k){k[q]&&(k[q].labelrank=v(k.labelrank,k.shapeArgs&&k.shapeArgs.height),a.push(k[q]))})})}),this.hideOverlappingLabels(a)}),G.prototype.hideOverlappingLabels=function(a){var v,t,u,z,m,g,f,e,c,k=a.length,b=function(a,b,c,e,f,g,n,k){return!(f>a+c||f+n<a||g>b+e||g+k<b)};for(t=0;t<k;t++)(v=a[t])&&(v.oldOpacity=v.opacity,v.newOpacity=1,v.width||(u=v.getBBox(),v.width=u.width,v.height=u.height));for(a.sort(function(a,b){return(b.labelrank||0)-(a.labelrank||0)}),t=0;t<k;t++)for(u=a[t],v=t+1;v<k;++v)z=a[v],u&&z&&u!==z&&u.placed&&z.placed&&0!==u.newOpacity&&0!==z.newOpacity&&(m=u.alignAttr,g=z.alignAttr,f=u.parentGroup,e=z.parentGroup,c=2*(u.box?0:u.padding||0),m=b(m.x+f.translateX,m.y+f.translateY,u.width-c,u.height-c,g.x+e.translateX,g.y+e.translateY,z.width-c,z.height-c))&&((u.labelrank<z.labelrank?u:z).newOpacity=0);E(a,function(a){var b,c;a&&(c=a.newOpacity,a.oldOpacity!==c&&a.placed&&(c?a.show(!0):b=function(){a.hide()},a.alignAttr.opacity=c,a[a.isOld?"animate":"attr"](a.alignAttr,null,b)),a.isOld=!0)})}}(L),function(a){var I,G=a.addEvent,E=a.Chart,H=a.createElement,v=a.css,k=a.defaultOptions,q=a.defaultPlotOptions,w=a.each,t=a.extend,u=a.fireEvent,z=a.hasTouch,m=a.inArray,g=a.isObject,f=a.Legend,e=a.merge,c=a.pick,b=a.Point,r=a.Series,l=a.seriesTypes,C=a.svg;I=a.TrackerMixin={drawTrackerPoint:function(){var a=this,b=a.chart.pointer,c=function(a){var c=b.getPointFromEvent(a);void 0!==c&&(b.isDirectTouch=!0,c.onMouseOver(a))};w(a.points,function(a){a.graphic&&(a.graphic.element.point=a),a.dataLabel&&(a.dataLabel.div?a.dataLabel.div.point=a:a.dataLabel.element.point=a)}),a._hasTracking||(w(a.trackerGroups,function(e){a[e]&&(a[e].addClass("highcharts-tracker").on("mouseover",c).on("mouseout",function(a){b.onTrackerMouseOut(a)}),z&&a[e].on("touchstart",c),a.options.cursor&&a[e].css(v).css({cursor:a.options.cursor}))}),a._hasTracking=!0)},drawTrackerGraph:function(){var k,a=this,b=a.options,c=b.trackByArea,e=[].concat(c?a.areaPath:a.graphPath),f=e.length,g=a.chart,d=g.pointer,p=g.renderer,l=g.options.tooltip.snap,h=a.tracker,m=function(){g.hoverSeries!==a&&a.onMouseOver()},r="rgba(192,192,192,"+(C?1e-4:.002)+")";if(f&&!c)for(k=f+1;k--;)"M"===e[k]&&e.splice(k+1,0,e[k+1]-l,e[k+2],"L"),(k&&"M"===e[k]||k===f)&&e.splice(k,0,"L",e[k-2]+l,e[k-1]);h?h.attr({d:e}):a.graph&&(a.tracker=p.path(e).attr({"stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:r,fill:c?r:"none","stroke-width":a.graph.strokeWidth()+(c?0:2*l),zIndex:2}).add(a.group),w([a.tracker,a.markerGroup],function(a){a.addClass("highcharts-tracker").on("mouseover",m).on("mouseout",function(a){d.onTrackerMouseOut(a)}),b.cursor&&a.css({cursor:b.cursor}),z&&a.on("touchstart",m)}))}},l.column&&(l.column.prototype.drawTracker=I.drawTrackerPoint),l.pie&&(l.pie.prototype.drawTracker=I.drawTrackerPoint),l.scatter&&(l.scatter.prototype.drawTracker=I.drawTrackerPoint),t(f.prototype,{setItemEvents:function(a,c,f){var n=this,g=n.chart.renderer.boxWrapper,l="highcharts-legend-"+(a instanceof b?"point":"series")+"-active";(f?c:a.legendGroup).on("mouseover",function(){a.setState("hover"),g.addClass(l),c.css(n.options.itemHoverStyle)}).on("mouseout",function(){c.css(e(a.visible?n.itemStyle:n.itemHiddenStyle)),g.removeClass(l),a.setState()}).on("click",function(d){var b=function(){a.setVisible&&a.setVisible()};g.removeClass(l),d={browserEvent:d},a.firePointEvent?a.firePointEvent("legendItemClick",d,b):u(a,"legendItemClick",d,b)})},createCheckboxForItem:function(a){a.checkbox=H("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},this.options.itemCheckboxStyle,this.chart.container),G(a.checkbox,"click",function(b){u(a.series||a,"checkboxClick",{checked:b.target.checked,item:a},function(){a.select()})})}}),k.legend.itemStyle.cursor="pointer",t(E.prototype,{showResetZoom:function(){var a=this,b=k.lang,c=a.options.chart.resetZoomButton,e=c.theme,f=e.states,g="chart"===c.relativeTo?null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,function(){a.zoomOut()},e,f&&f.hover).attr({align:c.position.align,title:b.resetZoomTitle}).addClass("highcharts-reset-zoom").add().align(c.position,!1,g)},zoomOut:function(){var a=this;u(a,"selection",{resetSelection:!0},function(){a.zoom()})},zoom:function(a){var b,l,e=this.pointer,f=!1;!a||a.resetSelection?(w(this.axes,function(a){b=a.zoom()}),e.initiated=!1):w(a.xAxis.concat(a.yAxis),function(a){var d=a.axis;e[d.isXAxis?"zoomX":"zoomY"]&&(b=d.zoom(a.min,a.max),d.displayBtn&&(f=!0))}),l=this.resetZoomButton,f&&!l?this.showResetZoom():!f&&g(l)&&(this.resetZoomButton=l.destroy()),b&&this.redraw(c(this.options.chart.animation,a&&a.animation,100>this.pointCount))},pan:function(a,b){var f,c=this,e=c.hoverPoints;e&&w(e,function(a){a.setState()}),w("xy"===b?[1,0]:[1],function(b){var m,d=(b=c[b?"xAxis":"yAxis"][0]).horiz,e=a[d?"chartX":"chartY"],g=c[d=d?"mouseDownX":"mouseDownY"],h=(b.pointRange||0)/2,n=b.getExtremes(),l=b.toValue(g-e,!0)+h,k=(g=(m=(k=b.toValue(g+b.len-e,!0)-h)<l)?k:l,l=m?l:k,Math.min(n.dataMin,h?n.min:b.toValue(b.toPixels(n.min)-b.minPixelPadding)));h=Math.max(n.dataMax,h?n.max:b.toValue(b.toPixels(n.max)+b.minPixelPadding));0<(m=k-g)&&(l+=m,g=k),0<(m=l-h)&&(l=h,g-=m),b.series.length&&g!==n.min&&l!==n.max&&(b.setExtremes(g,l,!1,!1,{trigger:"pan"}),f=!0),c[d]=e}),f&&c.redraw(!1),v(c.container,{cursor:"move"})}}),t(b.prototype,{select:function(a,b){var e=this,f=e.series,g=f.chart;a=c(a,!e.selected),e.firePointEvent(a?"select":"unselect",{accumulate:b},function(){e.selected=e.options.selected=a,f.options.data[m(e,f.data)]=e.options,e.setState(a&&"select"),b||w(g.getSelectedPoints(),function(a){a.selected&&a!==e&&(a.selected=a.options.selected=!1,f.options.data[m(a,f.data)]=a.options,a.setState(""),a.firePointEvent("unselect"))})})},onMouseOver:function(a){var b=this.series.chart,c=b.pointer;a=a?c.normalize(a):c.getChartCoordinatesFromPoint(this,b.inverted),c.runPointActions(a,this)},onMouseOut:function(){var a=this.series.chart;this.firePointEvent("mouseOut"),w(a.hoverPoints||[],function(a){a.setState()}),a.hoverPoints=a.hoverPoint=null},importEvents:function(){if(!this.hasImportedEvents){var b=this,c=e(b.series.options.point,b.options).events;b.events=c,a.objectEach(c,function(a,c){G(b,c,a)}),this.hasImportedEvents=!0}},setState:function(a,b){var v,e=Math.floor(this.plotX),f=this.plotY,g=this.series,l=g.options.states[a]||{},d=q[g.type].marker&&g.options.marker,p=d&&!1===d.enabled,k=d&&d.states&&d.states[a]||{},h=!1===k.enabled,m=g.stateMarkerGraphic,r=this.marker||{},x=g.chart,u=g.halo,F=d&&g.markerAttribs;(a=a||"")===this.state&&!b||this.selected&&"select"!==a||!1===l.enabled||a&&(h||p&&!1===k.enabled)||a&&r.states&&r.states[a]&&!1===r.states[a].enabled||(F&&(v=g.markerAttribs(this,a)),this.graphic?(this.state&&this.graphic.removeClass("highcharts-point-"+this.state),a&&this.graphic.addClass("highcharts-point-"+a),this.graphic.animate(g.pointAttribs(this,a),c(x.options.chart.animation,l.animation)),v&&this.graphic.animate(v,c(x.options.chart.animation,k.animation,d.animation)),m&&m.hide()):(a&&k&&(d=r.symbol||g.symbol,m&&m.currentSymbol!==d&&(m=m.destroy()),m?m[b?"animate":"attr"]({x:v.x,y:v.y}):d&&(g.stateMarkerGraphic=m=x.renderer.symbol(d,v.x,v.y,v.width,v.height).add(g.markerGroup),m.currentSymbol=d),m&&m.attr(g.pointAttribs(this,a))),m&&(m[a&&x.isInsidePlot(e,f,x.inverted)?"show":"hide"](),m.element.point=this)),(e=l.halo)&&e.size?(u||(g.halo=u=x.renderer.path().add((this.graphic||m).parentGroup)),u[b?"animate":"attr"]({d:this.haloPath(e.size)}),u.attr({class:"highcharts-halo highcharts-color-"+c(this.colorIndex,g.colorIndex)}),u.point=this,u.attr(t({fill:this.color||g.color,"fill-opacity":e.opacity,zIndex:-1},e.attributes))):u&&u.point&&u.point.haloPath&&u.animate({d:u.point.haloPath(0)}),this.state=a)},haloPath:function(a){return this.series.chart.renderer.symbols.circle(Math.floor(this.plotX)-a,this.plotY-a,2*a,2*a)}}),t(r.prototype,{onMouseOver:function(){var a=this.chart,b=a.hoverSeries;b&&b!==this&&b.onMouseOut(),this.options.events.mouseOver&&u(this,"mouseOver"),this.setState("hover"),a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,e=b.hoverPoint;b.hoverSeries=null,e&&e.onMouseOut(),this&&a.events.mouseOut&&u(this,"mouseOut"),!c||this.stickyTracking||c.shared&&!this.noSharedTooltip||c.hide(),this.setState()},setState:function(a){var b=this,e=b.options,f=b.graph,g=e.states,l=e.lineWidth;e=0;if(a=a||"",b.state!==a&&(w([b.group,b.markerGroup,b.dataLabelsGroup],function(d){d&&(b.state&&d.removeClass("highcharts-series-"+b.state),a&&d.addClass("highcharts-series-"+a))}),b.state=a,!g[a]||!1!==g[a].enabled)&&(a&&(l=g[a].lineWidth||l+(g[a].lineWidthPlus||0)),f&&!f.dashstyle))for(l={"stroke-width":l},f.animate(l,c(b.chart.options.chart.animation,g[a]&&g[a].animation));b["zone-graph-"+e];)b["zone-graph-"+e].attr(l),e+=1},setVisible:function(a,b){var g,c=this,e=c.chart,f=c.legendItem,d=e.options.chart.ignoreHiddenSeries,p=c.visible;g=(c.visible=a=c.options.visible=c.userOptions.visible=void 0===a?!p:a)?"show":"hide",w(["group","dataLabelsGroup","markerGroup","tracker","tt"],function(a){c[a]&&c[a][g]()}),e.hoverSeries!==c&&(e.hoverPoint&&e.hoverPoint.series)!==c||c.onMouseOut(),f&&e.legend.colorizeItem(c,a),c.isDirty=!0,c.options.stacking&&w(e.series,function(a){a.options.stacking&&a.visible&&(a.isDirty=!0)}),w(c.linkedSeries,function(b){b.setVisible(a,!1)}),d&&(e.isDirtyBox=!0),!1!==b&&e.redraw(),u(c,g)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=a=void 0===a?!this.selected:a,this.checkbox&&(this.checkbox.checked=a),u(this,a?"select":"unselect")},drawTracker:I.drawTrackerGraph})}(L),function(a){var G=a.Chart,E=a.each,H=a.inArray,v=a.isArray,k=a.isObject,q=a.pick,w=a.splat;G.prototype.setResponsive=function(k){var q=this.options.responsive,t=[],m=this.currentResponsive;q&&q.rules&&E(q.rules,function(f){void 0===f._id&&(f._id=a.uniqueKey()),this.matchResponsiveRule(f,t,k)},this);var g=a.merge.apply(0,a.map(t,function(f){return a.find(q.rules,function(a){return a._id===f}).chartOptions}));(t=t.toString()||void 0)!==(m&&m.ruleIds)&&(m&&this.update(m.undoOptions,k),t?(this.currentResponsive={ruleIds:t,mergedOptions:g,undoOptions:this.currentOptions(g)},this.update(g,k)):this.currentResponsive=void 0)},G.prototype.matchResponsiveRule=function(a,k){var t=a.condition;(t.callback||function(){return this.chartWidth<=q(t.maxWidth,Number.MAX_VALUE)&&this.chartHeight<=q(t.maxHeight,Number.MAX_VALUE)&&this.chartWidth>=q(t.minWidth,0)&&this.chartHeight>=q(t.minHeight,0)}).call(this)&&k.push(a._id)},G.prototype.currentOptions=function(q){var z={};return function t(m,g,f,e){var c;a.objectEach(m,function(a,m){if(!e&&-1<H(m,["series","xAxis","yAxis"]))for(a=w(a),f[m]=[],c=0;c<a.length;c++)g[m][c]&&(f[m][c]={},t(a[c],g[m][c],f[m][c],e+1));else k(a)?(f[m]=v(a)?[]:{},t(a,g[m]||{},f[m],e+1)):f[m]=g[m]||null})}(q,this.options,z,0),z}}(L),function(a){var G=a.addEvent,E=a.Axis,H=a.Chart,v=a.css,k=a.dateFormat,q=a.defined,w=a.each,t=a.extend,u=a.noop,z=a.pick,m=a.timeUnits,g=a.wrap;g(a.Series.prototype,"init",function(a){var e;a.apply(this,Array.prototype.slice.call(arguments,1)),(e=this.xAxis)&&e.options.ordinal&&G(this,"updatedData",function(){delete e.ordinalIndex})}),g(E.prototype,"getTimeTicks",function(a,e,c,b,g,l,t,u){var r,n,C,A,d,f=0,v={},p=[],D=-Number.MAX_VALUE,h=this.options.tickPixelInterval;if(!this.options.ordinal&&!this.options.breaks||!l||3>l.length||void 0===c)return a.call(this,e,c,b,g);for(A=l.length,r=0;r<A;r++){if(d=r&&l[r-1]>b,l[r]<c&&(f=r),r===A-1||l[r+1]-l[r]>5*t||d){if(l[r]>D){for(n=a.call(this,e,l[f],l[r],g);n.length&&n[0]<=D;)n.shift();n.length&&(D=n[n.length-1]),p=p.concat(n)}f=r+1}if(d)break}if(a=n.info,u&&a.unitRange<=m.hour){for(r=p.length-1,f=1;f<r;f++)k("%d",p[f])!==k("%d",p[f-1])&&(v[p[f]]="day",C=!0);C&&(v[p[0]]="day"),a.higherRanks=v}if(p.info=a,u&&q(h)){var y;for(u=a=p.length,r=[],C=[];u--;)f=this.translate(p[u]),y&&(C[u]=y-f),r[u]=y=f;for(C.sort(),(C=C[Math.floor(C.length/2)])<.6*h&&(C=null),u=p[a-1]>b?a-1:a,y=void 0;u--;)f=r[u],b=Math.abs(y-f),y&&b<.8*h&&(null===C||b<.8*C)?(v[p[u]]&&!v[p[u+1]]?(b=u+1,y=f):b=u,p.splice(b,1)):y=f}return p}),t(E.prototype,{beforeSetTickPositions:function(){var a,b,m,e=[],c=!1,l=(g=this.getExtremes()).min,k=g.max,t=this.isXAxis&&!!this.options.breaks,g=this.options.ordinal,u=Number.MAX_VALUE,n=this.chart.options.chart.ignoreHiddenSeries;if(b="highcharts-navigator-xaxis"===this.options.className,!this.options.overscroll||this.max!==this.dataMax||this.chart.mouseIsDown&&!b||this.eventArgs&&(!this.eventArgs||"navigator"===this.eventArgs.trigger)||(this.max+=this.options.overscroll,!b&&q(this.userMin)&&(this.min+=this.options.overscroll)),g||t){if(w(this.series,function(b,c){if(!(n&&!1===b.visible||!1===b.takeOrdinalPosition&&!t)&&(e=e.concat(b.processedXData),a=e.length,e.sort(function(a,b){return a-b}),u=Math.min(u,z(b.closestPointRange,u)),a))for(c=a-1;c--;)e[c]===e[c+1]&&e.splice(c,1)}),2<(a=e.length)){for(b=e[1]-e[0],m=a-1;m--&&!c;)e[m+1]-e[m]!==b&&(c=!0);!this.options.keepOrdinalPadding&&(e[0]-l>b||k-e[e.length-1]>b)&&(c=!0)}else this.options.overscroll&&(2===a?u=e[1]-e[0]:1===a?(u=this.options.overscroll,e=[e[0],e[0]+u]):u=this.overscrollPointsRange);c?(this.options.overscroll&&(this.overscrollPointsRange=u,e=e.concat(this.getOverscrollPositions())),this.ordinalPositions=e,b=this.ordinal2lin(Math.max(l,e[0]),!0),m=Math.max(this.ordinal2lin(Math.min(k,e[e.length-1]),!0),1),this.ordinalSlope=k=(k-l)/(m-b),this.ordinalOffset=l-b*k):(this.overscrollPointsRange=z(this.closestPointRange,this.overscrollPointsRange),this.ordinalPositions=this.ordinalSlope=this.ordinalOffset=void 0)}this.isOrdinal=g&&c,this.groupIntervalFactor=null},val2lin:function(a,e){var c=this.ordinalPositions;if(c){var f,g,b=c.length;for(f=b;f--;)if(c[f]===a){g=f;break}for(f=b-1;f--;)if(a>c[f]||0===f){g=f+(a=(a-c[f])/(c[f+1]-c[f]));break}e=e?g:this.ordinalSlope*(g||0)+this.ordinalOffset}else e=a;return e},lin2val:function(a,e){var c=this.ordinalPositions;if(c){var k,b=this.ordinalSlope,f=this.ordinalOffset,g=c.length-1;if(e)0>a?a=c[0]:a>g?a=c[g]:k=a-(g=Math.floor(a));else for(;g--;)if(a>=(e=b*g+f)){k=(a-e)/((b=b*(g+1)+f)-e);break}return void 0!==k&&void 0!==c[g]?c[g]+(k?k*(c[g+1]-c[g]):0):a}return a},getExtendedPositions:function(){var m,q,a=this,e=a.chart,c=a.series[0].currentDataGrouping,b=a.ordinalIndex,g=c?c.count+c.unitName:"raw",l=a.options.overscroll,k=a.getExtremes();return b||(b=a.ordinalIndex={}),b[g]||(m={series:[],chart:e,getExtremes:function(){return{min:k.dataMin,max:k.dataMax+l}},options:{ordinal:!0},val2lin:E.prototype.val2lin,ordinal2lin:E.prototype.ordinal2lin},w(a.series,function(b){(q={xAxis:m,xData:b.xData.slice(),chart:e,destroyGroupedData:u}).xData=q.xData.concat(a.getOverscrollPositions()),q.options={dataGrouping:c?{enabled:!0,forced:!0,approximation:"open",units:[[c.unitName,[c.count]]]}:{enabled:!1}},b.processData.apply(q),m.series.push(q)}),a.beforeSetTickPositions.apply(m),b[g]=m.ordinalPositions),b[g]},getOverscrollPositions:function(){var f=this.options.overscroll,e=this.overscrollPointsRange,c=[],b=this.dataMax;if(a.defined(e))for(c.push(b);b<=this.dataMax+f;)b+=e,c.push(b);return c},getGroupIntervalFactor:function(a,e,c){var b,f=(c=c.processedXData).length,g=[];if(!(b=this.groupIntervalFactor)){for(b=0;b<f-1;b++)g[b]=c[b+1]-c[b];g.sort(function(a,b){return a-b}),g=g[Math.floor(f/2)],a=Math.max(a,c[0]),e=Math.min(e,c[f-1]),this.groupIntervalFactor=b=f*g/(e-a)}return b},postProcessTickInterval:function(a){var e=this.ordinalSlope;return e?this.options.breaks?this.closestPointRange||a:a/(e/this.closestPointRange):a}}),E.prototype.ordinal2lin=E.prototype.val2lin,g(H.prototype,"pan",function(a,e){var c=this.xAxis[0],b=c.options.overscroll,f=e.chartX,g=!1;if(c.options.ordinal&&c.series.length){var p,k=this.mouseDownX,m=c.getExtremes(),q=m.dataMax,t=m.min,n=m.max,u=this.hoverPoints,z=c.closestPointRange||c.overscrollPointsRange,A=(k=(k-f)/(c.translationSlope*(c.ordinalSlope||z)),{ordinalPositions:c.getExtendedPositions()}),d=(z=c.lin2val,c.val2lin);A.ordinalPositions?1<Math.abs(k)&&(u&&w(u,function(a){a.setState()}),0>k?(u=A,p=c.ordinalPositions?c:A):(u=c.ordinalPositions?c:A,p=A),q>(A=p.ordinalPositions)[A.length-1]&&A.push(q),this.fixedRange=n-t,(k=c.toFixedRange(null,null,z.apply(u,[d.apply(u,[t,!0])+k,!0]),z.apply(p,[d.apply(p,[n,!0])+k,!0]))).min>=Math.min(m.dataMin,t)&&k.max<=Math.max(q,n)+b&&c.setExtremes(k.min,k.max,!0,!1,{trigger:"pan"}),this.mouseDownX=f,v(this.container,{cursor:"move"})):g=!0}else g=!0;g&&(b&&(c.max=c.dataMax+b),a.apply(this,Array.prototype.slice.call(arguments,1)))})}(L),function(a){function E(a){a.apply(this),this.drawBreaks(this.xAxis,["x"]),this.drawBreaks(this.yAxis,H(this.pointArrayMap,["y"]))}var H=a.pick,v=a.wrap,k=a.each,q=a.extend,w=a.isArray,t=a.fireEvent,u=a.Axis,z=a.Series;q(u.prototype,{isInBreak:function(a,g){var f=a.repeat||1/0,e=a.from,c=a.to-a.from;return g=g>=e?(g-e)%f:f-(e-g)%f,a.inclusive?g<=c:g<c&&0!==g},isInAnyBreak:function(a,g){var c,b,k,f=this.options.breaks,e=f&&f.length;if(e){for(;e--;)this.isInBreak(f[e],a)&&(c=!0,b||(b=H(f[e].showPoints,!this.isXAxis)));k=c&&g?c&&!b:c}return k}}),v(u.prototype,"setTickPositions",function(a){if(a.apply(this,Array.prototype.slice.call(arguments,1)),this.options.breaks){var c,g=this.tickPositions,f=this.tickPositions.info,e=[];for(c=0;c<g.length;c++)this.isInAnyBreak(g[c])||e.push(g[c]);this.tickPositions=e,this.tickPositions.info=f}}),v(u.prototype,"init",function(a,g,f){var e=this;f.breaks&&f.breaks.length&&(f.ordinal=!1),a.call(this,g,f),a=this.options.breaks,e.isBroken=w(a)&&!!a.length,e.isBroken&&(e.val2lin=function(a){var c,f,b=a;for(f=0;f<e.breakArray.length;f++)if((c=e.breakArray[f]).to<=a)b-=c.len;else{if(c.from>=a)break;if(e.isInBreak(c,a)){b-=a-c.from;break}}return b},e.lin2val=function(a){var b,c;for(c=0;c<e.breakArray.length&&!((b=e.breakArray[c]).from>=a);c++)b.to<a?a+=b.len:e.isInBreak(b,a)&&(a+=b.len);return a},e.setExtremes=function(a,b,e,f,g){for(;this.isInAnyBreak(a);)a-=this.closestPointRange;for(;this.isInAnyBreak(b);)b-=this.closestPointRange;u.prototype.setExtremes.call(this,a,b,e,f,g)},e.setAxisTranslation=function(a){u.prototype.setAxisTranslation.call(this,a),a=e.options.breaks;var g,m,B,w,b=[],c=[],f=0,q=e.userMin||e.min,v=e.userMax||e.max,n=H(e.pointRangePadding,0);k(a,function(a){m=a.repeat||1/0,e.isInBreak(a,q)&&(q+=a.to%m-q%m),e.isInBreak(a,v)&&(v-=v%m-a.from%m)}),k(a,function(a){for(B=a.from,m=a.repeat||1/0;B-m>q;)B-=m;for(;B<q;)B+=m;for(w=B;w<v;w+=m)b.push({value:w,move:"in"}),b.push({value:w+(a.to-a.from),move:"out",size:a.breakSize})}),b.sort(function(a,b){return a.value===b.value?("in"===a.move?0:1)-("in"===b.move?0:1):a.value-b.value}),g=0,B=q,k(b,function(a){1===(g+="in"===a.move?1:-1)&&"in"===a.move&&(B=a.value),0===g&&(c.push({from:B,to:a.value,len:a.value-B-(a.size||0)}),f+=a.value-B-(a.size||0))}),e.breakArray=c,e.unitLength=v-q-f+n,t(e,"afterBreaks"),e.options.staticScale?e.transA=e.options.staticScale:e.unitLength&&(e.transA*=(v-e.min+n)/e.unitLength),n&&(e.minPixelPadding=e.transA*e.minPointOffset),e.min=q,e.max=v})}),v(z.prototype,"generatePoints",function(a){a.apply(this,function(){return Array.prototype.slice.call(arguments,1)}(arguments));var c,g=this.xAxis,f=this.yAxis,e=this.points,b=e.length,k=this.options.connectNulls;if(g&&f&&(g.options.breaks||f.options.breaks))for(;b--;)null===(c=e[b]).y&&!1===k||!g.isInAnyBreak(c.x,!0)&&!f.isInAnyBreak(c.y,!0)||(e.splice(b,1),this.data[b]&&this.data[b].destroyElements())}),a.Series.prototype.drawBreaks=function(a,g){var c,b,m,l,f=this,e=f.points;a&&k(g,function(g){c=a.breakArray||[],b=a.isXAxis?a.min:H(f.options.threshold,a.min),k(e,function(e){l=H(e["stack"+g.toUpperCase()],e[g]),k(c,function(c){m=!1,b<c.from&&l>c.to||b>c.from&&l<c.from?m="pointBreak":(b<c.from&&l>c.from&&l<c.to||b>c.from&&l>c.to&&l<c.from)&&(m="pointInBreak"),m&&t(a,m,{point:e,brk:c})})})})},a.Series.prototype.gappedPath=function(){var c,k=this.options.gapSize,g=this.points.slice(),f=g.length-1,e=this.yAxis;if(k&&0<f)for("value"!==this.options.gapUnit&&(k*=this.closestPointRange);f--;)g[f+1].x-g[f].x>k&&(c=(g[f].x+g[f+1].x)/2,g.splice(f+1,0,{isNull:!0,x:c}),this.options.stacking&&((c=e.stacks[this.stackKey][c]=new a.StackItem(e,e.options.stackLabels,!1,c,this.stack)).total=0));return this.getGraphPath(g)},v(a.seriesTypes.column.prototype,"drawPoints",E),v(a.Series.prototype,"drawPoints",E)}(L),function(a){var G=a.arrayMax,E=a.arrayMin,H=a.Axis,v=a.defaultPlotOptions,k=a.defined,q=a.each,w=a.extend,t=a.format,u=a.isNumber,z=a.merge,m=a.pick,g=a.Point,f=a.Tooltip,e=a.wrap,c=a.Series.prototype,b=c.processData,r=c.generatePoints,l={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:{millisecond:["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],second:["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],minute:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],hour:["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],day:["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],week:["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],month:["%B %Y","%B","-%B %Y"],year:["%Y","%Y","-%Y"]}},C={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},I=a.defaultDataGroupingUnits=[["millisecond",[1,2,5,10,20,25,50,100,200,500]],["second",[1,2,5,10,15,30]],["minute",[1,2,5,10,15,30]],["hour",[1,2,3,4,6,8,12]],["day",[1]],["week",[1]],["month",[1,3,6]],["year",null]],x=a.approximations={sum:function(a){var c,b=a.length;if(!b&&a.hasNulls)c=null;else if(b)for(c=0;b--;)c+=a[b];return c},average:function(a){var b=a.length;return a=x.sum(a),u(a)&&b&&(a/=b),a},averages:function(){var a=[];return q(arguments,function(b){a.push(x.average(b))}),void 0===a[0]?void 0:a},open:function(a){return a.length?a[0]:a.hasNulls?null:void 0},high:function(a){return a.length?G(a):a.hasNulls?null:void 0},low:function(a){return a.length?E(a):a.hasNulls?null:void 0},close:function(a){return a.length?a[a.length-1]:a.hasNulls?null:void 0},ohlc:function(a,b,c,e){if(a=x.open(a),b=x.high(b),c=x.low(c),e=x.close(e),u(a)||u(b)||u(c)||u(e))return[a,b,c,e]},range:function(a,b){return a=x.low(a),b=x.high(b),u(a)||u(b)?[a,b]:null===a&&null===b?null:void 0}};c.groupData=function(a,b,c,e){var m,r,f=this.data,d=this.options.data,g=[],n=[],h=[],k=a.length,t=!!b,v=[];e="function"==typeof e?e:x[e]||C[this.type]&&x[C[this.type].approximation]||x[l.approximation];var F,J,B=this.pointArrayMap,w=B&&B.length,z=0;for(r=0,w?q(B,function(){v.push([])}):v.push([]),F=w||1,J=0;J<=k&&!(a[J]>=c[0]);J++);for(;J<=k;J++){for(;void 0!==c[z+1]&&a[J]>=c[z+1]||J===k;){for(m=c[z],this.dataGroupInfo={start:r,length:v[0].length},void 0!==(r=e.apply(this,v))&&(g.push(m),n.push(r),h.push(this.dataGroupInfo)),r=J,m=0;m<F;m++)v[m].length=0,v[m].hasNulls=!1;if(z+=1,J===k)break}if(J===k)break;if(B){m=this.cropStart+J;var I,E=f&&f[m]||this.pointClass.prototype.applyOptions.apply({series:this},[d[m]]);for(m=0;m<w;m++)I=E[B[m]],u(I)?v[m].push(I):null===I&&(v[m].hasNulls=!0)}else m=t?b[J]:null,u(m)?v[0].push(m):null===m&&(v[0].hasNulls=!0)}return[g,n,h]},c.processData=function(){var l,p,a=this.chart,e=this.options.dataGrouping,f=!1!==this.allowDG&&e&&m(e.enabled,a.options.isStock),g=this.visible||!a.options.chart.ignoreHiddenSeries,d=this.currentDataGrouping;if(this.forceCrop=f,this.groupPixelWidth=null,this.hasProcessed=!0,!1!==b.apply(this,arguments)&&f){this.destroyGroupedData();var q=this.processedXData,h=this.processedYData,r=a.plotSizeX,t=(a=this.xAxis).options.ordinal,u=this.groupPixelWidth=a.getGroupPixelWidth&&a.getGroupPixelWidth();if(u){if(this.isDirty=l=!0,this.points=null,p=(f=a.getExtremes()).min,u=u*((f=f.max)-p)/r*(t=t&&a.getGroupIntervalFactor(p,f,this)||1),r=a.getTimeTicks(a.normalizeTimeTickInterval(u,e.units||I),Math.min(p,q[0]),Math.max(f,q[q.length-1]),a.options.startOfWeek,q,this.closestPointRange),h=(q=c.groupData.apply(this,[q,h,r,e.approximation]))[0],t=q[1],e.smoothed&&h.length){for(h[e=h.length-1]=Math.min(h[e],f);e--&&0<e;)h[e]+=u/2;h[0]=Math.max(h[0],p)}p=r.info,this.closestPointRange=r.info.totalRange,this.groupMap=q[2],k(h[0])&&h[0]<a.dataMin&&g&&(a.min===a.dataMin&&(a.min=h[0]),a.dataMin=h[0]),this.processedXData=h,this.processedYData=t}else this.groupMap=null;this.hasGroupedData=l,this.currentDataGrouping=p,this.preventGraphAnimation=(d&&d.totalRange)!==(p&&p.totalRange)}},c.destroyGroupedData=function(){var a=this.groupedData;q(a||[],function(b,c){b&&(a[c]=b.destroy?b.destroy():null)}),this.groupedData=null},c.generatePoints=function(){r.apply(this),this.destroyGroupedData(),this.groupedData=this.hasGroupedData?this.points:null},e(g.prototype,"update",function(b){this.dataGroup?a.error(24):b.apply(this,[].slice.call(arguments,1))}),e(f.prototype,"tooltipFooterHeaderFormatter",function(b,c,e){var l,f=c.series,g=f.tooltipOptions,d=f.options.dataGrouping,p=g.xDateFormat,h=f.xAxis,n=a.dateFormat;return h&&"datetime"===h.options.type&&d&&u(c.key)?(b=f.currentDataGrouping,d=d.dateTimeLabelFormats,b?(h=d[b.unitName],1===b.count?p=h[0]:(p=h[1],l=h[2])):!p&&d&&(p=this.getXDateFormat(c,g,h)),p=n(p,c.key),l&&(p+=n(l,c.key+b.totalRange-1)),t(g[(e?"footer":"header")+"Format"],{point:w(c.point,{key:p}),series:f})):b.call(this,c,e)}),e(c,"destroy",function(a){a.call(this),this.destroyGroupedData()}),e(c,"setOptions",function(a,b){a=a.call(this,b);var c=this.type,e=this.chart.options.plotOptions,f=v[c].dataGrouping;return C[c]&&(f||(f=z(l,C[c])),a.dataGrouping=z(f,e.series&&e.series.dataGrouping,e[c].dataGrouping,b.dataGrouping)),this.chart.options.isStock&&(this.requireSorting=!0),a}),e(H.prototype,"setScale",function(a){a.call(this),q(this.series,function(a){a.hasProcessed=!1})}),H.prototype.getGroupPixelWidth=function(){var c,d,a=this.series,b=a.length,e=0,f=!1;for(c=b;c--;)(d=a[c].options.dataGrouping)&&(e=Math.max(e,d.groupPixelWidth));for(c=b;c--;)(d=a[c].options.dataGrouping)&&a[c].hasProcessed&&(b=(a[c].processedXData||a[c].data).length,a[c].groupPixelWidth||b>this.chart.plotSizeX/e||b&&d.forced)&&(f=!0);return f?e:0},H.prototype.setDataGrouping=function(a,b){var c;if(b=m(b,!0),a||(a={forced:!1,units:null}),this instanceof H)for(c=this.series.length;c--;)this.series[c].update({dataGrouping:a},!1);else q(this.chart.options.series,function(b){b.dataGrouping=a},!1);b&&this.chart.redraw()}}(L),function(a){var G=a.each,E=a.Point,H=a.seriesType,v=a.seriesTypes;H("ohlc","column",{lineWidth:1,tooltip:{pointFormat:'<span style="color:{point.color}">●</span> <b> {series.name}</b><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},threshold:null,states:{hover:{lineWidth:3}},stickyTracking:!0},{directTouch:!1,pointArrayMap:["open","high","low","close"],toYData:function(a){return[a.open,a.high,a.low,a.close]},pointValKey:"close",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},pointAttribs:function(a,q){q=v.column.prototype.pointAttribs.call(this,a,q);var k=this.options;return delete q.fill,!a.options.color&&k.upColor&&a.open<a.close&&(q.stroke=k.upColor),q},translate:function(){var a=this,q=a.yAxis,w=!!a.modifyValue,t=["plotOpen","plotHigh","plotLow","plotClose","yBottom"];v.column.prototype.translate.apply(a),G(a.points,function(k){G([k.open,k.high,k.low,k.close,k.low],function(u,m){null!==u&&(w&&(u=a.modifyValue(u)),k[t[m]]=q.toPixels(u,!0))}),k.tooltipPos[1]=k.plotHigh+q.pos-a.chart.plotTop})},drawPoints:function(){var a=this,q=a.chart;G(a.points,function(k){var t,u,v,m,f,g=k.graphic,e=!g;void 0!==k.plotY&&(g||(k.graphic=g=q.renderer.path().add(a.group)),g.attr(a.pointAttribs(k,k.selected&&"select")),u=g.strokeWidth()%2/2,f=Math.round(k.plotX)-u,v=Math.round(k.shapeArgs.width/2),m=["M",f,Math.round(k.yBottom),"L",f,Math.round(k.plotHigh)],null!==k.open&&(t=Math.round(k.plotOpen)+u,m.push("M",f,t,"L",f-v,t)),null!==k.close&&(t=Math.round(k.plotClose)+u,m.push("M",f,t,"L",f+v,t)),g[e?"attr":"animate"]({d:m}).addClass(k.getClassName(),!0))})},animate:null},{getClassName:function(){return E.prototype.getClassName.call(this)+(this.open<this.close?" highcharts-point-up":" highcharts-point-down")}})}(L),function(a){var G=a.defaultPlotOptions,E=a.each,H=a.merge,v=a.seriesType,k=a.seriesTypes;v("candlestick","ohlc",H(G.column,{states:{hover:{lineWidth:2}},tooltip:G.ohlc.tooltip,threshold:null,lineColor:"#000000",lineWidth:1,upColor:"#ffffff",stickyTracking:!0}),{pointAttribs:function(a,v){var q=k.column.prototype.pointAttribs.call(this,a,v),u=this.options,w=a.open<a.close,m=u.lineColor||this.color;return q["stroke-width"]=u.lineWidth,q.fill=a.options.color||w&&u.upColor||this.color,q.stroke=a.lineColor||w&&u.upLineColor||m,v&&(a=u.states[v],q.fill=a.color||q.fill,q.stroke=a.lineColor||q.stroke,q["stroke-width"]=a.lineWidth||q["stroke-width"]),q},drawPoints:function(){var a=this,k=a.chart;E(a.points,function(q){var v,m,g,f,e,c,b,t=q.graphic,r=!t;void 0!==q.plotY&&(t||(q.graphic=t=k.renderer.path().add(a.group)),t.attr(a.pointAttribs(q,q.selected&&"select")).shadow(a.options.shadow),e=t.strokeWidth()%2/2,c=Math.round(q.plotX)-e,v=q.plotOpen,m=q.plotClose,g=Math.min(v,m),v=Math.max(v,m),b=Math.round(q.shapeArgs.width/2),m=Math.round(g)!==Math.round(q.plotHigh),f=v!==q.yBottom,g=Math.round(g)+e,v=Math.round(v)+e,(e=[]).push("M",c-b,v,"L",c-b,g,"L",c+b,g,"L",c+b,v,"Z","M",c,g,"L",c,m?Math.round(q.plotHigh):g,"M",c,v,"L",c,f?Math.round(q.yBottom):v),t[r?"attr":"animate"]({d:e}).addClass(q.getClassName(),!0))})}})}(L),function(a,G){function E(a){m[a+"pin"]=function(f,e,c,b,g){var l=g&&g.anchorX;return g=g&&g.anchorY,"circle"===a&&b>c&&(f-=Math.round((b-c)/2),c=b),f=m[a](f,e,c,b),l&&g&&(f.push("M","circle"===a?f[1]-f[4]:f[1]+f[4]/2,e>g?e:e+b,"L",l,g),f=f.concat(m.circle(l-1,g-1,2,2))),f}}var H=a.addEvent,v=a.each,k=a.merge,q=a.noop,w=a.Renderer,t=a.seriesType,u=a.TrackerMixin,z=a.VMLRenderer,m=a.SVGRenderer.prototype.symbols;t("flags","column",{pointRange:0,allowOverlapX:!1,shape:"flag",stackDistance:12,textAlign:"center",tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30,fillColor:"#ffffff",lineWidth:1,states:{hover:{lineColor:"#000000",fillColor:"#ccd6eb"}},style:{fontSize:"11px",fontWeight:"bold"}},{sorted:!1,noSharedTooltip:!0,allowDG:!1,takeOrdinalPosition:!1,trackerGroups:["markerGroup"],forceCrop:!0,init:a.Series.prototype.init,pointAttribs:function(a,f){var e=this.options,c=a&&a.color||this.color,b=e.lineColor,g=a&&a.lineWidth;return a=a&&a.fillColor||e.fillColor,f&&(a=e.states[f].fillColor,b=e.states[f].lineColor,g=e.states[f].lineWidth),{fill:a||c,stroke:b||c,"stroke-width":g||e.lineWidth||0}},translate:G.translate,drawPoints:function(){var c,b,q,t,u,w,n,B,g=this.points,f=this.chart,e=f.renderer,m=this.options,l=m.y,z=this.yAxis,A={},d=[];for(t=g.length;t--;)B=(u=g[t]).plotX>this.xAxis.len,c=u.plotX,w=u.stackIndex,q=u.options.shape||m.shape,void 0!==(b=u.plotY)&&(b=u.plotY+l-(void 0!==w&&w*m.stackDistance)),u.anchorX=w?void 0:u.plotX,n=w?void 0:u.plotY,w=u.graphic,void 0!==b&&0<=c&&!B?(w||(w=u.graphic=e.label("",null,null,q,null,null,m.useHTML).attr(this.pointAttribs(u)).css(k(m.style,u.style)).attr({align:"flag"===q?"left":"center",width:m.width,height:m.height,"text-align":m.textAlign}).addClass("highcharts-point").add(this.markerGroup),u.graphic.div&&(u.graphic.div.point=u),w.shadow(m.shadow),w.isNew=!0),0<c&&(c-=w.strokeWidth()%2),q={y:b,anchorY:n},m.allowOverlapX&&(q.x=c,q.anchorX=u.anchorX),w.attr({text:u.options.title||m.title||"A"})[w.isNew?"attr":"animate"](q),m.allowOverlapX||(A[u.plotX]?A[u.plotX].size=Math.max(A[u.plotX].size,w.width):A[u.plotX]={align:0,size:w.width,target:c,anchorX:c}),u.tooltipPos=f.inverted?[z.len+z.pos-f.plotLeft-b,this.xAxis.len-c]:[c,b+z.pos-f.plotTop]):w&&(u.graphic=w.destroy());m.allowOverlapX||(a.objectEach(A,function(a){a.plotX=a.anchorX,d.push(a)}),a.distribute(d,this.xAxis.len),v(g,function(a){var b=a.graphic&&A[a.plotX];b&&(a.graphic[a.graphic.isNew?"attr":"animate"]({x:b.pos,anchorX:a.anchorX}),a.graphic.isNew=!1)})),m.useHTML&&a.wrap(this.markerGroup,"on",function(b){return a.SVGElement.prototype.on.apply(b.apply(this,[].slice.call(arguments,1)),[].slice.call(arguments,1))})},drawTracker:function(){var a=this.points;u.drawTrackerPoint.apply(this),v(a,function(f){var e=f.graphic;e&&H(e.element,"mouseover",function(){0<f.stackIndex&&!f.raised&&(f._y=e.y,e.attr({y:f._y-8}),f.raised=!0),v(a,function(a){a!==f&&a.raised&&a.graphic&&(a.graphic.attr({y:a._y}),a.raised=!1)})})})},animate:q,buildKDTree:q,setClip:q}),m.flag=function(a,f,e,c,b){var g=b&&b.anchorX||a;return b=b&&b.anchorY||f,m.circle(g-1,b-1,2,2).concat(["M",g,b,"L",a,f+c,a,f,a+e,f,a+e,f+c,a,f+c,"Z"])},E("circle"),E("square"),w===z&&v(["flag","circlepin","squarepin"],function(a){z.prototype.symbols[a]=m[a]})}(L,Z=function(a){var G=a.each,E=a.seriesTypes,H=a.stableSort;return{translate:function(){E.column.prototype.translate.apply(this);var t,u,a=this.options,k=this.chart,q=this.points,w=q.length-1;t=(z=a.onSeries)&&k.get(z);a=a.onKey||"y";var r,l,C,I,z=t&&t.options.step,m=t&&t.points,g=m&&m.length,f=this.xAxis,e=this.yAxis,c=f.getExtremes(),b=0;if(t&&t.visible&&g)for(b=(t.pointXOffset||0)+(t.barW||0)/2,t=t.currentDataGrouping,l=m[g-1].x+(t?t.totalRange:0),H(q,function(a,b){return a.x-b.x}),a="plot"+a[0].toUpperCase()+a.substr(1);g--&&q[w]&&(r=m[g],(t=q[w]).y=r.y,!(r.x<=t.x&&void 0!==r[a]&&(t.x<=l&&(t.plotY=r[a],r.x<t.x&&!z&&(C=m[g+1])&&void 0!==C[a]&&(I=(t.x-r.x)/(C.x-r.x),t.plotY+=I*(C[a]-r[a]),t.y+=I*(C.y-r.y))),w--,g++,0>w))););G(q,function(a,g){var l;void 0===a.plotY&&(a.x>=c.min&&a.x<=c.max?a.plotY=k.chartHeight-f.bottom-(f.opposite?f.height:0)+f.offset-e.top:a.shapeArgs={}),a.plotX+=b,(u=q[g-1])&&u.plotX===a.plotX&&(void 0===u.stackIndex&&(u.stackIndex=0),l=u.stackIndex+1),a.stackIndex=l})}}}(L)),function(a){function G(a,b,c){this.init(a,b,c)}var b,E=a.addEvent,H=a.Axis,v=a.correctFloat,k=a.defaultOptions,q=a.defined,w=a.destroyObjectProperties,t=a.each,u=a.fireEvent,z=a.hasTouch,m=a.isTouchDevice,g=a.merge,f=a.pick,e=a.removeEvent,c=a.wrap,r={height:m?20:14,barBorderRadius:0,buttonBorderRadius:0,liveRedraw:a.svg&&!m,margin:10,minWidth:6,step:.2,zIndex:3,barBackgroundColor:"#cccccc",barBorderWidth:1,barBorderColor:"#cccccc",buttonArrowColor:"#333333",buttonBackgroundColor:"#e6e6e6",buttonBorderColor:"#cccccc",buttonBorderWidth:1,rifleColor:"#333333",trackBackgroundColor:"#f2f2f2",trackBorderColor:"#f2f2f2",trackBorderWidth:1};k.scrollbar=g(!0,r,k.scrollbar),a.swapXY=b=function(a,b){var e,c=a.length;if(b)for(b=0;b<c;b+=3)e=a[b+1],a[b+1]=a[b+2],a[b+2]=e;return a},G.prototype={init:function(a,b,c){this.scrollbarButtons=[],this.renderer=a,this.userOptions=b,this.options=g(r,b),this.chart=c,this.size=f(this.options.size,this.options.height),b.enabled&&(this.render(),this.initEvents(),this.addEvents())},render:function(){var f,a=this.renderer,c=this.options,e=this.size;this.group=f=a.g("scrollbar").attr({zIndex:c.zIndex,translateY:-99999}).add(),this.track=a.rect().addClass("highcharts-scrollbar-track").attr({x:0,r:c.trackBorderRadius||0,height:e,width:e}).add(f),this.track.attr({fill:c.trackBackgroundColor,stroke:c.trackBorderColor,"stroke-width":c.trackBorderWidth}),this.trackBorderWidth=this.track.strokeWidth(),this.track.attr({y:-this.trackBorderWidth%2/2}),this.scrollbarGroup=a.g().add(f),this.scrollbar=a.rect().addClass("highcharts-scrollbar-thumb").attr({height:e,width:e,r:c.barBorderRadius||0}).add(this.scrollbarGroup),this.scrollbarRifles=a.path(b(["M",-3,e/4,"L",-3,2*e/3,"M",0,e/4,"L",0,2*e/3,"M",3,e/4,"L",3,2*e/3],c.vertical)).addClass("highcharts-scrollbar-rifles").add(this.scrollbarGroup),this.scrollbar.attr({fill:c.barBackgroundColor,stroke:c.barBorderColor,"stroke-width":c.barBorderWidth}),this.scrollbarRifles.attr({stroke:c.rifleColor,"stroke-width":1}),this.scrollbarStrokeWidth=this.scrollbar.strokeWidth(),this.scrollbarGroup.translate(-this.scrollbarStrokeWidth%2/2,-this.scrollbarStrokeWidth%2/2),this.drawScrollbarButton(0),this.drawScrollbarButton(1)},position:function(a,b,c,e){var f=this.options.vertical,g=0,l=this.rendered?"animate":"attr";this.x=a,this.y=b+this.trackBorderWidth,this.width=c,this.xOffset=this.height=e,this.yOffset=g,f?(this.width=this.yOffset=c=g=this.size,this.xOffset=b=0,this.barWidth=e-2*c,this.x=a+=this.options.margin):(this.height=this.xOffset=e=b=this.size,this.barWidth=c-2*e,this.y+=this.options.margin),this.group[l]({translateX:a,translateY:this.y}),this.track[l]({width:c,height:e}),this.scrollbarButtons[1][l]({translateX:f?0:c-b,translateY:f?e-g:0})},drawScrollbarButton:function(a){var l,c=this.renderer,e=this.scrollbarButtons,f=this.options,g=this.size;l=c.g().add(this.group),e.push(l),(l=c.rect().addClass("highcharts-scrollbar-button").add(l)).attr({stroke:f.buttonBorderColor,"stroke-width":f.buttonBorderWidth,fill:f.buttonBackgroundColor}),l.attr(l.crisp({x:-.5,y:-.5,width:g+1,height:g+1,r:f.buttonBorderRadius},l.strokeWidth())),(l=c.path(b(["M",g/2+(a?-1:1),g/2-3,"L",g/2+(a?-1:1),g/2+3,"L",g/2+(a?2:-2),g/2],f.vertical)).addClass("highcharts-scrollbar-arrow").add(e[a])).attr({fill:f.buttonArrowColor})},setRange:function(a,b){var l,k,c=this.options,e=c.vertical,f=c.minWidth,g=this.barWidth,m=this.rendered&&!this.hasDragged?"animate":"attr";q(g)&&(a=Math.max(a,0),l=Math.ceil(g*a),this.calculatedWidth=k=v(g*Math.min(b,1)-l),k<f&&(l=(g-f+k)*a,k=f),f=Math.floor(l+this.xOffset+this.yOffset),g=k/2-.5,this.from=a,this.to=b,e?(this.scrollbarGroup[m]({translateY:f}),this.scrollbar[m]({height:k}),this.scrollbarRifles[m]({translateY:g}),this.scrollbarTop=f,this.scrollbarLeft=0):(this.scrollbarGroup[m]({translateX:f}),this.scrollbar[m]({width:k}),this.scrollbarRifles[m]({translateX:g}),this.scrollbarLeft=f,this.scrollbarTop=0),12>=k?this.scrollbarRifles.hide():this.scrollbarRifles.show(!0),!1===c.showFull&&(0>=a&&1<=b?this.group.hide():this.group.show()),this.rendered=!0)},initEvents:function(){var a=this;a.mouseMoveHandler=function(b){var c=a.chart.pointer.normalize(b),e=a.options.vertical?"chartY":"chartX",f=a.initPositions;!a.grabbedCenter||b.touches&&0===b.touches[0][e]||(e=(c=a.cursorToScrollbarPosition(c)[e])-(e=a[e]),a.hasDragged=!0,a.updatePosition(f[0]+e,f[1]+e),a.hasDragged&&u(a,"changed",{from:a.from,to:a.to,trigger:"scrollbar",DOMType:b.type,DOMEvent:b}))},a.mouseUpHandler=function(b){a.hasDragged&&u(a,"changed",{from:a.from,to:a.to,trigger:"scrollbar",DOMType:b.type,DOMEvent:b}),a.grabbedCenter=a.hasDragged=a.chartX=a.chartY=null},a.mouseDownHandler=function(b){b=a.chart.pointer.normalize(b),b=a.cursorToScrollbarPosition(b),a.chartX=b.chartX,a.chartY=b.chartY,a.initPositions=[a.from,a.to],a.grabbedCenter=!0},a.buttonToMinClick=function(b){var c=v(a.to-a.from)*a.options.step;a.updatePosition(v(a.from-c),v(a.to-c)),u(a,"changed",{from:a.from,to:a.to,trigger:"scrollbar",DOMEvent:b})},a.buttonToMaxClick=function(b){var c=(a.to-a.from)*a.options.step;a.updatePosition(a.from+c,a.to+c),u(a,"changed",{from:a.from,to:a.to,trigger:"scrollbar",DOMEvent:b})},a.trackClick=function(b){var c=a.chart.pointer.normalize(b),e=a.to-a.from,f=a.y+a.scrollbarTop,g=a.x+a.scrollbarLeft;a.options.vertical&&c.chartY>f||!a.options.vertical&&c.chartX>g?a.updatePosition(a.from+e,a.to+e):a.updatePosition(a.from-e,a.to-e),u(a,"changed",{from:a.from,to:a.to,trigger:"scrollbar",DOMEvent:b})}},cursorToScrollbarPosition:function(a){var b=(b=this.options).minWidth>this.calculatedWidth?b.minWidth:0;return{chartX:(a.chartX-this.x-this.xOffset)/(this.barWidth-b),chartY:(a.chartY-this.y-this.yOffset)/(this.barWidth-b)}},updatePosition:function(a,b){1<b&&(a=v(1-v(b-a)),b=1),0>a&&(b=v(b-a),a=0),this.from=a,this.to=b},update:function(a){this.destroy(),this.init(this.chart.renderer,g(!0,this.options,a),this.chart)},addEvents:function(){var a=this.options.inverted?[1,0]:[0,1],b=this.scrollbarButtons,c=this.scrollbarGroup.element,e=this.mouseDownHandler,f=this.mouseMoveHandler,g=this.mouseUpHandler;a=[[b[a[0]].element,"click",this.buttonToMinClick],[b[a[1]].element,"click",this.buttonToMaxClick],[this.track.element,"click",this.trackClick],[c,"mousedown",e],[c.ownerDocument,"mousemove",f],[c.ownerDocument,"mouseup",g]];z&&a.push([c,"touchstart",e],[c.ownerDocument,"touchmove",f],[c.ownerDocument,"touchend",g]),t(a,function(a){E.apply(null,a)}),this._events=a},removeEvents:function(){t(this._events,function(a){e.apply(null,a)}),this._events.length=0},destroy:function(){var a=this.chart.scroller;this.removeEvents(),t(["track","scrollbarRifles","scrollbar","scrollbarGroup","group"],function(a){this[a]&&this[a].destroy&&(this[a]=this[a].destroy())},this),a&&this===a.scrollbar&&(a.scrollbar=null,w(a.scrollbarButtons))}},c(H.prototype,"init",function(a){var b=this;a.apply(b,Array.prototype.slice.call(arguments,1)),b.options.scrollbar&&b.options.scrollbar.enabled&&(b.options.scrollbar.vertical=!b.horiz,b.options.startOnTick=b.options.endOnTick=!1,b.scrollbar=new G(b.chart.renderer,b.options.scrollbar,b.chart),E(b.scrollbar,"changed",function(a){var g,c=Math.min(f(b.options.min,b.min),b.min,b.dataMin),e=Math.max(f(b.options.max,b.max),b.max,b.dataMax)-c;b.horiz&&!b.reversed||!b.horiz&&b.reversed?(g=c+e*this.to,c+=e*this.from):(g=c+e*(1-this.from),c+=e*(1-this.to)),b.setExtremes(c,g,!0,!1,a)}))}),c(H.prototype,"render",function(a){var b=Math.min(f(this.options.min,this.min),this.min,f(this.dataMin,this.min)),c=Math.max(f(this.options.max,this.max),this.max,f(this.dataMax,this.max)),e=this.scrollbar,g=this.titleOffset||0;a.apply(this,Array.prototype.slice.call(arguments,1)),e&&(this.horiz?(e.position(this.left,this.top+this.height+2+this.chart.scrollbarsOffsets[1]+(this.opposite?0:g+this.axisTitleMargin+this.offset),this.width,this.height),g=1):(e.position(this.left+this.width+2+this.chart.scrollbarsOffsets[0]+(this.opposite?g+this.axisTitleMargin+this.offset:0),this.top,this.width,this.height),g=0),(!this.opposite&&!this.horiz||this.opposite&&this.horiz)&&(this.chart.scrollbarsOffsets[g]+=this.scrollbar.size+this.scrollbar.options.margin),isNaN(b)||isNaN(c)||!q(this.min)||!q(this.max)?e.setRange(0,0):(g=(this.min-b)/(c-b),b=(this.max-b)/(c-b),this.horiz&&!this.reversed||!this.horiz&&this.reversed?e.setRange(g,b):e.setRange(1-b,1-g)))}),c(H.prototype,"getOffset",function(a){var b=this.horiz?2:1,c=this.scrollbar;a.apply(this,Array.prototype.slice.call(arguments,1)),c&&(this.chart.scrollbarsOffsets=[0,0],this.chart.axisOffset[b]+=c.size+c.options.margin)}),c(H.prototype,"destroy",function(a){this.scrollbar&&(this.scrollbar=this.scrollbar.destroy()),a.apply(this,Array.prototype.slice.call(arguments,1))}),a.Scrollbar=G}(L),function(a){function G(a){this.init(a)}var E=a.addEvent,H=a.Axis,v=a.Chart,k=a.color,q=a.defaultOptions,w=a.defined,t=a.destroyObjectProperties,u=a.each,z=a.erase,m=a.error,g=a.extend,f=a.grep,e=a.hasTouch,c=a.isArray,b=a.isNumber,r=a.isObject,l=a.merge,C=a.pick,I=a.removeEvent,x=a.Scrollbar,F=a.Series,n=a.seriesTypes,B=a.wrap,J=[].concat(a.defaultDataGroupingUnits),A=function(a){var d=f(arguments,b);if(d.length)return Math[a].apply(0,d)};J[4]=["day",[1,2,3,4]],J[5]=["week",[1,2,3]],n=void 0===n.areaspline?"line":"areaspline",g(q,{navigator:{height:40,margin:25,maskInside:!0,handles:{width:7,height:15,symbols:["navigator-handle","navigator-handle"],enabled:!0,lineWidth:1,backgroundColor:"#f2f2f2",borderColor:"#999999"},maskFill:k("#6685c2").setOpacity(.3).get(),outlineColor:"#cccccc",outlineWidth:1,series:{type:n,fillOpacity:.05,lineWidth:1,compare:null,dataGrouping:{approximation:"average",enabled:!0,groupPixelWidth:2,smoothed:!0,units:J},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",className:"highcharts-navigator-series",lineColor:null,marker:{enabled:!1},pointRange:0,threshold:null},xAxis:{overscroll:0,className:"highcharts-navigator-xaxis",tickLength:0,lineWidth:0,gridLineColor:"#e6e6e6",gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",style:{color:"#999999"},x:3,y:-4},crosshair:!1},yAxis:{className:"highcharts-navigator-yaxis",gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:.1,maxPadding:.1,labels:{enabled:!1},crosshair:!1,title:{text:null},tickLength:0,tickWidth:0}}}),a.Renderer.prototype.symbols["navigator-handle"]=function(a,b,c,e,f){return a=f.width/2,b=Math.round(a/3)+.5,["M",-a-1,.5,"L",a,.5,"L",a,(f=f.height)+.5,"L",-a-1,f+.5,"L",-a-1,.5,"M",-b,4,"L",-b,f-3,"M",b-1,4,"L",b-1,f-3]},G.prototype={drawHandle:function(a,b,c,e){var d=this.navigatorOptions.handles.height;this.handles[b][e](c?{translateX:Math.round(this.left+this.height/2),translateY:Math.round(this.top+parseInt(a,10)+.5-d)}:{translateX:Math.round(this.left+parseInt(a,10)),translateY:Math.round(this.top+this.height/2-d/2-1)})},drawOutline:function(a,b,c,e){var d=this.navigatorOptions.maskInside,f=(h=this.outline.strokeWidth())/2,h=h%2/2,g=this.outlineHeight,p=this.scrollbarHeight,k=this.size,n=this.left-p,l=this.top;c?a=["M",(n-=f)+g,l-p-h,"L",n+g,c=l+b+h,"L",n,c,"L",n,b=l+a+h,"L",n+g,b,"L",n+g,l+k+p].concat(d?["M",n+g,c-f,"L",n+g,b+f]:[]):a=["M",n,l+=f,"L",a+=n+p-h,l,"L",a,l+g,"L",b+=n+p-h,l+g,"L",b,l,"L",n+k+2*p,l].concat(d?["M",a-f,l,"L",b+f,l]:[]),this.outline[e]({d:a})},drawMasks:function(a,b,c,e){var g,p,n,k,d=this.left,h=this.top,f=this.height;c?(n=[d,d,d],k=[h,h+a,h+b],p=[f,f,f],g=[a,b-a,this.size-b]):(n=[d,d+a,d+b],k=[h,h,h],p=[a,b-a,this.size-b],g=[f,f,f]),u(this.shades,function(a,b){a[e]({x:n[b],y:k[b],width:p[b],height:g[b]})})},renderElements:function(){var n,a=this,b=a.navigatorOptions,c=b.maskInside,e=a.chart,f=e.inverted,g=e.renderer;a.navigatorGroup=n=g.g("navigator").attr({zIndex:8,visibility:"hidden"}).add();var k={cursor:f?"ns-resize":"ew-resize"};u([!c,c,!c],function(d,c){a.shades[c]=g.rect().addClass("highcharts-navigator-mask"+(1===c?"-inside":"-outside")).attr({fill:d?b.maskFill:"rgba(0,0,0,0)"}).css(1===c&&k).add(n)}),a.outline=g.path().addClass("highcharts-navigator-outline").attr({"stroke-width":b.outlineWidth,stroke:b.outlineColor}).add(n),b.handles.enabled&&u([0,1],function(d){b.handles.inverted=e.inverted,a.handles[d]=g.symbol(b.handles.symbols[d],-b.handles.width/2-1,0,b.handles.width,b.handles.height,b.handles),a.handles[d].attr({zIndex:7-d}).addClass("highcharts-navigator-handle highcharts-navigator-handle-"+["left","right"][d]).add(n);var c=b.handles;a.handles[d].attr({fill:c.backgroundColor,stroke:c.borderColor,"stroke-width":c.lineWidth}).css(k)})},update:function(a){u(this.series||[],function(a){a.baseSeries&&delete a.baseSeries.navigatorSeries}),this.destroy(),l(!0,this.chart.options.navigator,this.options,a),this.init(this.chart)},render:function(d,c,e,h){var g,p,k,f=this.chart,n=this.scrollbarHeight,l=this.xAxis;g=l.fake?f.xAxis[0]:l;var q,m=this.navigatorEnabled,r=this.rendered;p=f.inverted;var t,u=f.xAxis[0].minRange,v=f.xAxis[0].options.maxRange;if(!this.hasDragged||w(e)){if(!b(d)||!b(c)){if(!r)return;e=0,h=C(l.width,g.width)}this.left=C(l.left,f.plotLeft+n+(p?f.plotWidth:0)),this.size=q=k=C(l.len,(p?f.plotHeight:f.plotWidth)-2*n),f=p?n:k+2*n,e=C(e,l.toPixels(d,!0)),h=C(h,l.toPixels(c,!0)),b(e)&&1/0!==Math.abs(e)||(e=0,h=f),d=l.toValue(e,!0),c=l.toValue(h,!0),(t=Math.abs(a.correctFloat(c-d)))<u?this.grabbedLeft?e=l.toPixels(c-u,!0):this.grabbedRight&&(h=l.toPixels(d+u,!0)):w(v)&&t>v&&(this.grabbedLeft?e=l.toPixels(c-v,!0):this.grabbedRight&&(h=l.toPixels(d+v,!0))),this.zoomedMax=Math.min(Math.max(e,h,0),q),this.zoomedMin=Math.min(Math.max(this.fixedWidth?this.zoomedMax-this.fixedWidth:Math.min(e,h),0),q),this.range=this.zoomedMax-this.zoomedMin,q=Math.round(this.zoomedMax),e=Math.round(this.zoomedMin),m&&(this.navigatorGroup.attr({visibility:"visible"}),r=r&&!this.hasDragged?"animate":"attr",this.drawMasks(e,q,p,r),this.drawOutline(e,q,p,r),this.navigatorOptions.handles.enabled&&(this.drawHandle(e,0,p,r),this.drawHandle(q,1,p,r))),this.scrollbar&&(p?(p=this.top-n,g=this.left-n+(m||!g.opposite?0:(g.titleOffset||0)+g.axisTitleMargin),n=k+2*n):(p=this.top+(m?this.height:-n),g=this.left-n),this.scrollbar.position(g,p,f,n),this.scrollbar.setRange(this.zoomedMin/k,this.zoomedMax/k)),this.rendered=!0}},addMouseEvents:function(){var f,g,a=this,b=a.chart,c=b.container,h=[];a.mouseMoveHandler=f=function(b){a.onMouseMove(b)},a.mouseUpHandler=g=function(b){a.onMouseUp(b)},(h=a.getPartsEvents("mousedown")).push(E(c,"mousemove",f),E(c.ownerDocument,"mouseup",g)),e&&(h.push(E(c,"touchmove",f),E(c.ownerDocument,"touchend",g)),h.concat(a.getPartsEvents("touchstart"))),a.eventsToUnbind=h,a.series&&a.series[0]&&h.push(E(a.series[0].xAxis,"foundExtremes",function(){b.navigator.modifyNavigatorAxisExtremes()}))},getPartsEvents:function(a){var b=this,d=[];return u(["shades","handles"],function(c){u(b[c],function(e,h){d.push(E(e.element,a,function(a){b[c+"Mousedown"](a,h)}))})}),d},shadesMousedown:function(a,b){a=this.chart.pointer.normalize(a);var k,d=this.chart,c=this.xAxis,e=this.zoomedMin,f=this.left,g=this.size,p=this.range,n=a.chartX;d.inverted&&(n=a.chartY,f=this.top),1===b?(this.grabbedCenter=n,this.fixedWidth=p,this.dragOffset=n-e):(a=n-f-p/2,0===b?a=Math.max(0,a):2===b&&a+p>=g&&(a=g-p,k=this.getUnionExtremes().dataMax),a!==e&&(this.fixedWidth=p,b=c.toFixedRange(a,a+p,null,k),w(b.min)&&d.xAxis[0].setExtremes(Math.min(b.min,b.max),Math.max(b.min,b.max),!0,null,{trigger:"navigator"})))},handlesMousedown:function(a,b){this.chart.pointer.normalize(a);var d=(a=this.chart).xAxis[0],c=a.inverted&&!d.reversed||!a.inverted&&d.reversed;0===b?(this.grabbedLeft=!0,this.otherHandlePos=this.zoomedMax,this.fixedExtreme=c?d.min:d.max):(this.grabbedRight=!0,this.otherHandlePos=this.zoomedMin,this.fixedExtreme=c?d.max:d.min),a.fixedRange=null},onMouseMove:function(a){var b=this,d=b.chart,c=b.left,e=b.navigatorSize,f=b.range,g=b.dragOffset,n=d.inverted;a.touches&&0===a.touches[0].pageX||(d=(a=d.pointer.normalize(a)).chartX,n&&(c=b.top,d=a.chartY),b.grabbedLeft?(b.hasDragged=!0,b.render(0,0,d-c,b.otherHandlePos)):b.grabbedRight?(b.hasDragged=!0,b.render(0,0,b.otherHandlePos,d-c)):b.grabbedCenter&&(b.hasDragged=!0,d<g?d=g:d>e+g-f&&(d=e+g-f),b.render(0,0,d-g,d-g+f)),b.hasDragged&&b.scrollbar&&b.scrollbar.options.liveRedraw&&(a.DOMType=a.type,setTimeout(function(){b.onMouseUp(a)},0)))},onMouseUp:function(a){var e,f,b=this.chart,d=this.xAxis,c=this.scrollbar,g=a.DOMEvent||a;(!this.hasDragged||c&&c.hasDragged)&&"scrollbar"!==a.trigger||(this.zoomedMin===this.otherHandlePos?e=this.fixedExtreme:this.zoomedMax===this.otherHandlePos&&(f=this.fixedExtreme),this.zoomedMax===this.size&&(f=this.getUnionExtremes().dataMax),d=d.toFixedRange(this.zoomedMin,this.zoomedMax,e,f),w(d.min)&&b.xAxis[0].setExtremes(Math.min(d.min,d.max),Math.max(d.min,d.max),!0,!this.hasDragged&&null,{trigger:"navigator",triggerOp:"navigator-drag",DOMEvent:g})),"mousemove"!==a.DOMType&&(this.grabbedLeft=this.grabbedRight=this.grabbedCenter=this.fixedWidth=this.fixedExtreme=this.otherHandlePos=this.hasDragged=this.dragOffset=null)},removeEvents:function(){this.eventsToUnbind&&(u(this.eventsToUnbind,function(a){a()}),this.eventsToUnbind=void 0),this.removeBaseSeriesEvents()},removeBaseSeriesEvents:function(){var a=this.baseSeries||[];this.navigatorEnabled&&a[0]&&(!1!==this.navigatorOptions.adaptToUpdatedData&&u(a,function(a){I(a,"updatedData",this.updatedDataHandler)},this),a[0].xAxis&&I(a[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes))},init:function(a){var d=(b=a.options).navigator,c=d.enabled,f=(e=b.scrollbar).enabled,b=c?d.height:0,g=f?e.height:0;this.handles=[],this.shades=[],this.chart=a,this.setBaseSeries(),this.height=b,this.scrollbarHeight=g,this.scrollbarEnabled=f,this.navigatorEnabled=c,this.navigatorOptions=d,this.scrollbarOptions=e,this.outlineHeight=b+g,this.opposite=C(d.opposite,!c&&a.inverted);var n=this,e=n.baseSeries,k=(f=a.xAxis.length,a.yAxis.length),m=e&&e[0]&&e[0].xAxis||a.xAxis[0];a.extraMargin={type:n.opposite?"plotTop":"marginBottom",value:(c||!a.inverted?n.outlineHeight:0)+d.margin},a.inverted&&(a.extraMargin.type=n.opposite?"marginRight":"plotLeft"),a.isDirtyBox=!0,n.navigatorEnabled?(n.xAxis=new H(a,l({breaks:m.options.breaks,ordinal:m.options.ordinal},d.xAxis,{id:"navigator-x-axis",yAxis:"navigator-y-axis",isX:!0,type:"datetime",index:f,offset:0,keepOrdinalPadding:!0,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1},a.inverted?{offsets:[g,0,-g,0],width:b}:{offsets:[0,-g,0,g],height:b})),n.yAxis=new H(a,l(d.yAxis,{id:"navigator-y-axis",alignTicks:!1,offset:0,index:k,zoomEnabled:!1},a.inverted?{width:b}:{height:b})),e||d.series.data?n.updateNavigatorSeries():0===a.series.length&&B(a,"redraw",function(b,d){0<a.series.length&&!n.series&&(n.setBaseSeries(),a.redraw=b),b.call(a,d)}),n.renderElements(),n.addMouseEvents()):n.xAxis={translate:function(b,d){var e=(c=a.xAxis[0]).getExtremes(),f=c.len-2*g,h=A("min",c.options.min,e.dataMin),c=A("max",c.options.max,e.dataMax)-h;return d?b*c/f+h:f*(b-h)/c},toPixels:function(a){return this.translate(a)},toValue:function(a){return this.translate(a,!0)},toFixedRange:H.prototype.toFixedRange,fake:!0},a.options.scrollbar.enabled&&(a.scrollbar=n.scrollbar=new x(a.renderer,l(a.options.scrollbar,{margin:n.navigatorEnabled?0:10,vertical:a.inverted}),a),E(n.scrollbar,"changed",function(b){var c=(d=n.size)*this.to,d=d*this.from;n.hasDragged=n.scrollbar.hasDragged,n.render(0,0,d,c),(a.options.scrollbar.liveRedraw||"mousemove"!==b.DOMType)&&setTimeout(function(){n.onMouseUp(b)})})),n.addBaseSeriesEvents(),n.addChartEvents()},getUnionExtremes:function(a){var f,b=this.chart.xAxis[0],d=this.xAxis,c=d.options,e=b.options;return a&&null===b.dataMin||(f={dataMin:C(c&&c.min,A("min",e.min,b.dataMin,d.dataMin,d.min)),dataMax:C(c&&c.max,A("max",e.max,b.dataMax,d.dataMax,d.max))}),f},setBaseSeries:function(a,b){var d=this.chart,c=this.baseSeries=[];a=a||d.options&&d.options.navigator.baseSeries||0,u(d.series||[],function(b,d){b.options.isInternal||!b.options.showInNavigator&&(d!==a&&b.options.id!==a||!1===b.options.showInNavigator)||c.push(b)}),this.xAxis&&!this.xAxis.fake&&this.updateNavigatorSeries(b)},updateNavigatorSeries:function(b){var n,k,r,d=this,e=d.chart,f=d.baseSeries,m=d.navigatorOptions.series,t={enableMouseTracking:!1,index:null,linkedTo:null,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",showInLegend:!1,stacking:!1,isInternal:!0,visible:!0},v=d.series=a.grep(d.series||[],function(b){var c=b.baseSeries;return!(0>a.inArray(c,f))||(c&&(I(c,"updatedData",d.updatedDataHandler),delete c.navigatorSeries),b.destroy(),!1)});f&&f.length&&u(f,function(a){var h=a.navigatorSeries,p=g({color:a.color},c(m)?q.navigator.series:m);h&&!1===d.navigatorOptions.adaptToUpdatedData||(t.name="Navigator "+f.length,n=a.options||{},r=n.navigatorOptions||{},k=l(n,t,p,r),p=r.data||p.data,d.hasNavigatorData=d.hasNavigatorData||!!p,k.data=p||n.data&&n.data.slice(0),h&&h.options?h.update(k,b):(a.navigatorSeries=e.initSeries(k),a.navigatorSeries.baseSeries=a,v.push(a.navigatorSeries)))}),(!m.data||f&&f.length)&&!c(m)||(d.hasNavigatorData=!1,m=a.splat(m),u(m,function(a,b){t.name="Navigator "+(v.length+1),(k=l(q.navigator.series,{color:e.series[b]&&!e.series[b].options.isInternal&&e.series[b].color||e.options.colors[b]||e.options.colors[0]},t,a)).data=a.data,k.data&&(d.hasNavigatorData=!0,v.push(e.initSeries(k)))})),this.addBaseSeriesEvents()},addBaseSeriesEvents:function(){var a=this,b=a.baseSeries||[];b[0]&&b[0].xAxis&&E(b[0].xAxis,"foundExtremes",this.modifyBaseAxisExtremes),u(b,function(b){E(b,"show",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!0,!1)}),E(b,"hide",function(){this.navigatorSeries&&this.navigatorSeries.setVisible(!1,!1)}),!1!==this.navigatorOptions.adaptToUpdatedData&&b.xAxis&&E(b,"updatedData",this.updatedDataHandler),E(b,"remove",function(){this.navigatorSeries&&(z(a.series,this.navigatorSeries),this.navigatorSeries.remove(!1),delete this.navigatorSeries)})},this)},modifyNavigatorAxisExtremes:function(){var b,a=this.xAxis;a.getExtremes&&(!(b=this.getUnionExtremes(!0))||b.dataMin===a.min&&b.dataMax===a.max||(a.min=b.dataMin,a.max=b.dataMax))},modifyBaseAxisExtremes:function(){var l,m,a=this.chart.navigator,e=(c=this.getExtremes()).dataMin,f=c.dataMax,c=c.max-c.min,g=a.stickToMin,n=a.stickToMax,k=this.options.overscroll,q=a.series&&a.series[0],r=!!this.setExtremes;this.eventArgs&&"rangeSelectorButton"===this.eventArgs.trigger||(g&&(l=(m=e)+c),n&&(l=f+k,g||(m=Math.max(l-c,q&&q.xData?q.xData[0]:-Number.MAX_VALUE))),r&&(g||n)&&b(m)&&(this.min=this.userMin=m,this.max=this.userMax=l)),a.stickToMin=a.stickToMax=null},updatedDataHandler:function(){var a=this.chart.navigator,c=this.navigatorSeries;a.stickToMax=Math.round(a.zoomedMax)>=Math.round(a.size),a.stickToMin=b(this.xAxis.min)&&this.xAxis.min<=this.xData[0]&&(!this.chart.fixedRange||!a.stickToMax),c&&!a.hasNavigatorData&&(c.options.pointStart=this.xData[0],c.setData(this.options.data,!1,null,!1))},addChartEvents:function(){E(this.chart,"redraw",function(){var a=this.navigator,b=a&&(a.baseSeries&&a.baseSeries[0]&&a.baseSeries[0].xAxis||a.scrollbar&&this.xAxis[0]);b&&a.render(b.min,b.max)})},destroy:function(){this.removeEvents(),this.xAxis&&(z(this.chart.xAxis,this.xAxis),z(this.chart.axes,this.xAxis)),this.yAxis&&(z(this.chart.yAxis,this.yAxis),z(this.chart.axes,this.yAxis)),u(this.series||[],function(a){a.destroy&&a.destroy()}),u("series xAxis yAxis shades outline scrollbarTrack scrollbarRifles scrollbarGroup scrollbar navigatorGroup rendered".split(" "),function(a){this[a]&&this[a].destroy&&this[a].destroy(),this[a]=null},this),u([this.handles],function(a){t(a)},this)}},a.Navigator=G,B(H.prototype,"zoom",function(a,b,c){var n,d=this.chart,f=(e=d.options).chart.zoomType,g=e.navigator,e=e.rangeSelector;return this.isXAxis&&(g&&g.enabled||e&&e.enabled)&&("x"===f?d.resetZoomButton="blocked":"y"===f?n=!1:"xy"===f&&this.options.range&&(d=this.previousZoom,w(b)?this.previousZoom=[this.min,this.max]:d&&(b=d[0],c=d[1],delete this.previousZoom))),void 0!==n?n:a.call(this,b,c)}),B(v.prototype,"init",function(a,b,c){E(this,"beforeRender",function(){var a=this.options;(a.navigator.enabled||a.scrollbar.enabled)&&(this.scroller=this.navigator=new G(this))}),a.call(this,b,c)}),B(v.prototype,"setChartSize",function(a){var d,e,f,g,b=this.legend,c=this.navigator;a.apply(this,[].slice.call(arguments,1)),c&&(e=b&&b.options,f=c.xAxis,g=c.yAxis,d=c.scrollbarHeight,this.inverted?(c.left=c.opposite?this.chartWidth-d-c.height:this.spacing[3]+d,c.top=this.plotTop+d):(c.left=this.plotLeft+d,c.top=c.navigatorOptions.top||this.chartHeight-c.height-d-this.spacing[2]-(this.rangeSelector&&this.extraBottomMargin?this.rangeSelector.getHeight():0)-(e&&"bottom"===e.verticalAlign&&e.enabled&&!e.floating?b.legendHeight+C(e.margin,10):0)),f&&g&&(this.inverted?f.options.left=g.options.left=c.left:f.options.top=g.options.top=c.top,f.setAxisSize(),g.setAxisSize()))}),B(F.prototype,"addPoint",function(a,b,c,e,f){var d=this.options.turboThreshold;d&&this.xData.length>d&&r(b,!0)&&this.chart.navigator&&m(20,!0),a.call(this,b,c,e,f)}),B(v.prototype,"addSeries",function(a,b,c,e){return a=a.call(this,b,!1,e),this.navigator&&this.navigator.setBaseSeries(null,!1),C(c,!0)&&this.redraw(),a}),B(F.prototype,"update",function(a,b,c){a.call(this,b,!1),this.chart.navigator&&!this.options.isInternal&&this.chart.navigator.setBaseSeries(null,!1),C(c,!0)&&this.chart.redraw()}),v.prototype.callbacks.push(function(a){var b=a.navigator;b&&(a=a.xAxis[0].getExtremes(),b.render(a.min,a.max))})}(L),function(a){function G(a){this.init(a)}var E=a.addEvent,H=a.Axis,v=a.Chart,k=a.css,q=a.createElement,w=a.dateFormat,t=a.defaultOptions,u=t.global.useUTC,z=a.defined,m=a.destroyObjectProperties,g=a.discardElement,f=a.each,e=a.extend,c=a.fireEvent,b=a.Date,r=a.isNumber,l=a.merge,C=a.pick,I=a.pInt,x=a.splat,F=a.wrap;e(t,{rangeSelector:{verticalAlign:"top",buttonTheme:{"stroke-width":0,width:28,height:18,padding:2,zIndex:7},floating:!1,x:0,y:0,height:void 0,inputPosition:{align:"right",x:0,y:0},buttonPosition:{align:"left",x:0,y:0},labelStyle:{color:"#666666"}}}),t.lang=l(t.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"}),G.prototype={clickButton:function(a,b){var l,t,v,w,B,c=this,e=c.chart,d=c.buttonOptions[a],g=e.xAxis[0],h=(n=e.scroller&&e.scroller.getUnionExtremes()||g||{}).dataMin,k=n.dataMax,m=g&&Math.round(Math.min(g.max,C(k,g.max))),q=d.type,n=d._range,z=d.dataGrouping;if(null!==h&&null!==k){if(e.fixedRange=n,z&&(this.forcedDataGrouping=!0,H.prototype.setDataGrouping.call(g||{chart:this.chart},z,!1)),"month"===q||"year"===q)g?(q={range:d,max:m,dataMin:h,dataMax:k},l=g.minFromRange.call(q),r(q.newMax)&&(m=q.newMax)):n=d;else if(n)l=Math.max(m-n,h),m=Math.min(l+n,k);else if("ytd"===q){if(!g)return void E(e,"beforeRender",function(){c.clickButton(a)});void 0===k&&(h=Number.MAX_VALUE,k=Number.MIN_VALUE,f(e.series,function(a){a=a.xData,h=Math.min(a[0],h),k=Math.max(a[a.length-1],k)}),b=!1),l=v=(m=c.getYTDExtremes(k,h,u)).min,m=m.max}else"all"===q&&g&&(l=h,m=k);l+=d._offsetMin,m+=d._offsetMax,c.setSelected(a),g?g.setExtremes(l,m,C(b,1),null,{trigger:"rangeSelectorButton",rangeSelectorButton:d}):(t=x(e.options.xAxis)[0],B=t.range,t.range=n,w=t.min,t.min=v,E(e,"load",function(){t.range=B,t.min=w}))}},setSelected:function(a){this.selected=this.options.selected=a},defaultButtons:[{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(a){var b=this,e=a.options.rangeSelector,g=e.buttons||[].concat(b.defaultButtons),d=e.selected,n=function(){var a=b.minInput,d=b.maxInput;a&&a.blur&&c(a,"blur"),d&&d.blur&&c(d,"blur")};b.chart=a,b.options=e,b.buttons=[],a.extraTopMargin=e.height,b.buttonOptions=g,this.unMouseDown=E(a.container,"mousedown",n),this.unResize=E(a,"resize",n),f(g,b.computeButtonRange),void 0!==d&&g[d]&&this.clickButton(d,!1),E(a,"load",function(){a.xAxis&&a.xAxis[0]&&E(a.xAxis[0],"setExtremes",function(c){this.max-this.min!==a.fixedRange&&"rangeSelectorButton"!==c.trigger&&"updatedData"!==c.trigger&&b.forcedDataGrouping&&this.setDataGrouping(!1,!1)})})},updateButtonStates:function(){var a,b=(a=this.chart).xAxis[0],c=Math.round(b.max-b.min),e=!b.hasVisibleSeries,d=(a=a.scroller&&a.scroller.getUnionExtremes()||b).dataMin,g=a.dataMax,k=(a=this.getYTDExtremes(g,d,u)).min,h=a.max,l=this.selected,m=r(l),q=this.options.allButtonsEnabled,t=this.buttons;f(this.buttonOptions,function(a,f){var n=a._range,p=a.type,r=a.count||1,u=t[f],v=0;a=a._offsetMax-a._offsetMin,f=f===l;var y=n>g-d,A=n<b.minRange,w=!1,x=!1;n=n===c;("month"===p||"year"===p)&&c+36e5>=864e5*{month:28,year:365}[p]*r+a&&c-36e5<=864e5*{month:31,year:366}[p]*r+a?n=!0:"ytd"===p?(n=h-k+a===c,w=!f):"all"===p&&(n=b.max-b.min>=g-d,x=!f&&m&&n),p=!q&&(y||A||x||e),r=f&&n||n&&!m&&!w,p?v=3:r&&(m=!0,v=2),u.state!==v&&u.setState(v)})},computeButtonRange:function(a){var b=a.type,c=a.count||1,e={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5};e[b]?a._range=e[b]*c:"month"!==b&&"year"!==b||(a._range=864e5*{month:30,year:365}[b]*c),a._offsetMin=C(a.offsetMin,0),a._offsetMax=C(a.offsetMax,0),a._range+=a._offsetMax-a._offsetMin},setInputValue:function(a,b){var c=this.chart.options.rangeSelector,e=this[a+"Input"];z(b)&&(e.previousValue=e.HCTime,e.HCTime=b),e.value=w(c.inputEditDateFormat||"%Y-%m-%d",e.HCTime),this[a+"DateBox"].attr({text:w(c.inputDateFormat||"%b %e, %Y",e.HCTime)})},showInput:function(a){var b=this.inputGroup,c=this[a+"DateBox"];k(this[a+"Input"],{left:b.translateX+c.x+"px",top:b.translateY+"px",width:c.width-2+"px",height:c.height-2+"px",border:"2px solid silver"})},hideInput:function(a){k(this[a+"Input"],{border:0,width:"1px",height:"1px"}),this.setInputValue(a)},drawInput:function(a){function b(){var a=v.value,b=(n.inputDateParser||Date.parse)(a),d=f.xAxis[0],g=(e=f.scroller&&f.scroller.xAxis?f.scroller.xAxis:d).dataMin,e=e.dataMax;b!==v.previousValue&&(v.previousValue=b,r(b)||(b=a.split("-"),b=Date.UTC(I(b[0]),I(b[1])-1,I(b[2]))),r(b)&&(u||(b+=6e4*(new Date).getTimezoneOffset()),m?b>c.maxInput.HCTime?b=void 0:b<g&&(b=g):b<c.minInput.HCTime?b=void 0:b>e&&(b=e),void 0!==b&&d.setExtremes(m?b:d.min,m?d.max:b,void 0,void 0,{trigger:"rangeSelectorInput"})))}var v,w,c=this,f=c.chart,d=f.renderer.style||{},g=f.renderer,n=f.options.rangeSelector,h=c.div,m="min"===a,x=this.inputGroup;this[a+"Label"]=w=g.label(t.lang[m?"rangeSelectorFrom":"rangeSelectorTo"],this.inputGroup.offset).addClass("highcharts-range-label").attr({padding:2}).add(x),x.offset+=w.width+5,this[a+"DateBox"]=g=g.label("",x.offset).addClass("highcharts-range-input").attr({padding:2,width:n.inputBoxWidth||90,height:n.inputBoxHeight||17,stroke:n.inputBoxBorderColor||"#cccccc","stroke-width":1,"text-align":"center"}).on("click",function(){c.showInput(a),c[a+"Input"].focus()}).add(x),x.offset+=g.width+(m?10:0),this[a+"Input"]=v=q("input",{name:a,className:"highcharts-range-selector",type:"text"},{top:f.plotTop+"px"},h),w.css(l(d,n.labelStyle)),g.css(l({color:"#333333"},d,n.inputStyle)),k(v,e({position:"absolute",border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:d.fontSize,fontFamily:d.fontFamily,top:"-9999em"},n.inputStyle)),v.onfocus=function(){c.showInput(a)},v.onblur=function(){c.hideInput(a)},v.onchange=b,v.onkeypress=function(a){13===a.keyCode&&b()}},getPosition:function(){var a,b=(a=this.chart).options.rangeSelector;return{buttonTop:(a="top"===b.verticalAlign?a.plotTop-a.axisOffset[0]:0)+b.buttonPosition.y,inputTop:a+b.inputPosition.y-10}},getYTDExtremes:function(a,c,e){var f=new b(a),d=f[b.hcGetFullYear]();return e=e?b.UTC(d,0,1):+new b(d,0,1),c=Math.max(c||0,e),f=f.getTime(),{max:Math.min(a||f,f),min:c}},render:function(a,b){var E,G,c=this,e=c.chart,d=e.renderer,g=e.container,h=(k=e.options).exporting&&!1!==k.exporting.enabled&&k.navigation&&k.navigation.buttonOptions,n=t.lang,l=c.div,m=k.rangeSelector,k=m.floating,r=c.buttons,u=(l=c.inputGroup,m.buttonTheme),v=m.buttonPosition,w=m.inputPosition,x=m.inputEnabled,z=u&&u.states,B=e.plotLeft,F=c.buttonGroup;G=c.rendered;var V,H=c.options.verticalAlign,I=e.legend,L=I&&I.options,Y=v.y,X=w.y,Q=G||!1,T=0,U=0;!1!==m.enabled&&(G||(c.group=G=d.g("range-selector-group").attr({zIndex:7}).add(),c.buttonGroup=F=d.g("range-selector-buttons").add(G),c.zoomText=d.text(n.rangeSelectorZoom,C(B+v.x,B),15).css(m.labelStyle).add(F),E=C(B+v.x,B)+c.zoomText.getBBox().width+5,f(c.buttonOptions,function(a,b){r[b]=d.button(a.text,E,0,function(){var e,d=a.events&&a.events.click;d&&(e=d.call(a)),!1!==e&&c.clickButton(b),c.isActive=!0},u,z&&z.hover,z&&z.select,z&&z.disabled).attr({"text-align":"center"}).add(F),E+=r[b].width+C(m.buttonSpacing,5)}),!1!==x&&(c.div=l=q("div",null,{position:"relative",height:0,zIndex:1}),g.parentNode.insertBefore(l,g),c.inputGroup=l=d.g("input-group").add(G),l.offset=0,c.drawInput("min"),c.drawInput("max"))),B=e.plotLeft-e.spacing[3],c.updateButtonStates(),h&&this.titleCollision(e)&&"top"===H&&"right"===v.align&&v.y+F.getBBox().height-12<(h.y||0)+h.height&&(T=-40),"left"===v.align?V=v.x-e.spacing[3]:"right"===v.align&&(V=v.x+T-e.spacing[1]),F.align({y:v.y,width:F.getBBox().width,align:v.align,x:V},!0,e.spacingBox),c.group.placed=Q,c.buttonGroup.placed=Q,!1!==x&&(T=h&&this.titleCollision(e)&&"top"===H&&"right"===w.align&&w.y-l.getBBox().height-12<(h.y||0)+h.height+e.spacing[0]?-40:0,"left"===w.align?V=B:"right"===w.align&&(V=-Math.max(e.axisOffset[1],-T)),l.align({y:w.y,width:l.getBBox().width,align:w.align,x:w.x+V-2},!0,e.spacingBox),g=l.alignAttr.translateX+l.alignOptions.x-T+l.getBBox().x+2,h=l.alignOptions.width,n=F.alignAttr.translateX+F.getBBox().x,V=F.getBBox().width+20,(w.align===v.align||n+V>g&&g+h>n&&Y<X+l.getBBox().height)&&l.attr({translateX:l.alignAttr.translateX+(e.axisOffset[1]>=-T?0:-T),translateY:l.alignAttr.translateY+F.getBBox().height+10}),c.setInputValue("min",a),c.setInputValue("max",b),c.inputGroup.placed=Q),c.group.align({verticalAlign:H},!0,e.spacingBox),a=c.group.getBBox().height+20,b=c.group.alignAttr.translateY,"bottom"===H&&(U=b-(a=a+(I=L&&"bottom"===L.verticalAlign&&L.enabled&&!L.floating?I.legendHeight+C(L.margin,10):0)-20)-(k?0:m.y)-10),"top"===H?(k&&(U=0),e.titleOffset&&(U=e.titleOffset+e.options.title.margin),U+=e.margin[0]-e.spacing[0]||0):"middle"===H&&(X===Y?U=0>X?b+void 0:b:(X||Y)&&(U=0>X||0>Y?U-Math.min(X,Y):b-a+NaN)),c.group.translate(m.x,m.y+Math.floor(U)),!1!==x&&(c.minInput.style.marginTop=c.group.translateY+"px",c.maxInput.style.marginTop=c.group.translateY+"px"),c.rendered=!0)},getHeight:function(){var a=this.options,b=this.group,c=a.y,e=a.buttonPosition.y;a=a.inputPosition.y,b=b?b.getBBox(!0).height+13+c:0,c=Math.min(a,e);return(0>a&&0>e||0<a&&0<e)&&(b+=Math.abs(c)),b},titleCollision:function(a){return!(a.options.title.text||a.options.subtitle.text)},update:function(a){var b=this.chart;l(!0,b.options.rangeSelector,a),this.destroy(),this.init(b),b.rangeSelector.render()},destroy:function(){var b=this,c=b.minInput,e=b.maxInput;b.unMouseDown(),b.unResize(),m(b.buttons),c&&(c.onfocus=c.onblur=c.onchange=null),e&&(e.onfocus=e.onblur=e.onchange=null),a.objectEach(b,function(a,c){a&&"chart"!==c&&(a.destroy?a.destroy():a.nodeType&&g(this[c])),a!==G.prototype[c]&&(b[c]=null)},this)}},H.prototype.toFixedRange=function(a,b,c,e){var d=this.chart&&this.chart.fixedRange;return a=C(c,this.translate(a,!0,!this.horiz)),b=C(e,this.translate(b,!0,!this.horiz)),.7<(c=d&&(b-a)/d)&&1.3>c&&(e?a=b-d:b=a+d),r(a)&&r(b)||(a=b=void 0),{min:a,max:b}},H.prototype.minFromRange=function(){var c,d,f,a=this.range,b={month:"Month",year:"FullYear"}[a.type],e=this.max,g=function(a,c){var d=new Date(a),e=d["get"+b]();return d["set"+b](e+c),e===d["get"+b]()&&d.setDate(0),d.getTime()-a};return r(a)?(c=e-a,f=a):(c=e+g(e,-a.count),this.chart&&(this.chart.fixedRange=e-c)),d=C(this.dataMin,Number.MIN_VALUE),r(c)||(c=d),c<=d&&(c=d,void 0===f&&(f=g(c,a.count)),this.newMax=Math.min(c+f,this.dataMax)),r(e)||(c=void 0),c},F(v.prototype,"init",function(a,b,c){E(this,"init",function(){this.options.rangeSelector.enabled&&(this.rangeSelector=new G(this))}),a.call(this,b,c)}),F(v.prototype,"render",function(a,b,c){var e=this.axes,d=this.rangeSelector;d&&(f(e,function(a){a.updateNames(),a.setScale()}),this.getAxisMargins(),d.render(),e=d.options.verticalAlign,d.options.floating||("bottom"===e?this.extraBottomMargin=!0:"middle"!==e&&(this.extraTopMargin=!0))),a.call(this,b,c)}),F(v.prototype,"update",function(b,c,e,f){var g,d=this.rangeSelector;this.extraTopMargin=this.extraBottomMargin=!1,d&&(d.render(),g=c.rangeSelector&&c.rangeSelector.verticalAlign||d.options&&d.options.verticalAlign,d.options.floating||("bottom"===g?this.extraBottomMargin=!0:"middle"!==g&&(this.extraTopMargin=!0))),b.call(this,a.merge(!0,c,{chart:{marginBottom:C(c.chart&&c.chart.marginBottom,this.margin.bottom),spacingBottom:C(c.chart&&c.chart.spacingBottom,this.spacing.bottom)}}),e,f)}),F(v.prototype,"redraw",function(a,b,c){var e=this.rangeSelector;e&&!e.options.floating&&(e.render(),"bottom"===(e=e.options.verticalAlign)?this.extraBottomMargin=!0:"middle"!==e&&(this.extraTopMargin=!0)),a.call(this,b,c)}),v.prototype.adjustPlotArea=function(){var a=this.rangeSelector;this.rangeSelector&&(a=a.getHeight(),this.extraTopMargin&&(this.plotTop+=a),this.extraBottomMargin&&(this.marginBottom+=a))},v.prototype.callbacks.push(function(a){function b(){c=a.xAxis[0].getExtremes(),r(c.min)&&e.render(c.min,c.max)}var c,d,f,e=a.rangeSelector;e&&(f=E(a.xAxis[0],"afterSetExtremes",function(a){e.render(a.min,a.max)}),d=E(a,"redraw",b),b()),E(a,"destroy",function(){e&&(d(),f())})}),a.RangeSelector=G}(L),function(a){var G=a.arrayMax,E=a.arrayMin,H=a.Axis,v=a.Chart,k=a.defined,q=a.each,w=a.extend,t=a.format,u=a.grep,z=a.inArray,m=a.isNumber,g=a.isString,f=a.map,e=a.merge,c=a.pick,b=a.Point,r=a.Renderer,l=a.Series,C=a.splat,I=a.SVGRenderer,x=a.VMLRenderer,F=a.wrap,n=l.prototype,B=n.init,J=n.processData,A=b.prototype.tooltipFormatter;a.StockChart=a.stockChart=function(b,k,l){var q,d=g(b)||b.nodeName,m=arguments[d?1:0],p=m.series,n=a.getOptions(),r=c(m.navigator&&m.navigator.enabled,n.navigator.enabled,!0),t=r?{startOnTick:!1,endOnTick:!1}:null,u={marker:{enabled:!1,radius:2}},w={shadow:!1,borderWidth:0};return m.xAxis=f(C(m.xAxis||{}),function(a){return e({minPadding:0,maxPadding:0,overscroll:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},n.xAxis,a,{type:"datetime",categories:null},t)}),m.yAxis=f(C(m.yAxis||{}),function(a){return q=c(a.opposite,!0),e({labels:{y:-2},opposite:q,showLastLabel:!1,title:{text:null}},n.yAxis,a)}),m.series=null,(m=e({chart:{panning:!0,pinchType:"x"},navigator:{enabled:r},scrollbar:{enabled:c(n.scrollbar.enabled,!0)},rangeSelector:{enabled:c(n.rangeSelector.enabled,!0)},title:{text:null},tooltip:{split:c(n.tooltip.split,!0),crosshairs:!0},legend:{enabled:!1},plotOptions:{line:u,spline:u,area:u,areaspline:u,arearange:u,areasplinerange:u,column:w,columnrange:w,candlestick:w,ohlc:w}},m,{isStock:!0})).series=p,d?new v(b,m,l):new v(m,k)},F(H.prototype,"autoLabelAlign",function(a){var b=this.chart,c=this.options,d=(b=b._labelPanes=b._labelPanes||{},this.options.labels);return this.chart.options.isStock&&"yAxis"===this.coll&&(!b[c=c.top+","+c.height]&&d.enabled)?(15===d.x&&(d.x=0),void 0===d.align&&(d.align="right"),b[c]=this,"right"):a.apply(this,[].slice.call(arguments,1))}),F(H.prototype,"destroy",function(a){var b=this.chart,c=this.options&&this.options.top+","+this.options.height;return c&&b._labelPanes&&b._labelPanes[c]===this&&delete b._labelPanes[c],a.apply(this,Array.prototype.slice.call(arguments,1))}),F(H.prototype,"getPlotLinePath",function(b,e,l,h,n,r){var y,x,A,B,E,F,d=this,p=this.isLinked&&!this.series?this.linkedParent.series:this.series,t=d.chart,u=t.renderer,v=d.left,w=d.top,D=[],C=[];return"xAxis"!==d.coll&&"yAxis"!==d.coll?b.apply(this,[].slice.call(arguments,1)):(C=function(a){var b="xAxis"===a?"yAxis":"xAxis";return a=d.options[b],m(a)?[t[b][a]]:g(a)?[t.get(a)]:f(p,function(a){return a[b]})}(d.coll),q(d.isXAxis?t.yAxis:t.xAxis,function(a){if(!k(a.options.id)||-1===a.options.id.indexOf("navigator")){var b=a.isXAxis?"yAxis":"xAxis";b=k(a.options[b])?t[b][a.options[b]]:t[b][0];d===b&&C.push(a)}}),E=C.length?[]:[d.isXAxis?t.yAxis[0]:t.xAxis[0]],q(C,function(b){-1!==z(b,E)||a.find(E,function(a){return a.pos===b.pos&&a.len&&b.len})||E.push(b)}),F=c(r,d.translate(e,null,null,h)),m(F)&&(d.horiz?q(E,function(a){var b;x=a.pos,B=x+a.len,((y=A=Math.round(F+d.transB))<v||y>v+d.width)&&(n?y=A=Math.min(Math.max(v,y),v+d.width):b=!0),b||D.push("M",y,x,"L",A,B)}):q(E,function(a){var b;y=a.pos,A=y+a.len,((x=B=Math.round(w+d.height-F))<w||x>w+d.height)&&(n?x=B=Math.min(Math.max(w,x),d.top+d.height):b=!0),b||D.push("M",y,x,"L",A,B)})),0<D.length?u.crispPolyLine(D,l||1):null)}),I.prototype.crispPolyLine=function(a,b){var c;for(c=0;c<a.length;c+=6)a[c+1]===a[c+4]&&(a[c+1]=a[c+4]=Math.round(a[c+1])-b%2/2),a[c+2]===a[c+5]&&(a[c+2]=a[c+5]=Math.round(a[c+2])+b%2/2);return a},r===x&&(x.prototype.crispPolyLine=I.prototype.crispPolyLine),F(H.prototype,"hideCrosshair",function(a,b){a.call(this,b),this.crossLabel&&(this.crossLabel=this.crossLabel.hide())}),F(H.prototype,"drawCrosshair",function(a,b,e){var d,f;if(a.call(this,b,e),k(this.crosshair.label)&&this.crosshair.label.enabled&&this.cross){a=this.chart;var g=this.options.crosshair.label,l=this.horiz;d=this.opposite,f=this.left;var p,m=this.top,n=this.crossLabel,q=g.format,r="",u="inside"===this.options.tickPosition,v=!1!==this.crosshair.snap,x=0;b||(b=this.cross&&this.cross.e),p=l?"center":d?"right"===this.labelAlign?"right":"left":"left"===this.labelAlign?"left":"center",n||(n=this.crossLabel=a.renderer.label(null,null,null,g.shape||"callout").addClass("highcharts-crosshair-label"+(this.series[0]&&" highcharts-color-"+this.series[0].colorIndex)).attr({align:g.align||p,padding:c(g.padding,8),r:c(g.borderRadius,3),zIndex:2}).add(this.labelGroup)).attr({fill:g.backgroundColor||this.series[0]&&this.series[0].color||"#666666",stroke:g.borderColor||"","stroke-width":g.borderWidth||0}).css(w({color:"#ffffff",fontWeight:"normal",fontSize:"11px",textAlign:"center"},g.style)),l?(p=v?e.plotX+f:b.chartX,m+=d?0:this.height):(p=d?this.width+f:0,m=v?e.plotY+m:b.chartY),q||g.formatter||(this.isDatetimeAxis&&(r="%b %d, %Y"),q="{value"+(r?":"+r:"")+"}"),b=v?e[this.isXAxis?"x":"y"]:this.toValue(l?b.chartX:b.chartY),n.attr({text:q?t(q,{value:b}):g.formatter.call(this,b),x:p,y:m,visibility:"visible"}),b=n.getBBox(),l?(u&&!d||!u&&d)&&(m=n.y-b.height):m=n.y-b.height/2,l?(d=f-b.x,f=f+this.width-b.x):(d="left"===this.labelAlign?f:0,f="right"===this.labelAlign?f+this.width:a.chartWidth),n.translateX<d&&(x=d-n.translateX),n.translateX+b.width>=f&&(x=-(n.translateX+b.width-f)),n.attr({x:p+x,y:m,anchorX:l?p:this.opposite?0:a.chartWidth,anchorY:l?this.opposite?a.chartHeight:0:m+b.height/2})}}),n.init=function(){B.apply(this,arguments),this.setCompare(this.options.compare)},n.setCompare=function(a){this.modifyValue="value"===a||"percent"===a?function(b,c){var d=this.compareValue;if(void 0!==b&&void 0!==d)return b="value"===a?b-d:b/d*100-(100===this.options.compareBase?0:100),c&&(c.change=b),b}:null,this.userOptions.compare=a,this.chart.hasRendered&&(this.isDirty=!0)},n.processData=function(){var a,c,e,g,k,b=-1,f=!0===this.options.compareStart?0:1;if(J.apply(this,arguments),this.xAxis&&this.processedYData)for(c=this.processedXData,g=(e=this.processedYData).length,this.pointArrayMap&&(-1===(b=z("close",this.pointArrayMap))&&(b=z(this.pointValKey||"y",this.pointArrayMap))),a=0;a<g-f;a++)if(k=e[a]&&-1<b?e[a][b]:e[a],m(k)&&c[a+f]>=this.xAxis.min&&0!==k){this.compareValue=k;break}},F(n,"getExtremes",function(a){var b;a.apply(this,[].slice.call(arguments,1)),this.modifyValue&&(b=[this.modifyValue(this.dataMin),this.modifyValue(this.dataMax)],this.dataMin=E(b),this.dataMax=G(b))}),H.prototype.setCompare=function(a,b){this.isXAxis||(q(this.series,function(b){b.setCompare(a)}),c(b,!0)&&this.chart.redraw())},b.prototype.tooltipFormatter=function(b){return b=b.replace("{point.change}",(0<this.change?"+":"")+a.numberFormat(this.change,c(this.series.tooltipOptions.changeDecimals,2))),A.apply(this,[b])},F(l.prototype,"render",function(a){this.chart.is3d&&this.chart.is3d()||this.chart.polar||!this.xAxis||this.xAxis.isRadial||(!this.clipBox&&this.animate?(this.clipBox=e(this.chart.clipBox),this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len):this.chart[this.sharedClipKey]?this.chart[this.sharedClipKey].attr({width:this.xAxis.len,height:this.yAxis.len}):this.clipBox&&(this.clipBox.width=this.xAxis.len,this.clipBox.height=this.yAxis.len)),a.call(this)}),F(v.prototype,"getSelectedPoints",function(a){var b=a.call(this);return q(this.series,function(a){a.hasGroupedData&&(b=b.concat(u(a.points||[],function(a){return a.selected})))}),b}),F(v.prototype,"update",function(a,b){return"scrollbar"in b&&this.navigator&&(e(!0,this.options.scrollbar,b.scrollbar),this.navigator.update({},!1),delete b.scrollbar),a.apply(this,Array.prototype.slice.call(arguments,1))})}(L),L}),function(e){"object"==typeof module&&module.exports?module.exports=e:e(Highcharts)}(function(e){!function(g){var e=g.seriesType,C=g.seriesTypes,H=g.noop,D=g.pick,I=g.each;e("funnel","pie",{animation:!1,center:["50%","50%"],width:"90%",neckWidth:"30%",height:"100%",neckHeight:"25%",reversed:!1,size:!0,dataLabels:{connectorWidth:1},states:{select:{color:"#cccccc",borderColor:"#000000",shadow:!1}}},{animate:H,translate:function(){var l,v,z,A,B,n,G,u,k,y,p,b=function(a,b){return/%$/.test(a)?b*parseInt(a,10)/100:parseInt(a,10)},E=0,c=this.chart,f=this.options,d=f.reversed,e=f.ignoreHiddenPoint,t=c.plotWidth,q=(c=c.plotHeight,0),g=f.center,h=b(g[0],t),r=b(g[1],c),C=b(f.width,t),m=b(f.height,c),w=b(f.neckWidth,t),F=b(f.neckHeight,c),x=r-m/2+m-F,D=(b=this.data,"left"===f.dataLabels.position?1:0);this.getWidthAt=v=function(a){return a>x||m===F?w:w+(C-w)*(1-(a-(r-m/2))/(m-F))},this.getX=function(a,b,c){return h+(b?-1:1)*(v(d?2*r-a:a)/2+c.labelDistance)},this.center=[h,r,m],this.centerX=h,I(b,function(a){e&&!1===a.visible||(E+=a.y)}),I(b,function(a){p=null,A=E?a.y/E:0,k=(n=r-m/2+q*m)+A*m,l=v(n),G=(B=h-l/2)+l,l=v(k),y=(u=h-l/2)+l,n>x?(B=u=h-w/2,G=y=h+w/2):k>x&&(p=k,l=v(x),y=(u=h-l/2)+l,k=x),d&&(n=2*r-n,k=2*r-k,p=p?2*r-p:null),z=["M",B,n,"L",G,n,y,k],p&&z.push(y,p,u,p),z.push(u,k,"Z"),a.shapeType="path",a.shapeArgs={d:z},a.percentage=100*A,a.plotX=h,a.plotY=(n+(p||k))/2,a.tooltipPos=[h,a.plotY],a.slice=H,a.half=D,e&&!1===a.visible||(q+=A)})},sortByAngle:function(b){b.sort(function(b,c){return b.plotY-c.plotY})},drawDataLabels:function(){var c,f,d,t,q,b=this.data,e=this.options.dataLabels.distance,g=b.length;for(this.center[2]-=2*e;g--;)f=(c=(d=b[g]).half)?1:-1,q=d.plotY,d.labelDistance=D(d.options.dataLabels&&d.options.dataLabels.distance,e),this.maxLabelDistance=Math.max(d.labelDistance,this.maxLabelDistance||0),t=this.getX(q,c,d),d.labelPos=[0,q,t+(d.labelDistance-5)*f,q,t+d.labelDistance*f,q,c?"right":"left",0];C.pie.prototype.drawDataLabels.call(this)}}),e("pyramid","funnel",{neckWidth:"0%",neckHeight:"0%",reversed:!0})}(e)}),function(y){"object"==typeof module&&module.exports?module.exports=y:y(Highcharts)}(function(y){!function(n){var C,w,y=n.win.document,t=n.each,D=n.objectEach,E=n.pick,A=n.inArray,B=n.isNumber,F=n.splat,G=n.fireEvent;C=Array.prototype.some?function(a,b,d){Array.prototype.some.call(a,b,d)}:function(a,b,d){for(var e=0,f=a.length;e<f&&!0!==b.call(d,a[e],e,a);e++);};var z=function(a,b){this.init(a,b)};n.extend(z.prototype,{init:function(a,b){this.options=a,this.chartOptions=b,this.columns=a.columns||this.rowsToColumns(a.rows)||[],this.firstRowAsNames=E(a.firstRowAsNames,!0),this.decimalRegex=a.decimalPoint&&new RegExp("^(-?[0-9]+)"+a.decimalPoint+"([0-9]+)$"),this.rawColumns=[],this.columns.length?this.dataFound():(this.parseCSV(),this.parseTable(),this.parseGoogleSpreadsheet())},getColumnDistribution:function(){var g,a=this.chartOptions,b=this.options,d=[],e=function(a){return(n.seriesTypes[a||"line"].prototype.pointArrayMap||[0]).length},f=a&&a.chart&&a.chart.type,c=[],k=[],l=0;t(a&&a.series||[],function(a){c.push(e(a.type||f))}),t(b&&b.seriesMapping||[],function(a){d.push(a.x||0)}),0===d.length&&d.push(0),t(b&&b.seriesMapping||[],function(b){var d=new w,v=c[l]||e(f),r=n.seriesTypes[((a&&a.series||[])[l]||{}).type||f||"line"].prototype.pointArrayMap||["y"];for(d.addColumnReader(b.x,"x"),D(b,function(a,b){"x"!==b&&d.addColumnReader(a,b)}),g=0;g<v;g++)d.hasReader(r[g])||d.addColumnReader(void 0,r[g]);k.push(d),l++}),void 0===(b=n.seriesTypes[f||"line"].prototype.pointArrayMap)&&(b=["y"]),this.valueCount={global:e(f),xColumns:d,individual:c,seriesBuilders:k,globalPointArrayMap:b}},dataFound:function(){this.options.switchRowsAndColumns&&(this.columns=this.rowsToColumns(this.columns)),this.getColumnDistribution(),this.parseTypes(),!1!==this.parsed()&&this.complete()},parseCSV:function(a){function b(a,b,c,d){function f(b){h=a[b],m=a[b-1],n=a[b+1]}function e(a){q.length<x+1&&q.push([a]),q[x][q[x].length-1]!==a&&q[x].push(a)}function g(){H>p||p>I?(++p,u=""):(!isNaN(parseFloat(u))&&isFinite(u)?(u=parseFloat(u),e("number")):isNaN(Date.parse(u))?e("string"):(u=u.replace(/\//g,"-"),e("date")),l.length<x+1&&l.push([]),c||(l[x][b]=u),u="",++x,++p)}var k=0,h="",m="",n="",u="",p=0,x=0;if(a.trim().length&&"#"!==a.trim()[0]){for(;k<a.length;k++){if(f(k),"#"===h)return void g();if('"'===h)for(f(++k);k<a.length&&('"'!==h||'"'===m||'"'===n);)('"'!==h||'"'===h&&'"'!==m)&&(u+=h),f(++k);else d&&d[h]?d[h](h,u)&&g():h===v?g():u+=h}g()}}var l,f=this,c=a||this.options,k=c.csv;a=void 0!==c.startRow&&c.startRow?c.startRow:0;var v,g=c.endRow||Number.MAX_VALUE,H=void 0!==c.startColumn&&c.startColumn?c.startColumn:0,I=c.endColumn||Number.MAX_VALUE,r=0,q=[],p={",":0,";":0,"\t":0};if(l=this.columns=[],k){k=k.replace(/\r\n/g,"\n").replace(/\r/g,"\n").split(c.lineDelimiter||"\n"),(!a||0>a)&&(a=0),(!g||g>=k.length)&&(g=k.length-1),c.itemDelimiter?v=c.itemDelimiter:(v=null,v=function(a){var e,b=0,d=0;return C(a,function(a,c){var e,h,f=!1,g="";if(13<c)return!0;for(var k=0;k<a.length&&(c=a[k],e=a[k+1],h=a[k-1],"#"!==c);k++){if('"'===c)if(f){if('"'!==h&&'"'!==e){for(;" "===e&&k<a.length;)e=a[++k];void 0!==p[e]&&p[e]++,f=!1}}else f=!0;else void 0!==p[c]?(g=g.trim(),isNaN(Date.parse(g))&&!isNaN(g)&&isFinite(g)||p[c]++,g=""):g+=c;","===c&&d++,"."===c&&b++}}),e=p[";"]>p[","]?";":",",c.decimalPoint||(c.decimalPoint=b>d?".":",",f.decimalRegex=new RegExp("^(-?[0-9]+)"+c.decimalPoint+"([0-9]+)$")),e}(k));var m=0;for(r=a;r<=g;r++)"#"===k[r][0]?m++:b(k[r],r-a-m);c.columnTypes&&0!==c.columnTypes.length||!q.length||!q[0].length||"date"!==q[0][1]||c.dateFormat||(c.dateFormat=function(a,b){var d,e,h,g=0,k=!1,l=[],m=[];for((!b||b>a.length)&&(b=a.length);g<b;g++)if(void 0!==a[g]&&a[g]&&a[g].length)for(d=a[g].trim().replace(/\//g," ").replace(/\-/g," ").split(" "),e=["","",""],h=0;h<d.length;h++)h<e.length&&(d[h]=parseInt(d[h],10),d[h]&&(m[h]=!m[h]||m[h]<d[h]?d[h]:m[h],void 0!==l[h]?l[h]!==d[h]&&(l[h]=!1):l[h]=d[h],31<d[h]?e[h]=100>d[h]?"YY":"YYYY":12<d[h]&&31>=d[h]?(e[h]="dd",k=!0):e[h].length||(e[h]="mm")));if(k){for(h=0;h<l.length;h++)!1!==l[h]?12<m[h]&&"YY"!==e[h]&&"YYYY"!==e[h]&&(e[h]="YY"):12<m[h]&&"mm"===e[h]&&(e[h]="dd");return 3===e.length&&"dd"===e[1]&&"dd"===e[2]&&(e[2]="YY"),a=e.join("/"),(c.dateFormats||f.dateFormats)[a]?a:(G("invalidDateFormat"),n.error("Could not deduce date format"),"YYYY/mm/dd")}return"YYYY/mm/dd"}(l[0])),this.dataFound()}return l},parseTable:function(){var a=this.options,b=a.table,d=this.columns,e=a.startRow||0,f=a.endRow||Number.MAX_VALUE,c=a.startColumn||0,k=a.endColumn||Number.MAX_VALUE;b&&("string"==typeof b&&(b=y.getElementById(b)),t(b.getElementsByTagName("tr"),function(a,b){b>=e&&b<=f&&t(a.children,function(a,f){("TD"===a.tagName||"TH"===a.tagName)&&f>=c&&f<=k&&(d[f-c]||(d[f-c]=[]),d[f-c][b-e]=a.innerHTML)})}),this.dataFound())},parseGoogleSpreadsheet:function(){var g,n,a=this,b=this.options,d=b.googleSpreadsheetKey,e=this.columns,f=b.startRow||0,c=b.endRow||Number.MAX_VALUE,k=b.startColumn||0,l=b.endColumn||Number.MAX_VALUE;d&&jQuery.ajax({dataType:"json",url:"https://spreadsheets.google.com/feeds/cells/"+d+"/"+(b.googleSpreadsheetWorksheet||"od6")+"/public/values?alt=json-in-script&callback=?",error:b.error,success:function(b){var d,m,r=(b=b.feed.entry).length,q=0,p=0;for(m=0;m<r;m++)d=b[m],q=Math.max(q,d.gs$cell.col),p=Math.max(p,d.gs$cell.row);for(m=0;m<q;m++)m>=k&&m<=l&&(e[m-k]=[],e[m-k].length=Math.min(p,c-f));for(m=0;m<r;m++)d=b[m],g=d.gs$cell.row-1,(n=d.gs$cell.col-1)>=k&&n<=l&&g>=f&&g<=c&&(e[n-k][g-f]=d.content.$t);t(e,function(a){for(m=0;m<a.length;m++)void 0===a[m]&&(a[m]=null)}),a.dataFound()}})},trim:function(a,b){return"string"==typeof a&&(a=a.replace(/^\s+|\s+$/g,""),b&&/^[0-9\s]+$/.test(a)&&(a=a.replace(/\s/g,"")),this.decimalRegex&&(a=a.replace(this.decimalRegex,"$1.$2"))),a},parseTypes:function(){for(var a=this.columns,b=a.length;b--;)this.parseColumn(a[b],b)},parseColumn:function(a,b){var c,k,l,g,v,p,d=this.rawColumns,e=this.columns,f=a.length,n=this.firstRowAsNames,t=-1!==A(b,this.valueCount.xColumns),r=[],q=this.chartOptions,m=(this.options.columnTypes||[])[b];q=t&&(q&&q.xAxis&&"category"===F(q.xAxis)[0].type||"string"===m);for(d[b]||(d[b]=[]);f--;)c=r[f]||a[f],l=this.trim(c),g=this.trim(c,!0),k=parseFloat(g),void 0===d[b][f]&&(d[b][f]=l),q||0===f&&n?a[f]=""+l:+g===k?(a[f]=k,31536e6<k&&"float"!==m?a.isDatetime=!0:a.isNumeric=!0,void 0!==a[f+1]&&(p=k>a[f+1])):(l&&l.length&&(v=this.parseDate(c)),t&&B(v)&&"float"!==m?(r[f]=c,a[f]=v,a.isDatetime=!0,void 0!==a[f+1]&&((c=v>a[f+1])!==p&&void 0!==p&&(this.alternativeFormat?(this.dateFormat=this.alternativeFormat,f=a.length,this.alternativeFormat=this.dateFormats[this.dateFormat].alternative):a.unsorted=!0),p=c)):(a[f]=""===l?null:l,0!==f&&(a.isDatetime||a.isNumeric)&&(a.mixed=!0)));if(t&&a.mixed&&(e[b]=d[b]),t&&p&&this.options.sort)for(b=0;b<e.length;b++)e[b].reverse(),n&&e[b].unshift(e[b].pop())},dateFormats:{"YYYY/mm/dd":{regex:/^([0-9]{4})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{1,2})$/,parser:function(a){return Date.UTC(+a[1],a[2]-1,+a[3])}},"dd/mm/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(a){return Date.UTC(+a[3],a[2]-1,+a[1])},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{4})$/,parser:function(a){return Date.UTC(+a[3],a[1]-1,+a[2])}},"dd/mm/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(a){var b=(b=+a[3])>(new Date).getFullYear()-2e3?b+1900:b+2e3;return Date.UTC(b,a[2]-1,+a[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^([0-9]{1,2})[\-\/\.]([0-9]{1,2})[\-\/\.]([0-9]{2})$/,parser:function(a){return Date.UTC(+a[3]+2e3,a[1]-1,+a[2])}}},parseDate:function(a){var d,e,c,b=this.options.parseDate,f=this.options.dateFormat||this.dateFormat;if(b)d=b(a);else if("string"==typeof a){if(f)(b=this.dateFormats[f])||(b=this.dateFormats["YYYY/mm/dd"]),(c=a.match(b.regex))&&(d=b.parser(c));else for(e in this.dateFormats)if(b=this.dateFormats[e],c=a.match(b.regex)){this.dateFormat=e,this.alternativeFormat=b.alternative,d=b.parser(c);break}c||("object"==typeof(c=Date.parse(a))&&null!==c&&c.getTime?d=c.getTime()-6e4*c.getTimezoneOffset():B(c)&&(d=c-6e4*new Date(c).getTimezoneOffset()))}return d},rowsToColumns:function(a){var b,d,e,f,c;if(a)for(c=[],d=a.length,b=0;b<d;b++)for(f=a[b].length,e=0;e<f;e++)c[e]||(c[e]=[]),c[e][b]=a[b][e];return c},parsed:function(){if(this.options.parsed)return this.options.parsed.call(this,this.columns)},getFreeIndexes:function(a,b){var d,c,e=[],f=[];for(d=0;d<a;d+=1)e.push(!0);for(a=0;a<b.length;a+=1)for(c=b[a].getReferencedColumnIndexes(),d=0;d<c.length;d+=1)e[c[d]]=!1;for(d=0;d<e.length;d+=1)e[d]&&f.push(d);return f},complete:function(){var b,e,f,c,k,g,a=this.columns,d=this.options,l=[];if(d.complete||d.afterComplete){for(c=0;c<a.length;c++)this.firstRowAsNames&&(a[c].name=a[c].shift());for(e=[],f=this.getFreeIndexes(a.length,this.valueCount.seriesBuilders),c=0;c<this.valueCount.seriesBuilders.length;c++)(g=this.valueCount.seriesBuilders[c]).populateColumns(f)&&l.push(g);for(;0<f.length;){for((g=new w).addColumnReader(0,"x"),-1!==(c=A(0,f))&&f.splice(c,1),c=0;c<this.valueCount.global;c++)g.addColumnReader(void 0,this.valueCount.globalPointArrayMap[c]);g.populateColumns(f)&&l.push(g)}if(0<l.length&&0<l[0].readers.length&&(void 0!==(g=a[l[0].readers[0].columnIndex])&&(g.isDatetime?b="datetime":g.isNumeric||(b="category"))),"category"===b)for(c=0;c<l.length;c++)for(g=l[c],f=0;f<g.readers.length;f++)"x"===g.readers[f].configName&&(g.readers[f].configName="name");for(c=0;c<l.length;c++){for(g=l[c],f=[],k=0;k<a[0].length;k++)f[k]=g.read(a,k);e[c]={data:f},g.name&&(e[c].name=g.name),"category"===b&&(e[c].turboThreshold=0)}a={series:e},b&&(a.xAxis={type:b},"category"===b&&(a.xAxis.uniqueNames=!1)),d.complete&&d.complete(a),d.afterComplete&&d.afterComplete(a)}},update:function(a,b){var d=this.chart;a&&(a.afterComplete=function(a){d.update(a,b)},n.data(a))}}),n.Data=z,n.data=function(a,b){return new z(a,b)},n.wrap(n.Chart.prototype,"init",function(a,b,d){var e=this;b&&b.data?(e.data=new z(n.extend(b.data,{afterComplete:function(f){var c,k;if(b.hasOwnProperty("series"))if("object"==typeof b.series)for(c=Math.max(b.series.length,f.series.length);c--;)k=b.series[c]||{},b.series[c]=n.merge(k,f.series[c]);else delete b.series;b=n.merge(f,b),a.call(e,b,d)}}),b),e.data.chart=e):a.call(e,b,d)}),(w=function(){this.readers=[],this.pointIsArray=!0}).prototype.populateColumns=function(a){var b=!0;return t(this.readers,function(b){void 0===b.columnIndex&&(b.columnIndex=a.shift())}),t(this.readers,function(a){void 0===a.columnIndex&&(b=!1)}),b},w.prototype.read=function(a,b){var f,d=this.pointIsArray,e=d?[]:{};return t(this.readers,function(c){var f=a[c.columnIndex][b];d?e.push(f):e[c.configName]=f}),void 0===this.name&&2<=this.readers.length&&(2<=(f=this.getReferencedColumnIndexes()).length&&(f.shift(),f.sort(),this.name=a[f.shift()].name)),e},w.prototype.addColumnReader=function(a,b){this.readers.push({columnIndex:a,configName:b}),"x"!==b&&"y"!==b&&void 0!==b&&(this.pointIsArray=!1)},w.prototype.getReferencedColumnIndexes=function(){var a,d,b=[];for(a=0;a<this.readers.length;a+=1)void 0!==(d=this.readers[a]).columnIndex&&b.push(d.columnIndex);return b},w.prototype.hasReader=function(a){var b;for(b=0;b<this.readers.length;b+=1)if(this.readers[b].configName===a)return!0}}(y)}),function(m){"object"==typeof module&&module.exports?module.exports=m:m(Highcharts)}(function(m){!function(f){var m=f.animObject,z=f.noop,A=f.color,B=f.defaultOptions,l=f.each,r=f.extend,H=f.format,C=f.objectEach,v=f.pick,t=f.wrap,q=f.Chart,w=f.seriesTypes,D=w.pie,u=w.column,E=f.Tick,x=f.fireEvent,F=f.inArray,G=1;r(B.lang,{drillUpText:"◁ Back to {series.name}"}),B.drilldown={activeAxisLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},activeDataLabelStyle:{cursor:"pointer",color:"#003399",fontWeight:"bold",textDecoration:"underline"},animation:{duration:500},drillUpButton:{position:{align:"right",x:-10,y:10}}},f.SVGRenderer.prototype.Element.prototype.fadeIn=function(a){this.attr({opacity:.1,visibility:"inherit"}).animate({opacity:v(this.newOpacity,1)},a||{duration:250})},q.prototype.addSeriesAsDrilldown=function(a,b){this.addSingleSeriesAsDrilldown(a,b),this.applyDrilldown()},q.prototype.addSingleSeriesAsDrilldown=function(a,b){var g,h,p,m,d=a.series,c=d.xAxis,e=d.yAxis,k=[],n=[];m={color:a.color||d.color},this.drilldownLevels||(this.drilldownLevels=[]),h=d.options._levelNumber||0,(p=this.drilldownLevels[this.drilldownLevels.length-1])&&p.levelNumber!==h&&(p=void 0),b=r(r({_ddSeriesId:G++},m),b),g=F(a,d.points),l(d.chart.series,function(a){a.xAxis!==c||a.isDrilling||(a.options._ddSeriesId=a.options._ddSeriesId||G++,a.options._colorIndex=a.userOptions._colorIndex,a.options._levelNumber=a.options._levelNumber||h,p?(k=p.levelSeries,n=p.levelSeriesOptions):(k.push(a),n.push(a.options)))}),a=r({levelNumber:h,seriesOptions:d.options,levelSeriesOptions:n,levelSeries:k,shapeArgs:a.shapeArgs,bBox:a.graphic?a.graphic.getBBox():{},color:a.isNull?new f.Color(A).setOpacity(0).get():A,lowerSeriesOptions:b,pointOptions:d.options.data[g],pointIndex:g,oldExtremes:{xMin:c&&c.userMin,xMax:c&&c.userMax,yMin:e&&e.userMin,yMax:e&&e.userMax},resetZoomButton:this.resetZoomButton},m),this.drilldownLevels.push(a),c&&c.names&&(c.names.length=0),(b=a.lowerSeries=this.addSeries(b,!1)).options._levelNumber=h+1,c&&(c.oldPos=c.pos,c.userMin=c.userMax=null,e.userMin=e.userMax=null),d.type===b.type&&(b.animate=b.animateDrilldown||z,b.options.animation=!0)},q.prototype.applyDrilldown=function(){var b,a=this.drilldownLevels;a&&0<a.length&&(b=a[a.length-1].levelNumber,l(this.drilldownLevels,function(a){a.levelNumber===b&&l(a.levelSeries,function(a){a.options&&a.options._levelNumber===b&&a.remove(!1)})})),this.resetZoomButton&&(this.resetZoomButton.hide(),delete this.resetZoomButton),this.pointer.reset(),this.redraw(),this.showDrillUpButton()},q.prototype.getDrilldownBackText=function(){var a=this.drilldownLevels;if(a&&0<a.length)return(a=a[a.length-1]).series=a.seriesOptions,H(this.options.lang.drillUpText,a)},q.prototype.showDrillUpButton=function(){var c,e,a=this,b=this.getDrilldownBackText(),d=a.options.drilldown.drillUpButton;this.drillUpButton?this.drillUpButton.attr({text:b}).align():(e=(c=d.theme)&&c.states,this.drillUpButton=this.renderer.button(b,null,null,function(){a.drillUp()},c,e&&e.hover,e&&e.select).addClass("highcharts-drillup-button").attr({align:d.position.align,zIndex:7}).add().align(d.position,!1,d.relativeTo||"plotBox"))},q.prototype.drillUp=function(){for(var g,k,f,h,a=this,b=a.drilldownLevels,d=b[b.length-1].levelNumber,c=b.length,e=a.series,p=function(b){var c;l(e,function(a){a.options._ddSeriesId===b._ddSeriesId&&(c=a)}),(c=c||a.addSeries(b,!1)).type===f.type&&c.animateDrillupTo&&(c.animate=c.animateDrillupTo),b===k.seriesOptions&&(h=c)};c--;)if((k=b[c]).levelNumber===d){if(b.pop(),!(f=k.lowerSeries).chart)for(g=e.length;g--;)if(e[g].options.id===k.lowerSeriesOptions.id&&e[g].options._levelNumber===d+1){f=e[g];break}f.xData=[],l(k.levelSeriesOptions,p),x(a,"drillup",{seriesOptions:k.seriesOptions}),h.type===f.type&&(h.drilldownLevel=k,h.options.animation=a.options.drilldown.animation,f.animateDrillupFrom&&f.chart&&f.animateDrillupFrom(k)),h.options._levelNumber=d,f.remove(!1),h.xAxis&&(g=k.oldExtremes,h.xAxis.setExtremes(g.xMin,g.xMax,!1),h.yAxis.setExtremes(g.yMin,g.yMax,!1)),k.resetZoomButton&&(a.resetZoomButton=k.resetZoomButton,a.resetZoomButton.show())}x(a,"drillupall"),this.redraw(),0===this.drilldownLevels.length?this.drillUpButton=this.drillUpButton.destroy():this.drillUpButton.attr({text:this.getDrilldownBackText()}).align(),this.ddDupes.length=[]},t(q.prototype,"showResetZoom",function(a){this.drillUpButton||a.apply(this,Array.prototype.slice.call(arguments,1))}),u.prototype.animateDrillupTo=function(a){if(!a){var b=this,d=b.drilldownLevel;l(this.points,function(a){var b=a.dataLabel;a.graphic&&a.graphic.hide(),b&&(b.hidden="hidden"===b.attr("visibility"),b.hidden||(b.hide(),a.connector&&a.connector.hide()))}),f.syncTimeout(function(){b.points&&l(b.points,function(a,b){var c="show"===(b=b===(d&&d.pointIndex)?"show":"fadeIn")||void 0,e=a.dataLabel;a.graphic&&a.graphic[b](c),e&&!e.hidden&&(e.fadeIn(),a.connector&&a.connector.fadeIn())})},Math.max(this.chart.options.drilldown.animation.duration-50,0)),this.animate=z}},u.prototype.animateDrilldown=function(a){var c,b=this,d=this.chart.drilldownLevels,e=m(this.chart.options.drilldown.animation),g=this.xAxis;a||(l(d,function(a){b.options._ddSeriesId===a.lowerSeriesOptions._ddSeriesId&&((c=a.shapeArgs).fill=a.color)}),c.x+=v(g.oldPos,g.pos)-g.pos,l(this.points,function(a){a.shapeArgs.fill=a.color,a.graphic&&a.graphic.attr(c).animate(r(a.shapeArgs,{fill:a.color||b.color}),e),a.dataLabel&&a.dataLabel.fadeIn(e)}),this.animate=null)},u.prototype.animateDrillupFrom=function(a){var b=m(this.chart.options.drilldown.animation),d=this.group,c=d!==this.chart.columnGroup,e=this;l(e.trackerGroups,function(a){e[a]&&e[a].on("mouseover")}),c&&delete this.group,l(this.points,function(e){var g=e.graphic,n=a.shapeArgs,h=function(){g.destroy(),d&&c&&(d=d.destroy())};g&&(delete e.graphic,n.fill=a.color,b.duration?g.animate(n,f.merge(b,{complete:h})):(g.attr(n),h()))})},D&&r(D.prototype,{animateDrillupTo:u.prototype.animateDrillupTo,animateDrillupFrom:u.prototype.animateDrillupFrom,animateDrilldown:function(a){var b=this.chart.drilldownLevels[this.chart.drilldownLevels.length-1],d=this.chart.options.drilldown.animation,c=b.shapeArgs,e=c.start,g=(c.end-e)/this.points.length;a||(l(this.points,function(a,n){var h=a.shapeArgs;c.fill=b.color,h.fill=a.color,a.graphic&&a.graphic.attr(f.merge(c,{start:e+n*g,end:e+(n+1)*g}))[d?"animate":"attr"](h,d)}),this.animate=null)}}),f.Point.prototype.doDrilldown=function(a,b,d){var f,c=this.series.chart,e=c.options.drilldown,g=(e.series||[]).length;for(c.ddDupes||(c.ddDupes=[]);g--&&!f;)e.series[g].id===this.drilldown&&-1===F(this.drilldown,c.ddDupes)&&(f=e.series[g],c.ddDupes.push(this.drilldown));x(c,"drilldown",{point:this,seriesOptions:f,category:b,originalEvent:d,points:void 0!==b&&this.series.xAxis.getDDPoints(b).slice(0)},function(b){var c=b.point.series&&b.point.series.chart,d=b.seriesOptions;c&&d&&(a?c.addSingleSeriesAsDrilldown(b.point,d):c.addSeriesAsDrilldown(b.point,d))})},f.Axis.prototype.drilldownCategory=function(a,b){C(this.getDDPoints(a),function(d){d&&d.series&&d.series.visible&&d.doDrilldown&&d.doDrilldown(!0,a,b)}),this.chart.applyDrilldown()},f.Axis.prototype.getDDPoints=function(a){var b=[];return l(this.series,function(d){var c,e=d.xData,f=d.points;for(c=0;c<e.length;c++)if(e[c]===a&&d.options.data[c]&&d.options.data[c].drilldown){b.push(!f||f[c]);break}}),b},E.prototype.drillable=function(){var a=this.pos,b=this.label,d=this.axis,c="xAxis"===d.coll&&d.getDDPoints,e=c&&d.getDDPoints(a);c&&(b&&e.length?(b.drillable=!0,b.basicStyles||(b.basicStyles=f.merge(b.styles)),b.addClass("highcharts-drilldown-axis-label").css(d.chart.options.drilldown.activeAxisLabelStyle).on("click",function(b){d.drilldownCategory(a,b)})):b&&b.drillable&&(b.styles={},b.css(b.basicStyles),b.on("click",null),b.removeClass("highcharts-drilldown-axis-label")))},t(E.prototype,"addLabel",function(a){a.call(this),this.drillable()}),t(f.Point.prototype,"init",function(a,b,d,c){var e=a.call(this,b,d,c);return c=(a=b.xAxis)&&a.ticks[c],e.drilldown&&f.addEvent(e,"click",function(a){b.xAxis&&!1===b.chart.options.drilldown.allowPointDrilldown?b.xAxis.drilldownCategory(e.x,a):e.doDrilldown(void 0,void 0,a)}),c&&c.drillable(),e}),t(f.Series.prototype,"drawDataLabels",function(a){var b=this.chart.options.drilldown.activeDataLabelStyle,d=this.chart.renderer;a.call(this),l(this.points,function(a){var c=a.options.dataLabels,f=v(a.dlOptions,c&&c.style,{});a.drilldown&&a.dataLabel&&("contrast"===b.color&&(f.color=d.getContrast(a.color||this.color)),c&&c.color&&(f.color=c.color),a.dataLabel.addClass("highcharts-drilldown-data-label"),a.dataLabel.css(b).css(f))},this)});var y=function(a,b,d){a[d?"addClass":"removeClass"]("highcharts-drilldown-point"),a.css({cursor:b})},I=function(a){a.call(this),l(this.points,function(a){a.drilldown&&a.graphic&&y(a.graphic,"pointer",!0)})},J=function(a,b){var d=a.apply(this,Array.prototype.slice.call(arguments,1));return this.drilldown&&this.series.halo&&"hover"===b?y(this.series.halo,"pointer",!0):this.series.halo&&y(this.series.halo,"auto",!1),d};C(w,function(a){t(a.prototype,"drawTracker",I),t(a.prototype.pointClass.prototype,"setState",J)})}(m)}),function(k){"object"==typeof module&&module.exports?module.exports=k:k(Highcharts)}(function(k){!function(f){var k=f.defaultOptions,z=f.doc,B=f.Chart,w=f.addEvent,I=f.removeEvent,F=f.fireEvent,p=f.createElement,C=f.discardElement,u=f.css,n=f.merge,D=f.pick,h=f.each,G=f.objectEach,r=f.extend,J=f.isTouchDevice,E=f.win,H=E.navigator.userAgent,K=f.Renderer.prototype.symbols;/Edge\/|Trident\/|MSIE /.test(H),/firefox/i.test(H),r(k.lang,{printChart:"Print chart",downloadPNG:"Download PNG image",downloadJPEG:"Download JPEG image",downloadPDF:"Download PDF document",downloadSVG:"Download SVG vector image",contextButtonTitle:"Chart context menu"}),k.navigation={buttonOptions:{theme:{},symbolSize:14,symbolX:12.5,symbolY:10.5,align:"right",buttonSpacing:3,height:22,verticalAlign:"top",width:24}},n(!0,k.navigation,{menuStyle:{border:"1px solid #999999",background:"#ffffff",padding:"5px 0"},menuItemStyle:{padding:"0.5em 1em",background:"none",color:"#333333",fontSize:J?"14px":"11px",transition:"background 250ms, color 250ms"},menuItemHoverStyle:{background:"#335cad",color:"#ffffff"},buttonOptions:{symbolFill:"#666666",symbolStroke:"#666666",symbolStrokeWidth:3,theme:{fill:"#ffffff",stroke:"none",padding:5}}}),k.exporting={type:"image/png",url:"https://export.highcharts.com/",printMaxWidth:780,scale:2,buttons:{contextButton:{className:"highcharts-contextbutton",menuClassName:"highcharts-contextmenu",symbol:"menu",_titleKey:"contextButtonTitle",menuItems:"printChart separator downloadPNG downloadJPEG downloadPDF downloadSVG".split(" ")}},menuItemDefinitions:{printChart:{textKey:"printChart",onclick:function(){this.print()}},separator:{separator:!0},downloadPNG:{textKey:"downloadPNG",onclick:function(){this.exportChart()}},downloadJPEG:{textKey:"downloadJPEG",onclick:function(){this.exportChart({type:"image/jpeg"})}},downloadPDF:{textKey:"downloadPDF",onclick:function(){this.exportChart({type:"application/pdf"})}},downloadSVG:{textKey:"downloadSVG",onclick:function(){this.exportChart({type:"image/svg+xml"})}}}},f.post=function(a,b,e){var c=p("form",n({method:"post",action:a,enctype:"multipart/form-data"},e),{display:"none"},z.body);G(b,function(a,b){p("input",{type:"hidden",name:b,value:a},null,c)}),c.submit(),C(c)},r(B.prototype,{sanitizeSVG:function(a,b){if(b&&b.exporting&&b.exporting.allowHTML){var e=a.match(/<\/svg>(.*?$)/);e&&e[1]&&(e='<foreignObject x="0" y="0" width="'+b.chart.width+'" height="'+b.chart.height+'"><body xmlns="http://www.w3.org/1999/xhtml">'+e[1]+"</body></foreignObject>",a=a.replace("</svg>",e+"</svg>"))}return a=a.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/url\(("|&quot;)(\S+)("|&quot;)\)/g,"url($2)").replace(/url\([^#]+#/g,"url(#").replace(/<svg /,'<svg xmlns:xlink="http://www.w3.org/1999/xlink" ').replace(/ (NS[0-9]+\:)?href=/g," xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/(fill|stroke)="rgba\(([ 0-9]+,[ 0-9]+,[ 0-9]+),([ 0-9\.]+)\)"/g,'$1="rgb($2)" $1-opacity="$3"').replace(/&nbsp;/g," ").replace(/&shy;/g,"­"),this.ieSanitizeSVG&&(a=this.ieSanitizeSVG(a)),a},getChartHTML:function(){return this.container.innerHTML},getSVG:function(a){var b,e,c,v,m,g=n(this.options,a);return e=p("div",null,{position:"absolute",top:"-9999em",width:this.chartWidth+"px",height:this.chartHeight+"px"},z.body),c=this.renderTo.style.width,m=this.renderTo.style.height,c=g.exporting.sourceWidth||g.chart.width||/px$/.test(c)&&parseInt(c,10)||600,m=g.exporting.sourceHeight||g.chart.height||/px$/.test(m)&&parseInt(m,10)||400,r(g.chart,{animation:!1,renderTo:e,forExport:!0,renderer:"SVGRenderer",width:c,height:m}),g.exporting.enabled=!1,delete g.data,g.series=[],h(this.series,function(a){(v=n(a.userOptions,{animation:!1,enableMouseTracking:!1,showCheckbox:!1,visible:a.visible})).isInternal||g.series.push(v)}),h(this.axes,function(a){a.userOptions.internalKey||(a.userOptions.internalKey=f.uniqueKey())}),b=new f.Chart(g,this.callback),a&&h(["xAxis","yAxis","series"],function(c){var d={};a[c]&&(d[c]=a[c],b.update(d))}),h(this.axes,function(a){var c=f.find(b.axes,function(b){return b.options.internalKey===a.userOptions.internalKey}),e=(d=a.getExtremes()).userMin,d=d.userMax;!c||void 0===e&&void 0===d||c.setExtremes(e,d,!0,!1)}),c=b.getChartHTML(),c=this.sanitizeSVG(c,g),g=null,b.destroy(),C(e),c},getSVGForExport:function(a,b){var e=this.options.exporting;return this.getSVG(n({chart:{borderRadius:0}},e.chartOptions,b,{exporting:{sourceWidth:a&&a.sourceWidth||e.sourceWidth,sourceHeight:a&&a.sourceHeight||e.sourceHeight}}))},exportChart:function(a,b){b=this.getSVGForExport(a,b),a=n(this.options.exporting,a),f.post(a.url,{filename:a.filename||"chart",type:a.type,width:a.width||0,scale:a.scale,svg:b},a.formAttributes)},print:function(){var d,t,a=this,b=a.container,e=[],c=b.parentNode,f=z.body,m=f.childNodes,g=a.options.exporting.printMaxWidth;a.isPrinting||(a.isPrinting=!0,a.pointer.reset(null,0),F(a,"beforePrint"),(t=g&&a.chartWidth>g)&&(d=[a.options.chart.width,void 0,!1],a.setSize(g,void 0,!1)),h(m,function(a,b){1===a.nodeType&&(e[b]=a.style.display,a.style.display="none")}),f.appendChild(b),E.focus(),E.print(),setTimeout(function(){c.appendChild(b),h(m,function(a,b){1===a.nodeType&&(a.style.display=e[b])}),a.isPrinting=!1,t&&a.setSize.apply(a,d),F(a,"afterPrint")},1e3))},contextMenu:function(a,b,e,c,v,m,g){var y,A,d=this,t=d.options.navigation,k=d.chartWidth,q=d.chartHeight,n="cache-"+a,l=d[n],x=Math.max(v,m);l||(d[n]=l=p("div",{className:a},{position:"absolute",zIndex:1e3,padding:x+"px"},d.container),y=p("div",{className:"highcharts-menu"},null,l),u(y,r({MozBoxShadow:"3px 3px 10px #888",WebkitBoxShadow:"3px 3px 10px #888",boxShadow:"3px 3px 10px #888"},t.menuStyle)),A=function(){u(l,{display:"none"}),g&&g.setState(0),d.openMenu=!1},d.exportEvents.push(w(l,"mouseleave",function(){l.hideTimer=setTimeout(A,500)}),w(l,"mouseenter",function(){clearTimeout(l.hideTimer)}),w(z,"mouseup",function(b){d.pointer.inClass(b.target,a)||A()})),h(b,function(a){var b;("string"==typeof a&&(a=d.options.exporting.menuItemDefinitions[a]),f.isObject(a,!0))&&(a.separator?b=p("hr",null,null,y):((b=p("div",{className:"highcharts-menu-item",onclick:function(b){b&&b.stopPropagation(),A(),a.onclick&&a.onclick.apply(d,arguments)},innerHTML:a.text||d.options.lang[a.textKey]},null,y)).onmouseover=function(){u(this,t.menuItemHoverStyle)},b.onmouseout=function(){u(this,t.menuItemStyle)},u(b,r({cursor:"pointer"},t.menuItemStyle))),d.exportDivElements.push(b))}),d.exportDivElements.push(y,l),d.exportMenuWidth=l.offsetWidth,d.exportMenuHeight=l.offsetHeight),b={display:"block"},e+d.exportMenuWidth>k?b.right=k-e-v-x+"px":b.left=e-x+"px",c+m+d.exportMenuHeight>q&&"top"!==g.alignOptions.verticalAlign?b.bottom=q-c-x+"px":b.top=c+m-x+"px",u(l,b),d.openMenu=!0},addButton:function(a){var g,d,b=this,e=b.renderer,c=n(b.options.navigation.buttonOptions,a),f=c.onclick,m=c.menuItems,k=c.symbolSize||12;if(b.btnCount||(b.btnCount=0),b.exportDivElements||(b.exportDivElements=[],b.exportSVGElements=[]),!1!==c.enabled){var l,h=c.theme,p=(q=h.states)&&q.hover,q=q&&q.select;delete h.states,f?l=function(a){a.stopPropagation(),f.call(b,a)}:m&&(l=function(){b.contextMenu(d.menuClassName,m,d.translateX,d.translateY,d.width,d.height,d),d.setState(2)}),c.text&&c.symbol?h.paddingLeft=D(h.paddingLeft,25):c.text||r(h,{width:c.width,height:c.height,padding:0}),(d=e.button(c.text,0,0,l,h,p,q).addClass(a.className).attr({"stroke-linecap":"round",title:b.options.lang[c._titleKey],zIndex:3})).menuClassName=a.menuClassName||"highcharts-menu-"+b.btnCount++,c.symbol&&(g=e.symbol(c.symbol,c.symbolX-k/2,c.symbolY-k/2,k,k).addClass("highcharts-button-symbol").attr({zIndex:1}).add(d)).attr({stroke:c.symbolStroke,fill:c.symbolFill,"stroke-width":c.symbolStrokeWidth||1}),d.add().align(r(c,{width:d.width,x:D(c.x,b.buttonOffset)}),!0,"spacingBox"),b.buttonOffset+=(d.width+c.buttonSpacing)*("right"===c.align?-1:1),b.exportSVGElements.push(d,g)}},destroyExport:function(a){var b=a?a.target:this;a=b.exportSVGElements;var f,e=b.exportDivElements,c=b.exportEvents;a&&(h(a,function(a,c){a&&(a.onclick=a.ontouchstart=null,f="cache-"+a.menuClassName,b[f]&&delete b[f],b.exportSVGElements[c]=a.destroy())}),a.length=0),e&&(h(e,function(a,c){clearTimeout(a.hideTimer),I(a,"mouseleave"),b.exportDivElements[c]=a.onmouseout=a.onmouseover=a.ontouchstart=a.onclick=null,C(a)}),e.length=0),c&&(h(c,function(a){a()}),c.length=0)}}),K.menu=function(a,b,e,c){return["M",a,b+2.5,"L",a+e,b+2.5,"M",a,b+c/2+.5,"L",a+e,b+c/2+.5,"M",a,b+c-1.5,"L",a+e,b+c-1.5]},B.prototype.renderExporting=function(){var a=this,b=a.options.exporting,e=b.buttons,c=a.isDirtyExporting||!a.exportSVGElements;a.buttonOffset=0,a.isDirtyExporting&&a.destroyExport(),c&&!1!==b.enabled&&(a.exportEvents=[],G(e,function(b){a.addButton(b)}),a.isDirtyExporting=!1),w(a,"destroy",a.destroyExport)},B.prototype.callbacks.push(function(a){a.renderExporting(),w(a,"redraw",a.renderExporting),h(["exporting","navigation"],function(b){a[b]={update:function(e,c){a.isDirtyExporting=!0,n(!0,a.options[b],e),D(c,!0)&&a.redraw()}}})})}(k)}),function($){var charMin,defaults,fillRGBFields,fillHSBFields,fillHexFields,setSelector,setHue,setCurrentColor,setNewColor,keyDown,change,blur,focus,downIncrement,moveIncrement,upIncrement,downHue,moveHue,upHue,downSelector,moveSelector,upSelector,enterSubmit,leaveSubmit,clickSubmit,show,hide,isChildOf,getViewport,fixHSB,fixRGB,fixHex,HexToHSB,RGBToHSB,HSBToRGB,HSBToHex,restoreOriginal;charMin=65,defaults={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!1},fillRGBFields=function(hsb,cal){var rgb=HSBToRGB(hsb);$(cal).data("colorpicker").fields.eq(1).val(rgb.r).end().eq(2).val(rgb.g).end().eq(3).val(rgb.b).end()},fillHSBFields=function(hsb,cal){$(cal).data("colorpicker").fields.eq(4).val(hsb.h).end().eq(5).val(hsb.s).end().eq(6).val(hsb.b).end()},fillHexFields=function(hsb,cal){$(cal).data("colorpicker").fields.eq(0).val(HSBToHex(hsb)).end()},setSelector=function(hsb,cal){$(cal).data("colorpicker").selector.css("backgroundColor","#"+HSBToHex({h:hsb.h,s:100,b:100})),$(cal).data("colorpicker").selectorIndic.css({left:parseInt(150*hsb.s/100,10),top:parseInt(150*(100-hsb.b)/100,10)})},setHue=function(hsb,cal){$(cal).data("colorpicker").hue.css("top",parseInt(150-150*hsb.h/360,10))},setCurrentColor=function(hsb,cal){$(cal).data("colorpicker").currentColor.css("backgroundColor","#"+HSBToHex(hsb))},setNewColor=function(hsb,cal){$(cal).data("colorpicker").newColor.css("backgroundColor","#"+HSBToHex(hsb))},keyDown=function(ev){var pressedKey=ev.charCode||ev.keyCode||-1;if(pressedKey>charMin&&pressedKey<=90||32==pressedKey)return!1;!0===$(this).parent().parent().data("colorpicker").livePreview&&change.apply(this)},change=function(ev){var col,cal=$(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?cal.data("colorpicker").color=col=HexToHSB(fixHex(this.value)):this.parentNode.className.indexOf("_hsb")>0?cal.data("colorpicker").color=col=fixHSB({h:parseInt(cal.data("colorpicker").fields.eq(4).val(),10),s:parseInt(cal.data("colorpicker").fields.eq(5).val(),10),b:parseInt(cal.data("colorpicker").fields.eq(6).val(),10)}):cal.data("colorpicker").color=col=RGBToHSB(fixRGB({r:parseInt(cal.data("colorpicker").fields.eq(1).val(),10),g:parseInt(cal.data("colorpicker").fields.eq(2).val(),10),b:parseInt(cal.data("colorpicker").fields.eq(3).val(),10)})),ev&&(fillRGBFields(col,cal.get(0)),fillHexFields(col,cal.get(0)),fillHSBFields(col,cal.get(0))),setSelector(col,cal.get(0)),setHue(col,cal.get(0)),setNewColor(col,cal.get(0)),cal.data("colorpicker").onChange.apply(cal,[col,HSBToHex(col),HSBToRGB(col)])},blur=function(ev){$(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus")},focus=function(){charMin=this.parentNode.className.indexOf("_hex")>0?70:65,$(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),$(this).parent().addClass("colorpicker_focus")},downIncrement=function(ev){var field=$(this).parent().find("input").focus(),current={el:$(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:ev.pageY,field:field,val:parseInt(field.val(),10),preview:$(this).parent().parent().data("colorpicker").livePreview};$(document).bind("mouseup",current,upIncrement),$(document).bind("mousemove",current,moveIncrement)},moveIncrement=function(ev){return ev.data.field.val(Math.max(0,Math.min(ev.data.max,parseInt(ev.data.val+ev.pageY-ev.data.y,10)))),ev.data.preview&&change.apply(ev.data.field.get(0),[!0]),!1},upIncrement=function(ev){return change.apply(ev.data.field.get(0),[!0]),ev.data.el.removeClass("colorpicker_slider").find("input").focus(),$(document).unbind("mouseup",upIncrement),$(document).unbind("mousemove",moveIncrement),!1},downHue=function(ev){var current={cal:$(this).parent(),y:$(this).offset().top};current.preview=current.cal.data("colorpicker").livePreview,$(document).bind("mouseup",current,upHue),$(document).bind("mousemove",current,moveHue)},moveHue=function(ev){return change.apply(ev.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,ev.pageY-ev.data.y)))/150,10)).get(0),[ev.data.preview]),!1},upHue=function(ev){return fillRGBFields(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0)),fillHexFields(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0)),$(document).unbind("mouseup",upHue),$(document).unbind("mousemove",moveHue),!1},downSelector=function(ev){var current={cal:$(this).parent(),pos:$(this).offset()};current.preview=current.cal.data("colorpicker").livePreview,$(document).bind("mouseup",current,upSelector),$(document).bind("mousemove",current,moveSelector)},moveSelector=function(ev){return change.apply(ev.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,ev.pageY-ev.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,ev.pageX-ev.data.pos.left))/150,10)).get(0),[ev.data.preview]),!1},upSelector=function(ev){return fillRGBFields(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0)),fillHexFields(ev.data.cal.data("colorpicker").color,ev.data.cal.get(0)),$(document).unbind("mouseup",upSelector),$(document).unbind("mousemove",moveSelector),!1},enterSubmit=function(ev){$(this).addClass("colorpicker_focus")},leaveSubmit=function(ev){$(this).removeClass("colorpicker_focus")},clickSubmit=function(ev){var cal=$(this).parent(),col=cal.data("colorpicker").color;cal.data("colorpicker").origColor=col,setCurrentColor(col,cal.get(0)),cal.data("colorpicker").onSubmit(col,HSBToHex(col),HSBToRGB(col),cal.data("colorpicker").el)},show=function(ev){var cal=$("#"+$(this).data("colorpickerId"));cal.data("colorpicker").onBeforeShow.apply(this,[cal.get(0)]);var pos=$(this).offset(),viewPort=getViewport(),top=pos.top+this.offsetHeight,left=pos.left;return top+176>viewPort.t+viewPort.h&&(top-=this.offsetHeight+176),left+356>viewPort.l+viewPort.w&&(left-=356),cal.css({left:left+"px",top:top+"px"}),0!=cal.data("colorpicker").onShow.apply(this,[cal.get(0)])&&cal.show(),$(document).bind("mousedown",{cal:cal},hide),!1},hide=function(ev){isChildOf(ev.data.cal.get(0),ev.target,ev.data.cal.get(0))||(0!=ev.data.cal.data("colorpicker").onHide.apply(this,[ev.data.cal.get(0)])&&ev.data.cal.hide(),$(document).unbind("mousedown",hide))},isChildOf=function(parentEl,el,container){if(parentEl==el)return!0;if(parentEl.contains)return parentEl.contains(el);if(parentEl.compareDocumentPosition)return!!(16&parentEl.compareDocumentPosition(el));for(var prEl=el.parentNode;prEl&&prEl!=container;){if(prEl==parentEl)return!0;prEl=prEl.parentNode}return!1},getViewport=function(){var m="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(m?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(m?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(m?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(m?document.documentElement.clientHeight:document.body.clientHeight)}},fixHSB=function(hsb){return{h:Math.min(360,Math.max(0,hsb.h)),s:Math.min(100,Math.max(0,hsb.s)),b:Math.min(100,Math.max(0,hsb.b))}},fixRGB=function(rgb){return{r:Math.min(255,Math.max(0,rgb.r)),g:Math.min(255,Math.max(0,rgb.g)),b:Math.min(255,Math.max(0,rgb.b))}},fixHex=function(hex){var len=6-hex.length;if(len>0){for(var o=[],i=0;i<len;i++)o.push("0");o.push(hex),hex=o.join("")}return hex},HexToHSB=function(hex){return RGBToHSB(function(hex){return{r:(hex=parseInt(hex.indexOf("#")>-1?hex.substring(1):hex,16))>>16,g:(65280&hex)>>8,b:255&hex}}(hex))},RGBToHSB=function(rgb){var hsb={h:0,s:0,b:0},min=Math.min(rgb.r,rgb.g,rgb.b),max=Math.max(rgb.r,rgb.g,rgb.b),delta=max-min;return hsb.b=max,hsb.s=0!=max?255*delta/max:0,0!=hsb.s?rgb.r==max?hsb.h=(rgb.g-rgb.b)/delta:rgb.g==max?hsb.h=2+(rgb.b-rgb.r)/delta:hsb.h=4+(rgb.r-rgb.g)/delta:hsb.h=-1,hsb.h*=60,hsb.h<0&&(hsb.h+=360),hsb.s*=100/255,hsb.b*=100/255,hsb},HSBToRGB=function(hsb){var rgb={},h=Math.round(hsb.h),s=Math.round(255*hsb.s/100),v=Math.round(255*hsb.b/100);if(0==s)rgb.r=rgb.g=rgb.b=v;else{var t1=v,t2=(255-s)*v/255,t3=h%60*(t1-t2)/60;360==h&&(h=0),h<60?(rgb.r=t1,rgb.b=t2,rgb.g=t2+t3):h<120?(rgb.g=t1,rgb.b=t2,rgb.r=t1-t3):h<180?(rgb.g=t1,rgb.r=t2,rgb.b=t2+t3):h<240?(rgb.b=t1,rgb.r=t2,rgb.g=t1-t3):h<300?(rgb.b=t1,rgb.g=t2,rgb.r=t2+t3):h<360?(rgb.r=t1,rgb.g=t2,rgb.b=t1-t3):(rgb.r=0,rgb.g=0,rgb.b=0)}return{r:Math.round(rgb.r),g:Math.round(rgb.g),b:Math.round(rgb.b)}},HSBToHex=function(hsb){return rgb=HSBToRGB(hsb),hex=[rgb.r.toString(16),rgb.g.toString(16),rgb.b.toString(16)],$.each(hex,function(nr,val){1==val.length&&(hex[nr]="0"+val)}),hex.join("");var rgb,hex},restoreOriginal=function(){var cal=$(this).parent(),col=cal.data("colorpicker").origColor;cal.data("colorpicker").color=col,fillRGBFields(col,cal.get(0)),fillHexFields(col,cal.get(0)),fillHSBFields(col,cal.get(0)),setSelector(col,cal.get(0)),setHue(col,cal.get(0)),setNewColor(col,cal.get(0))},ColorPicker={init:function(opt){if("string"==typeof(opt=$.extend({},defaults,opt||{})).color)opt.color=HexToHSB(opt.color);else if(void 0!=opt.color.r&&void 0!=opt.color.g&&void 0!=opt.color.b)opt.color=RGBToHSB(opt.color);else{if(void 0==opt.color.h||void 0==opt.color.s||void 0==opt.color.b)return this;opt.color=fixHSB(opt.color)}return this.each(function(){if(!$(this).data("colorpickerId")){var options=$.extend({},opt);options.origColor=opt.color;var id="collorpicker_"+parseInt(1e3*Math.random());$(this).data("colorpickerId",id);var cal=$('<div class="colorpicker"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_submit"></div></div>').attr("id",id);options.flat?cal.appendTo(this).show():cal.appendTo(document.body),options.fields=cal.find("input").bind("keyup",keyDown).bind("change",change).bind("blur",blur).bind("focus",focus),cal.find("span").bind("mousedown",downIncrement).end().find(">div.colorpicker_current_color").bind("click",restoreOriginal),options.selector=cal.find("div.colorpicker_color").bind("mousedown",downSelector),options.selectorIndic=options.selector.find("div div"),options.el=this,options.hue=cal.find("div.colorpicker_hue div"),cal.find("div.colorpicker_hue").bind("mousedown",downHue),options.newColor=cal.find("div.colorpicker_new_color"),options.currentColor=cal.find("div.colorpicker_current_color"),cal.data("colorpicker",options),cal.find("div.colorpicker_submit").bind("mouseenter",enterSubmit).bind("mouseleave",leaveSubmit).bind("click",clickSubmit),fillRGBFields(options.color,cal.get(0)),fillHSBFields(options.color,cal.get(0)),fillHexFields(options.color,cal.get(0)),setHue(options.color,cal.get(0)),setSelector(options.color,cal.get(0)),setCurrentColor(options.color,cal.get(0)),setNewColor(options.color,cal.get(0)),options.flat?cal.css({position:"relative",display:"block"}):$(this).bind(options.eventName,show)}})},showPicker:function(){return this.each(function(){$(this).data("colorpickerId")&&show.apply(this)})},hidePicker:function(){return this.each(function(){$(this).data("colorpickerId")&&$("#"+$(this).data("colorpickerId")).hide()})},setColor:function(col){if("string"==typeof col)col=HexToHSB(col);else if(void 0!=col.r&&void 0!=col.g&&void 0!=col.b)col=RGBToHSB(col);else{if(void 0==col.h||void 0==col.s||void 0==col.b)return this;col=fixHSB(col)}return this.each(function(){if($(this).data("colorpickerId")){var cal=$("#"+$(this).data("colorpickerId"));cal.data("colorpicker").color=col,cal.data("colorpicker").origColor=col,fillRGBFields(col,cal.get(0)),fillHSBFields(col,cal.get(0)),fillHexFields(col,cal.get(0)),setHue(col,cal.get(0)),setSelector(col,cal.get(0)),setCurrentColor(col,cal.get(0)),setNewColor(col,cal.get(0))}})}},$.fn.extend({ColorPicker:ColorPicker.init,ColorPickerHide:ColorPicker.hidePicker,ColorPickerShow:ColorPicker.showPicker,ColorPickerSetColor:ColorPicker.setColor})}(jQuery),function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,l=(r.unshift,i.toString),c=i.hasOwnProperty,h=r.forEach,p=r.map,d=r.reduce,v=r.reduceRight,m=r.filter,g=r.every,y=r.some,b=r.indexOf,w=r.lastIndexOf,E=Array.isArray,S=Object.keys,x=s.bind,T=function(e){return e instanceof T?e:this instanceof T?void(this._wrapped=e):new T(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=T),exports._=T):e._=T,T.VERSION="1.4.2";var N=T.each=T.forEach=function(e,t,r){if(null!=e)if(h&&e.forEach===h)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else for(var o in e)if(T.has(e,o)&&t.call(r,e[o],o,e)===n)return};T.map=T.collect=function(e,t,n){var r=[];return null==e?r:p&&e.map===p?e.map(t,n):(N(e,function(e,i,s){r[r.length]=t.call(n,e,i,s)}),r)},T.reduce=T.foldl=T.inject=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),d&&e.reduce===d)return r&&(t=T.bind(t,r)),i?e.reduce(t,n):e.reduce(t);if(N(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)}),!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.reduceRight=T.foldr=function(e,t,n,r){var i=arguments.length>2;if(null==e&&(e=[]),v&&e.reduceRight===v)return r&&(t=T.bind(t,r)),arguments.length>2?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=T.keys(e);s=o.length}if(N(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)}),!i)throw new TypeError("Reduce of empty array with no initial value");return n},T.find=T.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},T.filter=T.select=function(e,t,n){var r=[];return null==e?r:m&&e.filter===m?e.filter(t,n):(N(e,function(e,i,s){t.call(n,e,i,s)&&(r[r.length]=e)}),r)},T.reject=function(e,t,n){var r=[];return null==e?r:(N(e,function(e,i,s){t.call(n,e,i,s)||(r[r.length]=e)}),r)},T.every=T.all=function(e,t,r){t||(t=T.identity);var i=!0;return null==e?i:g&&e.every===g?e.every(t,r):(N(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=T.some=T.any=function(e,t,r){t||(t=T.identity);var i=!1;return null==e?i:y&&e.some===y?e.some(t,r):(N(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};T.contains=T.include=function(e,t){var n=!1;return null==e?n:b&&e.indexOf===b?-1!=e.indexOf(t):n=C(e,function(e){return e===t})},T.invoke=function(e,t){var n=u.call(arguments,2);return T.map(e,function(e){return(T.isFunction(t)?t:e[t]).apply(e,n)})},T.pluck=function(e,t){return T.map(e,function(e){return e[t]})},T.where=function(e,t){return T.isEmpty(t)?[]:T.filter(e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},T.max=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&T.isEmpty(e))return-1/0;var r={computed:-1/0};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>=r.computed&&(r={value:e,computed:o})}),r.value},T.min=function(e,t,n){if(!t&&T.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&T.isEmpty(e))return 1/0;var r={computed:1/0};return N(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},T.shuffle=function(e){var t,n=0,r=[];return N(e,function(e){t=T.random(n++),r[n-1]=r[t],r[t]=e}),r};var k=function(e){return T.isFunction(e)?e:function(t){return t[e]}};T.sortBy=function(e,t,n){var r=k(t);return T.pluck(T.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(n<r||void 0===r)return-1}return e.index<t.index?-1:1}),"value")};var L=function(e,t,n,r){var i={},s=k(t);return N(e,function(t,o){var u=s.call(n,t,o,e);r(i,u,t)}),i};T.groupBy=function(e,t,n){return L(e,t,n,function(e,t,n){(T.has(e,t)?e[t]:e[t]=[]).push(n)})},T.countBy=function(e,t,n){return L(e,t,n,function(e,t,n){T.has(e,t)||(e[t]=0),e[t]++})},T.sortedIndex=function(e,t,n,r){for(var i=(n=null==n?T.identity:k(n)).call(r,t),s=0,o=e.length;s<o;){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},T.toArray=function(e){return e?e.length===+e.length?u.call(e):T.values(e):[]},T.size=function(e){return e.length===+e.length?e.length:T.keys(e).length},T.first=T.head=T.take=function(e,t,n){return null==t||n?e[0]:u.call(e,0,t)},T.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},T.last=function(e,t,n){return null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},T.rest=T.tail=T.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},T.compact=function(e){return T.filter(e,function(e){return!!e})};var A=function(e,t,n){return N(e,function(e){T.isArray(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n};T.flatten=function(e,t){return A(e,t,[])},T.without=function(e){return T.difference(e,u.call(arguments,1))},T.uniq=T.unique=function(e,t,n,r){var i=n?T.map(e,n,r):e,s=[],o=[];return N(i,function(n,r){(t?r&&o[o.length-1]===n:T.contains(o,n))||(o.push(n),s.push(e[r]))}),s},T.union=function(){return T.uniq(a.apply(r,arguments))},T.intersection=function(e){var t=u.call(arguments,1);return T.filter(T.uniq(e),function(e){return T.every(t,function(t){return T.indexOf(t,e)>=0})})},T.difference=function(e){var t=a.apply(r,u.call(arguments,1));return T.filter(e,function(e){return!T.contains(t,e)})},T.zip=function(){for(var e=u.call(arguments),t=T.max(T.pluck(e,"length")),n=new Array(t),r=0;r<t;r++)n[r]=T.pluck(e,""+r);return n},T.object=function(e,t){for(var n={},r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},T.indexOf=function(e,t,n){if(null==e)return-1;var r=0,i=e.length;if(n){if("number"!=typeof n)return e[r=T.sortedIndex(e,t)]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(b&&e.indexOf===b)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},T.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(w&&e.lastIndexOf===w)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var i=r?n:e.length;i--;)if(e[i]===t)return i;return-1},T.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);i<r;)s[i++]=e,e+=n;return s};var O=function(){};T.bind=function(t,n){var r,i;if(t.bind===x&&x)return x.apply(t,u.call(arguments,1));if(!T.isFunction(t))throw new TypeError;return i=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=t.prototype;var e=new O,s=t.apply(e,i.concat(u.call(arguments)));return Object(s)===s?s:e}return t.apply(n,i.concat(u.call(arguments)))}},T.bindAll=function(e){var t=u.call(arguments,1);return 0==t.length&&(t=T.functions(e)),N(t,function(t){e[t]=T.bind(e[t],e)}),e},T.memoize=function(e,t){var n={};return t||(t=T.identity),function(){var r=t.apply(this,arguments);return T.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},T.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},T.defer=function(e){return T.delay.apply(T,[e,1].concat(u.call(arguments,1)))},T.throttle=function(e,t){var n,r,i,s,o,u,a=T.debounce(function(){o=s=!1},t);return function(){n=this,r=arguments;return i||(i=setTimeout(function(){i=null,o&&(u=e.apply(n,r)),a()},t)),s?o=!0:(s=!0,u=e.apply(n,r)),a(),u}},T.debounce=function(e,t,n){var r,i;return function(){var s=this,o=arguments,a=n&&!r;return clearTimeout(r),r=setTimeout(function(){r=null,n||(i=e.apply(s,o))},t),a&&(i=e.apply(s,o)),i}},T.once=function(e){var n,t=!1;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},T.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},T.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},T.after=function(e,t){return e<=0?t():function(){if(--e<1)return t.apply(this,arguments)}},T.keys=S||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)T.has(e,n)&&(t[t.length]=n);return t},T.values=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push(e[n]);return t},T.pairs=function(e){var t=[];for(var n in e)T.has(e,n)&&t.push([n,e[n]]);return t},T.invert=function(e){var t={};for(var n in e)T.has(e,n)&&(t[e[n]]=n);return t},T.functions=T.methods=function(e){var t=[];for(var n in e)T.isFunction(e[n])&&t.push(n);return t.sort()},T.extend=function(e){return N(u.call(arguments,1),function(t){for(var n in t)e[n]=t[n]}),e},T.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return N(n,function(n){n in e&&(t[n]=e[n])}),t},T.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)T.contains(n,i)||(t[i]=e[i]);return t},T.defaults=function(e){return N(u.call(arguments,1),function(t){for(var n in t)null==e[n]&&(e[n]=t[n])}),e},T.clone=function(e){return T.isObject(e)?T.isArray(e)?e.slice():T.extend({},e):e},T.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof T&&(e=e._wrapped),t instanceof T&&(t=t._wrapped);var i=l.call(e);if(i!=l.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=n.length;s--;)if(n[s]==e)return r[s]==t;n.push(e),r.push(t);var o=0,u=!0;if("[object Array]"==i){if(u=(o=e.length)==t.length)for(;o--&&(u=M(e[o],t[o],n,r)););}else{var a=e.constructor,f=t.constructor;if(a!==f&&!(T.isFunction(a)&&a instanceof a&&T.isFunction(f)&&f instanceof f))return!1;for(var c in e)if(T.has(e,c)&&(o++,!(u=T.has(t,c)&&M(e[c],t[c],n,r))))break;if(u){for(c in t)if(T.has(t,c)&&!o--)break;u=!o}}return n.pop(),r.pop(),u};T.isEqual=function(e,t){return M(e,t,[],[])},T.isEmpty=function(e){if(null==e)return!0;if(T.isArray(e)||T.isString(e))return 0===e.length;for(var t in e)if(T.has(e,t))return!1;return!0},T.isElement=function(e){return!!e&&1===e.nodeType},T.isArray=E||function(e){return"[object Array]"==l.call(e)},T.isObject=function(e){return e===Object(e)},N(["Arguments","Function","String","Number","Date","RegExp"],function(e){T["is"+e]=function(t){return l.call(t)=="[object "+e+"]"}}),T.isArguments(arguments)||(T.isArguments=function(e){return!!e&&!!T.has(e,"callee")}),"function"!=typeof/./&&(T.isFunction=function(e){return"function"==typeof e}),T.isFinite=function(e){return T.isNumber(e)&&isFinite(e)},T.isNaN=function(e){return T.isNumber(e)&&e!=+e},T.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==l.call(e)},T.isNull=function(e){return null===e},T.isUndefined=function(e){return void 0===e},T.has=function(e,t){return c.call(e,t)},T.noConflict=function(){return e._=t,this},T.identity=function(e){return e},T.times=function(e,t,n){for(var r=0;r<e;r++)t.call(n,r)},T.random=function(e,t){return null==t&&(t=e,e=0),e+(0|Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};_.unescape=T.invert(_.escape);var D={escape:new RegExp("["+T.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+T.keys(_.unescape).join("|")+")","g")};T.each(["escape","unescape"],function(e){T[e]=function(t){return null==t?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),T.result=function(e,t){if(null==e)return null;var n=e[t];return T.isFunction(n)?n.call(e):n},T.mixin=function(e){N(T.functions(e),function(t){var n=T[t]=e[t];T.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(T,e))}})};var P=0;T.uniqueId=function(e){var t=P++;return e?e+t:t},T.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;T.template=function(e,t,n){n=T.defaults({},n,T.templateSettings);var r=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(r,function(t,n,r,o,u){s+=e.slice(i,u).replace(j,function(e){return"\\"+B[e]}),s+=n?"'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?"'+\n((__t=("+r+"))==null?'':__t)+\n'":o?"';\n"+o+"\n__p+='":"",i=u+t.length}),s+="';\n",n.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(n.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(t)return o(t,T);var a=function(e){return o.call(this,e,T)};return a.source="function("+(n.variable||"obj")+"){\n"+s+"}",a},T.chain=function(e){return T(e).chain()};var F=function(e){return this._chain?T(e).chain():e};T.mixin(T),N(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];T.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),("shift"==e||"splice"==e)&&0===n.length&&delete n[0],F.call(this,n)}}),N(["concat","join","slice"],function(e){var t=r[e];T.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),T.extend(T.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),function(undefined){var moment,oldGlobalMoment,i,globalScope="undefined"==typeof global||"undefined"!=typeof window&&window!==global.window?this:global,round=Math.round,hasOwnProperty=Object.prototype.hasOwnProperty,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,locales={},momentProperties=[],hasModule="undefined"!=typeof module&&module&&module.exports,aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenOffsetMs=/[\+\-]?\d+/,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,unitMillisecondFactors=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},relativeTimeThresholds={s:45,m:45,h:22,d:26,M:11},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.localeData().monthsShort(this,format)},MMMM:function(format){return this.localeData().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.localeData().weekdaysMin(this,format)},ddd:function(format){return this.localeData().weekdaysShort(this,format)},dddd:function(format){return this.localeData().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year();return(y>=0?"+":"-")+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.localeData().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=this.utcOffset(),b="+";return a<0&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=this.utcOffset(),b="+";return a<0&&(a=-a,b="-"),b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},x:function(){return this.valueOf()},X:function(){return this.unix()},Q:function(){return this.quarter()}},deprecations={},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"],updateInProgress=!1;function dfl(a,b,c){switch(arguments.length){case 2:return null!=a?a:b;case 3:return null!=a?a:null!=b?b:c;default:throw new Error("Implement me")}}function hasOwnProp(a,b){return hasOwnProperty.call(a,b)}function printMsg(msg){!1===moment.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+msg)}function deprecate(msg,fn){var firstTime=!0;return extend(function(){return firstTime&&(printMsg(msg),firstTime=!1),fn.apply(this,arguments)},fn)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.localeData().ordinal(func.call(this,a),period)}}for(;ordinalizeTokens.length;)i=ordinalizeTokens.pop(),formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i);for(;paddedTokens.length;)i=paddedTokens.pop(),formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2);function Locale(){}function Moment(config,skipOverflow){!1!==skipOverflow&&checkOverflow(config),copyConfig(this,config),this._d=new Date(+config._d),!1===updateInProgress&&(updateInProgress=!0,moment.updateOffset(this),updateInProgress=!1)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+1e3*seconds+6e4*minutes+36e5*hours,this._days=+days+7*weeks,this._months=+months+3*quarters+12*years,this._data={},this._locale=moment.localeData(),this._bubble()}function extend(a,b){for(var i in b)hasOwnProp(b,i)&&(a[i]=b[i]);return hasOwnProp(b,"toString")&&(a.toString=b.toString),hasOwnProp(b,"valueOf")&&(a.valueOf=b.valueOf),a}function copyConfig(to,from){var i,prop,val;if(void 0!==from._isAMomentObject&&(to._isAMomentObject=from._isAMomentObject),void 0!==from._i&&(to._i=from._i),void 0!==from._f&&(to._f=from._f),void 0!==from._l&&(to._l=from._l),void 0!==from._strict&&(to._strict=from._strict),void 0!==from._tzm&&(to._tzm=from._tzm),void 0!==from._isUTC&&(to._isUTC=from._isUTC),void 0!==from._offset&&(to._offset=from._offset),void 0!==from._pf&&(to._pf=from._pf),void 0!==from._locale&&(to._locale=from._locale),momentProperties.length>0)for(i in momentProperties)void 0!==(val=from[prop=momentProperties[i]])&&(to[prop]=val);return to}function absRound(number){return number<0?Math.ceil(number):Math.floor(number)}function leftZeroFill(number,targetLength,forceSign){for(var output=""+Math.abs(number),sign=number>=0;output.length<targetLength;)output="0"+output;return(sign?forceSign?"+":"":"-")+output}function positiveMomentsDifference(base,other){var res={milliseconds:0,months:0};return res.months=other.month()-base.month()+12*(other.year()-base.year()),base.clone().add(res.months,"M").isAfter(other)&&--res.months,res.milliseconds=+other-+base.clone().add(res.months,"M"),res}function createAdder(direction,name){return function(val,period){var tmp;return null===period||isNaN(+period)||(!function(name,msg){deprecations[name]||(printMsg(msg),deprecations[name]=!0)}(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period)."),tmp=val,val=period,period=tmp),val="string"==typeof val?+val:val,addOrSubtractDurationFromMoment(this,moment.duration(val,period),direction),this}}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=null==updateOffset||updateOffset,milliseconds&&mom._d.setTime(+mom._d+milliseconds*isAdding),days&&rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding),months&&rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding),updateOffset&&moment.updateOffset(mom,days||months)}function isArray(input){return"[object Array]"===Object.prototype.toString.call(input)}function isDate(input){return"[object Date]"===Object.prototype.toString.call(input)||input instanceof Date}function compareArrays(array1,array2,dontConvert){var i,len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0;for(i=0;i<len;i++)(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i]))&&diffs++;return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedProp,prop,normalizedInput={};for(prop in inputObject)hasOwnProp(inputObject,prop)&&(normalizedProp=normalizeUnits(prop))&&(normalizedInput[normalizedProp]=inputObject[prop]);return normalizedInput}function makeList(field){var count,setter;if(0===field.indexOf("week"))count=7,setter="day";else{if(0!==field.indexOf("month"))return;count=12,setter="month"}moment[field]=function(format,index){var i,getter,method=moment._locale[field],results=[];if("number"==typeof format&&(index=format,format=undefined),getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment._locale,m,format||"")},null!=index)return getter(index);for(i=0;i<count;i++)results.push(getter(i));return results}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;return 0!==coercedNumber&&isFinite(coercedNumber)&&(value=coercedNumber>=0?Math.floor(coercedNumber):Math.ceil(coercedNumber)),value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return year%4==0&&year%100!=0||year%400==0}function checkOverflow(m){var overflow;m._a&&-2===m._pf.overflow&&(overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>24||24===m._a[HOUR]&&(0!==m._a[MINUTE]||0!==m._a[SECOND]||0!==m._a[MILLISECOND])?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1,m._pf._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)&&(overflow=DATE),m._pf.overflow=overflow)}function isValid(m){return null==m._isValid&&(m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated,m._strict&&(m._isValid=m._isValid&&0===m._pf.charsLeftOver&&0===m._pf.unusedTokens.length&&m._pf.bigHour===undefined)),m._isValid}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function loadLocale(name){var oldLocale=null;if(!locales[name]&&hasModule)try{oldLocale=moment.locale(),require("./locale/"+name),moment.locale(oldLocale)}catch(e){}return locales[name]}function makeAs(input,model){var res,diff;return model._isUTC?(res=model.clone(),diff=(moment.isMoment(input)||isDate(input)?+input:+moment(input))-+res,res._d.setTime(+res._d+diff),moment.updateOffset(res,!1),res):moment(input).local()}function formatMoment(m,format){return m.isValid()?(format=expandFormat(format,m.localeData()),formatFunctions[format]||(formatFunctions[format]=function(format){var i,length,input,array=format.match(formattingTokens);for(i=0,length=array.length;i<length;i++)formatTokenFunctions[array[i]]?array[i]=formatTokenFunctions[array[i]]:array[i]=(input=array[i]).match(/\[[\s\S]/)?input.replace(/^\[|\]$/g,""):input.replace(/\\/g,"");return function(mom){var output="";for(i=0;i<length;i++)output+=array[i]instanceof Function?array[i].call(mom,format):array[i];return output}}(format)),formatFunctions[format](m)):m.localeData().invalidDate()}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}for(localFormattingTokens.lastIndex=0;i>=0&&localFormattingTokens.test(format);)format=format.replace(localFormattingTokens,replaceLongDateFormatTokens),localFormattingTokens.lastIndex=0,i-=1;return format}function getParseRegexForToken(token,config){var strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict)return parseTokenOneDigit;case"SS":if(strict)return parseTokenTwoDigits;case"SSS":if(strict)return parseTokenThreeDigits;case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return config._locale._meridiemParse;case"x":return parseTokenOffsetMs;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return strict?config._locale._ordinalParse:config._locale._ordinalParseLenient;default:return new RegExp(function(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}(token.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})))}}function utcOffsetFromString(string){var possibleTzMatches=(string=string||"").match(parseTokenTimezone)||[],parts=((possibleTzMatches[possibleTzMatches.length-1]||[])+"").match(parseTimezoneChunker)||["-",0,0],minutes=60*parts[1]+toInt(parts[2]);return"+"===parts[0]?minutes:-minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":null!=input&&(datePartArray[MONTH]=3*(toInt(input)-1));break;case"M":case"MM":null!=input&&(datePartArray[MONTH]=toInt(input)-1);break;case"MMM":case"MMMM":null!=(a=config._locale.monthsParse(input,token,config._strict))?datePartArray[MONTH]=a:config._pf.invalidMonth=input;break;case"D":case"DD":null!=input&&(datePartArray[DATE]=toInt(input));break;case"Do":null!=input&&(datePartArray[DATE]=toInt(parseInt(input.match(/\d{1,2}/)[0],10)));break;case"DDD":case"DDDD":null!=input&&(config._dayOfYear=toInt(input));break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._meridiem=input;break;case"h":case"hh":config._pf.bigHour=!0;case"H":case"HH":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(1e3*("0."+input));break;case"x":config._d=new Date(toInt(input));break;case"X":config._d=new Date(1e3*parseFloat(input));break;case"Z":case"ZZ":config._useUTC=!0,config._tzm=utcOffsetFromString(input);break;case"dd":case"ddd":case"dddd":null!=(a=config._locale.weekdaysParse(input))?(config._w=config._w||{},config._w.d=a):config._pf.invalidWeekday=input;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":token=token.substr(0,1);case"gggg":case"GGGG":case"GGGGG":token=token.substr(0,2),input&&(config._w=config._w||{},config._w[token]=toInt(input));break;case"gg":case"GG":config._w=config._w||{},config._w[token]=moment.parseTwoDigitYear(input)}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp;null!=(w=config._w).GG||null!=w.W||null!=w.E?(dow=1,doy=4,weekYear=dfl(w.GG,config._a[YEAR],weekOfYear(moment(),1,4).year),week=dfl(w.W,1),weekday=dfl(w.E,1)):(dow=config._locale._week.dow,doy=config._locale._week.doy,weekYear=dfl(w.gg,config._a[YEAR],weekOfYear(moment(),dow,doy).year),week=dfl(w.w,1),null!=w.d?(weekday=w.d)<dow&&++week:weekday=null!=w.e?w.e+dow:dow),temp=function(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var dayOfYear,d=makeUTCDate(year,0,1).getUTCDay();return d=0===d?7:d,{year:(dayOfYear=7*(week-1)+((weekday=null!=weekday?weekday:firstDayOfWeek)-firstDayOfWeek)+(firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(d<firstDayOfWeek?7:0))+1)>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}(weekYear,week,weekday,doy,dow),config._a[YEAR]=temp.year,config._dayOfYear=temp.dayOfYear}function dateFromConfig(config){var i,date,currentDate,yearToUse,input=[];if(!config._d){for(currentDate=function(config){var now=new Date;return config._useUTC?[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]:[now.getFullYear(),now.getMonth(),now.getDate()]}(config),config._w&&null==config._a[DATE]&&null==config._a[MONTH]&&dayOfYearFromWeekInfo(config),config._dayOfYear&&(yearToUse=dfl(config._a[YEAR],currentDate[YEAR]),config._dayOfYear>daysInYear(yearToUse)&&(config._pf._overflowDayOfYear=!0),date=makeUTCDate(yearToUse,0,config._dayOfYear),config._a[MONTH]=date.getUTCMonth(),config._a[DATE]=date.getUTCDate()),i=0;i<3&&null==config._a[i];++i)config._a[i]=input[i]=currentDate[i];for(;i<7;i++)config._a[i]=input[i]=null==config._a[i]?2===i?1:0:config._a[i];24===config._a[HOUR]&&0===config._a[MINUTE]&&0===config._a[SECOND]&&0===config._a[MILLISECOND]&&(config._nextDay=!0,config._a[HOUR]=0),config._d=(config._useUTC?makeUTCDate:function(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);y<1970&&date.setFullYear(y);return date}).apply(null,input),null!=config._tzm&&config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm),config._nextDay&&(config._a[HOUR]=24)}}function makeDateFromStringAndFormat(config){if(config._f!==moment.ISO_8601){config._a=[],config._pf.empty=!0;var i,parsedInput,tokens,token,skipped,locale,hour,meridiem,isPm,string=""+config._i,stringLength=string.length,totalParsedInputLength=0;for(tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[],i=0;i<tokens.length;i++)token=tokens[i],(parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0])&&((skipped=string.substr(0,string.indexOf(parsedInput))).length>0&&config._pf.unusedInput.push(skipped),string=string.slice(string.indexOf(parsedInput)+parsedInput.length),totalParsedInputLength+=parsedInput.length),formatTokenFunctions[token]?(parsedInput?config._pf.empty=!1:config._pf.unusedTokens.push(token),addTimeToArrayFromToken(token,parsedInput,config)):config._strict&&!parsedInput&&config._pf.unusedTokens.push(token);config._pf.charsLeftOver=stringLength-totalParsedInputLength,string.length>0&&config._pf.unusedInput.push(string),!0===config._pf.bigHour&&config._a[HOUR]<=12&&(config._pf.bigHour=undefined),config._a[HOUR]=(locale=config._locale,hour=config._a[HOUR],null==(meridiem=config._meridiem)?hour:null!=locale.meridiemHour?locale.meridiemHour(hour,meridiem):null!=locale.isPM?((isPm=locale.isPM(meridiem))&&hour<12&&(hour+=12),isPm||12!==hour||(hour=0),hour):hour),dateFromConfig(config),checkOverflow(config)}else parseISO(config)}function parseISO(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){for(config._pf.iso=!0,i=0,l=isoDates.length;i<l;i++)if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}for(i=0,l=isoTimes.length;i<l;i++)if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}string.match(parseTokenTimezone)&&(config._f+="Z"),makeDateFromStringAndFormat(config)}else config._isValid=!1}function makeDateFromInput(config){var matched,input=config._i;input===undefined?config._d=new Date:isDate(input)?config._d=new Date(+input):null!==(matched=aspNetJsonRegex.exec(input))?config._d=new Date(+matched[1]):"string"==typeof input?function(config){parseISO(config),!1===config._isValid&&(delete config._isValid,moment.createFromInputFallback(config))}(config):isArray(input)?(config._a=function(arr,fn){var i,res=[];for(i=0;i<arr.length;++i)res.push(fn(arr[i],i));return res}(input.slice(0),function(obj){return parseInt(obj,10)}),dateFromConfig(config)):"object"==typeof input?function(config){var normalizedInput;config._d||(normalizedInput=normalizeObjectUnits(config._i),config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day||normalizedInput.date,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond],dateFromConfig(config))}(config):"number"==typeof input?config._d=new Date(input):moment.createFromInputFallback(config)}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));return y<1970&&date.setUTCFullYear(y),date}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var adjustedMoment,end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day();return daysToDayOfWeek>end&&(daysToDayOfWeek-=7),daysToDayOfWeek<end-7&&(daysToDayOfWeek+=7),adjustedMoment=moment(mom).add(daysToDayOfWeek,"d"),{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function makeMoment(config){var res,input=config._i,format=config._f;return config._locale=config._locale||moment.localeData(config._l),null===input||format===undefined&&""===input?moment.invalid({nullInput:!0}):("string"==typeof input&&(config._i=input=config._locale.preparse(input)),moment.isMoment(input)?new Moment(input,!0):(format?isArray(format)?function(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(0===config._f.length)return config._pf.invalidFormat=!0,void(config._d=new Date(NaN));for(i=0;i<config._f.length;i++)currentScore=0,tempConfig=copyConfig({},config),null!=config._useUTC&&(tempConfig._useUTC=config._useUTC),tempConfig._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1},tempConfig._f=config._f[i],makeDateFromStringAndFormat(tempConfig),isValid(tempConfig)&&(currentScore+=tempConfig._pf.charsLeftOver,currentScore+=10*tempConfig._pf.unusedTokens.length,tempConfig._pf.score=currentScore,(null==scoreToBeat||currentScore<scoreToBeat)&&(scoreToBeat=currentScore,bestMoment=tempConfig));extend(config,bestMoment||tempConfig)}(config):makeDateFromStringAndFormat(config):makeDateFromInput(config),(res=new Moment(config))._nextDay&&(res.add(1,"d"),res._nextDay=undefined),res))}function pickBy(fn,moments){var res,i;if(1===moments.length&&isArray(moments[0])&&(moments=moments[0]),!moments.length)return moment();for(res=moments[0],i=1;i<moments.length;++i)moments[i][fn](res)&&(res=moments[i]);return res}for(formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3),extend(Locale.prototype,{set:function(config){var prop,i;for(i in config)"function"==typeof(prop=config[i])?this[i]=prop:this["_"+i]=prop;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName,format,strict){var i,mom,regex;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(mom=moment.utc([2e3,i]),strict&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")),strict||this._monthsParse[i]||(regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,""),this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")),strict&&"MMMM"===format&&this._longMonthsParse[i].test(monthName))return i;if(strict&&"MMM"===format&&this._shortMonthsParse[i].test(monthName))return i;if(!strict&&this._monthsParse[i].test(monthName))return i}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;for(this._weekdaysParse||(this._weekdaysParse=[]),i=0;i<7;i++)if(this._weekdaysParse[i]||(mom=moment([2e3,1]).day(i),regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,""),this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")),this._weekdaysParse[i].test(weekdayName))return i},_longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM D, YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];return!output&&this._longDateFormat[key.toUpperCase()]&&(output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)}),this._longDateFormat[key]=output),output},isPM:function(input){return"p"===(input+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){return hours>11?isLower?"pm":"PM":isLower?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom,now){var output=this._calendar[key];return"function"==typeof output?output.apply(mom,[now]):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return"function"==typeof output?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return"function"==typeof format?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",_ordinalParse:/\d{1,2}/,preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},firstDayOfWeek:function(){return this._week.dow},firstDayOfYear:function(){return this._week.doy},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),(moment=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),(c={})._isAMomentObject=!0,c._i=input,c._f=format,c._l=locale,c._strict=strict,c._isUTC=!1,c._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1},makeMoment(c)}).suppressDeprecationWarnings=!1,moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))}),moment.min=function(){return pickBy("isBefore",[].slice.call(arguments,0))},moment.max=function(){return pickBy("isAfter",[].slice.call(arguments,0))},moment.utc=function(input,format,locale,strict){var c;return"boolean"==typeof locale&&(strict=locale,locale=undefined),(c={})._isAMomentObject=!0,c._useUTC=!0,c._isUTC=!0,c._l=locale,c._i=input,c._f=format,c._strict=strict,c._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1},makeMoment(c).utc()},moment.unix=function(input){return moment(1e3*input)},moment.duration=function(input,key){var sign,ret,parseIso,diffRes,base,other,res,duration=input,match=null;return moment.isDuration(input)?duration={ms:input._milliseconds,d:input._days,M:input._months}:"number"==typeof input?(duration={},key?duration[key]=input:duration.milliseconds=input):(match=aspNetTimeSpanJsonRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}):(match=isoDurationRegex.exec(input))?(sign="-"===match[1]?-1:1,duration={y:(parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign})(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}):null==duration?duration={}:"object"==typeof duration&&("from"in duration||"to"in duration)&&(base=moment(duration.from),other=makeAs(other=moment(duration.to),base),base.isBefore(other)?res=positiveMomentsDifference(base,other):((res=positiveMomentsDifference(other,base)).milliseconds=-res.milliseconds,res.months=-res.months),(duration={}).ms=(diffRes=res).milliseconds,duration.M=diffRes.months),ret=new Duration(duration),moment.isDuration(input)&&hasOwnProp(input,"_locale")&&(ret._locale=input._locale),ret},moment.version="2.9.0",moment.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",moment.ISO_8601=function(){},moment.momentProperties=momentProperties,moment.updateOffset=function(){},moment.relativeTimeThreshold=function(threshold,limit){return relativeTimeThresholds[threshold]!==undefined&&(limit===undefined?relativeTimeThresholds[threshold]:(relativeTimeThresholds[threshold]=limit,!0))},moment.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",function(key,value){return moment.locale(key,value)}),moment.locale=function(key,values){var data;return key&&(data=void 0!==values?moment.defineLocale(key,values):moment.localeData(key))&&(moment.duration._locale=moment._locale=data),moment._locale._abbr},moment.defineLocale=function(name,values){return null!==values?(values.abbr=name,locales[name]||(locales[name]=new Locale),locales[name].set(values),moment.locale(name),locales[name]):(delete locales[name],null)},moment.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",function(key){return moment.localeData(key)}),moment.localeData=function(key){var locale;if(key&&key._locale&&key._locale._abbr&&(key=key._locale._abbr),!key)return moment._locale;if(!isArray(key)){if(locale=loadLocale(key))return locale;key=[key]}return function(names){for(var j,next,locale,split,i=0;i<names.length;){for(j=(split=normalizeLocale(names[i]).split("-")).length,next=(next=normalizeLocale(names[i+1]))?next.split("-"):null;j>0;){if(locale=loadLocale(split.slice(0,j).join("-")))return locale;if(next&&next.length>=j&&compareArrays(split,next,!0)>=j-1)break;j--}i++}return null}(key)},moment.isMoment=function(obj){return obj instanceof Moment||null!=obj&&hasOwnProp(obj,"_isAMomentObject")},moment.isDuration=function(obj){return obj instanceof Duration},i=lists.length-1;i>=0;--i)makeList(lists[i]);function rawMonthSetter(mom,value){var dayOfMonth;return"string"==typeof value&&"number"!=typeof(value=mom.localeData().monthsParse(value))?mom:(dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value)),mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth),mom)}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){return"Month"===unit?rawMonthSetter(mom,value):mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}function makeAccessor(unit,keepTime){return function(value){return null!=value?(rawSetter(this,unit,value),moment.updateOffset(this,keepTime),this):rawGetter(this,unit)}}function daysToYears(days){return 400*days/146097}function yearsToDays(years){return 146097*years/400}function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}for(i in moment.normalizeUnits=function(units){return normalizeUnits(units)},moment.invalid=function(flags){var m=moment.utc(NaN);return null!=flags?extend(m._pf,flags):m._pf.userInvalidated=!0,m},moment.parseZone=function(){return moment.apply(null,arguments).parseZone()},moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)},moment.isDate=isDate,extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return+this._d-6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();return 0<m.year()&&m.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){return!!this._a&&(this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0)},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(keepLocalTime){return this.utcOffset(0,keepLocalTime)},local:function(keepLocalTime){return this._isUTC&&(this.utcOffset(0,keepLocalTime),this._isUTC=!1,keepLocalTime&&this.subtract(this._dateUtcOffset(),"m")),this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.localeData().postformat(output)},add:createAdder(1,"add"),subtract:createAdder(-1,"subtract"),diff:function(input,units,asFloat){var diff,output,that=makeAs(input,this),zoneDiff=6e4*(that.utcOffset()-this.utcOffset());return"year"===(units=normalizeUnits(units))||"month"===units||"quarter"===units?(output=function(a,b){var wholeMonthDiff=12*(b.year()-a.year())+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months");return-(wholeMonthDiff+(b-anchor<0?(b-anchor)/(anchor-a.clone().add(wholeMonthDiff-1,"months")):(b-anchor)/(a.clone().add(wholeMonthDiff+1,"months")-anchor)))}(this,that),"quarter"===units?output/=3:"year"===units&&(output/=12)):(diff=this-that,output="second"===units?diff/1e3:"minute"===units?diff/6e4:"hour"===units?diff/36e5:"day"===units?(diff-zoneDiff)/864e5:"week"===units?(diff-zoneDiff)/6048e5:diff),asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(time){var now=time||moment(),sod=makeAs(now,this).startOf("day"),diff=this.diff(sod,"days",!0),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";return this.format(this.localeData().calendar(format,this,moment(now)))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=input?(input=function(input,locale){if("string"==typeof input)if(isNaN(input)){if("number"!=typeof(input=locale.weekdaysParse(input)))return null}else input=parseInt(input,10);return input}(input,this.localeData()),this.add(input-day,"d")):day},month:makeAccessor("Month",!0),startOf:function(units){switch(units=normalizeUnits(units)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===units?this.weekday(0):"isoWeek"===units&&this.isoWeekday(1),"quarter"===units&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(units){return(units=normalizeUnits(units))===undefined||"millisecond"===units?this:this.startOf(units).add(1,"isoWeek"===units?"week":units).subtract(1,"ms")},isAfter:function(input,units){return"millisecond"===(units=normalizeUnits(void 0!==units?units:"millisecond"))?+this>+(input=moment.isMoment(input)?input:moment(input)):(moment.isMoment(input)?+input:+moment(input))<+this.clone().startOf(units)},isBefore:function(input,units){var inputMs;return"millisecond"===(units=normalizeUnits(void 0!==units?units:"millisecond"))?+this<+(input=moment.isMoment(input)?input:moment(input)):(inputMs=moment.isMoment(input)?+input:+moment(input),+this.clone().endOf(units)<inputMs)},isBetween:function(from,to,units){return this.isAfter(from,units)&&this.isBefore(to,units)},isSame:function(input,units){var inputMs;return"millisecond"===(units=normalizeUnits(units||"millisecond"))?+this==+(input=moment.isMoment(input)?input:moment(input)):(inputMs=+moment(input),+this.clone().startOf(units)<=inputMs&&inputMs<=+this.clone().endOf(units))},min:deprecate("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(other){return(other=moment.apply(null,arguments))<this?this:other}),max:deprecate("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(other){return(other=moment.apply(null,arguments))>this?this:other}),zone:deprecate("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",function(input,keepLocalTime){return null!=input?("string"!=typeof input&&(input=-input),this.utcOffset(input,keepLocalTime),this):-this.utcOffset()}),utcOffset:function(input,keepLocalTime){var localAdjust,offset=this._offset||0;return null!=input?("string"==typeof input&&(input=utcOffsetFromString(input)),Math.abs(input)<16&&(input*=60),!this._isUTC&&keepLocalTime&&(localAdjust=this._dateUtcOffset()),this._offset=input,this._isUTC=!0,null!=localAdjust&&this.add(localAdjust,"m"),offset!==input&&(!keepLocalTime||this._changeInProgress?addOrSubtractDurationFromMoment(this,moment.duration(input-offset,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,moment.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?offset:this._dateUtcOffset()},isLocal:function(){return!this._isUTC},isUtcOffset:function(){return this._isUTC},isUtc:function(){return this._isUTC&&0===this._offset},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(utcOffsetFromString(this._i)),this},hasAlignedHourOffset:function(input){return input=input?moment(input).utcOffset():0,(this.utcOffset()-input)%60==0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/864e5)+1;return null==input?dayOfYear:this.add(input-dayOfYear,"d")},quarter:function(input){return null==input?Math.ceil((this.month()+1)/3):this.month(3*(input-1)+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==input?year:this.add(input-year,"y")},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return null==input?year:this.add(input-year,"y")},week:function(input){var week=this.localeData().week(this);return null==input?week:this.add(7*(input-week),"d")},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return null==input?week:this.add(7*(input-week),"d")},weekday:function(input){var weekday=(this.day()+7-this.localeData()._week.dow)%7;return null==input?weekday:this.add(input-weekday,"d")},isoWeekday:function(input){return null==input?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){return this[units=normalizeUnits(units)]()},set:function(units,value){var unit;if("object"==typeof units)for(unit in units)this.set(unit,units[unit]);else"function"==typeof this[units=normalizeUnits(units)]&&this[units](value);return this},locale:function(key){var newLocaleData;return key===undefined?this._locale._abbr:(null!=(newLocaleData=moment.localeData(key))&&(this._locale=newLocaleData),this)},lang:deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){return key===undefined?this.localeData():this.locale(key)}),localeData:function(){return this._locale},_dateUtcOffset:function(){return 15*-Math.round(this._d.getTimezoneOffset()/15)}}),moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",!1),moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",!1),moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",!1),moment.fn.hour=moment.fn.hours=makeAccessor("Hours",!0),moment.fn.date=makeAccessor("Date",!0),moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",!0)),moment.fn.year=makeAccessor("FullYear",!0),moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",!0)),moment.fn.days=moment.fn.day,moment.fn.months=moment.fn.month,moment.fn.weeks=moment.fn.week,moment.fn.isoWeeks=moment.fn.isoWeek,moment.fn.quarters=moment.fn.quarter,moment.fn.toJSON=moment.fn.toISOString,moment.fn.isUTC=moment.fn.isUtc,extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var seconds,minutes,hours,milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,years=0;data.milliseconds=milliseconds%1e3,seconds=absRound(milliseconds/1e3),data.seconds=seconds%60,minutes=absRound(seconds/60),data.minutes=minutes%60,hours=absRound(minutes/60),data.hours=hours%24,days+=absRound(hours/24),months+=absRound((days-=absRound(yearsToDays(years=absRound(daysToYears(days)))))/30),days%=30,years+=absRound(months/12),months%=12,data.days=days,data.months=months,data.years=years},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*toInt(this._months/12)},humanize:function(withSuffix){var posNegDuration,withoutSuffix,locale,duration,seconds,minutes,hours,days,months,years,args,output=(posNegDuration=this,withoutSuffix=!withSuffix,locale=this.localeData(),duration=moment.duration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),years=round(duration.as("y")),(args=seconds<relativeTimeThresholds.s&&["s",seconds]||1===minutes&&["m"]||minutes<relativeTimeThresholds.m&&["mm",minutes]||1===hours&&["h"]||hours<relativeTimeThresholds.h&&["hh",hours]||1===days&&["d"]||days<relativeTimeThresholds.d&&["dd",days]||1===months&&["M"]||months<relativeTimeThresholds.M&&["MM",months]||1===years&&["y"]||["yy",years])[2]=withoutSuffix,args[3]=+posNegDuration>0,args[4]=locale,function(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}.apply({},args));return withSuffix&&(output=this.localeData().pastFuture(+this,output)),this.localeData().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);return this._milliseconds+=dur._milliseconds,this._days+=dur._days,this._months+=dur._months,this._bubble(),this},subtract:function(input,val){var dur=moment.duration(input,val);return this._milliseconds-=dur._milliseconds,this._days-=dur._days,this._months-=dur._months,this._bubble(),this},get:function(units){return this[(units=normalizeUnits(units)).toLowerCase()+"s"]()},as:function(units){var days,months;if("month"===(units=normalizeUnits(units))||"year"===units)return days=this._days+this._milliseconds/864e5,months=this._months+12*daysToYears(days),"month"===units?months:months/12;switch(days=this._days+Math.round(yearsToDays(this._months/12)),units){case"week":return days/7+this._milliseconds/6048e5;case"day":return days+this._milliseconds/864e5;case"hour":return 24*days+this._milliseconds/36e5;case"minute":return 24*days*60+this._milliseconds/6e4;case"second":return 24*days*60*60+this._milliseconds/1e3;case"millisecond":return Math.floor(24*days*60*60*1e3)+this._milliseconds;default:throw new Error("Unknown unit "+units)}},lang:moment.fn.lang,locale:moment.fn.locale,toIsoString:deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",function(){return this.toISOString()}),toISOString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":""):"P0D"},localeData:function(){return this._locale},toJSON:function(){return this.toISOString()}}),moment.duration.fn.toString=moment.duration.fn.toISOString,unitMillisecondFactors)hasOwnProp(unitMillisecondFactors,i)&&makeDurationGetter(i.toLowerCase());function makeGlobal(shouldDeprecate){"undefined"==typeof ender&&(oldGlobalMoment=globalScope.moment,globalScope.moment=shouldDeprecate?deprecate("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",moment):moment)}moment.duration.fn.asMilliseconds=function(){return this.as("ms")},moment.duration.fn.asSeconds=function(){return this.as("s")},moment.duration.fn.asMinutes=function(){return this.as("m")},moment.duration.fn.asHours=function(){return this.as("h")},moment.duration.fn.asDays=function(){return this.as("d")},moment.duration.fn.asWeeks=function(){return this.as("weeks")},moment.duration.fn.asMonths=function(){return this.as("M")},moment.duration.fn.asYears=function(){return this.as("y")},moment.locale("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10;return number+(1===toInt(number%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th")}}),hasModule?module.exports=moment:"function"==typeof define&&define.amd?(define(function(require,exports,module){return module.config&&module.config()&&!0===module.config().noGlobal&&(globalScope.moment=oldGlobalMoment),moment}),makeGlobal(!0)):makeGlobal()}.call(this),function(a,b,c){"use strict";var d=function(b,c){this.widget="",this.$element=a(b),this.defaultTime=c.defaultTime,this.disableFocus=c.disableFocus,this.disableMousewheel=c.disableMousewheel,this.isOpen=c.isOpen,this.minuteStep=c.minuteStep,this.modalBackdrop=c.modalBackdrop,this.orientation=c.orientation,this.secondStep=c.secondStep,this.snapToStep=c.snapToStep,this.showInputs=c.showInputs,this.showMeridian=c.showMeridian,this.showSeconds=c.showSeconds,this.template=c.template,this.appendWidgetTo=c.appendWidgetTo,this.showWidgetOnAddonClick=c.showWidgetOnAddonClick,this.icons=c.icons,this.maxHours=c.maxHours,this.explicitMode=c.explicitMode,this.handleDocumentClick=function(a){var b=a.data.scope;b.$element.parent().find(a.target).length||b.$widget.is(a.target)||b.$widget.find(a.target).length||b.hideWidget()},this._init()};d.prototype={constructor:d,_init:function(){var b=this;this.showWidgetOnAddonClick&&this.$element.parent().hasClass("input-group")&&this.$element.parent().hasClass("bootstrap-timepicker")?(this.$element.parent(".input-group.bootstrap-timepicker").find(".input-group-addon").on({"click.timepicker":a.proxy(this.showWidget,this)}),this.$element.on({"focus.timepicker":a.proxy(this.highlightUnit,this),"click.timepicker":a.proxy(this.highlightUnit,this),"keydown.timepicker":a.proxy(this.elementKeydown,this),"blur.timepicker":a.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":a.proxy(this.mousewheel,this)})):this.template?this.$element.on({"focus.timepicker":a.proxy(this.showWidget,this),"click.timepicker":a.proxy(this.showWidget,this),"blur.timepicker":a.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":a.proxy(this.mousewheel,this)}):this.$element.on({"focus.timepicker":a.proxy(this.highlightUnit,this),"click.timepicker":a.proxy(this.highlightUnit,this),"keydown.timepicker":a.proxy(this.elementKeydown,this),"blur.timepicker":a.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":a.proxy(this.mousewheel,this)}),!1!==this.template?this.$widget=a(this.getTemplate()).on("click",a.proxy(this.widgetClick,this)):this.$widget=!1,this.showInputs&&!1!==this.$widget&&this.$widget.find("input").each(function(){a(this).on({"click.timepicker":function(){a(this).select()},"keydown.timepicker":a.proxy(b.widgetKeydown,b),"keyup.timepicker":a.proxy(b.widgetKeyup,b)})}),this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=null,this.updateFromElementVal()},clear:function(){this.hour="",this.minute="",this.second="",this.meridian="",this.$element.val("")},decrementHour:function(){if(this.showMeridian)if(1===this.hour)this.hour=12;else{if(12===this.hour)return this.hour--,this.toggleMeridian();if(0===this.hour)return this.hour=11,this.toggleMeridian();this.hour--}else this.hour<=0?this.hour=this.maxHours-1:this.hour--},decrementMinute:function(a){var b;0>(b=a?this.minute-a:this.minute-this.minuteStep)?(this.decrementHour(),this.minute=b+60):this.minute=b},decrementSecond:function(){var a=this.second-this.secondStep;0>a?(this.decrementMinute(!0),this.second=a+60):this.second=a},elementKeydown:function(a){switch(a.which){case 9:if(a.shiftKey){if("hour"===this.highlightedUnit){this.hideWidget();break}this.highlightPrevUnit()}else{if(this.showMeridian&&"meridian"===this.highlightedUnit||this.showSeconds&&"second"===this.highlightedUnit||!this.showMeridian&&!this.showSeconds&&"minute"===this.highlightedUnit){this.hideWidget();break}this.highlightNextUnit()}a.preventDefault(),this.updateFromElementVal();break;case 27:this.updateFromElementVal();break;case 37:a.preventDefault(),this.highlightPrevUnit(),this.updateFromElementVal();break;case 38:switch(a.preventDefault(),this.highlightedUnit){case"hour":this.incrementHour(),this.highlightHour();break;case"minute":this.incrementMinute(),this.highlightMinute();break;case"second":this.incrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}this.update();break;case 39:a.preventDefault(),this.highlightNextUnit(),this.updateFromElementVal();break;case 40:switch(a.preventDefault(),this.highlightedUnit){case"hour":this.decrementHour(),this.highlightHour();break;case"minute":this.decrementMinute(),this.highlightMinute();break;case"second":this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian()}this.update()}},getCursorPosition:function(){var a=this.$element.get(0);if("selectionStart"in a)return a.selectionStart;if(c.selection){a.focus();var b=c.selection.createRange(),d=c.selection.createRange().text.length;return b.moveStart("character",-a.value.length),b.text.length-d}},getTemplate:function(){var a,b,c,d,e,f;switch(this.showInputs?(b='<input type="text" class="bootstrap-timepicker-hour" maxlength="2"/>',c='<input type="text" class="bootstrap-timepicker-minute" maxlength="2"/>',d='<input type="text" class="bootstrap-timepicker-second" maxlength="2"/>',e='<input type="text" class="bootstrap-timepicker-meridian" maxlength="2"/>'):(b='<span class="bootstrap-timepicker-hour"></span>',c='<span class="bootstrap-timepicker-minute"></span>',d='<span class="bootstrap-timepicker-second"></span>',e='<span class="bootstrap-timepicker-meridian"></span>'),f='<table><tr><td><a href="#" data-action="incrementHour"><span class="'+this.icons.up+'"></span></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><span class="'+this.icons.up+'"></span></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><span class="'+this.icons.up+'"></span></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><span class="'+this.icons.up+'"></span></a></td>':"")+"</tr><tr><td>"+b+'</td> <td class="separator">:</td><td>'+c+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+d+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+e+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><span class="'+this.icons.down+'"></span></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><span class="'+this.icons.down+'"></span></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><span class="'+this.icons.down+'"></span></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><span class="'+this.icons.down+'"></span></a></td>':"")+"</tr></table>",this.template){case"modal":a='<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">&times;</a><h3>Pick a Time</h3></div><div class="modal-content">'+f+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case"dropdown":a='<div class="bootstrap-timepicker-widget dropdown-menu">'+f+"</div>"}return a},getTime:function(){return""===this.hour?"":this.hour+":"+(1===this.minute.toString().length?"0"+this.minute:this.minute)+(this.showSeconds?":"+(1===this.second.toString().length?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},hideWidget:function(){!1!==this.isOpen&&(this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),"modal"===this.template&&this.$widget.modal?this.$widget.modal("hide"):this.$widget.removeClass("open"),a(c).off("mousedown.timepicker, touchend.timepicker",this.handleDocumentClick),this.isOpen=!1,this.$widget.detach())},highlightUnit:function(){this.position=this.getCursorPosition(),this.position>=0&&this.position<=2?this.highlightHour():this.position>=3&&this.position<=5?this.highlightMinute():this.position>=6&&this.position<=8?this.showSeconds?this.highlightSecond():this.highlightMeridian():this.position>=9&&this.position<=11&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":this.showSeconds?this.highlightSecond():this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"second":this.showMeridian?this.highlightMeridian():this.highlightHour();break;case"meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.showMeridian?this.highlightMeridian():this.showSeconds?this.highlightSecond():this.highlightMinute();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour:function(){var a=this.$element.get(0),b=this;this.highlightedUnit="hour",a.setSelectionRange&&setTimeout(function(){b.hour<10?a.setSelectionRange(0,1):a.setSelectionRange(0,2)},0)},highlightMinute:function(){var a=this.$element.get(0),b=this;this.highlightedUnit="minute",a.setSelectionRange&&setTimeout(function(){b.hour<10?a.setSelectionRange(2,4):a.setSelectionRange(3,5)},0)},highlightSecond:function(){var a=this.$element.get(0),b=this;this.highlightedUnit="second",a.setSelectionRange&&setTimeout(function(){b.hour<10?a.setSelectionRange(5,7):a.setSelectionRange(6,8)},0)},highlightMeridian:function(){var a=this.$element.get(0),b=this;this.highlightedUnit="meridian",a.setSelectionRange&&(this.showSeconds?setTimeout(function(){b.hour<10?a.setSelectionRange(8,10):a.setSelectionRange(9,11)},0):setTimeout(function(){b.hour<10?a.setSelectionRange(5,7):a.setSelectionRange(6,8)},0))},incrementHour:function(){if(this.showMeridian){if(11===this.hour)return this.hour++,this.toggleMeridian();12===this.hour&&(this.hour=0)}return this.hour===this.maxHours-1?void(this.hour=0):void this.hour++},incrementMinute:function(a){var b;(b=a?this.minute+a:this.minute+this.minuteStep-this.minute%this.minuteStep)>59?(this.incrementHour(),this.minute=b-60):this.minute=b},incrementSecond:function(){var a=this.second+this.secondStep-this.second%this.secondStep;a>59?(this.incrementMinute(!0),this.second=a-60):this.second=a},mousewheel:function(b){if(!this.disableMousewheel){b.preventDefault(),b.stopPropagation();var c=b.originalEvent.wheelDelta||-b.originalEvent.detail,d=null;switch("mousewheel"===b.type?d=-1*b.originalEvent.wheelDelta:"DOMMouseScroll"===b.type&&(d=40*b.originalEvent.detail),d&&(b.preventDefault(),a(this).scrollTop(d+a(this).scrollTop())),this.highlightedUnit){case"minute":c>0?this.incrementMinute():this.decrementMinute(),this.highlightMinute();break;case"second":c>0?this.incrementSecond():this.decrementSecond(),this.highlightSecond();break;case"meridian":this.toggleMeridian(),this.highlightMeridian();break;default:c>0?this.incrementHour():this.decrementHour(),this.highlightHour()}return!1}},changeToNearestStep:function(a,b){return a%b==0?a:Math.round(a%b/b)?(a+(b-a%b))%60:a-a%b},place:function(){if(!this.isInline){var c=this.$widget.outerWidth(),d=this.$widget.outerHeight(),f=a(b).width(),g=a(b).height(),h=a(b).scrollTop(),i=parseInt(this.$element.parents().filter(function(){return"auto"!==a(this).css("z-index")}).first().css("z-index"),10)+10,j=this.component?this.component.parent().offset():this.$element.offset(),k=this.component?this.component.outerHeight(!0):this.$element.outerHeight(!1),l=this.component?this.component.outerWidth(!0):this.$element.outerWidth(!1),m=j.left,n=j.top;this.$widget.removeClass("timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left"),"auto"!==this.orientation.x?(this.$widget.addClass("timepicker-orient-"+this.orientation.x),"right"===this.orientation.x&&(m-=c-l)):(this.$widget.addClass("timepicker-orient-left"),j.left<0?m-=j.left-10:j.left+c>f&&(m=f-c-10));var o,p,q=this.orientation.y;"auto"===q&&(o=-h+j.top-d,p=h+g-(j.top+k+d),q=Math.max(o,p)===p?"top":"bottom"),this.$widget.addClass("timepicker-orient-"+q),"top"===q?n+=k:n-=d+parseInt(this.$widget.css("padding-top"),10),this.$widget.css({top:n,left:m,zIndex:i})}},remove:function(){a("document").off(".timepicker"),this.$widget&&this.$widget.remove(),delete this.$element.data().timepicker},setDefaultTime:function(a){if(this.$element.val())this.updateFromElementVal();else if("current"===a){var b=new Date,c=b.getHours(),d=b.getMinutes(),e=b.getSeconds(),f="AM";0!==e&&(60===(e=Math.ceil(b.getSeconds()/this.secondStep)*this.secondStep)&&(d+=1,e=0)),0!==d&&(60===(d=Math.ceil(b.getMinutes()/this.minuteStep)*this.minuteStep)&&(c+=1,d=0)),this.showMeridian&&(0===c?c=12:c>=12?(c>12&&(c-=12),f="PM"):f="AM"),this.hour=c,this.minute=d,this.second=e,this.meridian=f,this.update()}else!1===a?(this.hour=0,this.minute=0,this.second=0,this.meridian="AM"):this.setTime(a)},setTime:function(a,b){if(a){var c,d,e,f,g,h;if("object"==typeof a&&a.getMonth)e=a.getHours(),f=a.getMinutes(),g=a.getSeconds(),this.showMeridian&&(h="AM",e>12&&(h="PM",e%=12),12===e&&(h="PM"));else{if((c=(/a/i.test(a)?1:0)+(/p/i.test(a)?2:0))>2)return void this.clear();if(e=(d=a.replace(/[^0-9\:]/g,"").split(":"))[0]?d[0].toString():d.toString(),this.explicitMode&&e.length>2&&e.length%2!=0)return void this.clear();f=d[1]?d[1].toString():"",g=d[2]?d[2].toString():"",e.length>4&&(g=e.slice(-2),e=e.slice(0,-2)),e.length>2&&(f=e.slice(-2),e=e.slice(0,-2)),f.length>2&&(g=f.slice(-2),f=f.slice(0,-2)),e=parseInt(e,10),f=parseInt(f,10),g=parseInt(g,10),isNaN(e)&&(e=0),isNaN(f)&&(f=0),isNaN(g)&&(g=0),g>59&&(g=59),f>59&&(f=59),e>=this.maxHours&&(e=this.maxHours-1),this.showMeridian?(e>12&&(c=2,e-=12),c||(c=1),0===e&&(e=12),h=1===c?"AM":"PM"):12>e&&2===c?e+=12:e>=this.maxHours?e=this.maxHours-1:(0>e||12===e&&1===c)&&(e=0)}this.hour=e,this.snapToStep?(this.minute=this.changeToNearestStep(f,this.minuteStep),this.second=this.changeToNearestStep(g,this.secondStep)):(this.minute=f,this.second=g),this.meridian=h,this.update(b)}else this.clear()},showWidget:function(){this.isOpen||this.$element.is(":disabled")||(this.$widget.appendTo(this.appendWidgetTo),a(c).on("mousedown.timepicker, touchend.timepicker",{scope:this},this.handleDocumentClick),this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}}),this.place(),this.disableFocus&&this.$element.blur(),""===this.hour&&(this.defaultTime?this.setDefaultTime(this.defaultTime):this.setTime("0:0:0")),"modal"===this.template&&this.$widget.modal?this.$widget.modal("show").on("hidden",a.proxy(this.hideWidget,this)):!1===this.isOpen&&this.$widget.addClass("open"),this.isOpen=!0)},toggleMeridian:function(){this.meridian="AM"===this.meridian?"PM":"AM"},update:function(a){this.updateElement(),a||this.updateWidget(),this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){this.setTime(this.$element.val())},updateWidget:function(){if(!1!==this.$widget){var a=this.hour,b=1===this.minute.toString().length?"0"+this.minute:this.minute,c=1===this.second.toString().length?"0"+this.second:this.second;this.showInputs?(this.$widget.find("input.bootstrap-timepicker-hour").val(a),this.$widget.find("input.bootstrap-timepicker-minute").val(b),this.showSeconds&&this.$widget.find("input.bootstrap-timepicker-second").val(c),this.showMeridian&&this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)):(this.$widget.find("span.bootstrap-timepicker-hour").text(a),this.$widget.find("span.bootstrap-timepicker-minute").text(b),this.showSeconds&&this.$widget.find("span.bootstrap-timepicker-second").text(c),this.showMeridian&&this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian))}},updateFromWidgetInputs:function(){if(!1!==this.$widget){var a=this.$widget.find("input.bootstrap-timepicker-hour").val()+":"+this.$widget.find("input.bootstrap-timepicker-minute").val()+(this.showSeconds?":"+this.$widget.find("input.bootstrap-timepicker-second").val():"")+(this.showMeridian?this.$widget.find("input.bootstrap-timepicker-meridian").val():"");this.setTime(a,!0)}},widgetClick:function(b){b.stopPropagation(),b.preventDefault();var c=a(b.target),d=c.closest("a").data("action");d&&this[d](),this.update(),c.is("input")&&c.get(0).setSelectionRange(0,2)},widgetKeydown:function(b){var c=a(b.target),d=c.attr("class").replace("bootstrap-timepicker-","");switch(b.which){case 9:if(b.shiftKey){if("hour"===d)return this.hideWidget()}else if(this.showMeridian&&"meridian"===d||this.showSeconds&&"second"===d||!this.showMeridian&&!this.showSeconds&&"minute"===d)return this.hideWidget();break;case 27:this.hideWidget();break;case 38:switch(b.preventDefault(),d){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian()}this.setTime(this.getTime()),c.get(0).setSelectionRange(0,2);break;case 40:switch(b.preventDefault(),d){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian()}this.setTime(this.getTime()),c.get(0).setSelectionRange(0,2)}},widgetKeyup:function(a){(65===a.which||77===a.which||80===a.which||46===a.which||8===a.which||a.which>=48&&a.which<=57||a.which>=96&&a.which<=105)&&this.updateFromWidgetInputs()}},a.fn.timepicker=function(b){var c=Array.apply(null,arguments);return c.shift(),this.each(function(){var e=a(this),f=e.data("timepicker"),g="object"==typeof b&&b;f||e.data("timepicker",f=new d(this,a.extend({},a.fn.timepicker.defaults,g,a(this).data()))),"string"==typeof b&&f[b].apply(f,c)})},a.fn.timepicker.defaults={defaultTime:"current",disableFocus:!1,disableMousewheel:!1,isOpen:!1,minuteStep:15,modalBackdrop:!1,orientation:{x:"auto",y:"auto"},secondStep:15,snapToStep:!1,showSeconds:!1,showInputs:!0,showMeridian:!0,template:"dropdown",appendWidgetTo:"body",showWidgetOnAddonClick:!0,icons:{up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down"},maxHours:24,explicitMode:!1},a.fn.timepicker.Constructor=d,a(c).on("focus.timepicker.data-api click.timepicker.data-api",'[data-provide="timepicker"]',function(b){var c=a(this);c.data("timepicker")||(b.preventDefault(),c.timepicker())})}(jQuery,window,document),function($){$.widget("mjs.nestedSortable",$.extend({},$.ui.sortable.prototype,{options:{tabSize:20,disableNesting:"mjs-nestedSortable-no-nesting",errorClass:"mjs-nestedSortable-error",doNotClear:!1,listType:"ol",maxLevels:0,protectRoot:!1,rootID:null,rtl:!1,isAllowed:function(item,parent){return!0}},_create:function(){if(this.element.data("sortable",this.element.data("nestedSortable")),!this.element.is(this.options.listType))throw new Error("nestedSortable: Please check the listType option is set to your actual list type");return $.ui.sortable.prototype._create.apply(this,arguments)},destroy:function(){return this.element.removeData("nestedSortable").unbind(".nestedSortable"),$.ui.sortable.prototype.destroy.apply(this,arguments)},_mouseDrag:function(event){this.position=this._generatePosition(event),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);var o=this.options;if(this.options.scroll){var scrolled=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-event.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed:event.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-event.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed:event.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(event.pageY-$(document).scrollTop()<o.scrollSensitivity?scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed):$(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity&&(scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)),event.pageX-$(document).scrollLeft()<o.scrollSensitivity?scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed):$(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity&&(scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed))),!1!==scrolled&&$.ui.ddmanager&&!o.dropBehaviour&&$.ui.ddmanager.prepareOffsets(this,event)}this.positionAbs=this._convertPositionTo("absolute");var previousTopOffset=this.placeholder.offset().top;this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px");for(var i=this.items.length-1;i>=0;i--){var item=this.items[i],itemElement=item.item[0],intersection=this._intersectsWithPointer(item);if(intersection&&!(itemElement==this.currentItem[0]||this.placeholder[1==intersection?"next":"prev"]()[0]==itemElement||$.contains(this.placeholder[0],itemElement)||"semi-dynamic"==this.options.type&&$.contains(this.element[0],itemElement))){if($(itemElement).mouseenter(),this.direction=1==intersection?"down":"up","pointer"!=this.options.tolerance&&!this._intersectsWithSides(item))break;$(itemElement).mouseleave(),this._rearrange(event,item),this._clearEmpty(itemElement),this._trigger("change",event,this._uiHash());break}}var parentItem=this.placeholder[0].parentNode.parentNode&&$(this.placeholder[0].parentNode.parentNode).closest(".ui-sortable").length?$(this.placeholder[0].parentNode.parentNode):null,level=this._getLevel(this.placeholder),childLevels=this._getChildLevels(this.helper),previousItem=this.placeholder[0].previousSibling?$(this.placeholder[0].previousSibling):null;if(null!=previousItem)for(;"li"!=previousItem[0].nodeName.toLowerCase()||previousItem[0]==this.currentItem[0]||previousItem[0]==this.helper[0];){if(!previousItem[0].previousSibling){previousItem=null;break}previousItem=$(previousItem[0].previousSibling)}var nextItem=this.placeholder[0].nextSibling?$(this.placeholder[0].nextSibling):null;if(null!=nextItem)for(;"li"!=nextItem[0].nodeName.toLowerCase()||nextItem[0]==this.currentItem[0]||nextItem[0]==this.helper[0];){if(!nextItem[0].nextSibling){nextItem=null;break}nextItem=$(nextItem[0].nextSibling)}var newList=document.createElement(o.listType);return this.beyondMaxLevels=0,null!=parentItem&&null==nextItem&&(o.rtl&&this.positionAbs.left+this.helper.outerWidth()>parentItem.offset().left+parentItem.outerWidth()||!o.rtl&&this.positionAbs.left<parentItem.offset().left)?(parentItem.after(this.placeholder[0]),this._clearEmpty(parentItem[0]),this._trigger("change",event,this._uiHash())):null!=previousItem&&(o.rtl&&this.positionAbs.left+this.helper.outerWidth()<previousItem.offset().left+previousItem.outerWidth()-o.tabSize||!o.rtl&&this.positionAbs.left>previousItem.offset().left+o.tabSize)?(this._isAllowed(previousItem,level,level+childLevels+1),previousItem.children(o.listType).length||previousItem[0].appendChild(newList),previousTopOffset&&previousTopOffset<=previousItem.offset().top?previousItem.children(o.listType).prepend(this.placeholder):previousItem.children(o.listType)[0].appendChild(this.placeholder[0]),this._trigger("change",event,this._uiHash())):this._isAllowed(parentItem,level,level+childLevels),this._contactContainers(event),$.ui.ddmanager&&$.ui.ddmanager.drag(this,event),this._trigger("sort",event,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(event,noPropagation){this.beyondMaxLevels&&(this.placeholder.removeClass(this.options.errorClass),this.domPosition.prev?$(this.domPosition.prev).after(this.placeholder):$(this.domPosition.parent).prepend(this.placeholder),this._trigger("revert",event,this._uiHash()));for(var i=this.items.length-1;i>=0;i--){var item=this.items[i].item[0];this._clearEmpty(item)}$.ui.sortable.prototype._mouseStop.apply(this,arguments)},serialize:function(options){var o=$.extend({},this.options,options),items=this._getItemsAsjQuery(o&&o.connected),str=[];return $(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||/(.+)[-=_](.+)/),pid=($(o.item||this).parent(o.listType).parent(o.items).attr(o.attribute||"id")||"").match(o.expression||/(.+)[-=_](.+)/);res&&str.push((o.key||res[1])+"["+(o.key&&o.expression?res[1]:res[2])+"]="+(pid?o.key&&o.expression?pid[1]:pid[2]:o.rootID))}),!str.length&&o.key&&str.push(o.key+"="),str.join("&")},toHierarchy:function(options){var o=$.extend({},this.options,options),ret=(o.startDepthCount,[]);return $(this.element).children(o.items).each(function(){var level=function _recursiveItems(item){var id=($(item).attr(o.attribute||"id")||"").match(o.expression||/(.+)[-=_](.+)/);if(id){var currentItem={id:id[2]};return $(item).children(o.listType).children(o.items).length>0&&(currentItem.children=[],$(item).children(o.listType).children(o.items).each(function(){var level=_recursiveItems(this);currentItem.children.push(level)})),currentItem}}(this);ret.push(level)}),ret},toArray:function(options){var o=$.extend({},this.options,options),sDepth=o.startDepthCount||0,ret=[],left=2;return ret.push({item_id:o.rootID,parent_id:"none",depth:sDepth,left:"1",right:2*($(o.items,this.element).length+1)}),$(this.element).children(o.items).each(function(){left=function _recursiveArray(item,depth,left){var id,pid,right=left+1;$(item).children(o.listType).children(o.items).length>0&&(depth++,$(item).children(o.listType).children(o.items).each(function(){right=_recursiveArray($(this),depth,right)}),depth--);id=$(item).attr(o.attribute||"id").match(o.expression||/(.+)[-=_](.+)/);if(depth===sDepth+1)pid=o.rootID;else{var parentItem=$(item).parent(o.listType).parent(o.items).attr(o.attribute||"id").match(o.expression||/(.+)[-=_](.+)/);pid=parentItem[2]}id&&ret.push({item_id:id[2],parent_id:pid,depth:depth,left:left,right:right});left=right+1;return left}(this,sDepth+1,left)}),ret=ret.sort(function(a,b){return a.left-b.left})},_clearEmpty:function(item){var emptyList=$(item).children(this.options.listType);!emptyList.length||emptyList.children().length||this.options.doNotClear||emptyList.remove()},_getLevel:function(item){var level=1;if(this.options.listType)for(var list=item.closest(this.options.listType);list&&list.length>0&&!list.is(".ui-sortable");)level++,list=list.parent().closest(this.options.listType);return level},_getChildLevels:function(parent,depth){var self=this,o=this.options,result=0;return depth=depth||0,$(parent).children(o.listType).children(o.items).each(function(index,child){result=Math.max(self._getChildLevels(child,depth+1),result)}),depth?result+1:result},_isAllowed:function(parentItem,level,levels){var o=this.options,isRoot=!!$(this.domPosition.parent).hasClass("ui-sortable"),maxLevels=this.placeholder.closest(".ui-sortable").nestedSortable("option","maxLevels");!o.isAllowed(this.currentItem,parentItem)||parentItem&&parentItem.hasClass(o.disableNesting)||o.protectRoot&&(null==parentItem&&!isRoot||isRoot&&level>1)?(this.placeholder.addClass(o.errorClass),this.beyondMaxLevels=maxLevels<levels&&0!=maxLevels?levels-maxLevels:1):maxLevels<levels&&0!=maxLevels?(this.placeholder.addClass(o.errorClass),this.beyondMaxLevels=levels-maxLevels):(this.placeholder.removeClass(o.errorClass),this.beyondMaxLevels=0)}})),$.mjs.nestedSortable.prototype.options=$.extend({},$.ui.sortable.prototype.options,$.mjs.nestedSortable.prototype.options)}(jQuery),function(a){a.Jcrop=function(b,c){function i(a){return Math.round(a)+"px"}function j(a){return d.baseClass+"-"+a}function k(){return a.fx.step.hasOwnProperty("backgroundColor")}function l(b){var c=a(b).offset();return[c.left,c.top]}function m(a){return[a.pageX-e[0],a.pageY-e[1]]}function n(b){"object"!=typeof b&&(b={}),d=a.extend(d,b),a.each(["onChange","onSelect","onRelease","onDblClick"],function(a,b){"function"!=typeof d[b]&&(d[b]=function(){})})}function o(a,b,c){if(e=l(D),bc.setCursor("move"===a?a:a+"-resize"),"move"===a)return bc.activateHandlers(function(a){var b=a;return bd.watchKeys(),function(a){_.moveOffset([a[0]-b[0],a[1]-b[1]]),b=a,bb.update()}}(b),v,c);var d=_.getFixed(),f=r(a),g=_.getCorner(r(f));_.setPressed(_.getCorner(f)),_.setCurrent(g),bc.activateHandlers(p(a,d),v,c)}function p(a,b){return function(c){if(d.aspectRatio)switch(a){case"e":case"w":c[1]=b.y+1;break;case"n":c[0]=b.x+1;break;case"s":c[0]=b.x+1}else switch(a){case"e":case"w":c[1]=b.y2;break;case"n":c[0]=b.x2;break;case"s":c[0]=b.x2}_.setCurrent(c),bb.update()}}function r(a){switch(a){case"n":return"sw";case"s":case"e":return"nw";case"w":return"ne";case"ne":return"sw";case"nw":return"se";case"se":return"nw";case"sw":return"ne"}}function s(a){return function(b){return!d.disabled&&(!("move"===a&&!d.allowMove)&&(e=l(D),W=!0,o(a,m(b)),b.stopPropagation(),b.preventDefault(),!1))}}function t(a,b,c){var d=a.width(),e=a.height();d>b&&b>0&&(d=b,e=b/a.width()*a.height()),e>c&&c>0&&(e=c,d=c/a.height()*a.width()),T=a.width()/d,U=a.height()/e,a.width(d).height(e)}function u(a){return{x:a.x*T,y:a.y*U,x2:a.x2*T,y2:a.y2*U,w:a.w*T,h:a.h*U}}function v(a){var b=_.getFixed();b.w>d.minSelect[0]&&b.h>d.minSelect[1]?(bb.enableHandles(),bb.done()):bb.release(),bc.setCursor(d.allowSelect?"crosshair":"default")}function w(a){if(d.disabled)return!1;if(!d.allowSelect)return!1;W=!0,e=l(D),bb.disableHandles(),bc.setCursor("crosshair");var b=m(a);return _.setPressed(b),bb.update(),bc.activateHandlers(x,v,"touch"===a.type.substring(0,5)),bd.watchKeys(),a.stopPropagation(),a.preventDefault(),!1}function x(a){_.setCurrent(a),bb.update()}function y(){var b=a("<div></div>").addClass(j("tracker"));return g&&b.css({opacity:0,backgroundColor:"white"}),b}function bg(a){bh([a[0]/T,a[1]/U,a[2]/T,a[3]/U]),d.onSelect.call(bs,u(_.getFixed())),bb.enableHandles()}function bh(a){_.setPressed([a[0],a[1]]),_.setCurrent([a[2],a[3]]),bb.update()}function bl(){d.disabled=!0,bb.disableHandles(),bb.setCursor("default"),bc.setCursor("default")}function bm(){d.disabled=!1,br()}function bq(a,b,c){var e=b||d.bgColor;d.bgFade&&k()&&d.fadeTime&&!c?a.animate({backgroundColor:e},{queue:!1,duration:d.fadeTime}):a.css("backgroundColor",e)}function br(a){d.allowResize?a?bb.enableOnly():bb.enableHandles():bb.disableHandles(),bc.setCursor(d.allowSelect?"crosshair":"default"),bb.setCursor(d.allowMove?"move":"default"),d.hasOwnProperty("trueSize")&&(T=d.trueSize[0]/E,U=d.trueSize[1]/F),d.hasOwnProperty("setSelect")&&(bg(d.setSelect),bb.done(),delete d.setSelect),ba.refresh(),d.bgColor!=N&&(bq(d.shade?ba.getShades():G,d.shade&&d.shadeColor||d.bgColor),N=d.bgColor),O!=d.bgOpacity&&(O=d.bgOpacity,d.shade?ba.refresh():bb.setBgOpacity(O)),P=d.maxSize[0]||0,Q=d.maxSize[1]||0,R=d.minSize[0]||0,S=d.minSize[1]||0,d.hasOwnProperty("outerImage")&&(D.attr("src",d.outerImage),delete d.outerImage),bb.refresh()}var e,d=a.extend({},a.Jcrop.defaults),f=navigator.userAgent.toLowerCase(),g=/msie/.test(f),h=/msie [1-6]\./.test(f);"object"!=typeof b&&(b=a(b)[0]),"object"!=typeof c&&(c={}),n(c);var z={border:"none",visibility:"visible",margin:0,padding:0,position:"absolute",top:0,left:0},A=a(b),B=!0;if("IMG"==b.tagName){if(0!=A[0].width&&0!=A[0].height)A.width(A[0].width),A.height(A[0].height);else{var C=new Image;C.src=A[0].src,A.width(C.width),A.height(C.height)}var D=A.clone().removeAttr("id").css(z).show();D.width(A.width()),D.height(A.height()),A.after(D).hide()}else D=A.css(z).show(),B=!1,null===d.shade&&(d.shade=!0);t(D,d.boxWidth,d.boxHeight);var E=D.width(),F=D.height(),G=a("<div />").width(E).height(F).addClass(j("holder")).css({position:"relative",backgroundColor:d.bgColor}).insertAfter(A).append(D);d.addClass&&G.addClass(d.addClass);var H=a("<div />"),I=a("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),J=a("<div />").width("100%").height("100%").css("zIndex",320),K=a("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var a=_.getFixed();d.onDblClick.call(bs,a)}).insertBefore(D).append(I,J);B&&(H=a("<img />").attr("src",D.attr("src")).css(z).width(E).height(F),I.append(H)),h&&K.css({overflowY:"hidden"});var P,Q,R,S,T,U,W,X,L=d.boundary,M=y().width(E+2*L).height(F+2*L).css({position:"absolute",top:i(-L),left:i(-L),zIndex:290}).mousedown(w),N=d.bgColor,O=d.bgOpacity;e=l(D);var Z=function(){function a(){var d,a={},b=["touchstart","touchmove","touchend"],c=document.createElement("div");try{for(d=0;d<b.length;d++){var e=b[d],f=(e="on"+e)in c;f||(c.setAttribute(e,"return;"),f="function"==typeof c[e]),a[b[d]]=f}return a.touchstart&&a.touchend&&a.touchmove}catch(g){return!1}}return{createDragger:function(a){return function(b){return!d.disabled&&(!("move"===a&&!d.allowMove)&&(e=l(D),W=!0,o(a,m(Z.cfilter(b)),!0),b.stopPropagation(),b.preventDefault(),!1))}},newSelection:function(a){return w(Z.cfilter(a))},cfilter:function(a){return a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a},isSupported:a,support:!0===d.touchSupport||!1===d.touchSupport?d.touchSupport:a()}}(),_=function(){function m(){if(!d.aspectRatio)return function(){var g,d=c-a,f=e-b;return P&&Math.abs(d)>P&&(c=d>0?a+P:a-P),Q&&Math.abs(f)>Q&&(e=f>0?b+Q:b-Q),S/U&&Math.abs(f)<S/U&&(e=f>0?b+S/U:b-S/U),R/T&&Math.abs(d)<R/T&&(c=d>0?a+R/T:a-R/T),a<0&&(c-=a,a-=a),b<0&&(e-=b,b-=b),c<0&&(a-=c,c-=c),e<0&&(b-=e,e-=e),c>E&&(a-=g=c-E,c-=g),e>F&&(b-=g=e-F,e-=g),a>E&&(e-=g=a-F,b-=g),b>F&&(e-=g=b-F,b-=g),q(o(a,b,c,e))}();var r,s,t,u,f=d.aspectRatio,g=d.minSize[0]/T,h=d.maxSize[0]/T,i=d.maxSize[1]/U,j=c-a,k=e-b,l=Math.abs(j),m=Math.abs(k);return 0===h&&(h=10*E),0===i&&(i=10*F),l/m<f?(s=e,t=m*f,(r=j<0?a-t:t+a)<0?(r=0,u=Math.abs((r-a)/f),s=k<0?b-u:u+b):r>E&&(r=E,u=Math.abs((r-a)/f),s=k<0?b-u:u+b)):(r=c,u=l/f,(s=k<0?b-u:b+u)<0?(s=0,t=Math.abs((s-b)*f),r=j<0?a-t:t+a):s>F&&(s=F,t=Math.abs(s-b)*f,r=j<0?a-t:t+a)),r>a?(r-a<g?r=a+g:r-a>h&&(r=a+h),s=s>b?b+(r-a)/f:b-(r-a)/f):r<a&&(a-r<g?r=a-g:a-r>h&&(r=a-h),s=s>b?b+(a-r)/f:b-(a-r)/f),r<0?(a-=r,r=0):r>E&&(a-=r-E,r=E),s<0?(b-=s,s=0):s>F&&(b-=s-F,s=F),q(o(a,b,r,s))}function n(a){return a[0]<0&&(a[0]=0),a[1]<0&&(a[1]=0),a[0]>E&&(a[0]=E),a[1]>F&&(a[1]=F),[Math.round(a[0]),Math.round(a[1])]}function o(a,b,c,d){var e=a,f=c,g=b,h=d;return c<a&&(e=c,f=a),d<b&&(g=d,h=b),[e,g,f,h]}function q(a){return{x:a[0],y:a[1],x2:a[2],y2:a[3],w:a[2]-a[0],h:a[3]-a[1]}}var f,g,a=0,b=0,c=0,e=0;return{flipCoords:o,setPressed:function(d){d=n(d),c=a=d[0],e=b=d[1]},setCurrent:function(a){a=n(a),f=a[0]-c,g=a[1]-e,c=a[0],e=a[1]},getOffset:function(){return[f,g]},moveOffset:function(d){var f=d[0],g=d[1];0>a+f&&(f-=f+a),0>b+g&&(g-=g+b),F<e+g&&(g+=F-(e+g)),E<c+f&&(f+=E-(c+f)),a+=f,c+=f,b+=g,e+=g},getCorner:function(a){var b=m();switch(a){case"ne":return[b.x2,b.y];case"nw":return[b.x,b.y];case"se":return[b.x2,b.y2];case"sw":return[b.x,b.y2]}},getFixed:m}}(),ba=function(){function g(){return h(_.getFixed())}function h(a){e.top.css({left:i(a.x),width:i(a.w),height:i(a.y)}),e.bottom.css({top:i(a.y2),left:i(a.x),width:i(a.w),height:i(F-a.y2)}),e.right.css({left:i(a.x2),width:i(E-a.x2)}),e.left.css({width:i(a.x)})}function j(){return a("<div />").css({position:"absolute",backgroundColor:d.shadeColor||d.bgColor}).appendTo(c)}function k(){b||(b=!0,c.insertBefore(D),g(),bb.setBgOpacity(1,0,1),H.hide(),l(d.shadeColor||d.bgColor,1),bb.isAwake()?n(d.bgOpacity,1):n(1,1))}function l(a,b){bq(p(),a,b)}function m(){b&&(c.remove(),H.show(),b=!1,bb.isAwake()?bb.setBgOpacity(d.bgOpacity,1,1):(bb.setBgOpacity(1,1,1),bb.disableHandles()),bq(G,0,1))}function n(a,e){b&&(d.bgFade&&!e?c.animate({opacity:1-a},{queue:!1,duration:d.fadeTime}):c.css({opacity:1-a}))}function p(){return c.children()}var b=!1,c=a("<div />").css({position:"absolute",zIndex:240,opacity:0}),e={top:j(),left:j().height(F),right:j().height(F),bottom:j()};return{update:g,updateRaw:h,getShades:p,setBgColor:l,enable:k,disable:m,resize:function(a,b){e.left.css({height:i(b)}),e.right.css({height:i(b)})},refresh:function(){d.shade?k():m(),bb.isAwake()&&n(d.bgOpacity)},opacity:n}}(),bb=function(){function k(b){var c=a("<div />").css({position:"absolute",opacity:d.borderOpacity}).addClass(j(b));return I.append(c),c}function l(b,c){var d=a("<div />").mousedown(s(b)).css({cursor:b+"-resize",position:"absolute",zIndex:c}).addClass("ord-"+b);return Z.support&&d.bind("touchstart.jcrop",Z.createDragger(b)),J.append(d),d}function m(a){var b=d.handleSize,e=l(a,c++).css({opacity:d.handleOpacity}).addClass(j("handle"));return b&&e.width(b).height(b),e}function n(a){return l(a,c++).addClass("jcrop-dragbar")}function v(){var a=_.getFixed();_.setPressed([a.x,a.y]),_.setCurrent([a.x2,a.y2]),w()}function w(a){if(b)return x(a)}function x(a){var c=_.getFixed();(function(a,b){K.width(Math.round(a)).height(Math.round(b))})(c.w,c.h),function(a,b){d.shade||H.css({top:i(-b),left:i(-a)}),K.css({top:i(b),left:i(a)})}(c.x,c.y),d.shade&&ba.updateRaw(c),b||(K.show(),d.shade?ba.opacity(O):z(O,!0),b=!0),a?d.onSelect.call(bs,u(c)):d.onChange.call(bs,u(c))}function z(a,c,e){(b||c)&&(d.bgFade&&!e?D.animate({opacity:a},{queue:!1,duration:d.fadeTime}):D.css("opacity",a))}function E(){if(h=!0,d.allowResize)return J.show(),!0}function F(){h=!1,J.hide()}function G(a){a?(X=!0,F()):(X=!1,E())}var b,c=370,e={},f={},g={},h=!1;d.dragEdges&&a.isArray(d.createDragbars)&&function(a){var b;for(b=0;b<a.length;b++)g[a[b]]=n(a[b])}(d.createDragbars),a.isArray(d.createHandles)&&function(a){var b;for(b=0;b<a.length;b++)f[a[b]]=m(a[b])}(d.createHandles),d.drawBorders&&a.isArray(d.createBorders)&&function(a){var b,c;for(c=0;c<a.length;c++){switch(a[c]){case"n":b="hline";break;case"s":b="hline bottom";break;case"e":b="vline right";break;case"w":b="vline"}e[a[c]]=k(b)}}(d.createBorders),a(document).bind("touchstart.jcrop-ios",function(b){a(b.currentTarget).hasClass("jcrop-tracker")&&b.stopPropagation()});var M=y().mousedown(s("move")).css({cursor:"move",position:"absolute",zIndex:360});return Z.support&&M.bind("touchstart.jcrop",Z.createDragger("move")),I.append(M),F(),{updateVisible:w,update:x,release:function(){F(),K.hide(),d.shade?ba.opacity(1):z(1),b=!1,d.onRelease.call(bs)},refresh:v,isAwake:function(){return b},setCursor:function(a){M.css("cursor",a)},enableHandles:E,enableOnly:function(){h=!0},showHandles:function(){h&&J.show()},disableHandles:F,animMode:G,setBgOpacity:z,done:function(){G(!1),v()}}}(),bc=function(){function f(b){M.css({zIndex:450}),b?a(document).bind("touchmove.jcrop",k).bind("touchend.jcrop",l):e&&a(document).bind("mousemove.jcrop",h).bind("mouseup.jcrop",i)}function g(){M.css({zIndex:290}),a(document).unbind(".jcrop")}function h(a){return b(m(a)),!1}function i(a){return a.preventDefault(),a.stopPropagation(),W&&(W=!1,c(m(a)),bb.isAwake()&&d.onSelect.call(bs,u(_.getFixed())),g(),b=function(){},c=function(){}),!1}function k(a){return b(m(Z.cfilter(a))),!1}function l(a){return i(Z.cfilter(a))}var b=function(){},c=function(){},e=d.trackDocument;return e||M.mousemove(h).mouseup(i).mouseout(i),D.before(M),{activateHandlers:function(a,d,e){return W=!0,b=a,c=d,f(e),!1},setCursor:function(a){M.css("cursor",a)}}}(),bd=function(){function g(a,b,c){d.allowMove&&(_.moveOffset([b,c]),bb.updateVisible(!0)),a.preventDefault(),a.stopPropagation()}var b=a('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),c=a("<div />").css({position:"absolute",overflow:"hidden"}).append(b);return d.keySupport&&(b.keydown(function(a){if(a.ctrlKey||a.metaKey)return!0;var b=!!a.shiftKey?10:1;switch(a.keyCode){case 37:g(a,-b,0);break;case 39:g(a,b,0);break;case 38:g(a,0,-b);break;case 40:g(a,0,b);break;case 27:d.allowSelect&&bb.release();break;case 9:return!0}return!1}).blur(function(a){b.hide()}),h||!d.fixedSupport?(b.css({position:"absolute",left:"-20px"}),c.append(b).insertBefore(D)):b.insertBefore(D)),{watchKeys:function(){d.keySupport&&(b.show(),b.focus())}}}();Z.support&&M.bind("touchstart.jcrop",Z.newSelection),J.hide(),br(!0);var bs={setImage:function(a,b){bb.release(),bl();var c=new Image;c.onload=function(){var e=c.width,f=c.height,g=d.boxWidth,h=d.boxHeight;D.width(e).height(f),D.attr("src",a),H.attr("src",a),t(D,g,h),E=D.width(),F=D.height(),H.width(E).height(F),M.width(E+2*L).height(F+2*L),G.width(E).height(F),ba.resize(E,F),bm(),"function"==typeof b&&b.call(bs)},c.src=a},animateTo:function(a,b){function t(){window.setTimeout(u,l)}var c=a[0]/T,e=a[1]/U,f=a[2]/T,g=a[3]/U;if(!X){var h=_.flipCoords(c,e,f,g),i=_.getFixed(),j=[i.x,i.y,i.x2,i.y2],k=j,l=d.animationDelay,m=h[0]-j[0],n=h[1]-j[1],o=h[2]-j[2],p=h[3]-j[3],q=0,r=d.swingSpeed;c=k[0],e=k[1],f=k[2],g=k[3],bb.animMode(!0);var u=function(){q+=(100-q)/r,k[0]=Math.round(c+q/100*m),k[1]=Math.round(e+q/100*n),k[2]=Math.round(f+q/100*o),k[3]=Math.round(g+q/100*p),q>=99.8&&(q=100),q<100?(bh(k),t()):(bb.done(),bb.animMode(!1),"function"==typeof b&&b.call(bs))};t()}},setSelect:bg,setOptions:function(a){n(a),br()},tellSelect:function(){return u(_.getFixed())},tellScaled:function(){return _.getFixed()},setClass:function(a){G.removeClass().addClass(j("holder")).addClass(a)},disable:bl,enable:bm,cancel:function(){bb.done(),bc.activateHandlers(null,null)},release:bb.release,destroy:function(){G.remove(),A.show(),A.css("visibility","visible"),a(b).removeData("Jcrop")},focus:bd.watchKeys,getBounds:function(){return[E*T,F*U]},getWidgetSize:function(){return[E,F]},getScaleFactor:function(){return[T,U]},getOptions:function(){return d},ui:{holder:G,selection:K}};return g&&G.bind("selectstart",function(){return!1}),A.data("Jcrop",bs),bs},a.fn.Jcrop=function(b,c){var d;return this.each(function(){if(a(this).data("Jcrop")){if("api"===b)return a(this).data("Jcrop");a(this).data("Jcrop").setOptions(b)}else"IMG"==this.tagName?a.Jcrop.Loader(this,function(){a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d)}):(a(this).css({display:"block",visibility:"hidden"}),d=a.Jcrop(this,b),a.isFunction(c)&&c.call(d))}),this},a.Jcrop.Loader=function(b,c,d){var e=a(b),f=e[0];e.bind("load.jcloader",function g(){f.complete?(e.unbind(".jcloader"),a.isFunction(c)&&c.call(f)):window.setTimeout(g,50)}).bind("error.jcloader",function(b){e.unbind(".jcloader"),a.isFunction(d)&&d.call(f)}),f.complete&&a.isFunction(c)&&(e.unbind(".jcloader"),c.call(f))},a.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:["n","s","e","w","nw","ne","se","sw"],createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},onRelease:function(){}}}(jQuery),function(){void 0===Math.sgn&&(Math.sgn=function(a){return 0==a?0:a>0?1:-1});var a_subtract=function(a,b){return{x:a.x-b.x,y:a.y-b.y}},a_dotProduct=function(a,b){return a.x*b.x+a.y*b.y},a_square=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)},a_scale=function(a,b){return{x:a.x*b,y:a.y*b}},c=Math.pow(2,-65),d=function(b,c){for(var d=[],e=f(b,c),h=c.length-1,j=g(e,2*h-1,d,0),k=a_subtract(b,c[0]),m=a_square(k),n=0,o=0;j>o;o++){k=a_subtract(b,l(c,h,d[o],null,null));var p=a_square(k);m>p&&(m=p,n=d[o])}return k=a_subtract(b,c[h]),m>(p=a_square(k))&&(m=p,n=1),{location:n,distance:m}},f=function(b,c){for(var d=c.length-1,e=2*d-1,f=[],g=[],h=[],i=[],k=[[1,.6,.3,.1],[.4,.6,.6,.4],[.1,.3,.6,1]],l=0;d>=l;l++)f[l]=a_subtract(c[l],b);for(l=0;d-1>=l;l++)g[l]=a_subtract(c[l+1],c[l]),g[l]=a_scale(g[l],3);for(var m=0;d-1>=m;m++)for(var n=0;d>=n;n++)h[m]||(h[m]=[]),h[m][n]=a_dotProduct(g[m],f[n]);for(l=0;e>=l;l++)i[l]||(i[l]=[]),i[l].y=0,i[l].x=parseFloat(l)/e;for(var o=d,p=d-1,q=0;o+p>=q;q++){var r=Math.max(0,q-p),s=Math.min(q,o);for(l=r;s>=l;l++)j=q-l,i[l+j].y+=h[j][l]*k[j][l]}return i},g=function(a,c,d,e){var f,j,m=[],n=[],o=[],p=[];switch(h(a,c)){case 0:return 0;case 1:if(e>=64)return d[0]=(a[0].x+a[c].x)/2,1;if(i(a,c))return d[0]=k(a,c),1}l(a,c,.5,m,n),f=g(m,c,o,e+1),j=g(n,c,p,e+1);for(var q=0;f>q;q++)d[q]=o[q];for(q=0;j>q;q++)d[q+f]=p[q];return f+j},h=function(a,b){var c,d,e=0;c=d=Math.sgn(a[0].y);for(var f=1;b>=f;f++)(c=Math.sgn(a[f].y))!=d&&e++,d=c;return e},i=function(a,b){var e,f,g,h,i,j,k,q,r;i=a[0].y-a[b].y,j=a[b].x-a[0].x,k=a[0].x*a[b].y-a[b].x*a[0].y;for(var t=max_distance_below=0,u=1;b>u;u++){var v=i*a[u].x+j*a[u].y+k;v>t?t=v:max_distance_below>v&&(max_distance_below=v)}return 0,1,0,e=(1*(k-t)-0*(r=j))*(1/(0*r-1*(q=i))),q=i,r=j,f=(1*(k-max_distance_below)-0*r)*(1/(0*r-1*q)),g=Math.min(e,f),h=Math.max(e,f),c>h-g?1:0},k=function(a,b){var e=a[b].x-a[0].x,f=a[b].y-a[0].y,g=a[0].x-0;return 0+1*((e*(a[0].y-0)-f*g)*(1/(0*e-1*f)))},l=function(a,b,c,d,e){for(var f=[[]],g=0;b>=g;g++)f[0][g]=a[g];for(var h=1;b>=h;h++)for(g=0;b-h>=g;g++)f[h]||(f[h]=[]),f[h][g]||(f[h][g]={}),f[h][g].x=(1-c)*f[h-1][g].x+c*f[h-1][g+1].x,f[h][g].y=(1-c)*f[h-1][g].y+c*f[h-1][g+1].y;if(null!=d)for(g=0;b>=g;g++)d[g]=f[g][0];if(null!=e)for(g=0;b>=g;g++)e[g]=f[b-g][g];return f[b][0]},m={},o=function(a,b){for(var c=function(a){var b=m[a];if(!b){var e=function(a){return function(){return a}},f=function(){return function(a){return a}},g=function(){return function(a){return 1-a}},h=function(a){return function(b){for(var c=1,d=0;d<a.length;d++)c*=a[d](b);return c}};(b=[]).push(new function(){return function(b){return Math.pow(b,a)}});for(var i=1;a>i;i++){for(var j=[new e(a)],k=0;a-i>k;k++)j.push(new f);for(k=0;i>k;k++)j.push(new g);b.push(new h(j))}b.push(new function(){return function(b){return Math.pow(1-b,a)}}),m[a]=b}return b}(a.length-1),d=0,e=0,f=0;f<a.length;f++)d+=a[f].x*c[f](b),e+=a[f].y*c[f](b);return{x:d,y:e}},p=function(a,b){return Math.sqrt(Math.pow(a.x-b.x,2)+Math.pow(a.y-b.y,2))},q=function(a){return a[0].x==a[1].x&&a[0].y==a[1].y},r=function(a,b,c){if(q(a))return{point:a[0],location:b};for(var d=o(a,b),e=0,f=b,g=c>0?1:-1,h=null;e<Math.abs(c);)h=o(a,f+=.005*g),e+=p(h,d),d=h;return{point:h,location:f}},v=function(a,b){var c=o(a,b),d=o(a.slice(0,a.length-1),b),e=d.y-c.y,f=d.x-c.x;return 0==e?1/0:Math.atan(e/f)};this.jsBezier={distanceFromCurve:d,gradientAtPoint:v,gradientAtPointAlongCurveFrom:function(a,b,c){var d=r(a,b,c);return d.location>1&&(d.location=1),d.location<0&&(d.location=0),v(a,d.location)},nearestPointOnCurve:function(a,b){var c=d(a,b);return{point:l(b,b.length-1,c.location,null,null),location:c.location}},pointOnCurve:o,pointAlongCurveFrom:function(a,b,c){return r(a,b,c).point},perpendicularToCurveAt:function(a,b,c,d){var e=r(a,b,d=null==d?0:d),f=v(a,e.location),g=Math.atan(-1/f),h=c/2*Math.sin(g),i=c/2*Math.cos(g);return[{x:e.point.x+i,y:e.point.y+h},{x:e.point.x-i,y:e.point.y-h}]},locationAlongCurveFrom:function(a,b,c){return r(a,b,c).location},getLength:function(a){if(q(a))return 0;for(var b=o(a,0),c=0,d=0,f=null;1>d;)f=o(a,d+=.005),c+=p(f,b),b=f;return c}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var b=this.Biltong={},c=function(a){return"[object Array]"===Object.prototype.toString.call(a)},d=function(a,b,d){return d(a=c(a)?a:[a.x,a.y],b=c(b)?b:[b.x,b.y])},e=b.gradient=function(a,b){return d(a,b,function(a,b){return b[0]==a[0]?b[1]>a[1]?1/0:-1/0:b[1]==a[1]?b[0]>a[0]?0:-0:(b[1]-a[1])/(b[0]-a[0])})},f=(b.normal=function(a,b){return-1/e(a,b)},b.lineLength=function(a,b){return d(a,b,function(a,b){return Math.sqrt(Math.pow(b[1]-a[1],2)+Math.pow(b[0]-a[0],2))})},b.quadrant=function(a,b){return d(a,b,function(a,b){return b[0]>a[0]?b[1]>a[1]?2:1:b[0]==a[0]?b[1]>a[1]?2:1:b[1]>a[1]?3:4})}),g=(b.theta=function(a,b){return d(a,b,function(a,b){var c=e(a,b),d=Math.atan(c),g=f(a,b);return(4==g||3==g)&&(d+=Math.PI),0>d&&(d+=2*Math.PI),d})},b.intersects=function(a,b){var c=a.x,d=a.x+a.w,e=a.y,f=a.y+a.h,g=b.x,h=b.x+b.w,i=b.y,j=b.y+b.h;return g>=c&&d>=g&&i>=e&&f>=i||h>=c&&d>=h&&i>=e&&f>=i||g>=c&&d>=g&&j>=e&&f>=j||h>=c&&d>=g&&j>=e&&f>=j||c>=g&&h>=c&&e>=i&&j>=e||d>=g&&h>=d&&e>=i&&j>=e||c>=g&&h>=c&&f>=i&&j>=f||d>=g&&h>=c&&f>=i&&j>=f},b.encloses=function(a,b,c){var d=a.x,e=a.x+a.w,f=a.y,g=a.y+a.h,h=b.x,i=b.x+b.w,j=b.y,k=b.y+b.h,l=function(a,b,d,e){return c?b>=a&&d>=e:b>a&&d>e};return l(d,h,e,i)&&l(f,j,g,k)},[null,[1,-1],[1,1],[-1,1],[-1,-1]]),h=[null,[-1,-1],[-1,1],[1,1],[1,-1]];b.pointOnLine=function(a,b,c){var d=e(a,b),i=f(a,b),j=c>0?g[i]:h[i],k=Math.atan(d),l=Math.abs(c*Math.sin(k))*j[1],m=Math.abs(c*Math.cos(k))*j[0];return{x:a.x+m,y:a.y+l}},b.perpendicularLineTo=function(a,b,c){var d=e(a,b),f=Math.atan(-1/d),g=c/2*Math.sin(f),h=c/2*Math.cos(f);return[{x:b.x+h,y:b.y+g},{x:b.x-h,y:b.y-g}]}}.call("undefined"!=typeof window?window:this),function(){"use strict";var a=this,b_android=navigator.userAgent.toLowerCase().indexOf("android")>-1,c=function(a,b,c){for(var d=(c=c||a.parentNode).querySelectorAll(b),e=0;e<d.length;e++)if(d[e]===a)return!0;return!1},d=function(a){return"string"==typeof a||a.constructor===String?document.getElementById(a):a},e=function(a){return a.srcElement||a.target},f=function(a,b,c,d){if(d){if(void 0!==a.path)return{path:a.path,end:a.path.indexOf(c)};var e={path:[],end:-1},f=function(a){e.path.push(a),a===c?e.end=e.path.length-1:null!=a.parentNode&&f(a.parentNode)};return f(b),e}return{path:[b],end:1}},g=function(a,b){for(var c=0,d=a.length;d>c&&a[c]!=b;c++);c<a.length&&a.splice(c,1)},h=1,i=function(a,b,c){var d=h++;return a.__ta=a.__ta||{},a.__ta[b]=a.__ta[b]||{},a.__ta[b][d]=c,c.__tauid=d,d},k=function(a,b,d,g){if(null==a)return d;var h=a.split(","),i=function(g){i.__tauid=d.__tauid;var j=e(g),k=j,l=f(g,j,b,null!=a);if(-1!=l.end)for(var m=0;m<l.end;m++){k=l.path[m];for(var n=0;n<h.length;n++)c(k,h[n],b)&&d.apply(k,arguments)}};return l(d,g,i),i},l=function(a,b,c){a.__taExtra=a.__taExtra||[],a.__taExtra.push([b,c])},m=function(a,b,c,d){if(s&&u[b]){var e=k(d,a,c,u[b]);E(a,u[b],e,c)}"focus"===b&&null==a.getAttribute("tabindex")&&a.setAttribute("tabindex","1"),E(a,b,k(d,a,c,b),c)},n=function(a,b,c,d){if(null==a.__taSmartClicks){m(a,"mousedown",function(b){a.__tad=y(b)},d),m(a,"mouseup",function(b){a.__tau=y(b)},d),m(a,"click",function(b){if(a.__tad&&a.__tau&&a.__tad[0]===a.__tau[0]&&a.__tad[1]===a.__tau[1])for(var c=0;c<a.__taSmartClicks.length;c++)a.__taSmartClicks[c].apply(e(b),[b])},d),a.__taSmartClicks=[]}a.__taSmartClicks.push(c),c.__taUnstore=function(){g(a.__taSmartClicks,c)}},o={tap:{touches:1,taps:1},dbltap:{touches:1,taps:2},contextmenu:{touches:2,taps:1}},p=function(a,b){return function(d,h,i,j){if("contextmenu"==h&&t)m(d,h,i,j);else{if(null==d.__taTapHandler){var k=d.__taTapHandler={tap:[],dbltap:[],contextmenu:[],down:!1,taps:0,downSelectors:[]},p=function(){k.down=!1},q=function(){k.taps=0};m(d,"mousedown",function(g){for(var h=e(g),i=f(g,h,d,null!=j),l=!1,m=0;m<i.end;m++){if(l)return;h=i.path[m];for(var n=0;n<k.downSelectors.length;n++)if(null==k.downSelectors[n]||c(h,k.downSelectors[n],d)){k.down=!0,setTimeout(p,a),setTimeout(q,b),l=!0;break}}}),m(d,"mouseup",function(a){if(k.down){var b,g=e(a);k.taps++;var h=D(a);for(var i in o)if(o.hasOwnProperty(i)){var j=o[i];if(j.touches===h&&(1===j.taps||j.taps===k.taps))for(var l=0;l<k[i].length;l++){b=f(a,g,d,null!=k[i][l][1]);for(var m=0;m<b.end;m++)if(g=b.path[m],null==k[i][l][1]||c(g,k[i][l][1],d)){k[i][l][0].apply(g,[a]);break}}}}})}d.__taTapHandler.downSelectors.push(j),d.__taTapHandler[h].push([i,j]),i.__taUnstore=function(){g(d.__taTapHandler[h],i)}}}},q=function(a,b,c,d){for(var e in c.__tamee[a])c.__tamee[a].hasOwnProperty(e)&&c.__tamee[a][e].apply(d,[b])},r=function(){var a=[];return function(b,d,f,g){if(!b.__tamee){b.__tamee={over:!1,mouseenter:[],mouseexit:[]};var h=function(d){var f=e(d);(null==g&&f==b&&!b.__tamee.over||c(f,g,b)&&(null==f.__tamee||!f.__tamee.over))&&(q("mouseenter",d,b,f),f.__tamee=f.__tamee||{},f.__tamee.over=!0,a.push(f))},j=function(d){for(var f=e(d),g=0;g<a.length;g++)f!=a[g]||c(d.relatedTarget||d.toElement,"*",f)||(f.__tamee.over=!1,a.splice(g,1),q("mouseexit",d,b,f))};E(b,"mouseover",k(g,b,h,"mouseover"),h),E(b,"mouseout",k(g,b,j,"mouseout"),j)}f.__taUnstore=function(){delete b.__tamee[d][f.__tauid]},i(b,d,f),b.__tamee[d][f.__tauid]=f}},s="ontouchstart"in document.documentElement,t="onmousedown"in document.documentElement,u={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},v=function(){var a=-1;if("Microsoft Internet Explorer"==navigator.appName){var b=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(b)&&(a=parseFloat(RegExp.$1))}return a}(),w=v>-1&&9>v,x=function(a,b){if(null==a)return[0,0];var c=C(a),d=B(c,0);return[d[b+"X"],d[b+"Y"]]},y=function(a){return null==a?[0,0]:w?[a.clientX+document.documentElement.scrollLeft,a.clientY+document.documentElement.scrollTop]:x(a,"page")},B=function(a,b){return a.item?a.item(b):a[b]},C=function(a){return a.touches&&a.touches.length>0?a.touches:a.changedTouches&&a.changedTouches.length>0?a.changedTouches:a.targetTouches&&a.targetTouches.length>0?a.targetTouches:[a]},D=function(a){return C(a).length},E=function(a,b,c,d){if(i(a,b,c),d.__tauid=c.__tauid,a.addEventListener)a.addEventListener(b,c,!1);else if(a.attachEvent){var e=b+c.__tauid;a["e"+e]=c,a[e]=function(){a["e"+e]&&a["e"+e](window.event)},a.attachEvent("on"+b,a[e])}},F=function(a,b,c){null!=c&&G(a,function(){var e=d(this);if(function(a,b,c){if(a.__ta&&a.__ta[b]&&delete a.__ta[b][c.__tauid],c.__taExtra){for(var d=0;d<c.__taExtra.length;d++)F(a,c.__taExtra[d][0],c.__taExtra[d][1]);c.__taExtra.length=0}c.__taUnstore&&c.__taUnstore()}(e,b,c),null!=c.__tauid)if(e.removeEventListener)e.removeEventListener(b,c,!1),s&&u[b]&&e.removeEventListener(u[b],c,!1);else if(this.detachEvent){var f=b+c.__tauid;e[f]&&e.detachEvent("on"+b,e[f]),e[f]=null,e["e"+f]=null}c.__taTouchProxy&&F(a,c.__taTouchProxy[1],c.__taTouchProxy[0])})},G=function(a,b){if(null!=a){a="undefined"!=typeof Window&&"unknown"!=typeof a.top&&a==a.top?[a]:"string"!=typeof a&&null==a.tagName&&null!=a.length?a:"string"==typeof a?document.querySelectorAll(a):[a];for(var c=0;c<a.length;c++)b.apply(a[c])}};a.Mottle=function(a){var c=(a=a||{}).clickThreshold||250,e=a.dblClickThreshold||450,f=new r,g=new p(c,e),h=a.smartClicks,i=function(a,b,c,e){null!=c&&G(a,function(){var a=d(this);h&&"click"===b?n(a,0,c,e):"tap"===b||"dbltap"===b||"contextmenu"===b?g(a,b,c,e):"mouseenter"===b||"mouseexit"==b?f(a,b,c,e):m(a,b,c,e)})};this.remove=function(a){return G(a,function(){var a=d(this);if(a.__ta)for(var b in a.__ta)if(a.__ta.hasOwnProperty(b))for(var c in a.__ta[b])a.__ta[b].hasOwnProperty(c)&&F(a,b,a.__ta[b][c]);a.parentNode&&a.parentNode.removeChild(a)}),this},this.on=function(){var a=arguments[0],b=4==arguments.length?arguments[2]:null,c=arguments[1],d=arguments[arguments.length-1];return i(a,c,d,b),this},this.off=function(a,b,c){return F(a,b,c),this},this.trigger=function(a,c,e,f){var g=t&&("undefined"==typeof MouseEvent||null==e||e.constructor===MouseEvent),h=s&&!t&&u[c]?u[c]:c,i=!(s&&!t&&u[c]),j=y(e),k=function(a){return x(a,"screen")}(e),l=function(a){return x(a,"client")}(e);return G(a,function(){var a,m=d(this);e=e||{screenX:k[0],screenY:k[1],clientX:l[0],clientY:l[1]};var n=function(a){f&&(a.payload=f)},o={TouchEvent:function(a){var b=document.createTouch(window,m,0,j[0],j[1],k[0],k[1],l[0],l[1],0,0,0,0),c=document.createTouchList(b),d=document.createTouchList(b),e=document.createTouchList(b);a.initTouchEvent(h,!0,!0,window,null,k[0],k[1],l[0],l[1],!1,!1,!1,!1,c,d,e,1,0)},MouseEvents:function(a){if(a.initMouseEvent(h,!0,!0,window,0,k[0],k[1],l[0],l[1],!1,!1,!1,!1,1,m),b_android){var c=document.createTouch(window,m,0,j[0],j[1],k[0],k[1],l[0],l[1],0,0,0,0);a.touches=a.targetTouches=a.changedTouches=document.createTouchList(c)}}};if(document.createEvent){var q=!i&&!g&&s&&u[c]&&!b_android?"TouchEvent":"MouseEvents";a=document.createEvent(q),o[q](a),n(a),m.dispatchEvent(a)}else document.createEventObject&&((a=document.createEventObject()).eventType=a.eventName=h,a.screenX=k[0],a.screenY=k[1],a.clientX=l[0],a.clientY=l[1],n(a),m.fireEvent("on"+h,a))}),this}},a.Mottle.consume=function(a,b){a.stopPropagation?a.stopPropagation():a.returnValue=!1,!b&&a.preventDefault&&a.preventDefault()},a.Mottle.pageLocation=y,a.Mottle.setForceTouchEvents=function(a){s=a},a.Mottle.setForceMouseEvents=function(a){t=a}}.call("undefined"==typeof window?this:window),function(){"use strict";var b=function(a,b,c){return-1===a.indexOf(b)&&(c?a.unshift(b):a.push(b),!0)},c=function(a,b){var c=a.indexOf(b);-1!=c&&a.splice(c,1)},e=function(a){return null!=a&&("string"==typeof a||a.constructor==String)},g=function(a,b,c){for(var d=(c=c||a.parentNode).querySelectorAll(b),e=0;e<d.length;e++)if(d[e]===a)return!0;return!1},h=function(){var a=-1;if("Microsoft Internet Explorer"==navigator.appName){var b=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(b)&&(a=parseFloat(RegExp.$1))}return a}(),k=h>-1&&9>h,l=9==h,m=function(a){if(k)return[a.clientX+document.documentElement.scrollLeft,a.clientY+document.documentElement.scrollTop];var b=o(a),c=n(b,0);return l?[c.pageX||c.clientX,c.pageY||c.clientY]:[c.pageX,c.pageY]},n=function(a,b){return a.item?a.item(b):a[b]},o=function(a){return a.touches&&a.touches.length>0?a.touches:a.changedTouches&&a.changedTouches.length>0?a.changedTouches:a.targetTouches&&a.targetTouches.length>0?a.targetTouches:[a]},p={draggable:"katavorio-draggable",droppable:"katavorio-droppable",drag:"katavorio-drag",selected:"katavorio-drag-selected",active:"katavorio-drag-active",hover:"katavorio-drag-hover",noSelect:"katavorio-drag-no-select",ghostProxy:"katavorio-ghost-proxy"},r=["stop","start","drag","drop","over","out","beforeStart"],s=function(){},t=function(){return!0},u=function(a,b,c){for(var d=0;d<a.length;d++)a[d]!=c&&b(a[d])},v=function(a,b,c,d){u(a,function(a){a.setActive(b),b&&a.updatePosition(),c&&a.setHover(d,b)})},w=function(a,b){if(null!=a){a=e(a)||null!=a.tagName||null==a.length?[a]:a;for(var c=0;c<a.length;c++)b.apply(a[c],[a[c]])}},x=function(a){a.stopPropagation?(a.stopPropagation(),a.preventDefault()):a.returnValue=!1},z=function(a,b,c){var d=a.srcElement||a.target;return!g(d,c.getInputFilterSelector(),b)},A=function(a,b,c,d){this.params=b||{},this.el=a,this.params.addClass(this.el,this._class),this.uuid=F();var e=!0;return this.setEnabled=function(a){e=a},this.isEnabled=function(){return e},this.toggleEnabled=function(){e=!e},this.setScope=function(a){this.scopes=a?a.split(/\s+/):[d]},this.addScope=function(a){var b={};for(var c in w(this.scopes,function(a){b[a]=!0}),w(a?a.split(/\s+/):[],function(a){b[a]=!0}),this.scopes=[],b)this.scopes.push(c)},this.removeScope=function(a){var b={};for(var c in w(this.scopes,function(a){b[a]=!0}),w(a?a.split(/\s+/):[],function(a){delete b[a]}),this.scopes=[],b)this.scopes.push(c)},this.toggleScope=function(a){var b={};for(var c in w(this.scopes,function(a){b[a]=!0}),w(a?a.split(/\s+/):[],function(a){b[a]?delete b[a]:b[a]=!0}),this.scopes=[],b)this.scopes.push(c)},this.setScope(b.scope),this.k=b.katavorio,b.katavorio},B=function(){return!0},C=function(){return!1},D=function(a,b,c){this._class=c.draggable;var d=A.apply(this,arguments);this.rightButtonCanDrag=this.params.rightButtonCanDrag;var h=[0,0],k=null,l=null,n=[0,0],o=!1,q=!1!==this.params.consumeStartEvent,r=this.el,s=this.params.clone,u=(this.params.scroll,!1!==b.multipleDrop),w=!1,y=!0===b.ghostProxy?B:b.ghostProxy&&"function"==typeof b.ghostProxy?b.ghostProxy:C,E=b.snapThreshold||5,G=function(a,b,c,d,e){d=d||E,e=e||E;var g=b*Math.floor(a[0]/b),h=g+b,i=Math.abs(a[0]-g)<=d?g:Math.abs(h-a[0])<=d?h:a[0],k=c*Math.floor(a[1]/c),l=k+c;return[i,Math.abs(a[1]-k)<=e?k:Math.abs(l-a[1])<=e?l:a[1]]};this.posses=[],this.posseRoles={},this.toGrid=function(a){return null==this.params.grid?a:G(a,this.params.grid[0],this.params.grid[1])},this.snap=function(a,b){if(null!=r){a=a||(this.params.grid?this.params.grid[0]:50),b=b||(this.params.grid?this.params.grid[1]:50);var c=this.params.getPosition(r);this.params.setPosition(r,G(c,a,b,a,b))}},this.setUseGhostProxy=function(a){y=a?B:C};var H,K,I=function(a){return!1===b.allowNegative?[Math.max(0,a[0]),Math.max(0,a[1])]:a},J=function(a){H="function"==typeof a?a:a?function(a){return I([Math.max(0,Math.min(P.w-this.size[0],a[0])),Math.max(0,Math.min(P.h-this.size[1],a[1]))])}.bind(this):function(a){return I(a)}}.bind(this);J("function"==typeof this.params.constrain?this.params.constrain:this.params.constrain||this.params.containment),this.setConstrain=function(a){J(a)},this.setRevert=function(a){K=a};var M={},O=this.setFilter=function(b,c){if(b){var d=function(a){return"function"==typeof a?(a._katavorioId=F(),a._katavorioId):a}(b);M[d]=[function(c){var d,f=c.srcElement||c.target;return e(b)?d=g(f,b,a):"function"==typeof b&&(d=b(c,a)),d},!1!==c]}};this.addFilter=O,this.removeFilter=function(a){var b="function"==typeof a?a._katavorioId:a;delete M[b]},this.clearAllFilters=function(){M={}},this.canDrag=this.params.canDrag||t;var P,Q=[],R=[];this.downListener=function(a){if((this.rightButtonCanDrag||3!==a.which&&2!==a.button)&&this.isEnabled()&&this.canDrag())if(function(a){for(var b in M){var c=M[b],d=c[0](a);if(c[1]&&(d=!d),!d)return!1}return!0}(a)&&z(a,this.el,this.k)){if(s){(r=this.el.cloneNode(!0)).setAttribute("id",null),r.style.position="absolute";var g=function(a){var b=a.getBoundingClientRect(),c=document.body,d=document.documentElement,e=window.pageYOffset||d.scrollTop||c.scrollTop,f=window.pageXOffset||d.scrollLeft||c.scrollLeft,g=d.clientTop||c.clientTop||0,h=d.clientLeft||c.clientLeft||0,i=b.top+e-g,j=b.left+f-h;return{top:Math.round(i),left:Math.round(j)}}(this.el);r.style.left=g.left+"px",r.style.top=g.top+"px",document.body.appendChild(r)}else r=this.el;q&&x(a),h=m(a),this.params.bind(document,"mousemove",this.moveListener),this.params.bind(document,"mouseup",this.upListener),d.markSelection(this),d.markPosses(this),this.params.addClass(document.body,c.noSelect),T("beforeStart",{el:this.el,pos:k,e:a,drag:this})}else this.params.consumeFilteredEvents&&x(a)}.bind(this),this.moveListener=function(a){if(h){if(!o)if(!1!==T("start",{el:this.el,pos:k,e:a,drag:this})){if(!h)return;this.mark(!0),o=!0}if(h){R.length=0;var c=m(a),e=c[0]-h[0],f=c[1]-h[1],g=this.params.ignoreZoom?1:d.getZoom();e/=g,f/=g,this.moveBy(e,f,a),d.updateSelection(e,f,this),d.updatePosses(e,f,this)}}}.bind(this),this.upListener=function(a){h&&(h=null,this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.params.removeClass(document.body,c.noSelect),this.unmark(a),d.unmarkSelection(this,a),d.unmarkPosses(this,a),this.stop(a),d.notifySelectionDragStop(this,a),d.notifyPosseDragStop(this,a),o=!1,s&&(r&&r.parentNode&&r.parentNode.removeChild(r),r=null),K&&!0===K(this.el,this.params.getPosition(this.el))&&(this.params.setPosition(this.el,k),T("revert",this.el)))}.bind(this),this.getFilters=function(){return M},this.abort=function(){null!=h&&this.upListener()},this.getDragElement=function(){return r||this.el};var S={start:[],drag:[],stop:[],over:[],out:[],beforeStart:[],revert:[]};b.events.start&&S.start.push(b.events.start),b.events.beforeStart&&S.beforeStart.push(b.events.beforeStart),b.events.stop&&S.stop.push(b.events.stop),b.events.drag&&S.drag.push(b.events.drag),b.events.revert&&S.revert.push(b.events.revert),this.on=function(a,b){S[a]&&S[a].push(b)},this.off=function(a,b){if(S[a]){for(var c=[],d=0;d<S[a].length;d++)S[a][d]!==b&&c.push(S[a][d]);S[a]=c}};var U,T=function(a,b){if(S[a])for(var c=0;c<S[a].length;c++)try{S[a][c](b)}catch(d){}};this.notifyStart=function(a){T("start",{el:this.el,pos:this.params.getPosition(r),e:a,drag:this})},this.stop=function(a,b){if(b||o){var c=[],e=d.getSelection(),f=this.params.getPosition(r);if(e.length>1)for(var g=0;g<e.length;g++){var h=this.params.getPosition(e[g].el);c.push([e[g].el,{left:h[0],top:h[1]},e[g]])}else c.push([r,{left:f[0],top:f[1]},this]);T("stop",{el:r,pos:U||f,finalPos:f,e:a,drag:this,selection:c})}},this.mark=function(a){k=this.params.getPosition(r),l=this.params.getPosition(r,!0),n=[l[0]-k[0],l[1]-k[1]],this.size=this.params.getSize(r),Q=d.getMatchingDroppables(this),v(Q,!0,!1,this),this.params.addClass(r,this.params.dragClass||c.drag);var b=this.params.getSize(r.parentNode);P={w:b[0],h:b[1]},a&&d.notifySelectionDragStart(this)},this.unmark=function(a,d){if(v(Q,!1,!0,this),w&&y(this.el)?(U=[r.offsetLeft,r.offsetTop],this.el.parentNode.removeChild(r),r=this.el):U=null,this.params.removeClass(r,this.params.dragClass||c.drag),Q.length=0,w=!1,!d){R.length>0&&U&&b.setPosition(this.el,U);for(var e=0;e<R.length;e++){if(!0===R[e].drop(this,a))break}}},this.moveBy=function(a,c,d){R.length=0;var e=this.toGrid([k[0]+a,k[1]+c]),f=H(e,r);if(y(this.el))if(e[0]!=f[0]||e[1]!=f[1]){if(!w){var g=function(a){return a.cloneNode(!0)}(this.el);b.addClass(g,p.ghostProxy),this.el.parentNode.appendChild(g),r=g,w=!0}f=e}else w&&(this.el.parentNode.removeChild(r),r=this.el,w=!1);var h={x:f[0],y:f[1],w:this.size[0],h:this.size[1]},i={x:h.x+n[0],y:h.y+n[1],w:h.w,h:h.h},j=null;this.params.setPosition(r,f);for(var l=0;l<Q.length;l++){var m={x:Q[l].pagePosition[0],y:Q[l].pagePosition[1],w:Q[l].size[0],h:Q[l].size[1]};this.params.intersects(i,m)&&(u||null==j||j==Q[l].el)&&Q[l].canDrop(this)?(j||(j=Q[l].el),R.push(Q[l]),Q[l].setHover(this,!0,d)):Q[l].isHover()&&Q[l].setHover(this,!1,d)}T("drag",{el:this.el,pos:f,e:d,drag:this})},this.destroy=function(){this.params.unbind(this.el,"mousedown",this.downListener),this.params.unbind(document,"mousemove",this.moveListener),this.params.unbind(document,"mouseup",this.upListener),this.downListener=null,this.upListener=null,this.moveListener=null},this.params.bind(this.el,"mousedown",this.downListener),this.params.handle?O(this.params.handle,!1):O(this.params.filter,this.params.filterExclude)},E=function(a,b,c){this._class=c.droppable,this.params=b||{},this._activeClass=this.params.activeClass||c.active,this._hoverClass=this.params.hoverClass||c.hover,A.apply(this,arguments);var d=!1;this.allowLoopback=!1!==this.params.allowLoopback,this.setActive=function(a){this.params[a?"addClass":"removeClass"](this.el,this._activeClass)},this.updatePosition=function(){this.position=this.params.getPosition(this.el),this.pagePosition=this.params.getPosition(this.el,!0),this.size=this.params.getSize(this.el)},this.canDrop=this.params.canDrop||function(){return!0},this.isHover=function(){return d},this.setHover=function(a,b,c){(b||null==this.el._katavorioDragHover||this.el._katavorioDragHover==a.el._katavorio)&&(this.params[b?"addClass":"removeClass"](this.el,this._hoverClass),this.el._katavorioDragHover=b?a.el._katavorio:null,d!==b&&this.params.events[b?"over":"out"]({el:this.el,e:c,drag:a,drop:this}),d=b)},this.drop=function(a,b){return this.params.events.drop({drag:a,e:b,drop:this})},this.destroy=function(){this._class=null,this._activeClass=null,this._hoverClass=null,d=null}},F=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random();return("x"==a?b:8|3&b).toString(16)})},G=function(a){return null==a?null:null==(a="string"==typeof a||a.constructor==String?document.getElementById(a):a)?null:(a._katavorio=a._katavorio||F(),a)};this.Katavorio=function(a){var f=[],g={};this._dragsByScope={},this._dropsByScope={};var h=1,i=function(a,b){w(a,function(a){for(var c=0;c<a.scopes.length;c++)b[a.scopes[c]]=b[a.scopes[c]]||[],b[a.scopes[c]].push(a)})},j=function(b,c){var d=0;return w(b,function(b){for(var e=0;e<b.scopes.length;e++)if(c[b.scopes[e]]){var f=a.indexOf(c[b.scopes[e]],b);-1!=f&&(c[b.scopes[e]].splice(f,1),d++)}}),d>0},k=(this.getMatchingDroppables=function(a){for(var b=[],c={},d=0;d<a.scopes.length;d++){var e=this._dropsByScope[a.scopes[d]];if(e)for(var f=0;f<e.length;f++)!e[f].canDrop(a)||c[e[f].uuid]||!e[f].allowLoopback&&e[f].el===a.el||(c[e[f].uuid]=!0,b.push(e[f]))}return b},function(b){b=b||{};var c,d={events:{}};for(c in a)d[c]=a[c];for(c in b)d[c]=b[c];for(c=0;c<r.length;c++)d.events[r[c]]=b[r[c]]||s;return d.katavorio=this,d}.bind(this)),l=function(a,b){for(var c=0;c<r.length;c++)b[r[c]]&&a.on(r[c],b[r[c]])}.bind(this),m={},n=a.css||{},o=a.scope||"katavorio-drag-scope";for(var t in p)m[t]=p[t];for(var t in n)m[t]=n[t];var v=a.inputFilterSelector||"input,textarea,select,button,option";this.getInputFilterSelector=function(){return v},this.setInputFilterSelector=function(a){return v=a,this},this.draggable=function(b,c){var d=[];return w(b,function(b){if(null!=(b=G(b)))if(null==b._katavorioDrag){var e=k(c);b._katavorioDrag=new D(b,e,m,o),i(b._katavorioDrag,this._dragsByScope),d.push(b._katavorioDrag),a.addClass(b,m.draggable)}else l(b._katavorioDrag,c)}.bind(this)),d},this.droppable=function(b,c){var d=[];return w(b,function(b){if(null!=(b=G(b))){var e=new E(b,k(c),m,o);b._katavorioDrop=b._katavorioDrop||[],b._katavorioDrop.push(e),i(e,this._dropsByScope),d.push(e),a.addClass(b,m.droppable)}}.bind(this)),d},this.select=function(b){return w(b,function(){var b=G(this);b&&b._katavorioDrag&&(g[b._katavorio]||(f.push(b._katavorioDrag),g[b._katavorio]=[b,f.length-1],a.addClass(b,m.selected)))}),this},this.deselect=function(b){return w(b,function(){var b=G(this);if(b&&b._katavorio&&g[b._katavorio]){for(var d=[],e=0;e<f.length;e++)f[e].el!==b&&d.push(f[e]);f=d,delete g[b._katavorio],a.removeClass(b,m.selected)}}),this},this.deselectAll=function(){for(var b in g){var c=g[b];a.removeClass(c[0],m.selected)}f.length=0,g={}},this.markSelection=function(a){u(f,function(a){a.mark()},a)},this.markPosses=function(a){a.posses&&w(a.posses,function(b){a.posseRoles[b]&&B[b]&&u(B[b].members,function(a){a.mark()},a)})},this.unmarkSelection=function(a,b){u(f,function(a){a.unmark(b)},a)},this.unmarkPosses=function(a,b){a.posses&&w(a.posses,function(c){a.posseRoles[c]&&B[c]&&u(B[c].members,function(a){a.unmark(b,!0)},a)})},this.getSelection=function(){return f.slice(0)},this.updateSelection=function(a,b,c){u(f,function(c){c.moveBy(a,b)},c)};var x=function(a,b){b.posses&&w(b.posses,function(c){b.posseRoles[c]&&B[c]&&u(B[c].members,function(b){a(b)},b)})};this.updatePosses=function(a,b,c){x(function(c){c.moveBy(a,b)},c)},this.notifyPosseDragStop=function(a,b){x(function(a){a.stop(b,!0)},a)},this.notifySelectionDragStop=function(a,b){u(f,function(a){a.stop(b,!0)},a)},this.notifySelectionDragStart=function(a,b){u(f,function(a){a.notifyStart(b)},a)},this.setZoom=function(a){h=a},this.getZoom=function(){return h};var z=function(a,b,c,d){w(a,function(a){j(a,c),a[d](b),i(a,c)})};w(["set","add","remove","toggle"],function(a){this[a+"Scope"]=function(b,c){z(b._katavorioDrag,c,this._dragsByScope,a+"Scope"),z(b._katavorioDrop,c,this._dropsByScope,a+"Scope")}.bind(this),this[a+"DragScope"]=function(b,c){z(b.constructor===D?b:b._katavorioDrag,c,this._dragsByScope,a+"Scope")}.bind(this),this[a+"DropScope"]=function(b,c){z(b.constructor===E?b:b._katavorioDrop,c,this._dropsByScope,a+"Scope")}.bind(this)}.bind(this)),this.snapToGrid=function(a,b){for(var c in this._dragsByScope)u(this._dragsByScope[c],function(c){c.snap(a,b)})},this.getDragsForScope=function(a){return this._dragsByScope[a]},this.getDropsForScope=function(a){return this._dropsByScope[a]};var A=function(a,b,c){(a=G(a))[b]&&(j(a[b],c)&&w(a[b],function(a){a.destroy()}),delete a[b])};this.elementRemoved=function(a){this.destroyDraggable(a),this.destroyDroppable(a)},this.destroyDraggable=function(a){A(a,"_katavorioDrag",this._dragsByScope)},this.destroyDroppable=function(a){A(a,"_katavorioDrop",this._dropsByScope)},this.reset=function(){this._dragsByScope={},this._dropsByScope={},f=[],g={},B={}};var B={},C=function(a,c,d){var f=e(c)?c:c.id,g=!!e(c)||!1!==c.active,h=B[f]||function(){var a={name:f,members:[]};return B[f]=a,a}();return w(a,function(a){if(a._katavorioDrag){if(d&&null!=a._katavorioDrag.posseRoles[h.name])return;b(h.members,a._katavorioDrag),b(a._katavorioDrag.posses,h.name),a._katavorioDrag.posseRoles[h.name]=g}}),h};this.addToPosse=function(a){for(var b=[],c=1;c<arguments.length;c++)b.push(C(a,arguments[c]));return 1==b.length?b[0]:b},this.setPosse=function(a){for(var b=[],c=1;c<arguments.length;c++)b.push(C(a,arguments[c],!0).name);return w(a,function(a){if(a._katavorioDrag){var c=function(a,b){for(var c=[],d=0;d<a.length;d++)-1==b.indexOf(a[d])&&c.push(a[d]);return c}(a._katavorioDrag.posses,b);Array.prototype.push.apply([],a._katavorioDrag.posses);for(var f=0;f<c.length;f++)this.removeFromPosse(a,c[f])}}.bind(this)),1==b.length?b[0]:b},this.removeFromPosse=function(a,b){if(arguments.length<2)throw new TypeError("No posse id provided for remove operation");for(var d=1;d<arguments.length;d++)b=arguments[d],w(a,function(a){if(a._katavorioDrag&&a._katavorioDrag.posses){var d=a._katavorioDrag;w(b,function(a){c(B[a].members,d),c(d.posses,a),delete d.posseRoles[a]})}})},this.removeFromAllPosses=function(a){w(a,function(a){if(a._katavorioDrag&&a._katavorioDrag.posses){var b=a._katavorioDrag;w(b.posses,function(a){c(B[a].members,b)}),b.posses.length=0,b.posseRoles={}}})},this.setPosseState=function(a,b,c){var d=B[b];d&&w(a,function(a){a._katavorioDrag&&a._katavorioDrag.posses&&(a._katavorioDrag.posseRoles[d.name]=c)})}}}.call("undefined"!=typeof window?window:this),function(){var a=function(a){return"[object Array]"===Object.prototype.toString.call(a)},c=function(a){return"string"==typeof a},d=function(a){return"boolean"==typeof a},f=function(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)},g=function(a){return"[object Date]"===Object.prototype.toString.call(a)},h=function(a){return"[object Function]"===Object.prototype.toString.call(a)},j=this,k=j.jsPlumbUtil={isArray:a,isString:c,isBoolean:d,isNull:function(a){return null==a},isObject:f,isDate:g,isFunction:h,isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},isNumber:function(a){return"[object Number]"===Object.prototype.toString.call(a)},clone:function(b){if(c(b))return""+b;if(d(b))return!!b;if(g(b))return new Date(b.getTime());if(h(b))return b;if(a(b)){for(var e=[],i=0;i<b.length;i++)e.push(this.clone(b[i]));return e}if(f(b)){var j={};for(var k in b)j[k]=this.clone(b[k]);return j}return b},merge:function(b,e,g){var h,i,j={};for(g=g||[],i=0;i<g.length;i++)j[g[i]]=!0;var k=this.clone(b);for(i in e)if(null==k[i])k[i]=e[i];else if(c(e[i])||d(e[i]))j[i]?((h=[]).push.apply(h,a(k[i])?k[i]:[k[i]]),h.push.apply(h,a(e[i])?e[i]:[e[i]]),k[i]=h):k[i]=e[i];else if(a(e[i]))h=[],a(k[i])&&h.push.apply(h,k[i]),h.push.apply(h,e[i]),k[i]=h;else if(f(e[i]))for(var l in f(k[i])||(k[i]={}),e[i])k[i][l]=e[i][l];return k},replace:function(a,b,c){if(null!=a){var e=a;return b.replace(/([^\.])+/g,function(a,b,d,f){var g=a.match(/([^\[0-9]+){1}(\[)([0-9+])/),i=function(){return e[g[1]]||(e[g[1]]=[],e[g[1]])};if(d+a.length>=f.length)g?i()[g[3]]=c:e[a]=c;else if(g){var j=i();e=j[g[3]]||(j[g[3]]={},j[g[3]])}else e=e[a]||(e[a]={},e[a])}),a}},functionChain:function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d][0][c[d][1]].apply(c[d][0],c[d][2]);if(e===b)return e}return a},populate:function(b,d,e){var i=function(b){if(null!=b){if(c(b))return function(a){var b=a.match(/(\${.*?})/g);if(null!=b)for(var c=0;c<b.length;c++){var e=d[b[c].substring(2,b[c].length-1)]||"";null!=e&&(a=a.replace(b[c],e))}return a}(b);if(!h(b)||null!=e&&0!==(b.name||"").indexOf(e)){if(a(b)){for(var j=[],k=0;k<b.length;k++)j.push(i(b[k]));return j}if(f(b)){var l={};for(var m in b)l[m]=i(b[m]);return l}return b}return b(d)}};return i(b)},findWithFunction:function(a,b){if(a)for(var c=0;c<a.length;c++)if(b(a[c]))return c;return-1},removeWithFunction:function(a,b){var c=k.findWithFunction(a,b);return c>-1&&a.splice(c,1),-1!=c},remove:function(a,b){var c=a.indexOf(b);return c>-1&&a.splice(c,1),-1!=c},addWithFunction:function(a,b,c){-1==k.findWithFunction(a,c)&&a.push(b)},addToList:function(a,b,c,d){var e=a[b];return null==e&&(e=[],a[b]=e),e[d?"unshift":"push"](c),e},suggest:function(a,b,c){return-1===a.indexOf(b)&&(c?a.unshift(b):a.push(b),!0)},extend:function(b,c){var d;for(c=a(c)?c:[c],d=0;d<c.length;d++)for(var e in c[d].prototype)c[d].prototype.hasOwnProperty(e)&&(b.prototype[e]=c[d].prototype[e]);var f=function(a,b){return function(){for(d=0;d<c.length;d++)c[d].prototype[a]&&c[d].prototype[a].apply(this,arguments);return b.apply(this,arguments)}},g=function(a){for(var c in a)b.prototype[c]=f(c,a[c])};if(arguments.length>2)for(d=2;d<arguments.length;d++)g(arguments[d]);return b},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=0|16*Math.random();return("x"==a?b:8|3&b).toString(16)})},logEnabled:!0,log:function(){if(k.logEnabled&&"undefined"!=typeof console)try{var a=arguments[arguments.length-1];console.log(a)}catch(b){}},wrap:function(a,b,c){return a=a||function(){},b=b||function(){},function(){var d=null;try{d=b.apply(this,arguments)}catch(e){k.log("jsPlumb function failed : "+e)}if(null==c||d!==c)try{d=a.apply(this,arguments)}catch(e){k.log("wrapped function failed : "+e)}return d}}};k.EventGenerator=function(){var a={},b=!1,c={ready:!0};this.bind=function(b,c,d){var e=function(b){k.addToList(a,b,c,d),c.__jsPlumb=c.__jsPlumb||{},c.__jsPlumb[j.jsPlumbUtil.uuid()]=b};if("string"==typeof b)e(b);else if(null!=b.length)for(var f=0;f<b.length;f++)e(b[f]);return this},this.fire=function(d,e,f){if(!b&&a[d]){var g=a[d].length,h=0,i=!1,j=null;if(!this.shouldFireEvent||this.shouldFireEvent(d,e,f))for(;!i&&g>h&&!1!==j;){if(c[d])a[d][h].apply(this,[e,f]);else try{j=a[d][h].apply(this,[e,f])}catch(l){k.log("jsPlumb: fire failed for event "+d+" : "+l)}h++,(null==a||null==a[d])&&(i=!0)}}return this},this.unbind=function(b,c){if(0===arguments.length)a={};else if(1===arguments.length){if("string"==typeof b)delete a[b];else if(b.__jsPlumb){var d;for(var e in b.__jsPlumb)d=b.__jsPlumb[e],k.remove(a[d]||[],b)}}else 2===arguments.length&&k.remove(a[b]||[],c);return this},this.getListener=function(b){return a[b]},this.setSuspendEvents=function(a){b=a},this.isSuspendEvents=function(){return b},this.silently=function(a){this.setSuspendEvents(!0);try{a()}catch(b){j.jsPlumbUtil.log("Cannot execute silent function "+b)}this.setSuspendEvents(!1)},this.cleanupListeners=function(){for(var b in a)a[b]=null}},k.EventGenerator.prototype={cleanup:function(){this.cleanupListeners()}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var b=this.jsPlumbUtil;b.matchesSelector=function(a,b,c){for(var d=(c=c||a.parentNode).querySelectorAll(b),e=0;e<d.length;e++)if(d[e]===a)return!0;return!1},b.consume=function(a,b){a.stopPropagation?a.stopPropagation():a.returnValue=!1,!b&&a.preventDefault&&a.preventDefault()},b.sizeElement=function(a,b,c,d,e){a&&(a.style.height=e+"px",a.height=e,a.style.width=d+"px",a.width=d,a.style.left=b+"px",a.style.top=c+"px")}}.call("undefined"!=typeof window?window:this),function(){"use strict";var a,b=this,c=[],d=b.jsPlumbUtil,e=function(){return""+(new Date).getTime()},f=function(a){if(a._jsPlumb.paintStyle&&a._jsPlumb.hoverPaintStyle){var b={};r.extend(b,a._jsPlumb.paintStyle),r.extend(b,a._jsPlumb.hoverPaintStyle),delete a._jsPlumb.hoverPaintStyle,b.gradient&&a._jsPlumb.paintStyle.fillStyle&&delete b.gradient,a._jsPlumb.hoverPaintStyle=b}},g=["tap","dbltap","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","contextmenu"],i=function(a){return null==a?null:a.split(" ")},j=function(a,b,c){for(var d in b)a[d]=c},k=function(a,b){b=d.isArray(b)||null!=b.length&&!d.isString(b)?b:[b];for(var c=0;c<b.length;c++)try{a.apply(b[c],[b[c]])}catch(e){d.log(".each iteration failed : "+e)}},l=function(a,b,c){if(a.getDefaultType){var e=a.getTypeDescriptor(),f={},g=a.getDefaultType(),h=d.merge({},g);j(f,g,"__default");for(var i=0,k=a._jsPlumb.types.length;k>i;i++){var l=a._jsPlumb.types[i];if("__default"!==l){var m=a._jsPlumb.instance.getType(l,e);null!=m&&(h=d.merge(h,m,["cssClass"]),j(f,m,l))}}b&&(h=d.populate(h,b,"_")),a.applyType(h,c,f),c||a.repaint()}},m=b.jsPlumbUIComponent=function(a){d.EventGenerator.apply(this,arguments);var c=arguments,f=this.idPrefix+(new Date).getTime();this._jsPlumb={instance:a._jsPlumb,parameters:a.parameters||{},paintStyle:null,hoverPaintStyle:null,paintStyleInUse:null,hover:!1,beforeDetach:a.beforeDetach,beforeDrop:a.beforeDrop,overlayPlacements:[],hoverClass:a.hoverClass||a._jsPlumb.Defaults.HoverClass,types:[],typeCache:{}},this.cacheTypeItem=function(a,b,c){this._jsPlumb.typeCache[c]=this._jsPlumb.typeCache[c]||{},this._jsPlumb.typeCache[c][a]=b},this.getCachedTypeItem=function(a,b){return this._jsPlumb.typeCache[b]?this._jsPlumb.typeCache[b][a]:null},this.getId=function(){return f};var g=a.overlays||[],h={};if(this.defaultOverlayKeys){for(var i=0;i<this.defaultOverlayKeys.length;i++)Array.prototype.push.apply(g,this._jsPlumb.instance.Defaults[this.defaultOverlayKeys[i]]||[]);for(i=0;i<g.length;i++){var j=r.convertToFullOverlaySpec(g[i]);h[j[1].id]=j}}var k={overlays:h,parameters:a.parameters||{},scope:a.scope||this._jsPlumb.instance.getDefaultScope()};if(this.getDefaultType=function(){return k},this.appendToDefaultType=function(a){for(var b in a)k[b]=a[b]},a.events)for(i in a.events)this.bind(i,a.events[i]);this.clone=function(){var a=Object.create(this.constructor.prototype);return this.constructor.apply(a,c),a}.bind(this),this.isDetachAllowed=function(a){var b=!0;if(this._jsPlumb.beforeDetach)try{b=this._jsPlumb.beforeDetach(a)}catch(c){d.log("jsPlumb: beforeDetach callback failed",c)}return b},this.isDropAllowed=function(a,b,c,e,f,g,h){var i=this._jsPlumb.instance.checkCondition("beforeDrop",{sourceId:a,targetId:b,scope:c,connection:e,dropEndpoint:f,source:g,target:h});if(this._jsPlumb.beforeDrop)try{i=this._jsPlumb.beforeDrop({sourceId:a,targetId:b,scope:c,connection:e,dropEndpoint:f,source:g,target:h})}catch(j){d.log("jsPlumb: beforeDrop callback failed",j)}return i};var l=[];this.setListenerComponent=function(a){for(var b=0;b<l.length;b++)l[b][3]=a}},n=function(a,b){var c=a._jsPlumb.types[b],d=a._jsPlumb.instance.getType(c,a.getTypeDescriptor());null!=d&&d.cssClass&&a.canvas&&a._jsPlumb.instance.removeClass(a.canvas,d.cssClass)};d.extend(b.jsPlumbUIComponent,d.EventGenerator,{getParameter:function(a){return this._jsPlumb.parameters[a]},setParameter:function(a,b){this._jsPlumb.parameters[a]=b},getParameters:function(){return this._jsPlumb.parameters},setParameters:function(a){this._jsPlumb.parameters=a},getClass:function(){return r.getClass(this.canvas)},hasClass:function(a){return r.hasClass(this.canvas,a)},addClass:function(a){r.addClass(this.canvas,a)},removeClass:function(a){r.removeClass(this.canvas,a)},updateClasses:function(a,b){r.updateClasses(this.canvas,a,b)},setType:function(a,b,c){this.clearTypes(),this._jsPlumb.types=i(a)||[],l(this,b,c)},getType:function(){return this._jsPlumb.types},reapplyTypes:function(a,b){l(this,a,b)},hasType:function(a){return-1!=this._jsPlumb.types.indexOf(a)},addType:function(a,b,c){var d=i(a),e=!1;if(null!=d){for(var f=0,g=d.length;g>f;f++)this.hasType(d[f])||(this._jsPlumb.types.push(d[f]),e=!0);e&&l(this,b,c)}},removeType:function(a,b,c){var d=i(a),e=!1,f=function(a){var b=this._jsPlumb.types.indexOf(a);return-1!=b&&(n(this,b),this._jsPlumb.types.splice(b,1),!0)}.bind(this);if(null!=d){for(var g=0,h=d.length;h>g;g++)e=f(d[g])||e;e&&l(this,b,c)}},clearTypes:function(a,b){for(var c=this._jsPlumb.types.length,d=0;c>d;d++)n(this,0),this._jsPlumb.types.splice(0,1);l(this,a,b)},toggleType:function(a,b,c){var d=i(a);if(null!=d){for(var e=0,f=d.length;f>e;e++){var g=this._jsPlumb.types.indexOf(d[e]);-1!=g?(n(this,g),this._jsPlumb.types.splice(g,1)):this._jsPlumb.types.push(d[e])}l(this,b,c)}},applyType:function(a,b){if(this.setPaintStyle(a.paintStyle,b),this.setHoverPaintStyle(a.hoverPaintStyle,b),a.parameters)for(var c in a.parameters)this.setParameter(c,a.parameters[c]);this._jsPlumb.paintStyleInUse=this.getPaintStyle()},setPaintStyle:function(a,b){this._jsPlumb.paintStyle=a,this._jsPlumb.paintStyleInUse=this._jsPlumb.paintStyle,f(this),b||this.repaint()},getPaintStyle:function(){return this._jsPlumb.paintStyle},setHoverPaintStyle:function(a,b){this._jsPlumb.hoverPaintStyle=a,f(this),b||this.repaint()},getHoverPaintStyle:function(){return this._jsPlumb.hoverPaintStyle},destroy:function(a){(a||null==this.typeId)&&(this.cleanupListeners(),this.clone=null,this._jsPlumb=null)},isHover:function(){return this._jsPlumb.hover},setHover:function(a,b,c){if(this._jsPlumb&&!this._jsPlumb.instance.currentlyDragging&&!this._jsPlumb.instance.isHoverSuspended()){if(this._jsPlumb.hover=a,null!=this.canvas){if(null!=this._jsPlumb.instance.hoverClass){var d=a?"addClass":"removeClass";this._jsPlumb.instance[d](this.canvas,this._jsPlumb.instance.hoverClass)}null!=this._jsPlumb.hoverClass&&this._jsPlumb.instance[d](this.canvas,this._jsPlumb.hoverClass)}null!=this._jsPlumb.hoverPaintStyle&&(this._jsPlumb.paintStyleInUse=a?this._jsPlumb.hoverPaintStyle:this._jsPlumb.paintStyle,this._jsPlumb.instance.isSuspendDrawing()||(c=c||e(),this.repaint({timestamp:c,recalc:!1}))),this.getAttachedElements&&!b&&function(a,b,c,d){var e=a.getAttachedElements();if(e)for(var f=0,g=e.length;g>f;f++)d&&d==e[f]||e[f].setHover(b,!0,c)}(this,a,e(),this)}}});var o=0,p=function(){var a=o+1;return o++,a},q=b.jsPlumbInstance=function(f){this.Defaults={Anchor:"Bottom",Anchors:[null,null],ConnectionsDetachable:!0,ConnectionOverlays:[],Connector:"Bezier",Container:null,DoNotThrowErrors:!1,DragOptions:{},DropOptions:{},Endpoint:"Dot",EndpointOverlays:[],Endpoints:[null,null],EndpointStyle:{fillStyle:"#456"},EndpointStyles:[null,null],EndpointHoverStyle:null,EndpointHoverStyles:[null,null],HoverPaintStyle:null,LabelStyle:{color:"black"},LogEnabled:!1,Overlays:[],MaxConnections:1,PaintStyle:{lineWidth:4,strokeStyle:"#456"},ReattachConnections:!1,RenderMode:"svg",Scope:"jsPlumb_DefaultScope"},f&&r.extend(this.Defaults,f),this.logEnabled=this.Defaults.LogEnabled,this._connectionTypes={},this._endpointTypes={},d.EventGenerator.apply(this);var h=this,i=p(),j=h.bind,l={},n=1,o=function(a){if(null==a)return null;if(3==a.nodeType||8==a.nodeType)return{el:a,text:!0};var b=h.getElement(a);return{el:b,id:d.isString(a)&&null==b?a:Z(b)}};for(var q in this.getInstanceIndex=function(){return i},this.setZoom=function(a,b){return n=a,h.fire("zoom",n),b&&h.repaintEverything(),!0},this.getZoom=function(){return n},this.Defaults)l[q]=this.Defaults[q];var s,t=[];this.unbindContainer=function(){if(null!=s&&t.length>0)for(var a=0;a<t.length;a++)h.off(s,t[a][0],t[a][1])},this.setContainer=function(a){this.unbindContainer(),a=this.getElement(a),this.select().each(function(b){b.moveParent(a)}),this.selectEndpoints().each(function(b){b.moveParent(a)});var b=s;s=a,t.length=0;for(var c={endpointclick:"endpointClick",endpointdblclick:"endpointDblClick"},d=function(a,b,d){var e=b.srcElement||b.target,f=(e&&e.parentNode?e.parentNode._jsPlumb:null)||(e?e._jsPlumb:null)||(e&&e.parentNode&&e.parentNode.parentNode?e.parentNode.parentNode._jsPlumb:null);if(f){f.fire(a,f,b);var g=d&&c[d+a]||a;h.fire(g,f.component||f,b)}},e=function(a,b,c){t.push([a,c]),h.on(s,a,b,c)},f=function(a){e(a,".jsplumb-connector",function(b){d(a,b)}),e(a,".jsplumb-endpoint",function(b){d(a,b,"endpoint")}),e(a,".jsplumb-overlay",function(b){d(a,b)})},i=0;i<g.length;i++)f(g[i]);for(var j in z){var k=z[j].el;k.parentNode===b&&(b.removeChild(k),s.appendChild(k))}},this.getContainer=function(){return s},this.bind=function(a,b){"ready"===a&&v?b():j.apply(h,[a,b])},h.importDefaults=function(a){for(var b in a)h.Defaults[b]=a[b];return a.Container&&h.setContainer(a.Container),h},h.restoreDefaults=function(){return h.Defaults=r.extend({},l),h};var u=null,v=!1,w=[],x={},y={},z={},A={},B={},C={},D=!1,E=[],F=!1,G=null,H=this.Defaults.Scope,I=1,J=function(){return""+I++},K=function(a,b){s?s.appendChild(a):b?this.getElement(b).appendChild(a):this.appendToRoot(a)}.bind(this),L=function(a,b,c,d){if(!r.headless&&!F){var f=Z(a),g=h.getDragManager().getElementsForDraggable(f);null==c&&(c=e());var i=rb({elId:f,offset:b,recalc:!1,timestamp:c});if(g)for(var j in g)rb({elId:g[j].id,offset:{left:i.o.left+g[j].offset.left,top:i.o.top+g[j].offset.top},recalc:!1,timestamp:c});if(h.anchorManager.redraw(f,b,c,null,d),g)for(var k in g)h.anchorManager.redraw(g[k].id,b,c,g[k].offset,d,!0)}},M=function(a){return y[a]},P=function(a,b){var c=r.extend({},a);if(b&&r.extend(c,b),c.source&&(c.source.endpoint?c.sourceEndpoint=c.source:c.source=h.getElement(c.source)),c.target&&(c.target.endpoint?c.targetEndpoint=c.target:c.target=h.getElement(c.target)),a.uuids&&(c.sourceEndpoint=M(a.uuids[0]),c.targetEndpoint=M(a.uuids[1])),c.sourceEndpoint&&c.sourceEndpoint.isFull())d.log(h,"could not add connection; source endpoint is full");else{if(!c.targetEndpoint||!c.targetEndpoint.isFull()){if(!c.type&&c.sourceEndpoint&&(c.type=c.sourceEndpoint.connectionType),c.sourceEndpoint&&c.sourceEndpoint.connectorOverlays){c.overlays=c.overlays||[];for(var e=0,f=c.sourceEndpoint.connectorOverlays.length;f>e;e++)c.overlays.push(c.sourceEndpoint.connectorOverlays[e])}c.sourceEndpoint&&c.sourceEndpoint.scope&&(c.scope=c.sourceEndpoint.scope),!c["pointer-events"]&&c.sourceEndpoint&&c.sourceEndpoint.connectorPointerEvents&&(c["pointer-events"]=c.sourceEndpoint.connectorPointerEvents);var i=function(a,b,d){return h.addEndpoint(a,function(a,b){var c=r.extend({},a);for(var d in b)b[d]&&(c[d]=b[d]);return c}(b,{anchor:c.anchors?c.anchors[d]:c.anchor,endpoint:c.endpoints?c.endpoints[d]:c.endpoint,paintStyle:c.endpointStyles?c.endpointStyles[d]:c.endpointStyle,hoverPaintStyle:c.endpointHoverStyles?c.endpointHoverStyles[d]:c.endpointHoverStyle}))},j=function(a,b,d,e){if(c[a]&&!c[a].endpoint&&!c[a+"Endpoint"]&&!c.newConnection){var g=d[Z(c[a])];if(g=g?g[e]:null){if(!g.enabled)return!1;var h=null!=g.endpoint&&g.endpoint._jsPlumb?g.endpoint:i(c[a],g.def,b);if(h.isFull())return!1;c[a+"Endpoint"]=h,h._doNotDeleteOnDetach=!1,h._deleteOnDetach=!0,g.uniqueEndpoint&&(g.endpoint?h.finalEndpoint=g.endpoint:(g.endpoint=h,h._deleteOnDetach=!1,h._doNotDeleteOnDetach=!0))}}};return!1!==j("source",0,this.sourceEndpointDefinitions,c.type||"default")&&!1!==j("target",1,this.targetEndpointDefinitions,c.type||"default")?(c.sourceEndpoint&&c.targetEndpoint&&(function(a,b){for(var c=a.scope.split(/\s/),d=b.scope.split(/\s/),e=0;e<c.length;e++)for(var f=0;f<d.length;f++)if(d[f]==c[e])return!0;return!1}(c.sourceEndpoint,c.targetEndpoint)||(c=null)),c):void 0}d.log(h,"could not add connection; target endpoint is full")}}.bind(h),Q=function(a){var b=h.Defaults.ConnectionType||h.getDefaultConnectionType();a._jsPlumb=h,a.newConnection=Q,a.newEndpoint=S,a.endpointsByUUID=y,a.endpointsByElement=x,a.finaliseConnection=R,a.id="con_"+J();var c=new b(a);return c.isDetachable()&&(c.endpoints[0].initDraggable("_jsPlumbSource"),c.endpoints[1].initDraggable("_jsPlumbTarget")),c},R=h.finaliseConnection=function(a,b,c,d){if(b=b||{},a.suspendedEndpoint||w.push(a),a.pending=null,a.endpoints[0].isTemporarySource=!1,!1!==d&&h.anchorManager.newConnection(a),L(a.source),!b.doNotFireConnectionEvent&&!1!==b.fireEvent){var e={connection:a,source:a.source,target:a.target,sourceId:a.sourceId,targetId:a.targetId,sourceEndpoint:a.endpoints[0],targetEndpoint:a.endpoints[1]};h.fire("connection",e,c)}},S=function(a,b){var c=h.Defaults.EndpointType||r.Endpoint,d=r.extend({},a);d._jsPlumb=h,d.newConnection=Q,d.newEndpoint=S,d.endpointsByUUID=y,d.endpointsByElement=x,d.fireDetachEvent=ab,d.elementId=b||Z(d.source);var e=new c(d);return e.id="ep_"+J(),qb(d.elementId,d.source),r.headless||h.getDragManager().endpointAdded(d.source,b),e},T=function(a,b,c){var d=x[a];if(d&&d.length)for(var e=0,f=d.length;f>e;e++){for(var g=0,h=d[e].connections.length;h>g;g++){if(b(d[e].connections[g]))return}c&&c(d[e])}},V=function(a,b,c){b="block"===b;var d=null;c&&(d=function(a){a.setVisible(b,!0,!0)});var e=o(a);T(e.id,function(a){if(b&&c){var d=a.sourceId===e.id?1:0;a.endpoints[d].isVisible()&&a.setVisible(!0)}else a.setVisible(b)},d)},Z=function(a,b,c){if(d.isString(a))return a;if(null==a)return null;var e=h.getAttribute(a,"id");return e&&"undefined"!==e||(2==arguments.length&&void 0!==arguments[1]?e=b:(1==arguments.length||3==arguments.length&&!arguments[2])&&(e="jsPlumb_"+i+"_"+J()),c||h.setAttribute(a,"id",e)),e};this.setConnectionBeingDragged=function(a){D=a},this.isConnectionBeingDragged=function(){return D},this.getManagedElements=function(){return z},this.getRenderMode=function(){return"svg"},this.connectorClass="jsplumb-connector",this.connectorOutlineClass="jsplumb-connector-outline",this.editableConnectorClass="jsplumb-connector-editable",this.connectedClass="jsplumb-connected",this.hoverClass="jsplumb-hover",this.endpointClass="jsplumb-endpoint",this.endpointConnectedClass="jsplumb-endpoint-connected",this.endpointFullClass="jsplumb-endpoint-full",this.endpointDropAllowedClass="jsplumb-endpoint-drop-allowed",this.endpointDropForbiddenClass="jsplumb-endpoint-drop-forbidden",this.overlayClass="jsplumb-overlay",this.draggingClass="jsplumb-dragging",this.elementDraggingClass="jsplumb-element-dragging",this.sourceElementDraggingClass="jsplumb-source-element-dragging",this.targetElementDraggingClass="jsplumb-target-element-dragging",this.endpointAnchorClassPrefix="jsplumb-endpoint-anchor",this.hoverSourceClass="jsplumb-source-hover",this.hoverTargetClass="jsplumb-target-hover",this.dragSelectClass="jsplumb-drag-select",this.Anchors={},this.Connectors={svg:{}},this.Endpoints={svg:{}},this.Overlays={svg:{}},this.ConnectorRenderers={},this.SVG="svg",this.addEndpoint=function(a,b,c){c=c||{};var e=r.extend({},c);r.extend(e,b),e.endpoint=e.endpoint||h.Defaults.Endpoint,e.paintStyle=e.paintStyle||h.Defaults.EndpointStyle;for(var f=[],g=d.isArray(a)||null!=a.length&&!d.isString(a)?a:[a],i=0,j=g.length;j>i;i++){e.source=h.getElement(g[i]),ob(e.source);var k=Z(e.source),l=S(e,k),m=qb(k,e.source).info.o;d.addToList(x,k,l),F||l.paint({anchorLoc:l.anchor.compute({xy:[m.left,m.top],wh:E[k],element:l,timestamp:G}),timestamp:G}),f.push(l),l._doNotDeleteOnDetach=!0}return 1==f.length?f[0]:f},this.addEndpoints=function(a,b,c){for(var e=[],f=0,g=b.length;g>f;f++){var i=h.addEndpoint(a,b[f],c);d.isArray(i)?Array.prototype.push.apply(e,i):e.push(i)}return e},this.animate=function(a,b,c){if(!this.animationSupported)return!1;c=c||{};var e=h.getElement(a),f=Z(e),g=r.animEvents.step,i=r.animEvents.complete;c[g]=d.wrap(c[g],function(){h.revalidate(f)}),c[i]=d.wrap(c[i],function(){h.revalidate(f)}),h.doAnimate(e,b,c)},this.checkCondition=function(a){var b=h.getListener(a),c=!0;if(b&&b.length>0){var e=Array.prototype.slice.call(arguments,1);try{for(var f=0,g=b.length;g>f;f++)c=c&&b[f].apply(b[f],e)}catch(i){d.log(h,"cannot check condition ["+a+"]"+i)}}return c},this.connect=function(a,b){var c,e=P(a,b);if(e){if(null==e.source&&null==e.sourceEndpoint)return void d.log("Cannot establish connection - source does not exist");if(null==e.target&&null==e.targetEndpoint)return void d.log("Cannot establish connection - target does not exist");ob(e.source),c=Q(e),R(c,e)}return c};var $=[{el:"source",elId:"sourceId",epDefs:"sourceEndpointDefinitions"},{el:"target",elId:"targetId",epDefs:"targetEndpointDefinitions"}],_=function(a,b,c,d){var e,f,g,h=$[c],i=a[h.elId],j=(a[h.el],a.endpoints[c]),k={index:c,originalSourceId:0===c?i:a.sourceId,newSourceId:a.sourceId,originalTargetId:1==c?i:a.targetId,newTargetId:a.targetId,connection:a};if(b.constructor==r.Endpoint)(e=b).addConnection(a),b=e.element;else if(f=Z(b),g=this[h.epDefs][f],f===a[h.elId])e=null;else if(g)for(var l in g){if(!g[l].enabled)return;e=null!=g[l].endpoint&&g[l].endpoint._jsPlumb?g[l].endpoint:this.addEndpoint(b,g[l].def),g[l].uniqueEndpoint&&(g[l].endpoint=e),e._doNotDeleteOnDetach=!1,e._deleteOnDetach=!0,e.addConnection(a)}else(e=a.makeEndpoint(0===c,b,f))._doNotDeleteOnDetach=!1,e._deleteOnDetach=!0;return null!=e&&(j.detachFromConnection(a),a.endpoints[c]=e,a[h.el]=e.element,a[h.elId]=e.elementId,k[0===c?"newSourceId":"newTargetId"]=e.elementId,bb(k),d||a.repaint()),k.element=b,k}.bind(this);this.setSource=function(a,b,c){var d=_(a,b,0,c);this.anchorManager.sourceChanged(d.originalSourceId,d.newSourceId,a,d.el)},this.setTarget=function(a,b,c){var d=_(a,b,1,c);this.anchorManager.updateOtherEndpoint(d.originalSourceId,d.originalTargetId,d.newTargetId,a)},this.deleteEndpoint=function(a,b,c){var d="string"==typeof a?y[a]:a;return d&&h.deleteObject({endpoint:d,dontUpdateHover:b,deleteAttachedObjects:c}),h},this.deleteEveryEndpoint=function(){var a=h.setSuspendDrawing(!0);for(var b in x){var c=x[b];if(c&&c.length)for(var d=0,e=c.length;e>d;d++)h.deleteEndpoint(c[d],!0)}return x={},z={},y={},A={},B={},h.anchorManager.reset(),h.getDragManager().reset(),a||h.setSuspendDrawing(!1),h};var ab=function(a,b,c){var d=h.Defaults.ConnectionType||h.getDefaultConnectionType(),f=a.constructor==d?{connection:a,source:a.source,target:a.target,sourceId:a.sourceId,targetId:a.targetId,sourceEndpoint:a.endpoints[0],targetEndpoint:a.endpoints[1]}:a;b&&h.fire("connectionDetached",f,c),h.anchorManager.connectionDetached(f)},bb=h.fireMoveEvent=function(a,b){h.fire("connectionMoved",a,b)};this.unregisterEndpoint=function(a){for(var b in a._jsPlumb.uuid&&(y[a._jsPlumb.uuid]=null),h.anchorManager.deleteEndpoint(a),x){var c=x[b];if(c){for(var d=[],e=0,f=c.length;f>e;e++)c[e]!=a&&d.push(c[e]);x[b]=d}x[b].length<1&&delete x[b]}},this.detach=function(){if(0!==arguments.length){var a=h.Defaults.ConnectionType||h.getDefaultConnectionType(),b=arguments[0].constructor==a,c=2==arguments.length&&b?arguments[1]||{}:arguments[0],e=!1!==c.fireEvent,f=c.forceDetach,g=b?arguments[0]:c.connection,i=b?null:c.deleteAttachedObjects;if(g)(f||d.functionChain(!0,!1,[[g.endpoints[0],"isDetachAllowed",[g]],[g.endpoints[1],"isDetachAllowed",[g]],[g,"isDetachAllowed",[g]],[h,"checkCondition",["beforeDetach",g]]]))&&g.endpoints[0].detach({connection:g,ignoreTarget:!1,forceDetach:!0,fireEvent:e,deleteAttachedObjects:i});else{var j=r.extend({},c);if(j.uuids)M(j.uuids[0]).detachFrom(M(j.uuids[1]),e);else if(j.sourceEndpoint&&j.targetEndpoint)j.sourceEndpoint.detachFrom(j.targetEndpoint);else{var k=Z(h.getElement(j.source)),l=Z(h.getElement(j.target));T(k,function(a){(a.sourceId==k&&a.targetId==l||a.targetId==k&&a.sourceId==l)&&h.checkCondition("beforeDetach",a)&&a.endpoints[0].detach({connection:a,ignoreTarget:!1,forceDetach:!0,fireEvent:e})})}}}},this.detachAllConnections=function(a,b){b=b||{},a=h.getElement(a);var c=Z(a),d=x[c];if(d&&d.length)for(var e=0,f=d.length;f>e;e++)d[e].detachAll(!1!==b.fireEvent,b.forceDetach);return h},this.detachEveryConnection=function(a){return a=a||{},h.batch(function(){for(var b in x){var c=x[b];if(c&&c.length)for(var d=0,e=c.length;e>d;d++)c[d].detachAll(!1!==a.fireEvent,a.forceDetach)}w.length=0}),h},this.deleteObject=function(a){var b={endpoints:{},connections:{},endpointCount:0,connectionCount:0},c=(a.fireEvent,!1!==a.deleteAttachedObjects),e=function(d){if(null!=d&&null==b.connections[d.id]&&(a.dontUpdateHover||null==d._jsPlumb||d.setHover(!1),b.connections[d.id]=d,b.connectionCount++,c))for(var e=0;e<d.endpoints.length;e++)d.endpoints[e]._deleteOnDetach&&f(d.endpoints[e])},f=function(d){if(null!=d&&null==b.endpoints[d.id]&&(a.dontUpdateHover||null==d._jsPlumb||d.setHover(!1),b.endpoints[d.id]=d,b.endpointCount++,c))for(var f=0;f<d.connections.length;f++){var g=d.connections[f];e(g)}};for(var g in a.connection?e(a.connection):f(a.endpoint),b.connections){var i=b.connections[g];if(i._jsPlumb){d.removeWithFunction(w,function(a){return i.id==a.id}),ab(i,!1!==a.fireEvent&&!i.pending,a.originalEvent);var j=null==a.deleteAttachedObjects?null:!a.deleteAttachedObjects;i.endpoints[0].detachFromConnection(i,null,j),i.endpoints[1].detachFromConnection(i,null,j),i.cleanup(!0),i.destroy(!0)}}for(var k in b.endpoints){var l=b.endpoints[k];l._jsPlumb&&(h.unregisterEndpoint(l),l.cleanup(!0),l.destroy(!0))}return b},this.draggable=function(a,b){var c;return k(function(a){(c=o(a)).el&&function(a,b,c,e,f){if(!r.headless&&null!=b&&b&&r.isDragSupported(a,h)){var i=c||h.Defaults.DragOptions;if(i=r.extend({},i),r.isAlreadyDraggable(a,h))c.force&&h.initDraggable(a,i);else{var j=r.dragEvents.drag,k=r.dragEvents.stop,l=r.dragEvents.start,m=h.getElement(a),n=h.getDragManager().getDragAncestor(m),o={left:0,top:0},p=o,q=!1;qb(e,a),i[l]=d.wrap(i[l],function(){return p=null!=n?h.getOffset(n):o,h.setHoverSuspended(!0),h.select({source:a}).addClass(h.elementDraggingClass+" "+h.sourceElementDraggingClass,!0),h.select({target:a}).addClass(h.elementDraggingClass+" "+h.targetElementDraggingClass,!0),h.setConnectionBeingDragged(!0),i.canDrag?c.canDrag():void 0},!1),i[j]=d.wrap(i[j],function(){var b=h.getUIPosition(arguments,h.getZoom());null!=b&&(b.left+=p.left,b.top+=p.top,L(a,b,null,!0),q&&h.addClass(a,"jsplumb-dragged"),q=!0)}),i[k]=d.wrap(i[k],function(){for(var a=arguments[0].selection,b=h.getUIPosition(arguments),c=function(a){null!=b&&L(a[0],b),h.removeClass(a[0],"jsplumb-dragged"),h.select({source:a[0]}).removeClass(h.elementDraggingClass+" "+h.sourceElementDraggingClass,!0),h.select({target:a[0]}).removeClass(h.elementDraggingClass+" "+h.targetElementDraggingClass,!0),h.getDragManager().dragEnded(a[0])},d=0;d<a.length;d++)c(a[d]);q=!1,h.setHoverSuspended(!1),h.setConnectionBeingDragged(!1)});var s=Z(a);C[s]=!0;var t=C[s];i.disabled=null!=t&&!t,h.initDraggable(a,i),h.getDragManager().register(a),f&&h.fire("elementDraggable",{el:a,options:i})}}}(c.el,!0,b,c.id,!0)},a),h},this.droppable=function(a,b){var c;return(b=b||{}).allowLoopback=!1,k(function(a){(c=o(a)).el&&h.initDroppable(c.el,b)},a),h};var eb=function(a,b,c){return function(){return function(a,b,c,d){for(var e=0,f=a.length;f>e;e++)a[e][b].apply(a[e],c);return d(a)}(a,b,arguments,c)}},fb=function(a,b){return function(){return function(a,b,c){for(var d=[],e=0,f=a.length;f>e;e++)d.push([a[e][b].apply(a[e],c),a[e]]);return d}(a,b,arguments)}},gb=function(a,b){var c=[];if(a)if("string"==typeof a){if("*"===a)return a;c.push(a)}else if(b)c=a;else if(a.length)for(var d=0,e=a.length;e>d;d++)c.push(o(a[d]).id);else c.push(o(a).id);return c},hb=function(a,b,c){return"*"===a||(a.length>0?-1!=a.indexOf(b):!c)};this.getConnections=function(a,b){a?a.constructor==String&&(a={scope:a}):a={};for(var c=a.scope||h.getDefaultScope(),d=gb(c,!0),e=gb(a.source),f=gb(a.target),g=!b&&d.length>1?{}:[],i=function(a,c){if(!b&&d.length>1){var e=g[a];null==e&&(e=g[a]=[]),e.push(c)}else g.push(c)},j=0,k=w.length;k>j;j++){var l=w[j],m=l.proxies&&l.proxies[0]?l.proxies[0].originalEp.elementId:l.sourceId,n=l.proxies&&l.proxies[1]?l.proxies[1].originalEp.elementId:l.targetId;hb(d,l.scope)&&hb(e,m)&&hb(f,n)&&i(l.scope,l)}return g};var kb=function(a,b){var c,d,e={length:a.length,each:function(a,b){return function(c){for(var d=0,e=a.length;e>d;d++)c(a[d]);return b(a)}}(a,b),get:function(a){return function(b){return a[b]}}(a)},f=["setHover","removeAllOverlays","setLabel","addClass","addOverlay","removeOverlay","removeOverlays","showOverlay","hideOverlay","showOverlays","hideOverlays","setPaintStyle","setHoverPaintStyle","setSuspendEvents","setParameter","setParameters","setVisible","repaint","addType","toggleType","removeType","removeClass","setType","bind","unbind"],g=["getLabel","getOverlay","isHover","getParameter","getParameters","getPaintStyle","getHoverPaintStyle","isVisible","hasType","getType","isSuspendEvents"];for(c=0,d=f.length;d>c;c++)e[f[c]]=eb(a,f[c],b);for(c=0,d=g.length;d>c;c++)e[g[c]]=fb(a,g[c]);return e},lb=function(a){var b=kb(a,lb);return r.extend(b,{setDetachable:eb(a,"setDetachable",lb),setReattach:eb(a,"setReattach",lb),setConnector:eb(a,"setConnector",lb),detach:function(){for(var b=0,c=a.length;c>b;b++)h.detach(a[b])},isDetachable:fb(a,"isDetachable"),isReattach:fb(a,"isReattach")})},mb=function(a){var b=kb(a,mb);return r.extend(b,{setEnabled:eb(a,"setEnabled",mb),setAnchor:eb(a,"setAnchor",mb),isEnabled:fb(a,"isEnabled"),detachAll:function(){for(var b=0,c=a.length;c>b;b++)a[b].detachAll()},remove:function(){for(var b=0,c=a.length;c>b;b++)h.deleteObject({endpoint:a[b]})}})};this.select=function(a){return(a=a||{}).scope=a.scope||"*",lb(a.connections||h.getConnections(a,!0))},this.selectEndpoints=function(a){(a=a||{}).scope=a.scope||"*";var b=!a.element&&!a.source&&!a.target,c=b?"*":gb(a.element),d=b?"*":gb(a.source),e=b?"*":gb(a.target),f=gb(a.scope,!0),g=[];for(var h in x){var i=hb(c,h,!0),j=hb(d,h,!0),k="*"!=d,l=hb(e,h,!0),m="*"!=e;if(i||j||l)a:for(var n=0,o=x[h].length;o>n;n++){var p=x[h][n];if(hb(f,p.scope,!0)){var q=k&&d.length>0&&!p.isSource,r=m&&e.length>0&&!p.isTarget;if(q||r)continue a;g.push(p)}}}return mb(g)},this.getAllConnections=function(){return w},this.getDefaultScope=function(){return H},this.getEndpoint=M,this.getEndpoints=function(a){return x[o(a).id]},this.getDefaultEndpointType=function(){return r.Endpoint},this.getDefaultConnectionType=function(){return r.Connection},this.getId=Z,this.appendElement=K;var nb=!1;this.isHoverSuspended=function(){return nb},this.setHoverSuspended=function(a){nb=a},this.hide=function(a,b){return V(a,"none",b),h},this.idstamp=J,this.connectorsInitialized=!1,this.registerConnectorType=function(a,b){c.push([a,b])};var ob=function(a){if(!s&&a){var b=h.getElement(a);b.offsetParent&&h.setContainer(b.offsetParent)}},qb=h.manage=function(a,b,c){return z[a]||(z[a]={el:b,endpoints:[],connections:[]},z[a].info=rb({elId:a,timestamp:G}),c||h.fire("manageElement",{id:a,info:z[a].info,el:b})),z[a]},rb=this.updateOffset=function(a){var b,c=a.timestamp,d=a.recalc,e=a.offset,f=a.elId;return F&&!c&&(c=G),!d&&c&&c===B[f]?{o:a.offset||A[f],s:E[f]}:(d||!e&&null==A[f]?null!=(b=z[f]?z[f].el:null)&&(E[f]=h.getSize(b),A[f]=h.getOffset(b),B[f]=c):(A[f]=e||A[f],null==E[f]&&(null!=(b=z[f].el)&&(E[f]=h.getSize(b))),B[f]=c),A[f]&&!A[f].right&&(A[f].right=A[f].left+E[f][0],A[f].bottom=A[f].top+E[f][1],A[f].width=E[f][0],A[f].height=E[f][1],A[f].centerx=A[f].left+A[f].width/2,A[f].centery=A[f].top+A[f].height/2),{o:A[f],s:E[f]})};this.init=function(){a=b.jsPlumb.getRenderModes();var e=function(a,c,e){b.jsPlumb.Connectors[a][c]=function(){e.apply(this,arguments),b.jsPlumb.ConnectorRenderers[a].apply(this,arguments)},d.extend(b.jsPlumb.Connectors[a][c],[e,b.jsPlumb.ConnectorRenderers[a]])};if(!b.jsPlumb.connectorsInitialized){for(var f=0;f<c.length;f++)for(var g=0;g<a.length;g++)e(a[g],c[f][1],c[f][0]);b.jsPlumb.connectorsInitialized=!0}v||(h.Defaults.Container&&h.setContainer(h.Defaults.Container),h.anchorManager=new b.jsPlumb.AnchorManager({jsPlumbInstance:h}),v=!0,h.fire("ready",h))}.bind(this),this.log=u,this.jsPlumbUIComponent=m,this.makeAnchor=function(){var a,c=function(a,c){if(b.jsPlumb.Anchors[a])return new b.jsPlumb.Anchors[a](c);if(!h.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown anchor type '"+a+"'"}};if(0===arguments.length)return null;var e=arguments[0],f=arguments[1],g=(arguments[2],null);if(e.compute&&e.getOrientation)return e;if("string"==typeof e)g=c(arguments[0],{elementId:f,jsPlumbInstance:h});else if(d.isArray(e))if(d.isArray(e[0])||d.isString(e[0]))2==e.length&&d.isObject(e[1])?d.isString(e[0])?(a=b.jsPlumb.extend({elementId:f,jsPlumbInstance:h},e[1]),g=c(e[0],a)):(a=b.jsPlumb.extend({elementId:f,jsPlumbInstance:h,anchors:e[0]},e[1]),g=new b.jsPlumb.DynamicAnchor(a)):g=new r.DynamicAnchor({anchors:e,selector:null,elementId:f,jsPlumbInstance:h});else{var i={x:e[0],y:e[1],orientation:e.length>=4?[e[2],e[3]]:[0,0],offsets:e.length>=6?[e[4],e[5]]:[0,0],elementId:f,jsPlumbInstance:h,cssClass:7==e.length?e[6]:null};(g=new b.jsPlumb.Anchor(i)).clone=function(){return new b.jsPlumb.Anchor(i)}}return g.id||(g.id="anchor_"+J()),g},this.makeAnchors=function(a,c,e){for(var f=[],g=0,i=a.length;i>g;g++)"string"==typeof a[g]?f.push(b.jsPlumb.Anchors[a[g]]({elementId:c,jsPlumbInstance:e})):d.isArray(a[g])&&f.push(h.makeAnchor(a[g],c,e));return f},this.makeDynamicAnchor=function(a,c){return new b.jsPlumb.DynamicAnchor({anchors:a,selector:c,elementId:null,jsPlumbInstance:h})},this.targetEndpointDefinitions={};this.sourceEndpointDefinitions={};var ub=function(a,c,e,f,g){var i=new m(c),j=c._jsPlumb.EndpointDropHandler({jsPlumb:h,enabled:function(){return a.def.enabled},isFull:function(){var b=h.select({target:a.id}).length;return a.def.maxConnections>0&&b>=a.def.maxConnections},element:a.el,elementId:a.id,isSource:f,isTarget:g,addClass:function(b){h.addClass(a.el,b)},removeClass:function(b){h.removeClass(a.el,b)},onDrop:function(a){a.endpoints[0].anchor.locked=!1},isDropAllowed:function(){return i.isDropAllowed.apply(i,arguments)},isRedrop:function(b){return null!=b.suspendedElement&&null!=b.suspendedEndpoint&&b.suspendedEndpoint.element===a.el},getEndpoint:function(d){var e=a.def.endpoint;if(null==e||null==e._jsPlumb){var f=h.deriveEndpointAndAnchorSpec(d.getType().join(" "),!0),g=f.endpoints?b.jsPlumb.extend(c,{endpoint:a.def.def.endpoint||f.endpoints[1]}):c;f.anchors&&(g=b.jsPlumb.extend(g,{anchor:a.def.def.anchor||f.anchors[1]})),(e=h.addEndpoint(a.el,g))._mtNew=!0}if(c.uniqueEndpoint&&(a.def.endpoint=e),e._doNotDeleteOnDetach=!1,e._deleteOnDetach=!0,d.isDetachable()&&e.initDraggable(),null!=e.anchor.positionFinder){var i=h.getUIPosition(arguments,h.getZoom()),j=h.getOffset(a.el),k=h.getSize(a.el),l=null==i?[0,0]:e.anchor.positionFinder(i,j,k,e.anchor.constructorParams);e.anchor.x=l[0],e.anchor.y=l[1]}return e},maybeCleanup:function(a){a._mtNew&&0===a.connections.length?h.deleteObject({endpoint:a}):delete a._mtNew}}),k=b.jsPlumb.dragEvents.drop;return e.scope=e.scope||c.scope||h.Defaults.Scope,e[k]=d.wrap(e[k],j,!0),g&&(e[b.jsPlumb.dragEvents.over]=function(){return!0}),!1===c.allowLoopback&&(e.canDrop=function(b){return b.getDragElement()._jsPlumbRelatedElement!=a.el}),h.initDroppable(a.el,e,"internal"),j};this.makeTarget=function(a,c,d){var e=b.jsPlumb.extend({_jsPlumb:this},d);b.jsPlumb.extend(e,c);for(var f=(e.deleteEndpointsOnDetach,e.maxConnections||-1),g=function(a){var c=o(a),d=c.id,g=b.jsPlumb.extend({},e.dropOptions||{});this.targetEndpointDefinitions[d]=this.targetEndpointDefinitions[d]||{},ob(d);var i={def:b.jsPlumb.extend({},e),uniqueEndpoint:e.uniqueEndpoint,maxConnections:f,enabled:!0};c.def=i,this.targetEndpointDefinitions[d].default=i,ub(c,e,g,!0===e.isSource,!0),c.el._katavorioDrop[c.el._katavorioDrop.length-1].targetDef=i}.bind(this),h=a.length&&a.constructor!=String?a:[a],i=0,j=h.length;j>i;i++)g(h[i]);return this},this.unmakeTarget=function(a,b){var c=o(a);return h.destroyDroppable(c.el,"internal"),b||delete this.targetEndpointDefinitions[c.id],this},this.makeSource=function(a,c,e){var f=b.jsPlumb.extend({_jsPlumb:this},e);b.jsPlumb.extend(f,c);var g=f.connectionType||"default",i=h.deriveEndpointAndAnchorSpec(g);f.endpoint=f.endpoint||i.endpoints[0],f.anchor=f.anchor||i.anchors[0];for(var j=f.maxConnections||-1,k=f.onMaxConnections,l=function(a){var c=a.id,e=this.getElement(a.el);this.sourceEndpointDefinitions[c]=this.sourceEndpointDefinitions[c]||{},ob(c);var i={def:b.jsPlumb.extend({},f),uniqueEndpoint:f.uniqueEndpoint,maxConnections:j,enabled:!0};this.sourceEndpointDefinitions[c][g]=i,a.def=i;var l=b.jsPlumb.dragEvents.stop,m=b.jsPlumb.dragEvents.drag,o=b.jsPlumb.extend({},f.dragOptions||{}),p=o.drag,q=o.stop,r=null,s=!1;o.scope=o.scope||f.scope,o[m]=d.wrap(o[m],function(){p&&p.apply(this,arguments),s=!1}),o[l]=d.wrap(o[l],function(){if(q&&q.apply(this,arguments),this.currentlyDragging=!1,null!=r._jsPlumb){var a=f.anchor||this.Defaults.Anchor,b=r.anchor,d=r.connections[0],e=this.makeAnchor(a,c,this),g=r.element;if(null!=e.positionFinder){var i=h.getOffset(g),j=this.getSize(g),k={left:i.left+b.x*j[0],top:i.top+b.y*j[1]},l=e.positionFinder(k,i,j,e.constructorParams);e.x=l[0],e.y=l[1]}r.setAnchor(e,!0),r.repaint(),this.repaint(r.elementId),null!=d&&this.repaint(d.targetId)}}.bind(this));var t=function(i){if(3!==i.which&&2!==i.button){var l=this.sourceEndpointDefinitions[c][g];if(l.enabled){if(c=this.getId(this.getElement(a.el)),f.filter)if(!1===(d.isString(f.filter)?function(a,b,c,d,e){for(var f=a.target||a.srcElement,g=!1,h=d.getSelector(b,c),i=0;i<h.length;i++)if(h[i]==f){g=!0;break}return e?!g:g}(i,a.el,f.filter,this,f.filterExclude):f.filter(i,a.el)))return;var p=this.select({source:c}).length;if(l.maxConnections>=0&&p>=l.maxConnections)return k&&k({element:a.el,maxConnections:j},i),!1;var q=b.jsPlumb.getPositionOnElement(i,e,n),t={};b.jsPlumb.extend(t,f),t.isTemporarySource=!0,t.anchor=[q[0],q[1],0,0],t.dragOptions=o,l.def.scope&&(t.scope=l.def.scope),r=this.addEndpoint(c,t),s=!0,r._doNotDeleteOnDetach=!1,r._deleteOnDetach=!0,l.uniqueEndpoint&&(l.endpoint?r.finalEndpoint=l.endpoint:(l.endpoint=r,r._deleteOnDetach=!1,r._doNotDeleteOnDetach=!0));var u=function(){h.off(r.canvas,"mouseup",u),h.off(a.el,"mouseup",u),s&&(s=!1,h.deleteEndpoint(r))};h.on(r.canvas,"mouseup",u),h.on(a.el,"mouseup",u);var v={};if(l.def.extract)for(var w in l.def.extract){var x=(i.srcElement||i.target).getAttribute(w);x&&(v[l.def.extract[w]]=x)}h.trigger(r.canvas,"mousedown",i,v),d.consume(i)}}}.bind(this);this.on(a.el,"mousedown",t),i.trigger=t,f.filter&&(d.isString(f.filter)||d.isFunction(f.filter))&&h.setDragFilter(a.el,f.filter);var u=b.jsPlumb.extend({},f.dropOptions||{});ub(a,f,u,!0,!0===f.isTarget)}.bind(this),m=a.length&&a.constructor!=String?a:[a],p=0,q=m.length;q>p;p++)l(o(m[p]));return this},this.unmakeSource=function(a,b,c){var d=o(a);h.destroyDroppable(d.el,"internal");var e=this.sourceEndpointDefinitions[d.id];if(e)for(var f in e)if(null==b||b===f){var g=e[f].trigger;g&&h.off(d.el,"mousedown",g),c||delete this.sourceEndpointDefinitions[d.id][f]}return this},this.unmakeEverySource=function(){for(var a in this.sourceEndpointDefinitions)h.unmakeSource(a,null,!0);return this.sourceEndpointDefinitions={},this};var vb=function(a,b,c){b=d.isArray(b)?b:[b];var e=Z(a);c=c||"default";for(var f=0;f<b.length;f++){var g=this[b[f]][e];if(g&&g[c])return g[c].def.scope||this.Defaults.Scope}}.bind(this),wb=function(a,b,c,e){c=d.isArray(c)?c:[c];var f=Z(a);e=e||"default";for(var g=0;g<c.length;g++){var h=this[c[g]][f];h&&h[e]&&(h[e].def.scope=b)}}.bind(this);this.getScope=function(a){return vb(a,["sourceEndpointDefinitions","targetEndpointDefinitions"])},this.getSourceScope=function(a){return vb(a,"sourceEndpointDefinitions")},this.getTargetScope=function(a){return vb(a,"targetEndpointDefinitions")},this.setScope=function(a,b,c){this.setSourceScope(a,b,c),this.setTargetScope(a,b,c)},this.setSourceScope=function(a,b,c){wb(a,b,"sourceEndpointDefinitions",c),this.setDragScope(a,b)},this.setTargetScope=function(a,b,c){wb(a,b,"targetEndpointDefinitions",c),this.setDropScope(a,b)},this.unmakeEveryTarget=function(){for(var a in this.targetEndpointDefinitions)h.unmakeTarget(a,!0);return this.targetEndpointDefinitions={},this};var xb=function(a,b,c,e,f){var g="source"==a?this.sourceEndpointDefinitions:this.targetEndpointDefinitions;if(f=f||"default",d.isString(b)&&g[b]&&g[b][f])g[b][f].enabled=e?!g[b][f].enabled:c;else if(b.length)for(var h=0,i=b.length;i>h;h++){var j=o(b[h]);g[j.id]&&g[j.id][f]&&(g[j.id][f].enabled=e?!g[j.id][f].enabled:c)}else{var k=o(b).id;g[k]&&g[k][f]&&(g[k][f].enabled=e?!g[k][f].enabled:c)}return this}.bind(this),yb=function(a,b){return d.isString(a)||!a.length?b.apply(this,[a]):a.length?b.apply(this,[a[0]]):void 0}.bind(this);this.toggleSourceEnabled=function(a,b){return xb("source",a,null,!0,b),this.isSourceEnabled(a,b)},this.setSourceEnabled=function(a,b,c){return xb("source",a,b,null,c)},this.isSource=function(a,b){return b=b||"default",yb(a,function(a){var c=this.sourceEndpointDefinitions[o(a).id];return null!=c&&null!=c[b]}.bind(this))},this.isSourceEnabled=function(a,b){return b=b||"default",yb(a,function(a){var c=this.sourceEndpointDefinitions[o(a).id];return c&&c[b]&&!0===c[b].enabled}.bind(this))},this.toggleTargetEnabled=function(a,b){return xb("target",a,null,!0,b),this.isTargetEnabled(a,b)},this.isTarget=function(a,b){return b=b||"default",yb(a,function(a){var c=this.targetEndpointDefinitions[o(a).id];return null!=c&&null!=c[b]}.bind(this))},this.isTargetEnabled=function(a,b){return b=b||"default",yb(a,function(a){var c=this.targetEndpointDefinitions[o(a).id];return c&&c[b]&&!0===c[b].enabled}.bind(this))},this.setTargetEnabled=function(a,b,c){return xb("target",a,b,null,c)},this.ready=function(a){h.bind("ready",a)};var zb=function(a,b){if("object"==typeof a&&a.length)for(var c=0,d=a.length;d>c;c++)b(a[c]);else b(a);return h};this.repaint=function(a,b,c){return zb(a,function(a){L(a,b,c)})},this.revalidate=function(a,b,c){return zb(a,function(a){var d=c?a:h.getId(a);h.updateOffset({elId:d,recalc:!0,timestamp:b}),h.repaint(a)})},this.repaintEverything=function(){var a,b=e();for(a in x)h.updateOffset({elId:a,recalc:!0,timestamp:b});for(a in x)L(a,null,b);return this},this.removeAllEndpoints=function(a,b,c){c=c||[];var d=function(a){var e,f,g=o(a),i=x[g.id];if(i)for(c.push(g),e=0,f=i.length;f>e;e++)h.deleteEndpoint(i[e],!1);if(delete x[g.id],b&&g.el&&3!=g.el.nodeType&&8!=g.el.nodeType)for(e=0,f=g.el.childNodes.length;f>e;e++)d(g.el.childNodes[e])};return d(a),this};var Ab=function(a,b){h.removeAllEndpoints(a.id,!0,b);for(var c=function(a){h.getDragManager().elementRemoved(a.id),h.anchorManager.clearFor(a.id),h.anchorManager.removeFloatingConnection(a.id),h.isSource(a.el)&&h.unmakeSource(a.el),h.isTarget(a.el)&&h.unmakeTarget(a.el),h.destroyDraggable(a.el),h.destroyDroppable(a.el),delete h.floatingConnections[a.id],delete z[a.id],delete A[a.id],a.el&&(h.removeElement(a.el),a.el._jsPlumb=null)},d=1;d<b.length;d++)c(b[d]);c(a)};this.remove=function(a,b){var c=o(a),d=[];return c.text?c.el.parentNode.removeChild(c.el):c.id&&h.batch(function(){Ab(c,d)},!1===b),h},this.empty=function(a,b){var c=[],d=function(a,b){var e=o(a);if(e.text)e.el.parentNode.removeChild(e.el);else if(e.el){for(;e.el.childNodes.length>0;)d(e.el.childNodes[0]);b||Ab(e,c)}};return h.batch(function(){d(a,!0)},!1===b),h},this.reset=function(){h.silently(function(){h.removeAllGroups(),h.removeGroupManager(),h.deleteEveryEndpoint(),h.unbind(),this.targetEndpointDefinitions={},this.sourceEndpointDefinitions={},w.length=0,this.doReset&&this.doReset()}.bind(this))};var Bb=function(a){a.canvas&&a.canvas.parentNode&&a.canvas.parentNode.removeChild(a.canvas),a.cleanup(),a.destroy()};this.clear=function(){h.select().each(Bb),h.selectEndpoints().each(Bb),x={},y={}},this.setDefaultScope=function(a){return H=a,h},this.setDraggable=function(a,b){return r.each(a,function(a){h.isDragSupported(a)&&(C[h.getAttribute(a,"id")]=b,h.setElementDraggable(a,b))})},this.deriveEndpointAndAnchorSpec=function(a,b){for(var c=((b?"":"default ")+a).split(/[\s]/),d=null,e=null,f=null,g=null,i=0;i<c.length;i++){var j=h.getType(c[i],"connection");j&&(j.endpoints&&(d=j.endpoints),j.endpoint&&(e=j.endpoint),j.anchors&&(g=j.anchors),j.anchor&&(f=j.anchor))}return{endpoints:d||[e,e],anchors:g||[f,f]}},this.setId=function(a,b,c){var e;d.isString(a)?e=a:(a=this.getElement(a),e=this.getId(a));var f=this.getConnections({source:e,scope:"*"},!0),g=this.getConnections({target:e,scope:"*"},!0);b=""+b,c?a=this.getElement(b):(a=this.getElement(e),this.setAttribute(a,"id",b)),x[b]=x[e]||[];for(var h=0,i=x[b].length;i>h;h++)x[b][h].setElementId(b),x[b][h].setReferenceElement(a);delete x[e],this.sourceEndpointDefinitions[b]=this.sourceEndpointDefinitions[e],delete this.sourceEndpointDefinitions[e],this.targetEndpointDefinitions[b]=this.targetEndpointDefinitions[e],delete this.targetEndpointDefinitions[e],this.anchorManager.changeId(e,b),this.getDragManager().changeId(e,b),z[b]=z[e],delete z[e];var j=function(c,d,e){for(var f=0,g=c.length;g>f;f++)c[f].endpoints[d].setElementId(b),c[f].endpoints[d].setReferenceElement(a),c[f][e+"Id"]=b,c[f][e]=a};j(f,0,"source"),j(g,1,"target"),this.repaint(b)},this.setDebugLog=function(a){u=a},this.setSuspendDrawing=function(a,b){var c=F;return F=a,G=a?(new Date).getTime():null,b&&this.repaintEverything(),c},this.isSuspendDrawing=function(){return F},this.getSuspendedAt=function(){return G},this.batch=function(a,b){var c=this.isSuspendDrawing();c||this.setSuspendDrawing(!0);try{a()}catch(e){d.log("Function run while suspended failed",e)}c||this.setSuspendDrawing(!1,!b)},this.doWhileSuspended=this.batch,this.getCachedData=function(a){var b=A[a];return b?{o:b,s:E[a]}:rb({elId:a})},this.timestamp=e,this.show=function(a,b){return V(a,"block",b),h},this.toggleVisible=function(a,b){var c=null;b&&(c=function(a){var b=a.isVisible();a.setVisible(!b)}),T(a,function(a){var b=a.isVisible();a.setVisible(!b)},c)},this.toggleDraggable=function(a){var b;return r.each(a,function(a){var c=h.getAttribute(a,"id");return b=!(b=null!=C[c]&&C[c]),C[c]=b,h.setDraggable(a,b),b}.bind(this)),b},this.addListener=this.bind};d.extend(b.jsPlumbInstance,d.EventGenerator,{setAttribute:function(a,b,c){this.setAttribute(a,b,c)},getAttribute:function(a,c){return this.getAttribute(b.jsPlumb.getElement(a),c)},convertToFullOverlaySpec:function(a){return d.isString(a)&&(a=[a,{}]),a[1].id=a[1].id||d.uuid(),a},registerConnectionType:function(a,c){if(this._connectionTypes[a]=b.jsPlumb.extend({},c),c.overlays){for(var d={},e=0;e<c.overlays.length;e++){var f=this.convertToFullOverlaySpec(c.overlays[e]);d[f[1].id]=f}this._connectionTypes[a].overlays=d}},registerConnectionTypes:function(a){for(var b in a)this.registerConnectionType(b,a[b])},registerEndpointType:function(a,c){if(this._endpointTypes[a]=b.jsPlumb.extend({},c),c.overlays){for(var d={},e=0;e<c.overlays.length;e++){var f=this.convertToFullOverlaySpec(c.overlays[e]);d[f[1].id]=f}this._endpointTypes[a].overlays=d}},registerEndpointTypes:function(a){for(var b in a)this.registerEndpointType(b,a[b])},getType:function(a,b){return"connection"===b?this._connectionTypes[a]:this._endpointTypes[a]},setIdChanged:function(a,b){this.setId(a,b,!0)},setParent:function(a,b){var c=this.getElement(a),d=this.getId(c),e=this.getElement(b),f=this.getId(e);c.parentNode.removeChild(c),e.appendChild(c),this.getDragManager().setParent(c,d,e,f)},extend:function(a,b,c){var d;if(c)for(d=0;d<c.length;d++)a[c[d]]=b[c[d]];else for(d in b)a[d]=b[d];return a},floatingConnections:{},getFloatingAnchorIndex:function(a){return a.endpoints[0].isFloating()?0:a.endpoints[1].isFloating()?1:-1}});var r=new q;b.jsPlumb=r,r.getInstance=function(a){var b=new q(a);return b.init(),b},r.each=function(a,b){if(null!=a)if("string"==typeof a)b(r.getElement(a));else if(null!=a.length)for(var c=0;c<a.length;c++)b(r.getElement(a[c]));else b(a)},"function"==typeof define&&(define("jsplumb",[],function(){return r}),define("jsplumbinstance",[],function(){return r.getInstance()})),"undefined"!=typeof exports&&(exports.jsPlumb=r),"undefined"!=typeof module&&(module.exports=r)}.call("undefined"!=typeof window?window:this),function(){var a=this,b=a.jsPlumbUtil,c=(!!window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),function(a,b){if(null==a)return[0,0];var c=h(a),d=g(c,0);return[d[b+"X"],d[b+"Y"]]}),g=function(a,b){return a.item?a.item(b):a[b]},h=function(a){return a.touches&&a.touches.length>0?a.touches:a.changedTouches&&a.changedTouches.length>0?a.changedTouches:a.targetTouches&&a.targetTouches.length>0?a.targetTouches:[a]},k=function(a,b){b=function(a){return null==a?null:a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}(b),void 0!==a.className.baseVal?a.className.baseVal=b:a.className=b},l=function(a){return void 0===a.className.baseVal?a.className:a.className.baseVal},m=function(a,c,d){c=null==c?[]:b.isArray(c)?c:c.split(/\s+/),d=null==d?[]:b.isArray(d)?d:d.split(/\s+/);var f=l(a).split(/\s+/),g=function(a,b){for(var c=0;c<b.length;c++)if(a)-1==f.indexOf(b[c])&&f.push(b[c]);else{var d=f.indexOf(b[c]);-1!=d&&f.splice(d,1)}};g(!0,c),g(!1,d),k(a,f.join(" "))};a.jsPlumb.extend(a.jsPlumbInstance.prototype,{headless:!1,pageLocation:function(a){return null==a?[0,0]:c(a,"page")},screenLocation:function(a){return c(a,"screen")},clientLocation:function(a){return c(a,"client")},getDragManager:function(){return null==this.dragManager&&(this.dragManager=new function(a){var b={},c=[],d={},e={},f={};this.register=function(g){var h=a.getId(g),i=a.getOffset(g);b[h]||(b[h]=g,c.push(g),d[h]={});var j=function(b){if(b)for(var c=0;c<b.childNodes.length;c++)if(3!=b.childNodes[c].nodeType&&8!=b.childNodes[c].nodeType){var g=jsPlumb.getElement(b.childNodes[c]),k=a.getId(b.childNodes[c],null,!0);if(k&&e[k]&&e[k]>0){var l=a.getOffset(g);d[h][k]={id:k,offset:{left:l.left-i.left,top:l.top-i.top}},f[k]=h}j(b.childNodes[c])}};j(g)},this.updateOffsets=function(b,c){if(null!=b){c=c||{};var e=jsPlumb.getElement(b),g=a.getId(e),h=d[g],i=a.getOffset(e);if(h)for(var j in h)if(h.hasOwnProperty(j)){var k=jsPlumb.getElement(j),l=c[j]||a.getOffset(k);if(null==k.offsetParent&&null!=d[g][j])continue;d[g][j]={id:j,offset:{left:l.left-i.left,top:l.top-i.top}},f[j]=g}}},this.endpointAdded=function(c,g){g=g||a.getId(c);var h=document.body,i=c.parentNode;for(e[g]=e[g]?e[g]+1:1;null!=i&&i!=h;){var j=a.getId(i,null,!0);if(j&&b[j]){var k=a.getOffset(i);if(null==d[j][g]){var l=a.getOffset(c);d[j][g]={id:g,offset:{left:l.left-k.left,top:l.top-k.top}},f[g]=j}break}i=i.parentNode}},this.endpointDeleted=function(a){if(e[a.elementId]&&(e[a.elementId]--,e[a.elementId]<=0))for(var b in d)d.hasOwnProperty(b)&&d[b]&&(delete d[b][a.elementId],delete f[a.elementId])},this.changeId=function(a,b){d[b]=d[a],d[a]={},f[b]=f[a],f[a]=null},this.getElementsForDraggable=function(a){return d[a]},this.elementRemoved=function(a){var b=f[a];b&&(delete d[b][a],delete f[a])},this.reset=function(){b={},c=[],d={},e={}},this.dragEnded=function(b){if(null!=b.offsetParent){var c=a.getId(b),d=f[c];d&&this.updateOffsets(d)}},this.setParent=function(b,c,e,g,h){var i=f[c];d[g]||(d[g]={});var j=a.getOffset(e),k=h||a.getOffset(b);i&&delete d[i][c],d[g][c]={id:c,offset:{left:k.left-j.left,top:k.top-j.top}},f[c]=g},this.clearParent=function(a,b){var c=f[b];c&&(delete d[c][b],delete f[b])},this.revalidateParent=function(b,c,d){var e=f[c];if(e){var g={};g[c]=d,this.updateOffsets(e,g),a.revalidate(e)}},this.getDragAncestor=function(b){var c=jsPlumb.getElement(b),d=a.getId(c),e=f[d];return e?jsPlumb.getElement(e):null}}(this)),this.dragManager},recalculateOffsets:function(a){this.getDragManager().updateOffsets(a)},createElement:function(a,b,c,d){return this.createElementNS(null,a,b,c,d)},createElementNS:function(a,b,c,d,e){var f,g=null==a?document.createElement(b):document.createElementNS(a,b);for(f in c=c||{})g.style[f]=c[f];for(f in d&&(g.className=d),e=e||{})g.setAttribute(f,""+e[f]);return g},getAttribute:function(a,b){return null!=a.getAttribute?a.getAttribute(b):null},setAttribute:function(a,b,c){null!=a.setAttribute&&a.setAttribute(b,c)},setAttributes:function(a,b){for(var c in b)b.hasOwnProperty(c)&&a.setAttribute(c,b[c])},appendToRoot:function(a){document.body.appendChild(a)},getRenderModes:function(){return["svg"]},getClass:l,addClass:function(a,b){jsPlumb.each(a,function(a){m(a,b)})},hasClass:function(a,b){return(a=jsPlumb.getElement(a)).classList?a.classList.contains(b):-1!=l(a).indexOf(b)},removeClass:function(a,b){jsPlumb.each(a,function(a){m(a,null,b)})},updateClasses:function(a,b,c){jsPlumb.each(a,function(a){m(a,b,c)})},setClass:function(a,b){jsPlumb.each(a,function(a){k(a,b)})},setPosition:function(a,b){a.style.left=b.left+"px",a.style.top=b.top+"px"},getPosition:function(a){var b=function(b){var c=a.style[b];return c?c.substring(0,c.length-2):0};return{left:b("left"),top:b("top")}},getStyle:function(a,b){return void 0!==window.getComputedStyle?getComputedStyle(a,null).getPropertyValue(b):a.currentStyle[b]},getSelector:function(a,b){return 1==arguments.length?null!=a.nodeType?a:document.querySelectorAll(a):a.querySelectorAll(b)},getOffset:function(a,b,c){a=jsPlumb.getElement(a),c=c||this.getContainer();for(var d={left:a.offsetLeft,top:a.offsetTop},e=b||null!=c&&a!=c&&a.offsetParent!=c?a.offsetParent:null,f=function(a){null!=a&&a!==document.body&&(a.scrollTop>0||a.scrollLeft>0)&&(d.left-=a.scrollLeft,d.top-=a.scrollTop)}.bind(this);null!=e;)d.left+=e.offsetLeft,d.top+=e.offsetTop,f(e),e=b?e.offsetParent:e.offsetParent==c?null:e.offsetParent;if(null!=c&&!b&&(c.scrollTop>0||c.scrollLeft>0)){var g=null!=a.offsetParent?this.getStyle(a.offsetParent,"position"):"static",h=this.getStyle(a,"position");"absolute"!==h&&"fixed"!==h&&"absolute"!==g&&"fixed"!=g&&(d.left-=c.scrollLeft,d.top-=c.scrollTop)}return d},getPositionOnElement:function(a,b,c){var d=void 0!==b.getBoundingClientRect?b.getBoundingClientRect():{left:0,top:0,width:0,height:0},e=document.body,f=document.documentElement,g=window.pageYOffset||f.scrollTop||e.scrollTop,h=window.pageXOffset||f.scrollLeft||e.scrollLeft,i=f.clientTop||e.clientTop||0,j=f.clientLeft||e.clientLeft||0,m=d.top+g-i+0*c,n=d.left+h-j+0*c,o=jsPlumb.pageLocation(a),p=d.width||b.offsetWidth*c,q=d.height||b.offsetHeight*c;return[(o[0]-n)/p,(o[1]-m)/q]},getAbsolutePosition:function(a){var b=function(b){var c=a.style[b];return c?parseFloat(c.substring(0,c.length-2)):void 0};return[b("left"),b("top")]},setAbsolutePosition:function(a,b,c,d){c?this.animate(a,{left:"+="+(b[0]-c[0]),top:"+="+(b[1]-c[1])},d):(a.style.left=b[0]+"px",a.style.top=b[1]+"px")},getSize:function(a){return[a.offsetWidth,a.offsetHeight]},getWidth:function(a){return a.offsetWidth},getHeight:function(a){return a.offsetHeight}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var a=this,b=a.jsPlumb,c=a.jsPlumbUtil,d="__label",e=function(a,c){var e={cssClass:c.cssClass,labelStyle:a.labelStyle,id:d,component:a,_jsPlumb:a._jsPlumb.instance},f=b.extend(e,c);return new(b.Overlays[a._jsPlumb.instance.getRenderMode()].Label)(f)},f=function(a,d){var e=null;if(c.isArray(d)){var f=d[0],g=b.extend({component:a,_jsPlumb:a._jsPlumb.instance},d[1]);3==d.length&&b.extend(g,d[2]),e=new(b.Overlays[a._jsPlumb.instance.getRenderMode()][f])(g)}else e=d.constructor==String?new(b.Overlays[a._jsPlumb.instance.getRenderMode()][d])({component:a,_jsPlumb:a._jsPlumb.instance}):d;return e.id=e.id||c.uuid(),a.cacheTypeItem("overlay",e,e.id),a._jsPlumb.overlays[e.id]=e,e};b.OverlayCapableJsPlumbUIComponent=function(b){a.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.overlays={},this._jsPlumb.overlayPositions={},b.label&&(this.getDefaultType().overlays[d]=["Label",{label:b.label,location:b.labelLocation||this.defaultLabelLocation||.5,labelStyle:b.labelStyle||this._jsPlumb.instance.Defaults.LabelStyle,id:d}]),this.setListenerComponent=function(a){if(this._jsPlumb)for(var b in this._jsPlumb.overlays)this._jsPlumb.overlays[b].setListenerComponent(a)}},b.OverlayCapableJsPlumbUIComponent.applyType=function(a,b){if(b.overlays){var c,d={};for(c in b.overlays){var e=a._jsPlumb.overlays[b.overlays[c][1].id];if(e)e.updateFrom(b.overlays[c][1]),d[b.overlays[c][1].id]=!0;else{var f=a.getCachedTypeItem("overlay",b.overlays[c][1].id);null!=f?(f.reattach(a._jsPlumb.instance),f.setVisible(!0),f.updateFrom(b.overlays[c][1]),a._jsPlumb.overlays[f.id]=f):f=a.addOverlay(b.overlays[c],!0),d[f.id]=!0}}for(c in a._jsPlumb.overlays)null==d[a._jsPlumb.overlays[c].id]&&a.removeOverlay(a._jsPlumb.overlays[c].id,!0)}},c.extend(b.OverlayCapableJsPlumbUIComponent,a.jsPlumbUIComponent,{setHover:function(a){if(this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged())for(var b in this._jsPlumb.overlays)this._jsPlumb.overlays[b][a?"addClass":"removeClass"](this._jsPlumb.instance.hoverClass)},addOverlay:function(a,b){var c=f(this,a);return b||this.repaint(),c},getOverlay:function(a){return this._jsPlumb.overlays[a]},getOverlays:function(){return this._jsPlumb.overlays},hideOverlay:function(a){var b=this.getOverlay(a);b&&b.hide()},hideOverlays:function(){for(var a in this._jsPlumb.overlays)this._jsPlumb.overlays[a].hide()},showOverlay:function(a){var b=this.getOverlay(a);b&&b.show()},showOverlays:function(){for(var a in this._jsPlumb.overlays)this._jsPlumb.overlays[a].show()},removeAllOverlays:function(a){for(var b in this._jsPlumb.overlays)this._jsPlumb.overlays[b].cleanup&&this._jsPlumb.overlays[b].cleanup();this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null,a||this.repaint()},removeOverlay:function(a,b){var c=this._jsPlumb.overlays[a];c&&(c.setVisible(!1),!b&&c.cleanup&&c.cleanup(),delete this._jsPlumb.overlays[a],this._jsPlumb.overlayPositions&&delete this._jsPlumb.overlayPositions[a])},removeOverlays:function(){for(var a=0,b=arguments.length;b>a;a++)this.removeOverlay(arguments[a])},moveParent:function(a){if(this.bgCanvas&&(this.bgCanvas.parentNode.removeChild(this.bgCanvas),a.appendChild(this.bgCanvas)),this.canvas&&this.canvas.parentNode)for(var b in this.canvas.parentNode.removeChild(this.canvas),a.appendChild(this.canvas),this._jsPlumb.overlays)if(this._jsPlumb.overlays[b].isAppendedAtTopLevel){var c=this._jsPlumb.overlays[b].getElement();c.parentNode.removeChild(c),a.appendChild(c)}},getLabel:function(){var a=this.getOverlay(d);return null!=a?a.getLabel():null},getLabelOverlay:function(){return this.getOverlay(d)},setLabel:function(a){var b=this.getOverlay(d);if(b)a.constructor==String||a.constructor==Function?b.setLabel(a):(a.label&&b.setLabel(a.label),a.location&&b.setLocation(a.location));else{var c=a.constructor==String||a.constructor==Function?{label:a}:a;b=e(this,c),this._jsPlumb.overlays[d]=b}this._jsPlumb.instance.isSuspendDrawing()||this.repaint()},cleanup:function(a){for(var b in this._jsPlumb.overlays)this._jsPlumb.overlays[b].cleanup(a),this._jsPlumb.overlays[b].destroy(a);a&&(this._jsPlumb.overlays={},this._jsPlumb.overlayPositions=null)},setVisible:function(a){this[a?"showOverlays":"hideOverlays"]()},setAbsoluteOverlayPosition:function(a,b){this._jsPlumb.overlayPositions[a.id]=b},getAbsoluteOverlayPosition:function(a){return this._jsPlumb.overlayPositions?this._jsPlumb.overlayPositions[a.id]:null},_clazzManip:function(a,b,c){if(!c)for(var d in this._jsPlumb.overlays)this._jsPlumb.overlays[d][a+"Class"](b)},addClass:function(a,b){this._clazzManip("add",a,b)},removeClass:function(a,b){this._clazzManip("remove",a,b)}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var a=this,b=a.jsPlumb,c=a.jsPlumbUtil,f=function(a,c,d,e,f,g,h,i){return h({paintStyle:a,endpoint:d,anchor:new b.FloatingAnchor({reference:c,referenceCanvas:e,jsPlumbInstance:g}),source:f,scope:i})},g=["connectorStyle","connectorHoverStyle","connectorOverlays","connector","connectionType","connectorClass","connectorHoverClass"];b.Endpoint=function(a){var i=a._jsPlumb,j=a.newConnection,k=a.newEndpoint;this.idPrefix="_jsplumb_e_",this.defaultLabelLocation=[.5,.5],this.defaultOverlayKeys=["Overlays","EndpointOverlays"],b.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.appendToDefaultType({connectionType:a.connectionType,maxConnections:null==a.maxConnections?this._jsPlumb.instance.Defaults.MaxConnections:a.maxConnections,paintStyle:a.endpointStyle||a.paintStyle||a.style||this._jsPlumb.instance.Defaults.EndpointStyle||b.Defaults.EndpointStyle,hoverPaintStyle:a.endpointHoverStyle||a.hoverPaintStyle||this._jsPlumb.instance.Defaults.EndpointHoverStyle||b.Defaults.EndpointHoverStyle,connectorStyle:a.connectorStyle,connectorHoverStyle:a.connectorHoverStyle,connectorClass:a.connectorClass,connectorHoverClass:a.connectorHoverClass,connectorOverlays:a.connectorOverlays,connector:a.connector,connectorTooltip:a.connectorTooltip}),this._jsPlumb.enabled=!(!1===a.enabled),this._jsPlumb.visible=!0,this.element=b.getElement(a.source),this._jsPlumb.uuid=a.uuid,this._jsPlumb.floatingEndpoint=null;this._jsPlumb.uuid&&(a.endpointsByUUID[this._jsPlumb.uuid]=this),this.elementId=a.elementId,this.dragProxy=a.dragProxy,this._jsPlumb.connectionCost=a.connectionCost,this._jsPlumb.connectionsDirected=a.connectionsDirected,this._jsPlumb.currentAnchorClass="",this._jsPlumb.events={};var m=function(){var a=i.endpointAnchorClassPrefix+"-"+this._jsPlumb.currentAnchorClass;this._jsPlumb.currentAnchorClass=this.anchor.getCssClass();var b=i.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");this.removeClass(a),this.addClass(b),jsPlumb.updateClasses(this.element,b,a)}.bind(this);this.prepareAnchor=function(a){var b=this._jsPlumb.instance.makeAnchor(a,this.elementId,i);return b.bind("anchorChanged",function(a){this.fire("anchorChanged",{endpoint:this,anchor:a}),m()}.bind(this)),b},this.setPreparedAnchor=function(a,b){return this._jsPlumb.instance.continuousAnchorFactory.clear(this.elementId),this.anchor=a,m(),b||this._jsPlumb.instance.repaint(this.elementId),this},this.setAnchor=function(a,b){var c=this.prepareAnchor(a);return this.setPreparedAnchor(c,b),this};var n=function(a){if(this.connections.length>0)for(var b=0;b<this.connections.length;b++)this.connections[b].setHover(a,!1);else this.setHover(a)}.bind(this);this.bind("mouseover",function(){n(!0)}),this.bind("mouseout",function(){n(!1)}),a._transient||this._jsPlumb.instance.anchorManager.add(this,this.elementId),this.prepareEndpoint=function(d,e){var f,g=function(a,c){var d=i.getRenderMode();if(b.Endpoints[d][a])return new b.Endpoints[d][a](c);if(!i.Defaults.DoNotThrowErrors)throw{msg:"jsPlumb: unknown endpoint type '"+a+"'"}},h={_jsPlumb:this._jsPlumb.instance,cssClass:a.cssClass,container:a.container,tooltip:a.tooltip,connectorTooltip:a.connectorTooltip,endpoint:this};return c.isString(d)?f=g(d,h):c.isArray(d)?(h=c.merge(d[1],h),f=g(d[0],h)):f=d.clone(),f.clone=function(){return c.isString(d)?g(d,h):c.isArray(d)?(h=c.merge(d[1],h),g(d[0],h)):void 0}.bind(this),f.typeId=e,f},this.setEndpoint=function(a){var b=this.prepareEndpoint(a);this.setPreparedEndpoint(b,!0)},this.setPreparedEndpoint=function(a){null!=this.endpoint&&(this.endpoint.cleanup(),this.endpoint.destroy()),this.endpoint=a,this.type=this.endpoint.type,this.canvas=this.endpoint.canvas},b.extend(this,a,g),this.isSource=a.isSource||!1,this.isTemporarySource=a.isTemporarySource||!1,this.isTarget=a.isTarget||!1,this.connections=a.connections||[],this.connectorPointerEvents=a["connector-pointer-events"],this.scope=a.scope||i.getDefaultScope(),this.timestamp=null,this.reattachConnections=a.reattach||i.Defaults.ReattachConnections,this.connectionsDetachable=i.Defaults.ConnectionsDetachable,(!1===a.connectionsDetachable||!1===a.detachable)&&(this.connectionsDetachable=!1),this.dragAllowedWhenFull=!1!==a.dragAllowedWhenFull,a.onMaxConnections&&this.bind("maxConnections",a.onMaxConnections),this.addConnection=function(a){this.connections.push(a),this[(this.connections.length>0?"add":"remove")+"Class"](i.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](i.endpointFullClass)},this.detachFromConnection=function(a,b,c){(b=null==b?this.connections.indexOf(a):b)>=0&&(this.connections.splice(b,1),this[(this.connections.length>0?"add":"remove")+"Class"](i.endpointConnectedClass),this[(this.isFull()?"add":"remove")+"Class"](i.endpointFullClass)),(this._forceDeleteOnDetach||!c&&this._deleteOnDetach)&&0===this.connections.length&&i.deleteObject({endpoint:this,fireEvent:!1,deleteAttachedObjects:!0!==c})},this.detach=function(a){var b=a.connectionIndex,c=a.connection,d=a.ignoreTarget,e=a.fireEvent,f=a.originalEvent,g=a.endpointBeingDeleted,h=a.forceDetach,k=!1;return e=!1!==e,(null==b?this.connections.indexOf(c):b)>=0&&(h||c._forceDetach||c.isDetachable()&&c.isDetachAllowed(c)&&this.isDetachAllowed(c)&&i.checkCondition("beforeDetach",c,g))&&(i.deleteObject({connection:c,fireEvent:!d&&e,originalEvent:f,deleteAttachedObjects:a.deleteAttachedObjects}),k=!0),k},this.detachAll=function(a,b){for(var c=[];this.connections.length>0;){this.detach({connection:this.connections[0],ignoreTarget:!1,forceDetach:!0===b,fireEvent:!1!==a,originalEvent:null,endpointBeingDeleted:this,connectionIndex:0})||(c.push(this.connections[0]),this.connections.splice(0,1))}return this.connections=c,this},this.detachFrom=function(a,b,c){for(var d=[],e=0;e<this.connections.length;e++)(this.connections[e].endpoints[1]==a||this.connections[e].endpoints[0]==a)&&d.push(this.connections[e]);for(var f=0;f<d.length;f++)this.detach({connection:d[f],ignoreTarget:!1,forceDetach:!0,fireEvent:b,originalEvent:c});return this},this.getElement=function(){return this.element},this.setElement=function(b){var d=this._jsPlumb.instance.getId(b),e=this.elementId;return c.removeWithFunction(a.endpointsByElement[this.elementId],function(a){return a.id==this.id}.bind(this)),this.element=jsPlumb.getElement(b),this.elementId=i.getId(this.element),i.anchorManager.rehomeEndpoint(this,e,this.element),i.dragManager.endpointAdded(this.element),c.addToList(a.endpointsByElement,d,this),this},this.makeInPlaceCopy=function(){var b=this.anchor.getCurrentLocation({element:this}),c=this.anchor.getOrientation(this),d=this.anchor.getCssClass(),e={bind:function(){},compute:function(){return[b[0],b[1]]},getCurrentLocation:function(){return[b[0],b[1]]},getOrientation:function(){return c},getCssClass:function(){return d}};return k({dropOptions:a.dropOptions,anchor:e,source:this.element,paintStyle:this.getPaintStyle(),endpoint:a.hideOnDrag?"Blank":this.endpoint,_transient:!0,scope:this.scope,reference:this})},this.connectorSelector=function(){var a=this.connections[0];return a||(this.connections.length<this._jsPlumb.maxConnections||-1==this._jsPlumb.maxConnections?null:a)},this.setStyle=this.setPaintStyle,this.paint=function(a){var b=(a=a||{}).timestamp,c=!(!1===a.recalc);if(!b||this.timestamp!==b){var d=i.updateOffset({elId:this.elementId,timestamp:b}),e=a.offset?a.offset.o:d.o;if(null!=e){var f=a.anchorPoint,g=a.connectorPaintStyle;if(null==f){var j=a.dimensions||d.s,k={xy:[e.left,e.top],wh:j,element:this,timestamp:b};if(c&&this.anchor.isDynamic&&this.connections.length>0){var l=function(a,b){var c=0;if(null!=b)for(var d=0;d<a.connections.length;d++)if(a.connections[d].sourceId==b||a.connections[d].targetId==b){c=d;break}return a.connections[c]}(this,a.elementWithPrecedence),m=l.endpoints[0]==this?1:0,n=0===m?l.sourceId:l.targetId,o=i.getCachedData(n),p=o.o,q=o.s;k.txy=[p.left,p.top],k.twh=q,k.tElement=l.endpoints[m]}f=this.anchor.compute(k)}for(var r in this.endpoint.compute(f,this.anchor.getOrientation(this),this._jsPlumb.paintStyleInUse,g||this.paintStyleInUse),this.endpoint.paint(this._jsPlumb.paintStyleInUse,this.anchor),this.timestamp=b,this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(r)){var s=this._jsPlumb.overlays[r];s.isVisible()&&(this._jsPlumb.overlayPlacements[r]=s.draw(this.endpoint,this._jsPlumb.paintStyleInUse),s.paint(this._jsPlumb.overlayPlacements[r]))}}}},this.getTypeDescriptor=function(){return"endpoint"},this.isVisible=function(){return this._jsPlumb.visible},this.repaint=this.paint;var o=!1;this.initDraggable=function(){if(!o&&b.isDragSupported(this.element)){var g,h={id:null,element:null},m=null,n=!1,p=null,q=function(a,b,c){var d=!1;return{drag:function(){if(d)return d=!1,!0;if(b.element){var e=c.getUIPosition(arguments,c.getZoom());null!=e&&jsPlumb.setPosition(b.element,e),c.repaint(b.element,e),a.paint({anchorPoint:a.anchor.getCurrentLocation({element:a.element})})}},stopDrag:function(){d=!0}}}(this,h,i),r=a.dragOptions||{},t=b.dragEvents.start,u=b.dragEvents.stop,v=b.dragEvents.drag,w=b.dragEvents.beforeStart,y=function(){m=this.connectorSelector();var b=!0;this.isEnabled()||(b=!1),null!=m||this.isSource||this.isTemporarySource||(b=!1),!this.isSource||!this.isFull()||null!=m&&this.dragAllowedWhenFull||(b=!1),null==m||m.isDetachable(this)||(b=!1);var d=i.checkCondition(null==m?"beforeDrag":"beforeStartDetach",{endpoint:this,source:this.element,sourceId:this.elementId,connection:m});if(!1===d?b=!1:"object"==typeof d?jsPlumb.extend(d,g||{}):d=g||{},!1===b)return i.stopDrag&&i.stopDrag(this.canvas),q.stopDrag(),!1;for(var l=0;l<this.connections.length;l++)this.connections[l].setHover(!1);this.addClass("endpointDrag"),i.setConnectionBeingDragged(!0),m&&!this.isFull()&&this.isSource&&(m=null),i.updateOffset({elId:this.elementId});var o=this._jsPlumb.instance.getOffset(this.canvas),r=this.canvas,s=this._jsPlumb.instance.getSize(this.canvas);(function(a,b,c,d){var e=jsPlumb.createElement("div",{position:"absolute"});b.appendElement(e);var f=b.getId(e);jsPlumb.setPosition(e,c),e.style.width=d[0]+"px",e.style.height=d[1]+"px",b.manage(f,e,!0),a.id=f,a.element=e})(h,i,o,s),i.setAttributes(this.canvas,{dragId:h.id,elId:this.elementId});var t=this.dragProxy||this.endpoint;if(null==this.dragProxy&&null!=this.connectionType){var u=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(this.connectionType);u.endpoints[1]&&(t=u.endpoints[1])}var v=this._jsPlumb.instance.makeAnchor("Center");v.isFloating=!0,this._jsPlumb.floatingEndpoint=f(this.getPaintStyle(),v,t,this.canvas,h.element,i,k,this.scope);var w=this._jsPlumb.floatingEndpoint.anchor;if(null==m)this.setHover(!1,!1),(m=j({sourceEndpoint:this,targetEndpoint:this._jsPlumb.floatingEndpoint,source:this.element,target:h.element,anchors:[this.anchor,this._jsPlumb.floatingEndpoint.anchor],paintStyle:a.connectorStyle,hoverPaintStyle:a.connectorHoverStyle,connector:a.connector,overlays:a.connectorOverlays,type:this.connectionType,cssClass:this.connectorClass,hoverClass:this.connectorHoverClass,scope:a.scope,data:d})).pending=!0,m.addClass(i.draggingClass),this._jsPlumb.floatingEndpoint.addClass(i.draggingClass),this._jsPlumb.floatingEndpoint.anchor=w,i.fire("connectionDrag",m),i.anchorManager.newConnection(m);else{n=!0,m.setHover(!1);var x=m.endpoints[0].id==this.id?0:1;this.detachFromConnection(m,null,!0);var y=i.getDragScope(r);i.setAttribute(this.canvas,"originalScope",y),i.fire("connectionDrag",m),0===x?(p=[m.source,m.sourceId,r,y],i.anchorManager.sourceChanged(m.endpoints[x].elementId,h.id,m,h.element)):(p=[m.target,m.targetId,r,y],m.target=h.element,m.targetId=h.id,i.anchorManager.updateOtherEndpoint(m.sourceId,m.endpoints[x].elementId,m.targetId,m)),m.suspendedEndpoint=m.endpoints[x],m.suspendedElement=m.endpoints[x].getElement(),m.suspendedElementId=m.endpoints[x].elementId,m.suspendedElementType=0===x?"source":"target",m.suspendedEndpoint.setHover(!1),this._jsPlumb.floatingEndpoint.referenceEndpoint=m.suspendedEndpoint,m.endpoints[x]=this._jsPlumb.floatingEndpoint,m.addClass(i.draggingClass),this._jsPlumb.floatingEndpoint.addClass(i.draggingClass)}i.floatingConnections[h.id]=m,c.addToList(a.endpointsByElement,h.id,this._jsPlumb.floatingEndpoint),i.currentlyDragging=!0}.bind(this),z=function(){if(i.setConnectionBeingDragged(!1),m&&null!=m.endpoints){var a=i.getDropEvent(arguments),b=i.getFloatingAnchorIndex(m);if(m.endpoints[0===b?1:0].anchor.locked=!1,m.removeClass(i.draggingClass),this._jsPlumb&&(m.deleteConnectionNow||m.endpoints[b]==this._jsPlumb.floatingEndpoint)&&n&&m.suspendedEndpoint){0===b?(m.floatingElement=m.source,m.floatingId=m.sourceId,m.floatingEndpoint=m.endpoints[0],m.floatingIndex=0,m.source=p[0],m.sourceId=p[1]):(m.floatingElement=m.target,m.floatingId=m.targetId,m.floatingEndpoint=m.endpoints[1],m.floatingIndex=1,m.target=p[0],m.targetId=p[1]);var c=this._jsPlumb.floatingEndpoint;i.setDragScope(p[2],p[3]),m.endpoints[b]=m.suspendedEndpoint,m.isReattach()||m._forceReattach||m._forceDetach||!m.endpoints[0===b?1:0].detach({connection:m,ignoreTarget:!1,forceDetach:!1,fireEvent:!0,originalEvent:a,endpointBeingDeleted:!0})?(m.setHover(!1),m._forceDetach=null,m._forceReattach=null,this._jsPlumb.floatingEndpoint.detachFromConnection(m),m.suspendedEndpoint.addConnection(m),1==b?i.anchorManager.updateOtherEndpoint(m.sourceId,m.floatingId,m.targetId,m):i.anchorManager.sourceChanged(m.floatingId,m.sourceId,m,m.source),i.repaint(p[1])):i.deleteObject({endpoint:c})}this.deleteAfterDragStop?i.deleteObject({endpoint:this}):this._jsPlumb&&this.paint({recalc:!1}),i.fire("connectionDragStop",m,a),m.pending&&i.fire("connectionAborted",m,a),i.currentlyDragging=!1,m.suspendedElement=null,m.suspendedEndpoint=null,m=null}h&&h.element&&i.remove(h.element,!1,!1),this._jsPlumb&&(this.canvas.style.visibility="visible",this.anchor.locked=!1,this._jsPlumb.floatingEndpoint=null)}.bind(this);(r=b.extend({},r)).scope=this.scope||r.scope,r[w]=c.wrap(r[w],function(a){g=a.e.payload||{}},!1),r[t]=c.wrap(r[t],y,!1),r[v]=c.wrap(r[v],q.drag),r[u]=c.wrap(r[u],z),r.multipleDrop=!1,r.canDrag=function(){return this.isSource||this.isTemporarySource||this.connections.length>0}.bind(this),i.initDraggable(this.canvas,r,"internal"),this.canvas._jsPlumbRelatedElement=this.element,o=!0}};var p=a.endpoint||this._jsPlumb.instance.Defaults.Endpoint||b.Defaults.Endpoint;this.setEndpoint(p,!0);var q=a.anchor?a.anchor:a.anchors?a.anchors:i.Defaults.Anchor||"Top";this.setAnchor(q,!0);var r=["default",a.type||""].join(" ");this.addType(r,a.data,!0),this.canvas=this.endpoint.canvas,this.canvas._jsPlumb=this,this.initDraggable();var s=function(d,e,f,g){if(b.isDropSupported(this.element)){var h=a.dropOptions||i.Defaults.DropOptions||b.Defaults.DropOptions;(h=b.extend({},h)).scope=h.scope||this.scope;var j=b.dragEvents.drop,k=b.dragEvents.over,l=b.dragEvents.out,m=this,n=i.EndpointDropHandler({getEndpoint:function(){return m},jsPlumb:i,enabled:function(){return null==f||f.isEnabled()},isFull:function(){return f.isFull()},element:this.element,elementId:this.elementId,isSource:this.isSource,isTarget:this.isTarget,addClass:function(a){m.addClass(a)},removeClass:function(a){m.removeClass(a)},isDropAllowed:function(){return m.isDropAllowed.apply(m,arguments)},reference:g,isRedrop:function(a,b){return a.suspendedEndpoint&&b.reference&&a.suspendedEndpoint.id===b.reference.id}});h[j]=c.wrap(h[j],n,!0),h[k]=c.wrap(h[k],function(){var a=b.getDragObject(arguments),c=i.getAttribute(b.getElement(a),"dragId"),d=i.floatingConnections[c];if(null!=d){var e=i.getFloatingAnchorIndex(d);if(this.isTarget&&0!==e||d.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==d.suspendedEndpoint.id){var g=i.checkCondition("checkDropAllowed",{sourceEndpoint:d.endpoints[e],targetEndpoint:this,connection:d});this[(g?"add":"remove")+"Class"](i.endpointDropAllowedClass),this[(g?"remove":"add")+"Class"](i.endpointDropForbiddenClass),d.endpoints[e].anchor.over(this.anchor,this)}}}.bind(this)),h[l]=c.wrap(h[l],function(){var a=b.getDragObject(arguments),c=null==a?null:i.getAttribute(b.getElement(a),"dragId"),d=c?i.floatingConnections[c]:null;if(null!=d){var e=i.getFloatingAnchorIndex(d);(this.isTarget&&0!==e||d.suspendedEndpoint&&this.referenceEndpoint&&this.referenceEndpoint.id==d.suspendedEndpoint.id)&&(this.removeClass(i.endpointDropAllowedClass),this.removeClass(i.endpointDropForbiddenClass),d.endpoints[e].anchor.out())}}.bind(this)),i.initDroppable(d,h,"internal",e)}}.bind(this);return this.anchor.isFloating||s(this.canvas,!(a._transient||this.anchor.isFloating),this,a.reference),this},c.extend(b.Endpoint,b.OverlayCapableJsPlumbUIComponent,{setVisible:function(a,b,c){if(this._jsPlumb.visible=a,this.canvas&&(this.canvas.style.display=a?"block":"none"),this[a?"showOverlays":"hideOverlays"](),!b)for(var d=0;d<this.connections.length;d++)if(this.connections[d].setVisible(a),!c){var e=this===this.connections[d].endpoints[0]?1:0;1==this.connections[d].endpoints[e].connections.length&&this.connections[d].endpoints[e].setVisible(a,!0,!0)}},getAttachedElements:function(){return this.connections},applyType:function(a,c){this.setPaintStyle(a.endpointStyle||a.paintStyle,c),this.setHoverPaintStyle(a.endpointHoverStyle||a.hoverPaintStyle,c),null!=a.maxConnections&&(this._jsPlumb.maxConnections=a.maxConnections),a.scope&&(this.scope=a.scope),b.extend(this,a,g),null!=a.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,a.cssClass),b.OverlayCapableJsPlumbUIComponent.applyType(this,a)},isEnabled:function(){return this._jsPlumb.enabled},setEnabled:function(a){this._jsPlumb.enabled=a},cleanup:function(){var a=this._jsPlumb.instance.endpointAnchorClassPrefix+(this._jsPlumb.currentAnchorClass?"-"+this._jsPlumb.currentAnchorClass:"");jsPlumb.removeClass(this.element,a),this.anchor=null,this.endpoint.cleanup(!0),this.endpoint.destroy(),this.endpoint=null,this._jsPlumb.instance.destroyDraggable(this.canvas,"internal"),this._jsPlumb.instance.destroyDroppable(this.canvas,"internal")},setHover:function(a){this.endpoint&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&this.endpoint.setHover(a)},isFull:function(){return 0===this._jsPlumb.maxConnections||!(this.isFloating()||this._jsPlumb.maxConnections<0||this.connections.length<this._jsPlumb.maxConnections)},isFloating:function(){return null!=this.anchor&&this.anchor.isFloating},isConnectedTo:function(a){var b=!1;if(a)for(var c=0;c<this.connections.length;c++)if(this.connections[c].endpoints[1]==a||this.connections[c].endpoints[0]==a){b=!0;break}return b},getConnectionCost:function(){return this._jsPlumb.connectionCost},setConnectionCost:function(a){this._jsPlumb.connectionCost=a},areConnectionsDirected:function(){return this._jsPlumb.connectionsDirected},setConnectionsDirected:function(a){this._jsPlumb.connectionsDirected=a},setElementId:function(a){this.elementId=a,this.anchor.elementId=a},setReferenceElement:function(a){this.element=b.getElement(a)},setDragAllowedWhenFull:function(a){this.dragAllowedWhenFull=a},equals:function(a){return this.anchor.equals(a.anchor)},getUuid:function(){return this._jsPlumb.uuid},computeAnchor:function(a){return this.anchor.compute(a)}}),a.jsPlumbInstance.prototype.EndpointDropHandler=function(a){return function(b){var d=a.jsPlumb;a.removeClass(d.endpointDropAllowedClass),a.removeClass(d.endpointDropForbiddenClass);var e=d.getDropEvent(arguments),f=d.getDragObject(arguments),g=d.getAttribute(f,"dragId"),h=(d.getAttribute(f,"elId"),d.getAttribute(f,"originalScope")),i=d.floatingConnections[g];if(null!=i){var j=null!=i.suspendedEndpoint;if(!j||null!=i.suspendedEndpoint._jsPlumb){var k=a.getEndpoint(i);if(null!=k){if(a.isRedrop(i,a))return i._forceReattach=!0,i.setHover(!1),void(a.maybeCleanup&&a.maybeCleanup(k));var l=d.getFloatingAnchorIndex(i);if(0===l&&!a.isSource||1===l&&!a.isTarget)return void(a.maybeCleanup&&a.maybeCleanup(k));a.onDrop&&a.onDrop(i),h&&d.setDragScope(f,h);var m=a.isFull(b);if(m&&k.fire("maxConnections",{endpoint:this,connection:i,maxConnections:k._jsPlumb.maxConnections},e),!m&&a.enabled()){var n=!0;0===l?(i.floatingElement=i.source,i.floatingId=i.sourceId,i.floatingEndpoint=i.endpoints[0],i.floatingIndex=0,i.source=a.element,i.sourceId=a.elementId):(i.floatingElement=i.target,i.floatingId=i.targetId,i.floatingEndpoint=i.endpoints[1],i.floatingIndex=1,i.target=a.element,i.targetId=a.elementId),j&&i.suspendedEndpoint.id!=k.id&&(i.isDetachAllowed(i)&&i.endpoints[l].isDetachAllowed(i)&&i.suspendedEndpoint.isDetachAllowed(i)&&d.checkCondition("beforeDetach",i)||(n=!1));var o=function(a){i.endpoints[l].detachFromConnection(i),i.suspendedEndpoint&&i.suspendedEndpoint.detachFromConnection(i),i.endpoints[l]=k,k.addConnection(i);var b=k.getParameters();for(var f in b)i.setParameter(f,b[f]);if(j){var g=i.suspendedEndpoint.elementId;d.fireMoveEvent({index:l,originalSourceId:0===l?g:i.sourceId,newSourceId:0===l?k.elementId:i.sourceId,originalTargetId:1==l?g:i.targetId,newTargetId:1==l?k.elementId:i.targetId,originalSourceEndpoint:0===l?i.suspendedEndpoint:i.endpoints[0],newSourceEndpoint:0===l?k:i.endpoints[0],originalTargetEndpoint:1==l?i.suspendedEndpoint:i.endpoints[1],newTargetEndpoint:1==l?k:i.endpoints[1],connection:i},e)}else b.draggable&&d.initDraggable(this.element,dragOptions,"internal",d);(1==l?d.anchorManager.updateOtherEndpoint(i.sourceId,i.floatingId,i.targetId,i):d.anchorManager.sourceChanged(i.floatingId,i.sourceId,i,i.source),i.endpoints[0].finalEndpoint)&&(i.endpoints[0].detachFromConnection(i),i.endpoints[0]=i.endpoints[0].finalEndpoint,i.endpoints[0].addConnection(i));c.isObject(a)&&i.mergeData(a),d.finaliseConnection(i,null,e,!1),i.setHover(!1)}.bind(this);if(n=n&&a.isDropAllowed(i.sourceId,i.targetId,i.scope,i,k))return o(n),!0;i.suspendedEndpoint&&(i.endpoints[l]=i.suspendedEndpoint,i.setHover(!1),i._forceDetach=!0,0===l?(i.source=i.suspendedEndpoint.element,i.sourceId=i.suspendedEndpoint.elementId):(i.target=i.suspendedEndpoint.element,i.targetId=i.suspendedEndpoint.elementId),i.suspendedEndpoint.addConnection(i),1==l?d.anchorManager.updateOtherEndpoint(i.sourceId,i.floatingId,i.targetId,i):d.anchorManager.sourceChanged(i.floatingId,i.sourceId,i,i.source),d.repaint(i.sourceId),i._forceDetach=!1)}a.maybeCleanup&&a.maybeCleanup(k),d.currentlyDragging=!1}}}}}}.call("undefined"!=typeof window?window:this),function(){"use strict";var a=this,b=a.jsPlumb,c=a.jsPlumbUtil,d=function(a,c,d,e,f){if(!a.Defaults.DoNotThrowErrors&&null==jsPlumb.Connectors[c][d])throw{msg:"jsPlumb: unknown connector type '"+d+"'"};return new b.Connectors[c][d](e,f)},e=function(a,b,c){return a?c.makeAnchor(a,b,c):null},f=function(a,b,d,e){null!=b&&(b._jsPlumbConnections=b._jsPlumbConnections||{},e?delete b._jsPlumbConnections[a.id]:b._jsPlumbConnections[a.id]=!0,c.isEmpty(b._jsPlumbConnections)?d.removeClass(b,d.connectedClass):d.addClass(b,d.connectedClass))};b.Connection=function(a){var d=a.newEndpoint;this.id=a.id,this.connector=null,this.idPrefix="_jsplumb_c_",this.defaultLabelLocation=.5,this.defaultOverlayKeys=["Overlays","ConnectionOverlays"],this.previousConnection=a.previousConnection,this.source=b.getElement(a.source),this.target=b.getElement(a.target),a.sourceEndpoint&&(this.source=a.sourceEndpoint.getElement()),a.targetEndpoint&&(this.target=a.targetEndpoint.getElement()),b.OverlayCapableJsPlumbUIComponent.apply(this,arguments),this.sourceId=this._jsPlumb.instance.getId(this.source),this.targetId=this._jsPlumb.instance.getId(this.target),this.scope=a.scope,this.endpoints=[],this.endpointStyles=[];var e=this._jsPlumb.instance;e.manage(this.sourceId,this.source),e.manage(this.targetId,this.target),this._jsPlumb.visible=!0,this._jsPlumb.editable=!0===a.editable,this._jsPlumb.params={cssClass:a.cssClass,container:a.container,"pointer-events":a["pointer-events"],editorParams:a.editorParams,overlays:a.overlays},this._jsPlumb.lastPaintedAt=null,this.bind("mouseover",function(){this.setHover(!0)}.bind(this)),this.bind("mouseout",function(){this.setHover(!1)}.bind(this)),this.editableRequested=!1!==a.editable,this.setEditable=function(a){return!!this.connector&&this.connector.setEditable(a)},this.isEditable=function(){return!!this.connector&&this.connector.isEditable()},this.isEditing=function(){return!!this.connector&&this.connector.isEditing()},this.makeEndpoint=function(b,c,f,g){return f=f||this._jsPlumb.instance.getId(c),this.prepareEndpoint(e,d,this,g,b?0:1,a,c,f)},a.type&&(a.endpoints=this._jsPlumb.instance.deriveEndpointAndAnchorSpec(a.type).endpoints);var f=this.makeEndpoint(!0,this.source,this.sourceId,a.sourceEndpoint),g=this.makeEndpoint(!1,this.target,this.targetId,a.targetEndpoint);f&&c.addToList(a.endpointsByElement,this.sourceId,f),g&&c.addToList(a.endpointsByElement,this.targetId,g),this.scope||(this.scope=this.endpoints[0].scope),null!=a.deleteEndpointsOnDetach?(this.endpoints[0]._deleteOnDetach=a.deleteEndpointsOnDetach,this.endpoints[1]._deleteOnDetach=a.deleteEndpointsOnDetach):(this.endpoints[0]._doNotDeleteOnDetach||(this.endpoints[0]._deleteOnDetach=!0),this.endpoints[1]._doNotDeleteOnDetach||(this.endpoints[1]._deleteOnDetach=!0));var h=e.Defaults.ConnectionsDetachable;!1===a.detachable&&(h=!1),!1===this.endpoints[0].connectionsDetachable&&(h=!1),!1===this.endpoints[1].connectionsDetachable&&(h=!1);var i=a.reattach||this.endpoints[0].reattachConnections||this.endpoints[1].reattachConnections||e.Defaults.ReattachConnections;this.appendToDefaultType({detachable:h,reattach:i,paintStyle:this.endpoints[0].connectorStyle||this.endpoints[1].connectorStyle||a.paintStyle||e.Defaults.PaintStyle||jsPlumb.Defaults.PaintStyle,hoverPaintStyle:this.endpoints[0].connectorHoverStyle||this.endpoints[1].connectorHoverStyle||a.hoverPaintStyle||e.Defaults.HoverPaintStyle||jsPlumb.Defaults.HoverPaintStyle});var j=e.getSuspendedAt();if(!e.isSuspendDrawing()){var k=e.getCachedData(this.sourceId),l=k.o,m=k.s,n=e.getCachedData(this.targetId),o=n.o,p=n.s,q=j||e.timestamp(),r=this.endpoints[0].anchor.compute({xy:[l.left,l.top],wh:m,element:this.endpoints[0],elementId:this.endpoints[0].elementId,txy:[o.left,o.top],twh:p,tElement:this.endpoints[1],timestamp:q});this.endpoints[0].paint({anchorLoc:r,timestamp:q}),r=this.endpoints[1].anchor.compute({xy:[o.left,o.top],wh:p,element:this.endpoints[1],elementId:this.endpoints[1].elementId,txy:[l.left,l.top],twh:m,tElement:this.endpoints[0],timestamp:q}),this.endpoints[1].paint({anchorLoc:r,timestamp:q})}this.getTypeDescriptor=function(){return"connection"},this.getAttachedElements=function(){return this.endpoints},this.isDetachable=function(){return!0===this._jsPlumb.detachable},this.setDetachable=function(a){this._jsPlumb.detachable=!0===a},this.isReattach=function(){return!0===this._jsPlumb.reattach||!0===this.endpoints[0].reattachConnections||!0===this.endpoints[1].reattachConnections},this.setReattach=function(a){this._jsPlumb.reattach=!0===a},this._jsPlumb.cost=a.cost||this.endpoints[0].getConnectionCost(),this._jsPlumb.directed=a.directed,null==a.directed&&(this._jsPlumb.directed=this.endpoints[0].areConnectionsDirected());var s=jsPlumb.extend({},this.endpoints[1].getParameters());b.extend(s,this.endpoints[0].getParameters()),b.extend(s,this.getParameters()),this.setParameters(s),this.setConnector(this.endpoints[0].connector||this.endpoints[1].connector||a.connector||e.Defaults.Connector||b.Defaults.Connector,!0),a.geometry&&this.connector.setGeometry(a.geometry);var t=null!=a.data&&c.isObject(a.data)?a.data:{};this.getData=function(){return t},this.setData=function(a){t=a||{}},this.mergeData=function(a){t=jsPlumb.extend(t,a)};var u=["default",this.endpoints[0].connectionType,this.endpoints[1].connectionType,a.type].join(" ");/[^\s]/.test(u)&&this.addType(u,a.data,!0),this.updateConnectedClass()},c.extend(b.Connection,b.OverlayCapableJsPlumbUIComponent,{applyType:function(a,c,d){null!=a.detachable&&this.setDetachable(a.detachable),null!=a.reattach&&this.setReattach(a.reattach),a.scope&&(this.scope=a.scope),null!=a.cssClass&&this.canvas&&this._jsPlumb.instance.addClass(this.canvas,a.cssClass);var e=null;a.anchor?null==(e=this.getCachedTypeItem("anchors",d.anchor))&&(e=[this._jsPlumb.instance.makeAnchor(a.anchor),this._jsPlumb.instance.makeAnchor(a.anchor)],this.cacheTypeItem("anchors",e,d.anchor)):a.anchors&&(null==(e=this.getCachedTypeItem("anchors",d.anchors))&&(e=[this._jsPlumb.instance.makeAnchor(a.anchors[0]),this._jsPlumb.instance.makeAnchor(a.anchors[1])],this.cacheTypeItem("anchors",e,d.anchors))),null!=e&&(this.endpoints[0].anchor=e[0],this.endpoints[1].anchor=e[1],this.endpoints[1].anchor.isDynamic&&this._jsPlumb.instance.repaint(this.endpoints[1].elementId)),b.OverlayCapableJsPlumbUIComponent.applyType(this,a)},addClass:function(a,b){b&&(this.endpoints[0].addClass(a),this.endpoints[1].addClass(a),this.suspendedEndpoint&&this.suspendedEndpoint.addClass(a)),this.connector&&this.connector.addClass(a)},removeClass:function(a,b){b&&(this.endpoints[0].removeClass(a),this.endpoints[1].removeClass(a),this.suspendedEndpoint&&this.suspendedEndpoint.removeClass(a)),this.connector&&this.connector.removeClass(a)},isVisible:function(){return this._jsPlumb.visible},setVisible:function(a){this._jsPlumb.visible=a,this.connector&&this.connector.setVisible(a),this.repaint()},cleanup:function(){this.updateConnectedClass(!0),this.endpoints=null,this.source=null,this.target=null,null!=this.connector&&(this.connector.cleanup(!0),this.connector.destroy(!0)),this.connector=null},updateConnectedClass:function(a){this._jsPlumb&&(f(this,this.source,this._jsPlumb.instance,a),f(this,this.target,this._jsPlumb.instance,a))},setHover:function(b){this.connector&&this._jsPlumb&&!this._jsPlumb.instance.isConnectionBeingDragged()&&(this.connector.setHover(b),a.jsPlumb[b?"addClass":"removeClass"](this.source,this._jsPlumb.instance.hoverSourceClass),a.jsPlumb[b?"addClass":"removeClass"](this.target,this._jsPlumb.instance.hoverTargetClass))},getUuids:function(){return[this.endpoints[0].getUuid(),this.endpoints[1].getUuid()]},getCost:function(){return this._jsPlumb?this._jsPlumb.cost:-1/0},setCost:function(a){this._jsPlumb.cost=a},isDirected:function(){return!0===this._jsPlumb.directed},getConnector:function(){return this.connector},getGeometry:function(){return this.connector?this.connector.getGeometry():null},setGeometry:function(a){this.connector&&this.connector.setGeometry(a)},prepareConnector:function(a,b){var e,f={_jsPlumb:this._jsPlumb.instance,cssClass:(this._jsPlumb.params.cssClass||"")+(this.isEditable()?this._jsPlumb.instance.editableConnectorClass:""),container:this._jsPlumb.params.container,"pointer-events":this._jsPlumb.params["pointer-events"],editable:this.editableRequested},g=this._jsPlumb.instance.getRenderMode();return c.isString(a)?e=d(this._jsPlumb.instance,g,a,f,this):c.isArray(a)&&(e=1==a.length?d(this._jsPlumb.instance,g,a[0],f,this):d(this._jsPlumb.instance,g,a[0],c.merge(a[1],f),this)),null!=b&&(e.typeId=b),e},setPreparedConnector:function(a,b,c,d){var e,f="";if(null!=this.connector&&(f=(e=this.connector).getClass(),this.connector.cleanup(),this.connector.destroy()),this.connector=a,d&&this.cacheTypeItem("connector",a,d),this.canvas=this.connector.canvas,this.bgCanvas=this.connector.bgCanvas,this.addClass(f),this.canvas&&(this.canvas._jsPlumb=this),this.bgCanvas&&(this.bgCanvas._jsPlumb=this),null!=e)for(var g=this.getOverlays(),h=0;h<g.length;h++)g[h].transfer&&g[h].transfer(this.connector);c||this.setListenerComponent(this.connector),b||this.repaint()},setConnector:function(a,b,c,d){var e=this.prepareConnector(a,d);this.setPreparedConnector(e,b,c,d)},paint:function(a){if(!this._jsPlumb.instance.isSuspendDrawing()&&this._jsPlumb.visible){var b=(a=a||{}).timestamp,d=this.targetId,e=this.sourceId;if(null==b||b!=this._jsPlumb.lastPaintedAt){var h=this._jsPlumb.instance.updateOffset({elId:e}).o,i=this._jsPlumb.instance.updateOffset({elId:d}).o,j=this.endpoints[0],k=this.endpoints[1],l=j.anchor.getCurrentLocation({xy:[h.left,h.top],wh:[h.width,h.height],element:j,timestamp:b}),m=k.anchor.getCurrentLocation({xy:[i.left,i.top],wh:[i.width,i.height],element:k,timestamp:b});this.connector.resetBounds(),this.connector.compute({sourcePos:l,targetPos:m,sourceEndpoint:this.endpoints[0],targetEndpoint:this.endpoints[1],lineWidth:this._jsPlumb.paintStyleInUse.lineWidth,sourceInfo:h,targetInfo:i});var n={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(var o in this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(o)){var p=this._jsPlumb.overlays[o];p.isVisible()&&(this._jsPlumb.overlayPlacements[o]=p.draw(this.connector,this._jsPlumb.paintStyleInUse,this.getAbsoluteOverlayPosition(p)),n.minX=Math.min(n.minX,this._jsPlumb.overlayPlacements[o].minX),n.maxX=Math.max(n.maxX,this._jsPlumb.overlayPlacements[o].maxX),n.minY=Math.min(n.minY,this._jsPlumb.overlayPlacements[o].minY),n.maxY=Math.max(n.maxY,this._jsPlumb.overlayPlacements[o].maxY))}var q=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||1)/2,r=parseFloat(this._jsPlumb.paintStyleInUse.lineWidth||0),s={xmin:Math.min(this.connector.bounds.minX-(q+r),n.minX),ymin:Math.min(this.connector.bounds.minY-(q+r),n.minY),xmax:Math.max(this.connector.bounds.maxX+(q+r),n.maxX),ymax:Math.max(this.connector.bounds.maxY+(q+r),n.maxY)};for(var t in this.connector.paint(this._jsPlumb.paintStyleInUse,null,s),this._jsPlumb.overlays)if(this._jsPlumb.overlays.hasOwnProperty(t)){var u=this._jsPlumb.overlays[t];u.isVisible()&&u.paint(this._jsPlumb.overlayPlacements[t],s)}}this._jsPlumb.lastPaintedAt=b}},repaint:function(a){a=a||{},this.paint({elId:this.sourceId,recalc:!(!1===a.recalc),timestamp:a.timestamp})},prepareEndpoint:function(a,c,d,f,g,h,i,j){var k;if(f)d.endpoints[g]=f,f.addConnection(d);else{h.endpoints||(h.endpoints=[null,null]);var l=h.endpoints[g]||h.endpoint||a.Defaults.Endpoints[g]||jsPlumb.Defaults.Endpoints[g]||a.Defaults.Endpoint||jsPlumb.Defaults.Endpoint;h.endpointStyles||(h.endpointStyles=[null,null]),h.endpointHoverStyles||(h.endpointHoverStyles=[null,null]);var m=h.endpointStyles[g]||h.endpointStyle||a.Defaults.EndpointStyles[g]||jsPlumb.Defaults.EndpointStyles[g]||a.Defaults.EndpointStyle||jsPlumb.Defaults.EndpointStyle;null==m.fillStyle&&null!=h.paintStyle&&(m.fillStyle=h.paintStyle.strokeStyle),null==m.outlineColor&&null!=h.paintStyle&&(m.outlineColor=h.paintStyle.outlineColor),null==m.outlineWidth&&null!=h.paintStyle&&(m.outlineWidth=h.paintStyle.outlineWidth);var n=h.endpointHoverStyles[g]||h.endpointHoverStyle||a.Defaults.EndpointHoverStyles[g]||jsPlumb.Defaults.EndpointHoverStyles[g]||a.Defaults.EndpointHoverStyle||jsPlumb.Defaults.EndpointHoverStyle;null!=h.hoverPaintStyle&&(null==n&&(n={}),null==n.fillStyle&&(n.fillStyle=h.hoverPaintStyle.strokeStyle));var o=h.anchors?h.anchors[g]:h.anchor?h.anchor:e(a.Defaults.Anchors[g],j,a)||e(b.Defaults.Anchors[g],j,a)||e(a.Defaults.Anchor,j,a)||e(b.Defaults.Anchor,j,a);k=c({paintStyle:m,hoverPaintStyle:n,endpoint:l,connections:[d],uuid:h.uuids?h.uuids[g]:null,anchor:o,source:i,scope:h.scope,reattach:h.reattach||a.Defaults.ReattachConnections,detachable:h.detachable||a.Defaults.ConnectionsDetachable}),d.endpoints[g]=k,!1===h.drawEndpoints&&k.setVisible(!1,!0,!0)}return k}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var a=this,b=a.jsPlumbUtil,c=a.jsPlumb;c.AnchorManager=function(a){var d={},e={},f={},g={},h_IDENTITY="identity",i=["left","top","right","bottom"],j={},k=this,l={},m=a.jsPlumbInstance,n={},o=function(a,b,c,d,e,f){if(a===b)return{orientation:h_IDENTITY,a:["top","top"]};var g=Math.atan2(d.centery-c.centery,d.centerx-c.centerx),j=Math.atan2(c.centery-d.centery,c.centerx-d.centerx),k=[],l={};!function(a,b){for(var c=0;c<a.length;c++)l[a[c]]={left:[b[c].left,b[c].centery],right:[b[c].right,b[c].centery],top:[b[c].centerx,b[c].top],bottom:[b[c].centerx,b[c].bottom]}}(["source","target"],[c,d]);for(var m=0;m<i.length;m++)for(var n=0;n<i.length;n++)k.push({source:i[m],target:i[n],dist:Biltong.lineLength(l.source[i[m]],l.target[i[n]])});k.sort(function(a,b){return a.dist<b.dist?-1:a.dist>b.dist?1:0});for(var o=k[0].source,p=k[0].target,q=0;q<k.length&&(o=!e.isContinuous||e.isEdgeSupported(k[q].source)?k[q].source:null,p=!f.isContinuous||f.isEdgeSupported(k[q].target)?k[q].target:null,null==o||null==p);q++);return{a:[o,p],theta:g,theta2:j}},q=function(a){return function(b,c){return!1===(a?b[0][0]<c[0][0]:b[0][0]>c[0][0])?-1:1}},s={top:function(a,b){return a[0]>b[0]?1:-1},right:q(!0),bottom:q(!0),left:function(a,b){return(a[0][0]<0?-Math.PI-a[0][0]:Math.PI-a[0][0])>(b[0][0]<0?-Math.PI-b[0][0]:Math.PI-b[0][0])?1:a[0][1]>b[0][1]?1:-1}},u=function(a,b){var c=m.getCachedData(a),d=c.s,f=c.o,h=function(b,c,d,f,h,i,j){if(f.length>0)for(var m=function(a,b,c,d,e,f,g){for(var h=[],i=b[e?0:1]/(d.length+1),j=0;j<d.length;j++){var k=(j+1)*i,l=f*b[e?1:0];g&&(k=b[e?0:1]-k);var m=e?k:l,n=c[0]+m,o=m/b[0],p=e?l:k,q=c[1]+p,r=p/b[1];h.push([n,q,o,r,d[j][1],d[j][2]])}return h}(0,c,d,function(a,b){return a.sort(b)}(f,s[b]),h,i,"right"===b||"top"===b),n=function(a,b){e[a.id]=[b[0],b[1],b[2],b[3]],g[a.id]=j},o=0;o<m.length;o++){var q=m[o][4],r=q.endpoints[0].elementId===a,u=q.endpoints[1].elementId===a;r&&n(q.endpoints[0],m[o]),u&&n(q.endpoints[1],m[o])}};h("bottom",d,[f.left,f.top],b.bottom,!0,1,[0,1]),h("top",d,[f.left,f.top],b.top,!0,0,[0,-1]),h("left",d,[f.left,f.top],b.left,!1,0,[-1,0]),h("right",d,[f.left,f.top],b.right,!1,1,[1,0])};this.reset=function(){d={},j={},l={}},this.addFloatingConnection=function(a,b){n[a]=b},this.removeFloatingConnection=function(a){delete n[a]},this.newConnection=function(a){var d=a.sourceId,e=a.targetId,f=a.endpoints,g=!0,h=function(h,i,k,l,m){d==e&&k.isContinuous&&(a._jsPlumb.instance.removeElement(f[1].canvas),g=!1),b.addToList(j,l,[m,i,k.constructor==c.DynamicAnchor])};h(0,f[0],f[0].anchor,e,a),g&&h(0,f[1],f[1].anchor,d,a)};var v=function(a){!function(a,c){if(a){var d=function(a){return a[4]==c};b.removeWithFunction(a.top,d),b.removeWithFunction(a.left,d),b.removeWithFunction(a.bottom,d),b.removeWithFunction(a.right,d)}}(l[a.elementId],a.id)};this.connectionDetached=function(a,c){var d=a.connection||a,e=a.sourceId,f=a.targetId,g=d.endpoints,h=function(a,c,d,e,f){b.removeWithFunction(j[e],function(a){return a[0].id==f.id})};h(0,g[1],g[1].anchor,e,d),h(0,g[0],g[0].anchor,f,d),d.floatingId&&(h(d.floatingIndex,d.floatingEndpoint,d.floatingEndpoint.anchor,d.floatingId,d),v(d.floatingEndpoint)),v(d.endpoints[0]),v(d.endpoints[1]),c||(k.redraw(d.sourceId),d.targetId!==d.sourceId&&k.redraw(d.targetId))},this.add=function(a,c){b.addToList(d,c,a)},this.changeId=function(a,b){j[b]=j[a],d[b]=d[a],delete j[a],delete d[a]},this.getConnectionsFor=function(a){return j[a]||[]},this.getEndpointsFor=function(a){return d[a]||[]},this.deleteEndpoint=function(a){b.removeWithFunction(d[a.elementId],function(b){return b.id==a.id}),v(a)},this.clearFor=function(a){delete d[a],d[a]=[]};var w=function(c,d,e,f,g,h,i,j,k,l,m,n){var o,p,r=-1,s=f.endpoints[i],t=s.id,u=[1,0][i],v=[[d,e],f,g,h,t],w=c[k],x=s._continuousAnchorEdge?c[s._continuousAnchorEdge]:null;if(x){var y=b.findWithFunction(x,function(a){return a[4]==t});if(-1!=y)for(x.splice(y,1),o=0;o<x.length;o++)p=x[o][1],b.addWithFunction(m,p,function(a){return a.id==p.id}),b.addWithFunction(n,x[o][1].endpoints[i],function(a){return a.id==p.endpoints[i].id}),b.addWithFunction(n,x[o][1].endpoints[u],function(a){return a.id==p.endpoints[u].id})}for(o=0;o<w.length;o++)p=w[o][1],1==a.idx&&w[o][3]===h&&-1==r&&(r=o),b.addWithFunction(m,p,function(a){return a.id==p.id}),b.addWithFunction(n,w[o][1].endpoints[i],function(a){return a.id==p.endpoints[i].id}),b.addWithFunction(n,w[o][1].endpoints[u],function(a){return a.id==p.endpoints[u].id});var z=j?-1!=r?r:0:w.length;w.splice(z,0,v),s._continuousAnchorEdge=k};this.updateOtherEndpoint=function(a,d,e,f){var g=b.findWithFunction(j[a],function(a){return a[0].id===f.id}),h=b.findWithFunction(j[d],function(a){return a[0].id===f.id});-1!=g&&(j[a][g][0]=f,j[a][g][1]=f.endpoints[1],j[a][g][2]=f.endpoints[1].anchor.constructor==c.DynamicAnchor),h>-1&&(j[d].splice(h,1),b.addToList(j,e,[f,f.endpoints[0],f.endpoints[0].anchor.constructor==c.DynamicAnchor])),f.updateConnectedClass()},this.sourceChanged=function(a,d,e,f){if(a!==d){e.sourceId=d,e.source=f,b.removeWithFunction(j[a],function(a){return a[0].id===e.id});var g=b.findWithFunction(j[e.targetId],function(a){return a[0].id===e.id});g>-1&&(j[e.targetId][g][0]=e,j[e.targetId][g][1]=e.endpoints[0],j[e.targetId][g][2]=e.endpoints[0].anchor.constructor==c.DynamicAnchor),b.addToList(j,d,[e,e.endpoints[1],e.endpoints[1].anchor.constructor==c.DynamicAnchor]),e.endpoints[1].anchor.isContinuous&&(e.source===e.target?e._jsPlumb.instance.removeElement(e.endpoints[1].canvas):null==e.endpoints[1].canvas.parentNode&&e._jsPlumb.instance.appendElement(e.endpoints[1].canvas)),e.updateConnectedClass()}},this.rehomeEndpoint=function(a,b,c){var e=d[b]||[],f=m.getId(c);if(f!==b){var g=e.indexOf(a);if(g>-1){var h=e.splice(g,1)[0];k.add(h,f)}}for(var i=0;i<a.connections.length;i++)a.connections[i].sourceId==b?k.sourceChanged(b,a.elementId,a.connections[i],a.element):a.connections[i].targetId==b&&(a.connections[i].targetId=a.elementId,a.connections[i].target=a.element,k.updateOtherEndpoint(a.connections[i].sourceId,b,a.elementId,a.connections[i]))},this.redraw=function(a,e,f,g,h,i){if(!m.isSuspendDrawing()){var k=d[a]||[],p=j[a]||[],q=[],r=[],s=[];f=f||m.timestamp(),g=g||{left:0,top:0},e&&(e={left:e.left+g.left,top:e.top+g.top});for(var t=m.updateOffset({elId:a,offset:e,recalc:!1,timestamp:f}),v={},x=0;x<p.length;x++){var y=p[x][0],z=y.sourceId,A=y.targetId,B=y.endpoints[0].anchor.isContinuous,C=y.endpoints[1].anchor.isContinuous;if(B||C){var D=z+"_"+A,E=v[D],F=y.sourceId==a?1:0;B&&!l[z]&&(l[z]={top:[],right:[],bottom:[],left:[]}),C&&!l[A]&&(l[A]={top:[],right:[],bottom:[],left:[]}),a!=A&&m.updateOffset({elId:A,timestamp:f}),a!=z&&m.updateOffset({elId:z,timestamp:f});var G=m.getCachedData(A),H=m.getCachedData(z);A==z&&(B||C)?(w(l[z],-Math.PI/2,0,y,!1,A,0,!1,"top",0,q,r),w(l[A],-Math.PI/2,0,y,!1,z,1,!1,"top",0,q,r)):(E||(E=o(z,A,H.o,G.o,y.endpoints[0].anchor,y.endpoints[1].anchor),v[D]=E),B&&w(l[z],E.theta,0,y,!1,A,0,!1,E.a[0],0,q,r),C&&w(l[A],E.theta2,-1,y,!0,z,1,!0,E.a[1],0,q,r)),B&&b.addWithFunction(s,z,function(a){return a===z}),C&&b.addWithFunction(s,A,function(a){return a===A}),b.addWithFunction(q,y,function(a){return a.id==y.id}),(B&&0===F||C&&1===F)&&b.addWithFunction(r,y.endpoints[F],function(a){return a.id==y.endpoints[F].id})}}for(x=0;x<k.length;x++)0===k[x].connections.length&&k[x].anchor.isContinuous&&(l[a]||(l[a]={top:[],right:[],bottom:[],left:[]}),w(l[a],-Math.PI/2,0,{endpoints:[k[x],k[x]],paint:function(){}},!1,a,0,!1,k[x].anchor.getDefaultFace(),0,q,r),b.addWithFunction(s,a,function(b){return b===a}));for(x=0;x<s.length;x++)u(s[x],l[s[x]]);for(x=0;x<k.length;x++)k[x].paint({timestamp:f,offset:t,dimensions:t.s,recalc:!0!==i});for(x=0;x<r.length;x++){var I=m.getCachedData(r[x].elementId);r[x].paint({timestamp:f,offset:I,dimensions:I.s})}for(x=0;x<p.length;x++){var J=p[x][1];if(J.anchor.constructor==c.DynamicAnchor){J.paint({elementWithPrecedence:a,timestamp:f}),b.addWithFunction(q,p[x][0],function(a){return a.id==p[x][0].id});for(var K=0;K<J.connections.length;K++)J.connections[K]!==p[x][0]&&b.addWithFunction(q,J.connections[K],function(a){return a.id==J.connections[K].id})}else J.anchor.constructor==c.Anchor&&b.addWithFunction(q,p[x][0],function(a){return a.id==p[x][0].id})}var L=n[a];for(L&&L.paint({timestamp:f,recalc:!1,elId:a}),x=0;x<q.length;x++)q[x].paint({elId:a,timestamp:f,recalc:!1,clearEdits:h})}};m.continuousAnchorFactory={get:function(a){return new function(a){b.EventGenerator.apply(this),this.type="Continuous",this.isDynamic=!0,this.isContinuous=!0;for(var c=a.faces||["top","right","bottom","left"],d=!(!1===a.clockwise),h={},i={top:"bottom",right:"left",left:"right",bottom:"top"},j={top:"right",right:"bottom",left:"top",bottom:"left"},k={top:"left",right:"top",left:"bottom",bottom:"right"},l=d?j:k,m=d?k:j,n=a.cssClass||"",o=0;o<c.length;o++)h[c[o]]=!0;this.getDefaultFace=function(){return 0===c.length?"top":c[0]},this.verifyEdge=function(a){return h[a]?a:h[i[a]]?i[a]:h[l[a]]?l[a]:h[m[a]]?m[a]:a},this.isEdgeSupported=function(a){return!0===h[a]},this.compute=function(a){return f[a.element.id]||e[a.element.id]||[0,0]},this.getCurrentLocation=function(a){return f[a.element.id]||e[a.element.id]||[0,0]},this.getOrientation=function(a){return g[a.id]||[0,0]},this.clearUserDefinedLocation=function(){delete f[a.elementId]},this.setUserDefinedLocation=function(b){f[a.elementId]=b},this.getCssClass=function(){return n}}(a)},clear:function(a){delete f[a],delete e[a]}}},c.Anchor=function(a){this.x=a.x||0,this.y=a.y||0,this.elementId=a.elementId,this.cssClass=a.cssClass||"",this.userDefinedLocation=null,this.orientation=a.orientation||[0,0],this.lastReturnValue=null,this.offsets=a.offsets||[0,0],this.timestamp=null,b.EventGenerator.apply(this),this.compute=function(a){var b=a.xy,c=a.wh,d=a.timestamp;return a.clearUserDefinedLocation&&(this.userDefinedLocation=null),d&&d===self.timestamp?this.lastReturnValue:(this.lastReturnValue=null!=this.userDefinedLocation?this.userDefinedLocation:[b[0]+this.x*c[0]+this.offsets[0],b[1]+this.y*c[1]+this.offsets[1]],this.timestamp=d,this.lastReturnValue)},this.getCurrentLocation=function(a){return a=a||{},null==this.lastReturnValue||null!=a.timestamp&&this.timestamp!=a.timestamp?this.compute(a):this.lastReturnValue}},b.extend(c.Anchor,b.EventGenerator,{equals:function(a){if(!a)return!1;var b=a.getOrientation(),c=this.getOrientation();return this.x==a.x&&this.y==a.y&&this.offsets[0]==a.offsets[0]&&this.offsets[1]==a.offsets[1]&&c[0]==b[0]&&c[1]==b[1]},getUserDefinedLocation:function(){return this.userDefinedLocation},setUserDefinedLocation:function(a){this.userDefinedLocation=a},clearUserDefinedLocation:function(){this.userDefinedLocation=null},getOrientation:function(){return this.orientation},getCssClass:function(){return this.cssClass}}),c.FloatingAnchor=function(a){c.Anchor.apply(this,arguments);var b=a.reference,d=a.referenceCanvas,e=c.getSize(d),h=null,i=null;this.orientation=null,this.x=0,this.y=0,this.isFloating=!0,this.compute=function(a){var b=a.xy,c=[b[0]+e[0]/2,b[1]+e[1]/2];return i=c,c},this.getOrientation=function(a){if(h)return h;var c=b.getOrientation(a);return[-1*Math.abs(c[0])*0,-1*Math.abs(c[1])*0]},this.over=function(a,b){h=a.getOrientation(b)},this.out=function(){h=null},this.getCurrentLocation=function(a){return null==i?this.compute(a):i}},b.extend(c.FloatingAnchor,c.Anchor);var d=function(a,b,d){return a.constructor==c.Anchor?a:b.makeAnchor(a,d,b)};c.DynamicAnchor=function(a){c.Anchor.apply(this,arguments),this.isDynamic=!0,this.anchors=[],this.elementId=a.elementId,this.jsPlumbInstance=a.jsPlumbInstance;for(var b=0;b<a.anchors.length;b++)this.anchors[b]=d(a.anchors[b],this.jsPlumbInstance,this.elementId);this.getAnchors=function(){return this.anchors},this.locked=!1;var e=this.anchors.length>0?this.anchors[0]:null,f=e,g=this,h=function(a,b,c,d,e){var f=d[0]+a.x*e[0],g=d[1]+a.y*e[1],h=d[0]+e[0]/2,i=d[1]+e[1]/2;return Math.sqrt(Math.pow(b-f,2)+Math.pow(c-g,2))+Math.sqrt(Math.pow(h-f,2)+Math.pow(i-g,2))},i=a.selector||function(a,b,c,d,e){for(var f=c[0]+d[0]/2,g=c[1]+d[1]/2,i=-1,j=1/0,k=0;k<e.length;k++){var l=h(e[k],f,g,a,b);j>l&&(i=k+0,j=l)}return e[i]};this.compute=function(a){var b=a.xy,c=a.wh,d=a.txy,h=a.twh;this.timestamp=a.timestamp;var j=g.getUserDefinedLocation();return null!=j?j:this.locked||null==d||null==h?e.compute(a):(a.timestamp=null,e=i(b,c,d,h,this.anchors),this.x=e.x,this.y=e.y,e!=f&&this.fire("anchorChanged",e),f=e,e.compute(a))},this.getCurrentLocation=function(a){return this.getUserDefinedLocation()||(null!=e?e.getCurrentLocation(a):null)},this.getOrientation=function(a){return null!=e?e.getOrientation(a):[0,0]},this.over=function(a,b){null!=e&&e.over(a,b)},this.out=function(){null!=e&&e.out()},this.getCssClass=function(){return e&&e.getCssClass()||""}},b.extend(c.DynamicAnchor,c.Anchor);var e=function(a,b,d,e,f,g){c.Anchors[f]=function(c){var h=c.jsPlumbInstance.makeAnchor([a,b,d,e,0,0],c.elementId,c.jsPlumbInstance);return h.type=f,g&&g(h,c),h}};e(.5,0,0,-1,"TopCenter"),e(.5,1,0,1,"BottomCenter"),e(0,.5,-1,0,"LeftMiddle"),e(1,.5,1,0,"RightMiddle"),e(.5,0,0,-1,"Top"),e(.5,1,0,1,"Bottom"),e(0,.5,-1,0,"Left"),e(1,.5,1,0,"Right"),e(.5,.5,0,0,"Center"),e(1,0,0,-1,"TopRight"),e(1,1,0,1,"BottomRight"),e(0,0,0,-1,"TopLeft"),e(0,1,0,1,"BottomLeft"),c.Defaults.DynamicAnchors=function(a){return a.jsPlumbInstance.makeAnchors(["TopCenter","RightMiddle","BottomCenter","LeftMiddle"],a.elementId,a.jsPlumbInstance)},c.Anchors.AutoDefault=function(a){var b=a.jsPlumbInstance.makeDynamicAnchor(c.Defaults.DynamicAnchors(a));return b.type="AutoDefault",b};var f=function(a,b){c.Anchors[a]=function(c){var d=c.jsPlumbInstance.makeAnchor(["Continuous",{faces:b}],c.elementId,c.jsPlumbInstance);return d.type=a,d}};c.Anchors.Continuous=function(a){return a.jsPlumbInstance.continuousAnchorFactory.get(a)},f("ContinuousLeft",["left"]),f("ContinuousTop",["top"]),f("ContinuousBottom",["bottom"]),f("ContinuousRight",["right"]),e(0,0,0,0,"Assign",function(a,b){var c=b.position||"Fixed";a.positionFinder=c.constructor==String?b.jsPlumbInstance.AnchorPositionFinders[c]:c,a.constructorParams=b}),a.jsPlumbInstance.prototype.AnchorPositionFinders={Fixed:function(a,b,c){return[(a.left-b.left)/c[0],(a.top-b.top)/c[1]]},Grid:function(a,b,c,d){var e=a.left-b.left,f=a.top-b.top,g=c[0]/d.grid[0],h=c[1]/d.grid[1],i=Math.floor(e/g),j=Math.floor(f/h);return[(i*g+g/2)/c[0],(j*h+h/2)/c[1]]}},c.Anchors.Perimeter=function(a){var b=(a=a||{}).anchorCount||60,c=a.shape;if(!c)throw new Error("no shape supplied to Perimeter Anchor type");var d=function(){for(var c=2*Math.PI/b,d=0,e=[],f=0;b>f;f++){var g=.5+.5*Math.sin(d),h=.5+.5*Math.cos(d);e.push([g,h,0,0]),d+=c}return e},e=function(a){for(var c=b/a.length,d=[],e=function(a,e,f,g,h){for(var i=(f-a)/(c=b*h),j=(g-e)/c,k=0;c>k;k++)d.push([a+i*k,e+j*k,0,0])},f=0;f<a.length;f++)e.apply(null,a[f]);return d},f=function(a){for(var b=[],c=0;c<a.length;c++)b.push([a[c][0],a[c][1],a[c][2],a[c][3],1/a.length]);return e(b)},g=function(){return f([[0,0,1,0],[1,0,1,1],[1,1,0,1],[0,1,0,0]])},h={Circle:d,Ellipse:d,Diamond:function(){return f([[.5,0,1,.5],[1,.5,.5,1],[.5,1,0,.5],[0,.5,.5,0]])},Rectangle:g,Square:g,Triangle:function(){return f([[.5,0,1,1],[1,1,0,1],[0,1,.5,0]])},Path:function(a){for(var b=a.points,c=[],d=0,f=0;f<b.length-1;f++){var g=Math.sqrt(Math.pow(b[f][2]-b[f][0])+Math.pow(b[f][3]-b[f][1]));d+=g,c.push([b[f][0],b[f][1],b[f+1][0],b[f+1][1],g])}for(var h=0;h<c.length;h++)c[h][4]=c[h][4]/d;return e(c)}};if(!h[c])throw new Error("Shape ["+c+"] is unknown by Perimeter Anchor type");var j=h[c](a);a.rotation&&(j=function(a,b){for(var c=[],d=b/180*Math.PI,e=0;e<a.length;e++){var f=a[e][0]-.5,g=a[e][1]-.5;c.push([f*Math.cos(d)-g*Math.sin(d)+.5,f*Math.sin(d)+g*Math.cos(d)+.5,a[e][2],a[e][3]])}return c}(j,a.rotation));var k=a.jsPlumbInstance.makeDynamicAnchor(j);return k.type="Perimeter",k}}.call("undefined"!=typeof window?window:this),function(){"use strict";var a=this,b=a.jsPlumb,c=a.jsPlumbUtil,d=a.Biltong;b.Segments={AbstractSegment:function(a){this.params=a,this.findClosestPointOnPath=function(){return{d:1/0,x:null,y:null,l:null}},this.getBounds=function(){return{minX:Math.min(a.x1,a.x2),minY:Math.min(a.y1,a.y2),maxX:Math.max(a.x1,a.x2),maxY:Math.max(a.y1,a.y2)}}},Straight:function(a){var c,e,f,g,h,i,j,k=(b.Segments.AbstractSegment.apply(this,arguments),function(){c=Math.sqrt(Math.pow(h-g,2)+Math.pow(j-i,2)),e=d.gradient({x:g,y:i},{x:h,y:j}),f=-1/e});this.type="Straight",this.getLength=function(){return c},this.getGradient=function(){return e},this.getCoordinates=function(){return{x1:g,y1:i,x2:h,y2:j}},this.setCoordinates=function(a){g=a.x1,i=a.y1,h=a.x2,j=a.y2,k()},this.setCoordinates({x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2}),this.getBounds=function(){return{minX:Math.min(g,h),minY:Math.min(i,j),maxX:Math.max(g,h),maxY:Math.max(i,j)}},this.pointOnPath=function(a,b){if(0!==a||b){if(1!=a||b){var e=b?a>0?a:c+a:a*c;return d.pointOnLine({x:g,y:i},{x:h,y:j},e)}return{x:h,y:j}}return{x:g,y:i}},this.gradientAtPoint=function(){return e},this.pointAlongPathFrom=function(a,b,c){var e=this.pointOnPath(a,c),f=0>=b?{x:g,y:i}:{x:h,y:j};return 0>=b&&Math.abs(b)>1&&(b*=-1),d.pointOnLine(e,f,b)};var l=function(a,b,c){return c>=Math.min(a,b)&&c<=Math.max(a,b)},m=function(a,b,c){return Math.abs(c-a)<Math.abs(c-b)?a:b};this.findClosestPointOnPath=function(a,b){var k={d:1/0,x:null,y:null,l:null,x1:g,x2:h,y1:i,y2:j};if(0===e)k.y=i,k.x=l(g,h,a)?a:m(g,h,a);else if(1/0==e||e==-1/0)k.x=g,k.y=l(i,j,b)?b:m(i,j,b);else{var n=i-e*g,p=(b-f*a-n)/(e-f),q=e*p+n;k.x=l(g,h,p)?p:m(g,h,p),k.y=l(i,j,q)?q:m(i,j,q)}var r=d.lineLength([k.x,k.y],[g,i]);return k.d=d.lineLength([a,b],[k.x,k.y]),k.l=r/c,k}},Arc:function(a){var c=(b.Segments.AbstractSegment.apply(this,arguments),function(b,c){return d.theta([a.cx,a.cy],[b,c])}),e=function(a,b){if(a.anticlockwise){var c=a.startAngle<a.endAngle?a.startAngle+f:a.startAngle;return c-Math.abs(c-a.endAngle)*b}var e=a.endAngle<a.startAngle?a.endAngle+f:a.endAngle,g=Math.abs(e-a.startAngle);return a.startAngle+g*b},f=2*Math.PI;this.radius=a.r,this.anticlockwise=a.ac,this.type="Arc",a.startAngle&&a.endAngle?(this.startAngle=a.startAngle,this.endAngle=a.endAngle,this.x1=a.cx+this.radius*Math.cos(a.startAngle),this.y1=a.cy+this.radius*Math.sin(a.startAngle),this.x2=a.cx+this.radius*Math.cos(a.endAngle),this.y2=a.cy+this.radius*Math.sin(a.endAngle)):(this.startAngle=c(a.x1,a.y1),this.endAngle=c(a.x2,a.y2),this.x1=a.x1,this.y1=a.y1,this.x2=a.x2,this.y2=a.y2),this.endAngle<0&&(this.endAngle+=f),this.startAngle<0&&(this.startAngle+=f);var g=this.endAngle<this.startAngle?this.endAngle+f:this.endAngle;this.sweep=Math.abs(g-this.startAngle),this.anticlockwise&&(this.sweep=f-this.sweep);var h=2*Math.PI*this.radius,i=this.sweep/f,j=h*i;this.getLength=function(){return j},this.getBounds=function(){return{minX:a.cx-a.r,maxX:a.cx+a.r,minY:a.cy-a.r,maxY:a.cy+a.r}};var l=function(a){var b=Math.floor(a),c=Math.ceil(a);return 1e-10>a-b?b:1e-10>c-a?c:a};this.pointOnPath=function(b,c){if(0===b)return{x:this.x1,y:this.y1,theta:this.startAngle};if(1==b)return{x:this.x2,y:this.y2,theta:this.endAngle};c&&(b/=j);var d=e(this,b),f=a.cx+a.r*Math.cos(d),g=a.cy+a.r*Math.sin(d);return{x:l(f),y:l(g),theta:d}},this.gradientAtPoint=function(b,c){var e=this.pointOnPath(b,c),f=d.normal([a.cx,a.cy],[e.x,e.y]);return this.anticlockwise||1/0!=f&&f!=-1/0||(f*=-1),f},this.pointAlongPathFrom=function(b,c,d){var e=this.pointOnPath(b,d),f=c/h*2*Math.PI,g=this.anticlockwise?-1:1,i=e.theta+g*f;return{x:a.cx+this.radius*Math.cos(i),y:a.cy+this.radius*Math.sin(i)}}},Bezier:function(c){this.curve=[{x:c.x1,y:c.y1},{x:c.cp1x,y:c.cp1y},{x:c.cp2x,y:c.cp2y},{x:c.x2,y:c.y2}],b.Segments.AbstractSegment.apply(this,arguments),this.bounds={minX:Math.min(c.x1,c.x2,c.cp1x,c.cp2x),minY:Math.min(c.y1,c.y2,c.cp1y,c.cp2y),maxX:Math.max(c.x1,c.x2,c.cp1x,c.cp2x),maxY:Math.max(c.y1,c.y2,c.cp1y,c.cp2y)},this.type="Bezier";var d=function(b,c,d){return d&&(c=a.jsBezier.locationAlongCurveFrom(b,c>0?0:1,c)),c};this.pointOnPath=function(b,c){return b=d(this.curve,b,c),a.jsBezier.pointOnCurve(this.curve,b)},this.gradientAtPoint=function(b,c){return b=d(this.curve,b,c),a.jsBezier.gradientAtPoint(this.curve,b)},this.pointAlongPathFrom=function(b,c,e){return b=d(this.curve,b,e),a.jsBezier.pointAlongCurveFrom(this.curve,b,c)},this.getLength=function(){return a.jsBezier.getLength(this.curve)},this.getBounds=function(){return this.bounds}}};var e=function(){this.resetBounds=function(){this.bounds={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},this.resetBounds()};b.Connectors.AbstractConnector=function(a){e.apply(this,arguments);var f=[],g=0,h=[],i=[],j=a.stub||0,k=c.isArray(j)?j[0]:j,l=c.isArray(j)?j[1]:j,m=a.gap||0,n=c.isArray(m)?m[0]:m,o=c.isArray(m)?m[1]:m,p=null,q=!1,r=null,s=null,t=!1!==a.editable&&null!=jsPlumb.ConnectorEditors&&null!=jsPlumb.ConnectorEditors[this.type],u=this.setGeometry=function(a,b){q=!b,s=a},v=this.getGeometry=function(){return s};this.hasBeenEdited=function(){return q},this.isEditing=function(){return null!=this.editor&&this.editor.isActive()},this.setEditable=function(a){return t=!(!a||null==jsPlumb.ConnectorEditors||null==jsPlumb.ConnectorEditors[this.type]||null!=this.overrideSetEditable&&!this.overrideSetEditable())&&a},this.isEditable=function(){return t},this.findSegmentForPoint=function(a,b){for(var c={d:1/0,s:null,x:null,y:null,l:null},d=0;d<f.length;d++){var e=f[d].findClosestPointOnPath(a,b);e.d<c.d&&(c.d=e.d,c.l=e.l,c.x=e.x,c.y=e.y,c.s=f[d],c.x1=e.x1,c.x2=e.x2,c.y1=e.y1,c.y2=e.y2,c.index=d)}return c};var x=function(a,b){b&&(a=a>0?a/g:(g+a)/g);for(var c=h.length-1,d=1,e=0;e<h.length;e++)if(h[e][1]>=a){c=e,d=1==a?1:0===a?0:(a-h[e][0])/i[e];break}return{segment:f[c],proportion:d,index:c}};this.setSegments=function(a){p=[],g=0;for(var b=0;b<a.length;b++)p.push(a[b]),g+=a[b].getLength()},this.getLength=function(){return g};var A=function(a){this.lineWidth=a.lineWidth;var b=d.quadrant(a.sourcePos,a.targetPos),c=a.targetPos[0]<a.sourcePos[0],e=a.targetPos[1]<a.sourcePos[1],f=a.lineWidth||1,g=a.sourceEndpoint.anchor.getOrientation(a.sourceEndpoint),h=a.targetEndpoint.anchor.getOrientation(a.targetEndpoint),i=c?a.targetPos[0]:a.sourcePos[0],j=e?a.targetPos[1]:a.sourcePos[1],m=Math.abs(a.targetPos[0]-a.sourcePos[0]),p=Math.abs(a.targetPos[1]-a.sourcePos[1]);if(0===g[0]&&0===g[1]||0===h[0]&&0===h[1]){var q=m>p?0:1,r=[1,0][q];h=[],(g=[])[q]=a.sourcePos[q]>a.targetPos[q]?-1:1,h[q]=a.sourcePos[q]>a.targetPos[q]?1:-1,g[r]=0,h[r]=0}var s=c?m+n*g[0]:n*g[0],t=e?p+n*g[1]:n*g[1],u=c?o*h[0]:m+o*h[0],v=e?o*h[1]:p+o*h[1],w=g[0]*h[0]+g[1]*h[1],x={sx:s,sy:t,tx:u,ty:v,lw:f,xSpan:Math.abs(u-s),ySpan:Math.abs(v-t),mx:(s+u)/2,my:(t+v)/2,so:g,to:h,x:i,y:j,w:m,h:p,segment:b,startStubX:s+g[0]*k,startStubY:t+g[1]*k,endStubX:u+h[0]*l,endStubY:v+h[1]*l,isXGreaterThanStubTimes2:Math.abs(s-u)>k+l,isYGreaterThanStubTimes2:Math.abs(t-v)>k+l,opposite:-1==w,perpendicular:0===w,orthogonal:1==w,sourceAxis:0===g[0]?"y":"x",points:[i,j,m,p,s,t,u,v]};return x.anchorOrientation=x.opposite?"opposite":x.orthogonal?"orthogonal":"perpendicular",x};return this.getSegments=function(){return f},this.updateBounds=function(a){var b=a.getBounds();this.bounds.minX=Math.min(this.bounds.minX,b.minX),this.bounds.maxX=Math.max(this.bounds.maxX,b.maxX),this.bounds.minY=Math.min(this.bounds.minY,b.minY),this.bounds.maxY=Math.max(this.bounds.maxY,b.maxY)},this.pointOnPath=function(a,b){var c=x(a,b);return c.segment&&c.segment.pointOnPath(c.proportion,!1)||[0,0]},this.gradientAtPoint=function(a,b){var c=x(a,b);return c.segment&&c.segment.gradientAtPoint(c.proportion,!1)||0},this.pointAlongPathFrom=function(a,b,c){var d=x(a,c);return d.segment&&d.segment.pointAlongPathFrom(d.proportion,b,!1)||[0,0]},this.compute=function(a){r=A.call(this,a),g=f.length=h.length=i.length=0,this._compute(r,a),this.x=r.points[0],this.y=r.points[1],this.w=r.points[2],this.h=r.points[3],this.segment=r.segment,function(){for(var a=0,b=0;b<f.length;b++){var c=f[b].getLength();i[b]=c/g,h[b]=[a,a+=c/g]}}()},{addSegment:function(a,c,d){if(d.x1!=d.x2||d.y1!=d.y2){var e=new b.Segments[c](d);f.push(e),g+=e.getLength(),a.updateBounds(e)}},prepareCompute:A,sourceStub:k,targetStub:l,maxStub:Math.max(k,l),sourceGap:n,targetGap:o,maxGap:Math.max(n,o),setGeometry:u,getGeometry:v}},c.extend(b.Connectors.AbstractConnector,e);var f=b.Connectors.Straight=function(){this.type="Straight";var a=b.Connectors.AbstractConnector.apply(this,arguments);this._compute=function(b){a.addSegment(this,"Straight",{x1:b.sx,y1:b.sy,x2:b.startStubX,y2:b.startStubY}),a.addSegment(this,"Straight",{x1:b.startStubX,y1:b.startStubY,x2:b.endStubX,y2:b.endStubY}),a.addSegment(this,"Straight",{x1:b.endStubX,y1:b.endStubY,x2:b.tx,y2:b.ty})}};c.extend(b.Connectors.Straight,b.Connectors.AbstractConnector),b.registerConnectorType(f,"Straight"),b.Endpoints.AbstractEndpoint=function(a){return e.apply(this,arguments),{compute:this.compute=function(){var a=this._compute.apply(this,arguments);return this.x=a[0],this.y=a[1],this.w=a[2],this.h=a[3],this.bounds.minX=this.x,this.bounds.minY=this.y,this.bounds.maxX=this.x+this.w,this.bounds.maxY=this.y+this.h,a},cssClass:a.cssClass}},c.extend(b.Endpoints.AbstractEndpoint,e),b.Endpoints.Dot=function(a){this.type="Dot",b.Endpoints.AbstractEndpoint.apply(this,arguments),a=a||{},this.radius=a.radius||10,this.defaultOffset=.5*this.radius,this.defaultInnerRadius=this.radius/3,this._compute=function(a,b,c){this.radius=c.radius||this.radius;var d=a[0]-this.radius,e=a[1]-this.radius,f=2*this.radius,g=2*this.radius;if(c.strokeStyle){var h=c.lineWidth||1;d-=h,e-=h,f+=2*h,g+=2*h}return[d,e,f,g,this.radius]}},c.extend(b.Endpoints.Dot,b.Endpoints.AbstractEndpoint),b.Endpoints.Rectangle=function(a){this.type="Rectangle",b.Endpoints.AbstractEndpoint.apply(this,arguments),a=a||{},this.width=a.width||20,this.height=a.height||20,this._compute=function(a,b,c){var d=c.width||this.width,e=c.height||this.height;return[a[0]-d/2,a[1]-e/2,d,e]}},c.extend(b.Endpoints.Rectangle,b.Endpoints.AbstractEndpoint);var g=function(){b.jsPlumbUIComponent.apply(this,arguments),this._jsPlumb.displayElements=[]};c.extend(g,b.jsPlumbUIComponent,{getDisplayElements:function(){return this._jsPlumb.displayElements},appendDisplayElement:function(a){this._jsPlumb.displayElements.push(a)}}),b.Endpoints.Image=function(d){this.type="Image",g.apply(this,arguments),b.Endpoints.AbstractEndpoint.apply(this,arguments);var e=d.onload,f=d.src||d.url,h=d.cssClass?" "+d.cssClass:"";this._jsPlumb.img=new Image,this._jsPlumb.ready=!1,this._jsPlumb.initialized=!1,this._jsPlumb.deleted=!1,this._jsPlumb.widthToUse=d.width,this._jsPlumb.heightToUse=d.height,this._jsPlumb.endpoint=d.endpoint,this._jsPlumb.img.onload=function(){null!=this._jsPlumb&&(this._jsPlumb.ready=!0,this._jsPlumb.widthToUse=this._jsPlumb.widthToUse||this._jsPlumb.img.width,this._jsPlumb.heightToUse=this._jsPlumb.heightToUse||this._jsPlumb.img.height,e&&e(this))}.bind(this),this._jsPlumb.endpoint.setImage=function(a,b){var c=a.constructor==String?a:a.src;e=b,this._jsPlumb.img.src=c,null!=this.canvas&&this.canvas.setAttribute("src",this._jsPlumb.img.src)}.bind(this),this._jsPlumb.endpoint.setImage(f,e),this._compute=function(a){return this.anchorPoint=a,this._jsPlumb.ready?[a[0]-this._jsPlumb.widthToUse/2,a[1]-this._jsPlumb.heightToUse/2,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse]:[0,0,0,0]},this.canvas=jsPlumb.createElement("img",{position:"absolute",margin:0,padding:0,outline:0},this._jsPlumb.instance.endpointClass+h),this._jsPlumb.widthToUse&&this.canvas.setAttribute("width",this._jsPlumb.widthToUse),this._jsPlumb.heightToUse&&this.canvas.setAttribute("height",this._jsPlumb.heightToUse),this._jsPlumb.instance.appendElement(this.canvas),this.actuallyPaint=function(){if(!this._jsPlumb.deleted){this._jsPlumb.initialized||(this.canvas.setAttribute("src",this._jsPlumb.img.src),this.appendDisplayElement(this.canvas),this._jsPlumb.initialized=!0);var a=this.anchorPoint[0]-this._jsPlumb.widthToUse/2,b=this.anchorPoint[1]-this._jsPlumb.heightToUse/2;c.sizeElement(this.canvas,a,b,this._jsPlumb.widthToUse,this._jsPlumb.heightToUse)}},this.paint=function(b,c){null!=this._jsPlumb&&(this._jsPlumb.ready?this.actuallyPaint(b,c):a.setTimeout(function(){this.paint(b,c)}.bind(this),200))}},c.extend(b.Endpoints.Image,[g,b.Endpoints.AbstractEndpoint],{cleanup:function(a){a&&(this._jsPlumb.deleted=!0,this.canvas&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null)}}),b.Endpoints.Blank=function(a){b.Endpoints.AbstractEndpoint.apply(this,arguments),this.type="Blank",g.apply(this,arguments),this._compute=function(a){return[a[0],a[1],10,0]};var d=a.cssClass?" "+a.cssClass:"";this.canvas=jsPlumb.createElement("div",{display:"block",width:"1px",height:"1px",background:"transparent",position:"absolute"},this._jsPlumb.instance.endpointClass+d),this._jsPlumb.instance.appendElement(this.canvas),this.paint=function(){c.sizeElement(this.canvas,this.x,this.y,this.w,this.h)}},c.extend(b.Endpoints.Blank,[b.Endpoints.AbstractEndpoint,g],{cleanup:function(){this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas)}}),b.Endpoints.Triangle=function(a){this.type="Triangle",b.Endpoints.AbstractEndpoint.apply(this,arguments),(a=a||{}).width=a.width||55,a.height=a.height||55,this.width=a.width,this.height=a.height,this._compute=function(a,b,c){var d=c.width||self.width,e=c.height||self.height;return[a[0]-d/2,a[1]-e/2,d,e]}};var h=b.Overlays.AbstractOverlay=function(a){this.visible=!0,this.isAppendedAtTopLevel=!0,this.component=a.component,this.loc=null==a.location?.5:a.location,this.endpointLoc=null==a.endpointLocation?[.5,.5]:a.endpointLocation,this.visible=!1!==a.visible};h.prototype={cleanup:function(a){a&&(this.component=null,this.canvas=null,this.endpointLoc=null)},reattach:function(){},setVisible:function(a){this.visible=a,this.component.repaint()},isVisible:function(){return this.visible},hide:function(){this.setVisible(!1)},show:function(){this.setVisible(!0)},incrementLocation:function(a){this.loc+=a,this.component.repaint()},setLocation:function(a){this.loc=a,this.component.repaint()},getLocation:function(){return this.loc},updateFrom:function(){}},b.Overlays.Arrow=function(a){this.type="Arrow",h.apply(this,arguments),this.isAppendedAtTopLevel=!1,a=a||{},this.length=a.length||20,this.width=a.width||20,this.id=a.id;var b=(a.direction||1)<0?-1:1,e=a.paintStyle||{lineWidth:1},f=a.foldback||.623;this.computeMaxSize=function(){return 1.5*self.width},this.elementCreated=function(b){if(this.path=b,a.events)for(var c in a.events)jsPlumb.on(b,c,a.events[c])},this.draw=function(a,g){var h,i,j,k;if(a.pointAlongPathFrom){if(c.isString(this.loc)||this.loc>1||this.loc<0){var m=parseInt(this.loc,10),n=this.loc<0?1:0;h=a.pointAlongPathFrom(n,m,!1),i=a.pointAlongPathFrom(n,m-b*this.length/2,!1),j=d.pointOnLine(h,i,this.length)}else if(1==this.loc){if(h=a.pointOnPath(this.loc),i=a.pointAlongPathFrom(this.loc,-this.length),j=d.pointOnLine(h,i,this.length),-1==b){var o=j;j=h,h=o}}else if(0===this.loc){if(j=a.pointOnPath(this.loc),i=a.pointAlongPathFrom(this.loc,this.length),h=d.pointOnLine(j,i,this.length),-1==b){var p=j;j=h,h=p}}else h=a.pointAlongPathFrom(this.loc,b*this.length/2),i=a.pointOnPath(this.loc),j=d.pointOnLine(h,i,this.length);var q={hxy:h,tail:k=d.perpendicularLineTo(h,j,this.width),cxy:d.pointOnLine(h,j,f*this.length)},r=e.strokeStyle||g.strokeStyle,s=e.fillStyle||g.strokeStyle;return{component:a,d:q,lineWidth:e.lineWidth||g.lineWidth,strokeStyle:r,fillStyle:s,minX:Math.min(h.x,k[0].x,k[1].x),maxX:Math.max(h.x,k[0].x,k[1].x),minY:Math.min(h.y,k[0].y,k[1].y),maxY:Math.max(h.y,k[0].y,k[1].y)}}return{component:a,minX:0,maxX:0,minY:0,maxY:0}}},c.extend(b.Overlays.Arrow,h,{updateFrom:function(a){this.length=a.length||this.length,this.width=a.width||this.width,this.direction=null!=a.direction?a.direction:this.direction,this.foldback=a.foldback||this.foldback}}),b.Overlays.PlainArrow=function(a){a=a||{};var c=b.extend(a,{foldback:1});b.Overlays.Arrow.call(this,c),this.type="PlainArrow"},c.extend(b.Overlays.PlainArrow,b.Overlays.Arrow),b.Overlays.Diamond=function(a){var c=(a=a||{}).length||40,d=jsPlumb.extend(a,{length:c/2,foldback:2});b.Overlays.Arrow.call(this,d),this.type="Diamond"},c.extend(b.Overlays.Diamond,b.Overlays.Arrow);var i=function(a,b){return(null==a._jsPlumb.cachedDimensions||b)&&(a._jsPlumb.cachedDimensions=a.getDimensions()),a._jsPlumb.cachedDimensions},j=function(a){b.jsPlumbUIComponent.apply(this,arguments),h.apply(this,arguments);var d=this.fire;this.fire=function(){d.apply(this,arguments),this.component&&this.component.fire.apply(this.component,arguments)},this.detached=!1,this.id=a.id,this._jsPlumb.div=null,this._jsPlumb.initialised=!1,this._jsPlumb.component=a.component,this._jsPlumb.cachedDimensions=null,this._jsPlumb.create=a.create,this._jsPlumb.initiallyInvisible=!1===a.visible,this.getElement=function(){if(null==this._jsPlumb.div){var b=this._jsPlumb.div=jsPlumb.getElement(this._jsPlumb.create(this._jsPlumb.component));b.style.position="absolute",b.className=this._jsPlumb.instance.overlayClass+" "+(this.cssClass?this.cssClass:a.cssClass?a.cssClass:""),this._jsPlumb.instance.appendElement(b),this._jsPlumb.instance.getId(b),this.canvas=b;var c="translate(-50%, -50%)";b.style.webkitTransform=c,b.style.mozTransform=c,b.style.msTransform=c,b.style.oTransform=c,b.style.transform=c,b._jsPlumb=this,!1===a.visible&&(b.style.display="none")}return this._jsPlumb.div},this.draw=function(a,b,d){var e=i(this);if(null!=e&&2==e.length){var f={x:0,y:0};if(d)f={x:d[0],y:d[1]};else if(a.pointOnPath){var g=this.loc,h=!1;(c.isString(this.loc)||this.loc<0||this.loc>1)&&(g=parseInt(this.loc,10),h=!0),f=a.pointOnPath(g,h)}else{var j=this.loc.constructor==Array?this.loc:this.endpointLoc;f={x:j[0]*a.w,y:j[1]*a.h}}var k=f.x-e[0]/2,l=f.y-e[1]/2;return{component:a,d:{minx:k,miny:l,td:e,cxy:f},minX:k,maxX:k+e[0],minY:l,maxY:l+e[1]}}return{minX:0,maxX:0,minY:0,maxY:0}}};c.extend(j,[b.jsPlumbUIComponent,h],{getDimensions:function(){return[1,1]},setVisible:function(a){this._jsPlumb.div&&(this._jsPlumb.div.style.display=a?"block":"none",a&&this._jsPlumb.initiallyInvisible&&(i(this,!0),this.component.repaint(),this._jsPlumb.initiallyInvisible=!1))},clearCachedDimensions:function(){this._jsPlumb.cachedDimensions=null},cleanup:function(a){a?null!=this._jsPlumb.div&&(this._jsPlumb.div._jsPlumb=null,this._jsPlumb.instance.removeElement(this._jsPlumb.div)):(this._jsPlumb&&this._jsPlumb.div&&this._jsPlumb.div.parentNode&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div),this.detached=!0)},reattach:function(a){null!=this._jsPlumb.div&&a.getContainer().appendChild(this._jsPlumb.div),this.detached=!1},computeMaxSize:function(){var a=i(this);return Math.max(a[0],a[1])},paint:function(a){this._jsPlumb.initialised||(this.getElement(),a.component.appendDisplayElement(this._jsPlumb.div),this._jsPlumb.initialised=!0,this.detached&&this._jsPlumb.div.parentNode.removeChild(this._jsPlumb.div)),this._jsPlumb.div.style.left=a.component.x+a.d.minx+"px",this._jsPlumb.div.style.top=a.component.y+a.d.miny+"px"}}),b.Overlays.Custom=function(){this.type="Custom",j.apply(this,arguments)},c.extend(b.Overlays.Custom,j),b.Overlays.GuideLines=function(){var a=this;a.length=50,a.lineWidth=5,this.type="GuideLines",h.apply(this,arguments),b.jsPlumbUIComponent.apply(this,arguments),this.draw=function(b){var c=b.pointAlongPathFrom(a.loc,a.length/2),e=b.pointOnPath(a.loc),f=d.pointOnLine(c,e,a.length),g=d.perpendicularLineTo(c,f,40),h=d.perpendicularLineTo(f,c,20);return{connector:b,head:c,tail:f,headLine:h,tailLine:g,minX:Math.min(c.x,f.x,h[0].x,h[1].x),minY:Math.min(c.y,f.y,h[0].y,h[1].y),maxX:Math.max(c.x,f.x,h[0].x,h[1].x),maxY:Math.max(c.y,f.y,h[0].y,h[1].y)}}},b.Overlays.Label=function(a){this.labelStyle=a.labelStyle,this.cssClass=null!=this.labelStyle?this.labelStyle.cssClass:null;var c=b.extend({create:function(){return jsPlumb.createElement("div")}},a);if(b.Overlays.Custom.call(this,c),this.type="Label",this.label=a.label||"",this.labelText=null,this.labelStyle){var d=this.getElement();if(this.labelStyle.font=this.labelStyle.font||"12px sans-serif",d.style.font=this.labelStyle.font,d.style.color=this.labelStyle.color||"black",this.labelStyle.fillStyle&&(d.style.background=this.labelStyle.fillStyle),this.labelStyle.borderWidth>0){var e=this.labelStyle.borderStyle?this.labelStyle.borderStyle:"black";d.style.border=this.labelStyle.borderWidth+"px solid "+e}this.labelStyle.padding&&(d.style.padding=this.labelStyle.padding)}},c.extend(b.Overlays.Label,b.Overlays.Custom,{cleanup:function(a){a&&(this.div=null,this.label=null,this.labelText=null,this.cssClass=null,this.labelStyle=null)},getLabel:function(){return this.label},setLabel:function(a){this.label=a,this.labelText=null,this.clearCachedDimensions(),this.update(),this.component.repaint()},getDimensions:function(){return this.update(),j.prototype.getDimensions.apply(this,arguments)},update:function(){if("function"==typeof this.label){var a=this.label(this);this.getElement().innerHTML=a.replace(/\r\n/g,"<br/>")}else null==this.labelText&&(this.labelText=this.label,this.getElement().innerHTML=this.labelText.replace(/\r\n/g,"<br/>"))},updateFrom:function(a){a.label&&this.setLabel(a.label)}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var a=this;a.jsPlumb.extend(a.jsPlumbInstance.prototype,{getEventManager:function(){return function(b){var c=b._mottle;return c||(c=b._mottle=new a.Mottle),c}(this)},on:function(){return this.getEventManager().on.apply(this,arguments),this},off:function(){return this.getEventManager().off.apply(this,arguments),this}})}.call("undefined"!=typeof window?window:this),function(){"use strict";var a=this,b=a.jsPlumbUtil,c=a.jsPlumbInstance,d="jsplumb-group-collapsed",e="jsplumb-group-expanded",h="stop",i="revert",j="_groupManager",k="_jsPlumbGroup",m="group:addMember",s=function(a){function f(b,c){for(var d=b.getMembers(),e=0;e<d.length;e++)a[c?"show":"hide"](d[e],!0)}function g(b){var c=b.getMembers(),d=a.getConnections({source:c},!0),e=a.getConnections({target:c},!0),f={};b.connections.source.length=0,b.connections.target.length=0;var g=function(a){for(var c=0;c<a.length;c++)f[a[c].id]||(f[a[c].id]=!0,a[c].source._jsPlumbGroup===b?(a[c].target._jsPlumbGroup!==b&&b.connections.source.push(a[c]),i[a[c].id]=b):a[c].target._jsPlumbGroup===b&&(b.connections.target.push(a[c]),j[a[c].id]=b))};g(d),g(e)}var h={},i={},j={};a.bind("connection",function(a){null!=a.source[k]&&null!=a.target[k]&&a.source[k]===a.target[k]?(i[a.connection.id]=a.source[k],j[a.connection.id]=a.source[k]):(null!=a.source[k]&&(b.suggest(a.source[k].connections.source,a.connection),i[a.connection.id]=a.source[k]),null!=a.target[k]&&(b.suggest(a.target[k].connections.target,a.connection),j[a.connection.id]=a.target[k]))}),a.bind("connectionDetached",function(a){!function(a){delete a.proxies;var c,d=i[a.id];null!=d&&(c=function(b){return b.id===a.id},b.removeWithFunction(d.connections.source,c),b.removeWithFunction(d.connections.target,c),delete i[a.id]),null!=(d=j[a.id])&&(c=function(b){return b.id===a.id},b.removeWithFunction(d.connections.source,c),b.removeWithFunction(d.connections.target,c),delete j[a.id])}(a.connection)}),a.bind("connectionMoved",function(a){var c=(0===a.index?i:j)[a.connection.id];if(c){var d=c.connections[0===a.index?"source":"target"],e=d.indexOf(a.connection);-1!=e&&d.splice(e,1)}}),this.addGroup=function(b){a.addClass(b.el,e),h[b.id]=b,b.manager=this,g(b),a.fire("group:add",{group:b})},this.addToGroup=function(a,b,c){(a=this.getGroup(a))&&a.add(b,c)},this.removeFromGroup=function(a,b,c){(a=this.getGroup(a))&&a.remove(b,null,c)},this.getGroup=function(a){var c=a;if(b.isString(a)&&null==(c=h[a]))throw new TypeError("No such group ["+a+"]");return c},this.getGroups=function(){var a=[];for(var b in h)a.push(h[b]);return a},this.removeGroup=function(b,c){b=this.getGroup(b),this.expandGroup(b,!0),b[c?"removeAll":"orphanAll"](),a.remove(b.getEl()),delete h[b.id],delete a._groups[b.id],a.fire("group:remove",{group:b})},this.removeAllGroups=function(a){for(var b in h)this.removeGroup(h[b],a)};var l=this.collapseConnection=function(b,c,d){var e,f=d.getEl(),g=a.getId(f),h=b.endpoints[c].elementId,i=b.endpoints[0===c?1:0].element;i[k]&&!i[k].shouldProxy()&&i[k].collapsed||(b.proxies=b.proxies||[],b.proxies[c]?e=b.proxies[c].ep:(e=a.addEndpoint(f,{endpoint:d.getEndpoint(b,c),anchor:d.getAnchor(b,c),parameters:{isProxyEndpoint:!0}}))._forceDeleteOnDetach=!0,b.proxies[c]={ep:e,originalEp:b.endpoints[c]},0===c?a.anchorManager.sourceChanged(h,g,b,f):(a.anchorManager.updateOtherEndpoint(b.endpoints[0].elementId,h,g,b),b.target=f,b.targetId=g),b.proxies[c].originalEp.detachFromConnection(b,null,!0),e.connections=[b],b.endpoints[c]=e,b.setVisible(!0))};this.collapseGroup=function(b){if(null!=(b=this.getGroup(b))&&!b.collapsed){var c=b.getEl();if(f(b,!1),b.shouldProxy()){var g=function(a,c){for(var d=0;d<a.length;d++){var e=a[d];l(e,c,b)}};g(b.connections.source,0),g(b.connections.target,1)}b.collapsed=!0,a.removeClass(c,e),a.addClass(c,d),a.revalidate(c),a.fire("group:collapse",{group:b})}};var m=this.expandConnection=function(b,c,d){if(null!=b.proxies&&null!=b.proxies[c]){var e=a.getId(d.getEl()),f=b.proxies[c].originalEp.element,g=b.proxies[c].originalEp.elementId;b.endpoints[c]=b.proxies[c].originalEp,0===c?a.anchorManager.sourceChanged(e,g,b,f):(a.anchorManager.updateOtherEndpoint(b.endpoints[0].elementId,e,g,b),b.target=f,b.targetId=g),b.proxies[c].ep.detachFromConnection(b,null,!0),b.proxies[c].originalEp.addConnection(b),delete b.proxies[c]}};this.expandGroup=function(b,c){if(null!=(b=this.getGroup(b))&&b.collapsed){var g=b.getEl();if(f(b,!0),b.shouldProxy()){var h=function(a,c){for(var d=0;d<a.length;d++){var e=a[d];m(e,c,b)}};h(b.connections.source,0),h(b.connections.target,1)}b.collapsed=!1,a.addClass(g,e),a.removeClass(g,d),a.revalidate(g),this.repaintGroup(b),c||a.fire("group:expand",{group:b})}},this.repaintGroup=function(b){for(var c=(b=this.getGroup(b)).getMembers(),d=0;d<c.length;d++)a.revalidate(c[d])},this.updateConnectionsForGroup=g,this.refreshAllGroups=function(){for(var b in h)g(h[b]),a.dragManager.updateOffsets(a.getId(h[b].getEl()))}},t=function(c,d){function j(a,b){var d=function(a){return a.offsetParent}(a),f=c.getSize(d),g=c.getSize(a),h=b[0],i=h+g[0],j=b[1],k=j+g[1];return i>0&&h<f[0]&&k>0&&j<f[1]}function o(a){var b=c.getId(a),d=c.getOffset(a);a.parentNode.removeChild(a),c.getContainer().appendChild(a),c.setPosition(a,d),delete a._jsPlumbGroup,r(a),c.dragManager.clearParent(a,b)}function p(a){j(a.el,a.pos)||(a.el._jsPlumbGroup.remove(a.el),B?c.remove(a.el):o(a.el))}function q(a){var b=c.getId(a);c.revalidate(a),c.dragManager.revalidateParent(a,b)}function r(a){(B||A)&&a._katavorioDrag.off(h,p),B||A||!z||(a._katavorioDrag.off(i,q),a._katavorioDrag.setRevert(null))}function s(a){(B||A)&&a._katavorioDrag.on(h,p),y&&a._katavorioDrag.setConstrain(!0),x&&a._katavorioDrag.setUseGhostProxy(!0),B||A||!z||(a._katavorioDrag.on(i,q),a._katavorioDrag.setRevert(function(a,b){return!j(a,b)}))}var t=this,u=d.el;this.getEl=function(){return u},this.id=d.id||b.uuid(),u._isJsPlumbGroup=!0;var v=c.getSelector(u,"[jsplumb-group-content]"),w=v&&v.length>0?v[0]:u,x=!0===d.ghost,y=x||!0===d.constrain,z=!1!==d.revert,A=!0===d.orphan,B=!0===d.prune,C=!0===d.dropOverride,D=!1!==d.proxied,E=[];if(this.connections={source:[],target:[],internal:[]},this.getAnchor=function(){return d.anchor||"Continuous"},this.getEndpoint=function(){return d.endpoint||["Dot",{radius:10}]},this.collapsed=!1,!1!==d.draggable){var F={stop:function(a){c.fire("groupDragStop",jsPlumb.extend(a,{group:t}))},scope:"_jsPlumbGroupDrag"};d.dragOptions&&a.jsPlumb.extend(F,d.dragOptions),c.draggable(d.el,F)}!1!==d.droppable&&c.droppable(d.el,{drop:function(a){var b=c.getGroupManager(),d=a.drag.el;if(!d._isJsPlumbGroup){var e=d._jsPlumbGroup;if(e!==t){var f=c.getOffset(d,!0),g=t.collapsed?c.getOffset(u,!0):c.getOffset(w,!0);if(null!=e){if(e.overrideDrop(d,t))return;e.remove(d,!0),b.updateConnectionsForGroup(e)}t.add(d,!0);var h=function(a,c){var d=0==c?1:0;a.each(function(a){a.setVisible(!1),a.endpoints[d].element._jsPlumbGroup===t?(a.endpoints[d].setVisible(!1),b.expandConnection(a,d,t)):(a.endpoints[c].setVisible(!1),b.collapseConnection(a,c,t))})};t.collapsed&&(h(c.select({source:d}),0),h(c.select({target:d}),1));var i=c.getId(d);c.dragManager.setParent(d,i,u,c.getId(u),f),c.setPosition(d,{left:f.left-g.left,top:f.top-g.top}),c.dragManager.revalidateParent(d,i,f),b.updateConnectionsForGroup(t),setTimeout(function(){c.fire(m,{group:t,el:d})},0)}}}});var G=function(a,b){for(var c=null==a.nodeType?a:[a],d=0;d<c.length;d++)b(c[d])};this.overrideDrop=function(){return C&&(z||B||A)},this.add=function(a,b){G(a,function(a){a._jsPlumbGroup=t,E.push(a),c.isAlreadyDraggable(a)&&s(a),a.parentNode!=w&&w.appendChild(a),b||c.fire(m,{group:t,el:a})})},this.remove=function(a,d,e){G(a,function(a){if(delete a._jsPlumbGroup,b.removeWithFunction(E,function(b){return b===a}),d)try{t.getEl().removeChild(a)}catch(f){jsPlumbUtil.log("Could not remove element from Group "+f)}r(a),e||c.fire("group:removeMember",{group:t,el:a})})},this.removeAll=function(){for(var a=0;a<E.length;a++)c.remove(E[a]);E.length=0},this.orphanAll=function(){for(var a=0;a<E.length;a++)o(E[a]);E.length=0},this.getMembers=function(){return E},u[k]=this,c.bind("elementDraggable",function(a){a.el._jsPlumbGroup==this&&s(a.el)}.bind(this)),this.shouldProxy=function(){return D},c.getGroupManager().addGroup(this)};c.prototype.addGroup=function(a){var b=this;if(b._groups=b._groups||{},null!=b._groups[a.id])throw new TypeError("cannot create Group ["+a.id+"]; a Group with that ID exists");if(null!=a.el[k])throw new TypeError("cannot create Group ["+a.id+"]; the given element is already a Group");var c=new t(b,a);return b._groups[c.id]=c,c},c.prototype.addToGroup=function(a,b,c){this.getGroupManager().addToGroup(a,b,c)},c.prototype.removeFromGroup=function(a,b,c){this.getGroupManager().removeFromGroup(a,b,c)},c.prototype.removeGroup=function(a,b){this.getGroupManager().removeGroup(a,b)},c.prototype.removeAllGroups=function(a){this.getGroupManager().removeAllGroups(a)},c.prototype.getGroup=function(a){return this.getGroupManager().getGroup(a)},c.prototype.getGroups=function(){return this.getGroupManager().getGroups()},c.prototype.expandGroup=function(a){this.getGroupManager().expandGroup(a)},c.prototype.collapseGroup=function(a){this.getGroupManager().collapseGroup(a)},c.prototype.repaintGroup=function(a){this.getGroupManager().repaintGroup(a)},c.prototype.toggleGroup=function(a){null!=(a=this.getGroupManager().getGroup(a))&&this.getGroupManager()[a.collapsed?"expandGroup":"collapseGroup"](a)},c.prototype.getGroupManager=function(){var a=this[j];return null==a&&(a=this[j]=new s(this)),a},c.prototype.removeGroupManager=function(){delete this[j]},c.prototype.getGroupFor=function(a){return(a=this.getElement(a))?a[k]:void 0}}.call("undefined"!=typeof window?window:this),function(){"use strict";var b=this.jsPlumb,d=function(a){this.type="Flowchart",(a=a||{}).stub=null==a.stub?30:a.stub;var c,e=b.Connectors.AbstractConnector.apply(this,arguments),f=null==a.midpoint?.5:a.midpoint,g=!0===a.alwaysRespectStubs,h=null,i=null,j=null!=a.cornerRadius?a.cornerRadius:0,k=(a.loopbackRadius,function(a){return 0>a?-1:0===a?0:1}),l=function(a,b,c,d){if(h!=b||i!=c){var e=null==h?d.sx:h,f=null==i?d.sy:i,g=e==b?"v":"h",j=k(b-e),l=k(c-f);h=b,i=c,a.push([e,f,b,c,g,j,l])}},m=function(a){return Math.sqrt(Math.pow(a[0]-a[2],2)+Math.pow(a[1]-a[3],2))},n=function(a){var b=[];return b.push.apply(b,a),b},o=function(a,b,c){for(var d,f=null,g=0;g<b.length-1;g++){if(f=f||n(b[g]),d=n(b[g+1]),j>0&&f[4]!=d[4]){var h=Math.min(j,m(f),m(d));f[2]-=f[5]*h,f[3]-=f[6]*h,d[0]+=d[5]*h,d[1]+=d[6]*h;var i=f[6]==d[5]&&1==d[5]||f[6]==d[5]&&0===d[5]&&f[5]!=d[6]||f[6]==d[5]&&-1==d[5],o=(d[1]>f[3]?1:-1)==(d[0]>f[2]?1:-1),p=o&&i||!o&&!i?d[0]:f[2],q=o&&i||!o&&!i?f[3]:d[1];e.addSegment(a,"Straight",{x1:f[0],y1:f[1],x2:f[2],y2:f[3]}),e.addSegment(a,"Arc",{r:h,x1:f[2],y1:f[3],x2:d[0],y2:d[1],cx:p,cy:q,ac:i})}else{var r=f[2]==f[0]?0:f[2]>f[0]?c.lw/2:-c.lw/2,s=f[3]==f[1]?0:f[3]>f[1]?c.lw/2:-c.lw/2;e.addSegment(a,"Straight",{x1:f[0]-r,y1:f[1]-s,x2:f[2]+r,y2:f[3]+s})}f=d}null!=d&&e.addSegment(a,"Straight",{x1:d[0],y1:d[1],x2:d[2],y2:d[3]})};this._compute=function(a,b){c=[],h=null,i=null,null;var j=function(){return[a.startStubX,a.startStubY,a.endStubX,a.endStubY]},m={perpendicular:j,orthogonal:j,opposite:function(b){var c=a,d="x"==b?0:1;return!g&&{x:function(){return 1==c.so[d]&&(c.startStubX>c.endStubX&&c.tx>c.startStubX||c.sx>c.endStubX&&c.tx>c.sx)||-1==c.so[d]&&(c.startStubX<c.endStubX&&c.tx<c.startStubX||c.sx<c.endStubX&&c.tx<c.sx)},y:function(){return 1==c.so[d]&&(c.startStubY>c.endStubY&&c.ty>c.startStubY||c.sy>c.endStubY&&c.ty>c.sy)||-1==c.so[d]&&(c.startStubY<c.endStubY&&c.ty<c.startStubY||c.sy<c.endStubY&&c.ty<c.sy)}}[b]()?{x:[(a.sx+a.tx)/2,a.startStubY,(a.sx+a.tx)/2,a.endStubY],y:[a.startStubX,(a.sy+a.ty)/2,a.endStubX,(a.sy+a.ty)/2]}[b]:[a.startStubX,a.startStubY,a.endStubX,a.endStubY]}}[a.anchorOrientation](a.sourceAxis),n="x"==a.sourceAxis?0:1,p="x"==a.sourceAxis?1:0,q=m[n],r=m[p],s=m[n+2],t=m[p+2];l(c,m[0],m[1],a);var u=a.startStubX+(a.endStubX-a.startStubX)*f,v=a.startStubY+(a.endStubY-a.startStubY)*f,w={x:[0,1],y:[1,0]},y={perpendicular:function(b){var c=a,e={x:[[c.startStubX,c.endStubX],null,[c.endStubX,c.startStubX]],y:[[c.startStubY,c.endStubY],null,[c.endStubY,c.startStubY]]},f={x:[[u,c.startStubY],[u,c.endStubY]],y:[[c.startStubX,v],[c.endStubX,v]]},g={x:[[c.endStubX,c.startStubY]],y:[[c.startStubX,c.endStubY]]},h={x:[[c.startStubX,c.endStubY],[c.endStubX,c.endStubY]],y:[[c.endStubX,c.startStubY],[c.endStubX,c.endStubY]]},i={x:[[c.startStubX,v],[c.endStubX,v],[c.endStubX,c.endStubY]],y:[[u,c.startStubY],[u,c.endStubY],[c.endStubX,c.endStubY]]},j={x:[c.startStubY,c.endStubY],y:[c.startStubX,c.endStubX]},k=w[b][0],l=w[b][1],m=c.so[k]+1,n=c.to[l]+1,o=-1==c.to[l]&&j[b][1]<j[b][0]||1==c.to[l]&&j[b][1]>j[b][0],p=e[b][m][0],q=e[b][m][1],r={x:[[[1,2,3,4],null,[2,1,4,3]],null,[[4,3,2,1],null,[3,4,1,2]]],y:[[[3,2,1,4],null,[2,3,4,1]],null,[[4,1,2,3],null,[1,4,3,2]]]}[b][m][n];return c.segment==r[3]||c.segment==r[2]&&o?f[b]:c.segment==r[2]&&p>q?g[b]:c.segment==r[2]&&q>=p||c.segment==r[1]&&!o?i[b]:c.segment==r[0]||c.segment==r[1]&&o?h[b]:void 0},orthogonal:function(b,c,d,e,f){var g=a,h={x:-1==g.so[0]?Math.min(c,e):Math.max(c,e),y:-1==g.so[1]?Math.min(c,e):Math.max(c,e)}[b];return{x:[[h,d],[h,f],[e,f]],y:[[d,h],[f,h],[f,e]]}[b]},opposite:function(c,d,f,g){var h=a,i={x:"y",y:"x"}[c],j={x:"height",y:"width"}[c],k=h["is"+c.toUpperCase()+"GreaterThanStubTimes2"];if(b.sourceEndpoint.elementId==b.targetEndpoint.elementId){var l=f+(1-b.sourceEndpoint.anchor[i])*b.sourceInfo[j]+e.maxStub;return{x:[[d,l],[g,l]],y:[[l,d],[l,g]]}[c]}return!k||1==h.so[n]&&d>g||-1==h.so[n]&&g>d?{x:[[d,v],[g,v]],y:[[u,d],[u,g]]}[c]:1==h.so[n]&&g>d||-1==h.so[n]&&d>g?{x:[[u,h.sy],[u,h.ty]],y:[[h.sx,v],[h.tx,v]]}[c]:void 0}}[a.anchorOrientation](a.sourceAxis,q,r,s,t);if(y)for(var z=0;z<y.length;z++)l(c,y[z][0],y[z][1],a);l(c,m[2],m[3],a),l(c,a.tx,a.ty,a),o(this,c,a)}};this.jsPlumbUtil.extend(d,b.Connectors.AbstractConnector),b.registerConnectorType(d,"Flowchart")}.call("undefined"!=typeof window?window:this),function(){"use strict";var b=this.jsPlumb,c=this.jsPlumbUtil;b.Connectors.AbstractBezierConnector=function(a){var c,d=!1!==(a=a||{}).showLoopback,e=(a.curviness,a.margin||5),f=(a.proximityLimit,a.orientation&&"clockwise"===a.orientation),g=a.loopbackRadius||25,h=!1;return this.overrideSetEditable=function(){return!h},this._compute=function(a,b){var i=b.sourcePos,j=b.targetPos,k=Math.abs(i[0]-j[0]),l=Math.abs(i[1]-j[1]);if(d&&b.sourceEndpoint.elementId===b.targetEndpoint.elementId){h=!0;var m=b.sourcePos[0],n=b.sourcePos[1]-e,o=m,p=n-g,q=o-g,r=p-g;k=2*g,l=2*g,a.points[0]=q,a.points[1]=r,a.points[2]=k,a.points[3]=l,c.addSegment(this,"Arc",{loopback:!0,x1:m-q+4,y1:n-r,startAngle:0,endAngle:2*Math.PI,r:g,ac:!f,x2:m-q-4,y2:n-r,cx:o-q,cy:p-r})}else h=!1,this._computeBezier(a,b,i,j,k,l)},c=b.Connectors.AbstractConnector.apply(this,arguments)},c.extend(b.Connectors.AbstractBezierConnector,b.Connectors.AbstractConnector);var d=function(a){a=a||{},this.type="Bezier";var c=b.Connectors.AbstractBezierConnector.apply(this,arguments),d=a.curviness||150,e=10;this.getCurviness=function(){return d},this._findControlPoint=function(a,b,c,f,g,h,i){var k=[];return h[0]!=i[0]||h[1]==i[1]?(0===i[0]?k.push(c[0]<b[0]?a[0]+e:a[0]-e):k.push(a[0]+d*i[0]),0===i[1]?k.push(c[1]<b[1]?a[1]+e:a[1]-e):k.push(a[1]+d*h[1])):(0===h[0]?k.push(b[0]<c[0]?a[0]+e:a[0]-e):k.push(a[0]-d*h[0]),0===h[1]?k.push(b[1]<c[1]?a[1]+e:a[1]-e):k.push(a[1]+d*i[1])),k},this._computeBezier=function(a,b,d,e,f,g){var h,i,j=this.getGeometry(),k=d[0]<e[0]?f:0,l=d[1]<e[1]?g:0,m=d[0]<e[0]?0:f,n=d[1]<e[1]?0:g;(this.hasBeenEdited()||this.isEditing())&&null!=j&&null!=j.controlPoints&&null!=j.controlPoints[0]&&null!=j.controlPoints[1]?(h=j.controlPoints[0],i=j.controlPoints[1]):(h=this._findControlPoint([k,l],d,e,b.sourceEndpoint,b.targetEndpoint,a.so,a.to),i=this._findControlPoint([m,n],e,d,b.targetEndpoint,b.sourceEndpoint,a.to,a.so)),c.setGeometry({controlPoints:[h,i]},!0),c.addSegment(this,"Bezier",{x1:k,y1:l,x2:m,y2:n,cp1x:h[0],cp1y:h[1],cp2x:i[0],cp2y:i[1]})}};c.extend(d,b.Connectors.AbstractBezierConnector),b.registerConnectorType(d,"Bezier")}.call("undefined"!=typeof window?window:this),function(){"use strict";var b=this.jsPlumb,f=function(a){a=a||{},this.type="StateMachine";var c,f=b.Connectors.AbstractBezierConnector.apply(this,arguments),g=a.curviness||10,h=a.margin||5,i=a.proximityLimit||80;a.orientation&&a.orientation,this._computeBezier=function(a,b,j,k,l,m){var n=b.sourcePos[0]<b.targetPos[0]?0:l,o=b.sourcePos[1]<b.targetPos[1]?0:m,p=b.sourcePos[0]<b.targetPos[0]?l:0,q=b.sourcePos[1]<b.targetPos[1]?m:0;0===b.sourcePos[2]&&(n-=h),1===b.sourcePos[2]&&(n+=h),0===b.sourcePos[3]&&(o-=h),1===b.sourcePos[3]&&(o+=h),0===b.targetPos[2]&&(p-=h),1===b.targetPos[2]&&(p+=h),0===b.targetPos[3]&&(q-=h),1===b.targetPos[3]&&(q+=h);var r,s,t,u,v=(n+p)/2,w=(o+q)/2,x=function(a,b,c,d){return c>=a&&b>=d?1:c>=a&&d>=b?2:a>=c&&d>=b?3:4}(n,o,p,q),y=Math.sqrt(Math.pow(p-n,2)+Math.pow(q-o,2)),z=f.getGeometry();(this.hasBeenEdited()||this.isEditing())&&null!=z?(r=z.controlPoints[0][0],t=z.controlPoints[0][1],s=z.controlPoints[1][0],u=z.controlPoints[1][1]):(r=(c=function(a,b,c,d,e,f,g,h,i){return i>=h?[a,b]:1===c?d[3]<=0&&e[3]>=1?[a+(d[2]<.5?-1*f:f),b]:d[2]>=1&&e[2]<=0?[a,b+(d[3]<.5?-1*g:g)]:[a+-1*f,b+-1*g]:2===c?d[3]>=1&&e[3]<=0?[a+(d[2]<.5?-1*f:f),b]:d[2]>=1&&e[2]<=0?[a,b+(d[3]<.5?-1*g:g)]:[a+f,b+-1*g]:3===c?d[3]>=1&&e[3]<=0?[a+(d[2]<.5?-1*f:f),b]:d[2]<=0&&e[2]>=1?[a,b+(d[3]<.5?-1*g:g)]:[a+-1*f,b+-1*g]:4===c?d[3]<=0&&e[3]>=1?[a+(d[2]<.5?-1*f:f),b]:d[2]<=0&&e[2]>=1?[a,b+(d[3]<.5?-1*g:g)]:[a+f,b+-1*g]:void 0}(v,w,x,b.sourcePos,b.targetPos,g,g,y,i))[0],s=c[0],t=c[1],u=c[1],f.setGeometry({controlPoints:[c,c]},!0)),f.addSegment(this,"Bezier",{x1:p,y1:q,x2:n,y2:o,cp1x:r,cp1y:t,cp2x:s,cp2y:u})}};this.jsPlumbUtil.extend(f,b.Connectors.AbstractBezierConnector),b.registerConnectorType(f,"StateMachine")}.call("undefined"!=typeof window?window:this),function(){"use strict";var b=this.jsPlumb,c=this.jsPlumbUtil,d={"stroke-linejoin":"stroke-linejoin","stroke-dashoffset":"stroke-dashoffset","stroke-linecap":"stroke-linecap"},e="stroke-dasharray",f="dashstyle",j="fill",l="stroke",o="none",r_svg="http://www.w3.org/2000/svg",r_xhtml="http://www.w3.org/1999/xhtml",s=function(a,b){for(var c in b)a.setAttribute(c,""+b[c])},t=function(a,b){return(b=b||{}).version="1.1",b.xmlns=r_xhtml,jsPlumb.createElementNS(r_svg,a,null,null,b)},u=function(a){return"position:absolute;left:"+a[0]+"px;top:"+a[1]+"px"},v=function(a){for(var b=a.querySelectorAll(" defs,linearGradient,radialGradient"),c=0;c<b.length;c++)b[c].parentNode.removeChild(b[c])},x=function(a,b,c,g,h){if(b.setAttribute(j,c.fillStyle?c.fillStyle:o),b.setAttribute(l,c.strokeStyle?c.strokeStyle:o),c.gradient?function(a,b,c,d,e){var m,f="jsplumb_gradient_"+e._jsPlumb.instance.idstamp();v(a),m=c.gradient.offset?t("radialGradient",{id:f}):t("linearGradient",{id:f,gradientUnits:"userSpaceOnUse"});var n=t("defs");a.appendChild(n),n.appendChild(m);for(var o=0;o<c.gradient.stops.length;o++){var q=1==e.segment||2==e.segment?o:c.gradient.stops.length-1-o,r=c.gradient.stops[q][1],s=t("stop",{offset:Math.floor(100*c.gradient.stops[o][0])+"%","stop-color":r});m.appendChild(s)}var u=c.strokeStyle?l:j;b.setAttribute(u,"url(#"+f+")")}(a,b,c,0,h):(v(a),b.setAttribute("style","")),c.lineWidth&&b.setAttribute("stroke-width",c.lineWidth),c[f]&&c.lineWidth&&!c[e]){var i=-1==c[f].indexOf(",")?" ":",",p="";c[f].split(i).forEach(function(a){p+=Math.floor(a*c.lineWidth)+i}),b.setAttribute(e,p)}else c[e]&&b.setAttribute(e,c[e]);for(var r in d)c[r]&&b.setAttribute(d[r],c[r])},y=function(a,b,c){a.childNodes.length>c?a.insertBefore(b,a.childNodes[c]):a.appendChild(b)};c.svg={node:t,attr:s,pos:u};var z=function(a){var d=a.pointerEventsSpec||"all",e={};b.jsPlumbUIComponent.apply(this,a.originalArgs),this.canvas=null,this.path=null,this.svg=null,this.bgCanvas=null;var f=a.cssClass+" "+(a.originalArgs[0].cssClass||""),g={style:"",width:0,height:0,"pointer-events":d,position:"absolute"};this.svg=t("svg",g),a.useDivWrapper?(this.canvas=jsPlumb.createElement("div",{position:"absolute"}),c.sizeElement(this.canvas,0,0,1,1),this.canvas.className=f):(s(this.svg,{class:f}),this.canvas=this.svg),a._jsPlumb.appendElement(this.canvas,a.originalArgs[0].parent),a.useDivWrapper&&this.canvas.appendChild(this.svg);var h=[this.canvas];return this.getDisplayElements=function(){return h},this.appendDisplayElement=function(a){h.push(a)},this.paint=function(b,d,f){if(null!=b){var g,h=[this.x,this.y],i=[this.w,this.h];null!=f&&(f.xmin<0&&(h[0]+=f.xmin),f.ymin<0&&(h[1]+=f.ymin),i[0]=f.xmax+(f.xmin<0?-f.xmin:0),i[1]=f.ymax+(f.ymin<0?-f.ymin:0)),a.useDivWrapper?(c.sizeElement(this.canvas,h[0],h[1],i[0],i[1]),h[0]=0,h[1]=0,g=u([0,0])):g=u([h[0],h[1]]),e.paint.apply(this,arguments),s(this.svg,{style:g,width:i[0]||0,height:i[1]||0})}},{renderer:e}};c.extend(z,b.jsPlumbUIComponent,{cleanup:function(a){a||null==this.typeId?(this.canvas&&(this.canvas._jsPlumb=null),this.svg&&(this.svg._jsPlumb=null),this.bgCanvas&&(this.bgCanvas._jsPlumb=null),this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.svg=null,this.canvas=null,this.path=null,this.group=null):(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.bgCanvas&&this.bgCanvas.parentNode&&this.bgCanvas.parentNode.removeChild(this.bgCanvas))},reattach:function(a){var b=a.getContainer();this.canvas&&null==this.canvas.parentNode&&b.appendChild(this.canvas),this.bgCanvas&&null==this.bgCanvas.parentNode&&b.appendChild(this.bgCanvas)},setVisible:function(a){this.canvas&&(this.canvas.style.display=a?"block":"none")}}),b.ConnectorRenderers.svg=function(a){var c=this,d=z.apply(this,[{cssClass:a._jsPlumb.connectorClass+(this.isEditable()?" "+a._jsPlumb.editableConnectorClass:""),originalArgs:arguments,pointerEventsSpec:"none",_jsPlumb:a._jsPlumb}]),e=this.setEditable;this.setEditable=function(a){var b=e.apply(this,[a]);jsPlumb[b?"addClass":"removeClass"](this.canvas,this._jsPlumb.instance.editableConnectorClass)},d.renderer.paint=function(d,e,f){var g=c.getSegments(),h="",i=[0,0];if(f.xmin<0&&(i[0]=-f.xmin),f.ymin<0&&(i[1]=-f.ymin),g.length>0){for(var j=0;j<g.length;j++)h+=b.Segments.svg.SegmentRenderer.getPath(g[j]),h+=" ";var k={d:h,transform:"translate("+i[0]+","+i[1]+")","pointer-events":a["pointer-events"]||"visibleStroke"},l=null;c.x,c.y,c.w,c.h;if(d.outlineColor){var n=d.outlineWidth||1,o=d.lineWidth+2*n;delete(l=b.extend({},d)).gradient,l.strokeStyle=d.outlineColor,l.lineWidth=o,null==c.bgPath?(c.bgPath=t("path",k),b.addClass(c.bgPath,b.connectorOutlineClass),y(c.svg,c.bgPath,0)):s(c.bgPath,k),x(c.svg,c.bgPath,l,0,c)}null==c.path?(c.path=t("path",k),y(c.svg,c.path,d.outlineColor?1:0)):s(c.path,k),x(c.svg,c.path,d,0,c)}}},c.extend(b.ConnectorRenderers.svg,z),b.Segments.svg={SegmentRenderer:{getPath:function(a){return{Straight:function(){var b=a.getCoordinates();return"M "+b.x1+" "+b.y1+" L "+b.x2+" "+b.y2},Bezier:function(){var b=a.params;return"M "+b.x1+" "+b.y1+" C "+b.cp1x+" "+b.cp1y+" "+b.cp2x+" "+b.cp2y+" "+b.x2+" "+b.y2},Arc:function(){var b=a.params,c=a.sweep>Math.PI?1:0,d=a.anticlockwise?0:1;return"M"+a.x1+" "+a.y1+" A "+a.radius+" "+b.r+" 0 "+c+","+d+" "+a.x2+" "+a.y2}}[a.type]()}}};var A=b.SvgEndpoint=function(a){z.apply(this,[{cssClass:a._jsPlumb.endpointClass,originalArgs:arguments,pointerEventsSpec:"all",useDivWrapper:!0,_jsPlumb:a._jsPlumb}]).renderer.paint=function(a){var c=b.extend({},a);c.outlineColor&&(c.strokeWidth=c.outlineWidth,c.strokeStyle=c.outlineColor),null==this.node?(this.node=this.makeNode(c),this.svg.appendChild(this.node)):null!=this.updateNode&&this.updateNode(this.node),x(this.svg,this.node,c,(this.x,this.y,this.w,this.h),this),u(this.node,(this.x,this.y))}.bind(this)};c.extend(A,z),b.Endpoints.svg.Dot=function(){b.Endpoints.Dot.apply(this,arguments),A.apply(this,arguments),this.makeNode=function(){return t("circle",{cx:this.w/2,cy:this.h/2,r:this.radius})},this.updateNode=function(a){s(a,{cx:this.w/2,cy:this.h/2,r:this.radius})}},c.extend(b.Endpoints.svg.Dot,[b.Endpoints.Dot,A]),b.Endpoints.svg.Rectangle=function(){b.Endpoints.Rectangle.apply(this,arguments),A.apply(this,arguments),this.makeNode=function(){return t("rect",{width:this.w,height:this.h})},this.updateNode=function(a){s(a,{width:this.w,height:this.h})}},c.extend(b.Endpoints.svg.Rectangle,[b.Endpoints.Rectangle,A]),b.Endpoints.svg.Image=b.Endpoints.Image,b.Endpoints.svg.Blank=b.Endpoints.Blank,b.Overlays.svg.Label=b.Overlays.Label,b.Overlays.svg.Custom=b.Overlays.Custom;var B=function(a,c){a.apply(this,c),b.jsPlumbUIComponent.apply(this,c),this.isAppendedAtTopLevel=!1,this.path=null,this.paint=function(a,b){if(a.component.svg&&b){null==this.path&&(this.path=t("path",{"pointer-events":"all"}),a.component.svg.appendChild(this.path),this.elementCreated&&this.elementCreated(this.path,a.component),this.canvas=a.component.svg);var e=c&&1==c.length&&c[0].cssClass||"",f=[0,0];b.xmin<0&&(f[0]=-b.xmin),b.ymin<0&&(f[1]=-b.ymin),s(this.path,{d:d(a.d),class:e,stroke:a.strokeStyle?a.strokeStyle:null,fill:a.fillStyle?a.fillStyle:null,transform:"translate("+f[0]+","+f[1]+")"})}};var d=function(a){return isNaN(a.cxy.x)||isNaN(a.cxy.y)?"":"M"+a.hxy.x+","+a.hxy.y+" L"+a.tail[0].x+","+a.tail[0].y+" L"+a.cxy.x+","+a.cxy.y+" L"+a.tail[1].x+","+a.tail[1].y+" L"+a.hxy.x+","+a.hxy.y};this.transfer=function(a){a.canvas&&this.path&&this.path.parentNode&&(this.path.parentNode.removeChild(this.path),a.canvas.appendChild(this.path))}};c.extend(B,[b.jsPlumbUIComponent,b.Overlays.AbstractOverlay],{cleanup:function(a){null!=this.path&&(a?this._jsPlumb.instance.removeElement(this.path):this.path.parentNode&&this.path.parentNode.removeChild(this.path))},reattach:function(){this.path&&this.canvas&&null==this.path.parentNode&&this.canvas.appendChild(this.path)},setVisible:function(a){null!=this.path&&(this.path.style.display=a?"block":"none")}}),b.Overlays.svg.Arrow=function(){B.apply(this,[b.Overlays.Arrow,arguments])},c.extend(b.Overlays.svg.Arrow,[b.Overlays.Arrow,B]),b.Overlays.svg.PlainArrow=function(){B.apply(this,[b.Overlays.PlainArrow,arguments])},c.extend(b.Overlays.svg.PlainArrow,[b.Overlays.PlainArrow,B]),b.Overlays.svg.Diamond=function(){B.apply(this,[b.Overlays.Diamond,arguments])},c.extend(b.Overlays.svg.Diamond,[b.Overlays.Diamond,B]),b.Overlays.svg.GuideLines=function(){var a,c,d=null,e=this;b.Overlays.GuideLines.apply(this,arguments),this.paint=function(b,g){null==d&&(d=t("path"),b.connector.svg.appendChild(d),e.attachListeners(d,b.connector),e.attachListeners(d,e),a=t("path"),b.connector.svg.appendChild(a),e.attachListeners(a,b.connector),e.attachListeners(a,e),c=t("path"),b.connector.svg.appendChild(c),e.attachListeners(c,b.connector),e.attachListeners(c,e));var h=[0,0];g.xmin<0&&(h[0]=-g.xmin),g.ymin<0&&(h[1]=-g.ymin),s(d,{d:f(b.head,b.tail),stroke:"red",fill:null,transform:"translate("+h[0]+","+h[1]+")"}),s(a,{d:f(b.tailLine[0],b.tailLine[1]),stroke:"blue",fill:null,transform:"translate("+h[0]+","+h[1]+")"}),s(c,{d:f(b.headLine[0],b.headLine[1]),stroke:"green",fill:null,transform:"translate("+h[0]+","+h[1]+")"})};var f=function(a,b){return"M "+a.x+","+a.y+" L"+b.x+","+b.y}},c.extend(b.Overlays.svg.GuideLines,b.Overlays.GuideLines)}.call("undefined"!=typeof window?window:this),function(){"use strict";var a=this,b=a.jsPlumb,c=a.jsPlumbUtil,d=a.Katavorio,e=a.Biltong,f=function(a,b){var c="_katavorio_"+(b=b||"main"),f=a[c],g=a.getEventManager();return f||(f=new d({bind:g.on,unbind:g.off,getSize:jsPlumb.getSize,getPosition:function(b,c){var d=a.getOffset(b,c,b._katavorioDrag?b.offsetParent:null);return[d.left,d.top]},setPosition:function(a,b){a.style.left=b[0]+"px",a.style.top=b[1]+"px"},addClass:jsPlumb.addClass,removeClass:jsPlumb.removeClass,intersects:e.intersects,indexOf:function(a,b){return a.indexOf(b)},css:{noSelect:a.dragSelectClass,droppable:"jsplumb-droppable",draggable:"jsplumb-draggable",drag:"jsplumb-drag",selected:"jsplumb-drag-selected",active:"jsplumb-drag-active",hover:"jsplumb-drag-hover",ghostProxy:"jsplumb-ghost-proxy"}}),a[c]=f,a.bind("zoom",f.setZoom)),f},g=function(a,b){var d=function(d){if(null!=b[d]){if(c.isString(b[d])){var e=b[d].match(/-=/)?-1:1,f=b[d].substring(2);return a[d]+e*f}return b[d]}return a[d]};return[d("left"),d("top")]};b.extend(a.jsPlumbInstance.prototype,{animationSupported:!0,getElement:function(a){return null==a?null:"string"==typeof(a="string"==typeof a?a:null!=a.length&&null==a.enctype?a[0]:a)?document.getElementById(a):a},removeElement:function(a){f(this).elementRemoved(a),this.getEventManager().remove(a)},doAnimate:function(a,b,c){c=c||{};var d=this.getOffset(a),e=g(d,b),f=e[0]-d.left,h=e[1]-d.top,i=c.duration||250,k=i/15,l=15/i*f,m=15/i*h,n=0,o=setInterval(function(){jsPlumb.setPosition(a,{left:d.left+l*(n+1),top:d.top+m*(n+1)}),null!=c.step&&c.step(n,Math.ceil(k)),++n>=k&&(window.clearInterval(o),null!=c.complete&&c.complete())},15)},destroyDraggable:function(a,b){f(this,b).destroyDraggable(a)},destroyDroppable:function(a,b){f(this,b).destroyDroppable(a)},initDraggable:function(a,b,c){f(this,c).draggable(a,b)},initDroppable:function(a,b,c){f(this,c).droppable(a,b)},isAlreadyDraggable:function(a){return null!=a._katavorioDrag},isDragSupported:function(){return!0},isDropSupported:function(){return!0},isElementDraggable:function(a){return(a=jsPlumb.getElement(a))._katavorioDrag&&a._katavorioDrag.isEnabled()},getDragObject:function(a){return a[0].drag.getDragElement()},getDragScope:function(a){return a._katavorioDrag&&a._katavorioDrag.scopes.join(" ")||""},getDropEvent:function(a){return a[0].e},getUIPosition:function(a){var b=a[0].el;if(null==b.offsetParent)return null;var c=a[0].finalPos||a[0].pos,d={left:c[0],top:c[1]};if(b._katavorioDrag&&b.offsetParent!==this.getContainer()){var e=this.getOffset(b.offsetParent);d.left+=e.left,d.top+=e.top}return d},setDragFilter:function(a,b,c){a._katavorioDrag&&a._katavorioDrag.setFilter(b,c)},setElementDraggable:function(a,b){(a=jsPlumb.getElement(a))._katavorioDrag&&a._katavorioDrag.setEnabled(b)},setDragScope:function(a,b){a._katavorioDrag&&a._katavorioDrag.k.setDragScope(a,b)},setDropScope:function(a,b){a._katavorioDrop&&a._katavorioDrop.length>0&&a._katavorioDrop[0].k.setDropScope(a,b)},addToPosse:function(a){var b=Array.prototype.slice.call(arguments,1),c=f(this);jsPlumb.each(a,function(a){(a=[jsPlumb.getElement(a)]).push.apply(a,b),c.addToPosse.apply(c,a)})},setPosse:function(a){var b=Array.prototype.slice.call(arguments,1),c=f(this);jsPlumb.each(a,function(a){(a=[jsPlumb.getElement(a)]).push.apply(a,b),c.setPosse.apply(c,a)})},removeFromPosse:function(a){var b=Array.prototype.slice.call(arguments,1),c=f(this);jsPlumb.each(a,function(a){(a=[jsPlumb.getElement(a)]).push.apply(a,b),c.removeFromPosse.apply(c,a)})},removeFromAllPosses:function(a){var b=f(this);jsPlumb.each(a,function(a){b.removeFromAllPosses(jsPlumb.getElement(a))})},setPosseState:function(a,b,c){var d=f(this);jsPlumb.each(a,function(a){d.setPosseState(jsPlumb.getElement(a),b,c)})},dragEvents:{start:"start",stop:"stop",drag:"drag",step:"step",over:"over",out:"out",drop:"drop",complete:"complete",beforeStart:"beforeStart"},animEvents:{step:"step",complete:"complete"},stopDrag:function(a){a._katavorioDrag&&a._katavorioDrag.abort()},addToDragSelection:function(a){f(this).select(a)},removeFromDragSelection:function(a){f(this).deselect(a)},clearDragSelection:function(){f(this).deselectAll()},trigger:function(a,b,c,d){this.getEventManager().trigger(a,b,c,d)},doReset:function(){for(var a in this)0===a.indexOf("_katavorio_")&&this[a].reset()}});!function(a){var b=function(){/complete|loaded|interactive/.test(document.readyState)&&void 0!==document.body&&null!=document.body?a():setTimeout(b,9)};b()}(b.init)}.call("undefined"!=typeof window?window:this),function(){var Farahey;Farahey="undefined"!=typeof exports?exports:this.Farahey={};var geomSupport="undefined"!=typeof jsPlumbGeom?jsPlumbGeom:Biltong,insertSorted=function(array,value,comparator){var ip=function(sortedArr,val,comparator){for(var low=0,high=sortedArr.length,mid=-1,c=0;low<high;)if((c=comparator(sortedArr[mid=parseInt((low+high)/2)],val))<0)low=mid+1;else{if(!(c>0))return mid;high=mid}return low}(array,value,comparator);array.splice(ip,0,value)},_xAdj=[function(r1,r2){return r1.x+r1.w-r2.x},function(r1,r2){return r1.x-(r2.x+r2.w)}],_yAdj=[function(r1,r2){return r1.y+r1.h-r2.y},function(r1,r2){return r1.y-(r2.y+r2.h)}],_adj=[null,[_xAdj[0],_yAdj[1]],[_xAdj[0],_yAdj[0]],[_xAdj[1],_yAdj[0]],[_xAdj[1],_yAdj[1]]],_calculateSpacingAdjustment=Farahey.calculateSpacingAdjustment=function(r1,r2){var c1=r1.center||[r1.x+r1.w/2,r1.y+r1.h/2],c2=r2.center||[r2.x+r2.w/2,r2.y+r2.h/2],m=geomSupport.gradient(c1,c2),s=geomSupport.quadrant(c1,c2);return function(r1,r2,m,b,s){isNaN(m)&&(m=0);var run,rise,r,axis,dim,v,y=r2.y+r2.h,x=m==1/0||m==-1/0?r2.x+r2.w/2:(y-b)/m,theta=Math.atan(m);return dim="w",v=x,(r=r2)[axis="x"]<=v&&v<=r[axis]+r[dim]?{left:run=(rise=_adj[s][1](r1,r2))/Math.sin(theta)*Math.cos(theta),top:rise}:{left:run=_adj[s][0](r1,r2),top:rise=run/Math.cos(theta)*Math.sin(theta)}}(r1,r2,m,m==1/0||m==-1/0||isNaN(m)?0:c1[1]-m*c1[0],s)},_paddedRectangle=Farahey.paddedRectangle=function(o,s,p){return{x:o[0]-p[0],y:o[1]-p[1],w:s[0]+2*p[0],h:s[1]+2*p[1]}};this.Magnetizer=function(params){var minx,miny,maxx,maxy,originDebugMarker,d,getPosition=params.getPosition,getSize=params.getSize,getId=params.getId,setPosition=params.setPosition,padding=params.padding||[20,20],constrain=params.constrain||function(id,current,delta){return delta},positionArray=[],positions={},sizes={},elements=params.elements||[],origin=params.origin||[0,0],executeNow=params.executeNow,filter=(this.getOrigin=function(){return origin},params.filter||function(_){return!0}),orderByDistanceFromOrigin=params.orderByDistanceFromOrigin,comparator=new function(origin,getSize){var _origin=origin,_cache={},_get=function(entry){if(!_cache[entry[1]]){var s=getSize(entry[2]);_cache[entry[1]]={l:entry[0][0],t:entry[0][1],w:s[0],h:s[1],center:[entry[0][0]+s[0]/2,entry[0][1]+s[1]/2]}}return _cache[entry[1]]};this.setOrigin=function(o){_origin=o,_cache={}},this.compare=function(e1,e2){var d1=geomSupport.lineLength(_origin,_get(e1).center),d2=geomSupport.lineLength(_origin,_get(e2).center);return d1<d2?-1:d1==d2?0:1}}(origin,getSize),updateOnStep=params.updateOnStep,stepInterval=params.stepInterval||350,debug=params.debug,_addToPositionArray=function(p){orderByDistanceFromOrigin&&0!=positionArray.length?insertSorted(positionArray,p,comparator.compare):positionArray.push(p)},_updatePositions=function(){comparator.setOrigin(origin),positionArray=[],positions={},sizes={},minx=miny=1/0,maxx=maxy=-1/0;for(var i=0;i<elements.length;i++){var p=getPosition(elements[i]),s=getSize(elements[i]),id=getId(elements[i]);positions[id]=[p.left,p.top],_addToPositionArray([[p.left,p.top],id,elements[i]]),sizes[id]=s,minx=Math.min(minx,p.left),miny=Math.min(miny,p.top),maxx=Math.max(maxx,p.left+s[0]),maxy=Math.max(maxy,p.top+s[1])}},_run=function(){if(elements.length>1){var _movedElements=function(positionArray,positions,sizes,padding,constrain,origin,filter,updateOnStep,stepInterval,stepCallback){origin=origin||[0,0],stepCallback=stepCallback||function(){};var adjustBy,constrainedAdjustment,focus=_paddedRectangle(origin,[1,1],padding),iteration=1,uncleanRun=!0,_movedElements={},_move=function(id,o,x,y){_movedElements[id]=!0,o[0]+=x,o[1]+=y},step=function(){for(var i=0;i<positionArray.length;i++){var o1=positions[positionArray[i][1]],oid=positionArray[i][1],s1=(positionArray[i][2],sizes[positionArray[i][1]]),r1=_paddedRectangle(o1,s1,padding);filter(positionArray[i][1])&&geomSupport.intersects(focus,r1)&&(adjustBy=_calculateSpacingAdjustment(focus,r1),constrainedAdjustment=constrain(positionArray[i][1],o1,adjustBy),_move(oid,o1,constrainedAdjustment.left,constrainedAdjustment.top)),r1=_paddedRectangle(o1,s1,padding);for(var j=0;j<positionArray.length;j++)if(i!=j){var o2=positions[positionArray[j][1]],s2=(positionArray[j][2],sizes[positionArray[j][1]]),r2=_paddedRectangle(o2,s2,padding);geomSupport.intersects(r1,r2)&&filter(positionArray[j][1])&&(uncleanRun=!0,adjustBy=_calculateSpacingAdjustment(r1,r2),constrainedAdjustment=constrain(positionArray[j][1],o2,adjustBy),_move(positionArray[j][1],o2,constrainedAdjustment.left,constrainedAdjustment.top))}}updateOnStep&&stepCallback(),uncleanRun&&iteration<100&&(uncleanRun=!1,iteration++,updateOnStep?window.setTimeout(step,stepInterval):step())};return step(),_movedElements}(positionArray,positions,sizes,padding,constrain,origin,filter,updateOnStep,stepInterval,_positionElements);_positionElements(_movedElements)}},_positionElements=function(_movedElements){for(var i=0;i<elements.length;i++){var id=getId(elements[i]);_movedElements[id]&&setPosition(elements[i],{left:positions[id][0],top:positions[id][1]})}},setOrigin=function(o){null!=o&&(origin=o,comparator.setOrigin(o))};this.execute=function(o){setOrigin(o),_updatePositions(),_run()},this.executeAtCenter=function(){_updatePositions(),setOrigin([(minx+maxx)/2,(miny+maxy)/2]),_run()},this.executeAtEvent=function(e){var c=params.container,o=params.getContainerPosition(c),x=e.pageX-o.left+c[0].scrollLeft,y=e.pageY-o.top+c[0].scrollTop;debug&&(originDebugMarker.style.left=e.pageX+"px",originDebugMarker.style.top=e.pageY+"px"),this.execute([x,y])},this.setElements=function(_els){elements=_els},debug&&((d=document.createElement("div")).style.position="absolute",d.style.width="10px",d.style.height="10px",d.style.backgroundColor="red",document.body.appendChild(d),originDebugMarker=d),executeNow&&this.execute()}}.call(this),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory((global=global||self).d3={})}(this,function(exports){"use strict";function ascending(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function bisector(compare){var f;return 1===compare.length&&(f=compare,compare=function(d,x){return ascending(f(d),x)}),{left:function(a,x,lo,hi){for(null==lo&&(lo=0),null==hi&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)<0?lo=mid+1:hi=mid}return lo},right:function(a,x,lo,hi){for(null==lo&&(lo=0),null==hi&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)>0?hi=mid:lo=mid+1}return lo}}}var ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right,bisectLeft=ascendingBisect.left;function number(x){return null===x?NaN:+x}function sequence(start,stop,step){start=+start,stop=+stop,step=(n=arguments.length)<2?(stop=start,start=0,1):n<3?1:+step;for(var i=-1,n=0|Math.max(0,Math.ceil((stop-start)/step)),range=new Array(n);++i<n;)range[i]=start+i*step;return range}var e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function ticks(start,stop,count){var reverse,n,ticks,step,i=-1;if(count=+count,(start=+start)===(stop=+stop)&&count>0)return[start];if((reverse=stop<start)&&(n=start,start=stop,stop=n),0===(step=tickIncrement(start,stop,count))||!isFinite(step))return[];if(step>0)for(start=Math.ceil(start/step),stop=Math.floor(stop/step),ticks=new Array(n=Math.ceil(stop-start+1));++i<n;)ticks[i]=(start+i)*step;else for(start=Math.floor(start*step),stop=Math.ceil(stop*step),ticks=new Array(n=Math.ceil(start-stop+1));++i<n;)ticks[i]=(start-i)/step;return reverse&&ticks.reverse(),ticks}function tickIncrement(start,stop,count){var step=(stop-start)/Math.max(0,count),power=Math.floor(Math.log(step)/Math.LN10),error=step/Math.pow(10,power);return power>=0?(error>=e10?10:error>=e5?5:error>=e2?2:1)*Math.pow(10,power):-Math.pow(10,-power)/(error>=e10?10:error>=e5?5:error>=e2?2:1)}function tickStep(start,stop,count){var step0=Math.abs(stop-start)/Math.max(0,count),step1=Math.pow(10,Math.floor(Math.log(step0)/Math.LN10)),error=step0/step1;return error>=e10?step1*=10:error>=e5?step1*=5:error>=e2&&(step1*=2),stop<start?-step1:step1}function quantile(values,p,valueof){if(null==valueof&&(valueof=number),n=values.length){if((p=+p)<=0||n<2)return+valueof(values[0],0,values);if(p>=1)return+valueof(values[n-1],n-1,values);var n,i=(n-1)*p,i0=Math.floor(i),value0=+valueof(values[i0],i0,values);return value0+(+valueof(values[i0+1],i0+1,values)-value0)*(i-i0)}}function merge(arrays){for(var m,merged,array,n=arrays.length,i=-1,j=0;++i<n;)j+=arrays[i].length;for(merged=new Array(j);--n>=0;)for(m=(array=arrays[n]).length;--m>=0;)merged[--j]=array[m];return merged}function Map(){}function map(object,f){var map=new Map;if(object instanceof Map)object.each(function(value,key){map.set(key,value)});else if(Array.isArray(object)){var o,i=-1,n=object.length;if(null==f)for(;++i<n;)map.set(i,object[i]);else for(;++i<n;)map.set(f(o=object[i],i,object),o)}else if(object)for(var key in object)map.set(key,object[key]);return map}function Set(){}Map.prototype=map.prototype={constructor:Map,has:function(key){return"$"+key in this},get:function(key){return this["$"+key]},set:function(key,value){return this["$"+key]=value,this},remove:function(key){var property="$"+key;return property in this&&delete this[property]},clear:function(){for(var property in this)"$"===property[0]&&delete this[property]},keys:function(){var keys=[];for(var property in this)"$"===property[0]&&keys.push(property.slice(1));return keys},values:function(){var values=[];for(var property in this)"$"===property[0]&&values.push(this[property]);return values},entries:function(){var entries=[];for(var property in this)"$"===property[0]&&entries.push({key:property.slice(1),value:this[property]});return entries},size:function(){var size=0;for(var property in this)"$"===property[0]&&++size;return size},empty:function(){for(var property in this)if("$"===property[0])return!1;return!0},each:function(f){for(var property in this)"$"===property[0]&&f(this[property],property.slice(1),this)}};var proto=map.prototype;function set(object,f){var set=new Set;if(object instanceof Set)object.each(function(value){set.add(value)});else if(object){var i=-1,n=object.length;if(null==f)for(;++i<n;)set.add(object[i]);else for(;++i<n;)set.add(f(object[i],i,object))}return set}Set.prototype=set.prototype={constructor:Set,has:proto.has,add:function(value){return this["$"+(value+="")]=value,this},remove:proto.remove,clear:proto.clear,values:proto.keys,size:proto.size,empty:proto.empty,each:proto.each};var slice=Array.prototype.slice;function identity(x){return x}var top=1,right=2,bottom=3,left=4,epsilon=1e-6;function translateX(x){return"translate("+(x+.5)+",0)"}function translateY(y){return"translate(0,"+(y+.5)+")"}function entering(){return!this.__axis}function axis(orient,scale){var tickArguments=[],tickValues=null,tickFormat=null,tickSizeInner=6,tickSizeOuter=6,tickPadding=3,k=orient===top||orient===left?-1:1,x=orient===left||orient===right?"x":"y",transform=orient===top||orient===bottom?translateX:translateY;function axis(context){var values=null==tickValues?scale.ticks?scale.ticks.apply(scale,tickArguments):scale.domain():tickValues,format=null==tickFormat?scale.tickFormat?scale.tickFormat.apply(scale,tickArguments):identity:tickFormat,spacing=Math.max(tickSizeInner,0)+tickPadding,range=scale.range(),range0=+range[0]+.5,range1=+range[range.length-1]+.5,position=(scale.bandwidth?function(scale){var offset=Math.max(0,scale.bandwidth()-1)/2;return scale.round()&&(offset=Math.round(offset)),function(d){return+scale(d)+offset}}:function(scale){return function(d){return+scale(d)}})(scale.copy()),selection=context.selection?context.selection():context,path=selection.selectAll(".domain").data([null]),tick=selection.selectAll(".tick").data(values,scale).order(),tickExit=tick.exit(),tickEnter=tick.enter().append("g").attr("class","tick"),line=tick.select("line"),text=tick.select("text");path=path.merge(path.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),tick=tick.merge(tickEnter),line=line.merge(tickEnter.append("line").attr("stroke","#000").attr(x+"2",k*tickSizeInner)),text=text.merge(tickEnter.append("text").attr("fill","#000").attr(x,k*spacing).attr("dy",orient===top?"0em":orient===bottom?"0.71em":"0.32em")),context!==selection&&(path=path.transition(context),tick=tick.transition(context),line=line.transition(context),text=text.transition(context),tickExit=tickExit.transition(context).attr("opacity",epsilon).attr("transform",function(d){return isFinite(d=position(d))?transform(d):this.getAttribute("transform")}),tickEnter.attr("opacity",epsilon).attr("transform",function(d){var p=this.parentNode.__axis;return transform(p&&isFinite(p=p(d))?p:position(d))})),tickExit.remove(),path.attr("d",orient===left||orient==right?"M"+k*tickSizeOuter+","+range0+"H0.5V"+range1+"H"+k*tickSizeOuter:"M"+range0+","+k*tickSizeOuter+"V0.5H"+range1+"V"+k*tickSizeOuter),tick.attr("opacity",1).attr("transform",function(d){return transform(position(d))}),line.attr(x+"2",k*tickSizeInner),text.attr(x,k*spacing).text(format),selection.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",orient===right?"start":orient===left?"end":"middle"),selection.each(function(){this.__axis=position})}return axis.scale=function(_){return arguments.length?(scale=_,axis):scale},axis.ticks=function(){return tickArguments=slice.call(arguments),axis},axis.tickArguments=function(_){return arguments.length?(tickArguments=null==_?[]:slice.call(_),axis):tickArguments.slice()},axis.tickValues=function(_){return arguments.length?(tickValues=null==_?null:slice.call(_),axis):tickValues&&tickValues.slice()},axis.tickFormat=function(_){return arguments.length?(tickFormat=_,axis):tickFormat},axis.tickSize=function(_){return arguments.length?(tickSizeInner=tickSizeOuter=+_,axis):tickSizeInner},axis.tickSizeInner=function(_){return arguments.length?(tickSizeInner=+_,axis):tickSizeInner},axis.tickSizeOuter=function(_){return arguments.length?(tickSizeOuter=+_,axis):tickSizeOuter},axis.tickPadding=function(_){return arguments.length?(tickPadding=+_,axis):tickPadding},axis}var noop={value:function(){}};function dispatch(){for(var t,i=0,n=arguments.length,_={};i<n;++i){if(!(t=arguments[i]+"")||t in _)throw new Error("illegal type: "+t);_[t]=[]}return new Dispatch(_)}function Dispatch(_){this._=_}function get(type,name){for(var c,i=0,n=type.length;i<n;++i)if((c=type[i]).name===name)return c.value}function set$1(type,name,callback){for(var i=0,n=type.length;i<n;++i)if(type[i].name===name){type[i]=noop,type=type.slice(0,i).concat(type.slice(i+1));break}return null!=callback&&type.push({name:name,value:callback}),type}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(typename,callback){var t,types,_=this._,T=(types=_,(typename+"").trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");if(i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),t&&!types.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:name}})),i=-1,n=T.length;if(!(arguments.length<2)){if(null!=callback&&"function"!=typeof callback)throw new Error("invalid callback: "+callback);for(;++i<n;)if(t=(typename=T[i]).type)_[t]=set$1(_[t],typename.name,callback);else if(null==callback)for(t in _)_[t]=set$1(_[t],typename.name,null);return this}for(;++i<n;)if((t=(typename=T[i]).type)&&(t=get(_[t],typename.name)))return t},copy:function(){var copy={},_=this._;for(var t in _)copy[t]=_[t].slice();return new Dispatch(copy)},call:function(type,that){if((n=arguments.length-2)>0)for(var n,t,args=new Array(n),i=0;i<n;++i)args[i]=arguments[i+2];if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(i=0,n=(t=this._[type]).length;i<n;++i)t[i].value.apply(that,args)},apply:function(type,that,args){if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(var t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)}};var xhtml="http://www.w3.org/1999/xhtml",namespaces={svg:"http://www.w3.org/2000/svg",xhtml:xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(name){var prefix=name+="",i=prefix.indexOf(":");return i>=0&&"xmlns"!==(prefix=name.slice(0,i))&&(name=name.slice(i+1)),namespaces.hasOwnProperty(prefix)?{space:namespaces[prefix],local:name}:name}function creator(name){var fullname=namespace(name);return(fullname.local?function(fullname){return function(){return this.ownerDocument.createElementNS(fullname.space,fullname.local)}}:function(name){return function(){var document=this.ownerDocument,uri=this.namespaceURI;return uri===xhtml&&document.documentElement.namespaceURI===xhtml?document.createElement(name):document.createElementNS(uri,name)}})(fullname)}var nextId=0;function local(){return new Local}function Local(){this._="@"+(++nextId).toString(36)}Local.prototype=local.prototype={constructor:Local,get:function(node){for(var id=this._;!(id in node);)if(!(node=node.parentNode))return;return node[id]},set:function(node,value){return node[this._]=value},remove:function(node){return this._ in node&&delete node[this._]},toString:function(){return this._}};var matcher=function(selector){return function(){return this.matches(selector)}};if("undefined"!=typeof document){var element=document.documentElement;if(!element.matches){var vendorMatches=element.webkitMatchesSelector||element.msMatchesSelector||element.mozMatchesSelector||element.oMatchesSelector;matcher=function(selector){return function(){return vendorMatches.call(this,selector)}}}}var matcher$1=matcher,filterEvents={};(exports.event=null,"undefined"!=typeof document)&&("onmouseenter"in document.documentElement||(filterEvents={mouseenter:"mouseover",mouseleave:"mouseout"}));function filterContextListener(listener,index,group){return listener=contextListener(listener,index,group),function(event){var related=event.relatedTarget;related&&(related===this||8&related.compareDocumentPosition(this))||listener.call(this,event)}}function contextListener(listener,index,group){return function(event1){var event0=exports.event;exports.event=event1;try{listener.call(this,this.__data__,index,group)}finally{exports.event=event0}}}function onRemove(typename){return function(){var on=this.__on;if(on){for(var o,j=0,i=-1,m=on.length;j<m;++j)o=on[j],typename.type&&o.type!==typename.type||o.name!==typename.name?on[++i]=o:this.removeEventListener(o.type,o.listener,o.capture);++i?on.length=i:delete this.__on}}}function onAdd(typename,value,capture){var wrap=filterEvents.hasOwnProperty(typename.type)?filterContextListener:contextListener;return function(d,i,group){var o,on=this.__on,listener=wrap(value,i,group);if(on)for(var j=0,m=on.length;j<m;++j)if((o=on[j]).type===typename.type&&o.name===typename.name)return this.removeEventListener(o.type,o.listener,o.capture),this.addEventListener(o.type,o.listener=listener,o.capture=capture),void(o.value=value);this.addEventListener(typename.type,listener,capture),o={type:typename.type,name:typename.name,value:value,listener:listener,capture:capture},on?on.push(o):this.__on=[o]}}function customEvent(event1,listener,that,args){var event0=exports.event;event1.sourceEvent=exports.event,exports.event=event1;try{return listener.apply(that,args)}finally{exports.event=event0}}function sourceEvent(){for(var source,current=exports.event;source=current.sourceEvent;)current=source;return current}function point(node,event){var svg=node.ownerSVGElement||node;if(svg.createSVGPoint){var point=svg.createSVGPoint();return point.x=event.clientX,point.y=event.clientY,[(point=point.matrixTransform(node.getScreenCTM().inverse())).x,point.y]}var rect=node.getBoundingClientRect();return[event.clientX-rect.left-node.clientLeft,event.clientY-rect.top-node.clientTop]}function mouse(node){var event=sourceEvent();return event.changedTouches&&(event=event.changedTouches[0]),point(node,event)}function none(){}function selector(selector){return null==selector?none:function(){return this.querySelector(selector)}}function empty(){return[]}function selectorAll(selector){return null==selector?empty:function(){return this.querySelectorAll(selector)}}function sparse(update){return new Array(update.length)}function EnterNode(parent,datum){this.ownerDocument=parent.ownerDocument,this.namespaceURI=parent.namespaceURI,this._next=null,this._parent=parent,this.__data__=datum}EnterNode.prototype={constructor:EnterNode,appendChild:function(child){return this._parent.insertBefore(child,this._next)},insertBefore:function(child,next){return this._parent.insertBefore(child,next)},querySelector:function(selector){return this._parent.querySelector(selector)},querySelectorAll:function(selector){return this._parent.querySelectorAll(selector)}};var keyPrefix="$";function bindIndex(parent,group,enter,update,exit,data){for(var node,i=0,groupLength=group.length,dataLength=data.length;i<dataLength;++i)(node=group[i])?(node.__data__=data[i],update[i]=node):enter[i]=new EnterNode(parent,data[i]);for(;i<groupLength;++i)(node=group[i])&&(exit[i]=node)}function bindKey(parent,group,enter,update,exit,data,key){var i,node,keyValue,nodeByKeyValue={},groupLength=group.length,dataLength=data.length,keyValues=new Array(groupLength);for(i=0;i<groupLength;++i)(node=group[i])&&(keyValues[i]=keyValue=keyPrefix+key.call(node,node.__data__,i,group),keyValue in nodeByKeyValue?exit[i]=node:nodeByKeyValue[keyValue]=node);for(i=0;i<dataLength;++i)(node=nodeByKeyValue[keyValue=keyPrefix+key.call(parent,data[i],i,data)])?(update[i]=node,node.__data__=data[i],nodeByKeyValue[keyValue]=null):enter[i]=new EnterNode(parent,data[i]);for(i=0;i<groupLength;++i)(node=group[i])&&nodeByKeyValue[keyValues[i]]===node&&(exit[i]=node)}function ascending$1(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}function defaultView(node){return node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView}function styleValue(node,name){return node.style.getPropertyValue(name)||defaultView(node).getComputedStyle(node,null).getPropertyValue(name)}function classArray(string){return string.trim().split(/^|\s+/)}function classList(node){return node.classList||new ClassList(node)}function ClassList(node){this._node=node,this._names=classArray(node.getAttribute("class")||"")}function classedAdd(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.add(names[i])}function classedRemove(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.remove(names[i])}function textRemove(){this.textContent=""}function htmlRemove(){this.innerHTML=""}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function constantNull(){return null}function remove(){var parent=this.parentNode;parent&&parent.removeChild(this)}function dispatchEvent(node,type,params){var window=defaultView(node),event=window.CustomEvent;"function"==typeof event?event=new event(type,params):(event=window.document.createEvent("Event"),params?(event.initEvent(type,params.bubbles,params.cancelable),event.detail=params.detail):event.initEvent(type,!1,!1)),node.dispatchEvent(event)}ClassList.prototype={add:function(name){this._names.indexOf(name)<0&&(this._names.push(name),this._node.setAttribute("class",this._names.join(" ")))},remove:function(name){var i=this._names.indexOf(name);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(name){return this._names.indexOf(name)>=0}};var root=[null];function Selection(groups,parents){this._groups=groups,this._parents=parents}function selection(){return new Selection([[document.documentElement]],root)}function select(selector){return"string"==typeof selector?new Selection([[document.querySelector(selector)]],[document.documentElement]):new Selection([[selector]],root)}function touch(node,touches,identifier){arguments.length<3&&(identifier=touches,touches=sourceEvent().changedTouches);for(var touch,i=0,n=touches?touches.length:0;i<n;++i)if((touch=touches[i]).identifier===identifier)return point(node,touch);return null}function nopropagation(){exports.event.stopImmediatePropagation()}function noevent(){exports.event.preventDefault(),exports.event.stopImmediatePropagation()}function dragDisable(view){var root=view.document.documentElement,selection=select(view).on("dragstart.drag",noevent,!0);"onselectstart"in root?selection.on("selectstart.drag",noevent,!0):(root.__noselect=root.style.MozUserSelect,root.style.MozUserSelect="none")}function yesdrag(view,noclick){var root=view.document.documentElement,selection=select(view).on("dragstart.drag",null);noclick&&(selection.on("click.drag",noevent,!0),setTimeout(function(){selection.on("click.drag",null)},0)),"onselectstart"in root?selection.on("selectstart.drag",null):(root.style.MozUserSelect=root.__noselect,delete root.__noselect)}function constant$1(x){return function(){return x}}function DragEvent(target,type,subject,id,active,x,y,dx,dy,dispatch){this.target=target,this.type=type,this.subject=subject,this.identifier=id,this.active=active,this.x=x,this.y=y,this.dx=dx,this.dy=dy,this._=dispatch}function defaultFilter(){return!exports.event.button}function defaultContainer(){return this.parentNode}function defaultSubject(d){return null==d?{x:exports.event.x,y:exports.event.y}:d}function defaultTouchable(){return"ontouchstart"in this}function define(constructor,factory,prototype){constructor.prototype=factory.prototype=prototype,prototype.constructor=constructor}function extend(parent,definition){var prototype=Object.create(parent.prototype);for(var key in definition)prototype[key]=definition[key];return prototype}function Color(){}Selection.prototype=selection.prototype={constructor:Selection,select:function(select){"function"!=typeof select&&(select=selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode);return new Selection(subgroups,this._parents)},selectAll:function(select){"function"!=typeof select&&(select=selectorAll(select));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&(subgroups.push(select.call(node,node.__data__,i,group)),parents.push(node));return new Selection(subgroups,parents)},filter:function(match){"function"!=typeof match&&(match=matcher$1(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Selection(subgroups,this._parents)},data:function(value,key){if(!value)return data=new Array(this.size()),j=-1,this.each(function(d){data[++j]=d}),data;var x,bind=key?bindKey:bindIndex,parents=this._parents,groups=this._groups;"function"!=typeof value&&(x=value,value=function(){return x});for(var m=groups.length,update=new Array(m),enter=new Array(m),exit=new Array(m),j=0;j<m;++j){var parent=parents[j],group=groups[j],groupLength=group.length,data=value.call(parent,parent&&parent.__data__,j,parents),dataLength=data.length,enterGroup=enter[j]=new Array(dataLength),updateGroup=update[j]=new Array(dataLength);bind(parent,group,enterGroup,updateGroup,exit[j]=new Array(groupLength),data,key);for(var previous,next,i0=0,i1=0;i0<dataLength;++i0)if(previous=enterGroup[i0]){for(i0>=i1&&(i1=i0+1);!(next=updateGroup[i1])&&++i1<dataLength;);previous._next=next||null}}return(update=new Selection(update,parents))._enter=enter,update._exit=exit,update},enter:function(){return new Selection(this._enter||this._groups.map(sparse),this._parents)},exit:function(){return new Selection(this._exit||this._groups.map(sparse),this._parents)},merge:function(selection){for(var groups0=this._groups,groups1=selection._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Selection(merges,this._parents)},order:function(){for(var groups=this._groups,j=-1,m=groups.length;++j<m;)for(var node,group=groups[j],i=group.length-1,next=group[i];--i>=0;)(node=group[i])&&(next&&next!==node.nextSibling&&next.parentNode.insertBefore(node,next),next=node);return this},sort:function(compare){function compareNode(a,b){return a&&b?compare(a.__data__,b.__data__):!a-!b}compare||(compare=ascending$1);for(var groups=this._groups,m=groups.length,sortgroups=new Array(m),j=0;j<m;++j){for(var node,group=groups[j],n=group.length,sortgroup=sortgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(sortgroup[i]=node);sortgroup.sort(compareNode)}return new Selection(sortgroups,this._parents).order()},call:function(){var callback=arguments[0];return arguments[0]=this,callback.apply(null,arguments),this},nodes:function(){var nodes=new Array(this.size()),i=-1;return this.each(function(){nodes[++i]=this}),nodes},node:function(){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var group=groups[j],i=0,n=group.length;i<n;++i){var node=group[i];if(node)return node}return null},size:function(){var size=0;return this.each(function(){++size}),size},empty:function(){return!this.node()},each:function(callback){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var node,group=groups[j],i=0,n=group.length;i<n;++i)(node=group[i])&&callback.call(node,node.__data__,i,group);return this},attr:function(name,value){var fullname=namespace(name);if(arguments.length<2){var node=this.node();return fullname.local?node.getAttributeNS(fullname.space,fullname.local):node.getAttribute(fullname)}return this.each((null==value?fullname.local?function(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}:function(name){return function(){this.removeAttribute(name)}}:"function"==typeof value?fullname.local?function(fullname,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttributeNS(fullname.space,fullname.local):this.setAttributeNS(fullname.space,fullname.local,v)}}:function(name,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttribute(name):this.setAttribute(name,v)}}:fullname.local?function(fullname,value){return function(){this.setAttributeNS(fullname.space,fullname.local,value)}}:function(name,value){return function(){this.setAttribute(name,value)}})(fullname,value))},style:function(name,value,priority){return arguments.length>1?this.each((null==value?function(name){return function(){this.style.removeProperty(name)}}:"function"==typeof value?function(name,value,priority){return function(){var v=value.apply(this,arguments);null==v?this.style.removeProperty(name):this.style.setProperty(name,v,priority)}}:function(name,value,priority){return function(){this.style.setProperty(name,value,priority)}})(name,value,null==priority?"":priority)):styleValue(this.node(),name)},property:function(name,value){return arguments.length>1?this.each((null==value?function(name){return function(){delete this[name]}}:"function"==typeof value?function(name,value){return function(){var v=value.apply(this,arguments);null==v?delete this[name]:this[name]=v}}:function(name,value){return function(){this[name]=value}})(name,value)):this.node()[name]},classed:function(name,value){var names=classArray(name+"");if(arguments.length<2){for(var list=classList(this.node()),i=-1,n=names.length;++i<n;)if(!list.contains(names[i]))return!1;return!0}return this.each(("function"==typeof value?function(names,value){return function(){(value.apply(this,arguments)?classedAdd:classedRemove)(this,names)}}:value?function(names){return function(){classedAdd(this,names)}}:function(names){return function(){classedRemove(this,names)}})(names,value))},text:function(value){return arguments.length?this.each(null==value?textRemove:("function"==typeof value?function(value){return function(){var v=value.apply(this,arguments);this.textContent=null==v?"":v}}:function(value){return function(){this.textContent=value}})(value)):this.node().textContent},html:function(value){return arguments.length?this.each(null==value?htmlRemove:("function"==typeof value?function(value){return function(){var v=value.apply(this,arguments);this.innerHTML=null==v?"":v}}:function(value){return function(){this.innerHTML=value}})(value)):this.node().innerHTML},raise:function(){return this.each(raise)},lower:function(){return this.each(lower)},append:function(name){var create="function"==typeof name?name:creator(name);return this.select(function(){return this.appendChild(create.apply(this,arguments))})},insert:function(name,before){var create="function"==typeof name?name:creator(name),select=null==before?constantNull:"function"==typeof before?before:selector(before);return this.select(function(){return this.insertBefore(create.apply(this,arguments),select.apply(this,arguments)||null)})},remove:function(){return this.each(remove)},datum:function(value){return arguments.length?this.property("__data__",value):this.node().__data__},on:function(typename,value,capture){var i,t,typenames=function(typenames){return typenames.trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");return i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),{type:t,name:name}})}(typename+""),n=typenames.length;if(!(arguments.length<2)){for(on=value?onAdd:onRemove,null==capture&&(capture=!1),i=0;i<n;++i)this.each(on(typenames[i],value,capture));return this}var on=this.node().__on;if(on)for(var o,j=0,m=on.length;j<m;++j)for(i=0,o=on[j];i<n;++i)if((t=typenames[i]).type===o.type&&t.name===o.name)return o.value},dispatch:function(type,params){return this.each(("function"==typeof params?function(type,params){return function(){return dispatchEvent(this,type,params.apply(this,arguments))}}:function(type,params){return function(){return dispatchEvent(this,type,params)}})(type,params))}},DragEvent.prototype.on=function(){var value=this._.on.apply(this._,arguments);return value===this._?this:value};var reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex3=/^#([0-9a-f]{3})$/,reHex6=/^#([0-9a-f]{6})$/,reRgbInteger=new RegExp("^rgb\\("+[reI,reI,reI]+"\\)$"),reRgbPercent=new RegExp("^rgb\\("+[reP,reP,reP]+"\\)$"),reRgbaInteger=new RegExp("^rgba\\("+[reI,reI,reI,reN]+"\\)$"),reRgbaPercent=new RegExp("^rgba\\("+[reP,reP,reP,reN]+"\\)$"),reHslPercent=new RegExp("^hsl\\("+[reN,reP,reP]+"\\)$"),reHslaPercent=new RegExp("^hsla\\("+[reN,reP,reP,reN]+"\\)$"),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color(format){var m;return format=(format+"").trim().toLowerCase(),(m=reHex3.exec(format))?new Rgb((m=parseInt(m[1],16))>>8&15|m>>4&240,m>>4&15|240&m,(15&m)<<4|15&m,1):(m=reHex6.exec(format))?rgbn(parseInt(m[1],16)):(m=reRgbInteger.exec(format))?new Rgb(m[1],m[2],m[3],1):(m=reRgbPercent.exec(format))?new Rgb(255*m[1]/100,255*m[2]/100,255*m[3]/100,1):(m=reRgbaInteger.exec(format))?rgba(m[1],m[2],m[3],m[4]):(m=reRgbaPercent.exec(format))?rgba(255*m[1]/100,255*m[2]/100,255*m[3]/100,m[4]):(m=reHslPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,1):(m=reHslaPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,m[4]):named.hasOwnProperty(format)?rgbn(named[format]):"transparent"===format?new Rgb(NaN,NaN,NaN,0):null}function rgbn(n){return new Rgb(n>>16&255,n>>8&255,255&n,1)}function rgba(r,g,b,a){return a<=0&&(r=g=b=NaN),new Rgb(r,g,b,a)}function rgbConvert(o){return o instanceof Color||(o=color(o)),o?new Rgb((o=o.rgb()).r,o.g,o.b,o.opacity):new Rgb}function rgb(r,g,b,opacity){return 1===arguments.length?rgbConvert(r):new Rgb(r,g,b,null==opacity?1:opacity)}function Rgb(r,g,b,opacity){this.r=+r,this.g=+g,this.b=+b,this.opacity=+opacity}function hsla(h,s,l,a){return a<=0?h=s=l=NaN:l<=0||l>=1?h=s=NaN:s<=0&&(h=NaN),new Hsl(h,s,l,a)}function hsl(h,s,l,opacity){return 1===arguments.length?function(o){if(o instanceof Hsl)return new Hsl(o.h,o.s,o.l,o.opacity);if(o instanceof Color||(o=color(o)),!o)return new Hsl;if(o instanceof Hsl)return o;var r=(o=o.rgb()).r/255,g=o.g/255,b=o.b/255,min=Math.min(r,g,b),max=Math.max(r,g,b),h=NaN,s=max-min,l=(max+min)/2;return s?(h=r===max?(g-b)/s+6*(g<b):g===max?(b-r)/s+2:(r-g)/s+4,s/=l<.5?max+min:2-max-min,h*=60):s=l>0&&l<1?0:h,new Hsl(h,s,l,o.opacity)}(h):new Hsl(h,s,l,null==opacity?1:opacity)}function Hsl(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function hsl2rgb(h,m1,m2){return 255*(h<60?m1+(m2-m1)*h/60:h<180?m2:h<240?m1+(m2-m1)*(240-h)/60:m1)}define(Color,color,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+""}}),define(Rgb,rgb,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},toString:function(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}})),define(Hsl,hsl,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var h=this.h%360+360*(this.h<0),s=isNaN(h)||isNaN(this.s)?0:this.s,l=this.l,m2=l+(l<.5?l:1-l)*s,m1=2*l-m2;return new Rgb(hsl2rgb(h>=240?h-240:h+120,m1,m2),hsl2rgb(h,m1,m2),hsl2rgb(h<120?h+240:h-120,m1,m2),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var deg2rad=Math.PI/180,rad2deg=180/Math.PI,Xn=.95047,Yn=1,Zn=1.08883,t0=4/29,t1=6/29,t2=3*t1*t1,t3=t1*t1*t1;function labConvert(o){if(o instanceof Lab)return new Lab(o.l,o.a,o.b,o.opacity);if(o instanceof Hcl){var h=o.h*deg2rad;return new Lab(o.l,Math.cos(h)*o.c,Math.sin(h)*o.c,o.opacity)}o instanceof Rgb||(o=rgbConvert(o));var b=rgb2xyz(o.r),a=rgb2xyz(o.g),l=rgb2xyz(o.b),x=xyz2lab((.4124564*b+.3575761*a+.1804375*l)/Xn),y=xyz2lab((.2126729*b+.7151522*a+.072175*l)/Yn);return new Lab(116*y-16,500*(x-y),200*(y-xyz2lab((.0193339*b+.119192*a+.9503041*l)/Zn)),o.opacity)}function lab(l,a,b,opacity){return 1===arguments.length?labConvert(l):new Lab(l,a,b,null==opacity?1:opacity)}function Lab(l,a,b,opacity){this.l=+l,this.a=+a,this.b=+b,this.opacity=+opacity}function xyz2lab(t){return t>t3?Math.pow(t,1/3):t/t2+t0}function lab2xyz(t){return t>t1?t*t*t:t2*(t-t0)}function xyz2rgb(x){return 255*(x<=.0031308?12.92*x:1.055*Math.pow(x,1/2.4)-.055)}function rgb2xyz(x){return(x/=255)<=.04045?x/12.92:Math.pow((x+.055)/1.055,2.4)}function hcl(h,c,l,opacity){return 1===arguments.length?function(o){if(o instanceof Hcl)return new Hcl(o.h,o.c,o.l,o.opacity);o instanceof Lab||(o=labConvert(o));var h=Math.atan2(o.b,o.a)*rad2deg;return new Hcl(h<0?h+360:h,Math.sqrt(o.a*o.a+o.b*o.b),o.l,o.opacity)}(h):new Hcl(h,c,l,null==opacity?1:opacity)}function Hcl(h,c,l,opacity){this.h=+h,this.c=+c,this.l=+l,this.opacity=+opacity}define(Lab,lab,extend(Color,{brighter:function(k){return new Lab(this.l+18*(null==k?1:k),this.a,this.b,this.opacity)},darker:function(k){return new Lab(this.l-18*(null==k?1:k),this.a,this.b,this.opacity)},rgb:function(){var y=(this.l+16)/116,x=isNaN(this.a)?y:y+this.a/500,z=isNaN(this.b)?y:y-this.b/200;return y=Yn*lab2xyz(y),new Rgb(xyz2rgb(3.2404542*(x=Xn*lab2xyz(x))-1.5371385*y-.4985314*(z=Zn*lab2xyz(z))),xyz2rgb(-.969266*x+1.8760108*y+.041556*z),xyz2rgb(.0556434*x-.2040259*y+1.0572252*z),this.opacity)}})),define(Hcl,hcl,extend(Color,{brighter:function(k){return new Hcl(this.h,this.c,this.l+18*(null==k?1:k),this.opacity)},darker:function(k){return new Hcl(this.h,this.c,this.l-18*(null==k?1:k),this.opacity)},rgb:function(){return labConvert(this).rgb()}}));var A=-.14861,B=1.78277,C=-.29227,D=-.90649,E=1.97294,ED=E*D,EB=E*B,BC_DA=B*C-D*A;function cubehelix(h,s,l,opacity){return 1===arguments.length?function(o){if(o instanceof Cubehelix)return new Cubehelix(o.h,o.s,o.l,o.opacity);o instanceof Rgb||(o=rgbConvert(o));var r=o.r/255,g=o.g/255,b=o.b/255,l=(BC_DA*b+ED*r-EB*g)/(BC_DA+ED-EB),bl=b-l,k=(E*(g-l)-C*bl)/D,s=Math.sqrt(k*k+bl*bl)/(E*l*(1-l)),h=s?Math.atan2(k,bl)*rad2deg-120:NaN;return new Cubehelix(h<0?h+360:h,s,l,o.opacity)}(h):new Cubehelix(h,s,l,null==opacity?1:opacity)}function Cubehelix(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function basis(t1,v0,v1,v2,v3){var t2=t1*t1,t3=t2*t1;return((1-3*t1+3*t2-t3)*v0+(4-6*t2+3*t3)*v1+(1+3*t1+3*t2-3*t3)*v2+t3*v3)/6}function basis$1(values){var n=values.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),v1=values[i],v2=values[i+1],v0=i>0?values[i-1]:2*v1-v2,v3=i<n-1?values[i+2]:2*v2-v1;return basis((t-i/n)*n,v0,v1,v2,v3)}}function basisClosed(values){var n=values.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n),v0=values[(i+n-1)%n],v1=values[i%n],v2=values[(i+1)%n],v3=values[(i+2)%n];return basis((t-i/n)*n,v0,v1,v2,v3)}}function constant$2(x){return function(){return x}}function linear(a,d){return function(t){return a+t*d}}function hue(a,b){var d=b-a;return d?linear(a,d>180||d<-180?d-360*Math.round(d/360):d):constant$2(isNaN(a)?b:a)}function gamma(y){return 1==(y=+y)?nogamma:function(a,b){return b-a?function(a,b,y){return a=Math.pow(a,y),b=Math.pow(b,y)-a,y=1/y,function(t){return Math.pow(a+t*b,y)}}(a,b,y):constant$2(isNaN(a)?b:a)}}function nogamma(a,b){var d=b-a;return d?linear(a,d):constant$2(isNaN(a)?b:a)}define(Cubehelix,cubehelix,extend(Color,{brighter:function(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Cubehelix(this.h,this.s,this.l*k,this.opacity)},darker:function(k){return k=null==k?.7:Math.pow(.7,k),new Cubehelix(this.h,this.s,this.l*k,this.opacity)},rgb:function(){var h=isNaN(this.h)?0:(this.h+120)*deg2rad,l=+this.l,a=isNaN(this.s)?0:this.s*l*(1-l),cosh=Math.cos(h),sinh=Math.sin(h);return new Rgb(255*(l+a*(A*cosh+B*sinh)),255*(l+a*(C*cosh+D*sinh)),255*(l+a*(E*cosh)),this.opacity)}}));var interpolateRgb=function rgbGamma(y){var color=gamma(y);function rgb$1(start,end){var r=color((start=rgb(start)).r,(end=rgb(end)).r),g=color(start.g,end.g),b=color(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.r=r(t),start.g=g(t),start.b=b(t),start.opacity=opacity(t),start+""}}return rgb$1.gamma=rgbGamma,rgb$1}(1);function rgbSpline(spline){return function(colors){var i,color,n=colors.length,r=new Array(n),g=new Array(n),b=new Array(n);for(i=0;i<n;++i)color=rgb(colors[i]),r[i]=color.r||0,g[i]=color.g||0,b[i]=color.b||0;return r=spline(r),g=spline(g),b=spline(b),color.opacity=1,function(t){return color.r=r(t),color.g=g(t),color.b=b(t),color+""}}}var rgbBasis=rgbSpline(basis$1),rgbBasisClosed=rgbSpline(basisClosed);function array(a,b){var i,nb=b?b.length:0,na=a?Math.min(nb,a.length):0,x=new Array(na),c=new Array(nb);for(i=0;i<na;++i)x[i]=interpolateValue(a[i],b[i]);for(;i<nb;++i)c[i]=b[i];return function(t){for(i=0;i<na;++i)c[i]=x[i](t);return c}}function date(a,b){var d=new Date;return b-=a=+a,function(t){return d.setTime(a+b*t),d}}function interpolateNumber(a,b){return b-=a=+a,function(t){return a+b*t}}function object(a,b){var k,i={},c={};for(k in null!==a&&"object"==typeof a||(a={}),null!==b&&"object"==typeof b||(b={}),b)k in a?i[k]=interpolateValue(a[k],b[k]):c[k]=b[k];return function(t){for(k in i)c[k]=i[k](t);return c}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function interpolateString(a,b){var am,bm,bs,bi=reA.lastIndex=reB.lastIndex=0,i=-1,s=[],q=[];for(a+="",b+="";(am=reA.exec(a))&&(bm=reB.exec(b));)(bs=bm.index)>bi&&(bs=b.slice(bi,bs),s[i]?s[i]+=bs:s[++i]=bs),(am=am[0])===(bm=bm[0])?s[i]?s[i]+=bm:s[++i]=bm:(s[++i]=null,q.push({i:i,x:interpolateNumber(am,bm)})),bi=reB.lastIndex;return bi<b.length&&(bs=b.slice(bi),s[i]?s[i]+=bs:s[++i]=bs),s.length<2?q[0]?function(b){return function(t){return b(t)+""}}(q[0].x):function(b){return function(){return b}}(b):(b=q.length,function(t){for(var o,i=0;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})}function interpolateValue(a,b){var c,t=typeof b;return null==b||"boolean"===t?constant$2(b):("number"===t?interpolateNumber:"string"===t?(c=color(b))?(b=c,interpolateRgb):interpolateString:b instanceof color?interpolateRgb:b instanceof Date?date:Array.isArray(b)?array:"function"!=typeof b.valueOf&&"function"!=typeof b.toString||isNaN(b)?object:interpolateNumber)(a,b)}function interpolateRound(a,b){return b-=a=+a,function(t){return Math.round(a+b*t)}}var cssNode,cssRoot,cssView,svgNode,degrees=180/Math.PI,identity$1={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(a,b,c,d,e,f){var scaleX,scaleY,skewX;return(scaleX=Math.sqrt(a*a+b*b))&&(a/=scaleX,b/=scaleX),(skewX=a*c+b*d)&&(c-=a*skewX,d-=b*skewX),(scaleY=Math.sqrt(c*c+d*d))&&(c/=scaleY,d/=scaleY,skewX/=scaleY),a*d<b*c&&(a=-a,b=-b,skewX=-skewX,scaleX=-scaleX),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*degrees,skewX:Math.atan(skewX)*degrees,scaleX:scaleX,scaleY:scaleY}}function interpolateTransform(parse,pxComma,pxParen,degParen){function pop(s){return s.length?s.pop()+" ":""}return function(a,b){var s=[],q=[];return a=parse(a),b=parse(b),function(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push("translate(",null,pxComma,null,pxParen);q.push({i:i-4,x:interpolateNumber(xa,xb)},{i:i-2,x:interpolateNumber(ya,yb)})}else(xb||yb)&&s.push("translate("+xb+pxComma+yb+pxParen)}(a.translateX,a.translateY,b.translateX,b.translateY,s,q),function(a,b,s,q){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),q.push({i:s.push(pop(s)+"rotate(",null,degParen)-2,x:interpolateNumber(a,b)})):b&&s.push(pop(s)+"rotate("+b+degParen)}(a.rotate,b.rotate,s,q),function(a,b,s,q){a!==b?q.push({i:s.push(pop(s)+"skewX(",null,degParen)-2,x:interpolateNumber(a,b)}):b&&s.push(pop(s)+"skewX("+b+degParen)}(a.skewX,b.skewX,s,q),function(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push(pop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:interpolateNumber(xa,xb)},{i:i-2,x:interpolateNumber(ya,yb)})}else 1===xb&&1===yb||s.push(pop(s)+"scale("+xb+","+yb+")")}(a.scaleX,a.scaleY,b.scaleX,b.scaleY,s,q),a=b=null,function(t){for(var o,i=-1,n=q.length;++i<n;)s[(o=q[i]).i]=o.x(t);return s.join("")}}}var interpolateTransformCss=interpolateTransform(function(value){return"none"===value?identity$1:(cssNode||(cssNode=document.createElement("DIV"),cssRoot=document.documentElement,cssView=document.defaultView),cssNode.style.transform=value,value=cssView.getComputedStyle(cssRoot.appendChild(cssNode),null).getPropertyValue("transform"),cssRoot.removeChild(cssNode),decompose(+(value=value.slice(7,-1).split(","))[0],+value[1],+value[2],+value[3],+value[4],+value[5]))},"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(function(value){return null==value?identity$1:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",value),(value=svgNode.transform.baseVal.consolidate())?decompose((value=value.matrix).a,value.b,value.c,value.d,value.e,value.f):identity$1)},", ",")",")"),rho=Math.SQRT2,rho2=2,rho4=4,epsilon2=1e-12;function cosh(x){return((x=Math.exp(x))+1/x)/2}function interpolateZoom(p0,p1){var i,S,ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy;if(d2<epsilon2)S=Math.log(w1/w0)/rho,i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(rho*t*S)]};else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+rho4*d2)/(2*w0*rho2*d1),b1=(w1*w1-w0*w0-rho4*d2)/(2*w1*rho2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/rho,i=function(t){var x,s=t*S,coshr0=cosh(r0),u=w0/(rho2*d1)*(coshr0*(x=rho*s+r0,((x=Math.exp(2*x))-1)/(x+1))-function(x){return((x=Math.exp(x))-1/x)/2}(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/cosh(rho*s+r0)]}}return i.duration=1e3*S,i}function hsl$1(hue){return function(start,end){var h=hue((start=hsl(start)).h,(end=hsl(end)).h),s=nogamma(start.s,end.s),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.s=s(t),start.l=l(t),start.opacity=opacity(t),start+""}}}var hsl$2=hsl$1(hue),hslLong=hsl$1(nogamma);function hcl$1(hue){return function(start,end){var h=hue((start=hcl(start)).h,(end=hcl(end)).h),c=nogamma(start.c,end.c),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.c=c(t),start.l=l(t),start.opacity=opacity(t),start+""}}}var hcl$2=hcl$1(hue),hclLong=hcl$1(nogamma);function cubehelix$1(hue){return function cubehelixGamma(y){function cubehelix$1(start,end){var h=hue((start=cubehelix(start)).h,(end=cubehelix(end)).h),s=nogamma(start.s,end.s),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.s=s(t),start.l=l(Math.pow(t,y)),start.opacity=opacity(t),start+""}}return y=+y,cubehelix$1.gamma=cubehelixGamma,cubehelix$1}(1)}var cubehelix$2=cubehelix$1(hue),cubehelixLong=cubehelix$1(nogamma);var taskHead,taskTail,frame=0,timeout=0,interval=0,pokeDelay=1e3,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(callback,delay,time){var t=new Timer;return t.restart(callback,delay,time),t}function timerFlush(){now(),++frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(null,e),t=t._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout=0;try{timerFlush()}finally{frame=0,function(){var t0,t2,t1=taskHead,time=1/0;for(;t1;)t1._call?(time>t1._time&&(time=t1._time),t0=t1,t1=t1._next):(t2=t1._next,t1._next=null,t1=t0?t0._next=t2:taskHead=t2);taskTail=t0,sleep(time)}(),clockNow=0}}function poke(){var now=clock.now(),delay=now-clockLast;delay>pokeDelay&&(clockSkew-=delay,clockLast=now)}function sleep(time){frame||(timeout&&(timeout=clearTimeout(timeout)),time-clockNow>24?(time<1/0&&(timeout=setTimeout(wake,time-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake)))}function timeout$1(callback,delay,time){var t=new Timer;return delay=null==delay?0:+delay,t.restart(function(elapsed){t.stop(),callback(elapsed+delay)},delay,time),t}Timer.prototype=timer.prototype={constructor:Timer,restart:function(callback,delay,time){if("function"!=typeof callback)throw new TypeError("callback is not a function");time=(null==time?now():+time)+(null==delay?0:+delay),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=callback,this._time=time,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var emptyOn=dispatch("start","end","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(node,name,id,index,group,timing){var schedules=node.__transition;if(schedules){if(id in schedules)return}else node.__transition={};!function(node,id,self){var tween,schedules=node.__transition;function start(elapsed){var i,j,n,o;if(self.state!==SCHEDULED)return stop();for(i in schedules)if((o=schedules[i]).name===self.name){if(o.state===STARTED)return timeout$1(start);o.state===RUNNING?(o.state=ENDED,o.timer.stop(),o.on.call("interrupt",node,node.__data__,o.index,o.group),delete schedules[i]):+i<id&&(o.state=ENDED,o.timer.stop(),delete schedules[i])}if(timeout$1(function(){self.state===STARTED&&(self.state=RUNNING,self.timer.restart(tick,self.delay,self.time),tick(elapsed))}),self.state=STARTING,self.on.call("start",node,node.__data__,self.index,self.group),self.state===STARTING){for(self.state=STARTED,tween=new Array(n=self.tween.length),i=0,j=-1;i<n;++i)(o=self.tween[i].value.call(node,node.__data__,self.index,self.group))&&(tween[++j]=o);tween.length=j+1}}function tick(elapsed){for(var t=elapsed<self.duration?self.ease.call(null,elapsed/self.duration):(self.timer.restart(stop),self.state=ENDING,1),i=-1,n=tween.length;++i<n;)tween[i].call(null,t);self.state===ENDING&&(self.on.call("end",node,node.__data__,self.index,self.group),stop())}function stop(){for(var i in self.state=ENDED,self.timer.stop(),delete schedules[id],schedules)return;delete node.__transition}schedules[id]=self,self.timer=timer(function(elapsed){self.state=SCHEDULED,self.timer.restart(start,self.delay,self.time),self.delay<=elapsed&&start(elapsed-self.delay)},0,self.time)}(node,id,{name:name,index:index,group:group,on:emptyOn,tween:emptyTween,time:timing.time,delay:timing.delay,duration:timing.duration,ease:timing.ease,timer:null,state:CREATED})}function init(node,id){var schedule=get$1(node,id);if(schedule.state>CREATED)throw new Error("too late; already scheduled");return schedule}function set$2(node,id){var schedule=get$1(node,id);if(schedule.state>STARTING)throw new Error("too late; already started");return schedule}function get$1(node,id){var schedule=node.__transition;if(!schedule||!(schedule=schedule[id]))throw new Error("transition not found");return schedule}function interrupt(node,name){var schedule,active,i,schedules=node.__transition,empty=!0;if(schedules){for(i in name=null==name?null:name+"",schedules)(schedule=schedules[i]).name===name?(active=schedule.state>STARTING&&schedule.state<ENDING,schedule.state=ENDED,schedule.timer.stop(),active&&schedule.on.call("interrupt",node,node.__data__,schedule.index,schedule.group),delete schedules[i]):empty=!1;empty&&delete node.__transition}}function tweenValue(transition,name,value){var id=transition._id;return transition.each(function(){var schedule=set$2(this,id);(schedule.value||(schedule.value={}))[name]=value.apply(this,arguments)}),function(node){return get$1(node,id).value[name]}}function interpolate(a,b){var c;return("number"==typeof b?interpolateNumber:b instanceof color?interpolateRgb:(c=color(b))?(b=c,interpolateRgb):interpolateString)(a,b)}var Selection$1=selection.prototype.constructor;var id=0;function Transition(groups,parents,name,id){this._groups=groups,this._parents=parents,this._name=name,this._id=id}function transition(name){return selection().transition(name)}function newId(){return++id}var selection_prototype=selection.prototype;function quadInOut(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function cubicInOut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Transition.prototype=transition.prototype={constructor:Transition,select:function(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode,schedule(subgroup[i],name,id,i,subgroup,get$1(node,id)));return new Transition(subgroups,this._parents,name,id)},selectAll:function(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=selectorAll(select));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){for(var child,children=select.call(node,node.__data__,i,group),inherit=get$1(node,id),k=0,l=children.length;k<l;++k)(child=children[k])&&schedule(child,name,id,k,children,inherit);subgroups.push(children),parents.push(node)}return new Transition(subgroups,parents,name,id)},filter:function(match){"function"!=typeof match&&(match=matcher$1(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Transition(subgroups,this._parents,this._name,this._id)},merge:function(transition){if(transition._id!==this._id)throw new Error;for(var groups0=this._groups,groups1=transition._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Transition(merges,this._parents,this._name,this._id)},selection:function(){return new Selection$1(this._groups,this._parents)},transition:function(){for(var name=this._name,id0=this._id,id1=newId(),groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){var inherit=get$1(node,id0);schedule(node,name,id1,i,group,{time:inherit.time+inherit.delay+inherit.duration,delay:0,duration:inherit.duration,ease:inherit.ease})}return new Transition(groups,this._parents,name,id1)},call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:function(name,listener){var id=this._id;return arguments.length<2?get$1(this.node(),id).on.on(name):this.each(function(id,name,listener){var on0,on1,sit=function(name){return(name+"").trim().split(/^|\s+/).every(function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||"start"===t})}(name)?init:set$2;return function(){var schedule=sit(this,id),on=schedule.on;on!==on0&&(on1=(on0=on).copy()).on(name,listener),schedule.on=on1}}(id,name,listener))},attr:function(name,value){var fullname=namespace(name),i="transform"===fullname?interpolateTransformSvg:interpolate;return this.attrTween(name,"function"==typeof value?(fullname.local?function(fullname,interpolate,value){var value00,value10,interpolate0;return function(){var value0,value1=value(this);if(null!=value1)return(value0=this.getAttributeNS(fullname.space,fullname.local))===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate(value00=value0,value10=value1);this.removeAttributeNS(fullname.space,fullname.local)}}:function(name,interpolate,value){var value00,value10,interpolate0;return function(){var value0,value1=value(this);if(null!=value1)return(value0=this.getAttribute(name))===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate(value00=value0,value10=value1);this.removeAttribute(name)}})(fullname,i,tweenValue(this,"attr."+name,value)):null==value?(fullname.local?function(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}:function(name){return function(){this.removeAttribute(name)}})(fullname):(fullname.local?function(fullname,interpolate,value1){var value00,interpolate0;return function(){var value0=this.getAttributeNS(fullname.space,fullname.local);return value0===value1?null:value0===value00?interpolate0:interpolate0=interpolate(value00=value0,value1)}}:function(name,interpolate,value1){var value00,interpolate0;return function(){var value0=this.getAttribute(name);return value0===value1?null:value0===value00?interpolate0:interpolate0=interpolate(value00=value0,value1)}})(fullname,i,value+""))},attrTween:function(name,value){var key="attr."+name;if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;var fullname=namespace(name);return this.tween(key,(fullname.local?function(fullname,value){function tween(){var node=this,i=value.apply(node,arguments);return i&&function(t){node.setAttributeNS(fullname.space,fullname.local,i(t))}}return tween._value=value,tween}:function(name,value){function tween(){var node=this,i=value.apply(node,arguments);return i&&function(t){node.setAttribute(name,i(t))}}return tween._value=value,tween})(fullname,value))},style:function(name,value,priority){var i="transform"==(name+="")?interpolateTransformCss:interpolate;return null==value?this.styleTween(name,function(name,interpolate){var value00,value10,interpolate0;return function(){var value0=styleValue(this,name),value1=(this.style.removeProperty(name),styleValue(this,name));return value0===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate(value00=value0,value10=value1)}}(name,i)).on("end.style."+name,function(name){return function(){this.style.removeProperty(name)}}(name)):this.styleTween(name,"function"==typeof value?function(name,interpolate,value){var value00,value10,interpolate0;return function(){var value0=styleValue(this,name),value1=value(this);return null==value1&&(this.style.removeProperty(name),value1=styleValue(this,name)),value0===value1?null:value0===value00&&value1===value10?interpolate0:interpolate0=interpolate(value00=value0,value10=value1)}}(name,i,tweenValue(this,"style."+name,value)):function(name,interpolate,value1){var value00,interpolate0;return function(){var value0=styleValue(this,name);return value0===value1?null:value0===value00?interpolate0:interpolate0=interpolate(value00=value0,value1)}}(name,i,value+""),priority)},styleTween:function(name,value,priority){var key="style."+(name+="");if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,function(name,value,priority){function tween(){var node=this,i=value.apply(node,arguments);return i&&function(t){node.style.setProperty(name,i(t),priority)}}return tween._value=value,tween}(name,value,null==priority?"":priority))},text:function(value){return this.tween("text","function"==typeof value?function(value){return function(){var value1=value(this);this.textContent=null==value1?"":value1}}(tweenValue(this,"text",value)):function(value){return function(){this.textContent=value}}(null==value?"":value+""))},remove:function(){return this.on("end.remove",(id=this._id,function(){var parent=this.parentNode;for(var i in this.__transition)if(+i!==id)return;parent&&parent.removeChild(this)}));var id},tween:function(name,value){var id=this._id;if(name+="",arguments.length<2){for(var t,tween=get$1(this.node(),id).tween,i=0,n=tween.length;i<n;++i)if((t=tween[i]).name===name)return t.value;return null}return this.each((null==value?function(id,name){var tween0,tween1;return function(){var schedule=set$2(this,id),tween=schedule.tween;if(tween!==tween0)for(var i=0,n=(tween1=tween0=tween).length;i<n;++i)if(tween1[i].name===name){(tween1=tween1.slice()).splice(i,1);break}schedule.tween=tween1}}:function(id,name,value){var tween0,tween1;if("function"!=typeof value)throw new Error;return function(){var schedule=set$2(this,id),tween=schedule.tween;if(tween!==tween0){tween1=(tween0=tween).slice();for(var t={name:name,value:value},i=0,n=tween1.length;i<n;++i)if(tween1[i].name===name){tween1[i]=t;break}i===n&&tween1.push(t)}schedule.tween=tween1}})(id,name,value))},delay:function(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?function(id,value){return function(){init(this,id).delay=+value.apply(this,arguments)}}:function(id,value){return value=+value,function(){init(this,id).delay=value}})(id,value)):get$1(this.node(),id).delay},duration:function(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?function(id,value){return function(){set$2(this,id).duration=+value.apply(this,arguments)}}:function(id,value){return value=+value,function(){set$2(this,id).duration=value}})(id,value)):get$1(this.node(),id).duration},ease:function(value){var id=this._id;return arguments.length?this.each(function(id,value){if("function"!=typeof value)throw new Error;return function(){set$2(this,id).ease=value}}(id,value)):get$1(this.node(),id).ease}};var polyIn=function custom(e){function polyIn(t){return Math.pow(t,e)}return e=+e,polyIn.exponent=custom,polyIn}(3),polyOut=function custom(e){function polyOut(t){return 1-Math.pow(1-t,e)}return e=+e,polyOut.exponent=custom,polyOut}(3),polyInOut=function custom(e){function polyInOut(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,polyInOut.exponent=custom,polyInOut}(3),pi=Math.PI,halfPi=pi/2;function sinInOut(t){return(1-Math.cos(pi*t))/2}function expInOut(t){return((t*=2)<=1?Math.pow(2,10*t-10):2-Math.pow(2,10-10*t))/2}function circleInOut(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var b1=4/11,b2=6/11,b3=8/11,b4=.75,b5=9/11,b6=10/11,b7=.9375,b8=21/22,b9=63/64,b0=1/b1/b1;function bounceOut(t){return(t=+t)<b1?b0*t*t:t<b3?b0*(t-=b2)*t+b4:t<b6?b0*(t-=b5)*t+b7:b0*(t-=b8)*t+b9}var backIn=function custom(s){function backIn(t){return t*t*((s+1)*t-s)}return s=+s,backIn.overshoot=custom,backIn}(1.70158),backOut=function custom(s){function backOut(t){return--t*t*((s+1)*t+s)+1}return s=+s,backOut.overshoot=custom,backOut}(1.70158),backInOut=function custom(s){function backInOut(t){return((t*=2)<1?t*t*((s+1)*t-s):(t-=2)*t*((s+1)*t+s)+2)/2}return s=+s,backInOut.overshoot=custom,backInOut}(1.70158),tau=2*Math.PI,elasticIn=function custom(a,p){var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);function elasticIn(t){return a*Math.pow(2,10*--t)*Math.sin((s-t)/p)}return elasticIn.amplitude=function(a){return custom(a,p*tau)},elasticIn.period=function(p){return custom(a,p)},elasticIn}(1,.3),elasticOut=function custom(a,p){var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);function elasticOut(t){return 1-a*Math.pow(2,-10*(t=+t))*Math.sin((t+s)/p)}return elasticOut.amplitude=function(a){return custom(a,p*tau)},elasticOut.period=function(p){return custom(a,p)},elasticOut}(1,.3),elasticInOut=function custom(a,p){var s=Math.asin(1/(a=Math.max(1,a)))*(p/=tau);function elasticInOut(t){return((t=2*t-1)<0?a*Math.pow(2,10*t)*Math.sin((s-t)/p):2-a*Math.pow(2,-10*t)*Math.sin((s+t)/p))/2}return elasticInOut.amplitude=function(a){return custom(a,p*tau)},elasticInOut.period=function(p){return custom(a,p)},elasticInOut}(1,.3),defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(node,id){for(var timing;!(timing=node.__transition)||!(timing=timing[id]);)if(!(node=node.parentNode))return defaultTiming.time=now(),defaultTiming;return timing}selection.prototype.interrupt=function(name){return this.each(function(){interrupt(this,name)})},selection.prototype.transition=function(name){var id,timing;name instanceof Transition?(id=name._id,name=name._name):(id=newId(),(timing=defaultTiming).time=now(),name=null==name?null:name+"");for(var groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&schedule(node,name,id,i,group,timing||inherit(node,id));return new Transition(groups,this._parents,name,id)};var root$1=[null];function constant$3(x){return function(){return x}}function nopropagation$1(){exports.event.stopImmediatePropagation()}function noevent$1(){exports.event.preventDefault(),exports.event.stopImmediatePropagation()}var MODE_DRAG={name:"drag"},MODE_SPACE={name:"space"},MODE_HANDLE={name:"handle"},MODE_CENTER={name:"center"},X={name:"x",handles:["e","w"].map(type),input:function(x,e){return x&&[[x[0],e[0][1]],[x[1],e[1][1]]]},output:function(xy){return xy&&[xy[0][0],xy[1][0]]}},Y={name:"y",handles:["n","s"].map(type),input:function(y,e){return y&&[[e[0][0],y[0]],[e[1][0],y[1]]]},output:function(xy){return xy&&[xy[0][1],xy[1][1]]}},XY={name:"xy",handles:["n","e","s","w","nw","ne","se","sw"].map(type),input:function(xy){return xy},output:function(xy){return xy}},cursors={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},flipX={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},flipY={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},signsX={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},signsY={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function type(t){return{type:t}}function defaultFilter$1(){return!exports.event.button}function defaultExtent(){var svg=this.ownerSVGElement||this;return[[0,0],[svg.width.baseVal.value,svg.height.baseVal.value]]}function local$1(node){for(;!node.__brush;)if(!(node=node.parentNode))return;return node.__brush}function empty$1(extent){return extent[0][0]===extent[1][0]||extent[0][1]===extent[1][1]}function brush$1(dim){var touchending,extent=defaultExtent,filter=defaultFilter$1,listeners=dispatch(brush,"start","brush","end"),handleSize=6;function brush(group){var overlay=group.property("__brush",initialize).selectAll(".overlay").data([type("overlay")]);overlay.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",cursors.overlay).merge(overlay).each(function(){var extent=local$1(this).extent;select(this).attr("x",extent[0][0]).attr("y",extent[0][1]).attr("width",extent[1][0]-extent[0][0]).attr("height",extent[1][1]-extent[0][1])}),group.selectAll(".selection").data([type("selection")]).enter().append("rect").attr("class","selection").attr("cursor",cursors.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var handle=group.selectAll(".handle").data(dim.handles,function(d){return d.type});handle.exit().remove(),handle.enter().append("rect").attr("class",function(d){return"handle handle--"+d.type}).attr("cursor",function(d){return cursors[d.type]}),group.each(redraw).attr("fill","none").attr("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush touchstart.brush",started)}function redraw(){var group=select(this),selection=local$1(this).selection;selection?(group.selectAll(".selection").style("display",null).attr("x",selection[0][0]).attr("y",selection[0][1]).attr("width",selection[1][0]-selection[0][0]).attr("height",selection[1][1]-selection[0][1]),group.selectAll(".handle").style("display",null).attr("x",function(d){return"e"===d.type[d.type.length-1]?selection[1][0]-handleSize/2:selection[0][0]-handleSize/2}).attr("y",function(d){return"s"===d.type[0]?selection[1][1]-handleSize/2:selection[0][1]-handleSize/2}).attr("width",function(d){return"n"===d.type||"s"===d.type?selection[1][0]-selection[0][0]+handleSize:handleSize}).attr("height",function(d){return"e"===d.type||"w"===d.type?selection[1][1]-selection[0][1]+handleSize:handleSize})):group.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function emitter(that,args){return that.__brush.emitter||new Emitter(that,args)}function Emitter(that,args){this.that=that,this.args=args,this.state=that.__brush,this.active=0}function started(){if(exports.event.touches){if(exports.event.changedTouches.length<exports.event.touches.length)return noevent$1()}else if(touchending)return;if(filter.apply(this,arguments)){var w0,w1,n0,n1,e0,e1,s0,s1,dx,dy,moving,lockX,lockY,that=this,type=exports.event.target.__data__.type,mode="selection"===(exports.event.metaKey?type="overlay":type)?MODE_DRAG:exports.event.altKey?MODE_CENTER:MODE_HANDLE,signX=dim===Y?null:signsX[type],signY=dim===X?null:signsY[type],state=local$1(that),extent=state.extent,selection=state.selection,W=extent[0][0],N=extent[0][1],E=extent[1][0],S=extent[1][1],shifting=signX&&signY&&exports.event.shiftKey,point0=mouse(that),point=point0,emit=emitter(that,arguments).beforestart();"overlay"===type?state.selection=selection=[[w0=dim===Y?W:point0[0],n0=dim===X?N:point0[1]],[e0=dim===Y?E:w0,s0=dim===X?S:n0]]:(w0=selection[0][0],n0=selection[0][1],e0=selection[1][0],s0=selection[1][1]),w1=w0,n1=n0,e1=e0,s1=s0;var group=select(that).attr("pointer-events","none"),overlay=group.selectAll(".overlay").attr("cursor",cursors[type]);if(exports.event.touches)group.on("touchmove.brush",moved,!0).on("touchend.brush touchcancel.brush",ended,!0);else{var view=select(exports.event.view).on("keydown.brush",function(){switch(exports.event.keyCode){case 16:shifting=signX&&signY;break;case 18:mode===MODE_HANDLE&&(signX&&(e0=e1-dx*signX,w0=w1+dx*signX),signY&&(s0=s1-dy*signY,n0=n1+dy*signY),mode=MODE_CENTER,move());break;case 32:mode!==MODE_HANDLE&&mode!==MODE_CENTER||(signX<0?e0=e1-dx:signX>0&&(w0=w1-dx),signY<0?s0=s1-dy:signY>0&&(n0=n1-dy),mode=MODE_SPACE,overlay.attr("cursor",cursors.selection),move());break;default:return}noevent$1()},!0).on("keyup.brush",function(){switch(exports.event.keyCode){case 16:shifting&&(lockX=lockY=shifting=!1,move());break;case 18:mode===MODE_CENTER&&(signX<0?e0=e1:signX>0&&(w0=w1),signY<0?s0=s1:signY>0&&(n0=n1),mode=MODE_HANDLE,move());break;case 32:mode===MODE_SPACE&&(exports.event.altKey?(signX&&(e0=e1-dx*signX,w0=w1+dx*signX),signY&&(s0=s1-dy*signY,n0=n1+dy*signY),mode=MODE_CENTER):(signX<0?e0=e1:signX>0&&(w0=w1),signY<0?s0=s1:signY>0&&(n0=n1),mode=MODE_HANDLE),overlay.attr("cursor",cursors[type]),move());break;default:return}noevent$1()},!0).on("mousemove.brush",moved,!0).on("mouseup.brush",ended,!0);dragDisable(exports.event.view)}nopropagation$1(),interrupt(that),redraw.call(that),emit.start()}function moved(){var point1=mouse(that);!shifting||lockX||lockY||(Math.abs(point1[0]-point[0])>Math.abs(point1[1]-point[1])?lockY=!0:lockX=!0),point=point1,moving=!0,noevent$1(),move()}function move(){var t;switch(dx=point[0]-point0[0],dy=point[1]-point0[1],mode){case MODE_SPACE:case MODE_DRAG:signX&&(dx=Math.max(W-w0,Math.min(E-e0,dx)),w1=w0+dx,e1=e0+dx),signY&&(dy=Math.max(N-n0,Math.min(S-s0,dy)),n1=n0+dy,s1=s0+dy);break;case MODE_HANDLE:signX<0?(dx=Math.max(W-w0,Math.min(E-w0,dx)),w1=w0+dx,e1=e0):signX>0&&(dx=Math.max(W-e0,Math.min(E-e0,dx)),w1=w0,e1=e0+dx),signY<0?(dy=Math.max(N-n0,Math.min(S-n0,dy)),n1=n0+dy,s1=s0):signY>0&&(dy=Math.max(N-s0,Math.min(S-s0,dy)),n1=n0,s1=s0+dy);break;case MODE_CENTER:signX&&(w1=Math.max(W,Math.min(E,w0-dx*signX)),e1=Math.max(W,Math.min(E,e0+dx*signX))),signY&&(n1=Math.max(N,Math.min(S,n0-dy*signY)),s1=Math.max(N,Math.min(S,s0+dy*signY)))}e1<w1&&(signX*=-1,t=w0,w0=e0,e0=t,t=w1,w1=e1,e1=t,type in flipX&&overlay.attr("cursor",cursors[type=flipX[type]])),s1<n1&&(signY*=-1,t=n0,n0=s0,s0=t,t=n1,n1=s1,s1=t,type in flipY&&overlay.attr("cursor",cursors[type=flipY[type]])),state.selection&&(selection=state.selection),lockX&&(w1=selection[0][0],e1=selection[1][0]),lockY&&(n1=selection[0][1],s1=selection[1][1]),selection[0][0]===w1&&selection[0][1]===n1&&selection[1][0]===e1&&selection[1][1]===s1||(state.selection=[[w1,n1],[e1,s1]],redraw.call(that),emit.brush())}function ended(){if(nopropagation$1(),exports.event.touches){if(exports.event.touches.length)return;touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},500),group.on("touchmove.brush touchend.brush touchcancel.brush",null)}else yesdrag(exports.event.view,moving),view.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);group.attr("pointer-events","all"),overlay.attr("cursor",cursors.overlay),state.selection&&(selection=state.selection),empty$1(selection)&&(state.selection=null,redraw.call(that)),emit.end()}}function initialize(){var state=this.__brush||{selection:null};return state.extent=extent.apply(this,arguments),state.dim=dim,state}return brush.move=function(group,selection){group.selection?group.on("start.brush",function(){emitter(this,arguments).beforestart().start()}).on("interrupt.brush end.brush",function(){emitter(this,arguments).end()}).tween("brush",function(){var that=this,state=that.__brush,emit=emitter(that,arguments),selection0=state.selection,selection1=dim.input("function"==typeof selection?selection.apply(this,arguments):selection,state.extent),i=interpolateValue(selection0,selection1);function tween(t){state.selection=1===t&&empty$1(selection1)?null:i(t),redraw.call(that),emit.brush()}return selection0&&selection1?tween:tween(1)}):group.each(function(){var args=arguments,state=this.__brush,selection1=dim.input("function"==typeof selection?selection.apply(this,args):selection,state.extent),emit=emitter(this,args).beforestart();interrupt(this),state.selection=null==selection1||empty$1(selection1)?null:selection1,redraw.call(this),emit.start().brush().end()})},Emitter.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting&&(this.starting=!1,this.emit("start")),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(type){customEvent(new function(target,type,selection){this.target=target,this.type=type,this.selection=selection}(brush,type,dim.output(this.state.selection)),listeners.apply,listeners,[type,this.that,this.args])}},brush.extent=function(_){return arguments.length?(extent="function"==typeof _?_:constant$3([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),brush):extent},brush.filter=function(_){return arguments.length?(filter="function"==typeof _?_:constant$3(!!_),brush):filter},brush.handleSize=function(_){return arguments.length?(handleSize=+_,brush):handleSize},brush.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?brush:value},brush}var EOL={},EOF={},QUOTE=34,NEWLINE=10,RETURN=13;function objectConverter(columns){return new Function("d","return {"+columns.map(function(name,i){return JSON.stringify(name)+": d["+i+"]"}).join(",")+"}")}function dsv(delimiter){var reFormat=new RegExp('["'+delimiter+"\n\r]"),DELIMITER=delimiter.charCodeAt(0);function parseRows(text,f){var t,rows=[],N=text.length,I=0,n=0,eof=N<=0,eol=!1;function token(){if(eof)return EOF;if(eol)return eol=!1,EOL;var i,c,j=I;if(text.charCodeAt(j)===QUOTE){for(;I++<N&&text.charCodeAt(I)!==QUOTE||text.charCodeAt(++I)===QUOTE;);return(i=I)>=N?eof=!0:(c=text.charCodeAt(I++))===NEWLINE?eol=!0:c===RETURN&&(eol=!0,text.charCodeAt(I)===NEWLINE&&++I),text.slice(j+1,i-1).replace(/""/g,'"')}for(;I<N;){if((c=text.charCodeAt(i=I++))===NEWLINE)eol=!0;else if(c===RETURN)eol=!0,text.charCodeAt(I)===NEWLINE&&++I;else if(c!==DELIMITER)continue;return text.slice(j,i)}return eof=!0,text.slice(j,N)}for(text.charCodeAt(N-1)===NEWLINE&&--N,text.charCodeAt(N-1)===RETURN&&--N;(t=token())!==EOF;){for(var row=[];t!==EOL&&t!==EOF;)row.push(t),t=token();f&&null==(row=f(row,n++))||rows.push(row)}return rows}function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(text){return null==text?"":reFormat.test(text+="")?'"'+text.replace(/"/g,'""')+'"':text}return{parse:function(text,f){var convert,columns,rows=parseRows(text,function(row,i){if(convert)return convert(row,i-1);columns=row,convert=f?function(columns,f){var object=objectConverter(columns);return function(row,i){return f(object(row),i,columns)}}(row,f):objectConverter(row)});return rows.columns=columns||[],rows},parseRows:parseRows,format:function(rows,columns){return null==columns&&(columns=function(rows){var columnSet=Object.create(null),columns=[];return rows.forEach(function(row){for(var column in row)column in columnSet||columns.push(columnSet[column]=column)}),columns}(rows)),[columns.map(formatValue).join(delimiter)].concat(rows.map(function(row){return columns.map(function(column){return formatValue(row[column])}).join(delimiter)})).join("\n")},formatRows:function(rows){return rows.map(formatRow).join("\n")}}}var csv=dsv(","),csvParse=csv.parse,csvParseRows=csv.parseRows;dsv("\t");function request(url,callback){var request,mimeType,response,responseType,event=dispatch("beforesend","progress","load","error"),headers=map(),xhr=new XMLHttpRequest,user=null,password=null,timeout=0;function respond(o){var result,status=xhr.status;if(!status&&function(xhr){var type=xhr.responseType;return type&&"text"!==type?xhr.response:xhr.responseText}(xhr)||status>=200&&status<300||304===status){if(response)try{result=response.call(request,xhr)}catch(e){return void event.call("error",request,e)}else result=xhr;event.call("load",request,result)}else event.call("error",request,o)}if("undefined"==typeof XDomainRequest||"withCredentials"in xhr||!/^(http(s)?:)?\/\//.test(url)||(xhr=new XDomainRequest),"onload"in xhr?xhr.onload=xhr.onerror=xhr.ontimeout=respond:xhr.onreadystatechange=function(o){xhr.readyState>3&&respond(o)},xhr.onprogress=function(e){event.call("progress",request,e)},request={header:function(name,value){return name=(name+"").toLowerCase(),arguments.length<2?headers.get(name):(null==value?headers.remove(name):headers.set(name,value+""),request)},mimeType:function(value){return arguments.length?(mimeType=null==value?null:value+"",request):mimeType},responseType:function(value){return arguments.length?(responseType=value,request):responseType},timeout:function(value){return arguments.length?(timeout=+value,request):timeout},user:function(value){return arguments.length<1?user:(user=null==value?null:value+"",request)},password:function(value){return arguments.length<1?password:(password=null==value?null:value+"",request)},response:function(value){return response=value,request},get:function(data,callback){return request.send("GET",data,callback)},post:function(data,callback){return request.send("POST",data,callback)},send:function(method,data,callback){return xhr.open(method,url,!0,user,password),null==mimeType||headers.has("accept")||headers.set("accept",mimeType+",*/*"),xhr.setRequestHeader&&headers.each(function(value,name){xhr.setRequestHeader(name,value)}),null!=mimeType&&xhr.overrideMimeType&&xhr.overrideMimeType(mimeType),null!=responseType&&(xhr.responseType=responseType),timeout>0&&(xhr.timeout=timeout),null==callback&&"function"==typeof data&&(callback=data,data=null),null!=callback&&1===callback.length&&(callback=function(callback){return function(error,xhr){callback(null==error?xhr:null)}}(callback)),null!=callback&&request.on("error",callback).on("load",function(xhr){callback(null,xhr)}),event.call("beforesend",request,xhr),xhr.send(null==data?null:data),request},abort:function(){return xhr.abort(),request},on:function(){var value=event.on.apply(event,arguments);return value===event?request:value}},null!=callback){if("function"!=typeof callback)throw new Error("invalid callback: "+callback);return request.get(callback)}return request}var defaultMimeType,response,prefixExponent,json=(defaultMimeType="application/json",response=function(xhr){return JSON.parse(xhr.responseText)},function(url,callback){var r=request(url).mimeType(defaultMimeType).response(response);if(null!=callback){if("function"!=typeof callback)throw new Error("invalid callback: "+callback);return r.get(callback)}return r});function formatDecimal(x,p){if((i=(x=p?x.toExponential(p-1):x.toExponential()).indexOf("e"))<0)return null;var i,coefficient=x.slice(0,i);return[coefficient.length>1?coefficient[0]+coefficient.slice(2):coefficient,+x.slice(i+1)]}function exponent$1(x){return(x=formatDecimal(Math.abs(x)))?x[1]:NaN}function formatRounded(x,p){var d=formatDecimal(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1];return exponent<0?"0."+new Array(-exponent).join("0")+coefficient:coefficient.length>exponent+1?coefficient.slice(0,exponent+1)+"."+coefficient.slice(exponent+1):coefficient+new Array(exponent-coefficient.length+2).join("0")}var formatTypes={"":function(x,p){x=x.toPrecision(p);out:for(var i1,n=x.length,i=1,i0=-1;i<n;++i)switch(x[i]){case".":i0=i1=i;break;case"0":0===i0&&(i0=i),i1=i;break;case"e":break out;default:i0>0&&(i0=0)}return i0>0?x.slice(0,i0)+x.slice(i1+1):x},"%":function(x,p){return(100*x).toFixed(p)},b:function(x){return Math.round(x).toString(2)},c:function(x){return x+""},d:function(x){return Math.round(x).toString(10)},e:function(x,p){return x.toExponential(p)},f:function(x,p){return x.toFixed(p)},g:function(x,p){return x.toPrecision(p)},o:function(x){return Math.round(x).toString(8)},p:function(x,p){return formatRounded(100*x,p)},r:formatRounded,s:function(x,p){var d=formatDecimal(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1],i=exponent-(prefixExponent=3*Math.max(-8,Math.min(8,Math.floor(exponent/3))))+1,n=coefficient.length;return i===n?coefficient:i>n?coefficient+new Array(i-n+1).join("0"):i>0?coefficient.slice(0,i)+"."+coefficient.slice(i):"0."+new Array(1-i).join("0")+formatDecimal(x,Math.max(0,p+i-1))[0]},X:function(x){return Math.round(x).toString(16).toUpperCase()},x:function(x){return Math.round(x).toString(16)}},re=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;function formatSpecifier(specifier){return new FormatSpecifier(specifier)}function FormatSpecifier(specifier){if(!(match=re.exec(specifier)))throw new Error("invalid format: "+specifier);var match,fill=match[1]||" ",align=match[2]||">",sign=match[3]||"-",symbol=match[4]||"",zero=!!match[5],width=match[6]&&+match[6],comma=!!match[7],precision=match[8]&&+match[8].slice(1),type=match[9]||"";"n"===type?(comma=!0,type="g"):formatTypes[type]||(type=""),(zero||"0"===fill&&"="===align)&&(zero=!0,fill="0",align="="),this.fill=fill,this.align=align,this.sign=sign,this.symbol=symbol,this.zero=zero,this.width=width,this.comma=comma,this.precision=precision,this.type=type}function identity$2(x){return x}formatSpecifier.prototype=FormatSpecifier.prototype,FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+this.type};var locale,prefixes=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function formatLocale(locale){var grouping,thousands,group=locale.grouping&&locale.thousands?(grouping=locale.grouping,thousands=locale.thousands,function(value,width){for(var i=value.length,t=[],j=0,g=grouping[0],length=0;i>0&&g>0&&(length+g+1>width&&(g=Math.max(1,width-length)),t.push(value.substring(i-=g,i+g)),!((length+=g+1)>width));)g=grouping[j=(j+1)%grouping.length];return t.reverse().join(thousands)}):identity$2,currency=locale.currency,decimal=locale.decimal,numerals=locale.numerals?function(numerals){return function(value){return value.replace(/[0-9]/g,function(i){return numerals[+i]})}}(locale.numerals):identity$2,percent=locale.percent||"%";function newFormat(specifier){var fill=(specifier=formatSpecifier(specifier)).fill,align=specifier.align,sign=specifier.sign,symbol=specifier.symbol,zero=specifier.zero,width=specifier.width,comma=specifier.comma,precision=specifier.precision,type=specifier.type,prefix="$"===symbol?currency[0]:"#"===symbol&&/[boxX]/.test(type)?"0"+type.toLowerCase():"",suffix="$"===symbol?currency[1]:/[%p]/.test(type)?percent:"",formatType=formatTypes[type],maybeSuffix=!type||/[defgprs%]/.test(type);function format(value){var i,n,c,valuePrefix=prefix,valueSuffix=suffix;if("c"===type)valueSuffix=formatType(value)+valueSuffix,value="";else{var valueNegative=(value=+value)<0;if(value=formatType(Math.abs(value),precision),valueNegative&&0==+value&&(valueNegative=!1),valuePrefix=(valueNegative?"("===sign?sign:"-":"-"===sign||"("===sign?"":sign)+valuePrefix,valueSuffix=valueSuffix+("s"===type?prefixes[8+prefixExponent/3]:"")+(valueNegative&&"("===sign?")":""),maybeSuffix)for(i=-1,n=value.length;++i<n;)if(48>(c=value.charCodeAt(i))||c>57){valueSuffix=(46===c?decimal+value.slice(i+1):value.slice(i))+valueSuffix,value=value.slice(0,i);break}}comma&&!zero&&(value=group(value,1/0));var length=valuePrefix.length+value.length+valueSuffix.length,padding=length<width?new Array(width-length+1).join(fill):"";switch(comma&&zero&&(value=group(padding+value,padding.length?width-valueSuffix.length:1/0),padding=""),align){case"<":value=valuePrefix+value+valueSuffix+padding;break;case"=":value=valuePrefix+padding+value+valueSuffix;break;case"^":value=padding.slice(0,length=padding.length>>1)+valuePrefix+value+valueSuffix+padding.slice(length);break;default:value=padding+valuePrefix+value+valueSuffix}return numerals(value)}return precision=null==precision?type?6:12:/[gprs]/.test(type)?Math.max(1,Math.min(21,precision)):Math.max(0,Math.min(20,precision)),format.toString=function(){return specifier+""},format}return{format:newFormat,formatPrefix:function(specifier,value){var f=newFormat(((specifier=formatSpecifier(specifier)).type="f",specifier)),e=3*Math.max(-8,Math.min(8,Math.floor(exponent$1(value)/3))),k=Math.pow(10,-e),prefix=prefixes[8+e/3];return function(value){return f(k*value)+prefix}}}}function defaultLocale(definition){return locale=formatLocale(definition),exports.format=locale.format,exports.formatPrefix=locale.formatPrefix,locale}function precisionFixed(step){return Math.max(0,-exponent$1(Math.abs(step)))}function precisionPrefix(step,value){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(exponent$1(value)/3)))-exponent$1(Math.abs(step)))}function precisionRound(step,max){return step=Math.abs(step),max=Math.abs(max)-step,Math.max(0,exponent$1(max)-exponent$1(step))+1}function defaultSeparation(a,b){return a.parent===b.parent?1:2}function meanXReduce(x,c){return x+c.x}function maxYReduce(y,c){return Math.max(y,c.y)}function count(node){var sum=0,children=node.children,i=children&&children.length;if(i)for(;--i>=0;)sum+=children[i].value;else sum=1;node.value=sum}function hierarchy(data,children){var node,child,childs,i,n,root=new Node(data),valued=+data.value&&(root.value=data.value),nodes=[root];for(null==children&&(children=defaultChildren);node=nodes.pop();)if(valued&&(node.value=+node.data.value),(childs=children(node.data))&&(n=childs.length))for(node.children=new Array(n),i=n-1;i>=0;--i)nodes.push(child=node.children[i]=new Node(childs[i])),child.parent=node,child.depth=node.depth+1;return root.eachBefore(computeHeight)}function defaultChildren(d){return d.children}function copyData(node){node.data=node.data.data}function computeHeight(node){var height=0;do{node.height=height}while((node=node.parent)&&node.height<++height)}function Node(data){this.data=data,this.depth=this.height=0,this.parent=null}defaultLocale({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),Node.prototype=hierarchy.prototype={constructor:Node,count:function(){return this.eachAfter(count)},each:function(callback){var current,children,i,n,node=this,next=[node];do{for(current=next.reverse(),next=[];node=current.pop();)if(callback(node),children=node.children)for(i=0,n=children.length;i<n;++i)next.push(children[i])}while(next.length);return this},eachAfter:function(callback){for(var children,i,n,node=this,nodes=[node],next=[];node=nodes.pop();)if(next.push(node),children=node.children)for(i=0,n=children.length;i<n;++i)nodes.push(children[i]);for(;node=next.pop();)callback(node);return this},eachBefore:function(callback){for(var children,i,node=this,nodes=[node];node=nodes.pop();)if(callback(node),children=node.children)for(i=children.length-1;i>=0;--i)nodes.push(children[i]);return this},sum:function(value){return this.eachAfter(function(node){for(var sum=+value(node.data)||0,children=node.children,i=children&&children.length;--i>=0;)sum+=children[i].value;node.value=sum})},sort:function(compare){return this.eachBefore(function(node){node.children&&node.children.sort(compare)})},path:function(end){for(var start=this,ancestor=function(a,b){if(a===b)return a;var aNodes=a.ancestors(),bNodes=b.ancestors(),c=null;for(a=aNodes.pop(),b=bNodes.pop();a===b;)c=a,a=aNodes.pop(),b=bNodes.pop();return c}(start,end),nodes=[start];start!==ancestor;)start=start.parent,nodes.push(start);for(var k=nodes.length;end!==ancestor;)nodes.splice(k,0,end),end=end.parent;return nodes},ancestors:function(){for(var node=this,nodes=[node];node=node.parent;)nodes.push(node);return nodes},descendants:function(){var nodes=[];return this.each(function(node){nodes.push(node)}),nodes},leaves:function(){var leaves=[];return this.eachBefore(function(node){node.children||leaves.push(node)}),leaves},links:function(){var root=this,links=[];return root.each(function(node){node!==root&&links.push({source:node.parent,target:node})}),links},copy:function(){return hierarchy(this).eachBefore(copyData)}};var slice$1=Array.prototype.slice;function enclose(circles){for(var p,e,i=0,n=(circles=function(array){for(var t,i,m=array.length;m;)i=Math.random()*m--|0,t=array[m],array[m]=array[i],array[i]=t;return array}(slice$1.call(circles))).length,B=[];i<n;)p=circles[i],e&&enclosesWeak(e,p)?++i:(e=encloseBasis(B=extendBasis(B,p)),i=0);return e}function extendBasis(B,p){var i,j;if(enclosesWeakAll(p,B))return[p];for(i=0;i<B.length;++i)if(enclosesNot(p,B[i])&&enclosesWeakAll(encloseBasis2(B[i],p),B))return[B[i],p];for(i=0;i<B.length-1;++i)for(j=i+1;j<B.length;++j)if(enclosesNot(encloseBasis2(B[i],B[j]),p)&&enclosesNot(encloseBasis2(B[i],p),B[j])&&enclosesNot(encloseBasis2(B[j],p),B[i])&&enclosesWeakAll(encloseBasis3(B[i],B[j],p),B))return[B[i],B[j],p];throw new Error}function enclosesNot(a,b){var dr=a.r-b.r,dx=b.x-a.x,dy=b.y-a.y;return dr<0||dr*dr<dx*dx+dy*dy}function enclosesWeak(a,b){var dr=a.r-b.r+1e-6,dx=b.x-a.x,dy=b.y-a.y;return dr>0&&dr*dr>dx*dx+dy*dy}function enclosesWeakAll(a,B){for(var i=0;i<B.length;++i)if(!enclosesWeak(a,B[i]))return!1;return!0}function encloseBasis(B){switch(B.length){case 1:return{x:(a=B[0]).x,y:a.y,r:a.r};case 2:return encloseBasis2(B[0],B[1]);case 3:return encloseBasis3(B[0],B[1],B[2])}var a}function encloseBasis2(a,b){var x1=a.x,y1=a.y,r1=a.r,x2=b.x,y2=b.y,r2=b.r,x21=x2-x1,y21=y2-y1,r21=r2-r1,l=Math.sqrt(x21*x21+y21*y21);return{x:(x1+x2+x21/l*r21)/2,y:(y1+y2+y21/l*r21)/2,r:(l+r1+r2)/2}}function encloseBasis3(a,b,c){var x1=a.x,y1=a.y,r1=a.r,x2=b.x,y2=b.y,r2=b.r,x3=c.x,y3=c.y,r3=c.r,a2=x1-x2,a3=x1-x3,b2=y1-y2,b3=y1-y3,c2=r2-r1,c3=r3-r1,d1=x1*x1+y1*y1-r1*r1,d2=d1-x2*x2-y2*y2+r2*r2,d3=d1-x3*x3-y3*y3+r3*r3,ab=a3*b2-a2*b3,xa=(b2*d3-b3*d2)/(2*ab)-x1,xb=(b3*c2-b2*c3)/ab,ya=(a3*d2-a2*d3)/(2*ab)-y1,yb=(a2*c3-a3*c2)/ab,A=xb*xb+yb*yb-1,B=2*(r1+xa*xb+ya*yb),C=xa*xa+ya*ya-r1*r1,r=-(A?(B+Math.sqrt(B*B-4*A*C))/(2*A):C/B);return{x:x1+xa+xb*r,y:y1+ya+yb*r,r:r}}function place(a,b,c){var ax=a.x,ay=a.y,da=b.r+c.r,db=a.r+c.r,dx=b.x-ax,dy=b.y-ay,dc=dx*dx+dy*dy;if(dc){var x=.5+((db*=db)-(da*=da))/(2*dc),y=Math.sqrt(Math.max(0,2*da*(db+dc)-(db-=dc)*db-da*da))/(2*dc);c.x=ax+x*dx+y*dy,c.y=ay+x*dy-y*dx}else c.x=ax+db,c.y=ay}function intersects(a,b){var dx=b.x-a.x,dy=b.y-a.y,dr=a.r+b.r;return dr*dr-1e-6>dx*dx+dy*dy}function score(node){var a=node._,b=node.next._,ab=a.r+b.r,dx=(a.x*b.r+b.x*a.r)/ab,dy=(a.y*b.r+b.y*a.r)/ab;return dx*dx+dy*dy}function Node$1(circle){this._=circle,this.next=null,this.previous=null}function packEnclose(circles){if(!(n=circles.length))return 0;var a,b,c,n,aa,ca,i,j,k,sj,sk;if((a=circles[0]).x=0,a.y=0,!(n>1))return a.r;if(b=circles[1],a.x=-b.r,b.x=a.r,b.y=0,!(n>2))return a.r+b.r;place(b,a,c=circles[2]),a=new Node$1(a),b=new Node$1(b),c=new Node$1(c),a.next=c.previous=b,b.next=a.previous=c,c.next=b.previous=a;pack:for(i=3;i<n;++i){place(a._,b._,c=circles[i]),c=new Node$1(c),j=b.next,k=a.previous,sj=b._.r,sk=a._.r;do{if(sj<=sk){if(intersects(j._,c._)){b=j,a.next=b,b.previous=a,--i;continue pack}sj+=j._.r,j=j.next}else{if(intersects(k._,c._)){(a=k).next=b,b.previous=a,--i;continue pack}sk+=k._.r,k=k.previous}}while(j!==k.next);for(c.previous=a,c.next=b,a.next=b.previous=b=c,aa=score(a);(c=c.next)!==b;)(ca=score(c))<aa&&(a=c,aa=ca);b=a.next}for(a=[b._],c=b;(c=c.next)!==b;)a.push(c._);for(c=enclose(a),i=0;i<n;++i)(a=circles[i]).x-=c.x,a.y-=c.y;return c.r}function required(f){if("function"!=typeof f)throw new Error;return f}function constantZero(){return 0}function constant$4(x){return function(){return x}}function defaultRadius(d){return Math.sqrt(d.value)}function radiusLeaf(radius){return function(node){node.children||(node.r=Math.max(0,+radius(node)||0))}}function packChildren(padding,k){return function(node){if(children=node.children){var children,i,e,n=children.length,r=padding(node)*k||0;if(r)for(i=0;i<n;++i)children[i].r+=r;if(e=packEnclose(children),r)for(i=0;i<n;++i)children[i].r-=r;node.r=e+r}}}function translateChild(k){return function(node){var parent=node.parent;node.r*=k,parent&&(node.x=parent.x+k*node.x,node.y=parent.y+k*node.y)}}function roundNode(node){node.x0=Math.round(node.x0),node.y0=Math.round(node.y0),node.x1=Math.round(node.x1),node.y1=Math.round(node.y1)}function treemapDice(parent,x0,y0,x1,y1){for(var node,nodes=parent.children,i=-1,n=nodes.length,k=parent.value&&(x1-x0)/parent.value;++i<n;)(node=nodes[i]).y0=y0,node.y1=y1,node.x0=x0,node.x1=x0+=node.value*k}var keyPrefix$1="$",preroot={depth:-1},ambiguous={};function defaultId(d){return d.id}function defaultParentId(d){return d.parentId}function defaultSeparation$1(a,b){return a.parent===b.parent?1:2}function nextLeft(v){var children=v.children;return children?children[0]:v.t}function nextRight(v){var children=v.children;return children?children[children.length-1]:v.t}function moveSubtree(wm,wp,shift){var change=shift/(wp.i-wm.i);wp.c-=change,wp.s+=shift,wm.c+=change,wp.z+=shift,wp.m+=shift}function nextAncestor(vim,v,ancestor){return vim.a.parent===v.parent?vim.a:ancestor}function TreeNode(node,i){this._=node,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=i}function treemapSlice(parent,x0,y0,x1,y1){for(var node,nodes=parent.children,i=-1,n=nodes.length,k=parent.value&&(y1-y0)/parent.value;++i<n;)(node=nodes[i]).x0=x0,node.x1=x1,node.y0=y0,node.y1=y0+=node.value*k}TreeNode.prototype=Object.create(Node.prototype);var phi=(1+Math.sqrt(5))/2;function squarifyRatio(ratio,parent,x0,y0,x1,y1){for(var row,nodeValue,dx,dy,sumValue,minValue,maxValue,newRatio,minRatio,alpha,beta,rows=[],nodes=parent.children,i0=0,i1=0,n=nodes.length,value=parent.value;i0<n;){dx=x1-x0,dy=y1-y0;do{sumValue=nodes[i1++].value}while(!sumValue&&i1<n);for(minValue=maxValue=sumValue,beta=sumValue*sumValue*(alpha=Math.max(dy/dx,dx/dy)/(value*ratio)),minRatio=Math.max(maxValue/beta,beta/minValue);i1<n;++i1){if(sumValue+=nodeValue=nodes[i1].value,nodeValue<minValue&&(minValue=nodeValue),nodeValue>maxValue&&(maxValue=nodeValue),beta=sumValue*sumValue*alpha,(newRatio=Math.max(maxValue/beta,beta/minValue))>minRatio){sumValue-=nodeValue;break}minRatio=newRatio}rows.push(row={value:sumValue,dice:dx<dy,children:nodes.slice(i0,i1)}),row.dice?treemapDice(row,x0,y0,x1,value?y0+=dy*sumValue/value:y1):treemapSlice(row,x0,y0,value?x0+=dx*sumValue/value:x1,y1),value-=sumValue,i0=i1}return rows}var squarify=function custom(ratio){function squarify(parent,x0,y0,x1,y1){squarifyRatio(ratio,parent,x0,y0,x1,y1)}return squarify.ratio=function(x){return custom((x=+x)>1?x:1)},squarify}(phi);var resquarify=function custom(ratio){function resquarify(parent,x0,y0,x1,y1){if((rows=parent._squarify)&&rows.ratio===ratio)for(var rows,row,nodes,i,n,j=-1,m=rows.length,value=parent.value;++j<m;){for(nodes=(row=rows[j]).children,i=row.value=0,n=nodes.length;i<n;++i)row.value+=nodes[i].value;row.dice?treemapDice(row,x0,y0,x1,y0+=(y1-y0)*row.value/value):treemapSlice(row,x0,y0,x0+=(x1-x0)*row.value/value,y1),value-=row.value}else parent._squarify=rows=squarifyRatio(ratio,parent,x0,y0,x1,y1),rows.ratio=ratio}return resquarify.ratio=function(x){return custom((x=+x)>1?x:1)},resquarify}(phi),pi$1=Math.PI,tau$1=2*pi$1,tauEpsilon=tau$1-1e-6;function Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function path(){return new Path}Path.prototype=path.prototype={constructor:Path,moveTo:function(x,y){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(x,y){this._+="L"+(this._x1=+x)+","+(this._y1=+y)},quadraticCurveTo:function(x1,y1,x,y){this._+="Q"+ +x1+","+ +y1+","+(this._x1=+x)+","+(this._y1=+y)},bezierCurveTo:function(x1,y1,x2,y2,x,y){this._+="C"+ +x1+","+ +y1+","+ +x2+","+ +y2+","+(this._x1=+x)+","+(this._y1=+y)},arcTo:function(x1,y1,x2,y2,r){x1=+x1,y1=+y1,x2=+x2,y2=+y2,r=+r;var x0=this._x1,y0=this._y1,x21=x2-x1,y21=y2-y1,x01=x0-x1,y01=y0-y1,l01_2=x01*x01+y01*y01;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=x1)+","+(this._y1=y1);else if(l01_2>1e-6)if(Math.abs(y01*x21-y21*x01)>1e-6&&r){var x20=x2-x0,y20=y2-y0,l21_2=x21*x21+y21*y21,l20_2=x20*x20+y20*y20,l21=Math.sqrt(l21_2),l01=Math.sqrt(l01_2),l=r*Math.tan((pi$1-Math.acos((l21_2+l01_2-l20_2)/(2*l21*l01)))/2),t01=l/l01,t21=l/l21;Math.abs(t01-1)>1e-6&&(this._+="L"+(x1+t01*x01)+","+(y1+t01*y01)),this._+="A"+r+","+r+",0,0,"+ +(y01*x20>x01*y20)+","+(this._x1=x1+t21*x21)+","+(this._y1=y1+t21*y21)}else this._+="L"+(this._x1=x1)+","+(this._y1=y1);else;},arc:function(x,y,r,a0,a1,ccw){x=+x,y=+y;var dx=(r=+r)*Math.cos(a0),dy=r*Math.sin(a0),x0=x+dx,y0=y+dy,cw=1^ccw,da=ccw?a0-a1:a1-a0;if(r<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+x0+","+y0:(Math.abs(this._x1-x0)>1e-6||Math.abs(this._y1-y0)>1e-6)&&(this._+="L"+x0+","+y0),r&&(da<0&&(da=da%tau$1+tau$1),da>tauEpsilon?this._+="A"+r+","+r+",0,1,"+cw+","+(x-dx)+","+(y-dy)+"A"+r+","+r+",0,1,"+cw+","+(this._x1=x0)+","+(this._y1=y0):da>1e-6&&(this._+="A"+r+","+r+",0,"+ +(da>=pi$1)+","+cw+","+(this._x1=x+r*Math.cos(a1))+","+(this._y1=y+r*Math.sin(a1))))},rect:function(x,y,w,h){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)+"h"+ +w+"v"+ +h+"h"+-w+"Z"},toString:function(){return this._}};var array$1=Array.prototype,map$1=array$1.map,slice$2=array$1.slice,implicit={name:"implicit"};function ordinal(range){var index=map(),domain=[],unknown=implicit;function scale(d){var key=d+"",i=index.get(key);if(!i){if(unknown!==implicit)return unknown;index.set(key,i=domain.push(d))}return range[(i-1)%range.length]}return range=null==range?[]:slice$2.call(range),scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[],index=map();for(var d,key,i=-1,n=_.length;++i<n;)index.has(key=(d=_[i])+"")||index.set(key,domain.push(d));return scale},scale.range=function(_){return arguments.length?(range=slice$2.call(_),scale):range.slice()},scale.unknown=function(_){return arguments.length?(unknown=_,scale):unknown},scale.copy=function(){return ordinal().domain(domain).range(range).unknown(unknown)},scale}function band(){var step,bandwidth,scale=ordinal().unknown(void 0),domain=scale.domain,ordinalRange=scale.range,range=[0,1],round=!1,paddingInner=0,paddingOuter=0,align=.5;function rescale(){var n=domain().length,reverse=range[1]<range[0],start=range[reverse-0],stop=range[1-reverse];step=(stop-start)/Math.max(1,n-paddingInner+2*paddingOuter),round&&(step=Math.floor(step)),start+=(stop-start-step*(n-paddingInner))*align,bandwidth=step*(1-paddingInner),round&&(start=Math.round(start),bandwidth=Math.round(bandwidth));var values=sequence(n).map(function(i){return start+step*i});return ordinalRange(reverse?values.reverse():values)}return delete scale.unknown,scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()},scale.range=function(_){return arguments.length?(range=[+_[0],+_[1]],rescale()):range.slice()},scale.rangeRound=function(_){return range=[+_[0],+_[1]],round=!0,rescale()},scale.bandwidth=function(){return bandwidth},scale.step=function(){return step},scale.round=function(_){return arguments.length?(round=!!_,rescale()):round},scale.padding=function(_){return arguments.length?(paddingInner=paddingOuter=Math.max(0,Math.min(1,_)),rescale()):paddingInner},scale.paddingInner=function(_){return arguments.length?(paddingInner=Math.max(0,Math.min(1,_)),rescale()):paddingInner},scale.paddingOuter=function(_){return arguments.length?(paddingOuter=Math.max(0,Math.min(1,_)),rescale()):paddingOuter},scale.align=function(_){return arguments.length?(align=Math.max(0,Math.min(1,_)),rescale()):align},scale.copy=function(){return band().domain(domain()).range(range).round(round).paddingInner(paddingInner).paddingOuter(paddingOuter).align(align)},rescale()}function number$2(x){return+x}var unit=[0,1];function deinterpolateLinear(a,b){return(b-=a=+a)?function(x){return(x-a)/b}:(x=b,function(){return x});var x}function bimap(domain,range,deinterpolate,reinterpolate){var d0=domain[0],d1=domain[1],r0=range[0],r1=range[1];return d1<d0?(d0=deinterpolate(d1,d0),r0=reinterpolate(r1,r0)):(d0=deinterpolate(d0,d1),r0=reinterpolate(r0,r1)),function(x){return r0(d0(x))}}function polymap(domain,range,deinterpolate,reinterpolate){var j=Math.min(domain.length,range.length)-1,d=new Array(j),r=new Array(j),i=-1;for(domain[j]<domain[0]&&(domain=domain.slice().reverse(),range=range.slice().reverse());++i<j;)d[i]=deinterpolate(domain[i],domain[i+1]),r[i]=reinterpolate(range[i],range[i+1]);return function(x){var i=bisectRight(domain,x,1,j)-1;return r[i](d[i](x))}}function copy(source,target){return target.domain(source.domain()).range(source.range()).interpolate(source.interpolate()).clamp(source.clamp())}function continuous(deinterpolate,reinterpolate){var piecewise,output,input,domain=unit,range=unit,interpolate=interpolateValue,clamp=!1;function rescale(){return piecewise=Math.min(domain.length,range.length)>2?polymap:bimap,output=input=null,scale}function scale(x){return(output||(output=piecewise(domain,range,clamp?function(deinterpolate){return function(a,b){var d=deinterpolate(a=+a,b=+b);return function(x){return x<=a?0:x>=b?1:d(x)}}}(deinterpolate):deinterpolate,interpolate)))(+x)}return scale.invert=function(y){return(input||(input=piecewise(range,domain,deinterpolateLinear,clamp?function(reinterpolate){return function(a,b){var r=reinterpolate(a=+a,b=+b);return function(t){return t<=0?a:t>=1?b:r(t)}}}(reinterpolate):reinterpolate)))(+y)},scale.domain=function(_){return arguments.length?(domain=map$1.call(_,number$2),rescale()):domain.slice()},scale.range=function(_){return arguments.length?(range=slice$2.call(_),rescale()):range.slice()},scale.rangeRound=function(_){return range=slice$2.call(_),interpolate=interpolateRound,rescale()},scale.clamp=function(_){return arguments.length?(clamp=!!_,rescale()):clamp},scale.interpolate=function(_){return arguments.length?(interpolate=_,rescale()):interpolate},rescale()}function linearish(scale){var domain=scale.domain;return scale.ticks=function(count){var d=domain();return ticks(d[0],d[d.length-1],null==count?10:count)},scale.tickFormat=function(count,specifier){return function(domain,count,specifier){var precision,start=domain[0],stop=domain[domain.length-1],step=tickStep(start,stop,null==count?10:count);switch((specifier=formatSpecifier(null==specifier?",f":specifier)).type){case"s":var value=Math.max(Math.abs(start),Math.abs(stop));return null!=specifier.precision||isNaN(precision=precisionPrefix(step,value))||(specifier.precision=precision),exports.formatPrefix(specifier,value);case"":case"e":case"g":case"p":case"r":null!=specifier.precision||isNaN(precision=precisionRound(step,Math.max(Math.abs(start),Math.abs(stop))))||(specifier.precision=precision-("e"===specifier.type));break;case"f":case"%":null!=specifier.precision||isNaN(precision=precisionFixed(step))||(specifier.precision=precision-2*("%"===specifier.type))}return exports.format(specifier)}(domain(),count,specifier)},scale.nice=function(count){null==count&&(count=10);var step,d=domain(),i0=0,i1=d.length-1,start=d[i0],stop=d[i1];return stop<start&&(step=start,start=stop,stop=step,step=i0,i0=i1,i1=step),(step=tickIncrement(start,stop,count))>0?step=tickIncrement(start=Math.floor(start/step)*step,stop=Math.ceil(stop/step)*step,count):step<0&&(step=tickIncrement(start=Math.ceil(start*step)/step,stop=Math.floor(stop*step)/step,count)),step>0?(d[i0]=Math.floor(start/step)*step,d[i1]=Math.ceil(stop/step)*step,domain(d)):step<0&&(d[i0]=Math.ceil(start*step)/step,d[i1]=Math.floor(stop*step)/step,domain(d)),scale},scale}var t0$1=new Date,t1$1=new Date;function newInterval(floori,offseti,count,field){function interval(date){return floori(date=new Date(+date)),date}return interval.floor=interval,interval.ceil=function(date){return floori(date=new Date(date-1)),offseti(date,1),floori(date),date},interval.round=function(date){var d0=interval(date),d1=interval.ceil(date);return date-d0<d1-date?d0:d1},interval.offset=function(date,step){return offseti(date=new Date(+date),null==step?1:Math.floor(step)),date},interval.range=function(start,stop,step){var previous,range=[];if(start=interval.ceil(start),step=null==step?1:Math.floor(step),!(start<stop&&step>0))return range;do{range.push(previous=new Date(+start)),offseti(start,step),floori(start)}while(previous<start&&start<stop);return range},interval.filter=function(test){return newInterval(function(date){if(date>=date)for(;floori(date),!test(date);)date.setTime(date-1)},function(date,step){if(date>=date)if(step<0)for(;++step<=0;)for(;offseti(date,-1),!test(date););else for(;--step>=0;)for(;offseti(date,1),!test(date););})},count&&(interval.count=function(start,end){return t0$1.setTime(+start),t1$1.setTime(+end),floori(t0$1),floori(t1$1),Math.floor(count(t0$1,t1$1))},interval.every=function(step){return step=Math.floor(step),isFinite(step)&&step>0?step>1?interval.filter(field?function(d){return field(d)%step==0}:function(d){return interval.count(0,d)%step==0}):interval:null}),interval}var millisecond=newInterval(function(){},function(date,step){date.setTime(+date+step)},function(start,end){return end-start});millisecond.every=function(k){return k=Math.floor(k),isFinite(k)&&k>0?k>1?newInterval(function(date){date.setTime(Math.floor(date/k)*k)},function(date,step){date.setTime(+date+step*k)},function(start,end){return(end-start)/k}):millisecond:null};var milliseconds=millisecond.range,durationMinute=6e4,durationWeek=6048e5,second=newInterval(function(date){date.setTime(1e3*Math.floor(date/1e3))},function(date,step){date.setTime(+date+1e3*step)},function(start,end){return(end-start)/1e3},function(date){return date.getUTCSeconds()}),seconds=second.range,minute=newInterval(function(date){date.setTime(Math.floor(date/durationMinute)*durationMinute)},function(date,step){date.setTime(+date+step*durationMinute)},function(start,end){return(end-start)/durationMinute},function(date){return date.getMinutes()}),minutes=minute.range,hour=newInterval(function(date){var offset=date.getTimezoneOffset()*durationMinute%36e5;offset<0&&(offset+=36e5),date.setTime(36e5*Math.floor((+date-offset)/36e5)+offset)},function(date,step){date.setTime(+date+36e5*step)},function(start,end){return(end-start)/36e5},function(date){return date.getHours()}),hours=hour.range,day=newInterval(function(date){date.setHours(0,0,0,0)},function(date,step){date.setDate(date.getDate()+step)},function(start,end){return(end-start-(end.getTimezoneOffset()-start.getTimezoneOffset())*durationMinute)/864e5},function(date){return date.getDate()-1}),days=day.range;function weekday(i){return newInterval(function(date){date.setDate(date.getDate()-(date.getDay()+7-i)%7),date.setHours(0,0,0,0)},function(date,step){date.setDate(date.getDate()+7*step)},function(start,end){return(end-start-(end.getTimezoneOffset()-start.getTimezoneOffset())*durationMinute)/durationWeek})}var sunday=weekday(0),monday=weekday(1),tuesday=weekday(2),wednesday=weekday(3),thursday=weekday(4),friday=weekday(5),saturday=weekday(6),sundays=sunday.range,mondays=monday.range,tuesdays=tuesday.range,wednesdays=wednesday.range,thursdays=thursday.range,fridays=friday.range,saturdays=saturday.range,month=newInterval(function(date){date.setDate(1),date.setHours(0,0,0,0)},function(date,step){date.setMonth(date.getMonth()+step)},function(start,end){return end.getMonth()-start.getMonth()+12*(end.getFullYear()-start.getFullYear())},function(date){return date.getMonth()}),months=month.range,year=newInterval(function(date){date.setMonth(0,1),date.setHours(0,0,0,0)},function(date,step){date.setFullYear(date.getFullYear()+step)},function(start,end){return end.getFullYear()-start.getFullYear()},function(date){return date.getFullYear()});year.every=function(k){return isFinite(k=Math.floor(k))&&k>0?newInterval(function(date){date.setFullYear(Math.floor(date.getFullYear()/k)*k),date.setMonth(0,1),date.setHours(0,0,0,0)},function(date,step){date.setFullYear(date.getFullYear()+step*k)}):null};var years=year.range,utcMinute=newInterval(function(date){date.setUTCSeconds(0,0)},function(date,step){date.setTime(+date+step*durationMinute)},function(start,end){return(end-start)/durationMinute},function(date){return date.getUTCMinutes()}),utcMinutes=utcMinute.range,utcHour=newInterval(function(date){date.setUTCMinutes(0,0,0)},function(date,step){date.setTime(+date+36e5*step)},function(start,end){return(end-start)/36e5},function(date){return date.getUTCHours()}),utcHours=utcHour.range,utcDay=newInterval(function(date){date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCDate(date.getUTCDate()+step)},function(start,end){return(end-start)/864e5},function(date){return date.getUTCDate()-1}),utcDays=utcDay.range;function utcWeekday(i){return newInterval(function(date){date.setUTCDate(date.getUTCDate()-(date.getUTCDay()+7-i)%7),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCDate(date.getUTCDate()+7*step)},function(start,end){return(end-start)/durationWeek})}var utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6),utcSundays=utcSunday.range,utcMondays=utcMonday.range,utcTuesdays=utcTuesday.range,utcWednesdays=utcWednesday.range,utcThursdays=utcThursday.range,utcFridays=utcFriday.range,utcSaturdays=utcSaturday.range,utcMonth=newInterval(function(date){date.setUTCDate(1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCMonth(date.getUTCMonth()+step)},function(start,end){return end.getUTCMonth()-start.getUTCMonth()+12*(end.getUTCFullYear()-start.getUTCFullYear())},function(date){return date.getUTCMonth()}),utcMonths=utcMonth.range,utcYear=newInterval(function(date){date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCFullYear(date.getUTCFullYear()+step)},function(start,end){return end.getUTCFullYear()-start.getUTCFullYear()},function(date){return date.getUTCFullYear()});utcYear.every=function(k){return isFinite(k=Math.floor(k))&&k>0?newInterval(function(date){date.setUTCFullYear(Math.floor(date.getUTCFullYear()/k)*k),date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCFullYear(date.getUTCFullYear()+step*k)}):null};var utcYears=utcYear.range;function localDate(d){if(0<=d.y&&d.y<100){var date=new Date(-1,d.m,d.d,d.H,d.M,d.S,d.L);return date.setFullYear(d.y),date}return new Date(d.y,d.m,d.d,d.H,d.M,d.S,d.L)}function utcDate(d){if(0<=d.y&&d.y<100){var date=new Date(Date.UTC(-1,d.m,d.d,d.H,d.M,d.S,d.L));return date.setUTCFullYear(d.y),date}return new Date(Date.UTC(d.y,d.m,d.d,d.H,d.M,d.S,d.L))}function newYear(y){return{y:y,m:0,d:1,H:0,M:0,S:0,L:0}}function formatLocale$1(locale){var locale_dateTime=locale.dateTime,locale_date=locale.date,locale_time=locale.time,locale_periods=locale.periods,locale_weekdays=locale.days,locale_shortWeekdays=locale.shortDays,locale_months=locale.months,locale_shortMonths=locale.shortMonths,periodRe=formatRe(locale_periods),periodLookup=formatLookup(locale_periods),weekdayRe=formatRe(locale_weekdays),weekdayLookup=formatLookup(locale_weekdays),shortWeekdayRe=formatRe(locale_shortWeekdays),shortWeekdayLookup=formatLookup(locale_shortWeekdays),monthRe=formatRe(locale_months),monthLookup=formatLookup(locale_months),shortMonthRe=formatRe(locale_shortMonths),shortMonthLookup=formatLookup(locale_shortMonths),formats={a:function(d){return locale_shortWeekdays[d.getDay()]},A:function(d){return locale_weekdays[d.getDay()]},b:function(d){return locale_shortMonths[d.getMonth()]},B:function(d){return locale_months[d.getMonth()]},c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:function(d){return locale_periods[+(d.getHours()>=12)]},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},utcFormats={a:function(d){return locale_shortWeekdays[d.getUTCDay()]},A:function(d){return locale_weekdays[d.getUTCDay()]},b:function(d){return locale_shortMonths[d.getUTCMonth()]},B:function(d){return locale_months[d.getUTCMonth()]},c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:function(d){return locale_periods[+(d.getUTCHours()>=12)]},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},parses={a:function(d,string,i){var n=shortWeekdayRe.exec(string.slice(i));return n?(d.w=shortWeekdayLookup[n[0].toLowerCase()],i+n[0].length):-1},A:function(d,string,i){var n=weekdayRe.exec(string.slice(i));return n?(d.w=weekdayLookup[n[0].toLowerCase()],i+n[0].length):-1},b:function(d,string,i){var n=shortMonthRe.exec(string.slice(i));return n?(d.m=shortMonthLookup[n[0].toLowerCase()],i+n[0].length):-1},B:function(d,string,i){var n=monthRe.exec(string.slice(i));return n?(d.m=monthLookup[n[0].toLowerCase()],i+n[0].length):-1},c:function(d,string,i){return parseSpecifier(d,locale_dateTime,string,i)},d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:function(d,string,i){var n=periodRe.exec(string.slice(i));return n?(d.p=periodLookup[n[0].toLowerCase()],i+n[0].length):-1},Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:function(d,string,i){return parseSpecifier(d,locale_date,string,i)},X:function(d,string,i){return parseSpecifier(d,locale_time,string,i)},y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};function newFormat(specifier,formats){return function(date){var c,pad,format,string=[],i=-1,j=0,n=specifier.length;for(date instanceof Date||(date=new Date(+date));++i<n;)37===specifier.charCodeAt(i)&&(string.push(specifier.slice(j,i)),null!=(pad=pads[c=specifier.charAt(++i)])?c=specifier.charAt(++i):pad="e"===c?" ":"0",(format=formats[c])&&(c=format(date,pad)),string.push(c),j=i+1);return string.push(specifier.slice(j,i)),string.join("")}}function newParse(specifier,newDate){return function(string){var week,day$1,d=newYear(1900);if(parseSpecifier(d,specifier,string+="",0)!=string.length)return null;if("Q"in d)return new Date(d.Q);if("p"in d&&(d.H=d.H%12+12*d.p),"V"in d){if(d.V<1||d.V>53)return null;"w"in d||(d.w=1),"Z"in d?(week=(day$1=(week=utcDate(newYear(d.y))).getUTCDay())>4||0===day$1?utcMonday.ceil(week):utcMonday(week),week=utcDay.offset(week,7*(d.V-1)),d.y=week.getUTCFullYear(),d.m=week.getUTCMonth(),d.d=week.getUTCDate()+(d.w+6)%7):(week=(day$1=(week=newDate(newYear(d.y))).getDay())>4||0===day$1?monday.ceil(week):monday(week),week=day.offset(week,7*(d.V-1)),d.y=week.getFullYear(),d.m=week.getMonth(),d.d=week.getDate()+(d.w+6)%7)}else("W"in d||"U"in d)&&("w"in d||(d.w="u"in d?d.u%7:"W"in d?1:0),day$1="Z"in d?utcDate(newYear(d.y)).getUTCDay():newDate(newYear(d.y)).getDay(),d.m=0,d.d="W"in d?(d.w+6)%7+7*d.W-(day$1+5)%7:d.w+7*d.U-(day$1+6)%7);return"Z"in d?(d.H+=d.Z/100|0,d.M+=d.Z%100,utcDate(d)):newDate(d)}}function parseSpecifier(d,specifier,string,j){for(var c,parse,i=0,n=specifier.length,m=string.length;i<n;){if(j>=m)return-1;if(37===(c=specifier.charCodeAt(i++))){if(c=specifier.charAt(i++),!(parse=parses[c in pads?specifier.charAt(i++):c])||(j=parse(d,string,j))<0)return-1}else if(c!=string.charCodeAt(j++))return-1}return j}return formats.x=newFormat(locale_date,formats),formats.X=newFormat(locale_time,formats),formats.c=newFormat(locale_dateTime,formats),utcFormats.x=newFormat(locale_date,utcFormats),utcFormats.X=newFormat(locale_time,utcFormats),utcFormats.c=newFormat(locale_dateTime,utcFormats),{format:function(specifier){var f=newFormat(specifier+="",formats);return f.toString=function(){return specifier},f},parse:function(specifier){var p=newParse(specifier+="",localDate);return p.toString=function(){return specifier},p},utcFormat:function(specifier){var f=newFormat(specifier+="",utcFormats);return f.toString=function(){return specifier},f},utcParse:function(specifier){var p=newParse(specifier,utcDate);return p.toString=function(){return specifier},p}}}var locale$1,pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad(value,fill,width){var sign=value<0?"-":"",string=(sign?-value:value)+"",length=string.length;return sign+(length<width?new Array(width-length+1).join(fill)+string:string)}function requote(s){return s.replace(requoteRe,"\\$&")}function formatRe(names){return new RegExp("^(?:"+names.map(requote).join("|")+")","i")}function formatLookup(names){for(var map={},i=-1,n=names.length;++i<n;)map[names[i].toLowerCase()]=i;return map}function parseWeekdayNumberSunday(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.w=+n[0],i+n[0].length):-1}function parseWeekdayNumberMonday(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.u=+n[0],i+n[0].length):-1}function parseWeekNumberSunday(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.U=+n[0],i+n[0].length):-1}function parseWeekNumberISO(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.V=+n[0],i+n[0].length):-1}function parseWeekNumberMonday(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.W=+n[0],i+n[0].length):-1}function parseFullYear(d,string,i){var n=numberRe.exec(string.slice(i,i+4));return n?(d.y=+n[0],i+n[0].length):-1}function parseYear(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.y=+n[0]+(+n[0]>68?1900:2e3),i+n[0].length):-1}function parseZone(d,string,i){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(string.slice(i,i+6));return n?(d.Z=n[1]?0:-(n[2]+(n[3]||"00")),i+n[0].length):-1}function parseMonthNumber(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.m=n[0]-1,i+n[0].length):-1}function parseDayOfMonth(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.d=+n[0],i+n[0].length):-1}function parseDayOfYear(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.m=0,d.d=+n[0],i+n[0].length):-1}function parseHour24(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.H=+n[0],i+n[0].length):-1}function parseMinutes(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.M=+n[0],i+n[0].length):-1}function parseSeconds(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.S=+n[0],i+n[0].length):-1}function parseMilliseconds(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.L=+n[0],i+n[0].length):-1}function parseMicroseconds(d,string,i){var n=numberRe.exec(string.slice(i,i+6));return n?(d.L=Math.floor(n[0]/1e3),i+n[0].length):-1}function parseLiteralPercent(d,string,i){var n=percentRe.exec(string.slice(i,i+1));return n?i+n[0].length:-1}function parseUnixTimestamp(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.Q=+n[0],i+n[0].length):-1}function parseUnixTimestampSeconds(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.Q=1e3*+n[0],i+n[0].length):-1}function formatDayOfMonth(d,p){return pad(d.getDate(),p,2)}function formatHour24(d,p){return pad(d.getHours(),p,2)}function formatHour12(d,p){return pad(d.getHours()%12||12,p,2)}function formatDayOfYear(d,p){return pad(1+day.count(year(d),d),p,3)}function formatMilliseconds(d,p){return pad(d.getMilliseconds(),p,3)}function formatMicroseconds(d,p){return formatMilliseconds(d,p)+"000"}function formatMonthNumber(d,p){return pad(d.getMonth()+1,p,2)}function formatMinutes(d,p){return pad(d.getMinutes(),p,2)}function formatSeconds(d,p){return pad(d.getSeconds(),p,2)}function formatWeekdayNumberMonday(d){var day=d.getDay();return 0===day?7:day}function formatWeekNumberSunday(d,p){return pad(sunday.count(year(d),d),p,2)}function formatWeekNumberISO(d,p){var day=d.getDay();return d=day>=4||0===day?thursday(d):thursday.ceil(d),pad(thursday.count(year(d),d)+(4===year(d).getDay()),p,2)}function formatWeekdayNumberSunday(d){return d.getDay()}function formatWeekNumberMonday(d,p){return pad(monday.count(year(d),d),p,2)}function formatYear(d,p){return pad(d.getFullYear()%100,p,2)}function formatFullYear(d,p){return pad(d.getFullYear()%1e4,p,4)}function formatZone(d){var z=d.getTimezoneOffset();return(z>0?"-":(z*=-1,"+"))+pad(z/60|0,"0",2)+pad(z%60,"0",2)}function formatUTCDayOfMonth(d,p){return pad(d.getUTCDate(),p,2)}function formatUTCHour24(d,p){return pad(d.getUTCHours(),p,2)}function formatUTCHour12(d,p){return pad(d.getUTCHours()%12||12,p,2)}function formatUTCDayOfYear(d,p){return pad(1+utcDay.count(utcYear(d),d),p,3)}function formatUTCMilliseconds(d,p){return pad(d.getUTCMilliseconds(),p,3)}function formatUTCMicroseconds(d,p){return formatUTCMilliseconds(d,p)+"000"}function formatUTCMonthNumber(d,p){return pad(d.getUTCMonth()+1,p,2)}function formatUTCMinutes(d,p){return pad(d.getUTCMinutes(),p,2)}function formatUTCSeconds(d,p){return pad(d.getUTCSeconds(),p,2)}function formatUTCWeekdayNumberMonday(d){var dow=d.getUTCDay();return 0===dow?7:dow}function formatUTCWeekNumberSunday(d,p){return pad(utcSunday.count(utcYear(d),d),p,2)}function formatUTCWeekNumberISO(d,p){var day=d.getUTCDay();return d=day>=4||0===day?utcThursday(d):utcThursday.ceil(d),pad(utcThursday.count(utcYear(d),d)+(4===utcYear(d).getUTCDay()),p,2)}function formatUTCWeekdayNumberSunday(d){return d.getUTCDay()}function formatUTCWeekNumberMonday(d,p){return pad(utcMonday.count(utcYear(d),d),p,2)}function formatUTCYear(d,p){return pad(d.getUTCFullYear()%100,p,2)}function formatUTCFullYear(d,p){return pad(d.getUTCFullYear()%1e4,p,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(d){return+d}function formatUnixTimestampSeconds(d){return Math.floor(+d/1e3)}function defaultLocale$1(definition){return locale$1=formatLocale$1(definition),exports.timeFormat=locale$1.format,exports.timeParse=locale$1.parse,exports.utcFormat=locale$1.utcFormat,exports.utcParse=locale$1.utcParse,locale$1}defaultLocale$1({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var formatIso=Date.prototype.toISOString?function(date){return date.toISOString()}:exports.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ");var parseIso=+new Date("2000-01-01T00:00:00.000Z")?function(string){var date=new Date(string);return isNaN(date)?null:date}:exports.utcParse("%Y-%m-%dT%H:%M:%S.%LZ"),durationSecond$1=1e3,durationMinute$1=60*durationSecond$1,durationHour$1=60*durationMinute$1,durationDay$1=24*durationHour$1,durationWeek$1=7*durationDay$1,durationMonth=30*durationDay$1,durationYear=365*durationDay$1;function date$1(t){return new Date(t)}function number$3(t){return t instanceof Date?+t:+new Date(+t)}function calendar(year,month,week,day,hour,minute,second,millisecond,format){var scale=continuous(deinterpolateLinear,interpolateNumber),invert=scale.invert,domain=scale.domain,formatMillisecond=format(".%L"),formatSecond=format(":%S"),formatMinute=format("%I:%M"),formatHour=format("%I %p"),formatDay=format("%a %d"),formatWeek=format("%b %d"),formatMonth=format("%B"),formatYear=format("%Y"),tickIntervals=[[second,1,durationSecond$1],[second,5,5*durationSecond$1],[second,15,15*durationSecond$1],[second,30,30*durationSecond$1],[minute,1,durationMinute$1],[minute,5,5*durationMinute$1],[minute,15,15*durationMinute$1],[minute,30,30*durationMinute$1],[hour,1,durationHour$1],[hour,3,3*durationHour$1],[hour,6,6*durationHour$1],[hour,12,12*durationHour$1],[day,1,durationDay$1],[day,2,2*durationDay$1],[week,1,durationWeek$1],[month,1,durationMonth],[month,3,3*durationMonth],[year,1,durationYear]];function tickFormat(date){return(second(date)<date?formatMillisecond:minute(date)<date?formatSecond:hour(date)<date?formatMinute:day(date)<date?formatHour:month(date)<date?week(date)<date?formatDay:formatWeek:year(date)<date?formatMonth:formatYear)(date)}function tickInterval(interval,start,stop,step){if(null==interval&&(interval=10),"number"==typeof interval){var target=Math.abs(stop-start)/interval,i=bisector(function(i){return i[2]}).right(tickIntervals,target);i===tickIntervals.length?(step=tickStep(start/durationYear,stop/durationYear,interval),interval=year):i?(step=(i=tickIntervals[target/tickIntervals[i-1][2]<tickIntervals[i][2]/target?i-1:i])[1],interval=i[0]):(step=Math.max(tickStep(start,stop,interval),1),interval=millisecond)}return null==step?interval:interval.every(step)}return scale.invert=function(y){return new Date(invert(y))},scale.domain=function(_){return arguments.length?domain(map$1.call(_,number$3)):domain().map(date$1)},scale.ticks=function(interval,step){var t,d=domain(),t0=d[0],t1=d[d.length-1],r=t1<t0;return r&&(t=t0,t0=t1,t1=t),t=(t=tickInterval(interval,t0,t1,step))?t.range(t0,t1+1):[],r?t.reverse():t},scale.tickFormat=function(count,specifier){return null==specifier?tickFormat:format(specifier)},scale.nice=function(interval,step){var d=domain();return(interval=tickInterval(interval,d[0],d[d.length-1],step))?domain(function(domain,interval){var t,i0=0,i1=(domain=domain.slice()).length-1,x0=domain[i0],x1=domain[i1];return x1<x0&&(t=i0,i0=i1,i1=t,t=x0,x0=x1,x1=t),domain[i0]=interval.floor(x0),domain[i1]=interval.ceil(x1),domain}(d,interval)):scale},scale.copy=function(){return copy(scale,calendar(year,month,week,day,hour,minute,second,millisecond,format))},scale}function colors(s){return s.match(/.{6}/g).map(function(x){return"#"+x})}colors("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),colors("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),colors("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),colors("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),cubehelixLong(cubehelix(300,.5,0),cubehelix(-240,.5,1));cubehelixLong(cubehelix(-100,.75,.35),cubehelix(80,1.5,.8)),cubehelixLong(cubehelix(260,.75,.35),cubehelix(80,1.5,.8)),cubehelix();function ramp(range){var n=range.length;return function(t){return range[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}}ramp(colors("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));ramp(colors("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),ramp(colors("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),ramp(colors("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function constant$6(x){return function(){return x}}selection.prototype.attrs=function(map){return("function"==typeof map?function(selection,map){return selection.each(function(){var x=map.apply(this,arguments),s=select(this);for(var name in x)s.attr(name,x[name])})}:function(selection,map){for(var name in map)selection.attr(name,map[name]);return selection})(this,map)},selection.prototype.styles=function(map,priority){return("function"==typeof map?function(selection,map,priority){return selection.each(function(){var x=map.apply(this,arguments),s=select(this);for(var name in x)s.style(name,x[name],priority)})}:function(selection,map,priority){for(var name in map)selection.style(name,map[name],priority);return selection})(this,map,null==priority?"":priority)},selection.prototype.properties=function(map){return("function"==typeof map?function(selection,map){return selection.each(function(){var x=map.apply(this,arguments),s=select(this);for(var name in x)s.property(name,x[name])})}:function(selection,map){for(var name in map)selection.property(name,map[name]);return selection})(this,map)},transition.prototype.attrs=function(map){return("function"==typeof map?function(transition,map){return transition.each(function(){var x=map.apply(this,arguments),t=select(this).transition(transition);for(var name in x)t.attr(name,x[name])})}:function(transition,map){for(var name in map)transition.attr(name,map[name]);return transition})(this,map)},transition.prototype.styles=function(map,priority){return("function"==typeof map?function(transition,map,priority){return transition.each(function(){var x=map.apply(this,arguments),t=select(this).transition(transition);for(var name in x)t.style(name,x[name],priority)})}:function(transition,map,priority){for(var name in map)transition.style(name,map[name],priority);return transition})(this,map,null==priority?"":priority)};var abs=Math.abs,atan2=Math.atan2,cos=Math.cos,max$1=Math.max,min$1=Math.min,sin=Math.sin,sqrt=Math.sqrt,epsilon$2=1e-12,pi$2=Math.PI,halfPi$1=pi$2/2,tau$2=2*pi$2;function asin(x){return x>=1?halfPi$1:x<=-1?-halfPi$1:Math.asin(x)}function arcInnerRadius(d){return d.innerRadius}function arcOuterRadius(d){return d.outerRadius}function arcStartAngle(d){return d.startAngle}function arcEndAngle(d){return d.endAngle}function arcPadAngle(d){return d&&d.padAngle}function cornerTangents(x0,y0,x1,y1,r1,rc,cw){var x01=x0-x1,y01=y0-y1,lo=(cw?rc:-rc)/sqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x11=x0+ox,y11=y0+oy,x10=x1+ox,y10=y1+oy,x00=(x11+x10)/2,y00=(y11+y10)/2,dx=x10-x11,dy=y10-y11,d2=dx*dx+dy*dy,r=r1-rc,D=x11*y10-x10*y11,d=(dy<0?-1:1)*sqrt(max$1(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x00,dy0=cy0-y00,dx1=cx1-x00,dy1=cy1-y00;return dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1&&(cx0=cx1,cy0=cy1),{cx:cx0,cy:cy0,x01:-ox,y01:-oy,x11:cx0*(r1/r-1),y11:cy0*(r1/r-1)}}function Linear(context){this._context=context}function curveLinear(context){return new Linear(context)}function x(p){return p[0]}function y(p){return p[1]}function line(){var x$1=x,y$1=y,defined=constant$6(!0),context=null,curve=curveLinear,output=null;function line(data){var i,d,buffer,n=data.length,defined0=!1;for(null==context&&(output=curve(buffer=path())),i=0;i<=n;++i)!(i<n&&defined(d=data[i],i,data))===defined0&&((defined0=!defined0)?output.lineStart():output.lineEnd()),defined0&&output.point(+x$1(d,i,data),+y$1(d,i,data));if(buffer)return output=null,buffer+""||null}return line.x=function(_){return arguments.length?(x$1="function"==typeof _?_:constant$6(+_),line):x$1},line.y=function(_){return arguments.length?(y$1="function"==typeof _?_:constant$6(+_),line):y$1},line.defined=function(_){return arguments.length?(defined="function"==typeof _?_:constant$6(!!_),line):defined},line.curve=function(_){return arguments.length?(curve=_,null!=context&&(output=curve(context)),line):curve},line.context=function(_){return arguments.length?(null==_?context=output=null:output=curve(context=_),line):context},line}function area(){var x0=x,x1=null,y0=constant$6(0),y1=y,defined=constant$6(!0),context=null,curve=curveLinear,output=null;function area(data){var i,j,k,d,buffer,n=data.length,defined0=!1,x0z=new Array(n),y0z=new Array(n);for(null==context&&(output=curve(buffer=path())),i=0;i<=n;++i){if(!(i<n&&defined(d=data[i],i,data))===defined0)if(defined0=!defined0)j=i,output.areaStart(),output.lineStart();else{for(output.lineEnd(),output.lineStart(),k=i-1;k>=j;--k)output.point(x0z[k],y0z[k]);output.lineEnd(),output.areaEnd()}defined0&&(x0z[i]=+x0(d,i,data),y0z[i]=+y0(d,i,data),output.point(x1?+x1(d,i,data):x0z[i],y1?+y1(d,i,data):y0z[i]))}if(buffer)return output=null,buffer+""||null}function arealine(){return line().defined(defined).curve(curve).context(context)}return area.x=function(_){return arguments.length?(x0="function"==typeof _?_:constant$6(+_),x1=null,area):x0},area.x0=function(_){return arguments.length?(x0="function"==typeof _?_:constant$6(+_),area):x0},area.x1=function(_){return arguments.length?(x1=null==_?null:"function"==typeof _?_:constant$6(+_),area):x1},area.y=function(_){return arguments.length?(y0="function"==typeof _?_:constant$6(+_),y1=null,area):y0},area.y0=function(_){return arguments.length?(y0="function"==typeof _?_:constant$6(+_),area):y0},area.y1=function(_){return arguments.length?(y1=null==_?null:"function"==typeof _?_:constant$6(+_),area):y1},area.lineX0=area.lineY0=function(){return arealine().x(x0).y(y0)},area.lineY1=function(){return arealine().x(x0).y(y1)},area.lineX1=function(){return arealine().x(x1).y(y0)},area.defined=function(_){return arguments.length?(defined="function"==typeof _?_:constant$6(!!_),area):defined},area.curve=function(_){return arguments.length?(curve=_,null!=context&&(output=curve(context)),area):curve},area.context=function(_){return arguments.length?(null==_?context=output=null:output=curve(context=_),area):context},area}function descending$1(a,b){return b<a?-1:b>a?1:b>=a?0:NaN}function identity$3(d){return d}Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:this._context.lineTo(x,y)}}};var curveRadialLinear=curveRadial(curveLinear);function Radial(curve){this._curve=curve}function curveRadial(curve){function radial(context){return new Radial(curve(context))}return radial._curve=curve,radial}function lineRadial(l){var c=l.curve;return l.angle=l.x,delete l.x,l.radius=l.y,delete l.y,l.curve=function(_){return arguments.length?c(curveRadial(_)):c()._curve},l}function lineRadial$1(){return lineRadial(line().curve(curveRadialLinear))}function areaRadial(){var a=area().curve(curveRadialLinear),c=a.curve,x0=a.lineX0,x1=a.lineX1,y0=a.lineY0,y1=a.lineY1;return a.angle=a.x,delete a.x,a.startAngle=a.x0,delete a.x0,a.endAngle=a.x1,delete a.x1,a.radius=a.y,delete a.y,a.innerRadius=a.y0,delete a.y0,a.outerRadius=a.y1,delete a.y1,a.lineStartAngle=function(){return lineRadial(x0())},delete a.lineX0,a.lineEndAngle=function(){return lineRadial(x1())},delete a.lineX1,a.lineInnerRadius=function(){return lineRadial(y0())},delete a.lineY0,a.lineOuterRadius=function(){return lineRadial(y1())},delete a.lineY1,a.curve=function(_){return arguments.length?c(curveRadial(_)):c()._curve},a}Radial.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(a,r){this._curve.point(r*Math.sin(a),r*-Math.cos(a))}};var slice$3=Array.prototype.slice;function noop$1(){}function point$2(that,x,y){that._context.bezierCurveTo(that._x1+that._k*(that._x2-that._x0),that._y1+that._k*(that._y2-that._y0),that._x2+that._k*(that._x1-x),that._y2+that._k*(that._y1-y),that._x2,that._y2)}function Cardinal(context,tension){this._context=context,this._k=(1-tension)/6}Cardinal.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:point$2(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2,this._x1=x,this._y1=y;break;case 2:this._point=3;default:point$2(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var cardinal=function custom(tension){function cardinal(context){return new Cardinal(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0);function CardinalClosed(context,tension){this._context=context,this._k=(1-tension)/6}CardinalClosed.prototype={areaStart:noop$1,areaEnd:noop$1,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._x3=x,this._y3=y;break;case 1:this._point=2,this._context.moveTo(this._x4=x,this._y4=y);break;case 2:this._point=3,this._x5=x,this._y5=y;break;default:point$2(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var cardinalClosed=function custom(tension){function cardinal(context){return new CardinalClosed(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal}(0);function LinearClosed(context){this._context=context}function sign(x){return x<0?-1:1}function slope3(that,x2,y2){var h0=that._x1-that._x0,h1=x2-that._x1,s0=(that._y1-that._y0)/(h0||h1<0&&-0),s1=(y2-that._y1)/(h1||h0<0&&-0),p=(s0*h1+s1*h0)/(h0+h1);return(sign(s0)+sign(s1))*Math.min(Math.abs(s0),Math.abs(s1),.5*Math.abs(p))||0}function slope2(that,t){var h=that._x1-that._x0;return h?(3*(that._y1-that._y0)/h-t)/2:t}function point$3(that,t0,t1){var x0=that._x0,y0=that._y0,x1=that._x1,y1=that._y1,dx=(x1-x0)/3;that._context.bezierCurveTo(x0+dx,y0+dx*t0,x1-dx,y1-dx*t1,x1,y1)}function MonotoneX(context){this._context=context}function MonotoneY(context){this._context=new ReflectContext(context)}function ReflectContext(context){this._context=context}function Step(context,t){this._context=context,this._t=t}function none$1(series,order){if((n=series.length)>1)for(var j,s0,n,i=1,s1=series[order[0]],m=s1.length;i<n;++i)for(s0=s1,s1=series[order[i]],j=0;j<m;++j)s1[j][1]+=s1[j][0]=isNaN(s0[j][1])?s0[j][0]:s0[j][1]}function none$2(series){for(var n=series.length,o=new Array(n);--n>=0;)o[n]=n;return o}function stackValue(d,key){return d[key]}function constant$7(x){return function(){return x}}function Transform(k,x,y){this.k=k,this.x=x,this.y=y}LinearClosed.prototype={areaStart:noop$1,areaEnd:noop$1,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(x,y){x=+x,y=+y,this._point?this._context.lineTo(x,y):(this._point=1,this._context.moveTo(x,y))}},MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$3(this,this._t0,slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(x,y){var t1=NaN;if(y=+y,(x=+x)!==this._x1||y!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3,point$3(this,slope2(this,t1=slope3(this,x,y)),t1);break;default:point$3(this,this._t0,t1=slope3(this,x,y))}this._x0=this._x1,this._x1=x,this._y0=this._y1,this._y1=y,this._t0=t1}}},(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(x,y){MonotoneX.prototype.point.call(this,y,x)},ReflectContext.prototype={moveTo:function(x,y){this._context.moveTo(y,x)},closePath:function(){this._context.closePath()},lineTo:function(x,y){this._context.lineTo(y,x)},bezierCurveTo:function(x1,y1,x2,y2,x,y){this._context.bezierCurveTo(y1,x1,y2,x2,y,x)}},Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,y),this._context.lineTo(x,y);else{var x1=this._x*(1-this._t)+x*this._t;this._context.lineTo(x1,this._y),this._context.lineTo(x1,y)}}this._x=x,this._y=y}},Transform.prototype={constructor:Transform,scale:function(k){return 1===k?this:new Transform(this.k*k,this.x,this.y)},translate:function(x,y){return 0===x&0===y?this:new Transform(this.k,this.x+this.k*x,this.y+this.k*y)},apply:function(point){return[point[0]*this.k+this.x,point[1]*this.k+this.y]},applyX:function(x){return x*this.k+this.x},applyY:function(y){return y*this.k+this.y},invert:function(location){return[(location[0]-this.x)/this.k,(location[1]-this.y)/this.k]},invertX:function(x){return(x-this.x)/this.k},invertY:function(y){return(y-this.y)/this.k},rescaleX:function(x){return x.copy().domain(x.range().map(this.invertX,this).map(x.invert,x))},rescaleY:function(y){return y.copy().domain(y.range().map(this.invertY,this).map(y.invert,y))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var identity$4=new Transform(1,0,0);function transform(node){return node.__zoom||identity$4}function nopropagation$2(){exports.event.stopImmediatePropagation()}function noevent$2(){exports.event.preventDefault(),exports.event.stopImmediatePropagation()}function defaultFilter$2(){return!exports.event.button}function defaultExtent$1(){var w,h,e=this;return e instanceof SVGElement?(w=(e=e.ownerSVGElement||e).width.baseVal.value,h=e.height.baseVal.value):(w=e.clientWidth,h=e.clientHeight),[[0,0],[w,h]]}function defaultTransform(){return this.__zoom||identity$4}function defaultWheelDelta(){return-exports.event.deltaY*(exports.event.deltaMode?120:1)/500}function defaultTouchable$1(){return"ontouchstart"in this}function defaultConstrain(transform,extent,translateExtent){var dx0=transform.invertX(extent[0][0])-translateExtent[0][0],dx1=transform.invertX(extent[1][0])-translateExtent[1][0],dy0=transform.invertY(extent[0][1])-translateExtent[0][1],dy1=transform.invertY(extent[1][1])-translateExtent[1][1];return transform.translate(dx1>dx0?(dx0+dx1)/2:Math.min(0,dx0)||Math.max(0,dx1),dy1>dy0?(dy0+dy1)/2:Math.min(0,dy0)||Math.max(0,dy1))}function lexicographicOrder(a,b){return a[0]-b[0]||a[1]-b[1]}function computeUpperHullIndexes(points){for(var a,b,c,n=points.length,indexes=[0,1],size=2,i=2;i<n;++i){for(;size>1&&(a=points[indexes[size-2]],b=points[indexes[size-1]],c=points[i],(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])<=0);)--size;indexes[size++]=i}return indexes.slice(0,size)}function adder(){return new Adder}function Adder(){this.reset()}transform.prototype=Transform.prototype,Adder.prototype={constructor:Adder,reset:function(){this.s=this.t=0},add:function(y){add(temp,y,this.t),add(this,temp.s,this.s),this.s?this.t+=temp.t:this.s=temp.t},valueOf:function(){return this.s}};var temp=new Adder;function add(adder,a,b){var x=adder.s=a+b,bv=x-a,av=x-bv;adder.t=a-av+(b-bv)}var epsilon$3=1e-6,epsilon2$1=1e-12,pi$3=Math.PI,halfPi$2=pi$3/2,quarterPi=pi$3/4,tau$3=2*pi$3,degrees$1=180/pi$3,radians=pi$3/180,abs$1=Math.abs,atan=Math.atan,atan2$1=Math.atan2,cos$1=Math.cos,ceil=Math.ceil,exp=Math.exp,log=Math.log,pow=Math.pow,sin$1=Math.sin,sign$1=Math.sign||function(x){return x>0?1:x<0?-1:0},sqrt$1=Math.sqrt,tan=Math.tan;function acos$1(x){return x>1?0:x<-1?pi$3:Math.acos(x)}function asin$1(x){return x>1?halfPi$2:x<-1?-halfPi$2:Math.asin(x)}function haversin(x){return(x=sin$1(x/2))*x}function noop$2(){}function streamGeometry(geometry,stream){geometry&&streamGeometryType.hasOwnProperty(geometry.type)&&streamGeometryType[geometry.type](geometry,stream)}var streamObjectType={Feature:function(object,stream){streamGeometry(object.geometry,stream)},FeatureCollection:function(object,stream){for(var features=object.features,i=-1,n=features.length;++i<n;)streamGeometry(features[i].geometry,stream)}},streamGeometryType={Sphere:function(object,stream){stream.sphere()},Point:function(object,stream){object=object.coordinates,stream.point(object[0],object[1],object[2])},MultiPoint:function(object,stream){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)object=coordinates[i],stream.point(object[0],object[1],object[2])},LineString:function(object,stream){streamLine(object.coordinates,stream,0)},MultiLineString:function(object,stream){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)streamLine(coordinates[i],stream,0)},Polygon:function(object,stream){streamPolygon(object.coordinates,stream)},MultiPolygon:function(object,stream){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)streamPolygon(coordinates[i],stream)},GeometryCollection:function(object,stream){for(var geometries=object.geometries,i=-1,n=geometries.length;++i<n;)streamGeometry(geometries[i],stream)}};function streamLine(coordinates,stream,closed){var coordinate,i=-1,n=coordinates.length-closed;for(stream.lineStart();++i<n;)coordinate=coordinates[i],stream.point(coordinate[0],coordinate[1],coordinate[2]);stream.lineEnd()}function streamPolygon(coordinates,stream){var i=-1,n=coordinates.length;for(stream.polygonStart();++i<n;)streamLine(coordinates[i],stream,1);stream.polygonEnd()}function geoStream(object,stream){object&&streamObjectType.hasOwnProperty(object.type)?streamObjectType[object.type](object,stream):streamGeometry(object,stream)}var lambda00,phi00,lambda0,cosPhi0,sinPhi0,areaRingSum=adder(),areaSum=adder(),areaStream={point:noop$2,lineStart:noop$2,lineEnd:noop$2,polygonStart:function(){areaRingSum.reset(),areaStream.lineStart=areaRingStart,areaStream.lineEnd=areaRingEnd},polygonEnd:function(){var areaRing=+areaRingSum;areaSum.add(areaRing<0?tau$3+areaRing:areaRing),this.lineStart=this.lineEnd=this.point=noop$2},sphere:function(){areaSum.add(tau$3)}};function areaRingStart(){areaStream.point=areaPointFirst}function areaRingEnd(){areaPoint(lambda00,phi00)}function areaPointFirst(lambda,phi){areaStream.point=areaPoint,lambda00=lambda,phi00=phi,lambda0=lambda*=radians,cosPhi0=cos$1(phi=(phi*=radians)/2+quarterPi),sinPhi0=sin$1(phi)}function areaPoint(lambda,phi){phi=(phi*=radians)/2+quarterPi;var dLambda=(lambda*=radians)-lambda0,sdLambda=dLambda>=0?1:-1,adLambda=sdLambda*dLambda,cosPhi=cos$1(phi),sinPhi=sin$1(phi),k=sinPhi0*sinPhi,u=cosPhi0*cosPhi+k*cos$1(adLambda),v=k*sdLambda*sin$1(adLambda);areaRingSum.add(atan2$1(v,u)),lambda0=lambda,cosPhi0=cosPhi,sinPhi0=sinPhi}function spherical(cartesian){return[atan2$1(cartesian[1],cartesian[0]),asin$1(cartesian[2])]}function cartesian(spherical){var lambda=spherical[0],phi=spherical[1],cosPhi=cos$1(phi);return[cosPhi*cos$1(lambda),cosPhi*sin$1(lambda),sin$1(phi)]}function cartesianDot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function cartesianCross(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function cartesianAddInPlace(a,b){a[0]+=b[0],a[1]+=b[1],a[2]+=b[2]}function cartesianScale(vector,k){return[vector[0]*k,vector[1]*k,vector[2]*k]}function cartesianNormalizeInPlace(d){var l=sqrt$1(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);d[0]/=l,d[1]/=l,d[2]/=l}var lambda0$1,phi0,lambda1,phi1,lambda2,lambda00$1,phi00$1,p0,ranges,range,W0,W1,X0,Y0,Z0,X1,Y1,Z1,X2,Y2,Z2,lambda00$2,phi00$2,x0,y0,z0,deltaSum=adder(),boundsStream={point:boundsPoint,lineStart:boundsLineStart,lineEnd:boundsLineEnd,polygonStart:function(){boundsStream.point=boundsRingPoint,boundsStream.lineStart=boundsRingStart,boundsStream.lineEnd=boundsRingEnd,deltaSum.reset(),areaStream.polygonStart()},polygonEnd:function(){areaStream.polygonEnd(),boundsStream.point=boundsPoint,boundsStream.lineStart=boundsLineStart,boundsStream.lineEnd=boundsLineEnd,areaRingSum<0?(lambda0$1=-(lambda1=180),phi0=-(phi1=90)):deltaSum>epsilon$3?phi1=90:deltaSum<-epsilon$3&&(phi0=-90),range[0]=lambda0$1,range[1]=lambda1}};function boundsPoint(lambda,phi){ranges.push(range=[lambda0$1=lambda,lambda1=lambda]),phi<phi0&&(phi0=phi),phi>phi1&&(phi1=phi)}function linePoint(lambda,phi){var p=cartesian([lambda*radians,phi*radians]);if(p0){var normal=cartesianCross(p0,p),inflection=cartesianCross([normal[1],-normal[0],0],normal);cartesianNormalizeInPlace(inflection),inflection=spherical(inflection);var phii,delta=lambda-lambda2,sign=delta>0?1:-1,lambdai=inflection[0]*degrees$1*sign,antimeridian=abs$1(delta)>180;antimeridian^(sign*lambda2<lambdai&&lambdai<sign*lambda)?(phii=inflection[1]*degrees$1)>phi1&&(phi1=phii):antimeridian^(sign*lambda2<(lambdai=(lambdai+360)%360-180)&&lambdai<sign*lambda)?(phii=-inflection[1]*degrees$1)<phi0&&(phi0=phii):(phi<phi0&&(phi0=phi),phi>phi1&&(phi1=phi)),antimeridian?lambda<lambda2?angle(lambda0$1,lambda)>angle(lambda0$1,lambda1)&&(lambda1=lambda):angle(lambda,lambda1)>angle(lambda0$1,lambda1)&&(lambda0$1=lambda):lambda1>=lambda0$1?(lambda<lambda0$1&&(lambda0$1=lambda),lambda>lambda1&&(lambda1=lambda)):lambda>lambda2?angle(lambda0$1,lambda)>angle(lambda0$1,lambda1)&&(lambda1=lambda):angle(lambda,lambda1)>angle(lambda0$1,lambda1)&&(lambda0$1=lambda)}else ranges.push(range=[lambda0$1=lambda,lambda1=lambda]);phi<phi0&&(phi0=phi),phi>phi1&&(phi1=phi),p0=p,lambda2=lambda}function boundsLineStart(){boundsStream.point=linePoint}function boundsLineEnd(){range[0]=lambda0$1,range[1]=lambda1,boundsStream.point=boundsPoint,p0=null}function boundsRingPoint(lambda,phi){if(p0){var delta=lambda-lambda2;deltaSum.add(abs$1(delta)>180?delta+(delta>0?360:-360):delta)}else lambda00$1=lambda,phi00$1=phi;areaStream.point(lambda,phi),linePoint(lambda,phi)}function boundsRingStart(){areaStream.lineStart()}function boundsRingEnd(){boundsRingPoint(lambda00$1,phi00$1),areaStream.lineEnd(),abs$1(deltaSum)>epsilon$3&&(lambda0$1=-(lambda1=180)),range[0]=lambda0$1,range[1]=lambda1,p0=null}function angle(lambda0,lambda1){return(lambda1-=lambda0)<0?lambda1+360:lambda1}function rangeCompare(a,b){return a[0]-b[0]}function rangeContains(range,x){return range[0]<=range[1]?range[0]<=x&&x<=range[1]:x<range[0]||range[1]<x}var centroidStream={sphere:noop$2,point:centroidPoint,lineStart:centroidLineStart,lineEnd:centroidLineEnd,polygonStart:function(){centroidStream.lineStart=centroidRingStart,centroidStream.lineEnd=centroidRingEnd},polygonEnd:function(){centroidStream.lineStart=centroidLineStart,centroidStream.lineEnd=centroidLineEnd}};function centroidPoint(lambda,phi){lambda*=radians;var cosPhi=cos$1(phi*=radians);centroidPointCartesian(cosPhi*cos$1(lambda),cosPhi*sin$1(lambda),sin$1(phi))}function centroidPointCartesian(x,y,z){X0+=(x-X0)/++W0,Y0+=(y-Y0)/W0,Z0+=(z-Z0)/W0}function centroidLineStart(){centroidStream.point=centroidLinePointFirst}function centroidLinePointFirst(lambda,phi){lambda*=radians;var cosPhi=cos$1(phi*=radians);x0=cosPhi*cos$1(lambda),y0=cosPhi*sin$1(lambda),z0=sin$1(phi),centroidStream.point=centroidLinePoint,centroidPointCartesian(x0,y0,z0)}function centroidLinePoint(lambda,phi){lambda*=radians;var cosPhi=cos$1(phi*=radians),x=cosPhi*cos$1(lambda),y=cosPhi*sin$1(lambda),z=sin$1(phi),w=atan2$1(sqrt$1((w=y0*z-z0*y)*w+(w=z0*x-x0*z)*w+(w=x0*y-y0*x)*w),x0*x+y0*y+z0*z);W1+=w,X1+=w*(x0+(x0=x)),Y1+=w*(y0+(y0=y)),Z1+=w*(z0+(z0=z)),centroidPointCartesian(x0,y0,z0)}function centroidLineEnd(){centroidStream.point=centroidPoint}function centroidRingStart(){centroidStream.point=centroidRingPointFirst}function centroidRingEnd(){centroidRingPoint(lambda00$2,phi00$2),centroidStream.point=centroidPoint}function centroidRingPointFirst(lambda,phi){lambda00$2=lambda,phi00$2=phi,lambda*=radians,phi*=radians,centroidStream.point=centroidRingPoint;var cosPhi=cos$1(phi);x0=cosPhi*cos$1(lambda),y0=cosPhi*sin$1(lambda),z0=sin$1(phi),centroidPointCartesian(x0,y0,z0)}function centroidRingPoint(lambda,phi){lambda*=radians;var cosPhi=cos$1(phi*=radians),x=cosPhi*cos$1(lambda),y=cosPhi*sin$1(lambda),z=sin$1(phi),cx=y0*z-z0*y,cy=z0*x-x0*z,cz=x0*y-y0*x,m=sqrt$1(cx*cx+cy*cy+cz*cz),w=asin$1(m),v=m&&-w/m;X2+=v*cx,Y2+=v*cy,Z2+=v*cz,W1+=w,X1+=w*(x0+(x0=x)),Y1+=w*(y0+(y0=y)),Z1+=w*(z0+(z0=z)),centroidPointCartesian(x0,y0,z0)}function centroid$1(object){W0=W1=X0=Y0=Z0=X1=Y1=Z1=X2=Y2=Z2=0,geoStream(object,centroidStream);var x=X2,y=Y2,z=Z2,m=x*x+y*y+z*z;return m<epsilon2$1&&(x=X1,y=Y1,z=Z1,W1<epsilon$3&&(x=X0,y=Y0,z=Z0),(m=x*x+y*y+z*z)<epsilon2$1)?[NaN,NaN]:[atan2$1(y,x)*degrees$1,asin$1(z/sqrt$1(m))*degrees$1]}function constant$8(x){return function(){return x}}function compose(a,b){function compose(x,y){return x=a(x,y),b(x[0],x[1])}return a.invert&&b.invert&&(compose.invert=function(x,y){return(x=b.invert(x,y))&&a.invert(x[0],x[1])}),compose}function rotationIdentity(lambda,phi){return[lambda>pi$3?lambda-tau$3:lambda<-pi$3?lambda+tau$3:lambda,phi]}function rotateRadians(deltaLambda,deltaPhi,deltaGamma){return(deltaLambda%=tau$3)?deltaPhi||deltaGamma?compose(rotationLambda(deltaLambda),rotationPhiGamma(deltaPhi,deltaGamma)):rotationLambda(deltaLambda):deltaPhi||deltaGamma?rotationPhiGamma(deltaPhi,deltaGamma):rotationIdentity}function forwardRotationLambda(deltaLambda){return function(lambda,phi){return[(lambda+=deltaLambda)>pi$3?lambda-tau$3:lambda<-pi$3?lambda+tau$3:lambda,phi]}}function rotationLambda(deltaLambda){var rotation=forwardRotationLambda(deltaLambda);return rotation.invert=forwardRotationLambda(-deltaLambda),rotation}function rotationPhiGamma(deltaPhi,deltaGamma){var cosDeltaPhi=cos$1(deltaPhi),sinDeltaPhi=sin$1(deltaPhi),cosDeltaGamma=cos$1(deltaGamma),sinDeltaGamma=sin$1(deltaGamma);function rotation(lambda,phi){var cosPhi=cos$1(phi),x=cos$1(lambda)*cosPhi,y=sin$1(lambda)*cosPhi,z=sin$1(phi),k=z*cosDeltaPhi+x*sinDeltaPhi;return[atan2$1(y*cosDeltaGamma-k*sinDeltaGamma,x*cosDeltaPhi-z*sinDeltaPhi),asin$1(k*cosDeltaGamma+y*sinDeltaGamma)]}return rotation.invert=function(lambda,phi){var cosPhi=cos$1(phi),x=cos$1(lambda)*cosPhi,y=sin$1(lambda)*cosPhi,z=sin$1(phi),k=z*cosDeltaGamma-y*sinDeltaGamma;return[atan2$1(y*cosDeltaGamma+z*sinDeltaGamma,x*cosDeltaPhi+k*sinDeltaPhi),asin$1(k*cosDeltaPhi-x*sinDeltaPhi)]},rotation}function rotation(rotate){function forward(coordinates){return(coordinates=rotate(coordinates[0]*radians,coordinates[1]*radians))[0]*=degrees$1,coordinates[1]*=degrees$1,coordinates}return rotate=rotateRadians(rotate[0]*radians,rotate[1]*radians,rotate.length>2?rotate[2]*radians:0),forward.invert=function(coordinates){return(coordinates=rotate.invert(coordinates[0]*radians,coordinates[1]*radians))[0]*=degrees$1,coordinates[1]*=degrees$1,coordinates},forward}function circleStream(stream,radius,delta,direction,t0,t1){if(delta){var cosRadius=cos$1(radius),sinRadius=sin$1(radius),step=direction*delta;null==t0?(t0=radius+direction*tau$3,t1=radius-step/2):(t0=circleRadius(cosRadius,t0),t1=circleRadius(cosRadius,t1),(direction>0?t0<t1:t0>t1)&&(t0+=direction*tau$3));for(var point,t=t0;direction>0?t>t1:t<t1;t-=step)point=spherical([cosRadius,-sinRadius*cos$1(t),-sinRadius*sin$1(t)]),stream.point(point[0],point[1])}}function circleRadius(cosRadius,point){(point=cartesian(point))[0]-=cosRadius,cartesianNormalizeInPlace(point);var radius=acos$1(-point[1]);return((-point[2]<0?-radius:radius)+tau$3-epsilon$3)%tau$3}function clipBuffer(){var line,lines=[];return{point:function(x,y){line.push([x,y])},lineStart:function(){lines.push(line=[])},lineEnd:noop$2,rejoin:function(){lines.length>1&&lines.push(lines.pop().concat(lines.shift()))},result:function(){var result=lines;return lines=[],line=null,result}}}function pointEqual(a,b){return abs$1(a[0]-b[0])<epsilon$3&&abs$1(a[1]-b[1])<epsilon$3}function Intersection(point,points,other,entry){this.x=point,this.z=points,this.o=other,this.e=entry,this.v=!1,this.n=this.p=null}function clipRejoin(segments,compareIntersection,startInside,interpolate,stream){var i,n,subject=[],clip=[];if(segments.forEach(function(segment){if(!((n=segment.length-1)<=0)){var n,x,p0=segment[0],p1=segment[n];if(pointEqual(p0,p1)){for(stream.lineStart(),i=0;i<n;++i)stream.point((p0=segment[i])[0],p0[1]);stream.lineEnd()}else subject.push(x=new Intersection(p0,segment,null,!0)),clip.push(x.o=new Intersection(p0,null,x,!1)),subject.push(x=new Intersection(p1,segment,null,!1)),clip.push(x.o=new Intersection(p1,null,x,!0))}}),subject.length){for(clip.sort(compareIntersection),link(subject),link(clip),i=0,n=clip.length;i<n;++i)clip[i].e=startInside=!startInside;for(var points,point,start=subject[0];;){for(var current=start,isSubject=!0;current.v;)if((current=current.n)===start)return;points=current.z,stream.lineStart();do{if(current.v=current.o.v=!0,current.e){if(isSubject)for(i=0,n=points.length;i<n;++i)stream.point((point=points[i])[0],point[1]);else interpolate(current.x,current.n.x,1,stream);current=current.n}else{if(isSubject)for(points=current.p.z,i=points.length-1;i>=0;--i)stream.point((point=points[i])[0],point[1]);else interpolate(current.x,current.p.x,-1,stream);current=current.p}points=(current=current.o).z,isSubject=!isSubject}while(!current.v);stream.lineEnd()}}}function link(array){if(n=array.length){for(var n,b,i=0,a=array[0];++i<n;)a.n=b=array[i],b.p=a,a=b;a.n=b=array[0],b.p=a}}rotationIdentity.invert=rotationIdentity;var sum$1=adder();function polygonContains(polygon,point){var lambda=point[0],phi=point[1],sinPhi=sin$1(phi),normal=[sin$1(lambda),-cos$1(lambda),0],angle=0,winding=0;sum$1.reset(),1===sinPhi?phi=halfPi$2+epsilon$3:-1===sinPhi&&(phi=-halfPi$2-epsilon$3);for(var i=0,n=polygon.length;i<n;++i)if(m=(ring=polygon[i]).length)for(var ring,m,point0=ring[m-1],lambda0=point0[0],phi0=point0[1]/2+quarterPi,sinPhi0=sin$1(phi0),cosPhi0=cos$1(phi0),j=0;j<m;++j,lambda0=lambda1,sinPhi0=sinPhi1,cosPhi0=cosPhi1,point0=point1){var point1=ring[j],lambda1=point1[0],phi1=point1[1]/2+quarterPi,sinPhi1=sin$1(phi1),cosPhi1=cos$1(phi1),delta=lambda1-lambda0,sign=delta>=0?1:-1,absDelta=sign*delta,antimeridian=absDelta>pi$3,k=sinPhi0*sinPhi1;if(sum$1.add(atan2$1(k*sign*sin$1(absDelta),cosPhi0*cosPhi1+k*cos$1(absDelta))),angle+=antimeridian?delta+sign*tau$3:delta,antimeridian^lambda0>=lambda^lambda1>=lambda){var arc=cartesianCross(cartesian(point0),cartesian(point1));cartesianNormalizeInPlace(arc);var intersection=cartesianCross(normal,arc);cartesianNormalizeInPlace(intersection);var phiArc=(antimeridian^delta>=0?-1:1)*asin$1(intersection[2]);(phi>phiArc||phi===phiArc&&(arc[0]||arc[1]))&&(winding+=antimeridian^delta>=0?1:-1)}}return(angle<-epsilon$3||angle<epsilon$3&&sum$1<-epsilon$3)^1&winding}function clip(pointVisible,clipLine,interpolate,start){return function(sink){var polygon,segments,ring,line=clipLine(sink),ringBuffer=clipBuffer(),ringSink=clipLine(ringBuffer),polygonStarted=!1,clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){clip.point=pointRing,clip.lineStart=ringStart,clip.lineEnd=ringEnd,segments=[],polygon=[]},polygonEnd:function(){clip.point=point,clip.lineStart=lineStart,clip.lineEnd=lineEnd,segments=merge(segments);var startInside=polygonContains(polygon,start);segments.length?(polygonStarted||(sink.polygonStart(),polygonStarted=!0),clipRejoin(segments,compareIntersection,startInside,interpolate,sink)):startInside&&(polygonStarted||(sink.polygonStart(),polygonStarted=!0),sink.lineStart(),interpolate(null,null,1,sink),sink.lineEnd()),polygonStarted&&(sink.polygonEnd(),polygonStarted=!1),segments=polygon=null},sphere:function(){sink.polygonStart(),sink.lineStart(),interpolate(null,null,1,sink),sink.lineEnd(),sink.polygonEnd()}};function point(lambda,phi){pointVisible(lambda,phi)&&sink.point(lambda,phi)}function pointLine(lambda,phi){line.point(lambda,phi)}function lineStart(){clip.point=pointLine,line.lineStart()}function lineEnd(){clip.point=point,line.lineEnd()}function pointRing(lambda,phi){ring.push([lambda,phi]),ringSink.point(lambda,phi)}function ringStart(){ringSink.lineStart(),ring=[]}function ringEnd(){pointRing(ring[0][0],ring[0][1]),ringSink.lineEnd();var i,m,segment,point,clean=ringSink.clean(),ringSegments=ringBuffer.result(),n=ringSegments.length;if(ring.pop(),polygon.push(ring),ring=null,n)if(1&clean){if((m=(segment=ringSegments[0]).length-1)>0){for(polygonStarted||(sink.polygonStart(),polygonStarted=!0),sink.lineStart(),i=0;i<m;++i)sink.point((point=segment[i])[0],point[1]);sink.lineEnd()}}else n>1&&2&clean&&ringSegments.push(ringSegments.pop().concat(ringSegments.shift())),segments.push(ringSegments.filter(validSegment))}return clip}}function validSegment(segment){return segment.length>1}function compareIntersection(a,b){return((a=a.x)[0]<0?a[1]-halfPi$2-epsilon$3:halfPi$2-a[1])-((b=b.x)[0]<0?b[1]-halfPi$2-epsilon$3:halfPi$2-b[1])}var clipAntimeridian=clip(function(){return!0},function(stream){var clean,lambda0=NaN,phi0=NaN,sign0=NaN;return{lineStart:function(){stream.lineStart(),clean=1},point:function(lambda1,phi1){var sign1=lambda1>0?pi$3:-pi$3,delta=abs$1(lambda1-lambda0);abs$1(delta-pi$3)<epsilon$3?(stream.point(lambda0,phi0=(phi0+phi1)/2>0?halfPi$2:-halfPi$2),stream.point(sign0,phi0),stream.lineEnd(),stream.lineStart(),stream.point(sign1,phi0),stream.point(lambda1,phi0),clean=0):sign0!==sign1&&delta>=pi$3&&(abs$1(lambda0-sign0)<epsilon$3&&(lambda0-=sign0*epsilon$3),abs$1(lambda1-sign1)<epsilon$3&&(lambda1-=sign1*epsilon$3),phi0=function(lambda0,phi0,lambda1,phi1){var cosPhi0,cosPhi1,sinLambda0Lambda1=sin$1(lambda0-lambda1);return abs$1(sinLambda0Lambda1)>epsilon$3?atan((sin$1(phi0)*(cosPhi1=cos$1(phi1))*sin$1(lambda1)-sin$1(phi1)*(cosPhi0=cos$1(phi0))*sin$1(lambda0))/(cosPhi0*cosPhi1*sinLambda0Lambda1)):(phi0+phi1)/2}(lambda0,phi0,lambda1,phi1),stream.point(sign0,phi0),stream.lineEnd(),stream.lineStart(),stream.point(sign1,phi0),clean=0),stream.point(lambda0=lambda1,phi0=phi1),sign0=sign1},lineEnd:function(){stream.lineEnd(),lambda0=phi0=NaN},clean:function(){return 2-clean}}},function(from,to,direction,stream){var phi;if(null==from)phi=direction*halfPi$2,stream.point(-pi$3,phi),stream.point(0,phi),stream.point(pi$3,phi),stream.point(pi$3,0),stream.point(pi$3,-phi),stream.point(0,-phi),stream.point(-pi$3,-phi),stream.point(-pi$3,0),stream.point(-pi$3,phi);else if(abs$1(from[0]-to[0])>epsilon$3){var lambda=from[0]<to[0]?pi$3:-pi$3;phi=direction*lambda/2,stream.point(-lambda,phi),stream.point(0,phi),stream.point(lambda,phi)}else stream.point(to[0],to[1])},[-pi$3,-halfPi$2]);function clipCircle(radius){var cr=cos$1(radius),delta=6*radians,smallRadius=cr>0,notHemisphere=abs$1(cr)>epsilon$3;function visible(lambda,phi){return cos$1(lambda)*cos$1(phi)>cr}function intersect(a,b,two){var n1=[1,0,0],n2=cartesianCross(cartesian(a),cartesian(b)),n2n2=cartesianDot(n2,n2),n1n2=n2[0],determinant=n2n2-n1n2*n1n2;if(!determinant)return!two&&a;var c1=cr*n2n2/determinant,c2=-cr*n1n2/determinant,n1xn2=cartesianCross(n1,n2),A=cartesianScale(n1,c1);cartesianAddInPlace(A,cartesianScale(n2,c2));var u=n1xn2,w=cartesianDot(A,u),uu=cartesianDot(u,u),t2=w*w-uu*(cartesianDot(A,A)-1);if(!(t2<0)){var t=sqrt$1(t2),q=cartesianScale(u,(-w-t)/uu);if(cartesianAddInPlace(q,A),q=spherical(q),!two)return q;var z,lambda0=a[0],lambda1=b[0],phi0=a[1],phi1=b[1];lambda1<lambda0&&(z=lambda0,lambda0=lambda1,lambda1=z);var delta=lambda1-lambda0,polar=abs$1(delta-pi$3)<epsilon$3;if(!polar&&phi1<phi0&&(z=phi0,phi0=phi1,phi1=z),polar||delta<epsilon$3?polar?phi0+phi1>0^q[1]<(abs$1(q[0]-lambda0)<epsilon$3?phi0:phi1):phi0<=q[1]&&q[1]<=phi1:delta>pi$3^(lambda0<=q[0]&&q[0]<=lambda1)){var q1=cartesianScale(u,(-w+t)/uu);return cartesianAddInPlace(q1,A),[q,spherical(q1)]}}}function code(lambda,phi){var r=smallRadius?radius:pi$3-radius,code=0;return lambda<-r?code|=1:lambda>r&&(code|=2),phi<-r?code|=4:phi>r&&(code|=8),code}return clip(visible,function(stream){var point0,c0,v0,v00,clean;return{lineStart:function(){v00=v0=!1,clean=1},point:function(lambda,phi){var point2,point1=[lambda,phi],v=visible(lambda,phi),c=smallRadius?v?0:code(lambda,phi):v?code(lambda+(lambda<0?pi$3:-pi$3),phi):0;if(!point0&&(v00=v0=v)&&stream.lineStart(),v!==v0&&(!(point2=intersect(point0,point1))||pointEqual(point0,point2)||pointEqual(point1,point2))&&(point1[0]+=epsilon$3,point1[1]+=epsilon$3,v=visible(point1[0],point1[1])),v!==v0)clean=0,v?(stream.lineStart(),point2=intersect(point1,point0),stream.point(point2[0],point2[1])):(point2=intersect(point0,point1),stream.point(point2[0],point2[1]),stream.lineEnd()),point0=point2;else if(notHemisphere&&point0&&smallRadius^v){var t;c&c0||!(t=intersect(point1,point0,!0))||(clean=0,smallRadius?(stream.lineStart(),stream.point(t[0][0],t[0][1]),stream.point(t[1][0],t[1][1]),stream.lineEnd()):(stream.point(t[1][0],t[1][1]),stream.lineEnd(),stream.lineStart(),stream.point(t[0][0],t[0][1])))}!v||point0&&pointEqual(point0,point1)||stream.point(point1[0],point1[1]),point0=point1,v0=v,c0=c},lineEnd:function(){v0&&stream.lineEnd(),point0=null},clean:function(){return clean|(v00&&v0)<<1}}},function(from,to,direction,stream){circleStream(stream,radius,delta,direction,from,to)},smallRadius?[0,-radius]:[-pi$3,radius-pi$3])}var clipMax=1e9,clipMin=-clipMax;function clipRectangle(x0,y0,x1,y1){function visible(x,y){return x0<=x&&x<=x1&&y0<=y&&y<=y1}function interpolate(from,to,direction,stream){var a=0,a1=0;if(null==from||(a=corner(from,direction))!==(a1=corner(to,direction))||comparePoint(from,to)<0^direction>0)do{stream.point(0===a||3===a?x0:x1,a>1?y1:y0)}while((a=(a+direction+4)%4)!==a1);else stream.point(to[0],to[1])}function corner(p,direction){return abs$1(p[0]-x0)<epsilon$3?direction>0?0:3:abs$1(p[0]-x1)<epsilon$3?direction>0?2:1:abs$1(p[1]-y0)<epsilon$3?direction>0?1:0:direction>0?3:2}function compareIntersection(a,b){return comparePoint(a.x,b.x)}function comparePoint(a,b){var ca=corner(a,1),cb=corner(b,1);return ca!==cb?ca-cb:0===ca?b[1]-a[1]:1===ca?a[0]-b[0]:2===ca?a[1]-b[1]:b[0]-a[0]}return function(stream){var segments,polygon,ring,x__,y__,v__,x_,y_,v_,first,clean,activeStream=stream,bufferStream=clipBuffer(),clipStream={point:point,lineStart:function(){clipStream.point=linePoint,polygon&&polygon.push(ring=[]);first=!0,v_=!1,x_=y_=NaN},lineEnd:function(){segments&&(linePoint(x__,y__),v__&&v_&&bufferStream.rejoin(),segments.push(bufferStream.result()));clipStream.point=point,v_&&activeStream.lineEnd()},polygonStart:function(){activeStream=bufferStream,segments=[],polygon=[],clean=!0},polygonEnd:function(){var startInside=function(){for(var winding=0,i=0,n=polygon.length;i<n;++i)for(var a0,a1,ring=polygon[i],j=1,m=ring.length,point=ring[0],b0=point[0],b1=point[1];j<m;++j)a0=b0,a1=b1,point=ring[j],b0=point[0],b1=point[1],a1<=y1?b1>y1&&(b0-a0)*(y1-a1)>(b1-a1)*(x0-a0)&&++winding:b1<=y1&&(b0-a0)*(y1-a1)<(b1-a1)*(x0-a0)&&--winding;return winding}(),cleanInside=clean&&startInside,visible=(segments=merge(segments)).length;(cleanInside||visible)&&(stream.polygonStart(),cleanInside&&(stream.lineStart(),interpolate(null,null,1,stream),stream.lineEnd()),visible&&clipRejoin(segments,compareIntersection,startInside,interpolate,stream),stream.polygonEnd());activeStream=stream,segments=polygon=ring=null}};function point(x,y){visible(x,y)&&activeStream.point(x,y)}function linePoint(x,y){var v=visible(x,y);if(polygon&&ring.push([x,y]),first)x__=x,y__=y,v__=v,first=!1,v&&(activeStream.lineStart(),activeStream.point(x,y));else if(v&&v_)activeStream.point(x,y);else{var a=[x_=Math.max(clipMin,Math.min(clipMax,x_)),y_=Math.max(clipMin,Math.min(clipMax,y_))],b=[x=Math.max(clipMin,Math.min(clipMax,x)),y=Math.max(clipMin,Math.min(clipMax,y))];!function(a,b,x0,y0,x1,y1){var r,ax=a[0],ay=a[1],t0=0,t1=1,dx=b[0]-ax,dy=b[1]-ay;if(r=x0-ax,dx||!(r>0)){if(r/=dx,dx<0){if(r<t0)return;r<t1&&(t1=r)}else if(dx>0){if(r>t1)return;r>t0&&(t0=r)}if(r=x1-ax,dx||!(r<0)){if(r/=dx,dx<0){if(r>t1)return;r>t0&&(t0=r)}else if(dx>0){if(r<t0)return;r<t1&&(t1=r)}if(r=y0-ay,dy||!(r>0)){if(r/=dy,dy<0){if(r<t0)return;r<t1&&(t1=r)}else if(dy>0){if(r>t1)return;r>t0&&(t0=r)}if(r=y1-ay,dy||!(r<0)){if(r/=dy,dy<0){if(r>t1)return;r>t0&&(t0=r)}else if(dy>0){if(r<t0)return;r<t1&&(t1=r)}return t0>0&&(a[0]=ax+t0*dx,a[1]=ay+t0*dy),t1<1&&(b[0]=ax+t1*dx,b[1]=ay+t1*dy),!0}}}}}(a,b,x0,y0,x1,y1)?v&&(activeStream.lineStart(),activeStream.point(x,y),clean=!1):(v_||(activeStream.lineStart(),activeStream.point(a[0],a[1])),activeStream.point(b[0],b[1]),v||activeStream.lineEnd(),clean=!1)}x_=x,y_=y,v_=v}return clipStream}}var lambda0$2,sinPhi0$1,cosPhi0$1,lengthSum=adder(),lengthStream={sphere:noop$2,point:noop$2,lineStart:function(){lengthStream.point=lengthPointFirst,lengthStream.lineEnd=lengthLineEnd},lineEnd:noop$2,polygonStart:noop$2,polygonEnd:noop$2};function lengthLineEnd(){lengthStream.point=lengthStream.lineEnd=noop$2}function lengthPointFirst(lambda,phi){lambda0$2=lambda*=radians,sinPhi0$1=sin$1(phi*=radians),cosPhi0$1=cos$1(phi),lengthStream.point=lengthPoint}function lengthPoint(lambda,phi){lambda*=radians;var sinPhi=sin$1(phi*=radians),cosPhi=cos$1(phi),delta=abs$1(lambda-lambda0$2),cosDelta=cos$1(delta),x=cosPhi*sin$1(delta),y=cosPhi0$1*sinPhi-sinPhi0$1*cosPhi*cosDelta,z=sinPhi0$1*sinPhi+cosPhi0$1*cosPhi*cosDelta;lengthSum.add(atan2$1(sqrt$1(x*x+y*y),z)),lambda0$2=lambda,sinPhi0$1=sinPhi,cosPhi0$1=cosPhi}function length$1(object){return lengthSum.reset(),geoStream(object,lengthStream),+lengthSum}var coordinates=[null,null],object$1={type:"LineString",coordinates:coordinates};function distance(a,b){return coordinates[0]=a,coordinates[1]=b,length$1(object$1)}var containsObjectType={Feature:function(object,point){return containsGeometry(object.geometry,point)},FeatureCollection:function(object,point){for(var features=object.features,i=-1,n=features.length;++i<n;)if(containsGeometry(features[i].geometry,point))return!0;return!1}},containsGeometryType={Sphere:function(){return!0},Point:function(object,point){return containsPoint(object.coordinates,point)},MultiPoint:function(object,point){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)if(containsPoint(coordinates[i],point))return!0;return!1},LineString:function(object,point){return containsLine(object.coordinates,point)},MultiLineString:function(object,point){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)if(containsLine(coordinates[i],point))return!0;return!1},Polygon:function(object,point){return containsPolygon(object.coordinates,point)},MultiPolygon:function(object,point){for(var coordinates=object.coordinates,i=-1,n=coordinates.length;++i<n;)if(containsPolygon(coordinates[i],point))return!0;return!1},GeometryCollection:function(object,point){for(var geometries=object.geometries,i=-1,n=geometries.length;++i<n;)if(containsGeometry(geometries[i],point))return!0;return!1}};function containsGeometry(geometry,point){return!(!geometry||!containsGeometryType.hasOwnProperty(geometry.type))&&containsGeometryType[geometry.type](geometry,point)}function containsPoint(coordinates,point){return 0===distance(coordinates,point)}function containsLine(coordinates,point){var ab=distance(coordinates[0],coordinates[1]);return distance(coordinates[0],point)+distance(point,coordinates[1])<=ab+epsilon$3}function containsPolygon(coordinates,point){return!!polygonContains(coordinates.map(ringRadians),pointRadians(point))}function ringRadians(ring){return(ring=ring.map(pointRadians)).pop(),ring}function pointRadians(point){return[point[0]*radians,point[1]*radians]}function graticuleX(y0,y1,dy){var y=sequence(y0,y1-epsilon$3,dy).concat(y1);return function(x){return y.map(function(y){return[x,y]})}}function graticuleY(x0,x1,dx){var x=sequence(x0,x1-epsilon$3,dx).concat(x1);return function(y){return x.map(function(x){return[x,y]})}}function graticule(){var x1,x0,X1,X0,y1,y0,Y1,Y0,x,y,X,Y,dx=10,dy=dx,DX=90,DY=360,precision=2.5;function graticule(){return{type:"MultiLineString",coordinates:lines()}}function lines(){return sequence(ceil(X0/DX)*DX,X1,DX).map(X).concat(sequence(ceil(Y0/DY)*DY,Y1,DY).map(Y)).concat(sequence(ceil(x0/dx)*dx,x1,dx).filter(function(x){return abs$1(x%DX)>epsilon$3}).map(x)).concat(sequence(ceil(y0/dy)*dy,y1,dy).filter(function(y){return abs$1(y%DY)>epsilon$3}).map(y))}return graticule.lines=function(){return lines().map(function(coordinates){return{type:"LineString",coordinates:coordinates}})},graticule.outline=function(){return{type:"Polygon",coordinates:[X(X0).concat(Y(Y1).slice(1),X(X1).reverse().slice(1),Y(Y0).reverse().slice(1))]}},graticule.extent=function(_){return arguments.length?graticule.extentMajor(_).extentMinor(_):graticule.extentMinor()},graticule.extentMajor=function(_){return arguments.length?(X0=+_[0][0],X1=+_[1][0],Y0=+_[0][1],Y1=+_[1][1],X0>X1&&(_=X0,X0=X1,X1=_),Y0>Y1&&(_=Y0,Y0=Y1,Y1=_),graticule.precision(precision)):[[X0,Y0],[X1,Y1]]},graticule.extentMinor=function(_){return arguments.length?(x0=+_[0][0],x1=+_[1][0],y0=+_[0][1],y1=+_[1][1],x0>x1&&(_=x0,x0=x1,x1=_),y0>y1&&(_=y0,y0=y1,y1=_),graticule.precision(precision)):[[x0,y0],[x1,y1]]},graticule.step=function(_){return arguments.length?graticule.stepMajor(_).stepMinor(_):graticule.stepMinor()},graticule.stepMajor=function(_){return arguments.length?(DX=+_[0],DY=+_[1],graticule):[DX,DY]},graticule.stepMinor=function(_){return arguments.length?(dx=+_[0],dy=+_[1],graticule):[dx,dy]},graticule.precision=function(_){return arguments.length?(precision=+_,x=graticuleX(y0,y1,90),y=graticuleY(x0,x1,precision),X=graticuleX(Y0,Y1,90),Y=graticuleY(X0,X1,precision),graticule):precision},graticule.extentMajor([[-180,-90+epsilon$3],[180,90-epsilon$3]]).extentMinor([[-180,-80-epsilon$3],[180,80+epsilon$3]])}function identity$5(x){return x}var x00,y00,x0$1,y0$1,areaSum$1=adder(),areaRingSum$1=adder(),areaStream$1={point:noop$2,lineStart:noop$2,lineEnd:noop$2,polygonStart:function(){areaStream$1.lineStart=areaRingStart$1,areaStream$1.lineEnd=areaRingEnd$1},polygonEnd:function(){areaStream$1.lineStart=areaStream$1.lineEnd=areaStream$1.point=noop$2,areaSum$1.add(abs$1(areaRingSum$1)),areaRingSum$1.reset()},result:function(){var area=areaSum$1/2;return areaSum$1.reset(),area}};function areaRingStart$1(){areaStream$1.point=areaPointFirst$1}function areaPointFirst$1(x,y){areaStream$1.point=areaPoint$1,x00=x0$1=x,y00=y0$1=y}function areaPoint$1(x,y){areaRingSum$1.add(y0$1*x-x0$1*y),x0$1=x,y0$1=y}function areaRingEnd$1(){areaPoint$1(x00,y00)}var x0$2=1/0,y0$2=x0$2,x1=-x0$2,y1=x1,boundsStream$1={point:function(x,y){x<x0$2&&(x0$2=x);x>x1&&(x1=x);y<y0$2&&(y0$2=y);y>y1&&(y1=y)},lineStart:noop$2,lineEnd:noop$2,polygonStart:noop$2,polygonEnd:noop$2,result:function(){var bounds=[[x0$2,y0$2],[x1,y1]];return x1=y1=-(y0$2=x0$2=1/0),bounds}};var x00$1,y00$1,x0$3,y0$3,X0$1=0,Y0$1=0,Z0$1=0,X1$1=0,Y1$1=0,Z1$1=0,X2$1=0,Y2$1=0,Z2$1=0,centroidStream$1={point:centroidPoint$1,lineStart:centroidLineStart$1,lineEnd:centroidLineEnd$1,polygonStart:function(){centroidStream$1.lineStart=centroidRingStart$1,centroidStream$1.lineEnd=centroidRingEnd$1},polygonEnd:function(){centroidStream$1.point=centroidPoint$1,centroidStream$1.lineStart=centroidLineStart$1,centroidStream$1.lineEnd=centroidLineEnd$1},result:function(){var centroid=Z2$1?[X2$1/Z2$1,Y2$1/Z2$1]:Z1$1?[X1$1/Z1$1,Y1$1/Z1$1]:Z0$1?[X0$1/Z0$1,Y0$1/Z0$1]:[NaN,NaN];return X0$1=Y0$1=Z0$1=X1$1=Y1$1=Z1$1=X2$1=Y2$1=Z2$1=0,centroid}};function centroidPoint$1(x,y){X0$1+=x,Y0$1+=y,++Z0$1}function centroidLineStart$1(){centroidStream$1.point=centroidPointFirstLine}function centroidPointFirstLine(x,y){centroidStream$1.point=centroidPointLine,centroidPoint$1(x0$3=x,y0$3=y)}function centroidPointLine(x,y){var dx=x-x0$3,dy=y-y0$3,z=sqrt$1(dx*dx+dy*dy);X1$1+=z*(x0$3+x)/2,Y1$1+=z*(y0$3+y)/2,Z1$1+=z,centroidPoint$1(x0$3=x,y0$3=y)}function centroidLineEnd$1(){centroidStream$1.point=centroidPoint$1}function centroidRingStart$1(){centroidStream$1.point=centroidPointFirstRing}function centroidRingEnd$1(){centroidPointRing(x00$1,y00$1)}function centroidPointFirstRing(x,y){centroidStream$1.point=centroidPointRing,centroidPoint$1(x00$1=x0$3=x,y00$1=y0$3=y)}function centroidPointRing(x,y){var dx=x-x0$3,dy=y-y0$3,z=sqrt$1(dx*dx+dy*dy);X1$1+=z*(x0$3+x)/2,Y1$1+=z*(y0$3+y)/2,Z1$1+=z,X2$1+=(z=y0$3*x-x0$3*y)*(x0$3+x),Y2$1+=z*(y0$3+y),Z2$1+=3*z,centroidPoint$1(x0$3=x,y0$3=y)}function PathContext(context){this._context=context}PathContext.prototype={_radius:4.5,pointRadius:function(_){return this._radius=_,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(x,y){switch(this._point){case 0:this._context.moveTo(x,y),this._point=1;break;case 1:this._context.lineTo(x,y);break;default:this._context.moveTo(x+this._radius,y),this._context.arc(x,y,this._radius,0,tau$3)}},result:noop$2};var lengthRing,x00$2,y00$2,x0$4,y0$4,lengthSum$1=adder(),lengthStream$1={point:noop$2,lineStart:function(){lengthStream$1.point=lengthPointFirst$1},lineEnd:function(){lengthRing&&lengthPoint$1(x00$2,y00$2),lengthStream$1.point=noop$2},polygonStart:function(){lengthRing=!0},polygonEnd:function(){lengthRing=null},result:function(){var length=+lengthSum$1;return lengthSum$1.reset(),length}};function lengthPointFirst$1(x,y){lengthStream$1.point=lengthPoint$1,x00$2=x0$4=x,y00$2=y0$4=y}function lengthPoint$1(x,y){x0$4-=x,y0$4-=y,lengthSum$1.add(sqrt$1(x0$4*x0$4+y0$4*y0$4)),x0$4=x,y0$4=y}function PathString(){this._string=[]}function circle(radius){return"m0,"+radius+"a"+radius+","+radius+" 0 1,1 0,"+-2*radius+"a"+radius+","+radius+" 0 1,1 0,"+2*radius+"z"}function transformer(methods){return function(stream){var s=new TransformStream;for(var key in methods)s[key]=methods[key];return s.stream=stream,s}}function TransformStream(){}function fit(projection,fitBounds,object){var clip=projection.clipExtent&&projection.clipExtent();return projection.scale(150).translate([0,0]),null!=clip&&projection.clipExtent(null),geoStream(object,projection.stream(boundsStream$1)),fitBounds(boundsStream$1.result()),null!=clip&&projection.clipExtent(clip),projection}function fitExtent(projection,extent,object){return fit(projection,function(b){var w=extent[1][0]-extent[0][0],h=extent[1][1]-extent[0][1],k=Math.min(w/(b[1][0]-b[0][0]),h/(b[1][1]-b[0][1])),x=+extent[0][0]+(w-k*(b[1][0]+b[0][0]))/2,y=+extent[0][1]+(h-k*(b[1][1]+b[0][1]))/2;projection.scale(150*k).translate([x,y])},object)}function fitSize(projection,size,object){return fitExtent(projection,[[0,0],size],object)}function fitWidth(projection,width,object){return fit(projection,function(b){var w=+width,k=w/(b[1][0]-b[0][0]),x=(w-k*(b[1][0]+b[0][0]))/2,y=-k*b[0][1];projection.scale(150*k).translate([x,y])},object)}function fitHeight(projection,height,object){return fit(projection,function(b){var h=+height,k=h/(b[1][1]-b[0][1]),x=-k*b[0][0],y=(h-k*(b[1][1]+b[0][1]))/2;projection.scale(150*k).translate([x,y])},object)}PathString.prototype={_radius:4.5,_circle:circle(4.5),pointRadius:function(_){return(_=+_)!==this._radius&&(this._radius=_,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(x,y){switch(this._point){case 0:this._string.push("M",x,",",y),this._point=1;break;case 1:this._string.push("L",x,",",y);break;default:null==this._circle&&(this._circle=circle(this._radius)),this._string.push("M",x,",",y,this._circle)}},result:function(){if(this._string.length){var result=this._string.join("");return this._string=[],result}return null}},TransformStream.prototype={constructor:TransformStream,point:function(x,y){this.stream.point(x,y)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var maxDepth=16,cosMinDistance=cos$1(30*radians);function resample(project,delta2){return+delta2?function(project,delta2){function resampleLineTo(x0,y0,lambda0,a0,b0,c0,x1,y1,lambda1,a1,b1,c1,depth,stream){var dx=x1-x0,dy=y1-y0,d2=dx*dx+dy*dy;if(d2>4*delta2&&depth--){var a=a0+a1,b=b0+b1,c=c0+c1,m=sqrt$1(a*a+b*b+c*c),phi2=asin$1(c/=m),lambda2=abs$1(abs$1(c)-1)<epsilon$3||abs$1(lambda0-lambda1)<epsilon$3?(lambda0+lambda1)/2:atan2$1(b,a),p=project(lambda2,phi2),x2=p[0],y2=p[1],dx2=x2-x0,dy2=y2-y0,dz=dy*dx2-dx*dy2;(dz*dz/d2>delta2||abs$1((dx*dx2+dy*dy2)/d2-.5)>.3||a0*a1+b0*b1+c0*c1<cosMinDistance)&&(resampleLineTo(x0,y0,lambda0,a0,b0,c0,x2,y2,lambda2,a/=m,b/=m,c,depth,stream),stream.point(x2,y2),resampleLineTo(x2,y2,lambda2,a,b,c,x1,y1,lambda1,a1,b1,c1,depth,stream))}}return function(stream){var lambda00,x00,y00,a00,b00,c00,lambda0,x0,y0,a0,b0,c0,resampleStream={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){stream.polygonStart(),resampleStream.lineStart=ringStart},polygonEnd:function(){stream.polygonEnd(),resampleStream.lineStart=lineStart}};function point(x,y){x=project(x,y),stream.point(x[0],x[1])}function lineStart(){x0=NaN,resampleStream.point=linePoint,stream.lineStart()}function linePoint(lambda,phi){var c=cartesian([lambda,phi]),p=project(lambda,phi);resampleLineTo(x0,y0,lambda0,a0,b0,c0,x0=p[0],y0=p[1],lambda0=lambda,a0=c[0],b0=c[1],c0=c[2],maxDepth,stream),stream.point(x0,y0)}function lineEnd(){resampleStream.point=point,stream.lineEnd()}function ringStart(){lineStart(),resampleStream.point=ringPoint,resampleStream.lineEnd=ringEnd}function ringPoint(lambda,phi){linePoint(lambda00=lambda,phi),x00=x0,y00=y0,a00=a0,b00=b0,c00=c0,resampleStream.point=linePoint}function ringEnd(){resampleLineTo(x0,y0,lambda0,a0,b0,c0,x00,y00,lambda00,a00,b00,c00,maxDepth,stream),resampleStream.lineEnd=lineEnd,lineEnd()}return resampleStream}}(project,delta2):function(project){return transformer({point:function(x,y){x=project(x,y),this.stream.point(x[0],x[1])}})}(project)}var transformRadians=transformer({point:function(x,y){this.stream.point(x*radians,y*radians)}});function scaleTranslateRotate(k,dx,dy,alpha){var cosAlpha=cos$1(alpha),sinAlpha=sin$1(alpha),a=cosAlpha*k,b=sinAlpha*k,ai=cosAlpha/k,bi=sinAlpha/k,ci=(sinAlpha*dy-cosAlpha*dx)/k,fi=(sinAlpha*dx+cosAlpha*dy)/k;function transform(x,y){return[a*x-b*y+dx,dy-b*x-a*y]}return transform.invert=function(x,y){return[ai*x-bi*y+ci,fi-bi*x-ai*y]},transform}function projection(project){return projectionMutator(function(){return project})()}function projectionMutator(projectAt){var project,rotate,y0,x1,y1,projectResample,projectTransform,projectRotateTransform,cache,cacheStream,k=150,x=480,y=250,lambda=0,phi=0,deltaLambda=0,deltaPhi=0,deltaGamma=0,alpha=0,theta=null,preclip=clipAntimeridian,x0=null,postclip=identity$5,delta2=.5;function projection(point){return projectRotateTransform(point[0]*radians,point[1]*radians)}function invert(point){return(point=projectRotateTransform.invert(point[0],point[1]))&&[point[0]*degrees$1,point[1]*degrees$1]}function recenter(){var center=scaleTranslateRotate(k,0,0,alpha).apply(null,project(lambda,phi)),transform=(alpha?scaleTranslateRotate:function(k,dx,dy){function transform(x,y){return[dx+k*x,dy-k*y]}return transform.invert=function(x,y){return[(x-dx)/k,(dy-y)/k]},transform})(k,x-center[0],y-center[1],alpha);return rotate=rotateRadians(deltaLambda,deltaPhi,deltaGamma),projectTransform=compose(project,transform),projectRotateTransform=compose(rotate,projectTransform),projectResample=resample(projectTransform,delta2),reset()}function reset(){return cache=cacheStream=null,projection}return projection.stream=function(stream){return cache&&cacheStream===stream?cache:cache=transformRadians(function(rotate){return transformer({point:function(x,y){var r=rotate(x,y);return this.stream.point(r[0],r[1])}})}(rotate)(preclip(projectResample(postclip(cacheStream=stream)))))},projection.preclip=function(_){return arguments.length?(preclip=_,theta=void 0,reset()):preclip},projection.postclip=function(_){return arguments.length?(postclip=_,x0=y0=x1=y1=null,reset()):postclip},projection.clipAngle=function(_){return arguments.length?(preclip=+_?clipCircle(theta=_*radians):(theta=null,clipAntimeridian),reset()):theta*degrees$1},projection.clipExtent=function(_){return arguments.length?(postclip=null==_?(x0=y0=x1=y1=null,identity$5):clipRectangle(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]),reset()):null==x0?null:[[x0,y0],[x1,y1]]},projection.scale=function(_){return arguments.length?(k=+_,recenter()):k},projection.translate=function(_){return arguments.length?(x=+_[0],y=+_[1],recenter()):[x,y]},projection.center=function(_){return arguments.length?(lambda=_[0]%360*radians,phi=_[1]%360*radians,recenter()):[lambda*degrees$1,phi*degrees$1]},projection.rotate=function(_){return arguments.length?(deltaLambda=_[0]%360*radians,deltaPhi=_[1]%360*radians,deltaGamma=_.length>2?_[2]%360*radians:0,recenter()):[deltaLambda*degrees$1,deltaPhi*degrees$1,deltaGamma*degrees$1]},projection.angle=function(_){return arguments.length?(alpha=_%360*radians,recenter()):alpha*degrees$1},projection.precision=function(_){return arguments.length?(projectResample=resample(projectTransform,delta2=_*_),reset()):sqrt$1(delta2)},projection.fitExtent=function(extent,object){return fitExtent(projection,extent,object)},projection.fitSize=function(size,object){return fitSize(projection,size,object)},projection.fitWidth=function(width,object){return fitWidth(projection,width,object)},projection.fitHeight=function(height,object){return fitHeight(projection,height,object)},function(){return project=projectAt.apply(this,arguments),projection.invert=project.invert&&invert,recenter()}}function conicProjection(projectAt){var phi0=0,phi1=pi$3/3,m=projectionMutator(projectAt),p=m(phi0,phi1);return p.parallels=function(_){return arguments.length?m(phi0=_[0]*radians,phi1=_[1]*radians):[phi0*degrees$1,phi1*degrees$1]},p}function conicEqualAreaRaw(y0,y1){var sy0=sin$1(y0),n=(sy0+sin$1(y1))/2;if(abs$1(n)<epsilon$3)return function(phi0){var cosPhi0=cos$1(phi0);function forward(lambda,phi){return[lambda*cosPhi0,sin$1(phi)/cosPhi0]}return forward.invert=function(x,y){return[x/cosPhi0,asin$1(y*cosPhi0)]},forward}(y0);var c=1+sy0*(2*n-sy0),r0=sqrt$1(c)/n;function project(x,y){var r=sqrt$1(c-2*n*sin$1(y))/n;return[r*sin$1(x*=n),r0-r*cos$1(x)]}return project.invert=function(x,y){var r0y=r0-y;return[atan2$1(x,abs$1(r0y))/n*sign$1(r0y),asin$1((c-(x*x+r0y*r0y)*n*n)/(2*n))]},project}function conicEqualArea(){return conicProjection(conicEqualAreaRaw).scale(155.424).center([0,33.6442])}function albers(){return conicEqualArea().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function azimuthalRaw(scale){return function(x,y){var cx=cos$1(x),cy=cos$1(y),k=scale(cx*cy);return[k*cy*sin$1(x),k*sin$1(y)]}}function azimuthalInvert(angle){return function(x,y){var z=sqrt$1(x*x+y*y),c=angle(z),sc=sin$1(c),cc=cos$1(c);return[atan2$1(x*sc,z*cc),asin$1(z&&y*sc/z)]}}var azimuthalEqualAreaRaw=azimuthalRaw(function(cxcy){return sqrt$1(2/(1+cxcy))});azimuthalEqualAreaRaw.invert=azimuthalInvert(function(z){return 2*asin$1(z/2)});var azimuthalEquidistantRaw=azimuthalRaw(function(c){return(c=acos$1(c))&&c/sin$1(c)});function mercatorRaw(lambda,phi){return[lambda,log(tan((halfPi$2+phi)/2))]}function mercatorProjection(project){var y0,x1,y1,m=projection(project),center=m.center,scale=m.scale,translate=m.translate,clipExtent=m.clipExtent,x0=null;function reclip(){var k=pi$3*scale(),t=m(rotation(m.rotate()).invert([0,0]));return clipExtent(null==x0?[[t[0]-k,t[1]-k],[t[0]+k,t[1]+k]]:project===mercatorRaw?[[Math.max(t[0]-k,x0),y0],[Math.min(t[0]+k,x1),y1]]:[[x0,Math.max(t[1]-k,y0)],[x1,Math.min(t[1]+k,y1)]])}return m.scale=function(_){return arguments.length?(scale(_),reclip()):scale()},m.translate=function(_){return arguments.length?(translate(_),reclip()):translate()},m.center=function(_){return arguments.length?(center(_),reclip()):center()},m.clipExtent=function(_){return arguments.length?(null==_?x0=y0=x1=y1=null:(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]),reclip()):null==x0?null:[[x0,y0],[x1,y1]]},reclip()}function tany(y){return tan((halfPi$2+y)/2)}function conicConformalRaw(y0,y1){var cy0=cos$1(y0),n=y0===y1?sin$1(y0):log(cy0/cos$1(y1))/log(tany(y1)/tany(y0)),f=cy0*pow(tany(y0),n)/n;if(!n)return mercatorRaw;function project(x,y){f>0?y<-halfPi$2+epsilon$3&&(y=-halfPi$2+epsilon$3):y>halfPi$2-epsilon$3&&(y=halfPi$2-epsilon$3);var r=f/pow(tany(y),n);return[r*sin$1(n*x),f-r*cos$1(n*x)]}return project.invert=function(x,y){var fy=f-y,r=sign$1(n)*sqrt$1(x*x+fy*fy);return[atan2$1(x,abs$1(fy))/n*sign$1(fy),2*atan(pow(f/r,1/n))-halfPi$2]},project}function equirectangularRaw(lambda,phi){return[lambda,phi]}function conicEquidistantRaw(y0,y1){var cy0=cos$1(y0),n=y0===y1?sin$1(y0):(cy0-cos$1(y1))/(y1-y0),g=cy0/n+y0;if(abs$1(n)<epsilon$3)return equirectangularRaw;function project(x,y){var gy=g-y,nx=n*x;return[gy*sin$1(nx),g-gy*cos$1(nx)]}return project.invert=function(x,y){var gy=g-y;return[atan2$1(x,abs$1(gy))/n*sign$1(gy),g-sign$1(n)*sqrt$1(x*x+gy*gy)]},project}azimuthalEquidistantRaw.invert=azimuthalInvert(function(z){return z}),mercatorRaw.invert=function(x,y){return[x,2*atan(exp(y))-halfPi$2]},equirectangularRaw.invert=equirectangularRaw;var A1=1.340264,A2=-.081106,A3=893e-6,A4=.003796,M=sqrt$1(3)/2;function equalEarthRaw(lambda,phi){var l=asin$1(M*sin$1(phi)),l2=l*l,l6=l2*l2*l2;return[lambda*cos$1(l)/(M*(A1+3*A2*l2+l6*(7*A3+9*A4*l2))),l*(A1+A2*l2+l6*(A3+A4*l2))]}function gnomonicRaw(x,y){var cy=cos$1(y),k=cos$1(x)*cy;return[cy*sin$1(x)/k,sin$1(y)/k]}function scaleTranslate$1(kx,ky,tx,ty){return 1===kx&&1===ky&&0===tx&&0===ty?identity$5:transformer({point:function(x,y){this.stream.point(x*kx+tx,y*ky+ty)}})}function naturalEarth1Raw(lambda,phi){var phi2=phi*phi,phi4=phi2*phi2;return[lambda*(.8707-.131979*phi2+phi4*(phi4*(.003971*phi2-.001529*phi4)-.013791)),phi*(1.007226+phi2*(.015085+phi4*(.028874*phi2-.044475-.005916*phi4)))]}function orthographicRaw(x,y){return[cos$1(y)*sin$1(x),sin$1(y)]}function stereographicRaw(x,y){var cy=cos$1(y),k=1+cos$1(x)*cy;return[cy*sin$1(x)/k,sin$1(y)/k]}function transverseMercatorRaw(lambda,phi){return[log(tan((halfPi$2+phi)/2)),-lambda]}equalEarthRaw.invert=function(x,y){for(var delta,l=y,l2=l*l,l6=l2*l2*l2,i=0;i<12&&(l6=(l2=(l-=delta=(l*(A1+A2*l2+l6*(A3+A4*l2))-y)/(A1+3*A2*l2+l6*(7*A3+9*A4*l2)))*l)*l2*l2,!(abs$1(delta)<epsilon2$1));++i);return[M*x*(A1+3*A2*l2+l6*(7*A3+9*A4*l2))/cos$1(l),asin$1(sin$1(l)/M)]},gnomonicRaw.invert=azimuthalInvert(atan),naturalEarth1Raw.invert=function(x,y){var delta,phi=y,i=25;do{var phi2=phi*phi,phi4=phi2*phi2;phi-=delta=(phi*(1.007226+phi2*(.015085+phi4*(.028874*phi2-.044475-.005916*phi4)))-y)/(1.007226+phi2*(.045255+phi4*(.259866*phi2-.311325-.005916*11*phi4)))}while(abs$1(delta)>epsilon$3&&--i>0);return[x/(.8707+(phi2=phi*phi)*(phi2*(phi2*phi2*phi2*(.003971-.001529*phi2)-.013791)-.131979)),phi]},orthographicRaw.invert=azimuthalInvert(asin$1),stereographicRaw.invert=azimuthalInvert(function(z){return 2*atan(z)}),transverseMercatorRaw.invert=function(x,y){return[-y,2*atan(exp(x))-halfPi$2]};var abs$2=Math.abs,atan$1=Math.atan,atan2$2=Math.atan2,cos$2=Math.cos,exp$1=Math.exp,floor=Math.floor,log$1=Math.log,max$2=Math.max,min$2=Math.min,sin$2=Math.sin,tan$1=Math.tan,epsilon$4=1e-6,pi$4=Math.PI,halfPi$3=pi$4/2,quarterPi$1=pi$4/4,sqrt2=(Math.SQRT1_2,sqrt$2(2)),tau$4=2*pi$4,degrees$2=180/pi$4,radians$1=pi$4/180;function asin$2(x){return x>1?halfPi$3:x<-1?-halfPi$3:Math.asin(x)}function acos$2(x){return x>1?0:x<-1?pi$4:Math.acos(x)}function sqrt$2(x){return x>0?Math.sqrt(x):0}function airyRaw(beta){var tanBeta_2=tan$1(beta/2),b=2*log$1(cos$2(beta/2))/(tanBeta_2*tanBeta_2);function forward(x,y){var cosx=cos$2(x),cosy=cos$2(y),siny=sin$2(y),cosz=cosy*cosx,k=-((1-cosz?log$1((1+cosz)/2)/(1-cosz):-.5)+b/(1+cosz));return[k*cosy*sin$2(x),k*siny]}return forward.invert=function(x,y){var delta,r=sqrt$2(x*x+y*y),z=-beta/2,i=50;if(!r)return[0,0];do{var z_2=z/2,cosz_2=cos$2(z_2),sinz_2=sin$2(z_2),tanz_2=tan$1(z_2),lnsecz_2=log$1(1/cosz_2);z-=delta=(2/tanz_2*lnsecz_2-b*tanz_2-r)/(-lnsecz_2/(sinz_2*sinz_2)+1-b/(2*cosz_2*cosz_2))}while(abs$2(delta)>epsilon$4&&--i>0);var sinz=sin$2(z);return[atan2$2(x*sinz,r*cos$2(z)),asin$2(y*sinz/r)]},forward}function aitoffRaw(x,y){var cosy=cos$2(y),sincia=function(x){return x?x/Math.sin(x):1}(acos$2(cosy*cos$2(x/=2)));return[2*cosy*sin$2(x)*sincia,sin$2(y)*sincia]}function armadilloRaw(phi0){var sinPhi0=sin$2(phi0),cosPhi0=cos$2(phi0),sPhi0=phi0>=0?1:-1,tanPhi0=tan$1(sPhi0*phi0),k=(1+sinPhi0-cosPhi0)/2;function forward(lambda,phi){var cosPhi=cos$2(phi),cosLambda=cos$2(lambda/=2);return[(1+cosPhi)*sin$2(lambda),(sPhi0*phi>-atan2$2(cosLambda,tanPhi0)-.001?0:10*-sPhi0)+k+sin$2(phi)*cosPhi0-(1+cosPhi)*sinPhi0*cosLambda]}return forward.invert=function(x,y){var lambda=0,phi=0,i=50;do{var cosLambda=cos$2(lambda),sinLambda=sin$2(lambda),cosPhi=cos$2(phi),sinPhi=sin$2(phi),A=1+cosPhi,fx=A*sinLambda-x,fy=k+sinPhi*cosPhi0-A*sinPhi0*cosLambda-y,dxdLambda=A*cosLambda/2,dxdPhi=-sinLambda*sinPhi,dydLambda=sinPhi0*A*sinLambda/2,dydPhi=cosPhi0*cosPhi+sinPhi0*cosLambda*sinPhi,denominator=dxdPhi*dydLambda-dydPhi*dxdLambda,dLambda=(fy*dxdPhi-fx*dydPhi)/denominator/2,dPhi=(fx*dydLambda-fy*dxdLambda)/denominator;lambda-=dLambda,phi-=dPhi}while((abs$2(dLambda)>epsilon$4||abs$2(dPhi)>epsilon$4)&&--i>0);return sPhi0*phi>-atan2$2(cos$2(lambda),tanPhi0)-.001?[2*lambda,phi]:null},forward}function hammerRaw(A,B){if(arguments.length<2&&(B=A),1===B)return azimuthalEqualAreaRaw;if(B===1/0)return hammerQuarticAuthalicRaw;function forward(lambda,phi){var coordinates=azimuthalEqualAreaRaw(lambda/B,phi);return coordinates[0]*=A,coordinates}return forward.invert=function(x,y){var coordinates=azimuthalEqualAreaRaw.invert(x/A,y);return coordinates[0]*=B,coordinates},forward}function hammerQuarticAuthalicRaw(lambda,phi){return[lambda*cos$2(phi)/cos$2(phi/=2),2*sin$2(phi)]}function mollweideBromleyRaw(cx,cy,cp){function forward(lambda,phi){return[cx*lambda*cos$2(phi=function(cp,phi){var delta,cpsinPhi=cp*sin$2(phi),i=30;do{phi-=delta=(phi+sin$2(phi)-cpsinPhi)/(1+cos$2(phi))}while(abs$2(delta)>epsilon$4&&--i>0);return phi/2}(cp,phi)),cy*sin$2(phi)]}return forward.invert=function(x,y){return y=asin$2(y/cy),[x/(cx*cos$2(y)),asin$2((2*y+sin$2(2*y))/cp)]},forward}aitoffRaw.invert=function(x,y){if(!(x*x+4*y*y>pi$4*pi$4+epsilon$4)){var x1=x,y1=y,i=25;do{var f,sinx=sin$2(x1),sinx_2=sin$2(x1/2),cosx_2=cos$2(x1/2),siny=sin$2(y1),cosy=cos$2(y1),sin_2y=sin$2(2*y1),sin2y=siny*siny,cos2y=cosy*cosy,sin2x_2=sinx_2*sinx_2,c=1-cos2y*cosx_2*cosx_2,e=c?acos$2(cosy*cosx_2)*sqrt$2(f=1/c):f=0,fx=2*e*cosy*sinx_2-x,fy=e*siny-y,dxdx=f*(cos2y*sin2x_2+e*cosy*cosx_2*sin2y),dxdy=f*(.5*sinx*sin_2y-2*e*siny*sinx_2),dydx=.25*f*(sin_2y*sinx_2-e*siny*cos2y*sinx),dydy=f*(sin2y*cosx_2+e*sin2x_2*cosy),z=dxdy*dydx-dydy*dxdx;if(!z)break;var dx=(fy*dxdy-fx*dydy)/z,dy=(fx*dydx-fy*dxdx)/z;x1-=dx,y1-=dy}while((abs$2(dx)>epsilon$4||abs$2(dy)>epsilon$4)&&--i>0);return[x1,y1]}},hammerQuarticAuthalicRaw.invert=function(x,y){var phi=2*asin$2(y/2);return[x*cos$2(phi/2)/cos$2(phi),phi]};mollweideBromleyRaw(sqrt2/halfPi$3,sqrt2,pi$4);mollweideBromleyRaw(1,4/pi$4,pi$4);function distance$1(dPhi,c1,s1,c2,s2,dLambda){var r,cosdLambda=cos$2(dLambda);if(abs$2(dPhi)>1||abs$2(dLambda)>1)r=acos$2(s1*s2+c1*c2*cosdLambda);else{var sindPhi=sin$2(dPhi/2),sindLambda=sin$2(dLambda/2);r=2*asin$2(sqrt$2(sindPhi*sindPhi+c1*c2*sindLambda*sindLambda))}return abs$2(r)>epsilon$4?[r,atan2$2(c2*sin$2(dLambda),c1*s2-s1*c2*cosdLambda)]:[0,0]}function angle$1(b,c,a){return acos$2((b*b+c*c-a*a)/(2*b*c))}function longitude(lambda){return lambda-2*pi$4*floor((lambda+pi$4)/(2*pi$4))}function pointRadians$1(p){return p[0]*=radians$1,p[1]*=radians$1,p}function cylindricalStereographicRaw(phi0){var cosPhi0=cos$2(phi0);function forward(lambda,phi){return[lambda*cosPhi0,(1+cosPhi0)*tan$1(phi/2)]}return forward.invert=function(x,y){return[x/cosPhi0,2*atan$1(y/(1+cosPhi0))]},forward}function eckert3Raw(lambda,phi){var k=sqrt$2(pi$4*(4+pi$4));return[2/k*lambda*(1+sqrt$2(1-4*phi*phi/(pi$4*pi$4))),4/k*phi]}function eckert4Raw(lambda,phi){var k=(2+halfPi$3)*sin$2(phi);phi/=2;for(var i=0,delta=1/0;i<10&&abs$2(delta)>epsilon$4;i++){var cosPhi=cos$2(phi);phi-=delta=(phi+sin$2(phi)*(cosPhi+2)-k)/(2*cosPhi*(1+cosPhi))}return[2/sqrt$2(pi$4*(4+pi$4))*lambda*(1+cos$2(phi)),2*sqrt$2(pi$4/(4+pi$4))*sin$2(phi)]}function eckert5Raw(lambda,phi){return[lambda*(1+cos$2(phi))/sqrt$2(2+pi$4),2*phi/sqrt$2(2+pi$4)]}function eckert6Raw(lambda,phi){for(var k=(1+halfPi$3)*sin$2(phi),i=0,delta=1/0;i<10&&abs$2(delta)>epsilon$4;i++)phi-=delta=(phi+sin$2(phi)-k)/(1+cos$2(phi));return k=sqrt$2(2+pi$4),[lambda*(1+cos$2(phi))/k,2*phi/k]}eckert3Raw.invert=function(x,y){var k=sqrt$2(pi$4*(4+pi$4))/2;return[x*k/(1+sqrt$2(1-y*y*(4+pi$4)/(4*pi$4))),y*k/2]},eckert4Raw.invert=function(x,y){var A=y*sqrt$2((4+pi$4)/pi$4)/2,k=asin$2(A),c=cos$2(k);return[x/(2/sqrt$2(pi$4*(4+pi$4))*(1+c)),asin$2((k+A*(c+2))/(2+halfPi$3))]},eckert5Raw.invert=function(x,y){var k=sqrt$2(2+pi$4),phi=y*k/2;return[k*x/(1+cos$2(phi)),phi]},eckert6Raw.invert=function(x,y){var j=1+halfPi$3,k=sqrt$2(j/2);return[2*x*k/(1+cos$2(y*=k)),asin$2((y+sin$2(y))/j)]};var faheyK=cos$2(35*radians$1);function faheyRaw(lambda,phi){var t=tan$1(phi/2);return[lambda*faheyK*sqrt$2(1-t*t),(1+faheyK)*t]}function ginzburgPolyconicRaw(a,b,c,d,e,f,g,h){function forward(lambda,phi){if(!phi)return[a*lambda/pi$4,0];var phi2=phi*phi,xB=a+phi2*(b+phi2*(c+phi2*d)),yB=phi*(e-1+phi2*(f-h+phi2*g)),m=(xB*xB+yB*yB)/(2*yB),alpha=lambda*asin$2(xB/m)/pi$4;return[m*sin$2(alpha),phi*(1+phi2*h)+m*(1-cos$2(alpha))]}return arguments.length<8&&(h=0),forward.invert=function(x,y){var deltaLambda,deltaPhi,lambda=pi$4*x/a,phi=y,i=50;do{var phi2=phi*phi,xB=a+phi2*(b+phi2*(c+phi2*d)),yB=phi*(e-1+phi2*(f-h+phi2*g)),p=xB*xB+yB*yB,q=2*yB,m=p/q,m2=m*m,dAlphadLambda=asin$2(xB/m)/pi$4,alpha=lambda*dAlphadLambda,xB2=xB*xB,dxBdPhi=(2*b+phi2*(4*c+6*phi2*d))*phi,dyBdPhi=e+phi2*(3*f+5*phi2*g),dmdPhi=(2*(xB*dxBdPhi+yB*(dyBdPhi-1))*q-p*(2*(dyBdPhi-1)))/(q*q),cosAlpha=cos$2(alpha),sinAlpha=sin$2(alpha),mcosAlpha=m*cosAlpha,msinAlpha=m*sinAlpha,dAlphadPhi=lambda/pi$4*(1/sqrt$2(1-xB2/m2))*(dxBdPhi*m-xB*dmdPhi)/m2,fx=msinAlpha-x,fy=phi*(1+phi2*h)+m-mcosAlpha-y,deltaxDeltaPhi=dmdPhi*sinAlpha+mcosAlpha*dAlphadPhi,deltaxDeltaLambda=mcosAlpha*dAlphadLambda,deltayDeltaPhi=1+dmdPhi-(dmdPhi*cosAlpha-msinAlpha*dAlphadPhi),deltayDeltaLambda=msinAlpha*dAlphadLambda,denominator=deltaxDeltaPhi*deltayDeltaLambda-deltayDeltaPhi*deltaxDeltaLambda;if(!denominator)break;lambda-=deltaLambda=(fy*deltaxDeltaPhi-fx*deltayDeltaPhi)/denominator,phi-=deltaPhi=(fx*deltayDeltaLambda-fy*deltaxDeltaLambda)/denominator}while((abs$2(deltaLambda)>epsilon$4||abs$2(deltaPhi)>epsilon$4)&&--i>0);return[lambda,phi]},forward}faheyRaw.invert=function(x,y){var t=y/(1+faheyK);return[x&&x/(faheyK*sqrt$2(1-t*t)),2*atan$1(t)]};var ginzburg4Raw=ginzburgPolyconicRaw(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);var ginzburg5Raw=ginzburgPolyconicRaw(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);var ginzburg6Raw=ginzburgPolyconicRaw(5/6*pi$4,-.62636,-.0344,0,1.3493,-.05524,0,.045);function ginzburg8Raw(lambda,phi){var lambda2=lambda*lambda,phi2=phi*phi;return[lambda*(1-.162388*phi2)*(.87-952426e-9*lambda2*lambda2),phi*(1+phi2/12)]}ginzburg8Raw.invert=function(x,y){var delta,lambda=x,phi=y,i=50;do{var phi2=phi*phi;phi-=delta=(phi*(1+phi2/12)-y)/(1+phi2/4)}while(abs$2(delta)>epsilon$4&&--i>0);i=50,x/=1-.162388*phi2;do{var lambda4=(lambda4=lambda*lambda)*lambda4;lambda-=delta=(lambda*(.87-952426e-9*lambda4)-x)/(.87-.00476213*lambda4)}while(abs$2(delta)>epsilon$4&&--i>0);return[lambda,phi]};var ginzburg9Raw=ginzburgPolyconicRaw(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function kavrayskiy7Raw(lambda,phi){return[3/tau$4*lambda*sqrt$2(pi$4*pi$4/3-phi*phi),phi]}function millerRaw(lambda,phi){return[lambda,1.25*log$1(tan$1(quarterPi$1+.4*phi))]}kavrayskiy7Raw.invert=function(x,y){return[tau$4/3*x/sqrt$2(pi$4*pi$4/3-y*y),y]},millerRaw.invert=function(x,y){return[x,2.5*atan$1(exp$1(.8*y))-.625*pi$4]};var octahedron=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]];function noop$3(){}function projectFeatureCollection(o,stream){return{type:"FeatureCollection",features:o.features.map(function(f){return projectFeature(f,stream)})}}function projectFeature(o,stream){return{type:"Feature",id:o.id,properties:o.properties,geometry:projectGeometry(o.geometry,stream)}}function projectGeometry(o,stream){if(!o)return null;if("GeometryCollection"===o.type)return function(o,stream){return{type:"GeometryCollection",geometries:o.geometries.map(function(o){return projectGeometry(o,stream)})}}(o,stream);var sink;switch(o.type){case"Point":case"MultiPoint":sink=sinkPoint;break;case"LineString":case"MultiLineString":sink=sinkLine;break;case"Polygon":case"MultiPolygon":case"Sphere":sink=sinkPolygon;break;default:return null}return geoStream(o,stream(sink)),sink.result()}[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(face){return face.map(function(i){return octahedron[i]})});var points=[],lines=[],sinkPoint={point:function(x,y){points.push([x,y])},result:function(){var result=points.length?points.length<2?{type:"Point",coordinates:points[0]}:{type:"MultiPoint",coordinates:points}:null;return points=[],result}},sinkLine={lineStart:noop$3,point:function(x,y){points.push([x,y])},lineEnd:function(){points.length&&(lines.push(points),points=[])},result:function(){var result=lines.length?lines.length<2?{type:"LineString",coordinates:lines[0]}:{type:"MultiLineString",coordinates:lines}:null;return lines=[],result}},sinkPolygon={polygonStart:noop$3,lineStart:noop$3,point:function(x,y){points.push([x,y])},lineEnd:function(){var n=points.length;if(n){do{points.push(points[0].slice())}while(++n<4);lines.push(points),points=[]}},polygonEnd:noop$3,result:function(){if(!lines.length)return null;var polygons=[],holes=[];return lines.forEach(function(ring){!function(ring){if((n=ring.length)<4)return!1;for(var n,i=0,area=ring[n-1][1]*ring[0][0]-ring[n-1][0]*ring[0][1];++i<n;)area+=ring[i-1][1]*ring[i][0]-ring[i-1][0]*ring[i][1];return area<=0}(ring)?holes.push(ring):polygons.push([ring])}),holes.forEach(function(hole){var point=hole[0];polygons.some(function(polygon){if(function(ring,point){for(var x=point[0],y=point[1],contains=!1,i=0,n=ring.length,j=n-1;i<n;j=i++){var pi=ring[i],xi=pi[0],yi=pi[1],pj=ring[j],xj=pj[0],yj=pj[1];yi>y^yj>y&&x<(xj-xi)*(y-yi)/(yj-yi)+xi&&(contains=!contains)}return contains}(polygon[0],point))return polygon.push(hole),!0})||polygons.push([hole])}),lines=[],polygons.length?polygons.length>1?{type:"MultiPolygon",coordinates:polygons}:{type:"Polygon",coordinates:polygons[0]}:null}};var K=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function robinsonRaw(lambda,phi){var k,i=min$2(18,36*abs$2(phi)/pi$4),i0=floor(i),di=i-i0,ax=(k=K[i0])[0],ay=k[1],bx=(k=K[++i0])[0],by=k[1],cx=(k=K[min$2(19,++i0)])[0],cy=k[1];return[lambda*(bx+di*(cx-ax)/2+di*di*(cx-2*bx+ax)/2),(phi>0?halfPi$3:-halfPi$3)*(by+di*(cy-ay)/2+di*di*(cy-2*by+ay)/2)]}function satelliteRaw(P,omega){var vertical=function(P){function forward(lambda,phi){var cosPhi=cos$2(phi),k=(P-1)/(P-cosPhi*cos$2(lambda));return[k*cosPhi*sin$2(lambda),k*sin$2(phi)]}return forward.invert=function(x,y){var rho2=x*x+y*y,rho=sqrt$2(rho2),sinc=(P-sqrt$2(1-rho2*(P+1)/(P-1)))/((P-1)/rho+rho/(P-1));return[atan2$2(x*sinc,rho*sqrt$2(1-sinc*sinc)),rho?asin$2(y*sinc/rho):0]},forward}(P);if(!omega)return vertical;var cosOmega=cos$2(omega),sinOmega=sin$2(omega);function forward(lambda,phi){var coordinates=vertical(lambda,phi),y=coordinates[1],A=y*sinOmega/(P-1)+cosOmega;return[coordinates[0]*cosOmega/A,y/A]}return forward.invert=function(x,y){var k=(P-1)/(P-1-y*sinOmega);return vertical.invert(k*x,k*y*cosOmega)},forward}K.forEach(function(d){d[1]*=1.0144}),robinsonRaw.invert=function(x,y){var yy=y/halfPi$3,phi=90*yy,i=min$2(18,abs$2(phi/5)),i0=max$2(0,floor(i));do{var ay=K[i0][1],by=K[i0+1][1],cy=K[min$2(19,i0+2)][1],u=cy-ay,v=cy-2*by+ay,t=2*(abs$2(yy)-by)/u,c=v/u,di=t*(1-c*t*(1-2*c*t));if(di>=0||1===i0){phi=(y>=0?5:-5)*(di+i);var delta,j=50;do{di=(i=min$2(18,abs$2(phi)/5))-(i0=floor(i)),ay=K[i0][1],by=K[i0+1][1],cy=K[min$2(19,i0+2)][1],phi-=(delta=(y>=0?halfPi$3:-halfPi$3)*(by+di*(cy-ay)/2+di*di*(cy-2*by+ay)/2)-y)*degrees$2}while(abs$2(delta)>1e-12&&--j>0);break}}while(--i0>=0);var ax=K[i0][0],bx=K[i0+1][0],cx=K[min$2(19,i0+2)][0];return[x/(bx+di*(cx-ax)/2+di*di*(cx-2*bx+ax)/2),phi*radians$1]};var epsilonInverse=1e4,x0$5=-180,x0e=x0$5+1e-4,x1$1=180,x1e=x1$1-1e-4,y0$5=-90,y0e=y0$5+1e-4,y1$1=90,y1e=y1$1-1e-4;function nonempty(coordinates){return coordinates.length>0}function normalizePoint(y){return y===y0$5||y===y1$1?[0,y]:[x0$5,(x=y,Math.floor(x*epsilonInverse)/epsilonInverse)];var x}function clampPoint(p){var x=p[0],y=p[1],clamped=!1;return x<=x0e?(x=x0$5,clamped=!0):x>=x1e&&(x=x1$1,clamped=!0),y<=y0e?(y=y0$5,clamped=!0):y>=y1e&&(y=y1$1,clamped=!0),clamped?[x,y]:p}function clampPoints(points){return points.map(clampPoint)}function extractFragments(rings,polygon,fragments){for(var j=0,m=rings.length;j<m;++j){var ring=rings[j].slice();fragments.push({index:-1,polygon:polygon,ring:ring});for(var i=0,n=ring.length;i<n;++i){var point=ring[i],x=point[0],y=point[1];if(x<=x0e||x>=x1e||y<=y0e||y>=y1e){ring[i]=clampPoint(point);for(var k=i+1;k<n;++k){var pointk=ring[k],xk=pointk[0],yk=pointk[1];if(xk>x0e&&xk<x1e&&yk>y0e&&yk<y1e)break}if(k===i+1)continue;if(i){var fragmentBefore={index:-1,polygon:polygon,ring:ring.slice(0,i+1)};fragmentBefore.ring[fragmentBefore.ring.length-1]=normalizePoint(y),fragments[fragments.length-1]=fragmentBefore}else fragments.pop();if(k>=n)break;fragments.push({index:-1,polygon:polygon,ring:ring=ring.slice(k-1)}),ring[0]=normalizePoint(ring[0][1]),i=-1,n=ring.length}}}}function stitchFragments(fragments){var i,fragment,start,startFragment,end,endFragment,n=fragments.length,fragmentByStart={},fragmentByEnd={};for(i=0;i<n;++i)start=(fragment=fragments[i]).ring[0],end=fragment.ring[fragment.ring.length-1],start[0]!==end[0]||start[1]!==end[1]?(fragment.index=i,fragmentByStart[start]=fragmentByEnd[end]=fragment):(fragment.polygon.push(fragment.ring),fragments[i]=null);for(i=0;i<n;++i)if(fragment=fragments[i]){if(start=fragment.ring[0],end=fragment.ring[fragment.ring.length-1],startFragment=fragmentByEnd[start],endFragment=fragmentByStart[end],delete fragmentByStart[start],delete fragmentByEnd[end],start[0]===end[0]&&start[1]===end[1]){fragment.polygon.push(fragment.ring);continue}startFragment?(delete fragmentByEnd[start],delete fragmentByStart[startFragment.ring[0]],startFragment.ring.pop(),fragments[startFragment.index]=null,fragment={index:-1,polygon:startFragment.polygon,ring:startFragment.ring.concat(fragment.ring)},startFragment===endFragment?fragment.polygon.push(fragment.ring):(fragment.index=n++,fragments.push(fragmentByStart[fragment.ring[0]]=fragmentByEnd[fragment.ring[fragment.ring.length-1]]=fragment))):endFragment?(delete fragmentByStart[end],delete fragmentByEnd[endFragment.ring[endFragment.ring.length-1]],fragment.ring.pop(),fragment={index:n++,polygon:endFragment.polygon,ring:fragment.ring.concat(endFragment.ring)},fragments[endFragment.index]=null,fragments.push(fragmentByStart[fragment.ring[0]]=fragmentByEnd[fragment.ring[fragment.ring.length-1]]=fragment)):(fragment.ring.push(fragment.ring[0]),fragment.polygon.push(fragment.ring))}}function stitchFeature(input){var output={type:"Feature",geometry:stitchGeometry(input.geometry)};return null!=input.id&&(output.id=input.id),null!=input.bbox&&(output.bbox=input.bbox),null!=input.properties&&(output.properties=input.properties),output}function stitchGeometry(input){if(null==input)return input;var output,fragments,i,n;switch(input.type){case"GeometryCollection":output={type:"GeometryCollection",geometries:input.geometries.map(stitchGeometry)};break;case"Point":output={type:"Point",coordinates:clampPoint(input.coordinates)};break;case"MultiPoint":case"LineString":output={type:input.type,coordinates:clampPoints(input.coordinates)};break;case"MultiLineString":output={type:"MultiLineString",coordinates:input.coordinates.map(clampPoints)};break;case"Polygon":var polygon=[];extractFragments(input.coordinates,polygon,fragments=[]),stitchFragments(fragments),output={type:"Polygon",coordinates:polygon};break;case"MultiPolygon":fragments=[],i=-1,n=input.coordinates.length;for(var polygons=new Array(n);++i<n;)extractFragments(input.coordinates[i],polygons[i]=[],fragments);stitchFragments(fragments),output={type:"MultiPolygon",coordinates:polygons.filter(nonempty)};break;default:return input}return null!=input.bbox&&(output.bbox=input.bbox),output}var A$1=4*pi$4+3*sqrt$2(3),B$1=2*sqrt$2(2*pi$4*sqrt$2(3)/A$1),wagner4Raw=mollweideBromleyRaw(B$1*sqrt$2(3)/pi$4,B$1,A$1/6);function wagner6Raw(lambda,phi){return[lambda*sqrt$2(1-3*phi*phi/(pi$4*pi$4)),phi]}wagner6Raw.invert=function(x,y){return[x/sqrt$2(1-3*y*y/(pi$4*pi$4)),y]};var acos$3=Math.acos,asin$3=Math.asin,atan2$3=Math.atan2,cos$3=Math.cos,max$3=Math.max,min$3=Math.min,PI=Math.PI,sin$3=Math.sin,sqrt$3=Math.sqrt,radians$2=PI/180,degrees$3=180/PI,versor=function(e){var l=e[0]/2*radians$2,sl=sin$3(l),cl=cos$3(l),p=e[1]/2*radians$2,sp=sin$3(p),cp=cos$3(p),g=e[2]/2*radians$2,sg=sin$3(g),cg=cos$3(g);return[cl*cp*cg+sl*sp*sg,sl*cp*cg-cl*sp*sg,cl*sp*cg+sl*cp*sg,cl*cp*sg-sl*sp*cg]};function dot(v0,v1){return v0[0]*v1[0]+v0[1]*v1[1]+v0[2]*v1[2]}function identity$7(x){return x}function transform$2(transform){if(null==transform)return identity$7;var x0,y0,kx=transform.scale[0],ky=transform.scale[1],dx=transform.translate[0],dy=transform.translate[1];return function(input,i){i||(x0=y0=0);var j=2,n=input.length,output=new Array(n);for(output[0]=(x0+=input[0])*kx+dx,output[1]=(y0+=input[1])*ky+dy;j<n;)output[j]=input[j],++j;return output}}function bbox(topology){var key,t=transform$2(topology.transform),x0=1/0,y0=x0,x1=-x0,y1=-x0;function bboxPoint(p){(p=t(p))[0]<x0&&(x0=p[0]),p[0]>x1&&(x1=p[0]),p[1]<y0&&(y0=p[1]),p[1]>y1&&(y1=p[1])}function bboxGeometry(o){switch(o.type){case"GeometryCollection":o.geometries.forEach(bboxGeometry);break;case"Point":bboxPoint(o.coordinates);break;case"MultiPoint":o.coordinates.forEach(bboxPoint)}}for(key in topology.arcs.forEach(function(arc){for(var p,i=-1,n=arc.length;++i<n;)(p=t(arc[i],i))[0]<x0&&(x0=p[0]),p[0]>x1&&(x1=p[0]),p[1]<y0&&(y0=p[1]),p[1]>y1&&(y1=p[1])}),topology.objects)bboxGeometry(topology.objects[key]);return[x0,y0,x1,y1]}function feature$1(topology,o){var id=o.id,bbox=o.bbox,properties=null==o.properties?{}:o.properties,geometry=object$2(topology,o);return null==id&&null==bbox?{type:"Feature",properties:properties,geometry:geometry}:null==bbox?{type:"Feature",id:id,properties:properties,geometry:geometry}:{type:"Feature",id:id,bbox:bbox,properties:properties,geometry:geometry}}function object$2(topology,o){var transformPoint=transform$2(topology.transform),arcs=topology.arcs;function arc(i,points){points.length&&points.pop();for(var a=arcs[i<0?~i:i],k=0,n=a.length;k<n;++k)points.push(transformPoint(a[k],k));i<0&&function(array,n){for(var t,j=array.length,i=j-n;i<--j;)t=array[i],array[i++]=array[j],array[j]=t}(points,n)}function point(p){return transformPoint(p)}function line(arcs){for(var points=[],i=0,n=arcs.length;i<n;++i)arc(arcs[i],points);return points.length<2&&points.push(points[0]),points}function ring(arcs){for(var points=line(arcs);points.length<4;)points.push(points[0]);return points}function polygon(arcs){return arcs.map(ring)}return function geometry(o){var coordinates,type=o.type;switch(type){case"GeometryCollection":return{type:type,geometries:o.geometries.map(geometry)};case"Point":coordinates=point(o.coordinates);break;case"MultiPoint":coordinates=o.coordinates.map(point);break;case"LineString":coordinates=line(o.arcs);break;case"MultiLineString":coordinates=o.arcs.map(line);break;case"Polygon":coordinates=polygon(o.arcs);break;case"MultiPolygon":coordinates=o.arcs.map(polygon);break;default:return null}return{type:type,coordinates:coordinates}}(o)}function stitch$1(topology,arcs){var stitchedArcs={},fragmentByStart={},fragmentByEnd={},fragments=[],emptyIndex=-1;function flush(fragmentByEnd,fragmentByStart){for(var k in fragmentByEnd){var f=fragmentByEnd[k];delete fragmentByStart[f.start],delete f.start,delete f.end,f.forEach(function(i){stitchedArcs[i<0?~i:i]=1}),fragments.push(f)}}return arcs.forEach(function(i,j){var t,arc=topology.arcs[i<0?~i:i];arc.length<3&&!arc[1][0]&&!arc[1][1]&&(t=arcs[++emptyIndex],arcs[emptyIndex]=i,arcs[j]=t)}),arcs.forEach(function(i){var f,g,e=function(i){var p1,arc=topology.arcs[i<0?~i:i],p0=arc[0];topology.transform?(p1=[0,0],arc.forEach(function(dp){p1[0]+=dp[0],p1[1]+=dp[1]})):p1=arc[arc.length-1];return i<0?[p1,p0]:[p0,p1]}(i),start=e[0],end=e[1];if(f=fragmentByEnd[start])if(delete fragmentByEnd[f.end],f.push(i),f.end=end,g=fragmentByStart[end]){delete fragmentByStart[g.start];var fg=g===f?f:f.concat(g);fragmentByStart[fg.start=f.start]=fragmentByEnd[fg.end=g.end]=fg}else fragmentByStart[f.start]=fragmentByEnd[f.end]=f;else if(f=fragmentByStart[end])if(delete fragmentByStart[f.start],f.unshift(i),f.start=start,g=fragmentByEnd[start]){delete fragmentByEnd[g.end];var gf=g===f?f:g.concat(f);fragmentByStart[gf.start=g.start]=fragmentByEnd[gf.end=f.end]=gf}else fragmentByStart[f.start]=fragmentByEnd[f.end]=f;else fragmentByStart[(f=[i]).start=start]=fragmentByEnd[f.end=end]=f}),flush(fragmentByEnd,fragmentByStart),flush(fragmentByStart,fragmentByEnd),arcs.forEach(function(i){stitchedArcs[i<0?~i:i]||fragments.push([i])}),fragments}function meshArcs(topology,object,filter){var arcs,i,n;if(arguments.length>1)arcs=function(topology,object,filter){var geom,arcs=[],geomsByArc=[];function extract0(i){var j=i<0?~i:i;(geomsByArc[j]||(geomsByArc[j]=[])).push({i:i,g:geom})}function extract1(arcs){arcs.forEach(extract0)}function extract2(arcs){arcs.forEach(extract1)}return function geometry(o){switch(geom=o,o.type){case"GeometryCollection":o.geometries.forEach(geometry);break;case"LineString":extract1(o.arcs);break;case"MultiLineString":case"Polygon":extract2(o.arcs);break;case"MultiPolygon":o.arcs.forEach(extract2)}}(object),geomsByArc.forEach(null==filter?function(geoms){arcs.push(geoms[0].i)}:function(geoms){filter(geoms[0].g,geoms[geoms.length-1].g)&&arcs.push(geoms[0].i)}),arcs}(0,object,filter);else for(i=0,arcs=new Array(n=topology.arcs.length);i<n;++i)arcs[i]=i;return{type:"MultiLineString",arcs:stitch$1(topology,arcs)}}function mergeArcs(topology,objects){var polygonsByArc={},polygons=[],groups=[];function extract(polygon){polygon.forEach(function(ring){ring.forEach(function(arc){(polygonsByArc[arc=arc<0?~arc:arc]||(polygonsByArc[arc]=[])).push(polygon)})}),polygons.push(polygon)}function area(ring){return function(ring){for(var a,i=-1,n=ring.length,b=ring[n-1],area=0;++i<n;)a=b,b=ring[i],area+=a[0]*b[1]-a[1]*b[0];return Math.abs(area)}(object$2(topology,{type:"Polygon",arcs:[ring]}).coordinates[0])}return objects.forEach(function geometry(o){switch(o.type){case"GeometryCollection":o.geometries.forEach(geometry);break;case"Polygon":extract(o.arcs);break;case"MultiPolygon":o.arcs.forEach(extract)}}),polygons.forEach(function(polygon){if(!polygon._){var group=[],neighbors=[polygon];for(polygon._=1,groups.push(group);polygon=neighbors.pop();)group.push(polygon),polygon.forEach(function(ring){ring.forEach(function(arc){polygonsByArc[arc<0?~arc:arc].forEach(function(polygon){polygon._||(polygon._=1,neighbors.push(polygon))})})})}}),polygons.forEach(function(polygon){delete polygon._}),{type:"MultiPolygon",arcs:groups.map(function(polygons){var n,arcs=[];if(polygons.forEach(function(polygon){polygon.forEach(function(ring){ring.forEach(function(arc){polygonsByArc[arc<0?~arc:arc].length<2&&arcs.push(arc)})})}),(n=(arcs=stitch$1(topology,arcs)).length)>1)for(var ki,t,i=1,k=area(arcs[0]);i<n;++i)(ki=area(arcs[i]))>k&&(t=arcs[0],arcs[0]=arcs[i],arcs[i]=t,k=ki);return arcs})}}function bisect(a,x){for(var lo=0,hi=a.length;lo<hi;){var mid=lo+hi>>>1;a[mid]<x?lo=mid+1:hi=mid}return lo}function untransform(transform){if(null==transform)return identity$7;var x0,y0,kx=transform.scale[0],ky=transform.scale[1],dx=transform.translate[0],dy=transform.translate[1];return function(input,i){i||(x0=y0=0);var j=2,n=input.length,output=new Array(n),x1=Math.round((input[0]-dx)/kx),y1=Math.round((input[1]-dy)/ky);for(output[0]=x1-x0,x0=x1,output[1]=y1-y0,y0=y1;j<n;)output[j]=input[j],++j;return output}}versor.cartesian=function(e){var l=e[0]*radians$2,p=e[1]*radians$2,cp=cos$3(p);return[cp*cos$3(l),cp*sin$3(l),sin$3(p)]},versor.rotation=function(q){return[atan2$3(2*(q[0]*q[1]+q[2]*q[3]),1-2*(q[1]*q[1]+q[2]*q[2]))*degrees$3,asin$3(max$3(-1,min$3(1,2*(q[0]*q[2]-q[3]*q[1]))))*degrees$3,atan2$3(2*(q[0]*q[3]+q[1]*q[2]),1-2*(q[2]*q[2]+q[3]*q[3]))*degrees$3]},versor.delta=function(v0,v1,alpha){2==arguments.length&&(alpha=1);var w=function(v0,v1){return[v0[1]*v1[2]-v0[2]*v1[1],v0[2]*v1[0]-v0[0]*v1[2],v0[0]*v1[1]-v0[1]*v1[0]]}(v0,v1),l=sqrt$3(dot(w,w));if(!l)return[1,0,0,0];var t=alpha*acos$3(max$3(-1,min$3(1,dot(v0,v1))))/2,s=sin$3(t);return[cos$3(t),w[2]/l*s,-w[1]/l*s,w[0]/l*s]},versor.multiply=function(q0,q1){return[q0[0]*q1[0]-q0[1]*q1[1]-q0[2]*q1[2]-q0[3]*q1[3],q0[0]*q1[1]+q0[1]*q1[0]+q0[2]*q1[3]-q0[3]*q1[2],q0[0]*q1[2]-q0[1]*q1[3]+q0[2]*q1[0]+q0[3]*q1[1],q0[0]*q1[3]+q0[1]*q1[2]-q0[2]*q1[1]+q0[3]*q1[0]]};var index$4=Object.freeze({bbox:bbox,feature:function(topology,o){return"GeometryCollection"===o.type?{type:"FeatureCollection",features:o.geometries.map(function(o){return feature$1(topology,o)})}:feature$1(topology,o)},mesh:function(topology){return object$2(topology,meshArcs.apply(this,arguments))},meshArcs:meshArcs,merge:function(topology){return object$2(topology,mergeArcs.apply(this,arguments))},mergeArcs:mergeArcs,neighbors:function(objects){var indexesByArc={},neighbors=objects.map(function(){return[]});function line(arcs,i){arcs.forEach(function(a){a<0&&(a=~a);var o=indexesByArc[a];o?o.push(i):indexesByArc[a]=[i]})}function polygon(arcs,i){arcs.forEach(function(arc){line(arc,i)})}var geometryType={LineString:line,MultiLineString:polygon,Polygon:polygon,MultiPolygon:function(arcs,i){arcs.forEach(function(arc){polygon(arc,i)})}};for(var i in objects.forEach(function geometry(o,i){"GeometryCollection"===o.type?o.geometries.forEach(function(o){geometry(o,i)}):o.type in geometryType&&geometryType[o.type](o.arcs,i)}),indexesByArc)for(var indexes=indexesByArc[i],m=indexes.length,j=0;j<m;++j)for(var k=j+1;k<m;++k){var n,ij=indexes[j],ik=indexes[k];(n=neighbors[ij])[i=bisect(n,ik)]!==ik&&n.splice(i,0,ik),(n=neighbors[ik])[i=bisect(n,ij)]!==ij&&n.splice(i,0,ij)}return neighbors},quantize:function(topology,transform){if(topology.transform)throw new Error("already quantized");if(transform&&transform.scale)box=topology.bbox;else{if(!((n=Math.floor(transform))>=2))throw new Error("n must be ≥2");var n,x0=(box=topology.bbox||bbox(topology))[0],y0=box[1],x1=box[2],y1=box[3];transform={scale:[x1-x0?(x1-x0)/(n-1):1,y1-y0?(y1-y0)/(n-1):1],translate:[x0,y0]}}var box,key,t=untransform(transform),inputs=topology.objects,outputs={};function quantizePoint(point){return t(point)}function quantizeGeometry(input){var output;switch(input.type){case"GeometryCollection":output={type:"GeometryCollection",geometries:input.geometries.map(quantizeGeometry)};break;case"Point":output={type:"Point",coordinates:quantizePoint(input.coordinates)};break;case"MultiPoint":output={type:"MultiPoint",coordinates:input.coordinates.map(quantizePoint)};break;default:return input}return null!=input.id&&(output.id=input.id),null!=input.bbox&&(output.bbox=input.bbox),null!=input.properties&&(output.properties=input.properties),output}for(key in inputs)outputs[key]=quantizeGeometry(inputs[key]);return{type:"Topology",bbox:box,transform:transform,objects:outputs,arcs:topology.arcs.map(function(input){var p,i=0,j=1,n=input.length,output=new Array(n);for(output[0]=t(input[0],0);++i<n;)((p=t(input[i],i))[0]||p[1])&&(output[j++]=p);return 1===j&&(output[j++]=[0,0]),output.length=j,output})}},transform:transform$2,untransform:untransform});function add$1(tree,x,y,d){if(isNaN(x)||isNaN(y))return tree;var parent,xm,ym,xp,yp,right,bottom,i,j,node=tree._root,leaf={data:d},x0=tree._x0,y0=tree._y0,x1=tree._x1,y1=tree._y1;if(!node)return tree._root=leaf,tree;for(;node.length;)if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return parent[i]=leaf,tree;if(xp=+tree._x.call(null,node.data),yp=+tree._y.call(null,node.data),x===xp&&y===yp)return leaf.next=node,parent?parent[i]=leaf:tree._root=leaf,tree;do{parent=parent?parent[i]=new Array(4):tree._root=new Array(4),(right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym}while((i=bottom<<1|right)==(j=(yp>=ym)<<1|xp>=xm));return parent[j]=node,parent[i]=leaf,tree}function Quad(node,x0,y0,x1,y1){this.node=node,this.x0=x0,this.y0=y0,this.x1=x1,this.y1=y1}function defaultX(d){return d[0]}function defaultY(d){return d[1]}function quadtree(nodes,x,y){var tree=new Quadtree(null==x?defaultX:x,null==y?defaultY:y,NaN,NaN,NaN,NaN);return null==nodes?tree:tree.addAll(nodes)}function Quadtree(x,y,x0,y0,x1,y1){this._x=x,this._y=y,this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this._root=void 0}function leaf_copy(leaf){for(var copy={data:leaf.data},next=copy;leaf=leaf.next;)next=next.next={data:leaf.data};return copy}var treeProto=quadtree.prototype=Quadtree.prototype;treeProto.copy=function(){var nodes,child,copy=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),node=this._root;if(!node)return copy;if(!node.length)return copy._root=leaf_copy(node),copy;for(nodes=[{source:node,target:copy._root=new Array(4)}];node=nodes.pop();)for(var i=0;i<4;++i)(child=node.source[i])&&(child.length?nodes.push({source:child,target:node.target[i]=new Array(4)}):node.target[i]=leaf_copy(child));return copy},treeProto.add=function(d){var x=+this._x.call(null,d),y=+this._y.call(null,d);return add$1(this.cover(x,y),x,y,d)},treeProto.addAll=function(data){var d,i,x,y,n=data.length,xz=new Array(n),yz=new Array(n),x0=1/0,y0=1/0,x1=-1/0,y1=-1/0;for(i=0;i<n;++i)isNaN(x=+this._x.call(null,d=data[i]))||isNaN(y=+this._y.call(null,d))||(xz[i]=x,yz[i]=y,x<x0&&(x0=x),x>x1&&(x1=x),y<y0&&(y0=y),y>y1&&(y1=y));if(x0>x1||y0>y1)return this;for(this.cover(x0,y0).cover(x1,y1),i=0;i<n;++i)add$1(this,xz[i],yz[i],data[i]);return this},treeProto.cover=function(x,y){if(isNaN(x=+x)||isNaN(y=+y))return this;var x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(isNaN(x0))x1=(x0=Math.floor(x))+1,y1=(y0=Math.floor(y))+1;else{for(var parent,i,z=x1-x0,node=this._root;x0>x||x>=x1||y0>y||y>=y1;)switch(i=(y<y0)<<1|x<x0,(parent=new Array(4))[i]=node,node=parent,z*=2,i){case 0:x1=x0+z,y1=y0+z;break;case 1:x0=x1-z,y1=y0+z;break;case 2:x1=x0+z,y0=y1-z;break;case 3:x0=x1-z,y0=y1-z}this._root&&this._root.length&&(this._root=node)}return this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this},treeProto.data=function(){var data=[];return this.visit(function(node){if(!node.length)do{data.push(node.data)}while(node=node.next)}),data},treeProto.extent=function(_){return arguments.length?this.cover(+_[0][0],+_[0][1]).cover(+_[1][0],+_[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},treeProto.find=function(x,y,radius){var data,x1,y1,x2,y2,q,i,x0=this._x0,y0=this._y0,x3=this._x1,y3=this._y1,quads=[],node=this._root;for(node&&quads.push(new Quad(node,x0,y0,x3,y3)),null==radius?radius=1/0:(x0=x-radius,y0=y-radius,x3=x+radius,y3=y+radius,radius*=radius);q=quads.pop();)if(!(!(node=q.node)||(x1=q.x0)>x3||(y1=q.y0)>y3||(x2=q.x1)<x0||(y2=q.y1)<y0))if(node.length){var xm=(x1+x2)/2,ym=(y1+y2)/2;quads.push(new Quad(node[3],xm,ym,x2,y2),new Quad(node[2],x1,ym,xm,y2),new Quad(node[1],xm,y1,x2,ym),new Quad(node[0],x1,y1,xm,ym)),(i=(y>=ym)<<1|x>=xm)&&(q=quads[quads.length-1],quads[quads.length-1]=quads[quads.length-1-i],quads[quads.length-1-i]=q)}else{var dx=x-+this._x.call(null,node.data),dy=y-+this._y.call(null,node.data),d2=dx*dx+dy*dy;if(d2<radius){var d=Math.sqrt(radius=d2);x0=x-d,y0=y-d,x3=x+d,y3=y+d,data=node.data}}return data},treeProto.remove=function(d){if(isNaN(x=+this._x.call(null,d))||isNaN(y=+this._y.call(null,d)))return this;var parent,retainer,previous,next,x,y,xm,ym,right,bottom,i,j,node=this._root,x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(!node)return this;if(node.length)for(;;){if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return this;if(!node.length)break;(parent[i+1&3]||parent[i+2&3]||parent[i+3&3])&&(retainer=parent,j=i)}for(;node.data!==d;)if(previous=node,!(node=node.next))return this;return(next=node.next)&&delete node.next,previous?(next?previous.next=next:delete previous.next,this):parent?(next?parent[i]=next:delete parent[i],(node=parent[0]||parent[1]||parent[2]||parent[3])&&node===(parent[3]||parent[2]||parent[1]||parent[0])&&!node.length&&(retainer?retainer[j]=node:this._root=node),this):(this._root=next,this)},treeProto.removeAll=function(data){for(var i=0,n=data.length;i<n;++i)this.remove(data[i]);return this},treeProto.root=function(){return this._root},treeProto.size=function(){var size=0;return this.visit(function(node){if(!node.length)do{++size}while(node=node.next)}),size},treeProto.visit=function(callback){var q,child,x0,y0,x1,y1,quads=[],node=this._root;for(node&&quads.push(new Quad(node,this._x0,this._y0,this._x1,this._y1));q=quads.pop();)if(!callback(node=q.node,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1)&&node.length){var xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[3])&&quads.push(new Quad(child,xm,ym,x1,y1)),(child=node[2])&&quads.push(new Quad(child,x0,ym,xm,y1)),(child=node[1])&&quads.push(new Quad(child,xm,y0,x1,ym)),(child=node[0])&&quads.push(new Quad(child,x0,y0,xm,ym))}return this},treeProto.visitAfter=function(callback){var q,quads=[],next=[];for(this._root&&quads.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));q=quads.pop();){var node=q.node;if(node.length){var child,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1,xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[0])&&quads.push(new Quad(child,x0,y0,xm,ym)),(child=node[1])&&quads.push(new Quad(child,xm,y0,x1,ym)),(child=node[2])&&quads.push(new Quad(child,x0,ym,xm,y1)),(child=node[3])&&quads.push(new Quad(child,xm,ym,x1,y1))}next.push(q)}for(;q=next.pop();)callback(q.node,q.x0,q.y0,q.x1,q.y1);return this},treeProto.x=function(_){return arguments.length?(this._x=_,this):this._x},treeProto.y=function(_){return arguments.length?(this._y=_,this):this._y},exports.topojson=index$4,exports.bisect=bisectRight,exports.bisectRight=bisectRight,exports.bisectLeft=bisectLeft,exports.ascending=ascending,exports.bisector=bisector,exports.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},exports.extent=function(values,valueof){var value,min,max,n=values.length,i=-1;if(null==valueof){for(;++i<n;)if(null!=(value=values[i])&&value>=value)for(min=max=value;++i<n;)null!=(value=values[i])&&(min>value&&(min=value),max<value&&(max=value))}else for(;++i<n;)if(null!=(value=valueof(values[i],i,values))&&value>=value)for(min=max=value;++i<n;)null!=(value=valueof(values[i],i,values))&&(min>value&&(min=value),max<value&&(max=value));return[min,max]},exports.max=function(values,valueof){var value,max,n=values.length,i=-1;if(null==valueof){for(;++i<n;)if(null!=(value=values[i])&&value>=value)for(max=value;++i<n;)null!=(value=values[i])&&value>max&&(max=value)}else for(;++i<n;)if(null!=(value=valueof(values[i],i,values))&&value>=value)for(max=value;++i<n;)null!=(value=valueof(values[i],i,values))&&value>max&&(max=value);return max},exports.min=function(values,valueof){var value,min,n=values.length,i=-1;if(null==valueof){for(;++i<n;)if(null!=(value=values[i])&&value>=value)for(min=value;++i<n;)null!=(value=values[i])&&min>value&&(min=value)}else for(;++i<n;)if(null!=(value=valueof(values[i],i,values))&&value>=value)for(min=value;++i<n;)null!=(value=valueof(values[i],i,values))&&min>value&&(min=value);return min},exports.merge=merge,exports.range=sequence,exports.scan=function(values,compare){if(n=values.length){var n,xi,i=0,j=0,xj=values[j];for(null==compare&&(compare=ascending);++i<n;)(compare(xi=values[i],xj)<0||0!==compare(xj,xj))&&(xj=xi,j=i);return 0===compare(xj,xj)?j:void 0}},exports.sum=function(values,valueof){var value,n=values.length,i=-1,sum=0;if(null==valueof)for(;++i<n;)(value=+values[i])&&(sum+=value);else for(;++i<n;)(value=+valueof(values[i],i,values))&&(sum+=value);return sum},exports.ticks=ticks,exports.tickIncrement=tickIncrement,exports.tickStep=tickStep,exports.set=set,exports.map=map,exports.keys=function(map){var keys=[];for(var key in map)keys.push(key);return keys},exports.values=function(map){var values=[];for(var key in map)values.push(map[key]);return values},exports.csvParse=csvParse,exports.csvParseRows=csvParseRows,exports.request=request,exports.json=json,exports.scaleBand=band,exports.scalePoint=function(){return function pointish(scale){var copy=scale.copy;return scale.padding=scale.paddingOuter,delete scale.paddingInner,delete scale.paddingOuter,scale.copy=function(){return pointish(copy())},scale}(band().paddingInner(1))},exports.scaleLinear=function linear$2(){var scale=continuous(deinterpolateLinear,interpolateNumber);return scale.copy=function(){return copy(scale,linear$2())},linearish(scale)},exports.scaleOrdinal=ordinal,exports.scaleQuantile=function quantile$1(){var domain=[],range=[],thresholds=[];function rescale(){var i=0,n=Math.max(1,range.length);for(thresholds=new Array(n-1);++i<n;)thresholds[i-1]=quantile(domain,i/n);return scale}function scale(x){if(!isNaN(x=+x))return range[bisectRight(thresholds,x)]}return scale.invertExtent=function(y){var i=range.indexOf(y);return i<0?[NaN,NaN]:[i>0?thresholds[i-1]:domain[0],i<thresholds.length?thresholds[i]:domain[domain.length-1]]},scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[];for(var d,i=0,n=_.length;i<n;++i)null==(d=_[i])||isNaN(d=+d)||domain.push(d);return domain.sort(ascending),rescale()},scale.range=function(_){return arguments.length?(range=slice$2.call(_),rescale()):range.slice()},scale.quantiles=function(){return thresholds.slice()},scale.copy=function(){return quantile$1().domain(domain).range(range)},scale},exports.scaleTime=function(){return calendar(year,month,sunday,day,hour,minute,second,millisecond,exports.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},exports.scaleUtc=function(){return calendar(utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,millisecond,exports.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},exports.arc=function(){var innerRadius=arcInnerRadius,outerRadius=arcOuterRadius,cornerRadius=constant$6(0),padRadius=null,startAngle=arcStartAngle,endAngle=arcEndAngle,padAngle=arcPadAngle,context=null;function arc(){var buffer,r,x,r0=+innerRadius.apply(this,arguments),r1=+outerRadius.apply(this,arguments),a0=startAngle.apply(this,arguments)-halfPi$1,a1=endAngle.apply(this,arguments)-halfPi$1,da=abs(a1-a0),cw=a1>a0;if(context||(context=buffer=path()),r1<r0&&(r=r1,r1=r0,r0=r),r1>epsilon$2)if(da>tau$2-epsilon$2)context.moveTo(r1*cos(a0),r1*sin(a0)),context.arc(0,0,r1,a0,a1,!cw),r0>epsilon$2&&(context.moveTo(r0*cos(a1),r0*sin(a1)),context.arc(0,0,r0,a1,a0,cw));else{var t0,t1,a01=a0,a11=a1,a00=a0,a10=a1,da0=da,da1=da,ap=padAngle.apply(this,arguments)/2,rp=ap>epsilon$2&&(padRadius?+padRadius.apply(this,arguments):sqrt(r0*r0+r1*r1)),rc=min$1(abs(r1-r0)/2,+cornerRadius.apply(this,arguments)),rc0=rc,rc1=rc;if(rp>epsilon$2){var p0=asin(rp/r0*sin(ap)),p1=asin(rp/r1*sin(ap));(da0-=2*p0)>epsilon$2?(a00+=p0*=cw?1:-1,a10-=p0):(da0=0,a00=a10=(a0+a1)/2),(da1-=2*p1)>epsilon$2?(a01+=p1*=cw?1:-1,a11-=p1):(da1=0,a01=a11=(a0+a1)/2)}var x01=r1*cos(a01),y01=r1*sin(a01),x10=r0*cos(a10),y10=r0*sin(a10);if(rc>epsilon$2){var x11=r1*cos(a11),y11=r1*sin(a11),x00=r0*cos(a00),y00=r0*sin(a00);if(da<pi$2){var oc=da0>epsilon$2?function(x0,y0,x1,y1,x2,y2,x3,y3){var x10=x1-x0,y10=y1-y0,x32=x3-x2,y32=y3-y2,t=(x32*(y0-y2)-y32*(x0-x2))/(y32*x10-x32*y10);return[x0+t*x10,y0+t*y10]}(x01,y01,x00,y00,x11,y11,x10,y10):[x10,y10],ax=x01-oc[0],ay=y01-oc[1],bx=x11-oc[0],by=y11-oc[1],kc=1/sin(((x=(ax*bx+ay*by)/(sqrt(ax*ax+ay*ay)*sqrt(bx*bx+by*by)))>1?0:x<-1?pi$2:Math.acos(x))/2),lc=sqrt(oc[0]*oc[0]+oc[1]*oc[1]);rc0=min$1(rc,(r0-lc)/(kc-1)),rc1=min$1(rc,(r1-lc)/(kc+1))}}da1>epsilon$2?rc1>epsilon$2?(t0=cornerTangents(x00,y00,x01,y01,r1,rc1,cw),t1=cornerTangents(x11,y11,x10,y10,r1,rc1,cw),context.moveTo(t0.cx+t0.x01,t0.cy+t0.y01),rc1<rc?context.arc(t0.cx,t0.cy,rc1,atan2(t0.y01,t0.x01),atan2(t1.y01,t1.x01),!cw):(context.arc(t0.cx,t0.cy,rc1,atan2(t0.y01,t0.x01),atan2(t0.y11,t0.x11),!cw),context.arc(0,0,r1,atan2(t0.cy+t0.y11,t0.cx+t0.x11),atan2(t1.cy+t1.y11,t1.cx+t1.x11),!cw),context.arc(t1.cx,t1.cy,rc1,atan2(t1.y11,t1.x11),atan2(t1.y01,t1.x01),!cw))):(context.moveTo(x01,y01),context.arc(0,0,r1,a01,a11,!cw)):context.moveTo(x01,y01),r0>epsilon$2&&da0>epsilon$2?rc0>epsilon$2?(t0=cornerTangents(x10,y10,x11,y11,r0,-rc0,cw),t1=cornerTangents(x01,y01,x00,y00,r0,-rc0,cw),context.lineTo(t0.cx+t0.x01,t0.cy+t0.y01),rc0<rc?context.arc(t0.cx,t0.cy,rc0,atan2(t0.y01,t0.x01),atan2(t1.y01,t1.x01),!cw):(context.arc(t0.cx,t0.cy,rc0,atan2(t0.y01,t0.x01),atan2(t0.y11,t0.x11),!cw),context.arc(0,0,r0,atan2(t0.cy+t0.y11,t0.cx+t0.x11),atan2(t1.cy+t1.y11,t1.cx+t1.x11),cw),context.arc(t1.cx,t1.cy,rc0,atan2(t1.y11,t1.x11),atan2(t1.y01,t1.x01),!cw))):context.arc(0,0,r0,a10,a00,cw):context.lineTo(x10,y10)}else context.moveTo(0,0);if(context.closePath(),buffer)return context=null,buffer+""||null}return arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-pi$2/2;return[cos(a)*r,sin(a)*r]},arc.innerRadius=function(_){return arguments.length?(innerRadius="function"==typeof _?_:constant$6(+_),arc):innerRadius},arc.outerRadius=function(_){return arguments.length?(outerRadius="function"==typeof _?_:constant$6(+_),arc):outerRadius},arc.cornerRadius=function(_){return arguments.length?(cornerRadius="function"==typeof _?_:constant$6(+_),arc):cornerRadius},arc.padRadius=function(_){return arguments.length?(padRadius=null==_?null:"function"==typeof _?_:constant$6(+_),arc):padRadius},arc.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:constant$6(+_),arc):startAngle},arc.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:constant$6(+_),arc):endAngle},arc.padAngle=function(_){return arguments.length?(padAngle="function"==typeof _?_:constant$6(+_),arc):padAngle},arc.context=function(_){return arguments.length?(context=null==_?null:_,arc):context},arc},exports.area=area,exports.line=line,exports.pie=function(){var value=identity$3,sortValues=descending$1,sort=null,startAngle=constant$6(0),endAngle=constant$6(tau$2),padAngle=constant$6(0);function pie(data){var i,j,k,a1,v,n=data.length,sum=0,index=new Array(n),arcs=new Array(n),a0=+startAngle.apply(this,arguments),da=Math.min(tau$2,Math.max(-tau$2,endAngle.apply(this,arguments)-a0)),p=Math.min(Math.abs(da)/n,padAngle.apply(this,arguments)),pa=p*(da<0?-1:1);for(i=0;i<n;++i)(v=arcs[index[i]=i]=+value(data[i],i,data))>0&&(sum+=v);for(null!=sortValues?index.sort(function(i,j){return sortValues(arcs[i],arcs[j])}):null!=sort&&index.sort(function(i,j){return sort(data[i],data[j])}),i=0,k=sum?(da-n*pa)/sum:0;i<n;++i,a0=a1)j=index[i],a1=a0+((v=arcs[j])>0?v*k:0)+pa,arcs[j]={data:data[j],index:i,value:v,startAngle:a0,endAngle:a1,padAngle:p};return arcs}return pie.value=function(_){return arguments.length?(value="function"==typeof _?_:constant$6(+_),pie):value},pie.sortValues=function(_){return arguments.length?(sortValues=_,sort=null,pie):sortValues},pie.sort=function(_){return arguments.length?(sort=_,sortValues=null,pie):sort},pie.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:constant$6(+_),pie):startAngle},pie.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:constant$6(+_),pie):endAngle},pie.padAngle=function(_){return arguments.length?(padAngle="function"==typeof _?_:constant$6(+_),pie):padAngle},pie},exports.areaRadial=areaRadial,exports.radialArea=areaRadial,exports.lineRadial=lineRadial$1,exports.radialLine=lineRadial$1,exports.pointRadial=function(x,y){return[(y=+y)*Math.cos(x-=Math.PI/2),y*Math.sin(x)]},exports.curveLinear=curveLinear,exports.curveLinearClosed=function(context){return new LinearClosed(context)},exports.curveCardinal=cardinal,exports.curveCardinalClosed=cardinalClosed,exports.curveMonotoneX=function(context){return new MonotoneX(context)},exports.curveMonotoneY=function(context){return new MonotoneY(context)},exports.curveStepAfter=function(context){return new Step(context,1)},exports.curveStepBefore=function(context){return new Step(context,0)},exports.stack=function(){var keys=constant$6([]),order=none$2,offset=none$1,value=stackValue;function stack(data){var i,oz,kz=keys.apply(this,arguments),m=data.length,n=kz.length,sz=new Array(n);for(i=0;i<n;++i){for(var sij,ki=kz[i],si=sz[i]=new Array(m),j=0;j<m;++j)si[j]=sij=[0,+value(data[j],ki,j,data)],sij.data=data[j];si.key=ki}for(i=0,oz=order(sz);i<n;++i)sz[oz[i]].index=i;return offset(sz,oz),sz}return stack.keys=function(_){return arguments.length?(keys="function"==typeof _?_:constant$6(slice$3.call(_)),stack):keys},stack.value=function(_){return arguments.length?(value="function"==typeof _?_:constant$6(+_),stack):value},stack.order=function(_){return arguments.length?(order=null==_?none$2:"function"==typeof _?_:constant$6(slice$3.call(_)),stack):order},stack.offset=function(_){return arguments.length?(offset=null==_?none$1:_,stack):offset},stack},exports.geoStitch=function(input){if(null==input)return input;switch(input.type){case"Feature":return stitchFeature(input);case"FeatureCollection":var output={type:"FeatureCollection",features:input.features.map(stitchFeature)};return null!=input.bbox&&(output.bbox=input.bbox),output;default:return stitchGeometry(input)}},exports.geoProject=function(object,projection){var project,stream=projection.stream;if(!stream)throw new Error("invalid projection");switch(object&&object.type){case"Feature":project=projectFeature;break;case"FeatureCollection":project=projectFeatureCollection;break;default:project=projectGeometry}return project(object,stream)},exports.geoQuantize=function(input,digits){if(!(0<=(digits=+digits)&&digits<=20))throw new Error("invalid digits");function quantizePoint(input){var n=input.length,i=2,output=new Array(n);for(output[0]=+input[0].toFixed(digits),output[1]=+input[1].toFixed(digits);i<n;)output[i]=input[i],++i;return output}function quantizePoints(input){return input.map(quantizePoint)}function quantizePolygon(input){return input.map(quantizePoints)}function quantizeGeometry(input){if(null==input)return input;var output;switch(input.type){case"GeometryCollection":output={type:"GeometryCollection",geometries:input.geometries.map(quantizeGeometry)};break;case"Point":output={type:"Point",coordinates:quantizePoint(input.coordinates)};break;case"MultiPoint":case"LineString":output={type:input.type,coordinates:quantizePoints(input.coordinates)};break;case"MultiLineString":case"Polygon":output={type:input.type,coordinates:quantizePolygon(input.coordinates)};break;case"MultiPolygon":output={type:"MultiPolygon",coordinates:input.coordinates.map(quantizePolygon)};break;default:return input}return null!=input.bbox&&(output.bbox=input.bbox),output}function quantizeFeature(input){var output={type:"Feature",properties:input.properties,geometry:quantizeGeometry(input.geometry)};return null!=input.id&&(output.id=input.id),null!=input.bbox&&(output.bbox=input.bbox),output}if(null!=input)switch(input.type){case"Feature":return quantizeFeature(input);case"FeatureCollection":var output={type:"FeatureCollection",features:input.features.map(quantizeFeature)};return null!=input.bbox&&(output.bbox=input.bbox),output;default:return quantizeGeometry(input)}return input},exports.geoAiry=function(){var beta=halfPi$3,m=projectionMutator(airyRaw),p=m(beta);return p.radius=function(_){return arguments.length?m(beta=_*radians$1):beta*degrees$2},p.scale(179.976).clipAngle(147)},exports.geoAitoff=function(){return projection(aitoffRaw).scale(152.63)},exports.geoArmadillo=function(){var phi0=20*radians$1,sPhi0=phi0>=0?1:-1,tanPhi0=tan$1(sPhi0*phi0),m=projectionMutator(armadilloRaw),p=m(phi0),stream_=p.stream;return p.parallel=function(_){return arguments.length?(tanPhi0=tan$1((sPhi0=(phi0=_*radians$1)>=0?1:-1)*phi0),m(phi0)):phi0*degrees$2},p.stream=function(stream){var rotate=p.rotate(),rotateStream=stream_(stream),sphereStream=(p.rotate([0,0]),stream_(stream));return p.rotate(rotate),rotateStream.sphere=function(){sphereStream.polygonStart(),sphereStream.lineStart();for(var lambda=-180*sPhi0;sPhi0*lambda<180;lambda+=90*sPhi0)sphereStream.point(lambda,90*sPhi0);for(;sPhi0*(lambda-=phi0)>=-180;)sphereStream.point(lambda,sPhi0*-atan2$2(cos$2(lambda*radians$1/2),tanPhi0)*degrees$2);sphereStream.lineEnd(),sphereStream.polygonEnd()},rotateStream},p.scale(218.695).center([0,28.0974])},exports.geoMiller=function(){return projection(millerRaw).scale(108.318)},exports.geoChamberlinAfrica=function(){return(p0=[0,22],p1=[45,22],p2=[22.5,-22],c=centroid$1({type:"MultiPoint",coordinates:[p0,p1,p2]}),R=[-c[0],-c[1]],r=rotation(R),p=projection(function(p0,p1,p2){for(var b,points=[[p0[0],p0[1],sin$2(p0[1]),cos$2(p0[1])],[p1[0],p1[1],sin$2(p1[1]),cos$2(p1[1])],[p2[0],p2[1],sin$2(p2[1]),cos$2(p2[1])]],a=points[2],i=0;i<3;++i,a=b)b=points[i],a.v=distance$1(b[1]-a[1],a[3],a[2],b[3],b[2],b[0]-a[0]),a.point=[0,0];var beta0=angle$1(points[0].v[0],points[2].v[0],points[1].v[0]),beta1=angle$1(points[0].v[0],points[1].v[0],points[2].v[0]),beta2=pi$4-beta0;points[2].point[1]=0,points[0].point[0]=-(points[1].point[0]=points[0].v[0]/2);var mean=[points[2].point[0]=points[0].point[0]+points[2].v[0]*cos$2(beta0),2*(points[0].point[1]=points[1].point[1]=points[2].v[0]*sin$2(beta0))];return function(lambda,phi){var i,sinPhi=sin$2(phi),cosPhi=cos$2(phi),v=new Array(3);for(i=0;i<3;++i){var p=points[i];if(v[i]=distance$1(phi-p[1],p[3],p[2],cosPhi,sinPhi,lambda-p[0]),!v[i][0])return p.point;v[i][1]=longitude(v[i][1]-p.v[1])}var point=mean.slice();for(i=0;i<3;++i){var j=2==i?0:i+1,a=angle$1(points[i].v[0],v[i][0],v[j][0]);v[i][1]<0&&(a=-a),i?1==i?(a=beta1-a,point[0]-=v[i][0]*cos$2(a),point[1]-=v[i][0]*sin$2(a)):(a=beta2-a,point[0]+=v[i][0]*cos$2(a),point[1]+=v[i][0]*sin$2(a)):(point[0]+=v[i][0]*cos$2(a),point[1]-=v[i][0]*sin$2(a))}return point[0]/=3,point[1]/=3,point}}(pointRadians$1(r(p0)),pointRadians$1(r(p1)),pointRadians$1(r(p2)))).rotate(R),center=p.center,delete p.rotate,p.center=function(_){return arguments.length?center(r(_)):r.invert(center())},p.clipAngle(90)).scale(380).center([22.5,2]);var p0,p1,p2,c,R,r,p,center},exports.geoCylindricalStereographic=function(){return(projectAt=cylindricalStereographicRaw,phi0=0,m=projectionMutator(projectAt),p=m(phi0),p.parallel=function(_){return arguments.length?m(phi0=_*radians$1):phi0*degrees$2},p).scale(124.75);var projectAt,phi0,m,p},exports.geoEckert3=function(){return projection(eckert3Raw).scale(180.739)},exports.geoEckert4=function(){return projection(eckert4Raw).scale(180.739)},exports.geoEckert5=function(){return projection(eckert5Raw).scale(173.044)},exports.geoEckert6=function(){return projection(eckert6Raw).scale(173.044)},exports.geoFahey=function(){return projection(faheyRaw).scale(137.152)},exports.geoGinzburg4=function(){return projection(ginzburg4Raw).scale(149.995)},exports.geoGinzburg5=function(){return projection(ginzburg5Raw).scale(153.93)},exports.geoGinzburg6=function(){return projection(ginzburg6Raw).scale(130.945)},exports.geoGinzburg8=function(){return projection(ginzburg8Raw).scale(131.747)},exports.geoGinzburg9=function(){return projection(ginzburg9Raw).scale(131.087)},exports.geoHammer=function(){var B=2,m=projectionMutator(hammerRaw),p=m(B);return p.coefficient=function(_){return arguments.length?m(B=+_):B},p.scale(169.529)},exports.geoKavrayskiy7=function(){return projection(kavrayskiy7Raw).scale(158.837)},exports.geoRobinson=function(){return projection(robinsonRaw).scale(152.63)},exports.geoSatellite=function(){var distance=2,omega=0,m=projectionMutator(satelliteRaw),p=m(distance,omega);return p.distance=function(_){return arguments.length?m(distance=+_,omega):distance},p.tilt=function(_){return arguments.length?m(distance,omega=_*radians$1):omega*degrees$2},p.scale(432.147).clipAngle(acos$2(1/distance)*degrees$2-1e-6)},exports.geoWagner4=function(){return projection(wagner4Raw).scale(176.84)},exports.geoWagner6=function(){return projection(wagner6Raw).scale(152.63)},exports.versor=versor,exports.axisTop=function(scale){return axis(top,scale)},exports.axisRight=function(scale){return axis(right,scale)},exports.axisBottom=function(scale){return axis(bottom,scale)},exports.axisLeft=function(scale){return axis(left,scale)},exports.brush=function(){return brush$1(XY)},exports.brushX=function(){return brush$1(X)},exports.brushY=function(){return brush$1(Y)},exports.brushSelection=function(node){var state=node.__brush;return state?state.dim.output(state.selection):null},exports.color=color,exports.rgb=rgb,exports.hsl=hsl,exports.lab=lab,exports.hcl=hcl,exports.cubehelix=cubehelix,exports.dispatch=dispatch,exports.drag=function(){var mousedownx,mousedowny,mousemoving,touchending,filter=defaultFilter,container=defaultContainer,subject=defaultSubject,touchable=defaultTouchable,gestures={},listeners=dispatch("start","drag","end"),active=0,clickDistance2=0;function drag(selection){selection.on("mousedown.drag",mousedowned).filter(touchable).on("touchstart.drag",touchstarted).on("touchmove.drag",touchmoved).on("touchend.drag touchcancel.drag",touchended).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function mousedowned(){if(!touchending&&filter.apply(this,arguments)){var gesture=beforestart("mouse",container.apply(this,arguments),mouse,this,arguments);gesture&&(select(exports.event.view).on("mousemove.drag",mousemoved,!0).on("mouseup.drag",mouseupped,!0),dragDisable(exports.event.view),nopropagation(),mousemoving=!1,mousedownx=exports.event.clientX,mousedowny=exports.event.clientY,gesture("start"))}}function mousemoved(){if(noevent(),!mousemoving){var dx=exports.event.clientX-mousedownx,dy=exports.event.clientY-mousedowny;mousemoving=dx*dx+dy*dy>clickDistance2}gestures.mouse("drag")}function mouseupped(){select(exports.event.view).on("mousemove.drag mouseup.drag",null),yesdrag(exports.event.view,mousemoving),noevent(),gestures.mouse("end")}function touchstarted(){if(filter.apply(this,arguments)){var i,gesture,touches=exports.event.changedTouches,c=container.apply(this,arguments),n=touches.length;for(i=0;i<n;++i)(gesture=beforestart(touches[i].identifier,c,touch,this,arguments))&&(nopropagation(),gesture("start"))}}function touchmoved(){var i,gesture,touches=exports.event.changedTouches,n=touches.length;for(i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(noevent(),gesture("drag"))}function touchended(){var i,gesture,touches=exports.event.changedTouches,n=touches.length;for(touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},500),i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(nopropagation(),gesture("end"))}function beforestart(id,container,point,that,args){var s,dx,dy,p=point(container,id),sublisteners=listeners.copy();if(customEvent(new DragEvent(drag,"beforestart",s,id,active,p[0],p[1],0,0,sublisteners),function(){return null!=(exports.event.subject=s=subject.apply(that,args))&&(dx=s.x-p[0]||0,dy=s.y-p[1]||0,!0)}))return function gesture(type){var n,p0=p;switch(type){case"start":gestures[id]=gesture,n=active++;break;case"end":delete gestures[id],--active;case"drag":p=point(container,id),n=active}customEvent(new DragEvent(drag,type,s,id,n,p[0]+dx,p[1]+dy,p[0]-p0[0],p[1]-p0[1],sublisteners),sublisteners.apply,sublisteners,[type,that,args])}}return drag.filter=function(_){return arguments.length?(filter="function"==typeof _?_:constant$1(!!_),drag):filter},drag.container=function(_){return arguments.length?(container="function"==typeof _?_:constant$1(_),drag):container},drag.subject=function(_){return arguments.length?(subject="function"==typeof _?_:constant$1(_),drag):subject},drag.touchable=function(_){return arguments.length?(touchable="function"==typeof _?_:constant$1(!!_),drag):touchable},drag.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?drag:value},drag.clickDistance=function(_){return arguments.length?(clickDistance2=(_=+_)*_,drag):Math.sqrt(clickDistance2)},drag},exports.dragDisable=dragDisable,exports.dragEnable=yesdrag,exports.easeLinear=function(t){return+t},exports.easeQuad=quadInOut,exports.easeQuadInOut=quadInOut,exports.easeQuadIn=function(t){return t*t},exports.easeQuadOut=function(t){return t*(2-t)},exports.easeCubic=cubicInOut,exports.easeCubicInOut=cubicInOut,exports.easeCubicIn=function(t){return t*t*t},exports.easeCubicOut=function(t){return--t*t*t+1},exports.easePoly=polyInOut,exports.easePolyInOut=polyInOut,exports.easePolyIn=polyIn,exports.easePolyOut=polyOut,exports.easeSin=sinInOut,exports.easeSinInOut=sinInOut,exports.easeSinIn=function(t){return 1-Math.cos(t*halfPi)},exports.easeSinOut=function(t){return Math.sin(t*halfPi)},exports.easeExp=expInOut,exports.easeExpInOut=expInOut,exports.easeExpIn=function(t){return Math.pow(2,10*t-10)},exports.easeExpOut=function(t){return 1-Math.pow(2,-10*t)},exports.easeCircle=circleInOut,exports.easeCircleInOut=circleInOut,exports.easeCircleIn=function(t){return 1-Math.sqrt(1-t*t)},exports.easeCircleOut=function(t){return Math.sqrt(1- --t*t)},exports.easeBounce=bounceOut,exports.easeBounceOut=bounceOut,exports.easeBounceIn=function(t){return 1-bounceOut(1-t)},exports.easeBounceInOut=function(t){return((t*=2)<=1?1-bounceOut(1-t):bounceOut(t-1)+1)/2},exports.easeBack=backInOut,exports.easeBackInOut=backInOut,exports.easeBackIn=backIn,exports.easeBackOut=backOut,exports.easeElastic=elasticOut,exports.easeElasticOut=elasticOut,exports.easeElasticIn=elasticIn,exports.easeElasticInOut=elasticInOut,exports.formatDefaultLocale=defaultLocale,exports.formatLocale=formatLocale,exports.formatSpecifier=formatSpecifier,exports.precisionFixed=precisionFixed,exports.precisionPrefix=precisionPrefix,exports.precisionRound=precisionRound,exports.cluster=function(){var separation=defaultSeparation,dx=1,dy=1,nodeSize=!1;function cluster(root){var previousNode,x=0;root.eachAfter(function(node){var children=node.children;children?(node.x=function(children){return children.reduce(meanXReduce,0)/children.length}(children),node.y=function(children){return 1+children.reduce(maxYReduce,0)}(children)):(node.x=previousNode?x+=separation(node,previousNode):0,node.y=0,previousNode=node)});var left=function(node){for(var children;children=node.children;)node=children[0];return node}(root),right=function(node){for(var children;children=node.children;)node=children[children.length-1];return node}(root),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2;return root.eachAfter(nodeSize?function(node){node.x=(node.x-root.x)*dx,node.y=(root.y-node.y)*dy}:function(node){node.x=(node.x-x0)/(x1-x0)*dx,node.y=(1-(root.y?node.y/root.y:1))*dy})}return cluster.separation=function(x){return arguments.length?(separation=x,cluster):separation},cluster.size=function(x){return arguments.length?(nodeSize=!1,dx=+x[0],dy=+x[1],cluster):nodeSize?null:[dx,dy]},cluster.nodeSize=function(x){return arguments.length?(nodeSize=!0,dx=+x[0],dy=+x[1],cluster):nodeSize?[dx,dy]:null},cluster},exports.hierarchy=hierarchy,exports.pack=function(){var radius=null,dx=1,dy=1,padding=constantZero;function pack(root){return root.x=dx/2,root.y=dy/2,radius?root.eachBefore(radiusLeaf(radius)).eachAfter(packChildren(padding,.5)).eachBefore(translateChild(1)):root.eachBefore(radiusLeaf(defaultRadius)).eachAfter(packChildren(constantZero,1)).eachAfter(packChildren(padding,root.r/Math.min(dx,dy))).eachBefore(translateChild(Math.min(dx,dy)/(2*root.r))),root}return pack.radius=function(x){return arguments.length?(radius=null==(f=x)?null:required(f),pack):radius;var f},pack.size=function(x){return arguments.length?(dx=+x[0],dy=+x[1],pack):[dx,dy]},pack.padding=function(x){return arguments.length?(padding="function"==typeof x?x:constant$4(+x),pack):padding},pack},exports.packSiblings=function(circles){return packEnclose(circles),circles},exports.packEnclose=enclose,exports.partition=function(){var dx=1,dy=1,padding=0,round=!1;function partition(root){var n=root.height+1;return root.x0=root.y0=padding,root.x1=dx,root.y1=dy/n,root.eachBefore(function(dy,n){return function(node){node.children&&treemapDice(node,node.x0,dy*(node.depth+1)/n,node.x1,dy*(node.depth+2)/n);var x0=node.x0,y0=node.y0,x1=node.x1-padding,y1=node.y1-padding;x1<x0&&(x0=x1=(x0+x1)/2),y1<y0&&(y0=y1=(y0+y1)/2),node.x0=x0,node.y0=y0,node.x1=x1,node.y1=y1}}(dy,n)),round&&root.eachBefore(roundNode),root}return partition.round=function(x){return arguments.length?(round=!!x,partition):round},partition.size=function(x){return arguments.length?(dx=+x[0],dy=+x[1],partition):[dx,dy]},partition.padding=function(x){return arguments.length?(padding=+x,partition):padding},partition},exports.stratify=function(){var id=defaultId,parentId=defaultParentId;function stratify(data){var d,i,root,parent,node,nodeId,nodeKey,n=data.length,nodes=new Array(n),nodeByKey={};for(i=0;i<n;++i)d=data[i],node=nodes[i]=new Node(d),null!=(nodeId=id(d,i,data))&&(nodeId+="")&&(nodeByKey[nodeKey=keyPrefix$1+(node.id=nodeId)]=nodeKey in nodeByKey?ambiguous:node);for(i=0;i<n;++i)if(node=nodes[i],null!=(nodeId=parentId(data[i],i,data))&&(nodeId+="")){if(!(parent=nodeByKey[keyPrefix$1+nodeId]))throw new Error("missing: "+nodeId);if(parent===ambiguous)throw new Error("ambiguous: "+nodeId);parent.children?parent.children.push(node):parent.children=[node],node.parent=parent}else{if(root)throw new Error("multiple roots");root=node}if(!root)throw new Error("no root");if(root.parent=preroot,root.eachBefore(function(node){node.depth=node.parent.depth+1,--n}).eachBefore(computeHeight),root.parent=null,n>0)throw new Error("cycle");return root}return stratify.id=function(x){return arguments.length?(id=required(x),stratify):id},stratify.parentId=function(x){return arguments.length?(parentId=required(x),stratify):parentId},stratify},exports.tree=function(){var separation=defaultSeparation$1,dx=1,dy=1,nodeSize=null;function tree(root){var t=function(root){for(var node,child,children,i,n,tree=new TreeNode(root,0),nodes=[tree];node=nodes.pop();)if(children=node._.children)for(node.children=new Array(n=children.length),i=n-1;i>=0;--i)nodes.push(child=node.children[i]=new TreeNode(children[i],i)),child.parent=node;return(tree.parent=new TreeNode(null,0)).children=[tree],tree}(root);if(t.eachAfter(firstWalk),t.parent.m=-t.z,t.eachBefore(secondWalk),nodeSize)root.eachBefore(sizeNode);else{var left=root,right=root,bottom=root;root.eachBefore(function(node){node.x<left.x&&(left=node),node.x>right.x&&(right=node),node.depth>bottom.depth&&(bottom=node)});var s=left===right?1:separation(left,right)/2,tx=s-left.x,kx=dx/(right.x+s+tx),ky=dy/(bottom.depth||1);root.eachBefore(function(node){node.x=(node.x+tx)*kx,node.y=node.depth*ky})}return root}function firstWalk(v){var children=v.children,siblings=v.parent.children,w=v.i?siblings[v.i-1]:null;if(children){!function(v){for(var w,shift=0,change=0,children=v.children,i=children.length;--i>=0;)(w=children[i]).z+=shift,w.m+=shift,shift+=w.s+(change+=w.c)}(v);var midpoint=(children[0].z+children[children.length-1].z)/2;w?(v.z=w.z+separation(v._,w._),v.m=v.z-midpoint):v.z=midpoint}else w&&(v.z=w.z+separation(v._,w._));v.parent.A=function(v,w,ancestor){if(w){for(var shift,vip=v,vop=v,vim=w,vom=vip.parent.children[0],sip=vip.m,sop=vop.m,sim=vim.m,som=vom.m;vim=nextRight(vim),vip=nextLeft(vip),vim&&vip;)vom=nextLeft(vom),(vop=nextRight(vop)).a=v,(shift=vim.z+sim-vip.z-sip+separation(vim._,vip._))>0&&(moveSubtree(nextAncestor(vim,v,ancestor),v,shift),sip+=shift,sop+=shift),sim+=vim.m,sip+=vip.m,som+=vom.m,sop+=vop.m;vim&&!nextRight(vop)&&(vop.t=vim,vop.m+=sim-sop),vip&&!nextLeft(vom)&&(vom.t=vip,vom.m+=sip-som,ancestor=v)}return ancestor}(v,w,v.parent.A||siblings[0])}function secondWalk(v){v._.x=v.z+v.parent.m,v.m+=v.parent.m}function sizeNode(node){node.x*=dx,node.y=node.depth*dy}return tree.separation=function(x){return arguments.length?(separation=x,tree):separation},tree.size=function(x){return arguments.length?(nodeSize=!1,dx=+x[0],dy=+x[1],tree):nodeSize?null:[dx,dy]},tree.nodeSize=function(x){return arguments.length?(nodeSize=!0,dx=+x[0],dy=+x[1],tree):nodeSize?[dx,dy]:null},tree},exports.treemap=function(){var tile=squarify,round=!1,dx=1,dy=1,paddingStack=[0],paddingInner=constantZero,paddingTop=constantZero,paddingRight=constantZero,paddingBottom=constantZero,paddingLeft=constantZero;function treemap(root){return root.x0=root.y0=0,root.x1=dx,root.y1=dy,root.eachBefore(positionNode),paddingStack=[0],round&&root.eachBefore(roundNode),root}function positionNode(node){var p=paddingStack[node.depth],x0=node.x0+p,y0=node.y0+p,x1=node.x1-p,y1=node.y1-p;x1<x0&&(x0=x1=(x0+x1)/2),y1<y0&&(y0=y1=(y0+y1)/2),node.x0=x0,node.y0=y0,node.x1=x1,node.y1=y1,node.children&&(p=paddingStack[node.depth+1]=paddingInner(node)/2,x0+=paddingLeft(node)-p,y0+=paddingTop(node)-p,x1-=paddingRight(node)-p,y1-=paddingBottom(node)-p,x1<x0&&(x0=x1=(x0+x1)/2),y1<y0&&(y0=y1=(y0+y1)/2),tile(node,x0,y0,x1,y1))}return treemap.round=function(x){return arguments.length?(round=!!x,treemap):round},treemap.size=function(x){return arguments.length?(dx=+x[0],dy=+x[1],treemap):[dx,dy]},treemap.tile=function(x){return arguments.length?(tile=required(x),treemap):tile},treemap.padding=function(x){return arguments.length?treemap.paddingInner(x).paddingOuter(x):treemap.paddingInner()},treemap.paddingInner=function(x){return arguments.length?(paddingInner="function"==typeof x?x:constant$4(+x),treemap):paddingInner},treemap.paddingOuter=function(x){return arguments.length?treemap.paddingTop(x).paddingRight(x).paddingBottom(x).paddingLeft(x):treemap.paddingTop()},treemap.paddingTop=function(x){return arguments.length?(paddingTop="function"==typeof x?x:constant$4(+x),treemap):paddingTop},treemap.paddingRight=function(x){return arguments.length?(paddingRight="function"==typeof x?x:constant$4(+x),treemap):paddingRight},treemap.paddingBottom=function(x){return arguments.length?(paddingBottom="function"==typeof x?x:constant$4(+x),treemap):paddingBottom},treemap.paddingLeft=function(x){return arguments.length?(paddingLeft="function"==typeof x?x:constant$4(+x),treemap):paddingLeft},treemap},exports.treemapBinary=function(parent,x0,y0,x1,y1){var i,sum,nodes=parent.children,n=nodes.length,sums=new Array(n+1);for(sums[0]=sum=i=0;i<n;++i)sums[i+1]=sum+=nodes[i].value;!function partition(i,j,value,x0,y0,x1,y1){if(i>=j-1){var node=nodes[i];return node.x0=x0,node.y0=y0,node.x1=x1,void(node.y1=y1)}for(var valueOffset=sums[i],valueTarget=value/2+valueOffset,k=i+1,hi=j-1;k<hi;){var mid=k+hi>>>1;sums[mid]<valueTarget?k=mid+1:hi=mid}valueTarget-sums[k-1]<sums[k]-valueTarget&&i+1<k&&--k;var valueLeft=sums[k]-valueOffset,valueRight=value-valueLeft;if(x1-x0>y1-y0){var xk=(x0*valueRight+x1*valueLeft)/value;partition(i,k,valueLeft,x0,y0,xk,y1),partition(k,j,valueRight,xk,y0,x1,y1)}else{var yk=(y0*valueRight+y1*valueLeft)/value;partition(i,k,valueLeft,x0,y0,x1,yk),partition(k,j,valueRight,x0,yk,x1,y1)}}(0,n,parent.value,x0,y0,x1,y1)},exports.treemapDice=treemapDice,exports.treemapSlice=treemapSlice,exports.treemapSliceDice=function(parent,x0,y0,x1,y1){(1&parent.depth?treemapSlice:treemapDice)(parent,x0,y0,x1,y1)},exports.treemapSquarify=squarify,exports.treemapResquarify=resquarify,exports.interpolate=interpolateValue,exports.interpolateArray=array,exports.interpolateBasis=basis$1,exports.interpolateBasisClosed=basisClosed,exports.interpolateDate=date,exports.interpolateNumber=interpolateNumber,exports.interpolateObject=object,exports.interpolateRound=interpolateRound,exports.interpolateString=interpolateString,exports.interpolateTransformCss=interpolateTransformCss,exports.interpolateTransformSvg=interpolateTransformSvg,exports.interpolateZoom=interpolateZoom,exports.interpolateRgb=interpolateRgb,exports.interpolateRgbBasis=rgbBasis,exports.interpolateRgbBasisClosed=rgbBasisClosed,exports.interpolateHsl=hsl$2,exports.interpolateHslLong=hslLong,exports.interpolateLab=function(start,end){var l=nogamma((start=lab(start)).l,(end=lab(end)).l),a=nogamma(start.a,end.a),b=nogamma(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.l=l(t),start.a=a(t),start.b=b(t),start.opacity=opacity(t),start+""}},exports.interpolateHcl=hcl$2,exports.interpolateHclLong=hclLong,exports.interpolateCubehelix=cubehelix$2,exports.interpolateCubehelixLong=cubehelixLong,exports.quantize=function(interpolator,n){for(var samples=new Array(n),i=0;i<n;++i)samples[i]=interpolator(i/(n-1));return samples},exports.path=path,exports.creator=creator,exports.local=local,exports.matcher=matcher$1,exports.mouse=mouse,exports.namespace=namespace,exports.namespaces=namespaces,exports.clientPoint=point,exports.select=select,exports.selectAll=function(selector){return"string"==typeof selector?new Selection([document.querySelectorAll(selector)],[document.documentElement]):new Selection([null==selector?[]:selector],root)},exports.selection=selection,exports.selector=selector,exports.selectorAll=selectorAll,exports.style=styleValue,exports.touch=touch,exports.touches=function(node,touches){null==touches&&(touches=sourceEvent().touches);for(var i=0,n=touches?touches.length:0,points=new Array(n);i<n;++i)points[i]=point(node,touches[i]);return points},exports.window=defaultView,exports.customEvent=customEvent,exports.timeInterval=newInterval,exports.timeMillisecond=millisecond,exports.utcMillisecond=millisecond,exports.timeMilliseconds=milliseconds,exports.utcMilliseconds=milliseconds,exports.timeSecond=second,exports.utcSecond=second,exports.timeSeconds=seconds,exports.utcSeconds=seconds,exports.timeMinute=minute,exports.timeMinutes=minutes,exports.timeHour=hour,exports.timeHours=hours,exports.timeDay=day,exports.timeDays=days,exports.timeWeek=sunday,exports.timeSunday=sunday,exports.timeWeeks=sundays,exports.timeSundays=sundays,exports.timeMonday=monday,exports.timeMondays=mondays,exports.timeTuesday=tuesday,exports.timeTuesdays=tuesdays,exports.timeWednesday=wednesday,exports.timeWednesdays=wednesdays,exports.timeThursday=thursday,exports.timeThursdays=thursdays,exports.timeFriday=friday,exports.timeFridays=fridays,exports.timeSaturday=saturday,exports.timeSaturdays=saturdays,exports.timeMonth=month,exports.timeMonths=months,exports.timeYear=year,exports.timeYears=years,exports.utcMinute=utcMinute,exports.utcMinutes=utcMinutes,exports.utcHour=utcHour,exports.utcHours=utcHours,exports.utcDay=utcDay,exports.utcDays=utcDays,exports.utcWeek=utcSunday,exports.utcSunday=utcSunday,exports.utcWeeks=utcSundays,exports.utcSundays=utcSundays,exports.utcMonday=utcMonday,exports.utcMondays=utcMondays,exports.utcTuesday=utcTuesday,exports.utcTuesdays=utcTuesdays,exports.utcWednesday=utcWednesday,exports.utcWednesdays=utcWednesdays,exports.utcThursday=utcThursday,exports.utcThursdays=utcThursdays,exports.utcFriday=utcFriday,exports.utcFridays=utcFridays,exports.utcSaturday=utcSaturday,exports.utcSaturdays=utcSaturdays,exports.utcMonth=utcMonth,exports.utcMonths=utcMonths,exports.utcYear=utcYear,exports.utcYears=utcYears,exports.timeFormatDefaultLocale=defaultLocale$1,exports.timeFormatLocale=formatLocale$1,exports.isoFormat=formatIso,exports.isoParse=parseIso,exports.now=now,exports.timer=timer,exports.timerFlush=timerFlush,exports.timeout=timeout$1,exports.interval=function(callback,delay,time){var t=new Timer,total=delay;return null==delay?(t.restart(callback,delay,time),t):(delay=+delay,time=null==time?now():+time,t.restart(function tick(elapsed){elapsed+=total,t.restart(tick,total+=delay,time),callback(elapsed)},delay,time),t)},exports.transition=transition,exports.active=function(node,name){var schedule,i,schedules=node.__transition;if(schedules)for(i in name=null==name?null:name+"",schedules)if((schedule=schedules[i]).state>SCHEDULED&&schedule.name===name)return new Transition([[node]],root$1,name,+i);return null},exports.interrupt=interrupt,exports.zoom=function(){var touchstarting,touchending,filter=defaultFilter$2,extent=defaultExtent$1,constrain=defaultConstrain,wheelDelta=defaultWheelDelta,touchable=defaultTouchable$1,scaleExtent=[0,1/0],translateExtent=[[-1/0,-1/0],[1/0,1/0]],duration=250,interpolate=interpolateZoom,gestures=[],listeners=dispatch("start","zoom","end"),touchDelay=500,wheelDelay=150,clickDistance2=0;function zoom(selection){selection.property("__zoom",defaultTransform).on("wheel.zoom",wheeled).on("mousedown.zoom",mousedowned).on("dblclick.zoom",dblclicked).filter(touchable).on("touchstart.zoom",touchstarted).on("touchmove.zoom",touchmoved).on("touchend.zoom touchcancel.zoom",touchended).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function scale(transform,k){return(k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],k)))===transform.k?transform:new Transform(k,transform.x,transform.y)}function translate(transform,p0,p1){var x=p0[0]-p1[0]*transform.k,y=p0[1]-p1[1]*transform.k;return x===transform.x&&y===transform.y?transform:new Transform(transform.k,x,y)}function centroid(extent){return[(+extent[0][0]+ +extent[1][0])/2,(+extent[0][1]+ +extent[1][1])/2]}function schedule(transition,transform,center){transition.on("start.zoom",function(){gesture(this,arguments).start()}).on("interrupt.zoom end.zoom",function(){gesture(this,arguments).end()}).tween("zoom",function(){var args=arguments,g=gesture(this,args),e=extent.apply(this,args),p=center||centroid(e),w=Math.max(e[1][0]-e[0][0],e[1][1]-e[0][1]),a=this.__zoom,b="function"==typeof transform?transform.apply(this,args):transform,i=interpolate(a.invert(p).concat(w/a.k),b.invert(p).concat(w/b.k));return function(t){if(1===t)t=b;else{var l=i(t),k=w/l[2];t=new Transform(k,p[0]-l[0]*k,p[1]-l[1]*k)}g.zoom(null,t)}})}function gesture(that,args){for(var g,i=0,n=gestures.length;i<n;++i)if((g=gestures[i]).that===that)return g;return new Gesture(that,args)}function Gesture(that,args){this.that=that,this.args=args,this.index=-1,this.active=0,this.extent=extent.apply(that,args)}function wheeled(){if(filter.apply(this,arguments)){var g=gesture(this,arguments),t=this.__zoom,k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],t.k*Math.pow(2,wheelDelta.apply(this,arguments)))),p=mouse(this);if(g.wheel)g.mouse[0][0]===p[0]&&g.mouse[0][1]===p[1]||(g.mouse[1]=t.invert(g.mouse[0]=p)),clearTimeout(g.wheel);else{if(t.k===k)return;g.mouse=[p,t.invert(p)],interrupt(this),g.start()}noevent$2(),g.wheel=setTimeout(function(){g.wheel=null,g.end()},wheelDelay),g.zoom("mouse",constrain(translate(scale(t,k),g.mouse[0],g.mouse[1]),g.extent,translateExtent))}}function mousedowned(){if(!touchending&&filter.apply(this,arguments)){var g=gesture(this,arguments),v=select(exports.event.view).on("mousemove.zoom",function(){if(noevent$2(),!g.moved){var dx=exports.event.clientX-x0,dy=exports.event.clientY-y0;g.moved=dx*dx+dy*dy>clickDistance2}g.zoom("mouse",constrain(translate(g.that.__zoom,g.mouse[0]=mouse(g.that),g.mouse[1]),g.extent,translateExtent))},!0).on("mouseup.zoom",function(){v.on("mousemove.zoom mouseup.zoom",null),yesdrag(exports.event.view,g.moved),noevent$2(),g.end()},!0),p=mouse(this),x0=exports.event.clientX,y0=exports.event.clientY;dragDisable(exports.event.view),nopropagation$2(),g.mouse=[p,this.__zoom.invert(p)],interrupt(this),g.start()}}function dblclicked(){if(filter.apply(this,arguments)){var t0=this.__zoom,p0=mouse(this),p1=t0.invert(p0),k1=t0.k*(exports.event.shiftKey?.5:2),t1=constrain(translate(scale(t0,k1),p0,p1),extent.apply(this,arguments),translateExtent);noevent$2(),duration>0?select(this).transition().duration(duration).call(schedule,t1,p0):select(this).call(zoom.transform,t1)}}function touchstarted(){if(filter.apply(this,arguments)){var started,i,t,p,g=gesture(this,arguments),touches=exports.event.changedTouches,n=touches.length;for(nopropagation$2(),i=0;i<n;++i)p=[p=touch(this,touches,(t=touches[i]).identifier),this.__zoom.invert(p),t.identifier],g.touch0?g.touch1||(g.touch1=p):(g.touch0=p,started=!0);if(touchstarting&&(touchstarting=clearTimeout(touchstarting),!g.touch1))return g.end(),void((p=select(this).on("dblclick.zoom"))&&p.apply(this,arguments));started&&(touchstarting=setTimeout(function(){touchstarting=null},touchDelay),interrupt(this),g.start())}}function touchmoved(){var i,t,p,l,g=gesture(this,arguments),touches=exports.event.changedTouches,n=touches.length;for(noevent$2(),touchstarting&&(touchstarting=clearTimeout(touchstarting)),i=0;i<n;++i)p=touch(this,touches,(t=touches[i]).identifier),g.touch0&&g.touch0[2]===t.identifier?g.touch0[0]=p:g.touch1&&g.touch1[2]===t.identifier&&(g.touch1[0]=p);if(t=g.that.__zoom,g.touch1){var p0=g.touch0[0],l0=g.touch0[1],p1=g.touch1[0],l1=g.touch1[1],dp=(dp=p1[0]-p0[0])*dp+(dp=p1[1]-p0[1])*dp,dl=(dl=l1[0]-l0[0])*dl+(dl=l1[1]-l0[1])*dl;t=scale(t,Math.sqrt(dp/dl)),p=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2],l=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2]}else{if(!g.touch0)return;p=g.touch0[0],l=g.touch0[1]}g.zoom("touch",constrain(translate(t,p,l),g.extent,translateExtent))}function touchended(){var i,t,g=gesture(this,arguments),touches=exports.event.changedTouches,n=touches.length;for(nopropagation$2(),touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},touchDelay),i=0;i<n;++i)t=touches[i],g.touch0&&g.touch0[2]===t.identifier?delete g.touch0:g.touch1&&g.touch1[2]===t.identifier&&delete g.touch1;g.touch1&&!g.touch0&&(g.touch0=g.touch1,delete g.touch1),g.touch0?g.touch0[1]=this.__zoom.invert(g.touch0[0]):g.end()}return zoom.transform=function(collection,transform){var selection=collection.selection?collection.selection():collection;selection.property("__zoom",defaultTransform),collection!==selection?schedule(collection,transform):selection.interrupt().each(function(){gesture(this,arguments).start().zoom(null,"function"==typeof transform?transform.apply(this,arguments):transform).end()})},zoom.scaleBy=function(selection,k){zoom.scaleTo(selection,function(){return this.__zoom.k*("function"==typeof k?k.apply(this,arguments):k)})},zoom.scaleTo=function(selection,k){zoom.transform(selection,function(){var e=extent.apply(this,arguments),t0=this.__zoom,p0=centroid(e),p1=t0.invert(p0),k1="function"==typeof k?k.apply(this,arguments):k;return constrain(translate(scale(t0,k1),p0,p1),e,translateExtent)})},zoom.translateBy=function(selection,x,y){zoom.transform(selection,function(){return constrain(this.__zoom.translate("function"==typeof x?x.apply(this,arguments):x,"function"==typeof y?y.apply(this,arguments):y),extent.apply(this,arguments),translateExtent)})},zoom.translateTo=function(selection,x,y){zoom.transform(selection,function(){var e=extent.apply(this,arguments),t=this.__zoom,p=centroid(e);return constrain(identity$4.translate(p[0],p[1]).scale(t.k).translate("function"==typeof x?-x.apply(this,arguments):-x,"function"==typeof y?-y.apply(this,arguments):-y),e,translateExtent)})},Gesture.prototype={start:function(){return 1==++this.active&&(this.index=gestures.push(this)-1,this.emit("start")),this},zoom:function(key,transform){return this.mouse&&"mouse"!==key&&(this.mouse[1]=transform.invert(this.mouse[0])),this.touch0&&"touch"!==key&&(this.touch0[1]=transform.invert(this.touch0[0])),this.touch1&&"touch"!==key&&(this.touch1[1]=transform.invert(this.touch1[0])),this.that.__zoom=transform,this.emit("zoom"),this},end:function(){return 0==--this.active&&(gestures.splice(this.index,1),this.index=-1,this.emit("end")),this},emit:function(type){customEvent(new function(target,type,transform){this.target=target,this.type=type,this.transform=transform}(zoom,type,this.that.__zoom),listeners.apply,listeners,[type,this.that,this.args])}},zoom.wheelDelta=function(_){return arguments.length?(wheelDelta="function"==typeof _?_:constant$7(+_),zoom):wheelDelta},zoom.filter=function(_){return arguments.length?(filter="function"==typeof _?_:constant$7(!!_),zoom):filter},zoom.touchable=function(_){return arguments.length?(touchable="function"==typeof _?_:constant$7(!!_),zoom):touchable},zoom.extent=function(_){return arguments.length?(extent="function"==typeof _?_:constant$7([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),zoom):extent},zoom.scaleExtent=function(_){return arguments.length?(scaleExtent[0]=+_[0],scaleExtent[1]=+_[1],zoom):[scaleExtent[0],scaleExtent[1]]},zoom.translateExtent=function(_){return arguments.length?(translateExtent[0][0]=+_[0][0],translateExtent[1][0]=+_[1][0],translateExtent[0][1]=+_[0][1],translateExtent[1][1]=+_[1][1],zoom):[[translateExtent[0][0],translateExtent[0][1]],[translateExtent[1][0],translateExtent[1][1]]]},zoom.constrain=function(_){return arguments.length?(constrain=_,zoom):constrain},zoom.duration=function(_){return arguments.length?(duration=+_,zoom):duration},zoom.interpolate=function(_){return arguments.length?(interpolate=_,zoom):interpolate},zoom.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?zoom:value},zoom.clickDistance=function(_){return arguments.length?(clickDistance2=(_=+_)*_,zoom):Math.sqrt(clickDistance2)},zoom},exports.zoomTransform=transform,exports.zoomIdentity=identity$4,exports.polygonArea=function(polygon){for(var a,i=-1,n=polygon.length,b=polygon[n-1],area=0;++i<n;)a=b,b=polygon[i],area+=a[1]*b[0]-a[0]*b[1];return area/2},exports.polygonCentroid=function(polygon){for(var a,c,i=-1,n=polygon.length,x=0,y=0,b=polygon[n-1],k=0;++i<n;)a=b,b=polygon[i],k+=c=a[0]*b[1]-b[0]*a[1],x+=(a[0]+b[0])*c,y+=(a[1]+b[1])*c;return[x/(k*=3),y/k]},exports.polygonHull=function(points){if((n=points.length)<3)return null;var i,n,sortedPoints=new Array(n),flippedPoints=new Array(n);for(i=0;i<n;++i)sortedPoints[i]=[+points[i][0],+points[i][1],i];for(sortedPoints.sort(lexicographicOrder),i=0;i<n;++i)flippedPoints[i]=[sortedPoints[i][0],-sortedPoints[i][1]];var upperIndexes=computeUpperHullIndexes(sortedPoints),lowerIndexes=computeUpperHullIndexes(flippedPoints),skipLeft=lowerIndexes[0]===upperIndexes[0],skipRight=lowerIndexes[lowerIndexes.length-1]===upperIndexes[upperIndexes.length-1],hull=[];for(i=upperIndexes.length-1;i>=0;--i)hull.push(points[sortedPoints[upperIndexes[i]][2]]);for(i=+skipLeft;i<lowerIndexes.length-skipRight;++i)hull.push(points[sortedPoints[lowerIndexes[i]][2]]);return hull},exports.polygonContains=function(polygon,point){for(var x1,y1,n=polygon.length,p=polygon[n-1],x=point[0],y=point[1],x0=p[0],y0=p[1],inside=!1,i=0;i<n;++i)x1=(p=polygon[i])[0],(y1=p[1])>y!=y0>y&&x<(x0-x1)*(y-y1)/(y0-y1)+x1&&(inside=!inside),x0=x1,y0=y1;return inside},exports.polygonLength=function(polygon){for(var xa,ya,i=-1,n=polygon.length,b=polygon[n-1],xb=b[0],yb=b[1],perimeter=0;++i<n;)xa=xb,ya=yb,xa-=xb=(b=polygon[i])[0],ya-=yb=b[1],perimeter+=Math.sqrt(xa*xa+ya*ya);return perimeter},exports.geoArea=function(object){return areaSum.reset(),geoStream(object,areaStream),2*areaSum},exports.geoBounds=function(feature){var i,n,a,b,merged,deltaMax,delta;if(phi1=lambda1=-(lambda0$1=phi0=1/0),ranges=[],geoStream(feature,boundsStream),n=ranges.length){for(ranges.sort(rangeCompare),i=1,merged=[a=ranges[0]];i<n;++i)rangeContains(a,(b=ranges[i])[0])||rangeContains(a,b[1])?(angle(a[0],b[1])>angle(a[0],a[1])&&(a[1]=b[1]),angle(b[0],a[1])>angle(a[0],a[1])&&(a[0]=b[0])):merged.push(a=b);for(deltaMax=-1/0,i=0,a=merged[n=merged.length-1];i<=n;a=b,++i)b=merged[i],(delta=angle(a[1],b[0]))>deltaMax&&(deltaMax=delta,lambda0$1=b[0],lambda1=a[1])}return ranges=range=null,lambda0$1===1/0||phi0===1/0?[[NaN,NaN],[NaN,NaN]]:[[lambda0$1,phi0],[lambda1,phi1]]},exports.geoCentroid=centroid$1,exports.geoCircle=function(){var ring,rotate,center=constant$8([0,0]),radius=constant$8(90),precision=constant$8(6),stream={point:function(x,y){ring.push(x=rotate(x,y)),x[0]*=degrees$1,x[1]*=degrees$1}};function circle(){var c=center.apply(this,arguments),r=radius.apply(this,arguments)*radians,p=precision.apply(this,arguments)*radians;return ring=[],rotate=rotateRadians(-c[0]*radians,-c[1]*radians,0).invert,circleStream(stream,r,p,1),c={type:"Polygon",coordinates:[ring]},ring=rotate=null,c}return circle.center=function(_){return arguments.length?(center="function"==typeof _?_:constant$8([+_[0],+_[1]]),circle):center},circle.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant$8(+_),circle):radius},circle.precision=function(_){return arguments.length?(precision="function"==typeof _?_:constant$8(+_),circle):precision},circle},exports.geoClipAntimeridian=clipAntimeridian,exports.geoClipCircle=clipCircle,exports.geoClipExtent=function(){var cache,cacheStream,clip,x0=0,y0=0,x1=960,y1=500;return clip={stream:function(stream){return cache&&cacheStream===stream?cache:cache=clipRectangle(x0,y0,x1,y1)(cacheStream=stream)},extent:function(_){return arguments.length?(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1],cache=cacheStream=null,clip):[[x0,y0],[x1,y1]]}}},exports.geoClipRectangle=clipRectangle,exports.geoContains=function(object,point){return(object&&containsObjectType.hasOwnProperty(object.type)?containsObjectType[object.type]:containsGeometry)(object,point)},exports.geoDistance=distance,exports.geoGraticule=graticule,exports.geoGraticule10=function(){return graticule()()},exports.geoInterpolate=function(a,b){var x0=a[0]*radians,y0=a[1]*radians,x1=b[0]*radians,y1=b[1]*radians,cy0=cos$1(y0),sy0=sin$1(y0),cy1=cos$1(y1),sy1=sin$1(y1),kx0=cy0*cos$1(x0),ky0=cy0*sin$1(x0),kx1=cy1*cos$1(x1),ky1=cy1*sin$1(x1),d=2*asin$1(sqrt$1(haversin(y1-y0)+cy0*cy1*haversin(x1-x0))),k=sin$1(d),interpolate=d?function(t){var B=sin$1(t*=d)/k,A=sin$1(d-t)/k,x=A*kx0+B*kx1,y=A*ky0+B*ky1,z=A*sy0+B*sy1;return[atan2$1(y,x)*degrees$1,atan2$1(z,sqrt$1(x*x+y*y))*degrees$1]}:function(){return[x0*degrees$1,y0*degrees$1]};return interpolate.distance=d,interpolate},exports.geoLength=length$1,exports.geoPath=function(projection,context){var projectionStream,contextStream,pointRadius=4.5;function path(object){return object&&("function"==typeof pointRadius&&contextStream.pointRadius(+pointRadius.apply(this,arguments)),geoStream(object,projectionStream(contextStream))),contextStream.result()}return path.area=function(object){return geoStream(object,projectionStream(areaStream$1)),areaStream$1.result()},path.measure=function(object){return geoStream(object,projectionStream(lengthStream$1)),lengthStream$1.result()},path.bounds=function(object){return geoStream(object,projectionStream(boundsStream$1)),boundsStream$1.result()},path.centroid=function(object){return geoStream(object,projectionStream(centroidStream$1)),centroidStream$1.result()},path.projection=function(_){return arguments.length?(projectionStream=null==_?(projection=null,identity$5):(projection=_).stream,path):projection},path.context=function(_){return arguments.length?(contextStream=null==_?(context=null,new PathString):new PathContext(context=_),"function"!=typeof pointRadius&&contextStream.pointRadius(pointRadius),path):context},path.pointRadius=function(_){return arguments.length?(pointRadius="function"==typeof _?_:(contextStream.pointRadius(+_),+_),path):pointRadius},path.projection(projection).context(context)},exports.geoAlbers=albers,exports.geoAlbersUsa=function(){var cache,cacheStream,lower48Point,alaskaPoint,hawaiiPoint,point,lower48=albers(),alaska=conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),hawaii=conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),pointStream={point:function(x,y){point=[x,y]}};function albersUsa(coordinates){var x=coordinates[0],y=coordinates[1];return point=null,lower48Point.point(x,y),point||(alaskaPoint.point(x,y),point)||(hawaiiPoint.point(x,y),point)}function reset(){return cache=cacheStream=null,albersUsa}return albersUsa.invert=function(coordinates){var k=lower48.scale(),t=lower48.translate(),x=(coordinates[0]-t[0])/k,y=(coordinates[1]-t[1])/k;return(y>=.12&&y<.234&&x>=-.425&&x<-.214?alaska:y>=.166&&y<.234&&x>=-.214&&x<-.115?hawaii:lower48).invert(coordinates)},albersUsa.stream=function(stream){return cache&&cacheStream===stream?cache:(streams=[lower48.stream(cacheStream=stream),alaska.stream(stream),hawaii.stream(stream)],n=streams.length,cache={point:function(x,y){for(var i=-1;++i<n;)streams[i].point(x,y)},sphere:function(){for(var i=-1;++i<n;)streams[i].sphere()},lineStart:function(){for(var i=-1;++i<n;)streams[i].lineStart()},lineEnd:function(){for(var i=-1;++i<n;)streams[i].lineEnd()},polygonStart:function(){for(var i=-1;++i<n;)streams[i].polygonStart()},polygonEnd:function(){for(var i=-1;++i<n;)streams[i].polygonEnd()}});var streams,n},albersUsa.precision=function(_){return arguments.length?(lower48.precision(_),alaska.precision(_),hawaii.precision(_),reset()):lower48.precision()},albersUsa.scale=function(_){return arguments.length?(lower48.scale(_),alaska.scale(.35*_),hawaii.scale(_),albersUsa.translate(lower48.translate())):lower48.scale()},albersUsa.translate=function(_){if(!arguments.length)return lower48.translate();var k=lower48.scale(),x=+_[0],y=+_[1];return lower48Point=lower48.translate(_).clipExtent([[x-.455*k,y-.238*k],[x+.455*k,y+.238*k]]).stream(pointStream),alaskaPoint=alaska.translate([x-.307*k,y+.201*k]).clipExtent([[x-.425*k+epsilon$3,y+.12*k+epsilon$3],[x-.214*k-epsilon$3,y+.234*k-epsilon$3]]).stream(pointStream),hawaiiPoint=hawaii.translate([x-.205*k,y+.212*k]).clipExtent([[x-.214*k+epsilon$3,y+.166*k+epsilon$3],[x-.115*k-epsilon$3,y+.234*k-epsilon$3]]).stream(pointStream),reset()},albersUsa.fitExtent=function(extent,object){return fitExtent(albersUsa,extent,object)},albersUsa.fitSize=function(size,object){return fitSize(albersUsa,size,object)},albersUsa.fitWidth=function(width,object){return fitWidth(albersUsa,width,object)},albersUsa.fitHeight=function(height,object){return fitHeight(albersUsa,height,object)},albersUsa.scale(1070)},exports.geoAzimuthalEqualArea=function(){return projection(azimuthalEqualAreaRaw).scale(124.75).clipAngle(179.999)},exports.geoAzimuthalEqualAreaRaw=azimuthalEqualAreaRaw,exports.geoAzimuthalEquidistant=function(){return projection(azimuthalEquidistantRaw).scale(79.4188).clipAngle(179.999)},exports.geoAzimuthalEquidistantRaw=azimuthalEquidistantRaw,exports.geoConicConformal=function(){return conicProjection(conicConformalRaw).scale(109.5).parallels([30,30])},exports.geoConicConformalRaw=conicConformalRaw,exports.geoConicEqualArea=conicEqualArea,exports.geoConicEqualAreaRaw=conicEqualAreaRaw,exports.geoConicEquidistant=function(){return conicProjection(conicEquidistantRaw).scale(131.154).center([0,13.9389])},exports.geoConicEquidistantRaw=conicEquidistantRaw,exports.geoEqualEarth=function(){return projection(equalEarthRaw).scale(177.158)},exports.geoEqualEarthRaw=equalEarthRaw,exports.geoEquirectangular=function(){return projection(equirectangularRaw).scale(152.63)},exports.geoEquirectangularRaw=equirectangularRaw,exports.geoGnomonic=function(){return projection(gnomonicRaw).scale(144.049).clipAngle(60)},exports.geoGnomonicRaw=gnomonicRaw,exports.geoIdentity=function(){var y0,x1,y1,cache,cacheStream,projection,k=1,tx=0,ty=0,sx=1,sy=1,transform=identity$5,x0=null,postclip=identity$5;function reset(){return cache=cacheStream=null,projection}return projection={stream:function(stream){return cache&&cacheStream===stream?cache:cache=transform(postclip(cacheStream=stream))},postclip:function(_){return arguments.length?(postclip=_,x0=y0=x1=y1=null,reset()):postclip},clipExtent:function(_){return arguments.length?(postclip=null==_?(x0=y0=x1=y1=null,identity$5):clipRectangle(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]),reset()):null==x0?null:[[x0,y0],[x1,y1]]},scale:function(_){return arguments.length?(transform=scaleTranslate$1((k=+_)*sx,k*sy,tx,ty),reset()):k},translate:function(_){return arguments.length?(transform=scaleTranslate$1(k*sx,k*sy,tx=+_[0],ty=+_[1]),reset()):[tx,ty]},reflectX:function(_){return arguments.length?(transform=scaleTranslate$1(k*(sx=_?-1:1),k*sy,tx,ty),reset()):sx<0},reflectY:function(_){return arguments.length?(transform=scaleTranslate$1(k*sx,k*(sy=_?-1:1),tx,ty),reset()):sy<0},fitExtent:function(extent,object){return fitExtent(projection,extent,object)},fitSize:function(size,object){return fitSize(projection,size,object)},fitWidth:function(width,object){return fitWidth(projection,width,object)},fitHeight:function(height,object){return fitHeight(projection,height,object)}}},exports.geoProjection=projection,exports.geoProjectionMutator=projectionMutator,exports.geoMercator=function(){return mercatorProjection(mercatorRaw).scale(961/tau$3)},exports.geoMercatorRaw=mercatorRaw,exports.geoNaturalEarth1=function(){return projection(naturalEarth1Raw).scale(175.295)},exports.geoNaturalEarth1Raw=naturalEarth1Raw,exports.geoOrthographic=function(){return projection(orthographicRaw).scale(249.5).clipAngle(90+epsilon$3)},exports.geoOrthographicRaw=orthographicRaw,exports.geoStereographic=function(){return projection(stereographicRaw).scale(250).clipAngle(142)},exports.geoStereographicRaw=stereographicRaw,exports.geoTransverseMercator=function(){var m=mercatorProjection(transverseMercatorRaw),center=m.center,rotate=m.rotate;return m.center=function(_){return arguments.length?center([-_[1],_[0]]):[(_=center())[1],-_[0]]},m.rotate=function(_){return arguments.length?rotate([_[0],_[1],_.length>2?_[2]+90:90]):[(_=rotate())[0],_[1],_[2]-90]},rotate([0,0,90]).scale(159.155)},exports.geoTransverseMercatorRaw=transverseMercatorRaw,exports.geoRotation=rotation,exports.geoStream=geoStream,exports.geoTransform=function(methods){return{stream:transformer(methods)}},exports.quadtree=quadtree,Object.defineProperty(exports,"__esModule",{value:!0})}),function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory((global=global||self).$ZC={})}(this,function(exports){var axis=function(){},legend=function(){},scale$1=function(){},events=function(){},plot=function(){};plot.canvas=function(){};var zmaps=function(){},charttype={},line=charttype.line=11,pie=charttype.pie=8,bar=charttype.bar=9,stkdbar=charttype.stkdbar=10,scatter=charttype.scatter=12,area=charttype.area=14,stkdarea=charttype.stkdarea=15,bubble=charttype.bubble=20,packedbubble=charttype.packedbubble=19,funnel=charttype.funnel=7,web=charttype.web=16,sunburst=charttype.sunburst=17,pyramid=charttype.pyramid=13,dial=charttype.dial=18,bullet=charttype.bullet=6,arearange=charttype.arearange=21,bubblepie=charttype.bubblepie=5,gantt=charttype.gantt=24,treemap=charttype.treemap=4,heatmap=charttype.heatmap=3,dotgrid=charttype.dotgrid=26,waterfall=charttype.waterfall=27,wordcloud=charttype.wordcloud=2,geoheatmap=charttype.geoheatmap=30,geoscatter=charttype.geoscatter=31,geobubble=charttype.geobubble=32,geobubblepie=charttype.geobubblepie=33,charttypenames=d3.map();charttypenames.set(charttype.line,"line"),charttypenames.set(charttype.pie,"pie"),charttypenames.set(charttype.bar,"bar"),charttypenames.set(charttype.stkdbar,"bar"),charttypenames.set(charttype.scatter,"scatter"),charttypenames.set(charttype.area,"area"),charttypenames.set(charttype.funnel,"funnel"),charttypenames.set(charttype.web,"web"),charttypenames.set(charttype.stkdarea,"area"),charttypenames.set(charttype.sunburst,"sunburst"),charttypenames.set(charttype.pyramid,"pyramid"),charttypenames.set(charttype.bubble,"bubble"),charttypenames.set(charttype.dial,"dial"),charttypenames.set(charttype.packedbubble,"packedbubble"),charttypenames.set(charttype.bullet,"bullet"),charttypenames.set(charttype.arearange,"arearange"),charttypenames.set(charttype.gantt,"gantt"),charttypenames.set(charttype.bubblepie,"bubblepie"),charttypenames.set(charttype.treemap,"treemap"),charttypenames.set(charttype.heatmap,"heatmap"),charttypenames.set(charttype.dotgrid,"dotgrid"),charttypenames.set(charttype.waterfall,"waterfall"),charttypenames.set(charttype.wordcloud,"wordcloud"),charttypenames.set(charttype.geoheatmap,"geoheatmap"),charttypenames.set(charttype.geoscatter,"geoscatter"),charttypenames.set(charttype.geobubble,"geobubble"),charttypenames.set(charttype.geobubblepie,"geobubblepie");var chartcategory={};chartcategory.axis=[line,area,scatter,stkdarea,bar,stkdbar,bubble,bullet,arearange,bubblepie,gantt,heatmap,waterfall],chartcategory.nonaxis=[pie,funnel,pyramid,dial,dotgrid],chartcategory.nonaxismultiseries=[web,sunburst,packedbubble,treemap,wordcloud],chartcategory.hierarchy=[packedbubble,sunburst,treemap],chartcategory.continous=[line,area,scatter,stkdarea,bubble,arearange,bubblepie],chartcategory.discrete=[pie,bar,stkdbar,sunburst,funnel,pyramid,dial,bullet,gantt,heatmap,waterfall],chartcategory.dotPlot=[scatter,bubble,geoscatter,geobubble],chartcategory.piePlot=[pie,bubblepie,geobubblepie],chartcategory.zaxis=[bubble,bubblepie,heatmap,geoheatmap,geobubble,geobubblepie],chartcategory.svgOnly=[pie,funnel,pyramid,dial,sunburst,packedbubble,bubblepie,gantt,waterfall,geobubblepie],chartcategory.geo=[geoheatmap,geoscatter,geobubble,geobubblepie],chartcategory.bubble=d3.set([bubble,geobubble]),chartcategory.bubblePie=d3.set([bubblepie,geobubblepie]),chartcategory.innerLabels=[pie,funnel,pyramid,sunburst,bubblepie,geobubblepie],chartcategory.datalabelsInside=[packedbubble,heatmap,treemap,geoheatmap],chartcategory.parentLabels=[treemap,sunburst];var viewCount,UNDEFINED,svg_plot_renderer={},renderer_helpers={},dataLabel_handler={},labelRenderer=function(){},datalabelsBoundBox_handler={},CUSTOM_VALUE_PATTERN=/\{\{val\((\d+)\)\}\}|\{\{col\((\d+)\)\}\}|\{\{per\((\d+)\)\}\}|\{\{splitper\((\d+)\)\}\}|\{\{maxper\((\d+)\)\}\}|\{\{geo\(([a-z0-9\-\_]+)\)\}\}|\{\{clr\}\}/gi,RGBA_PATTERN=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/i,PERCENT_PATTERN=/\{\{per\((\d+)\)\}\}|\{\{splitper\((\d+)\)\}\}|\{\{maxper\((\d+)\)\}\}/gi,HIGHLIGHT_EFFECT_REGEX=/(illuminate|moody|flip|boxShadow|invert|ridge)/,UNHIGHLIGHT_EFFECT_REGEX=/(fadeOut|blur|grayscale|saturate)/,Console=window.console,tempCanvasContext=document.createElement("canvas").getContext("2d"),getDocumentWindow=function(node){return node&&node.document?node.document:window},_imageFilePath=window.location.protocol+"//"+window.location.hostname+"/src/images/",fontProperties={minsize:15,maxsize:40,ratio:.038},_requireXDataSorting=!1,_dataEncoded=!1,math=Math,mathRound=math.round,mathFloor=math.floor,mathCeil=math.ceil,mathMax=math.max,mathMin=math.min,mathAbs=math.abs,mathPow=math.pow,mathSQRT=math.sqrt,mathCos=math.cos,mathSin=math.sin,mathLog=math.log,mathTan=math.tan,mathAtan2=math.atan2,mathLN10=math.LN10,mathRandom=math.random,mathPI=math.PI,deg2rad=2*mathPI/360,MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER||9007199254740991,PX="px ",NONE="none",TRANSPARENT="transparent",POINTER="pointer",NULL=null,DOCUMENT_OBJECT_HOLDER=[],DEVICE_PIXEL_RATIO=getDocumentWindow().devicePixelRatio||1;function rebindMethods(target,source,method){return function(){var value=method.apply(source,arguments);return value===source?target:value}}d3.rebind=function(target,source){for(var method,i=1,n=arguments.length;++i<n;)target[method=arguments[i]]=rebindMethods(target,source,source[method]);return target},function(d3){d3.quadtree.prototype.findAll=function(x,y,radius){var points={points:[],visited:[]};return this._r=this._r||function(){return 0},this.visit(function(mouse,radius,hits,visits,tree){var r=radius,nx1=mouse.x-r,nx2=mouse.x+r,ny1=mouse.y-r,ny2=mouse.y+r;return function(quad,x1,y1,x2,y2){if(!quad.length){visits.push(quad.data);do{if(quad.data){var x=mouse.x-tree._x(quad.data),y=mouse.y-tree._y(quad.data),l=mathSQRT(x*x+y*y)-tree._r(quad.data);l<radius&&hits.push(quad.data)}}while(quad=quad.next)}return x1>nx2||x2<nx1||y1>ny2||y2<ny1}}({x:x,y:y},radius,points.points,points.visited,this)),points},d3.quadtree.prototype.radius=function(radiusController){return isFunction(radiusController)&&(this._r=radiusController),this}}(d3);var serializeXML,btoa=window.btoa||function(input){input=String(input);var o1,o2,o3,e1,e2,e3,e4,B64_ALPHABET="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",position=0,out=[];if(/[^\x00-\xFF]/.test(input))throw Error("InvalidCharacterError");for(;position<input.length;)e1=(o1=input.charCodeAt(position++))>>2,e2=(3&o1)<<4|(o2=input.charCodeAt(position++))>>4,e3=(15&o2)<<2|(o3=input.charCodeAt(position++))>>6,e4=63&o3,position===input.length+2?(e3=64,e4=64):position===input.length+1&&(e4=64),out.push(B64_ALPHABET.charAt(e1),B64_ALPHABET.charAt(e2),B64_ALPHABET.charAt(e3),B64_ALPHABET.charAt(e4));return out.join("")};serializeXML=function(node,output){var nodeType=node.nodeType;if(3==nodeType)output.push(node.textContent.replace(/&/,"&amp;").replace(/</,"&lt;").replace(">","&gt;"));else if(1==nodeType){if(output.push("<",node.tagName),node.hasAttributes())for(var attrMap=node.attributes,i=0,len=attrMap.length;i<len;++i){var attrNode=attrMap.item(i);output.push(" ",attrNode.name,"='",attrNode.value,"'")}if(node.hasChildNodes()){output.push(">");var childNodes=node.childNodes;for(i=0,len=childNodes.length;i<len;++i)serializeXML(childNodes.item(i),output);output.push("</",node.tagName,">")}else output.push("/>")}else{if(8!=nodeType)throw"Error serializing XML. Unhandled node of type: "+nodeType;output.push("\x3c!--",node.nodeValue,"--\x3e")}},Object.defineProperty(SVGElement.prototype,"innerHTML",{get:function(){for(var output=[],childNode=this.firstChild;childNode;)serializeXML(childNode,output),childNode=childNode.nextSibling;return output.join("")},set:function(markupText){for(;this.firstChild;)this.removeChild(this.firstChild);try{var dXML=new DOMParser;dXML.async=!1;for(var sXML="<svg xmlns='http://www.w3.org/2000/svg'>"+markupText+"</svg>",childNode=dXML.parseFromString(sXML,"text/xml").documentElement.firstChild;childNode;)this.appendChild(this.ownerDocument.importNode(childNode,!0)),childNode=childNode.nextSibling}catch(e){throw new Error("Error parsing XML string")}}}),Object.defineProperty(SVGElement.prototype,"innerSVG",{get:function(){return this.innerHTML},set:function(markupText){this.innerHTML=markupText}}),function(){try{document.createElement("div").style.setProperty("opacity",0,"")}catch(error){var element_prototype=window.Element.prototype,element_setAttribute=element_prototype.setAttribute,element_setAttributeNS=element_prototype.setAttributeNS,style_setProperty=window.CSSStyleDeclaration.prototype.setProperty;element_prototype.setAttribute=function(name,value){element_setAttribute.call(this,name,value+"")},element_prototype.setAttributeNS=function(space,local,value){element_setAttributeNS.call(this,space,local,value+"")},window.CSSStyleDeclaration.prototype.setProperty=function(name,value,priority){style_setProperty.call(this,name,value+"",priority)}}}();var TEXT_ELEMENT="text",TSPAN_ELEMENT="tspan",PATH_ELEMENT="path",CIRCLE_ELEMENT="circle",LINE_ELEMENT="line",$ZCG={};function calculateGlobalFontSize(userdata,globalFontSize,chartFontSize,denominator){for(var fontSize,n,props=toArray(arguments).slice(4),temp=null,i=0,len=props.length;i<len+1&&(temp=calcfontSize(denominator,null,fontSize=i===len?null:getPropVal(userdata,props[i]),globalFontSize,chartFontSize),"number"!=typeof(n=fontSize)||isNaN(n));i++);return temp}function setGlobalPropByUserdata(userdata,denominator,chartProp){$ZCG.globalProp={},chartProp.fontL1Size=calculateGlobalFontSize(userdata,$ZCG.fontL1Size,chartProp.fontL1Size,denominator,"canvas.fontSize"),chartProp.fontL2Size=calculateGlobalFontSize(userdata,$ZCG.fontL2Size,chartProp.fontL2Size,denominator,"chart.fontSize","canvas.fontSize"),$ZCG.globalProp.fontL1Color=null,$ZCG.globalProp.fontL2Color=null,$ZCG.globalProp.fontL1Family=null,$ZCG.globalProp.fontL2Family=null,$ZCG.globalProp.fontL1Style=null,$ZCG.globalProp.fontL2Style=null,$ZCG.globalProp.fontL1Weight=null,$ZCG.globalProp.fontL2Weight=null,$ZCG.globalProp.textShadow=null;var userAnimation=pick(getPropVal(userdata,"chart.plot.animation"),{});return $ZCG.globalProp.animation={},$ZCG.globalProp.animation.enabled=!1!==userAnimation.enabled,$ZCG.globalProp.animation.duration=userAnimation.duration||null,$ZCG.globalProp.animation.easingType=userAnimation.easingType||null,$ZCG.globalProp.datalabels={},chartProp.datalabels=null==chartProp.datalabels?{}:chartProp.datalabels,$ZCG.globalProp.datalabels.enabled=null,chartProp.datalabels.fontSize=calculateGlobalFontSize(userdata,$ZCG.fontL3Size,chartProp.datalabels.fontSize,denominator,"chart.plot.datalabels.fontSize","chart.fontSize","canvas.fontSize"),$ZCG.globalProp.datalabels.fontColor=null,$ZCG.globalProp.datalabels.fontFamily=null,$ZCG.globalProp.datalabels.fontStyle=null,$ZCG.globalProp.datalabels.fontWeight=null,$ZCG.globalProp.events={},$ZCG.globalProp.events.mouseMove=null,$ZCG.globalProp.events.mouseOut=null,$ZCG.globalProp.events.click=null,$ZCG.globalProp.events.doubleClick=null,chartProp}function calcfontSize(dimension,multiplier,customFontSize,globalFontSize,chartFontProp){var denominator=mathMin(dimension.width,dimension.height),globalMultiplier=isObjectPropDefined(fontProperties,"ratio")&&fontProperties.ratio;"function"==typeof globalMultiplier&&(globalMultiplier=globalMultiplier(dimension)),multiplier=null==multiplier?globalMultiplier&&!isNaN(globalMultiplier)?globalMultiplier:.038:multiplier;var defaultSize=mathRound(denominator*multiplier);$ZCG.minL1Size=fontProperties.minsize,$ZCG.maxL1Size=fontProperties.maxsize;var min=$ZCG.minL1Size,max=$ZCG.maxL1Size;return defaultSize=defaultSize<min?min:defaultSize>max?max:defaultSize,null!=customFontSize&&(multiplier=pInt(customFontSize)*multiplier/defaultSize,defaultSize=(defaultSize=mathRound(denominator*multiplier))<min?min:defaultSize>max?max:defaultSize),(chartFontProp=null==globalFontSize?null==chartFontProp?{}:chartFontProp:globalFontSize).size=defaultSize,chartFontProp.l1=function(){return chartFontProp.size},chartFontProp.l2=function(){return chartFontProp.size-2},chartFontProp.l3=function(){return chartFontProp.size-3},chartFontProp.l4=function(){return chartFontProp.size-4},chartFontProp.l5=function(){return chartFontProp.size-5},chartFontProp}$ZCG.fontFamily="'Roboto','Open Sans',sans-serif",$ZCG.fontColor="#616161",$ZCG.fontStyle=null,$ZCG.fontWeight=null,$ZCG.fontL1Size=null,$ZCG.fontL2Size=null,$ZCG.fontL3Size=null,$ZCG.DOMBorder="none";var $Browser=new function(){this.NETSCAPE=0,this.FIREFOX=0,this.OPERA=0,this.IE=0,this.SAFARI=0,this.MOZILA=0,this.CHROME=0,this.NONIE=1,this.WEBKIT=0;var agent=navigator.userAgent.toLowerCase();this.OSX=-1!=agent.indexOf("mac"),this.LINUX=-1!=agent.indexOf("linux"),this.IPHONE=-1!=agent.indexOf("iphone"),this.IPAD=-1!=agent.indexOf("ipad"),this.ANDROID=-1!=agent.indexOf("android"),this.IS_IOS=this.IPHONE||this.IPAD,this.isTouchDevice="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,this.isMouseDevice=!(this.IS_IOS||this.ANDROID||-1!=agent.indexOf("mobile")),this.uiwebview=this.IS_IOS&&!/safari/.test(agent),this.PHANTOMJS=-1!==agent.indexOf("phantomjs");var prefix="";this.detect=function(){var agent=navigator.userAgent,uaLen=agent.length,vendor=navigator.vendor,versionSub="";window.opera?(this.OPERA=1,prefix="o"):agent.indexOf("Chrome")>-1?(this.CHROME=1,versionSub="Chrome/",prefix="webkit"):agent.indexOf("Firefox")>-1?(this.FIREFOX=1,versionSub="Firefox/",prefix="moz"):agent.indexOf("MSIE ")>-1||agent.indexOf("Trident/")>-1?(this.IE=1,versionSub="MSIE ",prefix="ms"):vendor.indexOf("Apple")>-1?(this.SAFARI=1,versionSub="Version/",prefix="webkit"):versionSub="Unknown Browser",this.VERSION=agent.substring(agent.indexOf(versionSub),uaLen).match(/[0-9\.]+/)[0]},this.detect(),this.NONIE=!this.IE,this.WEBKIT=this.SAFARI||this.CHROME,this.prefix={lowercase:prefix,css:prefix?"-"+prefix+"-":prefix,js:prefix?prefix[0].toUpperCase()+prefix.substr(1):prefix}};var tiles,curves,easingTypes,d3AxisOrients,d3$1=window.d3,d3_select=d3$1.select,d3_selectAll=d3$1.selectAll,d3_min=d3$1.min,d3_max=d3$1.max,d3_axis=(d3AxisOrients={top:d3$1.axisTop,bottom:d3$1.axisBottom,left:d3$1.axisLeft,right:d3$1.axisRight},function(orient,scale){return d3AxisOrients[orient](scale)}),d3_ease=(easingTypes={linear:d3$1.easeLinear,quad:d3$1.easeQuad,"quad-in-out":d3$1.easeQuadInOut,"quad-in":d3$1.easeQuadIn,"quad-out":d3$1.easeQuadOut,cubic:d3$1.easeCubic,"cubic-in-out":d3$1.easeCubicInOut,"cubic-in":d3$1.easeCubicIn,"cubic-out":d3$1.easeCubicOut,sin:d3$1.easeSin,"sin-in-out":d3$1.easeSinInOut,"sin-in":d3$1.easeSinIn,"sin-out":d3$1.easeSinOut,exp:d3$1.easeExp,"exp-in-out":d3$1.easeExpInOut,"exp-in":d3$1.easeExpIn,"exp-out":d3$1.easeExpOut,circle:d3$1.easeCircle,"circle-in-out":d3$1.easeCircleInOut,"circle-in":d3$1.easeCircleIn,"circle-out":d3$1.easeCircleOut,elastic:d3$1.easeElastic,"elastic-in-out":d3$1.easeElasticInOut,"elastic-in":d3$1.easeElasticIn,"elastic-out":d3$1.easeElasticOut,back:d3$1.easeBack,"back-in-out":d3$1.easeBackInOut,"back-in":d3$1.easeBackIn,"back-out":d3$1.easeBackOut,bounce:d3$1.easeBounce,"bounce-in-out":d3$1.easeBounceInOut,"bounce-in":d3$1.easeBounceIn,"bounce-out":d3$1.easeBounceOut},function(type){return easingTypes[type]||d3$1.easeLinear}),d3_ease_linear=d3$1.easeLinear,d3_curves=(curves={linear:d3$1.curveLinear,linearClosed:d3$1.curveLinearClosed,cardinal:d3$1.curveCardinal,cardinalClosed:d3$1.curveCardinalClosed,monotone:d3$1.curveMonotoneX,monotoneY:d3$1.curveMonotoneY,stepBefore:d3$1.curveStepBefore,stepAfter:d3$1.curveStepAfter,"linear-closed":d3$1.curveLinearClosed,"cardinal-closed":d3$1.curveCardinalClosed,"step-before":d3$1.curveStepBefore,"step-after":d3$1.curveStepAfter},function(interpolator,rotated,tension){var curve=curves[interpolator];return"monotone"==interpolator&&rotated&&(curve=curves.monotoneY),void 0!==tension&&null!==tension&&curve.tension&&curve.tension(tension),curve}),d3_tiles=(tiles={squarify:d3$1.treemapSquarify,slice:d3$1.treemapSlice,dice:d3$1.treemapDice,sliceDice:d3$1.treemapSliceDice,resquarify:d3$1.treemapResquarify},function(mode){return tiles[mode]||tiles.squarify}),d3_scaleLinear=(d3$1.rebind,function(){var scale1=d3$1.scaleLinear();return scale1.ticks=function(count){var d=this.domain();return d3$1.ticks(d[0],d[d.length-1],null==count?10:count)},scale1}),d3_scaleOrdinal=d3$1.scaleBand,d3_scaleTime=d3$1.scaleTime,d3_scalePoint=d3$1.scalePoint,d3_scaleOrdinalOrg=d3$1.scaleOrdinal,d3_bisector=d3$1.bisector,d3_sum=d3$1.sum,d3_hsl=d3$1.hsl,d3_rgb=function(){var rgb=d3$1.rgb.apply(this,arguments);return(isNaN(rgb.r)||isNaN(rgb.g)||isNaN(rgb.b))&&(rgb=d3$1.rgb(0,0,0,rgb.opacity)),rgb},d3_merge=d3$1.merge,d3_map=d3$1.map,d3_set=d3$1.set,d3_drag=(d3$1.zoom,d3$1.drag),d3_extent=d3$1.extent,d3_dispatch=d3$1.dispatch,d3_ascending=d3$1.ascending,d3_descending=d3$1.descending,d3_line=d3$1.line,d3_lineRadial=d3$1.radialLine,d3_area=d3$1.area,d3_areaRadial=d3$1.radialArea,d3_arc=d3$1.arc,d3_pack=d3$1.pack,d3_pie=d3$1.pie,d3_partition=d3$1.partition,d3_treemap=d3$1.treemap,d3_mouse=(d3$1.transform,function(node){if($Browser.FIREFOX){node=node.ownerSVGElement||node;for(var source,event=d3$1.event,rect=node.getBoundingClientRect();source=event.sourceEvent;)event=source;return event.changedTouches&&(event=event.changedTouches[0]),[event.clientX-rect.left-node.clientLeft,event.clientY-rect.top-node.clientTop]}return d3$1.mouse.apply(this,arguments)}),d3_interpolate=d3$1.interpolate,d3_interpolateRgb=d3$1.interpolateRgb,d3_range=d3$1.range,d3_timeSunday=d3$1.timeSunday,d3_timeMonday=d3$1.timeMonday,d3_timeTuesday=d3$1.timeTuesday,d3_timeWednesday=d3$1.timeWednesday,d3_timeThursday=d3$1.timeThursday,d3_timeFriday=d3$1.timeFriday,d3_timeSaturday=d3$1.timeSaturday,d3_timeSeconds=d3$1.timeSeconds,d3_timeHours=(d3$1.timeMinutes,d3$1.timeHours),d3_timeDays=d3$1.timeDays,d3_timeWeeks=d3$1.timeWeeks,d3_timeMonths=d3$1.timeMonths,d3_timeYears=d3$1.timeYears,d3_format=d3$1.format,d3_timeFormat=d3$1.timeFormat,d3_timeFormatUTC=d3$1.utcFormat,d3_timeParse=d3$1.timeParse,d3_brushX=(d3$1.xhr,d3$1.json,d3$1.timer,d3$1.brushX),d3_brushY=d3$1.brushY,topojson=d3$1.topojson,utils=(d3$1.versor,function(){});function drawBorderBox(element,properties){element.attr("x",properties.left).attr("y",properties.top).attr("width",properties.width).attr("height",properties.height).style("fill-opacity",0).style("stroke",TRANSPARENT)}utils.getActualTextBounds=function(fontSize,width,rotation){width=width;var height=fontSize,radian=rotation*(2*mathPI/360),bbox={};return bbox.width=mathAbs(height*mathSin(radian))+mathAbs(width*mathCos(radian)),bbox.height=mathAbs(height*mathCos(radian))+mathAbs(width*mathSin(radian)),bbox};var mergeJSON=utils.mergeJSON=function(source1,source2,mergeConflicts,mergeIntoExists){source1=source1||{},source2=source2||{};var mergedJSON=null!=mergeIntoExists&&1==mergeIntoExists?source1:simpleClone(source1);for(var attrname in source2)source2.hasOwnProperty(attrname)&&(void 0!=mergedJSON[attrname]?null==source2[attrname]||source2[attrname].constructor!=Object&&source2[attrname].constructor!=Array?1==mergeConflicts&&"object"==typeof mergedJSON&&(mergedJSON[attrname]=source2[attrname]):mergedJSON[attrname]=mergeJSON(mergedJSON[attrname],source2[attrname],mergeConflicts,mergeIntoExists):mergedJSON[attrname]=source2[attrname]);return mergedJSON};function generateIdByPropValue(properties,name){if(null==properties||properties.constructor!=Object)return null!=name?name:void 0;var val,id="";for(var prop in properties)properties.hasOwnProperty(prop)&&((val=properties[prop])&&val.constructor===Object&&(val=jsonStringify(val)),id+=null==val||""==val?"$$":val+"_");return id=(id=(id=name+id).replace(/[.-]/g,"_")).replace(/[`~!@#$%^&*( )|+\-=?;:'",.<>{}[\]\\/\s]/gi,"_")}function getMonochromeColor(baseClr,domain,range){var hsl=d3_hsl(baseClr),interpolateClr=d3_scaleLinear().domain([-1,0,1]).range([d3_hsl(hsl.h,hsl.s,.1),hsl,d3_hsl(hsl.h,hsl.s,.9)]).interpolate(d3_interpolateRgb),clrScale=d3_scaleLinear().domain(domain).range(range);return function(clr){return interpolateClr(clrScale(clr))}}function bbox(ele){return ele&&(ele.isD3Selection&&(ele=ele.node()),isElementVisible(ele))?ele.getBBox():{x:0,y:0,height:0,width:0}}utils.getValueOfPlotOptions=function(obj1,obj2){return function(key){return null!=obj1&&null!=obj1[key]?obj1[key]:null!=obj2&&null!=obj2[key]?obj2[key]:null}},utils.getVal=function(value,args){return"function"==typeof value?value.apply(null,args):value};var simpleClone=utils.simpleClone=function(o){var k,copy=o;if(o&&"object"==typeof o)for(k in copy=isArray(o)?[]:{},o)copy[k]=simpleClone(o[k]);return copy};function decodeHTML(text){if(!_dataEncoded||null==text)return text;var tempDiv=document.createElement("div");tempDiv.innerHTML=encodeURI(text);var decodedText=tempDiv.textContent;return decodeURI(decodedText)}function encodeHTML(text){if(_dataEncoded||null==text)return text;var tempDiv=document.createElement("div");return tempDiv.textContent=decodeHTML(text),tempDiv.innerHTML}function d3_values(map){return map.slice(0)}function getDefsLocation(){return d3_selectAll("base").node()?location.href.split(location.search||location.hash||/[?#]/)[0]:""}function isObjectPropDefined(obj,key,self){var keySet=key.replace(/\[(\w+)\]/g,".$1"),childObj=(keySet=keySet.replace(/^\./,"")).split(".").reduce(function(o,x){return defined(o)?o[x]:o},obj);return self?childObj:defined(childObj)}function isUndefined(variable){return!defined(variable)}function toArray(objectLikeArray){return Array.prototype.slice.call(objectLikeArray)}function invokeFunction(){var args=toArray(arguments),advanced=!0===args[0]&&args.shift(),callback=args.shift();if("string"==typeof callback){var temp=getPropVal(window,callback);callback="function"==typeof temp?temp:callback}return"function"==typeof callback?advanced?callback.apply(args[0],args.splice(1)):callback.apply(void 0,args):callback}function getValByPriority(array,attr){for(var val,i=0,len=array.length;i<len&&(null==val||""===val);i++)array[i]&&(val=array[i][attr]);return val}function validateNullVal(actualVal,defaultVal){var val=null==actualVal||""===actualVal?defaultVal:actualVal,parsedVal=JSON.parse(val);return val="number"==typeof parsedVal?parseFloat(parsedVal):"boolean"==typeof parsedVal?JSON.parse(parsedVal):parsedVal}function validateValWithinLimit(data,prop,minPercent,maxPercent,width,height){var val,refLevel=mathMin(width,height),maxVal=maxPercent*refLevel/100,minVal=minPercent*refLevel/100;return val=null==(val=data[prop])||""===val?null:val<minVal?minVal:val>maxVal?maxVal:parseFloat(val)}function isWithinRange(value,range){var minVal=range[0],maxVal=range[1];return!(value<minVal||value>maxVal)}function defined(obj){return void 0!==obj&&null!==obj}function isPositive(number){return number>0}function isNull(value){return null==value||"null"==value}function isTrue(e){return e+"".toLocaleLowerCase()==="true"}function shorthand_px(val){return(val+="").replace(/ /g,"px ")+"px"}function pInt(s,mag){return parseInt(s,mag||10)}function isArray(obj){return Array.isArray?Array.isArray(obj):!!obj&&obj.constructor===Array}function isFunction(object){return!!(object&&object.constructor&&object.call&&object.apply)}function jsonStringify(obj,replacer){return defined(obj)?JSON.stringify(obj,replacer):UNDEFINED}var getPropVal=utils.getPropVal=function(obj,key){return isObjectPropDefined(obj,key,!0)};function intersectObject(obj1,obj2){if(!obj1||!obj2)return null;var intersected,output={};for(var prop in obj1)if(obj1.hasOwnProperty(prop)&&obj2.hasOwnProperty(prop)){var val1=obj1[prop],val2=obj2[prop];if(!val1||val1.constructor!=Object&&val1.constructor!=Array)val1==val2&&(output[prop]=val1,intersected=!0);else{var i=intersectObject(val1,val2);null!=i&&(output[prop]=i,intersected=!0)}}return intersected?output:null}function getContrastColor(color){return function(color){var rgb=d3_rgb(color);return(299*rgb.r+587*rgb.g+114*rgb.b)/1e3<128}(color)?"#f8f8f8":"#444444"}function offset(elem){var box=elem.getBoundingClientRect(),doc=elem&&elem.ownerDocument,docElem=doc.documentElement,win=function(elem){return null!=(obj=elem)&&obj===obj.window?elem:9===elem.nodeType&&elem.defaultView;var obj}(doc);return{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}}function stringifiedArrayReverse(str){return str?str.split(",").reverse().join():str}function isDocumentVisible(){return defined(document.visibilityState)&&"visible"!==document.visibilityState}utils.elementIsVisible=function(element,container,partial){var contHeight=container.offsetHeight,elemTop=offset(element).top-offset(container).top,elemBottom=elemTop+element.offsetHeight;return elemTop>=0&&elemBottom<=contHeight||partial&&(elemTop<0&&elemBottom>0||elemTop>0&&elemTop<=contHeight)};var pick=function(){var i,arg,args=arguments,length=args.length;for(i=0;i<length;i++)if(defined(arg=args[i]))return arg;return args[length-1]};function each(obj,fn){if("object"!=typeof obj)return!1;if(isArray(obj)||"number"==typeof obj.length)Array.prototype.forEach.call(obj,fn);else for(var attr in obj)obj.hasOwnProperty(attr)&&fn(obj[attr],attr,obj)}function extend(target){if(arguments[1]){for(var ii=1,ll=arguments.length;ii<ll;ii++){var source=arguments[ii];for(var prop in source)!target[prop]&&source.hasOwnProperty(prop)&&(target[prop]=source[prop])}return target}}function inherit(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);var subClassProto=subClass.prototype;subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass),extend(subClass.prototype,subClassProto)}function removeElementFromArray(array,element){var index=array.indexOf(element);return index>-1&&array.splice(index,1),array}function getStyle(el,prop,convertToInt){var style;return el.isD3Selection&&(el=el.node()),"width"===prop?mathMin(el.offsetWidth,el.scrollWidth)-getStyle(el,"padding-left")-getStyle(el,"padding-right"):"height"===prop?mathMin(el.offsetHeight,el.scrollHeight)-getStyle(el,"padding-top")-getStyle(el,"padding-bottom"):((style=window.getComputedStyle(el))&&(style=style.getPropertyValue(prop),pick(convertToInt,"opacity"!==prop)&&(style=pInt(style))),style)}function isHTMLElement(element){return element instanceof HTMLElement}function splat(obj){return isArray(obj)?obj:[obj]}function parseShortHandValue(value){var t,r,b,l;if(defined(value)){var parsedValue=value.toString().split(" ");t=pInt(priorityBasedValue([parsedValue[0],0])),r=pInt(priorityBasedValue([parsedValue[1],parsedValue[0],0])),b=pInt(priorityBasedValue([parsedValue[2],parsedValue[0],0])),l=pInt(priorityBasedValue([parsedValue[3],parsedValue[1],parsedValue[0],0]))}else t=0,r=0,b=0,l=0;return{top:t,right:r,bottom:b,left:l}}function getBorderRadius(radius){var parsedVal={},splittedStr=null!=radius?radius.toString().split("/"):null,rx=null!=splittedStr&&null!=splittedStr[0]?splittedStr[0].split(" "):[],ry=null!=splittedStr&&null!=splittedStr[1]?splittedStr[1].split(" "):rx;return parsedVal.tlx=pInt(priorityBasedValue([rx[0]])),parsedVal.tly=pInt(priorityBasedValue([ry[0],rx[0]])),parsedVal.trx=pInt(priorityBasedValue([rx[1],rx[0]])),parsedVal.trY=pInt(priorityBasedValue([ry[1],ry[0],rx[1],rx[0]])),parsedVal.brx=pInt(priorityBasedValue([rx[2],rx[0]])),parsedVal.bry=pInt(priorityBasedValue([ry[2],ry[0],rx[2],rx[0]])),parsedVal.blx=pInt(priorityBasedValue([rx[3],rx[1],rx[0]])),parsedVal.bly=pInt(priorityBasedValue([ry[3],ry[1],rx[3],rx[0]])),parsedVal}function priorityBasedValue(priorities,defaultValue){var value=null,size=priorities.length,i=0;for(defaultValue=pick(defaultValue,0);i<size&&!defined(value);)value=null!=priorities[i]?priorities[i]:null,i++;return pick(value,defaultValue)}function toCapitalize(string){return string.charAt(0).toUpperCase()+string.slice(1)}function fixHDPI(context){var canvas=context.canvas,pixelRatio=DEVICE_PIXEL_RATIO;return canvas.style.width=canvas.width+"px",canvas.style.height=canvas.height+"px",canvas.setAttribute("width",canvas.width*pixelRatio),canvas.setAttribute("height",canvas.height*pixelRatio),context.scale(pixelRatio,pixelRatio),context}function arrayFind(array,callback){if(Array.prototype.find)return array.find(callback);for(var len=array.length>>>0,i=0;i<len;){var kValue=array[i];if(callback.call(callback,kValue,i,array))return kValue;i++}}function getRootNode(node){return node.getRootNode?node.getRootNode():null!=node.parentNode?getRootNode(node.parentNode):node}function isShadowElement(element){return isShadowRoot(getRootNode(element))}function isShadowRoot(node){return"#document-fragment"===node.nodeName&&"ShadowRoot"===node.constructor.name}function isElementOnDocument(element){return isShadowElement(element)||document.body.contains(element)}function isElementVisible(element){return isElementOnDocument(element)&&d3_select(element).style("display")!==NONE}function getRootBody(node){var rootNode=getRootNode(node);if(isShadowRoot(rootNode)){var fakeBody=rootNode.querySelector("._zc_fakeBody");return fakeBody||((fakeBody=document.createElement("div")).className="_zc_fakeBody",rootNode.appendChild(fakeBody)),fakeBody}return document.body}function getDocumentIndex(element){return getRootNode(element).ZC_DOCUMENT_INDEX}function perToPx(val,dim,defaultVal){return"string"==typeof val&&val.indexOf("%")>-1?dim*+val.replace(/%/g,"")*.01:validateNullVal(val,defaultVal)}function arrayIncludes(array,item){return array.includes?array.includes(item):array.indexOf(item)>-1}function numberIsBetween(number,minMax){var min=Math.min.apply(Math,minMax),max=Math.max.apply(Math,minMax);return number>=min&&number<=max}d3$1.selection.prototype.isD3Selection=!0,utils.getStyle=getStyle,utils.toCapitalize=toCapitalize,utils.fixHDPI=fixHDPI,utils.arrayFind=arrayFind,utils.moveArrayElement=function(array,from,to){array.splice(to,0,array.splice(from,1)[0])},utils.isShadowElement=isShadowElement,utils.isShadowRoot=isShadowRoot,utils.isElementOnDocument=isElementOnDocument,utils.isElementVisible=isElementVisible,utils.getRootBody=getRootNode;var defaultTheme=function(userProp){return{canvas:{fontFamily:$ZCG.globalProp.fontL1Family,fontColor:$ZCG.globalProp.fontL1Color,fontSize:userProp.fontL1Size.l3,fontWeight:$ZCG.globalProp.fontL1Weight,fontStyle:$ZCG.globalProp.fontL1Style,title:{show:!0,text:"Title comes here",hAlign:"left",vAlign:"top",marginTop:10,marginRight:0,marginBottom:0,marginLeft:10,target:"newtab",fontSize:userProp.fontL1Size.l1},subtitle:{show:!0,text:"Description comes here",hAlign:"left",vAlign:"top",marginTop:0,marginRight:0,marginBottom:0,marginLeft:10,target:"newtab",fontSize:userProp.fontL1Size.l2},background:{alpha:1,color:"#FFFFFF"},border:{show:!0,size:1,style:"solid",radius:1,color:"#cccccc"},shadow:{show:!0,x:1,y:1,color:"rgba(0,0,0,0.1)",blur:2,inset:!1},intelligence:{dimension:{title:100,subtitle:120,xaxis:70,xaxislabel:80,yaxis:70,yaxislabel:80,legend:140,credits:150,marker:50},dataCount:{marker:300,animation:300,datalabels:300}}},legend:{enabled:!0,colorPallete:{type:"multicolor",options:{multicolor:"countries",monochrome:{baseColor:"red",count:5,colorGamma:[.3,.9]}}},hAlign:"right",vAlign:"top",fontSize:userProp.fontL1Size.l5,textPadding:5,itemMargin:3,marginTop:10,marginRight:10,marginBottom:10,marginLeft:10,colorBox:{shape:"square",strokeWidth:2},colorBand:{},title:{show:!1,text:"Legend",fontSize:userProp.fontL1Size.l4,keepAligned:!1},background:{color:"transparent",alpha:0},border:{show:!0,size:1,style:"solid",radius:0,color:"transparent"},itemDisabledStyle:{color:"#d1d1d1",strikeout:!1},shadow:{show:!1,color:"rgba(0,0,0,0.3)",x:2,y:2,blur:3,inset:!1},filter:{enabled:!0},highlightEffect:{selectedSeries:null,unselectedSeries:"none"},expandable:{fontSize:userProp.fontL1Size.l5}},chart:{marginTop:10,marginRight:10,marginBottom:10,marginLeft:10,fontSize:userProp.fontL2Size.l3,zoom:{type:"none"},effects:{choice:"auto",options:{dropShadow:{dx:"5",dy:"5",blur:"3",color:"rgba(0,0,0,0.6)"},freeHand:{scale:7}}},plot:{renderer:{mode:"svg",image:{source:"auto",addDimensionInSource:!1,exportUrl:""}},background:{alpha:1,color:"transparent",gradients:{show:!1,type:"radial"}},border:{show:!1,size:1,style:"solid",radius:0,color:"#ececec"},animation:{enabled:$ZCG.globalProp.animation.enabled,easingType:$ZCG.globalProp.animation.easingType,duration:$ZCG.globalProp.animation.duration},datalabels:{show:$ZCG.globalProp.datalabels.enabled,handleOverlapping:!0,fontSize:userProp.datalabels.fontSize.l5,boundBox:{strokeColor:$ZCG.fontColor,fillColor:"white"}},events:{cursor:null,click:$ZCG.globalProp.events.click,mousemove:$ZCG.globalProp.events.mouseMove,mouseout:$ZCG.globalProp.events.mouseOut,doubleclick:$ZCG.globalProp.events.doubleClick,contextmenu:null,init:null,onload:null},plotoptions:{}},axes:defaultTheme.axes?defaultTheme.axes(userProp):{}},map:defaultTheme.map?defaultTheme.map():{},tooltip:{enabled:!0,fontSize:userProp.fontL1Size.l5,opacity:.8,zindex:2e3,view:"normal",crosshair:{type:"none",color:"grey"},pointerEvents:"none"},noDataHandler:{text:"No Data",fontSize:userProp.fontL1Size.l1},loader:{type:"none",fontSize:userProp.fontL1Size.l3}}},setDefaultOptions=function(type,source,userProp,options,dontFetchDefault){dontFetchDefault||(options=function(type,source,userProp){var options;switch(type){case"zoom":options=defaultTheme.zoom(userProp);break;case"scroll":options=defaultTheme.scroll();break;case"legend":options={};break;case"credits":options=defaultTheme.credits(userProp);break;case"notes":options=defaultTheme.notes(userProp);break;case"bar":options=defaultTheme.bar();break;case"line":options=defaultTheme.line();break;case"area":options=defaultTheme.area();break;case"arearange":options=defaultTheme.arearange();break;case"scatter":case"geoscatter":options=defaultTheme.scatter(type);break;case"bubblepie":case"geobubblepie":case"pie":options=defaultTheme.pie(type);break;case"funnel":options=defaultTheme.funnel();break;case"web":options=defaultTheme.web();break;case"pyramid":options=defaultTheme.pyramid();break;case"sunburst":options=defaultTheme.sunburst();break;case"dial":options=defaultTheme.dial(userProp);break;case"bubble":case"geobubble":options=defaultTheme.bubble();break;case"packedbubble":options=defaultTheme.packedbubble();break;case"bullet":options=defaultTheme.bullet(userProp);break;case"gantt":options=defaultTheme.gantt();break;case"treemap":options=defaultTheme.treemap();break;case"heatmap":options=defaultTheme.heatmap();break;case"geoheatmap":options=defaultTheme.geoheatmap();break;case"dotgrid":options=defaultTheme.dotgrid();break;case"waterfall":options=defaultTheme.waterfall();break;case"wordcloud":options=defaultTheme.wordcloud();break;case"metadata":options={axes:{x:[0],y:[[1]],tooltip:[0,1]},columns:[{dataindex:0,columnname:"",datatype:"numeric"},{dataindex:1,columnname:"",datatype:"numeric"}]}}return options}(type,0,userProp));var dest=null==source[type]?source[type]={}:source[type];return mergeJSON(options,dest,!0,!0),source[type]=options,options};function getTspanBoundingClientRect(tspan){var range=document.createRange();range.selectNode(tspan);var rect=range.getClientRects(),actBoundBox=rect[1]||rect[0];return range.detach(),($Browser.FIREFOX||$Browser.SAFARI)&&(actBoundBox.width=2*actBoundBox.width,actBoundBox.height=2*actBoundBox.height),actBoundBox}function getDefaultBoundingClientRect(text){return text.getBoundingClientRect()}function getTextBound(text,fontSize,fontFamily,styles,dontUseEmpirical,fontStyle,fontWeight){var w,h,hasMultipleLines=isArray(text),fontHeight=utils.fontUtils.getTextHeight(text,fontSize,fontFamily,fontStyle,fontWeight,dontUseEmpirical);return hasMultipleLines?text.forEach(function(d,i){defined(styles)&&styles.length&&(fontSize=styles[i].fontSize||fontSize,fontFamily=styles[i].fontFamily||fontFamily);var tempWid=utils.fontUtils.getTextWidth(d,fontSize,fontFamily,fontStyle,fontWeight);fontHeight=utils.fontUtils.getTextHeight(d,fontSize,fontFamily,fontStyle,fontWeight),w=defined(w)?mathMax(w,tempWid):tempWid,h=defined(h)?h+1.1*fontHeight:fontHeight}):(defined(styles)&&(fontSize=styles.fontSize||fontSize,fontFamily=styles.fontFamily||fontFamily),w=utils.fontUtils.getTextWidth(text,fontSize,fontFamily,fontStyle,fontWeight),h=utils.fontUtils.getTextHeight(text,fontSize,fontFamily,fontStyle,fontWeight,dontUseEmpirical)),{width:w,height:h}}function appendEle(parentNode,nodeName,data,selector,selectorAttr,selectorVal,styleObj,dataKeyFunc){var node;selector=selector||"",selectorVal=selectorVal||"";var nodeEnter=(node=parentNode.selectAll(nodeName+selector+selectorVal).data(data,dataKeyFunc)).enter().append(nodeName).merge(node);return selectorAttr&&nodeEnter.attr(selectorAttr,selectorVal),styleObj&&nodeEnter.styles(styleObj),node.exit().remove(),nodeEnter}function trimText(textObj,text,textBounds,edge,orient,pattern,marginValue,max,parent,deepTrim){if(null==text||!text.trim()||!textObj)return text;var maxWidth,maxHeight;parent=parent||textObj,max?(maxWidth=max.width,maxHeight=max.height):(maxWidth=edge.right-edge.left,maxHeight=edge.bottom-edge.top);var overflowLength=0;if("left"==orient||"right"==orient?(textBounds.top+textBounds.height-marginValue.bottom>edge.bottom&&(overflowLength+=(textBounds.top+textBounds.height-marginValue.bottom-edge.bottom)/textBounds.height),textBounds.top+marginValue.top<edge.top&&(overflowLength+=(edge.top-(textBounds.top+marginValue.top))/textBounds.height),maxHeight=textBounds.height-mathMax(0,textBounds.top+textBounds.height-marginValue.bottom-edge.bottom)-mathMax(0,edge.top-(textBounds.top+marginValue.top))):"bottom"!=orient&&"top"!=orient||(textBounds.left+textBounds.width-marginValue.right>edge.right&&(overflowLength+=(textBounds.left+textBounds.width-marginValue.right-edge.right)/textBounds.width),textBounds.left+marginValue.left<edge.left&&(overflowLength+=(edge.left-(textBounds.left+marginValue.left))/textBounds.width),maxWidth=textBounds.width-mathMax(0,textBounds.left+textBounds.width-marginValue.right-edge.right)-mathMax(0,edge.left-(textBounds.left+marginValue.left))),(overflowLength=parseFloat(overflowLength.toFixed(2)))>0){var croppedTextLength=mathCeil((1-overflowLength)*text.length);textObj.textContent=text.substring(0,croppedTextLength-1)+pattern;var newTextBounds=("tspan"==parent.nodeName?getTspanBoundingClientRect:getDefaultBoundingClientRect)(parent);!1===(deepTrim="tspan"!=textObj.nodeName&&deepTrim)||newTextBounds.width==textBounds.width&&newTextBounds.height==textBounds.height||naiveEllipsis(textObj,parent,text,maxWidth,maxHeight,newTextBounds,pattern)}}function getSvgTransform(element){element.isD3Selection&&(element=element.node());var baseVal=element.transform.baseVal.consolidate(),matrix=defined(baseVal)?baseVal.matrix:null;if(defined(matrix)){var scaleX,scaleY,skewX,a=matrix.a,b=matrix.b,c=matrix.c,d=matrix.d,e=matrix.e,f=matrix.f;return(scaleX=mathSQRT(a*a+b*b))&&(a/=scaleX,b/=scaleX),(skewX=a*c+b*d)&&(c-=a*skewX,d-=b*skewX),(scaleY=mathSQRT(c*c+d*d))&&(c/=scaleY,d/=scaleY,skewX/=scaleY),a*d<b*c&&(a=-a,b=-b,skewX=-skewX,scaleX=-scaleX),{translate:[e,f],skew:[180*mathAtan2(b,a)/mathPI,180*Math.atan(skewX)/mathPI],rotate:180*mathAtan2(b,a)/mathPI,scale:[scaleX,scaleY]}}return{translate:[0,0],skew:[0,0],rotate:0,scale:[0,0]}}function roundedRect(x,y,w,h,r,yReversed,axisrotated){var x1,x2,y1,y2;return x1=yReversed&&axisrotated?x-w:x,x2=yReversed&&axisrotated?x:x+w,y1=yReversed&&!axisrotated?y-h:y,"M"+x1+","+((y2=yReversed&&!axisrotated?y:y+h)-(r=checkRadiusWithinBoundary(r,w,h)).bly)+"L"+x1+","+(y1+r.tly)+"A"+r.tlx+","+r.tly+" 0 0 1 "+(x1+r.tlx)+","+y1+"L"+(x2-r.trx)+","+y1+"A"+r.trx+","+r.trY+" 0 0 1 "+x2+","+(y1+r.trY)+"L"+x2+","+(y2-r.bry)+"A"+r.brx+","+r.bry+" 0 0 1 "+(x2-r.brx)+","+y2+"L"+(x1+r.blx)+","+y2+"A"+r.blx+","+r.bly+" 0 0 1 "+x1+","+(y2-r.bly)+"Z"}function checkRadiusWithinBoundary(r,width,height,isCanvasMode){var z,radius=Object.create(r),top=radius.tlx+radius.trx,right=radius.trY+radius.bry,bottom=radius.brx+radius.blx,left=radius.tly+radius.bly;return height<left&&(z=left/(left-height),radius.tly=radius.tly-radius.tly/z,radius.bly=radius.bly-radius.bly/z),width<top&&(z=top/(top-width),radius.tlx=radius.tlx-radius.tlx/z,radius.trx=radius.trx-radius.trx/z),height<right&&(z=right/(right-height),radius.trY=radius.trY-radius.trY/z,radius.bry=radius.bry-radius.bry/z),width<bottom&&(z=bottom/(bottom-width),radius.brx=radius.brx-radius.brx/z,radius.blx=radius.blx-radius.blx/z),isCanvasMode&&(radius.tlx=radius.tly=Math.min(radius.tlx,radius.tly),radius.trx=radius.trY=Math.min(radius.trx,radius.trY),radius.blx=radius.bly=Math.min(radius.blx,radius.bly),radius.brx=radius.bry=Math.min(radius.brx,radius.bry)),radius}function applyFont(ele,hierarchy,html){var fSize=utils.getVal(getValByPriority(hierarchy,"fontSize")),fFamily=getValByPriority(hierarchy,"fontFamily"),fWeight=getValByPriority(hierarchy,"fontWeight"),fStyle=getValByPriority(hierarchy,"fontStyle"),fShadow=getValByPriority(hierarchy,"textShadow"),fColor=getValByPriority(hierarchy,"fontColor"),txtDec=getValByPriority(hierarchy,"textDecoration"),strokeColor=getValByPriority(hierarchy,"strokeColor"),styleObj={"font-size":fSize+"px","font-family":fFamily,"font-weight":fWeight,"font-style":fStyle,"text-shadow":fShadow,"text-decoration":txtDec,"fill-opacity":getValByPriority(hierarchy,"fontOpacity")};return!html&&strokeColor&&(styleObj.stroke=strokeColor,styleObj["stroke-width"]=getValByPriority(hierarchy,"strokeWidth")||3,styleObj["paint-order"]="stroke"),defined(ele)?("contrast"===strokeColor&&(styleObj.stroke=null),styleObj[html?"color":"fill"]=fColor,ele.styles(styleObj)):styleObj.color=fColor,styleObj}function addSVGtitleEle(textEle,data){textEle.append("title").text(function(){return data||this.parentNode.textContent})}function naiveEllipsis(textNode,parent,origTextContent,maxWidth,maxHeight,textBounds,pattern){var index=textNode.textContent.length-1,pattern_length=pattern.length;if(textBounds.width>maxWidth||textBounds.height>maxHeight)for(var end=0;index>=end;){if(changeTextContent(!0),textBounds.width<=maxWidth&&textBounds.height<=maxHeight)return;index--}else for(end=origTextContent.length;index<end;){if(textBounds.width>=maxWidth||textBounds.height>=maxHeight)return index--,void changeTextContent(!1);index++}function changeTextContent(updateBound){var clientRect="tspan"==textNode.nodeName?getTspanBoundingClientRect:getDefaultBoundingClientRect;textNode.textContent=origTextContent.substring(0,index-pattern_length)+pattern,updateBound&&(textBounds=clientRect(parent))}}function parseSVGPath(path){return path.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi).map(function(d){var func=(d=d.trim()).match(/[a-z]/gi).shift(),moves=d.match(/-?[0-9]\d*(\.\d+(e-\d+)?)?/g);return moves&&(moves=moves.map(function(m){return parseFloat(m)})),{function:func,moves:moves}})}function wrapTextContent(node,text,prop,useHTML){var isMultiLine=isArray(text)&&text.length>1,printProperty=useHTML?"html":"text",parentGroup=d3$1.select(node.node().parentNode);if(isMultiLine){node.text(null);var x=node.attr("x")||0,y=node.attr("y")||0,dy=node.attr("dy")?parseFloat(node.attr("dy")):.71,lineNumber=0,lineHeight=defined(prop)&&defined(prop.lineHeight)?prop.lineHeight:dy,orient=defined(prop)&&prop.orient;lineHeight="top"==orient?-(text.length-1+lineHeight):"left"==orient||"right"==orient?-(text.length-2+lineHeight)/2:lineHeight,text.forEach(function(el){if(useHTML)insertSVGEle(parentGroup,node,el);else{var tspan=node.append("tspan");tspan.attr("x",x).attr("y",y).attr("dy",function(d,i){return lineNumber+++lineHeight+"em"}),tspan[printProperty](function(){return el})}})}else useHTML?(node.text(null),insertSVGEle(parentGroup,node,text)):node[printProperty](text);return node}function insertSVGEle(parent,textNode,child){if(/^<image.+<\/image>/i.test(child))appendEle(parent,"g",[1],".","class","image").html(child);else if(/^<tspan.+<\/tspan>/i.test(child)){var doc=(new DOMParser).parseFromString('<svg xmlns="'+d3$1.namespaces.svg+'">'+child+"</svg>","application/xml");textNode.node().appendChild(doc.querySelector("tspan"))}else textNode.append("tspan").text(child)}function getTextContent(textNode){var tspan=textNode.selectAll("tspan").nodes();if(tspan&&tspan.length){var arr=[];return tspan.forEach(function(d){arr.push(d.textContent)}),arr}return textNode.node().textContent}function getTranslationFromOwnerSVGElement(node){node.isD3Selection&&(node=node.node());for(var ownerSVGElement=node.ownerSVGElement,translatedValue=[0,0];node!==ownerSVGElement;){var translate=getSvgTransform(node).translate;translatedValue[0]+=translate[0],translatedValue[1]+=translate[1],node=node.parentNode}return translatedValue}function createElement(element,query,data,parent,insertBefore){parent||(parent=d3$1.select("body"));var selectorAttribute,selectorValue,selector;if(/^[.#]/.test(query)&&(selector=query[0],selectorValue=query.slice(1),selectorAttribute={".":"class","#":"id"}[selector]),insertBefore){var selection=parent.selectAll(element+query).data(data),entry=selection.enter().insert(element,insertBefore).merge(selection);return selection.exit().remove(),entry.attr(selectorAttribute,selectorValue)}return appendEle(parent,element,data,selector,selectorAttribute,selectorValue)}defaultTheme.axes=function(userProp){return{xaxis:{show:!0,label:{show:!0,text:"Xaxis",fontSize:userProp.fontL2Size.l4,marginTop:5,marginRight:5,marginBottom:5,marginLeft:5},grid:{show:!0,color:"transparent",strokeWidth:null},ticklabel:{textOverflow:"ellipsis",fontSize:userProp.fontL2Size.l5},tickmark:{strokeWidth:null,color:"#ececec",size:3},axisline:{show:!0,color:"#ececec",strokeWidth:null,style:"solid"},baseline:{show:!1,value:10,color:"black"},threshold:{line:{show:!1,values:[],label:{text:["Description comes here"],fontSize:userProp.fontL2Size.l5},marker:{enabled:!0,hoveroptions:{innerStrokeOpacity:1,outerFillColor:"transparent",outerStrokeWidth:2}}},coloroverlay:{show:!1,values:[],overlayRange:"below"},range:{show:!1,values:[],label:{text:["Description comes here"],fontSize:userProp.fontL2Size.l5}}}},yaxis:[{show:!0,label:{show:!0,text:"Yaxis",fontSize:userProp.fontL2Size.l4,marginTop:5,marginRight:5,marginBottom:5,marginLeft:5},grid:{show:!0,color:"#ececec"},ticklabel:{textOverflow:"ellipsis",fontSize:userProp.fontL2Size.l5},tickmark:{color:"#ececec",size:3},subtickmark:{color:"#ececec",size:5,count:0},axisline:{show:!0,color:"#ececec",strokeWidth:null,style:"solid"},baseline:{show:!1,value:0,color:"grey",strokeWidth:null},threshold:{line:{show:!1,values:[],label:{text:["Description comes here"],fontSize:userProp.fontL2Size.l5},marker:{enabled:!0,hoveroptions:{innerStrokeOpacity:1,outerFillColor:"transparent",outerStrokeWidth:2}}},coloroverlay:{show:!1,values:[],overlayRange:"below"},range:{show:!1,values:[],label:{text:["Description comes here"],fontSize:userProp.fontL2Size.l5}}}}]}},defaultTheme.credits=function(userProp){return{enabled:!1,imageWidth:150,imageHeight:50,hAlign:"right",vAlign:"bottom",text:"Zoho Reports",target:"newtab",marginTop:0,marginRight:10,marginBottom:10,marginLeft:0,fontSize:userProp.fontL1Size.l4}},defaultTheme.map=function(){return{allAreas:!0,renderingMode:"canvas",fillColor:"#dddddd",strokeColor:"#444",strokeWidth:.6,gradients:{options:{linear:{y2:100},radial:{radius:100,gradientUnits:"objectBoundingBox"}}},globe:{strokeWidth:1.5},labels:{strokeWidth:1.5},extent:{top:10,right:10,bottom:10,left:10},layerName:"source",useMeshOutline:!0,textStrokeWidth:2,animation:{enabled:!0,type:"fade",duration:500,easingType:"cubic"}}},defaultTheme.notes=function(userProp){return{enabled:!1,chartValues:[],plotValues:[],blockValues:[],type:"stickyNote",options:{stickyNote:{headWidth:15,headHeight:15,bodyWidth:100,bodyHeight:100,fontSize:userProp.fontL1Size.l5,color:["#F0F8FF","#FFE4C4","#DCDCDC","#ADFF2F","#90EE90","#87CEFA","#FFC0CB","#B0E0E6","#D2B48C","#D8BFD8","#EE82EE","#F5DEB3"],mode:"close",border:"1px solid grey"},customNote:{fontSize:userProp.fontL1Size.l5}}}},defaultTheme.zoom=function(userProp){return{type:"none",resetButton:{fillColor:"grey",label:{text:"Reset Zoom",marginTop:5,marginRight:5,marginBottom:5,marginLeft:5,fontSize:userProp.fontL2Size.l5},border:{show:!0,size:1,radius:6,color:"#cccccc"},shadow:{show:!1,dx:1,dy:1,color:"#cccccc",blur:1}},selectionArea:{fillColor:"grey",fillOpacity:.4}}},defaultTheme.scroll=function(){return{enabled:!0,categoryThickness:null,visibleCategories:null,height:10,slider:{fillOpacity:.3,strokeOpacity:.3,strokeColor:"black"}}},defaultTheme.area=function(){return{strokeOpacity:.5,outerPadding:.02,fillOpacity:.4,mode:"linear",stacked:{enabled:!1,showAs:"values"},marker:{enabled:!1,outerFillColor:"transparent",outerStrokeOpacity:.5,size:1},hoveroptions:{innerStrokeWidth:2,outerFillOpacity:.5,outerStrokeOpacity:.1},datalabels:{showAs:"y"},gradients:{options:{linear:{x2:50}}},animation:{type:"vertPathTweenAll",marquee:{enabled:!1,duration:300},blink:{enabled:!1,type:"twinkle",duration:800}}}},defaultTheme.arearange=function(){return{strokeOpacity:.5,outerPadding:.02,fillOpacity:.4,mode:"linear",stacked:{enabled:!1,showAs:"values"},marker:{enabled:!1,outerFillColor:"transparent",outerStrokeOpacity:.5,size:1},hoveroptions:{innerStrokeWidth:2,outerFillOpacity:.5,outerStrokeOpacity:.1},datalabels:{showAs:"y"},gradients:{options:{linear:{x2:50}}},animation:{type:"vertPathTweenAll",marquee:{enabled:!1,duration:300},blink:{enabled:!1,type:"twinkle",duration:800}}}},defaultTheme.bar=function(){return{outerPadding:.04,fillOpacity:.9,maxBandWidth:200,multiColoring:!1,border:{show:!1,size:null,style:"solid",radius:0,color:null},stacked:{enabled:!1,showAs:"values"},levelMarker:{enabled:!1,color:["#d8d8d8"],fillOpacity:.9},datalabels:{showAs:"y",stackLabels:{show:!1,showAs:"y"}},animation:{type:"verticalAll"},gradients:{options:{linear:{y2:50}}}}},defaultTheme.bubble=function(){return{outerPadding:.02,multiColoring:!1,marker:{innerFillOpacity:0,innerStrokeWidth:0,innerStrokeOpacity:0,outerFillOpacity:.4,outerStrokeOpacity:1},hoveroptions:{innerFillColor:"transparent",innerStrokeColor:"transparent",innerStrokeOpacity:1,innerStrokeWidth:0,outerFillOpacity:.3,outerStrokeOpacity:.5},datalabels:{showAs:"y"},animation:{type:"sizing"},gradients:{options:{linear:{y2:100,gradientUnits:"userSpaceOnUse",colorGamma:[1.5,0]},radial:{radius:90,colorGamma:[1.5,0]}}}}},defaultTheme.bullet=function(userProp){return{strictBandWidth:!0,outerPadding:1e-8,levelMarker:{enabled:!0,dataindex:2,color:[],colorGamma:[.3,.9],fillOpacity:.9,maxBandWidth:200},targetMarker:{enabled:!0,dataindex:3,symbol:"line",innerFillColor:"transparent",innerStrokeColor:"transparent",innerStrokeWidth:0,innerStrokeOpacity:0,outerFillColor:"rgba(0, 0, 0, 0.6)",outerStrokeOpacity:1,outerStrokeWidth:5,outerStrokeColor:"rgba(0, 0, 0, 0.6)",label:{fontSize:userProp.datalabels.fontSize.l5}},animation:{type:"verticalAll"},datalabels:{textOverlap:"none",showAs:"y",stackLabels:{show:!1,showAs:"y"}},gradients:{options:{linear:{y2:50}}}}},defaultTheme.dial=function(userProp){return{startAngle:-mathPI/2,endAngle:mathPI/2,innerRadius:"65%",maxRadius:500,outerPadding:20,padding:0,strokeColor:"rgba(0,0,0,0.1)",animation:{type:"fanAll"},needle:{show:!0,type:"round",strokeColor:"black",fillColor:"grey",width:15,padding:15},minmaxlabels:{show:!0,fontSize:userProp.datalabels.fontSize.l5},datalabels:{show:!0,showAs:"y",padding:2},levelMarker:{enabled:!0,strokeColor:"rgba(0,0,0,0.1)",innerPadding:0,outerPadding:0,colorGamma:[.3,.9]},targetMarker:{outerStrokeWidth:3,symbol:"line",innerFillOpacity:0,innerStrokeOpacity:0,outerFillColor:"grey",outerStrokeColor:"#000"},gradients:{options:{linear:{x2:2,y2:2,spreadMethod:"repeat",gradientUnits:"userSpaceOnUse"},radial:{radius:16.5,spreadMethod:"reflect"}}},events:{enabled:!1}}},defaultTheme.funnel=function(){return{weighted:"height",split:!1,canOverlap:!0,threeDimension:!0,outerPadding:"2%",stemHeight:"20%",stemWidth:"20%",coneWidth:"100%",strokeColor:"transparent",emptyFunnel:{show:!1,color:"#FAFAFA"},datalabels:{showAs:"x",type:"strokeddoubleside",padding:30,line:{strokeColor:"grey",strokeWidth:.3},innerLabel:{show:!1,showAs:"percent"}},gradients:{options:{linear:{x2:50,spreadMethod:"reflect",colorGamma:[.6,0]}}},animation:{type:"vertical"}}},defaultTheme.gantt=function(){return{outerPadding:.04,padding:0,interPadding:.05,maxBandWidth:200,levelMarker:{enabled:!1,dataindex:2,fillOpacity:.3,bandWidth:4},hoveroptions:{enabled:!1,start:{innerStrokeOpacity:1,outerFillColor:"white",outerStrokeWidth:2},end:{innerStrokeOpacity:1,outerFillColor:"white",outerStrokeWidth:2}},marker:{enabled:!1,start:{size:1,innerStrokeWidth:0,outerStrokeWidth:2},end:{size:1,innerStrokeWidth:0,outerStrokeWidth:2}},border:{show:!1,size:null,style:"solid",radius:0,color:null},stacked:{enabled:!1,showAs:"values"},animation:{type:"verticalAll"},datalabels:{showAs:"y"},gradients:{options:{linear:{y2:50}}},dependency:{enabled:!1,targetIndex:0,link:{type:"ES",strokeWidth:2,strokeColor:"#111111",errorStyle:"red",padding:20},marker:{enabled:!0,padding:10,size:1.5,innerFillColor:"transparent",innerStrokeWidth:0,innerStrokeOpacity:0,outerStrokeOpacity:0,outerStrokeColor:"red",outerFillColor:"blue"}}}},defaultTheme.geoheatmap=function(){return{animation:{enabled:!1},datalabels:{showAs:"geo",fontWeight:"bold",strokeColor:"contrast",strokeWidth:1.5,textOverlap:"hidden"},gradients:{options:{linear:{y2:100},radial:{radius:100,gradientUnits:"objectBoundingBox"}}}}},defaultTheme.heatmap=function(){return{strokeColor:"white",animation:{},datalabels:{showAs:"y"},gradients:{options:{linear:{y2:100},radial:{radius:100}}}}},defaultTheme.line=function(){return{mode:"linear",strokeWidth:2,outerPadding:.02,stacked:{enabled:!1,showAs:"values"},marker:{enabled:!0,innerStrokeWidth:2,outerFillColor:"transparent",outerStrokeColor:"transparent"},hoveroptions:{innerStrokeWidth:2,outerFillOpacity:.5,outerStrokeOpacity:.1},datalabels:{showAs:"y"},animation:{type:"strokeTween",marquee:{enabled:!1,duration:300},blink:{enabled:!1,type:"twinkle",duration:800}},gradients:{options:{linear:{x2:10,spreadMethod:"reflect"}}}}},defaultTheme.packedbubble=function(){return{fillOpacity:.2,outerPadding:5,animation:{type:"sizing"},datalabels:{showAs:"y"}}},defaultTheme.pie=function(type){var defaultOptions={startAngle:0,endAngle:2*mathPI,innerRadius:0,outerPadding:10,datalabels:{type:"circular",padding:5,line:{strokeColor:"grey",strokeWidth:.3},innerLabel:{show:!1,showAs:"percent"}},animation:{type:"fanAll"},gradients:{options:{linear:{x2:15,spreadMethod:"repeat",gradientUnits:"userSpaceOnUse"},radial:{radius:90}}},models:{count:50}};return"bubblepie"===type||"geobubblepie"===type?(defaultOptions.strokeColor="transparent",defaultOptions.outerPadding=.02,defaultOptions.datalabels.showAs="percent",defaultOptions.hoveroptions={innerFillColor:"transparent",innerStrokeColor:"transparent",outerFillColor:"transparent",outerStrokeWidth:3}):(defaultOptions.strokeColor="white",defaultOptions.sliceOutHeight=5,defaultOptions.maxRadius=250,defaultOptions.datalabels.showAs="x"),defaultOptions},defaultTheme.pyramid=function(){return{threeDimension:!0,strokeColor:"black",strokeWidth:null,strokeOpacity:.5,fillOpacity:.8,gradients:{options:{linear:{x2:50,spreadMethod:"reflect",colorGamma:[.8,0]}}},datalabels:{showAs:"y",type:"singleside",padding:10,relativeX:!0,line:{strokeColor:"grey",strokeWidth:.3},innerLabel:{show:!1,showAs:"percent"}},animation:{type:"vertical"}}},defaultTheme.scatter=function(chartType){var options={outerPadding:.02,multiColoring:!1,marker:{size:1,innerFillColor:"white",innerStrokeColor:"white",innerStrokeWidth:0,innerStrokeOpacity:1,outerFillColor:"white",outerStrokeOpacity:1,outerStrokeWidth:2},hoveroptions:{innerStrokeOpacity:1,outerFillColor:"white",outerStrokeWidth:2},datalabels:{showAs:"y"},animation:{type:"allseries"},gradients:{options:{linear:{y2:100,gradientUnits:"userSpaceOnUse",colorGamma:[2,0]},radial:{radius:90,colorGamma:[2,0]}}}};return"geoscatter"===chartType&&(options.animation.type="sizing",options.datalabels.showAs="geo",options.datalabels.orient="bottom",options.datalabels.textOverlap="hidden"),options},defaultTheme.sunburst=function(){return{strokeColor:"white",innerRadius:30,outerPadding:20,animation:{type:"fan"},datalabels:{showAs:"y",type:"circular",padding:10,line:{strokeColor:"grey",strokeWidth:.3},innerLabel:{show:!1,showAs:"splitpercent",parentLabel:{}}}}},defaultTheme.treemap=function(){return{outerPadding:5,strokeColor:"rgba(255,255,255,0.7)",animation:{type:"fadeOneByOne"},datalabels:{showAs:"y",vAlign:"bottom",hAlign:"left"},gradients:{options:{linear:{y2:100,x2:100,colorGamma:[.5,0]},radial:{radius:100}}},parent:{strokeOpacity:0,datalabels:{position:"inset",vAlign:"center",hAlign:"center",showAs:"y",show:!1},events:{}}}},defaultTheme.waterfall=function(){return{outerPadding:.04,fillOpacity:.9,maxBandWidth:200,multiColoring:!1,border:{show:!1,size:null,style:"solid",radius:0,color:null},stacked:{enabled:!1,showAs:"values"},connector:{},comparisonLine:{},cascadeCategories:{dataindex:2},risingCategories:{},fallingCategories:{},datalabels:{showAs:"y",stackLabels:{show:!1,showAs:"y"}},animation:{type:"verticalAll"},gradients:{options:{linear:{y2:50}}}}},defaultTheme.web=function(){return{fillOpacity:.5,strokeWidth:2,mode:"linearClosed",outerPadding:10,stacked:{enabled:!1,showAs:"values"},marker:{enabled:!0,innerStrokeOpacity:1,outerFillColor:"white"},hoveroptions:{innerStrokeWidth:2,innerStrokeOpacity:1,outerFillColor:"white"},datalabels:{showAs:"y"},animation:{type:"strokeTween",marquee:{enabled:!1,duration:300},blink:{enabled:!1,type:"twinkle",duration:800}},gradients:{options:{linear:{x2:15,spreadMethod:"repeat",gradientUnits:"userSpaceOnUse"},radial:{radius:90,x:0,y:0}}}}},defaultTheme.wordcloud=function(){return{strokeColor:"transparent",animation:{type:"fadeOneByOne"},datalabels:{showAs:"x"},gradients:{options:{linear:{x2:100,y2:100,colorGamma:[0,1.5]},radial:{x:50,y:50,radius:100,colorGamma:[1,0]}}},mask:{background:{}}}};utils.fontUtils={getTextWidth:function(text,fontSize,fontFamily,fontStyle,fontWeight){fontStyle=fontStyle||"normal",fontWeight=fontWeight||"normal",tempCanvasContext.save(),tempCanvasContext.font=fontStyle+" "+fontWeight+" "+(fontSize||12)+"px "+(fontFamily||$ZCG.fontFamily);var t=tempCanvasContext.measureText(text).width;return tempCanvasContext.restore(),t},getTextHeight:function(text,fontSize,fontFamily,fontStyle,fontWeight,dontUseEmpirical){return dontUseEmpirical?fontSize:fontSize<24?fontSize+3:~~(1.195*fontSize)}};var ORDINAL_DATATYPE="ordinal",TIME_DATATYPE="time",NUMERIC_DATATYPE="numeric",patternThemes={},addPattern=function(name,type,size,strokeWidth,strokeClr,bgClr,fillOpacity,strokeOpacity,translate){patternThemes[name]={type:type||"diagonal-line-right",size:size||5,strokeWidth:strokeWidth||1,bgClr:bgClr,stroke:strokeClr,fillOpacity:fillOpacity||1,strokeOpacity:strokeOpacity||1,translate:translate}};function addPatternThemeByEle(ele){return{ele:ele}}var effects=function(){};function getGradientProp(gradient,dimension,color,opacity){var type=gradient.type;if(type&&type!==NONE){var options=gradient.options[type]||gradient.options,prop=simpleClone(options);return prop.color=null!=color?color:prop.color,prop.opacity=null!=opacity?opacity:prop.opacity,prop.dimension=null!=dimension?dimension:prop.dimension,prop.type=type,prop}}function getPatternSize(properties,size){return size.map(function(d,i){var s=parseInt(d);return properties.width%s/(parseInt(properties.width/s)||1)+s})}effects.get=function(module,submodule,properties,args){var offset=(args=args||{}).offset,returnSVGimage=(args.dimension,args.returnSVGimage),base64=args.base64,chartObj=args.chartObj,defaultModule="svgPattern"==args.moduleType?effects.svg_patterns:null;if(module=module||defaultModule,(null!=submodule||""!=submodule)&&module[submodule]){var renderToSvg;chartObj&&chartObj.getPatternSvg?renderToSvg=chartObj.getPatternSvg():(renderToSvg=pick(args.renderTo,$ZCG.patternSVG)).isD3Selection||(renderToSvg=d3_select(renderToSvg));var effectEle,effectID="zp"+generateIdByPropValue(properties,submodule);if(null!=effectID){var documentIndex=getDocumentIndex(renderToSvg.node()),EFFECTS_STORE=DOCUMENT_OBJECT_HOLDER[documentIndex].EFFECTS;return defined(EFFECTS_STORE[effectID])?(effectEle=EFFECTS_STORE[effectID],returnSVGimage?effectEle:effectEle.id||effectEle):(effectEle=module[submodule](properties,effectID,offset,returnSVGimage,base64,chartObj,renderToSvg))?(EFFECTS_STORE[effectID]=effectEle,returnSVGimage?effectEle:effectEle.id||effectEle):void 0}}};var colorscale_helpers={};function getRawRanges(chartObj,dont){var userRanges=chartObj.systemConf.legend.colorBand.ranges,copy_userRanges=simpleClone(userRanges),isOrdinal=chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE;return isArray(copy_userRanges[0])||(copy_userRanges=copy_userRanges.map(function(d){return[d]})),isOrdinal||dont||copy_userRanges.sort(function(a,b){return d3_ascending(a[0],b[0])}),copy_userRanges}colorscale_helpers.getProcessedColorRange=function(range,domain,options,chartObj){var userStops=options.stops,userRanges=options.ranges,processed_range=[],isOrdinal=chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE;if(!isOrdinal&&userStops&&userStops.length){var prevStopIndex=0;domain.forEach(function(d,i){var stopIndex=userStops.indexOf(d);-1===stopIndex&&(stopIndex=prevStopIndex),processed_range.push(range[stopIndex%range.length]),prevStopIndex=stopIndex})}else if(userRanges&&userRanges.length){userRanges=getRawRanges(chartObj,!0);for(var i=0,check=function(r,j){if(1===r.length?isOrdinal?r[0]===domain[i]:r[0]===domain[i+1]:r[0]===domain[i]&&r[1]===domain[i+1])return rangeIndex=j,!0},len=domain.length;i<len;isOrdinal?i++:i+=2){var rangeIndex=-1;userRanges.some(check),-1===rangeIndex||userRanges[rangeIndex].disabled?processed_range.push(null):processed_range.push(range[rangeIndex%range.length])}}else processed_range=range;return processed_range},colorscale_helpers.getColorDomain=function(chartObj){var options=chartObj.systemConf.legend.colorBand,userStops=options.stops,userRanges=options.ranges,minmax=colorscale_helpers.getMinMax(chartObj),min=pick(options.minRange,minmax[0])||0,max=pick(options.maxRange,minmax[1])||0,isOrdinal=chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE;if(!isOrdinal&&userStops&&userStops.length){var copy_userStops=d3_values(userStops);copy_userStops.sort(d3_ascending);var filteredStops=copy_userStops.filter(function(d){var condition=!0;return defined(options.minRange)&&(condition=condition&&d>=options.minRange),defined(options.maxRange)&&(condition=condition&&d<=options.maxRange),condition});return(min<filteredStops[0]||!filteredStops.length)&&filteredStops.splice(0,0,min),max>filteredStops[filteredStops.length-1]&&filteredStops.splice(filteredStops.length,0,max),filteredStops}if(userRanges&&userRanges.length){var copy_userRanges=getRawRanges(chartObj),final_ranges=[];if(isOrdinal)final_ranges=copy_userRanges;else{if(1===copy_userRanges[0].length){var m=min;copy_userRanges=copy_userRanges.map(function(d){var newRange=[m,d[0]];return m=newRange[1],newRange})}(final_ranges=copy_userRanges).splice(0,0,[-1/0,-MAX_SAFE_INTEGER]),final_ranges.splice(final_ranges.length,0,[MAX_SAFE_INTEGER,1/0])}return d3_merge(final_ranges)}return[min,max]},colorscale_helpers.getMinMax=function(chartObj){var colorData=colorscale_helpers.getAllColorData(chartObj);return d3_extent(colorData)},colorscale_helpers.getCategories=function(chartObj){var colorData=colorscale_helpers.getAllColorData(chartObj);return colorData.filter(function(d,i){return i===colorData.indexOf(d)})},colorscale_helpers.getAllColorData=function(chartObj){var colorData=[];return chartObj.seriesdata.forEach(function(series){if(!series.disabled){var curSeriesdata=series.data||series;colorscale_helpers.pushColorData(chartObj,curSeriesdata,colorData)}}),colorData},colorscale_helpers.pushColorData=function(chartObj,root,colorData){if(root&&isArray(root)&&root.every(isArray))root.forEach(function(child){colorscale_helpers.pushColorData(chartObj,child,colorData)});else{var clrValue=chartObj.dataset.getClr(root);colorData.push(clrValue)}},colorscale_helpers.isQuantileColorScale=function(chartObj){return chartObj.axes.clr?"quantile"===chartObj.axes.clr.scaleType:defined(chartObj.dataset.clridx)&&!chartObj.dataObject.isPolarAxisCategory&&chartObj.systemConf.legend.colorBand.type!==NONE},colorscale_helpers.getItemIndex=function(chartObj,indexScale,d,i){var clrValue=d&&chartObj.dataset.getClr(d);return indexScale?indexScale(clrValue):i},colorscale_helpers.getIndexScale=function(chartObj){var hasColorScale=colorscale_helpers.isQuantileColorScale(chartObj),user_ranges=chartObj.systemConf.legend.colorBand.ranges;if(hasColorScale&&user_ranges&&user_ranges.length){var scaleObj,pallete,colorScale=chartObj.axes.clr.scale,colorScale_domain=colorScale.domain(),patternPallete=chartObj.patternPallete,imagePallete=chartObj.imagePallete;imagePallete&&imagePallete.length?pallete=imagePallete:patternPallete&&patternPallete.length&&(pallete=patternPallete),pallete&&(scaleObj=colorScale.copy()).range(colorscale_helpers.getProcessedColorRange(d3_range(pallete.length),colorScale_domain,chartObj.systemConf.legend.colorBand,chartObj))}return scaleObj};var geometryUtils={rotatePoint:function(point,theta,origin){origin=origin||{x:0,y:0};var px=point.x,py=point.y,ox=origin.x,oy=origin.y;return{x:(px-ox)*mathCos(theta)+(py-oy)*mathSin(theta)+ox,y:(px-ox)*mathSin(theta)-(py-oy)*mathCos(theta)+oy}},pointInRectangle:function(point,rectangle){var x,y,x1=rectangle.x||0,y1=rectangle.y||0,x2=x1+rectangle.width,y2=y1+rectangle.height;return isArray(point)?(x=point[0],y=point[1]):(x=point.x,y=point.y),x1<=x&&x<=x2&&y1<=y&&y<=y2},degreeToRadian:function(degree){return degree/180*mathPI},areaOfEllipse:function(a,b){return mathPI*a*b}};function doOverlap(rect1,rect2){return!(rect1.x1>rect2.x2||rect2.x1>rect1.x2||rect1.y1>rect2.y2||rect2.y1>rect1.y2)}var dashStyles={solid:"",shortdash:"1.5,1.5",shortdot:"0.1,1.5",dashed:"2.5,2.5",longdash:"5,5",dotted:"0.1,2.5",shortdashdotdot:"1.5,2,0.1,2,0.1,2",dashdot:"2.5,2.5,0.1,2.5",longdashdot:"5,5,0.1,5",longdashdotdot:"5,2.5,0.1,2.5,0.1,2.5"};function getDashArray(dashStyleName,strokeWidth,scaleRatio){var inList=defined(dashStyles[dashStyleName]),dashStyle=pick(dashStyles[dashStyleName],dashStyleName,null);return defined(dashStyle)&&"solid"!==dashStyleName?(strokeWidth=inList?pick(strokeWidth,1):1,scaleRatio&&(strokeWidth*=scaleRatio),dashStyle.split(",").map(function(e){return+e*strokeWidth})):[]}function getLineCap(lineCap,dashStyle){return lineCap||(dashStyle&&/dot/g.test(dashStyle)?"round":null)}function dimension_based_intelligence(chartObj,factor,dimension){return dimension>=+chartObj.systemConf.canvas.intelligence.dimension[factor]}function datacount_based_intelligence(chartObj,factor){return+chartObj.systemConf.canvas.intelligence.dataCount[factor]>=chartObj.dataObject.totalnoofdatas}var BAR_CHARTNAME="bar",BULLET_CHARTNAME="bullet",GANTT_CHARTNAME="gantt",WATERFALL_CHARTNAME="waterfall",AREA_CHARTNAME="area",AREARANGE_CHARTNAME="arearange",LINE_CHARTNAME="line",SCATTER_CHARTNAME="scatter",GEOSCATTER_CHARTNAME="geoscatter",BUBBLE_CHARTNAME="bubble",GEOBUBBLE_CHARTNAME="geobubble",BUBBLEPIE_CHARTNAME="bubblepie",GEOBUBBLEPIE_CHARTNAME="geobubblepie",PIE_CHARTNAME="pie",DIAL_CHARTNAME="dial",FUNNEL_CHARTNAME="funnel",PYRAMID_CHARTNAME="pyramid",WEB_CHARTNAME="web",HEATMAP_CHARTNAME="heatmap",SUNBURST_CHARTNAME="sunburst",PACKEDBUBBLE_CHARTNAME="packedbubble",TREEMAP_CHARTNAME="treemap",WORDCLOUD_CHARTNAME="wordcloud",FADEALL_ANIMATION="fadeAll",FADEONEBYONE_ANIMATION="fadeOneByOne",FADERANDOM_ANIMATION="fadeRandom",FADE_ANIMATION="fade",SIZING_ANIMATION="sizing",SIZINGRANDOM_ANIMATION="sizingRandom",RANDOMOUT_ANIMATION="randomOut",VERTICAL_ANIMATION="vertical",VERTICALALL_ANIMATION="verticalAll",VERTPATHTWEEN_ANIMATION="vertPathTween",VERTPATHTWEENALL_ANIMATION="vertPathTweenAll",HORIZONTALALL_ANIMATION="horizontalAll",HORIPATHTWEEN_ANIMATION="horiPathTween",STROKETWEEN_ANIMATION="strokeTween",POINTTWEEN_ANIMATION="pointTween",POINTBYPOINT_ANIMATION="pointbypoint",ALLSERIES_ANIMATION="allseries",ONEBYONE_ANIMATION="onebyone",FANONEBYONE_ANIMATION="fanonebyone",FANALL_ANIMATION="fanAll",FAN_ANIMATION="fan",WHEEL_ANIMATION="wheel",INNER_ANIMATION="inner",LOCATION_MARKERS=d3.set(["geo-location-1","geo-location-2","geo-location-3","geo-flag-1","geo-flag-2","geo-flag-3","geo-pin-1","geo-pin-2","geo-pin-3"]);function getSVGsymbol(type){return function(size,side){if(LOCATION_MARKERS.has(type))return function(type,size,side){return side=pick(side,"outer"),{"geo-location-1":{outer:"M 0 "+-.9956*size+"C "+-.1506*size+" "+-.9956*size+" "+-.2845*size+" "+-.8718*size+" "+-.2845*size+" "+-.7279*size+"C "+-.2845*size+" "+-.7179*size+" "+-.2845*size+" "+-.7078*size+" "+-.2811*size+" "+-.6978*size+"C "+-.2744*size+" "+-.594*size+" "+-.2209*size+" "+-.5204*size+" "+-.1673*size+" "+-.4401*size+"C "+-.0971*size+" "+-.3363*size+" "+-.0167*size+" "+-.2159*size+" "+-.0167*size+" "+-.0084*size+"C "+-.0167*size+" "+.0017*size+" "+-.01*size+" "+.0084*size+" 0 "+.0084*size+"S "+.0167*size+" "+.0017*size+" "+.0167*size+" "+-.0084*size+"C "+.0167*size+" "+-.2192*size+" "+.0971*size+" "+-.3363*size+" "+.1673*size+" "+-.4401*size+"C "+.2209*size+" "+-.5204*size+" "+.2744*size+" "+-.594*size+" "+.2811*size+" "+-.6944*size+"C "+.2811*size+" "+-.7045*size+" "+.2845*size+" "+-.7145*size+" "+.2845*size+" "+-.7246*size+"C "+.2845*size+" "+-.8718*size+" "+.1506*size+" "+-.9956*size+" 0 "+-.9956*size+"z",inner:"M 0 "+-1.7333*size+"C "+.1267*size+" "+-1.7333*size+" "+.2333*size+" "+-1.6267*size+" "+.2333*size+" "+-1.5*size+"S "+.1267*size+" "+-1.2667*size+" 0 "+-1.2667*size+"S "+-.2333*size+" "+-1.3733*size+" "+-.2333*size+" "+-1.5*size+"S "+-.1267*size+" "+-1.7333*size+" 0 "+-1.7333*size+"z"},"geo-location-2":{outer:"M 0 "+-1*size+"C "+-.1933*size+" "+-1*size+" "+-.35*size+" "+-.8433*size+" "+-.35*size+" "+-.65*size+"C "+-.35*size+" "+-.31*size+" "+-.0233*size+" "+-.0167*size+" "+-.01*size+" "+-.0033*size+"C "+-.0067*size+" 0 "+-.0033*size+" 0 0 0S "+.0067*size+" 0 "+.01*size+" "+-.0033*size+"C "+.0233*size+" "+-.0167*size+" "+.35*size+" "+-.31*size+" "+.35*size+" "+-.65*size+"C "+.35*size+" "+-.8433*size+" "+.1933*size+" "+-1*size+" 0 "+-1*size+"z",inner:"M 0 "+-1.6667*size+"C "+.2*size+" "+-1.6667*size+" "+.3667*size+" "+-1.5*size+" "+.3667*size+" "+-1.3*size+"S "+.2*size+" "+-.9333*size+" 0 "+-.9333*size+"S "+-.3667*size+" "+-1.1*size+" "+-.3667*size+" "+-1.3*size+"S "+-.2*size+" "+-1.6667*size+" 0 "+-1.6667*size+"z"},"geo-pin-1":{outer:"M "+.2167*size+" "+-.7833*size+"C "+.2167*size+" "+-.9033*size+" "+.12*size+" "+-1*size+" 0 "+-1*size+"S "+-.2167*size+" "+-.9033*size+" "+-.2167*size+" "+-.7833*size+"C "+-.2167*size+" "+-.67*size+" "+-.1267*size+" "+-.5767*size+" "+-.0167*size+" "+-.5667*size+"L "+-.0167*size+" "+-.0167*size+"C "+-.0167*size+" "+-.0067*size+" "+-.01*size+" 0 0 0S "+.0167*size+" "+-.0067*size+" "+.0167*size+" "+-.0167*size+"L "+.0167*size+" "+-.5667*size+"C "+.1267*size+" "+-.5767*size+" "+.2167*size+" "+-.67*size+" "+.2167*size+" "+-.7833*size+"z",inner:"M 0 "+-1.8*size+"C "+-.1267*size+" "+-1.8*size+" "+-.2333*size+" "+-1.6933*size+" "+-.2333*size+" "+-1.5667*size+"C "+-.2333*size+" "+-1.5467*size+" "+-.2467*size+" "+-1.5333*size+" "+-.2667*size+" "+-1.5333*size+"S "+-.3*size+" "+-1.5467*size+" "+-.3*size+" "+-1.5667*size+"C "+-.3*size+" "+-1.7333*size+" "+-.1667*size+" "+-1.8667*size+" 0 "+-1.8667*size+"C "+.02*size+" "+-1.8667*size+" "+.0333*size+" "+-1.8533*size+" "+.0333*size+" "+-1.8333*size+"S "+.02*size+" "+-1.8*size+" 0 "+-1.8*size+"z"},"geo-pin-2":{outer:"M "+.304*size+" "+-.6935*size+"C "+.304*size+" "+-.8607*size+" "+.1672*size+" "+-.9975*size+" 0 "+-.9975*size+"S "+-.304*size+" "+-.8607*size+" "+-.304*size+" "+-.6935*size+"C "+-.304*size+" "+-.532*size+" "+-.1786*size+" "+-.4009*size+" "+-.019*size+" "+-.3914*size+"L "+-.019*size+" "+-.019*size+"C "+-.019*size+" "+-.0076*size+" "+-.0114*size+" 0 0 0S "+.019*size+" "+-.0076*size+" "+.019*size+" "+-.019*size+"L "+.019*size+" "+-.3914*size+"C "+.1786*size+" "+-.4009*size+" "+.304*size+" "+-.532*size+" "+.304*size+" "+-.6935*size+"z",inner:"M "+-.038*size+" "+-1.767*size+"C "+-.228*size+" "+-1.767*size+" "+-.38*size+" "+-1.615*size+" "+-.38*size+" "+-1.425*size+"C "+-.38*size+" "+-1.4022*size+" "+-.3648*size+" "+-1.387*size+" "+-.342*size+" "+-1.387*size+"S "+-.304*size+" "+-1.4022*size+" "+-.304*size+" "+-1.425*size+"C "+-.304*size+" "+-1.5732*size+" "+-.1862*size+" "+-1.691*size+" "+-.038*size+" "+-1.691*size+"C "+-.0152*size+" "+-1.691*size+" 0 "+-1.7062*size+" 0 "+-1.729*size+"S "+-.0152*size+" "+-1.767*size+" "+-.038*size+" "+-1.767*size+"z"},"geo-pin-3":{outer:"M "+.9442*size+" "+-.5854*size+"L "+.5451*size+" "+-.9826*size+"C "+.5376*size+" "+-.9901*size+" "+.5264*size+" "+-.9901*size+" "+.5189*size+" "+-.9826*size+"L "+.4196*size+" "+-.8833*size+"C "+.4159*size+" "+-.8795*size+" "+.414*size+" "+-.8758*size+" "+.414*size+" "+-.8702*size+"S "+.4159*size+" "+-.8608*size+" "+.4196*size+" "+-.857*size+"L "+.4721*size+" "+-.8046*size+"L "+.2248*size+" "+-.5554*size+"L "+.1161*size+" "+-.5236*size+"C "+.1105*size+" "+-.5217*size+" "+.1049*size+" "+-.5161*size+" "+.103*size+" "+-.5105*size+"C "+.1012*size+" "+-.5049*size+" "+.103*size+" "+-.4974*size+" "+.1087*size+" "+-.4917*size+"L "+.2473*size+" "+-.3531*size+"L "+-.0244*size+" "+-.0815*size+"C "+-.0431*size+" "+-.0628*size+" "+-.0431*size+" "+-.0328*size+" "+-.0244*size+" "+-.0159*size+"C "+-.015*size+" "+-.0066*size+" "+-.0037*size+" "+-.0028*size+" "+.0094*size+" "+-.0028*size+"S "+.0337*size+" "+-.0084*size+" "+.0431*size+" "+-.0159*size+"L "+.3147*size+" "+-.2876*size+"L "+.4533*size+" "+-.1489*size+"C "+.4571*size+" "+-.1452*size+" "+.4608*size+" "+-.1433*size+" "+.4665*size+" "+-.1433*size+"L "+.4702*size+" "+-.1433*size+"C "+.4758*size+" "+-.1452*size+" "+.4814*size+" "+-.1489*size+" "+.4833*size+" "+-.1564*size+"L "+.5152*size+" "+-.2651*size+"L "+.7643*size+" "+-.5142*size+"L "+.8168*size+" "+-.4618*size+"C "+.8243*size+" "+-.4543*size+" "+.8355*size+" "+-.4543*size+" "+.843*size+" "+-.4618*size+"L "+.9423*size+" "+-.5611*size+"C "+.9498*size+" "+-.5667*size+" "+.9498*size+" "+-.5779*size+" "+.9442*size+" "+-.5854*size+"z",inner:"M "+.0336*size+" "+-.0747*size+"C "+.0299*size+" "+-.0709*size+" "+.0224*size+" "+-.0709*size+" "+.0187*size+" "+-.0709*size+"C "+.0149*size+" "+-.0709*size+" "+.0112*size+" "+-.0709*size+" "+.0037*size+" "+-.0747*size+"C "+-.0037*size+" "+-.0821*size+" "+-.0037*size+" "+-.0933*size+" "+.0037*size+" "+-.1008*size+"L "+.5451*size+" "+-.6421*size+"L "+.5712*size+" "+-.616*size+"L "+.0336*size+" "+-.0747*size+"zM "+1.6539*size+" "+-.9856*size+"L "+1.5493*size+" "+-1.0901*size+"C "+1.5344*size+" "+-1.1051*size+" "+1.512*size+" "+-1.1051*size+" "+1.4971*size+" "+-1.0901*size+"L "+.9707*size+" "+-.5637*size+"C "+.9669*size+" "+-.56*size+" "+.9632*size+" "+-.5525*size+" "+.9595*size+" "+-.5488*size+"L "+.9109*size+" "+-.3845*size+"L "+.3136*size+" "+-.9819*size+"L "+.4555*size+" "+-1.0229*size+"L "+.6757*size+" "+-.8027*size+"C "+.6832*size+" "+-.7952*size+" "+.6944*size+" "+-.7915*size+" "+.7019*size+" "+-.7915*size+"S "+.7205*size+" "+-.7952*size+" "+.728*size+" "+-.8027*size+"C "+.7429*size+" "+-.8176*size+" "+.7429*size+" "+-.84*size+" "+.728*size+" "+-.8549*size+"L "+.5189*size+" "+-1.064*size+"L "+.9931*size+" "+-1.5381*size+"L "+1.176*size+" "+-1.3515*size+"C "+1.1835*size+" "+-1.344*size+" "+1.1947*size+" "+-1.3403*size+" "+1.2021*size+" "+-1.3403*size+"S "+1.2208*size+" "+-1.344*size+" "+1.2283*size+" "+-1.3515*size+"C "+1.2432*size+" "+-1.3664*size+" "+1.2432*size+" "+-1.3888*size+" "+1.2283*size+" "+-1.4037*size+"L "+1.0155*size+" "+-1.6165*size+"L "+.9147*size+" "+-1.7248*size+"L "+1.0603*size+" "+-1.8704*size+"L "+1.7995*size+" "+-1.1312*size+"L "+1.6539*size+" "+-.9856*size+"z"},"geo-flag-1":{outer:"M "+.7417*size+" "+-.6333*size+"C "+.735*size+" "+-.6467*size+" "+.7283*size+" "+-.6567*size+" "+.7217*size+" "+-.67*size+"C "+.7183*size+" "+-.6767*size+" "+.7117*size+" "+-.6833*size+" "+.7083*size+" "+-.69*size+"C "+.695*size+" "+-.7133*size+" "+.6917*size+" "+-.7433*size+" "+.6983*size+" "+-.77*size+"C "+.705*size+" "+-.7933*size+" "+.7183*size+" "+-.8167*size+" "+.735*size+" "+-.84*size+"C "+.7383*size+" "+-.8467*size+" "+.7417*size+" "+-.85*size+" "+.745*size+" "+-.8567*size+"C "+.7583*size+" "+-.8767*size+" "+.755*size+" "+-.9033*size+" "+.7383*size+" "+-.92*size+"C "+.6617*size+" "+-1*size+" "+.5317*size+" "+-1.0233*size+" "+.4283*size+" "+-.9767*size+"C "+.3983*size+" "+-.9633*size+" "+.375*size+" "+-.9467*size+" "+.3483*size+" "+-.93*size+"C "+.3317*size+" "+-.9167*size+" "+.315*size+" "+-.9067*size+" "+.295*size+" "+-.8967*size+"C "+.215*size+" "+-.85*size+" "+.1083*size+" "+-.85*size+" "+.025*size+" "+-.8967*size+"L "+.025*size+" "+-.9667*size+"C "+.025*size+" "+-.9867*size+" "+.0117*size+" "+-1*size+" "+-.0083*size+" "+-1*size+"S "+-.0417*size+" "+-.9867*size+" "+-.0417*size+" "+-.9667*size+"L "+-.0417*size+" "+-.0333*size+"C "+-.0417*size+" "+-.0133*size+" "+-.0283*size+" 0 "+-.0083*size+" 0S "+.025*size+" "+-.0133*size+" "+.025*size+" "+-.0333*size+"L "+.025*size+" "+-.4267*size+"C "+.0683*size+" "+-.41*size+" "+.115*size+" "+-.4*size+" "+.1617*size+" "+-.4*size+"C "+.2183*size+" "+-.4*size+" "+.2783*size+" "+-.4133*size+" "+.3283*size+" "+-.44*size+"C "+.3483*size+" "+-.45*size+" "+.3683*size+" "+-.4633*size+" "+.3883*size+" "+-.4767*size+"C "+.4117*size+" "+-.4933*size+" "+.435*size+" "+-.5067*size+" "+.4583*size+" "+-.52*size+"C "+.525*size+" "+-.55*size+" "+.615*size+" "+-.54*size+" "+.675*size+" "+-.49*size+"C "+.6917*size+" "+-.4767*size+" "+.7117*size+" "+-.4767*size+" "+.7283*size+" "+-.4833*size+"C "+.745*size+" "+-.4933*size+" "+.7583*size+" "+-.51*size+" "+.755*size+" "+-.53*size+"C "+.7583*size+" "+-.5667*size+" "+.755*size+" "+-.6*size+" "+.7417*size+" "+-.6333*size+"z",inner:"M "+.8633*size+" "+-1.1667*size+"C "+.8033*size+" "+-1.14*size+" "+.7567*size+" "+-1.1067*size+" "+.7033*size+" "+-1.0733*size+"C "+.67*size+" "+-1.0467*size+" "+.63*size+" "+-1.0267*size+" "+.5967*size+" "+-1.0067*size+"C "+.43*size+" "+-.9133*size+" "+.2167*size+" "+-.92*size+" "+.05*size+" "+-1.0067*size+"L "+.05*size+" "+-1.6467*size+"C "+.2433*size+" "+-1.5667*size+" "+.4767*size+" "+-1.5733*size+" "+.6633*size+" "+-1.6733*size+"C "+.7033*size+" "+-1.6933*size+" "+.7433*size+" "+-1.72*size+" "+.7833*size+" "+-1.7467*size+"C "+.83*size+" "+-1.78*size+" "+.8767*size+" "+-1.8067*size+" "+.9233*size+" "+-1.8333*size+"C "+1.07*size+" "+-1.9*size+" "+1.25*size+" "+-1.8667*size+" "+1.37*size+" "+-1.7667*size+"L "+1.3633*size+" "+-1.76*size+"C "+1.33*size+" "+-1.7067*size+" "+1.29*size+" "+-1.6533*size+" "+1.27*size+" "+-1.58*size+"C "+1.25*size+" "+-1.4933*size+" "+1.2567*size+" "+-1.4*size+" "+1.3033*size+" "+-1.32*size+"C "+1.31*size+" "+-1.3*size+" "+1.3233*size+" "+-1.2867*size+" "+1.3367*size+" "+-1.2667*size+"S "+1.3633*size+" "+-1.2267*size+" "+1.37*size+" "+-1.2133*size+"C "+1.3833*size+" "+-1.1867*size+" "+1.39*size+" "+-1.16*size+" "+1.39*size+" "+-1.1267*size+"C "+1.2233*size+" "+-1.22*size+" "+1.0233*size+" "+-1.24*size+" "+.8633*size+" "+-1.1667*size+"z"},"geo-flag-2":{outer:"M "+.6456*size+" "+-.928*size+"L "+.0538*size+" "+-.928*size+"L "+.0538*size+" "+-.9818*size+"C "+.0538*size+" "+-.9926*size+" "+.0466*size+" "+-.9998*size+" "+.0359*size+" "+-.9998*size+"L "+-.0359*size+" "+-.9998*size+"C "+-.0466*size+" "+-.9998*size+" "+-.0538*size+" "+-.9926*size+" "+-.0538*size+" "+-.9818*size+"L "+-.0538*size+" "+-.0134*size+"C "+-.0538*size+" "+-.0027*size+" "+-.0466*size+" "+.0045*size+" "+-.0359*size+" "+.0045*size+"L "+.0359*size+" "+.0045*size+"C "+.0466*size+" "+.0045*size+" "+.0538*size+" "+-.0027*size+" "+.0538*size+" "+-.0134*size+"L "+.0538*size+" "+-.4438*size+"L "+.6456*size+" "+-.4438*size+"C "+.6564*size+" "+-.4438*size+" "+.6635*size+" "+-.451*size+" "+.6635*size+" "+-.4618*size+"L "+.6635*size+" "+-.9101*size+"C "+.6635*size+" "+-.9209*size+" "+.6564*size+" "+-.928*size+" "+.6456*size+" "+-.928*size+"z",inner:"M "+.0359*size+" "+-.0717*size+"L "+-.0359*size+" "+-.0717*size+"L "+-.0359*size+" "+-1.9368*size+"L "+.0359*size+" "+-1.9368*size+"L "+.0359*size+" "+-.0717*size+"zM "+1.2553*size+" "+-.9684*size+"L "+.1076*size+" "+-.9684*size+"L "+.1076*size+" "+-1.7933*size+"L "+1.2553*size+" "+-1.7933*size+"L "+1.2553*size+" "+-.9684*size+"z"},"geo-flag-3":{inner:"M "+.664*size+" "+-.5013*size+"L "+.664*size+" "+-.508*size+"C "+.664*size+" "+-.5113*size+" "+.6607*size+" "+-.5113*size+" "+.6607*size+" "+-.5146*size+"C "+.6607*size+" "+-.5146*size+" "+.6607*size+" "+-.5179*size+" "+.6574*size+" "+-.5179*size+"L "+.5412*size+" "+-.664*size+"L "+.6574*size+" "+-.8101*size+"S "+.6574*size+" "+-.8134*size+" "+.6607*size+" "+-.8134*size+"C "+.6607*size+" "+-.8167*size+" "+.664*size+" "+-.8167*size+" "+.664*size+" "+-.82*size+"L "+.664*size+" "+-.841*size+"C "+.664*size+" "+-.8433*size+" "+.664*size+" "+-.8433*size+" "+.6607*size+" "+-.8466*size+"C "+.6607*size+" "+-.8499*size+" "+.6574*size+" "+-.8499*size+" "+.6574*size+" "+-.8532*size+"S "+.654*size+" "+-.8566*size+" "+.654*size+" "+-.8599*size+"C "+.654*size+" "+-.8599*size+" "+.6507*size+" "+-.8599*size+" "+.6507*size+" "+-.8632*size+"C "+.6474*size+" "+-.8632*size+" "+.6474*size+" "+-.8665*size+" "+.6441*size+" "+-.8665*size+"L "+.3685*size+" "+-.8665*size+"L "+.3685*size+" "+-.8964*size+"C "+.3685*size+" "+-.9163*size+" "+.3552*size+" "+-.9296*size+" "+.3353*size+" "+-.9296*size+"L "+.0332*size+" "+-.9296*size+"L "+.0332*size+" "+-.9628*size+"C "+.0332*size+" "+-.9827*size+" "+.0199*size+" "+-.996*size+" 0 "+-.996*size+"S "+-.0332*size+" "+-.9827*size+" "+-.0332*size+" "+-.9628*size+"L "+-.0332*size+" 0L "+.0332*size+" 0L "+.0332*size+" "+-.5312*size+"L "+.2988*size+" "+-.5312*size+"L "+.2988*size+" "+-.498*size+"C "+.2988*size+" "+-.4781*size+" "+.3121*size+" "+-.4648*size+" "+.332*size+" "+-.4648*size+"L "+.6308*size+" "+-.4648*size+"C "+.6341*size+" "+-.4648*size+" "+.6374*size+" "+-.4648*size+" "+.6441*size+" "+-.4681*size+"C "+.6441*size+" "+-.4681*size+" "+.6474*size+" "+-.4681*size+" "+.6474*size+" "+-.4714*size+"C "+.6474*size+" "+-.4714*size+" "+.6507*size+" "+-.4714*size+" "+.6507*size+" "+-.4748*size+"C "+.654*size+" "+-.4748*size+" "+.654*size+" "+-.4781*size+" "+.654*size+" "+-.4814*size+"C "+.654*size+" "+-.4814*size+" "+.6574*size+" "+-.4847*size+" "+.6574*size+" "+-.488*size+"S "+.6574*size+" "+-.4914*size+" "+.6607*size+" "+-.4947*size+"C "+.6607*size+" "+-.498*size+" "+.6607*size+" "+-.498*size+" "+.664*size+" "+-.5013*size+"C "+.6607*size+" "+-.5013*size+" "+.6607*size+" "+-.5013*size+" "+.6607*size+" "+-.5046*size+"C "+.664*size+" "+-.498*size+" "+.664*size+" "+-.5013*size+" "+.664*size+" "+-.5013*size+"z",outer:"M "+.664*size+" "+-.5013*size+"L "+.664*size+" "+-.508*size+"C "+.664*size+" "+-.5113*size+" "+.6607*size+" "+-.5113*size+" "+.6607*size+" "+-.5146*size+"C "+.6607*size+" "+-.5146*size+" "+.6607*size+" "+-.5179*size+" "+.6574*size+" "+-.5179*size+"L "+.5412*size+" "+-.664*size+"L "+.6574*size+" "+-.8101*size+"S "+.6574*size+" "+-.8134*size+" "+.6607*size+" "+-.8134*size+"C "+.6607*size+" "+-.8167*size+" "+.664*size+" "+-.8167*size+" "+.664*size+" "+-.82*size+"L "+.664*size+" "+-.841*size+"C "+.664*size+" "+-.8433*size+" "+.664*size+" "+-.8433*size+" "+.6607*size+" "+-.8466*size+"C "+.6607*size+" "+-.8499*size+" "+.6574*size+" "+-.8499*size+" "+.6574*size+" "+-.8532*size+"S "+.654*size+" "+-.8566*size+" "+.654*size+" "+-.8599*size+"C "+.654*size+" "+-.8599*size+" "+.6507*size+" "+-.8599*size+" "+.6507*size+" "+-.8632*size+"C "+.6474*size+" "+-.8632*size+" "+.6474*size+" "+-.8665*size+" "+.6441*size+" "+-.8665*size+"L "+.3685*size+" "+-.8665*size+"L "+.3685*size+" "+-.8964*size+"C "+.3685*size+" "+-.9163*size+" "+.3552*size+" "+-.9296*size+" "+.3353*size+" "+-.9296*size+"L "+.0332*size+" "+-.9296*size+"L "+.0332*size+" "+-.9628*size+"C "+.0332*size+" "+-.9827*size+" "+.0199*size+" "+-.996*size+" 0 "+-.996*size+"S "+-.0332*size+" "+-.9827*size+" "+-.0332*size+" "+-.9628*size+"L "+-.0332*size+" 0L "+.0332*size+" 0L "+.0332*size+" "+-.5312*size+"L "+.2988*size+" "+-.5312*size+"L "+.2988*size+" "+-.498*size+"C "+.2988*size+" "+-.4781*size+" "+.3121*size+" "+-.4648*size+" "+.332*size+" "+-.4648*size+"L "+.6308*size+" "+-.4648*size+"C "+.6341*size+" "+-.4648*size+" "+.6374*size+" "+-.4648*size+" "+.6441*size+" "+-.4681*size+"C "+.6441*size+" "+-.4681*size+" "+.6474*size+" "+-.4681*size+" "+.6474*size+" "+-.4714*size+"C "+.6474*size+" "+-.4714*size+" "+.6507*size+" "+-.4714*size+" "+.6507*size+" "+-.4748*size+"C "+.654*size+" "+-.4748*size+" "+.654*size+" "+-.4781*size+" "+.654*size+" "+-.4814*size+"C "+.654*size+" "+-.4814*size+" "+.6574*size+" "+-.4847*size+" "+.6574*size+" "+-.488*size+"S "+.6574*size+" "+-.4914*size+" "+.6607*size+" "+-.4947*size+"C "+.6607*size+" "+-.498*size+" "+.6607*size+" "+-.498*size+" "+.664*size+" "+-.5013*size+"C "+.6607*size+" "+-.5013*size+" "+.6607*size+" "+-.5013*size+" "+.6607*size+" "+-.5046*size+"C "+.664*size+" "+-.498*size+" "+.664*size+" "+-.5013*size+" "+.664*size+" "+-.5013*size+"z"},"geo-location-3":{outer:"M "+-.3654*size+" "+-.928*size+"L "+-.3654*size+" "+-.3712*size+"C "+-.319*size+" "+-.1392*size+" "+-.1334*size+" "+-.0928*size+" "+.0058*size+" 0C "+.145*size+" "+-.0928*size+" "+.3306*size+" "+-.1392*size+" "+.377*size+" "+-.3712*size+"L "+.377*size+" "+-.928*size+"C "+.0522*size+" "+-1.0208*size+" "+-.0406*size+" "+-1.0208*size+" "+-.3654*size+" "+-.928*size+"Z",inner:"M "+-.5452*size+" "+-1.392*size+"L "+-.174*size+" "+-1.392*size+"L "+.0116*size+" "+-1.7632*size+"L "+.1972*size+" "+-1.392*size+"L "+.5684*size+" "+-1.392*size+"L "+.29*size+" "+-1.1136*size+"L "+.4756*size+" "+-.6496*size+"L "+.0116*size+" "+-.928*size+"L "+-.4524*size+" "+-.6496*size+"L "+-.2668*size+" "+-1.1136*size}}[type][side]}(type,size,side);switch(type){case"asterisk":return"M0 0 C"+-.25*size+" "+-.65*size+" "+.25*size+" "+-.65*size+" 0 0 C"+.5*size+" "+-.633*size+" "+.65*size+" "+-.117*size+" 0 0 C"+.583*size+" "+.083*size+" "+.583*size+" "+.65*size+" 0 0 C"+.25*size+" "+.65*size+" "+-.25*size+" "+.65*size+" 0 0 C"+-.617*size+" "+.65*size+" "+-.55*size+" "+.017*size+" 0 0 C"+-.483*size+" "+-.05*size+" "+-.583*size+" "+-.717*size+" 0 0 Z";case"bean":return"M0 "+.5*size+" A"+.25*size+" "+.5*size+" 0 0 1 0 "+.5*-size+" A"+.15*size+" "+.25*size+" 0 0 1 1 0 A"+.15*size+" "+.25*size+" 0 0 1 0 "+.5*size;case"butterfly":return"M0 "+.25*-size+" C0 "+.25*-size+" "+.85*size+" "+-size+" "+.3*size+" "+.25*size+" C"+.6*size+" "+.7*size+" 0 "+.4*size+" 0 "+.4*size+" M0 "+.25*-size+" C0 "+.25*-size+" "+.85*-size+" "+-size+" "+.3*-size+" "+.25*size+" C"+.6*-size+" "+.7*size+" 0 "+.4*size+" 0 "+.4*size+" M0 "+.25*-size+" L"+.1*size+" "+.5*-size+" M0 "+.25*-size+" L"+.1*-size+" "+.5*-size;case"clover":return"M"+.033*size+" "+-.033*size+" C"+-.133*size+" "+-.966*size+" "+1.066*size+" "+-.116*size+" "+.1*size+" "+.033*size+" C"+.933*size+" "+.233*size+" "+-.133*size+" "+.9*size+" "+.016*size+" "+.083*size+" C"+-.633*size+" "+.6*size+" "+-.6*size+" "+-.6*size+" "+.033*size+" "+-.033*size+" Z";case"cloverFour":return"M"+.05*-size+" "+.05*-size+" C"+.4*-size+" "+.6*-size+" "+.4*size+" "+.6*-size+" "+.05*size+" "+.05*-size+" C"+.6*size+" "+.4*-size+" "+.6*size+" "+.4*size+" "+.05*size+" "+.05*size+" C"+.4*size+" "+.6*size+" "+.4*-size+" "+.6*size+" "+.05*-size+" "+.05*size+" C"+.6*-size+" "+.4*size+" "+.6*-size+" "+.4*-size+" "+.05*-size+" "+.05*-size+" Z";case"cross":return"M"+-size/2+" "+.2*-size+" L"+.2*-size+" "+.2*-size+" L"+.2*-size+" "+-size/2+" L"+.2*size+" "+-size/2+" L"+.2*size+" "+.2*-size+" L"+size/2+" "+.2*-size+" L"+size/2+" "+.2*size+" L"+.2*size+" "+.2*size+" L"+.2*size+" "+size/2+" L"+.2*-size+" "+size/2+" L"+.2*-size+" "+.2*size+" L"+-size/2+" "+.2*size+" Z";case"diamond":return"M"+.4*-size+" 0 L0 "+-size/2+" L"+.4*size+" 0 L0 "+size/2+" Z";case"ellipse":return"M"+.5*-size+" 0 A"+.5*size+" "+.35*size+" 0 0 1 "+.5*size+" 0 A"+.5*size+" "+.35*size+" 0 0 1 "+.5*-size+" 0";case"gear":return"M"+-.088*size+" "+-.365*size+" L"+-.084*size+" "+-.471*size+" L"+.092*size+" "+-.471*size+" L"+.097*size+" "+-.369*size+" L"+.194*size+" "+-.317*size+" L"+.27*size+" "+-.386*size+" L"+.409*size+" "+-.263*size+" L"+.339*size+" "+-.189*size+" L"+.364*size+" "+-.088*size+" L"+.478*size+" "+-.088*size+" L"+.478*size+" "+.097*size+" L"+.369*size+" "+.097*size+" L"+.325*size+" "+.192*size+" L"+.394*size+" "+.265*size+" L"+.254*size+" "+.396*size+" L"+.197*size+" "+.325*size+" L"+.092*size+" "+.364*size+" L"+.092*size+" "+.476*size+" L"+-.084*size+" "+.476*size+" L"+-.084*size+" "+.364*size+" L"+-.185*size+" "+.32*size+" L"+-.263*size+" "+.394*size+" L"+-.388*size+" "+.26*size+" L"+-.317*size+" "+.192*size+" L"+-.354*size+" "+.097*size+" L"+-.473*size+" "+.097*size+" L"+-.473*size+" "+-.091*size+" L"+-.356*size+" "+-.091*size+" L"+-.317*size+" "+-.189*size+" L"+-.384*size+" "+-.258*size+" L"+-.267*size+" "+-.384*size+" L"+-.184*size+" "+-.312*size+" L"+-.088*size+" "+-.365*size+" Z";case"heart":return"M0 "+.2*-size+" C"+.65*size+" "+.65*-size+" "+.65*size+" "+.2*size+" 0 "+.45*size+" C"+.65*-size+" "+.2*size+" "+.65*-size+" "+.65*-size+" 0 "+.2*-size+"Z";case"star":return"M0 "+.5*-size+" L"+.122*size+" "+.12*-size+" L"+.5*size+" "+.12*-size+" L"+.197*size+" "+.12*size+" L"+.306*size+" "+.5*size+" L0 "+.274*size+" L"+.306*-size+" "+.5*size+" L"+.197*-size+" "+.12*size+" L"+.5*-size+" "+.12*-size+" L"+.122*-size+" "+.12*-size+" Z";case"malteseCross":return"M"+.3*-size+" "+.4*-size+" A"+.3*size+" "+.1*size+" 0 0 1 "+.3*size+" "+.4*-size+" L"+.2*size+" "+.2*-size+" L"+.4*size+" "+.3*-size+" A"+.1*size+" "+.3*size+" 0 0 1 "+.4*size+" "+.3*size+" L"+.2*size+" "+.2*size+" L"+.3*size+" "+.4*size+" A"+.3*size+" "+.1*size+" 0 0 1 "+.3*-size+" "+.4*size+" L"+.2*-size+" "+.2*size+" L"+.4*-size+" "+.3*size+" A"+.1*size+" "+.3*size+" 0 0 1 "+.4*-size+" "+.3*-size+" L"+.2*-size+" "+.2*-size+" Z";case"square":return"M"+.5*-size+" "+.5*-size+" L"+.5*size+" "+.5*-size+" "+.5*size+" "+.5*size+" "+.5*-size+" "+.5*size+" Z";case"triangle-up":return"M"+.5*-size+" "+.285*size+" L0 "+.43*-size+" "+.5*size+" "+.285*size+" Z";case"triangle-down":return"M0 "+.43*size+" L"+.5*-size+" "+.285*-size+" L"+.5*size+" "+.285*-size+" Z";case"triangle-right":return"M"+.5*-size+" "+.43*-size+" L"+.285*size+" 0 L"+.5*-size+" "+.43*size+" Z";case"triangle-left":return"M"+.5*size+" "+.43*size+" L"+.285*-size+" 0 L"+.5*size+" "+.43*-size+" Z";case"arrow":return"M"+.5*-size+" "+.2*size+" L0 "+.5*-size+" "+.5*size+" "+.2*size+" "+.25*size+" "+.2*size+" "+.25*size+" "+.5*size+" "+.25*-size+" "+.5*size+" "+.25*-size+" "+.2*size+" Z";case"rocket":return"M"+.5*-size+" "+.5*size+" L0 "+.5*-size+" "+.5*size+" "+.5*size+" 0 "+.25*size+" "+.5*-size+" "+.5*size+" Z";case"nylon":return"M"+-size/2+" "+-size/4+" L"+-size/4+" "+-size/4+" L"+-size/4+" "+-size/2+" M"+-size/4+" 0 L"+-size/4+" "+size/4+" L0 "+size/4+" M0 "+-size/4+" L"+size/4+" "+-size/4+" L"+size/4+" 0 M"+size/4+" "+size/2+" L"+size/4+" "+size/4+" L"+size/2+" "+size/4;case"waves":return"M"+-size+" 0 C"+7*-size/8+" "+-size/4+" "+5*-size/8+" "+-size/4+" "+-size/2+" 0 C"+3*-size/8+" "+-size/4+" "+-size/8+" "+-size/4+" 0 0 C"+size/8+" "+size/4+" "+3*size/8+" "+size/4+" "+size/2+" 0 C"+5*size/8+" "+-size/4+" "+7*size/8+" "+-size/4+" "+3*size/4+" 0";case"woven":return"M"+-size/4+" "+-size/4+" L"+size/4+" "+size/4+" M"+size/4+" "+-size/4+" L"+size/2+" "+-size/2+" M"+-size/4+" "+size/4+" L"+-size/2+" "+size/2+" M"+size/4+" "+3*size/4+" L"+3*size/4+" "+size/4;case"crosses":return"M "+-size/4+" "+-size/4+" L"+size/4+","+size/4+" M"+-size/4+","+size/4+" L"+size/4+","+-size/4;case"caps":return"M"+-size/4+" "+size/4+" L0 "+-size/4+" "+size/4+" "+size/4;case"hexagons":return"M"+-size/2+" 0 L"+-size/4+" 0 M"+size/2+" 0 L"+size/4+" "+-size/2+" L0 "+-size/2+" L"+-size/4+" 0 L0 "+size/2+" L"+size/4+" "+size/2+"Z";case"line":case"horizontal-line":return"M"+.5*-size+" 0 L"+.5*size+" 0";case"diagonal-line-right":return"M"+3*-size/4+" "+-size/4+" L"+-size/4+" "+3*-size/4+" M"+-size/2+" "+size/2+" L"+size/2+" "+-size/2+" M"+size/4+" "+3*size/4+" L"+3*size/4+" "+size/4;case"vertical-line":return"M0 "+-size/2+" L0 "+size/2;case"hexagon":return"M"+.433*size+" "+.25*size+" L"+0*size+" "+.5*size+" L"+-.433*size+" "+.25*size+" L"+-.433*size+" "+-.26*size+" L"+0*size+" "+-.5*size+" L"+.433*size+" "+-.26*size+" Z";case"diagonal-line-left":return"M"+3*-size/4+" "+-size/2+" L"+-size/4+" "+size/2+" M"+-size/4+" "+-size/2+" L"+size/4+" "+size/2+" M"+size/4+" "+-size/2+" L"+3*size/4+" "+size/2;case"oval":return"M"+-size/2+" 0 A"+size/2+" "+size/2+" 0 0 1 0 "+-size/2+" A"+size/2+" "+size/2+" 0 0 1 "+-size/2+" 0";case"rect":var w=arguments[0],h=arguments[1]||0;return"M"+-w/2+" "+-h/2+" L"+w/2+" "+-h/2+" L"+w/2+" "+h/2+" L"+-w/2+" "+h/2+"Z";case"ninja":return"M"+-.267*size+" "+-.367*size+" L"+.167*size+" "+-.133*size+" L"+.433*size+" "+-.267*size+" L"+.2*size+" "+.167*size+" L"+.333*size+" "+.433*size+" L"+-.1*size+" "+.167*size+" L"+-.367*size+" "+.333*size+" L"+-.167*size+" "+-.1*size+" Z";default:return"M"+-size/2+" 0 A"+size/2+" "+size/2+" 0 0 1 "+size/2+" 0 A"+size/2+" "+size/2+" 0 0 1 "+-size/2+" 0"}}}function addSVGmarker(parentElement,id,markeroptions,extraParams,chartObj){var marker,color=extraParams.color,sw=extraParams.strokeWidth,img=extraParams.imageSize,tran=extraParams.transform,symbolpath=getSVGsymbol(markeroptions.symbol||extraParams.symbol),hasImage=null!=markeroptions.imageUrl&&""!==markeroptions.imageUrl,size=validateNullVal(markeroptions.size,validateNullVal(sw,1)),outersize=size*extraParams.symbolSize.outer,innersize=size*extraParams.symbolSize.inner,transform=null!=tran?"translate("+tran[0]+","+tran[1]+")":null,imgSize=(null!=id?size:outersize)*(null!=img?img:10);null!=id?(marker=appendEle(chartObj.getPatternSvg().select("defs"),"marker",[1],"#","id",id)).attrs({id:id,orient:0,viewBox:10*-size/2+" "+10*-size/2+" "+10*size+" "+10*size,markerUnits:"userSpaceOnUse",markerWidth:10*size,markerHeight:10*size}):marker=parentElement;appendEle(marker,"path",[1],".","class","outer").attrs({d:symbolpath(hasImage?imgSize:10*outersize),transform:transform}).styles({fill:function(){if(hasImage){var conf={name:markeroptions.imageUrl,width:imgSize,height:imgSize,x:-imgSize/2,y:-imgSize/2};return"url("+getDefsLocation()+"#"+effects.get(effects.svg_patterns,"imageFill",conf,{chartObj:chartObj})+")"}return markeroptions.outerFillColor||color},"fill-opacity":markeroptions.outerFillOpacity,stroke:markeroptions.outerStrokeColor||color,"stroke-opacity":markeroptions.outerStrokeOpacity,"stroke-width":markeroptions.outerStrokeWidth,"stroke-dasharray":getDashArray(markeroptions.outerDashStyle,markeroptions.outerStrokeWidth),"stroke-linecap":getLineCap(markeroptions.outerLineCap,markeroptions.outerDashStyle)});var innerPathData=[1],innerFillColor=markeroptions.innerFillColor||color;return(hasImage||0===markeroptions.innerStrokeWidth&&(0===markeroptions.innerFillOpacity||"transparent"===innerFillColor))&&(innerPathData=[]),appendEle(marker,"path",innerPathData,".","class","inner").attrs({d:symbolpath(10*innersize,"inner"),transform:transform}).styles({fill:markeroptions.innerFillColor||color,"fill-opacity":markeroptions.innerFillOpacity,stroke:markeroptions.innerStrokeColor||color,"stroke-opacity":markeroptions.innerStrokeOpacity,"stroke-width":markeroptions.innerStrokeWidth,"stroke-dasharray":getDashArray(markeroptions.innerDashStyle,markeroptions.innerStrokeWidth),"stroke-linecap":getLineCap(markeroptions.innerLineCap,markeroptions.innerDashStyle)}),marker}function getMarkerSize(chart){var DIM={left:0,top:0,right:0,bottom:0};if(!chart.isAxisCategory)return DIM;var xaxis=chart.systemConf.chart.axes.xaxis,yaxes=chart.systemConf.chart.axes.yaxis,cXmin=null!=xaxis.minRange&&""!==xaxis.minRange,cXmax=null!=xaxis.maxRange&&""!==xaxis.maxRange,cYmin=yaxes.some(function(d){return null!=d.minRange&&""!==d.minRange}),cYmax=yaxes.some(function(d){return null!=d.maxRange&&""!==d.maxRange});if(cXmin&&cXmax&&cYmin&&cYmax)return DIM;var rotated=chart.axes.rotated,commonPlotoptions=(chart.dataset.seriesTypes,chart.systemConf.chart.plot.plotoptions),canvasarea=chart.canvasarea,ms=d3_max(chart.seriesdata.map(function(d,i){var plotoptions=d.plotoptions,markerSize=0,cName=chart.chartTypes[i].name,gvp=utils.getValueOfPlotOptions(plotoptions?plotoptions.marker:null,commonPlotoptions[cName].marker);/(area|arearange|line)/.test(cName)&&gvp("enabled")&&datacount_based_intelligence(chart,"marker")&&dimension_based_intelligence(chart,"marker",mathMin(canvasarea.width,canvasarea.height))?markerSize=validateNullVal(gvp("size"),validateNullVal(plotoptions?plotoptions.strokeWidth:commonPlotoptions[cName].strokeWidth,1)):cName===SCATTER_CHARTNAME&&(markerSize=validateNullVal(gvp("size"),2));return 10*markerSize}))/2;return{left:(rotated?cYmin:cXmin)?DIM.left:ms,top:(rotated?cXmax:cYmax)?DIM.top:ms,right:(rotated?cYmax:cXmax)?DIM.right:ms,bottom:(rotated?cXmin:cYmin)?DIM.bottom:ms}}function blinkSVGsymbols(ele,blinkConf,chartObj){if($Browser.IE&&blinkConf.enabled)!function(ele,blinkConf,repeat){var count=defined(repeat)?repeat-1:blinkConf.repeat||1/0;if(!ele.node()||!count)return void ele.styles({transform:null,opacity:null});var isFade=(blinkConf.type||"twinkle")===FADE_ANIMATION,dur=(blinkConf.duration||800)/2,ease=d3_ease(blinkConf.easingType),dur1=dur,del1=isFade?500:0,dur2=isFade?0:dur,start=isFade?{transform:"scale(1)",opacity:0}:{transform:"scale(0)"},end=isFade?{transform:"scale(0)",opacity:1}:{transform:"scale(1)"};ele.transition(),ele.attrs(end).transition().delay(del1).duration(dur1).ease(ease).attrs(start).transition().duration(dur2).ease(ease).attrs(end).on("end",function(){blinkSVGsymbols(ele,blinkConf,count)})}(ele,blinkConf);else{var defaultstyles={animation:NULL,opacity:NULL,transform:NULL};if(blinkConf.enabled){var repeat=defined(blinkConf.repeat)?blinkConf.repeat:"infinite",type=blinkConf.type||"twinkle",duration=(blinkConf.duration||800)/1e3,delay=("fade"===type?250:0)/1e3,easingType=blinkConf.easingType||"linear",styleNode=appendEle(d3_select(getRootBody(chartObj.container.node())).selectAll("div.__baseZC_Container__"),"style",[1]).node(),keyFrame="",animationID="ZC"+generateIdByPropValue(blinkConf,"blink");switch(type){case"twinkle":keyFrame="\n@keyframes "+animationID+" { 0% {transform: scale(1);}50% {transform: scale(0);}100% {transform: scale(1);} }\n";break;case"fade":keyFrame="\n@keyframes "+animationID+" { 0% {transform: scale(0);opacity: 1;}100% {transform: scale(1);opacity: 0;} }\n",ele.styles({transform:"scale(0)",opacity:1})}$ZC[animationID]||(styleNode.innerHTML+=keyFrame,$ZC[animationID]=!0),ele.style("animation",animationID+" "+duration+"s "+easingType+" "+delay+"s "+repeat).on("animationend",function(){d3.select(this).styles(defaultstyles)})}else ele.styles(defaultstyles)}}function getEventConf(plotOptions,commonPlotOptions,chartObj,eventType,bulletRect){var events_cpo=commonPlotOptions.events,events_plot=chartObj.systemConf.chart.plot.events;defined(bulletRect)&&(events_cpo=commonPlotOptions[bulletRect.type]&&commonPlotOptions[bulletRect.type].events);var eventFn=defined(plotOptions)&&defined(plotOptions.events)?utils.getValueOfPlotOptions(plotOptions.events,events_cpo)(eventType):null!=events_cpo?events_cpo[eventType]:null!=events_plot?events_plot[eventType]:null;return void 0===eventFn&&events_plot&&(eventFn=events_plot[eventType]),eventFn}function getEventObject(e){return e.changedTouches?e.changedTouches[0]:e}function isAreaChartType(type){return type===charttype.area||type===charttype.stkdarea||type===charttype.arearange}function isBarChartType(type){return type===charttype.bar||type===charttype.stkdbar||type===charttype.bullet||type===charttype.gantt||isHeatMapChartType(type)&&type!==charttype.geoheatmap||type===charttype.waterfall}function isScatterChartType(type){return-1!=chartcategory.dotPlot.indexOf(type)}function isBubbleChartType(type){return chartcategory.bubble.has(type)||chartcategory.bubblePie.has(type)}function isWaterfallChartType(type){return type===charttype.waterfall}function isPointChartType(type){return isScatterChartType(type)||type===charttype.bubblepie}function isSunburstChartType(type){return type===charttype.sunburst}function isHeatMapChartType(type){return type===charttype.heatmap||type===charttype.geoheatmap}function isPieChartType(type){return-1!=chartcategory.piePlot.indexOf(type)}function isMultiPieChartType(type){return isPieChartType(type)&&type!==charttype.pie}function isGeoHeatMapChartType(type){return type===charttype.geoheatmap}function getBarPosition(chart,point,seriesIndex,commonOption){var getTransRectValue=function(){return chart.dataObject.getTransRectValue.apply(chart.dataObject,toArray(arguments))};return{x:getTransRectValue("x",point,seriesIndex,0,commonOption),y:getTransRectValue("y",point,seriesIndex,0,commonOption),width:getTransRectValue("width",point,seriesIndex,0,commonOption),height:getTransRectValue("height",point,seriesIndex,0,commonOption)}}function getHeatCellPosition(chartObj,dataPoint,xscale,yscale,yaxiscolumnorder){var x,y,w,h,dataset=chartObj.dataset,commonPlotOptions=chartObj.systemConf.chart.plot.plotoptions.heatmap,symbolPath=commonPlotOptions.symbol&&getSVGsymbol(commonPlotOptions.symbol),xValue=dataset.getX(dataPoint),yValue=dataset.getY(dataPoint,yaxiscolumnorder),zValue=chartObj.dataObject.hasZaxis?chartObj.zscale(dataset.getZ(dataPoint)||chartObj.zscale.domain()[0]):1,xBand=xscale.bandwidth(),yBand=yscale.bandwidth(),padding=commonPlotOptions.padding||0,xBandWithPadding=xBand-2*mathMin(padding,.4*xBand),yBandWithPadding=yBand-2*mathMin(padding,.4*yBand);return chartObj.axes.rotated?(w=yBandWithPadding*zValue,h=xBandWithPadding*zValue,symbolPath&&(w=h=mathMin(w,h)),y=xscale(xValue)+(xBand-h)/2,x=yscale(yValue)+(yBand-w)/2):(w=xBandWithPadding*zValue,h=yBandWithPadding*zValue,symbolPath&&(w=h=mathMin(w,h)),x=xscale(xValue)+(xBand-w)/2,y=yscale(yValue)+(yBand-h)/2),{x:x,y:y,width:w,height:h}}function crosshair_enabled(chartObj){return chartObj.systemConf.tooltip.crosshair.type!=NONE}function setPointerEvents(chartObj,element,disabled){if(colorscale_helpers.isQuantileColorScale(chartObj)){var seriesdata_0=chartObj.chartTypes[0].value===charttype.pyramid?chartObj.seriesdata[0].data[0]:NULL;element.style("pointer-events",function(d,i){var dt=seriesdata_0?seriesdata_0[seriesdata_0.length-1-i]:d.data||d,clrValue=chartObj.dataset.getClr(dt);if(disabled||!isWithinColorRange(clrValue,chartObj))return NONE})}}function getTooltipPosition(event,coordinates,x,y,chartObj,point,axisrotated,sharedTooltip,sharedTooltipInfo,isOrdinalChart,isPolar,fillColorFunc){var tooltipPos=null,plotarea=chartObj.plotarea,plotarea_approx=chartObj.plotarea_approx;point=point||{},sharedTooltip&&crosshair_enabled(chartObj)?axisrotated?tooltipPos={actLeft:x+plotarea.left,actTop:coordinates.y+plotarea.top,top:coordinates.y,left:isOrdinalChart?plotarea.width:coordinates.x}:(tooltipPos={top:0,actTop:plotarea.top+y},isOrdinalChart?(tooltipPos.left=coordinates.x,tooltipPos.actLeft=coordinates.x+plotarea.left):(tooltipPos.left=x,tooltipPos.actLeft=plotarea.left+x)):isOrdinalChart?(tooltipPos={left:coordinates.x,top:coordinates.y},axisrotated?(tooltipPos.actLeft=x+plotarea.left,tooltipPos.actTop=coordinates.y+plotarea.top):(tooltipPos.actLeft=coordinates.x+plotarea.left,tooltipPos.actTop=y+plotarea.top)):tooltipPos={left:x,top:y,actLeft:plotarea.left+x,actTop:plotarea.top+y};var dLeft=coordinates.x-event.clientX,dTop=coordinates.y-event.clientY;return tooltipPos.dLeft=dLeft+plotarea.left,tooltipPos.dTop=dTop+plotarea.top,tooltipPos.left-=dLeft,tooltipPos.top-=dTop,tooltipPos.dLeft=dLeft+plotarea.left,tooltipPos.dTop=dTop+plotarea.top,tooltipPos.helpers={seriesindex:point.seriesPos,subseriespos:isArray(point.subseriesindex)?point.subseriesindex[point.seriesPos]:point.subseriesindex,subseriesLength:isArray(point.subseriesLength)?point.subseriesLength[point.seriesPos]:point.subseriesLength,itempos:point.itemPos,itemposShared:point.itemPosShared,color:chartObj.seriesColor,tooltipSharedInfo:sharedTooltipInfo,tooltipShared:sharedTooltip,svgFillFunc:fillColorFunc||chartObj.renderer[point.seriesPos]&&chartObj.renderer[point.seriesPos].fillColorFunc,inheritColors:chartObj.dataObject.isWaterfallEnabled},isPolar&&(tooltipPos.dLeft+=plotarea_approx.x,tooltipPos.dTop+=plotarea_approx.y),tooltipPos}function getColumnIdxBasedOnDataindex(chartObj,options){return chartObj.userdata.metadata.columns.filter(function(d){return d.dataindex===options.dataindex})[0]}function pointInRectangle(x,y,rectangle){return geometryUtils.pointInRectangle({x:x,y:y},rectangle)}function getTriggeringOffset(chartInstance,cType,bubbleTriggerOffset){var triggerOffset=null,commonPlotOptions=chartInstance.systemConf.chart.plot.plotoptions[charttypenames.get(cType)],isContinuousPointType=isPointChartType(cType)||cType===charttype.line,filledChartType=!isContinuousPointType,customTriggerOffset=commonPlotOptions&&commonPlotOptions.events&&commonPlotOptions.events.triggerOffset;if(defined(customTriggerOffset))triggerOffset=customTriggerOffset;else if(isBubbleChartType(cType)){if(3===arguments.length)triggerOffset=arguments[2];else triggerOffset=chartInstance.zscale.range()[1]/2+(chartInstance.dataObject.isCombinationalChart?10:50)}else triggerOffset=filledChartType||chartInstance.systemConf.tooltip.sharedSeriesInfo?null:chartInstance.dataObject.isCombinationalChart&&isContinuousPointType?10:50;return triggerOffset}function rgb2hex(color){var rgb=color.match(RGBA_PATTERN);return rgb&&5===rgb.length?"#"+("0"+parseInt(rgb[1],10).toString(16)).slice(-2)+("0"+parseInt(rgb[2],10).toString(16)).slice(-2)+("0"+parseInt(rgb[3],10).toString(16)).slice(-2):color}function rgba_canvas(color,opacity){opacity=pick(opacity,1);var rgb=d3_rgb(color);return"rgba("+rgb.r+","+rgb.g+","+rgb.b+","+opacity*rgb.opacity+")"}function getColorCopy(color,k,copyType,colorMode){return color===TRANSPARENT?color:(copyType=pick(copyType,"darker"),pick(colorMode,d3$1.rgb)(color)[copyType](k).toString())}function getFillColor(chartObj,seriesIndex,gradientDim,dontUsePatternPallete,customRendererMode){var defsLocation=chartObj.defsLocation,chartName=chartObj.chartTypes[seriesIndex].name,cType=chartObj.chartTypes[seriesIndex].value,commonPlotOptions=chartObj.systemConf.chart.plot.plotoptions[chartName],plotoptions=chartObj.seriesdata[seriesIndex].plotoptions,gradientOptions=plotoptions&&plotoptions.gradients?mergeJSON(commonPlotOptions.gradients,plotoptions.gradients,!0):commonPlotOptions.gradients,patternPallete=chartObj.patternPallete,imagePallete=chartObj.imagePallete,imagePalleteLength=imagePallete&&imagePallete.length,patternPalleteLength=!dontUsePatternPallete&&patternPallete&&patternPallete.length,rendererMode=customRendererMode||chartObj.plot.renderer.mode,indexScale=colorscale_helpers.getIndexScale(chartObj),func=function(i,d,colorGamma,customColor,fillOpacity,customGradientDim,customPatternDim,returnSVGimage,subseriesIndex){var baseClr,clrValue=d&&chartObj.dataset.getClr(d);if(gradientDim=customGradientDim||gradientDim,i=Math.max(i,0)||0,customColor)baseClr=customColor;else if(baseClr=getRawColor(chartObj,i,d,seriesIndex),i=colorscale_helpers.getItemIndex(chartObj,indexScale,d,i),indexScale&&(!isWithinColorRange(clrValue,chartObj)||isUndefined(i))&&0===d3$1.rgb(baseClr).opacity)return baseClr;if("canvas"!=rendererMode||gradientOptions.type||baseClr instanceof Object||(baseClr=rgba_canvas(baseClr,fillOpacity)),patternPalleteLength&&/(url|data)/.test(baseClr))return baseClr;if(defined(colorGamma)&&(baseClr=getColorCopy(baseClr,colorGamma).toString()),imagePallete&&imagePallete.length&&isWithinColorRange(clrValue,chartObj)){var prop={name:chartObj.imagePallete[i%imagePalleteLength],width:customPatternDim&&customPatternDim.width||chartObj.patternImageSizes[i%imagePalleteLength][0],height:customPatternDim&&customPatternDim.height||chartObj.patternImageSizes[i%imagePalleteLength][1],mode:rendererMode,context:customPatternDim&&customPatternDim.context},patternEle="svg"==rendererMode||returnSVGimage?effects.get(effects.svg_patterns,"imageFill",prop,{returnSVGimage:returnSVGimage,chartObj:chartObj}):effects.get(effects.canvas_patterns,"imageFill",prop,{returnSVGimage:returnSVGimage,chartObj:chartObj});return"canvas"==rendererMode?patternEle:"url("+defsLocation+"#"+patternEle+")"}if(patternPalleteLength){prop=function(pattern,baseClr,opacity,customPatternDim,customClr){var prop=patternThemes[pattern]?patternThemes[pattern]:addPatternThemeByEle(pattern);return prop.bgClr_base=baseClr,prop.stroke_base=baseClr,prop.fillOpacity=prop.fillOpacity||opacity,prop.customStaticClr=customClr,customPatternDim&&(prop.x=customPatternDim.x,prop.y=customPatternDim.y,prop.width=customPatternDim.width,prop.height=customPatternDim.height),prop}(patternPallete[i%patternPalleteLength],baseClr,fillOpacity,customPatternDim,chartObj.userdata.legend.customPatternColor),patternEle="svg"==rendererMode||returnSVGimage?effects.get(effects.svg_patterns,"svgPatternFill",prop,{returnSVGimage:returnSVGimage,chartObj:chartObj}):effects.get(effects.canvas_patterns,"canvasPatternFill",prop,{returnSVGimage:returnSVGimage,chartObj:chartObj});return returnSVGimage||"canvas"==rendererMode?patternEle:"url("+defsLocation+"#"+patternEle+")"}return colorscale_helpers.isQuantileColorScale(chartObj)&&defined(subseriesIndex)&&isAreaChartType(cType)&&(gradientOptions=getGradient4ColorBand(chartObj,chartObj.renderer[seriesIndex].seriesdataAfterUpdate[subseriesIndex])),gradientDim&&gradientOptions&&gradientOptions.type?getGradients(gradientOptions,gradientDim,baseClr,rendererMode,fillOpacity,chartName,returnSVGimage,chartObj):baseClr};return func.gradientOptions=gradientOptions,func}function getGradients(gradientOptions,dimension,baseColor,type,fillOpacity,chartName,svgImage,chartInstance){var gradient,prop=getGradientProp(gradientOptions,dimension,baseColor,fillOpacity),args={offset:chartName,chartObj:chartInstance};return gradient="svg"===type?effects.get(effects.svg_gradients,"svgGradientFill",prop,args):effects.get(effects.canvas_gradients,"canvasGradientFill",prop,{offset:chartName,chartObj:chartInstance,returnSVGimage:svgImage}),svgImage||"canvas"===type?gradient:"url("+chartInstance.defsLocation+"#"+gradient+")"}function getStrokeColor(chartObj,seriesIndex,gradientDim){var clr,defsLocation=chartObj.defsLocation,cType=chartObj.chartTypes[seriesIndex].value,chartName=chartObj.chartTypes[seriesIndex].name,isAreaChart=isAreaChartType(cType),isLineChart=cType===charttype.line,plotoptions=chartObj.seriesdata[seriesIndex].plotoptions,commonPlotOptions=chartObj.systemConf.chart.plot.plotoptions[chartName],gradientOptions=isLineChart&&plotoptions&&plotoptions.gradients?mergeJSON(commonPlotOptions.gradients,plotoptions.gradients,!0):commonPlotOptions.gradients,hasQuantileScale=colorscale_helpers.isQuantileColorScale(chartObj),rendererMode=chartObj.plot.renderer.mode;return function(i,d,customColor,colorGamma,opacity,subseriesIndex){var hasColorBand=hasQuantileScale&&defined(subseriesIndex)&&(isLineChart||isAreaChart&&!(plotoptions&&plotoptions.strokeColor||commonPlotOptions.strokeColor)),hasGradient=isLineChart&&gradientOptions.type;if(hasColorBand&&(gradientOptions=getGradient4ColorBand(chartObj,chartObj.renderer[seriesIndex].seriesdataAfterUpdate[subseriesIndex])),gradientDim&&(hasColorBand||hasGradient)){var baseClr=customColor||getColorByIndex(chartObj,seriesIndex),prop=getGradientProp(gradientOptions,gradientDim,baseClr,opacity),args={offset:chartName,chartObj:chartObj},gradientEle="svg"==rendererMode?effects.get(effects.svg_gradients,"svgGradientFill",prop,args):effects.get(effects.canvas_gradients,"canvasGradientFill",prop,{offset:chartName,chartObj:chartObj});return"canvas"==rendererMode?gradientEle||baseClr:"url("+defsLocation+"#"+gradientEle+")"}if(customColor)clr=customColor;else{i=Math.max(i,0)||0;baseClr=getRawColor(chartObj,i,d,seriesIndex);defined(colorGamma)&&(baseClr=getColorCopy(baseClr,colorGamma).toString()),clr=baseClr}return"canvas"!=rendererMode||clr instanceof Object||(clr=rgba_canvas(clr,opacity)),clr}}function isWithinColorRange(clr,chartObj,colorScale,colorScale_domain,range){if(colorScale||(colorScale=chartObj.axes.clr.scale),!colorScale)return!0;colorScale_domain||(colorScale_domain=colorScale.domain()),clr===UNDEFINED&&(clr=null);var filterRange=range||chartObj.systemConf.legend.filter.range,isWithinFilterRange=!filterRange||(chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE?filterRange.indexOf(clr)>-1:clr>=filterRange[0]&&clr<=filterRange[1]);return(chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE?colorScale_domain.indexOf(clr)>-1:clr>=colorScale_domain[0]&&clr<=colorScale_domain[colorScale_domain.length-1])&&isWithinFilterRange&&null!==colorScale(clr)&&!(isUndefined(chartObj.systemConf.legend.colorBand.nullAs)&&null==clr)}function getRawColor(chartObj,i,d,seriesIndex){var baseClr=getColorByIndex(chartObj,i),rp=chartObj.isAxisCategory&&defined(seriesIndex)&&chartObj.rendererConf&&chartObj.rendererConf[seriesIndex].params;return rp&&rp.categoryColorConfig?colorscale_helpers.getWaterfallColor(d,rp.categoryColorConfig,baseClr):rp&&rp.colorOverlay?function(chartObj,rp,d,baseClr){var yaxiscolumnorder=rp.yaxiscolumnorder,threshold=rp.threshold,thresholdType=rp.thresholdType,dataset=chartObj.dataset,thresholdValue="x"==thresholdType?dataset.getX(d):dataset.getY(d,yaxiscolumnorder);return rp.colorOverlay(threshold,threshold.color,thresholdValue,baseClr)}(chartObj,rp,d,baseClr):d&&colorscale_helpers.isQuantileColorScale(chartObj)?getColorByScale(chartObj,d):d&&d.arcColor||baseClr}function getColorByIndex(chartObj,i){var seriesColor=chartObj.imagePallete||chartObj.seriesColor;return seriesColor[i%seriesColor.length]}function getColorByScale(chartObj,d){var trackConfig=chartObj.systemConf.legend.filter.track||{},excludeOpacity=validateNullVal(trackConfig.fillOpacity,1),hiddenColor=trackConfig.fillColor||TRANSPARENT,clrValue=chartObj.dataset.getClr(d),colorScale=chartObj.axes.clr.scale;return isWithinColorRange(clrValue,chartObj,colorScale)?(clrValue===UNDEFINED&&(clrValue=null),colorScale(clrValue)):0===(excludeOpacity=d3$1.rgb(hiddenColor).opacity*excludeOpacity)?TRANSPARENT:d3$1.scaleLinear().domain([0,1]).range([colorScale(clrValue),rgb2hex(hiddenColor)]).interpolate(d3$1.interpolateRgb)(excludeOpacity)}function getGrayScaleColor(color){var rgba=d3$1.rgb(color),gray=pInt((rgba.r+rgba.g+rgba.b)/3);return"rgba("+gray+","+gray+","+gray+","+rgba.opacity+")"}function isMultiColoring(commonPlotOptions,chartObj){return commonPlotOptions.multiColoring&&!chartObj.legendarea.show}function getGradient4ColorBand(chartObj,serData){var prevOffset,prevColor,prevHidden,curOffset,curColor,curHidden,rotated=chartObj.axes.rotated,reversed=chartObj.systemConf.chart.axes.xaxis.reversed,xscale=chartObj.axes.x.scale,ordinalRange=xscale.ordinalRange||xscale.range(),isDiscrete="discrete"===chartObj.systemConf.legend.colorBand.colorModeOnPlot,sc=d3_scaleLinear().domain([ordinalRange[0],ordinalRange[ordinalRange.length-1]]).range([0,100]),processedColors=[],processedOffsets=[];serData.forEach(function(d){if(curOffset=sc(xscale(chartObj.dataset.getX(d))),curColor=getColorByScale(chartObj,d),(curHidden=curColor===TRANSPARENT)&&(curColor="rgba(255,255,255,0)"),isDiscrete||!prevHidden&&!curHidden||(defined(prevOffset)&&(processedOffsets.push(mathMin(100,prevOffset+.1)+"%"),processedColors.push("rgba(255,255,255,0)")),processedOffsets.push(mathMax(0,curOffset-.1)+"%"),processedColors.push("rgba(255,255,255,0)")),isDiscrete&&prevColor)if(prevHidden)processedOffsets.push(mathMax(0,curOffset-.1)+"%"),processedColors.push(prevColor);else if(curHidden)processedOffsets.push(mathMin(100,prevOffset+.1)+"%"),processedColors.push(curColor);else{var by2=(curOffset+prevOffset)/2;processedOffsets.push(by2+"%"),processedColors.push(prevColor),processedOffsets.push(by2+"%"),processedColors.push(curColor)}processedOffsets.push(curOffset+"%"),processedColors.push(curColor),prevOffset=curOffset,prevColor=curColor,prevHidden=curHidden});var options={type:"linear",options:{linear:{x1:0,x2:0,y1:0,y2:0,stopColor:processedColors,stopOffset:processedOffsets}}},key=rotated?reversed?"y2":"y1":reversed?"x1":"x2";return options.options.linear[key]=100,options}var charts=function(containers,datas){if(isArray(containers)&&isArray(datas))return function(containers,datas){if(!isArray(containers)||!isArray(datas))return;var chartObjs=containers.map(function(container,i){return getChartObject(container,datas[i])});return drawEfficiently(chartObjs.slice().reverse(),[],chartObjs),chartObjs}(containers,datas);var chartObj=getChartObject(containers,datas);return chartObj&&chartObj.draw(),chartObj},maps=function(containers,data){return containers.isD3Selection||(containers=d3.select(containers)),function(containers,data){return new maps.GeoMap(containers,data)}(containers,data)};function getChartObject(container,data){if(container.isD3Selection||(container=d3.select(container)),!isElementOnDocument(container.node()))return this.console.warn("No container"),null;var chart=null;return container.datum(data).each(function(data){var chartHolder=d3_select(this);(chart=charts.get(chartHolder,data)).showLoading(chartHolder)}),chart}function drawEfficiently(unexecutedChartObjs,executedChartObjs,chartObjs){var len=unexecutedChartObjs.length,chartObj=unexecutedChartObjs[len-1];len||(chartObjs.chartRendered=!0),len>0&&1!=chartObj.drawStarted&&isElementOnDocument(chartObj.container.node())&&(chartObj.draw(),chartObj.drawStarted=!0,function checkStatusNCallNext(unexecutedChartObjs,executedChartObjs,chartObjs,timer){var len=unexecutedChartObjs.length,chartObj=unexecutedChartObjs[len-1];if(chartObj.chartRendered||chartObj.breakOnErr)executedChartObjs.push(unexecutedChartObjs.pop()),drawEfficiently(unexecutedChartObjs,executedChartObjs,chartObjs);else{null!=timer&&clearTimeout(timer);var timer=setTimeout(function(){checkStatusNCallNext(unexecutedChartObjs,executedChartObjs,chartObjs,timer)},10)}}(unexecutedChartObjs,executedChartObjs,chartObjs))}function merged_axis_column_intersect(axisorder,chartObj){for(var metaData=chartObj.systemConf.metadata,indices=metaData.axes.y[axisorder],start=1,end=indices.length-1,col1=metaData.columns[indices[start-1]],output=col1[col1.datatype];start<=end;start++){var col2=metaData.columns[indices[start]];output=intersectObject(output,col2[col2.datatype])}return output}function getOppositeOrient(orient){switch(orient){case"left":return"right";case"right":return"left";case"top":return"bottom";case"bottom":return"top"}}function getMargin(obj){return{top:pick(obj.marginTop,5),right:pick(obj.marginRight,5),bottom:pick(obj.marginBottom,5),left:pick(obj.marginLeft,5)}}function getTickPadding(orient,ticklabelMargin,invert){return invert||(orient=getOppositeOrient(orient)),ticklabelMargin[orient]}function getAxisObject(chartObj,type,index){var obj;return"x"==type?0==index?obj=chartObj.axes.x:(chartObj.axes.x.levels[index-1]=chartObj.axes.x.levels[index-1]||{},obj=chartObj.axes.x.levels[index-1]):"clr"===type?obj=chartObj.axes.clr:(chartObj.axes.y.groups[index]=chartObj.axes.y.groups[index]||{},obj=chartObj.axes.y.groups[index]),obj}function isTickInnerOrient(obj,type,chart){if("inner"==obj.tickOrient)return"x"!=type||!chart.ismultix}function getMousePosition(node,event){var mouse=d3_mouse(node);return null!=event.touches&&!$Browser.ANDROID&&$Browser.uiwebview&&(mouse[0]+=window.pageXOffset,mouse[1]+=window.pageYOffset),mouse}function getRelativeMousePosition(chartObj){var node=chartObj.eventHandler.trackerElement.node(),mouse=chartObj.eventHandler.mousePos=getMousePosition(node,d3$1.event),relativeelement=bbox(node);return{x:mouse[0]-relativeelement.x,y:mouse[1]-relativeelement.y}}function stateChangeListener(chartObj,eventdata,ele,type,defaultCallback){var callback=eventdata&&eventdata[type]||defaultCallback;defined(callback)&&invokeFunction(callback,d3$1.event,chartObj)}function attachevents(ele,mouseHandlers,touchHandlers,options,namespace){namespace=(options=options||{}).namespace||namespace,$Browser.isMouseDevice&&mouseHandlers&&function(ele,namespace,handlers){if(null==ele.node())return;namespace="."+namespace;var updatedHandlers={};for(var attr in handlers)updatedHandlers[attr+namespace]=handlers[attr],ele.on(attr+namespace,updatedHandlers[attr+namespace]);handlers=updatedHandlers,ele.on(handlers)}(ele,namespace,mouseHandlers),$Browser.isTouchDevice&&touchHandlers&&function(ele,namespace,handlers,options){if(null==ele.node())return;var touchleave=options.touchleave,target=options.target,chartObj=options.chartObj,plotEventOptions=chartObj&&chartObj.systemConf.chart.plot.events||{},doPreventDefault=!1!==options.preventDefault,isFocusedTouchmove=!("plot"===target&&0==plotEventOptions.isFocusedTouchmove);namespace=null!=namespace?"."+namespace:"";var prevElement,tapholdDetected,tapHoldTimer,tapholdFn,tapholdendFn,touchstart={},lastMove=0,lastTap=0,firstMove=null,isDoubletouchStarted=!1,touchendFn=(handlers.touchmove,handlers.touchend),tapFn=handlers.tap,dbltapFn=handlers.dbltap,singletouchmoveFn=handlers.singletouchmove,doubletouchmoveFn=handlers.doubletouchmove;"plot"===target&&getEventConf(null,chartObj.systemConf.chart.plot.plotoptions[chartObj.chartTypes[0].name],chartObj,"taphold")?(tapholdFn=handlers.tap,tapholdendFn=touchendFn):(tapholdFn=handlers.taphold,tapholdendFn=handlers.tapholdend);var touchstartProp="touchstart"+namespace,touchmoveProp="touchmove"+namespace,touchendProp="touchend"+namespace,updatedHandlers={};for(var attr in updatedHandlers[touchstartProp]=function(){if(0!=plotEventOptions.enabled&&!(d3$1.event.touches.length>1)&&(touchstart.time=new Date,touchstart.location=getMousePosition(this,d3$1.event),firstMove=null,isDoubletouchStarted=!1,tapholdDetected=!1,tapholdFn)){var e=d3$1.event,arg=arguments,self=this;tapHoldTimer=setTimeout(function(){d3$1.event=e,chartObj&&(chartObj.zcEventType="taphold"),tapholdFn.apply(self,arg),tapholdDetected=!0},500)}},updatedHandlers[touchmoveProp]=function(){if(0!=plotEventOptions.enabled){var touchObject=d3$1.event.touches;if(tapholdFn){var currentLocation=getMousePosition(this,d3$1.event);if((null!=touchstart.location?getEuclideanDistance(touchstart.location[0],touchstart.location[1],currentLocation[0],currentLocation[1]):null)>30)clearTimeout(tapHoldTimer);else if(tapholdDetected)return preventDefault(),!1}if(touchObject.length>1)2==touchObject.length&&doubletouchmoveFn&&(isDoubletouchStarted=!0,doubletouchmoveFn.apply(this,arguments),preventDefault());else{var currentTime=(new Date).getTime();if(firstMove||(firstMove=currentTime),touchleave&&null!=document.elementFromPoint){var timer=0==lastMove||currentTime-lastMove>50,curTouch=touchObject[0],currentEle=document.elementFromPoint(curTouch.pageX-window.pageXOffset,curTouch.pageY-window.pageYOffset);if(!timer||"svg"===currentEle.localName||null!=currentEle.id.match(/tooltip/gi))return void preventDefault();if(currentEle!=this){if(prevElement!=currentEle){var touchEndElement=prevElement||this,endEvent=(element=d3_select(touchEndElement)).on(touchendProp),d=element.datum();i=null!=(i=null!=(identity=element.attr("id")||element.attr("class"))?identity.match(/(\d)+$/gi):null)&&null!=i[0]?parseInt(i[0]):null,null!=endEvent&&null!=i&&endEvent.call(touchEndElement,d,i)}var element,className=(element=d3_select(currentEle)).attr("class");chartObj.chartTypes[0].value!==charttype.dial||"inner"!==className&&"outer"!==className||(element=d3_select(currentEle.parentNode));var identity,i,moveEvent=element.on(touchmoveProp);return d=element.datum(),i=null!=(i=null!=(identity=element.attr("id")||element.attr("class"))?identity.match(/(\d)+$/gi):null)&&null!=i[0]?parseInt(i[0]):null,void(null!=moveEvent&&null!=i&&(moveEvent.call(currentEle,d,i),prevElement=currentEle,lastMove=currentTime))}}isFocusedTouchmove&&firstMove-touchstart.time<100||singletouchmoveFn&&(chartObj&&(chartObj.zcEventType="touchmove"),singletouchmoveFn.apply(this,arguments),preventDefault())}}},updatedHandlers[touchendProp]=function(){if(0!=plotEventOptions.enabled){var touchObject=d3$1.event.touches;if(tapholdFn&&(clearTimeout(tapHoldTimer),tapholdDetected))return tapholdDetected=!1,preventDefault(),tapholdendFn&&tapholdendFn.apply(this,arguments),!1;if(!(touchObject.length>1)){if(isDoubletouchStarted&&doubletouchmoveFn&&touchendFn)return isDoubletouchStarted=!1,touchendFn.apply(this,arguments),void preventDefault();var currentTime=new Date,currentLocation=getMousePosition(this,d3$1.event),duration=currentTime-touchstart.time,distance=null!=touchstart.location?getEuclideanDistance(touchstart.location[0],touchstart.location[1],currentLocation[0],currentLocation[1]):null,tapLength=currentTime-lastTap;tapLength<=350&&tapLength>0&&distance<=30?(dbltapFn&&(chartObj&&(chartObj.zcEventType="doubletap"),dbltapFn.apply(this,arguments),preventDefault()),lastTap=0):duration<=150&&distance<=30?tapFn&&(chartObj&&(chartObj.zcEventType="tap"),tapFn.apply(this,arguments),preventDefault()):touchendFn&&touchendFn.apply(this,arguments),lastTap=currentTime}}},updatedHandlers)ele.on(attr,updatedHandlers[attr]);function getEuclideanDistance(x1,y1,x2,y2){return Math.sqrt(Math.pow(x2-x1,2)+Math.pow(y2-y1,2))}function preventDefault(){doPreventDefault&&d3$1.event.preventDefault()}}(ele,namespace,touchHandlers,options)}function detachevent(ele,namespace,handlers){if(namespace=null!=namespace&&""!=namespace?"."+namespace:"",$Browser.isMouseDevice){if(""!==namespace)ele.on(namespace,null);else for(var attr in handlers)ele.on(attr,null);handlers=null}}function getPlotBound(chartObj){return{left:-chartObj.scrolledX||0,top:-chartObj.scrolledY||0,right:getPlotSize(chartObj,"width"),bottom:getPlotSize(chartObj,"height")}}function getPlotSize(chartObj,type,plotarea){plotarea=plotarea||chartObj.plotarea;var customSize=chartObj.systemConf.chart[type];return null==customSize||isNaN(customSize)?plotarea[type]:mathMax(plotarea[type],+customSize)}var plotScroll_div=function(){};function updateAxisClipPath(chartObj){var attrObj,axisrotated=chartObj.dataObject.getAxisRotated(),plotarea=chartObj.plotarea,scrolled=axisrotated?chartObj.scrolledY:chartObj.scrolledX;if(axisrotated)attrObj={x:-plotarea.left,y:scrolled,width:plotarea.width+plotarea.left,height:plotarea.height};else{var axisLen=0;if(chartObj.dataObject.hierarchical)for(var i=0;i<chartObj.axes.x.count;i++){axisLen+=getAxisObject(chartObj,"x",i).ticks.preCalcAxisLen}else axisLen=chartObj.axes.x.ticks.preCalcAxisLen;attrObj={x:scrolled,y:-plotarea.height,width:plotarea.width,height:axisLen+chartObj.plotarea.height}}attrObj.name="rect_axis",attrObj.id=chartObj.id;var args={chartObj:chartObj},axisClipPathId=effects.get(effects.svg_clips,"rect",attrObj,args);return chartObj.container.selectAll("g.x-axis").selectAll(function(){return this.childNodes}).filter(function(){var comp=d3$1.select(this),axisTrans=getSvgTransform(comp).translate,transX=axisrotated?axisTrans[0]:plotarea.left-scrolled,transY=axisrotated?plotarea.top-scrolled:axisTrans[1];comp.attrs({transform:"translate("+transX+","+transY+")","clip-path":"url(#"+axisClipPathId+")"}),comp.selectAll("g.axisgroup").attr("clip-path","")}),axisClipPathId}plotScroll_div.prototype.defaultScroll=function(chartObj,state){if(chartObj.isAxisCategory&&(chartObj.systemConf.chart.width||chartObj.systemConf.chart.height)){var axisrotated=chartObj.dataObject.getAxisRotated(),plotarea=chartObj.plotarea,XSIZE=getPlotSize(chartObj,"width")-plotarea.width,YSIZE=getPlotSize(chartObj,"height")-plotarea.height,scroll=chartObj.container.selectAll(".d3container").selectAll(".zohocharts_scroll"),scrollbar_size=+scroll.attr("scrollbarSize"),properties={name:"rect_axis",id:chartObj.id};if(axisrotated?(chartObj.scrolledY=chartObj.scrolledY||0,properties.x=-plotarea.left,properties.y=0,properties.width=plotarea.width+plotarea.left,properties.height=plotarea.height):(chartObj.scrolledX=chartObj.scrolledX||0,properties.x=0,properties.y=0,properties.width=plotarea.width,properties.height=chartObj.canvasarea.height),updateAxisClipPath(chartObj),scroll.styles({left:plotarea.left+PX,top:plotarea.top+PX,height:plotarea.height+(axisrotated?0:scrollbar_size)+PX,width:plotarea.width+(axisrotated?scrollbar_size:0)+PX}).on("scroll",function(e){var src=d3$1.event.srcElement||d3$1.event.target,scrolled=axisrotated?src.scrollTop:src.scrollLeft;chartObj.scrolledY=axisrotated?scrolled:0,chartObj.scrolledX=axisrotated?0:scrolled,d3$1.event.clientX=d3$1.event.clientX||0,d3$1.event.clientY=d3$1.event.clientY||0,chartObj.eventHandler.mouseOut(),scrollGroups(scrolled)}),scroll.style(axisrotated?{"overflow-y":"auto","overflow-x":"hidden"}:{"overflow-x":"auto","overflow-y":"hidden"}),scroll.selectAll(".child").styles({height:plotarea.height+(axisrotated?YSIZE:0)+PX,width:plotarea.width+(axisrotated?0:XSIZE)+PX,"pointer-events":NONE,margin:0,padding:0,"background-color":TRANSPARENT}),"addorremoveseries"!==state){var scroll_node=scroll.node();scroll_node.scrollLeft=0,scroll_node.scrollTop=0}var eventHandler=chartObj.eventHandler,eventAttacherOptions={target:"plot",chartObj:chartObj},clickHandlers={click:eventHandler.click,dblclick:eventHandler.doubleclick,contextmenu:eventHandler.contextMenu},moveHandlers={mousemove:eventHandler.mouseMove,mouseout:eventHandler.mouseOut};attachevents(scroll,clickHandlers,null,"chart"),attachevents(scroll,moveHandlers,null,"chartmove"),attachevents(scroll,{},{tap:eventHandler.click,dbltap:eventHandler.doubleclick,singletouchmove:eventHandler.mouseMove,touchend:eventHandler.mouseOut},eventAttacherOptions);var scrolled=axisrotated?chartObj.scrolledY:chartObj.scrolledX;scrolled&&"addorremoveseries"===state&&scrollGroups(scrolled)}function scrollGroups(scrolled){var seriesholder=chartObj.container.selectAll(".seriesholder"),seriesTrans=getSvgTransform(seriesholder).translate,transX=axisrotated?seriesTrans[0]:plotarea.left-scrolled,transY=axisrotated?plotarea.top-scrolled:seriesTrans[1];seriesholder.attr("transform","translate("+transX+","+transY+")"),chartObj.container.selectAll(".labelholder").attr("transform","translate("+transX+","+transY+")"),chartObj.container.selectAll(".eventgroup").attr("transform","translate("+(axisrotated?0:-scrolled)+","+(axisrotated?-scrolled:0)+")"),chartObj.container.selectAll("rect.eventhandler").attr("transform","translate("+(axisrotated?0:scrolled)+","+(axisrotated?scrolled:0)+")"),chartObj.drawPlotareaClippath();var attrObj=axisrotated?{y:plotarea.top-scrolled,height:plotarea.height+scrolled}:{x:plotarea.left-scrolled,width:plotarea.width+scrolled};chartObj.eventHandler.trackerElement.attrs(attrObj).attr("clip-path",seriesholder.attr("clip-path")),updateAxisClipPath(chartObj);var properties={name:"rect_highlight",id:chartObj.id},args={chartObj:chartObj};axisrotated?(properties.x=-plotarea.left,properties.y=scrolled,properties.width=plotarea.width+plotarea.left,properties.height=plotarea.height):(properties.x=scrolled,properties.y=plotarea.top,properties.width=plotarea.width,properties.height=plotarea.height);var clipID=effects.get(effects.svg_clips,"rect",properties,args);chartObj.container.selectAll("#zcareahighlight").attr("clip-path","url(#"+clipID+")")}},plotScroll_div.prototype.initialize=function(chartObj){if(chartObj.isAxisCategory&&(chartObj.systemConf.chart.width||chartObj.systemConf.chart.height)){axisrotated?chartObj.scrolledY=chartObj.scrolledY||0:chartObj.scrolledX=chartObj.scrolledX||0;var scroll=appendEle(chartObj.container.selectAll(".d3container"),"div",[1],".","class","zohocharts_scroll");scroll.styles({width:100+PX,height:100+PX,overflow:"auto",position:"absolute",margin:0,padding:0,"background-color":"rgba(0,0,0,0)","box-sizing":"content-box","-webkit-tap-highlight-color":TRANSPARENT,"-webkit-overflow-scrolling":"touch"}),appendEle(scroll,"div",[1],".","class","child").styles({width:200+PX,height:200+PX});var axisrotated=chartObj.dataObject.getAxisRotated(),conf=chartObj.defaultScroll,scroll_node=scroll.node(),scrollbar_size=axisrotated?scroll_node.offsetWidth-scroll_node.clientWidth:scroll_node.offsetHeight-scroll_node.clientHeight;scroll.attr("scrollbarSize",scrollbar_size),conf||((conf=chartObj.defaultScroll={}).tickmarkSize=+chartObj.systemConf.chart.axes.xaxis.tickmark.size,conf.marginRight=+chartObj.systemConf.chart.marginRight),axisrotated?(chartObj.plotarea.bottom+=scrollbar_size,chartObj.plotarea.width-=scrollbar_size):chartObj.systemConf.chart.axes.xaxis.tickmark.size=+conf.tickmarkSize+scrollbar_size}};var ZC_LEGEND_maxHeightVertRatio="80%",ZC_LEGEND_maxHeightHoriRatio="20%",ZC_LEGEND_maxWidthVertRatio="20%",ZC_LEGEND_maxWidthHoriRatio="100%",ZC_LEGEND_maxCenterWidth="30%",ZC_LEGEND_maxCenterHeight="30%",LEGEND_TITLE_MAX_WIDTH_HORIZONTAL="50%",LEGEND_TITLE_MAX_WIDTH_VERTICAL="100%",legend_helpers={};function getDefaultLegendMaxDimension(legendOptions){var legendAlign=getLegendAlignment(legendOptions),vAlign=legendOptions.vAlign,hAlign=legendAlign.hAlign,widthRatio=0,heightRatio=0;return"horizontal"===legendAlign.layout?"top"===vAlign||"bottom"===vAlign?(widthRatio=ZC_LEGEND_maxWidthHoriRatio,heightRatio=ZC_LEGEND_maxHeightHoriRatio):"center"===vAlign&&(widthRatio=ZC_LEGEND_maxCenterWidth,heightRatio=ZC_LEGEND_maxHeightVertRatio):"left"===hAlign||"right"===hAlign?(widthRatio=ZC_LEGEND_maxWidthVertRatio,heightRatio=ZC_LEGEND_maxHeightVertRatio):"center"===hAlign&&(widthRatio=ZC_LEGEND_maxWidthHoriRatio,heightRatio=ZC_LEGEND_maxCenterHeight),{width:widthRatio,height:heightRatio}}function getLegendAlignment(legendConfig){var hAlign=legendConfig.hAlign,vAlign=legendConfig.vAlign,view=legendConfig.layout,floating=defined(legendConfig.x)&&defined(legendConfig.y);return"center"===hAlign&&"center"===vAlign&&(hAlign="right"),defined(view)||(view=floating?"vertical":"top"===vAlign||"bottom"===vAlign?"horizontal":"vertical"),{hAlign:hAlign,vAlign:vAlign,layout:view}}legend_helpers.getLegendData=function(chartObj){if(colorscale_helpers.isQuantileColorScale(chartObj)){var userRanges=chartObj.systemConf.legend.colorBand.ranges;if(userRanges&&userRanges.length)return userRanges}return chartObj.xymultiRenderer||chartObj.isNonAxisMultiSeriesCategory||chartObj.isGeoMap?chartObj.seriesdata:chartObj.seriesdata[0].data[0]},legend_helpers.getLegendDataLength=function(chartObj,legData){return chartObj.xymultiRenderer||chartObj.isNonAxisMultiSeriesCategory?legData.filter(function(d){return!legend_helpers.isHiddenItem(d)}).length:legData.length},legend_helpers.isHiddenItem=function(d){return d.hideInLegend},legend_helpers.getClr=function(disabled,defaultClr,itemDisabledStyle){return disabled&&itemDisabledStyle.color||defaultClr},legend_helpers.updateBubblePieData=function(d,i,chartObj){chartObj.dataObject.pieWithAxis&&d.data.forEach(function(subseries){var isBubblePie=isMultiPieChartType(chartObj.chartTypes[i].value);subseries.forEach(function(dataPoint){dataPoint.disabled=d.disabled||!isBubblePie||dataPoint.dummy})})},legend_helpers.updateHierarchyData=function(d,i,chartObj){chartObj.dataObject.isHierarchy&&(chartObj.systemConf.seriesdata.chartdata[i].disabled=d.disabled)},legend_helpers.toggleChartEvents=function(chartObj,enable){var val=enable?null:NONE,elements=[];chartObj.svg?((chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory)&&elements.push(chartObj.eventHandler.trackerElement),elements.push(chartObj.svg)):elements.push(chartObj.container),elements.forEach(function(d){d.style("pointer-events",val)})},legend_helpers.fadeChart=function(enable,chartObj,opacity){chartObj.container.selectAll("g.chartgroup,svg.static,canvas.zc-canvas,div.zcnotes").style("opacity",enable?null:opacity)},legend_helpers.isDisabled=function(d,allSelected,isFirstClickAfterDeselection){return allSelected||isFirstClickAfterDeselection?d.disabled:!allSelected},legend_helpers.isAllEnabled=function(legData,allSelected){return allSelected?!legData.filter(function(d){return d.disabled}).length:allSelected},legend_helpers.getFilterBoxSize=function(colorBox,fontSize){var colorBoxSize=defined(colorBox.size)?+colorBox.size:fontSize;return[defined(colorBox.width)?+colorBox.width:colorBoxSize,defined(colorBox.height)?+colorBox.height:colorBoxSize]},legend_helpers.updateData=function(d,i,chartObj){colorscale_helpers.isQuantileColorScale(chartObj)?chartObj.axes.clr.scale=scale$1.getScale(chartObj,chartObj.dataObject,null,null,null,chartObj.dataset,"clr"):(legend_helpers.updateBubblePieData(d,i,chartObj),legend_helpers.updateHierarchyData(d,i,chartObj),chartObj.dataObject.data=chartObj.systemConf)},legend_helpers.isContinousLegend=function(chartObj){var colorBandOptions=chartObj.systemConf.legend.colorBand;if(colorscale_helpers.isQuantileColorScale(chartObj)){var userRanges=colorBandOptions.ranges;if(chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE||userRanges&&userRanges.length){var type=colorBandOptions.type;return"continuousDiscrete"===type||"continuous"===type}return!0}return!1},legend_helpers.getColorBandDimension=function(chartObj){var chartarea=chartObj.chartarea,legendOptions=chartObj.systemConf.legend,legendAlignment=getLegendAlignment(legendOptions),colorbandOptions=legendOptions.colorBand,isHorizontal="horizontal"===legendAlignment.layout,maxWidth=legendOptions.maxWidth,maxHeight=legendOptions.maxHeight,w=colorbandOptions.width,h=colorbandOptions.height,legendMaxDimension=getDefaultLegendMaxDimension(legendOptions);return isHorizontal?(maxWidth=legendMaxDimension.width,maxHeight=legendMaxDimension.height,w=w||"40%",h=h||14):(maxWidth=legendMaxDimension.width,maxHeight=legendMaxDimension.height,w=w||14,h=h||"70%"),maxWidth=perToPx(maxWidth,chartarea.width),maxHeight=perToPx(maxHeight,chartarea.height),w=perToPx(w,chartarea.width),h=perToPx(h,chartarea.height),[w=mathMin(w,maxWidth),h=mathMin(h,maxHeight)]},legend_helpers.getOrient=function(legendOptions){var hAlign=legendOptions.hAlign,vAlign=legendOptions.vAlign;return"horizontal"===getLegendAlignment(legendOptions).layout?{top:"top",center:"bottom",bottom:"bottom"}[vAlign]:{left:"left",center:"right",right:"right"}[hAlign]},legend_helpers.getLabelIndex=function(value,colorbandOptions,chartObj){var labelIndex,userStops=colorbandOptions.stops,userRanges=colorbandOptions.ranges;return!(chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE)&&userStops&&userStops.length?userStops.some(function(d,i){if(d===value)return labelIndex=i,!0}):userRanges&&userRanges.length&&userRanges.some(function(d,i){if(isArray(d)?isArray(value)?d[0]===value[0]&&d[1]===value[1]:d[0]===value:d===value)return labelIndex=i,!0}),labelIndex},legend_helpers.hexToRGB=function(color){if(color&&-1==color.toString().indexOf("#"))return color;var bigint=pInt(rgb2hex(color).replace(/#/g,""),16);return"rgb("+(bigint>>16&255)+","+(bigint>>8&255)+","+(255&bigint)+")"},legend_helpers.filterSelectionByColor=function(selection,selectedSeries,filterIndex,chartObj){if(defined(filterIndex)){var condition,userRanges=chartObj.systemConf.legend.colorBand.ranges,colorScale=chartObj.axes.clr.scale,getColorValue=function(d){var dt=d.data||d;return chartObj.dataset.getClr(dt)};if(userRanges&&userRanges.length){var filterValue=userRanges[filterIndex],isOrdinal=chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE;if(1===filterValue.length&&!isOrdinal){var domain=d3_values(colorScale.domain());domain.splice(0,2),filterValue=[domain[2*filterIndex],domain[2*filterIndex+1]]}return selection.filter(function(d){var clr=getColorValue(d);return condition=isWithinColorRange(clr,chartObj,colorScale),isOrdinal?condition=condition&&clr===filterValue[0]:(condition=condition&&clr>=filterValue[0]&&clr<=filterValue[1],clr===filterValue[0]&&(condition=condition&&getColorByIndex(chartObj,filterIndex)===colorScale(clr)),clr===filterValue[1]&&(condition=condition&&getColorByIndex(chartObj,filterIndex)===colorScale(clr))),selectedSeries?condition:!condition})}return selection.filter(function(d){var clr=getColorValue(d);return condition=isWithinColorRange(clr,chartObj,colorScale,null,filterIndex),selectedSeries?condition:!condition})}return selection},legend_helpers.isReversedColorAxis=function(chartObj){var legendOptions=chartObj.systemConf.legend;return legendOptions.colorAxis&&legendOptions.colorAxis.reversed},legend_helpers.hasPatternPallete=function(chartObj){var patternPallete=chartObj.patternPallete;return patternPallete&&patternPallete.length};var X_SHOWAS="x",Y_SHOWAS="y",Z_SHOWAS="z",GEO_SHOWAS="geo",PER_SHOWAS="per",MAXPER_SHOWAS="maxper",PERCENT_SHOWAS="percent",SPLITPERCENT_SHOWAS="splitpercent",MAXPERCENT_SHOWAS="maxpercent";function DataProcessor(data,dataSet,chartInstance){this.data=data,this.dataset=dataSet,this.chartObj=chartInstance,this.values=[],this.minmaxY=[],this.groupedDataBySplitAxes=[],this.groupedDataByCombo=d3_map(),this.stackeddata=[],this.stackedChart=null,this.allChartTypes=null,this.hasNegativeValue=[],this.baseline=[],this.xRange=null,this.yRange=[],this.domainCorrections={plotHeight:null,byDatalabels:{},forBubbles:{}},this.rangeCorrections={datalabels:{}},this.xaxisData=data.chart.axes.xaxis,this.yaxesData=data.chart.axes.yaxis,this.qualitativeRanges=null,this.groupedByStack=d3_map(),this.ganttSeries_count=0,this.categoriesStore=null,this.plotBorder=null,this.globalChartType=null,this.hierarchical=chartInstance.preProcessor.hierarchical,this.processedseriesData=chartInstance.seriesdata,this.initialize()}var DataProcessorProto=DataProcessor.prototype;DataProcessorProto.getSeriesData=function(){var chart=this.chartObj;if(defined(this.hierarchical)&&this.hierarchical.categories){var temp=this.hierarchical.getSeries();return chart.seriesdata=temp,temp}return chart.seriesdata},DataProcessorProto.getMinMaxZ=function(){return d3_extent(d3_merge(this.categoriesStore.z))},DataProcessorProto.isBarEnabled=function(series){var cType=DataProcessor.helpers.getChartType(series.type||this.globalChartType,NUMERIC_DATATYPE);return!series.disabled&&isBarChartType(cType)},DataProcessorProto.getAxisRotated=function(){var axes=this.data.chart.axes;return axes&&!0===axes.rotated},DataProcessorProto.containsNegativeData=function(index){return this.hasNegativeValue[index]},DataProcessorProto.updateSeriesdatabyCategories=function(seriesdata,xCategories,yCategories,yaxiscolumnorder,removeDuplicateX){var dataSet=this.dataset,helpers=DataProcessor.helpers,isCatNullX=helpers.isCatNull(dataSet,"x"),isCatNullY=helpers.isCatNull(dataSet,"y",yaxiscolumnorder),tempSet=d3_set();return seriesdata=seriesdata.filter(function(d){var show=!0,x=dataSet.getX(d);if(xCategories&&(show=show&&!isCatNullX(x)&&xCategories.indexOf(x)>-1),yCategories){var y=dataSet.getY(d,yaxiscolumnorder);show=show&&!isCatNullY(y)&&yCategories.indexOf(y)>-1}return xCategories&&removeDuplicateX&&show&&(tempSet.has(x)?show=!1:tempSet.add(x)),show})},DataProcessorProto.getPlotBorder=function(){var data=this.data,borderSize=this.plotBorder;return!0===data.chart.plot.border.show&&((borderSize={}).top=borderSize.right=borderSize.bottom=borderSize.left=0),borderSize},DataProcessorProto.setGroupDataComboKey=function(stacked,cType,obj){var data=this.data,groupedByStack=this.groupedByStack,groupedDataByCombo=this.groupedDataByCombo,key=0;if(stacked&&isBarChartType(cType)){if(data.seriesdata.stackGroup&&(key=this.getStackGroupIndex(obj.si,data.seriesdata.stackGroup)),groupedByStack.has(key)){var lastData=groupedByStack.get(key);groupedByStack.set(key,lastData.concat([obj]))}else groupedByStack.set(key,[obj]);groupedByStack.get(key).stackLabelIndex=obj.si}var comboKey=defined(key)?cType+"_"+key:cType;if(groupedDataByCombo.has(comboKey)){var lastdat=groupedDataByCombo.get(comboKey);groupedDataByCombo.set(comboKey,lastdat.concat([obj]))}else groupedDataByCombo.set(comboKey,[obj])},DataProcessorProto.setExtremes=function(curdata,stacked,yDatatype,cType,isZenabled,yaxiscolumnorder){var dataset=this.dataset,zCat=this.categoriesStore.z;if(((yDatatype===NUMERIC_DATATYPE||yDatatype===TIME_DATATYPE)&&!stacked||isZenabled)&&!curdata.disabled&&isArray(curdata)){var mergedSubgroup=d3_merge(curdata);if(isZenabled){var zExtremes=d3_extent(mergedSubgroup,function(d){return dataset.getZ(d)});zCat.push(zExtremes)}if(yDatatype===NUMERIC_DATATYPE||yDatatype===TIME_DATATYPE){var yExtremes;if(cType==charttype.arearange||cType==charttype.gantt){var mergedYranges=d3_merge(mergedSubgroup.map(function(d){return dataset.getY(d,yaxiscolumnorder)}));yExtremes=d3_extent(mergedYranges)}else yExtremes=d3_extent(mergedSubgroup,function(d){return dataset.getY(d,yaxiscolumnorder)});this.seriesExtermes[yaxiscolumnorder].push(yExtremes)}}},DataProcessorProto.initialize=function(state){var plotBorder,processor=this,domainCorrections=processor.domainCorrections,yaxesData=(processor.xaxisData,processor.yaxesData),allChartTypes=processor.allChartTypes,data=processor.data,chartObj=processor.chartObj,globalChartType=processor.globalChartType=data.seriesdata&&data.seriesdata.type,noofYaxis=data.metadata.axes.y.length,metadata=data.metadata,axes=metadata.axes,plotOptions=data.chart.plot.plotoptions,stacked=processor.isstacked(),groupedDataBySplitAxes=processor.groupedDataBySplitAxes=[],groupedByStack=processor.groupedByStack=d3_map(),dataset=processor.dataset,categoriesStore=processor.categoriesStore={},processedseriesData=processor.processedseriesData,helpers=DataProcessor.helpers;processor.hierarchical&&!processor.hierarchical.groupByTime&&defined(state)&&processor.hierarchical.update(),processor.xRange=null,processor.actual_yRange=processor.actual_yRange||[],processor.yRange=[],processor.qualitativeRanges=null,processor.groupedDataByCombo=d3_map(),domainCorrections.plotHeight=null,domainCorrections.forBubbles={},dataset.seriesTypes=d3_set(),processor.isBubbleEnabled=!1,processor.noofBarEnabledSeries=0,processor.noofAreaEnabledSeries=0,processor.noofAreaRangeEnabledSeries=0,processor.noofGanttEnabledSeries=0,processor.totalnoofdatas=0,processor.lastCategoryValue=0,processor.isCombinationalChart=d3_set(),processor.isAxisCategory=!1,processor.isNonAxisMultiSeriesCategory=!1,processor.isContinousChart=!0,processor.isPolarAxisCategory=!1,processor.hasLevelMarker=!1,processor.isStackedPercentChart=!1,processor.isPercentChart=!1,categoriesStore.x=[],categoriesStore.z=[[0]],categoriesStore.subseries=[],dataset.hasNullFormatter={},(plotBorder=this.plotBorder={}).left=plotBorder.top=plotBorder.right=plotBorder.bottom=0,processor.seriesExtermes=[];for(var yaxesGroups=chartObj.axes.y.groups,i=0;i<noofYaxis;i++)categoriesStore["y"+i]=[],processor.seriesExtermes[i]=[],!defined(yaxesData[i])&&(yaxesData[i]={}),yaxesGroups[i]=yaxesGroups[i]||{},yaxesGroups[i].disabled=!0;if(isArray(processedseriesData)){var xColumn=axes.x?dataset.getColumn("x"):null,xDatatype=xColumn?xColumn.datatype:null,isZenabled=defined(axes.z),groupbyDataIndices=helpers.groupByDataIndices(metadata);allChartTypes=processor.allChartTypes=allChartTypes||helpers.getAllChartTypes(data);var temp=function(d){return-1!==allChartTypes.indexOf(d)};processor.isDiscrete=chartcategory.discrete.some(temp),processor.isHierarchy=chartcategory.hierarchy.some(temp),processor.hasZaxis=defined(dataset.zidx)&&chartcategory.zaxis.some(temp);var needDuplicateCategories,xColPos=data.metadata.axes.x,datatype_x=data.metadata.columns[xColPos].datatype;processor.needXCategoriesSorting=!1,processedseriesData.forEach(function(d,i){var disabled=d.disabled,curdata=d.data,is3DArray=helpers.is3D(curdata),chartType_num=helpers.getChartType(d.type||globalChartType,NUMERIC_DATATYPE),yaxiscolumnorder=(helpers.getChartType(d.type||globalChartType,"string"),helpers.getParsedYAxisOrder(d.yaxiscolumnorder)),yDatatype=dataset.getDataType("y",yaxiscolumnorder);if(dataset.seriesTypes.add(chartType_num),processor.isCombinationalChart.add(chartType_num),processor.isBubbleEnabled=processor.isBubbleEnabled||!disabled&&isBubbleChartType(chartType_num),processor.isWaterfallEnabled=processor.isWaterfallEnabled||!disabled&&isWaterfallChartType(chartType_num),processor.pieWithAxis=processor.pieWithAxis||!disabled&&chartType_num==charttype.bubblepie,processor.noofBarEnabledSeries+=isBarChartType(chartType_num)&&!disabled?1:0,processor.noofAreaEnabledSeries+=chartType_num!=charttype.area&&chartType_num!=charttype.stkdarea||disabled?0:1,processor.noofAreaRangeEnabledSeries+=chartType_num!=charttype.arearange||disabled?0:1,processor.noofGanttEnabledSeries=processor.ganttSeries_count+=chartType_num!==charttype.gantt||disabled?0:1,processor.isContinousChart=processor.isContinousChart&&(chartType_num==charttype.line||isAreaChartType(chartType_num)||isPointChartType(chartType_num)),processor.hasLevelMarker=processor.hasLevelMarker||chartType_num==charttype.bullet||chartType_num==charttype.dial,processor.isAxisCategory=processor.isAxisCategory||chartcategory.axis.indexOf(chartType_num)>=0,processor.isNonAxisMultiSeriesCategory=processor.isNonAxisMultiSeriesCategory||chartcategory.nonaxismultiseries.indexOf(chartType_num)>=0,processor.isPolarAxisCategory=processor.isPolarAxisCategory||chartType_num==charttype.web,"addorremoveseries"!==state&&!is3DArray&&isArray(curdata)&&(curdata=processor.convertTo3DArray(d,groupbyDataIndices,chartType_num)),!disabled&&isArray(curdata)){categoriesStore["y"+yaxiscolumnorder].enabled=!0,yaxesGroups[yaxiscolumnorder].disabled=!1,needDuplicateCategories=chartType_num===charttype.waterfall&&null==needDuplicateCategories;var obj={si:i,d:curdata};groupedDataBySplitAxes[yaxiscolumnorder]?groupedDataBySplitAxes[yaxiscolumnorder]=groupedDataBySplitAxes[yaxiscolumnorder].concat([obj]):groupedDataBySplitAxes[yaxiscolumnorder]=[obj],processor.setGroupDataComboKey(stacked,chartType_num,obj);var actXdatatype=dataset.getDataType("x",null,allChartTypes),yColumn=(dataset.getDataType("y",yaxiscolumnorder,allChartTypes),dataset.getColumn("y",yaxiscolumnorder));defined(dataset.hasNullFormatter.x)||(dataset.hasNullFormatter.x=!(actXdatatype!==ORDINAL_DATATYPE||!isObjectPropDefined(xColumn[xDatatype],"nullformatting"))),defined(dataset.hasNullFormatter["y"+yaxiscolumnorder])||(dataset.hasNullFormatter["y"+yaxiscolumnorder]=!(yDatatype!==ORDINAL_DATATYPE||!isObjectPropDefined(yColumn[yColumn.datatype],"nullformatting"))),processor.storeCategories(curdata,stacked,groupbyDataIndices,chartType_num,actXdatatype,yDatatype,yaxiscolumnorder,needDuplicateCategories),processor.setExtremes(curdata,stacked,yDatatype,chartType_num,isZenabled,yaxiscolumnorder),processor.totalDataCount(curdata)}});var userCategories=getPropVal(chartObj.userdata,"chart.axes.xaxis.categories");if(processor.isAxisCategory&&datatype_x!==ORDINAL_DATATYPE&&processor.needXCategoriesSorting&&(!defined(userCategories)||defined(userCategories)&&0===userCategories.length)&&categoriesStore.x.sort(d3_ascending),processor.xymultiRenderer=processor.isAxisCategory,processor.isCombinationalChart=processor.isCombinationalChart.values().length>1,processor.groupedByStack=groupedByStack,processor.isPercentChart=processor.noofBarEnabledSeries&&!processor.hasLevelMarker&&!processor.noofGanttEnabledSeries&&isObjectPropDefined(plotOptions,"bar","showAs")&&plotOptions.bar.showAs,stacked){var seriesTypes=dataset.seriesTypes;processor.isStackedPercentChart=processor.noofBarEnabledSeries&&!processor.hasLevelMarker&&!processor.isWaterfallEnabled&&plotOptions.bar.stacked.showAs===PERCENT_SHOWAS||processor.noofAreaEnabledSeries&&plotOptions.area.stacked.showAs===PERCENT_SHOWAS||seriesTypes.has(charttype.web)&&plotOptions.web.stacked.showAs===PERCENT_SHOWAS||seriesTypes.has(charttype.line)&&plotOptions.line.stacked.showAs===PERCENT_SHOWAS}processor.pieWithAxis&&(processor.bubblepieData=processor.processBubblePieData())}},DataProcessorProto.getThresholdValues=function(conf){var values=[];return defined(conf.threshold)&&each(conf.threshold,function(threshold){!0===threshold.show&&threshold.values.length&&(values=values.concat(threshold.values))}),values},DataProcessorProto.getDomain=function(categories,leaf){return this.hierarchical&&(!this.hierarchical.groupByDiscreteTime||!leaf)||this.isWaterfallEnabled?d3_range(categories.length):categories},DataProcessor.helpers={isCatNull:function(dataset,type,index){var noNullFormat=dataset.hasNullFormatter&&!dataset.hasNullFormatter[type+(defined(index)?index:"")];return function(cat){return!defined(cat)&&noNullFormat}},is3D:function(data){return isArray(data)&&isArray(data[0])&&isArray(data[0][0])},getParsedYAxisOrder:function(yaxiscolumnorder){return isArray(yaxiscolumnorder)?yaxiscolumnorder[0]:yaxiscolumnorder||0},getChartType:function(type,chartTypeBy,index,data){if(null!=type||null!=index){var chartName,chartValue,seriesdata=data&&data.seriesdata.chartdata;return defined(index)&&(type=pick((seriesdata[index]||seriesdata[0]).type,data.seriesdata.type)),isNaN(+type)?(chartName=type.toLowerCase(),chartValue=charttype[chartName]):(chartValue=+type,chartName=charttypenames.get(chartValue)),"string"===chartTypeBy?chartName:chartTypeBy===NUMERIC_DATATYPE?chartValue:{name:chartName,value:chartValue}}},getAllChartTypes:function(data,chartTypeBy){var helpers=this,globalChartType=data.seriesdata&&data.seriesdata.type;return pick(getPropVal(data,"seriesdata.chartdata"),[]).map(function(a){var temp=helpers.getChartType(pick(a.type,globalChartType),pick(chartTypeBy,NUMERIC_DATATYPE));return chartTypeBy||"object"!==chartTypeBy?temp:{}})},filterDataToViewPort:function(array,startVal,endVal,accessor){return array.filter(function(d){var val=accessor(d);if(val>=startVal&&val<=endVal)return d})},groupByDataIndices:function(metadata){var columns=metadata.columns;return(metadata.axes.groupby||[]).map(function(d){return columns[d].dataindex})}};var legutil=function(){};legutil.colorpallete=d3_map(),legutil.colorpallete.set("greenish",["#6c6c6d","#1ba98e","#00ff80","#00ffc0","#00ffff","#40ff00","#40ff40","#40ff80","#40ffc0","#40ffff","#80ff00","#80ff40","#80ff80","#80ffc0","#80ffff"]),legutil.colorpallete.set("pinkish",["#ff00ff","#ff00c0","#ff0080","#ff0040","#ff0000","#c000ff","#c000c0","#c00080","#c00040","#c00000","#8000ff","#8000c0","#800080","#800040","#800000"]),legutil.colorpallete.set("countries",["#00c6e4","#faa43a","#5da5da","#60bd68","#f17cb0","#b2912f","#307d99"]),legutil.colorpallete.set("saturate5",["#594f4f","#547980","#45ada8","#97843a","#518058","#975156"]),legutil.colorpallete.set("ocean5",["#ff7f00","#6a4a3c","#cc333f","#eb6841","#edc951","#975156"]),legutil.colorpallete.set("zoho-reports-old",["#FF465B","#04C36B","#3A92E9","#FDC33A","#D65587","#FC7C63","#51A5A9","#BFBFBF","#91CD6A","#BE9B89","#7D8DB0","#B68E2E","#C6D5B0","#D1ACCE","#E0AE60","#5CD29F","#716398","#AD8686","#FF99A8","#A0C0C0","#2D7094","#553D4E","#B2449D","#FED577","#D3D159","#AAAAAA","#7ED9D9","#F7A26D","#8ABFA2","#767676","#E36068","#A3AFC7"]),legutil.colorpallete.set("zoho-reports-new",["#60bfdf","#ffa060","#aadf80","#ff6c7d","#c9ac66","#bf80bf","#df6060","#606060","#60a0df","#ff99a8","#feff60","#a0dfdf","#dfa080","#dfdfdf","#a0a060","#a080bf","#a06060","#5cd29f","#ffbe60","#bfa080","#f28fb5","#8080bf","#bfbfbf","#dfdf80","#80a060","#80a060","#a08060","#7ed9d9","#be9b89","#bf6060","#a0bf60","#fc7c63"]),legutil.colorpallete.set("colors",["#0eaadd","#1ac9bb","#92c658","#dbbe56","#ee7d54","#ef4f6a","#b952ef"]),legutil.colorpallete.set("flat-ui-colors",["#23a96e","#bca634","#f75a51","#39b6c5","#f9ce8d","#983a67","#634c3f","#d7dab9","#357180","#983a67","#b16b76","#7f90a0"]),legutil.colorpallete.set("MEMobile",["#73c2f4","#ecd543","#e6be3f","#da7b36","#c84b37","#9c240f","#9bcedd","#ffe560","#ffe560","#c67c99","#c6db4c"]),legutil.colorpallete.set("Toddler",["#f8d0db","#9be1ed","#c4ead1","#fbe2aa","#e5e5e5","#d6b65f","#be9fbf","#ffe560","#ffe560","#c67c99","#c6db4c"]),legutil.colorpallete.set("BrightNDull",["#47bac1","#8ccace","#72c3f5","#71bfee","#ac66ad","#c5a0c6","#906aa6","#b29dbf","#fd9f94","#f6cac4","#ff759c","#f6acc1"]),legutil.colorpallete.set("BlueShades",["#00c6e4","#6ad4e4","#a3dbe4","#c3e0e4","#e4e4e4","#c8c8c8","#aac4c8"]),legutil.colorpallete.set("graphite6",["#595959","#767676","#373737","#9d9d9d","#bfbfbf","#222222"]),legutil.colorpallete.set("chalk",["#FFFFFF","#FAFAFA","#CCCCCC"]),legutil.colorpallete.set("map",["#FB0D0D","#53B808","#B80894","#2ADBDD"]),legutil.patternPallete=d3_map(),legutil.imagePallete=d3_map(),legutil.imagePallete.set("linesndots",["01.png","02.png","03.png","04.png","05.png","06.png","07.png","08.png","09.png","10.png","11.png","12.png","13.png","14.png","15.png","16.png","17.png","18.png","19.png","20.png"]),legutil.imagePallete.set("dotsfirst",["13.png","12.png","13.png","14.png","15.png","16.png","17.png","18.png","19.png","20.png"]),legutil.imagePallete.set("stones",["01.jpg","02.jpg","03.jpg"]),addPattern("hatch","diagonal-line-right","5","1","null","white","1","1"),addPattern("hatchDash","square,diagonal-line-right","5,5","1","transparent,{{brighter}}","transparent,transparent","1","1","0,3"),addPattern("thinThickHatch","square,diagonal-line-right,diagonal-line-right","10,10,10","1,1,3","transparent,null,null",TRANSPARENT,"1","1","0,2.5,0"),addPattern("thickHatch","diagonal-line-right","5","3","null","white","1","1"),addPattern("thinHatch","diagonal-line-right","2","1","null","white","1","1"),addPattern("hatchLeft","diagonal-line-left","5","1","null","white","1","1"),addPattern("horizontalStripes","horizontal-line","5","1","null","white","1","1"),addPattern("thinHorizontalStripes","horizontal-line","2","1","null","white","1","1"),addPattern("verticalStripes","vertical-line","5","1","null","white","1","1"),addPattern("thinVerticalStripes","vertical-line","2","1","null","white","1","1"),addPattern("crossStripes","vertical-line,horizontal-line","5","1","null","white","1","1"),addPattern("tinyHatchfill","square,diagonal-line-right","5","1","transparent,{{brighter}}","null,transparent","1","1"),addPattern("hatchfill","square,diagonal-line-right","10","1","transparent,{{brighter}}","null,transparent","1","1"),addPattern("hatchDashfill","square,diagonal-line-right","5,5","1","transparent,{{brighter}}","null,transparent","1","1","0,3"),addPattern("hatchLeftfill","square,diagonal-line-left","5","1","transparent,{{brighter}}","null,transparent","1","1"),addPattern("horizontalStripesfill","square,horizontal-line","5","1","transparent,{{brighter}}","null,transparent","1","1"),addPattern("verticalStripesfill","square,vertical-line","5","1","transparent,{{brighter}}","null,transparent","1","1"),addPattern("crossStripesfill","square,square","5,5","1","transparent,{{brighter}}","null,transparent","1","1"),addPattern("checkerBoard","square,square,square","10,5,5","1",TRANSPARENT,"transparent,null,{{brighter}}","1","1","0,0,5"),addPattern("circle","circle","10","1","null","white","1","1"),addPattern("tinyCircle","circle","5","1","null","white","1","1"),addPattern("crossCircle","square,circle,circle","10,5,5","1","transparent,null,{{brighter}}",TRANSPARENT,"1","1","0,0,5"),addPattern("floatingCircle","square,circle","10,5","1","transparent,{{brighter}}",TRANSPARENT,"1","1","0,2.5"),addPattern("dot","square,circle","5,2.5","1","transparent,{{brighter}}","transparent,transparent","1","1","0,1.25"),addPattern("dotSquare","square,circle","10,2.5","1","null,{{brighter}}","transparent,transparent","1","1","0,3.75"),addPattern("circlefill","square,circle","10,10","1","transparent,{{brighter}}","null,transparent","1","1"),addPattern("crossCirclefill","square,circle,circle","10,5,5","1","transparent,null,{{brighter}}","null,{{brighter}},null","1","1","0,0,5"),addPattern("floatingCirclefill","square,circle","10,5","1","transparent,{{brighter}}","null,transparent","1","1","0,2.5"),addPattern("dotfill","square,circle","5,2.5","1","transparent,{{brighter}}","null,transparent","1","1","0,1.25"),addPattern("square","square","5","1","null","white","1","1"),addPattern("squarefill","square","5","1","{{brighter}}","null","1","1"),addPattern("star","star","10","1","null","white","1","1"),addPattern("starfill","square,star","10,5","1","transparent,{{brighter}}","null,transparent","1","1"),addPattern("wave","waves","5","1","null","white","1","1"),addPattern("wavefill","square,waves","10,10","1","transparent,{{brighter}}","null,transparent","1","1"),addPattern("cap","caps","5","1","null","white","1","1"),addPattern("capfill","square,caps","10,10","1","transparent,{{brighter}}","null,transparent","1","1"),addPattern("nylon","nylon","5","1","null","white","1","1"),addPattern("nylonfill","square,nylon","10,10","1","transparent,{{brighter}}","null,transparent","1","1"),legutil.patternPallete.set("stripes-fill",["hatchfill","hatchDashfill","checkerBoard","horizontalStripesfill","verticalStripesfill","crossStripesfill"]),legutil.patternPallete.set("stripes",["hatch","thinThickHatch","hatchLeft","hatchDash","horizontalStripes","crossStripes","verticalStripes","thickHatch","thinHatch","thinVerticalStripes","thinHorizontalStripes"]),legutil.patternPallete.set("dotted",["circle","tinyCircle","crossCircle","floatingCircle","dot"]),legutil.patternPallete.set("dotted-fill",["circlefill","crossCirclefill","floatingCirclefill","dotfill"]),legutil.patternPallete.set("shapes",["thinThickHatch","crossCircle","star","wave","cap","nylon"]),legutil.patternPallete.set("shapes-fill",["checkerBoard","floatingCirclefill","squarefill","starfill","wavefill","capfill","nylonfill"]);function getLegendPosition(area,chartObj,considerMargin){var legendConfig=chartObj.systemConf.legend,legNode=chartObj.legendarea.element.node(),alignment=getLegendAlignment(legendConfig),left=0,top=0,getMargin=function(side){return!1===considerMargin?0:+legendConfig[side]},isContinuousLegend=legend_helpers.isContinousLegend(chartObj),legendBBox=isContinuousLegend?legNode.getBBox():legNode.getBoundingClientRect(),legendWidth=legendBBox.width,legendHeight=legendBBox.height,floating=defined(legendConfig.x)&&defined(legendConfig.y);if(isContinuousLegend||(legendBBox.x=0,legendBBox.y=0),floating)return[legendConfig.x-legendBBox.x,legendConfig.y-legendBBox.y];switch(alignment.hAlign){case"left":left=area.left+getMargin("marginLeft")-legendBBox.x;break;case"center":left=area.width/2-legendWidth/2-legendBBox.x;break;case"right":left=(isContinuousLegend?area.left:0)+area.width-legendWidth-getMargin("marginRight")-legendBBox.x}switch(alignment.vAlign){case"top":top=area.top+getMargin("marginTop")-legendBBox.y;break;case"center":top=area.top+area.height/2-legendHeight/2;break;case"bottom":top=area.top+area.height-legendHeight-getMargin("marginBottom")-legendBBox.y}return[left,top]}function getLegendShowAsText(d,i,options,chartObj){var showAs=options.showAs,seriesPos=0,itemPos=i;if((chartObj.xymultiRenderer||chartObj.isNonAxisMultiSeriesCategory||chartObj.isGeoMap)&&(seriesPos=i,itemPos=0),showAs)return showAs=invokeFunction(showAs,d,i,chartObj),chartObj.dataset.getCustomizedVal(chartObj,showAs,seriesPos,0,itemPos,d,"legend")}legutil.imagePallete.each(function(value,pallete){var arr=value.map(function(d,i){return _imageFilePath+d});legutil.imagePallete.set(pallete,arr)}),legutil.getMonochromeColorPallette=function(conf){var domain=[0,+conf.count-1],range=[+conf.colorGamma[0],+conf.colorGamma[1]],monoClrGen=getMonochromeColor(conf.baseColor,domain,range);return d3_range(conf.count).map(function(d,i){return monoClrGen(i)})};var loadDetectBrowser=function(){var userAgent=navigator.userAgent,browser={};if(userAgent.indexOf("OPR")>0){browser.name="Opera",browser.jsPrefix="webkit",browser.cssPrefix="-webkit-";var index=userAgent.indexOf("OPR/");browser.version=pInt(userAgent.substr(index+4))}else if(userAgent.indexOf("Chrome")>0){browser.name="Chrome",browser.jsPrefix="webkit",browser.cssPrefix="-webkit-";index=userAgent.indexOf("Chrome/");browser.version=pInt(userAgent.substr(index+7))}else if(userAgent.indexOf("Safari")>0){browser.name="Safari",browser.jsPrefix="webkit",browser.cssPrefix="-webkit-";index=userAgent.indexOf("Version/");browser.version=pInt(userAgent.substr(index+8))}else if(userAgent.indexOf("Firefox")>0){browser.name="Firefox",browser.jsPrefix="Moz",browser.cssPrefix="-moz-";index=userAgent.indexOf("Firefox/");browser.version=pInt(userAgent.substr(index+8))}else if(userAgent.indexOf("MSIE")>0){browser.name="Internet Explorer",browser.jsPrefix="ms",browser.cssPrefix="-ms-";index=userAgent.indexOf("MSIE");browser.version=pInt(userAgent.substr(index+5))}else browser=void 0;return browser},loadSetStyle=function(elementObj,paramsObj){var docStyles=getComputedStyle(elementObj),browser=loadDetectBrowser();for(var property in paramsObj)if(paramsObj.hasOwnProperty(property))if(property in docStyles)elementObj.style[property]=paramsObj[property];else if(void 0!=browser){var propertyFix=browser.jsPrefix+property.charAt(0).toUpperCase()+property.slice(1);elementObj.style[propertyFix]=paramsObj[property]}},ZCloader=function(elemObj,customObj){var baseObj={type:"zBars",scale:1,duration:1.2},style=document.getElementById("ZCloader");for(var config in ZCloader.style||((style=document.createElement("style")).setAttribute("id","ZCloader"),document.head.appendChild(style),ZCloader.style=!0),customObj)customObj.hasOwnProperty(config)&&(baseObj[config]=customObj[config]);var clr=baseObj.colors||["rgb(204, 32, 50)","rgb(24, 153, 74)","rgb(1, 115, 178)","rgb(253, 208, 25)"],clr1=clr[0%clr.length],clr2=clr[1%clr.length],clr3=clr[2%clr.length],clr4=clr[3%clr.length],browser=loadDetectBrowser(),animString="";if(void 0===browser?(browser={}).cssPrefix="":"Internet Explorer"===browser.name&&browser.version<10&&(baseObj.type="wheel"),!elemObj.loader){var animBlock=document.createElement("div");if("zBlocks"==baseObj.type){if(!ZCloader.zBlocks){animString="\n@"+browser.cssPrefix+"keyframes "+baseObj.type+" {";animString+="0% { left:0px; top:0px; "+browser.cssPrefix+"transform:rotate(0deg) scale(1)}",animString+="25% { left:40px; top:0px; "+browser.cssPrefix+"transform:rotate(90deg) scale(0.5)}",animString+="50% { left:40px; top:40px; "+browser.cssPrefix+"transform:rotate(180deg) scale(1.0)}",animString+="75% { left:0px; top:40px; "+browser.cssPrefix+"transform:rotate(270deg) scale(0.5)}",animString+="100% { left:0px; top:0px; "+browser.cssPrefix+"transform:rotate(360deg)scale(1)} }\n",style.innerHTML+=animString,ZCloader.zBlocks=!0}loadSetStyle(animBlock,{display:"inline-block",verticalAlign:"middle",width:"70px",height:"70px",transform:"scale("+baseObj.scale+")"});var block1=document.createElement("div");block1.innerHTML="&nbsp",animBlock.appendChild(block1),loadSetStyle(block1,{backgroundColor:clr1,width:"30px",height:"30px",borderRadius:"1px",position:"absolute",top:"0",left:"0",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out"});var block2=document.createElement("div");block2.innerHTML="&nbsp",animBlock.appendChild(block2),loadSetStyle(block2,{backgroundColor:clr2,width:"30px",height:"30px",borderRadius:"1px",position:"absolute",top:"0",left:"0",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",animationDelay:"-"+baseObj.duration/4*1+"s"});var block3=document.createElement("div");block3.innerHTML="&nbsp",animBlock.appendChild(block3),loadSetStyle(block3,{backgroundColor:clr3,width:"30px",height:"30px",borderRadius:"1px",position:"absolute",top:"0",left:"0",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",animationDelay:"-"+baseObj.duration/4*2+"s"});var block4=document.createElement("div");block4.innerHTML="&nbsp",animBlock.appendChild(block4),loadSetStyle(block4,{backgroundColor:clr4,width:"30px",height:"30px",borderRadius:"1px",position:"absolute",top:"0",left:"0",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",animationDelay:"-"+baseObj.duration/4*3+"s"}),elemObj.loader=!0}else if("zCircle1"==baseObj.type){if(!ZCloader.zCircle1){animString="\n@"+browser.cssPrefix+"keyframes "+baseObj.type+" { ";animString+="0% ,25%, 50%, 75%, 100%{ "+browser.cssPrefix+"transform: scale(0.0);  } ",animString+="12.5%  { "+browser.cssPrefix+"transform: scale(1.0); background-color: "+clr1+";}",animString+="37.5%  { "+browser.cssPrefix+"transform: scale(1.0); background-color: "+clr2+";}",animString+="62.5%  { "+browser.cssPrefix+"transform: scale(1.0); background-color: "+clr3+";}",animString+="87.5%  { "+browser.cssPrefix+"transform: scale(1.0); background-color: "+clr4+";} }\n",style.innerHTML+=animString,ZCloader.zCircle1=!0}loadSetStyle(animBlock,{display:"inline-block",verticalAlign:"middle",width:"70px",height:"70px",transform:"scale("+baseObj.scale+")"});var circle=document.createElement("div");circle.innerHTML="&nbsp",animBlock.appendChild(circle),loadSetStyle(circle,{width:"100%",height:"100%",borderRadius:"50%",opacity:"0.6",position:"absolute",top:"0",left:"0",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out"}),elemObj.loader=!0}else if("zBars"==baseObj.type){if(!ZCloader.zBars){animString="\n@"+browser.cssPrefix+"keyframes "+baseObj.type+" { ";animString+="0%, 40%, 100% { "+browser.cssPrefix+"transform: scaleY(0.4) }",animString+="20% { "+browser.cssPrefix+"transform: scaleY(1.0) } }\n",style.innerHTML+=animString,ZCloader.zBars=!0}loadSetStyle(animBlock,{display:"inline-block",verticalAlign:"middle",width:"50px",height:"30px",textAlign:"center",fontSize:"10px",transform:"scale("+baseObj.scale+")"}),(bar1=document.createElement("div")).innerHTML="&nbsp",animBlock.appendChild(bar1),loadSetStyle(bar1,{backgroundColor:clr1,marginLeft:"1px",display:"inline-block",width:"6px",height:"100%",borderRadius:"1px",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out"}),(bar2=document.createElement("div")).innerHTML="&nbsp",animBlock.appendChild(bar2),loadSetStyle(bar2,{backgroundColor:clr2,marginLeft:"1px",display:"inline-block",width:"6px",height:"100%",borderRadius:"1px",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",animationDelay:"-"+(baseObj.duration-.1)+"s"}),(bar3=document.createElement("div")).innerHTML="&nbsp",animBlock.appendChild(bar3),loadSetStyle(bar3,{backgroundColor:clr3,marginLeft:"1px",display:"inline-block",width:"6px",height:"100%",borderRadius:"1px",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",animationDelay:"-"+(baseObj.duration-.2)+"s"}),(bar4=document.createElement("div")).innerHTML="&nbsp",animBlock.appendChild(bar4),loadSetStyle(bar4,{backgroundColor:clr4,marginLeft:"1px",display:"inline-block",width:"6px",height:"100%",borderRadius:"1px",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",animationDelay:"-"+(baseObj.duration-.3)+"s"}),elemObj.loader=!0}else if("zCircle2"==baseObj.type){if(!ZCloader.zCircle2){animString="\n@"+browser.cssPrefix+"keyframes "+baseObj.type+" { ";animString+="0%, 80%, 100% { "+browser.cssPrefix+"transform: scale(0.0) }",animString+="40% { "+browser.cssPrefix+"transform: scale(1.0) } }\n",style.innerHTML+=animString,ZCloader.zCircle2=!0}loadSetStyle(animBlock,{display:"inline-block",verticalAlign:"middle",width:"72px",height:"18px",textAlign:"center",fontSize:"10px",transform:"scale("+baseObj.scale+")"});var circ1=document.createElement("div");circ1.innerHTML="&nbsp",animBlock.appendChild(circ1),loadSetStyle(circ1,{backgroundColor:clr1,display:"inline-block",width:"18px",height:"18px",borderRadius:"100%",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out"});var circ2=document.createElement("div");circ2.innerHTML="&nbsp",animBlock.appendChild(circ2),loadSetStyle(circ2,{backgroundColor:clr2,display:"inline-block",width:"18px",height:"18px",borderRadius:"100%",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",animationDelay:"-"+(baseObj.duration-.2)+"s"});var circ3=document.createElement("div");circ3.innerHTML="&nbsp",animBlock.appendChild(circ3),loadSetStyle(circ3,{backgroundColor:clr3,display:"inline-block",width:"18px",height:"18px",borderRadius:"100%",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",animationDelay:"-"+(baseObj.duration-.4)+"s"});var circ4=document.createElement("div");circ4.innerHTML="&nbsp",animBlock.appendChild(circ4),loadSetStyle(circ4,{backgroundColor:clr4,display:"inline-block",width:"18px",height:"18px",borderRadius:"100%",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",animationDelay:"-"+(baseObj.duration-.6)+"s"}),elemObj.loader=!0}else if("zCrossBars"==baseObj.type){if(!ZCloader.zCrossBars){animString="\n@"+browser.cssPrefix+"keyframes "+baseObj.type+" { ";animString+="0%{left:-50%;}",animString+="100%{left: 150%;} }\n",style.innerHTML+=animString,ZCloader.zCrossBars=!0}var bar1,bar2,bar3,bar4;loadSetStyle(animBlock,{display:"inline-block",position:"relative",verticalAlign:"middle",width:"70px",height:"30px",boxSizing:"border-box",borderWidth:"2px",borderStyle:"solid",borderColor:"rgb(160, 150, 150)",borderRadius:"8px",overflow:"hidden",transform:"scale("+baseObj.scale+")"}),(bar1=document.createElement("div")).innerHTML="&nbsp",animBlock.appendChild(bar1),loadSetStyle(bar1,{backgroundColor:clr1,width:"10px",height:"100%",position:"absolute",transform:"rotate(45deg) scaleY(2)",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDelay:"-"+baseObj.duration+"s"}),(bar2=document.createElement("div")).innerHTML="&nbsp",animBlock.appendChild(bar2),loadSetStyle(bar2,{backgroundColor:clr2,width:"10px",height:"100%",position:"absolute",transform:"rotate(45deg) scaleY(2)",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDelay:"-"+baseObj.duration/100*80+"s"}),(bar3=document.createElement("div")).innerHTML="&nbsp",animBlock.appendChild(bar3),loadSetStyle(bar3,{backgroundColor:clr3,width:"10px",height:"100%",position:"absolute",transform:"rotate(45deg) scaleY(2)",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDelay:"-"+baseObj.duration/100*60+"s"}),(bar4=document.createElement("div")).innerHTML="&nbsp",animBlock.appendChild(bar4),loadSetStyle(bar4,{backgroundColor:clr4,width:"10px",height:"100%",position:"absolute",transform:"rotate(45deg) scaleY(2)",animationName:baseObj.type,animationDuration:baseObj.duration+"s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDelay:"-"+baseObj.duration/100*40+"s"}),elemObj.loader=!0}else loadSetStyle(animBlock,{display:"inline-block",verticalAlign:"middle",width:"30px",height:"30px",position:"absolute",backgroundImage:"url('"+_imageFilePath+"loader_"+baseObj.type+".gif')",backgroundSize:"30px 30px",backgroundRepeat:"no-repeat",backgroundPosition:"center"});return animBlock}};function VizLayout(container,userData){this.container=container,this.userdata=userData,this.dataset={},this.dataObject={},this.canvasarea={},this.chartarea={},this.legendarea={},this.legend={component:null},this.renderer=[],this.svg=null,this.cache={},this.subrenderer=[],this.datalabels={moduleExists:labelRenderer},this.prepareLayout()}VizLayout.prototype.prepareLayout=function(){var currentChartId=(viewCount=viewCount||0,++viewCount);this.id="ZC_"+currentChartId,this.idNumeric=currentChartId;try{var data=this.userdata;this.createHelperElements(),this.handleHiddenContainer(),this.chartWidth=this.getChartDimension("width"),this.chartHeight=this.getChartDimension("height"),VizLayout.helpers.initializeChartHolders(this),this.setCanvasDimension(),this.chartTypes=DataProcessor.helpers.getAllChartTypes(data,"object"),this.chartFontProp={},this.globalProp=setGlobalPropByUserdata(data,{width:this.canvasarea.width,height:this.canvasarea.height},this.chartFontProp),this.themeoptions=this.getThemeOptions(this.globalProp),data.metadata||setDefaultOptions("metadata",data),this.defsLocation=getDefsLocation(),this.svg.append("defs")}catch(err){VizLayout.helpers.handleErrors(this,err)}};var chartBasicHelpers={getPatternSvg:function(){var patternSvg=this.patternSVG;if(!defined(patternSvg)){var rootBody=getRootBody(this.container.node());patternSvg=this.patternSVG=d3_select(rootBody).select("svg.svgPattern")}return patternSvg},getDocumentIndex:function(){return defined(this.DOCUMENT_INDEX)||(this.DOCUMENT_INDEX=getDocumentIndex(this.container.node())),this.DOCUMENT_INDEX},getBaseContainer:function(){var index=this.getDocumentIndex();return defined(this.BASE_HELPER_CONTAINER)||(this.BASE_HELPER_CONTAINER=DOCUMENT_OBJECT_HOLDER[index].BASE_HELPER_CONTAINER),this.BASE_HELPER_CONTAINER},createHelperElements:function(){var rootBody=getRootBody(this.container.node()),patternSvg=d3_select(rootBody).select("svg.svgPattern");if(patternSvg.empty()){var rootDocument=getRootNode(rootBody),baseContainer=appendEle(d3_select(rootBody),"div",[1],".","class","__baseZC_Container__");baseContainer.styles({position:"absolute",left:-9999+PX,top:-9999+PX}),this.patternSVG=appendEle(baseContainer,"svg",[1],".","class","svgPattern").attrs({version:"1.1",xmlns:d3$1.namespaces.svg}),appendEle(this.patternSVG,"defs",[1]);var DOCUMENT_COUNT=0,documentIndex=DOCUMENT_COUNT++;rootDocument.ZC_DOCUMENT_INDEX=documentIndex,DOCUMENT_OBJECT_HOLDER[documentIndex]={BASE_HELPER_CONTAINER:baseContainer,EFFECTS:{}}}else this.patternSVG=patternSvg},handleHiddenContainer:function(normalize){var container=this.container;if(normalize&&defined(this.originalContainer))this.originalContainer.node().appendChild(this.d3container.node()),this.container.remove(),this.container=this.originalContainer,delete this.isHiddenCoainer,delete this.originalContainer;else{var containerNode=container.node();if(null===containerNode.offsetParent){var containerClone=containerNode.cloneNode(0);this.getBaseContainer().node().appendChild(containerClone),containerClone.style.setProperty("display","block","important"),this.isHiddenCoainer=!0,this.originalContainer=container,this.container=d3_select(containerClone)}}},updateCanvasArea:function(){var systemConfig=this.systemConf;this.container.selectAll("div.d3container").styles({position:"relative",width:this.getChartDimension("width")+PX,height:this.getChartDimension("height")+PX}),(this.chartParentElement=this.container.selectAll("div.canvas-component")).styles({position:"relative",width:this.canvasarea.width+"px",height:this.canvasarea.height+"px"});var canvasProp=this.container.selectAll("div.canvas-property");canvasProp.styles({position:"absolute",width:this.canvasarea.width+"px",height:this.canvasarea.height+"px"}),this.updateCommonBBSProp(canvasProp,null,systemConfig.canvas,"canvas")},getThemeOptions:function(globalProp){var userTheme,defaultThemeConfig,overallTypes=charttypenames.values(),allSeriesTypes=this.chartTypes.map(function(chartType){return chartType.name}),theme=null;return this.userdata.canvas&&(theme=this.userdata.canvas.theme),defaultThemeConfig=new defaultTheme(globalProp),overallTypes.map(function(d,i){-1!==allSeriesTypes.indexOf(d)&&setDefaultOptions(d,defaultThemeConfig.chart.plot.plotoptions,globalProp)}),defined($ZC[theme])?(userTheme=new $ZC[theme](globalProp),userTheme=mergeJSON(defaultThemeConfig,userTheme,!0,!0)):userTheme=defaultThemeConfig,userTheme},getChartDimension:function(property){var temp={width:960,height:400};return this.isHiddenCoainer||(temp[property]=getStyle(this.container,property,!0)),temp[property]},setCanvasDimension:function(width,height){width||height||(width=this.getChartDimension("width"),height=this.getChartDimension("height")),this.canvasarea={left:0,top:0,right:0,bottom:0,width:width,height:height}},setChartDimension:function(){var borderOptions=this.systemConf.canvas.border,borderSize_canvas=borderOptions.show?validateValWithinLimit(borderOptions,"size",0,10,this.canvasarea.width,this.canvasarea.height):0;this.chartarea={left:this.canvasarea.left+borderSize_canvas,top:this.canvasarea.top+borderSize_canvas,right:this.canvasarea.right-borderSize_canvas,bottom:this.canvasarea.bottom-borderSize_canvas,width:this.canvasarea.width-2*borderSize_canvas,height:this.canvasarea.height-2*borderSize_canvas},this.plotarea=Object.create(this.chartarea)},applyChartProperties:function(){var systemConfig=this.systemConf,chartHeight=this.chartHeight,title=systemConfig.canvas.title,subtitle=systemConfig.canvas.subtitle,credits=systemConfig.credits||{},showTitle=title.show&&dimension_based_intelligence(this,"title",chartHeight),showSubtitle=subtitle.show&&dimension_based_intelligence(this,"subtitle",chartHeight);if(!0===credits.enabled&&dimension_based_intelligence(this,"credits",chartHeight)){setDefaultOptions("credits",this.systemConf,this.globalProp);this.drawTitle(this.systemConf.credits,"credits")}showTitle&&("bottom"===title.vAlign&&"bottom"===subtitle.vAlign&&subtitle.show?this.drawTitle(systemConfig.canvas.subtitle,"subtitle"):this.drawTitle(systemConfig.canvas.title,"title")),showSubtitle&&("bottom"===subtitle.vAlign&&"bottom"===title.vAlign&&title.show?this.drawTitle(systemConfig.canvas.title,"title"):this.drawTitle(systemConfig.canvas.subtitle,"subtitle")),this.plotarea=Object.create(this.chartarea),this.container.selectAll("g.plotareaBorder-property").selectAll("line","path").style("border","");var plotOptions=systemConfig.chart,mLeft=parseFloat(plotOptions.marginLeft),mRight=parseFloat(plotOptions.marginRight),mTop=parseFloat(plotOptions.marginTop),mBottom=parseFloat(plotOptions.marginBottom),mLeft_corr=mLeft+mRight>this.plotarea.width?0:mLeft,mRight_corr=mLeft+mRight>this.plotarea.width?0:mRight,mTop_corr=mTop+mBottom>this.plotarea.height?0:mTop,mBottom_corr=mTop+mBottom>this.plotarea.height?0:mBottom;this.plotarea.left+=mLeft_corr,this.plotarea.right+=mRight_corr,this.plotarea.bottom+=mBottom_corr,this.plotarea.top+=mTop_corr,this.plotarea.width=this.plotarea.width-mLeft_corr-mRight_corr,this.plotarea.height=this.plotarea.height-mBottom_corr-mTop_corr},drawTitle:function(data,type){var svg=this.svg,systemConfig=this.systemConf,floating=defined(data.x)&&defined(data.y),location=window.location,margin={top:validateNullVal(data.marginTop,0),right:validateNullVal(data.marginRight,0),bottom:validateNullVal(data.marginBottom,0),left:validateNullVal(data.marginLeft,0)},titlearea=svg.selectAll("g.chart"+type),titleAlign=floating?{x:data.x+margin.left,y:data.y+margin.top,dy:"1",textAnchor:"left"===data.hAlign?"start":"right"===data.hAlign?"end":"middle"}:VizLayout.helpers.align(data.hAlign,data.vAlign,this.chartarea,margin),isTextBox=!defined(data.imageUrl),element=isTextBox?""===data.text?NONE:"text":"image";if(element!==NONE){var title=appendEle(titlearea,element,[data],".","class",type);if(defined(data.href)){var click=function(){var url,regExp_http,regExp_nonHttp;if(url=data.href,regExp_http=new RegExp(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g),regExp_nonHttp=new RegExp(/[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi),url.match(regExp_http)||url.match(regExp_nonHttp)){var target=data.target;"newtab"===target||"newwindow"===target?window.open(data.href,"popUpWindow","newwindow"===target?"status=yes":""):location.href=data.href}else Console.log("invalid URL for credits")};attachevents(title,{click:click},{tap:click})}if(isTextBox){var userdataCanvasFontColor=this.userdata.canvas?this.userdata.canvas.fontColor:null;title.attrs({x:titleAlign.x,y:titleAlign.y,dy:titleAlign.dy+"em","text-anchor":titleAlign.textAnchor}).styles({cursor:defined(data.href)?POINTER:"auto",display:"block"}).text(decodeHTML(data.text)),!0===data.tooltip&&addSVGtitleEle(title),applyFont(title,[{fontColor:"subtitle"!==type||defined(data.fontColor)||defined(userdataCanvasFontColor)?data.fontColor||userdataCanvasFontColor:"#CCCCCC"},data,systemConfig.canvas,$ZCG])}else title.attrs({x:titleAlign.x+("right"===data.hAlign?-data.imageWidth:0),y:titleAlign.y+("bottom"===data.vAlign?-data.imageHeight:0),width:data.imageWidth,height:data.imageHeight,"xlink:href":data.imageUrl}).styles({cursor:defined(data.href)?POINTER:"auto",display:"block"});var titlenode=bbox(title.node()),textBounds={left:floating?data.x+margin.left:titlenode.x,top:floating?data.y+margin.top:titlenode.y,width:titlenode.width,height:titlenode.height},edge={left:margin.left,top:margin.top,right:this.canvasarea.width-margin.right,bottom:this.canvasarea.height};if(trimText(title.node(),decodeHTML(data.text),textBounds,edge,"bottom","..",{left:5,right:5,top:5,bottom:5}),!floating){var nodeHeight=titlenode.height+margin.bottom+margin.top;"top"===data.vAlign&&(this.chartarea.top+=nodeHeight,this.chartarea.height-=nodeHeight),"bottom"===data.vAlign&&(this.chartarea.height-=nodeHeight)}}titlearea.selectAll(element===NONE?"text,image":"image"===element?"text":"image").style("display",NONE)},updateCommonBBSProp:function(ele,subEle,data,type){var borderEle,systemConfig=this.systemConf,border=data.border||{},background=data.background||{},shadow=data.shadow||{};ele.styles({"background-color":background.color,opacity:background.alpha});var bgImg=null;if(!0===getPropVal(background,"gradients.show")){var gradient,gradientColors="";if(defined(background.gradients.useCSS)?gradient=background.gradients.useCSS:(defined(background.gradients.stopColor)&&background.gradients.stopColor.map(function(d,i){var offset=defined(background.gradients.stopOffset)&&defined(background.gradients.stopOffset[i])?" "+background.gradients.stopOffset[i]:"";gradientColors+=0===i?d+" "+offset:","+d+offset}),"radial"===background.gradients.type?gradient="radial-gradient("+gradientColors+")":"linear"===background.gradients.type&&(gradient="linear-gradient("+gradientColors+")")),$Browser.WEBKIT)bgImg="-webkit-"+gradient;else if($Browser.FIREFOX)bgImg="-moz-"+gradient;else if($Browser.IE){bgImg="-ms-"+gradient;var filter=defined(background.gradients.stopColor)?"linear"===background.gradients.type?"progid:DXImageTransform.Microsoft.gradient(startColorstr="+(background.gradients.stopColor[0]||"black")+", endColorstr="+(background.gradients.stopColor[1]||"white")+")":"progid:DXImageTransform.Microsoft.Alpha(opacity=100, finishopacity=0, style=2)":null;ele.style("filter",filter)}}if(defined(background.imageUrl)&&(bgImg="url("+background.imageUrl+")"),1===$Browser.IE&&0===$Browser.VERSION.indexOf("9.")||ele.styles({"background-image":bgImg,"background-repeat":background.imageRepeat,opacity:background.alpha}),!0===border.show&&"canvas"===type){borderEle="plotarea"===type?subEle:ele;var borderSize="canvas"===type?validateValWithinLimit(systemConfig.canvas.border,"size",0,10,this.canvasarea.width,this.canvasarea.height):validateValWithinLimit(systemConfig.chart.plot.border,"size",0,10,this.plotarea.width,this.plotarea.height);borderSize=pick(borderSize,2),borderEle.styles({border:borderSize+"px "+border.style+" "+border.color,"border-radius":pInt(border.radius)+"px"}),borderEle.node().border={size:borderSize,clr:border.color}}else borderEle="plotarea"===type?subEle:ele,"plotarea"!==type&&borderEle.style("border","");if(!0===shadow.show){var shadowstyle=shadow.x+"px "+shadow.y+"px "+shadow.blur+"px "+shadow.color;!0===shadow.inset&&(shadowstyle+=" inset"),ele.style("box-shadow",shadowstyle)}else ele.style("box-shadow","")},updatePlotareaProp:function(){var systemConfig=this.systemConf,container=this.container,plotareaProp=container.selectAll("div.plotarea-property"),plotareaBorderProp=this.staticPaneSVG.selectAll("g.plotareaBorder-property"),styles={position:"absolute",left:this.plotarea.left+"px",top:this.plotarea.top+"px",width:this.plotarea.width+"px",height:this.plotarea.height+"px","pointer-events":NONE,"box-sizing":"border-box"};styles[$Browser.prefix.css+"box-sizing"]="border-box",container.selectAll("div.plotarea-property").styles(styles),plotareaBorderProp.attrs({transform:"translate("+this.plotarea.left+","+this.plotarea.top+")"}),this.updateCommonBBSProp(plotareaProp,plotareaBorderProp,systemConfig.chart.plot,"plotarea")},drawPlotareaClippath:function(){var systemConfig=this.systemConf,zoomedX=isObjectPropDefined(systemConfig,"chart.zoom.x")||defined(this.scrolledX),zoomedY=isObjectPropDefined(systemConfig,"chart.zoom.y")||defined(this.scrolledY),axisrotated=this.dataObject.getAxisRotated(),ms=getMarkerSize(this),x=(axisrotated?zoomedY:zoomedX)?this.plotarea.left:-ms.left+this.plotarea.left,y=(axisrotated?zoomedX:zoomedY)?this.plotarea.top:-ms.top+this.plotarea.top,width=this.plotarea.width+((axisrotated?zoomedY:zoomedX)?0:ms.left+ms.right),height=this.plotarea.height+((axisrotated?zoomedX:zoomedY)?0:ms.top+ms.bottom),properties={name:"rect",id:this.id,x:x,y:y,width:width,height:height},args={chartObj:this},clipID=effects.get(effects.svg_clips,"rect",properties,args);this.wrap.selectAll("g.seriesClippathholder").attr("clip-path","url("+this.defsLocation+"#"+clipID+")"),this.staticPaneSVG.selectAll("g.labelClippathholder,g#zcscatterCliphighlight,g#zcareaCliphighlight,g#zcbarCliphighlight").attr("clip-path","url("+this.defsLocation+"#"+clipID+")")},getChartSeriesColor:function(){var chart=this,colors=[],legend_data=chart.systemConf.legend;if(legend_data.colors)if(isArray(legend_data.colors))colors=legend_data.colors;else{var legendColors=[];for(var key in legend_data.colors)legend_data.colors.hasOwnProperty(key)&&legendColors.push(legend_data.colors[key]);colors=legendColors}else if(legend_data.imagePallete){chart.patternImageSizes=[];var imagePallete=legutil.imagePallete.get(legend_data.imagePallete);chart.imagePallete=imagePallete;var defaultSize="stripes"===legend_data.imagePallete?null:50,tempImage=appendEle(chart.getPatternSvg(),"image",[1],".","class","tempImage");imagePallete.map(function(d,i){tempImage.attr("xlink:href",d);var bb=bbox(tempImage.node());chart.patternImageSizes[i]=[defaultSize||bb.width||3,defaultSize||bb.height||3]}),tempImage.remove()}else legend_data.colorPallete&&(colors="monochrome"===legend_data.colorPallete.type?legutil.getMonochromeColorPallette(legend_data.colorPallete.options.monochrome):legutil.colorpallete.get(legend_data.colorPallete.options.multicolor)||legutil.colorpallete.get("flat-ui-colors"));if(legend_data.patterns)chart.patternPallete=legend_data.patterns;else if(legend_data.patternPallete){var patternPallete=legutil.patternPallete.get(legend_data.patternPallete);!defined(patternPallete)&&isArray(legend_data.patternPallete)&&legend_data.patternPallete.length&&(patternPallete=legend_data.patternPallete),chart.patternPallete=patternPallete}defined(colors)&&(chart.seriesColor=colors.slice(0,colors.length),colorscale_helpers.isQuantileColorScale(chart)||chart.seriesdata.map(function(d,i){defined(d.color)&&(chart.seriesColor[i]=d.color)}))},resetdata:function(newSystemConf){this.chartWidth=this.getChartDimension("width"),this.chartHeight=this.getChartDimension("height"),this.setCanvasDimension(),this.chartTypes=DataProcessor.helpers.getAllChartTypes(newSystemConf,"object"),this.processUserData(newSystemConf,!0),this.setChartDimension(),this.globalProp=setGlobalPropByUserdata(newSystemConf,{width:this.canvasarea.width,height:this.canvasarea.height},this.chartFontProp),this.events={},this.dataObject&&(this.dataObject.formattedData={x:[],y:[]})},destroy:function(){this.eventHandler&&(clearTimeout(this.eventHandler.mouseouttimer),clearTimeout(this.eventHandler.mousemovetimer),clearTimeout(this.eventHandler.tooltipElement.timeout),this.eventHandler.tooltipElement.destroy()),this.container.datum(null),this.d3container.remove(),this.destroying=!0},redraw:function(){var systemConfig=this.systemConf;this.updating=!0,this.phase="redraw",this.svg.styles({width:this.getChartDimension("width")+PX,height:this.getChartDimension("height")+PX}),this.staticPaneSVG.styles({width:this.getChartDimension("width")+PX,height:this.getChartDimension("height")+PX}),this.resetdata(systemConfig),VizLayout.helpers.constructChartGroups(this),this.render(!0)},drawPlotBorder:function(){var borderConfig=this.systemConf.chart.plot.border,borderElement=this.container.selectAll("g.plotareaBorder-property");if(defined(borderConfig)&&!0===borderConfig.show){var borderEle=borderElement.selectAll("path.plotBorderPath"),borderSize=validateValWithinLimit(borderConfig,"size",0,10,this.plotarea.width,this.plotarea.height),tickArea=pick(this.tickarea,{left:0,right:0,top:0,bottom:0}),rectAttr=roundedRect(-tickArea.left||.5,-tickArea.top||.5,this.plotarea.width+tickArea.right+tickArea.left,this.plotarea.height+tickArea.bottom+tickArea.top,getBorderRadius(borderConfig.radius),!1,!1);borderSize=null==borderSize||""===borderSize?2:borderSize,borderEle.styles({"stroke-width":borderSize,stroke:borderConfig.color,"stroke-dasharray":getDashArray(borderConfig.style,borderSize),fill:NONE,"pointer-events":NONE}).attrs({d:rectAttr}),borderElement.selectAll("line").style("stroke",TRANSPARENT)}},handleNoData:function(data,ele){this.clearChart();var systemConfig=this.systemConf,nodatawrap=pick(ele,this.wrap.selectAll("g.nodatahandler"));if(defined(data.htmlEl)){var customHandler=appendEle(this.container.selectAll("div.canvas-component"),"div",[1],".","class","nodatahandler");customHandler.style("position","absolute").html(data.htmlEl);var node=customHandler.node();customHandler.styles({left:pick(data.x,(this.chartWidth-node.offsetWidth)/2)+"px",top:pick(data.y,(this.chartHeight-node.offsetHeight)/2)+"px"})}else if(defined(data.imageUrl)){appendEle(nodatawrap,"image",[1]).attrs({x:data.x||this.chartarea.width/2-50,y:data.y||this.chartarea.height/2-50,width:100,height:100,"xlink:href":data.imageUrl})}else if(defined(data.text)){var text=appendEle(nodatawrap,"text",[data],".","class","nodata");text.attrs({x:data.x||this.chartarea.width/2,y:data.y||this.chartarea.height/2,"text-anchor":"middle"}).text(decodeHTML(data.text||"No Data")),applyFont(text,[data,systemConfig.canvas,$ZCG])}},clearNoData:function(data,ele){this.systemConf;var nodatawrap=pick(ele,this.wrap.selectAll("g.nodatahandler"));if(defined(data.htmlEl))appendEle(this.container.selectAll("div.canvas-component"),"div",[],".","class","nodatahandler");else if(defined(data.imageUrl))appendEle(nodatawrap,"image",[]);else if(defined(data.text))appendEle(nodatawrap,"text",[],".","class","nodata")},clearChart:function(data,ele,keepChartGroup){keepChartGroup||appendEle(this.wrap,"g",[],".","class","chartgroup"),appendEle(this.staticPaneSVG,"g",[],".","class","plotareaBorder-property"),appendEle(this.staticPaneSVG,"g",[],".","class","labelClippathholder"),appendEle(this.container,"div",[],".","class","legendgroup"),appendEle(this.staticPaneSVG,"g",[],".","class","legendarea"),appendEle(this.container,"div",[],".","class","zcnotes"),appendEle(this.container,"canvas",[],".","class","zc-canvas"),appendEle(this.container,"canvas",[],".","class","zc-labelholder-canvas"),this.eventHandler&&(this.xymultiRenderer||this.dataObject.isPolarAxisCategory||this.isGeoMap)&&drawBorderBox(this.eventHandler.trackerElement,{width:0,height:0})},showLoading:function(container){var systemConfig=this.systemConf,data=systemConfig.loader;if(!0===data.enabled&&data.type!==NONE){var loader=appendEle(this.container.selectAll("div.d3container"),"div",[1],".","class","loading");loader.style("position","absolute").html(VizLayout.helpers.getLoader(this,data)),applyFont(loader,[data,systemConfig.chart,systemConfig.canvas,$ZCG],!0);var node=loader.node();loader.styles({left:this.chartarea.width/2-node.offsetWidth/2+"px",top:this.chartarea.height/2-node.offsetHeight/2+"px"})}},hideLoading:function(){this.container.selectAll("div.loading").remove()},fixLegendPosition:function(){var legendArea=this.legendarea;if(!0===this.systemConf.legend.enabled){var pos=getLegendPosition(this.plotarea,this,!1),isContinuousLegend=legend_helpers.isContinousLegend(this);if("y"===legendArea.adjust)if(isContinuousLegend){var translate=getSvgTransform(legendArea.element.node()).translate;legendArea.element.attr("transform","translate("+translate[0]+","+pos[1]+")")}else legendArea.element.style("top",pos[1]+PX)}},createEventGroups:function(update){var systemConfig=this.systemConf,eventgroup=this.eventWrap=this.staticPaneSVG.selectAll("g.eventgroup").styles({"pointer-events":"visible"});eventgroup.append("g").attr("id","zcareaCliphighlight").append("g").attr("id","zcareahighlight"),eventgroup.append("g").attr("id","zcbarCliphighlight").append("g").attr("id","zcbarhighlight");if(systemConfig.tooltip.crosshair){var crosshairEle=appendEle(eventgroup,"g",[1],".","class","crosshair");crosshairEle.style("visibility","hidden"),appendEle(crosshairEle,"line",[1],".","class","x-crosshair"),appendEle(crosshairEle,"line",[1],".","class","y-crosshair")}eventgroup.append("g").attr("id","zcscatterCliphighlight").append("g").attr("id","zcscatterhighlight"),eventgroup.append("g").attr("class","zcplothighlight").styles({opacity:0,"pointer-events":NONE});this.dataObject.isHierarchy&&eventgroup.append("g").attr("id","zchierarchyhighlight").styles({opacity:0,fill:NONE,"pointer-events":NONE})}};extend(VizLayout.prototype,chartBasicHelpers),VizLayout.helpers={initializeChartHolders:function(chart){var width_style,height_style,container=chart.container,d3container=container.selectAll("div.d3container");if(!d3container.empty()){var prevChartObj=d3container.datum();prevChartObj&&prevChartObj.destroy&&prevChartObj.destroy(),d3container.remove()}width_style=chart.getChartDimension("width"),height_style=chart.getChartDimension("height"),d3container=chart.d3container=appendEle(container,"div",[chart],".","class","d3container");var styles={width:width_style+"px",height:height_style+"px",position:"relative",left:"0px",top:"0px","box-sizing":"border-box","-moz-user-select":NONE,"-webkit-user-select":NONE,"-ms-user-select":NONE,"user-select":NONE};styles[$Browser.prefix.css+"box-sizing"]="border-box",d3container.styles(styles),appendEle(d3container,"div",[1],".","class","canvas-property"),appendEle(d3container,"div",[1],".","class","plotarea-property"),appendEle(d3container,"div",[1],".","class","zcoverview");var canvas=appendEle(d3container,"div",[1],".","class","canvas-component");canvas.style("-webkit-tap-highlight-color",TRANSPARENT);var tooltipElement=appendEle(chart.getBaseContainer(),"div",[1],"#","id","zctooltip"+chart.idNumeric);tooltipElement.node().isTooltipContainer=!0,chart.tooltip={element:tooltipElement},chart.tooltip.element.styles({position:"fixed",display:"inline-block",visibility:"hidden","white-space":"nowrap","background-color":"white",border:"1px solid","-webkit-tap-highlight-color":TRANSPARENT});var SVGposition=VizLayout.helpers.positionSVG(chart);chart.svg=appendEle(canvas,"svg",[1],".","class","svgarea",SVGposition),chart.staticPaneSVG=appendEle(canvas,"svg",[chart],".","class","static",SVGposition).style("pointer-events",NONE),chart.legendarea.element=canvas.append("div").attr("class","legendarea"),chart.notes=canvas.append("div").attr("class","zcnotes")},removeChartHolders:function(chart){var container=chart.container;container.select("div.d3container").remove(),container.select("div.zc-staticPane").remove(),container.select("div.zc-chartPane").remove()},align:function(hAlign,vAlign,box,margin){var attr={};return"center"===hAlign?(attr.x=box.width/2+margin.left,attr.textAnchor="middle"):"left"===hAlign?(attr.x=box.left+margin.left,attr.textAnchor="start"):"right"===hAlign&&(attr.x=box.width+box.left-margin.right,attr.textAnchor="end"),"top"===vAlign?(attr.y=box.top+margin.top,attr.dy=1):"bottom"===vAlign&&(attr.y=box.height+box.top-margin.bottom,attr.dy=-.21),attr},getLoader:function(chart,data){var htmlEl=data.htmlEl,imageUrl=data.imageUrl,type=data.type,text=data.text,colors=data.colors;if(htmlEl)return htmlEl;if(imageUrl)return"<img src="+imageUrl+" height="+data.imageHeight+" width="+data.imageWidth+">";var html="",ele=null;if(type){var loaderDiv=chart.container.selectAll("div.loading");colors=colors&&colors.length?colors:null,ele=ZCloader(loaderDiv,{type:type,colors:colors}),html=(new XMLSerializer).serializeToString(ele)}return text&&(html+="<p style=position:relative;display:inline-block>"+text+"</p>"),html},constructChartGroups:function(chart){var wrap,svg=chart.svg,systemConfig=chart.systemConf,chartHeight=chart.chartHeight;chart.chartWidth;if(appendEle(svg,"g",groupdata(!0===systemConfig.canvas.title.show&&dimension_based_intelligence(chart,"title",chartHeight)),".","class","charttitle"),appendEle(svg,"g",groupdata(!0===systemConfig.canvas.subtitle.show&&dimension_based_intelligence(chart,"subtitle",chartHeight)),".","class","chartsubtitle"),appendEle(svg,"g",groupdata(systemConfig.credits&&!0===systemConfig.credits.enabled&&dimension_based_intelligence(chart,"credits",chartHeight)),".","class","chartcredits"),wrap=chart.isGeoMap&&chart.geo.isCanvasMode&&chart.dataObject.hasPointChart?chart.wrap=createElement("g",".xychart",[1],chart.staticPaneSVG,":first-child"):chart.wrap=appendEle(svg,"g",[1],".","class","xychart"),chart.nochartdata)appendEle(wrap,"g",[1],".","class","nodatahandler");else{appendEle(wrap,"g",[0],".","class","nodatahandler");var chartgroup=appendEle(wrap,"g",[chart.seriesdata],".","class","chartgroup");appendEle(chartgroup,"g",groupdata(!0===systemConfig.chart.axes.xaxis.show),".","class","x-axis"),appendEle(chartgroup,"g",[chart.seriesdata],".","class","y-axis"),appendEle(chartgroup,"g",[chart.seriesdata],".","class","threshold");var seriesgroup=appendEle(appendEle(chartgroup,"g",[chart.seriesdata],".","class","seriesClippathholder"),"g",[chart.seriesdata],".","class","seriesholder");chart.filterEffectsID=function(chartObj){var systemconf=chartObj.systemConf,effectName=systemconf.chart.effects.choice;if(effects.svg_filters[effectName]){var properties=systemconf.chart.effects.options[effectName];return"dropShadow"===effectName&&(properties.blur=mathMax(0,properties.blur)),effects.get(effects.svg_filters,effectName,properties,{chartObj:chartObj})}}(chart),seriesgroup.attr("filter",chart.filterEffectsID?"url("+chart.defsLocation+"#"+chart.filterEffectsID+")":null);var labelClipgroup=appendEle(chart.staticPaneSVG,"g",[chart.seriesdata],".","class","labelClippathholder"),onlyBarChart=!1;if(chart.dataObject&&(onlyBarChart=chart.dataObject&&chart.dataObject.noofBarEnabledSeries&&!chart.dataObject.isCombinationalChart||chart.dataObject.isHierarchy),onlyBarChart||appendEle(labelClipgroup,"g",[chart.seriesdata],".","class","labelholder"),appendEle(chart.staticPaneSVG,"g",[chart.seriesdata],".","class","threshold"),appendEle(appendEle(chart.staticPaneSVG,"g",[1],".","class","plotareaBorder-property"),"path",groupdata(!0===systemConfig.chart.plot.border.show),".","class","plotBorderPath"),appendEle(chart.staticPaneSVG,"g",[1],".","class","eventgroup"),onlyBarChart)labelClipgroup.raise(),appendEle(labelClipgroup,"g",[chart.seriesdata],".","class","labelholder").style("pointer-events",NONE);appendEle(seriesgroup,"rect",[1],".","class","dummy-rect-filter").style("pointer-events",NONE),VizLayout.helpers.createLegendArea(chart)}function groupdata(show){return show?[1]:[]}},handleErrors:function(chart,err){chart.breakOnErr=!0,isObjectPropDefined(chart.systemConf,"canvas.events")&&invokeFunction(chart.systemConf.canvas.events.onerror,d3$1.event,chart,err)},positionSVG:function(chart){return{width:chart.getChartDimension("width")+PX,height:chart.getChartDimension("height")+PX,position:"absolute",top:0,left:0}},createLegendArea:function(chart){var isContinousLegend=legend_helpers.isContinousLegend(chart),legendarea=(chart.staticPaneSVG,chart.container.selectAll("div.canvas-component"),appendEle(chart.staticPaneSVG,"g",isContinousLegend?[1]:[],".","class","legendarea"));isContinousLegend&&(chart.legendarea.element=legendarea)},getChartId:function(chart){return chart.id},setChartId:function(chart){chart.id}};var _hierarchymodel={};function getChildrenCount(dt,count){return count||(count=0),dt.forEach(function(d){isArray(d[0])?count=getChildrenCount(d,count):count++}),count}_hierarchymodel.get=function(chartObj){var data=chartObj.systemConf,dataset=chartObj.dataset,processedseriesData=chartObj.seriesdata,dataProcessorHelpers=DataProcessor.helpers,model={data:data};return model.getTransRectValue=function(param,d,i,j,cp,radius,yrangePos){switch(param){case"radius":var parsedVal={},splittedStr=null!=radius?radius.toString().split("/"):null,rx=null!=splittedStr&&null!=splittedStr[0]?splittedStr[0].split(" "):[],ry=null!=splittedStr&&null!=splittedStr[1]?splittedStr[1].split(" "):rx;return parsedVal.tlx=pInt(priorityBasedValue([rx[0]])),parsedVal.tly=pInt(priorityBasedValue([ry[0],rx[0]])),parsedVal.trx=pInt(priorityBasedValue([rx[1],rx[0]])),parsedVal.trY=pInt(priorityBasedValue([ry[1],ry[0],rx[1],rx[0]])),parsedVal.brx=pInt(priorityBasedValue([rx[2],rx[0]])),parsedVal.bry=pInt(priorityBasedValue([ry[2],ry[0],rx[2],rx[0]])),parsedVal.blx=pInt(priorityBasedValue([rx[3],rx[1],rx[0]])),parsedVal.bly=pInt(priorityBasedValue([ry[3],ry[1],rx[3],rx[0]])),parsedVal}},model.getAxisRotated=function(){var axes=model.data.chart.axes;return axes&&!0===axes.rotated},model.containsNegativeData=function(){return!1},model.isstacked=function(){return!1},model.getPlotBorder=function(){var plotBorderOptions=data.chart.plot.border,borderSize=!0===plotBorderOptions.show?validateValWithinLimit(plotBorderOptions,"size",0,10,chartObj.plotarea.width,chartObj.plotarea.height):0;return borderSize={left:borderSize,top:borderSize,right:borderSize,bottom:borderSize}},model.initialize=function(state){var globalChartType=data.seriesdata&&data.seriesdata.type;dataset.seriesTypes=d3_set(),model.totalnoofdatas=0,model.isNonAxisMultiSeriesCategory=!0,model.isHierarchy=!0,model.seriesExtermes=[[]],null!=processedseriesData&&isArray(processedseriesData)&&("addorremoveseries"!=state&&(chartObj.seriesdata=processedseriesData=function dataToArray(obj){return obj.map(function(d){var arr;if(d.data&&d.data[0]&&isArray(d.data[0])){arr=d.data;var leafColors=d.leafColors;leafColors&&arr.forEach(function(d,i){d.color=leafColors[i%leafColors.length]})}else d.data?(model.hasHierarchyData=!0,arr=dataToArray(d.data)):arr=d;for(var attr in d)d.hasOwnProperty(attr)&&"data"!==attr&&(arr[attr]=d[attr]);return arr})}(processedseriesData)),function processHierachyData(parent){parent.forEach(function(d,i){if(d.level=null!=parent.level?parent.level+"_"+i:i+"",isArray(d[0]))processHierachyData(d);else{var seriesIndex=+d.level.split("_")[0],currentdata=data.seriesdata.chartdata[seriesIndex],yaxiscolumnorder=dataProcessorHelpers.getParsedYAxisOrder(currentdata.yaxiscolumnorder);if(!currentdata.disabled){var yExtremes=d3_extent([d],function(d){return dataset.getY(d,yaxiscolumnorder)});model.seriesExtermes[0].push(yExtremes),model.totalnoofdatas++}}})}(processedseriesData),processedseriesData.forEach(function(d,i){var cType=dataProcessorHelpers.getChartType(d.type||globalChartType,NUMERIC_DATATYPE);dataset.seriesTypes.add(cType)}))},model.initialize(),model};var DATALABELS_LABELTYPE="datalabels",STACKLABELS_LABELTYPE="stackLabels",INNERLABEL_LABELTYPE="innerLabel",PARENTLABELS_LABELTYPE="parentLabels";function getFormattedValue(colInfo,value,dataType,chartObj,type,toDecode,arraySeperator,levelIndex){if(!dataType)return encodeOrDecode(value);if(null==value)return colInfo&&null!=colInfo.nullformatting?encodeOrDecode(invokeFunction(colInfo.nullformatting,value,dataType,colInfo,type,chartObj)):value;var format=colInfo?colInfo[type+"format"]||colInfo.format:null;return format&&Object.keys(format).length||(format=getDefaultFormat(dataType,colInfo)),value.constructor==Array?value.map(function(d){return applyFormat(d)}).join(defined(format.arraySeperator)?format.arraySeperator:arraySeperator):applyFormat(value);function applyFormat(value){return dataType!==TIME_DATATYPE||format.customFormat?dataType===NUMERIC_DATATYPE&&("axis"===type||type===STACKLABELS_LABELTYPE||type===DATALABELS_LABELTYPE&&chartObj.dataObject.isHierarchy)&&"number"==typeof value&&countDecimals(value)>12&&(value=parseFloat(value.toFixed(12))):value=generateDateVal(value,format,colInfo),levelIndex&&format.customFormat&&((colInfo=simpleClone(colInfo)).levelindex=levelIndex),encodeOrDecode("function"==typeof format?format(value,dataType,colInfo):format.customFormat?invokeFunction(format.customFormat,value,dataType,colInfo,type,chartObj):generateFormatSpecifier(format,value,colInfo,dataType,levelIndex,type,chartObj))}function encodeOrDecode(val){return 0!=toDecode?decodeHTML(val):encodeHTML(val)}}function getDefaultFormat(type,colInfo){var defaultFormat={};switch(type){case"time":colInfo&&colInfo.groupby?defaultFormat={}:colInfo&&colInfo.subfunction?defaultFormat=getTimeSubfunctionFormatter(colInfo.subfunction,colInfo.useUTC):defaultFormat.specifier="YYYY";break;case"numeric":defaultFormat.thousandSeperator=",";break;case"geo":break;case"percent":defaultFormat.decimalPlaces=1,defaultFormat.suffix="%",defaultFormat.trailingZeros=!1}return defaultFormat}function generateFormatSpecifier(format,value,colInfo,dataType,levelIndex,type,chartObj){var formattedValue;switch(dataType){case"time":var groupOrder,d3Format=colInfo&&!0===colInfo.useUTC?d3_timeFormatUTC:d3_timeFormat,specifier=format.specifier;if(defined(colInfo)&&(groupOrder=isArray(colInfo.groupby)?colInfo.groupby:colInfo.AUTO_GROUP_ORDER),isArray(specifier)||isArray(groupOrder))formattedValue=[],specifier=specifier||[null],defined(levelIndex)&&(specifier=defined(specifier)?[specifier[levelIndex]]:[null]),(specifier=isArray(specifier)?specifier:[specifier]).forEach(function(d,i){var datetimespecifier=generated3TimeSpecifier(d),formatter=generateTimeFormatter(d3Format,datetimespecifier,colInfo,levelIndex);formattedValue[i]=formatter?formatter(value):value}),type==DATALABELS_LABELTYPE&&(formattedValue=formattedValue&&formattedValue.toString());else{var datetimespecifier=generated3TimeSpecifier(specifier);if("auto"===format.specifier||null==datetimespecifier)formattedValue=value;else if(CUSTOM_SPECIFIER_REGEX.test(datetimespecifier)){var formatter=generateTimeFormatter(d3Format,datetimespecifier,colInfo,levelIndex);formattedValue=formatter(value)}else formattedValue=d3Format(datetimespecifier)(value)}break;case"ordinal":var lc=format.letterCase;value+="",formattedValue=lc?"uppercase"===lc?value.toUpperCase():"lowercase"===lc?value.toLowerCase():value[0].toUpperCase()+value.substring(1).toLowerCase():value;break;case"geo":var mapWith=format.mapBy;lc=format.letterCase;if(formattedValue=value,mapWith){var feature=chartObj.dataObject.userMapFeatures.get(value);feature&&feature.properties&&feature.properties[mapWith]&&(formattedValue=feature.properties[mapWith])}formattedValue=lc?"uppercase"===lc?formattedValue.toUpperCase():"lowercase"===lc?formattedValue.toLowerCase():formattedValue[0].toUpperCase()+formattedValue.substring(1).toLowerCase():formattedValue;break;default:if("decimal"==format.type&&pInt(value)!=value)return"";value="decimal"==format.type||0===format.decimalPlaces?parseFloat(value):value;var currency=format.currency,numericspecifier=generated3NumericSpecifier(format,null,value),toRemoveTrailingZeros=!1;if(formattedValue=numericspecifier(value),/(e|s)/gi.test(getd3NumericFormatterType(format))&&(defined(format.decimalPlaces)?formattedValue=formattedValue.replace(/[^a-z]+/i,function(){return generated3NumericSpecifier(format,"."+format.decimalPlaces+"f")(arguments[0])}):toRemoveTrailingZeros=!0),!1===format.signEnabled&&(formattedValue=formattedValue.substring(1,formattedValue.length)),!validateNullVal(format.trailingZeros,!0)||toRemoveTrailingZeros){var unitSuffix="";formattedValue=(formattedValue=formattedValue.replace(/[a-z]+(\+|-)*(\d)*$/i,function(){return unitSuffix=arguments[0],""})).replace(/\.(\d)*0*$/gi,function(){var matchedString=arguments[0];return parseFloat(matchedString)?"."+exponentialToDecimal(+matchedString).toString().split(".")[1]:""})+unitSuffix}formattedValue=function(format,formattedValue){var thSep=format.thousandSeperator,deSep=format.decimalSeperator,split=formattedValue.split(/\./);return(null!=thSep&&","!=thSep?split[0].replace(/,/g,thSep):split[0])+(split[1]?(null!=deSep?deSep:".")+split[1]:"")}(format,formattedValue),null!=currency&&(formattedValue=/(\+|\-)/.test(formattedValue[0])?formattedValue[0]+currency+formattedValue.slice(1):currency+formattedValue)}return dataType!=ORDINAL_DATATYPE&&dataType!=NUMERIC_DATATYPE&&"geo"!==dataType||(formattedValue=(null!=format.prefix?format.prefix:"")+formattedValue+(null!=format.suffix?format.suffix:"")),format.breakSpace&&(formattedValue=formattedValue.split(" ")),formattedValue}function getTimeSubfunctionFormatter(subfunctype,useUTC){var formatter=(useUTC=!0===useUTC)?d3_timeFormatUTC:d3_timeFormat;switch(subfunctype){case"YEAR":case"year":return formatter("%Y");case"MONTH":case"month":return formatter("%B");case"ABSDAY":return formatter("%a");case"DAY":case"day":return formatter("%e");case"WEEKDAY":return formatter("%A");case"WEEK":case"week":return formatter("Week %W");case"ABSHOUR":return formatter("%I");case"ABSSECOND":return formatter("%S");case"ABSMINUTE":case"MINUTE":return formatter("%M");case"MILLISEC":return formatter("%L");case"HOUR":return formatter("%H hrs");case"DATETIME":return formatter("%d %b %Y %H:%M:%S");case"DATE":return formatter("%x");case"TIME":return formatter("%X");case"TIMESTAMP":return formatter("%x %X hrs");case"ABSMONTH":return formatter("%b %Y");case"ABSWEEK":return formatter("W%U %Y");case"ABSQUARTER":return function(d){var year=useUTC?d.getUTCFullYear():d.getFullYear();return formatter("Q"+getQuarter(d,useUTC)+" "+year)};case"QUARTER":return function(d){return formatter("Q"+getQuarter(d,useUTC))};case 100:return formatter("%d %b %Y %H:%M:%S %L");default:throw"UNKNOWN TYPE 111: "+subfunctype}}function generateDateVal(value,format,colInfo,toProcess){var inputformat=colInfo?colInfo.inputformat:null,dateValue=new Date(value.toString()),customFunc="function"==typeof inputformat?inputformat:"function"==typeof window[inputformat]?window[inputformat]:null;if(!(value instanceof Date)&&null!=inputformat&&(customFunc||"timestamp"!=inputformat.toLowerCase())){value=customFunc||typeof value==String?value:value.toString();var formatter=d3_timeParse,parsedVal=customFunc?customFunc(value,colInfo):formatter(generated3TimeSpecifier(inputformat))(value);dateValue=null==parsedVal?dateValue:new Date(parsedVal)}return isNaN(dateValue)&&(dateValue=new Date(+value)),dateValue}function getFormattedValueByPercent(colInfo,value,dataType,chartObj,type){return(colInfo=colInfo||{})[(type=(type&&colInfo[type+"percentformat"]?type:"")+"percent")+"format"]||(colInfo.percentformat=getDefaultFormat("percent")),getFormattedValue(colInfo,value,dataType,chartObj,type)}var timeSpecifiers={YYYY:"%Y",MMMM:"%B",EEEE:"%A",EEE:"%a",MMM:"%b",YY:"%y",MM:"%m",EE:"%U",dd:"%d",HH:"%H",hh:"%I",mm:"%M",ss:"%S",a:"%p",MILLI:"%L",z:"%Z",QT:"$Q"},numericSpecifiers={decimal:"d",exponent:"e",float:"f",binary:"b",octal:"o",hexadecimal:"x",SIprefix:"s"},CUSTOM_SPECIFIER_MAPPER={Q:getQuarter},tempArrayKeys=Object.keys(CUSTOM_SPECIFIER_MAPPER).map(function(key){return"\\$"+key}),CUSTOM_SPECIFIER_REGEX=new RegExp(tempArrayKeys.join("|"));function generated3TimeSpecifier(specifier){if(specifier)for(var spec in timeSpecifiers){var index=specifier.indexOf(spec);index>=0&&"%"!==specifier[index-1]&&(specifier=specifier.replace(new RegExp(spec,"g"),timeSpecifiers[spec]))}return specifier}function generateTimeFormatter(d3TimeFormat,specifier,colInfo,levelIndex){var formatter,d3Format,useUTC;if(specifier)d3Format=d3TimeFormat(specifier),useUTC=colInfo.useUTC,formatter=function(date){for(var c,val=d3Format(date),string=[],i=-1,j=0,n=val.length;++i<n;)36===val.charCodeAt(i)&&(string.push(val.slice(j,i)),c=val.charAt(++i),c=defined(CUSTOM_SPECIFIER_MAPPER[c])?CUSTOM_SPECIFIER_MAPPER[c](date,useUTC):c,string.push(c),j=i+1);return string.push(val.slice(j,i)),string.join("")};else if(colInfo.groupby){var groupOrder=isArray(colInfo.groupby)?colInfo.groupby:colInfo.AUTO_GROUP_ORDER;formatter=getTimeSubfunctionFormatter(0!==levelIndex&&defined(levelIndex)?groupOrder[levelIndex-1]:colInfo.subfunction,colInfo.useUTC)}return formatter}function generated3NumericSpecifier(format,defaultSpecifier,value){var decPlaces,sign=defined(format.signEnabled)?"+":"",zeroPad=null!=format.zeroPadding&&format.zeroPadding.enabled?"0"+format.zeroPadding.digits:"",thousandSep=null!=format.thousandSeperator?",":"",type=getd3NumericFormatterType(format),isScientificFormat=/(e|s)/gi.test(type);return decPlaces=null!=format.decimalPlaces&&format.decimalPlaces>=0?isScientificFormat?$Browser.IE?".20":"":"."+format.decimalPlaces:isScientificFormat?"":"."+countDecimals(value),d3_format(sign+zeroPad+thousandSep+(defaultSpecifier||decPlaces+type))}function getd3NumericFormatterType(format){format.decimalPlaces;var type=format.type;return numericSpecifiers[type]||"f"}function countDecimals(value){return isNaN(value)?0:(value=+value,Math.floor(value)==value?0:exponentialToDecimal(value).toString().split(".")[1].length||0)}function exponentialToDecimal(num){if(/\d+\.?\d*e[+-]*\d+/i.test(num)){var parts=String(num).toLowerCase().split("e"),e=parts.pop(),l=Math.abs(e),sign=e/l,coeff_array=parts[0].split(".");if(-1===sign)num="0."+new Array(l).join("0")+coeff_array.join("");else{var dec=coeff_array[1];dec&&(l-=dec.length),num=coeff_array.join("")+new Array(l+1).join("0")}}return num}function millisecondToAbsoluteTime(ms){var seconds=mathFloor(ms/1e3),minute=mathFloor(seconds/60),hour=mathFloor(minute/60),day=mathFloor(hour/24);return{seconds:seconds,minute:minute,hour:hour,day:day,month:mathFloor(day/30.436854166666667),years:mathFloor(day/365.24225)}}function getAutoTimeSubFunction(milliseconds){var absoluteTime=millisecondToAbsoluteTime(milliseconds);return{subFunction:absoluteTime.years>1?"YEAR":absoluteTime.month>1?"ABSMONTH":absoluteTime.day>1?"ABSDAY":absoluteTime.hour>1?"ABSHOUR":absoluteTime.minute>1?"ABSMINUTE":"ABSSECOND"}}function getQuarter(date,useUTC){return mathFloor((useUTC?date.getUTCMonth():date.getMonth())/3)+1}var bubblepieUtils={};function getStackedTotal(chartObj,seriesPos,d,showAs){var stackGroupIdx=0,rp=chartObj.renderer[seriesPos].commonRendererProp().params,dataset=chartObj.dataset,X=dataset.getX(d),Y=dataset.getY(d,rp.yaxiscolumnorder||0);chartObj.userdata.seriesdata.stackGroup&&(stackGroupIdx=chartObj.dataObject.getStackGroupIndex(seriesPos,chartObj.userdata.seriesdata.stackGroup));var curStackExtent=chartObj.dataObject.groupedByStack.get(stackGroupIdx).stackExtent.filter(function(d){return d[0]===X});return showAs===PERCENT_SHOWAS||showAs===PER_SHOWAS?curStackExtent.reduce(function(prev,cur){return prev+mathAbs(cur[1])},0):curStackExtent[Y<rp.hasNegValue&&curStackExtent[1]?1:0][1]}bubblepieUtils.filterBySum=function(piedata,dataindex){var accessor=function(prev,cur){return prev+(cur.disabled?0:mathAbs(cur[dataindex]||0))};return piedata.filter(function(d){return d.reduce(accessor,0)>0})},bubblepieUtils.getKey=function(d,seriesIndex,chartObj,position){if(!position){var dataset=chartObj.dataset,yaxiscolumnorder=DataProcessor.helpers.getParsedYAxisOrder(chartObj.seriesdata[seriesIndex].yaxiscolumnorder);position=[dataset.getX(d),dataset.getY(d,yaxiscolumnorder)]}return"x("+position[0]+") y("+position[1]+")"};var dataparser=function(){};function getTotal(chartObj,seriespos,subseriespos,colidx,dataPoint,showAs,type){colidx=+colidx;var yaxes=chartObj.systemConf.metadata.axes.y,index=-1,isBubblePie=isMultiPieChartType(chartObj.chartTypes[seriespos].value),stacked=chartObj.dataObject.isstacked(chartObj.chartTypes[seriespos].value);if(stacked&&!chartObj.dataObject.isStackedPercentChart&&!chartObj.dataObject.isPercentChart&&/(datalabels|tooltip)/.test(type))return getStackedTotal(chartObj,seriespos,dataPoint,showAs);if((isArray(yaxes)||chartObj.isGeoMap)&&(isArray(yaxes)&&(isArray(yaxes[0])?yaxes.forEach(function(d,i){index=-1==index&&d.indexOf(colidx)>-1?i:index}):index=yaxes.indexOf(colidx)>-1?0:-1),-1!=index||isBubblePie)){var total;if(isBubblePie){var key=bubblepieUtils.getKey(dataPoint,seriespos,chartObj);total=chartObj.subrenderer[subseriespos||0][key].total}else if(chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory){var yscale=chartObj.axes.y.groups[index].scale;if(showAs!==MAXPER_SHOWAS&&yscale){total=(domain=yscale.domain())[1]}else{var domain=chartObj.dataObject.ZC_BAR_getRangeY(chartObj,index);domain=chartObj.dataObject.isStackedPercentChart||stacked||chartObj.dataObject.isPercentChart?domain[index]:domain,total=chartObj.dataset.getY(dataPoint,index)<0?-domain[0]:domain[1]}}else if(chartObj.isNonAxisMultiSeriesCategory){var renderer=chartObj.renderer[0];if(showAs===PER_SHOWAS)return renderer.total;if(renderer.extentY)return renderer.extentY[1];var getProcessedNodeFunc=renderer.getProcessedNode;total=(getProcessedNodeFunc?getProcessedNodeFunc(dataPoint):dataPoint).parent.value}else if("legend"===type){var curSeriesData=chartObj.seriesdata[0],yDataIndex=chartObj.dataset.yidx(DataProcessor.helpers.getParsedYAxisOrder(curSeriesData.yaxiscolumnorder));total=curSeriesData.data[0].reduce(function(prev,cur){return prev+(cur.disabled?0:mathAbs(cur[yDataIndex]||0))},0)}else total=chartObj.renderer[0].total;return total||0===total?total:null}return null}function PreProcessor(chart){this.chart=chart,this.data=chart.systemConf,this.initialize()}function getAnimationConf(commonPlotOptions,plotoptions,chartObj,cType){var animationOptions=plotoptions&&plotoptions.animation?mergeJSON(commonPlotOptions.animation,plotoptions.animation,!0):commonPlotOptions.animation,globalAnimation=chartObj.systemConf.chart.plot.animation,obj={},easingType=animationOptions.easingType||globalAnimation.easingType||(/(scatter|bubble$|packedbubble|heatmap)/.test(cType)?"cubic-in-out":null)||"linear";return isDocumentVisible()||chartObj.isHiddenCoainer?obj.enabled=!1:obj.enabled=!!datacount_based_intelligence(chartObj,"animation")&&getValByPriority([animationOptions,globalAnimation],"enabled"),obj.type=animationOptions.type,obj.easingType=d3_ease(easingType),obj.duration=obj.enabled?validateNullVal(animationOptions.duration,+(globalAnimation.duration||(/(bar|bullet|gantt|waterfall)/.test(cType)?300:/(line|area|arearange)/.test(cType)?600:/(scatter|bubble$|funnel|pyramid|heatmap)/.test(cType)?1e3:500))):0,obj}function interTween(baseData,basedataShift,serData,categories,animationType,easingType,transitionDuration,rp,layout,eleEnter,chartName){var isPointTween=animationType==POINTTWEEN_ANIMATION,dataset=rp.dataset,yaxiscolumnorder=rp.yaxiscolumnorder,count=isPointTween?0:-1,len=serData.length,duration=mathRound(transitionDuration/(isPointTween?categories.length-1:len));!function tween(){count++;if(isPointTween)for(var j=0;j<len;j++)baseData[j]=serData[j<count?j:mathMax(0,count-1)],basedataShift[j]=serData[j<count?j:count];else baseData[count-1]=serData[count-1],basedataShift[count]=serData[count];if(count<len){var del=1==count&&isPointTween?(categories.indexOf(dataset.getX(serData[0]))-(count-1))*duration:0,dur=(isPointTween?categories.indexOf(dataset.getX(serData[count]))-categories.indexOf(dataset.getX(serData[count-1])):1)*duration,notNull=isPointTween?null!=dataset.getY(serData[count],yaxiscolumnorder)&&null!=dataset.getY(serData[mathMax(0,count-1)],yaxiscolumnorder):null!=dataset.getY(serData[count],yaxiscolumnorder);notNull?eleEnter.attrs(layout(baseData)).transition().delay(del).duration(dur).ease(easingType).attrs(layout(basedataShift)).on("end",chartName===SCATTER_CHARTNAME?function(d,j){j==len-1&&tween()}:tween):tween()}}()}function flipTween(element){var rad=d3_interpolate(0,mathPI);element.attrTween("transform",function(){var transform=d3_select(this).attr("transform");return function(t){return transform+" matrix("+mathCos(rad(t))+",0,0,1,0,0)"}})}function fadeTween(element){var opacity=d3_interpolate(0,1);element.styleTween("opacity",function(){return function(t){return opacity(t)}})}function scaleTween(element){var scaleObj=d3_interpolate(0,1);element.attrTween("transform",function(){var transform=d3_select(this).attr("transform")||"";return function(t){return transform+" scale("+scaleObj(t)+")"}})}function cancelAnimation(element){element.interrupt()}dataparser.get=function(data,chartObj){var newaxes,metadata=data.metadata,columns=metadata.columns,axes=metadata.axes,seriesdata=data.seriesdata.chartdata,getParsedYAxisOrder=DataProcessor.helpers.getParsedYAxisOrder;newaxes={},Object.keys(axes).sort(function(a,b){return b.length>a.length?-1:b.length<a.length?1:0}).forEach(function(d){newaxes[d]=axes[d]});var dataObject,columnInfo_clr=columns[(axes=newaxes).clr]||{},colTypeOrder=columns.map(function(d,i){return function(colidx){var order=[];for(var type in axes)if(axes.hasOwnProperty(type)){var val="y"==type?d3_merge(axes[type]):axes[type];if(-1!=val.indexOf(colidx))return"y"==type&&axes[type].map(function(d,i){var index=d.indexOf(colidx);-1!=index&&(order.push(i),order.push(index))}),{type:type,order:order}}}(i)}),dataset={xidx:columns[axes.x].dataindex,yidx:function(order){var columnidx=order instanceof Array?axes.y[order[0]][order[1]||0]:axes.y[order][0];return columns[columnidx].dataindex},zidx:(columns[axes.z]||{}).dataindex,tooltipidx:function(index){return null!=axes.tooltip?columns[index].dataindex:null},clridx:columnInfo_clr.levelindex?null:columnInfo_clr.dataindex};return dataset.setDataObj=function(obj){dataObject=obj},dataset.getX=function(d){return defined(dataObject)&&(dataObject.hierarchical&&!dataObject.hierarchical.groupByTime||dataObject.isWaterfallEnabled)?d.index:this.getActualX(d)},dataset.getY=function(d,yaxiscolumnorder,range){try{var curYidx=this.yidx(yaxiscolumnorder);return void 0===d[curYidx]?null:null==range?d[curYidx]:d[curYidx][range]}catch(err){}},dataset.getZ=function(d){return d[this.zidx]},dataset.getClr=function(d){return d[this.clridx]},dataset.getGroupByValues=function(d,indices){return null==indices||0==indices.length?null:indices.reduce(function(prev,cur,i){return defined(d[cur])?prev+d[cur]:prev},"")},dataset.getActualX=function(d){return d[this.xidx]},dataset.getDataType=function(type,index,seriestypes){if(seriestypes=seriestypes||dataset.seriesTypes.values().map(function(d){return+d}),"x"===type&&index>0)return"ordinalNonLinear";var datatype=null;if(null!=metadata.axes[type]){var columnidx=this.getColumnIdx(type,index),columnInfo=columns[columnidx];datatype=columnInfo.datatype;var ordinalType="x"==type&&(dataObject&&dataObject.isPolarAxisCategory||-1!=seriestypes.indexOf(charttype.bar)||-1!=seriestypes.indexOf(charttype.stkdbar)||-1!=seriestypes.indexOf(charttype.bullet)||-1!=seriestypes.indexOf(charttype.gantt)||-1!=seriestypes.indexOf(charttype.web)),isHeatmap=-1!=seriestypes.indexOf(charttype.heatmap)&&("x"===type||"y"===type);datatype=ordinalType||columnInfo.useDiscrete||isHeatmap?ORDINAL_DATATYPE:datatype}return datatype},dataset.getColumnIdx=function(type,order){var columnidx,axes=metadata.axes[type];return"y"==type?columnidx=order instanceof Array&&2==order.length?axes[order[0]][order[1]]:axes[order][0]:"tooltip"==type?columnidx=axes[order]:"x"==type&&order>0?(metadata.columns.filter(function(d,i){d.levelindex==order&&(columnidx=i)}),columnidx=columnidx||axes[0]):columnidx=null==axes?null:axes[0],columnidx},dataset.getColumn=function(type,yaxiscolumnorder){var columnidx=this.getColumnIdx(type,yaxiscolumnorder);return columns[columnidx]},dataset.getColumnName=function(colidx,toDecode){return(0!=toDecode?decodeHTML:encodeHTML)(columns[colidx].columnname)},dataset.getCustomizedVal=function(chartObj,colidx,seriespos,subseriespos,itempos,d,type,color,toDecode,subseriesLength){return isUndefined(toDecode)&&(toDecode=!/(tooltip|legend)/.test(type)),colidx.toString().replace(CUSTOM_VALUE_PATTERN,function(){var matchedString=arguments[0],valIndex=arguments[1],colIndex=arguments[2],perIndex=arguments[3],splitPerIndex=arguments[4],maxPerIndex=arguments[5],idx=valIndex||colIndex||perIndex||splitPerIndex||maxPerIndex;if(-1!=matchedString.indexOf("{{clr}}"))return color;if(null==columns[idx])return matchedString;var dataPoint=type===STACKLABELS_LABELTYPE?d:dataset.getDataPoint(chartObj,idx,seriespos,subseriespos,itempos,d);if(null==dataPoint)return"";var operation=matchedString.match(/[a-z]+/gi)[0];switch(operation){case"col":return dataset.getColumnName(colIndex,toDecode);case"val":var val=dataset.getDataPointValue(chartObj,dataPoint,valIndex,seriespos,!1,type,subseriespos,toDecode,subseriesLength);return[DATALABELS_LABELTYPE,STACKLABELS_LABELTYPE,INNERLABEL_LABELTYPE,PARENTLABELS_LABELTYPE].indexOf(type)>-1&&(val=val||""),val;case PER_SHOWAS:case"splitper":case MAXPER_SHOWAS:return dataset.getDataPointValue(chartObj,dataPoint,perIndex||splitPerIndex||maxPerIndex,seriespos,operation,type,subseriespos,toDecode,subseriesLength)}})},dataset.getYaxisColumnIndexBySeriesIndex=function(chartObj,seriesIndex){var yaxiscolumnorder=seriesdata[seriesIndex].yaxiscolumnorder||[0,0];return isArray(yaxiscolumnorder)?axes.y[yaxiscolumnorder[0]][yaxiscolumnorder[1]||0]:axes.y[yaxiscolumnorder][0]},dataset.getDataPoint=function(chartObj,colidx,seriespos,subseriespos,itempos,d){var dataPoint=null,colInfo=columns[colidx=+colidx]||{},curSeriesPos=seriespos,hierarchyCondition=!0;if("y"===(colTypeOrder[colidx]&&colTypeOrder[colidx].type)&&this.getYaxisColumnIndexBySeriesIndex(chartObj,seriespos)!==colidx)return dataPoint;if(chartObj.dataObject.isHierarchy){var getProcessedNodeFunc=chartObj.renderer[0].getProcessedNode,node=getProcessedNodeFunc?getProcessedNodeFunc(d):d;hierarchyCondition=axes.clr&&axes.clr[0]===colidx&&1===node.depth||-1!==chartObj.systemConf.metadata.axes.y[0].indexOf(colidx)||node.children&&(colInfo.levelindex===node.depth-1||isArray(colInfo.levelindex)&&-1!==colInfo.levelindex.indexOf(node.depth-1))||!node.children&&(null==colInfo.levelindex||null!=colInfo.dataindex)}if(null!=curSeriesPos&&hierarchyCondition){var renderer=chartObj.renderer[chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory?curSeriesPos:0],seriesdataAfterUpdate=null!=renderer&&null!=renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[subseriespos]:seriesdata[curSeriesPos].data[subseriespos];dataPoint=d||seriesdataAfterUpdate[itempos]}return dataPoint},dataset.getDataPointValue=function(chartObj,dataPoint,colidx,seriespos,percent,type,subseriespos,toDecode,subseriesLength){null!=colidx&&(colidx=+colidx),isUndefined(toDecode)&&(toDecode=!/(tooltip|legend)/.test(type));var node,colInfo=columns[colidx]||{},datatype=colInfo.datatype,levelindex=colInfo.levelindex,dataindex=colInfo.dataindex,format=colInfo[datatype];if(null!=dataPoint){if(chartObj.dataObject.isHierarchy){var renderer=chartObj.renderer[0],getProcessedNodeFunc=renderer&&renderer.getProcessedNode;node=getProcessedNodeFunc?getProcessedNodeFunc(dataPoint):dataPoint}if(null==axes.clr&&"legend"!==type||colidx!=axes.clr||chartObj.dataObject.isHierarchy&&"legend"!==type&&null!=colInfo.dataindex){if(chartObj.dataObject.isHierarchy&&(levelindex===node.depth-1||isArray(levelindex)&&-1!==levelindex.indexOf(node.depth-1)))return getFormattedValue(format,node.children||null==colInfo.dataindex?dataPoint.seriesname:dataPoint[dataindex],datatype,chartObj,type,toDecode);if(null!=levelindex&&chartObj.dataObject.hierarchical){var parentData=chartObj.dataObject.hierarchical.getParentByIndex(dataPoint.index,levelindex-1);return parentData&&parentData.value?getFormattedValue(format,parentData.value,datatype,chartObj,type,toDecode):""}arraySeperator=colidx==this.getColumnIdx("y",getParsedYAxisOrder(chartObj.seriesdata[seriespos].yaxiscolumnorder))?" - ":void 0;var value,formatFn=percent?getFormattedValueByPercent:getFormattedValue;if(subseriesLength){for(var cumval=0,j=0;j<subseriesLength;j++)cumval+=dataset.getDataPointUnformattedValue(datatype,seriespos,j,colidx,dataPoint,type,percent,dataindex);value=cumval}else value=dataset.getDataPointUnformattedValue(datatype,seriespos,subseriespos,colidx,dataPoint,type,percent,dataindex);return""==value&&percent?value:formatFn(format,value,datatype,chartObj,type,toDecode,arraySeperator)}var arraySeperator;return defined(this.clridx)&&colorscale_helpers.isQuantileColorScale(chartObj)?"legend"===type?getFormattedValue(format,dataPoint,datatype,chartObj,type,toDecode,arraySeperator="-"):getFormattedValue(format,this.getClr(dataPoint),datatype,chartObj,type,toDecode):getFormattedValue(format,seriesdata[seriespos].seriesname,datatype,chartObj,type,toDecode)}return null},dataset.getDataPointUnformattedValue=function(datatype,seriespos,subseriespos,colidx,dataPoint,type,percent,dataindex){if(chartObj.dataObject.isHierarchy)var renderer=chartObj.renderer[0],getProcessedNodeFunc=renderer&&renderer.getProcessedNode,node=getProcessedNodeFunc?getProcessedNodeFunc(dataPoint):dataPoint;if(percent){var total=datatype==NUMERIC_DATATYPE?getTotal(chartObj,seriespos,subseriespos,colidx,dataPoint,percent,type):null;return null!=total?(type==STACKLABELS_LABELTYPE?dataPoint:chartObj.dataObject.isHierarchy&&node.children&&defined(node.value)?node.value:chartObj.dataObject.isStackedPercentChart||chartObj.dataObject.isPercentChart?dataPoint.y:dataPoint[dataindex])/total*100||0:""}var yidx=this.getColumnIdx("y",getParsedYAxisOrder(chartObj.seriesdata[seriespos].yaxiscolumnorder));return chartObj.dataObject.isHierarchy&&node.children&&colidx==yidx&&defined(node.value)?node.value:type==STACKLABELS_LABELTYPE?dataPoint:dataPoint[dataindex]},dataset.getMetaInfoObj=function(chartObj,data,seriespos){var axes=chartObj.systemConf.metadata.axes,columns=chartObj.systemConf.metadata.columns,seriesdata=chartObj.systemConf.seriesdata.chartdata,dataWithMetadata=[],yindex=seriesdata[seriespos=chartObj.isAxisCategory||chartObj.isNonAxisMultiSeriesCategory?seriespos:0].yaxiscolumnorder||[0,0],yColIdx=yindex instanceof Array?axes.y[yindex[0]][yindex[1]||0]:axes.y[yindex][0];if(data instanceof Array&&data.forEach(function(d,i){var colidx=columns.indexOf(columns.filter(function(c,j){return c.dataindex==i&&(dataset.yidx(yindex)!=i||dataset.yidx(yindex)==i&&yColIdx==j)})[0]);dataWithMetadata.push(getColObj(colidx,d))}),null!=axes.clr){var clrColIdx=axes.clr instanceof Array?axes.clr[0]:axes.clr;dataWithMetadata.push(getColObj(clrColIdx,seriesdata[seriespos].seriesname))}return dataWithMetadata;function getColObj(colidx,value){var obj=simpleClone(columns[colidx]||{});return obj.value=value,obj.columnindex=colidx,obj}},dataset.processMetaData=function(){var legendIndex=getPropVal(metadata,"axes.clr");defined(legendIndex)&&(legendIndex=legendIndex[0]),columns.forEach(function(metadata,i){var type;if(i!==legendIndex){if(!defined(metadata.datatype)){var data=dataset.getDataByColumnIndex(metadata.dataindex);type=dataset.findDataType(data),metadata.datatype=type}defined(type)&&!defined(metadata[type])&&(metadata[type]={})}})},dataset.getDataByColumnIndex=function(index){var data=null,found=!1;return chartObj.seriesdata.some(function(series){return series.data.some(function(subSeries){return subSeries.some(function(point){if(defined(point))return(found=defined(point[index]))&&(data=point[index]),found})})}),data},dataset.findDataType=function(data){return"number"==typeof data?data>31536e6?TIME_DATATYPE:NUMERIC_DATATYPE:ORDINAL_DATATYPE},dataset.processMetaData(),dataset},PreProcessor.prototype.initialize=function(){var chart=this.chart,data=this.data,xColumnIndex=data.metadata.axes.x,xDataType=data.metadata.columns[xColumnIndex].datatype,dataProcessorHelpers=DataProcessor.helpers,isDiscrete=chartcategory.discrete.some(function(d){return-1!==chart.chartTypes.indexOf(d)}),cType=dataProcessorHelpers.getChartType(null,null,0,chart.systemConf),chartValue=cType.value,chartName=cType.name,isAllowedHierarchyCharts=isBarChartType(chartValue)||isAreaChartType(chartValue)||isScatterChartType(chartValue)||isPointChartType(chartValue)||"line"===chartName;this.isHierarchyLayout()&&isAllowedHierarchyCharts&&(this.hierarchical=new DataProcessor.HierarchicalOrdinalDataAdapter(this.chart),this.chart.seriesdata=this.hierarchical.getSeries()),this.processTimeData(),_requireXDataSorting&&(xDataType===NUMERIC_DATATYPE||xDataType===TIME_DATATYPE&&!isDiscrete)&&this.sortData(xColumnIndex,xDataType)},PreProcessor.prototype.isHierarchyLayout=function(){return this.chart.systemConf.seriesdata.chartdata.some(function(series){return PreProcessor.helpers.hasInnerSeries(series)})},PreProcessor.prototype.processTimeData=function(){var timeDataInfo,timeDataIndices,hasTimeInputFormat,series=this.chart.seriesdata;timeDataIndices=(timeDataInfo=PreProcessor.helpers.time.getDataInfo(this.data)).indices,hasTimeInputFormat=timeDataInfo.formatConf.some(function(d){return defined(d)&&defined(d.inputformat)}),timeDataIndices&&timeDataIndices.length&&hasTimeInputFormat&&series.forEach(function(d,i){var currentData=d.data,is3DArray=DataProcessor.helpers.is3D(currentData);isArray(currentData)&&currentData.forEach(function(subgroup,j){is3DArray&&isArray(subgroup)&&subgroup.forEach(function(dataPoint,k){PreProcessor.helpers.time.applyFormats(dataPoint,timeDataInfo)}),is3DArray||PreProcessor.helpers.time.applyFormats(subgroup,timeDataInfo)})})},PreProcessor.prototype.sortData=function(xColPos){var chart=this.chart,data=this.data;return chart.seriesdata.forEach(function(currentSeries){var currentData=currentSeries.data,dataIndex=data.metadata.columns[xColPos].dataindex;DataProcessor.helpers.is3D(currentData)?isArray(currentData)&&currentData.forEach(function(subgroup){PreProcessor.helpers.linear.sort(subgroup,dataIndex)}):PreProcessor.helpers.linear.sort(currentData,dataIndex)}),data},PreProcessor.helpers={time:{},ordinal:{},numeric:{},linear:{}},PreProcessor.helpers.hasInnerSeries=function(series){return isArray(series.data)&&"object"==typeof series.data[0]&&defined(series.data[0].seriesname)},PreProcessor.helpers.time={getDataInfo:function(data,isDiscrete){var timeFormatConfig,inputFormat,column,xColumnIndex=data.metadata.axes.x,regexTimeStamp=/timestamp/i,timeDataIndices=[],formatConf=[];return d3_merge([xColumnIndex,d3_merge(data.metadata.axes.y)]).map(function(d){column=pick(data.metadata.columns[d],{}),timeFormatConfig=pick(column.time,{}),"time"!==column.datatype||d===xColumnIndex||isDiscrete||(inputFormat=timeFormatConfig.inputformat,regexTimeStamp.test(inputFormat)&&"function"!==inputFormat&&"function"!=typeof window[inputFormat]?formatConf.push(null):formatConf.push(timeFormatConfig),timeDataIndices.push(data.metadata.columns[d].dataindex))}),{indices:timeDataIndices,formatConf:formatConf}},applyFormats:function(d,info){var indices=info.indices,format=info.formatConf;return indices.map(function(index,j){defined(d[index])&&(isArray(d[index])?d[index]=d[index].map(function(d){return generateDateVal(d,0,format[j]).getTime()}):d[index]=generateDateVal(d[index],0,format[j]).getTime())}),d}},PreProcessor.helpers.linear={sort:function(array,dataIndex){return array.sort(function(a,b){return(a=a[dataIndex])<(b=b[dataIndex])?-1:a>b?1:a>=b?0:NaN})}},plot.svgRenderer=function(chartObj,args){var svgRenderer={},systemconf=chartObj.systemConf,helpers=DataProcessor.helpers;return svgRenderer.draw=function(update){chartObj.dataset.getDataType("x")==ORDINAL_DATATYPE&&chartObj.isAxisCategory&&scale$1.barBandwidth(chartObj),args.barDatasetIndex=0;var type,isRendererCalled=[];chartObj.chartRendered=!1;var isComboChart=chartObj.dataObject.isCombinationalChart,orderedSeriesdata=isComboChart?renderer_helpers.arrangeSeriesRenderingOrder(chartObj):chartObj.seriesdata;chartObj.seriesdata.forEach(function(d,i){var currOrdereddata=orderedSeriesdata[i],curSeriesidx=isComboChart?currOrdereddata.seriesidx:i;if(!(curSeriesidx>0)||chartObj.xymultiRenderer||chartObj.dataObject.isPolarAxisCategory){(type=helpers.getChartType(currOrdereddata.type||chartObj.userdata.seriesdata.type,NUMERIC_DATATYPE))==charttype.bubblepie&&isUndefined(chartObj.bubblePieRendererIndex)&&(chartObj.bubblePieRendererIndex=curSeriesidx);var animated=[],chartName=charttypenames.get(type),plotoptions=currOrdereddata.plotoptions,animationOptions=getAnimationConf(systemconf.chart.plot.plotoptions[chartName],plotoptions,chartObj,chartName),isAnimationEnable=animationOptions.enabled,animationType=animationOptions.type;null==chartObj.renderer[curSeriesidx]&&(chartObj.renderer[curSeriesidx]=createSVGRenderer(chartName),chartObj.rendererConf[curSeriesidx]=new plot.rendererConf),chartObj.renderer[curSeriesidx].chartRendered=!1,0==i&&(stateChangeListener(chartObj,systemconf.chart.plot.events,0,"init"),chartObj.hideLoading(chartObj.container)),isAnimationEnable&&!update&&(isScatterChartType(type)||isAreaChartType(type))&&[ALLSERIES_ANIMATION,POINTTWEEN_ANIMATION,VERTPATHTWEENALL_ANIMATION,FADEALL_ANIMATION,VERTICALALL_ANIMATION,SIZING_ANIMATION,SIZINGRANDOM_ANIMATION].indexOf(animationType)<0?(isRendererCalled[curSeriesidx]=!1,animated[curSeriesidx]=setInterval(function(){chartObj.renderer[curSeriesidx].chartRendered&&clearInterval(animated[curSeriesidx]),!isRendererCalled[curSeriesidx]&&(0==curSeriesidx||curSeriesidx>0&&chartObj.renderer[curSeriesidx-1].chartRendered)&&(renderer_helpers.setRendererProp(chartObj,chartObj.renderer[curSeriesidx],currOrdereddata,curSeriesidx,i,args),drawSVG(chartObj,currOrdereddata,chartObj.renderer[curSeriesidx]),isRendererCalled[curSeriesidx]=!0)},10)):(renderer_helpers.setRendererProp(chartObj,chartObj.renderer[curSeriesidx],currOrdereddata,curSeriesidx,i,args),drawSVG(chartObj,currOrdereddata,chartObj.renderer[curSeriesidx]))}}),renderer_helpers.renderCompletedEvents(chartObj,update,args)},svgRenderer};var createSVGRenderer=plot.svgRenderer.createSVGRenderer=function(chartName){switch(chartName){case"waterfall":case"gantt":case"bullet":chartName="bar";break;case"web":case"arearange":chartName="area";break;case"bubble":case"geobubble":case"geoscatter":chartName="scatter";break;case"bubblepie":case"geobubblepie":chartName="bubblepie"}return new svg_plot_renderer[chartName]},drawSVG=plot.svgRenderer.drawSVG=function(chartObj,renderdata,renderercollection,update){if(update)renderercollection.update();else{clearTimeout(renderercollection.renderedTimer);var wrap=chartObj.wrap.data([chartObj.systemConf]);transformWrap(wrap,"seriesholder",{x:chartObj.plotarea.left,y:chartObj.plotarea.top}).datum(chartObj.seriesdata).call(renderercollection),chartObj.dataObject.isPolarAxisCategory&&wrap.selectAll("g.seriesholder").selectAll(function(){return this.childNodes}).attr("transform","translate("+chartObj.plotarea_approx.x+","+chartObj.plotarea_approx.y+")"),transformWrap(chartObj.staticPaneSVG,"labelholder",{x:chartObj.plotarea.left,y:chartObj.plotarea.top})}function transformWrap(wrap,selection,translate){return wrap.select("g."+selection).attr("transform","translate("+translate.x+","+translate.y+")")}},legendHighlight=function(chartObj,container){var legendHighlight={},origProp={},defsLocation=chartObj.defsLocation,userdata=chartObj.userdata,hasColorScale=!chartObj.nochartdata&&colorscale_helpers.isQuantileColorScale(chartObj),getChartType=DataProcessor.helpers.getChartType,filterSelectionByColor=legend_helpers.filterSelectionByColor;function getSelectedSeries(index,filterIndex){var seriesHolder=container.selectAll("g.seriesholder"),charttypes=[],selectedSeries=[],parentSeries=[];return function collectSelectedSeries(type,index){var series,parent;if(isHeatMapChartType(type)){var heatmapSeries=seriesHolder.selectAll("g.heatmapseries_"+index);series=heatmapSeries.selectAll("path")}else if(isBarChartType(type)){var barSeries=seriesHolder.selectAll("g.barseries_"+index);series=barSeries.selectAll("path.zcbar")}else if(type==charttype.line){var lineSeries=seriesHolder.selectAll("g.lineseries_"+index);series=lineSeries.selectAll("path.line"),parent=lineSeries}else if(isAreaChartType(type)||type==charttype.web){var areaSeries=seriesHolder.selectAll("g.areaseries_"+index);series=areaSeries.selectAll("path.area"),parent=areaSeries}else{if(isScatterChartType(type)){var scatterSeries=seriesHolder.selectAll("g.scatterseries_"+index);series=scatterSeries.selectAll("g.scatter");var outerScatters=(series=filterSelectionByColor(series,!0,filterIndex,chartObj)).selectAll("path.outer"),innerScatters=series.selectAll("path.inner");return selectedSeries.push(outerScatters,innerScatters),charttypes.push(type,type),parent=scatterSeries,void parentSeries.push(parent)}if(type===charttype.bubblepie||type===charttype.geobubblepie){var pieSeries=seriesHolder.selectAll("g.piegroup");series=pieSeries.selectAll("path#arc_"+index)}else if(isPieChartType(type)){var pieSeries=seriesHolder.selectAll("g.piegroup");series=pieSeries.selectAll(defined(filterIndex)?"path":"path#arc_"+index)}else if(type==charttype.funnel){var funnelSeries=seriesHolder.selectAll("g.funnelgroup"),trapezoidgroup=funnelSeries.selectAll("g.trapezoidgroup");series=trapezoidgroup.selectAll(defined(filterIndex)?"path":"path#funnel"+index)}else if(type==charttype.pyramid){var pyramidSeries=seriesHolder.selectAll("g.pyramidgroup");series=pyramidSeries.selectAll(defined(filterIndex)?"g":"g#section_"+index)}else if(type==charttype.wordcloud){var wordCloudSeries=seriesHolder.selectAll("g.wordcloudgroup");series=wordCloudSeries.selectAll("text.series_"+index)}else if(-1!=chartcategory.hierarchy.indexOf(type)){var burstseries=seriesHolder.selectAll("g.hierarchychart");series=burstseries.selectAll(".series_"+index)}}series=filterSelectionByColor(series,!0,filterIndex,chartObj);selectedSeries.push(series);charttypes.push(type);parentSeries.push(parent);(isAreaChartType(type)||type==charttype.web)&&collectSelectedSeries(charttype.line,index);type==charttype.line&&hasSubScatterRenderer(filterIndex)&&collectSelectedSeries(charttype.scatter,index)}(getChartType(null,"object",index,userdata).value,index),{selectedSeries:selectedSeries,charttypes:charttypes,parentSeries:parentSeries}}function getUnselectedSeries(index,filterIndex){var parentSeries,unSelectedSeries=[],indices=[],charttypes=[],seriesHolder=container.selectAll("g.seriesholder");return function collectUnselectedSeries(subcharttype,index){var series,type;if(chartObj.isAxisCategory||chartObj.isNonAxisMultiSeriesCategory||chartObj.isGeoMap)chartObj.seriesdata.forEach(function(d,i){if(1!=d.disabled&&(defined(filterIndex)?arrayIncludes(index,i):!arrayIncludes(index,i))){type=subcharttype||getChartType(null,"object",i,userdata).value;var selectionIndex=defined(filterIndex)?index:i;if(isHeatMapChartType(type)){var heatmapSeries=seriesHolder.selectAll("g.heatmapseries_"+selectionIndex);series=heatmapSeries.selectAll("path")}else if(isBarChartType(type)){var barSeries=seriesHolder.selectAll("g.barseries_"+selectionIndex);series=barSeries.selectAll("path.zcbar")}else if(type==charttype.line){var lineSeries=seriesHolder.selectAll("g.lineseries_"+selectionIndex);series=lineSeries.selectAll("path.line")}else if(isAreaChartType(type)||type==charttype.web){var areaSeries=seriesHolder.selectAll("g.areaseries_"+selectionIndex);series=areaSeries.selectAll("path.area"),parentSeries=areaSeries}else{if(isScatterChartType(type)){var scatterSeries=seriesHolder.selectAll("g.scatterseries_"+selectionIndex);series=scatterSeries.selectAll("g.scatter");var outerScatters=(series=filterSelectionByColor(series,!1,filterIndex,chartObj)).selectAll("path.outer"),innerScatters=series.selectAll("path.inner");return unSelectedSeries.push(outerScatters,innerScatters),charttypes.push(type,type),void indices.push(selectionIndex,selectionIndex)}if(-1!=chartcategory.hierarchy.indexOf(type)){var burstseries=seriesHolder.selectAll("g.hierarchychart");series=burstseries.selectAll(".series_"+selectionIndex)}else if(type==charttype.wordcloud){var wordCloudSeries=seriesHolder.selectAll("g.wordcloudgroup");series=wordCloudSeries.selectAll(".series_"+selectionIndex)}else chartcategory.bubblePie.has(type)&&(series=seriesHolder.selectAll("g.piegroup").selectAll("path#arc_"+i))}series=filterSelectionByColor(series,!1,filterIndex,chartObj),unSelectedSeries.push(series),indices.push(i),charttypes.push(type)}});else{var prefix_ID,processFunc=function(d,i){var ele=d3_select(this),elementIndex=+this.getAttribute("id").split(prefix_ID).pop(),unselect=defined(filterIndex)?!filterSelectionByColor(ele,!1,filterIndex,chartObj).empty():this.getAttribute("id")!=prefix_ID+index;return unselect&&!arrayIncludes(index,elementIndex)&&(unSelectedSeries.push(ele),indices.push(elementIndex),charttypes.push(type)),unselect};if(isPieChartType(type=subcharttype||getChartType(null,"object",index,userdata).value))prefix_ID="arc_",series=seriesHolder.selectAll("g.piegroup").selectAll("path").filter(processFunc);else if(type==charttype.funnel)prefix_ID="funnel",series=seriesHolder.selectAll("g.trapezoidgroup").selectAll("path").filter(processFunc);else if(type==charttype.pyramid){prefix_ID="section_";var pyramidGroup=seriesHolder.selectAll("g.pyramidgroup");series=pyramidGroup.selectAll("g").filter(processFunc)}}(isAreaChartType(type)||type==charttype.web)&&collectUnselectedSeries(charttype.line,index);type==charttype.line&&hasSubScatterRenderer(filterIndex)&&collectUnselectedSeries(charttype.scatter,index)}(null,index),{unselectedSeries:unSelectedSeries,indices:indices,charttypes:charttypes,parentSeries:parentSeries}}function applyProp(series,parentSeries,prop,index,type){if(null!=prop&&prop.constructor==Object&&null!=series&&null!=series.node()){var key=getKey(series,index,type),currentOrigProp={},multipleStyles=hasMultipleStyles(index);for(var attr in prop)if(prop.hasOwnProperty(attr)){multipleStyles?(currentOrigProp[attr]=currentOrigProp[attr]||[],series.each(function(){currentOrigProp[attr].push(d3$1.select(this).style(attr))})):currentOrigProp[attr]=series.styles(attr);var val=prop[attr];$Browser.SAFARI||$Browser.IE?series.attr(attr,function(d){return utils.getVal(val,[d,index])}).style(attr,function(d){return utils.getVal(val,[d,index])}):series.style(attr,function(d){return utils.getVal(val,[d,index])})}origProp[key]=origProp[key]||currentOrigProp,"select"===type&&legendHighlight.raiseSelection(parentSeries||series)}}function resetProp(series,prop,index,type){if(null!=prop&&prop.constructor==Object&&null!=series&&null!=series.node()){var key=getKey(series,index,type),currentOrigProp=origProp[key],multipleStyles=hasMultipleStyles(index);for(var attr in currentOrigProp)if(currentOrigProp.hasOwnProperty(attr)){var val=currentOrigProp[attr],actualVal=function(){return multipleStyles?val[count++]:val},count=0;$Browser.SAFARI||$Browser.IE?series.style(attr,actualVal).attr(attr,actualVal):series.style(attr,actualVal)}}}function getKey(series,index,selectionType){var node=series.node(),localName=node.localName,className=node.getAttribute("class"),idName=node.getAttribute("id"),KEY=localName+"_"+index;return null!=className&&(KEY+="_"+className),null!=idName&&(KEY+="_"+idName),null!==selectionType&&(KEY+="_"+selectionType),KEY}function defaultEffect(chartName){return legend_helpers.hasPatternPallete(chartObj)?/(area|arearange)/.test(chartName)?"moody":"strokeEnlarge":/(bar|bullet|gantt|area|arearange|pie|funnel|pyramid|web|sunburst|waterfall)/.test(chartName)?"hatchfill":"heatmap"===chartName||"geoheatmap"===chartName?"tinyHatchfill":/(treemap|wordcloud)/.test(chartName)?"blackyBorder":"strokeEnlarge"}function highlightSVGSeries(legdata,index,filterIndex){var indexIsArray=isArray(index);legendHighlight.selSeriesObj=[],(index=splat(index)).forEach(function(ii){var selected=getSelectedSeries(ii,filterIndex);legendHighlight.selSeriesObj.push(selected);for(var selecteffect=legendHighlight.getLegendHighlightEffect(ii,"selectedSeries"),selectedSeries=selected.selectedSeries,charttypes=selected.charttypes,parentSeries=selected.parentSeries,length=selectedSeries.length,i=0;i<length;i++){var cType=charttypenames.get(charttypes[i]),baseColor=indexIsArray?getCurrectColor(chartObj,ii,filterIndex):null,prop=legendHighlight.getEffect(selecteffect,cType,baseColor,null,ii);applyProp(selectedSeries[i],parentSeries[i],prop,ii,"select")}})}function hasMultipleStyles(seriesIndex){var cType=getChartType(null,NUMERIC_DATATYPE,seriesIndex,userdata);return-1!=chartcategory.hierarchy.indexOf(cType)||hasColorScale||isBubbleChartType(cType)||chartObj.rendererConf&&chartObj.rendererConf[chartObj.isAxisCategory?seriesIndex:0].thresholdType}function doArrangeSelection(){if(chartObj.dataObject.isHierarchy){var styles=legendHighlight.getEffect(legendHighlight.getLegendHighlightEffect(0,"selectedSeries"),chartObj.chartTypes[0].name),keys=Object.keys(styles);return keys.length>0&&keys.some(function(key){return"fill"!==key})}if(chartObj.dataObject.noofAreaEnabledSeries||chartObj.dataObject.noofAreaRangeEnabledSeries)return!0}function hasSubScatterRenderer(filterValue){return $Browser.IE||$Browser.SAFARI||defined(filterValue)}return legendHighlight.highlightSelectedSeries=function(legdata,index,filterIndex){if(legendHighlight.baseClr=getCurrectColor(chartObj,index,filterIndex),chartObj.isGeoMap&&isGeoHeatMapChartType(chartObj.chartTypes[index].value))!function(chartObj,legdata,index,filterIndex){if(legendHighlight.previousFilterIndex!==filterIndex){var mapEvents=chartObj.eventHandler.mapEvents,points=mapEvents.getPointsByIndex(index,filterIndex),features=chartObj.dataObject.getMapFeaturesByDataPoint(points,"array"),highlightStyle=mapEvents.getHighlightEffect(index,null,"selectedSeries","legend");mapEvents.highlightPoints(features,"feature",highlightStyle),legendHighlight.previousFilterIndex=filterIndex}}(chartObj,0,index,filterIndex);else switch(chartObj.plot.renderer.mode){case"svg":highlightSVGSeries(legdata,index,filterIndex);break;case"canvas":!function(chartObj,legdata,index,filterIndex){var context=chartObj.highlightContext||(chartObj.highlightContext=plot.canvasRenderer.updateCanvasContext(chartObj,"highlight-canvas"));chartObj.systemConf;(index=splat(index)).forEach(function(ii){!function(index){var effect=chartObj.legendHighlight.getLegendHighlightEffect(index,"selectedSeries"),unHighlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(index,"unselectedSeries");chartObj.dataObject.isPolarAxisCategory&&context.translate(chartObj.plotarea_approx.x,chartObj.plotarea_approx.y);if(effect===NONE&&!UNHIGHLIGHT_EFFECT_REGEX.test(unHighlightEffect))return;var chart=chartObj.chartTypes[index],chartName=chart.name,cType=chart.value,renderer=plot.canvasRenderer.createCanvasRenderer(chartName),currentSeries=chartObj.seriesdata[index],pattern=null,highlightSeriesindex=chartObj.isNonAxisMultiSeriesCategory&&!chartObj.dataObject.isPolarAxisCategory?0:index,fillOpacity=chartObj.systemConf.chart.plot.plotoptions[chartName].fillOpacity,baseColor=getCurrectColor(chartObj,index,filterIndex)||legendHighlight.baseClr;if(renderer_helpers.setRendererProp(chartObj,renderer,currentSeries,highlightSeriesindex,highlightSeriesindex,{labelQueue:[]}),hasColorScale&&(isAreaChartType(cType)||isScatterChartType(cType)))pattern=chartObj.legendHighlight.getEffect(effect,cType);else switch(chartName){case"bar":case"bullet":case"area":case"arearange":case"heatmap":case"treemap":case"web":var prop=patternThemes[effect];prop&&(pattern=getCanvasPattern(prop,baseColor,fillOpacity,chartObj));break;case"wordcloud":var prop=patternThemes[effect];pattern=prop?{fill:getCanvasPattern(prop,baseColor,fillOpacity,chartObj)}:chartObj.legendHighlight.getEffect(effect,cType);break;case"scatter":case"geoscatter":case"bubble":case"geobubble":case"line":pattern=chartObj.legendHighlight.getEffect(effect,cType)}plot.canvasRenderer.drawCanvas(chartObj,currentSeries,renderer,context,pattern,filterIndex)}(ii)})}(chartObj,0,index,filterIndex);break;default:!function(legdata,index){if(legendHighlight.getLegendHighlightEffect(index,"selectedSeries")===NONE)return;legendHighlight.baseClr=getColorByIndex(chartObj,index);var cType=chartObj.chartTypes[index],cName=cType.name,cTypeNumeric=cType.value,selectedSeriesObj=getSelectedSeries(index);if(selectedSeriesObj.selectedSeries[0].length>0)return series=selectedSeriesObj.selectedSeries[0],visible=!0,void series.style("visibility",visible?"visible":"hidden");var series,visible;if(!chartObj.chartRendered)return;chartObj.systemConf.chart.plot.animation.enabled=!1,chartObj.systemConf.chart.plot.plotoptions[cName].animation.enabled=!1,chartObj.seriesdata[index].plotoptions&&chartObj.seriesdata[index].plotoptions.animation&&(chartObj.seriesdata[index].plotoptions.animation.enabled=!1);var renderer=createSVGRenderer(cName),currOrdereddata=chartObj.systemConf.seriesdata.chartdata[index],barDatasetIndex=0;if(cTypeNumeric===charttype.bar||cTypeNumeric===charttype.stkdbar)for(var i=0;i<index;i++)cType=chartObj.chartTypes[i],cTypeNumeric=cType.value,void 0!=chartObj.seriesdata[i].disabled&&chartObj.seriesdata[i].disabled||!isBarChartType(cTypeNumeric)||(barDatasetIndex+=chartObj.seriesdata[i].data.length);renderer_helpers.setRendererProp(chartObj,renderer,currOrdereddata,index,index,{labelQueue:[],barDatasetIndex:barDatasetIndex}),drawSVG(chartObj,currOrdereddata,renderer),highlightSVGSeries(legdata,index)}(legdata,index)}},legendHighlight.highlightUnselectedSeries=function(legdata,index,filterIndex){var ele,highlightEffect,prop;chartObj.isGeoMap||"svg"===chartObj.plot.renderer.mode?function(legdata,index,filterIndex){for(var unselSeriesObj=getUnselectedSeries(index=splat(index),filterIndex),unselectedSeries=unselSeriesObj.unselectedSeries,indices=unselSeriesObj.indices,charttypes=unselSeriesObj.charttypes,length=unselectedSeries.length,i=0;i<length;i++){var cType=charttypenames.get(charttypes[i]),unselecteffect=legendHighlight.getLegendHighlightEffect(indices[i],"unselectedSeries"),prop=legendHighlight.getEffect(unselecteffect,cType,NULL,NULL,indices[i]);applyProp(unselectedSeries[i],NULL,prop,indices[i],"unselect")}}(0,index,filterIndex):(ele=d3_select(chartObj.context.canvas),highlightEffect=legendHighlight.getLegendHighlightEffect(0,"unselectedSeries"),prop=chartObj.legendHighlight.getEffect(highlightEffect,NULL,NULL,NULL,0),applyProp(ele,NULL,prop,0,"unselect"))},legendHighlight.reset=function(legdata,index,filterIndex,resetOriginalProp){if(chartObj.isGeoMap&&isGeoHeatMapChartType(chartObj.chartTypes[index].value))legendHighlight.previousFilterIndex=null,chartObj.eventHandler.mapEvents.clearHighlightedPoints();else switch(index=splat(index),chartObj.plot.renderer.mode){case"svg":!function(legdata,index,filterIndex){legendHighlight.selSeriesObj=[],index.forEach(function(ii){for(var selected=getSelectedSeries(ii,filterIndex),selecteffect=legendHighlight.getLegendHighlightEffect(ii,"selectedSeries"),selectedSeries=selected.selectedSeries,charttypes=selected.charttypes,length=selectedSeries.length,i=0;i<length;i++){var cType=charttypenames.get(charttypes[i]),prop=legendHighlight.getEffect(selecteffect,cType,null,null,ii);resetProp(selectedSeries[i],prop,ii,"select")}legendHighlight.selSeriesObj.push(selected)})}(0,index,filterIndex),function(legdata,index,filterIndex){legendHighlight.unselSeriesObj=getUnselectedSeries(index,filterIndex);for(var unselectedSeries=legendHighlight.unselSeriesObj.unselectedSeries,indices=legendHighlight.unselSeriesObj.indices,charttypes=legendHighlight.unselSeriesObj.charttypes,length=unselectedSeries.length,i=0;i<length;i++){var cType=charttypenames.get(charttypes[i]),unselecteffect=legendHighlight.getLegendHighlightEffect(indices[i],"unselectedSeries"),prop=legendHighlight.getEffect(unselecteffect,cType,null,null,indices[i]);resetProp(unselectedSeries[i],prop,indices[i],"unselect")}}(0,index,filterIndex);break;case"canvas":chartObj.container.select(".highlight-canvas").style("visibility","hidden"),ele=d3_select(chartObj.context.canvas),highlightEffect=legendHighlight.getLegendHighlightEffect(0,"unselectedSeries"),prop=chartObj.legendHighlight.getEffect(highlightEffect,NULL,NULL,NULL,0),resetProp(ele,prop,0,"unselect")}var ele,highlightEffect,prop;!1!==resetOriginalProp&&(origProp={},this.resetSelection())},legendHighlight.getLegendHighlightEffect=function(index,seriesType,plotOrLegend){var chartName=getChartType(null,"string",index,userdata),cType=getChartType(null,NUMERIC_DATATYPE,index,userdata),plotOptions=chartObj.isAxisCategory||chartObj.isNonAxisMultiSeriesCategory||chartObj.isGeoMap?chartObj.seriesdata[index].plotoptions:chartObj.seriesdata[0].plotoptions,commonPlotOptions=chartObj.systemConf.chart.plot.plotoptions[chartName],legendEffect=chartObj.systemConf.legend.highlightEffect[seriesType],ef=plotOptions&&plotOptions.legendHighlightEffect?utils.getValueOfPlotOptions(plotOptions.legendHighlightEffect,commonPlotOptions.legendHighlightEffect)(seriesType):commonPlotOptions.legendHighlightEffect&&commonPlotOptions.legendHighlightEffect[seriesType];if("plot"===plotOrLegend)return"unselectedSeries"!==seriesType||chartObj.systemConf.legend.highlightEffect.applyUnselectedSeriesToPlot?ef||legendEffect||defaultEffect(chartName):NONE;var defaultEf="selectedSeries"===seriesType&&hasColorScale&&(isAreaChartType(cType)||cType===charttype.line)?"strokeEnlarge(6)":defaultEffect(chartName);return ef||legendEffect||defaultEf},legendHighlight.getEffect=function(effect,chartName,baseClr,additionalStyles,index,from){baseClr=baseClr||legendHighlight.baseClr;var isMultiColoringEffects=!!/(waterfall)/.test(chartName),userEffect=invokeFunction(effect,chartObj,baseClr=isMultiColoringEffects?getBaseColor:baseClr,patternThemes,from||"legend");if(userEffect&&userEffect.constructor==Object)return userEffect;effect=null===effect||function(effect,chartName){return/(line|scatter)/.test(chartName)&&/(((\D)+fill$)|illuminate|moody|flip)/.test(effect)}(effect,chartName)?defaultEffect(chartName):effect;var eStyle={};if(chartObj.patternPallete&&/(flip|moody|illuminate)/.test(effect)){var svgPattern=chartObj.patternPallete[(index||0)%chartObj.patternPallete.length],prop=patternThemes[svgPattern]?patternThemes[svgPattern]:addPatternThemeByEle(svgPattern),effectCallBack=function(data,index){var baseColor=isMultiColoringEffects?getBaseColor(data,index):baseClr;if(prop.ele)prop.bgClr_base=getColorCopy(baseColor,1,"darker",d3_hsl);else{var colorCopy="flip"===effect?baseColor:getColorCopy(baseColor,1,"moody"===effect?"darker":"brighter",d3_hsl);if(prop.bgClr_base=colorCopy,prop.stroke_base=colorCopy,"flip"===effect){var temp=(prop=simpleClone(prop)).bgClr_base;prop.bgClr_base=prop.stroke_base,prop.stroke_base=temp;var copy_bgClr=stringifiedArrayReverse(prop.bgClr),copy_stroke=stringifiedArrayReverse(prop.stroke);prop.bgClr=copy_stroke,prop.stroke=copy_bgClr}}var patternId=effects.get(effects.svg_patterns,"svgPatternFill",prop,{chartObj:chartObj});return"url("+defsLocation+"#"+patternId+")"};eStyle.fill=isMultiColoringEffects?effectCallBack:effectCallBack()}else if(/(saturate|grayscale|blur|glow|shadow|boxShadow)/.test(effect)){var options,filterType=/(saturate|grayscale)/.test(effect)?"colorMatrix":"dropShadow";switch(effect){case"saturate":options={type:"saturate",values:"0.3"};break;case"grayscale":options={type:"matrix",values:".33 .33 .33 0 0 .33 .33 .33 0 0 .33 .33 .33 0 0 0 0 0 1 0"};break;case"blur":options={blur:2,source:"SourceGraphic"},eStyle.opacity=.7;break;case"glow":options={blur:3,color:"gold"};break;case"shadow":options={dx:5,dy:5,blur:3};break;case"boxShadow":eStyle.fill=baseClr,eStyle.stroke="white",options={dx:0,dy:0,blur:5,color:"rgba(0,0,0,0.3)"}}var filterId=effects.get(effects.svg_filters,filterType,options,{chartObj:chartObj});eStyle.filter="url("+defsLocation+"#"+filterId+")"}else if(/(moody|illuminate)/.test(effect)){var ismoody="moody"===effect,effectCallback=function(data,index){var baseColor=isMultiColoringEffects?getBaseColor(data,index):baseClr;return-1!=baseColor.indexOf("url")?ismoody?"grey":"silver":getColorCopy(baseColor,.6,ismoody?"darker":"brighter",d3_hsl)};eStyle.fill=isMultiColoringEffects?effectCallback:effectCallback()}else if(effect.indexOf("strokeEnlarge")>-1){var customStrokeWidth=effect.split(/(\d+)/g)[1];if(eStyle["stroke-width"]=defined(customStrokeWidth)?+customStrokeWidth:3,hasColorScale&&(eStyle.visibility=NULL),additionalStyles)for(var a in additionalStyles)eStyle[a]=additionalStyles[a]}else if("fadeOut"===effect)eStyle.opacity=.3;else if("blackyBorder"===effect)eStyle.stroke="rgba(0,0,0,0.5)",eStyle["stroke-width"]=1;else if("invert"===effect)eStyle.fill="white",eStyle.stroke=baseClr,eStyle["stroke-width"]=1,eStyle["paint-order"]=null;else if("ridge"===effect)eStyle.fill=baseClr,eStyle.stroke="white",eStyle["stroke-width"]=7;else if(effect!==NONE){if(prop=patternThemes[effect]){effectCallback=function(data,index){var baseColor=isMultiColoringEffects?getBaseColor(data,index):baseClr,prop=patternThemes[effect];prop.bgClr_base=baseColor,prop.stroke="transparent,white,white";var patternId=effects.get(effects.svg_patterns,"svgPatternFill",prop,{chartObj:chartObj});return"url("+defsLocation+"#"+patternId+")"};eStyle.fill=isMultiColoringEffects?effectCallback:effectCallback()}else eStyle.fill=baseClr}return eStyle;function getBaseColor(data,index){return baseClr=legendHighlight.baseClr||getColorByIndex(chartObj,index),"waterfall"==chartName?colorscale_helpers.getWaterfallColor(data,chartObj.renderer[index].commonRendererProp().params.categoryColorConfig,baseClr):baseClr}},legendHighlight.raiseSelection=function(elements){doArrangeSelection()&&elements.raise()},legendHighlight.resetSelection=function(){doArrangeSelection()&&(chartObj.dataObject.noofAreaEnabledSeries||chartObj.dataObject.noofAreaRangeEnabledSeries?container.selectAll("g.seriesholder").selectAll(function(){return this.childNodes}).filter(function(){return"g"==this.tagName}).sort(function(a,b){return a.index-b.index}):container.selectAll("g.seriesholder").selectAll("g.hierarchychart").selectAll("*").sort(function(a,b){return a.index-b.index}))},legendHighlight};function getCanvasPattern(prop,baseClr,fillOpacity,chartObj){return prop.bgClr_base=rgba_canvas(baseClr,fillOpacity),prop.stroke="transparent,white,white",effects.get(effects.canvas_patterns,"canvasPatternFill",prop,{chartObj:chartObj})}function getCurrectColor(chartObj,index,filterIndex){if(defined(filterIndex)){var userRanges=chartObj.systemConf.legend.colorBand.ranges;return userRanges&&userRanges.length?getColorByIndex(chartObj,filterIndex):chartObj.axes.clr.scale((filterIndex[0]+filterIndex[1])/2)}return getColorByIndex(chartObj,index)}var CENTER_ALIGN="center",LEFT_ALIGN="left",RIGHT_ALIGN="right",BOTTOM_ALIGN="bottom",TOP_ALIGN="top",FIXEDTOP_ALIGN="fixedTop",VERTICAL_ALIGN="vertical",HORIZONTAL_ALIGN="horizontal",INNER_ALIGN="inner",OUTER_ALIGN="outer",START_ALIGN="start",MIDDLE_ALIGN="middle",END_ALIGN="end",tooltip_helpers={getSize:function(config,availableDimension,defaultDimension,defaultMaxDimension){defaultMaxDimension=defaultMaxDimension||[];var availableWidth=availableDimension[0],availableHeight=availableDimension[1],defaultWidth=defaultDimension[0],defaultHeight=defaultDimension[1],defaultMaxWidth=defaultMaxDimension[0],defaultMaxHeight=defaultMaxDimension[1],w=perToPx(config.width,availableWidth,perToPx(defaultWidth,availableWidth)),h=perToPx(config.height,availableHeight,perToPx(defaultHeight,availableHeight)),maxw=perToPx(config.maxWidth,availableWidth,defaultMaxWidth||w),maxh=perToPx(config.maxHeight,availableHeight,defaultMaxHeight||h);return{w:mathMin(maxw,w),h:mathMin(maxh,h),maxw:maxw,maxh:maxh}},getPieColumnIndex:function(chartObj){var pieIdx,piedataindex=validateNullVal(chartObj.systemConf.chart.plot.plotoptions.bubblepie.dataindex,3);return chartObj.systemConf.metadata.columns.some(function(c,i){if(c.dataindex===piedataindex)return pieIdx=i,!0}),defined(pieIdx)?pieIdx:chartObj.dataset.getColumnIdx("y",0)},hasSharedSeries:function(chartObj){return chartObj.systemConf.tooltip.sharedSeriesInfo&&chartObj.isAxisCategory&&!isHeatMapChartType(chartObj.chartTypes[0].value)}},tooltip_content={getContentTemplate:function(chartObj,customTemplate,customIndices,forPrecalculation){var foundYColumnIndex,content,systemConf=chartObj.systemConf,metadata=systemConf.metadata,metadata_axes=metadata.axes,metadata_columns=metadata.columns,meta_tooltip=customIndices||metadata_axes.tooltip||d3.range(metadata_columns.length),meta_yaxes=metadata_axes.y&&d3_merge(metadata_axes.y)||[],tooltipConfig=systemConf.tooltip,maxWidth=perToPx(tooltipConfig.maxWidth||"40%",chartObj.chartarea.width),sharedSeriesInfo=tooltip_helpers.hasSharedSeries(chartObj),isColumnView="column"===tooltipConfig.view,template=[];if(customTemplate)template=customTemplate;else{if(defined(systemConf.tooltip.theme)&&isObjectPropDefined($ZC,"tooltip.getTheme"))meta_tooltip=chartObj.tooltip.content;else if(sharedSeriesInfo){var tooltipSharedInfo=d3_map();chartObj.seriesdata.forEach(function(series,seriesIndex){tooltip_content.updateSharedInfo(chartObj,tooltipSharedInfo,seriesIndex)}),meta_tooltip=tooltip_content.getRawSharedContent(chartObj,tooltipSharedInfo,meta_tooltip)}meta_tooltip.forEach(function(colidx,i){var temp,val,col=val="";if(metadata_columns[colidx]){if(meta_yaxes.length>1&&meta_yaxes.indexOf(colidx)>-1&&!sharedSeriesInfo){if(foundYColumnIndex)return;foundYColumnIndex=!0,meta_tooltip.forEach(function(d){meta_yaxes.indexOf(d)>-1&&(col+="{{col("+d+")}}",val+="{{val("+d+")}}")})}else col="{{col("+colidx+")}}",val="{{val("+colidx+")}}";temp=[col,val]}else temp=colidx;template.push(temp)})}return content=isColumnView?"<table cellspacing='0' cellpadding='0' border='0' style='border-spacing: 5px;'><tbody>"+(content=template.reduce(function(prev,cur){return prev+(isArray(cur)?"<tr style='vertical-align: top;'><td style='max-width:"+.4*maxWidth+"px;'>"+cur[0]+": </td><td style='max-width:"+.6*maxWidth+"px;'><b>"+cur[1]+"</b></td></tr>":"<tr style='vertical-align: top;'><td style='max-width:"+maxWidth+"px;'>"+cur+"</td></tr>")},""))+"</tbody></table>":template.reduce(function(prev,cur,i){return prev+(isArray(cur)?cur[0]+" : "+cur[1]:cur)+(i==template.length-1?"":"<br>")},""),forPrecalculation&&(content=content.replace(/{{clr}}/g,"black")),content},updateSharedInfo:function(chartObj,tooltipSharedInfo,seriespos){var dataset=chartObj.dataset,clrIdx=dataset.getColumnIdx("clr"),yidx=dataset.getColumnIdx("y",chartObj.seriesdata[seriespos].yaxiscolumnorder||[0,0]),repeat_pattern="{{val("+(chartObj.dataObject.pieWithAxis&&!chartObj.dataObject.isCombinationalChart?tooltip_helpers.getPieColumnIndex(chartObj):yidx)+")}}";tooltipSharedInfo.y_val_pattern=tooltipSharedInfo.y_val_pattern||"",tooltipSharedInfo.y_col_pattern=tooltipSharedInfo.y_col_pattern||"",-1==tooltipSharedInfo.y_val_pattern.indexOf(repeat_pattern)&&(tooltipSharedInfo.y_val_pattern+=repeat_pattern,tooltipSharedInfo.y_col_pattern+=chartObj.ismultiy||isUndefined(clrIdx)?""!=tooltipSharedInfo.y_col_pattern?"":"{{val(null)}}":"{{val("+clrIdx+")}}")},getRawSharedContent:function(chartObj,tooltipSharedInfo,meta_tooltip){var metadata=chartObj.systemConf.metadata,metadata_axes=metadata.axes,metadata_columns=metadata.columns,meta_yaxes=d3_merge(metadata_axes.y),dataset=chartObj.dataset,content=[],curPattern="",pieIdx=chartObj.dataObject.pieWithAxis&&!chartObj.dataObject.isCombinationalChart?tooltip_helpers.getPieColumnIndex(chartObj):NULL,hasCustomTooltip=meta_tooltip.some(function(d){return CUSTOM_VALUE_PATTERN.lastIndex=0,"string"==typeof d&&CUSTOM_VALUE_PATTERN.test(d)}),hasRepeatPattern=function(yidx){var repeatIndex=defined(pieIdx)?pieIdx:yidx;return(isArray(curPattern)?curPattern:[curPattern]).some(function(cur){return"string"==typeof cur&&(-1!=cur.indexOf("{{val("+repeatIndex+")}}")||-1!=cur.indexOf("{{per("+repeatIndex+")}}"))})},repeat=chartObj.isAxisCategory;if(hasCustomTooltip)meta_tooltip.forEach(function(pattern,i){defined(metadata_columns[pattern])&&(pattern=["{{col("+pattern+")}}","{{val("+pattern+")}}"]),curPattern=pattern,(isArray(pattern)||"string"==typeof pattern)&&meta_yaxes.some(hasRepeatPattern)&&repeat?chartObj.seriesdata.forEach(function(){content.push(isArray(pattern)?d3_values(pattern):pattern)}):content.push(pattern)});else{var x_pattern="{{val("+dataset.getColumnIdx("x")+")}}",y_pattern=tooltipSharedInfo.y_val_pattern,x_val=x_pattern,y_val=["<div style='margin-right:0.2em;display:inline-block;vertical-align:middle;border-radius: 50%;padding:0.4em;background:{{clr}}''></div>"+tooltipSharedInfo.y_col_pattern,y_pattern];content.push(x_val),chartObj.dataObject.pieWithAxis&&!chartObj.dataObject.isCombinationalChart&&(content.push(["{{col("+dataset.getColumnIdx("y",0)+")}}","{{val("+dataset.getColumnIdx("y",0)+")}}"]),content.push(["{{col("+dataset.getColumnIdx("z")+")}}","{{val("+dataset.getColumnIdx("z")+")}}"])),repeat?chartObj.seriesdata.forEach(function(){content.push(d3_values(y_val))}):content.push(d3_values(y_val))}return content}},tooltip_block_helpers={MAXHEIGHT_BLOCK:"50%",updatePlotarea4BlockTooltip:function(chartObj){var tooltipConfig=chartObj.systemConf.tooltip,blockConfig=tooltipConfig.block||{},tooltipPosition=tooltipConfig.position||"relative";if(tooltipConfig.enabled&&"block"===tooltipPosition){if(isUndefined(tooltipConfig.height)&&!tooltipConfig.content)events.tooltip(chartObj.tooltip.element,chartObj.systemConf,chartObj).initialize(),chartObj.tooltip.element.selectAll("div#tooltipcontent").html(tooltip_content.getContentTemplate(chartObj,NULL,NULL,!0)),chartObj.tooltip.preCalculatedHeight=chartObj.tooltip.element.node().clientHeight;else chartObj.tooltip.preCalculatedHeight="20%";var plotarea=chartObj.plotarea;chartObj.tooltip.blockarea=simpleClone(plotarea);var vAlign=blockConfig.vAlign||TOP_ALIGN,parsedBorderWidth=parseShortHandValue(pick(tooltipConfig.borderWidth,1)),borderWidthTop=parsedBorderWidth.top,borderWidthRight=parsedBorderWidth.right,borderWidthBottom=parsedBorderWidth.bottom,borderWidthLeft=parsedBorderWidth.left,chartarea=chartObj.chartarea,availableWidth=chartarea.width-borderWidthLeft-borderWidthRight,availableHeight=chartarea.height,dim=tooltip_helpers.getSize(tooltipConfig,[availableWidth,availableHeight],["100%",chartObj.tooltip.preCalculatedHeight]),h=mathMin(dim.h,perToPx(tooltip_block_helpers.MAXHEIGHT_BLOCK,availableHeight))+borderWidthTop+borderWidthBottom;vAlign===CENTER_ALIGN&&(vAlign=TOP_ALIGN),plotarea.height-=h,plotarea[vAlign]+=h}}},nonLinearOrdinalScale=function(){var range,domain,rangeBands,rangeExtent,ranges;function scale(x){return range?range.get(x):null}return scale.domain=function(_){return arguments.length?(domain=_,scale):domain},scale.rangeBand=function(){return 0},scale.rangeBands=function(x){if(!arguments.length)return rangeBands;if(null==x)return scale;ranges=x,rangeBands=new d3_map,range=new d3_map;for(var i=-1,n=x.length;++i<n;)range.set(i,x[i][0]),rangeBands.set(i,x[i][1]-x[i][0]);return scale},scale.discreteWidth=function(x){return rangeBands?rangeBands.get(x):null},scale.range=function(_){return arguments.length?(rangeExtent=_,scale):rangeExtent},scale.copy=function(){return nonLinearOrdinalScale().domain(domain).rangeBands(ranges).range(rangeExtent)},scale},date_utils=function(formatConf){formatConf=pick(formatConf,{}),this.startWeekDay=defined(formatConf.startWeekDay)?formatConf.startWeekDay:1,this.startMonth=defined(formatConf.startMonth)?formatConf.startMonth:0};function getBoundBoxColor(actualColor,properties,chartObj,data,index){var data_length=data.length;return actualColor||function(d,k){var clrIndex=properties.reverseColor?data_length-1-k:(chartObj.isAxisCategory||chartObj.isNonAxisMultiSeriesCategory||chartObj.dataObject.isPolarAxisCategory||chartObj.isGeoMap)&&!properties.multiColoring?index:k;return getRawColor(chartObj,clrIndex,d&&d.data?d.data:d,index)}}function getMergedBoundBoxOptions(dataLabels,chartObj){return mergeJSON(chartObj.systemConf.chart.plot.datalabels.boundBox,dataLabels.boundBox,!0)}function isBoundBoxEnabled(dataLabels,chartObj){return!0===getValByPriority([dataLabels.boundBox||{},chartObj.systemConf.chart.plot.datalabels.boundBox||{}],"show")}function getBoundBoxPadding(dataLabels,chartObj){return mathMax(validateNullVal(getValByPriority([dataLabels.boundBox||{},chartObj.systemConf.chart.plot.datalabels.boundBox||{}],"padding"),2),0)}function getBoundBoxStrokeWidth(dataLabels,chartObj){return validateNullVal(getValByPriority([dataLabels.boundBox||{},chartObj.systemConf.chart.plot.datalabels.boundBox||{}],"strokeWidth"),1)}function getSizeToBeAdded(defaultWidth,padding,radius,hookWidth){return mathMax(2*(radius||0)+hookWidth-defaultWidth-2*padding,0)}function getBoundBoxHookConf(hookOptions){var hookEnabled=!0===(hookOptions=hookOptions||{}).enabled,obj={};return obj.enabled=hookEnabled,obj.width=hookEnabled?defined(hookOptions.width)?+hookOptions.width:10:0,obj.height=hookEnabled?defined(hookOptions.height)?+hookOptions.height:4:0,obj}function getMergedDatalabelOptions(commonPlotOptions,plotoptions,chartObj,index){var options=plotoptions&&plotoptions.datalabels?mergeJSON(commonPlotOptions.datalabels,plotoptions.datalabels,!0):commonPlotOptions.datalabels;return chartObj&&function(options,chartObj,index){var userInnerLabel,userParentLabel,userStackLabel,systemConfInnerLabel,systemConfParentLabel,systemConfStackLabel,chartName=chartObj.chartTypes[index].name,userDatalabels=isObjectPropDefined(chartObj.userdata,"chart.plot.plotoptions."+chartName+".datalabels",!0)||{},userSeriesSpecificDatalabels=isObjectPropDefined(chartObj.seriesdata[index],"plotoptions.datalabels",!0)||{};(userSeriesSpecificDatalabels.showAs||userDatalabels.showAs)&&(options.showAs=userSeriesSpecificDatalabels.showAs||userDatalabels.showAs||options.showAs);(userInnerLabel=userDatalabels.innerLabel)?((systemConfInnerLabel=options.innerLabel).showAs=userInnerLabel.showAs||systemConfInnerLabel.showAs,(userParentLabel=userInnerLabel.parentLabel)&&((systemConfParentLabel=options.innerLabel.parentLabel).showAs=userParentLabel.showAs||systemConfParentLabel.showAs)):(userStackLabel=userDatalabels.stackLabels)&&((systemConfStackLabel=options.stackLabels).showAs=userStackLabel.showAs||systemConfStackLabel.showAs)}(options,chartObj,index),options}function applyDatalabelFonts(labelseries,dataLabels,chartObj,seriesColor,inner,seriesIndex,isStackLabel){var systemconf=chartObj.systemConf;return isArray(seriesColor)&&defined(seriesIndex)&&(seriesColor=seriesColor[seriesIndex]),applyFont(labelseries,[{fontColor:getLabelFontColor(systemconf,seriesColor,dataLabels,chartObj,inner,seriesIndex,isStackLabel)},dataLabels,systemconf.chart.plot.datalabels,systemconf.chart,systemconf.canvas,$ZCG])}function getLabelFontColor(systemconf,seriesColor,datalabelOptions,chartObj,inner,seriesIndex,isStackLabel){var fontColor=datalabelOptions.fontColor;if("function"==typeof fontColor){var userColor=invokeFunction(fontColor,seriesColor,chartObj);if(defined(userColor))return userColor}var boundBoxColor,globalDatalabelOptions=getPropVal(chartObj.systemConf,"chart.plot.datalabels")||{},mapLabelOptions=getPropVal(chartObj.systemConf,"map.labels")||{},dataLabelColor=chartObj.isGeoMap?pick(globalDatalabelOptions.fontColor,mapLabelOptions.fontColor):globalDatalabelOptions.fontColor,chartNumber=chartObj.chartTypes[seriesIndex||0].value,imagePalletUsed=defined(systemconf.legend.imagePallete),stacked=chartObj.dataObject.isstacked(chartNumber),isStackedBar=isBarChartType(chartNumber)&&stacked&&!0!==isStackLabel;isBoundBoxEnabled(datalabelOptions,chartObj)&&(boundBoxColor=getMergedBoundBoxOptions(datalabelOptions,chartObj).fillColor||seriesColor);if(fontColor===UNDEFINED&&dataLabelColor===UNDEFINED){if(boundBoxColor&&boundBoxColor!==TRANSPARENT)return getContrastColor(boundBoxColor);if(inner&&imagePalletUsed)return"#444444";if(inner&&chartcategory.innerLabels.indexOf(chartNumber)>-1||isStackedBar||chartcategory.datalabelsInside.indexOf(chartNumber)>-1)return getContrastColor(seriesColor)}return(imagePalletUsed||(defined(fontColor)||null!==dataLabelColor)&&null!==fontColor?fontColor:seriesColor)||pick(dataLabelColor,systemconf.chart.fontColor,systemconf.canvas.fontColor,$ZCG.fontColor)}function isLabelWithinBound(labelbound,plotbound){return!(labelbound.x1<plotbound.x1||labelbound.y1<plotbound.y1||labelbound.x2>plotbound.x2||labelbound.y2>plotbound.y2)}function isDatalabelEnabled(dataLabels,chartObj){if(datacount_based_intelligence(chartObj,DATALABELS_LABELTYPE)){var labelMeta=chartObj.systemConf.metadata.axes.label;return labelMeta&&defined(labelMeta[0])||!0===getValByPriority([dataLabels,chartObj.systemConf.chart.plot.datalabels],"show")}return!1}function isStacklabelEnabled(stackLabels,chartObj){return chartObj.dataObject.noofBarEnabledSeries&&chartObj.dataObject.isstacked()&&!chartObj.dataObject.isStackedPercentChart&&stackLabels&&stackLabels.show}function callTrimText(labelText,chartObj,tranform,fontSize,edge,xy){var dx=+tranform[0],dy=+tranform[1],plotarea=chartObj.plotarea,margin={left:-fontSize,right:-fontSize,top:0,bottom:0},orient=BOTTOM_ALIGN;edge=edge||{left:-dx,top:-dy,right:plotarea.width-dx,bottom:plotarea.height-dy},labelText.each(function(){var bb=bbox(this),textBound={left:bb.x+(xy?xy[0]:0),top:bb.y+(xy?xy[1]:0),width:bb.width,height:bb.height};trimText(this,this.textContent,textBound,edge,orient,"..",margin)})}function getLabelHolder(chartObj){return chartObj.staticPaneSVG.select(".labelholder")}function isLabelsEnabledForChart(chartObj,type){var showLabel,showStackLabels,systemconf=chartObj.systemConf,dataObj=chartObj.dataObject,stacked=(dataObj.getAxisRotated(),dataObj.isstacked()),hasBarSeries=dataObj.noofBarEnabledSeries,isYaxis="y"===type;if(showLabel=chartObj.seriesdata.some(function(series,i){if(!series.disabled){var plotoptions=series.plotoptions;return isDatalabelEnabled(getMergedDatalabelOptions(systemconf.chart.plot.plotoptions[chartObj.chartTypes[i].name],plotoptions),chartObj)}}),isYaxis&&hasBarSeries&&stacked&&!dataObj.isStackedPercentChart){var groupedByStack=chartObj.dataObject.groupedByStack,group=groupedByStack.get(groupedByStack.keys()[0]),seriesIndex=group&&group.stackLabelIndex,stackedLabels=systemconf.chart.plot.plotoptions[chartObj.chartTypes[seriesIndex].name].datalabels.stackLabels||{};showStackLabels=!!stackedLabels&&stackedLabels.show}return showLabel||showStackLabels}function dataLabelEnabled(chartInstance){var systemConfig=chartInstance.systemConf;if(chartInstance.dataObject.totalnoofdatas>+systemConfig.canvas.intelligence.dataCount.datalabels)return!1;if(!0===getPropVal(systemConfig.chart,"plot.datalabels.show"))return!0;for(var seriesData=chartInstance.seriesdata,len=seriesData.length;len--;){var commonPlotOptions=systemConfig.chart.plot.plotoptions[chartInstance.chartTypes[len].name],datalabels=commonPlotOptions.datalabels;if(defined(seriesData[len].plotoptions)&&(datalabels=getMergedDatalabelOptions(commonPlotOptions,seriesData[len].plotoptions)),isDatalabelEnabled(datalabels,chartInstance))return!0}return!1}function getBisectedValue(mousePos,arr,type,axisrotated,axisReversed){var bisectVal="y"==type?axisrotated?mousePos.x:mousePos.y:axisrotated?mousePos.y:mousePos.x,rangeReversed=axisrotated&&!axisReversed||!axisrotated&&axisReversed,xbisect=d3_bisector("y"==type?rangeReversed?d3_ascending:d3_descending:rangeReversed?d3_descending:d3_ascending).left(arr,bisectVal,0,axisrotated&&axisReversed?arr.length:arr.length-1),toCmp1=axisrotated?bisectVal:arr[xbisect],toCmp2=axisrotated?arr[xbisect-1]:bisectVal;return xbisect>0&&toCmp1>toCmp2?xbisect-1:xbisect}function getOuterPaddingInPixel(plotSize,count,padding,userOuterPadding,step){var outerPadding=scale$1.getOuterPadding(plotSize,count,padding,userOuterPadding);return 2*(mathMin(plotSize[0],plotSize[1])+step*outerPadding)}function getOrdinalRange(scaleObj){return scaleObj.ordinalRange?scaleObj.ordinalRange:(scaleObj.ordinalRange=scaleObj.domain().map(function(d){return scaleObj(d)}),scaleObj.ordinalRange)}date_utils.MILLISEC=0,date_utils.SECOND=1,date_utils.MINUTE=2,date_utils.HOUR=3,date_utils.DATE=4,date_utils.MONTH=5,date_utils.SECOND_TYPE="ABSSECOND",date_utils.MINUTE_TYPE="ABSMINUTE",date_utils.HOUR_TYPE="ABSHOUR",date_utils.DAY_TYPE="ABSDAY",date_utils.DATETIME_TYPE="DATETIME",date_utils.DATE_TYPE="DATE",date_utils.ABSWEEK_TYPE="ABSWEEK",date_utils.ABSMONTH_TYPE="ABSMONTH",date_utils.ABSQUARTER_TYPE="ABSQUARTER",date_utils.ABSYEAR_TYPE="YEAR",date_utils.D3_WEEKDAY_FNS=[d3_timeSunday,d3_timeMonday,d3_timeTuesday,d3_timeWednesday,d3_timeThursday,d3_timeFriday,d3_timeSaturday],date_utils.DAY_MILLIS=864e5,date_utils.prototype.setZero=function(dateVal,type){for(var oldVal=0,i=0;i<=type;i++)switch(i){case date_utils.MILLISEC:oldVal+=this.getMilliseconds(dateVal),this.setMilliseconds(dateVal,0);break;case date_utils.SECOND:oldVal+=this.getSeconds(dateVal),this.setSeconds(dateVal,0);break;case date_utils.MINUTE:oldVal+=this.getMinutes(dateVal),this.setMinutes(dateVal,0);break;case date_utils.HOUR:oldVal+=this.getHours(dateVal),this.setHours(dateVal,0);break;case date_utils.DATE:oldVal+=this.getDate(dateVal)-1,this.setDate(dateVal,1);break;case date_utils.MONTH:oldVal+=this.getMonth(dateVal),this.setMonth(dateVal,this.startMonth);break;default:throw"unknown type 333: "+type}return oldVal},date_utils.prototype.getBaseValue=function(dateVal,type,isCeil){switch(type){case date_utils.SECOND_TYPE:case date_utils.DATETIME_TYPE:var oldVal=this.setZero(dateVal,date_utils.MILLISEC);isCeil&&oldVal>0&&this.setSeconds(dateVal,this.getSeconds(dateVal)+1);break;case date_utils.MINUTE_TYPE:oldVal=this.setZero(dateVal,date_utils.SECOND);isCeil&&oldVal>0&&this.setMinutes(dateVal,this.getMinutes(dateVal)+1);break;case date_utils.HOUR_TYPE:oldVal=this.setZero(dateVal,date_utils.MINUTE);isCeil&&oldVal>0&&this.setHours(dateVal,this.getHours(dateVal)+1);break;case date_utils.DAY_TYPE:case date_utils.DATE_TYPE:oldVal=this.setZero(dateVal,date_utils.HOUR);isCeil&&oldVal>0&&this.setDate(dateVal,this.getDate(dateVal)+1);break;case date_utils.ABSWEEK_TYPE:oldVal=this.setZero(dateVal,date_utils.SECOND);var startWeekDay=this.startWeekDay;isCeil?(oldVal>0&&this.setDate(dateVal,this.getDate(dateVal)+1),startWeekDay<this.getDay(dateVal)?this.setDate(dateVal,this.getDate(dateVal)+(7-this.getDay(dateVal)+startWeekDay)):this.setDate(dateVal,this.getDate(dateVal)+(startWeekDay-this.getDay(dateVal)))):startWeekDay>this.getDay(dateVal)?this.setDate(dateVal,this.getDate(dateVal)-(7-startWeekDay+this.getDay(dateVal))):this.setDate(dateVal,this.getDate(dateVal)-(this.getDay(dateVal)-startWeekDay));break;case date_utils.ABSQUARTER_TYPE:case date_utils.ABSMONTH_TYPE:oldVal=this.setZero(dateVal,date_utils.DATE);isCeil&&oldVal>0&&this.setMonth(dateVal,this.getMonth(dateVal)+1);break;case date_utils.ABSYEAR_TYPE:oldVal=this.setZero(dateVal,date_utils.MONTH);isCeil&&oldVal>this.startMonth&&this.setFullYear(dateVal,this.getFullYear(dateVal)+1);break;default:throw"unknow type 222: "+type}},date_utils.prototype.getTicksList=function(t0,t1,dt,type){for(var times=new Array,t1Time=t1.getTime(),time=t0.getTime(),t=new Date(time);time<=t1Time;){switch(times.push(t),t=new Date(time),type){case date_utils.SECOND_TYPE:case date_utils.DATETIME_TYPE:t.setTime(t.getTime()+1e3*mathFloor(dt));break;case date_utils.MINUTE_TYPE:t.setTime(t.getTime()+6e4*dt);break;case date_utils.HOUR_TYPE:t.setTime(t.getTime()+36e5*dt);break;case date_utils.DAY_TYPE:case date_utils.DATE_TYPE:t.setTime(t.getTime()+dt*date_utils.DAY_MILLIS);break;case date_utils.ABSWEEK_TYPE:this.setDate(t,this.getDate(t)+dt);break;case date_utils.ABSMONTH_TYPE:case date_utils.ABSQUARTER_TYPE:this.setMonth(t,this.getMonth(t)+dt);break;case date_utils.ABSYEAR_TYPE:this.setFullYear(t,this.getFullYear(t)+dt)}time=t.getTime()}return times},date_utils.prototype.range=function(minDate,maxDate,tickCount,type,tickInterval){switch(minDate=new Date(minDate.getTime()),maxDate=new Date(maxDate.getTime()),this.getBaseValue(minDate,type,!1),this.getBaseValue(maxDate,type,!0),type){case date_utils.SECOND_TYPE:case date_utils.DATETIME_TYPE:var minInterval=1,noOfSec=mathCeil((maxDate.getTime()-minDate.getTime())/1e3);return interval=getInterval(interval=mathCeil(noOfSec/tickCount)||minInterval,tickInterval),{TYPE:d3_timeSeconds,INTERVAL:interval,TICKS:this.getTicksList(minDate,maxDate,interval,type)};case date_utils.MINUTE_TYPE:minInterval=1;return interval=getInterval(interval=mathCeil((maxDate.getTime()-minDate.getTime())/(6e4*tickCount))||minInterval,tickInterval),{TYPE:d3_timeHours,INTERVAL:interval,TICKS:this.getTicksList(minDate,maxDate,interval,type)};case date_utils.HOUR_TYPE:minInterval=1;return interval=getInterval(interval=mathCeil((maxDate.getTime()-minDate.getTime())/(36e5*tickCount))||minInterval,tickInterval),{TYPE:d3_timeHours,INTERVAL:interval,TICKS:this.getTicksList(minDate,maxDate,interval,type)};case date_utils.DAY_TYPE:case date_utils.DATE_TYPE:minInterval=1;return interval=getInterval(interval=mathCeil((maxDate.getTime()-minDate.getTime())/(tickCount*date_utils.DAY_MILLIS))||minInterval,tickInterval),{TYPE:d3_timeDays,INTERVAL:interval,TICKS:this.getTicksList(minDate,maxDate,interval,type)};case date_utils.ABSWEEK_TYPE:minInterval=1;var interval_week=mathCeil((maxDate.getTime()-minDate.getTime())/(tickCount*date_utils.DAY_MILLIS*7));interval_week=getInterval(interval_week,tickInterval);var interval=7*mathCeil(interval_week)||minInterval;return{TYPE:d3_timeWeeks,INTERVAL:interval,TICKS:this.getTicksList(minDate,maxDate,interval,type)};case date_utils.ABSMONTH_TYPE:minInterval=1;return interval=getInterval(interval=mathCeil(this.getMonthsDiff(minDate,maxDate)/tickCount)||minInterval,tickInterval),{TYPE:d3_timeMonths,INTERVAL:interval,TICKS:this.getTicksList(minDate,maxDate,interval,type)};case date_utils.ABSQUARTER_TYPE:minInterval=1;var interval_month=this.getMonthsDiff(minDate,maxDate)/tickCount||minInterval,quarter=mathCeil(interval_month/3);return quarter=getInterval(quarter,tickInterval),{TYPE:d3_timeMonths,INTERVAL:interval=3*quarter,TICKS:this.getTicksList(minDate,maxDate,interval,type)};case date_utils.ABSYEAR_TYPE:minInterval=1;return interval=getInterval(interval=mathCeil((maxDate.getFullYear()-minDate.getFullYear())/tickCount)||minInterval,tickInterval),{TYPE:d3_timeYears,INTERVAL:interval,TICKS:this.getTicksList(minDate,maxDate,interval,type)};default:throw"UNKNOWN TYPE 111: "+type}function getInterval(actualInterval,userInterval){return null!=userInterval&&userInterval>=actualInterval?userInterval:actualInterval}},date_utils.MAX_DATE=new Date(2008,8,29,23,23,23,999),date_utils.prototype.getMaxDate=function(formatConf,specifierIndex){return getFormattedValue(formatConf,date_utils.MAX_DATE,TIME_DATATYPE,null,"axis",null,null,specifierIndex)},date_utils.prototype.getMonthsDiff=function(minDate,maxDate){return 12*(this.getFullYear(maxDate)-this.getFullYear(minDate))+(this.getMonth(maxDate)-this.getMonth(minDate))},date_utils.prototype.getYearsDiff=function(minDate,maxDate){return 12*(this.getFullYear(maxDate)-this.getFullYear(minDate))+(this.getMonth(maxDate)-this.getMonth(minDate))},date_utils.prototype.getFullYear=function(date){return null!=this.useUTC&&this.useUTC?date.getUTCFullYear():date.getFullYear()},date_utils.prototype.getMonth=function(date){return null!=this.useUTC&&this.useUTC?date.getUTCMonth():date.getMonth()},date_utils.prototype.getDay=function(date){return null!=this.useUTC&&this.useUTC?date.getUTCDay():date.getDay()},date_utils.prototype.getDate=function(date){return null!=this.useUTC&&this.useUTC?date.getUTCDate():date.getDate()},date_utils.prototype.getHours=function(date){return null!=this.useUTC&&this.useUTC?date.getUTCHours():date.getHours()},date_utils.prototype.getMinutes=function(date){return null!=this.useUTC&&this.useUTC?date.getUTCMinutes():date.getMinutes()},date_utils.prototype.getSeconds=function(date){return null!=this.useUTC&&this.useUTC?date.getUTCSeconds():date.getSeconds()},date_utils.prototype.getMilliseconds=function(date){return null!=this.useUTC&&this.useUTC?date.getUTCMilliseconds():date.getMilliseconds()},date_utils.prototype.setFullYear=function(date,val){return null!=this.useUTC&&this.useUTC?date.setUTCFullYear(val):date.setFullYear(val)},date_utils.prototype.setMonth=function(date,val){return null!=this.useUTC&&this.useUTC?date.setUTCMonth(val):date.setMonth(val)},date_utils.prototype.setDate=function(date,val){return null!=this.useUTC&&this.useUTC?date.setUTCDate(val):date.setDate(val)},date_utils.prototype.setHours=function(date,val){return null!=this.useUTC&&this.useUTC?date.setUTCHours(val):date.setHours(val)},date_utils.prototype.setMinutes=function(date,val){return null!=this.useUTC&&this.useUTC?date.setUTCMinutes(val):date.setMinutes(val)},date_utils.prototype.setSeconds=function(date,val){return null!=this.useUTC&&this.useUTC?date.setUTCSeconds(val):date.setSeconds(val)},date_utils.prototype.setMilliseconds=function(date,val){return null!=this.useUTC&&this.useUTC?date.setUTCMilliseconds(val):date.setMilliseconds(val)},colorscale_helpers.quantileScale=function(){var domain=[],range=[],quantiles=[];function scale(x){var index;return quantiles.forEach(function(d,i){x>=d[0]&&x<=d[1]&&(index=i)}),defined(index)?range[index]:null}return scale.domain=function(_){if(arguments.length){domain=_;for(var i=0;i<domain.length;i+=2)quantiles.push([domain[i],domain[i+1]]);return scale}return domain},scale.range=function(_){return arguments.length?(range=_,scale):range},scale.copy=function(){return colorscale_helpers.quantileScale().domain(domain).range(range)},scale},scale$1.getScale=function(chartObj,dataObj,plotarea,orient,index,dataset,type,extent,noOuterPadding){var scaleObj,domain,systemconf=chartObj.systemConf,datatype=dataset.getDataType(type,index),axis_data="x"===type?systemconf.chart.axes.xaxis:"clr"===type?systemconf.legend.colorBand:systemconf.chart.axes.yaxis[index||0],hierarchical=dataObj.hierarchical,hasCustomMinRange=defined(axis_data.minRange),hasCustomMaxRange=defined(axis_data.maxRange),cType=chartObj.chartTypes[0].name,commonPlotOptions=systemconf.chart.plot.plotoptions[cType],isPolar="dial"===cType||"web"===cType&&"x"===type,isHeatmap="heatmap"===cType,hasColorScale="clr"===type&&colorscale_helpers.isQuantileColorScale(chartObj),zoomedValue=isObjectPropDefined(systemconf,"chart.zoom."+type,!0),range=function(){var axisReversed=axis_data.reversed;if(isPolar)return axisReversed?[validateNullVal(commonPlotOptions.endAngle,2*mathPI),validateNullVal(commonPlotOptions.startAngle,0)]:[validateNullVal(commonPlotOptions.startAngle,0),validateNullVal(commonPlotOptions.endAngle,2*mathPI)];if("clr"===type)return chartObj.imagePallete||chartObj.seriesColor;if("z"===type){if(isHeatmap){var size=1;return[perToPx(commonPlotOptions.minSize,size,perToPx("25%",size)),perToPx(commonPlotOptions.maxSize,size,perToPx("100%",size))]}var zChartName;dataObj.isCombinationalChart?chartObj.chartTypes.some(function(d){if(chartcategory.bubble.has(d.value)||chartcategory.bubblePie.has(d.value))return zChartName=d.name,!0}):zChartName=cType;var zConf=systemconf.chart.plot.plotoptions[zChartName]||{},dim=mathMin(plotarea.width,plotarea.height),size=validateNullVal(zConf.size,1);return[perToPx(zConf.minSize,dim,perToPx("2.5%",dim))*size,perToPx(zConf.maxSize,dim,perToPx("25%",dim))*size]}var borderSize=dataObj.getPlotBorder();return axisReversed?"bottom"===orient||"top"==orient?[getPlotSize(chartObj,"width",plotarea)-borderSize.right,borderSize.left]:[borderSize.top,getPlotSize(chartObj,"height",plotarea)-borderSize.bottom]:"bottom"===orient||"top"==orient?[borderSize.left,getPlotSize(chartObj,"width",plotarea)-borderSize.right]:[getPlotSize(chartObj,"height",plotarea)-borderSize.bottom,borderSize.top]}(),padding=isPolar||isHeatmap||"x"!=type?0:validateNullVal(commonPlotOptions.padding,dataObj.noofBarEnabledSeries?.2:.9),outerPadding=isPolar||hasColorScale||isHeatmap||noOuterPadding?0:"y"===type?validateNullVal(axis_data.outerPadding,chartObj.datalabels.hasFixedPosition?1e-8:.05):null!=outerPadding?outerPadding:validateNullVal(commonPlotOptions.outerPadding,.02);switch(datatype){case"numeric":extent?domain=extent:"x"===type?domain=dataObj.getMinMaxX(0):"y"===type?domain=dataObj.getMinMaxY(index,outerPadding):"z"===type?domain=dataObj.getMinMaxZ():(domain=colorscale_helpers.getColorDomain(chartObj),range=colorscale_helpers.getProcessedColorRange(range,domain,axis_data,chartObj));var actualStart=domain[0],actualEnd=domain[1];if("NoData"==domain[0]&&"NoData"==domain[1]&&(domain=[0,0]),!zoomedValue&&(extent||"x"==type)){var correction=0==(diff=domain[1]-domain[0])?chartObj.plotarea.width/2:diff*outerPadding;domain[0]=hasCustomMinRange?domain[0]:domain[0]-correction,domain[1]=hasCustomMaxRange?domain[1]:domain[1]+correction}var actualRange=[(scaleObj=("clr"===type&&axis_data.ranges&&axis_data.ranges.length?colorscale_helpers.quantileScale:d3_scaleLinear)().domain(domain).range(range))(actualStart),scaleObj(actualEnd)];scaleObj.actualRange=actualRange,scaleObj.origRange=range;break;case"ordinal":if(extent)domain=extent;else if("clr"===type)domain=colorscale_helpers.getColorDomain(chartObj),range=colorscale_helpers.getProcessedColorRange(range,domain,axis_data,chartObj);else{var categories=dataObj.getCategories(type,index);domain=dataObj.getDomain(categories,!0)}var outerPaddingPx,d3_outerPadding=0,origRange=[range[0],range[1]];if(padding=1===domain.length?0:padding,outerPadding&&!noOuterPadding&&!isHeatmap&&"clr"!==type&&!isPolar){d3_outerPadding=scale$1.getOuterPadding(range,domain.length,padding,outerPadding);var range_correction=function(range,userOuterPadding,userOuterPadding_d3){var outerPaddingPx=0,outerPaddingPx_others=0,min2Max=range[0]<range[1],minPos=min2Max?0:1,maxPos=min2Max?1:0;(chartObj.datalabels.moduleExists&&dataLabelEnabled(chartObj)||dataObj.isBubbleEnabled)&&(outerPaddingPx_others=dataObj.extendOuterpadding(domain,range,systemconf,padding,userOuterPadding_d3,type,index));outerPaddingPx+=outerPaddingPx_others;var diff=mathAbs(range[1]-range[0]);return outerPaddingPx+=diff*userOuterPadding,range[minPos]=range[minPos]+outerPaddingPx,range[maxPos]=range[maxPos]-outerPaddingPx,{range:range,outerPaddingPx:outerPaddingPx}}(range,outerPadding,d3_outerPadding);range=range_correction.range,outerPaddingPx=range_correction.outerPaddingPx}scaleObj=("clr"===type?d3_scaleOrdinalOrg:d3_scaleOrdinal)().domain(domain),"clr"===type?scaleObj.range(range):scaleObj.range(range).paddingInner(padding).paddingOuter(0),getOrdinalRange(scaleObj),scaleObj.origRange=origRange,scaleObj.outerPaddingPx=outerPaddingPx||0;break;case"time":var column=dataset.getColumn(type,index),metaConf=column[column.datatype],subfunction=metaConf&&metaConf.subfunction,useUTC=pick(metaConf&&metaConf.useUTC,!1);domain=extent||("x"===type?dataObj.getMinMaxX(0):dataObj.getMinMaxY(index,0));var start=new Date(domain[0]),end=new Date(domain[1]);if(defined(subfunction)||(subfunction=getAutoTimeSubFunction(end-start).subFunction),!zoomedValue){if(!systemconf.chart.axes[type+"axis"].disableBaseValue){var dateInterval=new date_utils(metaConf);dateInterval.useUTC=useUTC,dateInterval.getBaseValue(start,subfunction,!1),dateInterval.getBaseValue(end,subfunction,!0)}if(actualStart=start,actualEnd=end,dataObj.isBubbleEnabled){var correctionOverBubbles=dataObj.overBubbles([start.getTime(),end.getTime()],type,"y"==type?index:null);start=new Date(start.getTime()-correctionOverBubbles[0]),end=new Date(end.getTime()+correctionOverBubbles[1])}var diff,outerPaddingCorrection=0==(diff=end.getTime()-start.getTime())?chartObj.plotarea.width/2:diff*outerPadding,correctionOverDatalabels=0==outerPadding?0:dataObj.getCorrectionOverDataLabels([start.getTime(),end.getTime()],"x");start=new Date(hasCustomMinRange?domain[0]:start.getTime()-outerPaddingCorrection-correctionOverDatalabels),end=new Date(hasCustomMaxRange?domain[1]:end.getTime()+outerPaddingCorrection+correctionOverDatalabels),domain=[start,end]}actualRange=[(scaleObj=d3_scaleTime().domain(domain).range(range))(actualStart),scaleObj(actualEnd)];scaleObj.actualRange=actualRange,scaleObj.origRange=range;break;case"ordinalNonLinear":categories=dataObj.getCategories(type,index);domain=dataObj.getDomain(categories);origRange=[range[0],range[1]];var rangeList=hierarchical.rangeList?hierarchical.rangeList[index-1]:null;(scaleObj=nonLinearOrdinalScale().domain(domain).range(range).rangeBands(rangeList)).origRange=origRange}return scaleObj.outerPadding=outerPadding,scaleObj},scale$1.getEventScale=function(chartObj,dataObj,plotarea,orient,index,dataset,type){dataset.getDataType(type,index);return scale$1.getScale(chartObj,dataObj,plotarea,orient,index,dataset,type)},scale$1.constructor=function(chartObj,orient,scaleFunc,eventscaleFunc){var scaleObj,defaultscaleFunc=scale$1.getScale,defaulteventscaleFunc=scale$1.getEventScale;scaleFunc=pick(scaleFunc,defaultscaleFunc),eventscaleFunc=pick(eventscaleFunc,defaulteventscaleFunc);switch(orient){case"left":scaleObj=chartObj.axes.rotated?getxscale():getyscale();break;case"bottom":scaleObj=chartObj.axes.rotated?getyscale():getxscale()}return scaleObj;function getxscale(){var processor=chartObj.dataObject,hierarchical=processor.hierarchical,levels=0,extent=chartObj.brush?chartObj.brush.extent:null,xaxes=chartObj.axes.x;if(chartObj.axes.x.scale=scaleFunc(chartObj,chartObj.dataObject,chartObj.plotarea,chartObj.axes.x.orient,0,chartObj.dataset,"x",extent),chartObj.axes.x.eventscale=null==eventscaleFunc?chartObj.axes.x.scale:eventscaleFunc(chartObj,chartObj.dataObject,chartObj.plotarea,chartObj.axes.x.orient,null,chartObj.dataset,"x"),defined(hierarchical)){chartObj.axes.x.rangeScale=chartObj.axes.x.scale.copy(),chartObj.axes.x.rangeScale.outerPaddingPx=chartObj.axes.x.scale.outerPaddingPx,hierarchical.groupByDiscreteTime&&chartObj.axes.x.rangeScale.domain(processor.getDomain(processor.getCategories("x"))),levels=hierarchical.finalDepth,hierarchical.setRanges(chartObj.axes.x.rangeScale);for(var i=0;i<levels;i++)xaxes.levels[i]||(xaxes.levels[i]={}),xaxes.levels[i].scale=scaleFunc(chartObj,processor,chartObj.plotarea,chartObj.axes.x.orient,i+1,chartObj.dataset,"x",extent,null)}return[{scale:chartObj.axes.x.scale}].concat(xaxes.levels)}function getyscale(){for(var splityaxes=chartObj.axes.y.count,yaxes=chartObj.axes.y,i=0;i<splityaxes;i++)yaxes.groups[i]||(yaxes.groups[i]={}),yaxes.groups[i].scale=scaleFunc(chartObj,chartObj.dataObject,chartObj.plotarea,chartObj.axes.y.orient,i,chartObj.dataset,"y"),yaxes.groups[i].eventscale=null==eventscaleFunc?yaxes.groups[i].scale:eventscaleFunc(chartObj,chartObj.dataObject,chartObj.plotarea,chartObj.axes.y.orient,i,chartObj.dataset,"y");return chartObj.axes.y.groups}},scale$1.invert=function(datatype,mousePos,scaleObj,axisrotated,type,axisReversed,useWithinBound){var actualPos;switch(datatype){case"numeric":case"time":var point="y"==type?axisrotated?mousePos.x:mousePos.y:axisrotated?mousePos.y:mousePos.x;actualPos=scaleObj.invert(point);break;case"ordinal":var ordinalRange=getOrdinalRange(scaleObj),rangeBand=scaleObj.bandwidth(),maxBandwidth=scaleObj.maxBandWidth,actualWidth=maxBandwidth?mathMin(rangeBand,maxBandwidth):rangeBand,diffRange=ordinalRange.length>1?mathAbs(ordinalRange[1]-ordinalRange[0]):0,actualPadding=mathAbs(diffRange-rangeBand),padding_maxBandwidth=maxBandwidth&&maxBandwidth<rangeBand?(rangeBand-actualWidth)/2:0;actualPos=getBisectedValue(mousePos,ordinalRange=ordinalRange.map(function(d){return d-actualPadding/2}),type,axisrotated,axisReversed);var bisectVal="y"==type?axisrotated?mousePos.x:mousePos.y:axisrotated?mousePos.y:mousePos.x,x=scaleObj.ordinalRange[actualPos]+padding_maxBandwidth;useWithinBound&&!isWithinRange(bisectVal,[x,x+actualWidth])&&(actualPos=null)}return actualPos},scale$1.ordinalSubInvert=function(mousePos,itemPos,scaleObj,primaryScale,axisrotated,type,axisReversed){var rangeBand=scaleObj.bandwidth(),range=scaleObj.range(),primaryRange=primaryScale.ordinalRange,domain=scaleObj.domain(),padding=range[1]-range[0]-domain.length*rangeBand;return getBisectedValue(mousePos,domain.map(function(d,i){return primaryRange[itemPos]+i*(rangeBand+padding)}),type,axisrotated,axisReversed)},scale$1.barBandwidth=function(chartObj){var systemconf=chartObj.systemConf,dataObj=chartObj.dataObject,temp=chartObj.chartTypes[0],allChartTypes=chartObj.dataset.seriesTypes,barType=dataObj.barChartType||(dataObj.noofBarEnabledSeries?allChartTypes.has(charttype.stkdbar)?charttype.stkdbar:allChartTypes.has(charttype.bar)?charttype.bar:allChartTypes.has(charttype.bullet)?charttype.bullet:allChartTypes.has(charttype.waterfall)?charttype.waterfall:temp.value:temp.value);dataObj.barChartType=barType;var m=dataObj.isstacked(barType)?dataObj.groupedByStack.keys().length||1:d3_sum(chartObj.seriesdata.map(function(d){if(dataObj.isBarEnabled(d))return d.data.length})),cType=temp.name,isBullet=temp.value==charttype.bullet,plotBorderOptions=(isHeatMapChartType(temp.value),systemconf.chart.plot.border),borderSize=!0===plotBorderOptions.show?plotBorderOptions.size:0,padding=("gantt"==cType||"bullet"==cType||"bar"==cType||"waterfall"==cType)&&systemconf.chart.plot.plotoptions[cType].padding||.2,interPadding=1==m?0:("bar"==cType||"gantt"==cType||"waterfall"==cType)&&systemconf.chart.plot.plotoptions[cType].interPadding||0,outerPadding=systemconf.chart.plot.plotoptions[cType].outerPadding;outerPadding=null!=outerPadding&&""!==outerPadding?outerPadding:.02;var barscale1,barscale2,n=chartObj.axes.x.scale.domain().length,range=chartObj.axes.rotated?[getPlotSize(chartObj,"height",chartObj.plotarea)-borderSize,borderSize]:[borderSize,getPlotSize(chartObj,"width",chartObj.plotarea)-borderSize];outerPadding=scale$1.getOuterPadding(range,n,padding,outerPadding),(chartObj.datalabels.moduleExists&&dataLabelEnabled(chartObj)||dataObj.isBubbleEnabled)&&(outerPadding+=dataObj.extendOuterpadding(d3_range(n),range,systemconf,padding,outerPadding,"x")),chartObj.barscale1=barscale1=chartObj.axes.x.scale,chartObj.barscale2=barscale2=d3_scaleOrdinal().domain(d3_range(m)).range([0,barscale1.bandwidth()]).paddingInner(interPadding);var maxBandWidth=dataObj.noofBarEnabledSeries&&!isBullet?systemconf.chart.plot.plotoptions[cType].maxBandWidth||barscale1.bandwidth():200;if(barscale1.maxBandWidth=systemconf.chart.plot.plotoptions[cType].maxBandWidth,!isBullet&&barscale2.bandwidth()>maxBandWidth){var outspace=(barscale1.bandwidth()-m*maxBandWidth)/2;barscale2.range([outspace,barscale1.bandwidth()-outspace]).paddingInner(interPadding)}return[barscale1,barscale2]},scale$1.getOuterPadding=function(range,domainLength,padding,outerPadding){var rangeDiff=mathAbs(range[1]-range[0]),pad=outerPadding*rangeDiff;return pad/((rangeDiff-2*pad)/(domainLength-padding+0))},scale$1.getOrdinalOuterPadding=function(range,domainLength,padding,outerPadding){return outerPadding*mathAbs(range[1]-range[0])/2},scale$1.getContinuousRangeBand=function(scaleObj,points,index){var firstPointSpan=scaleObj(points[0]),currentPointSpan=index&&points[index]?scaleObj(points[index]):firstPointSpan,rangeBand=(index&&points[index+1]?scaleObj(points[index+1]):scaleObj(points[1]))-currentPointSpan,ranges=scaleObj.range();return{outerPaddingInPixel:(rangeBand<0?-1:1)*mathMin(mathAbs(firstPointSpan-ranges[0]),mathAbs(rangeBand/2)),rangeBand:rangeBand/2}},scale$1.getDiscreteRangeBand=function(scaleObj){var rangeBand=scaleObj.bandwidth(),outerPadding=scaleObj.outerPaddingPx+rangeBand/2,diffBand=scaleObj.domain().length>1?scaleObj.ordinalRange[1]-scaleObj.ordinalRange[0]-rangeBand:0;return{outerPaddingInPixel:mathMin(outerPadding,rangeBand/2+diffBand/2),rangeBand:rangeBand/2+diffBand/2}},scale$1.getRangeBand=function(scaleObj,points,index){return scaleObj.bandwidth?scale$1.getDiscreteRangeBand(scaleObj):scale$1.getContinuousRangeBand(scaleObj,points,index)};var plotScroll_svg={};plotScroll_svg.brush=function(chartObj,type,axisorder){var datatype,axisRotated,orient,isScrollNeed,overviewContext,isResizeInitiated,isResizeMoving,isClicked,resizeStartedPosition,scrollData=chartObj.systemConf.chart.scroll,defaultOptions={slider:{fillColor:"#B3B6B7",cursor:POINTER},tracker:{fillColor:"#ECF0F1",cursor:POINTER},resizer:{fillColor:NONE},scrollHeight:10},defaultItemSize=15,isOverviewEnabled=(scrollData.overview||{}).enabled,resizerEnabled=(scrollData.resizer||{}).enabled;function brush(selection){axisRotated=chartObj.dataObject.getAxisRotated(),orient=axisRotated?"left":"bottom";var preScrollBarLength=getScrollBarLength(chartObj.axes.x.scrollScale=scale$1.getScale(chartObj,chartObj.dataObject,chartObj.plotarea,orient,0,chartObj.dataset,type,null,!0),getCategoryPosScreen(chartObj,chartObj.plotarea));(isScrollNeed=Math.abs(preScrollBarLength-chartObj.plotarea[axisRotated?"height":"width"])>=1||resizerEnabled)?(brush.component=axisRotated?d3_brushY():d3_brushX(),brush.component.on("brush",function(){if(chartObj.isBrushing=!0,isResizeMoving&&isResizeInitiated)return isResizeMoving=!1,null;isResizeMoving=!!isResizeInitiated,brush.scrollNrender()}).on("start",function(){isResizeInitiated=!1,chartObj.isBrushing=!0;var mousePos=getActMousePos(d3$1.event.selection);mousePos[0]===mousePos[1]?brush.scrollNrender(!0):isResizeInitiated=!1}).on("end",function(){isResizeInitiated=!1,isResizeMoving=!1,chartObj.isBrushing=!1}),brush.context||(brush.context=appendEle(chartObj.svg,"g",[1],".","class","brush")),axisRotated?(chartObj.plotarea.width-=scrollData.height||defaultOptions.scrollHeight,brush.context.attr("transform","translate("+(chartObj.plotarea.left+chartObj.plotarea.width)+","+chartObj.plotarea.top+")")):(chartObj.plotarea.bottom+=scrollData.height||defaultOptions.scrollHeight,chartObj.plotarea.height-=scrollData.height||defaultOptions.scrollHeight,brush.context.attr("transform","translate("+chartObj.plotarea.left+","+(chartObj.plotarea.top+chartObj.plotarea.height)+")"))):chartObj.svg.selectAll("g.brush").remove()}return chartObj.isBrushing=null,brush.initialize=function(plotarea){if(isScrollNeed){datatype=chartObj.dataset.getDataType(type),orient=axisRotated?"left":"bottom",function(chartObj,plotarea,type){chartObj.axes.x.scrollScale=scale$1.getScale(chartObj,chartObj.dataObject,plotarea,orient,0,chartObj.dataset,type,null,!0)}(chartObj,plotarea,type),brush.categoryPosInScreen=getCategoryPosScreen(chartObj,plotarea),brush.extent=[];var selectionAttr=axisRotated?"y":"x",initialExtent=axisRotated?[{y:brush.categoryPosInScreen||.01,x:0},{y:plotarea.height,x:0}]:[{x:0,y:0},{x:brush.categoryPosInScreen||.01,y:0}];brush.setExtent(initialExtent),brush.initialized=!1,brush.context.call(brush.component),brush.context.call(brush.component.move,[initialExtent[0][selectionAttr],initialExtent[1][selectionAttr]]),brush.initialized=!0,isOverviewEnabled&&function(){var plotarea=chartObj.plotarea,userdata=simpleClone(chartObj.userdata);userdata.chart.scroll.enabled=!1,userdata.chart.axes.xaxis.show=!1,userdata.chart.axes.yaxis[0].show=!1,userdata.canvas.title.show=!1,userdata.canvas.subtitle.show=!1,userdata.chart.plot.renderer?userdata.chart.plot.renderer.mode="canvas":userdata.chart.plot?userdata.chart.plot.renderer={mode:"canvas"}:userdata.chart.plot={renderer:{mode:"canvas"}},userdata.chart.marginTop=0,userdata.chart.marginBottom=0,userdata.chart.marginLeft=0,userdata.chart.marginRight=0,userdata.canvas.intelligence={},userdata.credits&&(userdata.credits.show=!1),userdata.chart.plot.datalabels&&(userdata.chart.plot.datalabels.show=!1),userdata.legend.enabled=!1,(overviewContext=chartObj.container.selectAll("div.zcoverview")).styles({position:"absolute",width:plotarea.width+"px",height:+scrollData.height+"px","pointer-events":NONE,"box-sizing":"border-box"}),chartObj.overview={element:overviewContext,data:userdata}}(),function(){var tx,ty,translate=getSvgTransform(brush.context).translate;axisRotated?(tx=chartObj.plotarea.left+chartObj.plotarea.width,ty=chartObj.plotarea.top):(tx=chartObj.plotarea.left,ty=translate[1]);brush.context.attr("transform","translate("+tx+","+ty+")"),isOverviewEnabled&&overviewContext.styles({left:tx+"px",top:ty+"px"});var scrollDIM={};scrollDIM[axisRotated?"width":"height"]=scrollData.height||defaultOptions.scrollHeight;applyStyle(brush.context.selectAll("rect.selection"),scrollData.slider,defaultOptions.slider,scrollDIM),applyStyle(brush.context.selectAll("rect.overlay"),scrollData.tracker,defaultOptions.tracker,scrollDIM),applyStyle(brush.context.selectAll("rect.handle"),scrollData.resizer,defaultOptions.resizer,{}),removeResizer()}()}else chartObj.svg.selectAll("g.brush").remove()},brush.scrollNrender=function(update){brush.updateExtentPosition(update),brush.initialized&&(chartObj.updateScale(chartObj.seriesdata[0],type,brush.extent),chartObj.drawThreshold(!0),chartObj.drawPlotareaClippath(),chartObj.plot.renderer.draw(!0),chartObj.eventHandler.updateParams(chartObj))},brush.updateExtentPosition=function(update){var mousePos=function(eventSelection){var mousePos=getActMousePos(eventSelection),categoryPosInScreen=brush.categoryPosInScreen,scrollBarLength=brush.scrollBarLength||getScrollBarLength(chartObj.axes.x.scrollScale,categoryPosInScreen);if(brush.scrollBarLength=scrollBarLength,isClicked=!isResizeMoving&&mousePos[0]===mousePos[1],isResizeInitiated=isResizeInitiated||isClicked){if(!isClicked){var scrollBarOffset=scrollBarLength*(axisRotated?-1.5:.5);mousePos[0]+=mousePos[1]-resizeStartedPosition[1]+scrollBarOffset,mousePos[1]=mousePos[0]+scrollBarLength}mousePos[0]-=scrollBarLength/2,mousePos[1]-=scrollBarLength/2,axisRotated?(mousePos[0]=mousePos[0]<0?0:mousePos[0],mousePos[1]=mousePos[0]+scrollBarLength,mousePos[1]=mousePos[1]>chartObj.plotarea.height?chartObj.plotarea.height:mousePos[1],mousePos[0]=mousePos[1]-scrollBarLength):(mousePos[0]=mousePos[1]>chartObj.plotarea.width?mousePos[0]-(mousePos[1]-chartObj.plotarea.width):mousePos[0]<0?0:mousePos[0],mousePos[1]=mousePos[0]+scrollBarLength,mousePos[0]=mousePos[0]+scrollBarLength>chartObj.plotarea.width?mousePos[0]-(mousePos[1]-chartObj.plotarea.width):mousePos[0],mousePos[1]=mousePos[0]+scrollBarLength),isClicked&&(resizeStartedPosition=mousePos)}return mousePos}(d3$1.event.selection),selectionAttr=axisRotated?"y":"x",newExtent=getArrayAsXYObject(mousePos);brush.setExtent(newExtent),(update||isResizeMoving)&&(brush.context.call(brush.component.move,[newExtent[0][selectionAttr],newExtent[1][selectionAttr]]),removeResizer()),update&&(isClicked=!1)},brush.setExtent=function(mousePos){var brushLength=axisRotated?[scrollData.height,chartObj.plotarea.height]:[chartObj.plotarea.width,scrollData.height];brush.component.extent([[0,0],brushLength]);var customExtent=function(mousePos){var customExtent,x1=scale$1.invert(datatype,mousePos[0],chartObj.axes.x.scrollScale,axisRotated,type),x2=scale$1.invert(datatype,mousePos[1],chartObj.axes.x.scrollScale,axisRotated,type);customExtent=datatype==ORDINAL_DATATYPE?axisRotated?chartObj.axes.x.scrollScale.domain().slice(x2,x1+1,0):chartObj.axes.x.scrollScale.domain().slice(x1,x2+1,0):[x1,x2];return customExtent}(mousePos);brush.extent=customExtent},brush;function getArrayAsXYObject(arr){return axisRotated?[{x:0,y:arr[0]},{x:0,y:arr[1]}]:[{x:arr[0],y:0},{x:arr[1],y:0}]}function getActMousePos(eventSelection){if(datatype==ORDINAL_DATATYPE)return[eventSelection[0],eventSelection[1]];var selectionObj=getArrayAsXYObject(eventSelection),x1=scale$1.invert(datatype,selectionObj[0],chartObj.axes.x.scrollScale,axisRotated,type),x2=scale$1.invert(datatype,selectionObj[1],chartObj.axes.x.scrollScale,axisRotated,type);return[chartObj.axes.x.scrollScale(x1),chartObj.axes.x.scrollScale(x2)]}function applyStyle(ele,conf,defaultConf,scrollDIM){conf=conf||{},ele.styles({visibility:"visible",cursor:conf.cursor||defaultConf.cursor,fill:conf.fillColor||defaultConf.fillColor,"fill-opacity":conf.fillOpacity,"stroke-opacity":conf.strokeOpacity,"stroke-width":conf.strokeWidth,stroke:conf.strokeColor}).attrs({rx:conf.radius,ry:conf.radius,opacity:null}).attrs(scrollDIM)}function removeResizer(){(scrollData.resizer||{}).enabled||brush.context.selectAll(".handle").remove()}function getCategoryPosByCount(plotarea,padding,outerPadding,numVisibleCategories){var xCat,scrollScale=chartObj.axes.x.scrollScale,baseValue=axisRotated?plotarea.height:plotarea.width,actNumCategories=(xCat=(xCat=chartObj.dataObject.getCategories("x"))&&xCat.length?xCat:chartObj.dataObject.findXCategories()).length;return numVisibleCategories=numVisibleCategories>actNumCategories?actNumCategories:numVisibleCategories,scrollScale?function(scrollScale,index,value){return scrollScale.bandwidth?scrollScale.ordinalRange[index]:scrollScale(value)}(scrollScale,numVisibleCategories-1,xCat[numVisibleCategories-1]):mathFloor((baseValue-outerPadding)/actNumCategories*numVisibleCategories)}function getCategoryPosByThickness(plotarea,padding,outerPadding,thickness){var scrollScale=chartObj.axes.x.scrollScale,step=(axisRotated?plotarea.height:plotarea.width,function(rangeband,padding){return rangeband/(1-padding)}(thickness,padding)),numVisibleCategories=getVisibleNumCategories(chartObj,plotarea,outerPadding,step);return getCategoryPosByCount(plotarea,0,outerPadding=scrollScale&&scrollScale.bandwidth?getOuterPaddingInPixel(scrollScale.range(),numVisibleCategories,padding,outerPadding,step):step*outerPadding*2,numVisibleCategories=getVisibleNumCategories(chartObj,plotarea,outerPadding,step))}function getCategoryPosScreen(chartObj,plotarea){axisRotated?plotarea.height:plotarea.width;var numVisibleCategories=scrollData.visibleCategories,cType=chartObj.chartTypes[0].name,padding=("gantt"==cType||"bullet"==cType||"bar"==cType)&&chartObj.systemConf.chart.plot.plotoptions[cType].padding||.2,outerPadding=chartObj.systemConf.chart.plot.plotoptions[cType].outerPadding||.02;return numVisibleCategories?getCategoryPosByCount(plotarea,0,outerPadding,numVisibleCategories):getCategoryPosByThickness(plotarea,padding,outerPadding,scrollData.categoryThickness||defaultItemSize)}function getScrollBarLength(scrollScale,categoryPos){return scrollScale.bandwidth?axisRotated?scrollScale.range()[0]-categoryPos:categoryPos+scrollScale.bandwidth():axisRotated?scrollScale.range()[0]-categoryPos:categoryPos}function getVisibleNumCategories(chartObj,plotarea,outerPadding,step){return mathFloor(axisRotated?(plotarea.height-outerPadding)/step:(plotarea.width-outerPadding)/step)}};var annotation=function(){};function updateStackExtent(xCategories,pos,neg,pos_cascaded,neg_cascaded){var stackValues=[];return pos_cascaded?xCategories.forEach(function(x,j){pos[j]>=0&&stackValues.push([x,pos[j],pos_cascaded[j]]),neg[j]<0&&stackValues.push([x,neg[j],neg_cascaded[j]])}):xCategories.forEach(function(x,j){pos[j]>=0&&stackValues.push([x,pos[j]]),neg[j]<0&&stackValues.push([x,neg[j]])}),stackValues}function polarToXY(r,a){return[mathCos(a-=mathPI/2)*r,mathSin(a)*r]}function d0_360(a){return(a=a%(2*mathPI))<0?a+2*mathPI:a}function polarRefPoint(bb,w,h,r,SW){var leftWidth=0-(bb.x-.5*SW),rightWidth=bb.width+SW-leftWidth,topHeight=0-(bb.y-.5*SW);return[w/2-(r-leftWidth)/2+(r-rightWidth)/2,h/2-(r-topHeight)/2+(r-(bb.height+SW-topHeight))/2]}function getDY(angle){return d3_scaleLinear().range([0,1]).domain([angle<mathPI?mathPI/2:3*mathPI/2,mathPI])(angle)}function isAngleInside(theta1,theta2,angle){return theta2<theta1&&(theta2=theta1+((theta1=theta2)-theta2)),theta1<0&&theta2<0&&(theta1+=2*mathPI,theta2+=2*mathPI),theta1<0&&theta2>=0&&(angle<0?theta2=2*mathPI:theta1=0),theta1<=(angle=angle<0?angle+2*mathPI:angle)&&angle<=theta2}function radianToDegree(rad){return 180*rad/mathPI}function getInnerRadius(commonPlotOptions,rad){var hasCustomBandWidth=defined(commonPlotOptions.bandWidth)||commonPlotOptions.levelMarker&&defined(commonPlotOptions.levelMarker.bandWidth),hasCustomMaxBandWidth=defined(commonPlotOptions.maxBandWidth)||commonPlotOptions.levelMarker&&defined(commonPlotOptions.levelMarker.maxBandWidth),innerRadius=mathMax(0,perToPx(commonPlotOptions.innerRadius,rad,0));if(hasCustomBandWidth||hasCustomMaxBandWidth){var bandWidth=defined(commonPlotOptions.bandWidth)?perToPx(commonPlotOptions.bandWidth,rad,0):rad-innerRadius,levelMarkerBandWidth=defined(commonPlotOptions.levelMarker.bandWidth)?perToPx(commonPlotOptions.levelMarker.bandWidth,rad,0):rad-innerRadius,maxBandWidth=validateNullVal(commonPlotOptions.maxBandWidth,rad),maxLevelMarkerBandWidth=validateNullVal(commonPlotOptions.levelMarker.maxBandWidth,rad);return bandWidth=mathMin(bandWidth,maxBandWidth),levelMarkerBandWidth=mathMin(levelMarkerBandWidth,maxLevelMarkerBandWidth),rad-mathMax(bandWidth,levelMarkerBandWidth)}return mathMin(innerRadius,rad)}function callDatalableAndAnnotationRenderer(chartObj,args,enable,update){if(enable){if(labelRenderer&&args.labelQueue.length){var datalabelEvents=chartObj.systemConf.chart.plot.datalabels.events;stateChangeListener(chartObj,datalabelEvents,0,"init"),labelRenderer.drawLabelsFromQueue(args.labelQueue,args.labelArray,chartObj),stateChangeListener(chartObj,datalabelEvents,0,update?"onreload":"onload")}args.labelArray=[],args.labelQueue=[];var notes=chartObj.systemConf.notes;defined(notes)&&notes.enabled;args.notesArray=defined(notes)&&!0===notes.enabled?annotation.draw(chartObj,args.notesArray):[]}}function Chart(container,data){this.container=container,this.userdata=data,this.dataObject=null,this.dataset=null,this.svg=null,this.seriesColor=[],this.axes={x:{levels:[]},y:{groups:[]}},this.ismultiy=null,this.plotarea_approx=null,this.nochartdata=!1,this.chartRendered=!1,this.plot={},this.events={},VizLayout.call(this,container,data),this.initialize()}function HierarchicalDataAdapter(chartInstance){this.chart=chartInstance,this.originalSeries=chartInstance.seriesdata,this.initialize()}function HierarchicalOrdinalDataAdapter(chartInstance){DataProcessor.HierarchicalDataAdapter.call(this,chartInstance),this.dataType=ORDINAL_DATATYPE,this.categoryTree=!0,this.update(!0)}DataProcessor.prototype.getMinMaxX=function(correctionFactor){var temp,xAxisConfig=this.xaxisData,seriesData=this.processedseriesData,chart=this.chartObj,dataSet=this.dataset,customMin=xAxisConfig.minRange,customMax=xAxisConfig.maxRange,dataType=dataSet.getDataType("x"),extendX=this.xRange;if(correctionFactor=pick(correctionFactor,.05),isObjectPropDefined(chart.systemConf,"chart.zoom.x")){var xRange=chart.systemConf.chart.zoom.x;return[xRange.minRange,xRange.maxRange]}if(!defined(extendX)){temp=seriesData.map(function(d){return d.data.map(function(d){return d3_extent(d,function(d){return dataSet.getX(d)})})});var xAxis=pick(getPropVal(chart.userdata,"chart.axes.xaxis"),{});extendX=this.xRange=d3_extent(d3_merge(d3_merge(temp)).concat(this.getThresholdValues(xAxis)))}!this.isBubbleEnabled||dataType===TIME_DATATYPE||defined(customMin)||defined(customMax)||(temp=this.overBubbles(extendX,"x"),extendX=[extendX[0]-temp[0],extendX[1]+temp[1]]),this.needMarkerCorrection()&&dataType!==TIME_DATATYPE&&(temp=this.overMarker(extendX,"x",correctionFactor),extendX=[extendX[0]-temp[0],extendX[1]+temp[1]]);var diff,correction,correctionOverDatalabels=0;return dataType!==TIME_DATATYPE&&0!==correctionFactor&&(correctionOverDatalabels=this.getCorrectionOverDataLabels(extendX,"x")),0===(diff=extendX[1]-extendX[0])&&(diff=1),correction=diff*correctionFactor+correctionOverDatalabels,[pick(customMin,extendX[0]-correction,0),pick(customMax,extendX[1]+correction,0)]},DataProcessor.prototype.getMinMaxY=function(index,correctionFactor,excludeDatalabels){var temp,allChartTypes=this.allChartTypes,yAxisConfig=this.yaxesData,hasNegativeValue=this.hasNegativeValue,baseline=this.baseline,yRange=this.yRange,actual_yRange=this.actual_yRange,chart=this.chartObj,dataSet=this.dataset,stacked=this.isstacked()||this.isPercentChart,yAxisData=pick(yAxisConfig[index],{}),dataType=dataSet.getDataType("y",index),ganttSeriesCount=this.ganttSeries_count,minY=yAxisData.minRange,maxY=yAxisData.maxRange,correction=0,minMaxDataY=yRange[index],ismultiY=chart.getAxesCount("y")>1,isBarEnabledPerAxis=this.noofBarEnabledSeries,isAreaEnabledPerAxis=this.noofAreaEnabledSeries;if(baseline[index=pick(index,0)]=!0===getPropVal(yAxisData,"baseline.show")?yAxisData.baseline.value:null,ismultiY){var groupDataBySplitAxes=this.groupedDataBySplitAxes[index],chartTypes_splitAxes=groupDataBySplitAxes?groupDataBySplitAxes.map(function(d,i){return allChartTypes[d.si]}):[];isBarEnabledPerAxis=chartTypes_splitAxes.some(function(d){if(isBarChartType(d))return!0});isAreaEnabledPerAxis=chartTypes_splitAxes.some(function(d){if(d===charttype.area||d===charttype.stkdarea)return!0})}if(isObjectPropDefined(chart.systemConf,"chart.zoom.y")){var zoomedY=chart.systemConf.chart.zoom.y,zoomedYMinRange=zoomedY.minRange,zoomedYMaxRange=zoomedY.maxRange,baselineValue=baseline[index];return hasNegativeValue[index]=defined(baselineValue)&&!stacked&&baselineValue>=zoomedYMinRange&&baselineValue<=zoomedYMaxRange?baselineValue:zoomedYMinRange<0?0:null,[zoomedYMinRange,zoomedYMaxRange]}if(correctionFactor=pick(correctionFactor,chart.datalabels.hasFixedPosition?1e-8:.05),!defined(yRange[index])){this.isWaterfallEnabled?(yRange[index]=this.processDataForWaterFall(this,index),temp=yRange[index]):stacked?(yRange[index]=function(baseline,context){var dataset=context.dataset,data=context.data,chartObj=context.chartObj,processedseriesData=context.processedseriesData,groupedDataByCombo=context.groupedDataByCombo,groupedDataBySplitAxes=context.groupedDataBySplitAxes,categoriesStore=context.categoriesStore,groupedByStack=context.groupedByStack,dataObject=chartObj.dataObject,helpers=DataProcessor.helpers,grouped=context.isCombinationalChart||data.seriesdata.stackGroup?groupedDataByCombo.values():groupedDataBySplitAxes,xCategories=dataObject.getDomain(context.getCategories("x"),!0),xCategoriesLength=xCategories.length,groupByValues=categoriesStore.subseries,isCatNullX=helpers.isCatNull(dataset,"x"),minmaxY=[],lastSeriesY=[],stackeddata=grouped.map(function(d,i){var currType=groupedDataByCombo.keys()[i],split=currType.split("_"),cType=+split[0],groupIndex=defined(split[1])?+split[1]:i,isStkd=context.isstacked(cType)||context.isPercentChart,y0Positive=[],y0Negative=[];lastSeriesY[i]||(lastSeriesY[i]=[]);var dt=d3_merge(d.map(function(da,j){var seriesIndex=da.si,yaxiscolumnorder=helpers.getParsedYAxisOrder(processedseriesData[seriesIndex].yaxiscolumnorder);if(isStkd&&!isBarChartType(cType))for(var curSubseriesVal=da.d.map(function(d){return d.groupByVal}),idx=0;idx<groupByValues.length;idx++){var key=groupByValues[idx],havSubSeriesidx=curSubseriesVal.indexOf(key);if(havSubSeriesidx<0&&null!=key){da.d.splice(idx,0,[])}}var dt=da.d.map(function(d,k){if(isStkd&&!isBarChartType(cType)){for(var xMappingFunction=function(d){return dataset.getX(d)},currentkeys=d.map(xMappingFunction),idx=0,len=xCategoriesLength;idx<len;idx++){var key=xCategories[idx],haveKey=currentkeys.indexOf(key);if(haveKey>=0&&haveKey!=idx&&(d.splice(idx,0,d[haveKey]),d.splice(haveKey+1,1),currentkeys=d.map(xMappingFunction)),typeof currentkeys[idx]!=UNDEFINED&&isCatNullX(currentkeys[idx])&&d.splice(idx,1),haveKey<0){var duplicate=[],order=helpers.getParsedYAxisOrder(processedseriesData[da.si].yaxiscolumnorder);duplicate.splice(dataset.xidx,0,key),duplicate.splice(dataset.yidx(order),0,0),duplicate.isDummy=!0,d.splice(idx,0,duplicate),currentkeys=d.map(xMappingFunction)}}xCategoriesLength!=d.length&&d.splice(xCategoriesLength,d.length-xCategoriesLength)}return d.map(function(d){var x=dataset.getX(d),y=dataset.getY(d,yaxiscolumnorder)||0,xCategoryIndex=xCategories.indexOf(x),y0ArrayToBeUpdated=y<0?y0Negative:y0Positive,y0=y0ArrayToBeUpdated[xCategoryIndex];return isStkd?(y0=defined(y0)?y0:0,d.y0=y0,d.y=y,lastSeriesY[i][xCategoryIndex]=y0+y,y0ArrayToBeUpdated[xCategoryIndex]=y0+y):defined(y0)?y0ArrayToBeUpdated[xCategoryIndex]=(y<0?mathMin:mathMax)(y0,y):y0ArrayToBeUpdated[xCategoryIndex]=y,d})});return dt}));minmaxY[i]=d3_extent(d3_merge([y0Positive,y0Negative,[0]]));var chartName=charttypenames.get(cType);return isStkd&&(chartObj.datalabels.moduleExists&&(isStacklabelEnabled(data.chart.plot.plotoptions[chartName].datalabels.stackLabels,chartObj)||function(chartName,chartObj){var datalabelOptions=chartObj.systemConf.chart.plot.plotoptions[chartName].datalabels||{},showAs=(isObjectPropDefined(chartObj.userdata,"chart.plot.plotoptions."+chartName+".datalabels",!0)||{}).showAs||datalabelOptions.showAs;return showAs===PERCENT_SHOWAS||showAs===SPLITPERCENT_SHOWAS||showAs===MAXPERCENT_SHOWAS||PERCENT_PATTERN.test(showAs)}(chartName,chartObj))||PERCENT_PATTERN.test(data.metadata.axes.tooltip))&&(groupedByStack.has(groupIndex)||groupedByStack.set(groupIndex,{}),groupedByStack.get(groupIndex).stackExtent=updateStackExtent(xCategories,y0Positive,y0Negative)),dt});minmaxY=groupedDataBySplitAxes.length>1?minmaxY:[d3_extent(d3_merge(minmaxY))],(context.isStackedPercentChart||context.isPercentChart)&&(stackeddata.map(function(data,i){return data.map(function(series){return series.map(function(d){var xCategoryIndex=xCategories.indexOf(dataset.getX(d)),max=lastSeriesY[i][xCategoryIndex]||0;return 1!=isNaN(max)&&null!=max&&0!=max&&(d.y0/=max/100,d.y/=max/100),d})})}),minmaxY[0][0]=0,minmaxY[0][1]=100);return minmaxY}(baseline[index],this),temp=yRange[index][index]):(yRange[index]=function(index,dataObj){var yValues=d3_merge(dataObj.seriesExtermes[index]);return 0!=yValues.length?d3_extent(yValues):yValues.enabled?[0,0]:null}(index,this),temp=yRange[index]);var levelMarkerMinMax,yAxis=pick(getPropVal(chart.userdata,"chart.axes.yaxis["+index+"]"),{});defined(temp)&&(temp=d3_extent(temp.concat(this.getThresholdValues(yAxis)))),(this.hasLevelMarker||isBarEnabledPerAxis&&!ganttSeriesCount)&&(levelMarkerMinMax=this.overLevelMarker(temp)),stacked?(actual_yRange[index]=actual_yRange[index]||[])[index]=yRange[index][index]=pick(levelMarkerMinMax,temp):actual_yRange[index]=yRange[index]=pick(levelMarkerMinMax,temp),minMaxDataY=yRange[index]}if(!defined(minMaxDataY)||stacked&&!defined(minMaxDataY[index]))return["NoData","NoData"];var extentY=stacked?minMaxDataY[index]:minMaxDataY;hasNegativeValue[index]=dataType===TIME_DATATYPE?null:defined(baseline[index])&&!stacked?baseline[index]:yAxisData.minRange<0||extentY[0]<0?0:null;var hasDefaultBase=(isBarEnabledPerAxis||isAreaEnabledPerAxis)&&dataType==NUMERIC_DATATYPE,hasDefaultMin=hasDefaultBase&&(null==hasNegativeValue[index]||hasNegativeValue[index]>0);hasDefaultBase&&extentY[1]-extentY[0]==0&&(extentY=d3_extent(d3_merge([extentY,[0]]))),!this.isBubbleEnabled||dataType===TIME_DATATYPE||defined(yAxisData.minRange)||defined(yAxisData.maxRange)||(extentY[0]=hasDefaultMin?0:extentY[0],temp=this.overBubbles(extentY,"y",index),extentY=[extentY[0]-temp[0],extentY[1]+temp[1]]),this.needMarkerCorrection()&&dataType!==TIME_DATATYPE&&(temp=this.overMarker(extentY,"y",index,correctionFactor),extentY=[hasDefaultMin?0:extentY[0]-temp[0],extentY[1]+temp[1]]);var diff=extentY[1]-extentY[0];0===diff&&(diff=1),this.isStackedPercentChart||this.isPercentChart||this.hasLevelMarker||this.isWaterfallEnabled||(correction=diff*correctionFactor),defined(minY)||(minY=hasDefaultMin?0:extentY[0]-correction),defined(maxY)||(maxY=extentY[1]+correction);var correctionOverDatalabels=0;"time"===dataType||0===correctionFactor||excludeDatalabels||(correctionOverDatalabels=chart.datalabels.hasFixedPosition&&defined(yAxisData.maxRange)&&yAxisData.maxRange<=extentY[1]?0:this.getCorrectionOverDataLabels([minY,maxY],"y",index));if(hasDefaultMin||chart.datalabels.hasFixedPosition||(minY=minY-correctionOverDatalabels||0),maxY=maxY+correctionOverDatalabels||0,this.isWaterfallEnabled){var domain=this.getCorrectionForWaterfall([minY,maxY],"y",index,chart,correctionOverDatalabels);minY=domain[0],maxY=domain[1]}return[minY,maxY]},DataProcessor.prototype.ZC_BAR_getRangeY=function(chartObj,yaxiscolumnorder){var actual_yRange=chartObj.dataObject.actual_yRange[yaxiscolumnorder];return d3_extent(d3_merge([actual_yRange,[0]]))},DataProcessor.prototype.getCategories=function(type,index){var categories,chart=this.chartObj,hierarchical=chart.dataObject.hierarchical,categoriesStore=this.categoriesStore;return isObjectPropDefined(chart.systemConf,"chart.zoom."+type+".categories")?chart.systemConf.chart.zoom[type].categories:("x"===type?(categories=defined(hierarchical)?hierarchical.groupByTime?index>0?hierarchical.categoriesList[index-1]:hierarchical.groupByDiscreteTime?pick(this.xaxisData.categories,categoriesStore.x.sort(d3.ascending)):hierarchical.leafCategories:index>0?hierarchical.categoriesList[index-1]:hierarchical.leafCategories:this.xaxisData.categories,index=""):categories=this.yaxesData[index].categories,defined(categories)&&0!==categories.length||(categories=categoriesStore[type+index]),"y"!==type||categoriesStore["y"+index].enabled||(categories=["NoData","NoData"]),categories)},DataProcessor.prototype.isstacked=function(cType){var data=this.data,plotoptions=data.chart.plot.plotoptions,stackedChart=this.stackedChart,helpers=DataProcessor.helpers;if(defined(cType)){var numType=helpers.getChartType(cType,NUMERIC_DATATYPE);return plotoptions=plotoptions[cType=helpers.getChartType(cType,"string")],numType===charttype.stkdarea||numType===charttype.stkdbar||numType===charttype.bullet||"bullet"===cType||("bar"===cType||"area"===cType||"web"===cType||"line"===cType||"waterfall"===cType)&&!0===getPropVal(plotoptions,"stacked.enabled")}if(!defined(stackedChart)){var allChartTypes=this.allChartTypes||helpers.getAllChartTypes(data),type=allChartTypes[0];this.stackedChart=stackedChart=-1!==allChartTypes.indexOf(charttype.stkdarea)||-1!==allChartTypes.indexOf(charttype.stkdbar)||-1!==allChartTypes.indexOf(charttype.bullet)||-1!==allChartTypes.indexOf(charttype.bar)&&!0===getPropVal(plotoptions,"bar.stacked.enabled")||-1!==allChartTypes.indexOf(charttype.area)&&!0===getPropVal(plotoptions,"area.stacked.enabled")||type===charttype.web&&!0===getPropVal(plotoptions,"web.stacked.enabled")||type===charttype.line&&!0===getPropVal(plotoptions,"line.stacked.enabled")||type===charttype.waterfall&&!0===getPropVal(plotoptions,"waterfall.stacked.enabled")}return stackedChart},DataProcessor.prototype.getStackGroupIndex=function(index,array,accessor){return d3_max(array,function(d,j){return-1!=(accessor?accessor(d,j):d).indexOf(index)?j:-1})},DataProcessor.prototype.getXYvalue=function(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,type,zscale,yrangePos){var yaxesData=this.yaxesData,dataset=this.dataset;if(this.isPolarAxisCategory){var baseIdx=yaxesData[yaxiscolumnorder].reversed&&!stacked?yscale.domain().length-1:0,a=xscale(dataset.getX(d)),r=stacked?yscale(d.y+d.y0):yscale(dataset.getY(d,yaxiscolumnorder))+(null!=yscale.bandwidth?yscale.bandwidth()/2:0),xy=polarToXY(r=mathMax(r,yscale.range()[baseIdx]),a);return"x"===type?xy[0]:xy[1]}switch(type){case"x":return axisrotated?stacked?yscale(d.y+d.y0):yscale(dataset.getY(d,yaxiscolumnorder,yrangePos))+(null!=yscale.bandwidth?yscale.bandwidth()/2:0):xscale(dataset.getX(d))+(null!=xscale.bandwidth?xscale.bandwidth()/2:0);case"y":return axisrotated?xscale(dataset.getX(d))+(null!=xscale.bandwidth?xscale.bandwidth()/2:0):stacked?yscale(d.y+d.y0):yscale(dataset.getY(d,yaxiscolumnorder,yrangePos))+(null!=yscale.bandwidth?yscale.bandwidth()/2:0);case"z":return zscale(dataset.getZ(d)||zscale.domain()[0])}},DataProcessor.prototype.getTransRectValue=function(param,d,i,j,cp,radius,yrangePos){var dataset=this.dataset,yscale=cp&&cp.yscale,bandWidthBy2=cp&&cp.addRangeBand(yscale),isWaterfall=cp&&"waterfall"==cp.charttype,hasBaseY0=cp&&cp.stacked||isWaterfall,isYRange=cp&&dataset.getY(d,cp.yaxiscolumnorder)instanceof Array,minRange=cp&&(yscale.bandwidth?yscale.ordinalRange[0]+bandWidthBy2:yscale.range()[0]),maxRange=cp&&yscale.range()[1];switch(this.dataset.yAccessor=this.isPercentChart?function(d){return d.y}:this.dataset.getY,param){case"x":if(cp.axisrotated){yrangePos=isYRange?0:null;var curY=this.dataset.yAccessor(d,cp.yaxiscolumnorder,yrangePos);return yscale.bandwidth?yscale.origRange[0]:yscale(hasBaseY0?mathMin(d.y0,d.y+d.y0):null!=yrangePos?curY:null!=cp.hasNegValue?curY<cp.hasNegValue?curY:cp.hasNegValue:yscale.domain()[0])}var v=dataset.getX(d);return(cp.stacked?cp.bandwidth1(v)+cp.bandwidth2(cp.stackGroupIndex):cp.bandwidth1(v)+cp.bandwidth2(cp.barDatasetIndex+i))+cp.padding;case"y":if(cp.axisrotated){v=dataset.getX(d);return(cp.stacked?cp.bandwidth1(v)+cp.bandwidth2(cp.stackGroupIndex):cp.bandwidth1(v)+cp.bandwidth2(cp.barDatasetIndex+i))+cp.padding}yrangePos=null!=yrangePos?yrangePos:isYRange?1:null;curY=this.dataset.yAccessor(d,cp.yaxiscolumnorder,yrangePos);return hasBaseY0?yscale(mathMax(d.y0,d.y+d.y0))+bandWidthBy2:yscale(null==yscale.bandwidth?mathMax(cp.hasNegValue||0,curY):curY)+bandWidthBy2;case"width":if(cp.axisrotated){var basevalue=null==cp.hasNegValue?isYRange?yscale(this.dataset.yAccessor(d,cp.yaxiscolumnorder,0)):minRange:yscale(cp.hasNegValue);yrangePos=isYRange?1:null;curY=yscale(this.dataset.yAccessor(d,cp.yaxiscolumnorder,yrangePos));return yscale.bandwidth?curY+bandWidthBy2:hasBaseY0?mathAbs(yscale(d.y+d.y0)-yscale(d.y0))+bandWidthBy2:(mathAbs(maxRange-basevalue-(maxRange-curY))||0)+bandWidthBy2}return cp.barWidth;case"height":if(cp.axisrotated)return cp.barWidth;basevalue=null!=cp.hasNegValue?yscale(cp.hasNegValue):isYRange&&!hasBaseY0?yscale(this.dataset.yAccessor(d,cp.yaxiscolumnorder,0)):minRange;yrangePos=isYRange?1:null;curY=yscale(this.dataset.yAccessor(d,cp.yaxiscolumnorder,yrangePos))+bandWidthBy2;return yscale.bandwidth?mathAbs(yscale.origRange[0]-curY):hasBaseY0?mathAbs(basevalue-yscale(d.y+d.y0)-(basevalue-yscale(d.y0)))+bandWidthBy2:mathAbs(basevalue-curY);case"radius":return getBorderRadius(radius)}},DataProcessor.prototype.getCorrectionOverDataLabels=function(domain,type,index){var chartObj=this.chartObj,xaxisData=this.xaxisData,yaxesData=this.yaxesData,domainCorrections=this.domainCorrections,rangeCorrections_datalabels=this.rangeCorrections.datalabels,processedseriesData=this.processedseriesData,groupedDataBySplitAxes=this.groupedDataBySplitAxes,isXaxis="x"==type,id=type+(defined(index)?index:""),axisConf=isXaxis?xaxisData:yaxesData[index],customMinval=axisConf.minRange,customMaxval=axisConf.maxRange,pHeight=chartObj.plotarea.height;if(!this.isStackedPercentChart&&!this.isPercentChart&&(!this.isBubbleEnabled||this.pieWithAxis)&&(this.isAxisCategory||this.isNonAxisMultiSeriesCategory)&&(null==customMinval||null==customMaxval)&&labelRenderer&&(null==domainCorrections.byDatalabels[id]||pHeight!=domainCorrections.plotHeight)){domainCorrections.plotHeight=pHeight;var orient=chartObj.axes[type].orient,rangeDiff=chartObj.plotarea["left"==orient?"height":"width"],domainDiff=domain[1]-domain[0],serData=isXaxis?processedseriesData:groupedDataBySplitAxes[index],correction=0;null!=serData&&(isUndefined(rangeCorrections_datalabels[id])&&isLabelsEnabledForChart(chartObj,type)&&(rangeCorrections_datalabels[id]=dataLabel_handler.DATALABELS_getPreCalculatedSize(type,serData,chartObj)),correction=rangeCorrections_datalabels[id]||0),domainCorrections.byDatalabels[id]=domainDiff/(rangeDiff-correction)*correction}return domainCorrections.byDatalabels[id]||0},DataProcessor.prototype.convertTo3DArray=function(d,groupbyDataIndices,cType){var curdata=d.data;if(groupbyDataIndices.length>0&&(cType===charttype.bar||cType===charttype.stkdbar)){var groupbyCategories=function(curSeriesdata,groupbyDataIndices){var distintGroupbyCat=[],allGroupbyCat=[];return curSeriesdata.data.forEach(function(d){var x=groupbyDataIndices.reduce(function(prev,cur){return prev+d[cur]},"");allGroupbyCat.push(x),-1===distintGroupbyCat.indexOf(x)&&distintGroupbyCat.push(x)}),{distintGroupbyCat:distintGroupbyCat,allGroupbyCat:allGroupbyCat}}(d,groupbyDataIndices),distintGroupbyCat=groupbyCategories.distintGroupbyCat,allGroupbyCat=groupbyCategories.allGroupbyCat,newSeriesdata=[];d.data.forEach(function(d,j){var index=distintGroupbyCat.indexOf(allGroupbyCat[j]);newSeriesdata[index]?newSeriesdata[index].push(d):(newSeriesdata[index]=[],newSeriesdata[index].push(d))}),curdata=d.data=newSeriesdata}else defined(curdata)&&(!curdata.length||defined(curdata[0])&&curdata[0].length)&&(d.data=[],d.data.push(curdata),curdata=d.data);return curdata},DataProcessor.prototype.findXCategories=function(includeDisabled){var categoriesStore=this.categoriesStore,processedseriesData=this.processedseriesData,dataset=this.dataset,XCat=categoriesStore.x;return processedseriesData.forEach(function(d,i){var disabled=d.disabled&&!includeDisabled,curdata=d.data;disabled||null==curdata||curdata.constructor!=Array||curdata.map(function(subgroup,j){if(null!=subgroup&&subgroup.constructor==Array)return subgroup.map(function(dataPoint){var xVal=dataset.getX(dataPoint);null!=xVal&&-1==XCat.indexOf(xVal)&&XCat.push(xVal)})})}),XCat},DataProcessor.prototype.storeCategories=function(curdata,stacked,groupbyDataIndices,cType,actXdatatype,yDatatype,yaxiscolumnorder,needDuplicateCategories){var processor=this,dataset=processor.dataset,categoriesStore=processor.categoriesStore,XCat=categoriesStore.x,yCat=categoriesStore["y"+yaxiscolumnorder],helpers=DataProcessor.helpers,isCatNullX=helpers.isCatNull(dataset,"x"),isCatNullY=helpers.isCatNull(dataset,"y",yaxiscolumnorder);stacked?curdata.map(function(subgroup,j){if(!curdata.disabled&&isArray(subgroup))return subgroup.map(function(dataPoint){var xVal=dataset.getActualX(dataPoint),groupByVal=groupbyDataIndices.length>0?dataset.getGroupByValues(dataPoint,groupbyDataIndices):null;xVal>processor.lastCategoryValue&&!processor.needXCategoriesSorting?processor.lastCategoryValue=xVal:processor.needXCategoriesSorting||-1!=XCat.indexOf(xVal)||(processor.needXCategoriesSorting=!0),!isCatNullX(xVal)&&(-1==XCat.indexOf(xVal)||needDuplicateCategories)&&XCat.push(xVal),null!=groupByVal&&(subgroup.groupByVal=groupByVal,dataPoint.groupByVal=groupByVal,-1==categoriesStore.subseries.indexOf(groupByVal)&&categoriesStore.subseries.push(groupByVal))})}):actXdatatype!==ORDINAL_DATATYPE&&yDatatype!==ORDINAL_DATATYPE||curdata.map(function(subgroup,j){if(!curdata.disabled&&isArray(subgroup))return subgroup.map(function(dataPoint){var xVal=dataset.getActualX(dataPoint),yVal=dataset.getY(dataPoint,yaxiscolumnorder);actXdatatype!==ORDINAL_DATATYPE||isCatNullX(xVal)||(needDuplicateCategories||-1===XCat.indexOf(xVal))&&XCat.push(xVal),yDatatype===ORDINAL_DATATYPE&&(cType===charttype.arearange||cType===charttype.gantt?(defined(yVal)&&-1===yCat.indexOf(yVal[0])&&yCat.push(yVal[0]),defined(yVal)&&-1===yCat.indexOf(yVal[1])&&yCat.push(yVal[1])):!isCatNullY(yVal)&&-1===yCat.indexOf(yVal)&&yCat.push(yVal))})})},DataProcessor.prototype.overLevelMarker=function(extentY){var levelMarkerIndex,targetMarkerIndex,helpers=DataProcessor.helpers,qualitativeRanges=this.qualitativeRanges,processedseriesData=this.processedseriesData,chartName=helpers.getChartType(this.processedseriesData[0].type||this.globalChartType,"string"),conf=this.data.chart.plot.plotoptions[chartName],levelMarker=conf.levelMarker,targetMarker=conf.targetMarker;return defined(qualitativeRanges)||(qualitativeRanges=this.qualitativeRanges=[],processedseriesData.forEach(function(series){var plotOptions=series.plotoptions||{};levelMarker=mergeJSON(levelMarker,plotOptions.levelMarker),targetMarker=mergeJSON(targetMarker,plotOptions.targetMarker),levelMarkerIndex=levelMarker.dataindex,targetMarkerIndex=targetMarker.dataindex,(levelMarker.enabled||targetMarker.enabled)&&(levelMarkerIndex||targetMarkerIndex?series.data.forEach(function(subSeries){subSeries.forEach(function(point){targetMarker.enabled&&defined(point[targetMarkerIndex])&&qualitativeRanges.push(point[targetMarkerIndex]),levelMarker.enabled&&defined(point[levelMarkerIndex])&&(isArray(point[levelMarkerIndex])?qualitativeRanges=qualitativeRanges.concat(point[levelMarkerIndex]):qualitativeRanges.push(point[levelMarkerIndex]))})}):levelMarker.enabled&&defined(levelMarker.values)&&(qualitativeRanges=qualitativeRanges.concat(levelMarker.values)))})),isNaN(qualitativeRanges[1]-qualitativeRanges[0])&&!this.hasLevelMarker?extentY:d3_extent(d3_merge([qualitativeRanges,extentY,[0]]))},DataProcessor.prototype.totalDataCount=function(curdata){var processor=this,temp=0;return curdata.map(function(subgroup){if(!curdata.disabled&&isArray(subgroup)){var len=processor.isAxisCategory||processor.isPolarAxisCategory||processor.isNonAxisMultiSeriesCategory?subgroup.length:subgroup.reduce(function(prev,cur){return prev+(cur.disabled?0:1)},0);temp+=1!==len||null!==subgroup[0]&&subgroup[0].length?len:0}}),this.totalnoofdatas+=temp,temp},plot.rendererConf=function(){var renderer={params:{},xscale:function(_){return arguments.length?(renderer.params.xscale=_,renderer):renderer.params.xscale},yscale:function(_){return arguments.length?(renderer.params.yscale=_,renderer):renderer.params.yscale},stacked:function(_){return arguments.length?(renderer.params.stacked=_,renderer):renderer.params.stacked},datasetIndex:function(_){return arguments.length?(renderer.params.datasetIndex=_,renderer):renderer.params.datasetIndex},renderingOrderIndex:function(_){return arguments.length?(renderer.params.renderingOrderIndex=_,renderer):renderer.params.renderingOrderIndex},axisrotated:function(_){return arguments.length?(renderer.params.axisrotated=_,renderer):renderer.params.axisrotated},commonPlotOptions:function(_){return arguments.length?(renderer.params.commonPlotOptions=_,renderer):renderer.params.commonPlotOptions},color:function(_){return arguments.length?(renderer.params.color=_,renderer):renderer.params.color},chartObj:function(_){return arguments.length?(renderer.params.chartObj=_,renderer):renderer.params.chartObj},notes:function(_){return arguments.length?(renderer.params.notesArray=_,renderer):renderer.params.notesArray},updateLabelArrayAndLabelQueue:function(la,lq){return arguments.length?(renderer.params.labelArray=la,renderer.params.labelQueue=lq,renderer):[renderer.params.labelArray,renderer.params.labelQueue]},hasNegValue:function(_){return arguments.length?(renderer.params.hasNegValue=_,renderer):renderer.params.hasNegValue},dataset:function(_){return arguments.length?(renderer.params.dataset=_,renderer):renderer.params.dataset},yaxiscolumnorder:function(_){return arguments.length?(renderer.params.yaxiscolumnorder=_,renderer):renderer.params.yaxiscolumnorder},threshold:function(_){return arguments.length?(renderer.params.threshold=_,renderer):renderer.params.threshold},thresholdType:function(_){return arguments.length?(renderer.params.thresholdType=_,renderer):renderer.params.thresholdType},colorOverlay:function(_){return arguments.length?(renderer.params.colorOverlay=_,renderer):renderer.params.colorOverlay}};return renderer},plot.render=function(chartObj){var mode=chartObj.systemConf.chart.plot.renderer.mode.toLowerCase(),cType=chartObj.chartTypes[0],render={mode:chartcategory.svgOnly.indexOf(cType.value)>-1||chartObj.dataObject.pieWithAxis?"svg":mode.toLocaleLowerCase()},args={labelQueue:[],notesArray:[],labelArray:[]};if(chartObj.rendererConf||(chartObj.rendererConf=[]),"function"!=typeof plot[render.mode+"Renderer"])throw new SyntaxError(render.mode+"Renderer not found");return render[render.mode]=plot[render.mode+"Renderer"](chartObj,args),render.draw=function(update){chartObj.chartRendered=!1,this[this.mode].draw(update);var overview=chartObj.overview;overview&&charts(overview.element.node(),overview.data)},render},renderer_helpers.renderCompletedEvents=function(chartObj,update,args,callback){var k,systemconf=chartObj.systemConf,isDialChart=chartObj.dataObject.hasLevelMarker&&!chartObj.isAxisCategory,DoWaitForChartRendered=(chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory)&&!chartObj.dataObject.pieWithAxis||isDialChart||chartObj.isGeoMap&&!chartObj.dataObject.hasBubblePie,renderer=chartObj.renderer,axesRendered=!1;chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory?setTimeout(function(){axesRendered=!0},chartObj.axes.animationDuration+17):axesRendered=!0;var timer=setInterval(function(){if(isDocumentVisible()&&(chartObj.chartRendered=!0),chartObj.destroying)return!0;for(k=renderer.length;k--;)if(!0!==renderer[k].chartRendered||!axesRendered)return!1;return function(){try{stateChangeListener(chartObj,systemconf.chart.plot.events,0,update?"onreload":"onload"),callDatalableAndAnnotationRenderer(chartObj,args,!(DoWaitForChartRendered&&update),update),chartObj.handleHiddenContainer(!0),stateChangeListener(chartObj,systemconf.canvas.events,0,update?"onreload":"onload")}catch(err){VizLayout.helpers.handleErrors(chartObj,err)}}(),clearInterval(timer),isFunction(callback)?callback():chartObj.chartRendered=!0,!0},1e3/60);DoWaitForChartRendered&&callDatalableAndAnnotationRenderer(chartObj,args,isDialChart||update,update)},renderer_helpers.arrangeSeriesRenderingOrder=function(chartObj){var seriesdata=chartObj.seriesdata,dataProcessorHelpers=DataProcessor.helpers;if(chartObj.dataObject.isCombinationalChart){var order={defaultType:0,area:0,geoheatmap:0,bar:1,line:2,bubble:3,geobubble:3,bubblepie:4,geobubblepie:4,scatter:5,geoscatter:5},globalChartType=chartObj.userdata.seriesdata.type,seriesdata_cpy=simpleClone(seriesdata);return seriesdata_cpy.map(function(d,i){return d.seriesidx=i,d}),seriesdata_cpy.sort(function(a,b){var type1=dataProcessorHelpers.getChartType(a.type||globalChartType,"string"),type2=dataProcessorHelpers.getChartType(b.type||globalChartType,"string"),order1=null==order[type1]?order.defaultType:order[type1],order2=null==order[type2]?order.defaultType:order[type2],seriesidx1=a.seriesidx,seriesidx2=b.seriesidx;return order1<order2?-1:order1>order2?1:seriesidx1<seriesidx2?-1:seriesidx1>seriesidx2?1:0}),seriesdata_cpy}return seriesdata},renderer_helpers.setRendererProp=function(chartObj,renderer,seriesdata,index,renderingOrder,args){var cTypeObj=chartObj.chartTypes[index],cType=cTypeObj.name,cTypeNumeric=cTypeObj.value,systemconf=chartObj.systemConf,helpers=DataProcessor.helpers;!function(renderer,seriesdata,index,cType,actualCType){var seriesClr=chartObj.seriesdata[index].color||chartObj.seriesColor[index%chartObj.seriesColor.length],yaxiscolumnorder=chartObj.seriesdata[index].yaxiscolumnorder,yscindex=helpers.getParsedYAxisOrder(yaxiscolumnorder);chartObj.rendererConf[index].chartObj(chartObj).dataset(chartObj.dataset).axisrotated(chartObj.dataObject.getAxisRotated()).yaxiscolumnorder(yscindex).hasNegValue(chartObj.dataObject.containsNegativeData(yscindex)).stacked(chartObj.dataObject.isstacked(actualCType)).commonPlotOptions(chartObj.systemConf.chart.plot.plotoptions[cType]).color("bubblepie"==cType?chartObj.seriesColor:chartObj.isAxisCategory?function(renderer,seriesdata,seriesClr,index,yscindex,cType){var thOverlay_data_x=systemconf.chart.axes.xaxis.threshold.coloroverlay,thOverlay_data_y=null!=systemconf.chart.axes.yaxis[yscindex]&&null!=systemconf.chart.axes.yaxis[yscindex].threshold?systemconf.chart.axes.yaxis[yscindex].threshold.coloroverlay:null,showColorOverlay=thOverlay_data_x.show||null!=thOverlay_data_y&&thOverlay_data_y.show;if(showColorOverlay){var overlayData=null!=thOverlay_data_y&&thOverlay_data_y.show?thOverlay_data_y:thOverlay_data_x.show?thOverlay_data_x:null,negThreshType=null!=thOverlay_data_y&&thOverlay_data_y.show?"y":thOverlay_data_x.show?"x":null,colorOverlay=showColorOverlay?axis.threshold.overlay(chartObj,"continous"):null,axisOrder="y"===negThreshType?yscindex:0;return chartObj.rendererConf[index].threshold(showColorOverlay?overlayData:null).thresholdType(negThreshType).colorOverlay(showColorOverlay?axis.threshold.overlay(chartObj,"discrete",overlayData):null),"bar"==cType||"scatter"==cType||"bubble"==cType?seriesClr:colorOverlay(seriesClr,overlayData,axisOrder,negThreshType)}return seriesClr}(0,0,seriesClr,index,yscindex,cType):chartObj.dataObject.isPolarAxisCategory?seriesClr:chartObj.seriesColor).notes(args.notesArray).updateLabelArrayAndLabelQueue(args.labelArray,args.labelQueue)}(0,0,index,cType,cTypeNumeric),renderer.commonRendererProp(chartObj.rendererConf[index]);var yaxiscolumnorder=chartObj.seriesdata[index].yaxiscolumnorder,yscindex=helpers.getParsedYAxisOrder(yaxiscolumnorder);if(renderer.chartRendered=!1,chartObj.xymultiRenderer||chartObj.dataObject.isPolarAxisCategory){var ysc=chartObj.axes.y.groups[yscindex].scale;chartObj.rendererConf[index].xscale(chartObj.axes.x.scale).yscale(ysc).datasetIndex(index).renderingOrderIndex(renderingOrder),args.labelArray=chartObj.rendererConf[index].params.labelArray,args.labelQueue=chartObj.rendererConf[index].params.labelQueue}if(isBarChartType(cTypeNumeric)&&!isHeatMapChartType(cTypeNumeric)&&(renderer.bandwidth1(chartObj.barscale1).bandwidth2(chartObj.barscale2),args.image||renderer.barDatasetIndex(args.barDatasetIndex),null!=seriesdata.disabled&&seriesdata.disabled||(args.barDatasetIndex=args.barDatasetIndex+chartObj.seriesdata[index].data.length)),isWaterfallChartType(cTypeNumeric)){var commonParams=chartObj.rendererConf[index].params;commonParams.categoryColorConfig=renderer_helpers.getWaterfallCategoriesConfig(chartObj.seriesdata[index].plotoptions,commonParams.commonPlotOptions)}},renderer_helpers.saveSeriesdataInRenderer=function(chartObj,seriesIndex){var rp=chartObj.rendererConf[seriesIndex].params,xscale=rp.xscale,yscale=rp.yscale,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=chartObj.dataset,datatypeX=dataset.getDataType("x"),datatypeY=dataset.getDataType("y",yaxiscolumnorder),currentseriesdata=chartObj.seriesdata[seriesIndex].data,renderer=chartObj.renderer[seriesIndex];if(datatypeX==ORDINAL_DATATYPE||datatypeY==ORDINAL_DATATYPE){renderer.seriesdataAfterUpdate=[];var dataProcessorHelpers=DataProcessor.helpers,xCategories=(dataProcessorHelpers.isCatNull(dataset,"x"),dataProcessorHelpers.isCatNull(dataset,"y",yaxiscolumnorder),datatypeX==ORDINAL_DATATYPE?xscale.domain():null),yCategories=datatypeY==ORDINAL_DATATYPE?yscale.domain():null;currentseriesdata.forEach(function(d,i){renderer.seriesdataAfterUpdate[i]=chartObj.dataObject.updateSeriesdatabyCategories(d3_values(d),xCategories,yCategories,yaxiscolumnorder)})}else renderer.seriesdataAfterUpdate=null},charts.get=function(chartHolder,data){return new Chart(chartHolder,data)},inherit(Chart,VizLayout),Chart.helpers=VizLayout.helpers,Chart.prototype.initialize=function(){try{this.processUserData(this.themeoptions),this.setChartDimension(),this.legendHighlight=new legendHighlight(this,this.svg),VizLayout.helpers.constructChartGroups(this)}catch(err){VizLayout.helpers.handleErrors(this,err)}},Chart.prototype.draw=function(){this.render(!1)},Chart.prototype.render=function(update){try{this.updateCanvasArea();var systemConfig=this.systemConf;if(this.applyChartProperties(),this.nochartdata)this.hideLoading(this.container),this.handleNoData(systemConfig.noDataHandler),this.chartRendered=!0,stateChangeListener(this,systemConfig.canvas.events,0,update?"onreload":"onload");else{if(this.clearNoData(systemConfig.noDataHandler),this.getChartSeriesColor(),this.isAxisCategory=this.dataObject.isAxisCategory,this.isNonAxisMultiSeriesCategory=this.dataObject.isNonAxisMultiSeriesCategory,this.xymultiRenderer=this.isAxisCategory,this.data,legend.render(this,update),tooltip_block_helpers.updatePlotarea4BlockTooltip(this),isObjectPropDefined(this.systemConf,"notes")&&this.systemConf.notes.enabled&&annotation.addBlockAnnotations(this),isObjectPropDefined(this.systemConf.chart,"scroll")&&this.systemConf.chart.scroll.enabled&&(setDefaultOptions("scroll",this.systemConf.chart,this.globalProp),this.brush=plotScroll_svg.brush(this,"x")),this.isAxisCategory&&(this.systemConf.chart.width||this.systemConf.chart.height)){var div_scroll=new plotScroll_div;this.divScroll=div_scroll,div_scroll.initialize(this)}if(stateChangeListener(this,systemConfig.chart.axes.events,0,"init"),this.drawPlotBorder(),this.isAxisCategory)axis.render(this,this.chartWidth,this.chartHeight,update);else if(this.dataObject.isPolarAxisCategory||this.dataObject.hasLevelMarker){var type=this.dataObject.hasLevelMarker?"y":"x";axis.polar.render(this,type)}if(this.zscale=this.dataObject.hasZaxis&&!this.dataObject.isHierarchy?scale$1.getScale(this,this.dataObject,this.plotarea,this.axes.x.orient,null,this.dataset,"z"):null,stateChangeListener(this,systemConfig.chart.axes.events,0,update?"onreload":"onload"),this.updatePlotareaProp(),this.plot.renderer)this.plot.renderer.draw(update);else(this.plot.renderer=plot.render(this,update)).draw(!1);this.isAxisCategory&&this.drawThreshold(update),this.handleEvent(update),this.drawPlotareaClippath(),drawBorderBox(this.wrap.selectAll("rect.dummy-rect-filter"),{width:this.plotarea.width,height:this.plotarea.height})}}catch(err){VizLayout.helpers.handleErrors(this,err)}},Chart.prototype.processUserData=function(baseSystemConf,update){var systemConfig,series,chartdata;this.systemConf=systemConfig=mergeJSON(baseSystemConf,this.userdata,!0,!0),series=getPropVal(systemConfig,"seriesdata")||{},this.seriesdata=chartdata=series.chartdata,update||stateChangeListener(this,systemConfig.canvas.events,0,"init"),this.nochartdata=!defined(chartdata)||defined(chartdata)&&chartdata.length<1,this.nochartdata?this.seriesdata=null:(this.dataset=new dataparser.get(systemConfig,this),this.preProcessor=new PreProcessor(this),this.dataObject=this.getDataObject(),this.dataset.setDataObj(this.dataObject),this.nochartdata=this.dataObject.totalnoofdatas<1,this.axes.rotated=this.dataObject.getAxisRotated(),this.axes.rotated?(this.axes.x.orient="left",this.axes.y.orient="bottom"):(this.axes.x.orient="bottom",this.axes.y.orient="left"),this.ismultiy=this.getAxesCount("y")>1,this.ismultix=this.getAxesCount("x")>1)},Chart.prototype.getDataObject=function(){var dataProcessor;return dataProcessor=chartcategory.hierarchy.indexOf(this.chartTypes[0].value)>-1?new _hierarchymodel.get(this):new DataProcessor(this.systemConf,this.dataset,this),this.seriesdata=dataProcessor.isHierarchy?simpleClone(this.seriesdata):this.seriesdata,dataProcessor},Chart.prototype.getAxesCount=function(type){var count=1,metadata=this.systemConf.metadata;if("x"===type){var columnIndex=this.dataset.getColumnIdx(type),originalDataType=metadata.columns[columnIndex].datatype,formatConfig=pick(metadata.columns[columnIndex][originalDataType],{}),formatFunction=formatConfig.subfunction;defined(this.dataObject.hierarchical)?count=this.dataObject.hierarchical.finalDepth+1:isArray(formatConfig.groupby)&&formatConfig.groupby.length?count=formatConfig.groupby.length+1:"AUTO"===formatConfig.groupby&&(count=DataProcessor.HierarchicalTimeDataAdapter.getAutoGroupOrder(formatFunction).length+1),this.axes[type].count=count}else{var metadataY=metadata.axes.y;count=this.axes[type].count=metadataY.length}return count},Chart.prototype.drawThreshold=function(update){if(axis.threshold){this.cache.thresholdCustomPoints=[],axis.threshold(this,update)}},Chart.prototype.handleEvent=function(update){var systemConfig=this.systemConf;update&&this.eventHandler?this.eventHandler.updateParams(this):(this.createEventGroups(update),this.eventHandler=events.mouseevents(this,this.tooltip.element,systemConfig,this.plotarea,this.dataset,this.axes.x.scale,this.barscale1,this.barscale2,this.axes.y.groups,this.eventWrap,this.seriesColor,this.labelHighlighter),this.eventHandler.initializeListener()),(this.xymultiRenderer||this.dataObject.isPolarAxisCategory)&&drawBorderBox(this.eventHandler.trackerElement,this.plotarea),this.isAxisCategory&&(this.systemConf.chart.width||this.systemConf.chart.height)&&this.divScroll.defaultScroll(this)},Chart.prototype.addRemoveSeries=function(series,i,axisorder,updateAllAxes){var chart=this,systemConfig=chart.systemConf;if(chart.phase="legendFilter",colorscale_helpers.isQuantileColorScale(chart))return chart.phase="legendFilter-colorScale",void chart.plot.renderer.draw(!0);if(chart.dataObject.formattedData={x:[],y:[]},chart.dataObject.initialize("addorremoveseries"),stateChangeListener(chart,systemConfig.chart.axes.events,0,"init"),chart.isAxisCategory){var brushExtent=chart.brush&&chart.brush.extent;chart.updateZscale(),updateAllAxes?chart.axes.y.groups.forEach(function(d,i){chart.updateScale([i,0],"y")}):chart.updateScale(axisorder,"y"),chart.updateScale(0,"x",brushExtent),chart.dataObject.hierarchical&&(chart.axes.x.rangeScale=chart.axes.x.scale.copy(),chart.axes.x.rangeScale.outerPaddingPx=chart.axes.x.scale.outerPaddingPx,chart.dataObject.hierarchical.groupByDiscreteTime&&chart.axes.x.rangeScale.domain(d3.range(chart.axes.x.scale.domain().length)),chart.dataObject.hierarchical.setRanges(chart.axes.x.rangeScale),chart.axes.x.levels.forEach(function(d,i){chart.updateScale(axisorder,"x",null,i+1)}),chart.dataObject.hierarchical.categoryTree&&axis.TickLabelFilter.updateTickEventHandler(chart,series.disabled)),chart.drawThreshold(!0),chart.drawPlotareaClippath(),chart.updatePlotareaProp()}else chart.dataObject.isPolarAxisCategory&&axis.polar.render(chart,"x");stateChangeListener(chart,systemConfig.chart.axes.events,0,"onreload"),chart.events={},chart.plot.renderer.draw(!0),(chart.isAxisCategory||chart.dataObject.isPolarAxisCategory)&&(drawBorderBox(chart.eventHandler.trackerElement,chart.plotarea),chart.eventHandler.updateParams(chart),(chart.systemConf.chart.width||chart.systemConf.chart.height)&&chart.divScroll.defaultScroll(chart,"addorremoveseries"))},Chart.prototype.pushDataPoint=function(seriesidx,point,shift){var chart=this,isComboChart=chart.dataObject.isCombinationalChart,orderedSeriesdata=isComboChart?renderer_helpers.arrangeSeriesRenderingOrder(chart.seriesdata):chart.seriesdata;if(!Array.isArray(seriesidx)){var seriesidx_arr=[],point_arr=[];seriesidx_arr.push(seriesidx),point_arr.push(point),seriesidx=seriesidx_arr,point=point_arr}seriesidx.forEach(function(d,i){var shiftPoint,shiftInfo,shiftCurSeries,currOrdereddata=orderedSeriesdata[d],curSeriesidx=isComboChart?currOrdereddata.seriesidx:d,series=chart.seriesdata[curSeriesidx],renderer=chart.renderer[curSeriesidx];if(shiftCurSeries=isArray(shift)?shift[i]:shift,series.data[0].push(point[i]),shiftCurSeries){shiftPoint=series.data[0][0];var shiftedData=series.data[0].shift();defined(renderer.shiftInfo())?(shiftInfo=renderer.shiftInfo()).count++:(shiftInfo={}).count=0,shiftInfo.point=shiftPoint,shiftInfo.shiftedData=shiftedData,renderer.shiftInfo(shiftInfo)}else renderer.shiftInfo(null);chart.ismultiy&&chart.updateScale(series,"y")}),chart.dataObject.initialize(),chart.updateScale(null,"x"),chart.ismultiy||chart.updateScale(chart.seriesdata[0],"y"),chart.plot.renderer.draw(!0),chart.drawThreshold(!0),chart.eventHandler.updateParams(chart)},Chart.prototype.popDataPoint=function(seriesidx){var series=this.seriesdata[seriesidx];series.data.forEach(function(d){d.pop()}),this.dataObject.initialize(),this.updateScale(series,"x"),this.updateScale(series,"y"),this.plot.renderer.draw(!0),this.drawThreshold(!0),this.eventHandler.updateParams(this)},Chart.prototype.zoomON=function(type){this.changeZoomType(type),this.zoom||this.eventHandler.initializeZoomListener()},Chart.prototype.zoomOFF=function(){var zoomObj=this.zoom;zoomObj&&zoomObj.reset(),this.changeZoomType(NONE)},Chart.prototype.zoomX=function(seriesidx,range){this.changeZoomType("x"),this.zoom||this.eventHandler.initializeZoomListener(),this.zoom.zoomed(null,seriesidx,range)},Chart.prototype.zoomY=function(seriesidx,range){this.changeZoomType("y"),this.zoom||this.eventHandler.initializeZoomListener(),this.zoom.zoomed(null,seriesidx,null,range)},Chart.prototype.zoomXY=function(seriesidx,xrange,yrange){this.changeZoomType("xy"),this.zoom||this.eventHandler.initializeZoomListener(),this.zoom.zoomed(null,seriesidx,xrange,yrange)},Chart.prototype.changeZoomType=function(type){var systemConfig=this.systemConf;this.zoom||setDefaultOptions("zoom",systemConfig.chart,this.globalProp),systemConfig.chart.zoom.type=type},HierarchicalDataAdapter.prototype={initialize:function(){this.hierarchyLayout=!0,this.finalDepth=0,this.dataCount=0,this.categories=[],this.leafNodes=[],this.series=[],this.categoriesByDepth=[],this.globalChartType=this.originalSeries.type},setDepth:function(){var layout=this,categories=layout.categories,depths=layout.categoriesByDepth=[],leaves=layout.leafNodes=[],leafCategories=layout.leafCategories=[],categoriesList=layout.categoriesList=[],pointProperty=layout.dataType===TIME_DATATYPE||layout.groupByDiscreteTime?"point":"value";!function doDepth(cats,depth,parent,level){depth>layout.finalDepth&&(layout.finalDepth=depth);level=pick(level,"");cats.forEach(function(c,i){defined(parent)&&(c.parent=parent),c.leaf?(c.index=layout.dataCount++,isArray(c.data)&&c.data.forEach(function(d){d.index=c.index,d.level=level+i+"_"}),leaves.push(c),leafCategories.push(c[pointProperty])):(depths[depth]||(depths[depth]=[],categoriesList[depth]=[]),categoriesList[depth].push(c[pointProperty]),c.itemIndex=depths[depth].length,depths[depth].push(c),doDepth(c.children,depth+1,c,level+i+"_"))})}(categories,0),categoriesList.reverse()},getCategories:function(){return this.categories},getCategoriesByDepth:function(depth){return defined(depth)||(depth=0),depth===this.finalDepth?this.leafNodes:depth<this.finalDepth?this.categoriesByDepth[depth]:void 0},getCategoriesByLevelIndices:function(indexes){var categories=this.categories,lastIndex=indexes.length-1;return indexes.forEach(function(index,i){categories=i===lastIndex?categories[index]:categories[index].children}),categories},getParentByIndex:function(itemIndex,parentDepthIndex){for(var leaf=this.leafNodes[itemIndex],parent=null,count=this.finalDepth+1;count--;){if(leaf.depth===parentDepthIndex){parent=leaf;break}if(0===leaf.depth)break;leaf=leaf.parent}return parent},setRanges:function(leafScale){var firstPoint,lastPoint,layout=this,isOrdinal=defined(leafScale.bandwidth),depth=layout.finalDepth,innerPadding=0,outerPadding=0,points=layout.leafNodes,ranges=getOrdinalRange(leafScale);if(isOrdinal){var span=isOrdinal&&leafScale.bandwidth();leafScale.range();firstPoint=points[0],lastPoint=points[points.length-1],innerPadding=isArray(ranges)&&ranges.length>1?(ranges[1]-(ranges[0]+span))/2:0,outerPadding=leafScale.outerPaddingPx,outerPadding=mathMin(outerPadding,innerPadding)}else{firstPoint=points[0],lastPoint=points[points.length-1];var continuousRangeBand=scale$1.getContinuousRangeBand(leafScale,layout.leafCategories);innerPadding=continuousRangeBand.rangeBand/2,outerPadding=continuousRangeBand.outerPaddingInPixel}function setRange(d,i){!function(d){return defined(d.children[0])&&!0===d.children[0].leaf}(d)?(d.rangeBand=d.children.reduce(sumLeaf,0),d.range=[d.children[0].range[0],d.rangeBand+d.children[0].range[0]]):(d.rangeBand=function(children){if(layout.categoryTree)return children.reduce(sumLeaf,0);var start=children[0],end=children[children.length-1],pointProperty="point",barWidth=span;if(layout.groupByContinuousTime){if(barWidth=0,defined(layout.tickValues[start.index+1])){var startTick=layout.tickValues[start.index],nextTick=layout.tickValues[start.index+1],r=leafScale(nextTick)-leafScale(startTick);innerPadding=r/2}}else pointProperty="index";return leafScale(end[pointProperty])-leafScale(start[pointProperty])+getSpan(start,!0)+getSpan(end)+barWidth}(d.children),tempRange=leafScale(isOrdinal?d.children[0].index:d.children[0].point)-getSpan(d.children[0],!0),d.range=[tempRange,tempRange+d.rangeBand]),tempRangeBandList.push(d.rangeBand),tempRangeList.push(d.range)}for(layout.scaleList=[],layout.rangeList=[];depth--;){var tempRange,tempRangeBandList=[],tempRangeList=[];layout.getCategoriesByDepth(depth).forEach(setRange),layout.rangeList.push(tempRangeList)}function sumLeaf(a,point){return point.leaf?a+span+getSpan(point,!0)+getSpan(point):a+point.rangeBand}function getSpan(point,startSide){return startSide&&point===firstPoint||!startSide&&point===lastPoint?outerPadding:innerPadding}return layout.scaleList}},HierarchicalDataAdapter.getValuesByKey=function(obj,key){return obj.map(function(a){return a[key]})},HierarchicalDataAdapter.is3D=function(arr){return isArray(arr)&&isArray(arr[0])},HierarchicalDataAdapter.isArrayOfSeries=function(series){return HierarchicalDataAdapter.is3D(series.data)&&defined(series.seriesname)},HierarchicalDataAdapter.keysObject=function(arr){var t={};return arr&&arr.length&&arr.forEach(function(el){t[el.value]=el}),t},HierarchicalDataAdapter.getValues=function(arr){return defined(arr)?arr.map(function(d){return d.value}):null},HierarchicalDataAdapter.getAllChildren=function(parent,array){return array=pick(array,[]),parent.children?(parent.children.forEach(function(child){child.leaf?Array.prototype.push.apply(array,child.data):HierarchicalDataAdapter.getAllChildren(child,array)}),array):parent.data},DataProcessor.HierarchicalDataAdapter=HierarchicalDataAdapter;var hierarchicalOrdinalDataAdapter={update:function(init){init||this.initialize(),this.process(),this.setDepth()},process:function(){this.originalSeries.forEach(this.searchHierarchy,this)},getSeries:function(seriesIndex){return defined(seriesIndex)?this.series[seriesIndex]:this.series},searchHierarchy:function(series,seriesIndex){var chart=this.chart,newSeries=this.series[seriesIndex],column=pick(chart.dataset.getColumn("x"),{}),dataType=column.datatype,dataIndex=pick(column.dataindex,0),seriesDisabled=series.disabled,hasNullFormatter=defined(column[dataType])&&defined(column[dataType].nullformatting),hasCategory=function(data){return hasNullFormatter||defined(data)};this.series[seriesIndex]||((newSeries=this.series[seriesIndex]=simpleClone(series)).data=[]),function search(series,depth,children){var objKey=DataProcessor.HierarchicalDataAdapter.keysObject(children);series.forEach(function(currentSeries){var hasChildren=PreProcessor.helpers.hasInnerSeries(currentSeries),isArrayOfSeries=DataProcessor.HierarchicalDataAdapter.isArrayOfSeries(currentSeries),entry=null;if(objKey[currentSeries.seriesname]?entry=objKey[currentSeries.seriesname]:(entry={value:isArrayOfSeries||hasChildren?pick(currentSeries.seriesname,""):"",depth:depth,children:[]},seriesDisabled||children.push(entry)),hasChildren)objKey[currentSeries.seriesname]||(objKey[currentSeries.seriesname]=entry),search(currentSeries.data,depth+1,objKey[currentSeries.seriesname].children),0===entry.children.length&&removeElementFromArray(children,entry);else{DataProcessor.HierarchicalDataAdapter.is3D(currentSeries.data)||(currentSeries.data=[currentSeries.data]);var childrenEntries=DataProcessor.HierarchicalDataAdapter.keysObject(entry.children);currentSeries.data.forEach(function(d){var tp={value:d[dataIndex],depth:depth+1,leaf:!0,data:[d]};seriesDisabled?d.seriesDisabled=!0:delete d.seriesDisabled,hasCategory(d[dataIndex])&&(childrenEntries[d[dataIndex]]?childrenEntries[d[dataIndex]].leaf?childrenEntries[d[dataIndex]].data.push(d):childrenEntries[d[dataIndex]].children&&!seriesDisabled&&childrenEntries[d[dataIndex]].children.push(tp):(seriesDisabled||entry.children.push(tp),childrenEntries[d[dataIndex]]=tp),newSeries.data.push(d))}),0===entry.children.length&&removeElementFromArray(children,entry)}})}(series.data,0,this.categories)}};function HierarchicalTimeDataAdapter(chartInstance,tickValues,groupOrder,isDiscrete,columnInfo){DataProcessor.HierarchicalDataAdapter.call(this,chartInstance),this.dataType=TIME_DATATYPE,this.chart=chartInstance,this.columnInfo=columnInfo,isDiscrete?this.groupByDiscreteTime=!0:this.groupByContinuousTime=!0,isArray(groupOrder)?this.groupOrder=groupOrder.slice(0).reverse():"AUTO"===groupOrder&&(this.groupOrder=HierarchicalTimeDataAdapter.getAutoGroupOrder(columnInfo.time.subfunction)),this.groupByTime=!0,this.update(tickValues)}inherit(HierarchicalOrdinalDataAdapter,DataProcessor.HierarchicalDataAdapter),extend(HierarchicalOrdinalDataAdapter.prototype,hierarchicalOrdinalDataAdapter),DataProcessor.HierarchicalOrdinalDataAdapter=HierarchicalOrdinalDataAdapter;var months=["January","February","March","April","May","June","July","August","September","October","November","December"],days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultGroupOrder=["YEAR","QUARTER","MONTH","WEEK","DAY"],formattingFunctions={YEAR:"YEAR",ABSQUARTER:"QUARTER",QUARTER:"QUARTER",MONTH:"MONTH",ABSMONTH:"MONTH",WEEK:"WEEK",ABSWEEK:"WEEK",ABSDAY:"DAY"};function groupBy(array,callback){var key=null;return array.reduce(function(r,a){return r[key=callback.call(null,a)]=r[key]||[],r[key].push(a),r},{})}function convertDateToObject(data){return data.map(function(point){return{YEAR:point.getFullYear(),QUARTER:getQuarter(point),MONTH:(d=point,months[d.getMonth()]),WEEK:function(d){var firstJanuary=new Date(d.getFullYear(),0,1);return mathCeil(((d-firstJanuary)/864e5+firstJanuary.getDay()+1)/7)}(point),DAY:function(d){return days[d.getDay()]}(point),timestamps:point.getTime(),data:point};var d})}function toHierarchy(object,leaf,depth,isDiscreteTime){var tree=[];for(var key in object)if(object.hasOwnProperty(key)){var entry={depth:depth};tree.push(entry),leaf?(entry.leaf=!0,entry.value=isDiscreteTime?object[key].data.getTime():object[key].data,entry.point=object[key].data.getTime()):(entry.value=key,entry.point=object[key][0].data,entry.children=object[key])}return tree}var timeAxisGroup={update:function(tickValues){this.groupByDiscreteTime&&(tickValues=pick(this.chart.dataObject.findXCategories(),tickValues)),this.dataCount=0,this.tickValues=function(tickValues,columnInfo){return tickValues.map(function(d){return generateDateVal(d,0,columnInfo)})}(tickValues,this.columnInfo),this.process(),this.setDepth()},process:function(){var data=this.tickValues,groupOrder=pick(this.groupOrder,defaultGroupOrder),isDiscreteTime=this.groupByDiscreteTime,object=convertDateToObject(data),order=groupOrder.slice(0),key=order.shift(),storage=toHierarchy(groupBy(object,function(date){return date[key]}),!1,0,isDiscreteTime);this.categories=function group(currentObj,keys,depth){var grouped,key=keys.shift();return currentObj.forEach(function(d){key?(grouped=groupBy(d.children,function(data){return data[key]}),d.children=toHierarchy(grouped,!1,depth,isDiscreteTime),group(d.children,keys.slice(0),depth+1)):d.children=toHierarchy(d.children,!0,depth,isDiscreteTime)}),currentObj}(storage,order.slice(0),1)},getPossibleGroupBy:function(data,groupOrder){var startTime=data[0],endTime=data[data.length-1],isSameYear=startTime.getFullYear()===endTime.getFullYear(),groupByObject=groupOrder[0],absoluteTime=millisecondToAbsoluteTime(data[data.length-1]-data[0]);for(var property in absoluteTime)if(absoluteTime.hasOwnProperty(property)&&(absoluteTime[property]>1||"YEAR"===property&&!isSameYear)){groupByObject=property;break}return groupByObject}};HierarchicalTimeDataAdapter.getAutoGroupOrder=function(formattingFunction){var index=defaultGroupOrder.indexOf(formattingFunctions[formattingFunction]);return defaultGroupOrder.slice(0,index)},inherit(HierarchicalTimeDataAdapter,DataProcessor.HierarchicalDataAdapter),extend(HierarchicalTimeDataAdapter.prototype,timeAxisGroup),DataProcessor.HierarchicalTimeDataAdapter=HierarchicalTimeDataAdapter,DataProcessor.prototype.extendOuterpadding=function(domain,range,systemconf,padding,outerpadding,type,index){var processedseriesData=this.processedseriesData,groupedDataBySplitAxes=this.groupedDataBySplitAxes,rangeCorrections_datalabels=this.rangeCorrections.datalabels,needMarkerCorrection=this.needMarkerCorrection(),chartObj=this.chartObj,paddingExtended=0;if(chartObj.datalabels.moduleExists&&dataLabelEnabled(chartObj)||this.isBubbleEnabled||needMarkerCorrection){range[0]>range[1]&&(range=[range[1],range[0]]);var scaleObj=d3_scaleOrdinal().domain(domain).range(range).paddingInner(padding).paddingOuter(outerpadding),updatedRange=range;if(this.isBubbleEnabled){var bubbleRange=this.updateMinMaxForBubble(range,scaleObj,type,index),correction=.5*mathMax(range[0]-bubbleRange[0],bubbleRange[1]-range[1]);updatedRange=[bubbleRange[0]-correction,bubbleRange[1]+correction]}else if(needMarkerCorrection)updatedRange=this.updateMinMaxForMarker(scale,type);else if(labelRenderer){var serData="x"==type?processedseriesData:groupedDataBySplitAxes[index],pad=scaleObj(scaleObj.domain()[0])-scaleObj.range()[0],id=type+(defined(index)?index:"");isUndefined(rangeCorrections_datalabels[id])&&isLabelsEnabledForChart(chartObj,type)&&(rangeCorrections_datalabels[id]=dataLabel_handler.DATALABELS_getPreCalculatedSize(type,serData,chartObj));correction=rangeCorrections_datalabels[id]||0;correction=mathMax(0,correction-pad),updatedRange=[range[0]-correction,range[1]+correction]}paddingExtended=mathMax(updatedRange[1]-range[1],-updatedRange[0])}return paddingExtended},DataProcessor.prototype.processBubblePieData=function(baseChartType){baseChartType=baseChartType||charttype.bubblepie;var processor=this,processedseriesData=processor.processedseriesData,chartObj=processor.chartObj,dataset=processor.dataset,pieDataIndex=validateNullVal(processor.data.chart.plot.plotoptions[charttypenames.get(baseChartType)].dataindex,3),pieData=[],keys=[],userCategories={x:NULL,y:[]},userXCategories=getPropVal(chartObj.userdata,"chart.axes.xaxis.categories");return dataset.getDataType("x")==ORDINAL_DATATYPE&&userXCategories&&userXCategories.length&&(userCategories.x=userXCategories),processedseriesData.forEach(function(series,seriesIndex){var yaxiscolumnorder=DataProcessor.helpers.getParsedYAxisOrder(series.yaxiscolumnorder),userYCategories=getPropVal(chartObj.userdata,"chart.axes.yaxis["+yaxiscolumnorder+"].categories");dataset.getDataType("y",yaxiscolumnorder)==ORDINAL_DATATYPE&&userYCategories&&userYCategories.length&&(userCategories.y[yaxiscolumnorder]=userYCategories),series.data.forEach(function(subseries,subseriesIndex){subseries.forEach(function(dataPoint){var inactive=function(dataPoint,seriesIndex){var currentSeriesData=chartObj.seriesdata[seriesIndex],yaxiscolumnorder=DataProcessor.helpers.getParsedYAxisOrder(currentSeriesData.yaxiscolumnorder),inactive=currentSeriesData.disabled||!isMultiPieChartType(chartObj.chartTypes[seriesIndex].value),xVal=dataset.getX(dataPoint),yVal=dataset.getY(dataPoint,yaxiscolumnorder);userCategories.x&&(inactive=inactive||-1===userCategories.x.indexOf(xVal));userCategories.y[yaxiscolumnorder]&&(inactive=inactive||-1===userCategories.y[yaxiscolumnorder].indexOf(yVal));chartObj.isGeoMap&&!inactive&&(inactive=!processor.isValidPoint(dataPoint));return inactive}(dataPoint,seriesIndex);if(keys[subseriesIndex]=keys[subseriesIndex]||[],pieData[subseriesIndex]=pieData[subseriesIndex]||[],!inactive){var key=bubblepieUtils.getKey(dataPoint,seriesIndex,chartObj),keyIndex=keys[subseriesIndex].indexOf(key);-1===keyIndex&&(keyIndex=keys[subseriesIndex].length,pieData[subseriesIndex][keyIndex]=function(dataPoint,yaxiscolumnorder){var meta=[];return meta.x=dataset.getX(dataPoint),meta.y=dataset.getY(dataPoint,yaxiscolumnorder),meta.z=dataset.getZ(dataPoint),meta.reference=dataPoint,meta}(dataPoint,yaxiscolumnorder)),pieData[subseriesIndex][keyIndex][seriesIndex]=dataPoint,keys[subseriesIndex].push(key)}dataPoint.disabled=dataPoint.dummy=inactive}),pieData[subseriesIndex]=pieData[subseriesIndex]||[]})}),pieData.forEach(function(subseries){subseries.forEach(function(data){processedseriesData.forEach(function(series,seriesIndex){data[seriesIndex]||(data[seriesIndex]=function(reference,seriesIndex){var yaxiscolumnorder=DataProcessor.helpers.getParsedYAxisOrder(chartObj.seriesdata[seriesIndex].yaxiscolumnorder),dataset=chartObj.dataset,data=[];return data[dataset.xidx]=reference.x,isFunction(dataset.yidx)&&(data[dataset.yidx(yaxiscolumnorder)]=reference.y),data[dataset.zidx]=reference.z,data[pieDataIndex]=null,data.dummy=!0,data}(data,seriesIndex))})})}),pieData};var _bubblePieProcessor=DataProcessor.prototype.processBubblePieData;function getY(point,stackExtent){return stackExtent?getStackExtentValue(point,stackExtent):point.y+point.y0}function getStackExtentValue(point,stackExtentList){var itemPos=point.index,curEntry=stackExtentList.filter(function(d,i){return d[0]==itemPos})[0],actualDisplayVal=curEntry[1],actualExtentVal=curEntry[2];return isPositive(actualDisplayVal)?actualExtentVal:actualExtentVal+mathAbs(actualDisplayVal)}function getTransValue(point,type,config,stackExtent){var renderer=config.renderer,axisrotated=config.axisrotated,seriesindex=config.seriesindex;if(stackExtent){if(axisrotated&&"width"==type)return 0;var actualExtent=getStackExtentValue(point,stackExtent);return axisrotated&&"x"==type||!axisrotated&&"y"==type?renderer.commonOption.yscale(actualExtent):renderer.getParamValue(type,point,seriesindex,null,renderer.commonOption)}return renderer.getParamValue(type,point,seriesindex,null,renderer.commonOption)}DataProcessor.prototype.overBubbles=function(domain,type,index){var domainCorrections=this.domainCorrections,xAxis=this.xaxisData,yAxis=this.yaxesData,chart=this.chartObj,id=type+(defined(index)?index:""),plotHeight=chart.plotarea.height,chartObj=this.chartObj;if(defined(domainCorrections.forBubbles[id])&&domainCorrections.plotHeight===plotHeight)return domainCorrections.forBubbles[id];domainCorrections.plotHeight=plotHeight;var isXAxis="x"===type,orient=chartObj.axes[type].orient,min=0,max=chartObj.plotarea["left"===orient?"height":"width"],range=[min,max],axisConf=isXAxis?xAxis:yAxis[index],scaleObj=d3_scaleLinear().domain(domain).range(range),updatedMinMax=this.updateMinMaxForBubble(range,scaleObj,type,index);return min=defined(axisConf.minRange)?min:scaleObj.invert(updatedMinMax[0]),max=defined(axisConf.maxRange)?max:scaleObj.invert(updatedMinMax[1]),domainCorrections.forBubbles[id]=[domain[0]-min,max-domain[1]],domainCorrections.forBubbles[id]},DataProcessor.prototype.updateMinMaxForBubble=function(range,scaleObj,type,index){var processedseriesData=this.processedseriesData,groupedDataBySplitAxes=this.groupedDataBySplitAxes,dataset=this.dataset,chartObj=this.chartObj,helpers=DataProcessor.helpers,min=range[0],max=range[1],isXaxis="x"==type;return((isXaxis?processedseriesData:groupedDataBySplitAxes[index])||[]).forEach(function(series){var currentdata=isXaxis?series.data:series.d,disabled=(isXaxis?series:processedseriesData[series.si]).disabled,yaxiscolumnorder=helpers.getParsedYAxisOrder((isXaxis?series:processedseriesData[series.si]).yaxiscolumnorder);if(!disabled){var isCatNullX=helpers.isCatNull(dataset,"x"),isCatNullY=helpers.isCatNull(dataset,"y",yaxiscolumnorder);currentdata.forEach(function(subgroup){subgroup.forEach(function(data){var val=isXaxis?dataset.getX(data):dataset.getY(data,index),z=dataset.getZ(data)||chartObj.zscale.domain()[0];if(data&&!data.isDummy&&!isCatNullX(dataset.getX(data))&&!isCatNullY(dataset.getY(data,yaxiscolumnorder))){var zpx=chartObj.zscale(z),valpx=scaleObj(val)+(null!=scaleObj.bandwidth?scaleObj.bandwidth()/2:0),radPlus=valpx+zpx/2,radMinus=valpx-zpx/2;radPlus>max&&(max=radPlus),radMinus<min&&(min=radMinus)}})})}}),[min,max]},DataProcessor.prototype.needMarkerCorrection=function(){return!1},DataProcessor.prototype.updateMinMaxForMarker=function(scaleObj,type,correctionFactor){var chartObj=this.chartObj,markerSize=getMarkerSize(chartObj),isHorizontal=chartObj.axes[type].orient===BOTTOM_ALIGN,s1=markerSize[isHorizontal?LEFT_ALIGN:TOP_ALIGN],s2=markerSize[isHorizontal?RIGHT_ALIGN:BOTTOM_ALIGN],range=scaleObj.range(),domain=scaleObj.domain(),min=range[0],max=range[1],available1=0,available2=0;if(correctionFactor=correctionFactor||0,scaleObj.bandwidth){available1=scaleObj(domain[0])+scaleObj.bandwidth()/2-min-5,available2=max-(scaleObj(domain[domain.length-1])+scaleObj.bandwidth()/2)-5}else available1=available2=correctionFactor/2*(max-min);return[min-=mathMax(0,s1-available1),max+=mathMax(0,s2-available2)]},DataProcessor.prototype.overMarker=function(domain,type,index,correctionFactor){var chartObj=this.chartObj,axisConf="x"===type?this.xaxisData:this.yaxesData[index],orient=chartObj.axes[type].orient,range=[0,chartObj.plotarea[orient===LEFT_ALIGN?"height":"width"]],scale=d3_scaleLinear().domain(domain).range(range),updatedRange=this.updateMinMaxForMarker(scale,type,correctionFactor),min=defined(axisConf.minRange)?0:range[0]-updatedRange[0],max=defined(axisConf.maxRange)?0:updatedRange[1]-range[1],rangeDiff=range[1]-range[0],factor=(domain[1]-domain[0])/(rangeDiff-min-max);return[min*factor,max*factor]},renderer_helpers.getWaterfallCategoriesConfig=function(plotOptions,commonPlotOptions){return{cascaded:plotOptions&&plotOptions.cascadeCategories?mergeJSON(commonPlotOptions.cascadeCategories,plotOptions.cascadeCategories,!0):commonPlotOptions.cascadeCategories,rising:plotOptions&&plotOptions.risingCategories?mergeJSON(commonPlotOptions.risingCategories,plotOptions.risingCategories,!0):commonPlotOptions.risingCategories,falling:plotOptions&&plotOptions.fallingCategories?mergeJSON(commonPlotOptions.fallingCategories,plotOptions.fallingCategories,!0):commonPlotOptions.fallingCategories}},colorscale_helpers.getWaterfallColor=function(data,config,defaultColor){return data.isCascaded?config.cascaded.color||defaultColor:data.isPositive?config.rising.color||defaultColor:config.falling.color||defaultColor},svg_plot_renderer.waterfallHelpers=function(){},svg_plot_renderer.waterfallHelpers.drawComparisonLine=function(group,data,config){var chartObj=config.chart,comparatorData=function(points,config){var chartObj=config.chart,renderer=config.renderer,dataset=chartObj.dataset,seriesindex=config.seriesindex,yaxiscolumnorder=config.yaxiscolumnorder,stacked=config.stacked,processedStackedData=chartObj.dataObject.processedStackedData,barSize=(DataProcessor.helpers.isCatNull(dataset,"y",yaxiscolumnorder),points.length,config.axisrotated?renderer.getParamValue("height",points[0],seriesindex,null,renderer.commonOption):renderer.getParamValue("width",points[0],seriesindex,null,renderer.commonOption)),stackExtent=(mathMin(barSize/10,1),config.chart.dataObject.stackedChart?config.chart.dataObject.groupedByStack.get(0).stackExtent:null),cascadeCounter=(function(points){points.filter(function(d,i){return d.isCascaded})}(points),0),comparatorPathData=[];return points.map(function(d,i){var point_now=points[i];if(point_now.isCascaded&&points[i+1]){var cascaded_next=function(points,index,config){var point_now=points[index],stackExtent=config.chart.dataObject.stackedChart?config.chart.dataObject.groupedByStack.get(0).stackExtent:null,maxY=0,maxPoint=point_now;if(point_now){for(;!point_now.isCascaded;){var point_now_y=getY(point_now,stackExtent);if(point_now_y>maxY&&(maxPoint=point_now,maxY=point_now_y),!(point_now=points[++index]))return}return{point:point_now,maxPt:maxPoint}}}(points,i+1,config);if(cascaded_next){var intermediateMaxPt=cascaded_next.maxPt,intermediate_x=(getTransValue(point_now,"x",config,stackExtent),getTransValue(intermediateMaxPt,"x",config,stackExtent)),intermediate_y=getTransValue(intermediateMaxPt,"y",config,stackExtent),point_now_x=getTransValue(point_now,"x",config,stackExtent),point_now_y=getTransValue(point_now,"y",config,stackExtent),point_now_width=getTransValue(point_now,"width",config,stackExtent),point_now_height=getTransValue(point_now,"height",config,stackExtent),point_now_unshared=0==point_now.index||point_now.index==points.length-1,point_next=cascaded_next.point,movingSteps=function(source,target,intermediate,mSize,config){var step_1,step_2,step_3,step_4,axisrotated=config.axisrotated,stacked=config.chart.dataObject.stacked,datalabelPadding=config.chart.dataObject.waterfall.datalabelPadding,x_target=mathMax(intermediate.x,stacked?target.x:target.x+target.width),y_target=mathMin(intermediate.y,target.y),width_source=source.unshared?source.width/2:source.width/2+source.width/4,width_target=target.unshared?target.width/2:target.width/4,height_source=source.unshared?source.height/2:source.height/4,height_target=target.unshared?target.height/2:target.height/2+target.height/4;return axisrotated?(step_1=[source.x+source.width+datalabelPadding,source.y+height_source],step_2=[x_target+datalabelPadding+30,source.y+height_source],step_3=[x_target+datalabelPadding+30,target.y+height_target],step_4=[target.x+target.width+datalabelPadding,target.y+height_target]):(step_1=[source.x+width_source,source.y-datalabelPadding],step_2=[source.x+width_source,y_target-datalabelPadding-30],step_3=[target.x+width_target,y_target-datalabelPadding-30],step_4=[target.x+width_target,target.y-datalabelPadding]),[step_1,step_2,step_3,step_4]}({x:point_now_x,y:point_now_y,width:point_now_width,height:point_now_height,unshared:point_now_unshared},{x:getTransValue(point_next,"x",config,stackExtent),y:getTransValue(point_next,"y",config,stackExtent),width:getTransValue(point_next,"width",config,stackExtent),height:getTransValue(point_next,"height",config,stackExtent),unshared:0==point_next.index||point_next.index==points.length-1},{x:intermediate_x,y:intermediate_y},0,config);if(stacked){var point_now_stkd=processedStackedData[point_now.index],point_next_stkd=processedStackedData[point_next.index];movingSteps.y=(point_next_stkd.stackedValue-point_now_stkd.stackedValue)/mathMax(point_now_stkd.stackedValue,point_next_stkd.stackedValue)*100}else movingSteps.y=(point_next.y-point_now.y)/point_now.y*100;point_next.percent=movingSteps.y,0==cascadeCounter&&0!=i&&(renderer.getParamValue("y",points[0],seriesindex,null,renderer.commonOption),point_now.percent=(point_now.y-points[0].y)/point_now.y*100),comparatorPathData.push(movingSteps)}cascadeCounter++}}),comparatorPathData}(data,config),plotoptions=config.plotoptions,commonPlotOptions=config.commonPlotOptions,animationOptions=getAnimationConf(commonPlotOptions,plotoptions,chartObj,"waterfall"),isAnimationEnable=animationOptions.enabled,comparisonConfig=plotoptions&&plotoptions.comparisonLine?mergeJSON(commonPlotOptions.comparisonLine,plotoptions.comparisonLine,!0):commonPlotOptions.comparisonLine;config.animationOptions=animationOptions;var d3Line=d3_line().x(function(d,i){return d[0]}).y(function(d,i){return d[1]});appendEle(appendEle(group,"g",comparisonConfig.enabled?[1]:[],".","class","zccomparisonLines"),"path",comparatorData,".","class","lines",null,function(d){return d.y}).attr("d",function(d,i){return d3Line(d)}).styles({fill:"none",stroke:comparisonConfig.strokeColor||"black","stroke-width":comparisonConfig.strokeWidth||1,"stroke-dasharray":getDashArray(comparisonConfig.dashStyle,comparisonConfig.strokeWidth||1),"stroke-opacity":0}).transition().duration(isAnimationEnable?animationOptions.duration:0).styles({"stroke-opacity":comparisonConfig.strokeOpacity||1}),function(group,data,comparatorData,comparisonConfig,config){var chartObj=config.chart,isAnimationEnable=config.animationOptions.enabled,axisrotated=config.axisrotated,renderer=config.renderer,seriesindex=config.seriesindex,barSize=axisrotated?renderer.getParamValue("height",data[0],seriesindex,null,renderer.commonOption):renderer.getParamValue("width",data[0],seriesindex,null,renderer.commonOption),mSize=mathMin(barSize/10,1),markerPosition=function(comparatorData){return comparatorData.map(function(d,i){return comparatorData[i][3]})}(comparatorData),symbolSize={inner:0,outer:1},symbolType=axisrotated?"triangle-left":"triangle-down";appendEle(appendEle(group,"g",comparisonConfig.enabled?[1]:[],".","class","zcmarkerPointers"),"g",markerPosition,".","class","markers",null,function(d,i){return comparatorData[i].y}).each(function(d,j){var m=d3_select(this);m.attrs({transform:function(d){return"translate("+d[0]+","+d[1]+")"}}).style("opacity",0).transition().duration(isAnimationEnable?config.animationOptions.duration:0).style("opacity",1),addSVGmarker(m,null,{size:mSize,symbol:symbolType,outerFillOpacity:comparisonConfig.strokeOpacity,outerStrokeOpacity:comparisonConfig.strokeOpacity},{symbolSize:symbolSize,color:comparisonConfig.strokeColor||"black"},chartObj)})}(group,data,comparatorData,comparisonConfig,config),function(group,points,comparisonConfig,config){var chartObj=config.chart,systemConf=chartObj.systemConf,axisrotated=config.axisrotated,isAnimationEnable=config.animationOptions.enabled,labelConfig=comparisonConfig.label||{},labelPos=labelConfig.labelPos,labelSize=utils.getVal(getValByPriority([labelConfig,systemConf.chart,systemConf.canvas,$ZCG],"fontSize")),labelFixedPos="fixedTop"==labelPos?axisrotated?chartObj.plotarea.width:labelSize:null,defaultFormatConf={format:{decimalPlaces:"2",signEnabled:!0,suffix:"%"}},labelG=appendEle(group,"g",comparisonConfig.enabled?[1]:[],".","class","zccomparisonLabels");appendEle(labelG,"text",points,".","class","labels",null,function(d){return d.y}).attrs({x:function(d,i){return axisrotated?labelFixedPos||d[1][0]+10:d[0][0]+(d[2][0]-d[0][0])/2},y:function(d,i){return axisrotated?d[1][1]+(d[2][1]-d[1][1])/2:labelFixedPos||d[1][1]-10}}).text(function(d,i){return getFormattedValue(defaultFormatConf,d.y,NUMERIC_DATATYPE,chartObj)}).styles({"text-anchor":axisrotated?"fixedTop"==labelPos?"end":"start":"middle",opacity:0}).transition().duration(isAnimationEnable?config.animationOptions.duration:0).styles({opacity:1}),applyFont(labelG,[labelConfig,systemConf.chart,systemConf.canvas,$ZCG])}(group,comparatorData,comparisonConfig,config)};svg_plot_renderer.waterfallHelpers.drawComparisonLine;function assignDataValues(processor,xidx,itemIndex,xVal,totalY,netPositiveSum,previousNetPositiveSum,isCascaded){var data=[];return data[xidx]=xVal,data.y0=previousNetPositiveSum[itemIndex],data.y=netPositiveSum-previousNetPositiveSum[itemIndex],data.index=itemIndex,data.stackedValue=totalY,data.isPositive=isPositive(totalY),data.isCascaded=isCascaded,isCascaded&&(processor.waterfall.hasPositiveCascaded=processor.waterfall.hasPositiveCascaded||data.isPositive,processor.waterfall.hasNegativeCascaded=processor.waterfall.hasNegativeCascaded||!data.isPositive),data}function addDummyData(x,y,xidx,yidx,itemidx,array){var duplicate=[];return duplicate.splice(xidx,0,x),duplicate.splice(yidx,0,0),duplicate.isDummy=!0,duplicate.index=itemidx,duplicate.y=y,duplicate.y0=0,array.splice(itemidx,0,duplicate),duplicate}DataProcessor.prototype.processDataForWaterFall=function(processor){var finalSum,dataset=processor.dataset,data=processor.data,dataObject=processor.chartObj.dataObject,processedseriesData=processor.processedseriesData,seriesLength=processedseriesData.length,xCategories=(dataObject.getCategories("x"),dataObject.getCategories("x")),xCategoriesLength=xCategories.length,stacked=processor.isstacked("waterfall"),cascaded_dataindex=validateNullVal(data.chart.plot.plotoptions.waterfall.cascadeCategories.dataindex,2),allYValues=[];if(processor.waterfall={},processor.waterfall.comparator=[],stacked){for(var isCascaded,seriesSet=[],categoriesSet=[],grossPositiveSum=[],grossNegativeSum=[],netPositiveSum=[],netNegativeSum=[],previousNetPositiveSum=[],baseValue=0,totalY=0,i=0;i<xCategoriesLength;i++){var currentCategory=xCategories[i];previousNetPositiveSum[i]=netPositiveSum[i]=netNegativeSum[i]=baseValue;for(var j=0;j<seriesLength;j++){var d=processedseriesData[j],ishideable=d.disabled,currentseriesdata=d.data,subgroupLength=currentseriesdata.length,yaxiscolumnorder=DataProcessor.helpers.getParsedYAxisOrder(d.yaxiscolumnorder),yidx=dataset.yidx(yaxiscolumnorder);if(!ishideable)for(var k=0;k<subgroupLength;k++){var subgroup=currentseriesdata[k],isIntermediateSum=(data=subgroup[i])[cascaded_dataindex];dataset.getActualX(data)!==currentCategory&&(data=addDummyData(currentCategory,0,dataset.xidx,dataset.yidx(yaxiscolumnorder),i,subgroup),isIntermediateSum=!1);var y=dataset.getY(data,yaxiscolumnorder);isIntermediateSum?(0==j&&(previousNetPositiveSum[i]=netPositiveSum[i]=netNegativeSum[i]=0),isCascaded=data.isCascaded=!0,seriesSet[j]=seriesSet[j]?seriesSet[j]:y,data[yidx]=data.y=y||seriesSet[j]):(isCascaded=!1,data.y=y,seriesSet[j]=seriesSet[j]?data.y+seriesSet[j]:data.y);var isPositiveNum=isPositive(data.y);data.y0=isPositiveNum?netPositiveSum[i]:netNegativeSum[i],isPositiveNum?(netPositiveSum[i]=data.y+netPositiveSum[i],grossPositiveSum[i]=grossPositiveSum[i]?grossPositiveSum[i]+data.y:data.y,data.isPositive=!0):(netNegativeSum[i]=data.y+netNegativeSum[i],grossNegativeSum[i]=grossNegativeSum[i]?grossNegativeSum[i]+data.y:data.y),data.index=i}}allYValues.push(netPositiveSum[i],netNegativeSum[i]),baseValue=isPositive(totalY=(grossPositiveSum[i]||0)+(grossNegativeSum[i]||0))?netPositiveSum[i]:netNegativeSum[i];var obj=assignDataValues(processor,dataset.xidx,i,currentCategory,totalY,baseValue,previousNetPositiveSum,isCascaded);categoriesSet[i]=obj}processor.processedStackedData=categoriesSet;var groupedByStack=dataObject.groupedByStack;groupedByStack.has(0)||groupedByStack.set(0,{}),groupedByStack.get(0).stackExtent=updateStackExtent(d3$1.range(xCategories.length),grossPositiveSum,grossNegativeSum,netPositiveSum,netNegativeSum)}else processedseriesData.forEach(function(d,i){var currentseriesdata=d.data,yaxiscolumnorder=DataProcessor.helpers.getParsedYAxisOrder(d.yaxiscolumnorder),yidx=dataset.yidx(yaxiscolumnorder);currentseriesdata.forEach(function(subgroup,j){xCategories.forEach(function(cat,k){var currentCategory=cat,data=subgroup[k];if((data?dataset.getActualX(data).toString():null)===currentCategory.toString()){if(data[cascaded_dataindex]){var actualY=dataset.getY(data,yaxiscolumnorder);data.y0=0,data.y=actualY||0==k?dataset.getY(data,yaxiscolumnorder):finalSum,finalSum=data.y,data[yidx]=data.y,data.isCascaded=!0,data.isPositive=isPositive(data.y),processor.waterfall.hasPositiveCascaded=processor.waterfall.hasPositiveCascaded||data.isPositive,processor.waterfall.hasNegativeCascaded=processor.waterfall.hasNegativeCascaded||!data.isPositive}else data.y0=finalSum||0,data.y=dataset.getY(data,yaxiscolumnorder),finalSum=data.y+data.y0,data.isPositive=isPositive(data.y);data.index=k,allYValues.push(finalSum)}else addDummyData(currentCategory,null,dataset.xidx,dataset.yidx(yaxiscolumnorder),k,subgroup)})})});return d3_extent(allYValues)},DataProcessor.prototype.getCorrectionForWaterfall=function(domain,type,index,chartObj,hasLabelCorrection){var isComparisonEnabled=function(chartObj,index){var data=chartObj.dataObject.groupedDataBySplitAxes[index],commonPlotOptions=chartObj.systemConf.chart.plot.plotoptions.waterfall;return data.some(function(d,i){var seriesIndex=d.si,plotoptions=chartObj.seriesdata[seriesIndex].plotoptions;return(plotoptions&&plotoptions.comparisonLine?mergeJSON(commonPlotOptions.comparisonLine,plotoptions.comparisonLine,!0):commonPlotOptions.comparisonLine).enabled})}(chartObj,index);hasLabelCorrection=!chartObj.datalabels.hasFixedPosition&&hasLabelCorrection;var handleOverlap=chartObj.systemConf.chart.plot.datalabels.handleOverlapping,needLabelAdjustment=chartObj.datalabels.isStackedLabels||chartObj.datalabels.hasFixedPosition||!handleOverlap,datalabelExtraPadding=hasLabelCorrection?needLabelAdjustment?10:0:10;chartObj.dataObject.waterfall.datalabelPadding=hasLabelCorrection?chartObj.dataObject.rangeCorrections.datalabels.y0+datalabelExtraPadding:datalabelExtraPadding;var correction_comp,domainDiff=(domain=function(domain){domain[1]<0&&(domain[1]=0);return domain}(domain))[1]-domain[0],orient=chartObj.axes.y.orient,rangeDiff=chartObj.plotarea["left"==orient?"height":"width"],totalAdjustment=5,correction=domainDiff/(rangeDiff-totalAdjustment)*totalAdjustment;if(isComparisonEnabled){correction_comp=domainDiff/(rangeDiff-(totalAdjustment+=function(chartObj,data){var commonPlotOptions=chartObj.systemConf.chart.plot.plotoptions.waterfall,axisrotated=chartObj.axes.rotated,systemconf=chartObj.systemConf,labelSize=0,element=appendEle(chartObj.staticPaneSVG.selectAll("g.labelholder"),"text",[1],".","class","dummyText");return chartObj.seriesdata.forEach(function(d,i){if(d.plotoptions||!labelSize){var plotoptions=d.plotoptions,labelConfig=(plotoptions&&plotoptions.comparisonLine?mergeJSON(commonPlotOptions.comparisonLine,plotoptions.comparisonLine,!0):commonPlotOptions.comparisonLine).label;element.text("800%").style("fill","none"),applyFont(element,[labelConfig,systemconf.chart,systemconf.canvas,$ZCG]);var clientRect=bbox(element.node());labelSize=mathMax(axisrotated?clientRect.width:clientRect.height,labelSize)}}),element.remove(),labelSize+10}(chartObj)+30+datalabelExtraPadding))*totalAdjustment}return domain[1]+=isComparisonEnabled?correction_comp:correction,domain[0]-=chartObj.dataObject.waterfall.hasNegativeCascaded?correction:0,domain};var svg_patterns=function(){};svg_patterns.imageFill=function(properties,patternID,offset,returnSVGimage,base64,chartObj,renderToSvg){var w=properties.width,h=properties.height;return renderToSvg.select("defs").append("pattern").attrs({patternUnits:"userSpaceOnUse",id:patternID,width:w,height:h,x:properties.x||0,y:properties.y||0}).append("image").attrs({"xlink:href":properties.name,x:0,y:0,width:w,height:h}),patternID},svg_patterns.svgPatternFill=function(properties,patternID,offset,returnSVGimage,base64,chartObj,renderToSvg,patternUnits){var patternEle;if(patternEle=null!=properties.ele?function(ele,properties,patternID,patternUnits,renderToSvg){var pattern_svg=renderToSvg,bgClr=properties.bgClr||properties.bgClr_base,customele=invokeFunction(ele,bgClr);properties.ele=customele.replace(/\{\{clr\}\}/g,bgClr);var bb,patternNode=pattern_svg.select("defs").append("pattern").attrs({patternUnits:patternUnits||"userSpaceOnUse",id:patternID,x:properties.x||0,y:properties.y||0}).html(properties.ele);$Browser.FIREFOX?pattern_svg.append("g").html(properties.ele).each(function(){bb=bbox(this)}).remove():bb=bbox(patternNode.node().firstChild);var w=bb.width,h=bb.height;return patternNode.attrs({width:w,height:h}),{node:patternNode,w:w,h:h,id:patternID}}(properties.ele,properties,patternID,patternUnits,renderToSvg):function(properties,patternID,patternUnits,renderToSvg){var pattern_svg=renderToSvg,bgClr_base=properties.bgClr||properties.bgClr_base,stroke_base=properties.stroke||properties.stroke_base,regExp=/\{\{([a-z]+)\}\}/,symbolTypes=(properties.type||"").split(","),noOfSymbols=symbolTypes.length,size=(properties.size||"").split(","),strokeWidth=(properties.strokeWidth||"").split(","),fillColor=bgClr_base.split(","),stroke=stroke_base.split(","),fillOpacity=(properties.fillOpacity||"").split(","),strokeOpacity=(properties.strokeOpacity||"").split(","),translate=properties.translate?properties.translate.split(","):null;size=properties.width?getPatternSize(properties,size):size;for(var patternNode=pattern_svg.select("defs").append("pattern").attrs({id:patternID,patternUnits:patternUnits||"userSpaceOnUse",width:size[0],height:size[0],x:properties.x||0,y:properties.y||0}),i=0;i<noOfSymbols;i++){var pattern_path=getSVGsymbol(symbolTypes[i])(size[i]||size[0]),stroke_cur=isNull(stroke[i]||stroke[0])?properties.stroke_base:"static"==(stroke[i]||stroke[0])?properties.customStaticClr:stroke[i]||stroke[0],fill_cur=isNull(fillColor[i]||fillColor[0])?properties.bgClr_base:"static"==(fillColor[i]||fillColor[0])?properties.customStaticClr:fillColor[i]||fillColor[0],trans_cur=(size[i]||size[0])/2;if(stroke_cur=regExp.test(stroke_cur)?getColorCopy(properties.stroke_base,1,stroke_cur.replace(regExp,"$1"),d3_hsl):stroke_cur,fill_cur=regExp.test(fill_cur)?getColorCopy(properties.bgClr_base,1,fill_cur.replace(regExp,"$1"),d3_hsl):fill_cur,translate){var subTranslate=translate[i]||translate[0];trans_cur+=parseFloat(subTranslate)}patternNode.append("path").attrs({transform:"translate("+trans_cur+","+trans_cur+")",d:pattern_path,stroke:stroke_cur,fill:fill_cur,"stroke-width":strokeWidth[i]||strokeWidth[0],"stroke-opacity":strokeOpacity[i]||strokeOpacity[0],"fill-opacity":fillOpacity[i]||fillOpacity[0]})}return{node:patternNode,w:size[0],h:size[0],id:patternID}}(properties,patternID,patternUnits,renderToSvg),returnSVGimage){var xml="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='"+patternEle.w+"' height='"+patternEle.h+"'>"+(new XMLSerializer).serializeToString(patternEle.node.node())+"<path d='"+getSVGsymbol("square")(mathMin(patternEle.w,patternEle.h))+"' transform='translate("+patternEle.w/2+","+patternEle.h/2+")' style='fill: url(#"+patternEle.id+")'></path> </svg>";return{url:$Browser.FIREFOX||base64?"data:image/svg+xml;base64,"+btoa(xml):"data:image/svg+xml;utf8,"+xml,node:patternEle.node,w:patternEle.w,h:patternEle.h,id:patternEle.id}}return patternEle},effects.svg_patterns=svg_patterns;var gradient_helpers={getDimension:function(chartObj,seriesIndex){if(chartObj.dataObject.isPolarAxisCategory){var r=chartObj.plotarea_approx.radius;return{r:r,x1:-r,x2:r,y1:-r,y2:r}}if(chartObj.isAxisCategory){var rp=chartObj.rendererConf[seriesIndex].params,cType=chartObj.chartTypes[seriesIndex].value,axes=chartObj.systemConf.chart.axes,xReversed=axes.xaxis.reversed,yReversed=axes.yaxis[rp.yaxiscolumnorder].reversed,xScale=rp.xscale,yScale=rp.yscale,xRange=xScale.range(),yRange=yScale.range(),getAdjustedRange=function(scaleObj,range){if(scaleObj.bandwidth&&(isAreaChartType(cType)||cType===charttype.line)){var bwBy2=scaleObj.bandwidth()/2,sign=range[0]<range[1]?1:-1;return[range[0]+bwBy2*sign,range[1]-bwBy2*sign]}return range};return xRange=getAdjustedRange(xScale,xRange),yRange=getAdjustedRange(yScale,yRange),rp.axisrotated?{x1:yRange[+!yReversed],x2:yRange[+!!yReversed],y1:xRange[+!xReversed],y2:xRange[+!!xReversed]}:{x1:xRange[+!!xReversed],x2:xRange[+!xReversed],y1:yRange[+!!yReversed],y2:yRange[+!yReversed]}}}};function getStops(gradient,properties,color,type){var stopoffset=properties.stopOffset,stopopacity=properties.stopOpacity,stopcolor=properties.stopColor,colorgamma=properties.colorGamma||[1,0],spread=properties.spreadMethod,radius="radial"==type?+properties.radius:mathMax(mathAbs((+properties.x2||0)-(+properties.x1||0)),mathAbs((+properties.y2||0)-(+properties.y1||0)));if(stopoffset=stopoffset||["0%","100%"],stopcolor=("function"==typeof stopcolor?stopcolor(color):stopcolor)||stopoffset.map(function(d,i){return getColorCopy(color,colorgamma[i]||0,"brighter",d3_hsl)}),stopopacity=stopopacity||[1,1],("repeat"===spread||"reflect"===spread)&&($Browser.IS_IOS||$Browser.SAFARI)){for(var newStopoffset=[],newStopColor=[],newStopOpacity=[],step=0,repeat=0;step<100;){for(var i=0,len=stopoffset.length;i<len;i++){var newOffset=mathMin(parseFloat(stopoffset[i])/100*radius+step,100);newStopoffset.push(newOffset+"%"),newStopOpacity.push(repeat%2!=0?stopopacity[stopopacity.length-1-i]:stopopacity[i]),newStopColor.push(repeat%2!=0?stopcolor[stopcolor.length-1-i]:stopcolor[i])}step+=radius,repeat+="reflect"===spread?1:0}stopoffset=newStopoffset,stopcolor=newStopColor,stopopacity=newStopOpacity}return{offset:stopoffset,color:stopcolor,opacity:stopopacity}}var mag,angle,ellipseFromEllipticalArc,parseSvg,SVGParser=(mag=function(v){return mathSQRT(mathPow(v[0],2)+mathPow(v[1],2))},angle=function(u,v){var sign=1;return u[0]*v[1]-u[1]*v[0]<0&&(sign=-1),sign*Math.acos(function(u,v){var rat=function(u,v){return u[0]*v[0]+u[1]*v[1]}(u,v)/(mag(u)*mag(v));return rat<0?mathMax(-1,rat):mathMin(1,rat)}(u,v))},ellipseFromEllipticalArc=function(x1,rx,ry,phi,fA,fS,x2,options){if(0!==rx&&0!==ry){phi*=Math.PI/180,rx=Math.abs(rx),ry=Math.abs(ry);var factor,u,v,xPrime=function(v,angle){var cost=mathCos(angle),sin=Math.sin(angle);return[cost*v[0]+sin*v[1],-1*sin*v[0]+cost*v[1]]}((v=x2,[((u=x1)[0]-v[0])/2,(u[1]-v[1])/2]),phi),xPrime2=function(u,v){return[u[0]*v[0],u[1]*v[1]]}(xPrime,xPrime),rx2=mathPow(rx,2),ry2=mathPow(ry,2),lambda=mathSQRT(xPrime2[0]/rx2+xPrime2[1]/ry2);lambda>1&&(ry*=lambda,rx2=mathPow(rx*=lambda,2),ry2=mathPow(ry,2)),factor=mathSQRT(Math.abs((rx2*ry2-rx2*xPrime2[1]-ry2*xPrime2[0])/(rx2*xPrime2[1]+ry2*xPrime2[0]))),fA===fS&&(factor*=-1);var cPrime=function(c,v){return[c*v[0],c*v[1]]}(factor,[rx*xPrime[1]/ry,-ry*xPrime[0]/rx]),c=function(u,v){return[u[0]+v[0],u[1]+v[1]]}(function(v,angle){var cost=mathCos(angle),sin=Math.sin(angle);return[cost*v[0]-sin*v[1],sin*v[0]+cost*v[1]]}(cPrime,phi),function(u,v){return[(u[0]+v[0])/2,(u[1]+v[1])/2]}(x1,x2)),x1UnitVector=[(xPrime[0]-cPrime[0])/rx,(xPrime[1]-cPrime[1])/ry],x2UnitVector=[(-1*xPrime[0]-cPrime[0])/rx,(-1*xPrime[1]-cPrime[1])/ry],start=angle([1,0],x1UnitVector),end=start+angle(x1UnitVector,x2UnitVector);options.push({type:"save",args:[]},{type:"translate",args:[c[0],c[1]]},{type:"rotate",args:[phi]},{type:"scale",args:[rx,ry]},{type:"arc",args:[0,0,1,start,end,1-fS]},{type:"restore",args:[]})}else options.push({type:"lineTo",args:x2})},{parse:parseSvg=function(pathString){var lastCoordinates=[0,0],lastControl=[0,0],options=[],lastCharacter="",firstSubPath=!1;function makeAbsolute(c,coordinates){return-1==="mlazhvcsqt".indexOf(c)?lastCoordinates=coordinates:(lastCoordinates[0]+=coordinates[0],lastCoordinates[1]+=coordinates[1]),lastCharacter=c,lastCoordinates.slice(0)}function makeAbsoluteMultiple(c,seq){for(var r=[],lastPosCopy=lastCoordinates.slice(0),i=0;i<seq.length;i+=2){lastCoordinates=lastPosCopy.slice(0);var coordinates=makeAbsolute(c,seq.slice(i,i+2));r=r.concat(coordinates),i===seq.length-4&&(lastControl=coordinates.slice(0))}return r}function makeReflected(){-1==="CcSsQqTt".indexOf(lastCharacter)&&(lastControl=lastCoordinates.slice(0));var r=[0,0];return r[0]=2*lastCoordinates[0]-lastControl[0],r[1]=2*lastCoordinates[1]-lastControl[1],r}var p,svgPathFunctions={m:function(ch,args){var moveCh=ch;for(firstSubPath&&(moveCh="M",firstSubPath=!1),options.push({type:"moveTo",args:makeAbsolute(moveCh,args)});args.length;)p=args.splice(0,2),options.push({type:"lineTo",args:makeAbsolute(ch,p)})},z:function(){options.push({type:"closePath",args:[]})},l:function(ch,args){for(;args.length;)p=args.splice(0,2),options.push({type:"lineTo",args:makeAbsolute(ch,p)})},h:function(ch,args){var c,x,coordinates;options.push({type:"lineTo",args:(c=ch,x=args,coordinates=[x,0],"H"===c&&(coordinates[1]=lastCoordinates[1]),makeAbsolute(c,coordinates))})},v:function(ch,args){var c,y,coordinates;options.push({type:"lineTo",args:(c=ch,y=args,coordinates=[0,y],"V"===c&&(coordinates[0]=lastCoordinates[0]),makeAbsolute(c,coordinates))})},c:function(ch,args){for(;args.length;)p=args.splice(0,6),options.push({type:"bezierCurveTo",args:makeAbsoluteMultiple(ch,p)})},s:function(ch,args){options.push({type:"bezierCurveTo",args:makeReflected().concat(makeAbsoluteMultiple(ch,args))})},q:function(ch,args){for(;args.length;)p=args.splice(0,6),options.push({type:"quadraticCurveTo",args:makeAbsoluteMultiple(ch,args)})},t:function(ch,args){var reflected=makeReflected();options.push({type:"quadraticCurveTo",args:reflected.concat(makeAbsoluteMultiple(ch,args))}),lastControl=reflected.slice(0)},a:function(ch,args){var x1=[lastCoordinates.slice()],x2=[makeAbsolute(ch,args.slice(-2))],absArgs=x1.concat(args.slice(0,-2),x2,[options]);ellipseFromEllipticalArc.apply(this,absArgs)}},steps=parseSVGPath(pathString);return steps.length&&steps.forEach(function(step){var stepLowerCase=step.function.toLowerCase();svgPathFunctions[stepLowerCase](step.type,step.moves)}),options},drawPath:function(pathString,context){parseSvg(pathString).forEach(function(command){context[command.type].apply(context,command.args)})}}),canvasUtils={drawPath:function(ctx,pathString){SVGParser.drawPath(pathString,ctx)},getRadianAngle:function(degreeValue){return degreeValue*mathPI/180},constant:function(x){return function(){return x}},pointX:function(p){return p[0]},pointY:function(p){return p[1]},rgba:function(color,opacity){opacity=pick(opacity,1);var rgb=d3_rgb(color);return"rgba("+rgb.r+","+rgb.g+","+rgb.b+","+opacity*rgb.opacity+")"},roundedRect:function(context,x,y,width,height,radius,yReversed,axisrotated){var path=roundedRect(x,y,width,height,radius,yReversed,axisrotated);SVGParser.drawPath(path,context)},boundBoxWithHook:function(context,pathDescription){SVGParser.drawPath(pathDescription,context)},getFontStyles:function(chartObj,dataLabels,color,isInnerLabel,seriesIndex,isStackLabel){return applyDatalabelFonts(null,dataLabels,chartObj,color,isInnerLabel,seriesIndex,isStackLabel)}},canvas_gradients=function(){},types={};canvas_gradients.create=function(context,patternName,properties,offset){if(/threshold/gi.test(patternName))return types[patternName](context,properties,offset);var safari=$Browser.SAFARI;$Browser.SAFARI=0;var stop=getStops(0,properties,properties.color,patternName),gradient=types[patternName](context,properties,stop);return $Browser.SAFARI=safari,gradient},canvas_gradients.canvasGradientFill=types.canvasGradientFill=function(properties,gradientID,offset,returnSVGimage,base64,chartObj){return defined(chartObj.context)||(chartObj.context=document.createElement("canvas").getContext("2d")),properties&&properties.type?canvas_gradients[properties.type](properties,gradientID,offset,returnSVGimage,base64,chartObj):null},canvas_gradients.linear=types.linear=function(properties,gradientID,offset,returnSVGimage,base64,chartObj){var boundX1,boundX2,boundY1,boundY2,context=chartObj.context,dimension=properties.dimension,spread=properties.spreadMethod,x1=+properties.x1||0,x2=+properties.x2||0,y1=+properties.y1||0,y2=+properties.y2||0,stops=getStops(0,properties,properties.color,"linear"),dim="repeat"!==spread&&"reflect"!==spread||!$Browser.IS_IOS&&!$Browser.SAFARI?100:mathMax(mathAbs(x2-x1),mathAbs(y2-y1));isArray(dimension)?(boundX1=0,boundX2=dimension[0],boundY1=0,boundY2=dimension[1]):(boundX1=dimension.x1||0,boundX2=dimension.x2||0,boundY1=dimension.y1||0,boundY2=dimension.y2||0);var xScale=d3_scaleLinear().domain([0,100]).range([boundX1,boundX2].sort(d3_ascending)),yScale=d3_scaleLinear().domain([0,100]).range([boundY1,boundY2].sort(d3_ascending)),x0=xScale(100*x1/dim),y0=(x1=xScale(100*x2/dim),yScale(100*y1/dim)),gradient=(y1=yScale(100*y2/dim),context.createLinearGradient(x0,y0,x1,y1));return addStop(gradient,stops,properties.opacity),gradient},canvas_gradients.radial=types.radial=function(properties,gradientID,offset,returnSVGimage,base64,chartObj){var context=chartObj.context,dimension=properties.dimension,spread=properties.spreadMethod,stops=getStops(0,properties,properties.color,"radial"),r=isArray(dimension)?defined(dimension[2])?dimension[2]:dimension[0]:dimension.r,w=isArray(dimension)?r:dimension.x2-dimension.x1,h=isArray(dimension)?r:dimension.y2-dimension.y1,x=w/100*properties.x||0,y=h/100*properties.y||0,radius="repeat"!==spread&&"reflect"!==spread||!$Browser.IS_IOS&&!$Browser.SAFARI?r/100*properties.radius:r,gradient=context.createRadialGradient(x,y,0,x,y,radius);return addStop(gradient,stops,properties.opacity),gradient},canvas_gradients.thresholdLinear=types.thresholdLinear=function(properties,gradientID,offset,returnSVGimage,base64,chartObj){var context=chartObj.context,stop={opacity:[],offset:[],color:[]};offset.forEach(function(d){stop.opacity.push(1),stop.offset.push(d.offset),stop.color.push(d.color)});var gradient=context.createLinearGradient(properties.x1,properties.y1,properties.x2,properties.y2);return addStop(gradient,stop,properties.opacity),gradient};var addStop=function(gradient,stop,stopOpacity){var n=stop.offset.length,i=-1;for(stopOpacity=stopOpacity||1;++i<n;){var opacity=mathAbs(1-(validateNullVal(stop.opacity[i],1)+stopOpacity)),color=rgba_canvas(stop.color[i],opacity);gradient.addColorStop(parseFloat(stop.offset[i])/100,color)}};effects.canvas_gradients=canvas_gradients;var svg_gradients=function(){};function addStop$1(gradient,properties,color,type){for(var stops=getStops(0,properties,color,type),i=0;i<stops.offset.length;i++)gradient.append("stop").attr("offset",stops.offset[i]).styles({"stop-color":stops.color[i],"stop-opacity":stops.opacity[i]})}svg_gradients.get=function(gradient,color,dimension,offset,chartObj,defaultOpacity){var gradientTypeName=gradient.type;if(gradientTypeName&&gradientTypeName!==NONE){var mode=chartObj?chartObj.plot.renderer.mode:"svg",properties=gradient.options[gradientTypeName]||gradient.options,propObj=simpleClone(properties);switch(propObj.color=null!=color?color:propObj.color,propObj.dimension=null!=dimension?dimension:propObj.dimension,propObj.defsLocation=chartObj?chartObj.defsLocation:"",propObj.id=chartObj.id,mode){case"canvas":return propObj.pointOpacity=defaultOpacity||1,canvas_gradients.create(chartObj.context,gradientTypeName,propObj,offset);default:return effects.get(svg_gradients,gradientTypeName,propObj,{offset:offset,chartObj:chartObj})}}},svg_gradients.svgGradientFill=function(properties,gradientID,offset,returnSVGimage,base64,chartObj,renderToSvg){return properties&&properties.type?svg_gradients[properties.type](properties,gradientID,offset,returnSVGimage,base64,chartObj,renderToSvg):null},svg_gradients.radial=function(properties,gradientID,type,returnSVGimage,base64,chartObj,renderToSvg){var svg=renderToSvg,color=properties.color,dimension=properties.dimension,spread=properties.spreadMethod,r=isArray(dimension)?defined(dimension[2])?dimension[2]:dimension[0]:dimension.r,x=+properties.x||0,y=+properties.y||0,radius=+properties.radius||0,scaleTemplate=d3_scaleLinear().domain([0,100]),gradient=svg.select("defs").append("radialGradient").attrs({id:gradientID,gradientUnits:properties.gradientUnits||"userSpaceOnUse",spreadMethod:spread});if("objectBoundingBox"===properties.gradientUnits)gradient.attrs({cx:x+"%",cy:y+"%",r:radius+"%"});else{var w=isArray(dimension)?r:dimension.x2-dimension.x1,h=isArray(dimension)?r:dimension.y2-dimension.y1,xScale=scaleTemplate.copy().range([0,w]),yScale=scaleTemplate.copy().range([0,h]),rScale=scaleTemplate.copy().range([0,r]);gradient.attrs({cx:xScale(x),cy:yScale(y),r:"repeat"!==spread&&"reflect"!==spread||!$Browser.IS_IOS&&!$Browser.SAFARI?rScale(radius):r})}return addStop$1(gradient,properties,color,"radial"),gradientID},svg_gradients.linear=function(properties,gradientID,type,returnSVGimage,base64,chartObj,renderToSvg){var boundX1,boundX2,boundY1,boundY2,svg=renderToSvg,color=properties.color,dimension=properties.dimension,spread=properties.spreadMethod,x1=+properties.x1||0,x2=+properties.x2||0,y1=+properties.y1||0,y2=+properties.y2||0,dim="repeat"!==spread&&"reflect"!==spread||!$Browser.IS_IOS&&!$Browser.SAFARI?100:mathMax(mathAbs(x2-x1),mathAbs(y2-y1));isArray(dimension)?(boundX1=0,boundX2=dimension[0],boundY1=0,boundY2=dimension[1]):(boundX1=dimension.x1||0,boundX2=dimension.x2||0,boundY1=dimension.y1||0,boundY2=dimension.y2||0),/(pie|dial|bubblepie)/.test(type)&&(boundX1=-boundX2,boundY1=-boundY2);var xscale=d3_scaleLinear().domain([0,100]).range([boundX1,boundX2]),yscale=d3_scaleLinear().domain([0,100]).range([boundY1,boundY2]);x1=100*x1/dim,x2=100*x2/dim,y1=100*y1/dim,y2=100*y2/dim;var gradient=svg.select("defs").append("linearGradient").attrs({id:gradientID,gradientUnits:properties.gradientUnits,spreadMethod:spread});return"userSpaceOnUse"==properties.gradientUnits?gradient.attrs({x1:xscale(x1),x2:xscale(x2),y1:yscale(y1),y2:yscale(y2)}):gradient.attrs({x1:x1+"%",x2:x2+"%",y1:y1+"%",y2:y2+"%"}),addStop$1(gradient,properties,color,"linear"),gradientID},svg_gradients.thresholdLinear=function(properties,gradientID,offset,returnSVGimage,base64,chartObj,renderToSvg){return appendEle(renderToSvg.select("defs").append("linearGradient").attrs({id:gradientID,gradientUnits:"userSpaceOnUse",x1:properties.x1,x2:properties.x2,y1:properties.y1,y2:properties.y2}),"stop",offset,".","class","stop").attr("offset",function(d){return d.offset}).attr("stop-color",function(d){return d.color}),gradientID},effects.svg_gradients=svg_gradients;var svg_filters=function(){};svg_filters.chalk=function(properties,filterID,offset,returnSVGimage,base64,chartObj,renderToSvg){var filter=renderToSvg.select("defs").append("filter").attrs({id:filterID,x:-.3,y:-.5,height:2,width:1.6,"color-interpolation-filters":"sRGB"});return filter.append("feTurbulence").attrs({baseFrequency:.32065,seed:115,result:"result1",numOctaves:1,type:"turbulence"}),filter.append("feOffset").attrs({result:"result2",dx:-2,dy:-2}),filter.append("feDisplacementMap").attrs({scale:5,yChannelSelector:"G",in2:"result1",xChannelSelector:"R",in:"SourceGraphic"}),filterID},svg_filters.dropShadow=function(properties,filterID,offset,returnSVGimage,base64,chartObj,renderToSvg){var filter=renderToSvg.select("defs").append("filter").attrs({x:properties.x,y:properties.y,width:properties.width,height:properties.height,id:filterID,filterUnits:properties.filterUnits});if(filter.append("feGaussianBlur").attrs({in:properties.source||"SourceAlpha",stdDeviation:properties.blur}),"SourceGraphic"!==properties.source){filter.append("feOffset").attrs({dx:properties.dx,dy:properties.dy,result:"offsetblur"});var floodColor=properties.color,floodOpacity=null,rgba=floodColor&&floodColor.match(RGBA_PATTERN);rgba&&5===rgba.length&&(floodColor=rgb2hex(floodColor),floodOpacity=rgba[4]),filter.append("feFlood").attrs({"flood-color":floodColor,"flood-opacity":floodOpacity}),filter.append("feComposite").attrs({in2:"offsetblur",operator:"in"});var feMerge=filter.append("feMerge");feMerge.append("feMergeNode"),feMerge.append("feMergeNode").attr("in","SourceGraphic")}return filterID},svg_filters.colorMatrix=function(properties,filterID,offset,returnSVGimage,base64,chartObj,renderToSvg){renderToSvg.select("defs").append("filter").attr("id",filterID).append("feColorMatrix").attrs({in:"SourceGraphic",type:properties.type,values:properties.values});return filterID},svg_filters.freeHand=function(properties,filterID,offset,returnSVGimage,base64,chartObj,renderToSvg){var svg=renderToSvg,filter=(null==properties.scale||properties.scale,svg.select("defs").append("filter").attr("id",filterID));filter.append("feTurbulence").attrs({type:"fractalNoise",baseFrequency:.015,numOctaves:2,result:"turbulence_3","data-filterId":3}),filter.append("feDisplacementMap").attrs({xChannelSelector:"R",yChannelSelector:"G",in:"SourceGraphic",in2:"turbulence_3",scale:properties.scale});return filterID},effects.svg_filters=svg_filters;var svg_clips=function(){};svg_clips.polygon=function(properties,clipID,offset,returnSVGimage,base64,chartObj,renderToSvg){var clipElement=svg_clips.createElement(PATH_ELEMENT,clipID,chartObj,renderToSvg);return svg_clips.setAttributes(clipElement,properties,["d"]),clipID},svg_clips.rect=function(properties,clipID,offset,returnSVGimage,base64,chartObj,renderToSvg){var clipElement=svg_clips.createElement("rect",clipID,chartObj,renderToSvg);return svg_clips.setAttributes(clipElement,properties,["x","y","width","height"]),clipID},svg_clips.circle=function(properties,clipID,offset,returnSVGimage,base64,chartObj,renderToSvg){var clipElement=svg_clips.createElement(CIRCLE_ELEMENT,clipID,chartObj,renderToSvg);return svg_clips.setAttributes(clipElement,properties,["cx","cy","r"]),clipID},svg_clips.createElement=function(elementName,clipID,chartObj,renderToSvg){return($Browser.SAFARI?chartObj.svg:renderToSvg).select("defs").append("clipPath").attr("id",clipID).append(elementName)},svg_clips.setAttributes=function(clipElement,properties,attributes){attributes.forEach(function(attr){clipElement.attr(attr,properties[attr])})},effects.svg_clips=svg_clips;var canvas_patterns=function(){};function fillSVGimageInCanvas(url,options,callback){var img=new Image;img.onload=function(){var dim=function(imageObj,options){var x=0,y=0,w=imageObj.naturalWidth,h=imageObj.naturalHeight,computedWidth=validateNullVal(options.width,50),computedHeight=validateNullVal(options.height,50);if("no-repeat"===options.repeatMode)if(h>w){var remaining=computedWidth-computedWidth*(w/h);x=remaining/2,computedWidth-=remaining}else{var remaining=computedHeight-computedHeight*(h/w);y=remaining/2,computedHeight-=remaining}return{x:x,y:y,width:computedWidth,height:computedHeight}}(img,options),patternCanvas=document.createElement("canvas");patternCanvas.width=dim.width,patternCanvas.height=dim.height,patternCanvas.getContext("2d").drawImage(img,0,0,patternCanvas.width,patternCanvas.height);var fillStyle=options.context.createPattern(patternCanvas,options.repeatMode||"repeat");callback(options.context,fillStyle,dim)},img.src=url}function getMaxTickSize(obj,p){return{vertical:perToPx(pick(obj.height,obj.maxHeight,axis.ticks.maxTickSizeRatio_Vert),p.height),horizontal:perToPx(pick(obj.width,obj.maxWidth,axis.ticks.maxTickSizeRatio_Hori),p.width)}}function hasAutoFormat(formatConf){var format=null!=formatConf?formatConf.axisformat||formatConf.format:null;return format&&"auto"===format.specifier}function handleOverflowTicks(axisgroup,orient,chartObj,rotation,overflow,scaleObj,wrap,axisComp,labelType,ticklabelOptions,index,isPostCalc,redraw){if("none"==overflow)return doHandleOverflow;var ticks,distBwTicks,count,dontUseMargin,plotarea=chartObj.plotarea,chartarea=chartObj.chartarea,canvasarea=chartObj.canvasarea,actChartObj=chartObj.actChartObj||chartObj,axisType=function(orient,rotated){return("bottom"==orient||"top"==orient)&&!rotated||("left"==orient||"right"==orient)&&rotated?"x":"y"}(orient,actChartObj.axes.rotated),axisdata="x"==axisType?actChartObj.systemConf.chart.axes.xaxis:actChartObj.systemConf.chart.axes.yaxis[index||0],overflowPattern=null==overflow||"ellipsis"==overflow?"..":"",tickmarkdataOption=axisdata.tickmark.align,fSize=utils.getVal(getValByPriority([ticklabelOptions,actChartObj.systemConf.chart,actChartObj.systemConf.canvas,$ZCG],"fontSize")),tickObj=(ticklabelOptions="ticklabel"==labelType?ticklabelOptions:{},getAxisObject(actChartObj,axisType,index||0).ticks),isHierarchialLevelType=null!=scaleObj.discreteWidth;null==axisgroup&&"ticklabel"==labelType&&(ticks=null==axisComp.tickValues()?scaleObj.ticks?scaleObj.ticks.apply(scaleObj,[10]):scaleObj.domain():axisComp.tickValues(),axisgroup=wrap.selectAll(".tick").data(ticks,scaleObj).selectAll("text.ticklabel"));if("ticklabel"==labelType&&axisComp&&!isHierarchialLevelType&&(tickObj.isHierarchy()||"between"==tickmarkdataOption)){dontUseMargin=!0,ticks=ticks||axisComp.tickValues(),distBwTicks=scale$1.getRangeBand(scaleObj,ticks,0);var minTick=ticks[0],maxTick=ticks[ticks.length-1];axisdata.reversed&&(minTick=ticks[ticks.length-1],maxTick=ticks[0]);var outerPadding=mathAbs(distBwTicks.outerPaddingInPixel),bandWidth=scaleObj.bandwidth?scaleObj.bandwidth()/2:0}var labelSize=getMaxTickSize(ticklabelOptions,chartarea),hasUserLabelSize=defined(ticklabelOptions.width)||defined(ticklabelOptions.maxWidth),maxTickSize_Vert=labelSize.vertical,maxTickSize_Hori=labelSize.horizontal,edge=function(chartObj){var edge={};dontUseMargin?"bottom"==orient||"top"==orient?(edge.left=scaleObj(minTick)-mathAbs(bandWidth-outerPadding),edge.right=scaleObj(maxTick)+(outerPadding+bandWidth)):"left"!=orient&&"right"!=orient||90!=rotation&&270!=rotation||(edge.top=scaleObj(maxTick)-outerPadding,edge.bottom=scaleObj(minTick)+outerPadding):(edge.top=edge.left=0,edge.right="bottom"==orient||"top"==orient?getPlotSize(chartObj,"width",plotarea):0,edge.bottom="bottom"==orient||"top"==orient?0:getPlotSize(chartObj,"height",plotarea));return edge}(actChartObj),margin=function(labelType,boundary,canvasBoundary,marginPercent){var margin={};dontUseMargin?(margin.left=margin.right=0,margin.top=margin.bottom=0):(margin.left="axislabel"==labelType?marginPercent*(canvasBoundary.width-(boundary.left+boundary.width)):marginPercent*boundary.left,margin.right=marginPercent*(canvasBoundary.width-(boundary.left+boundary.width)),margin.top=marginPercent*boundary.top,margin.bottom=marginPercent*boundary.bottom);return margin}(labelType,plotarea,canvasarea,.5);return chartObj.actChartObj||"axislabel"==labelType&&axisgroup.node()?doHandleOverflow(axisgroup.node()):doHandleOverflow;function doHandleOverflow(tickNode,index){if("none"!=overflow){var activeNode=tickNode,childNodes=[activeNode.childNodes[0]],tspan=d3_select(activeNode).selectAll("tspan").nodes();if(tspan&&tspan.length&&(tspan.sort(function(a,b){return b.textContent.length-a.textContent.length}),childNodes=tspan),childNodes){if(dontUseMargin){count=count||wrap.selectAll("text.ticklabel").nodes().length;var outerPadding=mathAbs(distBwTicks.outerPaddingInPixel);"bottom"==orient||"top"==orient?hasUserLabelSize?maxTickSize_Hori=labelSize.horizontal:90!=rotation&&270!=rotation&&(maxTickSize_Hori=0==index||index==count-1?2*outerPadding:2*mathAbs(distBwTicks.rangeBand)):"left"!=orient&&"right"!=orient||90!=rotation&&270!=rotation||(maxTickSize_Vert=0==index||index==count-1?2*outerPadding:2*mathAbs(distBwTicks.rangeBand))}for(var i=0;i<childNodes.length;i++){var trimmed,txtNode=tspan&&tspan.length?childNodes[i]:activeNode,initial_textContent=txtNode.textContent,clientRect="tspan"==txtNode.nodeName?getTspanBoundingClientRect:getDefaultBoundingClientRect,initial_textBound=textBounds=clientRect(txtNode),overflowLength=-1,max={width:maxTickSize_Hori,height:maxTickSize_Vert},minMargin=dontUseMargin?0:fSize;if(isHierarchialLevelType&&"ticklabel"==labelType&&!chartObj.actChartObj){var rb="left"==orient||"right"==orient?maxTickSize_Hori:Math.abs(scaleObj.discreteWidth(tickNode.__data__))||maxTickSize_Hori,maxWid=mathMin(maxTickSize_Hori,rb);return void naiveEllipsis(txtNode,txtNode,txtNode.textContent,maxWid,maxTickSize_Vert,textBounds,overflowPattern)}if("ticklabel"==labelType){if(maxTickSize_Hori<textBounds.width){overflowLength=(textBounds.width-maxTickSize_Hori)/textBounds.width;var croppedTextLength=mathCeil((1-overflowLength)*txtNode.textContent.length);txtNode.textContent=txtNode.textContent.substring(0,croppedTextLength-2)+overflowPattern,textBounds=clientRect(txtNode)}if(maxTickSize_Vert<textBounds.height){overflowLength=(textBounds.height-maxTickSize_Vert)/textBounds.height;croppedTextLength=mathCeil((1-overflowLength)*txtNode.textContent.length);txtNode.textContent=txtNode.textContent.substring(0,croppedTextLength-2)+overflowPattern,textBounds=clientRect(txtNode)}}var textBounds,axisGroupBounds=wrap.selectAll(".domain").node().getBoundingClientRect(),newTextBounds={left:textBounds.left-axisGroupBounds.left,right:textBounds.left+textBounds.width-axisGroupBounds.left,top:textBounds.top-axisGroupBounds.top,bottom:textBounds.top+textBounds.height-axisGroupBounds.top,width:textBounds.width,height:textBounds.height};if("left"!=orient&&"right"!=orient||0==rotation||180==rotation||360==rotation?"bottom"!=orient&&"top"!=orient||90==rotation||270==rotation||(newTextBounds.left+mathMax(minMargin,margin.left)<edge.left||newTextBounds.right-mathMax(minMargin,margin.right)>edge.right)&&(trimmed=!0,trimText(txtNode,txtNode.textContent,newTextBounds,edge,orient,overflowPattern,margin,max,txtNode)):(newTextBounds.top+mathMax(minMargin,margin.top)<edge.top||newTextBounds.bottom-mathMax(minMargin,margin.bottom)>edge.bottom)&&(trimmed=!0,trimText(txtNode,txtNode.textContent,newTextBounds,edge,orient,overflowPattern,margin,max,txtNode)),"ticklabel"==labelType&&!trimmed)(textBounds=clientRect(txtNode)).width==initial_textBound.width&&textBounds.height==initial_textBound.height||naiveEllipsis(txtNode,activeNode,initial_textContent,max.width,max.height,textBounds,overflowPattern);txtNode.textContent==overflowPattern&&(txtNode.textContent=chartObj.actChartObj?".":"")}}}}}canvas_patterns.canvasPatternFill=function(prop,clr,returnURL){var image,context;return context=document.createElement("canvas").getContext("2d"),image=prop.ele?function(properties,color){var pattern=effects.get(effects.svg_patterns,"svgPatternFill",properties,{returnSVGimage:!0,base64:!0});fillSVGimageInCanvas(pattern.url,pattern)}(prop):function(properties,color){var canvas,patternID="zp"+generateIdByPropValue(properties,"canvasFill");if($ZC[patternID])canvas=$ZC[patternID];else{var patternCanvas=document.createElement("canvas"),bgClr_base=properties.bgClr||properties.bgClr_base,stroke_base=properties.stroke||properties.stroke_base,regExp=/\{\{([a-z]+)\}\}/,symbolTypes=properties.type.split(","),noOfSymbols=symbolTypes.length,size=properties.size.split(","),strokeWidth=properties.strokeWidth.split(","),fillColor=bgClr_base.split(","),stroke=stroke_base.split(","),fillOpacity=(properties.fillOpacity||"").split(","),translate=((properties.strokeOpacity||"").split(","),properties.translate?properties.translate.split(","):null);size=properties.width?getPatternSize(properties,size):size,patternCanvas.width=size[0],patternCanvas.height=size[0];for(var patternCanvas_context=patternCanvas.getContext("2d"),j=0;j<noOfSymbols;j++){var stroke_cur=isNull(stroke[j]||stroke[0])?properties.stroke_base:"static"==(stroke[j]||stroke[0])?properties.customStaticClr:stroke[j]||stroke[0],fill_cur=isNull(fillColor[j]||fillColor[0])?properties.bgClr_base:"static"==(fillColor[j]||fillColor[0])?properties.customStaticClr:fillColor[j]||fillColor[0],trans_cur=(size[j]||size[0])/2;if(stroke_cur=regExp.test(stroke_cur)?getColorCopy(properties.stroke_base,1,stroke_cur.replace(regExp,"$1"),d3_hsl):stroke_cur,fill_cur=regExp.test(fill_cur)?getColorCopy(properties.bgClr_base,1,fill_cur.replace(regExp,"$1"),d3_hsl):fill_cur,translate){var subTranslate=translate[j]||translate[0];trans_cur+=parseFloat(subTranslate)}if(patternCanvas_context.save(),patternCanvas_context.translate(trans_cur,trans_cur),patternCanvas_context.beginPath(),patternCanvas_context.lineWidth=strokeWidth[j]||strokeWidth[0],patternCanvas_context.fillStyle=rgba_canvas(fill_cur,fillOpacity[j]||fillOpacity[0]),patternCanvas_context.strokeStyle=stroke_cur,"circle"===symbolTypes[j])patternCanvas_context.arc(0,0,size[j]/2,0,2*mathPI,!1);else{var patternPath=getSVGsymbol(symbolTypes[j])(size[j]||size[0]);canvasUtils.drawPath(patternCanvas_context,patternPath)}patternCanvas_context.fill(),patternCanvas_context.stroke(),patternCanvas_context.closePath(),patternCanvas_context.restore()}canvas=$ZC[patternID]=patternCanvas}return canvas}(prop),context.createPattern(image,"repeat")},canvas_patterns.imageFill=function(options,callback){fillSVGimageInCanvas(options.name,options,callback)},effects.canvas_patterns=canvas_patterns;var rendererBoundUtils={};function getValignforBarLabels(chartObj,seriesIndex,labelType){if(chartObj.dataObject.noofBarEnabledSeries){var isStackedLabels=labelType===STACKLABELS_LABELTYPE,options=getMergedDatalabelOptions(chartObj.systemConf.chart.plot.plotoptions[chartObj.chartTypes[seriesIndex].name],isStackedLabels?NULL:chartObj.seriesdata[seriesIndex].plotoptions,chartObj,seriesIndex);isStackedLabels&&(options=options.stackLabels);var dataObj=chartObj.dataObject,axisrotated=dataObj.getAxisRotated(),stacked=dataObj.isstacked(),labelPos=options.labelPos||TOP_ALIGN,textDirection=options.textDirection;return(isStackedLabels?isStacklabelEnabled(options,chartObj):isDatalabelEnabled(options,chartObj))?(textDirection=!textDirection||stacked&&!isStackedLabels?axisrotated?VERTICAL_ALIGN:HORIZONTAL_ALIGN:textDirection,labelType===DATALABELS_LABELTYPE&&labelPos===FIXEDTOP_ALIGN&&(stacked||axisrotated&&textDirection!==VERTICAL_ALIGN||!axisrotated&&textDirection===VERTICAL_ALIGN)&&(labelPos=TOP_ALIGN),labelPos):void 0}}function getTickRotateInfo(orient,rotation,ticklabels,axisObj,tickmarkSize,tickPadding,tickObj){var rotateInfo={},w="left"===orient||"right"===orient?"width":"height",isInline=(tickPadding=null==tickPadding?axisObj.tickPadding():tickPadding,tickObj&&tickObj.isInline),isInwardPlot=tickObj&&tickObj.inlineToPlot,tickSpacing=isInline&&!isInwardPlot?tickObj.longTickSize[w]:Math.max(tickmarkSize,0)+tickPadding,k="top"===orient||"left"===orient?-1:1,l=isInwardPlot?-k:k,changeDY=isInline&&tickObj.showGrid;switch(orient){case"top":rotateInfo.rotate=[rotation,0,l*tickSpacing],rotation>=0&&rotation<45||rotation>315&&rotation<=360?(rotateInfo.dy=isInline?"0.71em":"0em",rotateInfo.dy1="-1em"):rotation>=45&&rotation<=90||rotation>=90&&rotation<=135||rotation>=225&&rotation<=315?rotateInfo.dy="0.35em":rotation>135&&rotation<225&&(rotateInfo.dy="0.71em"),rotateInfo.textAnchor="0"==rotation||180==pInt(rotation)||360==pInt(rotation)?"middle":pInt(rotation)<180?"end":"start";break;case"bottom":rotateInfo.rotate=[rotation,0,l*tickSpacing],rotation>=0&&rotation<45||rotation>315&&rotation<=360?(rotateInfo.dy=isInline?"0em":"0.71em",rotateInfo.dy1="1.71em"):rotation>=45&&rotation<=90||rotation>=90&&rotation<=135||rotation>=225&&rotation<=315?rotateInfo.dy="0.35em":rotation>135&&rotation<225&&(rotateInfo.dy="0em");var textAnchor="0"==rotation||180==pInt(rotation)||360==pInt(rotation)?"middle":pInt(rotation)<180?"start":"end";rotateInfo.textAnchor=isInline?"start"==textAnchor?"end":"end"==textAnchor?"start":textAnchor:textAnchor;break;case"left":rotateInfo.rotate=[rotation,l*tickSpacing,0],rotation>=0&&rotation<45?rotateInfo.dy=changeDY?"-0.35em":"0.35em":rotation>=45&&rotation<=90||rotation>=90&&rotation<=135?rotateInfo.dy="0.71em":(rotation>135&&rotation<225||rotation>=225&&rotation<=315||rotation>315&&rotation<=360)&&(rotateInfo.dy=isInline?"1em":"0em");textAnchor="90"==rotation||270==pInt(rotation)?"middle":rotation>90&&rotation<270?"start":"end";rotateInfo.textAnchor=isInline?"start"==textAnchor?"end":"end"==textAnchor?"start":textAnchor:textAnchor;break;case"right":rotateInfo.rotate=[rotation,l*tickSpacing,0],rotation>=0&&rotation<45||rotation>135&&rotation<225?rotateInfo.dy=changeDY?"-0.35em":"0.35em":rotation>=225&&rotation<=315||rotation>315&&rotation<=360?rotateInfo.dy="0.71em":(rotation>=90&&rotation<=135||rotation>=45&&rotation<=90)&&(rotateInfo.dy="0em"),rotateInfo.textAnchor=isInline?"end":"90"==rotation||270==pInt(rotation)?"middle":rotation>90&&rotation<270?"end":"start"}return rotateInfo}function formatTickWrapByMode(tick,mode,maxWidth,maxHeight,fontHeight){return null==tick?tick:"wrapOnSpace"==mode?tick.split(" "):"wrapAll"==mode?function(text,maxWidth,maxHeight,fontHeight){var word,words=text.split(/\s+/).reverse(),testLines=[],wrappedLines=[],totalHeight=fontHeight;for(maxWidth=maxWidth;word=words.pop();)if(testLines.push(word),utils.fontUtils.getTextWidth(testLines.join(" "))>maxWidth){if(testLines.length>1&&(testLines.pop(),wrappedLines.pop(),wrappedLines.push(testLines.join(" "))),totalHeight>maxHeight)return wrappedLines;totalHeight+=fontHeight,testLines=[word],wrappedLines.push(word)}else wrappedLines.pop(),wrappedLines.push(testLines.join(" "));return wrappedLines}(tick,maxWidth,maxHeight,fontHeight):tick}rendererBoundUtils.getAvailableBound=function(chartObj,commonPlotOptions){var plotarea=chartObj.plotarea,chartWidth=plotarea.width,chartHeight=plotarea.height,outerPaddingX=mathMin(chartWidth/2,perToPx(commonPlotOptions.outerPadding,chartWidth/2,0)),outerPaddingY=mathMin(chartHeight/2,perToPx(commonPlotOptions.outerPadding,chartHeight/2,0));return{x:outerPaddingX,y:outerPaddingY,width:chartWidth-2*outerPaddingX,height:chartHeight-2*outerPaddingY}},rendererBoundUtils.updatePlotareaByBandWidth=function(chartObj,plotarea_approx){var commonPlotOptions,dataObject=chartObj.dataObject;if((dataObject.noofBarEnabledSeries||dataObject.isCombinationalChart)&&dataObject.allChartTypes.some(function(chartType){var chartNmae=DataProcessor.helpers.getChartType(chartType,"string");if(isBarChartType(chartType))return commonPlotOptions=chartObj.systemConf.chart.plot.plotoptions[chartNmae],!0}),commonPlotOptions&&commonPlotOptions.strictBandWidth){var len=dataObject.getCategories("x").length,padding=pick(commonPlotOptions.padding,.2),outerPadding=commonPlotOptions.outerPadding;outerPadding=defined(outerPadding)?outerPadding:.2,outerPadding=scale$1.getOuterPadding(rotated?[0,plotarea_approx.width]:[plotarea_approx.height,0],len,padding,outerPadding);var levelMarkerOptions=commonPlotOptions.levelMarker,targetMarkerOptions=commonPlotOptions.targetMarker||{},plotarea=chartObj.plotarea,rotated=chartObj.axes.rotated,defaultBandWidth=(rotated?plotarea_approx.height:plotarea_approx.width)/(len-padding+2*outerPadding)*(1-padding),arr=[],levelMarkerBandWidth=validateNullVal(levelMarkerOptions.bandWidth,defaultBandWidth),levelMarkerMaxBandWidth=validateNullVal(levelMarkerOptions.maxBandWidth,defaultBandWidth),levelMarkerBand=mathMin(levelMarkerBandWidth,levelMarkerMaxBandWidth,defaultBandWidth);levelMarkerOptions.enabled&&arr.push(levelMarkerBand),targetMarkerOptions.enabled&&arr.push(defined(targetMarkerOptions.size)?mathMin(10*targetMarkerOptions.size,defaultBandWidth):0);var barBandWidth=validateNullVal(commonPlotOptions.bandWidth,levelMarkerBand),barMaxBandWidth=validateNullVal(commonPlotOptions.maxBandWidth,barBandWidth);arr.push(mathMin(barBandWidth,barMaxBandWidth,defaultBandWidth));var bandWidth=mathMax.apply(null,arr);bandWidth=bandWidth/(1-padding)*(len-padding+2*outerPadding),rotated?(plotarea.height=bandWidth+(plotarea.height-plotarea_approx.height),plotarea.top+=plotarea.adjust=(plotarea_approx.height-bandWidth)/2):(plotarea.width=bandWidth+(plotarea.width-plotarea_approx.width),plotarea.left+=plotarea.adjust=(plotarea_approx.width-bandWidth)/2)}},axis.ticks=function(chartObj,axisdata,type,axisorder,orient,plotarea){var ticks={};axis.ticks.maxTickSizeRatio_Vert="50%",axis.ticks.maxTickSizeRatio_Hori="50%";var tickvalues,dataObject=chartObj.dataObject,systemConf=chartObj.systemConf,container=chartObj.svg,intelligenceDim=chartObj.canvasarea["bottom"==orient||"top"==orient?"height":"width"];ticks.isHierarchy=isHierarchy,ticks.isHierarchialLevelType=isHierarchialLevelType;var datatype=chartObj.dataset.getDataType(type,axisorder),axisrotated=dataObject.getAxisRotated(),axislabeldata=axisdata.label||{},axisticklabeldata=axisdata.ticklabel||{},axistickmarkdata=axisdata.tickmark,ticklabelFontSize=parseFloat(utils.getVal(getValByPriority([axisticklabeldata,systemConf.chart,systemConf.canvas,$ZCG],"fontSize"))),ticklabelFontFamily=utils.getVal(getValByPriority([axisticklabeldata,systemConf.chart,systemConf.canvas,$ZCG],"fontFamily")),rotation=null!=axisticklabeldata&&null!=axisticklabeldata.rotation&&"auto"!=axisticklabeldata.rotation?axisticklabeldata.rotation:0;isHierarchy()&&(rotation=0),rotation=(rotation=(rotation=null==rotation||""==rotation?0:parseFloat(rotation))<0?360-mathAbs(rotation):rotation)>360?mathAbs(rotation)%360:rotation;var marginAxisLabel_right,marginAxisLabel_left,marginAxisLabel_bottom,marginAxisLabel_top,hideAxisLabel=!1===axislabeldata.show||!defined(axislabeldata.text)||""===axislabeldata.text||!dimension_based_intelligence(chartObj,type+"axislabel",intelligenceDim)||isHierarchy()&&axisorder<chartObj.axes.x.count-1;hideAxisLabel?marginAxisLabel_right=marginAxisLabel_left=marginAxisLabel_bottom=marginAxisLabel_top=0:(marginAxisLabel_top=pick(axislabeldata.marginTop,5),marginAxisLabel_bottom=pick(axislabeldata.marginBottom,5),marginAxisLabel_left=pick(axislabeldata.marginLeft,5),marginAxisLabel_right=pick(axislabeldata.marginRight,5));var marginTickLabel=getMargin(axisticklabeldata),metaData=chartObj.systemConf.metadata,columnidx=chartObj.dataset.getColumnIdx(type,axisorder),dt=metaData.columns[columnidx].datatype,metaConf=metaData.columns[columnidx][dt],isMergedAxis="y"==type&&metaData.axes.y[axisorder].length>1,formatConf=metaConf;formatConf=isMergedAxis&&"y"==type?merged_axis_column_intersect(axisorder,chartObj):metaConf,this.preCalcAxisLen=0;var tickmarkSize=pick(axistickmarkdata.size,6);function isHierarchialLevelType(){return isHierarchy()&&axisorder>0}function isHierarchy(){return"x"==type&&chartObj.axes.x.count>1}function getCurrentCustomTick(longTick,index,tickInfo){return tickInfo.customTickInfo.userRawTicks[defined(index)?index:longTick.index]}return ticks.preCalcApproxAxisLength=function(plotarea){var extent="x"==type&&0==axisorder&&chartObj.brush?chartObj.brush.extent:null,axes=getAxisObject(chartObj,type,axisorder),tickHelper={axisRotated:axisrotated,axisOrder:axisorder,chart:chartObj,orient:orient};axes.Ticks||(axes.Ticks=new axis.Ticks(type,axisdata,plotarea,tickHelper)),this.tickValueObj=ticks.getTickValues(plotarea.width,plotarea.height,extent,!0,null,axes.Ticks,plotarea);var selector=type+"-axis-"+axisorder,axisWrap=appendEle(chartObj.svg.selectAll("g."+type+"-axis"),"g",[axisdata],".","class",selector);appendEle(axisWrap,"g",[axisdata],".","class","axisgroup").selectAll("line.majorTicks").style("display","");var axisarea=this.tickValueObj.axisgroup,width=axisarea.width,height=axisarea.height,maxWidth=axisticklabeldata.maxWidth,maxHeight=axisticklabeldata.maxHeight;"left"!==orient&&"right"!==orient||!defined(axisticklabeldata.width)?defined(axisticklabeldata.height)&&(height=perToPx(getPriorityValue(axisticklabeldata.height,maxHeight)||axis.ticks.maxTickSizeRatio_Vert,plotarea.height)):width=perToPx(getPriorityValue(axisticklabeldata.width,maxWidth)||axis.ticks.maxTickSizeRatio_Hori,plotarea.width),axisarea=this.preCalcTickLen={x:axisarea.left,y:axisarea.top,width:width,height:height};var isHorizontal="x"===type&&!axisrotated,axisLabelProperties={systemConf:systemConf,bound:axisarea,horizontal:isHorizontal,vertical:!isHorizontal,axisOrder:axisorder,plotRect:plotarea,hide:hideAxisLabel,tickObj:this.tickValueObj},axisSize=0;if(axes.axisLabel?(axes.axisLabel.show=!hideAxisLabel,axes.axisLabel.transformLabel(axisarea,plotarea,orient)):axes.axisLabel=new axis.AxisLabel(axisdata,axisLabelProperties,orient,axisWrap),hideAxisLabel)this.preCalcAxisLen="bottom"===orient||"top"==orient?axisarea.height+marginTickLabel.bottom:axisarea.width+marginTickLabel.left;else switch(axisSize=axes.axisLabel.getBBox().height,orient){case"left":var width_new=this.tickValueObj.inlineToPlot?0:this.tickValueObj.isInline?axisarea.width:axisarea.width+marginTickLabel.left;this.preCalcAxisLen=width_new+marginAxisLabel_right+axisSize+marginAxisLabel_left;break;case"right":width_new=this.tickValueObj.inlineToPlot?0:this.tickValueObj.isInline?axisarea.width:axisarea.width+marginTickLabel.right;this.preCalcAxisLen=width_new+marginAxisLabel_left+axisSize+marginAxisLabel_right;break;case"bottom":var height_new=this.tickValueObj.inlineToPlot?0:this.tickValueObj.isInline?axisarea.height:axisarea.height+marginTickLabel.bottom;this.preCalcAxisLen=height_new+marginAxisLabel_bottom+axisSize+marginAxisLabel_top;break;case"top":height_new=this.tickValueObj.inlineToPlot?0:this.tickValueObj.isInline?axisarea.height:axisarea.height+marginTickLabel.top;this.preCalcAxisLen=height_new+marginAxisLabel_top+axisSize+marginAxisLabel_bottom}return this.preCalcAxisLen},ticks.getTickValues=function(width,height,zmInterval,isPreCalc,tickcount,Ticks,newPlotArea){var tickValueObj={},tickHelper={axisRotated:axisrotated,axisOrder:axisorder,chart:chartObj,orient:orient,extent:zmInterval,maxTickSize:this.tickValueObj?this.tickValueObj.maxTickSize:null},tickValuesInfo=Ticks.getTicks(plotarea,tickcount,tickHelper),useHTML=defined(axisticklabeldata.showAs);rotation=isNaN(tickValuesInfo.rotation)?rotation:tickValuesInfo.rotation;var prop=tickValuesInfo.tickMargin,marginInfo=getTickPadding(orient,marginTickLabel,isTickInnerOrient(axisdata,type,chartObj)),rotationInfo=getTickRotateInfo(orient,rotation,0,null,tickmarkSize,marginInfo,this.tickValueObj),x="left"===orient||"right"===orient?"x":"y",rotateIndex="left"===orient||"right"===orient?1:2;prop[x]+=this.tickValueObj&&this.tickValueObj.isInline&&!this.tickValueObj.inlineToPlot?rotationInfo.rotate[rotateIndex]:0,prop.dy=rotationInfo.dy,rotationInfo.rotate[rotateIndex]=prop[x],datatype=chartObj.dataset.getDataType(type,axisorder);var plotArea=pick(newPlotArea,plotarea),dummygroup=container.append("g").attr("class","dummy"),left="right"==orient?plotArea.left+plotArea.width:plotArea.left,top="bottom"==orient?plotArea.top+plotArea.height:plotArea.top;dummygroup.attr("transform","translate("+left+","+top+")");var tickgroup=dummygroup.append("g").attr("class","tick");return function(g,text,prop,rotation,useHTML,tickValueInfo){var dummyText=appendEle(g,"text",[1],".","class","dummyText");dummyText.attrs({x:prop.x||0,y:prop.y||0,dy:prop.dy||0}).attr("transform","rotate("+rotation+" "+prop.x+" "+prop.y+")"),useHTML?text=getCurrentCustomTick(tickValueInfo.longestTickValue,null,tickValueInfo):dummyText.text(text);return wrapTextContent(dummyText,text,null,useHTML),applyFont(dummyText,[axisticklabeldata,systemConf.chart,systemConf.canvas,$ZCG]),dummyText}(tickgroup,tickValuesInfo.longestTickValue.formattedVal,prop,rotation,useHTML,tickValuesInfo).call(function(selection){tickValueObj=function(plotarea,dummyText,dummygroup,tickgroup,tickValuesInfo,iswebChart,useHTML,rotationInfo){var tickValueObj,refContainer=dummyText,hasTimeAutoFormat=datatype===TIME_DATATYPE&&hasAutoFormat(formatConf),tickvalues_formatted=tickValuesInfo.formatterTickValues;tickvalues=tickValuesInfo.rawTickValues;var customTickStyles,customTickValues,longtick=tickValuesInfo.longestTickValue,maxTickSize=tickValuesInfo.maxTickSize,tickValueIndices=tickValuesInfo.tickValueIndices,scaleObj=tickValuesInfo.scale;defined(tickValuesInfo.customTickInfo)&&tickValuesInfo.customTickInfo.length&&(customTickStyles=tickValuesInfo.customTickInfo.styles,customTickValues=tickValuesInfo.customTickInfo.userRawTicks);var tickvalues_formatted_copy=(array=tickvalues_formatted,array.slice(0).sort(function(a,b){return defined(a)||(a=""),defined(b)||(b=""),b.length-a.length})),textWidth=function(text,index){var style,dimension;return defined(customTickStyles)&&(style=customTickStyles[index]),dimension=getTextBound(text,ticklabelFontSize,ticklabelFontFamily,style),useHTML?dimension.width*dimension.height:"left"==orient||"right"==orient?dimension.width:dimension.width*dimension.height};var array;if(!iswebChart){dummygroup.append("line").attr("class","domain").attrs({x1:0,y1:0,x2:"bottom"==orient||"top"==orient?plotarea.width:1e-4,y2:"bottom"==orient||"top"==orient?1e-4:plotarea.height}).style("stroke","black");var overflow=axisticklabeldata.textOverflow==NONE?"":axisticklabeldata.textOverflow,isFinalLongtick=!1,co=-1,tempLongtick=longtick.actualVal,tempFormattedLongTick=longtick.formattedVal;useHTML&&(tempFormattedLongTick=getCurrentCustomTick(tickValuesInfo.longestTickValue,null,tickValuesInfo)),wrapTextContent(dummyText,tempFormattedLongTick,null,useHTML),function(ticklabels,rotationInfo,tickValuesInfo){ticklabels.attrs({dy:"zigzag"==tickValuesInfo.mode&&rotationInfo.dy1||rotationInfo.dy,transform:"rotate("+rotationInfo.rotate[0]+" "+rotationInfo.rotate[1]+" "+rotationInfo.rotate[2]+")"}).styles({"text-anchor":rotationInfo.textAnchor})}(dummyText,rotationInfo,tickValuesInfo);var curTick,maxTick,nextTick,pos=(scaleObj(tempLongtick)||0)+(null==scaleObj.bandwidth?0:scaleObj.bandwidth()/2);for(pos="bottom"==orient||"top"==orient?pos+",0":"0,"+pos,tickgroup.attr("transform","translate("+pos+")"),handleOverflowTicks(dummyText,orient,{svg:chartObj.svg,canvasarea:chartObj.canvasarea,plotarea:plotarea,chartarea:chartObj.chartarea,legendarea:chartObj.legendarea,actChartObj:chartObj},rotation,overflow,scaleObj,dummygroup,null,"ticklabel",axisticklabeldata,axisorder),maxTick=curTick=useHTML?tempFormattedLongTick:getTextContent(dummyText);"ordinalNonLinear"!=datatype&&!isFinalLongtick&&co<tickvalues.length;){co+=1;var pos=(scaleObj(tempLongtick)||0)+(null==scaleObj.bandwidth?0:scaleObj.bandwidth()/2);pos="bottom"==orient||"top"==orient?pos+",0":"0,"+pos,tickgroup.attr("transform","translate("+pos+")"),handleOverflowTicks(dummyText,orient,{svg:chartObj.svg,canvasarea:chartObj.canvasarea,plotarea:plotarea,chartarea:chartObj.chartarea,legendarea:chartObj.legendarea,actChartObj:chartObj},rotation,overflow,scaleObj,dummygroup,null,"ticklabel",axisticklabeldata,axisorder),curTick=getTextContent(dummyText),textWidth(curTick,co)>textWidth(maxTick,co)&&(tempFormattedLongTick=curTick,useHTML&&(tempFormattedLongTick=getCurrentCustomTick(null,co,tickValuesInfo)),maxTick=tempFormattedLongTick),wrapTextContent(dummyText,maxTick,null,useHTML);var isLastTick=!tickvalues.length||co===tickvalues.length-1||1===tickvalues.length;nextTick=isLastTick?null:hasTimeAutoFormat?tickvalues_formatted_copy[co]:tickvalues_formatted_copy[co]||"";var isoverflow=!isLastTick&&textWidth(curTick,co)<textWidth(nextTick,co);isoverflow?(tempLongtick=tickvalues_formatted_copy[co],curTick=nextTick,tempFormattedLongTick=nextTick,useHTML&&(tempFormattedLongTick=getCurrentCustomTick(null,co,tickValuesInfo)),wrapTextContent(dummyText,tempFormattedLongTick,null,useHTML)):isFinalLongtick=!0}}var referenceLongTickSize=refContainer.node().getBoundingClientRect(),refAxisgroupSize=dummygroup.node().getBoundingClientRect();tickValueObj={ticks:tickvalues,rotation:rotation,longTickSize:referenceLongTickSize,longtick:longtick,axisgroup:refAxisgroupSize,customTicks:customTickValues,mode:tickValuesInfo.mode,isInline:tickValuesInfo.isInline,inlineToPlot:tickValuesInfo.inlineToPlot,maxTickSize:maxTickSize,showGrid:axisdata.grid.show&&axisdata.grid.color!=TRANSPARENT},tickValueIndices&&(tickValueObj.tickValueIndices=tickValueIndices);return tickValueObj}(plotArea,selection,dummygroup,tickgroup,tickValuesInfo,defined(tickcount),useHTML,rotationInfo)}),dummygroup.remove(),tickValueObj},ticks.getActualTicklabel=function(){var a=this.tickValueObj,b=a.ticks;return this.isHierarchy()&&!this.isHierarchialLevelType()&&a.tickValueIndices?function(i){var includes=a.tickValueIndices.indexOf(i);return-1!=includes?b[includes]:null}:(chartObj.dataObject.isWaterfallEnabled&&a.tickValueIndices,function(i){return b[i]})},ticks.getTicksforAxisComp=function(){var datatype=chartObj.dataset.getDataType(type,axisorder);return isHierarchy()&&chartObj.dataObject.hierarchical.categoryTree&&(datatype==ORDINAL_DATATYPE||"ordinalNonLinear"==datatype)||isHierarchialLevelType()&&chartObj.dataObject.hierarchical.groupByTime?null:chartObj.dataObject.isWaterfallEnabled&&"x"==type?this.tickValueObj.tickValueIndices||null:this.tickValueObj.ticks},ticks},axis.constructTickObj=function(chartObj,chartWidth,chartHeight,orient,plotarea_approx,update){var type,axisdata,systemconf=chartObj.systemConf;type="left"==orient&&chartObj.axes.rotated||"bottom"==orient&&!chartObj.axes.rotated?"x":"y";for(var axesCount=chartObj.axes[type].count,i=0;i<axesCount;i++){var yaxisData=systemconf.chart.axes.yaxis;if(i>0&&"y"==type){axisdata=update?yaxisData[i]:mergeJSON(yaxisData[i],yaxisData[0],!1);var dt=null!=yaxisData[i]&&""!==yaxisData[i]?yaxisData[i]:{};axisdata.interval=dt.interval,axisdata.tickCount=dt.tickCount,axisdata.minRange=dt.minRange,axisdata.maxRange=dt.maxRange,axisdata.categories=dt.categories,yaxisData[i]=axisdata}var dim="bottom"==(orient=(axisdata="x"==type?systemconf.chart.axes.xaxis:yaxisData[i]).orient||("x"==type?chartObj.axes.rotated?"left":"bottom":chartObj.axes.rotated?"bottom":0==i?"left":"right"))||"top"==orient?chartHeight:chartWidth;if(!0===axisdata.show&&dimension_based_intelligence(chartObj,type+"axis",dim)){var axisObj=getAxisObject(chartObj,type,i);"y"!=type||axisObj||(axisObj={}),"x"!=type||axisObj||(axisObj=i>0?{}:axisObj);var tickObj=axis.ticks(chartObj,axisdata,type,i,orient,plotarea_approx);axisObj.ticks=tickObj;var axisarea=tickObj.preCalcApproxAxisLength(plotarea_approx);if("y"!==type||!chartObj.axes.y.groups[i].disabled){var plotarea=chartObj.plotarea;"left"==orient?(plotarea_approx.left+=axisarea,plotarea_approx.width=plotarea_approx.width-axisarea,plotarea.left=plotarea_approx.left,plotarea.width=plotarea_approx.width):"right"==orient?(plotarea_approx.width=plotarea_approx.width-axisarea,plotarea.width=plotarea_approx.width):"bottom"==orient?(plotarea.height=plotarea.height-axisarea,plotarea.bottom+=axisarea,plotarea_approx.height=plotarea.height,plotarea_approx.bottom+=plotarea.bottom):"top"==orient&&(plotarea.height=plotarea.height-axisarea,plotarea.top+=axisarea,plotarea_approx.height=plotarea.height,plotarea_approx.top+=plotarea.top)}}else{var axes="y"===type?chartObj.axes.y.groups[i]:chartObj.axes.x;axes.axisLabel=axes.Ticks=null}}"y"==type&&isObjectPropDefined(systemconf.chart,"scroll")&&systemconf.chart.scroll.enabled&&(chartObj.svg.call(chartObj.brush),chartObj.brush.initialize(plotarea_approx))};var getPriorityValue=function(constant,max){return defined(constant)&&defined(constant)?constant>max?max:constant:constant||max};function filterCategories(categories,expectedCount,interval,filterIndex){var actualCount=categories.length;expectedCount=mathRound(expectedCount),interval=interval||mathCeil(actualCount/mathAbs(expectedCount));for(var temp=0,tickvalues=[],tickvalueIndices=filterIndex?[]:null,tickvalueNodes=filterIndex?[]:null,isHierarchyData=!!filterIndex&&defined(categories[0].index);temp<actualCount;)filterIndex?isHierarchyData?(tickvalues.push(categories[temp].value),tickvalueIndices.push(categories[temp].index),tickvalueNodes.push(categories[temp])):(tickvalues.push(categories[temp]),tickvalueIndices.push(temp)):tickvalues.push(categories[temp]),temp+=interval;return filterIndex?{nodes:tickvalueNodes,ticks:tickvalues,indices:tickvalueIndices}:tickvalues}function getCustomTickValues(formattedTickValues,tickConfig,columnInfo,chart,columnIndex,levelIndex){var parentArray=[],parentStyles=[],userTickValues=[],userColumnInfo={data:[columnInfo]};return columnInfo.columnindex=pick(columnInfo.columnindex,columnIndex),formattedTickValues.forEach(function(d,i){var userInput=invokeFunction(tickConfig.showAs,d,tickConfig,userColumnInfo,chart,i,levelIndex),childArray=[],styles=[];if(isArray(userInput)?(parentArray.push(childArray),parentStyles.push(styles)):(childArray=parentArray,styles=parentStyles),userTickValues.push(userInput),defined(userInput)){var sandBox=document.createElement("div");sandBox.innerHTML=userInput;var tspan=toArray(sandBox.querySelectorAll("tspan")),images=sandBox.querySelectorAll("image,img");tspan.length?tspan.forEach(function(t){childArray.push(t.textContent.trim()),styles.push({fontSize:t.style.fontSize&&parseFloat(t.style.fontSize),fontFamily:t.style.fontFamily,fontStyle:t.style.fontStyle,fontWeight:t.style.fontWeight})}):childArray.push(sandBox.textContent),images.length&&toArray(sandBox.querySelectorAll("image,img")).forEach(function(t){childArray.push({width:+t.getAttribute("width"),height:+t.getAttribute("height")}),styles.push({})})}}),{tickValues:parentArray,styles:parentStyles,userRawTicks:userTickValues}}function getLongestTick(ticks,ticksOriginal,fontSize,fontFamily,styles,calculateAsArea,checkWhiteSpace){tempCanvasContext.save(),tempCanvasContext.font=fontSize+"px "+fontFamily;var style,hasWhiteSpace,index,temp=0,longest=null,original=null;styles=pick(styles,[]),defined(ticksOriginal)||(ticksOriginal=[]);return ticks.forEach(function(label,i){var bound=getTextBound(label,fontSize,fontFamily,styles[i]),width=bound.width;calculateAsArea&&(width=bound.width*bound.height),checkWhiteSpace&&!hasWhiteSpace&&(hasWhiteSpace=-1!=label.indexOf(" ")),width>temp&&(temp=width,longest=label,original=ticksOriginal[i],style=styles[i],index=i)}),tempCanvasContext.restore(),{actualVal:original,formattedVal:longest,style:style,index:index,hasWhiteSpace:hasWhiteSpace}}function getTickWidth(side,dimension,margin,rotation,tickFontSize,orient){return"height"===side?Math.abs(tickFontSize+margin.top+margin.bottom):rotation>0?distBetweenRotatedRect(rotation,dimension.width,tickFontSize,orient).tickSpacing+margin.left+margin.right:dimension.width+margin.left+margin.right}function distBetweenRotatedRect(rotation,width,height,orient){var ang1=rotation*(2*mathPI/360),ang2=2*mathPI/360*(90-rotation);return"bottom"===orient||"top"===orient?{tickSpacing:mathAbs(height/mathSin(ang1))+5,baseLen:0}:{tickSpacing:mathAbs(mathSin(ang2)*height)+mathAbs(mathCos(ang2)*height*mathTan(ang1))+5,baseLen:mathAbs(mathCos(ang2)*width)}}function addMinmaxToTickValues(tickvalues,axisticklabeldata,chartObj,type,axisorder,orient){var dataObject=chartObj.dataObject,minmaxlabelsdata=axisticklabeldata.minmaxlabels||{};if(!0===minmaxlabelsdata.show){var domain=scale$1.getScale(chartObj,dataObject,chartObj.plotarea,orient,axisorder,chartObj.dataset,type).domain();validateNullVal(minmaxlabelsdata.excludeIntervals,!0)?tickvalues=domain:(domain[0]!==tickvalues[0]&&tickvalues.splice(0,0,domain[0]),domain[1]!==tickvalues[tickvalues.length-1]&&tickvalues.push(domain[1]))}return tickvalues}function getLinearStep(domain,count){var m=defined(count)?count:10,span=domain[1]-domain[0],step=mathPow(10,mathFloor(mathLog(span/m)/mathLN10)),err=m/span*step;return err<=.15?step*=10:err<=.35?step*=5:err<=.75&&(step*=2),step}var AxisLabel=function(axisConfig,otherInfo,orient,parent){this.axis=axisConfig,this.config=axisConfig.label,this.axisRect=otherInfo.bound,this.parentNode=parent.isD3Selection?parent:d3_select(parent),this.orient=orient,this.systemConfig=otherInfo.systemConf,this.order=otherInfo.axisOrder,this.plotRect=otherInfo.plotRect,this.show=!otherInfo.hide,this.tickObj=otherInfo.tickObj,this.show?this.add():this.element=appendEle(this.parentNode,"text",[],".","class","axislabel")};AxisLabel.prototype={add:function(){this.element=appendEle(this.parentNode,"text",[1],".","class","axislabel"),this.text=this.config.text,this.element.text(this.text),this.rect=null,this.transformLabel()},remove:function(){this.rect=null,this.element=appendEle(this.parentNode,"text",[],".","class","axislabel")},setStyles:function(){var systemConfig=this.systemConfig;applyFont(this.element,[this.config,systemConfig.chart,systemConfig.canvas,$ZCG])},getBBox:function(){var t;if(!defined(this.rect)){if(!this.element.isD3Selection||this.element.empty())return(t={}).x=t.y=t.width=t.height=0,t;this.rect=this.element.node().getBBox()}return this.rect},transformLabel:function(axisBound,plotBound,side){var label=this;if(!0!==label.show)return label.remove();if(label.element.empty()&&!0===label.show||label.text!==label.config.text)return label.add();label.setStyles();var x,y,systemConfig=label.systemConfig,textAnchor="middle",orient=pick(side,label.orient),rotate={top:0,right:90,bottom:0,left:270}[orient],axisRect=pick(axisBound,this.axisRect),plotRect=pick(plotBound,this.plotRect),tickLabelConfig=label.axis.ticklabel,axisLabelConfig=label.config,tickMargin=getMargin(tickLabelConfig),labelMargin=getMargin(axisLabelConfig),fontSize=parseFloat(utils.getVal(getValByPriority([label.config,systemConfig.chart,systemConfig.canvas,$ZCG],"fontSize")));label.fontSize!==fontSize?label.rect=null:label.fontSize=fontSize,label.element.attr("dy","-0.25em");var isInline=this.tickObj.isInline,isInwardToPlot=this.tickObj.inlineToPlot,offset=isInline&&!isInwardToPlot?0:tickMargin[orient];switch(orient){case"top":var tickLength=isInwardToPlot?0:axisRect.height+offset;applyTransform(rotate,x=plotRect.width/2,-(y=tickLength+labelMargin.bottom));break;case"right":tickLength=isInwardToPlot?0:axisRect.width+offset;applyTransform(rotate,x=plotRect.height/2,-(y=tickLength+labelMargin.left));break;case"bottom":tickLength=isInwardToPlot?0:axisRect.height+offset;x=plotRect.width/2,y=tickLength+labelMargin.top,label.element.attr("dy","0.91em"),applyTransform(rotate,x,y);break;case"left":applyTransform(rotate,-(x=(tickLength=isInwardToPlot?0:axisRect.width+offset)+labelMargin.right),y=plotRect.height/2,-x,y)}function applyTransform(rotate,x,y,xTransform,yTransform){xTransform=pick(xTransform,0),yTransform=pick(yTransform,0),label.element.attrs({x:x,y:y,transform:function(rotate,x,y){return"rotate("+rotate+" "+(x||0)+" "+(y||0)+")"}(rotate,xTransform,yTransform),"text-anchor":textAnchor})}}};var Ticks=function(type,axisInfo,plotRect,helpers,tickCount){this.type=type,this.config=axisInfo.ticklabel,this.axis=axisInfo,this.plotRect=plotRect,this.helpers=helpers,this.tickCount=tickCount,this.maxSize=function(){return getMaxTickSize(this.config,this.plotRect)},this.cache={}};function formatArray(array,formatter,formatConf,chart,dataType,type,specifierIndex,tickAlignmentMode,maxSize,fontSize){var needTickConfigWrap="wrapOnSpace"==tickAlignmentMode||"wrapAll"==tickAlignmentMode;return array.map(function(value){var formattedValue;return formattedValue=formatter(formatConf,value,dataType,chart,type,null,null,specifierIndex),formattedValue=needTickConfigWrap?formatTickWrapByMode(formattedValue,tickAlignmentMode,maxSize.horizontal,maxSize.vertical,fontSize):formattedValue})}function centeringTicklabel(g,scaleObj,orient){g.nodes().forEach(function(tickG,i){var keyIndex="left"==orient||"right"==orient?1:0,old_transform=[0,0],rangeBand_nonLinear=scaleObj.discreteWidth(i)/2;old_transform[keyIndex]=old_transform[keyIndex]+rangeBand_nonLinear,tickG.setAttribute("transform","translate("+old_transform[0]+","+old_transform[1]+")")})}Ticks.prototype={getScale:function(){var chart=this.helpers.chart,helpers=this.helpers;return scale$1.getScale(chart,chart.dataObject,this.plotRect,helpers.orient,helpers.axisOrder,chart.dataset,this.type,this.extent)},getTicks:function(plotArea,needCount,helper){var range,domain,categoriesList,filterByIndex,tickValueIndices,dontFilter,axisSize,dimension,space,tick=this,helpers=pick(helper,tick.helpers),chart=helpers.chart,systemConf=chart.systemConf,dataObject=chart.dataObject,plotRect=tick.plotRect=pick(plotArea,tick.plotRect),axisObj=tick.axis,type=tick.type,userTickInterval=axisObj.interval,userTickCount=axisObj.tickCount,tickInterval=axisObj.interval,tickCount=pick(needCount,0),extent=helper.extent,tickValues=extent,axisOrder=helpers.axisOrder,axisRotated=helpers.axisRotated,dataType=chart.dataset.getDataType(type,axisOrder),metaData=chart.systemConf.metadata,columnIndex=chart.dataset.getColumnIdx(type,axisOrder),columnInfo=metaData.columns[columnIndex],originalDataType=metaData.columns[columnIndex].datatype,isMergedAxis="y"==type&&metaData.axes.y[axisOrder].length>1,currentMetaData=metaData.columns[columnIndex],formatConfig=pick(isMergedAxis&&"y"==type?merged_axis_column_intersect(axisOrder,chart):currentMetaData[originalDataType],{}),formattingSubFunction=formatConfig.subfunction,formattingFunction="y"===type&&(chart.dataObject.isStackedPercentChart||chart.dataObject.isPercentChart)?getFormattedValueByPercent:getFormattedValue,margin=getMargin(tick.config),isInline=isTickInnerOrient(tick.axis,type,chart),inlineToPlot=!!isInline&&function(type,orient){var yaxisReversed=systemConf.chart.axes.yaxis[0].reversed;if("x"==type&&("bottom"==orient&&!yaxisReversed||"left"==orient&&!yaxisReversed||"top"==orient&&yaxisReversed||"right"==orient&&yaxisReversed))return!0}(type,helpers.orient),tickMargin=function(orient,tickMargin,tickMarkConfig,tickLabelConfig,isInlineToPlot,isInline){var tickMarkSize=pick(tickMarkConfig.size,6),margin=getTickPadding(orient,tickMargin,isInline),x="left"===orient||"right"===orient?"x":"y",k="top"===orient||"left"===orient?-1:1,prop=(k=isInlineToPlot?-k:k,{});return prop["left"===orient||"right"===orient?"y":"x"]=0,prop[x]=k*(margin+tickMarkSize),prop}(helpers.orient,margin,tick.axis.tickmark,tick.axis.ticklabel,inlineToPlot,isInline),tickFontSize=parseFloat(utils.getVal(getValByPriority([tick.config,systemConf.chart,systemConf.canvas,$ZCG],"fontSize"))),tickFontFamily=utils.getVal(getValByPriority([tick.config,systemConf.chart,systemConf.canvas,$ZCG],"fontFamily")),rotationConfig=function(obj){var alignmentMode=obj.alignMode,isRotateMode=obj.alignMode&&-1!=obj.alignMode.indexOf("rotate"),isOldRotateMode=defined(obj.rotation),rotation=0;if(isRotateMode){var rotationExtract=/\(([^)]+)\)/.exec(alignmentMode);rotation=rotationExtract?parseInt(rotationExtract[1]):"auto"}else isOldRotateMode&&!defined(obj.alignMode)?(rotation="auto"==obj.rotation?obj.rotation:parseInt(obj.rotation),alignmentMode="rotate",isRotateMode=!0):defined(obj.alignMode)||(alignmentMode="rotate(0)",isRotateMode=!0);return{alignmentMode:alignmentMode,isRotateMode:isRotateMode,rotation:rotation}}(tick.config),tickAlignmentMode=rotationConfig.alignmentMode,tickRotateMode=rotationConfig.isRotateMode,tickRotation=rotationConfig.rotation,side=function(type,axisRotated){return"x"==type&&axisRotated||"y"==type&&!axisRotated}(type,axisRotated)?"height":"width",isAutoRotation=function(chartObj,type,order,rotationConfig){var isHierarchy=chartObj.axes.x.count>1&&"x"==type&&order>0;return"auto"==rotationConfig&&!isHierarchy}(chart,this.type,axisOrder,tickRotation),rotation=chart.axes.x.count>1&&"x"==type&&axisOrder>0?0:tickRotation,firstChartName=chart.chartTypes[0].name,outerPadding=chart.systemConf.chart.plot.plotoptions[firstChartName].outerPadding||0,pad=chart.systemConf.chart.plot.plotoptions[firstChartName].padding||.2,longestFormattedString=null,plotSize=getPlotSize(helpers.chart,side,plotRect),padding="x"===type?plotSize*outerPadding*2:0,customTickInfo={},maxTickSize=helper.maxTickSize||this.maxSize(),hasTimeGroupBy=isArray(formatConfig.groupby)&&formatConfig.groupby.length>0||"AUTO"===formatConfig.groupby&&"YEAR"!==formattingSubFunction,specifierIndex=hasTimeGroupBy?axisOrder:null;switch(hasTimeGroupBy&&"AUTO"===formatConfig.groupby&&(formatConfig.AUTO_GROUP_ORDER=DataProcessor.HierarchicalTimeDataAdapter.getAutoGroupOrder(formattingSubFunction).reverse()),isAutoRotation||(rotation<0?rotation=360-mathAbs(rotation):rotation>360&&(rotation=mathAbs(rotation)%360)),dataType){case"numeric":var correction4Datalabels,count,useTickInterVal;if(domain=defined(extent)?extent:"x"===type?dataObject.getMinMaxX():dataObject.getMinMaxY(helpers.axisOrder,UNDEFINED,chart.datalabels.hasFixedPosition),"y"===type&&chart.datalabels.hasFixedPosition){var rangeCorrections_datalabels=dataObject.rangeCorrections.datalabels,id=type+helpers.axisOrder;isUndefined(rangeCorrections_datalabels[id])&&(rangeCorrections_datalabels[id]=dataLabel_handler.DATALABELS_getPreCalculatedSize(type,dataObject.groupedDataBySplitAxes[helpers.axisOrder],chart)),correction4Datalabels=rangeCorrections_datalabels[id]}else correction4Datalabels=0;"height"===side?(axisSize=plotRect.height-correction4Datalabels,tickCount=tickCount||mathRound(axisSize/40),range=[axisSize,0]):(axisSize=plotRect.width-correction4Datalabels,tickCount=tickCount||mathRound(axisSize/100),range=[0,axisSize]),defined(userTickCount)&&(tickInterval=(domain[1]-domain[0])/userTickCount),useTickInterVal=defined(userTickInterval)&&(domain[1]-domain[0])/userTickInterval<axisSize;var scaleObj=d3_scaleLinear().domain(domain).range(range);if(useTickInterVal){if(count=mathFloor((domain[1]-domain[0])/tickInterval)){if(step=getLinearStep(domain,count),(min=mathCeil(domain[0]/step)*step)-domain[0]>tickInterval){var s=mathPow(10,mathFloor(mathLog(tickInterval)/mathLN10));min-=mathFloor((min-domain[0])/s)*s}}else{var span=domain[1]-domain[0];s=mathPow(10,mathFloor(mathLog(span)/mathLN10));min=domain[0]-domain[0]%s+s}tickValues=d3_range(min,domain[1],tickInterval)}else if(+userTickCount>0)if(1===userTickCount)step=getLinearStep(domain,1),min=Math.ceil(domain[0]/step)*step,tickValues=[min];else{var min,max,remaining,step,m=userTickCount-1,power=(span=domain[1]-domain[0],mathFloor(mathLog(step=span/m)/mathLN10)),magnitude=mathPow(10,power),nicedInterval=function(actualInterval,magnitude){for(var curDiff,curInterval,prevDiff=null,nearestInterval=magnitude,multiples=[1,1.2,1.5,1.75,2,2.2,2.5,3,3.5,4,4.5,5,6,7,8,9,10],i=0;i<multiples.length;i++)(curDiff=mathAbs(actualInterval-(curInterval=multiples[i]*magnitude)))<(prevDiff=null==prevDiff?curDiff:prevDiff)&&curInterval<=actualInterval&&(prevDiff=curDiff,nearestInterval=curInterval);return nearestInterval}(tickInterval,magnitude=+(magnitude*=Math.floor(step/magnitude)).toFixed(12));min=domain[0],max=domain[1],max=(max=+(max=(min=+(min=function(minDomain,remaining,magnitude,interval){var diff,nearestMin,arr=[1,2,5,10],len=arr.length,actualMin=minDomain+remaining/2;actualMin=+actualMin.toFixed(12);for(var j=0;j<len;j++){var curMin,a1=magnitude/arr[j],curDiff=mathAbs(actualMin-(curMin=minDomain%a1?minDomain-minDomain%a1+a1:minDomain));(curDiff<diff||null==diff)&&(diff=curDiff,nearestMin=curMin)}if(null==nearestMin||nearestMin<minDomain){var e=mathFloor(mathLog(interval)/mathLN10);e<0&&(nearestMin=+minDomain.toFixed(mathAbs(mathMin(0,e)))),nearestMin=minDomain}return nearestMin=nearestMin>minDomain?nearestMin:minDomain}(min,remaining=span-nicedInterval*m,mathPow(10,mathFloor(mathLog(remaining)/mathLN10)+1),nicedInterval)).toFixed(12))+nicedInterval*userTickCount).toFixed(12))>domain[1]?+domain[1]:max,tickValues=d3_range(min,max,nicedInterval)}else tickValues="integer"===formattingSubFunction?d3_range(function(domain,minStep){var step=getLinearStep(domain);return defined(minStep)&&(step=mathMax(minStep,step)),mathCeil(domain[0]/step)*step}(domain,1),domain[1],function(domain){return mathCeil(getLinearStep(domain))}(domain)):scaleObj.ticks(tickCount);tickValues=addMinmaxToTickValues(tickValues,tick.config,chart,type,helpers.axisOrder,helpers.orient),tickCount=tickValues.length;break;case"ordinalNonLinear":case"ordinal":var visibleTickCount,size=tickFontSize,hierarchical=dataObject.hierarchical;if(dontFilter=(filterByIndex=defined(hierarchical)&&hierarchical.categoryTree&&"x"==type&&0==axisOrder||dataObject.isWaterfallEnabled)&&("auto"==helpers.chart.systemConf.chart.width||"auto"==helpers.chart.systemConf.chart.height),defined(tickValues)||(tickValues=dataObject.getCategories(type,helpers.axisOrder).slice(0)),filterByIndex&&defined(hierarchical)&&(tickValues=dataObject.hierarchical.leafNodes),originalDataType===TIME_DATATYPE&&!defined(formattingSubFunction)){var info=getAutoTimeSubFunction(tickValues[tickValues.length-1]-tickValues[0]);formattingSubFunction=formatConfig.subfunction=info.subFunction}tickCount=tickValues.length,(dimension={}).width=dimension.height=tickFontSize,space=getTickWidth(side,dimension,margin,rotation,tickFontSize,helpers.orient),(visibleTickCount=mathRound((plotSize-padding)/space))<tickCount&&"width"===side&&(rotation||tick.config.rotation>0)&&(space=distBetweenRotatedRect(45,tickFontSize,size,helpers.orient).tickSpacing+margin.left+margin.right),"x"==type&&axisOrder>0||dontFilter||(userTickCount<tickCount?tickValues=filterCategories(tickValues,userTickCount,null,filterByIndex):defined(tickInterval)?tickValues=filterCategories(tickValues,tickCount,tickInterval,filterByIndex):visibleTickCount<tickCount&&(tickValues=filterCategories(tickValues,visibleTickCount,null,filterByIndex))),filterByIndex&&(categoriesList=tickValues.nodes||tickValues,tickValueIndices=tickValues.indices,tickValues=tickValues.ticks||dataObject.getCategories(type,helpers.axisOrder).slice(0)),tickCount=tickValues.length;break;case"time":var isAutoFormat=hasAutoFormat(formatConfig);if(!isAutoFormat){var start,end,dateInterval;if(domain=defined(extent)?extent:"x"===type?dataObject.getMinMaxX(0):dataObject.getMinMaxY(helpers.axisOrder,0),start=new Date(domain[0]),end=new Date(domain[1]),defined(currentMetaData[originalDataType])||(currentMetaData[originalDataType]=formatConfig),!defined(formattingSubFunction)||"AUTO"===formattingSubFunction){info=getAutoTimeSubFunction(end-start);formattingSubFunction=formatConfig.subfunction=info.subFunction}(dateInterval=new date_utils(formatConfig)).useUTC=!0===formatConfig.useUTC,dimension=getTextBound(longestFormattedString=formatTickWrapByMode(longestFormattedString=dateInterval.getMaxDate(formatConfig,specifierIndex),tickAlignmentMode,maxTickSize.horizontal,maxTickSize.vertical,tickFontSize),tickFontSize,tickFontFamily),space=getTickWidth(side,dimension,margin,rotation,tickFontSize,helpers.orient),tickCount=(plotSize-padding)/space;var dateRange=dateInterval.range(start,end,mathCeil(tickCount),formattingSubFunction,tickInterval,chart);tickValues=addMinmaxToTickValues(dateRange.TICKS,tick.config,chart,type,helpers.axisOrder,helpers.orient),tickCount=dateRange.TICKS.length;break}var timeScale=scale$1.getScale(chart,dataObject,plotRect,helpers.orient,helpers.axisOrder,chart.dataset,type,null);tickValues=timeScale.ticks(),formattedTickValues=tickValues.map(function(d){return timeScale.tickFormat()(d)}),tickCount=tickValues.length}if("ordinalNonLinear"===dataType){var formattedTickValues=isAutoFormat?formattedTickValues:formatArray(tickValues,formattingFunction,formatConfig,chart,originalDataType,"axis",specifierIndex,tickAlignmentMode,maxTickSize,tickFontSize);defined(tick.config.showAs)&&(customTickInfo=getCustomTickValues(tickValues,tick.config,columnInfo,chart,columnIndex,axisOrder),formattedTickValues=customTickInfo.tickValues,customTickInfo.length=formattedTickValues.length);var longestTick=getLongestTick(formattedTickValues,tickValues,tickFontSize,tickFontFamily,customTickInfo.styles);return{rawTickValues:tickValues,formatterTickValues:formattedTickValues,longestTickValue:longestTick,scale:tick.getScale(),longestTickDimension:getTextBound(longestTick.formattedVal,tickFontSize,tickFontFamily),margin:margin,tickMargin:tickMargin,rotation:rotation,customTickInfo:customTickInfo,mode:tickAlignmentMode,isInline:isInline,inlineToPlot:inlineToPlot,maxTickSize:maxTickSize}}var actualRange=(scaleObj=tick.getScale()).actualRange,isSingleTick=actualRange&&actualRange[0]===actualRange[1];isSingleTick&&(tickValues=[scaleObj.invert(actualRange[0])]),formattedTickValues=isAutoFormat?formattedTickValues:formatArray(tickValues,formattingFunction,formatConfig,chart,originalDataType,"axis",specifierIndex,tickAlignmentMode,maxTickSize,tickFontSize),defined(tick.config.showAs)&&(customTickInfo=getCustomTickValues(tickValues,tick.config,columnInfo,chart,columnIndex,axisOrder),formattedTickValues=customTickInfo.tickValues,customTickInfo.length=formattedTickValues.length),longestTick=getLongestTick(formattedTickValues,tickValues,tickFontSize,tickFontFamily,customTickInfo.styles),defined(longestFormattedString)||(longestFormattedString=longestTick.formattedVal);var tickBound=getTextBound(longestFormattedString,tickFontSize,tickFontFamily,longestTick.style,!0),labelSize=getMaxTickSize(tick.config,chart.chartarea);tickBound.width=mathMin(tickBound.width,labelSize.horizontal),tickBound.height=mathMin(tickBound.height,labelSize.vertical),dontFilter&&tick.recalculatePlotSize(helpers.chart,plotSize,tickBound,side,tickCount,margin,pad,outerPadding);var bestFitTickModel=function(tickCount){if("auto"==tickAlignmentMode){var maxCount_Rotate_0=getMaxTickCountByRotation(tickBound,0);if(maxCount_Rotate_0.maxTickCount<tickCount){var maxCount_zigzag=dataType==ORDINAL_DATATYPE?getMaxTickCountByZigzag(tickBound):getMaxTickCountByRotation(tickBound,45,!0);if(maxCount_zigzag.maxTickCount<tickCount){var maxCount_Rotate_45=getMaxTickCountByRotation(tickBound,45,!0);return maxCount_Rotate_45.maxTickCount<tickCount&&longestTick.hasWhiteSpace?getMaxTickCountByWrapOnSpace():maxCount_Rotate_45}return maxCount_zigzag}return maxCount_Rotate_0}if(tickRotateMode)return getMaxTickCountByRotation(tickBound);if("zigzag"==tickAlignmentMode)return getMaxTickCountByZigzag(tickBound);if("wrapOnSpace"==tickAlignmentMode)return getMaxTickCountByWrapOnSpace();if("wrapAll"==tickAlignmentMode)return{mode:"wrapAll",maxTickCount:getMaxTickCountByBounds(rotation,tickBound,type),rotation:rotation}}(tickCount),mode=bestFitTickModel.mode,maxTickCount=bestFitTickModel.maxTickCount;if(rotation=bestFitTickModel.rotation,!isSingleTick&&(tickCount>maxTickCount||bestFitTickModel.recalculate))if(dataType===TIME_DATATYPE)if(isAutoFormat){timeScale=scale$1.getScale(chart,dataObject,plotRect,helpers.orient,helpers.axisOrder,chart.dataset,type,null);tickValues=timeScale.ticks(maxTickCount),tickCount>maxTickCount&&(rotation=45),formattedTickValues=tickValues.map(function(d){return timeScale.tickFormat()(d)}),longestTick=getLongestTick(formattedTickValues,tickValues,tickFontSize,tickFontFamily,customTickInfo.styles)}else dateRange=dateInterval.range(start,end,maxTickCount,formattingSubFunction,tickInterval,chart),tickValues=addMinmaxToTickValues(dateRange.TICKS,tick.config,chart,type,helpers.axisOrder,helpers.orient),formattedTickValues=formatArray(tickValues,formattingFunction,formatConfig,chart,originalDataType,"axis",specifierIndex,tickAlignmentMode,maxTickSize,tickFontSize);else maxTickCount<tickCount&&(filterByIndex?(tickValueIndices=(tickValues=filterCategories(categoriesList||tickValues,maxTickCount,null,filterByIndex)).indices,tickValues=tickValues.ticks):(tickValues=filterCategories(tickValues,maxTickCount),tick.config.showAs&&(customTickInfo.styles=filterCategories(customTickInfo.styles,maxTickCount),customTickInfo.userRawTicks=filterCategories(customTickInfo.userRawTicks,maxTickCount))),formattedTickValues=filterCategories(formattedTickValues,maxTickCount),longestTick=getLongestTick(formattedTickValues,tickValues,tickFontSize,tickFontFamily,customTickInfo.styles));originalDataType===TIME_DATATYPE&&hasTimeGroupBy&&(hasTimeGroupBy&&!defined(dataObject.hierarchical)?dataObject.hierarchical=new DataProcessor.HierarchicalTimeDataAdapter(chart,tickValues,formatConfig.groupby,dataType!==TIME_DATATYPE,columnInfo):hasTimeGroupBy&&dataObject.hierarchical.update(tickValues)),(defined(customTickInfo.styles)||formatConfig&&formatConfig.format&&formatConfig.format.breakSpace)&&(longestTick=getLongestTick(formattedTickValues,tickValues,tickFontSize,tickFontFamily,customTickInfo.styles,!0));var textDimension=getTextBound(longestFormattedString,tickFontSize,tickFontFamily,longestTick.style);return{rawTickValues:tickValues,formatterTickValues:formattedTickValues,longestTickValue:longestTick,scale:scaleObj,longestTickDimension:textDimension,margin:margin,tickMargin:tickMargin,rotation:rotation,mode:mode,isInline:isInline,inlineToPlot:inlineToPlot,tickValueIndices:tickValueIndices,customTickInfo:customTickInfo,maxTickSize:maxTickSize};function getMaxTickCountByBounds(rotation,customBounds,customType){var tickArea,bounds,padding=0,length=getPlotSize(helpers.chart,side,tick.plotRect);if("x"===customType&&(padding=length*outerPadding*2),tickArea=length-padding,bounds=customBounds||tickBound,!!rotation){if("height"===side&&(90===rotation||270===rotation))return tickArea/(bounds.width+mathAbs(margin.top)+mathAbs(margin.bottom));var r=rotation%90;if("height"===side?r>0:r>0||90===rotation||270===rotation)return tickArea/(distBetweenRotatedRect(rotation,bounds.width,bounds.height,helpers.orient).tickSpacing+mathAbs(margin.left)+mathAbs(margin.right))}return tickArea/("height"===side?bounds.height+mathAbs(margin.top)+mathAbs(margin.bottom):bounds.width+mathAbs(margin.left)+mathAbs(margin.right))}function getMaxTickCountByRotation(tickBound,customRotation,recalculate){var count,rotation_new=defined(customRotation)?customRotation:rotation;return"auto"===rotation_new?(count=getMaxTickCountByBounds(rotation=0,tickBound,type),!isSingleTick&&count<tickCount?"width"===side?(count=getMaxTickCountByBounds(rotation=helpers.chart.axes.x.count>1&&"x"==type&&0==axisOrder?90:45,tickBound,null),recalculate=!0):recalculate=!0:recalculate=!1):(count=getMaxTickCountByBounds(rotation_new,tickBound,type),rotation=rotation_new),{mode:"rotate",rotation:rotation,maxTickCount:count,recalculate:recalculate}}function getMaxTickCountByZigzag(tickBound){return{mode:"zigzag",rotation:0,maxTickCount:2*getMaxTickCountByBounds(0,tickBound,type)}}function getMaxTickCountByWrapOnSpace(){if("auto"==tickAlignmentMode){var longestTick=getLongestTick(formattedTickValues=formattedTickValues.map(function(d,i){return d.split(" ")}),tickValues,tickFontSize,tickFontFamily,customTickInfo.styles);defined(longestFormattedString)||(longestFormattedString=longestTick.formattedVal);var tickBound=getTextBound(longestFormattedString,tickFontSize,tickFontFamily,longestTick.style,!0)}return{mode:"wrapOnSpace",maxTickCount:getMaxTickCountByBounds(rotation,tickBound,type),rotation:rotation}}},recalculatePlotSize:function(chartObj,oldPlotSize,tickSize,side,tickCount,margin,padding,outerPadding){var temp,v;oldPlotSize="height"===side?[v=(temp=tickSize[side]+margin.top+margin.bottom)*tickCount,0]:[0,v=(temp=tickSize[side]+margin.left+margin.right)*tickCount],v+=getOuterPaddingInPixel(oldPlotSize,tickCount,padding,outerPadding,temp),chartObj.systemConf.chart[side]=v}},axis.Ticks=Ticks,axis.AxisLabel=AxisLabel,axis.Ticks.prototype.ticklabelFitModels=function(tickValues,maxTickCount){var bestFitMode={},actualTickCount=tickValues.length;return bestFitMode.zigzag={},bestFitMode.rotate={},bestFitMode.type=actualTickCount>maxTickCount?2*actualTickCount<maxTickCount?"zigzag":"rotate":"default",bestFitMode},axis.render=function(chartObj,chartWidth,chartHeight,update){var systemconf=chartObj.systemConf,dataObject=chartObj.dataObject,plotBorderDrawn={left:!1,right:!1,top:!1,bottom:!1},wrap=chartObj.wrap,axes_animation_duration=function(){var axes_animation=systemconf.chart.axes.animation||{},enabled=axes_animation.enabled;if(!defined(enabled)){var serdata=chartObj.isAxisCategory||chartObj.isNonAxisMultiSeriesCategory?chartObj.seriesdata:chartObj.seriesdata.slice(0,1);enabled=serdata.some(function(d,i){var type=chartObj.chartTypes[i].name;return getAnimationConf(systemconf.chart.plot.plotoptions[type],d.plotoptions,chartObj,type).enabled})}return enabled?pick(axes_animation.duration,600):0}(),metaData=chartObj.systemConf.metadata,yMajorTicksIndex=0,xMajorTicksIndex=0,getParsedYAxisOrder=DataProcessor.helpers.getParsedYAxisOrder;chartObj.axes.animationDuration=axes_animation_duration,chartObj.zscale=chartObj.dataObject.hasZaxis?scale$1.getScale(chartObj,dataObject,chartObj.plotarea,chartObj.axes.x.orient,null,chartObj.dataset,"z"):null,chartObj.datalabels.hasFixedPosition=chartObj.datalabels.moduleExists&&function(chartObj){if(chartObj.dataObject.noofBarEnabledSeries){var vAlign;if(chartObj.seriesdata.some(function(series,seriesIndex){return(vAlign=getValignforBarLabels(chartObj,seriesIndex,DATALABELS_LABELTYPE))===FIXEDTOP_ALIGN}),vAlign===FIXEDTOP_ALIGN)return!0;var groupedByStack=chartObj.dataObject.groupedByStack;return groupedByStack.keys().some(function(d){return(vAlign=getValignforBarLabels(chartObj,groupedByStack.get(d).stackLabelIndex,STACKLABELS_LABELTYPE))===FIXEDTOP_ALIGN}),vAlign===FIXEDTOP_ALIGN}}(chartObj),chartObj.tickarea={left:0,right:0,top:0,bottom:0};var plotarea_approx={left:chartObj.plotarea.left,top:chartObj.plotarea.top,width:chartObj.plotarea.width,height:chartObj.plotarea.height};axis.constructTickObj(chartObj,chartWidth,chartHeight,"left",plotarea_approx,update),axis.constructTickObj(chartObj,chartWidth,chartHeight,"bottom",plotarea_approx,update),chartObj.zscale=chartObj.dataObject.hasZaxis?scale$1.getScale(chartObj,dataObject,chartObj.plotarea,chartObj.axes.x.orient,null,chartObj.dataset,"z"):null,rendererBoundUtils.updatePlotareaByBandWidth(chartObj,plotarea_approx);for(var scale1=scale$1.constructor(chartObj,"left"),type1=chartObj.axes.rotated?"x":"y",i=0;i<scale1.length;i++){createAxis("left",i);setAxisProp(scale1[i].scale,"left",i,update)}var scale2=scale$1.constructor(chartObj,"bottom"),type2=chartObj.axes.rotated?"y":"x";for(i=0;i<scale2.length;i++){createAxis("bottom",i);setAxisProp(scale2[i].scale,"bottom",i,update)}for(i=0;i<scale1.length;i++){null!=(axisObj=getAxisObject(chartObj,type1,i)).component&&drawAxes(axisObj.component,i,type1,update)}for(i=0;i<scale2.length;i++){var axisObj;null!=(axisObj=getAxisObject(chartObj,type2,i)).component&&drawAxes(axisObj.component,i,type2,update)}function updateAxisLine(orient,axisdata,wrap,axisComp,isaxis,type){var plotBorderData=systemconf.chart.plot.border,plotareaBorderEle=chartObj.container.selectAll("g.plotareaBorder-property"),bkpInf=null;if(defined(plotBorderData)&&!0===plotBorderData.show)chartObj.drawPlotBorder();else{var x1,x2,y1,y2,axislineData=axisdata.axisline,axislineClr=0==axislineData.show||null==axislineData.color?TRANSPARENT:axislineData.color,axislineWidth=validateNullVal(axislineData.strokeWidth,1),axislineStyle=axislineData.style||"solid",isInline=isTickInnerOrient(axisdata,type,chartObj)&&!axisComp.tickObj.tickValueObj.inlineToPlot,tickLength="left"==orient||"right"==orient?axisComp.preCalcTickLen().width:axisComp.preCalcTickLen().height,offset=isInline?tickLength:0,axislineEle=appendEle(plotareaBorderEle,"line",[1],".","class",orient);if(0==isaxis||0==axisdata.show||"hidden"==wrap.style("visibility"))return void axislineEle.style("stroke",TRANSPARENT);"bottom"==orient?(x1=-chartObj.tickarea.left,x2=chartObj.plotarea.width+chartObj.tickarea.right,y1=chartObj.plotarea.height+.5+offset,y2=chartObj.plotarea.height+.5+offset):"left"==orient?(x1=.5-offset,x2=.5-offset,y1=0,y2=chartObj.plotarea.height+chartObj.tickarea.bottom):"right"==orient?(x1=chartObj.plotarea.width+.5+offset,x2=chartObj.plotarea.width+.5+offset,y1=0,y2=chartObj.plotarea.height+chartObj.tickarea.bottom):"top"==orient&&(x1=-chartObj.tickarea.left,x2=chartObj.plotarea.width+chartObj.tickarea.right,y1=.5-offset,y2=.5-offset),axislineEle.styles({"stroke-width":axislineWidth,stroke:axislineClr,"shape-rendering":"crispedges","stroke-dasharray":getDashArray(axislineStyle,axislineWidth)}).attrs({x1:x1,x2:x2,y1:y1,y2:y2}),bkpInf={size:axislineWidth,clr:axislineClr},plotareaBorderEle.node()["border-"+orient]=bkpInf}wrap.selectAll("path.domain").style("stroke",TRANSPARENT)}function getAxisOrient(data,type,index){var orient=data.orient,axesRotated=chartObj.axes.rotated;return orient=null==orient?"x"==type?axesRotated?"left":"bottom":axesRotated?"bottom":0==index?"left":"right":orient}function createAxis(orient,index){var axes=[];switch(orient){case"left":axes=chartObj.axes.rotated?createAxisComp("x",index):createAxisComp("y",index);break;case"bottom":axes=chartObj.axes.rotated?createAxisComp("y",index):createAxisComp("x",index)}return axes}function setAxisProp(scaleObj,orient,i,update){var type="left"==orient?chartObj.axes.rotated?"x":"y":chartObj.axes.rotated?"y":"x";return function(axisObj,type,scaleObj,orient,index,update){var axisdata="x"==type?systemconf.chart.axes.xaxis:systemconf.chart.axes.yaxis[index],dim="bottom"==(orient=getAxisOrient(axisdata,type,index))||"top"==orient?chartHeight:chartWidth,isaxis=!0===axisdata.show&&dimension_based_intelligence(chartObj,type+"axis",dim),ticklabelMargin=getMargin(axisdata.ticklabel),tickPadding=getTickPadding(orient,ticklabelMargin,isTickInnerOrient(axisdata,type,chartObj));"y"!==type||isaxis&&!chartObj.axes.y.groups[index].disabled||yMajorTicksIndex++;if(axisObj){var disabledYaxis="y"===type&&chartObj.axes.y.groups[index].disabled;axisObj.plotBorderDrawn=!isaxis||disabledYaxis?axisObj.plotBorderDrawn:!plotBorderDrawn[orient],plotBorderDrawn[orient]=!0}if(isaxis){chartObj.axes.y.groups;var tickObj=getAxisObject(chartObj,type,index).ticks,oldAxisLen=tickObj.preCalcAxisLen,adjustVal=(tickObj.preCalcApproxAxisLength(plotarea_approx),tickObj.preCalcAxisLen-oldAxisLen),tickValueObj=tickObj.tickValueObj,selector=type+"-axis-"+index,axisWrap=appendEle(wrap.selectAll("g."+type+"-axis"),"g",isaxis?[axisdata]:[],".","class",selector);if(mathAbs(adjustVal)>1&&(adjustPlotarea(orient,adjustVal),plotarea_approx=chartObj.plotarea),null!=axisObj){var isMergedAxis="y"==type&&metaData.axes.y[index].length>1,hasTimegroupBy=tickObj&&tickObj.isHierarchy()&&chartObj.dataObject.hierarchical.groupByTime,columnidx=chartObj.dataset.getColumnIdx(type,hasTimegroupBy?0:index),datatype=metaData.columns[columnidx].datatype;datatype=tickObj&&tickObj.isHierarchialLevelType()&&chartObj.dataObject.hierarchical.categoryTree?ORDINAL_DATATYPE:datatype;var formatConf=metaData.columns[columnidx][datatype],axisFormat=(formatConf=isMergedAxis&&"y"==type?merged_axis_column_intersect(index,chartObj):formatConf)&&(formatConf.axisformat||formatConf.format),tickSize=validateNullVal(axisdata.tickmark.size,6),formattingFunction=(dataObject.isStackedPercentChart||dataObject.isPercentChart)&&"y"==type?getFormattedValueByPercent:getFormattedValue,specifierIndex=hasTimegroupBy?index:null,isMultiLineTick=!(tickObj&&tickObj.isHierarchy())&&formatConf&&axisFormat&&axisFormat.specifier&&axisFormat.specifier.constructor==Array||"wrapOnSpace"==tickValueObj.mode||"wrapAll"==tickValueObj.mode,isInline=tickValueObj.isInline&&!tickValueObj.inlineToPlot,w="left"===orient||"right"===orient?"width":"height";chartObj.tickarea[orient]=isInline&&axisObj.plotBorderDrawn?tickValueObj.axisgroup[w]:chartObj.tickarea[orient]||0,axisObj.orient(orient).scale(scaleObj).tickPadding(tickPadding).tickSize(tickSize).tickSizeOuter(0).majorTicks(index===("y"===type?yMajorTicksIndex:xMajorTicksIndex)?getMajorTicks(orient,type,tickValueObj):null).plotarea(chartObj.plotarea).systemconf(chartObj.systemConf).tickRotation(tickValueObj.rotation).preCalcTickLen(tickObj.preCalcTickLen).chartObj(chartObj).columnIndices(isMergedAxis&&"y"==type?metaData.axes.y[index]:[columnidx]).isMultiLineTick(isMultiLineTick);var format=null!=formatConf?formatConf.axisformat||formatConf.format:null;if(format&&"auto"==format.specifier&&!scaleObj.bandwidth)axisObj.tickValues(tickObj.getTicksforAxisComp()).tickFormat(function(d,i){var x=scaleObj,formattedValue=x.tickFormat()(d);d3$1.select(this).text(formattedValue),this.formattedVal=formattedValue});else{axisObj.tickValues(tickObj.getTicksforAxisComp());var tickPos=tickObj.getActualTicklabel(),maxWidth=tickObj.tickValueObj.maxTickSize.horizontal,maxHeight=tickObj.tickValueObj.maxTickSize.vertical,fSize=utils.getVal(getValByPriority([axisdata.ticklabel,chartObj.systemConf.chart,chartObj.systemConf.canvas,$ZCG],"fontSize")),needTickConfigWrap="wrapOnSpace"==tickObj.tickValueObj.mode||"wrapAll"==tickObj.tickValueObj.mode,isMultiLine=axisObj.isMultiLineTick(),isCustomLabel=defined(axisdata.ticklabel.showAs),args=[null,orient,chartObj,tickValueObj.rotation,axisdata.ticklabel.textOverflow,axisObj.scale(),axisWrap,axisObj,"ticklabel",axisdata.ticklabel,index,!0],doOverflow=handleOverflowTicks.apply(null,args);axisObj.tickFormat(function(d,i){var tick=tickPos(i),formattedValue=formattingFunction(formatConf,tick,datatype,chartObj,"axis",null,null,specifierIndex);if(d3$1.select(this).text(formattedValue),this.formattedVal=formattedValue,isMultiLine)needTickConfigWrap&&(formattedValue=formatTickWrapByMode(formattedValue,tickObj.tickValueObj.mode,maxWidth,maxHeight,fSize)),wrapTextContent(d3$1.select(this),formattedValue,{orient:orient});else if(isCustomLabel&&defined(tickObj.tickValueObj.customTicks[i])){this.innerHTML="",wrapTextContent(d3$1.select(this),tickObj.tickValueObj.customTicks[i],null,!0);var textContent=getTextContent(d3$1.select(this));this.formattedVal=isArray(textContent)?textContent.join(" "):textContent}doOverflow(this,i)})}axisObj.tickObj=tickObj,axisObj.hideAxisLabel=!dimension_based_intelligence(chartObj,type+"axislabel",dim)}}return axisObj}(getAxisObject(chartObj,type,i).component,type,scaleObj,orient,i)}function createAxisComp(type,index){var axes=getAxisObject(chartObj,type,index),axis_data="x"==type?systemconf.chart.axes.xaxis:systemconf.chart.axes.yaxis[index]||systemconf.chart.axes.yaxis[0],axisComp=axes.component;return axisComp||(axes.component="x"==type?axis_data.show&&dimension_based_intelligence(chartObj,"xaxis",chartHeight)?axis.get():null:axis_data.show?axis.get():null,axisComp)}function drawAxes(axisObj,index,type,update){return function(axisComp,type,index,update){var axisdata="x"==type?systemconf.chart.axes.xaxis:systemconf.chart.axes.yaxis[index],orient=(axisdata.ticklabel,getAxisOrient(axisdata,type,index)),dim="bottom"==orient||"top"==orient?chartHeight:chartWidth,isaxis=!0===axisdata.show&&dimension_based_intelligence(chartObj,type+"axis",dim),selector=type+"-axis-"+index,axisWrap=appendEle(wrap.selectAll("g."+type+"-axis"),"g",isaxis?[axisdata]:[],".","class",selector),axisObj=getAxisObject(chartObj,type,index);axisWrap.style("display","y"===type&&chartObj.axes.y.groups[index].disabled?NONE:null),"x"===type&&isaxis?adjustXAxiswrap(axisdata,index,axisComp,!0):adjustYAxeswrap(axisdata,index,axisComp,null,!0);if(isaxis){axisObj.ticks.tickValueObj;chartObj.plotarea=axisComp.plotarea(),axisWrap.transition().duration(axes_animation_duration).call(axisComp,type,index),"y"==type&&1==axisComp.plotBorderDrawn?updateAxisLine(orient,axisdata,axisWrap,axisComp,isaxis,type):"x"==type&&0==index&&updateAxisLine(orient,axisdata,axisWrap,axisComp,isaxis,type)}else 1==axisComp.plotBorderDrawn&&updateAxisLine(orient,axisdata,axisWrap,axisComp,isaxis,type);"y"==type&&isObjectPropDefined(systemconf.chart,"scroll")&&systemconf.chart.scroll.enabled&&chartObj.brush.initialize(chartObj.plotarea)}(axisObj,type,index)}function adjustXAxiswrap(data,index,axis_comp,isDraw){var usedAxisSpace={left:0,top:0,right:0,bottom:0},axisCount=chartObj.axes.x.count;if(0==index){for(var i=0;i<axisCount;i++){var axisComp=getAxisObject(chartObj,"x",i).component,xorient=axis_comp.orient(),xwrapboxWid=isDraw?getTickLabelWidth(data.label,data.ticklabel,axisComp.preCalcTickLen(),chartObj,"x",i,xorient):axisComp.tickLabelWidth(),xwrap=wrap.selectAll(".x-axis-"+i),transX="right"==xorient?chartObj.plotarea.left+chartObj.plotarea.width+usedAxisSpace.right:chartObj.plotarea.left-usedAxisSpace.left,transY=chartObj.axes.rotated||"top"==xorient?chartObj.plotarea.top-usedAxisSpace.top:chartObj.plotarea.top+chartObj.plotarea.height+usedAxisSpace[xorient];usedAxisSpace[xorient]+=xwrapboxWid,xwrap.attr("transform","translate("+transX+","+transY+")"),xwrap.attr("x",transX),xwrap.attr("y",transY)}xwrap=wrap.selectAll("g.x-axis-0")}}function adjustYAxeswrap(data,index,axis_comp,strictMode,isDraw){var yaxisData=systemconf.chart.axes.yaxis,yaxesLength=chartObj.axes.y.groups.length,yaxis0_wrap=wrap.selectAll(".y-axis-0"),yaxis0_orient=yaxisData[0].orient||(chartObj.axes.rotated?"bottom":yaxisData[0].orient||"left");if(strictMode||0==index){for(var usedAxisSpace={left:0,top:0,right:0,bottom:0},j=0;j<yaxesLength;j++){var ydata=yaxisData[j],orient=ydata.orient,dim="bottom"==(orient=orient||(chartObj.axes.rotated?"bottom":null!=ydata.orient?ydata.orient:0==j?"left":"right"))||"top"==orient?chartHeight:chartWidth;if(!0===ydata.show&&dimension_based_intelligence(chartObj,"yaxis",dim)){var axisComp=chartObj.axes.y.groups[j].component,ywrap=wrap.selectAll(".y-axis-"+j),ywrapboxWid=isDraw?getTickLabelWidth(ydata.label,ydata.ticklabel,axisComp.preCalcTickLen(),chartObj,"y",j,orient):axisComp.tickLabelWidth(),translateX="bottom"==orient||"top"==orient?chartObj.plotarea.left:"left"===orient?chartObj.plotarea.left-usedAxisSpace[orient]:chartObj.plotarea.left+chartObj.plotarea.width+usedAxisSpace[orient],translateY="bottom"==orient?chartObj.plotarea.height+chartObj.plotarea.top:chartObj.plotarea.top;usedAxisSpace[orient]+=chartObj.axes.y.groups[j].disabled?0:ywrapboxWid,ywrap.attr("transform","translate("+translateX+","+translateY+")"),axisComp&&1==axisComp.plotBorderDrawn&&updateAxisLine(orient,ydata,ywrap,axis_comp,"y")}}!chartObj.axes.rotated&&yaxis0_wrap.selectAll("line.majorTicks").attr("x2","right"==yaxis0_orient?-chartObj.plotarea.width:chartObj.plotarea.width)}}function getTickLabelWidth(labeldata,ticklabeldata,preCalcTickLen,chartObj,type,axisOrder,orient){var axisLabelMargin={top:0,right:0,bottom:5,left:0},curTickLabelWidth=0,labelSize=0,axisObj=getAxisObject(chartObj,type,axisOrder),axisComp=axisObj.component,tickComp=axisObj.ticks;labelSize="clr"===type?0:axisObj.axisLabel.getBBox().height,axisComp.hideAxisLabel||!1===labeldata.show||!defined(labeldata.text)||""===labeldata.text||tickComp.isHierarchy()&&axisOrder<chartObj.dataObject.hierarchical.finalDepth?axisLabelMargin.top=axisLabelMargin.bottom=axisLabelMargin.left=axisLabelMargin.right=0:(axisLabelMargin.top=pick(labeldata.marginTop,5),axisLabelMargin.bottom=pick(labeldata.marginBottom,5),axisLabelMargin.left=pick(labeldata.marginLeft,5),axisLabelMargin.right=pick(labeldata.marginRight,5));var marginTickLabel_right=pick(ticklabeldata.marginRight,5),marginTickLabel_left=pick(ticklabeldata.marginLeft,5),marginTickLabel_bottom=pick(ticklabeldata.marginBottom,5),marginTickLabel_top=pick(ticklabeldata.marginTop,5);switch(orient){case"top":curTickLabelWidth=(curTickLabelWidth=null!=preCalcTickLen?preCalcTickLen.height+marginTickLabel_top+axisLabelMargin.bottom:0)+labelSize+axisLabelMargin.top;break;case"bottom":curTickLabelWidth=(curTickLabelWidth=null!=preCalcTickLen?preCalcTickLen.height+marginTickLabel_bottom+axisLabelMargin.top:0)+labelSize+axisLabelMargin.bottom;break;case"left":curTickLabelWidth=(curTickLabelWidth=null!=preCalcTickLen?preCalcTickLen.width+marginTickLabel_left+axisLabelMargin.right:0)+labelSize+axisLabelMargin.left;break;case"right":curTickLabelWidth=(curTickLabelWidth=null!=preCalcTickLen?preCalcTickLen.width+marginTickLabel_right+axisLabelMargin.left:0)+labelSize+axisLabelMargin.right}return axisComp.tickLabelWidth(curTickLabelWidth),curTickLabelWidth}function getMajorTicks(orient,type,tickValueObj){var x1,y1,x2,y2;x1=y1=x2=y2=0;var isInline=tickValueObj.isInline&&!tickValueObj.inlineToPlot,longTick=tickValueObj.longTickSize,inlineOffset=isInline&&("left"==orient||"right"==orient)?longTick.width:0;if("bottom"==orient?(y1=inlineOffset,y2=-chartObj.plotarea.height):"top"==orient?(y1=-inlineOffset,y2=chartObj.plotarea.height):"left"==orient?(x1=-inlineOffset,x2=chartObj.plotarea.width):"right"==orient&&(x1=inlineOffset,x2=-chartObj.plotarea.width),"x"===type&&chartObj.datalabels.hasFixedPosition){var yaxiscolumnorder=chartObj.axes.y.groups.map(function(d){return d.disabled}).indexOf(!1),axisReversed=systemconf.chart.axes.yaxis[yaxiscolumnorder].reversed,correction=function(index){var maxRange,yscale=scale$1.getScale(chartObj,chartObj.dataObject,chartObj.plotarea,chartObj.axes.y.orient,index,chartObj.dataset,"y"),origRange=yscale.origRange;if(chartObj.dataset.getDataType("y",index)===ORDINAL_DATATYPE){var domain=yscale.domain();maxRange=yscale(domain[domain.length-1])+yscale.bandwidth()/2}else{var domain=chartObj.dataObject.getMinMaxY(index,0,chartObj.datalabels.hasFixedPosition);maxRange=yscale(domain[1])}return mathMin(mathAbs(maxRange-origRange[0]),mathAbs(maxRange-origRange[1]))}(yaxiscolumnorder);"bottom"==orient?axisReversed?y1-=correction:y2+=correction:"top"==orient?axisReversed?y2-=correction:y1+=correction:"left"==orient?axisReversed?x1+=correction:x2-=correction:"right"==orient&&(axisReversed?x2+=correction:x1-=correction)}return{x1:x1,y1:y1,x2:x2,y2:y2}}function adjustPlotarea(orient,adjustVal){var plotarea=chartObj.plotarea;"left"===orient?(plotarea.left+=adjustVal,plotarea.width-=adjustVal):"right"===orient?plotarea.width-=adjustVal:"bottom"===orient?(plotarea.height-=adjustVal,plotarea.bottom+=adjustVal):(plotarea.height-=adjustVal,plotarea.top+=adjustVal)}function addorremoveAxis(axisWrap,axisComp,data,index,type,mode){plotBorderDrawn={left:!1,right:!1,top:!1,bottom:!1},chartObj.container.selectAll("g.plotareaBorder-property").selectAll("line").style("stroke",TRANSPARENT);var orient=axisComp.orient(),wrapWid=(axisComp.majorTicks(),axisWrap.node().getBBox().width);wrapWid+="left"==orient?data.label.marginLeft:data.label.marginRight,wrapWid=axisComp.tickLabelWidth(),"hidden"===axisWrap.style("visibility")&&"remove"===mode||(chartObj.plotarea.width="add"==mode?chartObj.plotarea.width-wrapWid:chartObj.plotarea.width+wrapWid,chartObj.plotarea.left="left"==orient?"add"==mode?chartObj.plotarea.left+wrapWid:chartObj.plotarea.left-wrapWid:chartObj.plotarea.left);var co=0,visibility="add"==mode?"visible":"hidden";axisWrap.style("visibility",visibility),"add"==mode&&axisWrap.style("display",null);for(var i=0;i<chartObj.axes.y.groups.length;i++){var ywrap=wrap.selectAll("g.y-axis-"+i),curAxisComp=chartObj.axes.y.groups[i].component,curAxisOrient=curAxisComp.orient(),curMajorTicks=curAxisComp.majorTicks(),curAxisData=systemconf.chart.axes.yaxis[i]||systemconf.chart.axes.yaxis[0];ywrap.node()&&("hidden"!=ywrap.style("visibility")&&0==co?(curMajorTicks=getMajorTicks(curAxisOrient,type,curAxisComp.tickObj.tickValueObj),curAxisComp.majorTicks(curMajorTicks),ywrap.transition().duration(0).call(curAxisComp,type,i,!0),co++):null!=curMajorTicks&&co>0&&(curAxisComp.majorTicks(null),ywrap.transition().duration(0).call(curAxisComp,type,i,!0)),"visible"!=ywrap.style("visibility")||plotBorderDrawn[curAxisOrient]?(curAxisComp.plotBorderDrawn=!1,"visible"==ywrap.style("visibility")?ywrap.selectAll("path.domain").style("stroke",curAxisData.axisline.color):ywrap.selectAll("path.domain").style("stroke",TRANSPARENT)):(plotBorderDrawn[curAxisOrient]=!0,curAxisComp.plotBorderDrawn=!0))}adjustYAxeswrap(0,index,axisComp,!0)}chartObj.dataset.getDataType("x")==ORDINAL_DATATYPE&&scale$1.barBandwidth(chartObj),chartObj.updateZscale=function(){chartObj.dataObject.hasZaxis&&chartObj.zscale.domain(dataObject.getMinMaxZ())},chartObj.updateScale=function(serData,type,zmInterval,axisorder){var extentVal,yaxiscolumnorder="y"==type?getParsedYAxisOrder(null==serData||isArray(serData)?serData:serData.yaxiscolumnorder):0,axiswrap=(axisorder="x"==type&&defined(axisorder)?axisorder:yaxiscolumnorder,wrap.selectAll("g."+type+"-axis-"+axisorder)),axes=getAxisObject(chartObj,type,axisorder),tickObj=axes.ticks,axisdata="x"==type?systemconf.chart.axes.xaxis:systemconf.chart.axes.yaxis[yaxiscolumnorder],ticklabeldata=axisdata.ticklabel,orient=axes.component?axes.component.orient():getAxisOrient(axisdata,type,yaxiscolumnorder),dim="bottom"==orient||"top"==orient?chartHeight:chartWidth,isaxis=!0===axisdata.show&&dimension_based_intelligence(chartObj,type+"axis",dim),columnidx=chartObj.dataset.getColumnIdx(type,yaxiscolumnorder),datatype=metaData.columns[columnidx].datatype,formatConf=(datatype=tickObj&&tickObj.isHierarchialLevelType()&&chartObj.dataObject.hierarchical.categoryTree?ORDINAL_DATATYPE:datatype,metaData.columns[columnidx][datatype]),specifierIndex=tickObj&&tickObj.isHierarchy()&&chartObj.dataObject.hierarchical.groupByTime?axisorder:null;if(zmInterval){extentVal=zmInterval;var newScale=scale$1.getScale(chartObj,dataObject,chartObj.plotarea,orient,yaxiscolumnorder,chartObj.dataset,type,extentVal);axes.eventscale=axes.scale=newScale}else{var cType=chartObj.chartTypes[0].name,outerPadding=systemconf.chart.plot.plotoptions[cType].outerPadding;extentVal=datatype==ORDINAL_DATATYPE?dataObject.getCategories(type,axisorder):"x"==type?chartObj.dataObject.getMinMaxX(validateNullVal(outerPadding,.2)):chartObj.dataObject.getMinMaxY(yaxiscolumnorder);newScale=scale$1.getScale(chartObj,dataObject,chartObj.plotarea,orient,axisorder,chartObj.dataset,type);axes.eventscale=axes.scale=newScale}if("y"!=type||axiswrap.empty()||"NoData"!=extentVal[0]||"NoData"!=extentVal[1])if("y"!=type||axiswrap.empty()||"hidden"!=axiswrap.style("visibility")||axiswrap.style("display")===NONE){if(dataObject.isBubbleEnabled&&"y"==type&&(axes.eventscale=axes.scale=scale$1.getScale(chartObj,dataObject,chartObj.plotarea,orient,yaxiscolumnorder,chartObj.dataset,"y")),isaxis){axes.component.scale(axes.scale),formatConf=metaData.axes.y[yaxiscolumnorder].length>1&&"y"==type?merged_axis_column_intersect(yaxiscolumnorder,chartObj):formatConf;var formattingFunction=(dataObject.isStackedPercentChart||dataObject.isPercentChart)&&"y"==type?getFormattedValueByPercent:getFormattedValue,formatConf_axis=null!=formatConf?formatConf.axisformat||formatConf.format:null,oldLongTickSize=(tickObj=axes.ticks,"bottom"==orient||"top"==orient?tickObj.tickValueObj.longTickSize.height:tickObj.tickValueObj.longTickSize.width),tickValueObj=tickObj.getTickValues(chartObj.plotarea.width,chartObj.plotarea.height,zmInterval,!1,null,axes.Ticks,chartObj.plotarea);tickObj.tickValueObj=tickValueObj;var curLongTickSize="bottom"==orient||"top"==orient?tickObj.tickValueObj.longTickSize.height:tickObj.tickValueObj.longTickSize.width,preCalcTickLen=tickObj.preCalcTickLen,adjustVal=oldLongTickSize>curLongTickSize?curLongTickSize-oldLongTickSize:oldLongTickSize<curLongTickSize?curLongTickSize-oldLongTickSize:0;"bottom"==orient||"top"==orient?preCalcTickLen.height=preCalcTickLen.height+adjustVal:preCalcTickLen.width=preCalcTickLen.width+adjustVal;var tickValues=tickObj.getTicksforAxisComp();axes.component.tickValues(tickValues).tickRotation(tickValueObj.rotation);var tickPos=tickObj.getActualTicklabel(),maxWidth=tickObj.tickValueObj.maxTickSize.horizontal,maxHeight=tickObj.tickValueObj.maxTickSize.vertical,fSize=utils.getVal(getValByPriority([axisdata.ticklabel,chartObj.systemConf.chart,chartObj.systemConf.canvas,$ZCG],"fontSize")),needTickConfigWrap="wrapOnSpace"==tickObj.tickValueObj.mode||"wrapAll"==tickObj.tickValueObj.mode,isMultiLine=axes.component.isMultiLineTick(),isCustomLabel=defined(axisdata.ticklabel.showAs),args_tick=[null,orient,chartObj,tickValueObj.rotation,axisdata.ticklabel.textOverflow,axes.scale,wrap,axes.component,"ticklabel",axisdata.ticklabel,axisorder,!0],doOverflow=handleOverflowTicks.apply(null,args_tick);formatConf_axis&&"auto"==formatConf_axis.specifier&&!axes.scale.bandwidth?axes.component.tickFormat(function(d,i){d3$1.select(this).text(axes.scale.tickFormat()(d))}):axes.component.tickFormat(function(d,i){var tick=tickPos(i),formattedValue=formattingFunction(formatConf,tick,datatype,chartObj,"axis",null,null,specifierIndex);d3$1.select(this).text(formattedValue),isMultiLine?(needTickConfigWrap&&(formattedValue=formatTickWrapByMode(formattedValue,tickObj.tickValueObj.mode,maxWidth,maxHeight,fSize)),wrapTextContent(d3$1.select(this),formattedValue,{orient:orient})):isCustomLabel&&defined(tickObj.tickValueObj.customTicks[i])&&(this.innerHTML="",wrapTextContent(d3$1.select(this),tickObj.tickValueObj.customTicks[i],null,!0)),doOverflow(this,i)}),axes.component.isMultiLineTick()||defined(ticklabeldata.showAs)?axiswrap.call(axes.component,type,axisorder):axiswrap.transition().duration(axes_animation_duration).call(axes.component,type,axisorder);var fullUpation=!axiswrap.empty()&&axiswrap.style("display")===NONE&&"y"===type;if(fullUpation&&addorremoveAxis(axiswrap,axes.component,axisdata,yaxiscolumnorder,"y","add"),adjustVal&&0!=adjustVal){fullUpation||adjustPlotarea(orient,adjustVal);var type_opp="x"==type?"y":"x";chartObj.updateScale(serData,type_opp),chartObj.drawPlotareaClippath(),chartObj.updatePlotareaProp()}"y"===type?(axiswrap.styles({display:null,visibility:"visible"}),adjustYAxeswrap(0,yaxiscolumnorder,axes.component,!0)):adjustXAxiswrap(axisdata,axisorder,axes.component);var PW=chartObj.plotarea.width;!chartObj.axes.rotated&&"y"==type&&wrap.selectAll(".y-axis-"+yaxiscolumnorder).selectAll("line.majorTicks").attr("x2","right"!=orient?PW:-PW),1==axes.component.plotBorderDrawn&&updateAxisLine(orient,axisdata,axiswrap,axes.component,type)}}else isaxis&&addorremoveAxis(axiswrap,axes.component,axisdata,yaxiscolumnorder,"y","add");else isaxis&&addorremoveAxis(axiswrap,axes.component,axisdata,yaxiscolumnorder,"y","remove")}};var identity$1=function(x){return x};function translateX(x){return"translate("+(x+.5)+",0)"}function translateY(y){return"translate(0,"+(y+.5)+")"}function entering(){return!this.__axis}function d3axis(context,args,data){var tickArguments=[],chart=args.chart,axis=args.axis,tickObj=axis.ticks.tickValueObj,tickValues=args.tickValues,tickFormat=args.tickFormat,tickSizeInner=args.tickSizeInner,tickSizeOuter=args.tickSizeOuter,gridSize=args.gridSize,tickPadding=args.tickPadding,rotation=args.rotation,orient=args.orient,scale1=args.scale,isInline=tickObj&&tickObj.isInline,isInwardPlot=tickObj&&tickObj.inlineToPlot,k="top"===orient||"left"===orient?-1:1,l=isInwardPlot?-k:k,m=isInline?-k:k,x="left"===orient||"right"===orient?"x":"y",w="left"===orient||"right"===orient?"width":"height",transform="top"===orient||"bottom"===orient?translateX:translateY,h=chart.dataObject.isPolarAxisCategory?"H":"h",ticklabeldata=(data.label,data.ticklabel),events_tick=ticklabeldata.events,tickmarkdata=data.tickmark,axisline=data.axisline,griddata=data.grid,renderGrid=args.renderGrid,renderTicklabel=args.renderTicklabel,cursor=null!=events_tick&&0==validateNullVal(events_tick.enabled,!0)?"auto":events_tick&&events_tick.cursor||"pointer",plotBorderData=chart.systemConf.chart.plot.border,values=null==tickValues?scale1.ticks?scale1.ticks.apply(scale1,tickArguments):scale1.domain():tickValues,format=null==tickFormat?scale1.tickFormat?scale1.tickFormat.apply(scale1,tickArguments):identity$1:tickFormat,spacing=isInline&&!isInwardPlot?tickObj.longTickSize[w]:Math.max(tickSizeInner,0)+tickPadding,tickmarkStart=isInline&&!isInwardPlot?tickObj.axisgroup[w]:0,range=scale1.origRange?scale1.origRange:scale1.range(),range0=+range[0]+.5,range1=+range[range.length-1]+.5,position=(scale1.bandwidth?function(scale1){var offset=Math.max(0,scale1.bandwidth()-1)/2;return scale1.round()&&(offset=Math.round(offset)),function(d){return+scale1(d)+offset}}:function(scale1){return function(d){return+scale1(d)}})(scale1.copy()),selection=context.selection?context.selection():context,path=selection.selectAll(".domain").data([null]),tick=selection.selectAll(".tick").data(values,scale1).order(),tickExit=tick.exit(),tickEnter=tick.enter().append("g").attr("class","tick"),minorTicks=tick.select("line.minorTicks"),majorTicks=gridSize&&griddata.show?tick.select("line.majorTicks"):tick.select("line.majorTicks").remove(),ticklabel=tick.select("text").attr("class","ticklabel");if(path=path.merge(path.enter().insert("path",".tick")).attr("class","domain").styles({stroke:!1===axisline.show||axisline.hideParent?"transparent":axisline.color||"#000","stroke-width":pick(axisline.strokeWidth,1),"stroke-dasharray":getDashArray(axisline.style,pick(axisline.strokeWidth,1))}),tick=tick.merge(tickEnter),minorTicks=minorTicks.merge(tickEnter.append("line")).attr(x+"1",k*tickmarkStart).attr(x+"2",k*tickmarkStart+m*tickSizeInner).attr("class","minorTicks").styles({fill:"none","shape-rendering":"crispedges","stroke-width":tickmarkdata.strokeWidth,stroke:tickmarkdata.color}),renderGrid&&gridSize&&griddata.show){var strokeWidth=pick(griddata.strokeWidth,1),strokeDashArray=getDashArray(griddata.style,strokeWidth),strokeLineCap=getLineCap(griddata.lineCap,griddata.style);majorTicks=majorTicks.merge(tick.append("line")).attr("stroke","#000").attr("class","majorTicks").attrs({x1:gridSize.x1,y1:gridSize.y1,x2:gridSize.x2,y2:gridSize.y2}).styles({fill:"none","shape-rendering":"crispedges","stroke-width":strokeWidth,stroke:griddata.color,"stroke-dasharray":strokeDashArray,"stroke-linecap":strokeLineCap})}var hierarchy=[ticklabeldata,chart.systemConf.chart,chart.systemConf.canvas,$ZCG],fSize=utils.getVal(getValByPriority(hierarchy,"fontSize")),fFamily=getValByPriority(hierarchy,"fontFamily"),fWeight=getValByPriority(hierarchy,"fontWeight"),fStyle=getValByPriority(hierarchy,"fontStyle"),fShadow=getValByPriority(hierarchy,"textShadow"),fColor=getValByPriority(hierarchy,"fontColor"),txtDec=getValByPriority(hierarchy,"textDecoration"),rotationInfo=(getValByPriority(hierarchy,"strokeColor"),getTickRotateInfo(orient,rotation,0,null,tickmarkdata.size,tickPadding,tickObj));if(ticklabel=ticklabel.merge(tickEnter.append("text")),renderTicklabel&&(ticklabel.attr("class","ticklabel").style("font-size",fSize+"px").style("font-family",fFamily).style("font-weight",fWeight).style("font-style",fStyle).style("text-shadow",fShadow).style("text-decoration",txtDec).style("fill",fColor).style("text-anchor",rotationInfo.textAnchor).style("cursor",cursor).style(x,l*spacing).attr(x,l*spacing).attr("dy",function(d,i){return tickObj&&"zigzag"==tickObj.mode&&i%2&&rotationInfo.dy1?rotationInfo.dy1:rotationInfo.dy}).attr("transform","rotate("+rotationInfo.rotate[0]+" "+rotationInfo.rotate[1]+" "+rotationInfo.rotate[2]+")"),function(ticklabelEle,orient,rotationInfo,ticklabeldata,data,scaleObj,chartObj){var minmaxlabelsdata=ticklabeldata.minmaxlabels||{},systemconf=chartObj.systemConf;if(!0===minmaxlabelsdata.show){var axisReversed=!0===data.reversed,minmaxlabels_fontSize=+utils.getVal(getValByPriority([minmaxlabelsdata,ticklabeldata,systemconf.chart,systemconf.canvas,$ZCG],"fontSize")),domain=scaleObj.domain(),domainLength=domain.length-1,minmaxlabels=ticklabelEle.filter(function(d,i){return!(d-domain[0]&&d-domain[domainLength])});"top"!==orient&&"bottom"!==orient||"middle"!==rotationInfo.textAnchor?"left"!==orient&&"right"!==orient||!(chartObj.plotarea.top<minmaxlabels_fontSize/2||chartObj.plotarea.bottom<minmaxlabels_fontSize/2)||minmaxlabels.attr("dy",function(d){return d-domain[axisReversed?domainLength:0]?"0.9em":"-0.3em"}):minmaxlabels.style("text-anchor",function(d){return d-domain[axisReversed?domainLength:0]?"end":"start"}),applyFont(minmaxlabels,[minmaxlabelsdata,ticklabeldata,systemconf.chart,systemconf.canvas,$ZCG])}}(ticklabel,orient,rotationInfo,ticklabeldata,data,scale1,chart),axis.ticks.isHierarchialLevelType()&&ticklabel.call(centeringTicklabel,scale1,orient)),tick.attr("transform",function(d){return transform(position(d))}),context!==selection&&(tick=tick.transition(context),minorTicks=minorTicks.transition(context),ticklabel=ticklabel.transition(context),tickExit=tickExit.transition(context).attr("opacity",1e-6).attr("transform",function(d){return isFinite(d=position(d))?transform(d):this.getAttribute("transform")}),tickEnter.attr("opacity",1e-6).attr("transform",function(d){var p=this.parentNode.__axis;return transform((p&&isFinite(p=p(d)),position(d)))})),tickExit.remove(),path.attr("d","left"===orient||"right"==orient?"M"+k*(tickSizeOuter+tickmarkStart)+","+range0+h+"0.5V"+range1+"H"+k*(tickSizeOuter+tickmarkStart):"M"+range0+","+k*tickSizeOuter+"V0.5H"+range1+"V"+k*tickSizeOuter),tick.attr("opacity",1).attr("transform",function(d){return transform(position(d))}),tickObj&&tickObj.isInline&&defined(plotBorderData)&&!0===plotBorderData.show){var isLeftOrRight="left"==orient||"right"==orient,translateIndex=isLeftOrRight?1:0,pos=isLeftOrRight?fSize*parseFloat(rotationInfo.dy):0,margin=isLeftOrRight?[0,chart.plotarea.height]:[chart.plotarea.left+.05*chart.plotarea.left,chart.plotarea.width+.05*chart.plotarea.width];tick.style("display",function(){var translate=getSvgTransform(this).translate[translateIndex];return isWithinRange(pos+translate,margin)?"":"none"})}minorTicks.attr(x+"2",k*tickmarkStart+m*tickSizeInner),selection.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","right"===orient?"start":"left"===orient?"end":"middle"),selection.each(function(){this.__axis=position}),renderTicklabel&&(ticklabel.each(format),!0===ticklabeldata.tooltip&&ticklabel.each(function(d){addSVGtitleEle(d3.select(this),this.formattedVal)}))}function getCustomThresholdText(text,data,colInfo,chartObj){var dataType=colInfo.datatype,format=colInfo[dataType],type="threshold";return text.replace(CUSTOM_VALUE_PATTERN,function($1,index){var val="";return isArray(data[index])?(val=getFormattedValue(format,data[index][0],dataType,chartObj,type,!1),val+=" - "+getFormattedValue(format,data[index][1],dataType,chartObj,type,!1)):val=getFormattedValue(format,data[index],dataType,chartObj,type,!1),val})}axis.get=function(){var axisComp,scaleObj,ticks,changeOfOrient,plotarea,ticklabeldata,tickmarkdata,labeldata,griddata,systemconf,chartObj,preCalcTickLen,orient,columnIndices,isMultiLineTick,animationDuration,tickArguments=[],tickValues=null,tickFormat=null,tickSizeInner=6,tickSizeOuter=6,tickPadding=3,majorTicks=null,tickLabelWidth=null,tickRotation=0;function chart(selection,type,axisOrder,redraw){return selection.each(function(data){var container=d3_select(this);labeldata=data.label,ticklabeldata=data.ticklabel,tickmarkdata=data.tickmark,griddata=data.grid;var axisObj=getAxisObject(chartObj,type,axisOrder),tickComp=axisObj.ticks,tickObj=tickComp.tickValueObj,rotation=(tickRotation=pick(tickRotation,0))<0?360-mathAbs(tickRotation):tickRotation;rotation=rotation>360?mathAbs(rotation)-360:rotation,changeOfOrient&&container.selectAll("g.axisgroup").selectAll("*").remove();var tickLabelInlineG,g=appendEle(container,"g",[data],".","class","axisgroup");if(container.selectAll("g#ticklabelG").remove(),tickObj&&tickObj.inlineToPlot){container.selectAll("g.axisgroup").selectAll("*").remove(),(tickLabelInlineG=appendEle(container,"g",[1],"#","id","ticklabelG")).style("pointer-events","visible");var shadowEle=appendEle(chartObj.staticPaneSVG,"use",[1]);shadowEle.attr("xlink:href","#ticklabelG"),shadowEle.attr("x",container.attr("x")),shadowEle.attr("y",container.attr("y"))}if(ticks&&axisComp.ticks(ticks[0],ticks[1]),chartObj.isAxisCategory&&"clr"!==type){var id=function(chartObj,tickObj,orient,type,axisOrder){var plotAreaClone=simpleClone(chartObj.plotarea);plotAreaClone.chartId=chartObj.id;var defs=appendEle(chartObj.svg,"defs",[1]),id=generateIdByPropValue(plotAreaClone,type+axisOrder),clipRect=appendEle(appendEle(defs,"clipPath",[1],"#","id",id),"rect",[1]),data="x"==type?chartObj.systemConf.chart.axes.xaxis:chartObj.systemConf.chart.axes.yaxis[axisOrder],rect={},axisRect=tickObj.axisgroup,margin_left=.5*chartObj.plotarea.left,margin_right=.5*(chartObj.canvasarea.width-(chartObj.plotarea.left+chartObj.plotarea.width)),margin_top=.5*chartObj.plotarea.top,margin_bottom=.5*chartObj.plotarea.bottom;switch(orient){case"top":rect.x=-margin_left,rect.y=-axisRect.height-data.tickmark.size,rect.height=axisRect.height+chartObj.plotarea.height+data.tickmark.size,rect.width=axisRect.width+margin_left+margin_right;break;case"right":rect.x=-chartObj.plotarea.width,rect.y=-margin_top,rect.width=axisRect.width+chartObj.plotarea.width+(data.axisline.strokeWidth||1),rect.height=axisRect.height+margin_top+margin_bottom;break;case"bottom":rect.x=-margin_left,rect.y=-chartObj.plotarea.height,rect.height=axisRect.height+chartObj.plotarea.height,rect.width=axisRect.width+margin_left+margin_right;break;case"left":rect.x=-axisRect.width,rect.y=-margin_top,rect.width=axisRect.width+chartObj.plotarea.width+(data.axisline.strokeWidth||1),rect.height=axisRect.height+margin_top+margin_bottom}return clipRect.attrs(rect),id}(chartObj,tickObj,orient,type,axisOrder);g.attr("clip-path","url("+chartObj.defsLocation+"#"+id+")"),tickObj.inlineToPlot&&tickLabelInlineG.attr("clip-path","url("+chartObj.defsLocation+"#"+id+")")}animationDuration=chartObj.axes.animationDuration;var args={tickValues:tickValues,tickFormat:tickFormat,tickSizeInner:tickSizeInner,tickSizeOuter:tickSizeOuter,gridSize:majorTicks,tickPadding:tickPadding,orient:orient,rotation:rotation,scale:scaleObj,chart:chartObj,axis:axisObj};"clr"===type||defined(ticklabeldata.showAs)||isMultiLineTick?(args.renderGrid=!0,args.renderTicklabel=!0,g.call(d3axis,args,data)):(args.renderGrid=!0,args.renderTicklabel=!tickObj.inlineToPlot,g.transition().duration(animationDuration).call(d3axis,args,data),tickObj.inlineToPlot&&(args.renderGrid=!1,args.renderTicklabel=!0,tickLabelInlineG.transition().duration(animationDuration).call(d3axis,args,data)));var tickG0=g.selectAll(".tick"),ticks1=null==tickValues?scaleObj.ticks?scaleObj.ticks.apply(scaleObj,[tickG0.nodes().length]):scaleObj.domain():tickValues,tickG=g.selectAll(".tick").data(ticks1,scaleObj),majorticksUpdate=tickG.select("line.majorTicks"),axisLabel=axisObj.axisLabel,ticklabels=g.selectAll("text.ticklabel").data(ticks1,scaleObj);tickComp.isHierarchialLevelType()&&function(tickG,type,axisOrder){var axisObj=getAxisObject(chartObj,type,axisOrder),axisComp1=axisObj.component,minorTicksNode=tickG.selectAll("line.minorTicks"),ticklabelWidth=function(type,axisOrder){var ticklabelWidth=0;for(;axisOrder>0;){var axisObj=getAxisObject(chartObj,type,axisOrder-1),axisComp1=axisObj.component;ticklabelWidth+=axisComp1.tickLabelWidth(),axisOrder--}return ticklabelWidth}(type,axisOrder);axisObj.ticks.tickValueObj.tickMarkSize=ticklabelWidth+axisComp1.tickSize();var index=axisOrder,key="left"==orient||"right"==orient?"x1":"y1",value="left"==orient||"top"==orient?ticklabelWidth:-ticklabelWidth,nullKey="left"==orient?"y1":"x1";if(index===chartObj.dataObject.hierarchical.finalDepth){"bottom"==orient&&tickmarkdata.size;var ticks=tickG.nodes();tickG.selectAll("line#minorTicksAlign").remove();var endTickG=d3_select(ticks[ticks.length-1]),newEndTickmark=appendEle(endTickG,"line",[1],"#","id","minorTicksAlign"),scaleObj=chartObj.axes.x.levels[index-1].scale,domainLen=scaleObj.domain().length,toTranslate="top"==orient||"bottom"==orient?scaleObj.discreteWidth(domainLen-1)+",0":"0,"+scaleObj.discreteWidth(domainLen-1),key2="left"==orient||"right"==orient?"x2":"y2",value2="left"==orient||"top"==orient?-tickmarkdata.size:tickmarkdata.size;newEndTickmark.attr("transform","translate("+toTranslate+")").attr(key,value).attr(key2,value2),applyStyleForTickmark(tickmarkdata,newEndTickmark)}minorTicksNode.attr(nullKey,null),minorTicksNode.attr(key,value)}(tickG,type,axisOrder);getTickRotateInfo(orient,rotation,0,axisComp,tickmarkdata.size);var columnInfo={data:columnIndices.map(function(d){return mergeJSON(chartObj.systemConf.metadata.columns[d],{columnindex:d},!0)})};if(function(chartObj,ticklabels,ticklabeldata,columnInfo,type,axisOrder){var events_tick=ticklabeldata.events,eventDisabled=null!=events_tick&&0==validateNullVal(events_tick.enabled,!0),mouseHandlerFn={mousemove:events_tick?events_tick.mousemove:null,mouseout:events_tick?events_tick.mouseout:null,click:events_tick?events_tick.click:null,dblclick:events_tick?events_tick.doubleclick:null},touchHandlerFn={tap:events_tick?events_tick.tap:null,tapHold:events_tick?events_tick.taphold:null,tapHoldEnd:events_tick?events_tick.tapholdend:null,dbltap:events_tick?events_tick.doubletap:null};if(!eventDisabled){var mouseHandlers={},touchHandlers={};for(var eventType in mouseHandlerFn){var callback=null;mouseHandlerFn[eventType]?(callback="click"==eventType?function(d,i){defaultTickFilter(columnInfo,d,i,axisOrder,!1,type),invokeFunction(mouseHandlerFn[arguments.callee.eventtype],d3$1.event,getDatawithColumnInfo(columnInfo,d,i,axisOrder),chartObj)}:function(d,i){invokeFunction(mouseHandlerFn[arguments.callee.eventtype],d3$1.event,getDatawithColumnInfo(columnInfo,d,i,axisOrder),chartObj)}).eventtype=eventType:"click"==eventType&&(callback=function(d,i){defaultTickFilter(columnInfo,d,i,axisOrder,!0,type)}),mouseHandlers[eventType]=callback}for(var eventType in touchHandlerFn)callback=null,touchHandlerFn[eventType]?(callback="tap"==eventType?function(d,i){defaultTickFilter(columnInfo,d,i,axisOrder,!1,type),invokeFunction(touchHandlerFn[arguments.callee.eventtype],d3$1.event,getDatawithColumnInfo(columnInfo,d,i,axisOrder),chartObj)}:function(d,i){invokeFunction(touchHandlerFn[arguments.callee.eventtype],d3$1.event,getDatawithColumnInfo(columnInfo,d,i,axisOrder),chartObj)}).eventtype=eventType:"tap"==eventType&&(callback=function(d,i){defaultTickFilter(columnInfo,d,i,axisOrder,!1,type)}),touchHandlers[eventType]=callback;attachevents(ticklabels,mouseHandlers,touchHandlers)}function defaultTickFilter(columnInfo,d,i,axisOrder,useDefault,type){chartObj.dataObject.hierarchical&&chartObj.dataObject.hierarchical.categoryTree&&"x"===type&&invokeFunction(axis.TickLabelFilter,d3$1.event,getDatawithColumnInfo(columnInfo,d,i,axisOrder),chartObj,useDefault)}function getDatawithColumnInfo(columnInfo,d,itemIndex,axisOrder){return columnInfo.data=columnInfo.data.map(function(dt){return dt.value=dt.datatype===TIME_DATATYPE?generateDateVal(d,0,dt.time).getTime():d,dt.itemIndex=itemIndex,dt.levelindex=axisOrder,dt}),columnInfo}}(chartObj,ticklabels,ticklabeldata,columnInfo,type,axisOrder),tickComp.isHierarchialLevelType()||"between"!=tickmarkdata.align||drawTickLinesBetweenTicklabels(scaleObj,tickG,"minorTicks"),"clr"!==type){!0===labeldata.tooltip&&addSVGtitleEle(axisLabel.element),axisLabel.tickObj=tickObj,axisLabel.transformLabel(preCalcTickLen,plotarea,orient);var axisLabelRotation="left"==orient?270:"right"==orient?90:0;handleOverflowTicks(axisLabel.element,orient,chartObj,axisLabelRotation,"ellipsis",scaleObj,g,chart,"axislabel")}if(majorTicks&&griddata.show&&(scaleObj.bandwidth&&"between"==tickmarkdata.align&&drawTickLinesBetweenTicklabels(scaleObj,tickG,"majorTicks"),"clr"!==type)){var range=scaleObj.range(),firstVal=null==chart.tickValues()?null:scaleObj(chart.tickValues()[0])+(scaleObj.bandwidth?scaleObj.bandwidth()/2:0),plotBorderData=chartObj.systemConf.chart.plot.border,plotareaBorderColor=!0===plotBorderData?plotBorderData.color:data.axisline.color;defined(firstVal)&&"transparent"!==griddata.color&&"transparent"!==plotareaBorderColor&&range[0]===firstVal&&d3_select(majorticksUpdate.nodes()[0]).style("stroke","transparent")}var baseLineData=data.baseline;null!=baseLineData&&appendEle(g,"line",!0===baseLineData.show&&scaleObj.domain()[0]<=baseLineData.value&&baseLineData.value<scaleObj.domain()[1]?[1]:[],".","class","zeroBase").attrs({x1:"left"==orient||"right"==orient?0:scaleObj(baseLineData.value),y1:"left"==orient||"right"==orient?scaleObj(baseLineData.value):-plotarea.height,x2:"left"==orient||"right"==orient?plotarea.width:scaleObj(baseLineData.value),y2:"left"==orient||"right"==orient?scaleObj(baseLineData.value):0}).styles({fill:NONE,stroke:baseLineData.color,"shape-rendering":"crispedges","stroke-width":baseLineData.strokeWidth})}),chart}function drawTickLinesBetweenTicklabels(scaleObj,tickG,type){var x1,y1,x2,y2,data,ele,strokeWidth,strokeDashArray,strokeLineCap,ticks=tickG.nodes(),startTickG=d3_select(tickG.node()),lastTickG=d3_select(ticks[ticks.length-1]),tickLineNode=tickG.selectAll("line."+type+":not(#minorTicksAlign)"),lastTickLineNode=lastTickG.selectAll("line."+type),newStartTickLineNode=appendEle(startTickG,"line",[1],"#","id",type+"Align"),adjustDistance=getNewPositionForTickmark(scaleObj);if("minorTicks"==type?(x2="bottom"==orient||"top"==orient?0:-tickmarkdata.size,y2="bottom"==orient?tickmarkdata.size:"top"==orient?-tickmarkdata.size:0,applyStyleForTickmark(tickmarkdata,newStartTickLineNode)):(x1=majorTicks.x1,y1=majorTicks.y1,x2=majorTicks.x2,y2=majorTicks.y2,ele=newStartTickLineNode,strokeWidth=pick((data=griddata).strokeWidth,1),strokeDashArray=getDashArray(data.style,strokeWidth),strokeLineCap=getLineCap(data.lineCap,griddata.style),ele.styles({fill:"none","shape-rendering":"crispedges","stroke-width":strokeWidth,stroke:griddata.color,"stroke-dasharray":strokeDashArray,"stroke-linecap":strokeLineCap})),scaleObj.bandwidth)tickLineNode.attr("transform","translate("+adjustDistance.mid+")"),lastTickLineNode.attr("transform","translate("+adjustDistance.end+")"),newStartTickLineNode.attr("transform","translate("+adjustDistance.start+")").attrs({x1:x1,y1:y1,x2:x2,y2:y2});else{var co=0;tickLineNode.attr("transform",function(d,i){return"translate("+getNewPositionForTickmark(scaleObj,co++).mid+")"}),lastTickLineNode.attr("transform","translate("+adjustDistance.end+")"),newStartTickLineNode.attr("transform","translate("+adjustDistance.start+")").attrs({x1:x1,y1:y1,x2:x2,y2:y2})}}function getNewPositionForTickmark(scaleObj,index){var startPos,midPos,endPos,value_1,value_2;if(scaleObj.bandwidth){var rangeBand=scaleObj.bandwidth(),ordinalRanges=(scaleObj.range(),scaleObj.ordinalRange),outerPadding=scaleObj.outerPaddingPx+rangeBand/2,diffBand=scaleObj.domain().length>1?ordinalRanges[1]-ordinalRanges[0]-rangeBand:0;value_2=mathMin(outerPadding,value_1=rangeBand/2+diffBand/2)}else{var categories=chartObj.dataObject.hierarchical?chartObj.dataObject.hierarchical.leafCategories:chart.tickValues(),continousRangeBand=scale$1.getContinuousRangeBand(scaleObj,categories,index);value_1=rangeBand=continousRangeBand.rangeBand,value_2=continousRangeBand.outerPaddingInPixel}return"bottom"===orient||"top"==orient?(startPos=-(value_2-.5)+",0",midPos=value_1+.5+",0",endPos=value_2+.5+",0"):(startPos="0,"+-value_2,midPos="0,"+value_1,endPos="0,"+value_2),{start:startPos,mid:midPos,end:endPos}}function applyStyleForTickmark(data,ele){ele.styles({fill:"none","shape-rendering":"crispedges","stroke-width":data.strokeWidth,stroke:data.color})}return chart.axis=axisComp,chart.scale=function(_){return arguments.length?(scaleObj=_,axisComp?axisComp.scale(scaleObj):(axisComp=d3_axis(orient,scaleObj)).scale(scaleObj),chart):scaleObj},chart.systemconf=function(_){return arguments.length?(systemconf=_,chart):systemconf},chart.orient=function(_){return arguments.length?(defined(orient)&&(orient!=_?(changeOfOrient=!0,chartObj.container.selectAll("g.plotareaBorder-property").selectAll("*").remove(),axisComp=null):changeOfOrient=!1),orient=_,chart):orient},chart.tickArguments=function(_){return arguments.length?(tickArguments=null==_?[]:Array.prototype.slice.call(_),chart):tickArguments.slice()},chart.tickValues=function(_){return arguments.length?(tickValues=null==_?null:Array.prototype.slice.call(_),chart):tickValues&&tickValues.slice()},chart.tickFormat=function(_){return arguments.length?(tickFormat=_,chart):tickFormat},chart.tickSize=function(_){return arguments.length?(tickSizeInner=tickSizeOuter=+_,chart):tickSizeInner},chart.tickSizeInner=function(_){return arguments.length?(tickSizeInner=+_,chart):tickSizeInner},chart.tickSizeOuter=function(_){return arguments.length?(tickSizeOuter=+_,chart):tickSizeOuter},chart.tickPadding=function(_){return arguments.length?(tickPadding=+_,chart):tickPadding},chart.ticks=function(){return arguments.length?(ticks=arguments,chart):ticks},chart.majorTicks=function(_){return arguments.length?(majorTicks=_,chart):majorTicks},chart.plotarea=function(_){return arguments.length?(plotarea=_,chart):plotarea},chart.tickLabelWidth=function(_){return arguments.length?(tickLabelWidth=_,chart):tickLabelWidth},chart.tickRotation=function(_){return arguments.length?(tickRotation=_,chart):tickRotation},chart.preCalcTickLen=function(_){return arguments.length?(preCalcTickLen=_,chart):preCalcTickLen},chart.chartObj=function(_){return arguments.length?(chartObj=_,chart):chartObj},chart.columnIndices=function(_){return arguments.length?(columnIndices=_,chart):columnIndices},chart.isMultiLineTick=function(_){return arguments.length?(isMultiLineTick=_,chart):isMultiLineTick},chart},axis.TickLabelFilter=function(event,info,chart,isDefault){info=info.data[0],chart.cache.hierarchical||(chart.cache.hierarchical={});var hierarchical=chart.dataObject.hierarchical,itemIndex=info.itemIndex,cache=chart.cache.hierarchical,depth=hierarchical.finalDepth-info.levelindex,currentData=hierarchical.getCategoriesByDepth(depth)[itemIndex],selectedData=DataProcessor.HierarchicalDataAdapter.getAllChildren(currentData),query=axis.TickLabelFilter.getQuery(selectedData[0],depth);cache.lastQuery=query,isDefault&&function(chart,query,active){var pointsSelected,pointsNotSelected,parent=chart.svg.select(".seriesholder"),labels=chart.staticPaneSVG.select("g.labelholder"),cType=chart.chartTypes[0],labelSelected=labels.selectAll('text[level^="'+query+'"],path[level^="'+query+'"]'),labelNotSelected=labels.selectAll('text:not([level^="'+query+'"]), path:not([level^="'+query+'"])');if("bar"===cType.name)pointsSelected=parent.selectAll('path[level^="'+query+'"]'),pointsNotSelected=parent.selectAll('path:not([level^="'+query+'"])');else{if("scatter"!==cType.name&&"bubble"!==cType.name)return;pointsSelected=parent.selectAll('g.scatter[level^="'+query+'"]'),pointsNotSelected=parent.selectAll('g.scatter:not([level^="'+query+'"])')}!0===active?(pointsSelected.style("opacity",1),pointsNotSelected.style("opacity",.1),labelSelected.style("opacity",1),labelNotSelected.style("opacity",.1)):(pointsSelected.style("opacity",1),pointsNotSelected.style("opacity",1),labelSelected.style("opacity",1),labelNotSelected.style("opacity",1))}(chart,query,cache.query!==query),cache.query===query?(isArray(cache.data)&&axis.TickLabelFilter.setState(cache.data,!1),cache.data=cache.query=cache.active=cache.depth=cache.itemIndex=cache.isLeaf=null):(isArray(cache.data)&&axis.TickLabelFilter.setState(cache.data,!1),axis.TickLabelFilter.setState(selectedData,!0),cache.query=query,cache.data=selectedData,cache.active=!0,cache.depth=depth,cache.itemIndex=itemIndex,cache.isLeaf=currentData.leaf)},axis.TickLabelFilter.setState=function(data,isActive){data.forEach(function(point){point.active=isActive})},axis.TickLabelFilter.updateTickEventHandler=function(chart,onDisable){var cache=chart.cache.hierarchical,onVisible=!onDisable;if(defined(cache)&&defined(cache.data)){var firstPoint,hierarchical=chart.dataObject.hierarchical;if(cache.data){var visiblePoints=cache.data.filter(function(point){return!point.seriesDisabled});if(onDisable&&(visiblePoints.length?cache.query=axis.TickLabelFilter.getQuery(visiblePoints[0],cache.depth):cache.query="-1"),onVisible){var indexes=(firstPoint=visiblePoints[0]).level.split("_").slice(0,cache.depth+1).map(Number),parent=hierarchical.getCategoriesByLevelIndices(indexes),data=DataProcessor.HierarchicalDataAdapter.getAllChildren(parent);cache.query=axis.TickLabelFilter.getQuery(firstPoint,cache.depth),cache.data=data,axis.TickLabelFilter.setState(data,!0)}}}},axis.TickLabelFilter.getQuery=function(point,depth){return point.level.split("_").slice(0,depth+1).map(Number).slice(0,depth+1).join("_")+"_"};var dialUtils=function(){};dialUtils.getValueWithinRange=function(value,range){return mathMin(mathMax(value,range[0]),range[1])},dialUtils.getNeedlePolygon=function(needleConf,plotarea_approx,innerRadius){var wid=pick(needleConf.width/2,7),IR=-perToPx(needleConf.innerRadius,plotarea_approx.radius,0),OR=-perToPx(needleConf.radius,plotarea_approx.radius,innerRadius)+needleConf.padding;switch(OR=mathMin(OR,-3*wid),needleConf.type){case"clock":return"M"+wid+" "+IR+" A"+wid+" "+wid+" 0 0 1 "+-wid+" "+IR+" A"+wid+" "+wid+" 0 0 1 "+wid+" "+IR+" M0 "+(IR-wid)+" L0 "+OR+" M"+-wid+" "+(wid+OR)+" L0 "+OR+" L"+wid+" "+(wid+OR)+" L0 "+OR;case"sharp":return"M"+wid+" "+IR+" L0 "+(IR+wid)+" L"+-wid+" "+IR+" L0 "+OR+" L"+wid+" "+IR;default:return"M"+wid+" "+IR+" A"+wid+" "+wid+" 0 0 1 "+-wid+" "+IR+" L0 "+OR+" L"+wid+" "+IR}},dialUtils.createLevelsNColors=function(data,levelMarkerConf,color,minMax){var levels=[],levelmarkerClr=[],dt=data[0].data[0],origValues=dt[0][levelMarkerConf.dataindex]||levelMarkerConf.values||[],clr=levelMarkerConf.color;if(origValues instanceof Array||(origValues=[origValues]),void 0===clr&&origValues.length<=1&&(clr=["#d1d1d1"]),origValues.length>0){var thValues=origValues.slice(0);if(!clr)var monoClrGen=getMonochromeColor(color[0],[0,thValues.length-1],[levelMarkerConf.colorGamma[0],levelMarkerConf.colorGamma[1]]);thValues.sort(d3_ascending);var prev=minMax[0];thValues.forEach(function(d,i){var thIdx=origValues.indexOf(d),currentValue=dialUtils.getValueWithinRange(d,minMax),nextValue=dialUtils.getValueWithinRange(defined(thValues[i+1])?thValues[i+1]:0,minMax);levels[i]=currentValue<0?[currentValue,nextValue]:[prev,currentValue],levelmarkerClr[i]=clr?clr[thIdx]:monoClrGen(i),prev=currentValue<0?nextValue:currentValue})}else dt.forEach(function(d,i){levels[i]=minMax,levelmarkerClr[i]=(clr instanceof Array?clr[i]:clr)||"#d1d1d1"});return{values:levels,colors:levelmarkerClr}},axis.polar=function(){var scaleObj,chartObj,radius,columnIndices,tickFormat,tickValues,columnInfo;function axis_polar(g){g.each(function(data){var mousemoveFn,mouseoutFn,clickFn,dblclickFn,cursor,eventDisabled,g=d3_select(this),systemconf=chartObj.systemConf,axisline=data.axisline,tickmark=data.tickmark,subtickmark=data.subtickmark||{},grid=data.grid,ticklabel=data.ticklabel,events_tick=ticklabel.events;null!=events_tick&&(eventDisabled=0==validateNullVal(events_tick.enabled,!0),mousemoveFn=events_tick.mousemove,mouseoutFn=events_tick.mouseout,clickFn=events_tick.click,dblclickFn=events_tick.doubleclick,cursor=events_tick.cursor);var tickOrient=data.tickOrient,axislineSize=axisline.show?validateNullVal(axisline.strokeWidth,1):0,gridSize=validateNullVal(grid.strokeWidth,1),ticklabelPad=validateNullVal(ticklabel.marginLeft,5),tickmarkSize=validateNullVal(tickmark.size,3),subtickmarkSize=validateNullVal(subtickmark.size,2),subticksCount=+subtickmark.count||0,ticks=tickValues||(scaleObj.ticks?scaleObj.ticks():scaleObj.domain()),subticks=function(scaleObj,ticks,m){if(subticks=[],m&&ticks.length>1){for(var subticks,j,v,extent=(domain=scaleObj.domain(),start=domain[0],stop=domain[domain.length-1],start<stop?[start,stop]:[stop,start]),i=-1,n=ticks.length,d=(ticks[1]-ticks[0])/++m;++i<n;)for(j=m;--j>0;)(v=+ticks[i]-j*d)>=extent[0]&&subticks.push(v);for(--i,j=0;++j<m&&(v=+ticks[i]+j*d)<extent[1];)subticks.push(v)}var domain,start,stop;return subticks}(scaleObj,ticks,subticksCount),range=scaleObj.range(),subticksGroup=appendEle(g,"g",[1],".","class","subticksGroup");subticksGroup.style("stroke",subtickmark.color);var subtick=appendEle(subticksGroup,LINE_ELEMENT,subticks),tick=appendEle(appendEle(g,"g",[1],".","class","ticksGroup"),"g",ticks,".","class","tick");appendEle(g,PATH_ELEMENT,axisline.show?[1]:[],".","class","domain").attr("d",function(){return"M"+d3_arc().innerRadius(radius-1).outerRadius(radius).startAngle(range[0]).endAngle(range[1])(1).split(/L|M/gi)[1]}).styles({stroke:axisline.color,fill:NONE,"stroke-width":axislineSize,"stroke-dasharray":getDashArray(axisline.style,axislineSize),"stroke-linecap":getLineCap(axisline.lineCap,axisline.style),"pointer-events":NONE}),appendEle(tick,LINE_ELEMENT,[1],".","class","tickmark"),appendEle(tick,LINE_ELEMENT,[1],".","class","grid"),appendEle(tick,TEXT_ELEMENT,[1],".","class","ticklabel");var text=tick.select(TEXT_ELEMENT+".ticklabel"),line=tick.select(LINE_ELEMENT+".tickmark"),gridLine=tick.select(LINE_ELEMENT+".grid");text.style("cursor",cursor||POINTER).style("pointer-events",eventDisabled?NONE:NULL).attr("index",function(d,i){return i}).text(function(d){return tickFormat(d)}),applyFont(text,[ticklabel,systemconf.chart,systemconf.canvas,$ZCG]),columnInfo={data:columnIndices.map(function(d){return mergeJSON(chartObj.systemConf.metadata.columns[d],{columnindex:d},!0)})};var tickRad,textRad,tickmarkRad,subtickmarkRad,mousemove=function(d){callback(mousemoveFn,d3$1.event,d)},mouseout=function(d){callback(mouseoutFn,d3$1.event,d)},click=function(d){callback(clickFn,d3$1.event,d)},dblclick=function(d){callback(dblclickFn,d3$1.event,d)};switch(attachevents(text,{mousemove:mousemove,mouseout:mouseout,click:click,dblclick:dblclick},{singletouchmove:mousemove,touchend:mouseout,tap:click,dbltap:dblclick}),tickOrient){case INNER_ALIGN:tickRad=radius-axislineSize/2,textRad=-(tickmarkSize+ticklabelPad),tickmarkRad=-tickmarkSize,subtickmarkRad=-subtickmarkSize;break;default:tickRad=radius+axislineSize/2,textRad=tickmarkSize+ticklabelPad,tickmarkRad=tickmarkSize,subtickmarkRad=subtickmarkSize}tick.attr("transform",function(d){var xy=polarToXY(tickRad,scaleObj(d));return"translate("+xy[0]+","+xy[1]+")"}),text.attrs({dy:function(d){var a=d0_360(scaleObj(d));return tickOrient==INNER_ALIGN?a>mathPI/2&&a<3*mathPI/2?null:-getDY(a)+"em":a>mathPI/2&&a<3*mathPI/2?getDY(a)+"em":null},"text-anchor":function(d){var a=d0_360(scaleObj(d));return a%mathPI==0?"middle":tickOrient==INNER_ALIGN&&a<mathPI||tickOrient!=INNER_ALIGN&&a>mathPI?"end":null},transform:function(d){var xy=polarToXY(textRad,scaleObj(d));return"translate("+xy[0]+","+xy[1]+")"}}),line.attrs({x2:function(d){return polarToXY(tickmarkRad,scaleObj(d))[0]},y2:function(d){return polarToXY(tickmarkRad,scaleObj(d))[1]}}).styles({stroke:tickmark.color,"stroke-width":tickmark.strokeWidth}),gridLine.attrs({x2:function(d){return polarToXY(-radius,scaleObj(d))[0]},y2:function(d){return polarToXY(-radius,scaleObj(d))[1]}}).styles({stroke:grid.color,"stroke-width":gridSize,"stroke-dasharray":getDashArray(grid.style,gridSize),"stroke-linecap":getLineCap(grid.lineCap,grid.style)}),subtick.attrs({x2:function(d){return polarToXY(subtickmarkRad,scaleObj(d))[0]},y2:function(d){return polarToXY(subtickmarkRad,scaleObj(d))[1]},transform:function(d){var xy=polarToXY(tickRad,scaleObj(d));return"translate("+xy[0]+","+xy[1]+")"}})})}return axis_polar.scale=function(x){return arguments.length?(scaleObj=x,axis_polar):scaleObj},axis_polar.chartObj=function(x){return arguments.length?(chartObj=x,axis_polar):chartObj},axis_polar.radius=function(x){return arguments.length?(radius=x,axis_polar):radius},axis_polar.columnIndices=function(_){return arguments.length?(columnIndices=_,axis_polar):columnIndices},axis_polar.tickValues=function(_){return arguments.length?(tickValues=_,axis_polar):tickValues},axis_polar.tickFormat=function(_){return arguments.length?(tickFormat=_,axis_polar):tickFormat},axis_polar;function callback(func,e,d){null!=func&&(columnInfo.data=columnInfo.data.map(function(dt){return dt.value=d,dt}),invokeFunction(func,e,columnInfo,chartObj))}},axis.polar.render=function(chartObj,type){type=type||"y";var systemconf=chartObj.systemConf,renderer=chartObj.renderer[0],dataObj=chartObj.dataObject,plotarea=chartObj.plotarea,canvasarea=chartObj.canvasarea,columns=chartObj.systemConf.metadata.columns,chart=chartObj.chartTypes[0],cType=chart.value,chartName=chart.name,commonPlotOptions=systemconf.chart.plot.plotoptions[chartName],axis_data="x"==type?systemconf.chart.axes.xaxis:systemconf.chart.axes.yaxis[0],outerPadding=+commonPlotOptions.outerPadding||0,maxRadius=+commonPlotOptions.maxRadius||0,isDial=cType===charttype.dial,show=axis_data.show&&dimension_based_intelligence(chartObj,type+"axis",mathMin(canvasarea.width,canvasarea.height)),axislineSize=show&&axis_data.axisline.show?validateNullVal(axis_data.axisline.strokeWidth,1):0,ticklabelPad=validateNullVal(axis_data.ticklabel.marginLeft,5),tickmarkSize=validateNullVal(axis_data.tickmark.size,3),subtickmarkSize=axis_data.subtickmark?validateNullVal(axis_data.subtickmark.size,2):0,ticklabelFontsize=utils.getVal(axis_data.ticklabel.fontSize||systemconf.chart.fontSize||systemconf.canvas.fontSize||$ZCG.fontSize),orient=axis_data.orient||OUTER_ALIGN,tickOrient=axis_data.tickOrient,w=plotarea.width-2*outerPadding,h=plotarea.height-2*outerPadding,radius=mathMin(w,h)/2,innerRadius=getInnerRadius(commonPlotOptions,radius),padding=show&&+commonPlotOptions.padding||0;chartObj.plotarea_approx={x:0,y:0,innerRadius:innerRadius};var scaleObj=(sc=scale$1.constructor(chartObj,"x"==type?BOTTOM_ALIGN:LEFT_ALIGN))[0].scale,range=scaleObj.range(),colInfo=columns[columnidx=chartObj.dataset.getColumnIdx(type,0)],datatype=colInfo.datatype,formatConf=colInfo[datatype],axisRadius=orient==INNER_ALIGN?tickOrient===OUTER_ALIGN?innerRadius-padding-axislineSize/2-mathMax(subtickmarkSize,tickmarkSize+ticklabelPad+ticklabelFontsize):innerRadius:radius,axisComponent=axis.polar().scale(scaleObj).chartObj(chartObj).radius(axisRadius).columnIndices([columnidx]).tickFormat(function(d){return getFormattedValue(formatConf,d,datatype,chartObj,"axis")}).tickValues(null),container=appendEle(chartObj.svg.selectAll("g.chartgroup"),"g",[1],".","class",type+"-axis"),wrap=appendEle(container,"g",show?[axis_data]:[],".","class","axisgroup");wrap.call(axisComponent),container.style("visibility","hidden");var arc=d3_arc().innerRadius(!isDial||commonPlotOptions.needle.show||chartObj.datalabels.moduleExists&&isDatalabelEnabled(commonPlotOptions.datalabels,chartObj)?0:innerRadius).outerRadius(radius).startAngle(range[0]).endAngle(range[1]),dummyArc=appendEle(container,PATH_ELEMENT,[1],".","class","dummyArc").attr("d",arc(1)),datalabel=appendEle(container,"g",[1],".","class","datalabel"),targetMarkerSeries=appendEle(container,"g",[1],".","class","targetSeries");if(isDial){if(!renderer){renderer=chartObj.renderer[0]=createSVGRenderer(chartName),chartObj.rendererConf=[],chartObj.rendererConf[0]=new plot.rendererConf,renderer_helpers.setRendererProp(chartObj,renderer,chartObj.seriesdata[0],0,0,[])}renderer.firedList={},labelRenderer&&datalabel.call(labelRenderer.dial().renderer(renderer).args([chartObj.seriesdata,0]),chartObj.labelHandler,datalabel),drawMinMaxLabel(container,scaleObj,radius,innerRadius),dialUtils.targetMarker(targetMarkerSeries,radius,innerRadius,chartObj);var needleWidth=+commonPlotOptions.needle.width/2||7;appendEle(datalabel,"circle",commonPlotOptions.needle.show?[1]:[]).attrs({r:needleWidth,transform:"translate("+needleWidth+","+needleWidth+")"})}var arcBound=bbox(dummyArc.node()),bb=bbox(container.node()),heightPercent=arcBound.height/radius,widthPercent=arcBound.width/radius,newradius=radius+mathMin((w-bb.width)/widthPercent,(h-bb.height)/heightPercent),firedList={};if(isDial){firedList=function(){var firedList={};return fireElement(firedList,"axisgroup"),fireElement(firedList,"minmaxlabels"),fireElement(firedList,"targetSeries"),renderer.firedList=firedList}(),bb=bbox(container.node());newradius=(newradius=radius+mathMin((w-bb.width)/widthPercent,(h-bb.height)/heightPercent))>maxRadius?maxRadius:newradius,newradius=isFinite(newradius)&&newradius>0?newradius:0}innerRadius=getInnerRadius(commonPlotOptions,newradius)-(orient==INNER_ALIGN?(+commonPlotOptions.strokeWidth||0)/2:0),axisRadius=(orient==INNER_ALIGN?tickOrient==INNER_ALIGN?innerRadius:innerRadius-(getMinRadius(radius)-radius):newradius)-(tickOrient==INNER_ALIGN?axislineSize/2:0)-(orient==INNER_ALIGN?padding:0),axisComponent.radius(axisRadius),!firedList.axisgroup&&wrap.call(axisComponent),arc.outerRadius(newradius).innerRadius(!isDial||commonPlotOptions.needle.show||chartObj.datalabels.moduleExists&&isDatalabelEnabled(commonPlotOptions.datalabels,chartObj)?0:innerRadius),dummyArc.attr("d",arc(1)),isDial&&(!firedList.minmaxlabels&&drawMinMaxLabel(container,scaleObj,newradius,innerRadius),dialUtils.targetMarker(targetMarkerSeries,newradius,innerRadius,chartObj));arcBound=bbox(dummyArc.node());var pt=polarRefPoint(bb=bbox(container.node()),plotarea.width,plotarea.height,newradius,0);container.attr("transform","translate("+(plotarea.left+pt[0])+","+(plotarea.top+pt[1])+")"),container.style("visibility",null);var arcRad=(tickOrient==INNER_ALIGN&&orient==OUTER_ALIGN?getMinRadius(newradius):newradius-(orient==INNER_ALIGN?0:axislineSize/2))-(orient==INNER_ALIGN?0:padding),dwidth=tickOrient==INNER_ALIGN?(newradius-arcRad)*widthPercent:0,dheight=tickOrient==INNER_ALIGN?(newradius-arcRad)*heightPercent:0;if(chartObj.plotarea_approx={x:pt[0],y:pt[1],width:arcBound.width-axislineSize-dwidth,height:arcBound.height-axislineSize-dheight,radius:arcRad,actualRadius:newradius,innerRadius:innerRadius},dummyArc.remove(),datalabel.remove(),targetMarkerSeries.remove(),dataObj.isPolarAxisCategory){type="y";var sc,yaxis_data=systemconf.chart.axes.yaxis[0],x=(radius=chartObj.plotarea_approx.radius,chartObj.plotarea_approx.x),y=chartObj.plotarea_approx.y,tickSize=(orient=yaxis_data.orient||RIGHT_ALIGN,validateNullVal(yaxis_data.tickmark.size,6)),tickPadding=validateNullVal(yaxis_data.ticklabel[orient==LEFT_ALIGN?"marginRight":"marginLeft"],3),isArcGrid="arc"===yaxis_data.grid.type,yscale=(sc=scale$1.constructor(chartObj,LEFT_ALIGN))[0].scale,yRange=yaxis_data.reversed&&!dataObj.isstacked()?[0,radius]:[radius,0];yscale.origRange=yRange,yscale.range(yRange);var plotarea_approx={left:chartObj.plotarea.left,top:chartObj.plotarea.top,width:radius,height:radius},axes=getAxisObject(chartObj,type,0),ticksObj=axis.ticks(chartObj,yaxis_data,"y",0,orient,plotarea_approx);axes.ticks=ticksObj,ticksObj.preCalcApproxAxisLength(plotarea_approx);var tickVal=ticksObj.getTickValues(radius,radius,null,null,radius/20,axes.Ticks),metaData=chartObj.userdata.metadata,isMergedAxis=metaData.axes.y[0].length>1,columnidx=chartObj.dataset.getColumnIdx(type,0),formattingFunction=(datatype=metaData.columns[columnidx].datatype,formatConf=isMergedAxis&&"y"==type?merged_axis_column_intersect(0,chartObj):metaData.columns[columnidx][datatype],dataObj.isStackedPercentChart&&"y"==type?getFormattedValueByPercent:getFormattedValue),axisObj=axis.get().orient(orient).scale(yscale).tickPadding(tickPadding).tickSize(tickSize,0).plotarea({width:radius,height:radius}).systemconf(chartObj.systemConf).chartObj(chartObj).tickRotation(tickVal.rotation).preCalcTickLen(ticksObj.preCalcTickLen).tickValues(tickVal.ticks).tickFormat(function(d){var formattedValue=formattingFunction(formatConf,d,datatype,chartObj,"axis");d3$1.select(this).text(formattedValue)}).columnIndices(isMergedAxis&&"y"==type?metaData.axes.y[0]:[columnidx]),yWrap=chartObj.svg.selectAll("g.y-axis").data(yaxis_data.show?[yaxis_data]:[]);yWrap.call(axisObj,type,0).attr("transform","translate("+(x+chartObj.plotarea.left)+","+(y+chartObj.plotarea.top-radius)+")"),yWrap.exit().remove();var ticks=yWrap.selectAll(".tick");ticks.append(PATH_ELEMENT),ticks.select(PATH_ELEMENT).attr("transform",function(d){return"translate(0,"+(radius-yscale(d))+")"}).attr("d",function(d){return grid(radius-yscale(d),scaleObj)}).styles({fill:NONE,stroke:yaxis_data.grid.color,"stroke-width":yaxis_data.grid.strokeWidth}),wrap.selectAll(PATH_ELEMENT+".domain").attr("d",function(){return grid(radius,scaleObj)}),yscale.range(yRange.reverse()),sc[0].eventscale=yscale}function getMinRadius(rad){var a=[],subtickRad=rad+((orient==OUTER_ALIGN?axislineSize:axislineSize/2)+subtickmarkSize*(tickOrient==INNER_ALIGN?-1:1)),func=tickOrient==INNER_ALIGN?d3_min:d3_max;return wrap.selectAll(TEXT_ELEMENT).each(function(d){var bb=bbox(this),xy=polarToXY(rad+((orient==OUTER_ALIGN?axislineSize:axislineSize/2)+tickmarkSize+ticklabelPad)*(tickOrient==INNER_ALIGN?-1:1),scale$1(d)),arr=[getRad(xy[0]+bb.x,xy[1]+bb.y),getRad(xy[0]+bb.x,xy[1]+bb.y+bb.height),getRad(xy[0]+bb.x+bb.width,xy[1]+bb.y),getRad(xy[0]+bb.x+bb.width,xy[1]+bb.y+bb.height),subtickRad];a.push(func(arr))}),func(a)}function getRad(x,y){return mathSQRT(mathPow(x,2)+mathPow(y,2))}function grid(r,scaleObj){return isArcGrid?"M"+d3_arc().innerRadius(r-1).outerRadius(r).startAngle(range[0]).endAngle(range[1])(1).split(/L|M/gi)[1]:"M"+(scaleObj.ticks?scaleObj.ticks():scaleObj.domain()).reduce(function(prev,cur,i){var a=scaleObj(cur),xy=polarToXY(r,a);return prev+"L"+xy[0]+" "+xy[1]+" "},"").substring(1)+"Z"}function drawMinMaxLabel(container,scaleObj,radius,innerRadius){var mmConf=commonPlotOptions.minmaxlabels,align=mmConf.align,padding=validateNullVal(mmConf.padding,5),text=mmConf.text,domain=scaleObj.domain(),showAs=mmConf.showAs,r=align==INNER_ALIGN?innerRadius-padding:"center"==align?(radius+innerRadius)/2:radius+padding,minmaxLabelData=mmConf.show?"min"==showAs?[domain[0]]:"max"==showAs?[domain[1]]:domain:[],minmaxLabel=appendEle(container,TEXT_ELEMENT,minmaxLabelData,".","class","minmaxlabels");applyFont(minmaxLabel,[mmConf,systemconf.chart,systemconf.canvas,$ZCG]),minmaxLabel.attrs({"text-anchor":function(d){if("center"==align)return"middle";var a=d0_360(scaleObj(d));return a%mathPI==0?"middle":align==INNER_ALIGN&&a<mathPI||align!=INNER_ALIGN&&a>mathPI?"end":null},dy:function(d){if("center"==align)return"1em";var a=d0_360(scaleObj(d));return align==INNER_ALIGN?a>mathPI/2&&a<3*mathPI/2?null:-getDY(a)+"em":a>mathPI/2&&a<3*mathPI/2?getDY(a)+"em":null},transform:function(d){var xy=polarToXY(r,scaleObj(d)),pad="center"==align?padding:0;return"translate("+xy[0]+","+(xy[1]+pad)+")"}}).text(function(d,i){return text&&defined(text[i])?getCustomThresholdText(text[i]+"",minmaxLabelData,colInfo,chartObj):getFormattedValue(formatConf,d,datatype,chartObj,"minmaxlabels")})}function fireElement(firedList,type){var selector=[".targetSeries",".datalabel",".minmaxlabels",".axisgroup"].filter(function(d){return d!=="."+type}).join();container.selectAll(selector).style("display",NONE);var bb_axis=bbox(container.node()),newradius=radius+mathMin((w-bb_axis.width)/widthPercent,(h-bb_axis.height)/heightPercent),maxWidth=perToPx("minmaxlabels"===type?commonPlotOptions.minmaxlabels.maxWidth:null,radius,perToPx("50%",radius));(newradius<radius-maxWidth||radius<=0||!isFinite(newradius))&&(firedList[type]=!0,container.selectAll("."+type).remove()),container.selectAll(selector).style("display",null)}};axis.polar.render;var hexToRGB=legend_helpers.hexToRGB;function getChartTypeSymbol(chartName){return function(size){switch(chartName){case BAR_CHARTNAME:case GANTT_CHARTNAME:case BULLET_CHARTNAME:case WATERFALL_CHARTNAME:return"M"+.5*-size+" "+.5*size+" L"+.5*-size+" "+.2*-size+" L"+.25*-size+" "+.2*-size+" L"+.25*-size+" "+.5*size+"Z  M"+.125*-size+" "+.5*size+" L"+.125*-size+" "+.5*-size+" L"+.125*size+" "+.5*-size+" L"+.125*size+" "+.5*size+"Z  M"+.25*size+" "+.5*size+" L"+.25*size+" "+.1*size+" L"+.5*size+" "+.1*size+" L"+.5*size+" "+.5*size+"Z";case AREA_CHARTNAME:case AREARANGE_CHARTNAME:return"M"+.5*-size+" "+.5*size+" L"+.5*-size+" "+.28*size+" L"+.24*-size+" "+.08*size+" L"+.13*-size+" "+.19*size+" L"+.07*size+" "+.14*-size+" L"+.23*size+" "+.012*size+" L"+.5*size+" "+.5*-size+" L"+.5*size+" "+.5*size+"Z";case PIE_CHARTNAME:case BUBBLEPIE_CHARTNAME:case SUNBURST_CHARTNAME:case GEOBUBBLEPIE_CHARTNAME:return"M"+.045*size+" "+.045*-size+" L"+.5*size+" "+.045*-size+" A "+.455*size+" "+.455*size+" 0 0 0 "+.045*size+" "+.5*-size+"Z M"+.045*-size+" "+.045*size+" L"+.045*-size+" "+.41*-size+" A "+.455*size+" "+.455*size+" 1 1 0 "+.41*size+" "+.045*size+"Z";case FUNNEL_CHARTNAME:return"M"+.5*-size+" "+.5*-size+" L "+.5*size+" "+.5*-size+" L "+.15*size+" "+.2*size+" L "+.15*size+" "+.5*size+" L "+.15*-size+" "+.5*size+" L "+.15*-size+" "+.2*size+"Z";case PYRAMID_CHARTNAME:return"M0 "+.5*-size+" L"+.23*size+" "+.06*-size+" L"+.23*-size+" "+.06*-size+"Z M"+.5*-size+" "+.5*size+" L"+.5*size+" "+.5*size+" L"+.27*size+" 0 L"+.27*-size+" 0Z";case WEB_CHARTNAME:return getSVGsymbol("line")(size);case TREEMAP_CHARTNAME:return getSVGsymbol("square")(size);case SCATTER_CHARTNAME:case GEOSCATTER_CHARTNAME:case BUBBLE_CHARTNAME:case GEOBUBBLE_CHARTNAME:case PACKEDBUBBLE_CHARTNAME:case LINE_CHARTNAME:default:return getSVGsymbol(chartName)(size)}}}function getMarkerProperties(markerOptions,width,height,color,markerType,size,gradientFill){return"<path d='"+getChartTypeSymbol(markerOptions.symbol)(size)+"' transform='translate("+width/2+","+height/2+")' style='"+("stroke:"+hexToRGB(markerOptions[markerType?markerType+"StrokeColor":"strokeColor"]||color)+";stroke-width:"+validateNullVal(markerOptions[markerType?markerType+"StrokeWidth":"strokeWidth"],1)+";stroke-opacity:"+validateNullVal(markerOptions[markerType?markerType+"StrokeOpacity":"strokeOpacity"],1)+";fill:"+(gradientFill||hexToRGB(markerOptions[markerType?markerType+"FillColor":"fillColor"]||color))+";fill-opacity:"+validateNullVal(markerOptions[markerType?markerType+"FillOpacity":"fillOpacity"],1)+";")+"'></path>"}function getGradientProperties(plotOptions,commonPlotOptions,width,height,color,chartObj,chartName){var fill,gradientOptions=plotOptions&&plotOptions.gradients?mergeJSON(commonPlotOptions.gradients||{},plotOptions.gradients,!0):commonPlotOptions.gradients||{},defs="",patternSvg=chartObj.getPatternSvg();if("linear"===gradientOptions.type||"radial"===gradientOptions.type){var prop=getGradientProp(gradientOptions,[width,height],color,1),args={offset:chartName,chartObj:chartObj},gradientID=effects.get(effects.svg_gradients,"svgGradientFill",prop,args),h=(new XMLSerializer).serializeToString(patternSvg.select("#"+gradientID).node());defs="<defs>"+(h=h.replace(/"/g,"'"))+"</defs>",fill="url("+($Browser.IE?"#":"%23")+gradientID+")"}return{defs:defs,fill:fill}}legend.getHTML4ChartTypeSymbol=function(width,height,fillColor,chartObj,index){var isQuantileColorScale=colorscale_helpers.isQuantileColorScale(chartObj),seriesIndex=(chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory||chartObj.dataObject.isHierarchy||chartObj.isGeoMap)&&!isQuantileColorScale?index:0,chartName=chartObj.chartTypes[seriesIndex].name,commonPlotOptions=chartObj.systemConf.chart.plot.plotoptions[chartName],plotOptions=isQuantileColorScale?NULL:chartObj.seriesdata[seriesIndex].plotoptions,symbolpath=getChartTypeSymbol(chartName)(width);switch(chartName){case LINE_CHARTNAME:case WEB_CHARTNAME:var strokeWidth=.15*height,markerOptions=plotOptions&&plotOptions.marker?mergeJSON(commonPlotOptions.marker,plotOptions.marker,!0):commonPlotOptions.marker,dashProperties=function(plotOptions,commonPlotOptions,strokeWidth){var styles,dashStyle=getValByPriority([plotOptions,commonPlotOptions],"dashStyle"),dashArray=getDashArray(dashStyle,.75*strokeWidth);if(dashArray&&dashArray.length){var strokeLineCap=getLineCap(getValByPriority([plotOptions,commonPlotOptions],"lineCap"),dashStyle);styles="stroke-dasharray:"+dashArray+";stroke-linecap:"+strokeLineCap+";"}return styles}(plotOptions,commonPlotOptions,strokeWidth),markerProperties="",styles="stroke:"+fillColor+";stroke-width:"+strokeWidth+";";if(dashProperties)styles+=dashProperties;else if(0!=markerOptions.enabled){var outerRatio=chartName===WEB_CHARTNAME?.5:.65,innerRatio=chartName===WEB_CHARTNAME?.25:.45;markerProperties=getMarkerProperties(markerOptions,width,height,fillColor,"outer",mathMin(width,height)*outerRatio),markerProperties+=getMarkerProperties(markerOptions,width,height,fillColor,"inner",mathMin(width,height)*innerRatio)}return"<path d='"+symbolpath+"' transform='translate("+width/2+","+height/2+")' style='"+styles+"'></path>"+markerProperties;case SCATTER_CHARTNAME:case BUBBLE_CHARTNAME:case GEOBUBBLE_CHARTNAME:case GEOSCATTER_CHARTNAME:if((markerOptions=plotOptions&&plotOptions.marker?mergeJSON(commonPlotOptions.marker,plotOptions.marker,!0):commonPlotOptions.marker).imageUrl)return markerOptions.imageUrl;var outerSize=mathMin(width,height)-validateNullVal(markerOptions.outerStrokeWidth,1),innerSize=.5*mathMin(width,height)-validateNullVal(markerOptions.innerStrokeWidth,1),outerGradientProperties=getGradientProperties(plotOptions,commonPlotOptions,outerSize,outerSize,markerOptions.outerFillColor||fillColor,chartObj,chartName),innerGradientProperties=getGradientProperties(plotOptions,commonPlotOptions,innerSize,innerSize,markerOptions.innerFillColor||fillColor,chartObj,chartName);return outerGradientProperties.defs+getMarkerProperties(markerOptions,width,height,fillColor,"outer",outerSize,outerGradientProperties.fill)+innerGradientProperties.defs+getMarkerProperties(markerOptions,width,height,fillColor,"inner",innerSize,innerGradientProperties.fill);case PACKEDBUBBLE_CHARTNAME:return(gradientProperties=getGradientProperties(plotOptions,commonPlotOptions,size=mathMin(width,height)-validateNullVal(commonPlotOptions.strokeWidth,1),size,fillColor,chartObj,chartName)).defs+getMarkerProperties(commonPlotOptions,width,height,fillColor,null,size,gradientProperties.fill);case HEATMAP_CHARTNAME:var size;if(commonPlotOptions.symbol&&getSVGsymbol(commonPlotOptions.symbol))return(gradientProperties=getGradientProperties(plotOptions,commonPlotOptions,size=mathMin(width,height)-validateNullVal(commonPlotOptions.strokeWidth,1),size,fillColor,chartObj,chartName)).defs+getMarkerProperties(commonPlotOptions,width,height,fillColor,null,size,gradientProperties.fill);var w=width-(strokeWidth=validateNullVal(commonPlotOptions.strokeWidth,1)),h=height-strokeWidth;return(gradientProperties=getGradientProperties(plotOptions,commonPlotOptions,w,h,fillColor,chartObj,chartName)).defs+function(commonPlotOptions,width,height,color,chartObj,gradientFill){var borderRadius=commonPlotOptions.borderRadius;borderRadius&&(borderRadius=mathMin(mathMin(width,height)/4,borderRadius));var path=roundedRect(-width/2,-height/2,width,height,chartObj.dataObject.getTransRectValue("radius",null,null,null,null,borderRadius)),styles="stroke:"+hexToRGB(commonPlotOptions.strokeColor||color)+";stroke-width:"+validateNullVal(commonPlotOptions.strokeWidth,1)+";stroke-opacity:"+validateNullVal(commonPlotOptions.strokeOpacity,1)+";fill:"+(gradientFill||hexToRGB(commonPlotOptions.fillColor||color))+";fill-opacity:"+validateNullVal(commonPlotOptions.fillOpacity,1)+";";return"<path d='"+path+"' transform='translate("+width/2+","+height/2+")' style='"+styles+"'></path>"}(commonPlotOptions,w,h,fillColor,chartObj,gradientProperties.fill);default:var gradientProperties=getGradientProperties(plotOptions,commonPlotOptions,width,height,fillColor,chartObj,chartName),fillOpacity=pick(plotOptions&&plotOptions.fillOpacity,commonPlotOptions.fillOpacity,1);styles="fill:"+(gradientProperties.fill||fillColor)+";fill-opacity:"+fillOpacity+";";return gradientProperties.defs+"<path d='"+symbolpath+"' transform='translate("+width/2+","+height/2+")' style='"+styles+"'></path>"}};var getClr=legend_helpers.getClr,isDisabled=legend_helpers.isDisabled,hexToRGB$1=legend_helpers.hexToRGB;function isImageUrl(str){return str&&!("<"===str[0]||0===str.indexOf('url("data'))}function getHTML4SVGSymbol(width,height,strokeColor,fillColor,symbol,colorBoxOptions){var symbolpath=getSVGsymbol(symbol||"square")(10),hexToRGB=legend_helpers.hexToRGB;return"<path d='"+symbolpath+"' transform='translate("+width/2+","+height/2+") scale("+width/(10+2*validateNullVal(colorBoxOptions.strokeWidth,1))+")' style='stroke: "+hexToRGB(strokeColor)+"; fill: "+hexToRGB(fillColor)+"; fill-opacity: "+colorBoxOptions.fillOpacity+"; stroke-width: "+validateNullVal(colorBoxOptions.strokeWidth,1)+"px; stroke-opacity: "+colorBoxOptions.strokeOpacity+";'></path>"}function getSVGSymbolString(pathString,width,height){var xml="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='"+width+"' height='"+height+"'>";return xml+=pathString,xml+=" </svg>",'url("data:image/svg+xml;'+($Browser.IE?"base64":"utf8")+","+($Browser.IE?btoa(xml):xml)+'")'}legend.setColorBoxBackground=function(elements,chartObj,states){var background,border,backgroundColor,borerColor,borderRadius,disabledOpacity,self,disabled,legendOptions=chartObj.systemConf.legend,colorBoxOptions=legendOptions.colorBox,itemDisabledOptions=legendOptions.itemDisabledStyle,disabledColorBoxOptions=itemDisabledOptions.colorBox||{},imagePallete=legendOptions.imagePallete?legutil.imagePallete.get(legendOptions.imagePallete):null,useImagePallete=defined(imagePallete)&&imagePallete.length>0,patternPallete=chartObj.patternPallete,patternPalleteLength=patternPallete&&patternPallete.length,useSVGImage=!chartObj.patternPallete&&(defined(legendOptions.shapes)||"square"!==colorBoxOptions.shape),grayScale=disabledColorBoxOptions.grayScale,fontSize=+utils.getVal(legendOptions.fontSize||chartObj.systemConf.canvas.fontSize),colorBoxSize=legend_helpers.getFilterBoxSize(colorBoxOptions,fontSize),colorBoxWidth=colorBoxSize[0],colorBoxHeight=colorBoxSize[1],backgroundSize=null;elements.each(function(d,i){if(self=d3_select(this),disabled=isDisabled(d,states.allSelected,states.isFirstClickAfterDeselection),borerColor=getClr(disabled,pick(colorBoxOptions.strokeColor,getColorByIndex(chartObj,i)),itemDisabledOptions),background=backgroundColor=getClr(disabled,pick(colorBoxOptions.fillColor,getColorByIndex(chartObj,i)),itemDisabledOptions),borderRadius=colorBoxOptions.borderRadius,disabledOpacity=disabled?disabledColorBoxOptions.fillOpacity:null,disabled&&grayScale&&$Browser.IE&&(backgroundColor=getGrayScaleColor(backgroundColor),borerColor=getGrayScaleColor(borerColor)),useImagePallete)if(disabled&&itemDisabledOptions.color)background=itemDisabledOptions.color;else{background='url("'+imagePallete[i%imagePallete.length]+'")';var patternSize=chartObj.patternImageSizes&&chartObj.patternImageSizes;backgroundSize=patternSize[i]?patternSize[i%patternSize.length][0]+PX+" "+patternSize[i%patternSize.length][1]+PX:null}else if(useSVGImage)background=function(width,height,strokeColor,fillColor,chartObj,index){strokeColor=hexToRGB$1(strokeColor),fillColor=hexToRGB$1(fillColor);var legendOptions=chartObj.systemConf.legend,colorBoxOptions=legendOptions.colorBox,symbolsArray=legendOptions.shapes,symbol=(symbolsArray?symbolsArray[index%symbolsArray.length]:null)||colorBoxOptions.shape,elements=symbol||!legend.getHTML4ChartTypeSymbol||colorscale_helpers.isQuantileColorScale(chartObj)&&chartObj.dataObject.isCombinationalChart?getHTML4SVGSymbol(width,height,strokeColor,fillColor,symbol,colorBoxOptions):legend.getHTML4ChartTypeSymbol(width,height,fillColor,chartObj,index);if(isImageUrl(elements))return'url("'+elements+'")';return getSVGSymbolString(elements,width,height)}(colorBoxWidth,colorBoxHeight,borerColor,background,chartObj,i),borderRadius=null;else if(patternPalleteLength){var svgPattern=patternPallete[i%patternPalleteLength],prop=patternThemes[svgPattern]?patternThemes[svgPattern]:addPatternThemeByEle(svgPattern);prop.bgClr_base=backgroundColor,prop.stroke_base=backgroundColor,prop.width=colorBoxWidth,prop.customStaticClr=chartObj.userdata.legend.customPatternColor,prop.x=prop.y=0;var patternID="zp"+generateIdByPropValue(prop,"legelegendndFill"),p=effects.svg_patterns.svgPatternFill(prop,patternID,null,!0,!0,chartObj,chartObj.getPatternSvg(),"objectBoundingBox"),patternWidth=p.width,patternHeight=p.height;background='url("'+p.url+'")',backgroundSize=(2*patternWidth<colorBoxWidth?patternWidth:colorBoxWidth/2)+PX+" "+(2*patternHeight<colorBoxHeight?patternHeight:colorBoxHeight/2)+PX,border=colorBoxOptions.strokeWidth+PX+"solid "+borerColor}else border=colorBoxOptions.strokeWidth+PX+"solid "+borerColor;if(isImageUrl(background)&&(backgroundSize=backgroundSize||colorBoxWidth+PX+" "+colorBoxHeight+PX,disabled&&grayScale&&$Browser.IE)){var dim=backgroundSize.split("px").map(function(d){return+d});!function(src,w,h,element){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=w,canvas.height=h;var imgObj=new Image;imgObj.src=src.substring(5,src.length-2),imgObj.width=w,imgObj.height=h,imgObj.onload=function(){ctx.drawImage(imgObj,0,0,w,h);for(var imgPixels=ctx.getImageData(0,0,canvas.width,canvas.height),y=0;y<imgPixels.height;y++)for(var x=0;x<imgPixels.width;x++){var i=4*y*imgPixels.width+4*x,avg=(imgPixels.data[i]+imgPixels.data[i+1]+imgPixels.data[i+2])/3;imgPixels.data[i]=avg,imgPixels.data[i+1]=avg,imgPixels.data[i+2]=avg}ctx.putImageData(imgPixels,0,0,0,0,imgPixels.width,imgPixels.height),element.style("background","url("+canvas.toDataURL()+")")}}(background,dim[0],dim[1],self)}self.styles({background:background,"background-size":backgroundSize,color:disabled?disabledColorBoxOptions.fontColor:colorBoxOptions.fontColor||"white",border:border,"border-radius":defined(borderRadius)?borderRadius+PX:null,opacity:disabled?disabledOpacity:null,filter:disabled&&grayScale&&!$Browser.IE?"grayscale(1)":null}).html(disabled?disabledColorBoxOptions.text||"":colorBoxOptions.text)})};var defaultSelectAllOptions={show:!1,strokeColor:"#262626",strokeWidth:1,fillColor:TRANSPARENT,fontColor:"#262626",fillOpacity:1,strokeOpacity:1,disabledOpacity:.3,tooltip:{enabled:!0,color:"red",content:"Select atleast one legend"},events:{click:null}},getLegendData=legend_helpers.getLegendData,isDisabled$1=legend_helpers.isDisabled,isAllEnabled=legend_helpers.isAllEnabled,getClr$1=legend_helpers.getClr,toggleChartEvents=legend_helpers.toggleChartEvents,updateData=legend_helpers.updateData;legend.selectAllBox=function(container,chartObj,states){defaultSelectAllOptions.events.click=chartObj.legend.component.toggleSelectAll=function(){if(legData||(legData=getLegendData(chartObj)),states.allSelected&&(legData.forEach(function(d,j){d.disabled=!states.allSelected,updateData(d,j,chartObj)}),chartObj.addRemoveSeries(legData,0,[0,0],!0)),function(){if(!legendFilter){var legendContainer=chartObj.legendarea.element;legendFilter=legendContainer.selectAll("div.legendfilterbox"),legendlabel=legendContainer.selectAll("span.legendlabel")}var fontClr,txtDec;legend.setColorBoxBackground(legendFilter,chartObj,states),states.allSelected?(fontClr=fontColor,txtDec=null):(fontClr=getClr$1(!0,fontColor,itemDisabledOptions),txtDec=JSON.parse(itemDisabledOptions.strikeout)?"line-through":null),legendlabel.styles({color:fontClr,"text-decoration":txtDec})}(),toggleChartEvents(chartObj,states.allSelected),legend_helpers.fadeChart(states.allSelected,chartObj,disabledOpacity),selectAllBoxTooltipOptions.enabled){var tooltip=chartObj.eventHandler.tooltipElement;defaultTooltipColor||(defaultTooltipColor=tooltip.element.selectAll("div#tooltipcontent").style("color"));var tooltip_data=chartObj.systemConf.tooltip,tooltipBorderWidth=shorthand_px(defined(tooltip_data.borderWidth)?tooltip_data.borderWidth:1);if(states.allSelected){var tooltip=chartObj.eventHandler.tooltipElement;applyTooltipStyle(tooltip,null,tooltipBorderWidth,defaultTooltipColor),tooltip.hide(tooltip.element)}else{var coordinate=getMousePosition(svgNode,d3$1.event);coordinate={x:coordinate[0],y:coordinate[1]};var evt=getEventObject(d3$1.event),position=getTooltipPosition(evt,coordinate,0,0,chartObj,{},!1,!1,!1,!0,!1),dLeft=coordinate.x-evt.clientX,dTop=coordinate.y-evt.clientY;position.dLeft=dLeft,position.dTop=dTop,position.helpers.color=selectAllBoxTooltipOptions.color,position.helpers.backgroundColor=selectAllBoxTooltipOptions.backgroundColor,position.helpers.borderColor=selectAllBoxTooltipOptions.borderColor,applyTooltipStyle(tooltip,"center",null,selectAllBoxTooltipOptions.fontColor||defaultTooltipColor),tooltip.show(chartObj,position,selectAllBoxTooltipOptions.content,!1,position.helpers),setTimeout(function(){var tooltip=chartObj.eventHandler.tooltipElement;applyTooltipStyle(tooltip,null,tooltipBorderWidth,defaultTooltipColor),tooltip.hide(tooltip.element)},4e3)}}};var defaultTooltipColor,legendlabel,legendFilter,legData=getLegendData(chartObj),legendOptions=chartObj.systemConf.legend,colorBox=legendOptions.colorBox,selectAllBoxOptions=mergeJSON(defaultSelectAllOptions,legendOptions.selectAllBox,!0),itemDisabledOptions=legendOptions.itemDisabledStyle,disabledColorBox=itemDisabledOptions.colorBox||{},priorityArray=[legendOptions,chartObj.systemConf.canvas,$ZCG],fontSize=+utils.getVal(legendOptions.fontSize||chartObj.systemConf.canvas.fontSize),fontColor=getValByPriority(priorityArray,"fontColor"),selectAllColorBoxMerged=(legendOptions.imagePallete&&legutil.imagePallete.get(legendOptions.imagePallete),mergeJSON(colorBox,selectAllBoxOptions,!0)),colorBoxSize=legend_helpers.getFilterBoxSize(selectAllColorBoxMerged,fontSize),colorBoxWidth=colorBoxSize[0],colorBoxHeight=colorBoxSize[1],selectAllFilterSize=Math.min(colorBoxWidth,colorBoxHeight)-(legendOptions.imagePallete||!defined(legendOptions.shapes)||"square"===colorBox.shape?0:+colorBox.strokeWidth),svgNode=chartObj.container.node(),selectAllBoxTooltipOptions=selectAllBoxOptions.tooltip,disabledOpacity=selectAllBoxOptions.disabledOpacity;states.allSelected=defined(selectAllBoxOptions.selected)?selectAllBoxOptions.selected:states.allSelected;var selectAllFilter=appendEle(container,"div",[1],".","class","selectAll"),shapeType=pick(selectAllBoxOptions.shape,colorBox.shape),useSVGImage="square"!==shapeType,styles={display:selectAllBoxOptions.show?"inline-block":NONE,width:selectAllFilterSize+"px",height:selectAllFilterSize+"px",float:"left",background:selectAllBoxOptions.fillColor,position:"absolute","box-sizing":"border-box","text-align":"center","line-height":selectAllFilterSize+"px","font-family":colorBox.fontFamily,"font-size":(colorBox.fontSize||fontSize-2)+"px",color:function(d){return selectAllBoxOptions.fontColor||(isDisabled$1(d,states.allSelected,states.isFirstClickAfterDeselection)?disabledColorBox.fontColor:colorBox.fontColor)}};if(useSVGImage){var path=getHTML4SVGSymbol(selectAllFilterSize,selectAllFilterSize,selectAllBoxOptions.strokeColor,selectAllBoxOptions.fillColor,shapeType,selectAllBoxOptions);styles.background=getSVGSymbolString(path,selectAllFilterSize,selectAllFilterSize),styles.border="none"}else styles.border=selectAllBoxOptions.strokeWidth+"px solid "+selectAllBoxOptions.strokeColor;selectAllFilter.styles(styles).html(function(){return isAllEnabled(legData,states.allSelected)?pick(selectAllBoxOptions.text,colorBox.text)||"&#10003;":disabledColorBox.text||""}),container.style("cursor",selectAllBoxOptions.show?POINTER:null);var mouseHandlers={click:selectBoxClickFunction},touchHandlers={tap:selectBoxClickFunction};if(selectAllBoxOptions.show?attachevents(container,mouseHandlers,touchHandlers):(detachevent(container,null,mouseHandlers),detachevent(container,null,touchHandlers)),chartObj.eventHandler){var tooltip=chartObj.eventHandler.tooltipElement;tooltip.hide(tooltip.element)}return{element:selectAllFilter,options:selectAllBoxOptions,size:selectAllFilterSize};function selectBoxClickFunction(){states.allSelected&&!isAllEnabled(legData,states.allSelected)||(states.allSelected=!states.allSelected),states.isFirstClickAfterDeselection=!1,selectAllFilter.html(states.allSelected?pick(selectAllBoxOptions.text,colorBox.text)||"&#10003;":disabledColorBox.text||""),invokeFunction(selectAllBoxOptions.events[chartObj.zcEventType||"click"],d3$1.event,states.allSelected,chartObj)}function applyTooltipStyle(tooltip,align,borderWidth,contentColor){tooltip.element.attr("align",align).styles({"border-width":borderWidth}),tooltip.element.selectAll("div#tooltipcontent").style("color",contentColor)}},legend.render=function(chartObj){var systemconf=chartObj.systemConf,legendData=systemconf.legend,dataObject=chartObj.dataObject,seriesdata=chartObj.seriesdata,isQuantileColorScale=colorscale_helpers.isQuantileColorScale(chartObj),isContinousLegend=legend_helpers.isContinousLegend(chartObj),legComp=chartObj.legend.component=isContinousLegend?legend.continuous.get():legend.discrete.get(),legendShow=chartObj.isAxisCategory||chartObj.isNonAxisMultiSeriesCategory?seriesdata.some(function(d){return!legend_helpers.isHiddenItem(d)&&d.seriesname!==UNDEFINED}):!(chartObj.chartTypes[0].value==charttype.dial);legendShow=legendShow||isQuantileColorScale;var dim=chartObj.canvasarea[null==legendData||null==legendData.vAlign?"height":"top"===legendData.vAlign||"bottom"===legendData.vAlign?"height":"width"];legendShow=!(!(null!=legendData&&null!=legendData.x&&""!==legendData.x&&null!=legendData.y&&""!==legendData.y)&&!dimension_based_intelligence(chartObj,"legend",dim))&&legendShow,function(){if(isQuantileColorScale){chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE&&(chartObj.userdata.legend=chartObj.userdata.legend||{},chartObj.userdata.legend.colorBand=chartObj.userdata.legend.colorBand||{},chartObj.userdata.legend.colorBand.ranges||(chartObj.systemConf.legend.colorBand.ranges=chartObj.userdata.legend.colorBand.ranges=colorscale_helpers.getCategories(chartObj)));var userRanges=chartObj.systemConf.legend.colorBand.ranges;userRanges&&userRanges.length&&(chartObj.userdata.legend.colorBand.ranges=chartObj.systemConf.legend.colorBand.ranges=getRawRanges(chartObj,!0));var colorScale=scale$1.getScale(chartObj,dataObject,null,null,null,chartObj.dataset,"clr"),colorScale_domain=colorScale.domain(),indexScale=colorScale.copy();indexScale.range(colorscale_helpers.getProcessedColorRange(d3_range(colorScale_domain.length),colorScale_domain,chartObj.systemConf.legend.colorBand,chartObj));var axisObj=chartObj.axes.clr||{};axisObj.scaleType="quantile",axisObj.scale=colorScale,axisObj.indexScale=indexScale,axisObj.component=axisObj.component||axis.get(),chartObj.axes.clr=axisObj}else chartObj.axes.clr={}}(),isQuantileColorScale&&setDefaultOptions("filter",legendData,chartObj.globalProp,legend.continuous.ZC_brushComponent_getDefaultOptions(chartObj),!0),legendShow&&!0===legendData.enabled?(chartObj.legendarea.show=!0,chartObj.legendarea.element.style("display",""),function(){legendData.legpos;(legComp=legComp.chartarea(chartObj.chartarea).systemconf(systemconf).color(chartObj.seriesColor).chartObj(chartObj))(chartObj.legendarea.element.datum(legendData));var legwid,leghei,legx,legy,legnode=chartObj.legendarea.element.node();if(isContinousLegend){var bb=bbox(legnode);legwid=bb.width,leghei=bb.height,legy=bb.y,legx=bb.x}else legwid=legnode.offsetWidth,leghei=legnode.offsetHeight,legy=legnode.offsetTop,legx=legnode.offsetLeft;var floating=null!=legendData.x&&""!==legendData.x&&null!=legendData.y&&""!==legendData.y;legendData.marginLeft=+legendData.marginLeft,legendData.marginRight=+legendData.marginRight,legendData.marginTop=+legendData.marginTop,legendData.marginBottom=+legendData.marginBottom;var legendAlign=getLegendAlignment(legendData),isRowView="vertical"===legendAlign.layout,isColumnView=!isRowView,left=0,top=0,hAlign=legendAlign.hAlign,vAlign=legendAlign.vAlign,adjustPlotHeight=function(){top=leghei+legendData.marginTop+legendData.marginBottom,chartObj.chartarea.height-=top,chartObj.plotarea.height-=top,"top"===legendData.vAlign&&(chartObj.chartarea.top+=top,chartObj.plotarea.top+=top),chartObj.legendarea.adjust="x"},adjustPlotWidth=function(){left=legwid+legendData.marginLeft+legendData.marginRight,chartObj.chartarea.width-=left,chartObj.plotarea.width-=left,"left"===legendData.hAlign&&(left=legwid+legendData.marginLeft+legendData.marginRight,chartObj.chartarea.left+=left,chartObj.plotarea.left+=left),chartObj.legendarea.adjust="y"};floating||(isColumnView?"top"===vAlign||"bottom"===vAlign?adjustPlotHeight():"center"===vAlign&&adjustPlotWidth():isRowView&&("left"===hAlign||"right"===hAlign?adjustPlotWidth():"center"===hAlign&&adjustPlotHeight()));chartObj.legendarea.x=legx,chartObj.legendarea.y=legy,chartObj.legendarea.width=legwid,chartObj.legendarea.height=leghei}()):(chartObj.legendarea.show=!1,chartObj.legendarea.element.style("display",NONE),!isContinousLegend&&legend.events(chartObj,chartObj.legendarea.element.selectAll("li.series"),{allSelected:!0,isFirstClickAfterDeselection:!1}))},legend.discrete=function(){},legend.discrete.get=function(){var chartarea,color,systemconf,chartObj,legendWidth=0,legendSeriesWidth=0,dispatch=d3_dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout"),scrollbarwid=20,getLegendData=legend_helpers.getLegendData,getLegendDataLength=legend_helpers.getLegendDataLength,isHiddenItem=legend_helpers.isHiddenItem,getClr=legend_helpers.getClr,isDisabled=legend_helpers.isDisabled;function chart(selection){return selection.each(function(data){var item_textOverflow_properties,legData=getLegendData(chartObj),legData_length=getLegendDataLength(chartObj,legData),colorBoxOptions=data.colorBox,itemDisabledOptions=data.itemDisabledStyle,priorityArray=[data,systemconf.canvas,$ZCG],floating=null!=data.x&&""!==data.x&&null!=data.y&&""!==data.y,fontSize=+utils.getVal(data.fontSize||systemconf.canvas.fontSize),fontColor=getValByPriority(priorityArray,"fontColor"),colIdx=chartObj.dataset.getColumnIdx(chartObj.xymultiRenderer||chartObj.isGeoMap||chartObj.isNonAxisMultiSeriesCategory||colorscale_helpers.isQuantileColorScale(chartObj)?"clr":"x"),showAs=data.showAs,colorBoxPosition=colorBoxOptions.position||"left",expandable=data.expandable||{},legendExpandable=!0===expandable.show,redrawing=!!chartObj.renderer.length,colorBoxSize=legend_helpers.getFilterBoxSize(colorBoxOptions,fontSize),colorBoxWidth=colorBoxSize[0],colorBoxHeight=colorBoxSize[1],legendAlign=getLegendAlignment(data),states=(legendAlign.hAlign,legendAlign.vAlign,chartObj.legend.states=chartObj.legend.states||{allSelected:!0,isFirstClickAfterDeselection:!1}),isColumnView="horizontal"===legendAlign.layout;item_textOverflow_properties="wrap"===data.textOverflow?{"word-wrap":"break-word","white-space":"normal","vertical-align":"top"}:{"text-overflow":"ellipsis","vertical-align":"middle"};var container=d3_select(this);chart.update=function(){container.transition().call(chart)};container.styles({display:"block",position:"absolute",left:null,top:null});var wrap=appendEle(container,"div",[data],".","class","legendgroup"),shadow=data.shadow;if(!0===shadow.show){var shadowstyle=shadow.x+"px "+shadow.y+"px "+shadow.blur+"px "+shadow.color;shadowstyle=shadow.inset?shadowstyle+" inset":shadowstyle,container.style("box-shadow",shadowstyle)}else container.style("box-shadow",null);var rgb=d3_rgb(data.background.color.toString());container.style("background-color","rgba("+rgb.r+","+rgb.g+","+rgb.b+","+data.background.alpha+")");var border=data.border;!0===border.show?container.styles({border:+border.size+"px "+border.style+" "+border.color,"border-radius":border.radius+"px"}):container.style("border",null),chartObj.filterEffectsID&&!1!==data.useChartEffect&&container.style("filter",chartObj.filterEffectsID?"url(#"+chartObj.filterEffectsID+")":null);var title_data=data.title,keepLegendTitleAligned=title_data.keepAligned&&isColumnView,titleMargin=defined(title_data.margin)?title_data.margin:3,titleAlignedStyles={display:keepLegendTitleAligned?"inline-block":null,"vertical-align":"top"},header=createElement("ul",".zcheader",!0===title_data.show?[title_data]:[],wrap,":first-child").styles(titleAlignedStyles),headerLI=appendEle(header,"li",[1],".","class","zcheader");header.styles({"white-space":"normal",overflow:"hidden",width:"","list-style-type":NONE,margin:0,padding:0}),headerLI.styles({padding:shorthand_px(titleMargin),"white-space":"nowrap",overflow:"hidden","text-align":"left","text-overflow":"ellipsis","vertical-align":"middle"});var selectAllObj=legend.selectAllBox(headerLI,chartObj,states),selectAllFilter=selectAllObj.element,selectAllBoxOptions=selectAllObj.options,selectAllFilterSize=selectAllObj.size,disabledOpacity=selectAllBoxOptions.disabledOpacity;legend_helpers.fadeChart(states.allSelected,chartObj,disabledOpacity);var legtitle=appendEle(headerLI,"span",[1],".","class","legendtitle");legtitle.text(decodeHTML(title_data.text)).style("padding-"+colorBoxPosition,selectAllBoxOptions.show?data.textPadding+"px":null).style("margin-"+colorBoxPosition,selectAllBoxOptions.show?selectAllFilterSize+"px":null),applyFont(legtitle,[title_data,systemconf.canvas,$ZCG],!0),selectAllFilter.style("margin",function(){return Math.max(0,(legtitle.node().offsetHeight-selectAllFilter.node().offsetHeight)/2)+"px"+" 0px 0px 0px"}),headerLI.style("line-height",function(){var selectAllFilterHeight=selectAllBoxOptions.show?selectAllFilter.node().offsetHeight:0;return Math.max(legtitle.node().offsetHeight,selectAllFilterHeight)+"px"});var showMoreElement,legseries=appendEle(wrap,"ul",[data],".","class","legseries");legseries.styles({"white-space":"normal","overflow-y":"hidden",width:"","list-style-type":NONE,margin:0,padding:0,"-webkit-overflow-scrolling":"touch","font-size":"0px"}).styles(titleAlignedStyles),legendExpandable?(legseries.style("overflow","hidden"),(showMoreElement=appendEle(wrap,"div",[1],".","class","expandable")).styles({color:expandable.fontColor,"font-size":utils.getVal(expandable.fontSize)+"px","font-family":expandable.fontFamily||getValByPriority(priorityArray,"fontFamily"),"text-align":expandable.textAlign,cursor:POINTER,display:"block",padding:data.itemMargin+"px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"}),showMoreElement.html(invokeFunction(expandable.text,0,chartObj)||"0 more...")):wrap.select(".expandable").empty()||(wrap.selectAll(".expandable").remove(),legseries.style("overflow-y","hidden"),legseries.style("overflow-x","hidden"));var series=appendEle(legseries,"li",legData,".","class","series");appendEle(series,"div",[1],".","class","legendfilterbox"),appendEle(series,"span",[1],".","class","legendlabel"),series.styles({color:function(d){return getClr(isDisabled(d,states.allSelected,states.isFirstClickAfterDeselection),fontColor,itemDisabledOptions)},position:"relative","white-space":"nowrap",padding:+data.itemMargin+"px",overflow:"hidden","text-align":"left","line-height":defined(colorBoxOptions.size)?mathMax(fontSize,colorBoxHeight)+"px":($Browser.OSX||$Browser.LINUX)&&$Browser.FIREFOX?"1.2":"normal","font-size":fontSize+"px",width:null==data.itemWidth||""==data.itemWidth?null:data.itemWidth+"px",height:null==data.itemHeight||""==data.itemHeight?null:data.itemHeight+"px","font-family":getValByPriority(priorityArray,"fontFamily"),"font-weight":getValByPriority(priorityArray,"fontWeight"),display:function(d){return isHiddenItem(d)?NONE:isColumnView?"inline-block":"block"}}).styles(item_textOverflow_properties).style("vertical-align","top"),legend.events(chartObj,series,states,disabledOpacity);var legendlabel=series.select("span.legendlabel");defined(showAs)&&legendlabel.style("display","inline-block"),legendlabel.style("padding-"+colorBoxPosition,data.textPadding+"px").style("margin-"+colorBoxPosition,colorBoxWidth+"px").html(function(d,i){if(colorscale_helpers.isQuantileColorScale(chartObj)){var userLabels=data.colorBand.labels;if(userLabels&&userLabels.length)return encodeHTML(userLabels[i])}var seriesPos=chartObj.xymultiRenderer||chartObj.isNonAxisMultiSeriesCategory||chartObj.isGeoMap?i:0,showAsText=getLegendShowAsText(d,i,data,chartObj);return showAs?showAsText:chartObj.dataset.getDataPointValue(chartObj,d,colIdx,seriesPos,null,"legend")}).attr("title",function(){return data.tooltip?this.textContent:null});var ImpFontProp={fontColor:function(d){return getClr(isDisabled(d,states.allSelected,states.isFirstClickAfterDeselection),fontColor,itemDisabledOptions)},textDecoration:function(d){return isDisabled(d,states.allSelected,states.isFirstClickAfterDeselection)&&itemDisabledOptions.strikeout?"line-through":null}};applyFont(legendlabel,[ImpFontProp,data,systemconf.canvas,$ZCG],!0),redrawing&&defined(showAs)&&series.each(function(d){applyFont(d3_select(this).selectAll(".legendlabel, .legendlabel *"),[{fontColor:ImpFontProp.fontColor(d),textDecoration:ImpFontProp.textDecoration(d)},data,systemconf.canvas,$ZCG],!0)});var legend_label_height=legseries.select("span.legendlabel").node().offsetHeight,margin_top=0;defined(colorBoxOptions.size)||"wrap"===data.textOverflow?margin_top=(mathMax(fontSize,colorBoxHeight)-colorBoxHeight)/2:legend_label_height>colorBoxHeight&&(margin_top=(legend_label_height-colorBoxHeight)/2);var legendFilter=series.select("div.legendfilterbox");legendFilter.styles({width:colorBoxWidth+PX,height:colorBoxHeight+PX,float:colorBoxPosition,"margin-top":margin_top+PX,"border-color":TRANSPARENT,"background-repeat":"repeat","line-height":colorBoxHeight-colorBoxOptions.strokeWidth+PX,"text-align":"center","font-family":colorBoxOptions.fontFamily,"font-size":(colorBoxOptions.fontSize||fontSize)+PX,position:"absolute",display:"inline-block","box-sizing":"border-box"}),legend.setColorBoxBackground(legendFilter,chartObj,states);var textNodeWid,filterNodeWid,itemTempHeight=series.node().offsetHeight,legendExpanded=chartObj.legend.expanded,itemWidths=[],maxItemWidth=null!=data.itemWidth?+data.itemWidth:null;series.each(function(d){if(!d.hideInLegend){var legendfilter=d3_select(this).select("div.legendfilterbox"),legendText=d3_select(this).select("span.legendlabel");filterNodeWid=filterNodeWid||legendfilter.node().getBoundingClientRect().width,textNodeWid=legendText.node().getBoundingClientRect().width;var computedTextLength=filterNodeWid+textNodeWid;itemWidths.push(maxItemWidth||computedTextLength+2*+data.itemMargin)}}),maxItemWidth=null!=data.itemWidth?maxItemWidth:d3_max(itemWidths);var maxItemHeight=data.itemHeight||mathMax(legend_label_height,colorBoxHeight)+2*+data.itemMargin;legseries.style("overflow-y",!0===(legendExpandable&&legendExpanded||!legendExpandable)?"auto":"hidden"),legseries.style("overflow-x","hidden");var maxItemToFit,itemsPerRow=0,columnWidths=[];if(legendWidth=0,floating){var maxHeight=perToPx(data.maxHeight||ZC_LEGEND_maxHeightVertRatio,chartarea.height);legendExpandable&&(maxHeight=mathFloor(maxHeight/itemTempHeight)*itemTempHeight);var dimension=chartObj.legendarea.element.node().getBoundingClientRect(),maxX=mathMin(chartObj.canvasarea.width-dimension.width,data.x),maxY=mathMin(chartObj.canvasarea.height-mathMin(dimension.height,maxHeight),data.y);container.style("left",maxX+"px"),container.style("top",maxY+"px"),legseries.style("max-height",maxHeight+"px")}else{var maxWidth=perToPx(data.maxWidth||(isColumnView?ZC_LEGEND_maxWidthHoriRatio:ZC_LEGEND_maxWidthVertRatio),chartarea.width),maxWidthTitle=mathMin(perToPx(title_data.maxWidth||(keepLegendTitleAligned?LEGEND_TITLE_MAX_WIDTH_HORIZONTAL:LEGEND_TITLE_MAX_WIDTH_VERTICAL),maxWidth),maxWidth);wrap.style("max-width",maxWidth+"px"),header.style("max-width",maxWidthTitle+"px");var headerWidth=function(element){if(element.isD3Selection&&(element=element.node()),defined(element)&&isElementVisible(element))return element.getBoundingClientRect();var t={};return t.x=t.y=t.width=t.height=t.top=t.left=t.right=t.bottom=0,t}(header).width;if(isColumnView){var newMaxWidth=maxWidth;keepLegendTitleAligned&&(newMaxWidth=maxWidth-headerWidth,series.styles({"max-width":newMaxWidth+"px"}));maxHeight=perToPx(data.maxHeight||ZC_LEGEND_maxHeightHoriRatio,chartarea.height);var availableLegWidth=newMaxWidth-+data.marginLeft-+data.marginRight-(data.border.show?2*data.border.size:0);for(legendExpandable&&(maxHeight=mathFloor(maxHeight/itemTempHeight)*itemTempHeight)<itemTempHeight&&(maxHeight=itemTempHeight);legendWidth<availableLegWidth&&itemsPerRow<itemWidths.length;)columnWidths[itemsPerRow]=itemWidths[itemsPerRow],legendWidth+=itemWidths[itemsPerRow],itemsPerRow++;for(var sumFunc=function(prev,cur){return prev+cur};legendWidth>availableLegWidth&&itemsPerRow>1;){columnWidths=[],itemsPerRow--;for(var k=0;k<itemWidths.length;k++)columnWidths[k%itemsPerRow]=itemWidths[k%itemsPerRow];legendWidth=columnWidths.reduce(sumFunc)}var moduloRem=itemWidths.length%itemsPerRow,moduloQuo=(itemWidths.length-moduloRem)/itemsPerRow,noOfRows=0==moduloRem?moduloQuo:moduloQuo+1;legseries.styles({height:noOfRows*maxItemHeight+2+"px","max-height":maxHeight+"px","max-width":newMaxWidth+"px"});var scrollWid=legseries.node().scrollHeight>legseries.node().offsetHeight?scrollbarwid:0;legendSeriesWidth=legendWidth+2+scrollWid,legseries.style("width",legendSeriesWidth+"px");var legalign=align(data,container);maxItemToFit=getVisibleItemCount(legseries),defined(showMoreElement)&&legData_length<=maxItemToFit&&(appendEle(wrap,"div",[],".","class","expandable"),legalign=align(data,container)),container.styles({left:legalign[0]+"px",top:legalign[1]+"px"})}else{itemsPerRow=1;maxHeight=perToPx(data.maxHeight||ZC_LEGEND_maxHeightVertRatio,chartarea.height);legendExpandable&&(maxHeight=mathFloor(maxHeight/itemTempHeight)*itemTempHeight),legseries.styles({"max-height":maxHeight+"px","max-width":maxWidth+"px"});scrollWid=legseries.node().scrollHeight>legseries.node().offsetHeight?scrollbarwid:0;legendSeriesWidth=maxItemWidth+2+scrollWid,maxItemToFit=getVisibleItemCount(legseries),defined(showMoreElement)&&legData_length<=maxItemToFit&&appendEle(wrap,"div",[],".","class","expandable"),legseries.styles({width:legendSeriesWidth+"px",height:null}),legalign=align(data,container),container.styles({left:legalign[0]+"px",top:legalign[1]+"px"})}}if(legendExpandable){var visibleItemCount=pick(maxItemToFit,getVisibleItemCount(legseries));if(legData_length>visibleItemCount){showMoreElement.styles({width:legendSeriesWidth+"px","margin-left":keepLegendTitleAligned?headerWidth+PX:0});var showMoreText=invokeFunction(expandable.text,legData_length-visibleItemCount,chartObj)||legData_length-visibleItemCount+" more...";legendExpanded?redrawing&&legendExpanded&&showMoreElement.html(function(){return invokeFunction(expandable.ontoggle,this,legendExpanded,chartObj)||"Show less.."}):showMoreElement.html(showMoreText),showMoreElement.on("click",function(){legendExpanded=chartObj.legend.expanded=!chartObj.legend.expanded;var updatedText=invokeFunction(expandable.ontoggle,this,legendExpanded,chartObj);defined(updatedText)&&(updatedText+=""),legendExpanded?(this.innerHTML=updatedText||"Show less..",legseries.style("overflow-y","auto")):(legseries.node().scrollTop=0,visibleItemCount=getVisibleItemCount(legseries),this.innerHTML=updatedText||invokeFunction(expandable.text,legData_length-visibleItemCount,chartObj)||legData_length-visibleItemCount+" more...",legseries.style("overflow-y","hidden"))})}else showMoreElement.remove()}}),chart}function align(data,legNode){return getLegendPosition(chartarea,chartObj)}function getVisibleItemCount(legseries){for(var leg=legseries.node(),elements=leg.children,count=0,ii=0,ll=elements.length;ii<ll&&utils.elementIsVisible(elements[ii],leg);ii++)count++;return count}return chart.dispatch=dispatch,chart.chartarea=function(_){return arguments.length?(chartarea=_,chart):chartarea},chart.systemconf=function(_){return arguments.length?(systemconf=_,chart):systemconf},chart.chartObj=function(_){return arguments.length?(chartObj=_,chart):chartObj},chart.color=function(_){return arguments.length?(color=_,chart):color},chart};var docEle=d3_select(document.documentElement),docTapFunction=function(chartObj){if($Browser.isTouchDevice&&(!chartObj&&$ZCG.clickArguments&&$ZCG.previousChartObj||$ZCG.previousChartObj&&$ZCG.previousChartObj!=chartObj)&&isElementVisible($ZCG.previousChartObj.container.node())){$ZCG.clickArguments[4]=!0;var tooltipConfig=$ZCG.previousChartObj.systemConf.tooltip,tooltipHideDelay=tooltipConfig.hideDelay;tooltipConfig.hideDelay=0,$ZCG.previousChartObj.eventHandler.tapOldInfo=null,$ZCG.previousChartObj.eventHandler.mouseOut.apply($ZCG.clickedElement,$ZCG.clickArguments),tooltipConfig.hideDelay=tooltipHideDelay}},documentTapEvent=docTapFunction;if($Browser.isTouchDevice){var callPlotMouseOut=function(){var now=(new Date).getTime();(!$ZCG.clickedTime||now-$ZCG.clickedTime>500)&&docTapFunction()};attachevents(docEle,{},{tap:callPlotMouseOut,taphold:callPlotMouseOut,dbltap:callPlotMouseOut},{preventDefault:!1}),docEle.on("touchmove",function(){docTapFunction()})}var getLegendData$1=legend_helpers.getLegendData,getLegendDataLength=legend_helpers.getLegendDataLength,isHiddenItem=legend_helpers.isHiddenItem,isDisabled$2=legend_helpers.isDisabled,isAllEnabled$1=legend_helpers.isAllEnabled,getClr$2=legend_helpers.getClr,updateData$1=legend_helpers.updateData;function getBoundBoxPathDescription(x,y,w,h,r,padding,hookPosition,hookOptions,adjustVal){var hookEnabled=hookOptions.enabled,hookWidth=hookOptions.width,hookHeight=hookOptions.height,path=roundedRect(x,y,w+2*padding,h+2*padding,r);if(hookEnabled&&hookPosition){var positionIndex=hookPosition===BOTTOM_ALIGN?7:hookPosition===TOP_ALIGN?3:hookPosition===RIGHT_ALIGN?5:1,parsedPath=parseSVGPath(path);!function(array,index,coordinates){coordinates.forEach(function(d){array.splice(index,0,{function:"l",moves:d})})}(parsedPath,positionIndex,function(mode,parsedPath,positionIndex){var horizontalx1=parsedPath[positionIndex-1].moves[positionIndex-1?5:0],horizontalx2=parsedPath[positionIndex].moves[0],verticaly1=parsedPath[positionIndex-1].moves[positionIndex-1?6:1],verticaly2=parsedPath[positionIndex].moves[1],horizontalMid=(horizontalx1+horizontalx2)/2,verticalMid=(verticaly1+verticaly2)/2;if(y=parsedPath[positionIndex].moves[1],x=parsedPath[positionIndex].moves[0],defined(adjustVal)&&adjustVal){var flip=adjustVal>0?1:-1,dist=mode===BOTTOM_ALIGN?horizontalx1-horizontalx2:horizontalx2-horizontalx1;horizontalMid-=(dist-hookWidth)/2-adjustVal*flip>0?adjustVal:(dist-hookWidth)/2*flip}switch(mode){case BOTTOM_ALIGN:return[[horizontalMid-hookWidth/2,y],[horizontalMid,y+hookHeight],[horizontalMid+hookWidth/2,y]];case TOP_ALIGN:return[[horizontalMid+hookWidth/2,y],[horizontalMid,y-hookHeight],[horizontalMid-hookWidth/2,y]];case LEFT_ALIGN:return[[x,verticalMid-hookWidth/2],[x-hookHeight,verticalMid],[x,verticalMid+hookWidth/2]];case RIGHT_ALIGN:return[[x,verticalMid+hookWidth/2],[x+hookHeight,verticalMid],[x,verticalMid-hookWidth/2]]}}(hookPosition,parsedPath,positionIndex)),path=parsedPath.reduce(function(prev,cur){return prev+cur.function.toUpperCase()+(cur.moves&&cur.moves.join(" ")||"")},"")}return path}legend.events=function(chartObj,element,states,disabledOpacity){var legendFilter,selectAllFilter,legData,legData_length,onClickFn,onDblClickFn,onMouseOverFn,onMouseOutFn,onTapFn,onTapHoldFn,onTapHoldEndFn,cursor,eventDisabled,legendComponent=chartObj.legend.component,legendOptions=chartObj.systemConf.legend,itemDisabledOptions=legendOptions.itemDisabledStyle,colorBoxOptions=legendOptions.colorBox,priorityArray=[legendOptions,chartObj.systemConf.canvas,$ZCG],priorityArrayOnhover=[legendOptions.itemHoverStyle,legendOptions,chartObj.systemConf.canvas,$ZCG],fontColor=getValByPriority(priorityArray,"fontColor"),events_legend=chartObj.systemConf.legend.events;if(null!=events_legend&&(eventDisabled=0==validateNullVal(events_legend.enabled,!0),onClickFn=events_legend.click,onDblClickFn=events_legend.doubleclick,onMouseOverFn=events_legend.mouseover,onMouseOutFn=events_legend.mouseout,cursor=events_legend.cursor,onTapFn=events_legend.tap,onTapHoldFn=events_legend.taphold,onTapHoldEndFn=events_legend.tapholdend),!eventDisabled){element.style("cursor",cursor||POINTER);var mousemove=function(d,i){($ZCG.clickedTime=null,null==onMouseOverFn)?defaultOnMouseOverFunc(this,d,i):invokeFunction(chartObj.zcEventType?onTapHoldFn:onMouseOverFn,d3$1.event,d,i,chartObj)},mouseout=function(d,i){null==onMouseOutFn?function(ele,d,i){legendComponent.highlightSeries(ele,d,i,legendOptions,chartObj),legendComponent.highlightItem(ele,d,i,legendOptions)}(this,d,i):invokeFunction(chartObj.zcEventType?onTapHoldEndFn:onMouseOutFn,d3$1.event,d,i,chartObj)},click=function(d,i){(d3$1.event&&d3$1.event.touches&&docTapFunction(),null==onClickFn)?function(ele,d,i){legendComponent.toggleItemNUpdateChart(ele,d,i,legendOptions)}(this,d,i):invokeFunction(chartObj.zcEventType?onTapFn:onClickFn,d3$1.event,d,i,chartObj)},dblclick=function(d,i){null==onDblClickFn||invokeFunction(onDblClickFn,d3$1.event,d,i,chartObj)};attachevents(element,{mousemove:mousemove,mouseout:mouseout,click:click,dblclick:dblclick},{taphold:mousemove,tapholdend:mouseout,tap:click,dbltap:dblclick},{chartObj:chartObj})}function defaultOnMouseOverFunc(ele,d,i){legendComponent.highlightSeries(ele,d,i,legendOptions,chartObj,!0),legendComponent.highlightItem(ele,d,i,legendOptions,!0)}legendComponent.filterSeriesNUpdate=function(d,i,chartObj){legData||(legData=getLegendData$1(chartObj),legData_length=getLegendDataLength(chartObj,legData));var clickeddata=legData[i];legData.filter(function(d,j){if(!states.allSelected&&!states.isFirstClickAfterDeselection){isHiddenItem(d)||(d.disabled=!states.allSelected),updateData$1(d,j,chartObj),legend_helpers.toggleChartEvents(chartObj,!0),legend_helpers.fadeChart(!0,chartObj,disabledOpacity);var tooltip=chartObj.eventHandler.tooltipElement;tooltip.hide(tooltip.element)}return!isHiddenItem(d)&&d.disabled}).length==legData_length-1&&!clickeddata.disabled&&!isHiddenItem(d)||(clickeddata.disabled=!clickeddata.disabled,chartObj.dataObject.hierarchical&&!colorscale_helpers.isQuantileColorScale(chartObj)&&(chartObj.systemConf.seriesdata.chartdata[i].disabled=clickeddata.disabled),updateData$1(clickeddata,i,chartObj),chartObj.addRemoveSeries(clickeddata,0,clickeddata.yaxiscolumnorder,!states.allSelected&&!states.isFirstClickAfterDeselection)),states.allSelected||states.isFirstClickAfterDeselection||(states.isFirstClickAfterDeselection=!0)},legendComponent.toggleItemNUpdateChart=function(ele,d,i,legendOptions){var legendContainer=chartObj.legendarea.element;if(legendFilter=legendFilter||legendContainer.selectAll("div.legendfilterbox"),selectAllFilter=selectAllFilter||legendContainer.selectAll("div.selectAll"),legendOptions.filter.enabled){chartObj.legendHighlight.resetSelection(),legendComponent.filterSeriesNUpdate(d,i,chartObj);var txtDec,filteredEle=d3_select(ele),fontClr=getClr$2(d.disabled,fontColor,itemDisabledOptions);d.disabled&&(legendComponent.highlightItem(ele,d,i,legendOptions,!1,!0),itemDisabledOptions.strikeout&&(txtDec="line-through")),filteredEle.selectAll(".legendlabel, .legendlabel *").styles({color:fontClr,"text-decoration":txtDec}),legend.setColorBoxBackground(legendFilter,chartObj,states),null==d3$1.event.touches&&("canvas"===chartObj.plot.renderer.mode&&legendComponent.highlightSeries(ele,d,i,legendOptions,chartObj),defaultOnMouseOverFunc(ele,d,i))}states.allSelected||(states.allSelected=!states.allSelected),selectAllFilter.empty()||(legData=legData||getLegendData$1(chartObj),selectAllFilter.html(isAllEnabled$1(legData,states.allSelected)?colorBoxOptions.text||"&#10003;":(itemDisabledOptions.colorBox||{}).text||""))},legendComponent.highlightItem=function(ele,d,i,legendOptions,onLegHover,strictApply){if(strictApply||!isDisabled$2(d,states.allSelected,states.isFirstClickAfterDeselection)){var hoverStyles=legendOptions.itemHoverStyle;if(defined(obj=hoverStyles)&&(0!==Object.keys(obj).length||obj.constructor!==Object)){var filteredEle=d3_select(ele),legendLabel=filteredEle.selectAll(".legendlabel"),backgroundColor=(onLegHover?legendOptions.itemHoverStyle:legendOptions).backgroundColor;filteredEle.style("background-color",backgroundColor),!onLegHover&&defined(legendOptions.showAs)&&legendLabel.html(getLegendShowAsText(d,i,legendOptions,chartObj)),applyFont(filteredEle.selectAll(onLegHover?".legendlabel, .legendlabel *":".legendlabel"),onLegHover?priorityArrayOnhover:priorityArray,!0)}}var obj},legendComponent.highlightSeries=function(ele,d,i,legendOptions,chartObj,onLegHover){if(chartObj.highlightContext=null,colorscale_helpers.isQuantileColorScale(chartObj)){var highlightObj=chartObj.legendHighlight,filterIndex=i;onLegHover?d.disabled||chartObj.seriesdata.forEach(function(d,j){highlightObj.highlightSelectedSeries(legendOptions,j,filterIndex),highlightObj.highlightUnselectedSeries(legendOptions,j,filterIndex)}):chartObj.seriesdata.forEach(function(d,j){highlightObj.reset(legendOptions,j,filterIndex,chartObj.seriesdata.length-1===j)})}else{highlightObj=chartObj.legendHighlight;onLegHover?d.disabled||(highlightObj.highlightSelectedSeries(legendOptions,i),highlightObj.highlightUnselectedSeries(legendOptions,i)):highlightObj.reset(legendOptions,i)}}};var brushComponent_Tooltip,SVGTooltip=function(options){this.chartObj=options.chartObj,this.config=options.config;var container=this.container=appendEle(options.container,"g",this.config.enabled?[1]:[],".","class","zc-svg-tooltip");container.style("pointer-events",NONE).style("display",NONE),this.boundBoxEle=appendEle(container,PATH_ELEMENT,[1]),this.textEle=appendEle(container,TEXT_ELEMENT,[1]),this.styleText(),this.styleBoundBox()};SVGTooltip.prototype.show=function(textContent,position){cancelAnimation(this.container),this.container.styles({opacity:NULL,display:NULL}),this.updateTextContent(textContent),this.positionTooltip(position),this.drawBoundBox()},SVGTooltip.prototype.hide=function(forced){this.container.transition().duration(forced?0:250).style("opacity",0).on("end",function(){d3_select(this).style("display",NONE)})},SVGTooltip.prototype.styleText=function(){var textEle=this.textEle,orient=this.config.orient,systemConf=this.chartObj.systemConf,isHorizontal=orient===TOP_ALIGN||orient===BOTTOM_ALIGN;applyFont(textEle,[this.config,systemConf.chart,systemConf.canvas,$ZCG]),textEle.attrs({"text-anchor":isHorizontal?"middle":orient===LEFT_ALIGN?"start":"end",dy:isHorizontal?orient===TOP_ALIGN?"0.9em":"-0.3em":"0.3em"})},SVGTooltip.prototype.styleBoundBox=function(){var config=this.config;this.boundBoxEle.styles({fill:config.backgroundColor,stroke:config.borderColor,"stroke-width":config.borderWidth})},SVGTooltip.prototype.updateTextContent=function(textContent){this.textEle.text(textContent)},SVGTooltip.prototype.positionTooltip=function(position){position&&this.container.attr("transform","translate("+position[0]+","+position[1]+")")},SVGTooltip.prototype.drawBoundBox=function(){var textBounds=this.textEle.nodes(),config=this.config,padding=config.padding,radius=getBorderRadius(config.borderRadius||0),count=0;this.boundBoxEle.attr("d",function(){var bb=bbox(textBounds[count++]);return getBoundBoxPathDescription(bb.x-padding,bb.y-padding,bb.width,bb.height,radius,padding,TOP_ALIGN,{},0)})},(brushComponent_Tooltip=function(brushComponent){var defaultOptions={orient:brushComponent.options.orient},options={chartObj:brushComponent.chartObj,config:mergeJSON(defaultOptions,brushComponent.options.brushOptions.slider.tooltip,!0),container:brushComponent.slider},tooltipObj=this.super=new SVGTooltip(options);this.container=tooltipObj.container,this.boundBoxEle=tooltipObj.boundBoxEle,this.textEle=tooltipObj.textEle,this.tooltipOptions=tooltipObj.config,this.brushComponent=brushComponent,this.count=0,this.positionTooltip(),this.addHoverEvents()}).prototype.show=function(){var self=this;self.super.show(function(){return self.getTextContent()}),self.brushComponent.chartObj.legend.component.highlightItem(NULL,!1,!0)},brushComponent_Tooltip.prototype.hide=function(forced){this.super.hide(forced)},brushComponent_Tooltip.prototype.positionTooltip=function(){var x,y,brushComponent=this.brushComponent,tooltipOptions=this.tooltipOptions,orient=brushComponent.options.orient,sliderBBox=bbox(brushComponent.slider.node()),padding=tooltipOptions.padding+tooltipOptions.margin;switch(orient){case BOTTOM_ALIGN:x=0,y=sliderBBox.y-padding;break;case RIGHT_ALIGN:x=sliderBBox.x-padding,y=0;break;case LEFT_ALIGN:x=sliderBBox.x+sliderBBox.width+padding,y=0;break;case TOP_ALIGN:x=0,y=sliderBBox.y+sliderBBox.height+padding}this.container.attr("transform","translate("+x+","+y+")")},brushComponent_Tooltip.prototype.addHoverEvents=function(){var onSelection=!0,self=this,mouseHandlers={mousemove:function(){"overlay"!==d3_select(d3$1.event.srcElement||d3$1.event.target).attr("class")?(self.show(),onSelection=!0):onSelection&&(self.hide(),onSelection=!1)},mouseleave:function(){self.hide(),onSelection=!1}};attachevents(self.brushComponent.context,mouseHandlers)},brushComponent_Tooltip.prototype.getTextContent=function(){var decimalCount,domainExtent,orient,brushComponent=this.brushComponent,chartObj=brushComponent.chartObj,labels=function(chartObj){var userRanges=chartObj.systemConf.legend.colorBand.ranges,isDiscrete=userRanges&&userRanges.length,filterRange=chartObj.systemConf.legend.filter.range,scale_domain=chartObj.axes.clr.scale.domain();if(isDiscrete){if(chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE){var range=filterRange||scale_domain;return[range[0],range[range.length-1]]}return filterRange?function(filterRange,userRanges){var start,end,filterRange_copy=[filterRange[0],filterRange[1]+1e-12],singleValueDomain=1===userRanges[0].length;return userRanges.forEach(function(d,i){d[0]<=filterRange_copy[0]&&(start=i),d[1===d.length?0:1]<=filterRange_copy[1]&&(end=i)}),isUndefined(start)?start=0:singleValueDomain&&start++,isUndefined(end)&&(end=userRanges.length-1),[userRanges[start],userRanges[end]]}(filterRange,userRanges):[userRanges[0],userRanges[userRanges.length-1]]}return filterRange||scale_domain}(chartObj),isHorizontal=(orient=brushComponent.options.orient)===TOP_ALIGN||orient===BOTTOM_ALIGN,reversed=legend_helpers.isReversedColorAxis(chartObj),columnInfo=chartObj.dataset.getColumn("clr"),datatype=columnInfo.datatype,formatConf=columnInfo[datatype];if(chartObj.dataset.getDataType("clr")===NUMERIC_DATATYPE){var colorbandOptions=chartObj.systemConf.legend.colorBand;if(!(colorbandOptions.ranges&&colorbandOptions.ranges.length)){var scale_domain=chartObj.axes.clr.scale.domain();domainExtent=[scale_domain[0],scale_domain[scale_domain.length-1]];var diff=mathAbs(domainExtent[1]-domainExtent[0]);if(diff){var hunds=Math.floor(Math.log(diff)/Math.LN10)-2;decimalCount=Math.abs(Math.min(hunds,0))}}}var index=isHorizontal?this.count:+!this.count;reversed&&(index=!index);var val=labels[index?labels.length-1:0];return this.count=!this.count,defined(decimalCount)&&-1===domainExtent.indexOf(val)&&(val=isArray(val)?val.map(function(d){return+d.toFixed(decimalCount)}):+val.toFixed(decimalCount)),getFormattedValue(formatConf,val,datatype,chartObj,"legend",UNDEFINED,"-")};var brushComponent=function(chartObj,options){this.chartObj=chartObj,this.options=options,this.isResizeInitiated=null;options.scale,options.orient;var container,slider,previousState,tooltipObj,dimension=options.dimension,isHorizontal="horizontal"===options.legendAlign.layout,component=this.component=(isHorizontal?d3_brushX:d3_brushY)(),previousExtent=options.initialExtent,maxExtent=[0,dimension[isHorizontal?0:1]],self=this,onClick=options.onClick;function positionSlider(extent){slider.attr("transform",function(d,i){return"translate("+(isHorizontal?extent[i]:0)+","+(isHorizontal?0:extent[i])+")"})}function renderBrush(extent){component.initialized=!1,d3$1.event.selection=extent,container.call(component.move,extent),component.initialized=!0,options.onBrush(component),positionSlider(extent)}component.on("brush",function(){if(self.updateTrackerBound(),component.initialized){var extent=d3$1.event.selection;extent[0]===extent[1]&&maxExtent.indexOf(extent[0])>-1?renderBrush(extent=self.resizeFilterRange(extent[0],maxExtent,!0)):(positionSlider(extent),options.onBrush(component),tooltipObj.show()),previousExtent=extent,previousState=d3$1.event.type}}).on("start",function(event){this.isResizeInitiated=!1,previousState=d3$1.event.type}).on("end",function(event){if(component.initialized){d3$1.event.selection=d3$1.event.selection||previousExtent;var sourceEvent=d3$1.event.sourceEvent,clicked="start"===previousState;if(clicked){var pt=getMousePosition(container.node(),d3$1.event)[isHorizontal?0:1];$Browser.FIREFOX&&(pt-=getTranslationFromOwnerSVGElement(container)[isHorizontal?0:1]),pt=mathMin(mathMax(pt,maxExtent[0]),maxExtent[1]),renderBrush("reposition"===onClick?self.repositionFilterRange(pt,previousExtent):self.resizeFilterRange(pt,previousExtent)),tooltipObj.show()}else container.node().contains&&container.node().contains(sourceEvent.srcElement||sourceEvent.target)||tooltipObj.hide();options.onEnd(component,clicked),previousExtent=d3$1.event.selection,previousState=d3$1.event.type}}),this.context||(this.context=container=appendEle(options.element||chartObj.svg,"g",options.brushOptions.enabled?[1]:[],".","class","brush",{"pointer-events":"visible"})),component.initialized=!1,component.extent([[0,0],dimension]),container.call(component),this.drawSlider(),slider=this.slider,positionSlider(options.initialExtent),tooltipObj=this.tooltipComponent=new brushComponent_Tooltip(this),container.call(component.move,options.initialExtent),component.initialized=!0,this.drawTracker(),container.selectAll("rect.selection").style("opacity",0)};brushComponent.prototype.repositionFilterRange=function(pt,previousExtent){var brushScale=this.options.scale,bandWidth=mathAbs(previousExtent[1]-previousExtent[0]),range=brushScale.range().sort(d3_ascending),extent=[pt-bandWidth/2,pt+bandWidth/2];return extent[1]>range[1]&&(extent[1]=range[1]-(brushScale.bandwidth?.1*bandWidth:0),extent[0]=extent[1]-bandWidth),extent[0]<range[0]&&(extent[0]=range[0]+(brushScale.bandwidth?.1*bandWidth:0),extent[1]=extent[0]+bandWidth),extent},brushComponent.prototype.resizeFilterRange=function(pt,previousExtent,outOfBound){var extent,dist1=mathAbs(previousExtent[0]-pt),dist2=mathAbs(previousExtent[1]-pt);if(outOfBound){extent=dist1<dist2?[previousExtent[0],pt+5e-5]:[pt-5e-5,previousExtent[1]]}else extent=dist1<dist2?[pt,previousExtent[1]]:[previousExtent[0],pt];return extent.sort(d3_ascending)};var Slider=function(options){this.chartObj=options.chartObj,this.config=options.config,this.container=options.container,this.type=options.type,this.isHorizontal=options.isHorizontal,this.bound=options.bound;var shadow=this.config.globalShadow!==UNDEFINED?this.config.globalShadow:this.config.shadow;shadow&&(this.filter=this.getFilter(shadow))};Slider.prototype.draw=function(){this.chartObj;var config=this.config,container=this.container,filterID=this.filter;switch(this.type){case"line":container.append(PATH_ELEMENT).attr("d",getSVGsymbol("vertical-line")(config.height)).styles({stroke:config.strokeColor,"stroke-width":config.strokeWidth});break;case"triangleUp":container.append(PATH_ELEMENT).attr("d",getSVGsymbol("triangle-down")(config.size)).styles({fill:config.fillColor,stroke:config.strokeColor,"stroke-width":config.strokeWidth});break;case"triangleDown":container.append(PATH_ELEMENT).attr("d",getSVGsymbol("triangle-up")(config.size)).styles({fill:config.fillColor,stroke:config.strokeColor,"stroke-width":config.strokeWidth});break;case"triangleUpDown":var padding=config.padding/2;container.append(PATH_ELEMENT).attr("d",getSVGsymbol("triangle-down")(config.size)).attr("transform","translate("+(this.isHorizontal?[0,-padding]:[-padding,0])+")").styles({fill:config.fillColor,stroke:config.strokeColor,"stroke-width":config.strokeWidth}),container.append(PATH_ELEMENT).attr("d",getSVGsymbol("triangle-up")(config.size)).attr("transform","translate("+(this.isHorizontal?[0,padding]:[padding,0])+")").styles({fill:config.fillColor,stroke:config.strokeColor,"stroke-width":config.strokeWidth});break;case"box":var strokeWidth=config.strokeWidth,w=config.width,h=config.height;container.append(PATH_ELEMENT).attr("d",roundedRect(-(w-strokeWidth)/2,-(h-strokeWidth)/2,w-strokeWidth,h-strokeWidth,getBorderRadius())).styles({stroke:config.strokeColor,"stroke-width":config.strokeWidth,fill:config.fillColor});break;case"enlarge":strokeWidth=config.strokeWidth;var range=config.range||1;w=config.width*range,h=config.height*range;container.append(PATH_ELEMENT).attr("d",roundedRect(-w/2,-h/2,w,h,getBorderRadius())).styles({fill:config.fillColor});break;case"lever":var r=getBorderRadius(config.radius);container.append(PATH_ELEMENT).attrs({d:roundedRect(-config.width/2,-config.height/2,config.width,config.height,r),filter:filterID}).styles({fill:config.fillColor,stroke:config.strokeColor}),container.append(PATH_ELEMENT).attr("d","M"+-config.stripePadding/2+" "+-config.stripeHeight/2+" L"+-config.stripePadding/2+" "+config.stripeHeight/2+" M"+config.stripePadding/2+" "+-config.stripeHeight/2+" L"+config.stripePadding/2+" "+config.stripeHeight/2).styles({stroke:config.stripeColor});break;case"hollowCircle":container.append(PATH_ELEMENT).attrs({d:getSVGsymbol()(config.size),filter:filterID}).styles({fill:config.outerFillColor,stroke:config.outerStrokeColor}),container.append(PATH_ELEMENT).attr("d",getSVGsymbol()(.4*config.size)).styles({fill:config.innerFillColor,stroke:config.outerStrokeColor});break;case"circle":container.append(PATH_ELEMENT).attrs({d:getSVGsymbol()(config.size),filter:filterID}).styles({fill:config.outerFillColor,stroke:config.outerStrokeColor,"stroke-width":config.outerStrokeWidth}),container.append(PATH_ELEMENT).attr("d",getSVGsymbol()(.3*config.size)).styles({fill:config.innerFillColor,stroke:config.outerStrokeColor});break;case"vernier":var nodes=container.nodes(),k1=d3_select(nodes[0]),k2=d3_select(nodes[1]),path1="M"+.5*-(w=config.width)+" "+.5*-(h=config.height)+" L"+.5*w+" "+.5*-h+" L"+.5*w+" "+.5*h+" L"+.5*-w+" "+.2*h+" Z",path2="M"+.5*-w+" "+.5*-h+" L"+.5*w+" "+.5*-h+" L"+.5*w+" "+.2*h+" L"+.5*-w+" "+.5*h+" Z";k1.append(PATH_ELEMENT).attr("d",path1),k2.append(PATH_ELEMENT).attr("d",path2),container.selectAll(PATH_ELEMENT).attr("filter",filterID).styles({fill:config.fillColor,stroke:config.strokeColor});break;case"pentagon":var size=config.size,bandWidth=config.bandWidth,path="M"+(.5*-size-bandWidth)+" "+(.5*-(h=config.height)-bandWidth)+" L"+(.5*size+bandWidth)+" "+(.5*-h-bandWidth)+" L"+(.5*size+bandWidth)+" "+.5*h+"L0 "+(.5*h+1.5*bandWidth+2)+" L"+(.5*-size-bandWidth)+" "+.5*h+"ZM"+.5*-size+" "+.5*-h+" L"+.5*size+" "+.5*-h+" L"+.5*size+" "+(.5*h-.5*bandWidth)+"L0 "+(.5*h+.5*bandWidth)+" L"+.5*-size+" "+(.5*h-.5*bandWidth)+"Z",innerBand="M"+.5*-size+" "+.5*-h+" L"+.5*size+" "+.5*-h+" L"+.5*size+" "+.5*h+" L"+.5*-size+" "+.5*h+"Z";container.append(PATH_ELEMENT).attr("d",innerBand),container.append(PATH_ELEMENT).attrs({d:path,filter:filterID}).styles({"fill-rule":"evenodd",fill:config.fillColor,stroke:config.strokeColor})}},brushComponent.prototype.drawSlider=function(){var chartObj=this.chartObj,options=this.options,container=this.context,isHorizontal="horizontal"===getLegendAlignment(chartObj.systemConf.legend).layout,dimension=options.dimension,sliderOptions=options.brushOptions.slider,type=sliderOptions.type,rotate=isHorizontal?"":" rotate(-90)",element=this.slider=appendEle(container,"g",isHorizontal?[{type:"w"},{type:"e"}]:[{type:"n"},{type:"s"}],".","class","handle--custom");element.attr("cursor",isHorizontal?"ew-resize":"ns-resize").selectAll("*").remove();var indicatorOptions={container:element,config:sliderOptions[type],type:type,chartObj:chartObj,isHorizontal:isHorizontal,bound:dimension,globalShadow:sliderOptions.shadow},SliderObj=new Slider(indicatorOptions);SliderObj.draw();var position=SliderObj.getPosition();element.selectAll(PATH_ELEMENT).attr("transform","translate("+position[0]+","+position[1]+")"+rotate)},brushComponent.prototype.drawTracker=function(){var options=this.options,container=this.context,trackOptions=options.brushOptions.track;container.selectAll("rect.overlay").styles({fill:trackOptions.fillColor,"fill-opacity":trackOptions.fillOpacity})},brushComponent.prototype.updateTrackerBound=function(){var desc,chartObj=this.chartObj,options=this.options,container=this.context,brushScale=options.scale,dimension=(options.orient,options.dimension),overlay=container.selectAll("rect.overlay"),start=[0,0],end=dimension,mid=d3$1.event.selection.slice(),isHorizontal="horizontal"===options.legendAlign.layout;if(brushScale.bandwidth){var bandWidth=brushScale.bandwidth();mid[0]-=mid[0]%bandWidth,mid[1]+=bandWidth-mid[1]%bandWidth}else options.singleDomainContinuous&&(mid[0]=start[isHorizontal?0:1],mid[1]=end[isHorizontal?0:1]);desc=isHorizontal?"M"+start[0]+" "+start[1]+"L"+mid[0]+" "+start[1]+"L"+mid[0]+" "+end[1]+"L"+start[0]+" "+end[1]+"ZM"+mid[1]+" "+start[1]+"L"+end[0]+" "+start[1]+"L"+end[0]+" "+end[1]+"L"+mid[1]+" "+end[1]+"Z":"M"+start[0]+" "+start[1]+"L"+end[0]+" "+start[1]+"L"+end[0]+" "+mid[0]+"L"+start[0]+" "+mid[0]+"ZM"+start[0]+" "+mid[1]+"L"+end[0]+" "+mid[1]+"L"+end[0]+" "+end[1]+"L"+start[0]+" "+end[1]+"Z";var class_Name="zcbrushhighlighttracker",ele=container.selectAll("path."+class_Name).data([1]);ele.enter().insert("path",":nth-child(2)").merge(ele).attr("class",class_Name),ele=container.selectAll("path."+class_Name);var midStart=mid[0]+1,midEnd=mid[1]-1,d=isHorizontal?"M"+midStart+" "+start[1]+"L"+midEnd+" "+start[1]+"L"+midEnd+" "+end[1]+"L"+midStart+" "+end[1]+"Z":"M"+start[0]+" "+midStart+"L"+start[0]+" "+midEnd+"L"+end[0]+" "+midEnd+"L"+end[0]+" "+midStart+"Z";ele.attr("d",d).styles({opacity:0,"stroke-width":0});var properties={name:"brush",id:chartObj.id,d:desc},args={chartObj:chartObj},clipID=effects.get(effects.svg_clips,"polygon",properties,args);overlay.attr("clip-path","url("+chartObj.defsLocation+"#"+clipID+")")};var MIN_VALUE=1e-12,legendBrush=function(chartObj,options){var brushScale,rangeBandBy2,brushScale_domain,initialExtent,previousExtent,singleDomainContinuous,position=options.position,dimension=legend_helpers.getColorBandDimension(chartObj),width=dimension[0],height=dimension[1],legendOptions=chartObj.systemConf.legend,colorbandOptions=legendOptions.colorBand,orient=legend_helpers.getOrient(legendOptions),legendAlignment=getLegendAlignment(legendOptions),datatype=chartObj.dataset.getDataType("clr"),userRanges=colorbandOptions.ranges,userRanges_length=userRanges&&userRanges.length,initialFilterRange=chartObj.systemConf.legend.filter.range,scaleObj=chartObj.axes.clr.scale,scale_domain=scaleObj.domain(),reversed=legend_helpers.isReversedColorAxis(chartObj),isHorizontal="horizontal"===legendAlignment.layout,range=isHorizontal?[0,width]:[height,0];if(reversed&&range.reverse(),userRanges_length)rangeBandBy2=(brushScale=d3_scaleOrdinal().domain(datatype===ORDINAL_DATATYPE?scale_domain:getRawRanges(chartObj)).range(range).padding(0)).bandwidth()/2;else{var domain=[scale_domain[0],scale_domain[scale_domain.length-1]];domain[0]===domain[1]&&(singleDomainContinuous=[-1,1],domain=[-MAX_SAFE_INTEGER,MAX_SAFE_INTEGER]),brushScale=d3_scaleLinear().domain(domain).range(range).clamp(!0)}if(brushScale_domain=brushScale.domain(),chartObj.axes.clr.brushScale=brushScale,userRanges_length){if(initialFilterRange)initialExtent=getExtentForOrdinalScale(initialFilterRange,brushScale,scale_domain,userRanges,datatype);else{var start=brushScale(brushScale_domain[brushScale_domain.length-1]),end=brushScale(brushScale_domain[0]);initialExtent=[start+rangeBandBy2-MIN_VALUE,end+rangeBandBy2+MIN_VALUE]}initialExtent.sort(d3_ascending)}else initialExtent=(initialExtent=initialFilterRange||singleDomainContinuous||brushScale.domain()).map(function(d){return brushScale(d)}).sort(d3_ascending);var brushOptions={element:chartObj.legendarea.element,orient:orient,legendAlign:legendAlignment,scale:brushScale,initialExtent:initialExtent,brushOptions:legendOptions.filter,dimension:dimension,singleDomainContinuous:singleDomainContinuous,onClick:"resize",onBrush:function(component){if(component.initialized&&!singleDomainContinuous){var extent=d3$1.event.selection;extent=function(extent,range){range[1]>range[0]?(extent[1]=mathMin(extent[1],range[1]),extent[0]=mathMax(extent[0],range[0])):(extent[1]=mathMax(extent[1],range[1]),extent[0]=mathMin(extent[0],range[0]));return extent}(extent,range),extent=userRanges_length?getDomainForOrdinalScale(extent,brushScale,scale_domain,userRanges,datatype,isHorizontal,reversed):extent.map(function(d){return brushScale.invert(d)}).sort(d3_ascending),chartObj.systemConf.legend.filter.range=extent,chartObj.legend.component.highlightItem(NULL,!1,!0),jsonStringify(extent)!==jsonStringify(previousExtent)&&chartObj.addRemoveSeries(),brushObj.slider.style("fill",function(d,i){return getColor(extent,i,isHorizontal,reversed,scaleObj)}),previousExtent=extent}},onEnd:function(component,forced){var new_extent;if(userRanges_length){var filterRange=chartObj.systemConf.legend.filter.range;new_extent=getExtentForOrdinalScale(filterRange,brushScale,scale_domain,userRanges,datatype)}else singleDomainContinuous&&(new_extent=singleDomainContinuous.map(function(d){return brushScale(d)}).sort(d3_ascending));if(new_extent){new_extent.sort(d3_ascending),component.initialized=!1;var sourceEvent=d3$1.event.sourceEvent;brushObj.context.transition().duration(forced?0:250).call(component.move,new_extent).on("end",function(){component.initialized=!0,brushObj.context.node().contains(sourceEvent.srcElement||sourceEvent.target)||brushObj.tooltipComponent.hide()}),brushObj.slider.transition().duration(forced?0:250).attr("transform",function(d,i){return"translate("+(isHorizontal?new_extent[i]:0)+","+(isHorizontal?0:new_extent[i])+")"})}}},brushObj=chartObj.legend.brush=new brushComponent(chartObj,brushOptions);brushObj.context.attr("transform","translate("+position[0]+","+position[1]+")"),brushObj.slider.style("fill",function(d,i){return getColor(userRanges_length?getDomainForOrdinalScale(initialExtent,brushScale,scale_domain,userRanges,datatype,isHorizontal,reversed):initialExtent.map(function(d){return brushScale.invert(d)}).sort(d3_ascending),i,isHorizontal,reversed,scaleObj)})};function getColor(extent,i,isHorizontal,reversed,scaleObj){var colorIndex=isHorizontal?[0,extent.length-1]:[extent.length-1,0];return reversed&&colorIndex.reverse(),scaleObj(extent[colorIndex[i]])}function getDomainForOrdinalScale(extent,brushScale,scale_domain,userRanges,datatype,isHorizontal,reversed){var startIndex,endIndex,brushScale_range=d3_values(brushScale.domain().map(function(d){return brushScale(d)})).sort(d3_ascending),brushScale_domain=brushScale.domain(),rangeBand=brushScale.bandwidth();brushScale_range.some(function(d,i){if(extent[0]>=d&&extent[0]<=d+rangeBand){var diff=extent[0]-d;startIndex=diff<=.5&&diff>=0?mathMax(i-1,0):i}if(extent[1]>=d&&extent[1]<=d+rangeBand){diff=d+rangeBand-extent[1];endIndex=diff<=.5&&diff>=0?mathMin(i+1,brushScale_range.length-1):i}return defined(startIndex)&&defined(endIndex)}),startIndex=mathMax(0,validateNullVal(startIndex,0)),endIndex=mathMax(0,validateNullVal(endIndex,brushScale_domain.length-1));var domain=brushScale_domain;if(datatype!==ORDINAL_DATATYPE&&1===userRanges[0].length&&(domain=function(scale_domain,domain){for(var min=scale_domain[2],max=scale_domain[scale_domain.length-1-2],pairs=[],i=0;i<domain.length;i++)pairs.push([min,domain[i][0]]),min=domain[i][0];return pairs.push(min,max),pairs}(scale_domain,domain)),!isHorizontal&&!reversed||isHorizontal&&reversed){var temp=startIndex;startIndex=brushScale_range.length-1-endIndex,endIndex=brushScale_range.length-1-temp}return domain=domain.slice(startIndex,endIndex+1,0),extent=datatype===ORDINAL_DATATYPE?domain:updateFilterRange(extent=d3_extent(d3_merge(domain)),scale_domain)}function getExtentForOrdinalScale(filterRange,brushScale,scale_domain,userRanges,datatype){var extent,rangeBandBy2=brushScale.bandwidth()/2;if(datatype===ORDINAL_DATATYPE)extent=[brushScale(filterRange[0])+rangeBandBy2,brushScale(filterRange[filterRange.length-1])+rangeBandBy2];else{var startIndex,endIndex,brushScale_domain=brushScale.domain();filterRange=updateFilterRange(filterRange,scale_domain),brushScale_domain.forEach(function(d,i){filterRange[0]>=d[0]&&(startIndex=1===userRanges[0].length?i+1:i),!defined(endIndex)&&filterRange[1]<=d[0]&&(endIndex=1===userRanges[0].length?i:i-1)}),startIndex=mathMax(0,validateNullVal(startIndex,0)),endIndex=mathMax(0,validateNullVal(endIndex,brushScale_domain.length-1)),extent=[brushScale(brushScale_domain[startIndex])+rangeBandBy2,brushScale(brushScale_domain[endIndex])+rangeBandBy2]}return extent[0]===extent[1]&&(extent[0]-=MIN_VALUE,extent[1]+=MIN_VALUE),extent}function updateFilterRange(filterRange,scale_domain){var array,value;return array=scale_domain,value=filterRange[1],array.indexOf(value)!==array.lastIndexOf(value)&&(filterRange[1]-=MIN_VALUE),filterRange}function drawTitle(element,chartObj){var systemConf=chartObj.systemConf,titleOptions=systemConf.legend.title,show=titleOptions.show,margin=getTitleMargin(systemConf),marginLeft=margin.left,marginRight=margin.right,marginTop=margin.top,marginBottom=margin.bottom;element.attr("transform",show?"translate("+marginLeft+","+marginTop+")":NULL);var title=appendEle(element,"text",show?[1]:[],".","class","legendtitle");applyFont(element,[titleOptions,systemConf.canvas,$ZCG]),title.text(decodeHTML(titleOptions.text)).attr("dy","0.91em"),show&&function(element,chartObj){var chartarea=chartObj.chartarea,legendOptions=chartObj.systemConf.legend,orient=legend_helpers.getOrient(legendOptions),margin=getTitleMargin(chartObj.systemConf),w=chartarea.width-legendOptions.marginLeft-legendOptions.marginRight,h=chartarea.height-legendOptions.marginTop-legendOptions.marginBottom,widthRatio=orient===TOP_ALIGN||orient===BOTTOM_ALIGN?ZC_LEGEND_maxWidthHoriRatio:ZC_LEGEND_maxWidthVertRatio,heightRatio=orient===TOP_ALIGN||orient===BOTTOM_ALIGN?ZC_LEGEND_maxHeightHoriRatio:ZC_LEGEND_maxHeightVertRatio,maxWidth=perToPx(legendOptions.maxWidth||widthRatio,w),maxHeight=perToPx(legendOptions.maxHeight||heightRatio,h),legBBox=bbox(chartObj.legendarea.element.node()),node=element.node(),bb=bbox(node),edge={left:legBBox.x+margin.left,top:legBBox.y+margin.top,right:legBBox.x+margin.left+maxWidth-margin.right,bottom:legBBox.y+margin.top+maxHeight-margin.bottom},textBound={left:0,top:0,width:bb.width,height:bb.height};trimText(node,node.textContent,textBound,edge,BOTTOM_ALIGN,"..",{left:5,right:5,top:5,bottom:5}),".."===node.textContent&&element.text("")}(title,chartObj);var bb=bbox(title.node());appendEle(element,"path",show?[1]:[],".","class","zchart-legend-title-background").attr("d",roundedRect(bb.x-marginLeft,bb.y-marginTop,bb.width+marginLeft+marginRight,bb.height+marginTop+marginBottom,getBorderRadius(0))).style("opacity",0)}function getAxisGroupPosition(systemConf,colorAxisOptions,orient,hAlign,vAlign,axisGroupBBox,titleBBox,minmaxlabelsBBox,axisGroupTranslate){var align=colorAxisOptions.minmaxlabels.align,axisGroupPosition=[];return axisGroupPosition[0]=orient===LEFT_ALIGN?align===RIGHT_ALIGN?axisGroupBBox.width:mathMax(axisGroupBBox.width,align===LEFT_ALIGN?minmaxlabelsBBox.width:minmaxlabelsBBox.width/2):orient===RIGHT_ALIGN?align===RIGHT_ALIGN?axisGroupTranslate[0]:align===LEFT_ALIGN?axisGroupTranslate[0]+minmaxlabelsBBox.width:axisGroupTranslate[0]+minmaxlabelsBBox.width/2:align===TOP_ALIGN||align===BOTTOM_ALIGN?axisGroupTranslate[0]:axisGroupTranslate[0]-minmaxlabelsBBox.x,axisGroupPosition[1]=titleBBox.height,orient===LEFT_ALIGN||orient===RIGHT_ALIGN?axisGroupPosition[1]-=mathMin(0,minmaxlabelsBBox.y):orient===BOTTOM_ALIGN&&align===TOP_ALIGN&&(axisGroupPosition[1]+=minmaxlabelsBBox.height),axisGroupPosition[1]+=orient===TOP_ALIGN?axisGroupBBox.height:axisGroupTranslate[1],axisGroupPosition=function(axisGroupPosition,axislineOptions,orient){var adjust=(axislineOptions.show?validateNullVal(axislineOptions.strokeWidth,1):0)-.5;orient===LEFT_ALIGN?axisGroupPosition[0]-=adjust:orient===RIGHT_ALIGN?axisGroupPosition[0]+=adjust:orient===BOTTOM_ALIGN?axisGroupPosition[1]+=adjust:axisGroupPosition[1]-=adjust;return axisGroupPosition}(axisGroupPosition,colorAxisOptions.axisline,orient)}function getTitleMargin(systemConf){var titleOptions=systemConf.legend.title,margin=0;return titleOptions.show&&(margin=defined(titleOptions.margin)?titleOptions.margin:3),parseShortHandValue(margin)}function translateGroupsNgetInfo(axisGroup,bandGroup,title,chartObj,colorAxisOptions,hAlign,vAlign,axisGroupTranslate,strokeWidth){chartObj.systemConf;var titleBBox=bbox(title.node()),orient=legend_helpers.getOrient(chartObj.systemConf.legend),axisGroupBBox=function(orient,axisGroup){var selection=axisGroup.selectAll("g.zchart-minmaxlabels,line.majorTicks");selection.style("display",NONE);var axisGroupBBox=simpleClone(bbox(axisGroup.node()));return selection.style("display",null),axisGroupBBox}(0,axisGroup),minmaxlabelsBBox=bbox(axisGroup.selectAll("g.zchart-minmaxlabels").node()),bandGroupPosition=function(systemConf,minmaxlabelsOptions,orient,hAlign,vAlign,axisGroupBBox,titleBBox,minmaxlabelsBBox){var align=minmaxlabelsOptions.align,bandGroupPosition=[];return bandGroupPosition[0]=orient===LEFT_ALIGN?align===RIGHT_ALIGN?axisGroupBBox.width:mathMax(axisGroupBBox.width,align===LEFT_ALIGN?minmaxlabelsBBox.width:minmaxlabelsBBox.width/2):orient===RIGHT_ALIGN?align===RIGHT_ALIGN?0:align===LEFT_ALIGN?minmaxlabelsBBox.width:minmaxlabelsBBox.width/2:align===TOP_ALIGN||align===BOTTOM_ALIGN?0:-minmaxlabelsBBox.x,bandGroupPosition[1]=titleBBox.height,orient===LEFT_ALIGN||orient===RIGHT_ALIGN?bandGroupPosition[1]-=mathMin(0,minmaxlabelsBBox.y):orient===BOTTOM_ALIGN&&align===TOP_ALIGN&&(bandGroupPosition[1]+=minmaxlabelsBBox.height),orient===TOP_ALIGN&&(bandGroupPosition[1]+=axisGroupBBox.height),bandGroupPosition}(0,colorAxisOptions.minmaxlabels,orient,0,0,axisGroupBBox,titleBBox,minmaxlabelsBBox),axisGroupPosition=getAxisGroupPosition(0,colorAxisOptions,orient,0,0,axisGroupBBox,titleBBox,minmaxlabelsBBox,axisGroupTranslate);return function(orient,strokeWidth,bandGroupPosition,axisGroupPosition){orient===TOP_ALIGN?bandGroupPosition[1]+=strokeWidth:orient===BOTTOM_ALIGN?axisGroupPosition[1]+=strokeWidth:orient===LEFT_ALIGN?bandGroupPosition[0]+=strokeWidth:axisGroupPosition[0]+=strokeWidth}(orient,strokeWidth,bandGroupPosition,axisGroupPosition),bandGroup.attr("transform","translate("+bandGroupPosition[0]+","+bandGroupPosition[1]+")"),axisGroup.attr("transform","translate("+axisGroupPosition[0]+","+axisGroupPosition[1]+")"),{axisGroupPosition:axisGroupPosition,bandGroupPosition:bandGroupPosition}}function getDefaultSliderOptions(chartObj){var legendOptions=chartObj.systemConf.legend,userRanges=legendOptions.colorBand.ranges,dimension=legend_helpers.getColorBandDimension(chartObj),isHorizontal="horizontal"===getLegendAlignment(legendOptions).layout;return{line:{strokeColor:"grey",strokeWidth:2,height:dimension[isHorizontal?1:0]+20},triangleUp:{size:15,fillColor:"#4C4C4C"},triangleDown:{size:15,fillColor:"#4C4C4C"},triangleUpDown:{size:15,fillColor:"#4C4C4C",padding:dimension[isHorizontal?1:0]+15},box:{strokeWidth:1,strokeColor:"black",fillColor:"transparent",height:dimension[isHorizontal?1:0],width:userRanges&&userRanges.length?dimension[isHorizontal?0:1]/userRanges.length:10},enlarge:{range:1.2,height:dimension[isHorizontal?1:0],width:userRanges&&userRanges.length?dimension[isHorizontal?0:1]/userRanges.length:10},lever:{height:26,width:9,radius:2,stripeHeight:8,stripePadding:2,fillColor:"white",strokeColor:"#DADADA",stripeColor:"#DADADA",shadow:"0 0 2px rgba(0,0,0,0.2)"},hollowCircle:{size:25,outerFillColor:"white",outerStrokeColor:"#DADADA",innerStrokeColor:"#DADADA",shadow:"0 0 2px rgba(0,0,0,0.2)"},circle:{size:25,outerStrokeColor:"white",outerStrokeWidth:2,innerFillColor:"white",shadow:"0 0 2px rgba(0,0,0,0.2)"},vernier:{height:26,width:9,fillColor:"white",strokeColor:"#DADADA",shadow:"0 0 2px rgba(0,0,0,0.2)"},pentagon:{size:8,bandWidth:3,fillColor:"white",strokeColor:"#DADADA",shadow:"0 0 2px rgba(0,0,0,0.2)",height:dimension[isHorizontal?1:0]}}}legend.continuous=function(){},legend.continuous.get=function(){var chartObj,systemConf,color,chartarea,dispatch=d3_dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout"),getLegendData=legend_helpers.getLegendData,getLegendDataLength=legend_helpers.getLegendDataLength;function chart(selection){return selection.each(function(data){var legBBox,legData=getLegendData(chartObj),legendOptions=(getLegendDataLength(chartObj,legData),chartObj.systemConf.legend),colorbandOptions=legendOptions.colorBand,colorAxisOptions=function(legendOptions){var defaultColorAxisOptions={label:{},grid:{color:TRANSPARENT},ticklabel:{fontColor:legendOptions.fontColor,fontFamily:legendOptions.fontFamily,fontSize:legendOptions.fontSize,fontStyle:legendOptions.fontStyle,fontWeight:legendOptions.fontWeight,tooltip:legendOptions.tooltip},minmaxlabels:{padding:2,align:"center",fontSize:legendOptions.fontSize},tickmark:{color:"#B0B0B0",size:3},axisline:{show:!1}},colorAxisOptions=legendOptions.colorAxis||{};return colorAxisOptions=mergeJSON(defaultColorAxisOptions,colorAxisOptions,!0)}(legendOptions),floating=defined(legendOptions.x)&&defined(legendOptions.y),legendAlign=getLegendAlignment(legendOptions),hAlign=legendAlign.hAlign,vAlign=legendAlign.vAlign,strokeWidth=validateNullVal(colorbandOptions.strokeWidth,1)/2,padding=parseShortHandValue(colorbandOptions.padding),hideAxis=!1===colorAxisOptions.show,container=d3_select(this),background=appendEle(container,"path",[1],".","class","zchart-background"),title=appendEle(container,"g",[1],".","class","zcheader"),bandGroup=appendEle(container,"path",[1],".","class","colorband"),axisGroup=appendEle(container,"g",hideAxis?[]:[1],".","class","legend-axis");background.style("display",NONE),container.selectAll(".brush,.highlight").style("display",NONE),drawTitle(title,chartObj),legend.colorBand(bandGroup,chartObj),legend.colorAxis(axisGroup,chartObj,colorAxisOptions);var axisGroupTranslate=hideAxis?[0,0]:getSvgTransform(axisGroup).translate,info=translateGroupsNgetInfo(axisGroup,bandGroup,title,chartObj,colorAxisOptions,hAlign,vAlign,axisGroupTranslate,strokeWidth),position=getLegendPositionWithPadding();hideAxis||(legend.colorAxis.handleOverlapNOverlap(axisGroup,info.axisGroupPosition,position,chartObj,chartarea,colorAxisOptions),info=translateGroupsNgetInfo(axisGroup,bandGroup,title,chartObj,colorAxisOptions,hAlign,vAlign,axisGroupTranslate,strokeWidth),drawTitle(title,chartObj),position=getLegendPositionWithPadding()),container.selectAll(".brush,.highlight").style("display",NULL);new legendBrush(chartObj,{position:info.bandGroupPosition});function getLegendPositionWithPadding(){var position=getLegendPosition(chartarea,chartObj);return floating?[position[0]-padding.left,position[1]+padding.top]:(hAlign===RIGHT_ALIGN?position[0]-=padding.right:hAlign===LEFT_ALIGN&&(position[0]+=padding.right),vAlign===BOTTOM_ALIGN?position[1]-=padding.bottom:vAlign===TOP_ALIGN&&(position[1]+=padding.top),position)}legend.continuous.events(chartObj,{position:info.bandGroupPosition}),position=getLegendPositionWithPadding(),container.attr("transform","translate("+position[0]+","+position[1]+")"),legBBox=bbox(container.node()),function(element,chartObj,legBBox){var legendOptions=chartObj.systemConf.legend,backgroundOptions=legendOptions.background,padding=parseShortHandValue(legendOptions.colorBand.padding),borderOptions=legendOptions.border,showBorder=borderOptions.show,strokeWidth=pick(borderOptions.strokeWidth,1),strokeDashArray=getDashArray(borderOptions.style,strokeWidth),strokeLineCap=getLineCap(borderOptions.lineCap,borderOptions.style),borderRadius=getBorderRadius(showBorder?borderOptions.radius:void 0);element.attrs({d:roundedRect(legBBox.x-padding.left,legBBox.y-padding.top,legBBox.width+padding.left+padding.right,legBBox.height+padding.top+padding.bottom,borderRadius)}).styles({stroke:borderOptions.color,"stroke-width":showBorder?borderOptions.size:0,"stroke-dasharray":strokeDashArray,"stroke-linecap":strokeLineCap,fill:backgroundOptions.color||TRANSPARENT,"fill-opacity":backgroundOptions.alpha})}(background,chartObj,legBBox),background.style("display",null),chartObj.filterEffectsID&&!1!==data.useChartEffect&&container.style("filter",chartObj.filterEffectsID?"url(#"+chartObj.filterEffectsID+")":null)}),chart}return chart.dispatch=dispatch,chart.chartarea=function(_){return arguments.length?(chartarea=_,chart):chartarea},chart.systemconf=function(_){return arguments.length?(systemConf=_,chart):systemConf},chart.chartObj=function(_){return arguments.length?(chartObj=_,chart):chartObj},chart.color=function(_){return arguments.length?(color=_,chart):color},chart},Slider.prototype.getPosition=function(){var config=this.config,type=this.type,isHorizontal=this.isHorizontal,dimension=this.bound,width=dimension[0],height=dimension[1],position=[0,0],place=isHorizontal?1:0,side=isHorizontal?height:width;switch(type){case"lever":case"vernier":case"pentagon":case"hollowCircle":case"circle":case"box":case"enlarge":case"triangleUpDown":case"line":position[place]=side/2;break;case"triangleUp":position[place]=-config.size/2;break;case"triangleDown":position[place]=side+config.size/2}return position},Slider.prototype.getFilter=function(shadow){var parsedShadowOptions=shadow.split(" "),shadowOptions={dx:parseFloat(parsedShadowOptions[0]),dy:parseFloat(parsedShadowOptions[1]),color:parsedShadowOptions[3],blur:parseFloat(parsedShadowOptions[2]),x:"-50%",y:"-50%",width:"200%",height:"200%"},id=effects.get(effects.svg_filters,"dropShadow",shadowOptions,{chartObj:this.chartObj});return id="url("+this.chartObj.defsLocation+"#"+id+")"},legend.continuous.slider=function(chartObj,wrap){var container=appendEle(wrap,"g",[1],".","class","slider"),legendOptions=chartObj.systemConf.legend,itemHoverStyleOptions=legendOptions.itemHoverStyle||{},dimension=legend_helpers.getColorBandDimension(chartObj),isHorizontal="horizontal"===getLegendAlignment(legendOptions).layout,rotate=isHorizontal?"":" rotate(-90)",type=itemHoverStyleOptions.type,sliderOptions={container:container,config:mergeJSON(getDefaultSliderOptions(chartObj)[type],itemHoverStyleOptions[type],!0),type:type,chartObj:chartObj,isHorizontal:isHorizontal,bound:dimension};container.selectAll("*").remove();var SliderObj=new Slider(sliderOptions);SliderObj.draw();var position=SliderObj.getPosition();return container.selectAll(PATH_ELEMENT).attr("transform",function(){var curTranslate=getSvgTransform(this).translate;return"translate("+(curTranslate[0]+position[0])+","+(curTranslate[1]+position[1])+")"+rotate}),SliderObj},legend.continuous.tooltip=function(chartObj,container){var legendOptions=chartObj.systemConf.legend,itemHoverStyleOptions=legendOptions.itemHoverStyle||{},orient=legend_helpers.getOrient(legendOptions),defaultOptions={enabled:!0,padding:5,margin:5,backgroundColor:"white",borderColor:"rgb(51, 51, 51)",fontColor:"rgb(51, 51, 51)",fontSize:chartObj.globalProp.fontL1Size.l5,orient:orient},options={chartObj:chartObj,config:mergeJSON(defaultOptions,itemHoverStyleOptions.tooltip,!0),container:container},position=function(){var x,y,node=chartObj.legend.highlight.slider.container.selectAll("path").node(),trans=node?getSvgTransform(node).translate:[0,0],bb=bbox(node),config=options.config,padding=config.padding+config.margin;switch(orient){case BOTTOM_ALIGN:x=0,y=bb.y-padding;break;case RIGHT_ALIGN:x=bb.y-padding,y=0;break;case LEFT_ALIGN:x=bb.y+bb.height+padding,y=0;break;case TOP_ALIGN:x=0,y=bb.y+bb.height+padding}return[x+trans[0],y+trans[1]]}(),tooltipObj=new SVGTooltip(options);return tooltipObj.container.attr("transform","translate("+position[0]+","+position[1]+")"),tooltipObj},legend.continuous.ZC_brushComponent_getDefaultOptions=function(chartObj){var colorbandOptions=chartObj.systemConf.legend.colorBand,dataType=chartObj.dataset.getDataType("clr"),trackOptions={fillColor:TRANSPARENT},sliderOptions={type:"lever",shadow:"0 0 2px rgba(0,0,0,0.2)",tooltip:{enabled:!(colorbandOptions.ranges&&colorbandOptions.ranges.length||dataType===ORDINAL_DATATYPE),padding:5,margin:5,backgroundColor:"white",borderColor:"rgb(51, 51, 51)",fontColor:"rgb(51, 51, 51)",fontSize:chartObj.globalProp.fontL1Size.l5}};return{track:trackOptions,slider:mergeJSON(getDefaultSliderOptions(chartObj),sliderOptions,!0)}},legend.continuous.events=function(chartObj,options){chartObj.legend.highlight={};var eventDisabled,highlightedItem,previousHighlightedItem,position=options.position,legendComponent=chartObj.legend.component,legendOptions=chartObj.systemConf.legend,itemHoverStyle=legendOptions.itemHoverStyle||{},element=chartObj.legendarea.element.selectAll(legendOptions.filter.enabled?".selection":".colorband"),highlightTrackerElement=chartObj.legendarea.element.selectAll(".zcbrushhighlighttracker"),isHorizontal="horizontal"===getLegendAlignment(legendOptions).layout,highlightElement=appendEle(chartObj.legendarea.element,"g",[1],".","class","highlight").style("display",NULL),indicatorObj=chartObj.legend.highlight.slider=legend.continuous.slider(chartObj,highlightElement),tooltipObj=chartObj.legend.highlight.tooltip=legend.continuous.tooltip(chartObj,highlightElement),events_legend=(indicatorObj.container,legendOptions.events);if(highlightElement.style("display",NONE).style("opacity",0),events_legend&&(eventDisabled=0==validateNullVal(events_legend.enabled,!0)),!eventDisabled&&itemHoverStyle.type&&itemHoverStyle.type!==NONE){var eventAttacherOptions={chartObj:chartObj},mouseHandlers={mousemove:function(){var mouse=getMousePosition((legendOptions.filter.enabled?highlightTrackerElement:element).node(),d3.event),pt=isHorizontal?mouse[0]:mouse[1];$Browser.FIREFOX&&(pt-=getTranslationFromOwnerSVGElement(chartObj.legend.brush.context.node()||chartObj.legendarea.element)[isHorizontal?0:1]);highlightedItem=function(mousePt){var userRanges=legendOptions.colorBand.ranges,itemHoverStyle=legendOptions.itemHoverStyle||{},brushScale=chartObj.axes.clr.brushScale;if(userRanges&&userRanges.length){var reversed=legendOptions.colorAxis&&legendOptions.colorAxis.reversed,bandWidth=brushScale.bandwidth(),index=pInt(mousePt/bandWidth);return index=isHorizontal&&reversed||!isHorizontal&&!reversed?userRanges.length-1-index:index}var clrScaleDomain=chartObj.axes.clr.scale.domain();if(clrScaleDomain[0]===clrScaleDomain[1])return clrScaleDomain;var triggerOffset=validateNullVal(itemHoverStyle.triggerOffset,10),min=brushScale.invert(mousePt-triggerOffset/2),max=brushScale.invert(mousePt+triggerOffset/2),diff=mathAbs(max-min),power=mathFloor(+(mathLog(diff)/mathLN10).toFixed(2)),magnitude=mathPow(10,power),base=mathFloor(brushScale.invert(mousePt)/magnitude)*magnitude;return[base=+base.toFixed(12),base+magnitude-1e-12]}(pt),d3.event.stopImmediatePropagation(),chartObj.legend.brush.tooltipComponent.hide(!0),legendComponent.highlightItem(pt,!0),legendComponent.highlightSeries(highlightedItem,!0)},mouseout:function(ele,d,i){legendComponent.highlightItem(NULL,!1),legendComponent.highlightSeries(previousHighlightedItem,!1)}},touchHandlers=NULL;attachevents(element,mouseHandlers,touchHandlers,eventAttacherOptions,"highlight"),attachevents(highlightTrackerElement,mouseHandlers,touchHandlers,eventAttacherOptions,"highlight")}legendComponent.highlightItem=function(point,onLegHover,forced,item){element.style("cursor",onLegHover?POINTER:NULL),onLegHover?(function(point){var clr,userRanges=legendOptions.colorBand.ranges,reversed=legendOptions.colorAxis&&legendOptions.colorAxis.reversed,brushScale=chartObj.axes.clr.brushScale;if(userRanges&&userRanges.length){var bandWidth=brushScale.bandwidth(),index=pInt(point/bandWidth);index=isHorizontal&&reversed||!isHorizontal&&!reversed?userRanges.length-1-index:index,point=brushScale(userRanges[index])+bandWidth/2,clr=chartObj.seriesColor[index%chartObj.seriesColor.length]}else clr=chartObj.axes.clr.scale(brushScale.invert(point));var trans=isHorizontal?[point,0]:[0,point];trans[0]+=position[0],trans[1]+=position[1],cancelAnimation(highlightElement),chartObj.legendarea.element.selectAll(".highlight").style("fill",clr),highlightElement.style("display",NULL).style("opacity",1).attr("transform","translate("+trans+")")}(point),function(item){var userRanges=legendOptions.colorBand.ranges,columnInfo=chartObj.dataset.getColumn("clr"),datatype=columnInfo.datatype,formatConf=columnInfo[datatype],value=userRanges&&userRanges.length?userRanges[item]:item[0];tooltipObj.show(getFormattedValue(formatConf,value,datatype,chartObj,"legend",UNDEFINED,"-"))}(defined(item)?item:highlightedItem)):function(forced){forced?highlightElement.style("opacity",0):highlightElement.transition().style("opacity",0)}(forced)},legendComponent.highlightSeries=function(highlightedItem,onLegHover){chartObj.highlightContext=NULL;var highlightObj=chartObj.legendHighlight;if(onLegHover){if(defined(previousHighlightedItem)&&jsonStringify(previousHighlightedItem)!==jsonStringify(highlightedItem)){var temp=previousHighlightedItem;previousHighlightedItem=NULL,legendComponent.highlightSeries(temp,!1)}chartObj.seriesdata.forEach(function(d,j){highlightObj.highlightSelectedSeries(legendOptions,j,highlightedItem),highlightObj.highlightUnselectedSeries(legendOptions,j,highlightedItem)}),previousHighlightedItem=highlightedItem}else chartObj.seriesdata.forEach(function(d,j){highlightObj.reset(legendOptions,j,highlightedItem,chartObj.seriesdata.length-1===j)})}};legend.continuous.events;legend.colorBand=function(element,chartObj){var gradient_x1,gradient_x2,gradient_y1,gradient_y2,legendOptions=chartObj.systemConf.legend,colorbandOptions=legendOptions.colorBand,dimension=legend_helpers.getColorBandDimension(chartObj),width=dimension[0],height=dimension[1],isHorizontal="horizontal"===getLegendAlignment(legendOptions).layout,userRanges_length=colorbandOptions.ranges&&colorbandOptions.ranges.length,reversed=legend_helpers.isReversedColorAxis(chartObj),borderRadius=getBorderRadius(colorbandOptions.borderRadius);reversed?(gradient_x1=isHorizontal?100:0,gradient_y2=isHorizontal?0:100):(gradient_x2=isHorizontal?100:0,gradient_y1=isHorizontal?0:100);var scale_domain,scale_range,offsetScale,scaleObj=chartObj.axes.clr.scale;if(userRanges_length){scale_range=scaleObj.range().filter(function(d){return d!==NULL});for(var temp_domain=[],temp_range=[],i=0;i<userRanges_length;i++)temp_domain.push(i,i+1),temp_range.push(scale_range[i],scale_range[i]);scale_domain=temp_domain,scale_range=temp_range,offsetScale=d3_scalePoint().domain(scale_domain).range([0,100])}else scale_domain=scaleObj.domain(),scale_range=scaleObj.range(),scale_domain[0]===scale_domain[1]&&(scale_range=[scale_range[0],scale_range[0]]),offsetScale=d3_scaleLinear().domain([scale_domain[0],scale_domain[scale_domain.length-1]]).range([0,100]);var prop=getGradientProp({type:"linear",options:{linear:{x1:gradient_x1,y1:gradient_y1,x2:gradient_x2,y2:gradient_y2,stopColor:scale_range,stopOffset:scale_domain.map(function(d){return offsetScale(d)+"%"})}}},[0,width]),args={chartObj:chartObj},gradientEle=effects.get(effects.svg_gradients,"svgGradientFill",prop,args);element.attr("d",roundedRect(0,0,width,height,borderRadius)).styles({stroke:colorbandOptions.strokeColor,"stroke-opacity":colorbandOptions.strokeOpacity,"stroke-width":colorbandOptions.strokeWidth,"fill-opacity":colorbandOptions.fillOpacity,fill:"url("+chartObj.defsLocation+"#"+gradientEle+")","pointer-events":"visible"})};var ZC_legend_minmaxLabels=function(element,dimension,axisOptions,chartObj,orient){var systemConf=chartObj.systemConf,minmaxlabelsOptions=axisOptions.minmaxlabels,legendOptions=chartObj.systemConf.legend,colorbandOptions=legendOptions.colorBand,legendAlign=getLegendAlignment(legendOptions),sliderSize=legendOptions.filter.enabled?function(sliderOptions,dimension,orient,legendAlign){var type=sliderOptions.type,options=sliderOptions[type],isHorizontal="horizontal"===legendAlign.layout;return"triangleUp"===type||"triangleDown"===type?[0,0]:"lever"===type||"vernier"===type?[options.width,options.height]:"pentagon"===type?[options.size+2*options.bandWidth,dimension[isHorizontal?1:0]+1.5*options.bandWidth+2]:[options.size,options.size]}(legendOptions.filter.slider,dimension,0,legendAlign):[0,0],padding=validateNullVal(minmaxlabelsOptions.padding,2),align=minmaxlabelsOptions.align,userLabels=minmaxlabelsOptions.text,isDiscrete=colorbandOptions.ranges&&colorbandOptions.ranges.length,reversed=legend_helpers.isReversedColorAxis(chartObj),data=[],columnInfo=chartObj.dataset.getColumn("clr"),datatype=columnInfo.datatype,formatConf=columnInfo[datatype];if(minmaxlabelsOptions.show)if(isDiscrete){var ranges=getRawRanges(chartObj);data=[ranges[0][0],ranges[ranges.length-1][ranges[ranges.length-1].length-1]]}else{var scale_domain=chartObj.axes.clr.scale.domain();data=[scale_domain[0],scale_domain[scale_domain.length-1]]}reversed&&data.reverse();var labels=appendEle(appendEle(element,"g",[1],".","class","zchart-minmaxlabels"),"text",data);labels.each(function(d,i){var pos=function(orient,dimension,align,padding,sliderSize,i){var x,y,dy,ANCHOR;orient===BOTTOM_ALIGN?align===TOP_ALIGN?(dy="-0.3em",ANCHOR=0===i?null:"end",y=-dimension[1]-padding-mathMax(0,(sliderSize[1]-dimension[1])/2),x=0===i?0:dimension[0]):align===BOTTOM_ALIGN?(dy="1em",ANCHOR=0===i?null:"end",y=padding+mathMax(0,(sliderSize[1]-dimension[1])/2),x=0===i?0:dimension[0]):(dy="0.3em",ANCHOR=0===i?"end":null,y=-dimension[1]/2,x=0===i?-padding-sliderSize[0]/2:dimension[0]+padding+sliderSize[0]/2):orient===TOP_ALIGN?align===TOP_ALIGN?(dy="-0.3em",ANCHOR=0===i?null:"end",y=-padding-mathMax(0,(sliderSize[1]-dimension[1])/2),x=0===i?0:dimension[0]):align===BOTTOM_ALIGN?(dy="1em",ANCHOR=0===i?null:"end",y=dimension[1]+padding+mathMax(0,(sliderSize[1]-dimension[1])/2),x=0===i?0:dimension[0]):(dy="0.3em",ANCHOR=0===i?"end":null,y=dimension[1]/2,x=0===i?-padding-sliderSize[0]/2:dimension[0]+padding+sliderSize[0]/2):orient===RIGHT_ALIGN?align===LEFT_ALIGN?(dy=0!==i?"1em":"-0.3em",ANCHOR="end",x=-dimension[0]-padding-mathMax(0,(sliderSize[1]-dimension[0])/2),y=0!==i?0:dimension[1]):align===RIGHT_ALIGN?(dy=0!==i?"1em":"-0.3em",ANCHOR=null,x=padding+mathMax(0,(sliderSize[1]-dimension[0])/2),y=0!==i?0:dimension[1]):(dy=0!==i?"-0.3em":"1em",ANCHOR="middle",x=-dimension[0]/2,y=0!==i?-padding-sliderSize[0]/2:dimension[1]+padding+sliderSize[0]/2):align===LEFT_ALIGN?(dy=0!==i?"1em":"-0.3em",ANCHOR="end",x=-padding-mathMax(0,(sliderSize[1]-dimension[0])/2),y=0!==i?0:dimension[1]):align===RIGHT_ALIGN?(dy=0!==i?"1em":"-0.3em",ANCHOR=null,x=dimension[0]+padding+mathMax(0,(sliderSize[1]-dimension[0])/2),y=0!==i?0:dimension[1]):(dy=0!==i?"-0.3em":"1em",ANCHOR="middle",x=dimension[0]/2,y=0!==i?-padding-sliderSize[0]/2:dimension[1]+padding+sliderSize[0]/2);return{x:x,y:y,dy:dy,anchor:ANCHOR}}(orient,dimension,align,padding,sliderSize,i);d3_select(this).attrs({x:pos.x,y:pos.y,"text-anchor":pos.anchor,dy:pos.dy}).text(userLabels?userLabels[i]:getFormattedValue(formatConf,d,datatype,chartObj,"minmaxlabels"))}),applyFont(labels,[minmaxlabelsOptions,systemConf.chart,systemConf.canvas,$ZCG])};function getMinmaxLabelBound(element,axisGroupPosition,position,parentPos){parentPos=parentPos||[0,0];var bb=bbox(element),pos={x1:bb.x+axisGroupPosition[0]+position[0]+parentPos[0],y1:bb.y+axisGroupPosition[1]+position[1]+parentPos[1],width:bb.width,height:bb.height};return pos.x2=pos.x1+bb.width,pos.y2=pos.y1+bb.height,pos}function getAvailableLegendBound(chartObj,chartarea){var legendOptions=chartObj.systemConf.legend,orient=legend_helpers.getOrient(legendOptions),hAlign=getLegendAlignment(legendOptions).hAlign,w=chartarea.width-legendOptions.marginLeft-legendOptions.marginRight,h=chartarea.height-legendOptions.marginTop-legendOptions.marginBottom,l=chartarea.left+legendOptions.marginLeft,t=chartarea.top+legendOptions.marginTop,maxDimension=getDefaultLegendMaxDimension(legendOptions),widthRatio=maxDimension.width,heightRatio=maxDimension.height,maxWidth=perToPx(legendOptions.maxWidth||widthRatio,w),maxHeight=perToPx(legendOptions.maxHeight||heightRatio,h),bound={};return orient===BOTTOM_ALIGN?(bound.y1=t+h-maxHeight,bound.x1=hAlign===LEFT_ALIGN?l:hAlign===RIGHT_ALIGN?l+w-maxWidth:l+(w-maxWidth)/2):orient===TOP_ALIGN?(bound.y1=t,bound.x1=hAlign===LEFT_ALIGN?l:hAlign===RIGHT_ALIGN?l+w-maxWidth:l+(w-maxWidth)/2):orient===RIGHT_ALIGN?(bound.y1=t,bound.x1=l+w-maxWidth):(bound.y1=t,bound.x1=l),bound.x2=bound.x1+maxWidth,bound.y2=bound.y1+maxHeight,bound}legend.colorAxis=function(element,chartObj,colorAxisOptions){var posScale,legendOptions=chartObj.systemConf.legend,colorbandOptions=legendOptions.colorBand,minmaxlabelsOptions=colorAxisOptions.minmaxlabels,axislineOptions=colorAxisOptions.axisline,axislineSize=axislineOptions.show?validateNullVal(axislineOptions.strokeWidth,1):0,dimension=legend_helpers.getColorBandDimension(chartObj),width=dimension[0],height=dimension[1],mode=colorbandOptions.type,orient=legend_helpers.getOrient(legendOptions),legendAlignment=getLegendAlignment(legendOptions),columnInfo=chartObj.dataset.getColumn("clr"),datatype=columnInfo.datatype,formatConf=columnInfo[datatype],axisComp=chartObj.axes.clr.component,scale_domain=chartObj.axes.clr.scale.domain(),tickValues=minmaxlabelsOptions.show&&minmaxlabelsOptions.excludeIntervals?[]:scale_domain,reversed=legend_helpers.isReversedColorAxis(chartObj),isHorizontal="horizontal"===legendAlignment.layout,range=isHorizontal?[0,width]:[height,0],align=minmaxlabelsOptions.show&&minmaxlabelsOptions.excludeIntervals&&orient===TOP_ALIGN?[0,0]:orient===BOTTOM_ALIGN||orient===TOP_ALIGN?[0,height]:[width,0],isDiscrete=colorbandOptions.ranges&&colorbandOptions.ranges.length,userLabels=colorbandOptions.labels;if(chartObj.axes.clr.ticks=axis.ticks(chartObj,colorAxisOptions,"clr",0,orient,chartObj.chartarea),reversed&&range.reverse(),isDiscrete){scale_domain=getRawRanges(chartObj);var isOrdinal=chartObj.dataset.getDataType("clr")===ORDINAL_DATATYPE;"continuous"!==mode||isOrdinal?posScale=d3_scaleOrdinal().domain(scale_domain).range(range).padding(0):(scale_domain=d3_merge(scale_domain),colorbandOptions.minRange!==scale_domain[0]&&scale_domain.splice(0,0,colorbandOptions.minRange),posScale=d3_scalePoint().domain(scale_domain).range(range))}else{if(tickValues[0]===tickValues[1]){var rangeDiff=mathAbs(range[0]-range[1]);range=[rangeDiff/2,rangeDiff/2]}posScale=d3_scaleLinear().domain([scale_domain[0],scale_domain[scale_domain.length-1]]).range(range)}posScale.origRange=range,tickValues=minmaxlabelsOptions.show&&minmaxlabelsOptions.excludeIntervals?[]:scale_domain,axisComp.orient(orient).scale(posScale).tickSize(validateNullVal(colorAxisOptions.tickmark.size,6),0).majorTicks(function(orient,w,h,axislineSize){var x1,y1,x2,y2;x1=y1=x2=y2=0,orient==BOTTOM_ALIGN?(y1=-axislineSize,y2=-h-axislineSize):orient==TOP_ALIGN?(y1=axislineSize,y2=h+axislineSize):orient==LEFT_ALIGN?(x1=w+axislineSize,x2=axislineSize):orient==RIGHT_ALIGN&&(x1=-w-axislineSize,x2=-axislineSize);return{x1:x1,y1:y1,x2:x2,y2:y2}}(orient,width,height,axislineSize)).systemconf(chartObj.systemConf).chartObj(chartObj).tickValues(tickValues).columnIndices([chartObj.dataset.getColumnIdx("clr")]).tickFormat(function(d,i){if(userLabels&&userLabels.length){var labelIndex=legend_helpers.getLabelIndex(d,colorbandOptions,chartObj);if(defined(labelIndex))return this.__formattedValue=userLabels[labelIndex],d3_select(this).text(userLabels[labelIndex])}var formattedValue=getFormattedValue(formatConf,d,datatype,chartObj,"legend",null,"-");this.__formattedValue=formattedValue,d3_select(this).text(formattedValue)}),element.datum(colorAxisOptions).attr("transform","translate("+align[0]+","+align[1]+")").call(axisComp,"clr"),element.selectAll("g.tick").style("display",null),element.selectAll("line.minorTicks").attr(isHorizontal?"x2":"y2",null),element.selectAll("text.ticklabel").style("pointer-events","visible"),function(container,axislineOptions,orient,isHorizontal,dimension){var element=container.selectAll("path.domain");if(axislineOptions.show){var strokeWidth=validateNullVal(axislineOptions.strokeWidth,1),tx=0,ty=0;orient===LEFT_ALIGN?tx=strokeWidth/2:orient===RIGHT_ALIGN?tx=-strokeWidth/2:ty=orient===BOTTOM_ALIGN?-strokeWidth/2:strokeWidth/2,element.attr("transform","translate("+tx+","+ty+")").attr("d",isHorizontal?"M0,0 L"+dimension[0]+",0":"M0,0 L0,"+dimension[1]).styles({"stroke-dasharray":getDashArray(axislineOptions.style,strokeWidth),"stroke-linecap":getLineCap(axislineOptions.lineCap,axislineOptions.style)})}else element.remove()}(element,axislineOptions,orient,isHorizontal,dimension),element.call(ZC_legend_minmaxLabels,dimension,colorAxisOptions,chartObj,orient)},legend.colorAxis.handleOverlapNOverlap=function(axisGroup,axisGroupPosition,position,chartObj,chartarea,colorAxisOptions){var minmaxlabels=axisGroup.selectAll("g.zchart-minmaxlabels").selectAll("text"),ticklabels=axisGroup.selectAll("g.tick").selectAll("text");!function(ticklabels,axisGroupPosition,position,minmaxlabelsBoundArray,chartObj,chartarea){var legBBox=bbox(chartObj.legendarea.element.node()),ticklabelsBoundArray=[],maxTicklabelWidth=[],count=0;ticklabels.each(function(){maxTicklabelWidth.push(bbox(this).width)}),maxTicklabelWidth=d3_max(maxTicklabelWidth),ticklabels.each(function(){var parentPos=getSvgTransform(this.parentNode).translate;ticklabelsBoundArray.push(getMinmaxLabelBound(this,axisGroupPosition,position,parentPos)),function(element,chartObj,parentPos,bb,maxTicklabelWidth,legBBox){var orient=legend_helpers.getOrient(chartObj.systemConf.legend),percent=orient===RIGHT_ALIGN||orient===LEFT_ALIGN?1:.5,bound=getAvailableLegendBound(chartObj,chartObj.chartarea),legendtitleWidth=chartObj.systemConf.legend.title.show?bbox(chartObj.legendarea.element.selectAll(".legendtitle").node()).width:0,w=(bound.x2-bound.x1-(legBBox.width-mathMax(maxTicklabelWidth,legendtitleWidth)))*percent,h=bound.y2-bound.y1,edge={left:parentPos[0],top:parentPos[1],right:parentPos[0]+w,bottom:parentPos[1]+h};if(bb.x2-bb.x1>w){var textBound={left:parentPos[0],top:parentPos[1],width:bb.width,height:bb.height};return trimText(element,element.textContent,textBound,edge,BOTTOM_ALIGN,"..",{left:5,right:5,top:5,bottom:5}),".."===element.textContent&&(d3_select(element).text(""),d3_select(element.parentNode).style("opacity",0)),!0}}(this,chartObj,parentPos,ticklabelsBoundArray[count],maxTicklabelWidth,legBBox)&&(ticklabelsBoundArray[count]=getMinmaxLabelBound(this,axisGroupPosition,position,parentPos)),function(element,minmaxlabelsBoundArray,ticklabelsBoundArray,i){for(var overlap,index=i-1;index>=0&&!overlap;index--)overlap=doOverlap(ticklabelsBoundArray[index],ticklabelsBoundArray[i]);if(minmaxlabelsBoundArray.length&&(doOverlap(ticklabelsBoundArray[i],minmaxlabelsBoundArray[0])||doOverlap(ticklabelsBoundArray[i],minmaxlabelsBoundArray[1]))||overlap)return d3_select(element.parentNode).style("display",NONE),!0}(this,minmaxlabelsBoundArray,ticklabelsBoundArray,count)&&(ticklabelsBoundArray[count]={x1:0,y1:0,x2:0,y2:0}),count++})}(ticklabels,axisGroupPosition,position,function(minmaxlabels,axisGroupPosition,position,chartObj,chartarea){var legendAlign=getLegendAlignment(chartObj.systemConf.legend),minmaxlabelsBoundArray=[],bound=getAvailableLegendBound(chartObj,chartarea),edge={left:bound.x1,top:bound.y1,right:bound.x2,bottom:bound.y2},margin={left:5,right:5,top:5,bottom:5};if(minmaxlabels.each(function(d,i){var pos=getMinmaxLabelBound(this,axisGroupPosition,position),textBound={left:pos.x1,top:pos.y1,width:pos.width,height:pos.height};trimText(this,this.textContent,textBound,edge,BOTTOM_ALIGN,"..",margin),".."===this.textContent&&d3_select(this).text(""),minmaxlabelsBoundArray[i]=getMinmaxLabelBound(this,axisGroupPosition,position)}),"horizontal"===legendAlign.layout&&minmaxlabelsBoundArray.length&&doOverlap(minmaxlabelsBoundArray[0],minmaxlabelsBoundArray[1])){var bandWidth=minmaxlabelsBoundArray[1].x2-minmaxlabelsBoundArray[0].x1;minmaxlabels.each(function(d,i){var pos=getMinmaxLabelBound(this,axisGroupPosition,position),textBound={left:pos.x1,top:pos.y1,width:pos.width,height:pos.height},e=simpleClone(edge);0===i?e.right=pos.x1+bandWidth/2:e.left=pos.x2-bandWidth/2,trimText(this,this.textContent,textBound,e,BOTTOM_ALIGN,"..",margin),".."===this.textContent&&d3_select(this).text(""),minmaxlabelsBoundArray[i]=getMinmaxLabelBound(this,axisGroupPosition,position)})}return minmaxlabelsBoundArray}(minmaxlabels,axisGroupPosition,position,chartObj,chartarea),chartObj),!0===colorAxisOptions.ticklabel.tooltip&&ticklabels.each(function(d){addSVGtitleEle(d3_select(this),this.__formattedValue)})};var ReverseLegendHighlight=function(chartObj,options){var legendSeries=chartObj.legendarea.element.selectAll(".legseries").node();this.chartObj=chartObj,this.legendSeries=legendSeries,this.legendElements=legendSeries?legendSeries.children:[],this.itemHighlighted=!1,this.hoveredSeriesIndex=NULL,this.previousHoveredSeriesIndex=NULL,this.legend_series_height=NULL,this.legendScrollable=NULL,legendSeries&&(this.legend_series_height=legendSeries.clientHeight,this.legendScrollable=legendSeries.scrollHeight>this.legend_series_height)};function getBarCommonOption(conf,index){var levelMarkerWidth,rp=conf.params,stacked=rp.stacked,chartObj=rp.chartObj,yscale=rp.yscale,dataProcessorHelpers=DataProcessor.helpers,barDataSetIndex=chartObj.renderer[index].barDatasetIndex?chartObj.renderer[index].barDatasetIndex():0,commonPlotOptions=rp.commonPlotOptions,cType=dataProcessorHelpers.getChartType(chartObj.seriesdata[index].type||chartObj.userdata.seriesdata.type,"string"),isBullet="bullet"==cType,groupedByStack=chartObj.dataObject.groupedByStack,plotoptions=chartObj.seriesdata[index].plotoptions,levelMarker=plotoptions&&plotoptions.levelMarker?mergeJSON(commonPlotOptions.levelMarker,plotoptions.levelMarker,!0):commonPlotOptions.levelMarker,levelMarkerOptions=commonPlotOptions.levelMarker||{},wid=chartObj.barscale2.bandwidth()||0,barWidth=+(commonPlotOptions.bandWidth||null)||(isBullet?wid/3:wid),levelMarkerBandWidth=+(levelMarkerOptions.bandWidth||wid),levelMarkerMaxBandWidth=+(levelMarkerOptions.maxBandWidth||wid),maxBandWidth=+(commonPlotOptions.maxBandWidth||wid);levelMarkerWidth=mathMin(levelMarkerBandWidth,levelMarkerMaxBandWidth,wid),barWidth=mathMin(barWidth,maxBandWidth,wid);var barPadding=mathMax(0,(wid-barWidth)/2),levelMarkerPadding=mathMax(0,(wid-levelMarkerWidth)/2),commonOption={stacked:stacked,categories:rp.xscale.domain(),axisrotated:rp.axisrotated,bandwidth1:chartObj.barscale1,bandwidth2:chartObj.barscale2,barDatasetIndex:barDataSetIndex,padding:barPadding,yscale:yscale,hasNegValue:rp.hasNegValue,yaxiscolumnorder:rp.yaxiscolumnorder,addRangeBand:function(){return yscale.bandwidth?yscale.bandwidth()/2:0},barWidth:barWidth,charttype:cType,levelMarker:levelMarker,levelMarkerWidth:levelMarkerWidth,levelMarkerPadding:levelMarkerPadding,stackGroupIndex:chartObj.userdata.seriesdata.stackGroup?chartObj.dataObject.getStackGroupIndex(index,groupedByStack.keys(),function(d){return groupedByStack.get(d).map(function(d){return d.si})}):0};return chartObj.renderer[index].commonOption=commonOption,commonOption}ReverseLegendHighlight.prototype.highlight=function(options){var chartObj=this.chartObj,previousHoveredSeriesIndex=this.previousHoveredSeriesIndex,itemHoverStyle=(legendOptions=chartObj.systemConf.legend).itemHoverStyle;if(itemHoverStyle&&itemHoverStyle.showOnDataHover&&(!legend_helpers.isContinousLegend(chartObj)||itemHoverStyle.type&&itemHoverStyle.type!==NONE)){var oldInfo=chartObj.eventHandler.oldInfo,highlightItem=chartObj.legend.component.highlightItem;if(!(chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory||chartObj.isGeoMap)||oldInfo&&!oldInfo.isNoInfo){var hoveredData,seriesIndex,itemIndex;chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory||chartObj.isGeoMap?(hoveredData=options.data,seriesIndex=options.seriesPos,itemIndex=options.itemPos):(hoveredData=options.data.data||options.data,seriesIndex=options.seriesPos,itemIndex=options.itemPos);var hoveredSeriesIndex=this.hoveredSeriesIndex=this.getLegendIndex(hoveredData,chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory||chartObj.isNonAxisMultiSeriesCategory||chartObj.isGeoMap?seriesIndex:itemIndex);if(legend_helpers.isContinousLegend(chartObj)){var legendOptions,clrValue=chartObj.dataset.getClr(hoveredData),userRanges=(legendOptions=chartObj.systemConf.legend).colorBand.ranges,brushScale=chartObj.axes.clr.brushScale;highlightItem(userRanges&&userRanges.length?brushScale(userRanges[hoveredSeriesIndex])+brushScale.bandwidth()/2:brushScale(clrValue),!0,NULL,userRanges&&userRanges.length?hoveredSeriesIndex:[clrValue]),this.itemHighlighted=!0}else{var legendElements=this.legendElements;if(legendElements[hoveredSeriesIndex]){var legendData=legend_helpers.getLegendData(chartObj);hoveredSeriesIndex!==previousHoveredSeriesIndex&&null!==previousHoveredSeriesIndex&&highlightItem(legendElements[previousHoveredSeriesIndex],legendData[previousHoveredSeriesIndex],previousHoveredSeriesIndex,legendOptions),highlightItem(legendElements[hoveredSeriesIndex],legendData[hoveredSeriesIndex],hoveredSeriesIndex,legendOptions,!0),this.itemHighlighted=!0,!this.legendScrollable||chartObj.systemConf.legend.expandable&&chartObj.systemConf.legend.expandable.show||(this.legendSeries.scrollTop=legendElements[hoveredSeriesIndex].offsetTop-this.legend_series_height/2)}}this.previousHoveredSeriesIndex=hoveredSeriesIndex}}},ReverseLegendHighlight.prototype.reset=function(){if(this.itemHighlighted){var legendElements=this.legendElements,chartObj=this.chartObj,hoveredSeriesIndex=this.hoveredSeriesIndex,highlightItem=chartObj.legend.component.highlightItem;if(legend_helpers.isContinousLegend(chartObj))highlightItem(NULL,!1);else if(defined(legendElements[hoveredSeriesIndex])){var legendData=legend_helpers.getLegendData(chartObj),legendOptions=chartObj.systemConf.legend;highlightItem(legendElements[hoveredSeriesIndex],legendData[hoveredSeriesIndex],hoveredSeriesIndex,legendOptions)}this.hoveredSeriesIndex=null}this.itemHighlighted=!1},ReverseLegendHighlight.prototype.getLegendIndex=function(d,index){var chartObj=this.chartObj,clrOptions=chartObj.axes.clr;return clrOptions.scaleType?colorscale_helpers.getItemIndex(chartObj,clrOptions.indexScale,d):null!=index?index:void 0};var UnSelectedHighlight=function(chartObj){this.chartObj=chartObj,this.elements="svg"===chartObj.plot.renderer.mode?chartObj.container.selectAll("g.seriesholder"):d3_select(chartObj.context.canvas),this.backupStyles=NULL,this.previousPoint=NULL};function replacer(key,value){return["parent","children"].indexOf(key)>-1?UNDEFINED:value}function getBubblePieAngle(chartInstance,seriesIndex,subSeriesIndex,point){var key=bubblepieUtils.getKey(point,seriesIndex,chartInstance),pieRenderer=chartInstance.subrenderer[subSeriesIndex][key];return pieRenderer?{start:pieRenderer.data[seriesIndex].startAngle,end:pieRenderer.data[seriesIndex].endAngle}:null}function CustomPoints(chartInstance,points,toCircle){if(!(this instanceof CustomPoints))return new CustomPoints(points);points=pick(points,[]),toCircle&&(points=CustomPoints.toCircle(points)),this.chart=chartInstance,this.points=CustomPoints.addType(points)}function getDimension(x,y,width,height,axesRotated){return{x:axesRotated?y:x,y:axesRotated?x:y,width:axesRotated?height:width,height:axesRotated?width:height}}function BulletEvent(chart,barOptions,scaleX,scaleY){this.chart=chart,this.barOptions=barOptions,this.scale={x:scaleX,y:scaleY},this.barOptions=barOptions,this.axesRotated=chart.dataObject.getAxisRotated(),this.cache=d3_map()}function getFontSizeByHierarchy(conf,chartObj){var systemconf=chartObj.systemConf;return+utils.getVal(getValByPriority([conf,systemconf.chart.plot.datalabels,systemconf.chart,systemconf.canvas],"fontSize"))}function getFontFamilyByHierarchy(config,chartInstance){var systemConf=chartInstance.systemConf;return utils.getVal(getValByPriority([config,systemConf.chart,systemConf.canvas,$ZCG],"fontFamily"))}function updateTspanTemplate(showAs){var str="",lastIndex=0,t={"<tspan":[],"</tspan>":[]};return showAs.replace(/<tspan|<\/tspan>/g,function(){t[arguments[0]].push(arguments[1])}),t["<tspan"].forEach(function(d,i){lastIndex!=d&&(str+="<tspan>"+showAs.substring(lastIndex,d)+"</tspan>"),str+=showAs.substring(d,lastIndex=t["</tspan>"][i]+8)}),lastIndex!=showAs.length&&(str+="<tspan>"+showAs.substring(lastIndex,showAs.length)+"</tspan>"),str}function translateTspan(ele,x){ele.selectAll("tspan.zcTspan").attr("x",x)}function trimAllTspan(labelText,chartObj,tranform,fontSize,edge,b,boundboxPadding,xy){var dx=+tranform[0],dy=+tranform[1],plotarea=chartObj.plotarea,margin={left:-fontSize,right:-fontSize,top:0,bottom:0},orient=BOTTOM_ALIGN;boundboxPadding=boundboxPadding||0,edge=edge||{left:-dx+boundboxPadding,top:-dy,right:plotarea.width-dx-boundboxPadding,bottom:plotarea.height-dy},labelText.each(function(){var children=this.childNodes,childCount=0,parentBBox=bbox(this),parentWidth=this.getComputedTextLength();parentBBox.x+parentWidth>edge.right&&(parentWidth-=parentBBox.x+parentWidth-edge.right+boundboxPadding),parentBBox.x<edge.left&&(parentWidth-=edge.left-parentBBox.x+boundboxPadding);for(var i=0;i<children.length;i++){for(var node=children[i],c=node.childNodes,totalWidth=node.getComputedTextLength(),textContent="",j=0;j<c.length;j++){var curTextContent=c[j].textContent;textContent+=curTextContent,b[childCount+j].textLength=curTextContent.length}if(totalWidth-parentWidth>1){var bb=b[childCount].bbox,textBound={left:bb.x+(xy?xy[0]:0),top:bb.y+(xy?xy[1]:0),width:totalWidth,height:bb.height};trimText(c[0],textContent,textBound,edge,orient,"..",margin,null,null,!1);var innerHTML=c[0].innerHTML;".."===innerHTML&&(innerHTML="");j=0;for(var start=0;j<c.length;j++){var curTextLength=b[childCount+j].textLength;c[j].innerHTML=innerHTML.substring(start,start+curTextLength),start+=curTextLength}}childCount+=c.length-1}})}function getTspanBound(label,fontSize){var c=label.selectAll(function(){return this.childNodes}),anchor=label.attr("text-anchor"),X=+label.attr("x"),Y=+label.attr("y"),o=[],DY=0;return c.each(function(){var ele=d3_select(this),nodeDY=parseFloat(ele.attr("dy")||0),children=this.childNodes,totalWidth=this.getComputedTextLength(),oldRef="middle"===anchor?-totalWidth/2:"end"==anchor?-totalWidth:0;DY+=nodeDY;for(var i=0;i<children.length;i++){var currentWidth=children[i].getComputedTextLength(),info={dy:DY,dx:oldRef+("middle"===anchor?currentWidth/2:0),bbox:{x:X+oldRef,y:Y+DY*fontSize,width:children[i].getComputedTextLength(),height:fontSize},style:children[i].style,text:children[i].textContent};o.push(info),oldRef+=currentWidth}}),o}function getCustomHTML(element,pool){return pool=pool||[],element.each(function(d,i){var children=d3_select(this).selectAll(function(){return this.children});if(children.size())children.each(function(){getCustomHTML(d3_select(this),pool)});else{var bb=bbox(this),nodeName=this.nodeName;if(nodeName===TSPAN_ELEMENT){if(""===this.textContent)return;var parentBCR=getTspanBoundingClientRect(function findParentTextNode(node){if(node.parentNode.nodeName!==TEXT_ELEMENT)return findParentTextNode(node.parentNode);return node.parentNode}(this)),bcr=getTspanBoundingClientRect(this);bb.x+=bcr.left-parentBCR.left,bb.y+=bcr.top-parentBCR.top,bb.width=bcr.width,bb.height=bcr.height}pool.push({node:this,nodeName:nodeName,bb:bb})}}),pool}function arrange(slot,TOP,slotCount,slottedCount){for(var leftUnslotted=[],unslotted=[],remaining=[],remainingCount=slotCount-slottedCount,sortByDist=function(a,b){return a.dist-b.dist},remainingCount_copy=remainingCount,i=0;i<slotCount;i++)slot[i]||leftUnslotted.push(i);slot.forEach(function(d){d.sort(sortByDist)}),slot.forEach(function(d){d.forEach(function(dt,i){0!=i&&(remaining[i]=remaining[i]||[],remaining[i].push(dt))})}),remaining.forEach(function(d){d.sort(sortByDist)}),remaining.forEach(function(d){d.forEach(function(dt,i){unslotted.push([dt])})}),unslotted.forEach(function(d,i){remainingCount>0?remainingCount--:d[0].hide=!0}),(unslotted=unslotted.slice(0,remainingCount_copy)).sort(function(a,b){return a[0].y1-b[0].y1}),unslotted.forEach(function(d){var us=d[0],height=us.y2-us.y1,co=mathMax(mathFloor((us.y1-TOP)/height),0);if(slot[co]){for(var dist,pos=leftUnslotted[0],id=0,o=0;o<leftUnslotted.length;o++){var dst=mathAbs(TOP+leftUnslotted[o]*height-us.y1);null==dist&&(dist=dst),dst<dist&&(dist=dst,pos=leftUnslotted[o],id=o)}if(pos<co){leftUnslotted.splice(id,1);var prev=pos;slot.forEach(function(d,i){var dt=d[0];i>pos&&dt.y1<us.y1&&(slot[prev]=d,prev=i)}),slot[prev]=[us]}else{leftUnslotted.splice(id,1);prev=[us];for(var i=co;i<=pos;i++)if(slot[i]){if(slot[i][0].y1>us.y1){var temp=slot[i];slot[i]=prev,prev=temp}}else slot[i]=prev}}else slot[co]=d}),slot.forEach(function(d,i){var dt=d[0],height=dt.y2-dt.y1,dy=TOP+i*height-dt.y1;dt.translate=mathAbs(dy)<height&&i+1<slotCount&&!slot[i+1]&&dy<0?0:dy}),slot.forEach(function(d,i){var dt=d[0],height=dt.y2-dt.y1,dy=TOP+i*height-dt.y1;dt.translate=mathAbs(dy)<height&&i+1<slotCount&&(!slot[i+1]||!slot[i+1][0].translate)&&dy<0?dt.translate:dy})}function addToSlot(half,count,slot,TOP){return half.forEach(function(obj){var height=obj.y2-obj.y1,co=mathMax(0,mathFloor((obj.y1-TOP)/(obj.y2-obj.y1)));obj.dist=obj.y1<TOP?TOP-obj.y1:obj.y1-(TOP+co*height),slot[co]||(slot[co]=[],count++),slot[co].push(obj)}),count}function addToHalf(obj,slotCount,TOP,BOTTOM,prev,half,count,totalSpaceNeeded,reverse){if(!obj.hide){null==slotCount&&(slotCount=mathFloor((BOTTOM-TOP)/(obj.y2-obj.y1)));var dist=reverse?null==prev?BOTTOM-obj.y2:half[prev].y1-obj.y2:null==prev?obj.y1-TOP:obj.y1-half[prev].y2;totalSpaceNeeded+=null!=prev&&doOverlap(obj,half[prev])&&dist<-5?mathAbs(dist):0,prev=count,half.push(obj),count++}return{prev:prev,count:count,totalslot:slotCount,need:totalSpaceNeeded}}function dataLabelTextContent(chartObj,rp,conf,type,total,seriespos,yrangePos){var yColumn=chartObj.seriesdata[seriespos].yaxiscolumnorder||[0,0],cType=chartObj.chartTypes[seriespos],dataProcessorHelpers=DataProcessor.helpers,dataObject=chartObj.dataObject,columns=chartObj.systemConf.metadata.columns,isGeoMap=chartObj.isGeoMap;rp=rp||{stacked:!1,commonPlotOptions:chartObj.systemConf.chart.plot.plotoptions[cType.name],yaxiscolumnorder:dataProcessorHelpers.getParsedYAxisOrder(yColumn)};var datatype,formatConf,formattingFunc,newShowAs,dataset=chartObj.dataset,yaxiscolumnorder=rp.yaxiscolumnorder,stacked=rp.stacked,yscale=rp.yscale,isBubblePie=isMultiPieChartType(cType.value),piedataindex=validateNullVal(rp.commonPlotOptions.dataindex,3),getProcessedNodeFunc=chartObj.renderer[0]&&chartObj.renderer[0].getProcessedNode,labelMeta=chartObj.systemConf.metadata.axes.label,labelIndex=labelMeta&&labelMeta[0],hasLabelIndex=type===DATALABELS_LABELTYPE&&defined(labelIndex),showAs=hasLabelIndex?columns[labelIndex]?"{{val("+labelIndex+")}}":labelIndex.toString():conf.showAs,isShowAsDefined=-1!=[X_SHOWAS,Y_SHOWAS,Z_SHOWAS,PERCENT_SHOWAS,SPLITPERCENT_SHOWAS,MAXPERCENT_SHOWAS,GEO_SHOWAS].indexOf(showAs),hasPercentShowAs=-1!=[PERCENT_SHOWAS,SPLITPERCENT_SHOWAS,MAXPERCENT_SHOWAS].indexOf(showAs),hasShowAsFunction="function"==typeof showAs||"function"==typeof window[showAs];if(isShowAsDefined||hasShowAsFunction||(newShowAs=function(showAs){var newShowAs="";if(isArray(showAs))showAs.forEach(function(d,i){newShowAs+="<tspan class='zcTspan'"+(i?" dy='1.1em'":"")+">"+updateTspanTemplate(d)+"</tspan>"});else{var tagIndex=showAs.indexOf("<tspan");newShowAs=-1!=tagIndex?"<tspan class='zcTspan'>"+updateTspanTemplate(showAs)+"</tspan>":showAs}return newShowAs}(showAs)),!hasLabelIndex){var axisType=hasLabelIndex?"label":showAs==X_SHOWAS?X_SHOWAS:showAs==Z_SHOWAS&&defined(dataset.zidx)?Z_SHOWAS:isGeoMap?GEO_SHOWAS:Y_SHOWAS;if(datatype=columns[dataset.getColumnIdx(axisType,yColumn)].datatype,formatConf=dataset.getColumn(axisType,yColumn)[datatype],formattingFunc=hasPercentShowAs?getFormattedValueByPercent:getFormattedValue,isBubblePie&&!hasShowAsFunction&&hasPercentShowAs){var col=columns.filter(function(c){return c.dataindex===piedataindex})[0];col=defined(col)?col:dataset.getColumnIdx(axisType,yColumn),datatype=col.datatype,formatConf=col[datatype]}}var textContent=function(d,bound){d=type==STACKLABELS_LABELTYPE?d[1]:d;var node=dataObject.isHierarchy&&getProcessedNodeFunc&&getProcessedNodeFunc(d);if(isShowAsDefined){var value=NULL;switch(showAs){case PERCENT_SHOWAS:case SPLITPERCENT_SHOWAS:case MAXPERCENT_SHOWAS:var t=total,v=type==STACKLABELS_LABELTYPE?d:stacked||dataObject.isPercentChart?d.y:isBubblePie?d[piedataindex]:node&&node.children&&node.value||d.value||dataset.getY(d,yaxiscolumnorder,yrangePos);if(!stacked||dataObject.isStackedPercentChart||dataObject.isPercentChart||type!=DATALABELS_LABELTYPE){if("function"==typeof total)t=total(d,showAs);else if(!defined(t))if(showAs!==MAXPERCENT_SHOWAS&&yscale)t=yscale.domain()[1];else{var domain=chartObj.dataObject.ZC_BAR_getRangeY(chartObj,yaxiscolumnorder);domain=dataObject.isPercentChart||dataObject.isStackedPercentChart||stacked?domain[yaxiscolumnorder]:domain,t=v<0&&v>=domain[0]?-domain[0]:domain[1]}}else t=getStackedTotal(chartObj,seriespos,d,showAs);value=v/t*100||0;break;case X_SHOWAS:value=node&&node.children?UNDEFINED:dataset.getActualX(d);break;case Z_SHOWAS:defined(dataset.zidx)&&(value=dataset.getZ(d));break;case GEO_SHOWAS:value=dataset.getGeo(d);break;default:value=type==STACKLABELS_LABELTYPE?d:dataObject.isHierarchy?node&&node.children&&node.value||d.value||dataset.getY(d,yaxiscolumnorder):dataset.getY(d,yaxiscolumnorder,yrangePos)}return formattingFunc(formatConf,value,datatype,chartObj,type)}return hasShowAsFunction?invokeFunction(showAs,d,bound,chartObj):dataset.getCustomizedVal(chartObj,newShowAs,seriespos,NULL,NULL,d,type,NULL,"html"!==textContent.contentType)};return textContent.contentType=isShowAsDefined||!hasShowAsFunction&&!isArray(showAs)&&-1==showAs.indexOf("<tspan")?"text":"html",textContent.multiLine="html"===textContent.contentType&&!hasShowAsFunction&&isArray(showAs)&&showAs.length>1,textContent.hasShowAsFunction=hasShowAsFunction,textContent}UnSelectedHighlight.prototype.highlight=function(point){var chartObj=this.chartObj;if(replacerFunction=chartObj.dataObject.isHierarchy?replacer:NULL,applyUnselectedSeriesToPlot=chartObj.systemConf.legend.highlightEffect.applyUnselectedSeriesToPlot,previousPoint=this.previousPoint,condition=applyUnselectedSeriesToPlot&&point&&(!previousPoint||jsonStringify(previousPoint.data,replacerFunction)!=jsonStringify(point.data,replacerFunction)||previousPoint.seriesPos!=point.seriesPos||previousPoint.itemPos!=point.itemPos||jsonStringify(previousPoint.subseriesindex)!=jsonStringify(point.subseriesindex)),condition){var elements=this.elements,highlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(0,"unselectedSeries","plot"),styles=chartObj.legendHighlight.getEffect(highlightEffect,NULL,NULL,NULL,0,"plot");this.getBackup(styles),elements.styles(styles),this.previousPoint=point}},UnSelectedHighlight.prototype.reset=function(){var backupStyles=this.backupStyles;backupStyles&&(this.elements.styles(backupStyles),this.backupStyles=NULL,this.previousPoint=NULL)},UnSelectedHighlight.prototype.getBackup=function(styles){var elements=this.elements,backupStyles=this.backupStyles;if(!backupStyles){for(var styleName in backupStyles={},styles)styles.hasOwnProperty(styleName)&&(backupStyles[styleName]=elements.style(styleName));this.backupStyles=backupStyles}},svg_plot_renderer.bubblepie=function(){var shiftInfo,commonRendererProp;function chart(selection){return selection.each(function(data){var rp=commonRendererProp.params,chartObj=rp.chartObj,index=rp.datasetIndex,commonPlotOptions=rp.commonPlotOptions,axisrotated=rp.axisrotated,stacked=rp.stacked,xscale=rp.xscale,yscale=rp.yscale,yaxiscolumnorder=rp.yaxiscolumnorder,labelQueue=rp.labelQueue,container=d3_select(this),plotoptions=data[index].plotoptions;if(renderer_helpers.saveSeriesdataInRenderer(chartObj,index),index===chartObj.bubblePieRendererIndex){var transitionDuration=getAnimationConf(commonPlotOptions,plotoptions,chartObj,BUBBLEPIE_CHARTNAME).duration,pieData=chartObj.dataObject.bubblepieData,pieRenderer=chartObj.subrenderer,dataindex=validateNullVal(commonPlotOptions.dataindex,3),series=appendEle(container,"g",pieData?[1]:[],".","class","scatterseries");pieData&&pieData.forEach(function(piedatum,ssi){pieRenderer[ssi]=pieRenderer[ssi]||{};appendEle(appendEle(series,"g",[1],".","class","subseries_"+ssi),"g",bubblepieUtils.filterBySum(piedatum,dataindex),".","class","scatter",NULL,function(d){d.reference;return bubblepieUtils.getKey(NULL,NULL,NULL,[d.x,d.y])}).each(function(d,i){var dt=d.reference,key=bubblepieUtils.getKey(NULL,NULL,NULL,[d.x,d.y]),x=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,dt,"x")||0,y=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,dt,"y")||0,size=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,dt,"z",chartObj.zscale);pieRenderer[ssi][key]=(pieRenderer[ssi][key]||svg_plot_renderer.pie()).commonRendererProp(commonRendererProp).plotarea({width:size,height:size,left:x-size/2,top:y-size/2}),pieRenderer[ssi][key].chartRendered=!1,d3_select(this).attr("transform","translate("+(x-size/2)+","+(y-size/2)+")").call(pieRenderer[ssi][key])})}),chart.renderedTimer=setTimeout(function(){chart.chartRendered=!0;var seriesData=chartObj.seriesdata;seriesData.forEach(function(d,i){if(chartcategory.bubblePie.has(chartObj.chartTypes[i].value)){var renderer=chartObj.renderer[i];labelQueue.push({renderer:renderer,charttype:SCATTER_CHARTNAME,chartObj:chartObj,args:[d,i]}),labelQueue.push({renderer:renderer,charttype:"pieInnerLabels",chartObj:chartObj,args:[seriesData,i,pieData]})}})},transitionDuration)}else chart.chartRendered=!0}),chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.shiftInfo=function(_){return arguments.length?(shiftInfo=_,chart):shiftInfo},chart},events.mouseevents=function(chartObj,tooltipele,systemConf,plotarea,dataset,xscale,barscale1,barscale2,ysca,wrap,color,labelhighter){var element,levelMarkerPoint,tapOldInfo,bubblePieData,highlightpoint,CustomPoints_th,gvpFn=utils.getValueOfPlotOptions,datatype=dataset.getDataType("x"),yscale=ysca,axisrotated=(color=color,chartObj.dataObject.getAxisRotated()),isPolarAxisCategory=chartObj.dataObject.isPolarAxisCategory,tooltipEnabled=!0===systemConf.tooltip.enabled,defaultScrollElement=chartObj.container.selectAll(".zohocharts_scroll"),eventAttacherOptions={target:"plot",chartObj:chartObj},dataProcessorHelpers=DataProcessor.helpers,getParsedYAxisOrder=dataProcessorHelpers.getParsedYAxisOrder,getChartType=dataProcessorHelpers.getChartType,isCatNull=dataProcessorHelpers.isCatNull,tooltipShared=tooltip_helpers.hasSharedSeries(chartObj),bubblePieKeys=(bubblePieData=chartObj.dataObject.bubblepieData)&&d3_merge(bubblePieData).filter(function(item){return item}).map(function(item){return item.reference,bubblepieUtils.getKey(NULL,NULL,NULL,[item.x,item.y])}),events_plot={},stacked=function(cType){return chartObj.dataObject.isstacked(cType)};function getEventTrackerElement(){return chartObj.isAxisCategory&&(chartObj.systemConf.chart.width||chartObj.systemConf.chart.height)?defaultScrollElement:chartObj.eventHandler.trackerElement}function addClipToTracker(){if(isPolarAxisCategory){var plotarea_approx=chartObj.plotarea_approx,plotarea=chartObj.plotarea,properties={name:"polarClip",id:chartObj.id,cx:plotarea_approx.x+plotarea.left,cy:plotarea_approx.y+plotarea.top,r:plotarea_approx.radius},args={chartObj:chartObj},clipID=effects.get(effects.svg_clips,CIRCLE_ELEMENT,properties,args);chartObj.eventHandler.trackerElement.attr("clip-path","url("+chartObj.defsLocation+"#"+clipID+")"),window.PointerEvent||"canvas"!==chartObj.plot.renderer.mode||attachevents(ele=chartObj.container.selectAll("canvas.zc-labelholder-canvas,canvas.highlight-canvas,canvas.zc-canvas"),{mousemove:callback=function(){ele.style("display",NONE);var bottomElement=document.elementFromPoint(d3$1.event.clientX,d3$1.event.clientY),bottomElementD3=d3_select(bottomElement),currentEvent=bottomElement&&bottomElement.__on&&bottomElement.__on.filter(function(e){return e.type===d3$1.event.type})[0].value;return ele.style("display",NULL),d3_select(this).style("cursor",currentEvent?bottomElementD3.style("cursor"):NULL),currentEvent&&currentEvent.call(bottomElement,bottomElementD3.datum(),bottomElementD3.attr("index")||0),!1},mouseout:callback,click:callback,dblclick:callback},{singletouchmove:callback,touchend:callback,tap:callback,dbltap:callback})}var ele,callback}function ordinalDatamouseMove(mouse,event,element){var relativeelement=bbox(element),relmousePt={x:mouse[0]-relativeelement.x,y:mouse[1]-relativeelement.y},nearestPoint=getOrdinalDataPoint(relmousePt,xscale,yscale,systemConf,!0),seriesdata=chartObj.seriesdata,seriespos=nearestPoint.seriesPos,xpos=nearestPoint.itemPos,subseriesindex=nearestPoint.subseriesindex[seriespos],subseriesLength=nearestPoint.subseriesLength[seriespos],xpos_shared=nearestPoint.itemPosShared,currentQualitativeRangePoint=nearestPoint.currentQualitativeRangePoint;highlightpoint=nearestPoint.highlightpoint,levelMarkerPoint=nearestPoint.levelMarkerPoint;var oldInfo=chartObj.eventHandler.oldInfo,tooltip=chartObj.eventHandler.tooltipElement,customPoint=nearestPoint.customPoint;if(event=getEventObject(event),defined(customPoint)&&CustomPoints_th){if("threshold-marker"===customPoint.type){var thresholdMouseMove=getEventConf(null,customPoint,chartObj,"mousemove");defined(thresholdMouseMove)&&triggerUserCallback(thresholdMouseMove,customPoint,event),CustomPoints_th.hoverPoint(customPoint,event,relmousePt)}chartObj.eventHandler.oldInfo={customPoint:customPoint,isNoInfo:!0}}else{if(defined(currentQualitativeRangePoint)&&!1!==systemConf.tooltip.enabled&&("marker"===currentQualitativeRangePoint.type||!defined(seriespos))){var tooltipPosition=getTooltipPosition(event,relmousePt,0,0,chartObj,nearestPoint,axisrotated,tooltipShared,{},!0,!1,!1),text=events_plot.bulletEvents.getTooltipContent(currentQualitativeRangePoint,0),bulletEvent=getEventConf(null,currentQualitativeRangePoint,chartObj,"mousemove");return defined(bulletEvent)&&triggerUserCallback(bulletEvent,currentQualitativeRangePoint,event),hideHighlighterPoints(),tooltipPosition.helpers.inheritColors=!0,tooltipPosition.helpers.itempos=currentQualitativeRangePoint.itemIndex,tooltipPosition.helpers.chartType=currentQualitativeRangePoint.chartType,tooltip.show(chartObj,tooltipPosition,text,!1,tooltipPosition.helpers),void(chartObj.eventHandler.oldInfo={customPoint:currentQualitativeRangePoint,isNoInfo:!0})}if(null==seriespos)return chartObj.eventHandler.mouseOut(),void(chartObj.eventHandler.oldInfo={isNoInfo:!0});var type=chartObj.chartTypes[seriespos].value,yrangePos=type==charttype.arearange?1:null,yscindex=getParsedYAxisOrder(seriesdata[seriespos].yaxiscolumnorder),ysc=yscale[yscindex].eventscale,data=getCurrentDataPoint(seriespos,subseriesindex,xpos,xpos_shared),xdata=tooltipShared?xscale.domain()[xpos]:dataset.getX(data),ydata=dataset.getY(data,yscindex),xval=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"x",null,yrangePos),yval=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"y",null,yrangePos);if(isBarChartType(type)||null!=isWithinPlotarea(xval,yval)){if(null!=oldInfo&&!oldInfo.isNoInfo){var oldNearestPoint=oldInfo.nearestPoint,oldType=getChartType(oldInfo.type||chartObj.userdata.seriesdata.type,NUMERIC_DATATYPE);if(oldNearestPoint&&oldNearestPoint.seriesPos==nearestPoint.seriesPos&&oldNearestPoint.itemPos==nearestPoint.itemPos&&oldNearestPoint.subseriesindex==nearestPoint.subseriesindex&&oldType==type)return wrap.selectAll("#zcbarhighlight,#zcareahighlight").style("display",""),tooltipele.style("visibility",tooltipEnabled?"visible":"hidden"),void(crosshair_enabled(chartObj)&&chartObj.staticPaneSVG.selectAll("g.crosshair").style("visibility","visible"))}var distance=lineDistance({x:xscale(xdata),y:ysc(ydata)},relmousePt),seriesLen=tooltipShared?chartObj.seriesdata.length:1;wrap.selectAll("#zcscatterhighlight").selectAll("*").remove(),wrap.selectAll("#zcbarhighlight").selectAll("*").remove(),wrap.selectAll("#zcareahighlight").selectAll("*").remove();for(var tooltipSharedInfo=d3_map(),i=0;i<seriesLen;i++){var curSeriespos=tooltipShared?i:seriespos;if(tooltipShared&&subseriesLength>1)for(var j=0;j<subseriesLength;j++)hoverSeries(chartObj,curSeriespos,xdata,xpos,j,nearestPoint,tooltipShared,distance>10,tooltipSharedInfo);else hoverSeries(chartObj,curSeriespos,xdata,xpos,subseriesindex,nearestPoint,tooltipShared,distance>10,tooltipSharedInfo)}if(tooltipEnabled){var tooltipPos=getTooltipPosition(event,relmousePt,xval,yval,chartObj,nearestPoint,axisrotated,tooltipShared,tooltipSharedInfo,!0,!1,isMultiPieChartType(chartObj.chartTypes[seriespos].value)&&chartObj.subrenderer[subseriesindex][bubblepieUtils.getKey(data,seriespos,chartObj)].fillColorFunc);tooltip.show(chartObj,tooltipPos,null,!0,tooltipPos.helpers)}}}}function xydatamouseMove(mouse,event,element){var relativeelement=bbox(element),relmousePt={x:mouse[0]-relativeelement.x-(isPolarAxisCategory?chartObj.plotarea_approx.x:0),y:mouse[1]-relativeelement.y-(isPolarAxisCategory?chartObj.plotarea_approx.y:0)},oldInfo=chartObj.eventHandler.oldInfo,evt=getEventObject(event),cur_container_top=relmousePt.y-event.clientY,cur_container_left=relmousePt.x-event.clientX,nearestPoint=tooltipShared?function(relmousePt,xscale,yscale,systemConf){var plotX=xscale.invert(axisrotated?relmousePt.y:relmousePt.x),seriesdata=systemConf.seriesdata.chartdata,xBisector=d3_bisector(function(d){return dataset.getX(d)}).left,xbisect=seriesdata.map(function(d,i){if(d.disabled)return null;var renderer=chartObj.renderer[i];return d.data.map(function(d,j){return d=null!=renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[j]:d,xBisector(d,plotX,0,d.length-1)})}),subseriesindex=[],xpos=[],min_xminimumBisected=seriesdata.map(function(d,i){if(d.disabled)return null;var renderer=chartObj.renderer[i],yscindex=getParsedYAxisOrder(d.yaxiscolumnorder),type=chartObj.chartTypes[i].value,ysc=yscale[yscindex].scale;return d.data.map(function(d,j){d=null!=renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[j]:d;var curpt,isWithinClrRange,xbis=xbisect[i][j];if(d[xbis]&&(curpt={x:xscale(dataset.getX(d[xbis])),y:stacked(type)?ysc(d[xbis].y+d[xbis].y0):ysc(dataset.getY(d[xbis],yscindex))},isWithinClrRange=isWithinColorRange(dataset.getClr(d),chartObj)),xbis>0){var dis=mathAbs(relmousePt.x-curpt.x),prevpt={x:xscale(dataset.getX(d[xbis-1])),y:stacked(type)?ysc(d[xbis-1].y+d[xbis-1].y0):ysc(dataset.getY(d[xbis-1],yscindex))},prevptDis=mathAbs(relmousePt.x-prevpt.x),vv=dis>prevptDis?xbis-1:xbis;dis=dis>prevptDis?prevptDis:dis;lineDistance(curpt,relmousePt),lineDistance(relmousePt,prevpt);return{dist:isWithinClrRange?dis:null,xbis:vv}}if(0==xbis){var dis=isWithinClrRange&&curpt?mathAbs(relmousePt.x-curpt.x):null;return{dist:dis,xbis:xbis}}})}).map(function(d,i){if(!d)return null;var arr=d.map(function(d){return d.dist}),min=d3_min(arr),idx=arr.indexOf(min);return subseriesindex[i]=min?idx:null,xpos[i]=min?d[idx].xbis:null,min}),seriespos=min_xminimumBisected.indexOf(d3_min(min_xminimumBisected));return{itemPos:xpos[seriespos],seriesPos:seriespos,subseriesindex:subseriesindex[seriespos]}}(relmousePt,xscale,yscale,systemConf):getClosestPoint(relmousePt,xscale,yscale),seriespos=nearestPoint.seriesPos,itemPos=nearestPoint.itemPos,subseriesindex=nearestPoint.subseriesindex,tooltip=chartObj.eventHandler.tooltipElement,customPoint=nearestPoint.customPoint;if(defined(customPoint)&&CustomPoints_th){if("threshold-marker"===customPoint.type){var thresholdMouseMove=getEventConf(null,customPoint,chartObj,"mousemove");defined(thresholdMouseMove)&&triggerUserCallback(thresholdMouseMove,customPoint,event),CustomPoints_th.hoverPoint(customPoint,event,relmousePt)}chartObj.eventHandler.oldInfo={customPoint:customPoint,isNoInfo:!0}}else{if(!defined(seriespos))return chartObj.eventHandler.mouseOut(),void(chartObj.eventHandler.oldInfo={isNoInfo:!0});var seriesdata=chartObj.seriesdata,yscindex=getParsedYAxisOrder(seriesdata[seriespos].yaxiscolumnorder),ysc=yscale[yscindex].scale,type=chartObj.chartTypes[seriespos].value,yrangePos=type==charttype.arearange?1:null,renderer=(null!=xscale.bandwidth&&xscale.bandwidth(),chartObj.renderer[seriespos]),data=(null!=renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[subseriesindex]:seriesdata[seriespos].data[subseriesindex])[itemPos],xdata=chartObj.dataset.getX(data),xval=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"x",null,yrangePos),yval=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"y",null,yrangePos);if(isPolarAxisCategory||null!=isWithinPlotarea(xval,yval)){var distance=lineDistance({x:xval,y:yval},relmousePt);if(null!=oldInfo&&!tooltipShared){var oldNearestPoint=oldInfo.nearestPoint,oldType=getChartType(oldInfo.type||chartObj.userdata.seriesdata.type,NUMERIC_DATATYPE);if(oldNearestPoint&&oldNearestPoint.seriesPos==nearestPoint.seriesPos&&oldNearestPoint.itemPos==nearestPoint.itemPos&&oldNearestPoint.subseriesindex[oldNearestPoint.seriesPos]==nearestPoint.subseriesindex[nearestPoint.seriesPos]&&oldType==type&&oldInfo.containerLeft===cur_container_left&&oldInfo.containerTop===cur_container_top)return wrap.selectAll(isAreaChartType(type)?"#zcscatterhighlight,#zcareahighlight":"#zcscatterhighlight").style("display",""),tooltipele.style("visibility",tooltipEnabled?"visible":"hidden"),void(crosshair_enabled(chartObj)&&chartObj.staticPaneSVG.selectAll("g.crosshair").style("visibility","visible"))}var seriesLen=tooltipShared?chartObj.seriesdata.length:1;wrap.selectAll("#zcscatterhighlight").selectAll("*").remove(),wrap.selectAll("#zcareahighlight").selectAll("*").remove();for(var tooltipSharedInfo=d3_map(),i=0;i<seriesLen;i++){hoverSeries(chartObj,tooltipShared?i:seriespos,xdata,itemPos,subseriesindex,nearestPoint,tooltipShared,10>distance,tooltipSharedInfo)}if(tooltipEnabled){var tooltipPos=getTooltipPosition(evt,relmousePt,xval,yval,chartObj,nearestPoint,axisrotated,tooltipShared,tooltipSharedInfo,!1,isPolarAxisCategory,isMultiPieChartType(chartObj.chartTypes[seriespos].value)&&chartObj.subrenderer[subseriesindex][bubblepieUtils.getKey(data,seriespos,chartObj)].fillColorFunc),tooltipArgs=tooltipPos.helpers;chartObj.dataObject.isBubbleEnabled&&(tooltipPos.distance=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"z",chartObj.zscale)/2),tooltip.show(chartObj,tooltipPos,null,!0,tooltipArgs),(oldInfo=chartObj.eventHandler.oldInfo)&&(oldInfo.containerLeft=cur_container_left,oldInfo.containerTop=cur_container_top)}}}}function hoverPolygon(areahighlightWrap,type,plotOptions,commonPlotOptions,seriespos,subseriesindex,itemPos,xscale,ysc,yscindex,rangeBand,poly,tooltipShared){var seriesdata=chartObj.seriesdata,fillOpacity=chartObj.systemConf.legend.patternPallete,fillColor=getRawColor(chartObj,seriespos,getCurrentDataPoint(seriespos,subseriesindex,itemPos),seriespos),highlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(seriespos,"selectedSeries","plot"),highlightStyle=highlightEffect===NONE?{fill:TRANSPARENT}:chartObj.legendHighlight.getEffect(highlightEffect,"area",fillColor,{fill:TRANSPARENT,stroke:fillColor},seriespos,"plot");tooltipShared||hideUnselectedWrap(wrap.selectAll("g#zcbarhighlight")),areahighlightWrap.style("display","").attr("transform","translate("+plotarea.left+","+plotarea.top+")").styles(highlightStyle);var x1,y1,x2,y2,x,y,width,height,interpolation=gvpFn(plotOptions,commonPlotOptions)("mode"),isCatNullX=(fillOpacity=validateNullVal(commonPlotOptions.hoveroptions.fillOpacity,.2),isCatNull(dataset,"x")),isCatNullY=isCatNull(dataset,"y",yscindex);if("linear"!=interpolation||null==poly||isPolarAxisCategory){var area,serdata,isStkd=stacked(type),hasNegValue=chartObj.dataObject.containsNegativeData(yscindex),xaxisReversed=chartObj.systemConf.chart.axes.xaxis.reversed,yaxisReversed=chartObj.systemConf.chart.axes.yaxis[yscindex||0].reversed;if(isPolarAxisCategory){serdata=null!=(renderer=chartObj.renderer[seriespos]).seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[subseriesindex]:seriesdata[seriespos].data[subseriesindex];var polarBaseIdx=yaxisReversed&&!isStkd?ysc.domain().length-1:0,outerRadiusFn=function(d,j){var OR=isStkd?ysc(d.y0+d.y):ysc(dataset.getY(d,yscindex))+(null!=ysc.bandwidth?ysc.bandwidth()/2:0);return mathMax(OR,ysc.range()[polarBaseIdx])},isLineHighlight="strokeEnlarge"===highlightEffect;area=(isLineHighlight?d3_lineRadial:d3_areaRadial)().angle(function(d,j){return xscale(dataset.getX(d))}).curve(d3_curves(interpolation,axisrotated)),isLineHighlight?area.radius(outerRadiusFn):area.outerRadius(outerRadiusFn).innerRadius(function(d,j){var IR;return IR=isStkd?0==seriespos?mathMin(ysc.range()[0],ysc(hasNegValue)):ysc(d.y0):ysc(ysc.domain()[polarBaseIdx])+(null!=ysc.bandwidth?ysc.bandwidth()/2:0),mathMax(IR,ysc.range()[polarBaseIdx])})}else{var renderer,isRangeChart=type==charttype.arearange,yrangePos=isRangeChart?1:null,currentSeriesdata=null!=(renderer=chartObj.renderer[seriespos]).seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[subseriesindex]:seriesdata[seriespos].data[subseriesindex],data=currentSeriesdata[itemPos],xval=chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,data,"x",null,yrangePos),yval=chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,data,"y",null,yrangePos),isNotFirstData=0!=itemPos,isNotLastData=itemPos!=currentSeriesdata.length-1;if(xaxisReversed?isNotLastData:isNotFirstData){var prevData=currentSeriesdata[xaxisReversed?itemPos+1:itemPos-1];x1=(xval+chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,prevData,"x",null,yrangePos))/2,y1=(yval+chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,prevData,"y",null,yrangePos))/2}if(xaxisReversed?isNotFirstData:isNotLastData){var nextData=currentSeriesdata[xaxisReversed?itemPos-1:itemPos+1];x2=(xval+chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,nextData,"x",null,yrangePos))/2,y2=(yval+chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,nextData,"y",null,yrangePos))/2}x=axisrotated?0:null==x1?xval:x1,y=d3_min([y1,yval,y2,ysc(ysc.domain()[yaxisReversed?0:1])]),width=axisrotated?d3_max([x1,xval,x2,ysc(hasNegValue)||xval]):null!=x1&&null!=x2?x2-x1:null==x1?null==x2?1:x2-xval:xval-x1,height=axisrotated?null==y1?yval-y2:null==y2?y1-yval:y1-y2:plotarea.height-y;var dx1=Math.max(0,-x),dy1=Math.max(0,-y),dx2=Math.max(0,x+width-plotarea.width-(chartObj.scrolledX||0)),dy2=Math.max(0,y+height-plotarea.height-(chartObj.scrolledY||0));x=Math.max(0,x),y=Math.max(0,y),width-=dx1+dx2,height-=dy1+dy2,areahighlightWrap.style("display","block"),serdata=currentSeriesdata,area=d3_area().defined(function(d,j){return!isCatNullY(dataset.getY(d,yscindex))&&!isCatNullX(dataset.getX(d))}).curve(d3_curves(interpolation,axisrotated)),axisrotated?area.x0(function(d,i){return isStkd?0==seriespos&&0==subseriesindex&&0==i?mathMax(ysc.range()[0],ysc(hasNegValue)):ysc(d.y0):null!=ysc.bandwidth?ysc.origRange[0]+ysc.bandwidth():mathMax(ysc.range()[0],ysc(hasNegValue))}).x1(function(d,j){return chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,d,"x")}).y(function(d,j){return chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,d,"y",null,yrangePos)}):area.x(function(d,j){return chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,d,"x")}).y0(function(d,i){return isStkd?0==seriespos&&0==subseriesindex&&0==i?mathMin(ysc.range()[0],ysc(hasNegValue)):ysc(d.y0):isRangeChart?chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,d,"y",null,0):null!=ysc.bandwidth?ysc.origRange[0]+ysc.bandwidth():mathMin(ysc.range()[0],ysc(hasNegValue))}).y1(function(d,j){return chartObj.dataObject.getXYvalue(axisrotated,isStkd,xscale,ysc,yscindex,d,"y",null,yrangePos)})}var properties={name:"rect",id:chartObj.id,x:x,y:y,width:width,height:height},args={chartObj:chartObj},clipID=effects.get(effects.svg_clips,"rect",properties,args);appendEle(wrap.selectAll("#zcareahighlight"),"path",[1],".","class","highlight"+seriespos).datum(serdata).attr("d",area).attr("stroke","").attr("clip-path",isPolarAxisCategory?null:"url("+chartObj.defsLocation+"#"+clipID+")").styles({"fill-opacity":fillOpacity,display:""})}else{var polyPoints=d3_merge(poly.map(function(d,i){return[d.x,d.y]}));appendEle(areahighlightWrap,"polygon",[poly],".","class","highlight"+seriespos).attr("points",polyPoints.toString()).styles({"fill-opacity":fillOpacity,display:""})}}function hoverRect(barWrap,highlightpoint,radius,renderer,yaxisReversed,tooltipShared){var t=function(highlightpoint){var tx=plotarea.left,ty=plotarea.top;isHeatMapChartType(chartObj.chartTypes[0].value)&&(tx+=highlightpoint.x+highlightpoint.width/2,ty+=highlightpoint.y+highlightpoint.height/2);return[tx,ty]}(highlightpoint),path=function(highlightpoint,radius,yaxisReversed){if(isHeatMapChartType(chartObj.chartTypes[0].value)){var commonPlotOptions=chartObj.systemConf.chart.plot.plotoptions.heatmap,symbolPath=commonPlotOptions.symbol&&getSVGsymbol(commonPlotOptions.symbol);return symbolPath?symbolPath(mathMin(highlightpoint.width,highlightpoint.height)):roundedRect(-highlightpoint.width/2,-highlightpoint.height/2,highlightpoint.width,highlightpoint.height,radius,null,axisrotated)}return roundedRect(highlightpoint.x,highlightpoint.y,highlightpoint.width,highlightpoint.height,radius,yaxisReversed,axisrotated)}(highlightpoint,radius,yaxisReversed);tooltipShared||hideUnselectedWrap(wrap.selectAll("g#zcareahighlight,g#zcscatterhighlight")),wrap.selectAll("g#zcbarhighlight").style("display",""),barWrap.attr("d",path).attr("transform","translate("+t[0]+","+t[1]+")").style("display","")}function hoverScatter(scatterWrap,type,plotOptions,commonPlotOptions,xval,yval,xscale,ysc,yscindex,seriesdata,subseriesindex,seriespos,itemPos,isAreaChart,ganttMarkerProp,tooltipShared){var isGantt=type==charttype.gantt,highlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(seriespos,"selectedSeries","plot"),isPatternPalleteEnabled=legend_helpers.hasPatternPallete(chartObj)&&(isBubbleChartType(type)||type===charttype.scatter)&&"strokeEnlarge"!==highlightEffect,fillColor=getRawColor(chartObj,isMultiColoring(commonPlotOptions,chartObj)?itemPos:seriespos,getCurrentDataPoint(seriespos,subseriesindex,itemPos),seriespos);isGantt||tooltipShared||hideUnselectedWrap(wrap.selectAll("g#zcbarhighlight")),isAreaChart||isPolarAxisCategory||(hideUnselectedWrap(wrap.selectAll("g#zcareahighlight").selectAll("*")),hideUnselectedWrap(wrap.selectAll("g#zcareahighlight")));var innerSymbolSize,outerSymbolSize,scatterParentWrap=wrap.selectAll("#zcscatterhighlight"),mOptions=plotOptions?mergeJSON(commonPlotOptions.hoveroptions,plotOptions.hoveroptions,!0):commonPlotOptions.hoveroptions;if(defined(mOptions.symbol)||(mOptions.symbol=pick(getPropVal(plotOptions,"marker.symbol"),getPropVal(commonPlotOptions,"marker.symbol"))),!isGantt||!commonPlotOptions.marker||!1!==commonPlotOptions.marker.enabled){if(isBubbleChartType(type)){var renderer=chartObj.renderer[seriespos],currentSeriesdata=defined(renderer.seriesdataAfterUpdate)?renderer.seriesdataAfterUpdate[subseriesindex]:seriesdata[seriespos].data[subseriesindex],z=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,currentSeriesdata[itemPos],"z",chartObj.zscale);isPatternPalleteEnabled?(outerSymbolSize=.1*z,innerSymbolSize=0):(outerSymbolSize=.1*(z+perToPx("2.5%",mathMin(plotarea.width,plotarea.height))),innerSymbolSize=z/2*.1)}else{var outerSymbolSizeFactor,innerSymbolSizeFactor,lineOrArea=type===charttype.line||isAreaChartType(type),markerSize=plotOptions&&plotOptions.marker?gvpFn(plotOptions.marker,commonPlotOptions.marker)("size"):commonPlotOptions.marker.size,symbolsize=!lineOrArea&&!isPolarAxisCategory||null!=markerSize&&""!==markerSize?markerSize||1:gvpFn(plotOptions,commonPlotOptions)("strokeWidth");symbolsize=null!=mOptions.size&&""!==mOptions.size?1:+symbolsize,isGantt&&(mOptions=plotOptions?mergeJSON(ganttMarkerProp.hoveroptions,plotOptions.hoveroptions,!0):ganttMarkerProp.hoveroptions),isPolarAxisCategory?(outerSymbolSizeFactor=.7,innerSymbolSizeFactor=.35):lineOrArea?(outerSymbolSizeFactor=.9,innerSymbolSizeFactor=.4):isPatternPalleteEnabled?(outerSymbolSizeFactor=1,innerSymbolSizeFactor=0):LOCATION_MARKERS.has(mOptions.symbol)?(outerSymbolSizeFactor=1,innerSymbolSizeFactor=.5):(outerSymbolSizeFactor=2,innerSymbolSizeFactor=1),outerSymbolSize=symbolsize*outerSymbolSizeFactor,innerSymbolSize=symbolsize*innerSymbolSizeFactor}if(scatterParentWrap.attr("transform","translate("+plotarea.left+","+plotarea.top+")").style("display",""),addSVGmarker(scatterWrap,null,isPatternPalleteEnabled?{symbol:mOptions.symbol}:mOptions,{color:isPatternPalleteEnabled?null:fillColor,symbolSize:{inner:innerSymbolSize,outer:outerSymbolSize},transform:[xval,yval],imageSize:15},chartObj),isPatternPalleteEnabled){var highlightStyle=highlightEffect===NONE?{fill:TRANSPARENT}:chartObj.legendHighlight.getEffect(highlightEffect,"scatter",HIGHLIGHT_EFFECT_REGEX.test(highlightEffect)?fillColor:TRANSPARENT,{fill:TRANSPARENT,stroke:fillColor},seriespos,"plot");scatterWrap.styles(highlightStyle)}}}function hoverSeries(chartObj,seriespos,actXdata,itemPos,subseriesindex,nearestPoint,tooltipShared,showCursor,tooltipSharedInfo,highlightPoints){var seriesdata=chartObj.seriesdata,yscindex=getParsedYAxisOrder(seriesdata[seriespos].yaxiscolumnorder),ysc=yscale[yscindex].scale,type=chartObj.chartTypes[seriespos].value,isRangeChart=type==charttype.arearange,isGantt=type===charttype.gantt,yrangePos=isRangeChart||isGantt?1:null,currentSeriesdata=(null!=xscale.bandwidth&&xscale.bandwidth(),null!=(renderer=chartObj.renderer[seriespos]).seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[subseriesindex]:seriesdata[seriespos].data[subseriesindex]);if(null!=currentSeriesdata){var actData=currentSeriesdata[itemPos];if(null!=(itemPos=actData&&dataset.getActualX(actData)===actXdata?itemPos:function(item,data){var pos=null,isCatNullX=isCatNull(dataset,"x");return data.some(function(d,i){var hasX=!isCatNullX(dataset.getX(d))&&dataset.getX(d)===item;return hasX&&(pos=i),hasX}),pos}(actXdata,currentSeriesdata))&&!eventDisabled(chartObj.seriesdata[seriespos])&&!isNullData(currentSeriesdata[itemPos],dataset,yscindex)){tooltipSharedInfo.set(seriespos,itemPos),tooltip_content.updateSharedInfo(chartObj,tooltipSharedInfo,seriespos);var isAreaChart,data=currentSeriesdata[itemPos],xval=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"x",null,yrangePos),yval=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"y",null,yrangePos),plotOptions=seriesdata[seriespos].plotoptions,commonPlotOptions=systemConf.chart.plot.plotoptions[charttypenames.get(type)],mouseMoveFn=getEventConf(plotOptions,commonPlotOptions,chartObj,chartObj.zcEventType||"mousemove"),cursor=getEventConf(plotOptions,commonPlotOptions,chartObj,"cursor");type===charttype.line||type===charttype.scatter&&showCursor?events_plot.hideCursor(chartObj.eventHandler.trackerElement):events_plot.addCursor(cursor);var event=d3.event||chartObj.eventHandler.targetEvent;if(defined(mouseMoveFn)&&triggerUserCallback(mouseMoveFn,nearestPoint,event,{x:xval,y:yval}),isDefaultAllowed(mouseMoveFn,event)){if((null!=(highlightpoint=highlightPoints||highlightpoint)||tooltipShared)&&isBarChartType(type)){var yaxisReversed=chartObj.systemConf.chart.axes.yaxis[yscindex||0].reversed,borderOptions=gvpFn(plotOptions,commonPlotOptions)("border")||{},borderRadius=type===charttype.bullet?0:borderOptions.radius;borderRadius=borderOptions&&borderOptions.show?borderRadius:0;var renderer=chartObj.renderer[seriespos],radius=chartObj.dataObject.getTransRectValue("radius",null,null,null,null,borderRadius),highlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(seriespos,"selectedSeries","plot"),unHighlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(seriespos,"unselectedSeries","plot"),fillColor=getRawColor(chartObj,isMultiColoring(commonPlotOptions,chartObj)?itemPos:seriespos,getCurrentDataPoint(seriespos,subseriesindex,itemPos),seriespos),currentColor=HIGHLIGHT_EFFECT_REGEX.test(highlightEffect)||UNHIGHLIGHT_EFFECT_REGEX.test(unHighlightEffect)?fillColor:TRANSPARENT,highlightStyle=highlightEffect===NONE?{fill:currentColor}:chartObj.legendHighlight.getEffect(highlightEffect,"bar",currentColor,{fill:currentColor,stroke:fillColor},seriespos,"plot"),barWrap=appendEle(wrap.selectAll("#zcbarhighlight"),"path",[1],".","class","highlight"+seriespos+subseriesindex).styles(highlightStyle);tooltipShared&&!isHeatMapChartType(chartObj.chartTypes[seriespos].value)&&(highlightpoint=getPointRectangle(seriespos,subseriesindex,itemPos)),hoverRect(barWrap,highlightpoint,radius,0,yaxisReversed,tooltipShared);var levelMarker=plotOptions&&plotOptions.levelMarker?mergeJSON(commonPlotOptions.levelMarker,plotOptions.levelMarker,!0):commonPlotOptions.levelMarker;if(isGantt&&levelMarker.enabled){var levelMarkrad=chartObj.dataObject.getTransRectValue("radius",null,null,null,0),style={fill:levelMarker.color||fillColor},levelMarkerWrap=appendEle(wrap.selectAll("#zcbarhighlight"),"path",[1],"#","id","levelMarkerpath");levelMarkerWrap.styles(style),hoverRect(levelMarkerWrap,levelMarkerPoint,levelMarkrad,0,yaxisReversed)}}if(isAreaChartType(type)||isPolarAxisCategory)isAreaChart=!0,hoverPolygon(wrap.selectAll("#zcareahighlight"),type,plotOptions,commonPlotOptions,seriespos,subseriesindex,itemPos,xscale,ysc,yscindex,0,nearestPoint.poly,tooltipShared);if(isAreaChartType(type)||isPointChartType(type)||type===charttype.line||isPolarAxisCategory||isGantt){var currentWrap=appendEle(wrap.selectAll("#zcscatterhighlight"),"g",[1],".","class","highlight"+seriespos);if(isRangeChart||isGantt){var xval_0,yval_0,yrangePos_0=appendEle(currentWrap,"g",[1],".","class","yrangePos_0"),yrangePos_1=appendEle(currentWrap,"g",[1],".","class","yrangePos_1"),prop={};if(isGantt){prop=renderer.markerProperties;var pos=renderer.getMarkerPosition(data,prop.subseriesIndex,0,renderer);axisrotated?(xval=pos.y,yval=pos.x+pos.width/2,xval_0=pos.y+pos.height,yval_0=pos.x+pos.width/2):(xval=pos.x+pos.width/2,yval=pos.y,xval_0=pos.x+pos.width/2,yval_0=pos.y+pos.height)}else xval_0=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"x",null,0),yval_0=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"y",null,0);hoverScatter(yrangePos_0,type,plotOptions,commonPlotOptions,xval_0,yval_0,xscale,ysc,yscindex,seriesdata,subseriesindex,seriespos,itemPos,isAreaChart,{size:prop.size,hoveroptions:commonPlotOptions.hoveroptions.end}),hoverScatter(yrangePos_1,type,plotOptions,commonPlotOptions,xval,yval,xscale,ysc,yscindex,seriesdata,subseriesindex,seriespos,itemPos,isAreaChart,{size:prop.size,hoveroptions:commonPlotOptions.hoveroptions.start})}else hoverScatter(currentWrap,type,plotOptions,commonPlotOptions,xval,yval,xscale,ysc,yscindex,seriesdata,subseriesindex,seriespos,itemPos,isAreaChart,null,tooltipShared)}isPolarAxisCategory&&wrap.selectAll("#zcareahighlight,#zcscatterhighlight").attrs({"clip-path":null,transform:"translate("+(plotarea.left+chartObj.plotarea_approx.x)+","+(plotarea.top+chartObj.plotarea_approx.y)+")"}).style("display","")}nearestPoint.data=data,chartObj.eventHandler.oldInfo={nearestPoint:nearestPoint,type:type,chartObj:chartObj,isNoInfo:!1}}}}function getOrdinalDataPoint(relmousePt,xscale,yscale,systemConf,isMoving){var highlightpoint,levelMarkerPoint,minTriggerOffset,xpos,seriespos_cached,is_within_bubble,bubbleRadius,cx,cy,prevBubbleInfo,xaxisReversed=chartObj.systemConf.chart.axes.xaxis.reversed,onlyBarCombo_noAreaChart=chartObj.dataObject.noofBarEnabledSeries&&!chartObj.dataObject.noofAreaEnabledSeries&&!chartObj.dataObject.noofAreaEnabledSeries&&tooltipShared,categorypos=scale$1.invert(ORDINAL_DATATYPE,relmousePt,barscale1,axisrotated,null,xaxisReversed,onlyBarCombo_noAreaChart),seriesdata=chartObj.seriesdata,itemPos=(chartObj.dataObject.isCombinationalChart,{}),subseries={},seriespos={},xpos_shared=[],triggerOffset_ChartType={},poly=null,containsLine=!1,toHighlight=!1,sampleTaken={},currentQualitativeRangePoint=null,X="x",Y="y";axisrotated&&(X="y",Y="x");var subseriesindex=[],subseriesLength=[],min_yminimumBisected=seriesdata.map(function(d,i){var type=chartObj.chartTypes[i].value;minTriggerOffset=null==minTriggerOffset||chartObj.dataObject.isCombinationalChart?triggerOffset_ChartType[type]||getTriggeringOffset(chartObj,type,null):minTriggerOffset;var yaxiscolumnorder=getParsedYAxisOrder(d.yaxiscolumnorder),yaxisReversed=chartObj.systemConf.chart.axes.yaxis[yaxiscolumnorder||0].reversed,ysc=yscale[yaxiscolumnorder].eventscale,hasNegValue=chartObj.dataObject.containsNegativeData(yaxiscolumnorder),isCatNullY=isCatNull(dataset,"y",yaxiscolumnorder),polygonPoints={},plotOptions=d.plotoptions,commonPlotOptions=systemConf.chart.plot.plotoptions[chartObj.chartTypes[i].name],markerOptions=(plotOptions?mergeJSON(commonPlotOptions.marker,plotOptions.marker,!0):commonPlotOptions.marker)||{},defaultMarkerSize=10*(markerOptions.enabled&&markerOptions.size||1);if(eventDisabled(d))return[null];var renderer=chartObj.renderer[i],commonOption=renderer.commonOption||getBarCommonOption(chartObj.rendererConf[i],i);events_plot.bulletEvents||charttype.bullet!==type||(events_plot.bulletEvents=new events.BulletEvent(chartObj,renderer.commonOption,xscale,yscale[0].scale));var bulletEvent=events_plot.bulletEvents;return d.data.map(function(d,j){var seriesdataAfterUpdate=null!=renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[j]:d;if(null!=(xpos=getCategoryXpos(categorypos,seriesdataAfterUpdate)||null)){if(tooltipShared){var isWithinClrRange=isWithinColorRange(dataset.getClr(seriesdataAfterUpdate[xpos[0]]),chartObj);return xpos_shared[i]=xpos_shared[i]||[],xpos_shared[i][j]=xpos,dist=isWithinClrRange?0:null,toHighlight=!0,isBarChartType(type)?(seriespos_cached=seriespos_cached||scale$1.ordinalSubInvert(relmousePt,itemPos[type],barscale2,barscale1,axisrotated,type,xaxisReversed),seriespos.shared=seriespos_cached,itemPos.shared=categorypos,seriespos.shared=i):(seriespos[type]=i,itemPos[type]=categorypos),dist}if(isHeatMapChartType(type)){var a=null;return seriesdataAfterUpdate.forEach(function(dt,k){var curpt=getHeatCellPosition(chartObj,dt,xscale,ysc,yaxiscolumnorder),isWithinClrRange=isWithinColorRange(dataset.getClr(dt),chartObj),dist=isWithin(curpt,relmousePt);!isNullData(dt,dataset,yaxiscolumnorder)&&isWithinClrRange&&0==dist&&null===a&&(toHighlight=!0,itemPos[type]=k,seriespos[type]=i,highlightpoint=curpt,a=dist)}),a}if(isBarChartType(type)){for(var len=xpos.length,dist=null,m=0;m<len;m++){if(null==seriesdataAfterUpdate[curXpos=xpos[m]])return null;var curpt=getBarPosition(chartObj,seriesdataAfterUpdate[curXpos],j,commonOption);if(isCatNullY(seriesdataAfterUpdate[curXpos])||isNullData(seriesdataAfterUpdate[curXpos],dataset,yaxiscolumnorder))return null;var curdist=isWithin(curpt,relmousePt,yaxisReversed);(isWithinClrRange=isWithinColorRange(dataset.getClr(seriesdataAfterUpdate[curXpos]),chartObj))&&0==curdist&&!sampleTaken[type]&&(dist=0,toHighlight=!0,sampleTaken[type]=!0,seriespos[type]=i,itemPos[type]=curXpos,highlightpoint=curpt,type===charttype.gantt&&(levelMarkerPoint=renderer.getBarLevelMarkerProp(seriesdataAfterUpdate[curXpos],j,curXpos,renderer,commonOption))),charttype.bullet===type&&(currentQualitativeRangePoint=bulletEvent.getCurrentPoint(relmousePt,seriesdataAfterUpdate[curXpos]))}return dist}if(isAreaChartType(type)){curpt=seriesdataAfterUpdate[xpos=xpos[0]],isWithinClrRange=isWithinColorRange(dataset.getClr(curpt),chartObj),dist=null;if(isNullData(curpt,dataset,yaxiscolumnorder))return;var isRangeChart=type==charttype.arearange;return polygonPoints=getPolygonPoints(i,j,xpos,seriesdataAfterUpdate,seriesdataAfterUpdate[xpos-1],seriesdataAfterUpdate[xpos],seriesdataAfterUpdate[xpos+1],chartObj.dataObject,dataset,axisrotated,stacked(type),xscale,ysc,yaxiscolumnorder,hasNegValue,isRangeChart),pointInPolygon(relmousePt,polygonPoints.points)&&(dist=0==j?distToSegment(relmousePt,polygonPoints.curpt,polygonPoints.curNext):j==seriesdataAfterUpdate.length-1?distToSegment(relmousePt,polygonPoints.prevCur,polygonPoints.curpt):d3_min([distToSegment(relmousePt,polygonPoints.prevCur,polygonPoints.curpt),distToSegment(relmousePt,polygonPoints.curpt,polygonPoints.curNext)])),isWithinClrRange&&(null==minTriggerOffset||dist<minTriggerOffset)&&null!=dist?(toHighlight=!0,sampleTaken[type]=!0,minTriggerOffset=dist,seriespos[type]=i,subseries[type]=j,itemPos[type]=xpos,poly=polygonPoints.points,triggerOffset_ChartType[type]=minTriggerOffset,dist):null}if(isPointChartType(type)||type===charttype.line){for(len=xpos.length,dist=NULL,m=0;m<len;m++){curpt=seriesdataAfterUpdate[curXpos=xpos[m]],isWithinClrRange=isWithinColorRange(dataset.getClr(curpt),chartObj);var curXpos,is_within_current_bubble,markerSize=isBubbleChartType(type)?0:renderer.getSymbolSize?renderer.getSymbolSize(curpt):defaultMarkerSize,symbolbbox=renderer.getSymbolBBox?renderer.getSymbolBBox(curpt):NULL,condition=!1,curDist=NULL;if(isNullData(curpt,dataset,yaxiscolumnorder))return;if(symbolbbox!=NULL){var symbolSegment=constructSegmentAroundDataPoint(curpt,dataset,xscale,ysc,yaxiscolumnorder,type,NULL,X,Y,symbolbbox);curDist=distToSegment(relmousePt,symbolSegment[0],symbolSegment[1])}else curDist=getMinDistByPtToPt(curpt,relmousePt,xscale,ysc,yaxiscolumnorder,type,NULL,X,Y);if(is_within_current_bubble=curDist<=(bubbleRadius=(isBubbleChartType(type)?chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yaxiscolumnorder,curpt,"z",chartObj.zscale):markerSize)/2),is_within_bubble=is_within_bubble||is_within_current_bubble){if(is_within_current_bubble)if(cx=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yaxiscolumnorder,curpt,"x"),cy=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yaxiscolumnorder,curpt,"y"),prevBubbleInfo){var prevSurface=mathPI*prevBubbleInfo.r*prevBubbleInfo.r,curSurface=mathPI*bubbleRadius*bubbleRadius,inside=.9*mathSQRT(sqr(prevBubbleInfo.cx-cx)+sqr(prevBubbleInfo.cy-cy))<=mathAbs(prevBubbleInfo.r-bubbleRadius);condition=prevBubbleInfo.dist==NULL||curDist<prevBubbleInfo.dist||!(prevSurface<curSurface&&inside)}else condition=!0}else condition=curDist<=minTriggerOffset;if(type===charttype.bubblepie){var pt=isNullData(curpt,dataset,yaxiscolumnorder)?{x:0,y:0}:{x:chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yaxiscolumnorder,curpt,"x"),y:chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yaxiscolumnorder,curpt,"y")};if((condition=condition&&pointInPie(relmousePt,pt,i,j,curpt))&&sampleTaken[type]&&chartObj.chartTypes[seriespos.point].value===charttype.bubblepie){var key=bubblepieUtils.getKey(curpt,i,chartObj),prevKey=bubblepieUtils.getKey(getCurrentDataPoint(seriespos.point,subseries.point,itemPos.point),seriespos.point,chartObj);condition=condition&&bubblePieKeys.indexOf(key)>=bubblePieKeys.indexOf(prevKey)}}isWithinClrRange&&condition&&(toHighlight=!0,sampleTaken[type]=!0,dist=curDist,minTriggerOffset=curDist,seriespos.point=i,subseries.point=j,itemPos.point=curXpos,containsLine=type===charttype.line||isPointChartType(type),is_within_current_bubble&&(prevBubbleInfo={cx:cx,cy:cy,r:bubbleRadius,dist:curDist}))}return dist}}})}).map(function(d,i){var chartType=chartObj.chartTypes[i].value,type=isPointChartType(chartType)||chartType===$ZC.charttype.line?"point":chartType,min=is_within_bubble&&isBubbleChartType(chartType)&&seriespos[type]===i?d[subseries[type]]:d3_min(d);return null!=min?(subseriesindex[i]=d.indexOf(min),subseriesLength[i]=d.length):subseriesindex[i]=subseriesLength[i]=null,min});containsLine&&(min_yminimumBisected=min_yminimumBisected.map(function(d,i){var type=chartObj.chartTypes[i].value;return"point"===(type=isPointChartType(type)||type===charttype.line?"point":type)&&seriespos[type]===i?d:null}));var actualSeriesPosIndex=tooltipShared&&defined(seriespos_cached)?seriespos.shared:isHeatMapChartType(chartObj.chartTypes[0].value)?min_yminimumBisected.lastIndexOf(d3_min(min_yminimumBisected)):min_yminimumBisected.indexOf(d3_min(min_yminimumBisected));null!=min_yminimumBisected[actualSeriesPosIndex]&&toHighlight||(actualSeriesPosIndex=null),defined(currentQualitativeRangePoint)&&"marker"===currentQualitativeRangePoint.type?actualSeriesPosIndex=null:defined(actualSeriesPosIndex)&&(currentQualitativeRangePoint=null);var selectedType=tooltipShared&&defined(seriespos_cached)?"shared":defined(actualSeriesPosIndex)?chartObj.chartTypes[actualSeriesPosIndex].value:null;return{seriesPos:(selectedType=tooltipShared||!isPointChartType(selectedType)&&selectedType!==charttype.line?selectedType:"point")&&seriespos[selectedType],itemPos:selectedType&&itemPos[selectedType],itemPosShared:xpos_shared,subseriesindex:subseriesindex,subseriesLength:subseriesLength,highlightpoint:highlightpoint||null,levelMarkerPoint:levelMarkerPoint||null,distance:min_yminimumBisected[seriespos],poly:poly,currentQualitativeRangePoint:currentQualitativeRangePoint,customPoint:CustomPoints_th?CustomPoints_th.getClosest(relmousePt,minTriggerOffset):null}}function getCategoryXpos(xpos,data,isMultiCat){var xval=xscale.domain()[xpos],pos=null,isCatNullX=isCatNull(dataset,"x");return data.forEach(function(d,i){var hasX=!isCatNullX(dataset.getX(d))&&dataset.getX(d)===xval;return hasX&&(null==pos?pos=[i]:pos.push(i)),hasX}),pos}function addNoteFunction(args,seriespos,itemPos,currentSeriesdata,xval,yval){var canAddOnDoubleclickEvent=chartObj.systemConf.notes&&chartObj.systemConf.notes.addOnDoubleclickEvent;if(annotation&&canAddOnDoubleclickEvent){if(!args){var seriesdata=chartObj.seriesdata,clonedata=currentSeriesdata[itemPos].slice(),data=clonedata.splice(0,clonedata.length);seriesdata.length>1&&data.push(seriesdata[seriespos].seriesname),args={coordinate:[xval,yval],data:data,basedOn:"plot"}}annotation.addNotes(chartObj,args)}}function getClosestPoint(relmousePt,xscale,yscale){var mindist_trigger,dist,is_within_bubble,bubbleRadius,cx,cy,prevBubbleInfo,series,subseries,item,seriesdata=chartObj.seriesdata,poly=NULL,prev_trigger_offset=NULL,X="x",Y="y";axisrotated&&(X="y",Y="x"),seriesdata.map(function(d,i){var chartType=chartObj.chartTypes[i],type=chartType.value,chartName=chartType.name,isRangeChart=type==charttype.arearange,cur_trigger_offset=getTriggeringOffset(chartObj,type),plotOptions=d.plotoptions,commonPlotOptions=systemConf.chart.plot.plotoptions[chartName],markerOptions=(plotOptions?mergeJSON(commonPlotOptions.marker,plotOptions.marker,!0):commonPlotOptions.marker)||{},defaultMarkerSize=10*(markerOptions.enabled&&markerOptions.size||1);eventDisabled(d)||(chartObj.dataObject.isCombinationalChart?defined(mindist_trigger)&&!(defined(series)?cur_trigger_offset!=NULL&&cur_trigger_offset<=mindist_trigger:cur_trigger_offset<prev_trigger_offset||prev_trigger_offset==NULL||cur_trigger_offset==NULL)||(mindist_trigger=cur_trigger_offset):mindist_trigger=mindist_trigger==NULL?cur_trigger_offset:mindist_trigger);var prevData,renderer=chartObj.renderer[i],yscindex=getParsedYAxisOrder(d.yaxiscolumnorder),ysc=yscale[yscindex].scale,hasNegValue=chartObj.dataObject.containsNegativeData(yscindex),yrangePos=isRangeChart?1:NULL,polygonPoints={};return eventDisabled(d)?[NULL]:d.data.map(function(data,j){data=renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[j]:data;var cusPoints=isPolarAxisCategory?data.map(function(d,k){return{x:chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"x"),y:chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"y")}}):NULL;return data.map(function(d,k){if(isNullData(d,dataset,yscindex))prevData=d;else{var is_within_current_bubble,condition,markerSize=isBubbleChartType(type)?0:renderer.getSymbolSize?renderer.getSymbolSize(d):defaultMarkerSize;if(isPointChartType(type)||type===charttype.line){var symbolbbox=renderer.getSymbolBBox?renderer.getSymbolBBox(d):NULL;if(symbolbbox!=NULL){var symbolSegment=constructSegmentAroundDataPoint(d,dataset,xscale,ysc,yscindex,type,yrangePos,X,Y,symbolbbox);dist=distToSegment(relmousePt,symbolSegment[0],symbolSegment[1])}else dist=getMinDistByPtToPt(d,relmousePt,xscale,ysc,yscindex,type,yrangePos,X,Y),dist-=markerSize/2;if(bubbleRadius=(isBubbleChartType(type)?chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"z",chartObj.zscale):markerSize)/2,is_within_current_bubble=dist<=bubbleRadius,is_within_bubble=is_within_bubble||is_within_current_bubble,is_within_current_bubble||(dist-=bubbleRadius),type===charttype.bubblepie){var curpt=isNullData(d,dataset,yscindex)?{x:0,y:0}:{x:chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"x"),y:chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"y",NULL,yrangePos)};dist=pointInPie(relmousePt,curpt,i,j,d)?dist:UNDEFINED}}else{var dist_n_polyPoints=function(d,i,j,k,data,relmousePt,prevData,type,xscale,ysc,yscindex,hasNegValue,isRangeChart,cusPoints){var dist=null,polygonPoints=getPolygonPoints(i,j,k,data,prevData,data[k],data[k+1],chartObj.dataObject,dataset,axisrotated,stacked(type),xscale,ysc,yscindex,hasNegValue,isRangeChart),hasSinglePolygonPoint=1==polygonPoints.points.length;isPolarAxisCategory&&(polygonPoints.points=cusPoints);var isWithinPoly=!isAreaChartType(type)&&!isPolarAxisCategory||pointInPolygon(relmousePt,polygonPoints.points);if((1==data.length||hasSinglePolygonPoint)&&!isNullData(d,dataset,yscindex)){dist=dist2(relmousePt,polygonPoints.curpt);var isComboChart=chartObj.dataObject.isCombinationalChart,areaSeriesCount=chartObj.dataObject.noofAreaEnabledSeries,triggerOffset=getTriggeringOffset(chartObj,charttype.line);(areaSeriesCount>1||1===areaSeriesCount&&isComboChart)&&dist>triggerOffset&&(dist=null)}if(isWithinPoly&&!isNullData(d,dataset,yscindex)&&1!=data.length&&!hasSinglePolygonPoint){var pointA=distToSegment(relmousePt,polygonPoints.curpt,polygonPoints.curNext),pointB=distToSegment(relmousePt,polygonPoints.prevCur,polygonPoints.curpt),prevDataNull=0!==k&&isNullData(prevData,dataset,yscindex);dist=0==k?pointA:k==data.length-1?pointB:prevDataNull?pointA:d3_min([pointB,pointA])}return{distance:dist,polygonPoints:polygonPoints}}(d,i,j,k,data,relmousePt,prevData,type,xscale,ysc,yscindex,hasNegValue,isRangeChart,cusPoints);dist=dist_n_polyPoints.distance,polygonPoints=dist_n_polyPoints.polygonPoints,prevData=d}if(is_within_bubble){if(is_within_current_bubble)if(cx=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"x"),cy=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"y"),prevBubbleInfo){var prevSurface=mathPI*prevBubbleInfo.r*prevBubbleInfo.r,curSurface=mathPI*bubbleRadius*bubbleRadius,inside=.9*mathSQRT(sqr(prevBubbleInfo.cx-cx)+sqr(prevBubbleInfo.cy-cy))<=mathAbs(prevBubbleInfo.r-bubbleRadius);condition=prevBubbleInfo.dist==NULL||dist<prevBubbleInfo.dist||!(prevSurface<curSurface&&inside)}else condition=!0}else condition=mindist_trigger==NULL||dist<=mindist_trigger;isWithinColorRange(dataset.getClr(d),chartObj)&&condition&&dist!=NULL&&(mindist_trigger=dist,series=i,subseries=j,item=k,poly=polygonPoints.points,is_within_current_bubble&&(prevBubbleInfo={cx:cx,cy:cy,r:bubbleRadius,dist:dist}))}})})});var customTriggerMinDistance=NULL;return defined(series)&&(customTriggerMinDistance=mindist_trigger),{seriesPos:series,itemPos:item,subseriesindex:subseries,poly:poly,customPoint:CustomPoints_th?CustomPoints_th.getClosest(relmousePt,customTriggerMinDistance):null}}function hideHighlighterPoints(){wrap.selectAll("#zcscatterhighlight,#zcbarhighlight,#zcareahighlight").style("display",NONE)}function isNullData(data,dataset,yscindex){return chartObj.seriesdata[0].type!=charttype.stkdarea&&(null==data||isCatNull(dataset,"x")(dataset.getX(data))||isCatNull(dataset,"y",yscindex)(dataset.getY(data,yscindex)))}function getMinDistByPtToPt(d,relmousePt,xscale,ysc,yscindex,type,yrangePos,X,Y){var curpt={};curpt[X]=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"x"),curpt[Y]=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"y",null,yrangePos);var dx=curpt.x-relmousePt[X],dy=curpt.y-relmousePt[Y];return mathSQRT(sqr(dx)+sqr(dy))}function constructSegmentAroundDataPoint(d,dataset,xscale,ysc,yscindex,type,yrangePos,X,Y,rect){var segments=[];if(isNullData(d,dataset,yscindex))return 0;var curpt={};return curpt.x=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"x"),curpt.y=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,d,"y",null,yrangePos),axisrotated?segments.push({x:curpt.x,y:curpt.y-rect.width/2},{x:curpt.x,y:curpt.y+rect.width/2}):segments.push({x:curpt.x-rect.width/2,y:curpt.y},{x:curpt.x+rect.width/2,y:curpt.y}),segments}function getPolygonPoints(seriespos,subseriespos,itempos,data,prevData,curData,nextData,dataObject,dataset,axisrotated,stacked,xscale,ysc,yscindex,hasNegValue,isRangeChart){var prevpt,curpt,nextpt,prevBasept,curBasept,nextBasept,yrangePos=isRangeChart?1:null;curpt=isNullData(curData,dataset,yscindex)?{x:0,y:0}:{x:dataObject.getXYvalue(axisrotated,stacked,xscale,ysc,yscindex,curData,"x"),y:dataObject.getXYvalue(axisrotated,stacked,xscale,ysc,yscindex,curData,"y",null,yrangePos)},prevpt=0==itempos?{x:0,y:0}:isNullData(prevData,dataset,yscindex)?curpt:{x:dataObject.getXYvalue(axisrotated,stacked,xscale,ysc,yscindex,prevData,"x"),y:dataObject.getXYvalue(axisrotated,stacked,xscale,ysc,yscindex,prevData,"y",null,yrangePos)},nextpt=itempos==data.length-1?{x:0,y:0}:isNullData(nextData,dataset,yscindex)?curpt:{x:dataObject.getXYvalue(axisrotated,stacked,xscale,ysc,yscindex,nextData,"x"),y:dataObject.getXYvalue(axisrotated,stacked,xscale,ysc,yscindex,nextData,"y",null,yrangePos)},curBasept=isNullData(curData,dataset,yscindex)?{x:0,y:0}:addBasePointForArea(dataObject,axisrotated,stacked,seriespos,subseriespos,itempos,xscale,ysc,yscindex,hasNegValue,curData,isRangeChart),prevBasept=0==itempos?{x:0,y:0}:isNullData(prevData,dataset,yscindex)?curBasept:addBasePointForArea(dataObject,axisrotated,stacked,seriespos,subseriespos,itempos-1,xscale,ysc,yscindex,hasNegValue,prevData,isRangeChart),nextBasept=itempos==data.length-1?{x:0,y:0}:isNullData(nextData,dataset,yscindex)?curBasept:addBasePointForArea(dataObject,axisrotated,stacked,seriespos,subseriespos,itempos+1,xscale,ysc,yscindex,hasNegValue,nextData,isRangeChart);var prevCur=0==itempos?{x:0,y:0}:isNullData(prevData,dataset,yscindex)?curpt:{x:(prevpt.x+curpt.x)/2,y:(prevpt.y+curpt.y)/2},curNext=itempos==data.length-1?{x:0,y:0}:isNullData(nextData,dataset,yscindex)?curpt:{x:(nextpt.x+curpt.x)/2,y:(nextpt.y+curpt.y)/2},prevbaseCur=0==itempos?{x:0,y:0}:isNullData(prevData,dataset,yscindex)?curBasept:{x:(prevBasept.x+curBasept.x)/2,y:(prevBasept.y+curBasept.y)/2},curbaseNext=itempos==data.length-1?{x:0,y:0}:isNullData(nextData,dataset,yscindex)?curBasept:{x:(nextBasept.x+curBasept.x)/2,y:(nextBasept.y+curBasept.y)/2},points=[];isNullData(prevData,dataset,yscindex)&&isNullData(nextData,dataset,yscindex)?points.push(curpt):0==itempos||isNullData(prevData,dataset,yscindex)?points.push(curpt,curNext,curbaseNext,curBasept):itempos==data.length-1||isNullData(nextData,dataset,yscindex)?points.push(prevCur,curpt,curBasept,prevbaseCur):points.push(prevCur,curpt,curNext,curbaseNext,curBasept,prevbaseCur);return{points:points,prevCur:prevCur,curNext:curNext,curpt:curpt}}function addBasePointForArea(dataObject,axisrotated,stacked,seriespos,subseriespos,itemPos,xsc,ysc,yscindex,hasNegValue,point,isRangeChart){var basePoint,yrangePos=isRangeChart?0:null;if(axisrotated){var xval=dataObject.getXYvalue(axisrotated,stacked,xsc,ysc,yscindex,point,"y",null,yrangePos),yval=isRangeChart?dataObject.getXYvalue(axisrotated,stacked,xsc,ysc,yscindex,point,"x",null,yrangePos):ysc.range()[0],accessor=isRangeChart&&dataset.getY(point,yscindex,0)<0?mathMin:mathMax;basePoint=stacked?{x:0==seriespos&&0==subseriespos&&0==itemPos?mathMax(ysc.range()[0],ysc(hasNegValue)):ysc(point.y0),y:xval}:{x:null!=ysc.bandwidth?ysc.origRange[0]+ysc.bandwidth():accessor(yval,ysc(hasNegValue)),y:xval}}else{xval=dataObject.getXYvalue(axisrotated,stacked,xsc,ysc,yscindex,point,"x"),yval=isRangeChart?dataObject.getXYvalue(axisrotated,stacked,xsc,ysc,yscindex,point,"y",null,yrangePos):ysc.range()[0],accessor=isRangeChart&&dataset.getY(point,yscindex,0)<0?mathMax:mathMin;basePoint=stacked?{x:xval,y:0==seriespos&&0==subseriespos&&0==itemPos?mathMin(ysc.range()[0],ysc(hasNegValue)):ysc(point.y0)}:{x:xval,y:null!=ysc.bandwidth?yval+ysc.bandwidth():accessor(yval,ysc(hasNegValue))}}return basePoint}function hideUnselectedWrap(wrap){wrap.style("display",NONE)}function isWithin(dataPt,mousePt,reversed){var x1=dataPt.x,y1=dataPt.y,x2=x1+dataPt.width,y2=y1+dataPt.height;return reversed&&(axisrotated?x2=(x1-=dataPt.width)+dataPt.width:y2=y1-dataPt.height),x1<=mousePt.x&&mousePt.x<=x2&&(reversed&&!axisrotated?y2<=mousePt.y&&mousePt.y<=y1:y1<=mousePt.y&&mousePt.y<=y2)?0:null}function isWithinPlotarea(xval,yval){return isWithin({x:plotarea.left+(chartObj.scrolledX||0),y:plotarea.top+(chartObj.scrolledY||0),width:plotarea.width,height:plotarea.height},{x:plotarea.left+xval,y:plotarea.top+yval})}function sqr(x){return x*x}function dist2(v,w){return sqr(v.x-w.x)+sqr(v.y-w.y)}function distToSegment(p,v,w){return mathSQRT(function(p,v,w){var l2=dist2(v,w);if(0===l2)return dist2(p,v);var t=((p.x-v.x)*(w.x-v.x)+(p.y-v.y)*(w.y-v.y))/l2;return dist2(p,t<0?v:t>1?w:{x:v.x+t*(w.x-v.x),y:v.y+t*(w.y-v.y)})}(p,v,w))}function lineDistance(point1,point2){var xs=0,ys=0;return xs=point2.x-point1.x,xs*=xs,ys=point2.y-point1.y,mathSQRT(xs+(ys*=ys))}function pointInPolygon(point,poly){for(var xi,xj,yi,yj,x=point.x,y=point.y,inside=!1,i=0,j=poly.length-1;i<poly.length;j=i++)xi=poly[i].x,yi=poly[i].y,xj=poly[j].x,yi>y!=(yj=poly[j].y)>y&&x<(xj-xi)*(y-yi)/(yj-yi)+xi&&(inside=!inside);return inside}function pointInPie(point,curpt,seriespos,subseriespos,d){var pieAngle=getBubblePieAngle(chartObj,seriespos,subseriespos,d);if(!pieAngle)return!1;var angle=mathAtan2(point.x-curpt.x,-(point.y-curpt.y));return isAngleInside(pieAngle.start,pieAngle.end,angle)}function eventDisabled(d){var plotOptions=d.plotoptions,cName=getChartType(d.type||chartObj.userdata.seriesdata.type,"string"),commonPlotOptions=systemConf.chart.plot.plotoptions[cName];return d.disabled||0==validateNullVal(getEventConf(plotOptions,commonPlotOptions,chartObj,"enabled"),!0)}function getCurrentDataPoint(seriesIndex,subseriesIndex,itemIndex,itemPosShared,parent){var renderer=chartObj.renderer[seriesIndex],currentSeriesdata=renderer&&renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[subseriesIndex]:chartObj.seriesdata[seriesIndex].data[subseriesIndex],xPos=tooltipShared&&defined(itemPosShared)?itemPosShared[seriesIndex][subseriesIndex][0]:itemIndex;return parent?currentSeriesdata:currentSeriesdata[xPos]}function getPointRectangle(seriesIndex,subSeriesIndex,itemIndex){if(defined(seriesIndex)&&defined(itemIndex)){subSeriesIndex=pick(subSeriesIndex,0);var seriesRenderer=chartObj.renderer[seriesIndex],currentPoint=seriesRenderer.seriesdataAfterUpdate[subSeriesIndex][itemIndex],barOptions=seriesRenderer.commonOption||getBarCommonOption(chartObj.rendererConf[seriesIndex],seriesIndex);return getBarPosition(chartObj,currentPoint,subSeriesIndex,barOptions)}}function parseHierarchyLevel(level){return{levelIndices:(level=level.split("_")).map(Number),seriesIndex:+level[0],itemIndex:+level[level.length-1]}}function isDefaultAllowed(userFunction,event){return!defined(userFunction)||userFunction&&!0===event.allowDefault}function triggerUserCallback(callback,point,event,extraParams){var userArguments;if("threshold-marker"===point.type){var key="x"===point.thresholdType?"x":"y.groups["+point.yColumnIndex+"]";userArguments=getPropVal(chartObj.axes,key+".threshold.line").getMetaInfo(point)}else userArguments=function(point){var params,rangePoint=point.currentQualitativeRangePoint,dataPoint=pick(point.point,point.data)||{},levels=pick(point.level,dataPoint&&dataPoint.level);params=defined(levels)?parseHierarchyLevel(levels):{seriesIndex:pick(point.seriesPos,dataPoint.seriesIndex),subSeriesIndex:pick(point.subseriesindex,point.subseriesPos,dataPoint.subSeriesIndex),itemIndex:pick(point.itemPos,dataPoint.itemIndex)};isArray(point.subseriesindex)&&point.subseriesindex.some(function(value){if(defined(value))return params.subSeriesIndex=value});defined(rangePoint)&&(params.rangeIndex=rangePoint.rangeIndex,params.targetIndex=rangePoint.targetIndex);defined(params.seriesIndex)&&defined(params.itemIndex)&&(defined(dataPoint)&&isArray(dataPoint.data)&&(dataPoint=dataPoint.data),isArray(dataPoint)||(params.subSeriesIndex=pick(params.subSeriesIndex,0),defined((dataPoint=getCurrentDataPoint(params.seriesIndex,params.subSeriesIndex,params.itemIndex,point.itemPosShared)).level)&&(params.levelIndices=parseHierarchyLevel(dataPoint.level).levelIndices)),params.data=chartObj.dataset.getMetaInfoObj(chartObj,dataPoint,params.seriesIndex));return params.point=dataPoint,params}(point);defined(extraParams)&&"object"==typeof extraParams&&(userArguments=mergeJSON(userArguments,extraParams,!0,!0)),invokeFunction(callback,event,userArguments,chartObj)}return chartObj.cache.thresholdCustomPoints&&(CustomPoints_th=new events.customPoints(chartObj)).addPoints(chartObj.cache.thresholdCustomPoints,!0),events_plot.initializeListener=function(){var eventHandler=chartObj.eventHandler;tapOldInfo=chartObj.eventHandler.tapOldInfo=null,eventHandler.trackerElement=appendEle(wrap,"rect",[1],".","class","eventhandler"),eventHandler.tooltipElement=events.tooltip(tooltipele,systemConf,chartObj),eventHandler.tooltipElement.initialize(),eventHandler.customPoints=CustomPoints_th,addClipToTracker();var trackerEle=chartObj.eventHandler.trackerElement;trackerEle.style("fill-opacity",0);var zoomType=isObjectPropDefined(systemConf.chart,"zoom.type",!0),clickHandlers={click:eventHandler.click,dblclick:eventHandler.doubleclick,contextmenu:eventHandler.contextMenu},moveHandlers={mousemove:eventHandler.mouseMove,mouseout:eventHandler.mouseOut};(attachevents(trackerEle,clickHandlers,null,eventAttacherOptions,"chart"),attachevents(trackerEle,moveHandlers,null,eventAttacherOptions,"chartmove"),attachevents(tooltipele,moveHandlers,null,eventAttacherOptions),zoomType&&zoomType!==NONE)?(setDefaultOptions("zoom",chartObj.systemConf.chart,chartObj.globalProp),eventHandler.initializeZoomListener()):attachevents(trackerEle,{},{tap:eventHandler.click,dbltap:eventHandler.doubleclick,singletouchmove:eventHandler.mouseMove,touchend:eventHandler.mouseOut},eventAttacherOptions);var tooltip=chartObj.eventHandler.tooltipElement,scrollEventName="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",parentNode=chartObj.container.node(),lastPosition=null;if(chartObj.d3container.on(scrollEventName,function(){var currentPosition=parentNode.getBoundingClientRect();lastPosition&&(lastPosition.left===currentPosition.left&&lastPosition.top===currentPosition.top||tooltip.hide(tooltip.element)),lastPosition=currentPosition}),"auto"===systemConf.tooltip.pointerEvents){var tooltipElement=eventHandler.tooltipElement.element;tooltipElement.on("mouseenter",function(){events_plot.mouseOnTooltip=!0}),tooltipElement.on("mouseleave",function(){events_plot.mouseOnTooltip=!1,eventHandler.mouseOut()})}events_plot.reverseLegendHighlight=new ReverseLegendHighlight(chartObj),events_plot.unselectedHighlight=new UnSelectedHighlight(chartObj),chartObj.isGeoMap&&(events_plot.mapEvents=new zmaps.mapEvents(chartObj))},events_plot.initializeZoomListener=function(){chartObj.zoom=events.zoom(chartObj,axisrotated,systemConf,dataset);var trackerEle=chartObj.eventHandler.trackerElement,documentElement=d3_select(document.documentElement),zmevent=chartObj.zoom,eventHandler=chartObj.eventHandler;zmevent.zmInit();var zoomInitialized=!1,handlers={mousedown:function(){detachevent(trackerEle,"chartmove"),attachevents(documentElement,mousemoveHandlers,null,eventAttacherOptions,"zoommove"),d3.event.preventDefault()}},mousemoveHandlers={mousemove:function(){chartObj.eventHandler.mousePos=getMousePosition(trackerEle.node(),d3.event),zoomInitialized||(chartObj.eventHandler.mouseOut(),zmevent.zmStart(chartObj.eventHandler.mousePos),zoomInitialized=!0),zmevent.zmMove(chartObj.eventHandler.mousePos)},mouseup:function(){detachevent(documentElement,"zoommove",mousemoveHandlers);var zmdata=zmevent.zmEnd(chartObj.eventHandler.mousePos);zoomInitialized&&(chartObj.eventHandler.mousePos=getMousePosition(trackerEle.node(),d3.event),(zmevent=chartObj.zoom).zoomed(zmdata));var handlers={mousemove:eventHandler.mouseMove,mouseout:eventHandler.mouseOut};attachevents(trackerEle,handlers,null,eventAttacherOptions,"chartmove"),zoomInitialized=!1}},zoomMoveHandlers={tap:eventHandler.click,dbltap:eventHandler.doubleclick,doubletouchmove:function(){chartObj.eventHandler.mousePos=getMousePosition(trackerEle.node(),d3.event),zoomInitialized||(chartObj.eventHandler.mouseOut(),zmevent.zmStart(chartObj.eventHandler.mousePos),zoomInitialized=!0),zmevent.zmMove(chartObj.eventHandler.mousePos)},touchend:function(){detachevent(documentElement,null,mousemoveHandlers);var zmdata=zmevent.zmEnd(chartObj.eventHandler.mousePos);zoomInitialized?(chartObj.eventHandler.mousePos=getMousePosition(trackerEle.node(),d3.event),(zmevent=chartObj.zoom).zoomed(zmdata)):eventHandler.mouseOut(),zoomInitialized=!1},singletouchmove:eventHandler.mouseMove};attachevents(trackerEle,handlers,zoomMoveHandlers,eventAttacherOptions,"zoom")},events_plot.updateParams=function(chartObj_new){systemConf=(chartObj=chartObj_new).systemConf,plotarea=chartObj.plotarea,dataset=chartObj.dataset,xscale=chartObj.axes.x.eventscale,yscale=chartObj.axes.y.groups,barscale1=chartObj.barscale1,barscale2=chartObj.barscale2,color=chartObj.seriesColor,tooltipele=chartObj.tooltip.element,stacked=function(cType){return chartObj.dataObject.isstacked(cType)},axisrotated=chartObj.dataObject.getAxisRotated(),wrap=chartObj.staticPaneSVG.selectAll("g.eventgroup"),datatype=dataset.getDataType("x"),tooltipEnabled=!0===systemConf.tooltip.enabled,chartObj.eventHandler.tooltipElement=events.tooltip(chartObj.tooltip.element,systemConf,chartObj),chartObj.eventHandler.tooltipElement.initialize(),chartObj.eventHandler.bulletEvents=null,tooltipShared=tooltip_helpers.hasSharedSeries(chartObj),events_plot.reverseLegendHighlight=new ReverseLegendHighlight(chartObj),events_plot.unselectedHighlight=new UnSelectedHighlight(chartObj),CustomPoints_th&&(CustomPoints_th.removePoints(0,CustomPoints_th.points.length),CustomPoints_th.addPoints(chartObj.cache.thresholdCustomPoints,!0)),(chartObj.xymultiRenderer||isPolarAxisCategory||chartObj.isGeoMap)&&(drawBorderBox(chartObj.eventHandler.trackerElement,chartObj.plotarea),addClipToTracker()),chartObj.zoom&&chartObj.zoom.zmInit(!0),chartObj.isGeoMap&&events_plot.mapEvents.initialize()},events_plot.mouseMove=function(args){args.element;if(chartObj.chartRendered){var tooltip=chartObj.eventHandler.tooltipElement;if(null!=tooltip&&null!=tooltip.timeout&&clearTimeout(tooltip.timeout),!1!==chartObj.stopPropogate&&d3.event.stopPropagation(),chartObj.eventHandler.targetEvent=d3.event,chartObj.xymultiRenderer||isPolarAxisCategory||chartObj.isGeoMap){chartObj.eventHandler.mousemovetimer&&clearTimeout(chartObj.eventHandler.mousemovetimer);node=chartObj.eventHandler.trackerElement.node();chartObj.eventHandler.mousePos=getMousePosition(node,d3.event),chartObj.eventHandler.mousemovetimer=setTimeout(function(){if(chartObj.isGeoMap)events_plot.mapEvents.handleEvent(chartObj.eventHandler.mousePos,"mousemove",chartObj.eventHandler.targetEvent);else{var containsBarchart=chartObj.dataObject.noofBarEnabledSeries>0;(datatype===ORDINAL_DATATYPE&&(containsBarchart||tooltipShared)?ordinalDatamouseMove:xydatamouseMove)(chartObj.eventHandler.mousePos,chartObj.eventHandler.targetEvent,node)}},0)}else{var node=chartObj.svg.node();chartObj.eventHandler.mousePos=getMousePosition(node,d3.event);var relmousePt={x:chartObj.eventHandler.mousePos[0],y:chartObj.eventHandler.mousePos[1]},currentEle=d3.event.srcElement||d3.event.target;d3_select(currentEle).attr("id");if(args=args.constructor===Object?args:chartObj.eventHandler.oldRenderer){var seriesdata=chartObj.seriesdata,chartName=chartObj.chartTypes[0].name,plotOptions=seriesdata[args.seriesPos].plotoptions,commonPlotOptions=systemConf.chart.plot.plotoptions[chartName],eventType=chartObj.zcEventType||"mousemove",mouseMoveFn=getEventConf(plotOptions,commonPlotOptions,chartObj,eventType),evt=d3.event||chartObj.eventHandler.targetEvent;if(defined(mouseMoveFn)&&triggerUserCallback(mouseMoveFn,args,evt),isDefaultAllowed(mouseMoveFn,evt)&&(chartObj.eventHandler.oldRenderer=args,args.renderer.defaultMouseOverFunc(args.data,args.seriesPos,args.itemPos)),tooltipEnabled){var tooltipPos={left:relmousePt.x,top:relmousePt.y};evt=getEventObject(d3.event);var dLeft=relmousePt.x-evt.clientX,dTop=relmousePt.y-evt.clientY;tooltipPos.left-=dLeft,tooltipPos.top-=dTop,tooltipPos.dLeft=dLeft,tooltipPos.dTop=dTop;var tooltipArgs={seriesindex:args.seriesPos,subseriespos:args.subseriesPos,color:args.color||color,svgFillFunc:args.renderer.fillColorFunc,itempos:args.itemPos,d:chartObj.dataObject.isHierarchy?args.data.data||args.data:null};tooltip.show(chartObj,tooltipPos,null,!0,tooltipArgs)}}}}var currentPoint=chartObj.isAxisCategory||isPolarAxisCategory||chartObj.isGeoMap?chartObj.eventHandler.oldInfo&&chartObj.eventHandler.oldInfo.nearestPoint:args;events_plot.reverseLegendHighlight.highlight(currentPoint),events_plot.unselectedHighlight.highlight(currentPoint)},events_plot.mouseOut=function(renderer,data,index,showTooltip,forceMouseOut){if(!0!==events_plot.mouseOnTooltip){var seriesdata=chartObj.seriesdata;index=index||0;var chartName=chartObj.chartTypes[0].name,plotOptions=chartObj.isNonAxisMultiSeriesCategory&&!isPolarAxisCategory?seriesdata[index].plotoptions:seriesdata[0].plotoptions,commonPlotOptions=systemConf.chart.plot.plotoptions[chartName],oldInfo=chartObj.eventHandler.oldInfo,tooltipHideDelay=systemConf.tooltip.hideDelay,closestPoint={},event=d3.event||chartObj.eventHandler.targetEvent,tooltip=chartObj.eventHandler.tooltipElement;if(events_plot.unselectedHighlight.reset(),chartObj.isGeoMap)return events_plot.mapEvents.handleEvent(null,"mouseout",event);oldInfo&&(closestPoint=pick(oldInfo.nearestPoint,closestPoint),oldInfo.customPoint&&(commonPlotOptions=oldInfo.customPoint));var mouseOutFn=getEventConf(plotOptions,commonPlotOptions,chartObj,"mouseout");if(forceMouseOut||chartObj.chartRendered){var point,withIn=0;if(defined(mouseOutFn))if(!chartObj.xymultiRenderer||null!=oldInfo&&!oldInfo.isNoInfo)oldInfo&&defined(oldInfo.nearestPoint)?point=oldInfo.nearestPoint:data&&(point={seriesPos:0,itemPos:index,point:data.data}),defined(point)&&triggerUserCallback(mouseOutFn,point,event);else oldInfo&&defined(oldInfo.customPoint)&&triggerUserCallback(mouseOutFn,oldInfo.customPoint,event);if(isDefaultAllowed(mouseOutFn,event)){if(chartObj.xymultiRenderer||isPolarAxisCategory){event=d3.event;var node=chartObj.eventHandler.trackerElement.node(),mouse=null!=event?getMousePosition(node,event):chartObj.eventHandler.mousePos;withIn=isWithin(bbox(node),{x:axisrotated?mouse[1]:mouse[0],y:axisrotated?mouse[0]:mouse[1]})}var relatedTarget=null!=event?event.relatedTarget:null,target=null!=event?event.target:null;if(chartObj.xymultiRenderer&&0==withIn&&null!=relatedTarget&&null!=tooltip&&(target==tooltip.element.node()||target==tooltip.element.selectAll("div#tooltipcontent").node()||relatedTarget==tooltip.element.node()||relatedTarget==tooltip.element.selectAll("div#tooltipcontent").node()))return;if(!chartObj.xymultiRenderer&&!isPolarAxisCategory)if(renderer=renderer||chartObj.renderer[index],"zctooltip"==this.id||null!=relatedTarget&&null!=tooltip&&(target==tooltip.element.node()||target==tooltip.element.selectAll("div#tooltipcontent").node()||target==tooltip.element.selectAll("div#zctooltipafter").node()||target==tooltip.element.selectAll("div#zctooltipbefore").node()||relatedTarget==tooltip.element.node()||relatedTarget==tooltip.element.selectAll("div#tooltipcontent").node()||relatedTarget==tooltip.element.selectAll("div#zctooltipafter").node()||relatedTarget==tooltip.element.selectAll("div#zctooltipbefore").node())){var actualRenderer=chartObj.eventHandler.oldRenderer;null!=actualRenderer&&actualRenderer.renderer.defaultMouseOutFunc(actualRenderer.data,chartObj.isNonAxisMultiSeriesCategory?actualRenderer.seriesPos:actualRenderer.itemPos,forceMouseOut)}else renderer.defaultMouseOutFunc(data,index,forceMouseOut)}clearTimeout(chartObj.eventHandler.mouseouttimer),chartObj.eventHandler.mouseouttimer=setTimeout(function(){!0!==showTooltip&&(clearTimeout(chartObj.eventHandler.tooltipElement.timeout),chartObj.eventHandler.tooltipElement.timeout=setTimeout(function(){hideHighlighterPoints(),tooltip.hide()},pick(tooltipHideDelay,150)))},0),events_plot.reverseLegendHighlight.reset(),events_plot.hideCursor(chartObj.eventHandler.trackerElement)}}},events_plot.click=function(renderer,data,seriesPos,itemPos,args){if(chartObj.chartRendered){var seriesdata=chartObj.seriesdata,isTouchEvent=d3.event&&d3.event.touches,eventType=chartObj.zcEventType||"click";isTouchEvent&&"taphold"!==eventType&&(documentTapEvent(chartObj),$ZCG.clickedTime=(new Date).getTime(),$ZCG.clickedElement=this,$ZCG.clickArguments=[renderer,data,seriesPos,itemPos],$ZCG.previousChartObj=chartObj);var tooltip=chartObj.eventHandler.tooltipElement,evt=d3.event||chartObj.eventHandler.targetEvent;if(chartObj.xymultiRenderer||isPolarAxisCategory||chartObj.isGeoMap){var event=d3.event,mouse=getMousePosition(element=chartObj.eventHandler.trackerElement.node(),event)||chartObj.eventHandler.mousePos;if(chartObj.isGeoMap)return events_plot.mapEvents.handleEvent(mouse,"click",event);var relativeelement=bbox(element);relmousePt={x:mouse[0]-relativeelement.x-(isPolarAxisCategory?chartObj.plotarea_approx.x:0),y:mouse[1]-relativeelement.y-(isPolarAxisCategory?chartObj.plotarea_approx.y:0)};element=this;var containsBarchart=chartObj.dataObject.noofBarEnabledSeries>0,nearestPoint=(datatype===ORDINAL_DATATYPE&&containsBarchart?getOrdinalDataPoint:getClosestPoint)(relmousePt,xscale,yscale,systemConf),seriespos=nearestPoint.seriesPos,subseriesindex=(itemPos=nearestPoint.itemPos,isArray(nearestPoint.subseriesindex)?nearestPoint.subseriesindex[seriespos]:nearestPoint.subseriesindex),customPoint=pick(nearestPoint.customPoint,nearestPoint.currentQualitativeRangePoint);if(defined(customPoint)){var thresholdClick=getEventConf(null,customPoint,chartObj,eventType);defined(thresholdClick)&&triggerUserCallback(thresholdClick,customPoint,event),chartObj.eventHandler.oldInfo={customPoint:customPoint,isNoInfo:!0}}if(null==seriespos&&!defined(customPoint))return void(isTouchEvent&&(chartObj.eventHandler.mouseOut(),chartObj.eventHandler.tapOldInfo=null));if(defined(seriespos))var type=chartObj.chartTypes[seriespos].value,cursor=(clickFn=getEventConf(plotOptions=seriesdata[seriespos].plotoptions,commonPlotOptions=systemConf.chart.plot.plotoptions[charttypenames.get(type)],chartObj,eventType,nearestPoint.currentQualitativeRangePoint),getEventConf(plotOptions,commonPlotOptions,chartObj,"cursor"));if(defined(clickFn)){var yscindex=getParsedYAxisOrder(seriesdata[seriespos].yaxiscolumnorder),ysc=yscale[yscindex].eventscale;data=getCurrentDataPoint(seriespos,subseriesindex,itemPos,nearestPoint.itemPosShared);if(isBarChartType(type)){var highlightPoint=nearestPoint.highlightpoint||getPointRectangle(seriespos,subseriesindex,itemPos);events_plot.addCursor(cursor),triggerUserCallback(clickFn,nearestPoint,evt,{x:highlightPoint.x,y:highlightPoint.y})}else{var xval=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"x"),yval=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"y");if(!((isAreaChartType(type)||isPolarAxisCategory?null:lineDistance({x:xval,y:yval},relmousePt))<=(isBubbleChartType(type)?chartObj.zscale(chartObj.dataset.getZ(data))/2:10)))return void events_plot.hideCursor(chartObj.eventHandler.trackerElement);events_plot.addCursor(cursor),triggerUserCallback(clickFn,nearestPoint,evt,{x:xval,y:yval})}}if(isDefaultAllowed(clickFn,evt)&&(tooltip.hide(tooltip.element),events_plot.hideCursor(chartObj.eventHandler.trackerElement)),isTouchEvent&&"taphold"!==eventType&&isDefaultAllowed(clickFn,evt)){tapOldInfo=chartObj.eventHandler.tapOldInfo;var currentQualitativeRangePoint=nearestPoint.currentQualitativeRangePoint||{},currentQualitativeRangePoint_old=tapOldInfo&&tapOldInfo.currentQualitativeRangePoint||{};!tapOldInfo||tapOldInfo.itemPos!=itemPos||tapOldInfo.seriesPos!=seriespos||tapOldInfo.subseriesindex!=subseriesindex||currentQualitativeRangePoint.rangeIndex!=currentQualitativeRangePoint_old.rangeIndex||currentQualitativeRangePoint.targetIndex!=currentQualitativeRangePoint_old.targetIndex||(nearestPoint.highlightpoint&&nearestPoint.highlightpoint.type||currentQualitativeRangePoint.type)!=currentQualitativeRangePoint_old.type?(chartObj.eventHandler.mouseMove({}),chartObj.eventHandler.tapOldInfo={seriesPos:seriespos,subseriesindex:subseriesindex,itemPos:itemPos,currentQualitativeRangePoint:currentQualitativeRangePoint,type:nearestPoint.highlightpoint&&nearestPoint.highlightpoint.type||currentQualitativeRangePoint.type}):(chartObj.eventHandler.mouseOut(),chartObj.eventHandler.tapOldInfo=null)}}else{var plotOptions,commonPlotOptions,clickFn,chartName=chartObj.chartTypes[0].name;if(defined(clickFn=getEventConf(plotOptions=seriesdata[chartObj.isNonAxisMultiSeriesCategory?seriesPos:0].plotoptions,commonPlotOptions=systemConf.chart.plot.plotoptions[chartName],chartObj,eventType))&&triggerUserCallback(clickFn,args,evt),isDefaultAllowed(clickFn,evt)&&(tooltip.hide(tooltip.element),events_plot.hideCursor(chartObj.eventHandler.trackerElement)),isTouchEvent&&"taphold"!==eventType&&isDefaultAllowed(clickFn,evt))if((tapOldInfo=chartObj.eventHandler.tapOldInfo)&&(args.level?args.level==tapOldInfo.level:tapOldInfo.itemPos==itemPos&&tapOldInfo.seriesPos==seriesPos&&0==tapOldInfo.subseriesindex))renderer.defaultMouseOutFunc(data,itemPos),chartObj.eventHandler.tapOldInfo=null;else{if(renderer.defaultMouseOverFunc(data,seriesPos,itemPos),tooltipEnabled){var node=chartObj.svg.node();chartObj.eventHandler.mousePos=getMousePosition(node,d3.event);var relmousePt,tooltipPos={left:(relmousePt={x:chartObj.eventHandler.mousePos[0],y:chartObj.eventHandler.mousePos[1]}).x,top:relmousePt.y},dLeft=(evt=getEventObject(d3.event),relmousePt.x-evt.clientX),dTop=relmousePt.y-evt.clientY;tooltipPos.left-=dLeft,tooltipPos.top-=dTop,tooltipPos.dLeft=dLeft,tooltipPos.dTop=dTop;var tooltipArgs={seriesindex:args.seriesPos,subseriespos:args.subseriesPos,color:args.color||color,svgFillFunc:args.renderer.fillColorFunc,itempos:args.itemPos,d:chartObj.dataObject.isHierarchy?args.data.data||args.data:null};tooltip.show(chartObj,tooltipPos,null,!0,tooltipArgs)}chartObj.eventHandler.tapOldInfo={seriesPos:seriesPos,subseriesindex:0,itemPos:itemPos,level:args.level}}}}},events_plot.doubleclick=function(data,index,args){if(chartObj.chartRendered){chartObj.noPropogate&&d3.event.stopPropagation(),d3.event&&d3.event.touches&&!chartObj.isGeoMap&&(chartObj.eventHandler.mouseOut(),chartObj.eventHandler.tapOldInfo=null);var evt=d3.event||chartObj.eventHandler.targetEvent,tooltip=chartObj.eventHandler.tooltipElement,seriesdata=chartObj.seriesdata,eventType=chartObj.zcEventType||"doubleclick";if(chartObj.xymultiRenderer||isPolarAxisCategory||chartObj.isGeoMap){var mouse=getMousePosition(element=chartObj.eventHandler.trackerElement.node(),d3.event);if(chartObj.isGeoMap)return events_plot.mapEvents.handleEvent(mouse,"doubleclick",event);var relativeelement=bbox(element),relmousePt={x:mouse[0]-relativeelement.x-(isPolarAxisCategory?chartObj.plotarea_approx.x:0),y:mouse[1]-relativeelement.y-(isPolarAxisCategory?chartObj.plotarea_approx.y:0)};element=this;var containsBarchart=chartObj.dataObject.noofBarEnabledSeries>0,nearestPoint=(datatype===ORDINAL_DATATYPE&&containsBarchart?getOrdinalDataPoint:getClosestPoint)(relmousePt,xscale,yscale,systemConf),customPoint=pick(nearestPoint.customPoint,nearestPoint.currentQualitativeRangePoint);if(defined(customPoint)&&!defined(seriespos)){var thresholdClick=getEventConf(null,customPoint,chartObj,eventType);return defined(thresholdClick)&&triggerUserCallback(thresholdClick,customPoint,evt),void(chartObj.eventHandler.oldInfo={customPoint:customPoint,isNoInfo:!0})}var seriespos=nearestPoint.seriesPos;if(null==seriespos)return;var itemPos=nearestPoint.itemPos,subseriesindex=nearestPoint.subseriesindex instanceof Array?nearestPoint.subseriesindex[seriespos]:nearestPoint.subseriesindex,type=(data=getCurrentDataPoint(seriespos,subseriesindex,itemPos,nearestPoint.itemPosShared),chartObj.chartTypes[seriespos].value),cursor=(dblClickFn=getEventConf(plotOptions=seriesdata[seriespos].plotoptions,commonPlotOptions=systemConf.chart.plot.plotoptions[charttypenames.get(type)],chartObj,eventType,nearestPoint.currentQualitativeRangePoint),getEventConf(plotOptions,commonPlotOptions,chartObj,"cursor"));if(isBarChartType(type)){if(events_plot.addCursor(cursor),defined(dblClickFn)&&triggerUserCallback(dblClickFn,nearestPoint,evt),isDefaultAllowed(dblClickFn,evt)){var highlightPoint=pick(nearestPoint.highlightpoint,{});addNoteFunction(null,seriespos,itemPos,getCurrentDataPoint(seriespos,subseriesindex,itemPos,nearestPoint.itemPosShared,!0),highlightPoint.x,highlightPoint.y)}}else{var yscindex=getParsedYAxisOrder(seriesdata[seriespos].yaxiscolumnorder),ysc=yscale[yscindex].eventscale,xval=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"x")+(isPolarAxisCategory?chartObj.plotarea_approx.x:0),yval=chartObj.dataObject.getXYvalue(axisrotated,stacked(type),xscale,ysc,yscindex,data,"y")+(isPolarAxisCategory?chartObj.plotarea_approx.y:0);if((isAreaChartType(type)||isPolarAxisCategory?null:lineDistance({x:xval,y:yval},relmousePt))<=(isBubbleChartType(type)?chartObj.zscale(chartObj.dataset.getZ(data))/2:10))if(events_plot.addCursor(cursor),defined(dblClickFn)&&triggerUserCallback(dblClickFn,nearestPoint,evt,{x:xval,y:yval}),isDefaultAllowed(dblClickFn,evt))addNoteFunction(null,seriespos,itemPos,getCurrentDataPoint(seriespos,subseriesindex,itemPos,nearestPoint.itemPosShared,!0),xval,yval);isDefaultAllowed(dblClickFn,evt)&&events_plot.hideCursor(chartObj.eventHandler.trackerElement)}}else{var plotOptions,commonPlotOptions,dblClickFn,chartName=chartObj.chartTypes[0].name;defined(dblClickFn=getEventConf(plotOptions=seriesdata[chartObj.isNonAxisMultiSeriesCategory?index:0].plotoptions,commonPlotOptions=systemConf.chart.plot.plotoptions[chartName],chartObj,eventType))&&triggerUserCallback(dblClickFn,{seriesPos:0,itemPos:index,point:data.data},evt),isDefaultAllowed(dblClickFn,evt)&&addNoteFunction(args)}isDefaultAllowed(dblClickFn,evt)&&(tooltip.hide(tooltip.element),events_plot.hideCursor(chartObj.eventHandler.trackerElement))}},events_plot.contextMenu=function(args){var contextMenuFn=systemConf.chart.plot.events.contextmenu;null!=contextMenuFn&&(invokeFunction(contextMenuFn,d3.event||chartObj.eventHandler.targetEvent,chartObj),d3.event.preventDefault())},events_plot.addCursor=function(cur){var trackerElement=getEventTrackerElement();cur=cur||(isObjectPropDefined(systemConf.chart,"zoom.type")&&chartObj.systemConf.chart.zoom.type!=NONE?"crosshair":POINTER);trackerElement.style("cursor",cur)},events_plot.hideCursor=function(){getEventTrackerElement().style("cursor","default")},events_plot.hoverScatter=hoverScatter,events_plot.helpers={isDefaultAllowed:isDefaultAllowed,triggerUserCallback:triggerUserCallback,eventDisabled:eventDisabled},events_plot.hoverPolygon=hoverPolygon,events_plot.hoverScatter=hoverScatter,events_plot.getPolygonPoints=getPolygonPoints,events_plot},CustomPoints.prototype.getClosest=function(mouse,pointDistance){defined(pointDistance)||(pointDistance=Number.MAX_VALUE);for(var currentPoint,triggerOffset,x,y,point,points=this.points,count=points.length,closestPoint=null,onPoint=null,minimumDistance=pointDistance,currentDistance=0;count--;)"circle"===(currentPoint=points[count])._type?(triggerOffset=currentPoint.triggerOffset||0,x=mouse.x,y=mouse.y,(currentDistance=mathSQRT((x-(point=currentPoint).cx)*(x-point.cx)+(y-point.cy)*(y-point.cy))-(point.r||0))<triggerOffset&&currentDistance<minimumDistance&&(currentDistance<=0&&(onPoint=currentPoint),minimumDistance=currentDistance,closestPoint=currentPoint)):"rect"===currentPoint._type&&pointInRectangle(mouse.x,mouse.y,currentPoint)&&(closestPoint=onPoint=currentPoint);return pick(onPoint,closestPoint)},CustomPoints.prototype.addPoints=function(points,toCircle){if(points)return toCircle&&(points=CustomPoints.toCircle(points)),Array.prototype.push.apply(this.points,CustomPoints.addType(splat(points))),this},CustomPoints.prototype.removePoints=function(fromIndex,itemCount){return this.points.splice(fromIndex,itemCount||1)},CustomPoints.prototype.hoverPoint=function(point,event,mouse,showTooltip,showMarker,forceHover){showMarker=!1!==showMarker,(showTooltip=!1!==showTooltip)&&function(chart,event,mouse,point,highlight,forceHover){var oldInfo=chart.eventHandler.oldInfo,tooltip=chart.systemConf.tooltip,tooltipShared=chart.systemConf.tooltip.sharedSeriesInfo,wrap=chart.staticPaneSVG.selectAll("g.eventgroup"),tooltipEnabled=!0===tooltip.enabled||!0===forceHover,tooltipEvent=chart.eventHandler.tooltipElement;oldInfo&&!1===oldInfo.isNoInfo&&chart.eventHandler.mouseOut();clearTimeout(tooltipEvent.timeout),wrap.selectAll("#zcscatterhighlight,#zcbarhighlight,#zcareahighlight").style("display",NONE);var x=point.x+point.width/2,y=point.y+point.height/2;defined(mouse)||(mouse={x:x,y:y});defined(event)&&(event=getEventObject(event));if(!defined(event)){var chartSVGPosition=chart.svg.node().getBoundingClientRect();event={clientX:x+chart.plotarea.left+chartSVGPosition.x,clientY:y+chart.plotarea.top+chartSVGPosition.y}}highlight&&"circle"===point._type&&function(point,x,y,wrap,plotArea,chartObj){var scatterWrap=wrap.selectAll("#zcscatterhighlight").style("display",null).attr("transform","translate("+plotArea.left+","+plotArea.top+")"),hoverOptions=getPropVal(point.marker,"hoveroptions")||{},symbolOptions={color:point.color,symbolSize:{inner:point.size/2,outer:point.size},transform:[x,y]};addSVGmarker(scatterWrap,null,hoverOptions,symbolOptions,chartObj)}(point,x,y,wrap,chart.plotarea,chart);if(tooltipEnabled){var tooltipPos=getTooltipPosition(event,mouse,x,y,chart,null,chart.axes.rotated,tooltipShared,null,!1,!1),tooltipContent=[point.text,point.formattedValue].join(": "),marker=point.marker,pointEvents=pick(point.events,{}),tooltipFunction=pointEvents.tooltipContent;if(defined(tooltipFunction)){var temp=invokeFunction(tooltipFunction,event,{data:[point.columnInfo],itemIndex:point.itemIndex,point:point.point,pointFormatted:point.formattedValue},chart);defined(temp)&&(tooltipContent=temp)}tooltipPos.helpers.backgroundColor=pick(tooltip.backgroundColor,marker.fillColor,point.color),tooltipPos.helpers.borderColor=pick(tooltip.borderColor,marker.strokeColor,point.color),tooltipEvent.show(chart,tooltipPos,tooltipContent,!1,tooltipPos.helpers)}}(this.chart,event||d3$1.event,mouse,point,showMarker,forceHover)},CustomPoints.prototype.leavePoints=function(){if(this.points.length){var chart=this.chart;chart.staticPaneSVG.selectAll("g.eventgroup").selectAll("#zcscatterhighlight").style("display",NONE),chart.eventHandler.tooltipElement.hide()}},CustomPoints.toCircle=function(points){return points.forEach(function(point){point._converted||defined(point.r)||(point.cx=point.x+point.width/2,point.cy=point.y+point.height/2,point.r=mathMax(point.width,point.height)/2,point._converted=!0)}),points},CustomPoints.addType=function(points){return points.forEach(function(point){defined(point.r)?point._type="circle":defined(point.x)&&defined(point.y)&&defined(point.width)&&defined(point.height)?point._type="rect":point._type="poly"}),points},events.customPoints=CustomPoints,BulletEvent.prototype.getCurrentPoint=function(coordinate,point){for(var currentRect,rectangles=this.getCurrentRectangles(point),count=rectangles.length;count--;)if(currentRect=rectangles[count],pointInRectangle(coordinate.x,coordinate.y,currentRect))return currentRect;return null},BulletEvent.prototype.getCurrentRectangles=function(point){if(point.isDummy)return[];var chart=this.chart,xKey=chart.dataset.getX(point);if(this.cache.has(xKey))return this.cache.get(xKey);var y,height,formatConf,col,scaleY=this.scale.y,scaleX=this.scale.x,levelMarker=chart.systemConf.chart.plot.plotoptions.bullet.levelMarker,targetMarker=chart.systemConf.chart.plot.plotoptions.bullet.targetMarker,barOption=this.barOptions,x=scaleX(xKey)+barOption.levelMarkerPadding,bandWidth=scaleX.bandwidth(),width=mathMin(levelMarker.maxBandWidth,bandWidth),datatype=chart.dataset.getDataType("y",0),rectangles=[],originalValues=point[levelMarker.dataindex]||[],axisrotated=this.axesRotated,itemIndex=scaleX.domain().indexOf(xKey),tempRect=null;isArray(originalValues)||(originalValues=[originalValues]);var steps=originalValues.slice(0);if(datatype===TIME_DATATYPE){var column=chart.dataset.getColumn("y",0);formatConf=defined(column.time)?column.time:null}steps.push(0),steps=steps.map(function(point){return datatype===TIME_DATATYPE?generateDateVal(point,0,formatConf).getTime():point});var len,temp=(steps=axisrotated?steps.sort(d3_ascending):steps.sort(d3_descending)).map(function(target){return scaleY(target)});for(steps.splice(steps.indexOf(0),1),len=(col=temp.length-1)-1;col--;)(height=temp[col+1]-temp[col])>0&&(y=temp[col]),y=temp[col],height>0&&((tempRect=getDimension(x,y,width,height,axisrotated)).currentStage=steps[col],tempRect.type="levelMarker",tempRect.data=point,tempRect.rangeIndex=len-col,tempRect.itemIndex=itemIndex,tempRect.events=levelMarker.events,tempRect.chartType=chart.chartTypes[0],rectangles.push(tempRect));if(!0===targetMarker.enabled){width=pick(targetMarker.size,barOption.levelMarkerWidth-2*pick(targetMarker.padding,barOption.padding/2)),defined(targetMarker.size)&&(width=10*mathMin(width,bandWidth/10)),height="line"===targetMarker.symbol?mathMax(pick(targetMarker.outerStrokeWidth,targetMarker.innerStrokeWidth,0)):width;var currentStage=point[targetMarker.dataindex];x=scaleX(chart.dataset.getX(point))-0,y=scaleY(currentStage)-0,x+=(bandWidth-width)/2,y-=height/2,height<5&&(height=5,y-=2.5);var triggerOffset=(targetMarker.events||{}).triggerOffset||0;(tempRect=getDimension(x-=triggerOffset/2,y-=triggerOffset/2,width+=triggerOffset+0,height+=triggerOffset+0,axisrotated)).type="marker",tempRect.data=point,tempRect.currentStage=currentStage,tempRect.itemIndex=itemIndex,tempRect.targetIndex=0,tempRect.events=targetMarker.events,tempRect.chartType=chart.chartTypes[0],rectangles.push(tempRect)}return this.cache.set(xKey,rectangles),rectangles},BulletEvent.prototype.getTooltipContent=function(currentPoint,seriesIndex){var chart=this.chart,plotOptions=chart.systemConf.chart.plot.plotoptions.bullet,levelMarkerColumnInfo=getColumnIdxBasedOnDataindex(chart,plotOptions.levelMarker),targetMarkerColumnInfo=getColumnIdxBasedOnDataindex(chart,plotOptions.targetMarker),levelMarkerEvents=getPropVal(plotOptions,"levelMarker.events")||{},targetMarkerEvents=getPropVal(plotOptions,"targetMarker.events")||{},columnInfo=("marker"===this.type?targetMarkerColumnInfo:levelMarkerColumnInfo)||chart.dataset.getColumn("y",0),value=currentPoint.currentStage,dataType=columnInfo.datatype,metaInfo=chart.dataset.getMetaInfoObj(chart,currentPoint.data,seriesIndex),formattedValue=getFormattedValue(columnInfo[dataType],value,dataType,chart,"tooltip"),userCallback={value:value,formattedValue:formattedValue,actualData:currentPoint.data,data:metaInfo};return"marker"===currentPoint.type?invokeFunction(targetMarkerEvents.tooltipContent,userCallback,chart,"tooltip")||"Target: "+formattedValue:invokeFunction(levelMarkerEvents.tooltipContent,userCallback,chart,"tooltip")||"Range: "+formattedValue},events.BulletEvent=BulletEvent,dataLabel_handler.DATALABELS_getPreCalculatedSize=function(type,serData,chartObj){if(chartObj.dataObject.hasLevelMarker||!serData)return 0;var size,sizeArray=[],systemconf=chartObj.systemConf,dataObj=chartObj.dataObject,axisrotated=dataObj.getAxisRotated(),stacked=dataObj.isstacked(),hasBarSeries=dataObj.noofBarEnabledSeries,dim=.75*(axisrotated?chartObj.plotarea.width:chartObj.plotarea.height),handleOverlap=systemconf.chart.plot.datalabels.handleOverlapping,isYaxis="y"===type,dummyTextObj=new DUMMYTEXT(chartObj),dummyText=dummyTextObj.createElement();if(chartObj.seriesdata.forEach(function(series,i){if(!series.disabled){var plotoptions=series.plotoptions,dataLabels=getMergedDatalabelOptions(systemconf.chart.plot.plotoptions[chartObj.chartTypes[i].name],plotoptions);if(isDatalabelEnabled(dataLabels,chartObj)){dummyTextObj.setFont(dataLabels,i);var isFixedDatalabels=isYaxis&&hasBarSeries&&!stacked&&getValignforBarLabels(chartObj,i)===FIXEDTOP_ALIGN,GLT=dataLabelTextContent(chartObj,null,dataLabels,DATALABELS_LABELTYPE,null,i),padding=isYaxis?mathMax(0,mathMin(validateNullVal(dataLabels.padding,isFixedDatalabels&&isBarChartType(chartObj.chartTypes[i].value)?2:0),dim)):0;isFixedDatalabels&&isBoundBoxEnabled(dataLabels,chartObj)&&(padding=padding+2*getBoundBoxPadding(dataLabels,chartObj)+getBoundBoxStrokeWidth(dataLabels,chartObj)),isFixedDatalabels&&(axisrotated||"html"===GLT.contentType)?function(chartObj,options,dummyTextObj,axisrotated,padding,sizeArray,seriesIndex){var size,dataObj=chartObj.dataObject,curSeriesdata=chartObj.seriesdata[seriesIndex],yaxiscolumnorder=DataProcessor.helpers.getParsedYAxisOrder(curSeriesdata.yaxiscolumnorder),datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder),xCategories=dataObj.getDomain(dataObj.getCategories("x"),!0),yCategories=datatypeY==ORDINAL_DATATYPE?dataObj.getCategories("y",yaxiscolumnorder):null,GLT=dataLabelTextContent(chartObj,null,options,DATALABELS_LABELTYPE,null,seriesIndex),maxWidth=perToPx(defined(options.maxWidth)?options.maxWidth:"30%",chartObj.plotarea.width);curSeriesdata.data.forEach(function(d,i){var subseriesData=dataObj.updateSeriesdatabyCategories(d3_values(d),xCategories,yCategories,yaxiscolumnorder);subseriesData.forEach(function(d){dummyTextObj.updateText(GLT,d),size=dummyTextObj.getMeasure(axisrotated?"w":"h"),axisrotated&&(size=mathMin(size,maxWidth)),sizeArray.push(size+padding)})})}(chartObj,dataLabels,dummyTextObj,axisrotated,padding,sizeArray,i):(size=dummyTextObj.getMeasure("h"),size+=padding+(!handleOverlap||axisrotated||"y"!=type||isFixedDatalabels?0:size),sizeArray.push(size))}}}),isYaxis&&hasBarSeries&&stacked&&!dataObj.isStackedPercentChart){var groupedByStack=chartObj.dataObject.groupedByStack,group=groupedByStack.get(groupedByStack.keys()[0]),seriesIndex=group&&group.stackLabelIndex,stackedLabels=systemconf.chart.plot.plotoptions[chartObj.chartTypes[seriesIndex].name].datalabels.stackLabels||{},showStackLabels=!!stackedLabels&&stackedLabels.show,padding=mathMax(0,mathMin(validateNullVal(stackedLabels.padding,2),dim));chartObj.datalabels.isStackedLabels=showStackLabels,showStackLabels&&(dummyTextObj.setFont(stackedLabels,seriesIndex),getValignforBarLabels(chartObj,seriesIndex,STACKLABELS_LABELTYPE)===FIXEDTOP_ALIGN&&(axisrotated||function(chartObj,stackedLabels){var groupedByStack=chartObj.dataObject.groupedByStack;return groupedByStack.keys().some(function(d){return"html"===dataLabelTextContent(chartObj,null,stackedLabels,STACKLABELS_LABELTYPE,null,groupedByStack.get(d).stackLabelIndex).contentType})}(chartObj,stackedLabels))?function(chartObj,options,dummyTextObj,axisrotated,padding,sizeArray){var size,groupedByStack=chartObj.dataObject.groupedByStack,maxWidth=perToPx(defined(options.maxWidth)?options.maxWidth:"30%",chartObj.plotarea.width);groupedByStack.keys().forEach(function(d){var group=groupedByStack.get(d),seriesIndex=group.stackLabelIndex,data=group.stackExtent,GLT=dataLabelTextContent(chartObj,null,options,STACKLABELS_LABELTYPE,null,seriesIndex);data.forEach(function(d){dummyTextObj.updateText(GLT,d),size=dummyTextObj.getMeasure(axisrotated?"w":"h"),axisrotated&&(size=mathMin(size,maxWidth)),sizeArray.push(size+padding)})})}(chartObj,stackedLabels,dummyTextObj,axisrotated,padding,sizeArray):(size=dummyTextObj.getMeasure("h")+padding,sizeArray.push(size)))}return dummyText.remove(),sizeArray.length>0?mathMax.apply(null,sizeArray):0};var DUMMYTEXT=function(chartObj){this.chartObj=chartObj};DUMMYTEXT.prototype.createElement=function(){return this.element=appendEle(this.chartObj.staticPaneSVG.selectAll("g.labelholder"),"text",[1],".","class","dummyText").text("qtyplkjhgfd").style("fill",NONE)},DUMMYTEXT.prototype.setFont=function(options,seriesIndex){applyDatalabelFonts(this.element,options,this.chartObj,NONE,!1,seriesIndex)},DUMMYTEXT.prototype.getMeasure=function(measure){var bound=bbox(this.element.node());return"w"===measure?bound.width:bound.height},DUMMYTEXT.prototype.updateText=function(GLT,d){var contentType=GLT.contentType||"text",isMultiLine="html"===contentType&&GLT.multiLine,textElement=this.element;textElement[contentType](GLT(d)),isMultiLine&&translateTspan(textElement,0)},dataLabel_handler.initialize=function(chartObj){var mode=chartObj.plot.renderer.mode,drawLabel=dataLabel_handler[mode],drawConnector=dataLabel_handler.connector,labelHolder=getLabelHolder(chartObj),availableChartTypes=charttype,config={};config[DATALABELS_LABELTYPE]=[],config[STACKLABELS_LABELTYPE]=[],config[INNERLABEL_LABELTYPE]=[],config[PARENTLABELS_LABELTYPE]=[];var criteria={rangeChart:[availableChartTypes.arearange],connector:[availableChartTypes.pie,availableChartTypes.sunburst,availableChartTypes.funnel,availableChartTypes.pyramid]};criteria[INNERLABEL_LABELTYPE]=chartcategory.innerLabels,criteria[PARENTLABELS_LABELTYPE]=chartcategory.parentLabels;var handlers={add:function(c,seriesIndex,subSeries,yRangePos,type){var queue=config[type=type||DATALABELS_LABELTYPE];return queue=queue[seriesIndex]=queue[seriesIndex]||[],type===DATALABELS_LABELTYPE&&criteria.rangeChart.indexOf(chartObj.chartTypes[seriesIndex].value)>-1&&(queue=queue[yRangePos=yRangePos||0]=queue[yRangePos]||[]),queue[subSeries]=queue[subSeries]||[],queue[subSeries].push.apply(queue[subSeries],c),queue[subSeries].dataUpdate=c.dataUpdate,queue},update:function(id,x,y,display,DY,hookPosition,type){type=type||DATALABELS_LABELTYPE;var index=id.match(/\d+/g),seriesIndex=index[0],subSeriesIndex=index[1],itemIndex=index[2],yRangePos=+index[3]||0,d=handlers.getQueue(seriesIndex,yRangePos,type)[subSeriesIndex][itemIndex];d.X+=x,d.Y+=y,d.display=d.display&&!display,void 0!==DY&&(d.DY=DY),hookPosition&&(d.hookPosition=hookPosition)},getQueue:function(seriesIndex,yRangePos,type){var queue=config[type=type||DATALABELS_LABELTYPE];return queue=queue[seriesIndex],type===DATALABELS_LABELTYPE&&criteria.rangeChart.indexOf(chartObj.chartTypes[seriesIndex].value)>-1&&queue&&(queue=queue[yRangePos||0]),queue},draw:function(){if(chartObj.isAxisCategory){var groupedByStack=chartObj.dataObject.groupedByStack,keys=chartObj.userdata.seriesdata.stackGroup||groupedByStack.keys();keys.forEach(function(d,i){if(config[STACKLABELS_LABELTYPE].length&&groupedByStack.has(i)){var group=groupedByStack.get(i);drawLabel(chartObj,config[STACKLABELS_LABELTYPE][group.stackLabelIndex],i,"stacklabel")}else"svg"===mode&&appendEle(labelHolder,"g",[],".","class","stacklabel_"+i)}),keys.length||"svg"!==mode||appendEle(labelHolder,"g",[],"#","id",STACKLABELS_LABELTYPE)}chartObj.seriesdata.forEach(function(s,i){var data=config[DATALABELS_LABELTYPE][i],cType=chartObj.chartTypes[i].value;criteria.rangeChart.indexOf(cType)>-1?(drawLabel(chartObj,data&&data[0],i),drawLabel(chartObj,data&&data[1],i)):drawLabel(chartObj,data,i),criteria[INNERLABEL_LABELTYPE].indexOf(cType)>-1&&(criteria.connector.indexOf(cType)>-1&&drawConnector(chartObj,data,i),drawLabel(chartObj,config[INNERLABEL_LABELTYPE][i],i,INNERLABEL_LABELTYPE)),criteria[PARENTLABELS_LABELTYPE].indexOf(cType)>-1&&drawLabel(chartObj,config[PARENTLABELS_LABELTYPE][i],i,PARENTLABELS_LABELTYPE)})}};return handlers},labelRenderer.drawLabelsFromQueue=function(labelQueue,array,chartObj){if(chartObj.labelHandler=null,"image"!==chartObj.plot.renderer.mode){var dataObj=chartObj.dataObject;if(chartObj.isAxisCategory){(groupedByStack=dataObj.groupedByStack).keys().forEach(function(d,i){var value=groupedByStack.get(d),si=value.stackLabelIndex;if((dataObj.noofBarEnabledSeries||dataObj.isCombinationalChart)&&null!=si){var obj={renderer:chartObj.renderer[si],chartObj:chartObj,args:[{data:[value.stackExtent]},si,STACKLABELS_LABELTYPE,i],charttype:BAR_CHARTNAME};labelRenderer.drawLabel(obj)}})}labelQueue.forEach(function(d,i){labelRenderer.drawLabel(d)});var currentPlotBound=getPlotBound(chartObj),length=array.length,plotbound={x1:currentPlotBound.left,y1:currentPlotBound.top,x2:currentPlotBound.right,y2:currentPlotBound.bottom};if((dataObj.isCombinationalChart||dataObj.isContinousChart||dataObj.isPolarAxisCategory||chartObj.isGeoMap?function(){var isContinousChart=dataObj.isContinousChart,translateOrders={top:["hidden","topPlus","right","bottom","left"],bottom:["hidden","right","left"]};array=isContinousChart?array.sort(function(a,b){return d3_ascending(a.x1,b.x1)}):array;for(var i=1;i<length;i++){var currentLabel,isHidden,newHookPosition,bool=0,overlap=!1,testCase=0,factor=pick(array[i].factor,1),radius=(array[i].pointRadius||0)*factor,x1=array[i].x1,y1=array[i].y1,x2=array[i].x2,y2=array[i].y2,w=array[i].x2-array[i].x1,h=array[i].y2-array[i].y1,translateOrder=translateOrders[pick(array[i].orient,"top")],previousLabels=array.slice(0,i);previousLabels=isContinousChart?previousLabels.reverse():previousLabels;do{switch(translateOrder[testCase]){case"hidden":isHidden="hidden"===(currentLabel=array[i]).overlap||dataObj.isBubbleEnabled;break;case"topPlus":currentLabel.y1=y1-h/2,currentLabel.y2=y2-h/2,newHookPosition=BOTTOM_ALIGN;break;case"right":currentLabel.x1=(x1+x2)/2+radius,currentLabel.x2=(x1+x2)/2+radius+w,currentLabel.y1=y2+1,currentLabel.y2=y2+h+1,newHookPosition=LEFT_ALIGN;break;case"bottom":currentLabel.x1=x1,currentLabel.x2=x2,currentLabel.y1=y2+2*(radius+1),currentLabel.y2=y2+2*(radius+1)+h,newHookPosition=TOP_ALIGN;break;case"left":currentLabel.x1=(x1+x2)/2-radius-w,currentLabel.x2=(x1+x2)/2-radius,currentLabel.y1=y2+1,currentLabel.y2=y2+h+1,newHookPosition=RIGHT_ALIGN}for(var index=i-1;index>=0;index--)if(overlap=doOverlap(previousLabels[index],currentLabel)){bool++;break}}while(++testCase<5&&overlap);if(0!=bool){var isWithInPlot=!!dataObj.isPolarAxisCategory||isLabelWithinBound(currentLabel,plotbound),translateFunc=array[i].translateFunction,id=array[i].id,isStackedLabels=array[i].isStackedLabels;!isWithInPlot||5==bool||isHidden?(translateFunc(id,null,null,!0,UNDEFINED,UNDEFINED,isStackedLabels?STACKLABELS_LABELTYPE:DATALABELS_LABELTYPE),array[i].x1=array[i].y1=array[i].x2=array[i].y2=0):translateFunc(id,currentLabel.x1-x1,currentLabel.y1-y1,null,void 0,newHookPosition,isStackedLabels?STACKLABELS_LABELTYPE:DATALABELS_LABELTYPE)}}}:dataObj.noofBarEnabledSeries?function(){var axisrotated=dataObj.getAxisRotated();array.sort(function(a,b){return axisrotated?d3_descending(a.y1,b.y1):d3_ascending(a.x1,b.x1)});for(var i=0;i<length;i++){for(var bool=!1,overlappingCount=0,translateValue=0,x=array[i].x1,y=array[i].y1,currentLabel=array[i],previousLabels=array.slice(0,i).sort(function(a,b){return axisrotated?d3_descending(a.x1,b.x1):d3_ascending(a.y1,b.y1)}),isHidden="hidden"===currentLabel.overlap,index=i-1;index>=0&&overlappingCount<2;index--){var overlap=doOverlap(previousLabels[index],currentLabel);overlap&&(axisrotated?(translateValue=previousLabels[index].x2-currentLabel.x1,currentLabel.x2+=translateValue,currentLabel.x1+=translateValue):(translateValue=previousLabels[index].y1-currentLabel.y2,currentLabel.y2+=translateValue,currentLabel.y1+=translateValue),overlappingCount++),bool=bool||overlap}if(bool){var isWithInPlot=isLabelWithinBound(currentLabel,plotbound),translateFunc=array[i].translateFunction,id=array[i].id,isStackedLabels=array[i].isStackedLabels;!isWithInPlot||overlappingCount>1||isHidden?(translateFunc(id,null,null,!0,UNDEFINED,UNDEFINED,isStackedLabels?STACKLABELS_LABELTYPE:DATALABELS_LABELTYPE),array[i].x1=array[i].y1=array[i].x2=array[i].y2=0):translateFunc(id,currentLabel.x1-x,currentLabel.y1-y,UNDEFINED,UNDEFINED,UNDEFINED,isStackedLabels?STACKLABELS_LABELTYPE:DATALABELS_LABELTYPE)}}}:function(){if(length){var prevLeft,prevRight,slotCount,rightHalf=[],leftHalf=[],TOP=array.TOP,BOTTOM=array.BOTTOM,rightCount=0,leftCount=0,rightSlot=[],leftSlot=[],rightCo=0,leftCo=0,totalRightSpaceNeeded=0,totalLeftSpaceNeeded=0;array.forEach(function(d){if(d.isLeft){var added=addToHalf(d,slotCount,TOP,BOTTOM,prevLeft,leftHalf,leftCount,totalLeftSpaceNeeded,!0);slotCount=added.totalslot,prevLeft=added.prev,leftCount=added.count,totalLeftSpaceNeeded=added.need}else added=addToHalf(d,slotCount,TOP,BOTTOM,prevRight,rightHalf,rightCount,totalRightSpaceNeeded),slotCount=added.totalslot,prevRight=added.prev,rightCount=added.count,totalRightSpaceNeeded=added.need}),totalRightSpaceNeeded||totalLeftSpaceNeeded?("funnel"===array.actualType&&rightHalf.reverse(),rightCo=addToSlot(rightHalf,rightCo,rightSlot,TOP),leftHalf.reverse(),leftCo=addToSlot(leftHalf,leftCo,leftSlot,TOP),arrange(rightSlot,TOP,slotCount,rightCo),arrange(leftSlot,TOP,slotCount,leftCo),array.forEach(function(d){chartObj.labelHandler.update(d.id,d.DX,d.translate||0,d.hide,void 0,d.overlappingHookPosition)}),labelQueue.forEach(function(d){var index=d.args[1],queue=chartObj.labelHandler.getQueue(index);queue&&queue.properties&&queue.properties.onOverlap&&queue.properties.onOverlap()})):(labelQueue.forEach(function(d,i){var index=d.args[1],queue=chartObj.labelHandler.getQueue(index);queue&&queue.properties&&queue.properties.onNonOverlap&&queue.properties.onNonOverlap()}),array.forEach(function(d){chartObj.labelHandler.update(d.id,0,0,null,d.actualDY)}))}})(),chartObj.staticPaneSVG.select(".temp_label").remove(),chartObj.labelHandler){var labelHolder=chartObj.staticPaneSVG.selectAll("g.labelholder"),mode=chartObj.plot.renderer.mode;labelQueue.forEach(function(d){var index=d.args[1],yRangePos=dataObj.isAxisCategory?d.args[3]:null,innerLabels=/(pieInnerLabels|funnelInnerLabels)/.test(d.charttype),labelType="pieInnerLabels"===d.charttype&&isSunburstChartType(chartObj.chartTypes[index].value)&&d.args[d.args.length-1]?PARENTLABELS_LABELTYPE:innerLabels?INNERLABEL_LABELTYPE:DATALABELS_LABELTYPE,queue=chartObj.labelHandler.getQueue(index,yRangePos,labelType),datalabelsBoundBox_renderer=(queue&&isBoundBoxEnabled(queue.properties.dataLabels,chartObj),datalabelsBoundBox_handler[mode]().args(queue));labelHolder.call(datalabelsBoundBox_renderer,index,labelType)}),chartObj.labelHandler.draw()}}var groupedByStack},labelRenderer.drawLabel=function(obj){var chartObj=obj.chartObj,renderer=obj.renderer,cType=obj.charttype,args=obj.args,labelHolder=chartObj.staticPaneSVG.selectAll("g.labelholder"),handler=chartObj.labelHandler;chartObj.labelHandler||((handler=chartObj.labelHandler=dataLabel_handler.initialize(chartObj)).chartType=cType);var labelrenderer=labelRenderer[cType]();labelrenderer.renderer(renderer).args(args),labelHolder.call(labelrenderer,handler)},dataLabel_handler.svg=function(chartObj,series,i,type){var isStackedLabels="stacklabel"===(type=type||"label"),isInnerLabel=type===INNERLABEL_LABELTYPE||type===PARENTLABELS_LABELTYPE,isPackedBubble=chartObj.chartTypes[0].value==charttype.packedbubble,isTreemap=chartObj.chartTypes[0].value==charttype.treemap,labelseries=appendEle(getLabelHolder(chartObj),"g",series?[1]:[],".","class",type+"_"+i);if(series){var properties=series.properties,globalDataUpdate=properties.dataUpdate,dataLabels=properties.dataLabels,rp=properties.rp,rotation=properties.rotation,isRangeChart=properties.rangeChart,yrangePos=properties.yrangePos,reverseColor=properties.reverseColor,contentType=properties.contentType||"text",isMultiLine=properties.isMultiLine,isPolar=chartObj.dataObject.isPolarAxisCategory,isAxisCategory=chartObj.isAxisCategory,clip="clip"===dataLabels.textOverlap,fontSize=getFontSizeByHierarchy(dataLabels,chartObj),data_length=isAxisCategory||isPolar?NULL:globalDataUpdate.length,isScatterType="scatter"===properties.type,hasColorScale=colorscale_helpers.isQuantileColorScale(chartObj),dataLevelFontColor=NULL;if((hasColorScale||rp.threshold||chartObj.dataObject.isHierarchy||!(isAxisCategory||chartObj.isGeoMap||isPolar||chartObj.dataObject.isNonAxisMultiSeriesCategory)||properties.multiColoring)&&(dataLevelFontColor=function(d,k){var clrIndex=reverseColor?data_length-1-k:(isAxisCategory||isPolar||chartObj.dataObject.isNonAxisMultiSeriesCategory)&&!properties.multiColoring?i:k,clr=getRawColor(chartObj,clrIndex,d&&d.data?d.data:d,i),options=properties.isSunburst&&properties.parentInnerLabel&&d.children?properties.parentInnerLabel:dataLabels;return isTreemap&&isInnerLabel&&/(top-outset|bottom-outset)/.test(options.position)&&d3_rgb(clr).opacity<.1&&(clr="white"),getLabelFontColor(chartObj.systemConf,clr,options,chartObj,isInnerLabel,i)}),clip)appendEle(($Browser.SAFARI?chartObj.svg:chartObj.getPatternSvg()).selectAll("defs"),"g",[1],".","class","textClipPaths");isRangeChart&&(labelseries=appendEle(labelseries,"g",[1],".","class","rangePos_"+yrangePos)),isStackedLabels&&labelseries.attr("id",STACKLABELS_LABELTYPE),labelseries.attrs({"text-anchor":isScatterType?"middle":null,transform:properties.translation});var computedLabelFontColor=applyDatalabelFonts(labelseries,dataLabels,chartObj,rp.color,isInnerLabel,i,isStackedLabels).fill;isPolar&&labelseries.attr("transform","translate("+chartObj.plotarea_approx.x+","+chartObj.plotarea_approx.y+")"),series.forEach(function(subSeries,j){var labelText,dataUpdate=subSeries.dataUpdate||globalDataUpdate,subseries=appendEle(labelseries,"g",[1],".","class","subseries_"+j),needOutlineText=defined(dataLabels.strokeColor);if(!needOutlineText||"paintOrder"in document.documentElement.style)applyLabelStyles(labelText=appendEle(subseries,properties.GLT&&properties.GLT.hasShowAsFunction?"g":"text",dataUpdate),subSeries,needOutlineText);else{var outlineLabelText=appendEle(appendEle(subseries,"g",[1],".","class","outlineGroup"),"text",dataUpdate,".","class","outline");labelText=appendEle(subseries,properties.GLT&&properties.GLT.hasShowAsFunction?"g":"text",dataUpdate,".","class","label"),applyLabelStyles(outlineLabelText,subSeries,needOutlineText,needOutlineText),applyLabelStyles(labelText,subSeries)}})}function applyLabelStyles(labelText,subSeries,applyOutline,applyStrokeWidth){if(labelText[contentType](function(d,k){return subSeries[k].text}),isMultiLine&&labelText.each(function(d,k){translateTspan(d3_select(this),subSeries[k].X)}),labelText.styles({display:function(d,k){return!1===subSeries[k].display?NONE:null},fill:dataLevelFontColor,"pointer-events":NONE,opacity:function(d,i){if(defined(chartObj.dataObject.hierarchical)&&defined(chartObj.cache.hierarchical)&&chartObj.cache.hierarchical.active)return!0===d.active?1:.1},transition:"opacity ease .2s"}).attrs({x:function(d,k){return subSeries[k].X},y:function(d,k){return subSeries[k].Y},dy:function(d,k){return subSeries[k].DY},"text-anchor":function(d,k){return subSeries[k].ANCHOR},id:function(d,k){return subSeries[k].ID},transform:function(d,k){var pos=subSeries[k].xy||[subSeries[k].X,subSeries[k].Y],val="";return subSeries[k].xy&&(val="translate("+pos+")"),defined(rotation)&&(val+="rotate("+rotation+" "+pos+")"),val||NULL},"clip-path":clip?function(d,k){var bb=bbox(this),properties={name:"textClip",id:chartObj.id,x:bb.x,y:bb.y,width:subSeries[k].width,height:bb.height},args={chartObj:chartObj},clipID=effects.get(effects.svg_clips,"rect",properties,args);return"url("+chartObj.defsLocation+"#"+clipID+")"}:null,level:function(d,i){if(d.level)return d.level}}),applyOutline&&"contrast"===dataLabels.strokeColor&&labelText.attr("stroke",function(d){return getContrastColor(dataLevelFontColor?dataLevelFontColor(d):computedLabelFontColor)}),applyStrokeWidth&&labelText.attr("stroke-width",dataLabels.strokeWidth),chartObj.dataObject.isWaterfallEnabled&&void 0!==dataLabels.fontColor&&dataLabels.fontColor==NULL&&labelText.style("fill",function(d,i){var color=colorscale_helpers.getWaterfallColor(d,properties.rp.categoryColorConfig);if(color)return color}),!(isAxisCategory||isTreemap||isPolar||chartObj.dataObject.hasLevelMarker||isPackedBubble||isStackedLabels||isInnerLabel||chartObj.isGeoMap))if("html"===contentType){var boundBoxPadding=isBoundBoxEnabled(dataLabels,chartObj)?getBoundBoxPadding(dataLabels,chartObj)+getBoundBoxStrokeWidth(dataLabels,chartObj):0;labelText.each(function(d,k){if(!1!==subSeries[k].display){var ele=d3_select(this),tspanInfo=getTspanBound(ele,fontSize);if(trimAllTspan(ele,chartObj,properties.trans,properties.txtHgt,null,tspanInfo,subSeries[k].isLeft?boundBoxPadding:0),"middle"===subSeries[k].ANCHOR){var TX=(subSeries[k].width-bbox(this).width)/2,flip=subSeries[k].isLeft?1:-1,newX=subSeries[k].X+TX*flip;ele.attr("x",newX),translateTspan(ele,newX)}}})}else callTrimText(labelText,chartObj,properties.trans,properties.txtHgt)}},datalabelsBoundBox_handler.svg=function(){var series,properties,chartObj;function shape(selection,index,labelType){selection.each(function(){series&&(properties=series.properties,chartObj=properties.rp.chartObj);var showBoundBox=series&&isBoundBoxEnabled(properties.dataLabels,chartObj),boundboxSeries=appendEle(d3_select(this),"g",[1],".","class",(labelType===PARENTLABELS_LABELTYPE?"parentboundboxseries_":labelType===INNERLABEL_LABELTYPE?"innerboundboxseries_":"boundboxseries_")+index);properties&&properties.rangeChart&&(boundboxSeries=appendEle(boundboxSeries,"g",[1],".","class","rangePos_"+properties.yrangePos));var boundboxSubSeries=appendEle(boundboxSeries,"g",showBoundBox?series:[]);if(showBoundBox){var seriesTranslation=chartObj.dataObject.isPolarAxisCategory?"translate("+chartObj.plotarea_approx.x+","+chartObj.plotarea_approx.y+")":chartObj.isAxisCategory?null:properties.translation;boundboxSeries.attr("transform",seriesTranslation);var boundboxOptions=getMergedBoundBoxOptions(properties.dataLabels,chartObj),hookOptions=getBoundBoxHookConf(boundboxOptions.hook),globalDataUpdate=properties.dataUpdate,rotation=properties.rotation||0,padding=getBoundBoxPadding(properties.dataLabels,chartObj),r=getBorderRadius(boundboxOptions.radius),strokeColor=getBoundBoxColor(boundboxOptions.strokeColor,properties,chartObj,globalDataUpdate,index),fillColor=getBoundBoxColor(boundboxOptions.fillColor,properties,chartObj,globalDataUpdate,index),strokeWidth=defined(boundboxOptions.strokeWidth)?+boundboxOptions.strokeWidth:1,strokeDashArray=getDashArray(boundboxOptions.dashStyle,strokeWidth),strokeLineCap=getLineCap(boundboxOptions.lineCap,boundboxOptions.dashStyle),heightAdjustScale=d3_scaleLinear(),plotarea=chartObj.plotarea,trans=properties.trans||[0,0],edge_left=-trans[0]+plotarea.left,edge_right=plotarea.width-trans[0]-plotarea.left;boundboxSubSeries.attr("class",function(d,i){return"subseries_"+i}).each(function(d,i){var dataUpdate=d.dataUpdate||globalDataUpdate;appendEle(d3_select(this),"path",dataUpdate).attrs({d:function(dt,j){var point=d[j],xy=point.xy||[point.X,point.Y],x=xy[0]-padding,y=xy[1]-padding,w=point.width,h=point.height,dy=void 0!==point.actualDY?point.actualDY:parseFloat(point.DY)||0,anchor=point.ANCHOR,hookPosition=point.hookPosition;return x="middle"===anchor?x-w/2:"end"===anchor?x-w:x,y-=heightAdjustScale.domain([-.3,.9]).range([h,0])(dy),chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory||"hierarchy"===properties.type||(x<edge_left&&(w-=edge_left-x+strokeWidth/2+padding,x=edge_left+strokeWidth/2),x+w+strokeWidth/2+padding>edge_right&&(w-=x+w-edge_right+strokeWidth/2+2*padding),x+=(boundboxOptions.strokeWidth||1)*(hookPosition===RIGHT_ALIGN?.5:hookPosition===LEFT_ALIGN?-.5:0)),getBoundBoxPathDescription(x,y,w,h,r,padding,hookPosition,hookOptions,point.adjustVal)},transform:function(dt,j){var point=d[j],xy=point.xy||[point.X,point.Y];return"rotate("+rotation+" "+xy[0]+" "+xy[1]+")"},id:function(dt,j){return"boundbox"+d[j].ID},level:function(d,i){if(d.level)return d.level}}).styles({display:function(dt,j){return!1===d[j].display?NONE:null},fill:fillColor,"fill-opacity":boundboxOptions.fillOpacity,stroke:strokeColor,"stroke-opacity":boundboxOptions.strokeOpacity,"stroke-width":boundboxOptions.strokeWidth,"stroke-dasharray":strokeDashArray,"stroke-linecap":strokeLineCap,opacity:function(d,i){if(defined(chartObj.dataObject.hierarchical)&&defined(chartObj.cache.hierarchical)&&chartObj.cache.hierarchical.active)return!0===d.active?1:.1},transition:"opacity ease .2s"})})}})}return shape.args=function(_){return arguments.length?(series=_,shape):series},shape},dataLabel_handler.connector=function(chartObj,series,i){var linkseries=appendEle(getLabelHolder(chartObj),"g",series&&"circular"!==series.properties.showlabel?[1]:[],".","class","link_"+i);if(series){var properties=series.properties,dataUpdate=properties.dataUpdate,isSunburst=properties.isSunburst,connectorPath=properties.connectorPath,lineConf=properties.dataLabels.line,data_length=dataUpdate.length;lineConf&&(linkseries.attr("transform",properties.translation).styles({stroke:lineConf.strokeColor,"stroke-width":lineConf.strokeWidth,fill:NONE}),series.forEach(function(subSeries,j){appendEle(appendEle(linkseries,"g",[1],".","class","subseries_"+j),"path",dataUpdate).styles({display:function(d,k){return!1===subSeries[k].display?NONE:NULL},stroke:function(d,k){return isSunburst||lineConf.strokeColor?NULL:getRawColor(chartObj,properties.reverseColor?data_length-1-k:k,d&&d.data?d.data:d,i)}}).attrs({d:connectorPath,id:function(d,k){return"link"+i+"_"+j+"_"+k}})}))}},labelRenderer.bar=function(){var renderer,args,axisrotated,textDirection,rotation,dataProcessorHelpers=DataProcessor.helpers;function labels(selection,labelHandler){selection.each(function(){var dataLabels,currentdata=args[0],index=args[1],labelType=args[2]||DATALABELS_LABELTYPE,rp=renderer.commonRendererProp().params,plotoptions=currentdata.plotoptions,chartObj=rp.chartObj,systemconf=chartObj.systemConf,commonPlotOptions=rp.commonPlotOptions,dataset=rp.dataset,stacked=rp.stacked,yscale=rp.yscale,yaxiscolumnorder=rp.yaxiscolumnorder,labelArray=rp.labelArray,isStackedLabels=labelType===STACKLABELS_LABELTYPE,isCanvasMode="canvas"===chartObj.plot.renderer.mode;axisrotated=rp.axisrotated,dataLabels=getMergedDatalabelOptions(commonPlotOptions,isStackedLabels?NULL:plotoptions,chartObj,index),isStackedLabels&&(dataLabels=dataLabels.stackLabels);var showlabel=isStackedLabels?isStacklabelEnabled(dataLabels,chartObj):isDatalabelEnabled(dataLabels,chartObj);if(!currentdata.disabled&&showlabel){var currentPlotBound=getPlotBound(chartObj),textOverlap=dataLabels.textOverlap,labelPos=getValignforBarLabels(chartObj,index,labelType),showZeros=dataLabels.showZeros,multiColoring=isMultiColoring(commonPlotOptions,chartObj),left=currentPlotBound.left,top=currentPlotBound.top,right=currentPlotBound.right,bottom=currentPlotBound.bottom,rectBound=chartObj.svg.node().getBoundingClientRect(),rectBoundLeft=rectBound.left+chartObj.plotarea.left,rectBoundTop=rectBound.top+chartObj.plotarea.top,dim=.75*(axisrotated?chartObj.plotarea.width:chartObj.plotarea.height),GLT=dataLabelTextContent(chartObj,rp,dataLabels,labelType,NULL,index),contentType=GLT.contentType||"text",isMultiLine="html"===contentType&&GLT.multiLine,isFixedTopPostion=labelPos===FIXEDTOP_ALIGN,isCatNullX=dataProcessorHelpers.isCatNull(dataset,"x"),isCatNullY=dataProcessorHelpers.isCatNull(dataset,"y",yaxiscolumnorder),yaxisReversed=systemconf.chart.axes.yaxis[yaxiscolumnorder||0].reversed,barW=chartObj.barscale2.bandwidth()||0,fontSize=getFontSizeByHierarchy(dataLabels,chartObj),datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder);if(!isFixedTopPostion||chartObj.dataObject.rangeCorrections.datalabels["y"+yaxiscolumnorder]){var boundBoxPadding=0,boundBoxStrokeWidth=0,hookHeight=0,hookWidth=0,boundBoxRadius=0;if(isBoundBoxEnabled(dataLabels,chartObj)){var boundBoxOptions=getMergedBoundBoxOptions(dataLabels,chartObj),hookOptions=getBoundBoxHookConf(boundBoxOptions.hook);boundBoxPadding=getBoundBoxPadding(dataLabels,chartObj),boundBoxStrokeWidth=getBoundBoxStrokeWidth(dataLabels,chartObj),hookHeight=stacked||labelPos===MIDDLE_ALIGN?0:hookOptions.height,hookWidth=hookOptions.width,boundBoxRadius=boundBoxOptions.radius}var clip="clip"===textOverlap,handleOverlapping=systemconf.chart.plot.datalabels.handleOverlapping&&textOverlap!==NONE,padding=mathMax(0,validateNullVal(dataLabels.padding,2))+boundBoxPadding+hookHeight+(isFixedTopPostion&&boundBoxStrokeWidth?boundBoxStrokeWidth/2-1:0),fixedTopPosition=isFixedTopPostion&&function(){if(datatypeY===ORDINAL_DATATYPE){var domain=yscale.domain();return yscale(domain[domain.length-1])+yscale.bandwidth()/2}var rangeCorrections_datalabels=chartObj.dataObject.rangeCorrections.datalabels,maxDatalabelSize=[0],operation=axisrotated?yaxisReversed?1:-1:yaxisReversed?-1:1;for(var yaxis in rangeCorrections_datalabels)yaxis.indexOf("y")>-1&&maxDatalabelSize.push(rangeCorrections_datalabels[yaxis]);return yscale(yscale.domain()[1])+d3_max(maxDatalabelSize)*operation}();padding=padding>dim?dim:padding,textDirection=!(textDirection=dataLabels.textDirection)||stacked&&!isStackedLabels?axisrotated?VERTICAL_ALIGN:HORIZONTAL_ALIGN:textDirection,rotation=axisrotated?textDirection==HORIZONTAL_ALIGN?90:0:textDirection==HORIZONTAL_ALIGN?0:270;var commonOption=renderer.commonOption,getParamValue=function(){return chartObj.dataObject.getTransRectValue.apply(chartObj.dataObject,toArray(arguments))},temp_label=appendEle(chartObj.staticPaneSVG.select(".labelholder"),TEXT_ELEMENT,[1],".","class","temp_label"),updateHandler=labelHandler.update,queue=labelHandler.add;currentdata.data.forEach(function(d,i){var data,xCategories,dataUpdate=renderer.seriesdataAfterUpdate&&!isStackedLabels?renderer.seriesdataAfterUpdate[i]:currentdata.data[i];if(isStackedLabels){var scrollOptions=systemconf.chart.scroll;scrollOptions&&scrollOptions.enabled&&(data=dataUpdate,xCategories=rp.xscale.domain(),dataUpdate=data.filter(function(d){var x=d[0];return xCategories.indexOf(x)>-1})),isFixedTopPostion&&yscale.domain()[0]<0&&(dataUpdate=function(data){var xCategories=d3_set();return data.filter(function(d){var xVal=d[0];return!xCategories.has(xVal)&&(xCategories.add(xVal),!0)})}(dataUpdate))}var commonProperties=[];applyDatalabelFonts(temp_label,dataLabels,chartObj,rp.color,!1,index),temp_label.styles({fill:TRANSPARENT}),dataUpdate.forEach(function(d,j){var text,X,Y,DY,ANCHOR,HOOKPOSITION,actualDY,boundBox=NULL,flip=yaxisReversed?-1:1,isNeg=isStackedLabels?d[1]<0:dataset.getY(d,yaxiscolumnorder)<0;temp_label[contentType](function(){if(isStackedLabels){var yVal=d[1];d[0];text=showZeros||0!=yVal?GLT(d):NULL}else text=isCatNullX(dataset.getX(d))||isCatNullY(dataset.getY(d,yaxiscolumnorder))||!showZeros&&0==dataset.getY(d,yaxiscolumnorder)?NULL:GLT(d);return text}),isMultiLine&&translateTspan(temp_label,0),boundBox=bbox(temp_label.node());var widthToBeAdded=0,heightToBeAdded=0;if(isStackedLabels){var x=commonOption.bandwidth1(d[0])+commonOption.bandwidth2(commonOption.stackGroupIndex),y=yscale(d[2]||d[1]);X=axisrotated?y:x,Y=axisrotated?x:y,axisrotated?textDirection==HORIZONTAL_ALIGN?(X+=(isNeg?-padding:padding)*flip,DY=yaxisReversed?isNeg?"-0.3em":"1em":isNeg?"1em":"-0.3em"):(Y+=barW/2,DY="0.3em",isFixedTopPostion?(X=fixedTopPosition+padding*flip+0*flip,ANCHOR=yaxisReversed?"end":NULL):(X+=(isNeg?-padding:padding)*flip,ANCHOR=yaxisReversed?isNeg?NULL:"end":isNeg?"end":NULL,isMultiLine&&(X+=boundBox.width/2*(isNeg?-1:1)*flip))):(X+=barW/2,Y+=(isNeg?padding:-padding)*flip,textDirection==VERTICAL_ALIGN?(DY="0.3em",ANCHOR=yaxisReversed?isNeg?NULL:"end":isNeg?"end":NULL):(ANCHOR="middle",isFixedTopPostion?(Y=fixedTopPosition-padding*flip,DY=yaxisReversed?"1em":"-0.3em"):DY=yaxisReversed?isNeg?"-0.3em":"1em":isNeg?"1em":"-0.3em"))}else{var b=boundBox,width=(x=getParamValue("x",d,i,j,commonOption)||0,y=getParamValue("y",d,i,j,commonOption)||0,getParamValue("width",d,i,j,commonOption)||0),height=getParamValue("height",d,i,j,commonOption)||0,CLIP=clip;if(X=x,Y=y,axisrotated)stacked?(Y+=height/2,DY="0.3em",labelPos==MIDDLE_ALIGN?(X+=width/2*flip,ANCHOR="middle"):labelPos==TOP_ALIGN?(X+=(isNeg?padding:width-padding)*flip,ANCHOR=yaxisReversed?isNeg?"end":NULL:isNeg?NULL:"end",isMultiLine&&!isFixedTopPostion&&(X+=b.width/2*(isNeg?1:-1)*flip)):(X+=(isNeg?width-padding:padding)*flip,ANCHOR=yaxisReversed?isNeg?NULL:"end":isNeg?"end":NULL,isMultiLine&&!isFixedTopPostion&&(X+=b.width/2*(isNeg?-1:1)*flip))):textDirection==VERTICAL_ALIGN?(Y+=height/2+(heightToBeAdded=getSizeToBeAdded(boundBox.height,boundBoxPadding,boundBoxRadius,hookWidth))/2,DY="0.3em",CLIP=CLIP&&labelPos!=TOP_ALIGN&&b.width>width,HOOKPOSITION=yaxisReversed?isNeg?LEFT_ALIGN:RIGHT_ALIGN:isNeg?RIGHT_ALIGN:LEFT_ALIGN,isFixedTopPostion?(ANCHOR=yaxisReversed?"end":NULL,X=fixedTopPosition+padding*flip+0*flip,HOOKPOSITION=yaxisReversed?RIGHT_ALIGN:LEFT_ALIGN):CLIP?labelPos==BOTTOM_ALIGN?X+=yaxisReversed?isNeg?-width+padding:-width:isNeg?0:padding:labelPos==MIDDLE_ALIGN&&(X+=yaxisReversed?-width+boundBoxPadding:boundBoxPadding):(ANCHOR=yaxisReversed?isNeg?NULL:"end":isNeg?"end":NULL,labelPos==MIDDLE_ALIGN?(X+=(b.width>width?isNeg?width:0:width/2)*flip,ANCHOR=b.width>width?ANCHOR:"middle"):X+=labelPos==TOP_ALIGN?(isNeg?-padding:width+padding)*flip:(isNeg?width-padding:padding)*flip,!isMultiLine||labelPos===MIDDLE_ALIGN&&b.width<=width||(X+=(isNeg?-boundBox.width/2:boundBox.width/2)*flip))):(widthToBeAdded=getSizeToBeAdded(boundBox.width,boundBoxPadding,boundBoxRadius,hookWidth),DY=yaxisReversed?isNeg?"-0.3em":"1em":isNeg?"1em":"-0.3em",CLIP=CLIP&&b.width>height,HOOKPOSITION=yaxisReversed?isNeg?BOTTOM_ALIGN:TOP_ALIGN:isNeg?TOP_ALIGN:BOTTOM_ALIGN,labelPos==MIDDLE_ALIGN?(b.height>width?isMultiLine?(X+=(yaxisReversed?isNeg?width:0:isNeg?0:width)*flip,X+=yaxisReversed?b.height/2*(isNeg?1:-1):0):X+=(yaxisReversed?isNeg?0:width:isNeg?width:0)*flip:X+=width/2*flip,DY=b.height>width?DY:"0.3em"):X+=labelPos==TOP_ALIGN?(isNeg?-padding:width+padding)*flip:(isNeg?width-padding:padding)*flip,CLIP?(X+=widthToBeAdded/2,Y+=boundBoxPadding):(Y+=height/2,ANCHOR="middle",labelPos==MIDDLE_ALIGN&&(DY="0.3em")));else if(stacked)X+=width/2,ANCHOR="middle",labelPos==MIDDLE_ALIGN?(Y+=height/2*flip,DY="0.3em"):labelPos==TOP_ALIGN?(Y+=(isNeg?height-padding:padding)*flip,DY=yaxisReversed?isNeg?"1em":"-0.3em":isNeg?"-0.3em":"1em"):(Y+=(isNeg?padding:height-padding)*flip,DY=yaxisReversed?isNeg?"-0.3em":"1em":isNeg?"1em":"-0.3em");else if(textDirection==VERTICAL_ALIGN){heightToBeAdded=getSizeToBeAdded(boundBox.height,boundBoxPadding,boundBoxRadius,hookWidth);var BW=!yaxisReversed&&isNeg||yaxisReversed&&!isNeg?b.width:0;CLIP=CLIP&&labelPos!=TOP_ALIGN&&b.width+padding>height,DY="0.3em",HOOKPOSITION=yaxisReversed?isNeg?LEFT_ALIGN:RIGHT_ALIGN:isNeg?RIGHT_ALIGN:LEFT_ALIGN,CLIP?(X+=width/2,Y+=labelPos==MIDDLE_ALIGN?yaxisReversed?boundBoxPadding:height-boundBoxPadding:yaxisReversed?isNeg?-padding:0:height+(isNeg?0:-padding)):(X+=width/2,labelPos==MIDDLE_ALIGN?(b.width>height?Y+=isMultiLine?(isNeg?boundBox.width/2:height-boundBox.width/2)*flip:(isNeg?0:height)*flip+BW:Y+=height/2*flip,ANCHOR=b.width>height?NULL:"middle"):labelPos==TOP_ALIGN?(Y+=(isNeg?height+padding:-padding)*flip+BW,isMultiLine&&(Y-=boundBox.width/2)):(Y+=(isNeg?padding:height-padding)*flip+BW,isMultiLine&&(Y-=boundBox.width/2)))}else widthToBeAdded=getSizeToBeAdded(boundBox.width,boundBoxPadding,boundBoxRadius,hookWidth),CLIP=CLIP&&b.width+2*boundBoxPadding>width,DY=yaxisReversed?isNeg?"-0.3em":"1em":isNeg?"1em":"-0.3em",HOOKPOSITION=yaxisReversed?isNeg?BOTTOM_ALIGN:TOP_ALIGN:isNeg?TOP_ALIGN:BOTTOM_ALIGN,isFixedTopPostion?(Y=fixedTopPosition-padding*flip,HOOKPOSITION=yaxisReversed?TOP_ALIGN:BOTTOM_ALIGN,DY=yaxisReversed?"1em":"-0.3em"):labelPos==MIDDLE_ALIGN?(Y+=(b.height<height?height/2:isNeg?0:height)*flip,DY=b.height<height?"0.3em":DY):Y+=labelPos==TOP_ALIGN?(isNeg?height+padding:-padding)*flip:(isNeg?padding:height-padding)*flip,CLIP?X+=boundBoxPadding:(X+=width/2,ANCHOR="middle")}if(isMultiLine){DY=parseFloat(DY);var lineCount=1.1*(dataLabels.showAs.length-1);-.3===DY?(actualDY=DY,DY-=lineCount):.3===DY&&(actualDY=DY,DY-=lineCount/2),DY+="em",CLIP||isFixedTopPostion||(ANCHOR="middle")}if(temp_label.attrs({x:X,y:Y,dy:DY,"text-anchor":ANCHOR,transform:"rotate("+rotation+" "+X+" "+Y+")"}),isFixedTopPostion&&!1!==display){var maxWidth=perToPx(defined(dataLabels.maxWidth)?dataLabels.maxWidth:"30%",chartObj.plotarea.width);if("html"===contentType){translateTspan(temp_label,X);var edge={left:(bb=bbox(temp_label.node())).x,top:bb.y,right:bb.x+maxWidth,bottom:bb.y+bb.height},tspanInfo=(bb.width,getTspanBound(temp_label,fontSize));trimAllTspan(temp_label,chartObj,[0,0],0,edge,tspanInfo),text=temp_label.html()}else{var bb;edge={left:(bb=bbox(temp_label.node())).x,top:bb.y,right:bb.x+maxWidth,bottom:bb.y+bb.height};callTrimText(temp_label,chartObj,[0,0],0,edge),text=temp_label.text()}}var xDiff=0,yDiff=0,adjustX=0,adjustY=0;if(HOOKPOSITION=labelPos===MIDDLE_ALIGN?NULL:HOOKPOSITION,axisrotated?adjustY=(textDirection===HORIZONTAL_ALIGN?widthToBeAdded:heightToBeAdded)/2:adjustX=(textDirection===HORIZONTAL_ALIGN?widthToBeAdded:heightToBeAdded)/2,!clip){isMultiLine&&translateTspan(temp_label,X);var adjust=boundBoxPadding+boundBoxStrokeWidth/2,leftPos=(b=temp_label.node().getBoundingClientRect()).left-rectBoundLeft-adjust-adjustX-0,rightPos=leftPos+b.width+2*adjust+2*adjustX,topPos=b.top-rectBoundTop-adjust-adjustY-0,bottomPos=topPos+b.height+2*adjust+2*adjustY,newX=X+(leftPos<left?left-leftPos:rightPos>right?-(rightPos-right):0);newX==X||isFixedTopPostion&&axisrotated||(xDiff=newX-X,X=newX);var newY=Y+(topPos<top?top-topPos:bottomPos>bottom?-(bottomPos-bottom):0);newY==Y||isFixedTopPostion&&!axisrotated||(yDiff=newY-Y,Y=newY)}var isWithinClrRange=isWithinColorRange(dataset.getClr(d),chartObj),display=isStackedLabels||isWithinClrRange;if(handleOverlapping)if(stacked&&!isStackedLabels){temp_label.attrs({x:X,y:Y}),isMultiLine&&translateTspan(temp_label,X),boundBox=bbox(temp_label.node());x=getParamValue("x",d,i,j,commonOption)||0,y=getParamValue("y",d,i,j,commonOption)||0,height=getParamValue("height",d,i,j,commonOption)||0,width=getParamValue("width",d,i,j,commonOption)||0;yaxisReversed&&(axisrotated?x-=width:y-=height),isLabelWithinBound({x1:boundBox.x-boundBoxPadding,y1:boundBox.y-boundBoxPadding,x2:boundBox.x+boundBox.width+boundBoxPadding,y2:boundBox.y+boundBox.height+boundBoxPadding},{x1:x,y1:y,x2:x+width,y2:y+height})||(display=!1)}else if(!clip||isStackedLabels){isMultiLine&&translateTspan(temp_label,X);var bx=(b=temp_label.node().getBoundingClientRect()).left-rectBoundLeft,by=b.top-rectBoundTop,obj={id:"lbl"+index+"_"+i+"_"+j,translateFunction:updateHandler,isStackedLabels:isStackedLabels,x1:bx-boundBoxPadding+xDiff-adjustX,y1:by-boundBoxPadding+yDiff-adjustY,x2:bx+b.width+boundBoxPadding+xDiff+(rotation?hookHeight+2*boundBoxStrokeWidth:0)+adjustX,y2:by+b.height+boundBoxPadding+yDiff+(rotation?0:hookHeight+2*boundBoxStrokeWidth)+adjustY,overlap:isFixedTopPostion&&"hidden"!==textOverlap&&textOverlap!==NONE?"hidden":textOverlap};labelArray.push(obj)}else{if(textDirection!=HORIZONTAL_ALIGN){var w=getParamValue(axisrotated?"width":"height",d,i,j,commonOption)||0;width=labelPos==TOP_ALIGN?boundBox.width:w-(labelPos==BOTTOM_ALIGN?padding+boundBoxPadding:2*boundBoxPadding)}else width=barW-2*boundBoxPadding;boundBox.width=mathMin(width,boundBox.width)}var coordinate={X:X,Y:Y,DY:DY,ANCHOR:ANCHOR,text:text,display:display,height:boundBox.height+heightToBeAdded,width:boundBox.width+widthToBeAdded,hookPosition:HOOKPOSITION,adjustVal:textDirection===HORIZONTAL_ALIGN?axisrotated?yDiff:xDiff:NULL};void 0!==actualDY&&(coordinate.actualDY=actualDY),isCanvasMode&&"html"===contentType&&(coordinate.tspanInfo=getTspanBound(temp_label,fontSize)),commonProperties.push(coordinate)}),commonProperties.dataUpdate=dataUpdate,queue(commonProperties,index,i,NULL,isStackedLabels?STACKLABELS_LABELTYPE:NULL).properties={type:BAR_CHARTNAME,dataLabels:dataLabels,rotation:rotation,color:rp.color,dataUpdate:dataUpdate,showlabel:showlabel,multiColoring:multiColoring,textDirection:textDirection,rp:rp,contentType:contentType,isMultiLine:isMultiLine}})}}})}return labels.renderer=function(_){return arguments.length?(renderer=_,labels):renderer},labels.args=function(_){return arguments.length?(args=_,labels):args},labels},labelRenderer.dial=function(){var renderer,args;function labels(selection,labelHandler,container){selection.each(function(){var currentdata=args[0],index=args[1],rp=renderer.commonRendererProp().params,chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,color=rp.color,plotoptions=currentdata.plotoptions,plotarea_approx=chartObj.plotarea_approx,yscaleDomain=chartObj.axes.y.groups[0].scale.domain(),dataLabels=getMergedDatalabelOptions(commonPlotOptions,plotoptions,chartObj,index),showlabel=isDatalabelEnabled(dataLabels,chartObj),GLT=dataLabelTextContent(chartObj,rp,dataLabels,DATALABELS_LABELTYPE,yscaleDomain[1]-yscaleDomain[0],0),contentType=GLT.contentType||"text",isMultiLine="html"===contentType&&GLT.multiLine;if(showlabel){var boundBoxPadding=isBoundBoxEnabled(dataLabels,chartObj)?getBoundBoxPadding(dataLabels,chartObj)+getBoundBoxStrokeWidth(dataLabels,chartObj):0,temp_label=appendEle(chartObj.staticPaneSVG.select(".labelholder"),"text",[1],".","class","temp_label");applyDatalabelFonts(temp_label,dataLabels,chartObj,color[0]),temp_label.style("fill",TRANSPARENT);var dataUpdate=[chartObj.userdata.seriesdata.chartdata[0].data[0][0]],commonProperties=[];if(dataUpdate.forEach(function(d,j){var DY=isMultiLine?"0.9em":"-.3em",text=GLT(d);temp_label[contentType](text).attrs({x:X,dy:DY,"text-anchor":"middle"});var bb=bbox(temp_label.node()),X=defined(dataLabels.x)?invokeFunction(dataLabels.x,d,chartObj,bb):plotarea_approx.x,Y=defined(dataLabels.y)?invokeFunction(dataLabels.y,d,chartObj,bb):plotarea_approx.y+(commonPlotOptions.needle.show?bb.height+(+dataLabels.padding||0)+(+commonPlotOptions.needle.width/2||7)+boundBoxPadding:bb.height/2);isMultiLine&&(defined(dataLabels.y)||(Y-=bb.height),translateTspan(temp_label,X),bb=bbox(temp_label.node()));var coordinate={X:X,Y:Y,DY:DY,ANCHOR:"middle",text:text,display:!0,ID:"lbl"+index+"_0_"+j,width:bb.width,height:bb.height};commonProperties.push(coordinate)}),container){var conf=commonProperties[0],labelText=appendEle(container,"text",showlabel?dataUpdate:[]);applyDatalabelFonts(labelText,dataLabels,chartObj,color[0]),labelText[contentType](conf.text).attrs({"text-anchor":conf.ANCHOR,dy:conf.DY,transform:"translate("+conf.X+","+conf.Y+")"}),isMultiLine&&translateTspan(temp_label,conf.X)}else{(0,labelHandler.add)(commonProperties,index,0).properties={type:DIAL_CHARTNAME,dataLabels:dataLabels,dataUpdate:dataUpdate,showlabel:showlabel,rp:rp,contentType:contentType,isMultiLine:isMultiLine}}}})}return labels.renderer=function(_){return arguments.length?(renderer=_,labels):renderer},labels.args=function(_){return arguments.length?(args=_,labels):args},labels},labelRenderer.funnel=function(){var renderer,args,MARGIN=5;function labels(selection,labelHandler){selection.each(function(){var stage,dataLabels,currentdata=args[0],index=args[1],data=args[2],noofNotNullData=args[3],arcHeight=args[4],totalEngagement=args[5],cfg=args[6],labelPosition=args[7],chartWidth=cfg.width,chartHeight=cfg.height,rp=renderer.commonRendererProp().params,chartObj=rp.chartObj,systemconf=chartObj.systemConf,commonPlotOptions=rp.commonPlotOptions,dataset=rp.dataset,yaxiscolumnorder=rp.yaxiscolumnorder,labelArray=rp.labelArray,chartName=chartObj.chartTypes[0].name,translation=chartObj.svg.selectAll("g."+chartName+"group").attr("transform"),isPyramid=chartName===PYRAMID_CHARTNAME,plotoptions=(currentdata=currentdata[index]).plotoptions,boundBoxPaddingAlone=0,boundBoxPadding=0,hookWidth=0,boundBoxRadius=0;if(isBoundBoxEnabled(dataLabels=getMergedDatalabelOptions(commonPlotOptions,plotoptions,chartObj,index),chartObj)){var boundBoxOptions=getMergedBoundBoxOptions(dataLabels,chartObj),hookOptions=getBoundBoxHookConf(boundBoxOptions.hook);boundBoxPaddingAlone=getBoundBoxPadding(dataLabels,chartObj),boundBoxPadding=boundBoxPaddingAlone+getBoundBoxStrokeWidth(dataLabels,chartObj)+hookOptions.height,hookWidth=hookOptions.width,boundBoxRadius=boundBoxOptions.radius}var padding=cfg.datalabelPadding||+dataLabels.padding||0,type=dataLabels.type,handleOverlapping=!0===systemconf.chart.plot.datalabels.handleOverlapping,txtHgt=getFontSizeByHierarchy(dataLabels,chartObj),GLT=dataLabelTextContent(chartObj,rp,dataLabels,DATALABELS_LABELTYPE,totalEngagement,index),contentType=GLT.contentType||"text",isHTMLContent="html"===contentType,isMultiLine=isHTMLContent&&GLT.multiLine,showlabel=isDatalabelEnabled(dataLabels,chartObj),relativeX=!0===dataLabels.relativeX;if(showlabel){showlabel=showlabel?type:"hidden";var data_length=data.length,PathGroupPosition=getSvgTransform(chartObj.svg.selectAll("g."+chartName+"group")).translate,idx=0,temp_label=appendEle(chartObj.staticPaneSVG.select(".labelholder"),"text",[1],".","class","temp_label");applyDatalabelFonts(temp_label,dataLabels,chartObj,rp.color),temp_label.attr("transform",translation).style("fill",TRANSPARENT);var queue=labelHandler.add;currentdata.data.forEach(function(d,i){var dataUpdate=labelPosition,commonProperties=[];dataUpdate.forEach(function(d,j){var bb,display=!isdisabled(j),isLeft=isLeftHalf(idx),heightToBeAdded=0,X=getEndX(d,idx)+(isLeft?-boundBoxPadding:boundBoxPadding),Y=isPyramid&&isLeft?d.leftY:mathMax(d.y,txtHgt-arcHeight-d.y),ANCHOR=isMultiLine?"middle":isLeft?"end":null,DY=isMultiLine?"0.9em":"0.3em",dt=d.data=data[data_length-1-j],text=GLT(dt);(temp_label[contentType](text).attrs({x:X,y:Y,"text-anchor":ANCHOR,dy:DY}),display&&isMultiLine)&&(translateTspan(temp_label,X),Y-=(bb=bbox(temp_label.node())).height/2,X+=bb.width/2*(isLeft?-1:1),translateTspan(temp_label,X),temp_label.attr("y",Y));if(handleOverlapping){if(display){heightToBeAdded=getSizeToBeAdded((bb=bbox(temp_label.node())).height,boundBoxPaddingAlone,boundBoxRadius,hookWidth);var DX=isLeft?-(0+padding+boundBoxPadding):chartWidth+padding+boundBoxPadding;isMultiLine&&(DX+=bb.width/2*(isLeft?-1:1));var obj={id:"lbl"+index+"_"+i+"_"+j,x1:bb.x-boundBoxPadding,x2:bb.x+bb.width+boundBoxPadding,y1:bb.y-MARGIN-boundBoxPadding-heightToBeAdded/2,isLeft:isLeft,y2:bb.y+bb.height+MARGIN+boundBoxPadding+heightToBeAdded/2,DX:DX-X};labelArray.push(obj)}}else heightToBeAdded=getSizeToBeAdded((bb=bbox(temp_label.node())).height,boundBoxPaddingAlone,boundBoxRadius,hookWidth);var coordinate={X:X,Y:Y,ANCHOR:ANCHOR,DY:DY,text:text,display:display,ID:"lbl"+index+"_"+i+"_"+j,width:display?bb.width:0,height:display?bb.height+heightToBeAdded:0,hookPosition:isLeft?RIGHT_ALIGN:LEFT_ALIGN};isHTMLContent&&(coordinate.isLeft=isLeft),commonProperties.push(coordinate),idx+=display?1:0}),idx=-1;var q=queue(commonProperties,index,i);q.properties={type:PIE_CHARTNAME,dataLabels:dataLabels,dataUpdate:dataUpdate,showlabel:showlabel,rp:rp,translation:translation,trans:PathGroupPosition,txtHgt:txtHgt,connectorPath:function(d,i){idx+=isdisabled(i)?0:1;var y=q[0][i].Y+(isMultiLine?q[0][i].height/2:0),y0=isPyramid&&isLeftHalf(idx)?d.leftY:d.y;return"M"+function(d,i){return isLeftHalf(i)?d.leftx+padding:d.rightx-padding}(d,idx)+" "+y0+" L"+getEndX(d,idx,0)+" "+y0+" L"+getEndX(d,idx)+" "+y},reverseColor:!0,onOverlap:function(){stage="overlap"},contentType:contentType,isMultiLine:isMultiLine},labelArray.TOP=-PathGroupPosition[1],labelArray.BOTTOM=chartHeight+PathGroupPosition[1],labelArray.actualType=FUNNEL_CHARTNAME})}function isdisabled(i){var dt=data[data_length-1-i],isWithinClrRange=isWithinColorRange(dataset.getClr(dt),chartObj);return dt.disabled||!dataset.getY(dt,yaxiscolumnorder)||!isWithinClrRange}function isLeftHalf(idx){switch(showlabel){case"singleside":return!1;case"doubleside":return idx%2==0;case"strokeddoubleside":return idx>=noofNotNullData/2}}function getEndX(d,i,pad){var isLeft=isLeftHalf(i);return relativeX&&"overlap"!=stage?isLeft?d.leftx-boundBoxPadding:d.rightx+boundBoxPadding:(pad=defined(pad)?pad:padding,isLeft?0-pad:chartWidth+pad)}})}return labels.renderer=function(_){return arguments.length?(renderer=_,labels):renderer},labels.args=function(_){return arguments.length?(args=_,labels):args},labels},labelRenderer.pie=function(){var renderer,args,outline,isSunburst,chartObj,dataset;function labels(selection,labelHandler){selection.each(function(){var currentdata=args[0],pieData=args[2],outerRadius=args[3],totalEngagement=args[4],outlineWithPad=args[5],translation="translate("+args[8][0]+","+args[8][1]+")",extraOptions=args[9]||{},rp=renderer.commonRendererProp().params;chartObj=rp.chartObj,dataset=chartObj.dataset;var systemconf=chartObj.systemConf,commonPlotOptions=rp.commonPlotOptions,labelArray=rp.labelArray,index=rp.datasetIndex||args[1]||0,chartheight=(renderer.plotarea?renderer.plotarea():chartObj.plotarea).height;isSunburst=isSunburstChartType(chartObj.chartTypes[index].value),currentdata=currentdata[index],outline=args[6];var datalabelPadding,padding,txtHgt,showlabel,handleOverlapping=!0===systemconf.chart.plot.datalabels.handleOverlapping,plotoptions=currentdata.plotoptions,dataLabels=getMergedDatalabelOptions(commonPlotOptions,plotoptions,chartObj,index);if(showlabel=isDatalabelEnabled(dataLabels,chartObj),!currentdata.disabled&&showlabel){var type=dataLabels.type,lineConf=dataLabels.line,GLT=dataLabelTextContent(chartObj,rp,dataLabels,DATALABELS_LABELTYPE,totalEngagement,index),contentType=GLT.contentType||"text",isHTMLContent="html"===contentType,isMultiLine=isHTMLContent&&GLT.multiLine,boundBoxPaddingAlone=0,boundBoxPadding=0,hookWidth=0,boundBoxRadius=0;if(isBoundBoxEnabled(dataLabels,chartObj)){var boundBoxOptions=getMergedBoundBoxOptions(dataLabels,chartObj),hookOptions=getBoundBoxHookConf(boundBoxOptions.hook);boundBoxPaddingAlone=getBoundBoxPadding(dataLabels,chartObj),boundBoxPadding=boundBoxPaddingAlone+getBoundBoxStrokeWidth(dataLabels,chartObj)+hookOptions.height,hookWidth=hookOptions.width,boundBoxRadius=boundBoxOptions.radius}showlabel=showlabel?type:"hidden",datalabelPadding=(extraOptions.padding||+(dataLabels.padding||0))+boundBoxPadding,txtHgt=getFontSizeByHierarchy(dataLabels,chartObj),padding=+(utils.getValueOfPlotOptions(plotoptions,commonPlotOptions)("outerPadding")||0),renderer.autoLabelDone=!1,renderer.showlabel=showlabel,renderer.lineStrokeWidth=validateNullVal(lineConf.strokeWidth,1);var temp_label=appendEle(chartObj.staticPaneSVG.select(".labelholder"),"text",[1],".","class","temp_label");temp_label.attr("transform",translation);var queue=labelHandler.add;(isSunburst?currentdata:currentdata.data).forEach(function(d,i){var dataUpdate=renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[i]:isSunburst?d:pieData,commonProperties=[];applyDatalabelFonts(temp_label,dataLabels,chartObj,rp.color),temp_label.style("fill",TRANSPARENT),dataUpdate.forEach(function(d,j){var text,bb=null,display=!isdisabled(d),heightToBeAdded=0,angle=midAngle(d),isLeft=angle<0||angle>mathPI,X="doubleside"==showlabel?angle<0||angle>mathPI?-(outerRadius+datalabelPadding):outerRadius+datalabelPadding:outlineWithPad.centroid(d)[0],Y=outlineWithPad.centroid(d)[1]+mathMax(0,txtHgt-padding-10-(outerRadius+outlineWithPad.centroid(d)[1])),ANCHOR=isMultiLine?"middle":isLeft?"end":"start",DY=isMultiLine?"0.9em":"circular"==showlabel&&angle>mathPI/2&&angle<3*mathPI/2?getDY(angle)+"em":"0.3em",actualDY=DY,dt=d.data;if(text=(isSunburst?0==d.depth:isdisabled(d))?null:GLT(dt),temp_label[contentType](text).attrs({x:X,y:Y,dy:DY,"text-anchor":ANCHOR}),display&&isMultiLine){translateTspan(temp_label,X);bb=bbox(temp_label.node());if("circular"==showlabel)Y+=d3_scaleLinear().range([-1,0]).domain(angle<mathPI?[0,mathPI]:[2*mathPI,mathPI])(angle)*bb.height,X+=(angle>0&&angle<mathPI?.5:angle>mathPI&&angle<2*mathPI?-.5:0)*bb.width;else Y-=.5*bb.height,X-=bb.width/2*(isLeft?1:-1);temp_label.attr("y",Y),translateTspan(temp_label,X)}if(handleOverlapping){renderer.showlabel="auto";if(isMultiLine||(DY="0.3em",temp_label.attr("dy",DY)),display){heightToBeAdded=getSizeToBeAdded((bb=bbox(temp_label.node())).height,boundBoxPaddingAlone,boundBoxRadius,hookWidth);var DX=isLeft?-(outerRadius+datalabelPadding+10):outerRadius+datalabelPadding+10;isMultiLine&&(DX+=bb.width/2*(isLeft?-1:1));var obj={id:"lbl"+index+"_"+i+"_"+j,x1:bb.x-boundBoxPadding,x2:bb.x+bb.width+boundBoxPadding,y1:bb.y-5-boundBoxPadding-heightToBeAdded/2,y2:bb.y+bb.height+5+boundBoxPadding+heightToBeAdded/2,isLeft:isLeft,actualDY:actualDY,DX:DX-X,overlappingHookPosition:isLeft?RIGHT_ALIGN:LEFT_ALIGN};labelArray.push(obj)}}else heightToBeAdded=getSizeToBeAdded((bb=bbox(temp_label.node())).height,boundBoxPaddingAlone,boundBoxRadius,hookWidth);var coordinate={X:X,Y:Y,DY:DY,ANCHOR:ANCHOR,text:text,display:display,ID:"lbl"+index+"_"+i+"_"+j,width:display?bb.width:0,height:display?bb.height+heightToBeAdded:0,hookPosition:"circular"===showlabel?null:isLeft?RIGHT_ALIGN:LEFT_ALIGN};isHTMLContent&&(coordinate.isLeft=isLeft),commonProperties.push(coordinate)});var q=queue(commonProperties,index,i);q.properties={type:PIE_CHARTNAME,dataLabels:dataLabels,dataUpdate:dataUpdate,showlabel:renderer.showlabel,rp:rp,translation:translation,trans:args[8],txtHgt:txtHgt,isSunburst:isSunburst,connectorPath:function(d,i){var angle=midAngle(d);return"M "+outline.centroid(d)[0]+" "+outline.centroid(d)[1]+" L"+outlineWithPad.centroid(d)[0]+" "+outlineWithPad.centroid(d)[1]+" L"+outlineWithPad.centroid(d)[0]+" "+outlineWithPad.centroid(d)[1]+" L"+(angle<0||angle>mathPI?-(outerRadius+datalabelPadding-boundBoxPadding):outerRadius+datalabelPadding-boundBoxPadding)+" "+outlineWithPad.centroid(d)[1]},onNonOverlap:function(){q.properties.showlabel=renderer.showlabel=showlabel,renderer.autoLabelDone=!0},onOverlap:function(){q.properties.connectorPath=function(d,i){var angle=midAngle(d),pad=mathMax(0,txtHgt-padding-10-(outerRadius+outlineWithPad.centroid(d)[1])),y=outlineWithPad.centroid(d)[1]+pad,flip=angle<0||angle>mathPI?-1:1,newY=q[0][i].Y+(isMultiLine?q[0][i].height/2:0),xControl=newY-y?(outerRadius+datalabelPadding-boundBoxPadding+10)*flip:outlineWithPad.centroid(d)[0],yControl=outlineWithPad.centroid(d)[1],x2=(outerRadius+datalabelPadding-boundBoxPadding+10)*flip,y2=newY;return"M "+outline.centroid(d)[0]+" "+outline.centroid(d)[1]+" Q "+xControl+" "+yControl+" "+x2+" "+y2}},contentType:contentType,isMultiLine:isMultiLine},labelArray.TOP=-args[8][1],labelArray.BOTTOM=chartheight-args[8][1]})}})}function isdisabled(d){return!isWithinColorRange(dataset.getClr(isSunburst?d:d.data),chartObj)||isSunburst&&null==d.parent||0==d.value}function midAngle(d){return((isSunburst?outline.startAngle()(d):d.startAngle)+(isSunburst?outline.endAngle()(d):d.endAngle))/2}return labels.renderer=function(_){return arguments.length?(renderer=_,labels):renderer},labels.args=function(_){return arguments.length?(args=_,labels):args},labels},labelRenderer.scatter=function(){var renderer,args,dataProcessorHelpers=DataProcessor.helpers;function labels(selection,labelHandler){selection.each(function(){var dataLabels,currentdata=args[0],index=args[1],size=args[2]||0,yrangePos=args[3],transform=[0,0],plotoptions=currentdata.plotoptions,rp=renderer.commonRendererProp().params,chartObj=rp.chartObj,systemconf=chartObj.systemConf,commonPlotOptions=rp.commonPlotOptions,dataset=rp.dataset,stacked=rp.stacked,axisrotated=rp.axisrotated,yaxiscolumnorder=rp.yaxiscolumnorder,xscale=rp.xscale,yscale=rp.yscale,labelArray=rp.labelArray,cType=chartObj.chartTypes[index].value,isRangeChart=chartObj.chartTypes[index].name==AREARANGE_CHARTNAME,isCanvasMode="canvas"===chartObj.plot.renderer.mode,scatterOrBubble=isScatterChartType(cType),isBubbleChart=chartcategory.bubble.has(cType),isScatterChart=scatterOrBubble&&!isBubbleChart,isBubblePie=chartcategory.bubblePie.has(cType),isPolar=chartObj.dataObject.isPolarAxisCategory,isGeoHeatmap=charttype.geoheatmap===cType,hasLocationMarker=isScatterChart&&LOCATION_MARKERS.has(commonPlotOptions.marker.symbol),showlabel=isDatalabelEnabled(dataLabels=getMergedDatalabelOptions(commonPlotOptions,plotoptions,chartObj,index),chartObj),labelOrient=pick(dataLabels.orient,"top");if(!currentdata.disabled&&showlabel){var currentPlotBound=getPlotBound(chartObj),boundBoxPadding=0,boundBoxStrokeWidth=0,hookHeight=0,hookWidth=0,boundBoxRadius=0,plotareaBorderCorrection=function(dataLabels,chartObj){var plotareaBorderEle=chartObj.container.selectAll("g.plotareaBorder-property").node(),correction={left:0,top:0,right:0,bottom:0};if(isBoundBoxEnabled(dataLabels,chartObj))for(var side in correction)correction[side]=plotareaBorderEle["border-"+side]?plotareaBorderEle["border-"+side].size/2+1:1;return correction}(dataLabels,chartObj);if(isBoundBoxEnabled(dataLabels,chartObj)){var boundBoxOptions=getMergedBoundBoxOptions(dataLabels,chartObj),hookOptions=getBoundBoxHookConf(boundBoxOptions.hook);boundBoxPadding=getBoundBoxPadding(dataLabels,chartObj),boundBoxStrokeWidth=getBoundBoxStrokeWidth(dataLabels,chartObj),hookHeight=hookOptions.height,hookWidth=hookOptions.width,boundBoxRadius=boundBoxOptions.radius}var padding=isBubbleChart?0:mathMax(0,+(dataLabels.padding||0))+boundBoxPadding+hookHeight,textOverlap=dataLabels.textOverlap,handleOverlapping=!0===systemconf.chart.plot.datalabels.handleOverlapping,multiColoring=!!scatterOrBubble&&isMultiColoring(commonPlotOptions,chartObj),left=currentPlotBound.left,top=currentPlotBound.top,right=currentPlotBound.right,bottom=currentPlotBound.bottom,leftWithBorderCorrection=left+plotareaBorderCorrection.left,topWithBorderCorrection=top+plotareaBorderCorrection.top,rightWithBorderCorrection=right-plotareaBorderCorrection.right,GLT=dataLabelTextContent(chartObj,rp,dataLabels,DATALABELS_LABELTYPE,null,index,yrangePos),contentType=GLT.contentType||"text",isMultiLine="html"===contentType&&GLT.multiLine,isCatNullX=dataProcessorHelpers.isCatNull(dataset,"x"),isCatNullY=dataProcessorHelpers.isCatNull(dataset,"y",yaxiscolumnorder),fontSize=getFontSizeByHierarchy(dataLabels,chartObj),fontStyles=applyDatalabelFonts(null,dataLabels,chartObj,rp.color,!1,index),temp_label=appendEle(chartObj.staticPaneSVG.select(".labelholder"),"text",[1],".","class","temp_label"),updateHandler=labelHandler.update,queue=labelHandler.add,bottomOrient="bottom"===labelOrient&&isScatterChart,factor=bottomOrient?-1:1;currentdata.data.forEach(function(d,i){var dataUpdate=renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[i]:currentdata.data[i],calculated_points=[];applyDatalabelFonts(temp_label,dataLabels,chartObj,rp.color,!1,index),temp_label.styles({fill:TRANSPARENT}),dataUpdate.forEach(function(d,j){var id,midAngle,textBound,xVal=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x",null,yrangePos),yVal=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y",null,yrangePos),zVal=isBubbleChart||isBubblePie?chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"z",chartObj.zscale):null,x=null,y=null,text=null,tspanInfo=null,display=isWithinColorRange(dataset.getClr(d),chartObj)&&!d.disabled,dy=isMultiLine?"0.9em":isBubbleChart||isGeoHeatmap||bottomOrient?"0.3em":"-0.3em",ANCHOR="middle",HOOKPOSITION=isBubbleChart?null:BOTTOM_ALIGN,xDiff=0,yDiff=0;if(isBubblePie){var key=bubblepieUtils.getKey(d,index,chartObj),pieRenderer=chartObj.subrenderer[i][key],pieData=pieRenderer.data[index];midAngle=(pieData.startAngle+pieData.endAngle)/2;var polarXY=polarToXY(zVal/2+padding,midAngle);dy=isMultiLine?"0.9em":midAngle>mathPI/2&&midAngle<3*mathPI/2?getDY(midAngle)+"em":"0",ANCHOR=midAngle<0||midAngle>mathPI?"end":"start",GLT=dataLabelTextContent(chartObj,rp,dataLabels,DATALABELS_LABELTYPE,pieRenderer.total,index,yrangePos)}if(temp_label[contentType](function(){return text=d.isDummy||isCatNullX(dataset.getX(d))||isCatNullY(dataset.getY(d,yaxiscolumnorder,yrangePos))?null:GLT(d)}).styles({display:function(){if(isPolar)return null;return xVal<left||xVal>right||yVal<top||yVal>bottom?(display=!1,NONE):null}}).attrs({transform:null,dy:dy,x:function(){return(x=isBubblePie?xVal+polarXY[0]:xVal)||0},y:function(){return radius=hasLocationMarker?bottomOrient?2:size:(isBubbleChart?0:size)/2,radius*=factor,(y=isBubblePie?yVal+polarXY[1]:yVal+(radius+padding*factor)*(isRangeChart&&!yrangePos?1:-1))||0},"text-anchor":ANCHOR}),id="lbl"+index+"_"+i+"_"+j+"_"+yrangePos,isMultiLine){if(translateTspan(temp_label,x),textBound=bbox(temp_label.node()),isBubblePie){var yAdjust=d3_scaleLinear().range([-1,0]).domain(midAngle<mathPI?[0,mathPI]:[2*mathPI,mathPI]);y+=yAdjust(midAngle)*textBound.height,translateTspan(temp_label,x)}else bottomOrient||(y-=isBubbleChart||isGeoHeatmap?textBound.height/2:textBound.height);temp_label.attr("y",y),textBound=bbox(temp_label.node())}else"html"===contentType?textBound=bbox(temp_label.node()):((textBound=getTextBound(text,fontSize,getFontFamilyByHierarchy(dataLabels,chartObj),null,null,fontStyles["font-style"],fontStyles["font-weight"])).x=x-("middle"===ANCHOR?textBound.width/2:"end"===ANCHOR?textBound.width:0),textBound.y=y-textBound.height,bottomOrient&&(y+=textBound.height/2));var widthToBeAdded=0;if(!isPolar){widthToBeAdded=getSizeToBeAdded(textBound.width,boundBoxPadding,boundBoxRadius,hookWidth);var adjust=boundBoxPadding+boundBoxStrokeWidth/2+widthToBeAdded/2,label=temp_label,leftPos=textBound.x-adjust,rightPos=leftPos+textBound.width+0+2*adjust,newX=x+(leftPos<leftWithBorderCorrection?leftWithBorderCorrection-leftPos:rightPos>rightWithBorderCorrection?-(rightPos-rightWithBorderCorrection):0);(xDiff=newX-x)&&(x=newX,label.attr("x",newX),isMultiLine&&translateTspan(temp_label,newX));var newY=y+(textBound.y<topWithBorderCorrection?textBound.height+size+padding:0);(yDiff=newY-y)&&(!chartObj.dataObject.isStackedPercentChart&&!chartObj.dataObject.isPercentChart||axisrotated?display=!1:(y=newY,label.attr("y",newY))),isMultiLine&&(xDiff||yDiff)?textBound=bbox(temp_label.node()):($Browser.IE&&(textBound=simpleClone(textBound)),textBound.x+=xDiff,textBound.y+=yDiff)}widthToBeAdded=isPolar?getSizeToBeAdded(textBound.width,boundBoxPadding,boundBoxRadius,hookWidth):widthToBeAdded;var bb_width=textBound.width+widthToBeAdded,bb_height=textBound.height,bb_x=textBound.x+widthToBeAdded/2;if(handleOverlapping){var radius=(isBubbleChart?zVal:size)/2;if(isBubbleChart){var cx=xVal,cy=yVal,leftDist=mathSQRT(mathPow(cx-bb_x,2)+mathPow(cy-textBound.y,2))+boundBoxPadding,rightDist=mathSQRT(mathPow(cx-(bb_x+textBound.width),2)+mathPow(cy-(textBound.y+textBound.height),2))+boundBoxPadding;if(leftDist>radius||rightDist>radius){var trimmed;if("ellipsis"===textOverlap){var h=mathMin(textBound.height/2,radius),w=mathSQRT(mathPow(radius,2)-mathPow(h,2)),bubbleBound={left:cx-w+boundBoxPadding,top:cy-w+boundBoxPadding,right:cx+w-boundBoxPadding,bottom:cy+w-boundBoxPadding};"html"===contentType?(tspanInfo=getTspanBound(temp_label,fontSize),trimAllTspan(temp_label,chartObj,transform,0,bubbleBound,tspanInfo)):callTrimText(temp_label,chartObj,transform,0,bubbleBound);var trimmedText=temp_label.text();if(trimmedText&&".."!==trimmedText&&(text=temp_label[contentType](),trimmed=!0,bb_width=2*w-2*boundBoxPadding,isMultiLine)){var newBB=bbox(temp_label.node());bb_height=newBB.height,bb_width=newBB.width+widthToBeAdded,y+=(textBound.height-newBB.height)/2}}trimmed||(display=!1,temp_label.style("display",NONE))}}if(chartObj.isGeoMap&&display||!chartObj.isGeoMap){var obj={id:id,x1:bb_x-boundBoxPadding,y1:textBound.y-boundBoxPadding,x2:bb_x+bb_width+boundBoxPadding,y2:textBound.y+textBound.height+boundBoxPadding+hookHeight,pointRadius:radius+padding-hookHeight,translateFunction:updateHandler,overlap:textOverlap,hookHeight:hookHeight,orient:labelOrient,factor:factor};labelArray.push(obj)}}var coordinate={X:x,Y:y,DY:dy,ANCHOR:ANCHOR,text:text,display:display,height:bb_height,width:bb_width,hookPosition:HOOKPOSITION,adjustVal:xDiff};isCanvasMode&&"html"===contentType&&(coordinate.tspanInfo=tspanInfo||getTspanBound(temp_label,fontSize)),calculated_points.push(coordinate)}),calculated_points.dataUpdate=dataUpdate,queue(calculated_points,index,i,yrangePos).properties={type:SCATTER_CHARTNAME,dataLabels:dataLabels,color:rp.color,dataUpdate:dataUpdate,showlabel:showlabel,multiColoring:multiColoring,rp:rp,rangeChart:isRangeChart,yrangePos:yrangePos,contentType:contentType,isMultiLine:isMultiLine}})}})}return labels.renderer=function(_){return arguments.length?(renderer=_,labels):renderer},labels.args=function(_){return arguments.length?(args=_,labels):args},labels},labelRenderer.pieInnerLabels=function(){var renderer,args,chartObj,dataset;function labels(selection,labelHandler){selection.each(function(){var currentdata=args[0],pieData=args[2],totalEngagement=args[4],translation=args[8]?"translate("+args[8][0]+","+args[8][1]+")":null,arc=args[7],isParent=args[9],rp=renderer.commonRendererProp().params;dataset=rp.dataset,chartObj=rp.chartObj;var commonPlotOptions=rp.commonPlotOptions,index=args[1]||0,isSunburst=isSunburstChartType(chartObj.chartTypes[index].value),outline=args[6],yaxiscolumnorder=rp.yaxiscolumnorder;isParent=isSunburst?isParent:NULL,currentdata=currentdata[index];var isBubblePie=chartcategory.bubblePie.has(chartObj.chartTypes[index].value),innerLabels=getMergedDatalabelOptions(commonPlotOptions,currentdata.plotoptions,chartObj,index).innerLabel,showInnerLabel=!0===innerLabels.show&&datacount_based_intelligence(chartObj,DATALABELS_LABELTYPE);if(isParent){var parentLabelOptions=mergeJSON(innerLabels.parentLabel,innerLabels);showInnerLabel=!1!==(defined(parentLabelOptions.show)?parentLabelOptions.show:innerLabels.show),innerLabels=parentLabelOptions}var GLT=dataLabelTextContent(chartObj,rp,innerLabels,INNERLABEL_LABELTYPE,totalEngagement,index),contentType=GLT.contentType||"text",isMultiLine="html"===contentType&&GLT.multiLine,textOverlap=innerLabels.textOverlap||"adjust",boundBoxPadding=isBoundBoxEnabled(innerLabels,chartObj)?getBoundBoxPadding(innerLabels,chartObj)+getBoundBoxStrokeWidth(innerLabels,chartObj):0;if(!currentdata.disabled&&showInnerLabel){var temp_label=appendEle(chartObj.staticPaneSVG.select(".labelholder"),"text",[1],".","class","temp_label");applyDatalabelFonts(temp_label,innerLabels,chartObj,rp.color),temp_label.attr("transform",translation).style("fill",TRANSPARENT);var queue=labelHandler.add;(isSunburst?currentdata:currentdata.data).forEach(function(d,i){var dataUpdate=isBubblePie?renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[i]:d:pieData,commonProperties=[];dataUpdate.forEach(function(d,j){var X,Y,bb=null,display=!isdisabled(d),DY=isMultiLine?"0.9em":"0.35em",xVal=0,yVal=0;if(isBubblePie){var stacked=rp.stacked,axisrotated=rp.axisrotated,xscale=rp.xscale,yscale=rp.yscale,key=bubblepieUtils.getKey(d,index,chartObj),pieRenderer=chartObj.subrenderer[i][key];d=pieRenderer.data[index],arc=pieRenderer.arc,xVal=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d.data,"x",null),yVal=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d.data,"y",null);var polarXY=polarToXY(chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d.data,"z",chartObj.zscale)/4,midAngle(d));GLT=dataLabelTextContent(chartObj,rp,innerLabels,INNERLABEL_LABELTYPE,pieRenderer.total,index),X=xVal+polarXY[0],Y=yVal+polarXY[1]}else X=arc.centroid(d)[0],Y=arc.centroid(d)[1];var dt=d.data,text=(isSunburst?0==d.depth:isdisabled(d))?null:GLT(dt);if(temp_label[contentType](text).attrs({x:X,y:Y,dy:DY,"text-anchor":"middle"}),display&&isMultiLine&&(translateTspan(temp_label,X),Y-=(bb=bbox(temp_label.node())).height/2),textOverlap!=NONE){bb=bb||bbox(temp_label.node());var centre=arc.centroid(d),wid=bb.width/2+boundBoxPadding,hei=bb.height/2+boundBoxPadding,TL={x:centre[0]-wid,y:centre[1]-hei},TR={x:centre[0]+wid,y:centre[1]-hei},BL={x:centre[0]-wid,y:centre[1]+hei},BR={x:centre[0]+wid,y:centre[1]+hei},isPointInArc=pointIsInArc(TL,d)&&pointIsInArc(TR,d)&&pointIsInArc(BL,d)&&pointIsInArc(BR,d);if(!isPointInArc){if("adjust"===textOverlap){var SA=isSunburst?outline.startAngle()(d):d.startAngle,EA=isSunburst?outline.endAngle()(d):d.endAngle,MA=midAngle(d),extra=bb.height+2*boundBoxPadding,angleArray=[xyToAngle(TL),xyToAngle(TR),xyToAngle(BL),xyToAngle(BR)],posArray=[TL,TR,BL,BR],minmax=d3_extent(angleArray),s=posArray[angleArray.indexOf(minmax[0])],e=posArray[angleArray.indexOf(minmax[1])],dist=mathSQRT((s.x-e.x)*(s.x-e.x)+(s.y-e.y)*(s.y-e.y)),r=mathAbs(dist/2/mathTan((EA-SA)/2))+extra,newCentre=[mathSin(MA)*r,-mathCos(MA)*r];TL={x:newCentre[0]-wid,y:newCentre[1]-hei},TR={x:newCentre[0]+wid,y:newCentre[1]-hei},BL={x:newCentre[0]-wid,y:newCentre[1]+hei},BR={x:newCentre[0]+wid,y:newCentre[1]+hei};isPointInArc=pointIsInArc(TL,d)&&pointIsInArc(TR,d)&&pointIsInArc(BL,d)&&pointIsInArc(BR,d)}isPointInArc?(X=newCentre[0]+xVal,Y=newCentre[1]+yVal):display=!1}}else bb=bbox(temp_label.node());var coordinate={X:X,Y:Y,DY:DY,ANCHOR:"middle",text:text,display:display,ID:"innerlbl"+index+"_"+i+"_"+j,width:bb.width,height:bb.height};commonProperties.push(coordinate)}),queue(commonProperties,index,i,NULL,isParent?PARENTLABELS_LABELTYPE:INNERLABEL_LABELTYPE).properties={type:PIE_CHARTNAME,dataLabels:innerLabels,dataUpdate:dataUpdate,showlabel:showInnerLabel,rp:rp,translation:translation,trans:args[8],isSunburst:isSunburst,contentType:contentType,isMultiLine:isMultiLine}})}function pointIsInArc(pt,ptData){var r1=arc.innerRadius()(ptData),r2=arc.outerRadius()(ptData),theta1=arc.startAngle()(ptData),theta2=arc.endAngle()(ptData),dist=pt.x*pt.x+pt.y*pt.y,angle=xyToAngle(pt);return r1*r1<=dist&&dist<=r2*r2&&isAngleInside(theta1,theta2,angle)}function xyToAngle(obj){return mathAtan2(obj.x,-obj.y)}function isdisabled(d){return!isWithinColorRange(dataset.getClr(isSunburst?d:d.data||d),chartObj)||isSunburst&&null==d.parent||0==d.value}function midAngle(d){return((isSunburst?outline.startAngle()(d):d.startAngle)+(isSunburst?outline.endAngle()(d):d.endAngle))/2}})}return labels.renderer=function(_){return arguments.length?(renderer=_,labels):renderer},labels.args=function(_){return arguments.length?(args=_,labels):args},labels},labelRenderer.funnelInnerLabels=function(){var renderer,args;function labels(selection,labelHandler){selection.each(function(){var currentdata=args[0],index=args[1],data=args[2],arcHeight=args[4],totalEngagement=args[5],cfg=args[6],labelPosition=args[7],chartWidth=cfg.width,rp=renderer.commonRendererProp().params,chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,dataset=rp.dataset,yaxiscolumnorder=rp.yaxiscolumnorder,chartName=chartObj.chartTypes[0].name,translation=chartObj.svg.selectAll("g."+chartName+"group").attr("transform"),isPyramid=chartName===PYRAMID_CHARTNAME,dataLabels=getMergedDatalabelOptions(commonPlotOptions,(currentdata=currentdata[index]).plotoptions,chartObj,index),innerLabels=dataLabels.innerLabel,padding=cfg.datalabelPadding||+dataLabels.padding||0,PathGroupPosition=getSvgTransform(chartObj.svg.selectAll("g."+chartName+"group").node()).translate,data_length=data.length,showInnerLabel=!0===innerLabels.show,txtHgt=getFontSizeByHierarchy(innerLabels,chartObj),GLT=dataLabelTextContent(chartObj,rp,innerLabels,INNERLABEL_LABELTYPE,totalEngagement,index),contentType=GLT.contentType||"text",isMultiLine="html"===contentType&&GLT.multiLine,boundBoxPadding=isBoundBoxEnabled(dataLabels,chartObj)?getBoundBoxPadding(dataLabels,chartObj)+getBoundBoxStrokeWidth(dataLabels,chartObj):0;if(showInnerLabel=showInnerLabel&&datacount_based_intelligence(chartObj,DATALABELS_LABELTYPE),txtHgt+=2*boundBoxPadding,!currentdata.disabled&&showInnerLabel){var temp_label=appendEle(chartObj.staticPaneSVG.select(".labelholder"),"text",[1],".","class","temp_label");applyDatalabelFonts(temp_label,innerLabels,chartObj,rp.color),temp_label.attr("transform",translation).style("fill",TRANSPARENT);var queue=labelHandler.add;currentdata.data.forEach(function(d,i){var dataUpdate=labelPosition,commonProperties=[];dataUpdate.forEach(function(d,j){var display=!function(i){var dt=data[data_length-1-i],isWithinClrRange=isWithinColorRange(dataset.getClr(dt),chartObj);return dt.disabled||!dataset.getY(dt,yaxiscolumnorder)||!isWithinClrRange}(j),X=isPyramid?d.midX:chartWidth/2,Y=isPyramid?d.leftY:d.y,DY=isMultiLine?"0.9em":"0.5em",text=GLT(data[data_length-1-j]),bb=null;if(temp_label[contentType](text).attrs({x:X,y:Y,dy:DY,"text-anchor":"middle"}),display&&isMultiLine&&(translateTspan(temp_label,X),Y-=(bb=bbox(temp_label.node())).height/2,txtHgt=bb.height),display)if(bb=bb||bbox(temp_label.node()),isPyramid)display=!(txtHgt>2*(d.y0-d.leftY));else{var ellipseArcHeight=cfg.canOverlap?(d.rightx-d.leftx-2*padding)/chartWidth*arcHeight:arcHeight;display=!(txtHgt<d.y-(d.y0-d.y)+ellipseArcHeight&&txtHgt>d.y0+ellipseArcHeight-(d.y-(d.y0-d.y)+ellipseArcHeight))}var coordinate={X:X,Y:Y,DY:DY,ANCHOR:"middle",text:text,display:display,ID:"innerlbl"+index+"_"+i+"_"+j,width:display?bb.width:0,height:display?bb.height:0};commonProperties.push(coordinate)}),queue(commonProperties,index,i,NULL,INNERLABEL_LABELTYPE).properties={type:PIE_CHARTNAME,dataLabels:innerLabels,dataUpdate:dataUpdate,showlabel:showInnerLabel,rp:rp,translation:translation,trans:PathGroupPosition,reverseColor:!0,contentType:contentType,isMultiLine:isMultiLine}})}})}return labels.renderer=function(_){return arguments.length?(renderer=_,labels):renderer},labels.args=function(_){return arguments.length?(args=_,labels):args},labels},labelRenderer.bullet=function(targetMarkerOptions,renderer,dataUpdate){var targetLabelOptions=targetMarkerOptions.label||{},chartObj=this,dataset=this.dataset,plotarea=this.plotarea,systemconf=this.systemConf,commonOption=renderer.commonOption,rp=renderer.commonRendererProp().params,axisrotated=rp.axisrotated,yscale=rp.yscale,rangeBand=rp.xscale.bandwidth(),yaxisOrient=systemconf.chart.axes.yaxis[0].orient||(this.axes.rotated?BOTTOM_ALIGN:LEFT_ALIGN),targetDataIndex=targetMarkerOptions.dataindex,showlabel=!0===targetMarkerOptions.enabled&&!0===targetLabelOptions.enabled&&defined(targetDataIndex),targetLabelGroup=appendEle(this.staticPaneSVG.selectAll("g.threshold"),"g",showlabel?[1]:[],".","class","targetLabel");if(targetLabelGroup.attr("transform","translate("+plotarea.left+","+plotarea.top+")"),showlabel){var hAlign=targetLabelOptions.hAlign,vAlign=targetLabelOptions.vAlign,padding=validateNullVal(targetLabelOptions.padding,2),isFixedPosition="fixed"===targetLabelOptions.position,markerSize=10*validateNullVal(targetMarkerOptions.size,(commonOption.levelMarkerWidth-2*validateNullVal(targetMarkerOptions.padding,commonOption.padding/2))/10),markerSizeAdjust=("line"===targetMarkerOptions.symbol?validateNullVal(targetMarkerOptions.outerStrokeWidth,1):markerSize)/2;axisrotated?(hAlign=hAlign||CENTER_ALIGN,vAlign=vAlign||(yaxisOrient===BOTTOM_ALIGN?TOP_ALIGN:BOTTOM_ALIGN)):(hAlign=hAlign||(yaxisOrient===LEFT_ALIGN?RIGHT_ALIGN:LEFT_ALIGN),vAlign=vAlign||CENTER_ALIGN);var columns=this.userdata.metadata.columns,columnidx=columns.filter(function(d){return d.dataindex===targetMarkerOptions.dataindex}),targetColumn=columnidx.length?columnidx[0]:columns[dataset.getColumnIdx("y",0)],datatype=targetColumn.datatype,formatConf=targetColumn[datatype],adjust={left:0,right:0,top:0,bottom:0};axisrotated?adjust.top=adjust.bottom=plotarea.adjust:adjust.left=adjust.right=plotarea.adjust,isFixedPosition||!0!==systemconf.chart.axes.yaxis[0].show||(adjust[yaxisOrient]=0);var rectBound=chartObj.container.node().getBoundingClientRect(),rectBoundLeft=rectBound.left+chartObj.plotarea.left,rectBoundTop=rectBound.top+chartObj.plotarea.top,currentPlotBound=getPlotBound(chartObj),left=currentPlotBound.left-adjust.left,top=currentPlotBound.top-adjust.top,right=currentPlotBound.right+adjust.left+adjust.right,bottom=currentPlotBound.bottom+adjust.top+adjust.bottom;applyFont(targetLabelGroup,[targetLabelOptions,systemconf.chart,systemconf.canvas,$ZCG]);appendEle(targetLabelGroup,"text",dataUpdate,null,null,null,null,function(d){return dataset.getX(d)}).each(function(d){var targetValue=d[targetDataIndex];if(defined(targetValue)){var X,Y,DY,ANCHOR,xValue=dataset.getX(d),TEXT=defined(targetLabelOptions.text)?dataset.getCustomizedVal(chartObj,targetLabelOptions.text,0,null,null,d,"targetLabel"):getFormattedValue(formatConf,targetValue,datatype,chartObj,"targetLabel"),isNeg=targetValue<0,flip=isNeg?-1:1,x=commonOption.bandwidth1(xValue)+rangeBand/2,y=yscale(targetValue);axisrotated?(X=y,Y=x,vAlign===BOTTOM_ALIGN?(Y+=markerSize/2,hAlign===CENTER_ALIGN&&(DY="1em",Y=x+(isFixedPosition?rangeBand:markerSize)/2)):vAlign===CENTER_ALIGN?DY="0.3em":vAlign===TOP_ALIGN&&(Y-=markerSize/2,hAlign===CENTER_ALIGN?(DY="-0.3em",Y=x-(isFixedPosition?rangeBand:markerSize)/2):DY="1em"),hAlign===CENTER_ALIGN?(ANCHOR="middle",Y-=vAlign===CENTER_ALIGN?0:vAlign===TOP_ALIGN?padding*flip:-padding*flip):hAlign===RIGHT_ALIGN?(X+=(padding+markerSizeAdjust)*flip,ANCHOR=isNeg?"end":null):(X-=(padding+markerSizeAdjust)*flip,ANCHOR=isNeg?null:"end")):(X=x,Y=y,hAlign===RIGHT_ALIGN?X+=(isFixedPosition?rangeBand:markerSize)/2:hAlign===CENTER_ALIGN?ANCHOR="middle":hAlign===LEFT_ALIGN&&(X-=(isFixedPosition?rangeBand:markerSize)/2,ANCHOR="end"),vAlign===CENTER_ALIGN?(X+=hAlign===CENTER_ALIGN?0:hAlign===RIGHT_ALIGN?padding:-padding,DY="0.3em"):vAlign===TOP_ALIGN?(Y-=(padding+markerSizeAdjust)*flip,DY="-0.3em"):(Y+=(padding+markerSizeAdjust)*flip,DY="1em")),d3_select(this).attrs({transform:"translate("+X+","+Y+")","text-anchor":ANCHOR,dy:DY}).text(TEXT);var b=this.getBoundingClientRect(),leftPos=b.left-rectBoundLeft,rightPos=leftPos+b.width,topPos=b.top-rectBoundTop,bottomPos=topPos+b.height,newX=X+(leftPos<left?left-leftPos:rightPos>right?-(rightPos-right):0),newY=Y+(topPos<top?top-topPos:bottomPos>bottom?-(bottomPos-bottom):0);newX!=X&&(X=newX),newY!=Y&&(Y=newY),d3_select(this).attr("transform","translate("+X+","+Y+")")}})}};var treemapUtils={getTileBound:function(chartObj,dataPoint){var xScale=chartObj.axes.x.scale,yScale=chartObj.axes.y.groups[0].scale,x0=dataPoint.x0||0,x1=dataPoint.x1||0,y0=dataPoint.y0||0,y1=dataPoint.y1||0;return{x:xScale(x0),y:yScale(y0),width:xScale(x1)-xScale(x0),height:yScale(y1)-yScale(y0)}},getLevel:function(d){return d.level||d.data&&d.data.level},getSeriesIndex:function(d){var level=treemapUtils.getLevel(d);if(level)return+level.split("_")[0]},getItemIndex:function(d){var level=treemapUtils.getLevel(d);if(level){var split=level.split("_");return+split[split.length-1]}}};treemapUtils.getParentColor=function(commonRendererProp,d){var opacity,rgba,rp=commonRendererProp.params,seriesColors=rp.color,parentColor=rp.commonPlotOptions.parent.fillColor,clr=TRANSPARENT;if(d.depth){var currentSeriesColor=seriesColors[treemapUtils.getSeriesIndex(d)%seriesColors.length];"{{clr-tint}}"===parentColor?clr=getColorCopy(currentSeriesColor,.5,"brighter",d3$1.hsl):"{{clr-shade}}"===parentColor?clr=getColorCopy(currentSeriesColor,.5,"darker",d3$1.hsl):"{{clr}}"===parentColor?clr=currentSeriesColor:parentColor?clr=parentColor:(opacity=1e-4,(rgba=d3_rgb(currentSeriesColor)).opacity=isUndefined(opacity)?1:opacity,clr=rgba.toString())}return clr},treemapUtils.isDisabled=function(chartObj,d){var seriesIndex=treemapUtils.getSeriesIndex(d);return defined(seriesIndex)&&chartObj.seriesdata[seriesIndex].disabled},labelRenderer.hierarchy=function(){var renderer,args;function labels(selection,labelHandler){selection.each(function(){var dataLabels,currentdata=args[0],index=args[1],yrangePos=(args[2],args[3]),total=args[4],leafNodes=args[5],transform=args[6]||[0,0],isParent=args[7],plotoptions=currentdata.plotoptions,rp=renderer.commonRendererProp().params,chartObj=rp.chartObj,systemconf=chartObj.systemConf,commonPlotOptions=rp.commonPlotOptions,dataset=rp.dataset,yaxiscolumnorder=rp.yaxiscolumnorder,xscale=(rp.labelArray,rp.xscale),yscale=rp.yscale,showlabel=isDatalabelEnabled(dataLabels=getMergedDatalabelOptions(commonPlotOptions,plotoptions,chartObj,index),chartObj),chartName=chartObj.chartTypes[0].name;if(isParent){var parentLabelOptions=mergeJSON(commonPlotOptions.parent.datalabels,dataLabels);showlabel=isTrue(parentLabelOptions.show),dataLabels=parentLabelOptions}if(!currentdata.disabled&&showlabel){getPlotBound(chartObj);var boundBoxPadding=0;if(isBoundBoxEnabled(dataLabels,chartObj)){var boundBoxOptions=getMergedBoundBoxOptions(dataLabels,chartObj),hookOptions=getBoundBoxHookConf(boundBoxOptions.hook);boundBoxPadding=getBoundBoxPadding(dataLabels,chartObj),getBoundBoxStrokeWidth(dataLabels,chartObj),hookOptions.height,hookOptions.width,boundBoxOptions.radius}var textOverlap=dataLabels.textOverlap,hAlign=dataLabels.hAlign||CENTER_ALIGN,vAlign=dataLabels.vAlign||CENTER_ALIGN,padding=validateNullVal(dataLabels.padding,.5),handleOverlapping=!0===systemconf.chart.plot.datalabels.handleOverlapping&&textOverlap!==NONE,GLT=dataLabelTextContent(chartObj,rp,dataLabels,DATALABELS_LABELTYPE,total,index,yrangePos),contentType=GLT.contentType||"text",isMultiLine="html"===contentType&&GLT.multiLine,hasShowAsFunction=GLT.hasShowAsFunction,multiColoring=isMultiColoring(commonPlotOptions,chartObj),fontSize=getFontSizeByHierarchy(dataLabels,chartObj),heightAdjustScale=d3_scaleLinear().domain([-.3,.9]),isCanvasMode="canvas"===chartObj.plot.renderer.mode,dyInfo=function(){var DY,actualDY;DY=vAlign===CENTER_ALIGN?.3:vAlign===BOTTOM_ALIGN?-.3:1;if(isMultiLine){var lineCount=1.1*(dataLabels.showAs.length-1);-.3===DY?actualDY=(DY-=lineCount)+lineCount:.3===DY&&(actualDY=(DY-=lineCount/2)+lineCount/2)}return[DY,actualDY]}(),fontStyles=applyDatalabelFonts(null,dataLabels,chartObj,rp.color,!1,index);textOverlap=hasShowAsFunction&&"ellipsis"===textOverlap?"hidden":textOverlap;var temp_label=appendEle(chartObj.staticPaneSVG.select(".labelholder"),hasShowAsFunction?"g":"text",[1],".","class","temp_label"),queue=(labelHandler.update,labelHandler.add),dataUpdate=leafNodes,calculated_points=[];applyDatalabelFonts(temp_label,dataLabels,chartObj,rp.color,!1,index),temp_label.styles({fill:TRANSPARENT}),dataUpdate.forEach(function(d,j){var textBound,pos=function(d){var pos=getRawPosition(d),x=pos.x,y=pos.y,w=pos.width,h=pos.height;return x=function(x,w){return x+=hAlign===CENTER_ALIGN?w/2:hAlign===RIGHT_ALIGN?w-padding-boundBoxPadding:padding+boundBoxPadding}(x,w)+transform[0],y=function(y,h){return y+=vAlign===CENTER_ALIGN?h/2:vAlign===BOTTOM_ALIGN?h-padding-boundBoxPadding:padding+boundBoxPadding}(y,h)+transform[1],{x:x,y:y,w:w,h:h}}(d),x=pos.x,y=pos.y,text=null,tspanInfo=null,display=!colorscale_helpers.isQuantileColorScale(chartObj)||isWithinColorRange(dataset.getClr(d.data||d),chartObj),dy=dyInfo[0]+"em",actualDY=dyInfo[1],ANCHOR=hAlign===CENTER_ALIGN?"middle":hAlign===RIGHT_ALIGN?"end":null;if(temp_label[contentType](function(){return text=GLT(d.data||d,pos)}).attrs({dy:dy,transform:"translate("+[x,y]+")","text-anchor":ANCHOR,display:display}),"lbl"+d.level,"html"===contentType){if(isMultiLine&&translateTspan(temp_label,0),hAlign!==CENTER_ALIGN){temp_label.attr("text-anchor",END_ALIGN);var dEnd=(textBound=bbox(temp_label)).width+textBound.x;temp_label.attr("text-anchor",START_ALIGN),x+=((textBound=bbox(temp_label)).x-dEnd)*(hAlign===RIGHT_ALIGN?1:-1),temp_label.attr("transform","translate("+[x,y]+")").attr("text-anchor",ANCHOR)}textBound=bbox(temp_label)}else textBound=function(textBound,ANCHOR,dy,x,y){var w=textBound.width,h=textBound.height,tx="middle"===ANCHOR?w/2:"end"===ANCHOR?w:0,ty=heightAdjustScale.range([h,0])(parseFloat(dy));return textBound.x=-tx,textBound.y=-ty,textBound}(textBound=getTextBound(text,fontSize,getFontFamilyByHierarchy(dataLabels,chartObj),null,null,fontStyles["font-style"],fontStyles["font-weight"]),ANCHOR,dy);var bb_width=textBound.width+0,bb_height=textBound.height;textBound.x;if(handleOverlapping){var labelBound={x1:textBound.x+x-boundBoxPadding,y1:textBound.y+y-boundBoxPadding,x2:textBound.x+x+textBound.width+boundBoxPadding,y2:textBound.y+y+textBound.height+boundBoxPadding},nodeBound=function(pos,textBound){var nodeheight=pos.height-2*padding,nodewidth=pos.width-2*padding,nodex=pos.x+transform[0]+padding,nodey=pos.y+transform[1]+padding,bb={x1:nodex,y1:nodey,x2:nodex+nodewidth,y2:nodey+nodeheight};if(chartName===PACKEDBUBBLE_CHARTNAME){var radius=nodewidth/2,vert=mathMin(textBound.height/2,radius),hori=mathSQRT(mathPow(radius,2)-mathPow(vert,2)),excess=radius-hori;bb.x1+=excess,bb.x2-=excess,bb.y1+=excess,bb.y2-=excess}return bb}(getRawPosition(d),textBound);if(!isLabelWithinBound(labelBound,nodeBound)){var trimmed;if("ellipsis"===textOverlap){var h=pos.h,w=pos.w;if(bb_height+2*boundBoxPadding<h){var bound={left:nodeBound.x1+boundBoxPadding,top:nodeBound.y1+boundBoxPadding,right:nodeBound.x2-boundBoxPadding,bottom:nodeBound.y2-boundBoxPadding};"html"===contentType?(tspanInfo=getTspanBound(temp_label,fontSize),trimAllTspan(temp_label,chartObj,transform,0,bound,tspanInfo,NULL,[x,y])):callTrimText(temp_label,chartObj,transform,0,bound,[x,y]);var trimmedText=temp_label.text();if(trimmedText&&".."!==trimmedText&&(text=temp_label[contentType](),trimmed=!0,bb_width=w-2*boundBoxPadding,isMultiLine)){var newBB=bbox(temp_label);bb_height=newBB.height,bb_width=newBB.width+0,y+=(textBound.height-newBB.height)/2}}}trimmed?"html"===contentType&&(tspanInfo=getTspanBound(temp_label,fontSize)):display=!1}}var coordinate={X:0,DY:dy,xy:[x,y],actualDY:actualDY,ANCHOR:ANCHOR,text:text,display:display,height:bb_height,width:bb_width,hookPosition:null,adjustVal:0};isCanvasMode&&"html"===contentType&&(hasShowAsFunction?coordinate.customHTML=getCustomHTML(temp_label):coordinate.tspanInfo=tspanInfo||getTspanBound(temp_label,fontSize)),calculated_points.push(coordinate)}),calculated_points.dataUpdate=dataUpdate,queue(calculated_points,index,0,yrangePos,isParent?PARENTLABELS_LABELTYPE:NULL).properties={type:"hierarchy",dataLabels:dataLabels,color:rp.color,dataUpdate:dataUpdate,showlabel:showlabel,multiColoring:multiColoring,rp:rp,contentType:contentType,isMultiLine:isMultiLine,GLT:GLT}}function getRawPosition(d){switch(chartName){case PACKEDBUBBLE_CHARTNAME:return w=2*(dataPoint=d).r,h=2*dataPoint.r,{x:(dataPoint.x||0)-w/2,y:(dataPoint.y||0)-h/2,width:w,height:h};case TREEMAP_CHARTNAME:var pos=treemapUtils.getTileBound(chartObj,d);return pos=function(pos){if(isParent&&("bottom-outset"===dataLabels.position||"top-outset"===dataLabels.position)){var tilePadding=parseShortHandValue(commonPlotOptions.padding),adjust=tilePadding["bottom-outset"===dataLabels.position?"bottom":"top"];"bottom-outset"===dataLabels.position&&(pos.y=pos.y+pos.height-adjust),pos.height=adjust}return pos}(pos);case HEATMAP_CHARTNAME:return getHeatCellPosition(chartObj,d,xscale,yscale,yaxiscolumnorder)}var dataPoint,w,h}})}return labels.renderer=function(_){return arguments.length?(renderer=_,labels):renderer},labels.args=function(_){return arguments.length?(args=_,labels):args},labels};var $ZC_TOOLTIP_POSITION={};function d3_mousePoint(container,i){var e=function(){var s,e=d3$1.event;for(;s=e.sourceEvent;)e=s;return e}();e.changedTouches&&(e=e.touches[i]);var svg=container.ownerSVGElement||container;if(svg.createSVGPoint){var point=svg.createSVGPoint();point.x=e.clientX,point.y=e.clientY;var mouse=[(point=point.matrixTransform(container.getScreenCTM().inverse())).x,point.y];return isTouchEvent(d3$1.event)&&!$Browser.ANDROID&&$Browser.uiwebview&&(mouse[0]+=window.pageXOffset,mouse[1]+=window.pageYOffset),mouse}var rect=container.getBoundingClientRect();return[e.clientX-rect.left-container.clientLeft,e.clientY-rect.top-container.clientTop]}function isTouchEvent(event){return event.touches}function generateDataForAnnotation(d,seriesname){var clonedata=(d.data||d).slice(),data=clonedata.splice(0,clonedata.length);return null!=seriesname&&data.push(seriesname),data}function saveAnnotation(noteConf,id,text,coordinate,annotationType){"plot"==annotationType?noteConf.plotValues.push({data:id,text:text}):noteConf[annotationType+"Values"].push({id:id,text:text,x:coordinate[0],y:coordinate[1]})}function getCoordinateWithinBound(left,top,width,height,chartWidth,chartHeight){return left+width>chartWidth&&(left-=left+width-chartWidth),top+height>chartHeight&&(top-=top+height-chartHeight),[left,top]}function getAnnotationIndex(noteConf,id,basedOn){var conf=noteConf[basedOn+"Values"];return conf.indexOf(conf.filter(function(d){return"plot"===basedOn?jsonStringify(d.data)==jsonStringify(id):d.id==id})[0])}function get_threshold_text_orient(orient){return/(left|right)/.test(orient)?"bottom":"left"}function overrideThresholdFonts(systemConf,userOptions){for(var attr in userOptions)userOptions.hasOwnProperty(attr)&&(systemConf[attr]=userOptions[attr]);return systemConf}$ZC_TOOLTIP_POSITION.relative=function(position,element,chartObj,hookHeight,dist,isWithinChart,hookBorderWidth,parsedBorderRadius,defaultMaxWidth,defaultMaxHeight){element.selectAll("#tooltipcontent").styles({width:null,height:null,"max-width":defaultMaxWidth+PX,"max-height":defaultMaxHeight+PX});var eleNode=element.node(),eleWidth=eleNode.offsetWidth,eleHeight=eleNode.offsetHeight,canvasarea=chartObj.canvasarea,chartarea=chartObj.chartarea,distance=dist+hookHeight+(position.distance||0),dTop=position.dTop||0,dLeft=position.dLeft||0,tooltipConfig=chartObj.systemConf.tooltip,orient=(tooltipConfig.relative||{}).orient,availableWidth=(tooltipConfig.borderTop,chartarea.width-chartarea.left+chartarea.right),availableHeight=chartarea.height,dim=tooltip_helpers.getSize(tooltipConfig,[availableWidth,availableHeight],[eleWidth,eleHeight],[defaultMaxWidth,defaultMaxHeight]),width=dim.w,height=dim.h,hookPosition={left:50,top:100,rotation:0},checkBounds={left:mathAbs(mathMin(dLeft,0))+(chartObj.scrolledX||0),top:mathAbs(mathMin(dTop,0))+(chartObj.scrolledY||0),right:canvasarea.width-2-mathMax(dLeft,0)+mathAbs(mathMin(dLeft,0)),bottom:canvasarea.height-mathMax(dTop,0)+mathAbs(mathMin(dTop,0))},coordinate={x:position.left-width/2,y:position.top-height-distance,maxw:defaultMaxWidth+PX,maxh:defaultMaxHeight+PX};if(isWithinChart&&!chartObj.scrolledX&&!chartObj.scrolledY){var maxTop=position.top-height-distance,maxRight=position.left+width+distance,maxLeft=position.left-width-distance,maxBottom=position.top+height+distance;(orient=orient||(maxTop>checkBounds.top?TOP_ALIGN:maxRight<checkBounds.right?RIGHT_ALIGN:maxLeft>checkBounds.left?LEFT_ALIGN:maxBottom<checkBounds.bottom?BOTTOM_ALIGN:null))==TOP_ALIGN?(positionHook(TOP_ALIGN),hookPosition.rotation=0,hookPosition.top=100):orient==RIGHT_ALIGN?(coordinate.x=position.left+distance,positionHook(RIGHT_ALIGN),hookPosition.rotation=90,hookPosition.left=0):orient==LEFT_ALIGN?(coordinate.x=position.left-distance-width,positionHook(LEFT_ALIGN),hookPosition.rotation=-90,hookPosition.left=100):orient==BOTTOM_ALIGN&&(positionHook(BOTTOM_ALIGN),coordinate.y=position.top+distance,hookPosition.rotation=180,hookPosition.top=0)}return coordinate.hookPosition=hookPosition,coordinate;function positionHook(mode){var rad;/(top|bottom)/.test(mode)?position.left-width/2<checkBounds.left?(rad=getRad(mode==TOP_ALIGN?"blx":"tlx"),coordinate.x=checkBounds.left,hookPosition.left=mathMax(rad,position.left-checkBounds.left)/width*100):position.left+width/2>checkBounds.right?(rad=getRad(mode==TOP_ALIGN?"brx":"trx"),coordinate.x=checkBounds.right-width,hookPosition.left=100*(1-mathMax(rad,checkBounds.right-position.left)/width)):hookPosition.left=50:position.top-height/2<checkBounds.top?(rad=getRad(mode==LEFT_ALIGN?"trY":"tly"),coordinate.y=checkBounds.top,hookPosition.top=mathMax(rad,position.top-checkBounds.top)/height*100):position.top+height/2>checkBounds.bottom?(rad=getRad(mode==LEFT_ALIGN?"bry":"bly"),coordinate.y=checkBounds.bottom-height,hookPosition.top=100*(1-mathMax(rad,checkBounds.bottom-position.top)/height)):(coordinate.y=position.top-height/2,hookPosition.top=50)}function getRad(attr){return hookHeight+parsedBorderRadius[attr]+mathSQRT(mathPow(hookBorderWidth,2)+mathPow(hookBorderWidth,2))}},$ZC_TOOLTIP_POSITION.fixed=function(position,element,chartObj){element.selectAll("#tooltipcontent").styles({width:null,height:null,"max-width":null,"max-height":null}),element.style("border-width",0);var maxh,elementNode=element.node(),eleWidth=elementNode.offsetWidth,eleHeight=elementNode.offsetHeight,canvasarea=chartObj.canvasarea,dTop=position.dTop||0,dLeft=position.dLeft||0,tooltipConfig=chartObj.systemConf.tooltip,orient=(tooltipConfig.fixed||{}).orient,borderTop=tooltipConfig.borderTop||0,borderWidth=pick(tooltipConfig.borderWidth,1),parsedBorderWidth=parseShortHandValue(borderWidth),borderWidthTop=parsedBorderWidth.top,borderWidthRight=parsedBorderWidth.right,borderWidthBottom=parsedBorderWidth.bottom,borderWidthLeft=parsedBorderWidth.left,availableWidth=canvasarea.width-borderWidthLeft-borderWidthRight,availableHeight=canvasarea.height-borderWidthTop-borderWidthBottom,dim=tooltip_helpers.getSize(tooltipConfig,[availableWidth,availableHeight],[eleWidth,eleHeight]),width=dim.w,height=dim.h,checkBounds_left=0,checkBounds_top=0,checkBounds_right=window.innerWidth,checkBounds_bottom=window.innerHeight,coordinate={x:mathAbs(mathMin(dLeft,0)),y:mathAbs(mathMin(dTop,0))},x=mathAbs(mathMin(dLeft,0)),y=mathAbs(mathMin(dTop,0)),w=width,h=height,maxTop=coordinate.y-height,maxRight=coordinate.x+canvasarea.width+width,maxLeft=coordinate.x-width,maxBottom=coordinate.y+canvasarea.height+height,hasEnoughHeightAfterScrollY=dTop<=0||dTop>0&&canvasarea.height-dTop>height;return orient||(maxTop>checkBounds_top?orient=TOP_ALIGN:maxRight<checkBounds_right&&hasEnoughHeightAfterScrollY?orient=RIGHT_ALIGN:maxLeft>checkBounds_left&&hasEnoughHeightAfterScrollY?orient=LEFT_ALIGN:maxBottom<checkBounds_bottom&&(orient=BOTTOM_ALIGN)),orient===TOP_ALIGN?(coordinate.y=y-height-borderWidthTop-borderWidthBottom,w=availableWidth-(dLeft>0?dLeft:0),maxh="40%"):orient===RIGHT_ALIGN?(coordinate.x=x+canvasarea.width,h=availableHeight-(dTop>0?dTop:0)):orient===LEFT_ALIGN?(coordinate.x=x-width-borderWidthRight-borderWidthLeft,h=availableHeight-(dTop>0?dTop:0)):orient===BOTTOM_ALIGN?(coordinate.y=y+canvasarea.height-(dTop>0?dTop:0),w=availableWidth-(dLeft>0?dLeft:0),maxh="40%"):(coordinate.y=y,w=availableWidth-(dLeft>0?dLeft:0),maxh="40%"),dim=tooltip_helpers.getSize(tooltipConfig,[availableWidth,availableHeight],[w,h]),coordinate.w=dim.w+PX,coordinate.h=dim.h-borderTop+PX,coordinate.maxw=availableWidth-(dLeft>0?dLeft:0)+PX,coordinate.maxh=mathMin(availableHeight-(dTop>0?dTop:0),isUndefined(tooltipConfig.height)&&isUndefined(tooltipConfig.maxHeight)&&defined(maxh)?perToPx(maxh,availableHeight):1/0)+PX,element.style("border-width",shorthand_px(borderWidth)),coordinate},$ZC_TOOLTIP_POSITION.block=function(position,element,chartObj){var chartarea=chartObj.chartarea,plotarea=chartObj.plotarea,tooltipConfig=chartObj.systemConf.tooltip,blockConfig=tooltipConfig.block||{},borderTop=tooltipConfig.borderTop||0,parsedBorderWidth=parseShortHandValue(pick(tooltipConfig.borderWidth,1)),borderWidthTop=parsedBorderWidth.top,borderWidthRight=parsedBorderWidth.right,borderWidthLeft=parsedBorderWidth.left,vAlign=blockConfig.vAlign||TOP_ALIGN,hAlign=blockConfig.hAlign,dTop=position.dTop||0,dLeft=position.dLeft||0,availableWidth=chartarea.width-borderWidthLeft-borderWidthRight,availableHeight=chartarea.height,dim=tooltip_helpers.getSize(tooltipConfig,[availableWidth,availableHeight],["100%",chartObj.tooltip.preCalculatedHeight]),w=dim.w,h=mathMin(dim.h,perToPx(tooltip_block_helpers.MAXHEIGHT_BLOCK,availableHeight)),coordinate={x:mathAbs(mathMin(dLeft,0))-mathMax(dLeft,0)+chartarea.left,y:mathAbs(mathMin(dTop,0))-mathMax(dTop,0),w:w+PX,h:h-borderTop+PX,align:hAlign};return hAlign===RIGHT_ALIGN?coordinate.x+=availableWidth-w:hAlign===CENTER_ALIGN&&(coordinate.x+=(availableWidth-w)/2),coordinate.y+=vAlign===BOTTOM_ALIGN?plotarea.top+plotarea.height+(plotarea.bottom-h)-borderWidthTop-borderWidthRight:chartarea.top,coordinate},events.tooltip=function(element,data,chartObj){var tooltip={element:element},systemConf=chartObj.systemConf,dataset=chartObj.dataset,metadata=systemConf.metadata,metadata_axes=metadata.axes,metadata_columns=metadata.columns,tooltipIndices=metadata_axes.tooltip||d3$1.range(metadata_columns.length),tooltip_data=systemConf.tooltip,themeMaxWidth=null,tooltipPosition=tooltip_data.position||"relative",hookEnabled="relative"===tooltipPosition,hookPosition={left:50,top:100,rotation:0};if(tooltip_data.theme&&""!==tooltip_data.theme){var theme=isObjectPropDefined($ZC,"tooltip.getTheme")&&$ZC.tooltip.getTheme(tooltip_data.theme,chartObj);null!==theme&&(tooltip_data=chartObj.systemConf.tooltip=mergeJSON(tooltip_data,theme.borderStyle,!0,!0),chartObj.tooltip.content=[theme.body],themeMaxWidth=theme.maxWidth)}var arrowbefore,arrowafter,arrowBeforeNAfter,contentBox,hookHeight=validateNullVal(tooltip_data.hookHeight,6),dist=validateNullVal(tooltip_data.outerPadding,20),borderWidth=defined(tooltip_data.borderWidth)?tooltip_data.borderWidth:1,borderRadius=defined(tooltip_data.borderRadius)?tooltip_data.borderRadius:5,borderStyle=defined(tooltip_data.borderStyle)?tooltip_data.borderStyle:"solid",padding=defined(tooltip_data.padding)?tooltip_data.padding+"":"5",isWithinChart=validateNullVal(tooltip_data.withinChart,!0),hookBorderWidth=validateNullVal(tooltip_data.hookBorderWidth,/ /g.test(borderWidth)?1:+borderWidth),parsedBorderRadius=getBorderRadius(borderRadius),maxWidth=perToPx(tooltip_data.maxWidth||themeMaxWidth||"40%",chartObj.chartarea.width),maxHeight=perToPx(tooltip_data.maxHeight||"100%",chartObj.chartarea.height),minWidth=mathMax(.05*chartObj.chartarea.width,2*hookHeight),headerContentFunc=tooltip_data.headerContent,footerContentFunc=tooltip_data.footerContent,crosshair_data=tooltip_data.crosshair;function drawCrosshairLine(chartObj,x,y,data,type){var ele=chartObj.staticPaneSVG.selectAll("line."+type+"-crosshair"),isVerticalLine="x"==type&&!chartObj.axes.rotated||"y"==type&&chartObj.axes.rotated;ele.attrs({x1:isVerticalLine?x:chartObj.plotarea.left,y1:isVerticalLine?chartObj.plotarea.top:y,x2:isVerticalLine?x:chartObj.plotarea.left+chartObj.plotarea.width,y2:isVerticalLine?chartObj.plotarea.height+chartObj.plotarea.top:y}).styles({"shape-rendering":"crispEdges",stroke:data.color,"stroke-width":data.strokeWidth,"stroke-dasharray":getDashArray(data.dashStyle,data.strokeWidth),"pointer-events":NONE})}function getDefaultContent(seriesindex,subseriespos,itempos,color,d,customTooltipIndices){if(isObjectPropDefined($ZC,"tooltip.getTheme")&&defined(systemConf.tooltip.theme)&&""!==systemConf.tooltip.theme&&defined(chartObj.tooltip.content))return dataset.getCustomizedVal(chartObj,chartObj.tooltip.content,seriesindex,subseriespos,itempos,d,"tooltip",color);var hasMultiColoring=checkMultiColoring(chartObj.chartTypes[seriesindex].name),dataPoint=dataset.getDataPoint(chartObj,null,seriesindex,subseriespos,itempos,d),clr=getRawColor(chartObj,hasMultiColoring?itempos:seriesindex,dataPoint,seriesindex),indices=(customTooltipIndices||tooltipIndices).filter(function(idx){return!(metadata_columns[idx]&&isUndefined(dataset.getDataPoint(chartObj,idx,seriesindex,subseriespos,itempos,d)))}),template=tooltip_content.getContentTemplate(chartObj,NULL,indices);return dataset.getCustomizedVal(chartObj,template,seriesindex,subseriespos,itempos,d,"tooltip",clr)}function getTooltipSharedContent(seriesindex,subseriespos,itempos,d,tooltipSharedInfo,color,hasMultiColoring,subseriesLength){var clridx=dataset.getColumnIdx("clr"),yaxiscolumnorder_series=chartObj.seriesdata[seriesindex].yaxiscolumnorder||[0,0],repeatIndex=chartObj.dataObject.pieWithAxis&&!chartObj.dataObject.isCombinationalChart?tooltip_helpers.getPieColumnIndex(chartObj):dataset.getColumnIdx("y",yaxiscolumnorder_series),sharedKeys=tooltipSharedInfo.keys(),y_pattern=tooltipSharedInfo.y_val_pattern,meta_tooltip=tooltip_content.getRawSharedContent(chartObj,tooltipSharedInfo,tooltipIndices),i=0,updatePattern=function(pattern,curSerpos,subseriespos,curItempos,clr,copy_y_pattern){if(chartObj.ismultiy||null==clridx){var seriesName=encodeHTML(chartObj.seriesdata[curSerpos].seriesname)||copy_y_pattern.replace(/val/gi,"col");pattern=pattern.replace("{{val(null)}}",seriesName)}return dataset.getCustomizedVal(chartObj,pattern,curSerpos,subseriespos,curItempos,d,"tooltip",clr,NULL,subseriesLength&&subseriesLength>1?subseriesLength:NULL)},removeIndices=[];return meta_tooltip.forEach(function(pattern,patternIndex){var hasRepeatPattern=(isArray(pattern)?pattern:[pattern]).some(function(cur){return"string"==typeof cur&&(-1!=cur.indexOf("{{val("+repeatIndex+")}}")||-1!=cur.indexOf("{{per("+repeatIndex+")}}"))});if(isArray(pattern)||hasRepeatPattern){i%=chartObj.seriesdata.length;var curKey=sharedKeys[i];if(hasRepeatPattern&&i++,isUndefined(curKey))return void removeIndices.push(patternIndex);var curSerpos=pInt(curKey),curItempos=pInt(tooltipSharedInfo.get(curKey)),copy_y_pattern=y_pattern,clr=color;if(isArray(clr)){var dataPoint=dataset.getDataPoint(chartObj,null,curSerpos,subseriespos,curItempos,d);clr=getRawColor(chartObj,hasMultiColoring?curItempos:curSerpos,dataPoint,curSerpos)}isArray(pattern)?pattern.forEach(function(cur,j){pattern[j]=updatePattern(pattern[j],curSerpos,subseriespos,curItempos,clr,copy_y_pattern)}):meta_tooltip[patternIndex]=updatePattern(meta_tooltip[patternIndex],curSerpos,subseriespos,curItempos,clr,copy_y_pattern)}else{defined(curKey=sharedKeys[0])?(curSerpos=pInt(curKey),curItempos=pInt(tooltipSharedInfo.get(curKey))):(curSerpos=seriesindex,curItempos=itempos),meta_tooltip[patternIndex]=dataset.getCustomizedVal(chartObj,pattern,curSerpos,subseriespos,curItempos,d,"tooltip",color,NULL)}}),meta_tooltip=meta_tooltip.filter(function(d,i){return-1==removeIndices.indexOf(i)}),tooltip_content.getContentTemplate(chartObj,meta_tooltip)}function positionTween(start,end){return function(d,i){var interpolate=d3$1.interpolateRound(parseInt(start),parseInt(end));return function(t){return interpolate(t)+"px"}}}function checkMultiColoring(chartName){var multiColoring=/(bar|scatter|bubble$|bullet|gantt|wordcloud|waterfall)/.test(chartName)&&isMultiColoring(systemConf.chart.plot.plotoptions[chartName],chartObj),defaultMultiColoring=/(^pie|funnel|pyramid)/.test(chartName);return multiColoring||defaultMultiColoring}return tooltip.initialize=function(){var fontSize=getFontSizeByHierarchy(tooltip_data,chartObj),defaultLineHeight=+fontSize+.35*+fontSize,userdataCanvasFontColor=null!=chartObj.userdata.canvas?chartObj.userdata.canvas.fontColor:null,borderRadius_px=shorthand_px(borderRadius),filterEffect=null;!(!1===tooltip_data.useChartEffect)&&chartObj.filterEffectsID&&(filterEffect="url(#"+chartObj.filterEffectsID+")"),element.styles({width:"auto","box-shadow":tooltip_data.shadow,opacity:tooltip_data.opacity,"z-index":tooltip_data.zindex,"border-radius":borderRadius_px,"border-width":shorthand_px(borderWidth),"border-style":borderStyle,"-webkit-transform-style":"preserve-3d","-moz-transform-style":"preserve-3d","-ms-transform-style":"preserve-3d","-o-transform-style":"preserve-3d","transform-style":"preserve-3d","pointer-events":tooltip_data.pointerEvents,filter:filterEffect}),appendEle(element,"div",tooltip_data.borderTop?[tooltip_data.borderTop]:[],".","class","borderTop").styles({height:tooltip_data.borderTop+"px","border-radius":borderRadius_px,"border-bottom-left-radius":"1px","border-bottom-right-radius":"1px"}),(contentBox=appendEle(element,"div",[1],"#","id","tooltipcontent")).styles({"box-sizing":"relative"===tooltipPosition?null:"border-box","max-width":"relative"===tooltipPosition?maxWidth+"px":null,"min-width":"relative"===tooltipPosition?minWidth+"px":null,"line-height":(tooltip_data.lineHeight||defaultLineHeight)+"px","word-wrap":"break-word","white-space":"normal","overflow-y":"auto",padding:shorthand_px(padding)}),applyFont(contentBox,[{fontColor:null==tooltip_data.fontColor&&null==userdataCanvasFontColor?"white":tooltip_data.fontColor||userdataCanvasFontColor},tooltip_data,chartObj.systemConf.canvas,$ZCG],!0),(arrowbefore=appendEle(element,"div",hookEnabled?[1]:[],"#","id","zctooltipbefore")).styles({"margin-left":-(hookHeight+2*hookBorderWidth)+"px",border:hookHeight+2*hookBorderWidth+"px solid transparent"}),(arrowafter=appendEle(element,"div",hookEnabled?[1]:[],"#","id","zctooltipafter")).styles({"margin-left":-hookHeight+"px",border:hookHeight+"px solid transparent"}),(arrowBeforeNAfter=element.selectAll("div#zctooltipbefore,div#zctooltipafter")).styles({"border-color":TRANSPARENT,"border-top-color":"white",position:"absolute",top:"100%",left:"50%",width:0,height:0,content:" "})},tooltip.show=function(chartObj,position,content,useDefault,defaultArgs){defined(defaultArgs)||(defaultArgs={});var hasMultiColoring,color=defaultArgs.color,svgFillFunc=defaultArgs.svgFillFunc,seriesindex=defaultArgs.seriesindex,subseriespos=defaultArgs.subseriespos,subseriesLength=defaultArgs.subseriesLength,itempos=defaultArgs.itempos,backgroundColor=defaultArgs.backgroundColor||tooltip_data.backgroundColor,borderColor=defaultArgs.borderColor||tooltip_data.borderColor,tooltipSharedInfo=defaultArgs.tooltipSharedInfo,tooltipShared=defaultArgs.tooltipShared,cType=null!=seriesindex&&chartObj.chartTypes[seriesindex].name||defaultArgs.chartType&&defaultArgs.chartType.name;((useDefault=null==content&&!0===useDefault)||defaultArgs.inheritColors)&&(hasMultiColoring=checkMultiColoring(cType));var clr=color;if(useDefault||defaultArgs.inheritColors){var idx=hasMultiColoring?itempos:seriesindex,dataPoint=dataset.getDataPoint(chartObj,null,seriesindex,subseriespos,itempos,defaultArgs.d);clr=getRawColor(chartObj,idx,dataPoint,seriesindex)}else isArray(clr)&&(clr=clr[seriesindex%clr.length]);clr=tooltipShared?"black":clr,borderColor=null!=borderColor?borderColor:clr,backgroundColor=null!=backgroundColor&&""!=backgroundColor?backgroundColor:clr,element.styles({visibility:"visible","background-color":backgroundColor,"border-color":borderColor});var toUserInfo,temp,tooltipcontent="",headerContent="",footerContent="",contentBoxNode=contentBox.node();useDefault&&null!=headerContentFunc&&(headerContent=invokeFunction(headerContentFunc,d3$1.event,toUserInfo=getInfoToUser(),chartObj)),useDefault?tooltip_data.content?tooltipcontent+=invokeFunction(tooltip_data.content,d3$1.event,toUserInfo=toUserInfo||getInfoToUser(),chartObj):tooltipcontent+=tooltipShared?getTooltipSharedContent(seriesindex,subseriespos,itempos,defaultArgs.d,tooltipSharedInfo,color,hasMultiColoring,subseriesLength):getDefaultContent(seriesindex,subseriespos,itempos,clr,defaultArgs.d):tooltipcontent+=content,useDefault&&null!=footerContentFunc&&(footerContent=invokeFunction(footerContentFunc,d3$1.event,toUserInfo=toUserInfo||getInfoToUser(),chartObj)),contentBox.html(tooltipcontent),isHTMLElement(headerContent)||((temp=document.createElement("div")).innerHTML=headerContent,headerContent=temp),isHTMLElement(footerContent)||((temp=document.createElement("div")).innerHTML=footerContent,footerContent=temp),contentBoxNode.insertBefore(headerContent,contentBoxNode.firstChild),contentBoxNode.appendChild(footerContent);var coordinate,patternEle,base64,xml,elementNode=element.node();elementNode.offsetWidth,elementNode.offsetHeight;if(crosshair_data.type!=NONE&&chartObj.isAxisCategory&&function(chartObj,x,y,data){chartObj.staticPaneSVG.selectAll("g.crosshair").style("visibility","visible");var type=data.type;"x"!=type&&"xy"!=type||drawCrosshairLine(chartObj,x,y,data,"x");"y"!=type&&"xy"!=type||drawCrosshairLine(chartObj,x,y,data,"y")}(chartObj,position.actLeft||position.left,position.actTop||position.top,crosshair_data),element.interrupt().transition(),element.transition().delay(0),"relative"===tooltipPosition){var curx=parseFloat(elementNode.style.left),cury=parseFloat(elementNode.style.top);coordinate=$ZC_TOOLTIP_POSITION.relative(position,element,chartObj,hookHeight,mathAbs(dist),isWithinChart,hookBorderWidth,parsedBorderRadius,maxWidth,maxHeight),hookPosition=coordinate.hookPosition,curx&&!isNaN(curx)&&cury&&!isNaN(cury)||element.styles({left:coordinate.x+"px",top:coordinate.y+"px"}),curx=!curx||isNaN(curx)?coordinate.x:(2*curx+coordinate.x)/3,cury=!cury||isNaN(cury)?coordinate.y:(cury+coordinate.y)/2,element.transition().duration(100).ease(d3_ease_linear).styleTween("left",positionTween(curx,coordinate.x)).styleTween("top",positionTween(cury,coordinate.y))}else"fixed"===tooltipPosition?(coordinate=$ZC_TOOLTIP_POSITION.fixed(position,element,chartObj),element.styles({left:coordinate.x+"px",top:coordinate.y+"px"})):(coordinate=$ZC_TOOLTIP_POSITION.block(position,element,chartObj),element.styles({left:coordinate.x+"px",top:coordinate.y+"px"}).attr("align",coordinate.align));if(contentBox.styles({width:coordinate.w,height:coordinate.h,"max-width":coordinate.maxw,"max-height":coordinate.maxh}),tooltip_data.borderTop){var svgFillEle=svgFillFunc?svgFillFunc(hasMultiColoring?itempos:seriesindex,null,null,clr,null,null,{width:mathMin(+coordinate.w,+coordinate.maxw)},!0):borderColor,svgFillUrl="object"==typeof svgFillEle?"url("+(patternEle=svgFillEle,base64=!0,xml="<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='"+patternEle.w+"' height='"+patternEle.h+"'>"+(new XMLSerializer).serializeToString(patternEle.node.node())+"<path d='M-5,-5 L5,-5 L5,5 L-5,5 Z' transform='translate("+patternEle.w/2+","+patternEle.h/2+")' style='fill: url(#"+patternEle.id+")'></path> </svg>",{url:$Browser.FIREFOX||base64?"data:image/svg+xml;base64,"+btoa(xml):"data:image/svg+xml;utf8,"+xml,width:patternEle.w,height:patternEle.h}).url+")":svgFillEle;element.selectAll("div.borderTop").styles({background:svgFillUrl})}if(tooltipShared)arrowBeforeNAfter.style("display",NONE);else{var arrowTransform="rotate("+hookPosition.rotation+"deg)";arrowBeforeNAfter.styles({display:"",left:hookPosition.left+"%",top:hookPosition.top+"%",transform:arrowTransform,"-webkit-transform":arrowTransform,"-ms-transform":arrowTransform,"transform-origin":"50% 0%","-webkit-transform-origin":"50% 0%","-ms-transform-origin":"50% 0%"}),arrowbefore.style("border-top-color",borderColor),arrowafter.styles({"border-top-color":backgroundColor,opacity:1})}function getInfoToUser(){if(tooltipShared)return tooltipSharedInfo.keys().map(function(d){var curSerpos=pInt(d),curItempos=pInt(tooltipSharedInfo.get(d)),clridx=dataset.getColumnIdx("clr"),yaxiscolumnorder=chartObj.seriesdata[curSerpos].yaxiscolumnorder||[0,0],validx=chartObj.ismultiy||null==clridx?dataset.getColumnIdx("y",yaxiscolumnorder):clridx,dp=dataset.getDataPoint(chartObj,validx,curSerpos,subseriespos,curItempos);return{actData:dp,metaInfo:dataset.getMetaInfoObj(chartObj,dp,curSerpos)}});var dp=dataset.getDataPoint(chartObj,null,seriesindex,subseriespos,itempos,defaultArgs.d);return{actData:dp,metaInfo:chartObj.dataset.getMetaInfoObj(chartObj,dp,seriesindex),seriesIndex:seriesindex,subseriesIndex:subseriespos,itemIndex:itempos}}},tooltip.hide=function(tooltipele){(tooltipele=null==tooltipele?this.element:tooltipele).style("visibility","hidden"),chartObj.systemConf.tooltip.crosshair.type!=NONE&&chartObj.staticPaneSVG.selectAll("g.crosshair").style("visibility","hidden")},tooltip.destroy=function(){this.element.remove()},tooltip.getTooltipContent=function(){return getDefaultContent.apply(null,arguments)},tooltip},events.zoom=function(chartObj,axisrotated,systemconf){var startPt,endPt,zmarea,x,y,rectBound,mdwn=!1,zmevent={},svg=chartObj.svg,seriesdata=systemconf.seriesdata.chartdata,zmConf=systemconf.chart.zoom,plotarea=chartObj.plotarea,zmareaConf=zmConf.selectionArea,zmbtnConf=zmConf.resetButton,btnBorderConf=zmbtnConf.border,btnShadowConf=zmbtnConf.shadow,btnLabelConf=zmbtnConf.label,zmtype=zmConf.type,showBtnBorder=btnBorderConf.show,btnRadius=showBtnBorder?btnBorderConf.radius:0,filterID=null;btnShadowConf.show&&(filterID=(filterID=effects.get(effects.svg_filters,"dropShadow",btnShadowConf,{chartObj:chartObj}))?"url("+chartObj.defsLocation+"#"+filterID+")":null);var callbacks=zmConf.events||{};function updateZoom(type,idx,domain,datatype){systemconf.chart.axes[type+"axis"].disableBaseValue=!0;var z=zmConf[type]={};datatype==ORDINAL_DATATYPE?z.categories=domain:(z.minRange=domain[0],z.maxRange=domain[1]),chartObj.updateScale(seriesdata[idx],type,domain)}function getVal(val,defaultVal){return val=null!=(val=invokeFunction(val,chartObj,rectBound))?val:defaultVal}function getCoordinate(mouse){return{x:mathMin(mathMax(mouse[0]-plotarea.left,0),plotarea.width),y:mathMin(mathMax(mouse[1]-plotarea.top,0),plotarea.height)}}return zmevent.zmInit=function(update){plotarea=chartObj.plotarea,(zmarea=appendEle(svg.selectAll(".seriesholder"),"rect",[1],".","class","zmarea")).styles({fill:zmareaConf.fillColor||"grey","fill-opacity":zmareaConf.fillOpacity});var zoomBtn=appendEle(chartObj.staticPaneSVG.select(".eventgroup"),"rect",[1],".","class","zmbtn"),dashStyle=getDashArray(btnBorderConf.style,btnBorderConf.size);zoomBtn.attrs({rx:btnRadius,ry:btnRadius,filter:filterID}).styles({fill:zmbtnConf.fillColor,"fill-opacity":zmbtnConf.fillOpacity,stroke:btnBorderConf.color,"stroke-width":showBtnBorder?btnBorderConf.size:0,"stroke-dasharray":dashStyle,"stroke-linecap":getLineCap(btnBorderConf.lineCap,dashStyle),cursor:POINTER}),attachevents(zoomBtn,{click:zmevent.reset},{tap:zmevent.reset});var zoomBtnText=appendEle(chartObj.staticPaneSVG.select(".eventgroup"),"text",[1],".","class","zmbtn");zoomBtnText.attr("dy","0.9em").style("pointer-events",NONE).text(btnLabelConf.text),applyFont(zoomBtnText,[btnLabelConf,systemconf.chart,systemconf.canvas,{fontColor:"white",fontSize:11},$ZCG]);var textBound=zoomBtnText.node().getBBox();zoomBtn.attrs({width:textBound.width+btnLabelConf.marginLeft+btnLabelConf.marginRight,height:textBound.height+btnLabelConf.marginTop+btnLabelConf.marginBottom}),rectBound=zoomBtn.node().getBBox(),x=getVal(zmbtnConf.x,plotarea.left+plotarea.width-rectBound.width),y=getVal(zmbtnConf.y,10),zoomBtn.attrs({x:x,y:y}),zoomBtnText.attrs({x:x+btnLabelConf.marginLeft,y:y+btnLabelConf.marginTop}),update||(zmarea.style("visibility","hidden"),zoomBtn.style("visibility","hidden"),zoomBtnText.style("visibility","hidden"))},zmevent.zoomInitialized=!1,zmevent.zmStart=function(mouse){zmtype=zmConf.type,mdwn=!0,startPt=getCoordinate(mouse);var prop={};zmarea.style("visibility","visible");var horiZoom=zmtype.indexOf("x")>-1&&!axisrotated||zmtype.indexOf("y")>-1&&axisrotated,verZoom=zmtype.indexOf("y")>-1&&!axisrotated||zmtype.indexOf("x")>-1&&axisrotated;horiZoom?prop.x=startPt.x:prop.width=plotarea.width,verZoom?prop.y=startPt.y:prop.height=plotarea.height,zmarea.attrs(prop),zmevent.zoomInitialized=!0,invokeFunction(!0,callbacks.zoomstart,startPt,{x:zmConf.x,y:zmConf.y},chartObj)},zmevent.zmMove=function(mouse){if(zmtype=zmConf.type,mdwn){var point=getCoordinate(mouse),prop={},horiZoom=zmtype.indexOf("x")>-1&&!axisrotated||zmtype.indexOf("y")>-1&&axisrotated,verZoom=zmtype.indexOf("y")>-1&&!axisrotated||zmtype.indexOf("x")>-1&&axisrotated;isTouchEvent(d3$1.event)&&(startPt=getCoordinate(d3_mousePoint(chartObj.eventHandler.trackerElement.node(),0)),point=getCoordinate(d3_mousePoint(chartObj.eventHandler.trackerElement.node(),1))),endPt=point,horiZoom&&(prop.x=(point.x<startPt.x?point:startPt).x,prop.width=mathAbs(point.x-startPt.x)),verZoom&&(prop.y=(point.y<startPt.y?point:startPt).y,prop.height=mathAbs(point.y-startPt.y)),zmarea.attrs(prop)}invokeFunction(!0,callbacks.zoom,point,{x:zmConf.x,y:zmConf.y},chartObj)},zmevent.zmEnd=function(mouse){return!!zmevent.zoomInitialized&&(isTouchEvent(d3$1.event)||(endPt=getCoordinate(mouse)),zmarea.attrs({height:0,width:0}).style("visibility","hidden"),mdwn=!1,zmevent.zoomInitialized=!1,{startPt:startPt,endPt:endPt})},zmevent.zoomed=function(zmdata,seriesidx,xdomain,ydomain){zmtype=zmConf.type;var rangeDefined=null!=seriesidx,xtype=axisrotated?"y":"x",ytype=axisrotated?"x":"y",zoomedX=zmtype.indexOf("x")>-1&&(rangeDefined||mathAbs(zmdata.startPt[xtype]-zmdata.endPt[xtype])>2),zoomedY=zmtype.indexOf("y")>-1&&(rangeDefined||mathAbs(zmdata.startPt[ytype]-zmdata.endPt[ytype])>2);if(zmtype.indexOf("x")>-1&&(rangeDefined?xdomain[0]!=xdomain[1]:zmdata.startPt[xtype]!=zmdata.endPt[xtype])||zmtype.indexOf("y")>-1&&(rangeDefined?ydomain[0]!=ydomain[1]:zmdata.startPt[ytype]!=zmdata.endPt[ytype])){if(stateChangeListener(chartObj,systemconf.chart.axes.events,0,"init"),zoomedX){var datatype_x=chartObj.dataset.getDataType("x");if(!rangeDefined){var xscale=chartObj.axes.x.scale,axisReversed_x=systemconf.chart.axes.xaxis.reversed,x1=scale$1.invert(datatype_x,zmdata.startPt,xscale,axisrotated,"x",axisReversed_x),x2=scale$1.invert(datatype_x,zmdata.endPt,xscale,axisrotated,"x",axisReversed_x);if(x1>x2){var temp=x1;x1=x2,x2=temp}xdomain=datatype_x==ORDINAL_DATATYPE?xscale.domain().slice(x1,x2+1,0):[x1,x2]}updateZoom("x",rangeDefined?seriesidx:0,xdomain,datatype_x)}if(zoomedY)for(var i=rangeDefined?seriesidx:0,len=rangeDefined?seriesidx+1:chartObj.axes.y.groups.length;i<len;i++){var datatype_y=chartObj.dataset.getDataType("y",i);if(!rangeDefined){var yscale=chartObj.axes.y.groups[i].scale,axisReversed_y=systemconf.chart.axes.yaxis[i].reversed,y1=scale$1.invert(datatype_y,zmdata.startPt,yscale,axisrotated,"y",axisReversed_y),y2=scale$1.invert(datatype_y,zmdata.endPt,yscale,axisrotated,"y",axisReversed_y);y1>y2&&(y1=y1+y2-(y2=y1)),ydomain=datatype_y==ORDINAL_DATATYPE?yscale.domain().slice(y1,y2+1,0):[y1,y2]}updateZoom("y",i,ydomain,datatype_y)}stateChangeListener(chartObj,systemconf.chart.axes.events,0,"onreload"),chartObj.updatePlotareaProp(),chartObj.plot.renderer.draw(!0),chartObj.eventHandler.updateParams(chartObj),zmevent.clipMarker||(chartObj.drawPlotareaClippath(),zmevent.clipMarker=!0),chartObj.drawThreshold(!0),chartObj.staticPaneSVG.selectAll(".zmbtn").style("visibility","visible"),invokeFunction(!0,callbacks.zoomend,endPt,{x:zmConf.x,y:zmConf.y},chartObj)}},zmevent.reset=function(){if(delete zmConf.x,delete zmConf.y,stateChangeListener(chartObj,systemconf.chart.axes.events,0,"init"),(zmtype=zmConf.type).indexOf("x")>-1&&(systemconf.chart.axes.xaxis.disableBaseValue=!1,chartObj.updateScale(seriesdata[0],"x",null)),zmtype.indexOf("y")>-1)for(var i=0;i<chartObj.axes.y.groups.length;i++)systemconf.chart.axes.yaxis.disableBaseValue=!1,chartObj.updateScale(seriesdata[i],"y",null);stateChangeListener(chartObj,systemconf.chart.axes.events,0,"onreload"),chartObj.updatePlotareaProp(),chartObj.plot.renderer.draw(!0),chartObj.eventHandler.updateParams(chartObj),chartObj.drawThreshold(!0);var rendered=setInterval(function(){chartObj.chartRendered&&(chartObj.drawPlotareaClippath(),zmevent.clipMarker=!1,clearInterval(rendered))},10);chartObj.staticPaneSVG.selectAll(".zmbtn").style("visibility","hidden"),invokeFunction(callbacks.reset,chartObj)},zmevent},annotation.draw=function(chart,notesArray){var notes=chart.systemConf.notes;if(defined(notes)&&!0===notes.enabled){var isPolar=chart.dataObject.isPolarAxisCategory;if(pick(notes.chartValues,[]).forEach(function(d){annotation.addNotes(chart,{coordinate:[d.x,d.y],conf:d})}),chart.isAxisCategory||isPolar||chart.isGeoMap)for(var i=0,len=chart.seriesdata.length;i<len;i++){var renderer=chart.renderer[i];"image"===chart.plot.renderer.mode&&renderer_helpers.setRendererProp(chart,renderer,chart.seriesdata,i,i,{image:!0});var xy,categories,rp=chart.rendererConf[i].params,xscale=rp.xscale,yscale=rp.yscale,stacked=rp.stacked,index=rp.datasetIndex,axisrotated=rp.axisrotated,yaxiscolumnorder=rp.yaxiscolumnorder,cType=chart.chartTypes[index].value;if(chart.isGeoMap||(categories=chart.dataset.getDataType("x")==ORDINAL_DATATYPE?xscale.domain():chart.dataObject.getCategories("x")),isBarChartType(cType)){var commonOption=getBarCommonOption(chart.rendererConf[index],index);xy=function(dt,i,j){return[chart.dataObject.getTransRectValue("x",dt,i,j,commonOption),chart.dataObject.getTransRectValue("y",dt,i,j,commonOption)]}}else xy=function(dt){var dxy=isPolar?[chart.plotarea_approx.x,chart.plotarea_approx.y]:[0,0];return[chart.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,dt,"x")+dxy[0],chart.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,dt,"y")+dxy[1]]};notesArray=annotation.preprocessAnnotations(chart.seriesdata,index,xy,notesArray,chart,rp,categories)}notesArray.forEach(function(d){annotation.addNotes(chart,d)})}return notesArray=[]},annotation.addNotes=function(chart,args){var maxWidth,maxHeight,overflowX,overflowY,noteConf=chart.systemConf.notes,plotarea=chart.plotarea,canvasarea=chart.canvasarea,chartWidth=canvasarea.width,chartHeight=canvasarea.height,coordinate=args.coordinate,basedOn=args.basedOn||"chart",annotationData=args.data,val=args.conf||{},disabled=args.disabled,displayMode=pick(val.type,noteConf.type,"stickyNote"),baseBoundary="block"===basedOn||"plot"===basedOn?plotarea:canvasarea,overflow=val.overflow||noteConf.overflow||"scroll";"block"===basedOn&&(overflowX="scroll"===overflow?"auto":"hidden",maxWidth=perToPx(noteConf.maxWidth||"100%",baseBoundary.width)),"block"===basedOn&&(overflowY="scroll"===overflow?"auto":"hidden",maxHeight=perToPx(noteConf.maxHeight||"10%",baseBoundary.height));var id="plot"==basedOn?jsonStringify(annotationData):"block"==basedOn?generateIdByPropValue(val,""):jsonStringify(args.conf);id="plot"!=basedOn&&null!=val.id?val.id:basedOn+id.replace(/[`~!@#$%^&*( )_|+\-=?;:'",.<>\{\}\[\]\\\/]/gi,""),val.id=id;var container=appendEle(chart.notes,"div",[1],"#","id",basedOn);container.styles({width:"0",height:"0"});var annotationNode=appendEle(container,"div",[args],"#","id",id);annotationNode.styles({display:disabled?NONE:null,position:"absolute",left:"0",top:"0","overflow-x":overflowX,"overflow-y":overflowY,"max-width":defined(maxWidth)?maxWidth+PX:NULL,"max-height":defined(maxHeight)?maxHeight+PX:NULL});var annotationRenderer=annotation["stickyNote"===displayMode?"stickyNote":"customNote"](),conf=mergeJSON(noteConf.options[displayMode],args.conf||{},!0);if(annotationRenderer.chartObj(chart).conf(conf),applyFont(annotationNode,[conf,chart.systemConf.canvas,$ZCG],!0),annotationNode.call(annotationRenderer),!disabled){var ele=annotationNode.node(),BW="stickyNote"===displayMode?mathMax(parseFloat(annotationNode.selectAll(".head").style("width")),parseFloat(annotationNode.selectAll(".body").style("width"))):0,BH="stickyNote"===displayMode?parseFloat(annotationNode.selectAll(".head").style("height"))+parseFloat(annotationNode.selectAll(".body").style("height")):0;coordinate=coordinate.map(function(d,i){var position="plot"===basedOn?d+chart.plotarea[0==i?LEFT_ALIGN:TOP_ALIGN]:invokeFunction(d,chart,val,ele);return isNaN(+position)?perToPx(d,0==i?chartWidth:chartHeight,0):position}),coordinate=invokeFunction("plot"===basedOn||"block"===basedOn?val.transform:null,chart,val,ele,coordinate)||coordinate,annotationRenderer.coordinate(coordinate),coordinate=getCoordinateWithinBound(coordinate[0],coordinate[1],BW,BH,chartWidth,chartHeight),annotationNode.styles({left:coordinate[0]+PX,top:coordinate[1]+PX});var dt="plot"==basedOn?annotationData:id;return-1==getAnnotationIndex(noteConf,dt,basedOn)&&saveAnnotation(noteConf,dt,"",args.coordinate,basedOn),annotationNode}},annotation.preprocessAnnotations=function(seriesdata,idx,coordinate,notesArray,chartObj,rp,categories){if(!chartObj.destroying){var notes=chartObj.systemConf.notes;if(!defined(notes)||!defined(notes.enabled)||!1===notes.enabled)return notesArray;var notesConf=notes.plotValues,isAxisCat=chartObj.isAxisCategory,isNonAxisMultiSeriesCat=chartObj.isNonAxisMultiSeriesCategory,dataset=chartObj.dataset,stacked=rp.stacked,plotarea=chartObj.plotarea,yaxiscolumnorder=rp.yaxiscolumnorder,curSeries=seriesdata[idx],isWithin=geometryUtils.pointInRectangle,curData=chartObj.dataObject.isHierarchy?curSeries:curSeries.data,serName=(isAxisCat||isNonAxisMultiSeriesCat)&&seriesdata.length>1?curSeries.seriesname:null,cType=chartObj.chartTypes[idx].name,seriesnames=chartObj.dataObject.seriesNames||(chartObj.dataObject.seriesNames=chartObj.seriesdata.map(function(d){return d.seriesname}));return(isAxisCat&&seriesdata.length>1?notesConf.filter(function(d){var s=d.data[d.data.length-1];return serName==s||-1==seriesnames.indexOf(s)}):notesConf).forEach(function(curNote,i){for(var found=!1,nData=curNote.data,subseries=0,slen=isAxisCat?curData.length:1;subseries<slen&&!found;subseries++)for(var j=0,len=curData[subseries].length;j<len&&!found;j++){var data=generateDataForAnnotation(dt=curData[subseries][j],serName);if(jsonStringify(data)==jsonStringify(nData))found=!0,pushNotes(pos=coordinate(dt,subseries,j),data,curNote,!(!isAxisCat||isWithin(pos,plotarea))||(isAxisCat||isNonAxisMultiSeriesCat?curSeries.disabled:dt.disabled)||!isWithinColorRange(dataset.getClr(dt),chartObj))}if(isAxisCat&&!found&&("bar"!==cType||-1!=categories.indexOf(dataset.getX(nData)))){found=!0;var pos,dt=generateDataForAnnotation(nData);stacked&&(dt.y=dataset.getY(nData,yaxiscolumnorder),dt.y0=0),pushNotes(pos=coordinate(dt,0,j),dt,curNote,!(!isAxisCat||isWithin(pos,plotarea))||!(isAxisCat&&seriesdata.length>1&&-1==seriesnames.indexOf(nData[nData.length-1]))&&curSeries.disabled)}if(!found&&"sunburst"===cType){var parentData=[serName,curSeries.value];jsonStringify(parentData)===jsonStringify(nData)&&pushNotes(coordinate(curSeries),parentData,curNote,curSeries.disabled)}}),notesArray}function pushNotes(coordinate,data,conf,disabled){notesArray.push({coordinate:coordinate,data:data,conf:conf,disabled:disabled,basedOn:"plot"})}},annotation.addBlockAnnotations=function(chart){var notes=chart.systemConf.notes;if(defined(notes)&&!1!==notes.enabled){setDefaultOptions("notes",chart.systemConf,chart.globalProp);var drawnAtBottom,drawnAtTop,blockAnnotations=(notes=chart.systemConf.notes).blockValues,plotarea=chart.plotarea,maxWidth=perToPx(notes.maxWidth||"100%",plotarea.width),maxHeight=perToPx(notes.maxHeight||"10%",plotarea.height),PW=plotarea.width,PH=plotarea.height,PL=plotarea.left,PT=plotarea.top,PB=plotarea.bottom;blockAnnotations.forEach(function(d){var hAlign=d.hAlign,vAlign=d.vAlign,overflow=d.overflow||notes.overflow||"scroll",isRight=hAlign===RIGHT_ALIGN,isLeft=hAlign===LEFT_ALIGN,isTop=vAlign===TOP_ALIGN,isBottom=vAlign===BOTTOM_ALIGN;if(!(drawnAtTop&&isTop||drawnAtBottom&&isBottom)){var note=annotation.addNotes(chart,{coordinate:[function(chart,val,ele){var bound=ele.getBoundingClientRect(),x=isRight?PL+PW:isLeft?PL:PL+PW/2,dx=isRight?bound.width:isLeft?0:bound.width/2;return mathMax(x-dx,0)},function(chart,val,ele){var bound=ele.getBoundingClientRect();return(isTop?PT:PT+PH)-(isTop?0:bound.height)}],conf:d,basedOn:"block"}),noteEle=note.node(),bound=noteEle.getBoundingClientRect(),bHei=bound.height;bound.width;"fire"===overflow&&(noteEle.scrollHeight>maxHeight||noteEle.scrollWidth>maxWidth)?note.remove():(plotarea.height=PH-bHei,isTop?plotarea.top=PT+bHei:isBottom&&(plotarea.bottom=PB+bHei)),drawnAtTop=drawnAtTop||isTop,drawnAtBottom=drawnAtBottom||isBottom}})}},annotation.stickyNote=function(){var chartObj,conf,coordinate;function annotationComp(selection){selection.each(function(args){var container=d3_select(this),noteConf=chartObj.systemConf.notes,chartWidth=chartObj.canvasarea.width,chartHeight=chartObj.canvasarea.height,notesWrap=chartObj.notes,basedOn=args.basedOn||"chart",xy=(args.data,args.coordinate),xInPercent="string"==typeof xy[0]&&xy[0].indexOf("%")>-1,yInPercent="string"==typeof xy[1]&&xy[1].indexOf("%")>-1,text=conf.text,colorIndex=notesWrap.selectAll(".head").size(),bgColor=conf.color,open="open"===conf.mode,bodyWidth=validateNullVal(conf.bodyWidth,100),bodyHeight=validateNullVal(conf.bodyHeight,100),headWidth=validateNullVal(conf.headWidth,15),headHeight=validateNullVal(conf.headHeight,15),toggle=open?0:1;bgColor=bgColor instanceof Array?bgColor[colorIndex%bgColor.length]:bgColor;d3_drag().on("drag",function(d,i){if(!d3.event.defaultPrevented){var parentEle=d3_select(this.parentNode),x=parseFloat(parentEle.style("left"))+d3.event.x,y=parseFloat(parentEle.style("top"))+d3.event.y,w=mathMax(toggle%2!=0?0:bodyWidth,headWidth),h=(toggle%2!=0?0:bodyHeight)+headHeight;x=x>chartWidth-w?chartWidth-w:x<0?0:x,y=y>chartHeight-h?chartHeight-h:y<0?0:y,coordinate[0]=x,coordinate[1]=y;var leftVal=x+PX,topVal=y+PX;if(parentEle.styles({left:leftVal,top:topVal}),"plot"!=basedOn){var iden=parentEle.attr("id"),index=getAnnotationIndex(noteConf,iden,basedOn);-1!=index&&(noteConf.chartValues[index].x=xInPercent?x/chartWidth*100+"%":x,noteConf.chartValues[index].y=yInPercent?y/chartHeight*100+"%":y)}}});container.attr("class","group").styles({width:0,height:0,"z-index":2});var textarea=appendEle(notesWrap,"textarea",[1]);textarea.styles({width:bodyWidth+PX,height:bodyHeight+PX,position:"absolute","border-color":TRANSPARENT,"border-radius":(conf.bodyBorderRadius||0)+PX,"background-color":TRANSPARENT,overflow:"hidden",display:NONE,resize:NONE,"z-index":2,outline:NONE}).on("blur",function(d,i){var baseEle=textarea.attr("eleID");if(textarea.style("display",NONE),null!=baseEle){var parentEle=d3_select("#"+baseEle);parentEle.selectAll(".body").style("color",null),parentEle.style("z-index",2)}}).on("input",function(){var curEle=d3_select(this);if(curEle.style("display")!==NONE){var parentEle=d3_select("#"+curEle.attr("eleID")),noteEle=parentEle.selectAll(".body"),iden=parentEle.attr("id"),txt=textarea.node().value,datum=parentEle.datum(),basedOn=datum.basedOn||"chart",annotationData=datum.data;noteEle.text(txt);var dt="plot"==basedOn?annotationData:iden,index=getAnnotationIndex(noteConf,dt,basedOn);-1==index?saveAnnotation(noteConf,dt,txt,xy,basedOn):noteConf[basedOn+"Values"][index].text=txt}}).text(text);var head=appendEle(container,"div",[1],".","class","head");head.attr("customColor")||head.style("background-color",bgColor).attr("customColor",bgColor),head.styles({width:headWidth+PX,height:headHeight+PX,border:conf.border,"border-radius":(conf.headBorderRadius||0)+PX,"z-index":"auto"}),attachevents(head,{click:click=function(d,i){if(!d3.event.defaultPrevented){var close=toggle%2==0,bodyEle=d3_select(this.nextSibling),parentEle=d3_select(this.parentNode);if(textarea.on("blur")(),close)parentEle.transition().delay(250).duration(0).styles({left:coordinate[0]+PX,top:coordinate[1]+PX});else{var xy=getCoordinateWithinBound(parseFloat(parentEle.style("left")),parseFloat(parentEle.style("top")),bodyWidth,headHeight+bodyHeight,chartWidth,chartHeight);parentEle.styles({left:xy[0]+PX,top:xy[1]+PX})}bodyEle.style("color",null).transition().ease(d3_ease_linear).styles({width:close?0+PX:bodyWidth+PX,height:close?0+PX:bodyHeight+PX,display:close?null:"block"}),bodyEle.transition().delay(250).style("display",close?NONE:null),notesWrap.selectAll(".group").style("z-index",1),parentEle.style("z-index",2),toggle++}}},{tap:click});var click,bodyInitStyles=container.selectAll("div.body").empty()?{"background-color":bgColor}:{},body=appendEle(container,"div",[1],".","class","body");body.styles({width:open?bodyWidth+PX:"0",height:open?bodyHeight+PX:"0",display:open?null:NONE,border:conf.border,overflow:"hidden","box-shadow":conf.shadow,"border-radius":(conf.bodyBorderRadius||0)+PX,"z-index":"auto"}).styles(bodyInitStyles).text(text),attachevents(body,{click:click=function(d,i){var curEle=d3_select(this),parentEle=d3_select(this.parentNode);textarea.on("blur")(),textarea.styles({display:null,left:parentEle.style("left"),top:parseFloat(parentEle.style("top"))+headHeight+PX,color:parentEle.style("color"),"font-size":parentEle.style("font-size"),"font-family":parentEle.style("font-family"),"font-weight":parentEle.style("font-weight"),"font-style":parentEle.style("font-style")}).attr("eleID",parentEle.attr("id")),textarea.node().value=curEle.text(),textarea.node().focus(),curEle.style("color",TRANSPARENT),notesWrap.selectAll(".group").style("z-index",1),parentEle.style("z-index",2),textarea.style("z-index",3)}},{tap:click})})}return annotationComp.chartObj=function(_){return arguments.length?(chartObj=_,annotationComp):chartObj},annotationComp.conf=function(_){return arguments.length?(conf=_,annotationComp):conf},annotationComp.coordinate=function(_){return arguments.length?(coordinate=_,annotationComp):coordinate},annotationComp},annotation.customNote=function(){var conf,coordinate,chartObj;function annotationComp(selection){selection.each(function(args){d3_select(this).html(invokeFunction(conf.htmlEl,chartObj,args.conf))})}return annotationComp.coordinate=function(_){return arguments.length?(coordinate=_,annotationComp):coordinate},annotationComp.conf=function(_){return arguments.length?(conf=_,annotationComp):conf},annotationComp.chartObj=function(_){return arguments.length?(chartObj=_,annotationComp):chartObj},annotationComp},axis.threshold=function(chartObj,update){var threshold={},systemconf=chartObj.systemConf,xaxisdata=systemconf.chart.axes.xaxis,xaxis_userdata=isObjectPropDefined(chartObj.userdata,"chart.axes.xaxis")?chartObj.userdata.chart.axes.xaxis:{};null!=xaxis_userdata.threshold&&null!=xaxis_userdata.threshold.line&&drawThreshold(chartObj.axes.x,xaxisdata.threshold.line,0,update,"x","line",xaxis_userdata.threshold.line),null!=xaxis_userdata.threshold&&null!=xaxis_userdata.threshold.range&&drawThreshold(chartObj.axes.x,xaxisdata.threshold.range,0,update,"x","range",xaxis_userdata.threshold.range);for(var yaxesdata=systemconf.chart.axes.yaxis,yaxes_userdata=isObjectPropDefined(chartObj.userdata,"chart.axes.yaxis")?chartObj.userdata.chart.axes.yaxis:{},i=0;i<chartObj.axes.y.count;i++)null!=yaxes_userdata&&null!=yaxes_userdata[i]&&null!=yaxes_userdata[i].threshold&&null!=yaxes_userdata[i].threshold.line&&drawThreshold(chartObj.axes.y.groups[i],yaxesdata[i].threshold.line,i,update,"y","line",yaxes_userdata[i].threshold.line),null!=yaxes_userdata&&null!=yaxes_userdata[i]&&null!=yaxes_userdata[i].threshold&&null!=yaxes_userdata[i].threshold.range&&drawThreshold(chartObj.axes.y.groups[i],yaxesdata[i].threshold.range,i,update,"y","range",yaxes_userdata[i].threshold.range);function drawThreshold(axisObj,data,index,update,type,category,userdata){var thresholdGroup=(userdata&&userdata.underlay?chartObj.svg:chartObj.staticPaneSVG).selectAll("g.threshold"),axisWrap=chartObj.svg.selectAll("g."+type+"-axis-"+index),visibility=null==axisWrap||axisWrap.empty()||""!=axisWrap.style("visibility")&&"visible"!=axisWrap.style("visibility")?"hidden":"visible",thWrap=appendEle(thresholdGroup,"g",userdata.show&&"visible"==visibility?[data]:[],".","class","threshold"+category+"-"+type+"-axis-"+index);if(null!=axisObj&&data.show){var renderer=update&&null!=axisObj.threshold&&null!=axisObj.threshold[category]?axisObj.threshold[category]:function(axisObj,data,index,category){return axisObj?(axisObj.threshold||(axisObj.threshold={}),axisObj.threshold[category]=data.show?"line"==category?axis.threshold.line():axis.threshold.range():null,axisObj.threshold[category]):null}(axisObj,data,0,category);renderer=function(renderer,axisObj,index,type,category,userdata){var values;return threshold.axisObj=function(_){return arguments.length?(axisObj=_,threshold):axisObj},threshold.thresholdIndex=function(_){return arguments.length?(index=_,threshold):index},threshold.type=function(_){return arguments.length?(type=_,threshold):type},threshold.values=function(_){return arguments.length?(values=_,threshold):values},threshold.chartObj=function(_){return arguments.length?(chartObj=_,threshold):chartObj},threshold.thresholdIndex(index).type(type).values(userdata.values).chartObj(chartObj),"line"==category&&threshold.axisObj(axisObj),renderer.parentObj(threshold),renderer}(renderer,axisObj,index,type,category,userdata),thWrap.call(renderer)}}},axis.threshold.textAlign=function(hAlign,type,plotarea,axesRotated,padding,orient){var x;return padding=padding||0,"left"==hAlign?x=axesRotated?"x"==type?padding:plotarea.height-padding:"left"==orient||"bottom"==orient?"x"==type?plotarea.height-padding:padding:"x"==type?padding:plotarea.width-padding:"center"==hAlign?x=axesRotated?"left"===orient||"bottom"===orient?"x"==type?(plotarea.width+padding)/2:(plotarea.height-padding)/2:"x"==type?(plotarea.width-padding)/2:(plotarea.height+padding)/2:"left"==orient||"bottom"==orient?"x"==type?(plotarea.height-padding)/2:(plotarea.width+padding)/2:"x"==type?(plotarea.height+padding)/2:(plotarea.width-padding)/2:"right"==hAlign&&(x=axesRotated?"x"==type?plotarea.width:0:"left"==orient||"bottom"==orient?"x"==type?0:plotarea.width:"x"==type?plotarea.height:0),x},axis.threshold.line=function(){var index,plotarea,systemconf,chartObj,axesRotated,type,parentObj,axisObj,values;function chart(selection){selection.each(function(data){var container=d3_select(this);chart.update=function(){container.transition().call(chart)},chartObj=parentObj.chartObj(),index=parentObj.thresholdIndex(),type=parentObj.type(),axisObj=parentObj.axisObj(),values=parentObj.values(),plotarea=chartObj.plotarea;var scaleObj=axisObj.scale,range=scaleObj.range();(range=range.slice(0,range.length)).sort(function(a,b){return a-b});var bandwidth=null!=scaleObj.bandwidth?scaleObj.bandwidth()/2:0,label=data.label;label=overrideThresholdFonts(label,isObjectPropDefined(chartObj.userdata,"chart.axes."+type+"axis"+("x"===type?"":"."+index)+".threshold.line.label",!0));var markerInfo=data.marker||{},markerEnabled=pick(markerInfo.enabled,!0);axesRotated=chartObj.axes.rotated;var thval=[],thname=[],thclr=[],labelPadding={x:2,y:2},xAxisLine=(systemconf=chartObj.systemConf).chart.axes.xaxis.axisline,yAxisLine=systemconf.chart.axes.yaxis[index].axisline;defined(xAxisLine)&&xAxisLine.show&&(labelPadding.x+=+xAxisLine.strokeWidth-1),defined(yAxisLine)&&yAxisLine.show&&(labelPadding.y+=+yAxisLine.strokeWidth-1);var formatConf,count=0,hAlign=[],strokeDashArray=[],strokeWidth=[],markerWidth=[],markerBBox=[],markerSize=[],fontSizes=[],fontFamilies=[],datatype=chartObj.dataset.getDataType(type,index),eventDisabled=!1!==getPropVal(data.events,"enabled"),colInfo=chartObj.dataset.getColumn(type,index),columnindex=chartObj.dataset.getColumnIdx(type,index);datatype==TIME_DATATYPE&&(formatConf=getPropVal(colInfo,TIME_DATATYPE)||null),values.map(function(d,i){var d_scale=null!=d&&""!=d?datatype==TIME_DATATYPE?generateDateVal(d,0,formatConf).getTime():d:null;null!=d&&""!==d&&scaleObj(d_scale)+bandwidth>=range[0]&&scaleObj(d_scale)+bandwidth<=range[range.length-1]&&(thval[count]=d_scale,thname[count]=getCustomThresholdText(getPropVal(data,"label.text["+i+"]")||"",values,colInfo,chartObj),thclr[count]=(isArray(data.color)?data.color[i]:data.color)||"black",hAlign[count]=defined(data.label)&&(isArray(data.label.hAlign)?data.label.hAlign[i]:data.label.hAlign)||"center",strokeWidth[count]=(isArray(data.strokeWidth)?data.strokeWidth[i]:data.strokeWidth)||1,strokeDashArray[count]=isArray(data.dashStyle)?data.dashStyle[i]:data.dashStyle,markerWidth[count]=defined(data.marker)&&data.marker.enabled?(isArray(data.marker.strokeWidth)?data.marker.strokeWidth[i]:data.marker.strokeWidth)||2:null,markerSize[count]=data.marker&&data.marker.enabled?(isArray(data.marker.size)?data.marker.size[i]:data.marker.size)||1:null,count++)});var rect=chartObj.container.node().getBoundingClientRect(),bound={left:rect.left+plotarea.left,top:rect.top+plotarea.top,width:plotarea.width,height:plotarea.height,right:rect.left+plotarea.left+plotarea.width,bottom:rect.top+plotarea.top+plotarea.height},boundLeft=bound.left,boundTop=bound.top,orient=axisObj.component.orient(),margin={top:0,left:0,right:0,bottom:0},thresholdEvents=chartObj.cache.thresholdCustomPoints=pick(chartObj.cache.thresholdCustomPoints,[]),thresholdTriggerOffset=function(markerInfo,chartInstance){return pick(getPropVal(markerInfo,"events.triggerOffset"),getTriggeringOffset(chartInstance,chartInstance.chartTypes[0].value))}(data,chartObj);container.attr("transform","translate("+plotarea.left+","+plotarea.top+")");var wrap=appendEle(container,"g",[data],".","class","thresline-"+index),plotareaBorderEle=chartObj.container.selectAll("g.plotareaBorder-property").node(),plotareaBorder_bkp=plotareaBorderEle.border||plotareaBorderEle["border-"+orient],plotareaBorder_Oppbkp=plotareaBorderEle.border||plotareaBorderEle["border-"+getOppositeOrient(orient)],wid1=plotareaBorder_bkp&&plotareaBorder_bkp.clr!==TRANSPARENT?plotareaBorder_bkp.size:0,wid2=plotareaBorder_Oppbkp&&plotareaBorder_Oppbkp.clr!==TRANSPARENT?plotareaBorder_Oppbkp.size:0,plotareaBorderWid_bkp=wid1+wid2,marker=appendEle(wrap,"path",null!=markerInfo&&markerEnabled?thval:[],".","class","marker");marker.attr("d",function(d,i){return getSVGsymbol(isArray(markerInfo.symbol)?markerInfo.symbol[i]:markerInfo.symbol)(10*markerSize[i])}).style("stroke-width",function(d,i){return markerWidth[i]||2}).style("stroke",function(d,i){return(isArray(markerInfo.strokeColor)?markerInfo.strokeColor[i]:markerInfo.strokeColor)||thclr[i]}).attr("fill",function(d,i){var fillClr=isArray(markerInfo.fillColor)?markerInfo.fillColor[i]:markerInfo.fillColor;return fillClr||(null===fillClr?thclr[i]:"white")}),marker.attr("transform",function(d,i){var mrkrWidth=markerWidth[i]/2,bbox_marker=d3_select(this).node().getBBox();markerBBox[i]=bbox_marker.width+wid1;var translateX="bottom"==orient||"top"==orient?scaleObj(d)+bandwidth:"left"==orient?mrkrWidth+wid1+bbox_marker.width/2:plotarea.width-(mrkrWidth+wid1+bbox_marker.width/2),translateY="bottom"==orient?plotarea.height-bbox_marker.width/2-wid1-mrkrWidth:"top"==orient?mrkrWidth+bbox_marker.height/2+wid1:scaleObj(d)+bandwidth;return eventDisabled&&thresholdEvents.push({x:translateX-markerBBox[i]/2,y:translateY-markerBBox[i]/2,width:markerBBox[i],height:markerBBox[i],color:thclr[i],text:thname[i],type:"threshold-marker",triggerOffset:thresholdTriggerOffset,size:markerSize[i],marker:markerInfo,point:values[i],formattedValue:getFormattedValue(colInfo[colInfo.datatype],values[i],colInfo.datatype,chartObj,"threshold",!1),thresholdType:type,columnIndex:columnindex,columnInfo:colInfo,yColumnIndex:index,itemIndex:i,events:data.events||{}}),"translate("+translateX+","+translateY+")"}),appendEle(wrap,"line",thval).attr("x1",function(d,i){return"bottom"==orient||"top"==orient?scaleObj(d)+bandwidth:"left"==orient?(markerBBox[i]||0)+markerWidth[i]:wid2}).attr("y1",function(d,i){return"bottom"==orient?wid1:"top"==orient?(markerBBox[i]||0)+markerWidth[i]:scaleObj(d)+bandwidth}).attr("x2",function(d,i){return"bottom"==orient||"top"==orient?scaleObj(d)+bandwidth:"left"==orient?plotarea.width-wid2:plotarea.width-markerWidth[i]-(markerBBox[i]||0)}).attr("y2",function(d,i){return"bottom"==orient?plotarea.height-markerWidth[i]-(markerBBox[i]||0):"top"==orient?plotarea.height-wid2:scaleObj(d)+bandwidth}).attr("stroke",function(d,i){return"    "+thclr[i]}).attr("stroke-width",function(d,i){return strokeWidth[i]+"px"}).attr("shaperendering","crispedges").attr("stroke-dasharray",function(d,i){return getDashArray(strokeDashArray[i],strokeWidth[i])}),appendEle(wrap,"text",null!=label?thval:[]).text(function(d,i){return decodeHTML(thname[i])}).attr("x",function(d,i){var textPadding=10*markerSize[i]+labelPadding[type]+(markerWidth[i]||2);return"x"==type&&!axesRotated||"y"==type&&axesRotated?-axis.threshold.textAlign(hAlign[i]||"right",type,plotarea,axesRotated,textPadding,orient):axis.threshold.textAlign(hAlign[i]||"right",type,plotarea,axesRotated,textPadding,orient)}).attr("y",function(d,i){return scaleObj(d)+bandwidth-5}).attr("transform","x"==type&&!axesRotated||"y"==type&&axesRotated?"rotate(-90)":"rotate(0)").styles({"font-family":function(d,i){return fontFamilies[i]=(isArray(label.fontFamily)?label.fontFamily[i]:label.fontFamily)||systemconf.chart.fontFamily||systemconf.canvas.fontFamily||$ZCG.fontFamily,fontFamilies[i]},"font-size":function(d,i){return fontSizes[i]=utils.getVal((isFunction(label.fontSize)||isArray(label.fontSize)?label.fontSize[i]:label.fontSize)||systemconf.chart.fontSize||systemconf.canvas.fontSize),fontSizes[i]+"px"},fill:function(d,i){return(isArray(label.fontColor)?label.fontColor[i]:label.fontColor)||systemconf.chart.fontColor||systemconf.canvas.fontColor||$ZCG.fontColor},"font-weight":function(d,i){return(isArray(label.fontWeight)?label.fontWeight[i]:label.fontWeight)||systemconf.chart.fontWeight||systemconf.canvas.fontWeight||$ZCG.fontWeight},"font-style":function(d,i){return(isArray(label.fontStyle)?label.fontStyle[i]:label.fontStyle)||systemconf.chart.fontStyle||systemconf.canvas.fontStyle||$ZCG.fontStyle},"text-Anchor":function(d,i){return"left"==orient||"bottom"==orient?"center"==hAlign[i]?"middle":"right"==hAlign[i]?"end":"start":"center"==hAlign[i]?"middle":"right"==hAlign[i]?"start":"end"}}).each(function(d,i){var adjustment,text=decodeHTML(thname[i]),actualMarkerSize=10*markerSize[i],textWidth=utils.fontUtils.getTextWidth(text,fontSizes[i],fontFamilies[i])+actualMarkerSize,size="top"===orient||"bottom"===orient?plotarea.height:plotarea.width;textWidth>size&&(adjustment=mathMin(textWidth-size,actualMarkerSize)+plotareaBorderWid_bkp,bound.left=boundLeft+adjustment,bound.top=boundTop+adjustment,trimText(this,this.textContent,this.getBoundingClientRect(),bound,get_threshold_text_orient(orient),"..",margin))})})}return chart.parentObj=function(_){return arguments.length?(parentObj=_,chart):parentObj},chart.getMetaInfo=function(point){return{itemIndex:point.itemIndex,point:point.point,data:mergeJSON(chartObj.systemConf.metadata.columns[point.columnIndex],{columnindex:point.columnIndex})}},chart};axis.threshold.line;axis.threshold.overlay=function(chartObj,category,overlayData){var axisrotated=chartObj.dataObject.getAxisRotated();if("discrete"==category){var thvalues=overlayData.values.slice(0),overlayRange=overlayData.overlayRange,defaultColor=overlayData.defaultColor;return"below"==overlayRange||"equalandbelow"==overlayRange?thvalues.sort(d3_ascending):thvalues.sort(d3_descending),function(data,thColor,yvalue,seriescolor){if(null==overlayData.values||0==overlayData.length)return seriescolor;for(var i=0;i<thvalues.length;i++){var toCompare,compare=thvalues[i];switch(overlayRange){case"equal":toCompare=yvalue===compare;break;case"equalandbelow":toCompare=yvalue<=compare;break;case"equalandabove":toCompare=yvalue>=compare;break;case"below":toCompare=yvalue<compare;break;default:toCompare=yvalue>compare}if(toCompare){var index=overlayData.values.indexOf(compare);return null==thColor||null==thColor[index]?defaultColor?seriescolor:"black":thColor[index]}}return seriescolor}}if("continous"==category)return function(seriescolor,data,index,type){var scaleObj="x"==type?chartObj.axes.x.scale:chartObj.axes.y.groups[0].scale,temp=index,origValues=data.values;if(null==origValues||0==origValues.length)return seriescolor;var thValues=origValues.slice(),negthClr=data.color,overlayRange=data.overlayRange,defaultColor=data.defaultColor;overlayRange&&(overlayRange=overlayRange.replace("equaland",""));var formatConf,datatype=chartObj.dataset.getDataType(type,index);if("time"==datatype){var column=chartObj.dataset.getColumn(type,index);formatConf=null!=column.time?column.time:null}thValues=thValues.map(function(d,i){return"time"==datatype?generateDateVal(d,0,formatConf).getTime():d}),"x"==type&&!axisrotated||"y"==type&&axisrotated?thValues.sort(function(a,b){return a<b?-1:a>b?1:0}):thValues.sort(function(a,b){return a>b?-1:a<b?1:0});var scaleDomainLength=scaleObj.domain().length,range="x"==type&&!axisrotated||"y"==type&&axisrotated?scaleObj(scaleObj.domain()[scaleDomainLength-1])-scaleObj(scaleObj.domain()[0]):scaleObj(scaleObj.domain()[0])-scaleObj(scaleObj.domain()[scaleDomainLength-1]),percent=[];percent.push(0);for(var i=0;i<thValues.length;i++){var per=(scaleObj(thValues[i])+(null!=scaleObj.bandwidth?scaleObj.bandwidth()/2:0))/range*100;per<100&&(percent.push(per),percent.push(per))}percent.push(100);var color=[];("y"==type&&"below"==overlayRange&&!axisrotated||"x"==type&&"above"==overlayRange&&!axisrotated||"y"==type&&"above"==overlayRange&&axisrotated||"x"==type&&"below"==overlayRange&&axisrotated)&&color.push(seriescolor);for(i=0;i<thValues.length;i++){index=origValues.indexOf(thValues[i]);color.push(null==negthClr||null==negthClr[index]?defaultColor?seriescolor:"black":negthClr[index])}("y"==type&&"above"==overlayRange&&!axisrotated||"x"==type&&"below"==overlayRange&&!axisrotated||"y"==type&&"below"==overlayRange&&axisrotated||"x"==type&&"above"==overlayRange&&axisrotated)&&color.push(seriescolor);var offset=[];for(i=0;i<percent.length;i++){var obj={};obj.offset=percent[i]+"%",obj.color=i%2==0?color[i/2]:color[(i-1)/2],offset.push(obj)}var thresholdProp={type:"thresholdLinear",options:{}},options=thresholdProp.options,scale_x=axisrotated?chartObj.axes.y.groups[0].scale:chartObj.axes.x.scale,scale_y=axisrotated?chartObj.axes.x.scale:chartObj.axes.y.groups[0].scale,isHorizontal="x"==type&&!axisrotated||"y"==type&&axisrotated;options.x1=isHorizontal?scale_x(scale_x.domain()[0]):0,options.x2=isHorizontal?scale_x(scale_x.domain()[scaleDomainLength-1]):0,options.y1=isHorizontal?0:scale_y(scale_y.domain()[scaleDomainLength-1]),options.y2=isHorizontal?0:scale_y(scale_y.domain()[0]),options.values=thValues,options.color=color,options.seriesclr=seriescolor,options.overlayRange=overlayRange;var domain=(isHorizontal?scale_x:scale_y).domain();options.scale=domain[0]+"_"+domain[1];var rendererMode=chartObj.plot.renderer.mode,chartName=chartObj.chartTypes[temp].name,plotOptions=chartObj.systemConf.chart.plot.plotoptions[chartName],opacity="line"===chartName?plotOptions.strokeOpacity:plotOptions.fillOpacity,gradientDim=[options.x1,options.x2,options.y1,options.y2],prop=getGradientProp(thresholdProp,gradientDim,color,opacity),args={offset:chartName,chartObj:chartObj,offset:offset,dimension:gradientDim,color:color},gradientID="svg"==rendererMode?effects.get(effects.svg_gradients,"svgGradientFill",prop,args):effects.get(effects.canvas_gradients,"canvasGradientFill",prop,args);return"svg"==rendererMode?"url("+chartObj.defsLocation+"#"+gradientID+")":gradientID}};axis.threshold.overlay;axis.threshold.range=function(){var index,chartObj,type,parentObj;function chart(selection){selection.each(function(data){var container=d3_select(this);chartObj=parentObj.chartObj(),index=parentObj.thresholdIndex(),type=parentObj.type();var systemconf=chartObj.systemConf,label=data.label;label=overrideThresholdFonts(label,isObjectPropDefined(chartObj.userdata,"chart.axes."+type+"axis"+("x"===type?"":"."+index)+".threshold.range.label",!0));var fillColor=[],fillOpacity=[],strokeColor=[],strokeDashArray=[],lineCap=[],hAlign=[],thName=[],fontColor=[],fontSize=[],fontFamily=[],fontWeight=[],fontStyle=[],rect=chartObj.container.node().getBoundingClientRect(),plotarea=chartObj.plotarea,bound={left:rect.left+plotarea.left,top:rect.top+plotarea.top,width:plotarea.width,height:plotarea.height,right:rect.left+plotarea.left+plotarea.width,bottom:rect.top+plotarea.top+plotarea.height},orient=chartObj.axes[type].orient,actualOrient=parentObj.axisObj().component.orient(),margin={top:0,left:0,right:0,bottom:0},wrap=appendEle(container,"g",data.show?[data]:[],".","class","thresholdrangegroup-"+type),axesRotated=chartObj.axes.rotated;if(data.show){var formatConf,datatype=chartObj.dataset.getDataType(type,index),colInfo=chartObj.dataset.getColumn(type,index);datatype==TIME_DATATYPE&&(formatConf=null!=colInfo.time?colInfo.time:null);var values=[],arr=[],labelPadding={x:2,y:2},xAxisLine=systemconf.chart.axes.xaxis.axisline,yAxisLine=systemconf.chart.axes.yaxis[index].axisline;defined(xAxisLine)&&xAxisLine.show&&(labelPadding.x+=+xAxisLine.strokeWidth-1),defined(yAxisLine)&&yAxisLine.show&&(labelPadding.y+=+yAxisLine.strokeWidth-1);var scale_x=axesRotated?chartObj.axes.y.groups[index].scale:chartObj.axes.x.scale,scale_y=axesRotated?chartObj.axes.x.scale:chartObj.axes.y.groups[index].scale,isBarEnabled=chartObj.dataObject.noofBarEnabledSeries,rangeBand_x=null!=scale_x.bandwidth&&isBarEnabled?scale_x.bandwidth():0,rangeBand_y=null!=scale_y.bandwidth&&isBarEnabled?scale_y.bandwidth():0,strangeBand_x=null==scale_x.bandwidth||isBarEnabled?0:scale_x.bandwidth()/2,strangeBand_y=null==scale_y.bandwidth||isBarEnabled?0:scale_y.bandwidth()/2,count=0,domain=("x"==type&&!axesRotated||"y"==type&&axesRotated?scale_x:scale_y).domain(),domainLength=domain.length-1;data.values.map(function(d,i){(arr=null!=d&&""!=d?d.map(function(dt){return datatype==TIME_DATATYPE?generateDateVal(dt,0,formatConf).getTime():dt}):null)&&!(arr[0]>domain[domainLength]||arr[1]<domain[0])&&(arr[0]=mathMax(arr[0],domain[0]),arr[1]=mathMin(arr[1],domain[domainLength]),values[count]=arr,fillColor[count]=(isArray(data.fillColor)?data.fillColor[i]:data.fillColor)||"grey",fillOpacity[count]=validateNullVal(isArray(data.fillOpacity)?data.fillOpacity[i]:data.fillOpacity,"0.2"),strokeColor[count]=(isArray(data.strokeColor)?data.strokeColor[i]:data.strokeColor)||"black",strokeDashArray[count]=isArray(data.dashStyle)?data.dashStyle[i]:data.dashStyle,lineCap[count]=isArray(data.lineCap)?data.lineCap[i]:data.lineCap,hAlign[count]=(isArray(data.label.hAlign)?data.label.hAlign[i]:data.label.hAlign)||"center",thName[count]=getCustomThresholdText(getPropVal(data,"label.text["+i+"]")||"",data.values,colInfo,chartObj),fontColor[count]=isArray(label.fontColor)?label.fontColor[i]:label.fontColor,fontStyle[count]=isArray(label.fontStyle)?label.fontStyle[i]:label.fontStyle,fontFamily[count]=isArray(label.fontFamily)?label.fontFamily[i]:label.fontFamily,fontWeight[count]=isArray(label.fontWeight)?label.fontWeight[i]:label.fontWeight,fontSize[count]=label.fontSize instanceof Function||isArray(label.fontSize)?label.fontSize[i]:label.fontSize,count++)});var rangeBoxgroup=appendEle(wrap,"g",values,".","class","rangebox-"+index);rangeBoxgroup.append("rect"),rangeBoxgroup.append("text");var rangeBoxRect=rangeBoxgroup.select("rect"),rangeBoxText=rangeBoxgroup.select("text");rangeBoxRect.attrs({x:function(d,i){return"x"==type&&!axesRotated||"y"==type&&axesRotated?scale_x(d[0])+strangeBand_x+chartObj.plotarea.left:chartObj.plotarea.left+labelPadding[type]},y:function(d,i){return"x"==type&&!axesRotated||"y"==type&&axesRotated?chartObj.plotarea.top:scale_y(d[1])+strangeBand_y+chartObj.plotarea.top},width:function(d,i){return"x"==type&&!axesRotated||"y"==type&&axesRotated?scale_x(d[1])-scale_x(d[0])+rangeBand_x:chartObj.plotarea.width-labelPadding[type]},height:function(d,i){return"x"==type&&!axesRotated||"y"==type&&axesRotated?chartObj.plotarea.height-labelPadding[type]:scale_y(d[0])-scale_y(d[1])+rangeBand_y}}).styles({fill:function(d,i){return fillColor[i]},"fill-opacity":function(d,i){return fillOpacity[i]},stroke:function(d,i){return strokeColor[i]},"stroke-dasharray":function(d,i){return getDashArray(strokeDashArray[i])},"stroke-linecap":function(d,i){return getLineCap(lineCap[i],strokeDashArray[i])}}),rangeBoxText.attrs({transform:function(d,i){var box=rangeBoxRect.nodes()[i].getBBox(),transY=axis.threshold.textAlign(hAlign[i],type,chartObj.plotarea,axesRotated,labelPadding[type],orient);return"x"==type&&!axesRotated||"y"==type&&axesRotated?"translate("+(box.x+box.width/2)+","+(transY+chartObj.plotarea.top)+") rotate(-90)":"translate("+(transY+chartObj.plotarea.left)+","+(box.y+box.height/2)+")"},dy:"0.3em"}).styles({"font-family":function(d,i){return fontFamily[i]||systemconf.chart.fontFamily||systemconf.canvas.fontFamily||$ZCG.fontFamily},"font-size":function(d,i){return utils.getVal(fontSize[i]||systemconf.chart.fontSize||systemconf.canvas.fontSize)+"px"},fill:function(d,i){return fontColor[i]||systemconf.chart.fontColor||systemconf.canvas.fontColor||$ZCG.fontColor},"font-weight":function(d,i){return fontWeight[i]||systemconf.chart.fontWeight||systemconf.canvas.fontWeight||$ZCG.fontWeight},"font-style":function(d,i){return fontStyle[i]||systemconf.chart.fontStyle||systemconf.canvas.fontStyle||$ZCG.fontStyle},"text-Anchor":function(d,i){return"center"==hAlign[i]?"middle":"right"==hAlign[i]?"end":"start"}}).text(function(d,i){return decodeHTML(thName[i])}).each(function(){trimText(this,this.textContent,this.getBoundingClientRect(),bound,get_threshold_text_orient(actualOrient),"..",margin)})}})}return chart.parentObj=function(_){return arguments.length?(parentObj=_,chart):parentObj},chart};axis.threshold.range;function getLineLayout(rp,serData,shiftInfo,yrangePos){var layout,chartObj=rp.chartObj,xscale=rp.xscale,yscale=rp.yscale,stacked=rp.stacked,index=rp.datasetIndex,axisrotated=rp.axisrotated,commonPlotOptions=rp.commonPlotOptions,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,systemconf=chartObj.systemConf,dataObject=chartObj.dataObject,yReversed=systemconf.chart.axes.yaxis[yaxiscolumnorder].reversed,plotoptions=chartObj.seriesdata[index].plotoptions,gvp=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions),interpolation=$Browser.FIREFOX&&1==serData.length?"linearClosed":gvp("mode");if(dataObject.isPolarAxisCategory)layout=d3_lineRadial().defined(function(d,j){return!d.isDummy}).radius(function(d,j){var r=stacked?yscale(d.y+d.y0):yscale(dataset.getY(d,yaxiscolumnorder))+(null!=yscale.bandwidth?yscale.bandwidth()/2:0);return mathMax(r,yscale.range()[yReversed&&!stacked?yscale.domain().length-1:0]+.1)}).angle(function(d,j){return xscale(dataset.getX(d))}).curve(d3_curves(interpolation,axisrotated));else{var cType=chartObj.chartTypes[index],dataProcessorHelpers=DataProcessor.helpers,isCatNullX=dataProcessorHelpers.isCatNull(dataset,"x"),isCatNullY=dataProcessorHelpers.isCatNull(dataset,"y",yaxiscolumnorder);layout=d3_line().defined(function(d,j){var nullData=!isCatNullY(dataset.getY(d,yaxiscolumnorder))&&!isCatNullX(dataset.getX(d));return cType.value===charttype.stkdarea||!d.isDummy&&nullData}).x(function(d,j){var x=dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x",null,yrangePos);null!=shiftInfo&&(x+=Math.abs(dataObject.getXYvalue(axisrotated,stacked,chartObj.renderer[index].oldXscale,yscale,yaxiscolumnorder,serData[0],"x",null,yrangePos)-dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[0],"x",null,yrangePos)));return x}).y(function(d,j){return chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y",null,yrangePos)}).curve(d3_curves(interpolation,axisrotated,commonPlotOptions.tension))}return layout}function getAreaLayout(rp,shiftDiff,shiftInfo,serData,subseriesIndex){var layout,chartObj=rp.chartObj,xscale=rp.xscale,yscale=rp.yscale,stacked=rp.stacked,index=rp.datasetIndex,axisrotated=rp.axisrotated,commonPlotOptions=rp.commonPlotOptions,hasNegValue=rp.hasNegValue,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,systemconf=chartObj.systemConf,dataObject=chartObj.dataObject,yReversed=systemconf.chart.axes.yaxis[yaxiscolumnorder].reversed,plotoptions=chartObj.seriesdata[index].plotoptions,interpolation=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions)("mode");if(dataObject.isPolarAxisCategory){var polarBaseIdx=yReversed&&!stacked?yscale.domain().length-1:0,innerRadiusFunc=function(d,j){var innerRadius;return innerRadius=stacked?0==d.y0?mathMin(yscale.range()[0],yscale(hasNegValue),d.y0):yscale(d.y0):yscale(yscale.domain()[polarBaseIdx])+(null!=yscale.bandwidth?yscale.bandwidth()/2:0),mathMax(innerRadius,yscale.range()[polarBaseIdx])};layout=d3_areaRadial().angle(function(d,j){return xscale(dataset.getX(d))}).outerRadius(function(d,j){if(d.isDummy)return innerRadiusFunc.apply(null,arguments);var outerRadius=stacked?yscale(d.y0+d.y):yscale(dataset.getY(d,yaxiscolumnorder))+(null!=yscale.bandwidth?yscale.bandwidth()/2:0);return mathMax(outerRadius,yscale.range()[polarBaseIdx])}).innerRadius(innerRadiusFunc).curve(d3_curves(interpolation))}else{var isRangeChart=chartObj.chartTypes[index].name===AREARANGE_CHARTNAME,yrangePos=isRangeChart?1:null,dataProcessorHelpers=DataProcessor.helpers,isCatNullX=dataProcessorHelpers.isCatNull(dataset,"x"),isCatNullY=dataProcessorHelpers.isCatNull(dataset,"y",yaxiscolumnorder);layout=d3_area().defined(function(d,j){return stacked?!isCatNullX(dataset.getX(d)):!isCatNullY(dataset.getY(d,yaxiscolumnorder))&&!isCatNullX(dataset.getX(d))}).curve(d3_curves(interpolation,axisrotated,commonPlotOptions.tension)),axisrotated?layout.x0(function(d,j){return stacked?0==index&&0==subseriesIndex&&0==j?mathMax(yscale.range()[0],yscale(hasNegValue)):yscale(d.y0):isRangeChart?dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x",null,0):null!=yscale.bandwidth?yscale.origRange[0]+yscale.bandwidth():mathMax(yscale.range()[0],yscale(hasNegValue))}).x1(function(d,j){var x=dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x",null,yrangePos);return isNaN(x)&&null!=shiftInfo&&(x=dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[serData.length-1],"x",null,yrangePos)+shiftDiff),x}).y(function(d,j){return dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y",null,yrangePos)}):layout.x(function(d,j){var x=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x",null,yrangePos);null!=shiftInfo&&(x+=Math.abs(chartObj.dataObject.getXYvalue(axisrotated,stacked,chartObj.renderer[index].oldXscale,yscale,yaxiscolumnorder,serData[0],"x",null,yrangePos)-chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[0],"x",null,yrangePos)));return x}).y0(function(d,j){return stacked?0==index&&0==subseriesIndex&&0==j?mathMin(yscale.range()[0],yscale(hasNegValue)):yscale(d.y0):isRangeChart?dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y",null,0):null!=yscale.bandwidth?yscale.origRange[0]+yscale.bandwidth():mathMin(yscale.range()[0],yscale(hasNegValue))}).y1(function(d,j){return dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y",null,yrangePos)})}return layout}function arcInnerTween(element,arc,innerRadius,outerRadius){element.attrTween("d",function(d,i){var interpolateOuterRadius=d3$1.interpolate(outerRadius[0],outerRadius[1]),interpolateInnerRadius=d3$1.interpolate(innerRadius[0],innerRadius[1]);return function(t){return arc.outerRadius(interpolateOuterRadius(t)),arc.innerRadius(interpolateInnerRadius(t)),arc(d)}})}function getEventArgs(d,i,renderer){var ev=getEventObject(d3$1.event);return{renderer:renderer,seriesPos:treemapUtils.getSeriesIndex(d),coordinates:[ev.pageX,ev.pageY],element:this,data:d.data,level:treemapUtils.getLevel(d)}}function getNonAxisDataPoint(layoutObj){var nearestPoint,chartObj=layoutObj.chartObj,dimension=layoutObj.dimension,processedData=layoutObj.processedData,commonPlotOptions=layoutObj.rp.commonPlotOptions,dataset=chartObj.dataset,relmousePt=getRelativeMousePosition(chartObj);if(chartObj.chartRendered)return processedData.some(function(d){var seriesIndex=treemapUtils.getSeriesIndex(d);if(!(isUndefined(seriesIndex)||0==validateNullVal(getEventConf(chartObj.seriesdata[seriesIndex].plotoptions,commonPlotOptions,chartObj,"enabled"),!0))){var tileBound=treemapUtils.getTileBound(chartObj,d),x=tileBound.x,y=tileBound.y,w=tileBound.width,h=tileBound.height,isWithinClrRange=isWithinColorRange(dataset.getClr(d.data),chartObj),curpt={x:x+dimension.x,y:y+dimension.y,width:w,height:h};return isWithinClrRange&&geometryUtils.pointInRectangle(relmousePt,curpt)&&!d.children?(nearestPoint=d,!0):void 0}}),nearestPoint}svg_plot_renderer.bar=function(){var commonRendererProp,bandwidth1,bandwidth2,yscale,barDatasetIndex,shiftInfo,transitionDuration,isredraw=!1;function chart(selection){return selection.each(function(data){var container=d3_select(this);chart.update=function(){container.transition().call(chart)};var rp=commonRendererProp.params,chartObj=rp.chartObj,xscale=rp.xscale,stacked=rp.stacked,index=rp.datasetIndex,renderingOrder=rp.renderingOrderIndex,axisrotated=rp.axisrotated,commonPlotOptions=rp.commonPlotOptions,color=rp.color,labelQueue=rp.labelQueue,hasNegValue=rp.hasNegValue,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,systemconf=chartObj.systemConf,dataObject=(chartObj.plotarea,chartObj.dataObject),yaxisReversed=(rp.threshold,rp.colorOverlay,systemconf.chart.axes.yaxis[rp.yaxiscolumnorder||0].reversed),xAxisReverseed=chartObj.systemConf.chart.axes.xaxis.reversed;yscale=rp.yscale;var currentdata=data[index],data_bind={data:currentdata,index:renderingOrder},defsLocation=chartObj.defsLocation,plotoptions=currentdata.plotoptions,currentseriesdata=currentdata.data,cType=chartObj.chartTypes[index].name,gvp=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions),gradientDim=gradient_helpers.getDimension(chartObj,index),patternPallete=chartObj.patternPallete&&chartObj.patternPallete.length,noofbarDatas=chartObj.dataObject.noofBarEnabledSeries,isBullet="bullet"==cType,isGantt="gantt"==cType,isWaterfall="waterfall"==cType,datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder),xCategories=xscale.domain(),yCategories=datatypeY==ORDINAL_DATATYPE?yscale.domain():null,series=(defined(dataObject.hierarchical)&&dataObject.getCategories("x"),appendEle(container,"g",[data_bind],".","class","barseries_"+index));if(!bandwidth1||!bandwidth2)return isredraw=!0,void(chart.chartRendered=!0);var duration,levelMarker=plotoptions&&plotoptions.levelMarker?mergeJSON(commonPlotOptions.levelMarker,plotoptions.levelMarker,!0):commonPlotOptions.levelMarker,borderOptions=plotoptions&&plotoptions.border?mergeJSON(commonPlotOptions.border,plotoptions.border,!0):commonPlotOptions.border,multiColoring=isMultiColoring(commonPlotOptions,chartObj),animationOptions=getAnimationConf(commonPlotOptions,plotoptions,chartObj,"bar"),isAnimationEnable=animationOptions.enabled,easingType=animationOptions.easingType,animationType=animationOptions.type,exitDuration=isAnimationEnable?100:0;transitionDuration=isredraw?isAnimationEnable?300:0:animationOptions.duration;var targetMarker,targetMarkerSeries,levelMarkerColor,commonOption=getBarCommonOption(chartObj.rendererConf[index],index),barWidth=commonOption.barWidth,addRangeBand=commonOption.addRangeBand,stackGroup=chartObj.userdata.seriesdata.stackGroup,actualStackGroupIndex=stackGroup?chartObj.dataObject.getStackGroupIndex(index,stackGroup):0;if(chart.getParamValue=function(){return chartObj.dataObject.getTransRectValue.apply(chartObj.dataObject,toArray(arguments))},levelMarker&&(levelMarkerColor=levelMarker.color,levelMarker.overlayRange="below"),isBullet||isGantt){var markerPropertyName=isGantt?"marker":"targetMarker";targetMarker=plotoptions&&plotoptions[markerPropertyName]?mergeJSON(commonPlotOptions[markerPropertyName],plotoptions[markerPropertyName],!0):commonPlotOptions[markerPropertyName],targetMarkerSeries=appendEle(chartObj.staticPaneSVG.selectAll("g.threshold"),"g",!0!==targetMarker.enabled||currentdata.disabled?[]:[index],".","class",isGantt?"markerSeries"+index:"markerSeries")}var startRadius={tlx:0,tly:0,trx:0,trY:0,brx:0,bry:0,blx:0,bly:0},borderRadius=startRadius,borderSize=0,borderColor=null,borderStyle=null,levelMarkerRadius=startRadius;defined(borderOptions)&&isTrue(borderOptions.show)&&(borderSize=borderOptions.size,borderColor=borderOptions.color,borderStyle=borderOptions.style,borderRadius=chart.getParamValue("radius",null,null,null,commonOption,borderOptions.radius));var dashStyle=getDashArray(borderStyle,null==borderSize?2:borderSize),fillColor=chart.fillColorFunc=getFillColor(chartObj,index,gradientDim),strokeColor=getStrokeColor(chartObj,index);chart.seriesdataAfterUpdate=[],currentseriesdata.forEach(function(d,i){var startx,starty,endx,endy,endwid,endhei;chart.getBarLevelMarkerProp=isGantt?plot.render.bulletHelpers.getLevelMarkerParams:null;var ShiftedData,ishideable=currentdata.disabled,serData=chartObj.dataObject.updateSeriesdatabyCategories(d3_values(d),xCategories,yCategories,yaxiscolumnorder,!0);if(xAxisReverseed&&(serData=serData.slice(0).reverse()),chart.seriesdataAfterUpdate[i]=serData,null!=shiftInfo){ShiftedData=d3_values(d);for(var co=shiftInfo.count,ii=0;ii<=co;ii++)ShiftedData.splice(ii,0,[null,null]);if(isredraw){var clipX=xscale(dataset.getX(d[0])),properties={name:"rect",id:chartObj.id,x:clipX,y:0,width:chartObj.plotarea.width,height:chartObj.plotarea.height},args={chartObj:chartObj},clipID=effects.get(effects.svg_clips,"rect",properties,args);series.attr("clip-path","url("+defsLocation+"#"+clipID+")")}}var dataUpdate=null!=shiftInfo?ShiftedData:chart.seriesdataAfterUpdate[i];duration=animationType==VERTICALALL_ANIMATION||isredraw?transitionDuration:transitionDuration/(dataUpdate.length*noofbarDatas);var showLevelMarker=levelMarker&&!0===levelMarker.enabled&&(stacked&&noofbarDatas>0||!ishideable)&&!chartObj.dataObject.isStackedPercentChart&&(!stackGroup||chartObj.dataObject.groupedByStack.has(actualStackGroupIndex)),subseries_levelMarkerNode=(stacked?container:series).selectAll(stacked?"g.levelMarkerSeries_"+actualStackGroupIndex:"g.subseries_levelMarker_"+i).data(function(d){return showLevelMarker?[d]:[]});(stacked?series:container).selectAll(stacked?"g.subseries_levelMarker_"+i:"g.levelMarkerSeries_"+actualStackGroupIndex).remove(),subseries_levelMarkerNode.exit().selectAll("path.levelMarker").transition().duration(exitDuration).attr("d",function(d,j){if(isGantt){var points=parseSVGPath(d3_select(this).attr("d")),x=points[0].moves[0],y=points[3].moves[1],prop=plot.render.bulletHelpers.getLevelMarkerParams(d,i,j,chart,commonOption);return roundedRect(prop.x||x,prop.y+(axisrotated?0:prop.height*(yaxisReversed?-1:1))||y,axisrotated?0:prop.width,axisrotated?prop.height:0,borderRadius,yaxisReversed,axisrotated)}return roundedRect(chart.getParamValue("x",d,i,j,commonOption)||parseSVGPath(d3_select(this).attr("d"))[0].moves[0],yscale(yscale.domain()[0]),axisrotated?0:chart.getParamValue("width",d,i,j,commonOption),axisrotated?chart.getParamValue("height",d,i,j,commonOption):0,borderRadius,yaxisReversed,axisrotated)}).remove();var subseriesNode=series.selectAll("g.subseries_"+i).data(function(d){return ishideable?[]:[d]});subseriesNode.exit().selectAll("path.zcbar").transition().duration(exitDuration).attr("d",function(d,j){var points=parseSVGPath(d3_select(this).attr("d")),x=points[0].moves[0],y=points[3].moves[1];return roundedRect(chart.getParamValue("x",d,i,j,commonOption)||x,(axisrotated?chart.getParamValue("y",d,i,j,commonOption):isGantt?chart.getParamValue("y",d,i,j,commonOption,null,0):(stacked?yscale(d.y0):null!=hasNegValue?yscale(hasNegValue):null!=yscale(0)?mathMin(yscale(0),yscale.range()[0]):yscale.range()[0])+2*addRangeBand())||y,axisrotated?0:chart.getParamValue("width",d,i,j,commonOption),axisrotated?chart.getParamValue("height",d,i,j,commonOption):0,borderRadius,yaxisReversed,axisrotated)}).remove();var subseries=subseriesNode.enter().append("g").merge(subseriesNode).attr("class","subseries_"+i);if(isWaterfall){var subseries_connectorLines=appendEle(stacked?container:series,"g",stacked||!ishideable?[1]:[],".","class","connectorLines",null);svg_plot_renderer.waterfallHelpers.drawConnectorLines(subseries_connectorLines,dataUpdate,{chart:chartObj,yaxiscolumnorder:yaxiscolumnorder,axisrotated:axisrotated,stacked:stacked,xscale:xscale,yscale:yscale,renderer:chart,seriesindex:i,plotoptions:plotoptions,commonPlotOptions:commonPlotOptions});var subseries_comparisonLines=appendEle(stacked?container:series,"g",stacked||!ishideable?[1]:[],".","class","comparisonLines",null);svg_plot_renderer.waterfallHelpers.drawComparisonLine(subseries_comparisonLines,dataUpdate,{chart:chartObj,yaxiscolumnorder:yaxiscolumnorder,axisrotated:axisrotated,stacked:stacked,xscale:xscale,yscale:yscale,renderer:chart,seriesindex:i,plotoptions:plotoptions,commonPlotOptions:commonPlotOptions})}var subseries_levelMarkerZindex=isGantt?subseries_levelMarkerNode.enter().append("g").merge(subseries_levelMarkerNode):subseries_levelMarkerNode.enter().insert("g",":first-child").merge(subseries_levelMarkerNode);subseries_levelMarkerZindex.attr("class",stacked?"levelMarkerSeries_"+actualStackGroupIndex:"subseries_levelMarker_"+i),showLevelMarker&&stacked&&xCategories.length!=dataUpdate.length&&plot.render.bulletHelpers.addDummyDataForLevelmarker(dataUpdate,xCategories,dataset,yaxiscolumnorder);var rect_levelMarkerNode=subseries_levelMarkerZindex.selectAll("path.levelMarker").data(dataUpdate,function(d){return isGantt?d:dataset.getX(d)});rect_levelMarkerNode.enter().append("path").merge(rect_levelMarkerNode).attr("class","levelMarker").styles({fill:function(d,j){if(isGantt)return levelMarker.color||(multiColoring?chartObj.seriesColor[j%chartObj.seriesColor.length]:color);if(!plot.render.bulletHelpers.ZC_BAR_getLevelMarkerRect||!plot.render.bulletHelpers.getBulletLevelMarkerGradient)throw"Level marker or bullet module was not loaded";var baseClr=multiColoring?chartObj.seriesColor[j%chartObj.seriesColor.length]:color,clr=isArray(levelMarker.color)?levelMarker.color[0]:levelMarker.color;if(patternPallete){var prop=isGantt?plot.render.bulletHelpers.getLevelMarkerParams(d,i,j,chart,commonOption):plot.render.bulletHelpers.ZC_BAR_getLevelMarkerRect(d,levelMarker,chartObj,commonOption,rp,i,index),x=prop.x,y=prop.y,wid=prop.width,hei=prop.height;clr=fillColor(multiColoring?j:index,null,null,clr,null,null,{x:x,y:y,width:wid,height:hei})}return plot.render.bulletHelpers.getBulletLevelMarkerGradient(d,levelMarker,chartObj,baseClr,levelMarkerColor)||clr||baseClr},"fill-opacity":levelMarker?levelMarker.fillOpacity:null,opacity:function(d,i){if(defined(dataObject.hierarchical)&&defined(chartObj.cache.hierarchical)&&chartObj.cache.hierarchical.active)return!0===d.active?1:.1}}).attr("d",function(d,j){var prop=isGantt?plot.render.bulletHelpers.getLevelMarkerParams(d,i,j,chart,commonOption):plot.render.bulletHelpers.ZC_BAR_getLevelMarkerRect(d,levelMarker,chartObj,commonOption,rp,i,index),x=prop.x,y=prop.y,wid=prop.width,hei=prop.height;return isGantt?roundedRect(x,y,wid,hei,levelMarkerRadius,yaxisReversed,axisrotated):axisrotated?roundedRect(y,x,wid,hei,borderRadius,yaxisReversed,axisrotated):roundedRect(x,y,wid,hei,borderRadius,yaxisReversed,axisrotated)}).attr("level",function(d,i){if(defined(dataObject.hierarchical))return d.level}),levelMarker&&(levelMarker.color=levelMarkerColor),rect_levelMarkerNode.exit().remove(),isBullet?(svg_plot_renderer.ganttHelpers.addMarker(targetMarkerSeries,dataUpdate,chart,i,targetMarker,multiColoring,""),labelRenderer.bullet.call(chartObj,targetMarker,chart,dataUpdate)):isGantt&&(svg_plot_renderer.ganttHelpers.addMarker(targetMarkerSeries,dataUpdate,chart,i,targetMarker.start,multiColoring,0),svg_plot_renderer.ganttHelpers.addMarker(targetMarkerSeries,dataUpdate,chart,i,targetMarker.end,multiColoring,1));var rect=subseries.selectAll("path.zcbar").attr("class","zcbar").data(dataUpdate,function(d){return isGantt?d:dataset.getX(d)}),rectEnter=rect.enter().append("path").style("fill-opacity",gvp("fillOpacity")).attrs({class:"zcbar",height:0,d:function(d,j){var params=function(d){var v=dataset.getX(d);return startx=stacked?bandwidth1(v):bandwidth1(v)+bandwidth2(barDatasetIndex+i),starty=yscale.bandwidth?yscale.origRange[0]:axisrotated?null!=hasNegValue?yscale(hasNegValue):yscale.range()[0]:stacked?null!=hasNegValue?yscale(hasNegValue):yscale.range()[0]:null!=hasNegValue?yscale(hasNegValue):null!=yscale(0)?mathMin(yscale(0),yscale.range()[0]):yscale.range()[0],starty=isWaterfall?yscale(d.y0):starty,{x:startx,y:starty,width:axisrotated?0:barWidth,height:axisrotated?barWidth:0}}(d);return d3_select(this).attr("y",params.y),axisrotated?roundedRect(params.y,params.x,params.width,params.height,startRadius,yaxisReversed,axisrotated):roundedRect(params.x,params.y,params.width,params.height,startRadius,yaxisReversed,axisrotated)}}).merge(rect);rectEnter.attrs({stroke:function(d,j){return strokeColor(multiColoring?j:index,d,borderColor)},"stroke-width":borderSize,"stroke-dasharray":dashStyle,level:function(d,i){if(defined(dataObject.hierarchical))return d.level}}).styles({fill:function(d,j){return patternPallete?fillColor(multiColoring?j:index,d,null,null,null,null,{x:chart.getParamValue("x",d,i,j,commonOption),y:chart.getParamValue("y",d,i,j,commonOption),width:chart.getParamValue("width",d,i,j,commonOption),height:chart.getParamValue("height",d,i,j,commonOption)}):fillColor(multiColoring?j:index,d)},opacity:function(d,i){if(defined(dataObject.hierarchical)&&defined(chartObj.cache.hierarchical)&&chartObj.cache.hierarchical.active)return!0===d.active?1:.1},"fill-opacity":gvp("fillOpacity"),transition:"opacity ease 0.2s"});if(null==shiftInfo?rectEnter.transition().duration(isredraw?duration:0).delay(function(d,j){return animationType==VERTICALALL_ANIMATION||isredraw?0:(j*noofbarDatas+index)*duration}).attr("d",function(d,j){var curele=d3_select(this),starthei=parseFloat(curele.attr("height"));return endx=axisrotated&&!isGantt?parseFloat(curele.attr("y")):chart.getParamValue("x",d,i,j,commonOption),endy=axisrotated?chart.getParamValue("y",d,i,j,commonOption):isGantt&&!starthei?chart.getParamValue("y",d,i,j,commonOption,null,0):parseFloat(curele.attr("y")),endwid=axisrotated?parseFloat(curele.attr("height")):chart.getParamValue("width",d,i,j,commonOption),endhei=axisrotated?chart.getParamValue("height",d,i,j,commonOption):starthei,roundedRect(endx,endy,endwid,endhei,borderRadius,yaxisReversed,axisrotated)}).on("end",function(d,k){d3_select(this).transition().delay(function(d,j){return animationType==VERTICALALL_ANIMATION||isredraw?0:(k*noofbarDatas+index)*duration}).duration(duration).ease(easingType).attr("d",function(d){var params=getFinalParams(d,k);return roundedRect(params.x,params.y,params.width,params.height,borderRadius,yaxisReversed,axisrotated)})}).attrs({y:function(d,j){var param=axisrotated?"x":"y";return chart.getParamValue(param,d,i,j,commonOption)},height:function(d,j){var param=axisrotated?"width":"height";return chart.getParamValue(param,d,i,j,commonOption)}}):rectEnter.transition().duration(isredraw?duration:0).attrs({d:function(d,j){var params=getFinalParams(d,j);return roundedRect(params.x,params.y,params.width,params.height,borderRadius,yaxisReversed,axisrotated)},y:function(d,j){var param=axisrotated?"x":"y";return chart.getParamValue(param,d,i,j,commonOption)},height:function(d,j){var param=axisrotated?"width":"height";return chart.getParamValue(param,d,i,j,commonOption)}}),rect.exit().transition().duration(duration).remove(),i>0&&stacked){var dividerbarNode=appendEle(series,"g",ishideable?[]:[1],".","class","subdividerseries_"+i).selectAll("rect").data(dataUpdate,function(d){return dataset.getX(d)}),dividerbar=dividerbarNode.enter().append("rect").merge(dividerbarNode).styles({fill:"white",opacity:.7,"shape-rendering":"crispedges"}).attrs({width:getDividerParam("width"),height:getDividerParam("height"),x:function(d,j){return getDividerParam("x",d,i,j,commonOption)},y:function(d,j){return getDividerParam("y",d,i,j,commonOption)}});dividerbar.transition().duration(duration).ease(easingType).styles({fill:"white",opacity:.7,"shape-rendering":"crispedges"}).attrs({width:getDividerParam("width"),height:getDividerParam("height"),x:function(d,j){return getDividerParam("x",d,i,j,commonOption)},y:function(d,j){return getDividerParam("y",d,i,j,commonOption)}}),dividerbar.exit().remove()}function getDividerParam(paramType,d,i,j,cp){switch(paramType){case"x":return axisrotated?yscale(d.y0):chart.getParamValue("x",d,i,j,cp);case"y":return axisrotated?chart.getParamValue("y",d,i,j,cp):yscale(d.y0);case"width":return axisrotated?1:barWidth;case"height":return axisrotated?barWidth:1}}function getFinalParams(d,j){return endx=chart.getParamValue("x",d,i,j,commonOption),endy=chart.getParamValue("y",d,i,j,commonOption),endwid=chart.getParamValue("width",d,i,j,commonOption),endhei=chart.getParamValue("height",d,i,j,commonOption),{x:endx,y:endy,width:endwid,height:endhei}}isGantt&&svg_plot_renderer.ganttHelpers.showDependencies(chart,dataUpdate,series,i),chart.getMarkerPosition=isGantt?svg_plot_renderer.ganttHelpers.getMarkerPosition:null}),labelQueue.push({renderer:chart,charttype:"bar",chartObj:chartObj,args:[currentdata,index]})}),chart.renderedTimer=setTimeout(function(){isredraw=!0,chart.chartRendered=!0},2*transitionDuration+10),chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.bandwidth1=function(_){return arguments.length?(bandwidth1=_,chart):bandwidth1},chart.bandwidth2=function(_){return arguments.length?(bandwidth2=_,chart):bandwidth2},chart.barDatasetIndex=function(_){return arguments.length?(barDatasetIndex=_,chart):barDatasetIndex},chart.shiftInfo=function(_){return arguments.length?(shiftInfo=_,chart):shiftInfo},chart},svg_plot_renderer.line=function(){var commonRendererProp,xscale,yscale,index,dataset,axisrotated,yaxiscolumnorder,color,series,path,strokeDashArray,marqueeEnabled,marqueeDuration,marker,stacked,labelQueue,commonPlotOptions,systemconf,hasNegValue,chartObj,shiftInfo,yrangePos,transitionDuration,animationType,line=[],scatter=svg_plot_renderer.scatter(),redraw=!1;function chart(selection){return selection.each(function(data){var rp=commonRendererProp.params;chartObj=rp.chartObj,xscale=rp.xscale,yscale=rp.yscale,stacked=rp.stacked,index=rp.datasetIndex,axisrotated=rp.axisrotated,commonPlotOptions=rp.commonPlotOptions,color=rp.color,labelQueue=rp.labelQueue,hasNegValue=rp.hasNegValue,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,systemconf=chartObj.systemConf;var renderingOrder=rp.renderingOrderIndex,defsLocation=chartObj.defsLocation,currentdata=data[index],data_bind={data:currentdata,index:renderingOrder},plotoptions=currentdata.plotoptions,currentseriesdata=currentdata.data,tempChart=chartObj.chartTypes[index],cType=tempChart.name,dataProcessorHelpers=(tempChart.value,DataProcessor.helpers),gvp=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions),isRangeChart="arearange"==cType,isPolar=chartObj.dataObject.isPolarAxisCategory,gradientDim=gradient_helpers.getDimension(chartObj,index),canvasarea=chartObj.canvasarea,interpolation=gvp("mode"),dashStyle=gvp("dashStyle"),strokeWidth=validateNullVal(gvp("strokeWidth"),2),strokeOpacity=gvp("strokeOpacity"),strokeColor=getStrokeColor(chartObj,index,gradientDim),hasColorScale=colorscale_helpers.isQuantileColorScale(chartObj),markeroptions=plotoptions&&plotoptions.marker?mergeJSON(commonPlotOptions.marker,plotoptions.marker,!0):commonPlotOptions.marker,animationOptions=getAnimationConf(commonPlotOptions,plotoptions,chartObj,cType),isAnimationEnable=animationOptions.enabled,easingType=animationOptions.easingType;transitionDuration=animationOptions.duration,animationType=(animationType=animationOptions.type)==VERTPATHTWEENALL_ANIMATION?VERTPATHTWEEN_ANIMATION:animationType;var blinkConf=plotoptions&&plotoptions.animation&&plotoptions.animation.blink?mergeJSON(commonPlotOptions.animation.blink,plotoptions.animation.blink,!0):commonPlotOptions.animation.blink,markerEnabled=hasColorScale||!(!datacount_based_intelligence(chartObj,"marker")||!dimension_based_intelligence(chartObj,"marker",mathMin(canvasarea.width,canvasarea.height)))&&markeroptions.enabled,strokeLineCap=getLineCap(gvp("lineCap"),dashStyle),callScatterRenderer=$Browser.IE||$Browser.SAFARI||"stepBefore"==interpolation||"stepAfter"==interpolation||"step-before"==interpolation||"step-after"==interpolation||rp.thresholdType||hasColorScale||$Browser.FIREFOX&&blinkConf.enabled;strokeDashArray=getDashArray(dashStyle,strokeWidth);var marqueeOptions=plotoptions&&plotoptions.animation&&plotoptions.animation.marquee?mergeJSON(commonPlotOptions.animation.marquee,plotoptions.animation.marquee,!0):commonPlotOptions.animation.marquee;marqueeEnabled=marqueeOptions.enabled,marqueeDuration=marqueeOptions.duration;var datatypeX=chartObj.dataset.getDataType("x"),datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder),xCategories=datatypeX==ORDINAL_DATATYPE?xscale.domain():null,yCategories=datatypeY==ORDINAL_DATATYPE?yscale.domain():null,categories=datatypeX!=ORDINAL_DATATYPE||defined(chartObj.dataObject.hierarchical)?chartObj.dataObject.getCategories("x"):xCategories,yReversed=systemconf.chart.axes.yaxis[yaxiscolumnorder].reversed;datatypeX!=ORDINAL_DATATYPE&&0==categories.length&&isAnimationEnable&&animationType==POINTTWEEN_ANIMATION&&(categories=chartObj.dataObject.findXCategories()),chart.seriesdataAfterUpdate=[],currentseriesdata.forEach(function(d,i){var serData;serData=datatypeX==ORDINAL_DATATYPE||datatypeY==ORDINAL_DATATYPE?chartObj.dataObject.updateSeriesdatabyCategories(d3_values(d),xCategories,yCategories,yaxiscolumnorder):d,chart.seriesdataAfterUpdate[i]=serData,line[i]=getLineLayout(rp,serData,shiftInfo,yrangePos)});var container=d3_select(this);chart.update=function(){container.transition().call(chart)},(series=appendEle(container,"g",[data_bind],".","class","lineseries_"+index)).node().index=index,isRangeChart&&(series=appendEle(series,"g",[data_bind],".","class","rangePos_"+yrangePos));var markerID,mSize=isPolar?{inner:.32,outer:.56}:{inner:.4,outer:.7};if(markerEnabled&&!callScatterRenderer&&(markeroptions.color=currentdata.color||chartObj.seriesColor[index%chartObj.seriesColor.length],markerID=generateIdByPropValue(markeroptions,"marker")+generateIdByPropValue(blinkConf,"blink"),marker=addSVGmarker(series,markerID,markeroptions,{color:markeroptions.color,symbolSize:mSize,strokeWidth:strokeWidth},chartObj),delete markeroptions.color),markerEnabled&&!callScatterRenderer&&blinkSVGsymbols(marker.selectAll(".outer,.inner"),blinkConf,chartObj),markerEnabled&&callScatterRenderer?(scatter.commonRendererProp(commonRendererProp).shiftInfo(shiftInfo).yrangePos(yrangePos),scatter.chartRendered=!1,container.call(scatter)):container.selectAll("g.scatterseries_"+index).remove(),currentseriesdata.forEach(function(d,i){var ishideable=currentdata.disabled;if(chartObj.brush&&chartObj.brush.extent){var domain=chartObj.axes.x.scale.domain(),startVal=(chartObj.axes.x.ticks.tickValueObj.ticks,datatypeX==TIME_DATATYPE?domain[0].getTime():datatypeX==ORDINAL_DATATYPE?categories.indexOf(domain[0]):domain[0]),endVal=datatypeX==TIME_DATATYPE?domain[1].getTime():datatypeX==ORDINAL_DATATYPE?categories.indexOf(domain[domain.length-1]):domain[1],accessor=datatypeX==ORDINAL_DATATYPE?function(d){return categories.indexOf(chartObj.dataset.getX(d))}:function(d){return chartObj.dataset.getX(d)};chart.seriesdataAfterUpdate[i]=dataProcessorHelpers.filterDataToViewPort(chart.seriesdataAfterUpdate[i],startVal,endVal,accessor)}var serData=chart.seriesdataAfterUpdate[i];chartObj.systemConf.chart.axes.xaxis.reversed&&(serData=serData.slice(0).reverse());var basedataShift,baseData=serData,subseries=appendEle(series,"g",function(d){return ishideable?[]:[d]},".","class","subseries_"+i);if(path=subseries.selectAll("path.line").data(function(d){return ishideable?[]:[d]}),isAnimationEnable&&animationType!=STROKETWEEN_ANIMATION){if(animationType==POINTTWEEN_ANIMATION)baseData=serData.map(function(d,i){return Object.create(serData[0])});else{var idx=animationType==HORIPATHTWEEN_ANIMATION?dataset.xidx:dataset.yidx(yaxiscolumnorder),scaleObj=animationType==HORIPATHTWEEN_ANIMATION?xscale:yscale,baseIdx=isPolar&&yReversed&&!stacked?scaleObj.domain().length-1:0;baseData=serData.map(function(d,i){var s=Object.create(d);if(stacked&&animationType!=HORIPATHTWEEN_ANIMATION)s.y0=0,s.y=isPolar||null==hasNegValue||null==scaleObj(hasNegValue)?scaleObj.domain()[0]:mathMax(hasNegValue,scaleObj.domain()[0]);else if(isRangeChart&&animationType==VERTPATHTWEEN_ANIMATION){var yArr=new Array(2),y0=chartObj.dataset.getY(d,yaxiscolumnorder,0);yArr[0]=y0,yArr[1]=null==s[idx]?null:null!=hasNegValue&&null!=scaleObj(hasNegValue)?mathMax(hasNegValue,y0):y0,s[idx]=yArr}else s[idx]=null==s[idx]?null:isPolar||null==hasNegValue||null==scaleObj(hasNegValue)?scaleObj.domain()[baseIdx]:mathMax(hasNegValue,scaleObj.domain()[0]);return s})}basedataShift=d3_values(baseData)}if(null!=shiftInfo&&redraw){var clipX=xscale(serData[0][0])+(null!=xscale.bandwidth?xscale.bandwidth()/2:0),clipWid=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[serData.length-1],"x",null,yrangePos)-chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[0],"x",null,yrangePos),properties={name:"rect",id:chartObj.id,x:clipX,y:0,width:clipWid,height:chartObj.plotarea.height},args={chartObj:chartObj},clipID=effects.get(effects.svg_clips,"rect",properties,args);series.attr("clip-path","url("+defsLocation+"#"+clipID+")")}var pathEnter=path.enter().append("path").attr("class","line").datum(baseData,function(d){return dataset.getX(d)}).attr("d",line[i]).style("stroke",currentdata.color||color).style("fill",NONE).style("stroke-width",strokeWidth).style("stroke-opacity",null==strokeOpacity||""===strokeOpacity?1:strokeOpacity);isAnimationEnable&&(animationType==POINTBYPOINT_ANIMATION||animationType==POINTTWEEN_ANIMATION?interTween(baseData,basedataShift,serData,categories,animationType,easingType,transitionDuration,rp,function(d){return{d:line[i](d)}},pathEnter):animationType==STROKETWEEN_ANIMATION?function(path,easingType,duration){path.styles({"stroke-dasharray":function(){return this.getTotalLength()+" "+this.getTotalLength()},"stroke-dashoffset":function(){return this.getTotalLength()}}).transition().duration(duration).ease(easingType).style("stroke-dashoffset",0).on("end",function(){resetDashProp(d3_select(this))})}(pathEnter,easingType,transitionDuration):pathEnter.transition().duration(transitionDuration).ease(easingType).attrTween("d",function(){var interpolate=d3_interpolate(line[i](baseData),line[i](serData));return function(t){return interpolate(t)}}));var pathUpdate=pathEnter.merge(path).datum(serData,function(d){return dataset.getX(d)}).attrs({id:"line_"+index,"stroke-dasharray":strokeDashArray}).styles({"stroke-linecap":strokeLineCap,"stroke-width":strokeWidth,"stroke-opacity":validateNullVal(strokeOpacity,1),fill:NONE,stroke:strokeColor(index,NULL,gvp("strokeColor")||color,NULL,strokeOpacity,i)}),dataUpdate=serData;if(null!=shiftInfo){var transX=null!=shiftInfo?Math.abs(chartObj.dataObject.getXYvalue(axisrotated,stacked,chart.oldXscale,yscale,yaxiscolumnorder,serData[0],"x",null,yrangePos)-chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[0],"x",null,yrangePos)):null;path.datum(dataUpdate).attr("d",line[i]).transition().duration(transitionDuration).ease(easingType).attr("transform",function(){return null==transX?null:"translate(-"+transX+",0)"}),resetDashProp(path)}else null==pathEnter.node()&&(path.datum(dataUpdate).attr("transform",null).transition().duration(transitionDuration).ease(easingType).attr("d",line[i]),resetDashProp(path));var mID=markerEnabled&&!callScatterRenderer?"url("+defsLocation+"#"+markerID+")":NULL,markerPosition=markeroptions.position,markerProperties=markerPosition?{"marker-start":markerPosition.indexOf(START_ALIGN)>-1?mID:NULL,"marker-mid":markerPosition.indexOf(MIDDLE_ALIGN)>-1?mID:NULL,"marker-end":markerPosition.indexOf(END_ALIGN)>-1?mID:NULL}:{marker:mID};pathUpdate.styles(markerProperties),pathEnter.exit().remove()}),!callScatterRenderer||!markerEnabled){var markerSize=markerEnabled?(markeroptions.size||strokeWidth)*mSize.outer*10+strokeWidth/2:0;labelQueue.push({renderer:chart,charttype:"scatter",chartObj:chartObj,args:[currentdata,index,markerSize,yrangePos]})}}),chart.renderedTimer=setTimeout(function(){marqueeEnabled&&function applyMarquee(element,dur,strokeDashArray,chart){var dashoffset=strokeDashArray.reduce(function(prev,current){return current+prev},0);element.attr("stroke-dasharray",strokeDashArray).attr("stroke-dashoffset",dashoffset).transition().duration(dur).ease(d3_ease_linear).attr("stroke-dashoffset",0).on("end",function(){chart&&chart.chartRendered&&applyMarquee(element,dur,strokeDashArray,chart)})}(series.selectAll("#line_"+index),marqueeDuration,strokeDashArray,chart),chart.chartRendered=!0,redraw=!0},redraw?2*transitionDuration+20:transitionDuration+20),chart.oldXscale=xscale,chart}function resetDashProp(path){path.styles({"stroke-dasharray":strokeDashArray,"stroke-dashoffset":null})}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.shiftInfo=function(_){return arguments.length?(shiftInfo=_,chart):shiftInfo},chart.yrangePos=function(_){return arguments.length?(yrangePos=_,chart):yrangePos},chart},svg_plot_renderer.area=function(){var commonRendererProp,xscale,yscale,dataset,yaxiscolumnorder,color,labelQueue,commonPlotOptions,systemconf,hasNegValue,chartObj,transitionDuration,shiftInfo,shiftDiff,index=0,stacked=!1,axisrotated=!1,redraw=!1,line=svg_plot_renderer.line(),area=[],dataProcessorHelpers=DataProcessor.helpers;function chart(selection){return selection.each(function(data){var rp=commonRendererProp.params;chartObj=rp.chartObj,xscale=rp.xscale,yscale=rp.yscale,stacked=rp.stacked,index=rp.datasetIndex,axisrotated=rp.axisrotated,commonPlotOptions=rp.commonPlotOptions,color=rp.color,labelQueue=rp.labelQueue,hasNegValue=rp.hasNegValue,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,systemconf=chartObj.systemConf;var renderingOrder=rp.renderingOrderIndex,defsLocation=chartObj.defsLocation,isPolar=chartObj.dataObject.isPolarAxisCategory,currentdata=data[index],data_bind={data:currentdata,index:renderingOrder},plotoptions=currentdata.plotoptions,currentseriesdata=currentdata.data,cType=chartObj.chartTypes[index].name,gvp=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions),fillOpacity=gvp("fillOpacity"),strokeWidth=gvp("strokeWidth"),strokeColor=gvp("strokeColor"),markerEnabled=colorscale_helpers.isQuantileColorScale(chartObj)||(defined(plotoptions)?utils.getValueOfPlotOptions(plotoptions.marker,commonPlotOptions.marker)("enabled"):commonPlotOptions.marker.enabled),borderEnabled=null!=strokeWidth&&""!=strokeWidth&&0!=pInt(strokeWidth)||null!=strokeColor&&""!=strokeColor||markerEnabled,animationOptions=getAnimationConf(commonPlotOptions,plotoptions,chartObj,cType),isAnimationEnable=animationOptions.enabled,easingType=animationOptions.easingType,animationType=animationOptions.type;transitionDuration=animationOptions.duration,animationType=animationType==VERTPATHTWEENALL_ANIMATION?VERTPATHTWEEN_ANIMATION:animationType;var datatypeX=chartObj.dataset.getDataType("x"),datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder),xCategories=datatypeX==ORDINAL_DATATYPE?xscale.domain():null,yCategories=datatypeY==ORDINAL_DATATYPE?yscale.domain():null,categories=datatypeX!=ORDINAL_DATATYPE||defined(chartObj.dataObject.hierarchical)?chartObj.dataObject.getCategories("x"):xCategories,yReversed=systemconf.chart.axes.yaxis[yaxiscolumnorder].reversed;datatypeX!=ORDINAL_DATATYPE&&0==categories.length&&isAnimationEnable&&animationType==POINTTWEEN_ANIMATION&&(categories=chartObj.dataObject.findXCategories());var isRangeChart="arearange"==cType,yrangePos=isRangeChart?1:null;chart.seriesdataAfterUpdate=[],currentseriesdata.forEach(function(d,i){var serData;if(serData=datatypeX==ORDINAL_DATATYPE||datatypeY==ORDINAL_DATATYPE?chartObj.dataObject.updateSeriesdatabyCategories(d3_values(d),xCategories,yCategories,yaxiscolumnorder):d,chartObj.brush&&chartObj.brush.extent){var domain=chartObj.axes.x.scale.domain(),ticks=chartObj.axes.x.ticks.tickValueObj.ticks,startVal=datatypeX==TIME_DATATYPE?ticks[0].getTime():datatypeX==ORDINAL_DATATYPE?categories.indexOf(domain[0]):domain[0],endVal=datatypeX==TIME_DATATYPE?domain[1].getTime():datatypeX==ORDINAL_DATATYPE?categories.indexOf(domain[domain.length-1]):domain[1],accessor=datatypeX==ORDINAL_DATATYPE?function(d){return categories.indexOf(chartObj.dataset.getX(d))}:function(d){return chartObj.dataset.getX(d)};serData=dataProcessorHelpers.filterDataToViewPort(serData,startVal,endVal,accessor)}chart.seriesdataAfterUpdate[i]=serData,chartObj.systemConf.chart.axes.xaxis.reversed&&(serData=serData.slice(0).reverse()),shiftDiff=null!=shiftInfo?null==shiftDiff||0==shiftDiff?chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[serData.length-1],"x")-chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[serData.length-2],"x"):shiftDiff:0,area[i]=getAreaLayout(rp,shiftDiff,shiftInfo,serData,i)});var series,container=d3_select(this);if(chart.update=function(){container.transition().call(chart)},isPolar?((series=container.selectAll("g.areaseries_"+index).data([data_bind])).enter().insert("g",":first-child").merge(series).attr("class","areaseries_"+index),series=container.selectAll("g.areaseries_"+index)):series=appendEle(container,"g",[data_bind],".","class","areaseries_"+index),borderEnabled||markerEnabled){if(line.commonRendererProp(commonRendererProp).shiftInfo(shiftInfo),line.chartRendered=!1,isRangeChart){line.yrangePos(1);var baseLine=svg_plot_renderer.line().commonRendererProp(commonRendererProp).shiftInfo(shiftInfo).yrangePos(0);baseLine.chartRendered=!1,container.call(baseLine)}container.call(line)}else container.selectAll("g.lineseries_"+index+",g.scatterseries_"+index).remove();currentseriesdata.forEach(function(d,i){var basedataShift,serData=chart.seriesdataAfterUpdate[i],baseData=serData;if(isAnimationEnable){if(animationType==POINTTWEEN_ANIMATION)baseData=serData.map(function(d,i){return Object.create(serData[0])});else{var idx=animationType==HORIPATHTWEEN_ANIMATION?dataset.xidx:dataset.yidx(yaxiscolumnorder),scaleObj=animationType==HORIPATHTWEEN_ANIMATION?xscale:yscale,baseIdx=isPolar&&yReversed&&!stacked?scaleObj.domain().length-1:0;baseData=serData.map(function(d,i){var s=Object.create(d);if(stacked&&animationType!=HORIPATHTWEEN_ANIMATION)s.y0=isPolar&&animationType===STROKETWEEN_ANIMATION?mathMin(0,scaleObj.domain()[0]):0,s.y=isPolar||null==hasNegValue||null==scaleObj(hasNegValue)?scaleObj.domain()[0]:mathMax(hasNegValue,scaleObj.domain()[0]);else if(isRangeChart&&animationType==VERTPATHTWEEN_ANIMATION){var yArr=new Array(2),y0=chartObj.dataset.getY(d,yaxiscolumnorder,0);yArr[0]=y0,yArr[1]=null==s[idx]?null:null!=hasNegValue&&null!=scaleObj(hasNegValue)?mathMax(hasNegValue,y0):y0,s[idx]=yArr}else s[idx]=null==s[idx]?null:isPolar||null==hasNegValue||null==scaleObj(hasNegValue)?scaleObj.domain()[baseIdx]:mathMax(hasNegValue,scaleObj.domain()[0]);return s})}basedataShift=d3_values(baseData)}var ishideable=currentdata.disabled,path=appendEle(series,"g",function(d){return ishideable?[]:[d]},".","class","subseries_"+i).selectAll("path.area").data(function(d){return ishideable?[]:[d]}),pathEnter=path.enter().append("path").datum(baseData,function(d){return dataset.getX(d)}).attr("class","area").style("opacity",fillOpacity).style("fill",color).attr("d",area[i]);isAnimationEnable&&(animationType==POINTBYPOINT_ANIMATION||animationType==POINTTWEEN_ANIMATION?interTween(baseData,basedataShift,serData,categories,animationType,easingType,transitionDuration,rp,function(d){return{d:area[i](d)}},pathEnter):null!=pathEnter.node()&&animationType==STROKETWEEN_ANIMATION?pathEnter.transition().duration(0).delay(transitionDuration).attr("d",function(d){return area[i](d)}):pathEnter.transition().duration(transitionDuration).ease(easingType).attrTween("d",function(){var interpolate=d3_interpolate(area[i](baseData),area[i](serData));return function(t){return interpolate(t)}}));var gradientDim=gradient_helpers.getDimension(chartObj,index),fillColor=chart.fillColorFunc=getFillColor(chartObj,index,gradientDim);if(null!=shiftInfo&&redraw){var clipX=xscale(serData[0][0])+(null!=xscale.bandwidth?xscale.bandwidth()/2:0),clipWid=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[serData.length-1],"x")-chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[0],"x"),properties={name:"rect",id:chartObj.id,x:clipX,y:0,width:clipWid,height:chartObj.plotarea.height},args={chartObj:chartObj},clipID=effects.get(effects.svg_clips,"rect",properties,args);series.attr("clip-path","url("+defsLocation+"#"+clipID+")")}var dataUpdate=serData,pathUpdate=pathEnter.merge(path).datum(serData,function(d){return dataset.getX(d)}).styles({opacity:fillOpacity,fill:fillColor(index,null,null,color,NULL,NULL,NULL,NULL,i)});if(null!=shiftInfo){var transX=null!=shiftInfo?Math.abs(chartObj.dataObject.getXYvalue(axisrotated,stacked,chart.oldXscale,yscale,yaxiscolumnorder,serData[0],"x",null,yrangePos)-chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[0],"x",null,yrangePos)):null;path.datum(dataUpdate).attr("d",area[i]).attr("transform",null).transition().duration(transitionDuration).ease(easingType).attr("transform",function(){return null==transX?null:"translate(-"+transX+",0)"})}else null!=pathEnter.node()&&animationType==STROKETWEEN_ANIMATION?pathUpdate.datum(dataUpdate).style("fill-opacity",0).transition().duration(0).delay(transitionDuration).attr("d",area[i]).style("fill-opacity",null):pathUpdate.datum(dataUpdate).style("fill-opacity",null).transition().delay(animationType!=POINTBYPOINT_ANIMATION&&animationType!=POINTTWEEN_ANIMATION||null==pathEnter.node()?0:transitionDuration).duration(transitionDuration).ease(easingType).attr("d",area[i]);path.exit().remove()}),borderEnabled||markerEnabled||(isRangeChart?(labelQueue.push({renderer:chart,charttype:"scatter",chartObj:chartObj,args:[currentdata,index,0,1]}),labelQueue.push({renderer:chart,charttype:"scatter",chartObj:chartObj,args:[currentdata,index,0,0]})):labelQueue.push({renderer:chart,charttype:"scatter",chartObj:chartObj,args:[currentdata,index,0]}))}),chart.renderedTimer=setTimeout(function(){chart.chartRendered=!0,redraw=!0},transitionDuration),chart.oldXscale=xscale,chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.shiftInfo=function(_){return arguments.length?(shiftInfo=_,chart):shiftInfo},chart},svg_plot_renderer.scatter=function(){var chartObj,xscale,yscale,index,yaxiscolumnorder,color,stacked,dataset,axisrotated,labelQueue,commonPlotOptions,systemconf,hasNegValue,transitionDuration,shiftInfo,commonRendererProp,yrangePos,redraw=!1,dataProcessorHelpers=DataProcessor.helpers;function chart(selection){return selection.each(function(data){var rp=commonRendererProp.params;chartObj=rp.chartObj,xscale=rp.xscale,yscale=rp.yscale,stacked=rp.stacked,index=rp.datasetIndex,axisrotated=rp.axisrotated,commonPlotOptions=rp.commonPlotOptions,color=rp.color,labelQueue=rp.labelQueue,hasNegValue=rp.hasNegValue,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,systemconf=chartObj.systemConf;var renderingOrder=rp.renderingOrderIndex,defsLocation=chartObj.defsLocation,xReversed=systemconf.chart.axes.xaxis.reversed,yReversed=systemconf.chart.axes.yaxis[yaxiscolumnorder].reversed,container=d3_select(this);chart.update=function(){container.transition().call(chart)};var currentdata=data[index],data_bind={data:currentdata,index:renderingOrder},plotoptions=currentdata.plotoptions,cType=chartObj.chartTypes[index].value,chartName=chartObj.chartTypes[index].name,isBubbleChart=chartcategory.bubble.has(cType),scatterOrBubble=isScatterChartType(cType),isPolar=chartObj.dataObject.isPolarAxisCategory,currentseriesdata=currentdata.data,series=appendEle(container,"g",[data_bind],".","class","scatterseries_"+index);"arearange"===chartName&&(series=appendEle(series,"g",[data_bind],".","class","rangePos_"+yrangePos));var animationOptions=getAnimationConf(commonPlotOptions,plotoptions,chartObj,chartName),isAnimationEnable=animationOptions.enabled,easingType=animationOptions.easingType,animationType=animationOptions.type;transitionDuration=animationOptions.duration;var markerOptions=plotoptions&&plotoptions.marker?mergeJSON(commonPlotOptions.marker,plotoptions.marker,!0):commonPlotOptions.marker,symboltype=markerOptions.symbol,symbolsize=markerOptions.size,imageUrl=markerOptions.imageUrl,markerPosition=markerOptions.position;scatterOrBubble?(symbolsize=validateNullVal(symbolsize,1),animationType=animationType==FADEALL_ANIMATION?FADE_ANIMATION:animationType):(isUndefined(symbolsize)&&(symbolsize=(plotoptions?utils.getValueOfPlotOptions(plotoptions,commonPlotOptions)("strokeWidth"):commonPlotOptions.strokeWidth)||2),imageUrl||(symbolsize*=isPolar?.56:.7),animationType=(animationType=animationType==VERTPATHTWEEN_ANIMATION||animationType==VERTPATHTWEENALL_ANIMATION?VERTICALALL_ANIMATION:animationType)==HORIPATHTWEEN_ANIMATION?HORIZONTALALL_ANIMATION:animationType,color=currentdata.color||color);var symbolpath=getSVGsymbol(symboltype),multiColoring=!!scatterOrBubble&&isMultiColoring(commonPlotOptions,chartObj),outersize=10*symbolsize,initial_outerFillOpacity=animationType==FADE_ANIMATION?0:markerOptions.outerFillOpacity,initial_outerStrokeOpacity=animationType==FADE_ANIMATION?0:markerOptions.outerStrokeOpacity,initial_innerFillOpacity=animationType==FADE_ANIMATION?0:markerOptions.innerFillOpacity,initial_innerStrokeOpacity=animationType==FADE_ANIMATION?0:markerOptions.innerStrokeOpacity,imageConf={name:markerOptions.imageUrl},outerDashArray=getDashArray(markerOptions.outerDashStyle,markerOptions.outerStrokeWidth),innerDashArray=getDashArray(markerOptions.innerDashStyle,markerOptions.innerStrokeWidth),outerStrokeLineCap=getLineCap(markerOptions.outerLineCap,markerOptions.outerDashStyle),innerStrokeLineCap=getLineCap(markerOptions.innerLineCap,markerOptions.innerDashStyle),visibility=colorscale_helpers.isQuantileColorScale(chartObj)&&!1===markerOptions.enabled?"hidden":NULL,fillColor=chart.fillColorFunc=getFillColor(chartObj,index,null,!scatterOrBubble||null),strokeColor=getStrokeColor(chartObj,index);chart.seriesdataAfterUpdate=[];var datatypeX=chartObj.dataset.getDataType("x"),datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder),isCatNullX=dataProcessorHelpers.isCatNull(dataset,"x"),isCatNullY=dataProcessorHelpers.isCatNull(dataset,"y",yaxiscolumnorder),xCategories=datatypeX==ORDINAL_DATATYPE?xscale.domain():null,yCategories=datatypeY==ORDINAL_DATATYPE?yscale.domain():null,categories=datatypeX!=ORDINAL_DATATYPE||null==xscale.domain||defined(chartObj.dataObject.hierarchical)?chartObj.dataObject.getCategories("x"):xCategories;if(currentseriesdata.forEach(function(d,i){var dataUpdate;if(dataUpdate=datatypeX==ORDINAL_DATATYPE||datatypeY==ORDINAL_DATATYPE?chartObj.dataObject.updateSeriesdatabyCategories(d3_values(d),xCategories,yCategories,yaxiscolumnorder):d,chartObj.brush&&chartObj.brush.extent){var domain=chartObj.axes.x.scale.domain(),startVal=(chartObj.axes.x.ticks.tickValueObj.ticks,datatypeX==TIME_DATATYPE?domain[0].getTime():datatypeX==ORDINAL_DATATYPE?categories.indexOf(domain[0]):domain[0]),endVal=datatypeX==TIME_DATATYPE?domain[1].getTime():datatypeX==ORDINAL_DATATYPE?categories.indexOf(domain[domain.length-1]):domain[1],accessor=datatypeX==ORDINAL_DATATYPE?function(d){return categories.indexOf(chartObj.dataset.getX(d))}:function(d){return chartObj.dataset.getX(d)};dataUpdate=dataProcessorHelpers.filterDataToViewPort(dataUpdate,startVal,endVal,accessor)}chart.seriesdataAfterUpdate[i]=dataUpdate;var serData,baseData,basedataShift,ishideable=currentdata.disabled;if(animationType==POINTBYPOINT_ANIMATION||animationType==POINTTWEEN_ANIMATION){if(serData=dataUpdate,xReversed&&(serData=serData.slice(0).reverse()),baseData=serData,animationType==POINTTWEEN_ANIMATION)baseData=serData.map(function(d,i){return Object.create(serData[0])});else if(animationType==POINTBYPOINT_ANIMATION){var baseIdx=isPolar&&yReversed&&!stacked?yscale.domain().length-1:0;baseData=serData.map(function(d,i){var s=Object.create(d),baseY=isPolar||null==hasNegValue||null==yscale(hasNegValue)?yscale.domain()[baseIdx]:mathMax(hasNegValue,yscale.domain()[0]);return stacked&&(s.y0=0,s.y=baseY),s[dataset.yidx(yaxiscolumnorder)]=baseY,s})}basedataShift=d3_values(baseData)}var scatter=appendEle(series,"g",function(d){return ishideable?[]:[dataUpdate]},".","class","subseries_"+i).selectAll("g.scatter").data(function(d){return d}).attr("class","scatter"),scatterEnter=scatter.enter().append("g").attr("class","scatter"),noScatters=scatterEnter.size(),duration=animationType!=ONEBYONE_ANIMATION?transitionDuration:transitionDuration/noScatters,pathData=function(d,i){return(!isPolar||d&&!d.isDummy)&&(isPolar||cType===charttype.stkdarea||d&&!d.isDummy&&!isCatNullX(dataset.getX(d))&&!isCatNullY(dataset.getY(d,yaxiscolumnorder)))?[{color:multiColoring?chartObj.seriesColor[i%chartObj.seriesColor.length]:color,index:multiColoring?i:index,data:d}]:[]};isAnimationEnable&&(animationType==POINTBYPOINT_ANIMATION||animationType==POINTTWEEN_ANIMATION?interTween(baseData,basedataShift,serData,categories,animationType,easingType,transitionDuration,rp,function(d){return{transform:function(dt,i){return"translate("+getInitialX(d[i])+","+getInitialY(d[i])+")"}}},scatterEnter,"scatter"):scatterEnter.attr("transform",function(d,i){return"translate("+getInitialX(d)+","+getInitialY(d)+")"+(imageUrl&&animationType===SIZING_ANIMATION?" scale(0)":"")}).transition().delay(function(d,i){return animationType==ONEBYONE_ANIMATION?i*duration:0}).duration(duration).ease(easingType).attr("transform",function(d){return"translate("+chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x",null,yrangePos)+","+chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y",null,yrangePos)+")"}));var scatterUpdate=scatterEnter.merge(scatter);appendEle(scatterEnter,"path",pathData,".","class","outer").styles({"fill-opacity":initial_outerFillOpacity,"stroke-opacity":initial_outerStrokeOpacity,visibility:visibility});var innerPathData=pathData;(imageUrl||0===markerOptions.innerStrokeWidth&&(0===markerOptions.innerFillOpacity||"transparent"===markerOptions.innerFillColor))&&(innerPathData=[]),appendEle(scatterUpdate,"path",innerPathData,".","class","inner").styles({"fill-opacity":initial_innerFillOpacity,"stroke-opacity":initial_innerStrokeOpacity,visibility:visibility}),redraw&&imageUrl&&scatterUpdate.attr("transform",function(d){return d3_select(this).attr("transform")+" scale("+d3_select(this).attr("size")/getSymbolSize(d)+")"}),scatterUpdate.style("visibility",function(d,i){if(!markerPosition)return NULL;var position=0===i?START_ALIGN:i===dataUpdate.length-1?END_ALIGN:MIDDLE_ALIGN;return markerPosition.indexOf(position)>-1?NULL:"hidden"}).transition().delay(function(d,i){return animationType!=POINTBYPOINT_ANIMATION&&animationType!=POINTTWEEN_ANIMATION||null==scatterEnter.node()?animationType==ONEBYONE_ANIMATION?i*duration:0:transitionDuration}).duration(duration).ease(easingType).attr("transform",function(d){return"translate("+chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x",null,yrangePos)+","+chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y",null,yrangePos)+")"}).attr("level",function(d,i){if(defined(chartObj.dataObject.hierarchical))return d.level}).styles({transition:"opacity ease .2s",opacity:function(d,i){if(defined(chartObj.dataObject.hierarchical)&&defined(chartObj.cache.hierarchical)&&chartObj.cache.hierarchical.active)return!0===d.active?1:.1}});var pathDuration=animationType===SIZINGRANDOM_ANIMATION?2*transitionDuration/5:duration,pathDelay=animationType===SIZINGRANDOM_ANIMATION?function(){return mathRandom()*(3*transitionDuration/5)}:0,outermarkerpathUpdate=scatterUpdate.selectAll("path.outer").attr("d",function(d,i){var previousSize=d3_select(this.parentNode).attr("size"),size=getSymbolSize(d.data);return symbolpath(null!=previousSize?imageUrl?size:previousSize:animationType!=SIZING_ANIMATION&&animationType!==SIZINGRANDOM_ANIMATION||imageUrl?size:0)}).styles({"stroke-width":markerOptions.outerStrokeWidth,fill:function(d,i){var size=getSymbolSize(d.data);if(imageUrl)return imageConf.width=imageConf.height=parseFloat(size),imageConf.x=imageConf.y=-parseFloat(size)/2,"url("+defsLocation+"#"+effects.get(effects.svg_patterns,"imageFill",imageConf,{chartObj:chartObj})+")";var radius=size/2;return fillColor(d.index,d.data,null,markerOptions.outerFillColor,null,scatterOrBubble?[radius,radius]:null)},stroke:function(d,i){return strokeColor(d.index,d.data,markerOptions.outerStrokeColor)},"stroke-dasharray":outerDashArray,"stroke-linecap":outerStrokeLineCap,visibility:visibility}),innermarkerpathUpdate=scatterUpdate.selectAll("path.inner").attr("d",function(d,i){var previousSize=d3_select(this.parentNode).attr("size"),s=null!=previousSize?previousSize:animationType!=SIZING_ANIMATION&&animationType!==SIZINGRANDOM_ANIMATION||imageUrl?getSymbolSize(d.data):0;return symbolpath(s/2,"inner")}).styles({"stroke-width":markerOptions.innerStrokeWidth,fill:function(d,i){var radius=getSymbolSize(d.data)/4;return fillColor(d.index,d.data,null,markerOptions.innerFillColor,null,scatterOrBubble?[radius,radius]:null)},stroke:function(d,i){return strokeColor(d.index,d.data,markerOptions.innerStrokeColor)},"stroke-dasharray":innerDashArray,"stroke-linecap":innerStrokeLineCap,visibility:visibility});outermarkerpathUpdate.transition().delay(pathDelay).duration(pathDuration).ease(easingType).attr("d",function(d){return symbolpath(getSymbolSize(d.data))}).styles({"fill-opacity":markerOptions.outerFillOpacity,"stroke-opacity":markerOptions.outerStrokeOpacity}),innermarkerpathUpdate.transition().delay(pathDelay).duration(pathDuration).ease(easingType).attr("d",function(d){return symbolpath(getSymbolSize(d.data)/2,"inner")}).styles({"fill-opacity":markerOptions.innerFillOpacity,"stroke-opacity":markerOptions.innerStrokeOpacity});var blinkConf=(plotoptions&&plotoptions.animation&&plotoptions.animation.blink?mergeJSON(commonPlotOptions.animation.blink,plotoptions.animation.blink,!0):commonPlotOptions.animation.blink)||{};function getInitialX(d){switch(animationType){case VERTICALALL_ANIMATION:var baseX=null!=hasNegValue&&null!=yscale(hasNegValue)?yscale(mathMax(hasNegValue,yscale.domain()[0])):yscale.origRange[0];return axisrotated?baseX:chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x",null,yrangePos);case HORIZONTALALL_ANIMATION:baseX=(null!=hasNegValue&&null!=xscale(hasNegValue)?xscale(mathMax(hasNegValue,xscale.domain()[0])):xscale.origRange[0])+(null!=xscale.bandwidth?xscale.bandwidth()/2:0);return axisrotated?chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x",null,yrangePos):baseX;case FADE_ANIMATION:case SIZING_ANIMATION:case SIZINGRANDOM_ANIMATION:case POINTTWEEN_ANIMATION:case POINTBYPOINT_ANIMATION:case STROKETWEEN_ANIMATION:return chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x",null,yrangePos);default:var range=(axisrotated?yscale:xscale).origRange;return range[axisrotated&&yReversed||!axisrotated&&xReversed?range.length-1:0]}}function getInitialY(d){switch(animationType){case VERTICALALL_ANIMATION:var baseY=null!=hasNegValue&&null!=yscale(hasNegValue)?yscale(mathMax(hasNegValue,yscale.domain()[0])):yscale.origRange[0];return axisrotated?chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y",null,yrangePos):baseY;case HORIZONTALALL_ANIMATION:var baseX=(null!=hasNegValue&&null!=xscale(hasNegValue)?xscale(mathMax(hasNegValue,xscale.domain()[0])):xscale.origRange[0])+(null!=xscale.bandwidth?xscale.bandwidth()/2:0);return axisrotated?baseX:chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y",null,yrangePos);case FADE_ANIMATION:case SIZING_ANIMATION:case SIZINGRANDOM_ANIMATION:case POINTTWEEN_ANIMATION:case POINTBYPOINT_ANIMATION:case STROKETWEEN_ANIMATION:return chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y",null,yrangePos);default:var range=(axisrotated?xscale:yscale).origRange;return range[axisrotated&&xReversed||!axisrotated&&yReversed?range.length-1:0]}}function getSymbolSize(d){return(!isPolar||d&&!d.isDummy)&&(isPolar||cType===charttype.stkdarea||!isCatNullX(dataset.getX(d))&&!isCatNullY(dataset.getY(d,yaxiscolumnorder)))?isBubbleChart?chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"z",chartObj.zscale,yrangePos):outersize:0}blinkSVGsymbols(scatterUpdate.selectAll(".outer,.inner"),blinkConf,chartObj),scatterUpdate.attr("size",function(d){return getSymbolSize(d)}),scatter.exit().remove(),chart.getSymbolSize=getSymbolSize,chart.getSymbolBBox=function(d){var size=getSymbolSize(d);return size>0&&("line"==symboltype||"vertical-line"==symboltype)?"line"==symboltype?{width:size,height:strokeWidth||1}:"vertical-line"==symboltype?{height:strokeWidth||1,width:size}:void 0:null}}),null!=labelRenderer){var markerSize;if(scatterOrBubble||isBubbleChart)markerSize=outersize+markerOptions.outerStrokeWidth;else{var strokeWidth=validateNullVal(utils.getValueOfPlotOptions(plotoptions,commonPlotOptions)("strokeWidth"),2);markerSize=(markerOptions.size||strokeWidth)*outersize*.5+strokeWidth/2}labelQueue.push({renderer:chart,charttype:"scatter",chartObj:chartObj,args:[currentdata,index,markerSize,yrangePos]})}chart.renderedTimer=setTimeout(function(){redraw=!0,chart.chartRendered=!0},transitionDuration)}),chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.shiftInfo=function(_){return arguments.length?(shiftInfo=_,chart):shiftInfo},chart.yrangePos=function(_){return arguments.length?(yrangePos=_,chart):yrangePos},chart},svg_plot_renderer.pie=function(){var InsidelabelTextGroup,labelLinkGroup,labelTextGroup,innerBoundBoxGroup,boundBoxGroup,hasNegValue,hasPreviousNegValue,gElementsCollected,hasBoundBox,previousRadiusFactors,previousInnerRadius,previousOuterRadius,baseValue,commonRendererProp,chartObj,outerRadius,innerRadius,totalEngagement,color,container,piegroup,chartheight,chartwidth,pieArcs,oldData,arcLabel,commonPlotOptions,notesArray,isDial,rad,OR,strokeWid,noofNonZeroDatas,sliceOutHeight,modelOptions,transX,transY,customPlotarea,plotarea,dataindex,MAXWIDTH_DATALABELS=.3,pie=d3_pie().sort(null),arc=d3_arc(),isredraw=!1;function chart(selection){return selection.each(function(data){var rp=commonRendererProp.params;chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,color=rp.color,notesArray=rp.notesArray,chartObj.systemConf;var labelQueue=rp.labelQueue,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,index=rp.datasetIndex||0,defsLocation=chartObj.defsLocation,serData=chartObj.seriesdata[index],currentRadiusFactors=commonPlotOptions.maxRadius+" _ "+commonPlotOptions.outerPadding+" _ "+commonPlotOptions.innerRadius,chartName=chartObj.chartTypes[index].name,isPie=chartName===PIE_CHARTNAME,isBubblePie=!(isDial=chartName===DIAL_CHARTNAME)&&!isPie;dataindex=isBubblePie?validateNullVal(commonPlotOptions.dataindex,3):dataset.yidx(yaxiscolumnorder),plotarea=customPlotarea||(isDial?chartObj.plotarea_approx:chartObj.plotarea),chartwidth=plotarea.width,chartheight=plotarea.height,outerRadius=validateNullVal(plotarea.radius,mathMin(chartwidth,chartheight)/2),gElementsCollected=!1;var visibility,plotoptions=serData.plotoptions,dataLabels=commonPlotOptions.datalabels,gvp=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions),maxRadius=validateNullVal(gvp("maxRadius"),250),levelMarkerConf=commonPlotOptions.levelMarker,padding=isPie?+gvp("outerPadding"):0,strokeWidth=gvp("strokeWidth");baseValue=void 0!==commonPlotOptions.baseValue?commonPlotOptions.baseValue:0;var showlabel=chartObj.datalabels.moduleExists&&isDatalabelEnabled(dataLabels,chartObj),datalabelPadding=showlabel?+(dataLabels.padding||0)+(isBoundBoxEnabled(dataLabels,chartObj)?2*(getBoundBoxPadding(dataLabels,chartObj)+getBoundBoxStrokeWidth(dataLabels,chartObj)):0):0,extraOptions={},datalabelsWidth=0;if(hasBoundBox=chartObj.datalabels.moduleExists&&isBoundBoxEnabled(dataLabels,chartObj),rad=mathMin(maxRadius,outerRadius-(padding+=isPie?datalabelPadding:0)),isPie&&showlabel){var minDatalabelsWidth=chartwidth*MAXWIDTH_DATALABELS,availableDatalabelsWidth=chartwidth-2*rad;availableDatalabelsWidth<minDatalabelsWidth&&(datalabelPadding=extraOptions.padding=5,datalabelsWidth=mathMax(minDatalabelsWidth-availableDatalabelsWidth,0),rad-=datalabelsWidth/2)}if(innerRadius=getInnerRadius(commonPlotOptions,rad),strokeWidth=validateNullVal(strokeWidth,1),isDial&&levelMarkerConf.enabled){var innerPadding,outerPadding;if(defined(commonPlotOptions.bandWidth)||defined(commonPlotOptions.maxBandWidth)){var maxDialBandWidth=validateNullVal(commonPlotOptions.maxBandWidth,rad),dialBandWidth=mathMin(perToPx(commonPlotOptions.bandWidth,rad,rad-innerRadius),maxDialBandWidth);innerPadding=-(rad-innerRadius-dialBandWidth)/2,outerPadding=-(rad-innerRadius-dialBandWidth)/2,visibility=0===dialBandWidth?"hidden":null}else innerPadding=mathMin(0,perToPx(levelMarkerConf.innerPadding,outerRadius,0)),outerPadding=mathMin(0,perToPx(levelMarkerConf.outerPadding,outerRadius,0));rad+=outerPadding,innerRadius-=innerPadding}OR=mathMax(innerRadius,rad-=.5*strokeWidth),modelOptions=(plotoptions&&plotoptions.models?mergeJSON(commonPlotOptions.models,plotoptions.models,!0):commonPlotOptions.models)||{};var animationOptions=getAnimationConf(commonPlotOptions,plotoptions,chartObj,chartName),transitionDuration=animationOptions.enabled?isredraw?200:animationOptions.duration:0,easingType=isredraw?d3_ease_linear:animationOptions.easingType,animationType=animationOptions.type,eventDisabled=0==validateNullVal(getEventConf(plotoptions,commonPlotOptions,chartObj,"enabled"),!0),cursor=eventDisabled?null:getEventConf(plotoptions,commonPlotOptions,chartObj,"cursor")||POINTER;container=d3_select(this),(piegroup=appendEle(container,"g",[data],".","class","piegroup")).styles({"stroke-width":strokeWidth,"fill-opacity":gvp("fillOpacity"),"stroke-opacity":commonPlotOptions.strokeOpacity,cursor:cursor,visibility:visibility}),pie.startAngle(commonPlotOptions.startAngle).endAngle(commonPlotOptions.endAngle).value(function(d){return d.disabled?0:mathAbs(d[dataindex]||0)});var pieData=pie(data=isBubblePie?data:serData.data[0]);chart.data=pieData,noofNonZeroDatas=pieData.reduce(function(prev,cur,i){return prev+(cur.value?1:0)},0),chart.total=totalEngagement=pieData.reduce(function(prev,cur,i){return prev+cur.value},0),chart.arc=arc,arc.outerRadius(OR).innerRadius(innerRadius),arcLabel=d3_arc().innerRadius(OR).outerRadius(OR+datalabelPadding);var arcLabel1=d3_arc().innerRadius(OR).outerRadius(OR);strokeWid=strokeWidth;var bb=translateWrap(piegroup),heightPercent=(bb.height+strokeWidth)/rad,widthPercent=(bb.width+strokeWidth)/rad,newrad=rad+mathMin((chartwidth-2*padding-datalabelsWidth-(bb.width+strokeWidth))/widthPercent,(chartheight-2*padding-datalabelsWidth-(bb.height+strokeWidth))/heightPercent);if(newrad=mathMin(maxRadius,mathMax(rad,newrad)),isDial){currentRadiusFactors+=" _ "+commonPlotOptions.bandWidth+" _ "+levelMarkerConf.bandWidth+" _ "+levelMarkerConf.innerPadding+" _ "+levelMarkerConf.outerPadding;var yscale=chartObj.axes.y.groups[0].scale,minMax=yscale.domain();pieData.forEach(function(d){var val=d.data[dataindex];hasPreviousNegValue=hasNegValue,(hasNegValue=val<0)?(d.startAngle=yscale(null!=baseValue?Math.min(baseValue,minMax[1]):minMax[1]),d.endAngle=yscale(Math.max(val,minMax[0]))):(d.startAngle=yscale(null!=baseValue?Math.max(baseValue,minMax[0]):minMax[0]),d.endAngle=yscale(Math.min(d.value,minMax[1])))})}else newrad!=rad&&(innerRadius=getInnerRadius(commonPlotOptions,rad=newrad),OR=mathMax(innerRadius,rad),arc.outerRadius(OR).innerRadius(innerRadius),arcLabel=d3_arc().innerRadius(OR).outerRadius(OR+datalabelPadding),arcLabel1=d3_arc().innerRadius(OR).outerRadius(OR),translateWrap(piegroup));var gearPath,properties,args,modelID=!isDial&&modelOptions.type?"url("+defsLocation+"#"+(gearPath=function(){var index=-1,count=modelOptions.count,min="zigzag"==modelOptions.type?innerRadius/5-50:"sun"==modelOptions.type?-1:-10,gearData=function(count){for(var array=[],data=[],x=0,i=0;i<count;i++)"gear1"==modelOptions.type?data.push([x++,0],[x++,1],[x++,1]):data.push([x,0],[x++,1],[x,1],[x++,0]);return array.push(data),array}(count),angleScale=d3_scaleLinear().range([0,2*mathPI]).domain([0,"gear1"==modelOptions.type?3*count:2*count]),radiusScale=d3_scaleLinear().range([innerRadius,OR]).domain([min,1]);return d3_lineRadial().curve(d3_curves("linearClosed")).radius(function(d){return radiusScale(d[1])}).angle(function(d,i){return index="gear"==modelOptions.type?i%2==0?index+1:index:"gear1"!=modelOptions.type&&i%2!=0?index+1:index,angleScale("gear1"==modelOptions.type?index++:index)})(gearData[0])}(),properties={name:"pieModels",id:chartObj.id,d:gearPath},args={chartObj:chartObj},effects.get(effects.svg_clips,"polygon",properties,args))+")":null,gradientDim=[OR,OR],fillColor=chart.fillColorFunc=getFillColor(chartObj,index,gradientDim),strokeColor=getStrokeColor(chartObj,0);if(sliceOutHeight=2*perToPx(gvp("sliceOutHeight"),rad,0),oldData=piegroup.selectAll(PATH_ELEMENT).data(),(pieArcs=appendEle(piegroup,PATH_ELEMENT,pieData)).attrs({"clip-path":modelID,id:function(d,i){return"arc_"+i}}).styles({display:"block",fill:function(d,i){return fillColor(i,d.data)},stroke:function(d,i){return strokeColor(i,d.data,commonPlotOptions.strokeColor)}}),setPointerEvents(chartObj,pieArcs,eventDisabled),!eventDisabled){var mousemove=function(d,i){var args=getEventArgs(d,i);chartObj.eventHandler.mouseMove(args)},mouseout=function(d,i){chartObj.eventHandler.mouseOut(chart,d,i)},click=function(d,i){var args=getEventArgs(d,i);chartObj.eventHandler.click(chart,d,0,i,args)},dblclick=function(d,i){var data=annotation?generateDataForAnnotation(d.data,null):d.data,coordinates=arcLabel.centroid(d),args={coordinate:coordinates=[coordinates[0]+transX,coordinates[1]+transY],data:data,basedOn:"plot"};chartObj.eventHandler.doubleclick(d,i,args)};attachevents(pieArcs,{mousemove:mousemove,mouseout:mouseout,click:click,dblclick:dblclick},{singletouchmove:mousemove,touchend:mouseout,tap:click,dbltap:dblclick},{target:"plot",touchleave:!0,chartObj:chartObj})}if(/(\D)+onebyone/.test(animationType)&&!isredraw){var isFan=animationType==FANONEBYONE_ANIMATION,duration=isFan?transitionDuration:transitionDuration/noofNonZeroDatas,prev=0;pieArcs.transition().ease(easingType).duration(function(d){return isFan?duration*(d.value/totalEngagement):duration}).delay(function(d){var dur=duration*prev;return prev+=isFan?d.value/totalEngagement:1,dur}).call(isFan?arcTween:innerTween)}else{var tweenType;tweenType=isredraw?currentRadiusFactors!=previousRadiusFactors?innerTween:fanAllTween:animationType==FANALL_ANIMATION?fanAllTween:animationType==INNER_ANIMATION?innerTween:arcTween,pieArcs.transition().duration(transitionDuration).ease(easingType).call(tweenType).on("end",function(d){var disabled=d.data.disabled||d.startAngle===d.endAngle;d3_select(this).style("display",disabled?NONE:"block")})}function getEventArgs(d,i){var ev=getEventObject(d3$1.event);return{renderer:chart,seriesPos:0,subseriesPos:0,itemPos:i,color:color[i%color.length],coordinates:[ev.pageX,ev.pageY],element:this,data:d}}chart.renderedTimer=setTimeout(function(){if(previousRadiusFactors=currentRadiusFactors,previousInnerRadius=innerRadius,previousOuterRadius=OR,isDial)chartObj.renderer[0].endFunctions();else if(pieArcs.style("display",function(d){return d.data.disabled||!d.value?NONE:null}),labelRenderer&&!isBubblePie){var translation=[transX,transY],args=[piegroup.datum(),0,pieData,OR,totalEngagement,arcLabel,arcLabel1,arc,translation,extraOptions];labelQueue.push({renderer:chart,charttype:PIE_CHARTNAME,chartObj:chartObj,args:args}),labelQueue.push({renderer:chart,charttype:"pieInnerLabels",chartObj:chartObj,args:args})}var notes=chartObj.systemConf.notes;defined(notes)&&notes.enabled&&!isBubblePie&&(notesArray=annotation.preprocessAnnotations(chartObj.seriesdata,0,function(dt,k,j){var c=arcLabel.centroid(pieData[j]);return[c[0]+transX,c[1]+transY]},notesArray,chartObj,rp)),chart.chartRendered=!0,isredraw=!0},transitionDuration+1e3/60)}),chart}function innerTween(element){arcInnerTween(element,arc,[isredraw?previousInnerRadius:innerRadius,innerRadius],[isredraw?previousOuterRadius:innerRadius,OR])}function arcTween(transition){transition.attrTween("d",function(d,i){var interpolate=d3_interpolate(d.startAngle,d.endAngle);return function(t){return d.endAngle=interpolate(t),arc(d)}})}function fanAllTween(transition){transition.attrTween("d",function(d,i){var prevEA,prevSA,od=oldData[i]||oldData[oldData.length-1];hasNegValue?(prevEA=isredraw&&od&&hasPreviousNegValue?od.endAngle:d.startAngle,prevSA=isredraw&&od&&hasPreviousNegValue?od.startAngle:d.startAngle):(prevEA=isredraw&&od&&!hasPreviousNegValue?od.endAngle:isDial?d.startAngle:commonPlotOptions.startAngle,prevSA=isredraw&&od&&!hasPreviousNegValue?oldData[i]?od.startAngle:od.endAngle:isDial?d.startAngle:commonPlotOptions.startAngle);var interpolate=d3_interpolate(prevEA,d.endAngle),interpolate1=d3_interpolate(prevSA,d.startAngle);return function(t){return d.endAngle=interpolate(t)||0,d.startAngle=interpolate1(t)||0,arc(d,i)}})}function translateWrap(wrap){var dummyData=[];dummyData[dataindex]=1;var dummy=container.append(PATH_ELEMENT).attr("d",arc(pie([dummyData])[0],chart.data.length-1)).styles({fill:NONE,stroke:NONE}),bb=bbox(dummy.node());dummy.remove();var pt=polarRefPoint(bb,chartwidth,chartheight,rad,strokeWid);return transX=isDial?plotarea.x:pt[0],transY=isDial?plotarea.y:pt[1],wrap.attr("transform",function(d,i){return"translate("+transX+","+transY+")"}),bb}function collectGroups(){InsidelabelTextGroup=InsidelabelTextGroup||chartObj.staticPaneSVG.selectAll("g."+INNERLABEL_LABELTYPE+"_0"),labelLinkGroup=labelLinkGroup||chartObj.staticPaneSVG.selectAll("g.link_0"),labelTextGroup=labelTextGroup||chartObj.staticPaneSVG.selectAll("g.label_0"),boundBoxGroup=boundBoxGroup||chartObj.staticPaneSVG.selectAll("g.boundboxseries_0"),innerBoundBoxGroup=innerBoundBoxGroup||chartObj.staticPaneSVG.selectAll("g.innerboundboxseries_0"),gElementsCollected=!0}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.plotarea=function(_){return arguments.length?(customPlotarea=_,chart):customPlotarea||plotarea},chart.innerRadius=function(_){return arguments.length?(innerRadius=_,chart):innerRadius},chart.defaultMouseOverFunc=function(d,seriesPos,itemPos){if(1!=noofNonZeroDatas){gElementsCollected||collectGroups();var pt=function(d){return polarToXY(sliceOutHeight,(d.startAngle+d.endAngle)/2)}(d),slicedPosition={transform:"translate("+pt[0]+","+pt[1]+")"};pieArcs.transition().ease(d3_ease_linear).attr("transform","translate(0,0)"),piegroup.selectAll("#arc_"+itemPos).transition().ease(d3_ease_linear).attrs(slicedPosition),InsidelabelTextGroup.selectAll("#innerlbl0_0_"+itemPos).transition().ease(d3_ease_linear).attrs(slicedPosition),hasBoundBox||labelLinkGroup.selectAll("#link0_0_"+itemPos).style("stroke-width",3*chart.lineStrokeWidth),"circular"==chart.showlabel&&(labelTextGroup.selectAll("#lbl0_0_"+itemPos).transition().ease(d3_ease_linear).attrs(slicedPosition),boundBoxGroup.selectAll("#boundboxlbl0_0_"+itemPos).transition().ease(d3_ease_linear).attrs(slicedPosition)),labelTextGroup.selectAll("#lbl0_0_"+itemPos).style("text-shadow","0 0 0 rgba(0,0,0,1)"),innerBoundBoxGroup.selectAll("#boundboxinnerlbl0_0_"+itemPos).transition().ease(d3_ease_linear).attrs(slicedPosition)}},chart.defaultMouseOutFunc=function(d,i,forceMouseOut){gElementsCollected||collectGroups();var actualPosition={transform:"translate(0,0)"};if(labelTextGroup.selectAll(TEXT_ELEMENT).style("text-shadow",null),hasBoundBox||labelLinkGroup.selectAll(PATH_ELEMENT).style("stroke-width",chart.lineStrokeWidth),!$ZCG.clickedTime&&forceMouseOut)return pieArcs.attrs(actualPosition),InsidelabelTextGroup.selectAll(TEXT_ELEMENT).attrs(actualPosition),innerBoundBoxGroup.selectAll(PATH_ELEMENT).attrs(actualPosition),void("circular"==chart.showlabel&&(labelTextGroup.selectAll(TEXT_ELEMENT).attrs(actualPosition),boundBoxGroup.selectAll(PATH_ELEMENT).attrs(actualPosition)));pieArcs.transition().ease(d3_ease_linear).attrs(actualPosition),InsidelabelTextGroup.selectAll(TEXT_ELEMENT).transition().ease(d3_ease_linear).attrs(actualPosition),"circular"==chart.showlabel&&(labelTextGroup.selectAll(TEXT_ELEMENT).transition().ease(d3_ease_linear).attrs(actualPosition),boundBoxGroup.selectAll(PATH_ELEMENT).transition().ease(d3_ease_linear).attrs(actualPosition)),innerBoundBoxGroup.selectAll(PATH_ELEMENT).transition().ease(d3_ease_linear).attrs(actualPosition)},chart},svg_plot_renderer.funnel=function(){var commonRendererProp,chartObj,data_processed,noofNonZeroDatas,coneHeigth,noOfGaps,stemHeight,stemWidth,dataset,chartWidth,totalEngagement,trapezoid,chartHeight,color,funnelsections,ellipseSections,threeDimension,arcHeight,arcHeight1,padding,minPadding,maxPadding,container,ellipse,funnel,label,labelLinkgroup,rightXscale,leftXscale,yaxiscolumnorder,plotoptions,commonPlotOptions,systemconf,notesArray,datalabelPadding,isSplit,outerPadding,gradientDim,isPatternPalleteEnabled,maxPer,isWeightedWidth,noWeighted,defsLocation,rp,gElementsCollected,fillColor,MAXWIDTH_DATALABELS=.3,cfg={},percentage=.375,minArcHeight=1,isredraw=!1,arcCorrection=0;function chart(selection){selection.each(function(data){rp=commonRendererProp.params,chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,color=rp.color,notesArray=rp.notesArray,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,systemconf=chartObj.systemConf;var labelQueue=rp.labelQueue;defsLocation=chartObj.defsLocation,chartWidth=chartObj.plotarea.width,chartHeight=chartObj.plotarea.height,gElementsCollected=!1,plotoptions=data[0].plotoptions;var gvp=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions);isPatternPalleteEnabled=systemconf.legend.imagePallete||legend_helpers.hasPatternPallete(chartObj),cfg.canOverlap=gvp("canOverlap"),isSplit=gvp("split"),threeDimension=gvp("threeDimension");var emptyFunnelOptions=commonPlotOptions.emptyFunnel;datalabelPadding=commonPlotOptions.datalabels.padding;var showlabel=chartObj.datalabels.moduleExists&&isDatalabelEnabled(commonPlotOptions.datalabels,chartObj),strokeColor=getStrokeColor(chartObj,0);minPadding=pick(commonPlotOptions.minPadding,threeDimension?4:1),maxPadding=pick(commonPlotOptions.maxPadding,10);var animationOptions=getAnimationConf(commonPlotOptions,plotoptions,chartObj,FUNNEL_CHARTNAME),animationType=animationOptions.type,easingType=animationOptions.easingType,isAnimationEnable=animationOptions.enabled,transitionDuration=animationOptions.duration,redrawDuration=isAnimationEnable?200:0;outerPadding=perToPx(gvp("outerPadding"),chartHeight,0)/2,stemHeight=gvp("stemHeight"),stemWidth=gvp("stemWidth"),isWeightedWidth="width"===gvp("weighted"),noWeighted=gvp("weighted")===NONE,isWeightedWidth&&(stemHeight=stemWidth=0,isSplit=!0),data_processed=data=data[0].data[0],noofNonZeroDatas=data_processed.reduce(function(prev,cur,i){return prev+(dataset.getY(cur,yaxiscolumnorder)&&!cur.disabled?1:0)},0),noOfGaps=noofNonZeroDatas-1;var preArcHeight=function(){var h=chartHeight-2*outerPadding,arcHeight=.05*h,padding=getFunnelPadding(h);return arcHeight=(arcHeight-data_processed.length)/data_processed.length,arcHeight=mathMax(minArcHeight,arcHeight),arcHeight=threeDimension?cfg.canOverlap?arcHeight+maxPadding/2:padding/2-arcCorrection:0}();cfg.height=chartHeight-2*preArcHeight-.01*chartHeight-2*outerPadding;var coneWidth=gvp("coneWidth");if(coneWidth=perToPx(coneWidth,cfg.height,.95*cfg.height),cfg.width=mathMin(chartWidth,coneWidth),padding=getFunnelPadding(cfg.height),cfg.gapHeight=!isAnimationEnable||isSplit||isredraw?padding:animationType==HORIZONTALALL_ANIMATION?padding:0,(isWeightedWidth||noWeighted)&&defined(commonPlotOptions.maxSliceHeight)&&(cfg.height-=mathMax(0,cfg.height-padding*noOfGaps-perToPx(commonPlotOptions.maxSliceHeight,cfg.height)*noofNonZeroDatas)),showlabel){var minDatalabelsWidth=chartWidth*MAXWIDTH_DATALABELS,availableDatalabelsWidth=chartWidth-cfg.width;availableDatalabelsWidth<minDatalabelsWidth&&(datalabelPadding=cfg.datalabelPadding=5,cfg.width-=mathMax(minDatalabelsWidth-availableDatalabelsWidth,0))}stemHeight=perToPx(stemHeight,cfg.height,.2*cfg.height),stemWidth=perToPx(stemWidth,cfg.width,stemHeight*cfg.width/cfg.height)/2,coneHeigth=cfg.height-stemHeight,arcHeight=.05*cfg.height,arcHeight=mathMax(minArcHeight,(arcHeight-data_processed.length)/data_processed.length),arcHeight1=arcHeight=threeDimension?cfg.canOverlap?arcHeight+maxPadding/2:padding/2-arcCorrection:0,chart.total=totalEngagement=data_processed.reduce(function(prev,cur,i){return prev+(data_processed[i].disabled?0:mathAbs(dataset.getY(data_processed[i],yaxiscolumnorder)||0))},0),maxPer=mathMax.apply(null,data_processed.map(function(d,i){return data_processed[i].disabled?0:mathAbs(dataset.getY(data_processed[i],yaxiscolumnorder))/totalEngagement})),leftXscale=d3_scaleLinear().domain(isWeightedWidth?[0,maxPer]:[stemHeight,cfg.height]).range([cfg.width/2-stemWidth,0]),rightXscale=d3_scaleLinear().domain(isWeightedWidth?[0,maxPer]:[stemHeight,cfg.height]).range([cfg.width/2+stemWidth,cfg.width]),trapezoid=funnelLayout(data_processed),gradientDim=[cfg.width,cfg.height],fillColor=chart.fillColorFunc=getFillColor(chartObj,0,gradientDim);var eventDisabled=0==validateNullVal(getEventConf(plotoptions,commonPlotOptions,chartObj,"enabled"),!0),cursor=eventDisabled?null:getEventConf(plotoptions,commonPlotOptions,chartObj,"cursor")||POINTER,containerArea=d3_select(this);if((container=appendEle(containerArea,"g",[data],".","class","funnelgroup")).attr("transform","translate("+(chartWidth/2-cfg.width/2)+","+(arcHeight+2+outerPadding)+")").styles({cursor:cursor,"stroke-opacity":gvp("strokeOpacity"),"stroke-width":gvp("strokeWidth")}),ellipse=appendEle(container,"g",[1],".","class","ellipsegroup"),funnel=appendEle(container,"g",[1],".","class","trapezoidgroup"),changeSelectionOrder(funnelsections=appendEle(funnel,PATH_ELEMENT,data_processed)),funnelsections.attr("id",function(d,i){return"funnel"+i}).styles({"fill-opacity":commonPlotOptions.fillOpacity,fill:function(d,i){return fillColor(i,d)},stroke:function(d,i){return strokeColor(i,d,commonPlotOptions.strokeColor)}}),changeSelectionOrder(ellipseSections=appendEle(ellipse,PATH_ELEMENT,threeDimension?data_processed:[])),ellipseSections.attr("id",function(d,i){return"ellipse"+i}).styles({"fill-opacity":commonPlotOptions.fillOpacity,fill:function(d,i){return fillColor(i,d,.5)},stroke:function(d,i){return strokeColor(i,d,commonPlotOptions.strokeColor,.5)}}),setPointerEvents(chartObj,funnelsections,eventDisabled),setPointerEvents(chartObj,ellipseSections,eventDisabled),!eventDisabled){var mousemove=function(d,i){var args=getEventArgs(d,i);chartObj.eventHandler.mouseMove(args)},mouseout=function(d,i){chartObj.eventHandler.mouseOut(chart,d,i)},click=function(d,i){var args=getEventArgs(d,i);chartObj.eventHandler.click(chart,d,0,i,args)},dblclick=function(d,i){var dt=annotation?generateDataForAnnotation(d,null):d,coordinates=trapezoid[data.length-1-i].bottomLeft,args={coordinate:coordinates=[coordinates[0]+(chartWidth/2-cfg.width/2),coordinates[1]+(arcHeight+2+outerPadding)],data:dt,basedOn:"plot"};chartObj.eventHandler.doubleclick(d,data.length-1-i,args)},eventAttacherOptions={target:"plot",touchleave:!0,chartObj:chartObj},mouseHandlers={mousemove:mousemove,mouseout:mouseout,click:click,dblclick:dblclick},touchHandlers={singletouchmove:mousemove,touchend:mouseout,tap:click,dbltap:dblclick};attachevents(funnelsections,mouseHandlers,touchHandlers,eventAttacherOptions),attachevents(ellipseSections,mouseHandlers,touchHandlers,eventAttacherOptions)}var A=cfg.canOverlap?2*stemWidth/cfg.width*arcHeight:arcHeight+arcCorrection,funnelOutline="M0,0L"+(cfg.width/2-stemWidth)+","+coneHeigth+"L"+(cfg.width/2-stemWidth)+","+cfg.height+"A"+stemWidth+","+A+",0,0,0,"+(cfg.width/2+stemWidth)+","+cfg.height+"L"+(cfg.width/2+stemWidth)+","+coneHeigth+"L"+cfg.width+",0A"+cfg.width/2+","+arcHeight+",0,0,0,0,0A"+cfg.width/2+","+arcHeight+",0,0,0,"+cfg.width+",0";if(appendEle(container,PATH_ELEMENT,!isredraw&&emptyFunnelOptions.show&&isAnimationEnable?[1]:[],"#","id","emptyFunnel").attr("d",funnelOutline).styles({stroke:emptyFunnelOptions.color||"grey",fill:NONE}),function(emptyFunnelPath){var clipID;if(isWeightedWidth)clipID=null;else{var properties={name:"FunnelClipPath",id:chartObj.id,d:emptyFunnelPath},args={chartObj:chartObj};clipID=effects.get(effects.svg_clips,"polygon",properties,args)}container.attr("clip-path",clipID?"url("+defsLocation+"#"+clipID+")":null)}(funnelOutline),isredraw)funnelsections.transition().duration(redrawDuration).ease(d3_ease_linear).attr("d",function(d,i){return drawTrapezoid(trapezoid[data_processed.length-1-i])}),ellipseSections.transition().duration(redrawDuration).ease(d3_ease_linear).attr("d",function(d,i){return drawEllipse(trapezoid[data_processed.length-1-i])}),hideDisabledElements(data,redrawDuration),lableManagent();else{hideDisabledElements(data,0);var prev=0,funneldrawn=0;funnelsections.transition().duration(function(d,i){var yVal=dataset.getY(d,yaxiscolumnorder);return animationType==VERTICAL_ANIMATION?d.disabled||!yVal?0:isWeightedWidth||noWeighted?transitionDuration/noofNonZeroDatas:mathAbs(yVal)/totalEngagement*transitionDuration:transitionDuration}).delay(function(d,i){var yVal=dataset.getY(d,yaxiscolumnorder);return prev+=d.disabled||!yVal?0:isWeightedWidth||noWeighted?transitionDuration/noofNonZeroDatas:mathAbs(yVal),(animationType==VERTICAL_ANIMATION?isWeightedWidth||noWeighted?transitionDuration-prev:(totalEngagement-prev)/totalEngagement*transitionDuration:0)||0}).ease(easingType).attrTween("d",function(d,i){return tweenAll(d,data_processed.length-1-i,"funnel",animationType)}).on("end",function(d,i){funneldrawn++}),prev=0,ellipseSections.transition().duration(function(d,i){var yVal=dataset.getY(d,yaxiscolumnorder);return animationType==VERTICAL_ANIMATION?d.disabled||!yVal?0:isWeightedWidth||noWeighted?transitionDuration/noofNonZeroDatas:mathAbs(yVal)/totalEngagement*transitionDuration:transitionDuration}).delay(function(d,i){var yVal=dataset.getY(d,yaxiscolumnorder);return prev+=d.disabled||!yVal?0:isWeightedWidth||noWeighted?transitionDuration/noofNonZeroDatas:mathAbs(yVal),(animationType==VERTICAL_ANIMATION?isWeightedWidth||noWeighted?transitionDuration-prev:(totalEngagement-prev)/totalEngagement*transitionDuration:0)||0}).ease(easingType).attrTween("d",function(d,i){return tweenAll(d,data_processed.length-1-i,"ellipse",animationType)});var includeGap=setInterval(function(){funneldrawn==data_processed.length&&(animationType!=HORIZONTALALL_ANIMATION&&(cfg.gapHeight=padding,trapezoid=funnelLayout(data_processed),funnelsections.transition().duration(isAnimationEnable?250:0).delay(50).ease(d3_ease_linear).attr("d",function(d,i){return drawTrapezoid(trapezoid[data_processed.length-1-i])}),ellipseSections.transition().duration(isAnimationEnable?250:0).delay(50).ease(d3_ease_linear).attr("d",function(d,i){return drawEllipse(trapezoid[data_processed.length-1-i])})),lableManagent(),container.selectAll(PATH_ELEMENT+"#emptyFunnel").transition().duration(50).delay(310).style("stroke-opacity",0).remove(),clearInterval(includeGap))},10)}function lableManagent(){chart.renderedTimer=setTimeout(function(){var data,trape,ht,h,labelPosition=(trape=[],ht=0,h=0,(data=data_processed).forEach(function(value,index){var d=data[data.length-1-index],yVal=dataset.getY(d,yaxiscolumnorder),disabled=d.disabled,half=h=(h=(disabled?0:isWeightedWidth||noWeighted?yVal?1/noofNonZeroDatas:0:mathAbs(yVal)/totalEngagement)*(cfg.height-(noofNonZeroDatas-1)*cfg.gapHeight)/2)||0;h=ht+h;var per=yVal/totalEngagement;per=per||0;var leftX=isWeightedWidth?leftXscale(per):cfg.height-h>=coneHeigth?cfg.width/2-stemWidth:leftXscale(h),rightX=isWeightedWidth?rightXscale(per):cfg.height-h>=coneHeigth?cfg.width/2+stemWidth:rightXscale(h);trape.push({rightx:rightX+datalabelPadding,leftx:leftX-datalabelPadding,y:mathAbs(cfg.height-h),y0:mathAbs(cfg.height-h+half)}),h+=half,ht=!yVal||disabled?h:h+cfg.gapHeight}),trape);if(labelRenderer){var args=[chartObj.seriesdata,0,data_processed,noofNonZeroDatas,arcHeight+2+outerPadding,totalEngagement,cfg,labelPosition];labelQueue.push({renderer:chart,charttype:FUNNEL_CHARTNAME,chartObj:chartObj,args:args}),labelQueue.push({renderer:chart,charttype:"funnelInnerLabels",chartObj:chartObj,args:args})}annotation&&(notesArray=annotation.preprocessAnnotations(chartObj.seriesdata,0,function(dt,k,j){return[trapezoid[trapezoid.length-1-j].bottomLeft[0]+(chartWidth/2-cfg.width/2),trapezoid[trapezoid.length-1-j].bottomLeft[1]+(arcHeight+2+outerPadding)]},notesArray,chartObj,rp)),isredraw=!0,chart.chartRendered=!0},isAnimationEnable?isredraw?redrawDuration:300:0)}function changeSelectionOrder(selection){selection._groups[0].reverse(),selection.data(data_processed)}function getEventArgs(d,i){var ev=getEventObject(d3$1.event);return{renderer:chart,seriesPos:0,subseriesPos:0,itemPos:i,color:color[i%color.length],coordinates:[ev.pageX,ev.pageY],element:this,data:d}}})}function funnelLayout(data){var sumofvalues=0,hgt=cfg.height,ht=0,h=0;return trapezoid=[],stemWidth,data.forEach(function(value,index){var d=data[data.length-1-index],yVal=dataset.getY(d,yaxiscolumnorder),disabled=d.disabled;h=totalEngagement?(disabled?0:isWeightedWidth||noWeighted?yVal?1/noofNonZeroDatas:0:mathAbs(yVal)/totalEngagement)*(cfg.height-(noofNonZeroDatas-1)*cfg.gapHeight):0,h=ht+(h=h||0);var per=yVal/totalEngagement;per=per||0;var points={};(sumofvalues+=disabled?0:yVal)!=totalEngagement||0!=yVal&&!disabled?isWeightedWidth?(points.bottomLeft=[leftXscale(per),cfg.height-h],points.topLeft=[leftXscale(per),hgt],points.middleLeft=[leftXscale(per),cfg.height-h],points.bottomRight=[rightXscale(per),cfg.height-h],points.topRight=[rightXscale(per),hgt],points.middleRight=[rightXscale(per),cfg.height-h]):(points.bottomLeft=[cfg.height-h>=coneHeigth?cfg.width/2-stemWidth:leftXscale(h),cfg.height-h],points.topLeft=[hgt>=coneHeigth?cfg.width/2-stemWidth:leftXscale(ht),hgt],points.middleLeft=[hgt>=coneHeigth?cfg.width/2-stemWidth:points.bottomLeft[0],hgt>=coneHeigth&&cfg.height-h<=coneHeigth?coneHeigth:cfg.height-h],points.bottomRight=[cfg.height-h>=coneHeigth?cfg.width/2+stemWidth:rightXscale(h),cfg.height-h],points.topRight=[hgt>=coneHeigth?cfg.width/2+stemWidth:rightXscale(ht),hgt],points.middleRight=[hgt>=coneHeigth?cfg.width/2+stemWidth:points.bottomRight[0],hgt>=coneHeigth&&cfg.height-h<=coneHeigth?coneHeigth:cfg.height-h]):(points.topLeft=points.bottomLeft=points.middleLeft=[leftXscale(isWeightedWidth?maxPer:cfg.height),0],points.topRight=points.bottomRight=points.middleRight=[rightXscale(isWeightedWidth?maxPer:cfg.height),0]),trapezoid.push(points),hgt=!yVal||disabled?cfg.height-h:cfg.height-h-cfg.gapHeight,ht=!yVal||disabled?h:h+cfg.gapHeight}),trapezoid}function tweenAll(d,i,elementType,animationType){var base=function(animationType,i){var d=simpleClone(trapezoid[animationType==VERTICALALL_ANIMATION?0:i]);animationType===HORIZONTALALL_ANIMATION?d.topLeft[0]=d.middleLeft[0]=d.bottomLeft[0]=d.topRight[0]=d.middleRight[0]=d.bottomRight[0]=cfg.width/2:(d.middleLeft=d.bottomLeft=d.topLeft,d.middleRight=d.bottomRight=d.topRight);return d}(animationType,i),dt=trapezoid[i],interpolate="funnel"==elementType?d3_interpolate(drawTrapezoid(base),drawTrapezoid(dt)):d3_interpolate(drawEllipse(base),drawEllipse(dt));return function(t){return interpolate(t)}}function hideDisabledElements(data,dur){ellipseSections.each(function(d,i){var hide=data[i].disabled||!dataset.getY(data_processed[i],yaxiscolumnorder),t=hide?dur:0;t?setTimeout(function(){hideSection(i,hide)},t):hideSection(i,hide)})}function hideSection(i,hide){var display=hide?NONE:null;ellipse.selectAll("#ellipse"+i).style("display",display),funnel.selectAll("#funnel"+i).style("display",display)}function getFunnelPadding(h){var userPadding=commonPlotOptions.padding;return defined(userPadding)?invokeFunction(userPadding,h,noOfGaps,chartObj):mathMin(maxPadding,mathMax(minPadding,h*percentage/noOfGaps))}function drawTrapezoid(d){var topW=(d.topRight[0]-d.topLeft[0])/2,bottomW=(d.bottomRight[0]-d.bottomLeft[0])/2,topCurve=cfg.canOverlap?2*topW/cfg.width*arcHeight:arcHeight1,bottomCurve=cfg.canOverlap?2*bottomW/cfg.width*arcHeight:arcHeight1;return"M"+d.topLeft[0]+" "+d.topLeft[1]+" A"+topW+" "+topCurve+" 0 0 0 "+d.topRight[0]+" "+d.topRight[1]+" L"+d.middleRight[0]+" "+d.middleRight[1]+" L"+d.bottomRight[0]+" "+d.bottomRight[1]+" A"+bottomW+" "+bottomCurve+" 0 0 1 "+d.bottomLeft[0]+" "+d.bottomLeft[1]+" L"+d.middleLeft[0]+" "+d.middleLeft[1]+"Z"}function drawEllipse(d){var bottomW=(d.bottomRight[0]-d.bottomLeft[0])/2,bottomCurve=cfg.canOverlap?2*bottomW/cfg.width*arcHeight+arcCorrection:arcHeight1;return"M"+d.bottomLeft[0]+" "+d.bottomLeft[1]+" A"+bottomW+" "+bottomCurve+" 0 0 1 "+d.bottomRight[0]+" "+d.bottomRight[1]+" A"+bottomW+" "+(cfg.canOverlap?bottomCurve:bottomCurve+arcCorrection)+" 0 0 1 "+d.bottomLeft[0]+" "+d.bottomLeft[1]}function collectGroups(){labelLinkgroup=labelLinkgroup||chartObj.staticPaneSVG.selectAll("g.link_0"),label=label||chartObj.staticPaneSVG.selectAll("g.label_0"),gElementsCollected=!0}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.defaultMouseOverFunc=function(d,seriesPos,itemPos){gElementsCollected||collectGroups(),isPatternPalleteEnabled?(funnelsections.style("opacity",function(d,i){return i===itemPos?null:.4}),ellipseSections.style("opacity",function(d,i){return i===itemPos?null:.4})):(funnelsections.style("fill",function(d,i){return fillColor(i,d,i===itemPos?.6:null)}),ellipseSections.style("fill",function(d,i){return fillColor(i,d,i===itemPos?1:.5)})),label.selectAll("text").style("text-shadow",null),labelLinkgroup.selectAll(PATH_ELEMENT).style("stroke-width",null),label.selectAll("#lbl0_0_"+(data_processed.length-1-itemPos)).style("text-shadow","0 0 0 rgba(0,0,0,1)"),labelLinkgroup.selectAll("#link0_0_"+(data_processed.length-1-itemPos)).style("stroke-width",1)},chart.defaultMouseOutFunc=function(d,i){gElementsCollected||collectGroups(),isPatternPalleteEnabled?(funnelsections.style("opacity",null),ellipseSections.style("opacity",null)):(funnelsections.style("fill",function(d,i){return fillColor(i,d)}),ellipseSections.style("fill",function(d,i){return fillColor(i,d,.5)})),label.selectAll("text").style("text-shadow",null),labelLinkgroup.selectAll(PATH_ELEMENT).style("stroke-width",null)},chart},svg_plot_renderer.pyramid=function(){var animationType,commonRendererProp,dataset,yaxiscolumnorder,chartWidth,chartHeight,commonPlotOptions,systemconf,notesArray,isPatternPalleteEnabled,height1,total,b,h,side1,side2,side3,side4,hScale,color,heightArray,chartObj,pyramidGroup,gradientDim,pyramidsections,dataLength,data_backup,datalabelPadding,fillColor,MAXWIDTH_DATALABELS=.3,cfg={},isredraw=!1;function chart(selection){selection.each(function(data){var rp=commonRendererProp.params;chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,color=rp.color,notesArray=rp.notesArray,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,systemconf=chartObj.systemConf;var labelQueue=rp.labelQueue;chartObj.defsLocation,chartWidth=chartObj.plotarea.width,chartHeight=chartObj.plotarea.height;var minD=mathMin(chartWidth,chartHeight);if(datalabelPadding=commonPlotOptions.datalabels.padding,chartObj.datalabels.moduleExists&&isDatalabelEnabled(commonPlotOptions.datalabels,chartObj)){var minDatalabelsWidth=chartWidth*MAXWIDTH_DATALABELS,availableDatalabelsWidth=chartWidth-minD;availableDatalabelsWidth<minDatalabelsWidth&&(datalabelPadding=cfg.datalabelPadding=5,minD-=mathMax(minDatalabelsWidth-availableDatalabelsWidth,0))}cfg.width=minD,cfg.height=4*minD/5;var plotoptions=data[0].plotoptions,gvp=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions);isPatternPalleteEnabled=systemconf.legend.imagePallete||legend_helpers.hasPatternPallete(chartObj);var strokeWidth=gvp("strokeWidth"),strokeOpacity=gvp("strokeOpacity"),threeDimension=gvp("threeDimension"),fillOpacity=gvp("fillOpacity"),animationOptions=getAnimationConf(commonPlotOptions,plotoptions,chartObj,PYRAMID_CHARTNAME),isAnimationEnable=animationOptions.enabled,easingType=animationOptions.easingType,transitionDuration=isredraw?isAnimationEnable?200:0:animationOptions.duration;animationType=animationOptions.type;var eventDisabled=0==validateNullVal(getEventConf(plotoptions,commonPlotOptions,chartObj,"enabled"),!0),cursor=eventDisabled?null:getEventConf(plotoptions,commonPlotOptions,chartObj,"cursor")||"pointer",container=d3_select(this);(pyramidGroup=appendEle(container,"g",[data],".","class","pyramidgroup")).attr("transform","translate("+(chartWidth/2-cfg.width/2)+","+(chartHeight/2-cfg.height/2)+")").style("cursor",cursor),data_backup=data=data[0].data[0],dataLength=data.length,heightArray=[],height1=cfg.height,b=cfg.width,h=threeDimension?cfg.height/6:0;var x=mathSQRT(mathPow(h/mathSin(25*mathPI/180),2)-mathPow(h,2));b-=x,side1=d3_scaleLinear().range([(b+x)/2,0]).domain([0,height1]),side2=d3_scaleLinear().range([(b+x)/2,b]).domain([0,height1]),side3=d3_scaleLinear().range([(b+x)/2,b+x]).domain([0,height1]),side4=d3_scaleLinear().range([(b+x)/2,x]).domain([0,height1]),hScale=d3_scaleLinear().range([0,h]).domain([0,height1-h/2]),gradientDim=[cfg.width,cfg.height],fillColor=chart.fillColorFunc=getFillColor(chartObj,0,gradientDim);var strokeColor=getStrokeColor(chartObj,0),noofNonZeroData=0;chart.total=total=data.reduce(function(prev,cur){return prev+(cur.disabled?0:(noofNonZeroData++,mathAbs(dataset.getY(cur,yaxiscolumnorder)||0)))},0);var previous=0;if(data.forEach(function(d,i){heightArray.push({height:(previous+(d.disabled?0:mathAbs(dataset.getY(d,yaxiscolumnorder))))/total*(height1-h/2)||0,previousHeight:previous/total*(height1-h/2)||0}),previous+=d.disabled?0:mathAbs(dataset.getY(d,yaxiscolumnorder))}),(pyramidsections=appendEle(pyramidGroup,"g",data)).attr("id",function(d,i){return"section_"+(dataLength-1-i)}).styles({stroke:function(d,i){return strokeColor(dataLength-1-i,data[dataLength-1-i],commonPlotOptions.strokeColor)},"stroke-opacity":strokeOpacity,"stroke-width":strokeWidth,"fill-opacity":fillOpacity,fill:function(d,i){return fillColor(dataLength-1-i,data[dataLength-1-i])}}).each(function(d,i){appendEle(d3_select(this),PATH_ELEMENT,[d,d,d,d]).attr("class","section_"+(dataLength-1-i))}),setPointerEvents(chartObj,pyramidsections,eventDisabled),!eventDisabled){var mousemove=function(d,j){var ele=this.parentNode,args=getEventArgs(ele,pInt(d3_select(ele).attr("id").replace(/section_/gi,"")));chartObj.eventHandler.mouseMove(args)},mouseout=function(d,j){var ele=this.parentNode,i=pInt(d3_select(ele).attr("id").replace(/section_/gi,""));chartObj.eventHandler.mouseOut(chart,data[i],i)},click=function(){var ele=this.parentNode,i=pInt(d3_select(ele).attr("id").replace(/section_/gi,"")),args=getEventArgs(ele,i);chartObj.eventHandler.click(chart,data[i],0,i,args)},dblclick=function(d,j){var ele=this.parentNode,i=pInt(d3_select(ele).attr("id").replace(/section_/gi,"")),dt=annotation?generateDataForAnnotation(data[i],null):data[i],height=heightArray[i].previousHeight,args={coordinate:[side1(height+hScale(height)/2)+(chartWidth/2-cfg.width/2),hScale(height)/2+height+(chartHeight/2-cfg.height/2)],data:dt,basedOn:"plot"};chartObj.eventHandler.doubleclick(d,i,args)},eventAttacherOptions={target:"plot",touchleave:!0,chartObj:chartObj},mouseHandlers={mousemove:mousemove,mouseout:mouseout,click:click,dblclick:dblclick},touchHandlers={singletouchmove:mousemove,touchend:mouseout,tap:click,dbltap:dblclick};attachevents(pyramidsections.selectAll(PATH_ELEMENT),mouseHandlers,touchHandlers,eventAttacherOptions)}var prev=0;function getEventArgs(ele,i){var ev=getEventObject(d3$1.event);return{renderer:chart,seriesPos:0,subseriesPos:0,itemPos:i,color:color[i%color.length],coordinates:[ev.pageX,ev.pageY],element:ele,data:data[i]}}pyramidsections.each(function(d,i){var pyramid=pyramidGroup.selectAll("#section_"+i).selectAll(PATH_ELEMENT);if(isredraw)pyramid.transition().duration(transitionDuration).ease(d3_ease_linear).attr("d",function(d,j){return getPath(i,j)});else{var yVal=dataset.getY(d,yaxiscolumnorder),dur=animationType==VERTICAL_ANIMATION?(d.disabled||!yVal?0:mathAbs(yVal))/total*transitionDuration:transitionDuration;prev+=d.disabled||!yVal?0:mathAbs(yVal);var del=animationType==VERTICAL_ANIMATION?(total-prev)/total*transitionDuration:0;pyramid.transition().duration(dur).delay(del).ease(easingType).attrTween("d",function(dt,j){return function(d,i,j){var interpolate=d3_interpolate(getPath(animationType==VERTICAL_ANIMATION?i:dataLength-1,j,"down"),getPath(i,j));return function(t){return interpolate(t)}}(0,i,j)})}}),chart.renderedTimer=setTimeout(function(){if(labelRenderer){var args=[chartObj.seriesdata,0,data,noofNonZeroData,0,total,cfg,function(data){var trape=[];return data.forEach(function(d,i){var idx=data.length-1-i,height=heightArray[idx].height,previous=heightArray[idx].previousHeight,midHeight=(height+previous)/2,bottom_right_x=side3(height+hScale(height)/2),bottom_right_y=-hScale(height)/2+height,top_right_x=side3(previous+hScale(previous)/2),top_right_y=-hScale(previous)/2+previous,bottom_left_x=side1(height+hScale(height)/2),bottom_left_y=hScale(height)/2+height,rightX=(bottom_right_x+top_right_x)/2,rightY=(bottom_right_y+top_right_y)/2,leftX=(bottom_left_x+side1(previous+hScale(previous)/2))/2,leftY=(bottom_left_y+(hScale(previous)/2+previous))/2,midX=(side1(midHeight+hScale(midHeight)/2)+side2(midHeight+hScale(midHeight)/2))/2;trape.push({rightx:rightX+datalabelPadding,leftx:leftX-datalabelPadding,y:rightY,y0:height+hScale(height)/2,midX:midX,leftY:leftY})}),trape}(data)];labelQueue.push({renderer:chart,charttype:FUNNEL_CHARTNAME,chartObj:chartObj,args:args}),labelQueue.push({renderer:chart,charttype:"funnelInnerLabels",chartObj:chartObj,args:args})}annotation&&(notesArray=annotation.preprocessAnnotations(chartObj.seriesdata,0,function(dt,k,j){var height=heightArray[j].previousHeight;return[side1(height+hScale(height)/2)+(chartWidth/2-cfg.width/2),hScale(height)/2+height+(chartHeight/2-cfg.height/2)]},notesArray,chartObj,rp)),isredraw=!0,chart.chartRendered=!0},transitionDuration+10)})}function getPath(i,j,base){var height=heightArray[i].height,baseHgt="down"==base?height:heightArray[i].previousHeight;switch(j){case 0:return function(height,previous){return"M"+side3(height+hScale(height)/2)+" "+(-hScale(height)/2+height)+" L"+side4(height+hScale(height)/2)+" "+(-hScale(height)/2+height)+" L"+side4(previous+hScale(previous)/2)+" "+(-hScale(previous)/2+previous)+" L"+side3(previous+hScale(previous)/2)+" "+(-hScale(previous)/2+previous)+" L"+side3(height+hScale(height)/2)+" "+(-hScale(height)/2+height)}(height,baseHgt);case 1:return function(height,previous){return"M"+side4(height+hScale(height)/2)+" "+(-hScale(height)/2+height)+" L"+side1(height+hScale(height)/2)+" "+(hScale(height)/2+height)+" L"+side1(previous+hScale(previous)/2)+" "+(hScale(previous)/2+previous)+" L"+side4(previous+hScale(previous)/2)+" "+(-hScale(previous)/2+previous)+" L"+side4(height+hScale(height)/2)+" "+(-hScale(height)/2+height)}(height,baseHgt);case 2:return function(height,previous){return"M"+side1(height+hScale(height)/2)+" "+(hScale(height)/2+height)+" L"+side2(height+hScale(height)/2)+" "+(hScale(height)/2+height)+" L"+side2(previous+hScale(previous)/2)+" "+(hScale(previous)/2+previous)+" L"+side1(previous+hScale(previous)/2)+" "+(hScale(previous)/2+previous)+" L"+side1(height+hScale(height)/2)+" "+(hScale(height)/2+height)}(height,baseHgt);case 3:return function(height,previous){return"M"+side2(height+hScale(height)/2)+" "+(hScale(height)/2+height)+" L"+side3(height+hScale(height)/2)+" "+(-hScale(height)/2+height)+" L"+side3(previous+hScale(previous)/2)+" "+(-hScale(previous)/2+previous)+" L"+side2(previous+hScale(previous)/2)+" "+(hScale(previous)/2+previous)+" L"+side2(height+hScale(height)/2)+" "+(hScale(height)/2+height)}(height,baseHgt)}}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.defaultMouseOverFunc=function(d,seriesPos,itemPos){isPatternPalleteEnabled?pyramidsections.style("opacity",function(d,i){return dataLength-1-i==itemPos?null:.2}):pyramidsections.style("fill",function(d,i){return fillColor(dataLength-1-i,data_backup[dataLength-1-i],dataLength-1-i==itemPos?.5:null)})},chart.defaultMouseOutFunc=function(d,i){isPatternPalleteEnabled?pyramidsections.style("opacity",null):pyramidsections.style("fill",function(d,i){return fillColor(dataLength-1-i,data_backup[dataLength-1-i])})},chart},svg_plot_renderer.sunburst=function(){var commonRendererProp,xscale,yscale,arc,radius,dataset,arcLabel,systemconf,oldData,yaxiscolumnorder,chartwidth,chartheight,color,chartObj,notesArray,path,pathGroup,commonPlotOptions,start,end,innerrad,rad,highlightGroup,highlightEle,highlightHierarchy,maxDepth,valueFunction,nodes,childrenCount,redraw=!1,stratifiedIndices={};function chart(selection){return selection.each(function(data){var rp=commonRendererProp.params;chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,color=rp.color,notesArray=rp.notesArray,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,systemconf=chartObj.systemConf;var labelQueue=rp.labelQueue;chartwidth=chartObj.plotarea.width,chartheight=chartObj.plotarea.height;var padding,gvpFn=utils.getValueOfPlotOptions,dataLabels=commonPlotOptions.datalabels,outerPadding=+commonPlotOptions.outerPadding||0,NegativeAsAbsolute="absolute"===commonPlotOptions.showAsNegative;highlightGroup=null,maxDepth=0,nodes=[];var boundBoxPadding=chartObj.datalabels.moduleExists&&isDatalabelEnabled(dataLabels,chartObj)&&isBoundBoxEnabled(dataLabels,chartObj)?getBoundBoxPadding(dataLabels,chartObj)+getBoundBoxStrokeWidth(dataLabels,chartObj):0,eventDisabled=0==validateNullVal(getEventConf(null,commonPlotOptions,chartObj,"enabled"),!0),cursor=eventDisabled?null:commonPlotOptions.events?commonPlotOptions.events.cursor||POINTER:systemconf.chart.plot.events.cursor||POINTER;highlightHierarchy=commonPlotOptions.events&&commonPlotOptions.events.highlightHierarchy;var animationOptions=getAnimationConf(commonPlotOptions,null,chartObj,SUNBURST_CHARTNAME),isAnimationEnable=animationOptions.enabled,animationType=animationOptions.type,easingType=animationOptions.easingType,transitionDuration=redraw?isAnimationEnable?200:0:animationOptions.duration;radius=mathMin(chartwidth,chartheight)/2-outerPadding-2*boundBoxPadding;var innerRadius=mathMin(mathMax(0,perToPx(commonPlotOptions.innerRadius,radius)),perToPx("95%",radius)),fillColor=chart.fillColorFunc=getFillColor(chartObj,0,[radius,radius]),strokeColor=getStrokeColor(chartObj,0);start=function(d){return mathMax(0,mathMin(2*mathPI,xscale(d.x0)))},end=function(d){return mathMax(0,mathMin(2*mathPI,xscale(d.x1)))},innerrad=function(d){return yscale(d.y0)+padding/2},rad=function(scaleObj,extra){return extra=extra||0,function(d){return yscale(d.y1)+extra-padding/2}},valueFunction=function(d){if(function(d){var seriesIndex=getSeriesIndex(d);return defined(seriesIndex)&&chartObj.seriesdata[seriesIndex].disabled}(d))return 0;var y=dataset.getY(d,yaxiscolumnorder)||0;return y<0?NegativeAsAbsolute?mathAbs(y):0:y},arc=d3_arc().startAngle(start).endAngle(end).innerRadius(innerrad).outerRadius(rad(yscale)),arcLabel=d3_arc().startAngle(start).endAngle(end).innerRadius(innerrad).outerRadius(rad(yscale)),(pathGroup=appendEle(selection,"g",[data],".","class","hierarchychart")).attr("transform","translate("+chartwidth/2+","+chartheight/2+")").style("cursor",cursor),oldData=[],pathGroup.selectAll(PATH_ELEMENT).each(function(d,i){oldData.push({x0:d.x0,x1:d.x1})});var packedData=function(data){var partition=d3_partition(),root=d3$1.hierarchy(data,getChildren).sum(valueFunction).sort(d3_ascending);return partition(root),root.descendants()}(data);chart.total=packedData[0].value,path=appendEle(pathGroup,PATH_ELEMENT,packedData);var colorLighter=[],leafNodes=[],seriesWiseNodes=[];if(data.forEach(function(d,i){leafNodes[i]=[[]],leafNodes[i].disabled=d.disabled,leafNodes[i].plotoptions=d.plotoptions,seriesWiseNodes[i]=[],seriesWiseNodes[i].disabled=d.disabled,seriesWiseNodes[i].plotoptions=d.plotoptions;var nonRGBAColor=color[i%color.length];colorLighter[i]=d3_scaleLinear().domain([0,getChildrenCount(d)]).range([nonRGBAColor,getColorCopy(nonRGBAColor,1.5,"brighter")])}),path.attr("class",function(d,i){return null!=getLevel(d)?"series_"+getSeriesIndex(d):null}).attr("id",function(d){return"arcPath_"+getLevel(d)}).each(function(d,i){d.index=i;var seriesIndex=getSeriesIndex(d),level=getLevel(d);if(maxDepth=mathMax(maxDepth,d.depth),d.depth){if(d.data.color)d.data.arcColor=d.data.color;else{var plotoptions=data[seriesIndex].plotoptions,chClr=null!=plotoptions?gvpFn(plotoptions,commonPlotOptions)("childrenColors"):commonPlotOptions.childrenColors;if(null!=chClr)d.data.arcColor=chClr[stratifiedIndices[level]%chClr.length];else{var c=colorLighter[seriesIndex](stratifiedIndices[level]);d.data.arcColor=c}}d.children||leafNodes[seriesIndex][0].push(d),seriesWiseNodes[seriesIndex].push(d),nodes[level]=d}else d.data.arcColor=TRANSPARENT}),xscale=d3_scaleLinear().range([0,2*mathPI]),yscale=d3_scaleLinear().range([innerRadius,radius]).domain([packedData[0].y1,1]),padding=mathMin(mathMax(0,perToPx(commonPlotOptions.padding,radius,0)),.9*(radius-innerRadius)/maxDepth),path.transition().duration(transitionDuration).ease(redraw?d3_ease_linear:easingType).attrTween("d",redraw||animationType===FAN_ANIMATION?fanTween:animationType===WHEEL_ANIMATION?wheelTween:innerTween),path.styles({fill:function(d){return d.fillColor=fillColor(getSeriesIndex(d),d.data)},stroke:function(d){return d.depth?commonPlotOptions.strokeColor?commonPlotOptions.strokeColor:strokeColor(getSeriesIndex(d),d.data):"white"},"stroke-opacity":function(d){return d.depth?gvpFn(data[getSeriesIndex(d)].plotoptions,commonPlotOptions)("strokeOpacity"):1},"fill-opacity":function(d){return d.depth?gvpFn(data[getSeriesIndex(d)].plotoptions,commonPlotOptions)("fillOpacity"):0},"stroke-width":function(d){return d.depth?gvpFn(data[getSeriesIndex(d)].plotoptions,commonPlotOptions)("strokeWidth"):0}}),setPointerEvents(chartObj,path,eventDisabled),!eventDisabled){var mousemove=function(d,i){var args=getEventArgs(d,i);chartObj.eventHandler.mouseMove(args)},mouseout=function(d,i){chartObj.eventHandler.mouseOut(chart,d,getSeriesIndex(d))},click=function(d,i){var args=getEventArgs(d,i);chartObj.eventHandler.click(chart,d,getSeriesIndex(d),d.itemPos,args)},dblclick=function(d,i){if(chart.chartRendered){var dt=null==d.children?null!=annotation?generateDataForAnnotation(d,data.length>1?d.parent.data.seriesname:null):d:[d.data.seriesname,d.value],coordinates=arcLabel.centroid(d),args={coordinate:coordinates=[coordinates[0]+chartwidth/2,coordinates[1]+chartheight/2],data:dt,basedOn:"plot"};chartObj.eventHandler.doubleclick(d,getSeriesIndex(d),args)}},eventAttacherOptions={target:"plot",touchleave:!0,chartObj:chartObj},mouseHandlers={mousemove:mousemove,mouseout:mouseout,click:click,dblclick:dblclick},touchHandlers={singletouchmove:mousemove,touchend:mouseout,tap:click,dbltap:dblclick};attachevents(path.filter(function(d){return 0!=d.depth}),mouseHandlers,touchHandlers,eventAttacherOptions)}function getEventArgs(d,i){var ev=getEventObject(d3$1.event);return{renderer:chart,seriesPos:getSeriesIndex(d),coordinates:[ev.pageX,ev.pageY],element:this,data:d.data,level:getLevel(d)}}chart.renderedTimer=setTimeout(function(){if(null!=labelRenderer){var outline=d3_arc().startAngle(start).endAngle(end).innerRadius(rad(yscale)).outerRadius(rad(yscale)),datalabelsPadding=commonPlotOptions.datalabels.padding+boundBoxPadding,outlineWithPad=d3_arc().startAngle(start).endAngle(end).innerRadius(rad(yscale,datalabelsPadding)).outerRadius(rad(yscale,datalabelsPadding));data.forEach(function(d,i){var getArguments=function(nodes,isParent){return[leafNodes,i,nodes,radius,function(d,showAs){return showAs===PERCENT_SHOWAS?chart.total:chart.getProcessedNode(d).parent.value},outlineWithPad,outline,arcLabel,[chartwidth/2,chartheight/2],isParent]};labelQueue.push({renderer:chart,chartObj:chartObj,charttype:PIE_CHARTNAME,args:getArguments(seriesWiseNodes[i])}),labelQueue.push({renderer:chart,chartObj:chartObj,charttype:"pieInnerLabels",args:getArguments(leafNodes[i][0])}),labelQueue.push({renderer:chart,chartObj:chartObj,charttype:"pieInnerLabels",args:getArguments(seriesWiseNodes[i].filter(function(d){return d.children}),!0)})})}null!=annotation&&data.forEach(function(series,i){notesArray=annotation.preprocessAnnotations(data,i,function(dt,k,j){var node=chart.getProcessedNode(dt),c=arcLabel.centroid(node);return[c[0]+chartwidth/2,c[1]+chartheight/2]},notesArray,chartObj,rp)}),redraw=!0,chart.chartRendered=!0},transitionDuration+1e3/60)}),chart}function fanTween(d,i){var startAngle=d3_interpolate(redraw&&oldData[i]?start(oldData[i]):0,start(d)),endAngle=d3_interpolate(redraw&&oldData[i]?end(oldData[i]):0,end(d));return function(t){return arc.startAngle(startAngle(t)).endAngle(endAngle(t)),arc(d)}}function innerTween(d){var inner=d3_interpolate(0,innerrad(d)),outer=d3_interpolate(0,rad(yscale)(d));return function(t){return arc.innerRadius(inner(t)).outerRadius(outer(t)),arc(d)}}function wheelTween(d){var endAngle=d3_interpolate(start(d),end(d));return function(t){return arc.endAngle(endAngle(t)),arc(d)}}function getSeriesIndex(d){var level=getLevel(d);if(level)return+level.split("_")[0]}function getLevel(d){return d.level||d.data&&d.data.level}function getChildren(node){var level=getLevel(node),depth=level&&level.split("_").length;return stratifiedIndices[level]=1===depth?childrenCount=0:childrenCount,!chartObj.dataObject.hasHierarchyData&&1==depth&&node.length<2&&node[0]&&isArray(node[0][0])?node[0]:isArray(node[0])?node:(childrenCount++,null)}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.defaultMouseOverFunc=function(d,seriesPos,itemPos){highlightGroup||(highlightGroup=chartObj.staticPaneSVG.selectAll("g#zchierarchyhighlight").attr("transform","translate("+(chartObj.plotarea.left+chartwidth/2)+","+(chartObj.plotarea.top+chartheight/2)+")"),highlightEle=appendEle(highlightGroup,PATH_ELEMENT,d3_range(highlightHierarchy?maxDepth:1)));var highlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(seriesPos,"selectedSeries","plot"),elementIds=function(id){var hierarchyIds=[],currentId=PATH_ELEMENT+"#arcPath";if(highlightHierarchy){var levels=id.split("_");levels.forEach(function(d){currentId=currentId+"_"+d,hierarchyIds.push(currentId)})}else hierarchyIds.push(currentId+"_"+id);return hierarchyIds}(getLevel(d));if(highlightEffect!==NONE){highlightGroup.style("opacity",null);var refElements=pathGroup.selectAll(elementIds.join()).nodes();highlightEle.each(function(d,i){var ele=d3_select(this);if(refElements[i]){var refEle=d3_select(refElements[i]),arcColor=getRawColor(chartObj,seriesPos,refEle.datum(),seriesPos);ele.attr("d",refEle.attr("d")).styles(chartObj.legendHighlight.getEffect(highlightEffect,SUNBURST_CHARTNAME,HIGHLIGHT_EFFECT_REGEX.test(highlightEffect)?arcColor:TRANSPARENT,{fill:TRANSPARENT,stroke:arcColor},seriesPos,"plot"))}else ele.attr("d",null)})}},chart.defaultMouseOutFunc=function(d,i){highlightGroup||(highlightGroup=chartObj.staticPaneSVG.selectAll("g#zchierarchyhighlight")),highlightGroup.style("opacity",0)},chart.getProcessedNode=function(d){return nodes[getLevel(d)]},chart},dialUtils.handleEvents=function(chartObj,element,options,type,data){var metaInfo,formatConf,datatype,currentPoint=data[0].data[0][0],isLevelMarker="levelmarker"===type,levelMarkerInstance=chartObj.renderer[0].levelMarker,levelMarkerLength=levelMarkerInstance&&levelMarkerInstance.values.length,commonPlotOptions=chartObj.systemConf.chart.plot.plotoptions.dial,tooltipEnabled=chartObj.systemConf.tooltip.enabled,events_dial=options.events||{},isEventEnabled=validateNullVal(events_dial.enabled,commonPlotOptions.events.enabled),cursor=isEventEnabled?events_dial.cursor||POINTER:null;if(element.style("cursor",cursor),isEventEnabled){var dataset=chartObj.dataset,columns=chartObj.userdata.metadata.columns,totalData=data[0].data[0].length,columnidx=columns.filter(function(d){return d.dataindex===options.dataindex}),targetColumn=columnidx.length?columnidx[0]:columns[dataset.getColumnIdx("y",0)],defaultMouseOverFunc=function(d,i){isLevelMarker?d[1]:d[options.dataindex];var mouse,relmousePt,tooltipPos,evt,dLeft,dTop,userCallback=createUserObject(d),position=getTooltipPosition(d3$1.event,{x:0,y:0},0,0,chartObj,{seriesPos:0,subseriesindex:0,itemPos:0});if(tooltipEnabled){var tooltipContent=invokeFunction(events_dial.tooltipContent,userCallback,chartObj)||(isLevelMarker?"Range: ":"Target: ")+userCallback.formattedValue;chartObj.eventHandler.tooltipElement.show(chartObj,(mouse=getMousePosition(chartObj.svg.node(),d3$1.event),relmousePt={x:mouse[0],y:mouse[1]},tooltipPos={left:relmousePt.x,top:relmousePt.y},evt=getEventObject(d3$1.event),dLeft=relmousePt.x-evt.clientX,dTop=relmousePt.y-evt.clientY,tooltipPos.left-=dLeft,tooltipPos.top-=dTop,tooltipPos.dLeft=dLeft,tooltipPos.dTop=dTop,tooltipPos),tooltipContent,!1,position.helpers)}},defaultMouseOutFunc=function(){if(tooltipEnabled){var tooltip=chartObj.eventHandler.tooltipElement;tooltip.hide(tooltip.element)}};datatype=targetColumn.datatype,formatConf=targetColumn[datatype];var mousemove=function(d,i){var tooltip=chartObj.eventHandler.tooltipElement;tooltip&&tooltip.timeout&&clearTimeout(tooltip.timeout),!1!==chartObj.stopPropogate&&d3$1.event.stopPropagation();var eventType=chartObj.zcEventType||"mousemove";handleUserCallback(currentPoint,eventType,d3$1.event,d),defaultMouseOverFunc(d)},mouseout=function(d,i){var eventType=chartObj.zcEventType||"mouseout";handleUserCallback(currentPoint,eventType,d3$1.event,d),defaultMouseOutFunc()},click=function(d,i){var isTouchEvent=d3$1.event&&d3$1.event.touches,eventType=chartObj.zcEventType||"click",itemPos=totalData+i+1+("targetmarker"===type?levelMarkerLength:0);if(handleUserCallback(currentPoint,eventType,d3$1.event,d),isTouchEvent&&"taphold"!==eventType){docTapFunction(chartObj);(new Date).getTime(),chartObj.renderer[0];var tapOldInfo=chartObj.eventHandler.tapOldInfo;tapOldInfo&&tapOldInfo.itemPos==itemPos?(defaultMouseOutFunc(),chartObj.eventHandler.tapOldInfo=null):(defaultMouseOverFunc(d),chartObj.eventHandler.tapOldInfo={seriesPos:0,subseriesindex:0,itemPos:itemPos,type:type})}},dblclick=function(d,i){var eventType=chartObj.zcEventType||"doubleclick";handleUserCallback(currentPoint,eventType,d3$1.event,d)};attachevents(element,{mousemove:mousemove,mouseout:mouseout,click:click,dblclick:dblclick},{singletouchmove:mousemove,touchend:mouseout,tap:click,dbltap:dblclick},{target:"plot",touchleave:!0,chartObj:chartObj})}function handleUserCallback(data,type,event,d){return invokeFunction(events_dial[type],event,createUserObject(d),chartObj)}function createUserObject(d){var val=isLevelMarker?d[1]:d[options.dataindex];return{value:val,formattedValue:getFormattedValue(formatConf,val,datatype,chartObj),actualData:currentPoint,data:metaInfo=metaInfo||chartObj.dataset.getMetaInfoObj(chartObj,currentPoint,0)}}},dialUtils.targetMarker=function(container,OR,innerRadius,chartObj,handleEvent){var element,triggerOffset,systemconf=chartObj.systemConf,commonPlotOptions=systemconf.chart.plot.plotoptions.dial,dataset=chartObj.dataset,yscale=chartObj.axes.y.groups[0].scale,minMax=yscale.domain(),data=chartObj.seriesdata,targetMarkerOptions=commonPlotOptions.targetMarker,align=targetMarkerOptions.align,dAlign=targetMarkerOptions.dAlign,padding=+(targetMarkerOptions.padding||0),symbol_rotation=/line/.test(targetMarkerOptions.symbol)?90:0,default_size=!/(outer|inner)/g.test(align)&&/line/.test(targetMarkerOptions.symbol)?(OR-innerRadius-2*padding)/10:1,size=10*validateNullVal(targetMarkerOptions.size,default_size),extraOptions={symbolSize:{outer:1,inner:.5},color:chartObj.seriesColor[0],strokeWidth:default_size},dr=dAlign===OUTER_ALIGN?size/2+padding:dAlign===INNER_ALIGN?-size/2-padding:0,r=align===OUTER_ALIGN?OR+dr:align===INNER_ALIGN?innerRadius+dr:(OR+innerRadius)/2,targetMarker=appendEle(container,"g",targetMarkerOptions.enabled?[data[0].data[0][0]]:[],".","class","targetmarker"),targetMarkerEventHandler=appendEle(container,"g",targetMarkerOptions.enabled&&handleEvent?[data[0].data[0][0]]:[],".","class","targetmarker-eventhandler");targetMarker.attr("transform",getPosition).styles({display:getDisplay,"stroke-dasharray":getDashArray(targetMarkerOptions.dashStyle,validateNullVal(targetMarkerOptions.outerStrokeWidth,1)),"stroke-linecap":getLineCap(targetMarkerOptions.lineCap,targetMarkerOptions.dashStyle)}).each(function(){addSVGmarker(d3_select(this),null,targetMarkerOptions,extraOptions,chartObj)}),element=targetMarkerEventHandler,triggerOffset=targetMarkerOptions.events&&targetMarkerOptions.events.triggerOffset||0,extraOptions.strokeWidth=(size+2*triggerOffset)/10,element.attrs({transform:getPosition,class:function(d,i){return"ZCtargetmarker_eventhandler_"+i}}).styles({display:getDisplay,opacity:0}).each(function(){var ele=d3_select(this);if(addSVGmarker(ele,null,targetMarkerOptions,extraOptions,chartObj),"line"===targetMarkerOptions.symbol){var w=size>=OR-innerRadius?size:mathMax(size+triggerOffset,OR-innerRadius),h=triggerOffset||1;ele.selectAll("*").attr("d",getSVGsymbol("rect")(w,h))}}),dialUtils.handleEvents(chartObj,targetMarkerEventHandler,targetMarkerOptions,"targetmarker",data);var targetLabelOptions=targetMarkerOptions.label||{},targetLabelPadding=validateNullVal(targetLabelOptions.padding,2),targetLabelRadius=align===OUTER_ALIGN?r+size/2+targetLabelPadding:align===INNER_ALIGN?(dAlign===OUTER_ALIGN?innerRadius:r-size/2)-targetLabelPadding:OR+targetLabelPadding,targetLabel=appendEle(container,"text",targetMarkerOptions.enabled&&pick(targetLabelOptions.enabled,!0)&&!chartObj.renderer[0].firedList.targetSeries?[data[0].data[0][0]]:[]);function getPosition(d){var targetValue=d[targetMarkerOptions.dataindex];if(defined(targetValue)){targetValue=dialUtils.getValueWithinRange(targetValue,minMax);var angle_radian=yscale(targetValue),xy=polarToXY(r,angle_radian),angle_degree=radianToDegree(angle_radian)+symbol_rotation;return"translate("+xy[0]+","+xy[1]+") rotate("+angle_degree+",0,0)"}}function getDisplay(d){return defined(d[targetMarkerOptions.dataindex])?null:NONE}applyFont(targetLabel,[targetLabelOptions,systemconf.chart,systemconf.canvas,$ZCG]),targetLabel.each(function(d){var ele=d3_select(this);ele.style("display",NONE);var targetValue=d[targetMarkerOptions.dataindex];if(defined(targetValue)){if(targetValue=dialUtils.getValueWithinRange(targetValue,minMax),JSON.parse(commonPlotOptions.minmaxlabels.show)&&-1!=minMax.indexOf(targetValue))return;var angle=yscale(targetValue),angle_radian=d0_360(angle),xy=polarToXY(targetLabelRadius,angle),columns=chartObj.userdata.metadata.columns,columnidx=columns.filter(function(d){return d.dataindex===targetMarkerOptions.dataindex}),targetColumn=columnidx.length?columnidx[0]:columns[dataset.getColumnIdx("y",0)],datatype=targetColumn.datatype,formatConf=targetColumn[datatype],TEXTANCHOR=align===INNER_ALIGN?angle_radian<0||angle_radian>mathPI?null:"end":angle_radian<0||angle_radian>mathPI?"end":null,DY=align===INNER_ALIGN?angle_radian>mathPI/2&&angle_radian<3*mathPI/2?null:-getDY(angle_radian)+"em":angle_radian>mathPI/2&&angle_radian<3*mathPI/2?getDY(angle_radian)+"em":null,TEXT=defined(targetLabelOptions.text)?dataset.getCustomizedVal(chartObj,targetLabelOptions.text,0,null,null,d,"targetLabel"):getFormattedValue(formatConf,targetValue,datatype,chartObj,"targetLabel");ele.text(TEXT).style("display",null).attrs({"text-anchor":TEXTANCHOR,dy:DY,transform:"translate("+xy[0]+","+xy[1]+")"})}})},svg_plot_renderer.dial=function(){var commonRendererProp,chartObj,innerRadius,color,commonPlotOptions,dataset,yaxiscolumnorder,totalEngagement,plotarea_approx,yscale,minMax,hasNegValue,previousRadiusFactors,previousOuterRadius,previousInnerRadius,currentRadiusFactors,arc,isredraw=!1,pie=svg_plot_renderer.pie();function chart(selection){return selection.each(function(data){var rp=commonRendererProp.params;chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,color=rp.color,dataset=rp.dataset,yaxiscolumnorder=rp.yaxiscolumnorder,chartObj.systemConf;var plotoptions=data[0].plotoptions;totalEngagement=dataset.getY(data[0].data[0][0],yaxiscolumnorder),hasNegValue=totalEngagement<0;var defsLocation=chartObj.defsLocation,labelQueue=rp.labelQueue;yscale=chartObj.axes.y.groups[0].scale,minMax=yscale.domain(),plotarea_approx=chartObj.plotarea_approx;var animationOptions=getAnimationConf(commonPlotOptions=plotoptions?mergeJSON(commonPlotOptions,plotoptions,!0):commonPlotOptions,plotoptions,chartObj,DIAL_CHARTNAME),isAnimationEnable=animationOptions.enabled,easingType=animationOptions.easingType,transitionDuration=isredraw?isAnimationEnable?200:0:animationOptions.duration,container=d3_select(this).data(function(data){var dt=data[0].data[0];return data[0].data[0]=[dt[0]],[data]}(data));container.selectAll(PATH_ELEMENT+".dial").data();var levelMarkerConf=commonPlotOptions.levelMarker;currentRadiusFactors=commonPlotOptions.innerRadius+" _ "+commonPlotOptions.outerPadding+" _ "+commonPlotOptions.maxRadius+" _ "+commonPlotOptions.bandWidth+" _ "+levelMarkerConf.bandWidth+" _ "+levelMarkerConf.innerPadding+" _ "+levelMarkerConf.outerPadding;var visibility,innerPadding,outerPadding,OR=plotarea_approx.radius,levelmarkerSW=validateNullVal(levelMarkerConf.strokeWidth,1),IR=getInnerRadius(commonPlotOptions,OR);if(arc=d3_arc().endAngle(function(d){return yscale(d[1])}),defined(levelMarkerConf.bandWidth)||defined(levelMarkerConf.maxBandWidth)){var maxLevelMarkerBandWidth=validateNullVal(levelMarkerConf.maxBandWidth,OR),levelMarkerBandWidth=Math.min(perToPx(levelMarkerConf.bandWidth,OR,OR-IR),maxLevelMarkerBandWidth);innerPadding=(OR-IR-levelMarkerBandWidth)/2,outerPadding=(OR-IR-levelMarkerBandWidth)/2,visibility=0===levelMarkerBandWidth?"hidden":null}else innerPadding=mathMax(0,perToPx(levelMarkerConf.innerPadding,OR,0)),outerPadding=mathMax(0,perToPx(levelMarkerConf.outerPadding,OR,0));arc.innerRadius(IR+innerPadding).outerRadius(OR-outerPadding-.5*levelmarkerSW).startAngle(function(d){return yscale(d[0])});var levelsInfo=chart.levelMarker=dialUtils.createLevelsNColors(data,levelMarkerConf,color,minMax),levelmarkerClr=levelsInfo.colors,levelmarker=appendEle(appendEle(container,"g",[1],".","class","levelmarkerSeries"),PATH_ELEMENT,levelMarkerConf.enabled?levelsInfo.values:[]);levelmarker.attr("class",function(d,i){return"ZClevelmarker_"+i}).attr("transform","translate("+plotarea_approx.x+","+plotarea_approx.y+")").styles({stroke:function(d,i){return levelMarkerConf.strokeColor||levelmarkerClr[i]},"stroke-width":levelmarkerSW,"stroke-opacity":levelMarkerConf.strokeOpacity,"fill-opacity":levelMarkerConf.fillOpacity,fill:function(d,i){var clr=levelmarkerClr[i],prop=getGradientProp(commonPlotOptions.gradients,[OR,OR],clr),gradientID=prop?effects.get(effects.svg_gradients,"svgGradientFill",prop,{offset:"pie",chartObj:chartObj}):null;return gradientID?"url("+defsLocation+"#"+gradientID+")":clr},visibility:visibility}),isredraw&&currentRadiusFactors!=previousRadiusFactors?levelmarker.transition().duration(transitionDuration).ease(d3_ease_linear).call(function(element){arcInnerTween(element,arc,[previousInnerRadius,arc.innerRadius()()],[previousOuterRadius,arc.outerRadius()()])}):levelmarker.attr("d",arc),dialUtils.handleEvents(chartObj,levelmarker,levelMarkerConf,"levelmarker",data),commonRendererProp.commonPlotOptions(commonPlotOptions),pie.commonRendererProp(commonRendererProp),pie.chartRendered=!1,container.call(pie),innerRadius=pie.innerRadius();var targetMarkerSeries=appendEle(container,"g",[1],".","class","targetSeries");dialUtils.targetMarker(targetMarkerSeries,plotarea_approx.actualRadius,plotarea_approx.innerRadius,chartObj,!0),targetMarkerSeries.attr("transform","translate("+plotarea_approx.x+","+plotarea_approx.y+")");var needleOptions=commonPlotOptions.needle;appendEle(container,PATH_ELEMENT,needleOptions.show?[totalEngagement]:[],".","class","dial").attr("d",dialUtils.getNeedlePolygon(needleOptions,plotarea_approx,innerRadius)).styles({stroke:needleOptions.strokeColor||"black","stroke-width":needleOptions.strokeWidth,fill:needleOptions.fillColor||NONE}).transition().duration(transitionDuration).ease(easingType).call(dialTween),labelRenderer&&labelQueue.push({renderer:chart,charttype:DIAL_CHARTNAME,chartObj:chartObj,args:[data,0]})}),chart}function dialTween(element){var currentValue,previousValue,currentAngle,previousAngle,cx=plotarea_approx.x,cy=plotarea_approx.y,baseValue=void 0!==commonPlotOptions.baseValue?commonPlotOptions.baseValue:0;element.attrTween("transform",function(d,i){isredraw?previousAngle=getSvgTransform(this).rotate:(previousValue=hasNegValue?minMax[1]:minMax[0],null!=baseValue&&(previousValue=hasNegValue?mathMin(baseValue,previousValue):mathMax(baseValue,previousValue)),previousAngle=radianToDegree(yscale(previousValue))),currentValue=mathMin(mathMax(d,minMax[0]),minMax[1]),currentAngle=radianToDegree(yscale(currentValue));var interpolateAngle=d3_interpolate(previousAngle,currentAngle);return function(t){return"translate("+cx+","+cy+") rotate("+interpolateAngle(t)+",0,0)"}})}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.endFunctions=function(){previousRadiusFactors=currentRadiusFactors,previousOuterRadius=arc.outerRadius()(),previousInnerRadius=arc.innerRadius()(),chart.chartRendered=!0,isredraw=!0},chart.defaultMouseOutFunc=function(){if(chartObj.systemConf.tooltip.enabled){var tooltip=chartObj.eventHandler.tooltipElement;tooltip.hide(tooltip.element)}},chart},svg_plot_renderer.packedbubble=function(){var commonRendererProp,bubbleGroup,path,chartObj,commonPlotOptions,mode,zchighlighterPosition,highlightGroup,highlightEle,multiColoring,valueFunction,includeDisabledSeries,pack=d3_pack(),isredraw=!1,seriesGroup=[];function chart(selection){return selection.each(function(data){var rp=commonRendererProp.params;chartObj=rp.chartObj;var color=rp.color,notesArray=rp.notesArray,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,systemconf=chartObj.systemConf,labelQueue=rp.labelQueue;commonPlotOptions=rp.commonPlotOptions;var fillColor=chart.fillColorFunc=getFillColor(chartObj,0),strokeColor=getStrokeColor(chartObj,0),cloneddata=data.filter(function(d,i){return d.seriesIndex=i,seriesGroup[i]=[],!d.disabled}),chartWidth=chartObj.plotarea.width,chartHeight=chartObj.plotarea.height,isSingleSeries=1===cloneddata.length,isPatternPalleteEnabled=legend_helpers.hasPatternPallete(chartObj)||chartObj.patternPallete,notesOptions=chartObj.systemConf.notes,notesEnabled=notesOptions&&!0===notesOptions.enabled&&notesOptions.plotValues;mode=commonPlotOptions.mode,multiColoring=isMultiColoring(commonPlotOptions,chartObj);var NegativeAsAbsolute="absolute"===commonPlotOptions.showAsNegative,interPadding=+commonPlotOptions.interPadding||0,outerPadding=+commonPlotOptions.outerPadding||0,diameter=mathMin(chartWidth,chartHeight)-outerPadding;zchighlighterPosition=[chartObj.plotarea.left+(chartWidth-diameter)/2,chartObj.plotarea.top+(chartHeight-diameter)/2],valueFunction=function(d){if(!includeDisabledSeries&&isDisabled(d))return 0;var y=dataset.getY(d,yaxiscolumnorder)||0;return y<0?NegativeAsAbsolute?mathAbs(y):0:y};var eventDisabled=0==validateNullVal(getEventConf(null,commonPlotOptions,chartObj,"enabled"),!0),cursor=commonPlotOptions.events?commonPlotOptions.events.cursor||"pointer":systemconf.chart.plot.events.cursor||"pointer",animationOptions=getAnimationConf(commonPlotOptions,null,chartObj,PACKEDBUBBLE_CHARTNAME),isAnimationEnable=animationOptions.enabled,animationType=animationOptions.type,easingType=animationOptions.easingType,transitionDuration=isredraw?isAnimationEnable?200:0:animationOptions.duration,final_transform=function(d){return"translate("+d.x+","+d.y+")"},final_r=function(d){return d.r},final_fillOpacity=function(d,i){return commonPlotOptions.fillOpacity},final_strokeOpacity=function(d,i){return commonPlotOptions.strokeOpacity},isFade=!isredraw&&(animationType===FADE_ANIMATION||animationType===FADEALL_ANIMATION);pack.size([diameter,diameter]).padding(interPadding),(bubbleGroup=appendEle(selection,"g",[1],".","class","hierarchychart")).attr("transform","translate("+(chartWidth-diameter)/2+","+(chartHeight-diameter)/2+")").style("cursor",cursor),(path=appendEle(bubbleGroup,CIRCLE_ELEMENT,getPackNodeDescendants(data,!0))).attrs({class:function(d){return"series_"+getSeriesPos(d)}}).style("visibility",function(d){return isDisabled(d)?"hidden":null}),path=path.filter(function(d){return!isDisabled(d)});var packedData=getPackNodeDescendants(cloneddata);chart.total=packedData[0].value,(path=path.data(packedData)).attrs({transform:isFade?final_transform:function(d){var transform=d3_select(this).attr("transform");return null!=transform?transform:"translate("+diameter/2+","+diameter/2+")"},r:isFade?final_r:function(d){var r=d3_select(this).attr("r");return null!=r?r:0}}).styles({fill:function(d,i){d.index=i,d.r=d.r||0,d.x=d.x||0,d.y=d.y||0,d.data.parent=d.parent,notesEnabled&&(d.data.x=d.x,d.data.y=d.y),!d.children&&d.parent&&seriesGroup[getSeriesPos(d)].push(d),d.depth?"flat"!==mode&&1===d.depth&&multiColoring?d.arcColor="grey":d.arcColor=color[(multiColoring?getItemPos(d):getSeriesPos(d))%color.length]:d.arcColor="flat"==mode||multiColoring||isSingleSeries?NONE:"grey";var baseClr=function(d){return d.children?d.arcColor:null}(d);return d.fillColor=!d.depth&&isPatternPalleteEnabled?NONE:fillColor(multiColoring?getItemPos(d):getSeriesPos(d),d.data,null,baseClr)},"fill-opacity":isFade?0:final_fillOpacity,"stroke-opacity":isFade?0:final_strokeOpacity,stroke:function(d){return d.arcColor===NONE?NONE:commonPlotOptions.strokeColor?commonPlotOptions.strokeColor:d.children?d.arcColor:strokeColor(multiColoring?getItemPos(d):getSeriesPos(d),d.data)},"stroke-width":function(d){return commonPlotOptions.strokeWidth},"pointer-events":function(d){return eventDisabled||d.children?NONE:NULL}});var total=path.size(),dur=isredraw||animationType!==FADE_ANIMATION?transitionDuration:transitionDuration/total,del=animationType===FADE_ANIMATION?dur:0;if(path.transition().delay(function(d,i){return isredraw?0:i*del}).duration(dur).ease(isredraw?d3_ease_linear:easingType).attrs({transform:final_transform,r:final_r}).styles({"fill-opacity":final_fillOpacity,"stroke-opacity":final_strokeOpacity}),setPointerEvents(chartObj,path,eventDisabled),!eventDisabled){var mousemove=function(d,i){var args=getEventArgs(d,i);chartObj.eventHandler.mouseMove(args)},mouseout=function(d,i){chartObj.eventHandler.mouseOut(chart,d,getSeriesPos(d))},click=function(d,i){var args=getEventArgs(d,i);chartObj.eventHandler.click(chart,d,getSeriesPos(d),getItemPos(d),args)},dblclick=function(d,i){if(chart.chartRendered){var dt=annotation?generateDataForAnnotation(d.data,data.length>1?data[getSeriesPos(d)].seriesname:null):d.data,coordinates=[d.x,d.y],args={coordinate:coordinates=[coordinates[0]+(chartWidth-diameter)/2,coordinates[1]+(chartHeight-diameter)/2],data:dt,basedOn:"plot"};chartObj.eventHandler.doubleclick(d,getSeriesPos(d),args)}},eventAttacherOptions={target:"plot",touchleave:!0,chartObj:chartObj},mouseHandlers={mousemove:mousemove,mouseout:mouseout,click:click,dblclick:dblclick},touchHandlers={singletouchmove:mousemove,touchend:mouseout,tap:click,dbltap:dblclick};attachevents(path.filter(function(d){return!d.children}),mouseHandlers,touchHandlers,eventAttacherOptions)}function getEventArgs(d,i){var ev=getEventObject(d3$1.event);return{renderer:chart,seriesPos:getSeriesPos(d),subseriesPos:0,itemPos:getItemPos(d),coordinates:[ev.pageX,ev.pageY],element:this,data:d}}chart.renderedTimer=setTimeout(function(){if(annotation&&data.forEach(function(series,i){notesArray=annotation.preprocessAnnotations(data,i,function(dt,k,j){var c=[dt.x,dt.y];return[c[0]+(chartWidth-diameter)/2,c[1]+(chartHeight-diameter)/2]},notesArray,chartObj,rp)}),labelRenderer){var transform=[(chartWidth-diameter)/2,(chartHeight-diameter)/2],totalFunc=function(d,showAs){return showAs===PERCENT_SHOWAS?chart.total:d.parent.value};data.forEach(function(d,i){labelQueue.push({renderer:chart,charttype:"hierarchy",chartObj:chartObj,args:[data[i],i,null,null,totalFunc,seriesGroup[i],transform]})})}isredraw=!0,chart.chartRendered=!0},transitionDuration+17)}),chart}function getChildren(node){var depth=node.level&&node.level.split("_").length;return!chartObj.dataObject.hasHierarchyData&&1==depth&&node.length<2&&node[0]&&isArray(node[0][0])?node[0]:isArray(node[0])?isArray(node[0][0])?node:node.filter(function(d){return isArray(d[0])||valueFunction(d)>0}):null}function getSeriesPos(d){var level=d.level||d.data&&d.data.level;if(level)return+level.split("_")[0]}function getItemPos(d){return d.data.itemPos}function isDisabled(d){var seriesIndex=getSeriesPos(d);return defined(seriesIndex)&&chartObj.seriesdata[seriesIndex].disabled}function getPackNodeDescendants(data,include){includeDisabledSeries=include;var order=commonPlotOptions.order||d3_ascending;"string"==typeof order&&(order=getPropVal(window,order));var root=d3$1.hierarchy(function(root){var leafNodes=[];function parseID(node,ID){var indices=ID.split(/_/);node.seriesPos=+indices[0],node.itemPos=+indices[indices.length-1]}return function recurse(node,prevID){var child=getChildren(node);child?child.forEach(function(c,i){var ID=defined(prevID)?prevID+"_"+i:c.seriesIndex+"";parseID(c,ID),recurse(c,ID)}):(parseID(node,prevID),"flat"==mode&&leafNodes.push(node))}(root),"flat"==mode?leafNodes:root}(data),getChildren).sum(valueFunction).sort(order);return pack(root),root.descendants()}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.defaultMouseOverFunc=function(d,seriesPos,itemPos){highlightGroup||(highlightGroup=chartObj.staticPaneSVG.selectAll("g#zchierarchyhighlight"),highlightEle=appendEle(highlightGroup,PATH_ELEMENT,[1]));var refElement=d3_select(path.nodes()[d.index]),refElementPosition=getSvgTransform(refElement).translate,highlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(seriesPos,"selectedSeries","plot"),currentColor=getRawColor(chartObj,multiColoring?itemPos:seriesPos,d.data,seriesPos);highlightGroup.style("opacity",null),highlightEle.attrs({transform:"translate("+(zchighlighterPosition[0]+refElementPosition[0])+","+(zchighlighterPosition[1]+refElementPosition[1])+")",d:getSVGsymbol("circle")(2*+refElement.attr("r"))}).styles(chartObj.legendHighlight.getEffect(highlightEffect,PACKEDBUBBLE_CHARTNAME,HIGHLIGHT_EFFECT_REGEX.test(highlightEffect)?currentColor:TRANSPARENT,{fill:TRANSPARENT,stroke:currentColor},multiColoring?itemPos:seriesPos,"plot"))},chart.defaultMouseOutFunc=function(d,i){highlightGroup||(highlightGroup=chartObj.staticPaneSVG.selectAll("g#zchierarchyhighlight")),highlightGroup.style("opacity",0)},chart},treemapUtils.addEvents=function(layoutObj){var prevPoint,chartObj=layoutObj.chartObj,dimension=layoutObj.dimension,commonPlotOptions=layoutObj.rp.commonPlotOptions,getSeriesIndex=treemapUtils.getSeriesIndex,getItemIndex=treemapUtils.getItemIndex,seriesdata=chartObj.seriesdata,renderer=chartObj.renderer[0],translation=[chartObj.plotarea.left+dimension.x,chartObj.plotarea.top+dimension.y],fillColor=seriesdata.map(function(d,seriesIndex){return getFillColor(chartObj,seriesIndex,[dimension.width,dimension.height],NULL,"svg")}),element=chartObj.eventHandler.trackerElement;function mouseMove(){var d=getNonAxisDataPoint(layoutObj);if(d){var args=getEventArgs(d,NULL,renderer);chartObj.eventHandler.mouseMove(args);var cursor=getEventConf(chartObj.seriesdata[treemapUtils.getSeriesIndex(d)].plotoptions,commonPlotOptions,chartObj,"cursor");chartObj.eventHandler.addCursor(cursor)}else prevPoint&&(chartObj.eventHandler.mouseOut(renderer,prevPoint,getSeriesIndex(prevPoint)),chartObj.eventHandler.hideCursor());prevPoint=d}function mouseOut(){var d=prevPoint;d?chartObj.eventHandler.mouseOut(renderer,d,getSeriesIndex(d)):defaultMouseOutFunc()}function click(){var d=getNonAxisDataPoint(layoutObj);if(d){var args=getEventArgs(d,NULL,renderer);chartObj.eventHandler.click(renderer,d,getSeriesIndex(d),getItemIndex(d),args),prevPoint=d}}function doubleClick(){var d=getNonAxisDataPoint(layoutObj);if(d){var dt=annotation?generateDataForAnnotation(d,seriesdata.length>1?seriesdata[getSeriesIndex(d)].seriesname:NULL):d,tileBound=treemapUtils.getTileBound(chartObj,d),args={coordinate:[tileBound.x+dimension.x,tileBound.y+dimension.y],data:dt,basedOn:"plot"};chartObj.eventHandler.doubleclick(d,getSeriesIndex(d),args),prevPoint=d}}function defaultMouseOutFunc(d,i){chartObj.staticPaneSVG.selectAll("g#zchierarchyhighlight").style("opacity",0)}drawBorderBox(element,chartObj.plotarea),function(element){element.node().__on.forEach(function(d){element.on("."+d.name,NULL)})}(element),renderer.defaultMouseOverFunc=function(d,seriesPos,itemPos){d=d.data||d;var borderRadius=chartObj.dataObject.getTransRectValue("radius",NULL,NULL,NULL,NULL,commonPlotOptions.borderRadius),multiColoring=isMultiColoring(commonPlotOptions,chartObj),highlightGroup=chartObj.staticPaneSVG.selectAll("g#zchierarchyhighlight"),highlightEle=highlightGroup.selectAll(PATH_ELEMENT),highlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(seriesPos,"selectedSeries","plot"),unHighlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(seriesPos,"unselectedSeries","plot"),rawColor=getRawColor(chartObj,multiColoring?itemPos:seriesPos,d,seriesPos),currentColor=HIGHLIGHT_EFFECT_REGEX.test(highlightEffect)||UNHIGHLIGHT_EFFECT_REGEX.test(unHighlightEffect)?rawColor:TRANSPARENT,node=renderer.getProcessedNode(d),tileBound=treemapUtils.getTileBound(chartObj,node);highlightGroup.style("opacity",NULL),highlightEle.attr("d",function(){var node=renderer.getProcessedNode(d),tileBound=treemapUtils.getTileBound(chartObj,node);return"canvas"===chartObj.plot.renderer.mode&&(borderRadius=checkRadiusWithinBoundary(borderRadius,tileBound.width,tileBound.height,!0)),roundedRect(tileBound.x,tileBound.y,tileBound.width,tileBound.height,borderRadius)}).style("fill",currentColor===TRANSPARENT?TRANSPARENT:fillColor[seriesPos](seriesPos,d,NULL,NULL,NULL,[tileBound.width,tileBound.height])).styles(chartObj.legendHighlight.getEffect(highlightEffect,"treemap",currentColor,{fill:currentColor,stroke:rawColor},multiColoring?itemPos:seriesPos,"plot"))},renderer.defaultMouseOutFunc=defaultMouseOutFunc,appendEle(chartObj.staticPaneSVG.selectAll("g#zchierarchyhighlight").attr("transform","translate("+translation+")"),PATH_ELEMENT,[1]),attachevents(element,{mousemove:mouseMove,mouseout:mouseOut,click:click,dblclick:doubleClick},{singletouchmove:mouseMove,touchend:mouseOut,tap:click,dbltap:doubleClick},{target:"plot",touchleave:!0,chartObj:chartObj})};var treemapLayout=function(commonRendererProp){var rp=this.rp=commonRendererProp.params,chartObj=this.chartObj=rp.chartObj;this.commonRendererProp=commonRendererProp,this.dimension=rendererBoundUtils.getAvailableBound(chartObj,rp.commonPlotOptions),this.createScale(),this.layout=this.getLayout(),this.processData()};treemapLayout.prototype.createScale=function(){var chartObj=this.chartObj,dimension=this.dimension;chartObj.axes.x.scale=d3_scaleLinear().domain([0,dimension.width]).range([0,dimension.width]),chartObj.axes.y.groups[0]=chartObj.axes.y.groups[0]||{},chartObj.axes.y.groups[0].scale=d3_scaleLinear().domain([0,dimension.height]).range([0,dimension.height])},treemapLayout.prototype.getLayout=function(){var dimension=this.dimension,commonPlotOptions=this.rp.commonPlotOptions,parentOptions=commonPlotOptions.parent,padding=parseShortHandValue(commonPlotOptions.padding),mode=commonPlotOptions.mode;return d3_treemap().size([dimension.width,dimension.height]).tile(d3_tiles(mode)).round(!0).paddingInner(function(d){return d.value&&(d.children[0]&&d.children[0].children?parentOptions:commonPlotOptions).interPadding||0}).paddingTop(function(d){return d.depth&&d.value?padding.top:0}).paddingBottom(function(d){return d.depth&&d.value?padding.bottom:0}).paddingLeft(function(d){return d.depth&&d.value?padding.left:0}).paddingRight(function(d){return d.depth&&d.value?padding.right:0})},treemapLayout.prototype.getValue=function(d){var chartObj=this.chartObj,rp=this.rp,seriesIndex=treemapUtils.getSeriesIndex(d),yaxiscolumnorder=DataProcessor.helpers.getParsedYAxisOrder(chartObj.seriesdata[seriesIndex||0].yaxiscolumnorder),y=chartObj.dataset.getY(d,yaxiscolumnorder)||0,negativeAsAbsolute="absolute"===rp.commonPlotOptions.negativeAs;return treemapUtils.isDisabled(chartObj,d)?0:y<0?negativeAsAbsolute?mathAbs(y):0:y},treemapLayout.prototype.getChildren=function(node){var level=treemapUtils.getLevel(node),depth=level&&level.split("_").length;return!this.chartObj.dataObject.hasHierarchyData&&1==depth&&node.length<2&&node[0]&&isArray(node[0][0])?node[0]:isArray(node[0])?node:NULL},treemapLayout.prototype.processData=function(){var self=this,chartObj=self.chartObj,commonRendererProp=self.commonRendererProp,dimension=self.dimension,rp=self.rp,commonPlotOptions=rp.commonPlotOptions,color=rp.color,colorScheme=commonPlotOptions.colorScheme||"solid",previousSiblingsCounter=0,previousSiblingsCount={},colorLighter=[],childColorIndex=[],seriesWiseNodes=[],leafNodes=[],nodes=[],fillColor=[],root=d3$1.hierarchy(self.chartObj.seriesdata,function(d){return self.getChildren(d)}).sum(function(d){return self.getValue(d)}),processedData=self.layout(root).descendants();self.chartObj.seriesdata.forEach(function(d,i){var nonRGBAColor=color[i%color.length];fillColor[i]=getFillColor(chartObj,i,[dimension.width,dimension.height]),childColorIndex[i]=0,seriesWiseNodes[i]=[],seriesWiseNodes[i].disabled=d.disabled,seriesWiseNodes[i].plotoptions=d.plotoptions,colorLighter[i]=d3_scaleLinear().domain([0,getChildrenCount(d)]).range([nonRGBAColor,getColorCopy(nonRGBAColor,"solid"===colorScheme?0:"shades"===colorScheme?-1:1,"brighter",d3$1.hsl)])}),processedData.forEach(function(d,i){var level=treemapUtils.getLevel(d),seriesIndex=treemapUtils.getSeriesIndex(d),itemIndex=treemapUtils.getItemIndex(d);if(d.index=i,d.depth){if(d.data.color)d.data.arcColor=d.data.color;else{var c=isMultiColoring(commonPlotOptions,chartObj)?color[itemIndex%color.length]:colorLighter[seriesIndex](childColorIndex[seriesIndex]);d.data.arcColor=c}nodes[level]=d}d.children?d.data.arcColor=treemapUtils.getParentColor(commonRendererProp,d):(leafNodes[seriesIndex]||(leafNodes[seriesIndex]=[]),leafNodes[seriesIndex].push(d),childColorIndex[seriesIndex]++),d.depth&&seriesWiseNodes[seriesIndex].push(d),treemapUtils.isDisabled(chartObj,d)||(previousSiblingsCount[level]=previousSiblingsCounter++)}),chartObj.renderer[0].fillColorFunc=fillColor[0],self.processedData=processedData,self.previousSiblingsCount=previousSiblingsCount,self.seriesWiseNodes=seriesWiseNodes,self.leafNodes=leafNodes,self.nodes=nodes,self.fillColor=fillColor},svg_plot_renderer.treemap=function(){var commonRendererProp,treemapGroup,path,chartObj,commonPlotOptions,layoutObj,dimension,leafNodes,seriesWiseNodes,isredraw=!1,getLevel=treemapUtils.getLevel,getSeriesIndex=treemapUtils.getSeriesIndex;function chart(selection){return selection.each(function(data){var rp=commonRendererProp.params;chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions;var notesArray=rp.notesArray,systemconf=chartObj.systemConf,labelQueue=rp.labelQueue;layoutObj=new treemapLayout(commonRendererProp),dimension=layoutObj.dimension,layoutObj.nodes,leafNodes=layoutObj.leafNodes,seriesWiseNodes=layoutObj.seriesWiseNodes;var strokeWidth=commonPlotOptions.strokeWidth,strokeOpacity=commonPlotOptions.strokeOpacity,fillOpacity=commonPlotOptions.fillOpacity,fillColor=layoutObj.fillColor,strokeColor=getStrokeColor(chartObj,0),borderRadius=chartObj.dataObject.getTransRectValue("radius",NULL,NULL,NULL,NULL,commonPlotOptions.borderRadius),transform=[dimension.x,dimension.y],animationOptions=getAnimationConf(commonPlotOptions,NULL,chartObj,"treemap"),isAnimationEnable=animationOptions.enabled,animationType=animationOptions.type,easingType=isredraw?d3_ease_linear:animationOptions.easingType,transitionDuration=isredraw?isAnimationEnable?200:0:animationOptions.duration,dataCount=chartObj.dataObject.totalnoofdatas,duration=isredraw?transitionDuration:animationType===FADEONEBYONE_ANIMATION?transitionDuration/dataCount:transitionDuration,delay=isredraw?0:animationType===FADEONEBYONE_ANIMATION?function(d){return layoutObj.previousSiblingsCount[getLevel(d)]*(transitionDuration/dataCount)}:animationType===FADERANDOM_ANIMATION?function(){return mathRandom()*dataCount*(transitionDuration/dataCount)}:0,initialOpacity=animationType===FADEALL_ANIMATION||animationType===FADERANDOM_ANIMATION||animationType===FADEONEBYONE_ANIMATION?0:NULL,cursor=commonPlotOptions.events?commonPlotOptions.events.cursor||POINTER:systemconf.chart.plot.events.cursor||POINTER,parentOptions=commonPlotOptions.parent,parentCursor=parentOptions.events.cursor;(treemapGroup=appendEle(selection,"g",[data],".","class","hierarchychart")).attr("transform","translate("+dimension.x+","+dimension.y+")").styles({"stroke-width":strokeWidth,"stroke-opacity":strokeOpacity,"fill-opacity":fillOpacity,cursor:cursor});var processedData=layoutObj.processedData;chart.total=processedData[0].value,path=appendEle(treemapGroup,PATH_ELEMENT,processedData),chart.total||path.remove(),path.styles({fill:function(d){if(d.children)return d.fillColor=d.data.arcColor;var tileBound=treemapUtils.getTileBound(chartObj,d),seriesIndex=getSeriesIndex(d);return d.fillColor=fillColor[seriesIndex](seriesIndex,d.data,NULL,NULL,NULL,[tileBound.width,tileBound.height])},stroke:function(d){var customStrokeColor=(d.children?parentOptions.strokeColor:NULL)||commonPlotOptions.strokeColor;return d.depth?customStrokeColor||(d.children?d.data.arcColor:strokeColor(getSeriesIndex(d),d.data)):TRANSPARENT},visibility:function(d){return d.value?NULL:"hidden"}}).attr("class",function(d,i){if(defined(getLevel(d)))return"series_"+getSeriesIndex(d)+(d.children?" zchierarchyparent":"")}).attr("id",function(d){return"tree_"+getLevel(d)}),treemapGroup.selectAll(PATH_ELEMENT+".zchierarchyparent").styles({"stroke-width":parentOptions.strokeWidth,"stroke-opacity":parentOptions.strokeOpacity,"fill-opacity":parentOptions.fillOpacity,cursor:parentCursor}),isredraw||path.attr("transform",function(d){var tileBound=treemapUtils.getTileBound(chartObj,d),tX=tileBound.x+tileBound.width/2,tY=tileBound.y+tileBound.height/2;return animationType===RANDOMOUT_ANIMATION?(tX=dimension.width/2,tY=dimension.height/2):animationType===HORIZONTALALL_ANIMATION?tX=tileBound.width/2:animationType===VERTICALALL_ANIMATION&&(tY=tileBound.height/2),"translate("+tX+","+tY+")"}).attr("d",function(d){var tileBound=treemapUtils.getTileBound(chartObj,d),x=-tileBound.width/2,y=-tileBound.height/2,w=tileBound.width,h=tileBound.height;return animationType===HORIZONTALALL_ANIMATION?w=0:animationType===VERTICALALL_ANIMATION&&(h=0),roundedRect(x,y,w,h,borderRadius)}).style("opacity",initialOpacity),path.transition().duration(duration).delay(delay).ease(easingType).attr("transform",function(d){var tileBound=treemapUtils.getTileBound(chartObj,d);return"translate("+(tileBound.x+tileBound.width/2)+","+(tileBound.y+tileBound.height/2)+")"}).attr("d",function(d){var tileBound=treemapUtils.getTileBound(chartObj,d);return roundedRect(-tileBound.width/2,-tileBound.height/2,tileBound.width,tileBound.height,borderRadius)}).style("opacity",NULL),chart.renderedTimer=setTimeout(function(){if(labelRenderer){var totalFunc=function(d,showAs){return showAs===PERCENT_SHOWAS?chart.total:chart.getProcessedNode(d).parent.value};data.forEach(function(d,i){labelQueue.push({renderer:chart,charttype:"hierarchy",chartObj:chartObj,args:[seriesWiseNodes[i],i,NULL,NULL,totalFunc,leafNodes[i],transform]}),labelQueue.push({renderer:chart,charttype:"hierarchy",chartObj:chartObj,args:[seriesWiseNodes[i],i,NULL,NULL,totalFunc,[seriesWiseNodes[i][0]],transform,!0]})})}annotation&&data.forEach(function(series,i){notesArray=annotation.preprocessAnnotations(data,i,function(dt,k,j){var node=chart.getProcessedNode(dt),tileBound=treemapUtils.getTileBound(chartObj,node);return[tileBound.x+dimension.x,tileBound.y+dimension.y]},notesArray,chartObj,rp)}),treemapUtils.addEvents(layoutObj),isredraw=!0,chart.chartRendered=!0},transitionDuration+17+(delay?4*dataCount:0))}),chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.getProcessedNode=function(d){return layoutObj.nodes[getLevel(d)]},chart},svg_plot_renderer.heatmap=function(){var commonRendererProp,isredraw=!1;function chart(selection){return selection.each(function(data){var rp=commonRendererProp.params,chartObj=rp.chartObj,xscale=rp.xscale,yscale=rp.yscale,index=rp.datasetIndex,commonPlotOptions=rp.commonPlotOptions,labelQueue=rp.labelQueue,yaxiscolumnorder=rp.yaxiscolumnorder,currentdata=data[index],currentseriesdata=currentdata.data,animationOptions=getAnimationConf(commonPlotOptions,null,chartObj,HEATMAP_CHARTNAME),isAnimationEnable=animationOptions.enabled,animationType=animationOptions.type,easingType=animationOptions.easingType,transitionDuration=isredraw?isAnimationEnable?200:0:animationOptions.duration,isRandomAnimation=animationType===SIZINGRANDOM_ANIMATION||animationType===FADERANDOM_ANIMATION,delay=isredraw?0:isRandomAnimation?function(){return mathRandom()*(3*transitionDuration/5)}:0,duration=isredraw?transitionDuration:isRandomAnimation?2*transitionDuration/5:transitionDuration,fillColor=chart.fillColorFunc=getFillColor(chartObj,index),strokeColor=getStrokeColor(chartObj,index),borderRadius=chartObj.dataObject.getTransRectValue("radius",null,null,null,null,commonPlotOptions.borderRadius),symbolPath=commonPlotOptions.symbol&&getSVGsymbol(commonPlotOptions.symbol),xCategories=xscale.domain(),yCategories=yscale.domain(),hasColorScale=colorscale_helpers.isQuantileColorScale(chartObj),series=appendEle(d3_select(this),"g",[1],".","class","heatmapseries_"+index);chart.seriesdataAfterUpdate=[],currentseriesdata.forEach(function(d,i){var serData=chart.seriesdataAfterUpdate[i]=chartObj.dataObject.updateSeriesdatabyCategories(d3_values(d),xCategories,yCategories,yaxiscolumnorder),path=appendEle(appendEle(series,"g",!hasColorScale&&currentdata.disabled?[]:[1],".","class","subseries_"+i),PATH_ELEMENT,serData);path.styles({fill:function(d,i){var pos=getHeatCellPosition(chartObj,d,xscale,yscale,yaxiscolumnorder);return fillColor(index,d,null,null,null,[pos.width,pos.height])},"fill-opacity":commonPlotOptions.fillOpacity,stroke:function(d){return strokeColor(index,d,commonPlotOptions.strokeColor)},"stroke-width":commonPlotOptions.strokeWidth,"stroke-opacity":commonPlotOptions.strokeOpacity}).attr("transform",function(d){var pos=getHeatCellPosition(chartObj,d,xscale,yscale,yaxiscolumnorder);return"translate("+(pos.x+pos.width/2)+","+(pos.y+pos.height/2)+")"}).attr("d",function(d){var pos=getHeatCellPosition(chartObj,d,xscale,yscale,yaxiscolumnorder);return symbolPath?symbolPath(mathMin(pos.width,pos.height)):roundedRect(-pos.width/2,-pos.height/2,pos.width,pos.height,borderRadius)}),isredraw||(cancelAnimation(path),path.attr("opacity",0).transition().delay(delay).duration(duration).ease(easingType).on("start",function(){d3_select(this).attr("opacity",null)}).call(isRandomAnimation?fadeTween:function(){}).call(animationType===SIZING_ANIMATION||animationType===SIZINGRANDOM_ANIMATION?scaleTween:animationType===FADE_ANIMATION||animationType===FADERANDOM_ANIMATION?fadeTween:flipTween))}),labelRenderer&&labelQueue.push({renderer:chart,charttype:"hierarchy",chartObj:chartObj,args:[currentdata,index,null,null,null,d3_merge(chart.seriesdataAfterUpdate)]}),chart.renderedTimer=setTimeout(function(){isredraw=!0,chart.chartRendered=!0},transitionDuration+17)}),chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart},plot.render.bulletHelpers=function(){},plot.render.bulletHelpers.getLevelMarkerParams=function(d,i,j,renderer,cp){var x,y,wid,hei,rp=renderer.commonRendererProp().params,chartObj=rp.chartObj,yaxiscolumnorder=rp.yaxiscolumnorder,axisrotated=rp.axisrotated,dataset=rp.dataset,maxRange=cp&&cp.yscale.range()[1],percentComplete=d[cp.levelMarker.dataindex],yVal=dataset.getY(d,yaxiscolumnorder),startVal=yVal[0],marginIncrease=(yVal[1]-startVal)*percentComplete/100,finalVal=cp.yscale(startVal+marginIncrease),xPadding=axisrotated?0:cp.levelMarkerPadding,yPadding=axisrotated?cp.levelMarkerPadding:0;x=chartObj.dataObject.getTransRectValue("x",d,i,j,cp)+xPadding;var basevalue=null==cp.hasNegValue?cp.yscale(dataset.getY(d,cp.yaxiscolumnorder,0)):cp.yscale(cp.hasNegValue);return cp.axisrotated?(y=renderer.getParamValue("y",d,i,j,cp)+yPadding,wid=cp.stacked?mathAbs(cp.yscale(d.y+d.y0)-cp.yscale(d.y0))+cp.addRangeBand(cp.yscale):(mathAbs(maxRange-basevalue-(maxRange-finalVal))||0)+cp.addRangeBand(cp.yscale),hei=cp.levelMarkerWidth||cp.barWidth):(y=finalVal,wid=cp.levelMarkerWidth||cp.barWidth,hei=cp.stacked?mathAbs(basevalue-cp.yscale(d.y+d.y0)-(basevalue-cp.yscale(d.y0)))+cp.addRangeBand(cp.yscale):mathAbs(basevalue-finalVal)+cp.addRangeBand(cp.yscale)),{x:x,y:y,width:wid,height:hei}},plot.render.bulletHelpers.getBulletLevelMarkerGradient=function(d,levelMarker,chartObj,baseClr,levelMarkerColor){var level=d[levelMarker.dataindex]||[];if(null!=level&&!(level instanceof Array))return null;if(!level.length)return null;if(levelMarkerColor)levelMarkerColor.constructor!=Array&&(levelMarker.color=[levelMarkerColor]);else{levelMarker.color=[];var colorGamma=levelMarker.colorGamma||[.3,.9],monoClrGen=getMonochromeColor(baseClr,[0,level.length-1],[+colorGamma[0],+colorGamma[1]]);levelMarker.color=level.map(function(d,i){return monoClrGen(i)})}var thValues,neg=level.filter(function(d){return d<0});if(neg.length>0){var zeroIndex=(thValues=level.slice()).indexOf(0);zeroIndex>-1&&thValues.splice(zeroIndex,1);var negthClr=levelMarker.color;thValues=thValues.sort(d3_descending);for(var color=[],i=0;i<thValues.length;i++){var index=level.indexOf(thValues[i]);color.push(negthClr[index])}levelMarker.color=color,thValues.splice(thValues.length-neg.length,0,0),level=thValues}levelMarker.values=level;var thOverlay=axis.threshold.overlay(chartObj,"continous")(TRANSPARENT,levelMarker,0,"y");return neg.length>0&&(level=thValues),thOverlay},plot.render.bulletHelpers.ZC_BAR_getLevelMarkerRect=function(d,levelMarker,chartObj,cp,rp,i,index){var min,max,level=d[levelMarker.dataindex]||[],hasLevels=defined(levelMarker.dataindex),hasFixedPosDatalabels=chartObj.datalabels.hasFixedPosition,yaxisReversed=chartObj.systemConf.chart.axes.yaxis[rp.yaxiscolumnorder||0].reversed,stackGroup=chartObj.userdata.seriesdata.stackGroup,actualStackGroupIndex=stackGroup?chartObj.dataObject.getStackGroupIndex(index,stackGroup):0,plotarea=chartObj.plotarea,stacked=rp.stacked,axisrotated=rp.axisrotated,hasNegValue=rp.hasNegValue,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,yscale=rp.yscale;null==level||level instanceof Array||(level=[level]),hasLevels&&!level.length?min=max=0:(min=d3_min(level),max=d3_max(level));var v=dataset.getX(d),x=(stacked?cp.bandwidth1(v)+(cp.bandwidth2(actualStackGroupIndex)||0):cp.bandwidth1(v)+cp.bandwidth2(cp.barDatasetIndex+i))+cp.levelMarkerPadding,y=hasLevels?yscale(axisrotated?mathMin(0,min):mathMax(0,max)):axisrotated&&null!=hasNegValue?yscale(hasNegValue):0,wid=axisrotated?hasLevels?yscale(mathMax(0,max))-yscale(mathMin(0,min)):null!=hasNegValue?plotarea.width-yscale(hasNegValue):plotarea.width:cp.levelMarkerWidth,hei=axisrotated?cp.levelMarkerWidth:hasLevels?yscale(mathMin(0,min))-yscale(mathMax(0,max)):null!=hasNegValue?yscale(hasNegValue):plotarea.height;if(!hasLevels)if(yscale.bandwidth){var ordinalRange=yscale.ordinalRange,bandWidthBy2=yscale.bandwidth()/2;axisrotated?(y=yscale.origRange[0],wid=ordinalRange[yaxisReversed?0:ordinalRange.length-1]+bandWidthBy2):(y=ordinalRange[ordinalRange.length-1]+bandWidthBy2,hei=ordinalRange[yaxisReversed?ordinalRange.length-1:0]+bandWidthBy2)}else{var actualMax;if(hasFixedPosDatalabels){var yRange=chartObj.dataObject.ZC_BAR_getRangeY(chartObj,yaxiscolumnorder);actualMax=stacked?yRange[yaxiscolumnorder][1]:yRange[1]}else actualMax=yscale.domain()[1];var minmax=[yscale(actualMax),yscale(defined(hasNegValue)?hasNegValue:yscale.domain()[0])];axisrotated?(minmax.reverse(),y=minmax[0],wid=mathAbs(minmax[1]-minmax[0])):(y=minmax[0],hei=mathAbs(minmax[1]-minmax[0]))}return{x:x,y:y,width:wid,height:hei}},plot.render.bulletHelpers.addDummyDataForLevelmarker=function(dataUpdate,xCategories,dataset,yaxiscolumnorder){var currentkeys=dataUpdate.map(function(d){return dataset.getX(d)});xCategories.forEach(function(d,i){var key=d;if(currentkeys.indexOf(key)<0){var duplicate=[];duplicate.splice(dataset.xidx,0,key),duplicate.splice(dataset.yidx(yaxiscolumnorder),0,0),duplicate.isDummy=!0,duplicate.y=0,duplicate.y0=0,duplicate.index=i,dataUpdate.splice(i,0,duplicate)}})};plot.render.bulletHelpers;function getDependencyDetails(d,dependencyConfig,renderer,i){return{start:getPos(d.source,renderer,i),end:getPos(d.target,renderer,i),type:dependencyConfig.link.type.toUpperCase()||"ES"}}function getPos(d,renderer,i){var cp=renderer.commonOption;return{x:renderer.getParamValue("x",d,i,null,cp),y:renderer.getParamValue("y",d,i,null,cp),width:renderer.getParamValue("width",d,i,null,cp),height:renderer.getParamValue("height",d,i,null,cp)}}svg_plot_renderer.ganttHelpers=function(){},plot.render.ganttHelpers=function(){},svg_plot_renderer.ganttHelpers.showDependencies=function(renderer,data,series,index){var rp=renderer.commonRendererProp().params,cp=renderer.commonOption,chartObj=rp.chartObj,dataset=(chartObj.plotarea,rp.dataset),axisrotated=rp.axisrotated,commonPlotOptions=rp.commonPlotOptions,yaxiscolumnorder=cp.yaxiscolumnorder,dependencyConfig=(rp.color,commonPlotOptions.dependency),showDependency=!0===dependencyConfig.enabled,dependencies=null,dependenceSeriesNode=series.selectAll("g.dependencySeries").data(showDependency?[data]:[]),dependenceSeries=dependenceSeriesNode.enter().insert("g",":first-child").attr("class","dependencySeries").merge(dependenceSeriesNode);if(dependenceSeries.exit().remove(),showDependency&&defined(dependencyConfig.sourceIndex)&&defined(dependencyConfig.targetIndex)&&(dependencies=function(source,dependencyIndex,searchIndex){var allDependencies=[];if(source.forEach(function(dd){var currentDependency=dd[dependencyIndex];source.forEach(function(data){data!==dd&&defined(currentDependency)&&isArray(currentDependency)&&-1!==currentDependency.indexOf(data[searchIndex])&&allDependencies.push({source:dd,target:data})})}),allDependencies.length)return allDependencies}(data,+dependencyConfig.sourceIndex,+dependencyConfig.targetIndex)),dependencies){var symbolConf=dependencyConfig.marker,linkConf=dependencyConfig.link,linkPadding=defined(linkConf.padding)?linkConf.padding:1,symbolPadding=defined(symbolConf.padding)?symbolConf.padding:linkPadding;symbolPadding=mathMin(linkPadding,symbolPadding);var linkGroup=appendEle(dependenceSeries,"g",[1],".","class","links"),arrowGroup=appendEle(dependenceSeries,"g",[1],".","class","symbol");appendEle(linkGroup,"path",dependencies,".","class","link").attr("d",function(d,j){var details=getDependencyDetails(d,dependencyConfig,renderer,index);return function(type,startPosition,endPosition,padding,markerPadding,rp){type=type.toUpperCase();var chartObj=rp.chartObj,axisrotated=rp.axisrotated,xAxisReverseed=chartObj.systemConf.chart.axes.xaxis.reversed,x=null,y=null,pos=null,crucialCurve=function(type,axisrotated,start,end,linkPadding){var direct=!1;switch(type){case"SS":case"EE":direct=!0;break;case"SE":direct=axisrotated?start.x>end.x+end.width:start.y+start.height<end.y;break;case"ES":direct=axisrotated?start.x+start.width<end.x-2*linkPadding:start.y>end.y+end.height}return!direct}(type,axisrotated,startPosition,endPosition,padding);return d3_line().x(function(d,j){switch(j){case 0:case 1:case 2:if(pos=startPosition,0==j)"SS"==type||"SE"==type?x=axisrotated?pos.x:pos.x+pos.width/2:"EE"!=type&&"ES"!=type||(x=axisrotated?pos.x+pos.width:pos.x+pos.width/2);else if(1==j)"SS"==type||"SE"==type?x=axisrotated?pos.x-padding:x:"EE"!=type&&"ES"!=type||(x=axisrotated?pos.x+pos.width+padding:x);else{var dist;"SS"==type?(dist=(dist=startPosition.x-endPosition.x)<0?0:dist,x=axisrotated?pos.x-dist-padding:x):"EE"==type?(dist=(dist=startPosition.x+startPosition.width-(endPosition.x+endPosition.width))>0?0:dist,x=axisrotated?pos.x+pos.width+padding-dist:x):"SE"==type?axisrotated?(x=pos.x-padding,y=crucialCurve?pos.y+pos.height:endPosition.y):x=xAxisReverseed?x-pos.width:x+pos.width:"ES"==type&&(axisrotated?(x=pos.x+padding+pos.width,y=crucialCurve?pos.y+pos.height:endPosition.y):x=xAxisReverseed?x-pos.width:x+pos.width)}break;default:axisrotated&&(y=null),pos=endPosition,3==j?(axisrotated&&crucialCurve&&(y=startPosition.y+startPosition.height),"SS"==type||"EE"==type?x=axisrotated?x:pos.x+pos.width/2:"SE"==type?x=axisrotated?pos.x+pos.width+padding:x:"ES"==type&&(x=axisrotated?pos.x-padding:x)):4==j?"SE"==type?x=axisrotated?pos.x+pos.width+padding:pos.x+pos.width/2:"ES"==type&&(x=axisrotated?x:pos.x+pos.width/2):"SS"==type||"ES"==type?x=axisrotated?pos.x-markerPadding:x:"EE"!=type&&"SE"!=type||(x=axisrotated?pos.x+pos.width+markerPadding:x)}return x}).y(function(d,j){return axisrotated?(y||pos.y)+pos.height/2:(0==j?"SS"==type||"SE"==type?y=startPosition.y+startPosition.height:"EE"!=type&&"ES"!=type||(y=startPosition.y):1==j?"SS"==type||"SE"==type?y+=padding:"EE"!=type&&"ES"!=type||(y=startPosition.y-padding):2==j?"SS"==type?y=startPosition.y+startPosition.height<endPosition.y+endPosition.height?endPosition.y+endPosition.height+padding:y:"EE"==type&&(y=startPosition.y>endPosition.y?endPosition.y-padding:y):3==j?"SE"==type?y=crucialCurve?endPosition.y-padding:y:"ES"==type&&(y=crucialCurve?endPosition.y+endPosition.height+padding:y):4==j?y+=0:"SS"==type||"ES"==type?y=endPosition.y+endPosition.height+markerPadding:"EE"!=type&&"SE"!=type||(y=endPosition.y-markerPadding),y)}).curve(d3_curves("linear"))}(details.type,details.end,details.start,linkPadding,symbolPadding,rp)(new Array(6))}).attr("stroke",function(d){return dataset.getY(d.source,yaxiscolumnorder)[0]<dataset.getY(d.target,yaxiscolumnorder)[1]?linkConf.errorStyle:linkConf.strokeColor}).attr("stroke-width",linkConf.strokeWidth).attr("fill","none");var arrows=appendEle(arrowGroup,"g",!0===dependencyConfig.marker.enabled?dependencies:[],".","class","arrow");dependencyConfig.marker.enabled&&arrows.each(function(d,j){symbolConf.symbol;var temp,self=d3_select(this);self.attr("transform",function(d){var x,y,details=getDependencyDetails(d,dependencyConfig,renderer,index),type=details.type;return"SS"==type||"ES"==type?(x=axisrotated?details.start.x-symbolPadding:details.start.x+details.start.width/2,y=axisrotated?details.start.y+details.start.height/2:details.start.y+details.start.height+symbolPadding,temp=axisrotated?"triangle-right":"triangle-up"):"EE"!=type&&"SE"!=type||(x=axisrotated?details.start.x+details.start.width+symbolPadding:details.start.x+details.start.width/2,y=axisrotated?details.start.y+details.start.height/2:details.start.y-symbolPadding,temp=axisrotated?"triangle-left":"triangle-down"),"translate("+x+","+y+")"}),addSVGmarker(self,null,symbolConf,{symbolSize:{inner:.4,outer:.7},color:null,symbol:temp},chartObj)})}},svg_plot_renderer.ganttHelpers.addMarker=function(series,data,renderer,index,markerOption,multiColoring,id){var rp=renderer.commonRendererProp().params,cp=renderer.commonOption,chartObj=rp.chartObj,plotarea=chartObj.plotarea,dataset=rp.dataset,axisrotated=rp.axisrotated,color=rp.color,levelMarkerWidth=cp.levelMarkerWidth,cType=cp.charttype,isBullet="bullet"==cType,isGantt="gantt"==cType,bandwidth=isBullet?rp.xscale.bandwidth():levelMarkerWidth,bandwidth1=renderer.bandwidth1(),size=validateNullVal(markerOption.size,levelMarkerWidth-2*validateNullVal(markerOption.padding,cp.padding/2)),target=appendEle(series,"g",[data],".","class","markers"+id,null,function(d){return[dataset.getX(d)]}),markerWidth=pick(markerOption.strokeWidth,1);target.attrs({class:"markers"+id,transform:"translate("+plotarea.left+","+plotarea.top+")","stroke-width":markerWidth,"stroke-dasharray":getDashArray(markerOption.dashStyle,validateNullVal(markerOption.outerStrokeWidth,1)),"stroke-linecap":getLineCap(markerOption.lineCap,markerOption.dashStyle),fill:markerOption.color,stroke:markerOption.color});var marker=appendEle(target,"g",data,null,null,null,null,function(d){return dataset.getX(d)});marker.enter().append("g");var mSize="line"===markerOption.symbol?{inner:0,outer:1}:{inner:.6,outer:1},customMarkerSize=markerOption.size;marker.each(function(d,j){var m=d3_select(this),clr=multiColoring?chartObj.seriesColor[j%chartObj.seriesColor.length]:color;m.attrs({transform:function(d,k){var x=0,y=0;if(isGantt){var position=svg_plot_renderer.ganttHelpers.getMarkerPosition(d,index,k,renderer);return 0===id?(x=position.x+position.width/2,y=position.y-10*markerOption.size/2):(x=position.x+position.width/2,y=position.y+position.height+10*markerOption.size/2),"translate("+(axisrotated?y:x)+","+(axisrotated?x:y)+")"}return x=bandwidth1(dataset.getX(d))+bandwidth/2,y=rp.yscale(d[markerOption.dataindex]),null==d[markerOption.dataindex]?null:"translate("+(axisrotated?y:x)+","+(axisrotated?x:y)+") rotate("+(axisrotated?90:0)+")"}}).style("display",function(d){return null==d[markerOption.dataindex]&&isBullet?"none":null}),markerOption.size=defined(customMarkerSize)?isBullet?mathMin(size,bandwidth/10):size:size/10,addSVGmarker(m,null,markerOption,{symbolSize:mSize,color:isGantt?clr:null},chartObj)}),markerOption.size=customMarkerSize,isGantt&&(renderer.markerProperties={subseriesIndex:index})},svg_plot_renderer.ganttHelpers.getMarkerPosition=function(d,i,j,renderer){var cp=renderer.commonOption;return{x:renderer.getParamValue(cp.axisrotated?"y":"x",d,i,j,cp),y:renderer.getParamValue(cp.axisrotated?"x":"y",d,i,j,cp),width:renderer.getParamValue(cp.axisrotated?"height":"width",d,i,j,cp),height:renderer.getParamValue(cp.axisrotated?"width":"height",d,i,j,cp)}};plot.render.ganttHelpers;var wordCloudUtils={getSeriesIndex:function(d){return d.seriesIndex},getItemIndex:function(d){return d.itemIndex},getDy:function(obj){return wordCloudUtils.isMultiLine(obj)?.9:.4},isMultiLine:function(obj){return(obj.nodeList?obj.nodeList.format:obj.format).multiLine},getBoundBoxSize:function(layout,datalabelOptions,commonPlotOptions,chartObj){var boundboxOptions=getMergedBoundBoxOptions(datalabelOptions,chartObj),padding=(validateNullVal(commonPlotOptions.padding,2)+getBoundBoxStrokeWidth(datalabelOptions,chartObj))/2;return{x:layout.x-layout.width/2+padding,y:layout.y-layout.height/2+padding+(wordCloudUtils.isMultiLine(layout)?layout.size*wordCloudUtils.getDy(layout)-layout.height/2:0),width:layout.width-2*padding,height:layout.height-2*padding,r:chartObj.dataObject.getTransRectValue("radius",NULL,NULL,NULL,NULL,boundboxOptions.radius)}},getContainerTransformation:function(layoutObj,dimension){var scaleFactor=layoutObj.output.scaleFactor;return{translate:[dimension.x-dimension.width*(scaleFactor-1)/2,dimension.y-dimension.height*(scaleFactor-1)/2],scale:scaleFactor}}},_getSeriesIndex=wordCloudUtils.getSeriesIndex,_getItemIndex=wordCloudUtils.getItemIndex;function getEventArgs$1(d,i,renderer){var ev=getEventObject(d3$1.event);return{renderer:renderer,seriesPos:_getSeriesIndex(d),subseriesPos:d.subSeriesIndex,itemPos:_getItemIndex(d),coordinates:[ev.pageX,ev.pageY],element:this,data:d}}function findDataPoint(layoutObj){var nearestPoint,chartObj=layoutObj.rp.chartObj,dimension=layoutObj.dimension,processedData=layoutObj.processedData,transformation=wordCloudUtils.getContainerTransformation(layoutObj,dimension),scaleFactor=layoutObj.output.scaleFactor,relmousePt=getRelativeMousePosition(chartObj),length=processedData.length,minDist=null;if(relmousePt.x-=transformation.translate[0],relmousePt.y-=transformation.translate[1],chartObj.chartRendered){for(;length--;){var d=processedData[length],layout=d.layout,isWithinClrRange=isWithinColorRange(chartObj.dataset.getClr(d),chartObj),eventDisabled=0==validateNullVal(getEventConf(chartObj.seriesdata[_getSeriesIndex(d)].plotoptions,layoutObj.rp.commonPlotOptions,chartObj,"enabled"),!0);if(layout&&!eventDisabled&&isWithinClrRange){var x=layout.x*scaleFactor,y=layout.y*scaleFactor,w=layout.width*scaleFactor,h=layout.height*scaleFactor,curPt={x:x-w/2,y:y-h/2,width:w,height:h},rotatedPt=geometryUtils.rotatePoint(relmousePt,layout.rotation,{x:x,y:y}),curDist=mathAbs(rotatedPt.y-layout.y);geometryUtils.pointInRectangle(rotatedPt,curPt)&&(null===minDist||curDist<minDist)&&(nearestPoint=d,minDist=curDist)}}return nearestPoint}}wordCloudUtils.addEvents=function(layoutObj){var prevPoint,chartObj=layoutObj.rp.chartObj,commonPlotOptions=layoutObj.rp.commonPlotOptions,dimension=layoutObj.dimension,seriesdata=chartObj.seriesdata,renderer=chartObj.renderer[0],plotarea=chartObj.plotarea,eventHandler=chartObj.eventHandler,transformation=wordCloudUtils.getContainerTransformation(layoutObj,dimension),w=dimension.width,h=dimension.height,fillColor=getFillColor(chartObj,0,{x1:0,x2:w,y1:0,y2:h,r:mathMin(w,h)},NULL,"svg"),strokeColor=getStrokeColor(chartObj,0),element=eventHandler.trackerElement;drawBorderBox(element,plotarea),function(element){element.node().__on.forEach(function(d){element.on("."+d.name,NULL)})}(element);var highlightGroup=chartObj.staticPaneSVG.selectAll("g.zcplothighlight").attr("transform","translate("+(plotarea.left+transformation.translate[0])+","+(plotarea.top+transformation.translate[1])+") scale("+transformation.scale+")");appendEle(highlightGroup,TEXT_ELEMENT,[1]);var _defaultMouseOut=function(){highlightGroup.style("opacity",0)},_mouseMove=function(){var d=findDataPoint(layoutObj);if(d){var args=getEventArgs$1(d,NULL,renderer);eventHandler.mouseMove(args);var cursor=getEventConf(seriesdata[_getSeriesIndex(d)].plotoptions,commonPlotOptions,chartObj,"cursor");eventHandler.addCursor(cursor)}else prevPoint&&(eventHandler.mouseOut(renderer,{data:prevPoint},_getSeriesIndex(prevPoint)),eventHandler.hideCursor());prevPoint=d},_mouseOut=function(){var d=prevPoint;d?eventHandler.mouseOut(renderer,{data:d},_getSeriesIndex(d)):_defaultMouseOut()},_click=function(){var d=findDataPoint(layoutObj);if(d){var args=getEventArgs$1(d,NULL,renderer);eventHandler.click(renderer,{data:d},_getSeriesIndex(d),_getItemIndex(d),args),prevPoint=d}},_doubleClick=function(){var d=findDataPoint(layoutObj);if(d){var dt=annotation?generateDataForAnnotation(d,seriesdata.length>1?seriesdata[_getSeriesIndex(d)].seriesname:NULL):d,layout=d.layout,args={coordinate:[layout.x-.5*layout.width+dimension.x,layout.y-layout.height*wordCloudUtils.getDy(layout)+dimension.y],data:dt,basedOn:"plot"};chartObj.eventHandler.doubleclick({data:d},_getSeriesIndex(d),args),prevPoint=d}};renderer.defaultMouseOverFunc=function(d,seriesPos,itemPos){var multiColoring=isMultiColoring(commonPlotOptions,chartObj),highlightEle=highlightGroup.selectAll(TEXT_ELEMENT),highlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(seriesPos,"selectedSeries","plot"),unHighlightEffect=chartObj.legendHighlight.getLegendHighlightEffect(seriesPos,"unselectedSeries","plot"),rawColor=getRawColor(chartObj,multiColoring?itemPos:seriesPos,d,seriesPos),currentColor=HIGHLIGHT_EFFECT_REGEX.test(highlightEffect)||UNHIGHLIGHT_EFFECT_REGEX.test(unHighlightEffect)?rawColor:TRANSPARENT,layout=d.layout,isMultiLine=wordCloudUtils.isMultiLine(layout),plotOptions=chartObj.seriesdata[seriesPos].plotoptions,plotLevelStrokeWidth=plotOptions&&plotOptions.strokeColor;highlightGroup.style("opacity",NULL),applyDatalabelFonts(highlightEle,layoutObj.datalabelOptions[_getSeriesIndex(d)],chartObj),highlightEle[layout.nodeList.contentType](layout.nodeList.innerSVG),highlightEle.attrs({x:layout.x,y:layout.y-(isMultiLine?layout.height/2:0),transform:"rotate("+radianToDegree(layout.rotation)+" "+layout.x+" "+layout.y+")","text-anchor":MIDDLE_ALIGN,dy:wordCloudUtils.getDy(layout)+"em"}).styles({"font-size":layout.size+PX,"paint-order":"stroke","stroke-linejoin":"round",fill:fillColor(multiColoring?itemPos:seriesPos,d),stroke:strokeColor(multiColoring?itemPos:seriesPos,d,plotLevelStrokeWidth!==UNDEFINED?plotLevelStrokeWidth:commonPlotOptions.strokeColor)}).styles(chartObj.legendHighlight.getEffect(highlightEffect,WORDCLOUD_CHARTNAME,currentColor,{fill:currentColor,stroke:rawColor},multiColoring?itemPos:seriesPos,"plot")),isMultiLine&&translateTspan(highlightEle,layout.x)},renderer.defaultMouseOutFunc=_defaultMouseOut,attachevents(element,{mousemove:_mouseMove,mouseout:_mouseOut,click:_click,dblclick:_doubleClick},{singletouchmove:_mouseMove,touchend:_mouseOut,tap:_click,dbltap:_doubleClick},{target:"plot",touchleave:!0,chartObj:chartObj})};var getUserFontValue=function(fontStyle,userStyle){return(userStyle&&userStyle["font-style"]||fontStyle["font-style"]||"normal")+" normal "+(userStyle&&userStyle["font-weight"]||fontStyle["font-weight"]||"normal")+" "+(userStyle&&userStyle["font-size"]||fontStyle["font-size"])+" "+(userStyle&&userStyle["font-family"]||fontStyle["font-family"])},maxCanvasSize=$Browser.CHROME||$Browser.FIREFOX?32e3:$Browser.IE&&$Browser.isTouchDevice?4e3:8e3,createCanvas=function(){return document.createElement("canvas")},createContext=function(canvas){return canvas.getContext("2d")},isTspan=function(node){return node.nodeName===TSPAN_ELEMENT},WordCloud=function(data,config){var meta,maskImageData,areaOfMask,imageDataX,imageDataY,currentRowHeight,canvasCount,textImageData,calculatedPosition,canvasMeta,drawnBound,plotWidth=config.width,plotHeight=config.height,textOverflow=config.textOverflow,mask=(config.textOverlap,config.mask),invert=config.invert||!1,fontScale=config.fontScale,maxWidth=defined(config.maxWidth)?perToPx(config.maxWidth,plotWidth):NULL,_fontFamily=config.fontFamily,_fontStyle=config.fontStyle,_fontWeight=config.fontWeight,_fontSize=config.fontSize,_content=config.content,_rotation=config.rotation,chartObj=config.chartObj,pointsAtRadius=[],g=mathMin(8,mathMax(4,mathRound(16*mathMin(plotWidth,plotHeight)/1024))),grid=[],rotationCollection=[],dummyText=appendEle(chartObj.getPatternSvg(),TEXT_ELEMENT,[1],".","class","dummyText"),ngx=mathCeil(plotWidth/g),ngy=mathCeil(plotHeight/g),fx=mathMin(1,ngx/ngy),fy=mathMin(1,ngy/ngx),center=(center=config.origin)?[center[0]/g,center[1]/g]:[ngx/2,ngy/2],maxRadius=mathFloor(mathSQRT(ngx*ngx+ngy*ngy)),noOfPointAtRadius=data.length<100?8:1,getPointsAtRadius=function(radius){if(pointsAtRadius[radius])return pointsAtRadius[radius];var T=radius*noOfPointAtRadius,t=T,points=[];for(0===radius&&points.push([center[0],center[1],0]);t--;){var theta=t/T*2*mathPI;points.push([center[0]+radius*mathCos(-theta)*fx,center[1]+radius*mathSin(-theta)*fy,theta])}return pointsAtRadius[radius]=points},getCanvas=function(d){var canvas=createCanvas();canvas.setAttribute("width",d.width),canvas.setAttribute("height",d.height),d.context=createContext(canvas)},getContext=function(arg){var index=arg.constructor===Object?arg.canvasIndex:arg;return canvasMeta[index].context},readImageData=function(d,i){textImageData[i]=getContext(i).getImageData(0,0,d.width,d.height).data},getWordPadding=function(d){return config.strokeWidth(d)+config.padding(d)},getFontStyles=function(d){return{fontStyle:_fontStyle(d),fontWeight:_fontWeight(d),fontSize:_fontSize(d),fontFamily:_fontFamily(d)}},getFont=function(d){return _fontStyle(d)+" normal "+_fontWeight(d)+" "+_fontSize(d).toString(10)+PX+" "+_fontFamily(d)},sortByFontSizeAccesor=function(a,b){return _fontSize(b)-_fontSize(a)},updateBound=function(bound,start,end){bound[0]=mathMin(bound[0],start[0]),bound[1]=mathMin(bound[1],start[1]),bound[2]=mathMax(bound[2],end[0]),bound[3]=mathMax(bound[3],end[1])},wordOverflow=function(ele,d,deg,customWidth){var textNode=ele.node(),nodes=textNode.childElementCount?ele.selectAll("*").filter(function(){return isTspan(this)&&!this.childElementCount}).nodes():[textNode],degree_360=radianToDegree(deg)%360,degree_90=degree_360>90?180-degree_360:degree_360;ele.attr("dy","1em").attr("transform","rotate("+degree_90+" 0 0)");var overflowLength,croppedTextLength,availableWidth,availableHeight,textBound,overflowPattern="ellipsis"===textOverflow?"..":"",overflowPatternLength=overflowPattern.length,textNode_bb=getDefaultBoundingClientRect(textNode),padding=config.padding(d),w=(defined(customWidth)?customWidth:plotWidth)-padding,h=plotHeight-padding,available_left=textNode_bb.left,available_top=textNode_bb.top,available_right=textNode_bb.left+w,available_bottom=textNode_bb.top+h,available_width=w,available_height=h,getTextBound_wordcloud=function(node){var bb=(isTspan(node)?getTspanBoundingClientRect:getDefaultBoundingClientRect)(node);return isTspan(node)&&(availableWidth=available_width-mathMax(0,bb.left-available_left)-mathMax(0,available_right-bb.right),availableHeight=available_height-mathMax(0,bb.top-available_top)-mathMax(0,available_bottom-bb.bottom)),{width:bb.width,height:bb.height}};nodes.forEach(function(node){availableWidth=w,availableHeight=h,(textBound=getTextBound_wordcloud(node)).width-availableWidth>1&&(overflowLength=(textBound.width-availableWidth)/textBound.width,croppedTextLength=mathCeil((1-overflowLength)*node.textContent.length),node.textContent=node.textContent.substring(0,croppedTextLength-overflowPatternLength)+overflowPattern,textBound=getTextBound_wordcloud(node)),textBound.height-availableHeight>1&&(overflowLength=(textBound.height-availableHeight)/textBound.height,croppedTextLength=mathCeil((1-overflowLength)*node.textContent.length),node.textContent=node.textContent.substring(0,croppedTextLength-overflowPatternLength)+overflowPattern,textBound=getTextBound_wordcloud(node)),(textBound.width-availableWidth>1||textBound.height-availableHeight>1)&&naiveEllipsis(node,node,node.textContent,textBound.width,textBound.height,textBound,overflowPattern),node.textContent===overflowPattern&&(node.textContent="")})},drawWordsInSvg=function(d,i,customFontSize){var content=_content(d),innerSVG=content.value,contentType=content.type,rotateDeg=rotationCollection[i];applyFont(dummyText,[getFontStyles(d)]),dummyText[contentType](innerSVG),customFontSize&&dummyText.style("font-size",customFontSize+PX),wordCloudUtils.isMultiLine(content)&&translateTspan(dummyText,0),customFontSize||"none"===textOverflow||(maxWidth&&wordOverflow(dummyText,d,0,maxWidth),wordOverflow(dummyText,d,rotateDeg)),dummyText.attr("text-anchor",MIDDLE_ALIGN).attr("dy",wordCloudUtils.getDy(content)+"em").attr("transform","rotate("+radianToDegree(rotateDeg)+" 0 0)")},getTextInfo=function(d,i){var fontSize=_fontSize(d),content=_content(d),padding=getWordPadding(d),contentType=content.type,rotateDeg=rotationCollection[i],nodeList=[];drawWordsInSvg(d,i);var bb=bbox(dummyText.node()),boxWidth=bb.width+padding,boxHeight=bb.height+padding,cgh=mathCeil((boxWidth*mathAbs(mathSin(rotateDeg))+boxHeight*mathAbs(mathCos(rotateDeg)))/g),cgw=mathCeil((boxWidth*mathAbs(mathCos(rotateDeg))+boxHeight*mathAbs(mathSin(rotateDeg)))/g),width=cgw*g,height=cgh*g;if(nodeList.innerSVG=dummyText[contentType](),nodeList.contentType=contentType,nodeList.format=content.format,"html"===contentType){var tspanInfo=getTspanBound(dummyText,fontSize);Array.prototype.push.apply(nodeList,tspanInfo)}var info={gw:cgw,gh:cgh,width:boxWidth,height:boxHeight,size:fontSize,rotation:rotateDeg,nodeList:nodeList,bb:bb};return imageDataX+width>maxCanvasSize&&(imageDataX=0,imageDataY+=currentRowHeight,currentRowHeight=0),imageDataY+height>maxCanvasSize&&(canvasMeta[++canvasCount]={width:1,height:1},imageDataX=imageDataY=currentRowHeight=0),info.canvasBound=[imageDataX,imageDataY,width,height],info.canvasIndex=canvasCount,imageDataX+=width,currentRowHeight=mathMax(currentRowHeight,height),canvasMeta[canvasCount].width=mathMax(canvasMeta[canvasCount].width,imageDataX),canvasMeta[canvasCount].height=imageDataY+currentRowHeight,info},drawWordsInCanvas=function(d,i){var info=meta[i];if(info){var context=getContext(info),canvasBound=info.canvasBound;context.save(),context.translate(canvasBound[0]+canvasBound[2]/2,canvasBound[1]+canvasBound[3]/2),context.rotate(info.rotation),config.boundBox?context.fillRect(-info.width/2,-info.height/2,info.width,info.height):function(d,info){var fontSize=info.size,globalFont=getFont(d),bb=info.bb,nodeList=info.nodeList,dy=wordCloudUtils.getDy(nodeList),x=0,y=0,context=getContext(info);context.strokeStyle="#000",context.lineWidth=getWordPadding(d),context.lineJoin="bevel",context.fillStyle="#000","html"===nodeList.contentType?(context.textAlign=CENTER_ALIGN,nodeList.forEach(function(a){var font,userStyle=a.style;userStyle.length&&(font=getUserFontValue(applyFont(NULL,[getFontStyles(d)]),userStyle),parseFloat(userStyle["font-size"])),x=a.dx||0,y=(a.dy||0)*fontSize+fontSize*dy-(wordCloudUtils.isMultiLine(nodeList)?bb.height/2:0),context.font=font||globalFont,context.strokeText(a.text,x,y),context.fillText(a.text,x,y)})):(y=fontSize*dy,context.textAlign=CENTER_ALIGN,context.font=globalFont,context.strokeText(nodeList.innerSVG,x,y),context.fillText(nodeList.innerSVG,x,y))}(d,info),context.restore()}},isWithin=function(x,y){return x>=ngx||y>=ngy||x<0||y<0},tryToPutWordAtPoint=function(gxy){var gx=mathFloor(gxy[0]-this.gw/2),gy=mathFloor(gxy[1]-this.gh/2);return!!function(gx,gy,occupied){return!occupied.some(function(d){var px=gx+d[0],py=gy+d[1];if(isWithin(px,py)||!grid[px][py])return!0})}(gx,gy,this.occupied)&&(function(position,info){info.occupied.forEach(function(d){var px=position[0]+d[0],py=position[1]+d[1];isWithin(px,py)||(grid[px][py]=!1)})}(calculatedPosition=[gx,gy],this),!0)},putWord=function(item,i){var info=meta[i];if(item.layout=NULL,!info)return!1;var obj=function(info){for(var gy,x,y,cgw=info.gw,cgh=info.gh,cx=info.canvasBound[0],cy=info.canvasBound[1],canvasIndex=info.canvasIndex,width=canvasMeta[canvasIndex].width,imageData=textImageData[canvasIndex],occupied=[],bound=[cgw/2,cgh/2,cgw/2,cgh/2],gx=cgw;gx--;)for(gy=cgh;gy--;){y=g;singleGridLoop:for(;y--;)for(x=g;x--;)if(imageData[4*((gy*g+y+cy)*width+(gx*g+x+cx))+3]){occupied.push([gx,gy]),updateBound(bound,[gx,gy],[gx,gy]);break singleGridLoop}}return{occupied:occupied,bound:bound}}(info);info.occupied=obj.occupied;var bound=info.bound=obj.bound;if(bound[2]-bound[0]+1>ngx||bound[3]-bound[1]+1>ngy)return!1;for(var r=maxRadius+1;r--;){if(getPointsAtRadius(maxRadius-r).some(tryToPutWordAtPoint,info)){var x=calculatedPosition[0],y=calculatedPosition[1];return item.layout={x:(x+info.gw/2)*g,y:(y+info.gh/2)*g,width:info.width,height:info.height,rotation:info.rotation,size:info.size,nodeList:info.nodeList},updateBound(drawnBound,[x*g,y*g],[(x+info.gw)*g,(y+info.gh)*g]),!0}}return!1},updatPixelByColor=function(imageData,i,rgb){rgb&&(imageData[i]=rgb.r,imageData[i+1]=rgb.g,imageData[i+2]=rgb.b,imageData[i+3]=mathMax(1,mathFloor(255*rgb.opacity)))},operations=function(){imageDataX=imageDataY=canvasCount=currentRowHeight=0,canvasMeta=[{width:1,height:1}],textImageData=[],drawnBound=[plotWidth/2,plotHeight/2,plotWidth/2,plotHeight/2],function(){var percent,availablePlotArea=maskImageData?areaOfMask:geometryUtils.areaOfEllipse(plotWidth/2,plotHeight/2),sum=0,outWidth=0,outHeight=0;data.forEach(function(d,i){var fontSize=_fontSize(d),padding=getWordPadding(d),customFontSize="html"===_content(d).type?fontSize:10,fontRatio=fontSize/customFontSize,deg=_rotation(d);rotationCollection.push(deg),drawWordsInSvg(d,i,customFontSize);var bb=bbox(dummyText.node()),boxWidth=bb.width+padding,boxHeight=bb.height+padding,area=boxWidth*boxHeight,scaledWidth=boxWidth*fontRatio*mathAbs(mathCos(deg))+boxHeight*fontRatio*mathAbs(mathSin(deg)),scaledHeight=boxWidth*fontRatio*mathAbs(mathSin(deg))+boxHeight*fontRatio*mathAbs(mathCos(deg));outHeight=mathMax(outHeight,scaledHeight-plotHeight),outWidth=mathMax(outWidth,scaledWidth-plotWidth),sum+=area*mathPow(fontRatio,2)}),(outWidth||outHeight)&&sum<availablePlotArea?(percent=mathMax(outWidth?outWidth/plotWidth:0,outHeight?outHeight/plotHeight:0),percent=1-mathMin(percent,.2)):(percent=mathSQRT(availablePlotArea/sum)*(config.boundBox?.5:1),percent=mathMax(percent,.4));var range=fontScale.range(),r0=mathMax(range[0],3),r1=mathMax(range[1]*percent,r0+2);fontScale.range([r0,r1])}(),function(){for(var gy,x,y,gx=ngx;gx--;)for(grid[gx]=[],gy=ngy;gy--;)if(mask){grid[gx][gy]=!invert,y=g;singleGridLoop:for(;y--;)for(x=g;x--;)if(!maskImageData[4*((gy*g+y)*ngx*g+(gx*g+x))+3]){grid[gx][gy]=invert;break singleGridLoop}}else grid[gx][gy]=!0}(),meta=data.map(getTextInfo),canvasMeta.forEach(getCanvas),data.forEach(drawWordsInCanvas),canvasMeta.forEach(readImageData),data.filter(putWord)},draw=function(){data.sort(sortByFontSizeAccesor),operations();var scaleFactor=mathMin(drawnBound[0]-0,drawnBound[1]-0,plotWidth-drawnBound[2],plotHeight-drawnBound[3]);scaleFactor=maskImageData?1:mathMin(plotWidth,plotHeight)/(mathMin(plotWidth,plotHeight)-scaleFactor),config.onload({mask:maskCanvas,scaleFactor:scaleFactor}),dummyText.remove(),maskImageData=NULL},drawOnMask=function(){var imageData=maskContext.getImageData(0,0,w,h),maskBackgroundColor=config.maskBackground,rgb=maskBackgroundColor&&"inherit"!==maskBackgroundColor&&d3_rgb(maskBackgroundColor);maskImageData=imageData.data,areaOfMask=0;for(var i=0;i<maskImageData.length;i+=4)maskImageData[i+3]&&(areaOfMask++,updatPixelByColor(maskImageData,i,rgb));rgb&&maskContext.putImageData(imageData,0,0),draw()};if(mask){var maskCanvas=createCanvas(),w=ngx*g,h=ngy*g;maskCanvas.width=w,maskCanvas.height=h;var maskContext=createContext(maskCanvas);if("function"==typeof mask){var size=mathMin(w,h),bound="rect"===mask.name?[w,h]:[size,size],path=mask.apply(NULL,bound);maskContext.translate(w/2,h/2),maskContext.scale(w/bound[0],h/bound[1]),canvasUtils.drawPath(maskContext,path),maskContext.fillStyle="#000",maskContext.fill(),drawOnMask()}else{var img=new Image;img.crossOrigin="Anonymous",img.onload=function(){maskContext.drawImage(img,0,0,w,h),drawOnMask()},img.src=mask}}else draw()},wordcloudLayout=function(commonRendererProp){var rp,chartObj,commonPlotOptions,processedData,dimension,sum,extent,fontScale,datalabelOptions,GLT,fontFamily,fontStyle,fontWeight,yValues,hasBoundBox,globalRotation,globalRotationCount,seriesSpecificRotation,seriesSpecificRotationCount,percentFunc,size,minFont,maxFont,_getSeriesIndex=wordCloudUtils.getSeriesIndex,getValue=function(d){var yaxiscolumnorder=DataProcessor.helpers.getParsedYAxisOrder(chartObj.seriesdata[_getSeriesIndex(d)].yaxiscolumnorder);return chartObj.dataset.getY(d,yaxiscolumnorder)};return rp=commonRendererProp.params,chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,dimension=rendererBoundUtils.getAvailableBound(chartObj,commonPlotOptions),sum=0,processedData=[],datalabelOptions=[],GLT=[],fontFamily=[],fontStyle=[],fontWeight=[],yValues=[],seriesSpecificRotation=[],seriesSpecificRotationCount=[],globalRotation=isArray(globalRotation=commonPlotOptions.rotation||[0])?globalRotation:[globalRotation],globalRotationCount=0,chartObj.showLoading(chartObj.container),chartObj.seriesdata.forEach(function(series,seriesIndex){series.disabled||series.data.forEach(function(subseries,subSeriesIndex){subseries.forEach(function(d,itemIndex){d.seriesIndex=seriesIndex,d.subSeriesIndex=subSeriesIndex,d.itemIndex=itemIndex,d.layout=NULL,d.level=seriesIndex+"_"+subSeriesIndex+"_"+itemIndex;var yVal=getValue(d);defined(yVal)&&(sum+=yVal,yValues.push(yVal),processedData.push(d))})})}),extent=d3_extent(d3_merge([[0],d3_extent(yValues)])),percentFunc=function(d,showAs){return showAs===PERCENT_SHOWAS?sum:extent[1]},chartObj.seriesdata.forEach(function(series,seriesIndex){var options=getMergedDatalabelOptions(commonPlotOptions,series.plotoptions,chartObj,seriesIndex),font=applyDatalabelFonts(NULL,options,chartObj);fontFamily.push(font["font-family"]),fontStyle.push(font["font-style"]),fontWeight.push(font["font-weight"]),datalabelOptions.push(options),GLT.push(dataLabelTextContent(chartObj,rp,options,DATALABELS_LABELTYPE,percentFunc,seriesIndex)),hasBoundBox=hasBoundBox||isBoundBoxEnabled(options,chartObj);var rotation=series.plotoptions&&series.plotoptions.rotation;defined(rotation)&&(seriesSpecificRotation[seriesIndex]=isArray(rotation)?rotation:[rotation],seriesSpecificRotationCount[seriesIndex]=0)}),size=mathMin(dimension.width,dimension.height),minFont=perToPx(commonPlotOptions.minSize,size,perToPx("2%",size)),maxFont=perToPx(commonPlotOptions.maxSize,size,perToPx("20%",size)),fontScale=d3_scaleLinear().domain(extent).range([minFont,maxFont]),{rp:rp,processedData:processedData,dimension:dimension,sum:sum,fontScale:fontScale,datalabelOptions:datalabelOptions,fontFamily:fontFamily,fontStyle:fontStyle,fontWeight:fontWeight,drawLayout:function(render){var self=this,maskOptions=commonPlotOptions.mask,dataLabels=commonPlotOptions.datalabels,options={width:dimension.width,height:dimension.height,rotation:function(d){var degree,seriesIndex=_getSeriesIndex(d);return degree=seriesSpecificRotation[seriesIndex]?seriesSpecificRotation[seriesIndex][seriesSpecificRotationCount[seriesIndex]++%seriesSpecificRotation[seriesIndex].length]:globalRotation[globalRotationCount++%globalRotation.length],geometryUtils.degreeToRadian(degree)},fontSize:function(d){var value=getValue(d);return value?fontScale(value):0},fontFamily:function(d){return fontFamily[_getSeriesIndex(d)]},fontStyle:function(d){return fontStyle[_getSeriesIndex(d)]||"normal"},fontWeight:function(d){return fontWeight[_getSeriesIndex(d)]||"normal"},content:function(d){getValue(d);var format=GLT[_getSeriesIndex(d)];return{type:format.contentType,value:format(d),format:format}},padding:function(d){var currentDatalabelOptions=datalabelOptions[_getSeriesIndex(d)],padding=validateNullVal(commonPlotOptions.padding,2),boundBoxPadding=0;return isBoundBoxEnabled(currentDatalabelOptions,chartObj)&&(boundBoxPadding=2*getBoundBoxPadding(currentDatalabelOptions,chartObj)+getBoundBoxStrokeWidth(currentDatalabelOptions,chartObj)),padding+boundBoxPadding},strokeWidth:function(d){var plotOptions=chartObj.seriesdata[_getSeriesIndex(d)].plotoptions;return validateNullVal(plotOptions&&defined(plotOptions.strokeWidth)?plotOptions.strokeWidth:commonPlotOptions.strokeWidth,1)},onload:function(args){chartObj.hideLoading(chartObj.container),self.output=args,render()},origin:NULL,mask:function(){var mask,maskOptions=commonPlotOptions.mask,htmlEl=!$Browser.IE&&!$Browser.PHANTOMJS&&maskOptions.htmlEl,imageUrl=maskOptions.imageUrl,symbol=maskOptions.symbol;return htmlEl?mask="data:image/svg+xml;"+($Browser.IE?"base64":"utf8")+","+($Browser.IE?btoa(unescape(encodeURIComponent(htmlEl))):htmlEl):imageUrl?mask=imageUrl:symbol&&((mask=getSVGsymbol(symbol)).name=symbol),mask}(),maskBackground:maskOptions.background.color,invert:maskOptions.invert,textOverflow:dataLabels.textOverflow||"ellipsis",textOverlap:dataLabels.textOverlap||"adjust",maxWidth:dataLabels.maxWidth,fontScale:fontScale,chartObj:chartObj,boundBox:hasBoundBox};WordCloud(processedData,options)},hasBoundBox:hasBoundBox}},_wordcloudBoundBoxSvg=function(element,d,layoutObj,commonRendererProp){var rp=commonRendererProp.params,chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,layout=d.layout,seriesIndex=wordCloudUtils.getSeriesIndex(d),datalabelOptions=layoutObj.datalabelOptions[seriesIndex],boundboxOptions=getMergedBoundBoxOptions(datalabelOptions,chartObj),strokeWidth=defined(boundboxOptions.strokeWidth)?+boundboxOptions.strokeWidth:1,strokeDashArray=getDashArray(boundboxOptions.dashStyle,strokeWidth),strokeLineCap=getLineCap(boundboxOptions.lineCap,boundboxOptions.dashStyle),b=wordCloudUtils.getBoundBoxSize(layout,datalabelOptions,commonPlotOptions,chartObj);element.attrs({transform:"rotate("+radianToDegree(layout.rotation)+" "+layout.x+" "+layout.y+")",d:getBoundBoxPathDescription(b.x,b.y,b.width,b.height,b.r,0,NULL,{})}).styles({visibility:isBoundBoxEnabled(datalabelOptions,chartObj)?NULL:"hidden",fill:boundboxOptions.fillColor,"fill-opacity":boundboxOptions.fillOpacity,stroke:boundboxOptions.strokeColor,"stroke-opacity":boundboxOptions.strokeOpacity,"stroke-width":strokeWidth,"stroke-dasharray":strokeDashArray,"stroke-linecap":strokeLineCap})},drawMaskBackgroundInSvg=function(element,commonPlotOptions,layoutObj){var backgroundOptions=commonPlotOptions.mask.background,mask=layoutObj.output.mask,dimension=layoutObj.dimension,maskBackground=createElement("image",".mask-background",mask&&backgroundOptions.color?[1]:[],element,":first-child");mask&&maskBackground.attrs({width:dimension.width,height:dimension.height,"xlink:href":mask.toDataURL()}).style("opacity",backgroundOptions.opacity)};function getTransLinkPoints(x0,x1,data,type,isSourcePoint,axisrotated,stacked){return"x"==type?axisrotated?isSourcePoint||data.isCascaded?data.isPositive?x0+x1:x0:data.isPositive?x0:x0+x1:isSourcePoint?x0+x1:x0:axisrotated?isSourcePoint?x0:x0+x1:isSourcePoint||data.isCascaded?data.isPositive?x0:x0+x1:data.isPositive?x0+x1:x0}function getConnectorY(point){return point.y}svg_plot_renderer.wordcloud=function(){var commonRendererProp,layoutObj,isredraw=!1,_getSeriesIndex=wordCloudUtils.getSeriesIndex,_getItemIndex=wordCloudUtils.getItemIndex,filterAccessor=function(d){return d3_select(this).style("opacity",d.layout?NULL:0),d.layout};function chart(selection){return selection.each(function(data){var scaleFactor,rp=commonRendererProp.params,chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,notesArray=rp.notesArray,layoutUpate="legendFilter-colorScale"!==chartObj.phase,animationOptions=getAnimationConf(commonPlotOptions,NULL,chartObj,WORDCLOUD_CHARTNAME),isAnimationEnable=animationOptions.enabled,animationType=animationOptions.type,easingType=isredraw?d3_ease_linear:animationOptions.easingType,transitionDuration=isredraw?isAnimationEnable?200:0:animationOptions.duration,dataCount=chartObj.dataObject.totalnoofdatas,duration=isredraw?transitionDuration:animationType===FADEONEBYONE_ANIMATION||animationType===FADERANDOM_ANIMATION?transitionDuration/dataCount:transitionDuration,delay=isredraw?0:animationType===FADEONEBYONE_ANIMATION?function(d,i){return i*(transitionDuration/dataCount)}:animationType===FADERANDOM_ANIMATION?function(){return mathRandom()*dataCount*(transitionDuration/dataCount)}:0,initialOpacity=animationType===FADEALL_ANIMATION||animationType===FADERANDOM_ANIMATION||animationType===FADEONEBYONE_ANIMATION?0:NULL,container=appendEle(d3_select(this),"g",[data],".","class","wordcloudgroup"),dimension=(layoutObj=layoutUpate?new wordcloudLayout(commonRendererProp):layoutObj).dimension,w=dimension.width,h=dimension.height,fillColor=chart.fillColorFunc=getFillColor(chartObj,0,{x1:0,x2:w,y1:0,y2:h,r:mathMin(w,h)}),strokeColor=getStrokeColor(chartObj,0),multiColoring=isMultiColoring(commonPlotOptions,chartObj);function draw(){drawMaskBackgroundInSvg(container,commonPlotOptions,layoutObj),scaleFactor=layoutObj.output.scaleFactor;var transformation=wordCloudUtils.getContainerTransformation(layoutObj,dimension);container.attrs({transform:"translate("+transformation.translate+") scale("+transformation.scale+")","text-anchor":MIDDLE_ALIGN});var boundBoxGroup=appendEle(container,"g",[1],".","class","boundBoxes"),textGroup=appendEle(container,"g",[1],".","class","words"),boundBox=appendEle(boundBoxGroup,PATH_ELEMENT,layoutObj.hasBoundBox?layoutObj.processedData:[]);(boundBox=boundBox.filter(filterAccessor)).each(function(d){_wordcloudBoundBoxSvg(d3_select(this),d,layoutObj,commonRendererProp)});var text=appendEle(textGroup,TEXT_ELEMENT,layoutObj.processedData);text=text.filter(filterAccessor),applyStaticStyle(container,commonPlotOptions),text.each(function(d){var ele=d3_select(this),seriesIndex=_getSeriesIndex(d),itemIndex=_getItemIndex(d),layout=d.layout,isMultiLine=wordCloudUtils.isMultiLine(layout),plotOptions=chartObj.seriesdata[seriesIndex].plotoptions,plotLevelStrokeWidth=plotOptions&&plotOptions.strokeColor;applyDatalabelFonts(ele,layoutObj.datalabelOptions[seriesIndex],chartObj),ele[layout.nodeList.contentType](layout.nodeList.innerSVG),ele.styles({"font-size":layout.size+PX,fill:fillColor(multiColoring?itemIndex:seriesIndex,d),stroke:strokeColor(multiColoring?itemIndex:seriesIndex,d,plotLevelStrokeWidth!==UNDEFINED?plotLevelStrokeWidth:commonPlotOptions.strokeColor),filter:NULL,"stroke-linejoin":"round"}).attrs({x:layout.x,y:layout.y-(isMultiLine?layout.height/2:0),dy:wordCloudUtils.getDy(layout)+"em",transform:"rotate("+radianToDegree(layout.rotation)+" "+layout.x+" "+layout.y+")",id:"word_"+seriesIndex+"_"+d.subSeriesIndex+"_"+itemIndex,class:"series_"+seriesIndex}),isMultiLine&&translateTspan(ele,layout.x),plotOptions&&applyStaticStyle(ele,plotOptions)}),isredraw||text.style("opacity",initialOpacity).each(function(d){var tX,tY,layout=d.layout;if(animationType===SIZING_ANIMATION)tX=dimension.width/2,tY=dimension.height/2;else if(animationType===RANDOMOUT_ANIMATION){var usedWidth=w/scaleFactor,usedHeight=h/scaleFactor;tX=mathRandom()*(usedWidth-layout.width)-dimension.x+layout.width/2+(w-usedWidth)/2,tY=mathRandom()*(usedHeight-layout.height)-dimension.y+layout.height/2+(h-usedHeight)/2}else tX=layout.x,tY=layout.y;d3_select(this).attrs({x:tX,y:tY-(wordCloudUtils.isMultiLine(layout)?layout.height/2:0),transform:"rotate("+radianToDegree(layout.rotation)+" "+tX+" "+tY+")"})}),text.transition().duration(duration).delay(delay).ease(easingType).style("opacity",NULL).attrs({x:function(d){return d.layout.x},y:function(d){var layout=d.layout;return layout.y-(wordCloudUtils.isMultiLine(layout)?layout.height/2:0)},transform:function(d){var layout=d.layout;return"rotate("+radianToDegree(layout.rotation)+" "+layout.x+" "+layout.y+")"}}),chart.renderedTimer=setTimeout(function(){wordCloudUtils.addEvents(layoutObj),annotation&&data.forEach(function(series,i){notesArray=annotation.preprocessAnnotations(data,i,function(dt,k,j){var layout=dt.layout;return[transformation.translate[0]+(layout.x-layout.width/2)*scaleFactor,transformation.translate[1]+(layout.y-layout.height*wordCloudUtils.getDy(layout))*scaleFactor]},notesArray,chartObj,rp)}),chart.chartRendered=!0,isredraw=!0},transitionDuration+1e3/60)}chart.total=layoutObj.sum,chart.extentY=layoutObj.fontScale.domain(),layoutUpate?layoutObj.drawLayout(draw):draw()}),chart}function applyStaticStyle(element,options){element.styles({"paint-order":"stroke","fill-opacity":options.fillOpacity,"stroke-width":options.strokeWidth,"stroke-opacity":options.strokeOpacity})}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart},svg_plot_renderer.waterfallHelpers.drawConnectorLines=function(group,data,config,mode){var chartObj=config.chart,dataset=chartObj.dataset,axisrotated=config.axisrotated,stacked=config.stacked,yaxiscolumnorder=(config.xscale,config.yscale,config.yaxiscolumnorder),renderer=config.renderer,seriesindex=config.seriesindex,points=stacked?chartObj.dataObject.processedStackedData:data,xAxisReversed=(chartObj.systemConf.chart.axes.yaxis[yaxiscolumnorder||0].reversed,chartObj.systemConf.chart.axes.xaxis.reversed),plotoptions=config.plotoptions,commonPlotOptions=config.commonPlotOptions,connectorConfig=plotoptions&&plotoptions.connector?mergeJSON(commonPlotOptions.connector,plotoptions.connector,!0):commonPlotOptions.connector,connectorData=connectorConfig.enabled?function(points,config){for(var dataset=config.chart.dataset,yaxiscolumnorder=config.yaxiscolumnorder,isCatNullY=(config.stacked,DataProcessor.helpers.isCatNull(dataset,"y",yaxiscolumnorder)),yAccessor=getConnectorY,count=points.length-1,connectorDataPoints=[],i=0;i<count;i++){var point_now=points[i],point_after=points[i+1],point_now_y=yAccessor(point_now,yaxiscolumnorder),point_next_y=yAccessor(point_after,yaxiscolumnorder),point_now_undefined=isCatNullY(point_now_y),point_next_undefined=isCatNullY(point_next_y);if(point_now_undefined)connectorDataPoints.push([]);else if(point_next_undefined){for(var temp=i+2,point_subsequent=points[temp],point_subsequent_y=point_subsequent&&yAccessor(point_subsequent,yaxiscolumnorder),point_subsequent_defined=!isCatNullY(point_subsequent_y);temp<count&&!point_subsequent_defined;)point_subsequent=points[++temp],point_subsequent_y=point_subsequent&&yAccessor(point_subsequent,yaxiscolumnorder),point_subsequent_defined=!isCatNullY(point_subsequent_y);point_subsequent_defined&&connectorDataPoints.push([point_now,point_subsequent])}else connectorDataPoints.push([point_now,point_after])}return connectorDataPoints}(points,config):[],d3Line=d3_line().x(function(d,i){return getTransLinkPoints(renderer.getParamValue("x",d,seriesindex,null,renderer.commonOption),renderer.getParamValue("width",d,seriesindex,null,renderer.commonOption),d,"x",xAxisReversed?1==i:0==i,axisrotated)}).y(function(d,i){return getTransLinkPoints(renderer.getParamValue("y",d,seriesindex,null,renderer.commonOption),renderer.getParamValue("height",d,seriesindex,null,renderer.commonOption),d,"y",0==i,axisrotated)});appendEle(group,"path",connectorData,".","class","zcconnectorLine",null,function(d){return dataset.getX(d)}).attr("d",function(d,i){return d3Line(d)}).styles({fill:"none",stroke:connectorConfig.strokeColor||"black","stroke-width":connectorConfig.strokeWidth||1,"stroke-dasharray":getDashArray(connectorConfig.dashStyle,connectorConfig.strokeWidth||1),"stroke-opacity":0}).transition().duration(1e3).styles({"stroke-opacity":connectorConfig.strokeOpacity||1})};svg_plot_renderer.waterfallHelpers.drawConnectorLines;var canvas_plot_renderer={};plot.canvasRenderer=function(chartObj,args){var canvasRenderer={},systemconf=chartObj.systemConf,helpers=DataProcessor.helpers;return canvasRenderer.draw=function(update){chartObj.container.select(".highlight-canvas").style("visibility","hidden"),chartObj.context=updateCanvasContext(chartObj,"zc-canvas"),chartObj.labelHolderContext=updateCanvasContext(chartObj,"zc-labelholder-canvas",window.PointerEvent?chartObj.container.selectAll("div.legendarea").node():null),args.barDatasetIndex=0,chartObj.systemConf.legend.enabled&&chartObj.svg.select(".seriesholder").selectAll("*:not(.zmarea)").remove(),chartObj.dataObject.isPolarAxisCategory&&(chartObj.context.translate(chartObj.plotarea_approx.x,chartObj.plotarea_approx.y),chartObj.labelHolderContext.translate(chartObj.plotarea_approx.x,chartObj.plotarea_approx.y)),chartObj.dataset.getDataType("x")==ORDINAL_DATATYPE&&chartObj.isAxisCategory&&scale$1.barBandwidth(chartObj);var type=null;chartObj.chartRendered=!1;var isComboChart=chartObj.dataObject.isCombinationalChart,plotRect=chartObj.plotarea,orderedSeriesdata=isComboChart?renderer_helpers.arrangeSeriesRenderingOrder(chartObj):chartObj.seriesdata;if(chartObj.seriesdata.forEach(function(d,i){var currOrdereddata=orderedSeriesdata[i],curSeriesidx=isComboChart?currOrdereddata.seriesidx:i;!chartObj.isAxisCategory&&!chartObj.dataObject.isPolarAxisCategory&&curSeriesidx>0||(type=helpers.getChartType(currOrdereddata.type||chartObj.userdata.seriesdata.type,"string"),null==chartObj.renderer[curSeriesidx]&&(chartObj.renderer[curSeriesidx]=createCanvasRenderer(type),chartObj.rendererConf[curSeriesidx]=new plot.rendererConf),chartObj.renderer[curSeriesidx].chartRendered=!1,0==i&&(stateChangeListener(chartObj,systemconf.chart.plot.events,0,"init"),chartObj.hideLoading(chartObj.container)),renderer_helpers.setRendererProp(chartObj,chartObj.renderer[curSeriesidx],currOrdereddata,curSeriesidx,i,args),plotRect.width>0&&plotRect.height>0&&drawCanvas(chartObj,currOrdereddata,chartObj.renderer[curSeriesidx]))}),renderer_helpers.renderCompletedEvents(chartObj,update,args),!update){var animationOptions=getAnimationConf(chartObj.systemConf.chart.plot.plotoptions[type],chartObj.seriesdata[0].plotoptions,chartObj,type),animationDuration=defined(animationOptions.duration)?animationOptions.duration:400;if(!defined(animationOptions.enabled)||0===animationDuration)return;var totalSeries=chartObj.seriesdata.length;chartObj.context.canvas.style.opacity=0;var fadeTimeout=setInterval(function(){var allRendered=!0;if(chartObj.renderer.length===totalSeries)for(var i=0;i<chartObj.renderer.length;i++)if(!chartObj.renderer[i].chartRendered){allRendered=!1;break}allRendered&&(clearInterval(fadeTimeout),d3_select(chartObj.context.canvas).transition().duration(animationDuration).style("opacity",1))},1e3/60)}},canvasRenderer};var createCanvasRenderer=plot.canvasRenderer.createCanvasRenderer=function(chartName){switch(chartName){case"bullet":chartName="bar";break;case"web":case"arearange":chartName="area";break;case"bubble":case"geobubble":case"geoscatter":chartName="scatter"}return new canvas_plot_renderer[chartName]},drawCanvas=plot.canvasRenderer.drawCanvas=function(chartObj,renderdata,renderer,context,styles,filterIndex){function transformWrap(wrap,selection,translate){return wrap.select("g."+selection).attr("transform","translate("+translate.x+","+translate.y+")")}context=defined(context)?context:chartObj.context,transformWrap(chartObj.wrap,"seriesholder",{x:chartObj.plotarea.left,y:chartObj.plotarea.top}),transformWrap(chartObj.staticPaneSVG,"labelholder",{x:chartObj.plotarea.left,y:chartObj.plotarea.top}),renderer(context,renderdata,styles,filterIndex)},updateCanvasContext=plot.canvasRenderer.updateCanvasContext=function(chartObj,selector,prevElement,parentNode){parentNode=chartObj.svg.node().parentNode;var canvas=chartObj.svg.node().parentNode.querySelector("canvas."+selector),width=chartObj.plotarea.width,height=chartObj.plotarea.height;(parentNode=parentNode||chartObj.svg.node().parentNode).isD3Selection&&(parentNode=parentNode.node()),canvas||((canvas=document.createElement("canvas")).className=selector,canvas.setAttribute("actual-width",width),canvas.setAttribute("actual-height",height),canvas.style.position="absolute",canvas.style.pointerEvents=NONE,"string"==typeof prevElement&&(prevElement=chartObj.container.node().querySelector(prevElement)),parentNode.insertBefore(canvas,prevElement||chartObj.staticPaneSVG.node())),canvas.width=width,canvas.height=height,canvas.style.left=mathRound(chartObj.plotarea.left)+"px",canvas.style.top=mathRound(chartObj.plotarea.top)+"px",canvas.style.visibility="visible";var context=canvas.getContext("2d"),imageSmoothingEnabled=$Browser.prefix.lowercase+"ImageSmoothingEnabled";return context.clearRect(0,0,width,height),context[imageSmoothingEnabled]=!1,context.imageSmoothingEnabled=!1,fixHDPI(context)};canvas_plot_renderer.bar=function(){var commonRendererProp,bandwidth1,bandwidth2,yscale,barDatasetIndex,shiftInfo;function chart(context,seriesdata,effect,filterIndex){var rp=commonRendererProp.params,chartObj=rp.chartObj,xscale=rp.xscale,stacked=rp.stacked,index=rp.datasetIndex,axisrotated=rp.axisrotated,commonPlotOptions=rp.commonPlotOptions,labelQueue=(rp.color,rp.labelQueue),yaxiscolumnorder=(rp.hasNegValue,rp.yaxiscolumnorder),dataset=rp.dataset,systemconf=chartObj.systemConf,dataObject=(chartObj.plotarea,chartObj.dataObject);if(!bandwidth1||!bandwidth2)return isredraw=!0,void(chart.chartRendered=!0);yscale=rp.yscale;var datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder),xCategories=xscale.domain(),yCategories=datatypeY==ORDINAL_DATATYPE?yscale.domain():null,gradientDim=(defined(dataObject.hierarchical)&&dataObject.getCategories("x"),chartObj.chartTypes[index].name,null),yAxisReversed=chartObj.systemConf.chart.axes.yaxis[yaxiscolumnorder||0].reversed,plotoptions=seriesdata.plotoptions,gvp=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions),isBullet=chartObj.chartTypes[index].value===charttype.bullet,targetMarker=gvp("targetMarker")||{},levelMarker=plotoptions&&plotoptions.levelMarker?mergeJSON(commonPlotOptions.levelMarker,plotoptions.levelMarker,!0):commonPlotOptions.levelMarker,borderOptions=plotoptions&&plotoptions.border?mergeJSON(commonPlotOptions.border,plotoptions.border,!0):commonPlotOptions.border,multiColoring=isMultiColoring(commonPlotOptions,chartObj),hasColorScale=colorscale_helpers.isQuantileColorScale(chartObj),fillOpacity=(chart.fillColorFunc=getFillColor(chartObj,index,gradientDim),getStrokeColor(chartObj,index),gvp("fillOpacity")),getParamValue=chart.getParamValue=function(){return chartObj.dataObject.getTransRectValue.apply(chartObj.dataObject,toArray(arguments))},commonOption=getBarCommonOption(chartObj.rendererConf[index],index),levelMarkerWidth=commonOption.levelMarkerWidth;levelMarker.overlayRange="below";var levelMarkerColor=levelMarker.color,borderRadius={tlx:0,tly:0,trx:0,trY:0,brx:0,bry:0,blx:0,bly:0},borderSize=0,borderColor=null,borderStyle=null,radius=0;defined(borderOptions)&&isTrue(borderOptions.show)&&(borderSize=defined(borderOptions.size)?borderOptions.size:1,borderColor=borderOptions.color,borderStyle=borderOptions.style,radius=borderOptions.radius,borderRadius=getParamValue("radius",null,null,null,commonOption,radius));var isLevelMarkerIndex,dashStyle=getDashArray(borderStyle,null==borderSize?2:borderSize),legend_data=systemconf.legend,rounded=function(radius){for(var l in radius)if(radius.hasOwnProperty(l))return!!radius[l];return!1}(borderRadius),size=(legend_data.patternPallete,legend_data.patternPallete,pick(targetMarker.size,levelMarkerWidth-2*pick(targetMarker.padding,commonOption.padding/2))),bandwidth=isBullet?xscale.bandwidth():levelMarkerWidth,customMarkerSize=targetMarker.size;if(targetMarker.size=size=defined(customMarkerSize)?isBullet?mathMin(size,bandwidth/10):size:size/10,stacked&&levelMarker.enabled&&!defined(effect)){var stackGroup=chartObj.userdata.seriesdata.stackGroup,groupedByStack=chartObj.dataObject.groupedByStack,actualStackGroupIndex=stackGroup?chartObj.dataObject.getStackGroupIndex(index,stackGroup):0;isLevelMarkerIndex=groupedByStack.has(actualStackGroupIndex)&&groupedByStack.get(actualStackGroupIndex)[0].si==index}return seriesdata.disabled||(chart.seriesdataAfterUpdate=[],seriesdata.data.forEach(function(data,i){var dataUpdate=chartObj.dataObject.updateSeriesdatabyCategories(d3_values(data),xCategories,yCategories,yaxiscolumnorder,!0);chartObj.systemConf.chart.axes.xaxis.reversed&&(dataUpdate=dataUpdate.slice(0).reverse()),hasColorScale&&defined(filterIndex)&&(dataUpdate=legend_helpers.filterSelectionByColor(dataUpdate,!0,filterIndex,chartObj)),chart.seriesdataAfterUpdate[i]=dataUpdate,stacked&&levelMarker.enabled&&!defined(effect)&&xCategories.length!=dataUpdate.length&&plot.render.bulletHelpers.addDummyDataForLevelmarker(dataUpdate,xCategories,dataset,yaxiscolumnorder),dataUpdate.forEach(function(d,j){var fillColor=getRawColor(chartObj,multiColoring?j:index,d,index);if(levelMarker.enabled&&!defined(effect)&&(stacked&&isLevelMarkerIndex&&0===i||!stacked)){var rect=plot.render.bulletHelpers.ZC_BAR_getLevelMarkerRect(d,levelMarker,chartObj,commonOption,rp,i,index),x=axisrotated?rect.y:rect.x,y=axisrotated?rect.x:rect.y,w=rect.width,h=rect.height;context.save(),context.beginPath(),context.fillStyle=plot.render.bulletHelpers.getBulletLevelMarkerGradient(d,levelMarker,chartObj,fillColor,levelMarkerColor)||rgba_canvas((isArray(levelMarker.color)?levelMarker.color[0]:levelMarker.color)||fillColor,levelMarker.fillOpacity),canvasUtils.roundedRect(context,x,y,w,h,borderRadius,yAxisReversed,axisrotated),context.fill(),context.closePath(),context.restore()}x=getParamValue("x",d,i,j,commonOption),y=getParamValue("y",d,i,j,commonOption),w=getParamValue("width",d,i,j,commonOption),h=getParamValue("height",d,i,j,commonOption),yAxisReversed&&(axisrotated?x-=w:y-=h),gradientDim=[w,h];var drawBarFunction=function(context,fillStyle){context.save(),context.translate(x,y),context.strokeStyle=rgba_canvas(fillColor,fillOpacity),context.fillStyle=fillStyle,rounded?(context.beginPath(),canvasUtils.roundedRect(context,0,0,w,h,borderRadius),context.fill()):(context.beginPath(),context.rect(0,0,w,h),context.fill()),function(context,size,color,dashStyle){size>0&&(context.lineWidth=size,isArray(dashStyle)&&dashStyle.length&&defined(context.setLineDash)&&context.setLineDash(dashStyle),context.strokeStyle=color,context.stroke())}(context,borderSize,borderColor||fillColor,dashStyle),context.closePath(),context.restore()};if(chartObj.imagePallete)effects.canvas_patterns.imageFill({x:x,y:y,context:context,name:chartObj.imagePallete[multiColoring?j:index]},drawBarFunction);else{var fillStyle=defined(effect)?effect:chart.fillColorFunc(multiColoring?j:index,d,null,null,fillOpacity,gradientDim,{x:x,y:y,width:w,height:h,context:context},!1);drawBarFunction(context,fillStyle)}isBullet&&!0===targetMarker.enabled&&!d.isDummy&&(x=bandwidth1(dataset.getX(d))+bandwidth/2,y=yscale(d[targetMarker.dataindex]),function(context,marker,size,x,y,axisRotated){var outerSize=5*size,outerStrokeWidth=pick(marker.outerStrokeWidth,1),innerStrokeWidth=pick(marker.innerStrokeWidth,1),outerStrokeColor=marker.outerStrokeColor,innerStrokeColor=marker.innerStrokeColor,outerFillColor=marker.outerFillColor,innerFillColor=marker.innerFillColor;defined(marker.outerFillOpacity)&&outerFillColor&&(outerFillColor=rgba_canvas(outerFillColor,marker.outerFillOpacity));defined(marker.outerStrokeOpacity)&&outerStrokeColor&&(outerStrokeColor=rgba_canvas(outerStrokeColor,marker.outerStrokeOpacity));defined(marker.innerFillOpacity)&&innerFillColor&&(innerFillColor=rgba_canvas(innerFillColor,marker.innerFillOpacity));defined(marker.innerStrokeOpacity)&&innerStrokeColor&&(innerStrokeColor=rgba_canvas(innerStrokeColor,marker.innerStrokeOpacity));defined(marker.dashStyle)&&(marker.outerDashStyle=marker.innerDashStyle=marker.dashStyle);var cache=canvas_plot_renderer.scatter.getCache(marker.symbol,outerSize,outerStrokeColor,outerStrokeWidth,outerFillColor,innerStrokeColor,innerStrokeWidth,innerFillColor,marker),adjust=cache.adjustPosition,cacheCanvas=cache.canvas,drawWidth=cache.width,centered=outerSize+outerStrokeWidth/2+adjust;context.save(),axisRotated?(context.translate(y,x),context.rotate(90*deg2rad)):context.translate(x,y);context.drawImage(cacheCanvas,-centered,-centered,drawWidth,drawWidth),context.restore()}(context,targetMarker,size,x,y,axisrotated))})})),targetMarker.size=customMarkerSize,labelQueue.push({renderer:chart,charttype:"bar",chartObj:chartObj,args:[seriesdata,index]}),chart.chartRendered=!0,chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.bandwidth1=function(_){return arguments.length?(bandwidth1=_,chart):bandwidth1},chart.bandwidth2=function(_){return arguments.length?(bandwidth2=_,chart):bandwidth2},chart.barDatasetIndex=function(_){return arguments.length?(barDatasetIndex=_,chart):barDatasetIndex},chart.shiftInfo=function(_){return arguments.length?(shiftInfo=_,chart):shiftInfo},chart},canvas_plot_renderer.line=function(){var commonRendererProp,shiftInfo,yrangePos,scatter=canvas_plot_renderer.scatter();function chart(context,series,pattern,filterIndex){var rp=commonRendererProp.params,chartObj=rp.chartObj,xscale=rp.xscale,yscale=rp.yscale,index=rp.datasetIndex,commonPlotOptions=(rp.axisrotated,rp.commonPlotOptions),color=rp.color,labelQueue=rp.labelQueue,yaxiscolumnorder=rp.yaxiscolumnorder,currentdata=series,plotoptions=currentdata.plotoptions,gvp=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions),gradientDim=(chartObj.systemConf.chart.axes.xaxis.reversed,gradient_helpers.getDimension(chartObj,index)),canvasarea=chartObj.canvasarea,dashStyle=(chartObj.chartTypes[index].value,gvp("dashStyle")),strokeWidth=validateNullVal(gvp("strokeWidth"),2),strokeOpacity=gvp("strokeOpacity"),strokeColor=getStrokeColor(chartObj,index,gradientDim),markeroptions=plotoptions?mergeJSON(commonPlotOptions.marker,plotoptions.marker,!0):commonPlotOptions.marker,strokeLineCap=getLineCap(gvp("lineCap"),dashStyle),strokeDashArray=getDashArray(dashStyle,strokeWidth),markerEnabled=!(!datacount_based_intelligence(chartObj,"marker")||!dimension_based_intelligence(chartObj,"marker",mathMin(canvasarea.width,canvasarea.height)))&&markeroptions.enabled,datatypeX=chartObj.dataset.getDataType("x"),datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder),xCategories=datatypeX==ORDINAL_DATATYPE?xscale.domain():null,yCategories=datatypeY==ORDINAL_DATATYPE?yscale.domain():null;if(defined(pattern)?(context.lineWidth=pick(pattern["stroke-width"],strokeWidth),defined(filterIndex)&&(markerEnabled=!0,strokeOpacity=1e-8)):context.lineWidth=strokeWidth,series.disabled||(chart.seriesdataAfterUpdate=[],context.save(),currentdata.data.forEach(function(d,i){var serData;context.beginPath(),serData=datatypeX==ORDINAL_DATATYPE||datatypeY==ORDINAL_DATATYPE?chartObj.dataObject.updateSeriesdatabyCategories(d3_values(d),xCategories,yCategories,yaxiscolumnorder):d,chart.seriesdataAfterUpdate[i]=serData,getLineLayout(rp,serData,shiftInfo,yrangePos).context(context)(serData),strokeDashArray.length&&"object"==typeof strokeDashArray&&defined(context.setLineDash)&&(context.setLineDash(strokeDashArray),context.lineCap=strokeLineCap),context.strokeStyle=strokeColor(index,NULL,gvp("strokeColor")||color,NULL,strokeOpacity,i),context.stroke()}),context.restore(),markerEnabled&&(scatter.commonRendererProp(commonRendererProp).shiftInfo(shiftInfo),scatter.chartRendered=!1,scatter(context,series,pattern,filterIndex))),!markerEnabled){var markerSize=markerEnabled?.7*(markeroptions.size||strokeWidth)*10+strokeWidth/2:0;labelQueue.push({renderer:chart,charttype:"scatter",chartObj:chartObj,args:[currentdata,index,markerSize]})}return chart.chartRendered=!0,chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_)&&chart:commonRendererProp},chart.shiftInfo=function(_){return arguments.length?(shiftInfo=_)&&chart:shiftInfo},chart},canvas_plot_renderer.area=function(){var commonRendererProp,shiftInfo,shiftDiff,line=canvas_plot_renderer.line();function chart(context,seriesdata,pattern,filterIndex){var rp=commonRendererProp.params,chartObj=rp.chartObj,xscale=rp.xscale,yscale=rp.yscale,stacked=rp.stacked,index=rp.datasetIndex,axisrotated=rp.axisrotated,commonPlotOptions=rp.commonPlotOptions,color=rp.color,labelQueue=rp.labelQueue,yaxiscolumnorder=rp.yaxiscolumnorder,plotoptions=seriesdata.plotoptions,gvp=utils.getValueOfPlotOptions(plotoptions,commonPlotOptions),fillOpacity=gvp("fillOpacity"),strokeWidth=gvp("strokeWidth"),strokeColor=gvp("strokeColor"),markerEnabled=defined(plotoptions)?utils.getValueOfPlotOptions(plotoptions.marker,commonPlotOptions.marker)("enabled"):commonPlotOptions.marker.enabled,borderEnabled=defined(strokeWidth)&&""!=strokeWidth&&0!=pInt(strokeWidth)||defined(strokeColor)&&""!=strokeColor||markerEnabled,datatypeX=chartObj.dataset.getDataType("x"),datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder),xCategories=datatypeX==ORDINAL_DATATYPE?xscale.domain():null,yCategories=datatypeY==ORDINAL_DATATYPE?yscale.domain():null,isRangeChart="arearange"==chartObj.chartTypes[index].name,gradientDim=gradient_helpers.getDimension(chartObj,index);chart.fillColorFunc=getFillColor(chartObj,index,gradientDim),strokeColor=getStrokeColor(chartObj,index);return defined(pattern)&&(pattern,defined(filterIndex)&&(markerEnabled=!0,fillOpacity=1e-8)),seriesdata.disabled||(chart.seriesdataAfterUpdate=[],seriesdata.data.forEach(function(d,i){var serData;serData=datatypeX==ORDINAL_DATATYPE||datatypeY==ORDINAL_DATATYPE?chartObj.dataObject.updateSeriesdatabyCategories(d3_values(d),xCategories,yCategories,yaxiscolumnorder):d,chart.seriesdataAfterUpdate[i]=serData,shiftDiff=null!=shiftInfo?null==shiftDiff||0==shiftDiff?chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[serData.length-1],"x")-chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,serData[serData.length-2],"x"):shiftDiff:0;var area=getAreaLayout(rp,shiftDiff,shiftInfo,serData,i),drawAreaFunction=function(context,fillStyle){context.beginPath(),context.fillStyle=fillStyle,area.context(context)(d),context.fill(),context.restore()};if(chartObj.imagePallete)effects.canvas_patterns.imageFill({context:context,name:chartObj.imagePallete[index]},drawAreaFunction);else{var fillStyle=defined(pattern)&&isUndefined(filterIndex)?pattern:chart.fillColorFunc(index,null,null,color,fillOpacity,gradientDim,null,!1,i);drawAreaFunction(context,fillStyle)}}),!borderEnabled&&!markerEnabled||seriesdata.disabled||(line.chartRendered=!1,line.commonRendererProp(commonRendererProp).shiftInfo(shiftInfo),line(context,seriesdata,pattern,filterIndex))),!defined(labelRenderer)||borderEnabled||markerEnabled||(isRangeChart?(labelQueue.push({renderer:chart,charttype:"scatter",chartObj:chartObj,args:[seriesdata,index,0,1]}),labelQueue.push({renderer:chart,charttype:"scatter",chartObj:chartObj,args:[seriesdata,index,0,0]})):labelQueue.push({renderer:chart,charttype:"scatter",chartObj:chartObj,args:[seriesdata,index,0,null]})),chart.chartRendered=!0,chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.shiftInfo=function(_){return arguments.length?(shiftInfo=_,chart):shiftInfo},chart},canvas_plot_renderer.scatter=function(){var shiftInfo,commonRendererProp,yrangePos,dataProcessorHelpers=DataProcessor.helpers;function chart(context,seriesData,pattern,filterIndex){var rp=commonRendererProp.params,chartObj=rp.chartObj,xscale=rp.xscale,yscale=rp.yscale,stacked=rp.stacked,index=rp.datasetIndex,axisrotated=rp.axisrotated,commonPlotOptions=rp.commonPlotOptions,color=rp.color,labelQueue=rp.labelQueue,yaxiscolumnorder=rp.yaxiscolumnorder,dataset=rp.dataset,threshold=rp.threshold,plotoptions=seriesData.plotoptions||{},cpOptions=plotoptions?mergeJSON(commonPlotOptions,plotoptions,!0):commonPlotOptions,currentseriesdata=seriesData.data,temp=chartObj.chartTypes[index],cType=temp.value,chartName=temp.name,scatterOrBubble=isScatterChartType(cType),isBubbleChart=chartcategory.bubble.has(cType),isPolar=chartObj.dataObject.isPolarAxisCategory,legend_data=(chartObj.seriesColor,chartObj.systemConf.legend),markerOptions=cpOptions.marker,symboltype=markerOptions.symbol||"circle",symbolsize=markerOptions.size,imageUrl=markerOptions.imageUrl,multiColoring=scatterOrBubble&&isMultiColoring(cpOptions,chartObj),patternPallete=legend_data.patternPallete,hasColorScale=colorscale_helpers.isQuantileColorScale(chartObj);scatterOrBubble?symbolsize=pick(symbolsize,1):(isUndefined(symbolsize)&&(symbolsize=pick(cpOptions.strokeWidth,2)),imageUrl||(symbolsize*=isPolar?.56:.7),color=pick(seriesData.color,chartObj.seriesColor[index%chartObj.seriesColor.length]));var outerSize=5*symbolsize,outerFillOpacity=markerOptions.outerFillOpacity,outerStrokeOpacity=markerOptions.outerStrokeOpacity,innerFillOpacity=markerOptions.innerFillOpacity,innerStrokeOpacity=markerOptions.innerStrokeOpacity,outerStrokeWidth=pick(markerOptions.outerStrokeWidth,1),innerStrokeWidth=pick(markerOptions.innerStrokeWidth,1),outerStrokeColor=pick(markerOptions.outerStrokeColor,color),innerStrokeColor=pick(markerOptions.innerStrokeColor,color),outerFillColor=pick(markerOptions.outerFillColor,color),innerFillColor=pick(markerOptions.innerFillColor,color),outerDashArray=getDashArray(markerOptions.outerDashStyle,outerStrokeWidth),innerDashArray=getDashArray(markerOptions.innerDashStyle,innerStrokeWidth),outerStrokeLineCap=getLineCap(markerOptions.outerLineCap,markerOptions.outerDashStyle),innerStrokeLineCap=getLineCap(markerOptions.innerLineCap,markerOptions.innerDashStyle),markerPosition=markerOptions.position;function getSymbolSize(d){return(!isPolar||d&&!d.isDummy)&&(isPolar||cType===cType.stkdarea||!isCatNullX(dataset.getX(d))&&!isCatNullY(dataset.getY(d,yaxiscolumnorder)))?isBubbleChart?chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"z",chartObj.zscale,yrangePos)/2:outerSize:0}defined(pattern)&&(outerStrokeWidth=pick(pattern["stroke-width"],outerStrokeWidth),!defined(filterIndex)||outerStrokeOpacity&&d3_rgb(outerStrokeColor).opacity||(innerStrokeWidth=pick(pattern["stroke-width"],innerStrokeWidth))),defined(outerFillOpacity)&&outerFillColor&&(outerFillColor=rgba_canvas(outerFillColor,outerFillOpacity)),defined(outerStrokeOpacity)&&outerStrokeColor&&(outerStrokeColor=rgba_canvas(outerStrokeColor,outerStrokeOpacity)),defined(innerFillOpacity)&&innerFillColor&&(innerFillColor=rgba_canvas(innerFillColor,innerFillOpacity)),defined(innerStrokeOpacity)&&innerStrokeColor&&(innerStrokeColor=rgba_canvas(innerStrokeColor,innerStrokeOpacity)),chart.getSymbolSize=getSymbolSize,chart.getSymbolBBox=function(d){var size=getSymbolSize(d);return size>0&&("line"==symboltype||"vertical-line"==symboltype)?"line"==symboltype?{width:size,height:strokeWidth||1}:"vertical-line"==symboltype?{width:strokeWidth||1,height:size}:void 0:null};var cache,useCache=!(defined(threshold)||multiColoring||"scatter"!==chartName&&"line"!==chartName&&"area"!==chartName||patternPallete||imageUrl||hasColorScale),strokeColor=(chart.fillColorFunc=getFillColor(chartObj,index,null,!scatterOrBubble),getStrokeColor(chartObj,index)),innerFillColorFunc=getFillColor(chartObj,index,null,!0);if(useCache){fillStyle=chart.fillColorFunc(0,null,null,outerFillColor,null,scatterOrBubble?[outerSize,outerSize]:null,!1);var adjust=(cache=canvas_plot_renderer.scatter.getCache(symboltype,outerSize,outerStrokeColor,outerStrokeWidth,fillStyle,innerStrokeColor,innerStrokeWidth,innerFillColor,markerOptions)).adjustPosition,cacheCanvas=cache.canvas,drawWidth=cache.width}if(!seriesData.disabled){var fillStyle,strokeStyle,datatypeX=chartObj.dataset.getDataType("x"),datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder),isCatNullX=dataProcessorHelpers.isCatNull(dataset,"x"),isCatNullY=dataProcessorHelpers.isCatNull(dataset,"y",yaxiscolumnorder),xCategories=datatypeX==ORDINAL_DATATYPE?xscale.domain():null,yCategories=datatypeY==ORDINAL_DATATYPE?yscale.domain():null;(datatypeX!=ORDINAL_DATATYPE||null==xscale.domain||defined(chartObj.dataObject.hierarchical))&&chartObj.dataObject.getCategories("x");chart.seriesdataAfterUpdate=[],currentseriesdata.forEach(function(data,j){var dataUpdate;dataUpdate=datatypeX==ORDINAL_DATATYPE||datatypeY==ORDINAL_DATATYPE?chartObj.dataObject.updateSeriesdatabyCategories(d3_values(data),xCategories,yCategories,yaxiscolumnorder):data,chart.seriesdataAfterUpdate[j]=dataUpdate,hasColorScale&&defined(pattern)&&(dataUpdate=legend_helpers.filterSelectionByColor(dataUpdate,!0,filterIndex,chartObj)),dataUpdate.forEach(function(d,i){var outerStrokeStyle,position=0===i?START_ALIGN:i===dataUpdate.length-1?END_ALIGN:MIDDLE_ALIGN;if(isPolar||cType===charttype.stkdarea||d&&!d.isDummy&&!isCatNullX(dataset.getX(d))&&!isCatNullY(dataset.getY(d,yaxiscolumnorder))){if(markerPosition&&markerPosition.indexOf(position)<=-1)return;var x=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"x"),y=chartObj.dataObject.getXYvalue(axisrotated,stacked,xscale,yscale,yaxiscolumnorder,d,"y"),size=getSymbolSize(d);if(useCache){context.beginPath();var centered=size+outerStrokeWidth/2+adjust;context.drawImage(cacheCanvas,x-centered,y-centered,drawWidth-1,drawWidth-1),context.closePath()}else{if(outerFillColor||outerStrokeColor){outerStrokeStyle=strokeColor(multiColoring?i:index,d,chartObj.imagePallete?null:markerOptions.outerStrokeColor,NULL,outerStrokeOpacity);var drawScatterFunction=function(context,fillStyle,imageDimension){canvas_plot_renderer.scatter.drawPath(symboltype,context,x,y,size,outerStrokeWidth,outerStrokeStyle,fillStyle,outerDashArray,outerStrokeLineCap,imageUrl,imageDimension,outerFillOpacity)};if(imageUrl){var options={x:x,y:y,width:2*size,height:2*size,context:context,name:imageUrl,repeatMode:"no-repeat"};effects.canvas_patterns.imageFill(options,drawScatterFunction)}else if(chartObj.imagePallete){options={x:x,y:y,context:context,name:chartObj.imagePallete[multiColoring?i:index]};effects.canvas_patterns.imageFill(options,drawScatterFunction)}else{var fillStyle=chart.fillColorFunc(multiColoring?i:index,d,null,markerOptions.outerFillColor,outerFillOpacity,scatterOrBubble?[size,size]:null,!1);drawScatterFunction(context,fillStyle)}}var innerMarker=!0;(imageUrl||0===innerStrokeWidth&&(0===innerFillOpacity||"transparent"===markerOptions.innerFillColor))&&(innerMarker=!1),innerMarker&&(fillStyle=innerFillColorFunc(multiColoring?i:index,d,null,markerOptions.innerFillColor,innerFillOpacity,null,!1),strokeStyle=rgba_canvas(strokeColor(multiColoring?i:index,d,chartObj.imagePallete?null:markerOptions.innerStrokeColor),innerStrokeOpacity),canvas_plot_renderer.scatter.drawPath(symboltype,context,x,y,size/2,innerStrokeWidth,strokeStyle,fillStyle,innerDashArray,innerStrokeLineCap,null,null,null,"inner"))}}})})}if(defined(labelRenderer)){var markerSize;if(scatterOrBubble)markerSize=2*outerSize+markerOptions.outerStrokeWidth;else{var strokeWidth=pick(cpOptions.strokeWidth,2);markerSize=pick(markerOptions.size,strokeWidth)*outerSize+strokeWidth/2}labelQueue.push({renderer:chart,charttype:"scatter",chartObj:chartObj,args:[seriesData,index,markerSize,yrangePos]})}return chart.chartRendered=!0,chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.shiftInfo=function(_){return arguments.length?(shiftInfo=_,chart):shiftInfo},chart.yrangePos=function(_){return arguments.length?(yrangePos=_,chart):yrangePos},chart},canvas_plot_renderer.scatter.drawPath=function(symbol,context,x,y,size,strokeWidth,strokeColor,fillColor,strokeDashArray,strokeLineCap,imageUrl,imageDimension,opacity,side){if(context.save(),context.translate(x,y),context.beginPath(),context.lineWidth=strokeWidth,context.strokeStyle=strokeColor,"circle"===symbol)context.arc(0,0,size,0,2*mathPI);else{var path=getSVGsymbol(symbol)(2*size,side);canvasUtils.drawPath(context,path)}imageUrl&&(context.globalAlpha=opacity,context.translate(-size+imageDimension.x,-size+imageDimension.y)),context.fillStyle=fillColor,fillColor&&context.fill(),imageUrl&&(context.globalAlpha=1),strokeDashArray&&strokeDashArray.length&&"object"==typeof strokeDashArray&&defined(context.setLineDash)&&(context.setLineDash(strokeDashArray),context.lineCap=strokeLineCap),strokeWidth&&strokeColor&&context.stroke(),context.closePath(),context.restore()},canvas_plot_renderer.scatter.getCache=function(symbol,outerSize,osc,osw,ofc,isc,isw,ifc,markerOptions){var scaleRatio=1.5*DEVICE_PIXEL_RATIO,cacheCanvas=document.createElement("canvas"),tempPos=(outerSize+osw/2)*scaleRatio+5,cache=cacheCanvas.getContext("2d"),canvasDimension=(2*outerSize+osw+10)*scaleRatio,width=canvasDimension/scaleRatio;return cacheCanvas.height=cacheCanvas.width=canvasDimension,this.drawPath(symbol,cache,tempPos,tempPos,outerSize*scaleRatio,osw*scaleRatio,osc,ofc,getDashArray(markerOptions.outerDashStyle,osw,scaleRatio),getLineCap(markerOptions.outerLineCap,markerOptions.outerDashStyle)),this.drawPath(symbol,cache,tempPos,tempPos,outerSize/2*scaleRatio,isw*scaleRatio,isc,ifc,getDashArray(markerOptions.innerDashStyle,isw,scaleRatio),getLineCap(markerOptions.innerLineCap,markerOptions.innerDashStyle),null,null,null,"inner"),{canvas:cache.canvas,width:width,adjustPosition:5/scaleRatio}},canvas_plot_renderer.heatmap=function(){var commonRendererProp;function chart(context,seriesdata,effect,filterIndex){var rp=commonRendererProp.params,chartObj=rp.chartObj,xscale=rp.xscale,yscale=rp.yscale,index=rp.datasetIndex,commonPlotOptions=rp.commonPlotOptions,labelQueue=rp.labelQueue,yaxiscolumnorder=rp.yaxiscolumnorder,datatypeY=chartObj.dataset.getDataType("y",yaxiscolumnorder),xCategories=xscale.domain(),yCategories=datatypeY==ORDINAL_DATATYPE?yscale.domain():null,symbolPath=commonPlotOptions.symbol&&getSVGsymbol(commonPlotOptions.symbol),borderRadius=chartObj.dataObject.getTransRectValue("radius",null,null,null,null,commonPlotOptions.borderRadius),strokeColor=(chart.fillColorFunc=getFillColor(chartObj,index),getStrokeColor(chartObj,index)),hasColorScale=colorscale_helpers.isQuantileColorScale(chartObj);return seriesdata.disabled||(chart.seriesdataAfterUpdate=[],seriesdata.data.forEach(function(data,i){var dataUpdate=chartObj.dataObject.updateSeriesdatabyCategories(d3_values(data),xCategories,yCategories,yaxiscolumnorder);chart.seriesdataAfterUpdate[i]=dataUpdate,hasColorScale&&defined(filterIndex)&&(dataUpdate=legend_helpers.filterSelectionByColor(dataUpdate,!0,filterIndex,chartObj)),dataUpdate.forEach(function(d,j){var pos=getHeatCellPosition(chartObj,d,xscale,yscale,yaxiscolumnorder),x=pos.x,y=pos.y,w=pos.width,h=pos.height,drawCell=function(context,fillStyle){if(context.save(),context.translate(x+w/2,y+h/2),context.beginPath(),context.lineWidth=commonPlotOptions.strokeWidth,context.strokeStyle=strokeColor(index,d,commonPlotOptions.strokeColor,NULL,commonPlotOptions.strokeOpacity),context.fillStyle=fillStyle,symbolPath){var size=mathMin(w,h)/2;if("circle"===commonPlotOptions.symbol)context.arc(0,0,size,0,2*mathPI);else{var path=symbolPath(2*size);canvasUtils.drawPath(context,path)}}else canvasUtils.roundedRect(context,-w/2,-h/2,w,h,borderRadius);context.fill(),context.stroke(),context.closePath(),context.restore()};if(chartObj.imagePallete&&isWithinColorRange(chartObj.dataset.getClr(d),chartObj))effects.canvas_patterns.imageFill({x:x,y:y,context:context,name:getRawColor(chartObj,index,d,index)},drawCell);else{var fillStyle=defined(effect)?effect:chart.fillColorFunc(index,d,null,null,commonPlotOptions.fillOpacity,[w,h]);drawCell(context,fillStyle)}})})),labelRenderer&&labelQueue.push({renderer:chart,charttype:"hierarchy",chartObj:chartObj,args:[seriesdata,index,null,null,null,seriesdata.disabled?[]:d3_merge(chart.seriesdataAfterUpdate)]}),chart.chartRendered=!0,chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart},canvas_plot_renderer.treemap=function(){var commonRendererProp,layoutObj,getLevel=treemapUtils.getLevel,getSeriesIndex=treemapUtils.getSeriesIndex,getItemIndex=treemapUtils.getItemIndex;function chart(context,seriesdata,effect,filterIndex){layoutObj=new treemapLayout(commonRendererProp);var rp=commonRendererProp.params,chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,notesArray=rp.notesArray,labelQueue=rp.labelQueue,hasColorScale=colorscale_helpers.isQuantileColorScale(chartObj),multiColoring=isMultiColoring(commonPlotOptions,chartObj),borderRadius=chartObj.dataObject.getTransRectValue("radius",NULL,NULL,NULL,NULL,commonPlotOptions.borderRadius),parentOptions=commonPlotOptions.parent,dimension=layoutObj.dimension,leafNodes=layoutObj.leafNodes,seriesWiseNodes=layoutObj.seriesWiseNodes,processedData=layoutObj.processedData,fillColor=layoutObj.fillColor,isHighlight="highlight-canvas"===context.canvas.className;if(context.save(),context.translate(dimension.x,dimension.y),chart.total=processedData[0].value,isHighlight){var index=+seriesdata.level;processedData=processedData.filter(function(d){return getSeriesIndex(d)===index&&!(hasColorScale&&d.children)}),hasColorScale&&(processedData=legend_helpers.filterSelectionByColor(processedData,!0,filterIndex,chartObj))}if(processedData.forEach(function(d,i){var strokeClr,seriesIndex=getSeriesIndex(d),itemIndex=getItemIndex(d),tileBound=treemapUtils.getTileBound(chartObj,d),x=tileBound.x,y=tileBound.y,w=tileBound.width,h=tileBound.height,customStrokeColor=(d.children?parentOptions.strokeColor:NULL)||commonPlotOptions.strokeColor;d.depth?isHighlight&&isUndefined(effect)&&chartObj.legendHighlight.getLegendHighlightEffect(index,"selectedSeries")!==NONE?strokeClr="black":customStrokeColor?strokeClr=customStrokeColor:d.children&&(strokeClr=d.data.arcColor):strokeClr=TRANSPARENT;var fillStyle,drawCell=function(context,fillStyle){context.save(),context.translate(x+w/2,y+h/2),context.beginPath(),context.lineWidth=(d.children?parentOptions.strokeWidth:NULL)||commonPlotOptions.strokeWidth,context.strokeStyle=rgba_canvas(strokeClr,(d.children?parentOptions.strokeOpacity:NULL)||commonPlotOptions.strokeOpacity),context.fillStyle=fillStyle,canvasUtils.roundedRect(context,-w/2,-h/2,w,h,borderRadius),context.fill(),context.stroke(),context.closePath(),context.restore()};chartObj.imagePallete&&isWithinColorRange(chartObj.dataset.getClr(d),chartObj)&&d.depth?effects.canvas_patterns.imageFill({x:x,y:y,context:context,name:getRawColor(chartObj,multiColoring?itemIndex:seriesIndex,d,seriesIndex)},drawCell):(fillStyle=defined(effect)?effect:d.children?rgba_canvas(d.data.arcColor,parentOptions.fillOpacity):fillColor[seriesIndex](seriesIndex,d.data,NULL,NULL,commonPlotOptions.fillOpacity,[w,h]),drawCell(context,fillStyle))}),context.restore(),labelRenderer){var transform=[dimension.x,dimension.y],totalFunc=function(d,showAs){return showAs===PERCENT_SHOWAS?chart.total:chart.getProcessedNode(d).parent.value};chartObj.seriesdata.forEach(function(d,i){labelQueue.push({renderer:chart,charttype:"hierarchy",chartObj:chartObj,args:[seriesWiseNodes[i],i,NULL,NULL,totalFunc,leafNodes[i],transform]}),labelQueue.push({renderer:chart,charttype:"hierarchy",chartObj:chartObj,args:[seriesWiseNodes[i],i,NULL,NULL,totalFunc,[seriesWiseNodes[i][0]],transform,!0]})})}return annotation&&!isHighlight&&chartObj.seriesdata.forEach(function(series,i){notesArray=annotation.preprocessAnnotations(chartObj.seriesdata,i,function(dt,k,j){var node=chart.getProcessedNode(dt),tileBound=treemapUtils.getTileBound(chartObj,node);return[tileBound.x+dimension.x,tileBound.y+dimension.y]},notesArray,chartObj,rp)}),chart.chartRendered=!0,setTimeout(function(){treemapUtils.addEvents(layoutObj)},20),chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart.getProcessedNode=function(d){return layoutObj.nodes[getLevel(d)]},chart},dataLabel_handler.canvasUtils=function(){},dataLabel_handler.canvasUtils.align=function(anchor){switch(anchor.toLocaleLowerCase()){case"start":return LEFT_ALIGN;case"middle":return CENTER_ALIGN;case"end":return RIGHT_ALIGN}},dataLabel_handler.canvasUtils.parseTextShadow=function(shadow){if(shadow=shadow&&shadow.trim())return shadow.split(/\s+/).map(function(property){var temp=pInt(property);return isNaN(temp)?property:temp})},dataLabel_handler.canvasUtils.addTextShadow=function(context,shadow){defined(shadow)&&(context.shadowOffsetX=shadow[0],context.shadowOffsetY=shadow[1],context.shadowBlur=shadow[2],context.shadowColor=shadow[3])},dataLabel_handler.canvasUtils.createText=function(context,textContent,font,fill,textShadow,fontStyle,position){var fillColor=canvasUtils.rgba(fill||fontStyle.color,validateNullVal(fontStyle&&fontStyle["fill-opacity"],1)),strokeColor=fontStyle.stroke,text=textContent||"";position=position||[0,0],context.font=font,context.fillStyle=fillColor,fontStyle["stroke-width"]>0&&("contrast"===fontStyle.stroke&&(strokeColor=getContrastColor(fillColor)),context.strokeStyle=strokeColor,context.lineWidth=fontStyle["stroke-width"],context.strokeText(text,position[0],position[1])),dataLabel_handler.canvasUtils.addTextShadow(context,textShadow),context.fillText(text,position[0],position[1])};var _canvasDatalabelUtils=dataLabel_handler.canvasUtils,_wordcloudBoundBoxCanvas=function(context,d,layoutObj,commonRendererProp){var rp=commonRendererProp.params,chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,layout=d.layout,seriesIndex=wordCloudUtils.getSeriesIndex(d),datalabelOptions=layoutObj.datalabelOptions[seriesIndex],boundboxOptions=getMergedBoundBoxOptions(datalabelOptions,chartObj),strokeWidth=defined(boundboxOptions.strokeWidth)?+boundboxOptions.strokeWidth:1,strokeDashArray=getDashArray(boundboxOptions.dashStyle,strokeWidth),strokeLineCap=getLineCap(boundboxOptions.lineCap,boundboxOptions.dashStyle),b=wordCloudUtils.getBoundBoxSize(layout,datalabelOptions,commonPlotOptions,chartObj);isBoundBoxEnabled(datalabelOptions,chartObj)&&(context.beginPath(),context.lineWidth=strokeWidth,isArray(strokeDashArray)&&strokeDashArray.length&&defined(context.setLineDash)&&(context.setLineDash(strokeDashArray),context.lineCap=strokeLineCap),context.strokeStyle=rgba_canvas(boundboxOptions.strokeColor||TRANSPARENT,boundboxOptions.strokeOpacity),context.fillStyle=rgba_canvas(boundboxOptions.fillColor||"#000",boundboxOptions.fillOpacity),canvasUtils.roundedRect(context,b.x,b.y,b.width,b.height,b.r),context.stroke(),context.fill(),context.closePath())},drawMaskBackgroundInCanvas=function(context,commonPlotOptions,layoutObj,update){var backgroundOptions=commonPlotOptions.mask.background,mask=layoutObj.output.mask;update&&mask&&backgroundOptions.color&&(context.globalAlpha=validateNullVal(backgroundOptions.opacity,1),context.drawImage(mask,0,0),context.globalAlpha=1)};canvas_plot_renderer.wordcloud=function(){var commonRendererProp,_getSeriesIndex=wordCloudUtils.getSeriesIndex,_getItemIndex=wordCloudUtils.getItemIndex,helpers=_canvasDatalabelUtils;function chart(context,seriesdata,effect,filterIndex){var highlightStrokeWidth,highlightStrokeColor,highlightFillColor,highlightIndex,rp=commonRendererProp.params,chartObj=rp.chartObj,commonPlotOptions=rp.commonPlotOptions,notesArray=rp.notesArray,renderer=chartObj.renderer[0],layoutUpate="legendFilter-colorScale"!==chartObj.phase&&!effect,layoutObj=layoutUpate?new wordcloudLayout(commonRendererProp):renderer.layout,dimension=layoutObj.dimension,w=dimension.width,h=dimension.height,processedData=layoutObj.processedData,fillColor=chart.fillColorFunc=getFillColor(chartObj,0,{x1:0,x2:w,y1:0,y2:h,r:mathMin(w,h)}),gradientOptions=fillColor.gradientOptions,strokeColor=getStrokeColor(chartObj,0),hasColorScale=colorscale_helpers.isQuantileColorScale(chartObj),multiColoring=isMultiColoring(commonPlotOptions,chartObj),font=[],textShadow=[];function draw(){var transformation=wordCloudUtils.getContainerTransformation(layoutObj,dimension);if(context.save(),context.translate(transformation.translate[0],transformation.translate[1]),context.scale(transformation.scale,transformation.scale),drawMaskBackgroundInCanvas(context,commonPlotOptions,layoutObj,layoutUpate),defined(highlightIndex)&&(processedData=processedData.filter(function(d){return _getSeriesIndex(d)===highlightIndex}),hasColorScale&&(processedData=legend_helpers.filterSelectionByColor(processedData,!0,filterIndex,chartObj))),processedData.forEach(function(d,i){var layout=d.layout;if(layout){layout.text;var tX,tY,x=layout.x,y=layout.y,dy=wordCloudUtils.getDy(layout),seriesIndex=_getSeriesIndex(d),itemIndex=_getItemIndex(d),datalabelOptions=layoutObj.datalabelOptions[seriesIndex],plotOptions=chartObj.seriesdata[seriesIndex].plotoptions||{};font[seriesIndex]=font[seriesIndex]||canvasUtils.getFontStyles(chartObj,datalabelOptions),textShadow[seriesIndex]=textShadow[seriesIndex]||helpers.parseTextShadow(datalabelOptions.textShadow);var strokeWidth=pick(highlightStrokeWidth,plotOptions.strokeWidth,commonPlotOptions.strokeWidth,1),stroke=pick(highlightStrokeColor,plotOptions.strokeColor!==UNDEFINED?plotOptions.strokeColor:commonPlotOptions.strokeColor),strokeOpacity=pick(plotOptions.strokeOpacity,commonPlotOptions.strokeOpacity),fillOpacity=pick(plotOptions.fillOpacity,commonPlotOptions.fillOpacity),drawText=function(context,fillStyle){if(font[seriesIndex]["font-size"]=layout.size+PX,context.save(),layout.rotation&&(context.translate(x,y),context.rotate(layout.rotation),context.translate(-x,-y)),effect||_wordcloudBoundBoxCanvas(context,d,layoutObj,commonRendererProp),helpers.addTextShadow(context,textShadow[seriesIndex]),context.font=getUserFontValue(font[seriesIndex]),context.textAlign=CENTER_ALIGN,"html"===layout.nodeList.contentType)layout.nodeList.forEach(function(a){var userFont,userFillStyle,userStyle=a.style,content=a.text;userStyle.length&&(userFont=getUserFontValue(font[seriesIndex],userStyle),parseFloat(userStyle["font-size"]),userFillStyle=userStyle.fill),tX=x+(a.dx||0),tY=y+(a.dy||0)*layout.size+layout.size*dy-(wordCloudUtils.isMultiLine(layout)?layout.height/2:0),context.font=userFont||getUserFontValue(font[seriesIndex]),context.strokeStyle=strokeColor(multiColoring?itemIndex:seriesIndex,d,stroke,NULL,commonPlotOptions.strokeOpacity),context.lineWidth=strokeWidth,context.strokeText(content,tX,tY),context.fillStyle=userFillStyle||fillStyle,context.fillText(content,tX,tY)});else{var content=layout.nodeList.innerSVG;tX=x,tY=y+layout.size*dy,context.strokeStyle=strokeColor(multiColoring?itemIndex:seriesIndex,d,stroke,NULL,strokeOpacity),context.lineWidth=strokeWidth,context.lineJoin="round",context.strokeText(content,tX,tY),context.fillStyle=fillStyle,context.fillText(content,tX,tY)}context.restore()},customGradientDimension=NULL;if("linear"===gradientOptions.type&&"userSpaceOnUse"!==gradientOptions.options[gradientOptions.type].gradientUnits&&(customGradientDimension={x1:x-layout.width/2,x2:x+layout.width/2,y1:y-layout.height/2,y2:y+layout.height/2}),chartObj.imagePallete&&isWithinColorRange(chartObj.dataset.getClr(d),chartObj))effects.canvas_patterns.imageFill({x:x,y:y,context:context,name:getRawColor(chartObj,multiColoring?itemIndex:seriesIndex,d,seriesIndex)},drawText);else{var fillStyle=highlightFillColor||fillColor(multiColoring?itemIndex:seriesIndex,d,NULL,NULL,fillOpacity,customGradientDimension);drawText(context,fillStyle)}}}),context.restore(),annotation&&!effect){var scaleFactor=layoutObj.output.scaleFactor;chartObj.seriesdata.forEach(function(series,i){notesArray=annotation.preprocessAnnotations(chartObj.seriesdata,i,function(dt,k,j){var layout=dt.layout;return[transformation.translate[0]+(layout.x-layout.width/2)*scaleFactor,transformation.translate[1]+(layout.y-layout.height*wordCloudUtils.getDy(layout))*scaleFactor]},notesArray,chartObj,rp)})}chart.chartRendered=!0,setTimeout(function(){wordCloudUtils.addEvents(layoutObj)},20)}return effect&&(highlightIndex=isObjectPropDefined(seriesdata,"data[0][0].seriesIndex",!0),highlightStrokeWidth=effect["stroke-width"],highlightStrokeColor=effect.stroke,highlightFillColor=effect.fill),chart.total=layoutObj.sum,chart.extentY=layoutObj.fontScale.domain(),layoutUpate?(layoutObj.drawLayout(draw),renderer.layout=layoutObj):draw(),chart}return chart.commonRendererProp=function(_){return arguments.length?(commonRendererProp=_,chart):commonRendererProp},chart},dataLabel_handler.canvas=function(chartObj,series,i,groupName){if(series){var isStackedLabels="stacklabel"===(groupName=groupName||"label"),isInnerLabel=groupName===INNERLABEL_LABELTYPE||groupName===PARENTLABELS_LABELTYPE,properties=series.properties,rotation=properties.rotation,dataLabels=properties.dataLabels,renderer=defined(i)?chartObj.renderer[i]:null,hasColorScale=colorscale_helpers.isQuantileColorScale(chartObj),isTreemap=chartObj.chartTypes[0].value==charttype.treemap,fontStyle=canvasUtils.getFontStyles(chartObj,properties.dataLabels,properties.color,null,i,isStackedLabels),fontSize=parseFloat(fontStyle["font-size"]),helpers=_canvasDatalabelUtils,context=chartObj.labelHolderContext,canvasFont=getUserFontValue(fontStyle),textShadow=helpers.parseTextShadow(fontStyle["text-shadow"]);series.forEach(function(subSeries,subSeriesIndex){var dataUpdate=renderer&&renderer.seriesdataAfterUpdate?renderer.seriesdataAfterUpdate[subSeriesIndex]:null;subSeries.forEach(function(item,k){context.save();var x,y,dy,height,xy=item.xy||[item.X,item.Y],display=item.display,color=NULL;if(hasColorScale||properties.rp.threshold||chartObj.dataObject.isHierarchy||!(chartObj.isAxisCategory||chartObj.dataObject.isPolarAxisCategory||chartObj.dataObject.isNonAxisMultiSeriesCategory)||properties.multiColoring){var d=isTreemap&&isInnerLabel?properties.dataUpdate[k]:dataUpdate&&dataUpdate[k],rawColor=getRawColor(chartObj,properties.multiColoring?k:i,d&&d.data?d.data:d,i);isTreemap&&isInnerLabel&&/(top-outset|bottom-outset)/.test(dataLabels.position)&&d3_rgb(rawColor).opacity<.1&&(rawColor="white"),color=getLabelFontColor(chartObj.systemConf,rawColor,dataLabels,chartObj)}!0===display&&(x=xy[0],y=xy[1],dy=item.customHTML?0:parseFloat(item.DY||0),height=item.height,dy=(item.tspanInfo||1===dy?fontSize:height)*dy,defined(rotation)&&0!==rotation?(chartObj.axes.rotated&&(dy*=-1),context.translate(x+dy,y),context.rotate(canvasUtils.getRadianAngle(rotation))):context.translate(x,y+dy),defined(item.ANCHOR)&&(context.textAlign=helpers.align(item.ANCHOR)),item.customHTML?item.customHTML.forEach(function(ele){!function(chartObj,context,item,ele,fontStyle,canvasFont,textShadow,color){var helpers=_canvasDatalabelUtils,xy=item.xy||[item.X,item.Y],bb=ele.bb,node=ele.node;switch(ele.nodeName){case"image":var cusX=+(d3Ele=d3_select(node)).attr("x")||0,cusY=+d3Ele.attr("y")||0,cusWIDTH=+d3Ele.attr("width")||0,cusHEIGHT=+d3Ele.attr("height")||0,href=d3Ele.attr("href")||d3Ele.attr("xlink:href"),img=new Image;img.onload=function(){context.drawImage(img,xy[0]+cusX,xy[1]+cusY,cusWIDTH,cusHEIGHT)},img.src=href;break;case"rect":cusX=+(d3Ele=d3_select(node)).attr("x")||0,cusY=+d3Ele.attr("y")||0,cusWIDTH=+d3Ele.attr("width")||0,cusHEIGHT=+d3Ele.attr("height")||0;var d3Ele,cusRADIUS=+d3Ele.attr("rx")||0;context.fillStyle=d3Ele.style("fill"),context.strokeStyle=d3Ele.style("stroke"),context.lineWidth=d3Ele.style("stroke-width"),context.beginPath(),canvasUtils.roundedRect(context,cusX,cusY,cusWIDTH,cusHEIGHT,chartObj.dataObject.getTransRectValue("radius",NULL,NULL,NULL,NULL,cusRADIUS)),context.fill(),context.stroke(),context.closePath();break;case"text":case"tspan":var font,fill,userStyle=node.style;userStyle&&(font=getUserFontValue(fontStyle,userStyle),fill=userStyle.fill),context.translate(bb.x,bb.y+.77*bb.height),context.textAlign=helpers.align("start"),helpers.createText(context,node.textContent,font||canvasFont,fill||color||fontStyle.color,textShadow,fontStyle),context.translate(-bb.x,-bb.y-.77*bb.height)}}(chartObj,context,item,ele,fontStyle,canvasFont,textShadow,color)}):item.tspanInfo?item.tspanInfo.forEach(function(a){var font,fSize,fill,userStyle=a.style;userStyle&&(font=getUserFontValue(fontStyle,userStyle),fill=userStyle.fill,fSize=parseFloat(userStyle["font-size"])),helpers.createText(context,a.text,font||canvasFont,fill||color||fontStyle.color,textShadow,fontStyle,[a.dx||0,(fSize||fontSize)*a.dy])}):helpers.createText(context,item.text,canvasFont,color||fontStyle.color,textShadow,fontStyle),context.restore())})})}},datalabelsBoundBox_handler.canvas=function(){var series;function shape(selection,index){selection.each(function(){if(series){var properties=series.properties,chartObj=properties.rp.chartObj,context=chartObj.labelHolderContext;if(!defined(context))return!1;if(isBoundBoxEnabled(properties.dataLabels,chartObj)){var boundboxOptions=getMergedBoundBoxOptions(properties.dataLabels,chartObj),hookOptions=getBoundBoxHookConf(boundboxOptions.hook),dataUpdate=properties.dataUpdate,rotation=properties.rotation||0,padding=getBoundBoxPadding(properties.dataLabels,chartObj),r=getBorderRadius(boundboxOptions.radius),strokeWidth=defined(boundboxOptions.strokeWidth)?+boundboxOptions.strokeWidth:1,strokeDashArray=getDashArray(boundboxOptions.dashStyle,strokeWidth),strokeLineCap=getLineCap(boundboxOptions.lineCap,boundboxOptions.dashStyle),heightAdjustScale=d3_scaleLinear();series.forEach(function(subSeries){subSeries.forEach(function(item,k){if(!0===item.display){var xy=item.xy||[item.X,item.Y],x=xy[0],y=xy[1],dy=void 0!==item.actualDY?item.actualDY:parseFloat(item.DY)||0,h=item.height,w=item.width,strokeColor=getBoundBoxColor(boundboxOptions.strokeColor,properties,chartObj,dataUpdate,index);"function"==typeof strokeColor&&(strokeColor=strokeColor(dataUpdate&&dataUpdate[k],k));var fillColor=getBoundBoxColor(boundboxOptions.fillColor,properties,chartObj,dataUpdate,index);if("function"==typeof fillColor&&(fillColor=fillColor(dataUpdate&&dataUpdate[k],k)),context.save(),defined(rotation)&&0!==rotation){var tx=0,ty=0;chartObj.axes.rotated?tx=-1*dy*h:(ty=("middle"===item.ANCHOR?w/2:"end"===item.ANCHOR?-w:0)+padding,tx=-heightAdjustScale.domain([-.3,.9]).range([h,0])(dy)-padding),context.translate(x+tx,y+ty),context.rotate(canvasUtils.getRadianAngle(rotation))}else x=("middle"===item.ANCHOR?x-w/2:"end"===item.ANCHOR?x-w:x)-padding,y=y-heightAdjustScale.domain([-.3,1]).range([h,0])(dy)-padding,context.translate(x,y);context.fillStyle=rgba_canvas(fillColor,boundboxOptions.fillOpacity),context.strokeStyle=rgba_canvas(strokeColor,boundboxOptions.strokeOpacity),context.lineWidth=strokeWidth,strokeDashArray&&defined(context.setLineDash)&&(context.setLineDash(strokeDashArray),context.lineCap=strokeLineCap),context.beginPath(),context.translate(-x,-y),canvasUtils.boundBoxWithHook(context,getBoundBoxPathDescription(x,y,w,h,r,padding,item.hookPosition,hookOptions,item.adjustVal)),context.fill(),context.stroke(),context.closePath(),context.restore()}})})}}})}return shape.args=function(_){return arguments.length?(series=_,shape):series},shape};var GeoUtils={getGeoBBox:function(feature,geoPath){return this.geoBoundToRect(geoPath.bounds(feature))},geoBoundToRect:function(bound){return{x:bound[0][0],y:bound[0][1],width:Math.abs(bound[1][0]-bound[0][0]),height:Math.abs(bound[1][1]-bound[0][1])}},getFeatureGradientBBox:function(feature,type,geoPath){return this.getGeoBBox(feature,geoPath)},toLatLong:function(geoMap,x,y){var utils_geo=geoMap.geo.utils,xy=[x,y];geoMap.geo.isCanvasMode||(xy=geoMap.getTransform().invert(xy));return utils_geo.projection.invert(xy)},toXY:function(geoMap,x,y){if("geoOrthographic"===(geoMap.systemConf.map.projection||{}).name){var rotate=geoMap.geo.utils.projection.rotate(),centerPos=[-rotate[0],-rotate[1]];if(d3$1.geoDistance([x,y],centerPos)>Math.PI/2)return[null,null]}return geoMap.geo.utils.projection([x,y])||[null,null]},clearContext:function(context){context&&context.clearRect&&context.clearRect(0,0,context.canvas.width,context.canvas.height)},applyTransform:function(transform,context){context.canvas?(context.translate(transform.x,transform.y),context.scale(transform.k,transform.k)):context.attr("transform",transform)},round:function(value,precision){var multiplier=Math.pow(10,precision||0);return Math.round(value*multiplier)/multiplier}};function MapLayer(layer,util,layerContainer,styles,geoMap,useMesh){this.layer=layer,this.utils=util,this.layerContainer=layerContainer,this.styles=styles,this.geoMap=geoMap,this.useMesh=useMesh,this.initialize()}function GeoPoint(x,y){this.x=x,this.y=y}function LatLong(longitude,latitude){this.longitude=longitude,this.latitude=latitude}function Label(text,latLong,styles,geoMap){this.text=text,this.latLong=latLong,this.styles=styles,this.geoMap=geoMap}function GeoLabels(geoMap){this.geoMap=geoMap,this.initialize()}function MapDataProcessor(geoMap){this.geoMap=geoMap,this.initialize()}function MapDataSet(geoMap){this.geoMap=geoMap,this.initialize()}function GeoPlotRenderer(geoMap){this.geoMap=geoMap,this.initialize()}MapLayer.GEO_FORMATS=d3$1.set(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","GeometryCollection","Feature","FeatureCollection","Topology"]),MapLayer.getMapFeatures=function(object){return"FeatureCollection"===object.type?object.features:splat(object)},MapLayer.prototype.getStyle=function(feature,property,checkForGradient){var styles=this.styles||{},featureStyle=feature.styles||{},properties=feature.properties||{},styleValue=pick(styles[property],featureStyle[property],properties[property],this.defaultStyles[property]);if("function"==typeof styleValue)return styleValue.call(this,feature,styleValue);if(checkForGradient)if(this._gradient)styleValue=this._gradient;else{var gradients=pick(styles.gradients,featureStyle.gradients,properties.gradients,{});if("linear"===gradients.type||"radial"===gradients.type){var bbox_geo=GeoUtils.getFeatureGradientBBox(feature,gradients.type,this.utils.geoPath);styleValue=getGradients(gradients,[bbox_geo.width,bbox_geo.height],this.getStyle(feature,"fillColor"),this.renderingMode,this.fillOpacity,"area",null,this.geoMap),feature.transform={x:bbox_geo.x,y:bbox_geo.y},this.isCanvasMode||"linear"!==gradients.type||(this._gradient=styleValue)}}else"dashStyle"===property&&defined(styleValue)&&(styleValue=getDashArray(styleValue,this.getStyle("strokeWidth")));return styleValue},MapLayer.prototype.initialize=function(){var renderingMode=this.layerContainer.isD3Selection?"svg":"canvas";this.defaultStyles={fillColor:"transparent",strokeColor:"#333",strokeWidth:.6,dashStyle:null},this.renderingMode=renderingMode,this.isCanvasMode=!0!==this.layerContainer.isD3Selection,this.renderingModeCapitialized=toCapitalize(renderingMode),this.paintLayer()},MapLayer.prototype.update=function(newLayer){newLayer&&(this.layer=newLayer),this.paintLayer(!0)},MapLayer.prototype.paintLayer=function(update){this["paint"+this.renderingModeCapitialized+"Layer"](update)},MapLayer.prototype.paintSvgLayer=function(update){var mapLayer=this,areas=MapLayer.getMapFeatures(mapLayer.layer),applyBorderStyles=function(features){features.attrs({stroke:function(feature){return mapLayer.getStyle(feature,"strokeColor")},"stroke-width":function(feature){return mapLayer.getStyle(feature,"strokeWidth")},"stroke-dasharray":function(feature){return mapLayer.getStyle(feature,"dashStyle")},"stroke-opacity":function(feature){return mapLayer.getStyle(feature,"strokeOpacity")}})},features=createElement("path",".map-feature",MapLayer.getMapFeatures(areas),mapLayer.layerContainer).attrs({fill:function(feature){return mapLayer.getStyle(feature,"fillColor",!0)},"fill-opacity":function(feature){return mapLayer.getStyle(feature,"fillOpacity")||1},d:mapLayer.utils.geoPath});if(mapLayer.useMesh&&mapLayer.layer.length){var mesh=mapLayer.geoMap.dataObject.getFeatureMesh(MapLayer.getMapFeatures(mapLayer.layer));mapLayer.mesh=features=createElement("path",".map-feature-outline",[areas[0]],mapLayer.layerContainer).attrs({fill:"none",d:mapLayer.utils.geoPath(mesh)}),applyBorderStyles(features)}else mapLayer.mesh&&mapLayer.mesh.remove(),applyBorderStyles(features)},MapLayer.prototype.paintCanvasLayer=function(update){var mapLayer=this,context=mapLayer.layerContainer,areas=MapLayer.getMapFeatures(mapLayer.layer);if(each(areas,function(feature){context.save(),context.fillStyle=mapLayer.getStyle(feature,"fillColor",!0),context.strokeStyle=mapLayer.getStyle(feature,"strokeColor"),context.lineWidth=mapLayer.getStyle(feature,"strokeWidth");var dashArray=mapLayer.getStyle(feature,"dashStyle");dashArray&&defined(context.setLineDash)&&context.setLineDash(dashArray),context.beginPath(),mapLayer.utils.geoPath(feature),feature.transform&&context.translate(feature.transform.x,feature.transform.y),context.fill(),mapLayer.useMesh||context.stroke(),context.closePath(),context.restore()}),mapLayer.useMesh&&areas.length){var mesh=mapLayer.geoMap.dataObject.getFeatureMesh(MapLayer.getMapFeatures(mapLayer.layer));if(!mesh)return;context.save(),context.fillStyle=mapLayer.getStyle(areas[0],"fillColor",!0),context.strokeStyle=mapLayer.getStyle(areas[0],"strokeColor"),context.lineWidth=mapLayer.getStyle(areas[0],"strokeWidth");var dashArray=mapLayer.getStyle(mesh,"dashStyle");dashArray&&defined(context.setLineDash)&&context.setLineDash(dashArray),context.beginPath(),mapLayer.utils.geoPath(mesh),context.stroke(),context.closePath(),context.restore()}},MapLayer.prototype.destroy=function(){var mapLayer=this;mapLayer.update([]),each(mapLayer,function(value,key){mapLayer[key]=null,delete mapLayer[key]})},GeoPoint.prototype.toLatLong=function(geoMap){var latLong=GeoUtils.toLatLong(geoMap,this.x,this.y)||[null,null];return new LatLong(latLong[0],latLong[1])},GeoPoint.prototype.toJSON=function(){return{x:this.x,y:this.y}},GeoPoint.prototype.toArray=function(){return[this.x,this.y]},LatLong.prototype.toXY=function(geoMap){var xy=GeoUtils.toXY(geoMap,this.longitude,this.latitude)||[null,null];return new GeoPoint(xy[0],xy[1])},LatLong.prototype.toJSON=function(){return{latitude:this.latitude,longitude:this.longitude}},LatLong.prototype.toArray=function(){return[this.longitude,this.latitude]},Label.prototype.getXY=function(){var coordinates=this._coordinates;return coordinates||(coordinates=this._coordinates=this.latLong.toXY(this.geoMap)),coordinates},Label.prototype.getDimension=function(){var style=this.styles,dimension=this._dimension;return dimension||(dimension=this._dimension={width:utils.fontUtils.getTextWidth(this.text,style.fontSize,style.fontFamily,style.fontStyle,style.fontWeight),height:utils.fontUtils.getTextHeight(this.text,style.fontSize,style.fontFamily,style.fontStyle,style.fontWeight)}),dimension},Label.prototype.getBBox=function(){var bbox_geo=this._bbox;if(!bbox_geo){var xy=this.getXY(),dimension=this.getDimension();bbox_geo=this._bbox={x:xy.x-dimension.width/2-2.5,y:xy.y-dimension.height/2-2.5,width:dimension.width+2.5,height:dimension.height+2.5}}return bbox_geo},Label.prototype.overlapsWith=function(anotherLabel){var bbox_geo=this.getBBox(),otherBBox=anotherLabel.getBBox();return bbox_geo.x<otherBBox.x+otherBBox.width&&bbox_geo.x+bbox_geo.width>otherBBox.x&&bbox_geo.y<otherBBox.y+otherBBox.height&&bbox_geo.height+bbox_geo.y>otherBBox.y},Label.prototype.insideRect=function(rect){var R2=this.getBBox();return R2.x+R2.width<rect.x+rect.width&&R2.x>rect.x&&R2.y>rect.y&&R2.y+R2.height<rect.y+rect.height},Label.prototype.clearCache=function(){this._bbox=this._coordinates=this._dimension=null},GeoLabels.prototype.initialize=function(){var geoMap=this.geoMap,userLabelStyles=geoMap.systemConf.map.labels||{},geoLabelStyles=this.geoLabelStyles=Object.create(userLabelStyles),labelArray=this.labels=[],labelBoundary={x:0,y:0,width:geoMap.plotarea.width,height:geoMap.plotarea.height};!0===geoLabelStyles.show&&(geoLabelStyles.fontFamily=getFontFamilyByHierarchy(userLabelStyles,geoMap),geoLabelStyles.fontSize=getFontSizeByHierarchy(userLabelStyles,geoMap),geoLabelStyles.fontWeight=userLabelStyles.fontWeight||"normal",geoLabelStyles.fontStyle=userLabelStyles.fontStyle||"normal",geoLabelStyles.fontColor=userLabelStyles.fontColor||"#333",geoLabelStyles.textShadow=userLabelStyles.textShadow,geoLabelStyles.strokeColor=userLabelStyles.strokeColor,geoLabelStyles.strokeWidth=userLabelStyles.strokeWidth,geoLabelStyles.type="background",!0===geoMap.systemConf.map.allAreas&&geoMap.dataObject.userUnmatchedMapFeatures.each(function(feature,index){var properties=feature.properties,userValue=invokeFunction(!0,userLabelStyles.showAs,feature,geoMap);!function(label){label.insideRect(labelBoundary)&&!labelArray.some(function(visibleLabel){return label.overlapsWith(visibleLabel)})&&labelArray.push(label)}(new Label(pick(properties[userValue],userValue,properties.name),new LatLong(properties.longitude,properties.latitude),geoLabelStyles,geoMap))})),this.render()},GeoLabels.prototype.render=function(update){this.geoMap;this.geoMap.geo.isCanvasMode?this.renderCanvasLabel(update):this.renderSvgLabel(update)},GeoLabels.prototype.renderCanvasLabel=function(){var labelLayer=this.geoMap.geo.geoLabelLayer,shadowCache={};this.labels.forEach(function(label){var fontStyle,fontWeight,fontSize,fontFamily,styles=label.styles,fillColor=pick(label.fontColor,styles.fontColor),textStroke=styles.strokeColor||getContrastColor(fillColor),coordinates=label.getXY();if(defined(coordinates.x)&&defined(coordinates.y)){if(labelLayer.save(),styles.textShadow&&!defined(shadowCache[label.type])&&(shadowCache[label.type]=_canvasDatalabelUtils.parseTextShadow(styles.textShadow)),shadowCache[label.type]){var textShadow=shadowCache[label.type];defined(textShadow)&&(labelLayer.shadowOffsetX=textShadow[0],labelLayer.shadowOffsetY=textShadow[1],labelLayer.shadowBlur=textShadow[2],labelLayer.shadowColor=textShadow[3])}labelLayer.textAlign="center",labelLayer.textBaseline="middle",labelLayer.fillStyle=fillColor,labelLayer.strokeStyle=textStroke,labelLayer.font=(fontStyle=styles.fontStyle,fontWeight=styles.fontWeight,fontSize=styles.fontSize,fontFamily=styles.fontFamily,fontStyle+" "+fontWeight+" "+fontSize+"px "+fontFamily),styles.strokeWidth>0&&(labelLayer.lineWidth=styles.strokeWidth,labelLayer.strokeText(label.text,coordinates.x,coordinates.y)),labelLayer.fillText(label.text,coordinates.x,coordinates.y),labelLayer.restore()}})},GeoLabels.prototype.renderSvgLabel=function(){var labelLayer=this.geoMap.geo.geoLabelLayer;this.labelElements=createElement("text",".geo-labels",this.labels,labelLayer).each(function(label){var labelElement=d3.select(this),coordinates=label.getXY(),styles=label.styles,fillColor=pick(label.fontColor,styles.fontColor),textStroke=styles.strokeColor||getContrastColor(fillColor);defined(coordinates.x)&&defined(coordinates.y)&&(labelElement.attrs({"font-family":styles.fontFamily,"font-size":styles.fontSize,"font-style":styles.fontStyle,"font-weight":styles.fontWeight,"text-anchor":"middle","dominant-baseline":"middle",transform:"translate("+coordinates.x+","+coordinates.y+")"}),styles.textShadow&&labelElement.style("text-shadow",styles.textShadow),styles.strokeWidth>0&&createElement("tspan",".stroke-text",[1],labelElement).text(label.text).attrs({stroke:textStroke,"stroke-width":styles.strokeWidth,x:0,y:0}),createElement("tspan",".fill-text",[1],labelElement).text(label.text).attrs({fill:fillColor,x:0,y:0}))})},GeoLabels.prototype.update=function(){this.geoMap;this.labels.forEach(function(label){label.clearCache()}),this.initialize(!0)},MapDataProcessor.prototype.initialize=function(){var flattenPoints,dataProcessor=this,geoMap=dataProcessor.geoMap,geoConfig=geoMap.geo,dataSet=geoMap.dataset,allSeries=geoMap.seriesdata,userMapConfig=geoMap.systemConf.map,excludeAreas=d3$1.set(userMapConfig.excludeAreas||[]),includeAreas=d3$1.set(userMapConfig.includeAreas||[]),mapFeatures=dataProcessor.mapFeatures=geoConfig.defaultLayer.layerGeojson.features,joinBy=dataProcessor.joinByKey=dataSet.getMapByKey(),hasLatLongJoinBy=dataProcessor.hasLatLongJoinBy=dataSet.latLongJoinByKeys.has(joinBy),hashBy=hasLatLongJoinBy?"zc-key":joinBy,mapFeaturesHashed=dataProcessor.mapFeaturesHashed=MapDataProcessor.helpers.hashFeaturesByProperty(mapFeatures,hashBy,includeAreas,excludeAreas,!0),userDataHashed=dataProcessor.userDataHashed=d3$1.map(),userUnmatchedMapFeatures=dataProcessor.userUnmatchedMapFeatures=d3$1.map(),userMapFeatures=dataProcessor.userMapFeatures=d3$1.map(),userUnmatchedData=dataProcessor.userUnmatchedData=d3$1.set();dataProcessor.totalDataCount=0,dataProcessor.extents=d3$1.map(),dataProcessor.hasPointChart=!1,dataProcessor.isCombinationalChart=d3_set(),dataProcessor.flattenPoints=flattenPoints=d3_map(),dataProcessor.hasHeatmap=dataProcessor.hasBubblePie=dataProcessor.hasPointChart=!1,geoMap.isGeoMap=!0,geoMap.hasColorScale=colorscale_helpers.isQuantileColorScale(geoMap),dataProcessor.hasZaxis=defined(dataSet.zidx)&&chartcategory.zaxis.some(function(type){return dataProcessor.containsChartType(type)});var zExtremes=[];each(allSeries,function(series,i){MapDataProcessor.helpers.convertTo3DArray(series);var chartType=geoMap.chartTypes[i];dataProcessor.isCombinationalChart.add(chartType.name),series.disabled||(dataProcessor.hasHeatmap||charttype.geoheatmap!==chartType.value||(dataProcessor.hasHeatmap=dataProcessor.containsChartType("geoheatmap")),dataProcessor.hasBubblePie||charttype.geobubblepie!==chartType.value||(dataProcessor.hasBubblePie=!0),dataProcessor.isBubbleEnabled=dataProcessor.isBubbleEnabled||isBubbleChartType(chartType.value),dataProcessor.hasPointChart||charttype.geoheatmap===chartType.value||(dataProcessor.hasPointChart=!0),each(series.data,function(subSeriesPoints,j){each(subSeriesPoints,function(point,k){!function(point,seriesIndex,subSeriesIndex,itemIndex){var userJoinBy=dataSet.getGeo(point),chartName=geoMap.chartTypes[seriesIndex].name,flattenArray=flattenPoints.get(chartName);point.seriesIndex=seriesIndex,point.subSeriesIndex=subSeriesIndex,point.itemIndex=itemIndex,defined(flattenArray)||(flattenArray=[],flattenPoints.set(chartName,flattenArray)),flattenArray.push(point),hasLatLongJoinBy&&!dataProcessor.isValidPoint(point)||(mapFeaturesHashed.has(userJoinBy)?(userMapFeatures.set(userJoinBy,mapFeaturesHashed.get(userJoinBy)),userDataHashed.has(userJoinBy)?userDataHashed.get(userJoinBy).push(point):userDataHashed.set(userJoinBy,[point]),dataProcessor.totalDataCount++):hasLatLongJoinBy?dataProcessor.totalDataCount++:userUnmatchedData.add(userJoinBy))}(point,i,j,k)}),dataProcessor.hasZaxis&&zExtremes.push(d3_extent(subSeriesPoints,function(point){return dataSet.getZ(point)}))}))}),flattenPoints.each(function(points,chartType){flattenPoints.set(chartType,points.filter(function(point){if(dataProcessor.isValidPoint(point))return point}))}),dataProcessor.hasZaxis&&dataProcessor.extents.set("z",d3_extent(d3_merge(zExtremes))),hasLatLongJoinBy?dataProcessor.userUnmatchedMapFeatures=mapFeaturesHashed:mapFeaturesHashed.keys().forEach(function(key){userMapFeatures.has(key)||excludeAreas.has(key)||userUnmatchedMapFeatures.set(key,mapFeaturesHashed.get(key))}),dataProcessor.hasBubblePie&&(dataProcessor.data=geoMap.systemConf,dataProcessor.chartObj=geoMap,dataProcessor.dataset=dataSet,dataProcessor.processedseriesData=geoMap.seriesdata,dataProcessor.bubblepieData=dataProcessor.processBubblePieData(charttype.geobubblepie)),dataProcessor.isCombinationalChart=dataProcessor.isCombinationalChart.values().length>1,dataProcessor.userMapFeaturesArray=userMapFeatures.values(),dataProcessor.totalnoofdatas=dataProcessor.totalDataCount},MapDataProcessor.prototype.getFeatureMesh=function(features){var tempSet=d3$1.set(),baseTopojsonLayer=this.geoMap.geo.defaultLayer.layerOriginal,mesh=null,layerName=this.geoMap.systemConf.map.layerName,joinByKey=this.hasLatLongJoinBy?"zc-key":this.joinByKey;return"Topology"===baseTopojsonLayer.type&&(features.forEach(function(feature){feature.properties&&feature.properties[joinByKey]&&tempSet.add(feature.properties[joinByKey])}),mesh=topojson.mesh(baseTopojsonLayer,baseTopojsonLayer.objects[layerName],function(a,b){return tempSet.has(a.properties[joinByKey])})),mesh},MapDataProcessor.prototype.getAxisRotated=function(){return!1},MapDataProcessor.prototype.containsChartType=function(chartName){return this.geoMap.chartTypes.some(function(chartType){return chartType.name===chartName||chartType.value===chartName})},MapDataProcessor.prototype.getXYPoint=function(point){var geoMap=this.geoMap,dataSet=geoMap.dataset,utils=geoMap.geo.utils,userMapFeatures=this.userMapFeatures,key=dataSet.getGeo(point),xy=[null,null];if(userMapFeatures.has(key)){var feature=userMapFeatures.get(key),properties=feature.properties;xy=properties.latitude&&properties.longitude?GeoUtils.toXY(geoMap,+properties.longitude,+properties.latitude):utils.geoPath.centroid(feature)}else if(this.hasLatLongJoinBy){var lat=dataSet.getLatitude(key),long=dataSet.getLongitude(key);xy=GeoUtils.toXY(geoMap,long,lat)}return new GeoPoint(xy[0],xy[1])},MapDataProcessor.prototype.getXYvalue=function(axisRotated,stacked,xScale,yScale,yAxisColumnOrder,point,type){return"z"===type?this.getZFromPoint(point):this.getXYPoint(point)[type]},MapDataProcessor.prototype.getZFromPoint=function(point){return this.geoMap.zscale(this.geoMap.dataset.getZ(point)||this.geoMap.zscale.domain()[0])},MapDataProcessor.prototype.getXYFromLatLng=function(latLong){var xy=GeoUtils.toXY(this.geoMap,latLong.longitude,latLong.latitude);return new GeoPoint(xy[0],xy[1])},MapDataProcessor.prototype.getUserMapFeatures=function(type){return"geojson"===type?MapDataProcessor.helpers.arrayToGeojson(this.userMapFeaturesArray):"array"===type?this.userMapFeaturesArray:this.userMapFeatures},MapDataProcessor.prototype.getMapFeaturesByDataPoint=function(dataPoints,type){var dataProcessor=this,dataSet=dataProcessor.geoMap.dataset,map=d3$1.map();return dataPoints[0]instanceof Array||(dataPoints=[dataPoints]),dataPoints.forEach(function(point){var key=point[dataSet.geoidx];dataProcessor.userMapFeatures.has(key)&&map.set(key,dataProcessor.userMapFeatures.get(key))}),"geojson"===type?MapDataProcessor.helpers.arrayToGeojson(map.values()):"array"===type?map.values():map},MapDataProcessor.prototype.getMapFeatures=function(type){var dataProcessor=this,features=d3$1.map(dataProcessor.userMapFeatures);return dataProcessor.userUnmatchedMapFeatures.keys().forEach(function(key){features.set(key,dataProcessor.userUnmatchedMapFeatures.get(key))}),"geojson"===type?MapDataProcessor.helpers.arrayToGeojson(features.values()):features},MapDataProcessor.prototype.getMinMaxZ=function(){return this.extents.get("z")},MapDataProcessor.prototype.isstacked=function(){return!1},MapDataProcessor.prototype.containsNegativeData=function(index){return!1},MapDataProcessor.prototype.getScaleProxy=function(){var processor=this;processor.geoMap;return{xScale:function(point){return processor.getXYPoint(point).x},yScale:function(point){return processor.getXYPoint(point).y}}},MapDataProcessor.prototype.isValidLatLong=function(lat,long){return numberIsBetween(lat,[-90,90])&&numberIsBetween(long,[-180,180])},MapDataProcessor.prototype.isValidPoint=function(point){var geoIndex=this.geoMap.dataset.getGeo(point);if(!point.length||!defined(geoIndex)||!geoIndex.length)return!1;if(this.hasLatLongJoinBy){var lat=this.geoMap.dataset.getLatitude(geoIndex),long=this.geoMap.dataset.getLongitude(geoIndex);return defined(lat)&&defined(long)&&this.isValidLatLong(lat,long)}return this.userDataHashed.has(geoIndex)},MapDataProcessor.prototype.updateSeriesdatabyCategories=function(points){var processor=this,ii=0;return points.filter(function(point){var isValidPoint=processor.isValidPoint(point);return isValidPoint&&(point.itemIndex=ii++),isValidPoint})},MapDataProcessor.prototype.processBubblePieData=_bubblePieProcessor,MapDataProcessor.helpers={is3D:function(data){return isArray(data)&&isArray(data[0])&&isArray(data[0][0])},convertTo3DArray:function(series){this.is3D(series.data)||(series.data=[series.data])},arrayToGeojson:function(features){return{type:"FeatureCollection",features:features}},hashFeaturesByProperty:function(object,property,includeAreas,excludeAreas,copy){var hash=d3_map();return each(object,function(feature,i){var key=feature.properties[property]||i;!includeAreas.empty()&&!includeAreas.has(key)||!excludeAreas.empty()&&excludeAreas.has(key)||hash.set(key,copy?Object.create(feature):feature)}),hash}},MapDataSet.prototype.initialize=function(){var geoMapByKey,metaData=this.geoMap.userdata.metadata,columns=this.columns=pick(metaData.columns,{}),axes=this.axes=pick(metaData.axes,{geo:[0],clr:[1],z:[1]}),colorColumn=pick(columns[axes.clr],{}),geoColumn=pick(columns[axes.geo],{}),zColumn=pick(columns[axes.z],{});this.latLongJoinByKeys=d3_set(["lat-long","long-lat"]),this.clridx=pick(colorColumn.dataindex),this.zidx=pick(zColumn.dataindex),this.geoidx=pick(geoColumn.dataindex,0),this.geoMapByKey=geoMapByKey=this.getJoinByKey(geoColumn),axes.label&&columns[axes.label]&&(this.labelIndex=columns[axes.label].dataindex),this.latLongJoinByKeys.has(this.geoMapByKey)&&("lat-long"===geoMapByKey?(this.latitudeIndex=0,this.longitudeIndex=1):(this.latitudeIndex=1,this.longitudeIndex=0))},MapDataSet.prototype.getJoinByKey=function(column){var geoColumn=pick(column,this.columns[this.axes.geo],{}),joinBy=pick(geoColumn.joinBy,"zc-key");"zc-key"===joinBy||this.latLongJoinByKeys.has(joinBy)||(defined(this.geoMap.geo.defaultLayer.layerGeojson.features[0].properties[joinBy])||(joinBy="zc-key"));return joinBy},MapDataSet.prototype.getColumnIdx=function(type){return isArray(this.axes[type])?this.axes[type][0]:null},MapDataSet.prototype.getDataType=function(type){var columnIndex=this.getColumnIdx(type);return defined(this.columns[columnIndex])?this.columns[columnIndex].datatype:ORDINAL_DATATYPE},MapDataSet.prototype.getZ=function(point){return point[this.zidx]},MapDataSet.prototype.getClr=function(point){return point[this.clridx]},MapDataSet.prototype.getGeo=function(point){return point[this.geoidx]},MapDataSet.prototype.getLatitude=function(point){return point[this.latitudeIndex]},MapDataSet.prototype.getLongitude=function(point){return point[this.longitudeIndex]},MapDataSet.prototype.getMapByKey=function(){return this.geoMapByKey},MapDataSet.prototype.getColumn=function(type){return this.columns[this.getColumnIdx(type)]},MapDataSet.prototype.getX=MapDataSet.prototype.getY=MapDataSet.prototype.getGeo,MapDataSet.prototype.getDataPointValue=function(chartObj,dataPoint,colidx,seriespos,percent,type,subseriespos,toDecode,subseriesLength){colidx&&(colidx=+colidx),isUndefined(toDecode)&&(toDecode=!/(tooltip|legend)/.test(type));var axes=this.axes,colInfo=this.columns[colidx]||{},datatype=colInfo.datatype,dataindex=colInfo.dataindex,format=colInfo[datatype];if(null!=dataPoint){if(null==axes.clr&&"legend"!==type||colidx!=axes.clr){var value,formatFn=percent?getFormattedValueByPercent:getFormattedValue;if(subseriesLength){for(var cumval=0,j=0;j<subseriesLength;j++)cumval+=this.getDataPointUnformattedValue(datatype,seriespos,j,colidx,dataPoint,type,percent,dataindex);value=cumval}else value=this.getDataPointUnformattedValue(datatype,seriespos,subseriespos,colidx,dataPoint,type,percent,dataindex);return""===value&&percent?value:formatFn(format,value,datatype,chartObj,type,toDecode)}return defined(this.clridx)&&colorscale_helpers.isQuantileColorScale(chartObj)?"legend"===type?getFormattedValue(format,dataPoint,datatype,chartObj,type,toDecode,"-"):getFormattedValue(format,this.getClr(dataPoint),datatype,chartObj,type,toDecode):getFormattedValue(format,this.geoMap.seriesdata[seriespos].seriesname,datatype,chartObj,type,toDecode)}return null},MapDataSet.prototype.getDataPointUnformattedValue=function(dataType,seriesIndex,subSeriesIndex,columnIndex,dataPoint,type,percent,dataIndex){var total,geoMap=this.geoMap;if(percent&&(dataType===NUMERIC_DATATYPE&&defined(total=getTotal(geoMap,seriesIndex,subSeriesIndex,columnIndex,dataPoint,percent,type))))return pick((type===STACKLABELS_LABELTYPE?dataPoint:dataPoint[dataIndex])/total*100,0);return type===STACKLABELS_LABELTYPE?dataPoint:dataPoint[dataIndex]},MapDataSet.prototype.getDataPoint=function(geoMap,columnIndex,seriesIndex,subSeriesIndex,itemIndex,point){if(defined(point))return point;var series=geoMap.seriesdata[seriesIndex].data,seriesAfterUpdate=geoMap.renderer[seriesIndex].seriesdataAfterUpdate;return seriesAfterUpdate?seriesAfterUpdate[subSeriesIndex][itemIndex]:series[subSeriesIndex][itemIndex]},MapDataSet.prototype.getCustomizedVal=function(chartObj,colidx,seriespos,subseriespos,itempos,d,type,color,toDecode,subseriesLength){var dataSet=this;return isUndefined(toDecode)&&(toDecode=!/(tooltip|legend)/.test(type)),colidx.toString().replace(CUSTOM_VALUE_PATTERN,function(){var dataPoint,matchedString=arguments[0],valIndex=arguments[1],colIndex=arguments[2],perIndex=arguments[3],splitPerIndex=arguments[4],maxPerIndex=arguments[5],geoProperty=arguments[6],idx=valIndex||colIndex||perIndex||splitPerIndex||maxPerIndex;if(-1!==matchedString.indexOf("{{clr}}"))return color;if(null!=dataSet.columns[idx]){if(null==(dataPoint=type===STACKLABELS_LABELTYPE?d:dataSet.getDataPoint(chartObj,idx,seriespos,subseriespos,itempos,d)))return"";var operation=matchedString.match(/[a-z]+/gi)[0];switch(operation){case"col":return dataSet.getColumnName(colIndex,toDecode);case"val":return dataSet.getDataPointValue(chartObj,dataPoint,valIndex,seriespos,!1,type,subseriespos,toDecode,subseriesLength);case PER_SHOWAS:case"splitper":case MAXPER_SHOWAS:return dataSet.getDataPointValue(chartObj,dataPoint,perIndex||splitPerIndex||maxPerIndex,seriespos,operation,type,subseriespos,toDecode,subseriesLength)}}else{if(!geoProperty)return matchedString;dataPoint=dataSet.getDataPoint(chartObj,idx,seriespos,subseriespos,itempos,d);var feature=chartObj.dataObject.getMapFeaturesByDataPoint(dataPoint,"array");if(feature.length)return feature[0].properties[geoProperty]||matchedString}})},MapDataSet.prototype.getColumnName=function(colidx,toDecode){return toDecode?encodeHTML(this.columns[colidx].columnname):decodeHTML(this.columns[colidx].columnname)},MapDataSet.prototype.getMetaInfoObj=function(chartObj,data,seriesIndex){var axes=this.axes,columns=this.columns,seriesdata=this.geoMap.seriesdata,dataWithMetadata=[],getColObj=function(columnIndex,value){var obj=simpleClone(columns[columnIndex]||{});return obj.value=value,obj.columnindex=columnIndex,obj};if(isArray(data)&&data.forEach(function(d,i){var columnIndex=columns.indexOf(columns.filter(function(c,j){return c.dataindex===i})[0]);dataWithMetadata.push(getColObj(columnIndex,d))}),defined(axes.clr)){var clrColIdx=isArray(axes.clr)?axes.clr[0]:axes.clr;dataWithMetadata.push(getColObj(clrColIdx,seriesdata[seriesIndex].seriesname))}return dataWithMetadata},GeoPlotRenderer.prototype.initialize=function(){var geoMap=this.geoMap,mode=geoMap.systemConf.chart.plot.renderer.mode.toLowerCase();each(geoMap.chartTypes,function(chartType){"canvas"===mode&&arrayIncludes(chartcategory.svgOnly,chartType.value)&&(mode="svg",Console.warn("Fallback: "+chartType.name+" was rendered on svg mode"))}),geoMap.renderer=[],geoMap.rendererConf=[],this.mode=mode,this.MODE=mode.toUpperCase(),geoMap.extraParams={labelQueue:[],notesArray:[],labelArray:[],barDatasetIndex:0}},GeoPlotRenderer.prototype.draw=function(){var geoMap=this.geoMap,systemConfig=geoMap.systemConf;geoMap.chartRendered=!1,stateChangeListener(geoMap,systemConfig.chart.plot.events,0,"init"),geoMap.setupZScale(),this.renderSeries(),this.transformWrap(),renderer_helpers.renderCompletedEvents(geoMap,geoMap.updating,geoMap.extraParams,function(){geoMap.updating?geoMap.chartRendered=!0:(geoMap.animate(),geoMap.updating=!1)})},GeoPlotRenderer.prototype.update=function(){this.draw()},GeoPlotRenderer.prototype.renderSeries=function(){var chartSeries,geoMap=this.geoMap,allChartSeries=(geoMap.systemConf,renderer_helpers.arrangeSeriesRenderingOrder(geoMap)||[]),scaleProxy=d3_scaleLinear();geoMap.rendererArranged=[],each(allChartSeries,function(series,index){var seriesIndex=pick(series.seriesidx,index),chartType=geoMap.chartTypes[seriesIndex];isUndefined(geoMap.bubblePieRendererIndex)&&chartType.value===charttype.geobubblepie&&(geoMap.bubblePieRendererIndex=seriesIndex),!defined(chartSeries=geoMap.renderer[seriesIndex])&&GeoMap.SeriesTypes.has(chartType.name)&&(chartSeries=new(GeoMap.SeriesTypes.get(chartType.name))(series,geoMap,seriesIndex),geoMap.renderer[seriesIndex]=chartSeries,geoMap.rendererConf[seriesIndex]=new plot.rendererConf),"geoheatmap"===chartType.name&&renderer_helpers.setRendererProp(geoMap,chartSeries,series,seriesIndex,0,geoMap.extraParams),geoMap.rendererArranged.push(chartSeries),scaleProxy.origRange=[0,0],geoMap.rendererConf[seriesIndex].xscale(scaleProxy).yscale(scaleProxy).datasetIndex(seriesIndex),clearTimeout(chartSeries.renderedTimer),chartSeries.render(geoMap.updating)}),geoMap.rendererArrangedReveresd=geoMap.rendererArranged.slice(0).reverse()},GeoPlotRenderer.prototype.triggerChartRendering=function(mapSeries){var geoMap=this.geoMap,series=mapSeries.series,seriesIndex=mapSeries.index,chartName=geoMap.chartTypes[seriesIndex].name;defined(mapSeries.chartRenderer)||(mapSeries.chartRenderer="CANVAS"===this.MODE?plot.canvasRenderer.createCanvasRenderer(chartName):plot.svgRenderer.createSVGRenderer(chartName)),geoMap.container.select(".highlight-canvas").style("visibility","hidden"),mapSeries.commonRendererProp=mapSeries.chartRenderer.commonRendererProp,renderer_helpers.setRendererProp(geoMap,mapSeries.chartRenderer,series,seriesIndex,0,geoMap.extraParams),mapSeries.hasOwnProperty("chartRendered")||Object.defineProperty(mapSeries,"chartRendered",{get:function(){return mapSeries.chartRenderer.chartRendered}}),this["render"+this.MODE](mapSeries),mapSeries.hasOwnProperty("seriesdataAfterUpdate")||Object.defineProperty(mapSeries,"seriesdataAfterUpdate",{get:function(){return pick(mapSeries.chartRenderer.seriesdataAfterUpdate)}})},GeoPlotRenderer.prototype.renderSVG=function(mapSeries){var geoMap=this.geoMap,series=mapSeries.series;plot.svgRenderer.drawSVG(geoMap,series,mapSeries.chartRenderer)},GeoPlotRenderer.prototype.renderCANVAS=function(mapSeries){var geoMap=this.geoMap,series=mapSeries.series;plot.canvasRenderer.drawCanvas(geoMap,series,mapSeries.chartRenderer)},GeoPlotRenderer.prototype.transformWrap=function(){var geoMap=this.geoMap,plotArea=geoMap.plotarea;geoMap.staticPaneSVG.select(".labelholder").attr("transform","translate("+plotArea.left+","+plotArea.top+")")};var mapCollections={};function GeoMap(container,data){this.axes={x:{},y:{}},VizLayout.call(this,container,data),this.initialize()}function MapEvents(geoMap){this.geoMap=geoMap,this.initialize()}function MapSeries(series,geoMap,index){this.series=series,this.geoMap=geoMap,this.index=index,this.initialize()}function GeoHeatMapSeries(series,geoMap,index){this.renderingMode=geoMap.systemConf.map.renderingMode,MapSeries.call(this,series,geoMap,index)}function GeoScatterSeries(series,geoMap,index){MapSeries.call(this,series,geoMap,index)}function GeoBubbleSeries(series,geoMap,index){GeoScatterSeries.call(this,series,geoMap,index)}function GeoBubblePieSeries(series,geoMap,index){GeoBubbleSeries.call(this,series,geoMap,index)}inherit(GeoMap,VizLayout),GeoMap.helpers=VizLayout.helpers,GeoMap.SeriesTypes=d3$1.map(),GeoMap.getDefaultProjection=function(){return{name:"geoMercator"}},GeoMap.getGeoJSON=function(layers,layerName){if(defined(layers)&&MapLayer.GEO_FORMATS.has(layers.type)&&"Topology"===layers.type){var projectionSettings=layers.projection;layers=topojson.feature(layers,layers.objects[layerName]),defined(projectionSettings)&&(layers.projection=projectionSettings)}return layers},GeoMap.prototype.initialize=function(){this.userdata.map;var hasSvgOnly=this.chartTypes.some(function(chartType){return arrayIncludes(chartcategory.svgOnly,chartType.value)});this.id="ZC_GEO_"+this.idNumeric,$Browser.IE&&parseFloat($Browser.VERSION)<11&&(this.fixIE=!0),this.geo={layerCount:0,extraLayers:{},extraLayersRenderingOrder:["graticule","globe","allAreas","backgroundLayer"],utils:{},highlightUtils:{},rawLayers:[]},this.processUserData(this.themeoptions),this.plot={},this.geo.isCanvasMode="svg"!==this.systemConf.map.renderingMode.toLowerCase(),this.geo.isPlotCanvasMode="svg"!==this.systemConf.chart.plot.renderer.mode.toLowerCase()&&!hasSvgOnly,GeoMap.helpers.constructChartGroups(this),this.seriesContainer=this.wrap.select(".seriesholder"),this.chartGroup=this.svg.select(".chartgroup"),this.legendHighlight=legendHighlight(this,this.wrap),this.render()},GeoMap.prototype.render=function(){var systemConfig=this.systemConf,animate=systemConfig.map.animation.enabled&&!this.updating;if(animate=animate&&(this.dataObject.hasHeatmap&&!this.dataObject.hasPointChart||!this.seriesdata.length),this.setChartDimension(),this.updateCanvasArea(),this.applyChartProperties(),!this.hasGeoLayer||!systemConfig.map.allAreas&&!this.dataObject.totalDataCount)return this.clearMap(),this.hideLoading(this.container),this.handleNoData(systemConfig.noDataHandler),this.chartRendered=!0,void stateChangeListener(this,systemConfig.canvas.events,0,this.updating?"onreload":"onload");this.dataObject.totalDataCount||(this.clearMap(),this.clearChart(null,null,!0)),this.getChartSeriesColor(),this.hasSeriesPoints&&(legend.render(this),tooltip_block_helpers.updatePlotarea4BlockTooltip(this)),annotation&&annotation.addBlockAnnotations(this),this.updatePlotareaProp(),this.setupFeatureContainerLayer(),this.setUpMapLayer(),animate&&(this.animateSelection=this.container.selectAll(".geomap-features,.xychart,.static,.label-container,.labelholder").style("opacity",0)),stateChangeListener(this,systemConfig.map.events,0,"init"),this.renderGlobe(),this.renderGraticule(),this.renderMapLayer(),stateChangeListener(this,systemConfig.map.events,0,this.updating?"onreload":"onload"),this.plot.renderer?this.plot.renderer.draw(!0):this.hasSeriesPoints&&(this.plot={renderer:new GeoPlotRenderer(this)},this.plot.renderer.draw()),this.drawPlotareaClippath(),this.drawPlotBorder(),this.renderLabels(),this.handleEvent(),this.plot.renderer||(this.animate(),stateChangeListener(this,systemConfig.canvas.events,0,this.updating?"onreload":"onload"),this.updating=!1)},GeoMap.prototype.setupFeatureContainerLayer=function(){var geoConfig=this.geo,isGeoCanvasMode=(toCapitalize(geoConfig.isCanvasMode?"canvas":"svg"),geoConfig.isCanvasMode),isPlotCanvasMode=geoConfig.isPlotCanvasMode,mapArea=geoConfig.mapArea=Object.create(this.plotarea);this.seriesContainer.attr("transform","translate("+mapArea.left+","+mapArea.top+")"),isGeoCanvasMode?geoConfig.geoLabelLayer=geoConfig.featureLayer=geoConfig.featureLayer=plot.canvasRenderer.updateCanvasContext(this,"geomap-features",".static",this.chartParentElement):(geoConfig.featureLayer=createElement("g",".feature-layer",[1],this.seriesContainer),geoConfig.geoLabelLayer=createElement("g",".geo-label-layer",[1],this.seriesContainer)),isPlotCanvasMode?(geoConfig.pointLabelLayer=this.labelHolderContext=plot.canvasRenderer.updateCanvasContext(this,"label-container",this.fixIE?".static":"div.legendarea",this.chartParentElement),geoConfig.pointLayer=plot.canvasRenderer.updateCanvasContext(this,"zc-canvas",".static",this.chartParentElement)):geoConfig.labelLayer=this.staticPaneSVG.select(".labelholder").attr("transform","translate("+mapArea.left+","+mapArea.top+")")},GeoMap.prototype.setupLayerSettings=function(layer){var projection,geoConfig=this.geo,mapArea=geoConfig.mapArea,defaultLayer=geoConfig.defaultLayer.layerGeojson,userConfig=this.systemConf.map,projectionSettings=pick(userConfig.projection,layer.projection,defaultLayer.projection),extent=userConfig.extent,width=mapArea.width-extent.right,height=mapArea.height-extent.bottom,fitExtent=[[extent.left,extent.top],[width,height]],geojsonLayer=layer;for(var prop in defined(projectionSettings)||(projectionSettings=GeoMap.getDefaultProjection()),projection=geoConfig.utils.projection=geoConfig.highlightUtils.projection=d3$1[projectionSettings.name](),projectionSettings)projectionSettings.hasOwnProperty(prop)&&"name"!==prop&&projection[prop]&&projection[prop](projectionSettings[prop]);projection.fitExtent(fitExtent,geojsonLayer),geoConfig.utils.geoPath=d3$1.geoPath().projection(geoConfig.utils.projection),geoConfig.highlightUtils.geoPath=d3$1.geoPath().projection(geoConfig.utils.projection),geoConfig.isCanvasMode&&geoConfig.utils.geoPath.context(geoConfig.featureLayer)},GeoMap.prototype.addLayer=function(layer,styles,name,type,useMesh){var geoConfig=this.geo,layerId=geoConfig.layerCount++,layerContainer={feature:geoConfig.featureLayer,highlight:geoConfig.highlightLayer}[type];return name=name||"map-layer-"+layerId,geoConfig.isCanvasMode||(layerContainer=createElement("g","."+name,[name],geoConfig.featureLayer)),new MapLayer(layer,geoConfig.utils,layerContainer,styles,this,useMesh)},GeoMap.prototype.setupSvgLayer=function(styles){var geoConfig=this.geo,mapArea=geoConfig.mapArea;this.systemConf.map;geoConfig.featureLayer=createElement("g",".feature-layer",[1],this.seriesContainer),this.seriesContainer.attr("transform","translate("+mapArea.left+","+mapArea.top+")"),geoConfig.labelLayer=this.staticPaneSVG.select(".labelholder").attr("transform","translate("+mapArea.left+","+mapArea.top+")"),"canvas"===this.systemConf.chart.plot.renderer.mode&&(this.labelHolderContext=plot.canvasRenderer.updateCanvasContext(this,"label-container",this.fixIE?".static":"div.legendarea",this.chartParentElement),geoConfig.pointLayer=plot.canvasRenderer.updateCanvasContext(this,"zc-canvas",".static",this.chartParentElement))},GeoMap.prototype.setupCanvasLayer=function(){var geoConfig=this.geo;geoConfig.featureLayer=plot.canvasRenderer.updateCanvasContext(this,"geomap-features",".static",this.chartParentElement),this.dataObject.hasPointChart&&(geoConfig.pointLayer=plot.canvasRenderer.updateCanvasContext(this,"zc-canvas",".static",this.chartParentElement)),geoConfig.labelLayer=this.labelHolderContext=plot.canvasRenderer.updateCanvasContext(this,"label-container",this.fixIE?".static":"div.legendarea",this.chartParentElement)},GeoMap.prototype.getLayerData=function(scopeName){var mapCollection=mapCollections;if(defined(mapCollection[scopeName]))return this.emptyMapLayer=!1,mapCollection[scopeName];this.emptyMapLayer=!0},GeoMap.prototype.setUpMapLayer=function(){var backgroundLayerData,systemConfig=this.systemConf,dataProcessor=this.dataObject;backgroundLayerData=systemConfig.map.allAreas?dataProcessor.getMapFeatures("geojson"):dataProcessor.getUserMapFeatures("geojson"),this.setupLayerSettings(backgroundLayerData)},GeoMap.prototype.setupZScale=function(){var dataProcessor=this.dataObject;dataProcessor.hasZaxis&&(this.zscale=scale$1.getScale(this,dataProcessor,this.plotarea,null,null,this.dataset,"z"))},GeoMap.prototype.renderGraticule=function(){var graticuleConfig=this.systemConf.map.graticule||{},graticuleEnabled=!0===graticuleConfig.show,extraLayers=this.geo.extraLayers;if(graticuleEnabled)if(this.updating&&extraLayers.graticule)extraLayers.graticule.update();else{var graticule=d3$1.geoGraticule();extraLayers.graticule=this.addLayer(graticule(),graticuleConfig,"graticule","feature")}else defined(extraLayers.graticule)&&(extraLayers.graticule.destroy(),extraLayers.graticule=null)},GeoMap.prototype.renderGlobe=function(){var mapConfig=this.systemConf.map,enabledGlobe="geoOrthographic"===(mapConfig.projection||{}).name&&!defined(mapConfig.globe.show),extraLayers=this.geo.extraLayers;enabledGlobe||mapConfig.globe.show?this.updating&&extraLayers.globe?extraLayers.globe.update():extraLayers.globe=this.addLayer({type:"Sphere"},mapConfig.globe,"sphere","feature"):defined(extraLayers.globe)&&(extraLayers.globe.destroy(),extraLayers.globe=null)},GeoMap.prototype.renderMapLayer=function(){var systemConfig=this.systemConf,dataProcessor=this.dataObject,userMapConfig=systemConfig.map,remainingAreas=dataProcessor.userUnmatchedMapFeatures.values();if(!dataProcessor.hasHeatmap){var backgroundLayerFeatures=dataProcessor.userMapFeatures.values();backgroundLayerFeatures.length&&(this.geo.extraLayers.backgroundLayer=this.addLayer(backgroundLayerFeatures,userMapConfig,"background-layer","feature",userMapConfig.useMeshOutline))}this.updating&&this.geo.extraLayers.allAreas?this.geo.extraLayers.allAreas.update(remainingAreas):userMapConfig.allAreas&&(dataProcessor.userUnmatchedMapFeatures.empty()||(this.geo.extraLayers.allAreas=this.addLayer(remainingAreas,userMapConfig,"all-areas-layer","feature",userMapConfig.useMeshOutline)))},GeoMap.prototype.renderLabels=function(){this.geo.geoLabels=new GeoLabels(this)},GeoMap.prototype.handleEvent=function(){var geoConfig=this.geo;if(this.updating&&this.eventHandler||!this.dataObject.totalDataCount){if(!this.eventHandler)return!1;this.eventHandler.updateParams(this)}else{this.createEventGroups();var eventHandler=this.eventHandler=events.mouseevents(this,this.tooltip.element,this.systemConf,this.plotarea,this.dataset,null,null,null,null,this.eventWrap,this.seriesColor);eventHandler.initializeListener(),geoConfig.eventLayer=eventHandler.trackerElement.styles({"pointer-events":"visible"})}this.eventHandler.mapEvents.cache=d3_map(),drawBorderBox(this.eventHandler.trackerElement,this.plotarea)},GeoMap.prototype.clearMap=function(){GeoUtils.clearContext(this.geo.featureLayer),GeoUtils.clearContext(this.geo.geoLabelLayer),GeoUtils.clearContext(this.geo.pointLayer),GeoUtils.clearContext(this.geo.pointLabelLayer),defined(this.eventHandler)&&this.eventHandler.mapEvents.clearHighlightedPoints()},GeoMap.prototype.processUserData=function(baseSystemConf){var series,systemConfig=this.systemConf=mergeJSON(baseSystemConf,this.userdata,!0,!0),userMapConfig=systemConfig.map,geoLayerData=this.getLayerData(userMapConfig.scope,userMapConfig.layerName);this.updating||stateChangeListener(this,this.systemConf.canvas.events,0,"init"),series=getPropVal(systemConfig,"seriesdata")||{},this.seriesdata=series.chartdata||[],(this.geo.defaultLayer={layerGeojson:GeoMap.getGeoJSON(geoLayerData,userMapConfig.layerName),layerOriginal:geoLayerData}).layerGeojson?(this.hasGeoLayer=!0,this.dataset=new MapDataSet(this),this.dataObject=new MapDataProcessor(this),this.hasSeriesPoints=this.dataObject.totalDataCount>0,this.nochartdata=!this.hasSeriesPoints&&this.emptyMapLayer):(this.hasGeoLayer=!1,this.nochartdata=!0)},GeoMap.prototype.addRemoveSeries=function(){var geoMap=this;geoMap.eventHandler;geoMap.updating=!0,geoMap.clearMap(),geoMap.dataObject.initialize(),geoMap.updatePlotareaProp(),geoMap.drawPlotareaClippath(),geoMap.geo.extraLayersRenderingOrder.forEach(function(layer){defined(geoMap.geo.extraLayers[layer])&&geoMap.geo.extraLayers[layer].update()}),geoMap.geo.geoLabels.render(!0),geoMap.eventHandler.mapEvents.cache=d3_map(),geoMap.plot.renderer.draw()},GeoMap.prototype.getTransform=function(){return d3$1.zoomTransform(this.geo.eventLayer.node())},GeoMap.prototype.animate=function(){var geoMap=this,animationConf=geoMap.systemConf.map.animation,selection=geoMap.animateSelection;selection&&!geoMap.updating?selection.transition().duration(animationConf.duration).ease(d3_ease(animationConf.easingType)).on("start",function(){selection.style("opacity",0)}).on("end",function(){geoMap.chartRendered=!0}).attrTween("tween",function(){return function(t){return selection.style("opacity",t),t}}):geoMap.chartRendered=!0},maps.GeoMap=GeoMap,MapEvents.fixMouseCoordinates=function(geoMap,coordinates){if(!coordinates)return{x:null,y:null};geoMap.systemConf.map;return{x:coordinates[0]-geoMap.plotarea.left,y:coordinates[1]-geoMap.plotarea.top}},MapEvents.fixEventArguments=function(dataPoint){return{seriesPos:dataPoint.seriesIndex,itemPos:dataPoint.itemIndex,subseriespos:dataPoint.subSeriesIndex,data:dataPoint}},MapEvents.prototype.initialize=function(){var geoMap=this.geoMap,mapConfig=geoMap.geo,utils_map=this.utils=mapConfig.utils;geoMap.systemConf.map;this.eventConfig=pick(geoMap.systemConf.map.events,{}),this.outerGeoBounds=utils_map.geoPath.bounds(mapConfig.defaultLayer.layerGeojson),this.highlightElement=createElement("g",".map-highlight",[1],geoMap.staticPaneSVG,":first-child").attr("transform","translate("+geoMap.plotarea.left+","+geoMap.plotarea.top+")"),this.timers={},this.highlightCache={},this.outLine=this.getOutLine()},MapEvents.prototype.showTooltip=function(position,point,event,pointInfo,isSamePoint){var tooltipPosition,helpers,geoMap=this.geoMap,XY={x:0,y:0},isOrdinal=!0,seriesIndex=pointInfo.point.seriesIndex,chartType=geoMap.chartTypes[seriesIndex].value,plotOptions=geoMap.renderer[seriesIndex].plotOptions;"feature"!==pointInfo.type&&isSamePoint||("point"===pointInfo.type&&(isOrdinal=!1,XY=geoMap.dataObject.getXYPoint(point)),helpers=(tooltipPosition=getTooltipPosition(getEventObject(event),position,XY.x,XY.y,geoMap,point,!1,!1,{},isOrdinal,!1,!1)).helpers,isBubbleChartType(chartType)?tooltipPosition.distance=geoMap.dataObject.getXYvalue(!1,!1,null,null,null,point,"z")/2:"point"===pointInfo.type&&(tooltipPosition.distance=10*(plotOptions.marker.size-1)),helpers.itempos=point.itemIndex,helpers.subseriespos=point.subSeriesIndex,helpers.seriesindex=point.seriesIndex,geoMap.eventHandler.tooltipElement.show(geoMap,tooltipPosition,null,!0,tooltipPosition.helpers))},MapEvents.prototype.hideTooltip=function(immediate){var delay=this.geoMap.systemConf.tooltip.hideDelay,tooltip=this.geoMap.eventHandler.tooltipElement;immediate?tooltip.hide(tooltip.element):(clearTimeout(this.timers.tooltipDelay),this.timers.tooltipDelay=setTimeout(function(){tooltip.hide(tooltip.element)},pick(delay,150)))},MapEvents.prototype.getPoint=function(latLong){var xy,geoMap=this.geoMap,point=null;return latLong instanceof GeoPoint?(xy=latLong.toArray(),latLong=latLong.toLatLong(this.geoMap).toArray()):latLong instanceof LatLong&&(xy=latLong.toXY(geoMap),latLong=latLong.toArray()),this.outLine.some(function(outline){return d3.polygonContains(outline,xy)})&&geoMap.rendererArrangedReveresd.some(function(series){if(!geoMap.eventHandler.helpers.eventDisabled(series.series)&&series.getPoint)return point=series.getPoint(latLong,xy)}),point},MapEvents.prototype.getPointsByIndex=function(seriesIndex,legendFilterIndex){var geoMap=this.geoMap,points=[];if(defined(legendFilterIndex)){var flattenPoints=geoMap.dataObject.flattenPoints.get("geoheatmap");points=legend_helpers.filterSelectionByColor(flattenPoints,!0,legendFilterIndex,geoMap)}else defined(seriesIndex)&&geoMap.seriesdata[seriesIndex].data.forEach(function(subPoint){points=points.concat(subPoint)});return points},MapEvents.prototype.getHighlightEffect=function(seriesIndex,color,type,from){var geoMap=this.geoMap,highlightEffect=geoMap.legendHighlight.getLegendHighlightEffect(seriesIndex,type,from),highlightStyle={fillColor:TRANSPARENT};return highlightEffect!==NONE&&(geoMap.fixIE&&(color="transparent"),highlightStyle={fillColor:geoMap.legendHighlight.getEffect(highlightEffect,"area",color,{fill:TRANSPARENT,stroke:color},0,from).fill,strokeWidth:2}),highlightStyle},MapEvents.prototype.highlightPoints=function(points,type,styles){var geoMap=this.geoMap,scatterWrap=geoMap.eventWrap.selectAll("#zcscatterhighlight"),featureWrap=geoMap.staticPaneSVG.selectAll("g.map-highlight");switch(type){case"feature":scatterWrap.attr("visibility","hidden"),featureWrap.attr("visibility","visible"),this.highlightGeoFeature(points,styles);break;case"point":scatterWrap.attr("visibility","visible"),featureWrap.attr("visibility","hidden"),scatterWrap.selectAll("*").remove(),scatterWrap.attr("visibility","visible");var seriesIndex=points.seriesIndex,subSeriesIndex=points.subSeriesIndex,itemIndex=points.itemIndex,chartType=geoMap.chartTypes[seriesIndex],xy=geoMap.dataObject.getXYPoint(points),plotOptions=geoMap.seriesdata[seriesIndex].plotoptions,commonPlotOptions=geoMap.systemConf.chart.plot.plotoptions[chartType.name],currentWrap=appendEle(scatterWrap,"g",[1],".","class","highlight"+seriesIndex);geoMap.eventHandler.hoverScatter(currentWrap,chartType.value,plotOptions,commonPlotOptions,xy.x,xy.y,null,null,null,geoMap.seriesdata,subSeriesIndex,seriesIndex,itemIndex,!1,null,!1)}},MapEvents.prototype.highlightGeoFeature=function(points,styles){var geoMap=this.geoMap;this.highlightLayer=new MapLayer(points,geoMap.geo.highlightUtils,this.highlightElement,styles,geoMap)},MapEvents.prototype.clearHighlightedPoints=function(){this.geoMap.staticPaneSVG.selectAll("g#zcscatterhighlight, g.map-highlight").attr("visibility","hidden")},MapEvents.prototype.getTransform=function(){return d3.zoomTransform(this.geoMap.geo.eventLayer.node())},MapEvents.prototype.handleEvent=function(coordinates,type,event){coordinates=MapEvents.fixMouseCoordinates(this.geoMap,coordinates),event=event||d3.event;var geoMap=this.geoMap,geoPoint=new GeoPoint(coordinates.x,coordinates.y),point=this.getPoint(geoPoint),tooltipEnabled=!1!==geoMap.systemConf.tooltip.enabled,actualEventType=pick(geoMap.zcEventType,type),oldPoint=geoMap.eventHandler.oldInfo,isSamePoint=!(!oldPoint||oldPoint.point!==(point&&point.point));if("mouseout"===type)point=geoMap.eventHandler.oldInfo;else if(defined(geoMap.eventHandler.oldInfo)&&!defined(point)||("doubletap"===actualEventType||"tap"===actualEventType&&isSamePoint)&&"mouseout"!==type)return geoMap.eventHandler.mouseOut();if(defined(point)){var dataPoint=point.point,seriesIndex=dataPoint.seriesIndex,mapSeries=geoMap.renderer[seriesIndex],customUserCallback=getEventConf(null,mapSeries.plotOptions,geoMap,actualEventType),eventHelpers=geoMap.eventHandler.helpers,immediateMouseOut=!1,actionType=type,defaultEventHash={mousemove:"handleMouseMove",click:"handleMouseClick",mouseout:"handleMouseOut"};$Browser.isTouchDevice&&(immediateMouseOut=!0,"click"===type&&(actionType="mousemove")),defined(customUserCallback)&&eventHelpers.triggerUserCallback(customUserCallback,point,event),eventHelpers.isDefaultAllowed(customUserCallback,event)&&defined(this[defaultEventHash[actionType]])&&this[defaultEventHash[actionType]](point,isSamePoint),"mousemove"===actionType?(tooltipEnabled&&(clearTimeout(this.timers.tooltipDelay),this.showTooltip(coordinates,dataPoint,event,point,isSamePoint)),isSamePoint||(geoMap.eventHandler.addCursor(getEventConf(null,mapSeries.plotOptions,geoMap,"cursor")),geoMap.eventHandler.oldInfo=point,geoMap.eventHandler.oldInfo.nearestPoint=MapEvents.fixEventArguments(dataPoint))):"mouseout"===actionType&&(tooltipEnabled&&this.hideTooltip(immediateMouseOut),geoMap.eventHandler.hideCursor(),geoMap.eventHandler.reverseLegendHighlight.reset(),geoMap.eventHandler.oldInfo=null)}},MapEvents.prototype.getOutLine=function(){var geoMap=this.geoMap,outLinePath=document.createElementNS(d3.namespace("svg").space,"path");return d3.select(outLinePath).datum({type:"Sphere"}).attr("d",geoMap.geo.highlightUtils.geoPath).attr("d").split("M").slice(1).map(function(segment){return(segment=segment.slice(0,segment.length-1)).split("L").map(function(value){return value.trim().split(/[,\s]/).map(function(value1){return parseInt(value1)})})})},MapEvents.prototype.getTreeDiagram=function(points){var geoMap=this.geoMap;return d3.quadtree().x(function(d){return geoMap.dataObject.getXYPoint(d).x}).y(function(d){return geoMap.dataObject.getXYPoint(d).y}).extent([[0,0],[geoMap.plotarea.width,geoMap.plotarea.height]]).addAll(points)},MapEvents.prototype.handleMouseMove=function(pointInfo,isSamePoint){var geoMap=this.geoMap,point=pointInfo.point,seriesIndex=point.seriesIndex;if(!isSamePoint){var fillColor=getRawColor(geoMap,seriesIndex,point),highlightStyle=this.getHighlightEffect(seriesIndex,fillColor,"selectedSeries","plot");"feature"===pointInfo.type&&(point=pointInfo.feature),this.highlightPoints(point,pointInfo.type,highlightStyle)}},MapEvents.prototype.handleMouseOut=function(point){var geoMap=this.geoMap;this.clearHighlightedPoints(),geoMap.eventHandler.hideCursor()},MapEvents.prototype.handleMouseClick=function(point){this.geoMap.eventHandler.mapEvents.hideTooltip(!0)},zmaps.mapEvents=MapEvents,MapSeries.getPlotOptions=function(geoMap,chartName){return getPropVal(geoMap.systemConf,"chart.plot.plotoptions."+chartName)},MapSeries.prototype.initialize=function(){var geoMap=this.geoMap,chart=geoMap.chartTypes[this.index],gradientDimension=gradient_helpers.getDimension(geoMap,this.index);return geoMap.context=pick(geoMap.geo.pointLayer,geoMap.geo.featureLayer),this.isCanvasMode=geoMap.geo.isCanvasMode,this.plotOptions=mergeJSON(MapSeries.getPlotOptions(geoMap,chart.name),pick(this.series.plotoptions,{}),!0),this.fillColor=getFillColor(geoMap,this.index,gradientDimension,null,this.renderingMode),this.strokeColor=getStrokeColor(geoMap,this.index,gradientDimension),this},MapSeries.prototype.update=function(){this.render(!0)},inherit(GeoHeatMapSeries,MapSeries),maps.GeoMap.SeriesTypes.set("geoheatmap",GeoHeatMapSeries),GeoHeatMapSeries.prototype.render=function(reset){var mapSeries=this.initialize(),geoMap=mapSeries.geoMap,mapFeatures=geoMap.dataObject.getUserMapFeatures(),plotOptions=mapSeries.plotOptions,gradient=plotOptions.gradients,defaultMapConfig=geoMap.systemConf.map,gradientEnabled=d3_set(["radial","linear"]).has(gradient.type);mapSeries.features=[],mapSeries.seriesdataAfterUpdate=[],mapSeries.series.disabled||each(mapSeries.series.data,function(points,index){points=geoMap.dataObject.updateSeriesdatabyCategories(d3_values(points)),mapSeries.seriesdataAfterUpdate[index]=points,each(points,function(point,i){var key=mapSeries.geoMap.dataset.getGeo(point);if(mapFeatures.has(key)){var currentMapFeature=mapFeatures.get(key),gradientDimension=null;if(gradientEnabled){var bbox_geo=GeoUtils.getFeatureGradientBBox(currentMapFeature,gradient.type,mapSeries.geoMap.geo.utils.geoPath);gradientDimension=[bbox_geo.width,bbox_geo.height],currentMapFeature.transform={x:bbox_geo.x,y:bbox_geo.y}}currentMapFeature.styles={fillColor:mapSeries.fillColor(mapSeries.index,point,null,null,mapSeries.plotOptions.fillOpacity,gradientDimension),strokeColor:mapSeries.strokeColor(mapSeries.index,point,pick(plotOptions.strokeColor,defaultMapConfig.strokeColor),null,plotOptions.strokeOpacity,i),strokeWidth:plotOptions.strokeWidth,strokeStyle:plotOptions.strokeStyle,fillOpacity:pick(plotOptions.fillOpacity,1),strokeOpacity:pick(plotOptions.strokeOpacity,1)},mapSeries.features.push(currentMapFeature)}})}),reset?mapSeries.mapLayer.update(mapSeries.features):mapSeries.mapLayer=mapSeries.geoMap.addLayer(mapSeries.features,null,"series-"+mapSeries.index,"feature",defaultMapConfig.useMeshOutline),labelRenderer&&geoMap.extraParams.labelQueue.push({renderer:mapSeries,charttype:"scatter",chartObj:geoMap,args:[mapSeries.series,mapSeries.index]}),mapSeries.renderedTimer=setTimeout(function(){mapSeries.chartRendered=!0},17)},GeoHeatMapSeries.prototype.commonRendererProp=function(){return this.geoMap.rendererConf[this.index]},inherit(GeoScatterSeries,MapSeries),maps.GeoMap.SeriesTypes.set("geoscatter",GeoScatterSeries),GeoScatterSeries.prototype.render=function(){this.geoMap.plot.renderer.triggerChartRendering(this)},inherit(GeoBubbleSeries,GeoScatterSeries),maps.GeoMap.SeriesTypes.set("geobubble",GeoBubbleSeries),inherit(GeoBubblePieSeries,GeoBubbleSeries),maps.GeoMap.SeriesTypes.set("geobubblepie",GeoBubblePieSeries),GeoHeatMapSeries.prototype.getPoint=function(latLong){var mapFeatures=this.features,geoMap=this.geoMap,dataObject=geoMap.dataObject,feature=arrayFind(mapFeatures,function(feature){return d3.geoContains(feature,latLong)});if(feature){for(var point,points=dataObject.userDataHashed.get(feature.properties[dataObject.joinByKey]),len=points.length;len--;)if(!geoMap.seriesdata[points[len].seriesIndex].disabled){point=points[len];break}if(!geoMap.hasColorScale||geoMap.hasColorScale&&isWithinColorRange(geoMap.dataset.getClr(point),geoMap))return{type:"feature",feature:feature,point:point}}return null},GeoScatterSeries.prototype.getPoint=function(latLong,XY){var geoMap=this.geoMap,dataObject=(geoMap.plotarea,geoMap.dataObject),chartName=geoMap.chartTypes[this.index].name,flattenPoints=dataObject.flattenPoints.get(chartName),mapEvents=geoMap.eventHandler.mapEvents,triggeringOffset=getTriggeringOffset(geoMap,geoMap.chartTypes[this.index].value),tree=mapEvents.cache.get("scatterQuadtree"),plotOptions=this.plotOptions,mouseX=XY[0],mouseY=XY[1];defined(tree)||(tree=geoMap.eventHandler.mapEvents.getTreeDiagram(flattenPoints),mapEvents.cache.set("scatterQuadtree",tree)),LOCATION_MARKERS.has(plotOptions.marker.symbol)&&(mouseY+=10*plotOptions.marker.size/2);var point=tree.find(mouseX,mouseY,triggeringOffset);return point&&(!geoMap.hasColorScale||geoMap.hasColorScale&&isWithinColorRange(geoMap.dataset.getClr(point),geoMap))?{type:"point",point:point}:null},GeoBubbleSeries.prototype.getPoint=function(latLong,mousePosition,skipColorRangeCheck){var overPoints,geoMap=this.geoMap,dataObject=geoMap.dataObject,chartName=geoMap.chartTypes[this.index].name,flattenPoints=dataObject.flattenPoints.get(chartName),triggeringOffset=getTriggeringOffset(geoMap,geoMap.chartTypes[this.index].value),isComboChart=dataObject.isCombinationalChart,mapEvents=geoMap.eventHandler.mapEvents,tree=mapEvents.cache.get("bubbleQuadtree");if(!flattenPoints)return null;defined(tree)||(tree=mapEvents.getTreeDiagram(flattenPoints).radius(function(point){return dataObject.getZFromPoint(point)}),mapEvents.cache.set("bubbleQuadtree",tree));var points=tree.findAll(mousePosition[0],mousePosition[1],triggeringOffset).points,point=null;if(!points)return null;var pointDetails=points.map(function(p){var x,y,cx,cy,rad=dataObject.getZFromPoint(p)/2,xy=dataObject.getXYPoint(p),dist=(x=mousePosition[0],y=mousePosition[1],cx=xy.x,cy=xy.y,mathSQRT((x-cx)*(x-cx)+(y-cy)*(y-cy)));return{radius:rad,bubbleDistance:dist-rad,pointDistance:dist,over:dist-rad<=0,point:p}});if(1===pointDetails.length)(!isComboChart||isComboChart&&pointDetails[0].over)&&(point=pointDetails[0].point);else if(pointDetails.length>1)if(1===(overPoints=pointDetails.filter(function(p){return p.over})).length)point=overPoints[0].point;else if(overPoints.length>1){point=overPoints.slice(0).sort(function(a,b){return d3.ascending(a.radius,b.radius)})[0].point}else if(!isComboChart){point=pointDetails.slice(0).sort(function(a,b){return d3.ascending(a.bubbleDistance,b.bubbleDistance)})[0].point}return point&&(!geoMap.hasColorScale||skipColorRangeCheck||geoMap.hasColorScale&&isWithinColorRange(geoMap.dataset.getClr(point),geoMap))?{type:"point",point:point}:void 0},GeoBubblePieSeries.prototype.getPoint=function(latLong,mousePosition){var point,geoIndex,key,pieRenderer,obj,geoMap=this.geoMap,pointInfo=(obj=this,Object.getPrototypeOf(obj.constructor.prototype)).getPoint.call(this,latLong,mousePosition,!0),bubblePiePoint=null;if(pointInfo){if(point=pointInfo.point,geoIndex=geoMap.dataset.getGeo(pointInfo.point),key=bubblepieUtils.getKey(NULL,NULL,NULL,[geoIndex,geoIndex]),!(pieRenderer=geoMap.subrenderer[point.subSeriesIndex][key]))return!1;if(pieRenderer.data.some(function(piePoint){if(piePoint.data.disabled||piePoint.data.dummy)return!1;var pieDataPoint=piePoint.data,pointCoordinates=geoMap.dataObject.getXYPoint(piePoint.data),pieAngle=getBubblePieAngle(geoMap,pieDataPoint.seriesIndex,pieDataPoint.subSeriesIndex,pieDataPoint),pointAngle=mathAtan2(mousePosition[0]-pointCoordinates.x,-(mousePosition[1]-pointCoordinates.y)),pointFound=pieAngle&&isAngleInside(pieAngle.start,pieAngle.end,pointAngle);return pointFound&&(bubblePiePoint=pieDataPoint),pointFound}),bubblePiePoint&&(!geoMap.hasColorScale||geoMap.hasColorScale&&isWithinColorRange(geoMap.dataset.getClr(bubblePiePoint),geoMap)))return{type:"point",point:bubblePiePoint}}return null},exports.version="2.3",exports.versionName="Ortelius",exports.d3Version="4.12.0",exports.chartcategory=chartcategory,exports.charttypenames=charttypenames,exports.charttype=charttype,exports.setTheme=function(name,value){$ZC[name]=value},exports.getTheme=function(name){return $ZC[name]},exports.rename=function(newObjName){if(null!=newObjName&&""!=newObjName&&"string"==typeof newObjName){var window=getDocumentWindow();return window[newObjName]=$ZC,window.$ZC=null,delete window.$ZC,!0}return!1},exports.tempCanvasContext=tempCanvasContext,exports.scale=scale$1,exports.requireXDataSorting=function(needSort){if(!arguments.length)return _requireXDataSorting;_requireXDataSorting=needSort},exports.imageFilePath=function(filepath){if(!arguments.length)return _imageFilePath;_imageFilePath=filepath},exports.dataEncoded=function(isEncoded){if(!arguments.length)return _dataEncoded;_dataEncoded=isEncoded},exports.setGlobalPatternSVG=function(patternSVG){$ZCG.patternSVG=patternSVG},exports.utils=utils,exports.appendElement=appendEle,exports.getRawColor=getRawColor,exports.charts=charts,exports.maps=maps,exports.addPattern=addPattern,exports.getPattern=function(name){return{type:patternThemes[name].type,size:patternThemes[name].size,strokeWidth:patternThemes[name].strokeWidth,bgClr:patternThemes[name].bgClr,stroke:patternThemes[name].stroke,fillOpacity:patternThemes[name].fillOpacity,strokeOpacity:patternThemes[name].strokeOpacity,translate:patternThemes[name].translate}},exports.effects=effects,exports.setLegendColorPallete=function(name,value){legutil.colorpallete.set(name,value)},exports.getLegendColorPallete=function(name){return legutil.colorpallete.get(name)},exports.setLegendPatternPallete=function(name,value){legutil.patternPallete.set(name,value)},exports.getLegendPatternPallete=function(name){return legutil.patternPallete.get(name)},exports.setLegendImagePallete=function(name,value){legutil.imagePallete.set(name,value)},exports.getLegendImagePallete=function(name){return legutil.imagePallete.get(name)},exports.legendHighlight=legendHighlight,exports.getFormattedValue=getFormattedValue,exports.generateFormatSpecifier=generateFormatSpecifier,exports.getTooltipPosition=getTooltipPosition,exports.annotation=annotation,exports.mapCollections=mapCollections,Object.defineProperty(exports,"__esModule",{value:!0})}),function(a){var e,r=a.fn.domManip,d="_tmplitem",q=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,b={},f={},p={key:0,data:{}},i=0,c=0,l=[];function g(g,d,h,e){var c={data:e||0===e||!1===e?e:d?d.data:{},_wrap:d?d._wrap:null,tmpl:null,parent:d||null,nodes:[],calls:u,nest:w,wrap:x,html:v,update:t};return g&&a.extend(c,g,{nodes:[],parent:d}),h&&(c.tmpl=h,c._ctnt=c._ctnt||c.tmpl(a,c),c.key=++i,(l.length?f:b)[i]=c),c}function j(e,g,f){var b,c=f?a.map(f,function(a){return"string"==typeof a?e.key?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+d+'="'+e.key+'" $2'):a:j(a,e,a._ctnt)}):e;return g?c:((c=c.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(f,c,e,d){m(b=a(e).get()),c&&(b=k(c).concat(b)),d&&(b=b.concat(k(d)))}),b||k(c))}function k(c){var b=document.createElement("div");return b.innerHTML=c,a.makeArray(b.childNodes)}function o(b){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+a.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(m,l,k,g,b,c,d){var i,e,f,j=a.tmpl.tag[k];if(!j)throw"Unknown template tag: "+k;return i=j._default||[],c&&!/\w$/.test(b)&&(b+=c,c=""),b?(b=h(b),d=d?","+h(d)+")":c?")":"",e=c?b.indexOf(".")>-1?b+h(c):"("+b+").call($item"+d:b,f=c?e:"(typeof("+b+")==='function'?("+b+").call($item):("+b+"))"):f=e=i.$1||"null",g=h(g),"');"+j[l?"close":"open"].split("$notnull_1").join(b?"typeof("+b+")!=='undefined' && ("+b+")!=null":"true").split("$1a").join(f).split("$1").join(e).split("$2").join(g||i.$2||"")+"__.push('"})+"');}return __;")}function n(c,b){c._wrap=j(c,!0,a.isArray(b)?b:[q.test(b)?b:a(b).html()]).join("")}function h(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function m(o){var k,j,e,p,h,n="_"+c,l={};for(e=0,p=o.length;e<p;e++)if(1===(k=o[e]).nodeType){for(h=(j=k.getElementsByTagName("*")).length-1;h>=0;h--)m(j[h]);m(k)}function m(j){var p,k,e,m,h=j;if(m=j.getAttribute(d)){for(;h.parentNode&&1===(h=h.parentNode).nodeType&&!(p=h.getAttribute(d)););p!==m&&(h=h.parentNode?11===h.nodeType?0:h.getAttribute(d)||0:0,(e=b[m])||((e=g(e=f[m],b[h]||f[h])).key=++i,b[i]=e),c&&o(m)),j.removeAttribute(d)}else c&&(e=a.data(j,"tmplItem"))&&(o(e.key),b[e.key]=e,h=(h=a.data(j.parentNode,"tmplItem"))?h.key:0);if(e){for(k=e;k&&k.key!=h;)k.nodes.push(j),k=k.parent;delete e._ctnt,delete e._wrap,a.data(j,"tmplItem",e)}function o(a){e=l[a+=n]=l[a]||g(e,b[e.parent.key+n]||e.parent)}}}function u(a,d,c,b){if(!a)return l.pop();l.push({_:a,tmpl:d,item:this,data:c,options:b})}function w(d,c,b){return a.tmpl(a.template(d),c,b,this)}function x(b,d){var c=b.options||{};return c.wrapped=d,a.tmpl(a.template(b.tmpl),b.data,c,b.item)}function v(d,c){var b=this._wrap;return a.map(a(a.isArray(b)?b.join(""):b).filter(d||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||function(b){var a=document.createElement("div");return a.appendChild(b.cloneNode(!0)),a.innerHTML}(a)})}function t(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]),a(b).remove()}a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(f,d){a.fn[f]=function(n){var k,h,m,l,g=[],i=a(n),j=1===this.length&&this[0].parentNode;if(e=b||{},j&&11===j.nodeType&&1===j.childNodes.length&&1===i.length)i[d](this[0]),g=this;else{for(h=0,m=i.length;h<m;h++)c=h,k=(h>0?this.clone(!0):this).get(),a(i[h])[d](k),g=g.concat(k);c=0,g=this.pushStack(g,f,i.selector)}return l=e,e=null,a.tmpl.complete(l),g}}),a.fn.extend({tmpl:function(d,c,b){return a.tmpl(this[0],d,c,b)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(d,m,k){if(d[0]&&a.isArray(d[0])){for(var f,g=a.makeArray(arguments),h=d[0],j=h.length,i=0;i<j&&!(f=a.data(h[i++],"tmplItem")););f&&c&&(g[2]=function(b){a.tmpl.afterManip(this,b,k)}),r.apply(this,g)}else r.apply(this,arguments);return c=0,!e&&a.tmpl.complete(b),this}}),a.extend({tmpl:function(d,h,e,c){var i,k=!c;if(k)c=p,d=a.template[d]||a.template(null,d),f={};else if(!d)return d=c.tmpl,b[c.key]=c,c.nodes=[],c.wrapped&&n(c,c.wrapped),a(j(c,null,c.tmpl(a,c)));return d?("function"==typeof h&&(h=h.call(c||{})),e&&e.wrapped&&n(e,e.wrapped),i=a.isArray(h)?a.map(h,function(a){return a?g(e,c,d,a):null}):[g(e,c,d,h)],k?a(j(c,null,i)):i):[]},tmplItem:function(b){var c;for(b instanceof a&&(b=b[0]);b&&1===b.nodeType&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode););return c||p},template:function(c,b){return b?("string"==typeof b?b=o(b):b instanceof a&&(b=b[0]||{}),b.nodeType&&(b=a.data(b,"tmpl")||a.data(b,"tmpl",o(b.innerHTML))),"string"==typeof c?a.template[c]=b:b):c?"string"!=typeof c?a.template(null,c):a.template[c]||a.template(null,q.test(c)?c:a(c)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){b={}},afterManip:function(f,b,d){var e=11===b.nodeType?a.makeArray(b.childNodes):1===b.nodeType?[b]:[];d.call(f,b),m(e),c++}})}(jQuery);