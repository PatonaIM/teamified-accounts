var TAMS={};TAMS.Team={URL:"/timeAttendance/teamlist",SEARCHURL:"/timeAttendance/searchuser",MODULES:{LEAVE:"leave",ATTENDANCE:"attendance",TIMETRACKER:"timetracker"},VIEWS:{GRID:"grid",LIST:"list",KANBAN:"kanban"},SUBMODE:{REPORTEES:"reportees",MEMBERS:"members"},subMode:"",CURRENT_SELECTED_USER:{},SEARCHKEY:void 0,TRIGGEREDKEY:void 0,MODULE_SEARCH:{},setCurrentUser:(userId,name,img)=>{void 0!==userId&&void 0!==name&&void 0!==img&&(TAMS.Team.CURRENT_SELECTED_USER.eno=userId,TAMS.Team.CURRENT_SELECTED_USER.name=name,TAMS.Team.CURRENT_SELECTED_USER.img=img)},goBackFromView:()=>{let url="#";if(-1!==Layout.Page.hash.indexOf("#attendance")){if(url=TAMS.Team.isAttTeamMembersPage()?"#attendance/team/members":"#attendance/team/reportees",Layout.Page.pageId.includes("attendance-teamaudit-audithistory")){let userId=Layout.Page.urlparam.id;url="#attendance/team/user/summary-mode:"+(Layout.Page.urlparam.mode?Layout.Page.urlparam.mode:"list")+"/id:"+userId}}else-1!==Layout.Page.hash.indexOf("#leavetracker")||-1!==Layout.Page.hash.indexOf("/leavetracker")?url=LVUtil.urls.getPageBackUrl():-1!==Layout.Page.hash.indexOf("#timetracker")&&(url="#timetracker/team/members");window.location.href=url},isAttTeamMembersPage:function(){return TAMS.Team.SUBMODE.MEMBERS==TAMS.Team.subMode&&TAMS.Team.getModuleName()==TAMS.Team.MODULES.ATTENDANCE},initPage:function(){TAMS.Team.CURRENT_SELECTED_USER={};let module=TAMS.Team.getModuleName();TAMS.Team.setSubModeName();let currentview=Layout.Page.container.find(".grpbtn").length>0?TAMS.Team.getCurrentView():TAMS.Team.VIEWS.GRID;if(module==TAMS.Team.MODULES.ATTENDANCE&&(settingsPage.container.closest(".cont-wrap").find(".zpl_cstmProfNav nav").prev().remove(),settingsPage.container.closest(".cont-wrap").find(".zpl_cstmProfNav").removeClass("zpl_profIn")),Layout.Page.container.html('<div class="zpl_container" scroll="enabled"><div class="zpl_iwrpr" tabindex="0" aria-label="'+ZPI18N.getString("zp.common.tabname",[ZPI18N.getString("zp.common.reporteespage")])+'" ><div class="zpl_iwrprrgt">'+TAMS.Team.getTopDiv(currentview)+"</div></div></div>"),module===TAMS.Team.MODULES.ATTENDANCE){if(TAMS.Team.SUBMODE.MEMBERS!=TAMS.Team.subMode){Layout.Page.container.find(".grpbtn").find("i[mode='"+currentview+"']").hasClass("zpl_act")||Layout.Page.container.find(".grpbtn").find("i[mode='"+currentview+"']").addClass("zpl_act"),Layout.Page.container.find(".PI_kanban").show();var html='<div id="kanbanViewOptions" class="zpl_drpdwn zmenu zmenu--iconwithtext"><ul>';ZPeople.Module.MODULE_DATA&&ZPeople.Module.MODULE_DATA.attendance&&ZPeople.Module.MODULE_DATA.attendance.showInOutAttStatus&&(html+='<li data-action="TAMS.KanbanView.getStatusKanbanView"><span class="zmenu__text">'+ZPI18N.getString("zp.statgrping")+"</span></li>"),html+='<li data-action="TAMS.KanbanView.getShiftKanbanView"><span class="zmenu__text">'+ZPI18N.getString("zp.shiftgrping")+"</span></li>",html+="</ul></div>",Layout.Page.container.append(html),ZPeopleComponents.menu("#kanbanViewOptions",{forElement:"#kanbanViewBut",contentType:"text"})}}else Layout.Page.container.find(".grpbtn").find("i[mode='"+currentview+"']").hasClass("zpl_act")||Layout.Page.container.find(".grpbtn").find("i[mode='"+currentview+"']").addClass("zpl_act"),Layout.Page.container.find(".PI_kanban").hide();Layout.Page.container.find(".grpbtn").find("i").on("click",function(){$(this).attr("mode")===TAMS.Team.VIEWS.KANBAN?ZPeopleComponents.menu("#kanbanViewOptions").show():(TAMS.KanbanView.CurrView=void 0,$(this).siblings().removeClass("zpl_act"),$(this).addClass("zpl_act"),TAMS.Team.getTeamUsers(TAMS.Team.CURRENT_SELECTED_USER.eno,void 0,void 0,!0))}),Layout.Page.container.find(".zpl_grpmnu").find("li").on("click",function(){$(this).hasClass("zpl_act")||($(this).siblings().removeClass("zpl_act"),$(this).addClass("zpl_act"),Object.keys(TAMS.ClassObjects).forEach(key=>{delete TAMS.ClassObjects[key]}),TAMS.Team.getTeamUsers(TAMS.Team.CURRENT_SELECTED_USER.eno))}),Layout.Page.container.find("#searchfield").on("keyup",function(){let key=$(this).val();TAMS.Team.searchCurrentHierarchyUsers(key,TAMS.Team.CURRENT_SELECTED_USER.eno)})},isAllowedToSearch:!0,searchCurrentHierarchyUsers:(key,eno)=>{TAMS.Team.moduleSearchActions(!0,!0),setTimeout(function(){if(TAMS.Team.isAllowedToSearch&&key.length>2)TAMS.Team.TRIGGEREDKEY=key,setTimeout(function(){if(TAMS.Team.SEARCHKEY&&TAMS.Team.SEARCHKEY==key||TAMS.Team.TRIGGEREDKEY!=key)return;TAMS.Team.SEARCHKEY=key;let moduleName=TAMS.Team.getModuleName();TAMS.Team.isAllowedToSearch=!1;let mode=TAMS.Team.getCurrentView(),filterParams={employee:void 0!=eno?eno:erecno,viewMode:mode,dataSelect:parseInt(TAMS.Team.getCurrentViewMode()),searchKey:key};filterParams.mode=TAMS.Team.SUBMODE.REPORTEES;let container=Layout.Page.container.find("#"+moduleName+"_team_container");moduleName==TAMS.Team.MODULES.ATTENDANCE&&(filterParams.mode=TAMS.Team.subMode,(container=Layout.Page.container.find("#"+moduleName+"_team_container_"+TAMS.Team.subMode)).removeClass("zpl_emptkban_switch")),TAMS.Team.initgetUserList(moduleName,container,mode),ZPeople.Request.send(TAMS.Team.SEARCHURL,{module:TAMS.Team.getModuleName(),filterParams:JSON.stringify(filterParams)},function(response,params){TAMS.Team.isAllowedToSearch=!0,TAMS.Team.handlegetUserList(response,container,mode),response&&response.success&&response.data&&(response.data.userlist&&response.data.userlist.length>0||response.data.attKanbanList&&0!=response.data.attKanbanList.reporteeCount)?TAMS.Team.constructUsers(filterParams.employee,void 0,void 0,response,params):(container.find("#zp_empty_data").remove(),container.append(TAMS.Team.getNoDataHTML()))})},500);else if(Layout.Page.container.find(".search-cmn").focus(),TAMS.Team.isAllowedToSearch&&TAMS.Team.SEARCHKEY!==key&&(key.length>2||0==key.length)){let moduleName=TAMS.Team.getModuleName(),mode=TAMS.Team.getCurrentView(),container=moduleName==TAMS.Team.MODULES.ATTENDANCE?Layout.Page.container.find("#"+moduleName+"_team_container_"+TAMS.Team.subMode):Layout.Page.container.find("#"+moduleName+"_team_container");container.removeClass("zpl_emptkban_switch"),key.length>2&&TAMS.Team.initgetUserList(moduleName,container,mode),TAMS.Team.handlegetUserList(void 0,container,mode),container.find("#zp_empty_data").remove(),container.find(".zpl_btnmnu").after(TAMS.Team.getNoDataHTML())}},500)},loadPage:()=>{TAMS.Team.setSubModeName(),TAMS.Team.getCurrentView()!=TAMS.Team.VIEWS.KANBAN&&TAMS.Team.getCurrentView()!=TAMS.KanbanView.VIEWS.SHIFT+TAMS.Team.VIEWS.KANBAN&&TAMS.Team.getCurrentView()!=TAMS.KanbanView.VIEWS.STATUS+TAMS.Team.VIEWS.KANBAN&&(TAMS.KanbanView.CurrView=void 0),window.removeEventListener("mouseover",TAMS.Team.loadPage),window.removeEventListener("focus",TAMS.Team.loadPage),TAMS.Team.getTeamUsers(TAMS.Team.CURRENT_SELECTED_USER?TAMS.Team.CURRENT_SELECTED_USER.eno:erecno,void 0,void 0,!0)},getCurrentView:function(){var curMode=Layout.Page.container.find(".grpbtn").find(".zpl_act").attr("mode");return TAMS.Team.isAttTeamMembersPage()&&(curMode=TAMS.Team.VIEWS.KANBAN),curMode===TAMS.Team.VIEWS.KANBAN&&(curMode=TAMS.KanbanView.CurrView+curMode),curMode},getCurrentViewMode:function(){return TAMS.Team.isAttTeamMembersPage()?"2":Layout.Page.container.find(".zpl_grpmnu").find(".zpl_act").attr("type")},getTopDiv:function(){var containerId=TAMS.Team.getModuleName()==TAMS.Team.MODULES.ATTENDANCE?TAMS.Team.getModuleName()+"_team_container_"+TAMS.Team.subMode:TAMS.Team.getModuleName()+"_team_container";if(TAMS.Team.isAttTeamMembersPage())return topDiv='<div id="'+containerId+'" class="zpl_act zpl_tblfxd zpl_fltr_flt"><div class="zpl_btnmnu"><div class="zpl_lft"></div><div class="search-cmn"><i class="PI_lens"></i> <input type="text" class="ztextbox" id="searchfield" placeholder="'+ZPI18N.getString("zp.mincharsearch",[3])+'"><i class="PI_cls" onclick="TAMS.Team.toggleSearchDiv()"></i></div><div class="zpl_rgt"><i class="zpl_ibg PI_lens" id="searchicon" tabindex="0" aria-label="'+ZPI18N.getString("zp.searchemployee")+'" onclick="TAMS.Team.toggleSearchDiv()" title="'+ZPI18N.getString("zp.searchemployee")+'"></i></div></div><div class="zpl_rgtcnt zpl_mdltmvw"><div id="statuskanban_view" class="zpl_emptkban_view"></div></div></div>';var direct_zpl_act=' class="zpl_act"',indirect_zpl_act="";if("undefined"!=typeof ActionList&&"2"===ActionList.Card.AttStatus.actionListMode){indirect_zpl_act=' class="zpl_act"',direct_zpl_act="";ActionList.Card.AttStatus.actionListMode=void 0}return topDiv='<div id="'+containerId+'" class="zpl_act zpl_tblfxd zpl_fltr_flt"><div class="zpl_btnmnu"><div class="zpl_lft"><div class="zpl_brdcrmp"></div></div><div class="search-cmn"> <i class="PI_lens"></i> <input type="text" class="ztextbox" id="searchfield" placeholder="'+ZPI18N.getString("zp.mincharsearch",[3])+'"> <i class="PI_cls" onclick="TAMS.Team.toggleSearchDiv()"></i> </div><div class="zpl_rgt"><ul class="zpl_grpmnu"> <li'+direct_zpl_act+' type=1 id="directRep"><span>'+ZPI18N.getString("zp.local.Direct")+'</span> <div class="zpl_tg"><span id="dcnt">0</span></div> </li> <li'+indirect_zpl_act+' type=2 id="inDirectRep"><span>'+ZPI18N.getString("zp.all")+'</span> <div class="zpl_tg"><span id="allcnt">0</span> </div></li> </ul><div class="grpbtn"><i class="PI_cardview" title="'+ZPI18N.getString("zp.gridview")+'" mode="'+TAMS.Team.VIEWS.GRID+'"></i><i class="PI_listview" title="'+ZPI18N.getString("zp.listview")+'" mode="'+TAMS.Team.VIEWS.LIST+'"></i><i class="PI_kanban" title="'+ZPI18N.getString("zp.kanbanview")+'" mode="'+TAMS.Team.VIEWS.KANBAN+'" id="kanbanViewBut"></i></div><i class="zpl_ibg PI_lens" id="searchicon" onclick="TAMS.Team.toggleSearchDiv()" aria-label="'+ZPI18N.getString("zp.searchemployee")+'" tabindex="0" title="'+ZPI18N.getString("zp.searchemployee")+'"></i></div></div><div class="zpl_rgtcnt zpl_mdltmvw"><div class="zpl_emcrdlst" id="grid_view"></div><div id="list_view"></div><div id="shiftkanban_view" class="zpl_emptkban_view"></div><div id="statuskanban_view" class="zpl_emptkban_view"></div></div></div>'},getNoDataHTML:()=>'<div id="zp_empty_data"><div id="emptPage" class="zpl_crd wd100_per"><div class="zpl_crdcnt"><div class="zpl_Emptydata"> <div> <div class="zpl_emptimg zp_nd_usridmap"></div> <h4>'+ZPI18N.getString("zp.payroll.search.norecordbody")+"</h4></div></div></div></div>",toggleSearchDiv:()=>{let icon=Layout.Page.container.find("#searchicon"),input=Layout.Page.container.find(".search-cmn");if(icon.toggleClass("opened"),icon.hasClass("opened"))input.addClass("opn"),input.find("#searchfield").focus(),TAMS.Team.moduleSearchActions(!0,!1);else{input.find("#searchfield").blur(),input.removeClass("opn");let val=input.find("#searchfield").val();val&&val.trim().length,input.find("#searchfield").val(""),TAMS.Team.moduleSearchActions()&&TAMS.Team.getTeamUsers(TAMS.Team.CURRENT_SELECTED_USER.eno)}},getModuleName:function(){let moduleName;return"leavetracker"==ZPeople.Module.getModuleKey()?moduleName=TAMS.Team.MODULES.LEAVE:"attendance"==ZPeople.Module.getModuleKey()?moduleName=TAMS.Team.MODULES.ATTENDANCE:"timetracker"==ZPeople.Module.getModuleKey()&&(moduleName=TAMS.Team.MODULES.TIMETRACKER),moduleName},setSubModeName:function(){var hashurl=Layout.Page.hash;TAMS.Team.getModuleName()==TAMS.Team.MODULES.ATTENDANCE&&(-1!=hashurl.indexOf(TAMS.Team.SUBMODE.REPORTEES)?TAMS.Team.subMode=TAMS.Team.SUBMODE.REPORTEES:-1!=hashurl.indexOf(TAMS.Team.SUBMODE.MEMBERS)&&(TAMS.Team.subMode=TAMS.Team.SUBMODE.MEMBERS))},moduleSearchActions:function(isSet,isSearched){let searchKey=TAMS.Team.getModuleName()+"Search";return TAMS.Team.isAttTeamMembersPage()&&(searchKey+=TAMS.Team.subMode),isSet&&(TAMS.Team.MODULE_SEARCH[searchKey]=isSearched),TAMS.Team.MODULE_SEARCH[searchKey]},getTeamUsers:function(userId,name,avatar,checkForReload){var module=TAMS.Team.getModuleName();module!=TAMS.Team.MODULES.LEAVE&&module!=TAMS.Team.MODULES.ATTENDANCE||Shift.getShiftList(),TAMS.Team.getTeamUserList(userId,name,avatar,checkForReload)},constructTopNav:function(userId,name,img){if(0==Layout.Page.container.find('.zpl_brdcrmp [userid="'+userId+'"]').length){Layout.Page.container.find(".zpl_brdcrmp").find('div:not([userid="'+userId+'"])').removeClass("zpl_cpd"),Layout.Page.container.find(".zpl_brdcrmp").find('div:not([userid="'+userId+'"])').find(".zpl_emdts.zpl_ellipsis").hide();var reportingname=void 0!=name&&name.indexOf("<b>")?name.split("<b>")[1]:name;return $('<div class="subFilterIcn zpl_cpd" userId="'+userId+'"><span class="zpl_em" tabindex="0" aria-label="'+ZPI18N.getString("zp.reportingto")+" "+reportingname+'"><div class="zpl_emimg"><img src="'+img+'"></div><div class="zpl_emdts zpl_ellipsis"> <div>'+name+"</div> </div></span></div>").on("click",function(){userId!=TAMS.Team.CURRENT_SELECTED_USER.eno&&($("[userId="+userId+"]").nextAll(".subFilterIcn").remove(),Layout.Page.container.find(".zpl_brdcrmp").find('div[userid="'+userId+'"]').find(".zpl_emdts.zpl_ellipsis").show(),TAMS.Team.getTeamUserList(userId,name,img))})}return Layout.Page.container.find('.zpl_brdcrmp [userid="'+userId+'"]').addClass("zpl_cpd"),""},initgetUserList:(moduleName,container,mode,loadPage)=>{container.find(".zpl_rgtcnt.zpl_mdltmvw").children().addClass("DNI"),void 0===loadPage||loadPage?(container.find("#zp_empty_data").remove(),container.find(".zpl_rgtcnt.zpl_mdltmvw").children().addClass("DNI"),container.find(".zpl_mdltmvw").find("#"+mode+"_view").html(""),container.find(".zpl_mdltmvw").find("#"+mode+"_view").after(ZPeople.LOADING_HTML)):(container.find(".zpl_mdltmvw").find("#"+mode+"_view").removeClass("DNI"),container.removeClass("zpl_emptkban_switch"),TAMS.KanbanView.isKanbanView(mode)&&!TAMS.Team.moduleSearchActions()&&container.addClass("zpl_emptkban_switch"))},handlegetUserList:(response,container,mode)=>{(void 0==response||response&&response.success&&response.data&&(response.data.userlist||response.data.attKanbanList))&&(container.find(".zpl_rgtcnt.zpl_mdltmvw").children().addClass("DNI"),container.find(".zpl_mdltmvw").find("#"+mode+"_view").html(""),container.find(".zpl_mdltmvw").find("#"+mode+"_view").removeClass("DNI"))},getTeamUserList:function(userId,name,img,checkForReload){var loadPage=!checkForReload||checkForReload&&TeamPageLoader.allowReloadOnTabSwitch();loadPage||"undefined"==typeof ActionList||TAMS.Team.getCurrentViewMode()===ActionList.Card.AttStatus.actionListMode||void 0===ActionList.Card.AttStatus.actionListMode||("1"!==ActionList.Card.AttStatus.actionListMode?(settingsPage.container.find("#directRep").removeClass("zpl_act"),settingsPage.container.find("#inDirectRep").addClass("zpl_act")):(settingsPage.container.find("#inDirectRep").removeClass("zpl_act"),settingsPage.container.find("#directRep").addClass("zpl_act")),loadPage=!0);let moduleName=TAMS.Team.getModuleName(),container=Layout.Page.container.find("#"+moduleName+"_team_container"),mode=TAMS.Team.getCurrentView();if(moduleName==TAMS.Team.MODULES.ATTENDANCE&&(TAMS.KanbanView.STATUSLIST[12]=holiday_disName===ZPI18N.getString("zp.holidays")?ZPI18N.getString("zp.holiday"):holiday_disName,TAMS.KanbanView.STATUSLIST[8]=ZPeople.decodeTxt(ZPeople.Module.MODULE_DATA.attendance.formname),container=Layout.Page.container.find("#"+moduleName+"_team_container_"+TAMS.Team.subMode)),TAMS.Team.initgetUserList(moduleName,container,mode,loadPage),!loadPage)return;let filterParams={employee:void 0!=userId?userId:erecno,viewMode:mode,dataSelect:parseInt(TAMS.Team.getCurrentViewMode()),needCnt:!userId||TAMS.Team.CURRENT_SELECTED_USER.eno!=userId};moduleName==TAMS.Team.MODULES.ATTENDANCE?(filterParams.mode=TAMS.Team.subMode,container.removeClass("zpl_emptkban_switch")):filterParams.mode=TAMS.Team.SUBMODE.REPORTEES,ZPeople.Request.send(TAMS.Team.URL,{module:moduleName,filterParams:JSON.stringify(filterParams)},function(response,params){if(container.find(".zpl_mdltmvw").find("#zp_page_loading").remove(),container.find("#zp_empty_data").remove(),response&&response.success&&response.data&&(response.data.userlist&&response.data.userlist.length>0||response.data.attKanbanList&&0!=response.data.attKanbanList.reporteeCount)){if(TeamPageLoader.setReload(),Layout.Page.container.find("#searchicon").hasClass("opened")){TAMS.Team.moduleSearchActions(!0,!1);let input=Layout.Page.container.find(".search-cmn");input.find("#searchfield").val(""),input.children(".PI_cls").click()}TAMS.Team.constructUsers(userId,name,img,response,params)}else container.append(TAMS.Team.getNoDataHTML())})},constructUsers:(userId,name,img,response,params)=>{let moduleName=TAMS.Team.getModuleName(),container=Layout.Page.container.find("#"+moduleName+"_team_container"),mode=TAMS.Team.getCurrentView();moduleName==TAMS.Team.MODULES.ATTENDANCE&&(container=Layout.Page.container.find("#"+moduleName+"_team_container_"+TAMS.Team.subMode)),container.removeClass("zpl_emptkban_switch"),response&&response.success&&response.data&&(response.data.userlist||response.data.attKanbanList)&&(TAMS.Team.handlegetUserList(response,container,mode),response.data.direct&&(container.find("#dcnt").text(response.data.direct),container.find("#directRep").attr({"aria-label":ZPI18N.getString("zp.numberof")+" "+ZPI18N.getString("zp.directreportees")+":"+response.data.direct,tabindex:"0"})),response.data.all&&(container.find("#allcnt").text(response.data.all),container.find("#inDirectRep").attr({"aria-label":ZPI18N.getString("zp.numberof")+" "+ZPI18N.getString("zp.reportees")+":"+response.data.all,tabindex:"0"})),void 0==userId?(TAMS.Team.isAttTeamMembersPage()||(Layout.Page.container.find(".zpl_brdcrmp").find(".subFilterIcn").remove(),Layout.Page.container.find(".zpl_brdcrmp").prepend(TAMS.Team.constructTopNav(ZPeople.CURR_USER.usererec,ZPeople.CURR_USER.empid+" - <b>"+ZPeople.CURR_USER.name,ZPeople.CURR_USER.avatar))),TAMS.Team.setCurrentUser(ZPeople.CURR_USER.usererec,ZPeople.CURR_USER.name,ZPeople.CURR_USER.avatar)):(TAMS.Team.isAttTeamMembersPage()||$(TAMS.Team.constructTopNav(userId,name,img)).insertAfter(Layout.Page.container.find('.zpl_brdcrmp [userid="'+TAMS.Team.CURRENT_SELECTED_USER.eno+'"]')),TAMS.Team.setCurrentUser(userId,name,img)));var firescrollMode=moduleName+"_"+mode+"_firescroll";if(TAMS.KanbanView.isKanbanView(mode)&&moduleName==TAMS.Team.MODULES.ATTENDANCE)container.addClass("zpl_emptkban_switch"),response&&response.success&&response.data&&response.data.attKanbanList&&(response.data.attKanbanList.officeINdName&&(TAMS.KanbanView.STATUSLIST[0]=response.data.attKanbanList.officeINdName),response.data.attKanbanList.remoteINdName&&(TAMS.KanbanView.STATUSLIST[1]=response.data.attKanbanList.remoteINdName),TAMS.KanbanView.CurrView===TAMS.KanbanView.VIEWS.STATUS?TAMS.KanbanView.constructKanbanStatusView(response.data.attKanbanList):(TAMS.Firescroll.init(container.find(".zpl_rgtcnt"),firescrollMode,{maxFetchLimit:TAMS.KanbanView.SHIFTGRPLIMIT,callback:TAMS.KanbanView.constructKanbanView,extraDtls:{moduleName:moduleName,mode:mode,firescrollMode:firescrollMode,data:response.data}},!0),TAMS.KanbanView.constructKanbanView({data:response.data})));else if(container.scrollTop(0),response&&response.success&&response.data&&response.data.userlist){let userlist=response.data.userlist;Object.keys(userlist).length>0&&(mode==TAMS.Team.VIEWS.GRID?TAMS.Team.constructGridView(params.module,mode,userlist):(TAMS.Team.constructListViewHeader(params.module,mode),TAMS.Team.constructListView(params.module,mode,userlist)),TAMS.Firescroll.init(container,firescrollMode,{maxFetchLimit:200,callback:TAMS.Team.loadMoreUsers,extraDtls:{moduleName:moduleName,mode:mode,firescrollMode:firescrollMode,params:params}}),TAMS.Firescroll.setFetchedCount(firescrollMode,Object.keys(userlist).length))}},loadMoreUsers:function(details){var params=details.params;params.filterParams=JSON.parse(params.filterParams),params.filterParams.sIndex=TAMS.Firescroll.getStartIndex(details.firescrollMode),params.filterParams.limit=TAMS.Firescroll.getMaxFetchLimit(details.firescrollMode),params.filterParams.needCnt=!1,params.filterParams=JSON.stringify(params.filterParams),ZPeople.Request.send(TAMS.Team.URL,params,function(response,params){if(TAMS.Firescroll.setActiveStatus(details.firescrollMode,!1),response&&response.success&&response.data&&response.data.userlist){let userlist=response.data.userlist;Object.keys(userlist).length>0?(details.mode==TAMS.Team.VIEWS.GRID?TAMS.Team.constructGridView(params.module,details.mode,userlist):TAMS.Team.constructListView(params.module,details.mode,userlist),TAMS.Firescroll.setFetchedCount(details.firescrollMode,Object.keys(userlist).length)):TAMS.Firescroll.setFetchedCount(details.firescrollMode,0)}})},getHierarchyLevel:(Obj,ev)=>{void 0===ev&&(ev=window.event),ev.stopPropagation&&(ev.preventDefault(),ev.stopPropagation());let data=$(Obj).parents(".outertr").data("empData");TAMS.Team.getTeamUsers(data.eno,data.name,data.avatar)},constructGridView:function(module,mode,userlist){let tempDiv=$("<div></div>");$.each(userlist,function(idx,empData){empData.name&&tempDiv.append(TAMS.Team.getGridViewHtml(module,empData))}),Layout.Page.container.find(".zpl_mdltmvw").find("#"+mode+"_view").append(tempDiv.children())},getGridViewHtml:function(module,empData,isKanban){let isAttTeamMembersPage=TAMS.Team.isAttTeamMembersPage(),clickEvent=isAttTeamMembersPage?"":module===TAMS.Team.MODULES.ATTENDANCE?"onclick=\"AttendanceTeam.redirectToTeamUserPage('"+empData.eno+"');\"":module===TAMS.Team.MODULES.LEAVE?"onclick=\"LVUtil.Team.navigateUserView('"+empData.eno+"');\"":"onclick=\"window.location.href='#timetracker/team/user/timelogs-mode:list/userId:"+empData.eno+"'\"",style=isAttTeamMembersPage?"style='cursor:default'":"";var empName=ZSEC.Encoder.encodeForHTML(empData.name),empId=ZSEC.Encoder.encodeForHTML(empData.empId),empLoc=empData.loc?ZSEC.Encoder.encodeForHTML(empData.loc):"";let html='<div class="zpl_dfcrd zpl_tmusrcrd outertr" userId="'+empData.eno+'" '+clickEvent+style+">";if(html+='<div class="zpl_emcrdcnt" tabindex="0" aria-label="'+empId+"-"+empName+" "+empLoc+'"><div class="zpl_em">',html+='<div class="zpl_emimg '+(isKanban?"zpl_smvw":"")+'"><img src="'+empData.avatar+'" ></div>',html+='<div class="zpl_emdts zpl_ellipsis">',html+="<div>"+empId+' - <b title="'+empName+'">'+empName+"</b></div>",html+="<div><em>"+empLoc+"</em></div>",TAMS.KanbanView.CurrView!=TAMS.KanbanView.VIEWS.STATUS&&empData.leaveAttStat){var leaveAttStat=empData.leaveAttStat,colourClass=Attendance.setClassToShowStatus(empData.colourCode);html+='<div class="zpl_flex-a-c" aria-label="'+(leaveAttStat=empData.leaveAvailed&&empData.availedLeave?empData.availedLeave:leaveAttStat)+'" tabindex="0" ><span class="'+colourClass+'">'+leaveAttStat+"</span>",void 0!=empData.checkInBuilding&&""!=empData.checkInBuilding&&(html+="<em class='zpl_dots'></em>",html+="<span class='zpl_flexaligngap1 zpl_ellipsis'><i class='PI_building "+colourClass+" tooltip-js' title='"+empData.checkInBuilding+"'></i>",html+="<em class='"+colourClass+" zpl_ellipsis' title='"+empData.checkInBuilding+"'>"+empData.checkInBuilding+"</em></span>"),html+="</div>"}html+="</div>";let isYetToCheckin=empData.leaveAttStat==ZPI18N.getString("zp.yetToCheckIn");return html+='<div class="MLauto d-flexclm4 zpl_hvr zpl_hvrsw">',"1"!=TAMS.Team.getCurrentViewMode()||TAMS.KanbanView.isKanbanView(TAMS.Team.getCurrentView())||(html+=empData.isReporteeAvl?'<i class="PI_subordinates" title="'+ZPI18N.getString("zp.reportees")+'" onclick="TAMS.Team.getHierarchyLevel(this)"></i>':""),"true"==ZPeople.ISCHAT&&empData.zuid&&"null"!=empData.zuid&&""!=empData.zuid&&empData.zuid!=_LOGGEDIN_ZUID&&(html+='<i class="PI_pharw" tabindex="0" aria-label="'+ZPI18N.getString("zp.common.calloption")+'" chat_comm="true" uid="'+empData.zuid+'"></i>'),html+="</div>",html+="</div>"+TAMS.Team.constructAdditionalInfo(module,empData,isYetToCheckin)+"</div></div>",html=$(html).data("empData",{eno:empData.eno,name:ZSEC.Encoder.encodeForHTML(empData.empId)+"- <b>"+empName+"</b>",avatar:empData.avatar})},constructListViewHeader:function(module,mode){let tableHtml="";module==TAMS.Team.MODULES.LEAVE?(tableHtml+="<thead><tr><th>"+ZPI18N.getString("zp.employee")+"</th><th>"+ZPI18N.getString("zp.status")+"</th><th>Leave booked this year</th><th>Shift</th></tr></thead>",tableHtml+="<tbody></tbody>"):module==TAMS.Team.MODULES.ATTENDANCE?(tableHtml+="<thead><tr><th>"+ZPI18N.getString("zp.employee")+"</th><th>"+ZPI18N.getString("zp.status")+"</th><th>",tableHtml+=ZPI18N.getString("zp.firstin")+"</th><th>"+ZPI18N.getString("zp.lastout")+"</th><th>"+ZPI18N.getString("zp.shiftsig"),tableHtml+="</th></tr></thead>",tableHtml+="<tbody></tbody>"):module==TAMS.Team.MODULES.TIMETRACKER&&(tableHtml+="<thead><tr><th>"+ZPI18N.getString("zp.employee")+"</th><th>"+ZPI18N.getString("zp.status")+"</th><th>"+ZPI18N.getString("zp.loggedhours")+"</th><th>"+ZPI18N.getString("zp.currentlyworkingjob")+"</th></tr></thead><tbody></tbody>");var html='<div class="zpl_tblres"><table class="zpl_tbl">'+tableHtml+"</table></div>";Layout.Page.container.find(".zpl_mdltmvw").find("#"+mode+"_view").html(html)},constructListView:function(module,mode,userlist){let tempDiv=$("<div></div>");$.each(userlist,function(idx,empData){let html="",clickEvent=module===TAMS.Team.MODULES.ATTENDANCE?"onclick=\"AttendanceTeam.redirectToTeamUserPage('"+empData.eno+"');\"":module===TAMS.Team.MODULES.LEAVE?"onclick=\"LVUtil.Team.navigateUserView('"+empData.eno+"');\"":"onclick=\"window.location.href='#timetracker/team/user/timelogs-mode:list/userId:"+empData.eno+"'\"",leaveAttStat=empData.leaveAttStat?empData.leaveAvailed&&empData.availedLeave?empData.availedLeave:empData.leaveAttStat:void 0;if(module==TAMS.Team.MODULES.LEAVE){let shiftDetails=void 0;empData.shiftId&&(shiftDetails=Shift.getShiftName(empData.shiftId,!0)),html+='<tr class="outertr" '+clickEvent+" userId="+empData.eno+'> <td > <div class="zpl_em"> <div class="zpl_emimg"><img src="'+empData.avatar+'"></div> <div class="zpl_emdts zpl_ellipsis" tabindex="0"> <div><em>'+ZSEC.Encoder.encodeForHTML(empData.empId)+"</em> - <b>"+ZSEC.Encoder.encodeForHTML(empData.name)+"</b></div> </div> ","1"==TAMS.Team.getCurrentViewMode()&&(html+=empData.isReporteeAvl?'<div class="MLauto zpl_hvr zpl_hvrsw" onclick="TAMS.Team.getHierarchyLevel(this)"> <i class="PI_subordinates" title="'+ZPI18N.getString("zp.reportees")+'"></i> </div>':""),html+="</div> </td>",html+=void 0!=leaveAttStat?'<td> <span class="'+Attendance.setClassToShowStatus(empData.colourCode)+'">'+leaveAttStat+"</span> </td>":"<td> <span></span> </td>",html+="<td> <span>"+(empData.bookedLeavesDays&&empData.bookedLeavesDays>0?empData.bookedLeavesDays+ZPI18N.getString("zp.leavetype.daysinfo"):"-")+" "+(empData.bookedLeavesDays&&empData.bookedLeavesDays>0&&empData.bookedLeavesHours&&empData.bookedLeavesHours>0?ZPI18N.getString("zp.and",[""]):"")+" "+(empData.bookedLeavesHours&&empData.bookedLeavesHours>0?empData.bookedLeavesHours+ZPI18N.getString("zp.leavetype.hoursinfo"):"")+"</span> </td> <td><span>"+(shiftDetails?shiftDetails.shiftName+"("+shiftDetails.timeInterval+")":"-")+"</span></td> </tr>"}else if(module==TAMS.Team.MODULES.ATTENDANCE){let shiftDetails=void 0;empData.shiftId&&(shiftDetails=Shift.getShiftName(empData.shiftId,!0)),html+='<tr class="outertr" '+clickEvent+" userId="+empData.eno+' ><td ><div class="zpl_em"><div class="zpl_emimg">',html+='<img src="'+empData.avatar+'"></div><div class="zpl_emdts zpl_ellipsis"><div><em>'+ZSEC.Encoder.encodeForHTML(empData.empId),html+="</em> - <b>"+ZSEC.Encoder.encodeForHTML(empData.name)+"</b></div></div>","1"==TAMS.Team.getCurrentViewMode()&&(html+=empData.isReporteeAvl?'<div class="MLauto zpl_hvr zpl_hvrsw" onclick="TAMS.Team.getHierarchyLevel(this)"> <i class="PI_subordinates" title="'+ZPI18N.getString("zp.reportees")+'"></i> </div>':""),html+="</div></td>",html+=void 0!=leaveAttStat?'<td><span class="'+Attendance.setClassToShowStatus(empData.colourCode)+'">'+leaveAttStat+"</span></td>":"<td> <span></span> </td>",html+="<td><span>"+(empData.filo&&empData.filo.ftime?empData.filo&&empData.filo.ftime:"-")+"</span></td>",html+="<td><span>"+(empData.filo&&empData.filo.ttime&&!empData.isUserAvailable?empData.filo&&empData.filo.ttime:"-")+"</span></td>",html+="<td><span>"+(shiftDetails?shiftDetails.shiftName+"("+shiftDetails.timeInterval+")":"-")+"</span></td></tr>"}else if(module==TAMS.Team.MODULES.TIMETRACKER){let jobName=empData.currentlyRunningTimerJobInfo?empData.currentlyRunningTimerJobInfo.jobName:"-";html+='<tr class="outertr" '+clickEvent+" userId="+empData.eno+'><td><div class="zpl_em"><div class="zpl_emimg"><img src="'+empData.avatar+'" '+clickEvent+'></div><div class="zpl_emdts zpl_ellipsis" '+clickEvent+" ><div><em>"+ZSEC.Encoder.encodeForHTML(empData.empId)+" - </em><b>"+ZSEC.Encoder.encodeForHTML(empData.name)+"</b></div></div>"+(empData.isReporteeAvl?'<div class="MLauto zpl_hvr zpl_hvrsw" onclick="TAMS.Team.getHierarchyLevel(this)"> <i class="PI_subordinates" title="'+ZPI18N.getString("zp.reportees")+'"></i> </div>':"")+"</div></td>",html+=void 0!=leaveAttStat?'<td><span class="'+Attendance.setClassToShowStatus(empData.colourCode)+'">'+leaveAttStat+"</span></td>":"<td> <span></span> </td>",html+="<td><span>"+Calendar.minstohrs(empData.timelogHours)+'</span></td><td><span title="'+("-"!==jobName?jobName:"")+'">'+jobName+"</span></td></tr>"}html=$(html).data("empData",{eno:empData.eno,name:ZSEC.Encoder.encodeForHTML(empData.empId)+"- <b>"+ZSEC.Encoder.encodeForHTML(empData.name)+"</b>",avatar:empData.avatar}),tempDiv.append(html)}),Layout.Page.container.find(".zpl_mdltmvw").find("#"+mode+"_view").find("tbody").append(tempDiv.children())},constructAdditionalInfo:function(module,empData,isYetToCheckin){var html="";if(module==TAMS.Team.MODULES.ATTENDANCE)html='<div class="zpl_empTmInfo">',!((isYetToCheckin||TAMS.Team.isAttTeamMembersPage())&&module==TAMS.Team.MODULES.ATTENDANCE&&TAMS.KanbanView.CurrView==TAMS.KanbanView.VIEWS.STATUS)&&(html='<div class="a-itm-left d-flexclm8 zpl_empTmInfo">',html+='<div class="d-flexcap"><div class="d-flexclmcap5 a-itm-cntr">',empData.filo&&empData.filo.ftime?html+='<i class="PI_entry"></i><b class="grn">'+empData.filo.ftime+"</b>":html+='<i class="PI_entry"></i><b class="grn">-</b>',html+="</div>",html+='<div class="d-flexclmcap5 a-itm-cntr">',empData.filo&&empData.filo.ttime&&!empData.isUserAvailable?html+='<i class="PI_exit"></i><b class="red">'+empData.filo.ttime+"</b>":html+='<i class="PI_exit"></i><b class="red">-</b>',html+="</div></div>"),html+=TAMS.Team.getAttPredictHtml(module,isYetToCheckin,empData),html+="<div>"+TAMS.Team.getShiftHtml(module,empData.shiftId)+"</div></div>";else if(module==TAMS.Team.MODULES.TIMETRACKER){let jobName=empData.currentlyRunningTimerJobInfo?empData.currentlyRunningTimerJobInfo.jobName:"-";html='<div class="a-itm-left d-flexclm8 zpl_empTmInfo" aria-label="'+ZPI18N.getString("zp.weeklylogged")+" - "+Calendar.minstohrs(empData.timelogHours)+" "+ZPI18N.getString("zp.smallhrs")+'" tabindex="0"><div class="d-flexclmcap5 zpl_ellipsis"><i class="PI_jobs"></i><span class="zpl_ellipsis" title="'+("-"!==jobName?jobName:"")+'">'+jobName+"</span></div><div><em>"+ZPI18N.getString("zp.weeklylogged")+" - </em><span>"+Calendar.minstohrs(empData.timelogHours)+" "+ZPI18N.getString("zp.smallhrs")+"</span><div></div>"}else if(module==TAMS.Team.MODULES.LEAVE){html='<div class="a-itm-left d-flexclm8 zpl_empTmInfo" aria-label="'+(empData.bookedLeavesDays&&empData.bookedLeavesDays>0?+empData.bookedLeavesDays+ZPI18N.getString("zp.leavetype.daysinfo"):"")+" "+((empData.bookedLeavesDays&&empData.bookedLeavesDays>0&&empData.bookedLeavesHours&&empData.bookedLeavesHours>0?ZPI18N.getString("zp.and",[""]):"")+" "+(empData.bookedLeavesHours&&empData.bookedLeavesHours>0?+empData.bookedLeavesHours+ZPI18N.getString("zp.leavetype.hoursinfo"):"")+ZPI18N.getString("zp.leavebookedyear"))+'" tabindex="0" >';let text=(empData.bookedLeavesDays&&empData.bookedLeavesDays>0?"<b>"+empData.bookedLeavesDays+"</b> "+ZPI18N.getString("zp.leavetype.daysinfo"):"")+" "+(empData.bookedLeavesDays&&empData.bookedLeavesDays>0&&empData.bookedLeavesHours&&empData.bookedLeavesHours>0?ZPI18N.getString("zp.and",[""]):"")+" "+(empData.bookedLeavesHours&&empData.bookedLeavesHours>0?"<b>"+empData.bookedLeavesHours+"</b> "+ZPI18N.getString("zp.leavetype.hoursinfo"):"");""!=text.trim()?html+=" <div> "+text+"<em>  "+ZPI18N.getString("zp.leavebookedyear")+"</em></div>":html+=" <div></div>",html+="<div>"+TAMS.Team.getShiftHtml(module,empData.shiftId)+"</div>"}return html},getShiftHtml:function(module,shiftId){let html="";if(shiftId&&(module!=TAMS.Team.MODULES.ATTENDANCE||TAMS.KanbanView.CurrView!=TAMS.KanbanView.VIEWS.SHIFT)){var shiftDetails=Shift.getShiftName(shiftId,!0),shiftTime=Shift.getShiftTimeForDisplay(shiftId);html='<em title="'+shiftDetails.shiftName+'" aria-label="'+shiftDetails.shiftName+":"+shiftTime+'">'+shiftDetails.shiftName+" - </em>",html+='<span title="'+shiftTime+'">'+shiftTime+"</span>"}return html},getAttPredictHtml:function(module,isYetToCheckin,empDetails){let html="";if(empDetails.attpredictions&&(module!=TAMS.Team.MODULES.ATTENDANCE||TAMS.KanbanView.CurrView!=TAMS.KanbanView.VIEWS.SHIFT)){var predictTime=isYetToCheckin?empDetails.attpredictions.intime:empDetails.attpredictions.outtime;predictTime&&(html='<div class="zpl_chknprdict"><i class="PI_prediction"></i>',html+="<span>"+(isYetToCheckin?ZPI18N.getString("zp.predict.att.predict.checkIn"):ZPI18N.getString("zp.predict.att.predict.checkOut"))+" "+predictTime+"</span></div>")}return html},getProfileHeaderParam:prevUrl=>{let filterParams={employee:TAMS.Team.CURRENT_SELECTED_USER.eno?TAMS.Team.CURRENT_SELECTED_USER.eno:erecno},moduleName=TAMS.Team.getModuleName();if(prevUrl&&"projectmembers"==prevUrl.page){filterParams.mode="projectmembers";let id=Layout.PageUtil.generateMainWrapID(prevUrl),select=ZPeopleComponents.select($("#"+id).find("#project_id_input"));select&&(filterParams.projectId=select.getValue())}else moduleName==TAMS.Team.MODULES.ATTENDANCE?filterParams.mode=TAMS.Team.subMode:filterParams.mode=TAMS.Team.SUBMODE.REPORTEES;return filterParams}},TAMS.KanbanView={SHIFTGRPEMPLIMIT:15,SHIFTGRPLIMIT:10,CurrView:void 0,STATUSLIST:[ZPI18N.getString("zp.officein"),ZPI18N.getString("zp.remotein"),ZPI18N.getString("zp.in"),ZPI18N.getString("zp.defprestat"),ZPI18N.getString("zp.yetToCheckIn"),ZPI18N.getString("zp.out"),ZPI18N.getString("zp.break"),"On Duty","",ZPI18N.getString("zp.weekend"),ZPI18N.getString("zp.statwknd"),ZPI18N.getString("zp.nonstatwknd"),""],VIEWS:{STATUS:"status",SHIFT:"shift"},isKanbanView:function(mode){return mode===TAMS.KanbanView.VIEWS.STATUS+TAMS.Team.VIEWS.KANBAN||mode===TAMS.KanbanView.VIEWS.SHIFT+TAMS.Team.VIEWS.KANBAN},constructKanbanView:function(details){let shiftList=details.data.attKanbanList,moduleName=TAMS.Team.getModuleName(),mode=TAMS.Team.getCurrentView();var firescrollMode=moduleName+"_"+mode+"_firescroll";let page=Layout.Page.container.find(".zpl_mdltmvw").find("#"+mode+"_view"),indexToStartWith=TAMS.Firescroll.getFetchedCount(firescrollMode),shiftKeys=details.data.orderedShiftId,dataAdded=0,orderedShiftIndex=0;if(TAMS.Firescroll.setActiveStatus(firescrollMode,!1),indexToStartWith<shiftKeys.length)for(;dataAdded<TAMS.KanbanView.SHIFTGRPLIMIT&&indexToStartWith+orderedShiftIndex<shiftKeys.length&&indexToStartWith+dataAdded<=Object.keys(shiftList).length;){let shiftId=shiftKeys[indexToStartWith+orderedShiftIndex];orderedShiftIndex++;let shiftVsEmp=shiftList[shiftId];if(void 0!==shiftVsEmp&&null!==shiftVsEmp&&0!==shiftVsEmp.length){let shiftDetails=Shift.getShiftName(shiftId,!0),html='<div class="zpl_emptkban_lst" id="'+shiftId+'"><div><div class="zpl_emptkban_hder">';html+='<div aria-label="'+shiftVsEmp.length+" "+ZPI18N.getString("zp.employee")+" are in "+ZSEC.Encoder.encodeForHTML(shiftDetails.shiftName)+'"><h5>'+shiftDetails.shiftName+"</h5><span>"+Shift.getShiftTimeForDisplay(shiftId)+"</span></div>",html+='<div class="zpl_tg"><span><b>'+shiftVsEmp.length+"</b></span></div></div>",html+='<div class="zpl_emptkban_bdy zpl_mdltmvw">',html+="</div></div></div>",page.append(html),TAMS.Firescroll.init(page.find("#"+shiftId),shiftId+"_firescrollMode",{maxFetchLimit:TAMS.KanbanView.SHIFTGRPEMPLIMIT,callback:TAMS.KanbanView.constructShiftGrpEmp,extraDtls:{moduleName:moduleName,mode:mode,firescrollMode:shiftId+"_firescrollMode",data:shiftVsEmp}}),html+=TAMS.KanbanView.constructShiftGrpEmp({data:shiftVsEmp},shiftId),dataAdded++}}TAMS.Firescroll.setFetchedCount(firescrollMode,dataAdded)},constructShiftGrpEmp:function(details,shiftId){let shiftVsEmp=details.data,tempDiv=$("<div></div>"),dataAdded=0,firescrollMode="";details.firescrollMode?(firescrollMode=details.firescrollMode,shiftId=details.firescrollMode.split("_")[0]):firescrollMode=shiftId+"_firescrollMode";let indexToStartWith=TAMS.Firescroll.getFetchedCount(firescrollMode);for(TAMS.Firescroll.setActiveStatus(firescrollMode,!1);indexToStartWith<shiftVsEmp.length&&dataAdded<TAMS.KanbanView.SHIFTGRPEMPLIMIT;++dataAdded)tempDiv.append(TAMS.Team.getGridViewHtml(TAMS.Team.getModuleName(),shiftVsEmp[indexToStartWith],!0)),delete shiftVsEmp[indexToStartWith],++indexToStartWith;TAMS.Firescroll.setFetchedCount(firescrollMode,dataAdded),Layout.Page.container.find(".zpl_mdltmvw").find("#"+TAMS.Team.getCurrentView()+"_view").find("#"+shiftId).find(".zpl_emptkban_bdy").append(tempDiv.children())},constructKanbanStatusView:function(statusList){TAMS.KanbanView.STATUSLIST.forEach(function(currStat,index){let currStatData=statusList[ZSEC.Encoder.encodeForHTML(currStat)],id=currStat.replaceAll(" ","");if(id=index<=1?0==index?"officeIn":"remoteIN":id.replace(/[^a-zA-Z0-9_-]/g,""),currStatData){let moduleName=TAMS.Team.getModuleName(),mode=TAMS.Team.getCurrentView(),page=Layout.Page.container.find(".zpl_mdltmvw").find("#"+mode+"_view"),html='<div class="zpl_emptkban_lst" id="'+id+'"><div><div class="zpl_emptkban_hder">';html+='<div tabindex="0" aria-label="'+currStatData.length+" "+ZPI18N.getString("zp.employees")+" "+ZSEC.Encoder.encodeForHTML(currStat)+'"><h5>'+ZSEC.Encoder.encodeForHTML(currStat)+"</h5></div>",html+='<div class="zpl_tg"><span><b>'+currStatData.length+"</b></span></div></div>",html+='<div class="zpl_emptkban_bdy zpl_mdltmvw">',html+="</div></div></div>",page.append(html),TAMS.Firescroll.init(page.find("#"+id),currStat+"_firescrollMode",{maxFetchLimit:TAMS.KanbanView.SHIFTGRPEMPLIMIT,callback:TAMS.KanbanView.constructStatusGrpEmp,extraDtls:{moduleName:moduleName,mode:mode,firescrollMode:currStat+"_firescrollMode",data:currStatData,index:index}}),html+=TAMS.KanbanView.constructStatusGrpEmp({data:currStatData},currStat,index)}})},constructStatusGrpEmp:function(details,currStat,index){let currStatData=details.data,tempDiv=$("<div></div>"),dataAdded=0,firescrollMode="";details.firescrollMode?(firescrollMode=details.firescrollMode,currStat=details.firescrollMode.split("_")[0],void 0==index&&(index=details.index)):firescrollMode=currStat+"_firescrollMode";let id=currStat.replaceAll(" ","");id=void 0!=index&&null!=index&&index<=1?0==index?"officeIn":"remoteIN":id.replace(/[^a-zA-Z0-9_-]/g,"");let indexToStartWith=TAMS.Firescroll.getFetchedCount(firescrollMode);for(TAMS.Firescroll.setActiveStatus(firescrollMode,!1);indexToStartWith<currStatData.length&&dataAdded<TAMS.KanbanView.SHIFTGRPEMPLIMIT;++dataAdded)tempDiv.append(TAMS.Team.getGridViewHtml(TAMS.Team.getModuleName(),currStatData[indexToStartWith],!0)),delete currStatData[indexToStartWith],++indexToStartWith;TAMS.Firescroll.setFetchedCount(firescrollMode,dataAdded),Layout.Page.container.find(".zpl_mdltmvw").find("#"+TAMS.Team.getCurrentView()+"_view").find("#"+id).find(".zpl_emptkban_bdy").append(tempDiv.children())},getShiftKanbanView:function(){TAMS.KanbanView.CurrView=TAMS.KanbanView.VIEWS.SHIFT;var kanbanObj=Layout.Page.container.find(".PI_kanban");kanbanObj.siblings().removeClass("zpl_act"),kanbanObj.addClass("zpl_act"),TAMS.Team.getTeamUsers(TAMS.Team.CURRENT_SELECTED_USER.eno,void 0,void 0,!0)},getStatusKanbanView:function(){TAMS.Team.setSubModeName(),TAMS.KanbanView.CurrView=TAMS.KanbanView.VIEWS.STATUS;var kanbanObj=Layout.Page.container.find(".PI_kanban");kanbanObj.siblings().removeClass("zpl_act"),kanbanObj.addClass("zpl_act"),TAMS.Team.getTeamUsers(TAMS.Team.CURRENT_SELECTED_USER.eno,void 0,void 0,!0)}},TAMS.Firescroll={FETCHED_RECORD_COUNT:{},MAX_FETCH_LIMIT:{},ACTIVE_STATUS:{},init:function(obj,mode,data,isHorizontal){obj&&(TAMS.Firescroll.reset(obj,mode),TAMS.Firescroll.setActiveStatus(mode,!0),TAMS.Firescroll.setMaxFetchLimit(mode,data.maxFetchLimit),$(obj).off("scroll").on("scroll",function(){var actualDivContentHeight,scrollPosition;TAMS.Firescroll.isActive(mode)&&(isHorizontal?(actualDivContentHeight=this.scrollWidth-50,scrollPosition=$(this).scrollLeft()+$(this).innerWidth()):(actualDivContentHeight=this.scrollHeight-50,scrollPosition=$(this).scrollTop()+$(this).innerHeight()),scrollPosition>actualDivContentHeight&&(TAMS.Firescroll.setActiveStatus(mode,!1),data.callback(data.extraDtls)))}))},reset:function(obj,mode){obj.off("scroll"),TAMS.Firescroll.setActiveStatus(mode,!1),TAMS.Firescroll.resetFetchedCount(mode)},setMaxFetchLimit:function(mode,limit){TAMS.Firescroll.MAX_FETCH_LIMIT[mode]=limit},getMaxFetchLimit:function(mode){return TAMS.Firescroll.MAX_FETCH_LIMIT[mode]},setFetchedCount:function(mode,count){void 0!==TAMS.Firescroll.FETCHED_RECORD_COUNT[mode]?TAMS.Firescroll.FETCHED_RECORD_COUNT[mode]+=count:TAMS.Firescroll.FETCHED_RECORD_COUNT[mode]=count,count===TAMS.Firescroll.getMaxFetchLimit(mode)?TAMS.Firescroll.setActiveStatus(mode,!0):TAMS.Firescroll.setActiveStatus(mode,!1)},resetFetchedCount:function(mode){TAMS.Firescroll.FETCHED_RECORD_COUNT[mode]=0},getFetchedCount:function(mode){return void 0!==TAMS.Firescroll.FETCHED_RECORD_COUNT[mode]?TAMS.Firescroll.FETCHED_RECORD_COUNT[mode]:0},setActiveStatus:function(mode,status){TAMS.Firescroll.ACTIVE_STATUS[mode]=status},isActive:function(mode){return TAMS.Firescroll.ACTIVE_STATUS[mode]},getStartIndex:function(mode){var fetchedCount=TAMS.Firescroll.getFetchedCount(mode);return fetchedCount>0&&(fetchedCount+=1),fetchedCount}},TAMS.ClassObjects={};class TeamPageLoader{constructor(){this.tabId=settingsPage.container[0].id,this.mode=TAMS.Team.getCurrentView(),this.subMode=TAMS.Team.subMode,this.kanbanView=TAMS.KanbanView.CurrView,this.reloadPage=!1,this.reloadVar=void 0,this.reloadOnTabSwitch=!0,this.allowReloadOnTabSwitchVar=void 0,this.objId=TeamPageLoader.getObjId()}isAllowReload(){return this.tabId===settingsPage.container[0].id&&this.objId===TeamPageLoader.getObjId()?(this.reloadPage=!1,!0):(this.reloadPage=!1,!1)}allowReloadOnTabSwitch(){return this.reloadOnTabSwitch}setReloadOnTabSwitch(){this.reloadOnTabSwitch=!0}setReload(){clearTimeout(this.reloadVar),this.reloadVar=setTimeout(TeamPageLoader.pageReload,3e5,this),clearTimeout(this.allowReloadOnTabSwitchVar),this.allowReloadOnTabSwitchVar=setTimeout(TeamPageLoader.setReloadOnTabSwitch,12e4,this),this.reloadPage=!0,this.reloadOnTabSwitch=!1}static getObjId(){return TAMS.Team.getModuleName()+TAMS.Team.subMode+TAMS.Team.getCurrentView()+(void 0!==TAMS.KanbanView.CurrView?TAMS.KanbanView.CurrView:"")}static getTeamPageLoaderObject(){let objId=TeamPageLoader.getObjId();return void 0===TAMS.ClassObjects[objId]&&(TAMS.ClassObjects[objId]=new TeamPageLoader),TAMS.ClassObjects[objId]}static pageReload(teamPageLoader){teamPageLoader.isAllowReload()&&("visible"==document.visibilityState&&document.hasFocus()?TAMS.Team.loadPage():window.addEventListener("visible"==document.visibilityState?"mouseover":"focus",TAMS.Team.loadPage))}static setReloadOnTabSwitch(teamPageLoader){teamPageLoader.setReloadOnTabSwitch()}static setReload(){TeamPageLoader.getTeamPageLoaderObject().setReload()}static allowReloadOnTabSwitch(){return TeamPageLoader.getTeamPageLoaderObject().allowReloadOnTabSwitch()}}ModuleAdmin={},AppExc={},TimelySettings={},TimelyZComp={},BrdCrumbFilter={},ModuleAdmin={initComponents:function(){AttendanceShift.getDepLocShiftList(),ModuleAdmin.getGroupsList(!0),ModuleAdmin.getModuleData()},getModuleName:function(needLowerCase=!1){let currentModule=ModuleAdmin.getModule();return"leave"===currentModule?moduleName=needLowerCase?ZPI18N.getString("zp.sleave"):ZPI18N.getString("zp.leave"):"timetracker"===currentModule?moduleName=needLowerCase?ZPI18N.getString("zp.stimesheet"):ZPI18N.getString("zp.timesheet"):"attendance"===currentModule&&(moduleName=needLowerCase?ZPI18N.getString("zp.sattendance"):ZPI18N.getString("zp.attendance")),moduleName},getModuleAdminName:function(needLowerCase=!1,needFullLowerCase=!1){let currentModule=ModuleAdmin.getModule();return"leave"===currentModule?needFullLowerCase?ZPI18N.getString("zp.smallleaveadmin"):needLowerCase?ZPI18N.getString("zp.sleaveadmin"):ZPI18N.getString("zp.leaveadmin"):"timetracker"===currentModule?needFullLowerCase?ZPI18N.getString("zp.smalltimesheetadmin"):needLowerCase?ZPI18N.getString("zp.stimesheetadmin"):ZPI18N.getString("zp.timesheetadmin"):"attendance"===currentModule?needFullLowerCase?ZPI18N.getString("zp.smallattendanceadmin"):needLowerCase?ZPI18N.getString("zp.sattendanceadmin"):ZPI18N.getString("zp.attendanceadmin"):""},getModule:function(){var module,currentPage=settingsUrlProps.niceUrlArr[settingsUrlProps.niceUrlArr.length-2];return"leavetracker"===currentPage?module="leave":"timetracker"===currentPage?module="timetracker":"attendance"===currentPage&&(module="attendance"),module},getModuleData:function(){if(void 0==ZPeople.Module.MODULE_DATA.moduleadmin){var params={initmodule:JSON.stringify({modulePrefix:"moduleadmin"})};ZPeople.Request.sendAsyncPost("/gettabdetails/initpage",params,function(result){void 0!==result.initmodule&&(ZPeople.Module.MODULE_DATA.moduleadmin=result.initmodule),ModuleAdmin.initPage()})}else ModuleAdmin.initPage()},initPage:function(){ModuleAdmin.getSettingsList()},getDesc:module=>"attendance"==module?ZPI18N.getString("zp.shiftadmindesc"):"leave"===module?ZPI18N.getString("zp.leaveadmindesc"):"timetracker"===module?ZPI18N.getString("zp.ttadmindesc"):"",LOOKUP_OPTIONS:[],constructTokenForLookup:function(fcId){var layout=settingsPage.container.find("#cardaddGroupModal");ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit")).destroy(),ModuleAdmin.createFormLookUpToken(fcId,layout.find("#ZPAtt_SPOCSelectGrpCrit"))},createFormLookUpToken:function(fcId,inputelement,options,idArr){let dataMappingObj={value:"ID",text:"DISPVALUE",id:"ID"};ZPeopleComponents.tokenfield(inputelement,{dataSource:{search:queryParams=>new Promise((search,reject)=>{let respObj={},params={},term=queryParams.query,page=queryParams.pages,results=[],key=fcId;if(void 0==ModuleAdmin.LOOKUP_OPTIONS[key]&&(ModuleAdmin.LOOKUP_OPTIONS[key]={}),ModuleAdmin.LOOKUP_OPTIONS[key][term]&&ModuleAdmin.LOOKUP_OPTIONS[key][term].length>0&&ModuleAdmin.LOOKUP_OPTIONS[key][term].length>200*(page-1))for(i=200*(page-1);i<200*page&&i<ModuleAdmin.LOOKUP_OPTIONS[key][term].length;i++)-1==$.inArray(ModuleAdmin.LOOKUP_OPTIONS[key][term][i],results)&&results.push(ModuleAdmin.LOOKUP_OPTIONS[key][term][i]);else if(!ModuleAdmin.LOOKUP_OPTIONS[key][term]||0!=ModuleAdmin.LOOKUP_OPTIONS[key][term].length){params.searchtxt=queryParams.query,params.startInd=queryParams.pages;let fields=[fcId];params.luFcIds=JSON.stringify(fields);let data=ModuleAdmin.fetchFormLookupOptions(params);if("7000"==data.code){void 0==ModuleAdmin.LOOKUP_OPTIONS[key][term]&&(ModuleAdmin.LOOKUP_OPTIONS[key][term]=[]);for(let optionsIndex=0;optionsIndex<data.message[fcId].length;optionsIndex++){let currOption=data.message[fcId][optionsIndex];currOption.DISPVALUE=ZPeople.decodeTxt(currOption.Value),currOption.ID=ZPeople.decodeTxt(currOption.Id),ModuleAdmin.LOOKUP_OPTIONS[key][term].push(currOption),results.push(currOption)}}else ModuleAdmin.LOOKUP_OPTIONS[key][term]=[]}search(respObj={results:results,more:!1})}),paginated:!0},dropdownList:{appendTo:settingsPage.container},dataMapping:dataMappingObj,search:{by:dataMappingObj.text,showNoResultsMessage:!0,highlightKeyword:!0},sort:!1,acceptNewValues:!1,serverSearch:!0,cacheData:!1,values:[],randomDropdownListId:!0,messages:{noResults:ZPI18N.getString("zp.nomatchesfound")}});if(void 0!=options&&options.length>0&&TimelyZComp.tokenField.addValues(inputelement,options),void 0!==idArr&&idArr.length>0){let params={},fields=[fcId];params.luFcIds=JSON.stringify(fields),params.defValues=JSON.stringify(idArr);let data=ModuleAdmin.fetchFormLookupOptions(params),lookupopt=[];if("7000"==data.code)for(let optionsIndex=0;optionsIndex<data.message[fcId].length;optionsIndex++){let currOption=data.message[fcId][optionsIndex];currOption.DISPVALUE=ZPeople.decodeTxt(currOption.Value),currOption.ID=ZPeople.decodeTxt(currOption.Id),lookupopt.push(currOption)}TimelyZComp.tokenField.addOptions(inputelement,lookupopt),TimelyZComp.tokenField.setValues(inputelement,idArr)}},fetchFormLookupOptions:params=>{params.mode="fetchFormLookupOtions",params.conreqcsr=csrfToken,params.formId=ZPeople.EMP_FORMID,params.isPermBasedListNotNeeded=!0,params.isfilternotneeded=!0,params.isRelatedLookup=!1;let dataArr=[];return ZPeople.Request.sendAsyncPost("/formAction.zp",params,function(data){return dataArr=data,data},void 0,function(error){dataArr=error}),dataArr},formCompFieldOptions:{},getValueFromEmpLookUp:function(fcId){if(ModuleAdmin.formCompFieldOptions[fcId])ModuleAdmin.consFormOptions(fcId);else{var param={mode:"getOptionForFormFeilds",conreqcsr:csrfToken,fcId:fcId};param.module=ModuleAdmin.getModule(),$.post("/moduleAdminAction.zp",param,function(rdata){var fieldValues=rdata.fieldValues[fcId];ModuleAdmin.formCompFieldOptions[fcId]=fieldValues,ModuleAdmin.consFormOptions(fcId)})}},consFormOptions:function(fcId,isReturn){var layout=settingsPage.container.find("#cardaddGroupModal"),formOptions=ModuleAdmin.formCompFieldOptions[fcId];if(!formOptions)return"";var options=[];for(var i in formOptions){var value=formOptions[i];options.push({id:value.optionId,name:$("<div/>").text(value.optionVal).html()})}if(!isReturn){options={data:options,contentType:"text",dataMapping:{value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},search:{by:"name"},allowDuplicateValues:!1,isLabelHTMLEncoded:!0,placeholder:ZPI18N.getString("zp.select"),dropdownList:{fitForElement:!0,isTextHTMLEncoded:!0}};return ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit")).destroy(),void ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit")).setAttributes(options)}return options},currSettId:null,populateSettingsOptions:function(show,obj){var layout;if(show){if(layout=ModuleAdmin.constructpopUpHtml(obj),ModuleAdmin.constructOptions(void 0,ModuleAdmin.groupsList,layout),layout.find("#ZPAtt_SPOCSettingsName").val(""),layout.find(".ztextbox--error__label").remove(),layout.find(".ztextbox__error").removeClass("ztextbox__error"),layout.find("input[type=checkbox]").prop("checked",!1),layout.find("#ZPAtt_SPOCViewShiftEnabled,#ZPAtt_SPOCEditShiftEnabled").prop("checked",!0),layout.find("#s2id_ZPAtt_SPOCUser_AddAdmin")[0]||ModuleAdmin.consResetEmpSearch("ZPAtt_SPOCUser_AddAdmin",layout,!0),ModuleAdmin.entryViewChange(),ModuleAdmin.currSettId=null,layout.find("#ZPAtt_SPOCEditAttEnabled").length>0?ModuleAdmin.entryViewChange():layout.find("#ZPLveEntry_ViewEnabled").length>0?Leave.SPOCSettings.entryViewChange(!0):layout.find("#ZPTT_EntriesViewEnabled").length>0&&Timetracker.util.entryViewChange(!0),layout.siblings(".zpl_mhder").find("h4").text(obj?ZPI18N.getString("zp.moduleadmin.editadmin",[ModuleAdmin.getModuleName(!0)]):ZPI18N.getString("zp.addshiftadmin",[ModuleAdmin.getModuleName(!0)])),obj){var settingsId=$(obj).attr("id");ModuleAdmin.currSettId=settingsId;var list=ModuleAdmin.settingsList[settingsId];layout.find("#ZPAtt_SPOCSettingsName").val(list.settingsName).focus(),layout.find("#ZPAtt_SPOCEditAttEnabled").length>0&&(layout.find("#ZPAtt_SPOCViewAttEnabled").prop("checked",1===list.viewAttEntry),layout.find("#ZPAtt_SPOCEditAttEnabled").prop("checked",1===list.editAttEntry),layout.find("#ZPAtt_SPOCViewShiftEnabled").prop("checked",1===list.viewShiftMap),layout.find("#ZPAtt_SPOCEditShiftEnabled").prop("checked",1===list.editShiftMap),layout.find("#ZPAtt_SPOCEViewReportEnabled").prop("checked",1===list.viewAttReport),ModuleAdmin.entryViewChange()),layout.find("#ZPLveEntry_ViewEnabled").length>0&&(layout.find("#ZPLveEntry_ViewEnabled").prop("checked",1===list.viewLvEntry),layout.find("#ZPLveEntry_EditEnabled").prop("checked",1===list.editLvEntry),layout.find("#ZPLveReport_ViewEnabled").prop("checked",1===list.viewLvReport),Leave.SPOCSettings.entryViewChange(!0)),layout.find("#ZPTT_EntriesViewEnabled").length>0&&(layout.find("#ZPTT_EntriesViewEnabled").prop("checked",1===list.viewTTEntries),layout.find("#ZPTT_EntriesEditEnabled").prop("checked",1===list.editTTEntries),layout.find("#ZPTT_ReportViewEnabled").prop("checked",1===list.viewTTReport),Timetracker.util.entryViewChange(!0));var groups=list.groups,userIds=list.userIds;if(0!==groups.length){ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCGroupsSelect"),{isLabelHTMLEncoded:!0,dropdownList:{isTextHTMLEncoded:!0,fitForElement:!0}}),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCGroupsSelect")).setValuesById(list.groupIds)}if(0!==userIds.length){var userList=ZPeople.getUserDetailsByIds(userIds,!1),values=[];for(var i in userIds){var id=userIds[i],userDtl=ZPeople.getUserDetailsByIdInList(id,userList);userDtl&&userDtl.name&&values.push({id:id,text:ZPeople.decodeTxt(userDtl.name),html:userDtl.name,photo:userDtl.avatar})}ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCUser_AddAdmin")).setAttribute("values",values)}}layout.find("#ZPAtt_SPOCSettingsName").focus()}else ModuleAdmin.moduleAdminPopUpMod.close()},groupMappingList:{},currGroupId:null,populateGroupOptions:function(obj,show){if(show){ModuleAdmin.addGroups();var layout=settingsPage.container.find("#cardaddGroupModal");layout.find("#ZPAtt_SPOCGroupName").val(""),layout.find("#ZPAtt_SPOCAddGroupPopup .ztextbox--error__label").remove(),layout.find("#ZPAtt_SPOCAddGroupPopup .ztextbox__error").removeClass("ztextbox__error"),layout.find(".sltd_grpsDv").remove(),layout.find("#ZPAtt_SPOCSelectGrpCrit").parent().show(),layout.find("#ZPAtt_SPOCUser_AppField_user").parent().hide(),ModuleAdmin.currGroupId=null;var groupId;layout.find("#ZPAtt_SPOCGroupBasedOn");ZPeopleComponents.select(layout.find("#ZPAtt_SPOCContOrNotCont")).setValue("0"),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit")).setAttribute("values",[]),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCUser_AppField_user")).setAttribute("values",[]),ModuleAdmin.populateApplicableOptions(),layout.find("#ZPAtt_SPOC_AddApplicable").on("click",function(){ModuleAdmin.addNewCriteria(this)});var divId=$(obj).attr("id");if(void 0!==divId&&"empBtnCrt"!==divId&&(groupId=$(obj).attr("id")),ZPeopleComponents.select(layout.find("#ZPAtt_SPOCGroupBasedOn")).setValue("0"),layout.siblings(".zpl_mhder").find("h4").text(groupId?ZPI18N.getString("zp.moduleadmin.editusergroup"):ZPI18N.getString("zp.addshiftgroup")),groupId){ModuleAdmin.currGroupId=groupId;var mappings=ModuleAdmin.groupMappingList[groupId];if(layout.find("#ZPAtt_SPOCGroupName").val(ModuleAdmin.groupsList[groupId]),void 0!==mappings)ModuleAdmin.populateGroupMappings(mappings);else{var param={mode:"getGroupMappings",conreqcsr:csrfToken,groupId:groupId};param.module=ModuleAdmin.getModule(),$.post("/moduleAdminAction.zp",param,function(rdata){var mapp=rdata.groupList;ModuleAdmin.groupMappingList[groupId]=mapp,ModuleAdmin.populateGroupMappings(mapp)})}}}else ModuleAdmin.groupsPopUpMod.close()},populateGroupMappings:function(mappings){var layout=settingsPage.container.find("#cardaddGroupModal"),appList=mappings.applicableObj,expList=mappings.exceptionObj,appFormField=mappings.appFormFieldObj,expFormField=mappings.expFormFieldObj,formCompOptions=mappings.formCompOptions,mapping={loc:"locOptionArr",dept:"depOptionArr",desg:"desgOptionArr",role:"roleOptionArr",entity:"entityOptionArr",busiUnit:"bUnitOptionArr",division:"divisionOptionArr",user:""},mappingText={loc:ZPI18N.getString("zp.location"),dept:ZPI18N.getString("zp.department"),desg:ZPI18N.getString("zp.designation"),role:ZPI18N.getString("zp.role"),entity:ZPI18N.getString("zp.employeeentity"),busiUnit:ZPI18N.getString("zp.employeeunit"),division:ZPI18N.getString("zp.divisionname"),user:ZPI18N.getString("zp.employee")},crtEle=layout.find(".selectCriDiv");if(!crtEle.find(".selectCri")[0]){var crtParEle='<div  class="selectCri"><h5>'+ZPI18N.getString("zp.selectedcriteria")+'</h5></div><div><div class="zpl_gbox"><table class="zpl_itbl zpl_erorbx"><tbody></tbody></table></div></div>';crtEle.append(crtParEle)}var lookUps=ZPeople.Module.MODULE_DATA.moduleadmin.empFormLookUps,empList="",isEmpAppli="";for(var i in appList)"user"!==i?ModuleAdmin.consGroupMapOptions(i,mappingText[i],mapping,appList[i],0):(empList=appList[i],isEmpAppli=0);for(var k in expList)"user"!==k?ModuleAdmin.consGroupMapOptions(k,mappingText[k],mapping,expList[k],1):(empList=expList[k],isEmpAppli=1);for(var j in appFormField){var dipsName=lookUps[j].dispName;"25"==ModuleAdmin.getFCTypeByID(j)?(ModuleAdmin.formCompFieldOptions[j]=formCompOptions[j],ModuleAdmin.consGroupMapOptions("fFields_"+j,dipsName,mapping,appFormField[j],0,ModuleAdmin.consFormOptions(j,!0))):ModuleAdmin.consGroupMapOptions("fFields_"+j,dipsName,mapping,appFormField[j],0,[])}for(var l in expFormField){dipsName=lookUps[l].dispName;"25"==ModuleAdmin.getFCTypeByID(j)?(ModuleAdmin.formCompFieldOptions[l]=formCompOptions[l],ModuleAdmin.consGroupMapOptions("fFields_"+l,dipsName,mapping,expFormField[l],1,ModuleAdmin.consFormOptions(l,!0))):ModuleAdmin.consGroupMapOptions("fFields_"+j,dipsName,mapping,appFormField[j],1,[])}""!==empList&&ModuleAdmin.consGroupMapOptions("user",ZPI18N.getString("zp.employee"),mapping,empList,isEmpAppli)},getFCTypeByID:function(fcId){var formFields=ZPeople.Module.MODULE_DATA.moduleadmin.empFormLookUps;if(formFields[fcId])return formFields[fcId].fcType},consGroupMapOptions:function(grpBaseVal,grpBaseText,mapping,values,conditionVal,formOptions){var layout=settingsPage.container.find("#cardaddGroupModal"),shows="<tr>";shows+="<td width='150'><span id="+grpBaseVal+">"+$("<div/>").text(grpBaseText).html()+"</span></td>",shows+='<td width="150"><div class="zpl_itblerormsg"><select class="select-js" id="ZPAtt_SPOCContOrNotCont_'+grpBaseVal+'" style="display: none;"><option value="0">'+ZPI18N.getString("zp.contains")+'</option><option value="1">'+ZPI18N.getString("zp.local.notcontains")+"</option></select></select></div></td>";var orText="";shows="<tr>";if(shows+="<td width='150'><span id="+grpBaseVal+">"+$("<div/>").text(grpBaseText).html()+"</span></td>",shows+='<td width="150"><div class="zpl_itblerormsg"><select class="select-js" id="ZPAtt_SPOCContOrNotCont_'+grpBaseVal+'" style="display: none;"><option value="0">'+ZPI18N.getString("zp.contains")+'</option><option value="1">'+ZPI18N.getString("zp.local.notcontains")+"</option></select></select></div></td>","user"!==grpBaseVal?shows+='<td width="150"><div><textarea placeholder="'+ZPI18N.getString("zp.select")+'" id="ZPAtt_SPOCSelectGrpCrit_'+grpBaseVal+'"></textarea></div></td>':(shows+='<td width="150"><div><textarea class="select-js" id="ZPAtt_SPOCUser_AppField_Final"/></textarea></div></td>',0!==layout.find(".selectCriDiv table tr").length&&(orText="<div class='sltd_OR'>("+ZPI18N.getString("zp.captialor")+")</div>")),shows+='<td><div> <i class="PI_delete" title='+ZPI18N.getString("zp.delete")+" onclick=ModuleAdmin.removeCurrEle(this)></i></div></td>",shows+="</tr>",layout.find(".selectCriDiv").find("table tbody").append(orText).append(shows),ZPeopleComponents.select(layout.find("#ZPAtt_SPOCContOrNotCont_"+grpBaseVal)).setValue(conditionVal),"user"!==grpBaseVal){var data=grpBaseVal.startsWith("fFields_")?formOptions:AttendanceShift.depLocShiftOptions[mapping[grpBaseVal]],grpCriArr=[],mapType=ModuleAdmin.getFCTypeByID(grpBaseVal.substring("8"));if($.each(data,function(index,obj){values.includes(obj.id)&&"26"!=mapType&&grpCriArr.push({id:obj.id,name:obj.name})}),"26"!=mapType){var options={data:data,contentType:"text",dataMapping:{value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},search:{by:"name"},allowDuplicateValues:!1,isLabelHTMLEncoded:!0,placeholder:ZPI18N.getString("zp.select"),dropdownList:{isTextHTMLEncoded:!0,fitForElement:!0}};ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit_"+grpBaseVal)).setAttributes(options),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit_"+grpBaseVal)).setAttribute("values",grpCriArr)}else ModuleAdmin.createFormLookUpToken(grpBaseVal.substring("8"),layout.find("#ZPAtt_SPOCSelectGrpCrit_"+grpBaseVal),[],values)}else ModuleAdmin.consResetEmpSearch("ZPAtt_SPOCUser_AppField_Final",layout,!0,!0),ModuleAdmin.consGroupMapUsers(values),layout.find("#ZPAtt_SPOCSelectGrpCrit").parent().show(),layout.find("#ZPAtt_SPOCUser_AppField_user").parent().hide();ZPeopleComponents.select(layout.find("#ZPAtt_SPOCGroupBasedOn")).removeOption(grpBaseVal)},consGroupMapUsers:function(val,fcType,isReturn){var layout=settingsPage.container.find("#cardaddGroupModal"),userList=ZPeople.getUserDetailsByIds(val,!1),values=[];for(var i in val){var id=val[i],userDtl=ZPeople.getUserDetailsByIdInList(id,userList);userDtl&&userDtl.name&&(26==fcType?values.push({ID:id,DISPVALUE:ZPeople.decodeTxt(userDtl.name)}):values.push({id:id,text:ZPeople.decodeTxt(userDtl.name),html:userDtl.name,photo:userDtl.avatar}))}if(1==isReturn)return values;ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCUser_AppField_Final")).setAttribute("values",values)},populateApplicableOptions:function(){var layout=settingsPage.container.find("#cardaddGroupModal"),option="<option value=0>"+ZPI18N.getString("zp.groupbasedon",new Array(""))+"</option>";option+="<optgroup id='systemFields' label='"+ZPI18N.getString("zp.systemfields")+"'>",option+="<option value='loc'>"+ZPI18N.getString("zp.location")+"</option>",option+="<option value='dept'>"+ZPI18N.getString("zp.department")+"</option>",option+="<option value='desg'>"+ZPI18N.getString("zp.designation")+"</option>",option+="<option value='role'>"+ZPI18N.getString("zp.role")+"</option>",isOrgStructureEnabled&&(option+="<option value='entity'>"+ZPI18N.getString("zp.employeeentity")+"</option>",option+="<option value='busiUnit'>"+ZPI18N.getString("zp.employeeunit")+"</option>",option+="<option value='division'>"+ZPI18N.getString("zp.divisionname")+"</option>"),option+="<option value='user'>"+ZPI18N.getString("zp.employee")+"</option>",option+="</optgroup>",option+="<optgroup id='customFields' label='"+ZPI18N.getString("zp.customefields")+"'>";var formFields=ZPeople.Module.MODULE_DATA.moduleadmin.empFormLookUps;for(var i in formFields){var field=formFields[i],dipsName=field.dispName;option+="<option value='fFields_"+field.fcId+"' fcType='"+field.fcType+"'>"+dipsName+"</option>"}option+="</optgroup>",layout.find("#ZPAtt_SPOCGroupBasedOn").html(option),ZPeopleComponents.select(layout.find("#ZPAtt_SPOCGroupBasedOn"),{change:function(){ModuleAdmin.consGroupOptions()}})},consGroupOptions:function(){var layout=settingsPage.container.find("#cardaddGroupModal"),ele=ZPeopleComponents.select(layout.find("#ZPAtt_SPOCGroupBasedOn")),mapVal=ele.getValue();let mapType=void 0;void 0!=(ele._selected?ele._selected[0]:void 0)&&(mapType=$(ele._selected[0]).attr("fcType"));if("user"===mapVal)layout.find("#ZPAtt_SPOCSelectGrpCrit").parent().hide(),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCUser_AppField_user")).setAttribute("values",[]),layout.find("#ZPAtt_SPOCUser_AppField_user").parent().show(),layout.find("#s2id_ZPAtt_SPOCUser_AppField_user")[0]||ModuleAdmin.consResetEmpSearch("ZPAtt_SPOCUser_AppField_user",layout,!0);else if(layout.find("#ZPAtt_SPOCSelectGrpCrit").parent().show(),layout.find("#ZPAtt_SPOCUser_AppField_user").parent().hide(),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit")).setAttribute("values",[]),mapVal.startsWith("fFields_"))"26"==mapType?ModuleAdmin.constructTokenForLookup(mapVal.substring("8")):ModuleAdmin.getValueFromEmpLookUp(mapVal.substring("8"));else{var options={data:AttendanceShift.depLocShiftOptions[{loc:"locOptionArr",dept:"depOptionArr",desg:"desgOptionArr",role:"roleOptionArr",entity:"entityOptionArr",busiUnit:"bUnitOptionArr",division:"divisionOptionArr",user:""}[mapVal]],contentType:"text",dataMapping:{value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},search:{by:"name"},allowDuplicateValues:!1,isLabelHTMLEncoded:!0,placeholder:ZPI18N.getString("zp.select"),dropdownList:{fitForElement:!0,isTextHTMLEncoded:!0}};ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit")).setAttributes(options)}},empCrtiDefVal:null,addNewCriteria:function(obj){var layout=settingsPage.container.find("#cardaddGroupModal"),grpCrt=ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit")).getAllValues(),grpCrtVal=[],grpCriArr=[],element=ZPeopleComponents.select(layout.find("#ZPAtt_SPOCGroupBasedOn"));let mapType=void 0;void 0!=(element._selected?element._selected[0]:void 0)&&(mapType=$(element._selected[0]).attr("fcType")),$.each(grpCrt,function(index,obj){grpCrtVal.push(obj.id),"26"==mapType?grpCriArr.push({ID:obj.ID,DISPVALUE:obj.DISPVALUE}):grpCriArr.push({id:obj.id,name:obj.name})});var grpBaseVal=element.getValue();if(!("user"!==grpBaseVal&&0===grpCrtVal.length||"user"===grpBaseVal&&0===ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCUser_AppField_user")).getAllValues())){$(obj);var grpBaseText=ZPeopleComponents.select(layout.find("#ZPAtt_SPOCGroupBasedOn")).getValue(!0)[0].label,conditionVal=ZPeopleComponents.select(layout.find("#ZPAtt_SPOCContOrNotCont")).getValue(),crtEle=layout.find(".selectCriDiv");if(!crtEle.find(".selectCri")[0]){var crtParEle='<div  class="selectCri"><h5>'+ZPI18N.getString("zp.selectedcriteria")+'</h5></div><div><div class="zpl_gbox"><table class="zpl_itbl zpl_erorbx"><tbody></tbody></table></div></div>';crtEle.append(crtParEle)}var shows="<tr>";shows+="<td width='150'><span id="+grpBaseVal+">"+$("<div/>").text(grpBaseText).html()+"</span></td>",shows+='<td width="150"><div class="zpl_itblerormsg"><select class="select-js" id="ZPAtt_SPOCContOrNotCont_'+grpBaseVal+'" style="display: none;"><option value="0">'+ZPI18N.getString("zp.contains")+'</option><option value="1">'+ZPI18N.getString("zp.local.notcontains")+"</option></select></select></div></td>",shows+="user"!==grpBaseVal?'<td width="150"><div><textarea id="ZPAtt_SPOCSelectGrpCrit_'+grpBaseVal+'"></textarea></div></td>':'<td width="150"><div><textarea class="select-js" id="ZPAtt_SPOCUser_AppField_Final"/></textarea></div></td>',shows+='<td><div> <i class="PI_delete" title='+ZPI18N.getString("zp.delete")+" onclick=ModuleAdmin.removeCurrEle(this)></i></div></td>",shows+="</tr>";if("user"!==grpBaseVal?(layout.find(".selectCriDiv").find("table").prepend(shows),layout.find(".selectCriDiv table:first-child")):(layout.find(".selectCriDiv").find("table").append(shows),layout.find(".selectCriDiv table:last-child")),1!==layout.find(".selectCriDiv table tr").length&&layout.find(".selectCriDiv #user")[0]&&!layout.find(".selectCriDiv .sltd_OR")[0]&&layout.find(".selectCriDiv #user").closest("tr").before("<div class='sltd_OR'>("+ZPI18N.getString("zp.captialor")+")</div>"),ZPeopleComponents.select(layout.find("#ZPAtt_SPOCContOrNotCont_"+grpBaseVal)).setValue(conditionVal),"user"!==grpBaseVal)if("26"!=mapType){var options={data:ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit")).getAttribute("data"),contentType:"text",dataMapping:{value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},search:{by:"name"},allowDuplicateValues:!1,isLabelHTMLEncoded:!0,dropdownList:{fitForElement:!0,isTextHTMLEncoded:!0}};ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit_"+grpBaseVal)).setAttributes(options),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit_"+grpBaseVal)).setAttribute("values",grpCriArr)}else ModuleAdmin.createFormLookUpToken(grpBaseVal.substring("8"),layout.find("#ZPAtt_SPOCSelectGrpCrit_"+grpBaseVal),grpCriArr);else{ModuleAdmin.consResetEmpSearch("ZPAtt_SPOCUser_AppField_Final",layout,!0);var empVals=ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCUser_AppField_user")).getAllValues(),empArr=[];$.each(empVals,function(index,obj){empArr.push(obj.id)}),ModuleAdmin.consGroupMapUsers(empArr),layout.find("#ZPAtt_SPOCSelectGrpCrit").parent().show(),layout.find("#ZPAtt_SPOCUser_AppField_user").parent().hide()}ZPeopleComponents.select(layout.find("#ZPAtt_SPOCGroupBasedOn")).removeOption([grpBaseVal]),ZPeopleComponents.select(layout.find("#ZPAtt_SPOCGroupBasedOn")).setValue("0"),ZPeopleComponents.select(layout.find("#ZPAtt_SPOCContOrNotCont")).setValue("0"),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit")).destroy(),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCSelectGrpCrit"))}},removeCurrEle:function(obj){var layout=settingsPage.container.find("#cardaddGroupModal"),parent=$(obj).closest("tr"),id=parent.find("td span").attr("id");if(id.startsWith("fFields_")){var field=ZPeople.Module.MODULE_DATA.moduleadmin.empFormLookUps[id.substring("8")],dipsName=field.dispName,fcId=field.fcId;ZPeopleComponents.select($("#ZPAtt_SPOCGroupBasedOn")).addOption({label:dipsName,value:"fFields_"+fcId},"append",$("#customFields"))}else{var option="";"loc"===id?option={value:"loc",label:ZPI18N.getString("zp.location")}:"dept"===id?option={value:"dept",label:ZPI18N.getString("zp.department")}:"desg"===id?option={value:"desg",label:ZPI18N.getString("zp.designation")}:"role"===id?option={value:"role",label:ZPI18N.getString("zp.role")}:"entity"===id?option={value:"entity",label:ZPI18N.getString("zp.employeeentity")}:"busiUnit"===id?option={value:"busiUnit",label:ZPI18N.getString("zp.employeeunit")}:"division"===id?option={value:"division",label:ZPI18N.getString("zp.divisionname")}:"user"===id&&(option={value:"user",label:ZPI18N.getString("zp.employee")}),ZPeopleComponents.select(settingsPage.container.find("#ZPAtt_SPOCGroupBasedOn")).addOption(option,"append",$("#systemFields"))}"user"===id?ZPeopleComponents.tokenfield(settingsPage.container.find("#ZPAtt_SPOCUser_AppField_Final")).destroy():ZPeopleComponents.tokenfield(settingsPage.container.find("#ZPAtt_SPOCSelectGrpCrit_"+id)).destroy(),ZPeopleComponents.select(settingsPage.container.find("#ZPAtt_SPOCContOrNotCont_"+id)).destroy();var clsPar=parent.closest(".selectCriDiv");parent.remove(),layout.find(".selectCriDiv #user")[0]&&1!==layout.find(".selectCriDiv table tr").length||layout.find(".sltd_OR").remove(),0===clsPar.find("table tr").length&&clsPar.empty()},saveSPOCSettings:function(obj){var layout=settingsPage.container.find("#cardmoduleSettingsPopUP");settingsPage.container.find("#tabmoduleSettingsPopUP").find("#sliderSbt").addClass("disabled");var settName=layout.find("#ZPAtt_SPOCSettingsName").val().trim(),adminIds=(ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCGroupsSelect")).getAllValues(),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCUser_AddAdmin")).getSelectedValuesId()),groupIds=ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCGroupsSelect")).getSelectedValuesId();layout.find(".ztextbox--error__label").remove(),layout.find(".ztextbox__error").removeClass("ztextbox__error");var isError=!1;if(""===settName&&(layout.find("#ZPAtt_SPOCSettingsName").after("<span class='ztextbox--error__label'>"+ZPI18N.getString("zp.nameismandat")+"</span>"),layout.find("#ZPAtt_SPOCSettingsName").addClass("ztextbox__error"),isError=!0),0===adminIds.length&&(layout.find("#ZPAtt_SPOCUser_AddAdmin").parent().append("<span class='ztextbox--error__label'>"+ZPI18N.getString("zp.moduleadmin.adminerr")+"</span>"),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCUser_AddAdmin")).setAttributes({className:"ztextbox__error"}),isError=!0),0===groupIds.length&&(layout.find("#ZPAtt_SPOCGroupsSelect").parent().append("<span class='ztextbox--error__label'>"+ZPI18N.getString("zp.groupismandat")+"</span>"),ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCGroupsSelect")).setAttributes({className:"ztextbox__error"}),isError=!0),isError)return void settingsPage.container.find("#tabmoduleSettingsPopUP").find("#sliderSbt").removeClass("disabled");var editAttEntry=layout.find("#ZPAtt_SPOCEditAttEnabled").is(":checked")?1:0,viewAttEntry=1===editAttEntry||layout.find("#ZPAtt_SPOCViewAttEnabled").is(":checked")?1:0,editShiftMap=layout.find("#ZPAtt_SPOCEditShiftEnabled").is(":checked")?1:0,viewShiftMap=1===editShiftMap||layout.find("#ZPAtt_SPOCViewShiftEnabled").is(":checked")?1:0,viewAttReport=layout.find("#ZPAtt_SPOCEViewReportEnabled").is(":checked")?1:0,viewLeaveEntry=0,editLeaveEntry=0,viewLeaveReport=0;layout.find("#ZPLveEntry_ViewEnabled").length>0&&(viewLeaveEntry=1===(editLeaveEntry=layout.find("#ZPLveEntry_EditEnabled").is(":checked")?1:0)||layout.find("#ZPLveEntry_ViewEnabled").is(":checked")?1:0,viewLeaveReport=layout.find("#ZPLveReport_ViewEnabled").is(":checked")?1:0);var editTTEntries=layout.find("#ZPTT_EntriesEditEnabled").is(":checked")?1:0,viewTTEntries=1===editTTEntries||layout.find("#ZPTT_EntriesViewEnabled").is(":checked")?1:0,viewTTReport=layout.find("#ZPTT_ReportViewEnabled").is(":checked")?1:0,param={mode:"saveSPOCSetting",conreqcsr:csrfToken,settingsName:settName,groupIds:JSON.stringify(groupIds),adminIds:JSON.stringify(adminIds),viewAttEntry:viewAttEntry,editAttEntry:editAttEntry,viewShiftMap:viewShiftMap,editShiftMap:editShiftMap,viewAttReport:viewAttReport,viewLvEntry:viewLeaveEntry,editLvEntry:editLeaveEntry,viewLvReport:viewLeaveReport,viewTTReport:viewTTReport,viewTTEntries:viewTTEntries,editTTEntries:editTTEntries};let permissionsTypeArr=["viewAttEntry","editAttEntry","viewShiftMap","editShiftMap","viewAttReport","viewLvEntry","editLvEntry","viewLvReport","viewTTReport","viewTTEntries","editTTEntries"],permissionsSelected=!1;for(const permissionType of permissionsTypeArr)if(1===param[permissionType]){permissionsSelected=!0;break}if(!permissionsSelected)return ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.selectanyonePermission")),void settingsPage.container.find("#tabmoduleSettingsPopUP").find("#sliderSbt").removeClass("disabled");ModuleAdmin.currSettId&&(param.settingsId=ModuleAdmin.currSettId),param.module=ModuleAdmin.getModule(),$.post("/moduleAdminAction.zp",param,function(rdata){if(settingsPage.container.find("#tabmoduleSettingsPopUP").find("#sliderSbt").removeClass("disabled"),rdata&&rdata.error&&"adminIdPresent"===rdata.error)return layout.find("#ZPAtt_SPOCUser_AddAdmin").parent().append("<span class='ztextbox--error__label'>"+ZPI18N.getString("zp.adminusercannotshiftadmin",[ModuleAdmin.getModuleName()])+"</span>"),void layout.find("#ZPAtt_SPOCUser_AddAdmin").addClass("ztextbox__error");rdata&&rdata.error&&"permissionsNotSelectedErr"===rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.selectanyonePermission")):(ModuleComp.Msg.showSuccessMsg(ModuleAdmin.currSettId?ZPI18N.getString("zp.editedHoliday",[ModuleAdmin.getModuleAdminName(!0)]):ZPI18N.getString("zp.added.successfully.msg",[ModuleAdmin.getModuleAdminName(!0)])),ModuleAdmin.getSettingsList(),ModuleAdmin.destroyZComp(),ModuleAdmin.moduleAdminPopUpMod.close())})},saveSPOCGroup:function(obj){var layout=settingsPage.container.find("#cardaddGroupModal");settingsPage.container.find("#tabaddGroupModal").find("#sliderSbt").addClass("disabled");var gName=layout.find("#ZPAtt_SPOCGroupName").val().trim();if(layout.find("#ZPAtt_SPOCAddGroupPopup .ztextbox--error__label").remove(),layout.find("#ZPAtt_SPOCAddGroupPopup .ztextbox__error").removeClass("ztextbox__error"),""===gName)return layout.find("#ZPAtt_SPOCGroupName").after("<span class='ztextbox--error__label'>"+ZPI18N.getString("zp.nameismandat")+"</span>"),layout.find("#ZPAtt_SPOCGroupName").addClass("ztextbox__error"),void settingsPage.container.find("#tabaddGroupModal").find("#sliderSbt").removeClass("disabled");var applicableFor={},appForLookUp={},exceptFor={},exceptForLookUp={};if(layout.find(".selectCriDiv table tr").each(function(i,ele){var name=(ele=$(ele)).find("span").attr("id"),conts=ZPeopleComponents.select(ele.find("#ZPAtt_SPOCContOrNotCont_"+name)).getValue(),crit=[];crit="user"===name?ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCUser_AppField_Final")).getSelectedValuesId():ZPeopleComponents.tokenfield(ele.find("#ZPAtt_SPOCSelectGrpCrit_"+name)).getSelectedValuesId(),"user"!==name&&0===crit.length||"user"===name&&0===ZPeopleComponents.tokenfield(layout.find("#ZPAtt_SPOCUser_AppField_Final")).getAllValues()?ModuleComp.Msg.showWarningMsg(ZPI18N.getString("zp.applicablemandat")):name.startsWith("fFields_")?(name=name.substring("8"),"0"===conts?appForLookUp[name]=crit:exceptForLookUp[name]=crit):"0"===conts?applicableFor[name]=crit:exceptFor[name]=crit}),0===Object.keys(applicableFor).length&&0===Object.keys(appForLookUp).length&&0===Object.keys(exceptFor).length&&0===Object.keys(exceptForLookUp).length)return ModuleComp.Msg.showWarningMsg(ZPI18N.getString("zp.applicablemandat")),void settingsPage.container.find("#tabaddGroupModal").find("#sliderSbt").removeClass("disabled");var param={mode:"saveSPOCGroup",conreqcsr:csrfToken,applicableFor:JSON.stringify(applicableFor),exceptFor:JSON.stringify(exceptFor),appForLookUp:JSON.stringify(appForLookUp),exceptForLookUp:JSON.stringify(exceptForLookUp),groupName:gName},groupId=ModuleAdmin.currGroupId;groupId&&(param.groupId=groupId),param.module=ModuleAdmin.getModule(),$.post("/moduleAdminAction.zp",param,function(rdata){settingsPage.container.find("#tabaddGroupModal").find("#sliderSbt").removeClass("disabled"),delete ModuleAdmin.groupMappingList[groupId];var grpId=null;layout.find("#ZPAtt_SPOCGroupsList_Popup").hasClass("in")||(grpId=rdata.groupId),ModuleAdmin.getGroupsList(!1,grpId,layout),ModuleAdmin.groupsPopUpMod.close()})},getApplData:function(appFor,appForLookUp,type){for(var layout=settingsPage.container,mapping=["loc","dept","desg","role","entity","busiUnit","division","user"],appclass=type?"AppField":"ExpField",mapLen=mapping.length,i=0;i<mapLen;i++){var applArr,field=mapping[i];0!==(applArr=i===mapLen-1?layout.find("#ZPAtt_SPOCUser_"+appclass+"_user").select2("val"):layout.find("#ZPAtt_SPOC_"+field+"_"+appclass+" select").select2("val")).length&&(appFor[mapping[i]]=applArr)}layout.find("div[id*=ZPAtt_lookUp_"+appclass+"] select").each(function(i,ele){var val=(ele=$(ele)).select2("val");if(0!==val.length){var fcId=ele.attr("name");appForLookUp[fcId]=val}})},switchApplicable:function(obj){var layout=settingsPage.container;$(obj).addClass("active").siblings().removeClass("active"),"ZPAtt_SPOCHeadAppli"===obj.id?(layout.find("#ZPAtt_SPOCApplicables").removeClass("DN"),layout.find("#ZPAtt_SPOCExceptions").addClass("DN")):(layout.find("#ZPAtt_SPOCApplicables").addClass("DN"),layout.find("#ZPAtt_SPOCExceptions").removeClass("DN"))},settingsList:null,getSettingsList:function(){TimelySettings.showHideLoadingPage(!0);var param={mode:"getAllSPOCSettings",conreqcsr:csrfToken};param.module=ModuleAdmin.getModule(),$.post("/moduleAdminAction.zp",param,function(rdata){if(rdata.fail)return settingsPage.container.html(""),settingsPage.constructPermissionDeniedPage(),null;if(ModuleAdmin.settingsList={},rdata.settingsList)for(var i in rdata.settingsList){let obj=rdata.settingsList[i];ModuleAdmin.settingsList[obj.settingsId]=obj}ModuleAdmin.consSettingsList()})},consSettingsList:function(){var layout=settingsPage.container,list=ModuleAdmin.settingsList,module=ModuleAdmin.getModule();layout.html('<div class="zpl_crd zpl_topcrdhdr"><div class="zpl_crdhdr"><div><h4>'+ModuleAdmin.getModuleAdminName()+"</h4><p>"+ModuleAdmin.getDesc(module)+'</p></div></div></div><div class="zpl_rgtcnt"><div class="zpl_btnmnu"><div class="zpl_rgt"><button class="zlabel zlabel--blue zlabel--medium"id="AddModuleAdminBtn" onclick="ModuleAdmin.populateSettingsOptions(true)">'+ZPI18N.getString("zp.compensation.addAdmin")+'</button></div></div><div class="zpl_tblres" id="ZPAtt_SPOCSettingsList"></div><div id="zp_empty_data"/></div>'),layout.addClass("zpl_tblfxd"),layout.find("#ZPAtt_SPOCSettingsList,#zp_empty_data").hide();var tableCont=layout.find(".zpl_tblres").find("#zpl_tbl").find("tbody");if(0===Object.keys(list).length)return Timetracker.Util.showHideNoData({msg:ModuleAdmin.getNoDataMsg(),buttonName:ZPI18N.getString("zp.compensation.addAdmin"),buttonCallBack:ModuleAdmin.populateSettingsOptions,desc:ModuleAdmin.getDesc(module)}),settingsPage.container.find("#zp_empty_data").fadeIn(200),void settingsPage.container.find("#AddModuleAdminBtn").closest(".zpl_btnmnu").addClass("DNI");settingsPage.container.find("#AddModuleAdminBtn").closest(".zpl_btnmnu").removeClass("DNI"),Timetracker.Util.showHideNoData({remove:!0}),layout.find(".zpl_tblres").html('<table class="zpl_tbl"><thead> <tr> <th class="W200"><b>'+ZPI18N.getString("zp.name")+"</b></th> <th><b>"+ZPI18N.getString("zp.compensation.admins.tabName")+"</b></th> <th><b>"+ZPI18N.getString("zp.groups")+'</b></th>  <th width="100"></th> </tr> </thead><tbody></tbody></table>'),tableCont=layout.find(".zpl_tblres").find(".zpl_tbl").find("tbody"),layout.find("#ZPAtt_SPOCSettingsList").show(),layout.find(".zpl_tblres").find("tbody").on("click","tr td:not(:last-child)",function(){ModuleAdmin.populateSettingsOptions(!0,$(this).closest("tr"))}),tableCont.html("");var cont="";for(var i in list){var settings=list[i];cont+="<tr id='"+i+"'>",cont+="<td><span>"+$("<div/>").text(settings.settingsName).html()+"</span></td>",cont+="<td><div class='dblerw'>";var userDet=settings.users;for(var k in userDet){if(cont+="<div class='zpl_em'><img class='zpl_emimg' src='"+(det=userDet[k]).empPhoto+"'>",cont+="<div class='zpl_emdts'><div><em>"+$("<div/>").text(det.empId).html()+" - </em><b> "+$("<div/>").text(det.empName).html()+"</b></div></div></div>","1"===k&&void 0!==userDet[parseInt(k)+1]){cont+="<span class='DB'>  + "+(Object.keys(userDet).length-2)+" "+ZPI18N.getString("zp.more")+"</span>";break}}cont+="</div></td>",cont+="<td>";var moreCnt="",groupDet=settings.groups;for(var l in groupDet){var det=groupDet[l];if(cont+="<div class='zpl_tg'><span>"+$("<div/>").text(det.groupName).html()+"</span></div>","2"===l&&void 0!==groupDet[parseInt(l)+1]){cont+='<div class="zpl_tg lmoreicon"><span class="lmoreicon"> + '+(Object.keys(groupDet).length-3)+"</span>",moreCnt+="<div class='zpl_drpdwn lmorediv'><div class='zpl_tg'><span>"+$("<div/>").text(det.groupName).html()+"</span></div>";break}l>"2"&&(moreCnt+="<div class='zpl_tg'><span>"+$("<div/>").text(det.groupName).html()+"</span></div>")}""!=moreCnt&&(cont+=moreCnt+="</div>"),cont+="</td>",cont+='<td><div class="zpl_hvr"><i class="PI_delete" title='+ZPI18N.getString("zp.delete")+' onclick= "Timetracker.Util.confirmpopUp('+i+",ModuleAdmin.deleteSettings,this,0, {header:'"+ZPI18N.getString("zp.common.entitydelete",[ModuleAdmin.getModuleAdminName(!1,!0)])+"'});\"></i></div></td>"}tableCont.html(cont),TimelySettings.showHideLoadingPage(),layout.find(".tooltip-js[title]").ztooltip()},entryViewChange:function(){var layout=settingsPage.container.find("#cardmoduleSettingsPopUP"),editButt=layout.find("#ZPAtt_SPOCEditAttEnabled");editButt.prop("disabled",!1),layout.find("#ZPAtt_SPOCViewAttEnabled").is(":checked")||(editButt.prop("checked",!1),editButt.prop("disabled",!0));var editSButt=layout.find("#ZPAtt_SPOCEditShiftEnabled");editSButt.prop("disabled",!1),layout.find("#ZPAtt_SPOCViewShiftEnabled").is(":checked")||(editSButt.prop("checked",!1),editSButt.prop("disabled",!0))},delSettPopup:function(obj,event,callback,extraDtls){event.stopPropagation(),Timetracker.Util.confirmpopUp(" + value + ",ModuleAdmin.delSPOCGroup,obj,0,{header:ZPI18N.getString("zp.deleteshiftgroupconfirmmsg")})},deleteSettings:function(obj){var settId=$(obj).closest("tr").attr("id"),param={mode:"deletSPOCSetting",conreqcsr:csrfToken,settingsId:settId};param.module=ModuleAdmin.getModule(),$.post("/moduleAdminAction.zp",param,function(){settingsPage.container.find("#"+settId).remove(),delete ModuleAdmin.settingsList[settId],ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.deleted.successfully.msg",[ModuleAdmin.getModuleAdminName(!0)]));var layout=settingsPage.container;0===Object.keys(ModuleAdmin.settingsList).length&&(layout.find("#ZPAtt_SPOCSettingsList").hide(),Timetracker.Util.showHideNoData({msg:ModuleAdmin.getNoDataMsg(),buttonName:ZPI18N.getString("zp.compensation.addAdmin"),buttonCallBack:ModuleAdmin.populateSettingsOptions,desc:ModuleAdmin.getDesc(param.module)}),settingsPage.container.find("#AddModuleAdminBtn").closest(".zpl_btnmnu").addClass("DNI"))})},groupsList:null,getGroupsList:function(isPageLoad,groupId,layout){var param={mode:"getAllSPOCGroups",conreqcsr:csrfToken};param.module=ModuleAdmin.getModule(),$.post("/moduleAdminAction.zp",param,function(rdata){var groupList=rdata.groupList;ModuleAdmin.groupsList=groupList,isPageLoad||ModuleAdmin.constructOptions(groupId,groupList,layout)})},constructOptions:function(groupId,groupList,layout){layout=layout||settingsPage.container;var listkeys=Object.keys(groupList),selectOpt=[];if(listkeys&&0!==listkeys.length){var html='<div class="zpl_rgtcnt"><div class="zpl_secn"><div><div class="zpl_cat">';for(var key in listkeys){var value=listkeys[key];html+='<div onclick="ModuleAdmin.populateGroupOptions(this,true);" id="'+value+'"><div class="zpl_Fldtl"><h5>'+$("<div/>").text(groupList[value]).html()+'</h5></div><div class="zpl_actn"><span><i class="PI_delete" title='+ZPI18N.getString("zp.delete")+" onclick=ModuleAdmin.delSettPopup(this,event,ModuleAdmin.delSPOCGroup)></i></span></div></div>",selectOpt.push({groupName:groupList[value],groupId:value})}html+='</div></div><div class="zpl_idiv" onclick="ModuleAdmin.populateGroupOptions(this,true);"><a class="zpl_lnkbg" data-popup-open="addusrgrp">'+ZPI18N.getString("zp.addshiftgroup")+"</a></div></div></div>",settingsPage.container.find("#ZPAtt_SPOCSettingsList").data("admingroupsHtml",html)}else{let html=ModuleAdmin.getUserGroupNoDataHtml();settingsPage.container.find("#ZPAtt_SPOCSettingsList").data("admingroupsHtml",html)}if(settingsPage.container.find("#tabviewAdminGroupModal").hasClass("zpl_mopen")&&settingsPage.container.find("#cardviewAdminGroupModal").html(html),settingsPage.container.find("#tabmoduleSettingsPopUP").hasClass("zpl_mopen")){var groupsSelect=settingsPage.container.find("#tabmoduleSettingsPopUP").find("#ZPAtt_SPOCGroupsSelect"),options={data:selectOpt,contentType:"text",dataMapping:{value:"groupId",text:"groupName",id:"groupId",informativeText:"name",titleText:"name"},search:{by:"groupName"},isLabelHTMLEncoded:!1,dropdownList:{fitForElement:!0,isTextHTMLEncoded:!1},allowDuplicateValues:!1},groupsSelectVal=ZPeopleComponents.tokenfield(groupsSelect).getAllValues();if(groupsSelectVal=JSON.parse(JSON.stringify(groupsSelectVal)),ZPeopleComponents.tokenfield(groupsSelect).removeAllTokens(),ZPeopleComponents.tokenfield(groupsSelect).setAttributes(options),groupId){var groupsSelectArr=[];$.each(groupsSelectVal,function(key,value){groupsSelectArr.push(value.groupId)});var index=groupsSelectArr.indexOf(groupId);index>-1&&groupsSelectVal.splice(index,1),groupsSelectVal.push({groupName:groupList[groupId],groupId:groupId})}ZPeopleComponents.tokenfield(groupsSelect).setAttribute("values",groupsSelectVal)}},showHideSPOCGroupDel:function(obj,show,event){event.stopPropagation();var parent=$(obj).closest(".spoc_Crd");if(show){parent.addClass("dlt_opt");var confMsg='<div class="zp_popdete" onclick=ModuleAdmin.delLayClick(event)><div class="zp_popdetebx"><span>'+ZPI18N.getString("zp.deleteshiftgroupconfirmmsg")+"</span>";confMsg+='<a class="zp_popdetecf" onclick=ModuleAdmin.delSPOCGroup(this,event)>'+ZPI18N.getString("zp.confirm")+'</a><a class="zp_popdetecl" onclick=ModuleAdmin.showHideSPOCGroupDel(this,false,event)>'+ZPI18N.getString("zp.cancel")+"</a></div></div>",parent.append(confMsg)}else parent.removeClass("dlt_opt"),parent.children().last().remove()},delSPOCGroup:function(obj){event.stopPropagation();var parent=$(obj).closest(".zpl_actn").parent(),groupId=parent.attr("id"),param={mode:"deletSPOCGroup",conreqcsr:csrfToken,groupId:groupId};param.module=ModuleAdmin.getModule(),$.post("/moduleAdminAction.zp",param,function(rdata){parent.remove();var pageContainer=$(settingsPage.mainWrapId),html=pageContainer.find("#ZPAtt_SPOCSettingsList").data("admingroupsHtml"),htmlObj=$(html);if(htmlObj.find("#"+groupId).remove(),delete ModuleAdmin.groupsList[groupId],ModuleAdmin.groupsList&&0===Object.keys(ModuleAdmin.groupsList).length){let html=ModuleAdmin.getUserGroupNoDataHtml();settingsPage.container.find("#ZPAtt_SPOCSettingsList").data("admingroupsHtml",html),ModuleAdmin.ViewGroupsConstruction()}else pageContainer.find("#ZPAtt_SPOCSettingsList").data("admingroupsHtml",htmlObj[0].outerHTML);var groupsSelect=pageContainer.find("#ZPAtt_SPOCGroupsSelect"),groupsSelectArr=[],groupsSelectVal=ZPeopleComponents.tokenfield(groupsSelect).getAllValues();$.each(groupsSelectVal,function(key,value){groupsSelectArr.push(value.groupId)}),ZPeopleComponents.tokenfield(groupsSelect).removeTokens(groupsSelectArr);var options=ZPeopleComponents.tokenfield(groupsSelect).getAttribute("data");$.each(options,function(key,value){if(value.groupId==groupId)return options.splice(key,1),!1}),ZPeopleComponents.tokenfield(groupsSelect).setAttribute("data",options)})},getUserGroupNoDataHtml:function(){return'<div class="zpl_rgtcnt"><div id="zp_empty_data"><div id="emptPage" class="zpl_crd wd100_per"><div class="zpl_crdcnt"><div class="zpl_Emptydata"><div><div class="zpl_emptimg zp_nd_nodata"></div><h4>'+ZPI18N.getString("zp.moduleadmin.nousergroup")+'</h4><p></p><font><button id="empBtnCrt" class="zlabel zlabel--blue zlabel--medium" onclick="ModuleAdmin.populateGroupOptions(this,true);">'+ZPI18N.getString("zp.addshiftgroup")+"</button></font></div></div></div></div></div>"},delLayClick:function(event){event.stopPropagation()},consResetEmpSearch:function(id,layout,construct,reset){var eleId="#"+id,searchJson=layout.find(eleId).data("searchJson");construct&&!searchJson&&(ModuleAdmin.changeinputtoselect2(layout.find(eleId),layout[0].id),searchJson=layout.find(eleId).data("searchJson")),reset&&searchJson&&ModuleComp.Search.reset(searchJson,!0)},noDataImg:function(path,imgClass,container){path=void 0!==path&&path>0?path:8;for(var nodata="<i class="+imgClass+">",i=1;i<=path;i++)nodata+='<i class="path'+i+'"></i>';nodata+="</i>",container.html(nodata)},changeinputtoselect2:function(element,parentId,initialSelection){var tabName="SHIFT",elementId=$(element).attr("id"),isMultiple=$(element).attr("multiple"),initCurrUser=$(element).attr("initcurruser"),defaultValue=ZPI18N.getString("zp.searchemployee");"ZPAtt_SPOCUser_AddAdmin"===elementId&&(tabName="SHIFT_ADMIN"),Att_Common_Operations.isTeamReqPage()&&(tabName="ONLY_SUB_USERS",Att_Common_Operations.isEmpShiftMapPage()&&element[0].id.includes("TeamFilter")&&(tabName="SHIFT_TEAM_VIEW")),Att_Common_Operations.isAttAllUsersOperationsPage()&&(tabName="OPERATIONS_EDIT",element[0].id.includes("Filter")&&(tabName="OPERATIONS_VIEW")),Att_Common_Operations.isShiftAllUsersOperationsPage()&&(tabName="SHIFT_OPR_EDIT",element[0].id.includes("Filter")&&(tabName="SHIFT_OPR_VIEW")),"ZPAtt_reg_approverId"!==elementId&&"ZPAtt_OD_approverId"!==elementId&&"ZPAtt_Perm_approverId"!==elementId&&"ZPAtt_shift_approverId"!==elementId&&"ZPATT_LocTrk_mailIdForSpecUser"!==elementId||(tabName="ALL_USERS"),"odEmps"!==elementId&&"permEmps"!==elementId&&"regEmps"!==elementId||void 0==Attendance||!Attendance.isInEmbedPage||(tabName="OPERATIONS_VIEW");var pModal=$(element).parents(".zpl_mdl"),obj={ele:element,inpFormat:"TEXTAREA"===$(element)[0].nodeName?"token":"select",initCurrentUser:!!initCurrUser,type:1,limit:10,isMultiple:!0,searchMode:"ATTENDANCE_"+tabName,searchType:"emp",placeHolder:defaultValue,initDefaultValues:!0,isMultiple:!!isMultiple,pModal:pModal.length>0?pModal:void 0};if("timetracker"===ModuleAdmin.getModule()&&(obj.searchMode=Timetracker.constants.Perm.SETTINGS,obj.initDefaultValues)){let defaultValuesCache=Timetracker.Search.getDefaultValuesCache(obj);void 0!==defaultValuesCache&&(obj.defaultValuesCache=defaultValuesCache),obj.setDefaultValueCacheFun=Timetracker.Search.setDefaultValuesCache}void 0!==initialSelection&&(obj.initialSelection=initialSelection),"ZPAtt_SPOCUser_AppField_Final"===elementId&&null!==ModuleAdmin.empCrtiDefVal&&((obj=ModuleAdmin.empCrtiDefVal).initDefaultValues=!1,obj.needScrolledValues=!0),Att_Common_Operations.isTeamReqPage()&&(obj.initCurrentUser=!1),ModuleComp.Search.create(obj)},openLearnMore:function(module){if(void 0!==module){var href="https://www.zoho.com/people/help/adminguide/";"leave"==module?href+="leavemoduleadmin.html":"attendance"==module?href+="attendancemoduleadmin.html":"timetracker"==module&&(href+="timesheetmoduleadmin.html"),window.open(href)}},constructpopUpHtml:function(obj){var module=ModuleAdmin.getModule();let moduleName=ModuleAdmin.getModuleName(!0);var html="";html+='<div class="zpl_crd"><div class="zpl_crdcnt zpl_crdinfo"><div><div class="zpl_secn w500"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.name")+"</label><p>"+ZPI18N.getString("zp.addshiftadminnamedesc",[moduleName])+'</p></div><div><input id="ZPAtt_SPOCSettingsName" placeholder="e.g. Time Administrator" type="text" class="ztextbox"></div></div><div class="zpl_secn w500"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.assignshiftadmin",[moduleName])+"</label><p>"+ZPI18N.getString("zp.assignshiftadmindesc",[moduleName])+'</p></div><div><textarea id="ZPAtt_SPOCUser_AddAdmin"></textarea></div></div><div class="zpl_secn w500"><div><div class="d-flexcap"><label class="zpl_mtry">'+ZPI18N.getString("zp.tagshiftgroup")+'</label><a class="zpl_lnk" onclick="ModuleAdmin.ViewGroups()" data-popup-open="vwusrgrp">'+ZPI18N.getString("zp.vieweditgroups")+"</a></div><p>"+ZPI18N.getString("zp.shiftgroupsdescinsett")+'</p></div><div><textarea id="ZPAtt_SPOCGroupsSelect"  placeholder="'+ZPI18N.getString("zp.select")+'" style="display: none;"></textarea></div></div><div class="zpl_secn"><div><h5>'+ZPI18N.getString("zp.configaccperm")+"</h5><p>"+ZPI18N.getString("zp.configpermdesc",[moduleName])+"</div>","timetracker"===module?html+="<div><label>"+ZPI18N.getString("zp.moduleadmin.timesheetentries")+'</label></div><div><div class="zcheckbox"><input id="ZPTT_EntriesViewEnabled" type="checkbox"  onchange="Timetracker.util.entryViewChange(true)" class="zcheckbox__helper"><label for="ZPTT_EntriesViewEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.view")+'</label></div><div class="zcheckbox"><input id="ZPTT_EntriesEditEnabled" type="checkbox" class="zcheckbox__helper"><label for="ZPTT_EntriesEditEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.addedit")+'</label></div></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.moduleadmin.timesheetreports")+'</label></div><div><div class="zcheckbox"><input id="ZPTT_ReportViewEnabled" type="checkbox" class="zcheckbox__helper" checked=""><label for="ZPTT_ReportViewEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.view")+"</label></div></div>":"leave"===module?html+="<div><label>"+ZPI18N.getString("zp.leaveentries")+'</label></div><div><div class="zcheckbox"><input id="ZPLveEntry_ViewEnabled" type="checkbox" onchange="Leave.SPOCSettings.entryViewChange(true)" class="zcheckbox__helper"><label for="ZPLveEntry_ViewEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.view")+'</label></div><div class="zcheckbox"><input id="ZPLveEntry_EditEnabled" type="checkbox"  class="zcheckbox__helper"><label for="ZPLveEntry_EditEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.addedit")+'</label></div></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.reports")+'</label></div><div><div class="zcheckbox"><input id="ZPLveReport_ViewEnabled" type="checkbox" class="zcheckbox__helper"><label for="ZPLveReport_ViewEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.view")+"</label></div></div>":"attendance"===module&&(html+="<div><label>"+ZPI18N.getString("zp.moduleadmin.attentries")+'</label></div><div><div class="zcheckbox"><input id="ZPAtt_SPOCViewAttEnabled" type="checkbox"  onchange="ModuleAdmin.entryViewChange();" class="zcheckbox__helper"><label for="ZPAtt_SPOCViewAttEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.view")+'</label></div><div class="zcheckbox"><input id="ZPAtt_SPOCEditAttEnabled" type="checkbox" value="" class="zcheckbox__helper"><label for="ZPAtt_SPOCEditAttEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.addedit")+'</label></div></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.moduleadmin.uservsshift")+'</label></div><div><div class="zcheckbox"><input id="ZPAtt_SPOCViewShiftEnabled" type="checkbox" onchange="ModuleAdmin.entryViewChange();"class="zcheckbox__helper"><label for="ZPAtt_SPOCViewShiftEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.view")+'</label></div><div class="zcheckbox"><input id="ZPAtt_SPOCEditShiftEnabled" type="checkbox" class="zcheckbox__helper"><label for="ZPAtt_SPOCEditShiftEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.addedit")+'</label></div></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.reports")+'</label></div><div><div class="zcheckbox"><input id="ZPAtt_SPOCEViewReportEnabled" type="checkbox" name="check" value="" class="zcheckbox__helper" checked=""><label for="ZPAtt_SPOCEViewReportEnabled" class="zcheckbox__label">'+ZPI18N.getString("zp.view")+"</label></div></div>"),html+='</div></div><div class="zpl_info"><div><h6><b>'+ZPI18N.getString("zp.shiftadminoverview",[ModuleAdmin.getModuleName()])+"</b></h6><p>"+ZPI18N.getString("zp.shiftadminoverviewdesc",[moduleName,moduleName,ModuleAdmin.getModuleName()])+'</p><a class="zpl_lnkbg" onclick="ModuleAdmin.openLearnMore(\''+module+"')\">"+ZPI18N.getString("zp.learnMore")+"</a></div></div></div></div>";let moduleAdminPopUpTabs=new Tab("moduleSettingsPopUP",function(){settingsPage.container.find("#cardmoduleSettingsPopUP").html(html)},function(){ModuleAdmin.saveSPOCSettings(this)});ModuleAdmin.moduleAdminPopUpMod=new sliderModal(obj?ZPI18N.getString("zp.moduleadmin.editadmin",[moduleName]):ZPI18N.getString("zp.addshiftadmin",[moduleName]),moduleAdminPopUpTabs),ModuleAdmin.moduleAdminPopUpMod.largeSize=!0,ModuleAdmin.moduleAdminPopUpMod.setCloseCallback(function(){ModuleAdmin.destroyZComp()}),ModuleAdmin.moduleAdminPopUpMod.construct();var cont=settingsPage.container.find("#tabmoduleSettingsPopUP");return cont.removeClass("zpl_pachokey"),cont.find(".PI_cls").attr("title",ZPI18N.getString("zp.close")).ztooltip(),settingsPage.container.find("#cardmoduleSettingsPopUP")},ViewGroups:function(){let groupsPopUpTabs=new Tab("viewAdminGroupModal",function(){ModuleAdmin.ViewGroupsConstruction()});ModuleAdmin.groupsPopUpMod=new sliderModal(ZPI18N.getString("zp.shiftgroups"),groupsPopUpTabs),ModuleAdmin.groupsPopUpMod.largeSize=!0,ModuleAdmin.groupsPopUpMod.ftExtraCls="DN",ModuleAdmin.groupsPopUpMod.construct(),ModuleAdmin.groupsPopUpMod.sliderDiv.find(".PI_cls").attr("title",ZPI18N.getString("zp.close")),ModuleAdmin.groupsPopUpMod.sliderDiv.ztooltip()},ViewGroupsConstruction:function(){var groupHtml=settingsPage.container.find("#ZPAtt_SPOCSettingsList").data("admingroupsHtml");settingsPage.container.find("#cardviewAdminGroupModal").html(groupHtml)},addGroups:function(){let groupsPopUpTabs=new Tab("addGroupModal",function(){ModuleAdmin.addGroupHtmlConst()},function(){ModuleAdmin.saveSPOCGroup(this)});ModuleAdmin.groupsPopUpMod=new sliderModal(ZPI18N.getString("zp.addshiftgroup"),groupsPopUpTabs),ModuleAdmin.groupsPopUpMod.largeSize=!0,ModuleAdmin.groupsPopUpMod.setCloseCallback(function(){var modal=settingsPage.container.find("#cardaddGroupModal");modal.find("select").each(function(){ZPeopleComponents.select(modal.find("#"+$(this).attr("id"))).destroy()}),modal.find("textarea").each(function(){ZPeopleComponents.tokenfield(modal.find("#"+$(this).attr("id"))).destroy()})}),ModuleAdmin.groupsPopUpMod.construct(),ModuleAdmin.groupsPopUpMod.sliderDiv.removeClass("zpl_pachokey"),ModuleAdmin.groupsPopUpMod.sliderDiv.find(".PI_cls").attr("title",ZPI18N.getString("zp.close")),ModuleAdmin.groupsPopUpMod.sliderDiv.ztooltip()},addGroupHtmlConst:function(){var html='<div class="zpl_crd"><div class="zpl_crdcnt zpl_crdinfo"><div><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.name")+"</label><p>"+ZPI18N.getString("zp.addshiftgroupnamedesc")+'</p></div><div><input id="ZPAtt_SPOCGroupName" placeholder="e.g. contract employees"  type="text" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.applicablemembers")+"</label><p> "+ZPI18N.getString("zp.applicablemembersdesc")+'</p></div><div><div class="zpl_gbox"><div class="zpl_idiv"><div><select class="select-js" style="display: none;" id="ZPAtt_SPOCGroupBasedOn"></select></div><div><select class="select-js" style="display: none;" id="ZPAtt_SPOCContOrNotCont"><option value="0">'+ZPI18N.getString("zp.contains")+'</option><option value="1">'+ZPI18N.getString("zp.local.notcontains")+'</option></select></div><div><textarea id="ZPAtt_SPOCUser_AppField_user"></textarea></div><div><textarea id="ZPAtt_SPOCSelectGrpCrit" ></textarea></div></div><div class="zpl_idiv"><a id="ZPAtt_SPOC_AddApplicable" class="zpl_lnkbg">'+ZPI18N.getString("zp.addcriteria")+'</a></div></div> </div></div><div class="zpl_secn selectCriDiv"></div></div><div class="zpl_info"><div><p>'+ZPI18N.getString("zp.spocMappSummary")+"</p></div></div></div></div>",modal=settingsPage.container.find("#cardaddGroupModal");modal.html(html),ZPeopleComponents.select(modal.find("#ZPAtt_SPOCContOrNotCont")),ZPeopleComponents.tokenfield(modal.find("#ZPAtt_SPOCSelectGrpCrit"))},destroyZComp:function(){var modal=settingsPage.container.find("#cardmoduleSettingsPopUP");modal.find("textarea").each(function(){ZPeopleComponents.tokenfield(modal.find("#"+$(this).attr("id"))).destroy()}),modal.find("select").each(function(){ZPeopleComponents.select(modal.find("#"+$(this).attr("id"))).destroy()})},getNoDataMsg:function(){var module=ModuleAdmin.getModule(),msg=ZPI18N.getString("zp.moduleadmin.nodata",[ZPI18N.getString("zp.stimesheet"),"",""]);return"leave"==module?msg=ZPI18N.getString("zp.moduleadmin.nodata",[ZPI18N.getString("zp.sleave"),"",""]):"attendance"==module&&(msg=ZPI18N.getString("zp.moduleadmin.nodata",[ZPI18N.getString("zp.sattendance"),",",ZPI18N.getString("zp.ssingleshift")])),msg}},AppExc={appElements:null,appElementsIndex:null,appLabels:[ZPI18N.getString("zp.locations"),ZPI18N.getString("zp.departments"),ZPI18N.getString("zp.designations"),ZPI18N.getString("zp.roles"),ZPI18N.getString("zp.groups"),ZPI18N.getString("zp.legalentity"),ZPI18N.getString("zp.businessunit"),ZPI18N.getString("zp.division"),ZPI18N.getString("zp.shifts"),ZPI18N.getString("zp.local.Employmenttype")],appElementsKey:["locationList","departmentList","designationList","roleList","groupList","entityList","businessUnitList","divisionList","shiftList","empTypeList"],getApplicableIds:function(isFromGeo,callback){if(null===AppExc.appElements){ZPeople.Request.send(Attendance.Permissions.SETTINGSURL,{mode:"getPermissionApplicable"},function(data){AppExc.appElements=data,isFromGeo?AttPermission.GeoRestriction.loadModal():callback&&callback()})}else isFromGeo?AttPermission.GeoRestriction.loadModal():callback&&callback()},returnApplicableHtml:function(id,isEmpNotNeeded,isBoldTitle){var appToSec='<div class="zpl_secn" id="'+id+'">';if(appToSec+="appToSec"===id?isBoldTitle?'<div><h5><label class="zpl_mtry">'+ZPI18N.getString("zp.applicableto",[""])+"</label></h5></div>":'<div><label class="zpl_mtry">'+ZPI18N.getString("zp.applicableto",[""])+"</label></div>":isBoldTitle?'<div><h5><label class="zpl_mtry">'+ZPI18N.getString("zp.leavetype.exceptions")+"</label></h5></div>":'<div><label class="zpl_mtry">'+ZPI18N.getString("zp.leavetype.exceptions")+"</label></div>",AppExc.isGeoOrIp()&&"appToSec"===id&&(appToSec+='<div id="oldVersionDiv"><div class="zpl_idiv"><div><span>'+ZPI18N.getString("zp.conditonal.desc")+"</span></div>",Timetracker.Util.isCurrentPage(Timetracker.constants.SETTINGS.MODE.REMAINDER)||(appToSec+='<div><select id="andOrOr"></select></div>'),appToSec+="</div></div>"),Att_Common_Operations.isShiftReqPage()||Att_Common_Operations.isEmpShiftMapPage()){if(!Att_Common_Operations.isTeamReqPage())return appToSec+='<div class="zpl_cndor"><div class="zpl_gbox" id="employeeBox"><div class="zpl_idiv" id="addEmpConDiv">',appToSec+='<button class="zpl_lnkbg" onclick="AppExc.addEmpConditionRow(this)">',appToSec+=ZPI18N.getString("zp.addEmplyee")+"</button></div>",isEmpNotNeeded||(appToSec+='<div class="zpl_cndop"><span>'+ZPI18N.getString("zp.captialor")+"</span></div>"),appToSec+="</div>",appToSec+='<div class="zpl_gbox" id="groupGBox">',appToSec+='<div class="zpl_idiv" id="addConDiv">',appToSec+='<button class="zpl_lnkbg" onclick="AppExc.addNewConditionRow(this)">',appToSec+=ZPI18N.getString("zp.addcriteria")+"</button></div></div>",appToSec+="</div></div>"}else appToSec+='<div class="zpl_cndor"><div class="zpl_gbox" id="groupGBox">',appToSec+='<div class="zpl_idiv" id="addConDiv">',appToSec+='<button class="zpl_lnkbg" onclick="AppExc.addNewConditionRow(this)">',appToSec+=ZPI18N.getString("zp.addcriteria")+"</button></div>",isEmpNotNeeded||(appToSec+='<div class="zpl_cndop"><span>'+ZPI18N.getString("zp.captialor")+"</span></div>"),appToSec+="</div>";return isEmpNotNeeded||(appToSec+='<div class="zpl_gbox" id="employeeBox"><div class="zpl_idiv" id="addEmpConDiv">',appToSec+='<button class="zpl_lnkbg" onclick="AppExc.addEmpConditionRow(this)">',appToSec+=ZPI18N.getString("zp.addEmplyee")+"</button></div></div>"),appToSec+="</div></div>"},returnExemptionButton:function(modal,isBoldTitle){var excToSec=isBoldTitle?'<div class="zpl_secn" id="excToButSec"><div><h5>'+ZPI18N.getString("zp.leavetype.exceptions")+"</h5>":'<div class="zpl_secn" id="excToButSec"><div>'+ZPI18N.getString("zp.leavetype.exceptions");return excToSec+='<p id="exempDescBtn">'+ZPI18N.getString("zp.exemptiondesc")+"</p></div>",excToSec+='<div id="addExempDiv"><div class="zpl_idiv">',excToSec+='<a class="zlabel zlabel--blue zlabel--outline zlabel--medium " onclick="',excToSec+=AppExc.permOrIpGeo(modal),excToSec+='.addExemptions(undefined, undefined, true)">',excToSec+=ZPI18N.getString("zp.addcriteria")+"</a></div></div></div>"},showHideAddMoreEle:function(modal,appElementsIndex){var appGrpsMinusBy=Att_Common_Operations.isShiftReqPage()||Att_Common_Operations.isEmpShiftMapPage()||Att_Common_Operations.isManageShiftPage()||LVUtil.Tab.isHoliday()||LVUtil.Tab.isExpWorkingDay()?1:2,appGrps=modal.find("#appToSec #groupGBox").children().length-appGrpsMinusBy,appEmps=modal.find("#appToSec #employeeBox").children().length-1;(Att_Common_Operations.isShiftReqPage()||Att_Common_Operations.isEmpShiftMapPage())&&(appEmps=modal.find("#appToSec #employeeBox").children().length-2);var excGrps=0,excEmps=0,isAddCondDivHidden=!1,isEmpCondDivHidden=!1,isExcSecAvail=!1;void 0!==modal.find("#excToSec")[0]&&(isExcSecAvail=!0,excGrps=modal.find("#excToSec #groupGBox").children().length-appGrpsMinusBy,excEmps=modal.find("#excToSec #employeeBox").children().length-1),void 0!==appElementsIndex?Object.entries(appElementsIndex).length>0?(modal.find("#appToSec #addConDiv button").show(),modal.find("#excToSec #addConDiv button").show()):(modal.find("#appToSec #addConDiv button").hide(),modal.find("#excToSec #addConDiv button").hide(),isAddCondDivHidden=!0):void 0!=modal.find("#appToSec #addConDiv button").attr("style")&&modal.find("#appToSec #addConDiv button").attr("style").includes("display: none")&&(isAddCondDivHidden=!0),appEmps+excEmps===0?(modal.find("#appToSec #addEmpConDiv button").show(),modal.find("#excToSec #addEmpConDiv button").show()):(modal.find("#appToSec #addEmpConDiv button").hide(),modal.find("#excToSec #addEmpConDiv button").hide(),isEmpCondDivHidden=!0),isAddCondDivHidden&&0===appGrps&&isEmpCondDivHidden&&0===appEmps?modal.find("#appToSec").hide():isAddCondDivHidden&&0===appGrps||isEmpCondDivHidden&&0===appEmps?(modal.find("#appToSec").show(),modal.find("#appToSec #groupGBox").parent().removeClass("zpl_cndor"),modal.find("#appToSec #groupGBox .zpl_cndop").hide(),isAddCondDivHidden&&0===appGrps?(modal.find("#appToSec #groupGBox").hide(),modal.find("#appToSec #employeeBox").show()):(modal.find("#appToSec #groupGBox").show(),modal.find("#appToSec #employeeBox").hide())):(modal.find("#appToSec").show(),modal.find("#appToSec #groupGBox").parent().addClass("zpl_cndor"),modal.find("#appToSec #groupGBox .zpl_cndop").show(),modal.find("#appToSec #groupGBox").show(),modal.find("#appToSec #employeeBox").show()),isExcSecAvail?isAddCondDivHidden&&0===excGrps&&isEmpCondDivHidden&&0===excEmps?modal.find("#excToSec").hide():isAddCondDivHidden&&0===excGrps||isEmpCondDivHidden&&0===excEmps?(modal.find("#excToSec").show(),modal.find("#excToSec #groupGBox").parent().removeClass("zpl_cndor"),modal.find("#excToSec #groupGBox .zpl_cndop").hide(),isAddCondDivHidden&&0===excGrps?(modal.find("#excToSec #groupGBox").hide(),modal.find("#excToSec #employeeBox").show()):(modal.find("#excToSec #groupGBox").show(),modal.find("#excToSec #employeeBox").hide())):(modal.find("#excToSec").show(),modal.find("#excToSec #groupGBox").parent().addClass("zpl_cndor"),modal.find("#excToSec #groupGBox .zpl_cndop").show(),modal.find("#excToSec #groupGBox").show(),modal.find("#excToSec #employeeBox").show()):isAddCondDivHidden&&isEmpCondDivHidden?modal.find("#excToButSec").hide():modal.find("#excToButSec").show()},returnConditionRowHtml:function(isEmployee){var newConRow='<div class="zpl_idiv"><select elemType="select" class="select-js" style="display: none;"></select><span>';return newConRow+=ZPI18N.getString("zp.lookup.is")+"</span>",newConRow+=isEmployee?'<textarea id="empSel" elemType="tokenfield"></textarea>':'<z-tokenfield elemType="tokenfield" values="Array"></z-tokenfield>',newConRow+=isEmployee?(Att_Common_Operations.isEmpShiftMapPage()||Att_Common_Operations.isShiftReqPage())&&Att_Common_Operations.isTeamReqPage()?"":'<i class="PI_delete" title='+ZPI18N.getString("zp.delete")+' onclick="AppExc.deleteEmpConditionRow(this)"></i></div>':'<i class="PI_delete" title='+ZPI18N.getString("zp.delete")+' onclick="AppExc.deleteConditionRow(this)"></i></div>'},getSelectCriteriaOptions:function(appElementsIndex){var options=[];return appElementsIndex.forEach(function(value){var obj={};obj.value=value,obj.label=AppExc.appLabels[value],options.push(obj)}),options},getValueForCriteriaOptions:function(appEleKey,label){return getValueForCriteriaOptions(appEleKey,label,!1)},getValueForCriteriaOptions:function(appEleKey,label,isAllOption){var options=[];return(AppExc.isAllOption||isAllOption)&&options.push({value:"0",label:ZPI18N.getString("zp.all")+" "+label}),Object.entries(AppExc.appElements[appEleKey]).forEach(function(val){var obj={};obj.value=val[1].recID,obj.label=val[1].recName,options.push(obj)}),options},getAllValuesToSelect:function(appEleKey){var values=[];return Object.entries(AppExc.appElements[appEleKey]).forEach(function(val){values.push(val[1].recID)}),values},permOrIpGeo:function(modal){return modal?"addPermission"===modal[0].id?"AttConfig.Permissions":"settings-service-shift-autoshiftassignment"===modal[0].id?"AutoShiftAssignment":"AttPermission.GeoAndIpApplicability":"settings/service/timetracker/reminders"===settingsUrlProps.niceUrl?"Timetracker.schedRemindSettings":"settings/service/attendance/hourlyperm"===settingsUrlProps.niceUrl?"AttConfig.Permissions":"settings/service/shift/autoshiftassignment"===settingsUrlProps.niceUrl?"AutoShiftAssignment":"AttPermission.GeoAndIpApplicability"},removeUnApplicableElements:function(appElementsIndex){if("undefined"==typeof AppExc||null==AppExc.appElements||void 0==AppExc.appElements)return appElementsIndex;for(index=0;index<appElementsIndex.length;index++){var key=AppExc.appElementsKey[appElementsIndex[index]],appEle=AppExc.appElements[key];(!appEle||Object.entries(appEle).length<=0)&&(appElementsIndex.splice(index,1),index-=1)}return appElementsIndex},addEmpConditionRow:function(obj,id,valueForCriteriaOptions){obj&&(id=$(obj).closest(".zpl_secn")[0].id);var modal=AppExc.returnModal();modal.find("#"+id+" #addEmpConDiv").before(AppExc.returnConditionRowHtml(!0));var currRow=modal.find("#"+id+" #addEmpConDiv").prev();ZPeopleComponents.select(currRow.find("select").eq(0),{width:"200px"}).addOption([{label:ZPI18N.getString("zp.employee"),value:1}]),ZPeopleComponents.select(currRow.find("select").eq(0)).setValue(1);var extraDtls={skipDefaultValues:!0,submode:"IPGEO_RESTRICTION_SETTINGS",placeHolder:ZPI18N.getString("zp.select")};Timetracker.Util.isCurrentPage(Timetracker.constants.SETTINGS.MODE.REMAINDER)?(extraDtls.submode="TIMETRACKER_SETTINGS",extraDtls.defaultOptionNeeded=!0):Timetracker.Util.isCurrentPage(Timetracker.constants.SETTINGS.MODE.TIMESHEETSCHEDULER)?(extraDtls.submode="TIMETRACKER_SETTINGS",extraDtls.defaultOptionNeeded=!0,extraDtls.useDefaultValuesCache=!0,delete extraDtls.skipDefaultValues):Timetracker.Util.isCurrentPage(Timetracker.constants.SETTINGS.MODE.SPECIFICPOLICY)?(extraDtls.submode="TIMETRACKER_SETTINGS",delete extraDtls.skipDefaultValues,extraDtls.useDefaultValuesCache=!0):AppExc.isCompOffSchdlPage()?(extraDtls.submode="LEAVE_SETTINGS",extraDtls.defaultOptionNeeded=!0):Att_Common_Operations.isTeamReqPage()?extraDtls.submode="ATTENDANCE_ONLY_SUB_USERS":Att_Common_Operations.isShiftAllUsersOperationsPage()?extraDtls.submode="ATTENDANCE_SHIFT_OPR_EDIT":Att_Common_Operations.isEmpShiftMapPage()||Att_Common_Operations.isShiftReqPage()?extraDtls.submode="ATTENDANCE_SHIFT":AppExc.isGeoOrIp()||(extraDtls.submode="ATTENDANCE_SETTINGS"),"absentScheduler"!==modal[0].id&&"shiftRotation"!==modal[0].id||(extraDtls.defaultOptionNeeded=!0);var isAllEmpSelUnsel=extraDtls.defaultOptionNeeded;isAllEmpSelUnsel||!Att_Common_Operations.isEmpShiftMapPage()&&!Att_Common_Operations.isShiftReqPage()||(extraDtls.noMatchMessage=ZPI18N.getString("zp.searchemployee")),"settings-service-shift-autoshiftassignment"==settingsPage.container.attr("id")&&(extraDtls.changeCallback=AutoShiftAssignment.toggleSaveResetButtonOnChange),Timetracker.Search.populateZCompUsers("empSel",void 0,extraDtls,!0,modal),(isAllEmpSelUnsel||Att_Common_Operations.isEmpShiftMapPage()||Att_Common_Operations.isShiftReqPage())&&currRow.find("#empSel").on("ztokenfieldbeforetokenadd",function(obj){AppExc.getZtokenFieldOnchangeForApp(obj,currRow.find("#empSel"))});var values=AppExc.getEmpValues(valueForCriteriaOptions);TimelyZComp.tokenField.addValues(currRow.find("#empSel"),values),AppExc.showHideAddMoreEle(modal)},getEmpHtml:function(){var errHtml=TimelySettings.returnErrHtml(ZPI18N.getString("zp.pleaseselectuser"),"appErr");return`<div class="zpl_secn w400" id="appToSec">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t${`<label for="empSel" tabindex="0" class="zpl_mtry">${ZPI18N.getString("zp.employee")}</label>`}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="empConDiv">\n\t\t\t\t\t\t<textarea id="empSel" elemtype="tokenfield" style="display: none;" data-zbp-bound="true"></textarea>\n\t\t\t\t\t\t${errHtml}\n\t\t\t\t\t</div>\n\t\t\t\t</div>`},populateEmployeeSelect:function(obj,id,valueForCriteriaOptions){obj&&(id=$(obj).closest(".zpl_secn")[0].id);var modal=AppExc.returnModal(),currRow=modal.find("#"+id+" #empConDiv"),extraDtls={skipDefaultValues:!0,submode:"IPGEO_RESTRICTION_SETTINGS",placeHolder:ZPI18N.getString("zp.select")};Timetracker.Util.isCurrentPage(Timetracker.constants.SETTINGS.MODE.REMAINDER)?(extraDtls.submode="TIMETRACKER_DATA",extraDtls.defaultOptionNeeded=!0):Timetracker.Util.isCurrentPage(Timetracker.constants.SETTINGS.MODE.TIMESHEETSCHEDULER)?(extraDtls.submode="TIMETRACKER_DATA",extraDtls.defaultOptionNeeded=!0,delete extraDtls.skipDefaultValues):Timetracker.Util.isCurrentPage(Timetracker.constants.SETTINGS.MODE.SPECIFICPOLICY)?(extraDtls.submode="TIMETRACKER_DATA",delete extraDtls.skipDefaultValues):AppExc.isCompOffSchdlPage()?(extraDtls.submode="LEAVE_SETTINGS",extraDtls.defaultOptionNeeded=!0):Att_Common_Operations.isTeamReqPage()?(extraDtls.submode="ATTENDANCE_ONLY_SUB_USERS",Att_Common_Operations.isEmpShiftMapPage()&&id.includes("appToSec")&&(extraDtls.submode="ATTENDANCE_SHIFT_TEAM_EDIT")):Att_Common_Operations.isShiftAllUsersOperationsPage()?extraDtls.submode="ATTENDANCE_SHIFT_OPR_EDIT":Att_Common_Operations.isEmpShiftMapPage()||Att_Common_Operations.isShiftReqPage()?extraDtls.submode="ATTENDANCE_SHIFT":AppExc.isGeoOrIp()||(extraDtls.submode="ATTENDANCE_SETTINGS"),"absentScheduler"!==modal[0].id&&"shiftRotation"!==modal[0].id&&"addDefPreGroup"!==modal[0].id||(extraDtls.defaultOptionNeeded=!0);var isAllEmpSelUnsel=extraDtls.defaultOptionNeeded;let isOnChangeNeeded=!1;(Att_Common_Operations.isEmpShiftMapPage()||Att_Common_Operations.isShiftReqPage())&&(isOnChangeNeeded=!0,extraDtls.noMatchMessage=ZPI18N.getString("zp.searchemployee")),Timetracker.Search.populateZCompUsers("empSel",void 0,extraDtls,!0,modal),(isAllEmpSelUnsel||isOnChangeNeeded)&&currRow.find("#empSel").on("ztokenfieldbeforetokenadd",function(obj){AppExc.getZtokenFieldOnchangeForApp(obj,currRow.find("#empSel"))});var values=AppExc.getEmpValues(valueForCriteriaOptions);TimelyZComp.tokenField.addValues(currRow.find("#empSel"),values)},getEmpValues:function(valueForCriteriaOptions){var values=[];if(valueForCriteriaOptions)if(1!=valueForCriteriaOptions.length||"0"!=valueForCriteriaOptions[0]&&"-1"!=valueForCriteriaOptions[0]){var empObjects=ZPeople.getUserDetailsByIds(valueForCriteriaOptions);for(var i in valueForCriteriaOptions){var id=valueForCriteriaOptions[i],empObj=ZPeople.getUserDetailsByIdInList(id,empObjects);"-1"==id||"0"==id?values.push({id:id,text:ZPI18N.getString("zp.allemployees"),html:ZPI18N.getString("zp.allemployees"),photo:ZPeople.getDefaultUserImagePath()}):empObj&&empObj.name&&values.push({id:id,text:empObj.empid+" "+empObj.name,html:empObj.empid+" "+empObj.name,photo:empObj.avatar})}}else values.push({id:"0",text:ZPI18N.getString("zp.allemployees"),html:ZPI18N.getString("zp.allemployees"),photo:ZPeople.getDefaultUserImagePath()});return values},addNewConditionRow:function(obj,id,eleIndexVal,valueForCriteriaOptions){var appElementsIndex=AppExc.returnAppElementsIndex();if(appElementsIndex&&0!=appElementsIndex.length){obj&&(id=$(obj).closest(".zpl_secn")[0].id,eleIndexVal=appElementsIndex[0]),void 0===eleIndexVal&&(eleIndexVal=appElementsIndex[0]);var modal=AppExc.returnModal();modal.find("#"+id+" #addConDiv").before(AppExc.returnConditionRowHtml());var currRow=modal.find("#"+id+" #addConDiv").prev(),criSelect=ZPeopleComponents.select(currRow.find("select").eq(0),{change:AppExc.changeOptionsOnChange,width:"200px"});criSelect.addOption(AppExc.getSelectCriteriaOptions(appElementsIndex)),criSelect.setValue(eleIndexVal);var options=AppExc.getValueForCriteriaOptions(AppExc.appElementsKey[eleIndexVal],AppExc.appLabels[eleIndexVal]);options.length;var attr={isLabelHTMLEncoded:!0,sort:!1,dropdownList:{isTextHTMLEncoded:!0}};if("settings-service-shift-autoshiftassignment"==settingsPage.container.attr("id")&&(attr.change=AutoShiftAssignment.toggleSaveResetButtonOnChange),TimelyZComp.tokenField.intialize(currRow.find("z-tokenfield"),attr,!0),TimelyZComp.tokenField.addOptions(currRow.find("z-tokenfield"),options),AppExc.isAllOption&&currRow.find("z-tokenfield").on("ztokenfieldbeforetokenadd",function(obj){AppExc.getZtokenFieldOnchangeForApp(obj,currRow.find("z-tokenfield"))}),valueForCriteriaOptions)if("all"===valueForCriteriaOptions)TimelyZComp.tokenField.setValues(currRow.find("z-tokenfield"),AppExc.getAllValuesToSelect(AppExc.appElementsKey[eleIndexVal]));else{var criteriaOptionObj=AppExc.getObjectFromArrofId(options,valueForCriteriaOptions);TimelyZComp.tokenField.addTokens(currRow.find("z-tokenfield"),criteriaOptionObj)}AppExc.addAndRemoveOption(modal.find("#appToSec #groupGBox").find(".zpl_idiv"),currRow.find("select").eq(0)[0],-1,eleIndexVal),AppExc.addAndRemoveOption(modal.find("#excToSec #groupGBox").find(".zpl_idiv"),currRow.find("select").eq(0)[0],-1,eleIndexVal),AppExc.spliceCurrVal(appElementsIndex,eleIndexVal),AppExc.showHideAddMoreEle(modal,appElementsIndex)}},getObjectFromArrofId:function(objects,idArr){var idSet=new Set(idArr),resultObj=[];for(var obj of objects)void 0!=obj&&idSet.has(obj.value)&&resultObj.push(obj);return resultObj},getZtokenFieldOnchangeForApp:function(obj,ele){if($(obj)[0].originalEvent&&$(obj)[0].originalEvent.detail.fromUI){TimelyZComp.tokenField.getValues(obj.target);"0"===obj.detail.tokenData.value?TimelyZComp.tokenField.deSelectAll(ele):TimelyZComp.tokenField.deSelect(ele,["0"]),(Att_Common_Operations.isEmpShiftMapPage()||Att_Common_Operations.isShiftReqPage())&&Att_Common_Operations.hideAppToErr(AppExc.returnModal())}},changeOptionsOnChange:function(event){var data=event.detail;if(data.fromUI){var prevVal=Number(data.previousValue),currVal=Number(data.selectedValue);if(TimelyZComp.tokenField.removeAllTokens(data.element.closest(".zpl_idiv").find("z-tokenfield")),-1!==prevVal&&AppExc.getOptionForVal(prevVal),-1!==currVal){ZPeopleComponents.select(data.element).setValue(currVal);var options=AppExc.getValueForCriteriaOptions(AppExc.appElementsKey[currVal],AppExc.appLabels[currVal]);options.length,TimelyZComp.tokenField.destroy(data.element.closest(".zpl_idiv").find("z-tokenfield"));TimelyZComp.tokenField.intialize(data.element.closest(".zpl_idiv").find("z-tokenfield"),{isLabelHTMLEncoded:!0,sort:!1,dropdownList:{isTextHTMLEncoded:!0}},!0),TimelyZComp.tokenField.addOptions(data.element.closest(".zpl_idiv").find("z-tokenfield"),options),AppExc.spliceCurrVal(AppExc.returnAppElementsIndex(),currVal)}var modal=AppExc.returnModal();AppExc.addAndRemoveOption(modal.find("#appToSec #groupGBox").find(".zpl_idiv"),data.element[0],prevVal,currVal),AppExc.addAndRemoveOption(modal.find("#excToSec #groupGBox").find(".zpl_idiv"),data.element[0],prevVal,currVal)}},spliceCurrVal:function(appElementsIndex,eleIndexVal){appElementsIndex.splice(appElementsIndex.indexOf(eleIndexVal),1)},addAndRemoveOption:function(zplDiv,changedEle,prevVal,currVal){for(var index=0;index<zplDiv.length-1;index++){var selEle=zplDiv.eq(index).find("select").eq(0);selEle[0]!==changedEle&&(-1!==prevVal&&ZPeopleComponents.select(selEle).addOption(AppExc.getOptionForVal(prevVal)),-1!==currVal&&ZPeopleComponents.select(selEle).removeOption([currVal]))}},deleteEmpConditionRow:function(obj){ZPeopleComponents.select($(obj).prev().prev()).destroy(),$(obj).closest(".zpl_idiv").remove();var modal=AppExc.returnModal();AppExc.showHideAddMoreEle(modal)},deleteConditionRow:function(obj){var remOp=Number(ZPeopleComponents.select($(obj).closest(".zpl_idiv").find("select").eq(0)).getValue());$(obj).closest(".zpl_secn")[0].id;$(obj).closest(".zpl_idiv").remove();var modal=AppExc.returnModal();if(-1!==remOp){AppExc.getOptionForVal(remOp);AppExc.showHideAddMoreEle(modal,AppExc.returnAppElementsIndex()),AppExc.addAndRemoveOption(modal.find("#appToSec #groupGBox").find(".zpl_idiv"),void 0,remOp,-1),AppExc.addAndRemoveOption(modal.find("#excToSec #groupGBox").find(".zpl_idiv"),void 0,remOp,-1)}else AppExc.showHideAddMoreEle(modal,AppExc.returnAppElementsIndex())},getOptionForVal:function(prevVal){var option=[],optObj={};return optObj.value=prevVal,optObj.label=AppExc.appLabels[prevVal],option.push(optObj),AppExc.returnAppElementsIndex().includes(prevVal)||AppExc.appElementsIndex.push(prevVal),option},returnAppElementsIndex:function(){return AppExc.appElementsIndex},isGeoOrIp:function(){var modal=AppExc.returnModal();return!(!modal||!modal[0]||"addGeoRestriction"!==modal[0].id&&"addIPRestriction"!==modal[0].id)},isCompOffSchdlPage:function(){return-1!==settingsUrlProps.niceUrl.indexOf("leavetracker/compensatoryoffscheduler")},returnModal:function(){var modal;return settingsPage.container.find("#addGeoRestriction")[0]?modal=settingsPage.container.find("#addGeoRestriction"):settingsPage.container.find("#addIPRestriction")[0]?modal=settingsPage.container.find("#addIPRestriction"):settingsPage.container.find("#tssettings-addreminderdiv")[0]?modal=settingsPage.container.find("#tssettings-addreminderdiv"):settingsPage.container.find("#addPermission")[0]?modal=settingsPage.container.find("#addPermission"):settingsPage.container.find("#absentScheduler")[0]?modal=settingsPage.container.find("#absentScheduler"):settingsPage.container.find("#addDefPreGroup")[0]?modal=settingsPage.container.find("#addDefPreGroup"):settingsPage.container.find("#ttAddUserSettings")[0]?modal=settingsPage.container.find("#ttAddUserSettings"):settingsPage.container.find("#tssettings-addschdiv")[0]?modal=settingsPage.container.find("#tssettings-addschdiv"):settingsPage.container.find("#addShift")[0]?modal=settingsPage.container.find("#addShift"):settingsPage.container.find("#shiftRotation")[0]?modal=settingsPage.container.find("#shiftRotation"):settingsPage.container.find("#addCompOffSchdl")[0]?modal=settingsPage.container.find("#addCompOffSchdl"):settingsPage.container.find("#shftmapping")[0]?modal=settingsPage.container.find("#shftmapping"):settingsPage.container.find("#moduleCards")[0]?modal=settingsPage.container.find("#moduleCards"):settingsPage.container.find("#otPolicyModal")[0]?modal=settingsPage.container.find("#otPolicyModal"):"settings-service-shift-autoshiftassignment"==settingsPage.container.attr("id")&&(modal=settingsPage.container),modal},setAppIndex:function(apElIndex,isAllOption){AppExc.appElementsIndex=apElIndex,AppExc.isAllOption=isAllOption},returnSpecificUserAllUserHtml:function(){var html='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.lms.settings.applicableto")+"</label></div>";return html+='<div><div class="zradiobutton zradiobutton--horizontal">',html+='<input type="radio" name="permApplicable" id="permAllUsers" onchange="',html+=AppExc.permOrIpGeo(),html+='.toggleAppFor()" class="zradiobutton__helper"><label class="zradiobutton__label" for="permAllUsers">',html+='<span class="zradiobutton__text">'+ZPI18N.getString("zp.permissionallusers")+"</span></label></div>",html+='<div class="zradiobutton zradiobutton--horizontal">',html+='<input type="radio" name="permApplicable" id="permSpecUsers" onchange="',html+=AppExc.permOrIpGeo(),html+='.toggleAppFor()" class="zradiobutton__helper"><label class="zradiobutton__label" for="permSpecUsers">',html+='<span class="zradiobutton__text">'+ZPI18N.getString("zp.permissionspecificusers")+"</span></label></div>",html+=TimelySettings.returnErrHtml(ZPI18N.getString("zp.applicablemandat"))+"</div></div>"},constructAppValues:function(modal,appOrExcId,storingKey,isNoValAvailReq,defValue){var isAllUsers=!!modal.find("#permAllUsers")[0]&&modal.find("#permAllUsers")[0].checked,appGroup=modal.find(appOrExcId+" #groupGBox .zpl_idiv"),appOrExcFor={},isNoValueForRoleDepDesgLoc=!0;storingKey.forEach(function(key){appOrExcFor[key]=[]});var isNoValAvail=!0;$.each(appGroup,function(index){if(""===appGroup.eq(index)[0].id){var key=storingKey[ZPeopleComponents.select(appGroup.eq(index).find("select").eq(0)).getValue()],value=isAllUsers?[]:TimelyZComp.tokenField.getValues(appGroup.eq(index).find("z-tokenfield"));appOrExcFor[key]=value,value.length>0&&(isNoValAvail=!1,isNoValueForRoleDepDesgLoc=!1)}});var userKey="addGeoRestriction"===modal[0].id?"users":"user";if(appOrExcFor[userKey]=[],modal.find(appOrExcId+" #employeeBox .zpl_idiv").length>1||"addDefPreGroup"===modal[0].id||"shftmapping"===modal[0].id&&!Att_Common_Operations.isSingleUserTeamPage()&&(Att_Common_Operations.isShiftAllUsersOperationsPage()||Att_Common_Operations.isOperationsShiftMappingPage())){var userVal=modal.find("#empSel").length>0?TimelyZComp.tokenField.getValues(modal.find("#empSel")):[];userVal.length>0&&(isNoValAvail=!1),userVal.length>0?appOrExcFor[userKey]=userVal:(Timetracker.Util.isCurrentPage(Timetracker.constants.SETTINGS.MODE.REMAINDER)||Timetracker.Util.isCurrentPage(Timetracker.constants.SETTINGS.MODE.TIMESHEETSCHEDULER))&&(appOrExcFor[userKey]=["0"]),isAllUsers&&(appOrExcFor[userKey]=[])}return isNoValueForRoleDepDesgLoc&&!isNoValAvail&&void 0!=defValue&&storingKey.forEach(function(key){appOrExcFor[key]=[defValue]}),isNoValAvail&&isNoValAvailReq&&(appOrExcFor.isNoValAvail=!0),appOrExcFor}},TimelySettings={SHOWSAVERESET:1,SHOWSAVING:2,SHOWSAVED:3,SHOWNOTHING:4,showFilters:function(){var page=settingsPage.container,pageId=page[0].id;if("settings-service-attendance-break"===pageId&&0===TimelyZComp.tokenField.getOptions(page.find("#appShifts")).length)TimelyZComp.tokenField.addOptions(page.find("#appShifts"),ShiftBreakCommon.returnShiftOptions());else if("settings-service-timetracker-break"===pageId&&0===TimelyZComp.tokenField.getOptions(settingsPage.container.find("#breakTTLocs")).length){var filterparam=Timetracker.Filters.getParamsForFilter("TTBreak");TimelyZComp.tokenField.addOptions(page.find("#breakTTLocs"),Timetracker.Util.constZPLocFilter("breakTTLocs",filterparam,{isMultiple:!0},page,!0))}page.addClass("zpl_fltr_flt");var filterId="#policyFilter";"settings-service-timetracker-break"===pageId||"settings-service-attendance-break"===pageId?filterId="#payType"+BreakConfig.pageIDForZcomp:"settings-service-shift-shiftpattern"===pageId&&(filterId="#patternTypesOptn"),ZPeopleComponents.select(page.find(filterId)).setFocus()},getFilterShowIcon:function(){return'<i class="zpl_ibg PI_fltr" title='+ZPI18N.getString("zp.filter")+' onclick="TimelySettings.showFilters()"></i>'},closeFilter:function(){settingsPage.container.removeClass("zpl_fltr_flt")},getFilterHtml:function(){var html='<div class="zpl_fltr"><div><div class="zpl_fltrhd"><h5>'+ZPI18N.getString("zp.filter")+"</h5>";return html+='<i class="PI_cls" title='+ZPI18N.getString("zp.close")+' onclick="TimelySettings.closeFilter()"></i></div></div>'},appendTopFilterHtml:function(){var page=settingsPage.container,html='<div class="zpl_fltrvw"><div><ul class="zpl_fltrvwlst"></ul></div>';html+='<div class="d-flexcap MLauto"><a onclick="TimelySettings.topFilterClearAll()">'+ZPI18N.getString("zp.files.reset")+"</a></div></div>",page.find(".zpl_btnmnu").after(html),page.hasClass("zpl_tblfxd")&&page.addClass("zpl_fltrvwfxd")},topFilterClearAll:function(){TimelySettings.resetFilterValues(),TimelySettings.constructBasedOnFilters()},showHideTopBand:function(isShow){isShow?settingsPage.container.find(".zpl_topcrdhdr").show():settingsPage.container.find(".zpl_topcrdhdr").hide()},constructTopBand:function(prop){var page=settingsPage.container;prop.isInsideRgtCnt&&page.append('<div class="zpl_rgtcnt"></div>'),TimelySettings.consTopSettMenu(!0,prop.topOnclick,prop.topOnclickTxt,prop.isInsideRgtCnt);var html='<div class="zpl_crd zpl_topcrdhdr"><div class="zpl_crdhdr"><div><h4>';html+=prop.hdrTxt+"</h4><p>"+prop.descTxt+"</p>",void 0!=prop.appInfo&&(html+='<div class=zpl_secn"><p class="zpl_info"><em>'+prop.appInfo,html+="</em></p></div>"),html+="</div></div></div>",page.find("#topSettMenu").before(html),page.find(".zpl_topcrdhdr").hide(),prop.consRgtCnt&&(prop.isInsideRgtCnt?page.find(".zpl_rgtcnt").append('<div class="zpl_tblres"></div>'):page.append('<div class="zpl_rgtcnt"><div class="zpl_tblres"></div></div>')),1!=prop.noLoadingIcon&&TimelySettings.showHideLoadingPage(!0)},consTopSettMenu:function(isHide,topOnclick,topOnclickTxt,isInsideRgtCnt){var page=settingsPage.container;if(void 0===page.find("#topSettMenu")[0]){var html='<div class="zpl_btnmnu" id="topSettMenu">';void 0!=topOnclick&&(html+='<div class="zpl_rgt">',html+='<button class="zlabel zlabel--blue zlabel--medium" onclick="'+topOnclick+'">',html+=topOnclickTxt+"</button></div>"),html+="</div>",isInsideRgtCnt?page.find(".zpl_rgtcnt").append(html):page.append(html),isHide&&page.find("#topSettMenu").hide()}},constructTopFilter:function(){var page=settingsPage.container,pageId=page[0].id;if(page.find(".zpl_fltrvw").remove(),page.removeClass("zpl_fltrvwfxd"),"settings-service-attendance-attspecificpolicy"===pageId)"0"!==ZPeopleComponents.select(page.find("#policyFilter")).getValue()&&(TimelySettings.appendTopFilterHtml(),TimelySettings.appendTopFilterValues("#policyFilter","0",!1));else if("settings-service-attendance-break"===pageId){var payType=ZPeopleComponents.select(page.find("#payType"+BreakConfig.pageIDForZcomp)).getValue(),breakMode=ZPeopleComponents.select(page.find("#breakMode"+BreakConfig.pageIDForZcomp)).getValue(),appShifts=TimelyZComp.tokenField.getValues(page.find("#appShifts"));("2"!==payType||"0"!==breakMode||appShifts.length>0)&&(TimelySettings.appendTopFilterHtml(),TimelySettings.appendTopFilterValues("#payType"+BreakConfig.pageIDForZcomp,"2",!1),TimelySettings.appendTopFilterValues("#breakMode"+BreakConfig.pageIDForZcomp,"0",!1),TimelySettings.appendTopFilterValues("#appShifts","",!0))}else if("settings-service-timetracker-break"===pageId){payType=ZPeopleComponents.select(page.find("#payType"+BreakConfig.pageIDForZcomp)).getValue(),breakMode=ZPeopleComponents.select(page.find("#breakMode"+BreakConfig.pageIDForZcomp)).getValue();var appLocationList=TimelyZComp.tokenField.getValues(page.find("#breakTTLocs"));("2"!==payType||"0"!==breakMode||appLocationList.length>0)&&(TimelySettings.appendTopFilterHtml(),TimelySettings.appendTopFilterValues("#payType"+BreakConfig.pageIDForZcomp,"2",!1),TimelySettings.appendTopFilterValues("#breakMode"+BreakConfig.pageIDForZcomp,"0",!1),TimelySettings.appendTopFilterValues("#breakTTLocs","",!0))}else if("settings-service-shift-shiftpattern"===pageId){"0"!=ZPeopleComponents.select(page.find("#patternTypesOptn")).getValue()&&(TimelySettings.appendTopFilterHtml(),TimelySettings.appendTopFilterValues("#patternTypesOptn","0",!1))}else if("operations-shift-mapshiftpattern"===pageId){let userIdValues,patternIdValues,patternTypeValues,filterDivId=Att_Common_Operations.getFilterDivId(),showFilterResetView=!1;void 0!=ZPeopleComponents.datefield($(`#${filterDivId}FromDate`))&&((userIdValues=ZPeopleComponents.tokenfield($(`#${filterDivId}FilterEmployee`)).getAllValues())&&0!=userIdValues.length&&""!=userIdValues&&(showFilterResetView=!0),(patternIdValues=ZPeopleComponents.tokenfield($(`#${filterDivId}FilterPattern`)).getAllValues())&&0!=patternIdValues.length&&""!=patternIdValues&&(showFilterResetView=!0),(patternTypeValues=ZPeopleComponents.tokenfield($(`#${filterDivId}FilterPatternType`)).getAllValues())&&0!=patternTypeValues.length&&""!=patternTypeValues&&(showFilterResetView=!0)),showFilterResetView&&(TimelySettings.appendTopFilterHtml(),TimelySettings.appendTopFilterValues("#"+filterDivId+"FilterEmployee","",!0),TimelySettings.appendTopFilterValues("#"+filterDivId+"FilterPattern","",!0),TimelySettings.appendTopFilterValues("#"+filterDivId+"FilterPatternType","",!0))}else if(Att_Common_Operations.isRequestPage()||Att_Common_Operations.isEmpShiftMapPage()){var regReason,entityObj,bUnitObj,divisionObj,employees,empProfiles,locObj,depObj,desgnObj,shiftObj,filterId=Att_Common_Operations.getFilterDivId(),period=ZPeopleComponents.select(page.find("#"+filterId+"FilterPeriod")).getValue();Att_Common_Operations.isRegReqPage()&&regularization_operation.isRegReasonsEnabled()&&(regReason=ZPeopleComponents.select(page.find("#"+filterId+"FilterReason")).getValue()),Att_Common_Operations.isSelfReqPage()||(employees=ZPeopleComponents.tokenfield(page.find("#"+filterId+"FilterEmployee")).getAllValues(),landingPageURL.includes("operations")&&!Att_Common_Operations.isEmpShiftMapPage()&&(empProfiles=ZPeopleComponents.tokenfield(page.find("#"+filterId+"FilterEmpProfile")).getAllValues()),locObj=ZPeopleComponents.tokenfield(page.find("#"+filterId+"FilterLoc")).getAllValues(),depObj=ZPeopleComponents.tokenfield(page.find("#"+filterId+"FilterDep")).getAllValues(),desgnObj=ZPeopleComponents.tokenfield(page.find("#"+filterId+"FilterDesgn")).getAllValues(),isOrgStructureEnabled&&(ZPeople.orgStructureTagMap.entity&&(entityObj=ZPeopleComponents.tokenfield(page.find("#"+filterId+"FilterEntity")).getAllValues()),ZPeople.orgStructureTagMap.unit&&(bUnitObj=ZPeopleComponents.tokenfield(page.find("#"+filterId+"FilterBUnit")).getAllValues()),ZPeople.orgStructureTagMap.division&&(divisionObj=ZPeopleComponents.tokenfield(page.find("#"+filterId+"FilterDivision")).getAllValues()))),(Att_Common_Operations.isShiftReqPage()||Att_Common_Operations.isEmpShiftMapPage())&&(shiftObj=ZPeopleComponents.tokenfield(page.find("#"+filterId+"FilterShift")).getAllValues()),(""!==period&&!Att_Common_Operations.isEmpShiftMapPage()||employees&&employees.length>0||empProfiles&&empProfiles.length>0||locObj&&0!=locObj.length||depObj&&0!=depObj.length||desgnObj&&0!=desgnObj.length||entityObj&&0!=entityObj.length||bUnitObj&&0!=bUnitObj.length||divisionObj&&0!=divisionObj.length||regReason&&"-3"!==regReason||shiftObj&&0!=shiftObj.length)&&(TimelySettings.appendTopFilterHtml(),Att_Common_Operations.isEmpShiftMapPage()||0==period||TimelySettings.appendTopFilterValues("#"+filterId+"FilterPeriod","",!1),regReason&&"-3"!==regReason&&TimelySettings.appendTopFilterValues("#"+filterId+"FilterReason","-3",!1),(Att_Common_Operations.isShiftReqPage()||Att_Common_Operations.isEmpShiftMapPage())&&TimelySettings.appendTopFilterValues("#"+filterId+"FilterShift","",!0),Att_Common_Operations.isSelfReqPage()||(TimelySettings.appendTopFilterValues("#"+filterId+"FilterEmployee","",!0),landingPageURL.includes("operations")&&!Att_Common_Operations.isEmpShiftMapPage()&&TimelySettings.appendTopFilterValues("#"+filterId+"FilterEmpProfile","",!0),TimelySettings.appendTopFilterValues("#"+filterId+"FilterLoc","",!0),TimelySettings.appendTopFilterValues("#"+filterId+"FilterDep","",!0),TimelySettings.appendTopFilterValues("#"+filterId+"FilterDesgn","",!0),isOrgStructureEnabled&&(ZPeople.orgStructureTagMap.entity&&TimelySettings.appendTopFilterValues("#"+filterId+"FilterEntity","",!0),ZPeople.orgStructureTagMap.unit&&TimelySettings.appendTopFilterValues("#"+filterId+"FilterBUnit","",!0),ZPeople.orgStructureTagMap.division&&TimelySettings.appendTopFilterValues("#"+filterId+"FilterDivision","",!0)))),Att_Common_Operations.isEmpShiftMapPage()||page.find(".zpl_fltrvwlst")&&0==page.find(".zpl_fltrvwlst").children().length&&(page.find(".zpl_fltrvw").remove(),page.removeClass("zpl_fltrvwfxd"))}},removeFilterValue:function(obj){var page=settingsPage.container,id="#"+obj.id.replace("TopVal","");if("true"===$(obj).attr("isTokenField"))TimelyZComp.tokenField.deSelectAll(page.find(id));else{var defValue=$(obj).attr("defValue");""==defValue?ZPeopleComponents.select(page.find(id)).deselectAllOptions():ZPeopleComponents.select(page.find(id)).setValue(defValue)}TimelySettings.constructBasedOnFilters()},appendTopFilterValues:function(id,defValue,isTokenField){var page=settingsPage.container,selEle=page.find(id),pageId=page[0].id,btnId=(id=id.replace("#",""))+"Btn";id+="TopVal";var val,label="";if(isTokenField){if((val=TimelyZComp.tokenField.getValues(selEle)).length>0){var labelKey=ZPeopleComponents.tokenfield(selEle).getAttribute("dataMapping");(Att_Common_Operations.isRequestPage()||Att_Common_Operations.isEmpShiftMapPage()||"operations-shift-mapshiftpattern"===pageId)&&-1!==id.indexOf("FilterEmployee")?ZPeopleComponents.tokenfield(selEle).getAttribute("values").forEach(function(currOption){currOption[labelKey.id]===val[0]&&(label=decodeHTML(currOption[labelKey.text]))}):TimelyZComp.tokenField.getOptions(selEle).forEach(function(currOption){currOption[labelKey.id]===val[0]&&(label=currOption[labelKey.text])})}}else(val=ZPeopleComponents.select(selEle).getValue())!==defValue&&ZPeopleComponents.select(selEle).getOptions().forEach(function(currOption){currOption.value===val&&(label=currOption.label)});if(""!==label){var filters="<li><label>"+selEle.parent().prev().find("label").html()+" :</label> <span>"+$("<div/>").text(label).html()+"</span>";isTokenField&&val.length>1&&(filters+='<sub id="'+btnId+'" onclick="TimelySettings.appendAdditionalValues(this)">+'+(val.length-1)+"</sub>"),filters+='<a class="PI_cls" id="'+id+'" defValue="'+defValue+'" isTokenField='+isTokenField+' onclick="TimelySettings.removeFilterValue(this)"></a></li>',page.find(".zpl_fltrvw ul").append(filters)}},appendAdditionalValues:function(obj){obj=$(obj).closest("li").find("sub")[0];var page=settingsPage.container,selEle=(page[0].id,page.find("#"+obj.id.replace("Btn",""))),val=TimelyZComp.tokenField.getValues(selEle);0!==$("#filterAdditional_list").length&&(ZPeopleComponents.menu("#filterAdditional_list").destroy(),$("#filterAdditional_list").remove());var addValHtml='<div id="filterAdditional_list" class="zpl_drpdwn zpl_fltrvwlst"><ul>';(Att_Common_Operations.isRequestPage()||Att_Common_Operations.isEmpShiftMapPage())&&-1!==obj.id.indexOf("FilterEmployee")?val.forEach(function(currVal,index){0!==index&&(addValHtml+='<li class="zmenu_item zmenu_custom"><span>',ZPeopleComponents.tokenfield(selEle).getAttribute("values").forEach(function(currOption){currOption.id===val[index]&&(addValHtml+=$("<div/>").text(decodeHTML(currOption.html)).html())}),addValHtml+="</span></li>")}):val.forEach(function(currVal,index){0!==index&&(addValHtml+='<li class="zmenu_item zmenu_custom"><span>',TimelyZComp.tokenField.getOptions(selEle).forEach(function(currOption){currOption.value===val[index]&&(addValHtml+=$("<div/>").text(currOption.label).html())}),addValHtml+="</span></li>")}),addValHtml+="</ul></div>",page.append(addValHtml),ZPeopleComponents.menu("#filterAdditional_list",{forElement:"#"+obj.id,appendTo:page}),ZPeopleComponents.menu("#filterAdditional_list").show()},constructBasedOnFilters:function(){var page=settingsPage.container,pageId=page[0].id;"settings-service-attendance-attspecificpolicy"===pageId?AttPolicy.SpecificPolicy.constructData(ZPeopleComponents.select(page.find("#policyFilter")).getValue(),!0):"settings-service-attendance-break"===pageId?(BreakConfig.breakList=null,BreakConfig.getData(!1,!0)):"settings-service-timetracker-break"===pageId?(Timetracker.Break.breakDetails=null,BreakConfig.getData(!1,!0)):Att_Common_Operations.isODReqPage()?onduty.getRequest(!1,!0):Att_Common_Operations.isRegReqPage()?regularization_operation.getData(!1,!0):Att_Common_Operations.isPermReqPage()?permission.getRequest(!1,!0):Att_Common_Operations.isShiftReqPage()?shiftRequest.getShiftMapRequest(!1,!0):Att_Common_Operations.isAutoShiftReqPage()?AutoAssignShiftRequest.getShiftMapRequest(!1,!0):Att_Common_Operations.isEmpShiftMapPage()?shiftMapping.getToggleSearch():"settings-service-shift-shiftpattern"===pageId?ShiftPatterns.getPatternData():"operations-shift-mapshiftpattern"===pageId&&ShiftPatternApplicability.getApplicableData(!1),TimelySettings.closeFilter()},resetFilterValues:function(){var page=settingsPage.container,pageId=page[0].id;"settings-service-attendance-attspecificpolicy"===pageId?ZPeopleComponents.select(page.find("#policyFilter")).setValue(0):"settings-service-attendance-break"===pageId||"settings-service-timetracker-break"===pageId?(ZPeopleComponents.select(page.find("#payType"+BreakConfig.pageIDForZcomp)).setValue(2),ZPeopleComponents.select(page.find("#breakMode"+BreakConfig.pageIDForZcomp)).setValue(0),"settings-service-timetracker-break"===pageId?TimelyZComp.tokenField.deSelectAll(page.find("#breakTTLocs")):TimelyZComp.tokenField.deSelectAll(page.find("#appShifts"))):Att_Common_Operations.isRequestPage()||Att_Common_Operations.isEmpShiftMapPage()?Att_Common_Operations.resetFilterOptions():"settings-service-shift-shiftpattern"===pageId?ShiftPatterns.resetPatternFilter():"operations-shift-mapshiftpattern"===pageId&&ShiftPatternApplicability.resetFilterOptions()},getFilterButtons:function(){var html='<div><button type="button" class="zlabel zlabel--blue zlabel--medium" ';return html+='onclick="TimelySettings.constructBasedOnFilters()">'+ZPI18N.getString("zp.apply")+"</button>",html+='<button type="button" class="zlabel zlabel--outline zlabel--medium" ',html+='onclick="TimelySettings.resetFilterValues()">'+ZPI18N.getString("zp.reset")+"</button></div>"},showHidePermissionDenied:function(isShow){var page=settingsPage.container;isShow?(PermissionDenied.show(),TimelySettings.showHideLoadingPage(!1),page.find(".zpl_rgtcnt").hide()):(PermissionDenied.remove(),page.find(".zpl_rgtcnt").show())},showHideLoadingPage:function(isShow,apndToPageChilde,divID){var page=settingsPage.container;isShow?divID?page.find("#"+divID).append(ZPeople.LOADING_HTML):apndToPageChilde?(page.find(".zpl_container").append(ZPeople.LOADING_HTML),page.find(".zpl_container .zpl_iwrpr").hide()):(page.append(ZPeople.LOADING_HTML),page.find(".zpl_rgtcnt").hide()):(page.find("#zp_page_loading").remove(),apndToPageChilde?page.find(".zpl_container .zpl_iwrpr").show():page.find(".zpl_rgtcnt").show()),load=null},getTopFilterHtml:function(){var html='<div class="zpl_fltrvw" style="margin-top: 20px;"><div><ul class="zpl_fltrvwlst"></ul></div>';return html+='<div class="d-flexcap MLauto"><a class="red">'+ZPI18N.getString("zp.clearAll")+"</a></div></div>"},getSortHtml:function(id,isAddAsc){var html='<div class="zpl_icncnt" onclick="TimelySettings.sort(this)">';html+='<i class="PI_sort';var title=isAddAsc?ZPI18N.getString("zp.sortbyasc"):ZPI18N.getString("zp.sortbydesc");return isAddAsc&&(html+=" asc"),html+='"  title="'+title+'" id="'+id+'"></i><div>'},sort:function(obj){obj=$(obj).find("i")[0],$(obj).hasClass("PI_sort asc")?$(obj).attr({class:"PI_sort desc",title:ZPI18N.getString("zp.sortbyasc")}):$(obj).attr({class:"PI_sort asc",title:ZPI18N.getString("zp.sortbydesc")});var page=settingsPage.container,pageId=page[0].id;"settings-service-shift-manage"===pageId||"settings-service-shifts-manageshifts"===pageId||"settings-service-shift-manageshifts"===pageId||"operations-shift-manageshifts"===pageId?("shiftNameSort"===obj.id?page.find("#shiftTimeSort").attr("class","PI_sort"):"shiftTimeSort"===obj.id&&page.find("#shiftNameSort").attr("class","PI_sort"),ShiftConfig.Shift.shiftList=null,ShiftConfig.Shift.getData()):"settings-service-attendance-break"===pageId||"settings-service-timetracker-break"===pageId?("breakNameSort"===obj.id?page.find("#breakTimeSort").attr("class","PI_sort"):"breakTimeSort"===obj.id&&page.find("#breakNameSort").attr("class","PI_sort"),BreakConfig.isTTBreakPage()?Timetracker.Break.breakDetails=null:BreakConfig.breakList=null,BreakConfig.getData()):"settings-service-shift-rotation"===pageId?("shiftRotNameSort"===obj.id?page.find("#shiftRotTimeSort").attr("class","PI_sort"):"shiftRotTimeSort"===obj.id&&page.find("#shiftRotNameSort").attr("class","PI_sort"),ShiftAuto.ShiftRotation.rotationList=null,ShiftAuto.ShiftRotation.getData()):"settings-service-attendance-attspecificpolicy"===pageId?(AttPolicy.SpecificPolicy.settingsList=null,AttPolicy.SpecificPolicy.getData()):"settings-service-attendance-absentscheduler"===pageId?("absSchNameSort"===obj.id?page.find("#absSchDateSort").attr("class","PI_sort"):"absSchDateSort"===obj.id&&page.find("#absSchNameSort").attr("class","PI_sort"),AttAuto.AbsentSch.scheduleList=null,AttAuto.AbsentSch.getData()):"settings-service-attendance-defaultpresent"===pageId&&("grpNameSort"===obj.id?(page.find("#effecFromSort").attr("class","PI_sort"),page.find("#effecTillSort").attr("class","PI_sort")):"effecFromSort"===obj.id?(page.find("#grpNameSort").attr("class","PI_sort"),page.find("#effecTillSort").attr("class","PI_sort")):"effecTillSort"===obj.id&&(page.find("#grpNameSort").attr("class","PI_sort"),page.find("#effecFromSort").attr("class","PI_sort")),AttAuto.DefPresent.defPreList=null,AttAuto.DefPresent.getData())},returnUsersOptions:function(specificUsers){var options=[];return FormsCommon.getPrimaryLookupValues(3).forEach(function(currUser){var obj={};specificUsers&&!specificUsers.includes(currUser.Id)||(obj.label=decodeHTML(currUser.Value),obj.value=currUser.Id,options.push(obj))}),options},initializeDateField:function(obj,onchange){var effectiveDateOptions={calendarIcon:!0,calendarIconUIType:"button",showPickerOnFocus:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none",change:onchange};ZPeopleComponents.datefield(obj,effectiveDateOptions)},returnErrHtml:function(message,id){var html='<span class="ztextbox--error__label" style="display: none;"';return id&&(html+='id="'+id+'"'),html+=">"+message+"</span>"},returnSavingHdr:function(){var html='<div id="savingHdr"><div class="zpl_atosv"><div class="zpl_atocnt"><div class="zpl_atoprg"><div></div>';return html+='<div></div><div></div><div></div><div></div></div><i class="PI_tick2"></i><span>',html+=ZPI18N.getString("zp.saving")+"</span></div></div></div>"},showHideSaveReset:function(crdHdr,type){"settings-service-attendance-attspecificpolicy"!==settingsPage.container[0].id&&(type===TimelySettings.SHOWSAVING?(crdHdr.find("#savingHdr .zpl_atocnt").removeClass("svd"),crdHdr.find("#savingHdr span").text(ZPI18N.getString("zp.saving")),crdHdr.find("#savingHdr").show(),crdHdr.find("#saveResetButton").hide()):type===TimelySettings.SHOWSAVED?(crdHdr.find("#savingHdr .zpl_atocnt").addClass("svd"),crdHdr.find("#savingHdr span").text(ZPI18N.getString("zp.saved")),crdHdr.find("#savingHdr").show(),crdHdr.find("#saveResetButton").hide()):type===TimelySettings.SHOWSAVERESET?(crdHdr.find("#savingHdr").hide(),crdHdr.find("#saveResetButton").show()):type===TimelySettings.SHOWNOTHING&&(crdHdr.find("#savingHdr").hide(),crdHdr.find("#saveResetButton").hide()))},hideAllSaveReset:function(){for(var page=settingsPage.container,crdLen=page.find(".zpl_crd").length,index=0;index<crdLen;index++){var currCrd=page.find(".zpl_crd").eq(index);TimelySettings.showHideSaveReset(currCrd,TimelySettings.SHOWNOTHING)}},getPageOrSpecificSettingsModal:function(){return"settings-service-attendance-attspecificpolicy"===settingsPage.container[0].id?settingsPage.container.find("#specificPolicyContainer"):settingsPage.container},getPeriodOptions:function(){return[{label:ZPI18N.getString("zp.sweek"),value:0},{label:ZPI18N.getString("zp.smonth"),value:1},{label:ZPI18N.getString("zp.spayperiod"),value:2}]},getSetSpecId:function(){return"settings-service-attendance-attspecificpolicy"===settingsPage.container[0].id?"SpecSet":""},isPageDataChanged:function(leftTabChange){if(settingsPage.container.find(".zpl_crd #saveResetButton").is(":visible")){var infoAlertMessage=new InfoAlertMessage;infoAlertMessage.title="",infoAlertMessage.despcription=ZPI18N.getString("zp.cancelconfmsg"),infoAlertMessage.yesButtonText=ZPI18N.getString("zp.proceed"),infoAlertMessage.callback=function(obj){leftTabChange()},infoAlertMessage.show()}else leftTabChange()}},TimelyZComp={userFeildAllEmpOptSelunSel:function(obj,callback){obj&&obj.on("zselectchange",function(event,edata){if(1==edata.fromUI){let selectComp=ZPeopleComponents.select(edata.element);edata.selectedValue&&-1!==edata.selectedValue.indexOf("0")?edata.previousValue&&-1!==edata.previousValue.indexOf("0")?selectComp.deselectOption([0]):selectComp.deselectOption(edata.previousValue):edata.previousValue&&-1!==edata.previousValue.indexOf("0")&&selectComp.deselectOption([0]),callback&&callback()}})},destroy:function(pageContainer){(pageContainer=pageContainer||settingsPage.container).find("[elemType=select]").each(function(){TimelyZComp.select.destroy(this)}),pageContainer.find("[elemType=tokenfield]").each(function(){TimelyZComp.tokenField.destroy(this)})},isComponent:function(obj){return ZPeopleComponents.isComponent(obj)}},TimelyZComp.select={intialize:function(obj,dtlsObj){return ZPeopleComponents.select(obj,TimelyZComp.select.getDefaultParams(obj,dtlsObj))},getElement:function(obj){return ZPeopleComponents.select(obj)},getDefaultParams:function(obj,dtlsObj){dtlsObj=dtlsObj||{};let options={allowDuplicateValues:!1,sort:!1,dropdownList:{appendTo:obj.closest(".zpl_mdl").length>0?obj.closest(".zpl_mdl"):settingsPage.container,fitForElement:!0}};return $.extend(options,dtlsObj),options},setValue:function(selectDiv,value,isMultiple){if(void 0!==value&&null!==value)return isMultiple?ZPeopleComponents.select(selectDiv).setValues(value):ZPeopleComponents.select(selectDiv).setValue(value)},getValue:function(selectDiv,isMultSel){if(ZPeopleComponents.isComponent(selectDiv))return isMultSel?ZPeopleComponents.select(selectDiv).getValues():ZPeopleComponents.select(selectDiv).getValue()},removeAllOptions:function(obj,pageContainer){pageContainer=pageContainer||settingsPage.container,obj?ZPeopleComponents.select(obj).removeAllOptions():pageContainer.find("select").each(function(){pageContainer.find($(this))&&ZPeopleComponents.select($(this))&&ZPeopleComponents.select($(this)).removeAllOptions()})},removeOption:function(obj,optionsToRemove){obj&&ZPeopleComponents.select(obj).removeOption(optionsToRemove)},deselectAllOptions:function(obj,pageContainer){pageContainer=pageContainer||settingsPage.container,obj?ZPeopleComponents.select(obj).deselectAllOptions():pageContainer.find("select").each(function(){pageContainer.find($(this))&&ZPeopleComponents.select($(this))&&ZPeopleComponents.select($(this)).deselectAllOptions()})},setAttributes:function(obj,attr){if(0==obj.length||!ZPeopleComponents.isComponent(obj))return null;var selectComp=ZPeopleComponents.select(obj);return selectComp.setAttributes(attr),selectComp},destroy:function(obj){ZPeopleComponents.select(obj).destroy()},destroyAll:function(id,pageContainer){pageContainer=pageContainer||settingsPage.container,id?ZPeopleComponents.select(pageContainer.find("#"+id)).destroy():pageContainer.find("select").each(function(){ZPeopleComponents.select($(this)).destroy()})}},TimelyZComp.toolTip={intiliaze:function(pageContainer){},customMsgIntz:function(pageContainer,Obj){var Icon;pageContainer=pageContainer||settingsPage.container,Obj=Obj||{},$.each(Obj,function(ind,value){"class"in value?Icon=pageContainer.find("."+value.class):"id"in value&&(Icon=pageContainer.find("#"+value.id)),Icon.attr("title",value.title)}),TimelyZComp.toolTip.intiliaze(pageContainer)},defaultIntiliaze:function(pageContainer,Obj){var delIconDiv=(pageContainer=pageContainer||settingsPage.container).find(".PI_delete");delIconDiv.length>0&&delIconDiv.attr("title",ZPI18N.getString("zp.delete"));var editIconDiv=pageContainer.find(".PI_edt");editIconDiv.length>0&&editIconDiv.attr("title",ZPI18N.getString("zp.edit"));var resetIconDiv=pageContainer.find(".PI_reset");resetIconDiv.length>0&&resetIconDiv.attr("title",ZPI18N.getString("zp.reset"));var moreIconDiv=pageContainer.find(".PI_more");moreIconDiv.length>0&&moreIconDiv.attr("title",ZPI18N.getString("zp.more"));var filterIconDiv=pageContainer.find(".PI_fltr");filterIconDiv.length>0&&filterIconDiv.attr("title",ZPI18N.getString("zp.filter"));var closeIconDiv=pageContainer.find(".PI_cls");closeIconDiv.length>0&&closeIconDiv.attr("title",ZPI18N.getString("zp.close"));var playIcon=pageContainer.find(".PI_play");playIcon.length>0&&!playIcon[0].getAttribute("title")&&playIcon.attr("title",ZPI18N.getString("zp.play"));var copyIcon=pageContainer.find(".PI_cpy");copyIcon.length>0&&copyIcon.attr("title",ZPI18N.getString("zp.copy")),Obj?TimelyZComp.toolTip.intiliaze(pageContainer):TimelyZComp.toolTip.customMsgIntz(pageContainer,Obj)}},TimelyZComp.tokenField={intialize:function(obj,dtlsObj,isLabelValue){return ZPeopleComponents.tokenfield(obj,TimelyZComp.tokenField.getDefaultParams(obj,dtlsObj,isLabelValue))},getDefaultParams:function(obj,dtlsObj,isLabelValue){dtlsObj=dtlsObj||{};var options={data:[],contentType:"text",search:{by:"name"},allowDuplicateValues:!1,placeholder:ZPI18N.getString("zp.select"),dropdownList:{closeOnSelect:!1,hideItemOnSelect:!0,isTextHTMLEncoded:!1,fitForElement:!0,appendTo:obj.closest(".zpl_mdl").length>0?obj.closest(".zpl_mdl"):settingsPage.container}};return isLabelValue?(options.dataMapping={value:"value",text:"label",id:"value",informativeText:"label",titleText:"label"},options.search={by:"label"}):(options.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},options.search={by:"name"}),dtlsObj.dropdownList&&$.extend(options.dropdownList,dtlsObj.dropdownList),$.extend(options,dtlsObj),options},setValues:function(obj,arr){ZPeopleComponents.tokenfield(obj).setValuesById(arr)},addValues:function(obj,arr){ZPeopleComponents.tokenfield(obj).setAttribute("values",arr)},getValues:function(obj){return ZPeopleComponents.tokenfield(obj).getSelectedValuesId()},destroy:function(obj){ZPeopleComponents.tokenfield(obj).destroy()},removeAllTokens:function(obj){ZPeopleComponents.isComponent(obj)&&ZPeopleComponents.tokenfield(obj).removeAllTokens()},addOptions:function(obj,arr){ZPeopleComponents.tokenfield(obj).setAttribute("data",arr)},getOptions:function(obj){return ZPeopleComponents.tokenfield(obj).getAttribute("data")},deSelectAll:function(obj){ZPeopleComponents.tokenfield(obj).removeAllTokens()},deSelect:function(obj,optionArr){ZPeopleComponents.tokenfield(obj).removeTokens(optionArr)},addTokens:function(obj,arr){ZPeopleComponents.tokenfield(obj).addTokens(arr)}},TimelyZComp.timeField={intialize:function(obj,dtlsObj){return ZPeopleComponents.timefield(obj,TimelyZComp.timeField.getDefaultParams(obj,dtlsObj))},getDefaultParams:function(obj,dtlsObj){dtlsObj=dtlsObj||{};let options={clearButton:"none",format:"hh:mm tt",dropdownList:{appendTo:obj.closest(".zpl_mdl").length>0?obj.closest(".zpl_mdl"):settingsPage.container},value:(new Date).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})};return $.extend(options,dtlsObj),options},setValue:function(obj,value){return ZPeopleComponents.timefield(obj).setValue(value)},getValue:function(obj){return ZPeopleComponents.timefield(obj).getValue().dateString},destroy:function(obj){ZPeopleComponents.timefield(obj).destroy()}},TimelyZComp.dateField={intialize:function(obj,dtlsObj){return ZPeopleComponents.datefield(obj,TimelyZComp.dateField.getDefaultParams(obj,dtlsObj))},getDefaultParams:function(obj,dtlsObj){dtlsObj=dtlsObj||{};let options={calendarIcon:!0,format:dateFmt,picker:!0,spinButtons:"none",clearButton:"none",dropdownList:{appendTo:obj.closest(".zpl_mdl").length>0?obj.closest(".zpl_mdl"):settingsPage.container}};return $.extend(options,dtlsObj),options},setValue:function(obj,value){return ZPeopleComponents.datefield(obj).setValue(value)},getValue:function(obj){return ZPeopleComponents.datefield(obj).getValue().dateString},getDateObj:function(obj){return ZPeopleComponents.datefield(obj).getValue().dateObject},destroy:function(obj){ZPeopleComponents.datefield(obj).destroy()}},TimelyZComp.datetimefield={intialize:function(obj,dtlsObj,isDelPrev){return isDelPrev&&TimelyZComp.datetimefield.destroy(obj),dtlsObj=TimelyZComp.datetimefield.getDefaultParams(obj,dtlsObj),ZPeopleComponents.datetimefield(obj,dtlsObj)},getDefaultParams:function(obj,dtlsObj){dtlsObj=dtlsObj||{};let options={calendarIcon:!0,picker:!0,spinButtons:"none",clearButton:"none",format:dateFmt+" "+timeFormat.replace("a","tt"),clearButton:"none"};return $.extend(options,dtlsObj),options},setAttribute:function(obj,attrName,value){return ZPeopleComponents.datetimefield(obj).setAttribute(attrName,value)},setValue:function(obj,value){return ZPeopleComponents.datetimefield(obj).setValue(value)},getValue:function(obj){return ZPeopleComponents.datetimefield(obj).getValue().dateString},getDateObj:function(obj){return ZPeopleComponents.datetimefield(obj).getValue().dateObject},destroy:function(obj){ZPeopleComponents.isComponent(obj)&&ZPeopleComponents.datetimefield(obj).destroy()}},BrdCrumbFilterView={create:(filterCont,showFilterCallback,valueChangeCallBack,resetCallBack)=>{if(filterCont&&filterCont.length>0){let fields=filterCont.find("select.select-js, select.select, input.datepicker, input.token, input.zcheckbox__helper");if(fields&&fields.length>0){let html=$('<div id="brdcrumbs""><ul class="zpl_fltrvwlst"></ul></div><div class="d-flexcap MLauto"><a class="zpl_link" id="resetfiltercrumbs">'+ZPI18N.getString("zp.files.reset")+"</a></div>"),crumbdiv=html.find("ul"),addedCrumbCnt=0;$.each(fields,function(key,field){let parent=(field=$(field)).parents(".zpl_secn");if(!parent.hasClass("DNI")){let fieldname=field.attr("name"),showfilteropt=field.attr("showfilteropt"),needremove=!0,parentele=field.attr("parent"),remove=field.attr("needremove");void 0==remove||0!=remove&&"false"!=remove||(needremove=!1);let classname=field.attr("class"),innerText=parent.find("label").text(),defVal=field.attr("defval");var addcrumb=!0;if(void 0==showfilteropt||"true"==showfilteropt){if(-1!=classname.indexOf("select")||-1!=classname.indexOf("select-js")){let tempVal=ZPeopleComponents.select(field)._optDatas,tempId=ZPeopleComponents.select(field).getValue(),tempArr=[];tempVal&&tempVal.length>0?void 0!==defVal&&defVal==tempId?addcrumb=!1:$.each(tempVal,function(idx,val){val.label&&tempArr.push(val.label)}):addcrumb=!1,value=tempArr}else if(-1!=classname.indexOf("zcheckbox__helper")||-1!=classname.indexOf("zradiobutton__helper"))value=field.prop("checked"),value+""==defVal&&(addcrumb=!1),value=void 0==value||"true"!=value&&1!=value?"No":"Yes";else if(-1!=classname.indexOf("token")){let tempVal=ZPeopleComponents.tokenfield(field).values,tempIds=ZPeopleComponents.tokenfield(field).getSelectedValuesId(),defIds=[],tempArr=[];try{void 0!=defVal&&(defIds=JSON.parse(defVal))}catch(e){}tempVal&&tempVal.length>0&&$.each(tempVal,function(idx,val){val.label?tempArr.push(val.label):val.html&&tempArr.push(val.html)}),value=tempArr,(0==value.length||tempIds.length==defIds.length&&0==ZPUtil.getDistinctElementsInArrays(tempIds,defIds).length)&&(addcrumb=!1)}else-1!=classname.indexOf("datepicker")&&(value=ZPeopleComponents.datefield(field).getValue().dateString,defVal==value&&(addcrumb=!1));addcrumb&&(crumbdiv.append(BrdCrumbFilterView.constructElementCard(fieldname,innerText,value,needremove,showFilterCallback,parentele)),addedCrumbCnt++)}if(4==addedCrumbCnt)return crumbdiv.append('<li class="zpl_mre"><i class="PI_more"></i></li>'),!1}}),html=$(html),showFilterCallback&&$(html).find("li").on("click",function(){showFilterCallback(!0)}),resetCallBack&&($(html).find("[id='removefilteropt']").on("click",function(){BrdCrumbFilterView.removeElementCard(this,resetCallBack)}),$(html).find("#resetfiltercrumbs").on("click",function(){resetCallBack(!1)})),html.find(".zpl_fltrvwlst").children().length>0&&(settingsPage.container.find("#zp_brdcrum_filterview").show(),settingsPage.container.find("#zp_brdcrum_filterview").html(html))}}},reset:currentPagCont=>{currentPagCont.find("#zp_brdcrum_filterview").hide(),currentPagCont.find("#zp_brdcrum_filterview").html("")},constructElementCard:(fieldname,keyname,value,needremove,showFilterCallback,parentele)=>{let html=$('<li id="'+fieldname+'" '+(void 0!=parentele?'parent="'+parentele+'"':"")+"> <label>"+ZPeople.escapeHtml(keyname)+" :</label> <span></span>"+(needremove?'<a class="PI_cls" id="removefilteropt"></a>':"")+"</li>"),valdiv=html.find("span");return"object"==typeof value&&Array.isArray(value)?($.each(value,function(idx,val){if(0==idx&&(valdiv.append(val),value.length>1))return valdiv.after('<sub id="filcardicon_'+fieldname+'" class="zpl_popovr-js">+ '+(value.length-1)+"</sub>"),!1}),$(html).find("#filcardicon_"+fieldname).off().on("click",e=>{e.stopPropagation(),BrdCrumbFilterView.constructMoreOption(e,fieldname,value,showFilterCallback)})):valdiv.append(value),html},removeElementCard:(ele,resetCallBack)=>{let ul=$(ele).parents("li").parent(),elemname=$(ele).parents("li").attr("id");$(ele).parents("li").remove(),ul.find("[parent='"+elemname+"']").length>0&&ul.find("[parent='"+elemname+"']").remove(),0==ul.find("li:not(.zpl_mre)").length&&(settingsPage.container.find("#zp_brdcrum_filterview").hide(),settingsPage.container.find("#zp_brdcrum_filterview").html("")),resetCallBack(!1,elemname)},constructMoreOption:function(event,fieldname,list,showFilterCallback){var listLen=list.length;if(listLen>0&&listLen>1){var mhtml=$('<div id="filcard_'+fieldname+'" class="zpl_popovr zpl_fltrvw-popovr" data-type="list" data-content-type="icon-text" role="menu" tabindex="0" aria-hidden="true"><ul data-body="true" class="zpl_fltrvwlst" /></ul></div>');let ul=mhtml.find("ul");for(let i=0;i<listLen;i++)i>0&&ul.append('<li data-item-type="custom"> <span>'+list[i]+"</span>  </li>");settingsPage.container.find("#filcard_"+fieldname).length>0&&(ZPeopleComponents.popover(settingsPage.container.find("#filcard_"+fieldname)).destroy(),settingsPage.container.find("#filcard_"+fieldname).remove()),settingsPage.container.append(mhtml),ZPeopleComponents.popover(settingsPage.container.find("#filcard_"+fieldname),{forElement:$(event.currentTarget),position:"bottom",displayType:"box"}),ZPeopleComponents.popover(settingsPage.container.find("#filcard_"+fieldname)).open(),settingsPage.container.find("#filcard_"+fieldname).length>0&&settingsPage.container.find("#filcard_"+fieldname).find(".zpl_fltrvwlst").on("click",function(){showFilterCallback(!0)})}}};