TaskCommon={MYTASK_MODE:"mytask",TRACKTASK_MODE:"tracktask",UNASSIGNEDTASK_MODE:"unassignedtask",WATCHLIST_MODE:"watchlist",OVERDUE_MODE:"overdue",ALLTASK_MODE:"alltask",PENDINGTASK_MODE:"pendingtask",HIGHPRIORITYTASK_MODE:"highprioritytask",COMPLETEDTASK_MODE:"completedtask",CHECKLIST_MODE:"checklist",getPageMode:function(){let pageMode="",pageHash=Layout.Page.hash;return-1!=pageHash.indexOf(TaskCommon.MYTASK_MODE)?pageMode=TaskCommon.MYTASK_MODE:-1!=pageHash.indexOf(TaskCommon.TRACKTASK_MODE)?pageMode=TaskCommon.TRACKTASK_MODE:-1!=pageHash.indexOf(TaskCommon.UNASSIGNEDTASK_MODE)?pageMode=TaskCommon.UNASSIGNEDTASK_MODE:-1!=pageHash.indexOf(TaskCommon.WATCHLIST_MODE)?pageMode=TaskCommon.WATCHLIST_MODE:-1!=pageHash.indexOf(TaskCommon.ALLTASK_MODE)?pageMode=TaskCommon.ALLTASK_MODE:-1!=pageHash.indexOf("operations/task/taskadminview/pending")?pageMode=TaskCommon.PENDINGTASK_MODE:-1!=pageHash.indexOf("operations/task/taskadminview/highpriority")?pageMode=TaskCommon.HIGHPRIORITYTASK_MODE:-1!=pageHash.indexOf("operations/task/taskadminview/completed")?pageMode=TaskCommon.COMPLETEDTASK_MODE:-1!=pageHash.indexOf("operations/task/taskadminview/overdue")&&(pageMode=TaskCommon.OVERDUE_MODE),pageMode},getPageId:function(){return $("#"+Layout.Page.pageId)},getTaskFormId:function(){if(void 0===TaskCommon.taskformid){var param={method:"getTaskFormid",conreqcsr:csrfToken};$.ajax({url:"/taskformid.zp",type:"POST",data:param,async:!1,success:function(data){TaskCommon.taskformid=data.taskformid}})}return TaskCommon.taskformid},constructFormViewParams:function(){return{modulePrefix:"task-list",formId:TaskCommon.getTaskFormId(),submode:"task-list"}},createNewTask:function(related_formid,related_recordid){var params={formId:TaskCommon.getTaskFormId(),formMode:"ADD",viewRefresh:!0,disableUrlTrack:!1,isSingleCol:!0};let form=ZP5Form._toForm(params);form.setFormModel(ZP5Form.MODEL.SLIDER_MEDIUM).init(),void 0!=related_formid&&void 0!=related_recordid&&(form.LAYOUT.attr("addRelatedTask",!0),form.LAYOUT.attr("related_recordid",related_recordid),form.LAYOUT.attr("related_formid",related_formid))},getAllTask:function(mode,isReset,isInitialLoad,statusIds,filterObj){var pageId=TaskCommon.getPageId();TaskStatus.getOptionValues(),TaskStatus.getStatusOptionValuesBySysVal();var taskParam={};switch(isReset?(pageId.find(".zpl_rgtCnt").empty(),ZPA_Common.Loader.appendPageLoading(pageId),taskParam.index=1):(taskParam.index=pageId.find("#"+mode+"_taskOperList").children().length,pageId.find("#taskFilterHeader").hasClass("DNI")||(filterObj=TaskFilter.getFilterResult(),statusIds=ZPeopleComponents.select(pageId.find("[name=status]"))?ZPeopleComponents.select(pageId.find("[name=status]")).getValue().toString():"",ZPA_Common.isNotNull(statusIds)||(statusIds=pageId.find("#task_Count").find("[name=countBar].zpl_act").attr("optid")))),ZPA_Common.isNotNull(filterObj)&&Object.keys(filterObj).length>0&&(ZPA_Common.isNotNull(filterObj.priority)&&(taskParam.priority=filterObj.priority),ZPA_Common.isNotNull(filterObj.taskName)&&(taskParam.name=filterObj.taskName),ZPA_Common.isNotNull(filterObj.relFormIds)&&(taskParam.formid=filterObj.relFormIds),mode===TaskCommon.ALLTASK_MODE&&ZPA_Common.isNotNull(filterObj.taskOwner)&&(taskParam.erecno=filterObj.taskOwner)),mode){case TaskCommon.TRACKTASK_MODE:if(taskParam.isTrack=!0,isInitialLoad&&(taskParam.isInitialLoad=isInitialLoad,taskParam.status=TaskStatus.statusBySysVal[TaskStatus.OPEN_SYSVALUE].ID+","+TaskStatus.UNASSIGNED_SYSVALUE),ZPA_Common.isNotNull(statusIds))taskParam.status=statusIds;else if(isReset)taskParam.status=TaskStatus.statusBySysVal[TaskStatus.OPEN_SYSVALUE].ID+","+TaskStatus.UNASSIGNED_SYSVALUE;else{let selStatusId=pageId.find("#task_Count li.zpl_act").attr("optid");0!=selStatusId&&(taskParam.status=selStatusId)}break;case TaskCommon.WATCHLIST_MODE:taskParam.isWatchlist=!0;break;case TaskCommon.PENDINGTASK_MODE:ZPA_Common.isNotNull(statusIds)?taskParam.status=statusIds:(taskParam.status=TaskStatus.statusBySysVal[TaskStatus.OPEN_SYSVALUE].ID,void 0!=TaskStatus.statusBySysVal[TaskStatus.INPROGRESS_SYSVALUE]&&(taskParam.status=taskParam.status+","+TaskStatus.statusBySysVal[TaskStatus.INPROGRESS_SYSVALUE].ID),void 0!=TaskStatus.statusBySysVal[TaskStatus.ONHOLD_SYSVALUE]&&(taskParam.status=taskParam.status+","+TaskStatus.statusBySysVal[TaskStatus.ONHOLD_SYSVALUE].ID));break;case TaskCommon.COMPLETEDTASK_MODE:taskParam.status=TaskStatus.statusBySysVal[TaskStatus.COMPLETED_SYSVALUE].ID;break;case TaskCommon.HIGHPRIORITYTASK_MODE:taskParam.priority=TaskStatus.getHighPriorityId(),ZPA_Common.isNotNull(statusIds)?taskParam.status=statusIds:(taskParam.status=TaskStatus.statusBySysVal[TaskStatus.OPEN_SYSVALUE].ID,void 0!=TaskStatus.statusBySysVal[TaskStatus.INPROGRESS_SYSVALUE]&&(taskParam.status=taskParam.status+","+TaskStatus.statusBySysVal[TaskStatus.INPROGRESS_SYSVALUE].ID),void 0!=TaskStatus.statusBySysVal[TaskStatus.ONHOLD_SYSVALUE]&&(taskParam.status=taskParam.status+","+TaskStatus.statusBySysVal[TaskStatus.ONHOLD_SYSVALUE].ID));break;case TaskCommon.OVERDUE_MODE:taskParam.isOverdue=!0,ZPA_Common.isNotNull(statusIds)?taskParam.status=statusIds:(taskParam.status=TaskStatus.statusBySysVal[TaskStatus.OPEN_SYSVALUE].ID,void 0!=TaskStatus.statusBySysVal[TaskStatus.INPROGRESS_SYSVALUE]&&(taskParam.status=taskParam.status+","+TaskStatus.statusBySysVal[TaskStatus.INPROGRESS_SYSVALUE].ID),void 0!=TaskStatus.statusBySysVal[TaskStatus.ONHOLD_SYSVALUE]&&(taskParam.status=taskParam.status+","+TaskStatus.statusBySysVal[TaskStatus.ONHOLD_SYSVALUE].ID));break;case TaskCommon.ALLTASK_MODE:ZPA_Common.isNotNull(statusIds)&&(taskParam.status=statusIds)}ZPeople.Request.send("/alltasks.zp",{conreqcsr:csrfToken,method:"getAllTasks",criteria:JSON.stringify(taskParam)},function(result){new TaskListConstruction(pageId,mode,result).constructTaskList(isInitialLoad,isReset,statusIds),ZPA_Common.Loader.removePageLoading(pageId)})},viewTask:function(taskId){window.location.href="#"+Layout.Page.currentmode+"/viewtask-taskid:"+taskId},openViewTask:function(taskId,disableUrlTrack){taskId=ZPA_Common.isNotNull(taskId)?taskId:Layout.Page.childUrlParam.taskid;var params={formId:TaskCommon.getTaskFormId(),recordId:taskId,formMode:"VIEW",isCustomLayout:!0,isSingleCol:!0};void 0!=disableUrlTrack&&disableUrlTrack&&(params.disableUrlTrack=!0);let form=ZP5Form._toForm(params);form.setFormContainer($("body #modal_Container")),void 0!=disableUrlTrack&&disableUrlTrack&&form.setBaseFormDOMId(ZP5Form.getFormObjectKey(form,ZP5Form.getCurrentFormId(),"VIEW")),form.setPreviewForm(Boolean.TRUE).setFormModel(ZP5Form.MODEL.SLIDER_MEDIUM).init(),$("#modal_Container").addClass("tskptch")},postTaskComment:function(editor,actJson){var pageId=actJson.currentcontainer,content=ZPFeeds.getSmileysAndMentions(editor.getContent(),ZPeople.isSearchAllowed),messageText=ZPFeeds.getTextContent(content);if(0===messageText.length&&0===$("<div>").append(content).find("img").length)ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.pleaseentervalidcomment")),editor.focus();else if(messageText.length>5e3)ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.commentlengthwarning")),editor.focus();else{var btnObj=pageId.find("#postCommentBtn");btnObj.prop("disabled",!0),0===btnObj.find("#loader").length&&btnObj.append(ZPFeeds.MINILOADER);var params={actionType:"INVOKE_ACS",comment:content,conreqcsr:csrfToken,fdk:actJson.fdk,messageText:messageText,statusType:People.Task.type};ZPeople.Request.send("/feedActions.zp",params,function(data){if(200==JSON.parse(data).code){ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.commentaddedsuccessfully"));var tempCmtObj=JSON.parse(data).commentObj[0],comActObj=new People.Comment(new Comment(tempCmtObj),!0);comActObj.cfdk=tempCmtObj.commentfdk,comActObj.commentText=comActObj.content,actJson.actRecId=tempCmtObj.actRecId,actJson.type=comActObj.type;var cmtContObj=$(pageId[0]).find("[actfdk='"+ZPUtil.escapeSelector(params.fdk)+"']");cmtContObj.removeClass("DN"),actJson.totalComments++;var cmtObj=ZPFeeds.Construction.iterateComments(actJson,[comActObj],cmtContObj);cmtContObj.find("[commentId='"+comActObj.commentId+"']").length>0?cmtContObj.find("[commentId='"+comActObj.commentId+"']").replaceWith(cmtObj):cmtContObj.append(cmtObj),actJson.comments.push(comActObj),ZPFeeds.Comment.handleCommentCount(!1,params.fdk,actJson.comments.length,!1,"bottomcont"),editor.setContent(""),ZPFeeds.Comment.removeTextEditor(editor,tempCmtObj.actRecId)}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.authorizedfailure"));btnObj.prop("disabled",!1),btnObj.find("#loader").remove()})}},likeActionforCurrUser:function(isActivity,Obj,liketype){var recordId,container,currContainer=ZP5Form.getLayout().find("[id=bottomcont]");isActivity?(recordId=Obj.parents("div#actOuterCont").attr("streamid"),container=$(currContainer).find("[streamid='"+recordId+"']")):(recordId=Obj.parents("div.zp-cmtdiv").attr("commentId"),container=$(currContainer).find("[commentid='"+recordId+"']"));for(var likeDtl,isSelfRemove=!1,isRemove=!1,objCnt=0;objCnt<container.length;objCnt++){var curActContainer=$(container[objCnt]),likeData=curActContainer.data("likeData")||[],likedUserDtls=curActContainer.data("likedUserDtls")||{};if(-1==Obj.attr("action")&&void 0===liketype)if(void 0===likeData[0])isRemove=!0,likeData=["",0,null,[]];else{var userIds=likeData[0].toString().split(","),typeArr=ZPFeeds.Like.refreshArr(likeData[3]||[]);-1!==(erecnoIndex=userIds.indexOf(erecno))&&(typeArr.splice(erecnoIndex,1),userIds.splice(erecnoIndex,1),likeData[0]=userIds.join(","),likeData[1]=parseInt(likeData[1])-1,likeData[3]=ZPFeeds.Like.refreshArr(typeArr),isSelfRemove=!(isRemove=0===userIds.length))}else{if(void 0===likeData[0])likeData=[erecno,1,null,[liketype]];else{var erecnoIndex;userIds=likeData[0].toString().split(","),typeArr=ZPFeeds.Like.refreshArr(likeData[3]||[]);-1!==(erecnoIndex=userIds.indexOf(erecno))?typeArr[erecnoIndex]=liketype:(userIds.unshift(erecno),typeArr.unshift(liketype),likeData[1]=parseInt(likeData[1])+1),likeData[0]=userIds.join(","),likeData[3]=typeArr}likedUserDtls[erecno]={empName:ZPeople.CURR_USER.name},curActContainer.data("likeData",likeData)}likeDtl=likeData}if(isRemove||isSelfRemove)ZPFeeds.Like.refreshLikeContainer(recordId,isActivity,isSelfRemove);else{var likedUsers=ZP5Form.getSingleRecord().record.taskFeedComments.likedUsers;likedUsers.commentIds||(likedUsers.commentIds={},likedUsers.likedUserDtls={}),likedUsers.commentIds[recordId]=likeData,likedUsers.likedUserDtls[erecno]={empName:ZPeople.CURR_USER.name,empPhoto:ZPeople.CURR_USER.thumb},ZPFeeds.Like.constructLikedUsers(recordId,likeDtl,isActivity,likedUserDtls)}},deleteComment:function(comment,obj){const recordId=$(obj).parent().siblings("#record_id").val(),type=$(obj).parent().siblings("#type").val();ZPeople.Request.send(ZPFeeds.URL,{actionType:"DELETE_COMMENT",commentId:recordId,activityType:type},function(resultData){if(-1!==resultData.indexOf("success")){ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.commentdeletedsuccess"));var comd=$(obj).parents('[commentid="'+recordId+'"]');comd.fadeOut(1e3,function(){comd.remove()});var taskComments=ZP5Form.getSingleRecord().record.taskFeedComments,index=taskComments.comments.findIndex(comment=>comment.commentId===recordId);-1!==index&&(taskComments.comments.splice(index,1),taskComments.totalComments--)}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror"))})},changeStatus:function(thisObj,taskId,isFrom,isAsync){event.stopPropagation();var response=!1,status=$(thisObj).hasClass(TaskStatus.getClass(TaskStatus.COMPLETED_SYSVALUE))||$(thisObj).closest("[taskid]").hasClass("zp_cmpl")?TaskStatus.OPEN_SYSVALUE:TaskStatus.COMPLETED_SYSVALUE,params={taskid:taskId,method:"changeTaskStatus",status:status,conreqcsr:csrfToken};TaskStatus.getOptionValues(),TaskStatus.getStatusOptionValuesBySysVal();var ajaxRequest={type:"POST",url:"/changeTasksStatus.zp",data:params,success:function(data){if("success"==data.Status){if(ZP5Form.refreshRecord(TaskCommon.getTaskFormId(),taskId),ZPA_Common.isNotNull(isFrom)&&"checklist"==isFrom||-1!==Layout.Page.hash.indexOf("checklist")||$("#recordChecklist").is(":visible")){let chkRow=$(thisObj).closest(".zpl_crdlstrow").find("div[chkrootid]"),taskRow=$(thisObj).closest("[taskid]");if("checklist"==isFrom)chkRow=$(thisObj).closest(".zpl_crdlstrow").find("div[chkrootid]"),taskRow=$(thisObj).closest("[taskid]");else{chkRow=(taskRow=($("#recordChecklist").is(":visible")?$("#recordChecklist"):TaskCommon.getPageId().find("#trackchecklist_List")).find("[taskid="+taskId+"]")).parent().siblings("[chkrootid]");let cmplBtn=taskRow.find(".zpl_tckchng");0!=cmplBtn.length&&(params.status==TaskStatus.OPEN_SYSVALUE?(cmplBtn.removeClass("PI_tick2_fil"),cmplBtn.addClass("PI_tick2")):(cmplBtn.addClass("PI_tick2_fil"),cmplBtn.removeClass("PI_tick2")))}let chkRootId=chkRow.attr("chkrootid"),statusCont=chkRow.find("[status="+chkRootId+"]"),completed=parseInt(statusCont.find("[name=comp_taskcount]").text()),total=parseInt(statusCont.find("[name=tot_taskcount]").text());status==TaskStatus.OPEN_SYSVALUE?(completed-=1,taskRow.next().find("[taskid]:first").addClass("disabled pnone")):(completed+=1,taskRow.next().find("[taskid]:first").removeClass("disabled pnone")),statusCont.find("[name=comp_taskcount]").text(completed),statusCont.find(".zprogress__bar").attr("style","background:#50C173; width:"+completed/total*100+"%")}else TaskCommon.resetTaskCount(taskId,status);var statusColumn=$(thisObj).parents().eq(1).find("[name=tStatus]")[0];params.status==TaskStatus.OPEN_SYSVALUE?($(thisObj).hasClass("PI_tick2_fil")?($(thisObj).removeClass("PI_tick2_fil"),$(thisObj).addClass("PI_tick2"),$(statusColumn).attr("class","blu").text(TaskStatus.getOptionNameBySysVal(TaskStatus.OPEN_SYSVALUE))):$(thisObj).closest("[taskid]").removeClass("zp_cmpl"),$(thisObj).attr("title",ZPI18N.getString("zp.complete")),ZPeople.Message.success(ZPI18N.getString("zp.taskreopenedsuccess"))):($(thisObj).hasClass("PI_tick2")?($(thisObj).removeClass("PI_tick2"),$(thisObj).addClass("PI_tick2_fil"),$(statusColumn).attr("class","grn").text(TaskStatus.getOptionNameBySysVal(TaskStatus.COMPLETED_SYSVALUE))):$(thisObj).closest("[taskid]").addClass("zp_cmpl"),$(thisObj).attr("title",ZPI18N.getString("zp.reopen")),ZPeople.Message.success(ZPI18N.getString("zp.taskcompletedsuccess"))),response=!0}else{var taskerrmsg;taskerrmsg="object"==typeof data.message?data.message.Status||Object.values(data.message):data.message,ZPeople.Message.failure(taskerrmsg),response=!1}},error:function(xhr,status,error){ServiceApplicabilityUtil.Error.showWarningMessage(xhr)}};return void 0==isAsync||isAsync||(ajaxRequest.async=!1),$.ajax(ajaxRequest),response},pickTaskConfirmation:function(pickIcObj,recHandIns){event.stopPropagation();var alertMsgObj=new InfoAlertMessage("",ZPI18N.getString("zp.taskpickmessage"));alertMsgObj.setCallback(TaskCommon.pickTask),alertMsgObj.yesButtonText=ZPI18N.getString("zp.confirm"),alertMsgObj.pickIcObj=pickIcObj,alertMsgObj.recHandIns=recHandIns,alertMsgObj.show()},pickTask:function(thisObj){var pickIcObj=thisObj.pickIcObj,recHandIns=thisObj.recHandIns,taskId=$(pickIcObj).closest("[taskid]").attr("taskid"),params={taskid:taskId,method:"changeTaskOwner",mode:"pickup",conreqcsr:csrfToken};ZPeople.Request.send("/changeTaskOwner.zp",params,function(data){var taskerrmsg;"success"==data.Status?(ZPeople.Message.success(ZPI18N.getString("zp.taskassignedsuccess")),void 0!=$(pickIcObj).attr("rcdlist")?$(pickIcObj).parent().empty().append("<div class='zpl_em'><div class='zpl_emimg'><img src='"+ZPeople.CURR_USER.avatar+"'></div></div>"):void 0!=recHandIns&&recHandIns.postPickTaskHandle(taskId)):(taskerrmsg="object"==typeof data.message?data.message.Status||Object.values(data.message):data.message,ZPeople.Message.failure(taskerrmsg))})},resetTaskCount:function(taskid,updatedStatus){if(TaskCommon.isTaskCountAllowed()){var pageId=TaskCommon.getPageId(),count_box=pageId.find("#task_Count");if(count_box.is(":visible")){var taskRow=pageId.find("[taskid="+taskid+"]"),statusid=taskRow.attr("statusid"),updated_statusid=TaskStatus.getOptionValueBySysVal(updatedStatus),old_statusCnt_box=count_box.find("#status_"+statusid);void 0!=taskRow.find("[name=pickBtn]")&&taskRow.find("[name=pickBtn]").length>0&&updatedStatus==TaskStatus.COMPLETED_SYSVALUE&&(old_statusCnt_box=count_box.find("#status_-1"));var new_statusCnt_box=count_box.find("#status_"+updated_statusid),old_count=parseInt(old_statusCnt_box.find("[name=status_count]").text()),new_count=parseInt(new_statusCnt_box.find("[name=status_count]").text());old_statusCnt_box.find("[name=status_count]").text(old_count-1),new_statusCnt_box.find("[name=status_count]").text(new_count+1),taskRow.attr("statusid",updated_statusid)}}},deleteTaskConfirmation:function(delIcObj){event.stopPropagation();var alertMsgObj=new DeleteAlertMessage(ZPI18N.getString("zp.deltsk"),ZPI18N.getString("zp.deltskdesc"));alertMsgObj.setCallback(TaskCommon.deleteTask),alertMsgObj.yesButtonText=ZPI18N.getString("zp.confirm"),alertMsgObj.delIcObj=delIcObj,alertMsgObj.show()},deleteTask:function(thisObj){var delIcObj=thisObj.delIcObj,params={mode:"deleteRecords",recordIds:$(delIcObj).closest("[taskid]").attr("taskid"),formId:TaskCommon.getTaskFormId()};ZPeople.Request.send(ZP5Form.URL,params,TaskCommon.postDeleteTask,delIcObj)},postDeleteTask:function(resp,params,delIcObj){TaskCommon.getPageId();if(7e3===resp.code){var url=Layout.Page.hash;ZPeople.Message.success(ZPI18N.getString("zp.taskdeletedsuccessfully")),-1!==url.indexOf("myspace/dashboard")?$(delIcObj).closest("li").remove():$(delIcObj).closest(".zpl_crdlst").remove(),-1!==url.indexOf("task/mytasks")&&TaskCommon.getTaskCount()}else ZPeople.Message.failure(result.message)},isTaskCountAllowed:mode=>(mode=ZPA_Common.isNotNull(mode)?mode:TaskCommon.getPageMode())==TaskCommon.MYTASK_MODE||mode==TaskCommon.TRACKTASK_MODE||mode==TaskCommon.WATCHLIST_MODE||-1!=Layout.Page.hash.indexOf("task/taskuserview/alltask"),changeTaskUrl:function(mode){switch(mode){case"addTask":window.location.href="#"+Layout.Page.currentmode+"/addtask"}},getStatusColor(taskStatus,optionId){var color="";switch(taskStatus=void 0==taskStatus?optionId:taskStatus){case TaskStatus.OPEN_SYSVALUE:color="blu";break;case TaskStatus.COMPLETED_SYSVALUE:color="grn";break;case TaskStatus.INPROGRESS_SYSVALUE:color="ylw1";break;case TaskStatus.ONHOLD_SYSVALUE:color="red";break;case TaskStatus.NA_SYSVALUE:color="gry";break;case TaskStatus.UNASSIGNED_SYSVALUE:color="ylw"}return color}};class TaskListConstruction{constructor(pageId,mode,taskResp){this.mode=mode,this.pageId=pageId,this.pageId.closest(".main-wrp").addClass("tskptch"),this.hasNextPage=taskResp.hasNextPage,this.taskArr=taskResp.tasks,this.taskOptions=taskResp.count,Layout.Page.container.closest(".zpl_iwrpr").attr("aria-label",ZPI18N.getString("zp.common.tabname",[$("#tltabcontainer li.zpl_act a").text()]))}isTaskEmpty(){return!ZPA_Common.isNotNull(this.taskArr)||0==this.taskArr.length}getTaskListHeader(){let taskHeader="";switch(this.mode){case TaskCommon.MYTASK_MODE:taskHeader='<div class="zpl_crdlst zpl_crdlsthdr"><div class="zpl_catlst"><div class="zpl_tsklstnme"><h5>'+ZPI18N.getString("zp.taskdetails")+'</h5></div><div class="mw150">'+ZPI18N.getString("zp.status")+'</div><div class="mw150 zpl_tskaction"></div></div></div>';break;case TaskCommon.TRACKTASK_MODE:case TaskCommon.ALLTASK_MODE:case TaskCommon.UNASSIGNEDTASK_MODE:taskHeader='<div class="zpl_crdlst zpl_crdlsthdr"><div class="zpl_catlst"><div class="zpl_tsklstnme"><h5>'+ZPI18N.getString("zp.taskdetails")+'</h5></div><div class="mw150">'+ZPI18N.getString("zp.status")+'</div><div class="mw150">'+ZPI18N.getString("zp.assignedto")+'</div><div class="mw150 zpl_tskaction"></div></div></div>';break;default:taskHeader='<div class="zpl_crdlst zpl_crdlsthdr"><div class="zpl_catlst"><div class="zpl_tsklstnme"><h5>'+ZPI18N.getString("zp.taskdetails")+'</h5></div><div class="mw150">'+ZPI18N.getString("zp.status")+'</div><div class="mw150 zpl_tskaction"></div></div></div>'}return taskHeader}getEmpPhotoHtml(photoUrl,zuid){return'<div class="zpl_emimg" popup="user" empid="'+zuid+'"><img src="'+(photoUrl=ZPA_Common.isNotNull(photoUrl)?ZPeople.applyPortalName(photoUrl):ZPeople.getResourceURL(imageUrl+"user.png"))+'"></div>'}getTaskDetailHtml(taskDtl){let taskDispName=taskDtl.name,recId=ZPA_Common.isNotNull(taskDtl.recordid)?taskDtl.recordid:"",formId=ZPA_Common.isNotNull(taskDtl.formid)?taskDtl.formid:"",formTableName=ZPA_Common.isNotNull(taskDtl.formtablename)?taskDtl.formtablename:"",formName=ZPA_Common.isNotNull(taskDtl.formname)?taskDtl.formname:"",dueDate=ZPA_Common.isNotNull(taskDtl.endtime)?taskDtl.endtime:ZPI18N.getString("zp.noduedate"),empDetail=ZPA_Common.isNotNull(taskDtl.recordowner)?taskDtl.recordowner:taskDtl.createdBy,empId=ZPA_Common.isNotNull(empDetail)?empDetail.employeeID:"",empName=ZPA_Common.isNotNull(empDetail)?empDetail.name:ZPI18N.getString("zp.deleteduser"),empPhoto=ZPA_Common.isNotNull(empDetail)?empDetail.employeePhoto:"",empZuid=ZPA_Common.isNotNull(empDetail)?empDetail.zuid:"",taskPrioSysVal=taskDtl.prioritySysValue,overDueCls=taskDtl.iscompleted||taskDtl.unassigned||void 0==taskDtl.isoverdue||!taskDtl.isoverdue?"":"red",formHtml=void 0!=formName&&""!=formName?'<span class="zpl_dots"></span><a class="zpl_ellipsis" onclick="ZPA_Common.viewRecord(\''+formId+"', '"+recId+"', '"+formTableName+"')\">"+formName+"</a>":"",priorityHtml=taskPrioSysVal==TaskStatus.HIGH_SYSVALUE?'<span class="zpl_dots"></span><i class="zp_rbg"></i><em class="red" priority> '+ZPI18N.getString("zp.highpriority")+"</em>":"";return'<div class="zpl_tsklstnme zpl_ellipsis">\n                    <div class="zpl_em zpl_ellipsis">\n                    \t'+this.getEmpPhotoHtml(empPhoto,empZuid)+'\n                        <div class="zpl_emdts zpl_ellipsis">\n                            <div title="'+taskDispName+'"><b>'+taskDispName+'</b></div>\n                            <div class="d-flexC"><em>'+empId+' - </em> <span title="'+empId+" - "+empName+'">'+empName+'</span><span class="zpl_dots"></span><em class="'+overDueCls+'">'+dueDate+"</em>"+formHtml+priorityHtml+"</div>\n                        </div>\n                    </div>\n                </div>"}getAssignedToHtml(taskId,taskOwnerDetail){let isTaskowerAvailable=ZPA_Common.isNotNull(taskOwnerDetail),assignedToHtml="";if(this.mode==TaskCommon.TRACKTASK_MODE){if(assignedToHtml+='<div class="mw150">',isTaskowerAvailable){let taskOwnerPhoto=isTaskowerAvailable?taskOwnerDetail.employeePhoto:"";assignedToHtml+='<div class="zpl_em">'+this.getEmpPhotoHtml(taskOwnerPhoto,taskOwnerDetail.zuid)+"</div>"}else assignedToHtml+=this.getPickIconDiv(taskId);assignedToHtml+="</div>"}else"unassignedtask"==this.mode&&(assignedToHtml+='<div class="mw150">'+this.getPickIconDiv(taskId)+"</div>");return assignedToHtml}getTaskOwnerHtml(taskId,taskOwnerDetail){let isTaskowerAvailable=ZPA_Common.isNotNull(taskOwnerDetail),assignedToHtml="";if(this.mode==TaskCommon.TRACKTASK_MODE||this.mode==TaskCommon.ALLTASK_MODE){if(assignedToHtml+='<div class="mw150">',isTaskowerAvailable){let taskOwnerPhoto=isTaskowerAvailable?taskOwnerDetail.employeePhoto:"";assignedToHtml+='<div class="zpl_em">'+this.getEmpPhotoHtml(taskOwnerPhoto,taskOwnerDetail.zuid)+"</div>"}else assignedToHtml+=this.getPickIconDiv(taskId);assignedToHtml+="</div>"}else"unassignedtask"==this.mode&&(assignedToHtml+='<div class="mw150">'+this.getPickIconDiv(taskId)+"</div>");return assignedToHtml}getPickIconDiv(){return'<div name="pickBtn" class="PI_usr"  onclick="TaskCommon.pickTaskConfirmation(this)" rcdlist="true"></div>'}getTaskCardList(taskId,taskDtl,taskStatus,taskStatusName,recordOwner,taskOwnerDetail,isDeletable){let taskDtlHtml=this.getTaskDetailHtml(taskDtl),statusClass=TaskStatus.getClass(taskStatus==TaskStatus.COMPLETED_SYSVALUE?TaskStatus.COMPLETED_SYSVALUE:TaskStatus.OPEN_SYSVALUE),titleMsg=taskStatus==TaskStatus.NA_SYSVALUE?"":taskStatus==TaskStatus.COMPLETED_SYSVALUE?ZPI18N.getString("zp.reopen"):ZPI18N.getString("zp.complete"),tskNACls=taskStatus==TaskStatus.NA_SYSVALUE?"zpl_disabl-pe":"",status_OptVal=TaskStatus.getOptionValueBySysVal(taskStatus),deleteTaskHtml=isDeletable?'<div class="zpl_hvr" taskid="'+taskId+'"><i class="PI_delete" onclick=TaskCommon.deleteTaskConfirmation(this) title="'+ZPI18N.getString("zp.delete")+'"></i></div>':"";return'<div class="zpl_crdlst" taskid="'+taskId+'" statusid="'+status_OptVal+'" onclick="TaskCommon.viewTask(\''+taskId+`')" role="button" tabindex="0" aria-label="${ZPI18N.getString("zp.taskname")} : ${taskDtl.name}. ${ZPA_Common.isNotNull(recordOwner)?ZPI18N.getString("zp.taskowner")+" : "+recordOwner.name:""}. ${ZPA_Common.isNotNull(taskDtl.endtime)?ZPI18N.getString("zp.duedate")+":"+taskDtl.endtime+".":""} ${taskDtl.prioritySysValue==TaskStatus.HIGH_SYSVALUE?ZPI18N.getString("zp.highpriority")+".":""}">\n                        <div class="zpl_catlst">\n\t                        <div><i tabindex="0" aria-label=${ZPI18N.getString("zp.taskcomplete")} role="button" class="zpl_tckchng zpl_act mw50 ${tskNACls} ${statusClass}" onclick="TaskCommon.changeStatus(this, '`+taskId+'\')" title="'+titleMsg+'"></i></div>\n\t                        '+taskDtlHtml+this.getStatusHtml(taskStatusName,taskStatus)+this.getTaskOwnerHtml(taskId,taskOwnerDetail)+'\n\t                        <div class="mw150 zpl_tskaction">'+deleteTaskHtml+"</div>\n                        </div>\n                    </div>"}getStatusHtml(taskStatusName,taskStatus){return`<div class="mw150 zpl_flex-a-c"><div name="tStatus" class=${TaskCommon.getStatusColor(taskStatus)}>${taskStatusName}</div></div>`}constructTaskList(isInitialLoad,isReset,statusIds){var taskBody="";if(this.isTaskEmpty())isReset&&(this.pageId.find("#"+this.mode+"_taskOperList").attr("aria-label",ZPI18N.getString("zp.nomatchtask")),this.loadEmptyPage(isInitialLoad),TaskCommon.isTaskCountAllowed(this.mode)&&this.setTaskCount(isInitialLoad,statusIds));else{isReset&&(taskBody=this.getTaskListHeader());let taskConstructObj=this;$.each(this.taskArr,function(index,taskDtl){let taskId=taskDtl.id,taskStatus=taskDtl.statusSysValue,taskStatusName=taskDtl.status,taskOwnerDetail=taskDtl.taskownerdetail,recordOwner=taskDtl.recordowner;taskBody+=taskConstructObj.getTaskCardList(taskId,taskDtl,taskStatus,taskStatusName,recordOwner,taskOwnerDetail,taskDtl.isDeletable)}),isReset&&this.pageId.find("#"+this.mode+"_taskOperList").empty(),this.pageId.find("#"+this.mode+"_taskOperList").append(taskBody),TaskCommon.isTaskCountAllowed(this.mode)&&this.setTaskCount(isInitialLoad,statusIds),this.hasNextPage&&ZPeople.FireScroll.reset(),this.pageId.find("#"+this.mode+"_taskOperList").attr("aria-label",ZPI18N.getString("zp.proceedingtasklist"))}}getTaskCountHtml(optionId,optionName,count,taskStatuscolour,isToSel){return'<li class="'+(isToSel?"zpl_act":"")+'" id="status_'+optionId+'" optId="'+optionId+`" name="countBar" role="tab" aria-selected= ${isToSel?"true":"false"} tabindex="0">\n\t\t\t\t\t<span title="`+optionName+'">'+optionName+'</span>\n\t\t\t\t\t<b name="status_count" class="'+taskStatuscolour+'">'+count+"</b>\n\t\t\t\t</li>"}getToSelectTaskCount(statusIds){var countToSel=TaskCommon.getPageMode()==TaskCommon.ALLTASK_MODE?0:TaskStatus.getOptionValueBySysVal(TaskStatus.OPEN_SYSVALUE);if(ZPA_Common.isNotNull(statusIds)){let statusIdAry=statusIds.split(",");countToSel=1==statusIdAry.length?statusIdAry[0]:""}return countToSel}setTaskCount(isInitialLoad,statusIds){var isCountReset=this.pageId.find("#task_Count").attr("reset");if(ZPA_Common.isNotNull(isCountReset)&&"false"==isCountReset)this.pageId.find("#task_Count").attr("reset",!0);else if(void 0!=this.taskOptions&&0!==this.taskOptions[0].count){let countHtml="",taskConstructObj=this,openSta_OptVal=this.getToSelectTaskCount(statusIds),mode=TaskCommon.getPageMode();$.each(this.taskOptions,function(index,taskOption){if(isInitialLoad||void 0===statusIds||""==statusIds||-1!==statusIds.indexOf(taskOption.option_id)){let optionName=taskOption.option_value,optionCnt=void 0!=taskOption.count?taskOption.count:"",optionId=taskOption.option_id,sysVal=taskOption.system_value,taskStatuscolour=TaskCommon.getStatusColor(sysVal,optionId),isToSel=openSta_OptVal===optionId;countHtml+=taskConstructObj.getTaskCountHtml(optionId,optionName,optionCnt,taskStatuscolour,isToSel)}}),this.pageId.find("#"+this.mode+"_taskOperCont").empty(),this.pageId.find("#"+this.mode+"_taskOperCont").append("<ul class='zpl_tpcrdlst' id='task_Count'>"+countHtml+"</ul>"),this.pageId.find("[name=countBar]").off().on("click",function(){$(this).closest("#task_Count").attr("reset",!1),$(this).siblings().attr("aria-selected","false"),$(this).attr("aria-selected","true"),$(this).siblings().removeClass("zpl_act"),$(this).addClass("zpl_act");var status_OptId=$(this).attr("optId");switch(TaskFilter.clearAllFilterResult(),mode){case TaskCommon.MYTASK_MODE:ZPA_TaskActivity.getMyTask(!0,!0,status_OptId);break;case TaskCommon.TRACKTASK_MODE:TaskCommon.getAllTask(TaskCommon.TRACKTASK_MODE,!0,!0,status_OptId);break;case TaskCommon.ALLTASK_MODE:TaskCommon.getAllTask(TaskCommon.ALLTASK_MODE,!0,!0,status_OptId)}})}}loadEmptyPage(isInitialLoad){let emptyMsg=isInitialLoad||!this.isFilterApplied()?ZPI18N.getString("zp.emptytasklist"):ZPI18N.getString("zp.nomatchtask");new EmptyPages("zp_nd_task",emptyMsg,"",this.pageId.find("#"+this.mode+"_taskOperList")).show()}isFilterApplied(){return this.pageId.find("[name=taskFilterHeader]").find("ul").find("li").length>0}}class TaskRecordHandler extends ModuleHandler{constructor(formClassObj){super(formClassObj),this.taskId=ZP5Form.getFormClassObj().getParams().recordId,this.statusSysVal=void 0}setTaskSysVal(statusSysVal){statusSysVal!=TaskStatus.OPEN_SYSVALUE&&statusSysVal!=TaskStatus.COMPLETED_SYSVALUE&&statusSysVal!=TaskStatus.NA_SYSVALUE||(this.statusSysVal=statusSysVal)}constructHeader(tableName,formHeaderDiv,container){formHeaderDiv.html(this.FORM_CLASS_OBJ.getCurrentFormMode()+"&nbsp;"+this.FORM_CLASS_OBJ.FormOperations.getFormDisplayName())}postFormConstructionModuleHandler(){this.FORM_CLASS_OBJ.isViewMode()&&(this.updateTaskHeaderName(),this.constructTaskDetails(),this.constructTaskComments())}singleFieldEditCallback(){this.FORM_CLASS_OBJ.isViewMode()&&(this.updateTaskHeaderName(),this.constructTaskDetails(),this.updateTaskListing(),ZP5Form.refreshRecord(TaskCommon.getTaskFormId(),this.taskId))}loadParamsForSubmit(params){var pageId=this.FORM_CLASS_OBJ.LAYOUT;this.FORM_CLASS_OBJ.isAddMode()&&pageId.attr("addRelatedTask")&&(params.related_recordid=pageId.attr("related_recordid"),params.related_formid=pageId.attr("related_formid"))}getEditCallback(){var currMode=Layout.Page.currentmode;ZP5Form.getLayout().remove();var params={formId:TaskCommon.getTaskFormId(),recordId:this.taskId,formMode:"EDIT"};if(currMode.indexOf("taskuserview/view")<0&&currMode.indexOf("taskadminview/view")<0){params.disableUrlTrack=!0,ZP5Form._toForm(params).setPreviewForm(Boolean.TRUE).setFormModel(ZP5Form.MODEL.SLIDER_MEDIUM).init()}else ZP5Form.load(params,Boolean.TRUE)}updateTaskHeaderName(){var pageId=this.FORM_CLASS_OBJ.LAYOUT;pageId.find("#zp_form_createinfo").addClass("DNI"),pageId.find("#ZP_Form_MoreOpt").addClass("DNI");var headerCont=pageId.find("#zp_form_header div:first");let taskDispName=pageId.find("[folabel=Task_Name]").find("span").text(),status=pageId.find("[folabel=Status]").find("span").text(),status_sysvalue=TaskStatus.getSysValue(pageId.find("[folabel=Status]").attr("id").split("_").pop(),ZP5Form.getCurrFormsOperation().formId,status);this.setTaskSysVal(status_sysvalue),headerCont.empty(),headerCont.addClass("zpl_w-80"),headerCont.append(this.getTaskRecordHeader(taskDispName)),headerCont.find("[name=taskStatus]").off().on("click",ele=>{this.changeTaskRecordStatus(ele.target)})}updateTaskListing(){var taskRow=Layout.Page.container.find(".zpl_rgtCnt").find("[taskid="+this.taskId+"]");this.statusSysVal==TaskStatus.COMPLETED_SYSVALUE?(taskRow.find(".zpl_tckchng").removeClass(TaskStatus.getClass(TaskStatus.OPEN_SYSVALUE)),taskRow.find(".zpl_tckchng").addClass(TaskStatus.getClass(TaskStatus.COMPLETED_SYSVALUE)),taskRow.find(".zpl_tckchng").title(ZPI18N.getString("zp.reopen"))):(taskRow.find(".zpl_tckchng").removeClass(TaskStatus.getClass(TaskStatus.COMPLETED_SYSVALUE)),taskRow.find(".zpl_tckchng").addClass(TaskStatus.getClass(TaskStatus.OPEN_SYSVALUE)),taskRow.find(".zpl_tckchng").title(ZPI18N.getString("zp.complete")))}changeTaskRecordStatus(thisObj){var pageId=this.FORM_CLASS_OBJ.LAYOUT,status=$(thisObj).hasClass(TaskStatus.getClass(TaskStatus.COMPLETED_SYSVALUE))?TaskStatus.OPEN_SYSVALUE:TaskStatus.COMPLETED_SYSVALUE;if(TaskCommon.changeStatus(thisObj,this.taskId,"taskRecord",!1)){let status_sysvalue=TaskStatus.getOptionValue(pageId.find("[folabel=Status]").attr("id").split("_").pop(),ZP5Form.getCurrFormsOperation().formId,status);if(pageId.find("[folabel=Status]").find("span").text(ZPeople.decodeTxt(status_sysvalue)),status==TaskStatus.COMPLETED_SYSVALUE){var timesplit=new Date(ZPDateTime.convertToTimezone((new Date).getTime())).constructor().split(" ");pageId.find("[folabel=Completed_On]").find("span").text(timesplit[1]+" "+timesplit[2]+" "+timesplit[3]+" "+timesplit[4]),pageId.find("[folabel=Completed_By]").find("span").text(ZPeople.decodeTxt(ZPeople.getUserDetailsById(erecno).name))}this.constructTaskDetails()}}postPickTaskHandle(taskId){ZP5Form.refreshRecord(TaskCommon.getTaskFormId(),taskId),this.FORM_CLASS_OBJ.LAYOUT.find("[folabel=Task_Owner]").find("span").text(ZPeople.decodeTxt(ZPeople.getUserDetailsById(erecno).name)),this.constructTaskDetails()}constructTaskDetails(){var pageId=this.FORM_CLASS_OBJ.LAYOUT;if(this.FORM_CLASS_OBJ.isViewMode()){let statusId=pageId.find("[folabel=Status]").attr("id").split("_").pop(),status=pageId.find("[folabel=Status]").find("span")[0].textContent,statusVal=TaskStatus.getSysValue(statusId,ZP5Form.getCurrFormsOperation().formId,status);var taskDtl={taskOwner:pageId.find("[folabel=Task_Owner]").find("span")[0].textContent,statusSysVal:statusVal,statusText:ZSEC.Encoder.encodeForHTML(status)};if(statusVal==TaskStatus.COMPLETED_SYSVALUE){pageId.find("[folabel=Completed_On]").parent().removeClass("DNI"),pageId.find("[folabel=Completed_By]").parent().removeClass("DNI");let completedOnDiv=pageId.find("[folabel=Completed_On]");var completedOnVal=completedOnDiv.find("span").text();let completedOnLabel=completedOnDiv.siblings().find("label").text();taskDtl.timelabel=completedOnLabel,taskDtl.timeStr=completedOnVal}else{let duedateDiv=pageId.find("[folabel=Due_Date]"),dueDate=duedateDiv.find("span").text(),dueDateLabel=duedateDiv.siblings().find("label").text();var dueDateStr=void 0!=dueDate&&"-"!=dueDate?dueDate:ZPI18N.getString("zp.noduedate");taskDtl.timelabel=dueDateLabel,taskDtl.timeStr=dueDateStr,pageId.find("[folabel=Completed_On]").parent().addClass("DNI"),pageId.find("[folabel=Completed_By]").parent().addClass("DNI")}pageId.find("#sectionsparent").find("[name=taskdetails]").remove(),pageId.find("#sectionsparent .zpl_crd").first().before(this.getTaskDetailsHTML(taskDtl)),pageId.find("[name=taskdetails]").find("[name=pickBtn]").off().on("click",ele=>{TaskCommon.pickTaskConfirmation(ele.target,this)})}}constructTaskComments(){var pageId=this.FORM_CLASS_OBJ.LAYOUT,taskFeedcomments=ZP5Form.getSingleRecord().record.taskFeedComments;taskFeedcomments.actRecId=ZP5Form.getFormClassObj().getFormsProperties().getRecordId(),taskFeedcomments.subBtnCallBack=TaskCommon.postTaskComment,taskFeedcomments.delBtnCallBack=TaskCommon.deleteComment,taskFeedcomments.comments.forEach(function(comment){void 0==comment.commentText?(comment.content=ZSEC.Encoder.encodeForHTML(comment.content),comment.commentText=comment.content):comment.content=ZPFeeds.Activity.getSmileys(comment.content)});taskFeedcomments.comments;var commentHtml='<div class="zpl_crd" id="commBody" streamid="'+ZP5Form.getFormClassObj().getFormsProperties().getRecordId()+'">';commentHtml+="</div></div></div>",pageId.find("#sectionsparent").append(commentHtml);ZPA_Common.constructCmtRw(taskFeedcomments,pageId.find("#commBody"),{subBtnName:"zp.comment",removeGray:!0})}getTaskRecordHeader(taskDispName){var taskOwnDtl=ZP5Form.getSingleRecord().record.message.cAuditInfo.cInfo.user,taskOwnerDispName=taskOwnDtl.id+" "+taskOwnDtl.name,statusCls=this.statusSysVal==TaskStatus.COMPLETED_SYSVALUE?TaskStatus.getClass(TaskStatus.COMPLETED_SYSVALUE):TaskStatus.getClass(TaskStatus.OPEN_SYSVALUE),tooltipTxt=this.statusSysVal==TaskStatus.NA_SYSVALUE?"":this.statusSysVal==TaskStatus.COMPLETED_SYSVALUE?ZPI18N.getString("zp.reopen"):ZPI18N.getString("zp.complete");return`<div class="zpl_em">\n                    <div class="zpl_emimg">\n                        <i name="taskStatus" class="${statusCls} ${this.statusSysVal==TaskStatus.NA_SYSVALUE?"zpl_disabl-pe":""} zpl_tckchng" title="`+tooltipTxt+'"></i>\n                    </div>\n                    <div class="zpl_emdts">\n                        <div class="zpl_w-100" title="'+ZSEC.Encoder.encodeForHTML(taskDispName)+'">\n                            <h6 class="zpl_ellipsis">'+ZSEC.Encoder.encodeForHTML(taskDispName)+'</h6>\n                        </div>\n                        <div class="zpl_w-100" title="'+ZPI18N.getString("zp.initiatedby")+" "+ZSEC.Encoder.encodeForHTML(taskOwnerDispName)+'">\n                            <em class="zpl_ellipsis">'+ZPI18N.getString("zp.initiatedby")+" "+ZSEC.Encoder.encodeForHTML(taskOwnerDispName)+"</em>\n                        </div>\n                    </div>\n                </div>"}getTaskDetailsHTML(taskDtl){let taskDtlHTML="",cls=taskDtl.statusSysVal==TaskStatus.COMPLETED_SYSVALUE?"grn":"";return taskDtlHTML+='<div class=\'zpl_admclr\' name="taskdetails" taskid="'+this.taskId+"\"><div class='zpl_admclr_crd'>\n\t\t\t\t\t\t\t<div><span>"+ZPI18N.getString("zp.taskowner")+"</span>"+this.getTaskOwnerHtml(taskDtl)+'</div>\n\t\t\t\t\t\t\t<div class="zpl_admclr_rgt">\n                            <div>\n                                <span>'+taskDtl.timelabel+"</span>\n                                <span><b>"+taskDtl.timeStr+'</b></span>\n                            </div>\n                            <div class="zpl_stsRstcn">\n                                <span>'+ZPI18N.getString("zp.status")+'</span>\n                                <span class="'+cls+'" title="'+taskDtl.statusText+'"><b>'+taskDtl.statusText+"</b></span>\n                            </div>\n                        </div></div></div>"}getTaskOwnerHtml(taskDtl){var pageId=this.FORM_CLASS_OBJ.LAYOUT;let taskOwnerImg="",taskOwnDispName="",unassignedIcon="",prefixHtml="";if("-"==taskDtl.taskOwner)taskOwnDispName=pageId.find("[folabel=Assigned_To]").find("span")[0].textContent,prefixHtml='<div class="zpl_emimg"><span class="zpl_pichr PC2">'+this.getTaskownPrefix(taskOwnDispName)+"</span></div>",unassignedIcon='<span class="zpl_dots"></span><a name="pickBtn">'+ZPI18N.getString("zp.picktask")+"</a>";else{taskOwnDispName=taskDtl.taskOwner;let taskOwnerErecNo=ZP5Form.getSingleRecord().record.message.ownerID[0];taskOwnerImg='<div class="zpl_emimg"><img src="'+ZPeople.applyPortalName(ZPeople.getUserDetailsById(taskOwnerErecNo).avatar)+'"></div>'}return'<div class="zpl_em">\n                    '+prefixHtml+taskOwnerImg+'\n                    <div class="zpl_emdts zpl_ellipsis">\n                        <div title="'+ZSEC.Encoder.encodeForHTML(taskOwnDispName)+'"><b>'+ZSEC.Encoder.encodeForHTML(taskOwnDispName)+"</b> "+unassignedIcon+"\n                     \t</div>\n                    </div>\n                </div>"}getTaskownPrefix(taskOwnName){var prefixTextArray=taskOwnName.match(/\b[a-z]/gi);return((prefixTextArray=prefixTextArray||[])[0]||name.charAt(0))+(prefixTextArray[1]||name.charAt(1))}submitCallback(resultData,param){var currUrl=Layout.Page.currentmode;if(-1!=currUrl.indexOf(TaskCommon.MYTASK_MODE)||-1!=currUrl.indexOf(TaskCommon.TRACKTASK_MODE)||-1!=currUrl.indexOf(TaskCommon.UNASSIGNEDTASK_MODE)||-1!=currUrl.indexOf(TaskCommon.WATCHLIST_MODE)||-1!=currUrl.indexOf("taskadminview/overdue")||-1!=currUrl.indexOf("taskadminview/pending")||-1!=currUrl.indexOf("taskadminview/highpriority")||-1!=currUrl.indexOf("taskadminview/completed")||-1!=currUrl.indexOf(TaskCommon.ALLTASK_MODE))-1!=Layout.Page.hash.indexOf("addtask")?(-1!=currUrl.indexOf(TaskCommon.MYTASK_MODE)?ZPA_TaskActivity.getMyTask(!0,!0):-1!=currUrl.indexOf("taskadminview/alltask")&&TaskCommon.getAllTask(TaskCommon.ALLTASK_MODE,!0,!0),window.location.href="#"+currUrl+"/viewtask-taskid:"+resultData[0].pkId):(ZP5Form.closeCallback(),TaskCommon.openViewTask(resultData[0].pkId));else if(-1!=currUrl.indexOf("checklist/trackchecklist")||-1!=currUrl.indexOf("checklist/relatedchecklist")||-1!=currUrl.indexOf("checklist/pending")||-1!=currUrl.indexOf("checklist/completed"))ZP5Form.closeCallback(),TaskCommon.openViewTask(resultData[0].pkId);else if(-1!=currUrl.indexOf("taskadminview/add")||-1!=currUrl.indexOf("taskuserview/add")){let formUrl=currUrl.substring(0,currUrl.lastIndexOf("/"))+"/view-recordId:"+resultData[0].pkId;window.location.href="#"+formUrl}else if(-1!=currUrl.indexOf("taskadminview")||-1!=currUrl.indexOf("taskuserview")){let closeCBUrl=this.FORM_CLASS_OBJ.moduleHandler.close();window.location.href="#"+closeCBUrl,ZP5Form.closeCallback()}else ZP5Form.closeCallback()}close(){var closeUrl=Layout.Page.currentmode;return-1==closeUrl.indexOf("taskuserview")&&-1==closeUrl.indexOf("taskadminview")||-1==closeUrl.indexOf("/view")&&-1==closeUrl.indexOf("/add")&&-1==closeUrl.indexOf("/edit")||(closeUrl=closeUrl.substring(0,closeUrl.lastIndexOf("/"))+"/listview"),closeUrl}draftBtnNotNeed(){return!0}}ZPTaskWidget={RELATETASKTEMPLATE:$('<li><div id="taskContainer"><i class="IC-task-unchk" id="rt_completebutton"></i><i id="unassignedicon" data-toggle="tooltip" data-placement="top" data-original-title='+ZPI18N.getString("zp.pick")+' onclick="ZPeople.confirm(this,\'\',\'zp.taskpickmessage\', Task.pickupTask)"></i><div class="ZP_photo" data-toggle="tooltip" data-placement="top" data-original-title="" id="rt_taskownerpic"><img></div><div class="zp_txtbx"><div id="rt_taskname"></div></div><div class="zp_txtbx"><input id="rt_duedate" type="textbox"><i id="rt_delete" class="IC-delete"></i></div></div></li>'),construct(taskDetails){var taskRowsContainer=$("#"+Layout.Page.pageId).find("#MYPENDINGTASKS"),quickui="";0!==taskDetails.count[0].count?(quickui='<div class="zp_Task" style="padding-top: 0;" id="rt_table"><div class="zp_TLst"><ul><li id="newquicktask" class="zp_dyn"><i class="IC-task-unchk" onclick="Task.addQuickTask(Task.COMPLETED_SYSVALUE)"></i><div class="zp_txtbx"><input type="textbox" id="quicktaskname"></div><div class="ZP_photo" id="tUser" ownervalueid='+erecno+' onclick="Dropdown.taskUserdropdown(this)"><img src='+ZPeople.CURR_USER.avatar+'></div><div class="zp_txtbx"><input class="zp_ntsk" type="textbox" id="quicktaskdue" caltype ='+Task.getCalType()+'  onclick="Calendar.setUpCalendar(event,this,null,null,Task.addTaskByDate)"></div></li></ul></div>',taskRowsContainer.append(quickui),taskRowsContainer.find("#quicktaskname").attr("placeholder",ZPI18N.getString("zp.taskname")),taskRowsContainer.find("#quicktaskdue").attr("placeholder",ZPI18N.getString("zp.duedate")),ZPTaskWidget.cloneTaskRow(taskDetails.tasks)):taskRowsContainer.append('<div class="ZPNdata " id=""><h5 id="zp_views_nodata">'+ZPI18N.getString("zp.notaskforfilter")+"</h5></div>"),taskRowsContainer.find("#zp_page_loading").remove()},cloneTaskRow(taskArr,parentDiv){var pageId=$("#"+Layout.Page.pageId),currentRow="",row="";TaskPermission.get(),TaskStatus.getOptionValues();for(var index=0;index<taskArr.length;index++){if(row=taskArr[index],(currentRow=ZPTaskWidget.RELATETASKTEMPLATE.clone().attr("id","rt_"+row.id)).attr("taskid",row.id),currentRow.find("#rt_taskname").html(row.name),row.isDeletable&&!row.isDraft?currentRow.find("#rt_delete").attr("onclick","TaskCommon.deleteTaskConfirmation(this)"):currentRow.find("#rt_delete").remove(),void 0==row.endtime?currentRow.find("#rt_duedate").val(ZPI18N.getString("zp.noduedate")):currentRow.find("#rt_duedate").val(row.endtime),isadmin||row.istaskowner||ZP5Form.Permission.isAllowed([row.taskowner],Task.editPerm)?currentRow.find("#rt_completebutton").attr("onclick",'TaskCommon.changeStatus(this, "'+row.id+"\", 'widget')"):currentRow.find("#rt_completebutton").remove(),void 0!=row.priority&&(1===TaskStatus.priorityObj[row.priority].SYSVALUE?currentRow.find("#rt_completebutton").addClass("zp_rclr"):3===TaskStatus.priorityObj[row.priority].SYSVALUE&&currentRow.find("#rt_completebutton").addClass("zp_oclr")),row.iscompleted?(currentRow.find("#taskContainer").addClass("zp_cmpl"),currentRow.find("#rt_duedate").val(row.dispCompletedTime)):row.isoverdue&&currentRow.find("#rt_duedate").addClass("zp_rclr"),void 0!==row.taskownerdetail?(currentRow.find("#rt_taskownerpic").find("img").attr("src",row.taskownerdetail.employeePhoto),currentRow.find("#rt_taskownerpic").attr("popup","user").attr("empid",row.taskownerdetail.zuid),currentRow.find("#unassignedicon").remove()):row.isDraft||!row.istaskowner?currentRow.find("#rt_taskownerpic").find("img").attr("alt",ZPeople.getShortName(row.assignedto)):(currentRow.find("#rt_taskownerpic").addClass("zp_dyn"),currentRow.find("#unassignedicon").addClass("IC-add-usr")),row.isDraft?(currentRow.find("#rt_completebutton").addClass("zp_dyn"),currentRow.find("#rt_duedate").val(ZPI18N.getString("zp.chkyettostart")),currentRow.click(function(event){event.stopPropagation()})):(currentRow.find("#taskContainer").attr("onclick",'TaskCommon.openViewTask("'+row.id+'")'),pageId.addClass("tskptch")),void 0===parentDiv)pageId.find("#newquicktask").parent().append(currentRow);else{var parentTaskDivId="#rt_"+row.parenttaskid;void 0===row.parenttaskid||0==row.parenttaskid?parentDiv.append(currentRow):0!=parentDiv.find(parentTaskDivId).length?(parentDiv.find(parentTaskDivId).append("<ul childid="+row.id+"></ul>"),parentDiv.find("[childid="+row.id+"]").append(currentRow)):taskArr.push(row)}currentRow.find("#rt_completebutton").click(function(event){event.stopPropagation()}),currentRow.find("#rt_delete").click(function(event){event.stopPropagation()}),currentRow.find("#unassignedicon").click(function(event){event.stopPropagation()}),void 0===TaskCommon.taskformid&&(TaskCommon.taskformid=row.taskformid)}},viewRelatedTask:function(taskid,obj){delete ZPForm.SINGLE_RECORD_DTL[Task.taskformid+"_"+taskid];var isFromChecklist=void 0!==$(obj).parents("ul[checkrootid]").attr("checkrootid"),pageId=$("#"+Layout.Page.pageId),recordId=ZPForm.CURRFORM_PARAM.recordId,formId=ZPForm.CURRFORM_PARAM.formId;if(isFromChecklist){pageId.find("#rootTaskTriggerDtlsPage");pageId.find("#rootTaskTriggerDtlsPage").remove(),Task.showTaskDetails(taskid,!0),$($(".modal-backdrop.in")[1]).remove(),pageId.find("#task_closebutton").click(function(){void 0===recordId?($(".modal-backdrop").remove(),ZPChecklist.checklistTriggerData(ZPChecklist.rootLink)):ZPChecklist.getChecklistsForRecord(recordId,formId)}),pageId.find("#task_editicon").attr("isFromChecklist",!0)}else ZPView.Record.getFormPage("VIEW",taskid,obj)},fireScroll:function(){var taskobj={},taskBox=$("#"+Layout.Page.pageId).find("#rt_table").find("ul");TaskStatus.getStatusOptionValuesBySysVal(),taskobj.status=TaskStatus.statusBySysVal[TaskStatus.OPEN_SYSVALUE].ID,taskobj.index=taskBox.find("li").length-taskBox.find("li.zp_cmpl").length,$.post("/mytasks.zp",{conreqcsr:csrfToken,method:"getMyTasks",criteria:JSON.stringify(taskobj)},function(data){data.hasNextPage&&ZPeople.FireScroll.reset(),ZPTaskWidget.cloneTaskRow(data.tasks)})}},TaskFilter={construct:function(){var pageId=TaskCommon.getPageId();ZPeopleComponents.select(pageId.find("[name=priority]"),TaskFilter.getPriorityFilterProp()),ZPeopleComponents.select(pageId.find("[name=status]"),TaskFilter.getStatusFilterProp()),ZPeopleComponents.select(pageId.find("[name=rel_forms]"),TaskFilter.getFormFilterProp()),TaskCommon.getPageMode()===TaskCommon.ALLTASK_MODE&&ZPeopleComponents.select(pageId.find("[name=taskowner]"),TaskFilter.getTaskOwnerFilterProp())},showHide:function(){var pageId=TaskCommon.getPageId();pageId.hasClass("zpl_fltr_flt")?TaskFilter.hide(pageId):TaskFilter.show(pageId)},show:function(pageId){pageId.addClass("zpl_fltr_flt"),pageId.find('[name="taskFilter"]').focus(),pageId.on("keydown",function(e){"Escape"===e.key&&(TaskFilter.hide(pageId),pageId.off("keydown"))})},hide:function(pageId){pageId.removeClass("zpl_fltr_flt"),pageId.find('[name="filter"]').focus()},clearAllFilter:function(){TaskFilter.resetFilter(),TaskFilter.applyFilter(!0)},clearAllFilterResult:function(){TaskFilter.resetFilter(),TaskFilter.constructFilterResult()},resetFilter:function(){let pageMode=TaskCommon.getPageMode(),filterCont=TaskCommon.getPageId().find("[name=taskFilter]");filterCont.find("[name=taskname]").val(""),pageMode!=TaskCommon.HIGHPRIORITYTASK_MODE&&ZPeopleComponents.select(filterCont.find("[name=priority]")).deselectAllOptions(),pageMode!=TaskCommon.COMPLETEDTASK_MODE&&pageMode!=TaskCommon.PENDINGTASK_MODE&&pageMode!=TaskCommon.UNASSIGNEDTASK_MODE&&ZPeopleComponents.select(filterCont.find("[name=status]")).deselectAllOptions(),pageMode===TaskCommon.ALLTASK_MODE&&ZPeopleComponents.select(filterCont.find("[name=taskowner]")).deselectAllOptions(),ZPeopleComponents.select(filterCont.find("[name=rel_forms]")).deselectAllOptions()},applyFilter:function(isClearAll){let pageMode=TaskCommon.getPageMode(),pageId=TaskCommon.getPageId(),filterCont=pageId.find("[name=taskFilter]"),taskName=filterCont.find("[name=taskname]").val(),formIds=ZPeopleComponents.select(filterCont.find("[name=rel_forms]")).getValue().toString();pageId.find("#task_Count").attr("reset",!0);var filterObj={};if(ZPA_Common.isNotNull(taskName)&&(filterObj.taskName=taskName),pageMode!=TaskCommon.HIGHPRIORITYTASK_MODE){var priorityDispNames="",priorityIds=ZPeopleComponents.select(filterCont.find("[name=priority]")).getValue().toString();if(ZPA_Common.isNotNull(priorityIds)){filterObj.priority=priorityIds;let priorityList=ZPeopleComponents.select(filterCont.find("[name=priority]")).options;$.each(priorityList,function(ind,priorityObj){-1!=priorityIds.indexOf(priorityObj.id)&&(ZPA_Common.isNotNull(priorityDispNames)&&(priorityDispNames+=", "),priorityDispNames+=priorityObj.value)})}}if(pageMode!=TaskCommon.COMPLETEDTASK_MODE&&pageMode!=TaskCommon.UNASSIGNEDTASK_MODE){var statusDispNames="",statusIds=ZPeopleComponents.select(filterCont.find("[name=status]")).getValue().toString();if(ZPA_Common.isNotNull(statusIds)){let statusList=ZPeopleComponents.select(filterCont.find("[name=status]")).options;$.each(statusList,function(ind,statusObj){-1!=statusIds.indexOf(statusObj.id)&&(ZPA_Common.isNotNull(statusDispNames)&&(statusDispNames+=", "),statusDispNames+=statusObj.value)})}}if(pageMode===TaskCommon.ALLTASK_MODE){var taskOwnerName="",taskOwnerErecno=ZPeopleComponents.select(filterCont.find("[name=taskowner]")).getValue();ZPA_Common.isNotNull(taskOwnerErecno)&&(filterObj.taskOwner=taskOwnerErecno,taskOwnerName=ZPeopleComponents.select(filterCont.find("[name=taskowner]")).getOptionData()[0].label)}if(ZPA_Common.isNotNull(formIds)){filterObj.relFormIds=formIds;var formDispNames="";let formsList=ZPeopleComponents.select(filterCont.find("[name=rel_forms]")).options;$.each(formsList,function(ind,formObj){-1!=formIds.indexOf(formObj.id)&&(ZPA_Common.isNotNull(formDispNames)&&(formDispNames+=", "),formDispNames+=formObj.value)})}TaskFilter.constructFilterResult(taskName,priorityDispNames,statusDispNames,formDispNames,taskOwnerName),pageId.find("[name=rgtWrapperDiv]").removeClass("zpl_fltr_flt");let initialLoad=!1;switch(isClearAll&&(initialLoad=!0),pageMode){case TaskCommon.MYTASK_MODE:case TaskCommon.UNASSIGNEDTASK_MODE:ZPA_TaskActivity.getMyTask(!0,initialLoad,statusIds,filterObj);break;default:TaskCommon.getAllTask(pageMode,!0,initialLoad,statusIds,filterObj)}TaskFilter.hide(pageId)},getFilterResult:function(){let pageMode=TaskCommon.getPageMode(),filterCont=TaskCommon.getPageId().find("[name=taskFilter]");var filterObj={};let taskName=filterCont.find("[name=taskname]").val();ZPA_Common.isNotNull(taskName)&&(filterObj.taskName=taskName);var priorityIds=ZPeopleComponents.select(filterCont.find("[name=priority]"))?ZPeopleComponents.select(filterCont.find("[name=priority]")).getValue().toString():"";ZPA_Common.isNotNull(priorityIds)&&(filterObj.priority=priorityIds);let formIds=ZPeopleComponents.select(filterCont.find("[name=rel_forms]"))?ZPeopleComponents.select(filterCont.find("[name=rel_forms]")).getValue().toString():"";if(ZPA_Common.isNotNull(formIds)&&(filterObj.relFormIds=formIds),pageMode===TaskCommon.ALLTASK_MODE){let taskOwner=ZPeopleComponents.select(filterCont.find("[name=taskowner]")).getValue();ZPA_Common.isNotNull(taskOwner)&&(filterObj.taskOwner=taskOwner)}return filterObj},constructFilterResult:function(taskName,priorityDispNames,statusDispNames,formDispNames,taskOwnerName){let ariaLabel,taskFilterHead=TaskCommon.getPageId().find("[name=taskFilterHeader]");taskFilterHead.hasClass("DNI")&&taskFilterHead.removeClass("DNI"),taskFilterHead.find("ul").empty(),ZPA_Common.isNotNull(taskName)&&(ariaLabel=ZPI18N.getString("zp.taskname")+" : "+ZPA_Common.encodeHtml(taskName),taskFilterHead.find("ul").append("<li fil_name=\"taskname\" tabindex='0' role='tab' aria-label='"+ariaLabel+"'><label>"+ZPI18N.getString("zp.taskname")+" : </label><span title='"+ZPA_Common.encodeHtml(taskName)+"'>"+ZPA_Common.encodeHtml(taskName)+"</span><a class='PI_cls' onclick='TaskFilter.removeFilterTag(this)' title='"+ZPI18N.getString("zp.clear")+"' tabindex='0'></a></li>")),ZPA_Common.isNotNull(priorityDispNames)&&(ariaLabel=ZPI18N.getString("zp.priority")+" : "+ZPA_Common.encodeHtml(priorityDispNames),taskFilterHead.find("ul").append("<li fil_name=\"priority\" tabindex='0' role='tab' aria-label='"+ariaLabel+"'><label>"+ZPI18N.getString("zp.priority")+" : </label><span title='"+ZPA_Common.encodeHtml(priorityDispNames)+"'>"+ZPA_Common.encodeHtml(priorityDispNames)+"</span><a class='PI_cls' onclick='TaskFilter.removeFilterTag(this)' title='"+ZPI18N.getString("zp.clear")+"' tabindex='0'></a></li>")),ZPA_Common.isNotNull(statusDispNames)&&(ariaLabel=ZPI18N.getString("zp.status")+" : "+ZPA_Common.encodeHtml(statusDispNames),taskFilterHead.find("ul").append("<li fil_name=\"status\" tabindex='0' role='tab' aria-label='"+ariaLabel+"'><label>"+ZPI18N.getString("zp.status")+" : </label><span title='"+ZPA_Common.encodeHtml(statusDispNames)+"'>"+ZPA_Common.encodeHtml(statusDispNames)+"</span><a class='PI_cls' onclick='TaskFilter.removeFilterTag(this)' title='"+ZPI18N.getString("zp.clear")+"' tabindex='0'></a></li>")),ZPA_Common.isNotNull(formDispNames)&&(ariaLabel=ZPI18N.getString("zp.relatedforms")+" : "+ZPA_Common.encodeHtml(formDispNames),taskFilterHead.find("ul").append("<li fil_name=\"rel_forms\" tabindex='0' role='tab' aria-label='"+ariaLabel+"'><label>"+ZPI18N.getString("zp.relatedforms")+" : </label><span title='"+ZPA_Common.encodeHtml(formDispNames)+"'>"+ZPA_Common.encodeHtml(formDispNames)+"</span><a class='PI_cls' onclick='TaskFilter.removeFilterTag(this)' title='"+ZPI18N.getString("zp.clear")+"' tabindex='0'></a></li>")),ZPA_Common.isNotNull(taskOwnerName)&&(ariaLabel=ZPI18N.getString("zp.taskowner")+" : "+taskOwnerName,taskFilterHead.find("ul").append("<li fil_name=\"taskowner\" tabindex='0' role='tab' aria-label='"+ariaLabel+"'><label>"+ZPI18N.getString("zp.taskowner")+" : </label><span title='"+taskOwnerName+"'>"+taskOwnerName+"</span><a class='PI_cls' onclick='TaskFilter.removeFilterTag(this)' title='"+ZPI18N.getString("zp.clear")+"' tabindex='0'></a></li>")),0==taskFilterHead.find("ul li").length&&taskFilterHead.addClass("DNI")},removeFilterTag:function(thisObj){let filterCont=TaskCommon.getPageId().find("[name=taskFilter]"),filterName=$(thisObj).parent().attr("fil_name");ZPA_Common.isNotNull(filterName)&&"taskname"==filterName?filterCont.find("[name=taskname]").val(""):ZPeopleComponents.select(filterCont.find("[name="+filterName+"]")).deselectAllOptions(),TaskFilter.applyFilter()},getPriorityFilterProp:function(){var priorityArr=[];$.each(TaskStatus.getPriorityArray(),function(key,value){var param={id:value.ID,value:value.DISPVALUE};priorityArr.push(param)});var priorityProp={options:priorityArr,selectedValue:"",multiple:!0,dataMapping:{label:"value",value:"id",title:"value"}};return ZPA_Common.ZCompProp.loadSelectListProp(priorityProp),priorityProp},getStatusFilterProp:function(){var statusArr=[],validStatus=TaskCommon.getPageMode()==TaskCommon.PENDINGTASK_MODE?TaskFilter.getPendingStatus():TaskStatus.getStatusArray();$.each(validStatus,function(key,value){var param={id:value.ID,value:value.DISPVALUE};statusArr.push(param)});var statusProp={options:statusArr,selectedValue:"",multiple:!0,dataMapping:{label:"value",value:"id",title:"value"}};return ZPA_Common.ZCompProp.loadSelectListProp(statusProp),statusProp},getPendingStatus:function(){var statusArr=TaskStatus.getStatusArray(),pendingArr=[];return $.each(statusArr,function(i,row){row.SYSVALUE!=TaskStatus.OPEN_SYSVALUE&&row.SYSVALUE!=TaskStatus.INPROGRESS_SYSVALUE&&row.SYSVALUE!=TaskStatus.ONHOLD_SYSVALUE||pendingArr.push(row)}),pendingArr},getFormFilterProp:function(){var formArr=[];ZPA_Common.getFormList(TaskCommon.CHECKLIST_MODE),$.each(ZPA_Common[ZPA_Common.getFormListMode(TaskCommon.CHECKLIST_MODE)],function(key,value){var param={id:value.formId,value:value.dispName};formArr.push(param)});var relFormProp={options:formArr,selectedValue:"",multiple:!0,dataMapping:{label:"value",value:"id",title:"value"}};return ZPA_Common.ZCompProp.loadSelectListProp(relFormProp),relFormProp},getTaskOwnerFilterProp:function(){let taskOwnerProp={};return taskOwnerProp.dataSource={search:function(params){return new Promise(function(search,reject){search({delay:20,results:EmployeeSearch.getEmpList(params.query,"emp","TASKS_VIEW"),more:!1})})},paginated:!0},taskOwnerProp.dataMapping={value:"id",label:"value",image:"image",title:"value"},taskOwnerProp.serverSearch=!0,taskOwnerProp.cacheData=!0,taskOwnerProp.contentType="image-text",taskOwnerProp.search={by:["value","email"]},ZPA_Common.ZCompProp.loadSelectListProp(taskOwnerProp,!0),taskOwnerProp},getHtml:function(){var pageMode=TaskCommon.getPageMode();let filterHtml=`<div class="zpl_fltr" name="taskFilter" role="dialog" aria-label="${ZPI18N.getString("zp.filterpopupselected")}" tabindex="0">\n\t\t\t\t\t\t\t\t<div name="fltrheader">\n\t\t\t\t\t\t\t\t\t<div class="zpl_fltrhd">\n\t\t                       \t\t\t <h5>`+ZPI18N.getString("zp.filter")+'</h5><i class="PI_cls" tabindex="0" aria-label="Close" role="button" onclick="TaskFilter.showHide()"></i>\n\t\t                   \t\t\t </div>\n\t\t                   \t\t\t <div class="zpl_search zpl_srchsml">\n\t\t                        \t\t<input name="taskname" placeholder="'+ZPI18N.getString("zp.taskname")+'" type="search" role="search" tabindex="0" class="ztextbox"><i class="PI_lens"></i>\n\t\t                    \t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="zpl_fltrcnt"><div class="zpl_fltrlst">';return pageMode!=TaskCommon.HIGHPRIORITYTASK_MODE&&(filterHtml+='\n\t\t\t\t\t\t\t\t<div class="zpl_secn">\n\t                                    \t<div><label>'+ZPI18N.getString("zp.priority")+"</label></div>\n\t\t\t                            \t<div><select name='priority'></select></div>\n\t\t\t                    </div>"),filterHtml+='<div class="zpl_secn">\n\t                                    \t<div><label>'+ZPI18N.getString("zp.relatedforms")+"</label></div>\n\t\t\t                            \t<div><select name='rel_forms'></select></div>\n\t\t\t                    </div>",pageMode===TaskCommon.ALLTASK_MODE&&(filterHtml+='<div class="zpl_secn">\n\t\t\t\t\t\t\t\t<div><label>'+ZPI18N.getString("zp.taskowner")+"</label></div>\n\t\t\t\t\t\t\t\t<div><select name='taskowner'></select></div>\n\t\t\t\t\t\t\t</div>"),pageMode!=TaskCommon.COMPLETEDTASK_MODE&&pageMode!=TaskCommon.UNASSIGNEDTASK_MODE&&(filterHtml+='<div class="zpl_secn">\n\t                                \t<div><label>'+ZPI18N.getString("zp.status")+"</label></div>\n\t\t                            \t<div><select name='status'></select></div>\n\t\t                     </div>"),filterHtml+='</div></div><div><button name="applyButton" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="TaskFilter.applyFilter()">'+ZPI18N.getString("zp.apply")+'</button> <button name="resetButton" type="button" class="zlabel zlabel--outline zlabel--medium" onclick="TaskFilter.resetFilter()">'+ZPI18N.getString("zp.reset")+"</button></div></div>"}};