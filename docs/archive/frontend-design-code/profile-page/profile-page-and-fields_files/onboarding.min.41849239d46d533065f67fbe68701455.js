ZPOnboarding={tabsOrder:[],onboardingDetails:{},isInitiated:!1,tabsJson:{},activeTab:"",contactHR:{},totalTabs:0,singleTabAngle:0},ZPOnboarding.Feeds={},ZPOnboarding.staticTabs=["Welcome","Forms","AllSet","Checklist","Profile"],ZPOnboarding.nondragableTabs=["Welcome","Forms","AllSet","Checklist","Profile"],ZPOnboarding.tabToClassMap={Welcome:"zo_wFeed",Forms:"zo_profile",Profile:"zo_profile",Agreements:"zo_dtbs",Team:"zo_team",Objectives:"zo_kraG",Organization:"zo_events",AllSet:"zo_gS",LMS_Course:"zo_team"},ZPOnboarding.iconClassMap={Welcome:"OB-hand",Forms:"OB-user",Profile:"OB-user",Agreements:"OB-form",Team:"OB-user2",Objectives:"OB-objective",Organization:"OB-corp",AllSet:"OB-hand",LMS_Course:"OB-form"},ZPOnboarding.currentDoc={},ZPOnboarding.completeTabs={},ZPOnboarding.iFrameTemplate='<iframe id="$ID$" src="$SRC$" width="100%" height="100%"></iframe>',ZPOnboarding.docError='<blockquote id="docFrame" class="blockquote"><span><i class="IC-alert"></i></span><p>$MSG$</p></blockquote>',ZPOnboarding.config={},ZPOnboarding.isPreview=void 0,ZPOnboarding.applicableConstants={1:"role",2:"desgn"},ZPOnboarding.obTemplates={},ZPOnboarding.picklistComponentTemplate="<div class='input-group dropdown' id='pickListComp'><div id='key_list' class='form-control DN'></div><span aria-expanded='false' class='input-group-addon BL0I' data-toggle='dropdown'><i class='IC-addlist gry CP'></i></span><div class='dropdown-menu ZPCusPd ZPappBox  ZPCmn-Arrow top gray'><div class='ZPTabVt'><div class='lfttab'><ul id='leftSideActiveKeyList' role='tablist' class='nav nav-pills nav-stacked'></ul></div><div class='rhttabscrl'><div class='tab-content'><div class='tab-pane active' role='tabpanel'><div><div class='ZPtopSearch'><label class='checkbox DIB FL PT8 MR10' title='Select All'><input id='zp_sharedto_all_checkbox' type='checkbox' onClick='ZPPickList.allCheckSelection()'><span></span></label><div class='ZPsearch' id='ZPsearch'><div class='dvsearch Dropdown PR'><span class='ZPico-search FL MT2 ML8 ZPtooltip IC-lens S16' zptitle='Search Category'></span></div><input type='search' class='ZPselect' id='dvZPselect' placeholder='"+ZPI18N.getString("zp.search")+"' value='' name='Search'></div></div><div class='ZPapplCb'><ul id='searchResult_ul'></ul></div></div></div></div></div></div></div></div>",ZPOnboarding.filter={},ZPOnboarding.obTemplatesList={},ZPOnboarding.isFilterInitiatedforcand=!1,ZPOnboarding.isFilterInitiatedforemp=!1,ZPOnboarding.isOnboardingFilter=!1,ZPOnboarding.isMassCheck=!1,ZPOnboarding.isFilterEmptyforcand=!0,ZPOnboarding.isFilterEmptyforemp=!0,ZPOnboarding.selectedHeader="",ZPOnboarding.MODE="onboarding_settings",ZPOnboarding.EmployeeForm={id:"",name:""},ZPOnboarding.CandidateForm={id:"",name:""},ZPOnboarding.isAddChecklist=!1,ZPOnboarding.configbyid={},ZPOnboarding.Selectedchecklist=[],ZPOnboarding.obFormsList={1:[],2:[]},ZPOnboarding.obFormsListmmTemplate="",ZPOnboarding.currentFlowType="",ZPOnboarding.reports={},ZPOnboarding.allReport={},ZPOnboarding.isPAAdmin=void 0,ZPOnboarding.latitude,ZPOnboarding.longitude,ZPOnboarding.statusConstants={ONBOARDING_NOT_CONFIGURED:0,ONBOARDING_NOT_TRIGGERED:1,ONBOARDING_STARTED:2,ONBOARDING_COMPLETED:3,TRIGGERED_ONBOARDING:-1,USER_COMPLETE:4,ONBOARDING_REOPEN:5},ZPOnboarding.CONSTANTS={INVALID_USER:-1,ALREADY_POPULATED:1,NO_ONBOARDING:2,OTHER_ERROR:3,POPULATE_SUCCESS:0,CANDIDATE_ONBOARDING_TYPE:2,EMPLOYEE_ONBOARDING_TYPE:1,CPORTAL_CONTEXT:"/cp"},ZPOnboarding.init=function(){if(window.location.href.indexOf("obErecno")>0&&(ZPOnboarding.readOnly=!0),"true"==ZPeople.ISCHAT&&$("body").addClass("zochat"),ZPeople.initChat(),ZPeople.OtherScript.init(),ZPOnboarding.contactHR=ZPeople.getUserDetailsById(ZPOnboarding.onBoardingDetails.CONTACT_HR_PERSON),ZPOnboarding.totalTabs=ZPOnboarding.tabsOrder.length,ZPOnboarding.singleTabAngle=Math.round(360/ZPOnboarding.totalTabs),$("#zpeople_userimage").attr("empid",ZPeople.CURR_USER.usererec).attr("imgtype","thumb")[0].src=ZPeople.CURR_USER.thumb,$("#zpeople_userimage").on("click",ZPeople.showLogoutModal),$(document).on("click",function(event){$("#zp_user_profile_pop").hide(),$("#zpeople_forms").hide(),$("#zpeople_more").hide(),$("#zpeople_notification").hide(),$("#showcorrespondingLogtime").hide(),0==$(event.target).parents("#zp_user_information").length&&$("#zp_user_information").modal("hide"),null!==Layout.Page.container&&0==$(event.target).parents("#singlecalendar").length&&0==$(event.target).parents("#doublecalendar").length&&(Calendar.hideSingleCalendar(),Calendar.hideDoubleCalendar()),0!==$("#timerCurModal").length&&$("#timerCurModal").hasClass("in")&&0===$(event.target).parents("#timerCurModal").length&&$("#timerCurModal").modal("hide")}),ZPeople.Request.send("/org/getUserOrgList",{method:"getUserOrgList",userzuid:ZPeople.CURRENT_ZUID},function(result){ZPeople.ORGLIST=result}),Layout.Page.container=$("#onBoardingRightPane:visible").parent(),ZPeople.User.Theme.setActiveTheme(),ZPeople.User.Theme.registerThemes(),ZPFeeds.Notifications.initComponents(),ZPeople.ZAcsApiInit(),$("#userImage").attr("src",userDtl.avatar),ZPOnboarding.isInitiated)"LMS_Course"==ZPOnboarding.activeTab?window.onload=function(){ZPOnboarding.constructTabs()}:ZPOnboarding.constructTabs();else{$("#userAcnt").hide();var li2="";void 0!=userDtl.desiId&&""!=userDtl.desiId.trim()&&(li2=userDtl.designation),void 0!=userDtl.deptId&&""!=userDtl.deptId.trim()&&(li2+=li2.length>0?" - ":"",li2+=userDtl.deptName),$("#li2").html(li2),void 0!=userDtl.locId&&$("#li4").prepend(userDtl.locName),$("div#zpinitloading").length>0&&$("div#zpinitloading").remove()}Layout.Page.currentmode="hr",ZPLoader.ISDONE=!0,ZPeople.setUp(),ZPeople.defineCalVariables(),ZPLoader.loadWms(),Layout.isZohoOne&&void 0!=Layout.zOneLibUrl&&ZPeople.UnifiedUI.isAvailable()&&ZPOnboarding.updateZone()},ZPOnboarding.updateZone=function(){"undefined"!=typeof CrmPlusLib?(ZPeople.UnifiedUI.init(),CrmPlusImpl.updateUiReady(),CrmPlusImpl.setBrowserTitle()):setTimeout(function(){ZPOnboarding.updateZone()},50)},ZPOnboarding.gettingStarted=function(){ZPeople.Request.send("/onBoarding.zp",{parmode:"getStarted"},ZPOnboarding.constructTabs)},ZPOnboarding.constructTabs=function(){Layout.Page.container.find("#userAcnt").show(),Layout.Page.container.find("#onBoardingLeftPane").removeClass("zo_lftPnlHome"),Layout.Page.container.find("#onBoardingLeftPane").addClass("zo_lgStarted");var leftHtml='<div class="zo_wMsg"><div class="zp_logo">';if(void 0==logo||null==logo||"null"==logo)leftHtml+='<a class="ZPLogo DB"></a>';else{var imgsrc="viewPhoto?filename='"+logo+"'";ZPPreboarding.isPreBoarding&&(imgsrc="/"+portalName+ZPOnboarding.CONSTANTS.CPORTAL_CONTEXT+"/"+imgsrc),leftHtml+='<a href="javascript:;" class="href"><img src="viewPhoto?filename='+logo+'" alt="Zoho Logo" imgtype="thumb" width="75"></a>'}leftHtml+="</div>";var tabUl='<div class="zo_nav"><ul id="tabsUl">',rightHtml="";$.each(ZPOnboarding.tabsOrder,function(tabInd,tabLabel){var tabJson=ZPOnboarding.tabsJson[tabLabel];if(!(ZPOnboarding.isPreview&&("Objectives"==tabLabel&&!ZPOnboarding.config.hasObjTab[ZPOnboarding.currentOB.onboarding_type]||!tabJson.tabCols.IS_VISIBLE||"Team"===tabLabel&&"null"==_LOGGEDIN_DEPID||"Forms"===tabLabel&&0===tabJson.tabSpecificData.forms.length||"Welcome"===tabLabel&&ZPOnboarding.currentOB.onboarding_type===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE)||"Checklist"==tabLabel)){tabCols=tabJson.tabCols;var tabClass="",headerClass="";if((!ZPPreboarding.isPreBoarding&&0==tabInd||tabCols.IS_COMPLETED)&&(ZPOnboarding.completeTabs[tabLabel]=!0),ZPOnboarding.activeTab===tabLabel?(tabClass+=" zo_enbl",tabInd):headerClass="zo_dyn",void 0!=tabCols.DESCRIPTION){var encodeddes=tabCols.DESCRIPTION;ZPOnboarding.isPreview&&(encodeddes=$("<div/>").text(encodeddes).html()),leftHtml+='<h2 data-click="'+tabLabel+'" class="'+headerClass+'">'+encodeddes+"<h2>"}rightHtml+='<div class="'+ZPOnboarding.tabToClassMap[tabLabel]+'" data-click="'+tabLabel+'"></div>',"Welcome"===tabLabel&&(rightHtml+='<div class="zo_rPpl" data-click="'+tabLabel+'"></div>');var tabSpecificData=tabJson.tabSpecificData,encodedname=ZPeople.decodeTxt(tabCols.DISPLAY_NAME);if(ZPOnboarding.isPreview&&(encodedname=$("<div/>").text(encodedname).html()),tabUl+='<li click="tab_'+tabCols.TAB_ID+'" class="'+tabClass+'" label="'+tabLabel+'" onclick="ZPOnboarding.openTab(\''+tabLabel+'\')"><i class="lIco '+ZPOnboarding.iconClassMap[tabLabel]+'"></i>'+encodedname,"Forms"==tabLabel){var subTabs='<ul class="zo_navSub" id="subTabs">',formsArr=tabSpecificData.forms;$.each(formsArr,function(fInd,form){var adClass=form.formStatus?"completed":"";ZPOnboarding.isPreview&&(form=ZPFRules.findObject(ZPOnboarding.config.forms,"formId",form)),subTabs+='<li class="'+adClass+"\" onclick='ZPOnboarding.Forms("+JSON.stringify(form)+")' id=\""+form.formId+'">'+form.formName+"<i></i></li>"}),tabUl+=subTabs+="</ul>"}else if(void 0!=tabSpecificData&&tabSpecificData.hasOwnProperty("subTabs")){subTabs='<ul class="zo_navSub" id="subTabs">';var subTabJson=tabSpecificData.subTabs;$.each(tabSpecificData.subTabsOrder,function(sInd,subLabel){var subTab=subTabJson[subLabel].tabCols;subTabs+='<li id="'+subTab.TAB_ID+'" data-click="'+subLabel+'"><span>'+subTab.DISPLAY_NAME+'</span><i class="" onclick-"ZPOnboarding.'+subLabel+'()"></i></li>'}),tabUl+=subTabs+="</ul>"}}}),tabUl+="</li>",leftHtml+='<h2 data-click="AllSet">'+ZPI18N.getString("zp.allsetdesc")+"</h2>",rightHtml+='<div class="zo_gS" data-click="AllSet"></div>',tabUl+='<li click="tab_AllSet" label="AllSet" onclick="ZPOnboarding.openTab(\'AllSet\')"><i class="lIco OB-hand"></i><span>'+ZPI18N.getString("zp.youreset")+"</span></li>",leftHtml+=tabUl+="</ul></div>",leftHtml+="</div>",leftHtml+='<div class="zo_mDets"><ul><li>',leftHtml+='<div class="set-size charts-container"><div class="pie-wrapper" onclick="ZPOnboarding.openTab(\'AllSet\')"><i class="label OB-checklist"></i><div class="pie" id="pie"><div class="left-side half-circle" id="leftCircle"></div><div class="right-side half-circle" id="rightCircle"></div></div></div></div></li>',"true"==ZPeople.ISCHAT&&void 0!=ZPOnboarding.contactHR.id&&(leftHtml+='<li class="zo_uPhto" ischat="true" uid="'+ZPOnboarding.contactHR.id+'" onclick="ZPeople.initUserChat(event,\''+ZPOnboarding.contactHR.id+'\')"><img src="'+ZPOnboarding.contactHR.thumb+'" alt=""></li>'),leftHtml+="</ul>",leftHtml+="</div>",Layout.Page.container.find("#onBoardingRightPane").append(rightHtml),Layout.Page.container.find("#onBoardingLeftPane").append(leftHtml),ZPOnboarding.checkComplete(),Layout.Page.container.find("#onBoardingRightPane").find("[data-click]").not("[data-click="+ZPOnboarding.activeTab+"]").hide(),ZPOnboarding.openTab(ZPOnboarding.activeTab),$("div#zpinitloading").length>0&&$("div#zpinitloading").remove()},ZPOnboarding.Welcome=function(resultObj,params){if(ZPOnboarding.isPreview||"false"!==resultObj.success){var hr=ZPOnboarding.contactHR,ext=""!=hr.extension?'<div><i class="OB-phone1"><i class="path1"></i><i class="path2"></i></i>'+hr.extension+"</div>":"",hrInfoHtml='<div class="zo_tbl"><div class="zo-shwhr OB-message"><i class="path1"></i><i class="path2"></i></div><div class="zo_rCol"><div class="zo_tblcell"><h4>'+ZPI18N.getString("zp.yourhrcontact")+'</h4><div class="zo_uPhto"><img src="'+hr.thumb+'" alt="USER"></div><span>'+hr.name+"</span><p>"+hr.designation+"</p>"+ext;if("true"==ZPeople.ISCHAT&&void 0!=hr.id&&(hrInfoHtml+='<label uid="'+hr.id+'" ischat="true" onclick="ZPeople.initUserChat(event,\''+hr.id+'\')"><i class="OB-chat"><i class="path1"></i><i class="path2"></i></i></label>'),hrInfoHtml+="</div></div>",void 0!=ZPOnboarding.onBoardingDetails.reportingto){var reportingto=ZPeople.getUserDetailsById(ZPOnboarding.onBoardingDetails.reportingto);ext=""!=reportingto.extension?'<div><i class="OB-phone1"><i class="path1"></i><i class="path2"></i></i>'+reportingto.extension+"</div>":"",hrInfoHtml+='<div class="zo_rCol"><div class="zo_tblcell"><h4>'+ZPI18N.getString("zp.yourmanager")+'</h4><div class="zo_uPhto"><img src="'+reportingto.thumb+'" alt="USER"></div><span>'+reportingto.name+"</span><p>"+reportingto.designation+"</p>"+ext,"true"==ZPeople.ISCHAT&&void 0!=reportingto.id&&(hrInfoHtml+='<label uid="'+reportingto.id+'" ischat="true" onclick="ZPeople.initUserChat(event,\''+reportingto.id+'\')"><i class="OB-chat"><i class="path1"></i><i class="path2"></i></i></label>'),hrInfoHtml+="</div></div>"}if(hrInfoHtml+="</div>",Layout.Page.container.find("#onBoardingRightPane:visible").find(".zo_rPpl").html(hrInfoHtml),Layout.Page.container.find("#onBoardingRightPane:visible").find(".OB-message").on("click",function(){Layout.Page.container.find("#onBoardingRightPane:visible").hasClass("min")?Layout.Page.container.find("#onBoardingRightPane:visible").removeClass("min"):Layout.Page.container.find("#onBoardingRightPane:visible").addClass("min")}),ZPOnboarding.isPreview){var welcomeUser=ZPeople.getUserDetailsById(erecno),welcomeMessage=ZPOnboarding.tabsJson.Welcome.tabSpecificData.WELCOME_FEED_TEXT.replace(/\${FEED USER MENTION}/g,'<span><a id="user_pop_dtl" empid="'+welcomeUser.empid+'" href="#home/dashboard/profile-userId:'+welcomeUser.usererec+'" target="_blank">'+welcomeUser.name+"</a></span>"),feedHtml='<div class="zo_feeds" id=""><div class="zo_scrl"><ul id="" streamid="" class="zo_feedlst"><li id="" streamid=""><div class="zo_uPhto"><img src="'+hr.thumb+'" alt="USER" imgtype="thumb" empid="'+hr.id+'" id="user_pop_dtl"></div><div id="actOwner">'+hr.name+'</div><div class="zo_feedContent">'+welcomeMessage+'</div><span class="zo_feedT">14 November 2017 , 3:17 PM</span><label><i id="like_link" action="0" class="OB-harte"></i></label></li></ul></div><ul class="zo_cFxd" id="text_area_comment"><li><div class="zo_uPhto"><img src="'+ZPeople.CURR_USER.thumb+'" alt="USER"></div><textarea id="comment_textarea" placeholder="'+ZPI18N.getString("zp.writeacomment")+'"></textarea>';Layout.Page.container.find("#onBoardingRightPane:visible").find('[data-click="Welcome"]').first().html(feedHtml)}else if(null==resultObj||void 0==resultObj||void 0==resultObj.activity){var feedsHtml='<div class="text-center MT50" id="zp_feeds_nodata" ><img src="'+ZPeople.getResourceURL(newUIImageUrl+"zpbee.png")+'" alt="" class="W200"><h5>'+ZPI18N.getString("zp.nofeedsyet")+"</h5></div>";$("#onBoardingRightPane:visible").find('[data-click="Welcome"]').first().html(feedsHtml)}else{ZPeople.CURRENT_VIEWKEY=ZPeople.VIEWKEYS.Status;var activity=resultObj.activity,activityObj=new People.Activity(new Activity(activity));AcsApi.initStream("People",ZPeople.CURRENT_VIEWKEY,10),ZPOnboarding.constructFeeds(activityObj,resultObj.likedUsrs)}}},ZPOnboarding.Feeds.constructLikersName=function(key,value,isActivity,likedUserDtls){var container=isActivity?$.find("[streamid="+key+"]"):$.find("[commentid="+key+"]"),userIds=value[0].toString().split(","),likedCnt=value[1];-1!==userIds.indexOf(erecno)&&(userIds.splice(0!==userIds.indexOf(erecno)?userIds.indexOf(erecno):0,1),userIds.unshift(erecno));var tooltipId="",linkId="";if(isActivity?(tooltipId="liked_usrs",linkId="like_link"):(tooltipId="commentLiked_usrs",linkId="zpcmt_like_link"),0==userIds.length&&$(container).find("#"+linkId).removeClass("red-color"),userIds.length>0){for(var usrDtl,Obj=$('<div data-toggle="tooltip" data-placement="top" data-html="true" data-container="body" id="'+tooltipId+'" class="dgry FR S12" ><i class="" count='+likedCnt+">"+likedCnt+"</i></div></div>").on("click",function(){return ZPFeeds.Like.getMoreLikedUsers(key,isActivity)}),likers='<div id="likers" class="liked-list">',currUserLiked=!1,userInd=0;userInd<userIds.length;userInd++){var liker="";if(usrDtl=likedUserDtls[userIds[userInd]],userInd<9&&(liker='<span empid="'+userIds[userInd]+'">',liker+=userIds[userInd]==erecno?ZPI18N.getString("zp.you"):usrDtl.empName,likers+=liker+="</span>"),userIds[userInd]===erecno&&(currUserLiked=!0),userIds.length>10&&9===userInd){likers+="<span morecount="+(likedCnt=parseInt(likedCnt)-10)+">"+ZPI18N.getString("zp.and",[""])+" "+likedCnt+" "+ZPI18N.getString("zp.smore")+"</span>";break}}currUserLiked?($(container).find("#"+linkId).addClass("red-color"),$(container).find("#"+linkId).attr("action",1)):($(container).find("#"+linkId).removeClass("red-color"),$(container).find("#"+linkId).attr("action",0)),likers+="</div>",Obj=Obj.attr("title",likers),$(container).find("#"+tooltipId).length>0?$(container).find("#"+tooltipId).replaceWith(Obj):$(container).find("#"+linkId).parent("span").append(Obj),$("[id="+tooltipId+"]").tooltip("enable")}else $(container).find("#"+tooltipId).replaceWith("")},ZPOnboarding.Feeds.getNewCommentEditor=function(id,fdk,type){ZPUtil.escapeSelector(fdk);var editorObj=$("#onBoardingRightPane:visible").find("#comment_textarea");if(editorObj.find("#zpEditor").length>0&&void 0===ZPFeeds.Editor.editorList[id]||0===editorObj.find("#zpEditor").length)ZPFeeds.COMMENTEDITOR=ZPFeeds.Editor.getEditor(id,type),editorObj.append($('<div class="pst" id="zp_dash_feeds_postband"> '+("Status"===type||"Collaboration"===type?'<div class="attachFile" id="zp_comment_Attachments"><a class="IC-attach1" href="javascript:;"  id="zp_dash_attachIcon" onclick="ZPFeeds.createInput(false, \''+fdk+"')\"><span>"+ZPI18N.getString("zp.attach")+"</span></a></div>":"")+'<div class="FR  MT1">  <button class="btn btn-primary btn-loading"  id="post_comment_input" type="button" onclick="ZPFeeds.Comment.post(\''+fdk+"', '"+type+'\')"><span class="FL">'+ZPI18N.getString("zp.feeds.post")+"</span></button></div> </div>"));else{var editor=ZPFeeds.Editor.editorList[id];void 0!==editor&&(ZPFeeds.COMMENTEDITOR=editor)}editorObj.addClass("in"),editorObj.children().removeClass("DN"),0===parseInt(editorObj.find("#zp_dash_attachments").attr("attachcnt"))&&editorObj.find("#zp_dash_attachments").addClass("DN"),setTimeout(function(){ZPFeeds.COMMENTEDITOR.focus()},500),editorObj.find("textarea#comment_textarea").addClass("DN")},ZPOnboarding.Feeds.post=function(fdk,type,obj){var messageText=$(obj).val();if(messageText.length>5e3)messageText.length>5e3&&ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.commentlengthwarning"));else{messageText=messageText.replace(/\n/g,"<br/>");var params={type:type,fdk:fdk,callBack:ZPOnboarding.Feeds.handleCommentResponse,content:"<div>"+messageText+"</div>",messageText:messageText,curConObj:obj,attachCnt:null,isOnboarding:"true"};ZPFeeds.postAction(params,!1)}},ZPOnboarding.Feeds.handleCommentResponse=function(data,params){"string"==typeof data&&(data=JSON.parse(data)),400===data.code&&ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.unabletoprocess"));var commentSecObj=ZPFeeds.getCurrentViewContainer().find("#comment_feed"),totalcmd=parseInt(commentSecObj.find("#more_comments").attr("totalcmd"));commentSecObj.find("#more_comments").attr("totalcmd",++totalcmd),$("#comment_textarea").val(""),$("#comment_textarea").trigger("blur")},ZPOnboarding.Team=function(data,params){if(null!=data){var teamMembers=[];void 0!=data.deptMembers&&(empDeptList=data.deptMembers.empDeptList,1==params.start&&ZPeople.FireScroll.setRecordCount(data.deptMembersCount),data.deptMembers.hasMoreResult&&ZPeople.FireScroll.reset(),teamMembers=empDeptList);var teamHtml="";if(1==params.start){Layout.Page.container.find("#onBoardingRightPane:visible").find('[data-click="Team"]').attr("scroll","enabled");var deptLead="";teamHtml='<div class="zo_Httl"><h2>'+ZPI18N.getString("zp.Onboarding.Team")+'</h2><i class="OB-user1 zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div>',data.deptLeadName&&(deptLead='<div class="zo_usrhead"><img src="'+data.deptLeadPhoto+'" alt="User"><div class="zo_usrname">'+data.deptLeadName+"</div><div>"+ZPI18N.getString("zp.dept")+"</div></div>",teamHtml='<div class="zo_usrsteam_head">'+deptLead+'<div class="zo_depart"><b>'+data.deptName+"</b><span>"+data.deptMail+'</span></div><div class="zo_usrcount"><b>'+data.deptMembersCount+"</b><span>"+ZPI18N.getString("zp.members")+"</span></div></div>");parseInt(teamMembers.length);teamHtml+='<div class="zo_tCont"><div class="zo_usrsteam" id="teamMembers">'}$.each(teamMembers,function(memberIndex,memberDtl){teamHtml+='<div><img src="'+memberDtl.photo+'" alt="User"><p><span>'+memberDtl.eid+"</span> - <b>"+ZPUsers.emptyToDash(memberDtl.name)+"</b></p>",void 0!=memberDtl.desname&&(teamHtml+="<p>"+memberDtl.desname+"</p>"),teamHtml+="<ul>",teamHtml+='<li><i class="OB-mail"><i class="path2"></i></i><span data-toggle="tooltip" title="" data-original-title="'+ZPUsers.emptyToDash(memberDtl.email)+'" data-container="body" data-placement="bottom">'+ZPUsers.emptyToDash(memberDtl.email)+'</span></li><li><i class="OB-phone2"></i>'+ZPUsers.emptyToDash(memberDtl.extn)+"</li></ul>","true"==ZPeople.ISCHAT&&void 0!=memberDtl.zuid&&(teamHtml+='<span class="sayHi" ischat="true" uid="'+memberDtl.zuid+'" onclick="ZPeople.initUserChat(event,'+memberDtl.zuid+')">'+ZPI18N.getString("zp.sayhi")+"!</span>"),teamHtml+="</div>"}),1==params.start?(teamHtml+="</div></div>",Layout.Page.container.find("#onBoardingRightPane:visible").find('[data-click="Team"]').html(teamHtml)):(ZPeople.FireScroll.increaseRecordCount(data.deptMembersCount),Layout.Page.container.find("#onBoardingRightPane:visible").find('[data-click="Team"] #teamMembers').append(teamHtml)),ZPOnboarding.completeTabs.Team=!0,ZPOnboarding.readOnly||ZPOnboarding.checkComplete(),1==params.start&&(Layout.Page.parentContainer=Layout.Page.container.find("#onBoardingRightPane:visible"),ZPeople.FireScroll.init(ZPOnboarding.deptListFireScroll))}},ZPOnboarding.Forms=function(activeForm){Layout.Page.container.parents("body").find("#onBoardingLeftPane #subTabs:visible li").removeClass("zo_enbl");var formId=activeForm.formId;Layout.Page.container.parents("body").find("#onBoardingLeftPane li[label=Forms] li").removeClass("zo_enbl"),Layout.Page.container.parents("body").find("#onBoardingLeftPane #"+formId).addClass("zo_enbl");var loadParams={formId:formId,disableUrlTrack:!0,editCallback:formCustom.previewFormCallBack,callback:ZPOnboarding.formEditResponse};ZPOnboarding.isPreview?"P_Employee"==activeForm.componentName?(loadParams.formMode="EDIT",ZPForm.CURRFORM_PARAM.recordId=erecno,loadParams.recordId=erecno):loadParams.formMode="ADD":(loadParams.formMode="EDIT",loadParams.recordId=activeForm.recordId,Layout.Page.hash="");var formDiv=Layout.Page.container;0===formDiv.find("#zp_addedit_record_"+formId).length?(formDiv.append('<div id="zp_addedit_record_'+formId+'"></div>'),formDiv.find("#zp_addedit_record_"+formId).append(ZPForm.FORM_OUTER_TEMPLATE),formDiv.find("#zp_addedit_record_"+formId).append(ZPeople.LOADING_HTML)):(formDiv.find(".modal").remove(),formDiv.find("#zp_addedit_record_"+formId).append(ZPForm.FORM_OUTER_TEMPLATE)),ZPForm.LAYOUT=formDiv.find("#zp_addedit_record_"+formId),formDiv.find("#zp_addedit_record_"+formId).addClass("in"),activeForm.componentName.indexOf("P_Timesheet")>=0?(loadParams.onloadCallback=Timetracker.forms.formOnLoadCallback,"P_TimesheetJobsList"===activeForm.componentName?loadParams.createFldFunctions={ClientId:Timetracker.forms.constructFormField,ProjectUsers:Timetracker.forms.constructFormField}:loadParams.createFldFunctions={Assignees:Timetracker.forms.constructFormField,Hours:Timetracker.forms.constructFormField,BillableStatus:Timetracker.forms.constructFormField}):"P_ApplyLeave"===activeForm.componentName&&(loadParams.fieldFormat=["Employee_ID","Leavetype","From","To","TeamEmailID","Reasonforleave"],loadParams.fieldCallback={Employee_ID:Leave.Form.getApplicable,Leavetype:Leave.Form.getDetails,From:Leave.Form.getDetails,To:Leave.Form.getDetails}),Layout.Page.hashDtl=void 0,ZPForm.load(loadParams,ZPOnboarding.isPreview)},ZPOnboarding.Profile=function(){var formId=candidateFormId,loadParams={formId:formId,disableUrlTrack:!0,editCallback:formCustom.previewFormCallBack,callback:ZPOnboarding.formEditResponse};ZPOnboarding.isPreview?loadParams.formMode="ADD":(loadParams.formMode="EDIT",ZPForm.CURRFORM_PARAM.recordId=currUser.candidateId,loadParams.recordId=currUser.candidateId,Layout.Page.hash="");var profileDiv=Layout.Page.container;profileDiv.attr("id","zp_addedit_record_"+formId),profileDiv.find(".modal").remove(),profileDiv.addClass("in"),0==profileDiv.find("#zp_addedit_record_"+formId).length?profileDiv.append(ZPForm.FORM_OUTER_TEMPLATE):ZPForm.FORM_OUTER_TEMPLATE=profileDiv.find(".modal"),Layout.Page.hashDtl=void 0,ZPForm.load(loadParams,ZPOnboarding.isPreview)},ZPOnboarding.Agreements=function(agreementJson,istabcompleted){var iscompleted=!(ZPOnboarding.tabsJson.Agreements.tabCols.ACKNOWLEDGE>0);if(void 0!=agreementJson.docsToSign){var docsArr=agreementJson.docsToSign,docsHtml='<div class="zo_docNav" id="agreements"><h3>'+ZPI18N.getString("zp.forsign")+"</h3><ul>",docsLen=0;if($.each(docsArr,function(docsInd,docDtls){if(ZPOnboarding.isPreview&&void 0!=docDtls.applicableRoles&&-1==$.inArray(ZPeople.CURR_USER.roleId,docDtls.applicableRoles))return!0;docsLen++;var completeClass="",completeAttr="null",tickClass="";docDtls.IS_ACCEPTED?(completeClass="completed",completeAttr="true",tickClass="OB-tick1"):null!=docDtls.IS_ACCEPTED?(completeClass="rejected",completeAttr="false",tickClass="OB-close"):iscompleted=!1;var displayname=ZPOnboarding.isPreview?AutomationCommon.htmlEncode(docDtls.DISPLAY_NAME):docDtls.DISPLAY_NAME;docsHtml+='<li doctype="'+docDtls.doctype+'" onclick="ZPOnboarding.openDoc(this)" formId="'+docDtls.FORMID+'" agreementId="'+docDtls.TEMPLATEID+'" class="'+completeClass+'" iscompleted="'+completeAttr+'" filePath="'+docDtls.FILEPATH+'" style="position:inherit"><span prop="fileName" data-placement="bottom" data-original-title="'+displayname+'" data-toggle="tooltip">'+displayname+'</span><i class="'+tickClass+'"></i></li>'}),0==docsLen){if(docsHtml="",void 0==agreementJson.policies||0==agreementJson.policies.length)return docsHtml='<div style="text-align: center;padding-top:20%;"><h1>'+ZPI18N.getString("zp.nodocsfortherole")+"</h1></div>",Layout.Page.container.find("#docs").parent().html(docsHtml),!0}else docsHtml+="</ul></div>";Layout.Page.container.find("#docs").append(docsHtml),0==Layout.Page.container.find("#onBoardingRightPane:visible").find('[data-click="Agreements"]').find("#pdfViewerDiv").length&&(docsHtml='<div class="zo_docadd" id="pdfViewerDiv"><div class="zo_docPnl"><div class="zo_docHead"><span name="fileName"></span><a class="zo_docClose" name="" href="javascript:ZPOnboarding.fullScreenShowhide(\'hide\');"><i class="OB-close"></i></a><a prop="docProp" class="zo_docExpand" name="" href="javascript:ZPOnboarding.fullScreenShowhide(\'show\');"><i class="OB-expand" data-content="" data-placement="top" data-trigger="hover" data-toggle="tooltip" zptitle=""  data-original-title="'+ZPI18N.getString("zp.expand")+'"></i></a><a name="fileOptions" prop="docProp" href=""><i class="OB-print" data-content="" data-placement="top" data-trigger="hover" data-toggle="tooltip" zptitle=""  data-original-title="'+ZPI18N.getString("zp.print")+'"></i></a><a name="fileOptions" prop="docProp" href=""><i class="OB-download" data-content="" data-placement="right" data-trigger="hover" data-toggle="tooltip" zptitle=""  data-original-title="'+ZPI18N.getString("zp.Download")+'"></i></a></div><div class="zo_docLoad"><div class="zo_Loded">'+ZPOnboarding.iFrameTemplate.replace(/\$ID\$/,"docFrame")+'</div></div><div class="zo_docFoot"><div class="zo_docBtns" id="docBtns"><button value="true" onclick="ZPOnboarding.acceptAgreement(null,null,{forPost:true,obj:this});">Accept</button><button value="false" onclick="ZPOnboarding.acceptAgreement(null,null,{forPost:true,obj:this});">Decline</button></div></div></div></div>',$(docsHtml).insertAfter(Layout.Page.container.find("#docs"))),0==$("#policies").length&&(Layout.Page.container.find("#docs").find('li[iscompleted="false"]').length>0?Layout.Page.container.find("#docs").find('li[iscompleted="false"]').first().trigger("click"):Layout.Page.container.find("#docs").find("li").first().trigger("click"))}if(!ZPOnboarding.readOnly&&!istabcompleted&&iscompleted){var tabId=ZPOnboarding.tabsJson.Agreements.tabCols.TAB_ID;ZPeople.Request.send("/onboarding/pre/setTabStatus",{tabId:tabId},ZPOnboarding.checkComplete)}$("[data-toggle=tooltip]").tooltip()},ZPOnboarding.openTab=async function(activeTab){Layout.Page.container=$("body");var currentTab=Layout.Page.container.find("#onBoardingLeftPane #tabsUl").children("li.zo_enbl").attr("label");if(Layout.Page.container.find("#onBoardingLeftPane").find("[label]").removeClass("zo_enbl"),Layout.Page.container.find("#onBoardingLeftPane").find('[label="'+activeTab+'"]').addClass("zo_enbl"),Layout.Page.container.find("#onBoardingRightPane").find("[data-click]").hide(),Layout.Page.container.find("#onBoardingRightPane").find('[data-click="'+activeTab+'"]').show(),Layout.Page.container.find("#onBoardingLeftPane").find("[data-click]").addClass("zo_dyn"),Layout.Page.container.find("#onBoardingLeftPane").find('[data-click="'+activeTab+'"]').removeClass("zo_dyn"),"AllSet"==activeTab)return ZPOnboarding.AllSet(),Layout.Page.container.find("#onBoardingLeftPane").find("[label]").removeClass("zo_enbl"),void Layout.Page.container.find("#onBoardingLeftPane").find("[label=AllSet]").addClass("zo_enbl");var obrightdiv=Layout.Page.container.find("#onBoardingRightPane:visible");if("Forms"!=activeTab&&"Profile"!=activeTab||(Layout.Page.container=Layout.Page.container.find("#onBoardingRightPane:visible").find('[data-click="'+activeTab+'"]')),""==$(obrightdiv).find('[data-click="'+activeTab+'"]').html()||"Welcome"==activeTab&&ZPOnboarding.totalTabs>Object.keys(ZPOnboarding.completeTabs).length||ZPPreboarding.isPreBoarding&&$.inArray(activeTab,["Profile","Forms"])>-1&&currentTab!=activeTab||"LMS_Course"==activeTab){if("Forms"==activeTab){var tabData=ZPOnboarding.tabsJson[activeTab].tabSpecificData;return void(tabData.hasOwnProperty("activeFormDetails")?ZPOnboarding[activeTab](tabData.activeFormDetails):ZPOnboarding.isPreview?(form=ZPFRules.findObject(ZPOnboarding.config.forms,"formId",tabData.forms[0]),ZPOnboarding[activeTab](form)):ZPOnboarding[activeTab](tabData.forms[0]))}if(Layout.Page.container.find("#onBoardingRightPane:visible").find('[data-click="'+activeTab+'"]').append(ZPeople.LOADING_HTML),"Organization"==activeTab)return void ZPOnboarding.Organization(ZPOnboarding.tabsJson[activeTab]);if("Agreements"==activeTab){void 0!=ZPOnboarding.latitude&&void 0!=ZPOnboarding.longitude||await ZPOnboarding.getLocation().catch(()=>{});var agreementsHtml='<div class="zo_docLst" id="docs">$DOCS$</div>',docsHtml="",agreementJson=ZPOnboarding.tabsJson[activeTab].tabSpecificData;if(void 0!=agreementJson.policies&&Object.keys(agreementJson.policies).length>0){var docsArr=agreementJson.policies;docsHtml='<div class="zo_docNav" id="policies"><h3>'+ZPI18N.getString("zp.foryourperusal")+"</h3><ul>";var activeClass="onRead";$.each(docsArr,function(docsInd,docDtls){if(ZPOnboarding.isPreview){var json=ZPFRules.findObject(ZPOnboarding.hrFiles,"fileID",docDtls);void 0!=json&&(docDtls={FILEID:json.fileID,FILENAME:json.fileName,FILEPATH:json.filePath,FILEEXTN:json.fileExtn,UPLOADSOURCE:json.uploadSource,ACKNOWLEDGE:json.ACKNOWLEDGE,hasloginuserack:json.hasloginuserack})}var filepath=decodeHTML(docDtls.FILEPATH),ackclass="",ackdivclass="";if(1==docDtls.ACKNOWLEDGE)if(docDtls.hasloginuserack)ackclass="CR-ack-success",ackdivclass="ZPack ack_actv";else{ackclass="CR-ack-pending",ackdivclass="ZPack ack_pndng";var agtabjson=ZPOnboarding.tabsJson[activeTab];agtabjson.tabCols.ACKNOWLEDGE=void 0!=agtabjson.tabCols.ACKNOWLEDGE&&agtabjson.tabCols.ACKNOWLEDGE>0?agtabjson.tabCols.ACKNOWLEDGE+1:1}1==docDtls.UPLOADSOURCE||filepath.indexOf(workDriveUrl)>-1||filepath.indexOf(writerUrl)>-1||filepath.indexOf(sheetUrl)>-1||filepath.indexOf(showUrl)>-1?docsHtml+='<li class="'+activeClass+'" id="'+docDtls.FILEID+'" onclick=window.open("'+docDtls.FILEPATH+'") filePath="'+docDtls.FILEPATH+'" fileExtn="'+docDtls.FILEEXTN+'" ack="'+docDtls.ACKNOWLEDGE+'" isLoginUserAck="'+docDtls.hasloginuserack+'" style="position:inherit"><span prop="fileName">'+docDtls.FILENAME+'</span><div class="'+ackdivclass+'"><i id="ackicon" class="'+ackclass+'"></i></div></li>':docsHtml+='<li class="'+activeClass+'" id="'+docDtls.FILEID+'" onclick="ZPOnboarding.openDoc(this)" filePath="'+docDtls.FILEPATH+'" fileExtn="'+docDtls.FILEEXTN+'" ack="'+docDtls.ACKNOWLEDGE+'" isLoginUserAck="'+docDtls.hasloginuserack+'" style="position:inherit"><span prop="fileName">'+docDtls.FILENAME+'</span><div class="'+ackdivclass+'"><i id="ackicon" class="'+ackclass+'"></i></div></li>',activeClass=""}),docsHtml+="</ul></div>",agreementsHtml+='<div class="zo_docadd" id="pdfViewerDiv"><div class="zo_docPnl"><div class="zo_docHead"><span name="fileName"></span><a class="zo_docClose" name="" href="javascript:ZPOnboarding.fullScreenShowhide(\'hide\');"><i class="OB-close"></i></a><a class="zo_docExpand" name="" href="javascript:ZPOnboarding.fullScreenShowhide(\'show\');"><i class="OB-expand" data-content="" data-placement="top" data-trigger="hover" data-toggle="tooltip" zptitle=""  data-original-title="'+ZPI18N.getString("zp.expand")+'"></i></a><a name="fileOptions" href=""><i class="OB-print" data-content="" data-placement="top" data-trigger="hover" data-toggle="tooltip" zptitle=""  data-original-title="'+ZPI18N.getString("zp.print")+'"></i></a><a name="fileOptions" href=""><i class="OB-download" data-content="" data-placement="top" data-trigger="hover" data-toggle="tooltip" zptitle=""  data-original-title="'+ZPI18N.getString("zp.Download")+'"></i></a></div><div class="zo_docLoad"><div class="zo_Loded"><iframe id="docFrame" src="" width="100%" height="100%"></iframe></div></div><div class="zo_docFoot"><div class="zo_docBtns" id="docBtns"><button value="true" onclick="ZPOnboarding.acceptAgreement(null,null,{forPost:true,obj:this});">Accept</button><button value="false" onclick="ZPOnboarding.acceptAgreement(null,null,{forPost:true,obj:this});">Decline</button></div></div></div></div>'}agreementsHtml=agreementsHtml.replace("$DOCS$",docsHtml),Layout.Page.container.find("#onBoardingRightPane:visible").find('[data-click="Agreements"]').html(agreementsHtml),Layout.Page.container.find("#docs").find("li").first().trigger("click"),ZPOnboarding.Agreements(agreementJson,ZPOnboarding.tabsJson[activeTab].tabCols.IS_COMPLETED)}else if(ZPOnboarding.isPreview&&"Welcome"==activeTab||"Profile"==activeTab)ZPOnboarding[activeTab]();else if("LMS_Course"==activeTab)ZPOnboarding.LMS_Course(ZPOnboarding.tabsJson[activeTab].tabSpecificData.courses);else{var params={parmode:"tabContent",submode:activeTab,isPreview:ZPOnboarding.isPreview};"Team"==activeTab&&(params.start=1,params.end=25),ZPeople.Request.send("/onboarding/pre/tabContent",params,ZPOnboarding[activeTab])}}else"Agreements"==activeTab&&$("#onBoardingRightPane:visible").find("#agreements").length>0&&Layout.Page.container.find("#onBoardingRightPane:visible").find("#agreements li.onRead").trigger("click")},ZPOnboarding.deptListFireScroll=function(){var obj=ZPeople.FireScroll.getFireScrollPropertie(),params={parmode:"tabContent",submode:"Team",isPreview:ZPOnboarding.isPreview,start:obj.count+1,end:25};ZPeople.Request.send("/onboarding/pre/tabContent",params,ZPOnboarding.Team)},ZPOnboarding.openDoc=function(obj){ZPOnboarding.currentDoc.fileId=$(obj).attr("id"),Layout.Page.container.find("#docBtns").hide(),Layout.Page.container.find("#ack_chckBox").parent().remove(),Layout.Page.container.find(".zo_Loded").removeAttr("style"),Layout.Page.container.find(".zo_docLoad").find("#agonbload").remove(),Layout.Page.container.find(".zo_docLoad").find("#zp_page_loading").remove(),Layout.Page.container.find("#onBoardingRightPane:visible").find(".zo_Loded").html('<div id="docFrame">'+ZPeople.LOADING_HTML+"</div>");var agrID=Layout.Page.container.find(obj).attr("agreementId");null!=agrID&&void 0!=agrID&&""!=agrID&&(ZPOnboarding.currentDoc.agrId=agrID),ZPOnboarding.currentDoc.ACKNOWLEDGE=$(obj).attr("ack"),ZPOnboarding.currentDoc.isLoginUserAck=$(obj).attr("isLoginUserAck"),Layout.Page.container.find("#docs").find("li").removeClass("onRead"),Layout.Page.container.find(obj).addClass("onRead"),Layout.Page.container.find("#onBoardingRightPane").find("[name=fileName]").html($(obj).find("span[prop=fileName]").html());var doctype=$(obj).attr("doctype");if($.inArray(doctype,["2","3","4"])>-1){$(obj).index();$(obj).addClass("NM OP5"),ZPeople.Request.send("/onboarding/pre/esignUrl",{parmode:"ESIGNURL",agrId:ZPOnboarding.currentDoc.agrId},ZPOnboarding.esignurl,{obj:obj})}else{if(ZPOnboarding.readOnly||(null!=agrID&&void 0!=agrID&&""!=agrID&&"null"==$(obj).attr("iscompleted")?(Layout.Page.container.find("#docBtns").find("button").attr("agrid",ZPOnboarding.currentDoc.agrId),Layout.Page.container.find("#docBtns").show()):Layout.Page.container.find("#docBtns").hide()),1==ZPOnboarding.currentDoc.ACKNOWLEDGE){var checked="true"==ZPOnboarding.currentDoc.isLoginUserAck?"checked":"";$('<label class="checkbox FL MR20"><input id="ack_chckBox" '+checked+' type="checkbox" onclick="Files.Reports.addAcknowledgement(\''+ZPOnboarding.currentDoc.fileId+'\',false,false);"><span class="ML5">'+ZPI18N.getString("zp.ackread")+"</span></label>").insertAfter(Layout.Page.container.find("#docBtns"))}if(void 0!=ZPOnboarding.currentDoc.fileId&&"undefined"!=ZPOnboarding.currentDoc.fileId&&"null"!=ZPOnboarding.currentDoc.fileId){var src=void 0!=ZPOnboarding.currentDoc.docusignurl?ZPOnboarding.currentDoc.docusignurl:"viewFile?fileId="+ZPOnboarding.currentDoc.fileId;src+=void 0==ZPOnboarding.latitude&&void 0==ZPOnboarding.longitude?"":"&latitude="+ZPOnboarding.latitude+"&longitude="+ZPOnboarding.longitude;var frameid="viewFileFrame",fileExtn=$(obj).attr("fileExtn");if(void 0==fileExtn||"undefined"==fileExtn){var fileName=void 0!=$(obj).attr("filePath")?$(obj).attr("filePath"):$(obj).find("[prop=fileName]").text();-1==fileName.lastIndexOf(".")&&-1==fileName.lastIndexOf(".")||(fileExtn=(fileExtn=fileName.substr(fileName.lastIndexOf(".")+1,fileName.length)).toLowerCase())}"jpg"!==fileExtn&&"jpeg"!==fileExtn&&"gif"!==fileExtn&&"png"!==fileExtn||(frameid="imageviewFrame");var filePath=$(obj).attr("filePath"),docFrame=ZPOnboarding.iFrameTemplate.replace(/\$ID\$/,frameid),wdfile=!1;if(void 0!=filePath&&(filePath.indexOf(writerUrl)>-1?(filePath=filePath.replace("/open/","/zwpreview/"),docFrame=docFrame.replace(/\$SRC\$/,filePath),wdfile=!0):filePath.indexOf(workDriveUrl)>-1?(docFrame=docFrame.replace(/\$SRC\$/,filePath),wdfile=!0):docFrame=docFrame.replace(/\$SRC\$/,"")),Layout.Page.container.find("#onBoardingRightPane:visible").find(".zo_Loded").html(docFrame),Layout.Page.container.find("#onBoardingRightPane:visible").find("#"+frameid).attr("onload",'Layout.Page.container.find("#'+frameid+'").removeAttr("style");'),Layout.Page.container.find("#onBoardingRightPane").find("[prop=docProp]").show(),Layout.Page.container.find(".zo_docLoad").prepend(ZPeople.LOADING_HTML),Layout.Page.container.find(".zo_Loded").css("background-color","transparent"),!wdfile){var fdata={fileID:ZPOnboarding.currentDoc.fileId,fileName:$(obj).find("[prop=fileName]").text(),filePath:$(obj).attr("filePath")};IsNumeric($(obj).attr("filePath"))&&(fdata.fileExtn=$(obj).attr("fileExtn")),void 0==fdata.filePath&&(fdata.filePath=fdata.fileName),src="/"+contextPath+"/"+src;let iframe=$(window.document).find("#viewFileFrame");Layout.Page.container.find("#zp_page_loading").remove(),iframe.attr("src",src),Layout.Page.container.find("#onBoardingRightPane").find("[name=fileOptions]").each(function(ind){let href="";if(0===ind){let fileId=ZPOnboarding.currentDoc.fileId;href=`javascript:var v = window.open('viewFile?fileId=${fileId+=void 0!=ZPOnboarding.latitude&&void 0!=ZPOnboarding.longitude?"&latitude="+ZPOnboarding.latitude+"&longitude="+ZPOnboarding.longitude:""}');v.print()`}else 1===ind&&(href=`javascript:Files.downloadFilecabinet('html','${ZPOnboarding.currentDoc.fileId}','${fdata.filePath}','${fdata.fileName}')`);$(this).attr("href",href)})}var isAgreement=$(obj).parents("#agreements").length>0;Layout.Page.container.find("#onBoardingRightPane:visible").find("#"+frameid).on("load",function(){Layout.Page.container.find("#"+frameid).removeAttr("style"),isAgreement&&"null"==$(obj).attr("iscompleted")&&ZPOnboarding.scrollToEnd(obj)})}else Layout.Page.container.find("#onBoardingRightPane").find("[prop=docProp]").hide(),ZPeople.Request.send("/onboarding/pre/getFileId",{parmode:"getFileId",agrId:ZPOnboarding.currentDoc.agrId,isPreview:ZPOnboarding.isPreview},ZPOnboarding.openFile,{obj:obj})}},ZPOnboarding.openFile=function(data,params,others){void 0!=data.hrFilesId?(Layout.Page.container.find(others.obj).attr("id",data.hrFilesId),data.filepath&&Layout.Page.container.find(others.obj).attr("filepath",data.filepath),ZPOnboarding.openDoc(others.obj)):void 0!=data.msg&&(Layout.Page.container.find("#docBtns").hide(),Layout.Page.container.find("#onBoardingRightPane:visible").find("#docFrame").replaceWith(ZPOnboarding.docError.replace(/\$MSG\$/,data.msg)))},ZPOnboarding.formEditResponse=function(recId,IS_COMPLETED,isDraft){ZPForm.Record.isDraft=!1;var curformParam=ZPForm.CURRFORM_PARAM,formId=curformParam.formId,currFormLi=Layout.Page.container.parents("body").find("#onBoardingLeftPane #subTabs li#"+formId);if(!isDraft){currFormLi.addClass("completed");var tabSwitch=!1;if(void 0!=IS_COMPLETED&&IS_COMPLETED&&("P_Candidate"==ZPForm.getTableName()?(ZPOnboarding.completeTabs.Profile=!0,tabSwitch=!0,ZPeople.Request.send("/onboarding/pre/updateCandidate",{},ZPOnboarding.updateCandidateProfile)):(ZPOnboarding.completeTabs.Forms=!0,currFormLi.siblings("li").not(".completed").length>0?ZPOnboarding.formComplete=!0:tabSwitch=!0),ZPOnboarding.checkComplete()),ZPOnboarding.formComplete&&0==currFormLi.siblings("li").not(".completed").length&&(tabSwitch=!0,delete ZPOnboarding.formComplete),tabSwitch){var LABEL_NAME=Layout.Page.container.parents("#onBoardingRightPane").find("[data-click]:visible").attr("data-click");ZPOnboarding.completeTabs[LABEL_NAME]=!0;var activeObj=Layout.Page.container.parents("body").find("#onBoardingLeftPane #tabsUl li[label="+LABEL_NAME+"]");$(activeObj).addClass("completed"),$($(activeObj).nextAll("li").not(".completed")[0]).trigger("click")}if(ZPOnboarding.formComplete&&"P_Candidate"!=ZPForm.getTableName()){var nextForm=null;currFormLi.nextAll("li").not(".completed").length>0?nextForm=currFormLi.nextAll("li").not(".completed").first():currFormLi.prevAll("li").not(".completed").length>0&&(nextForm=currFormLi.prevAll("li").not(".completed").first())}null!=nextForm||"P_Candidate"===ZPForm.getTableName()||IS_COMPLETED||ZPOnboarding.Forms({formId:curformParam.formId,recordId:recId,formName:ZPForm.getTableName(),formStatus:!1,componentName:ZPForm.CONF.formName,isMandatory:!1}),"P_Employee"==ZPForm.getTableName()&&ZPeople.sendUserListAjax([recId]);var hasFormTemplates=!1;Layout.Page.container.parents("#onBoardingRightPane").find("#agreements [formid="+formId+"]").each(function(){hasFormTemplates=!0,$(this).attr("id",null)}),hasFormTemplates&&!ZPPreboarding.isPreBoarding&&ZPeople.Request.send("/onboarding/pre/updateAgreements",{formId:formId})}delete ZPForm.SINGLE_RECORD_DTL[curformParam.formId+"_"+curformParam.recordId],"P_Candidate"!=ZPForm.getTableName()||IS_COMPLETED?IS_COMPLETED&&!ZPOnboarding.formComplete||(null==nextForm?currFormLi.trigger("click"):nextForm.trigger("click")):ZPOnboarding.Profile()},ZPOnboarding.fullScreenShowhide=function(action){"show"==action?Layout.Page.container.find("#pdfViewerDiv").addClass("fullScreen"):Layout.Page.container.find("#pdfViewerDiv").removeClass("fullScreen")},ZPOnboarding.acceptAgreement=function(data,params,others){var obj=$(others.obj);if(others.hasOwnProperty("forPost"))delete others.forPost,$(obj).addClass("disabled"),ZPeople.Request.send("/onboarding/pre/accept",{parmode:"ACCEPT",agrId:ZPOnboarding.currentDoc.agrId,isaccept:$(obj).attr("value")},ZPOnboarding.acceptAgreement,others);else if(data.isSuccess){if(data.isAccepted){$("#docs #"+ZPOnboarding.currentDoc.fileId).addClass("completed"),$("#docs #"+ZPOnboarding.currentDoc.fileId).find("i").addClass("OB-tick1");var text=obj.parents("#pdfViewerDiv").find("[name=fileName]").text()+"   --- Accepted";ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.acceptsuccess"))}else{$("#docs #"+ZPOnboarding.currentDoc.fileId).addClass("rejected"),$("#docs #"+ZPOnboarding.currentDoc.fileId).find("i").addClass("OB-close");text=obj.parents("#pdfViewerDiv").find("[name=fileName]").text()+"   --- Rejected";ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.rejectsuccess"))}if($("#docs #"+ZPOnboarding.currentDoc.fileId).attr("iscompleted",data.isAccepted),obj.parents("#pdfViewerDiv").find("[name=fileName]").text(text),obj.parents("#docBtns").hide(),$("#docs li").not(".completed").length>0){var clickObj=$("#docs #"+ZPOnboarding.currentDoc.fileId).next("li").not(".completed");0==$(clickObj).length&&(clickObj=$("#docs #"+ZPOnboarding.currentDoc.fileId).prev("li").not(".completed"),0==$(clickObj).length&&(clickObj=$("#docs").find("li").first())),clickObj.trigger("click")}data.tabState&&(ZPOnboarding.completeTabs.Agreements=!0,ZPOnboarding.checkComplete())}else $(obj).removeClass("disabled")},ZPOnboarding.Objectives=function(data,params,others){if(data.isSuccess){var kraimg=ZPeople.getResourceURL(hrImageUrl+"kra.png"),KRAHeader='<div class="zo_Httl"><h2>'+ZPOnboarding.tabsJson.Objectives.tabCols.DISPLAY_NAME+'</h2><i class="OB-congrats zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div><div class="zo_kravec"><img src="'+kraimg+'"></div>',KRAbody='<div class="zo_kraI">',kras=data.kras;$.each(kras,function(kraInd,kra){KRAbody+="<div>",KRAbody+="<h3>"+kra.kraName+"</h3>",void 0!=kra.goalmapping&&(KRAbody+="<ul>",$.each(kra.goalmapping,function(gInd,goal){KRAbody+="<li>"+goal.goalName+"</li>"}),KRAbody+="</ul>"),KRAbody+="</div>"}),KRAbody+="</div>",Layout.Page.container.find("#onBoardingRightPane:visible").find('[data-click="Objectives"]').html(KRAHeader+KRAbody),ZPOnboarding.completeTabs.Objectives=!0,ZPOnboarding.readOnly||ZPOnboarding.checkComplete()}},ZPOnboarding.Organization=function(orgJson){var orgHtml='<div class="zo_Httl"><h2>'+orgJson.tabCols.DISPLAY_NAME+'</h2><i class="OB-user1 zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div><div class="zo_eCont">';orgHtml=(orgHtml+=ZPOnboarding.iFrameTemplate.replace(/\$ID\$/,"orgFrame")).replace(/\$SRC\$/g,orgJson.tabSpecificData.WEB_URL),orgHtml+="</div>",Layout.Page.container.find("#onBoardingRightPane:visible").find('[data-click="Organization"]').html(orgHtml),ZPOnboarding.readOnly||ZPeople.Request.send("/onboarding/pre/setTabStatus",{tabId:ZPOnboarding.tabsJson.Organization.tabCols.TAB_ID},ZPOnboarding.checkComplete)},ZPOnboarding.openChat=function(userZuid){var params={parmode:"openchat",userId:userZuid};ZPeople.Request.send("/openChat.zp",params)},ZPOnboarding.checkComplete=function(data){if(void 0!=data){if(data.hasOwnProperty("msg"))return void ZPeople.Message.showSuccessMsg(msg);if(data.isSuccess){var LABEL_NAME=Layout.Page.container.find("#onBoardingRightPane").find("[data-click]:visible").attr("data-click");ZPOnboarding.completeTabs[LABEL_NAME]=!0;var activeObj=Layout.Page.container.find("#onBoardingLeftPane").find("#tabsUl li[label="+LABEL_NAME+"]");$(activeObj).addClass("completed"),$.inArray(LABEL_NAME,["Team","Organization"])<0&&("Agreements"!=LABEL_NAME||0!=Layout.Page.container.find("#onBoardingRightPane").find("#docs").find("#agreements").length)&&$(activeObj).next("li").not(".completed").trigger("click")}}var angle=0;angle=ZPOnboarding.totalTabs==Object.keys(ZPOnboarding.completeTabs).length?360:Object.keys(ZPOnboarding.completeTabs).length*ZPOnboarding.singleTabAngle,$("#leftCircle").css({"-webkit-transform":"rotate("+angle+"deg)",transform:"rotate("+angle+"deg)"}),angle>180&&($("#pie").css("clip","rect(auto, auto, auto, auto)"),$("#rightCircle").css({"-webkit-transform":"rotate(180deg)",transform:"rotate(180deg)"}))},ZPOnboarding.AllSet=function(){var allsetHtml='<div class="zo_Httl"><h2>'+ZPI18N.getString("zp.youreset")+'</h2><i class="OB-travel zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div>';allsetHtml+='<div class="zo_gScontent">'+ZPI18N.getString("zp.youresettext")+"<ul>";var reptype="preonboarding"==Layout.Page.currentmode?"P_Candidate":"P_Employee";if(ZPOnboarding.isPreview||$.ajax({type:"POST",async:!1,url:"/onboarding/pre/tabDetails",data:{conreqcsr:csrfToken,parmode:"empTabDetails",pkid:erecno,reportType:reptype,isadmincall:!1},success:function(data){ZPOnboarding.tabsJson=data.tabDetails,ZPOnboarding.tabsOrder=data.tabsOrder}}),$.each(ZPOnboarding.tabsOrder,function(tInd,tLabel){if("AllSet"!=tLabel){var tObject=ZPOnboarding.tabsJson[tLabel].tabCols,fonttag="",docsdiv="";if(ZPOnboarding.isPreview&&("Objectives"==tLabel&&!ZPOnboarding.config.hasObjTab[ZPOnboarding.currentOB.onboarding_type]||!tObject.IS_VISIBLE||"Team"===tLabel&&"null"==_LOGGEDIN_DEPID||"Forms"===tLabel&&0===ZPOnboarding.tabsJson.Forms.tabSpecificData.forms.length||"Checklist"==tLabel||"Welcome"===tLabel&&ZPOnboarding.currentOB.onboarding_type===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE))return;var className=tObject.IS_COMPLETED?"completed":"",encodedname=ZPeople.decodeTxt(tObject.DISPLAY_NAME);if("Agreements"===tLabel){var docsli="";className+=" zo_gSext",ZPOnboarding.completeTabs.Agreements=tObject.IS_COMPLETED,void 0!=(docsData=ZPOnboarding.tabsJson.Agreements.tabSpecificData.policies)&&docsData.length>0&&$.each(docsData,function(docind,docData){if(docData.ACKNOWLEDGE){var ackclass="ack_pndng",crackclass="CR-ack-pending";docData.hasloginuserack&&(ackclass="ack_actv",crackclass="CR-ack-success"),docsli+="<li>"+docData.FILENAME+'<div class="FR ZPack '+ackclass+'"><span class="'+crackclass+'"></span></div></li>'}}),void 0!=(docsData=ZPOnboarding.tabsJson.Agreements.tabSpecificData.docsToSign)&&docsData.length>0&&(fonttag='<font class="IC-ar-dwn rtt S13 PL8"></font>',$.each(docsData,function(docind,docData){var compclass="",iconclass="";void 0!=docData.IS_ACCEPTED&&(docData.IS_ACCEPTED?compclass="completed":iconclass="IC-cls-1px",compclass=docData.IS_ACCEPTED?"completed":"");var displayname=ZPOnboarding.isPreview?AutomationCommon.htmlEncode(docData.DISPLAY_NAME):docData.DISPLAY_NAME;docsli+="<li class="+compclass+">"+displayname+"<i class="+iconclass+"></i></li>"})),docsli.length>0&&(docsdiv="<ul>"+docsli+"</ul>")}else if("Forms"===tLabel){var docsData;className+=" zo_gSext",fonttag='<font class="IC-ar-dwn rtt"></font>',void 0!=(docsData=ZPOnboarding.tabsJson.Forms.tabSpecificData.forms)&&docsData.length>0&&(docsdiv="<ul>",$.each(docsData,function(docind,docData){ZPOnboarding.isPreview&&(docData=ZPFRules.findObject(ZPOnboarding.config.forms,"formId",docData));var compclass=docData.formStatus?"completed":"";docsdiv+='<li class="'+compclass+'">'+docData.formName+"<i></i></li>"}),docsdiv+="</ul>")}ZPOnboarding.isPreview&&(encodedname=$("<div/>").text(encodedname).html()),allsetHtml+="<li class="+className+">"+encodedname+fonttag+"<i></i>"+docsdiv+"</li>"}}),allsetHtml+="</ul>",!ZPOnboarding.readOnly){var href=window.location.href,onclick="ZPOnboarding.checkAndCompleteOnboarding()";ZPPreboarding.isPreBoarding&&(href,onclick='ZPeople.confirm("","","zp.completeonbalert",ZPOnboarding.checkAndCompleteOnboarding)'),allsetHtml+='<button class="btndone" id="cmpOnboarding" onclick='+onclick+">"+ZPI18N.getString("zp.completeonboardingkey")+"</button>"}allsetHtml+="</div>",Layout.Page.container.find("#onBoardingRightPane").find('[data-click="AllSet"]').html(allsetHtml)},ZPOnboarding.configList=function(){ZPOnboarding.currentFlowType=ZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE,0!=Layout.Page.container.find("tr[obid]").length&&0!=Object.keys(ZPOnboarding.obTemplatesList).length||(Layout.Page.container.html(ZPeople.LOADING_HTML),ZPeople.Request.send("/onboarding/flow/list",{onboarding_type:ZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE},ZPOnboarding.configListingPage,{},ZPOnboarding.failureCallBack))},ZPOnboarding.candidateconfigList=function(){ZPOnboarding.currentFlowType=ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE,0==Layout.Page.container.find("tr[obid]").length||0==Object.keys(ZPOnboarding.obTemplatesList).length?(Layout.Page.container.html(ZPeople.LOADING_HTML),CPortal.currentPortalZAID||$.ajax({type:"POST",async:!1,url:CPortal.candidateURLS.CPORTALURL,data:{conreqcsr:csrfToken},success:function(data){if(0==Object.keys(data).length||void 0==data.portalName){var html='<div class="obReports obSearch"><div id="steb01" class="ZPNxtStep"><div class="well ZPPhed"><a class="onbhelp" href="https://www.zoho.com/people/help/adminguide/onboarding-new.html" target="_blank"><div class="IC-qus S21 gry CP FR MR5 MT15"></div></a></div><div class="Scrcont"><div class="obCandidate"><div><h4>'+ZPI18N.getString("zp.setupcandidateportal")+"</h4><p>"+ZPI18N.getString("zp.startnamingportal")+'</p><div class="obcad_img"></div><div class="zp-label Matry" id="add_cportal"><label class="zplt-label">'+ZPI18N.getString("zp.moPortalName")+'</label><div class="zprt-label"><input class="form-control zptxt-edit" placeholder="" onkeyup="CPortal.verifyportalname(this)" type="text" maxlength = "40"></div><i class="IC-info ML10" data-content="" data-placement="top" data-trigger="hover" data-toggle="popover" zptitle="" data-original-title="'+ZPI18N.getString("zp.candroleinfo")+'"></i></div><div class="zp-label zp-label-offset"><div class="zprt-label "><a class="btn btn-primary" onclick="CPortal.createPortal(this);">'+ZPI18N.getString("zp.save")+"</a></div></div></div></div></div></div></div>";Layout.Page.container.html(html),Layout.Page.container.addClass("ob"),Layout.Page.container.find('[data-toggle="popover"]').popover()}else CPortal.currentPortalZAID=data.ZAID,CPortal.portalObj.portalName=data.portalName},error:function(err){ZPOnboarding.failureCallBack(err)}}),CPortal.currentPortalZAID&&ZPeople.Request.send("/onboarding/flow/list",{onboarding_type:ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE},ZPOnboarding.configListingPage,{},ZPOnboarding.failureCallBack)):Layout.Page.container.find(".navbar-default").removeClass("DN")},ZPOnboarding.configListingPage=function(data,params){if(null!=data){var obList="",addnewflow="<h5>"+ZPI18N.getString("zp.onboardingflows")+'</h5><div class="btn-group MR25"> <a class="btn btn-primary btnPlus btnslide" onclick="ZPOnboarding.addNewOnboarding();">'+ZPI18N.getString("zp.addnewflow")+"</a></div>";if(params.onboarding_type===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE){var portalname=void 0===CPortal.portalObj.portalName?"":CPortal.portalObj.portalName;addnewflow='<div class="obclient_port"><div><label>'+ZPI18N.getString("zp.onboardingportal")+'</label><a name="portalName">'+portalname+'</a><input class="form-control fdwid" onblur="CPortal.updateportalname(this)" onkeyup="CPortal.verifyportalname(this)" name="portalValue" value="'+portalname+'" type="text" maxlength = "40" style="display: none;"><i class="IC-pen ML10" onclick="CPortal.updateportalname(this)" name="portalEdit"></i></div><div id="candportallink"><label>'+ZPI18N.getString("zp.copyportallink")+'</label><a class="copylnk IC-copy ZPtitle"  onclick=CPortal.copyTxtToClipBoard()></a><input type="text" class="valselect" id="cportallink" value style="opacity: 0; z-index: -1; position: absolute;"></div></div>'}obList+='<div class="obReports obSearch"><div id="steb01" class="ZPNxtStep"><div class="well ZPPhed"><a class="onbhelp" href="https://www.zoho.com/people/help/adminguide/onboarding-new.html" target="_blank"><div class="IC-qus S21 gry CP FR MR5 MT15"></div></a>'+addnewflow+'</div><div class="Scrcont"><div class="obRepBox open"><div class="table-responsive"><div class="table-header"><table class="table table-hover"><thead><tr class="ZPLHRow"><th width="30%"><span>'+ZPI18N.getString("zp.flowname")+'</span></th><th class="email">'+ZPI18N.getString("zp.applicablefor",[""])+'</th><th width="20%">'+ZPI18N.getString("zp.status")+'</th><th width="20%"></th></tr></thead></table></div><div class="table-content"><table class="table table-hover"><tbody id="listBody">',$.each(data,function(ind,ob){ZPOnboarding.obTemplatesList[ob.ONBOARDINGID]=ob,obList+=ZPOnboarding.config.obRowCreate(ob)}),obList+="</tbody></table></div></div></div></div></div></div>",Layout.Page.container.html(obList),void 0!=ZPPickList.allData&&null!=ZPPickList.allData||$.ajax({type:"POST",async:!1,url:"/createViewAction.zp",data:{mode:"getAllRecords",conreqcsr:csrfToken},success:function(data){ZPPickList.allData=data}}),Layout.Page.container.addClass("ob")}},ZPOnboarding.addNewOnboarding=function(obj){var obHeader=ZPI18N.getString("zp.addflow");void 0!=obj?(obHeader=ZPI18N.getString("zp.editflow"),obData=ZPOnboarding.obTemplatesList[$(obj).parents("[obid]").attr("obid")]):obData={DISPLAY_NAME:"",ONBOARDINGID:"",applicableFor:{locList:{},roleList:{},desList:{}}},void 0==obData.applicableFor&&(obData.applicableFor={locList:{},roleList:{},desList:{}});var obPopup=ZPeople.createModalPopup("addOnboarding"+obData.ONBOARDINGID,obHeader,"PopMdModel popRgtModel modal-right");obPopup.find("#applicableToComponent").html("");var addObHtml='<div class="zpcont-dt zpnew-recedit ZPSCol"><div class="row"><div class="col-sm-6"><div class="dvaddfrm"><div class="zp-label" errorDiv="cantbeempty" name="addOB" for="obname"><label class="zplt-label">'+ZPI18N.getString("zp.flowname")+'</label><div class="zprt-label"><input type="text" class="form-control zptxt-edit" keyname="DISPLAY_NAME" value="'+obData.DISPLAY_NAME+'"/></div></div>',datestr=ZPI18N.getString("zp.dateofjoining");if(obData.ONBOARDING_TYPE==ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&("selected","","disabled",datestr=ZPI18N.getString("zp.onboarding")+" "+ZPI18N.getString("zp.smallsdate")),obData.ONBOARDING_TYPE!=ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE){addObHtml+='<div class="zp-label" name="addFormFields"><label class="zplt-label">'+ZPI18N.getString("zp.applicablelocations")+'</label><div class="zprt-label"><select placeholder="'+ZPI18N.getString("zp.all")+'" keyname="location" multiple="true">',$.each(ZPPickList.allData.Locations,function(locId,locationData){var isSelect=void 0!=obData.applicableFor.locList&&Object.keys(obData.applicableFor.locList).length>0&&void 0!=obData.applicableFor.locList[locId]?"selected":"";addObHtml+="<option "+isSelect+' value="'+locId+'">'+locationData.recName+"</option>"}),addObHtml+="</select></div></div>";var isRole="",isDesgn="",roleClass="DN",desgnClass="DN";void 0!=obData.applicableFor.roleList&&Object.keys(obData.applicableFor.roleList).length>0?(isRole="selected",roleClass=""):void 0!=obData.applicableFor.desList&&Object.keys(obData.applicableFor.desList).length>0&&(isDesgn="selected",desgnClass=""),addObHtml+='<div class="zp-label" name="addFormFields"><label class="zplt-label">'+ZPI18N.getString("zp.applicablefor",[""])+'</label><div class="zprt-label"><select name="applicableType">',addObHtml+='<option value="">'+ZPI18N.getString("zp.choosefield")+"</option><option "+isRole+' value="1">'+ZPI18N.getString("zp.role")+"</option><option "+isDesgn+' value="2">'+ZPI18N.getString("zp.designation")+"</option></select></div></div>",addObHtml+='<div class="zp-label '+roleClass+'" name="addFormFields" id="Applicable_role"><label class="zplt-label">'+ZPI18N.getString("zp.applicableroles")+'</label><div class="zprt-label"><select keyname="role" multiple="true">',$.each(ZPPickList.allData.Roles,function(roleId,roleData){var isSelect=void 0!=obData.applicableFor.roleList&&Object.keys(obData.applicableFor.roleList).length>0&&void 0!=obData.applicableFor.roleList[roleId]?"selected":"";addObHtml+="<option "+isSelect+' value="'+roleId+'">'+roleData.recName+"</option>"}),addObHtml+="</select></div></div>",addObHtml+='<div class="zp-label '+desgnClass+'" name="addFormFields" id="Applicable_desgn"><label class="zplt-label">'+ZPI18N.getString("zp.applicabledesignations")+'</label><div class="zprt-label"><select keyname="designation" multiple="true">',$.each(ZPPickList.allData.Designations,function(desgnId,desgnData){var isSelect=void 0!=obData.applicableFor.desList&&Object.keys(obData.applicableFor.desList).length>0&&void 0!=obData.applicableFor.desList[desgnId]?"selected":"";addObHtml+="<option "+isSelect+' value="'+desgnId+'">'+desgnData.recName+"</option>"}),addObHtml+="</select></div></div>"}var expiry=void 0!=obData.EXPIRY?obData.EXPIRY:"";if(addObHtml+='<div class="zp-label" errordiv="cantbeempty" name="addOB" for="obname"><label class="zplt-label">'+ZPI18N.getString("zp.expiry")+'</label><div class="zprt-label"><input type="text" class="form-control zptxt-edit" keyname="EXPIRY" value="'+expiry+'"></div><label>'+ZPI18N.getString("zp.daysfrom",[datestr])+"</label></div></div></div></div>",obPopup.find("#bodyTag").html(addObHtml),obPopup.addClass("rmbxsdw"),null===ZPOnboarding.pickListComponent||void 0===ZPOnboarding.pickListComponent){var sharedTempTxt=ZPOnboarding.picklistComponentTemplate;Layout.Page.container.find("#applicableToComponent").html(sharedTempTxt);var keys=[];keys.push(ZPPickList.CONSTANTS.DESIGNATIONS),keys.push(ZPPickList.CONSTANTS.ROLES),ZPOnboarding.pickListComponent=ZPPickList.init(keys)}Layout.Page.container.find("#applicableToComponent").html(ZPOnboarding.pickListComponent),Layout.Page.container.find("#applicableToComponent").find("#pickListComp").find(".dropdown-menu").addClass("ZPSchPoP"),obPopup.find('[buttonaction="dismiss"]').attr("onclick","javascript:Layout.Page.container.find('#submitDiv').show();"),obPopup.find("select").select2(),obPopup.find('select[name="applicableType"]').on("change",function(){obPopup.find("[id=Applicable_"+ZPOnboarding.applicableConstants[$(this).val()]+"]").show(),obPopup.find("[id*=Applicable_]").not("[id=Applicable_"+ZPOnboarding.applicableConstants[$(this).val()]+"]").hide()}),obPopup.find("[buttonname=done]").off(),obPopup.find("[buttonname=done]").on("click",function(){errorFunction.removeErrorSpan(obPopup);var params={},obId=obPopup.attr("id").match(/\d+$/);null!=obId&&(params.ONBOARDINGID=obId.toString());var applicableFor={},error=!1;obPopup.find("[keyname]:visible").each(function(){var keyname=$(this).attr("keyname"),keyval=$(this).val(),errorDiv=$(this).parent("div");if("DISPLAY_NAME"==keyname)if(0==keyval.trim().length)errorFunction.errorSpanAttach("displayname empty",errorDiv),error=!0;else{var aDiv=Layout.Page.container.find("#listBody a");null!=obId&&(aDiv=Layout.Page.container.find("#listBody a").not("[id="+obId+"]")),aDiv.each(function(){if($(this).html()==keyval)return errorFunction.errorSpanAttach(ZPI18N.getString("zp.flownameduplicate",[ZPI18N.getString("zp.flowname")]),errorDiv),error=!0,!1}),params[keyname]=keyval}else"EXPIRY"==keyname?0!=keyval.length&&(/^[\d]+$/.test(keyval.trim())?params[keyname]=keyval:(errorFunction.errorSpanAttach("Enter a valid number of days for expiry",errorDiv),error=!0)):"onboarding_type"==keyname?params[keyname]=keyval:null!=keyval&&void 0!=keyval&&0!=keyval.length&&($.inArray(keyname,["role","designation","location"])>-1&&(keyval=keyval.toString()),applicableFor[keyname]=keyval)}),params.applicableFor=JSON.stringify(applicableFor),params.onboarding_type=ZPOnboarding.currentFlowType,error||(ZPeople.Request.send("/onboarding/flow/save",params,ZPOnboarding.saveSuccess,void 0,ZPOnboarding.serverError),obPopup.find("[buttonname=done]").attr("disabled","disabled"),Layout.Page.container.find(".btn-primary").attr("disabled","disabled"))})},ZPOnboarding.configInit=function(){if(ZPOnboarding.currentOB={},ZPOnboarding.currentOB.ONBOARDINGID=Layout.Page.pageId.split("-").pop(),void 0!=ZPOnboarding.obTemplatesList[ZPOnboarding.currentOB.ONBOARDINGID]&&(ZPOnboarding.currentOB.onboarding_type=ZPOnboarding.obTemplatesList[ZPOnboarding.currentOB.ONBOARDINGID].ONBOARDING_TYPE),Layout.Page.container.children().length>0&&0==Layout.Page.container.find("#zp_page_loading").length)Layout.Page.container.show(),ZPOnboarding.config.forms=ZPOnboarding.obFormsList[ZPOnboarding.currentOB.onboarding_type],ZPOnboarding.configLayout=Layout.Page.container;else{var params={ONBOARDINGID:ZPOnboarding.currentOB.ONBOARDINGID};void 0!=ZPOnboarding.currentOB.onboarding_type&&0!=Object.keys(ZPOnboarding.obFormsList[ZPOnboarding.currentOB.onboarding_type]).length||(params.getForms=!0),ZPeople.ALL_USER_LOADED||ZPeople.sendUserListAjax(null,null,!0),void 0==ZPOnboarding.isPAAdmin&&(params.isPAAdmin=!0),ZPeople.Request.send("/onboarding/flow/get",params,ZPOnboarding.configPage,{},ZPOnboarding.failureCallBack),ZPOnboarding.configLayout=Layout.Page.container,Layout.Page.container.html(ZPeople.LOADING_HTML)}},ZPOnboarding.configdata={},ZPOnboarding.configPage=function(data){if($("body").on("click",function(e){0==$(e.target).siblings("#obList").length&&$("[id=obList]").length>0&&$("[id=obList]").parent("div").removeClass("sel")}),ZPOnboarding.config.tabDescTemplate='<div class="innerContainer" errorDiv="cantbeempty"><div class="ZPbold S16"> '+ZPI18N.getString("zp.description")+':</div><div class="dvCriteria"><textarea name="DESCRIPTION" rows="3" placeholder="'+ZPI18N.getString("zp.descplaceholder")+'">$VALUE$</textarea></div></div>',void 0!=data&&null!=data&&(void 0==ZPOnboarding.isPAAdmin&&(ZPOnboarding.isPAAdmin=data.isPAAdmin),void 0!=ZPPickList.allData&&null!=ZPPickList.allData||$.ajax({type:"POST",async:!1,url:"/createViewAction.zp",data:{mode:"getAllRecords",conreqcsr:csrfToken},success:function(data){ZPPickList.allData=data}}),ZPOnboarding.currentOB.onboarding_type=data.onboarding_type,void 0!=data.forms&&(ZPOnboarding.obFormsList[ZPOnboarding.currentOB.onboarding_type]=data.forms,delete data.forms),data.formsfortemplate&&(ZPOnboarding.obFormsListmmTemplate=data.formsfortemplate,delete data.formsfortemplate),data.onboardingtabid&&(ZPOnboarding.onboardingTABID=data.onboardingtabid,delete data.onboardingtabid),ZPOnboarding.configbyid[data.onBoardingId]=data,Layout.Page.container.attr("onBoardingId",data.onBoardingId),Layout.Page.container.attr("onboarding_type",ZPOnboarding.currentOB.onboarding_type)),ZPOnboarding.config.data=ZPOnboarding.configbyid[ZPOnboarding.currentOB.ONBOARDINGID],ZPOnboarding.config.forms=ZPOnboarding.obFormsList[ZPOnboarding.currentOB.onboarding_type],ZPOnboarding.teamMembers=ZPeople.ALL_USER_LOADED?ZPeople.ALL_USERLIST:ZPeople.sendUserListAjax(null,null,!0),ZPOnboarding.roles=ZPOnboarding.configbyid[ZPOnboarding.currentOB.ONBOARDINGID].roles,ZPOnboarding.mmTemplates=ZPOnboarding.configbyid[ZPOnboarding.currentOB.ONBOARDINGID].mmTemplates,ZPOnboarding.hrFiles=ZPOnboarding.configbyid[ZPOnboarding.currentOB.ONBOARDINGID].hrfiles,ZPOnboarding.config.activeTab=ZPOnboarding.configbyid[ZPOnboarding.currentOB.ONBOARDINGID].activeTab,ZPOnboarding.currentFlowType=ZPOnboarding.configbyid[ZPOnboarding.currentOB.ONBOARDINGID].onboarding_type,ZPOnboarding.currentFlowType==ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?(Layout.Page.childUrlParam.formid=ZPOnboarding.CandidateForm.id=ZPOnboarding.configbyid[ZPOnboarding.currentOB.ONBOARDINGID].candidateform.formId,ZPOnboarding.CandidateForm.name=ZPOnboarding.configbyid[ZPOnboarding.currentOB.ONBOARDINGID].candidateform.formName,ZPACommon[MAILALERT_MODE+"_"+Layout.CustomizedUrl.getServiceName()+"_formList"]=[],ZPACommon[MAILALERT_MODE+"_"+Layout.CustomizedUrl.getServiceName()+"_formList"].push({formId:ZPOnboarding.CandidateForm.id,compName:ZPOnboarding.configbyid[ZPOnboarding.currentOB.ONBOARDINGID].candidateform.componentName,dispName:ZPOnboarding.configbyid[ZPOnboarding.currentOB.ONBOARDINGID].candidateform.formName,tableName:"P_Candidate"}),ZPACommon[FIELDUPDATE_MODE+"_"+Layout.CustomizedUrl.getServiceName()+"_formList"]=ZPACommon[CUSTOMFN_MODE+"_"+Layout.CustomizedUrl.getServiceName()+"_formList"]=ZPACommon[MAILALERT_MODE+"_"+Layout.CustomizedUrl.getServiceName()+"_formList"]):ZPOnboarding.config.formsformm=ZPOnboarding.obFormsListmmTemplate,void 0!=ZPOnboarding.config.data){var configLeftHtml='<div class="flwlft"><ul class="flwlistview" id="configTabs">',configRightHtml='<div class="flwrht"><div class="dvApprovalcon P30" id="tabData"><div class="submitContainer" id="submitDiv"><button class="btn btn-default" onclick="ZPOnboarding.updateOnboardingConfig()" type="submit">'+ZPI18N.getString("zp.update")+'</button><button class="btn btn-default" type="reset" onclick="ZPOnboarding.resetConfig()">'+ZPI18N.getString("zp.reset")+"</button>";configRightHtml+='<button class="preview btn btn-default" onclick="ZPOnboarding.config.constructJson(true)">'+ZPI18N.getString("zp.clicktopreview")+"</button>",configRightHtml+="</div>";var tabDetails=ZPOnboarding.config.data.tabDetails;ZPOnboarding.tabsOrder=ZPOnboarding.config.data.tabsOrder;var templateDetails=ZPOnboarding.config.data.templateDetails;ZPOnboarding.obTemplatesList[templateDetails.ONBOARDINGID]=templateDetails;var flowurl="zp#onboarding/flow/employeeflow",maindiv='<div class="obSettings" id="onboarding_settings"><div class="ZPobTop" obid="'+templateDetails.ONBOARDINGID+'"><div class="fl">';if(ZPOnboarding.currentFlowType===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?(maindiv+='<a class="goBack" href="'+(flowurl="zp#onboarding/flow/candidateflow")+'"></a><div class="ZPobTopHd"><div class="ZPbold S16 ML10" id="flowname" name="candflowName">'+templateDetails.DISPLAY_NAME+'</div><input class="form-control fdwid" onblur="ZPOnboarding.updateCandidateFlowname(this)" name="candflowValue" value="" type="text" style="display: none;"></div>',maindiv+='</div><i class="IC-pen ML10" onclick="ZPOnboarding.updateCandidateFlowname(this)" name="candflowEdit"></i></div>'):(maindiv+='<a class="goBack" href="'+flowurl+'"></a><div class="ZPobTopHd" onclick="ZPOnboarding.showhideTemplateList(this)"><span id="flowname">'+templateDetails.DISPLAY_NAME+'</span><ul id="obList"></ul><a onclick="ZPOnboarding.addNewOnboarding()" class="create">'+ZPI18N.getString("zp.addflow")+'</a></div></div><div class="brcumb" id="applicable">'+ZPI18N.getString("zp.applicablefor",[""])+":",void 0===templateDetails.applicableFor&&(maindiv+="<span>"+ZPI18N.getString("zp.all")+"</span>"),maindiv+='</div><i class="IC-pen ML10" onclick="ZPOnboarding.addNewOnboarding(this)"></i></div>'),$.each(ZPOnboarding.tabsOrder,function(ind,tabKey){var tab=tabDetails[tabKey].tabCols;ZPOnboarding.configdata[tabKey]=tabDetails[tabKey],configLeftHtml+='<li data-click="'+tabKey+'" id="'+tab.TAB_ID+'" staticTab="'+($.inArray(tabKey,ZPOnboarding.staticTabs)>-1)+'" errordiv="cantbeempty" onclick="ZPOnboarding.config.openTab(\''+tabKey+"')\">",$.inArray(tabKey,ZPOnboarding.nondragableTabs)<0&&(configLeftHtml+='<i class="IC-drag" name="dragIcon"></i>');var isEditable="Welcome"!==tabKey||ZPOnboarding.currentFlowType!==ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?'<i tabOpen="false" class="IC-pen" onclick="ZPOnboarding.showEdit(this)" name="tabEdit"></i>':"";if(configLeftHtml+='<a name="tabName" keyname="DISPLAY_NAME" style="max-width: 75%;">'+tab.DISPLAY_NAME+'</a><input onblur="ZPOnboarding.showEdit(this)" name="tabValue" tabOpen="false" value="'+tab.DISPLAY_NAME+'" type="text">'+isEditable,$.inArray(tabKey,ZPOnboarding.staticTabs)<0){var checked=tab.IS_VISIBLE?"checked":"";configLeftHtml+='<label class="ob_check" tabOpen="false"><input type="checkbox" '+checked+' /><span class="checkBtn"></span></label>'}configLeftHtml+='<i class="IC-info" id="errorInfo" data-content="" data-placement="left" data-trigger="hover" data-toggle="popover" zptitle="" data-original-title=""></i>',configLeftHtml+="</li>",configRightHtml+='<div class="mainTabContent DN" tab-content="'+tabKey+'">'+ZPOnboarding.config[tabKey]()+"</div>"}),maindiv+='<div class="dvflow_str bgrey"><form target="zp_addgallery_response" method="post" action="/addToGallery.zp" enctype="multipart/form-data" name="galleryZip"/></form><iframe frameborder="0" style="height: 0px;width: 0px; display: none;" name="zp_addgallery_response"></iframe>'+(configLeftHtml+="</ul></div>")+(configRightHtml+="</div></div>")+"</div></div>",Layout.Page.container.html(maindiv),Layout.Page.container.addClass("ZPcontwrap ob"),void 0==ZPOnboarding.config.activeTab&&ZPOnboarding.config.data.onboarding_type==ZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE?ZPOnboarding.config.activeTab="Welcome":void 0==ZPOnboarding.config.activeTab&&(ZPOnboarding.config.activeTab="Forms"),Layout.Page.container.find('#configTabs li[data-click="'+ZPOnboarding.config.activeTab+'"]').trigger("click"),Layout.Page.pageId=Layout.Page.container.attr("id"),ZPOnboarding.config.data.onboarding_type==ZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE){Layout.Page.container.find("[keyname=WELCOME_FEED_TEXT]").replaceWith(ZPOnboarding.config.editorBaseContent("feedEditor"+ZPOnboarding.config.data.onBoardingId)),AutomationCommon.editorFieldsCallback();var initobject;initobject={id:"feedEditor"+ZPOnboarding.config.data.onBoardingId,parmode:"richtext",content:ZPeople.decodeTxt(ZPOnboarding.configdata.Welcome.tabSpecificData.WELCOME_FEED_TEXT),editorheight:200,avoidMoreOption:!0},editor=ZPUtil.createZEEditor(initobject),Layout.Page.container.find("#feedEditor"+ZPOnboarding.config.data.onBoardingId+" iframe").attr({keyname:"WELCOME_FEED_TEXT",displayText:ZPI18N.getString("zp.welcomefeed")}),Layout.Page.container.find("#msgEditor .zei-table").closest("li").addClass("DN"),$.each(ZPOnboarding.config.forms,function(formInd,form){"P_Employee"==form.componentName&&(ZPOnboarding.EmployeeForm.name=form.formName,Layout.Page.childUrlParam.formid=ZPOnboarding.EmployeeForm.id=form.formId,ZPACommon[MAILALERT_MODE+"_"+Layout.CustomizedUrl.getServiceName()+"_formList"]=[],ZPACommon[MAILALERT_MODE+"_"+Layout.CustomizedUrl.getServiceName()+"_formList"].push({formId:form.formId,compName:form.componentName,dispName:form.formName,tableName:"P_Employee"}),ZPACommon[FIELDUPDATE_MODE+"_"+Layout.CustomizedUrl.getServiceName()+"_formList"]=ZPACommon[CUSTOMFN_MODE+"_"+Layout.CustomizedUrl.getServiceName()+"_formList"]=ZPACommon[MAILALERT_MODE+"_"+Layout.CustomizedUrl.getServiceName()+"_formList"])})}var sortDiv=Layout.Page.container.find("#configTabs");$(sortDiv).sortable({items:"[staticTab=false]",handle:$(sortDiv).find("li[statictab=false] [name=dragIcon]")}),Layout.Page.container.find("#chooseFormDiv").hide(),Layout.Page.container.find("#selectFormDiv").show(),Layout.Page.container.find("[id=errorInfo]").hide(),Layout.Page.container.find('[data-toggle="popover"]').tooltip({placement:"right",container:"body"}),Layout.Page.container.find('[tabOpen="false"]').on("click",function(e){e.stopPropagation()}),Layout.Page.container.find("select").select2();var formsortdiv=Layout.Page.container.find("#chooseForms");$(formsortdiv).sortable({items:"ul[name=formsul]",handle:$(formsortdiv).find("ul[name=formsul] li [name=sortdiv]")});var agreementssortdiv=Layout.Page.container.find("#docsToSign");$(agreementssortdiv).sortable({items:"tbody tr",handle:$(agreementssortdiv).find("tbody tr [name=dragIcon]")}),AutomationCommon.appendSelect2Properties("select");if(Layout.Page.container.find(".obSettings").find(".dvflow_str.bgrey").append('<div id="task" class="editCL chklistMainDiv"></div><div id="checklist" class="editCL chklistMainDiv"></div><div id="fieldupdate" class="editCL chklistMainDiv"></div><div id="mailalert" class="editCL chklistMainDiv"></div><div id="customfunction" class="editCL chklistMainDiv"></div><div id="backSlider" class=""></div>'),void 0!==templateDetails.applicableFor)ZPOnboarding.applicableForBuild(templateDetails.applicableFor)}},ZPOnboarding.config.Welcome=function(){var welcomeData=ZPOnboarding.configdata.Welcome,videoURL=void 0!=welcomeData.tabSpecificData.VIDEO_URL?decodeURIComponent(welcomeData.tabSpecificData.VIDEO_URL):"",welcomeHtml='<div class="innerContainer" errordiv="cantbeempty"><div class="ZPbold S16">'+ZPI18N.getString("zp.homevideourl")+':</div><div class="dvCriteria"><input keyname="VIDEO_URL" value="'+videoURL+'" class="urls" placeholder="'+ZPI18N.getString("zp.videolink")+'" type="text"></div></div>';if(ZPOnboarding.currentOB.onboarding_type==ZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE){welcomeHtml=(welcomeHtml+=ZPOnboarding.config.tabDescTemplate).replace(/\$VALUE\$/,welcomeData.tabCols.DESCRIPTION),welcomeHtml+='<div class="innerContainer" errorDiv="cantbeempty"><div class="ZPbold S16"><span>'+ZPI18N.getString("zp.welcomefeed")+":</span></div>";var select0="selected",select1="",select2="";2==welcomeData.tabSpecificData.POST_FEEDS_TO?(select0="",select1="selected"):3==welcomeData.tabSpecificData.POST_FEEDS_TO&&(select0="",select2="selected"),welcomeHtml+='<div class="MB10">'+ZPI18N.getString("zp.feeds.post")+" "+ZPI18N.getString("zp.sto")+'<select keyname="POST_FEEDS_TO" ><option value="1" '+select0+">"+ZPI18N.getString("zp.department")+'</option><option value="2" '+select1+">"+ZPI18N.getString("zp.user")+'</option><option value="3" '+select2+">"+ZPI18N.getString("zp.all")+"</option></select></div>",welcomeHtml+='<div class="dvCriteria" id="msgEditor"><textarea rows="3" keyname="WELCOME_FEED_TEXT" displayText="'+ZPI18N.getString("zp.welcomefeed")+'" value="" placeholder="'+ZPI18N.getString("zp.feedmsgdesc")+'"></textarea></div></div>'}return welcomeHtml+='<div class="innerContainer" errorDiv="cantbeempty"><div class="ZPbold S16">'+ZPI18N.getString("zp.selecthr")+':</div><div class="dvCriteria selectDrop"><select keyname="CONTACT_HR_PERSON" displayText="'+ZPI18N.getString("zp.contactperson")+'" name="dropdown" class="selectBox" style="display: none;">',$.each(ZPOnboarding.teamMembers,function(memberInd,member){var selected=welcomeData.tabSpecificData.CONTACT_HR_PERSON==member.usererec?"selected":"";welcomeHtml+='<option value="'+member.usererec+'" '+selected+">"+member.name+"</option>"}),welcomeHtml+="</select></div></div>"},ZPOnboarding.config.Forms=function(isAppend){var formData=ZPOnboarding.configdata.Forms,formHtml=ZPOnboarding.config.tabDescTemplate;formHtml=formHtml.replace(/\$VALUE\$/,formData.tabCols.DESCRIPTION),formHtml+='<div class="innerContainer chseFrm" errorDiv="cantbeempty"><div class="ZPbold S16">'+ZPI18N.getString("zp.chooseforms")+':</div><div class="zp_obCsFrm" id="chooseForms" keyname="forms">',formHtml+='<ul class="ttle"><li></li><li>'+ZPI18N.getString("zp.form")+"</li><li>"+ZPI18N.getString("zp.lms.mandatory")+"</li></ul>";var selectedForms=formData.tabSpecificData.forms;return selectedProp=[],selectProp={},void 0!=selectedForms&&0!=selectedForms.length||(formHtml+=ZPOnboarding.addformul("")),void 0!=selectedForms&&selectedForms.length>0&&$.each(selectedForms,function(selectInd,selectform){formHtml+=ZPOnboarding.addformul(selectform)}),$('[data-toggle="popover"]').popover(),formHtml+="</div></div>"},ZPOnboarding.config.editorBaseContent=function(editorId){return'<div class="row"> <div class="msgpreview-outer"><div class="clearfix PT10 bgrey"><div class="col-md-3"><label class="control-label ZPbold">'+ZPI18N.getString("zp.availablemergefields")+'</label><div id="allRlatedFormsList"><select id="pageComp"><option value="other_fields">'+ZPI18N.getString("zp.systemfields")+"</option></select></div></div>"+'<div class="form-group col-md-3"><label class="control-label ZPbold">'+ZPI18N.getString("zp.selectfield")+'</label><div id="allFieldListCombo"><div select2id="other_fields"><select id="other_fields"><option value="FEED USER MENTION">'+ZPI18N.getString("zp.feedusermention")+"</option></select></div></div></div>"+'<div class="form-group col-md-4"><label class="control-label ZPbold">'+ZPI18N.getString("zp.fieldvalue")+'</label><input value="${FEED USER MENTION}" id="fieldLabelBox" readonly="" class="form-control" type="text"></div>'+'<div class="form-group col-md-2"><label class="control-label ZPbold W100">&nbsp; </label><a onclick="addreplacefields($pageId().find(\'#fieldLabelBox\').val())" class="btn btn-primary btn-small">'+ZPI18N.getString("zp.insert")+'</a></div> </div><div id="recordTemps"></div>'+'<div class="msgpreview clearfix"><div class="fieldn" id="'+editorId+'" style="width:100%;float: left;"> </div></div>   </div></div>'},ZPOnboarding.config.openTab=function(activeTab){Layout.Page.container.find("[tab-content]").hide(),Layout.Page.container.find("[tab-content="+activeTab+"]").show(),Layout.Page.container.find("[data-click]").removeClass("sel"),Layout.Page.container.find("[data-click="+activeTab+"]").addClass("sel"),"Objectives"==activeTab&&ZPOnboarding.isPAAdmin&&(""==Layout.Page.container.find("#kraParent").html()?ZPeople.Request.send("/settingsKra.zp",{},ZPOnboarding.config.loadkras):Appraisal.Settings.getKralistnew()),"Checklist"==activeTab&&(Layout.Page.container.find("#checklistReport").find(".obRepBox").show(),0==Layout.Page.container.find("#checklistDiv").find(".DIB.ZPNdata").length&&Layout.Page.container.find("#checklistDiv").find(".DIB").html('<div class="ZPNdata" onclick="ZPOnboarding.addChecklist();"><i class="CR-nodata-chklst"><i class="path1"></i><i class="path2"></i><i class="path3"></i><i class="path4"></i><i class="IC-plus-round"></i></i><span>'+ZPI18N.getString("zp.checklist.add")+'</span></div><div class="ZPNdata" onclick="ZPOnboarding.config.tagChecklist();"><i class="CR-notag-check"><i class="path1"></i><i class="path2"></i><i class="path3"></i><i class="path4"></i><i class="IC-plus-round"></i></i><span>'+ZPI18N.getString("zp.checklist.tag")+"</span></div>"))},ZPOnboarding.config.Agreements=function(isAppend){var agreeData=ZPOnboarding.configdata.Agreements,agrHtml=ZPOnboarding.config.tabDescTemplate,applicableroles="";ZPOnboarding.currentOB.onboarding_type==ZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&(applicableroles="<td><span>"+ZPI18N.getString("zp.applicableroles")+"</span></td>"),agrHtml=agrHtml.replace(/\$VALUE\$/,agreeData.tabCols.DESCRIPTION),agrHtml+='<div class="innerContainer" errorDiv="cantbeempty" name="agreements"><div class="ZPbold S16">'+ZPI18N.getString("zp.docstoaccept")+':</div><div class="dvCriteria"><table class="table table-hover bgw" id="docsToSign">',agrHtml+='<thead><tr><td width="1%"></td><td width="16%"><span>'+ZPI18N.getString("zp.zs.documentname")+"</span></td><td><span>"+ZPI18N.getString("zp.form")+"</span></td><td><span>"+ZPI18N.getString("zp.mailmerge")+"</span></td>"+applicableroles+"<td><span>"+ZPI18N.getString("zp.signtype")+"</span></td><td><span></span></td></tr></thead><tbody>";var docsToSign=void 0!=agreeData.tabSpecificData.docsToSign&&agreeData.tabSpecificData.docsToSign.length>0?agreeData.tabSpecificData.docsToSign:[{DISPLAY_NAME:"",TEMPLATEID:""}];$.each(docsToSign,function(docInd,doc){agrHtml+='<tr><td><i class="IC-drag" name="dragIcon"></i></td><td class="checked" errorDiv="cantbeempty "width="160px"><input name="DISPLAY_NAME" type="text" value="'+doc.DISPLAY_NAME+'"/></td><td width="160px"><select name="TEMPLATEFORM" onchange="ZPOnboarding.config.mailmergetmplist(this)"><option value="">-'+ZPI18N.getString("zp.select")+"-</option>";var formid="",templates="";doc.TEMPLATEID&&($.each(ZPOnboarding.mmTemplates,function(mInd,template){doc.TEMPLATEID!=template.tid||(formid=template.formId)}),$.each(ZPOnboarding.mmTemplates,function(mInd,template){if(template.formId==formid){var selected=doc.TEMPLATEID==template.tid?"selected":"";templates+='<option formid="'+template.formId+'" value="'+template.tid+'" '+selected+">"+template.fname+"</option>"}}));var forms=ZPOnboarding.config.formsformm;if(ZPOnboarding.currentOB.onboarding_type==ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE){var selct=formid==ZPOnboarding.CandidateForm.id?"selected":"";agrHtml+='<option value="'+ZPOnboarding.CandidateForm.id+'" '+selct+">"+ZPOnboarding.CandidateForm.name+"</option>",forms=ZPOnboarding.config.forms}$.each(forms,function(index,obj){var selected=formid==obj.formId?"selected":"";agrHtml+='<option value="'+obj.formId+'" '+selected+">"+obj.formName+"</option>"}),agrHtml+="</select></td>",agrHtml+='<td class="checked" errorDiv="cantbeempty" width="160px"><select name="TEMPLATEID" ><option value="">-'+ZPI18N.getString("zp.select")+"-</option>",formid&&(agrHtml+=templates),agrHtml+="</select></td>",ZPOnboarding.currentOB.onboarding_type==ZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&(agrHtml+='<td width="300px" class="checked"><select placeholder="'+ZPI18N.getString("zp.all")+'" name="applicableRoles" multiple="true">',$.each(ZPOnboarding.roles,function(rInd,role){var applicableRoles=void 0!=doc.applicableRoles?doc.applicableRoles:[],selected=$.inArray(role.roleId,applicableRoles)>-1?"selected":"";agrHtml+='<option value="'+role.roleId+'" '+selected+">"+role.roleName+"</option>"}),agrHtml+="</select></td>");var type1="",type2="",type3="",type4="";switch(doc.AGREEMENTS_TYPE){case 4:type4="selected";break;case 2:type2="selected";break;case 3:type3="selected";break;default:type1="selected"}var onchange="",optionshtml="";ZPOnboarding.config.data.esignConfigurations.AdobeSign&&(optionshtml+='<option value="2" '+type2+">"+ZPI18N.getString("zp.adobeesign")+"</option>"),ZPOnboarding.config.data.esignConfigurations.DocuSign&&(optionshtml+='<option value="3" '+type3+">"+ZPI18N.getString("zp.docusign")+"</option>"),ZPOnboarding.config.data.esignConfigurations.ZohoSign&&(optionshtml+='<option value="4" '+type4+">"+ZPI18N.getString("zp.zohosign")+"</option>",onchange="ZPOnboarding.alertforzohosign(this)"),agrHtml+='<td width="150px" class="checked"><select name="AGREEMENTS_TYPE" onchange='+onchange+'><option value="1" '+type1+">"+ZPI18N.getString("zp.extenddecline")+"</option>",agrHtml+=optionshtml,agrHtml+='</select></td><td width="80px"><div class="IC-plus-fill S16 blu FL MT5 CP" onclick="ZPOnboarding.addRemove(this,true)"></div><div class="IC-cls-fill S16 red FL MT5 ML5 CP" onclick="ZPOnboarding.addRemove(this)"></div></td></tr>'}),agrHtml+="</tbody></table></div></div>",agrHtml+='<div class="innerContainer" name="policies" errorDiv="cantbeempty"><div class="ZPbold S16">'+ZPI18N.getString("zp.docstoread")+':</div><div class="dvCriteria" onmousedown="ZPOnboarding.refreshFilesList()">';var policies=void 0!=agreeData.tabSpecificData.policies&&agreeData.tabSpecificData.policies.length>0?agreeData.tabSpecificData.policies:[""];return agrHtml+='<select keyname="policies" multiple>',$.each(ZPOnboarding.hrFiles,function(fInd,hrFile){var select=$.inArray(hrFile.fileID,policies)>-1?"selected":"";agrHtml+='<option value="'+hrFile.fileID+'" '+select+">"+hrFile.fileName+"</option>"}),agrHtml+="</select></div></div>"},ZPOnboarding.config.Organization=function(isAppend){var orgData=ZPOnboarding.configdata.Organization.tabCols,orgSpecData=ZPOnboarding.configdata.Organization.tabSpecificData,orgHtml=ZPOnboarding.config.tabDescTemplate;orgHtml=orgHtml.replace(/\$VALUE\$/,orgData.DESCRIPTION);var webUrl=void 0!=orgSpecData.WEB_URL?orgSpecData.WEB_URL:"";return orgHtml+='<div class="innerContainer" errordiv="cantbeempty"><div class="ZPbold S16">'+ZPI18N.getString("zp.companyurl")+'</div><div class="dvCriteria"><input keyname="WEB_URL" value="'+webUrl+'" class="urls" placeholder="'+ZPI18N.getString("zp.weburl")+'" displayText="'+ZPI18N.getString("zp.weburl")+'" type="text"></div></div>'},ZPOnboarding.config.subTab=function(activeSubTab){Layout.Page.container.find("[tab-content]:visible [subtab-content]").hide(),Layout.Page.container.find("[tab-content]:visible [subtab-content="+activeSubTab+"]").show(),Layout.Page.container.find("[tab-content]:visible [sub-tabs]").removeClass("sel"),Layout.Page.container.find("[tab-content]:visible [sub-tabs="+activeSubTab+"]").addClass("sel")},ZPOnboarding.config.Team=function(isAppend){var teamData=ZPOnboarding.configdata.Team.tabCols,teamHtml=ZPOnboarding.config.tabDescTemplate;return teamHtml=teamHtml.replace(/\$VALUE\$/,teamData.DESCRIPTION)},ZPOnboarding.config.Profile=function(isAppend){var teamData=ZPOnboarding.configdata.Profile.tabCols,teamHtml=ZPOnboarding.config.tabDescTemplate;return teamHtml=teamHtml.replace(/\$VALUE\$/,teamData.DESCRIPTION)},ZPOnboarding.config.Objectives=function(isAppend){var objData=ZPOnboarding.configdata.Objectives.tabCols,objHtml=ZPOnboarding.config.tabDescTemplate;return objHtml=objHtml.replace(/\$VALUE\$/,objData.DESCRIPTION),ZPOnboarding.isPAAdmin&&(objHtml+='<div id="kraParent"></div>'),objHtml},ZPOnboarding.config.loadkras=function(data,params){void 0!=data&&data.trim().length>0&&(Layout.Page.container.find("#kraParent").html(data),Appraisal.Settings.getKralistnew())},ZPOnboarding.config.init=function(){ZPeople.Request.send("/getBasicList.zp",{})},ZPOnboarding.config.loadBasic=function(data){(data.msg="success")&&(ZPOnboarding.departments=data.departments,ZPOnboarding.mailmergeTemplates=data.mailmergetemplates,ZPOnboarding.desgns=data.desgns,Layout.Page.container.find("#obDepts").length>0&&Layout.Page.container.find("#obDepts").html(ZPOnboarding.setSelectOptions(ZPOnboarding.departments,depId,depName)),Layout.Page.container.find("#obmailMerge").length>0&&Layout.Page.container.find("#obmailMerge").html(ZPOnboarding.setSelectOptions(ZPOnboarding.mailmergeTemplates,mmId,mmName)),Layout.Page.container.find("#obDesgn").length>0&&Layout.Page.container.find("#obDesgn").html(ZPOnboarding.setSelectOptions(ZPOnboarding.desgns,desgnId,desgnName)),Layout.Page.find("#obDepts, #obmailMerge, #obDesgn").select2())},ZPOnboarding.setSelectOptions=function(json,idKey,nameKey){var optHtml="";return $.each(json,function(ind,jsonData){optHtml+='<option id="'+jsonData[idKey]+">"+jsonData[nameKey]+"</option>"}),optHtml},ZPOnboarding.config.Checklist=function(data){var DN="",checklisthtml="",nodataDn="";if(void 0!=ZPOnboarding.configdata.Checklist.tabSpecificData.checklist&&0!=Object.keys(ZPOnboarding.configdata.Checklist.tabSpecificData.checklist).length){nodataDn=" DN";var checklist=ZPOnboarding.configdata.Checklist.tabSpecificData.checklist;$.each(checklist,function(ind,jsonData){checklisthtml+='<tr class="ZPLRow " id="'+jsonData.tempId+'"><td class="cb"></td><td class="name ">'+jsonData.tempName+'</td><td class="clcount">'+jsonData.count+'</td><td><div class="ZPaction"><a data-original-title="Edit" data-content="" data-placement="right" data-trigger="hover" data-toggle="tooltip" zptitle="" class="IC-pen lnk S14" onclick="checklist.editChecklist(\''+jsonData.tempId+'\')"></a><a class="IC-delete ML20 lnk S14" data-content="" data-placement="right" data-trigger="hover" data-toggle="tooltip" zptitle="" data-original-title="Delete" onclick="ZPOnboarding.deleteChecklist(\''+jsonData.tempId+"')\"></a></div></td></tr>"})}else DN=" hide";var html='<div class="obChecklist"><div id="checklistDiv"><div class="obChecklistHdr'+DN+'"><div class="btn-group FR"><a class="FL btn btn-primary btnPlus MR15" onclick="ZPOnboarding.addChecklist();">'+ZPI18N.getString("zp.checklist.add")+'</a><a class="FL btn btn-default" id="obTagDiv" onclick="ZPOnboarding.config.tagChecklist();">'+ZPI18N.getString("zp.checklist.tag")+"</a></div></div>";return html+='<div class="text-center'+nodataDn+'"><div class="DIB"><div class="ZPNdata" onclick="ZPOnboarding.addChecklist();"><i class="CR-nodata-chklst"><i class="path1"></i><i class="path2"></i><i class="path3"></i><i class="path4"></i><i class="IC-plus-round"></i></i><span>'+ZPI18N.getString("zp.checklist.add")+'</span></div><div class="ZPNdata" onclick="ZPOnboarding.config.tagChecklist();"><i class="CR-notag-check"><i class="path1"></i><i class="path2"></i><i class="path3"></i><i class="path4"></i><i class="IC-plus-round"></i></i><span>'+ZPI18N.getString("zp.checklist.tag")+"</span></div></div></div></div>",html+='<div id="checklistReport"><div id="wrapper" class="'+DN+'"><div id="page-wrapper" class="Nbar5 Abar1"><div class="cont-wrp"><div class="main-wrp"><div class="obReports"><div id="steb01" class="ZPNxtStep"><div class="Scrcont"><div class="obRepBox open "><div class="table-responsive "><div class="table-header "><table class="table table-hover "><thead><tr class="ZPLHRow "><th class="cb"></th><th class="name "><span>'+ZPI18N.getString("zp.checklist.name")+"</span></th><th>"+ZPI18N.getString("zp.associatedtasks")+'</th><th class="trigger"></th></tr></thead></table></div><div class="table-content "><table class="table table-hover "><tbody id="checklistbody">',html+=checklisthtml,html+="</tbody></table></div></div></div></div></div></div></div></div></div></div></div>",html+="</div>"},ZPOnboarding.config.LMS_Course=function(){if(ZPOnboarding.config.data.tabDetails.LMS_Course.tabSpecificData.msg)html=ZPOnboarding.config.data.tabDetails.LMS_Course.tabSpecificData.msg;else{var html=ZPOnboarding.config.tabDescTemplate;html=html.replace(/\$VALUE\$/,ZPOnboarding.config.data.tabDetails.LMS_Course.tabCols.DESCRIPTION),html+='<div class="innerContainer chseCrd" errordiv="cantbeempty"><div class="zp_obCsFrm"><div class="zp_CrSrch">';var selectedcourses,selectedcourseshtml="";selectedcourses=ZPOnboarding.config.data.tabDetails.LMS_Course.tabSpecificData.courses,$.each(selectedcourses,function(index1,selectedcourse){var lmsinfo=selectedcourse.courseBasicDetails[0];if(lmsinfo){var non_md="non_md",ismandatory=!1,onclick='window.open("training#lms-view/course/'+lmsinfo.courseId+'/overview","_blank")';selectedcourse.isMandatory&&(non_md="",ismandatory=!0),void 0==lmsinfo.courseImage?Math.floor(Math.random()*Math.floor(44))+1:lmsinfo.courseImage;var bgclass="zp_Crh";lmsinfo.isSystem||(bgclass="zp_Crh CBg"+lmsinfo.bannerBGData.clrId);var courseImageUrl=lmsinfo.isSystem?ZPOnboarding.generateSourceURL(lmsinfo.courseImageInfo):ZPOnboarding.generateRandomCourseImage(lmsinfo.courseImageInfo);selectedcourseshtml+='<div class="zp_Cr crdlv" id="'+lmsinfo.courseId+'" > <div style="background: url('+courseImageUrl+') right/cover" class="'+bgclass+'" onclick='+onclick+"></div>",selectedcourseshtml+='<div class="zp_Crf"> <font class="zp_ftr"><i class="IC-tick2 '+non_md+'" ismandatory='+ismandatory+' onclick="ZPOnboarding.changeLMSstatus(this)"></i><p>'+ZPI18N.getString("zp.mandatorycourse")+"</p></font></div>",selectedcourseshtml+='<div class="zp_Crc" onclick='+onclick+'></i><label><em class="zp_ldot">Self Paced Learning</em></label><h4><i class=""></i>'+lmsinfo.courseName+"</h4>",void 0!=lmsinfo.description&&(selectedcourseshtml+='<p title="'+lmsinfo.description+'">'+lmsinfo.description+"</p>"),selectedcourseshtml+='</div><i class="IC-cls" onclick="ZPOnboarding.removeLMSCourse(this)"></i></div>'}}),html+='<div class="zp_CrBtn"><button id="onblmssearchbtn" onclick="ZPOnboarding.searchPopupLMS()">'+ZPI18N.getString("zp.lms.course.coursecreate")+"</button></div></div>",html+='<div id="onblmscourses">',html+=selectedcourseshtml,html+="</div></div></div>"}return html},ZPOnboarding.showFileName=function(obj){var fName=$(obj).val();$(obj).siblings("#zp_uploadfilebtn").find("span").html(ZPI18N.getString("zp.removeandnew")),$(obj).siblings("#importFname").empty().text(fName),$(obj).siblings("#zp_uploadname").show();var a=$(obj);$(a).after($(a).clone(!0)),$(a).hide(),Layout.Page.container.find("[name=galleryZip] input[name="+$(a).attr("name")+"]").length>0?Layout.Page.container.find("[name=galleryZip] input[name="+$(a).attr("name")+"]").replaceWith(a):$(a).appendTo(Layout.Page.container.find("[name=galleryZip]"))},ZPOnboarding.updateOnboardingConfig=function(){var params={ONBOARDINGID:Layout.Page.container.attr("onboardingid").toString()},configData=ZPOnboarding.config.constructJson(!1);void 0!=configData&&(params.configData=JSON.stringify(configData),ZPeople.Request.send("/onboarding/flow/save",params,ZPOnboarding.saveSuccess,void 0,ZPOnboarding.serverError))},ZPOnboarding.uploadFilesResponse=function(newFiles){var galDiv=Layout.Page.container.find("#galleryImages");newFiles.length>0&&$.each(newFiles,function(fInd,fileId){galDiv.append('<div class="imgContainer" name="imgContainer"><img src="/viewPhoto?filename='+fileId+'" id="'+fileId+'"/></div>')}),Layout.Page.container.find("#zp_uploadfilebtn input").val(""),Layout.Page.container.find("#importFname").text(""),Layout.Page.container.find("#zp_uploadfilebtn span").html(ZPI18N.getString("zp.uploadfile")),Layout.Page.container.find("[name=galleryZip] #galleryFileName").remove(),ZPOnboarding.updateOnboardingConfig()},ZPOnboarding.saveSuccess=function(data,params,others){if(void 0==params.configData)if(data.msg==zpconst.CommonMessages.SUCCESSMSG){Layout.Page.container.find("[id*=addOnboarding]").modal("hide"),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatedsuccessfully"));var obRow=ZPOnboarding.config.obRowCreate(data.newOb);if(void 0==params.ONBOARDINGID){Layout.Page.container.find("#listBody").append(obRow);var flowurl=ZPOnboarding.currentFlowType==ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?"candidateflow":"employeeflow";window.location.href="#onboarding/flow/"+flowurl+"/obId-"+data.newOb.ONBOARDINGID}else{$(".obRepBox .table-content").find("tr[obid="+data.newOb.ONBOARDINGID+"]").replaceWith(obRow);var maindiv="";void 0!=data.newOb.applicableFor?ZPOnboarding.applicableForBuild(data.newOb.applicableFor):(maindiv+=ZPI18N.getString("zp.leave.others.applicablefor",[""])+":<span>"+ZPI18N.getString("zp.all")+"</span>",Layout.Page.container.find("#applicable").html(maindiv)),Layout.Page.container.find("#flowname").html(data.newOb.DISPLAY_NAME)}if(ZPOnboarding.obTemplatesList[data.newOb.ONBOARDINGID]=data.newOb,Layout.Page.container.attr("onboardingid")!=data.newOb.ONBOARDINGID||Layout.Page.container.siblings("[onboardingid="+data.newOb.ONBOARDINGID+"]").length>0){var obDiv=Layout.Page.container.attr("onboardingid")!=data.newOb.ONBOARDINGID?Layout.Page.container:Layout.Page.container.siblings("[onboardingid="+data.newOb.ONBOARDINGID+"]");maindiv='<div class="brcumb" id="applicable">'+ZPI18N.getString("zp.leave.others.applicablefor",[""])+":";void 0===data.newOb.applicableFor&&(maindiv+="<span>"+ZPI18N.getString("zp.all")+"</span>"),$(obDiv).find("#applicable").replaceWith(maindiv+'<i class="IC-pen" onclick="ZPOnboarding.addNewOnboarding(this)"></i></div></div>'),void 0!=data.newOb.applicableFor&&ZPOnboarding.applicableForBuild(data.newOb.applicableFor)}}else if(data.msg==zpconst.CommonMessages.FAILUREMSG){var msgHead=ZPI18N.getString("zp.flowalreadyexists")+"\n",msg="<div>";$.each(data.duplicateOb,function(ind,obData){msg+=obData.DISPLAY_NAME+" -> ",msg+=ZPOnboarding.applicableForFailuremsg(obData.applicableFor),msg+="<br/>"}),msg+="</div>",setTimeout(function(){ZPeople.confirm(null,msgHead,"","",!0,!0)},500),setTimeout(function(){$("#textConfirmationPopupBody p").first().addClass("pspace")},600),setTimeout(function(){$("#textConfirmationPopupBody p").append($(msg))},600)}else if(data.hasOwnProperty("empmaillist")){var erecnoobj=[],html='<div class="row frmsettings dvConfirm"><ul class="list-group col-md-10 col-md-offset-1 MT10"><li class="list-group-item ZPbold active"><span id="associationName">'+ZPI18N.getString("zp.employees")+"</span></li>";$.each(data.empmaillist,function(index1,emp){$.each(emp,function(id,email){erecnoobj[index1]=id,html+='<li class="list-group-item"><a onclick="window.open(\'#organization/employee/view-formLinkName:employee/recordId:'+id+"','_blank')\">"+email+"</a></li>"})}),html+="</ul></div>",ZPeople.confirm(JSON.stringify(erecnoobj),ZPI18N.getString("zp.editonbflow"),html,ZPOnboarding.clearOnboarding,!1,!0,"",!0),$("#confirmationPopup").find(".modal-header").append('<p class="text-center PT8" name="subHeader">'+ZPI18N.getString("zp.onbactionerror")+'</p><p class="text-center PT8" name="subHeader">'+ZPI18N.getString("zp.confirmonbdelte")+"</p>"),$("#confirmationPopup").find("#cancelConfirmationPopup").on("click",function(){Layout.Page.hash.indexOf("onboarding")>-1&&($("#confirmationPopup").find(".modal-header").find('[name="subHeader"]').remove(),$("#confirmationPopup").find(".modal-dialog").addClass("modal-center"))}),$("#confirmationPopup").find(".modal-dialog").removeClass("modal-center")}else void 0!=data.msg&&data.msg.trim().length>0&&(setTimeout(function(){ZPeople.confirm(null,"",data.msg,"",!0,!0)},500),setTimeout(function(){$("#textConfirmationPopupBody p").first().addClass("pspace")},600),$("#textConfirmationPopupBody p").first().addClass("pspace"));else data.msg==zpconst.CommonMessages.SUCCESSMSG?(ZPOnboarding.config.data.tabDetails=JSON.parse(params.configData),ZPOnboarding.config.data.tabDetails.Checklist.tabSpecificData.checklist=JSON.parse(JSON.stringify(ZPOnboarding.Selectedchecklist)),ZPOnboarding.Selectedchecklist=[],ZPOnboarding.configdata=ZPOnboarding.config.data.tabDetails,ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatedsuccessfully"))):data.msg==zpconst.CommonMessages.FAILUREMSG&&$.each(data.errors,function(errorTab,errorObj){var tabDiv=Layout.Page.container.find("#tabData [tab-content="+errorTab+"]");Layout.Page.container.find('#configTabs [data-click="'+errorTab+'"]').addClass("err"),Layout.Page.container.find('#configTabs [data-click="'+errorTab+'"] #errorInfo').show(),Layout.Page.container.find('#configTabs [data-click="'+errorTab+'"] #errorInfo').attr("data-original-title",ZPI18N.getString("zp.fillnecessarydetails")),$.each(errorObj,function(errorKey,errorMsg){if("object"==typeof errorMsg)$.each(errorMsg,function(eInd,eObj){$.each(eObj,function(keyname,msg){errorFunction.errorSpanAttach(msg,tabDiv.find("[keyname="+keyname+"],[name="+keyname+"]").parent()[eInd])})});else if("WELCOME_FEED_TEXT"==errorKey)errorFunction.errorSpanAttach(errorMsg,tabDiv.find("[keyname="+errorKey+"],[name="+errorKey+"]").parents("[errordiv]").first());else if("DISPLAY_NAME"==errorKey)errorFunction.errorSpanAttach(errorMsg,Layout.Page.container.find("#configTabs [data-click="+errorTab+"]"));else{var errorDiv=tabDiv.find("[keyname="+errorKey+"],[name="+errorKey+"]");void 0==errorDiv.attr("errordiv")?errorFunction.errorSpanAttach(errorMsg,errorDiv.parents("[errordiv]")):errorFunction.errorSpanAttach(errorMsg,errorDiv)}})});Layout.Page.container.find("#submitDiv").show(),$(".btn-primary").removeAttr("disabled")},ZPOnboarding.addRemove=function(obj,isAdd){if(isAdd){var tr=$(obj).parents("tr").clone();$(tr).find("select").siblings().remove(),$(tr).find('[name="DISPLAY_NAME"]').val(""),$(tr).insertAfter($(obj).parents("tr")),$(tr).find("select").select2();var agreementssortdiv=Layout.Page.container.find("#docsToSign");$(agreementssortdiv).sortable({items:"tbody tr",handle:$(agreementssortdiv).find("tbody tr [name=dragIcon]")})}else $(obj).parents("tr").siblings().length>0?$(obj).parents("tr").remove():($(obj).parents("tr").find("input").val(""),$(obj).parents("tr").find("select").val("").select2())},ZPOnboarding.resetConfig=function(){ZPOnboarding.config.activeTab=Layout.Page.container.find("#configTabs li.sel").attr("data-click"),Layout.Page.container.append(ZPeople.LOADING_HTML),ZPOnboarding.configInit()},ZPOnboarding.config.previewPage=function(data){var modalPopup=Layout.Page.container.find("#previewPop");ZPOnboarding.tabsJson=ZPOnboarding.configdata,ZPOnboarding.isPreview=!0,ZPOnboarding.readOnly=!0,ZPOnboarding.onBoardingDetails={},void 0!=data&&1!=data&&(ZPOnboarding.config.hasObjTab[ZPOnboarding.currentOB.onboarding_type]=data.hasObjTab,ZPOnboarding.config.empIdDisp[ZPOnboarding.currentOB.onboarding_type]=data.empIdDisp,ZPOnboarding.currentOB.onboarding_type===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?ZPOnboarding.config.prefix=data.prefix:ZPOnboarding.onBoardingDetails.coverImageId=data.coverImageId),0==modalPopup.length?modalPopup=ZPeople.createModalPopup("previewPop",ZPI18N.getString("zp.obpreview"),"popRgtModel obPreview"):modalPopup.addClass("obPreview");var logoDiv=null==logo||"null"==logo||0==logo.trim().length?'<a class="ZPLogo DB"></a>':'<img id="zp_logo" height="24" class="ZPLogo1" src="/viewPhoto?filename='+logo+'">',previewHtml='<div class="zo_lftPnl zo_lftPnlHome" id="onBoardingLeftPane"><div class="zo_ceo">';void 0!=ZPOnboarding.configdata.Welcome.tabSpecificData.VIDEO_URL&&ZPOnboarding.configdata.Welcome.tabSpecificData.VIDEO_URL.trim().length>0?previewHtml+='<div class="zo-vdo"><div><h2></h2><iframe class="iframe" src="'+decodeURIComponent(ZPOnboarding.configdata.Welcome.tabSpecificData.VIDEO_URL)+'" height="405" frameborder="0" width="720"></iframe></div></div></div></div>':previewHtml+='<div class="zo-img"><img src="'+ZPeople.getResourceURL(newUIImageUrl+"oblgvec.png")+'" alt=""></div>',previewHtml+='<a href="javascript:;" class="zo_skip zo_dyn">SKIP >></a></div></div>';var prefix="";ZPOnboarding.contactHR=ZPeople.getUserDetailsById(ZPOnboarding.configdata.Welcome.tabSpecificData.CONTACT_HR_PERSON),ZPOnboarding.activeTab="Welcome",ZPOnboarding.currentOB.onboarding_type===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(prefix=ZPOnboarding.config.prefix,ZPOnboarding.contactHR="",ZPOnboarding.activeTab="Profile",candidateFormId=ZPOnboarding.CandidateForm.id),previewHtml+='<div class="zo_rgtPnl" id="onBoardingRightPane"><div class="zo_usrW" data-click="0"><div class="zo_usrWOuter"><div class="zo_usrWInner"><div class="zp_logo">'+logoDiv+'</div><div class="zo_usrPh"><img id="userImage" src="'+ZPeople.CURR_USER.thumb+'" alt="USER"></div><h2><span>'+ZPI18N.getString("zp.welcomeaboard")+', </span><span class="name">'+ZPeople.CURR_USER.name+'</span></h2><ul><li><span class="id">'+ZPOnboarding.config.empIdDisp[ZPOnboarding.currentOB.onboarding_type]+"</span><span>"+prefix+ZPeople.CURR_USER.empid+'</span></li><li id="li2">';var li2="";void 0!=ZPeople.CURR_USER.desiId&&""!=ZPeople.CURR_USER.desiId.trim()&&(li2=ZPeople.CURR_USER.designation),void 0!=ZPeople.CURR_USER.deptId&&""!=ZPeople.CURR_USER.deptId.trim()&&(li2+=li2.length>0?" - ":"",li2+=ZPeople.CURR_USER.deptName),previewHtml+=li2+"</li><li>"+ZPeople.CURR_USER.email+'</li><li id="li4">',void 0!=ZPeople.CURR_USER.locId&&""!=ZPeople.CURR_USER.locId&&(previewHtml+=ZPeople.CURR_USER.locName),void 0!=ZPeople.CURR_USER.workLoc&&""!=ZPeople.CURR_USER.workLoc&&(previewHtml+='<label><i class="OB-chair"><i class="path1"></i><i class="path2"></i> </i><span>'+ZPeople.CURR_USER.workLoc+"</span></label>"),previewHtml+='</li><li><span class="zo_lgs" click="1" onclick="ZPOnboarding.constructTabs()">'+ZPI18N.getString("zp.letsgetstarted")+"</span></li></ul></div></div></div></div></div>",modalPopup.find("#bodyTag").html(previewHtml),modalPopup.find('[buttonaction="dismiss"]').attr("onclick","ZPOnboarding.config.closePreview()"),modalPopup.find(".modal-footer").hide()},ZPOnboarding.config.closePreview=function(){Layout.Page.container=ZPOnboarding.configLayout;var modalPopup=Layout.Page.container.find("#previewPop");modalPopup.modal("hide"),modalPopup.remove(),Layout.Page.container.find("#submitDiv").show()},ZPOnboarding.showEdit=function(obj){"tabEdit"==$(obj).attr("name")?($(obj).siblings('[name="tabValue"]').val($(obj).siblings('[name="tabName"]').text()),$(obj).siblings('[name="tabValue"]').show(),$(obj).siblings('[name="tabValue"]').trigger("select")):($(obj).hide(),$(obj).siblings('[name="tabName"]').text($(obj).val()))},ZPOnboarding.config.constructJson=function(isPreview){Layout.Page.container.find(".err").removeClass("err"),Layout.Page.container.find("[id=errorInfo]").hide(),errorFunction.removeErrorSpan(Layout.Page.container);var configData={},error=!1,taberror=!1,tabsOrder=[];if($.each(Layout.Page.container.find("#configTabs li"),function(ind){var tabLabel=$(this).attr("data-click");tabsOrder.push(tabLabel);var tabData={tabCols:{},tabSpecificData:{}};taberror=!1,tabData.tabCols.TAB_ID=$(this).attr("id");var isvis=!0;"false"==$(this).attr("statictab")&&(isvis=$(this).find("input[type=checkbox]").is(":checked")),tabData.tabCols.IS_VISIBLE=isvis,tabData.tabCols.DISPLAY_NAME=$(this).find("[name=tabName]").html(),tabData.tabCols.SEQUENCE=ind+1;var descObj=Layout.Page.container.find("#tabData [tab-content="+tabLabel+'] [name="DESCRIPTION"]');if(tabData.tabCols.DESCRIPTION=descObj.val(),""==tabData.tabCols.DISPLAY_NAME.trim()?(error=!0,$(this).find("#errorInfo").show(),$(this).find("#errorInfo").attr("data-original-title",ZPI18N.getString("zp.tabnamenotemptyerror")),taberror=!0):"Checklist"!==tabLabel&&"Welcome"!==tabLabel&&ZPOnboarding.currentOB.onboarding_type!==ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&""==tabData.tabCols.DESCRIPTION.trim()&&(error=!0,taberror=!0,errorFunction.errorSpanAttach(ZPI18N.getString("zp.schedremindnameempty",[ZPI18N.getString("zp.description")]),descObj.parents("[errordiv]"))),isvis){var tabContent=Layout.Page.container.find("#tabData [tab-content="+tabLabel+"]"),tabSpecificData={};if("Checklist"===tabLabel){var checklistids="";$.each(tabContent.find("#checklistbody").find("tr"),function(){checklistids.trim().length>0&&(checklistids+=","),checklistids+=$(this).attr("id"),ZPOnboarding.Selectedchecklist.push({tempId:checklistids,tempName:$(this).find(".name").text(),count:$(this).find(".clcount").text()})}),tabSpecificData.checklistIds=checklistids}else if("LMS_Course"===tabLabel)if(0!=tabContent.find("#onblmscourses").find(".crdlv").length){var courses=[];$.each(tabContent.find("#onblmscourses").find(".crdlv"),function(){var coursesdtls={};coursesdtls.courseid=$(this).attr("id"),coursesdtls.isMandatory=$(this).find("[ismandatory]").attr("ismandatory"),courses.push(coursesdtls)}),tabSpecificData.courses=courses}else error=!0,taberror=!0,errorFunction.errorSpanAttach(ZPI18N.getString("zp.onbcourseerror"),$("#onblmscourses").parents("[errordiv]"));$.each(tabContent.find("[keyname]"),function(){var keyname=$(this).attr("keyname"),val="";if("WELCOME_FEED_TEXT"==keyname)val=editor.getContent();else if("forms"==keyname){var selectforms=[],mandforms=[];$.each($(this).find("[id=selectFormDiv]"),function(){var formid=$(this).find("select").val();selectforms.indexOf(formid)>=0?(errorFunction.errorSpanAttach(ZPI18N.getString("zp.formduplicate"),$(this).parents("[errordiv]").first()),error=!0,taberror=!0):void 0!=formid&&formid.trim().length>0&&(selectforms.push(formid),$(this).parent("li").next("li").find("[id=ismand]").is(":checked")&&mandforms.push(formid))}),val=selectforms,tabSpecificData.mandForms=mandforms}else null==(val=$(this).val())&&(val=$(this).is("select")&&void 0!=$(this).attr("multiple")?[]:"");var urlregex=new RegExp("^(ht|f)tp(s?)://[-.w]*(/?)([a-zA-Z0-9-.?,:'/\\+=&amp;%$#_@]*)?$");if($.inArray(keyname,["VIDEO_URL","policies"])<0&&ZPOnboarding.currentOB.onboarding_type!==ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&"forms"!=keyname&&(null==val||0==val.toString().trim().length)&&(errorFunction.errorSpanAttach(ZPI18N.getString("zp.schedremindnameempty",[$(this).attr("displayText")]),$(this).parents("[errordiv]").first()),error=!0,taberror=!0),("VIDEO_URL"!==keyname||0===val.trim().length)&&"WEB_URL"!=keyname||urlregex.test(val)||(errorFunction.errorSpanAttach(ZPI18N.getString("zp.invalidurl"),$(this).parents("[errordiv]").first()),error=!0,taberror=!0),!taberror)if("VIDEO_URL"===keyname)if(val.indexOf("youtube")>0&&val.indexOf("/embed")<0){var match=val.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);match&&11==match[2].length?(videoId=match[2],val=(0==val.indexOf("https")?"https":"http")+"://www.youtube.com/embed/"+videoId,tabSpecificData[keyname]=val):(errorFunction.errorSpanAttach(ZPI18N.getString("zp.invalidurl"),$(this).parents("[errordiv]").first()),error=!0,taberror=!0)}else tabSpecificData[keyname]=val;else tabSpecificData[keyname]=val}),Object.keys(tabSpecificData).length>0&&(tabData.tabSpecificData=tabSpecificData)}taberror?($(this).addClass("err"),$(this).find("#errorInfo").is(":hidden")&&($(this).find("#errorInfo").show(),$(this).find("#errorInfo").attr("data-original-title",ZPI18N.getString("zp.fillnecessarydetails")))):$(this).find("#errorInfo").hide(),configData[$(this).attr("data-click")]=tabData}),!error){var docTab=configData.Agreements;if(void 0!=docTab&&docTab.tabCols.IS_VISIBLE){if(Layout.Page.container.find("#docsToSign").find("tbody tr").length>0){var docsToSign=[];$.each(Layout.Page.container.find("#docsToSign").find("tbody tr"),function(){var docDtls={};if(docDtls.DISPLAY_NAME=$(this).find("[name=DISPLAY_NAME]").val(),docDtls.TEMPLATEID=$(this).find("[name=TEMPLATEID]").val(),docDtls.FORMID=$(this).find("[name=TEMPLATEID] option:selected").attr("formid"),0==$(this).find("[name=DISPLAY_NAME]").val().trim().length&&""==$(this).find("[name=TEMPLATEID]").val()&&(!$(this).find("[name=applicableRoles]").val()||0==$(this).find("[name=applicableRoles]").val().length))return!0;0==$(this).find("[name=DISPLAY_NAME]").val().trim().length&&(errorFunction.errorSpanAttach(ZPI18N.getString("zp.schedremindnameempty",[ZPI18N.getString("zp.zs.documentname")]),$(this).find("[name=DISPLAY_NAME]").parent("[errordiv]")),error=!0,taberror=!0),null!=$(this).find("[name=TEMPLATEID]").val()&&0!=$(this).find("[name=TEMPLATEID]").val().trim().length||(errorFunction.errorSpanAttach(ZPI18N.getString("zp.schedremindnameempty",[ZPI18N.getString("zp.mailmerge")]),$(this).find("[name=TEMPLATEID]").parent("[errordiv]")),error=!0,taberror=!0),$(this).find("[name=applicableRoles]").val()&&0!=$(this).find("[name=applicableRoles]").val().length&&(docDtls.applicableRoles=$(this).find("[name=applicableRoles]").val()),docDtls.AGREEMENTS_TYPE=$(this).find("[name=AGREEMENTS_TYPE]").val(),docsToSign.push(docDtls)}),configData.Agreements.tabSpecificData.docsToSign=docsToSign}(0==Object.keys(configData.Agreements.tabSpecificData).length||0==configData.Agreements.tabSpecificData.policies.length&&0==configData.Agreements.tabSpecificData.docsToSign.length)&&(errorFunction.errorSpanAttach(ZPI18N.getString("zp.agreementstabdocsempty"),Layout.Page.container.find("#tabData [tab-content=Agreements] [name=agreements]").next()),error=!0,taberror=!0),taberror?(Layout.Page.container.find('#configTabs [data-click="Agreements"]').addClass("err"),Layout.Page.container.find('#configTabs [data-click="Agreements"] #errorInfo').show(),Layout.Page.container.find('#configTabs [data-click="Agreements"] #errorInfo').attr("data-original-title",ZPI18N.getString("zp.fillnecessarydetails"))):Layout.Page.container.find('#configTabs [data-click="Agreements"] #errorInfo').hide()}if(!error){if(!isPreview)return configData;ZPOnboarding.configdata=configData,ZPOnboarding.tabsOrder=tabsOrder,void 0==ZPOnboarding.config.hasObjTab||0===ZPOnboarding.config.empIdDisp[ZPOnboarding.currentOB.onboarding_type].length?(void 0==ZPOnboarding.config.hasObjTab&&(ZPOnboarding.config.hasObjTab={1:!1,2:void 0},ZPOnboarding.config.empIdDisp={1:"",2:""}),ZPeople.Request.send("/onboarding/flow/preview",{onboarding_type:ZPOnboarding.currentFlowType},ZPOnboarding.config.previewPage)):ZPOnboarding.config.previewPage(isPreview)}}},ZPOnboarding.config.obRowCreate=function(ob){var flowurl="#onboarding/flow/employeeflow/obId-"+ob.ONBOARDINGID;ZPOnboarding.currentFlowType===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(flowurl="#onboarding/flow/candidateflow/obId-"+ob.ONBOARDINGID);var obList='<tr class="ZPLRow" obid="'+ob.ONBOARDINGID+'"><td width="30%"><a id="'+ob.ONBOARDINGID+'" href="'+flowurl+'" class="txttrim">'+ob.DISPLAY_NAME+"</a></td>";if(obList+='<td class="email">',void 0!=ob.applicableFor){obList+="<span>";var applicable="";$.each(ob.applicableFor,function(key,json){var jsonLength=Object.keys(json).length;if(0!=jsonLength){var keyName="";switch(key){case"empList":keyName=ZPI18N.getString("zp.users")+":";break;case"deptList":keyName=ZPI18N.getString("zp.departments")+":";break;case"desList":keyName=ZPI18N.getString("zp.designations")+":";break;case"roleList":keyName=ZPI18N.getString("zp.roles")+":";break;case"locList":keyName=ZPI18N.getString("zp.locations")+":"}applicable.length>0&&(applicable+="; "),applicable+=keyName;var jsonInd=1;$.each(json,function(jsonKey,jsonValue){applicable+=jsonValue,jsonInd++!=jsonLength&&(applicable+=",")})}}),obList+=applicable+"</span>"}else obList+="<span>"+ZPI18N.getString("zp.all")+"</span>";var checked=ob.IS_VISIBLE?"checked":"",params={ONBOARDINGID:ob.ONBOARDINGID},editDiv=ob.IS_SYSTEM?"":'<a class="IC-delete ML20 lnk S14" data-content="" data-placement="right" data-trigger="hover" data-toggle="tooltip" zptitle=""  data-original-title="'+ZPI18N.getString("zp.delete")+"\" onclick='ZPeople.confirm("+JSON.stringify(params)+',"","zp.deleteconfirmtitle",ZPOnboarding.deleteOnboarding)\'></a>';return obList+='</td><td width="20%"><label class="btnactive"><input id="onboardingstatus_'+ob.ONBOARDINGID+'" '+checked+' class="cmn-toggle-small cmn-toggle-round-small" type="checkbox" onclick="ZPOnboarding.changeStatus(this)"><span for="onboardingstatus_'+ob.ONBOARDINGID+'" class="M0"></span></label>',obList+='</td><td width="20%"><div class="ZPaction"><a class="btn btn-default MR20"href="'+flowurl+'"><i class="IC-setting-l MR5 S12"></i>'+ZPI18N.getString("zp.customize")+'</a><a data-original-title="'+ZPI18N.getString("zp.edit")+'" data-content="" data-placement="right" data-trigger="hover" data-toggle="tooltip" zptitle=""  class="CR-edit gry" onclick="ZPOnboarding.addNewOnboarding(this)"></a>'+editDiv+"</div></td></tr>"},ZPOnboarding.changeStatus=function(obj){ZPeople.Request.send("/onboarding/flow/enableDisable",{ONBOARDINGID:$(obj).parents("tr").attr("obid"),IS_VISIBLE:$(obj).is(":checked")},ZPOnboarding.changeStatusResponse,{obj:obj})},ZPOnboarding.changeStatusResponse=function(data,params,others){if(data.msg==zpconst.CommonMessages.SUCCESSMSG)ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatesuccessful")),ZPOnboarding.currentFlowType===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?window.location.reload():ZPOnboarding.obTemplatesList[params.ONBOARDINGID].IS_VISIBLE=params.IS_VISIBLE;else{if(void 0!=data.msg)ZPeople.confirm(null,"",data.msg,"",!0,!0);else if(data.hasOwnProperty("empmaillist")){var html='<div class="row frmsettings dvConfirm"><ul class="list-group col-md-10 col-md-offset-1 MT10"><li class="list-group-item ZPbold active"><span id="associationName">'+ZPI18N.getString("zp.employees")+"</span></li>",erecnoobj=[];$.each(data.empmaillist,function(index1,emp){$.each(emp,function(id,email){erecnoobj[index1]=id,html+='<li class="list-group-item"><a onclick="window.open(\'#organization/employee/view-formLinkName:employee/recordId:'+id+"','_blank')\">"+email+"</a></li>"})}),html+="</ul></div>",ZPeople.confirm(JSON.stringify(erecnoobj),ZPI18N.getString("zp.editonbflow"),html,ZPOnboarding.clearOnboarding,!1,!0,"",!0),$("#confirmationPopup").find(".modal-header").append('<p class="text-center PT8" name="subHeader">'+ZPI18N.getString("zp.onbactionerror")+'</p><p class="text-center PT8" name="subHeader">'+ZPI18N.getString("zp.confirmonbdelte")+"</p>"),$("#confirmationPopup").find("#cancelConfirmationPopup").on("click",function(){Layout.Page.hash.indexOf("onboarding")>-1&&($("#confirmationPopup").find(".modal-header").find('[name="subHeader"]').remove(),$("#confirmationPopup").find(".modal-dialog").addClass("modal-center"))}),$("#confirmationPopup").find(".modal-dialog").removeClass("modal-center")}params.IS_VISIBLE?$(others.obj).prop("checked",!1):$(others.obj).prop("checked",!0)}},ZPOnboarding.deleteOnboarding=function(params){ZPeople.Request.send("/onboarding/flow/delete",params,ZPOnboarding.deleteSuccess)},ZPOnboarding.deleteSuccess=function(data,params){if(data.msg==zpconst.CommonMessages.SUCCESSMSG)delete ZPOnboarding.obTemplatesList[params.ONBOARDINGID],Layout.Page.container.find("#listBody tr[obid="+params.ONBOARDINGID+"]").remove();else if(data.hasOwnProperty("empmaillist")){var html='<div class="row frmsettings dvConfirm"><ul class="list-group col-md-10 col-md-offset-1 MT10"><li class="list-group-item ZPbold active"><span id="associationName">'+ZPI18N.getString("zp.employees")+"</span></li>",erecnoobj=[];$.each(data.empmaillist,function(index1,emp){$.each(emp,function(id,email){html+='<li class="list-group-item"><a onclick="window.open(\'#organization/employee/view-formLinkName:employee/recordId:'+id+"','_blank')\">"+email+"</a></li>",erecnoobj[index1]=id})}),html+="</ul></div>",setTimeout(function(){ZPeople.confirm(JSON.stringify(erecnoobj),ZPI18N.getString("zp.deleteonbflow"),html,ZPOnboarding.clearOnboarding,!1,!0,"",!0),$("#confirmationPopup").find(".modal-header").append('<p class="text-center PT8" name="subHeader">'+ZPI18N.getString("zp.onbactionerror")+'</p><p class="text-center PT8" name="subHeader">'+ZPI18N.getString("zp.confirmonbdelte")+"</p>"),$("#confirmationPopup").find("#cancelConfirmationPopup").on("click",function(){Layout.Page.hash.indexOf("onboarding")>-1&&($("#confirmationPopup").find(".modal-header").find('[name="subHeader"]').remove(),$("#confirmationPopup").find(".modal-dialog").addClass("modal-center"))}),$("#confirmationPopup").find(".modal-dialog").removeClass("modal-center")},500)}else void 0!=data.msg&&setTimeout(function(){ZPeople.confirm(null,"",data.msg,"",!0,!0)},500)},ZPOnboarding.applicableForBuild=function(ob){var totalApplicable="<div>"+ZPI18N.getString("zp.leave.others.applicablefor",[""])+":<span></span></div>",list={desList:"<div class='P10'>",roleList:"<div class='P10'>",locList:"<div class='P10'>"};$.each(ob,function(key,json){if(0!=Object.keys(json).length){var keyName="";switch(key){case"desList":keyName=ZPI18N.getString("zp.designations");break;case"roleList":keyName=ZPI18N.getString("zp.roles");break;case"locList":keyName=ZPI18N.getString("zp.locations")}totalApplicable+="<div>"+keyName+":<span>";var count=0,popup="";$.each(json,function(jsonKey,jsonValue){count<2?(count>0&&(totalApplicable+=","),totalApplicable+=jsonValue):list[key]+="<p>"+jsonValue+"</p>",count++}),count>2&&(popup='<span data-toggle="popover" class="'+key+' IC-more" html="true" data-placement="bottom" data-original-title="" title=""></span>'),totalApplicable+="</span>"+popup+"</div>"}}),Layout.Page.container.find("#applicable").html(totalApplicable),$.each(ob,function(key,json){0!=Object.keys(json).length&&$("."+key).popover({html:!0,content:function(){return list[key]+"</div>"}})})},ZPOnboarding.applicableForFailuremsg=function(ob){var totalApplicable="";return $.each(ob,function(key,json){if(0!=Object.keys(json).length){var keyName="";switch(key){case"desList":keyName=ZPI18N.getString("zp.designations");break;case"roleList":keyName=ZPI18N.getString("zp.roles");break;case"locList":keyName=ZPI18N.getString("zp.locations")}totalApplicable+="<b>"+keyName+":</b><span>";var count=0;$.each(json,function(jsonKey,jsonValue){count>0&&(totalApplicable+=","),totalApplicable+=jsonValue,count++}),totalApplicable+="</span>"}}),totalApplicable},ZPOnboarding.showhideTemplateList=function(obj){$(obj).hasClass("sel")?$(obj).removeClass("sel"):0==$(obj).find("#obList").children().length?($(obj).find("#obList").html(ZPeople.LOADING_HTML),$(obj).addClass("sel"),ZPeople.Request.send("/onboarding/flow/list",{onboarding_type:ZPOnboarding.currentFlowType},ZPOnboarding.templateListConstruct)):$(obj).addClass("sel")},ZPOnboarding.templateListConstruct=function(data){var listData="",flowurl=ZPOnboarding.currentFlowType==ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?"candidateflow":"employeeflow";$.each(data,function(ind,ob){listData+='<li><a href="#onboarding/flow/'+flowurl+"/obId-"+ob.ONBOARDINGID+'">'+ob.DISPLAY_NAME+"</a></li>"}),Layout.Page.container.find("#obList").html(listData)},ZPOnboarding.Feeds.likeActivityResponse=function(isActivity,Obj){var recordId,id;isActivity?(recordId=Obj.parents("div[streamid]").attr("streamid"),container=$.find("div[streamid='"+recordId+"']"),containerId="liked_usrs"):(recordId=Obj.parents("div[commentid]").attr("commentid"),container=$.find("div[commentid='"+recordId+"']"),containerId="commentLiked_usrs"),id=Obj.attr("id");var likeCont=$(container).find("#"+containerId);likeCont.find("[count]").length>0?(cnt=parseInt(likeCont.find("[count]").attr("count")),countCont=likeCont.find("[count]")):(cnt=0,likeCont=$('<div data-toggle="tooltip" data-original-title="<div id=\'likers\' class=\'liked-list\'></div>" data-placement="top" data-html="true" data-container="body" id="'+containerId+'" class="dgry FR S12" ><i class="" count='+cnt+"></i></div></div"),countCont=likeCont.find("[count]"));var cnt=likeCont.find("[count]").length>0?parseInt(likeCont.find("[count]").attr("count")):0,titleData=$("<div>"+likeCont.attr("data-original-title")+"</div>");if(1==$(Obj).attr("action"))Obj.attr("action","0").removeClass("red-color"),titleData.find("span[empid="+erecno+"]").remove(),--cnt;else{Obj.attr("action","1").addClass("red-color");var empData='<span empid="'+erecno+'">'+ZPI18N.getString("zp.you")+"</span>";titleData.find("#likers").prepend(empData),11==++cnt&&(titleData.find("#likers").last("span").remove(),titleData.find("#likers").append('<span morecount="1">& 1 '+ZPI18N.getString("zp.smore")+"</span>"))}likeCont.find("[count]").attr("count",cnt),likeCont.find("[count]").html(cnt),likeCont.attr("data-original-title",titleData.html()),0==$(container).find("#"+containerId).length?likeCont.insertAfter($(container).find("#"+id)):0==cnt&&$(container).find("#"+containerId).remove()},ZPOnboarding.Feeds.showMoreComments=function(fdk,commentarr,totalCnt,cmore){var currCont=$("#onBoardingRightPane:visible"),escapedFDK=ZPUtil.escapeSelector(fdk);currCont.find("div[actFdk='"+escapedFDK+"']").parents("#actOuterCont")},ZPOnboarding.reportsInit=function(resultData){var type=window.location.href.split("/").pop();Layout.Page.container.html(),ZPOnboarding.isCandReportPage="#onboarding/reports/candidate"===Layout.Page.hash,0===Layout.Page.container.find("#steb01").length?void 0!==resultData?(Layout.Page.container.addClass("ob"),Layout.Page.container.html(resultData),ZPOnboarding.reportData()):ZPeople.Request.send("/onboardingReport.zp",{reportType:type},ZPOnboarding.reportsInit):ZPOnboarding.reloadData()},ZPOnboarding.currentReportType=function(obj){return"employee"==window.location.href.split("/").pop()?"P_Employee":"P_Candidate"},ZPOnboarding.changeFilterValue=function(obj){var id=$(obj).val();Layout.Page.container.find("#filterValue").children().not("label,[id*="+id+"]").hide(),Layout.Page.container.find("#filterValue").find("[id*="+id+"]").show(),void 0==ZPOnboarding.filter[id]&&$.inArray(id,["ONBOARDING_STATUS","DATEOFJOINING"])<0&&ZPeople.Request.send("/obReportActions.zp",{parmode:"reportFilterValues",filterName:id},ZPOnboarding.constructFilterValues)},ZPOnboarding.showHideFilters=function(){obj=Layout.Page.container.find("#show_hide_obfilter"),$(obj).hasClass("ZPFilsel")?($(obj).removeClass("ZPFilsel"),$(obj).addClass("ZPFiler"),Layout.Page.container.find("#ob_filter").removeClass("TEbnd"),$("#page-wrapper").addClass("Nbar2").removeClass("Nbar2F")):($(obj).removeClass("ZPFiler"),$(obj).addClass("ZPFilsel"),Layout.Page.container.find("#ob_filter").addClass("TEbnd"),$("#page-wrapper").addClass("Nbar2F").removeClass("Nbar2"))},ZPOnboarding.reportData=function(data){var searchJson={};Layout.Page.container.find(".ZPPsearch").remove(),Layout.Page.container.find(".ZPNdata").remove(),Layout.Page.container.find("#zp_page_loading").remove(),Layout.Page.container.find("#aplFltr").attr("disabled","disabled"),Layout.Page.container.find(".Scrcont").find(".obRepBox").addClass("DN"),Layout.Page.container.find(".table-body").html(""),Layout.Page.container.find(".Scrcont").append(ZPeople.LOADING_HTML);var params={reportType:ZPOnboarding.currentReportType()};Layout.Page.container.find(".FL").removeClass("sel"),ZPOnboarding.reportId?(ZPOnboarding.isCandReportPage?searchJson.CANDIDATEID=ZPOnboarding.reportId:searchJson.ERECNO=ZPOnboarding.reportId,ZPOnboarding.initiateFilter(!0)):(Layout.Page.container.find("#filterOption").find("input[id*=_input]").each(function(){var filterVal=$(this).val(),filterName=$(this).attr("id").split("_input")[0];ZPOnboarding.isCandReportPage&&(filterName=filterName.split("_CAND")[0]),"DATEOFJOINING"===filterName?""!=filterVal.trim()&&(searchJson[filterName]=filterVal):"EMPLOYEE_NAME"===filterName||"CANDIDATE_NAME"===filterName?""!=filterVal.trim()&&(searchJson[filterName]=filterVal):CommonTemplates.toCheckEmpty($(this).attr("id"),searchJson,filterName)}),0==Object.keys(searchJson).length||"object"==typeof data?(ZPOnboarding.isCandReportPage?ZPOnboarding.isFilterEmptyforcand=!0:ZPOnboarding.isFilterEmptyforemp=!0,searchJson.ONBOARDING_STATUS=ZPOnboarding.statusConstants.ONBOARDING_STARTED+","+ZPOnboarding.statusConstants.USER_COMPLETE+","+ZPOnboarding.statusConstants.ONBOARDING_REOPEN,"object"!=typeof data?(Layout.Page.container.find("#emp_ongoing_onboarding").addClass("sel"),ZPOnboarding.selectedHeader="emp_ongoing_onboarding"):($(data).addClass("sel"),searchJson.ONBOARDING_STATUS=$(data).attr("data-value"),ZPOnboarding.selectedHeader=$(data).attr("id"),searchJson.DATEOFJOINING=void 0),Layout.Page.container.find("#"+ZPOnboarding.selectedHeader).attr("onclick",""),ZPOnboarding.setDefaultFilter()):(ZPOnboarding.isCandReportPage?ZPOnboarding.isFilterEmptyforcand=!1:ZPOnboarding.isFilterEmptyforemp=!1,void 0!=searchJson.ONBOARDING_STATUS&&searchJson.ONBOARDING_STATUS.includes(ZPOnboarding.statusConstants.ONBOARDING_NOT_TRIGGERED)&&(searchJson.ONBOARDING_STATUS+=","+ZPOnboarding.statusConstants.TRIGGERED_ONBOARDING),Layout.Page.container.find(".FL").removeClass("sel"))),params.searchJson=JSON.stringify(searchJson),ZPOnboarding.reportId||(ZPeople.FireScroll.setParam("searchJson",JSON.stringify(searchJson)),ZPeople.FireScroll.setRecordCount(0),ZPeople.FireScroll.reset()),Layout.Page.parentContainer.find("[scroll=enabled]").off("scroll"),ZPeople.Request.send("/onboarding/reports/list",params,ZPOnboarding.reportDataConstruct,void 0,ZPOnboarding.serverError)},ZPOnboarding.reportListFireScroll=function(){var obj=ZPeople.FireScroll.getFireScrollPropertie(),params={start:obj.count+1,reportType:ZPOnboarding.currentReportType()};Layout.Page.container.find(".table-body").append('<tr class="loading"><td colspan="8"">'+ZPeople.LOADING_HTML+"</td></tr>"),params.searchJson=obj.searchJson,ZPeople.Request.send("/onboarding/reports/list",params,ZPOnboarding.reportDataConstruct)},ZPOnboarding.reportDataConstruct=function(data,params){if(Layout.Page.container.find("#aplFltr").prop("disabled",!1),Layout.Page.container.find(".Scrcont").removeAttr("style"),void 0!=data)if(Layout.Page.container.find(".Scrcont").find(".obRepBox").removeClass("DN"),Layout.Page.container.find("#zp_page_loading").remove(),Layout.Page.container.find(".ZPNdata").remove(),Layout.Page.container.find(".table-body").find(".loading").remove(),void 0!=data.reportcount&&ZPOnboarding.updateheader(data),ZPOnboarding.isCandReportPage&&(void 0!=data.empPhotoFC&&(ZPPreboarding.empPhotoFC=data.empPhotoFC),data.candidateFormId&&(ZPPreboarding.candidateFormId=data.candidateFormId)),void 0!=data.filterData){if(ZPeople.FireScroll.getFireScrollPropertie().triggered||(ZPOnboarding.isMassCheck=!1,Layout.Page.container.find(".table-body").html("")),50==data.filterData.length&&(ZPeople.FireScroll.reset(),ZPeople.FireScroll.increaseRecordCount(data.filterData.length),void 0==params.start&&ZPeople.FireScroll.init(ZPOnboarding.reportListFireScroll)),ZPOnboarding.reportId){var html1='<div class="zp_Tglst" id="headtag"><div class="zp_Tg" id="externalonburl">'+data.filterData[0].EMAILALIAS+'<i class="IC-cls-1px" id="externalonburl"></i></div><span class="zp_link" name="clear">Clear</span></div>';Layout.Page.container.find(".ZPPhed").addClass("zp_sfltr"),Layout.Page.container.find(".ZPPhed").append(html1),ZPOnboarding.viewOnboardingDetails(ZPOnboarding.reportId),ZPOnboarding.reportId=void 0,Layout.Page.container.find("#headtag").find("i#externalonburl, .zp_link").off("click").on("click",function(){Layout.Page.container.find("#headtag").remove(),Layout.Page.container.find(".ZPPhed").removeClass("zp_sfltr"),ZPOnboarding.reportData()})}html="",$.each(data.filterData,function(rowInd,reportData){var checkbox,statusClass="pend",percent="",ratioText="";if(checkbox='<td class="cb"></td>',reportData.ONBOARDING_STATUS!=ZPOnboarding.statusConstants.ONBOARDING_STARTED&&reportData.ONBOARDING_STATUS!=ZPOnboarding.statusConstants.USER_COMPLETE&&reportData.ONBOARDING_STATUS!=ZPOnboarding.statusConstants.ONBOARDING_REOPEN||(ZPOnboarding.isMassCheck=!0,checkbox='<td class="cb"><div class="checkbox checkbox-primary DI"><input type="checkbox" onchange="ZPOnboarding.completebulkonbcheckbox(this)" name="onbcmprow"><label></label></div></td>'),'<td class="trigger"></td>',ZPOnboarding.totalTabs=reportData.TOTALTABS,ZPOnboarding.completeTabs=reportData.COMPLETETABS,-1==ZPOnboarding.completeTabs&&(ZPOnboarding.completeTabs+=1,reportData.COMPLETETABS+=1),ZPOnboarding.singleTabAngle=Math.round(360/ZPOnboarding.totalTabs),ZPI18N.getString("zp.local.NotCompleted"),reportData.ONBOARDING_STATUS==ZPOnboarding.statusConstants.ONBOARDING_COMPLETED)ZPI18N.getString("zp.completed"),statusClass="comp",percent="100";else{percent=Math.round(100*ZPOnboarding.completeTabs/ZPOnboarding.totalTabs);var totaltabs=-1!==ZPOnboarding.totalTabs?ZPOnboarding.totalTabs:0;ratioText='<span class="count">'+ZPOnboarding.completeTabs+"</span> /"+totaltabs}var role="-";void 0!=reportData.ROLENAME&&(role=reportData.ROLENAME);var viewPhoto=ZPeople.getResourceURL(imageUrl+"user.png"),onclickrecord="";if(ZPOnboarding.isCandReportPage){if(reportData.isphotopresent){var downloadParams={fcId:ZPPreboarding.empPhotoFC,recordId:reportData.PKID,formId:ZPPreboarding.candidateFormId,original:"false"};viewPhoto=ZPForm.constructDownloadLink(downloadParams)}onclickrecord='User.getRecordPage("'+ZPPreboarding.candidateFormId+'","'+reportData.PKID+'","VIEW")'}else viewPhoto=reportData.PHOTO,onclickrecord='User.getRecordPage("'+ZPeople.EMP_FORMID+'","'+reportData.PKID+'","VIEW")';html+='<tr class="ZPLRow" id="'+reportData.PKID+'">'+checkbox+'<td class="name" onclick=><div class="obRepImg" onclick='+onclickrecord+'><img class="FL" src="'+viewPhoto+'"> <span>'+reportData.USERNAME+"</span></div>","P_Employee"==ZPOnboarding.currentReportType()&&(html+="<td>"+reportData.DATEOFJOINING+'</td><td class="role"><span>'+role+"</span></td>"),html+="<td onclick=\"ZPOnboarding.viewOnboardingDetails('"+reportData.PKID+"')\">";var completestatus="";completestatus=reportData.ONBOARDING_STATUS==ZPOnboarding.statusConstants.USER_COMPLETE?"<span>"+ZPI18N.getString("zp.usercompleteonboarding")+"</span>":reportData.ONBOARDING_STATUS==ZPOnboarding.statusConstants.ONBOARDING_REOPEN?"<span>"+ZPI18N.getString("zp.reopenonboarding")+"</span>":ratioText+"<span>"+ZPI18N.getString("zp.completed")+"</span>",html+='<div class="ZPstatus '+statusClass+'"><div>'+completestatus+'</div><div class="ZPprobar progress"><div class="progress-bar ZPprogrs PR" style="width:'+percent+'%"></div></div></div>',html+='</td><td class="trigger"></td>',void 0==ZPOnboarding.allReport[reportData.PKID]&&(ZPOnboarding.allReport[reportData.PKID]={}),ZPOnboarding.allReport[reportData.PKID].reportDetails=reportData}),Layout.Page.container.find(".table-body").append(html),Layout.Page.container.find(".Scrcont").find(".obRepBox").removeClass("DN"),1==ZPOnboarding.isMassCheck?Layout.Page.container.find(".table-header").find(".cb").html('<div class="checkbox"><input type="checkbox" id="masscheckbox" onchange="ZPOnboarding.completebulkonbcheckbox(this);"><label></label></div>'):Layout.Page.container.find(".table-header").find(".checkbox").remove()}else if(!ZPeople.FireScroll.getFireScrollPropertie().triggered){Layout.Page.container.find(".Scrcont").find(".obRepBox").addClass("DN");var noDataCont=ZPUtil.newNoDataHTML("",void 0,ZPI18N.getString("zp.norec"));$(noDataCont).insertAfter(Layout.Page.container.find(".Scrcont").find(".obRepBox")),ZPOnboarding.reportId=void 0}},ZPOnboarding.reportFilterReset=function(){var defaultFilter=Layout.Page.container.find("#filterName option").first().val();Layout.Page.container.find("#filterName").val(defaultFilter).trigger("change")},ZPOnboarding.reportPercentage=function(html){var angle=0;angle=ZPOnboarding.totalTabs==Object.keys(ZPOnboarding.completeTabs).length?360:ZPOnboarding.completeTabs*ZPOnboarding.singleTabAngle,Layout.Page.container.find("#leftCircle").css({"-webkit-transform":"rotate("+angle+"deg)",transform:"rotate("+angle+"deg)"}),angle>180&&(Layout.Page.container.find("#pie").css("clip","rect(auto, auto, auto, auto)"),Layout.Page.container.find("#rightCircle").css({"-webkit-transform":"rotate(180deg)",transform:"rotate(180deg)"}))},ZPOnboarding.getIncompleteTabs=function(obj){var empErecno=$(obj).parents("tr").attr("id");if($(obj).parents("tr").next("tr#sub"+empErecno).length>0)$(obj).parents("tr").next("tr#sub"+empErecno).toggleClass("DN");else{var params={erecno:empErecno,parmode:"empTabDetails"};ZPeople.Request.send("/onboarding/reports/tabDetails",params,ZPOnboarding.constructSubTR)}},ZPOnboarding.constructSubTR=function(data,params){if(void 0!=data&&(void 0!=data.tabDetails.Agreements.tabSpecificData&&void 0!=data.tabDetails.Agreements.tabSpecificData.docsToSign||void 0!=data.empFiles)){var docsToSign=void 0!=data.empFiles?data.empFiles:data.tabDetails.Agreements.tabSpecificData.docsToSign,html=$('<tr class="ZPLRow" id="sub'+params.erecno+'"><td class="MW150">Agreements to Accept</td></tr>');$.each(docsToSign,function(docInd,docDetails){if(docDetails.IS_ACCEPTED){var data={filePath:docDetails.PATH,fileID:docDetails.HR_FILES_ID},td=$('<td ><a href="javascript:" class="FL MT5">'+docDetails.DISPLAY_NAME+"</a></td>");$(html).append(td),$(td).on("click",function(){Layout.Page.pageContWrapper.parent().prepend(Files.constructPreview(data.fileID,"Feeds")),Files.viewFile(data,"feed")}),!0}}),$(html).insertAfter(Layout.Page.container.find("tr#"+params.erecno))}},ZPOnboarding.updateheader=function(data){var reportcount=data.reportcount,onclick="";0!==Layout.Page.container.find(".ZPPhed").find("#headtag").find(".zp_Tg").length||ZPOnboarding.reportId||(onclick="ZPOnboarding.reportData(this)"),Layout.Page.container.find(".well.ZPPhed").find("#onboarding_completed").find("b").html(reportcount.noofempcomponboarding),Layout.Page.container.find(".well.ZPPhed").find("#emp_ongoing_onboarding").find("b").html(reportcount.noofempongoingonboarding),Layout.Page.container.find(".well.ZPPhed").find("#yet_to_onboarding").find("b").html(reportcount.noofempyettoonboarding),Layout.Page.container.find(".well.ZPPhed").find(".onclickreq").attr("onclick",onclick)},ZPOnboarding.initiateFilter=function(isnoshowfilter){Layout.Page.container.find("#filterOption").find(".zp_lnk").length<=0?(Layout.Page.container.find(".zp_content").append('<div id="filterLoading" class="zp_fltrs">'+ZPeople.LOADING_HTML+"</div>"),ZPOnboarding.isCandReportPage?(ZPOnboarding.isFilterInitiatedforcand=!0,ZPOnboarding.updatecandFilter()):(ZPOnboarding.isFilterInitiatedforemp=!0,ZPeople.Request.sendAsyncPost("/onboarding/reports/getFilterComponents",{},ZPOnboarding.updateempFilter)),isnoshowfilter||AdvancedFilter.showHidefilter()):isnoshowfilter||AdvancedFilter.showHidefilter(),!ZPOnboarding.reportId&&0==Layout.Page.container.find("#externalonburl").length&&(ZPOnboarding.isCandReportPage&&ZPOnboarding.isFilterEmptyforcand||!ZPOnboarding.isCandReportPage&&ZPOnboarding.isFilterEmptyforemp)&&ZPOnboarding.setDefaultFilter()},ZPOnboarding.updateempFilter=function(data){if(void 0!=data){var filterArr=[];filterArr.push({parentDiv:"EMPLOYEE_NAME",type:"search",title:ZPI18N.getString("zp.employeename")}),filterArr.push({parentDiv:"ONBOARDING_STATUS",type:"select",title:ZPI18N.getString("zp.onboardingstatus"),menuProperties:{data:[{id:ZPOnboarding.statusConstants.ONBOARDING_STARTED,value:ZPI18N.getString("zp.ongoingonboarding")},{id:ZPOnboarding.statusConstants.ONBOARDING_COMPLETED,value:ZPI18N.getString("zp.componboarding")}],checkbox:!0,id:"onboardingfilter"}}),Layout.Page.container.find("#list_header #DOJ").text(data.filterNames.DATEOFJOINING),$.each(data.filterNames,function(filterKey,filterVal){if("DATEOFJOINING"==filterKey)filterArr.push({parentDiv:"DATEOFJOINING",type:"date",title:filterVal,dfmt:dateFmt});else{var menuProperties=[];Object.keys(data[filterKey]).length>0&&($.each(data[filterKey].filterValues,function(ind,filterJson){menuProperties.push({id:filterJson.PKID,value:filterJson.DISPLAYNAME})}),filterArr.push({parentDiv:filterKey,type:"select",title:filterVal,menuProperties:{id:"onboardingfilter",data:menuProperties,checkbox:!0}}),ZPOnboarding.filter[filterKey]=data[filterKey].filterValues)}}),AdvancedFilter.constructFilter(filterArr,ZPOnboarding.reportData),Layout.Page.container.find("#filterLoading").remove()}},ZPOnboarding.updatecandFilter=function(data){var filterArr=[];filterArr.push({parentDiv:"CANDIDATE_NAME_CAND",type:"search",title:ZPI18N.getString("zp.employeename")});var statusjson=[{id:ZPOnboarding.statusConstants.ONBOARDING_STARTED,value:ZPI18N.getString("zp.ongoingonboarding")},{id:ZPOnboarding.statusConstants.ONBOARDING_COMPLETED,value:ZPI18N.getString("zp.componboarding")}];obautocomplete||(statusjson.push({id:ZPOnboarding.statusConstants.USER_COMPLETE,value:ZPI18N.getString("zp.usercompleteonboarding")}),statusjson.push({id:ZPOnboarding.statusConstants.ONBOARDING_REOPEN,value:ZPI18N.getString("zp.reopenonboarding")})),filterArr.push({parentDiv:"ONBOARDING_STATUS_CAND",type:"select",title:ZPI18N.getString("zp.onboardingstatus"),menuProperties:{data:statusjson,checkbox:!0,id:"onboardingfilter"}}),AdvancedFilter.constructFilter(filterArr,ZPOnboarding.reportData),Layout.Page.container.find("#filterLoading").remove()},ZPOnboarding.viewOnboardingDetails=function(data,params){if(void 0==params){$("#userOnboardingDetails").remove();var tabModal=ZPeople.createModalPopup("userOnboardingDetails","","popRgtModel obReportsModal");$(tabModal).find(".modal-footer").addClass("zp_dyn"),$(tabModal).find(".modal-header").find(".FL.MT20").remove(),$(tabModal).find(".modal-header").find(".modal-title").remove(),$(tabModal).find(".modal-body").html(ZPeople.LOADING_HTML),void 0==ZPOnboarding.allReport[data]&&(ZPOnboarding.allReport[data]={});params={pkid:data,parmode:"empTabDetails",reportType:ZPOnboarding.currentReportType()};ZPeople.Request.send("/onboarding/reports/tabDetails",params,ZPOnboarding.viewOnboardingDetails)}else if("object"==typeof data&&(ZPOnboarding.allReport[params.pkid].completeDetails=data,ZPOnboarding.currentUserData=data,void 0!=data.tabsOrder)){var completedcount=0;$.each(data.tabsOrder,function(tabInd,tabLabel){data.tabDetails[tabLabel].tabCols.IS_COMPLETED&&completedcount++}),completedcount!==ZPOnboarding.allReport[params.pkid].reportDetails.COMPLETETABS&&(ZPOnboarding.allReport[params.pkid].reportDetails.COMPLETETABS=completedcount,ZPOnboarding.reloadData()),ZPOnboarding.constructtabDetails(params.pkid)}},ZPOnboarding.constructtabDetails=function(pkid){var userDetails=ZPOnboarding.allReport[pkid].completeDetails,reportDetails=ZPOnboarding.allReport[pkid].reportDetails,completedtabs=reportDetails.COMPLETETABS,desig="";void 0!=reportDetails.DESIGNATIONNAME&&(desig=reportDetails.DESIGNATIONNAME),-1==completedtabs&&(completedtabs+=1);var percent=Math.round(100*completedtabs/reportDetails.TOTALTABS);$("#userOnboardingDetails:visible").find("#createNewBP").remove();var viewUrl=ZPeople.getResourceURL(imageUrl+"user.png");if(ZPOnboarding.isCandReportPage&&reportDetails.isphotopresent){var downloadParams={fcId:userDetails.empPhotoFC,recordId:pkid,formId:userDetails.candidateFormId,original:"false"};viewUrl=ZPForm.constructDownloadLink(downloadParams)}else ZPOnboarding.isCandReportPage||(viewUrl=reportDetails.PHOTO);var cmponb="";reportDetails.ONBOARDING_STATUS!==ZPOnboarding.statusConstants.ONBOARDING_COMPLETED&&(cmponb='<div class="zp_btn"><button class="zpthm" buttonname="completeOnboarding" onclick="ZPOnboarding.completeOnboarding(\''+pkid+"')\">"+ZPI18N.getString("zp.lms.content.Markascompleted")+"</button>",reportDetails.ONBOARDING_STATUS===ZPOnboarding.statusConstants.USER_COMPLETE&&(cmponb+='<button buttonname="reopenOnboarding" onclick="ZPOnboarding.reopenOnboarding(\''+pkid+"')\">Reopen</button>"),cmponb+="</div>");var html='<div id="createNewBP"><div class="modal-header"><a class="close IC-cls" data-dismiss="modal" id="obReportCls"></a>'+cmponb+'<div class="FL MT20"><img src="'+viewUrl+'" class="FL MR20" style="border-radius: 50%;"><div class="FL"><b class="DB MB10 MT5">'+reportDetails.USERNAME+'</b><b class="DB MB10 MT5">'+reportDetails.EMAILALIAS+'</b><span class="dgry">'+desig+'</span></div></div></div><div class="modal-body"><div class="obReportsModalList">';if(void 0!=userDetails.tabsOrder){if(html+='<div><span class="FL">'+ZPI18N.getString("zp.onboardingtasks")+"</span>",reportDetails.ONBOARDING_STATUS==ZPOnboarding.statusConstants.ONBOARDING_COMPLETED)html+='<div class="FR ZPstatus comp"><span>'+ZPI18N.getString("zp.completed")+'</span><div class="ZPprobar progress"><div class="progress-bar ZPprogrs PR" style="width: 100%"></div></div></div><ul>';else{var totaltabs=-1!=reportDetails.TOTALTABS?reportDetails.TOTALTABS:0;html+='<div class="FR ZPstatus pend"><span class="clr">'+completedtabs+"</span> /"+totaltabs+"<em>"+ZPI18N.getString("zp.completed")+'</em><div class="ZPprobar progress"><div class="progress-bar ZPprogrs PR" style="width: '+percent+'%"></div></div></div><ul>'}$.each(userDetails.tabsOrder,function(tabInd,tabLabel){var tabDetails=userDetails.tabDetails[tabLabel];tabDetails.tabCols.IS_COMPLETED?html+='<li><i class="IC-tick-1px"></i><div>'+ZPeople.decodeTxt(tabDetails.tabCols.DISPLAY_NAME)+'<span class="FR"></span></div></li>':html+='<li><i class="IC-pending"></i><div>'+ZPeople.decodeTxt(tabDetails.tabCols.DISPLAY_NAME)+'<span class="FR"></span></div></li>'}),html+="</ul></div></div></div></div>"}$("#userOnboardingDetails:visible").find(".modal-content").html(html),void 0!=userDetails.empFiles?(html='<div><span class="FL">'+ZPI18N.getString("zp.onboardingdocuments")+"</span><ul>",$.each(userDetails.empFiles,function(fileInd,fileDetails){var data={filePath:fileDetails.filePath,fileID:fileDetails.fileID},div="<li filedata='"+JSON.stringify(data)+'\'><div><a href="javascript:">'+fileDetails.fileName+"</a></div></li>";html+=div,div=$(div),$(div).on("click",function(){Layout.Page.pageContWrapper.parent().prepend(Files.constructPreview(fileDetails.fileID,"Feeds")),Files.viewFile(data,"feed")})}),html+="</div>",$("#userOnboardingDetails:visible").find(".obReportsModalList").append(html)):void 0!=userDetails.tabDetails.Agreements&&(void 0!=userDetails.tabDetails.Agreements.tabSpecificData.docsToSign&&(html='<div><span class="FL">'+ZPI18N.getString("zp.onboardingdocuments")+"</span><ul>",$.each(userDetails.tabDetails.Agreements.tabSpecificData.docsToSign,function(ind,docDetails){if(void 0!=docDetails.HR_FILES_ID){var data={filePath:docDetails.PATH,fileID:docDetails.HR_FILES_ID,fileName:docDetails.DISPLAY_NAME,fileType:docDetails.fileType,fileConfident:docDetails.isConfidential},isAccepted=docDetails.IS_ACCEPTED?ZPI18N.getString("zp.accepted"):ZPI18N.getString("zp.declined");if(docDetails.IS_ACCEPTED)var div="<li filedata='"+JSON.stringify(data)+'\'><div><a href="javascript:">'+docDetails.DISPLAY_NAME+'</a><span class="FR accept">'+isAccepted+"</span></div></li>";else if("null"==data.fileID)div="<li><div>"+docDetails.DISPLAY_NAME+'<span class="FR reject">'+ZPI18N.getString("zp.yettobegenerated")+"</span></div></li>";else if(0==docDetails.IS_ACCEPTED)div="<li filedata='"+JSON.stringify(data)+'\'><div><a  href="javascript:">'+docDetails.DISPLAY_NAME+'</a><span class="FR reject">'+isAccepted+"</span></div></li>";else div="<li filedata='"+JSON.stringify(data)+'\'><div><a  href="javascript:">'+docDetails.DISPLAY_NAME+'</a><span class="FR reject">'+ZPI18N.getString("zp.generated")+"</span></div></li>";html+=div,div=$(div)}}),html+="</div>",$("#userOnboardingDetails:visible").find(".obReportsModalList").append(html)),void 0!=userDetails.tabDetails.Agreements.tabSpecificData.policies&&(html='<div><span class="FL">'+ZPI18N.getString("zp.formcompanypolicy")+"</span><ul>",$.each(userDetails.tabDetails.Agreements.tabSpecificData.policies,function(ind,docDetails){if(void 0!=docDetails.FILEID){(1==docDetails.UPLOADSOURCE||decodeHTML(docDetails.FILEPATH).indexOf(workDriveUrl)>-1||decodeHTML(docDetails.FILEPATH).indexOf(writerUrl)>-1||decodeHTML(docDetails.FILEPATH).indexOf(sheetUrl)>-1||decodeHTML(docDetails.FILEPATH).indexOf(showUrl)>-1)&&!0;var data={fileID:docDetails.FILEID,fileName:docDetails.FILENAME,fileType:docDetails.fileType,fileConfident:docDetails.isConfidential,fileExtn:docDetails.EXTENSION};data.filePath=docDetails.FILEPATH,data.uploadSource=docDetails.UPLOADSOURCE;var id=docDetails.FILEID,ackspan="",ackclass="ack_pndng",crackclass="CR-ack-pending";docDetails.ACKNOWLEDGE&&(void 0!=docDetails.hasloginuserack&&docDetails.hasloginuserack&&(ackclass="ack_actv",crackclass="CR-ack-success"),ackspan='<span class="FR W60 ZPack '+ackclass+'"><i class="'+crackclass+'"></i></span>');var div="<li filedata='"+JSON.stringify(data)+"'><div id="+id+'><a href="javascript:">'+docDetails.FILENAME+"</a>"+ackspan+"</div></li>";html+=div,div=$(div)}}),html+="</div>",$("#userOnboardingDetails:visible").find(".obReportsModalList").append(html))),(void 0!=userDetails.tabDetails.Forms&&void 0!=userDetails.tabDetails.Forms.tabSpecificData.forms||void 0!=userDetails.tabDetails.Profile)&&(html='<div><span class="FL">'+ZPI18N.getString("zp.Onboarding.yourprofile")+"</span><ul>",void 0!=userDetails.tabDetails.Profile&&(html+="<li onclick=\"User.getRecordPage('"+ZPPreboarding.candidateFormId+"','"+pkid+"','VIEW')\"><a>Candidate</a></li>"),void 0!=userDetails.tabDetails.Forms&&void 0!=userDetails.tabDetails.Forms.tabSpecificData.forms&&$.each(userDetails.tabDetails.Forms.tabSpecificData.forms,function(ind,formDetails){html+="<li onclick=\"User.getRecordPage('"+formDetails.formId+"','"+formDetails.recordId+"','VIEW')\"><a>"+formDetails.formName+"</a></li>"}),html+="</ul></div>",$("#userOnboardingDetails:visible").find(".obReportsModalList").append(html)),$("#userOnboardingDetails:visible").find(".obReportsModalList").find("[filedata]").on("click",function(){var data=JSON.parse($(this).attr("filedata"));1==data.uploadSource||data.filePath.indexOf(workDriveUrl)>-1||data.filePath.indexOf(writerUrl)>-1||data.filePath.indexOf(sheetUrl)>-1||data.filePath.indexOf(showUrl)>-1?Layout.Page.pageContWrapper.parent().prepend(Files.openWDFiles(data,!0)):(data.fileName=AutomationCommon.htmlEncode(data.fileName),Layout.Page.pageContWrapper.parent().prepend(Files.constructPreview(data,"Onboarding")),Files.viewFile(data,"feed"))}),void 0!=userDetails.tabDetails.LMS_Course&&void 0!=userDetails.tabDetails.LMS_Course.tabSpecificData.courses&&(html='<div><span class="FL">Courses</span><ul>',$.each(userDetails.tabDetails.LMS_Course.tabSpecificData.courses,function(ind,course){var lmsinfo=course.courseBasicDetails[0].courseInfo[0];html+="<li><div>"+lmsinfo.courseName,html+=lmsinfo.isCourseCompleted?'<span class="FR accept">'+ZPI18N.getString("zp.completed")+"</span></div></li>":'<span class="FR reject">'+ZPI18N.getString("zp.pending")+"</span></div></li>"}),html+="</ul></div>",$("#userOnboardingDetails:visible").find(".obReportsModalList").append(html))},ZPOnboarding.reports.triggerOnboardingMassupdate=function(obj){if("masscheckbox"===obj.id){var checkboxes=Layout.Page.container.find(".table-content").find("input[type='checkbox']");if(Layout.Page.container.find("#masscheckbox").is(":checked")){if(checkboxes.prop("checked",!0),Layout.Page.container.find(".Scrcont").find(".table-body").find(".triggerbtn").find(".btn").remove(),0==Layout.Page.container.find(".ZPPsearch").length&&0!==Layout.Page.container.find(".table-content").find("input:checked").length){var html='<div class="ZPPsearch"><div id="ZPPsearchBtn" class="ZPPsearchTop"><a id="submitBtn" class="btn btn-primary" onclick="ZPOnboarding.reports.bulktrigerOnboarding();">'+ZPI18N.getString("zp.triggeronboadring")+"</a></div> </div>";$(html).insertAfter(Layout.Page.container.find(".well.ZPPhed"))}}else trigeronboarding='<a id="submitBtn" class="btn btn-primary" onclick="ZPOnboarding.reports.trigerOnboarding(this);">'+ZPI18N.getString("zp.triggeronboadring")+"</a>",Layout.Page.container.find(".Scrcont").find(".table-body").find(".triggerbtn").html(trigeronboarding),checkboxes.prop("checked",!1),Layout.Page.container.find(".ZPPsearch").remove()}else{if(0!==Layout.Page.container.find(".table-content").find("input:checked").length){if(Layout.Page.container.find(".Scrcont").find(".table-body").find(".triggerbtn").find(".btn").remove(),0==Layout.Page.container.find(".ZPPsearch").length){html='<div class="ZPPsearch"><div id="ZPPsearchBtn" class="ZPPsearchTop"><a id="submitBtn" class="btn btn-primary"  onclick="ZPOnboarding.reports.bulktrigerOnboarding();">'+ZPI18N.getString("zp.triggeronboadring")+"</a></div> </div>";$(html).insertAfter(Layout.Page.container.find(".well.ZPPhed"))}}else trigeronboarding='<a id="submitBtn" class="btn btn-primary" onclick="ZPOnboarding.reports.trigerOnboarding(this);">'+ZPI18N.getString("zp.triggeronboadring")+"</a>",Layout.Page.container.find(".Scrcont").find(".table-body").find(".triggerbtn").html(trigeronboarding),Layout.Page.container.find(".ZPPsearch").remove();0===Layout.Page.container.find(".Scrcont").find(".table-content").find("input[type='checkbox']").not(":checked").length?Layout.Page.container.find("#masscheckbox").prop("checked",!0):Layout.Page.container.find("#masscheckbox").prop("checked",!1)}},ZPOnboarding.reports.trigerOnboarding=function(data){if(erecno=$(data).closest("tr").attr("id"),void 0!=erecno){Layout.Page.container.find("#"+erecno).find("#onboardingbtn").html(ZPeople.LOADING_HTML);var params={erecno:erecno,parmode:"trigerOnboarding"};ZPeople.Request.send("/obReportActions.zp",params,ZPOnboarding.reports.handleresult)}},ZPOnboarding.reports.handleresult=function(result,params){if(result.Success==ZPOnboarding.CONSTANTS.POPULATE_SUCCESS&&void 0==result.bulk){var yet_to_onboarding=$("#yet_to_onboarding").find("b").html();yet_to_onboarding=parseInt(yet_to_onboarding),yet_to_onboarding-=1,$("#yet_to_onboarding").find("b").html(yet_to_onboarding);var totalcount=$("#emp_ongoing_onboarding").find("b").html();totalcount=parseInt(totalcount),totalcount+=1,$("#emp_ongoing_onboarding").find("b").html(totalcount),ZPOnboarding.reloadData()}else 1==result.bulk?(Layout.Page.container.find("input[type='checkbox']:checked").closest(".ZPLRow").find("#zp_page_loading").remove(),Layout.Page.container.find("input[type='checkbox']:checked").closest(".ZPLRow").find(".status").html("<span>"+ZPI18N.getString("zp.onboardingtriggered")+"</span>"),Layout.Page.container.find("input[type='checkbox']:checked").closest(".checkbox").remove()):"trigerOnboarding"==params.parmode&&(trigeronboarding='<a id="submitBtn" class="btn btn-primary" onclick="ZPOnboarding.reports.trigerOnboarding(this);">'+ZPI18N.getString("zp.triggeronboadring")+"</a>",Layout.Page.container.find(".table-content").find("#"+params.erecno).find("#onboardingbtn").html(trigeronboarding));Layout.Page.container.find("#masscheckbox").prop("checked",!1)},ZPOnboarding.reports.bulktrigerOnboarding=function(){var allerecno=[];Layout.Page.container.find(".ZPPsearch").remove(),$.each($(Layout.Page.container).find(".table-content").find("input[type='checkbox']:checked"),function(index,elm){allerecno[index]=$(elm).closest("tr").attr("id"),$(elm).closest("tr").find("#onboardingbtn").remove(),$(elm).closest("tr").append("<td>"+ZPeople.LOADING_HTML+"</td>")});var params={erecnoobj:allerecno=JSON.stringify(allerecno)};ZPeople.Request.send("/onboarding/reports/bulkTrigger",params,ZPOnboarding.reports.handleresult)},ZPOnboarding.reloadData=function(){if(0===Layout.Page.container.find(".zp_sfltr").length){var data=Layout.Page.container.find(".ZPPhed").find(".sel");ZPOnboarding.reportData(data)}else Layout.Page.container.find("#aplFltr").trigger("click")},ZPOnboarding.setDefaultFilter=function(){Layout.Page.container.find("#filterOption").find(".zp_lnk").trigger("click");var val=Layout.Page.container.find(".ZPPhed").find(".sel").find("span").html(),id=Layout.Page.container.find(".ZPPhed").find(".sel").attr("data-value"),menuProp={};"To be onboarded"==val&&(id="1"),menuProp.isMandatory=!1,menuProp.checkbox=!0;var cand="";ZPOnboarding.isCandReportPage&&(cand="_CAND"),menuProp.initobj="#ONBOARDING_STATUS"+cand+"_input",menuProp.callbackOnCancel="","2,4,5"==id?(ZPSelect.constructTag("",val,"2",menuProp),ZPSelect.constructTag("",ZPI18N.getString("zp.usercompleteonboarding"),"4",menuProp),ZPSelect.constructTag("",ZPI18N.getString("zp.reopenonboarding"),"5",menuProp),Layout.Page.container.find(menuProp.initobj).attr("selectedids",id)):(ZPSelect.constructTag("",val,id,menuProp),Layout.Page.container.find(menuProp.initobj).attr("selectedids",id))},ZPOnboarding.serverError=function(data){data&&data.responseJSON&&"XSS_DETECTED"==data.responseJSON.code?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.entervalidinput")):ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.sorryservererror")),Layout.Page.container.find("#aplFltr").prop("disabled",!1),Layout.Page.container.find("#submitDiv").show(),$(".btn-primary").removeAttr("disabled")},ZPOnboarding.addChecklist=function(){ZPOnboarding.isAddChecklist=!0,checklist.initiatePage();var name=ZPOnboarding.EmployeeForm.name,id=Layout.Page.childUrlParam.formid=ZPOnboarding.EmployeeForm.id;ZPOnboarding.currentOB.onboarding_type===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(name=ZPOnboarding.CandidateForm.name,id=Layout.Page.childUrlParam.formid=ZPOnboarding.CandidateForm.id),html='<input type="text" id="editmode" class="form-control" value="'+name+'" formid="'+id+'" readonly>',Layout.Page.container.find("#checklist").find("#formDiv").html(html)},ZPOnboarding.addChecklisttoList=function(){var checklistid=Layout.Page.container.find("#checklist").find("#editmode").attr("checklistid");if(void 0!=checklistid){var checklistname=AutomationCommon.htmlEncode(Layout.Page.container.find("#checklist").find("#clLabel").text()),taskcount=Layout.Page.container.find("#checklist").find("#mappedTasks").find("#sortable1").find("[taskid]").length,found=0;if(void 0!==ZPOnboarding.AllChecklist&&0!=Object.keys(ZPOnboarding.AllChecklist).length?(data=ZPOnboarding.AllChecklist,$.each(data,function(ind,checklist){checklist.checklistId==checklistid&&(found=1,checklist.label=checklistname,checklist.taskCount=taskcount,ZPOnboarding.isAddChecklist=!1,Layout.Page.container.find("#obReport1").find("#"+checklistid).find(".tagName").html(checklistname),Layout.Page.container.find("#obReport1").find("#"+checklistid).find(".tagCount").find("em").html(taskcount),Layout.Page.container.find("#obReport1").find("#"+checklistid).removeClass("open"),Layout.Page.container.find("#obReport1").find("#"+checklistid).find("#checklist_div").find("ul").remove(),0==taskcount?Layout.Page.container.find("#obReport1").find("#"+checklistid).find(".tagCount").find("i").addClass("DN"):Layout.Page.container.find("#obReport1").find("#"+checklistid).find(".tagCount").find("i").removeClass("DN"))}),0===found&&(ZPOnboarding.currentOB.onboarding_type===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?ZPOnboarding.AllChecklist.push({checklistId:checklistid,displayName:ZPOnboarding.CandidateForm.name,formId:ZPOnboarding.CandidateForm.id,label:checklistname,taskCount:taskcount}):ZPOnboarding.AllChecklist.push({checklistId:checklistid,displayName:ZPOnboarding.EmployeeForm.name,formId:ZPOnboarding.EmployeeForm.id,label:checklistname,taskCount:taskcount}))):Layout.Page.container.find("#obReport1").find(".modal-footer").find(".btn-default").trigger("click"),ZPOnboarding.isAddChecklist&&0===Layout.Page.container.find("#"+checklistid).length&&ZPOnboarding.isAddChecklist){var html='<tr class="ZPLRow " id="'+checklistid+'"><td class="cb"></td><td class="name ">'+checklistname+'</td><td class="clcount">'+taskcount+'</td><td><div class="ZPaction"><a data-original-title="Edit" data-content="" data-placement="right" data-trigger="hover" data-toggle="tooltip" zptitle="" class="IC-pen lnk S14" onclick="checklist.editChecklist(\''+checklistid+'\')"></a><a class="IC-delete ML20 lnk S14" data-content="" data-placement="right" data-trigger="hover" data-toggle="tooltip" zptitle="" data-original-title="Delete" onclick="ZPOnboarding.deleteChecklist(\''+checklistid+"')\"></a></div></td></tr>";Layout.Page.container.find("#checklistReport").find("#checklistbody").append(html),Layout.Page.container.find("#checklistReport").find("#wrapper").removeClass("hide"),Layout.Page.container.find(".obChecklist").find(".obChecklistHdr").removeClass("hide"),Layout.Page.container.find("#checklistDiv").find(".text-center").addClass("DN")}else Layout.Page.container.find("#checklistReport").find("#checklistbody").find("#"+checklistid).find(".name").html(checklistname),Layout.Page.container.find("#checklistReport").find("#checklistbody").find("#"+checklistid).find(".clcount").text(taskcount);ZPOnboarding.isAddChecklist=!1}},ZPOnboarding.config.getChecklist=function(data){var checklist=data.checklist,html="";void 0!=checklist&&0!=Object.keys(checklist).length?($.each(checklist,function(ind,jsonData){html+='<tr class="ZPLRow " id="'+jsonData.tempId+'"><td class="cb"></td><td class="name ">'+ZSEC.Encoder.encodeForHTML(jsonData.tempName)+'</td><td class="clcount">'+jsonData.count+'</td><td><div class="ZPaction"><a data-original-title="Edit" data-content="" data-placement="right" data-trigger="hover" data-toggle="tooltip" zptitle="" class="IC-pen lnk S14" onclick="checklist.editChecklist(\''+jsonData.tempId+'\')"></a><a class="IC-delete ML20 lnk S14" data-content="" data-placement="right" data-trigger="hover" data-toggle="tooltip" zptitle="" data-original-title="Delete" onclick="ZPOnboarding.deleteChecklist(\''+jsonData.tempId+"')\"></a></div></td></tr>"}),Layout.Page.container.find("#checklistReport").find("#wrapper").removeClass("hide"),Layout.Page.container.find(".obChecklist").find(".obChecklistHdr").removeClass("hide"),Layout.Page.container.find("#checklistDiv").find(".text-center").addClass("DN")):(Layout.Page.container.find("#checklistReport").find("#wrapper").addClass("hide"),Layout.Page.container.find(".obChecklist").find(".obChecklistHdr").addClass("hide"),Layout.Page.container.find("#checklistDiv").find(".text-center").removeClass("DN")),Layout.Page.container.find("#checklistReport").find("#checklistbody").html(html)},ZPOnboarding.config.tagChecklist=function(data){var tabModal=ZPeople.createModalPopup("obReport1",ZPI18N.getString("zp.tagachecklist"),"popRgtModel obChecklistModal");$(tabModal).find(".modal-header").find(".close").removeClass("IC-cls-1px red"),$(tabModal).find(".modal-header").find(".close").addClass("IC-cls FR"),$(tabModal).find(".modal-header").find(".close").removeAttr("buttonaction"),$(tabModal).find(".modal-header").find(".close").attr("onclick","ZPOnboarding.config.submitmappedChecklist()"),$(tabModal).find(".modal-body").html(ZPeople.LOADING_HTML),$(tabModal).find(".modal-footer").find(".btn-default").addClass("DN"),$(tabModal).find(".btn-primary").html(ZPI18N.getString("zp.close")),$(tabModal).find(".btn-primary").attr("onclick","ZPOnboarding.config.submitmappedChecklist()");var formid=ZPOnboarding.EmployeeForm.id;ZPOnboarding.currentOB.onboarding_type===ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(formid=ZPOnboarding.CandidateForm.id),params={formId:formid,method:"list"},ZPeople.Request.send("/getChecklistConfList.zp",params,ZPOnboarding.config.viewAllChecklist)},ZPOnboarding.config.viewAllChecklist=function(data){if(ZPOnboarding.AllChecklist=data,Layout.Page.container.find("#obReport1").find("#zp_page_loading").remove(),void 0!=data){0==Layout.Page.container.find("#obReport1").find(".modal-header").find("[type=search]").length&&Layout.Page.container.find("#obReport1").find(".modal-header").append('<div class="dvPopsearch"><input class="form-control" type="search" placeholder=\''+ZPI18N.getString("zp.search")+'...\'><i class="IC-lens"></i></div>'),Layout.Page.container.find("#obReport1").find("[type=search]").off("keyup"),Layout.Page.container.find("#obReport1").find("[type=search]").on("keyup",function(){var parent=$(this).closest(".modal-content"),data=this.value.split(" "),allDataObj=parent.find(".obTagList").find('[name="checklist"]');allDataObj.hide(),$.each(data,function(i,v){allDataObj=allDataObj.find(".tagName").filter("*:Contains('"+v+"')")}),allDataObj.closest('[name="checklist"]').show()});var html='<ul class="obTagList">';if(0!=Object.keys(data).length)$.each(data,function(ind,checklist){var sel="",DN="";0==checklist.taskCount&&(DN=" DN"),Layout.Page.container.find("#checklistbody").find("#"+checklist.checklistId).length>0&&(sel="sel"),html+='<li name="checklist" id="'+checklist.checklistId+'" class='+sel+'><i class="IC-rou-tik" onclick="ZPOnboarding.config.selectchecklist(\''+checklist.checklistId+'\')"></i><div id="checklist_div"><div><span class="tagName" onclick="checklist.editChecklist(\''+checklist.checklistId+"')\">"+checklist.label+'</span><span class="tagCount">'+ZPI18N.getString("zp.associatedtasks")+"<em>"+checklist.taskCount+'</em><i class="IC-ar-dwn'+DN+'" onclick="ZPOnboarding.config.openTasks(\''+checklist.checklistId+"')\"></i></span></div></div></li>"});else{html='<div class="obChecklist"><div class="text-center"><div class="DIB"><div class="ZPNdata" onclick="ZPOnboarding.addChecklist();"><i class="CR-nodata-chklst"><i class="path1"></i><i class="path2"></i><i class="path3"></i><i class="path4"></i><i class="IC-plus-round"></i></i><span>'+ZPI18N.getString("zp.checklist.add")+"</span></div></div></div></div>";Layout.Page.container.find("#obReport1").find(".modal-header").find(".dvPopsearch").addClass("DN")}html+="</ul>",Layout.Page.container.find("#obReport1").find("#bodyTag").html(html)}},ZPOnboarding.config.selectchecklist=function(checklistid){Layout.Page.container.find("#obReport1").find("#"+checklistid+".sel").length>0?Layout.Page.container.find("#obReport1").find("#"+checklistid).removeClass("sel"):Layout.Page.container.find("#obReport1").find("#"+checklistid).addClass("sel")},ZPOnboarding.config.submitmappedChecklist=function(){var data={checklist:[]};$.each($(Layout.Page.container).find("#obReport1").find(".obTagList").find(".sel"),function(index,elm){var id=$(elm).attr("id");data.checklist.push({tempId:id,tempName:$(elm).find(".tagName").text(),count:$(elm).find(".tagCount").find("em").text()}),0!==index?","+id:""+id}),Layout.Page.container.find("#obReport1").modal("hide"),ZPOnboarding.config.getChecklist(data)},ZPOnboarding.config.openTasks=function(checklistId){0==Layout.Page.container.find("#obReport1").find("#"+checklistId+".open").length?(0==Layout.Page.container.find("#obReport1").find("#"+checklistId).find("ul").length&&ZPOnboarding.config.getMappedTasks(checklistId),Layout.Page.container.find("#obReport1").find("#"+checklistId).addClass("open")):Layout.Page.container.find("#obReport1").find("#"+checklistId).removeClass("open")},ZPOnboarding.config.getMappedTasks=function(data,params){if(void 0===params){params={checklistId:data,method:"getChecklistMappedTasks"};ZPeople.Request.send("/getChecklistMappedTasks.zp",params,ZPOnboarding.config.getMappedTasks)}else{var html="<ul>";void 0!=data.tasks&&$.each(data.tasks,function(index,task){html+="<li onclick=\"ZPOnboarding.editTaskConfig('"+params.checklistId+"','"+task.taskconfigid+'\')" style="padding: 15px 25px;">'+task.taskConfigName+"</li>"}),html+="</ul>",Layout.Page.container.find("#obReport1").find("#"+params.checklistId).find("#checklist_div").append(html)}},ZPOnboarding.editTaskConfig=function(formid,taskConfigId){if(AutomationCommon.ifNotSel(taskConfigId,ZPACommon.TASK_MODE)){AutomationCommon.pageInsert(ZPACommon.TASK_MODE);var params={taskConfigId:taskConfigId,method:"getTaskConfig",conreqcsr:csrfToken},pageId=$("#"+AutomationCommon.getCurrentPageId(ZPACommon.TASK_MODE));TaskConfig.mainPageAct(!0),Task.taskConfigId=taskConfigId,ZPACommon.hideSlideBodyContent(),$.post("/getTaskConfig.zp",params,function(data){pageId.find("#formDiv").html($("<div>",{mode:"task",id:"editmode",formId:data.formId,taskconfigid:data.taskConfigId,text:ZPeople.decodeTxt(data.displayName)})),TaskConfig.resetConfig(),pageId.find("#taskName").val(decodeHTML(data.taskname)),pageId.find("#configName").val(decodeHTML(data.dispname)),pageId.find("#taskDesc").val(decodeHTML(data.desc)),void 0!=data.priorityId&&(pageId.find("#taskPriority").val(decodeHTML(data.priorityValue)),pageId.find("#taskPriority").attr("optionid",data.priorityId)),void 0!==data.taskOwner&&checklist.setTOwner(data.taskOwner),TaskConfig.setTbaValues(data.days),ZPACommon.showSlideBodyContent(),AutomationCommon.createSlideHeader(ZPI18N.getString("zp.edittasktemplate")),AutomationCommon.chooseLeftSide(taskConfigId,"taskLeftListing"),Layout.Page.container.find("#task").find("#addNewTask").find(".modal-header").find(".close").attr("onclick","ZPOnboarding.cancel()"),Layout.Page.container.find("#task").find("#addNewTask").find(".modal-footer").find(".btn-default").attr("onclick","ZPOnboarding.cancel()"),Layout.Page.container.find("#task").find("#addNewTask").find(".modal-footer").find("#saveTask").attr("onclick","ZPOnboarding.saveTaskConfig()"),Layout.Page.container.find("#checklist").find("[automationpages=clistConfigPage]").removeClass("page"),Layout.Page.container.find("#checklist").find("[automationpages=clistConfigPage]").addClass("default");Layout.Page.container.find("#obReport1").find("#"+params.checklistId).find(".tagName").text()})}},ZPOnboarding.cancel=function(){Layout.Page.container.find("#task").find("[automationpages=taskConfigPage]").attr("class","default"),Layout.Page.container.find("#task").find("#addNewTask").find(".modal-header").find(".close").attr("onclick","TaskConfig.closeSlide()"),Layout.Page.container.find("#task").find("#addNewTask").find(".modal-footer").find(".btn-default").attr("onclick","TaskConfig.closeSlide()"),Layout.Page.container.find("#task").find("#addNewTask").find(".modal-footer").find("#saveTask").attr("onclick","TaskConfig.saveTaskConfig()"),Layout.Page.container.find("#backSlider").removeClass("modal-backdrop in")},ZPOnboarding.saveTaskConfig=function(){var pageId=$("#"+AutomationCommon.getCurrentPageId()),taskObj={},isError=!1,isTaskOwnerSelected=!1;if(taskObj.formId=AutomationCommon.getFormId(),taskObj.taskName=pageId.find("#taskName").val(),taskObj.taskConfigName=pageId.find("#configName").val(),taskObj.desc=pageId.find("#taskDesc").val(),taskObj.dayLimit=TaskConfig.getTbaObj(pageId.find("[name=tbaExeDiv]")),taskObj.taskConfigId=Task.taskConfigId,taskObj.priorityId=pageId.find("#taskPriority").attr("optionid"),taskObj.taskownerdtls=pageId.find("#singleInputTag").getTagConfig(),pageId.find(".has-error").removeClass("has-error"),pageId.find("div.dverrormsg").remove(),$.each(taskObj.taskownerdtls,function(key,value){taskObj.taskownerdtls[key]=value[0],isTaskOwnerSelected=!0}),""==taskObj.taskName&&(pageId.find("#taskName").parent().addClass("has-error"),pageId.find("#taskName").parent().parent().append("<div class='dverrormsg'>"+ZPI18N.getString("zp.tasknameerromsg")+"</div>"),isError=!0),""==taskObj.taskConfigName&&(pageId.find("#configName").parent().addClass("has-error"),pageId.find("#configName").parent().append("<div class='dverrormsg'>"+ZPI18N.getString("zp.template.namecantempty")+"</div>"),isError=!0),isTaskOwnerSelected||(pageId.find("#singleInputTag").addClass("has-error"),pageId.find("#singleInputTag").parent().append("<div class='dverrormsg'>"+ZPI18N.getString("zp.taskownererrormsg")+"</div>"),isError=!0),0!=Task.taskConfigId||ZPACommon.getUrlMode()!==ZPACommon.CHECKLIST_MODE&&ZPACommon.getUrlMode()!==NewWorkFlow.MODE&&ZPACommon.getUrlMode()!==ZPOnboarding.MODE||(taskObj.checklistid=TaskConfig.currentChecklistId),!isError){var params={configuration:JSON.stringify(taskObj),method:"save",conreqcsr:csrfToken};$.post("/saveTaskConfig.zp",params,function(data){void 0!==data.status&&"success"===data.status?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.tasksuccessmsg")),AutomationCommon[ZPACommon.TASK_MODE+"_formChange"]=!0,ZPOnboarding.cancel()):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror"))})}},ZPOnboarding.deleteChecklist=function(checklistid){Layout.Page.container.find("#checklistReport").find("#checklistbody").find("#"+checklistid).remove(),0==Layout.Page.container.find("#checklistReport").find("#checklistbody").find("tr").length&&(Layout.Page.container.find("#checklistReport").find("#wrapper").addClass("hide"),Layout.Page.container.find("#checklistDiv").find(".obChecklistHdr").addClass("hide"),Layout.Page.container.find("#checklistDiv").find(".text-center").removeClass("DN"))},ZPOnboarding.esignurl=function(data,params,others){if(data.errorCode)if("ZOHOSIGNED"==data.error){Layout.Page.container.find("#onBoardingRightPane:visible").find("#docFrame").replaceWith('<div id="docFrame"><div class="ZPNdata"><i class="CR-nodata-docsign"><i class="path1"></i><i class="path2"></i><i class="path3"></i><i class="path4"></i><i class="path5"></i> </i><h5 id="zp_views_nodata">Loading...</h5><p class="dgry">This may take few seconds</p></div></div>')}else data.msg&&Layout.Page.container.find("#onBoardingRightPane:visible").find("#docFrame").replaceWith(ZPOnboarding.docError.replace(/\$MSG\$/,data.msg));else{var fileid="[agreementid="+data.fileId+"]";void 0!=others&&(fileid=others.obj);var src=void 0!=data.esignurl?data.esignurl:"viewFile?fileId="+data.recordid;if(void 0!=data.esignurl?(src=data.esignurl,Layout.Page.container.find("#onBoardingRightPane").find("[name=fileOptions]").addClass("DN"),Layout.Page.container.find(".zo_docLoad").prepend('<div id="agonbload">'+ZPeople.LOADING_HTML+"</div>"),Layout.Page.container.find(".zo_Loded").css("background-color","transparent")):data.recordid&&(src="viewFile?fileId="+data.recordid,src+=void 0==ZPOnboarding.latitude||void 0==ZPOnboarding.longitude?"":"&latitude="+ZPOnboarding.latitude+"&longitude="+ZPOnboarding.longitude,data.IS_ACCEPTED?Layout.Page.container.find(fileid).addClass("completed"):void 0==data.IS_ACCEPTED||data.IS_ACCEPTED||Layout.Page.container.find(fileid).addClass("rejected"),Layout.Page.container.find(fileid).hasClass("onRead")&&(Layout.Page.container.find("#onBoardingRightPane").find("[name=fileOptions]").removeClass("DN"),Layout.Page.container.find("#onBoardingRightPane").find("[name=fileOptions]").each(function(ind){let href="";if(0===ind){let fileId=data.recordid;href=`javascript:var v = window.open('viewFile?fileId=${fileId+=void 0!=ZPOnboarding.latitude&&void 0!=ZPOnboarding.longitude?"&latitude="+ZPOnboarding.latitude+"&longitude="+ZPOnboarding.longitude:""}');v.print()`}else 1===ind&&(href=`javascript:Files.downloadFilecabinet('html','${data.recordid}','${data.filepath}','${Layout.Page.container.find(fileid).find("[prop=fileName]").text()}')`);$(this).attr("href",href)}))),Layout.Page.container.find(fileid).hasClass("onRead")){var docFrame=ZPOnboarding.iFrameTemplate.replace(/\$SRC\$/,src);docFrame=docFrame.replace(/\$ID\$/,"docFrame"),Layout.Page.container.find("#onBoardingRightPane:visible").find("#docFrame").replaceWith(docFrame),Layout.Page.container.find("#onBoardingRightPane").find("[prop=docProp]").show()}}void 0!=others&&Layout.Page.container.find(others.obj).removeClass("NM OP5")},ZPOnboarding.addNewForm=function(obj){var optns={successCallback:ZPServices.Configure.addNewFormCallBack,otherActions:ZPOnboarding.formSaveSuccess,tabid:ZPOnboarding.onboardingTABID,portalType:1};tabCustom.addNewForm(obj,!1,optns)},ZPOnboarding.formSaveSuccess=function(){ZPOnboarding.obFormsList[2]=[],ZPOnboarding.obTemplatesList={},$("[onboardingid][onboarding_type=2]").remove()},ZPOnboarding.addCandidadte=function(type){CPortal.currentPortalZAID||$.ajax({type:"POST",async:!1,url:CPortal.candidateURLS.CPORTALURL,data:{conreqcsr:csrfToken},success:function(data){CPortal.currentPortalZAID=data.ZAID,CPortal.portalObj=data}}),CPortal.currentPortalZAID?"single"===type?CPortal.getAddUserListPage("invite"):CPortal.getAddMultiUserListPage("invite"):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.clientportalerror"))},ZPPreboarding={},ZPPreboarding.init=function(){if(Layout.Page.container=$("body"),ZPPreboarding.isPreBoarding=!0,ZPOnboarding.totalTabs=ZPOnboarding.tabsOrder.length,ZPOnboarding.singleTabAngle=Math.round(360/ZPOnboarding.totalTabs),void 0!=currUser.photo&&""!=currUser.photo.trim()){var downloadParams={fcId:photoFC,recordId:currUser.candidateId,formId:candidateFormId,original:"false"};ZPPreboarding.viewUrl=ZPForm.constructDownloadLink(downloadParams),$("#userImage").attr("src",ZPPreboarding.viewUrl),$("#zpeople_userimage").attr("src",ZPPreboarding.viewUrl)}$("#zpeople_userimage").on("click",CPortal.User.showLogoutModal),$(document).on("click",function(event){$("#zp_user_profile_pop").hide(),$("#zpeople_forms").hide(),$("#zpeople_more").hide(),$("#zpeople_notification").hide(),$("#showcorrespondingLogtime").hide(),0==$(event.target).parents("#zp_user_information").length&&(ZPForm.isPreboarding=!0,$("#zp_user_information").modal("hide")),null!==Layout.Page.container&&0==$(event.target).parents("#singlecalendar").length&&0==$(event.target).parents("#doublecalendar").length&&(Calendar.hideSingleCalendar(),Calendar.hideDoubleCalendar()),0!==$("#timerCurModal").length&&$("#timerCurModal").hasClass("in")&&0===$(event.target).parents("#timerCurModal").length&&$("#timerCurModal").modal("hide")}),ZPOnboarding.isInitiated&&ZPOnboarding.constructTabs(),$("div#zpinitloading").length>0&&$("div#zpinitloading").remove(),ZPLoader.ISDONE=!0,ZPeople.setUp(),ZPLoader.loadWms()},ZPOnboarding.bulkEnableOnboarding=function(){var params={},userIds="",userTableElm=Layout.Page.container.find("table#userListTable");$.each(userTableElm.find("input[name='userRowCheck']:checked"),function(index,obj){index>0&&(userIds+=","),userIds+=$(obj).closest("tr").attr("emperecno")}),params.erecnos=userIds,ZPeople.Request.send("/onboarding/settings/enable",params,ZPOnboarding.bulkEnableResponse)},ZPOnboarding.bulkEnableResponse=function(data,params){data.msg==zpconst.CommonMessages.SUCCESSMSG?ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatedsuccessfully")):void 0!=data.msg&&ZPeople.Message.showFailureMsg(data.msg)},ZPOnboarding.checkAndCompleteOnboarding=function(data,params){if(void 0==params)Layout.Page.container.find("#onBoardingRightPane").find("#cmpOnboarding").attr("disabled","disabled"),ZPeople.Request.send("/onboarding/pre/setOBStatus",{isPreboard:ZPPreboarding.isPreBoarding,parmode:"setOBStatus"},ZPOnboarding.checkAndCompleteOnboarding,void 0,ZPOnboarding.failureCallBack);else if(Layout.Page.container.find("#onBoardingRightPane").find("#cmpOnboarding").removeAttr("disabled"),void 0!=data)if(data.success)if(ZPeople.refreshSession(),window.location.href.endsWith("preonboarding")){var a="<style>.zpwel{width:640px;  margin:100px auto; border-radius:3px; box-shadow:0 3px 15px #CCC; background-color:#FFFFFF;}";a+=".zpwel h2{padding:15px 20px; font-size:20px;  color:#A96C0F; font-weight:normal; background-color:#F6F6F6; border-bottom:1px solid #DDD; border-radius:3px 3px 0 0;}",a+=".zpwel a{float: left;margin-top: 10px;}",a+=".zpwelcon{padding:20px; display:table; width:600px;}",a+=".zpwelcon .lft{width:260px;display:table-cell; padding-right:40px;}",a+=".zpwelcon .rgt{width:260px; border-left: 1px dotted #999;display:table-cell; padding-left:40px;}",a+=".zpwelcon h3{font-size:17px; font-weight:normal; line-height:28px; width:94%; color:#333;}",a+=".zpwelcon p{font-size:13px; font-weight:normal; line-height:21px; padding:15px 0px;}",a+=".zpblubut, .zpgrybut{background-color:#48B0EE; border:1px solid #3092cc; color:#FFF; margin:20px 0px 10px 0; text-align:center; cursor:pointer; padding:7px 12px; font-size:15px; font-weight:normal; box-shadow:0 2px 1px #999999; border-radius:3px;}",a+=".zpblubut:hover{background-color:#259ce3;}",a+=".zpgrybut{background:#BBB; border:1px solid #AAA; cursor:default;}",a+=".zpweltxt{border:1px solid #BBB; padding:5px; width:240px; height:20px; border-radius:3px; font-size:14px; color:#666; box-shadow:0 2px 4px #DDD inset;}",a+=".zpweltxt option{padding:2px 4px;}",a+=".zpweltxt option:hover{background-color:#3875d7; color:#FFF;}",a+=".ZPShead a{color:#ea4f33; font-size:14px; margin-top:0 !important; position:absolute; right:15px; top:20px;}",a+=".zpwcont{width:100%; display:table-cell; vertical-align:top;}",a+=".zpwico{float:left; display:table-cell; width:64px; margin-right:30px;}",a+=".zpwtxtfld{color:#999999; font-size:14px; line-height:23px; margin-top:20px; float:left; width:100%;}",a+=".zpwtxtfld span{color:#990000; font-size:11px;}",a+=".zpwtxtfld label{float:left; color:#888; width:100px;}",a+=".zpjt{float:left; width:350px; font-size:14px; color:#444;}",a+=".zpjt font{ font-size:12px; color:#A96C0F;}",a+=".zpjd{font-size:12px; color:#666; line-height:21px; float:left; width:350px;</style>",$("html").html("<head>"+a+"</head>"),$("html").append('<div class="zpwel"><h2 class="ZPShead">Hi! <a href="/'+portalName+ZPOnboarding.CONSTANTS.CPORTAL_CONTEXT+"/Logout.zp?DIGEST="+zaidDigest+'">Sign Out</a></h2><div class="zpwelcon"><div class="lft"><h3>'+ZPI18N.getString("zp.onboardingcompletedmessage")+"</h3></div></div></div>")}else{var zpUrl=window.location.href.replace("/onboarding","/zp");window.location.href=zpUrl}else 0==data.success&&(void 0!=data.message?ZPeople.Message.showFailureMsg(data.message):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.tabsnotcomplete")))},ZPOnboarding.refreshFilesList=function(){if(void 0!==$("#comp_fileListing").find("#comp_fileList").html()&&$("#comp_fileListing #comp_fileList").find("tr").length!=ZPOnboarding.hrFiles.length){Layout.Page.container;$.ajax({type:"POST",async:!1,url:"/onboarding/settings/getHRFiles",data:{conreqcsr:csrfToken,ONBOARDINGID:ZPOnboarding.currentOB.ONBOARDINGID},success:function(data){ZPOnboarding.hrFiles=data.hrfiles;var policies=void 0!=ZPOnboarding.configdata.Agreements.tabSpecificData.policies&&ZPOnboarding.configdata.Agreements.tabSpecificData.policies.length>0?ZPOnboarding.configdata.Agreements.tabSpecificData.policies:[""],agrHtml='<select keyname="policies" multiple>';$.each(ZPOnboarding.hrFiles,function(fInd,hrFile){var select=$.inArray(hrFile.fileID,policies)>-1?"selected":"";agrHtml+='<option value="'+hrFile.fileID+'" '+select+">"+hrFile.fileName+"</option>"}),agrHtml+="</select></div></div>",$("[tab-content=Agreements]").find("[name=policies] .dvCriteria").html(agrHtml),$("[tab-content=Agreements]").find("select").select2()}})}},ZPOnboarding.usersPageBulkTriggerOnboarding=function(){var allerecno=[],pageid=Layout.Page.container;$.each($(pageid).find("#userListTable tbody").find("input[name='userRowCheck']:checked"),function(index,elm){allerecno[index]=$(elm).closest("tr").attr("emperecno")}),allerecno=JSON.stringify(allerecno),$.ajax({type:"POST",async:!1,url:"/onboarding/reports/bulkTrigger",data:{erecnoobj:allerecno,conreqcsr:csrfToken},success:function(data){if(data.Success)ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.onboardingtriggeredsuccess"));else if(data.hasOwnProperty("onbtriggeredalready")||data.hasOwnProperty("invaliduser")||data.hasOwnProperty("onbdoesntexist")||data.hasOwnProperty("adminusers")){var html='<div class="obflow">';$.each(data,function(index1,msgobj){"Success"!=index1&&(html+='<p class="pspace">',"onbtriggeredalready"==index1?html+=ZPI18N.getString("zp.onbalreadytriggered"):"invaliduser"==index1?html+=ZPI18N.getString("zp.notvailduser"):"onbdoesntexist"==index1?html+=ZPI18N.getString("zp.nomatchonbflow"):"adminusers"==index1&&(html+=ZPI18N.getString("zp.noonbforadmin")),html+="</p>",html+='<div class="pspace">',$.each(msgobj,function(index2,emailid){html+="<span>",html+="invaliduser"==index1?$("#userSettings").find("[emperecno="+emailid+"]").find(".lblmail").text():emailid,html+="</span>"}),html+="</div>")}),ZPeople.confirm(null,ZPI18N.getString("zp.onbnottriggeredreasons"),html,"",!0,!0,"",!0)}else void 0!=data.msg?ZPeople.Message.showFailureMsg(data.msg):ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.sorryservererror"));pageid.find("#usersOptions").addClass("DN"),pageid.find("#licenseDtlsRow").removeClass("DN"),pageid.find("table#userListTable input[name='userRowCheck']").prop("checked",!1)}})},ZPOnboarding.empPageBulkTriggerOnboarding=function(){var allerecno=[];userTableElm=Layout.Page.container.find("table#zp_views_records_table:visible"),$.each(userTableElm.find("tbody input#zp_view_sel_record:checked"),function(index,obj){allerecno[index]=$(this).closest("tr").attr("recordid")}),allerecno=JSON.stringify(allerecno),$.ajax({type:"POST",async:!1,url:"/onboarding/reports/bulkTrigger",data:{erecnoobj:allerecno,conreqcsr:csrfToken},success:function(data){if(data.Success)ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.onboardingtriggeredsuccess"));else if(data.hasOwnProperty("onbtriggeredalready")||data.hasOwnProperty("invaliduser")||data.hasOwnProperty("onbdoesntexist")||data.hasOwnProperty("adminusers")){var html='<div class="obflow">';$.each(data,function(index1,msgobj){"Success"!=index1&&(html+='<p class="pspace">',"onbtriggeredalready"==index1?html+=ZPI18N.getString("zp.onbalreadytriggered"):"invaliduser"==index1?html+=ZPI18N.getString("zp.notvailduser"):"onbdoesntexist"==index1?html+=ZPI18N.getString("zp.nomatchonbflow"):"adminusers"==index1&&(html+=ZPI18N.getString("zp.noonbforadmin")),html+="</p>",html+='<div class="pspace">',$.each(msgobj,function(index2,emailid){html+="<span>"+emailid+"</span>"}),html+="</div>")}),ZPeople.confirm(null,ZPI18N.getString("zp.onbnottriggeredreasons"),html,"",!0,!0,"",!0)}else void 0!=data.msg?ZPeople.Message.showFailureMsg(data.msg):ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.sorryservererror"));Layout.Page.container.find("#zp_view_record_delete").fadeOut(200,function(){$(this).siblings("#zp_views_formrecactions").fadeIn(200)}),ZPView.VIEW_CONTAINER.find("[id=zp_view_sel_record]").prop("checked",!1),ZPView.refresh(!0)}})},ZPOnboarding.updateCandidateFlowname=function(obj){if("candflowEdit"==$(obj).attr("name"))$(obj).closest(".ZPobTop").find('[name="candflowValue"]').val($(obj).closest(".ZPobTop").find('[name="candflowName"]').text()),$(obj).closest(".ZPobTop").find('[name="candflowValue"]').show(),$(obj).closest(".ZPobTop").find('[name="candflowValue"]').trigger("select"),$(obj).hide(),$(obj).closest(".ZPobTop").find('[name="candflowName"]').hide();else if($(obj).hide(),$(obj).siblings('[name="candflowName"]').show(),$(obj).closest(".ZPobTop").find('[name="candflowEdit"]').show(),0!=$(obj).val().trim().length&&$(obj).val()!=$(obj).siblings('[name="candflowName"]').text()){var params={ONBOARDINGID:ZPOnboarding.currentOB.ONBOARDINGID,DISPLAY_NAME:$(obj).val(),applicableFor:"{}",onboarding_type:ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE};ZPeople.Request.send("/onboarding/flow/save",params,ZPOnboarding.saveSuccess,void 0,ZPOnboarding.serverError)}},ZPOnboarding.updateCandidateProfile=function(data){if(data.Photo){var downloadParams={fcId:photoFC,recordId:currUser.candidateId,formId:candidateFormId,original:"false"};ZPPreboarding.viewUrl=ZPForm.constructDownloadLink(downloadParams),$("#zpeople_userimage").attr("src",ZPPreboarding.viewUrl)}void 0!==data.name&&(CPortal.CURR_USER.name=data.name)},ZPOnboarding.completeOnboarding=function(erecno){Layout.Page.container.find("[name=completeOnboarding]").attr("disabled","disabled"),ZPeople.Request.send("/onboarding/reports/completeOnboarding",{reportType:ZPOnboarding.currentReportType(),erecno:erecno},ZPOnboarding.handleresultofcmponb)},ZPOnboarding.handleresultofcmponb=function(result,params){1==result.success&&("bulkcompleteOnboarding"==params.parmode?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatesuccessful")),ZPOnboarding.reloadData(),Layout.Page.container.find("input[type='checkbox']:checked").closest(".checkbox").remove()):(Layout.Page.container.find("#userOnboardingDetails").find(".close").trigger("click"),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.cmponbsuccess",[Layout.Page.container.find(".table").find("#"+params.erecno).find(".name").find("span").text()])),Layout.Page.container.find(".table").find("#"+params.erecno).remove(),Layout.Page.container.find("#onboarding_completed").find(".complete").text(parseInt(Layout.Page.container.find("#onboarding_completed").find(".complete").text())+1),Layout.Page.container.find("#emp_ongoing_onboarding").find(".ongoing").text(parseInt(Layout.Page.container.find("#emp_ongoing_onboarding").find(".ongoing").text())-1)))},ZPOnboarding.config.mailmergetmplist=function(obj){var formid=$(obj).val(),templates='<option value="">-'+ZPI18N.getString("zp.select")+"-</option>";$.each(ZPOnboarding.mmTemplates,function(mInd,template){template.formId==formid&&(templates+='<option formid="'+template.formId+'" value="'+template.tid+'">'+template.fname+"</option>")}),$(obj).closest("tr").find('[name="TEMPLATEID"]').html(templates),$(obj).closest("tr").find('[name="TEMPLATEID"]').select2(),AutomationCommon.appendSelect2Properties($(obj).closest("tr").find('[name="TEMPLATEID"]'))},ZPOnboarding.alertforzohosign=function(obj){"4"==$(obj).val()&&(ZPeople.confirm(null,"",ZPI18N.getString("zp.onbesignwarn"),"",!0,!0),Layout.Page.container.find("[name=AGREEMENTS_TYPE]").removeAttr("onchange"))},ZPOnboarding.scrollToEnd=function(obj){var scrollContainer=$("#viewFileFrame").contents().find("#viewerContainer");$(scrollContainer).off(),$(scrollContainer).on("scroll",function(){"null"==$(obj).attr("iscompleted")&&Math.ceil($(this).scrollTop())+Math.ceil($(this).innerHeight())>=$(this)[0].scrollHeight&&Layout.Page.container.find("#docBtns").show()})},ZPOnboarding.moduleSettings=function(){var pageid=Layout.Page.container,html=void 0;0==pageid.find(".ZPSettings").length&&(pageid.html(ZPeople.LOADING_HTML),$.ajax({type:"POST",async:!1,url:"/onboarding/settings/getConfig",data:{conreqcsr:csrfToken},success:function(data){var onbWorkflow=data.onbWorkflow?"checked":"",restrictEmpAccess=data.restrictEmpAccess?"checked":"",autoonboardingcomplete=data.autoonboardingcomplete?"":"checked",isemptempvisible=data.isemptempvisible?"checked":"",iscandRemvisible=data.candOnbReminder&&data.candOnbReminder.isvisible?"checked":"";ZPOnboarding.tdays=data.tdays,ZPOnboarding.candonbRemData=data.candOnbReminder;var candremid=data.candOnbReminder?data.candOnbReminder.remid:void 0;html='<div class="ZPSettings"><div class="profileDiv" id="profileDiv" style="display: block;"><div class="mainhead zp_header"><label class="zp_serIcn"><i id="srvicon"></i></label><span id="cgeName">'+ZPI18N.getString("zp.Onboarding")+'</span></div><div class="Scrcont">',html+='<div class="profLocale bdr"><div id="serviceView" class=""><div class="zp_Clnd"><h2 class="bn">'+ZPI18N.getString("zp.forms")+'</h2><p class="dgry">'+ZPI18N.getString("zp.onbformdes")+'</p><div id="sfrmList" class="zp_sFrms"></div><div id="FaqView"></div> </div></div></div>',html+='<div class="profLocale bdr"><h2 class="bn">'+ZPI18N.getString("zp.custonbemptemp")+'</h2><p class="dgry">'+ZPI18N.getString("zp.custonbemptempdes")+"</p>",data.invtemplateId&&(html+='<div class="zp-label bn"><div class="zprt-label"><a onclick="ZPOnboarding.editMailAklertTemplate(\''+data.invtemplateId+"','"+data.candformid+"',true)\" >"+ZPI18N.getString("zp.candinvtemplate")+"</a></div></div>"),html+='<div class="zp-label bn"><div class="zprt-label"><a onclick="ZPOnboarding.editMailAklertTemplate(\''+data.emponbtemplateid+"','"+ZPeople.EMP_FORMID+"')\">"+ZPI18N.getString("zp.emponbtemplate")+'</a></div><label class="btnactive btnNew FR" id="emponbtemplate"><input class="cmn-toggle-small cmn-toggle-round-small" type="checkbox" '+isemptempvisible+' onclick="ZPOnboarding.changeSettingStatus(this)"><span class="M0"></span></label></div></div>',html+='<div class="profLocale bdr"><h2 class="bn">'+ZPI18N.getString("zp.onbreminder")+'</h2><p class="dgry">'+ZPI18N.getString("zp.onbremdes")+'</p><div class="zp-label bn"><div class="zprt-label">',candremid?html+="<a onclick=\"ZPOnboarding.onboardinggetReminder('"+candremid+"','"+data.candformid+"')\">"+ZPI18N.getString("zp.candonbreminder")+"</a>":(html+='<p id="candonbremtemp" class="dgry">'+ZPI18N.getString("zp.candonbreminder")+"</p>",ZPOnboarding.candformid=data.candformid),html+='</div><label class="btnactive btnNew FR" id="candreminder"><input class="cmn-toggle-small cmn-toggle-round-small" type="checkbox" '+iscandRemvisible+' onclick="ZPOnboarding.changeSettingStatus(this)"><span class="M0"></span></label></div></div>',html+='<div class="profLocale bdr"><h2 class="bn"><span>'+ZPI18N.getString("zp.trigemponbauto")+'</span><i class="IC-info ML10" data-content="" data-placement="right" data-trigger="hover" data-toggle="popover" zptitle="" data-original-title="'+ZPI18N.getString("zp.trigemponbautoinfo")+'"></i><label class="btnactive btnNew FR" id="onbWorkflow"><input class="cmn-toggle-small cmn-toggle-round-small" type="checkbox" '+onbWorkflow+' onclick="ZPOnboarding.changeSettingStatus(this)"><span class="M0"></span></label></h2><p class="dgry">'+ZPI18N.getString("zp.trigemponbautodes")+"</p></div>",html+='<div class="profLocale bdr"><h2 class="bn"><span>'+ZPI18N.getString("zp.restrictzpacess")+'</span><label class="btnactive btnNew FR" id="restrictEmpAccess"><input class="cmn-toggle-small cmn-toggle-round-small" type="checkbox" '+restrictEmpAccess+' onclick="ZPOnboarding.changeSettingStatus(this)"><span class="M0"></span></label></h2><p class="dgry">'+ZPI18N.getString("zp.restrictzpacessdes")+"</p></div>",html+='<div class="profLocale bdr"><h2 class="bn"><span>'+ZPI18N.getString("zp.approveonboardingcomplete")+'</span><label class="btnactive btnNew FR" id="autoonboardingcomplete"><input class="cmn-toggle-small cmn-toggle-round-small" type="checkbox" '+autoonboardingcomplete+' onclick="ZPOnboarding.changeSettingStatus(this)"><span class="M0"></span></label></h2><p class="dgry">'+ZPI18N.getString("zp.approveonboardingcompletedesc")+"</p></div>";var tdohtml='<div class="profLocale bdr"><h2 class="bn"><span>'+ZPI18N.getString("zp.tdojsetting")+'</span></h2><p class="dgry"></p><div class="zp-label "><div class="zprt-label"><p class="dgry">'+ZPI18N.getString("zp.tdojdesc")+'</p></div><label class="btnactive btnNew FR W90" id="autoonboardingcomplete"><input class="form-control fdwid W50 FL" onblur="ZPOnboarding.updatetdojdays(this)" name="portalValue" value="'+data.tdays+'" type="text" maxlength="40" style=""><span class="FR ML5 LH30">days</span></label></div>';tdohtml+='<div class="zp-label bn '+(data.tdays&&""!=data.tdays.trim()&&"0"!=data.tdays.trim()?"":"DN")+'" id="completiontime"><div class="zprt-label"><p class="dgry">'+ZPI18N.getString("zp.obcompletiontime")+'</p></div><select class="FR WAI" style="margin-top: 2px;" onchange="ZPOnboarding.updatetdojtime(this)" id="tdojtime" name="tdojampm" tabindex="-1"><option value="null">- Select -</option>';var timetxt=["12:00 AM","12:30 AM","01:00 AM","01:30 AM","02:00 AM","02:30 AM","03:00 AM","03:30 AM","04:00 AM","04:30 AM","05:00 AM","05:30 AM","06:00 AM","06:30 AM","07:00 AM","07:30 AM","08:00 AM","08:30 AM","09:00 AM","09:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","01:00 PM","01:30 PM","02:00 PM","02:30 PM","03:00 PM","03:30 PM","04:00 PM","04:30 PM","05:00 PM","05:30 PM","06:00 PM","06:30 PM","07:00 PM","07:30 PM","08:00 PM","08:30 PM","09:00 PM","09:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM"],timeval=["00:00 AM","00:30 AM","01:00 AM","01:30 AM","02:00 AM","02:30 AM","03:00 AM","03:30 AM","04:00 AM","04:30 AM","05:00 AM","05:30 AM","06:00 AM","06:30 AM","07:00 AM","07:30 AM","08:00 AM","08:30 AM","09:00 AM","09:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","13:00 PM","13:30 PM","14:00 PM","14:30 PM","15:00 PM","15:30 PM","16:00 PM","16:30 PM","17:00 PM","17:30 PM","18:00 PM","18:30 PM","19:00 PM","19:30 PM","20:00 PM","20:30 PM","21:00 PM","21:30 PM","22:00 PM","22:30 PM","23:00 PM","23:30 PM"];for(i=0;i<timetxt.length;i++){var selclass=0==timeval[i].indexOf(data.comptime)?"selected":"";tdohtml+='<option value="'+timeval[i]+'" '+selclass+">"+timetxt[i]+"</option>"}html+=tdohtml+="</select></div></div>",html+='<div class="profLocale bdr"><h2 class="bn"><span>'+ZPI18N.getString("zp.candtoempconv")+'</span><a class="cust" id="customDiv" onclick="CPortal.getTemplateMappingdata()"><i class="IC-setting MR5"></i>'+ZPI18N.getString("zp.customization")+'</a></h2><p class="dgry">'+ZPI18N.getString("zp.candtoempconvdes")+"</p></div>",html+="</div></div>",html+='<div class="fieldMap" id="fieldMapDiv" style="display: none;"><div class="mainhead"><div class="ZPbold">'+ZPI18N.getString("zp.candtoempconv")+'<a class="close IC-cls" data-dismiss="modal" id="fieldMapClose"></a></div></div><div class="Scrcont"></div><div class="dvcom-action text-left DN"><div class="zp-md-6 text-left" id="saveChanged"><button data-loading-text="Loading..." id="dvbtnSave" class="btn btnfrmsave btn-primary PL15 PR15" type="button" autocomplete="off" onclick="CPortal.saveTemplate()">'+ZPI18N.getString("zp.submit")+' <span class="loader FR hide"></span></button><a class="btn btnfrmsave btn-default ML10" id="orgSetCancel" onclick="Layout.Page.container.find(\'#fieldMapDiv #fieldMapClose\').trigger(\'click\')">'+ZPI18N.getString("zp.cancel")+"</a></div></div></div></div>",html+='<div id="mailalert" class="ZPcontwrap dvflow_str tb DN"></div><div id="backSlider"></div>',isadmin||data.isFormCustomAdmin?ZPOnboarding.serviceViewPage(!1,html):(pageid.html(html),pageid.find("select").select2(),$('[data-toggle="popover"]').popover(),pageid.find("#profileDiv .zp_serIcn").html('<i id="srvicon" class="zp_Si zp_app44"></i>'),pageid.find("#serviceView").parent().addClass("DN"),pageid.addClass("services"))},error:function(err){ZPOnboarding.failureCallBack(err)}}))},ZPOnboarding.changeSettingStatus=function(obj){let url;var params={},id=$(obj).closest("label").attr("id");switch(params.method=id,id){case"candreminder":url="/onboarding/settings/onboardingReminder",params.method="onbreminder",params.onboarding_type=NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE;break;case"empreminder":url="/onboarding/settings/onboardingReminder",params.method="empreminder",params.onboarding_type=NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE;break;case"onbWorkflow":url="/onboarding/settings/autoTrigger";break;case"restrictEmpAccess":url="/onboarding/settings/restrictAccess";break;case"emponbtemplate":url="/onboarding/settings/enableDisableEmpWelcomeMail";break;case"autoonboardingcomplete":url="/onboarding/settings/enableDisableMarkAsCompleted";break;case"enabledisablecandidateob":url="/onboarding/settings/candidate/enableDisable";break;case"enabledisableemployeeob":url="/onboarding/employee/candidate/enableDisable"}params.IS_VISIBLE=$(obj).is(":checked"),ZPeople.Request.send(url,params,ZPOnboarding.changeSettingStatusResponse)},ZPOnboarding.changeSettingStatusResponse=function(data,params){"success"==data.msg&&(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatedsuccessfully")),"onbWorkflow"==params.method&&(params.IS_VISIBLE?ZPOnboarding.isOnboarding=!1:ZPOnboarding.isOnboarding=!0),"onbreminder"==params.method&&data.templateid&&(ZPOnboarding.candonbRemData={invoke_days:2,invoke_time:"09:00 AM",onboarding_type:params.onboarding_type,reminder_period:1,isrepeat:!1},$("#candonbremtemp").replaceWith("<a onclick=\"ZPOnboarding.onboardinggetReminder('"+data.templateid+"','"+ZPOnboarding.candformid+"')\">"+ZPI18N.getString("zp.candonbreminder")+"</a>")))},ZPOnboarding.editMailAklertTemplate=function(templateId,formid,isCandidate){ZPOnboarding.iscandidateemail=isCandidate,Layout.Page.container.find("#mailalert").html(""),Mailalerts.edit(templateId,formid),Layout.Page.container.find("#mailalert").removeClass("DN"),Layout.Page.container.find("#mailalert #malertBodyCont #dvShowmail").remove(),Layout.Page.container.find("#mailalert #malertBodyCont #recTempAttDiv").remove(),Layout.Page.container.find("#mailalert #malertBodyCont #toInputTag").closest(".form-group").addClass("NM OP5"),Layout.Page.container.find("#mailalert #mailAlertFormId").addClass("DN"),Layout.Page.container.find("#mailalert #mAlertName").closest(".form-group").addClass("NM OP5"),Layout.Page.container.find("#mailalert #malertBodyCont #messageOptDiv #newTemplateDiv").closest(".form-group").addClass("DN"),Layout.Page.container.find("#mailalert #malertBodyCont #tempListDD").hide()},ZPOnboarding.callbackByAction=function(){Layout.Page.container.find("#mailalert").addClass("DN")},ZPOnboarding.serviceViewPage=function(isedit,html){var pageId=$("#"+Layout.Page.pageId);if(Layout.UrlConf.isServiceMode||Layout.UrlConf.isSystemService||isedit){var categoryprm={serviceName:"Onboarding",conreqcsr:csrfToken,mode:"serviceView"};$.ajax({url:"/fetchServiceDetails.zp",type:"POST",data:categoryprm,success:function(data){data&&0!=Object.keys(data).length?"failure"!==data.status&&(isedit?(ZPServices.Edit.editService(data),pageId.addClass("services")):(html&&(pageId.html(html),pageId.find("select").select2(),$('[data-toggle="popover"]').popover()),pageId.find("#serviceView").removeClass("zp_dyn"),ZPOnboarding.adminViewPage(data))):!isedit&&html&&(pageId.html(html),pageId.find("select").select2(),$('[data-toggle="popover"]').popover(),pageId.find("#profileDiv .zp_serIcn").html('<i id="srvicon" class="zp_Si zp_app44"></i>'),pageId.find("#serviceView").parent().addClass("DN"),pageId.addClass("services"))}})}},ZPOnboarding.failureCallBack=function(err){err.responseText&&err.responseText.includes('id="IAM_SECURITY_ERROR"')?Layout.Page.container.html(err.responseText):ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.sorryservererror")),"setOBStatus"==params.parmode&&Layout.Page.container.find("#onBoardingRightPane").find("#cmpOnboarding").removeAttr("disabled")},ZPOnboarding.showempProfile=function(pageid){var userInfo=ZPeople.getUserDetailsById(erecno),html='<div class="topProfileCon" id="zp_onbprofile_band">';html+='<div class="profileWrapper">',html+='<div class="ZPprofileimg"><div class="PR DIB">',html+='<img class="ssp-img ZPuserimg CP" src="'+ZPeople.CURR_USER.thumb+'" empid="'+ZPeople.CURR_USER.usererec+'" imgtype="normal">',html+='<div class="ssu-status"></div></div></div><div class="ssp-actions zp_pb_act"></div><nav class="ZPuserinfo"><ul>',html+='<li class="username"><span class="in DNI" id="zp_ss_uava"></span>'+userInfo.empid+" - "+userInfo.name+"</li>",userInfo.designation&&(html+='<li><span labelname="Designation">'+userInfo.designation+"</span></li>"),userInfo.deptName&&(html+='<li labelname="Department">'+userInfo.deptName+"</a></li>"),html+='<li><a href="mailto:'+userInfo.email+'">'+userInfo.email+'</a></li><li id="zp_ss_eloc"></li></ul></nav></div></div>',$("#onBoardingRightPane").find("#"+pageid).prepend(html),$("#onBoardingRightPane").find("#zp_onbprofile_band").find(".ZPuserimg").on("click",function(){ZPeople.showProfilePicture(this)}),ZPOnboarding.setCoverImage(ZPOnboarding.onBoardingDetails.coverImageId?ZPOnboarding.onBoardingDetails.coverImageId:0)},ZPOnboarding.setCoverImage=function(coverId){var pageid=$("#onBoardingRightPane").find("#zp_onbprofile_band").find(".profileWrapper");if(coverId>=1&&coverId<=4){var imageUrl="url("+newUIImageUrl+"hed"+coverId+".png) repeat-x";2==coverId?(imageUrl="url("+newUIImageUrl+"hed1.png) repeat-x",pageid.css({background:imageUrl}),pageid.css({"background-color":"#25314b"}),pageid.css({"background-size":"contain"})):(pageid.css({background:imageUrl}),pageid.css({"background-position":"center"}),pageid.css({"background-size":"contain"}))}else{imageUrl="url("+newUIImageUrl+"hed"+coverId+".png) repeat-x";pageid.css("background",imageUrl),pageid.css({"background-position":"50% 99%"}),pageid.css({"background-size":"cover"})}},ZPOnboarding.reopenOnboarding=function(pkid){CPortal.currentPortalZAID?ZPOnboarding.reopenPopup(pkid):$.ajax({type:"POST",async:!1,url:CPortal.candidateURLS.CPORTALURL,data:{conreqcsr:csrfToken},success:function(data){0!=Object.keys(data).length&&void 0!=data.portalName&&(CPortal.currentPortalZAID=data.ZAID,CPortal.portalObj.portalName=data.portalName,ZPOnboarding.reopenPopup(pkid))},error:function(err){ZPOnboarding.failureCallBack(err)}})},ZPOnboarding.reopenPopup=function(pkid){Layout.Page.container.find("#reopenModal").remove();var reopenhtml='<div class="OVA zp_NSPop zp_serDs active" id="reopenModal" candidateid="'+pkid+'"><div class="zp_popInner"><h4>'+ZPI18N.getString("zp.candidateemailcustomise")+'</h4><i class="IC-cls" onclick="ZPOnboarding.closePage()"></i>',userDetails=ZPOnboarding.allReport[pkid].completeDetails,touser=ZPOnboarding.allReport[pkid].reportDetails;reopenhtml+='<div class="zp_formncls" id="reopenEditorContainer"><div class="zp_fm" keyname="to"><label class="zp_mdt">'+ZPI18N.getString("zp.to")+'</label><div class="" id="touser" name="errdiv"><input required="" type="text" selectedids="'+touser.EMAILALIAS+'" style="width: 40px;" id="toid">';var viewUrl=ZPeople.getResourceURL(imageUrl+"user.png");if(userDetails.isphotopresent){var downloadParams={fcId:userDetails.empPhotoFC,recordId:pkid,formId:userDetails.candidateFormId,original:"false"};viewUrl=ZPForm.constructDownloadLink(downloadParams)}reopenhtml+='<div class="zp_Tg" zpmenu="true"><div class="ZP_photo pc5"><img src="'+viewUrl+'" alt="<s"></div>'+touser.USERNAME+"</div>",reopenhtml+='</div></div><div class="zp_fm" keyname="cc"><label class="">'+ZPI18N.getString("zp.cc")+'</label><div id="ccuser"><input required="" id="ccuserinp" type="text" style="width: 74px;"></div></div>',reopenhtml+='<div class="zp_fm" keyname="subject"><label class="zp_mdt">'+ZPI18N.getString("zp.subject")+'</label><div class="" name="errdiv"><input required="" type="text" value="'+ZPI18N.getString("zp.reopendefaultsubject",[ZPeople.ORGLIST.currServiceOrg])+'"></div></div>',reopenhtml+='<div class="zp_fm zp_fmds" keyname="message"><label>'+ZPI18N.getString("zp.message")+'</label><div id="descEditor" class="nobdr"></div></div>',reopenhtml+=CommonTemplates.chooseFileHtml(!0),reopenhtml+='</div><div class="zp_btn"><button class="zpthm" onclick="ZPOnboarding.sendreopen(this)">Reopen</button><button onclick="ZPOnboarding.closePage()">Cancel</button></div></div></div>',Layout.Page.container.append($(reopenhtml)),NewZPOnboarding.editorConstruct("descEditor",!0,"descContent",!0),NewZPOnboarding.replaceWithEditor("reopenEditorContainer","descEditor",!0);var portalurl=window.location.href.split("/"+portalname)[0];portalurl+="/"+CPortal.portalObj.portalName+ZPOnboarding.CONSTANTS.CPORTAL_CONTEXT+"/preonboarding";var mailcontent="<div>Dear "+touser.USERNAME+"<br></div>";mailcontent+='<div><br></div><div>You have missed entering some important details in the onboarding process.<br></div><div>Click <a target="_blank" href="'+portalurl+'">here</a>&nbsp;to re-access and complete your onboarding.<br></div>',ZPFeeds.Editor.editorList.descEditor.setContent(mailcontent),$("#hcDFile").off("click").on("click",function(){ZPOnboarding.fileUploadfn({id:"0"},$(this),"reopenEditorContainer")}),$("#hcCFile").off("click").on("click",function(){ZPOnboarding.fileUploadfn({id:"1"},$(this),"reopenEditorContainer")});var empproperties=[];ZPeople.ALL_USER_LOADED?ZPeople.ALL_USERLIST:ZPeople.sendUserListAjax(null,null,!0),$.each(ZPeople.ALL_USERLIST,function(userInd,user){ZSEC.Encoder.encodeForHTML(user.email);var empprop={id:user.usererec,value:user.name};empproperties.push(empprop)}),$('[data-toggle="popover"]').popover(),CommonTemplates.getSelectMenu({id:"selectccList",data:empproperties,checkbox:!0},Layout.Page.container.find("[id=ccuser]"),{id:"ccuserinp",placeholder:""},{isMandatory:!0,inputHeaderName:""})},ZPOnboarding.closePage=function(){Layout.Page.container.find("#reopenModal").removeClass("active")},ZPOnboarding.sendreopen=function(obj){var reopendiv=$(obj).parents("#reopenModal"),inp=$(reopendiv).find("[keyname], .fAttach"),params={},iserror=!1;if($(reopendiv).find("[name=errdiv]").removeClass("zp_err"),$(reopendiv).find("[name=errspan]").remove(),$.each(inp,function(){var keyname=$(this).attr("keyname");$.inArray(keyname,["to","cc"])>-1?val=$(this).find("input").attr("selectedids"):val=$(this).find("input").val(),void 0==val&&(val=""),""==val.trim()&&$(this).find("label").hasClass("zp_mdt")?(iserror=!0,$(this).find("[name=errdiv]").addClass("zp_err"),$('<span class="etxt" name="errspan">Please enter a value</span>').insertAfter(this)):params[keyname]=val}),!iserror){var editor=ZPFeeds.Editor.editorList.descEditor;if(void 0!=editor&&(reopenDesc=ZPFeeds.getSmileysAndMentions(editor.getContent(),!1)),0==$(reopenDesc).text().length)iserror=!0,$(this).find("[name=errdiv]").addClass("zp_err"),$('<span class="etxt" name="errspan">Please enter a value</span>').insertAfter(this);else{params.message=reopenDesc;var formdata=new FormData;if(formdata.append("candidateid",$(reopendiv).attr("candidateid")),formdata.append("conreqcsr",csrfToken),formdata.append("mailjson",JSON.stringify(params)),$("div.attachedFile").length>0){var uploadFromCloud=[],uploadFromWD=[],attind=1;$("#reopenEditorContainer  div.attachedFile").each(function(i){var uploadMode=$(this).data("uploadMode"),cloudUploadDoc=$(this).data("cloudUploadDoc"),WDUploadDoc=$(this).data("WDUploadDoc"),fileUpload=$(this).data("fileUpload");"cloudUpload"==uploadMode?uploadFromCloud.push(cloudUploadDoc):"localUpload"==uploadMode&&void 0!==fileUpload?formdata.append("attachment"+attind++,fileUpload):"workDriveUpload"==uploadMode&&void 0!==WDUploadDoc&&uploadFromWD.push(WDUploadDoc)}),formdata.append("uploadFromCloud",JSON.stringify(uploadFromCloud)),formdata.append("uploadFromWD",JSON.stringify(uploadFromWD))}$.ajax({url:"/onboarding/reports/reopen",type:"POST",data:formdata,contentType:!1,processData:!1,cache:!1,error:function(xhr){CommonTemplates.saveComplete("submitCaseBtn");var error_response=JSON.parse(xhr.responseText);ZPeople.Message.showFailureMsg(error_response.error)},success:function(data){ZPOnboarding.reopensuccess(data)}})}}},ZPOnboarding.reopensuccess=function(data){data.msg==zpconst.CommonMessages.SUCCESSMSG?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatedsuccessfully")),ZPOnboarding.closePage(),Layout.Page.container.find("#userOnboardingDetails").find(".close").click(),Layout.Page.container.find("#emp_completed_onboarding").find(".ongoing").text(parseInt(Layout.Page.container.find("#emp_completed_onboarding").find(".ongoing").text())-1),Layout.Page.container.find("#emp_ongoing_onboarding").find(".ongoing").text(parseInt(Layout.Page.container.find("#emp_ongoing_onboarding").find(".ongoing").text())+1),ZPOnboarding.reloadData()):void 0!=data.msg?ZPeople.Message.showFailureMsg(data.msg):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror"))},ZPOnboarding.fileUploadfn=function(obj,currentDiv,parentId){if("0"==obj.id)$("#hcBrowseFile").trigger("click"),$("#hcBrowseFile").off("change").on("change",function(){var parentDiv=$(currentDiv).closest("#"+parentId);if($(parentDiv).find("div.attachedFile:not(.zp_dyn)").length+$("#hcBrowseFile")[0].files.length>5)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.maxfileupload"));else{var files=$(this)[0].files;if($(parentDiv).find("#attchedFiles").length<=0){$(parentDiv).find("#fAtch").siblings(".zp_note").after('<div id="attchedFiles" class="zp_Alst clearfix"></div>')}$.each(files,function(i){CommonTemplates.getFileBoxOnSelect(this,function(html,file,url){if($(parentDiv).find("#attchedFiles").append(html),$(parentDiv).find("div.attachedFile").length>0){$(parentDiv).find("div.attachedFile").last();$(parentDiv).find("div.attachedFile").last().data("uploadMode","localUpload"),$(parentDiv).find("div.attachedFile").last().data("fileUpload",file),$(parentDiv).find("div.attachedFile").last().offset().top>$(parentDiv).scrollTop()&&$(parentDiv).scrollTop($(parentDiv).find("div.attachedFile").last().offset().top)}})})}});else if("1"==obj.id){var mode="addreopenfile";Files.showCloudPickerModal(ZPeople.cloudPickerGadgetsUrl,mode)}else if("2"==obj.id){mode="addreopenfile";Files.showWorkDriveModal(mode)}},ZPOnboarding.addFileTag=function(filename,fileJsonObj,mode){Layout.Page.container;var parentId="reopenEditorContainer",fileObj={name:filename,type:Files.uploadMode};if($("[id="+parentId+"]").find("#attchedFiles").length<=0){$("[id="+parentId+"]").find("#fAtch").siblings(".zp_note").after('<div id="attchedFiles" class="zp_Alst clearfix"></div>')}$("[id="+parentId+"]").find("div.attachedFile").length<5?CommonTemplates.getFileBoxOnSelect(fileObj,function(html,file){$("[id="+parentId+"]").find("#attchedFiles").append(html),$("[id="+parentId+"]").find("div.attachedFile").last().offset().top>$("[id="+parentId+"]").scrollTop()&&$("[id="+parentId+"]").scrollTop($("[id="+parentId+"]").find("div.attachedFile").last().offset().top)}):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.maxfileupload")),$("[id="+parentId+"]").find("div.attachedFile").last().data("uploadMode",Files.uploadMode),"workDriveUpload"==Files.uploadMode?$("[id="+parentId+"]").find("div.attachedFile").last().data("WDUploadDoc",fileJsonObj):"cloudUpload"==Files.uploadMode&&$("[id="+parentId+"]").find("div.attachedFile").last().data("cloudUploadDoc",fileJsonObj)},ZPOnboarding.exportResponse=function(data){data.isSuccess||ZPeople.Message.showFailureMsg(data.message)},ZPOnboarding.reportExport=function(obj,ftype){var searchJson={};if($(obj).addClass("disabled"),setTimeout(function(){$(obj).removeClass("disabled")},500),0==$("#zp_export_ob").length){var fObj='<form id="zp_export_ob" action="/onboarding/reports/export" method="post" name="zp_export_ob" style="display: none;" target="exportresp">';$("#wrapper").append(fObj)}Layout.Page.container.find("#filterOption").find("input[id*=_input]").each(function(){var filterVal=$(this).val(),filterName=$(this).attr("id").split("_input")[0];ZPOnboarding.isCandReportPage&&(filterName=filterName.split("_CAND")[0]),"DATEOFJOINING"===filterName?""!=filterVal.trim()&&(searchJson[filterName]=filterVal):"EMPLOYEE_NAME"===filterName||"CANDIDATE_NAME"===filterName?""!=filterVal.trim()&&(searchJson[filterName]=filterVal):CommonTemplates.toCheckEmpty($(this).attr("id"),searchJson,filterName)}),0==Object.keys(searchJson).length&&(Layout.Page.container.find("#filterOption").find(".zp_lnk").length<=0?ZPOnboarding.initiateFilter(!0):ZPOnboarding.setDefaultFilter(),Layout.Page.container.find("#filterOption").find("input[id*=_input]").each(function(){var filterVal=$(this).val(),filterName=$(this).attr("id").split("_input")[0];ZPOnboarding.isCandReportPage&&(filterName=filterName.split("_CAND")[0]),"DATEOFJOINING"===filterName?""!=filterVal.trim()&&(searchJson[filterName]=filterVal):"EMPLOYEE_NAME"===filterName||"CANDIDATE_NAME"===filterName?""!=filterVal.trim()&&(searchJson[filterName]=filterVal):CommonTemplates.toCheckEmpty($(this).attr("id"),searchJson,filterName)})),(fObj=$("#zp_export_ob").html("")).append('<input type="hidden" value="'+ZPOnboarding.currentReportType()+'" name="reportType"/>'),fObj.append('<input type="hidden" value="filterData" name="parmode"/>'),fObj.append('<input type="hidden" value="'+ftype+'" name="ftype"/>');ZPOnboarding.currentReportType();fObj.append('<input type="hidden" value=\''+JSON.stringify(searchJson)+'\' name="searchJson"/>'),fObj.append('<input type="hidden" value="'+csrfToken+'" name="'+csrfParamName+'"/>'),fObj.submit()},ZPOnboarding.showcandstatus=function(){ZPOnboarding.reportId=window.location.href.split("/").pop().split("-").pop();var type=Layout.Page.hash.indexOf("employee")>-1?"employee":"candidate",href="#onboarding/reports/"+type;$("#zp_t_onboarding_reports_"+type).attr("href",href),window.location.href=href},ZPOnboarding.addformul=function(selectform){var mandforms=ZPOnboarding.configdata.Forms.tabSpecificData.mandForms,formHtml='<ul name="formsul">';formHtml+='<li><i name="sortdiv" class="CR-drag"></i></li>',formHtml+='<li><div id="selectFormDiv" class="zp_fm">';var optionhtml='<select><option value="">-'+ZPI18N.getString("zp.select")+"-</option>";return $.each(ZPOnboarding.config.forms,function(formInd,form){var selected=selectform==form.formId?"selected":"";optionhtml+='<option value="'+form.formId+'" '+selected+">"+form.formName+"</option>"}),formHtml+=(optionhtml+="</select>")+"</li>",formHtml+='<li><label class="toground MT4">',formHtml+='<input id="ismand" class="cmn-toggle-small cmn-toggle-round-small" type="checkbox" '+(void 0!=mandforms&&mandforms.indexOf(selectform)>=0?"checked":"")+'><span class="M0"></span></label>',formHtml+="</li>",formHtml+='<li class="zp_actIcns"><i class="IC-plus-big grn" onclick="ZPOnboarding.addformtab(this)"></i><i class="IC-delete-1px rd" onclick="ZPOnboarding.deleteformtab(this)"></i></li>',formHtml+="</ul>"},ZPOnboarding.addformtab=function(obj){var formhtml=ZPOnboarding.addformul("");$(formhtml).insertAfter($(obj).parents("ul")),$(obj).parents("ul").next("ul").find("select").select2();var formsortdiv=Layout.Page.container.find("#chooseForms");$(formsortdiv).sortable({items:"ul[name=formsul]",handle:$(formsortdiv).find("ul[name=formsul] li [name=sortdiv]")})},ZPOnboarding.deleteformtab=function(obj){$(obj).parents("#chooseForms").find("ul[name=formsul]").length>1&&$(obj).parents("ul[name=formsul]").remove()},ZPOnboarding.addLMSCourse=function(){$.each(ZPOnboarding.selectedlmsdetails,function(index,lmsinfo){if(0==Layout.Page.container.find("#onblmscourses").find("#"+lmsinfo.courseId).length){void 0==lmsinfo.courseImage?Math.floor(Math.random()*Math.floor(44))+1:lmsinfo.courseImage;var bgclass="zp_Crh";lmsinfo.isSystem||(bgclass="zp_Crh CBg"+lmsinfo.bannerBGData.clrId);var onclick='window.open("training#lms-view/course/'+lmsinfo.courseId+'/overview","_blank")',courseImageUrl=lmsinfo.isSystem?ZPOnboarding.generateSourceURL(lmsinfo.courseImageInfo):ZPOnboarding.generateRandomCourseImage(lmsinfo.courseImageInfo),selectedcourseshtml='<div class="zp_Cr crdlv" id="'+lmsinfo.courseId+'"> <div style="background: url('+courseImageUrl+') right/cover" class="'+bgclass+'"  onclick='+onclick+"></div>";selectedcourseshtml+='<div class="zp_Crf"> <font class="zp_ftr"><i class="IC-tick2 non_md" ismandatory="false" onclick="ZPOnboarding.changeLMSstatus(this)" ></i><p>'+ZPI18N.getString("zp.mandatorycourse")+"</p></font></div>",selectedcourseshtml+='<div class="zp_Crc"  onclick='+onclick+'></i><label><em class="zp_ldot">'+ZPI18N.getString("zp.lms.settings.SelfPaced")+'</em></label><h4><i class=""></i>'+lmsinfo.courseName+"</h4>",void 0!=lmsinfo.description&&(selectedcourseshtml+='<p title="'+lmsinfo.description+'">'+lmsinfo.description+"</p>"),selectedcourseshtml+='</div><i class="IC-cls" onclick="ZPOnboarding.removeLMSCourse(this)"></i></div>',Layout.Page.container.find("#onblmscourses").append(selectedcourseshtml)}}),$("#onblmssearch").remove(),Layout.Page.container.find("#onblmssearchbtn").prop("disabled",!1)},ZPOnboarding.generateSourceURL=function(fileInfo,isThumbnail){fileInfo.extension=fileInfo.extension||function(fileName){let startIndex=fileName.lastIndexOf(".");return startIndex>-1?fileName.slice(startIndex):""}(fileInfo.name),fileInfo.fileType=fileInfo.fileType||function(type,extension){extension.indexOf(".")&&(extension="."+extension);extension=","+extension+",";var fileType="unknown";type.indexOf("image")>-1?fileType="image":""==type&&",.,"==extension||(fileType="others");return fileType}(fileInfo.type,fileInfo.extension),fileInfo.additionalInfo=fileInfo.additionalInfo||{fileId:fileInfo.contentId,type:0};var previewType=isThumbnail?"thumbnail":fileInfo.fileType,additionalInfo=fileInfo.additionalInfo;if("image"==previewType)return function(contentId,previewType,additionalInfo){var url=previewEngineUrl+"/";"image"==previewType&&(url+=previewType+"/"+previewServiceId+"/"+contentId);let params={moduleName:"LMS",fileId:additionalInfo.fileId,type:additionalInfo.type,portalId:_LOGGEDIN_ACCZSOID};return url+"?cli-msg="+encodeURIComponent(btoa(JSON.stringify(params)))+"&frameorigin="+window.location.origin}(fileInfo.contentId,previewType,additionalInfo)},ZPOnboarding.generateRandomCourseImage=function(imageInfo){if(imageInfo.courseImageUrl&&""!=imageInfo.courseImageUrl)return imageInfo.courseImageUrl;{let random=Math.floor(Math.random()*Math.floor(44));return random+=1,ZPeople.getResourceURL(hrImageUrl+"lmsbg/cat"+random+".svg")}},ZPOnboarding.removeLMSCourse=function(obj){$(obj).closest(".crdlv").remove()},ZPOnboarding.changeLMSstatus=function(obj){"false"==$(obj).attr("ismandatory")?($(obj).attr("ismandatory",!0),$(obj).removeClass("non_md")):($(obj).attr("ismandatory",!1),$(obj).addClass("non_md"))},ZPOnboarding.searchPopupLMS=function(data){void 0==data?ZPeople.Request.send("/courseAction.zp",{method:"getCourseDetails",start:"0",courseFor:"onBoarding",coursetype:"1"},ZPOnboarding.searchPopupLMS):ZPOnboarding.constructsearchPopupLMS(data,!1),Layout.Page.container.find("#onblmssearchbtn").prop("disabled",!0)},ZPOnboarding.constructsearchPopupLMS=function(data,isfromsearch){if(!isfromsearch){ZPOnboarding.selectedlmsdetails={};var html='<div class="zp_msk training" id="onblmssearch"><div class="zp_popup" id="zp_poptnnne" style="width:600px; height: 92%;">';html+='<div class="zp_Pohd"><font>'+ZPI18N.getString("zp.lms.course.coursecreate")+'</font><i class="IC-cls" onclick="ZPOnboarding.closePopupLMS()"></i></div>',html+='<div id="" class="zp_Sm"><div><i class="IC-srch"></i><input required="" id="onblmssearchtext" placeholder="'+ZPI18N.getString("zp.lms.learningplan.searchcoursename")+'" type="text" value=""></div></div>',html+='<div class="zp_Pocnt" style=" height: calc(100% - 220px);">',html+='<ul class="zp_CPlst" id="onblmslist">',html+='</ul></div><div class="zp_popbtm"><div class="zp_btn"><button class="zpthm" onclick="ZPOnboarding.addLMSCourse()">'+ZPI18N.getString("zp.save")+"</button></div></div></div></div>",$("#zp-contwrap-onboarding-flow-employeeflow").append(html),$("#zp-contwrap-onboarding-flow-employeeflow").find("#onblmssearchtext").off("keyup"),$("#zp-contwrap-onboarding-flow-employeeflow").find("#onblmssearchtext").on("keyup",function(){$("#onblmssearch");var searchtxt=this.value,params={method:"getCourseDetails",start:"0",courseFor:"onBoarding",coursetype:"1"};searchtxt&&(params.searchtxt=searchtxt),ZPeople.Request.send("/courseAction.zp",params,ZPOnboarding.searchCourse)})}$("#onblmslist").html(""),$.each(data[1],function(index,lmsinfo){var courseList="",sel="",src="";lmsinfo.courseImageInfo.isSystemImage?src=ZPOnboarding.generateRandomCourseImage(lmsinfo.courseImageInfo):(lmsinfo.courseImageInfo.additionalInfo={fileId:lmsinfo.courseId,type:6},src=ZPOnboarding.generateSourceURL(lmsinfo.courseImageInfo)),(Layout.Page.container.find("#onblmscourses").find("#"+lmsinfo.courseId).length>0||ZPOnboarding.selectedlmsdetails.hasOwnProperty(lmsinfo.courseId))&&(sel="sel"),courseList+='<li id="'+lmsinfo.courseId+'" onclick='+onclick+' class="onblmsname"><div class="ZP_photo"><img src="'+src+'"></div><h4 >'+lmsinfo.courseName+'</h4><div class="zp_micn"><ul><li class="'+sel+'"><b><span><i class="IC-tck"></i></span></b></li></ul></div></li>',$("#onblmslist").append(courseList),0==Layout.Page.container.find("#onblmscourses").find("#"+lmsinfo.courseId).length&&$("#onblmslist").find("#"+lmsinfo.courseId).on("click",function(event){0==$("#onblmssearch").find("#"+lmsinfo.courseId).find("ul").find(".sel").length?($("#onblmssearch").find("#"+lmsinfo.courseId).find("li").addClass("sel"),ZPOnboarding.selectedlmsdetails[lmsinfo.courseId]=lmsinfo):($("#onblmssearch").find("#"+lmsinfo.courseId).find("li").removeClass("sel"),delete ZPOnboarding.selectedlmsdetails[lmsinfo.courseId])})}),0==$("#onblmslist").find(".onblmsname").length&&(isfromsearch?$("#onblmslist").html(ZPI18N.getString("zp.lms.nodatafound")):$("#onblmslist").html(ZPI18N.getString("zp.nocourseaddnew",["window.open('zp#lms-admin/mycourses','_blank')"])))},ZPOnboarding.closePopupLMS=function(value){value&&ZPOnboarding.addLMSCourse(value),$("#onblmssearch").remove(),Layout.Page.container.find("#onblmssearchbtn").prop("disabled",!1)},ZPOnboarding.LMS_Course=function(json){if(ZPOnboarding.isPreview){selectedcourseshtml='<div class="zo_Httl"><h2>Courses</h2><i class="OB-user1 zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div><div class="zo_tCont chseCrd PL40">';selectedcourseshtml+=Layout.Page.container.find("#onblmscourses").html(),selectedcourseshtml+="</div>",Layout.Page.container.find("#onBoardingRightPane").find('[data-click="LMS_Course"]').html(selectedcourseshtml),Layout.Page.container.find("#onBoardingRightPane").find('[data-click="LMS_Course"]').find(".zp_Crh").removeAttr("onclick"),Layout.Page.container.find("#onBoardingRightPane").find('[data-click="LMS_Course"]').find(".zp_Crc").removeAttr("onclick"),Layout.Page.container.find("#onBoardingRightPane").find('[data-click="LMS_Course"]').find(".zp_ftr").html('<i class="IC-pending"></i><p>'+ZPI18N.getString("zp.pending")+"</p>"),Layout.Page.container.find("#onBoardingRightPane").find('[data-click="LMS_Course"]').find(".IC-cls").remove()}else{var selectedcourseshtml='<div class="zo_Httl"><h2>'+ZPOnboarding.tabsJson.LMS_Course.tabCols.DISPLAY_NAME+'</h2><i class="OB-user1 zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div><div class="zo_tCont chseCrd PL40">';$.each(json,function(index,course){var lmsinfo=course.courseBasicDetails[0].courseInfo[0],onclick='window.open("training#lms-view/course/'+lmsinfo.courseId+'/overview","_blank")';void 0==lmsinfo.courseImage?Math.floor(Math.random()*Math.floor(44)):lmsinfo.courseImage;var bgclass="zp_Crh";lmsinfo.isSystem||(bgclass="zp_Crh CBg"+lmsinfo.bannerBGData.clrId);var coursecompleted='<font class="zp_ftr"><i class="IC-pending"></i><p>'+ZPI18N.getString("zp.pending")+"</p></font>";lmsinfo.userCoursecompletedate&&(coursecompleted='<font class="zp_ftr cmpled"><i class="IC-tick2"></i><p>'+ZPI18N.getString("zp.completed")+"</p></font>"),lmsinfo.isSystem&&(lmsinfo.courseImageInfo.additionalInfo={fileId:lmsinfo.courseId,type:6});var courseImageUrl=lmsinfo.isSystem?ZPOnboarding.generateSourceURL(lmsinfo.courseImageInfo):ZPOnboarding.generateRandomCourseImage(lmsinfo.courseImageInfo);selectedcourseshtml+='<div class="zp_Cr crdlv" id="'+lmsinfo.courseId+'" onclick='+onclick+'> <div style="background: url('+courseImageUrl+') right/cover" class="'+bgclass+'"></div>',selectedcourseshtml+='<div class="zp_Crf">'+coursecompleted+"</div>",selectedcourseshtml+='<div class="zp_Crc"></i><label><em class="zp_ldot">'+ZPI18N.getString("zp.lms.settings.SelfPaced")+'</em></label><h4><i class=""></i>'+lmsinfo.courseName+"</h4>",void 0!=lmsinfo.description&&(selectedcourseshtml+='<p title="'+lmsinfo.description+'">'+lmsinfo.description+"</p>"),selectedcourseshtml+="</div></div>"}),selectedcourseshtml+="</div>",Layout.Page.container.find("#onBoardingRightPane").find('[data-click="LMS_Course"]').html(selectedcourseshtml);var params={parmode:"tabContent",submode:"LMS_Course",isPreview:ZPOnboarding.isPreview};ZPeople.Request.send("/onboarding/pre/tabContent",params,ZPOnboarding.updatecoursestatus)}},ZPOnboarding.searchCourse=function(data){ZPOnboarding.constructsearchPopupLMS(data,!0)},ZPOnboarding.updatecoursestatus=function(data){$.each(data,function(courseid,coursestatus){coursestatus&&Layout.Page.container.find("#onBoardingRightPane").find('[data-click="LMS_Course"]').find("#"+courseid).find(".zp_Crf").html('<font class="zp_ftr cmpled"><i class="IC-tick2"></i><p>'+ZPI18N.getString("zp.completed")+"</p></font>")})},ZPOnboarding.updateOnbCourseStatus=function(data){data.courseid&&0!=Layout.Page.container.find("#onBoardingRightPane").length&&Layout.Page.container.find("#onBoardingRightPane").find('[data-click="LMS_Course"]').find("#"+data.courseid).find(".zp_Crf").html('<font class="zp_ftr cmpled"><i class="IC-tick2"></i><p>'+ZPI18N.getString("zp.completed")+"</p></font>")},ZPOnboarding.updatetdojdays=function(obj){var tdays,tdojdays=$(obj).val().trim(),iserror=!1;tdojdays!=ZPOnboarding.tdays&&(tdojdays?isNaN(tdojdays)||(0|tdojdays)!=tdojdays?(ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.enteravalidnumber")),iserror=!0):tdojdays>180?(ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.tdojgreater",[180])),iserror=!0):tdojdays<0?(ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.tdojless",[0])),iserror=!0):tdays=parseInt(tdojdays):tdays=void 0,iserror||(""!=tdays?Layout.Page.container.find("#completiontime").show():Layout.Page.container.find("#completiontime").hide(),ZPeople.Request.send("/onboarding/settings/updateDOJInterval",{days:tdays},ZPOnboarding.updatetdojdaysresponse)))},ZPOnboarding.updatetdojtime=function(obj){$(obj).attr("id");$.ajax({type:"POST",async:!1,url:"/onboarding/settings/updateTOJDeadline",data:{invoke_time:$(obj).val(),conreqcsr:csrfToken},success:function(data){"success"==data.msg&&ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatedsuccessfully"))},error:function(err){ZPOnboarding.failureCallBack(err)}})},ZPOnboarding.updatetdojdaysresponse=function(data,params){data.msg==zpconst.CommonMessages.SUCCESSMSG?(ZPOnboarding.tdays=params.days,ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatedsuccessfully"))):ZPeople.Message.showWarningMsg(data.msg)},ZPOnboarding.onboardinggetReminder=function(templateId,formid){Layout.Page.container.find("#mailalert").html(""),Mailalerts.edit(templateId,formid),onbremdata=ZPOnboarding.candonbRemData,Layout.Page.container.find("#mailalert").removeClass("DN"),Layout.Page.container.find("#mailalert #malertBodyCont #dvShowmail").remove(),Layout.Page.container.find("#mailalert #malertBodyCont #recTempAttDiv").remove(),Layout.Page.container.find("#mailalert #malertBodyCont #toInputTag").closest(".form-group").addClass("NM OP5"),Layout.Page.container.find("#mailalert #mailAlertFormId").addClass("DN"),Layout.Page.container.find("#mailalert #mailAlertNameDiv").addClass("DN"),Layout.Page.container.find("#mailalert #malertBodyCont #messageOptDiv #newTemplateDiv").closest(".form-group").addClass("DN"),Layout.Page.container.find("#mailalert #malertBodyCont #tempListDD").hide();var html1='</label></div><div class="form-group col-md-5"><input type="text" id="onbinvokedays" class="form-control"><div name="errormsg" class="dverrormsg"></div></div><div class="col-md-3 MT5"><label class="control-label">',html='<div name="row" id="onboardingRemDays" class="row"><div class="col-md-3 MT5"><label class="control-label">'+ZPI18N.getString("zp.sndonbrem",[html1])+"</label></div></div>";html+='<div name="row" id="onboardingRemTime" class="row"><div class="col-md-3 MT5"><label class="control-label">'+ZPI18N.getString("zp.workflow.timeofexe")+'</label></div><div class="form-group col-md-5">',html+='<select id="onbinvoketime">';for(var j=0,i=0;i<48;i++){var hh=j<10?"0"+j:""+j;24==i&&(j=0),0==hh&&(hh="12");var time=hh+":"+(i%2==0?"00":"30")+" "+(i<24?"AM":"PM");html+='<option value="'+time+'">'+time+"</option>",j+=i%2}var isrepeat="0",hiderepeatdiv="DN";ZPOnboarding.candonbRemData.isrepeat&&(isrepeat="1",hiderepeatdiv=""),html+="</select> </div></div>",html+='<div name="row" id="onboardingfrequency" class="row"><div class="col-md-3 MT5"><label class="control-label">'+ZPI18N.getString("zp.frequency")+'</label></div><div class="form-group col-md-5"><select id="onbfrequency" onchange="ZPOnboarding.changeRepeatDiv()"><option value="0">'+ZPI18N.getString("zp.schonce")+'</option><option value="1">'+ZPI18N.getString("zp.repeat")+"</option></select></div></div>",html1='</label></div><div class="form-group col-md-5"><input type="text" id="onbrepeatdays" class="form-control"><div name="errormsg" class="dverrormsg"></div></div><div class="col-md-3 MT5"><label class="control-label">',html+='<div name="row" id="remonbrepeat" class="row '+hiderepeatdiv+'"><div class="col-md-3 MT5"><label class="control-label">'+ZPI18N.getString("zp.repeatonb",[html1])+"</label></div></div>",Layout.Page.container.find("#mailalert #mailAlertNameDiv").after(html),ZPOnboarding.candonbRemData.isrepeat&&(Layout.Page.container.find("#remonbrepeat").prop("checked",!0),Layout.Page.container.find("#onbrepeatdiv").removeClass("DN")),Layout.Page.container.find("#mailalert").find("#onbrepeatdays").val(onbremdata.reminder_period),Layout.Page.container.find("#mailalert").find("#onbinvoketime").val(onbremdata.invoke_time),Layout.Page.container.find("#mailalert").find("#onbinvokedays").val(onbremdata.invoke_days),Layout.Page.container.find("#mailalert").find("#onbfrequency").val(isrepeat),Layout.Page.container.find("#mailalert").find("#onbinvoketime,#onbfrequency").select2(),Layout.Page.container.find("#mailalert").find("#saveBtn").attr("onclick","ZPOnboarding.onboardingReminderSave()")},ZPOnboarding.onboardingReminderSave=function(){Layout.Page.container.find("#mailalert").find(".dverrormsg").html("");var invokeday=Layout.Page.container.find("#mailalert").find("#onbinvokedays").val(),iserror=!1;invokeday&&!isNaN(invokeday)&&(0|invokeday)==invokeday||(Layout.Page.container.find("#mailalert").find("#onboardingRemDays").find(".dverrormsg").html(ZPI18N.getString("zp.enteravalidnumber")),iserror=!0);var repeatperiod,invoketime=Layout.Page.container.find("#mailalert").find("#onbinvoketime").val(),isrepeat=1==Layout.Page.container.find("#onbfrequency").val();if(isrepeat&&((repeatperiod=Layout.Page.container.find("#mailalert").find("#onbrepeatdays").val())&&!isNaN(repeatperiod)&&(0|repeatperiod)==repeatperiod||(Layout.Page.container.find("#mailalert").find("#remonbrepeat").find(".dverrormsg").html(ZPI18N.getString("zp.enteravalidnumber")),iserror=!0)),!iserror){var params={invoke_time:invoketime,invoke_days:invokeday,onboarding_type:ZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE,reminder_period:repeatperiod,isrepeat:isrepeat};ZPeople.Request.send("/onboarding/settings/saveReminder",params,ZPOnboarding.onbReminderSaveResponse),Mailalerts.save()}},ZPOnboarding.onbReminderSaveResponse=function(data,params){"success"==data.msg&&(ZPOnboarding.candonbRemData=params)},ZPOnboarding.changeRepeatDiv=function(){1==Layout.Page.container.find("#onbfrequency").val()?Layout.Page.container.find("#remonbrepeat").removeClass("DN"):Layout.Page.container.find("#remonbrepeat").addClass("DN")},ZPOnboarding.clearOnboarding=function(erecnoobj){var pageid=Layout.Page.container;$.ajax({type:"POST",async:!1,url:"/onboarding/reports/clearOnboarding",data:{erecnoobj:erecnoobj,conreqcsr:csrfToken},success:function(data){"success"==data.msg&&ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.removesuccessful")),pageid.find("#usersOptions").addClass("DN"),pageid.find("#licenseDtlsRow").removeClass("DN"),pageid.find("table#userListTable input[name='userRowCheck']").prop("checked",!1)}}),$("#confirmationPopup").find(".modal-header").find('[name="subHeader"]').remove(),$("#confirmationPopup").find(".modal-dialog").addClass("modal-center")},ZPOnboarding.getViewMode=function(){var loadParams={isPageMode:!1,formId:ZPForm.CURRFORM_PARAM.formId,disableUrlTrack:!0,editCallback:formCustom.previewFormCallBack,callback:ZPOnboarding.formEditResponse,formMode:"VIEW",recordId:ZPForm.CURRFORM_PARAM.recordId};Layout.Page.hash="",Layout.Page.hashDtl=void 0,ZPForm.load(loadParams)},ZPOnboarding.completebulkonbcheckbox=function(obj){var style="top: 130px !important";if(0!==Layout.Page.container.find(".zp_sfltr").length&&(style="top: 170px !important"),"masscheckbox"===obj.id){var checkboxes=Layout.Page.container.find(".table-content").find("input[type='checkbox']");if(Layout.Page.container.find("#masscheckbox").is(":checked")){if(checkboxes.prop("checked",!0),0==Layout.Page.container.find(".ZPPsearch").length&&0!==Layout.Page.container.find(".table-content").find("input:checked").length){var html='<div class="ZPPsearch"><div id="ZPPsearchBtn" class="ZPPsearchTop"><a id="submitBtn" class="btn btn-primary ML10" onclick="ZPOnboarding.reports.completebulkonb();">'+ZPI18N.getString("zp.lms.content.Markascompleted")+"</a></div> </div>";$(html).insertAfter(Layout.Page.container.find(".well.ZPPhed")),Layout.Page.container.find(".Scrcont").attr("style",style)}}else checkboxes.prop("checked",!1),Layout.Page.container.find(".ZPPsearch").remove(),Layout.Page.container.find(".Scrcont").removeAttr("style")}else{if(0!==Layout.Page.container.find(".table-content").find("input:checked").length){if(Layout.Page.container.find(".Scrcont").find(".table-body").find(".triggerbtn").find(".btn").remove(),0==Layout.Page.container.find(".ZPPsearch").length){html='<div class="ZPPsearch"><div id="ZPPsearchBtn" class="ZPPsearchTop"><a id="submitBtn" class="btn btn-primary ML10"  onclick="ZPOnboarding.reports.completebulkonb();">'+ZPI18N.getString("zp.lms.content.Markascompleted")+"</a></div> </div>";$(html).insertAfter(Layout.Page.container.find(".well.ZPPhed")),Layout.Page.container.find(".Scrcont").attr("style",style)}}else Layout.Page.container.find(".ZPPsearch").remove(),Layout.Page.container.find(".Scrcont").removeAttr("style");0===Layout.Page.container.find(".Scrcont").find(".table-content").find("input[type='checkbox']").not(":checked").length?Layout.Page.container.find("#masscheckbox").prop("checked",!0):Layout.Page.container.find("#masscheckbox").prop("checked",!1)}},ZPOnboarding.reports.completebulkonb=function(isConfirm){if(isConfirm){var allerecno=[];Layout.Page.container.find(".ZPPsearch").remove(),Layout.Page.container.find(".Scrcont").removeAttr("style"),$.each($(Layout.Page.container).find(".table-content").find("input[type='checkbox']:checked"),function(index,elm){allerecno[index]=$(elm).closest("tr").attr("id")}),allerecno=JSON.stringify(allerecno),params={erecnoobj:allerecno,reportType:ZPOnboarding.currentReportType()},ZPeople.Request.send("/onboarding/reports/bulkComplete",params,ZPOnboarding.handleresultofcmponb)}else message="P_Employee"==ZPOnboarding.currentReportType()?ZPI18N.getString("zp.empconfirmbulkcomp"):ZPI18N.getString("zp.candconfirmbulkcomp"),ZPeople.confirm(!0,ZPI18N.getString("zp.confirmbulkcomp"),message,ZPOnboarding.reports.completebulkonb,!1,!0)},ZPOnboarding.constructFeeds=function(activityObj,likedUsrs){var feedTemplate=ZPFeeds.Construction.constructFeedsTemplates(activityObj);void 0==likedUsrs&&(likedUsrs=$("#onBoardingRightPane:visible").find("[streamid='"+activityObj.actRecId+"']").data());var feedsHtml='<div class="zo_feeds" id="'+ZPeople.CURRENT_VIEWKEY+'"><div class="zo_scrl" id="feedDiv"><ul id="comment_feed" class="zo_feedComments"></ul></div><ul class="zo_cFxd" id="text_area_comment"><li><div class="zo_uPhto"><img src="'+ZPeople.CURR_USER.thumb+'" alt="USER"></div><textarea id="comment_textarea" placeholder="Write a Comment"></textarea>';feedsHtml+="</li></ul></div>",$("#onBoardingRightPane:visible").find('[data-click="Welcome"]').first().html(feedsHtml),$("#onBoardingRightPane:visible").find("#feedDiv").append(feedTemplate),$.each($("#onBoardingRightPane:visible").find("#feedDiv .zp-post-cont").find("[popup=user]"),function(index,obj){if(void 0!=$(obj).attr("href")){var href="/"+$(obj).attr("href");$(obj).attr("href",href)}});var viewMoreText=$("#onBoardingRightPane:visible").find("#feedDiv #view_more_cmts a").html();$("#onBoardingRightPane:visible").find("#feedDiv #view_more_cmts,.zp-post-actions").remove(),$("#onBoardingRightPane:visible").find("#feedDiv #cmtpostcont").remove(),ZPFeeds.Construction.constructComments($("#onBoardingRightPane:visible").find("#comment_feed"),activityObj,activityObj.comments);var styleDiv=activityObj.totalComments<4?'style="display: none;"':"";$("#onBoardingRightPane:visible").find("#bottomcont").append($('<div class="zp-fd-more" id="view_more_cmts" '+styleDiv+' totalcmts="'+activityObj.totalComments+'"><a class="" totalcmts="'+activityObj.totalComments+'">'+viewMoreText+'</a><input type="hidden" id="cmt_morekey" value="'+activityObj.cmt_morekey+'"/><input type="hidden" id="cmt_skey" value="'+activityObj.cmt_skey+'"/><input type="hidden" id="act_type" value="'+activityObj.type+'"/><input type="hidden" id="act_fdk" value="'+activityObj.fdk+'"/></div><div id="comment_feed" comments="'+activityObj.comments.length+'"></div></div>')),void 0!==likedUsrs&&Object.keys(likedUsrs).length>0&&(void 0!=likedUsrs.statusIds[activityObj.actRecId]&&likedUsrs.statusIds[activityObj.actRecId][1]>0&&ZPOnboarding.Feeds.constructLikersName(activityObj.actRecId,likedUsrs.statusIds[activityObj.actRecId],!0,likedUsrs.likedUserDtls),$.each(activityObj.comments,function(commentInd,comment){void 0!=likedUsrs.commentIds[comment.commentId]&&likedUsrs.commentIds[comment.commentId][1]>0&&ZPOnboarding.Feeds.constructLikersName(comment.commentId,likedUsrs.commentIds[comment.commentId],!1,likedUsrs.likedUserDtls)})),$($("#onBoardingRightPane:visible").find("[streamid='"+activityObj.actRecId+"']")).replaceWith(feedTemplate.data({statusIds:likedUsrs.statusIds,likedUserDtls:likedUsrs.likedUserDtls,commentIds:likedUsrs.commentIds})),ZPOnboarding.readOnly||($("#onBoardingRightPane:visible").find("#like_link").off(),$("#onBoardingRightPane:visible").find("#like_link").on("click",function(){ZPFeeds.Like.doLikeAction(this,activityObj.actRecId,activityObj.type,!1)}),$("#onBoardingRightPane:visible").find("#view_more_cmts").off(),$("#onBoardingRightPane:visible").find("#view_more_cmts").on("click",function(){ZPFeeds.Comment.getMoreComments($(this).children("a")),$(this).hide()}),$("#onBoardingRightPane:visible").find("#comment_textarea").on("keyup",function(e){13!=e.which||e.shiftKey||""!=$(this).val().trim()&&(e.stopPropagation(),ZPOnboarding.Feeds.post(activityObj.fdk,activityObj.type,this))})),Layout.Page.container.find("#onBoardingRightPane").find(".zp-fd-box").addClass("FN")},ZPOnboarding.acknowledgeResponse=function(fileId,isLoginUserAck,classname,divclass){Layout.Page.container.find("#onBoardingRightPane").find("li#"+fileId).attr("isLoginUserAck",isLoginUserAck),Layout.Page.container.find("#onBoardingRightPane").find("li#"+fileId).find("#ackicon").attr("class",classname),Layout.Page.container.find("#onBoardingRightPane").find("li#"+fileId).find("#ackicon").parent("div").attr("class","ZPack "+divclass);var agrJson=ZPOnboarding.tabsJson.Agreements;if(policyObj=ZPFRules.findObject(agrJson.tabSpecificData.policies,"fileId",fileId),policyObj.hasloginuserack=isLoginUserAck,!ZPOnboarding.completeTabs.hasOwnProperty("Agreements"))if(isLoginUserAck){if(agrJson.tabCols.ACKNOWLEDGE>0&&(agrJson.tabCols.ACKNOWLEDGE=agrJson.tabCols.ACKNOWLEDGE-1,0==agrJson.tabCols.ACKNOWLEDGE&&0==Layout.Page.container.find("#onBoardingRightPane").find("#agreements li").not(".rejected,.completed").length)){var tabId=agrJson.tabCols.TAB_ID;ZPeople.Request.send("/onboarding/pre/setTabStatus",{tabId:tabId},ZPOnboarding.checkComplete)}}else agrJson.tabCols.ACKNOWLEDGE=agrJson.tabCols.ACKNOWLEDGE>0?agrJson.tabCols.ACKNOWLEDGE+1:1},ZPOnboarding.adminViewPage=function(data){var pageId=$("#"+Layout.Page.pageId);pageId.addClass("services"),pageId.find("#edSrv").off("click").on("click",function(){ZPServices.Edit.editService(data)}),ZPServices.View.basicTabDetails(data),isadmin?(pageId.find("#tgForm").removeClass("zp_dyn"),pageId.find("#tgForm").off("click").on("click",function(){ZPServices.MoveForms.getFormsSlider(ZPServices.SERVICE_JSON,data.id)})):pageId.find("#tgForm").addClass("zp_dyn");var formsList=data.formIds;pageId.find("#sfrmList").empty();var addFrm=ZPServices.View.addFormHtml();addfrm=addFrm.replace("$SERVICEID$",data.id),pageId.find("#sfrmList").append(addfrm),ZPServices.View.viewFormList(formsList,!1),data.hasOwnProperty("FAQ_LIST")&&pageId.find("#FaqView").empty().append(FAQ.faqList(data.FAQ_LIST,!1,!1,"adminView")),pageId.find("#serviceView").removeClass("zp_dyn"),pageId.find("#userServiceView").addClass("zp_dyn")},ZPOnboarding.getLocation=function(){return new Promise((resolve,reject)=>{navigator.geolocation.getCurrentPosition(pos=>{ZPOnboarding.latitude=pos.coords.latitude,ZPOnboarding.longitude=pos.coords.longitude,resolve()},()=>{ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.enableaccesstolocation")),reject()})})},CPortal={usersPageElm:'<div style="display: none;" id="addCand" class="modal popRgtModel modal-right" name="userPopup"><div class="modal-dialog"><div class="modal-content "><div class="modal-header"><a aria-label="Close" data-dismiss="modal" class="close IC-cls-1px red"></a><h6 id="exampleModalLabel" class="modal-title">'+ZPI18N.getString("zp.invitecandidate")+'</h6></div><div class="modal-body" id="bodyDiv"><div class="row"><div class="tab-content col-md-11 MT20 ML5"><div id="formAddEmp" class="tab-pane fade" role="tabpanel" name="addEmpDtls"><p class="section DN">'+ZPI18N.getString("zp.empinfo")+'</p><p class="MB20 DN" id="inviteUsernotes"></p><div class="row"><div id="firstNameParentElm"><label class="col-md-3 MT5 frmmandpos"><sup>*</sup>'+ZPI18N.getString("zp.fname")+'</label><div class="col-md-6 form-group" name="errDiv"><input keyname="candFname" type="text" class="form-control" id="fname"></div></div></div><div class="row" id="lastNameParentElm"><div ismandatory="true"><label class="col-md-3 MT5 frmmandpos"><sup>*</sup>'+ZPI18N.getString("zp.lname")+'</label><div class="col-md-6 form-group" name="errDiv"><input keyname="candLname" type="text" class="form-control" id="lname"></div></div></div><div class="row" id="emailIdParentElm"><div ismandatory="true"><label class="col-md-3 MT5 frmmandpos"><sup>*</sup>'+ZPI18N.getString("zp.emailid")+'</label><div class="col-md-6 form-group" name="errDiv"><input keyname="candMail" type="text" class="form-control" value=""></div></div></div><div class="row" id="locationParentElm" ><div ismandatory="true"><label class="col-md-3 MT5 frmmandpos">'+ZPI18N.getString("zp.location")+'</label><div class="col-md-6 form-group DN" name="errDiv" id="locationgrp"><select keyname="locid" id="locgrp"></select></div></div></div><div class="row" id="desgnParentElm" ><div ismandatory="true"><label class="col-md-3 MT5 frmmandpos">'+ZPI18N.getString("zp.title")+'</label><div class="col-md-6 form-group DN" name="errDiv" id="desgngrp"><select keyname="desid" id="desgrp"></select></div></div></div><div class="row" id="onboardParentElm" style=""><div><label class="col-md-3 MT5 formandpos">'+ZPI18N.getString("zp.triggeronboadring")+'</label><div class="col-md-6 form-group" name="errDiv" id="obgrp"><div class="checkbox checkbox-primary"><input id="onboardChkbox" type="checkbox" keyname="enableOnboarding"><label class="MT6"></label></div></div></div></div></div></div></div></div><div class="modal-footer"> <a class="btn btn-primary" onclick="CPortal.addUser(this)" id="addCandidate">'+ZPI18N.getString("zp.add")+"</a></div></div></div></div>",portalObj:{},currentPortalZAID:"",type:"",multicandPage:'<div id="inviteMultiCandidate" class="modal popRgtModel modal-right" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><a aria-label="Close" data-dismiss="modal" class="close IC-cls-1px red"></a><h6 class="addPopTitle">'+ZPI18N.getString("zp.invitemulticandidate")+'</h6></div><div class="modal-body"><div class="row"><div class="col-md-12 dvMultipleuser"><p class="MB20">'+ZPI18N.getString("zp.invitemultinotes")+'</p><div class="row" id="locationParentElm" style="display:none"><div ismandatory="true"><label class="col-md-3 MT5 frmmandpos">'+ZPI18N.getString("zp.location")+'</label> <%--No I18N--%><div class="col-md-6 form-group" name="errDiv" id="obgrp"></div></div></div><div class="form-group PR"><label class="control-label">'+ZPI18N.getString("zp.candidateeemailids")+'</label><textarea class="taggroup col-md-12" id="bulkmailIdBox" placeholder="Example:michael@zillium.com, sarah@zillium.com, . . . "></textarea></div></div><div class="col-md-12 PT10"><div class="row" id="onboardParentElm" style=""><div><label class="col-md-3 MT5 formandpos">'+ZPI18N.getString("zp.triggeronboadring")+'</label><div class="col-md-6 form-group" name="errDiv" id="onboardinggrp"><div class="checkbox checkbox-primary"><input id="onboardChkbox" type="checkbox" keyname="enableOnboarding"><label class="MT6"></label></div></div></div></div></div></div></div><div class="modal-footer"> <a class="btn btn-primary" name="bulksave" onclick="CPortal.inviteBulkCandidates()">'+ZPI18N.getString("zp.invite")+'</a> <a class="btn btn-default dvslide-cls" data-dismiss="modal">'+ZPI18N.getString("zp.cancel")+"</a></div></div></div></div>",User:{},filter:{},CandLength:0,candformId:"",portalType:"PREONBOARDING",candidatesList:{},passwordtype:0,isautogenpassword:!1,isLastNameMandatory:!0},CPortal.candidatesMethod={GETCLIST:"getCandidatesList",GETADDCDETAILS:"getAddCandidateDetails",ADDCANDIDATE:"addCandidate",BULKINVITE:"bulkInviteCandidates",RESENDINVITATON:"resendInvitation",CHANGELOGINSTATUS:"changeLoginStatus",CONVERTTOCANDIDATE:"convertToCandidate"},CPortal.candidateURLS={CPORTALURL:"/onboarding/portal/fetch",CANDIDATEACTIONURL:"/CandidateAction.zp",ADDPORTALURL:"onboarding/portal/add",UPDATEPORTALURL:"onboarding/portal/update"},CPortal.init=function(data){ZPOnboarding.isCandReportPage=!1,ZPeople.Request.send(CPortal.candidateURLS.CPORTALURL,{},CPortal.constructData)},CPortal.constructData=function(resultData){var pageId=Layout.Page.container;void 0!=resultData&&(Object.keys(resultData).length>0&&void 0!=resultData.portalName?(pageId.find("#portalName").html(resultData.portalName),CPortal.portalObj=resultData,CPortal.currentPortalZAID=resultData.ZAID,CPortal.filter.userStatus=void 0,CPortal.isConvert=resultData.isConvert,ZPeople.Request.send("/onboarding/candidate/list",{start:1,sortByType:"2_0",userStatus:CPortal.filter.userStatus,ZAID:CPortal.currentPortalZAID},CPortal.constructCandidateList),pageId.parent("div").find("#onboarding-settings-flow").remove(),pageId.find("div#usersOptions").addClass("DN"),pageId.find("div#massUpdate,div#resendInvite,div#convertcandtoemp,div#convertcandtoempprofile").hide(),pageId.find("div#dispUserCntTitle,div#licenseDtlsRow").removeClass("DN")):(pageId.find("#candidateListing").addClass("DN"),0==pageId.find(".no_clientportal").length&&pageId.append("<div class=no_clientportal>Add Client Portal in Configuration</div>")))},CPortal.getAddUserListPage=function(type){void 0!=type&&(CPortal.type=type,"invite"===type?ZPeople.Request.send("/onboarding/candidate/components",{},CPortal.addUserModal,{type:type}):"import"===type?ZPeople.ISUNCONFIRMEDACC?ZPeople.showErrorMessageForUnconfirmedAcc():ZPeople.Request.send("/onboarding/candidate/components",{},CPortal.importUser):CPortal.addUserModal(void 0,void 0,{type:type}))},CPortal.addUserModal=function(data,params,others){if(data.errorMessage)ZPeople.Message.showFailureMsg(data.errorMessage);else{0==$("#addCand").length&&$("body").append(CPortal.usersPageElm);var slider=$("#addCand");switch(slider.find("#firstNameParentElm").find("label").html("<sup>*</sup>"+data.firstname),slider.find("#lastNameParentElm").find("label").html("<sup>*</sup>"+data.lastname),slider.find("#emailIdParentElm").find("label").html("<sup>*</sup>"+data.emailname),slider.find("#CID").val(""),slider.find("#fname").val(""),slider.find("#lname").val(""),slider.find("[keyname=candMail]").val(""),slider.find("#onboardChkbox").prop("checked",!1),$("#addCand").find(".dverrormsg").remove(),slider.find("#inviteUsernotes").addClass("DN"),$("#addCand").find("#formAddEmp").find(".form-group").removeClass("has-error"),others.type){case"invite":if(void 0!=data.lastCID?(slider.find("#lastCID").show(),slider.find("#lastCID").html(ZPI18N.getString("zp.lastcid")+" "+data.lastCID)):slider.find("#lastCID").hide(),CPortal.isLastNameMandatory=data.isLnameMandatory,slider.find("#lastNameParentElm").find("sup").toggleClass("DN",!data.isLnameMandatory),slider.find("#emailIdParentElm").find("sup").removeClass("DN"),void 0!=data.locationDetails){slider.find("#locationgrp").removeClass("DN"),slider.find("#locationParentElm").find("label").html(data.locationname);var options='<option value="null">Select</option>';$.each(data.locationDetails,function(locId,locationData){options+='<option value="'+locId+'">'+locationData.recName+"</option>"}),slider.find("#locationgrp select").html(options),slider.find("#locationgrp select").select2()}else slider.find("#locationgrp").addClass("DN");if(void 0!=data.designationDetails){slider.find("#desgngrp").removeClass("DN"),slider.find("#desgnParentElm").find("label").html(data.designationname);options='<option value="null">Select</option>';$.each(data.designationDetails,function(desId,desData){options+='<option value="'+desId+'">'+desData.recName+"</option>"}),slider.find("#desgngrp select").html(options),slider.find("#desgngrp select").select2()}else slider.find("#desgngrp").addClass("DN")}slider.find("#formAddEmp").addClass("active in"),slider.find("#formAddNon").removeClass("active in"),slider.modal()}},CPortal.addUser=function(obj){$("#addCand").find(".dverrormsg").remove(),$("#addCand").find("#formAddEmp").find(".form-group").removeClass("has-error");var bodyDiv=$(obj).parents("#addCand").find("#bodyDiv"),isError=!1;if(bodyDiv.find("[keyname=enableOnboarding]").is(":checked")&&ZPeople.ISUNCONFIRMEDACC)ZPeople.showErrorMessageForUnconfirmedAcc();else{var params={ZAID:CPortal.currentPortalZAID,type:2};$.each(bodyDiv.find("input[keyname]"),function(){var keyname=$(this).attr("keyname");if("enableOnboarding"!==keyname){var keyval=$(this).val();if(params[keyname]=null!=keyval?keyval.trim():keyval,null!=keyval&&0==keyval.trim().length&&"candLname"===keyname&&CPortal.isLastNameMandatory){isError=!0,$(this).closest("div").addClass("has-error");var errorDiv=$(this).closest("div");"candFname"===keyname?ZPSetupCommon.showErr(ZPI18N.getString("zp.entercandfname"),errorDiv,"dverrormsg"):"candLname"===keyname?ZPSetupCommon.showErr(ZPI18N.getString("zp.entercandlname"),errorDiv,"dverrormsg"):ZPSetupCommon.showErr(ZPI18N.getString("zp.entermailid"),errorDiv,"dverrormsg")}if(null!=keyval&&0!=keyval.trim().length&&"candMail"===keyname&&!CompanySettings.isValidEmail(keyval)){isError=!0,$(this).closest("div").addClass("has-error");errorDiv=$("div#emailIdParentElm").find("div[name='errDiv']");ZPSetupCommon.showErr(ZPI18N.getString("zp.entermailid"),errorDiv,"dverrormsg")}}}),$.each(bodyDiv.find("select[keyname]"),function(){var keyname=$(this).attr("keyname"),keyval=$(this).val();null!=keyval&&"null"!=keyval&&(params[keyname]=keyval)}),params.obEnable=$("#addCand").find("#onboardChkbox").is(":checked"),isError||($("#addCand").find("#addCandidate").addClass("disabled"),ZPeople.Request.send("/onboarding/candidate/add",params,CPortal.userAddResponse))}},CPortal.userListfireScroll=function(obj){ZPCommon.isScrollEnd()&&CPortal.userListScrollEvent("scroll")},CPortal.userListScrollEvent=function(event){var pageId=Layout.Page.container;if(User.endOfPage=ZPCommon.isScrollEnd(),User.endOfPage){var totalUsersCnt=pageId.find("#candidateListTable").find("tbody").find("tr").length;if(CPortal.CandLength>=User.maxRangeOfgetData){var sortType=pageId.find("table#userListTable").attr("sortbytype");CPortal.User.getUserList(totalUsersCnt+1,sortType,event),User.endOfpage=!1}}},CPortal.constructCandidateList=function(data){var pageId=$("#"+Layout.Page.pageId);CPortal.candformId=data.formId,0==pageId.find("#newFilterCandidate").length&&($(CPortal.User.createSearchAndFilterBoxes(!0)).insertBefore(pageId.find("div#scrollContent")),$("select#empStatusDtls").select2()),data.isCandidateEnabled?pageId.find("#addOptnbtn, #switchImport").removeClass("DN"):pageId.find("#addOptnbtn, #switchImport").addClass("DN"),pageId.find("select#deptDtls,select#rolesDtls,select#locationsDtls").val("0"),pageId.find("select#empStatusDtls").val(ZPI18N.getString("zp.allstatus")),pageId.find("select#portalstatus,select#empStatusDtls").select2(),pageId.find("input#searcFilter").val(""),AutomationCommon.appendSelect2Properties("#empStatusDtls"),CPortal.User.changeSearchType(this,5),pageId.find("#default").addClass("active");var headerRow="<table class='table table-hover userdataTables table-responsive' id='candidateListTable' formId='"+data.formId+"' status='3'>";headerRow+="<thead>",headerRow+="<tr>",headerRow+='<th width="52" class="text-right">',headerRow+='<div class="checkbox checkbox-primary DI">',headerRow+='<input type="checkbox" onchange="CPortal.switchResendMassupdate(this);" id="massCheckBox">',headerRow+='<label for="massCheckBox"></label>',headerRow+="</div>",headerRow+="</th>",headerRow+='<th width="34%"><span class="CP" id="sortByname" onclick="CPortal.getSortedCandidate(this)" sortType="0_1">'+ZPI18N.getString("zp.basicinfo")+'<b class="IC-l-ar-dwn S13 ML5"></b></span></th>',headerRow+="<th><span>"+ZPI18N.getString("zp.onboardingstatus")+"</span></th>",headerRow+='<th width="15%"><span></span></th>',headerRow+="</tr></thead>",headerRow+="<tbody>",headerRow+=CPortal.constructCandidateRows(data),headerRow+="</tbody>",headerRow+="</table>",pageId.find("#scrollContent").html(headerRow),0===CPortal.CandLength&&pageId.find("#scrollContent").append(ZPUtil.newNoDataHTML("CR-tt-clients"))},CPortal.constructcandidatefilter=function(data){var pageContent=$("#"+Layout.Page.pageId);Layout.Page.currentmode.split("/")[2];constructFilterOptn="<option value = '"+ZPI18N.getString("zp.allstatus")+"'>"+ZPI18N.getString("zp.allstatus")+"</option>",constructFilterOptn+="<option value = '1'>"+ZPI18N.getString("zp.orgusers")+"</option>",constructFilterOptn+="<option value = '0'>"+ZPI18N.getString("zp.inactiveusers")+"</option>",constructFilterOptn+="<option value = '2'>"+ZPI18N.getString("zp.pendingusers")+"</option>",constructFilterOptn+="<option value = '-1'>"+ZPI18N.getString("zp.downgraded")+"</option>",$(pageContent).find("select#empStatusDtls").html(constructFilterOptn),constructFilterOptn="<option value='-1'>"+ZPI18N.getString("zp.allstatus")+"</option>",constructFilterOptn+="<option value='0'>"+ZPI18N.getString("zp.notenabled")+"</option>",constructFilterOptn+="<option value='1'>"+ZPI18N.getString("zp.enabled")+"</option>",$(pageContent).find("select#portalstatus").html(constructFilterOptn)},CPortal.constructCandidateRows=function(data,event){var cArray=data.candidateArray,cUsersHtml="",deleteIc="",pageId=$("#"+Layout.Page.pageId);(CPortal.CandLength=Object.keys(data.candidateArray).length,pageId.find("#scrollContent").find(".ZPNdata").remove(),0!==CPortal.CandLength)?((pageId=$("#"+Layout.Page.pageId)).find("#scrollContent").find(".table").find("ZPLRow").remove(),$.each(cArray,function(index,cData){var usersListRow="",loginstatus=cData.LOGINSTATUS,triggeronboardingbttn="";void 0===cData.LOGINSTATUS&&(loginstatus="nonportaluser",triggeronboardingbttn='<a title="" class="ZPtitle" data-original-title="'+ZPI18N.getString("zp.triggeronboadring")+'" data-trigger="hover" data-toggle="tooltip" onclick=CPortal.convertToCandidate(CPortal.portalObj,undefined,undefined,"'+cData.CANDIDATEID+'")><span class="CR-onb-trigger btnmail"></span></a>'),usersListRow+="<tr candidateID='"+cData.CANDIDATEID+"' status='"+loginstatus+"'>",usersListRow+="<td class='text-right'><div class='checkbox checkbox-primary DI ML10'><input type='checkbox' onchange='CPortal.switchResendMassupdate(this)' name='userRowCheck' loginstatus='"+loginstatus+"'><label></label></div></td>";var candcid="";null!=cData.CID&&(candcid=", "+cData.CID),usersListRow+="<td><div class='PR FL usrsts'><span class='NO_CLASS'></span></div><div class='FL lndvname'><a class='lnk ZPbold' onclick=User.getRecordPage('"+CPortal.candformId+"','"+cData.CANDIDATEID+"','VIEW')>"+cData.candidateName+candcid+"</a><div class='lblmail'>"+cData.CANDIDATEEMAIL+"</div></div></td>",usersListRow+="<td>"+cData.obstatus+"</td>",deleteIc="<a title='' class='ML15 ZPtitle' data-original-title='"+ZPI18N.getString("zp.delete")+"'  data-trigger='hover' data-toggle='tooltip'><span class='IC-delete' onclick='CPortal.createPopUp(this)'></span></a>",usersListRow+="<td><div class='dvlist-action MT4'>",usersListRow+=triggeronboardingbttn,"1"===cData.LOGINSTATUS?usersListRow+="<a title='' class='ZPtitle' data-original-title='"+ZPI18N.getString("zp.clicktodisable")+"' data-trigger='hover' data-toggle='tooltip' changeStatus='0' onclick='CPortal.changeLoginStatus(this)'><i class='IC-user-tick btnmail'></i></a>":"2"===cData.LOGINSTATUS?usersListRow+="<a title='' class='ZPtitle' data-original-title='"+ZPI18N.getString("zp.resendinv")+"' data-trigger='hover' data-toggle='tooltip' onclick=CPortal.resendInvitation('"+cData.CANDIDATEID+"')><span class='IC-mail2x btnmail'></span></a>":"0"===cData.LOGINSTATUS&&(usersListRow+="<a title='' class='ZPtitle' data-original-title='"+ZPI18N.getString("zp.clicktoenable")+"' data-trigger='hover' data-toggle='tooltip' changeStatus='1' onclick=CPortal.changeLoginStatus(this)><i class='IC-user btnmail'></i></a>"),usersListRow+="<a title='' class='ML15 ZPtitle' data-original-title='"+ZPI18N.getString("zp.edit")+"' data-trigger='hover' data-toggle='tooltip' onclick=User.getRecordPage('"+CPortal.candformId+"','"+cData.CANDIDATEID+"','EDIT')><span class='IC-pen'></span></a>"+deleteIc+"</div></td>",cUsersHtml+=usersListRow,CPortal.candidatesList[cData.CANDIDATEID]=cData})):"scroll"!==event&&pageId.find("#scrollContent").append(ZPUtil.newNoDataHTML("CR-tt-clients"));return cUsersHtml},CPortal.userAddResponse=function(data,params){ZPSetupCommon.isEmpty(data.error)?ZPSetupCommon.isEmpty(data.success)?ZPSetupCommon.isEmpty(data.exception)?ZPSetupCommon.isEmpty(data.iamerror)||ZPeople.Message.showFailureMsg(data.iamerror):ZPeople.Message.showFailureMsg(data.exception):($("#addCand").find(".close").trigger("click"),params.method==CPortal.candidatesMethod.RESENDINVITATON?(Layout.Page.container.find("#usersOptions").addClass("DN"),Layout.Page.container.find("#licenseDtlsRow").removeClass("DN"),Layout.Page.container.find("input#massCheckBox,input[name='userRowCheck']").prop("checked",!1)):ZPOnboarding.isCandReportPage?ZPOnboarding.reloadData():CPortal.User.resetFilter(!0),ZPeople.Message.showSuccessMsg(data.success)):$.each(data.error,function(key,errMsg){if("otherErrors"==key)ZPeople.Message.showWarningMsg(errMsg);else if("notAllowed"!==key){var errorDiv=$("div#"+key).find("div[name='errDiv']");errorDiv.addClass("has-error"),"empIdErr"!==key&&"empLocAuthErr"!==key?ZPSetupCommon.showErr(errMsg,errorDiv,"dverrormsg"):"empLocAuthErr"==key?ZPeople.Message.showFailureMsg(data.error[key]):jQuery("<div/>",{class:"dverrormsg",id:"CID",text:errMsg}).insertBefore($("div#lastCID"))}else ZPeople.Message.showFailureMsg(errMsg)}),$("#addCand").find("#addCandidate").removeClass("disabled")},CPortal.getAddMultiUserListPage=function(type){void 0!=type&&(CPortal.type=type,"invite"===type?ZPeople.Request.send("/onboarding/candidate/components",{},CPortal.addMultiUserModal,{type:type}):CPortal.addMultiUserModal(void 0,void 0,{type:type}))},CPortal.addMultiUserModal=function(data,params,others){if(data.errorMessage)ZPeople.Message.showFailureMsg(data.errorMessage);else{0==$("#inviteMultiCandidate").length&&$("body").append(CPortal.multicandPage);var slider=$("#inviteMultiCandidate");slider.modal(),slider.find("#bulkmailIdBox").val(""),slider.find("#onboardChkbox").prop("checked",!1),slider.find(".dverrormsg").remove(),slider.find("[name=bulksave]").removeClass("disabled")}},CPortal.inviteBulkCandidates=function(){var slider=$("#inviteMultiCandidate");slider.find(".dverrormsg").remove();var bulkMailIds=$("#inviteMultiCandidate").find("#bulkmailIdBox").val(),bulkEmailIdparentElm=$("#inviteMultiCandidate").find("#bulkmailIdBox").parent();if(ZPSetupCommon.isEmpty(bulkMailIds.trim()))ZPSetupCommon.showErr(ZPI18N.getString("zp.specifyemailids"),bulkEmailIdparentElm,"dverrormsg");else{var mailIdList=bulkMailIds.split(","),errorList=[],validMailIdsList=[];0===mailIdList.length?ZPSetupCommon.showErr(ZPI18N.getString("zp.validemail"),bulkEmailIdparentElm,"dverrormsg"):($.each(mailIdList,function(index,mailId){mailId=mailId.trim(),ZPSetupCommon.isEmpty(mailId)||(CompanySettings.isValidEmail(mailId)?-1!==validMailIdsList.indexOf(mailId)?(ZPSetupCommon.showErr(mailId+" - "+ZPI18N.getString("zp.duplicatmailid"),bulkEmailIdparentElm,"dverrormsg","bulkInv"+index),errorList.push(mailId)):validMailIdsList.push(mailId):(ZPSetupCommon.showErr(ZSEC.Encoder.encodeForHTML(mailId)+" - "+ZPI18N.getString("zp.invalidemail"),bulkEmailIdparentElm,"dverrormsg","bulkInv"+index),errorList.push(mailId)))}),0===errorList.length&&(slider.find("[name=bulksave]").addClass("disabled"),ZPeople.Request.send("/onboarding/candidate/bulkInvite",{multiEmailIds:JSON.stringify(validMailIdsList),ZAID:CPortal.currentPortalZAID,obEnable:$("#inviteMultiCandidate").find("#onboardChkbox").is(":checked")},CPortal.handleResponseOfBulkInivteCandidate,{},CPortal.failureCallBack)))}},CPortal.failureCallBack=function(){$("#inviteMultiCandidate").find("[name=bulksave]").removeClass("disabled")},CPortal.handleResponseOfBulkInivteCandidate=function(data){bulkEmailIdBoxElm=$("#inviteMultiCandidate").find("#bulkmailIdBox");var bulkEmailIdparentElm=bulkEmailIdBoxElm.parent();if(ZPSetupCommon.isEmpty(data.result)){var idCount=0;if(ZPSetupCommon.isEmpty(data.exception))if(ZPSetupCommon.isEmpty(data.noOrgAdmin))if(ZPSetupCommon.isEmpty(data.iamerror))$.each(data.error,function(mailId,error){idCount++,ZPSetupCommon.showErr(mailId+" - "+error+"<br>",bulkEmailIdparentElm,"dverrormsg","duplicate"+idCount)});else{var emaiidlist="";$.each(data.iamerror,function(index1,json){var message="";message="invalidcharerror"==index1?ZPI18N.getString("zp.invalidcharincandemail"):"spamerror"==index1?ZPI18N.getString("zp.spamcandemail"):ZPI18N.getString("zp.problemwhileaddingcand",[ZPeople.peopleSupportEmail]),$.each(json,function(index2,emailid){idCount++,ZPSetupCommon.showErr(emailid+" - "+message+"<br>",bulkEmailIdparentElm,"dverrormsg","duplicate"+idCount),emaiidlist+=ZPeople.decodeTxt(emailid)+","})}),emaiidlist=emaiidlist.substr(0,emaiidlist.length-1),bulkEmailIdBoxElm.val(emaiidlist),ZPOnboarding.isCandReportPage||CPortal.User.resetFilter(!0)}else ZPeople.Message.showFailureMsg(data.noOrgAdmin);else ZPeople.Message.showFailureMsg(data.exception);$("#inviteMultiCandidate").find("[name=bulksave]").removeClass("disabled")}else $("#inviteMultiCandidate").modal("hide"),ZPOnboarding.isCandReportPage?ZPOnboarding.reloadData():CPortal.User.resetFilter(!0),ZPeople.Message.showSuccessMsg(data.result)},CPortal.User.getUserList=function(startInd,sortType,event,isSortUser){var pageContent=Layout.Page.container,searchval=(pageContent.find("table#candidateListTable"),pageContent.find("input#searcFilter").val());ZPSetupCommon.isEmpty(sortType)&&(sortType=pageContent.find("#candidateListTable").attr("sortbytype")),ZPSetupCommon.isEmpty(startInd)&&(startInd=1),"click"==event&&(CPortal.filter.userStatus=void 0,CPortal.filter.searchval=void 0,CPortal.filter.searchType=void 0,pageContent.find("select#empStatusDtls").val()!==ZPI18N.getString("zp.allstatus")&&(CPortal.filter.userStatus=pageContent.find("select#empStatusDtls").val()),ZPSetupCommon.isEmpty(searchval)||""==searchval.trim()||(CPortal.filter.searchval=encodeURIComponent(searchval),CPortal.filter.searchType=CPortal.searchType));var params={ZAID:CPortal.currentPortalZAID,start:startInd,searchByRole:CPortal.filter.searchByRole,searchByLoc:CPortal.filter.searchByLoc,searchByDept:CPortal.filter.searchByDept,userStatus:CPortal.filter.userStatus,searchval:CPortal.filter.searchval,searchType:CPortal.filter.searchType,sortByType:sortType};callback=CPortal.User.modifyUserList,params.isAjax=!0,url="/onboarding/candidate/list",ZPeople.Request.send(url,params,callback,event)},CPortal.User.resetFilter=function(isReset){var pageId=Layout.Page.container;pageId.find("select#deptDtls,select#rolesDtls,select#locationsDtls").val("0"),pageId.find("select#empStatusDtls").val(ZPI18N.getString("zp.allstatus")),pageId.find("select#deptDtls,select#rolesDtls,select#locationsDtls,select#empStatusDtls").select2(),pageId.find("input#searcFilter").val(""),CPortal.User.changeSearchType(this,5),pageId.find("#default").addClass("active"),pageId.find("#candidateListTable").attr("sortbytype","2_0"),pageId.find("#candListSubmit1").trigger("click")},CPortal.User.modifyUserList=function(data,params,event){var pageContent=Layout.Page.container,currentUserListStatus=(Layout.Page.currentmode.split("/")[1],pageContent.find("select#empStatusDtls").val());if(pageContent.find("table#candidateListTable").attr("status",currentUserListStatus),pageContent.find("a#userCount").html("#").removeClass("hide"),pageContent.find("span#totalusersCnt").addClass("hide"),data.paymentErr&&(ZPeople.Message.showFailureMsg(data.paymentErr),User.animatePopUpOut()),User.endOfPage=User.isScrollEnd(),null!=data.candidateArray&&void 0!=data.candidateArray){User.disperr=" ";var usersCount=Object.keys(data.candidateArray).length;pageContent.data({userCnt:usersCount});var totalUsersCnt=parseInt(pageContent.data("totalUsersCount"));if(pageContent.find("tr#emptyRow").remove(),User.isMigrateUser)if(totalUsersCnt-=1,pageContent.find("span#userCnt").text(totalUsersCnt),pageContent.data({totalUsersCount:totalUsersCnt}),pageContent.find("table#userListTable tbody tr[empErecNo='"+params.erecno+"']").remove(),0===pageContent.find("table#userListTable tbody tr").length?(pageContent.find("table#userListTable thead").addClass("DN"),pageContent.find("table#userListTable tbody").html("<tr><td class='text-center' colspan='7'>"+ZPI18N.getString("zp.norecfound")+"</td></tr>")):pageContent.find("table#userListTable thead").removeClass("DN"),window.location.href="#admin/employeerecords/user",0===(pageContent=$("div#admin-employeerecords-user")).length)$("li#zp_subtab_admin_employeerecords_user").trigger("click"),$("li#zp_subtab_admin_employeerecords_user").attr("migrate",!0),1==data.filterStatus&&User.ListUsers.getUserList(null,null,"convert");else{pageContent.find("select#empStatusDtls").val(data.filterStatus).select2();var state=1==data.filterStatus?"convert":"redirect";User.ListUsers.getUserList(null,null,state)}else User.endOfPage&&"scroll"===event?(pageContent.data({totalUsersCount:totalUsersCnt+usersCount}),totalUsersCnt+=usersCount,$(pageContent).find("table#candidateListTable tbody").append(CPortal.constructCandidateRows(data,event)),pageContent.find("input#massCheckBox").is(":checked")&&pageContent.find("input[name='userRowCheck']").prop("checked",!0)):"scroll"!==event&&(totalUsersCnt=Object.keys(data.candidateArray).length,pageContent.find("table#candidateListTable tbody").html(""),pageContent.find("table#candidateListTable tbody").html(CPortal.constructCandidateRows(data,event)),pageContent.find("div#licenseDtlsRow").removeClass("DN"),pageContent.find("div#usersOptions").addClass("DN"),pageContent.find("input#massCheckBox,input[name='userRowCheck']").prop("checked",!1),User.endOfPage=!1),$(".ZPtitle").tooltip(),pageContent.find("span#userCnt").text(usersCount);data.userStatus;pageContent.find("span#userCnt").text(totalUsersCnt),pageContent.find("table#candidateListTable").data({startInd:data.startInd}),pageContent.find("select#locationsDtls option[value='"+data.candidateArray.LOCATION+"']").text(),User.animatePopUpOut(),$("div.orgivRed").remove()}else{if(!ZPSetupCommon.isEmpty(data.noOrgAdmin))return void ZPeople.Message.showFailureMsg(data.noOrgAdmin);ZPSetupCommon.isEmpty(data.error)?$.each(data,function(emailId,errorObj){if("isErrorFound"!==emailId){var getErrorObj=data[emailId],parentObj=$("input[emailId='"+emailId+"']").parent();parentObj.addClass("has-error"),ZPSetupCommon.showErr(getErrorObj.emailIdParentElm,parentObj,"dverrormsg"),$("input[emailId='"+emailId+"']").attr("emailErr","true")}}):$.each(data.error,function(key,errMsg){if("notAllowed"!==key){var errorDiv=$("div#"+key).find("div[name='errDiv']");errorDiv.addClass("has-error"),"empIdErr"!==key&&"empLocAuthErr"!==key?ZPSetupCommon.showErr(errMsg,errorDiv,"dverrormsg"):"empLocAuthErr"==key?ZPeople.Message.showFailureMsg(data.error[key]):jQuery("<div/>",{class:"dverrormsg",id:"empId",text:errMsg}).insertBefore($("div#lastEMpId"))}else ZPeople.Message.showFailureMsg(data.error[key])}),User.isAllowToAddUser=data.isAllowToAddEmployee}User.isMigrateUser=!1,User.lastEmployeeId=data.lastEmployeeId;data.filterStatus;pageContent.find("div#lastEMpId").find("span").text(data.lastEmployeeId),pageContent.find("span#dispUsersCount").text(User.totalUsersCount)},CPortal.User.showLogoutModal=function(){$("#zp_user_information").remove();var viewUrl=ZPeople.getResourceURL(imageUrl+"user.png");ZPPreboarding.viewUrl&&(viewUrl=ZPPreboarding.viewUrl);var bodyHtml='<div class="ZPUserAcc"><i data-dismiss="modal" class="IC-cls-1px red S21 CP ZPUclse" onclick="ZPeople.showLogoutModal();"></i><div class="ZPprofdt"><img src="'+viewUrl+'" /><h4>';bodyHtml+=CPortal.CURR_USER.cid?CPortal.CURR_USER.cid+"&nbsp;-&nbsp;":"",bodyHtml+=CPortal.CURR_USER.name+'</h4><span><a href="mailto:'+CPortal.CURR_USER.email+'">'+CPortal.CURR_USER.email+"</a></span>",bodyHtml+='<div class="ZPMyacc"><a onclick="CPortal.ClearCookies()" class="PreOBSOut">'+ZPI18N.getString("zp.logout")+"</a></div></div>";ZPeople.BSModal.setup({id:"zp_user_information",type:1,disableHeader:!0,closeonEsc:!0,body:bodyHtml,footer:'<div class="modal-footer"></div>',bodyClass:"Nomdlhead",dialogClass:"ZPRMpnl ZPPopProVw",modalClass:"popRgtModel ZPAdpop PopXmModel",overwriteModalClass:!0,isWrapperAppend:!0})},CPortal.User.changeSearchType=function(clickObj,searchType){var pageContent=$("#"+Layout.Page.pageId);$(pageContent).find("ul#searchMenu").find("a").removeClass("active"),$(clickObj).find("a").addClass("active"),CPortal.searchType=searchType},CPortal.importUser=function(data){Import.init(data.formId,null,Layout.Page.hash)},CPortal.createPopUp=function(thisObj){ZPeople.confirm($(thisObj).closest("tr"),"","zp.deleteconfirmmessage",CPortal.deleteCandidate)},CPortal.deleteCandidate=function(obj){var formId=CPortal.candformId,pageId=Layout.Page.container,candidateid=$(obj).attr("candidateid"),params={formID:formId,viewLinkName:"",deletegroup:candidateid,conreqcsr:csrfToken};$.post("/onboarding/candidate/deleteRecord",params,function(data){"object"==typeof data.response[0]?ZPeople.Message.showFailureMsg(errorObj.error):void 0!==data.success&&(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.canddeletedsuccess")),pageId.find("table#candidateListTable").find("tr[candidateid='"+candidateid+"']").closest("tr").remove(),0==pageId.find("table#candidateListTable").find("tbody").find("tr").length&&pageId.find("#scrollContent").append(ZPUtil.newNoDataHTML("CR-tt-clients")))})},CPortal.User.createSearchAndFilterBoxes=function(){var filterElms='<div class="filter-popup" id="newFilterCandidate"em class="AT"></em><div class="clearfix">';return filterElms+='<div class="filter-header"><h6 class="addPopTitle">'+ZPI18N.getString("zp.filter")+'</h6><a id="newFilterClose" class="IC-cls flt-close" onclick="User.ListUsers.resetAfterClose();"></a></div>',filterElms+='<div class="filter-search multi">',filterElms+='<input id="searcFilter" placeholder="'+(ZPI18N.getString("zp.candidatename")+" ,"+ZPI18N.getString("zp.emailid")+"...")+'" class="form-control" type="search">',filterElms+='<i class="IC-ar-dwn dropdown" data-toggle="dropdown"></i>',filterElms+='<ul role="menu" class="dropdown-menu" id="searchMenu">',filterElms+='<li onclick="CPortal.User.changeSearchType(this,5)"><a id="default" class="active"><span class="IC-tick"></span>'+ZPI18N.getString("zp.allfields")+"</a></li>",filterElms+='<li onclick="CPortal.User.changeSearchType(this,1)"><a><span class="IC-tick"></span>'+ZPI18N.getString("zp.candidatefirstname")+"</a></li>",filterElms+='<li onclick="CPortal.User.changeSearchType(this,2)"><a><span class="IC-tick"></span>'+ZPI18N.getString("zp.candidatelastname")+"</a></li>",filterElms+='<li onclick="CPortal.User.changeSearchType(this,3)"><a><span class="IC-tick"></span>'+ZPI18N.getString("zp.searchbycandid")+"</a></li>",filterElms+='<li onclick="CPortal.User.changeSearchType(this,4)"><a><span class="IC-tick"></span>'+ZPI18N.getString("zp.candidateemailid")+"</a></li>",filterElms+="</ul>",filterElms+="</div>",filterElms+="</div>",filterElms+='<div class="filter-section" id="filter_section"><div class="ctable hide" id="no_fields"></div><ul class="filter-lists" id="filterlist">',filterElms+='<div class="form-group">',filterElms+='<label class="control-label ZPbold">'+ZPI18N.getString("zp.onboardingstatus")+"</label>",filterElms+='<select class="hideSearch" aria-hidden="true" id="empStatusDtls">',filterElms+="<optgroup label='"+ZPI18N.getString("zp.active")+"'>",filterElms+="<option value = 'All Status'>"+ZPI18N.getString("zp.allstatus")+"</option>",filterElms+="<option value = '1'>"+ZPI18N.getString("zp.triggered")+"</option>",filterElms+="<option value = '0'>"+ZPI18N.getString("zp.nottriggered")+"</option>",filterElms+="<option value = '3'>"+ZPI18N.getString("zp.completed")+"</option>",filterElms+="<option value= '4'>"+ZPI18N.getString("zp.usercompleteonboarding")+"</option>",filterElms+="<option value = '5'>"+ZPI18N.getString("zp.reopenonboarding")+"</option>",filterElms+="<option value = '2'>"+ZPI18N.getString("zp.chkinprogress")+"</option>",filterElms+="</optgroup><option value='-6'>"+ZPI18N.getString("zp.inactive")+"</option></select>",filterElms+="</select>",filterElms+="</div></div>",filterElms+='<div id="candListSubmit" class="filter-footer"><button id="candListSubmit1" class="btn btn-primary" onclick=CPortal.User.getUserList(null,null,"click")>'+ZPI18N.getString("zp.submit")+'</button><a class="btn btn-link" onclick=CPortal.User.resetFilter(true)>Reset</a></div>',filterElms+="</div>"},CPortal.getSortedCandidate=function(obj){if(Layout.Page.container.find("#candidateListTable").find("tbody").find("tr").length>1){var sort="0_0",upAndDownArrowElm=$(obj).find("b");"IC-l-ar-dwn S13 ML5"===upAndDownArrowElm.attr("class")?upAndDownArrowElm.attr("class","IC-l-ar-top S13 ML5"):(upAndDownArrowElm.attr("class","IC-l-ar-dwn S13 ML5"),sort="0_1"),$(obj).closest("table").attr("sortbytype",sort),CPortal.User.getUserList(null,sort,null,!0)}},CPortal.resendInvitation=function(candid){var callback=CPortal.userAddResponse,candids=[];void 0!=candid?candids[0]=candid:$.each($(Layout.Page.container).find("table#candidateListTable tbody").find("tr[status='2'] input[type='checkbox']:checked"),function(index,elm){candids[index]=$(elm).closest("tr").attr("candidateid")}),candids=JSON.stringify(candids),ZPeople.Request.send("/onboarding/candidate/resendInvitation",{candidateids:candids,ZAID:CPortal.currentPortalZAID},callback)},CPortal.switchResendMassupdate=function(obj){var pageContent=Layout.Page.container;if("massCheckBox"===obj.id){var checkBoxes=pageContent.find("#candidateListTable").find("input[type='checkbox']");Layout.Page.container.find("input#massCheckBox").is(":checked")?(checkBoxes.prop("checked",!0),0!==pageContent.find("table#candidateListTable tbody tr").find("input:checked").length&&(pageContent.find("div#usersOptions").removeClass("DN"),pageContent.find("div#massUpdate").fadeIn(),CPortal.isConvert&&(pageContent.find("div#convertcandtoemp").fadeIn(),pageContent.find("div#convertcandtoempprofile").fadeIn()),pageContent.find("div#licenseDtlsRow").addClass("DN"))):(checkBoxes.prop("checked",!1),pageContent.find("div#usersOptions").addClass("DN"),pageContent.find("div#massUpdate,div#resendInvite,div#convertcandtoemp,div#convertcandtoempprofile").hide(),pageContent.find("div#dispUserCntTitle,div#licenseDtlsRow").removeClass("DN")),0!==$(pageContent).find("table#candidateListTable tbody").find("input[loginstatus=2]:checked").length?pageContent.find("div#resendInvite").fadeIn():pageContent.find("div#resendInvite").hide(),0!==$(pageContent).find("table#candidateListTable tbody").find("input[loginstatus='nonportaluser']:checked").length?pageContent.find("div#convertcandtocand").fadeIn():pageContent.find("div#convertcandtocand").hide(),0===pageContent.find("table#candidateListTable tbody tr").not('[convertstatus="inprocess"]').find("input:checked").length?pageContent.find("div#convertcandtoemp").addClass("NM OP5"):pageContent.find("div#convertcandtoemp").removeClass("NM OP5")}else 0!==pageContent.find("table#candidateListTable tbody tr").find("input:checked").length?(pageContent.find("div#usersOptions").removeClass("DN"),pageContent.find("div#massUpdate").fadeIn(),CPortal.isConvert&&pageContent.find("div#convertcandtoemp,div#convertcandtoempprofile").fadeIn(),pageContent.find("div#licenseDtlsRow").addClass("DN"),0===$(pageContent).find("table#candidateListTable tbody").find("input[loginstatus='2']:checked").length?pageContent.find("div#resendInvite").hide():pageContent.find("div#resendInvite").fadeIn(),0!==$(pageContent).find("table#candidateListTable tbody").find("input[loginstatus='nonportaluser']:checked").length?pageContent.find("div#convertcandtocand").fadeIn():pageContent.find("div#convertcandtocand").hide()):(pageContent.find("div#usersOptions").addClass("DN"),pageContent.find("div#massUpdate,div#resendInvite,div#convertcandtoemp,div#convertcandtocand,div#convertcandtoempprofile").hide(),$("div#dispUserCntTitle,div#licenseDtlsRow").removeClass("DN")),$(obj).is(":checked")?$(obj).closest("tr").attr("class","active"):$(obj).closest("tr").attr("class",""),0===pageContent.find("table#candidateListTable tbody").find("input[type='checkbox']").not(":checked").length?pageContent.find("input#massCheckBox").prop("checked",!0):pageContent.find("input#massCheckBox").prop("checked",!1),0===Layout.Page.container.find("table#candidateListTable tbody tr").not('[convertstatus="inprocess"]').find("input:checked").length?pageContent.find("div#convertcandtoemp").addClass("NM OP5"):pageContent.find("div#convertcandtoemp").removeClass("NM OP5")},CPortal.changeLoginStatus=function(obj){var params={candidateid:$(obj).closest("tr").attr("candidateid"),changeStatus:$(obj).attr("changestatus")};ZPeople.Request.send("/onboarding/candidate/changeLoginStatus",params,CPortal.handleResponseOfChangeLoginStatus,obj)},CPortal.handleResponseOfChangeLoginStatus=function(data,obj,thisObj){var classNm,pageId=Layout.Page.container,empStatus=(pageId.find("table#candidateListTable"),pageId.find("table#candidateListTable").attr("status"));ZPSetupCommon.isEmpty(data.SUCCESS)?ZPeople.Message.showFailureMsg(data.ERROR):("0"===obj.changeStatus?(classNm="IC-user btnmail",$(thisObj).attr("changeStatus","1"),$(thisObj).attr("data-original-title",""+ZPI18N.getString("zp.clicktoenable"))):(classNm="IC-user-tick btnmail",$(thisObj).attr("changeStatus","0"),$(thisObj).attr("data-original-title",""+ZPI18N.getString("zp.clicktodisable"))),"3"===empStatus||empStatus===ZPI18N.getString("zp.allstatus")?$(thisObj).find("i").attr("class",classNm):$(thisObj).closest("tr").remove(),ZPeople.Message.showSuccessMsg(data.SUCCESS),0==pageId.find("table#candidateListTable").find("tbody").find("tr").length&&pageId.find("#scrollContent").append(ZPUtil.newNoDataHTML("CR-tt-clients")))},CPortal.createPortal=function(obj){var portalName=$("#add_cportal").find(".zptxt-edit").val();void 0!==portalName&&portalName.trim()&&$.ajax({type:"POST",async:!1,url:CPortal.candidateURLS.ADDPORTALURL,data:{portalName:portalName,portalType:CPortal.portalType,conreqcsr:csrfToken},success:function(data){data.success?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatedsuccessfully")),window.location.reload()):void 0!=data.error&&data.error?ZPeople.Message.showFailureMsg(data.msg):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror"))}})},CPortal.getMappingdata=function(zp_type){void 0==zp_type&&ZPeople.ISUNCONFIRMEDACC?ZPeople.showErrorMessageForUnconfirmedAcc():(CPortal.currentzptype=zp_type,ZPeople.Request.send("/onboarding/settings/passwordMapping",CPortal.showMappingFields))},CPortal.showMappingFields=function(data){if(data.ismappingempty)ZPeople.confirm(null,"","Please configure field mapping in <a href='#onboarding/settings/generalsettings' >Onboarding->Settings->Module Setting</a>->Customization","",!0,!0,"",!0);else if(data.isSuccess){var convetelm='<div class="modal  popRgtModel in" id="ZPconvert" aria-hidden="false" style="display: block;"> <div class="ZPResize"></div><div class="modal-dialog" role="document"> <div class="modal-content">  <div id="convertStep1" class="ZPNxtStep"><div class="modal-header"><button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true"><div class="IC-cls-1px red S21 CP"></div></span></button></div> <div class="modal-body PT0I" id="convertStep1ConfirmMapping"></div><div class="modal-footer text-left"><button id="step2Next" onclick="CPortal.submitMapping('+CPortal.currentzptype+',true)" class="btn btn-default  btn-md MR10 FR" type="button">'+ZPI18N.getString("zp.next")+'</button><button class="btn btn-default btn-md FL" type="button" data-dismiss="modal">'+ZPI18N.getString("zp.cancel")+'</button></div></div><div id="convertStep2" class="DN ZPNxtStep"><div class="modal-header"><button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true"><div class="IC-cls-1px red S21 CP"></div></span></button></div> <div class="modal-body"><div class="ZPImfrm ZPRecList"><div class="PR"><div class="ZPSAdflds infomsg MT20"><ul class="list MT20"><li>'+ZPI18N.getString("zp.noOfAdd")+'<span class="rcount" id="noOfAdd">0</span></li><li>'+ZPI18N.getString("zp.noOfErr")+'<span class="rcount" id="noOfErr">0</span></li></ul></div><div class="clearfix"></div><div class="table-responsive" id="convertErrDiv"><table class="table table-hover"><thead><tr><th colspan="2">'+ZPI18N.getString("zp.errorDetails")+'</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer text-left"><button class="btn btn-default btn-md" type="button" data-dismiss="modal">'+ZPI18N.getString("zp.close")+'</button></div></div></div></div><iframe width="0" height="0" frameborder="0" scrolling="auto" name="importIframe" src="/people/html/blank.html" style="display:none"><html><head></head><body></body></html></iframe></div>';$("body").find("#ZPconvert").remove(),$("body").append(convetelm),$("#ZPconvert").find("[data-dismiss=modal]").on("click",function(){Layout.Page.container.find("#zp_view_close_selection").trigger("click"),$("body").find("#ZPconvert").remove(),$("body").find(".modal-backdrop").remove()});var pageId=$("#ZPconvert"),mappings=data.mappings;pageId.find("#convertStep1ConfirmMapping").empty();var pval=void 0!=mappings.password?mappings.password:"-1",html='<div class="label-main" id="PasswordInput"><div class="label-body"><form class="row"><div class="col-sm-6"><div class="form-group"><label class="mantry">*'+ZPI18N.getString("zp.passwd")+'</label><select name="password" id="chsPassword" isMandatory=true >'+CPortal.selectOptions(data.Candcol.NONTABULARSECTION,zpconst.FieldType.TEXT,void 0)+"</select></div></div></form></div></div>";1==("#onboarding/candidate/cportal"===Layout.Page.hash?Layout.Page.container.find("table#candidateListTable tbody").find("input[type='checkbox']:checked").length:Layout.Page.container.find("table#zp_views_records_table:visible").find("tbody input#zp_view_sel_record:checked").length)&&(html='<div class="label-main"><div class="label-body"><form class="row"><div class="col-sm-3"><div class="form-group"><label class="mantry">*'+ZPI18N.getString("zp.passwd")+"</label></div></div>",html+='<div class="col-md-9 form-group"><div id="newPasswordDiv" class="radio radio-primary DI MR20"><input onchange="CPortal.tempAct(this)" id="newPassword" type="radio" name="passwordradio"><label for="newPassword">'+ZPI18N.getString("zp.createnewpassword")+'</label></div><div id="chsPasswordDiv" class="radio radio-primary DI"><input onchange="CPortal.tempAct(this)" id="chsPasswordopt" type="radio" checked="checked" name="passwordradio"><label for="chsPasswordopt">'+ZPI18N.getString("zp.selectfieldfromcand")+"</label></div></div>",html+='<div class="form-group col-md-5" id="PasswordInput"><select name="password" id="chsPassword" isMandatory=true >'+CPortal.selectOptions(data.Candcol.NONTABULARSECTION,zpconst.FieldType.TEXT,void 0)+'</select><input type="text" name="password" id="newPassword" value="" class="form-control DN"></div>',html+="</form></div></div>"),pageId.find("#convertStep1ConfirmMapping").append(html),0!==pageId.find("#PasswordInput").find('#chsPassword [value="'+pval+'"]').length&&pageId.find("#PasswordInput").find("#chsPassword").val(pval),pageId.find("#convertStep1 select").select2(),$("#ZPconvert").modal("show")}else void 0!=data.errMsg&&($("body").find("#ZPconvert").remove(),ZPeople.Message.showFailureMsg(data.errMsg))},CPortal.createMappingFieldsDiv=function(col1Fields,mappings,data){var col1Contents=jQuery("<div />",{class:"col-sm-6"});for(j=0;j<col1Fields.length;j++){col1Fields[j].isMandatory&&(9==CPortal.currentzptype&&$.inArray(col1Fields[j].cname,["EMPLOYEEMAILALIAS","EMPLOYEELASTNAME"])>-1?col1Fields[j].isMandatory=!1:$.inArray(col1Fields[j].cname,["EMPLOYEELASTNAME","EMPLOYEEMAILALIAS","EMPLOYEEID","EMPLOYEEFIRSTNAME"])<0&&(col1Fields[j].isMandatory=!1));var field=jQuery("<div />",{class:"form-group"}).append(jQuery("<label />").append(col1Fields[j].name)).append(jQuery("<select />",{name:col1Fields[j].lname,isMandatory:col1Fields[j].isMandatory}).append(CPortal.selectOptions(data,col1Fields[j].c_type,col1Fields[j].s_type)));col1Fields[j].isMandatory&&field.find("label").addClass("mantry").prepend("*"),void 0!=mappings[col1Fields[j].lname]&&field.find("select").val(mappings[col1Fields[j].lname]),"EMPLOYEEPHOTO"==col1Fields[j].cname&&void 0==mappings[col1Fields[j].cname]&&field.find("select").val("Photo"),col1Contents.append(field)}return col1Contents},CPortal.submitMapping=function(currentzptype,isfromtemplate){var candids=[];CPortal.currentzptype=currentzptype;var isAddAddUserDirectly=CPortal.currentzptype==User.allowToAddUserDirectly,mappings={};if(isfromtemplate)if(CPortal.passwordtype){if(mappings.password=$("#ZPconvert").find("#PasswordInput #newPassword").val(),0==mappings.password.trim().length)return $("#ZPconvert").find("#PasswordInput #newPassword").closest("div").append(jQuery("<div />",{class:"errDiv red"}).append(ZPI18N.getString("zp.passwordempty"))),void $("#ZPconvert").find("#step2Next").attr("disabled",!1)}else if(mappings.password=$("#ZPconvert").find("#PasswordInput #chsPassword").val(),0==mappings.password.trim().length||"-1"==mappings.password.trim())return $("#ZPconvert").find("#PasswordInput #chsPassword").closest("div").append(jQuery("<div />",{class:"errDiv red"}).append(ZPI18N.getString("zp.MandatoryFieldMap"))),void $("#ZPconvert").find("#step2Next").attr("disabled",!1);"#onboarding/candidate/cportal"===Layout.Page.hash?$.each($(Layout.Page.container).find("table#candidateListTable tbody tr").not('[convertstatus="inprocess"]').find("input[type='checkbox']:checked"),function(index,elm){candids[index]=$(elm).closest("tr").attr("candidateid"),$(elm).closest("tr").attr("convertstatus","inprocess")}):(userTableElm=Layout.Page.container.find("table#zp_views_records_table:visible"),$.each(userTableElm.find("tbody input#zp_view_sel_record:checked"),function(index,obj){candids[index]=$(this).closest("tr").attr("recordid")}));var params={candidateIds:JSON.stringify(candids)};if(isAddAddUserDirectly){if(isfromtemplate)params.passwordtype=CPortal.passwordtype,params.mappingsObj=JSON.stringify(mappings);else{var noofcandselect="#onboarding/candidate/cportal"===Layout.Page.hash?Layout.Page.container.find("table#candidateListTable tbody").find("input[type='checkbox']:checked").length:Layout.Page.container.find("table#zp_views_records_table:visible").find("tbody input#zp_view_sel_record:checked").length;params.issinglecand=1==noofcandselect}params.zp_type=4}else 9==CPortal.currentzptype&&(params.zp_type=CPortal.currentzptype);ZPeople.Request.send("/onboarding/reports/candidateToEmployee",params,CPortal.handleresultofconv,isfromtemplate),$("#ZPconvert").find("#convertStep1 #step2Next").addClass("disabled"),Layout.Page.container.find("#convertcandtoemp").addClass("NM OP5")},CPortal.handleresultofconv=function(data,params,isfromtemplate){if(0==Object.keys(data).length)ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror"));else if(data.ismappingempty)ZPeople.confirm(null,"","Please configure field mapping in <a href='#onboarding/settings/generalsettings' >Onboarding->Settings->Module Setting</a>->Customization","",!0,!0,"",!0);else if(data.ispasswordempty)CPortal.showMappingFields(data);else if(data.allConverted)$("#ZPconvert").find(".close").trigger("click"),Layout.Page.container.find("#candidateListTable").find("input[type='checkbox']").prop("checked",!1),Layout.Page.container.find("table#zp_views_records_table:visible").find("input[type='checkbox']").prop("checked",!1),Layout.Page.container.find("div#usersOptions").addClass("DN"),Layout.Page.container.find("div#licenseDtlsRow").removeClass("DN"),Layout.Page.container.find("#zp_view_record_delete").hide(),Layout.Page.container.find("#zp_views_formrecactions").show(),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.convertedsuccessfully"));else{if(!isfromtemplate){var convetelm='<div class="modal  popRgtModel in" id="ZPconvert" aria-hidden="false" style="display: block;"> <div class="ZPResize"></div><div class="modal-dialog" role="document"> <div class="modal-content">  <div id="convertStep1" class="ZPNxtStep"><div class="modal-header"><button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true"><div class="IC-cls-1px red S21 CP"></div></span></button></div> <div class="modal-body PT0I" id="convertStep1ConfirmMapping"></div><div class="modal-footer text-left"><button id="step2Next" onclick="CPortal.validateMapping()" class="btn btn-default  btn-md MR10 FR" type="button">'+ZPI18N.getString("zp.next")+'</button><button class="btn btn-default btn-md FL" type="button" data-dismiss="modal">'+ZPI18N.getString("zp.cancel")+'</button></div></div><div id="convertStep2" class="DN ZPNxtStep"><div class="modal-header"><button aria-label="Close" data-dismiss="modal" class="close" type="button"><span aria-hidden="true"><div class="IC-cls-1px red S21 CP"></div></span></button></div> <div class="modal-body"><div class="ZPImfrm ZPRecList"><div class="PR"><div class="ZPSAdflds infomsg MT20"><ul class="list MT20"><li>'+ZPI18N.getString("zp.noOfAdd")+'<span class="rcount" id="noOfAdd">0</span></li><li>'+ZPI18N.getString("zp.noOfErr")+'<span class="rcount" id="noOfErr">0</span></li></ul></div><div class="clearfix"></div><div class="table-responsive" id="convertErrDiv"><table class="table table-hover"><thead><tr><th colspan="2">'+ZPI18N.getString("zp.errorDetails")+'</th></tr></thead><tbody></tbody></table></div></div></div></div><div class="modal-footer text-left"><button class="btn btn-default btn-md" type="button" data-dismiss="modal">'+ZPI18N.getString("zp.close")+'</button></div></div></div></div><iframe width="0" height="0" frameborder="0" scrolling="auto" name="importIframe" src="/people/html/blank.html" style="display:none"><html><head></head><body></body></html></iframe></div>';$("body").find("#ZPconvert").remove(),$("body").append(convetelm),$("#ZPconvert").modal("show")}$("#ZPconvert").find("[data-dismiss=modal]").on("click",function(){$("#convertStep2").find(".modal-body").is(":visible")&&(Layout.Page.container.find("#zp_view_close_selection").trigger("click"),$("body").find("#ZPconvert").remove(),$("body").find(".modal-backdrop").remove())});var recordsadded=0,error=0,pageid=$("#ZPconvert");pageid.find("#convertStep1").hide(),pageid.find("#convertStep2").removeClass("DN"),$.each(data,function(candid,value){var emailid=value.userdisp;$.each(value.response,function(index,response){if(7e3===response.code)recordsadded++;else if(error++,"object"==typeof response.message)if(response.message.label){var label=response.message.label,displayname=ZPeople.decodeTxt(response.message.displayname),errormessage=ZPeople.decodeTxt(response.message[label]).replace(displayname,"<b>"+displayname+"</b>"),row="";response.message.row&&(row=ZPI18N.getString("zp.row")+" "+response.message.row+" - ");var html='<tr class="ZPLRow"><td></td><td style="width: 35%;">'+emailid+"</td><td>"+response.message.displayname+" - "+row+errormessage+"</td></tr>";pageid.find("#convertStep2").find("#convertErrDiv").find("tbody").append(html)}else $.each(response.message,function(key,message){name;var html='<tr class="ZPLRow"><td></td><td style="width: 35%;">'+emailid+"</td><td>"+message+"</td></tr>";pageid.find("#convertStep2").find("#convertErrDiv").find("tbody").append(html)});else{message="Z112"==response.message?ZPI18N.getString("zp.dcinviteerror",[ZPeople.peopleSupportEmail]):response.message;html='<tr class="ZPLRow"><td></td><td style="width: 35%;">'+emailid+"</td><td>"+message+"</td></tr>";pageid.find("#convertStep2").find("#convertErrDiv").find("tbody").append(html)}})}),0==error&&pageid.find("#convertStep2").find("#convertErrDiv").addClass("DN"),pageid.find("#convertStep2").find("#noOfAdd").text(recordsadded),pageid.find("#convertStep2").find("#noOfErr").text(error),$(pageid.find("#convertStep2").find('[data-dismiss="modal"]')).on("click",function(){Layout.Page.container.find("#candidateListTable").find("input[type='checkbox']").prop("checked",!1),Layout.Page.container.find("div#usersOptions").addClass("DN"),Layout.Page.container.find("div#licenseDtlsRow").removeClass("DN"),Layout.Page.container.find("#zp_view_record_delete").hide(),Layout.Page.container.find("#zp_views_formrecactions").show()})}$("#zp_view_record_selectionactions,#candidateListing").find("#convertcandtoemp").removeClass("NM OP5");var candidateids=JSON.parse(params.candidateIds);$.each(candidateids,function(index,candidateid){$('[candidateid="'+candidateid+'"]').removeAttr("convertstatus")})},CPortal.selectOptions=function(data,c_type,s_type,mapping,isUniquemand,emplname){var selectBuf="<option value='-1'>-- "+ZPI18N.getString("zp.select")+" --</option>";return $.each(data,function(key,value1){selectBuf+="<optgroup label='"+value1.name+"'>"+value1.name,$.each(value1.colFields,function(key,value){var selc="";value.lname==mapping&&(selc='selected="selected"'),c_type!==zpconst.FieldType.TEXT&&c_type!==zpconst.FieldType.TEXT_AREA||value.c_type===zpconst.FieldType.LOOKUP||value.c_type===zpconst.FieldType.IMAGE||value.c_type===zpconst.FieldType.FILE_UPLOAD||37===value.c_type?(c_type!=zpconst.FieldType.DECIMAL||value.c_type!=zpconst.FieldType.NUMBER&&value.c_type!=zpconst.FieldType.DECIMAL)&&(c_type!=zpconst.FieldType.UAN||value.c_type!=zpconst.FieldType.UAN&&value.c_type!=zpconst.FieldType.TEXT)?c_type==value.c_type&&(c_type==zpconst.FieldType.LOOKUP?emplname&&("Entity"==emplname&&"CandidateEntity"==value.lname||"Business_unit"==emplname&&value.lname==emplname||"Division"==emplname&&"CandidateDivision"==value.lname||"Department"==emplname&&"CandidateDepartment"==value.lname)?selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>":(!emplname||-1==$.inArray(emplname,["Entity","Division","Business_unit"])&&-1==$.inArray(value.lname,["CandidateEntity","CandidateDivision","Business_unit"]))&&(s_type==zpconst.FieldType.SINGLE_SELECT&&value.s_type==s_type?selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>":s_type==zpconst.FieldType.MULTI_SELECT&&(selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>")):c_type==zpconst.FieldType.PICKLIST?s_type==zpconst.FieldType.SINGLE_SELECT&&value.s_type==s_type?selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>":s_type==zpconst.FieldType.MULTI_SELECT&&(selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>"):selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>"):selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>":isUniquemand?value.isUnique&&value.isMandatory&&(selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>"):selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>"}),selectBuf+="</optgroup>"}),selectBuf},CPortal.portalDetails=function(obj){ZPeople.ISUNCONFIRMEDACC?ZPeople.showErrorMessageForUnconfirmedAcc():CPortal.portalObj?ZPeople.Request.send(CPortal.candidateURLS.CPORTALURL,{},CPortal.convertToCandidate,{obj:obj}):CPortal.convertToCandidate(CPortal.portalObj,void 0,others)},CPortal.convertToCandidate=function(data,params,others,candidateid){params={ZAID:data.ZAID,portalType:data.portalType};var pkIds=[];candidateid?(params.formId=Layout.Page.container.find("table#candidateListTable").attr("formid"),pkIds[0]=candidateid):"#onboarding/candidate/cportal"===Layout.Page.hash?($.each($(Layout.Page.container).find("table#candidateListTable tbody").find("input[type='checkbox']:checked"),function(index,elm){pkIds[index]=$(elm).closest("tr").attr("candidateid")}),params.formId=Layout.Page.container.find("table#candidateListTable").attr("formid")):(userTableElm=Layout.Page.container.find("table#zp_views_records_table:visible"),$.each(userTableElm.find("tbody input#zp_view_sel_record:checked"),function(index,obj){pkIds[index]=$(this).closest("tr").attr("recordid")}),params.formId=ZPView.CURR_VIEWPARAMS.formId),params.candidateIds=JSON.stringify(pkIds),ZPeople.Request.send("/onboarding/candidate/triggerOnboarding",params,CPortal.convertCandidateResponse)},CPortal.convertCandidateResponse=function(data){if(void 0!=data.msg)if(data.msg==zpconst.CommonMessages.SUCCESSMSG)if(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.onboardingtriggered")),"#onboarding/candidate/cportal"===Layout.Page.hash){CPortal.filter.userStatus=void 0;var sortType=Layout.Page.container.find("#candidateListTable").attr("sortbytype");ZPeople.Request.send("/onboarding/candidate/list",{start:1,userStatus:CPortal.filter.userStatus,ZAID:CPortal.currentPortalZAID,sortByType:sortType},CPortal.constructCandidateList)}else Layout.Page.container.find("div#zp_view_close_selection").trigger("click"),ZPView.refresh(!0);else ZPeople.Message.showWarningMsg(data.msg);else if(data.hasOwnProperty("onbtriggeredalready")||data.hasOwnProperty("onbcanttriggerforsample")||data.hasOwnProperty("exceptionList")||data.hasOwnProperty("invalidcharerror")||data.hasOwnProperty("spamerror")){var html='<div class="obflow">';if($.each(data,function(index1,msgobj){html+='<p class="pspace">',"onbtriggeredalready"==index1?html+=ZPI18N.getString("zp.onbalreadytriggered"):"onbcanttriggerforsample"==index1?html+=ZPI18N.getString("zp.onbcanttriggerforsample"):"exceptionList"==index1?html+=ZPI18N.getString("zp.problemwhiletriggercand",[ZPeople.peopleSupportEmail]):"invalidcharerror"==index1?html+=ZPI18N.getString("zp.invalidcharincandemail"):"spamerror"==index1&&(html+=ZPI18N.getString("zp.spamcandemail")),html+="</p>",html+='<div class="pspace">',$.each(msgobj,function(index2,emailid){html+="<span>"+emailid+"</span>"}),html+="</div>"}),ZPeople.confirm(null,ZPI18N.getString("zp.onbnottriggeredreasonscand"),html,"",!0,!0,"",!0),"#onboarding/candidate/cportal"===Layout.Page.hash){CPortal.filter.userStatus=void 0;sortType=Layout.Page.container.find("#candidateListTable").attr("sortbytype");ZPeople.Request.send("/onboarding/candidate/list",{start:1,userStatus:CPortal.filter.userStatus,ZAID:CPortal.currentPortalZAID,sortByType:sortType},CPortal.constructCandidateList)}}else ZPSetupCommon.isEmpty(data.exception)?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.sorryservererror")):ZPeople.Message.showFailureMsg(data.exception);Layout.Page.container.find("input[type='checkbox']").prop("checked",!1),Layout.Page.container.find("div#usersOptions").addClass("DN"),Layout.Page.container.find("div#licenseDtlsRow").removeClass("DN"),Layout.Page.container.find("#zp_view_record_delete").hide(),Layout.Page.container.find("#zp_views_formrecactions").show()},CPortal.getCandidateDetailsById=function(candId){return void 0==CPortal.candidatesList[candId]&&(CPortal.currentPortalZAID||$.ajax({type:"POST",async:!1,url:CPortal.candidateURLS.CPORTALURL,data:{conreqcsr:csrfToken},success:function(data){CPortal.currentPortalZAID=data.ZAID,CPortal.portalObj=data}}),$.ajax({url:"/onboarding/candidate/list",data:{start:1,ZAID:CPortal.currentPortalZAID,userStatus:1,searchType:0,searchval:candId,conreqcsr:csrfToken},type:"POST",async:!1,success:function(data){void 0!=data.candidateArray&&Object.keys(data.candidateArray).length>0&&(CPortal.candidatesList[candId]=data.candidateArray[0]),void 0!=data.ZAID&&(CPortal.currentPortalZAID=data.ZAID)}})),CPortal.candidatesList[candId]},CPortal.coverttoEmp=function(){var pageid=Layout.Page.container,type="",html="",requesturl=window.location.href.indexOf("onboarding/candidate/cportal")>-1||ZPForm.FORM_DETAILS[ZPView.CURR_VIEWPARAMS.formId].iscandaddallowed?"/convertCandToDirectEmp.zp":"/users/getAddUserPage",isexcludeinvite=!1;$.ajax({type:"POST",async:!1,url:requesturl,data:{method:"getAddUserListPage",mode:"user",conreqcsr:csrfToken,isobconv:!0},success:function(data){data.pageStatus==User.allowToAddUserDirectly&&(type=1,isexcludeinvite=data.isexcludeinvite)}}),isexcludeinvite||(html+='<li onclick="CPortal.submitMapping()"><a>'+ZPI18N.getString("zp.inviteuser")+"</a></li>"),1==type&&(html+='<li onclick="CPortal.submitMapping(1)"><a>'+ZPI18N.getString("zp.addusers")+"</a></li>"),html+='<li onclick="CPortal.submitMapping(9)"><a>'+ZPI18N.getString("zp.employeeProfile(s)")+"</a></li>",pageid.find("#converttoemp").html(html)},CPortal.updateportalname=function(obj){if("portalEdit"==$(obj).attr("name"))$(obj).siblings('[name="portalValue"]').val($(obj).siblings('[name="portalName"]').text()),$(obj).siblings('[name="portalValue"]').show(),$(obj).siblings('[name="portalValue"]').trigger("select"),$(obj).hide(),$(obj).siblings('[name="portalName"]').hide();else{var portalname=$(obj).siblings('[name="portalName"]').text();if($(obj).hide(),$(obj).siblings('[name="portalName"]').show(),$(obj).siblings('[name="portalEdit"]').show(),0!=$(obj).val().trim().length&&($(obj).siblings('[name="portalName"]').text($(obj).val()),portalname!==$(obj).val())){var tempportalname=portalname;portalname=$(obj).val();Layout.Page.container;$.ajax({type:"POST",async:!1,url:CPortal.candidateURLS.UPDATEPORTALURL,data:{ZAID:CPortal.currentPortalZAID,portalName:portalname,conreqcsr:csrfToken},success:function(data){void 0!=data.error&&data.error?($(obj).siblings('[name="portalName"]').text(tempportalname),ZPeople.Message.showFailureMsg(data.msg)):(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatedsuccessfully")),CPortal.portalObj.portalName=portalname)}})}}},CPortal.verifyportalname=function(obj){var curportal=$(obj).val();curportal=(curportal=curportal?curportal.replace(/[^a-z0-9]/gi,""):"").toLowerCase(),$(obj).val(curportal)},CPortal.copyTxtToClipBoard=function(){var i,portallink="/"+(void 0===CPortal.portalObj.portalName?"":CPortal.portalObj.portalName)+ZPOnboarding.CONSTANTS.CPORTAL_CONTEXT+"/preonboarding",link=window.location.href,j=0,linkhref="";for(i=0;i<link.length&&("/"==link[i]&&j++,3!=j);i++)linkhref+=link[i];linkhref+=portallink,$("input#cportallink").val(linkhref).trigger("select");try{successCopy=document.execCommand("copy"),!1===successCopy?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.copyfailed")):ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.copysuccess"))}catch(exception){successCopy=!1,ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.copyfailed"))}return successCopy},CPortal.ClearCookies=function(){if(UDS_UPLOAD_URL.indexOf("/zfiles")>=0)window.location.href="/accounts/p/"+_LOGGEDIN_ZAID+"/logout?servicename=zohopeople&serviceurl="+window.location.href;else{var xhr=new XMLHttpRequest,logouturl=UDS_UPLOAD_URL.replace("webupload","logout");xhr.open("POST",logouturl+"?x-cli-zaid="+_LOGGEDIN_ZAID,!0),xhr.withCredentials=!0,xhr.send(),(xhr=new XMLHttpRequest).open("POST",UDS_DOWNLOAD_URL+"/logout?x-cli-zaid="+_LOGGEDIN_ZAID,!0),xhr.withCredentials=!0,xhr.send(),setTimeout(function(){window.location.href="/"+portalName+ZPOnboarding.CONSTANTS.CPORTAL_CONTEXT+"/Logout.zp?DIGEST="+zaidDigest},500)}},CPortal.getTemplateMappingdata=function(zp_type){CPortal.currentzptype=zp_type,$("#profileDiv").hide(),$("#fieldMapDiv").show(),$("#fieldMapDiv").find(".Scrcont").html(ZPeople.LOADING_HTML),$("#fieldMapDiv").find("[data-dismiss=modal]").on("click",function(){$("#profileDiv").show(),$("#fieldMapDiv").hide(),Layout.Page.container.find("#fieldMapDiv").find(".dvcom-action").addClass("DN")}),ZPeople.Request.send("/onboarding/settings/mappedFields",{},CPortal.createTemplateMapping)},CPortal.createTemplateMapping=function(data){var lefthtml='<div class="fieldMapLft"><span class="fieldMapHdr">'+ZPI18N.getString("zp.onbsettingselemp")+'</span><ul class="dragFieldMap">',righthtml='<div class="fieldMapRht"><span class="fieldMapHdr">'+ZPI18N.getString("zp.onbsettingsmap")+"</span>",mappings=data.mappings;righthtml+='<div class="fieldMapForm open" id="Sec-BasicDetails" ><h2><span><i class="IC-ar-rgt" onclick="CPortal.showhideTemplateFields(this)"></i>'+ZPI18N.getString("zp.basicdetails")+'</span></h2><ul class="dragFieldMap" id="empfield"><li lname="EmployeeID" ismandatory="true"></li><li lname="FirstName" ismandatory="true"></li><li lname="LastName" ismandatory="true"></li><li lname="EmailID" ismandatory="true"></li><li lname="Photo" ismandatory="true"></li>';var isautogenDN="",autogenopt="",mappasswordopt="checked";for(CPortal.isautogenpassword=data.ispasswordautogen,data.ispasswordautogen&&(autogenopt="checked",mappasswordopt="",isautogenDN="DN"),righthtml+='<li lname="password" ismandatory="true"><div class="DIB W100I"><span>'+ZPI18N.getString("zp.passwd")+"</span>",righthtml+='<span><div id="autogenpassworddiv" class="radio radio-primary PT15" style="line-height: normal;"><input onchange="CPortal.toggAutoGenPwd(this)" id="autogenPassword" type="radio" name="passwordradio" '+autogenopt+'><label for="autogenPassword">Use auto generated password</label></div><div id="mapPasswordDiv" class="radio radio-primary DIB style="line-height: normal;""><input onchange="CPortal.toggAutoGenPwd(this)" id="mapPasswordopt" type="radio" '+mappasswordopt+' name="passwordradio"><label for="mapPasswordopt">'+ZPI18N.getString("zp.selectfieldfromcand")+'</label></div><i class="IC-info ML10 PA" data-content="" data-placement="top" data-trigger="hover" data-toggle="popover" zptitle="" data-original-title="'+ZPI18N.getString("zp.onbpasswordtooltip")+'"></i>',righthtml+='<div class="'+isautogenDN+'"  style="position: relative;top: -15px;"  id="passwordmapselect"><select class="selectFld">'+CPortal.selectOptions(data.Candcol.NONTABULARSECTION,zpconst.FieldType.TEXT,void 0,mappings&&void 0!=mappings.password?mappings.password:void 0,!0)+"</select></div>",righthtml+="<span></li>",righthtml+="</ul></div></div>",Layout.Page.container.find("#fieldMapDiv").find(".Scrcont").html(righthtml),righthtml="",CPortal.candcol=data.Candcol,i=0;i<data.Empcol.length;i++){var open=0==i?"open":"",DN=0==i?"":"DN",rtemphtml="",ltemphtml="",sel="",candsec=data.Empcol[i].isTabular?data.Candcol.TABULARSECTION:data.Candcol.NONTABULARSECTION,html=CPortal.templateFields(data.Empcol[i].col1Fields,candsec,mappings);ltemphtml+=html.left,rtemphtml+=html.right;var c1allsel=html.allsel;ltemphtml+=(html=CPortal.templateFields(data.Empcol[i].col2Fields,candsec,mappings)).left,rtemphtml+=html.right,c1allsel&&html.allsel&&(sel="sel"),lefthtml=lefthtml+'<li class="'+open+'" id="Sec-'+data.Empcol[i].id+'" isTabular='+data.Empcol[i].isTabular+'><div><i class="IC-ar-rgt" onclick="CPortal.showhideTemplateFields(this)"></i><span  id="secname">'+data.Empcol[i].name+'</span><i id="leftsec" class="IC-chk-box2 '+sel+"\" onclick=\"CPortal.selectTemplateFields('SecType','Sec-"+data.Empcol[i].id+'\' )" ></i></div><ul id="empfield" class='+DN+">"+ltemphtml+"</ul>",DN="DN",rtemphtml&&(DN=""),righthtml=righthtml+'<div class="fieldMapForm open '+DN+'" id="Sec-'+data.Empcol[i].id+'"><h2><span><i class="IC-ar-rgt" onclick="CPortal.showhideTemplateFields(this)"></i>'+data.Empcol[i].name+'</span></h2><ul class="dragFieldMap" id="empfield">'+rtemphtml+"</ul></div>"}lefthtml+="</div>",Layout.Page.container.find("#fieldMapDiv").find(".Scrcont").append(lefthtml),Layout.Page.container.find("#fieldMapDiv").find(".Scrcont .fieldMapRht").append(righthtml),Layout.Page.container.find("#fieldMapDiv").find(".dvcom-action").removeClass("DN"),Layout.Page.container.find("select").select2(),$('[data-toggle="popover"]').popover()},CPortal.templateFields=function(coldata,candsec,mappings){var html={right:"",left:"",allsel:!0};for(j=0;j<coldata.length;j++){var sel="",map=mappings&&void 0!=mappings[coldata[j].lname]?mappings[coldata[j].lname]:void 0,isBasicFields=$.inArray(coldata[j].lname,["EmployeeID","FirstName","LastName","EmailID","Photo"])>-1,isecfields=!!isBasicFields&&($.inArray(coldata[j].lname,["FirstName","EmailID"])>-1||"LastName"===coldata[j].lname&&coldata[j].isMandatory),ismantry="",click="onclick=\"CPortal.selectTemplateFields('FieldType','"+coldata[j].lname+"')\"",star="";if(isBasicFields){"EmailID"===coldata[j].lname&&(ismantry='class="mantry"',star="*");var temphtml='<li class="'+($.inArray(coldata[j].lname,["FirstName","LastName"])>-1?"NM OP5":"")+'" lname="'+coldata[j].lname+'" isMandatory='+coldata[j].isMandatory+' ><div><span class="txt-ovr-flw" '+ismantry+">"+star+coldata[j].name+'</span><span id="onbselectmap"><select class="selectFld">'+CPortal.selectOptions(candsec,coldata[j].c_type,coldata[j].s_type,map,void 0,coldata[j].lname)+"</select></span></div></li>";Layout.Page.container.find("#fieldMapDiv").find(".Scrcont .fieldMapRht").find("[lname="+coldata[j].lname+"]").replaceWith(temphtml)}else{if(void 0!=map){sel="sel";var close=isecfields?"":"<i class=\"IC-cls-1px\" onclick=\"CPortal.selectTemplateFields('FieldType','"+coldata[j].lname+"')\" ></i>";html.right+='<li lname="'+coldata[j].lname+'" isMandatory='+coldata[j].isMandatory+' ><div><span class="txt-ovr-flw" '+ismantry+" >"+star+coldata[j].name+'</span><span id="onbselectmap"><select class="selectFld">'+CPortal.selectOptions(candsec,coldata[j].c_type,coldata[j].s_type,map,void 0,coldata[j].lname)+"</select></span>"+close+"</div></li>"}else html.allsel=!1;html.left+="<li lname="+coldata[j].lname+" isMandatory="+coldata[j].isMandatory+" c_type="+coldata[j].c_type+" s_type="+coldata[j].s_type+"><div><span "+ismantry+" >"+star+coldata[j].name+'</span><i class="IC-chk-box2 '+sel+' " '+click+" ></i></div></li>"}}return html},CPortal.selectTemplateFields=function(type,id){var pageid=Layout.Page.container;if("SecType"==type){var excludefields='[lname="FirstName"],[lname="EmailID"]';"true"==pageid.find(".fieldMapLft").find('[lname="LastName"]').attr("ismandatory")&&(excludefields+=',[lname="LastName"]');var leftsecdiv=pageid.find(".fieldMapLft").find("#"+id),rightsecdiv=pageid.find(".fieldMapRht").find("#"+id);if(leftsecdiv.find("#leftsec").hasClass("sel"))leftsecdiv.find("#leftsec").removeClass("sel"),leftsecdiv.find("#empfield").find("li").not(excludefields).find(".IC-chk-box2").removeClass("sel"),0==rightsecdiv.find(excludefields).length?(rightsecdiv.find("li").remove(),rightsecdiv.addClass("DN")):rightsecdiv.find("li").not(excludefields).remove();else{rightsecdiv.removeClass("DN"),leftsecdiv.find("#leftsec").addClass("sel");var candsec=$(leftsecdiv).attr("istabular")&&"true"==$(leftsecdiv).attr("istabular")?CPortal.candcol.TABULARSECTION:CPortal.candcol.NONTABULARSECTION;$.each($(leftsecdiv).find("#empfield").find("li .IC-chk-box2").not(".sel"),function(index,elm){$(elm).addClass("sel"),elm=$(elm).closest("li");var html='<li lname="'+$(elm).attr("lname")+'" isMandatory='+$(elm).attr("isMandatory")+' ><div><span class="txt-ovr-flw">'+AutomationCommon.htmlEncode($(elm).find("span").text())+'</span><span id="onbselectmap"><select class="selectFld">'+CPortal.selectOptions(candsec,$(elm).attr("c_type"),$(elm).attr("s_type"),void 0,void 0,$(elm).attr("lname"))+"</select></span><i class=\"IC-cls-1px\" onclick=\"CPortal.selectTemplateFields('FieldType','"+$(elm).attr("lname")+"')\" ></i></div></li>";rightsecdiv.find("ul").append(html)})}}else{var leftfielddiv=pageid.find(".fieldMapLft").find('[lname="'+id+'"]');if(leftfielddiv.find(".IC-chk-box2").hasClass("sel"))leftfielddiv.find(".IC-chk-box2").removeClass("sel"),leftfielddiv.closest("[id^=Sec-]").find("#leftsec").removeClass("sel"),0==leftfielddiv.closest("ul").find(".sel").length&&pageid.find(".fieldMapRht").find('[lname="'+id+'"]').closest("[id^=Sec-]").addClass("DN"),pageid.find(".fieldMapRht").find('[lname="'+id+'"]').remove();else{candsec=leftfielddiv.closest("[id^=Sec-]").attr("istabular")&&"true"==leftfielddiv.closest("[id^=Sec-]").attr("istabular")?CPortal.candcol.TABULARSECTION:CPortal.candcol.NONTABULARSECTION;leftfielddiv.find(".IC-chk-box2").addClass("sel"),0==leftfielddiv.closest("ul").find(".IC-chk-box2").not(".sel").length&&leftfielddiv.closest("[id^=Sec-]").find("#leftsec").addClass("sel");var html='<li lname="'+leftfielddiv.attr("lname")+'" isMandatory='+leftfielddiv.attr("isMandatory")+' ><div><span class="txt-ovr-flw">'+AutomationCommon.htmlEncode(leftfielddiv.find("span").text())+'</span><span id="onbselectmap"><select class="selectFld">'+CPortal.selectOptions(candsec,leftfielddiv.attr("c_type"),leftfielddiv.attr("s_type"),void 0,void 0,leftfielddiv.attr("lname"))+"</select></span><i class=\"IC-cls-1px\" onclick=\"CPortal.selectTemplateFields('FieldType','"+leftfielddiv.attr("lname")+"')\" ></i></div></li>",secid=leftfielddiv.closest("[id^=Sec-]").attr("id"),index=leftfielddiv.closest("ul").find(".sel").closest("[lname]").index(leftfielddiv);pageid.find(".fieldMapRht").find("#"+secid).removeClass("DN"),0==index?pageid.find(".fieldMapRht").find("#"+secid).find("ul").prepend(html):pageid.find(".fieldMapRht").find("#"+secid).find("ul").find("li:nth-of-type("+index+")").after(html)}}pageid.find("select").select2()},CPortal.showhideTemplateFields=function(elm){elm=$(elm).closest("[id^=Sec-]"),$(elm).hasClass("open")?($(elm).removeClass("open"),$(elm).closest(".fieldMapLft").length>0&&$(elm).find("#empfield").addClass("DN")):($(elm).addClass("open"),$(elm).closest(".fieldMapLft").length>0&&$(elm).find("#empfield").removeClass("DN"))},CPortal.saveTemplate=function(){var pageid=Layout.Page.container.find(".fieldMapRht"),mandfields=["FirstName","EmailID"];"true"==pageid.find('[lname="LastName"]').attr("ismandatory")&&(mandfields[3]="LastName");var mappings={},error=!1;if($(pageid).find(".err").removeClass("err"),$(pageid).find(".errDiv").remove(),CPortal.isautogenpassword||(mappings.password=$(pageid).find("[lname=password]").find("select").val()),$.each($(pageid).find("[lname]").not("[lname=password]"),function(index,elm){var key=$(elm).attr("lname"),val=$(elm).find("select").val();mappings[key]=val,$.inArray(key,mandfields)>-1&&(!val||"-1"==val)&&(error=!0,$(elm).find("div").addClass("err"),$(elm).find("#onbselectmap").append('<div class="errDiv red">'+ZPI18N.getString("zp.MandatoryFieldMap")+"</div>"))}),!error){var params={parmode:"savemapping",mappingsObj:JSON.stringify(mappings),ispswdautogen:CPortal.isautogenpassword};ZPeople.Request.send("/saveMappingTemplate.zp",params,CPortal.handleresultofsaveTemp)}},CPortal.handleresultofsaveTemp=function(data){data.isSuccess&&(Layout.Page.container.find("#fieldMapDiv #fieldMapClose").trigger("click"),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updatesuccessful")))},CPortal.tempAct=function(obj){var pageid=$("#ZPconvert").find("#PasswordInput");"newPassword"==obj.id?(pageid.find("#newPassword").removeClass("DN"),pageid.find("#chsPassword").addClass("DN"),CPortal.passwordtype=1):(pageid.find("#newPassword").addClass("DN"),pageid.find("#chsPassword").removeClass("DN"),CPortal.passwordtype=0)},CPortal.toggAutoGenPwd=function(obj){pagid=Layout.Page.container.find(".fieldMapRht").find('[lname="password"]'),"autogenPassword"==obj.id?(pagid.find("#passwordmapselect").addClass("DN"),CPortal.isautogenpassword=!0):(pagid.find("#passwordmapselect").removeClass("DN"),CPortal.isautogenpassword=!1)},NewZPOnboarding={tabsOrder:[],onboardingDetails:{},isInitiated:!1,tabsJson:{},activeTab:"",contactHR:{},totalTabs:0,singleTabAngle:0},NewZPOnboarding.Feeds={},NewZPOnboarding.staticTabs=["Welcome","Forms","AllSet","Checklist","Profile"],NewZPOnboarding.nondragableTabs=["Welcome","Forms","AllSet","Checklist","Profile"],NewZPOnboarding.tabToClassMap={Welcome:"zo_wFeed",Forms:"zo_profile",Profile:"zo_profile",Agreements:"zo_dtbs",Team:"zo_team",Objectives:"zo_kraG",Organization:"zo_events",AllSet:"zo_gS",LMS_Course:"zo_team"},NewZPOnboarding.iconClassMap={Welcome:"PI_product_videos",Forms:"PI_onb_user",Profile:"PI_onb_user",Agreements:"PI_list",Team:"PI_dept",Objectives:"PI_qt_hs",Organization:"PI_org",AllSet:"PI_tick2_fil",LMS_Course:"PI_book"},NewZPOnboarding.currentDoc={},NewZPOnboarding.completeTabs={},NewZPOnboarding.iFrameTemplate='<iframe id="$ID$" src="$SRC$" width="100%" height="100%"></iframe>',NewZPOnboarding.docError='<blockquote id="docFrame" class="blockquote"><span><i class="IC-alert"></i></span><p>$MSG$</p></blockquote>',NewZPOnboarding.config={},NewZPOnboarding.isPreview=void 0,NewZPOnboarding.applicableConstants={1:"role",2:"desgn"},NewZPOnboarding.obTemplates={},NewZPOnboarding.picklistComponentTemplate="<div class='input-group dropdown' id='pickListComp'><div id='key_list' class='form-control DN'></div><span aria-expanded='false' class='input-group-addon BL0I' data-toggle='dropdown'><i class='IC-addlist gry CP'></i></span><div class='dropdown-menu ZPCusPd ZPappBox  ZPCmn-Arrow top gray'><div class='ZPTabVt'><div class='lfttab'><ul id='leftSideActiveKeyList' role='tablist' class='nav nav-pills nav-stacked'></ul></div><div class='rhttabscrl'><div class='tab-content'><div class='tab-pane active' role='tabpanel'><div><div class='ZPtopSearch'><label class='checkbox DIB FL PT8 MR10' title='Select All'><input id='zp_sharedto_all_checkbox' type='checkbox' onClick='ZPPickList.allCheckSelection()'><span></span></label><div class='ZPsearch' id='ZPsearch'><div class='dvsearch Dropdown PR'><span class='ZPico-search FL MT2 ML8 ZPtooltip IC-lens S16' zptitle='Search Category'></span></div><input type='search' class='ZPselect' id='dvZPselect' placeholder='"+ZPI18N.getString("zp.search")+"' value='' name='Search'></div></div><div class='ZPapplCb'><ul id='searchResult_ul'></ul></div></div></div></div></div></div></div></div>",NewZPOnboarding.filter={},NewZPOnboarding.obTemplatesList={},NewZPOnboarding.isFilterInitiatedforcand=!1,NewZPOnboarding.isFilterInitiatedforemp=!1,NewZPOnboarding.isOnboardingFilter=!1,NewZPOnboarding.isMassCheck=!1,NewZPOnboarding.isFilterEmptyforcand=!0,NewZPOnboarding.isFilterEmptyforemp=!0,NewZPOnboarding.selectedHeader="",NewZPOnboarding.MODE="onboarding",NewZPOnboarding.EmployeeForm={id:"",name:""},NewZPOnboarding.CandidateForm={id:"",name:""},NewZPOnboarding.isAddChecklist=!1,NewZPOnboarding.configbyid={},NewZPOnboarding.Selectedchecklist=[],NewZPOnboarding.obFormsList={1:[],2:[]},NewZPOnboarding.obFormsListmmTemplate="",NewZPOnboarding.currentFlowType="",NewZPOnboarding.reports={},NewZPOnboarding.allReport={},NewZPOnboarding.isPAAdmin=void 0,NewZPOnboarding.applicabilityList={},NewZPOnboarding.MAX_EDITOR_HEIGHT=200,NewZPOnboarding.HRTEMP_OPTTYPE="2",NewZPOnboarding.latitude,NewZPOnboarding.longitude,NewZPOnboarding.statusConstants={ONBOARDING_NOT_CONFIGURED:0,ONBOARDING_NOT_TRIGGERED:1,ONBOARDING_STARTED:2,ONBOARDING_COMPLETED:3,TRIGGERED_ONBOARDING:-1,USER_COMPLETE:4,ONBOARDING_REOPEN:5,CONVERTED:6},NewZPOnboarding.CONSTANTS={INVALID_USER:-1,ALREADY_POPULATED:1,NO_ONBOARDING:2,OTHER_ERROR:3,POPULATE_SUCCESS:0,CANDIDATE_ONBOARDING_TYPE:2,EMPLOYEE_ONBOARDING_TYPE:1,CPORTAL_CONTEXT:"/cp"},NewZPOnboarding.dropdownOptions={fitForElement:!0,height:"300px"},NewZPOnboarding.FireScroll={},NewZPOnboarding.Filter={CandKeyVal:{},EmpKeyVal:{}},NewZPPreboarding={},NewZPOnboarding.empPoralRedirection=function(){let alertMessageObj=new InfoAlertMessage;alertMessageObj.title=ZPI18N.getString("zp.Onboarding"),alertMessageObj.despcription=ZPI18N.getString("zp.completeonboarding",["/"+portalname+"/onboarding"]),alertMessageObj.yesButtonText="",alertMessageObj.cancelButtonText=ZPI18N.getString("zp.done"),alertMessageObj.show()},NewZPOnboarding.configList=function(){NewZPOnboarding.currentFlowType=NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE,ZPA_Common[ZPA_Common.getFormListMode(ZPA_Common.getPageMode(),ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.WEBHOOK,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.FIELDUPDATE,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.TASK,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.CHECKLIST,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())]=void 0,0!=settingsPage.container.find("tr[obid]").length&&0!=Object.keys(NewZPOnboarding.obTemplatesList).length||(settingsPage.container.html(ZPeople.LOADING_HTML),ZPeople.Request.send("/onboarding/flow/list",{onboarding_type:NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE},NewZPOnboarding.configListingPage,{},NewZPOnboarding.failureCallBack))},NewZPOnboarding.configListingPage=function(data,params){if(null!=data){var obList="";if(params.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE){var portalname=void 0===NewCPortal.portalObj.portalName?"":NewCPortal.portalObj.portalName;obList='<div class="zpl_btnmnu"><div class="zpl_lft"><b>'+ZPI18N.getString("zp.sandbox.portalname")+' : </b><span><em  name="portalName">'+portalname+'</em> <input type="text" placeholder="'+ZPI18N.getString("zp.onb.enterportalname")+'" class="ztextbox w100" onkeyup="NewCPortal.verifyportalname(this)" name="portalValue" value="'+portalname+'" onblur="NewCPortal.updateportalname(this)"" maxlength = "40" style="display: none;"><i class="zpl_ibg PI_edt" title="'+ZPI18N.getString("zp.onb.editportalname")+'" onclick="NewCPortal.updateportalname(this)" name="portalEdit"></i></span>  <span><em>'+ZPI18N.getString("zp.copyportallink")+'&nbsp;</em><i class="zpl_ibg PI_cpy" title="'+ZPI18N.getString("zp.newcopyportallink")+'"onclick=NewCPortal.copyTxtToClipBoard()></i><input type="text" class="valselect" id="cportallink" value="" style="opacity: 0; z-index: -1; position: absolute;"></span> </div> <div class="zpl_rgt"><button class="zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.addNewOnboarding();">'+ZPI18N.getString("zp.addnewflow")+"</button></div> </div>"}else obList='<div class="zpl_btnmnu"><div class="zpl_rgt"><button class="zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.addNewOnboarding();">'+ZPI18N.getString("zp.addnewflow")+"</button></div></div>";obList+='<div class="zpl_rgtcnt"><div class="zpl_tblres"><table class="zpl_tbl">',obList+="<thead><tr><th>"+ZPI18N.getString("zp.onbflowname")+"</th><th>"+ZPI18N.getString("zp.onbapplicablefor")+"</th><th>"+ZPI18N.getString("zp.status")+'</th><th width="120"><div class="text-center"></div></th></tr></thead>',obList+='<tbody id="onbflowtabele"></tbody></table></div></div>',settingsPage.container.html(obList),settingsPage.container.addClass("zpl_tblfxd");var table=settingsPage.container.find("#onbflowtabele");$.each(data,function(ind,ob){NewZPOnboarding.obTemplatesList[ob.ONBOARDINGID]=ob,table.append(NewZPOnboarding.config.obRowCreate(ob)),ZPeopleComponents.toggleswitch(settingsPage.container.find("[obid="+ob.ONBOARDINGID+"]").find(".onbflowstaus"),{on:ob.IS_VISIBLE,change:NewZPOnboarding.changeStatus})}),table.ztooltip(),void 0!=ZPPickList.allData&&null!=ZPPickList.allData||$.ajax({type:"POST",async:!1,url:"/createViewAction.zp",data:{mode:"getAllRecords",conreqcsr:csrfToken},success:function(data){ZPPickList.allData=data}}),params.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(listContainer=settingsPage.container.find("#onbflowtabele"),listContainer.sortable({axis:"y",handle:".PI_drag",items:"tr[issys=false]",helper:function(e,tr){var $originals=tr.children(),$helper=tr.clone();return $helper.children().each(function(index){$(this).width($originals.eq(index).width())}),$helper},update:function(){listContainer.sortable("disable");const flowTr=listContainer.find("tr");let flowIdList=Array();$.each(flowTr,function(index,value){const flowId=$(this).attr("obId");flowIdList.push(flowId)});let params={};params.flowPriorityOrder=JSON.stringify(flowIdList.reverse()),params.onbType=NewZPOnboarding.currentFlowType,ZPeople.Request.send("/onboarding/flow/changePriority",params,function(resultData){listContainer.sortable("enable"),ZPUtil.Validation.isEmpty(resultData)||(resultData.code===ZPeople.ResponeCodes.SUCCESS?ZPeople.Message.success(ZPI18N.getString("zp.flowupdatesuccessmsg")):ZPeople.Message.failure(ZPI18N.getString("zp.flowfailuremsg")))})}}))}},NewZPOnboarding.candidateconfigList=function(){ZPA_Common[ZPA_Common.getFormListMode(ZPA_Common.getPageMode(),ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.WEBHOOK,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.FIELDUPDATE,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.TASK,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.CHECKLIST,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())]=void 0,NewZPOnboarding.currentFlowType=NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE,0==settingsPage.container.find("tr[obid]").length||0==Object.keys(NewZPOnboarding.obTemplatesList).length?(settingsPage.container.html(ZPeople.LOADING_HTML),NewCPortal.currentPortalZAID||$.ajax({type:"POST",async:!1,url:NewCPortal.candidateURLS.CPORTALURL,data:{conreqcsr:csrfToken},success:function(data){if(0==Object.keys(data).length||void 0==data.portalName){var html='<div class="zpl_rgtcnt zpl_crdwthful h100_per"><div class="zpl_crd h100_per d-flex j-cnt-cntr"><div class="zpl_crdcnt zpl_crdinfo"><div class="zpl_Emptydata"><div><h4>'+ZPI18N.getString("zp.setupcandidateportal")+"</h4><p>"+ZPI18N.getString("zp.startnamingportal")+'</p><div class="zpl_obprtimg"></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.sandbox.portalname")+'</label></div><div><input type="text" placeholder="'+ZPI18N.getString("zp.onb.enterportalname")+'" class="ztextbox" onkeyup="NewCPortal.verifyportalname(this)" id="add_cportal"></div></div><div class="zpl_secn"><button id="ZPAtt_DeviceSett_saveKiosk" class="zlabel zlabel--blue zlabel--medium" onclick="NewCPortal.createPortal(this);">'+ZPI18N.getString("zp.save")+'</button></div></div></div><div class="zpl_info"><div><p> '+ZPI18N.getString("zp.onboardinghelp")+' </p><a class="zpl_lnktxt" href="https://www.zoho.com/people/help/adminguide/onboarding-new.html#candidateprocess" target="_blank">'+ZPI18N.getString("zp.learnmore")+"</a></div></div></div></div></div>";settingsPage.container.html(html)}else NewCPortal.currentPortalZAID=data.ZAID,NewCPortal.portalObj=data},error:function(err){NewZPOnboarding.failureCallBack(err)}}),NewCPortal.currentPortalZAID&&ZPeople.Request.send("/onboarding/flow/list",{onboarding_type:NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE},NewZPOnboarding.configListingPage,{},NewZPOnboarding.failureCallBack)):settingsPage.container.find("#obconfig").addClass("DN")},NewZPOnboarding.config.obRowCreate=function(ob){var flowurl="#settings/service/onboarding/employeeflow/editflow-obId:"+ob.ONBOARDINGID;let dragCls="",isCandFlow=NewZPOnboarding.currentFlowType===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE;isCandFlow&&(dragCls=ob.IS_SYSTEM?"":"PI_drag",flowurl="#settings/service/onboarding/candidateflow/editflow-obId:"+ob.ONBOARDINGID);var obList='<tr obid="'+ob.ONBOARDINGID+'" isSys='+ob.IS_SYSTEM+"><td onclick=window.open('"+flowurl+'\',"_self")><div class="d-flexC"><div class="zpl_tbldrag"><div class="zpl_hvr"><i class="'+dragCls+'"></i></div></div><span class="txttrim w300" id="'+ob.ONBOARDINGID+'" title="'+ob.DISPLAY_NAME+'">'+ob.DISPLAY_NAME+"</span></div></td>";if(obList+="<td>",void 0!=ob.applicableFor){obList+="";var applicable="";$.each(ob.applicableFor,function(key,json){var jsonLength=Object.keys(json).length;if(0!=jsonLength){var keyName='<div class="zpl_tg"><span>';switch(key){case"empList":keyName+=ZPI18N.getString("zp.users")+":";break;case"deptList":keyName+=ZPI18N.getString("zp.departments")+":";break;case"desList":keyName+=ZPI18N.getString("zp.designations")+":";break;case"roleList":keyName+=ZPI18N.getString("zp.roles")+":";break;case"locList":keyName+=ZPI18N.getString("zp.locations")+":"}keyName+="</span></div>",applicable.length>0&&(applicable+="; "),applicable+=keyName+" <span>";var jsonInd=1;$.each(json,function(jsonKey,jsonValue){applicable+=jsonValue,jsonInd++!=jsonLength&&(applicable+=", ")})}}),obList+=applicable+"</span>"}else obList+='<div class="zpl_tg"><span>'+ZPI18N.getString("zp.all")+"</span></div>";obList+="</td>",obList+=isCandFlow&&ob.IS_SYSTEM?"<td></td>":'<td><span class="onbflowstaus"></span></td>',obList+='<td><div class="text-center"><div class="zpl_hvr">',obList+='<i class="PI_edt" title='+ZPI18N.getString("zp.edit")+' onclick="NewZPOnboarding.addNewOnboarding(this)"> </i>';var obId=ob.ONBOARDINGID.toString();return obList+=ob.IS_SYSTEM?" ":'<i class="PI_delete" title='+ZPI18N.getString("zp.delete")+"  onclick=\"NewZPOnboarding.deleteOnboarding('"+obId+"')\"> </i>",obList+="</div></div></td>",obList+="</tr>"},NewZPOnboarding.changeStatus=function(obj){obj.detail&&obj.detail.fromUI&&ZPeople.Request.send("/onboarding/flow/enableDisable",{ONBOARDINGID:obj.detail.element.parents("tr").attr("obid"),IS_VISIBLE:obj.detail.state},NewZPOnboarding.changeStatusResponse,{obj:obj},NewZPOnboarding.changeStatusFailureResponse)},NewZPOnboarding.changeStatusResponse=function(data,params,others){if(data.msg==zpconst.CommonMessages.SUCCESSMSG)ZPeople.Message.success(ZPI18N.getString("zp.updatesuccessful")),NewZPOnboarding.obTemplatesList[params.ONBOARDINGID].IS_VISIBLE=params.IS_VISIBLE,ZPeopleComponents.toggleswitch($(others.obj.detail.element)).setAttribute("on",params.IS_VISIBLE);else if(void 0!=data.msg)FrameworkCommon.showInfoAlert("",data.msg),ZPeopleComponents.toggleswitch($(others.obj.detail.element)).setAttribute("on",!params.IS_VISIBLE);else if(data.hasOwnProperty("empmaillist")){var html="<p>"+ZPI18N.getString("zp.onbactionerror")+"</p><p>"+ZPI18N.getString("zp.confirmonbdelte")+"</p>";html+='<div class="row frmsettings dvConfirm"><ul class="list-group col-md-10 col-md-offset-1 MT10"><li class="list-group-item ZPbold active"><span id="associationName">'+ZPI18N.getString("zp.employees")+"</span></li>";var erecnoobj=[];$.each(data.empmaillist,function(index1,emp){$.each(emp,function(id,email){erecnoobj[index1]=id,html+='<li class="list-group-item"><a onclick="window.open(\'#operations/organization/employee/view-recordId:'+id+"','_blank')\">"+email+"</a></li>"})}),html+="</ul></div>",FrameworkCommon.showInfoAlert(ZPI18N.getString("zp.editonbflow"),html,{callback:NewZPOnboarding.clearOnboarding,isCancelNeeded:!0,doneBtn:ZPI18N.getString("zp.confirm"),details:JSON.stringify(erecnoobj)})}},NewZPOnboarding.changeStatusFailureResponse=function(data,param,others){ZPeopleComponents.toggleswitch($(others.obj.detail.element)).setAttribute("on",!param.IS_VISIBLE)},NewZPOnboarding.clearOnboarding=function(erecnoobj){var pageid=settingsPage.container;$.ajax({type:"POST",async:!1,url:"/onboarding/reports/clearOnboarding",data:{erecnoobj:erecnoobj,conreqcsr:csrfToken},success:function(data){"success"==data.msg&&ZPeople.Message.success(ZPI18N.getString("zp.removesuccessful")),pageid.find("#usersOptions").addClass("DN"),pageid.find("#licenseDtlsRow").removeClass("DN"),pageid.find("table#userListTable input[name='userRowCheck']").prop("checked",!1)}}),$("#confirmationPopup").find(".modal-header").find('[name="subHeader"]').remove(),$("#confirmationPopup").find(".modal-dialog").addClass("modal-center")},NewZPOnboarding.configInit=function(){let hashUrl=Layout.Page.hash;if(-1!==hashUrl.indexOf("settings/service/onboarding/employeeflow/editflow")||-1!==hashUrl.indexOf("settings/service/onboarding/candidateflow/editflow"))if(NewZPOnboarding.currentOB={},NewZPOnboarding.currentOB.ONBOARDINGID=settingsUrlProps.urlParamsArr.obId,void 0!=NewZPOnboarding.obTemplatesList[NewZPOnboarding.currentOB.ONBOARDINGID]&&(NewZPOnboarding.currentOB.onboarding_type=NewZPOnboarding.obTemplatesList[NewZPOnboarding.currentOB.ONBOARDINGID].ONBOARDING_TYPE),NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID])NewZPOnboarding.config.forms=NewZPOnboarding.obFormsList[NewZPOnboarding.currentOB.onboarding_type],NewZPOnboarding.configLayout=settingsPage.container,NewZPOnboarding.configPage();else{var params={ONBOARDINGID:NewZPOnboarding.currentOB.ONBOARDINGID,getForms:!0};ZPeople.ALL_USER_LOADED||ZPeople.sendUserListAjax(null,null,!0),void 0==NewZPOnboarding.isPAAdmin&&(params.isPAAdmin=!0),ZPeople.Request.send("/onboarding/flow/get",params,NewZPOnboarding.configPage,{},NewZPOnboarding.failureCallBack),NewZPOnboarding.configLayout=settingsPage.container,settingsPage.container.append(ZPeople.LOADING_HTML)}else-1!==hashUrl.indexOf("settings/service/onboarding/employeeflow")?NewZPOnboarding.currentFlowType=NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE:-1!==hashUrl.indexOf("settings/service/onboarding/candidateflow")&&(NewZPOnboarding.currentFlowType=NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE)},NewZPOnboarding.configdata={},NewZPOnboarding.configPage=function(data){settingsPage.container.find("#zp_page_loading").remove(),settingsPage.container.removeClass("zpl_tblfxd"),NewZPOnboarding.config.tabDescTemplate='<div class="zpl_secn" errordiv="cantbeempty"><div><label><b>'+ZPI18N.getString("zp.description")+'</b></label></div><div><textarea name="DESCRIPTION" type="text" maxlength="10000" placeholder="'+ZPI18N.getString("zp.descplaceholder")+'" rows="4" class="ztextbox">$VALUE$</textarea></div></div>',void 0!=data&&null!=data&&(void 0==NewZPOnboarding.isPAAdmin&&(NewZPOnboarding.isPAAdmin=data.isPAAdmin),void 0!=ZPPickList.allData&&null!=ZPPickList.allData||$.ajax({type:"POST",async:!1,url:"/createViewAction.zp",data:{mode:"getAllRecords",conreqcsr:csrfToken},success:function(data){ZPPickList.allData=data}}),NewZPOnboarding.currentOB.onboarding_type=data.onboarding_type,void 0!=data.forms&&(NewZPOnboarding.obFormsList[NewZPOnboarding.currentOB.onboarding_type]=data.forms,delete data.forms),data.formsfortemplate&&(NewZPOnboarding.obFormsListmmTemplate=data.formsfortemplate,delete data.formsfortemplate),data.onboardingtabid&&(NewZPOnboarding.onboardingTABID=data.onboardingtabid,delete data.onboardingtabid),NewZPOnboarding.allowNewUI=data.allowNewUI,NewZPOnboarding.configbyid[data.onBoardingId]=data),NewZPOnboarding.removeViewApplicable();let onbConfigObj=NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID];if(settingsPage.container.attr("onBoardingId",NewZPOnboarding.currentOB.ONBOARDINGID),settingsPage.container.attr("onboarding_type",NewZPOnboarding.currentOB.onboarding_type),NewZPOnboarding.config.data=NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID],NewZPOnboarding.config.forms=NewZPOnboarding.obFormsList[NewZPOnboarding.currentOB.onboarding_type],NewZPOnboarding.teamMembers=ZPeople.ALL_USER_LOADED?ZPeople.ALL_USERLIST:ZPeople.sendUserListAjax(null,null,!0),NewZPOnboarding.roles=NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID].roles,NewZPOnboarding.mmTemplates=NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID].mmTemplates,NewZPOnboarding.hrFiles=NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID].hrfiles,NewZPOnboarding.config.activeTab=NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID].activeTab,NewZPOnboarding.currentFlowType=NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID].onboarding_type,NewZPOnboarding.hrFormsTemplate=Array.isArray(onbConfigObj.hrFormTemp)?onbConfigObj.hrFormTemp:[],NewZPOnboarding.currentFlowType==NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?(NewZPOnboarding.CandidateForm.id=NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID].candidateform.formId,NewZPOnboarding.CandidateForm.name=NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID].candidateform.formName,ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())]=[],ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())].push({formId:NewZPOnboarding.CandidateForm.id,compName:NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID].candidateform.componentName,dispName:ZPeople.decodeTxt(NewZPOnboarding.configbyid[NewZPOnboarding.currentOB.ONBOARDINGID].candidateform.formName),tableName:"P_Candidate"}),ZPA_Common[ZPA_Common.getFormListMode(ZPA_Common.getPageMode(),ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.WEBHOOK,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.FIELDUPDATE,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.TASK,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.CHECKLIST,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())]):NewZPOnboarding.config.formsformm=NewZPOnboarding.obFormsListmmTemplate,void 0!=NewZPOnboarding.config.data){var tabDetails=NewZPOnboarding.config.data.tabDetails;NewZPOnboarding.tabsOrder=NewZPOnboarding.config.data.tabsOrder;var templateDetails=NewZPOnboarding.config.data.templateDetails;NewZPOnboarding.obTemplatesList[templateDetails.ONBOARDINGID]=templateDetails;var maindiv='<div data-modal-box="emponboardingMdl" class="zpl_mdl zpl_mcntlst zpl_mfull zpl_mopen"><div class="zpl_minr" obid="'+templateDetails.ONBOARDINGID+'">',flowurl=NewZPOnboarding.currentFlowType===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?"zp#settings/service/onboarding/candidateflow":"zp#settings/service/onboarding/employeeflow";maindiv+='<div class="zpl_mhder"><div>',NewZPOnboarding.applicabilityList={},NewZPOnboarding.applicabilityList=NewZPOnboarding.applicableForBuild(templateDetails.applicableFor),maindiv+='<a id="configCloseArw" class="clsArw" onclick=window.open(\''+flowurl+'\',"_self")><i class="PI_back"></i></a>',maindiv+='<span><span class="txttrim w300" id="dispNm" title="'+templateDetails.DISPLAY_NAME+'">'+templateDetails.DISPLAY_NAME+"</span></span></div>",maindiv+='<div class="zpl_mhdercnt"><div class="zpl_mappcble" id="applicable"><em><b><a class="zpl_drpdwn-js" id="viewapplicability">'+ZPI18N.getString("zp.onb.applicable")+"</a></b></em>",maindiv+='<i class="PI_edt"onclick="NewZPOnboarding.addNewOnboarding(this)"></i>',maindiv+="</div></div>",maindiv+='<a id="configCloseMark" class="PI_cls _cls" onclick=window.open(\''+flowurl+'\',"_self")></a></div>',maindiv+='<div class="zpl_mcnt"><div class="zpl_mmnu">';var configLeftHtml='<div class="zpl_mmnulft" id="configTabs"><ul id="onbconfigtab">',configRightHtml='<div class="zpl_mmnurgt zpl_crdwthful" id="tabData">',isOnboarding=NewZPOnboarding.currentFlowType===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE;if($.each(NewZPOnboarding.tabsOrder,function(ind,tabKey){var tab=tabDetails[tabKey].tabCols;NewZPOnboarding.configdata[tabKey]=tabDetails[tabKey];var isDragable=$.inArray(tabKey,NewZPOnboarding.nondragableTabs)<0;configLeftHtml+='<li data-click="'+tabKey+'" id="'+tab.TAB_ID+'" staticTab="'+($.inArray(tabKey,NewZPOnboarding.staticTabs)>-1)+'" errordiv="cantbeempty" onclick="NewZPOnboarding.config.openTab(\''+tabKey+"')\">",2!==NewZPOnboarding.currentOB.onboarding_type&&(configLeftHtml+=isDragable&&!isOnboarding?'<i class="PI_drag" name=dragIcon></i>':'<i class="PI_drag VH"></i>');var isEditable="Welcome"!==tabKey||NewZPOnboarding.currentFlowType!==NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?'<i tabOpen="false" class="PI_edt" title="'+ZPI18N.getString("zp.edit")+'" onclick="NewZPOnboarding.showEdit(this)" name="tabEdit"></i>':"";if(configLeftHtml+='<a name="tabName" keyname="DISPLAY_NAME">'+tab.DISPLAY_NAME+"</a>"+isEditable+'<input class="ztextbox" onblur="NewZPOnboarding.showEdit(this)" maxlength="250" name="tabValue" tabOpen="false" value="'+tab.DISPLAY_NAME+'" type="text">',configLeftHtml+='<i class="PI_info" id="errorInfo" data-content="" data-placement="top" data-trigger="hover" data-toggle="popover" zptitle="" title="'+ZPI18N.getString("zp.fillnecessarydetails")+'"></i>',$.inArray(tabKey,NewZPOnboarding.staticTabs)<0){var toggleclass=tab.IS_VISIBLE?"onb_ztoggle_checked":"onb_ztoggle_unchecked";configLeftHtml+='<input class="togbuttondis-js" name="onbztogswitch" isvis="'+toggleclass+'"></input>'}configLeftHtml+="</li>",configRightHtml+='<div tab-content="'+tabKey+'">'+NewZPOnboarding.config[tabKey]()+"</div>"}),maindiv+=(configLeftHtml+="</ul></div>")+(configRightHtml+="</div>")+"</div></div>",maindiv+='<div class="zpl_mfoter d-flex"><div><button type="button" class="zlabel zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.updateOnboardingConfig()">'+ZPI18N.getString("zp.save")+"</button>",maindiv+='<button id="configCancelBtn" type="button" class="zlabel zlabel--outline zlabel--medium"  onclick=window.open(\''+flowurl+'\',"_self") >'+ZPI18N.getString("zp.cancel")+"</button>",maindiv+='</div><div class="MLauto">',maindiv+='<button type="button" class="zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.config.constructJson(true)">'+ZPI18N.getString("zp.clicktopreview")+"</button>",maindiv+="</div>",settingsPage.container.find('[data-modal-box="emponboardingMdl"]').length>0)settingsPage.container.find("#obconfig").removeClass("DN").html(maindiv);else{const newElement='<div id="obconfig">'+maindiv+"</div>";settingsPage.container.append(newElement)}$.each(settingsPage.container.find("#onbconfigtab").find('[name="onbztogswitch"]'),function(index,element){"onb_ztoggle_unchecked"==element.getAttribute("isvis")?ZPeopleComponents.toggleswitch(element):ZPeopleComponents.toggleswitch(element,{on:!0})}),settingsPage.container.find("#flowname").ztooltip(),void 0==NewZPOnboarding.config.activeTab&&(NewZPOnboarding.config.activeTab="Welcome"),settingsPage.container.find('#configTabs li[data-click="'+NewZPOnboarding.config.activeTab+'"]').trigger("click"),NewZPOnboarding.config.data.onboarding_type==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&(settingsPage.container.find("#msgEditor .zei-table").closest("li").addClass("DN"),$.each(NewZPOnboarding.config.forms,function(formInd,form){"P_Employee"==form.componentName&&(NewZPOnboarding.EmployeeForm.name=form.formName,NewZPOnboarding.EmployeeForm.id=form.formId,ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())]=[],ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())].push({formId:form.formId,compName:form.componentName,dispName:form.formName,tableName:"P_Employee"}),ZPA_Common[ZPA_Common.getFormListMode(ZPA_Common.getPageMode(),ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.WEBHOOK,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.FIELDUPDATE,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.TASK,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.CHECKLIST,ZPA_Common.getServiceName())]=ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())])}),settingsPage.container.find("[keyname=WELCOME_FEED_TEXT]").html(ZPA_Editor.initiateEditor("obFeedEditorTemplate","",ZPeople.decodeTxt(NewZPOnboarding.configdata.Welcome.tabSpecificData.WELCOME_FEED_TEXT),"feedEditor"+NewZPOnboarding.config.data.onBoardingId)));var sortDiv=settingsPage.container.find("#configTabs");ZPeopleComponents.sortable("#onbconfigtab",{items:"li[statictab=false]",handle:$(sortDiv).find("li[statictab=false] [name=dragIcon]"),region:"parent"}),settingsPage.container.find("#chooseFormDiv").hide(),settingsPage.container.find("[id=errorInfo]").hide(),settingsPage.container.find('[name="tabValue"]').hide(),settingsPage.container.find('[data-toggle="popover"]').tooltip({placement:"right",container:"body"}),settingsPage.container.find('[tabOpen="false"]').on("click",function(e){e.stopPropagation()});var formsortdiv=settingsPage.container.find("#chooseForms");ZPeopleComponents.sortable(formsortdiv.find("tbody"),{items:"tr",handle:$(formsortdiv).find("[name=formsul] [name=sortdiv]"),region:"parent"});var agreementssortdiv=settingsPage.container.find("#docsToSign");ZPeopleComponents.sortable(agreementssortdiv.find("tbody"),{items:"tr",handle:$(agreementssortdiv).find("tbody tr [name=dragIcon]"),region:"parent"});settingsPage.container.find(".obSettings").find(".dvflow_str.bgrey").append('<div id="task" class="editCL chklistMainDiv"></div><div id="checklist" class="editCL chklistMainDiv"></div><div id="fieldupdate" class="editCL chklistMainDiv"></div><div id="mailalert" class="editCL chklistMainDiv"></div><div id="customfunction" class="editCL chklistMainDiv"></div><div id="backSlider" class=""></div>'),ZPeopleComponents.select(settingsPage.container.find('[name="TEMPLATEID"]'),{showSearchField:!0,dropdownList:NewZPOnboarding.dropdownOptions,width:"200"}),ZPeopleComponents.select(settingsPage.container.find('[name="AGREEMENTS_TYPE"]'),{dropdownList:NewZPOnboarding.dropdownOptions}),ZPeopleComponents.select(settingsPage.container.find('[name="selectFormDiv"]'),{showSearchField:!0,dropdownList:NewZPOnboarding.dropdownOptions}),NewZPOnboarding.currentFlowType==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&ZPeopleComponents.select(settingsPage.container.find('[name="applicableRoles"]'),{showSearchField:!0,dropdownList:NewZPOnboarding.dropdownOptions,width:"200"}),ZPeopleComponents.select(settingsPage.container.find("select")),ZPeopleComponents.toggleswitch(settingsPage.container.find(".onb_ztoggle_unchecked")),ZPeopleComponents.toggleswitch(settingsPage.container.find(".onb_ztoggle_checked"),{on:!0}),settingsPage.container.find('[name="TEMPLATEID"]').on("zselectchange",function(event){var tempobj=event.detail.element;let selectedOpt=$(tempobj).find("option:selected");var optType=void 0!=selectedOpt&&selectedOpt&&selectedOpt.length>0?selectedOpt.attr("opttype"):"";$(tempobj).closest("tr").find("#onbmmmoreid").hide(),optType!==NewZPOnboarding.HRTEMP_OPTTYPE&&"-1"!=event.detail.selectedValue&&$(tempobj).closest("tr").find("#onbmmmoreid").show(),NewZPOnboarding.callBackAfterSelTemp(event),$.each(settingsPage.container.find('[name="TEMPLATEID"]').not(tempobj),function(index,element){event.detail.selectedValue&&"-1"!=event.detail.selectedValue&&ZPeopleComponents.select(element).setOptionAttributes(event.detail.selectedValue,"hidden",!0),event.detail.previousValue&&"-1"!=event.detail.previousValue&&ZPeopleComponents.select(element).setOptionAttributes(event.detail.previousValue,"hidden",!1)})}),settingsPage.container.find('[name="selectFormDiv"]').on("zselectchange",function(event){var tempobj=event.detail.element;$.each(settingsPage.container.find('[name="selectFormDiv"]').not(tempobj),function(index,element){event.detail.selectedValue&&"-1"!=event.detail.selectedValue&&ZPeopleComponents.select(element).setOptionAttributes(event.detail.selectedValue,"hidden",!0),event.detail.previousValue&&"-1"!=event.detail.previousValue&&ZPeopleComponents.select(element).setOptionAttributes(event.detail.previousValue,"hidden",!1)})}),$.each(settingsPage.container.find('[name="TEMPLATEID"]').find("option[opttype="+NewZPOnboarding.HRTEMP_OPTTYPE+"]:selected"),function(i,tempobj){let row=$(tempobj).closest("tr");ZPeopleComponents.select(row.find('[name="applicableRoles"]')).setAttributes({disabled:!0}),ZPeopleComponents.select(row.find('[name="AGREEMENTS_TYPE"]')).setAttributes({disabled:!0})});var agreeData=NewZPOnboarding.configdata.Agreements,policies=void 0!=agreeData.tabSpecificData.policies&&agreeData.tabSpecificData.policies.length>0?agreeData.tabSpecificData.policies:[""],selected=(data=[],[]);$.each(NewZPOnboarding.hrFiles,function(fInd,hrFile){var fileiinfo={id:hrFile.fileID,filename:NewZPOnboarding.decodeTxt(hrFile.fileName)};data.push(fileiinfo),$.inArray(hrFile.fileID,policies)>-1&&selected.push(fileiinfo)}),ZPeopleComponents.tokenfield(settingsPage.container.find("[keyname=policies]"),{data:data,dataMapping:{value:"id",text:"filename",id:"id"},values:selected}),settingsPage.container.find("#docsToSign").find(".PI_more").on("click",function(){NewZPOnboarding.onbmmmoreoptionmenu(this)}),settingsPage.container.find("#viewapplicability").off().on("click",function(){NewZPOnboarding.constructViewApplicable(NewZPOnboarding.applicabilityList)}),settingsPage.container.find("#configCloseMark").off().on("click",function(){settingsPage.container.find("#obconfig").addClass("DN"),settingsPage.container.addClass("zpl_tblfxd")}),settingsPage.container.find("#configCancelBtn").off().on("click",function(){settingsPage.container.find("#obconfig").addClass("DN"),settingsPage.container.addClass("zpl_tblfxd")}),settingsPage.container.find("#configCloseArw").off().on("click",function(){settingsPage.container.find("#obconfig").addClass("DN"),settingsPage.container.addClass("zpl_tblfxd")})}},NewZPOnboarding.callBackAfterSelTemp=function(event){if(void 0===NewZPOnboarding.hrFormsTemplate)return;var tempobj=event.detail.element;let selectedOpt=$(tempobj).find("option:selected"),signDtls=selectedOpt.data("signdtls");var optType=void 0!=selectedOpt&&selectedOpt&&selectedOpt.length>0?selectedOpt.attr("opttype"):"";let roleSelect=ZPeopleComponents.select($(tempobj).closest("tr").find('select[name="applicableRoles"]')),signSel=ZPeopleComponents.select($(tempobj).closest("tr").find('select[name="AGREEMENTS_TYPE"]'));if(optType===NewZPOnboarding.HRTEMP_OPTTYPE){if(!signDtls.data.signerFieldForAllRecp)return NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.onbesignmandatoryerror"),tempobj.closest("[errordiv]")),!1;NewZPOnboarding.currentFlowType==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&roleSelect.setAttributes({disabled:!0}),signSel.setValue(4),signSel.setAttributes({disabled:!0})}else NewZPOnboarding.currentFlowType==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&roleSelect.setAttributes({disabled:!1}),signSel.setAttributes({disabled:!1})},NewZPOnboarding.showEdit=function(obj_){const $obj=$(obj_);if("tabEdit"==$obj.attr("name"))$obj.parent().find('[name="tabValue"]').val($obj.siblings('[name="tabName"]').text()),$obj.hide(),$obj.parent().find('[name="tabValue"]').show(),$obj.parent().find('[name="tabValue"]').trigger("select");else{let tabNames=[];NewZPOnboarding.removeErrorSpan($obj.parent()),settingsPage.container.find("#onbconfigtab").find("input[onblur]").each(function(){tabNames.push(this.value.trim())});const inputVal=$obj.val().trim(),li=$obj.parent();if(!inputVal.length||new Set(tabNames).size!==tabNames.length){li.find('[name="tabValue"]').addClass("flex-dirC");const msg=inputVal.length?ZPI18N.getString("zp.obtaberror"):ZPI18N.getString("zp.fieldupdate.emptyerror");return NewZPOnboarding.tabErrorSpanAttach(msg,$obj.parent())}$obj.hide(),li.find('[name="tabValue"]').removeClass("flex-dirC"),li.find('[name="tabName"]').text(inputVal),li.find('[name="tabEdit"]').show()}},NewZPOnboarding.config.mailmergetmplist=function(event){var obj=event.detail.element,formid=event.detail.selectedValue,templates='<option value="-1">-'+ZPI18N.getString("zp.select")+"-</option>";$.each(NewZPOnboarding.mmTemplates,function(mInd,template){template.formId==formid&&(templates+='<option formid="'+template.formId+'" value="'+template.tid+'">'+template.fname+"</option>")}),ZPeopleComponents.select($(obj).closest("tr").find('[name="TEMPLATEID"]')).destroy(),$(obj).closest("tr").find('[name="TEMPLATEID"]').html(templates),ZPeopleComponents.select($(obj).closest("tr").find('[name="TEMPLATEID"]')),$(obj).closest("tr").find("#onbmmmoreid").hide()},NewZPOnboarding.config.Welcome=function(){var welcomeData=NewZPOnboarding.configdata.Welcome,videoURL=void 0!=welcomeData.tabSpecificData.VIDEO_URL?decodeURIComponent(welcomeData.tabSpecificData.VIDEO_URL):"",welcomeHtml='<div class="zpl_crd"><div class="zpl_crdcnt">';if(welcomeHtml+='<div class="zpl_secn" errordiv="cantbeempty"><div><label><b>'+ZPI18N.getString("zp.homevideourl")+'</b></label></div><div> <input type="text" placeholder="'+ZPI18N.getString("zp.videolink")+'" class="ztextbox" value="'+videoURL+'" keyname="VIDEO_URL"></div></div>',NewZPOnboarding.currentOB.onboarding_type==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE){welcomeHtml=(welcomeHtml+=NewZPOnboarding.config.tabDescTemplate).replace(/\$VALUE\$/,welcomeData.tabCols.DESCRIPTION)+"</div></div>",welcomeHtml+='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn" errordiv="cantbeempty"><div><label><b>'+ZPI18N.getString("zp.welcomefeed")+":</b></label></div>";var select0="selected",select1="",select2="";2==welcomeData.tabSpecificData.POST_FEEDS_TO?(select0="",select1="selected"):3==welcomeData.tabSpecificData.POST_FEEDS_TO&&(select0="",select2="selected"),welcomeHtml+="<div>"+ZPI18N.getString("zp.postto")+'</div><div><select keyname="POST_FEEDS_TO" ><option value="1" '+select0+">"+ZPI18N.getString("zp.department")+'</option><option value="2" '+select1+">"+ZPI18N.getString("zp.user")+'</option><option value="3" '+select2+">"+ZPI18N.getString("zp.all")+"</option></select></div>",welcomeHtml+='<div id="msgEditor"  keyname="WELCOME_FEED_TEXT" class="zpl_msgedtr"></div></div>'}return welcomeHtml+='</div></div><div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn" errordiv="cantbeempty"><div><label><b>'+ZPI18N.getString("zp.selecthr")+'</b></label></div><div><select keyname="CONTACT_HR_PERSON" displayText="'+ZPI18N.getString("zp.contactperson")+'" name="dropdown" class="selectBox" style="display: none;">',$.each(NewZPOnboarding.teamMembers,function(memberInd,member){var selected=welcomeData.tabSpecificData.CONTACT_HR_PERSON==member.usererec?"selected":"";welcomeHtml+='<option value="'+member.usererec+'" '+selected+">"+member.name+"</option>"}),welcomeHtml+="</select></div></div>",welcomeHtml+="</div></div>"},NewZPOnboarding.config.Forms=function(isAppend){var formData=NewZPOnboarding.configdata.Forms,deschtml=NewZPOnboarding.config.tabDescTemplate,formHtml='<div class="zpl_crd"><div class="zpl_crdcnt">';formHtml+=deschtml.replace(/\$VALUE\$/,formData.tabCols.DESCRIPTION),formHtml+='<div class="zpl_secn" errordiv="cantbeempty"><div><label><b>'+ZPI18N.getString("zp.chooseforms")+"</b><label></div>",formHtml+='<div class="zpl_tblres" id="chooseForms" keyname="forms"><table class="zpl_tbl wd100_per"><thead>',formHtml+='<tr><th width="40"></th><th><b>'+ZPI18N.getString("zp.form")+'</b></th><th width="120"><b>'+ZPI18N.getString("zp.lms.mandatory")+'</b></th><th width="80"></th></tr>',formHtml+="</thead>",formHtml+="<tbody>";var selectedForms=formData.tabSpecificData.forms;return void 0!=selectedForms&&0!=selectedForms.length||(formHtml+=NewZPOnboarding.addformul("")),void 0!=selectedForms&&selectedForms.length>0&&$.each(selectedForms,function(selectInd,selectform){formHtml+=NewZPOnboarding.addformul(selectform,selectedForms,selectInd+1)}),formHtml+="</tbody></table>",formHtml+='<div class="zpl_secn"><a class="zpl_rwalgn zpl_lnkbg" onclick="NewZPOnboarding.addformtab()">'+ZPI18N.getString("zp.add")+"</a></div>",formHtml+="</div></div>",formHtml+="</div></div>",formHtml+='<div id="nodata" class="zpl_crd zpl_nodata DNI"><div class="zpl_crdcnt"><div class="zpl_Emptydata"><div><div id="alrtImg" class="zpl_emptimg zp_nd_nofilesnd"></div><h4 id="desc">'+ZPI18N.getString("zp.onb.noformtitle")+"</h4><br>"+ZPI18N.getString("zp.onb.noformdesc")+'<p></p><font><button id="formBtn" class="zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.config.addForm()">'+ZPI18N.getString("zp.addform")+"</button></font></div></div></div></div>"},NewZPOnboarding.addformul=function(selectform,selectedForms,selectInd){var mandforms=NewZPOnboarding.configdata.Forms.tabSpecificData.mandForms,formHtml='<tr name="formsul">';formHtml+='<td><i name="sortdiv" class="PI_drag"></i></td>',formHtml+='<td errordiv="cantbeempty">';var optionhtml='<select name="selectFormDiv"><option value="-1">-'+ZPI18N.getString("zp.select")+"-</option>";$.each(NewZPOnboarding.config.forms,function(formInd,form){var selected=selectform==form.formId?"selected":"",ishidden=!selected&&selectedForms&&$.inArray(form.formId,selectedForms)>-1?"hidden=true":"";optionhtml+='<option value="'+form.formId+'" '+selected+" "+ishidden+">"+form.formName+"</option>"}),formHtml+=(optionhtml+="</select>")+"</td>",formHtml+="<td>";var ismand=void 0!=mandforms&&mandforms.indexOf(selectform)>=0?"checked":"",chkboxid=selectInd||settingsPage.container.find("#chooseForms").find("tbody").find("tr").length+1;return formHtml+='<div class="zcheckbox" id="ismand"><input type="checkbox" name="check" value="" class="zcheckbox__helper" id="onbformschk'+chkboxid+'" '+ismand+'><label class="zcheckbox__label" for="onbformschk'+chkboxid+'"></label></div>',formHtml+="</td>",formHtml+='<td><div class="zpl_hvr"><i class="PI_delete" onclick="NewZPOnboarding.deleteformtab(this)"></i></div></td>',formHtml+="</tr>"},NewZPOnboarding.addformtab=function(){var selectedForms=[];$.each(settingsPage.container.find('[name="selectFormDiv"]'),function(index,element){selectedForms.push(ZPeopleComponents.select(element).getValue())});var formhtml=NewZPOnboarding.addformul("",selectedForms),formsortdiv=settingsPage.container.find("#chooseForms");formsortdiv.find("tbody").append(formhtml),ZPeopleComponents.sortable(formsortdiv.find("tbody")).destroy(),ZPeopleComponents.sortable(formsortdiv.find("tbody"),{items:"tr",handle:$(formsortdiv).find("[name=formsul] [name=sortdiv]"),region:"parent"}),ZPeopleComponents.select(settingsPage.container.find('[name="selectFormDiv"]'),{showSearchField:!0,dropdownList:NewZPOnboarding.dropdownOptions}),settingsPage.container.find('[name="selectFormDiv"]').on("zselectchange",function(event){var tempobj=event.detail.element;$.each(settingsPage.container.find('[name="selectFormDiv"]').not(tempobj),function(index,element){event.detail.selectedValue&&"-1"!=event.detail.selectedValue&&ZPeopleComponents.select(element).setOptionAttributes(event.detail.selectedValue,"hidden",!0),event.detail.previousValue&&"-1"!=event.detail.previousValue&&ZPeopleComponents.select(element).setOptionAttributes(event.detail.previousValue,"hidden",!1)})})},NewZPOnboarding.deleteformtab=function(obj){if($(obj).parents("#chooseForms").find("tr[name=formsul]").length>1){var value=ZPeopleComponents.select($(obj).parents("tr").find('[name="selectFormDiv"]')).getValue();value&&"-1"!=value&&$.each(settingsPage.container.find('[name="selectFormDiv"]'),function(index,element){ZPeopleComponents.select(element).setOptionAttributes(value,"hidden",!1)}),$(obj).parents("tr[name=formsul]").remove()}},NewZPOnboarding.config.editorBaseContent=function(editorId){return'<div class="row"> <div class="msgpreview-outer"><div class="zpl_secn zpl_twoclum"><div class="col-md-3"><label class="control-label ZPbold">'+ZPI18N.getString("zp.availablemergefields")+'</label><div id="allRlatedFormsList"><select><option value="other_fields">'+ZPI18N.getString("zp.systemfields")+"</option></select></div></div>"+'<div class="form-group col-md-3"><label class="control-label ZPbold">'+ZPI18N.getString("zp.selectfield")+'</label><div id="allFieldListCombo"><div select2id="other_fields"><select><option value="FEED USER MENTION">'+ZPI18N.getString("zp.feedusermention")+"</option></select></div></div></div>"+'<div class="form-group col-md-4"><label class="control-label ZPbold">'+ZPI18N.getString("zp.fieldvalue")+'</label><input value="${FEED USER MENTION}" id="fieldLabelBox" readonly="" class="form-control" type="text"></div>'+'<div class="form-group col-md-2"><label class="control-label ZPbold W100">&nbsp; </label><a onclick="NewZPOnboarding.addreplacefields(settingsPage.container.find(\'#fieldLabelBox\').val())" class="btn btn-primary btn-small">'+ZPI18N.getString("zp.insert")+'</a></div> </div><div id="recordTemps"></div>'+'<div class="msgpreview clearfix"><div class="fieldn" id="'+editorId+'" style="width:100%;float: left;"> </div></div>   </div></div>'},NewZPOnboarding.config.AgreementsHRTemp=function(){let agreeData=NewZPOnboarding.configdata.Agreements,optionshtml='<option value="4" >'+ZPI18N.getString("zp.zohosign")+"</option>",agrFileList=void 0!=agreeData.tabSpecificData.agrmFiles&&agreeData.tabSpecificData.agrmFiles.length>0?agreeData.tabSpecificData.agrmFiles:[{dispName:""}];var agrHtml="";agrHtml+='<div class="zpl_crd" name="agrFiles"> <div class="zpl_crdcnt"><div class="zpl_secn"><div><label><b>'+ZPI18N.getString("zp.hrdocuments")+'<i class="PI_info" data-title-position="right" title="'+ZPI18N.getString("zp.hrdocuments")+'" ></i></b></label></div>',agrHtml+='<div class="zpl_tblres"><table class="zpl_tbl wd100_per" id="aggrFiles">',agrHtml+='<thead><tr><th width="40"></th><th width="200">'+ZPI18N.getString("zp.mailmerge")+"</th><th>"+ZPI18N.getString("zp.zs.documentname")+"</th><th>"+ZPI18N.getString("zp.signtype")+'</th><th width="100"><div class="text-center"></div></th></tr></thead>',agrHtml+="<tbody>",agrHtml+='<tr><td><i class="PI_drag" name="dragIcon"></i></td>',agrHtml+='<td errorDiv="cantbeempty"><select name="TEMPLATEID" ><option value="-1">-'+ZPI18N.getString("zp.select")+"-</option>";var templatesgroup='<optgroup label="HR Form Templates">';return void 0!==NewZPOnboarding.hrFormsTemplate&&($.each(agrFileList,function(_ind,agrFileObj){$.each(NewZPOnboarding.hrFormsTemplate,function(_mInd,template){let selected="";agrFileObj.agrFileId==template.fileID&&(selected="selected"),templatesgroup+='<option formid="'+template.fileID+'" value="'+template.fileID+'" '+selected+" "+!1+">"+template.fileName+"</option>"}),templatesgroup+="</optgroup>",NewZPOnboarding.hrFormsTemplate.length>0&&(agrHtml+=templatesgroup),agrHtml+='<td errorDiv="cantbeempty"><input type="text" class="ztextbox wd100_per" placeholder="'+ZPI18N.getString("zp.zs.documentname")+'" value="'+agrFileObj.dispName+'" name="DISPLAY_NAME"></td>',agrHtml+="</select></td>",agrHtml+='<td class="checked"><select name="AGREEMENTS_TYPE" change=NewZPOnboarding.alertforzohosign(this)>',agrHtml+=optionshtml+"</select></td>"}),agrHtml+="</tbody></table>",agrHtml+="</div></div></div></div>"),agrHtml};const removeNullAndEmptyStrings=array=>array.filter(item=>null!=item&&""!==item);NewZPOnboarding.config.Agreements=function(isAppend){var agreeData=NewZPOnboarding.configdata.Agreements,agrHtml='<div class="zpl_crd"><div class="zpl_crdcnt">';agrHtml+=NewZPOnboarding.config.tabDescTemplate+"</div></div>";var applicableroles="";let docsToReadContent=ZPI18N.getString("zp.onb.cand.docstoreadinfo"),docsToAcceptContent=ZPI18N.getString("zp.onb.cand.docstoacceptinfo");NewZPOnboarding.currentOB.onboarding_type==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&(applicableroles='<th width="200">'+ZPI18N.getString("zp.applicableroles")+"</th>",docsToReadContent=ZPI18N.getString("zp.onb.emp.docstoreadinfo"),docsToAcceptContent=ZPI18N.getString("zp.onb.emp.docstoacceptinfo")),agrHtml=agrHtml.replace(/\$VALUE\$/,agreeData.tabCols.DESCRIPTION),agrHtml+='<div class="zpl_crd" name="agreements"><div class="zpl_crdcnt"><div class="zpl_secn"><div><label><b>'+ZPI18N.getString("zp.docstoaccept")+'<i class="PI_info" data-title-position="right" title="'+docsToAcceptContent+'"></i></b></label></div>',agrHtml+='<div class="zpl_tblres"><table class="zpl_tbl wd100_per" id="docsToSign">',agrHtml+='<thead><tr><th width="40"></th><th width="200">'+ZPI18N.getString("zp.mailmerge")+"</th><th>"+ZPI18N.getString("zp.zs.documentname")+"</th>"+applicableroles+"<th>"+ZPI18N.getString("zp.signtype")+'</th><th width="100"><div class="text-center"></div></th></tr></thead>',agrHtml+="<tbody>";var docsToSign=void 0!=agreeData.tabSpecificData.docsToSign&&agreeData.tabSpecificData.docsToSign.length>0?removeNullAndEmptyStrings(agreeData.tabSpecificData.docsToSign):[{DISPLAY_NAME:"",TEMPLATEID:""}],templateidselected=[];let selectedHrTemplates=[],hrTemplateIds=[];Array.isArray(NewZPOnboarding.hrFormsTemplate)&&$.each(NewZPOnboarding.hrFormsTemplate,function(mInd,template){hrTemplateIds.push(template.fileID)}),$.each(docsToSign,function(docInd,doc){$.inArray(doc.TEMPLATEID,hrTemplateIds)>-1?selectedHrTemplates.push(doc.TEMPLATEID):templateidselected.push(doc.TEMPLATEID)}),$.each(docsToSign,function(docInd,doc){agrHtml+='<tr><td><i class="PI_drag" name="dragIcon"></i></td>',agrHtml+='<td errorDiv="cantbeempty"><select name="TEMPLATEID" ><option value="-1">-'+ZPI18N.getString("zp.select")+"-</option>";var forms=NewZPOnboarding.config.formsformm;if(NewZPOnboarding.currentOB.onboarding_type==NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE){var templatesgroup='<optgroup label="'+NewZPOnboarding.CandidateForm.name+'">',istemplatepresnt=!1;$.each(NewZPOnboarding.mmTemplates,function(mInd,template){if(template.formId==NewZPOnboarding.CandidateForm.id){istemplatepresnt=!0;var selected=doc.TEMPLATEID==template.tid?"selected":"",ishidden=$.inArray(template.tid,templateidselected)>-1&&!selected?"hidden=true":"";templatesgroup+='<option formid="'+template.formId+'" value="'+template.tid+'" '+selected+" "+ishidden+' title="'+ZPA_Common.encodeHtml(template.fname)+'">'+ZPA_Common.encodeHtml(template.fname)+"</option>"}}),templatesgroup+="</optgroup>",istemplatepresnt&&(agrHtml+=templatesgroup),forms=NewZPOnboarding.config.forms}if($.each(forms,function(index,obj){obj.formId;var templatesgroup='<optgroup label="'+obj.formName+'">',istemplatepresnt=!1;$.each(NewZPOnboarding.mmTemplates,function(mInd,template){if(template.formId==obj.formId){istemplatepresnt=!0;var selected=doc.TEMPLATEID==template.tid?"selected":"",ishidden=$.inArray(template.tid,templateidselected)>-1&&!selected?"hidden=true":"";templatesgroup+='<option formid="'+template.formId+'" value="'+template.tid+'" '+selected+" "+ishidden+' title="'+ZPA_Common.encodeHtml(template.fname)+'">'+ZPA_Common.encodeHtml(template.fname)+"</option>"}}),templatesgroup+="</optgroup>",istemplatepresnt&&(agrHtml+=templatesgroup)}),NewZPOnboarding.config.data.esignConfigurations.ZohoSign&&Array.isArray(NewZPOnboarding.hrFormsTemplate)){templatesgroup='<optgroup label="'+ZPI18N.getString("zp.hrdocuments")+'">',istemplatepresnt=!1;$.each(NewZPOnboarding.hrFormsTemplate,function(mInd,template){let signDtlsString=JSON.stringify(template.signDetails),selected=doc.TEMPLATEID==template.fileID?"selected":"",ishidden=$.inArray(template.fileID,selectedHrTemplates)>-1&&!selected?"hidden=true":"";templatesgroup+='<option optType="'+NewZPOnboarding.HRTEMP_OPTTYPE+"\" data-signdtls='"+signDtlsString+"' formid=\""+template.fileID+'" value="'+template.fileID+'" '+selected+" "+ishidden+' title="'+template.fileName+'">'+template.fileName+"</option>"}),templatesgroup+="</optgroup>",NewZPOnboarding.hrFormsTemplate.length>0&&(agrHtml+=templatesgroup)}agrHtml+='<td errorDiv="cantbeempty"><input type="text" class="ztextbox wd100_per" placeholder="'+ZPI18N.getString("zp.zs.documentname")+'" value="'+ZSEC.Encoder.encodeForHTML(doc.DISPLAY_NAME)+'" name="DISPLAY_NAME"></td>',agrHtml+="</select></td>",NewZPOnboarding.currentOB.onboarding_type==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&(agrHtml+='<td class="checked" errorDiv="cantbeempty"><select placeholder="'+ZPI18N.getString("zp.all")+'" name="applicableRoles" multiple="true">',$.each(NewZPOnboarding.roles,function(rInd,role){var applicableRoles=void 0!=doc.applicableRoles?doc.applicableRoles:[],selected=$.inArray(role.roleId,applicableRoles)>-1?"selected":"";agrHtml+='<option value="'+role.roleId+'" '+selected+' title="'+ZPA_Common.encodeHtml(role.roleName)+'">'+ZPA_Common.encodeHtml(role.roleName)+"</option>"}),agrHtml+="</select></td>");var type1="",type2="",type3="",type4="";switch(doc.AGREEMENTS_TYPE){case 4:type4="selected";break;case 2:type2="selected";break;case 3:type3="selected";break;default:type1="selected"}var onchange="",optionshtml="";NewZPOnboarding.config.data.esignConfigurations.AdobeSign&&(optionshtml+='<option value="2" '+type2+">"+ZPI18N.getString("zp.adobeesign")+"</option>"),NewZPOnboarding.config.data.esignConfigurations.DocuSign&&(optionshtml+='<option value="3" '+type3+">"+ZPI18N.getString("zp.docusign")+"</option>"),NewZPOnboarding.config.data.esignConfigurations.ZohoSign&&(optionshtml+='<option value="4" '+type4+">"+ZPI18N.getString("zp.zohosign")+"</option>",onchange="NewZPOnboarding.alertforzohosign(this)"),agrHtml+='<td class="checked"><select name="AGREEMENTS_TYPE" change='+onchange+'><option value="1" '+type1+">"+ZPI18N.getString("zp.extenddecline")+"</option>",agrHtml+=optionshtml,agrHtml+="</select></td>",agrHtml+='<td><div class="text-center"><div class="zpl_hvr"><i class="PI_delete" onclick="NewZPOnboarding.addRemove(this)"></i>';var Dn="display: none;";doc.TEMPLATEID&&(Dn=""),agrHtml+='<i class="PI_more" id="onbmmmoreid" style="'+Dn+'"></i>',agrHtml+="</div></div></td></tr>"}),agrHtml+="</tbody></table>",agrHtml+='<div class="zpl_secn"><a class="zpl_rwalgn zpl_lnkbg" onclick="NewZPOnboarding.addRemove(this,true)">'+ZPI18N.getString("zp.add")+"</a></div></div></div></div></div>",agrHtml+='<div class="zpl_crd" name="agreements"><div class="zpl_crdcnt"><div class="zpl_secn" errordiv="cantbeempty"><div><label><b>'+ZPI18N.getString("zp.docstoread")+'<i class="PI_info" data-title-position="right" title="'+docsToReadContent+'"></i></b></label></div>';void 0!=agreeData.tabSpecificData.policies&&agreeData.tabSpecificData.policies.length>0&&agreeData.tabSpecificData.policies;return agrHtml+='<div><z-tokenfield keyname="policies">',agrHtml+="</z-tokenfield></div></div></div></div>",agrHtml+='<div id="nodata" class="zpl_crd zpl_nodata DNI"><div class="zpl_crdcnt"><div class="zpl_Emptydata"><div><div id="alrtImg" class="zpl_emptimg zp_nd_nofilesnd"></div><h4 id="desc">'+ZPI18N.getString("zp.norec")+'</h4><p></p><font><button id="agreeBtn" class="zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.config.enableDocuments()">'+ZPI18N.getString("zp.enableconfiguration")+"</button></font></div></div></div></div>"},NewZPOnboarding.addRemove=function(obj,isAdd){if(isAdd){var tr=settingsPage.container.find("#docsToSign").find("tbody tr").first().clone(),value=ZPeopleComponents.select(settingsPage.container.find("#docsToSign").find("tbody tr").first().find('[name="TEMPLATEID"]')).getValue();$(tr).find("select").siblings().remove(),tr.find("input").siblings().remove(),tr.find("input").removeClass("ztextbox__error"),$(tr).find('[name="DISPLAY_NAME"]').val(""),$(tr).find("#onbmmmoreid").hide(),settingsPage.container.find("#docsToSign").find("tbody").append(tr),ZPeopleComponents.select(settingsPage.container.find('[name="TEMPLATEID"]'),{showSearchField:!0,dropdownList:NewZPOnboarding.dropdownOptions,width:"200"}),ZPeopleComponents.select(settingsPage.container.find('[name="AGREEMENTS_TYPE"]'),{dropdownList:NewZPOnboarding.dropdownOptions}),NewZPOnboarding.currentFlowType==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&(ZPeopleComponents.select(settingsPage.container.find('[name="applicableRoles"]'),{showSearchField:!0,dropdownList:NewZPOnboarding.dropdownOptions,width:"200"}),ZPeopleComponents.select($(tr).find('[name="applicableRoles"]')).setAttributes({disabled:!1})),ZPeopleComponents.select($(tr).find('[name="TEMPLATEID"]')).setValue("-1"),value&&"-1"!=value&&ZPeopleComponents.select($(tr).find('[name="TEMPLATEID"]')).setOptionAttributes(value,"hidden",!0);let hrTempIds=[];$.each(settingsPage.container.find('[name="TEMPLATEID"]').find("option[opttype="+NewZPOnboarding.HRTEMP_OPTTYPE+"]:selected"),function(i,tempobj){hrTempIds.push(tempobj.value)}),hrTempIds.length>0&&ZPeopleComponents.select($(tr).find('[name="TEMPLATEID"]')).setOptionAttributes(hrTempIds,"hidden",!0);var agreementssortdiv=settingsPage.container.find("#docsToSign");ZPeopleComponents.sortable(agreementssortdiv.find("tbody")).destroy(),ZPeopleComponents.sortable(agreementssortdiv.find("tbody"),{items:"tr",handle:$(agreementssortdiv).find("tbody tr [name=dragIcon]"),region:"parent"}),settingsPage.container.find('[name="TEMPLATEID"]').on("zselectchange",function(event){var tempobj=event.detail.element;let selectedOpt=$(tempobj).find("option:selected");void 0!=selectedOpt&&selectedOpt&&selectedOpt.length>0&&selectedOpt.attr("opttype");$(tempobj).closest("tr").find("#onbmmmoreid").hide(),"-1"!=event.detail.selectedValue&&$(tempobj).closest("tr").find("#onbmmmoreid").show(),NewZPOnboarding.callBackAfterSelTemp(event),$.each(settingsPage.container.find('[name="TEMPLATEID"]').not(tempobj),function(index,element){event.detail.selectedValue&&"-1"!=event.detail.selectedValue&&ZPeopleComponents.select(element).setOptionAttributes(event.detail.selectedValue,"hidden",!0),event.detail.previousValue&&"-1"!=event.detail.previousValue&&ZPeopleComponents.select(element).setOptionAttributes(event.detail.previousValue,"hidden",!1)})}),settingsPage.container.find("#docsToSign").find(".PI_more").on("click",function(){NewZPOnboarding.onbmmmoreoptionmenu(this)})}else{if($(obj).parents("tr").siblings().length>0)(value=ZPeopleComponents.select($(obj).parents("tr").find('[name="TEMPLATEID"]')).getValue())&&"-1"!=value&&$.each(settingsPage.container.find('[name="TEMPLATEID"]'),function(index,element){ZPeopleComponents.select(element).setOptionAttributes(value,"hidden",!0)}),$(obj).parents("tr").remove();else $(obj).parents("tr").find("input").val(""),ZPeopleComponents.select($(obj).parents("tr").find('[name="TEMPLATEID"]')).deselectAllOptions(),NewZPOnboarding.currentFlowType==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&ZPeopleComponents.select($(obj).parents("tr").find('[name="applicableRoles"]')).deselectAllOptions()}};const openIframeInNewWindow=(URL,fileName,windowName="iframeWindow",windowFeatures="width=1000,height=800,resizable,scrollbars")=>{var pageId=settingsPage.container;if(0===pageId.find("#mmpreview").length){var html=`<div id='mmpreview' data-modal-box="tempGallery" class="zpl_mdl zpl_mfull zpl_mopen">\n                                <div class="zpl_minr">\n                                    <div class="zpl_mhder">\n                                        <div>\n                                            <a class="clsArw" onclick="ZP_Mailmerge.closeSlider()"><i class="PI_back"></i></a>\n                                            <h4>${ZSEC.Encoder.encodeForHTML(fileName)}</h4>\n                                        </div>\n                                         <span class="zpl_mhderrgt">\n                                            <a class="" id="preview_edit" title="Edit"></a>\n                                        </span>\n                                </div>\n                                \n                                <div class="zpl_mcnt zpl_fm">\n                                    <div class="zpl_mmnu">\n                                        <div style="height: 650px; width: 100%;">\n                                            <iframe src="${URL}" id="mmPreviewFrame" name="mmPreviewFrame" scrolling="auto" style="border: none; margin: 0pt; height: 100%;" frameborder="0" width="100%"></iframe>\n                                        </div>\n                                    </div>\n                                </div>\n                                <iframe id="download_iframe" style="display: none;"></iframe>\n                                    <div class="zpl_mfoter">\n                                </div>\n                            </div>\n                        </div>`;pageId.append(html)}else settingsPage.container.find("#mmpreview").addClass("zpl_mopen")};NewZPOnboarding.onbmmmoreoptionmenu=function(obj){$("#onbmmmoreoptionmenu").remove();var templateid=ZPeopleComponents.select($(obj).closest("tr").find("[name=TEMPLATEID]")).getValue(),templateidjson=void 0;$.each(NewZPOnboarding.mmTemplates,function(mInd,template){template.tid==templateid&&(templateidjson=template)});let signDtls,selectedOpt=$(obj).closest("tr").find("[name=TEMPLATEID]").find("option:selected"),optType=selectedOpt.attr("opttype"),zsingTempUrl="";optType===NewZPOnboarding.HRTEMP_OPTTYPE&&(zsingTempUrl=(signDtls=selectedOpt.data("signdtls")).tempURL);let viewUrl=optType!==NewZPOnboarding.HRTEMP_OPTTYPE?"ZP_Mailmerge.TemplatePreview(this,'"+templateidjson.rid+"', '"+ZPeople.escapeHtml(templateidjson.fname)+"', '"+templateidjson.tid+"', '"+templateidjson.url+"', '"+templateidjson.formId+"')":"openIframeInNewWindow('"+zsingTempUrl+"', '"+signDtls.data.template_name+"')",editUrl=optType!==NewZPOnboarding.HRTEMP_OPTTYPE?"window.open('"+templateidjson.url+"','blank')":"openIframeInNewWindow('"+zsingTempUrl+"', '"+signDtls.data.template_name+"')";var agrHtml='<div id="onbmmmoreoptionmenu" class="onbmmmore"><ul>';agrHtml+='<li onclick="'+viewUrl+'" id="onbmmview">'+ZPI18N.getString("zp.view")+"</li>",agrHtml+='<li onclick="'+editUrl+'">'+ZPI18N.getString("zp.edit")+"</li>",agrHtml+="</ul></div>",$(obj).parent().append(agrHtml),ZPeopleComponents.menu(".onbmmmore",{forElement:obj}),ZPeopleComponents.menu("#onbmmmoreoptionmenu").show()},NewZPOnboarding.config.Organization=function(isAppend){var orgData=NewZPOnboarding.configdata.Organization.tabCols,orgSpecData=NewZPOnboarding.configdata.Organization.tabSpecificData,orgHtml='<div class="zpl_crd"><div class="zpl_crdcnt">'+NewZPOnboarding.config.tabDescTemplate;orgHtml=orgHtml.replace(/\$VALUE\$/,orgData.DESCRIPTION);var webUrl=void 0!=orgSpecData.WEB_URL?orgSpecData.WEB_URL:"";return orgHtml+='<div class="zpl_secn" errordiv="cantbeempty"><div><label><b>'+ZPI18N.getString("zp.companyurl")+'<i class="PI_info" data-title-position="right" title="'+ZPI18N.getString("zp.onb.companyurlinfo")+'"></i></b></label></div><div><input keyname="WEB_URL" displayText="'+ZPI18N.getString("zp.weburl")+'" type="text" placeholder="'+ZPI18N.getString("zp.weburl")+'" class="ztextbox" value="'+webUrl+'"></div></div></div></div>'},NewZPOnboarding.config.subTab=function(activeSubTab){settingsPage.container.find("[tab-content]:visible [subtab-content]").hide(),settingsPage.container.find("[tab-content]:visible [subtab-content="+activeSubTab+"]").show(),settingsPage.container.find("[tab-content]:visible [sub-tabs]").removeClass("sel"),settingsPage.container.find("[tab-content]:visible [sub-tabs="+activeSubTab+"]").addClass("sel")},NewZPOnboarding.config.Team=function(isAppend){var teamData=NewZPOnboarding.configdata.Team.tabCols,teamHtml='<div class="zpl_crd"><div class="zpl_crdcnt">'+NewZPOnboarding.config.tabDescTemplate+"</div></div>";return teamHtml=teamHtml.replace(/\$VALUE\$/,teamData.DESCRIPTION)},NewZPOnboarding.config.Profile=function(isAppend){var teamData=NewZPOnboarding.configdata.Profile.tabCols,teamHtml='<div class="zpl_crd"><div class="zpl_crdcnt">'+NewZPOnboarding.config.tabDescTemplate+"</div></div>";return teamHtml=teamHtml.replace(/\$VALUE\$/,teamData.DESCRIPTION)},NewZPOnboarding.config.Objectives=function(isAppend){var objData=NewZPOnboarding.configdata.Objectives.tabCols,objHtml='<div class="zpl_crd"><div class="zpl_crdcnt">'+NewZPOnboarding.config.tabDescTemplate+"</div></div>";return objHtml=objHtml.replace(/\$VALUE\$/,objData.DESCRIPTION),NewZPOnboarding.isPAAdmin?objHtml+='<div class="zpl_crd" id="kraParentNew"><div class="zpl_crdcnt"><div class="zpl_secn" id="kraEmpty" errordiv="cantbeempty"></div></div></div>':objHtml+='<div class="zpl_crd" id="kraParentNew"><div class="zpl_crdcnt"><div class="zpl_crd zpl_nodata"> <div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div> <div class="zpl_emptimg zp_nd_template"></div> <h4>'+ZPI18N.getString("zp.permissiondeniedtoaccessthispage")+"</h4> <p></p> </div> </div> </div> </div></div></div>",objHtml};var Checklist={setFunction:function(){var listBody=settingsPage.container.find("[tab-content='Checklist']").find("#checklistbody").find("[name='chkRow']");listBody.off("click"),listBody.on("click",function(){ZPA_Checklist.edit($(this).attr("id"),$(this).attr("formId"))})}};NewZPOnboarding.config.Checklist=function(data){var DN="",checklisthtml="",nodataDn="",formid=NewZPOnboarding.EmployeeForm.id;if(NewZPOnboarding.currentOB.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(formid=NewZPOnboarding.CandidateForm.id),void 0!=NewZPOnboarding.configdata.Checklist.tabSpecificData.checklist&&0!=Object.keys(NewZPOnboarding.configdata.Checklist.tabSpecificData.checklist).length){nodataDn=" DNI";var checklist=NewZPOnboarding.configdata.Checklist.tabSpecificData.checklist;$.each(checklist,function(ind,jsonData){checklisthtml+='<tr id="'+jsonData.tempId+'" name="chkRow" formId="'+formid+'"><td name="chkName">'+$("<div>").text(jsonData.tempName).html()+'</td><td name="clcount">'+jsonData.count+'</td><td><div class="zpl_hvr"><i class="PI_edt" ></i><i class="PI_delete" onclick="NewZPOnboarding.deleteChecklist(\''+jsonData.tempId+"')\"></i></div></td></tr>"})}else DN=" DNI";var html='<div id="checklistDiv" class="obChecklist">';return html+='<div id="topSettMenu" class="zpl_btnmnu'+DN+'"><div class="zpl_rgt"><button class="zlabel zlabel--blue zlabel--medium" onclick="ZPA_Checklist.add();">'+ZPI18N.getString("zp.onb.checklist.add")+'</button><button class="zlabel zlabel--blue zlabel--medium" id="obTagDiv" onclick="NewZPOnboarding.config.tagChecklist();">'+ZPI18N.getString("zp.onb.checklist.add.exist")+"</button></div></div>",html+='<div class="zpl_crd zpl_nodata'+nodataDn+'"><div class="zpl_crdcnt"><div class="zpl_Emptydata"><div><div class="zpl_emptimg zp_nd_template"></div><h4>'+ZPI18N.getString("zp.onb.checklist.norec")+'</h4><p></p><font><button class="zlabel zlabel--blue zlabel--medium" onclick="ZPA_Checklist.add();">'+ZPI18N.getString("zp.onb.checklist.add")+'</button><button class="zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.config.tagChecklist();">'+ZPI18N.getString("zp.onb.checklist.add.exist")+"</button></font></div></div></div></div>",html+="</div>",html+='<div class="zpl_rgtcnt'+DN+'" id="checklistReport"><div class="zpl_tblres"><table class="zpl_tbl"><thead><tr><th width="">'+ZPI18N.getString("zp.checklist.name")+"</th><th>"+ZPI18N.getString("zp.associatedtasks")+'</th><th width="100"></th></tr></thead><tbody id="checklistbody">',html+=checklisthtml,html+="</tbody></table></div></div>"},NewZPOnboarding.addChecklist=function(){$("#obtagchecklist #sliderCancel").trigger("click"),ZPA_Checklist.add()},NewZPOnboarding.addChecklisttoList=function(){var checklistid=$("#checklist_slider").data("checklistId");if(void 0!=checklistid){var formid=NewZPOnboarding.EmployeeForm.id;NewZPOnboarding.currentOB.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(formid=NewZPOnboarding.CandidateForm.id);var checklistname=$("#checklist_slider").find("#checklist_name").val(),taskcount=$("#checklist_slider").find("#chk_taskmap").find("#sortable1").find("[taskid]").length;if(0===settingsPage.container.find("#"+checklistid).length){var html='<tr name="chkRow" id="'+checklistid+'"><td name="chkName">'+$("<div/>").text(checklistname).html()+'</td><td name="clcount" >'+taskcount+'</td><td><div class="zpl_hvr"><i class="PI_edt" onclick="ZPA_Checklist.edit(\''+checklistid+"','"+formid+'\')"></i><i class="PI_delete"  onclick="NewZPOnboarding.deleteChecklist(\''+checklistid+"')\"></i></div></td></tr>";settingsPage.container.find("#checklistReport").find("#checklistbody").append(html),settingsPage.container.find("#checklistReport").removeClass("DNI"),settingsPage.container.find("#checklistDiv").find("#topSettMenu").removeClass("DNI"),settingsPage.container.find("#checklistDiv").find(".zpl_nodata").addClass("DNI"),Checklist.setFunction()}else settingsPage.container.find("#checklistReport").find("#checklistbody").find("#"+checklistid).find("[name=chkName]").html(ZSEC.Encoder.encodeForHTML(checklistname)),settingsPage.container.find("#checklistReport").find("#checklistbody").find("#"+checklistid).find("[name=clcount]").text(taskcount)}$("#checklist_slider").remove()},NewZPOnboarding.deleteChecklist=function(checklistid){settingsPage.container.find("#checklistReport").find("#checklistbody").find("#"+checklistid).remove(),0==settingsPage.container.find("#checklistReport").find("#checklistbody").find("tr").length&&(settingsPage.container.find("#checklistReport").addClass("DNI"),settingsPage.container.find("#checklistDiv").find("#topSettMenu").addClass("DNI"),settingsPage.container.find("#checklistDiv").find(".zpl_nodata").removeClass("DNI"))},NewZPOnboarding.config.LMS_Course=function(){var lmsHtml="";if(NewZPOnboarding.config.data.tabDetails.LMS_Course.tabSpecificData.msg)lmsHtml=NewZPOnboarding.config.data.tabDetails.LMS_Course.tabSpecificData.msg;else{lmsHtml=(lmsHtml='<div class="zpl_crd"><div class="zpl_crdcnt">'+NewZPOnboarding.config.tabDescTemplate+"</div></div>").replace(/\$VALUE\$/,NewZPOnboarding.config.data.tabDetails.LMS_Course.tabCols.DESCRIPTION),lmsHtml+='<div class="zpl_btnmnu"><div class="zpl_rgt"><button class="zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.searchPopupLMS()">'+ZPI18N.getString("zp.tagcourse")+"</button></div></div>";var selectedcourseshtml="",isCoursesAvailable="",selectedcourses=NewZPOnboarding.config.data.tabDetails.LMS_Course.tabSpecificData.courses;0!=selectedcourses.length&&(isCoursesAvailable=" zpl_DNI"),selectedcourseshtml+='<div class="zpl_crd '+isCoursesAvailable+'" id="noCoursePage"><div class="zpl_crdcnt"><div class="zpl_crd zpl_nodata"> <div class="zpl_crdcnt"> <div class="zpl_Emptydata"> <div> <div class="zpl_emptimg zp_nd_template"></div> <h4>'+ZPI18N.getString("zp.lms.course.coursenocourse")+"</h4> <p></p> </div> </div> </div> </div></div></div>",selectedcourseshtml+='<div class="zpl_lmscrs fulwdt " id="onblmscourses">',$.each(selectedcourses,function(index1,selectedcourse){var lmsinfo=selectedcourse.courseBasicDetails[0];if(lmsinfo){var non_md="",ismandatory=!1;lmsinfo.courseId;selectedcourse.isMandatory&&(non_md="checked",ismandatory=!0),void 0==lmsinfo.courseImage?Math.floor(Math.random()*Math.floor(44))+1:lmsinfo.courseImage;var bgclass="zp_Crh";lmsinfo.isSystem||(bgclass="zp_Crh CBg"+lmsinfo.bannerBGData.clrId);var courseImageUrl=lmsinfo.isSystem?NewZPOnboarding.generateSourceURL(lmsinfo.courseImageInfo):NewZPOnboarding.generateRandomCourseImage(lmsinfo.courseImageInfo);selectedcourseshtml+='<div id="'+lmsinfo.courseId+'" class="zp_Cr crdlv" data=\''+JSON.stringify(lmsinfo)+"'><div class=\"zpl_crsimg "+bgclass+'" ><img src="'+courseImageUrl+'" alt=""></div>',selectedcourseshtml+="<div><h4>"+lmsinfo.courseName+"</h4><ul><li><p>Self Paced Learning</p></li></ul></div>",selectedcourseshtml+='<div class="zpl_mndcrs"><div class="zcheckbox"><input type="checkbox" name="check" value="" class="zcheckbox__helper" '+non_md+' id="lmsond'+lmsinfo.courseId+'" ismandatory='+ismandatory+' onclick="NewZPOnboarding.changeLMSstatus(this)"><label class="zcheckbox__label" for="lmsond'+lmsinfo.courseId+'"></label></div><p>'+ZPI18N.getString("zp.mandatorycourse")+"</p></div>",selectedcourseshtml+='<font class="zpl_lmicn"><i class="PI_cls" onclick="NewZPOnboarding.removeLMSCourse(this)"></i></font>',selectedcourseshtml+="</div>"}}),lmsHtml+=selectedcourseshtml+="</div>"}return lmsHtml},NewZPOnboarding.generateSourceURL=function(fileInfo,isThumbnail){fileInfo.extension=fileInfo.extension||function(fileName){let startIndex=fileName.lastIndexOf(".");return startIndex>-1?fileName.slice(startIndex):""}(fileInfo.name),fileInfo.fileType=fileInfo.fileType||function(type,extension){extension.indexOf(".")&&(extension="."+extension);extension=","+extension+",";var fileType="unknown";type.indexOf("image")>-1?fileType="image":""==type&&",.,"==extension||(fileType="others");return fileType}(fileInfo.type,fileInfo.extension),fileInfo.additionalInfo=fileInfo.additionalInfo||{fileId:fileInfo.contentId,type:0};var previewType=isThumbnail?"thumbnail":fileInfo.fileType,additionalInfo=fileInfo.additionalInfo;if("image"==previewType)return function(contentId,previewType,additionalInfo){var url=previewEngineUrl+"/";"image"==previewType&&(url+=previewType+"/"+previewServiceId+"/"+contentId);let params={moduleName:"LMS",fileId:additionalInfo.fileId,type:additionalInfo.type,portalId:_LOGGEDIN_ACCZSOID};return url+"?cli-msg="+encodeURIComponent(btoa(JSON.stringify(params)))+"&frameorigin="+window.location.origin}(fileInfo.contentId,previewType,additionalInfo)},NewZPOnboarding.generateRandomCourseImage=function(imageInfo){if(imageInfo.courseImageUrl&&""!=imageInfo.courseImageUrl)return imageInfo.courseImageUrl;{let random=Math.floor(Math.random()*Math.floor(44));return random+=1,ZPeople.getResourceURL(hrImageUrl+"lmsbg/cat"+random+".svg")}},NewZPOnboarding.removeLMSCourse=function(obj){$(obj).parent().parent().remove(),0==settingsPage.container.find("#onblmscourses").children().length&&settingsPage.container.find("#noCoursePage").removeClass("zpl_DNI")},NewZPOnboarding.changeLMSstatus=function(obj){"false"==$(obj).attr("ismandatory")?($(obj).attr("ismandatory",!0),$(obj).attr("checked","")):($(obj).attr("ismandatory",!1),$(obj).removeAttr("checked"))},NewZPOnboarding.config.openTab=function(activeTab){settingsPage.container.find("[tab-content]").removeClass("zpl_act"),settingsPage.container.find("[tab-content="+activeTab+"]").addClass("zpl_act"),settingsPage.container.find("[data-click]").removeClass("zpl_act"),settingsPage.container.find("[data-click="+activeTab+"]").addClass("zpl_act");var configData=NewZPOnboarding.configdata[activeTab];switch(activeTab){case"Objectives":NewZPOnboarding.isPAAdmin&&(""==settingsPage.container.find("#kraEmpty").html()?ZPeople.Request.send("/performance/view/kraSettings",{},NewZPOnboarding.config.loadkras):(ZPeopleComponents.select(settingsPage.container.find("#desdepselect")).destroy(),PMSOperation.getformDetails("kraUserform"),PMSOperation.getKraList()));break;case"Checklist":settingsPage.container.find("#checklistReport").find(".obRepBox").show(),ZPA_Checklist.IS_LOADED=!0,0==settingsPage.container.find("#checklistDiv").find(".DIB.ZPNdata").length&&settingsPage.container.find("#checklistDiv").find(".DIB").html('<div class="ZPNdata" onclick="ZPA_Checklist.add();"><i class="CR-nodata-chklst"><i class="path1"></i><i class="path2"></i><i class="path3"></i><i class="path4"></i><i class="IC-plus-round"></i></i><span>'+ZPI18N.getString("zp.checklist.add")+'</span></div><div class="ZPNdata" onclick="NewZPOnboarding.config.tagChecklist();"><i class="CR-notag-check"><i class="path1"></i><i class="path2"></i><i class="path3"></i><i class="path4"></i><i class="IC-plus-round"></i></i><span>'+ZPI18N.getString("zp.checklist.tag")+"</span></div>"),ZPA_DelugeEditor.load(),Checklist.setFunction();break;case"Forms":var parent=settingsPage.container.find("[tab-content='Forms']");NewZPOnboarding.config.forms.length<=0&&(parent.find(".zpl_crd").addClass("DNI"),parent.find("#nodata").removeClass("DNI"),parent.find("#desc").text(ZPI18N.getString("zp.noformsavailable")));break;case"Agreements":configData.tabSpecificData,parent=settingsPage.container.find("[tab-content='Agreements']");var stateOfTgl=ZPeopleComponents.toggleswitch(settingsPage.container.find('#configTabs [data-click="Agreements"]').find("[name='onbztogswitch']")).getState();if(stateOfTgl)return parent.find(".zpl_crd").removeClass("DNI"),void parent.find("#nodata").addClass("DNI");0===NewZPOnboarding.mmTemplates.length?(parent.find(".zpl_crd").addClass("DNI"),parent.find("#nodata").removeClass("DNI"),parent.find("#desc").text(ZPI18N.getString("zp.onb.agreement.norec")),parent.find("#agreeBtn").hide()):configData.tabCols.IS_VISIBLE&&stateOfTgl||(parent.find(".zpl_crd").addClass("DNI"),parent.find("#nodata").removeClass("DNI"),parent.find("#desc").text(ZPI18N.getString("zp.enableconfiguration")),parent.find("#alrtImg").removeClass("zp_nd_nofilesnd").addClass("zp_nd_setngcnf"),parent.find("#agreeBtn").show())}},NewZPOnboarding.config.addForm=function(){window.open("#settings/service/onboarding/form","_blank")},NewZPOnboarding.config.enableDocuments=function(){var parent=settingsPage.container.find("[tab-content='Agreements']");parent.find(".zpl_crd").removeClass("DNI"),parent.find("#nodata").addClass("DNI"),ZPeopleComponents.toggleswitch(settingsPage.container.find('#configTabs [data-click="Agreements"]').find("[name='onbztogswitch']")).switchOn()},NewZPOnboarding.config.loadkras=function(data,params){void 0!=data&&data.trim().length>0&&(settingsPage.container.find("#kraParentNew").replaceWith(data),settingsPage.container.find("#kralibrarybtn").remove(),settingsPage.container.find("#kramappingimportexpbtn").remove(),kraLibBtn='<button class="zlabel zlabel--blue zlabel--outline zlabel--medium zpl_btnellips" id="kraLibraryRedirectBtn" title="'+ZPI18N.getString("zp.setupkrainfo")+'" onclick="window.open(\'#operations/performance/kra\',\'_blank\')"><span class="zpl_ellipsis">'+ZPI18N.getString("zp.setupkra",new Array(PMSSetting.KRA_DISPLAY_NAME))+"</span></button>",settingsPage.container.find('[tab-content="Objectives"] .zpl_rgt').append(kraLibBtn),settingsPage.container.find('[tab-content="Objectives"] .zpl_btnmnu').addClass("PR"),PMSOperation.getformDetails("kraUserform"),PMSOperation.getKraList())},NewZPOnboarding.updateOnboardingConfig=function(){var params={ONBOARDINGID:settingsPage.container.attr("onboardingid").toString()},configData=NewZPOnboarding.config.constructJson(!1);void 0!=configData&&(params.configData=JSON.stringify(configData),ZPeople.Request.send("/onboarding/flow/save",params,NewZPOnboarding.saveSuccess,void 0,NewZPOnboarding.serverError))},NewZPOnboarding.serverError=function(data){void 0!=data.responseJSON.error&&"PATTERN_NOT_MATCHED"==data.responseJSON.code&&ZPeople.Message.failure(ZPI18N.getString("zp.entervalidinput"))},NewZPOnboarding.config.constructJson=function(isPreview){settingsPage.container.find(".err").removeClass("err"),settingsPage.container.find("[id=errorInfo]").hide(),NewZPOnboarding.removeErrorSpan(settingsPage.container);var configData={},error=!1,taberror=!1,tabsOrder=[];if($.each(settingsPage.container.find("#configTabs li"),function(ind){var tabLabel=$(this).attr("data-click");tabsOrder.push(tabLabel);var tabData={tabCols:{},tabSpecificData:{}};taberror=!1,tabData.tabCols.TAB_ID=$(this).attr("id");var isvis=!0;"false"==$(this).attr("statictab")&&(isvis=ZPeopleComponents.toggleswitch($(this).find("[name=onbztogswitch]")).getState()),tabData.tabCols.IS_VISIBLE=isvis,tabData.tabCols.DISPLAY_NAME=$(this).find("[name=tabName]").text(),tabData.tabCols.SEQUENCE=ind+1;var descObj=settingsPage.container.find("#tabData [tab-content="+tabLabel+'] [name="DESCRIPTION"]');if(tabData.tabCols.DESCRIPTION=descObj.val(),""==tabData.tabCols.DISPLAY_NAME.trim()?(error=!0,$(this).find("#errorInfo").show(),$(this).find("#errorInfo").attr("title",ZPI18N.getString("zp.tabnamenotemptyerror")),taberror=!0):"Checklist"!==tabLabel&&"Welcome"!==tabLabel&&NewZPOnboarding.currentOB.onboarding_type!==NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&""==tabData.tabCols.DESCRIPTION.trim()&&(error=!0,taberror=!0,NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.cannotbeempty",[ZPI18N.getString("zp.description")]),descObj.parents("[errordiv]"))),isvis){var tabContent=settingsPage.container.find("#tabData [tab-content="+tabLabel+"]"),tabSpecificData={};if("Checklist"===tabLabel){var checklistids="";$.each(tabContent.find("#checklistbody").find("tr"),function(){checklistids.trim().length>0&&(checklistids+=","),checklistids+=$(this).attr("id");var dispName=ZSEC.Encoder.encodeForHTML($(this).find("[name=chkName]").text());NewZPOnboarding.Selectedchecklist.push({tempId:$(this).attr("id"),tempName:dispName,count:$(this).find("[name=clcount]").text()})}),tabSpecificData.checklistIds=checklistids}else if("LMS_Course"===tabLabel)if(0!=tabContent.find("#onblmscourses").find(".crdlv").length){var courses=[];$.each(tabContent.find("#onblmscourses").find(".crdlv"),function(){var coursesdtls={};coursesdtls.courseid=$(this).attr("id"),coursesdtls.isMandatory=$(this).find("[ismandatory]").attr("ismandatory"),courses.push(coursesdtls)}),tabSpecificData.courses=courses}else error=!0,taberror=!0,NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.onbcourseerror"),$("#onblmscourses"));$.each(tabContent.find("[keyname]"),function(){var keyname=$(this).attr("keyname"),val="";if("WELCOME_FEED_TEXT"==keyname)val=editor.getContent();else if("forms"==keyname){var selectforms=[],mandforms=[];$.each($(this).find("[name=selectFormDiv]"),function(){var formid="-1"==ZPeopleComponents.select($(this)).getValue()?"":ZPeopleComponents.select($(this)).getValue();selectforms.indexOf(formid)>=0?(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.formduplicate"),$(this).parents("[errordiv]").first()),error=!0,taberror=!0):void 0!=formid&&formid.trim().length>0?(selectforms.push(formid),$(this).parent("td").next("td").find("#ismand").find("input").is(":checked")&&mandforms.push(formid)):""==formid&&$(this).parents("tr[name=formsul]").remove()}),val=selectforms,tabSpecificData.mandForms=mandforms}else if("policies"==keyname){var selected=ZPeopleComponents.tokenfield($(this)).getAllValues();val=[],$.each(selected,function(index,datavalue){val.push(datavalue.id)})}else null==(val=$(this).val())&&(val=$(this).is("select")&&void 0!=$(this).attr("multiple")?[]:"");var urlregex=new RegExp("^(ht|f)tp(s?)://[-.w]*(/?)([a-zA-Z0-9-.?,:'/\\+=&amp;%$#_@]*)?$");if($.inArray(keyname,["VIDEO_URL","policies"])<0&&NewZPOnboarding.currentOB.onboarding_type!==NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&"forms"!=keyname&&(null==val||0==val.toString().trim().length)&&(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.cannotbeempty",[$(this).attr("displayText")]),$(this).parents("[errordiv]").first()),error=!0,taberror=!0),"VIDEO_URL"!==keyname&&"WEB_URL"!=keyname||0===val.trim().length||urlregex.test(val)||(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.invalidurl"),$(this).parents("[errordiv]").first()),error=!0,taberror=!0),!taberror)if(val="VIDEO_URL"===keyname||"WEB_URL"==keyname?val.trim():val,"VIDEO_URL"===keyname)if(val.indexOf("youtube")>0&&val.indexOf("/embed")<0){var match=val.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/);match&&11==match[2].length?(videoId=match[2],val=(0==val.indexOf("https")?"https":"http")+"://www.youtube.com/embed/"+videoId,tabSpecificData[keyname]=val):(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.invalidurl"),$(this).parents("[errordiv]").first()),error=!0,taberror=!0)}else tabSpecificData[keyname]=val;else tabSpecificData[keyname]=val}),Object.keys(tabSpecificData).length>0&&(tabData.tabSpecificData=tabSpecificData)}taberror?($(this).addClass("err"),$(this).find("#errorInfo").is(":hidden")&&($(this).find("#errorInfo").show(),$(this).find("#errorInfo").attr("title",ZPI18N.getString("zp.fillnecessarydetails")))):$(this).find("#errorInfo").hide(),configData[$(this).attr("data-click")]=tabData}),!error){var docTab=configData.Agreements;if(void 0!=docTab&&docTab.tabCols.IS_VISIBLE){if(settingsPage.container.find("#docsToSign").find("tbody tr").length>0){var docsToSign=[];$.each(settingsPage.container.find("#docsToSign").find("tbody tr"),function(){var docDtls={};docDtls.DISPLAY_NAME=$(this).find("[name=DISPLAY_NAME]").val(),docDtls.TEMPLATEID="-1"==ZPeopleComponents.select($(this).find("[name=TEMPLATEID]")).getValue()?"":ZPeopleComponents.select($(this).find("[name=TEMPLATEID]")).getValue();var iscandidateflow=NewZPOnboarding.currentFlowType==NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE;if(0==$(this).find("[name=DISPLAY_NAME]").val().trim().length&&""==docDtls.TEMPLATEID&&(!iscandidateflow&&(!ZPeopleComponents.select($(this).find("[name=applicableRoles]")).getValues()||0==ZPeopleComponents.select($(this).find("[name=applicableRoles]")).getValues().length)||iscandidateflow))return!0;if(0==$(this).find("[name=DISPLAY_NAME]").val().trim().length&&(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.cannotbeempty",[ZPI18N.getString("zp.zs.documentname")]),$(this).find("[name=DISPLAY_NAME]").parent("[errordiv]")),error=!0,taberror=!0),null==docDtls.TEMPLATEID||0==docDtls.TEMPLATEID.trim().length)NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.cannotbeempty",[ZPI18N.getString("zp.mailmerge")]),$(this).find("[name=TEMPLATEID]").parent("[errordiv]")),error=!0,taberror=!0;else{let selObj=$(this).find("[name=TEMPLATEID]"),selectedOpt=selObj.find("option:selected");if((void 0!==selectedOpt&&selectedOpt?selectedOpt.attr("opttype"):"")===NewZPOnboarding.HRTEMP_OPTTYPE){if(!selectedOpt.data("signdtls").data.signerFieldForAllRecp)return NewZPOnboarding.errorSpanAttach("There are no sign fields",selObj.closest("[errordiv]")),error=!0,!1}}if(!iscandidateflow&&ZPeopleComponents.select($(this).find("[name=applicableRoles]")).getValues()&&0!=ZPeopleComponents.select($(this).find("[name=applicableRoles]")).getValues()&&(docDtls.applicableRoles=ZPeopleComponents.select($(this).find("[name=applicableRoles]")).getValues(),docDtls.applicableRoles.length>20))return NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.onb.docs.maxroles",[20]),$(this).find("[name=applicableRoles]").parent("[errordiv]")),error=!0,!1;docDtls.OPT_TYPE=$(this).find("[name=TEMPLATEID]").find("option:selected").attr("opttype"),docDtls.AGREEMENTS_TYPE=ZPeopleComponents.select($(this).find("[name=AGREEMENTS_TYPE]")).getValue(),docsToSign.push(docDtls)}),configData.Agreements.tabSpecificData.docsToSign=docsToSign}(0==Object.keys(configData.Agreements.tabSpecificData).length||0==configData.Agreements.tabSpecificData.policies.length&&0==configData.Agreements.tabSpecificData.docsToSign.length)&&(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.agreementstabdocsempty"),settingsPage.container.find("#tabData [tab-content=Agreements] [name=agreements]").next().find("[errordiv]")),error=!0,taberror=!0),taberror?(settingsPage.container.find('#configTabs [data-click="Agreements"]').addClass("err"),settingsPage.container.find('#configTabs [data-click="Agreements"] #errorInfo').show(),settingsPage.container.find('#configTabs [data-click="Agreements"] #errorInfo').attr("title",ZPI18N.getString("zp.fillnecessarydetails"))):settingsPage.container.find('#configTabs [data-click="Agreements"] #errorInfo').hide()}if(!error){if(!isPreview)return configData;NewZPOnboarding.configdata=configData,NewZPOnboarding.tabsOrder=tabsOrder,void 0==NewZPOnboarding.config.hasObjTab||0===NewZPOnboarding.config.empIdDisp[NewZPOnboarding.currentOB.onboarding_type].length?(void 0==NewZPOnboarding.config.hasObjTab&&(NewZPOnboarding.config.hasObjTab={1:!1,2:void 0},NewZPOnboarding.config.empIdDisp={1:"",2:""}),ZPeople.Request.send("/onboarding/flow/preview",{onboarding_type:NewZPOnboarding.currentFlowType},NewZPOnboarding.config.previewPage)):NewZPOnboarding.config.previewPage(isPreview)}}},NewZPOnboarding.init=function(){if(Layout.Page.container=$("body"),NewZPOnboarding.isPreBoarding=!0,NewZPOnboarding.totalTabs=NewZPOnboarding.tabsOrder.length,NewZPOnboarding.singleTabAngle=Math.round(360/NewZPOnboarding.totalTabs),void 0!=currUser.photo&&""!=currUser.photo.trim()){var downloadParams={fcId:photoFC,recordId:currUser.candidateId,formId:candidateFormId,original:"false"};NewZPOnboarding.viewUrl=ZPForm.constructDownloadLink(downloadParams),$("#userImage").attr("src",NewZPOnboarding.viewUrl),$("#zpeople_userimage").attr("src",NewZPOnboarding.viewUrl)}$("#zpeople_userimage").on("click",NewCPortal.User.showLogoutModal),$(document).on("click",function(event){$("#zp_user_profile_pop").hide(),$("#zpeople_forms").hide(),$("#zpeople_more").hide(),$("#zpeople_notification").hide(),$("#showcorrespondingLogtime").hide(),0==$(event.target).parents("#zp_user_information").length&&(ZPForm.isPreboarding=!0,$("#zp_user_information").modal("hide")),null!==Layout.Page.container&&0==$(event.target).parents("#singlecalendar").length&&0==$(event.target).parents("#doublecalendar").length&&(Calendar.hideSingleCalendar(),Calendar.hideDoubleCalendar()),0!==$("#timerCurModal").length&&$("#timerCurModal").hasClass("in")&&0===$(event.target).parents("#timerCurModal").length&&$("#timerCurModal").modal("hide")}),NewZPOnboarding.isInitiated&&NewZPOnboarding.constructTabs(),$("div#zpinitloading").length>0&&$("div#zpinitloading").remove(),ZPLoader.ISDONE=!0,ZPeople.setUp(),ZPLoader.loadWms()},NewZPOnboarding.config.preview=function(){Layout.Page.container=settingsPage.container.find("#previewPop"),Layout.Page.hash=window.location.hash;let url=new URL(window.location.href);Layout.Page.urlparam="";var iframe='<iframe class="zpl_obIfrm" src="'+(url.origin+"/"+ZPeople.PORTAL_NAME+"/onboarding/preview?onbId="+Layout.Page.childUrlParam.obId)+'" style="width:100%;height:100%"/>',maindiv='<div data-modal-box="obPreviewMdl" class="zpl_mdl zpl_mcntlst zpl_mfull zpl_mopen"><div class="zpl_minr">';if(maindiv+='<div class="zpl_mhder"><div><span><span class="txttrim w300" title="'+ZPI18N.getString("zp.obpreview")+'"><b>'+ZPI18N.getString("zp.obpreview")+"</b></span></span></div>",maindiv+='<a id="configCloseMark" class="PI_cls _cls" title="'+ZPI18N.getString("zp.close")+'" onclick= NewZPOnboarding.config.closePreview()></a></div>',maindiv+=iframe,maindiv+="</div>",settingsPage.container.find('[data-modal-box="obPreviewMdl"]').length>0)settingsPage.container.find("#previewPop").removeClass("DN").html(maindiv);else{const newElement='<div id="previewPop" class="obpatch">'+maindiv+"</div>";settingsPage.container.append(newElement),settingsPage.container.find("#previewPop").addClass("obPreview")}},NewZPOnboarding.config.previewPage=function(data){if("true"===NewZPOnboarding.allowNewUI)return void NewZPOnboarding.config.preview();Layout.Page.container=settingsPage.container.find("#previewPop"),Layout.Page.hash=window.location.hash,Layout.Page.urlparam="";var modalPopup=settingsPage.container.find("#previewPop").find("#previewPop");NewZPOnboarding.tabsJson=NewZPOnboarding.configdata,NewZPOnboarding.isPreview=!0,NewZPOnboarding.readOnly=ZPOnboarding.readOnly=!0,NewZPOnboarding.onBoardingDetails={},void 0!==data.cntryInfo&&(NewZPOnboarding.contryDetails=data.cntryInfo),void 0!=data&&1!=data&&(NewZPOnboarding.config.hasObjTab[NewZPOnboarding.currentOB.onboarding_type]=data.hasObjTab,NewZPOnboarding.config.empIdDisp[NewZPOnboarding.currentOB.onboarding_type]=data.empIdDisp,NewZPOnboarding.currentOB.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?NewZPOnboarding.config.prefix=data.prefix:NewZPOnboarding.onBoardingDetails.coverImageId=data.coverImageId);var maindiv='<div data-modal-box="obPreviewMdl" class="zpl_mdl zpl_mcntlst zpl_mfull zpl_mopen"><div class="zpl_minr">';if(maindiv+='<div class="zpl_mhder"><div><span><span class="txttrim w300" title="'+ZPI18N.getString("zp.obpreview")+'"><b>'+ZPI18N.getString("zp.obpreview")+"</b></span></span></div>",maindiv+='<a id="configCloseMark" class="PI_cls _cls" title="'+ZPI18N.getString("zp.close")+'" onclick= NewZPOnboarding.config.closePreview()></a></div>',maindiv+='<div class="zpl_mcnt"><div class="zpl_mmnu"> </div>',maindiv+='<div class="zpl_mfoter d-flex"><div><button type="button" class="zlabel zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.updateOnboardingConfig()">'+ZPI18N.getString("zp.save")+"</button>",maindiv+='</div><div class="MLauto">',maindiv+='<button type="button" class="zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.config.constructJson(true)">'+ZPI18N.getString("zp.clicktopreview")+"</button>",maindiv+="</div>",settingsPage.container.find('[data-modal-box="obPreviewMdl"]').length>0)settingsPage.container.find("#previewPop").removeClass("DN").html(maindiv);else{const newElement='<div id="previewPop" class="obpatch">'+maindiv+"</div>";settingsPage.container.append(newElement),settingsPage.container.find("#previewPop").addClass("obPreview")}modalPopup=settingsPage.container.find("#previewPop");var logoDiv=null==logo||"null"==logo||0==logo.trim().length?'<a class="ZPLogo DB"></a>':'<img id="zp_logo" height="24" class="ZPLogo1" src="/viewPhoto?filename='+logo+'">',previewHtml='<div class="zo_lftPnl" id="onBoardingLeftPane"><div class="zo_ceo">';void 0!=NewZPOnboarding.configdata.Welcome.tabSpecificData.VIDEO_URL&&NewZPOnboarding.configdata.Welcome.tabSpecificData.VIDEO_URL.trim().length>0?previewHtml+='<div class="zo-vdo"><div><h2></h2><iframe class="iframe" src="'+decodeURIComponent(NewZPOnboarding.configdata.Welcome.tabSpecificData.VIDEO_URL)+'" height="405" frameborder="0" width="720"></iframe></div></div></div></div>':previewHtml+='<div class="zo-img"><img src="'+newUIImageUrl+'oblgvec.png" alt=""></div></div></div>',previewHtml+='<a href="javascript:;" class="zo_skip zo_dyn">SKIP >></a>';var prefix="";NewZPOnboarding.contactHR=ZPeople.getUserDetailsById(NewZPOnboarding.configdata.Welcome.tabSpecificData.CONTACT_HR_PERSON),NewZPOnboarding.activeTab="Welcome",NewZPOnboarding.currentOB.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(prefix=NewZPOnboarding.config.prefix,NewZPOnboarding.contactHR="",NewZPOnboarding.activeTab="Profile",candidateFormId=NewZPOnboarding.CandidateForm.id),previewHtml+='<div class="zo_rgtPnl" id="onBoardingRightPane"><div class="zo_usrW" data-click="0"><div class="zo_usrWOuter"><div class="zo_usrWInner"><div class="zp_logo">'+logoDiv+'</div><div class="zo_usrPh"><img id="userImage" src="'+ZPeople.CURR_USER.thumb+'" alt="USER"></div><h2><span>'+ZPI18N.getString("zp.welcomeaboard")+', </span><span class="name">'+ZPeople.CURR_USER.name+'</span></h2><ul><li><span class="id">'+NewZPOnboarding.config.empIdDisp[NewZPOnboarding.currentOB.onboarding_type]+"</span><span>"+prefix+ZPeople.CURR_USER.empid+'</span></li><li id="li2">';var li2="";void 0!=ZPeople.CURR_USER.desiId&&""!=ZPeople.CURR_USER.desiId.trim()&&(li2=ZPeople.CURR_USER.designation),void 0!=ZPeople.CURR_USER.deptId&&""!=ZPeople.CURR_USER.deptId.trim()&&(li2+=li2.length>0?" - ":"",li2+=ZPeople.CURR_USER.deptName),previewHtml+=li2+"</li><li>"+ZPeople.CURR_USER.email+'</li><li id="li4">',void 0!=ZPeople.CURR_USER.locId&&""!=ZPeople.CURR_USER.locId&&(previewHtml+=ZPeople.CURR_USER.locName),void 0!=ZPeople.CURR_USER.workLoc&&""!=ZPeople.CURR_USER.workLoc&&(previewHtml+='<label><i class="PI_work_loca"><i class="path1"></i><i class="path2"></i> </i><span>'+ZPeople.CURR_USER.workLoc+"</span></label>"),previewHtml+='</li><li><span class="zo_lgs" click="1" onclick="NewZPOnboarding.constructTabs()">'+ZPI18N.getString("zp.letsgetstarted")+"</span></li></ul></div></div></div></div></div>",modalPopup.find(".zpl_mcnt").html('<div class="zpl_obPstnAlg" >'+previewHtml+"</div"),modalPopup.find(".modal-footer").hide(),NewZPOnboarding.onBoardingDetails=NewZPOnboarding.onBoardingDetails},NewZPOnboarding.config.closePreview=function(){var modalPopup=settingsPage.container.find("#previewPop");ZP5Form.closeCallback(),modalPopup.modal("hide"),modalPopup.remove(),settingsPage.container.find("#submitDiv").show()},NewZPOnboarding.constructTabs=function(){settingsPage.container.find("#userAcnt").show(),settingsPage.container.find("#previewPop").find("#onBoardingLeftPane").removeClass("zo_lftPnlHome"),settingsPage.container.find("#previewPop").find("#onBoardingLeftPane").addClass("zo_lgStarted");var leftHtml='<div class="zo_wMsg"><div class="zp_logo">';if(void 0==logo||null==logo||"null"==logo)leftHtml+='<a class="ZPLogo DB"></a>';else{var imgsrc="viewPhoto?filename='"+logo+"'";NewZPPreboarding.isPreBoarding&&(imgsrc="/"+portalName+NewZPOnboarding.CONSTANTS.CPORTAL_CONTEXT+"/"+imgsrc),leftHtml+='<a href="javascript:;" class="href"><img src="viewPhoto?filename='+logo+'" alt="Zoho Logo" imgtype="thumb" width="75"></a>'}leftHtml+="</div>";var tabUl='<div class="zo_nav"><ul id="tabsUl">',rightHtml="";$.each(NewZPOnboarding.tabsOrder,function(tabInd,tabLabel){var tabJson=NewZPOnboarding.tabsJson[tabLabel];if(!(NewZPOnboarding.isPreview&&("Objectives"==tabLabel&&!NewZPOnboarding.config.hasObjTab[NewZPOnboarding.currentOB.onboarding_type]||!tabJson.tabCols.IS_VISIBLE||"Team"===tabLabel&&"null"==_LOGGEDIN_DEPID||"Forms"===tabLabel&&0===tabJson.tabSpecificData.forms.length||"Welcome"===tabLabel&&NewZPOnboarding.currentOB.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE)||"Checklist"==tabLabel)){tabCols=tabJson.tabCols;var tabClass="",headerClass="";if((!NewZPPreboarding.isPreBoarding&&0==tabInd||tabCols.IS_COMPLETED)&&(NewZPOnboarding.completeTabs[tabLabel]=!0),NewZPOnboarding.activeTab===tabLabel?(tabClass+=" zo_enbl",tabInd):headerClass="zo_dyn",void 0!=tabCols.DESCRIPTION){var encodeddes=tabCols.DESCRIPTION;NewZPOnboarding.isPreview&&(encodeddes=$("<div/>").text(encodeddes).html()),leftHtml+='<h2 data-click="'+tabLabel+'" class="whi '+headerClass+'">'+encodeddes+"<h2>"}rightHtml+='<div class="'+NewZPOnboarding.tabToClassMap[tabLabel]+'" data-click="'+tabLabel+'"></div>',"Welcome"===tabLabel&&(rightHtml+='<div class="zo_rPpl" data-click="'+tabLabel+'"></div>');var tabSpecificData=tabJson.tabSpecificData,encodedname=ZSEC.Encoder.encodeForHTML(tabCols.DISPLAY_NAME);if(tabUl+='<li click="tab_'+tabCols.TAB_ID+'" class="'+tabClass+'" label="'+tabLabel+'" onclick="NewZPOnboarding.openTab(\''+tabLabel+'\')"><i class="lIco '+NewZPOnboarding.iconClassMap[tabLabel]+'"></i>'+encodedname,"Forms"==tabLabel){var subTabs='<ul class="zo_navSub" id="subTabs">',formsArr=tabSpecificData.forms;$.each(formsArr,function(fInd,form){var adClass=form.formStatus?"completed":"";NewZPOnboarding.isPreview&&(form=ZPFRulesNew.Evaluation.findObject(NewZPOnboarding.config.forms,"formId",form)),subTabs+='<li class="'+adClass+"\" onclick='NewZPOnboarding.Forms("+JSON.stringify(form)+")' id=\""+form.formId+'">'+form.formName+"<i></i></li>"}),tabUl+=subTabs+="</ul>"}else if(void 0!=tabSpecificData&&tabSpecificData.hasOwnProperty("subTabs")){subTabs='<ul class="zo_navSub" id="subTabs">';var subTabJson=tabSpecificData.subTabs;$.each(tabSpecificData.subTabsOrder,function(sInd,subLabel){var subTab=subTabJson[subLabel].tabCols;subTabs+='<li id="'+subTab.TAB_ID+'" data-click="'+subLabel+'"><span>'+subTab.DISPLAY_NAME+'</span><i class="" onclick-"NewZPOnboarding.'+subLabel+'()"></i></li>'}),tabUl+=subTabs+="</ul>"}}}),tabUl+="</li>",leftHtml+='<h2 data-click="AllSet" class="whi">'+ZPI18N.getString("zp.allsetdesc")+"</h2>",rightHtml+='<div class="zo_gS" data-click="AllSet"></div>',tabUl+='<li click="tab_AllSet" label="AllSet" onclick="NewZPOnboarding.openTab(\'AllSet\')"><i class="lIco PI_whatnew"></i><span>'+ZPI18N.getString("zp.youreset")+"</span></li>",leftHtml+=tabUl+="</ul></div>",leftHtml+="</div>",leftHtml+='<div class="zo_mDets"><ul><li>',leftHtml+='<div class="set-size charts-container"><div class="pie-wrapper" onclick="NewZPOnboarding.openTab(\'AllSet\')"><i class="label PI_vaudit"></i><div class="pie" id="pie"><div class="left-side half-circle" id="leftCircle"></div><div class="right-side half-circle" id="rightCircle"></div></div></div></div></li>',"true"==ZPeople.ISCHAT&&void 0!=NewZPOnboarding.contactHR.id&&(leftHtml+='<li class="zo_uPhto" ischat="true" uid="'+NewZPOnboarding.contactHR.id+'" onclick="ZPeople.initUserChat(event,\''+NewZPOnboarding.contactHR.id+'\')"><img src="'+NewZPOnboarding.contactHR.thumb+'" alt=""></li>'),leftHtml+="</ul>",leftHtml+="</div>",settingsPage.container.find("#previewPop").find("#onBoardingRightPane").append(rightHtml),settingsPage.container.find("#previewPop").find("#onBoardingLeftPane").append(leftHtml),settingsPage.container.find("#previewPop").find("#onBoardingLeftPane").find("#tabsUl li[click*=tab_]").on("click",function(){$(this).siblings("li").removeClass("zo_enbl"),$(this).addClass("zo_enbl")}),NewZPOnboarding.checkComplete(),settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find("[data-click]").not("[data-click="+NewZPOnboarding.activeTab+"]").hide(),NewZPOnboarding.openTab(NewZPOnboarding.activeTab),$("div#zpinitloading").length>0&&$("div#zpinitloading").remove()},NewZPOnboarding.Welcome=function(resultObj,params){if(NewZPOnboarding.isPreview||"false"!==resultObj.success){var hr=NewZPOnboarding.contactHR,ext=""!=hr.extension?'<div><i class="PI_frm_phone"><i class="path1"></i><i class="path2"></i></i>'+hr.extension+"</div>":"",hrInfoHtml='<div class="zo_tbl"><div class="zo-shwhr PI_comuni"><i class="path1"></i><i class="path2"></i></div><div class="zo_rCol"><div class="zo_tblcell"><h4>'+ZPI18N.getString("zp.yourhrcontact")+'</h4><div class="zo_uPhto"><img src="'+hr.thumb+'" alt="USER"></div><span>'+hr.name+"</span><p>"+hr.designation+"</p>"+ext;if("true"==ZPeople.ISCHAT&&void 0!=hr.id&&(hrInfoHtml+='<label uid="'+hr.id+'" ischat="true" onclick="ZPeople.initUserChat(event,\''+hr.id+'\')"><i class="PI_chat"><i class="path1"></i><i class="path2"></i></i></label>'),hrInfoHtml+="</div></div>",void 0!=NewZPOnboarding.onBoardingDetails.reportingto){var reportingto=ZPeople.getUserDetailsById(NewZPOnboarding.onBoardingDetails.reportingto);ext=""!=reportingto.extension?'<div><i class="PI_frm_phone"><i class="path1"></i><i class="path2"></i></i>'+reportingto.extension+"</div>":"",hrInfoHtml+='<div class="zo_rCol"><div class="zo_tblcell"><h4>'+ZPI18N.getString("zp.yourmanager")+'</h4><div class="zo_uPhto"><img src="'+reportingto.thumb+'" alt="USER"></div><span>'+reportingto.name+"</span><p>"+reportingto.designation+"</p>"+ext,"true"==ZPeople.ISCHAT&&void 0!=reportingto.id&&(hrInfoHtml+='<label uid="'+reportingto.id+'" ischat="true" onclick="ZPeople.initUserChat(event,\''+reportingto.id+'\')"><i class="PI_comuni"><i class="path1"></i><i class="path2"></i></i></label>'),hrInfoHtml+="</div></div>"}if(hrInfoHtml+="</div>",settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find(".zo_rPpl").html(hrInfoHtml),settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find(".PI_comuni").on("click",function(){settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").hasClass("min")?settingsPage.container.find("#onBoardingRightPane:visible").removeClass("min"):settingsPage.container.find("#onBoardingRightPane:visible").addClass("min")}),NewZPOnboarding.isPreview){var welcomeUser=ZPeople.getUserDetailsById(erecno),welcomeMessage=NewZPOnboarding.tabsJson.Welcome.tabSpecificData.WELCOME_FEED_TEXT.replace(/\${FEED USER MENTION}/g,'<span><a id="user_pop_dtl" empid="'+welcomeUser.empid+'" href="#home/dashboard/profile-userId:'+welcomeUser.usererec+'" target="_blank">'+welcomeUser.name+"</a></span>"),feedHtml='<div class="zo_feeds" id=""><div class="zo_scrl"><ul id="" streamid="" class="zo_feedlst"><li id="" streamid=""><div class="zo_uPhto"><img src="'+hr.thumb+'" alt="USER" imgtype="thumb" empid="'+hr.id+'" id="user_pop_dtl"></div><div id="actOwner">'+hr.name+'</div><div class="zo_feedContent">'+welcomeMessage+'</div><span class="zo_feedT">14 November 2017 , 3:17 PM</span><label><i id="like_link" action="0" class="PI_fil_fav"></i></label></li></ul></div><ul class="zo_cFxd" id="text_area_comment"><li><div class="zo_uPhto"><img src="'+ZPeople.CURR_USER.thumb+'" alt="USER"></div><textarea id="comment_textarea" placeholder="'+ZPI18N.getString("zp.writeacomment")+'"></textarea>';settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find('[data-click="Welcome"]').first().html(feedHtml)}else if(null==resultObj||void 0==resultObj||void 0==resultObj.activity){var feedsHtml='<div class="text-center MT50" id="zp_feeds_nodata" ><img src="/newzp/images/zpbee.png" alt="" class="W200"><h5>'+ZPI18N.getString("zp.nofeedsyet")+"</h5></div>";$("#onBoardingRightPane:visible").find('[data-click="Welcome"]').first().html(feedsHtml)}else{ZPeople.CURRENT_VIEWKEY=ZPeople.VIEWKEYS.Status;var activity=resultObj.activity,activityObj=new People.Activity(new Activity(activity));AcsApi.initStream("People",ZPeople.CURRENT_VIEWKEY,10);var feedTemplate=ZPFeeds.Construction.constructFeedsTemplates(activityObj);feedsHtml='<div class="zo_feeds" id="'+ZPeople.CURRENT_VIEWKEY+'"><div class="zo_scrl" id="feedDiv"><ul id="'+ZPeople.VIEWKEYS.Status+'" streamid="'+activityObj.actRecId+'"></ul><ul id="comment_feed" class="zo_feedComments"></ul></div><ul class="zo_cFxd" id="text_area_comment"><li><div class="zo_uPhto"><img src="'+ZPeople.CURR_USER.thumb+'" alt="USER"></div><textarea id="comment_textarea" placeholder="Write a Comment"></textarea>';feedsHtml+="</li></ul></div>",$("#onBoardingRightPane:visible").find('[data-click="Welcome"]').first().html(feedsHtml),$("#onBoardingRightPane:visible").find("#feedDiv").append(feedTemplate),$.each($("#onBoardingRightPane:visible").find("#feedDiv .zp-post-cont").find("[popup=user]"),function(index,obj){if(void 0!=$(obj).attr("href")){var href="/"+$(obj).attr("href");$(obj).attr("href",href)}});var viewMoreText=$("#onBoardingRightPane:visible").find("#feedDiv #view_more_cmts a").html();$("#onBoardingRightPane:visible").find("#feedDiv #view_more_cmts,.zp-post-actions").remove(),$("#onBoardingRightPane:visible").find("#feedDiv #cmtpostcont").remove(),ZPFeeds.Construction.constructComments($("#onBoardingRightPane:visible").find("#comment_feed"),activityObj,activityObj.comments);var styleDiv=activityObj.totalComments<4?'style="display: none;"':"";$("#onBoardingRightPane:visible").find("#bottomcont").append($('<div class="zp-fd-more" id="view_more_cmts" '+styleDiv+' totalcmts="'+activityObj.totalComments+'"><a class="" totalcmts="'+activityObj.totalComments+'">'+viewMoreText+'</a><input type="hidden" id="cmt_morekey" value="'+activityObj.cmt_morekey+'"/><input type="hidden" id="cmt_skey" value="'+activityObj.cmt_skey+'"/><input type="hidden" id="act_type" value="'+activityObj.type+'"/><input type="hidden" id="act_fdk" value="'+activityObj.fdk+'"/></div><div id="comment_feed" comments="'+activityObj.comments.length+'"></div></div>')),void 0!==resultObj.likedUsrs&&Object.keys(resultObj.likedUsrs).length>0&&(void 0!=resultObj.likedUsrs.statusIds[activityObj.actRecId]&&resultObj.likedUsrs.statusIds[activityObj.actRecId][1]>0&&NewZPOnboarding.Feeds.constructLikersName(activityObj.actRecId,resultObj.likedUsrs.statusIds[activityObj.actRecId],!0,resultObj.likedUsrs.likedUserDtls),$.each(activityObj.comments,function(commentInd,comment){void 0!=resultObj.likedUsrs.commentIds[comment.commentId]&&resultObj.likedUsrs.commentIds[comment.commentId][1]>0&&NewZPOnboarding.Feeds.constructLikersName(comment.commentId,resultObj.likedUsrs.commentIds[comment.commentId],!1,resultObj.likedUsrs.likedUserDtls)})),NewZPOnboarding.readOnly||($("#onBoardingRightPane:visible").find("#like_link").off(),$("#onBoardingRightPane:visible").find("#like_link").on("click",function(){ZPFeeds.Like.doLikeAction(this,activityObj.actRecId,activityObj.type,!1)}),$("#onBoardingRightPane:visible").find("#view_more_cmts").off(),$("#onBoardingRightPane:visible").find("#view_more_cmts").on("click",function(){ZPFeeds.Comment.getMoreComments($(this).children("a")),$(this).hide()}),$("#onBoardingRightPane:visible").find("#comment_textarea").on("keyup",function(e){13!=e.which||e.shiftKey||""!=$(this).val().trim()&&(e.stopPropagation(),NewZPOnboarding.Feeds.post(activityObj.fdk,activityObj.type,this))})),settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find(".zp-fd-box").addClass("FN")}}},NewZPOnboarding.Feeds.constructLikersName=function(key,value,isActivity,likedUserDtls){var container=isActivity?$.find("[streamid="+key+"]"):$.find("[commentid="+key+"]"),userIds=value[0].toString().split(","),likedCnt=value[1];-1!==userIds.indexOf(erecno)&&(userIds.splice(0!==userIds.indexOf(erecno)?userIds.indexOf(erecno):0,1),userIds.unshift(erecno));var tooltipId="",linkId="";if(isActivity?(tooltipId="liked_usrs",linkId="like_link"):(tooltipId="commentLiked_usrs",linkId="zpcmt_like_link"),0==userIds.length&&$(container).find("#"+linkId).removeClass("red-color"),userIds.length>0){for(var usrDtl,Obj=$('<div data-toggle="tooltip" data-placement="top" data-html="true" data-container="body" id="'+tooltipId+'" class="dgry FR S12" ><i class="" count='+likedCnt+">"+likedCnt+"</i></div></div>").on("click",function(){return ZPFeeds.Like.getMoreLikedUsers(key,isActivity)}),likers='<div id="likers" class="liked-list">',currUserLiked=!1,userInd=0;userInd<userIds.length;userInd++){var liker="";if(usrDtl=likedUserDtls[userIds[userInd]],userInd<9&&(liker='<span empid="'+userIds[userInd]+'">',liker+=userIds[userInd]==erecno?ZPI18N.getString("zp.you"):usrDtl.empName,likers+=liker+="</span>"),userIds[userInd]===erecno&&(currUserLiked=!0),userIds.length>10&&9===userInd){likers+="<span morecount="+(likedCnt=parseInt(likedCnt)-10)+">"+ZPI18N.getString("zp.and",[""])+" "+likedCnt+" "+ZPI18N.getString("zp.smore")+"</span>";break}}currUserLiked?($(container).find("#"+linkId).addClass("red-color"),$(container).find("#"+linkId).attr("action",1)):($(container).find("#"+linkId).removeClass("red-color"),$(container).find("#"+linkId).attr("action",0)),likers+="</div>",Obj=Obj.attr("title",likers),$(container).find("#"+tooltipId).length>0?$(container).find("#"+tooltipId).replaceWith(Obj):$(container).find("#"+linkId).parent("span").append(Obj),$("[id="+tooltipId+"]").tooltip("enable")}else $(container).find("#"+tooltipId).replaceWith("")},NewZPOnboarding.Feeds.getNewCommentEditor=function(id,fdk,type){ZPUtil.escapeSelector(fdk);var editorObj=$("#onBoardingRightPane:visible").find("#comment_textarea");if(editorObj.find("#zpEditor").length>0&&void 0===ZPFeeds.Editor.editorList[id]||0===editorObj.find("#zpEditor").length)ZPFeeds.COMMENTEDITOR=ZPFeeds.Editor.getEditor(id,type),editorObj.append($('<div class="pst" id="zp_dash_feeds_postband"> '+("Status"===type||"Collaboration"===type?'<div class="attachFile" id="zp_comment_Attachments"><a class="IC-attach1" href="javascript:;"  id="zp_dash_attachIcon" onclick="ZPFeeds.createInput(false, \''+fdk+"')\"><span>"+ZPI18N.getString("zp.attach")+"</span></a></div>":"")+'<div class="FR  MT1">  <button class="btn btn-primary btn-loading"  id="post_comment_input" type="button" onclick="ZPFeeds.Comment.post(\''+fdk+"', '"+type+'\')"><span class="FL">'+ZPI18N.getString("zp.feeds.post")+"</span></button></div> </div>"));else{var editor=ZPFeeds.Editor.editorList[id];void 0!==editor&&(ZPFeeds.COMMENTEDITOR=editor)}editorObj.addClass("in"),editorObj.children().removeClass("DN"),0===parseInt(editorObj.find("#zp_dash_attachments").attr("attachcnt"))&&editorObj.find("#zp_dash_attachments").addClass("DN"),setTimeout(function(){ZPFeeds.COMMENTEDITOR.focus()},500),editorObj.find("textarea#comment_textarea").addClass("DN")},NewZPOnboarding.Feeds.post=function(fdk,type,obj){var messageText=$(obj).val();if(messageText.length>5e3)messageText.length>5e3&&ZPeople.Message.warning(ZPI18N.getString("zp.commentlengthwarning"));else{messageText=messageText.replace(/\n/g,"<br/>");var params={type:type,fdk:fdk,callBack:NewZPOnboarding.Feeds.handleCommentResponse,content:"<div>"+messageText+"</div>",messageText:messageText,curConObj:obj,attachCnt:null,isOnboarding:"true"};ZPFeeds.postAction(params,!1)}},NewZPOnboarding.Feeds.handleCommentResponse=function(data,params){"string"==typeof data&&(data=JSON.parse(data)),400===data.code&&ZPeople.Message.failure(ZPI18N.getString("zp.unabletoprocess"));var commentSecObj=ZPFeeds.getCurrentViewContainer().find("#comment_feed"),totalcmd=parseInt(commentSecObj.find("#more_comments").attr("totalcmd"));commentSecObj.find("#more_comments").attr("totalcmd",++totalcmd),$("#comment_textarea").val(""),$("#comment_textarea").trigger("blur")},NewZPOnboarding.Team=function(data,params){if(null!=data){var teamMembers=[];void 0!=data.deptMembers&&(empDeptList=data.deptMembers.empDeptList,1==params.start&&ZPeople.FireScroll.setRecordCount(data.deptMembersCount),data.deptMembers.hasMoreResult&&ZPeople.FireScroll.reset(),teamMembers=empDeptList);var teamHtml="";if(1==params.start){settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find('[data-click="Team"]').attr("scroll","enabled");var deptLead="";teamHtml='<div class="zo_Httl"><h2>'+ZPI18N.getString("zp.Onboarding.Team")+'</h2><i class="PI_hrcomuni_manag zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div>',data.deptLeadName&&(deptLead='<div class="zo_usrhead"><img src="'+data.deptLeadPhoto+'" alt="User"><div class="zo_usrname">'+data.deptLeadName+"</div><div>"+ZPI18N.getString("zp.dept")+"</div></div>",teamHtml='<div class="zo_usrsteam_head">'+deptLead+'<div class="zo_depart"><b>'+data.deptName+"</b><span>"+data.deptMail+'</span></div><div class="zo_usrcount"><b>'+data.deptMembersCount+"</b><span>"+ZPI18N.getString("zp.members")+"</span></div></div>");parseInt(teamMembers.length);teamHtml+='<div class="zo_tCont"><div class="zo_usrsteam" id="teamMembers">'}$.each(teamMembers,function(memberIndex,memberDtl){teamHtml+='<div><img src="'+memberDtl.photo+'" alt="User"><p><span>'+memberDtl.eid+"</span> - <b>"+NewZPOnboarding.emptyToDash(memberDtl.name)+"</b></p>",void 0!=memberDtl.desname&&(teamHtml+="<p>"+memberDtl.desname+"</p>"),teamHtml+="<ul>",teamHtml+='<li><i class="PI_mail"><i class="path2"></i></i><span data-toggle="tooltip" title="" data-original-title="'+NewZPOnboarding.emptyToDash(memberDtl.email)+'" data-container="body" data-placement="bottom">'+NewZPOnboarding.emptyToDash(memberDtl.email)+'</span></li><li><i class="PI_frm_phone"></i>'+NewZPOnboarding.emptyToDash(memberDtl.extn)+"</li></ul>","true"==ZPeople.ISCHAT&&void 0!=memberDtl.zuid&&(teamHtml+='<span class="sayHi" ischat="true" uid="'+memberDtl.zuid+'" onclick="ZPeople.initUserChat(event,'+memberDtl.zuid+')">'+ZPI18N.getString("zp.sayhi")+"!</span>"),teamHtml+="</div>"}),1==params.start?(teamHtml+="</div></div>",settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find('[data-click="Team"]').html(teamHtml)):(ZPeople.FireScroll.increaseRecordCount(data.deptMembersCount),settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find('[data-click="Team"] #teamMembers').append(teamHtml)),NewZPOnboarding.completeTabs.Team=!0,NewZPOnboarding.readOnly||NewZPOnboarding.checkComplete(),1==params.start&&(settingsPage.parentContainer=settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible"),ZPeople.FireScroll.init(NewZPOnboarding.deptListFireScroll))}},NewZPOnboarding.Forms=function(activeForm){settingsPage.container.find("#previewPop").find("#onBoardingLeftPane").find("#subTabs:visible li").removeClass("zo_enbl");var formId=activeForm.formId;settingsPage.container.find("#previewPop").find("#onBoardingLeftPane li[label=Forms] li").removeClass("zo_enbl"),settingsPage.container.find("#previewPop").find("#onBoardingLeftPane").find("#"+formId).addClass("zo_enbl");var loadParams={isPageMode:!0,formId:formId,disableUrlTrack:!0,callback:NewZPOnboarding.formEditResponse};NewZPOnboarding.isPreview?("P_Employee"==activeForm.componentName?(loadParams.formMode="EDIT",loadParams.recordId=erecno):loadParams.formMode="ADD",ZPOnboarding.onBoardingDetails=NewZPOnboarding.onBoardingDetails):(loadParams.formMode="EDIT",loadParams.recordId=activeForm.recordId,settingsPage.hash="");var formDiv=settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find('[data-click="Forms"]');activeForm.componentName.indexOf("P_Timesheet")>=0?(loadParams.onloadCallback=Timetracker.forms.formOnLoadCallback,"P_TimesheetJobsList"===activeForm.componentName?loadParams.createFldFunctions={ClientId:Timetracker.forms.constructFormField,ProjectUsers:Timetracker.forms.constructFormField}:loadParams.createFldFunctions={Assignees:Timetracker.forms.constructFormField,Hours:Timetracker.forms.constructFormField,BillableStatus:Timetracker.forms.constructFormField}):"P_ApplyLeave"===activeForm.componentName&&(loadParams.fieldFormat=["Employee_ID","Leavetype","From","To","TeamEmailID","Reasonforleave"],loadParams.fieldCallback={Employee_ID:Leave.Form.getApplicable,Leavetype:Leave.Form.getDetails,From:Leave.Form.getDetails,To:Leave.Form.getDetails}),settingsPage.hashDtl=void 0,ZP5Form.getFormClassObj()&&ZP5Form.getFormClassObj().layoutRevertChanges(ZP5Form.getFormClassObj());let form=ZP5Form._toForm(loadParams);form.setPreviewForm(!0),form.setFormContainer(formDiv),form.init()},NewZPOnboarding.Profile=function(){var formId=candidateFormId,loadParams={isPageMode:!0,formId:formId,disableUrlTrack:!0,callback:NewZPOnboarding.formEditResponse};loadParams.countryInfo=NewZPOnboarding.contryDetails,NewZPOnboarding.isPreview?loadParams.formMode="ADD":(loadParams.formMode="EDIT",loadParams.recordId=currUser.candidateId,settingsPage.hash="");var profileDiv=settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find('[data-click="Profile"]');0==profileDiv.find("#zp_addedit_record_"+formId).length&&(profileDiv.append('<div class="zo_proForm obForms" id="zp_addedit_record_'+formId+'"></div>'),settingsPage.container.find("#zp_addedit_record_"+formId).append(ZPeople.LOADING_HTML)),settingsPage.hashDtl=void 0;let form=ZP5Form._toForm(loadParams);form.setPreviewForm(!0),form.setFormContainer(profileDiv),form.init()},NewZPOnboarding.Agreements=function(agreementJson){if(void 0!=agreementJson.docsToSign){var docsArr=agreementJson.docsToSign,docsHtml='<div class="zo_docNav" id="agreements"><h3>'+ZPI18N.getString("zp.acknowledgeandesign")+"</h3><ul>",docsLen=0;if($.each(docsArr,function(docsInd,docDtls){if(NewZPOnboarding.isPreview&&void 0!=docDtls.applicableRoles&&-1==$.inArray(ZPeople.CURR_USER.roleId,docDtls.applicableRoles))return!0;docsLen++;var completeClass="",completeAttr="null",tickClass="";docDtls.IS_ACCEPTED?(completeClass="completed",completeAttr="true",tickClass="PI_tick1"):null!=docDtls.IS_ACCEPTED&&(completeClass="rejected",completeAttr="false",tickClass="PI_cls1"),docsHtml+='<li doctype="'+docDtls.doctype+'" onclick="NewZPOnboarding.openDoc(this)" formId="'+docDtls.FORMID+'" agreementId="'+docDtls.TEMPLATEID+'" class="'+completeClass+'" iscompleted="'+completeAttr+'" filePath="'+docDtls.FILEPATH+'"><span prop="fileName" data-placement="bottom" title="'+ZSEC.Encoder.encodeForHTML(docDtls.DISPLAY_NAME)+'">'+ZSEC.Encoder.encodeForHTML(docDtls.DISPLAY_NAME)+'</span><i class="'+tickClass+'"></i></li>'}),0==docsLen){if(docsHtml="",void 0==agreementJson.policies||0==agreementJson.policies.length)return docsHtml='<div style="text-align: center;padding-top:20%;"><h1>'+ZPI18N.getString("zp.nodocsfortherole")+"</h1></div>",settingsPage.container.find("#previewPop").find("#docs").parent().html(docsHtml),!0}else docsHtml+="</ul></div>";settingsPage.container.find("#previewPop").find("#docs").append(docsHtml),0==settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find('[data-click="Agreements"]').find("#pdfViewerDiv").length&&(docsHtml='<div class="zo_docadd" id="pdfViewerDiv"><div class="zo_docPnl"><div class="zo_docHead"><span name="fileName"></span></div><div class="zo_docLoad"><div class="zo_Loded">'+NewZPOnboarding.iFrameTemplate.replace(/\$ID\$/,"docFrame")+'</div></div><div class="zo_docFoot"><div class="zo_docBtns" id="docBtns"><button value="true" onclick="NewZPOnboarding.acceptAgreement(null,null,{forPost:true,obj:this});">Accept</button><button value="false" onclick="NewZPOnboarding.acceptAgreement(null,null,{forPost:true,obj:this});">Decline</button></div></div></div></div>',$(docsHtml).insertAfter(settingsPage.container.find("#previewPop").find("#docs"))),0==$("#policies").length&&(settingsPage.container.find("#previewPop").find("#docs").find('li[iscompleted="false"]').length>0?settingsPage.container.find("#previewPop").find("#docs").find('li[iscompleted="false"]').first().trigger("click"):settingsPage.container.find("#previewPop").find("#docs").find("li").first().trigger("click"))}else if(!NewZPOnboarding.readOnly){var tabId=NewZPOnboarding.tabsJson.Agreements.tabCols.TAB_ID;ZPeople.Request.send("/onboarding/pre/setTabStatus",{tabId:tabId},NewZPOnboarding.checkComplete)}},NewZPOnboarding.openTab=function(activeTab){var currentTab=settingsPage.container.find("#previewPop").find("#onBoardingLeftPane #tabsUl").children("li.zo_enbl").attr("label");if(settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find("[data-click]").hide(),settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find('[data-click="'+activeTab+'"]').show(),settingsPage.container.find("#previewPop").find("#onBoardingLeftPane").find("[data-click]").addClass("zo_dyn"),settingsPage.container.find("#previewPop").find("#onBoardingLeftPane").find('[data-click="'+activeTab+'"]').removeClass("zo_dyn"),"AllSet"==activeTab)return NewZPOnboarding.AllSet(),settingsPage.container.find("#previewPop").find("#onBoardingLeftPane").find("[label]").removeClass("zo_enbl"),void settingsPage.container.find("#previewPop").find("#onBoardingLeftPane").find("[label=AllSet]").addClass("zo_enbl");if(""==settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find('[data-click="'+activeTab+'"]').html()||"Welcome"==activeTab&&NewZPOnboarding.totalTabs>Object.keys(NewZPOnboarding.completeTabs).length||NewZPPreboarding.isPreBoarding&&$.inArray(activeTab,["Profile","Forms"])>-1&&currentTab!=activeTab||"LMS_Course"==activeTab){if("Forms"==activeTab){var tabData=NewZPOnboarding.tabsJson[activeTab].tabSpecificData;return void(tabData.hasOwnProperty("activeFormDetails")?NewZPOnboarding[activeTab](tabData.activeFormDetails):NewZPOnboarding.isPreview?(form=ZPFRulesNew.Evaluation.findObject(NewZPOnboarding.config.forms,"formId",tabData.forms[0]),NewZPOnboarding[activeTab](form)):NewZPOnboarding[activeTab](tabData.forms[0]))}if(settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find('[data-click="'+activeTab+'"]').append(ZPeople.LOADING_HTML),"Organization"==activeTab)return void NewZPOnboarding.Organization(NewZPOnboarding.tabsJson[activeTab]);if("Agreements"==activeTab){navigator.geolocation.getCurrentPosition(function(pos){NewZPOnboarding.latitude=pos.coords.latitude,NewZPOnboarding.longitude=pos.coords.longitude});var agreementsHtml='<div class="zo_docLst" id="docs">$DOCS$</div>',docsHtml="",agreementJson=NewZPOnboarding.tabsJson[activeTab].tabSpecificData;if(void 0!=agreementJson.policies&&Object.keys(agreementJson.policies).length>0){var docsArr=agreementJson.policies;docsHtml='<div class="zo_docNav" id="policies"><h3>'+ZPI18N.getString("zp.foryourperusal")+"</h3><ul>";var activeClass="onRead";$.each(docsArr,function(docsInd,docDtls){if(NewZPOnboarding.isPreview){var json=ZPFRulesNew.Evaluation.findObject(NewZPOnboarding.hrFiles,"fileID",docDtls);void 0!=json&&(docDtls={FILEID:json.fileID,FILENAME:NewZPOnboarding.decodeTxt(json.fileName),FILEPATH:json.filePath,FILEEXTN:json.fileExtn,UPLOADSOURCE:json.uploadSource,ACKNOWLEDGE:json.ACKNOWLEDGE,hasloginuserack:json.hasloginuserack})}1==docDtls.UPLOADSOURCE||docDtls.FILEPATH.indexOf(workDriveUrl)>-1||docDtls.FILEPATH.indexOf(writerUrl)>-1||docDtls.FILEPATH.indexOf(sheetUrl)>-1||docDtls.FILEPATH.indexOf(showUrl),docsHtml+='<li class="'+activeClass+'" id="'+docDtls.FILEID+'" onclick="NewZPOnboarding.openDoc(this)" filePath="'+docDtls.FILEPATH+'" fileExtn="'+docDtls.FILEEXTN+'"><span prop="fileName" title="'+ZSEC.Encoder.encodeForHTML(docDtls.FILENAME)+'">'+ZSEC.Encoder.encodeForHTML(docDtls.FILENAME)+'</span><i class="PI_tick1"></i></li>',activeClass=""}),docsHtml+="</ul></div>",agreementsHtml+='<div class="zo_docadd" id="pdfViewerDiv"><div class="zo_docPnl"><div class="zo_docHead"><span name="fileName"></span><a class="zo_docClose" name="" href="javascript:NewZPOnboarding.fullScreenShowhide(\'hide\');"><i class="PI_cls1"></i></a><a class="zo_docExpand" name="" href="javascript:NewZPOnboarding.fullScreenShowhide(\'show\');"><i class="PI_maxmz" data-content="" data-placement="top" data-trigger="hover" title="'+ZPI18N.getString("zp.expand")+'"></i></a><a name="fileOptions" href=""><i class="PI_print" data-content="" data-placement="top" data-trigger="hover" title="'+ZPI18N.getString("zp.print")+'"></i></a><a name="fileOptions" href=""><i class="PI_downld" data-content="" data-placement="top" data-trigger="hover" title="'+ZPI18N.getString("zp.Download")+'"></i></a></div><div class="zo_docLoad"><div class="zo_Loded"><iframe id="docFrame" src="" width="100%" height="100%"></iframe></div></div><div class="zo_docFoot"><div class="zo_docBtns" id="docBtns"><button value="true" onclick="NewZPOnboarding.acceptAgreement(null,null,{forPost:true,obj:this});">Accept</button><button value="false" onclick="NewZPOnboarding.acceptAgreement(null,null,{forPost:true,obj:this});">Decline</button></div></div></div></div>'}agreementsHtml=agreementsHtml.replace("$DOCS$",docsHtml),settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find('[data-click="Agreements"]').html(agreementsHtml),settingsPage.container.find("#previewPop").find("#docs").find("li").first().trigger("click"),NewZPOnboarding.Agreements(agreementJson)}else if(NewZPOnboarding.isPreview&&"Welcome"==activeTab||"Profile"==activeTab)NewZPOnboarding[activeTab]();else if("LMS_Course"==activeTab)NewZPOnboarding.LMS_Course(NewZPOnboarding.tabsJson[activeTab].tabSpecificData.courses);else{var params={parmode:"tabContent",submode:activeTab,isPreview:NewZPOnboarding.isPreview};"Team"==activeTab&&(params.start=1,params.end=25),ZPeople.Request.send("/onboarding/pre/tabContent",params,NewZPOnboarding[activeTab])}}else"Agreements"==activeTab&&$("#onBoardingRightPane:visible").find("#agreements").length>0&&settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find("#agreements li.onRead").trigger("click")},NewZPOnboarding.deptListFireScroll=function(){var obj=ZPeople.FireScroll.getFireScrollPropertie(),params={parmode:"tabContent",submode:"Team",isPreview:NewZPOnboarding.isPreview,start:obj.count+1,end:25};ZPeople.Request.send("/onboarding/pre/tabContent",params,NewZPOnboarding.Team)},NewZPOnboarding.openDoc=function(obj){NewZPOnboarding.currentDoc.fileId=$(obj).attr("id"),settingsPage.container.find("#previewPop").find("#docBtns").hide(),settingsPage.container.find("#previewPop").find(".zo_Loded").removeAttr("style"),settingsPage.container.find("#previewPop").find(".zo_docLoad").find("#agonbload").remove(),settingsPage.container.find("#previewPop").find(".zo_docLoad").find("#zp_page_loading").remove(),settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find(".zo_Loded").html('<div id="docFrame">'+ZPeople.LOADING_HTML+"</div>");var agrID=settingsPage.container.find("#previewPop").find(obj).attr("agreementId");null!=agrID&&void 0!=agrID&&""!=agrID&&(NewZPOnboarding.currentDoc.agrId=agrID),settingsPage.container.find("#previewPop").find("#docs").find("li").removeClass("onRead"),settingsPage.container.find("#previewPop").find(obj).addClass("onRead"),settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find("[name=fileName]").html($(obj).find("span[prop=fileName]").html());var doctype=$(obj).attr("doctype");if($.inArray(doctype,["2","3","4"])>-1){$(obj).index();$(obj).addClass("NM OP5"),ZPeople.Request.send("/onboarding/pre/esignUrl",{parmode:"ESIGNURL",agrId:NewZPOnboarding.currentDoc.agrId},NewZPOnboarding.esignurl,{obj:obj})}else if(NewZPOnboarding.readOnly||(null!=agrID&&void 0!=agrID&&""!=agrID&&"null"==$(obj).attr("iscompleted")?settingsPage.container.find("#previewPop").find("#docBtns").find("button").attr("agrid",NewZPOnboarding.currentDoc.agrId):settingsPage.container.find("#previewPop").find("#docBtns").hide()),void 0!=NewZPOnboarding.currentDoc.fileId&&"undefined"!=NewZPOnboarding.currentDoc.fileId&&"null"!=NewZPOnboarding.currentDoc.fileId){var frameid="viewFileFrame",fileExtn=$(obj).attr("fileExtn");if(void 0==fileExtn||"undefined"==fileExtn){var fileName=void 0!=$(obj).attr("filePath")?$(obj).attr("filePath"):$(obj).find("[prop=fileName]").text();-1==fileName.lastIndexOf(".")&&-1==fileName.lastIndexOf(".")||(fileExtn=(fileExtn=fileName.substr(fileName.lastIndexOf(".")+1,fileName.length)).toLowerCase())}"jpg"!==fileExtn&&"jpeg"!==fileExtn&&"gif"!==fileExtn&&"png"!==fileExtn||(frameid="imageviewFrame");var filePath=$(obj).attr("filePath"),docFrame=NewZPOnboarding.iFrameTemplate.replace(/\$ID\$/,frameid),wdfile=!1;if(void 0!=filePath&&(filePath.indexOf(writerUrl)>-1?(filePath=filePath.replace("/open/","/zwpreview/"),docFrame=docFrame.replace(/\$SRC\$/,filePath),wdfile=!0):filePath.indexOf(workDriveUrl)>-1?(docFrame=docFrame.replace(/\$SRC\$/,filePath),wdfile=!0):docFrame=docFrame.replace(/\$SRC\$/,"")),settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find(".zo_Loded").html(docFrame),settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find("#"+frameid).attr("onload",'settingsPage.container.find("#'+frameid+'").removeAttr("style");'),settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find("[prop=docProp]").show(),settingsPage.container.find("#previewPop").find(".zo_docLoad").prepend(ZPeople.LOADING_HTML),settingsPage.container.find("#previewPop").find(".zo_Loded").css("background-color","transparent"),!wdfile){var fdata={fileID:NewZPOnboarding.currentDoc.fileId,fileName:$(obj).find("[prop=fileName]").text(),filePath:$(obj).attr("filePath")};IsNumeric($(obj).attr("filePath"))&&(fdata.fileExtn=$(obj).attr("fileExtn")),void 0==fdata.filePath&&(fdata.filePath=fdata.fileName);let src="viewFile?fileId="+NewZPOnboarding.currentDoc.fileId;src+=void 0!=NewZPOnboarding.latitude&&void 0!=NewZPOnboarding.longitude?"&latitude="+NewZPOnboarding.latitude+"&longitude="+NewZPOnboarding.longitude:"",settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find("#"+frameid).attr("src",src),settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find("[name=fileOptions]").each(function(ind){let href="";if(0===ind){let fileId=ZPOnboarding.currentDoc.fileId;href=`javascript:var v = window.open('viewFile?fileId=${fileId+=void 0!=ZPOnboarding.latitude&&void 0!=ZPOnboarding.longitude?"&latitude="+ZPOnboarding.latitude+"&longitude="+ZPOnboarding.longitude:""}');v.print()`}else 1===ind&&(href=`javascript:Files.downloadFilecabinet('html','${ZPOnboarding.currentDoc.fileId}','${fdata.filePath}','${fdata.fileName}')`);$(this).attr("href",href)})}var isAgreement=$(obj).parents("#agreements").length>0;settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find("#"+frameid).on("load",function(){settingsPage.container.find("#"+frameid).removeAttr("style"),isAgreement&&"null"==$(obj).attr("iscompleted")&&NewZPOnboarding.scrollToEnd(obj)})}else settingsPage.container.find("#previewPop").find("#onBoardingRightPane").find("[prop=docProp]").hide(),ZPeople.Request.send("/onboarding/pre/getFileId",{parmode:"getFileId",agrId:NewZPOnboarding.currentDoc.agrId,isPreview:NewZPOnboarding.isPreview},NewZPOnboarding.openFile,{obj:obj})},NewZPOnboarding.openFile=function(data,params,others){void 0!=data.hrFilesId?(settingsPage.container.find("#previewPop").find(others.obj).attr("id",data.hrFilesId),NewZPOnboarding.openDoc(others.obj)):void 0!=data.msg&&(settingsPage.container.find("#previewPop").find("#docBtns").hide(),settingsPage.container.find("#previewPop").find("#onBoardingRightPane:visible").find("#docFrame").replaceWith(NewZPOnboarding.docError.replace(/\$MSG\$/,data.msg)))},NewZPOnboarding.fileOptions=["javascript:var v = window.open('viewFile?fileId=$FILEID$');v.print()","javascript:Files.downloadFilecabinet('html','$FILEID$','$FILEPATH$','$FILENAME$')"],NewZPOnboarding.formEditResponse=function(recId,IS_COMPLETED,isDraft){ZPForm.Record.isDraft=!1;var curformParam=ZPForm.CURRFORM_PARAM,formId=curformParam.formId,currFormLi=settingsPage.container.find("#onBoardingLeftPane").find("#subTabs li#"+formId);if(!isDraft){currFormLi.addClass("completed");var tabSwitch=!1;if(void 0!=IS_COMPLETED&&IS_COMPLETED&&("P_Candidate"==ZPForm.getTableName()?(NewZPOnboarding.completeTabs.Profile=!0,tabSwitch=!0,ZPeople.Request.send("/onboarding/pre/updateCandidate",{},NewZPOnboarding.updateCandidateProfile)):(NewZPOnboarding.completeTabs.Forms=!0,currFormLi.siblings("li").not(".completed").length>0?NewZPOnboarding.formComplete=!0:tabSwitch=!0),NewZPOnboarding.checkComplete()),NewZPOnboarding.formComplete&&0==currFormLi.siblings("li").not(".completed").length&&(tabSwitch=!0,delete NewZPOnboarding.formComplete),tabSwitch){var LABEL_NAME=settingsPage.container.find("#onBoardingRightPane").find("[data-click]:visible").attr("data-click");NewZPOnboarding.completeTabs[LABEL_NAME]=!0;var activeObj=settingsPage.container.find("#onBoardingLeftPane").find("#tabsUl li[label="+LABEL_NAME+"]");$(activeObj).addClass("completed"),$(activeObj).next("li").not(".completed").trigger("click")}if(NewZPOnboarding.formComplete&&"P_Candidate"!=ZPForm.getTableName()){var nextForm=null;currFormLi.nextAll("li").not(".completed").length>0?nextForm=currFormLi.nextAll("li").not(".completed").first():currFormLi.prevAll("li").not(".completed").length>0&&(nextForm=currFormLi.prevAll("li").not(".completed").first())}null!=nextForm||"P_Candidate"===ZPForm.getTableName()||IS_COMPLETED||NewZPOnboarding.Forms({formId:curformParam.formId,recordId:recId,formName:ZPForm.getTableName(),formStatus:!1,componentName:ZPForm.CONF.formName,isMandatory:!1}),"P_Employee"==ZPForm.getTableName()&&ZPeople.sendUserListAjax([recId]);var hasFormTemplates=!1;settingsPage.container.find("#onBoardingRightPane").find("#agreements [formid="+formId+"]").each(function(){hasFormTemplates=!0,$(this).attr("id",null)}),hasFormTemplates&&!NewZPPreboarding.isPreBoarding&&ZPeople.Request.send("/onboarding/pre/updateAgreements",{formId:formId})}settingsPage.container.find("#zp_addedit_record_"+curformParam.formId).remove(),delete ZPForm.SINGLE_RECORD_DTL[curformParam.formId+"_"+curformParam.recordId],"P_Candidate"==ZPForm.getTableName()?NewZPOnboarding.Profile():IS_COMPLETED&&!NewZPOnboarding.formComplete||(null==nextForm?currFormLi.trigger("click"):nextForm.trigger("click"))},NewZPOnboarding.fullScreenShowhide=function(action){"show"==action?settingsPage.container.find("#pdfViewerDiv").addClass("fullScreen"):settingsPage.container.find("#pdfViewerDiv").removeClass("fullScreen")},NewZPOnboarding.acceptAgreement=function(data,params,others){var obj=$(others.obj);if(others.hasOwnProperty("forPost"))delete others.forPost,$(obj).addClass("disabled"),ZPeople.Request.send("/onboarding/pre/accept",{parmode:"ACCEPT",agrId:NewZPOnboarding.currentDoc.agrId,isaccept:$(obj).attr("value")},NewZPOnboarding.acceptAgreement,others);else if(data.isSuccess){if(data.isAccepted){$("#docs #"+NewZPOnboarding.currentDoc.fileId).addClass("completed"),$("#docs #"+NewZPOnboarding.currentDoc.fileId).find("i").addClass("PI_tick1");var text=obj.parents("#pdfViewerDiv").find("[name=fileName]").text()+"   --- Accepted";ZPeople.Message.success(ZPI18N.getString("zp.acceptsuccess"))}else{$("#docs #"+NewZPOnboarding.currentDoc.fileId).addClass("rejected"),$("#docs #"+NewZPOnboarding.currentDoc.fileId).find("i").addClass("PI_cls1");text=obj.parents("#pdfViewerDiv").find("[name=fileName]").text()+"   --- Rejected";ZPeople.Message.failure(ZPI18N.getString("zp.rejectsuccess"))}if($("#docs #"+NewZPOnboarding.currentDoc.fileId).attr("iscompleted",data.isAccepted),obj.parents("#pdfViewerDiv").find("[name=fileName]").text(text),obj.parents("#docBtns").hide(),$("#docs li").not(".completed").length>0){var clickObj=$("#docs #"+NewZPOnboarding.currentDoc.fileId).next("li").not(".completed");0==$(clickObj).length&&(clickObj=$("#docs #"+NewZPOnboarding.currentDoc.fileId).prev("li").not(".completed"),0==$(clickObj).length&&(clickObj=$("#docs").find("li").first())),clickObj.trigger("click")}data.tabState&&(NewZPOnboarding.completeTabs.Agreements=!0,NewZPOnboarding.checkComplete())}else $(obj).removeClass("disabled")},NewZPOnboarding.Objectives=function(data,params,others){if(data.isSuccess){var KRAHeader='<div class="zo_Httl"><h2>'+ZSEC.Encoder.encodeForHTML(NewZPOnboarding.tabsJson.Objectives.tabCols.DISPLAY_NAME)+'</h2><i class="PI_EmpEng zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div><div class="zo_kravec"><img src="/newhr/images/kra.png"></div>',KRAbody='<div class="zo_kraI">',kras=data.kras;$.each(kras,function(kraInd,kra){KRAbody+="<div>",KRAbody+="<h3>"+kra.kraName+"</h3>",void 0!=kra.goalmapping&&(KRAbody+="<ul>",$.each(kra.goalmapping,function(gInd,goal){KRAbody+="<li>"+goal.goalName+"</li>"}),KRAbody+="</ul>"),KRAbody+="</div>"}),KRAbody+="</div>",settingsPage.container.find("#onBoardingRightPane:visible").find('[data-click="Objectives"]').html(KRAHeader+KRAbody),NewZPOnboarding.completeTabs.Objectives=!0,NewZPOnboarding.readOnly||NewZPOnboarding.checkComplete()}},NewZPOnboarding.Organization=function(orgJson){var orgHtml='<div class="zo_Httl"><h2>'+ZSEC.Encoder.encodeForHTML(orgJson.tabCols.DISPLAY_NAME)+'</h2><i class="PI_hrcomuni_manag zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div><div class="zo_eCont">';orgHtml=(orgHtml+=NewZPOnboarding.iFrameTemplate.replace(/\$ID\$/,"orgFrame")).replace(/\$SRC\$/g,orgJson.tabSpecificData.WEB_URL),orgHtml+="</div>",settingsPage.container.find("#onBoardingRightPane:visible").find('[data-click="Organization"]').html(orgHtml),NewZPOnboarding.readOnly||ZPeople.Request.send("/onboarding/pre/setTabStatus",{tabId:NewZPOnboarding.tabsJson.Organization.tabCols.TAB_ID},NewZPOnboarding.checkComplete)},NewZPOnboarding.openChat=function(userZuid){var params={parmode:"openchat",userId:userZuid};ZPeople.Request.send("/openChat.zp",params)},NewZPOnboarding.checkComplete=function(data){if(void 0!=data){if(data.hasOwnProperty("msg"))return void ZPeople.Message.success(msg);if(data.isSuccess){var LABEL_NAME=settingsPage.container.find("#onBoardingRightPane").find("[data-click]:visible").attr("data-click");NewZPOnboarding.completeTabs[LABEL_NAME]=!0;var activeObj=settingsPage.container.find("#onBoardingLeftPane").find("#tabsUl li[label="+LABEL_NAME+"]");$(activeObj).addClass("completed"),$.inArray(LABEL_NAME,["Team","Organization"])<0&&("Agreements"!=LABEL_NAME||0!=settingsPage.container.find("#onBoardingRightPane").find("#docs").find("#agreements").length)&&$(activeObj).next("li").not(".completed").trigger("click")}}var angle=0;angle=NewZPOnboarding.totalTabs==Object.keys(NewZPOnboarding.completeTabs).length?360:Object.keys(NewZPOnboarding.completeTabs).length*NewZPOnboarding.singleTabAngle,$("#leftCircle").css({"-webkit-transform":"rotate("+angle+"deg)",transform:"rotate("+angle+"deg)"}),angle>180&&($("#pie").css("clip","rect(auto, auto, auto, auto)"),$("#rightCircle").css({"-webkit-transform":"rotate(180deg)",transform:"rotate(180deg)"}))},NewZPOnboarding.AllSet=function(){var allsetHtml='<div class="zo_Httl"><h2>'+ZPI18N.getString("zp.youreset")+'</h2><i class="PI_travel zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div>';allsetHtml+='<div class="zo_gScontent">'+ZPI18N.getString("zp.youresettext")+"<ul>";var reptype="preonboarding"==settingsPage.currentmode?"P_Candidate":"P_Employee";if(NewZPOnboarding.isPreview||$.ajax({type:"POST",async:!1,url:"/onboarding/pre/tabDetails",data:{conreqcsr:csrfToken,parmode:"empTabDetails",pkid:erecno,reportType:reptype,isadmincall:!1},success:function(data){NewZPOnboarding.tabsJson=data.tabDetails,NewZPOnboarding.tabsOrder=data.tabsOrder}}),$.each(NewZPOnboarding.tabsOrder,function(tInd,tLabel){if("AllSet"!=tLabel){var tObject=NewZPOnboarding.tabsJson[tLabel].tabCols,fonttag="",docsdiv="";if(NewZPOnboarding.isPreview&&("Objectives"==tLabel&&!NewZPOnboarding.config.hasObjTab[NewZPOnboarding.currentOB.onboarding_type]||!tObject.IS_VISIBLE||"Team"===tLabel&&"null"==_LOGGEDIN_DEPID||"Forms"===tLabel&&0===NewZPOnboarding.tabsJson.Forms.tabSpecificData.forms.length||"Checklist"==tLabel||"Welcome"===tLabel&&NewZPOnboarding.currentOB.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE))return;var className=tObject.IS_COMPLETED?"completed":"",encodedname=ZSEC.Encoder.encodeForHTML(tObject.DISPLAY_NAME);if("Agreements"===tLabel)className+=" zo_gSext",NewZPOnboarding.completeTabs.Agreements=tObject.IS_COMPLETED,void 0!=(docsData=NewZPOnboarding.tabsJson.Agreements.tabSpecificData.docsToSign)&&docsData.length>0&&(fonttag='<font class="PI_abtm rtt S13 PL8"></font>',docsdiv="<ul>",$.each(docsData,function(docind,docData){var compclass="",iconclass="";void 0!=docData.IS_ACCEPTED?(docData.IS_ACCEPTED?compclass="completed":iconclass="IC-cls-1px",compclass=docData.IS_ACCEPTED?"completed":""):NewZPOnboarding.isPreview&&(iconclass="PI_tick2_fil"),docsdiv+="<li class="+compclass+">"+ZSEC.Encoder.encodeForHTML(docData.DISPLAY_NAME)+"<i class="+iconclass+"></i></li>"}),docsdiv+="</ul>");else if("Forms"===tLabel){var docsData;if(className+="zo_gSext",fonttag='<font class="PI_abtm rtt"></font>',void 0!=(docsData=NewZPOnboarding.tabsJson.Forms.tabSpecificData.forms)&&docsData.length>0){docsdiv="<ul>";var iconCls=className+" PI_tick2_fil";$.each(docsData,function(docind,docData){NewZPOnboarding.isPreview&&(docData=ZPFRulesNew.Evaluation.findObject(NewZPOnboarding.config.forms,"formId",docData),docsdiv+="<li>"+docData.formName+'<i class="'+iconCls+'"></i></li>')}),docsdiv+="</ul>"}}allsetHtml+="<li class="+className+">"+encodedname+fonttag+'<i class="PI_tick2_fil"></i>'+docsdiv+"</li>"}}),allsetHtml+="</ul>",!NewZPOnboarding.readOnly){var href=window.location.href,onclick="NewZPOnboarding.checkAndCompleteOnboarding()";NewZPPreboarding.isPreBoarding&&(href,onclick='ZPeople.confirm("","","zp.completeonbalert",NewZPOnboarding.checkAndCompleteOnboarding)'),allsetHtml+='<button class="btndone" onclick='+onclick+">"+ZPI18N.getString("zp.completeonboardingkey")+"</button>"}allsetHtml+="</div>",settingsPage.container.find("#onBoardingRightPane").find('[data-click="AllSet"]').html(allsetHtml)},NewZPOnboarding.addNewOnboarding=function(obj){var obHeader=ZPI18N.getString("zp.addnewflow"),obDoneBtn=ZPI18N.getString("zp.add"),onbType="";if(void 0!=obj)obHeader=ZPI18N.getString("zp.editflow"),obDoneBtn=ZPI18N.getString("zp.save"),obData=NewZPOnboarding.obTemplatesList[$(obj).parents("[obid]").attr("obid")];else{onbType=Layout.Page.hash.indexOf("settings/service/onboarding/candidateflow")>-1?NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE:NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE,obData={DISPLAY_NAME:"",ONBOARDINGID:"",applicableFor:{locList:{},roleList:{},desList:{}},ONBOARDING_TYPE:onbType}}void 0==obData.applicableFor&&(obData.applicableFor={locList:{},roleList:{},desList:{}});let isCanOnb=obData.ONBOARDING_TYPE===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE;var addObHtml='<div data-modal-box="addflowpopup" class="zpl_mdl zpl_mopen" id="addOnboarding'+obData.ONBOARDINGID+'">';addObHtml+='<div class="zpl_minr"><div class="zpl_mhder"><div><h4>'+obHeader+'</h4></div><a class="PI_cls _cls" buttonaction="dismiss"></a></div>',addObHtml+='<div class="zpl_mcnt zpl_fm"><form><div class="zpl_crd"><div class="zpl_crdcnt">',addObHtml+='<div class="zpl_secn" errordiv="cantbeempty"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.onbflowname")+'</label></div><div><input type="text" class="ztextbox" maxlength="250" placeholder="'+ZPI18N.getString("zp.esign.enterflowname")+'" keyname="DISPLAY_NAME" value="'+obData.DISPLAY_NAME+'"></div></div>';var expInfo=ZPI18N.getString("zp.onb.expiry.empinfo"),expHead=ZPI18N.getString("zp.onb.expiry.emptitle");if(isCanOnb&&(expInfo=ZPI18N.getString("zp.onb.expiry.candinfo"),expHead=ZPI18N.getString("zp.onb.expiry.candtitle")),!obData.IS_SYSTEM||!isCanOnb){let mancls=isCanOnb?"":"zpl_mtry";addObHtml+='<div class="zpl_secn" errordiv="cantbeempty">',addObHtml+='<div><label class="'+mancls+'">'+ZPI18N.getString("zp.payperiod.applicablelocations")+'</label></div><div><z-tokenfield placeholder="'+ZPI18N.getString("zp.all")+'" keyname="location">',addObHtml+="</z-tokenfield></div></div>";var isRole="",isDesgn="",roleClass="DN",desgnClass="DN";void 0!=obData.applicableFor.roleList&&Object.keys(obData.applicableFor.roleList).length>0?(isRole="selected",roleClass=""):void 0!=obData.applicableFor.desList&&Object.keys(obData.applicableFor.desList).length>0&&(isDesgn="selected",desgnClass=""),isCanOnb?desgnClass="":(addObHtml+='<div class="zpl_secn" errordiv="cantbeempty"><div><label>'+ZPI18N.getString("zp.applicablefor",[""])+'</label></div><div><select name="applicableType">',addObHtml+='<option value="">'+ZPI18N.getString("zp.select")+"</option>",isCanOnb||(addObHtml+="<option "+isRole+' value="1">'+ZPI18N.getString("zp.role")+"</option>"),addObHtml+="<option "+isDesgn+' value="2">'+ZPI18N.getString("zp.designation")+"</option></select></div></div>",obData.ONBOARDING_TYPE!==NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(addObHtml+='<div class="zpl_secn '+roleClass+'" id="Applicable_role"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.applicableroles")+'</label></div><div><z-tokenfield keyname="role">',addObHtml+="</z-tokenfield></div></div>")),addObHtml+='<div class="zpl_secn '+desgnClass+'" id="Applicable_desgn"><div><label class="'+mancls+'">'+ZPI18N.getString("zp.applicabledesignations")+'</label></div><div><z-tokenfield placeholder="'+ZPI18N.getString("zp.all")+'" keyname="designation">',addObHtml+="</z-tokenfield></div></div>"}var expiry=void 0!=obData.EXPIRY?obData.EXPIRY:"";addObHtml+='<div class="zpl_secn" errordiv="cantbeempty"><div><label>'+expHead+' <i class="PI_info" data-title-position="right" title="'+expInfo+'"></i></label></div><div><input id="obExpiry" type="text" class="ztextbox" placeholder="'+ZPI18N.getString("zp.onb.expiry.placeholder")+'" keyname="EXPIRY" maxlength="3" value="'+expiry+'"></div></div>',obData.IS_SYSTEM&&isCanOnb&&(addObHtml+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.payperiod.applicablelocations")+'</label></div><div ><div id="locDiv" labelname="location"><em>'+ZPI18N.getString("zp.alllocaction")+'</em></div></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.applicabledesignations")+'</label></div><div name="add_flow_data"><div id="desgDiv" labelname="designation"><em>'+ZPI18N.getString("zp.alldesignation")+"</em></div></div></div>"),addObHtml+="</div></div></form></div>",addObHtml+='<div class="zpl_mfoter"><button type="button" class="zlabel zlabel--blue zlabel--medium" buttonname="done">'+obDoneBtn+'</button><button type="button" class="zlabel zlabel--outline zlabel--medium" buttonaction="dismiss">'+ZPI18N.getString("zp.cancel")+"</button></div>",settingsPage.container.parent().parent().find("[id*=addOnboarding]").remove(),settingsPage.container.parent().parent().append(addObHtml);var obPopup=settingsPage.container.parent().parent().find("#addOnboarding"+obData.ONBOARDINGID);ZPeopleComponents.select(obPopup.find("select"));var data=[],selected=[];$.each(ZPPickList.allData.Locations,function(locId,locationData){var info={id:locId,name:ZPeople.decodeTxt(locationData.recName)};data.push(info),void 0!=obData.applicableFor.locList&&Object.keys(obData.applicableFor.locList).length>0&&void 0!=obData.applicableFor.locList[locId]&&selected.push(info)}),ZPeopleComponents.tokenfield(obPopup.find("[keyname=location]"),{data:data,dataMapping:{value:"id",text:"name",id:"id"},values:selected,placeholder:ZPI18N.getString("zp.all")}),obData.ONBOARDING_TYPE!==NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(data=[],selected=[],$.each(ZPPickList.allData.Roles,function(roleId,roleData){var info={id:roleId,name:ZPeople.decodeTxt(roleData.recName)};data.push(info),void 0!=obData.applicableFor.roleList&&Object.keys(obData.applicableFor.roleList).length>0&&void 0!=obData.applicableFor.roleList[roleId]&&selected.push(info)})),ZPeopleComponents.tokenfield(obPopup.find("[keyname=role]"),{data:data,dataMapping:{value:"id",text:"name",id:"id"},values:selected,dropdownList:{width:200},placeholder:ZPI18N.getString("zp.all")}),data=[],selected=[],$.each(ZPPickList.allData.Designations,function(desgnId,desgnData){var info={id:desgnId,name:ZPeople.decodeTxt(desgnData.recName)};data.push(info),void 0!=obData.applicableFor.desList&&Object.keys(obData.applicableFor.desList).length>0&&void 0!=obData.applicableFor.desList[desgnId]&&selected.push(info)}),ZPeopleComponents.tokenfield(obPopup.find("[keyname=designation]"),{data:data,dataMapping:{value:"id",text:"name",id:"id"},values:selected,placeholder:ZPI18N.getString("zp.all")}),obPopup.find('[buttonaction="dismiss"]').attr("onclick","javascript:settingsPage.container.find('#submitDiv').show();"),obPopup.find('select[name="applicableType"]').on("zselectchange",function(){obPopup.find("[id=Applicable_"+NewZPOnboarding.applicableConstants[ZPeopleComponents.select($(this)).getValue()]+"]").removeClass("DN"),obPopup.find("[id*=Applicable_]").not("[id=Applicable_"+NewZPOnboarding.applicableConstants[ZPeopleComponents.select($(this)).getValue()]+"]").addClass("DN")}),obPopup.find("[buttonname=done]").off();var isEmpOnb=obData.ONBOARDING_TYPE==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE;obPopup.find("[buttonname=done]").on("click",function(){NewZPOnboarding.removeErrorSpan(obPopup);var params={},obId=obPopup.attr("id").match(/\d+$/);null!=obId&&(params.ONBOARDINGID=obId.toString());var applicableFor={},error=!1;obPopup.find("[keyname]").not(".DN").each(function(){if(!$(this).closest(".zpl_secn").hasClass("DN")){var keyname=$(this).attr("keyname"),keyval=$(this).val();if("role"==keyname||"designation"==keyname||"location"==keyname){var allvalues=ZPeopleComponents.tokenfield($(this)).getAllValues();if(allvalues.length>30)return ZPeople.Message.failure(ZPI18N.getString("zp.maximumapplicablityexceeded",[30])),void(error=!0);if(isEmpOnb)keyval=[],$.each(allvalues,function(index,datavalue){keyval.push(datavalue.id)});else if(allvalues.length>0){let keyValArray=[];$.each(allvalues,function(index,datavalue){let valObj={};valObj.name=datavalue.name,valObj.id=datavalue.id,keyValArray.push(valObj)}),applicableFor[keyname]=keyValArray}}var errorDiv=$(this).parent("div");if("DISPLAY_NAME"==keyname)if(0==keyval.trim().length)NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.address.entervaluefor",[ZPI18N.getString("zp.displayname")]),errorDiv),error=!0;else{var aDiv=settingsPage.container.find("#onbflowtabele b");null!=obId&&(aDiv=settingsPage.container.find("#onbflowtabele b").not("[id="+obId+"]")),aDiv.each(function(){if($(this).html()==keyval)return NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.flownameduplicate",[ZPI18N.getString("zp.flowname")]),errorDiv),error=!0,!1}),params[keyname]=keyval}else if("EXPIRY"==keyname){""!==keyval&&(!/^\d+/.test(keyval)||isNaN(keyval)?(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.onbexperror"),errorDiv),error=!0):keyval>120?(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.onbexperrlimit"),errorDiv),error=!0):params[keyname]=keyval)}else"designation"!=keyname&&"role"!=keyname||!isEmpOnb||0!=keyval.length?"onboarding_type"==keyname?params[keyname]=keyval:null!=keyval&&void 0!=keyval&&0!=keyval.length&&obData.ONBOARDING_TYPE==NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE&&($.inArray(keyname,["role","designation","location"])>-1&&(keyval=keyval.toString()),applicableFor[keyname]=keyval):(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.pleaseselectdes",[$(this).closest(".zpl_secn").find("label").text()]),errorDiv),error=!0)}}),isEmpOnb?params.applicableForEmpOnb=JSON.stringify(applicableFor):params.applicableFor=JSON.stringify(applicableFor),params.onboarding_type=NewZPOnboarding.currentFlowType,error||(ZPeople.Request.send("/onboarding/flow/save",params,NewZPOnboarding.saveSuccess,void 0,NewZPOnboarding.serverError),obPopup.find("[buttonname=done]").attr("disabled","disabled"),settingsPage.container.find(".btn-primary").attr("disabled","disabled"))}),obPopup.find('[buttonaction="dismiss"]').on("click",function(){obPopup.remove()})},NewZPOnboarding.saveSuccess=function(data,params,others){if(void 0==params.configData){if(data.msg==zpconst.CommonMessages.SUCCESSMSG){settingsPage.container.parent().parent().find("[id*=addOnboarding]").removeClass("zpl_mopen"),ZPeople.Message.success(ZPI18N.getString("zp.onb.onbflowaddsucc"));var obRow=NewZPOnboarding.config.obRowCreate(data.newOb);if(void 0==params.ONBOARDINGID){var flowurl=NewZPOnboarding.currentFlowType==NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?"candidateflow":"employeeflow";window.location.href="#settings/service/onboarding/"+flowurl+"/editflow-obId:"+data.newOb.ONBOARDINGID;var tbody=settingsPage.container.find("#onbflowtabele");NewZPOnboarding.currentFlowType==NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE?tbody.prepend(obRow):tbody.append(obRow)}else{delete NewZPOnboarding.configbyid[data.newOb.ONBOARDINGID],settingsPage.container.find("tr[obid="+data.newOb.ONBOARDINGID+"]").replaceWith(obRow);var maindiv="";NewZPOnboarding.removeViewApplicable(),NewZPOnboarding.applicabilityList={},void 0!==data.newOb.applicableFor?NewZPOnboarding.applicabilityList=NewZPOnboarding.applicableForBuild(data.newOb.applicableFor):(maindiv+='<a class="zpl_drpdwn-js zh-radiusbottom" id="viewapplicability">'+ZPI18N.getString("zp.onb.applicable")+'</a><i class="PI_edt" onclick="NewZPOnboarding.addNewOnboarding(this)"></i',settingsPage.container.find("#applicable").html(maindiv)),settingsPage.container.find("#dispNm").html(data.newOb.DISPLAY_NAME),settingsPage.container.find("#dispNm").attr("title",data.newOb.DISPLAY_NAME)}if(ZPeopleComponents.toggleswitch(settingsPage.container.find("[obid="+data.newOb.ONBOARDINGID+"]").find(".onbflowstaus"),{on:data.newOb.IS_VISIBLE,change:NewZPOnboarding.changeStatus}),NewZPOnboarding.obTemplatesList[data.newOb.ONBOARDINGID]=data.newOb,settingsPage.container.attr("onboardingid")!=data.newOb.ONBOARDINGID||settingsPage.container.siblings("[onboardingid="+data.newOb.ONBOARDINGID+"]").length>0){var obDiv=settingsPage.container.attr("onboardingid")!=data.newOb.ONBOARDINGID?settingsPage.container:settingsPage.container.siblings("[onboardingid="+data.newOb.ONBOARDINGID+"]");NewZPOnboarding.removeViewApplicable(),NewZPOnboarding.applicabilityList={},void 0!=data.newOb.applicableFor&&(NewZPOnboarding.applicabilityList=NewZPOnboarding.applicableForBuild(data.newOb.applicableFor));maindiv='<div class="brcumb" id="applicable"><a class="zpl_drpdwn-js" id="viewapplicability">'+ZPI18N.getString("zp.onb.applicable")+"</a>";$(obDiv).find("#applicable").replaceWith(maindiv+'<i class="PI_edt" onclick="NewZPOnboarding.addNewOnboarding(this)"></i></div></div>')}}else if(data.msg==zpconst.CommonMessages.FAILUREMSG){if(!0===data.isSystem)return void ZPeople.Message.showFailureMsg(data.msg);var msgHead=ZPI18N.getString("zp.flowalreadyexists")+"\n",msg="<div>";$.each(data.duplicateOb,function(ind,obData){msg+=obData.DISPLAY_NAME+" -> ",msg+=NewZPOnboarding.applicableForFailuremsg(obData.applicableFor),msg+="<br/>"}),msg+="</div>",setTimeout(function(){FrameworkCommon.showInfoAlert(msgHead,msg)},500)}else if(data.hasOwnProperty("empmaillist")){var erecnoobj=[],html="<p>"+ZPI18N.getString("zp.onbactionerror")+"</p><p>"+ZPI18N.getString("zp.confirmonbdelte")+"</p>";html+='<div class="row frmsettings dvConfirm"><ul class="list-group col-md-10 col-md-offset-1 MT10"><li class="list-group-item ZPbold active"><span id="associationName">'+ZPI18N.getString("zp.employees")+"</span></li>",$.each(data.empmaillist,function(index1,emp){$.each(emp,function(id,email){erecnoobj[index1]=id,html+='<li class="list-group-item"><a onclick="window.open(\'#operations/organization/employee/view-recordId:'+id+"','_blank')\">"+email+"</a></li>"})}),html+="</ul></div>",FrameworkCommon.showInfoAlert(ZPI18N.getString("zp.editonbflow"),html,{callback:NewZPOnboarding.clearOnboarding,isCancelNeeded:!0,doneBtn:ZPI18N.getString("zp.confirm"),details:JSON.stringify(erecnoobj)})}else void 0!=data.msg&&data.msg.trim().length>0&&(setTimeout(function(){FrameworkCommon.showInfoAlert("",data.msg)},500),$("#textConfirmationPopupBody p").first().addClass("pspace"));settingsPage.container.find("#viewapplicability").off().on("click",function(){NewZPOnboarding.constructViewApplicable(NewZPOnboarding.applicabilityList)})}else data.msg==zpconst.CommonMessages.SUCCESSMSG?(delete NewZPOnboarding.configbyid[params.ONBOARDINGID],ZPeople.Message.success(ZPI18N.getString("zp.updatedsuccessfully"))):data.msg==zpconst.CommonMessages.FAILUREMSG&&$.each(data.errors,function(errorTab,errorObj){var tabDiv=settingsPage.container.find("#tabData [tab-content="+errorTab+"]");settingsPage.container.find('#configTabs [data-click="'+errorTab+'"]').addClass("err"),settingsPage.container.find('#configTabs [data-click="'+errorTab+'"] #errorInfo').show(),settingsPage.container.find('#configTabs [data-click="'+errorTab+'"] #errorInfo').attr("title",ZPI18N.getString("zp.fillnecessarydetails")),$.each(errorObj,function(errorKey,errorMsg){if("object"==typeof errorMsg)$.each(errorMsg,function(eInd,eObj){$.each(eObj,function(keyname,msg){NewZPOnboarding.errorSpanAttach(msg,tabDiv.find("[keyname="+keyname+"],[name="+keyname+"]").parent()[eInd])})});else if("WELCOME_FEED_TEXT"==errorKey)NewZPOnboarding.errorSpanAttach(errorMsg,tabDiv.find("[keyname="+errorKey+"],[name="+errorKey+"]").parents("[errordiv]").first());else if("DISPLAY_NAME"==errorKey)NewZPOnboarding.errorSpanAttach(errorMsg,settingsPage.container.find("#configTabs [data-click="+errorTab+"]"));else{var errorDiv=tabDiv.find("[keyname="+errorKey+"],[name="+errorKey+"]");void 0==errorDiv.attr("errordiv")?NewZPOnboarding.errorSpanAttach(errorMsg,errorDiv.parents("[errordiv]")):NewZPOnboarding.errorSpanAttach(errorMsg,errorDiv)}})});settingsPage.container.find("#submitDiv").show(),$("[buttonname=done]").removeAttr("disabled")},NewZPOnboarding.applicableForFailuremsg=function(ob){var totalApplicable="";return $.each(ob,function(key,json){if(0!=Object.keys(json).length){var keyName="";switch(key){case"desList":keyName=ZPI18N.getString("zp.designations");break;case"roleList":keyName=ZPI18N.getString("zp.roles");break;case"locList":keyName=ZPI18N.getString("zp.locations")}totalApplicable+="<b>"+keyName+":</b><span>";var count=0;$.each(json,function(jsonKey,jsonValue){count>0&&(totalApplicable+=","),totalApplicable+=jsonValue,count++}),totalApplicable+="</span>"}}),totalApplicable},NewZPOnboarding.applicableForBuild=function(ob){var list={desList:[],roleList:[],locList:[]};return ZPUtil.Validation.isEmpty(ob)&&(list.desList.push({text:ZPI18N.getString("zp.all")}),list.roleList.push({text:ZPI18N.getString("zp.all")}),list.locList.push({text:ZPI18N.getString("zp.all")})),NewZPOnboarding.currentFlowType===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&delete list.roleList,ZPUtil.Validation.isEmpty(ob)||$.each(ob,function(key,json){if(0==Object.keys(json).length)return{};switch(key){case"desList":ZPI18N.getString("zp.designations");break;case"roleList":ZPI18N.getString("zp.roles");break;case"locList":ZPI18N.getString("zp.locations")}$.each(json,function(jsonKey,jsonValue){list[key].push({text:jsonValue})})}),list},NewZPOnboarding.constructViewApplicable=function(listObj){let pageId=ZPA_Common.getParentPageId(),menuId="viewApplicabilityMenu";if(!ZPeopleComponents.isComponent("#"+menuId)){let dataAttr='{"itemType": "custom"}',applicableHtml="";var menuHtml='<div id="'+menuId+'">';menuHtml+="<ul>",Object.keys(listObj).length||(void 0!==listObj.desList&&(applicableHtml="<li data='"+dataAttr+'\'><div class="zpl_aprvl_flw applcblVw"> <div> <div> <em>'+ZPI18N.getString("zp.designations")+"</em> <label><span>"+ZPI18N.getString("zp.all")+"</span></label> </div> </div> </div></li>"),void 0!==listObj.roleList&&(applicableHtml+="<li data='"+dataAttr+'\'><div class="zpl_aprvl_flw applcblVw"> <div> <div> <em>'+ZPI18N.getString("zp.roles")+"</em> <label><span>"+ZPI18N.getString("zp.all")+"</span></label> </div> </div> </div></li>"),void 0!==listObj.locList&&(applicableHtml+="<li data='"+dataAttr+'\'><div class="zpl_aprvl_flw applcblVw"> <div> <div> <em>'+ZPI18N.getString("zp.locations")+"</em> <label><span>"+ZPI18N.getString("zp.all")+"</span></label> </div> </div> </div></li>"),menuHtml+=applicableHtml),$.each(listObj,function(key,json){let count=listObj[key].length;if(count>0){applicableHtml="<li data='"+dataAttr+"'>";var keyName="";switch(key){case"desList":keyName=ZPI18N.getString("zp.designations");break;case"roleList":keyName=ZPI18N.getString("zp.roles");break;case"locList":keyName=ZPI18N.getString("zp.locations")}applicableHtml+='<div class="zpl_aprvl_flw applcblVw"> <div> <div> <em>'+keyName+"</em> <label>";let jsonInd=1;$.each(json,function(jsonKey,jsonValue){applicableHtml+="<span>"+jsonValue.text+"</span>",jsonInd++!=count&&(applicableHtml+=", ")}),applicableHtml+="</label> </div> </div> </div>",menuHtml+=applicableHtml+="</li>"}}),menuHtml+="</ul></div>",pageId.append(menuHtml),ZPeopleComponents.menu("#"+menuId,{appendTo:pageId,className:"zpl_drpdwn zpl_viewApliOb"})}ZPeopleComponents.menu("#"+menuId).show({forElement:pageId.find("#viewapplicability")})},NewZPOnboarding.removeViewApplicable=function(){ZPeopleComponents.isComponent("#viewApplicabilityMenu")&&(ZPeopleComponents.menu("#viewApplicabilityMenu").destroy(),$("#viewApplicabilityMenu").remove())},NewZPOnboarding.deleteOnboarding=function(obId){var params={ONBOARDINGID:obId};FrameworkCommon.showAlertMessage(new DeleteAlertMessage(ZPI18N.getString("zp.deleteonbflow"),ZPI18N.getString("zp.deleteconfirmtitle")),{callback:NewZPOnboarding.deleteOnboardingCall,doneBtn:ZPI18N.getString("zp.confirm"),details:params})},NewZPOnboarding.deleteOnboardingCall=function(params){ZPeople.Request.send("/onboarding/flow/delete",params.details,NewZPOnboarding.deleteSuccess)},NewZPOnboarding.deleteSuccess=function(data,params){if(data.msg==zpconst.CommonMessages.SUCCESSMSG)delete NewZPOnboarding.obTemplatesList[params.ONBOARDINGID],settingsPage.container.find("#onbflowtabele tr[obid="+params.ONBOARDINGID+"]").remove(),ZPeople.Message.success(ZPI18N.getString("zp.onb.onbflowdelsucc"));else if(data.hasOwnProperty("empmaillist")){var html="<p>"+ZPI18N.getString("zp.onbactionerror")+"</p><p>"+ZPI18N.getString("zp.confirmonbdelte")+"</p>";html+='<div class="row frmsettings dvConfirm"><ul class="list-group col-md-10 col-md-offset-1 MT10"><li class="list-group-item ZPbold active"><span id="associationName">'+ZPI18N.getString("zp.employees")+"</span></li>";var erecnoobj=[];$.each(data.empmaillist,function(index1,emp){$.each(emp,function(id,email){html+='<li class="list-group-item"><a onclick="window.open(\'#operations/organization/employee/view-recordId:'+id+"','_blank')\">"+email+"</a></li>",erecnoobj[index1]=id})}),html+="</ul></div>",setTimeout(function(){FrameworkCommon.showInfoAlert(ZPI18N.getString("zp.deleteonbflow"),html,{callback:NewZPOnboarding.clearOnboarding,isCancelNeeded:!0,doneBtn:ZPI18N.getString("zp.confirm"),details:JSON.stringify(erecnoobj)})},500)}else void 0!=data.msg&&setTimeout(function(){FrameworkCommon.showInfoAlert("",data.msg)},500)},NewZPOnboarding.clearOnboarding=function(obj){var pageid=settingsPage.container;$.ajax({type:"POST",async:!1,url:"/onboarding/reports/clearOnboarding",data:{erecnoobj:obj.details,conreqcsr:csrfToken},success:function(data){"success"==data.msg&&ZPeople.Message.success(ZPI18N.getString("zp.removesuccessful")),pageid.find("#usersOptions").addClass("DN"),pageid.find("#licenseDtlsRow").removeClass("DN"),pageid.find("table#userListTable input[name='userRowCheck']").prop("checked",!1)}}),$("#confirmationPopup").find(".modal-header").find('[name="subHeader"]').remove(),$("#confirmationPopup").find(".modal-dialog").addClass("modal-center")},NewZPOnboarding.addreplacefields=function(insertVal){editor.insertHTML(ZSEC.Encoder.encodeForHTML(insertVal))},NewZPOnboarding.errorSpanAttach=function(data,obj){errorSpan=jQuery("<span />",{class:"ztextbox--error__label",name:"errorSpan",text:data}),$(obj).append(errorSpan),$(obj).find(".ztextbox").addClass("ztextbox__error")},NewZPOnboarding.tabErrorSpanAttach=function(data,obj){errorSpan=jQuery("<span />",{class:"ztextbox--error__label",name:"errorSpan",text:data}),errorSpan.insertAfter($(obj).find(".ztextbox")),$(obj).find(".ztextbox").addClass("ztextbox__error")},NewZPOnboarding.removeErrorSpan=function(obj){$(obj).find("[name=errorSpan]").remove(),$(obj).find(".ztextbox__error").removeClass("ztextbox__error")},NewZPOnboarding.resetOnboarding=function(){FrameworkCommon.showDeleteAlert(ZPI18N.getString("zp.resetonbhead"),+ZPI18N.getString("zp.resetonbdesc"),NewZPOnboarding.resetConfig,!1,ZPI18N.getString("zp.resetonbsubmit"))},NewZPOnboarding.resetConfig=function(){NewZPOnboarding.config.activeTab=settingsPage.container.find("#configTabs li.sel").attr("data-click"),NewZPOnboarding.configPage()},NewZPOnboarding.candFlowSettings=function(){NewZPOnboarding.moduleSettings("candidate")},NewZPOnboarding.empFlowSettings=function(){NewZPOnboarding.moduleSettings("employee")},NewZPOnboarding.globalSettings=function(){NewZPOnboarding.moduleSettings("global")},NewZPOnboarding.moduleSettings=function(tab){var pageid=settingsPage.container,html="";if(0==pageid.find(".zpl_rgtcnt").length){let href=window.location.href;var mode="global";href.includes("/service/onboarding/candsettings")?mode="canSet":href.includes("/service/onboarding/empsettings")&&(mode="empSet"),pageid.html(ZPeople.LOADING_HTML),$.ajax({type:"POST",async:!1,url:"/onboarding/settings/getConfig",data:{conreqcsr:csrfToken},success:function(data){if(NewZPOnboarding.tdays=data.tdays,"canSet"===mode){html+='<div class="zpl_crd"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.gtpreferences")+"</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div class="zpl_tgsprt">',toggleclass=data.autoonboardingcomplete?"onb_ztoggle_unchecked":"onb_ztoggle_checked",html+='<h5 class="zpl_tgl" id="autoonboardingcomplete"><input class="'+toggleclass+'" name="onbztogswitch"></input>'+ZPI18N.getString("zp.newapproveonboardingcomplete")+"</h5><p>"+ZPI18N.getString("zp.newapproveonboardingcompletedesc")+"</p>",html+="</div></div></div></div>",html+='<div class="zpl_crd"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.tdojsetting")+"</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div>',html+="<p>"+ZPI18N.getString("zp.newtdojdesc",new Array(' <input type="text" class="ztextbox w60" placeholder="" onblur="NewZPOnboarding.updatetdojdays(this)" name="portalValue" value="'+data.tdays+'"> '))+"</p>";var completionclass=data.tdays&&""!=data.tdays.trim()&&"0"!=data.tdays.trim()?"":"DN";html+='</div></div><div class="zpl_secn '+completionclass+'" id="completiontime"><div>',html+="<p>"+ZPI18N.getString("zp.obcompletiontime")+'<select data-width="150" id="tdojtime" name="tdojampm">';var timetxt=["12:00 AM","12:30 AM","01:00 AM","01:30 AM","02:00 AM","02:30 AM","03:00 AM","03:30 AM","04:00 AM","04:30 AM","05:00 AM","05:30 AM","06:00 AM","06:30 AM","07:00 AM","07:30 AM","08:00 AM","08:30 AM","09:00 AM","09:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","01:00 PM","01:30 PM","02:00 PM","02:30 PM","03:00 PM","03:30 PM","04:00 PM","04:30 PM","05:00 PM","05:30 PM","06:00 PM","06:30 PM","07:00 PM","07:30 PM","08:00 PM","08:30 PM","09:00 PM","09:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM"],timeval=["00:00 AM","00:30 AM","01:00 AM","01:30 AM","02:00 AM","02:30 AM","03:00 AM","03:30 AM","04:00 AM","04:30 AM","05:00 AM","05:30 AM","06:00 AM","06:30 AM","07:00 AM","07:30 AM","08:00 AM","08:30 AM","09:00 AM","09:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","13:00 PM","13:30 PM","14:00 PM","14:30 PM","15:00 PM","15:30 PM","16:00 PM","16:30 PM","17:00 PM","17:30 PM","18:00 PM","18:30 PM","19:00 PM","19:30 PM","20:00 PM","20:30 PM","21:00 PM","21:30 PM","22:00 PM","22:30 PM","23:00 PM","23:30 PM"];for(html+='<option value="">-'+ZPI18N.getString("zp.select")+"-</option>",i=0;i<timetxt.length;i++){var selclass=0==timeval[i].indexOf(data.comptime)?"selected":"";html+='<option value="'+timeval[i]+'" '+selclass+">"+timetxt[i]+"</option>"}html+="</select></p>",html+="</div></div></div></div>",html+='<div class="zpl_crd"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.newcandtoempconv")+"</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div><div><p>'+ZPI18N.getString("zp.newcandtoempconvdes")+"</p></div></div>",html+='<div class="zpl_secn"><div><div class="zpl_lnkbg" onclick="NewCPortal.getTemplateMappingdata()"><i class="PI_setting"></i>'+ZPI18N.getString("zp.onboardingmap")+"</div></div></div>",html+="</div></div>",html+='<div id="mailalert" class="ZPcontwrap dvflow_str tb DN"></div><div id="backSlider"></div>'}else"global"===mode?(html+='<div class="zpl_crd"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.onb.preferences")+"</h4><br><h4>"+ZPI18N.getString("zp.onb.subpreferences")+"</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div class="zpl_tgsprt">',toggleclass=data.enabledisablecandidateob?"onb_ztoggle_checked":"onb_ztoggle_unchecked",html+='<h5 class="zpl_tgl" id="enabledisablecandidateob"><input class="'+toggleclass+'" name="onbztogswitch"></input>'+ZPI18N.getString("zp.candidateonb")+"</h5><p>"+ZPI18N.getString("zp.disablecandidateflowdesc")+"</p>",html+="</div></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div class="zpl_tgsprt">',toggleclass=data.enabledisableemployeeob?"onb_ztoggle_checked":"onb_ztoggle_unchecked",html+='<h5 class="zpl_tgl" id="enabledisableemployeeob"><input class="'+toggleclass+'" name="onbztogswitch"></input>'+ZPI18N.getString("zp.essential.onb")+"</h5><p>"+ZPI18N.getString("zp.disableemployeeflowdesc")+"</p>",html+="</div></div></div>",html+="</div></div>",html+='<div id="mailalert" class="ZPcontwrap dvflow_str tb DN"></div><div id="backSlider"></div>'):(html+='<div class="zpl_crd"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.gtpreferences")+"</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div class="zpl_tgsprt">',toggleclass=data.onbWorkflow?"onb_ztoggle_checked":"onb_ztoggle_unchecked",html+='<h5 class="zpl_tgl" id="onbWorkflow"><input class="'+toggleclass+'" name="onbztogswitch"></input>'+ZPI18N.getString("zp.newtrigemponbauto")+"</h5><p>"+ZPI18N.getString("zp.newtrigemponbautodes")+"</p>",html+="</div></div>",html+='<div class="zpl_secn"><div class="zpl_tgsprt">',toggleclass=data.restrictEmpAccess?"onb_ztoggle_checked":"onb_ztoggle_unchecked",html+='<h5 class="zpl_tgl" id="restrictEmpAccess"><input class="'+toggleclass+'" name="onbztogswitch"></input>'+ZPI18N.getString("zp.restrictzpaccess")+"</h5><p>"+ZPI18N.getString("zp.newrestrictzpacessdes")+"</p>",html+="</div></div>",html+="</div></div></div></div>",html+='<div id="mailalert" class="ZPcontwrap dvflow_str tb DN"></div><div id="backSlider"></div>');pageid.html(html),"global"===mode&&ZpOfferAppointment.Config.initSettingsPage(data),ZPeopleComponents.select(settingsPage.container.find("select")),ZPeopleComponents.toggleswitch(settingsPage.container.find(".onb_ztoggle_unchecked"),{on:!1,change:NewZPOnboarding.changeSettingStatus}),ZPeopleComponents.toggleswitch(settingsPage.container.find(".onb_ztoggle_checked"),{on:!0,change:NewZPOnboarding.changeSettingStatus}),pageid.find("#tdojtime").on("zselectchange",NewZPOnboarding.updatetdojtime),$('[data-toggle="popover"]').popover()},error:function(err){NewZPOnboarding.failureCallBack(err)}})}},NewZPOnboarding.updatetdojdays=function(obj){var tdays,tdojdays=$(obj).val().trim(),iserror=!1;tdojdays==NewZPOnboarding.tdays||""==tdojdays&&void 0==NewZPOnboarding.tdays||(tdojdays?isNaN(tdojdays)||(0|tdojdays)!=tdojdays?(ZPeople.Message.warning(ZPI18N.getString("zp.enteravalidnumber")),iserror=!0):tdojdays>180?(ZPeople.Message.warning(ZPI18N.getString("zp.tdojgreater",[180])),iserror=!0):tdojdays<0?(ZPeople.Message.warning(ZPI18N.getString("zp.tdojless",[0])),iserror=!0):tdays=parseInt(tdojdays):tdays=void 0,iserror||(tdays?settingsPage.container.find("#completiontime").show():settingsPage.container.find("#completiontime").hide(),ZPeople.Request.send("/onboarding/settings/updateDOJInterval",{days:tdays},NewZPOnboarding.updatetdojdaysresponse)))},NewZPOnboarding.updatetdojdaysresponse=function(data,params){data.msg==zpconst.CommonMessages.SUCCESSMSG?(NewZPOnboarding.tdays=params.days,ZPeople.Message.success(ZPI18N.getString("zp.updatedsuccessfully"))):ZPeople.Message.warning(data.msg)},NewZPOnboarding.updatetdojtime=function(obj){$.ajax({type:"POST",async:!0,url:"/onboarding/settings/updateTOJDeadline",data:{invoke_time:ZPeopleComponents.select(settingsPage.container.find("#tdojtime")).getValue(),conreqcsr:csrfToken},success:function(data){"success"==data.msg&&ZPeople.Message.success(ZPI18N.getString("zp.updatedsuccessfully"))},error:function(err){NewZPOnboarding.failureCallBack(err)}})},NewZPOnboarding.changeSettingStatus=function(obj){let url;var params={},id=obj.detail.element.parent(".zpl_tgl").attr("id");switch(params.method=id,id){case"candreminder":url="/onboarding/settings/onboardingReminder",params.method="onbreminder",params.onboarding_type=NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE;break;case"empreminder":url="/onboarding/settings/onboardingReminder",params.method="empreminder",params.onboarding_type=NewZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE;break;case"onbWorkflow":url="/onboarding/settings/autoTrigger";break;case"restrictEmpAccess":url="/onboarding/settings/restrictAccess";break;case"emponbtemplate":url="/onboarding/settings/enableDisableEmpWelcomeMail";break;case"autoonboardingcomplete":url="/onboarding/settings/enableDisableMarkAsCompleted";break;case"enabledisablecandidateob":url="/onboarding/settings/candidate/enableDisable";break;case"enabledisableemployeeob":url="/onboarding/settings/employee/enableDisable"}params.IS_VISIBLE=obj.detail.state,ZPeople.Request.send(url,params,NewZPOnboarding.changeSettingStatusResponse)},NewZPOnboarding.changeSettingStatusResponse=function(data,params){let message="";if("success"==data.msg){if("onbWorkflow"!==params.method&&"onbreminder"!==params.method&&"emponbtemplate"!==params.method&&"autoonboardingcomplete"!==params.method||(message=ZPI18N.getString("zp.updatedsuccessfully")),"onbWorkflow"==params.method)params.IS_VISIBLE?NewZPOnboarding.isOnboarding=!1:NewZPOnboarding.isOnboarding=!0;else if("onbreminder"==params.method&&data.templateid)NewZPOnboarding.candonbRemData={invoke_days:2,invoke_time:"09:00 AM",onboarding_type:params.onboarding_type,reminder_period:1,isrepeat:!1},$("#candreminder").append('<div class="MLauto"><button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="NewZPOnboarding.onboardinggetReminder(\''+candremid+"','"+data.candformid+"')\">Edit Template</button></div>");else if("enabledisablecandidateob"===params.method)if(params.IS_VISIBLE){message=ZPI18N.getString("zp.enabledcandidateonboardingmsg");const cflwObj={},subTabAry=[{tabURL:"settings/service/onboarding/candidateflow",dispName:ZPI18N.getString("zp.flow")},{tabURL:"settings/service/onboarding/candsettings",dispName:ZPI18N.getString("zp.gtpreferences")}];cflwObj.tabArr=subTabAry,cflwObj.tabURL="settings/service/onboarding/candidateflow",cflwObj.dispName=ZPI18N.getString("zp.preonboarding"),settingsPage.addLeftTabs(1,1,[cflwObj])}else message=ZPI18N.getString("zp.disabledcandidateonboardingmsg"),settingsPage.removeLeftTab(1,2);else if("enabledisableemployeeob"===params.method){const tabCnt=Layout.Page.pageContWrapper.find("[name=lefttab] .zpl_iwrprdrp[tlhash]").length;if(params.IS_VISIBLE){message=ZPI18N.getString("zp.enabledemployeeonboardingmsg");const eflwObj=[],subTabAry=[{tabURL:"settings/service/onboarding/employeeflow",dispName:ZPI18N.getString("zp.flow")},{tabURL:"settings/service/onboarding/empsettings",dispName:ZPI18N.getString("zp.gtpreferences")}];eflwObj.tabArr=subTabAry,eflwObj.tabURL="settings/service/onboarding/employeeflow",eflwObj.dispName=ZPI18N.getString("zp.postonboarding");const pos=0===tabCnt?0:2;settingsPage.addLeftTabs(1,pos,[eflwObj])}else{message=ZPI18N.getString("zp.disabledemployeeonboardingmsg");const pos=1===tabCnt?1:3;settingsPage.removeLeftTab(1,pos)}}""!==message&&ZPeople.Message.success(message)}else{const divId=params.method;let func,toggleObj="";switch(data.errorcode){case 1001:message=ZPI18N.getString("zp.candidateinprogresserrormsg"),func=(toggleObj=ZPeopleComponents.toggleswitch(settingsPage.container.find("#"+divId+" [name=onbztogswitch]"))).getAttribute("change");break;case 1101:message=ZPI18N.getString("zp.employeeinprogresserrormsg"),func=(toggleObj=ZPeopleComponents.toggleswitch(settingsPage.container.find("#"+divId+" [name=onbztogswitch]"))).getAttribute("change");break;case 1030:case 1030:message=ZPI18N.getString("zp.allonboardingdisablederrormsg"),func=(toggleObj=ZPeopleComponents.toggleswitch(settingsPage.container.find("#"+divId+" [name=onbztogswitch]"))).getAttribute("change")}""!==message&&ZPeople.Message.failure(message),void 0!==func&&""!==func&&(toggleObj.setAttribute("change",""),toggleObj.switchOn(),toggleObj.setAttribute("change",func))}},NewZPOnboarding.failureCallBack=function(err){if(settingsPage.container.find("#zp_page_loading").remove(),err.responseText&&err.responseText.includes('id="IAM_SECURITY_ERROR"'))settingsPage.container.html(err.responseText);else if("object"==typeof err){var eMsg=err.hasOwnProperty("responseJSON")&&err.responseJSON.hasOwnProperty("error")?err.responseJSON.error:ZPI18N.getString("zpp.somethingwentwrong");ZPeople.Message.warning(eMsg)}else ZPeople.Message.warning(ZPI18N.getString("zp.sorryservererror"))},NewZPOnboarding.config.tagChecklist=function(data){var tab=new Tab;tab.id="obtagchecklist",tab.cardId="bodyTag";var tabModal=new sliderModal(ZPI18N.getString("zp.tagachecklist"),tab);tabModal.construct(),$(tabModal).find(".modal-header").find(".close").removeClass("PI_cls red"),$(tabModal).find(".modal-header").find(".close").addClass("PI_cls FR"),$(tabModal).find(".modal-header").find(".close").removeAttr("buttonaction"),$(tabModal).find(".modal-header").find(".close").attr("onclick","NewZPOnboarding.config.submitmappedChecklist()"),$(tabModal).find(".modal-body").html(ZPeople.LOADING_HTML),$(tabModal).find(".modal-footer").find(".btn-default").addClass("DN"),$(tabModal).find(".btn-primary").html(ZPI18N.getString("zp.close")),$(tabModal).find(".btn-primary").attr("onclick","NewZPOnboarding.config.submitmappedChecklist()");var formid=NewZPOnboarding.EmployeeForm.id;NewZPOnboarding.currentOB.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(formid=NewZPOnboarding.CandidateForm.id),params={formId:formid,method:"list"},ZPeople.Request.send("/getChecklistConfList.zp",params,NewZPOnboarding.config.viewAllChecklist)},NewZPOnboarding.config.viewAllChecklist=function(data){if(NewZPOnboarding.AllChecklist=data,$("#obtagchecklist").find("#zp_page_loading").remove(),void 0!=data){$("#obtagchecklist").find("[type=search]").off("keyup"),$("#obtagchecklist").find("[type=search]").on("keyup",function(){var parent=$(this).closest(".modal-content"),data=this.value.split(" "),allDataObj=parent.find(".obTagList").find('[name="checklist"]');allDataObj.hide(),$.each(data,function(i,v){allDataObj=allDataObj.find(".tagName").filter("*:Contains('"+v+"')")}),allDataObj.closest('[name="checklist"]').show()});NewZPOnboarding.EmployeeForm.id;NewZPOnboarding.currentOB.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&NewZPOnboarding.CandidateForm.id;var html='<div class="zpl_crd wd100_per"><div class="zpl_crdcnt"><div class="zpl_secn"><div id="onbchecklist" data-toggle-button-position="right">';if(0!=Object.keys(data).length)$.each(data,function(ind,checklist){var sel="";checklist.taskCount,settingsPage.container.find("#checklistbody").find("#"+checklist.checklistId).length>0&&(sel="checked"),html+='<div class="zpl_collapsepanel" name="checklist" id="'+checklist.checklistId+'"><div class="zpl_collapseheader"><div class="zcheckbox"><input id="'+checklist.checklistId+'_chkbox" type="checkbox" name="check" class="zcheckbox__helper" '+sel+'><label id="onbclname" for="'+checklist.checklistId+'_chkbox" class="zcheckbox__label">'+checklist.label+'</label></div><div class="MLauto"><span id="onbclcount"">'+ZPI18N.getString("zp.associatedtasks")+"  <em>"+checklist.taskCount+'</em></span></div></div><div class="zpl_collapsecontent"><table class="zpl_tblbdr zpl_tblcrsor zpl_whtbg"><tbody></tbody></table></div></div>'});else{html='<div class="zpl_crd zpl_nodata"><div class="zpl_crdcnt"><div class="zpl_Emptydata"><div><div class="zpl_emptimg zp_nd_template"></div><h4>'+ZPI18N.getString("zp.onb.checklist.norec")+'</h4><p></p><font><button class="zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.addChecklist();">'+ZPI18N.getString("zp.checklist.add")+"</button></font></div></div></div></div>";$("#obtagchecklist").find(".modal-header").find(".dvPopsearch").addClass("DNI")}html+="</div></div></div></div>",$("#obtagchecklist").find("#bodyTag").html(html),ZPeopleComponents.collapsiblepanels($("#obtagchecklist").find("#onbchecklist"),{isActive:!1,beforepanelexpand:"NewZPOnboarding.config.checklistEventCallback"}),$("#obtagchecklist").find("#sliderSbt").on("click",function(){NewZPOnboarding.config.submitmappedChecklist()})}},NewZPOnboarding.config.checklistEventCallback=function(event){let checklistId=event.currentTarget.parentNode.parentNode.getAttribute("id");NewZPOnboarding.config.getMappedTasks("","",checklistId)},NewZPOnboarding.config.getMappedTasks=function(data,params,chId){var id=void 0!==chId?chId:params.checklistId,chData=settingsPage.container.find("#obtagchecklist #"+id).data("chData"),formid=NewZPOnboarding.EmployeeForm.id;if(NewZPOnboarding.currentOB.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(formid=NewZPOnboarding.CandidateForm.id),void 0!==chId&&void 0===chData){params={checklistId:chId,method:"getChecklistMappedTasks"};ZPeople.Request.send("/getChecklistMappedTasks.zp",params,NewZPOnboarding.config.getMappedTasks)}else{void 0===chData?settingsPage.container.find("#obtagchecklist #"+params.checklistId).data("chData",data):data=chData;var html="";void 0!=data.tasks&&$.each(data.tasks,function(index,task){html+='<tr><td  id="t_'+task.taskconfigid+'" onclick="ZPA_Task.edit(\''+task.taskconfigid+"', '"+formid+'\')" style="padding: 15px 25px;">'+task.taskConfigName+"</td></tr>"}),$("#obtagchecklist").find("#onbchecklist").find("#"+params.checklistId).find("tbody").html(html)}},NewZPOnboarding.config.submitmappedChecklist=function(){var data={checklist:[]};$.each($("#obtagchecklist").find("#onbchecklist").find("input[type='checkbox']:checked"),function(index,elm){elm=$(elm).closest("[name=checklist]");var id=$(elm).attr("id");data.checklist.push({tempId:id,tempName:$(elm).find("#onbclname").text(),count:$(elm).find("#onbclcount").find("em").text()}),0!==index?","+id:""+id}),$("#obtagchecklist #sliderCancel").trigger("click"),NewZPOnboarding.config.getChecklist(data)},NewZPOnboarding.config.checklistAddCallBack=function(resultData){void 0!==resultData&&void 0!==resultData.checklistId&&ZPA_Checklist.edit(resultData.checklistId)},NewZPOnboarding.config.taskListener=function(data){const tskRow=document.getElementById("t_"+data.taskconfigid);void 0!==data&&void 0!==data.taskconfigid&&void 0!==data.taskConfigName&&null!==tskRow&&(tskRow.innerText=ZPeople.decodeTxt(data.taskConfigName))},NewZPOnboarding.config.getChecklist=function(data){var checklist=data.checklist,html="",formid=NewZPOnboarding.EmployeeForm.id;NewZPOnboarding.currentOB.onboarding_type===NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE&&(formid=NewZPOnboarding.CandidateForm.id),void 0!=checklist&&0!=Object.keys(checklist).length?($.each(checklist,function(ind,jsonData){html+='<tr  id="'+jsonData.tempId+'" name="chkRow" formId="'+formid+'"><td>'+ZSEC.Encoder.encodeForHTML(jsonData.tempName)+"</td><td>"+jsonData.count+'</td><td><div class="zpl_hvr"><i class="PI_edt" ></i><i class="PI_delete"  onclick="NewZPOnboarding.deleteChecklist(\''+jsonData.tempId+"')\"></i></div></td></tr>"}),settingsPage.container.find("#checklistReport").removeClass("DNI"),settingsPage.container.find("#checklistDiv").find("#topSettMenu").removeClass("DNI"),settingsPage.container.find("#checklistDiv").find(".zpl_nodata").addClass("DNI")):(settingsPage.container.find("#checklistReport").addClass("DNI"),settingsPage.container.find("#checklistDiv").find("#topSettMenu").addClass("DNI"),settingsPage.container.find("#checklistDiv").find(".zpl_nodata").removeClass("DNI")),settingsPage.container.find("#checklistReport").find("#checklistbody").html(html),Checklist.setFunction()},NewZPOnboarding.searchPopupLMS=function(data){void 0==data?ZPeople.Request.send("/courseAction.zp",{method:"getCourseDetails",start:"0",courseFor:"onBoarding",coursetype:"1"},NewZPOnboarding.searchPopupLMS):NewZPOnboarding.constructsearchPopupLMS(data,!1),settingsPage.container.find("#onblmssearchbtn").prop("disabled",!0)},NewZPOnboarding.constructsearchPopupLMS=function(data,isfromsearch){if(!isfromsearch){NewZPOnboarding.selectedlmsdetails={};var html='<div class="zpl_mdl zpl_mcenter obpatch zpl_mopen" id="onblmssearch" data-modal-box="addcourse"><div class="zpl_minr">';html+='<div class="zpl_mhder"><div><h4>'+ZPI18N.getString("zp.tagcourse")+'</h4></div><a class="_cls PI_cls" onclick="NewZPOnboarding.closePopupLMS()"></a></div>',html+='<div class="zpl_mcnt zpl_fm"><form><div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div><div id="" class="zp_Sm"><div><i class="PI_lens"></i><input required="" id="onblmssearchtext" placeholder="'+ZPI18N.getString("zp.lms.learningplan.searchcoursename")+'" type="text" value=""></div></div></div></div>',html+=' <div class="zpl_secn"><div><ul class="zp_CPlst" id="onblmslist">',html+="</ul></div></div></div></div></form></div>",html+='<div class="zpl_mfoter"><button type="button" class="zlabel zlabel--blue zlabel--medium" onclick="NewZPOnboarding.addLMSCourse()">'+ZPI18N.getString("zp.tag")+"</button></div></div></div>";var pageid=settingsPage.container.closest(".main-wrp");pageid.append(html),pageid.find("#onblmssearchtext").off("keyup"),pageid.find("#onblmssearchtext").on("keyup",function(){$("#onblmssearch");var searchtxt=this.value,params={method:"getCourseDetails",start:"0",courseFor:"onBoarding",coursetype:"1"};searchtxt&&(params.searchtxt=searchtxt),ZPeople.Request.send("/courseAction.zp",params,NewZPOnboarding.searchCourse)})}$("#onblmslist").html(""),$.each(data[1],function(index,lmsinfo){var courseList="",sel="",src="",grn="";lmsinfo.courseImageInfo.isSystemImage?src=NewZPOnboarding.generateRandomCourseImage(lmsinfo.courseImageInfo):(lmsinfo.courseImageInfo.additionalInfo={fileId:lmsinfo.courseId,type:6},src=NewZPOnboarding.generateSourceURL(lmsinfo.courseImageInfo)),(settingsPage.container.find("#onblmscourses").find("#"+lmsinfo.courseId).length>0||NewZPOnboarding.selectedlmsdetails.hasOwnProperty(lmsinfo.courseId))&&(sel="sel",grn="grn"),courseList+='<li id="'+lmsinfo.courseId+'" onclick='+onclick+' class="onblmsname"><div class="ZP_photo"><img src="'+src+'"></div><h4 >'+lmsinfo.courseName+'</h4><div class="zp_micn"><ul><li class="'+sel+'"><b><span><i class="PI_tick2 '+grn+'"></i></span></b></li></ul></div></li>',$("#onblmslist").append(courseList),0==settingsPage.container.find("#onblmscourses").find("#"+lmsinfo.courseId).length&&$("#onblmslist").find("#"+lmsinfo.courseId).on("click",function(event){0==$("#onblmssearch").find("#"+lmsinfo.courseId).find("ul").find(".sel").length?($("#onblmssearch").find("#"+lmsinfo.courseId).find("li").addClass("sel"),$("#onblmssearch").find("#"+lmsinfo.courseId).find("li .PI_tick2").addClass("grn"),NewZPOnboarding.selectedlmsdetails[lmsinfo.courseId]=lmsinfo):($("#onblmssearch").find("#"+lmsinfo.courseId).find("li").removeClass("sel"),$("#onblmssearch").find("#"+lmsinfo.courseId).find("li .PI_tick2").removeClass("grn"),delete NewZPOnboarding.selectedlmsdetails[lmsinfo.courseId])})}),0==$("#onblmslist").find(".onblmsname").length&&(isfromsearch?$("#onblmslist").html(ZPI18N.getString("zp.lms.nodatafound")):$("#onblmslist").html(ZPI18N.getString("zp.nocourseaddnew",["window.open('zp#lms/mydata/courses','_blank')"])))},NewZPOnboarding.searchCourse=function(data){NewZPOnboarding.constructsearchPopupLMS(data,!0)},NewZPOnboarding.addLMSCourse=function(){$.each(NewZPOnboarding.selectedlmsdetails,function(index,lmsinfo){if(0==settingsPage.container.find("#onblmscourses").find("#"+lmsinfo.courseId).length){settingsPage.container.find("#noCoursePage").addClass("zpl_DNI");void 0==lmsinfo.courseImage?Math.floor(Math.random()*Math.floor(44))+1:lmsinfo.courseImage;var bgclass="zp_Crh";lmsinfo.isSystem||(bgclass="zp_Crh CBg"+lmsinfo.bannerBGData.clrId);lmsinfo.courseId;var courseImageUrl=lmsinfo.isSystem?NewZPOnboarding.generateSourceURL(lmsinfo.courseImageInfo):NewZPOnboarding.generateRandomCourseImage(lmsinfo.courseImageInfo),selectedcourseshtml='<div id="'+lmsinfo.courseId+'" class="zp_Cr crdlv"><div class="zpl_crsimg '+bgclass+'" ><img src="'+courseImageUrl+'" alt=""></div>';selectedcourseshtml+="<div><h4>"+lmsinfo.courseName+"</h4><ul><li><p>Self Paced Learning</p></li></ul></div>",selectedcourseshtml+='<div class="zpl_mndcrs" ><div class="zcheckbox"><input type="checkbox" name="check" value="" ismandatory="false" class="zcheckbox__helper" onclick="NewZPOnboarding.changeLMSstatus(this)" id="lmsond'+lmsinfo.courseId+'"><label class="zcheckbox__label" for="lmsond'+lmsinfo.courseId+'"></label></div><p>'+ZPI18N.getString("zp.mandatorycourse")+"</p></div>",selectedcourseshtml+='<font class="zpl_lmicn"><i class="PI_cls" onclick="NewZPOnboarding.removeLMSCourse(this)"></i></font>',selectedcourseshtml+="</div>",settingsPage.container.find("#onblmscourses").append(selectedcourseshtml),settingsPage.container.find("#onblmscourses").find("#"+lmsinfo.courseId).attr("data",JSON.stringify(lmsinfo))}}),$("#onblmssearch").remove(),settingsPage.container.find("#onblmssearchbtn").prop("disabled",!1)},NewZPOnboarding.LMS_Course=function(json){var selectedcourseshtml='<div class="zo_Httl"><h2>'+ZSEC.Encoder.encodeForHTML(NewZPOnboarding.tabsJson.LMS_Course.tabCols.DISPLAY_NAME)+'</h2><i class="PI_hrcomuni_manag zo_ttlIco"><i class="path1"></i><i class="path2"></i></i></div><div class="zo_tCont chseCrd PL40">';$.each(json,function(index,course){var lmsinfo=JSON.parse(settingsPage.container.find("#onblmscourses").find("#"+course.courseid).attr("data")),onclick='window.open("training#lms-view/course/'+lmsinfo.courseId+'/overview","_blank")';void 0==lmsinfo.courseImage?Math.floor(Math.random()*Math.floor(44)):lmsinfo.courseImage;var bgclass="zp_Crh";lmsinfo.isSystem||(bgclass="zp_Crh CBg"+lmsinfo.bannerBGData.clrId);var coursecompleted='<font class="zp_ftr"><i class="PI_pending"></i><p>'+ZPI18N.getString("zp.pending")+"</p></font>";lmsinfo.userCoursecompletedate&&(coursecompleted='<font class="zp_ftr cmpled"><i class="IC-tick2"></i><p>'+ZPI18N.getString("zp.completed")+"</p></font>"),lmsinfo.isSystem&&(lmsinfo.courseImageInfo.additionalInfo={fileId:lmsinfo.courseId,type:6});var courseImageUrl=lmsinfo.isSystem?NewZPOnboarding.generateSourceURL(lmsinfo.courseImageInfo):NewZPOnboarding.generateRandomCourseImage(lmsinfo.courseImageInfo);selectedcourseshtml+='<div class="zp_Cr crdlv" id="'+lmsinfo.courseId+'" onclick='+onclick+'> <div style="background: url('+courseImageUrl+') right/cover" class="'+bgclass+'"></div>',selectedcourseshtml+='<div class="zp_Crf">'+coursecompleted+"</div>",selectedcourseshtml+='<div class="zp_Crc"></i><label><em class="zp_ldot">'+ZPI18N.getString("zp.lms.settings.SelfPaced")+'</em></label><h4><i class=""></i>'+lmsinfo.courseName+"</h4>",void 0!=lmsinfo.description&&(selectedcourseshtml+='<p title="'+lmsinfo.description+'">'+lmsinfo.description+"</p>"),selectedcourseshtml+="</div></div>"}),selectedcourseshtml+="</div>",settingsPage.container.find("#onBoardingRightPane").find('[data-click="LMS_Course"]').html(selectedcourseshtml)},NewZPOnboarding.closePopupLMS=function(value){value&&NewZPOnboarding.addLMSCourse(value),$("#onblmssearch").remove(),settingsPage.container.find("#onblmssearchbtn").prop("disabled",!1)},NewZPOnboarding.decodeTxt=function(txt){var tempdiv=$("<div></div>");return(tempdiv=$(tempdiv)).html(txt),txt=tempdiv.text()},NewZPOnboarding.editMailAklertTemplate=function(templateId,formid,isCandidate){NewZPOnboarding.iscandidateemail=isCandidate,ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())]=[],ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())].push({formId:formid,compName:"Employee",dispName:"Employee",tableName:"P_Employee"}),isCandidate&&ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())].push({formId:formid,compName:"Candidate",dispName:"Candidate",tableName:"P_Candidate"}),ZPA_MailAlert.edit(templateId,formid);var pageDiv=$("#mail_slider");pageDiv.find("#mailalert_formList").closest(".zpl_secn").addClass("DN"),pageDiv.find("#mail_name").addClass("disabled"),pageDiv.find("#from_address").parent(".zpl_idiv").find(".zpl_cc").remove(),pageDiv.find("#to_grp").addClass("disabled"),pageDiv.find("#chooseTemplate").addClass("disabled"),pageDiv.find(".zpl_upld").closest(".zpl_secn").addClass("DN")},NewZPOnboarding.onboardinggetReminder=function(templateId,formid){var onbremdata=NewZPOnboarding.candonbRemData;ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())]=[],ZPA_Common[ZPA_Common.getFormListMode(ZP_Automation_Mode.EMAILALERT,ZPA_Common.getServiceName())].push({formId:formid,compName:"Candidate",dispName:"Candidate",tableName:"P_Candidate"}),ZPA_MailAlert.edit(templateId,formid),(pageDiv=$("#mail_slider")).find("#ma_basic").find(".zpl_crdcnt").addClass("DN"),pageDiv.find("#mail_name").addClass("disabled"),pageDiv.find("#from_address").parent(".zpl_idiv").find(".zpl_cc").remove(),pageDiv.find("#to_grp").addClass("disabled"),pageDiv.find("#chooseTemplate").addClass("disabled"),pageDiv.find(".zpl_upld").closest(".zpl_secn").addClass("DN");for(var html='<div class="zpl_crd" id="onbreminder"><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.sndonbrem")+'<i class="PI_info" data-title-position="right" title="'+ZPI18N.getString("zp.onb.reminder.info")+'"></i></label></div><div><input type="text" id="onbinvokedays" placeholder="'+ZPI18N.getString("zp.onb.reminder.placeholder")+'" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.workflow.timeofexe")+'</label></div><div><select id="onbinvoketime">',j=0,i=0;i<48;i++){var hh=j<10?"0"+j:""+j;24==i&&(j=0),0==hh&&(hh="12");var time=hh+":"+(i%2==0?"00":"30")+" "+(i<24?"AM":"PM");html+='<option value="'+time+'">'+time+"</option>",j+=i%2}var pageDiv,isrepeat="0",hiderepeatdiv="DN";NewZPOnboarding.candonbRemData.isrepeat&&(isrepeat="1",hiderepeatdiv=""),html+='</select> </div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.frequency")+'</label></div><div><select id="onbfrequency" onchange="NewZPOnboarding.changeRepeatDiv()"><option value="0">'+ZPI18N.getString("zp.schonce")+'</option><option value="1">'+ZPI18N.getString("zp.repeat")+'</option></select></div></div><div class="zpl_secn '+hiderepeatdiv+'" id="remonbrepeat"><div><label class="zpl_mtry">Repeat every(days until onboarding is completed)</label></div><div><input type="text" id="onbrepeatdays" placeholder="" class="ztextbox"></div></div></div>',$("#mail_slider").find("#sliHdrDiv").find("h4").text(ZPI18N.getString("zp.edit")+" "+ZPI18N.getString("zp.newcandonbreminder")),(pageDiv=$("#mail_slider").find("#mail_cards")).prepend(html),pageDiv=pageDiv.find("#onbreminder"),ZPeopleComponents.select(pageDiv.find("select")),pageDiv.find("#onbrepeatdays").val(onbremdata.reminder_period),ZPeopleComponents.select(pageDiv.find("#onbinvoketime")).setValue(onbremdata.invoke_time),pageDiv.find("#onbinvokedays").val(onbremdata.invoke_days),ZPeopleComponents.select(pageDiv.find("#onbfrequency")).setValue(isrepeat),pageDiv.find("#onbfrequency").on("zselectchange",NewZPOnboarding.changeRepeatDiv),$("#mail_slider").find("#sliderSbt").off().on("click",function(event){NewZPOnboarding.onboardingReminderSave()}),$("#mail_slider").find("#sliderCancel,#sliderCls").off().on("click",function(event){ZPeopleComponents.select(pageDiv.find("#onbfrequency")).destroy(),ZPeopleComponents.select(pageDiv.find("#onbinvoketime")).destroy(),ZPA_MailAlert.Slider.remove()})},NewZPOnboarding.changeRepeatDiv=function(){var pageDiv=$("#mail_slider").find("#mail_cards").find("#onbreminder");"1"==ZPeopleComponents.select(pageDiv.find("#onbfrequency")).getValue()?pageDiv.find("#remonbrepeat").removeClass("DN"):pageDiv.find("#remonbrepeat").addClass("DN")},NewZPOnboarding.onboardingReminderSave=function(){var pageDiv=$("#mail_slider").find("#mail_cards").find("#onbreminder");NewZPOnboarding.removeErrorSpan(pageDiv);var invokeday=pageDiv.find("#onbinvokedays").val(),iserror=!1;invokeday&&!isNaN(invokeday)&&(0|invokeday)==invokeday||(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.enteravalidnumber"),pageDiv.find("#onboardingRemDays")),iserror=!0);var repeatperiod,invoketime=ZPeopleComponents.select(pageDiv.find("#onbinvoketime")).getValue(),isrepeat=1==ZPeopleComponents.select(pageDiv.find("#onbfrequency")).getValue();if(isrepeat&&((repeatperiod=pageDiv.find("#onbrepeatdays").val())&&!isNaN(repeatperiod)&&(0|repeatperiod)==repeatperiod||(NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.enteravalidnumber"),pageDiv.find("#remonbrepeat")),iserror=!0)),!iserror){var params={invoke_time:invoketime,invoke_days:invokeday,onboarding_type:NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE,reminder_period:repeatperiod,isrepeat:isrepeat};ZPeople.Request.send("/onboarding/settings/saveReminder",params,NewZPOnboarding.onbReminderSaveResponse),ZPA_MailAlert.Slider.save(),ZPeopleComponents.select(pageDiv.find("#onbfrequency")).destroy(),ZPeopleComponents.select(pageDiv.find("#onbinvoketime")).destroy()}},NewZPOnboarding.onbReminderSaveResponse=function(data,params){"success"==data.msg&&(NewZPOnboarding.candonbRemData=params)},NewZPOnboarding.usersPageBulkTriggerOnboarding=function(isOrgEmpPage){var allerecno=[],pageid=settingsPage.container;isOrgEmpPage?$.each($(pageid).find("#viewsContainer #recordContainer").find("input[name='check']:checked"),function(index,elm){allerecno[index]=$(elm).closest("tr").attr("id")}):$.each($(pageid).find("#userListTable tbody").find("input[name='userRowCheck']:checked"),function(index,elm){allerecno[index]=$(elm).closest("tr").attr("emperecno")}),allerecno=JSON.stringify(allerecno),$.ajax({type:"POST",async:!1,url:"/onboarding/reports/bulkTrigger",data:{erecnoobj:allerecno,conreqcsr:csrfToken},success:function(data){if(data.Success)ZPeople.Message.success(ZPI18N.getString("zp.onboardingtriggeredsuccess"));else if(data.hasOwnProperty("onbtriggeredalready")||data.hasOwnProperty("invaliduser")||data.hasOwnProperty("onbdoesntexist")||data.hasOwnProperty("adminusers")){var html='<div class="obflow">';$.each(data,function(index1,msgobj){"Success"!=index1&&(html+='<p class="pspace">',"onbtriggeredalready"==index1?html+=ZPI18N.getString("zp.onbalreadytriggered"):"invaliduser"==index1?html+=ZPI18N.getString("zp.notvailduser"):"onbdoesntexist"==index1?html+=ZPI18N.getString("zp.nomatchonbflow"):"adminusers"==index1&&(html+=ZPI18N.getString("zp.noonbforadmin")),html+="</p>",html+='<div class="pspace">',$.each(msgobj,function(index2,emailid){html+="<span>",html+="invaliduser"==index1?isOrgEmpPage?ZPeople.getUserDetailsById(emailid).email:$("#userListTable").find("[emperecno="+emailid+"]").find(".zpl_emdts").find("b").text():emailid,html+="</span>"}),html+="</div>")}),FrameworkCommon.showInfoAlert(ZPI18N.getString("zp.onbnottriggeredreasons"),html)}else void 0!=data.msg?ZPeople.Message.failure(data.msg):ZPeople.Message.warning(ZPI18N.getString("zp.sorryservererror"));isOrgEmpPage?(pageid.find("#viewActionsContainer").find("#recordActionsContainer").removeClass("opn"),pageid.find("#viewsContainer").find("[id=recordActions]").each((index,value)=>{$(value).find("input").removeAttr("checked")})):($(pageid).find("#userListTable tbody").find("input[name='userRowCheck']").prop("checked",!1),pageid.find(".actn_ovrly").removeClass("opn"),pageid.find(".zpl_rgt").show(),pageid.find("div#resendInvite,button#triggerOnboardingButton").addClass("DN"),pageid.find("div#dispUserCntTitle,div#licenseDtlsRow").removeClass("DN"))}})},NewZPOnboarding.addUserPage=function(){$.ajax({type:"POST",async:!1,url:"/users/getAddUserPage",data:{mode:"user",needAllDtls:!0,conreqcsr:csrfToken},success:function(data){UserSettings.checkAddUserDirectlyAllowed(data),UserSettings.user.add.licenseCountLeft=data.licenseCountLeft,UserSettings.user.add.employeesAdded=data.employeesAdded,UserSettings.user.add.handleMenu()}})},NewZPOnboarding.reopenOnboarding=function(pkid){NewCPortal.currentPortalZAIDj?NewZPOnboarding.reopenPopup(pkid):$.ajax({type:"POST",async:!1,url:NewCPortal.candidateURLS.CPORTALURL,data:{conreqcsr:csrfToken},success:function(data){0!=Object.keys(data).length&&void 0!=data.portalName&&(NewCPortal.currentPortalZAID=data.ZAID,NewCPortal.portalObj=data,NewZPOnboarding.reopenPopup(pkid))},error:function(err){NewZPOnboarding.failureCallBack(err)}})},NewZPOnboarding.reopenPopup=function(pkid){$("#reopenModal").remove();var tab=new Tab;tab.id="reopenModal",tab.cardId="onbreopendiv",new sliderModal("",tab).construct(),$("#reopenModal").addClass("zpl_mcenter zpl_mmd"),$("#reopenModal").attr("candidateid",pkid);NewZPOnboarding.allReport[pkid].completeDetails;var toUser=NewZPOnboarding.allReport[pkid].reportDetails,reopenhtml='<form><div class="zpl_crd" id="reopenEditorContainer"><div class="zpl_crdcnt"><div class="zpl_secn zpl_mailtmp"><div keyname="to"><label>'+ZPI18N.getString("zp.to")+'</label></div><div id="toUser" class="disabled"><z-tokenfield id="toid"></z-tokenfield></div></div><div class="zpl_secn zpl_mailtmp"><div keyname="cc"><label>'+ZPI18N.getString("zp.cc")+'</label></div><div id="ccuser"><z-tokenfield id="ccuserinp"></z-tokenfield></div></div><div class="zpl_secn zpl_mailtmp"><div keyname="subject"><label class="zpl_mtry">'+ZPI18N.getString("zp.subject")+'</label></div><div><input required="" type="text" value="'+ZPI18N.getString("zp.reopendefaultsubject",[ZPeople.ORGLIST.currServiceOrg])+'" class="ztextbox"></div></div><div class="zpl_secn"><div keyname="message"><label>'+ZPI18N.getString("zp.message")+'</label></div><div id="descEditor"></div></div>';reopenhtml+='<div><div class="zpl_upld"><div class="zpl_fldrp"><h5><img src="../../images/nodata/fileupload.png" alt="">Upload from <a class="zpl_lnk" id="localUpload" onclick="ZPA_FileUpload.LocalUpload.loadLocalFile()"><i class="PI_case"></i>Desktop</a> / <a class="zpl_lnk" id="cloudupload" onclick=ZPA_FileUpload.CloudUpload.init("reopenModal")><i class="PI_cloud"></i>Cloud</a></h5></div><p><span>Supported File Format: CSV, DOC, PDF, XLS, XLSX, ZIP.</span></p></div></div>',reopenhtml+='<div class="zpl_secn"><div id="attachedFiles" style="display:none;"><h5>Attachement Files</h5></div><div><div class="zpl_atchd" id="fluplDiv"></div></div></div>',$("#reopenModal").find("#onbreopendiv").html(reopenhtml),NewZPOnboarding.editorConstruct("descEditor",!0,"descContent",!0),NewZPOnboarding.replaceWithEditor("reopenEditorContainer","descEditor",!0),$("#reopenModal").find("#onbreopendiv").find("#descEditor").children("label").remove();var portalurl=NewCPortal.portalObj.redirecturl?NewCPortal.portalObj.redirecturl+"/":window.location.href.split(portalname)[0];portalurl+=NewCPortal.portalObj.portalName+NewZPOnboarding.CONSTANTS.CPORTAL_CONTEXT+"/preonboarding";var mailcontent="<div>Dear "+toUser.USERNAME+"<br></div>";mailcontent+='<div><br></div><div>You have missed entering some important details in the onboarding process.<br></div><div>Click <a target="_blank" href="'+portalurl+'">here</a>&nbsp;to re-access and complete your onboarding.<br></div>',ZPFeeds.Editor.editorList.descEditor.setContent(mailcontent);var empproperties=[];ZPeople.ALL_USER_LOADED?ZPeople.ALL_USERLIST:ZPeople.sendUserListAjax(null,null,!0),$.each(ZPeople.ALL_USERLIST,function(userInd,user){var empprop={id:user.usererec,value:ZPeople.decodeTxt(user.name)};empproperties.push(empprop)}),ZPeopleComponents.tokenfield($("#reopenModal").find("#onbreopendiv").find("#ccuserinp"),{data:empproperties,dataMapping:{value:"id",text:"value",id:"id"}}),ZPeopleComponents.tokenfield($("#reopenModal").find("#onbreopendiv").find("#toid"),{data:[{id:ZPeople.decodeTxt(toUser.EMAILALIAS),value:ZPeople.decodeTxt(toUser.USERNAME)}],dataMapping:{value:"id",text:"value",id:"id"},values:[{id:ZPeople.decodeTxt(toUser.EMAILALIAS),value:ZPeople.decodeTxt(toUser.USERNAME)}]}),$("#reopenModal").find("#sliderSbt").on("click",function(){NewZPOnboarding.sendreopen()})},NewZPOnboarding.editorConstruct=function(currentDiv,fileUpload,parentId,isneedHeader,isMandatory){$("#"+Layout.Page.pageId);var editorDiv="";isneedHeader&&(editorDiv=isMandatory?'<label class="zpl_mdt"><font>'+ZPI18N.getString("zp.description")+"</font></label>":"<label>"+ZPI18N.getString("zp.description")+"</label>"),editorDiv+='<div class="nobdr"><div>',editorDiv+='<div id="descEditor" class="zpl_pr"> </div> ',editorDiv+="</div></div>",$("[id="+currentDiv+"]").empty().append(editorDiv),$("[id="+currentDiv+"]").addClass("zpl_fm zpl_fmds")},NewZPOnboarding.replaceWithEditor=function(parentDiv,currentDiv,isMiniEditor){$("#"+Layout.Page.pageId).find("#"+currentDiv).empty();var initobject={currentContainer:$("[id="+parentDiv+"]"),editorheight:NewZPOnboarding.MAX_EDITOR_HEIGHT,isMiniEditor:isMiniEditor,isMentionsEnabled:!1};ZPFeeds.Editor.getEditor(currentDiv,"Onboarding",initobject)},NewZPOnboarding.sendreopen=function(obj){var reopendiv=$("#reopenModal").find("#onbreopendiv"),inp=$(reopendiv).find("[keyname]"),params={},iserror=!1;if(NewZPOnboarding.removeErrorSpan(),$.each(inp,function(){var keyname=$(this).attr("keyname"),val="";if($.inArray(keyname,["to","cc"])>-1){var allvalues=ZPeopleComponents.tokenfield($(this).closest(".zpl_secn").find("z-tokenfield")).getAllValues();$.each(allvalues,function(index,datavalue){val=0==index?datavalue.id:val+","+datavalue.id})}else val=$(this).closest(".zpl_secn").find("input").val();void 0==val&&(val=""),""==val.trim()&&$(this).find("label").hasClass("zpl_mtry")?(iserror=!0,NewZPOnboarding.errorSpanAttach("Please enter a value",$(this))):params[keyname]=val}),!iserror){var editor=ZPFeeds.Editor.editorList.descEditor;if(void 0!=editor&&(reopenDesc=ZPFeeds.getSmileysAndMentions(editor.getContent(),!1)),0==$(reopenDesc).text().length)iserror=!0,NewZPOnboarding.errorSpanAttach("Please enter a value",$(this));else{params.message=reopenDesc;var formdata=new FormData;if(formdata.append("candidateid",$("#reopenModal").attr("candidateid")),formdata.append("conreqcsr",csrfToken),formdata.append("mailjson",JSON.stringify(params)),reopendiv.find("[name='fileDiv']").length>0){var uploadFromCloud=[],attind=1,cloudUploadDoc=($(this).attr("filetype"),reopendiv.find("#cloudupload").data("cloudUploadDoc")),fileUpload=reopendiv.find("#localUpload").data("fileObj");cloudUploadDoc&&uploadFromCloud.push(cloudUploadDoc),fileUpload&&formdata.append("attachment"+attind++,fileUpload),formdata.append("uploadFromCloud",JSON.stringify(uploadFromCloud)),formdata.append("uploadFromWD",JSON.stringify([]))}$.ajax({url:"/onboarding/reports/reopen",type:"POST",data:formdata,contentType:!1,processData:!1,cache:!1,error:function(xhr){CommonTemplates.saveComplete("submitCaseBtn");var error_response=JSON.parse(xhr.responseText);ZPeople.Message.failure(error_response.error)},success:function(data){NewZPOnboarding.reopensuccess(data)}})}}},NewZPOnboarding.reopensuccess=function(data){data.msg==zpconst.CommonMessages.SUCCESSMSG?(ZPeople.Message.success(ZPI18N.getString("zp.updatedsuccessfully")),$("#reopenModal").find("#sliderCancel").click(),$("#userOnboardingDetails").find("#sliderCls").click(),NewZPOnboarding.reloadData()):void 0!=data.msg?ZPeople.Message.failure(data.msg):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},NewZPOnboarding.showSingleRecord=function(formId,recId,mode){var paramsObj={formId:formId,recordId:recId,disableUrlTrack:!0,formMode:mode,modalCloseCallback:NewZPOnboarding.reloadData,notifycallback:NewZPOnboarding.reloadData};ZP5Form.load(paramsObj)},NewZPOnboarding.updateCandidateFlowname=function(obj){if("candflowEdit"==$(obj).attr("name"))$(obj).closest(".zpl_mhder").find('[name="candflowValue"]').val($(obj).closest(".zpl_mhder").find('[name="candflowName"]').text()),$(obj).closest(".zpl_mhder").find('[name="candflowValue"]').show(),$(obj).closest(".zpl_mhder").find('[name="candflowValue"]').trigger("select"),$(obj).hide(),$(obj).closest(".zpl_mhder").find('[name="candflowName"]').hide();else if($(obj).hide(),$(obj).closest(".zpl_mhder").find('[name="candflowName"]').show(),$(obj).closest(".zpl_mhder").find('[name="candflowEdit"]').show(),0!=$(obj).val().trim().length&&$(obj).val()!=$(obj).siblings('[name="candflowName"]').text()){var params={ONBOARDINGID:NewZPOnboarding.currentOB.ONBOARDINGID,DISPLAY_NAME:$(obj).val(),applicableFor:"{}",onboarding_type:NewZPOnboarding.CONSTANTS.CANDIDATE_ONBOARDING_TYPE};ZPeople.Request.send("/onboarding/flow/save",params,NewZPOnboarding.saveSuccess,void 0,NewZPOnboarding.failureCallBack)}},NewZPOnboarding.notificationSettings=function(){var pageid=settingsPage.container,html=void 0;0==pageid.find(".zpl_rgtcnt").length&&(ZPA_FromAddress.fetchAllFromAddress(!0),pageid.html(ZPeople.LOADING_HTML),$.ajax({type:"POST",async:!1,url:"/onboarding/settings/getConfig",data:{conreqcsr:csrfToken},success:function(data){NewZPOnboarding.candonbRemData=data.candOnbReminder;var candremid=data.candOnbReminder?data.candOnbReminder.remid:void 0;html='<div class="zpl_rgtcnt">',html+='<div class="zpl_crd"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.custonbemptemp")+"</h4> <p>"+ZPI18N.getString("zp.newcustonbemptempdes")+"</p></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div class="zpl_tgsprt">',data.invtemplateId&&(html+='<div class="zpl_tgl" style="margin-left: 40px;">'+ZPI18N.getString("zp.newcandinvtemplate"),html+='<div class="MLauto"><button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="NewZPOnboarding.editMailAklertTemplate(\''+data.invtemplateId+"','"+data.candformid+"',true)\">"+ZPI18N.getString("zp.edittemp")+"</button></div>",html+="</div>");var toggleclass="onb_ztoggle_unchecked";data.isemptempvisible&&(toggleclass="onb_ztoggle_checked"),html+='<div class="zpl_tgl" id="emponbtemplate"><input class="'+toggleclass+'" name="onbztogswitch"></input>'+ZPI18N.getString("zp.newemponbtemplate")+'<div class="MLauto"><button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="NewZPOnboarding.editMailAklertTemplate(\''+data.emponbtemplateid+"','"+ZPeople.EMP_FORMID+"',false)\">"+ZPI18N.getString("zp.edittemp")+"</button></div></div></div></div></div></div>",toggleclass=data.candOnbReminder&&data.candOnbReminder.isvisible?"onb_ztoggle_checked":"onb_ztoggle_unchecked",html+='<div class="zpl_crd"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.onbreminder")+"</h4> <p>"+ZPI18N.getString("zp.onbremdes")+"</p></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div class="zpl_tgsprt">',html+='<div class="zpl_tgl" id="candreminder"><input class="'+toggleclass+'" name="onbztogswitch"></input>',html+=ZPI18N.getString("zp.newcandonbreminder"),candremid?html+='<div class="MLauto"><button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="NewZPOnboarding.onboardinggetReminder(\''+candremid+"','"+data.candformid+"')\">"+ZPI18N.getString("zp.edittemp")+"</button></div>":NewZPOnboarding.candformid=data.candformid,html+="</div></div></div></div></div>",html+="</div>",html+='<div id="mailalert" class="ZPcontwrap dvflow_str tb DN"></div><div id="backSlider"></div>',pageid.html(html),ZPeopleComponents.toggleswitch(settingsPage.container.find(".onb_ztoggle_unchecked"),{on:!1,change:NewZPOnboarding.changeSettingStatus}),ZPeopleComponents.toggleswitch(settingsPage.container.find(".onb_ztoggle_checked"),{on:!0,change:NewZPOnboarding.changeSettingStatus}),ApptLtr.MailNotification.list(pageid)},error:function(err){}}))},NewZPOnboarding.showMoreOption=function(pkId,status){event.stopPropagation();var pageId=ZPA_Common.getParentPageId(),menuId="obMenu_"+pkId;if(!ZPeopleComponents.isComponent("#"+menuId)){var menuHtml='<div id="'+menuId+'">\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li id="enable" pkId="'+pkId+'">'+ZPI18N.getString("zp.enableLogin")+'</li>\n\t\t\t\t\t\t\t\t\t\t<li id="disable" pkId="'+pkId+'">'+ZPI18N.getString("zp.disableLogin")+'</li>\n\t\t\t\t\t\t\t\t\t\t<li id="resendinv" pkId="'+pkId+'">'+ZPI18N.getString("zp.resendinv")+'</li>\n\t\t\t\t\t\t\t\t\t\t<li id="triggeronb" pkId="'+pkId+'">'+ZPI18N.getString("zp.triggeronboadring")+'</li>\n\t\t\t\t\t\t\t\t\t\t<li id="edit" pkId="'+pkId+'">'+ZPI18N.getString("zp.edit")+'</li>\n\t\t\t\t\t\t\t\t\t\t<li id="delete" pkId="'+pkId+'">'+ZPI18N.getString("zp.delete")+"</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>";pageId.append(menuHtml),ZPeopleComponents.menu("#"+menuId,{appendTo:pageId,displayType:"callout",itemclick:NewZPOnboarding.onMoreMenuSelect}),"1"==status?(ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#enable"]),ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#resendinv"]),ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#triggeronb"])):"2"==status?(ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#enable"]),ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#disable"]),ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#triggeronb"])):"0"==status?(ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#disable"]),ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#resendinv"]),ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#triggeronb"])):void 0===status&&(ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#enable"]),ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#disable"]),ZPeopleComponents.menu("#"+menuId).hideMenuItems(["#resendinv"]))}ZPeopleComponents.menu("#"+menuId).show({forElement:pageId.find("#obMore_"+pkId)})},NewZPOnboarding.onMoreMenuSelect=function(event,detail){event.stopPropagation();var menuAttr=detail.data.attrs,action=menuAttr.id,pkId=menuAttr.pkid;"enable"==action?NewCPortal.changeLoginStatus(pkId,1):"disable"==action?NewCPortal.changeLoginStatus(pkId,0):"resendinv"==action?NewCPortal.resendInvitation(pkId):"triggeronb"==action?NewCPortal.convertToCandidate(pkId):"delete"==action?NewCPortal.deleteCandPopUp(this,pkId):"edit"==action&&NewZPOnboarding.showSingleRecord(NewZPPreboarding.candidateFormId,pkId,"EDIT")},NewZPOnboarding.convertToCandidateFormView=function(){ZPeopleComponents.isComponent("#convertcandtoempdropdownmenu")?ZPeopleComponents.menu("#convertcandtoempdropdownmenu").show():(ZPeopleComponents.menu("#convertcandtoempdropdownmenu",{forElement:"#convertcandtoemp"}),NewCPortal.coverttoEmp(),ZPeopleComponents.menu("#convertcandtoempdropdownmenu").show())},NewZPOnboarding.emptyToDash=function(value){return void 0!==value&&""!==value.trim()||(value="-"),value},NewZPOnboarding.getFlowConfigurationHash=function(obType,flowId){return"settings/service/onboarding/"+(1==obType?"employeeflow":"candidateflow")+"/editflow-obId:"+flowId},NewZPOnboarding.isOnbNotifyPage=function(){return void 0!==Layout.Page.pageId&&Layout.Page.pageId.indexOf("-onboarding-notifications")>-1},NewZPOnboarding.replaceHRPartner=async function(oldHRPartner,newHRPartner){let result=await ZPeople.Request.sendRequestAsPromise("/onboarding/flow/replaceHRPartner",{conreqcsr:csrfToken,oldPartner:oldHRPartner,newPartner:newHRPartner},{}).then(([response,params,otherdata])=>response).catch(([error,params,otherdata])=>error.responseJSON);return result.hasOwnProperty("msg")&&"success"===result.msg},NewZPOnboarding.ContactHRPopup={show:function(){var delegateeErecNo="";"P_Employee"==ZP5Form.getCurrFormsOperation().tableName&&(delegateeErecNo=ZP5Form.getFormClassObj().getParams().recordId),NewZPOnboarding.ContactHRPopup.construct(delegateeErecNo);var popUpId=ZPA_Common.getPopUpId(NewZPOnboarding.ContactHRPopup.modal),hrSel_Prop={dataMapping:{value:"id",label:"value",image:"image"}};hrSel_Prop.placeholder=ZPI18N.getString("zp.selecthr"),hrSel_Prop.dataSource={search:param=>new Promise(function(search){search({delay:20,results:ZPA_Common.getDecodedEmpIdWithName(EmployeeSearch.getEmpList(param.query,"emp","DELEGATION_DELEGATOR",[delegateeErecNo])),selectedIndex:erecno,more:!1})}),paginated:!0},hrSel_Prop.serverSearch=!0,hrSel_Prop.cacheData=!0,hrSel_Prop.contentType="image-text",hrSel_Prop.search={by:["value","email"]},ZPA_Common.ZCompProp.loadSelectListProp(hrSel_Prop),ZPeopleComponents.select(popUpId.find("#changePartner"),hrSel_Prop),ZPA_Common.Loader.remove(popUpId.find("#frwrd_cards"))},construct:function(delegateeErecNo){var tab=new Tab;tab.id="forwardPopup",tab.cardId="frwrd_cards",tab.validate=(()=>NewZPOnboarding.ContactHRPopup.save(delegateeErecNo)),NewZPOnboarding.ContactHRPopup.modal=new popupModal(ZPI18N.getString("zp.reassignhrpartner"),tab),NewZPOnboarding.ContactHRPopup.modal.mediumSize=!0,NewZPOnboarding.ContactHRPopup.modal.isAppendToBody=!0,NewZPOnboarding.ContactHRPopup.modal.construct(),NewZPOnboarding.ContactHRPopup.modal.setCloseCallback(function(){NewZPOnboarding.ContactHRPopup.closePopup()}),ZPA_Common.getPopUpId(NewZPOnboarding.ContactHRPopup.modal).find("#frwrd_cards").append(ZPA_Common.Cards.construct("frwd_basic",NewZPOnboarding.ContactHRPopup.getHtml())),ZPA_Common.Loader.add("frwrd_cards")},closePopup:function(){NewZPOnboarding.ContactHRPopup.modal.remove()},save:function(delegateeErecNo){var popUpId=ZPA_Common.getPopUpId(NewZPOnboarding.ContactHRPopup.modal);ZPA_Common.removeErrorDiv(popUpId);var formObj=ZP5Form.getFormClassObj(),frwdErecNo=ZPeopleComponents.select(popUpId.find("#changePartner")).getValue();NewZPOnboarding.replaceHRPartner(delegateeErecNo,frwdErecNo)?(formObj.setParamsVal("forwardErecno",frwdErecNo),formObj.isSingleFiledEdit()&&!formObj.isSingleFieldModal?formObj.callbackForSingleFieldEdit():formObj.submitBtn(),NewZPOnboarding.ContactHRPopup.closePopup()):ZPA_Common.appendErrorDiv(popUpId.find("#changePartner"))},getHtml:function(){return'<div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.selectnewhrpartner")+'</label></div><div><select type="text" id="changePartner" class="ztextbox" value=""></select></div>'}};var ZPA_Editor={FIELDS_LIST:[],initiateEditor:function(mode,formId,getEditorContent,editorId,pageContainer){var getBodyObj=void 0!=pageContainer?pageContainer:ZPA_Common.getMainContainer();getBodyObj.find("#msgTemplate").addClass("DN");var insertDivObj=getBodyObj.find("#msgEditor");void 0===editorId&&(editorId="editorTextArea_"+ZPA_Messages.getCurrentMode(),"messagetemplate"!=mode&&"postmessage"!=mode||(editorId="editorTextArea_"+mode,mode="postmessage")),getBodyObj.find("[id="+editorId+"]").remove(),ZPA_Editor.destroy();var getEditorHtml=ZPA_Editor.getEditorBaseHtml(editorId,mode);insertDivObj.html(getEditorHtml),ZPA_Editor.editorFieldsLoad(mode,formId,pageContainer),insertDivObj.removeClass("DNI"),ZPA_Editor.createEditor(editorId,getEditorContent,mode)},destroy:function(){var editor=ZPA_Common.getMainContainer().find("#msgEditor");ZPeopleComponents.isComponent(editor.find("#merge_fields"))&&ZPeopleComponents.select(editor.find("#merge_fields")).destroy(),ZPeopleComponents.isComponent(editor.find("#field_list"))&&ZPeopleComponents.select(editor.find("#field_list")).destroy()},createEditor:function(editorBoxId,getEditorContent,pageMode){ZPA_Messages.getCurrentMode();var isPostMessage=!1,isSmileyNeeded=!0;void 0!=pageMode&&"postmessage"==pageMode&&(pageMode,isPostMessage=!0,isSmileyNeeded=!1),ZPA_Common.getMainContainer().find("#"+editorBoxId).html("");var initobject;initobject={id:editorBoxId,mode:"richtext",content:getEditorContent,editorheight:250,avoidMoreOption:!0},editor=ZPUtil.createZEEditor(initobject,!1,!1,!1,isSmileyNeeded,!1,isPostMessage,!0)},getEditorBaseHtml:function(editorId,mode){return'<div class="zpl_msghd">\n                    <div class="zpl_secn zpl_twoclum">\n                      <div>\n                        <label>'+ZPI18N.getString("zp.availablemergefields")+'</label>\n                        <select id = "merge_fields"></select>\n                      </div>\n                      <div>\n                        <label>'+ZPI18N.getString("zp.selectfield")+'</label>\n                        <select id="field_list" placeholder="'+ZPI18N.getString("zp.select")+'"></select>\n                      </div>\n                      <div>\n                        <label>'+ZPI18N.getString("zp.fieldvalue")+'</label><input id="fieldLabelBox" readonly="" class="ztextbox" type="text">\n                      </div>\n                      <div class=""><label></label><button onclick="ZPA_Editor.insertText()" type="button" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.insert")+'</button></div>\n                      <div class="zpl_icncnt">\n                        <i class="PI_maxmz" onclick="ZPA_Editor.showMinMaxEditor(this)" id="minmaxIc"  title="'+ZPI18N.getString("zp.expand")+'"></i>\n                      </div>\n                    </div>\n                  </div>\n                 <div class="zpl_msgtxt"><div class="zpl_feedCompsr zpl_edtrply tlbarTop"><div class="feedCompsr_area"><div class="feedCompsr_cont" id='+editorId+"> </div></div></div></div>"},showMinMaxEditor:function(thisObj){var mode=ZPA_Messages.getCurrentMode(),editorDiv=$(thisObj).closest("#msgEditor"),editorAreaDiv=editorDiv.find("#editorTextArea_"+mode);if(editorAreaDiv.height()<="250"){editorDiv.find("#minmaxIc").removeClass("PI_maxmz"),editorDiv.find("#minmaxIc").addClass("PI_minmz");var currPageHeight=$(thisObj).closest(".zpl_crdcnt").height(),adjHeight=currPageHeight<500?500:Math.round(currPageHeight)-75;editorAreaDiv.height(adjHeight+"px"),$(thisObj).attr("title",ZPI18N.getString("zp.shrink"))}else editorDiv.find("#minmaxIc").removeClass("PI_minmz"),editorDiv.find("#minmaxIc").addClass("PI_maxmz"),editorAreaDiv.height("250px"),$(thisObj).attr("title",ZPI18N.getString("zp.expand"));editorDiv[0].scrollIntoView({behavior:"smooth",block:"end"})},getViewTemplateHtml:function(content){return'<div id="viewTempDiv" style="padding:10px; min-height:200px;">'+content+"</div>"},editorFieldsLoad:function(mode,formId,pageContainer){if(void 0!=formId&&""!=formId&&void 0==ZPA_Editor.FIELDS_LIST[formId]){var params={formId:formId,method:"getFormFields",mode:"editorFields",conreqcsr:csrfToken};$.ajax({url:"/getFormFields.zp",type:"POST",data:params,success:function(data){ZPA_Editor.FIELDS_LIST[formId]=data,ZPA_Editor.setFormFields(mode,formId,pageContainer)}})}else ZPA_Editor.setFormFields(mode,formId,pageContainer)},setFormFields:function(mode,formId,pageContainer){var editor=(void 0!=pageContainer?pageContainer:ZPA_Common.getMainContainer()).find("#msgEditor"),merge_fields=[],baseformkey="";if("attReminderTemplate"===mode||"graceMailTemplate"===mode||mode===ZP_Automation_Mode.OTPOLICY_MAILTEMPLATE||mode===ZP_Automation_Mode.AUTOSHIFTASSIGN_MAILTEMPLATE){(formDtls=[]).push({id:"other_fields",name:ZPI18N.getString("zp.systemfields")});let formListBxProp={options:formDtls,dataMapping:{label:"name",value:"id"}};ZPA_Common.ZCompProp.loadSelectListProp(formListBxProp),ZPeopleComponents.select(editor.find("#merge_fields"),formListBxProp),"attReminderTemplate"===mode?ZPA_Editor.setSystemFields(AttShiftCommon.CheckInOutReminders.MailTemplate.getTemplateFields()):mode===ZP_Automation_Mode.OTPOLICY_MAILTEMPLATE?ZPA_Editor.setSystemFields(AttPolicy.OTPolicy.MailTemplate.getTemplateFields()):mode===ZP_Automation_Mode.AUTOSHIFTASSIGN_MAILTEMPLATE?ZPA_Editor.setSystemFields(AutoShiftAssignment.MailTemplate.getTemplateFields()):ZPA_Editor.setSystemFields(AttPolicy.GracePeriod.MailTemplate.getTemplateFields())}else if("absmailtemplate"===mode){var param={mode:"getAbsSchSysFields",conreqcsr:csrfToken,value:AttAuto.AbsentSch.MailTemplate.notifySel,type:AttAuto.AbsentSch.MailTemplate.singleOrConsecVal};ZPeople.Request.send("/AttendanceSettingsAction.zp",param,ZPA_Editor.setSystemFields),(formDtls=[]).push({id:"other_fields",name:ZPI18N.getString("zp.systemfields")});let formListBxProp={options:formDtls,dataMapping:{label:"name",value:"id"}};ZPA_Common.ZCompProp.loadSelectListProp(formListBxProp),formListBxProp.dropdownList.appendTo="#msgEditor",ZPeopleComponents.select(editor.find("#merge_fields"),formListBxProp)}else if("liveLocTrkMailTemplate"===mode){param={mode:"getliveLocTrkSysFields",conreqcsr:csrfToken,value:AttPolicy.LiveLocationTrk.notifySel};ZPeople.Request.send("/AttendanceSettingsAction.zp",param,ZPA_Editor.setSystemFields),(formDtls=[]).push({id:"other_fields",name:ZPI18N.getString("zp.systemfields")});let formListBxProp={options:formDtls,dataMapping:{label:"name",value:"id"}};ZPA_Common.ZCompProp.loadSelectListProp(formListBxProp),formListBxProp.dropdownList.appendTo="#msgEditor",ZPeopleComponents.select(editor.find("#merge_fields"),formListBxProp)}else if(mode==ZP_Automation_Mode.EMAILSCHEDULER||mode==ZP_Automation_Mode.REPORTSCHEDULER){ZPeople.Request.send("/getSysFields.zp",{method:"getSystemField",conreqcsr:csrfToken},ZPA_Editor.setSystemFields),(formDtls=[]).push({id:"other_fields",name:ZPI18N.getString("zp.systemfields")});let formListBxProp={options:formDtls,dataMapping:{label:"name",value:"id"},width:215};ZPA_Common.ZCompProp.loadSelectListProp(formListBxProp),ZPeopleComponents.select(editor.find("#merge_fields"),formListBxProp)}else if("paCustomizeTemplate"==mode){(formDtls=[]).push({id:"other_fields",name:ZPI18N.getString("zp.systemfields")});let formListBxProp={options:formDtls,dataMapping:{label:"name",value:"id"}};ZPA_Common.ZCompProp.loadSelectListProp(formListBxProp),formListBxProp.dropdownList.appendTo="#msgEditor",ZPeopleComponents.select(editor.find("#merge_fields"),formListBxProp),ZPA_Editor.setSystemFields(PMSSetting.getSystemFields())}else if("cfsCustomizeTemplate"==mode){(formDtls=[]).push({id:"other_fields",name:ZPI18N.getString("zp.systemfields")});let formListBxProp={options:formDtls,dataMapping:{label:"name",value:"id"}};ZPA_Common.ZCompProp.loadSelectListProp(formListBxProp),formListBxProp.dropdownList.appendTo="#msgEditor",ZPeopleComponents.select(editor.find("#merge_fields"),formListBxProp),ZPA_Editor.setSystemFields(PMSSetting.getCRSystemFields())}else if("obFeedEditorTemplate"==mode){(formDtls=[]).push({id:"other_fields",name:ZPI18N.getString("zp.systemfields")});let formListBxProp={options:formDtls,dataMapping:{label:"name",value:"id"}};ZPA_Common.ZCompProp.loadSelectListProp(formListBxProp),formListBxProp.dropdownList.appendTo="#msgEditor",ZPeopleComponents.select(editor.find("#merge_fields"),formListBxProp);var fieldObj={System_Fields:{}};fieldObj.System_Fields={System_Fields:{"FEED USER MENTION":ZPI18N.getString("zp.feedusermention")}},ZPA_Editor.setSystemFields(fieldObj)}else if(void 0!=formId&&""!=formId){$.each(ZPA_Editor.FIELDS_LIST[formId].formNameJArray,function(ind,formNameJObj){$.each(formNameJObj,function(formNameKey,formObj){var fieldObj={};fieldObj.value=formNameKey,fieldObj.label=formObj.lookupFullName,merge_fields.push(fieldObj),0==ind&&(baseformkey=formNameKey)})}),merge_fields.push({value:"other_fields",label:ZPI18N.getString("zp.systemfields")}),ZPA_Editor.setFieldsList("",{value:baseformkey},formId,pageContainer);let formlistProp={options:merge_fields,dataMapping:{label:"label",value:"value"},change:ZPA_Editor.setFieldsList,formId:formId,pageContainer:pageContainer,width:215};ZPA_Common.ZCompProp.loadSelectListProp(formlistProp),ZPeopleComponents.select(editor.find("#merge_fields"),formlistProp)}else if("announcementMailTemplate"==mode){let fieldData=Announcement.Template.getAnnouncementSysFields();var formDtls;(formDtls=[]).push({id:"other_fields",name:ZPI18N.getString("zp.systemfields")});let formListBxProp={options:formDtls,dataMapping:{label:"name",value:"id"}};ZPA_Common.ZCompProp.loadSelectListProp(formListBxProp),formListBxProp.dropdownList.appendTo="#msgEditor",ZPeopleComponents.select(editor.find("#merge_fields"),formListBxProp),ZPA_Editor.setSystemFields(fieldData)}else"RL_PUBLISHED"===mode&&Compensation.MailNotifications.mergeFieldsNotificationReq(mode).then(mergeFields=>{for(const formObj of mergeFields)merge_fields.push({value:formObj.formKey,label:formObj.displayName});const formSelectProps={options:merge_fields,selectedValue:"",dataMapping:{label:"label",value:"value"},change:(event,data)=>{const editor=(pageContainer||ZPA_Common.getMainContainer()).find("#msgEditor");ZPeopleComponents.isComponent(editor.find("#field_list"))&&ZPeopleComponents.select(editor.find("#field_list")).destroy();const selectedValue=data.value;for(const formObj of mergeFields)if(formObj.formKey===selectedValue){const fields=formObj.fields;let options=[];if(Array.isArray(fields))for(const group of fields){const groupName=Object.keys(group)[0];Object.entries(group[groupName]).map(([fieldKey,displayName])=>{options.push({value:fieldKey,label:displayName,optgroupLabel:groupName})})}else Object.entries(fields).map(([fieldKey,displayName])=>{options.push({value:fieldKey,label:displayName})});const fieldSelectProps={options:options,pageContainer:pageContainer,dataMapping:{label:"label",value:"value",optgroupLabel:"optgroupLabel"},change:ZPA_Editor.showFieldValue,selectedValue:"",width:215,placeholder:ZPI18N.getString("zp.select")};ZPA_Common.ZCompProp.loadSelectListProp(fieldSelectProps),ZPeopleComponents.select(editor.find("#field_list"),fieldSelectProps),editor.find("#fieldLabelBox").val("");break}},pageContainer:pageContainer,width:215};ZPA_Common.ZCompProp.loadSelectListProp(formSelectProps),ZPeopleComponents.select(editor.find("#merge_fields"),formSelectProps).setValue(mergeFields[0].formKey)})},setSystemFields:function(data){ZPA_Common.getPageMode();var editor=ZPA_Common.getMainContainer().find("#msgEditor"),sysFields=[];void 0!=data&&$.each(data.System_Fields,function(fieldKey,systemFieldObj){$.each(systemFieldObj,function(key,value){var sysObjDtl={};sysObjDtl.id=key,sysObjDtl.name=value,sysObjDtl.type=fieldKey,sysFields.push(sysObjDtl)})});let fieldListBxProp={options:sysFields,dataMapping:{label:"name",value:"id",optgroupLabel:"type"},change:ZPA_Editor.showFieldValue,selectedValue:"",width:215,placeholder:ZPI18N.getString("zp.select")};ZPA_Common.ZCompProp.loadSelectListProp(fieldListBxProp),ZPeopleComponents.select(editor.find("#field_list"),fieldListBxProp),editor.find("#fieldLabelBox").val("")},setFieldsList:function(event,data,formId,pageContainer){var editor=(void 0!=pageContainer?pageContainer:ZPA_Common.getMainContainer()).find("#msgEditor");ZPeopleComponents.isComponent(editor.find("#field_list"))&&ZPeopleComponents.select(editor.find("#field_list")).destroy(),formId=void 0!=formId?formId:data.options.formId;var isOnboarding=settingsUrlProps.currentMode===NewZPOnboarding.MODE,field_arr=[];if("other_fields"==data.value){var sysFields=ZPA_Editor.FIELDS_LIST[formId].systemFieldsJArray;if($.each(sysFields,function(index,sysFldAry){$.each(sysFldAry,function(optGrp,syFldDtl){var sysFldKeys=Object.keys(syFldDtl);$.each(sysFldKeys,function(ind,sysKey){var fldKey=sysFldKeys[ind];if(!isOnboarding||!NewZPOnboarding.iscandidateemail||"companyLogo"!=fldKey){var field_obj={};field_obj.value=fldKey,field_obj.label=syFldDtl[fldKey],field_obj.optgroupLabel=optGrp,field_arr.push(field_obj)}})})}),isOnboarding){var optGrp=ZPI18N.getString("zp.Onboarding"),optjson={CandidateInvitationURL:ZPI18N.getString("zp.candinvlink"),CandidateLoginURL:ZPI18N.getString("zp.candloginlink"),EmployeeOnboardingURL:ZPI18N.getString("zp.emponblink"),CandidateHRPartner:ZPI18N.getString("zp.candhrmail")};$.each(optjson,function(fldKey,label){var field_obj={};field_obj.value=fldKey,field_obj.label=label,field_obj.optgroupLabel=optGrp,field_arr.push(field_obj)})}}else{var fields=ZPA_Editor.FIELDS_LIST[formId].formComponentJObj[data.value];$.each(fields,function(multiFormsName,fieldsArray){$.each(fieldsArray,function(indx,secFieldsObj){$.each(secFieldsObj,function(sectionName,fieldsObj){var field_obj={};field_obj.value=fieldsObj.label,field_obj.label=fieldsObj.displayName,field_obj.optgroupLabel=indx,field_arr.push(field_obj)})})})}let fieldlstProp={options:field_arr,dataMapping:{label:"label",value:"value",optgroupLabel:"optgroupLabel"},change:ZPA_Editor.showFieldValue,selectedValue:"",pageContainer:pageContainer,width:215,placeholder:ZPI18N.getString("zp.select")};ZPA_Common.ZCompProp.loadSelectListProp(fieldlstProp),ZPeopleComponents.select(editor.find("#field_list"),fieldlstProp),editor.find("#fieldLabelBox").val("")},showFieldValue:function(event,data){(void 0!=event&&void 0!=event.detail.options.pageContainer?event.detail.options.pageContainer:ZPA_Common.getMainContainer()).find("#msgEditor").find("#fieldLabelBox").val("${"+data.value+"}")},insertText:function(){editor.insertHTML(ZPA_Common.getMainContainer().find("#msgEditor").find("#fieldLabelBox").val())}};const statusConstants=Object.freeze({ONBOARDING_NOT_CONFIGURED:-2,ONBOARDING_NOT_TRIGGERED:0,ONBOARDING_TRIGGERED:1,ONBOARDING_STARTED:2,ONBOARDING_COMPLETED:3,TRIGGERED_ONBOARDING_INVITED_EMP:-1,USER_COMPLETE:4,ONBOARDING_REOPEN:5,CONVERTED:6,INACTIVE:-7});var OnboardingListing={filter:{},isFilterEmptyforcand:!0,isFilterEmptyforemp:!0,MODE:"onboarding",EmployeeForm:{id:"",name:""},CandidateForm:{id:"",name:""},currentFlowType:"",reports:{},allReport:{},inProgressAry:[statusConstants.ONBOARDING_TRIGGERED,statusConstants.ONBOARDING_STARTED,statusConstants.USER_COMPLETE,statusConstants.ONBOARDING_REOPEN],notTriggeredAry:[statusConstants.ONBOARDING_NOT_CONFIGURED,statusConstants.ONBOARDING_NOT_TRIGGERED,statusConstants.TRIGGERED_ONBOARDING_INVITED_EMP],FireScroll:{},Filter:{CandKeyVal:{},EmpKeyVal:{}},MAX_BULKCOUNT:50,init:function(){var type=window.location.href.indexOf("emp")>=0?"employee":"candidate";if(settingsPage.container.html(),0===settingsPage.container.find("[data-tab="+type+"]").length)ZPeople.Request.send("/onboardingNewReport.zp",{reportType:type}),resultData="P_Employee"==OnboardingListing.currentReportType()?EmployeeReportListing.listingLayoutConstruct():CandidateReportListing.listingLayoutConstruct(),void 0!==resultData&&(settingsPage.container.html(resultData),OnboardingListing.reportData(),OnboardingListing.isCandReportPage()&&NewCPortal.coverttoEmp(),ZPeopleComponents.menubutton(settingsPage.container.find("#reportExportDiv")));else{var data=settingsPage.container.find(".zpl_tpcrdlst").find(".zpl_act");OnboardingListing.reportData(data)}},isCandReportPage:function(){return window.location.hash.indexOf("#operations/onboarding/listing/cand")>=0},currentReportType:function(){return OnboardingListing.isCandReportPage()?"P_Candidate":"P_Employee"},getCurrentTab:function(){return settingsPage.container.attr("id")},toggleFilters:function(isOpened){0==settingsPage.container.find("#onboardingfilter").length&&OnboardingListing.initiateFilter(),isOpened?settingsPage.container.find("#onboardingfilter").parent().removeClass("zpl_fltr_flt"):settingsPage.container.find("#onboardingfilter").parent().addClass("zpl_fltr_flt")},initiateFilter:function(){OnboardingListing.isCandReportPage()?(OnboardingListing.isFilterInitiatedforcand=!0,ZPeopleComponents.isComponent(settingsPage.container.find(settingsPage.container.attr("id")+"-filter"))&&(ZPeopleComponents.select(settingsPage.container.find(settingsPage.container.attr("id")+"-filter")).destroy(),settingsPage.container.find("#onboardingfilter").remove()),OnboardingListing.updatecandFilter()):(OnboardingListing.isFilterInitiatedforemp=!0,ZPeopleComponents.isComponent(settingsPage.container.find(settingsPage.container.attr("id")+"-filter"))&&ZPeopleComponents.select(settingsPage.container.find(settingsPage.container.attr("id")+"-filter")).destroy(),ZPeopleComponents.isComponent(settingsPage.container.find(settingsPage.container.attr("id")+"input"))&&ZPeopleComponents.select(settingsPage.container.find(settingsPage.container.attr("id")+"input")).destroy(),settingsPage.container.find("#onboardingfilter").remove(),ZPeople.Request.sendAsyncPost("/onboarding/reports/getFilterComponents",{},OnboardingListing.updateempFilter)),!OnboardingListing.reportId&&0==Layout.Page.container.find("#externalonburl").length&&(OnboardingListing.isCandReportPage()&&OnboardingListing.isFilterEmptyforcand||!OnboardingListing.isCandReportPage()&&OnboardingListing.isFilterEmptyforemp)&&OnboardingListing.setDefaultFilter()},updatecandFilter:function(){var tabId=OnboardingListing.getCurrentTab();settingsPage.container.find("#onboardingfilter")&&(ZPeopleComponents.isComponent(settingsPage.container.find("#"+tabId+"-candidate-filter"))&&ZPeopleComponents.select(settingsPage.container.find("#"+tabId+"-candidate-filter")).destroy(),settingsPage.container.find("#onboardingfilter").remove()),OnboardingListing.Filter.CandKeyVal={0:ZPI18N.getString("zp.nottriggered"),1:ZPI18N.getString("zp.triggered"),2:ZPI18N.getString("zp.ongoingonboarding"),3:ZPI18N.getString("zp.componboarding"),6:ZPI18N.getString("zp.convertedtoemp"),"-7":ZPI18N.getString("zp.inactive")};var html="";if(html+='<div id="onboardingfilter" class="zpl_fltr" data-tab="candidate"><div class="zpl_fltrcnt"> <div> <div class="zpl_fltclps fltopn"> <div class="zpl_fltrhd"> <h5>'+ZPI18N.getString("zp.filter")+'</h5> <i class="PI_cls" onclick="OnboardingListing.toggleFilters(true)"></i> </div><div class="zpl_fltrlst"> <div> <font><i class="IC-ar-rgt"></i><b>System Filter</b></font> </div><div class="zpl_secn"><div><input id="CANDIDATE_NAME_input" placeholder="'+ZPI18N.getString("zp.candidatename")+' " type="search" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.onboardingstatus")+'</label></div><div><select id="'+tabId+'-candidate-filter"></select></div></div></div></div></div></div><div> <div> <button id="onbaplfltr" class="zlabel zlabel--blue zlabel--medium" onclick="OnboardingListing.filterDataConstruct()">'+ZPI18N.getString("zp.apply")+'</button> <button class="zlabel zlabel--outline zlabel--medium" onclick="OnboardingListing.resetFilter()">'+ZPI18N.getString("zp.reset")+"</button> </div> </div></div>",!tabId.includes("candNottriggered")&&!tabId.includes("candOnboarded")){settingsPage.container.append(html);let params=[];(tabId.includes("candInprogress")||tabId.includes("candAll"))&&(params.push({id:statusConstants.ONBOARDING_TRIGGERED,value:ZPI18N.getString("zp.triggered")}),params.push({id:statusConstants.ONBOARDING_STARTED,value:ZPI18N.getString("zp.ongoingonboarding")})),(tabId.includes("candInprogress")||tabId.includes("candAll"))&&(params.push({id:statusConstants.USER_COMPLETE,value:ZPI18N.getString("zp.usercompleteonboarding")}),params.push({id:statusConstants.ONBOARDING_REOPEN,value:ZPI18N.getString("zp.reopenonboarding")}),OnboardingListing.Filter.CandKeyVal[4]=ZPI18N.getString("zp.usercompleteonboarding"),OnboardingListing.Filter.CandKeyVal[5]=ZPI18N.getString("zp.reopenonboarding")),tabId.includes("candAll")&&(params.push({id:statusConstants.ONBOARDING_NOT_TRIGGERED,value:ZPI18N.getString("zp.nottriggered")}),params.push({id:statusConstants.CONVERTED,value:ZPI18N.getString("zp.convertedtoemp")}),params.push({id:statusConstants.ONBOARDING_COMPLETED,value:ZPI18N.getString("zp.componboarding")}),params.push({id:statusConstants.INACTIVE,value:ZPI18N.getString("zp.inactive")})),tokenObj={},tokenObj.showSearchField=!0,tokenObj.placeholder=ZPI18N.getString("zp.select"),tokenObj.selectedValue="",tokenObj.options=params,tokenObj.randomDropdownListId=!0,tokenObj.contentType="text",tokenObj.dataMapping={label:"value",informativeText:"value",value:"id"},ZPeopleComponents.select(document.getElementById(settingsPage.container.attr("id")+"-candidate-filter"),tokenObj)}},updateempFilter:function(data){var tabId=OnboardingListing.getCurrentTab();settingsPage.container.find("#onboardingfilter").length>0&&(ZPeopleComponents.isComponent(settingsPage.container.find("#"+tabId+"-employee-filter"))&&ZPeopleComponents.select(settingsPage.container.find("#"+tabId+"-employee-filter")).destroy(),ZPeopleComponents.isComponent(settingsPage.container.find("#"+tabId+"_LOCATION_input"))&&ZPeopleComponents.select(settingsPage.container.find("#"+tabId+"_LOCATION_input")).destroy(),ZPeopleComponents.isComponent(settingsPage.container.find("#"+tabId+"_DESIGNATIONNAME_input"))&&ZPeopleComponents.select(settingsPage.container.find("#"+tabId+"_DESIGNATIONNAME_input")).destroy(),ZPeopleComponents.isComponent(settingsPage.container.find("#"+tabId+"_ROLENAME_input"))&&ZPeopleComponents.select(settingsPage.container.find("#"+tabId+"_ROLENAME_input")).destroy(),ZPeopleComponents.isComponent(settingsPage.container.find("#"+tabId+"_DEPARTMENTNAME_input"))&&ZPeopleComponents.select(settingsPage.container.find("#"+tabId+"_DEPARTMENTNAME_input")).destroy(),settingsPage.container.find("#onboardingfilter").remove()),OnboardingListing.Filter.EmpKeyVal={0:ZPI18N.getString("zp.nottriggered"),1:ZPI18N.getString("zp.triggered"),2:ZPI18N.getString("zp.ongoingonboarding"),3:ZPI18N.getString("zp.componboarding")};var html='<div id="onboardingfilter" class="zpl_fltr" data-tab="employee"> <div></div><div class="zpl_fltrcnt"> <div> <div class="zpl_fltclps fltopn"> <div class="zpl_fltrhd"> <h5>'+ZPI18N.getString("zp.filter")+'</h5> <i class="PI_cls" onclick="OnboardingListing.toggleFilters(true)"></i> </div> <div> <font><i class="IC-ar-rgt"></i><b></b></font> </div><div class="zpl_fltrlst"><div class="zpl_secn"><div><input id="EMPLOYEE_NAME_input" placeholder="'+ZPI18N.getString("zp.employeename")+' " type="search" class="ztextbox"></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.onboardingstatus")+'</label></div><div><select id="'+settingsPage.container.attr("id")+'-employee-filter" ></select></div></div>';$.each(data.filterNames,function(filterKey,filterVal){"DATEOFJOINING"==filterKey?(html+='<div class="zpl_secn"><div><label>'+filterVal+"</label></div>",html+='<div><input id="DATEOFJOINING_input" class="datepicker-js" data-placeholder-type="date-format-in-lower" data-format="dd/MM/yyyy" data-picker="true" data-calendar-icon="true" data-clear-button="none" data-spin-buttons="none" style="display: none;" data-width="245" ></div></div>'):Object.keys(data[filterKey]).length>0&&(html+='<div class="zpl_secn"><div><label>'+filterVal+'</label></div><div><select id="'+settingsPage.container.attr("id")+"_"+filterKey+'_input" >',html+="</select></div></div>")}),html+='</div></div></div></div><div> <div> <button id="onbaplfltr" class="zlabel zlabel--blue zlabel--medium" onclick="OnboardingListing.filterDataConstruct()">'+ZPI18N.getString("zp.apply")+'</button> <button class="zlabel zlabel--outline zlabel--medium" onclick="OnboardingListing.resetFilter()">'+ZPI18N.getString("zp.reset")+"</button> </div> </div></div>",settingsPage.container.append(html),ZPeopleComponents.datefield(settingsPage.container.find("#DATEOFJOINING_input"));let params=[];(tabId.includes("empInprogress")||tabId.includes("empAll"))&&params.push({id:statusConstants.ONBOARDING_STARTED,value:ZPI18N.getString("zp.ongoingonboarding")}),tabId.includes("empAll")&&params.push({id:statusConstants.ONBOARDING_COMPLETED,value:ZPI18N.getString("zp.componboarding")}),tokenObj={},tokenObj.showSearchField=!0,tokenObj.placeholder=ZPI18N.getString("zp.select"),tokenObj.selectedValue="",tokenObj.options=params,tokenObj.randomDropdownListId=!0,tokenObj.contentType="text",tokenObj.dataMapping={label:"value",informativeText:"value",value:"id"},ZPeopleComponents.select(document.getElementById(settingsPage.container.attr("id")+"-employee-filter"),tokenObj),$.each(data.filterNames,function(filterKey,filterVal){let params=[];$.isEmptyObject(data[filterKey])||(params=data[filterKey].filterValues.map(function(filterJson){return{id:filterJson.PKID,value:ZPeople.decodeTxt(filterJson.DISPLAYNAME)}}));let tokenObj={showSearchField:!0,placeholder:ZPI18N.getString("zp.select"),selectedValue:"",options:params,randomDropdownListId:!0,contentType:"text",dataMapping:{label:"value",informativeText:"value",value:"id"}};ZPeopleComponents.select(document.getElementById(settingsPage.container.attr("id")+"_"+filterKey+"_input"),tokenObj)})},setDefaultFilter:function(){var value=settingsPage.container.find(".zpl_tpcrdlst").find(".zpl_act").attr("data-value"),cand="";OnboardingListing.isCandReportPage()&&(cand="_CAND");var id="#ONBOARDING_STATUS"+cand+"_input";void 0!=value&&value.trim().length>0&&ZPeopleComponents.select(settingsPage.container.find("#onboardingfilter").find(id)).setValues(value.split(","),!0)},resetFilter:function(){settingsPage.container.find("#onboardingfilter").find("input[id*=_input],select[id*=-filter],select[id*=_input]").each(function(){var filterName=$(this).attr("id").split("_input")[0];OnboardingListing.isCandReportPage()&&(filterName=filterName.split("_CAND")[0]),"DATEOFJOINING"===filterName?ZPeopleComponents.datefield($(this)).clear():"EMPLOYEE_NAME"===filterName||"CANDIDATE_NAME"===filterName?$(this).val(""):ZPeopleComponents.select($(this)).deselectAllOptions()})},reloadData:function(){if(settingsPage.container.find(".zpl_tpcrdlst").find(".zpl_act").length>0||0===settingsPage.container.find("#onboardingfilter").length){var data=settingsPage.container.find(".zpl_tpcrdlst").find(".zpl_act");OnboardingListing.reportData(data)}else settingsPage.container.find("#onboardingfilter").find("#onbaplfltr").trigger("click")},reportData:function(data,isFromFilter,filterParams){var searchJson=isFromFilter&&void 0!==filterParams&&0!==Object.keys(filterParams).length?filterParams:{};settingsPage.container.find(".ZPPsearch").remove(),settingsPage.container.find(".ZPNdata").remove(),settingsPage.container.find("#zp_page_loading").remove(),settingsPage.container.find(".zpl_rgtcnt").addClass("DN"),settingsPage.container.find("#reportstable tbody").html(""),settingsPage.container.append(ZPeople.LOADING_HTML);var params={reportType:OnboardingListing.currentReportType()};settingsPage.container.find(".zpl_tpcrdlst").find(".zpl_act").removeClass("zpl_act");var currentState=window.location.href.split("/").pop();0===Object.keys(searchJson).length&&this.filterDataParams(searchJson),void 0===searchJson.ONBOARDING_STATUS&&this.getOnbStatekey(currentState,searchJson),params.searchJson=JSON.stringify(searchJson),params.isnewui=!0,OnboardingListing.FireScroll.searchJson=JSON.stringify(searchJson),OnboardingListing.FireScroll.count=0,ZPeople.Request.send("/onboarding/reports/list",params,OnboardingListing.reportDataConstruct)},filterDataParams:function(searchJson){settingsPage.container.find("#onboardingfilter").find("input[id*=_input],select[id*=-filter],select[id*=_input]").each(function(){var filterVal="",filterId=$(this).attr("id"),filterName=$(this).attr("id").split("_input")[0];OnboardingListing.isCandReportPage()&&(filterName=filterName.split("_CAND")[0]),"DATEOFJOINING"===filterName?void 0!=(filterVal=ZPeopleComponents.datefield($(this)).getValue().dateString)&&""!=filterVal.trim()&&(searchJson[filterName]=filterVal):"EMPLOYEE_NAME"===filterName||"CANDIDATE_NAME"===filterName?""!=(filterVal=ZSEC.Encoder.encodeForHTML($(this).val())).trim()&&(searchJson[filterName]=filterVal):"filter"===filterId.split("-")[4]?(filterVal=ZPeopleComponents.select($(this)).getValue()).length>0&&(searchJson.ONBOARDING_STATUS=filterVal.toString()):"ROLENAME"!==filterId.split("_")[1]&&"DEPARTMENTNAME"!==filterId.split("_")[1]&&"LOCATION"!==filterId.split("_")[1]||(filterVal=filterVal=ZPeopleComponents.select($(this)).getValue()).length>0&&("ROLENAME"===filterId.split("_")[1]&&(searchJson.ROLENAME=filterVal.toString()),"DEPARTMENTNAME"===filterId.split("_")[1]&&(searchJson.DEPARTMENTNAME=filterVal.toString()),"LOCATION"===filterId.split("_")[1]&&(searchJson.LOCATION=filterVal.toString()))})},filterDataConstruct:function(){var searchJson={},taghtml="";settingsPage.container.find("#onboardingfilter").find("input[id*=_input],select[id*=-filter],select[id*=_input]").each(function(){var filterVal="",filterId=$(this).attr("id"),filterName=$(this).attr("id").split("_input")[0],fdisplay=OnboardingListing.Filter.EmpKeyVal,tagcount=0;OnboardingListing.isCandReportPage()&&(fdisplay=OnboardingListing.Filter.CandKeyVal,filterName=filterName.split("_CAND")[0]),"DATEOFJOINING"===filterName?void 0!=(filterVal=ZPeopleComponents.datefield($(this)).getValue().dateString)&&""!=filterVal.trim()&&(searchJson[filterName]=filterVal,taghtml+="<li><span>"+filterVal+'</span><a id="'+filterName+'" class="PI_cls"></a></li>',tagcount++):"EMPLOYEE_NAME"===filterName||"CANDIDATE_NAME"===filterName?""!=(filterVal=ZSEC.Encoder.encodeForHTML($(this).val())).trim()&&(searchJson[filterName]=filterVal,tagcount<5?(taghtml+="<li><span>"+filterVal+'</span><a id="'+filterName+'" class="PI_cls"></a></li>',tagcount++):taghtml+="<li><span>"+(tagcount-=4)+" more</span></li>"):filterId.includes("candidate-filter")||filterId.includes("employee-filter")?(filterVal=ZPeopleComponents.select($(this)).getValue()).length>0&&(searchJson.ONBOARDING_STATUS=filterVal.toString(),taghtml+="<li><span>"+fdisplay[filterVal]+'</span><a name="'+filterId+'" id="'+filterVal+'" class="PI_cls"></a></li>'):(filterId.includes("ROLENAME")||filterId.includes("DEPARTMENTNAME")||filterId.includes("LOCATION")||filterId.includes("DESIGNATIONNAME"))&&(fdisplay=ZPeopleComponents.select($(this))._optDatas,(filterVal=filterVal=ZPeopleComponents.select($(this)).getValue()).length>0&&("ROLENAME"===filterId.split("_")[1]&&(searchJson.ROLENAME=filterVal.toString()),"DEPARTMENTNAME"===filterId.split("_")[1]&&(searchJson.DEPARTMENTNAME=filterVal.toString()),"LOCATION"===filterId.split("_")[1]&&(searchJson.LOCATION=filterVal.toString()),"DESIGNATIONNAME"===filterId.split("_")[1]&&(searchJson.DESIGNATIONNAME=filterVal.toString()),$.each(fdisplay,function(ind,value){tagcount<5?(taghtml+="<li><span>"+ZSEC.Encoder.encodeForHTML(fdisplay[ind].value)+'</span><a name="'+filterId+'" id="'+fdisplay[ind].id+'" class="PI_cls"></a></li>',tagcount++):taghtml+="<li><span>"+(tagcount-=4)+" more</span></li>"})))}),taghtml&&(taghtml='<div id="tagParent" class="zpl_fltrvw"><div><ul class="zpl_fltrvwlst">'+taghtml+'</ul></div><div class="d-flexcap MLauto"><a class="red" id="cleartag">'+ZPI18N.getString("zp.reset")+"</a></div></div>",settingsPage.container.find("#tagParent").remove(),$(taghtml).insertAfter(settingsPage.container.find(".zpl_btnmnu")),settingsPage.container.find(".zpl_fltrvw").find(".PI_cls").on("click",function(){var id1=$(this).attr("id"),filterContainer=settingsPage.container.find("#onboardingfilter");switch(id1){case"CANDIDATE_NAME":case"EMPLOYEE_NAME":filterContainer.find("#"+id1+"_input").val("");break;case"DATEOFJOINING":ZPeopleComponents.datefield(filterContainer.find("#"+id1+"_input")).clear();break;default:var tagname=$(this).attr("name");ZPeopleComponents.select(filterContainer.find("#"+tagname)).deselectOption(id1)}OnboardingListing.clearTags($(this)),OnboardingListing.reportData(void 0,!1,searchJson)}),settingsPage.container.find(".zpl_fltrvw").find("#cleartag").on("click",function(){$(this).parents("#tagParent").remove(),OnboardingListing.resetFilter(),OnboardingListing.reportData()}),OnboardingListing.reportData("",!0,searchJson),OnboardingListing.toggleFilters(!0))},clearTags(obj){var parentObj=$(obj).parents("#tagParent");$(obj).closest("li").remove(),0===parentObj.find("li").length&&parentObj.remove()},reportDataConstruct:function(data,params){if(OnboardingListing.currentPageSearchParams=JSON.parse(params.searchJson),"tab-onboarding-nottriggered"!=settingsPage.container.attr("id")&&"tab-onboarding-onboarded"!=settingsPage.container.attr("id")?settingsPage.container.find("i.zpl_ibg.PI_fltr").show():settingsPage.container.find("i.zpl_ibg.PI_fltr").hide(),void 0!=data){var tabId=settingsPage.container.attr("id");settingsPage.container.find(".zpl_rgtcnt").removeClass("DN"),settingsPage.container.find(".zpl_tblres").removeClass("DN"),settingsPage.container.find("#zp_page_loading").remove(),settingsPage.container.find("#emptPage").remove(),settingsPage.container.find(".table-body").find(".loading").remove();window.location.href.split("/").pop();if(OnboardingListing.isCandReportPage()?(void 0!=data.empPhotoFC&&(NewZPPreboarding.empPhotoFC=data.empPhotoFC),data.candidateFormId&&(NewZPPreboarding.candidateFormId=data.candidateFormId),"Cand"+window.location.href.split("/").pop(),params.searchJson.ONBOARDING_STATUS==statusConstants.CONVERTED?settingsPage.container.find("[for="+tabId+"-Repmasscheckbox]").hide():settingsPage.container.find("[for="+tabId+"-Repmasscheckbox]").show()):params.searchJson.ONBOARDING_STATUS==statusConstants.ONBOARDING_COMPLETED?settingsPage.container.find("[for="+tabId+"-Repmasscheckbox]").hide():settingsPage.container.find("[for="+tabId+"-Repmasscheckbox]").show(),void 0!=data.filterData){if(0!=data.filterData.length){0==OnboardingListing.FireScroll.count&&settingsPage.container.find("#reportstable tbody").html(""),OnboardingListing.FireScroll.count+=data.filterData.length;new FireScrollBack(OnboardingListing.reportListFireScroll,settingsPage.container,OnboardingListing.getCurrentTab())}var viewPhoto=getResourceURL(newUIImageUrl+"user.png");$.each(data.filterData,function(rowInd,reportData){var checkbox,statusClass="pend",percent="",ratioText="",html="",loginstatus="",candOBStatus="",sttype=window.location.href.split("/").pop();if(checkbox='<td class="cb"></td>',reportData.ONBOARDING_STATUS==statusConstants.CONVERTED||reportData.ONBOARDING_STATUS==statusConstants.INACTIVE||!OnboardingListing.isCandReportPage()&&reportData.ONBOARDING_STATUS!=statusConstants.ONBOARDING_STARTED&&reportData.ONBOARDING_STATUS!=statusConstants.ONBOARDING_NOT_CONFIGURED||(OnboardingListing.isMassCheck=!0,loginstatus=OnboardingListing.isCandReportPage()&&void 0===reportData.LOGINSTATUS?"nonportaluser":reportData.LOGINSTATUS,checkbox='<td><div class="zcheckbox"><input type="checkbox" name="check" value="" onchange="OnboardingListing.bulkUpdateCheckBox(this)" class="zcheckbox__helper" id="'+reportData.PKID+"_chkbox_"+sttype+'" loginstatus="'+loginstatus+'" onbstatus="'+reportData.ONBOARDING_STATUS+'"><label for="'+reportData.PKID+"_chkbox_"+sttype+'" class="zcheckbox__label"></label></div></td>'),OnboardingListing.totalTabs=reportData.TOTALTABS,OnboardingListing.completeTabs=reportData.COMPLETETABS,-1==OnboardingListing.completeTabs&&(OnboardingListing.completeTabs+=1,reportData.COMPLETETABS+=1),OnboardingListing.singleTabAngle=Math.round(360/OnboardingListing.totalTabs),reportData.ONBOARDING_STATUS==statusConstants.ONBOARDING_COMPLETED)statusClass="comp",percent="100";else if(reportData.ONBOARDING_STATUS==statusConstants.ONBOARDING_STARTED){percent=Math.round(100*OnboardingListing.completeTabs/OnboardingListing.totalTabs);var totaltabs=-1!==OnboardingListing.totalTabs?OnboardingListing.totalTabs:0;ratioText=OnboardingListing.completeTabs+" / "+totaltabs+" "}void 0!=reportData.ROLENAME&&reportData.ROLENAME;var onclickrecord="",cid="",desigName="";if(void 0!=reportData.DESIGNATIONNAME&&(desigName=reportData.DESIGNATIONNAME),OnboardingListing.isCandReportPage()){if(loginstatus=reportData.LOGINSTATUS,candOBStatus=reportData.ONBOARDING_STATUS,reportData.isphotopresent){var downloadParams={fcId:NewZPPreboarding.empPhotoFC,recordId:reportData.PKID,formId:NewZPPreboarding.candidateFormId,original:"false"};viewPhoto=ZP5Form.constructDownloadLink(downloadParams)}onclickrecord='OnboardingListing.showSingleRecord("'+NewZPPreboarding.candidateFormId+'","'+reportData.PKID+'","VIEW")',cid="<em>"+data.prefix+reportData.CID+" - </em>"}else viewPhoto=reportData.PHOTO,onclickrecord='OnboardingListing.showSingleRecord("'+ZPeople.EMP_FORMID+'","'+reportData.PKID+'","VIEW")';if(html+='<tr id="'+reportData.PKID+'" status="'+loginstatus+'">'+checkbox+'<td class="name"><div class="zpl_em" onclick='+onclickrecord+'><div class="zpl_emimg"><img src="'+viewPhoto+'"></div><div class="zpl_emdts"><div><em>'+cid+"</em><b>"+reportData.USERNAME+'</b></div><em class="zpl_email" onclick=OnboardingListing.copyToClipboard(event)>'+reportData.EMAILALIAS+"</em></div></div>","P_Employee"==OnboardingListing.currentReportType()?(html+="<td><span>"+reportData.DATEOFJOINING+"</span></td>",html+="<td><span>"+desigName+"</span></td>"):(html+="<td><span>"+reportData.PHONE+"</span></td>",html+="<td><span>"+reportData.DESIGNATIONNAME+"</span></td>"),$.inArray(reportData.ONBOARDING_STATUS,OnboardingListing.inProgressAry)>-1){html+=reportData.ONBOARDING_STATUS!==statusConstants.ONBOARDING_TRIGGERED?"<td onclick=\"OnboardingListing.viewOnboardingDetails('"+reportData.PKID+"')\">":"<td>";let completestatus="";switch(reportData.ONBOARDING_STATUS){case statusConstants.USER_COMPLETE:completestatus="<a>"+ZPI18N.getString("zp.usercompleteonboarding")+"</a>";break;case statusConstants.ONBOARDING_REOPEN:completestatus="<a>"+ZPI18N.getString("zp.reopenonboarding")+"</a>";break;case statusConstants.ONBOARDING_TRIGGERED:completestatus=ratioText+"<span>"+ZPI18N.getString("zp.triggered")+'</span><br><span class="count">('+ZPI18N.getString("zp.onbyettoaccept")+")</span>";break;case statusConstants.ONBOARDING_STARTED:completestatus='<a class="count">'+ratioText+ZPI18N.getString("zp.chkinprogress")+"</a>"}html+='<div class="ZPstatus '+statusClass+'"><div>'+completestatus+'</div><div class="ZPprobar progress"><div class="progress-bar ZPprogrs PR" style="width:'+percent+'%"></div></div></div>'}else if($.inArray(reportData.ONBOARDING_STATUS,OnboardingListing.notTriggeredAry)>-1)html+="<td><span>"+ZPI18N.getString("zp.nottriggered")+"</span></td>";else switch(reportData.ONBOARDING_STATUS){case statusConstants.ONBOARDING_NOT_CONFIGURED:html+="<td><span>"+ZPI18N.getString("zp.nottriggered")+"</span></td>";break;case statusConstants.ONBOARDING_COMPLETED:html+="<td onclick=\"OnboardingListing.viewOnboardingDetails('"+reportData.PKID+"')\"><a>"+ZPI18N.getString("zp.completed")+"</a></td>";break;case statusConstants.CONVERTED:html+="<td onclick=\"OnboardingListing.viewOnboardingDetails('"+reportData.PKID+"')\"><a>"+ZPI18N.getString("zp.convertedtoemp")+"</a></td>";break;case statusConstants.INACTIVE:html+="<td><span>"+ZPI18N.getString("zp.inactive")+"</span></td>"}html+="</td>",OnboardingListing.isCandReportPage()?html+='<td><div><div class="zpl_hvr"><i id="obMore_'+reportData.PKID+'" title="'+ZPI18N.getString("zp.more")+'" data-title-display-type="callout" class="PI_more" onclick="OnboardingListing.showMoreOption(\''+reportData.PKID+"', "+loginstatus+", "+candOBStatus+')"></i></div></div></td>':html+="<td></td>",settingsPage.container.find("#reportstable tbody").append(html),viewPhoto=getResourceURL(newUIImageUrl+"user.png"),settingsPage.container.find("tbody").find("#"+reportData.PKID+"_togglestatus")&&ZPeopleComponents.toggleswitch(settingsPage.container.find("tbody").find("#"+reportData.PKID+"_togglestatus"),{on:"1"===reportData.LOGINSTATUS,change:NewCPortal.changeLoginStatus}),void 0==OnboardingListing.allReport[reportData.PKID]&&(OnboardingListing.allReport[reportData.PKID]={}),OnboardingListing.allReport[reportData.PKID].reportDetails=reportData}),1==OnboardingListing.isMassCheck?settingsPage.container.find(".table-header").find(".cb").html('<div class="checkbox"><input type="checkbox" id="masscheckbox" onchange="OnboardingListing.bulkUpdateCheckBox(this);"><label></label></div>'):settingsPage.container.find(".table-header").find(".checkbox").remove()}else if(0==OnboardingListing.FireScroll.count){settingsPage.container.find(".zpl_tblres").addClass("DN");var noDataCont='<div id="emptPage" class="zpl_crd wd100_per"><div class="zpl_crdcnt"><div class="zpl_Emptydata"><div><div class="zpl_emptimg zp_nd_nodata"></div><h4>'+ZPI18N.getString("zp.norec")+"</h4></div></div></div></div>";settingsPage.container.find(".zpl_rgtcnt").append(noDataCont)}}},reportListFireScroll:function(){var params={start:OnboardingListing.FireScroll.count+1,reportType:OnboardingListing.currentReportType(),isnewui:!0};params.searchJson=OnboardingListing.FireScroll.searchJson,ZPeople.Request.send("/onboarding/reports/list",params,OnboardingListing.reportDataConstruct)},hideTopbtns:function(){settingsPage.container.find("#onbcmpbtn").removeClass("opn"),settingsPage.container.find("input[type='checkbox']").prop("checked",!1)},reportExport:function(ftype){var searchJson=this.currentPageSearchParams,currentState=window.location.href.split("/").pop();if(this.getOnbStatekey(currentState,searchJson),0==$("#zp_export_ob").length){var fObj='<form id="zp_export_ob" action="/onboarding/reports/export" method="post" name="zp_export_ob" style="display: none;" target="exportresp">';$("#wrapper").append(fObj)}(fObj=$("#zp_export_ob").html("")).append('<input type="hidden" value="'+OnboardingListing.currentReportType()+'" name="reportType"/>'),fObj.append('<input type="hidden" value="filterData" name="parmode"/>'),fObj.append('<input type="hidden" value="true" name="isnewui"/>'),fObj.append('<input type="hidden" value="'+ftype+'" name="ftype"/>'),fObj.append('<input type="hidden" value=\''+JSON.stringify(searchJson)+'\' name="searchJson"/>'),fObj.append('<input type="hidden" value="'+csrfToken+'" name="'+csrfParamName+'"/>'),fObj.submit()},getOnbStatekey:function(state,searchJson){switch(state){case"candInprogress":case"empInprogress":searchJson.ONBOARDING_STATUS=this.inProgressAry.join(",");break;case"candNottriggered":searchJson.ONBOARDING_STATUS=this.notTriggeredAry.join(",");break;case"candOnboarded":case"empOnboarded":searchJson.ONBOARDING_STATUS=statusConstants.ONBOARDING_COMPLETED}},viewOnboardingDetails:function(data,params){if(void 0==params){void 0==OnboardingListing.allReport[data]&&(OnboardingListing.allReport[data]={});params={pkid:data,parmode:"empTabDetails",isnewui:!0,reportType:OnboardingListing.currentReportType()};ZPeople.Request.send("/onboarding/reports/tabDetails",params,OnboardingListing.viewOnboardingDetails)}else if("object"==typeof data&&null!==data&&Object.keys(data).length>0){$("#userOnboardingDetails").remove();var tab=new Tab;tab.id="userOnboardingDetails";var tabModal=new sliderModal("",tab);tabModal.mediumSize=!0,tabModal.construct(),$("#userOnboardingDetails").find(".zpl_mfoter").remove(),$("#userOnboardingDetails").find(".zpl_mhder ").find("h4").remove(),$("#userOnboardingDetails").find(".zpl_mcnt").html(ZPeople.LOADING_HTML),OnboardingListing.allReport[params.pkid].completeDetails=data,OnboardingListing.currentUserData=data;var isReports=settingsUrlProps.niceUrl.indexOf("/reports/")>=0;if(isReports&&void 0!==data.reportDetails&&(OnboardingListing.allReport[params.pkid].reportDetails=data.reportDetails),void 0!=data.tabsOrder){var completedcount=0;$.each(data.tabsOrder,function(tabInd,tabLabel){data.tabDetails[tabLabel].tabCols.IS_COMPLETED&&completedcount++}),ZPA_Common.isNotNull(OnboardingListing.allReport[params.pkid].reportDetails)||ZPeople.Request.sendAsyncPost("/onboarding/reports/list",{erecno:params.pkid,reportType:OnboardingListing.currentReportType(),searchJson:"{}"},function(res){OnboardingListing.allReport[params.pkid].reportDetails=res.filterData[0]}),completedcount!==OnboardingListing.allReport[params.pkid].reportDetails.COMPLETETABS&&(OnboardingListing.allReport[params.pkid].reportDetails.COMPLETETABS=completedcount,isReports||OnboardingListing.reloadData()),OnboardingListing.constructtabDetails(params.pkid)}}else ZPeople.Message.info(ZPI18N.getString("zp.onb.nodataavailable"))},constructtabDetails:function(pkid){var userDetails=OnboardingListing.allReport[pkid].completeDetails,reportDetails=OnboardingListing.allReport[pkid].reportDetails,viewUrl=getResourceURL(newUIImageUrl+"user.png");if(OnboardingListing.isCandReportPage()&&reportDetails.isphotopresent){var downloadParams={fcId:userDetails.empPhotoFC,recordId:pkid,formId:userDetails.candidateFormId,original:"false"};viewUrl=ZP5Form.constructDownloadLink(downloadParams)}else OnboardingListing.isCandReportPage()||(viewUrl=reportDetails.PHOTO);var cmponb="";reportDetails.ONBOARDING_STATUS!==statusConstants.ONBOARDING_COMPLETED&&reportDetails.ONBOARDING_STATUS!=statusConstants.CONVERTED&&(cmponb='<span class="zpl_mhderrgt"><button class="zlabel zlabel--blue zlabel--medium" buttonname="completeOnboarding" onclick="OnboardingListing.completeOnboarding(\''+pkid+"')\">"+ZPI18N.getString("zp.lms.content.Markascompleted")+"</button>",reportDetails.ONBOARDING_STATUS===statusConstants.USER_COMPLETE&&(cmponb+='<button class="zlabel zlabel--blue zlabel--medium" buttonname="reopenOnboarding" onclick="OnboardingListing.reopenOnboarding(\''+pkid+"')\">"+ZPI18N.getString("zp.reopen")+"</button>"),cmponb+="</span>");var html='<div class="zpl_em"><div class="zpl_emimg"><img src="'+viewUrl+'"></div><div class="zpl_emdts"><div><b>'+reportDetails.USERNAME+"</b></div><span>"+reportDetails.EMAILALIAS+"</span></div></div>";if($("#userOnboardingDetails:visible").find("#sliderCls").before(cmponb),$("#userOnboardingDetails:visible").find(".zpl_mhder").find("div").prepend(html),reportDetails.ONBOARDING_STATUS===statusConstants.ONBOARDING_COMPLETED&&void 0!=reportDetails.obCompletedTimeStr){var ctime='<div class="zpl_mhderrgt" ><div class="zpl_flexcolumn"><div class="zpl_flexgap2"><i class="PI_tick2_fil grn"></i><span class="grn">'+ZPI18N.getString("zp.completed")+"</span></div> <div><span>"+reportDetails.obCompletedTimeStr+"</span></div> </div> </div>";$(ctime).insertBefore($("#userOnboardingDetails:visible").find(".zpl_mhder").find("a"))}if(void 0!=userDetails.tabsOrder&&(html='<div class="zpl_crd"><div class="zpl_crdhdr"><div>',html+="<h4>"+ZPI18N.getString("zp.onboardingtasks")+"</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div> <table class="zpl_tblbdr wd100_per"><tbody>',$.each(userDetails.tabsOrder,function(tabInd,tabLabel){var tabDetails=userDetails.tabDetails[tabLabel];html+='<tr><td width="50">',tabDetails.tabCols.IS_COMPLETED?html+='<i class="PI_tick2 grn">':html+='<i class="PI_pending3">',html+="</i></td><td><b>"+ZPeople.decodeTxt(tabDetails.tabCols.DISPLAY_NAME)+"</b></td></tr>"}),html+="</tbody></table></div></div></div></div>"),$("#userOnboardingDetails:visible").find(".zpl_mcnt").html(html),$("#userOnboardingDetails:visible").find(".zpl_mcnt").addClass("obReportsModalList"),void 0!=userDetails.empFiles)html='<div class="zpl_crd"><div class="zpl_crdhdr"><div>',html+="<h4>"+ZPI18N.getString("zp.onboardingdocuments")+"</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div> <table class="zpl_tblbdr wd100_per"><tbody>',$.each(userDetails.empFiles,function(fileInd,fileDetails){var previewData=fileDetails,viewURL=FilesUtil.Preview.frameURL(previewData),obLightBoxObj=new LightBox(ZSEC.Encoder.encodeForHTML(fileDetails.fileName));obLightBoxObj.LightBox.viewUrl=viewURL;var data={filePath:fileDetails.filePath,fileID:fileDetails.fileID},div="<tr><td filedata='"+JSON.stringify(data)+'\'><div><a href="javascript:">'+fileDetails.fileName+"</a></div></td></tr>";html+=div,div=$(div),$(div).on("click",function(){obLightBoxObj.LightBox.show()})}),html+="</tbody></table></div></div></div></div>",$("#userOnboardingDetails:visible").find(".zpl_mcnt").append(html);else if(void 0!=userDetails.tabDetails.Agreements){const docsData=userDetails.tabDetails.Agreements.tabSpecificData.docsToSign,agrData=userDetails.tabDetails.Agreements.tabSpecificData.agrToSign,policiesData=userDetails.tabDetails.Agreements.tabSpecificData.policies;void 0==docsData&&void 0==agrData||(html='<div class="zpl_crd"><div class="zpl_crdhdr"><div>',html+="<h4>"+ZPI18N.getString("zp.onboardingdocuments")+"</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div> <table class="zpl_tblbdr wd100_per"><tbody>',void 0!=docsData&&$.each(docsData,function(ind,docDetails){if(void 0!=docDetails.HR_FILES_ID){var data={filePath:docDetails.PATH,fileID:docDetails.HR_FILES_ID,fileName:docDetails.DISPLAY_NAME,fileType:docDetails.fileType,fileConfident:docDetails.isConfidential},isAccepted=docDetails.IS_ACCEPTED?ZPI18N.getString("zp.accepted"):ZPI18N.getString("zp.declined");let statusClass=docDetails.IS_ACCEPTED?"grn":"red";if(docDetails.IS_ACCEPTED)var div="<tr filedata='"+JSON.stringify(data)+'\'><td><a href="javascript:">'+docDetails.DISPLAY_NAME+'</a></td><td><div class="zpl_tg"><span class="'+statusClass+'">'+isAccepted+"</span></div></td></tr>";else if("null"==data.fileID)div="<tr><td>"+docDetails.DISPLAY_NAME+'</td><td><div class="zpl_tg"><span>'+ZPI18N.getString("zp.yettobegenerated")+"</span></div></td></tr>";else if(0==docDetails.IS_ACCEPTED)div="<tr filedata='"+JSON.stringify(data)+'\'><td><a  href="javascript:">'+docDetails.DISPLAY_NAME+'</a></td><td><div class="zpl_tg"><span class="'+statusClass+'">'+isAccepted+"</span></div></td></tr>";else div="<tr filedata='"+JSON.stringify(data)+'\'><td><a  href="javascript:">'+docDetails.DISPLAY_NAME+'</a></td><td><div class="zpl_tg"><span>'+ZPI18N.getString("zp.generated")+"</span></div></td></tr>";html+=div,div=$(div)}}),void 0!=agrData&&$.each(agrData,function(ind,docDetails){if(void 0!=docDetails.HR_FILES_ID){var data={fileID:docDetails.HR_FILES_ID,fileName:docDetails.DISPLAY_NAME,filePath:""},isAccepted=docDetails.IS_ACCEPTED?ZPI18N.getString("zp.accepted"):ZPI18N.getString("zp.declined");let statusClass=docDetails.IS_ACCEPTED?"grn":"red";if(docDetails.IS_ACCEPTED)var div="<tr filedata='"+JSON.stringify(data)+'\'><td><a href="javascript:">'+docDetails.DISPLAY_NAME+'</a></td><td><div class="zpl_tg"><span class="'+statusClass+'">'+isAccepted+"</span></div></td></tr>";else if("null"==data.fileID)div="<tr><td>"+docDetails.DISPLAY_NAME+'</td><td><div class="zpl_tg"><span>'+ZPI18N.getString("zp.yettobegenerated")+"</span></div></td></tr>";else if(0==docDetails.IS_ACCEPTED)div="<tr filedata='"+JSON.stringify(data)+'\'><td><a  href="javascript:">'+docDetails.DISPLAY_NAME+'</a></td><td><div class="zpl_tg"><span class="'+statusClass+'">'+isAccepted+"</span></div></td></tr>";else div="<tr filedata='"+JSON.stringify(data)+'\'><td><a  href="javascript:">'+docDetails.DISPLAY_NAME+'</a></td><td><div class="zpl_tg"><span>'+ZPI18N.getString("zp.generated")+"</span></div></td></tr>";html+=div,div=$(div)}}),html+="</tbody></table></div></div></div></div>",$("#userOnboardingDetails:visible").find(".zpl_mcnt").append(html)),void 0!=policiesData&&(html='<div class="zpl_crd"><div class="zpl_crdhdr"><div>',html+="<h4>"+ZPI18N.getString("zp.formcompanypolicy")+"</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div> <table class="zpl_tblbdr wd100_per"><tbody>',$.each(policiesData,function(ind,docDetails){if(void 0!=docDetails.FILEID){(1==docDetails.UPLOADSOURCE||decodeHTML(docDetails.FILEPATH).indexOf(workDriveUrl)>-1||decodeHTML(docDetails.FILEPATH).indexOf(writerUrl)>-1||decodeHTML(docDetails.FILEPATH).indexOf(sheetUrl)>-1||decodeHTML(docDetails.FILEPATH).indexOf(showUrl)>-1)&&!0;var data={fileID:docDetails.FILEID,fileName:docDetails.FILENAME,fileType:docDetails.fileType,fileConfident:docDetails.isConfidential,fileExtn:docDetails.EXTENSION};data.filePath=docDetails.FILEPATH,data.uploadSource=docDetails.UPLOADSOURCE;var id=docDetails.FILEID,div="<tr filedata='"+JSON.stringify(data)+"'><td id="+id+'><a href="javascript:">'+docDetails.FILENAME+"</a></td></tr>";html+=div,div=$(div)}}),html+="</tbody></table></div></div></div></div>",$("#userOnboardingDetails:visible").find(".zpl_mcnt").append(html))}(void 0!=userDetails.tabDetails.Forms&&void 0!=userDetails.tabDetails.Forms.tabSpecificData||void 0!=userDetails.tabDetails.Profile)&&(html='<div class="zpl_crd"><div class="zpl_crdhdr"><div>',html+="<h4>"+ZPI18N.getString("zp.Onboarding.yourprofile")+"</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div> <table class="zpl_tblbdr wd100_per"><tbody>',void 0!=userDetails.tabDetails.Profile&&(html+="<tr onclick=\"OnboardingListing.showSingleRecord('"+NewZPPreboarding.candidateFormId+"','"+pkid+"','VIEW')\"><td><a>Candidate</a></td></tr>"),void 0!=userDetails.tabDetails.Forms&&void 0!=userDetails.tabDetails.Forms.tabSpecificData&&$.each(userDetails.tabDetails.Forms.tabSpecificData.forms,function(ind,formDetails){html+="<tr onclick=\"OnboardingListing.showSingleRecord('"+formDetails.formId+"','"+formDetails.recordId+"','VIEW')\"><td><a>"+formDetails.formName+"</a></td></tr>"}),html+="</tbody></table></div></div></div></div>",$("#userOnboardingDetails:visible").find(".zpl_mcnt").append(html)),$("#userOnboardingDetails:visible").find(".obReportsModalList").find("[filedata]").on("click",function(){var data=JSON.parse($(this).attr("filedata"));if(1==data.uploadSource||data.filePath.indexOf(workDriveUrl)>-1||data.filePath.indexOf(writerUrl)>-1||data.filePath.indexOf(sheetUrl)>-1||data.filePath.indexOf(showUrl)>-1)settingsPage.pageContWrapper.parent().prepend(Files.openWDFiles(data,!0));else{var lightBoxObj=new LightBox(ZSEC.Encoder.encodeForHTML(data.fileName));lightBoxObj.viewUrl="viewFile?fileId="+data.fileID;var fileExtn=data.fileExtn;if(void 0==fileExtn||"undefined"==fileExtn){var fileName=data.fileName;-1==fileName.lastIndexOf(".")&&-1==fileName.lastIndexOf(".")||(fileExtn=(fileExtn=fileName.substr(fileName.lastIndexOf(".")+1,fileName.length)).toLowerCase())}"jpg"!==fileExtn&&"jpeg"!==fileExtn&&"gif"!==fileExtn&&"png"!==fileExtn||(lightBoxObj.isImage=!0),lightBoxObj.show()}}),void 0!=userDetails.tabDetails.LMS_Course&&void 0!=userDetails.tabDetails.LMS_Course.tabSpecificData.courses&&(html='<div class="zpl_crd"><div class="zpl_crdhdr"><div>',html+="<h4>Courses</h4></div></div>",html+='<div class="zpl_crdcnt"><div class="zpl_secn"><div> <table class="zpl_tblbdr wd100_per"><tbody>',$.each(userDetails.tabDetails.LMS_Course.tabSpecificData.courses,function(ind,course){var lmsinfo=course.courseBasicDetails[0].courseInfo[0];html+="<tr><td>"+lmsinfo.courseName+"</td>",html+=lmsinfo.isCourseCompleted?"<td>"+ZPI18N.getString("zp.completed")+"</td></tr>":"<td>"+ZPI18N.getString("zp.pending")+"</td></tr>"}),html+="</tbody></table></div></div></div></div>",$("#userOnboardingDetails:visible").find(".obReportsModalList").append(html)),settingsPage.container.find("#userOnboardingDetails:visible #sliderCls").on("click",function(){window.location.href="zp#"+Layout.Page.hashDtl.hashKey})},addUserPage:function(){$.ajax({type:"POST",async:!1,url:"/users/getAddUserPage",data:{mode:"user",needAllDtls:!0,conreqcsr:csrfToken},success:function(data){UserSettings.checkAddUserDirectlyAllowed(data),UserSettings.user.add.licenseCountLeft=data.licenseCountLeft,UserSettings.user.add.employeesAdded=data.employeesAdded,UserSettings.user.add.handleMenu()}})},reopenOnboarding:function(pkid){NewCPortal.currentPortalZAIDj?OnboardingListing.reopenPopup(pkid):$.ajax({type:"POST",async:!1,url:NewCPortal.candidateURLS.CPORTALURL,data:{conreqcsr:csrfToken},success:function(data){0!=Object.keys(data).length&&void 0!=data.portalName&&(NewCPortal.currentPortalZAID=data.ZAID,NewCPortal.portalObj=data,OnboardingListing.reopenPopup(pkid))},error:function(err){OnboardingListing.failureCallBack(err)}})},reopenPopup:function(pkid){$("#reopenModal").remove();var tab=new Tab;tab.id="reopenModal",tab.cardId="onbreopendiv",new sliderModal(ZPI18N.getString("zp.candidateemailcustomise"),tab).construct(),$("#reopenModal").addClass("zpl_mcenter zpl_mmd"),$("#reopenModal").attr("candidateid",pkid);OnboardingListing.allReport[pkid].completeDetails;var touser=OnboardingListing.allReport[pkid].reportDetails,reopenhtml='<form><div class="zpl_crd" id="reopenEditorContainer"><div class="zpl_crdcnt"><div class="zpl_secn zpl_mailtmp"><div keyname="to"><label>'+ZPI18N.getString("zp.to")+'</label></div><div id="touser" class="disabled"></div></div><div class="zpl_secn zpl_mailtmp"><div keyname="cc"><label>'+ZPI18N.getString("zp.cc")+'</label></div><div id="ccuser"></div></div><div class="zpl_secn zpl_mailtmp"><div keyname="subject"><label class="zpl_mtry">'+ZPI18N.getString("zp.subject")+'</label></div><div><input required="" type="text" value="'+ZPI18N.getString("zp.reopendefaultsubject",[ZPeople.ORGLIST.currServiceOrg])+'" class="ztextbox"></div></div><div class="zpl_secn" id="msgEditor">'+OnboardingListing.getEditorBaseHtml("reopenEditor")+'<div keyname="message"><label>'+ZPI18N.getString("zp.message")+'</label></div><div id="descEditor"></div></div>';reopenhtml+='<div><div class="zpl_upld"><div class="zpl_fldrp"><h5><img src="../../images/nodata/fileupload.png" alt="">Upload from <a class="zpl_lnk" id="localUpload" onclick="ZPA_FileUpload.LocalUpload.loadLocalFile()"><i class="PI_case"></i>Desktop</a> / <a class="zpl_lnk" id="cloudupload" onclick=ZPA_FileUpload.CloudUpload.init("reopenModal")><i class="PI_cloud"></i>Cloud</a></h5></div><p><span>Supported File Format: CSV, DOC, PDF, XLS, XLSX, ZIP.</span></p></div></div>',reopenhtml+='<div class="zpl_secn"><div id="attachedFiles" style="display:none;"><h5>Attachement Files</h5></div><div><div class="zpl_atchd" id="fluplDiv"></div></div></div>',$("#reopenModal").find("#onbreopendiv").html(reopenhtml),NewZPOnboarding.editorConstruct("descEditor",!0,"descContent",!0),NewZPOnboarding.replaceWithEditor("reopenEditorContainer","descEditor",!0),$("#reopenModal").find("#onbreopendiv").find("#descEditor").children("label").remove();NewCPortal.portalObj.redirecturl?NewCPortal.portalObj.redirecturl:window.location.href.split(portalname)[0];NewCPortal.portalObj.portalName;var empproperties=[];ZPeople.ALL_USER_LOADED?ZPeople.ALL_USERLIST:ZPeople.sendUserListAjax(null,null,!0),$.each(ZPeople.ALL_USERLIST,function(userInd,user){var empprop={id:user.usererec,value:ZPeople.decodeTxt(user.name)};empproperties.push(empprop)});let parentAddrDiv=$("#reopenModal").find("#onbreopendiv"),toAddrElm=parentAddrDiv.find("#touser"),ccAddrElm=parentAddrDiv.find("#ccuser");toAddrElm.children().remove(),toAddrElm.append("<z-tokenfield></z-tokenfield>"),ccAddrElm.children().remove(),ccAddrElm.append("<z-tokenfield></z-tokenfield>"),ZPeopleComponents.tokenfield(ccAddrElm.find("z-tokenfield"),{data:empproperties,dataMapping:{value:"id",text:"value",id:"id"}}),ZPeopleComponents.tokenfield(toAddrElm.find("z-tokenfield"),{data:[{id:ZPeople.decodeTxt(touser.EMAILALIAS),value:ZPeople.decodeTxt(touser.USERNAME)}],dataMapping:{value:"id",text:"value",id:"id"},values:[{id:ZPeople.decodeTxt(touser.EMAILALIAS),value:ZPeople.decodeTxt(touser.USERNAME)}]}),$("#reopenModal").find("#sliderSbt").on("click",function(){OnboardingListing.sendreopen()}),ZPA_Editor.editorFieldsLoad("",NewZPPreboarding.candidateFormId),ZPeople.Request.send("/onboarding/reports/reopenMessage",{parmode:"reopenMessage"},OnboardingListing.reopenMessage)},reopenMessage:function(data){ZPFeeds.Editor.editorList.descEditor.setContent(data.message)},getEditorBaseHtml:function(editorId,mode){return'<div class="zpl_msghd">\n                    <div class="zpl_secn zpl_twoclum">\n                      <div>\n                        <label>'+ZPI18N.getString("zp.availablemergefields")+'</label>\n                        <select id = "merge_fields"></select>\n                      </div>\n                      <div>\n                        <label>'+ZPI18N.getString("zp.selectfield")+'</label>\n                        <select id="field_list" placeholder="'+ZPI18N.getString("zp.select")+'"></select>\n                      </div>\n                      <div>\n                        <label>'+ZPI18N.getString("zp.fieldvalue")+'</label><input id="fieldLabelBox" readonly="" class="ztextbox" type="text">\n                      </div>\n                      <div class=""><label></label><button onclick="OnboardingListing.insertText()" type="button" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.insert")+'</button></div>\n                      <div class="zpl_icncnt">\n                        <i class="PI_maxmz" onclick="ZPA_Editor.showMinMaxEditor(this)" id="minmaxIc"  title="'+ZPI18N.getString("zp.expand")+'"></i>\n                      </div>\n                    </div>\n                  </div>\n                 <div class="zpl_msgtxt"><div class="zpl_feedCompsr zpl_edtrply tlbarTop"><div class="feedCompsr_area"><div class="feedCompsr_cont" id='+editorId+"> </div></div></div></div>"},insertText:function(){ZPFeeds.Editor.editorList.descEditor.insertHTML(ZPA_Common.getMainContainer().find("#msgEditor").find("#fieldLabelBox").val())},sendreopen:function(obj){var reopendiv=$("#reopenModal").find("#onbreopendiv"),inp=$(reopendiv).find("[keyname]"),params={},iserror=!1;if(NewZPOnboarding.removeErrorSpan(obj),$.each(inp,function(){var keyname=$(this).attr("keyname"),val="";if($.inArray(keyname,["to","cc"])>-1){var allvalues=ZPeopleComponents.tokenfield($(this).closest(".zpl_secn").find("z-tokenfield")).getAllValues();$.each(allvalues,function(index,datavalue){val=0==index?datavalue.id:val+","+datavalue.id})}else val=$(this).closest(".zpl_secn").find("input").val();void 0==val&&(val=""),""==val.trim()&&$(this).find("label").hasClass("zpl_mtry")?(iserror=!0,OnboardingListing.errorSpanAttach("Please enter a value",$(this))):params[keyname]=val}),!iserror){var editor=ZPFeeds.Editor.editorList.descEditor;if(void 0!=editor&&(reopenDesc=ZPFeeds.getSmileysAndMentions(editor.getContent(),!1)),0==$(reopenDesc).text().length)iserror=!0,OnboardingListing.errorSpanAttach("Please enter a value",$(this));else{params.message=reopenDesc;var formdata=new FormData;if(formdata.append("candidateid",$("#reopenModal").attr("candidateid")),formdata.append("conreqcsr",csrfToken),formdata.append("mailjson",JSON.stringify(params)),reopendiv.find("[name='fileDiv']").length>0){var uploadFromCloud=[],attind=1,cloudUploadDoc=($(this).attr("filetype"),reopendiv.find("#cloudupload").data("cloudUploadDoc")),fileUpload=reopendiv.find("#localUpload").data("fileObj");cloudUploadDoc&&uploadFromCloud.push(cloudUploadDoc),fileUpload&&formdata.append("attachment"+attind++,fileUpload),formdata.append("uploadFromCloud",JSON.stringify(uploadFromCloud)),formdata.append("uploadFromWD",JSON.stringify([]))}$.ajax({url:"/onboarding/reports/reopen",type:"POST",data:formdata,contentType:!1,processData:!1,cache:!1,error:function(xhr){CommonTemplates.saveComplete("submitCaseBtn");var error_response=JSON.parse(xhr.responseText);ZPeople.Message.failure(error_response.error)},success:function(data){OnboardingListing.reopensuccess(data)}})}}},reopensuccess:function(data){data.msg==zpconst.CommonMessages.SUCCESSMSG?(ZPeople.Message.success(ZPI18N.getString("zp.updatedsuccessfully")),$("#reopenModal").find("#sliderCancel").click(),$("#userOnboardingDetails").find("#sliderCls").click(),OnboardingListing.reloadData()):void 0!=data.msg?ZPeople.Message.failure(data.msg):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))},failureCallBack:function(err){if(settingsPage.container.find("#zp_page_loading").remove(),err.responseText&&err.responseText.includes('id="IAM_SECURITY_ERROR"'))settingsPage.container.html(err.responseText);else if("object"==typeof err){var eMsg=err.hasOwnProperty("responseJSON")&&err.responseJSON.hasOwnProperty("error")?err.responseJSON.error:ZPI18N.getString("zpp.somethingwentwrong");ZPeople.Message.warning(eMsg)}else ZPeople.Message.warning(ZPI18N.getString("zp.sorryservererror"))},bulkUpdateCheckBox:function(obj){var tabId=settingsPage.container.attr("id");if(obj.id===tabId+"-Repmasscheckbox"){var checkboxes=settingsPage.container.find("tbody input[type='checkbox']");if(settingsPage.container.find("#"+obj.id).is(":checked")){let bulkCount=checkboxes.length,showAny=!1;settingsPage.container.find("#markascomp,#resendInvite,#convertcandtoemp-"+tabId+",#triggerOnboarding").hide(),bulkCount>OnboardingListing.MAX_BULKCOUNT&&(checkboxes=checkboxes.slice(0,OnboardingListing.MAX_BULKCOUNT),ZPeople.Message.warning(ZPI18N.getString("zp.onb.bulkcheckprvnt",new Array(OnboardingListing.MAX_BULKCOUNT+"")))),checkboxes.prop("checked",!0),0!==settingsPage.container.find("input[onbstatus=2]:checked,input[onbstatus=4]:checked,input[onbstatus=5]:checked").length&&(settingsPage.container.find("#markascomp").show(),showAny=!0),0!==settingsPage.container.find("input[loginstatus=2]:checked").length&&(settingsPage.container.find("#resendInvite").show(),showAny=!0),0!==settingsPage.container.find("input[loginstatus='nonportaluser']:checked,input[onbstatus=3]:checked").length&&(settingsPage.container.find("#convertcandtoemp-"+tabId).show(),showAny=!0),0!==settingsPage.container.find("input[onbstatus=0]:checked").length&&(settingsPage.container.find("#triggerOnboarding").show(),showAny=!0),showAny&&settingsPage.container.find("#onbcmpbtn").addClass("opn")}else checkboxes.prop("checked",!1),settingsPage.container.find("#onbcmpbtn").removeClass("opn")}else settingsPage.container.find("tbody").find("input:checked").length>0&&settingsPage.container.find("tbody").find("input:checked").length<=OnboardingListing.MAX_BULKCOUNT?(settingsPage.container.find("#markascomp,#resendInvite,#convertcandtoemp-"+tabId+",#triggerOnboarding").hide(),settingsPage.container.find("#onbcmpbtn").addClass("opn"),0!==settingsPage.container.find("input[onbstatus=2]:checked,input[onbstatus=4]:checked,input[onbstatus=5]:checked").length&&settingsPage.container.find("#markascomp").show(),0!==settingsPage.container.find("input[loginstatus=2]:checked").length&&settingsPage.container.find("#resendInvite").show(),0!==settingsPage.container.find("input[loginstatus='nonportaluser']:checked,input[onbstatus=3]:checked").length&&settingsPage.container.find("#convertcandtoemp-"+tabId).show(),0!==settingsPage.container.find("input[onbstatus=0]:checked").length&&settingsPage.container.find("#triggerOnboarding").show()):settingsPage.container.find("tbody").find("input:checked").length>OnboardingListing.MAX_BULKCOUNT?(FrameworkCommon.showInfoAlert(ZPI18N.getString("zp.onb.bulkcheckalerthead"),ZPI18N.getString("zp.onb.bulkcheckalertbody",new Array(OnboardingListing.MAX_BULKCOUNT+""))),obj.checked=!1):settingsPage.container.find("#onbcmpbtn").removeClass("opn"),0==settingsPage.container.find("tbody").find("input[type='checkbox']:checked").length&&settingsPage.container.find("#reportstable").find("thead input[type='checkbox']").prop("checked",!1)},completeBulkOnboarding:function(){ZPeople.Request.send("/obReportActions.zp",params,OnboardingListing.handleresultofcmponb)},completeOnboarding:function(erecno){settingsPage.container.find("[name=completeOnboarding]").attr("disabled","disabled"),ZPeople.Request.send("/onboarding/reports/completeOnboarding",{reportType:OnboardingListing.currentReportType(),erecno:erecno},OnboardingListing.handleresultofcmponb)},handleresultofcmponb:function(result,params){1==result.success&&("bulkcompleteOnboarding"==params.parmode?(ZPeople.Message.success(ZPI18N.getString("zp.updatesuccessful")),OnboardingListing.reloadData(),settingsPage.container.find("input[type='checkbox']:checked").closest(".checkbox").remove(),OnboardingListing.hideTopbtns()):($("#userOnboardingDetails").find("#sliderCls").trigger("click"),ZPeople.Message.success(ZPI18N.getString("zp.updatesuccessful")),OnboardingListing.reloadData()))},retriggerOnboarding:function(erecNo){let alertInfo=new InfoAlertMessage(ZPI18N.getString("zp.retriggeronbflow"),ZPI18N.getString("zp.retriggerdesc"));alertInfo.setIsDoubleCnf(!0,ZPI18N.getString("zp.retriggerconf")),alertInfo.yesButtonText=ZPI18N.getString("zp.confirm"),alertInfo.setCallback(()=>{settingsPage.container.find("[name=retriggerOnboarding]").attr("disabled","disabled"),ZPeople.Request.send("/onboarding/reports/retrigger",{erecNo:erecNo},OnboardingListing.handleResultOfRetrigger)}),alertInfo.setCloseCallback(()=>{alertInfo.close()}),alertInfo.show()},handleResultOfRetrigger:function(response){response.hasOwnProperty("msg")&&"success"===response.msg?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.onbretriggeredsuccess")),OnboardingListing.init()):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror"))},completebulkonb:function(){var allerecno=[];settingsPage.container.find(".ZPPsearch").remove(),settingsPage.container.find(".Scrcont").removeAttr("style"),$.each($(settingsPage.container).find("#reportstable").find("tbody").find("input[type='checkbox']:checked"),function(index,elm){allerecno[index]=$(elm).closest("tr").attr("id")}),allerecno=JSON.stringify(allerecno),params={erecnoobj:allerecno,reportType:OnboardingListing.currentReportType()},message="P_Employee"==OnboardingListing.currentReportType()?ZPI18N.getString("zp.empconfirmbulkcomp"):ZPI18N.getString("zp.candconfirmbulkcomp");let props={callback:()=>{ZPeople.Request.send("/onboarding/reports/bulkComplete",params,OnboardingListing.handleresultofcmponb)},doneBtn:ZPI18N.getString("zp.confirm"),isCancelNeeded:!0};FrameworkCommon.showInfoAlert(ZPI18N.getString("zp.confirmbulkcomp"),message,props)},bulkTriggerOnb:function(){var allerecno=[];settingsPage.container.find(".ZPPsearch").remove(),settingsPage.container.find(".Scrcont").removeAttr("style"),$.each($(settingsPage.container).find("#reportstable").find("tbody").find("input[type='checkbox']:checked"),function(index,elm){allerecno[index]=$(elm).closest("tr").attr("id")}),allerecno=JSON.stringify(allerecno),params={erecnoobj:allerecno,reportType:OnboardingListing.currentReportType()},$.ajax({type:"POST",async:!1,url:"/onboarding/reports/bulkTrigger",data:{erecnoobj:allerecno,conreqcsr:csrfToken},success:function(data){if(data.Success)ZPeople.Message.success(ZPI18N.getString("zp.onboardingtriggeredsuccess"));else if(data.hasOwnProperty("onbtriggeredalready")||data.hasOwnProperty("invaliduser")||data.hasOwnProperty("onbdoesntexist")||data.hasOwnProperty("adminusers")){var html='<div class="obflow">';$.each(data,function(index1,msgobj){"Success"!=index1&&(html+='<p class="pspace">',"onbtriggeredalready"==index1?html+=ZPI18N.getString("zp.onbalreadytriggered"):"invaliduser"==index1?html+=ZPI18N.getString("zp.notvailduser"):"onbdoesntexist"==index1?html+=ZPI18N.getString("zp.nomatchonbflow"):"adminusers"==index1&&(html+=ZPI18N.getString("zp.noonbforadmin")),html+="</p>",html+='<div class="pspace">',$.each(msgobj,function(index2,emailid){html+="<span>","invaliduser"==index1?isOrgEmpPage?html+=ZPeople.getUserDetailsById(emailid).email:html+=$("#userListTable").find("[emperecno="+emailid+"]").find(".zpl_emdts").find("b").text():html+=emailid,html+="</span>"}),html+="</div>")}),FrameworkCommon.showInfoAlert(ZPI18N.getString("zp.onbnottriggeredreasons"),html)}else void 0!=data.msg?ZPeople.Message.failure(data.msg):ZPeople.Message.warning(ZPI18N.getString("zp.sorryservererror"));OnboardingListing.reloadData(),settingsPage.container.find("input[type='checkbox']:checked").closest(".checkbox").remove(),OnboardingListing.hideTopbtns()}})},showMoreOption:function(pkId,status,obstatus){event.stopPropagation();var pageId=ZPA_Common.getParentPageId(),menuId="obMenu_"+pkId;if(!ZPeopleComponents.isComponent(pageId.find("#"+menuId))){var menuHtml='<div id="'+menuId+'">\n\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t<li id="enable" pkId="'+pkId+'">'+ZPI18N.getString("zp.enableLogin")+'</li>\n\t\t\t\t\t\t\t\t\t\t<li id="disable" pkId="'+pkId+'">'+ZPI18N.getString("zp.disableLogin")+'</li>\n\t\t\t\t\t\t\t\t\t\t<li id="resendinv" pkId="'+pkId+'">'+ZPI18N.getString("zp.resendinv")+'</li>\n\t\t\t\t\t\t\t\t\t\t<li id="triggeronb" pkId="'+pkId+'">'+ZPI18N.getString("zp.triggeronboadring")+'</li>\n\t\t\t\t\t\t\t\t\t\t<li id="edit" pkId="'+pkId+'">'+ZPI18N.getString("zp.edit")+'</li>\n\t\t\t\t\t\t\t\t\t\t<li id="delete" pkId="'+pkId+'">'+ZPI18N.getString("zp.delete")+"</li>\n\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t</div>";pageId.append(menuHtml),ZPeopleComponents.menu(pageId.find("#"+menuId),{appendTo:pageId,displayType:"callout",itemclick:OnboardingListing.onMoreMenuSelect}),"1"==status?("6"!=obstatus&&"3"!=obstatus||ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#disable"]),ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#enable"]),ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#resendinv"]),ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#triggeronb"])):"2"==status?(ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#enable"]),ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#disable"]),ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#triggeronb"])):"0"==status?(ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#disable"]),ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#resendinv"]),ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#triggeronb"])):void 0===status&&(ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#enable"]),ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#disable"]),ZPeopleComponents.menu(pageId.find("#"+menuId)).hideMenuItems(["#resendinv"]))}ZPeopleComponents.menu(pageId.find("#"+menuId)).show({forElement:pageId.find("#obMore_"+pkId)})},onMoreMenuSelect:function(event,detail){event.stopPropagation();var menuAttr=detail.data.attrs,action=menuAttr.id,pkId=menuAttr.pkid;"enable"==action?NewCPortal.changeLoginStatus(pkId,1):"disable"==action?NewCPortal.changeLoginStatus(pkId,0):"resendinv"==action?NewCPortal.resendInvitation(pkId):"triggeronb"==action?NewCPortal.convertToCandidate(pkId):"delete"==action?NewCPortal.deleteCandPopUp(this,pkId):"edit"==action&&OnboardingListing.showSingleRecord(NewZPPreboarding.candidateFormId,pkId,"EDIT")},showSingleRecord:function(formId,recId,mode){var paramsObj={formId:formId,recordId:recId,disableUrlTrack:!0,formMode:mode,notifycallback:OnboardingListing.reloadData,modalCloseCallback:OnboardingListing.reloadData};ZP5Form.load(paramsObj)},convertToCandidateOptions:function(tabId){ZPeopleComponents.isComponent("#convertcandtoempdropdownmenu-"+tabId)?ZPeopleComponents.menu("#convertcandtoempdropdownmenu-"+tabId).show():(ZPeopleComponents.menu("#convertcandtoempdropdownmenu-"+tabId,{forElement:"#convertcandtoemp-"+tabId}),NewCPortal.coverttoEmp(),ZPeopleComponents.menu("#convertcandtoempdropdownmenu-"+tabId).show())},copyToClipboard:function(event){event.stopPropagation();const textArea=document.createElement("textarea");textArea.value=event.target.innerText,textArea.style.opacity=0,document.body.appendChild(textArea),textArea.focus(),textArea.select();try{successCopy=document.execCommand("copy"),!1===successCopy?ZPeople.Message.failure(ZPI18N.getString("zp.copyfailed")):ZPeople.Message.success(ZPI18N.getString("zp.copysuccess"))}catch(exception){successCopy=!1,ZPeople.Message.failure(ZPI18N.getString("zp.copyfailed"))}return successCopy},currReportPage:function(){return Layout.Page.hash.indexOf("cand")>=0?"candidate":"employee"}},CandidateReportListing={isFilterEmptyforcand:!0,CandidateForm:{id:"",name:""},currentFlowType:"",portalType:"",portalId:"",ZAID:"",portalName:"",listingLayoutConstruct:function(){var tabId=settingsPage.container.attr("id"),listingType=window.location.href.split("/").pop(),portalname=void 0===CandidateReportListing.portalName?"":CandidateReportListing.portalName;settingsPage.container.addClass("zpl_tblfxd");var headerHtml="";headerHtml+='<div class="zpl_btnmnu">',headerHtml+='<div class="d-flexcap a-itm-cntr blk"> <span class="d-flexclmcap5 a-itm-cntr"><em style="margin-right: 3px;"><b>'+ZPI18N.getString("zp.moPortalName")+' : </b> <em  name="portalName">'+portalname+'</em></em><i class="zpl_ibg PI_cpy" title="'+ZPI18N.getString("zp.onb.portal.copylink")+'" onclick=NewCPortal.copyTxtToClipBoard()></i><input type="text" class="valselect" id="cportallink" value="" style="opacity: 0; z-index: -1; position: absolute;"></span> </div>',headerHtml+='<div class="actn_ovrly" id="onbcmpbtn" style="width: 100%;"><div><button id="markascomp" class="zlabel zlabel--blue zlabel--outline zlabel--medium" onclick="OnboardingListing.completebulkonb()" >'+ZPI18N.getString("zp.lms.content.Markascompleted")+"</button>",headerHtml+='<button id="resendInvite" class="zlabel zlabel--blue zlabel--outline zlabel--medium" onclick="NewCPortal.resendInvitation()">'+ZPI18N.getString("zp.resendinv")+"</button>",headerHtml+='<button id="convertcandtoemp-'+tabId+'" class="zlabel zlabel--blue zlabel--outline zlabel--medium drpmenu-js undefined zbutton--menu zbutton zbutton--medium zbutton--normal" type="button"> <span class="zbutton__text">Convert To</span> <i class="zbutton__icon zh-floatright"> <svg class="zbutton__svg zbutton__menuarrow" focusable="false"> <use xlink:href="#zc__svg--downarrow"></use> </svg> </i> <i class="PI_pending blu ML5 DIB rotate-animate DN" id="migrateNonusersLoader"></i> </button>',headerHtml+='<button id="triggerOnboarding" class="zlabel zlabel--blue zlabel--outline zlabel--medium" onclick="NewCPortal.convertToCandidate()" >'+ZPI18N.getString("zp.triggeronboadring")+"</button>",headerHtml+='<div id="convertcandtoempdropdownmenu-'+tabId+'" class="zpl_drpdwn" data-type="list" > ',headerHtml+="<ul></ul></div>",headerHtml+='</div><i class="PI_cls" onclick="OnboardingListing.hideTopbtns()"></i>',headerHtml+="</div>";var contentHtml="";return contentHtml+='<div class="zpl_rgt">',contentHtml+='<button class="zlabel zlabel--blue zlabel--medium" onclick="NewCPortal.getAddUserListPage(\'invite\')" >'+ZPI18N.getString("zp.invitecandidate")+"</button>","candAll"!=listingType&&"candInprogress"!=listingType||(contentHtml+='<i class="zpl_ibg PI_fltr" onclick="OnboardingListing.toggleFilters(false)"></i>'),contentHtml+='<i id="candMoreOption" title="'+ZPI18N.getString("zp.more")+'" class="zpl_ibg PI_more" onclick="CandidateReportListing.candMoreOption()"></i>',contentHtml+="</div></div>",contentHtml+='<div class="zpl_rgtcnt">',contentHtml+='<div class="zpl_tblres">',contentHtml+='<table class="zpl_tbl" id="reportstable">',contentHtml+="<thead>",contentHtml+="<tr>",contentHtml+="<th>",contentHtml+='<div class="zcheckbox">',contentHtml+='<input type="checkbox" name="check" value="" class="zcheckbox__helper" onchange="OnboardingListing.bulkUpdateCheckBox(this)" id="'+tabId+'-Repmasscheckbox">',contentHtml+='<label class="zcheckbox__label" for="'+tabId+'-Repmasscheckbox"></label>',contentHtml+="</div>",contentHtml+="</th>",contentHtml+="<th>"+ZPI18N.getString("zp.candidatename")+'<div class="zpl_icncnt"><i class="PI_arw_btm"></i></div></th>',contentHtml+='<th id="candPhone">'+ZPI18N.getString("zp.mobile")+'<div class="zpl_icncnt"><i class="PI_arw_btm"></i></div></th>',contentHtml+='<th id="candDesg">'+ZPI18N.getString("zp.designation")+'<div class="zpl_icncnt"><i class="PI_arw_btm"></i></div></th>',contentHtml+="<th>"+ZPI18N.getString("zp.status")+'<div class="zpl_icncnt"><i class="PI_arw_btm"></i></div>',contentHtml+="</th>",contentHtml+='<th width="80"></th>',contentHtml+="</tr>",contentHtml+="</thead>",contentHtml+="<tbody>",contentHtml+="</tbody>",contentHtml+="</table>",contentHtml+="</div>",headerHtml+(contentHtml+="</div>")},init:function(){var type=OnboardingListing.currReportPage(),tabId=settingsPage.container.attr("id");if(settingsPage.container.html(),""==CandidateReportListing.portalName&&ZPeople.Request.sendAsyncPost("/onboarding/portal/fetch",{},function(portalData){CandidateReportListing.portalType=portalData.portalType,CandidateReportListing.portalName=portalData.portalName,CandidateReportListing.portalId=portalData.portalName,CandidateReportListing.ZAID=portalData.ZAID,portalData.redirecturl&&(NewCPortal.portalObj.redirecturl=portalData.redirecturl),NewCPortal.portalObj.portalName=portalData.portalName}),0===settingsPage.container.find("[data-tab="+type+"]").length){if(resultData=CandidateReportListing.listingLayoutConstruct(),void 0!==resultData){settingsPage.container.html(resultData);let components=NewCPortal.getAddUserComponents();settingsPage.container.find("#candDesg").html(components.designationname),settingsPage.container.find("#candPhone").html(components.phoneName),OnboardingListing.reportData(void 0,!1),settingsPage.container.find("#convertcandtoemp-"+tabId).on("click",function(){OnboardingListing.convertToCandidateOptions(tabId)})}}else{var data=settingsPage.container.find(".zpl_tpcrdlst").find(".zpl_act");OnboardingListing.reportData(data,!1)}},reportsInit:function(){-1!==Layout.Page.hash.indexOf("operations/onboarding/listing/candAll/reports/id")&&OnboardingListing.viewOnboardingDetails(settingsUrlProps.urlParams)},candMoreOption:function(){var pageId=ZPA_Common.getParentPageId();if(!ZPeopleComponents.isComponent(pageId.find("#candMoreMenu"))){pageId.append('<div id="candMoreMenu"></div>'),ZPeopleComponents.menu(pageId.find("#candMoreMenu"),{appendTo:pageId,contentType:"icon-text",itemclick:CandidateReportListing.candMoreMenuSelect,displayType:"callout"}).addMenuItems([{id:"cand_Imp",label:ZPI18N.getString("zp.import"),iconClass:"PI_imprt"},{id:"cand_Exp",label:ZPI18N.getString("zp.export"),iconClass:"PI_exprt"}])}ZPeopleComponents.menu(pageId.find("#candMoreMenu")).show({forElement:pageId.find("#candMoreOption")})},candMoreMenuSelect:function(event,detail){event.stopPropagation();const action=detail.data.id;"cand_Imp"==action?NewCPortal.getAddUserListPage("import"):"cand_Exp"==action&&CandidateReportListing.exportCandModal()},exportCandModal:function(){void 0!=CandidateReportListing.ExportModal&&(CandidateReportListing.ExportModal.remove(),CandidateReportListing.ExportModal=void 0);const popupTab=new Tab("CandExport",function(){},function(){CandidateReportListing.candExportSave("candExportCard")});popupTab.cardId="candExportCard",CandidateReportListing.ExportModal=new popupModal(ZPI18N.getString("zp.export"),popupTab),CandidateReportListing.ExportModal.save=ZPI18N.getString("zp.export"),CandidateReportListing.ExportModal.construct(),ZPA_Common.getPopUpId(CandidateReportListing.ExportModal).find("#"+popupTab.cardId).append(CandidateReportListing.constructExportModal()),CandidateReportListing.ExportModal.setCloseCallback(function(){CandidateReportListing.ExportModal.remove()})},constructExportModal:function(){var formats=[{id:"exportFileTypexls",value:"xls",label:ZPI18N.getString("zp.xls"),default:!0},{id:"exportFileTypexlsx",value:"xlsx",label:ZPI18N.getString("zp.xlsx")},{id:"exportFileTypecsv",value:"csv",label:ZPI18N.getString("zp.csv")}],cardHtml='<div class="zpl_crd">';return cardHtml+='<div class="zpl_crdcnt" elem="modalBodyContainer">',cardHtml+='<div elem="exportPopupDiv" class="">',cardHtml+='<div class="zpl_Emptydata" elem="exportContainer">',cardHtml+='<div class="zpl_mdexprtimg smll"></div>',cardHtml+='<h4 elem="exportHeader">'+ZPI18N.getString("zp.choosefileformat")+"</h4>",cardHtml+='<div elem="fileTypeDiv" class="zpl_secn">',cardHtml+="<div>",formats.forEach(function(format){cardHtml+='<div class="zradiobutton zradiobutton--horizontal" elem="fileTypeRadio">',cardHtml+='<input type="radio" id="'+format.id+'" value="'+format.value+'" name="exportFileType" class="zradiobutton__helper"',format.default&&(cardHtml+=" checked"),cardHtml+=">",cardHtml+='<label for="'+format.id+'" class="zradiobutton__label">',cardHtml+='<span class="zradiobutton__text">'+format.label+"</span>",cardHtml+="</label>",cardHtml+="</div>"}),cardHtml+="</div>",cardHtml+="</div>",cardHtml+="</div>",cardHtml+="</div>",cardHtml+="</div>",cardHtml+="</div>"},candExportSave:function(popupId){const selectedFormat=$(settingsPage.mainWrapId).find("#"+popupId).find('input[name="exportFileType"]:checked').val();CandidateReportListing.ExportModal.remove(),CandidateReportListing.ExportModal=void 0,OnboardingListing.reportExport(selectedFormat)}},EmployeeReportListing={isFilterEmptyforemp:!0,EmployeeForm:{id:"",name:""},currentFlowType:"",listingLayoutConstruct:function(){var tabId=settingsPage.container.attr("id");settingsPage.container.addClass("zpl_tblfxd");var headerHtml="";headerHtml+='<div class="zpl_btnmnu">',headerHtml+='<div class="actn_ovrly" id="onbcmpbtn" style="width: 100%;"><div><button class="zlabel zlabel--blue zlabel--outline zlabel--medium" onclick="OnboardingListing.completebulkonb()" id="markascomp">'+ZPI18N.getString("zp.lms.content.Markascompleted")+"</button>",headerHtml+='<button class="zlabel zlabel--blue zlabel--outline zlabel--medium" onclick="OnboardingListing.bulkTriggerOnb()" id="triggerOnboarding">'+ZPI18N.getString("zp.triggeronboadring")+"</button>",headerHtml+='</div><i class="PI_cls" onclick="OnboardingListing.hideTopbtns()"></i></div>';var contentHtml="";return contentHtml+='<div class="zpl_rgt">',contentHtml+='<button data-menu-id="reportExportDivdropdownmenu" class="zbutton" data-appearance="primary" id="reportExportDiv" data-popup-open="actionspopup">'+ZPI18N.getString("zp.exportreport")+"</button>",contentHtml+='<ul id="reportExportDivdropdownmenu" style="display:none;" class="zpl_drpdwn">',contentHtml+='<li onclick="OnboardingListing.reportExport(\'csv\')"><a class="addEmp">CSV</a></li>',contentHtml+='<li onclick="OnboardingListing.reportExport(\'xls\')"><a class="addEmp">XLS</a></li>',contentHtml+='<li onclick="OnboardingListing.reportExport(\'xlsx\')"><a class="addEmp">XLSX</a></li>',contentHtml+="</ul>",contentHtml+='<i class="zpl_ibg PI_fltr" onclick="OnboardingListing.toggleFilters(false)"></i>',contentHtml+="</div></div>",contentHtml+='<div class="zpl_rgtcnt">',contentHtml+='<div class="zpl_tblres">',contentHtml+='<table class="zpl_tbl" id="reportstable">',contentHtml+="<thead>",contentHtml+="<tr>",contentHtml+="<th>",contentHtml+='<div class="zcheckbox">',contentHtml+='<input type="checkbox" name="check" value="" class="zcheckbox__helper" onchange="OnboardingListing.bulkUpdateCheckBox(this)" id="'+tabId+'-Repmasscheckbox">',contentHtml+='<label class="zcheckbox__label" for="'+tabId+'-Repmasscheckbox"></label>',contentHtml+="</div>",contentHtml+="</th>",contentHtml+="<th>"+ZPI18N.getString("zp.employeename")+'<div class="zpl_icncnt"><i class="PI_arw_btm"></i></div>',contentHtml+="</th>",contentHtml+="<th>"+ZPI18N.getString("zp.dateofjoining")+'<div class="zpl_icncnt"><i class="PI_arw_btm"></i></div>',contentHtml+="</th>",contentHtml+="<th>"+ZPI18N.getString("zp.designation")+'<div class="zpl_icncnt"><i class="PI_arw_btm"></i></div>',contentHtml+="</th>",contentHtml+="<th>"+ZPI18N.getString("zp.status")+'<div class="zpl_icncnt"><i class="PI_arw_btm"></i></div>',contentHtml+="</th>",contentHtml+='<th width="80"></th>',contentHtml+="</tr>",contentHtml+="</thead>",contentHtml+="<tbody>",contentHtml+="</tbody>",contentHtml+="</table>",contentHtml+="</div>",headerHtml+(contentHtml+="</div>")},init:function(){var type=OnboardingListing.currReportPage();if(settingsPage.container.html(),0===settingsPage.container.find("[data-tab="+type+"]").length)resultData=EmployeeReportListing.listingLayoutConstruct(),void 0!==resultData&&(settingsPage.container.html(resultData),OnboardingListing.reportData(void 0,!1),ZPeopleComponents.menubutton(settingsPage.container.find("#reportExportDiv")));else{var data=settingsPage.container.find(".zpl_tpcrdlst").find(".zpl_act");OnboardingListing.reportData(data,!1)}},reportsInit:function(){EmployeeReportListing.init();let empId=settingsUrlProps.urlParams;OnboardingListing.viewOnboardingDetails(empId)}},ZpOfferAppointment={};ZpOfferAppointment.Config={newSettingsHTML:`\n\t\t<div id="genConfigDiv" class="zpl_rgtcnt">\n    <div class="zpl_crd">\n    <div class="zpl_crdhdr" id="appointmentCard">\n      <div>\n        <h4>${ZPI18N.getString("zp.appointmentLetter")}</h4>\n        <p>${ZPI18N.getString("zp.offer.disableApptltrdesc")}</p>\n        <div class="zpl_hdcnt">\n          <div class="zpl_tgl">\n            <input class="togbutton-js" style="display: none;"  id="appntmntEnable">${ZPI18N.getString("zp.offer.enableAppointment")}\n          </div>\n        </div>\n      </div>\n    </div>\n  </div></div>`,initSettingsPage:async function(configObj){settingsPage.container.append(ZPeople.LOADING_HTML).find("#genConfigDiv").addClass("DNI");let[configResult]=configObj?[configObj]:await Promise.all([ZpOfferAppointment.Config.getConfiguration()]),isOfferEnabled=configResult.isOfferenabled,isAppntmntenabled=configResult.isAppmntenabled;configResult.hasApptLtrAccess&&(!isOfferEnabled&&!isAppntmntenabled||configResult.isOfferDataAdmin)?(settingsPage.container.append(ZpOfferAppointment.Config.newSettingsHTML),ZPeopleComponents.toggleswitch(settingsPage.container.find("#offerEnable"),{on:isOfferEnabled}),ZPeopleComponents.toggleswitch(settingsPage.container.find("#appntmntEnable"),{on:isAppntmntenabled}),ZpOfferAppointment.Config.handlePageEvents(),settingsPage.container.find("#genConfigDiv").removeClass("DNI").siblings("#zp_page_loading").remove()):settingsPage.container.find("#zp_page_loading").remove()},handlePageEvents:function(){settingsPage.container.find("#offerEnable").on("ztoggleswitchchange",function(event){event.detail.fromUI&&ZpOfferAppointment.Config.checkandAddOfferLetter()}),settingsPage.container.find("#appntmntEnable").on("ztoggleswitchchange",function(event){event.detail.fromUI&&ZpOfferAppointment.Config.checkandAddAppointmentLetter()})},getConfiguration:function(){var params={conreqcsr:csrfToken,method:""};const response=Compensation.Utils.sendReqAsPromise("/offersetting/getOnbConfig",params);return Promise.resolve(response)},getLeftTabIndex:function(hash){return Layout.Page.pageContWrapper.find("[name=lefttab]>ul").children(`li[tlhash='${hash}']`).index()},enableDisableOffer:function(isForced){let status=settingsPage.container.find("#offerEnable").prop("checked");var params={conreqcsr:csrfToken,method:"",isEnabled:status,isForced:isForced};const response=Compensation.Utils.sendReqAsPromise("/offersetting/enableDisableOfferSettings",params);return Promise.resolve(response)},enableDisableAppointment:function(isForced){let status=settingsPage.container.find("#appntmntEnable").prop("checked");var params={conreqcsr:csrfToken,method:"",isEnabled:status,isForced:isForced};const response=Compensation.Utils.sendReqAsPromise("/offersetting/enableDisableAppointmentSettings",params);return Promise.resolve(response)},checkandAddOfferLetter:async function(){let status=settingsPage.container.find("#offerEnable").prop("checked");var[response]=await Promise.all([ZpOfferAppointment.Config.enableDisableOffer(!1)]);response=response.result;let Apptstatus=settingsPage.container.find("#appntmntEnable").prop("checked");if(response.hasError||0!=status)if(response.hasError||1!=status){if(response.hasError){const okCallback=function(){ZpOfferAppointment.Config.enableDisableOffer(!0),ZpOfferAppointment.Config.showHideOfrApptTabs(Apptstatus,!1),ZPeople.autosave.success(settingsPage.container.find("#offerCard"),ZPI18N.getString("zp.saved"))},cancelCallback=function(){ZPeopleComponents.toggleswitch(settingsPage.container.find("#offerEnable")).switchOn()};Compensation.Utils.showAlertMsg(2,ZPI18N.getString("zp.offer.offerDisableConfirmationHdr"),ZPI18N.getString("zp.offer.offerDisableConfirmation"),ZPI18N.getString("zp.disable"),void 0,okCallback,cancelCallback)}}else ZpOfferAppointment.Config.showHideOfrApptTabs(Apptstatus,!0),ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.lite.reportsenablesuccess",[ZPI18N.getString("zp.offerletter")]));else ZpOfferAppointment.Config.showHideOfrApptTabs(Apptstatus,!1),ZPeople.autosave.success(settingsPage.container.find("#offerCard"),ZPI18N.getString("zp.saved"))},checkandAddAppointmentLetter:async function(){let status=settingsPage.container.find("#appntmntEnable").prop("checked"),i=0,[configResult]=await Promise.all([ZpOfferAppointment.Config.getConfiguration()]);var[response]=await Promise.all([ZpOfferAppointment.Config.enableDisableAppointment(!1)]);if(i=configResult.isOfferenabled?Layout.Page.pageContWrapper.find("[name=lefttab]").find("li").length:Layout.Page.pageContWrapper.find("[name=lefttab]").find("li a:contains('"+ZPI18N.getString("zp.compensation.SalaryStructure")+"')").parents("li").prevAll("li").length+1,(response=response.result).hasError||0!=status)if(response.hasError||1!=status){if(response.hasError){const okCallback=function(){ZpOfferAppointment.Config.enableDisableAppointment(!0),ZpOfferAppointment.Config.showHideOfrApptTabs(!1,configResult.isOfferenabled),ZPeople.autosave.success(settingsPage.container.find("#appointmentCard"),ZPI18N.getString("zp.saved"))},cancelCallback=function(){ZPeopleComponents.toggleswitch(settingsPage.container.find("#appntmntEnable")).switchOn()};Compensation.Utils.showAlertMsg(2,ZPI18N.getString("zp.offer.appointmentDisableConfirmationHdr"),ZPI18N.getString("zp.offer.appointmentDisableConfirmation"),ZPI18N.getString("zp.disable"),void 0,okCallback,cancelCallback)}}else ZpOfferAppointment.Config.showHideOfrApptTabs(!0,configResult.isOfferenabled),ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.lite.reportsenablesuccess",[ZPI18N.getString("zp.appointmentLetter")]));else ZpOfferAppointment.Config.showHideOfrApptTabs(!1,configResult.isOfferenabled),ZPeople.autosave.success(settingsPage.container.find("#appointmentCard"),ZPI18N.getString("zp.saved"))},showHideCompensationPages:function(isOfferenabled,isAppntEnabled){if(isOfferenabled||isAppntEnabled){if(-1!=ZpOfferAppointment.Config.getLeftTabIndex("settings/service/onboarding/currencies"))return;let tabInd=ZpOfferAppointment.Config.getLeftTabIndex("settings/service/onboarding/employeeflow");-1==tabInd&&-1==(tabInd=ZpOfferAppointment.Config.getLeftTabIndex("settings/service/onboarding/candidateflow"))&&(tabInd=ZpOfferAppointment.Config.getLeftTabIndex("settings/service/onboarding/globalsettings"));let tabArr=[],tabObj={},urlArr=[],urlObj={tabURL:"settings/service/onboarding/currencies"};urlObj.dispName=ZPI18N.getString("zp.currencies"),urlArr.push(urlObj),(urlObj={}).tabURL="settings/service/onboarding/ctccomponents",urlObj.dispName=ZPI18N.getString("zp.compensation.CtcComponents"),urlArr.push(urlObj),(urlObj={}).tabURL="settings/service/onboarding/benefits",urlObj.dispName=ZPI18N.getString("zp.compensation.Benefits"),urlArr.push(urlObj),(urlObj={}).tabURL="settings/service/onboarding/salarypackages",urlObj.dispName=ZPI18N.getString("zp.compensation.SalaryPackages"),urlArr.push(urlObj),tabObj.dispName=ZPI18N.getString("zp.compensation"),tabObj.tabArr=urlArr,tabObj.tabURL="settings/service/onboarding/currencies",tabArr.push(tabObj),settingsPage.addLeftTabs(1,tabInd+1,tabArr)}else{let tabInd=ZpOfferAppointment.Config.getLeftTabIndex("settings/service/onboarding/currencies");settingsPage.removeLeftTab(1,tabInd+1)}},showHideTabs:function(tabObj,tabInd,isRemove=!1){let currTabInd=ZpOfferAppointment.Config.getLeftTabIndex(tabObj.tabURL);if(isRemove)-1!=currTabInd&&(tabInd=currTabInd,settingsPage.removeLeftTab(1,tabInd+1));else{let tabArr=[];-1==currTabInd&&(tabArr.push(tabObj),settingsPage.addLeftTabs(1,tabInd+1,tabArr))}},showHideOfrApptTabs:function(isAppntEnabled,isOfferEnabled){ZpOfferAppointment.Config.showHideCompensationPages(isOfferEnabled,isAppntEnabled);let apt_urlObj={},apt_tabInd=ZpOfferAppointment.Config.getLeftTabIndex("settings/service/onboarding/offerletter/templates");-1==apt_tabInd&&(apt_tabInd=ZpOfferAppointment.Config.getLeftTabIndex("settings/service/onboarding/currencies")),apt_urlObj.tabURL="settings/service/onboarding/appointmentletter/templates",apt_urlObj.dispName=ZPI18N.getString("zp.appointmentLetterTemp"),ZpOfferAppointment.Config.showHideTabs(apt_urlObj,apt_tabInd,!isAppntEnabled)}},ZpOfferAppointment.Perm={admins:[],adminsDetails:[],card:'\t<div class="zpl_crd">\n\t\t\t\t<div class="zpl_crdhdr zpl_rgt">\n\t              <div>\n\t                <h4>Offer Administrators</h4>\n\t                <p>Assign admin for offer and appointment service</p>\n\t              </div>\n\t              <div id="save_reset" style="display: none;" ispagedatachanged="true"><button type="button" id="reset" class="zlabel zlabel--outline zlabel--medium">Reset</button><button type="button" id="save" class="zlabel zlabel--blue zlabel--medium">Save</button></div>\n\t            </div>\n\t\t\t\t<div class="zpl_crdcnt">\n\t              <div>\n\t                <div class="zpl_secn" id="customAdminSection">\n\t                 <div class="zpl_secn" id="chooseAdmin">\n\t             \t \t<div>\n\t                \t\t<h4>select administrator</h4> \n\t              \t\t</div>\n\t              \t<div>\n\t\t\t\t\t\t<textarea id="adminSelector" class="tokenfieldId-js" style="display: none;"></textarea>\n\t              \t</div>\n\t           \t </div>\n\t                </div>\n\t              </div>\n\t            </div>\n\t\t\t</div>',init(){let container=settingsPage.container;container.html(this.card),ZPeopleComponents.isComponent(container.find("#adminSelector"))&&ZPeopleComponents.tokenfield(container.find("#adminSelector")).destroy();let initSel=this.adminsDetails;Compensation.Utils.constructEmpSearchFld("adminSelector","token","ONBOARDING_DATAADMIN",this.handleChanges.bind(this),container,()=>{var extraParams={isSpecificRole:!1,roleName:"Admin"};return extraParams},initSel),container.find("#save_reset").find("button#save").on("click",this.save),container.find("#save_reset").find("button#reset").on("click",this.reset)},listOfferAdmins(){var params={conreqcsr:csrfToken};Compensation.Utils.sendReqAsPromise("/offersetting/permission/read",params).then(resp=>{ZpOfferAppointment.Perm.admins=resp.adminList,ZpOfferAppointment.Perm.adminsDetails=resp.adminsDetails,ZpOfferAppointment.Perm.init.call(ZpOfferAppointment.Perm)})},handleChanges(event){let container=settingsPage.container,eOpt=this.admins,sOpt=ZPeopleComponents.tokenfield(container.find("#adminSelector")).getAllValues().map(x=>x.id);eOpt.length==sOpt.length&&sOpt.every(i=>eOpt.includes(i))?container.find("#save_reset").hide():container.find("#save_reset").show()},reset(){let container=settingsPage.container;ZPeopleComponents.tokenfield(container.find("#adminSelector")).removeAllTokens();let existingOptn=ZpOfferAppointment.Perm.adminsDetails;ZPeopleComponents.tokenfield(container.find("#adminSelector")).addTokens(existingOptn)},save(){let container=settingsPage.container,ids=ZPeopleComponents.tokenfield(container.find("#adminSelector")).getAllValues().map(x=>x.id);var params={conreqcsr:csrfToken,users:JSON.stringify(ids)};Compensation.Utils.sendReqAsPromise("/offersetting/permission/save",params).then(resp=>{ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.offr.adminadded")),container.find("#save_reset").hide()})}},NewCPortal={usersPageElm:'<form id="inviteCandidateForm"> <div class="zpl_crd"> <div class="zpl_crdcnt"> <div class="zpl_hdcnt"> <ul class="zpl_tabpane"> <li id="candsingleInviteTab" class="zpl_act"><a onclick="NewCPortal.toggleSingleMultipleInterface(\'singleCandInvite\')">'+ZPI18N.getString("zp.singleinvite")+'</a> </li> <li id="multipleInviteTab"><a onclick="NewCPortal.toggleSingleMultipleInterface(\'candmultipleInvite\')">'+ZPI18N.getString("zp.multipleinvite")+'</a> </li> </ul> </div><div class="zpl_tabcnt"> <div id="singleCandInvite"><div id="candFirstnameSection" class="zpl_secn"> <div><label class="zpl_mtry">'+ZPI18N.getString("zp.firstname")+'</label></div> <div><input type="text" id="candFname" class="ztextbox"></div> </div> <div id="candLastnameSection" class="zpl_secn"> <div><label class="">'+ZPI18N.getString("zp.lastname")+'</label></div> <div><input type="text" id="candLname" class="ztextbox"></div> </div> <div id="candEmailSection" class="zpl_secn"> <div><label class="zpl_mtry">'+ZPI18N.getString("zp.emailid")+'</label></div> <div><input type="text" id="candMail" class="ztextbox"></div> </div> <div id="candLocSection" class="zpl_secn"> <div><label >'+ZPI18N.getString("zp.location")+'</label></div>  </div><div id="candDesSection" class="zpl_secn"> <div><label >'+ZPI18N.getString("zp.designation")+'</label></div>  </div></div> <div id="candmultipleInvite" class="DN"> <div class="zpl_secn"> <div> <textarea id="candEmails" rows="10" class="ztextbox" placeholder="'+ZPI18N.getString("zp.example")+' michael@zillium.com, sarah@zillium.com, . . ."></textarea> </div> </div> </div> </div> <div id="candOnboardingSection" class="zpl_secn"> <div> <h5>'+ZPI18N.getString("zp.triggeronboadring")+'<i class="IC-info1 tooltip-js" title="Onboarding will be triggered for this record"></i></h5> </div> <div> <div class="zradiobutton zradiobutton--horizontal" > <input type="radio" id="candOnboardingEnable" class="zradiobutton__helper" name="triggercandonb"> <label class="zradiobutton__label" for="candOnboardingEnable"><span class="zradiobutton__text">'+ZPI18N.getString("zp.yes")+'</span></label> </div> <div class="zradiobutton zradiobutton--horizontal" > <input type="radio" id="candOnboardingDisable" class="zradiobutton__helper" name="triggercandonb" checked="checked"> <label class="zradiobutton__label" for="candOnboardingDisable"><span class="zradiobutton__text">'+ZPI18N.getString("zp.no")+"</span></label> </div> </div> </div> </div> </div> </form>",User:{},portalObj:{},currentPortalZAID:"",type:"",filter:{},CandLength:0,candformId:"",portalType:"PREONBOARDING",candidatesList:{},passwordtype:0,isautogenpassword:!1,addUserComponents:void 0},NewCPortal.candidatesMethod={GETCLIST:"getCandidatesList",GETADDCDETAILS:"getAddCandidateDetails",ADDCANDIDATE:"addCandidate",BULKINVITE:"bulkInviteCandidates",RESENDINVITATON:"resendInvitation",CHANGELOGINSTATUS:"changeLoginStatus",CONVERTTOCANDIDATE:"convertToCandidate"},NewCPortal.candidateURLS={CPORTALURL:"/onboarding/portal/fetch",CANDIDATEACTIONURL:"/CandidateAction.zp",ADDPORTALURL:"/onboarding/portal/add",UPDATEPORTALURL:"/onboarding/portal/update"},NewCPortal.getTemplateMappingdata=function(zp_type){NewCPortal.currentzptype=zp_type;var tab=new Tab;tab.id="fieldMapDiv",tab.cardId="candtoempmapping";var mappingslider=new sliderModal(ZPI18N.getString("zp.onboardingmap"),tab);mappingslider.largeSize=!0,mappingslider.construct(),$("#fieldMapDiv").find("#candtoempmapping").html(ZPeople.LOADING_HTML),ZPeople.Request.send("/onboarding/settings/mappedFields",{},NewCPortal.createTemplateMapping)},NewCPortal.createTemplateMapping=function(data){var righthtml='<div><div id="fieldMapRht"><div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div>'+ZPI18N.getString("zp.onbsettingsmap")+"</div>";righthtml+='<div class="zpl_colpanelfields" data-toggle-button-position="right">';var mappings=data.mappings,isautogenDN="",autogenopt="",mappasswordopt="checked";for(NewCPortal.isautogenpassword=data.ispasswordautogen,data.ispasswordautogen&&(autogenopt="checked",mappasswordopt="",isautogenDN="DN"),righthtml+="</div></div></div></div></div></div>",$("#fieldMapDiv").find("#candtoempmapping").html(righthtml),righthtml="",NewCPortal.candcol=data.Candcol,i=0;i<data.Empcol.length;i++){var rtemphtml="",candsec=data.Empcol[i].isTabular?data.Candcol.TABULARSECTION:data.Candcol.NONTABULARSECTION,html=NewCPortal.templateFields(data.Empcol[i].col1Fields,candsec,mappings);rtemphtml+="<div>"+html,0==i&&(rtemphtml+='<div class="zpl_secn zpl_addlds" lname="password"><div><label>'+ZPI18N.getString("zp.passwd")+"</label></div>",rtemphtml+='<div><div class="d-flexclmcap"><div class="zradiobutton"><input onchange="NewCPortal.toggAutoGenPwd(this)" id="autogenPassword" type="radio" name="autogenpassworddiv" value="" class="zradiobutton__helper" '+autogenopt+'><label for="autogenPassword" class="zradiobutton__label"><span class="zradiobutton__text">Use auto generated password</span> </label></div>',rtemphtml+='<div class="zradiobutton"><input onchange="NewCPortal.toggAutoGenPwd(this)" id="passwordradio" type="radio" name="autogenpassworddiv" value="" class="zradiobutton__helper" '+mappasswordopt+'><label for="passwordradio" class="zradiobutton__label"><span class="zradiobutton__text">'+ZPI18N.getString("zp.selectfieldfromcand")+"</span> </label></div>",rtemphtml+='<div class="'+isautogenDN+'" id="passwordmapselect"><select>'+NewCPortal.selectOptions(data.Candcol.NONTABULARSECTION,FormConstants.FieldType.TEXT,void 0,mappings&&void 0!=mappings.password?mappings.password:void 0,!0)+"</select></div>",rtemphtml+="</div></div></div>"),rtemphtml+="</div>",rtemphtml+="<div>"+(html=NewCPortal.templateFields(data.Empcol[i].col2Fields,candsec,mappings))+"</div>",righthtml=righthtml+'<div class="zpl_collapsepanel" id="Sec-'+data.Empcol[i].id+'"><div class="zpl_collapseheader"><b>'+data.Empcol[i].name+'</b><div class="zpl_collaspeactions"></div></div><div class="zpl_collapsecontent zpl_frmclm zpl_frmclmview" style="display: flex;">'+rtemphtml+"</div></div>"}$("#fieldMapDiv").find(".zpl_colpanelfields").append(righthtml),ZPeopleComponents.select($("#fieldMapDiv").find("select"),{showSearchField:!0}),ZPeopleComponents.collapsiblepanels($("#fieldMapDiv").find(".zpl_colpanelfields")),$("#fieldMapDiv").find("#sliderSbt").off("click").on("click",function(){NewCPortal.saveTemplate()})},NewCPortal.templateFields=function(coldata,candsec,mappings){var html="";for(j=0;j<coldata.length;j++){var map=mappings&&void 0!=mappings[coldata[j].lname]?mappings[coldata[j].lname]:void 0,ismantry="",star="";if("EmailID"===coldata[j].lname)ismantry='class="mantry"',star="*";else if("EMPIDGENRULECODE"===coldata[j].lname)continue;$.inArray(coldata[j].lname,["FirstName","LastName"]);html+='<div class="zpl_secn" lname="'+coldata[j].lname+'" isMandatory='+coldata[j].isMandatory+"><div><label "+ismantry+">"+star+coldata[j].name+'</label></div><div id="onbselectmap"><select>'+NewCPortal.selectOptions(candsec,coldata[j].c_type,coldata[j].s_type,map,void 0,coldata[j].lname)+"</select></div></div>"}return html},NewCPortal.selectTemplateFields=function(type,id){var pageid=$("#fieldMapDiv");if("SecType"==type){var excludefields='[lname="FirstName"],[lname="EmailID"]';"true"==pageid.find("#fieldMapLft").find('[lname="LastName"]').attr("ismandatory")&&(excludefields+=',[lname="LastName"]');var leftsecdiv=pageid.find("#fieldMapLft").find("#"+id),rightsecdiv=pageid.find("#fieldMapRht").find("#"+id);if(leftsecdiv.find("#leftsec").find("input[type='checkbox']").is(":checked")){rightsecdiv.removeClass("DN");var candsec=$(leftsecdiv).attr("istabular")&&"true"==$(leftsecdiv).attr("istabular")?NewCPortal.candcol.TABULARSECTION:NewCPortal.candcol.NONTABULARSECTION;$.each($(leftsecdiv).find("table").find("input:checkbox:not(:checked)"),function(index,elm){$(elm).prop("checked",!0),elm=$(elm).closest("td");var html='<div class="zpl_secn" lname="'+$(elm).attr("lname")+'" isMandatory='+$(elm).attr("isMandatory")+"><div><label>"+$(elm).find("label").text()+'</label></div><div id="onbselectmap"><select>'+NewCPortal.selectOptions(candsec,$(elm).attr("c_type"),$(elm).attr("s_type"),void 0,void 0,$(elm).attr("lname"))+"</select></div></div>";rightsecdiv.find(".zpl_collapsecontent").append(html)})}else leftsecdiv.find("table").find("input[type='checkbox']").prop("checked",!1),0==rightsecdiv.find(excludefields).length?(rightsecdiv.find(".zpl_secn").remove(),rightsecdiv.addClass("DN")):rightsecdiv.find(".zpl_secn").not(excludefields).remove()}else{var leftfielddiv=pageid.find("#fieldMapLft").find('[lname="'+id+'"]');if(leftfielddiv.find("input[type='checkbox']").is(":checked")){candsec=leftfielddiv.closest("[id^=Sec-]").attr("istabular")&&"true"==leftfielddiv.closest("[id^=Sec-]").attr("istabular")?NewCPortal.candcol.TABULARSECTION:NewCPortal.candcol.NONTABULARSECTION;0==leftfielddiv.closest("tbody").find("input:checkbox:not(:checked)").length&&leftfielddiv.closest("[id^=Sec-]").find("#leftsec").find("input[type='checkbox']").prop("checked",!0);var html='<div class="zpl_secn" lname="'+leftfielddiv.attr("lname")+'" isMandatory='+leftfielddiv.attr("isMandatory")+"><div><label>"+leftfielddiv.find("label").text()+'</label></div><div id="onbselectmap"><select>'+NewCPortal.selectOptions(candsec,leftfielddiv.attr("c_type"),leftfielddiv.attr("s_type"),void 0,void 0,leftfielddiv.attr("lname"))+"</select></div></div>",secid=leftfielddiv.closest("[id^=Sec-]").attr("id"),index=leftfielddiv.closest("tbody").find("input:checked").closest("[lname]").index(leftfielddiv);pageid.find("#fieldMapRht").find("#"+secid).removeClass("DN"),0==index?pageid.find("#fieldMapRht").find("#"+secid).find(".zpl_collapsecontent").prepend(html):pageid.find("#fieldMapRht").find("#"+secid).find(".zpl_collapsecontent").find(".zpl_secn:nth-of-type("+index+")").after(html)}else leftfielddiv.closest("[id^=Sec-]").find("#leftsec").find("input[type='checkbox']").prop("checked",!1),0==leftfielddiv.closest("tbody").find("input:checked").length&&pageid.find("#fieldMapRht").find('[lname="'+id+'"]').closest("[id^=Sec-]").addClass("DN"),pageid.find("#fieldMapRht").find('[lname="'+id+'"]').remove()}ZPeopleComponents.select($("#fieldMapDiv").find("select"),{showSearchField:!0})},NewCPortal.saveTemplate=function(){var pageid=$("#fieldMapDiv").find("#fieldMapRht"),mandfields=["FirstName","EmailID"];"true"==pageid.find('[lname="LastName"]').attr("ismandatory")&&(mandfields[3]="LastName");var mappings={},error=!1;if($(pageid).find(".err").removeClass("err"),$(pageid).find(".errDiv").remove(),$.each($(pageid).find("[lname]"),function(index,elm){var key=$(elm).attr("lname"),val=ZPeopleComponents.select($(elm).find("select")).getValue();mappings[key]=val,$.inArray(key,mandfields)>-1&&(!val||"-1"==val)&&(error=!0,$(elm).find("div").addClass("err"),$(elm).find("#onbselectmap").append('<div class="errDiv red">'+ZPI18N.getString("zp.MandatoryFieldMap")+"</div>"))}),!error){var params={mappingsObj:JSON.stringify(mappings),ispswdautogen:NewCPortal.isautogenpassword};ZPeople.Request.send("/onboarding/settings/saveMappedFields",params,NewCPortal.handleresultofsaveTemp)}},NewCPortal.handleresultofsaveTemp=function(data){data.isSuccess&&($("#fieldMapDiv #sliderCancel").trigger("click"),ZPeople.Message.success(ZPI18N.getString("zp.updatesuccessful")))},NewCPortal.tempAct=function(obj){var pageId=$("#ZPconvert").find("#PasswordInput");"newPassword"==obj.id?(pageId.find("#newPassword").removeClass("DN"),pageId.find(".zselectbox").hide(),NewCPortal.passwordtype=1):(pageId.find("#newPassword").addClass("DN"),pageId.find(".zselectbox").show(),NewCPortal.passwordtype=0)},NewCPortal.toggAutoGenPwd=function(obj){pagid=$("#fieldMapDiv").find("#fieldMapRht").find('[lname="password"]'),"autogenPassword"==obj.id?(pagid.find("#passwordmapselect").addClass("DN"),NewCPortal.isautogenpassword=!0):(pagid.find("#passwordmapselect").removeClass("DN"),NewCPortal.isautogenpassword=!1)},NewCPortal.selectOptions=function(data,c_type,s_type,mapping,isUniquemand,emplname){var selectBuf="<option value='-1'>-- "+ZPI18N.getString("zp.select")+" --</option>";return $.each(data,function(key,value1){selectBuf+="<optgroup label='"+value1.name+"'>"+value1.name,$.each(value1.colFields,function(key,value){var selc="";value.lname==mapping&&(selc='selected="selected"'),c_type!==FormConstants.FieldType.TEXT&&c_type!==FormConstants.FieldType.TEXT_AREA||value.c_type===FormConstants.FieldType.LOOKUP||value.c_type===FormConstants.FieldType.IMAGE||value.c_type===FormConstants.FieldType.FILE_UPLOAD||37===value.c_type?c_type!=FormConstants.FieldType.DECIMAL||value.c_type!=FormConstants.FieldType.NUMBER&&value.c_type!=FormConstants.FieldType.DECIMAL?c_type==value.c_type&&(c_type==FormConstants.FieldType.LOOKUP?emplname&&("Entity"==emplname&&"CandidateEntity"==value.lname||"Business_unit"==emplname&&value.lname==emplname||"Division"==emplname&&"CandidateDivision"==value.lname||"Department"==emplname&&"CandidateDepartment"==value.lname)?selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>":(!emplname||-1==$.inArray(emplname,["Entity","Division","Business_unit"])&&-1==$.inArray(value.lname,["CandidateEntity","CandidateDivision","Business_unit"]))&&(s_type==FormConstants.FieldType.SINGLE_SELECT&&value.s_type==s_type?selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>":s_type==FormConstants.FieldType.MULTI_SELECT&&(selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>")):c_type==FormConstants.FieldType.PICKLIST?s_type==FormConstants.FieldType.SINGLE_SELECT&&value.s_type==s_type?selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>":s_type==FormConstants.FieldType.MULTI_SELECT&&(selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>"):selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>"):selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>":isUniquemand?value.isUnique&&value.isMandatory&&(selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>"):selectBuf+="<option value='"+value.lname+"' "+selc+">"+value.name+"</option>"}),selectBuf+="</optgroup>"}),selectBuf},NewCPortal.getAddUserListPage=function(type){NewCPortal.currentPortalZAID||$.ajax({type:"POST",async:!1,url:NewCPortal.candidateURLS.CPORTALURL,data:{conreqcsr:csrfToken},success:function(data){NewCPortal.currentPortalZAID=data.ZAID,NewCPortal.portalObj=data}}),void 0!=type&&(NewCPortal.type=type,"invite"===type?NewCPortal.addUserModal(NewCPortal.getAddUserComponents()):"import"===type&&(ZPeople.ISUNCONFIRMEDACC?ZPeople.showErrorMessageForUnconfirmedAcc():NewCPortal.importUser(NewCPortal.getAddUserComponents())))},NewCPortal.getAddUserComponents=function(){return ZPA_Common.isNotNull(NewCPortal.addUserComponents)||ZPeople.Request.sendAsyncPost("/onboarding/candidate/components",{},function(data){NewCPortal.addUserComponents=data}),NewCPortal.addUserComponents},NewCPortal.addUserModal=function(data){ZPA_Common.isNotNull(data)||(data=NewCPortal.addUserComponents);var popupName=ZPI18N.getString("zp.invitecandidate"),popupTab=new Tab;popupTab.id="candaddmodal",popupTab.cardId="candadddiv",popupTab.name="cmodal";var tabModal=new sliderModal(popupName,popupTab);tabModal.save=ZPI18N.getString("zp.invite"),tabModal.construct();var slider=tabModal.sliderDiv.find("#candadddiv");if(slider.html(NewCPortal.usersPageElm),slider.find("#candFirstnameSection").find("label").html(data.firstname),slider.find("#candLastnameSection").find("label").html(data.lastname),data.isLnameMandatory&&slider.find("#candLastnameSection").find("label").addClass("zpl_mtry"),slider.find("#emailIdParentElm").find("label").html(data.emailname),void 0!=data.locationDetails){slider.find("#candLocSection").removeClass("DN"),slider.find("#candLocSection").find("label").html(data.locationname);var locSelDiv='<div><select  keyname="locid" id="candlocsel">';locSelDiv+="</select></div>",slider.find("#candLocSection").append(locSelDiv);let params=[];$.isEmptyObject(data.locationDetails)||(params=Object.keys(data.locationDetails).map(loc=>({id:data.locationDetails[loc].recID,value:ZPeople.decodeTxt(data.locationDetails[loc].recName)}))).splice(0,0,{id:"null",value:ZPI18N.getString("zp.select")});let tokenObj={showSearchField:!0,options:params,selectedValue:"",randomDropdownListId:!0,contentType:"text",dataMapping:{label:"value",informativeText:"value",value:"id"},dropdownList:NewZPOnboarding.dropdownOptions};ZPeopleComponents.select(slider.find("#candLocSection").find("#candlocsel"),tokenObj)}else slider.find("#candLocSection").addClass("DN");if(void 0!=data.designationDetails){slider.find("#candDesSection").removeClass("DN"),slider.find("#candDesSection").find("label").html(data.designationname);var desSelDiv='<div><select keyname="desid" id="canddessel">';desSelDiv+="</select></div>",slider.find("#candDesSection").append(desSelDiv);let params=[];$.isEmptyObject(data.designationDetails)||(params=Object.keys(data.designationDetails).map(des=>({id:data.designationDetails[des].recID,value:ZPeople.decodeTxt(data.designationDetails[des].recName)}))).splice(0,0,{id:"null",value:ZPI18N.getString("zp.select")});let tokenObj={showSearchField:!0,options:params,selectedValue:"",randomDropdownListId:!0,contentType:"text",dataMapping:{label:"value",informativeText:"value",value:"id"},dropdownList:NewZPOnboarding.dropdownOptions};ZPeopleComponents.select(slider.find("#candDesSection").find("#canddessel"),tokenObj)}else slider.find("#candDesSection").addClass("DN");tabModal.footerDiv.find("#sliderSbt").on("click",function(){NewCPortal.addUser()}),tabModal.footerDiv.find("#sliderCancel").on("click",function(){NewCPortal.destroyComponentsAndRemoveModal(slider,tabModal)}),tabModal.headerDiv.find("#sliderCls").on("click",function(){NewCPortal.destroyComponentsAndRemoveModal(slider,tabModal)}),slider.find("#candOnboardingEnable, #candOnboardingDisable").on("click",function(){NewCPortal.updateSubmitButtonText(slider,tabModal)}),NewCPortal.updateSubmitButtonText(slider,tabModal)},NewCPortal.updateSubmitButtonText=function(slider,tabModal){slider.find("#candOnboardingEnable").is(":checked")?tabModal.footerDiv.find("#sliderSbt").text(ZPI18N.getString("zp.invite")):tabModal.footerDiv.find("#sliderSbt").text(ZPI18N.getString("zp.add"))},NewCPortal.destroyComponentsAndRemoveModal=function(slider,tabModal){ZPeopleComponents.select(slider.find("#candLocSection").find("#candlocsel")).destroy(),ZPeopleComponents.select(slider.find("#candDesSection").find("#canddessel")).destroy(),tabModal.remove()},NewCPortal.toggleSingleMultipleInterface=function(type){const modal=settingsPage.container.find("#candaddmodal").find("#candadddiv");"singleCandInvite"==type?(modal.find("#singleCandInvite").removeClass("DN"),modal.find("#candmultipleInvite").addClass("DN"),modal.find("#candsingleInviteTab").addClass("zpl_act"),modal.find("#multipleInviteTab").removeClass("zpl_act")):(modal.find("#singleCandInvite").addClass("DN"),modal.find("#candmultipleInvite").removeClass("DN"),modal.find("#candsingleInviteTab").removeClass("zpl_act"),modal.find("#multipleInviteTab").addClass("zpl_act"))},NewCPortal.addUser=function(){var bodyDiv=Layout.Page.container.find("#candaddmodal").find("#candadddiv");NewZPOnboarding.removeErrorSpan(bodyDiv);var isError=!1;if(bodyDiv.find("#candOnboardingEnable").is(":checked")&&ZPeople.ISUNCONFIRMEDACC)ZPeople.showErrorMessageForUnconfirmedAcc();else if(bodyDiv.find("#candsingleInviteTab").hasClass("zpl_act")){var params={ZAID:NewCPortal.currentPortalZAID,type:2};let candLastnameMndtry=Layout.Page.container.find("#candLastnameSection").find("label").hasClass("zpl_mtry");$.each(bodyDiv.find("input[id]"),function(){var keyname=$(this).attr("id");if("candOnboardingEnable"!==keyname&&"candOnboardingDisable"!==keyname){var keyval=$(this).val();if(params[keyname]=null!=keyval?keyval.trim():keyval,null!=keyval&&0==keyval.trim().length){isError=!0;var errorDiv=$(this).closest("div");"candFname"===keyname?NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.entercandfname"),errorDiv):"candLname"===keyname&&candLastnameMndtry?NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.entercandlname"),errorDiv):NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.entermailid"),errorDiv)}if(null!=keyval&&0!=keyval.trim().length&&"candMail"===keyname&&!NewCPortal.isValidEmail(keyval)){isError=!0;errorDiv=$(this).closest("div");NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.entermailid"),errorDiv)}}}),$.each(bodyDiv.find("select[id]"),function(){var keyname=$(this).attr("keyname"),keyval=ZPeopleComponents.select($(this)).getValue();ZPUtil.Validation.isEmpty(keyval)||(params[keyname]=keyval)}),params.obEnable=bodyDiv.find("#candOnboardingEnable").is(":checked"),isError||($("#candaddmodal").find("#sliderSbt").addClass("disabled"),ZPeople.Request.send("/onboarding/candidate/add",params,NewCPortal.userAddResponse,{},NewCPortal.singleInviteFailureCallBack))}else{var bulkMailIds=bodyDiv.find("#candEmails").val(),bulkEmailIdparentElm=bodyDiv.find("#candEmails").parent();if(ZPSetupCommon.isEmpty(bulkMailIds.trim()))NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.specifyemailids"),bulkEmailIdparentElm);else{var mailIdList=bulkMailIds.split(","),errorList=[],validMailIdsList=[];0===mailIdList.length?NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.validemail"),bulkEmailIdparentElm):($.each(mailIdList,function(index,mailId){mailId=mailId.trim(),ZPSetupCommon.isEmpty(mailId)||(NewCPortal.isValidEmail(mailId)?-1!==validMailIdsList.indexOf(mailId)?(NewZPOnboarding.errorSpanAttach(mailId+" - "+ZPI18N.getString("zp.duplicatmailid"),bulkEmailIdparentElm),errorList.push(mailId)):validMailIdsList.push(mailId):(NewZPOnboarding.errorSpanAttach(mailId+" - "+ZPI18N.getString("zp.invalidemail"),bulkEmailIdparentElm),errorList.push(mailId)))}),0===errorList.length&&($("#candaddmodal").find("#sliderSbt").addClass("disabled"),ZPeople.Request.send("/onboarding/candidate/bulkInvite",{multiEmailIds:JSON.stringify(validMailIdsList),ZAID:NewCPortal.currentPortalZAID,obEnable:bodyDiv.find("#candOnboardingEnable").is(":checked")},NewCPortal.handleResponseOfBulkInivteCandidate,{},NewCPortal.failureCallBack)))}}},NewCPortal.importUser=function(data){ZP5Import.init("candidate")},NewCPortal.isValidEmail=function(value){return/^\w+((-\w+)|(\.\w+)|(\+\w+)|(\'\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test($.trim(value))},NewCPortal.userAddResponse=function(data,params){ZPSetupCommon.isEmpty(data.error)?ZPSetupCommon.isEmpty(data.success)?ZPSetupCommon.isEmpty(data.iamerror)?ZPSetupCommon.isEmpty(data.exception)||ZPeople.Message.failure(data.exception):ZPeople.Message.failure(data.iamerror):($("#candaddmodal").find("#sliderCancel").trigger("click"),params.method==NewCPortal.candidatesMethod.RESENDINVITATON?(settingsPage.container.find("#onbcmpbtn").removeClass("opn"),settingsPage.container.find("input[type='checkbox']").prop("checked",!1)):OnboardingListing.reloadData(),ZPeople.Message.success(data.success)):$.each(data.error,function(key,errMsg){"otherErrors"==key?ZPeople.Message.warning(errMsg):"notAllowed"!==key?"emailIdParentElm"==key?NewZPOnboarding.errorSpanAttach(errMsg,$("#candaddmodal").find("#candadddiv").find("#candMail").parent()):"empLocAuthErr"==key&&ZPeople.Message.failure(errMsg):ZPeople.Message.failure(errMsg)}),$("#candaddmodal").find("#sliderSbt").removeClass("disabled")},NewCPortal.handleResponseOfBulkInivteCandidate=function(data){bulkEmailIdBoxElm=$("#candaddmodal").find("#candEmails");var bulkEmailIdparentElm=bulkEmailIdBoxElm.parent();if(ZPSetupCommon.isEmpty(data.result)){var idCount=0;if(ZPSetupCommon.isEmpty(data.exception))if(ZPSetupCommon.isEmpty(data.noOrgAdmin))if(ZPSetupCommon.isEmpty(data.iamerror))$.each(data.error,function(mailId,error){idCount++,NewZPOnboarding.errorSpanAttach(mailId+" - "+error+"<br>",bulkEmailIdparentElm,"dverrormsg","duplicate"+idCount)});else{var emaiidlist="";$.each(data.iamerror,function(index1,json){var message="";message="invalidcharerror"==index1?ZPI18N.getString("zp.invalidcharincandemail"):"spamerror"==index1?ZPI18N.getString("zp.spamcandemail"):ZPI18N.getString("zp.problemwhileaddingcand"),$.each(json,function(index2,emailid){idCount++,NewZPOnboarding.errorSpanAttach(emailid+" - "+message+"<br>",bulkEmailIdparentElm,"dverrormsg"),emaiidlist+=ZPeople.decodeTxt(emailid)+","})}),emaiidlist=emaiidlist.substr(0,emaiidlist.length-1),bulkEmailIdBoxElm.val(emaiidlist),OnboardingListing.reloadData()}else ZPeople.Message.failure(data.noOrgAdmin);else ZPeople.Message.failure(data.exception);$("#candaddmodal").find("#sliderSbt").removeClass("disabled")}else $("#candaddmodal").find("#sliderCancel").trigger("click"),OnboardingListing.reloadData(),ZPeople.Message.success(data.result)},NewCPortal.singleInviteFailureCallBack=function(data){var bodyDiv=$("#candaddmodal").find("#candadddiv");"MORE_THAN_MAX_LENGTH"==(data=data.responseJSON).code?(ZPeople.Message.failure("Failed to add candidate"),$.each(bodyDiv.find("input[id]"),function(){var keyname=$(this).attr("id"),errorDiv=$(this).closest("div");"candFname"===data.paramName&&"candFname"===keyname?NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.candfnamemaxlengtherror"),errorDiv):"candLname"===data.paramName&&"candLname"===keyname&&NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.candlnamemaxlengtherror"),errorDiv)})):"PATTERN_NOT_MATCHED"==data.code&&(ZPeople.Message.failure("Failed to add candidate"),$.each(bodyDiv.find("input[id]"),function(){var keyname=$(this).attr("id"),errorDiv=$(this).closest("div");("candFname"===data.paramName&&"candFname"===keyname||"candLname"===data.paramName&&"candLname"===keyname)&&NewZPOnboarding.errorSpanAttach(ZPI18N.getString("zp.entervalidinput"),errorDiv)})),$("#candaddmodal").find("#sliderSbt").removeClass("disabled")},NewCPortal.bulkInviteFailureCallBack=function(){$("#candaddmodal").find("#sliderSbt").removeClass("disabled")},NewCPortal.convertToCandidate=function(candidateid){if(ZPeople.ISUNCONFIRMEDACC)ZPeople.showErrorMessageForUnconfirmedAcc();else{if(NewCPortal.portalObj.ZAID||$.ajax({type:"POST",async:!1,url:NewCPortal.candidateURLS.CPORTALURL,data:{conreqcsr:csrfToken},success:function(data){NewCPortal.currentPortalZAID=data.ZAID,NewCPortal.portalObj=data}}),!ZPA_Common.isNotNull(NewCPortal.portalObj.ZAID))return void ZPeople.Message.failure(ZPI18N.getString("zp.candportalnotcreated",["#settings/service/onboarding/candidateflow"]));if(!ZPA_Common.isNotNull(NewCPortal.portalObj.ZAID))return void ZPeople.Message.failure(ZPI18N.getString("zp.candportalnotcreated",["#settings/service/onboarding/candidateflow"]));var params={ZAID:NewCPortal.portalObj.ZAID,portalType:NewCPortal.portalObj.portalType},pkIds=[];candidateid?(params.formId=NewZPPreboarding.candidateFormId,pkIds[0]=candidateid):window.location.hash.indexOf("#operations/onboarding/listing/cand")>=0?($.each($(settingsPage.container).find("#reportstable tbody").find("input[type='checkbox']:checked"),function(index,elm){pkIds[index]=$(elm).closest("tr").attr("id")}),params.formId=NewZPPreboarding.candidateFormId):(candTableEle=settingsPage.container.find(".zpl_tbl"),$.each(candTableEle.find("tbody input:checked"),function(index,obj){pkIds[index]=$(this).closest("tr").attr("id")}),params.formId=ZP5Views.CURR_VIEWPARAMS.formId),params.candidateIds=JSON.stringify(pkIds),ZPeople.Request.send("/onboarding/candidate/triggerOnboarding",params,NewCPortal.convertCandidateResponse)}},NewCPortal.convertCandidateResponse=function(data){if(void 0!=data.msg)data.msg==zpconst.CommonMessages.SUCCESSMSG?(ZPeople.Message.success(ZPI18N.getString("zp.onboardingtriggered")),window.location.hash.indexOf("#operations/onboarding/listing/cand")>=0?OnboardingListing.reloadData():ZP5Views.refreshview(!0)):ZPeople.Message.warning(data.msg);else if(data.hasOwnProperty("onbtriggeredalready")||data.hasOwnProperty("onbcanttriggerforsample")||data.hasOwnProperty("exceptionList")||data.hasOwnProperty("invalidcharerror")||data.hasOwnProperty("spamerror")){var html='<div class="obflow">';$.each(data,function(index1,msgobj){html+='<p class="pspace">',"onbtriggeredalready"==index1?html+=ZPI18N.getString("zp.onbalreadytriggered"):"onbcanttriggerforsample"==index1?html+=ZPI18N.getString("zp.onbcanttriggerforsample"):"exceptionList"==index1?html+=ZPI18N.getString("zp.problemwhiletriggercand"):"invalidcharerror"==index1?html+=ZPI18N.getString("zp.invalidcharincandemail"):"spamerror"==index1&&(html+=ZPI18N.getString("zp.spamcandemail")),html+="</p>",html+='<div class="pspace">',$.each(msgobj,function(index2,emailid){html+="<span>"+emailid+"</span>"}),html+="</div>"}),FrameworkCommon.showInfoAlert(ZPI18N.getString("zp.onbnottriggeredreasonscand"),html)}else ZPSetupCommon.isEmpty(data.exception)?ZPeople.Message.warning(ZPI18N.getString("zp.sorryservererror")):ZPeople.Message.failure(data.exception);Layout.Page.hash.includes("operations/onboarding/candidate/list")&&ZP5Views.getCurrViewObj().showRecordActions(),settingsPage.container.find("div#usersOptions").addClass("DN"),settingsPage.container.find("div#onbcmpbtn").removeClass("opn")},NewCPortal.resendInvitation=function(candid){NewCPortal.currentPortalZAID||$.ajax({type:"POST",async:!1,url:NewCPortal.candidateURLS.CPORTALURL,data:{conreqcsr:csrfToken},success:function(data){NewCPortal.currentPortalZAID=data.ZAID,NewCPortal.portalObj=data}});var callback=NewCPortal.userAddResponse,candids=[];void 0!=candid?candids[0]=candid:$.each($(settingsPage.container).find("#reportstable tbody").find("tr[status='2'] input[type='checkbox']:checked"),function(index,elm){candids[index]=$(elm).closest("tr").attr("id")}),candids=JSON.stringify(candids),ZPeople.Request.send("/onboarding/candidate/resendInvitation",{candidateids:candids,ZAID:NewCPortal.currentPortalZAID,method:NewCPortal.candidatesMethod.RESENDINVITATON},callback)},NewCPortal.coverttoEmp=function(){var pageId=settingsPage.container,tabId=settingsPage.container.attr("id"),type="",html="",link=window.location.href,requesturl=link.indexOf("operations/onboarding/listing/cand")>-1||3==ZP5Form.getCurrFormsOperation().getFormsDetailsMap().addPerm?"/convertCandToDirectEmp.zp":"/users/getAddUserPage",isexcludeinvite=!1;$.ajax({type:"POST",async:!1,url:requesturl,data:{method:"getAddUserListPage",mode:"user",conreqcsr:csrfToken,isobconv:!0},success:function(data){data.pageStatus==User.allowToAddUserDirectly&&(type=1,isexcludeinvite=data.isexcludeinvite)}}),html="<ul>",isexcludeinvite||(html+='<li onclick="NewCPortal.submitMapping()">'+ZPI18N.getString("zp.inviteuser")+"</li>"),1==type&&(html+='<li onclick="NewCPortal.submitMapping(1)">'+ZPI18N.getString("zp.addusers")+"</li>"),html+='<li onclick="NewCPortal.submitMapping(9)">'+ZPI18N.getString("zp.employeeProfile(s)")+"</li>",html+="</ul>",link.indexOf("operations/onboarding/listing/cand")>-1?pageId.find("#convertcandtoempdropdownmenu-"+tabId).append(html):$("#convertcandtoempdropdownmenu").append(html)},NewCPortal.submitMapping=function(currentzptype,isfromtemplate){var candids=[];let tabId=settingsPage.container.attr("id");NewCPortal.currentzptype=currentzptype;var isAddAddUserDirectly=NewCPortal.currentzptype==User.allowToAddUserDirectly,mappings={};if(isfromtemplate)if(NewCPortal.passwordtype){if(mappings.password=$("#ZPconvert").find("#PasswordInput #newPassword").val(),0==mappings.password.trim().length)return $("#ZPconvert").find("#PasswordInput #newPassword").closest("div").append(jQuery("<div />",{class:"errDiv red"}).append(ZPI18N.getString("zp.passwordempty"))),void $("#ZPconvert").find("#step2Next").attr("disabled",!1)}else if(mappings.password=$("#ZPconvert").find("#PasswordInput #chsPassword").val(),0==mappings.password.trim().length||"-1"==mappings.password.trim())return $("#ZPconvert").find("#PasswordInput #chsPassword").closest("div").append(jQuery("<div />",{class:"errDiv red"}).append(ZPI18N.getString("zp.MandatoryFieldMap"))),void $("#ZPconvert").find("#step2Next").attr("disabled",!1);window.location.href.indexOf("operations/onboarding/listing/cand")>-1?(isfromtemplate||ZPeopleComponents.menu("#convertcandtoempdropdownmenu-"+tabId).show(),$.each($(settingsPage.container).find("tbody").not('[convertstatus="inprocess"]').find("input[type='checkbox']:checked"),function(index,elm){candids[index]=$(elm).closest("tr").attr("id"),$(elm).closest("tr").attr("convertstatus","inprocess")})):(ZPeopleComponents.menu("#convertcandtoempdropdownmenu").hide(),userTableElm=settingsPage.container,$.each($(userTableElm).find("#viewsContainer #recordContainer").find("input[name='check']:checked"),function(index,obj){candids[index]=$(obj).closest("tr").attr("id")}));var params={candidateIds:JSON.stringify(candids)};if(isAddAddUserDirectly){if(isfromtemplate)params.passwordtype=NewCPortal.passwordtype,params.mappingsObj=JSON.stringify(mappings);else{var noofcandselect=OnboardingListing.isCandReportPage()?settingsPage.container.not('[convertstatus="inprocess"]').find("input[loginstatus='nonportaluser']:checked,input[onbstatus=3]:checked").length:settingsPage.container.find("#viewsContainer #recordContainer").find("input[name='check']:checked").length;params.issinglecand=1==noofcandselect}params.zp_type=4}else 9==NewCPortal.currentzptype&&(params.zp_type=NewCPortal.currentzptype);ZPeople.Request.send("/onboarding/reports/candidateToEmployee",params,NewCPortal.handleresultofconv,isfromtemplate),settingsPage.container.find("#convertcandtoemp").addClass("disabled")},NewCPortal.showMappingFields=function(data,params){if(data.ismappingempty)FrameworkCommon.showInfoAlert("","Please configure field mapping in <a href='#settings/service/onboarding/generalsettings' >Onboarding->Settings->Module Setting</a>->Customization");else if(data.isSuccess){NewCPortal.currentzptype=params.zp_type;var popupTab=new Tab;popupTab.id="ZPconvert",popupTab.cardId="convertStep1ConfirmMapping";var mappingslider=new sliderModal("",popupTab);mappingslider.save=ZPI18N.getString("zp.next"),mappingslider.construct();var pageId=$("#ZPconvert");pageId.find("[data-dismiss=modal]").on("click",function(){settingsPage.container.find("#zp_view_close_selection").trigger("click")});var mappings=data.mappings,pval=void 0!=mappings.password?mappings.password:"-1",html='<div class="zpl_crd"><div class="zpl_crdcnt"><div id="candOnboardingSection" class="zpl_secn"> <div><label class="zpl_mtry">'+ZPI18N.getString("zp.passwd")+'</label> </div><div id="PasswordInput"><select id="chsPassword">'+NewCPortal.selectOptions(data.Candcol.NONTABULARSECTION,FormConstants.FieldType.TEXT,void 0)+"</select></div></div></div></div>";1==(OnboardingListing.isCandReportPage()?settingsPage.container.not('[convertstatus="inprocess"]').find("input[loginstatus='nonportaluser']:checked,input[onbstatus=3]:checked").length:settingsPage.container.find("#viewsContainer #recordContainer").find("input[name='check']:checked").length)&&(html='<div class="zpl_crd"><div class="zpl_crdcnt"><div id="candOnboardingSection" class="zpl_secn"> <div><label class="zpl_mtry">'+ZPI18N.getString("zp.passwd")+'</label> </div><div> <div class="zradiobutton zradiobutton--horizontal"> <input onchange="NewCPortal.tempAct(this)" type="radio" id="newPassword" class="zradiobutton__helper" name="passwordradio"> <label class="zradiobutton__label" for="newPassword"><span class="zradiobutton__text">'+ZPI18N.getString("zp.createnewpassword")+'</span></label> </div><div class="zradiobutton zradiobutton--horizontal"> <input onchange="NewCPortal.tempAct(this)" type="radio" id="chsPasswordopt" class="zradiobutton__helper" name="passwordradio" checked="checked"> <label class="zradiobutton__label" for="chsPasswordopt"><span class="zradiobutton__text">'+ZPI18N.getString("zp.selectfieldfromcand")+'</span></label> </div> </div><div id="PasswordInput"><select id="chsPassword">'+NewCPortal.selectOptions(data.Candcol.NONTABULARSECTION,FormConstants.FieldType.TEXT,void 0)+'</select><input type="text" name="password" id="newPassword"placeholder="'+ZPI18N.getString("zp.createnewpassword")+'" value="" class="ztextbox DN"></div></div></div></div>'),pageId.find("#convertStep1ConfirmMapping").html(html),0!==pageId.find("#PasswordInput").find('#chsPassword [value="'+pval+'"]').length&&pageId.find("#PasswordInput").find("#chsPassword").val(pval),tokenObj={},tokenObj.showSearchField=!0,tokenObj.dataMapping={label:"value",informativeText:"value",value:"id"},ZPeopleComponents.select(pageId.find("#chsPassword"),tokenObj),$("#ZPconvert").find("#sliderSbt").on("click",function(){NewCPortal.submitMapping(1,!0)}),$("#ZPconvert").find("#sliderCancel, #sliderCls").off().on("click",function(){ZPeopleComponents.select(pageId.find("#chsPassword")).destroy(),mappingslider.remove()})}else void 0!=data.errMsg&&ZPeople.Message.failure(data.errMsg)},NewCPortal.handleresultofconv=function(data,params,isfromtemplate){if($("#ZPconvert").find("#sliderCancel").trigger("click"),0==Object.keys(data).length)ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"));else if(data.ismappingempty)FrameworkCommon.showInfoAlert("","Please configure field mapping in <a href='#settings/service/onboarding/generalsettings' >Onboarding->Settings->Module Setting</a>->Customization");else if(data.ispasswordempty)$("body").find("#ZPconvert").remove(),NewCPortal.showMappingFields(data,params);else if(data.allConverted)$("#ZPconvert").find("#sliderCancel").trigger("click"),settingsPage.container.find("#reportstable").find("input[type='checkbox']").prop("checked",!1),settingsPage.container.find("#onbcmpbtn").removeClass("opn"),Layout.Page.hash.includes("operations/onboarding/candidate/listview")&&ZP5Views.getCurrViewObj().showRecordActions(),ZPeople.Message.success(ZPI18N.getString("zp.convertedsuccessfully")),OnboardingListing.reloadData();else{var popupTab=new Tab;popupTab.id="ZPconvert",popupTab.cardId="convertStep1ConfirmMapping";var mappingslider=new sliderModal("",popupTab);mappingslider.save=ZPI18N.getString("zp.next"),mappingslider.construct();var recordsadded=0,error=0,pageid=$("#ZPconvert"),html='<div class="zpl_btnmnu" style=""><div><ul class="zpl_grpmnu" ><li elem="addedRecCont">Added records<b id="noOfAdd">00</b></li><li>Error in records<b id="noOfErr">00</b></li></ul></div></div><div class="zpl_rgtcnt" elem="summaryRecContDiv" style=""><div class="zpl_tblres" elem="tableContainer"><table class="zpl_tbl" elem="importTableAddedRec" style="display: none;"></table><table class="zpl_tbl" elem="importTableUpdatedRec" style="display:none"></table><table class="zpl_tbl" elem="importTableSkippedRec" style="display:none"></table><table class="zpl_tbl" elem="importTableErroredRec" style=""><thead><tr><th style="width:35%">'+ZPI18N.getString("zp.candidate")+"</th><th>Error Details</th></tr></thead><tbody>";$.each(data,function(candid,value){var emailid=ZPA_Common.encodeHtml(value.userdisp);$.each(value.response,function(index,response){if(7e3===response.code)recordsadded++;else if(error++,"object"==typeof response.message)if(response.message.label){var label=response.message.label,displayname=ZPeople.decodeTxt(response.message.displayname),errormessage=ZPeople.decodeTxt(response.message[label]).replace(displayname,"<b>"+displayname+"</b>"),row="";response.message.row&&(row=ZPI18N.getString("zp.row")+" "+response.message.row+" - "),html+='<tr><td style="width: 35%;">'+emailid+"</td><td>"+response.message.displayname+" - "+row+errormessage+"</td></tr>"}else $.each(response.message,function(key,message){name;html+='<tr><td style="width: 35%;">'+emailid+"</td><td>"+message+"</td></tr>"});else message="Z112"==response.message?ZPI18N.getString("zp.dcinviteerror"):response.message,html+='<tr><td style="width: 35%;">'+emailid+"</td><td>"+message+"</td></tr>"})}),html+="</tbody></table></div></div>",pageid.find("#convertStep1ConfirmMapping").html(html),pageid.find("#sliderSbt").remove(),pageid.find("#convertStep1ConfirmMapping").find("#noOfAdd").text(recordsadded),pageid.find("#convertStep1ConfirmMapping").find("#noOfErr").text(error),recordsadded>0&&OnboardingListing.reloadData(),$("#ZPconvert").find("#sliderCancel, #sliderCls").off().on("click",function(){mappingslider.remove(),settingsPage.container.find("#reportstable").find("input[type='checkbox']").prop("checked",!1),settingsPage.container.find("#onbcmpbtn").removeClass("opn")})}settingsPage.container.find("#convertcandtoemp").removeClass("disabled");var candidateids=JSON.parse(params.candidateIds);$.each(candidateids,function(index,candidateid){$('[id="'+candidateid+'"]').removeAttr("convertstatus")})},NewCPortal.changeLoginStatus=function(pkId,changestatus){var params={candidateid:pkId,changeStatus:changestatus};ZPeople.Request.send("/onboarding/candidate/changeLoginStatus",params,NewCPortal.handleResponseOfChangeLoginStatus)},NewCPortal.handleResponseOfChangeLoginStatus=function(data,params){ZPSetupCommon.isEmpty(data.SUCCESS)?ZPeople.Message.failure(data.ERROR):($("#obMenu_"+params.candidateid).remove(),OnboardingListing.reloadData(),ZPeople.Message.success(data.SUCCESS))},NewCPortal.createPortal=function(obj){var portalName=$("#add_cportal").val();void 0!==portalName&&portalName.trim()&&$.ajax({type:"POST",async:!1,url:CPortal.candidateURLS.ADDPORTALURL,data:{portalName:portalName,portalType:CPortal.portalType,conreqcsr:csrfToken},success:function(data){data.success?(ZPeople.Message.success(ZPI18N.getString("zp.updatedsuccessfully")),window.location.reload()):void 0!=data.error&&data.error?ZPeople.Message.failure(data.msg):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))}})},NewCPortal.verifyportalname=function(obj){var curportal=$(obj).val();curportal=(curportal=curportal?curportal.replace(/[^a-z0-9]/gi,""):"").toLowerCase(),$(obj).val(curportal)},NewCPortal.deleteCandPopUp=function(thisObj,candidateId){FrameworkCommon.showDeleteAlert(ZPI18N.getString("zp.onb.delete.candtitle"),ZPI18N.getString("zp.onb.delete.candmsg"),{callback:()=>{NewCPortal.deleteCandidate(thisObj,candidateId)},details:$(thisObj).closest("tr")})},NewCPortal.deleteCandidate=function(obj,candidateId){var formId=NewZPPreboarding.candidateFormId,params=(settingsPage.container,{formID:formId,viewLinkName:"",deletegroup:candidateId,conreqcsr:csrfToken});$.post("/onboarding/candidate/deleteRecord",params,function(data){"object"==typeof data.response[0]?ZPeople.Message.failure(errorObj.error):void 0!==data.success&&(ZPeople.Message.success(ZPI18N.getString("zp.canddeletedsuccess")),OnboardingListing.reloadData())})},NewCPortal.updateportalname=function(obj){if("portalEdit"==$(obj).attr("name"))$(obj).siblings('[name="portalValue"]').val($(obj).siblings('[name="portalName"]').text()),$(obj).siblings('[name="portalValue"]').show(),$(obj).siblings('[name="portalValue"]').trigger("select"),$(obj).hide(),$(obj).siblings('[name="portalName"]').hide();else{var portalname=$(obj).siblings('[name="portalName"]').text();if($(obj).hide(),$(obj).siblings('[name="portalName"]').show(),$(obj).siblings('[name="portalEdit"]').show(),0!=$(obj).val().trim().length&&($(obj).siblings('[name="portalName"]').text($(obj).val()),portalname!==$(obj).val())){var tempportalname=portalname;portalname=$(obj).val();Layout.Page.container;$.ajax({type:"POST",async:!1,url:NewCPortal.candidateURLS.UPDATEPORTALURL,data:{ZAID:NewCPortal.currentPortalZAID,portalName:portalname,conreqcsr:csrfToken},success:function(data){void 0!=data.error&&data.error?($(obj).siblings('[name="portalName"]').text(tempportalname),ZPeople.Message.failure(data.msg)):(ZPeople.Message.success(ZPI18N.getString("zp.updatedsuccessfully")),NewCPortal.portalObj.portalName=portalname)}})}}},NewCPortal.verifyportalname=function(obj){var curportal=$(obj).val();curportal=(curportal=curportal?curportal.replace(/[^a-z0-9]/gi,""):"").toLowerCase(),$(obj).val(curportal)},NewCPortal.copyTxtToClipBoard=function(){var i,portallink="/"+(void 0===NewCPortal.portalObj.portalName?"":NewCPortal.portalObj.portalName)+NewZPOnboarding.CONSTANTS.CPORTAL_CONTEXT+"/preonboarding",link=NewCPortal.portalObj.redirecturl?NewCPortal.portalObj.redirecturl:window.location.href,j=0,linkhref="";for(i=0;i<link.length&&("/"==link[i]&&j++,3!=j);i++)linkhref+=link[i];linkhref+=portallink,$("input#cportallink").val(linkhref).trigger("select");try{successCopy=document.execCommand("copy"),!1===successCopy?ZPeople.Message.failure(ZPI18N.getString("zp.copyfailed")):ZPeople.Message.success(ZPI18N.getString("zp.copysuccess"))}catch(exception){successCopy=!1,ZPeople.Message.failure(ZPI18N.getString("zp.copyfailed"))}return successCopy};var ZPA_FileUpload={getFileUploadHtml:function(tabId){Layout.Page.pageId;let isOnb=NewZPOnboarding.isOnbNotifyPage();var fileHtml='<div class="zpl_secn DN" id="attach_section"><div><label>'+ZPI18N.getString("zp.attachments")+"</label></div>";return fileHtml+='<div><div class="zpl_upld"><div class="zpl_fldrp"><h5><div class="zpl_flupld_img"></div>'+ZPI18N.getString("zp.lms.uploadfrom")+" ",fileHtml+='<a class="zpl_lnk" id="localUpload" onclick="ZPA_FileUpload.LocalUpload.loadLocalFile()"><i class="PI_case"></i>'+ZPI18N.getString("zp.files.desktop")+'</a> / <a class="zpl_lnk" id="cloudupload" onclick="ZPA_FileUpload.CloudUpload.init(\''+tabId+'\')"><i class="PI_cloud"></i>'+ZPI18N.getString("zp.files.cloud")+'</a> / <a id="triFileUplTemp" class="zpl_lnk" >'+ZPI18N.getString("zp.seltemps")+'</a><div id="fluplTemp"></div></h5></div><p><span>'+(isOnb?ZPI18N.getString("zp.allowedonbfileformat"):ZPI18N.getString("zp.allowedfileformat"))+"</span></p></div></div></div>",fileHtml+='<div class="zpl_secn"><div id="attachedFiles" class="DN"><h5>'+ZPI18N.getString("zp.attachmentfiles")+'</h5></div><div><div class="zpl_atchd" id="fluplDiv"></div></div></div>'},getAttachFileHtml:function(fileId,fileName,fileType){var attachFileHtml="<div fileId='"+fileId+"' fileType='"+fileType+"' fileName='"+ZSEC.Encoder.encodeForHTML(fileName)+'\' name="fileDiv"><div class="zpl_atchimg"><i class="'+ZPA_FileUpload.getFileTypeClass(fileType,fileName.substring(fileName.lastIndexOf(".")+1))+' zpl_fl_typ"></i></div>';return attachFileHtml+='<div class="zpl_atchdtl"><h4  title=\''+ZSEC.Encoder.encodeForHTML(fileName)+"' action='filename'>"+ZSEC.Encoder.encodeForHTML(fileName)+"</h4><p><span>"+ZPA_FileUpload.getFileDesc(fileType)+"</span></p></div>",attachFileHtml+='<div class="zpl_atchicn" onclick="ZPA_FileUpload.removeFile(this, \''+fileType+"')\"><i action='delete' class=\"PI_delete\"  title='"+ZPI18N.getString("zp.delete")+"'></i></div></div>"},getFileTypeClass:function(fileType,fileExtn){var fileTypeClass="PI_none";switch(fileType){case"2":case"4":fileTypeClass="PI_ft_pdf";break;default:fileTypeClass=FilesCommon.getFileIcon(fileExtn)}return fileTypeClass},getFileDesc:function(fileType){var fileDesc="";switch(fileType){case"2":fileDesc=ZPI18N.getString("zp.lettertemp");break;case"4":fileDesc=ZPI18N.getString("zp.mailmerge")}return fileDesc},loadFileUploadTemplates:function(mode){var pageId=ZPA_Common.getPageId(mode);ZPA_Util.getRecordTemplate(mode,ZPA_FileUpload.constructFileuploadTemplateList);var dropDown=pageId.find("#fluplTemp");pageId.find("#triFileUplTemp").off().on("click",function(){dropDown.is(":visible")?ZPeopleComponents.dropdownlist(dropDown).close():ZPeopleComponents.dropdownlist(dropDown).open({forElement:"#triFileUplTemp"})})},constructFileuploadTemplateList:function(mode,data){ZPA_Common.getMainContainer();var items=[];!$.isEmptyObject(data)&&(data.hasOwnProperty("rt")&&data.rt.length>0||data.hasOwnProperty("mt")&&data.mt.length>0)&&$.each(data,function(tempType,templateObj){$.each(templateObj,function(i,tempDtl){var tempOptDtl={};tempOptDtl.tempId=tempDtl.templateId,tempOptDtl.tempName=decodeHTML(tempDtl.tempName),tempOptDtl.title=decodeHTML(tempDtl.tempName),tempOptDtl.type="rt"==tempType?"2":"4",tempOptDtl.groupLabel="rt"==tempType?ZPI18N.getString("zp.lettertemp"):ZPI18N.getString("zp.mailmergetemps"),items.push(tempOptDtl)})});ZPeopleComponents.isComponent("#fluplTemp")&&ZPeopleComponents.dropdownlist("#fluplTemp").destroy();let tempDDProps={value:"",items:items,dataMapping:{text:"tempName",label:"tempName",value:"tempId",groupLabel:"groupLabel"},sort:!0,sortBy:"tempName",search:{by:["tempName"],criteria:"contains",highlightKeyword:!0},margin:{top:7},select:ZPA_FileUpload.selectFileCallback,deselect:ZPA_FileUpload.deselectFileCallback,multiple:!0,forElement:"#triFileUplTemp",appendTo:ZPA_Common.getPageCardContainerId(mode),positionAlterable:!0};ZPA_Common.ZCompProp.loadDropdownProp(tempDDProps),ZPeopleComponents.dropdownlist("#fluplTemp",tempDDProps)},selectFileCallback:function(event,data){var pageId=ZPA_Common.getMainContainer(),itemData=event.detail.itemData,selFileName=itemData.tempName,selFileId=itemData.tempId,selFileType=itemData.type,attachFileHtml=ZPA_FileUpload.getAttachFileHtml(selFileId,selFileName,selFileType);pageId.find("#fluplDiv").append(attachFileHtml),ZPA_FileUpload.toggleAttachFileHeader(),event.detail.fromUI&&ZPA_Common.CloseAlert.changesMade()},deselectFileCallback:function(event,data){var pageId=ZPA_Common.getMainContainer(),selFileId=event.detail.itemData.tempId;pageId.find("#fluplDiv [fileid="+selFileId+"]").remove(),ZPA_FileUpload.toggleAttachFileHeader(!0),ZPA_Common.CloseAlert.changesMade()},removeFile:function(thisObj,fileType){ZPA_Common.getMainContainer();if("5"!=fileType){var selTempId=$(thisObj).parent().attr("fileId");ZPeopleComponents.dropdownlist("#fluplTemp").deselect({tempId:selTempId}),ZPA_Common.CloseAlert.changesMade()}else ZPA_FileUpload.LocalUpload.removeLocalFile()},getUploadedRecordTempList:function(){var selFileDiv=ZPA_Common.getMainContainer().find("[name='fileDiv'][filetype!='5']"),recTempList=[];return $.each(selFileDiv,function(index,fileDtl){var recTempObj={};recTempObj.id=fileDtl.getAttribute("fileId"),recTempObj.dispName=fileDtl.getAttribute("fileName"),recTempObj.tempType=fileDtl.getAttribute("fileType"),recTempList.push(recTempObj)}),recTempList},setFileUploadList:function(data){var pageId=ZPA_Common.getMainContainer(),recTempList=data.recordTempIds,selectedTempIds=[];$.each(recTempList,function(index,tempObj){var tempId=tempObj.id,tempType=tempObj.type;if(5==tempType){pageId.find("#localUpload").data("existingFileObj",JSON.stringify(tempObj));var tempName=tempObj.dispName,attachFileHtml=ZPA_FileUpload.getAttachFileHtml(tempId,tempName,tempType);pageId.find("#fluplDiv").append(attachFileHtml),ZPA_FileUpload.toggleAttachFileHeader()}else selectedTempIds.push({tempId:tempId})}),$.isEmptyObject(selectedTempIds)||ZPeopleComponents.dropdownlist("#fluplTemp").setValues(selectedTempIds)},toggleAttachFileHeader:function(isRemoveFile){var pageId=ZPA_Common.getMainContainer();void 0!=isRemoveFile&&isRemoveFile?pageId.find("[name=fileDiv]").length<=0&&!pageId.find("#attachedFiles").hasClass("DN")&&pageId.find("#attachedFiles").addClass("DN"):pageId.find("#attachedFiles").hasClass("DN")&&pageId.find("#attachedFiles").removeClass("DN");pageId.find("#attachedFiles").length>0&&pageId.find("#attachedFiles")[0].scrollIntoView({behavior:"smooth",block:"center"})},isFileExtnAllowed:function(fileName){return!!/(\.pdf|\.doc|\.xls|\.csv|\.xlsx|\.zip)$/i.test(fileName)||(ZPeople.Message.warning(ZPI18N.getString("zp.supportedfileformat")),!1)},isOnbFileExtnAllowed:function(fileName){return!!/(\.jpg|\.jpeg|\.png|\.pdf|\.doc|\.xls|\.csv|\.xlsx|\.zip)$/i.test(fileName)||(ZPeople.Message.warning(ZPI18N.getString("zp.supportedfileformat")),!1)},appendUploadedFile:function(formData){ZPA_FileUpload.LocalUpload.appendLocalFile(formData),ZPA_FileUpload.CloudUpload.appendCloudFile(formData)}};ZPA_FileUpload.LocalUpload={loadLocalFile:function(){var pageId=ZPA_Common.getMainContainer();let isOnb=NewZPOnboarding.isOnbNotifyPage();var localFileInpBx=$('<div><input type="file" name="mailFlUpl"></div>');localFileInpBx.find("input").trigger("click"),localFileInpBx.find("input").off("change").on("change",function(event){var file=$(this)[0].files[0],fileName=file.name;file.size;if(fileName=fileName.replace("C:\\fakepath\\",""),!isOnb||ZPA_FileUpload.isOnbFileExtnAllowed(fileName))if(isOnb||ZPA_FileUpload.isFileExtnAllowed(fileName)){ZPA_FileUpload.LocalUpload.removeLocalFile(),pageId.find("#cloudupload").removeAttr("cloudUploadDoc"),pageId.find("#localUpload").data("fileObj",file);var attachFileHtml=ZPA_FileUpload.getAttachFileHtml("",fileName,"5");pageId.find("#fluplDiv").append(attachFileHtml),ZPA_FileUpload.toggleAttachFileHeader()}else ZPeople.Message.warning(ZPI18N.getString("zp.supportedfileformat"));else ZPeople.Message.warning(ZPI18N.getString("zp.supportedonbfileformat"))})},removeLocalFile:function(){var pageId=ZPA_Common.getMainContainer();pageId.find("#fluplDiv [filetype=5]").remove(),pageId.find("#localUpload").data("existingFileObj",""),pageId.find("#localUpload").data("fileObj",""),ZPA_FileUpload.toggleAttachFileHeader(!0),ZPA_Common.CloseAlert.changesMade()},appendLocalFile:function(formData){var pageId=ZPA_Common.getMainContainer();if(pageId.find("[name='fileDiv'][filetype='5']").length>0){var existingFileObj=pageId.find("#localUpload").data("existingFileObj"),file=pageId.find("#localUpload").data("fileObj");void 0!=existingFileObj&&""!==existingFileObj?(formData.append("existingData",existingFileObj),formData.append("recTempMode","localUpload")):void 0!=file&&""!==file&&(formData.append("attachment",file),formData.append("recTempMode","localUpload"),pageId.find("#cloudupload").data("cloudUploadDoc",!1))}ZPA_Common.CloseAlert.changesMade()}},ZPA_FileUpload.CloudUpload={init:function(tabId){CloudPicker.init(tabId,ZPA_FileUpload.CloudUpload.loadCloudUpload),CloudPicker.construct()},loadCloudUpload:function(){var pageId=ZPA_Common.getMainContainer();let isOnb=NewZPOnboarding.isOnbNotifyPage();var fileObj=JSON.parse(CloudPicker.getFileObj()),fileName=decodeURIComponent(fileObj.docName);if(!isOnb||ZPA_FileUpload.isOnbFileExtnAllowed(fileName))if(isOnb||ZPA_FileUpload.isFileExtnAllowed(fileName)){pageId.find("#fluplDiv [filetype=5]").remove(),pageId.find("#localUpload").data("existingFileObj",""),pageId.find("#localUpload").data("fileObj",""),pageId.find("#cloudupload").data("cloudUploadDoc",!0);var attachFileHtml=ZPA_FileUpload.getAttachFileHtml("",fileName,"5");pageId.find("#fluplDiv").append(attachFileHtml),ZPA_FileUpload.toggleAttachFileHeader()}else ZPeople.Message.warning(ZPI18N.getString("zp.supportedfileformat"));else ZPeople.Message.warning(ZPI18N.getString("zp.supportedonbfileformat"))},appendCloudFile:function(formData){var pageId=ZPA_Common.getMainContainer();if(pageId.find("[name='fileDiv'][filetype='5']").length>0){var isCloudUploadDoc=pageId.find("#cloudupload").data("cloudUploadDoc");void 0!=isCloudUploadDoc&&isCloudUploadDoc&&(formData.append("cloudUploadDoc",CloudPicker.getFileObj()),formData.append("recTempMode","cloudUpload"))}ZPA_Common.CloseAlert.changesMade()}},OfferLetter={formId:void 0,formObj:void 0,Utils:{getFormDetails:async function(formType){if(this.formDetails)return this.formDetails;const URL=`/${formType}/form`,[response]=await Compensation.Utils.getRequestAsPromise(URL,{});return Compensation.Utils.commonErrorHandler(response),this.formDetails=response,OfferLetter.formId=this.formDetails.formId,OfferLetter.Utils.getFormsData(OfferLetter.formId,"ADD"),this.formDetails},getFormsData(formId,mode,callback){var json={formId:formId,formMode:mode};OfferLetter.formObj=ZP5Form._toForm(json);const form=OfferLetter.formObj;var formCompData=form.FormOperations.getFormComponentData();void 0!==formCompData&&(formCompData.refresh||formCompData.lastprev||this.isRefreshNeed)&&(formCompData=void 0,form.FormOperations.setFormComponentData(),_.isFunction(callback)&&callback());var params={formId:form.getFormsProperties().getFormId(),mode:"getFormComponents"};void 0!=form.getParams().moduleParamsHandler&&form.getParams().moduleParamsHandler(params),ZP5Form.getFormComponents(params,data=>{form.FormOperations.setFormComponentData(data),_.isFunction(callback)&&callback()})}},Slider:void 0,addOfferLetter:function(){OfferLetter.Tabs.mode="ADD",OfferLetter.Tabs.initiator="offerLetter";let tabs=OfferLetter.Tabs.getAll();OfferLetter.Tabs.sliderName="Add New Offer",OfferLetter.Slider=new fullPageModal(OfferLetter.Tabs.sliderName,...tabs),OfferLetter.Slider._fullPageModalId="offerAddSlider",OfferLetter.Slider.topNavigation=!0,OfferLetter.Slider._previousToggle=!1,OfferLetter.Slider.showTopNavigation=tabs.length>1,OfferLetter.Slider._cancelToggle=!1,OfferLetter.Slider._nextToggle=!0,OfferLetter.Slider._saveToggle=!1,OfferLetter.Slider.refreshCallback=OfferLetter.getRefreshCallback,OfferLetter.Slider.setCloseCallback(OfferLetter.validateCloseWizard),OfferLetter.Tabs.construct(tabs),OfferLetter.Tabs.defaultActions(),OfferLetter.Slider.open()},editOfferLetter:function(recordId){OfferLetter.Tabs.mode="VIEW",OfferLetter.Tabs.initiator="offerLetter",OfferLetter.Tabs.sliderName="Edit Offer";let tabs=OfferLetter.Tabs.getAll();OfferLetter.Slider=new fullPageModal(OfferLetter.Tabs.sliderName,...tabs),OfferLetter.Slider._fullPageModalId="offerEditSlider",OfferLetter.Slider.recordId=recordId,OfferLetter.Slider.topNavigation=!0,OfferLetter.Slider._previousToggle=!1,OfferLetter.Slider.showTopNavigation=tabs.length>1,OfferLetter.Slider._cancelToggle=!1,OfferLetter.Slider._nextToggle=!0,OfferLetter.Slider._saveToggle=!1,OfferLetter.Slider.refreshCallback=OfferLetter.getRefreshCallback,OfferLetter.Slider.setCloseCallback(OfferLetter.validateCloseWizard),OfferLetter.Tabs.construct(tabs),OfferLetter.Tabs.defaultActions(),OfferLetter.Slider.open()},handleWizardFooter:function(addFormModal){addFormModal.currentTab.OLHandleFooter(addFormModal)},handleWizardHeader:function(addFormModal){addFormModal.currentTab.OLHandleHeader(addFormModal)},sliderCallBack:function(addFormModal){OfferLetter.container=addFormModal.mainWrapId.find("#"+addFormModal._fullPageModalId),addFormModal.currentTab.OLSliderCallback(addFormModal),OfferLetter.handleWizardHeader(addFormModal),OfferLetter.handleWizardFooter(addFormModal)},sliderValidate:function(addFormModal){addFormModal.currentTab.OLTabChangeCallback(addFormModal,async()=>{let stackCallTab=addFormModal._stackCallTab;await stackCallTab.OLValidateCallback(addFormModal)?(addFormModal._isValidated=!0,addFormModal.showTab(stackCallTab),OfferLetter.container.find("#"+stackCallTab.id).removeClass("disabled")):OfferLetter.container.find("#"+stackCallTab.id).addClass("disabled")})},validateCloseWizard:function(){OfferLetter.Slider.remove()},getRefreshCallback:modal=>(refreshCallback=(()=>{}),refreshCallback)},OfferLetter.Template={initcallback:function(){Compensation.LetterTemplatesUtil.getClassObj(Compensation.LetterTemplatesUtil.TYPES.OFFER_LETTER).initCallback()},callback:function(){Compensation.LetterTemplatesUtil.getClassObj(Compensation.LetterTemplatesUtil.TYPES.OFFER_LETTER).callback()},hashChangeCallback:function(){Compensation.LetterTemplatesUtil.getClassObj(Compensation.LetterTemplatesUtil.TYPES.OFFER_LETTER).hashChangeCallback()}},OfferLetter.Operations={getFormDetails:function(){Compensation.Config.getConfiguration_asSync(!1),OfferLetter.Utils.getFormDetails.call(OfferLetter.Operations,"offerletter")},setModPrefix:function(){return{modulePrefix:"onboarding-form-listview",submode:"onboarding-form-listview"}},init:function(){OfferLetter.Operations.getFormDetails(),OfferLetter.recordManager=new OfferLetterRecordManager},onChangeCallback:function(){let page=settingsPage.container;page.find("#addRecordButton").replaceWith('<button class="zlabel zlabel--blue zlabel--medium" id="addOfferButton">Generate Offer Letter</button>'),page.find("#viewActionsContainer #addOfferButton").off("click").on("click",()=>{OfferLetter.addOfferLetter()}),page.find("a[elem=editViewButton]").parent("div").remove(),0==page.find("div#pgovrview").length&&page.find(".zpl_tblres").before('<div id="pgovrview" class="zpl_ovrwHdr zpl_ovrwOfrHdr"></div>'),OfferLetter.Operations.loadOfferStats("pgovrview")},createOfferStatsCards:function(offerData){let cardsHTML='<div class="zpl_aCrdlst">';return[{status:"OFFER_PENDING",title:"Offer Pending",iconClass:"PI_offer_pending",colorClass:"prpl"},{status:"OFFER_RELEASED",title:"Offer Released",iconClass:"PI_offer_released",colorClass:"orng"},{status:"OFFER_ACCEPTED",title:"Offer Accepted",iconClass:"PI_offer_accepted",colorClass:"green"},{status:"OFFER_REJECTED",title:"Offer Rejected",iconClass:"PI_offer_rejected",colorClass:"bluee"},{status:"OFFER_EXPIRING",title:"Offer Expiring",iconClass:"PI_offer_expiring",colorClass:"prpl"}].forEach(category=>{const weekCount=offerData[category.status+"_WEEK"]||"00",monthCount=offerData[category.status+"_MONTH"]||"00";cardsHTML+=`\n\t            <div class="zpl_aCrd ${category.colorClass}" tabindex="0">\n\t                <div class="aCrd_icn">\n\t                    <div>\n\t                        <i class="${category.iconClass}">\n\t                            <i class="path1"><i class="path2"></i></i>\n\t                        </i>\n\t                    </div>\n\t                    <b>${category.title}</b>\n\t                </div>\n\t                <div class="aCrd_cnt">\n\t                    <div>\n\t                        <label>This Week</label><h1>${weekCount.toString().padStart(2,"0")}</h1>\n\t                    </div>\n\t                    <div>\n\t                        <label>This Month</label><h1>${monthCount.toString().padStart(2,"0")}</h1>\n\t                    </div>\n\t                </div>   \n\t            </div>\n\t        `}),cardsHTML+="</div>"},loadOfferStats(containerId){const params={data:JSON.stringify({})};Compensation.Utils.getRequestAsPromise("/offerletter/stats",params).then(([response])=>{if(response){const statsData=response,cardsHTML=OfferLetter.Operations.createOfferStatsCards(statsData);document.getElementById(containerId).innerHTML=cardsHTML}})}},OfferLetter.Components={compList:["select","tokenfield","numberfield","datefield","datetimefield","menu","menubutton"],customPropsStore:{select:new Map,datefield:new Map},componentReferences:new Map,resetStore:function(fieldId){if(!fieldId)return OfferLetter.Components.customPropsStore.select.clear(),OfferLetter.Components.customPropsStore.datefield.clear(),void OfferLetter.Components.componentReferences.clear();OfferLetter.Components.customPropsStore.select.delete(fieldId),OfferLetter.Components.customPropsStore.datefield.delete(fieldId),OfferLetter.Components.componentReferences.delete(fieldId)},destroy:function(container,id){container.find((id?"#"+id:"")+" [zfctype]").each(function(i,elem){var zfctype=$(elem).attr("zfctype"),elemId=$(elem).attr("id");OfferLetter.Components.compList.includes(zfctype)&&(ComponentsCommon.safeDestroyZComponent(zfctype,elem),elemId&&(OfferLetter.Components.customPropsStore[zfctype]&&OfferLetter.Components.customPropsStore[zfctype].delete(elemId),OfferLetter.Components.componentReferences.delete(elemId)))})},destroyAll:function(container,selectors){OfferLetter.Components.destroySlider(container,selectors)},destroySlider:function(container,selectors){for(var i=0;i<selectors.length;i++){var selector=selectors[i],idMatch=selector.match(/#([a-zA-Z0-9_-]+)/),id=null;idMatch&&(id=idMatch[1]),id?OfferLetter.Components.destroy(O.container,id):container.find(selector).each(function(){var elemId=$(this).attr("id");elemId?OfferLetter.Components.destroy(container,elemId):OfferLetter.Components.destroy($(this))})}},addClassName:function(fieldId,fieldType,className){if(!fieldId||!fieldType||!className)return!1;fieldType=fieldType.toLowerCase();var store=OfferLetter.Components.customPropsStore[fieldType];if(!store)return!1;var existingProps=store.get(fieldId)||{},existingClasses=existingProps.zclassName?existingProps.zclassName.split(" ").filter(c=>c.trim()):[];existingClasses.includes(className)||existingClasses.push(className);var updatedProps=Object.assign({},existingProps,{zclassName:existingClasses.join(" ")});store.set(fieldId,updatedProps);var component=OfferLetter.Components.getComponent(fieldId);return!(!component||!component.setAttributes)&&(component.setAttributes(updatedProps),!0)},removeClassName:function(fieldId,fieldType,className){if(!fieldId||!fieldType||!className)return!1;fieldType=fieldType.toLowerCase();var store=OfferLetter.Components.customPropsStore[fieldType];if(!store)return!1;var existingProps=store.get(fieldId)||{},filteredClasses=(existingProps.zclassName?existingProps.zclassName.split(" ").filter(c=>c.trim()):[]).filter(c=>c!==className),updatedProps=Object.assign({},existingProps,{zclassName:filteredClasses.length>0?filteredClasses.join(" "):""});store.set(fieldId,updatedProps);var component=OfferLetter.Components.getComponent(fieldId);return!(!component||!component.setAttributes)&&(component.setAttributes(updatedProps),!0)},hideElement:function(fieldId,fieldType){return OfferLetter.Components.addClassName(fieldId,fieldType,"zpl_DNI")},showElement:function(fieldId,fieldType){return OfferLetter.Components.removeClassName(fieldId,fieldType,"zpl_DNI")},toggleElementVisibility:function(fieldId,fieldType){var existingProps=OfferLetter.Components.getCustomProps(fieldId,fieldType);return(existingProps.zclassName?existingProps.zclassName.split(" ").filter(c=>c.trim()):[]).includes("zpl_DNI")?OfferLetter.Components.showElement(fieldId,fieldType):OfferLetter.Components.hideElement(fieldId,fieldType)},setCustomProps:function(fieldId,fieldType,props,append=!1){if(fieldId&&fieldType&&props){fieldType=fieldType.toLowerCase();var store=OfferLetter.Components.customPropsStore[fieldType];if(store){var finalProps=props;if(append){var existingProps=store.get(fieldId)||{};finalProps=Object.assign({},existingProps,props)}store.set(fieldId,finalProps);var component=OfferLetter.Components.getComponent(fieldId);return!(!component||!component.setAttributes)&&(component.setAttributes(finalProps),!0)}}},appendCustomProps:function(fieldId,fieldType,props){return OfferLetter.Components.setCustomProps(fieldId,fieldType,props,!0)},getCustomProps:function(fieldId,fieldType){if(!fieldId||!fieldType)return{};fieldType=fieldType.toLowerCase();var store=OfferLetter.Components.customPropsStore[fieldType];return store&&store.get(fieldId)||{}},getZCompOptionsForField:function(labelName,formId){var options=[],formComp=ZP5Form.Field.getFieldComponentByLabel(labelName,formId);return void 0!=formComp&&(options=formComp.OptionsWithId),{options:options,dataMapping:{label:"Value",value:"Id",id:"Id",text:"Value"}}},storeComponentReference:function(fieldId,fieldType,component){fieldId&&component&&OfferLetter.Components.componentReferences.set(fieldId,{component:component,type:fieldType.toLowerCase()})},getComponent:function(fieldId){var ref=OfferLetter.Components.componentReferences.get(fieldId);return ref?ref.component:null},getComponentType:function(fieldId){var ref=OfferLetter.Components.componentReferences.get(fieldId);return ref?ref.type:null},initializeZComponents:function(container){container.find("[zfctype]").each(function(){var $element=$(this),fieldType=($element.attr("zfctype")||"").toLowerCase(),fieldId=$element.attr("id");if(fieldType&&fieldId){var component,customProps={};if(OfferLetter.Components.customPropsStore[fieldType]){var storedProps=OfferLetter.Components.customPropsStore[fieldType].get(fieldId);storedProps&&(customProps=storedProps)}"select"===fieldType?(component=ZPeopleComponents.select($element,customProps)).deselectAllOptions():"datefield"===fieldType&&(component=ZPeopleComponents.datefield($element,customProps)),component&&OfferLetter.Components.storeComponentReference(fieldId,fieldType,component)}})},applyCustomProps:function(fieldId){var ref=OfferLetter.Components.componentReferences.get(fieldId);if(!ref||!ref.component||!ref.type)return!1;var component=ref.component,type=ref.type,props=OfferLetter.Components.getCustomProps(fieldId,type);return!!(Object.keys(props).length>0&&component.setAttributes)&&(component.setAttributes(props),!0)},getComponentsByType:function(type){if(!type)return[];type=type.toLowerCase();var result=[];return OfferLetter.Components.componentReferences.forEach(function(ref,id){ref.type===type&&result.push({id:id,component:ref.component})}),result},createComponent:function(type,options,container){if(!type||!container)return null;var id;type=type.toLowerCase(),id=options.id?options.id:"comp_"+Math.random().toString(36).substr(2,9);var elementTag="input";"select"===type&&(elementTag="select");var $element=$("<"+elementTag+' id="'+id+'" zfctype="'+type+'">');container.append($element),OfferLetter.Components.customPropsStore[type]&&OfferLetter.Components.customPropsStore[type].set(id,options);var component=null;return"select"===type?component=ZPeopleComponents.select($element,options):"datefield"===type&&(component=ZPeopleComponents.datefield($element,options)),component&&OfferLetter.Components.storeComponentReference(id,type,component),component},setDateValue:function(fieldId,dateValue){var component=OfferLetter.Components.getComponent(fieldId);return!(!component||!component.setValue)&&(component.setValue(dateValue),!0)},getDateValue:function(fieldId){var component=OfferLetter.Components.getComponent(fieldId);return component&&component.getValue?component.getValue():null},setDateRange:function(startDateId,endDateId,minDate,maxDate){var startComponent=OfferLetter.Components.getComponent(startDateId),endComponent=OfferLetter.Components.getComponent(endDateId);return!(!startComponent||!endComponent)&&(minDate&&startComponent.setAttribute("min",minDate),maxDate&&endComponent.setAttribute("max",maxDate),startComponent.listen("change",function(event,data){endComponent.enable(),endComponent.setAttribute("min",data.dateString);var endValue=endComponent.getValue().dateObject;endValue&&endValue<data.dateObject&&endComponent.clear()}),endComponent.listen("change",function(event,data){startComponent.setAttribute("max",data.dateString)}),startComponent.getValue().dateObject||endComponent.disable(),!0)},setPropForField:function(fieldId,constraint,dateValue){var component=this.getComponent(fieldId);return!!component&&(component.setAttribute(constraint,dateValue),!0)},setSelectValue:function(fieldId,value){var component=OfferLetter.Components.getComponent(fieldId);return!(!component||!component.setValue)&&(component.setValue(value),!0)},getSelectValue:function(fieldId){var component=OfferLetter.Components.getComponent(fieldId);return component&&component.getValue?-1==component.getValue()?"":component.value:null},setSelectOptions:function(fieldId,options){var component=OfferLetter.Components.getComponent(fieldId);return!(!component||!component.addOption)&&(component.removeAllOptions(),component.addOption(options),!0)},addComponentListener:function(fieldId,eventName,callback){var component=OfferLetter.Components.getComponent(fieldId);return!(!component||!component.listen)&&(component.listen(eventName,callback),!0)},removeComponentListener:function(fieldId,eventName,callback){var component=OfferLetter.Components.getComponent(fieldId);return!(!component||!component.unlisten)&&(component.unlisten(eventName,callback),!0)},validateAll:function(container){var isValid=!0;return container.find("[zfctype]").each(function(){var fieldId=$(this).attr("id");if(fieldId){var component=OfferLetter.Components.getComponent(fieldId);component&&component.checkValidity&&(component.checkValidity()||(isValid=!1))}}),isValid},setValuesByGroup:function(groupSelector,value){var container=$(groupSelector);return!!container.length&&(container.find("[zfctype]").each(function(){var fieldId=$(this).attr("id");if(fieldId){var component=OfferLetter.Components.getComponent(fieldId);component&&component.setValue&&component.setValue(value)}}),!0)},clearByGroup:function(groupSelector){var container=$(groupSelector);return!!container.length&&(container.find("[zfctype]").each(function(){var fieldId=$(this).attr("id");if(fieldId){var component=OfferLetter.Components.getComponent(fieldId);component&&component.clear&&component.clear()}}),!0)},getFormValues:function(formSelector){var formData={},$form=$(formSelector);return $form.length?($form.find("[zfctype]").each(function(){var fieldId=$(this).attr("id");if(fieldId){var component=OfferLetter.Components.getComponent(fieldId);if(component){var type=OfferLetter.Components.getComponentType(fieldId);if(type&&component.getValue)if("datefield"===type){var dateValue=component.getValue();formData[fieldId]={dateString:dateValue.dateString,dateObject:dateValue.dateObject}}else formData[fieldId]=component.getValue()}}}),formData):formData}},OfferLetter.Tabs={defaultTabs:["OfferDetails","Preview"],additionalTabs:[],allowedDefaultTabs:[],mode:"",setAddMode:isAddMode=>{OfferLetter.Tabs.mode=isAddMode?"ADD":""},isAddMode:()=>"ADD"==OfferLetter.Tabs.mode,isEditMode:()=>"EDIT"==OfferLetter.Tabs.mode,isViewMode:()=>"VIEW"==OfferLetter.Tabs.mode,updateSliderName:sliderName=>{OfferLetter.Slider.name=sliderName,OfferLetter.container.find("#fullModHeader h4").text(ZPeople.decodeTxt(sliderName)).addClass("w400").attr("title",ZPeople.decodeTxt(sliderName))},handleSliderHeaders:()=>{if(OfferLetter.Tabs.isEditMode()){let html='<span class="zpl_mhderrgt"><div id="headerApprovalBtn"></div><a class="PI_edt zpl_btnic zpl_DNI" id="editRec" data-title-display-type="box" data-title-position="auto" data-title-ismessagehtmlencoded="true" title="Edit"></a><a id="createInfo" class="PI_info zpl_btnic" data-menu-id="recordInfo"></a><a class="PI_more zpl_btnic zpl_drpdwn-js zpl_DNI" data-menu-id="frmMore" id="moreOpt" data-title-display-type="box" data-title-position="auto" data-title-ismessagehtmlencoded="true" title="More"></a></span>';OfferLetter.Slider.modalDiv.find("#fullModHeader #closeMark").before(html)}},construct:tabs=>{let disabledTabIds=[];for(tabInd in tabs){let tab=tabs[tabInd];tab.OLIsEnabled()?OfferLetter.Slider.construct(parseInt(tabInd)):disabledTabIds.push("#"+tab.id)}disabledTabIds.length>0&&OfferLetter.container.find(disabledTabIds.join(",")).addClass("disabled"),OfferLetter.Tabs.handleSliderHeaders()},defaultActions:()=>{OfferLetter.Slider.showTopNavigation||(FrameworkCommon.hide(OfferLetter.container.find("#tabLeftUl")),OfferLetter.container.removeClass("zpl_mdltopnav"))},getDefault:()=>{let tabs=[];for(tabInd in OfferLetter.Tabs.defaultTabs){let tabName=OfferLetter.Tabs.defaultTabs[tabInd];OfferLetter.Tabs[tabName].isAllowed()&&tabs.push(OfferLetter.Tabs.get(tabName,OfferLetter.Tabs[tabName]))}return tabs},getAdditional:tabs=>{for(addTabInd in tabs=tabs&&tabs.length>0?tabs:[],OfferLetter.Tabs.additionalTabs){let addTabName=OfferLetter.Tabs.additionalTabs[addTabInd],addTab=OfferLetter.Tabs.get(addTabName,OfferLetter.Tabs[addTabName]),tab=OfferLetter.Tabs.get(addTabName,addTab);addTab.showAsFirstTab?tabs.unshift(tab):tabs.push(tab)}return tabs},getAll:()=>{let tabs=OfferLetter.Tabs.getDefault();return tabs=OfferLetter.Tabs.getAdditional(tabs)},get:(id,tabObj)=>{let{name:name,sliderCallback:sliderCallback,validateCallback:validateCallback,headerCallback:headerCallback,footerCallback:footerCallback,isEnabled:isEnabled,tabChangeCallback:tabChangeCallback,validateOnClose:validateOnClose,closeCallback:closeCallback}=tabObj,tab=new Tab(name,OfferLetter.sliderCallBack,OfferLetter.sliderValidate);return tab.id="tab"+id,tab.cardId="card"+id,tab.OLSliderCallback=ZPUtil.Validation.isFunction(sliderCallback)?sliderCallback:()=>{},tab.OLValidateCallback=ZPUtil.Validation.isFunction(validateCallback)?validateCallback:()=>!0,tab.OLTabChangeCallback=ZPUtil.Validation.isFunction(tabChangeCallback)?tabChangeCallback:(modal,callback)=>{callback(modal,callback)},tab.OLCloseCallback=ZPUtil.Validation.isFunction(closeCallback)?closeCallback:()=>{},tab.OLValidateOnClose=ZPUtil.Validation.isFunction(validateOnClose)?validateOnClose:(modal,callback)=>{callback(modal,callback)},tab.OLHandleHeader=ZPUtil.Validation.isFunction(headerCallback)?headerCallback:()=>{},tab.OLHandleFooter=ZPUtil.Validation.isFunction(footerCallback)?footerCallback:()=>{},tab.OLIsEnabled=ZPUtil.Validation.isFunction(isEnabled)?isEnabled:()=>{},tab},isAllowed:tabName=>0==OfferLetter.Tabs.allowedDefaultTabs.length||-1!=$.inArray(tabName,OfferLetter.Tabs.allowedDefaultTabs),OfferDetails:{name:"Offer Details",sliderCallback:modal=>{const odCard=OfferLetter.container.find("#cardOfferDetails");modal.isCardIntialCallback()&&(odCard.html(OfferLetter.Tabs.OfferDetails.getHtml()),OfferLetter.Tabs.OfferDetails.initElements(odCard),OfferLetter.Tabs.isEditMode()?OfferLetter.Tabs.OfferDetails.loadEditModeData(odCard,OfferLetter.Slider.recordId):OfferLetter.Tabs.isViewMode()?OfferLetter.Slider.showTab("tabPreview"):(odCard.find("#offerCard").removeClass("zpl_DNI"),odCard.find("#offerLoadingCont").addClass("zpl_DNI")))},isEnabled:()=>OfferLetter.Tabs.isAddMode()||OfferLetter.Tabs.isEditMode()||OfferLetter.Tabs.isViewMode(),isAllowed:()=>OfferLetter.Tabs.isAllowed("Customize"),isOnlyCustomize:function(){return!0},closeCallback:modal=>{},footerCallback:modal=>{let footerHtml='<div></div><div><button id="saveButton" type="button" class="zlabel zlabel--blue zlabel--medium">'+ZPI18N.getString("zp.next")+"</button></div>";OfferLetter.Slider.modalFooter.html(footerHtml),OfferLetter.Slider.modalFooter.find("#saveButton").off("").on("click",()=>{OfferLetter.Tabs.OfferDetails.addUpdateRecord(modal)}),FrameworkCommon.show(OfferLetter.Slider.modalFooter)},fillBaseCurrency:odCard=>{Compensation.Currencies.getInitData().then(()=>{let homeCurr=Compensation.Currencies.DATA.confCurrList.filter(x=>x.is_home_currency);homeCurr.length>0&&(odCard.find("#currCode").text(homeCurr[0].currencycode),odCard.find("#currCode").attr("currency",homeCurr[0].currencyid),OfferLetter.Components.setSelectValue("currencies",homeCurr[0].currencyid))})},initElements:(odCard,isDisabled=!1)=>{OfferLetter.Components.setCustomProps("candidateId","select",{showSearchField:!0,dataMapping:{value:"CANDIDATEID",label:"candidateName",title:"candidateName"},serverSearch:!0,change:(event,data)=>{event.detail.fromUI&&OfferLetter.Tabs.OfferDetails.fetchCandidateRecordDetail(odCard,data.value)},dataSource:{search:function(params){return new Promise(function(search,reject){OfferLetter.Tabs.OfferDetails.loadOptions(params.query,candidateArray=>{search({delay:10,results:candidateArray,more:!1})})})},paginated:!0},disabled:isDisabled}),OfferLetter.Components.setCustomProps("packageId","select",{showSearchField:!0,change:async event=>{if(!event.detail.fromUI)return;if(-1!=event.detail.selectedValue){const URL=`/offerletter/${event.detail.selectedValue}/salarypackage`,[response]=await Compensation.Utils.getRequestAsPromise(URL,{});Compensation.Utils.commonErrorHandler(response),OfferLetter.Tabs.OfferDetails.loadTemplateInfo(odCard,response.currentTemplate,response.allComps,response.oneTimeObj,void 0,isDisabled),OfferLetter.Components.hideElement("currencies","select"),odCard.find("#showBrkup").removeClass("zpl_DNI"),odCard.find("#ofrSalDiv").addClass("ztextbox--group ztextbox--zicon zpl_inpticfild "),odCard.find("#currCode").removeClass("zpl_DNI")}else OfferLetter.Components.showElement("currencies","select"),odCard.find("#showBrkup").addClass("zpl_DNI"),odCard.find("#ofrSalDiv").removeClass("ztextbox--group ztextbox--zicon zpl_inpticfild "),odCard.find("#currCode").addClass("zpl_DNI"),odCard.find("#brkupDiv").hide(),OfferLetter.Tabs.OfferDetails.fillBaseCurrency(odCard)},dataSource:{search:function(params){return new Promise(function(search,reject){OfferLetter.Tabs.OfferDetails.loadPackageOptions(params.query,packageArray=>{let resultObj={delay:10,results:packageArray,more:!1};resultObj.results.splice(0,0,{tid:"-1",name:ZPI18N.getString("zp.select")}),search(resultObj)})})},paginated:!0},dataMapping:{label:"name",value:"tid",id:"tid",text:"name"},disabled:isDisabled}),Compensation.Currencies.getInitData().then(()=>{OfferLetter.Components.appendCustomProps("currencies","select",{options:Compensation.Currencies.DATA.confCurrList})}),OfferLetter.Components.setCustomProps("currencies","select",{dataMapping:{value:"currencyid",label:"currencycode"},disabled:isDisabled}),OfferLetter.Components.setCustomProps("Offer_Status","select",{...OfferLetter.Components.getZCompOptionsForField("Offer_Status",OfferLetter.Operations.formDetails.formId),disabled:isDisabled}),OfferLetter.Components.setCustomProps("Designation","select",{...OfferLetter.Components.getZCompOptionsForField("Designation",CPortal.candformId),placeholder:ZPI18N.getString("zp.select"),disabled:isDisabled,showSearchField:!0,dataMapping:{value:"DESIGNATIONID",label:"DESIGNATIONNAME",title:"DESIGNATIONNAME"},dataSource:{search:function(params){return new Promise(function(search,reject){var designationArray,params={};params.sortByType=0,params.method="getDesignationsDetails",url="/getDesignationsList.zp",ZPeople.Request.send(url,params,data=>{designationArray=data.desgDtls,search({delay:10,results:designationArray,more:!1})})})},paginated:!0}}),OfferLetter.Components.setCustomProps("Date_Of_Joining","datefield",{format:dateFmt,disabled:isDisabled}),OfferLetter.Components.setCustomProps("Offer_Expiry","datefield",{format:dateFmt,disabled:isDisabled,min:new Date,change:(event,data)=>{const dojComponent=OfferLetter.Components.getComponent("Date_Of_Joining");if(dojComponent){OfferLetter.Components.setPropForField("Date_Of_Joining","min",data.dateValue),dojComponent.enable();const dojValue=dojComponent.getValue().dateObject;dojValue&&dojValue<data.dateObject&&dojComponent.clear()}}}),OfferLetter.Components.setCustomProps("TemplateId","select",{showSearchField:!0,dataMapping:{label:"fname",value:"tid",id:"tid",text:"fname"},dataSource:{search:function(params){return new Promise(async function(search,reject){const response=await OfferLetter.Tabs.OfferDetails.getMailMergeTemplateList();search({delay:10,results:response})})},paginated:!0},disabled:isDisabled}),isDisabled&&odCard.find("input.ztextbox").addClass("disabled").attr("disabled",isDisabled),OfferLetter.Tabs.OfferDetails.fillBaseCurrency(odCard),OfferLetter.Components.initializeZComponents(OfferLetter.container.find("#cardOfferDetails")),OfferLetter.Tabs.OfferDetails.handleEvents()},handleEvents:()=>{let container=OfferLetter.container;container.find("#hideBrk,#viewBrk").off("click"),container.find("#hideBrk,#viewBrk").on("click",event=>{let ele=$(event.currentTarget);ele.hide().siblings().show(),"viewBrk"==ele.attr("id")?container.find("#brkupDiv").show():container.find("#brkupDiv").hide()}),container.find("#brkupDiv").off("click"),container.find("#brkupDiv").on("click","li",event=>{let ele=$(event.currentTarget);container.find("#brkupDiv li.zpl_act").removeClass("zpl_act"),ele.addClass("zpl_act");let tabid=ele.attr("ref");OfferLetter.Tabs.OfferDetails.showBreakup(tabid)})},showBreakup:tabid=>{let container=OfferLetter.container;container.find("#"+tabid).show(),container.find("div[name=compDiv]:not(#"+tabid+")").hide()},fetchCandidateRecordDetail:async function(odCard,recordId){if(recordId){const URL=`/offerletter/${recordId}/candidate`,[response]=await Compensation.Utils.getRequestAsPromise(URL,{});Compensation.Utils.commonErrorHandler(response),response.candidate?(OfferLetter.Slider.candidateId=recordId,OfferLetter.Tabs.OfferDetails.loadCandidateDetails(odCard,response.candidate),odCard.find("#offerContent").removeClass("zpl_DNI")):OfferLetter.container.find("#candidate_header").addClass("zpl_DNI")}},loadCandidateDetails:(container,candidate)=>{container.find("#Candidate_ID").text(candidate.cid+" - "),container.find("#candidateName").text(candidate.fullName),container.find("#Email").text(candidate.email),container.find("#Mobile").text(candidate.mobile),container.find("#Photo").attr("src",candidate.photo||ZPeople.getDefaultUserImagePath()),container.find("#candidate_header").removeClass("zpl_DNI")},loadOptions:function(query,callback){ZPeople.Request.send("/onboarding/candidate/list",{start:1,searchval:query,searchType:5,ZAID:CPortal.currentPortalZAID},data=>{callback(data.candidateArray)})},loadPackageOptions:function(query,callback){const params={data:JSON.stringify({candidateId:OfferLetter.Components.getSelectValue("candidateId")})};ZPeople.Request.sendRequest("/offerletter/salarypackages",params,"GET",data=>{callback(data.tempDetails)})},loadTemplateInfo:(odCard,currentTemplate,allComps,oneTimeObj,amount,isDisabled=!1)=>{const tempDetails=currentTemplate.tempDetails,value=void 0!==amount?amount:tempDetails[0].ctc;odCard.find("#currCode").text(tempDetails[0].currCode),odCard.find("#currCode").attr("currency",tempDetails[0].currency),odCard.find("#Amount").val(value),odCard.find("#Amount").removeClass("is-disabled"),odCard.find("#Amount").removeAttr("disabled");const{ctcRows:ctcRows,benRows:benRows,codeVsData:codeVsData}=OfferLetter.Breakup.generateBreakupTable(allComps);odCard.find("#ctcDiv tbody").html(ctcRows),odCard.find("#benDiv tbody").html(benRows);let compConfig={oneTimeObj:oneTimeObj,empParsers:{},codeVsData:codeVsData};compConfig=Compensation.calcBreakup(value,compConfig),OfferLetter.Breakup.calculateBreakup(odCard,compConfig),isDisabled&&odCard.find("#brkupDiv input").addClass("disabled").attr("disabled",isDisabled)},getMailMergeTemplateList:async function(){return Compensation.LetterTemplatesUtil.getClassObj(Compensation.LetterTemplatesUtil.TYPES.OFFER_LETTER).list("Onboarding")},getFieldData:()=>{const odCard=OfferLetter.container.find("#cardOfferDetails");var dateOfJoiningValue=OfferLetter.Components.getDateValue("Date_Of_Joining"),dateOfJoining="";dateOfJoiningValue&&dateOfJoiningValue.dateString&&(dateOfJoining=dateOfJoiningValue.dateString);var offerExpiryValue=OfferLetter.Components.getDateValue("Offer_Expiry"),offerExpiry="";offerExpiryValue&&offerExpiryValue.dateString&&(offerExpiry=offerExpiryValue.dateString);var breakupData=odCard.find("#brkupDiv").data("breakupData"),breakupDetails={};return breakupData&&(breakupDetails=OfferLetter.Breakup.parseBreakupJsn(breakupData)),{recordDetails:{candidateId:OfferLetter.Components.getSelectValue("candidateId"),amount:odCard.find("#Amount").val(),currency:odCard.find("#currCode").attr("currency"),designationId:OfferLetter.Components.getSelectValue("Designation"),dateOfJoining:dateOfJoining,offerExpiry:offerExpiry,offerStatus:OfferLetter.Components.getSelectValue("Offer_Status"),templateId:OfferLetter.Components.getSelectValue("TemplateId"),packageId:OfferLetter.Components.getSelectValue("packageId")},breakupDetails:breakupDetails}},setFieldData:(odCard,data)=>{odCard.find("#Amount").val(data.Amount),data.PackageId?(ZPeopleComponents.select(odCard.find("#packageId")).setValue(data.packageDetails),ZPeopleComponents.select(odCard.find("#currencies")).setValue(data.currencyDetails),OfferLetter.Components.hideElement("currencies","select"),odCard.find("#ofrSalDiv").addClass("ztextbox--group ztextbox--zicon zpl_inpticfild "),odCard.find("#showBrkup").removeClass("zpl_DNI")):(OfferLetter.Components.showElement("currencies","select"),odCard.find("#ofrSalDiv").removeClass("ztextbox--group ztextbox--zicon zpl_inpticfild "),odCard.find("#showBrkup").addClass("zpl_DNI")),"offerLetter"==OfferLetter.Tabs.initiator&&(ZPeopleComponents.select(odCard.find("#candidateId")).setValue({candidateName:data.candidate.fullName,CANDIDATEID:data.candidate.id}),ZPeopleComponents.select(odCard.find("#candidateId")).setAttributes({disabled:!0}),ZPeopleComponents.datefield(odCard.find("#Offer_Expiry")).setValue(new Date(data.Offer_Expiry)),ZPeopleComponents.select(odCard.find("#Offer_Status")).setValue(data.Offer_Status),ZPeopleComponents.select(odCard.find("#TemplateId")).setValue(data.templateDetails)),ZPeopleComponents.datefield(odCard.find("#Date_Of_Joining")).setValue(new Date(data.Date_Of_Joining)),ZPeopleComponents.select(odCard.find("#Designation")).setValue(data.Designation)},addUpdateRecord:async modal=>{OfferLetter.container.find("#saveButton").addClass("disabled").prop("disabled",!0);const url=OfferLetter.Tabs.isAddMode()?"/offerletter/create":`/offerletter/${OfferLetter.Slider.recordId}/update`;var params={data:JSON.stringify(OfferLetter.Tabs.OfferDetails.getFieldData())};const response=await Compensation.Utils.sendReqAsPromise(url,params);return OfferLetter.container.find("#saveButton").removeClass("disabled").prop("disabled",!1),7e3==response.code?(ZP5Views.refreshview(!0),OfferLetter.Slider.recordId=response.recordId,OfferLetter.Slider.nextTab(),!0):response.isValidationError?(response.message.forEach(function(error){Compensation.Utils.showNewInlineErrTxt(modal.modalDiv.find(`#${error.field}`),ZPI18N.getString("zp.reqdfield"),1)}),ZP5Views.refreshview(!0),!1):(OfferLetter.container.find("#saveButton").removeClass("disabled").prop("disabled",!1),!1)},loadOfferDetails:recordId=>{const formId=OfferLetter.Operations.formDetails.formId;OfferLetter.container.find("#currCode").text(ZP5Form.Field.getFieldValueData(ZP5Form.Field.getFieldComponentByLabel("Currency",formId).formComponentId,formId,recordId).componentValue).attr("currency",ZP5Form.Field.getFieldValueData(ZP5Form.Field.getFieldComponentByLabel("Currency",formId).formComponentId,formId,recordId).componentValue_ID),OfferLetter.container.find("#Amount").val(ZP5Form.Field.getFieldValueData(ZP5Form.Field.getFieldComponentByLabel("Amount",formId).formComponentId,formId,recordId).componentValue),OfferLetter.container.find("#Amount").removeClass("is-disabled"),OfferLetter.container.find("#Amount").removeAttr("disabled"),OfferLetter.container.find("#Date_Of_Joining").removeAttr("disabled"),ZPeopleComponents.datefield(OfferLetter.container.find("#Date_Of_Joining")).setValue(ZP5Form.Field.getFieldValueData(ZP5Form.Field.getFieldComponentByLabel("Date_Of_Joining",formId).formComponentId,formId,recordId).componentValue),ZPeopleComponents.datefield(OfferLetter.container.find("#Offer_Expiry")).setValue(ZP5Form.Field.getFieldValueData(ZP5Form.Field.getFieldComponentByLabel("Offer_Expiry",formId).formComponentId,formId,recordId).componentValue),ZPeopleComponents.select(OfferLetter.container.find("#Designation")).setValue(ZP5Form.Field.getFieldValueData(ZP5Form.Field.getFieldComponentByLabel("Designation",formId).formComponentId,formId,recordId).componentValue_ID),ZPeopleComponents.select(OfferLetter.container.find("#Offer_Status")).setValue(ZP5Form.Field.getFieldValueData(ZP5Form.Field.getFieldComponentByLabel("Offer_Status",formId).formComponentId,formId,recordId).componentValue_ID)},loadEditModeData:(odCard,recordId,isDisabled=!1)=>{OfferLetter.recordManager.getRecord(recordId).then(response=>{const amount=response.Amount;if(OfferLetter.Tabs.OfferDetails.loadCandidateDetails(odCard,response.candidate),OfferLetter.Tabs.OfferDetails.setFieldData(odCard,response),"offerLetter"==OfferLetter.Tabs.initiator&&(OfferLetter.Tabs.OfferDetails.updateApprovalHeader(response.id,response.approvalDetails,OfferLetter.Slider.modalDiv),OfferLetter.Tabs.OfferDetails.updateRecordAuditInfo(recordId,response.auditInfo)),response.PackageId){const URL=`/offerletter/${response.PackageId}/salarypackage`,params={data:JSON.stringify({})};return{nextPromise:Compensation.Utils.getRequestAsPromise(URL,params),amount:amount}}return{nextPromise:Promise.resolve([{}]),amount:amount}}).then(data=>{const{nextPromise:nextPromise,amount:amount}=data;return nextPromise.then(([templateResponse])=>({templateResponse:templateResponse,amount:amount}))}).then(data=>{const{templateResponse:templateResponse,amount:amount}=data;templateResponse.currentTemplate?(OfferLetter.Tabs.OfferDetails.loadTemplateInfo(odCard,templateResponse.currentTemplate,templateResponse.allComps,templateResponse.oneTimeObj,amount,isDisabled),odCard.find("#currCode").removeClass("zpl_DNI"),OfferLetter.Components.hideElement("currencies","select")):(odCard.find("#currCode").addClass("zpl_DNI"),OfferLetter.Components.showElement("currencies","select")),odCard.find("#offerCard").removeClass("zpl_DNI"),odCard.find("#offerContent").removeClass("zpl_DNI"),odCard.find("#offerLoadingCont").addClass("zpl_DNI")}).catch(error=>{console.log(error)})},updateApprovalHeader:(recordId,approvalDtls,container)=>{if(!approvalDtls)return;let recordOwners=[approvalDtls.recordowner.erecno];OPApprovals.Common.RecordOwner.setOwner(recordId,recordOwners),OPApprovals.Common.RecordOwner.setAddedBy(recordId,approvalDtls.recOwner);let apprParam=new ApprovalParam(approvalDtls.formId,recordId,approvalDtls.tableName,approvalDtls.currentApprovalStatus,!1),layoutParam=new LayoutParam(container,container.find("#fullModHeader"),container.find("#fullModFooter"),"OfferLetter");new ApprovalRecordHeader(apprParam,layoutParam,{isRecordApprover:approvalDtls.isRecordApprover,isPrimaryApprover:approvalDtls.isPrimaryApprover}).show()},updateRecordAuditInfo:(recordId,infoObject)=>{let popover=`<div id="${recordId}recordInfo" class="zpl_popovr zpopover" data-display-type="box" data-type="popover" aria-haspopup="true" aria-expanded="false" tabindex="0" style="right: 90px; top: 35px;"></div>`;OfferLetter.Slider.modalDiv.append(popover),OfferLetter.Slider.modalDiv.find("#createInfo").off("click").on("click",function(event){let infoTypes={cInfo:["Added",ZPI18N.getString("zp.reports.createdby")],mInfo:["Modified",ZPI18N.getString("zp.modifiedby")]},infoContainer='<div class="zpopover__content"><div class="zpl_recinfo" id = "infoContainer">';$.each(infoTypes,(key,value)=>{let obj={};if(infoObject[key]&&(obj.time=infoObject[key].time,obj.hasInfo=!0),infoObject[key]&&(obj.id=ZSEC.Encoder.encodeForHTML(infoObject[key].user.id),obj.name=ZSEC.Encoder.encodeForHTML(infoObject[key].user.dispName),obj.image="/viewPhoto?erecno="+infoObject[key].user.ERECNO,void 0===infoObject[key].user.photopath||""==infoObject[key].user.photopath?obj.image=contactUrl+"/file?ID="+infoObject[key].user.zuid+"&fs=thumb":"null"!=contextPath&&(obj.image="/"+contextPath+obj.image),obj.hasInfo=!0,obj.dispName=obj.name),!obj.hasInfo)return;obj.dispName=void 0!==obj.dispName?obj.dispName:"";let div=`\n\t\t                <label class="lbldivider"><span><em>${value[1]}</em></span></label>\n\t\t                <div class="zpl_em">\n\t\t                    <div class="zpl_emimg">\n\t\t                        ${void 0!==obj.image?"<img src='"+obj.image+"'>":"<span class='zpl_pichr'></span>"}\n\t\t                    </div>\n\t\t                    <div class="zpl_emdts zpl_ellipsis w200">\n\t\t                        <div title = "${obj.dispName}"><em>${void 0!==obj.id?obj.id+" - ":""}</em><b>${void 0!==obj.name?obj.name:""}</b></div>\n\t\t                        <div class="d-flexclmcap10">`+"<em><date>"+`${void 0!==obj.time?obj.time:""}</date></em>\n\t\t                        </div>\n\t\t                    </div>\n\t\t                </div>\n\t\t            `;infoContainer+=div}),infoContainer+="</div></div>",OfferLetter.Slider.modalDiv.find("#"+recordId+"recordInfo").html(infoContainer),OfferLetter.Slider.modalDiv.find("#"+recordId+"recordInfo").toggleClass("zpl_flex")})},getBreakupHtml:()=>`<div class="zpl_secn zpl_pt1" id="brkupDiv" style="display:none;">\n\t\t\t\t\t\t\t            <div class="zpl_hdcnt">\n\t\t\t\t\t\t\t                <ul class="zpl_tabpane">\n\t\t\t\t\t\t\t                    <li ref="ctcDiv" class="zpl_act">\n\t\t\t\t\t\t\t                        <a>${ZPI18N.getString("zp.compensation.CostToTheCompany")}</a>\n\t\t\t\t\t\t\t                    </li>\n\t\t\t\t\t\t\t                    <li ref="benDiv" class="">\n\t\t\t\t\t\t\t                        <a>${ZPI18N.getString("zp.compensation.Benefits")}</a>\n\t\t\t\t\t\t\t                    </li>\n\t\t\t\t\t\t\t                </ul>\n\t\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t\t            <div id="ctcDiv" name="compDiv">\n\t\t\t\t\t\t\t                <table class="zpl_tbl wd100_per">\n\t\t\t\t\t\t\t                    <thead>\n\t\t\t\t\t\t\t                        <tr>\n\t\t\t\t\t\t\t                            <th width="32%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.CtcComponents")}</th>\n\t\t\t\t\t\t\t                            <th width="28%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.AssignedAmount")}\n\t\t\t\t\t\t\t                            </th>\n\t\t\t\t\t\t\t                            <th width="20%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.perMonth")}</th>\n\t\t\t\t\t\t\t                            <th width="20%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.perAnnum")}</th>\n\t\t\t\t\t\t\t                        </tr>\n\t\t\t\t\t\t\t                    </thead>\n\t\t\t\t\t\t\t                    <tbody>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t                    </tbody>\n\t\t\t\t\t\t\t                    <tfoot>\n\t\t\t\t\t\t\t                        <tr>\n\t\t\t\t\t\t\t                            <th width="32%">${ZPI18N.getString("zp.total")}</th>\n\t\t\t\t\t\t\t                            <th width="28%"></th>\n\t\t\t\t\t\t\t                            <th width="20%" name="monthly">0</th>\n\t\t\t\t\t\t\t                            <th width="20%" name="annually">0</th>\n\t\t\t\t\t\t\t                        </tr>\n\t\t\t\t\t\t\t                    </tfoot>\n\t\t\t\t\t\t\t                </table>\n\t\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t\t            <div id="benDiv" name="compDiv" style="display: none;">\n\t\t\t\t\t\t\t                <table class="zpl_tbl wd100_per">\n\t\t\t\t\t\t\t                    <thead>\n\t\t\t\t\t\t\t                        <tr>\n\t\t\t\t\t\t\t                            <th width="32%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.Benefits")}</th>\n\t\t\t\t\t\t\t                            <th width="28%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.AssignedAmount")}\n\t\t\t\t\t\t\t                            </th>\n\t\t\t\t\t\t\t                            <th width="20%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.perMonth")}</th>\n\t\t\t\t\t\t\t                            <th width="20%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.perAnnum")}</th>\n\t\t\t\t\t\t\t                        </tr>\n\t\t\t\t\t\t\t                    </thead>\n\t\t\t\t\t\t\t                    <tbody>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t                    </tbody>\n\t\t\t\t\t\t\t                    <tfoot>\n\t\t\t\t\t\t\t                        <tr>\n\t\t\t\t\t\t\t                            <th width="32%">${ZPI18N.getString("zp.total")}</th>\n\t\t\t\t\t\t\t                            <th width="28%"></th>\n\t\t\t\t\t\t\t                            <th width="20%" name="monthly">0</th>\n\t\t\t\t\t\t\t                            <th width="20%" name="annually">0</th>\n\t\t\t\t\t\t\t                        </tr>\n\t\t\t\t\t\t\t                    </tfoot>\n\t\t\t\t\t\t\t                </table>\n\t\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t\t        </div>`,getHtml:()=>'<div class="zpl_crdcnt" id="offerLoadingCont">'+ZPeople.LOADING_HTML+`</div>\n\t\t\t\t\t<div class="zpl_crd wd100_per zpl_DNI" id="offerCard">\n\t\t\t\t\t    <div class="zpl_crdhdr zpl_static"> \n\t\t\t\t\t    \t<div>   \n\t\t\t\t\t\t        <div class="zpl_info zpl_mb5" id="olinfocard">\n\t\t\t\t\t\t            <p>Widgets are simple embedded UI components that can be written using your own JS Framework to perform the action. It can ensure a seamless integration with your application data by providing a single sign on between Zoho people and any third-party applications.</p>\n\t\t\t\t\t\t        </div>\n\t\t\t\t\t\t        <div class="d-flexclm8 w500">\n\t\t\t\t\t\t            <div>\n\t\t\t\t\t\t                <label>Candidate Name</label>\n\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t            <div>\n\t\t\t\t\t\t                <select id="candidateId" zfctype="select" data-random-dropdown-list-id="true"><option>saodijo</option></select>\n\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t        </div>\n\t\t\t\t\t\t        <div class="zpl_em zpl_mt5 zpl_DNI" id="candidate_header">\n\t\t\t\t\t\t            <div class="zpl_emimg"><img id="Photo" src="" alt="Candidate_Photo"></div>\n\t\t\t\t\t\t            <div class="zpl_flexalign zpl_gap-10">\n\t\t\t\t\t\t                <div><em id="Candidate_ID"></em><b id="candidateName"></b></div>\n\t\t\t\t\t\t                <div class="d-flexclmcap8 d-flexC"><i class="PI_mail"></i><em id="Email"></em></div>\n\t\t\t\t\t\t                <div class="d-flexclmcap8 d-flexC"><i class="PI_frm_phone"></i><em id="Mobile"></em></div>\n\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t        </div>\n\t\t\t\t\t        </div>\n\t\t\t\t\t    </div>\n\t\t\t\t\t    <div class="zpl_crdcnt" id="offerContent">\n\t\t\t\t\t        <div class="zpl_hdcnt zpl_mt8">\n\t\t\t\t\t            <h5>Offer Details</h5>\n\t\t\t\t\t        </div>\n\t\t\t\t\t        <div class="d-flex j-cnt-btwen zpl_ml5">\n\t\t\t\t\t            <div class="zpl_w-100">\n\t\t\t\t\t                <div class="zpl_secnclm">\n\t\t\t\t\t                    <div class="zpl_secn">\n\t\t\t\t\t                        <div>\n\t\t\t\t\t                            <label>Salary Package</label>\n\t\t\t\t\t                            <span id="showBrkup" class="ML10">\n\t\t\t\t\t                                <a data-popup-open="" id="hideBrk" style="display: none;">${ZPI18N.getString("zp.compensation.HideBreakup")}</a>\n\t\t\t\t\t                                <a data-popup-open="" id="viewBrk">${ZPI18N.getString("zp.compensation.ViewBreakup")}</a>\n\t\t\t\t\t                            </span>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                        <div class="ztextbox--group">\n\t\t\t\t\t                            <div class="w550">\n\t\t\t\t\t                                <select zfctype="select" id="packageId" data-random-dropdown-list-id="true"></select>\n\t\t\t\t\t                            </div>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                    <div class="zpl_secn">\n\t\t\t\t\t                        <div>\n\t\t\t\t\t                            <label>Offered Salary</label>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                        <div id="ofrSalDiv" class="zh-alignleft w550">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="w550 d-flex">\n\t\t\t\t\t                            <i class="ztextbox__icon zpl_DNI" id="currCode" currency="" disabled></i>\n\t\t\t\t\t                            <select zfctype="select" id="currencies" data-random-dropdown-list-id="true" class="select-js w100 MR10"></select>\n\t\t\t\t\t                            <input type="text" id="Amount" class="ztextbox">\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                </div>\n\t\t\t\t\t\n\t\t\t\t\t                <div class="zpl_secn zpl_pt1" id="brkupDiv" style="display:none;">\n\t\t\t\t\t                    <div class="zpl_hdcnt">\n\t\t\t\t\t                        <ul class="zpl_tabpane">\n\t\t\t\t\t                            <li ref="ctcDiv" class="zpl_act">\n\t\t\t\t\t                                <a>${ZPI18N.getString("zp.compensation.CostToTheCompany")}</a>\n\t\t\t\t\t                            </li>\n\t\t\t\t\t                            <li ref="benDiv" class="">\n\t\t\t\t\t                                <a>${ZPI18N.getString("zp.compensation.Benefits")}</a>\n\t\t\t\t\t                            </li>\n\t\t\t\t\t                        </ul>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                    <div id="ctcDiv" name="compDiv">\n\t\t\t\t\t                        <table class="zpl_tbl wd100_per">\n\t\t\t\t\t                            <thead>\n\t\t\t\t\t                                <tr>\n\t\t\t\t\t                                    <th width="32%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.CtcComponents")}</th>\n\t\t\t\t\t                                    <th width="28%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.AssignedAmount")}</th>\n\t\t\t\t\t                                    <th width="20%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.perMonth")}</th>\n\t\t\t\t\t                                    <th width="20%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.perAnnum")}</th>\n\t\t\t\t\t                                </tr>\n\t\t\t\t\t                            </thead>\n\t\t\t\t\t                            <tbody>\n\t\t\t\t\t                                <tr name="Basic" type="3">\n\t\t\t\t\t                                    <td>Basic Pay</td>\n\t\t\t\t\t                                    <td>\n\t\t\t\t\t                                        <input type="text" name="calcValue" class="ztextbox w100" value="50.00">\n\t\t\t\t\t                                        <span>% of CTC</span>\n\t\t\t\t\t                                    </td>\n\t\t\t\t\t                                    <td name="monthly"></td>\n\t\t\t\t\t                                    <td name="annually">0</td>\n\t\t\t\t\t                                </tr>\n\t\t\t\t\t                                <tr name="Fixed_Allowance" type="1">\n\t\t\t\t\t                                    <td>Fixed Allowance<i class="PI_info tooltip-js" data-title-position="right" data-html="true" title="System calculated:CTC-sum of pay components in the package = Fixed allowance"></i></td>\n\t\t\t\t\t                                    <td><span>System calculation</span></td>\n\t\t\t\t\t                                    <td name="monthly"></td>\n\t\t\t\t\t                                    <td name="annually">0</td>\n\t\t\t\t\t                                </tr>\n\t\t\t\t\t                            </tbody>\n\t\t\t\t\t                            <tfoot>\n\t\t\t\t\t                                <tr>\n\t\t\t\t\t                                    <th width="32%">${ZPI18N.getString("zp.total")}</th>\n\t\t\t\t\t                                    <th width="28%"></th>\n\t\t\t\t\t                                    <th width="20%" name="monthly">0</th>\n\t\t\t\t\t                                    <th width="20%" name="annually">0</th>\n\t\t\t\t\t                                </tr>\n\t\t\t\t\t                            </tfoot>\n\t\t\t\t\t                        </table>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                    <div id="benDiv" name="compDiv" style="display: none;">\n\t\t\t\t\t                        <table class="zpl_tbl wd100_per">\n\t\t\t\t\t                            <thead>\n\t\t\t\t\t                                <tr>\n\t\t\t\t\t                                    <th width="32%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.Benefits")}</th>\n\t\t\t\t\t                                    <th width="28%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.AssignedAmount")}</th>\n\t\t\t\t\t                                    <th width="20%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.perMonth")}</th>\n\t\t\t\t\t                                    <th width="20%" class="zpl_posnon">${ZPI18N.getString("zp.compensation.perAnnum")}</th>\n\t\t\t\t\t                                </tr>\n\t\t\t\t\t                            </thead>\n\t\t\t\t\t                            <tbody>\n\t\t\t\t\t                                <tr id="noBefTr">\n\t\t\t\t\t                                    <td colspan="5" style="text-align: center;">\n\t\t\t\t\t                                        <div class="zpl_Emptydata">\n\t\t\t\t\t                                            <div>\n\t\t\t\t\t                                                <div class="zpl_emptimg zp_nd_nodata1" style="width: 140px;height: 120px;margin: auto;display: block;margin-bottom: 5px;"></div>\n\t\t\t\t\t                                                <p>No Benefits Tagged</p>\n\t\t\t\t\t                                            </div>\n\t\t\t\t\t                                        </div>\n\t\t\t\t\t                                    </td>\n\t\t\t\t\t                                </tr>\n\t\t\t\t\t                            </tbody>\n\t\t\t\t\t                            <tfoot>\n\t\t\t\t\t                                <tr style="display: none;">\n\t\t\t\t\t                                    <th width="32%">${ZPI18N.getString("zp.total")}</th>\n\t\t\t\t\t                                    <th width="28%"></th>\n\t\t\t\t\t                                    <th width="20%" name="monthly">0</th>\n\t\t\t\t\t                                    <th width="20%" name="annually">0</th>\n\t\t\t\t\t                                </tr>\n\t\t\t\t\t                            </tfoot>\n\t\t\t\t\t                        </table>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                </div>\n\t\t\t\t\t\n\t\t\t\t\t                <div class="zpl_secnclm">\n\t\t\t\t\t                \t<div class="zpl_secn">\n\t\t\t\t\t                        <div>\n\t\t\t\t\t                            <label>Offer Expiry</label>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                        <div class="w550">\n\t\t\t\t\t                            <input zfctype="datefield" id="Offer_Expiry" data-calendar-icon="true" data-picker="true" data-spin-buttons="none" data-clear-button="none">\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                    <div class="zpl_secn">\n\t\t\t\t\t                        <div>\n\t\t\t\t\t                            <label>Date of Joining</label>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                        <div class="w550">\n\t\t\t\t\t                            <input zfctype="datefield" id="Date_Of_Joining" data-calendar-icon="true" data-picker="true" data-spin-buttons="none" data-clear-button="none">\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                </div>\n\t\t\t\t\t\n\t\t\t\t\t                <div class="zpl_secnclm">\n\t\t\t\t\t                    <div class="zpl_secn">\n\t\t\t\t\t                        <div>\n\t\t\t\t\t                            <label>Offered Designation</label>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                        <div class="w550">\n\t\t\t\t\t                            <select zfctype="select" id="Designation" data-random-dropdown-list-id="true"></select>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                    <div class="zpl_secn">\n\t\t\t\t\t                        <div>\n\t\t\t\t\t                            <label>Offer Status</label>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                        <div class="w550">\n\t\t\t\t\t                            <select zfctype="select" id="Offer_Status" data-random-dropdown-list-id="true"></select>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                </div>\n\t\t\t\t\t            </div>\n\t\t\t\t\t        </div>\n\t\t\t\t\t\n\t\t\t\t\t        <div class="zpl_hdcnt zpl_mt8">\n\t\t\t\t\t            <h5>Offer Templates</h5>\n\t\t\t\t\t        </div>\n\t\t\t\t\t        <div class="zpl_secn zpl_ml5">\n\t\t\t\t\t            <div>\n\t\t\t\t\t                <label>Choose Template</label>\n\t\t\t\t\t            </div>\n\t\t\t\t\t            <div class="ztextbox--group">\n\t\t\t\t\t                <div class="w550">\n\t\t\t\t\t                    <select zfctype="select" id="TemplateId" data-random-dropdown-list-id="true"></select>\n\t\t\t\t\t                </div>\n\t\t\t\t\t                <span class="ML10">\n\t\t\t\t\t                    <a id="">Generate</a>\n\t\t\t\t\t                </span>\n\t\t\t\t\t            </div>\n\t\t\t\t\t        </div>\n\t\t\t\t\t\n\t\t\t\t\t        <div class="zpl_pt5 zpl_DNI">\n\t\t\t\t\t            <div class="zpl_gbox zpl_ol_gbox w400">\n\t\t\t\t\t                <div class="zpl_dashcard">\n\t\t\t\t\t                    <div class="zpl_dashhead">\n\t\t\t\t\t                        <div>\n\t\t\t\t\t                            <b>Salary Structure</b>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                    <div class="zpl_dashbody">\n\t\t\t\t\t                        <div class="zpl_dashcht">\n\t\t\t\t\t                            <div class="zpl_ol_ctc">\n\t\t\t\t\t                                <div>\n\t\t\t\t\t                                    <span>Monthly CTC</span>\n\t\t\t\t\t                                    <b>2,80,000.00</b>\n\t\t\t\t\t                                </div>\n\t\t\t\t\t                                <div>\n\t\t\t\t\t                                    <span>Yearly CTC</span>\n\t\t\t\t\t                                    <b>33,60,000.00</b>\n\t\t\t\t\t                                </div>\n\t\t\t\t\t                            </div>\n\t\t\t\t\t                            <div class="pie-data" id="esthrs" style="width: 150px; height: 150px; margin:10px auto 5px;"></div>\n\t\t\t\t\t                            <div class="zpl_dashchtdes">\n\t\t\t\t\t                                <ul>\n\t\t\t\t\t                                    <li>\n\t\t\t\t\t                                        <div>\n\t\t\t\t\t                                            <div class="cod" style="background-color:#579DE6;"></div>\n\t\t\t\t\t                                            Earnings\n\t\t\t\t\t                                        </div>\n\t\t\t\t\t                                        <b>1,59,000.00</b>\n\t\t\t\t\t                                    </li>\n\t\t\t\t\t                                    <li>\n\t\t\t\t\t                                        <div>\n\t\t\t\t\t                                            <div class="cod" style="background-color:#eee;"></div>\n\t\t\t\t\t                                            Reimbursements\n\t\t\t\t\t                                        </div>\n\t\t\t\t\t                                        <b>3,400.00</b>\n\t\t\t\t\t                                    </li>\n\t\t\t\t\t                                    <li>\n\t\t\t\t\t                                        <div>\n\t\t\t\t\t                                            <div class="cod" style="background-color:#eee;"></div>\n\t\t\t\t\t                                            Deductions\n\t\t\t\t\t                                        </div>\n\t\t\t\t\t                                        <b>6,304.00</b>\n\t\t\t\t\t                                    </li>\n\t\t\t\t\t                                </ul>\n\t\t\t\t\t                            </div>\n\t\t\t\t\t                        </div>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                </div>\n\t\t\t\t\t            </div>\n\t\t\t\t\t        </div>\n\t\t\t\t\t    </div>\n\t\t\t\t\t</div>`},Preview:{name:ZPI18N.getString("zp.preview"),sliderCallback:async modal=>{if(modal.isCardIntialCallback()){let recId=OfferLetter.Slider.recordId;OfferLetter.Tabs.isViewMode()&&(OfferLetter.recordManager.getRecord(recId).then(response=>{OfferLetter.Slider.fileInfo=response.fileInfo,OfferLetter.Slider.fhObj=new OfferFileHandler(recId,response.fileInfo),OfferLetter.Slider.fhObj.construct}),OfferLetter.Tabs.Preview.footerCallback())}},validateCallback:async modal=>!0,headerCallback:()=>{0==OfferLetter.container.find("#previewformheader").length&&$('<span id="previewformheader" class="zpl_mhderrgt DNI"><button class="zlabel zlabel--outline zlabel--medium" id="rolepreviewbtn"></button></span>').insertBefore(OfferLetter.container.find("#closeMark"))},isEnabled:()=>!OfferLetter.Tabs.isAddMode(),isAllowed:()=>OfferLetter.Tabs.isAllowed("PreviewForm"),isOnlyCustomize:function(){return!0},footerCallback:()=>{OfferLetter.recordManager.getRecord(OfferLetter.Slider.recordId).then(resp=>{if(!resp)return;let isApproved=!OfferLetter.Operations.formDetails.isApprovalAvailable||OfferLetter.Operations.formDetails.isApprovalAvailable&&resp.approvalStatus==zpconst.ApprovalStatus.Approved;0==OfferLetter.container.find("#fullModFooter #sendLtr").length&&(OfferLetter.container.find("#fullModFooter #saveButton").after(`<button class="zlabel zlabel--blue zlabel--medium DN" id="sendLtr">${ZPI18N.getString("zp.appt.sendToCandidate")}</button>`),OfferLetter.container.find("#sendLtr").on("click",()=>{OfferLetter.Slider.fhObj.send(resp=>{resp.hasError||(OfferLetter.container.find("#sendLtr").addClass("DN"),OfferLetter.container.find("#withdrawLtr").removeClass("DN"),OfferLetter.Slider.doRefresh=!0)})})),0==OfferLetter.container.find("#fullModFooter #withdrawLtr").length&&OfferLetter.container.find("#withdrawLtr").on("click",()=>{OfferLetter.Slider.fhObj.withdraw(resp=>{resp.hasError||(OfferLetter.container.find("#withdrawLtr").addClass("DN"),OfferLetter.Slider.doRefresh=!0)})}),OfferLetter.Tabs.isViewMode()&&0==OfferLetter.container.find("#fullModFooter #regenRecord").length&&(OfferLetter.container.find("#fullModFooter #saveButton").after(`<button class="zlabel zlabel--blue zlabel--medium" id="regenRecord">${ZPI18N.getString("zp.regenerateLetter")}</button>`),OfferLetter.container.find("#regenRecord").on("click",()=>{OfferLetter.Slider.remove()})),resp.fileInfo.fileStatus==OfferLetter.Slider.fhObj.STATUS.YETTOSENT&&isApproved&&OfferLetter.container.find("#fullModFooter #sendLtr").removeClass("DN")})},closeCallback:()=>{OfferLetter.Components.destroyAll(OfferLetter.container,["#cardCandidate","#cardGeneral"])},getHtml:()=>'<div class="zpl_crd">\n                  <div class="zpl_crdcnt">\n                      <div class="wd100_per">\n                          <div class="">\n                              <div class="zpl_itbl">\n                                  <table> \n                                      <tbody>\n                                          <tr class="d-flexcap">\n                                              <td class="w480 "><b>Zoho People</b></td>\n                                              \n                                          </tr>\n                                      </tbody>\n                                  </table>\n                              </div>\n                              <div class="zpl_secn">\n                                  <div class="d-flexC d-flexcap">\n                                      <div class="d-flexcap ">\n                                          <div class="w480 ">\n                                              <input type="text" class="ztextbox" value="Consider weekends between requested period as leave" disabled="">\n                                          </div>\n                                          \n                                          \n                                      </div>\n                                  </div>\n                                  <div class="d-flexC d-flexcap">\n                                      <div class="d-flexcap">\n                                          <div class="w480">\n                                              <input type="text" class="ztextbox wd100per" value="Consider weekends between requested period as leave" disabled="">\n                                          </div>\n                                          \n                                          \n                                      </div>\n                                  </div>\n                                  \n                              </div>\n                          </div>\n                      </div>\n                  </div>\n              </div>'}};class OfferFileHandler{constructor(recordId,fileInfo,digest){this.recordId=recordId,this.fileInfo=fileInfo,this.fileName=fileInfo&&fileInfo.File_Name,this.fileStatus=fileInfo&&fileInfo.File_Status,this.digest=digest,this.container=void 0,this.divId="offer_pdfViewerDiv",this.isUsrPortal=!!this.digest,this.MODE=Object.freeze({PREVIEW:1,DOWNLOAD:2,PRINT:3,SEND:4,ACCEPT:5,DECLINE:6,WITHDRAW:7}),this.STATUS=Object.freeze({YETTOSENT:2,SENT:3,ACCEPTED:4,DECLINED:5,WITHDRAWN:7})}get construct(){let pg=settingsPage.container;pg.find("#cardPreview").html(this.getHtml()),this.container=pg.find("#"+this.divId),this.refreshHdr,this.eventHander}get eventHander(){this.container.find("a[name=min],a[name=max]").on("click",()=>{this.toggleFullView}),this.container.find("a[name=download]").on("click",()=>{this.download}),this.container.find("button#acceptLtr").on("click",()=>{this.accept}),this.container.find("button#declineLtr").on("click",()=>{this.decline})}getUrl(mode){let url;switch(mode){case this.MODE.PREVIEW:url=`${this.isUsrPortal?`/offerletter/userportal/renderFile?mode=offerletter&digest=${this.digest}`:`/pdfViewer.zp?mode=offerletter&recordId=${this.recordId}`}`;break;case this.MODE.DOWNLOAD:url=`${this.isUsrPortal?`/offerletter/userportal/download?digest=${this.digest}`:`/offerletter/${this.recordId}/download`}`;break;case this.MODE.PRINT:url=`${this.isUsrPortal?`/offerletter/userportal/viewFile?digest=${this.digest}`:`/viewFile?recordId=${this.recordId}&action=offerletter`}`;break;case this.MODE.SEND:url=`/offerletter/${this.recordId}/send`;break;case this.MODE.ACCEPT:url=`/offerletter/userportal/accept?digest=${this.digest}`;break;case this.MODE.DECLINE:url=`/offerletter/userportal/decline?digest=${this.digest}`;break;case this.MODE.WITHDRAW:url=`/offerletter/${this.recordId}/withdraw`}return contextPath&&"undefined"!==contextPath&&"null"!==contextPath&&!url.startsWith(`/${contextPath}/`)&&(url=`/${contextPath}${url}`),url}doExport(url,reqParams={}){let queryParamStr="";for(const[key,value]of Object.entries(reqParams))queryParamStr+=`${""!==queryParamStr?"&":""}${key}=${encodeURIComponent(value)}`;const form=document.createElement("form");form.method="POST",form.target="exportresp",form.action=queryParamStr?`${url}?${queryParamStr}`:url;const hiddenField=document.createElement("input");hiddenField.type="hidden",this.isUsrPortal||(hiddenField.name=csrfParamName,hiddenField.value=csrfToken),form.appendChild(hiddenField),document.body.appendChild(form),form.submit(),document.body.removeChild(form)}get toggleFullView(){this.container.toggleClass("fullScreen")}get preview(){return this.getUrl(this.MODE.PREVIEW)}get download(){this.doExport(this.getUrl(this.MODE.DOWNLOAD))}get print(){return this.getUrl(this.MODE.PRINT)}getConfirmation(mode,okCb){let disPopUp=void 0;switch(mode){case this.MODE.SEND:disPopUp=new SuccessAlertMessage("",ZPI18N.getString("zp.appt.sendLtr"));break;case this.MODE.WITHDRAW:disPopUp=new DeleteAlertMessage("",ZPI18N.getString("zp.appt.withdrawLtr"));break;case this.MODE.ACCEPT:disPopUp=new SuccessAlertMessage("",ZPI18N.getString("zp.appt.acceptLtr"));break;case this.MODE.DECLINE:disPopUp=new DeleteAlertMessage("",ZPI18N.getString("zp.appt.declineLtr"))}disPopUp.yesButtonText=ZPI18N.getString("zp.proceed"),disPopUp.cancelButtonText=ZPI18N.getString("zp.cancel"),disPopUp.callback=okCb,disPopUp.cancelCallback=(()=>{}),disPopUp.show()}send(callback){try{this.getConfirmation(this.MODE.SEND,()=>{ApptLtr.Util.sendReqAsPromise(this.getUrl(this.MODE.SEND)).then(resp=>{ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.appt.sentLtr.succmsg")),this.fileStatus=this.STATUS.SENT,callback&&_.isFunction(callback)&&callback(resp)})})}catch(err){}}withdraw(callback){try{this.getConfirmation(this.MODE.WITHDRAW,()=>{ApptLtr.Util.sendReqAsPromise(this.getUrl(this.MODE.WITHDRAW)).then(resp=>{ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.appt.widrawLtr.succmsg")),this.fileStatus=this.STATUS.WITHDRAWN,callback&&_.isFunction(callback)&&callback(resp)})})}catch(err){}}get accept(){try{this.getConfirmation(this.MODE.ACCEPT,()=>{ApptLtr.Util.sendReqAsPromise(this.getUrl(this.MODE.ACCEPT)).then(resp=>{ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.appt.acceptLtr.succmsg")),this.fileInfo.statusModifiedOn=resp.statusModifiedOn,this.fileStatus=this.STATUS.ACCEPTED,this.refreshHdr,this.container.find("#acceptLtr").parents("div.zo_docFoot").html("")})})}catch(err){}}get decline(){try{this.getConfirmation(this.MODE.DECLINE,()=>{ApptLtr.Util.sendReqAsPromise(this.getUrl(this.MODE.DECLINE)).then(resp=>{ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.appt.declineLtr.succmsg")),this.fileInfo.statusModifiedOn=resp.statusModifiedOn,this.fileStatus=this.STATUS.DECLINED,this.refreshHdr,this.container.find("#declineLtr").parents("div.zo_docFoot").html("")})})}catch(err){}}get showActBtn(){return!(!this.isUsrPortal||this.fileStatus!=this.STATUS.SENT)&&(this.container.find("div.zo_docFoot").removeClass("DNI"),!0)}get refreshHdr(){if(this.isUsrPortal&&(this.fileStatus==this.STATUS.ACCEPTED||this.fileStatus==this.STATUS.DECLINED)&&this.fileInfo.statusModifiedOn){let html=`<div class="zpl_flex-center zpl_gap-2 zpl_mt1">\n\t\t\t\t\t\t\t<i class="${this.fileStatus==this.STATUS.ACCEPTED?"PI_tick2 grn":"PI_tick2 red"}" data-toggle="tooltip" data-placement="top"></i>\n\t\t\t\t\t\t\t<p>${ZPI18N.getString(this.fileStatus==this.STATUS.ACCEPTED?"zp.appt.acceptedOn.msg":"zp.appt.declinedOn.msg",new Array(this.fileInfo.statusModifiedOn))}</p>\n\t\t\t\t\t\t <div>`;this.container.find("div.zo_docHead").append(html)}}getHtml(){return`<div class="zpl_crd zpl_mw-80">\n\t\t\t\t\t<div class="zpl_obPrv zpl_crdcnt" style="height: 100vh;">\n\t\t\t\t\t    <div class="zo_dtbs" data-click="Agreements" style="">\n\t\t\t\t\t        <div class="zo_docadd" id="${this.divId}" style="float: right;width: 100%;">\n\t\t\t\t\t            <div class="zo_docPnl">\n\t\t\t\t\t                <div class="zo_docHead">\n\t\t\t\t\t                        <span name="fileName">${this.fileName}</span>\n\t\t\t\t\t                        <a class="zo_docClose" name="min"><i class="PI_minmz"></i></a>\n\t\t\t\t\t                        <a prop="docProp" class="zo_docExpand" name="max" style="">\n\t\t\t\t\t                            <i class="PI_maxmz blk" data-content="" data-placement="top" data-trigger="hover" data-toggle="tooltip" zptitle="" data-original-title="Expand"></i>\n\t\t\t\t\t                        </a>\n\t\t\t\t\t                        <a name="fileOptions" prop="docProp" href="javascript:var v = window.open('${this.print}');v.print()" style="">\n\t\t\t\t\t                            <i class="PI_print blk" data-content="" data-placement="top" data-trigger="hover" data-toggle="tooltip" zptitle="" data-original-title="Print"></i>\n\t\t\t\t\t                        </a>\n\t\t\t\t\t                        <a prop="docProp" name="download" style="">\n\t\t\t\t\t                            <i class="PI_downld blk" data-content="" data-placement="right" data-trigger="hover" data-toggle="tooltip" zptitle="" data-original-title="Download"></i>\n\t\t\t\t\t                        </a>\n\t\t\t\t\t                </div>\n\t\t\t\t\t                <div class="zo_docLoad">\n\t\t\t\t\t                    <div class="zo_Loded" style="background-color: transparent;">\n\t\t\t\t\t                        <iframe class="b0I" id="viewFileFrame" src=${this.preview} width="100%" height="100%" onload="Layout.Page.container.find(&quot;#viewFileFrame&quot;).removeAttr(&quot;style&quot;);"></iframe>\n\t\t\t\t\t                    </div>\n\t\t\t\t\t                </div>\n\t\t\t\t\t                <div class="zo_docFoot DNI">\n\t\t\t\t\t\t\t\t\t\t${this.showActBtn?`<button class="zlabel zlabel--medium grnbg1 grnbdr1" id="acceptLtr">${ZPI18N.getString("zp.accept")}</button> <button class="zlabel zlabel--medium redbg1 redbdr1" id="declineLtr">${ZPI18N.getString("zp.workflow.decline")}</button>`:""}\n\t\t\t\t\t                </div>\n\t\t\t\t\t            </div>\n\t\t\t\t\t        </div>\n\t\t\t\t\t    </div>\n\t\t\t\t\t</div>\n         \t\t </div>`}}OfferLetter.Breakup={generateBreakupTable:allComps=>{const codeVsData={},rows={ctc:[],benefits:[]};allComps.forEach(comp=>{codeVsData[comp.Component_Code]=comp;const rowHtml=OfferLetter.Breakup.createCompensationRow(comp);comp.Part_Of_CTC?rows.ctc.push(rowHtml):rows.benefits.push(rowHtml)});const noDataHTML=OfferLetter.Breakup.getBenefitsNoDataHTML();return{ctcRows:rows.ctc.join(""),benRows:0!=rows.benefits.length?rows.benefits.join(""):noDataHTML,codeVsData:codeVsData}},createCompensationRow:comp=>{const{Component_Name:name,Component_Code:code,calcTypeId:calcType,isStatic:isStatic,payFreqId:payFreqId,Formula:Formula}=comp,calcValue=OfferLetter.Breakup.getCalculationValue(calcType,comp),calcFrom=OfferLetter.Breakup.getCalculationTypeDisplay(calcType),isFormula=calcType===Compensation.CONSTANTS.CALCTYPE.FORMULA;return`\n\t        <tr name="${code}" type="${calcType}">\n\t            <td>${name}${"Fixed_Allowance"===code?`<i class="PI_info tooltip-js" data-title-position="right" data-html="true" title="${ZPI18N.getString("zp.compensation.fixedallowance.toolTipmsg")}"></i>`:""}</td>\n\t            <td>${OfferLetter.Breakup.createInputField(isStatic,isFormula,calcValue,calcFrom,Formula)}</td>\n\t            <td name="monthly">${payFreqId!==Compensation.components.PAYFREQ_MONTHLY?"---":""}</td>\n\t            <td name="annually"></td>\n\t        </tr>\n\t    `},createInputField:(isStatic,isFormula,calcValue,calcFrom,tooltipText)=>isStatic?`<span>${ZPI18N.getString("zp.compensation.SystemCalculated")}</span>`:isFormula?`\n\t            <span>${ZPI18N.getString("zp.compensation.FormulaCalculated")}</span>\n\t            <i class="PI_info tooltip-js" data-title-position="right" data-html="true" title="${tooltipText}"></i>\n\t        `:`\n\t        <input type="text" name="calcValue" class="ztextbox w100" value="${calcValue}">\n\t        ${calcFrom?`<span>${calcFrom}</span>`:""}\n\t    `,getCalculationTypeDisplay:calcType=>calcType===Compensation.CONSTANTS.CALCTYPE.POC?ZPI18N.getString("zp.compensation.calcFromPerc",new Array(ZPI18N.getString("zp.compensation.ctc"))):calcType===Compensation.CONSTANTS.CALCTYPE.POB?ZPI18N.getString("zp.compensation.calcFromPerc",new Array(ZPI18N.getString("zp.basicSearch"))):"",getCalculationValue:(calcType,comp)=>{switch(calcType){case Compensation.CONSTANTS.CALCTYPE.FLAT:return comp.Amount;case Compensation.CONSTANTS.CALCTYPE.POB:case Compensation.CONSTANTS.CALCTYPE.POC:return comp.Percentage;case Compensation.CONSTANTS.CALCTYPE.FORMULA:return comp.Formula;default:return 0}},getBenefitsNoDataHTML:()=>`<tr id="noBefTr">\n\t\t\t\t\t<td colspan="5" style="text-align: center;">\n\t\t\t\t\t\t<div class="zpl_Emptydata">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div class="zpl_emptimg zp_nd_nodata1" style="width: 140px;height: 120px;margin: auto;display: block;margin-bottom: 5px;">\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<p>${ZPI18N.getString("zp.compensation.revision.noBenefitsTagged")}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>`,initializeCalculator:function(divElement,compConfiguration=null){compConfiguration&&$(divElement).find("div#brkupDiv").data("compConfiguration",compConfiguration);const calculator=new BreakupCalculator(divElement,compConfiguration,"#Amount");return calculator.amountValChangeUpdate(divElement),OfferLetter.Breakup.setCalculator(divElement,calculator),calculator.processConfiguration(),calculator},setCalculator:function(divElement,calculator){$(divElement).find("div#brkupDiv").data("calculator",calculator)},getCalculator:function(divElement){return $(divElement).find("div#brkupDiv").data("calculator")},calculateBreakup:(divElement,compConfiguration)=>{OfferLetter.Breakup.initializeCalculator(divElement,compConfiguration)},parseBreakupJsn(breakupData){let retObj={};for(let code in breakupData){let bObj=breakupData[code],obj={};obj.cid=bObj.cid,obj.Component_Code=bObj.Component_Code,obj.Component_Name=bObj.Component_Name,obj.isStatic=bObj.isStatic,obj.Part_Of_CTC=bObj.Part_Of_CTC,obj.payTypeId=bObj.payTypeId,obj.Pay_Type=bObj.Pay_Type,obj.payFreqId=bObj.payFreqId,obj.Payment_Frequency=bObj.Payment_Frequency,bObj.Part_Of_CTC&&(obj.Component_Category=bObj.Component_Category,obj.compCategoryId=bObj.compCategoryId),obj.calcTypeId=bObj.calcTypeId,obj.Amount=bObj.Amount,obj.Percentage=bObj.Percentage,obj.calcAmt=bObj.calcAmt,obj.monthly=bObj.monthly,obj.annually=bObj.annually,retObj[code]=obj}return retObj}};const BreakupTotalTypes={CTC:"CTC",BENEFITS:"BEN"};class BreakupCalculator{constructor(divElement,compConfiguration,ctcSelector){this.divElement=$(divElement),this.brkupDiv=this.divElement.find("div#brkupDiv"),this.ctcSelector=ctcSelector,this.totals={monthly:{[BreakupTotalTypes.CTC]:0,[BreakupTotalTypes.BENEFITS]:0},annually:{[BreakupTotalTypes.CTC]:0,[BreakupTotalTypes.BENEFITS]:0}},compConfiguration&&this.brkupDiv.data("compConfiguration",compConfiguration),this.hasBenefits=!1,this.bindEvents()}bindEvents(){this.brkupDiv.find("div[name=compDiv] input[name=calcValue]").on("keyup",event=>this.onCompValChange(this.divElement,$(event.currentTarget))),this.divElement.find(this.ctcSelector).off(),this.divElement.find(this.ctcSelector).on("keyup",event=>this.amountValChangeUpdate(this.divElement))}onCompValChange(div,ele){const compConfig=this.brkupDiv.data("compConfiguration"),calcVal=ele.val(),compcode=ele.closest("tr").attr("name"),compObj=compConfig.codeVsData[compcode];compObj.calcTypeId==Compensation.CONSTANTS.CALCTYPE.FLAT?compObj.Amount=calcVal:compObj.Percentage=calcVal,this.amountValChangeUpdate(div)}amountValChangeUpdate(div){const compConfig=this.brkupDiv.data("compConfiguration"),amount=div.find(this.ctcSelector).val().replace(/[,]/g,""),updatedConfig=Compensation.calcBreakup(amount,compConfig);this.brkupDiv.data("compConfiguration",updatedConfig),this.reconstructBreakupDiv(this.brkupDiv)}onCTCChange(){if(this.brkupDiv.find("div[name=compDiv] tbody tr").length>0){let compConfiguration=Compensation.calcBreakup(this.divElement.find(this.ctcSelector).val(),this.brkupDiv.data("compConfiguration"));this.brkupDiv.data("compConfiguration",compConfiguration),this.reconstructBreakupDiv(this.brkupDiv)}}updateComponentRowValues(row,component){const calcInput=row.find("input[name=calcValue]");calcInput.length&&calcInput.val(component.calcTypeId!==Compensation.CONSTANTS.CALCTYPE.FLAT?component.Percentage:component.Amount),row.find("td[name=annually]").text(Math.round(component.annually)),component.payFreqId===Compensation.components.PAYFREQ_MONTHLY&&row.find("td[name=monthly]").text(Math.round(component.monthly))}updateComponentTotals(component){const type=component.Part_Of_CTC?"CTC":"BEN";return this.totals.annually[type]+=Number(component.annually||0),component.payFreqId===Compensation.components.PAYFREQ_MONTHLY&&(this.totals.monthly[type]+=Number(component.monthly||0)),!component.Part_Of_CTC}updateTotalRowDisplay(divEle,type){const rowSelector="CTC"===type?"#ctcDiv":"#benDiv",totalRow=$(divEle).find(`${rowSelector} tfoot tr`);return totalRow.find("th[name=monthly]").text(Math.round(this.totals.monthly[type])),totalRow.find("th[name=annually]").text(Math.round(this.totals.annually[type])),totalRow}reconstructBreakupDiv(divEle){const $divEle=$(divEle),compConfiguration=$divEle.data("compConfiguration");this.totals={monthly:{[BreakupTotalTypes.CTC]:0,[BreakupTotalTypes.BENEFITS]:0},annually:{[BreakupTotalTypes.CTC]:0,[BreakupTotalTypes.BENEFITS]:0}};const benTotalRow=$divEle.find("#benDiv tfoot tr");$divEle.data("breakupData",compConfiguration.codeVsData);const hasBenefits=Object.values(compConfiguration.codeVsData).reduce((hasBen,component)=>{const row=$divEle.find(`tr[name=${component.Component_Code}]`);this.updateComponentRowValues(row,component);const isThisBenefit=this.updateComponentTotals(component);return hasBen||isThisBenefit},!1);this.updateTotalRowDisplay($divEle,"CTC"),this.updateTotalRowDisplay($divEle,"BEN"),benTotalRow[hasBenefits?"show":"hide"]()}getComponentRow(componentCode){return this.brkupDiv.find(`tr[name=${componentCode}]`)}updateComponentUI(component,row){const calcInput=row.find("input[name=calcValue]");if(calcInput.length){const value=component.calcTypeId!==Compensation.CONSTANTS.CALCTYPE.FLAT?component.Percentage:component.Amount;calcInput.val(value)}row.find("td[name=annually]").text(Math.round(component.annually)),component.payFreqId===Compensation.components.PAY_FREQUENCY_MONTHLY&&row.find("td[name=monthly]").text(Math.round(component.monthly))}updateTotals(component){const type=component.Part_Of_CTC?BreakupTotalTypes.CTC:BreakupTotalTypes.BENEFITS;this.totals.annually[type]+=Number(component.annually),component.payFreqId===Compensation.components.PAY_FREQUENCY_MONTHLY&&(this.totals.monthly[type]+=Number(component.monthly)),component.Part_Of_CTC||(this.hasBenefits=!0)}updateTotalRow(type){const divId=type===BreakupTotalTypes.CTC?"ctcDiv":"benDiv",totalRow=this.brkupDiv.find(`#${divId} tfoot tr`);totalRow.find("th[name=monthly]").text(Math.round(this.totals.monthly[type])),totalRow.find("th[name=annually]").text(Math.round(this.totals.annually[type])),type===BreakupTotalTypes.BENEFITS&&totalRow[this.hasBenefits?"show":"hide"]()}processConfiguration(){const config=this.brkupDiv.data("compConfiguration");if(!config)return;this.totals={monthly:{[BreakupTotalTypes.CTC]:0,[BreakupTotalTypes.BENEFITS]:0},annually:{[BreakupTotalTypes.CTC]:0,[BreakupTotalTypes.BENEFITS]:0}};const breakupData=config.codeVsData;this.brkupDiv.data("breakupData",breakupData),Object.values(breakupData).forEach(component=>{const row=this.getComponentRow(component.Component_Code);this.updateComponentUI(component,row),this.updateTotals(component)})}}OfferLetter.Test={moveColumn:(table,from,to)=>{Array.from(table.rows).forEach(row=>{const cell=row.cells[from];row.deleteCell(from),row.insertCell(to).replaceWith(cell)})},rearrangeColumns:(table,newOrder)=>{let currentOrder=[...Array(table.rows[0].cells.length).keys()];newOrder.forEach((newPos,i)=>{const currentPos=currentOrder.indexOf(newOrder[i]);currentPos!==i&&(OfferLetter.Test.moveColumn(table,currentPos,i),currentOrder.splice(i,0,currentOrder.splice(currentPos,1)[0]))})},colorizeColumn:(table,columnIndex,colorMap)=>{const tbody=table.querySelector("tbody");Array.from(tbody.rows).forEach(row=>{const cell=row.cells[columnIndex],value=cell.textContent.trim();colorMap.has(value)&&(cell.style.backgroundColor=colorMap.get(value))})}};class OfferLetterRecordManager{constructor(){this.records={},this.invalidatedRecords={},this.pendingFetches={},this.getRecord=this.getRecord.bind(this),this.addRecord=this.addRecord.bind(this)}getRecord(id){if(this.records[id]&&!this.invalidatedRecords[id])return Promise.resolve(this.records[id]);if(this.pendingFetches[id])return this.pendingFetches[id];const URL=`offerletter/${id}/read`;var fetchPromise=Compensation.Utils.getRequestAsPromise(URL,{}).then(function(response){const record=response[0];return this.addRecord(record),delete this.pendingFetches[id],record}.bind(this)).catch(function(error){throw delete this.pendingFetches[id],error}.bind(this));return this.pendingFetches[id]=fetchPromise,fetchPromise}addRecord(record){var existingRecord=this.records[record.id];this.records[record.id]=existingRecord?_.merge({},existingRecord,record):record,delete this.invalidatedRecords[record.id]}getBatchRecords(ids){for(var uniqueIds=_.uniq(ids),promises=[],i=0;i<uniqueIds.length;i++)promises.push(this.getRecord(uniqueIds[i]));return Promise.all(promises)}getFilteredRecords(filterFn){var records=_.values(this.records);return _.filter(records,filterFn)}invalidateRecord(id){this.invalidatedRecords[id]=!0}clearCache(){this.records={},this.invalidatedRecords={},this.pendingFetches={}}getCacheInfo(){return{recordCount:_.size(this.records),invalidatedCount:_.size(this.invalidatedRecords),pendingCount:_.size(this.pendingFetches)}}}