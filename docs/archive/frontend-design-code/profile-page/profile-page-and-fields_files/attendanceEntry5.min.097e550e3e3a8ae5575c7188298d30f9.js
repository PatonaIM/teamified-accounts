Attendance.Entry={selectedView:"week",erecno:null,selectedPageView:"list",reloadFromWMS:!0,getShiftListCall:0,enoFromSelfService:null,allowUIEntry:0,prePageId:null,currentDayinView:!1,hasOpenCheckin:!1,entryPopUpAttDate:null,refreshAccrualBreak:!0,isProfilePage:!1,isOtherPageLoaded:!1,init:function(){if(Att_Common_Operations.isModuleDataLoaded){if(Attendance.Entry.isProfilePage="home/user/attendance"==Layout.Page.currentmode,Attendance.Entry.LayoutId=Attendance.Entry.isProfilePage?"#"+Layout.Page.container[0].id:"#"+Layout.Page.parentContainer[0].id,-1!=Attendance.Entry.LayoutId.indexOf("attendance-entry-summary")||-1!=Attendance.Entry.LayoutId.indexOf("operations-attendance-searchuser-summary")||-1!=Attendance.Entry.LayoutId.indexOf("attendance-team-user-summary")||Attendance.Entry.isProfilePage||"home/myspace/calendar"==Layout.Page.currentmode){if(Attendance.Entry.isProfilePage&&Layout.Page.container.addClass("zpl_selfAttpg"),landingPage=$(Attendance.Entry.LayoutId),landingPageId=landingPage[0].id,Attendance.Entry.selectedPageView=Layout.Page.urlparam.mode?Layout.Page.urlparam.mode:Attendance.Entry.selectedPageView,"home/myspace/calendar"==Layout.Page.currentmode||Attendance.Entry.isProfilePage?(Attendance.Entry.selectedPageView=Attendance.Entry.isProfilePage?"list":"calendar",Attendance.Entry.skipPageView=!0):Attendance.Entry.skipPageView=!1,landingPageURL=Att_Common_Operations.getLandingPageURL(),-1===Attendance.Entry.LayoutId.indexOf("attendance-entry-calendarview")&&-1===Attendance.Entry.LayoutId.indexOf("attendance-team-user-calendarview")&&-1===Attendance.Entry.LayoutId.indexOf("operations-attendance-searchuser-calendarview")||(Attendance.Entry.selectedPageView="calendar"),$(Attendance.Entry.LayoutId).find("#attViewMenuDiv").remove(),isManageAttendanceData=ZPeople.Module.MODULE_DATA.attendance.isManageAttedance,isRegConfigured=ZPeople.Module.MODULE_DATA.attendance.isRegConfigured,isOnDutyConfigured=ZPeople.Module.MODULE_DATA.attendance.isOnDutyConfigured,isPermissionConfigured=ZPeople.Module.MODULE_DATA.attendance.isPermissionConfigured,isSPOCEntryEdit=ZPeople.Module.MODULE_DATA.attendance.isSPOCEntryEdit,isEmpChooseApp=ZPeople.Module.MODULE_DATA.attendance.isEmpChooseApp,isEmpChooseAppOD=ZPeople.Module.MODULE_DATA.attendance.isEmpChooseAppOD,Layout.Page.container.popover({selector:"[data-popover].popHover",trigger:"click hover",delay:{show:50,hide:50}}),Layout.Page.container.find("[data-toggle=tooltip]").tooltip({trigger:"click"}),!Shift.shiftList)return 0===$(Attendance.Entry.LayoutId+" .Scrcont").find("#zp_page_loading").length&&$(Attendance.Entry.LayoutId+" .Scrcont").append(ZPeople.LOADING_HTML),0===Attendance.Entry.getShiftListCall&&(Shift.getShiftList(),Attendance.Entry.getShiftListCall=1),void setTimeout(Attendance.Entry.init,100);if(Layout.Page.urlparam.id?Attendance.Entry.isOtherPageLoaded=!0:(Attendance.Entry.erecno=null,Attendance.Entry.isOtherPageLoaded&&(Attendance.Entry.preMonth=0)),-1!==Attendance.Entry.LayoutId.indexOf("selfservice")){Attendance.Entry.erecno=null,Attendance.Entry.loadToday=!1;var headerCont=$(Attendance.Entry.LayoutId+"#ZP-atdancehead");headerCont.show().next().removeAttr("style"),(urlParamId=Layout.Page.urlparam.id)&&urlParamId!==erecno&&(Attendance.Entry.erecno=urlParamId,Attendance.Entry.enoFromSelfService=Attendance.Entry.erecno,headerCont.hide().next().css("margin-top","20px"))}else Attendance.Entry.enoFromSelfService&&(Attendance.Entry.erecno=null,Attendance.Entry.loadToday=!1);var urlParamId;if(Attendance.Entry.isProfilePage)(urlParamId=Layout.Page.urlparam.id)&&urlParamId!==erecno&&(Attendance.Entry.erecno=urlParamId);permission.loadPermissionDetails(void 0,Attendance.Entry.erecno),$(Attendance.Entry.LayoutId).find("#zp_page_loading").remove(),isadmin&&(isManageAttendanceData=!0),document.getElementById("page-wrapper").classList.contains("zpl_btmpgn")||document.getElementById("page-wrapper").classList.add("zpl_btmpgn"),Attendance.Entry.setAttendanceViewHTML();var premonth=Attendance.Entry.preMonth;"month"!==Attendance.Entry.selectedView&&"calendar"!=Attendance.Entry.selectedPageView||(premonth=Attendance.Entry.calendarPreMonth),"list"==Attendance.Entry.selectedPageView?($(Attendance.Entry.LayoutId+" #ZPAtt5_listView").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt5_listView").fadeIn(200),0===$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").children().length?(ZPMaps.loadStatic(),Attendance.Entry.getList(Attendance.Entry.selectedView,premonth,!0)):(-1===Attendance.Entry.LayoutId.indexOf("selfservice")&&1===Attendance.Entry.allDataList.showScaleView?null!==Attendance.Entry.erecno?Layout.Page.container.find("#ZP-atdancehead").addClass("DNI"):(Layout.Page.container.find("#ZP-atdancehead").addClass("DNI"),Attendance.Entry.allowUIEntry||Layout.Page.container.find("#ZP-atdancehead").removeClass("DNI")):-1===Attendance.Entry.LayoutId.indexOf("selfservice")&&(null!==Attendance.Entry.erecno?Layout.Page.container.find("#ZP-atdancehead").addClass("DNI"):(Layout.Page.container.find("#ZP-atdancehead").addClass("DNI"),Attendance.Entry.allowUIEntry||Layout.Page.container.find("#ZP-atdancehead").removeClass("DNI"))),$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").is(":visible")&&null===Attendance.Entry.erecno&&Attendance.Entry.setFunctionInOrOut(),0===Attendance.Entry.preMonth&&($(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").is(":visible")||Attendance.Entry.isOtherPageLoaded)&&null===Attendance.Entry.erecno||!Attendance.Entry.loadToday?(Attendance.Entry.isPrevExtended&&(Attendance.Entry.loadToday=!1),Attendance.Entry.isOtherPageLoaded=!1,Attendance.Entry.getList(Attendance.Entry.selectedView,premonth)):null!==Attendance.Entry.erecno?(Attendance.Entry.loadToday=!1,Attendance.Entry.getList(Attendance.Entry.selectedView,premonth)):(Attendance.Entry.addGroupbuttonsinHeader(),Attendance.Entry.showDayList(Attendance.Entry.allDataList.dayList),Attendance.Entry.showUserDet(Attendance.Entry.allDataList)))):"tabler"==Attendance.Entry.selectedPageView?($(Attendance.Entry.LayoutId+" #ZPAtt5_tabView").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt5_tabView").fadeIn(200),Object.keys(Attendance.Entry.allDataList).length>0&&Attendance.Entry.allDataList.erecno==Attendance.Entry.erecno&&Attendance.Entry.allDataList.viewLoaded==Attendance.Entry.selectedView?(Attendance.Entry.addGroupbuttonsinHeader(),Attendance.Entry.showDayListTabler(Attendance.Entry.allDataList.dayList),Attendance.Entry.showUserDet(Attendance.Entry.allDataList)):Attendance.Entry.getList(Attendance.Entry.selectedView,premonth)):"calendar"==Attendance.Entry.selectedPageView&&(document.getElementById("page-wrapper").classList.remove("zpl_btmpgn"),$(Attendance.Entry.LayoutId+" #ZPAtt5_calView").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt5_calView").fadeIn(200),null!=Attendance.Entry.calendarAllDataList&&Attendance.Entry.calendarAllDataList.dayList&&Attendance.Entry.erecno==Attendance.Entry.calendarAllDataList.erecno?(Attendance.Entry.addGroupbuttonsinHeader(),NewCalendar.initCalendar(Attendance.Entry.calObj),Attendance.Entry.showUserDet(Attendance.Entry.calendarAllDataList)):Attendance.Entry.getList("month",premonth))}}else{var params={initmodule:JSON.stringify({modulePrefix:"attendance"})};ZPeople.Request.send("/gettabdetails/initpage",params,function(result){result.initmodule&&(ZPeople.Module.MODULE_DATA.attendance=result.initmodule,Att_Common_Operations.isModuleDataLoaded=!0,Attendance.Entry.init())})}},setAttendanceViewHTML:function(){var html='<div class="zpl_container" id="mydata_listview">';html+='<div class="zpl_iwrpr" aria-label="'+ZPI18N.getString("zp.common.tabname",[ZPI18N.getString("zp.attendancesummary")])+'" tabindex="0"> <div class="zpl_iwrprrgt"> <div class="zpl_act zpl_attnLstvw'+("list"==Attendance.Entry.selectedPageView?'"':' zpl_tblfxd"')+">",(-1!=Attendance.Entry.LayoutId.indexOf("operations-attendance-searchuser")||Attendance.Entry.isProfilePage)&&(html="");var listView=ZPI18N.getString("zp.listview"),tabView=ZPI18N.getString("zp.tabularview"),calView=ZPI18N.getString("zp.calendarview");if(html+='<div class="zpl_btnmnu">',html+='<div class="zpl_lft"></div>',html+='<div class="zpl_cntrdv">  <div class="zpl_inav"><i class="PI_alft tooltip-js blu zpl_cp" aria-label ="'+ZPI18N.getString("zp.previous")+'" tabindex="0"  title="'+ZPI18N.getString("zp.previous")+'" onclick="Attendance.Entry.setMonthsNavigation(1)"></i> <i class="PI_monthly" id="entryNavDatePicker"></i><i class="PI_argt tooltip-js blu zpl_cp" aria-label ="'+ZPI18N.getString("zp.next")+'" tabindex="0"  title="'+ZPI18N.getString("zp.next")+'" onclick="Attendance.Entry.setMonthsNavigation(-1)"></i></div>',html+='<div elem="dateNavigator" id="ZPAtt_entryNavigation"></div></div>',"list"==Attendance.Entry.selectedPageView){if(null==Attendance.Entry.erecno&&Layout.Page.container.find("#ZP-atdancehead").length>0&&!Layout.Page.container.find("#ZP-atdancehead").hasClass("DNI"))return;Attendance.Entry.isProfilePage?html+='<div class="zpl_rgt"></div></div>':(html+='<div class="zpl_rgt"><div class="grpbtn"><i class="PI_tablview zpl_drpdwn-js zpl_act" mode="grid" id="listViewBtn" onclick="Attendance.Entry.entryPageViewSwitch(\'list\')" title="'+listView+'"></i><i class="PI_listview" mode="grid" id="tabViewBtn" onclick="Attendance.Entry.entryPageViewSwitch(\'tabler\')" title="'+tabView+'"></i><i class="PI_monthly" mode="calendr" onclick="AttendanceTeam.entryPageSwitch(\'calendar\')" title="'+calView+'"></i></div>',html+='<i class="zpl_ibg PI_fltr" aria-label="'+ZPI18N.getString("zp.filter")+'" tabindex="0" id="attSummaryFilter" onclick="Att_Common_Operations.changeFilterClass();" title="'+ZPI18N.getString("zp.filter")+'" ></i>',html+="</div></div>"),html+=Attendance.Entry.getListViewContent()}else"tabler"==Attendance.Entry.selectedPageView?(html+='<div class="zpl_rgt"><div class="grpbtn"><i class="PI_tablview zpl_drpdwn-js" mode="grid" id="listViewBtn" onclick="Attendance.Entry.entryPageViewSwitch(\'list\')" title="'+listView+'"></i><i class="PI_listview zpl_act" mode="grid" id="tabViewBtn"  onclick="Attendance.Entry.entryPageViewSwitch(\'tabler\')" title="'+tabView+'"></i><i class="PI_monthly" mode="calendr" onclick="AttendanceTeam.entryPageSwitch(\'calendar\')" title="'+calView+'"></i></div>',html+='<i class="zpl_ibg PI_fltr" id="attSummaryFilter" onclick="Att_Common_Operations.changeFilterClass();" title="'+ZPI18N.getString("zp.filter")+'" ></i>',html+="</div></div>",html+=Attendance.Entry.getTabViewContent()):"calendar"==Attendance.Entry.selectedPageView&&(html+='<div class="zpl_rgt"><div class="grpbtn"><i class="PI_tablview zpl_drpdwn-js" mode="grid" id="listViewBtn" onclick="Attendance.Entry.entryPageViewSwitch(\'list\')" title="'+listView+'"></i><i class="PI_listview" mode="grid" id="tabViewBtn"  onclick="Attendance.Entry.entryPageViewSwitch(\'tabler\')" title="'+tabView+'"></i><i class="PI_monthly zpl_act" mode="calendr" onclick="AttendanceTeam.entryPageSwitch(\'calendar\')" title="'+calView+'"></i></div>',html+="</div></div>",html+=Attendance.Entry.getCalendarView());let footerHTML=Attendance.Entry.getFooterHTML(),reportHTML=Attendance.Entry.getReportHTML();if($(Attendance.Entry.LayoutId).html(html),Attendance.Entry.setFooter(footerHTML),Attendance.Entry.setReport(reportHTML),Attendance.Entry.skipPageView&&$(Attendance.Entry.LayoutId).find(".grpbtn").addClass("zpl_DNI"),"list"==Attendance.Entry.selectedPageView&&"attendance-entry-summary"===landingPageId){var top=landingPage.find(".zpl_btnmnu").outerHeight(),attHeadCheckInOutDiv=landingPage.find("#ZP-atdancehead");attHeadCheckInOutDiv.length>0&&attHeadCheckInOutDiv.css("top",top+"px")}$(Attendance.Entry.LayoutId).find("#entryNavDatePicker").off().on("click",function(event){var calSettingObj={constructOnWeekstarts:!0},showMonthCalendar="calendar"==Attendance.Entry.selectedPageView||"month"==Attendance.Entry.selectedView;calSettingObj.weekselection=!showMonthCalendar,calSettingObj.attendance=!0,Calendar.setUpCalendar(event,$(this).parent().parent().find("#ZPAtt_entryNavigation").find("b"),showMonthCalendar?2:void 0,void 0,Attendance.Entry.navCalOnSel,void 0,calSettingObj)}),ZPeopleComponents.menu("#listViewBtnoptions",{forElement:"#listViewBtn",contentType:"text"}),ZPeopleComponents.menu("#tabViewBtnoptions",{forElement:"#tabViewBtn",contentType:"text"}),"list"!=Attendance.Entry.selectedPageView&&"tabler"!=Attendance.Entry.selectedPageView||Attendance.Entry.skipPageView||Att_Common_Operations.constructFilterDropdown(landingPage)},getAttEntryData:function(){var filter=landingPage.find(".zpl_fltr");Att_Common_Operations.isFilterOpen()&&Att_Common_Operations.changeFilterClass();var filterDivId=Att_Common_Operations.getFilterDivId(),period=ZPeopleComponents.select(filter.find("#"+filterDivId+"FilterPeriod")).getValue();Attendance.Entry.selectedView="1"===period?"month":"week",Layout.Page.urlparam.mode!=Attendance.Entry.selectedPageView?AttendanceTeam.entryPageSwitch(Attendance.Entry.selectedPageView):Attendance.Entry.getList(Attendance.Entry.selectedView,"zero",!0)},entryPageViewSwitch:function(view){Attendance.Entry.selectedPageView=view,Layout.Page.urlparam.mode!=Attendance.Entry.selectedPageView?AttendanceTeam.entryPageSwitch(Attendance.Entry.selectedPageView):Attendance.Entry.getList(Attendance.Entry.selectedView,"zero",!0)},getCalendarView:function(){var calviewCont='<div id="ZPAtt5_calViewOuterDiv"><div class="zpl_rgtcnt" id="ZPAtt5_calView"><b></b>';return calviewCont+="</div></div>"},getListViewContent:function(){var listviewCont='<div class="zpl_rgtcnt" id="listviw">';return"attendance-entry-summary"===landingPageId&&(listviewCont+='<div class="zpl_dfcrd zpl_timeband zpl_psticky DNI" id="ZP-atdancehead">',listviewCont+='<div class="zpl_timebandlft"> <b id="ZPAtt_userShiftName"> </b>',listviewCont+='<div class="zpl_slct"> <input type="text" class="ztextbox w400" id="ZPAtt_checkInOutDesc" onkeydown="Attendance.Entry.addPunchInOrOutWithNotes(event);" placeholder="Add notes for check-in">',listviewCont+="</div>",listviewCont+="</div>",listviewCont+='<div class="zpl_timebandrgt">',listviewCont+='<div class="zpl_tmrunmid">',listviewCont+='<div class="zpl_brkrunbtn" onclick="Attendance.Entry.punchIn();" id="breakRunningDiv" style="display: none;"><i class="" id="runnerBreakImg"></i>',listviewCont+='<div class="d-flex flex-dirC"><em>'+ZPI18N.getString("zp.resumework")+'</em><b id="breakRemTime"></b>',listviewCont+="</div>",listviewCont+="</div>",listviewCont+='<div class="zpl_ico" id="breakSelDiv" style="display: none;"><span class="PI_brktime icn lv_bgclr7 zpl_popovr-js" data-menu-id="shwBreak" onclick="Attendance.Entry.toggleBreakPopup();"></span>',listviewCont+="</div>",listviewCont+='<div class="zpl_chk-in" id="ZPAtt_check_in_out">',listviewCont+='<div><p>Check-out</p><b id="ZPAtt_clock"></b>',listviewCont+='</div><span style="display: none;" id="ZPATT_Check_in_out_loading"><div class="zpl_ldngring"><div></div><div></div><div></div><div></div></div></span>',listviewCont+="</div>",listviewCont+="</div>",listviewCont+="</div>",listviewCont+="</div>"),Attendance.Entry.isProfilePage||(listviewCont+='<div class="zpl_secn">'),listviewCont+='<div class="zpl_tblres zpl_attscrcnt">',listviewCont+='<div class="zpl_attdrgline"  style="display: none" id="ZPAtt_draggableLine"><span></span><span></span></div>',listviewCont+='<table class="zpl_attscrrw" id="ZPAtt5_listView"><tbody id="ZPAtt5_listViewEntries"></tbody></table>',listviewCont+=Attendance.Entry.getEntryTootTipHtml()+"</div>",listviewCont+="</div>",Attendance.Entry.isProfilePage||(listviewCont+="</div>"),listviewCont+='<div class="zpl_tblpagination" id="ZPAtt5_ListViewfooter"></div>',listviewCont+=Att_Common_Operations.getFilterHtml(),listviewCont+='<div><button id="addPolicy1" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="Attendance.Entry.getAttEntryData();">'+ZPI18N.getString("zp.apply")+'</button> <button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="Attendance.Entry.resetFilterOptions()">'+ZPI18N.getString("zp.reset")+"</button></div>",listviewCont+="</div></div></div>",listviewCont+='<div class="zpl_mdl" data-modal-box="attDayview" id = "ZPAtt_allEntries_popup" class="DN"><div class="zpl_minr" id = "ZPAtt_allEntries_popup_minr">',listviewCont+='<div class="zpl_mhder"><span class="d-flexC zpl_mhdrhd"><h4 id="attEntryHeaderDate"></h4><span class="zpl_dots"></span><div class="d-flexC d-flexclmcap5" id="attEntryHeaderShiftDetails"></div></span><span class="zpl_mhderrgt a-itm-cntr"><a class="zpl_nowrap" data-popup-open="audithistory" id="ZPAtt_entry_AuditEntryPopup" onclick="Attendance.Entry.showAuditPage(\'true\');">'+ZPI18N.getString("zp.audithistory")+'</a></span><a class="_cls PI_cls" onclick="Attendance.Entry.hideAttEntryPage();"></a></div>',listviewCont+='<div class="zpl_mcnt"><div class="zpl_attdtlsinr" id="ZPAtt_entry_allEntriesList"></div><div class="zpl_crd zpl_nopermission" id="ZP5Att_NoEntry" style="display: none"><div class="zpl_crdcnt"><div class="zpl_Emptydata"><div id="ZP5Att_NoEntryCnt"></div></div></div></div></div>',listviewCont+='<div class="zpl_mfoter"><div id="listViewPopupFooter" class="zpl_tblpagination" style="position: inherit;">',listviewCont+='<div class="zpl_lftpgn"><div class="zpl_viewdays">',listviewCont+='<div class="zpl_dytyp grnbdr1" id="firstCheckIn"><span>'+ZPI18N.getString("zp.firstcheckin")+'</span><span id="ZPAtt_firstCheckinInPopup"></span><div class="zpl_rnddoff zpl_popovr-js" id="roundedoffIN" onmouseover=Attendance.Entry.toggleEntryRoudOffPopOver(true) onmouseout=Attendance.Entry.toggleEntryRoudOffPopOver(true)  style="display: none">Rounded off</div></div>',listviewCont+='<div class="zpl_dytyp redbdr1" id="lastCheckOut"><span>'+ZPI18N.getString("zp.lastcheckout")+'</span><span id="ZPAtt_lastCheckoutInPopup"></span><div class="zpl_rnddoff zpl_popovr-js" id="roundedoffOUT" onmouseover=Attendance.Entry.toggleEntryRoudOffPopOver(false) onmouseout=Attendance.Entry.toggleEntryRoudOffPopOver(false) style="display: none">Rounded off</div></div>',listviewCont+="</div></div>",listviewCont+='<div class="" onclick="Attendance.Entry.toggleRegEntries();"><div class="d-flexclmcap10 zpl_popovr-jss CP" id="ZPAtt_entry_appStatus"><i></i>'+ZPI18N.getString("zp.regularized")+"</div></div>",listviewCont+='<div class="zpl_rhtpgn"><div class="zpl_viewdays">',listviewCont+='<div class="zpl_dytyp grnbdr"><span>'+ZPI18N.getString("zp.totalhours")+'</span><span id="ZPAtt_totalHoursInPopup"></span></div>',listviewCont+='<div class="zpl_dytyp blubdr" id="ZPAtt_PaidBreakInPopup"><span>'+ZPI18N.getString("zp.paidbreak")+'</span><span id="ZPAtt_totalBreakHoursInPopup"></span></div>',listviewCont+="</div></div>",listviewCont+="</div></div></div>",listviewCont+='</div><div class="zpl_mdl zpl_msm" id="ZP5AttView_Rep" data-modal-box="leglvelist"></div>'},getTabViewContent:function(){var showOfficeINRemoteIN=Attendance.Entry.showOfficeINRemoteIN(),officeInDname=Att_Common_Operations.isModuleDataLoaded&&ZPeople.Module.MODULE_DATA.attendance.officeINdNameEncoded?ZPeople.Module.MODULE_DATA.attendance.officeINdNameEncoded:ZPI18N.getString("zp.officein"),remoteInDname=Att_Common_Operations.isModuleDataLoaded&&ZPeople.Module.MODULE_DATA.attendance.remoteINdNameEncoded?ZPeople.Module.MODULE_DATA.attendance.remoteINdNameEncoded:ZPI18N.getString("zp.remotein"),tabView='<div class="zpl_rgtcnt" id="ZPAtt5_tabView"><div class="zpl_tblres"><table class="zpl_tbl zpl_attTblview zpl_nocrsor reg_tbl"><thead>';return tabView+='<tr class="ZPLHRow">',tabView+='<th class="mw150">'+ZPI18N.getString("zp.date")+"</th>",tabView+="<th>"+ZPI18N.getString("zp.firstin")+"</th>",tabView+="<th>"+ZPI18N.getString("zp.lastout")+"</th>",tabView+="<th>"+ZPI18N.getString("zp.totalhours")+"</th>",tabView+='<th style="display:none;" id="ZPAtt_showHidePaidBreakTabView">'+ZPI18N.getString("zp.paidbreak")+"</th>",tabView+='<th style="display:none;" id="ZPAtt_showHideUnpaidBreakTabView">'+ZPI18N.getString("zp.unpaidbreak")+"</th>",tabView+='<th style="display:none;" id="ZPAtt_showHidePermissionTabView">'+ZPI18N.getString("zp.perm")+"</th>",tabView+='<th  id="ZPAtt_showHidePayableHrsTabView">'+ZPI18N.getString("zp.payablehours")+"</th>",tabView+='<th  id="ZPAtt_showHideLateNightTabView" class="tblthead">'+ZPI18N.getString("zp.present")+"</th>",tabView+='<th id="ZPAtt_overDevInEntry">'+ZPI18N.getString("zp.overtimedeviation")+"</th>",tabView+='<th id="ZPAtt_totalLateNightEntry">'+ZPI18N.getString("zp.total.latenight")+"</th>",showOfficeINRemoteIN&&(tabView+="<th>"+officeInDname+" "+ZPI18N.getString("zp.hourslog")+"</th>",tabView+="<th>"+remoteInDname+" "+ZPI18N.getString("zp.hourslog")+"</th>"),tabView+='<th id="ZPAtt_CoreHrs">'+ZPI18N.getString("zp.worked.shiftCoreHours")+"</th>",tabView+="<th>"+ZPI18N.getString("zp.status")+"</th>",showOfficeINRemoteIN&&(tabView+="<th>"+officeInDname+"/"+remoteInDname+"</th>"),tabView+="<th>"+ZPI18N.getString("zp.shift")+"</th>",tabView+='<th id="allowanceColumn">'+ZPI18N.getString("zp.shiftallowance")+"</th>",tabView+="<th>"+ZPI18N.getString("zp.regularization")+"</th>",tabView+='<th id="ZPAtt_actionInEntry"></th>',tabView+="</tr>",tabView+="</thead>",tabView+='<tbody id="ZPAtt5_tabViewEntries">',tabView+='<thead id="allowanceFooter" style="display:none;"><tr><th colspan="8" class="text-right"><div  style="margin-right: 90px;"> '+ZPI18N.getString("zp.total")+'</div></th><th colspan="3" id="totalAllowanceAmt"></th></tr></thead>',tabView+="</tbody>",tabView+="</table>",tabView+='<div class="zpl_tblpagination" id="ZPAtt5_ListViewfooter"></div>',tabView+='<div class="zpl_mdl zpl_msm" id="ZP5AttView_Rep" data-modal-box="leglvelist"></div></div>',tabView+=Att_Common_Operations.getFilterHtml(),tabView+='<div><button id="addPolicy1" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="Attendance.Entry.getAttEntryData();">'+ZPI18N.getString("zp.apply")+'</button> <button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="Attendance.Entry.resetFilterOptions()">'+ZPI18N.getString("zp.reset")+"</button></div>"},showOfficeINRemoteIN:function(){return ZPeople.Module.MODULE_DATA.attendance&&(ZPeople.Module.MODULE_DATA.attendance.isOfficeINRemoteINEnabled||ZPeople.Module.MODULE_DATA.attendance.isCustomOfficeINEnabled)},getEntryTootTipHtml:function(){var entryToolTiphtml='<div class="zpl_popovr zpopover zpopover--bottom" data-type="popover" data-display-type="callout" data-position="top" aria-haspopup="true" aria-expanded="true" tabindex="0" onmouseover="{$(this).show();}" onmouseout="{$(this).hide();}" id="ZPAtt_entry_toolTip">';return entryToolTiphtml+='<div class="zpopover__content"> <div class="zpl_popoverinr">',entryToolTiphtml+='<ul id="ZPAtt_entry_toolTip_list"></ul></div></div><div class="zpopover__pointer" style="left: 77.9375px;"></div></div>'},getFooterHTML:function(){return $(Attendance.Entry.LayoutId+" #ZPAtt5_ListViewfooter").find("#ZPAtt5_hoursandDaysTab").find("#ZPAttView5_Days").length>0?$(Attendance.Entry.LayoutId+" #ZPAtt5_ListViewfooter").html():Attendance.Entry.constructFooter()},constructFooter:function(){let timeScaleHTML='<div class="zpl_timescle" id="ZPAtt_timeAndScaleMeasure" style="display: none"><table class="zpl_tbl"><tbody><tr><td width="60"></td><td width="180"></td><td width="24"></td><td id="scaleViewTD">';timeScaleHTML+='<div class="main-time-scale"><div class="clearfix"></div></div></td><td width="24"></td><td width="150"></td><td width="150"></td></tr></tbody></table>';let footerHTML=(timeScaleHTML+="</div>")+'<div class="zpl_lftpgn" id="ZPAtt5_hoursandDaysTab"><div class="zpl_dayhrstab">';return footerHTML+='<ul><li class="zpl_act" id="zp5li_days" onclick="Attendance.Entry.toggleDayHour(\'Day\')"><a>'+ZPI18N.getString("zp.day.plural")+'</a></li><li id="zp5li_hours" onclick="Attendance.Entry.toggleDayHour()"><a>'+ZPI18N.getString("zp.hourslog")+"</a></li></ul></div>",footerHTML+='<div class="zpl_viewdays" id="ZPAttView5_Days"></div>',footerHTML+='<div class="zpl_viewdays DNI" id="ZPAttView5_Hours"></div>',footerHTML+='</div><div class="zpl_rhtpgn" id="ZPAttViewShfitName_Days"></div>'},setFooter:function(footerHTML){$(Attendance.Entry.LayoutId+" #ZPAtt5_ListViewfooter").html(footerHTML)},getReportHTML:function(){return $(Attendance.Entry.LayoutId+" #ZP5AttView_Rep").find("#ZP5AttRep_Daysdiv").find("#ZP5AttView_RepDays").length>0?$(Attendance.Entry.LayoutId+" #ZP5AttView_Rep").html():Attendance.Entry.constructReport()},constructReport:function(){let reportHTML='<div class="zpl_minr"><div class="zpl_mhder"><div><h4>'+ZPI18N.getString("zp.attReport")+'</h4></div><a onclick="Attendance.Entry.hideHourPopup()" class="_cls PI_cls"></a></div>';return reportHTML+='<div class="zpl_mcnt"><div class="tab_strctr"><div class="zpl_hdcnt" style="margin: 0;">',reportHTML+='<ul class="zpl_tabpane"><li id="ZP5AttView_RepDaysTab" onclick="Attendance.Entry.getDayHourView(\'Day\')"><a>'+ZPI18N.getString("zp.day.plural")+'</a></li><li class="zpl_act" id="ZP5AttView_RepHoursTab" onclick="Attendance.Entry.getDayHourView(\'Hour\')"><a >'+ZPI18N.getString("zp.hourslog")+"</a></li></ul>",reportHTML+="</div></div>",reportHTML+='<div class="zpl_tabcnt"><div id="ZP5AttRep_Daysdiv" class="DN"><div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_viewdays a-itm-left flex-dirC" id="ZP5AttView_RepDays"> </div></div></div> </div>',reportHTML+='<div id="ZP5AttRep_Hoursdiv"><div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_viewdays a-itm-left flex-dirC" id="ZP5AttView_RepHours"></div>',reportHTML+="</div></div></div></div></div></div>"},setReport:function(reportHTML){$(Attendance.Entry.LayoutId+" #ZP5AttView_Rep").html(reportHTML)},hideAttEntryPage:function(){$(Attendance.Entry.LayoutId+" #ZPAtt_allEntries_popup").hide()},moreOptionMenu:function(moreOpt,id){$("#moreoptionmenu").length>0&&$("#moreoptionmenu").remove();var moreOptionIcon={import:"imprt",export:"exprt",download:"downld",print:"print",audit:"eye"},iconClass="zmenu--iconwithtext",contentType="icon-text";"ZPAtt_Quick_AddOptions"==id&&(iconClass="",contentType="text");var mhtml='<div id="'+id+"_"+Attendance.Entry.selectedPageView+'" class="zpl_drpdwn zmenu '+iconClass+'"><ul>';$.each(moreOpt,function(indx,value){if(value.type&&value.type in moreOptionIcon){var cssClass=moreOptionIcon[value.type];mhtml+='<li data-action="'+value.callback+'" data-icon-class="PI_'+cssClass+'">',mhtml+='<div class="zmenu__iconcontainer"><i class="zmenu__icon PI_'+cssClass+'"></i></div>'}else mhtml+='<li data-action="'+value.callback+'">';mhtml+='<span class="zmenu__text">'+value.name+"</span></li>"}),mhtml+="</ul></div>",$(Attendance.Entry.LayoutId).append(mhtml),ZPeopleComponents.menu("#"+id+"_"+Attendance.Entry.selectedPageView,{forElement:"#"+id+"Btn_"+Attendance.Entry.selectedPageView,contentType:contentType,appendTo:Layout.Page.pageId})},listDaysOnAttEdit:function(isFrom,index,attDate,date){0==index&&(index=void 0);var page=Layout.Page.container.find("#ZPAtt_entry_allEntriesList"),id=(isFrom?"#ZPAtt_entry_editFromDate":"#ZPAtt_entry_editToDate")+(index?"_"+index:""),statusArr=[];if(statusArr.push({label:ZPI18N.getString("zp.samedayccase"),value:"0"}),statusArr.push({label:ZPI18N.getString("zp.nextday"),value:"1"}),statusArr.push({label:ZPI18N.getString("zp.calprevdayccase"),value:"-1"}),ZPeopleComponents.select(page.find(id)).setAttributes({options:statusArr,multiple:!1,dropdownList:{appendTo:page}}),ZPeopleComponents.select(page.find(id)).setValue("0"),date){var selValue=Attendance.Entry.compareDates(date,moment(attDate,"YYYY-MM-DD"));ZPeopleComponents.select(page.find(id)).setValue(selValue)}},constructTimer:function(isFrom,index,time){0==index&&(index=void 0);var modal=Layout.Page.container.find("#ZPAtt_entry_allEntriesList"),id=(isFrom?"#ZPAtt_entry_editFromTime":"#ZPAtt_entry_editToTime")+(index?"_"+index:"");appendToEle=modal.find(id).closest(".zpl_attetryDv");var attr={format:timeFormat.replace("a","tt"),spinButtons:"none",clearButton:"none",placeholder:"hh:mm",pickerOptions:{appendTo:appendToEle},dropdownList:{appendTo:appendToEle}};ZPeopleComponents.timefield(modal.find(id),attr),time&&ZPeopleComponents.timefield(modal.find(id)).setValue(time)},showMoreOptions:function(){ZPeopleComponents.menu("#attEntryMoreOptions_"+Attendance.Entry.selectedPageView).show()},showMoreReqOptions:function(){ZPeopleComponents.menu("#ZPAtt_Quick_AddOptions_"+Attendance.Entry.selectedPageView).show()},toggleDayHour:function(obj){"Day"==obj?($(Attendance.Entry.LayoutId+" #ZPAttView5_Days").removeClass("DNI"),$(Attendance.Entry.LayoutId+" #zp5li_days").addClass("zpl_act"),$(Attendance.Entry.LayoutId+" #ZPAttView5_Hours").addClass("DNI"),$(Attendance.Entry.LayoutId+" #zp5li_hours").removeClass("zpl_act")):($(Attendance.Entry.LayoutId+" #ZPAttView5_Hours").removeClass("DNI"),$(Attendance.Entry.LayoutId+" #zp5li_hours").addClass("zpl_act"),$(Attendance.Entry.LayoutId+" #ZPAttView5_Days").addClass("DNI"),$(Attendance.Entry.LayoutId+" #zp5li_days").removeClass("zpl_act"))},getHourPopup:function(obj){$("#"+Layout.Page.pageId+" #ZP5AttView_Rep").show(),Attendance.Entry.getDayHourView(obj)},hideHourPopup:function(){$("#"+Layout.Page.pageId+" #ZP5AttView_Rep").hide()},resetFilterOptions:function(){var filterLayout=landingPage.find(".zpl_fltr"),filterDivId=Att_Common_Operations.getFilterDivId();ZPeopleComponents.select(filterLayout.find("#"+filterDivId+"FilterPeriod")).setValue(0)},getDayHourView:function(obj){"Day"==obj?($(Attendance.Entry.LayoutId+" #ZP5AttRep_Hoursdiv").addClass("DN"),$(Attendance.Entry.LayoutId+" #ZP5AttView_RepHoursTab").removeClass("zpl_act"),$(Attendance.Entry.LayoutId+" #ZP5AttView_RepDaysTab").addClass("zpl_act"),$(Attendance.Entry.LayoutId+" #ZP5AttRep_Daysdiv").removeClass("DN")):($(Attendance.Entry.LayoutId+" #ZP5AttRep_Daysdiv").addClass("DN"),$(Attendance.Entry.LayoutId+" #ZP5AttView_RepDaysTab").removeClass("zpl_act"),$(Attendance.Entry.LayoutId+" #ZP5AttView_RepHoursTab").addClass("zpl_act"),$(Attendance.Entry.LayoutId+" #ZP5AttRep_Hoursdiv").removeClass("DN"))},auditDate:null,showAuditPage:function(isFromEntry){$(Attendance.Entry.LayoutId+" #ZPAtt_allEntries_popup").is(":visible")?Attendance.Entry.auditDate=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].attDate:delete Attendance.Entry.auditDate,ZPeople.BSModal.hide("ZPAtt_allEntries_popup"),Attendance.Audit.init(isFromEntry)},getCurrDayEntry:function(rowIndex,fromEntryEdit){var param={mode:"getStatus",conreqcsr:csrfToken};if(null!==rowIndex&&void 0!==rowIndex){var daylist=Attendance.Entry.allDataList.dayList[rowIndex];null!==Attendance.Entry.erecno&&(param.erecno=Attendance.Entry.erecno),daylist.isToday||(param.orgDate=daylist.ldate)}param.isListView=!0,$.post("/AttendanceAction.zp",param,function(rdata){if(null!==rowIndex&&void 0!==rowIndex&&(Attendance.Entry.allDataList.entries[daylist.attDate]=rdata.response,Attendance.Entry.showDayList({0:daylist},$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").children()[rowIndex],fromEntryEdit),Attendance.Entry.getMonthReportForUser(),"undefined"!=typeof ZPDashboard&&ZPCal.Calendar&&ZPCal.Calendar.attendanceStatusHandleCallback(rdata)),Attendance.Dashboard&&(isBrkRunning=rdata.isBreakRunning,layout=$(Attendance.Dashboard.pageLayout()),layout.find("#ZPD_Top_Att_Stat").parent().hide(),!rdata.allowUIEntry)){layout.find("#ZPD_Top_Att_Stat").parent().show();var checkInOutBut=layout.find("#ZPD_Top_Att_Stat").attr("class","in CP").removeAttr("disabled").attr("onclick","Attendance.Dashboard.CurrStatus.updateCheckOut(true)");if(checkInOutBut.removeAttr("style").html(ZPI18N.getString("zp.checkin")+"<svg viewBox='25 25 50 50' class='DN'><circle cx='50' cy='50' r='20'></circle></svg><div class='IC-clock S16'></div>"),Attendance.Dashboard.CurrStatus.currDayData=rdata.response,!1===rdata.allowedToCheckIn&&!rdata.isBreakRunning){(checkInOutBut=layout.find("#ZPD_Top_Att_Stat").attr("class","out CP").removeAttr("disabled").attr("onclick","Attendance.Dashboard.CurrStatus.updateCheckOut()")).removeAttr("style").html(ZPI18N.getString("zp.checkout")+"<svg viewBox='25 25 50 50' class='DN'><circle cx='50' cy='50' r='20'></circle></svg><div class='IC-clock S16'></div>");var entries=rdata.response,finVal=entries[entries.length-1];entries.length>0&&void 0!==finVal.totalSecs&&(Attendance.Dashboard.CurrStatus.display_sec=finVal.totalSecs),entries.length>0&&void 0!==finVal.addSecs?(Attendance.Dashboard.CurrStatus.addsecs=finVal.addSecs,Attendance.Dashboard.CurrStatus.temp_tsecs=0,Attendance.Dashboard.CurrStatus.hasaddsecs=!1):(Attendance.Dashboard.CurrStatus.addsecs=finVal.tsecs,Attendance.Dashboard.CurrStatus.hasaddsecs=!0)}Attendance.Dashboard.DashboardTimer=void 0,Attendance.Dashboard.CurrStatus.getCurrRunningTime(Attendance.Dashboard.CurrStatus.addsecs,Attendance.Dashboard.CurrStatus.hasaddsecs,rdata.allowedToCheckIn,rdata.isBreakRunning),Attendance.isWebCoOrdMandatory=void 0!==rdata.isWebCoOrdMandatory&&rdata.isWebCoOrdMandatory,Attendance.isTrackLocationEnabled=void 0!==rdata.isTrackLocationEnabled&&rdata.isTrackLocationEnabled,Attendance.isAllowToCapturePhotoInWeb=void 0!==rdata.isAllowToCapturePhotoInWeb&&rdata.isAllowToCapturePhotoInWeb,Attendance.isAllowToVerifyUserInWeb=void 0!==rdata.isAllowToVerifyUserInWeb&&rdata.isAllowToVerifyUserInWeb}}).fail(function(data){Attendance.Entry.refreshPage(data)})},currRunningTime:null,setTime:function(rec){var sysTime=new Date;if(Layout.Page.parentContainer[0]){if(Attendance.Entry.LayoutId=Attendance.Entry.isProfilePage?"#"+Layout.Page.container[0].id:"#"+Layout.Page.parentContainer[0].id,null!==rec&&"first"===rec&&(Attendance.Entry.diffTime=sysTime.getTime()-Attendance.Entry.allDataList.currDate.time,clearInterval(Attendance.Entry.timer),Attendance.Entry.timer=setInterval(Attendance.Entry.setTime,1e3),Attendance.Entry.oldTime=sysTime.getTime()),"out"===Attendance.Entry.checkInOut){let totalsecs=Attendance.Entry.updateTotalmins(Math.abs(Math.round((Attendance.Entry.oldTime-sysTime.getTime())/1e3)));Attendance.Entry.checkForAccrualBreak(totalsecs)}Attendance.Entry.oldTime=sysTime.getTime(),sysTime.setTime(sysTime.getTime()-Attendance.Entry.diffTime+36e5*Attendance.Entry.allDataList.currDate.offset);var hours=sysTime.getUTCHours(),mins=sysTime.getUTCMinutes(),seconds=sysTime.getUTCSeconds(),curr_run_time=sysTime.getUTCDate()+"_"+sysTime.getUTCMonth();if(void 0===Attendance.Entry.curr_date)Attendance.Entry.curr_date=curr_run_time;else if(Attendance.Entry.curr_date!==curr_run_time)return Attendance.Entry.curr_date=curr_run_time,Attendance.Entry.temp_tsecs=0,Attendance.Entry.checkInOut="in",clearInterval(Attendance.Entry.timer),void("list"==Attendance.Entry.selectedPageView&&(Attendance.Entry.loadToday=!1,Attendance.Entry.getList()));if($(Attendance.Entry.LayoutId+" #ZPAtt5_listView").is(":visible")&&0===Attendance.Entry.allDataList.showScaleView&&Attendance.Entry.currentDayinView){var leftSideTds=Attendance.Entry.isProfilePage?264:274+$("#zpeople_tabs").width()+10,currTime=hours+mins/60,fromShiftHour=Attendance.Entry.fromShiftTime/60,toShiftHour=Attendance.Entry.toShiftTime/60;0===fromShiftHour&&0===toShiftHour&&(toShiftHour=1439/60);var nightShift=fromShiftHour>toShiftHour&&24-(fromShiftHour-toShiftHour)<=12&&(currTime<=23.99&&currTime>=fromShiftHour||currTime>=0&&currTime<Math.round(toShiftHour))||fromShiftHour===toShiftHour;if((currTime>=fromShiftHour&&currTime<Math.round(toShiftHour)&&toShiftHour-fromShiftHour<=12||nightShift||toShiftHour===1439/60)&&("out"===Attendance.Entry.checkInOut||Attendance.Entry.breakRowOpen)){var temphour=hours-fromShiftHour;nightShift&&currTime>=0&&currTime<Math.round(toShiftHour)&&(temphour=hours+24-fromShiftHour);var per=(3600*temphour+60*mins+seconds)/60/60/Attendance.Entry.shiftDiffTime*100;per>100?per=100:per<0&&(per=0);var progressBarWidth=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").width()-588;$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .zpl_attprgrs")[0]&&(progressBarWidth=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .zpl_attprgrs").width()),per=leftSideTds+progressBarWidth*per/100+1,$(Attendance.Entry.LayoutId+" #ZPAtt_draggableLine").show(),Attendance.Entry.isProfilePage?$(Attendance.Entry.LayoutId+" #ZPAtt_draggableLine").css({left:per,top:"10px",bottom:"0px"}):$(Attendance.Entry.LayoutId+" #ZPAtt_draggableLine").css({left:per})}else $(Attendance.Entry.LayoutId+" #ZPAtt_draggableLine").hide()}if(Attendance.timeFormatIs12hr){var aa=ZPI18N.getString("zp.am");hours>=12&&(aa=ZPI18N.getString("zp.pm"),hours-=12),0===hours&&(hours=12)}else aa="";Attendance.Entry.currRunningTime=Attendance.disTwoDigit(hours)+":"+Attendance.disTwoDigit(mins)+" "+aa.toLowerCase()}},checkForAccrualBreak:function(totalsecs){let breakDetailObj=Attendance.Entry.isMyspace()?Attendance.Entry.curDayBreakDetails:Attendance.Entry.allDataList.curDayBreakDetails;if(void 0!==breakDetailObj&&void 0!==breakDetailObj.isAccrualBreak){if(void 0===Layout.Page.parentContainer.find("#showBreakPopup")||!Layout.Page.parentContainer.find("#showBreakPopup").is(":visible"))return void(Attendance.Entry.refreshAccrualBreak=!0);if(Layout.Page.parentContainer.find("#showBreakPopup").is(":visible")&&0!==parseInt(totalsecs%60)&&!0!==Attendance.Entry.refreshAccrualBreak)return;let breakId=breakDetailObj.isAccrualBreak,accrualBreakObj=Attendance.Entry.allDataList.breakList.breakObj[breakId],breakMins=0;accrualBreakObj.brksOnWorkHrs.forEach(config=>{60*config.workingHrs<=totalsecs&&(breakMins=config.breakTime)});let breakDivObj=Layout.Page.parentContainer.find("#breakListPopUp").find("[breakid="+breakId+"]").next(),breakObj=breakDetailObj.shiftBreakDets[breakId],availedBreakInSecs=void 0!==breakObj.availedBreakInSecs?breakObj.availedBreakInSecs:0,remBreakInSecs=60*breakMins-availedBreakInSecs,breakInfoObj=Layout.Page.parentContainer.find("#breakListPopUp").find("#accrualBreakInfo");breakInfoObj.addClass("zpl_DNI"),breakInfoObj.find("em").each(function(){let allowedBreakMins=$(this).attr("id");allowedBreakMins&&(parseInt(allowedBreakMins)<=breakMins?$(this).addClass("zpl_DNI"):($(this).removeClass("zpl_DNI"),breakInfoObj.removeClass("zpl_DNI")))}),remBreakInSecs<0&&(remBreakInSecs=0),Attendance.Entry.refreshAccrualBreak=!1,Attendance.Entry.consBreakChart(breakId,availedBreakInSecs,remBreakInSecs,accrualBreakObj.breakColor);let breakMinsTxt=remBreakInSecs<60?remBreakInSecs+" "+ZPI18N.getString("zp.secs"):parseInt(remBreakInSecs/60)+" "+ZPI18N.getString("zp.minutes");breakDivObj.find("#breakAllowed").find("b").html(breakMins+" "+ZPI18N.getString("zp.minutes")),breakDivObj.find("#breakRem").find("b").html(breakMinsTxt),breakDivObj.prev().find("#breakStart").find("b").html(Attendance.Entry.getSecsInHHMMSSFormat(availedBreakInSecs)),remBreakInSecs>0?(breakDivObj.prev().find("#breakStart").find("i").attr("onclick","Attendance.Entry.startBreak('"+breakId+"')").bind("click"),breakDivObj.prev().find("#breakStart").find("i").removeClass("zpl_disabl")):(breakDivObj.prev().find("#breakStart").find("i").removeAttr("onclick").unbind("click"),breakDivObj.prev().find("#breakStart").find("i").addClass("zpl_disabl"))}},setMonthsNavigation:function(type){Attendance.Entry.calendarAllDataList=null,"week"===Attendance.Entry.selectedView&&"calendar"!==Attendance.Entry.selectedPageView&&(type*=-1);var preMonth=Attendance.Entry.preMonth;if("calendar"!==Attendance.Entry.selectedPageView&&"month"!=Attendance.Entry.selectedView||(preMonth=Attendance.Entry.calendarPreMonth),Attendance.Entry.LayoutId&&-1!==Attendance.Entry.LayoutId.indexOf("selfservice")){Attendance.Entry.erecno=null;var urlParamId=Layout.Page.urlparam.id;urlParamId&&erecno&&urlParamId!==erecno&&(Attendance.Entry.erecno=urlParamId)}Attendance.Entry.getList(Attendance.Entry.selectedView,preMonth+type)},setDraggableLine:function(){if($(Attendance.Entry.LayoutId+" #ZPAtt5_listView").is(":visible")&&0===Attendance.Entry.allDataList.showScaleView&&Attendance.Entry.currentDayinView){var leftSideTds=Attendance.Entry.isProfilePage?264:274+$("#zpeople_tabs").width()+10,sysTime=new Date;Attendance.Entry.diffTime=sysTime.getTime()-Attendance.Entry.allDataList.currDate.time,sysTime.setTime(sysTime.getTime()-Attendance.Entry.diffTime+36e5*Attendance.Entry.allDataList.currDate.offset);var hours=sysTime.getUTCHours(),mins=sysTime.getUTCMinutes(),seconds=sysTime.getUTCSeconds(),currTime=hours+mins/60,fromShiftHour=Attendance.Entry.fromShiftTime/60,toShiftHour=Attendance.Entry.toShiftTime/60;0===fromShiftHour&&0===toShiftHour&&(toShiftHour=1439/60);var nightShift=fromShiftHour>toShiftHour&&24-(fromShiftHour-toShiftHour)<=12&&(currTime<=23.99&&currTime>=fromShiftHour||currTime>=0&&currTime<Math.round(toShiftHour))||fromShiftHour===toShiftHour;if((currTime>=fromShiftHour&&currTime<Math.round(toShiftHour)&&toShiftHour-fromShiftHour<=12||nightShift||toShiftHour===1439/60)&&("out"===Attendance.Entry.checkInOut||Attendance.Entry.breakRowOpen)){var temphour=hours-fromShiftHour;nightShift&&currTime>=0&&currTime<Math.round(toShiftHour)&&(temphour=hours+24-fromShiftHour);var per=(3600*temphour+60*mins+seconds)/60/60/Attendance.Entry.shiftDiffTime*100;per>100?per=100:per<0&&(per=0);var progressBarWidth=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").width()-588;$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .zpl_attprgrs")[0]&&(progressBarWidth=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .zpl_attprgrs").width()),per=leftSideTds+progressBarWidth*per/100+1,$(Attendance.Entry.LayoutId+" #ZPAtt_draggableLine").show(),Attendance.Entry.isProfilePage?$(Attendance.Entry.LayoutId+" #ZPAtt_draggableLine").css({left:per,top:"10px",bottom:"0px"}):$(Attendance.Entry.LayoutId+" #ZPAtt_draggableLine").css({left:per})}else $(Attendance.Entry.LayoutId+" #ZPAtt_draggableLine").hide()}},preMonth:0,calendarPreMonth:0,allDataList:{},calendarAllDataList:null,checkInOut:null,isEditAllowed:null,isEditAllowedForSub:null,isViewAllowedForSub:null,isEditAllowedForLocationAdmin:!0,loadToday:!1,isTimeSheetAllowedForEntry:null,isSubOrdinate:!1,curDayBreakDetails:{},applyLvDate:void 0,deleteWarning:function(ele,deleteCallback){var htmlContent="";htmlContent+='<div class="zpl_secn"><span>'+ZPI18N.getString("zp.deleteentirerecord")+"</span>";var deleteModal=new DeleteAlertMessage;deleteModal.title=ZPI18N.getString("zp.delete")+" "+ZPI18N.getString("zp.attentries")+"?",deleteModal.despcription=htmlContent,deleteModal.yesButtonText=ZPI18N.getString("zp.confirm"),deleteModal.cancelButtonText=ZPI18N.getString("zp.cancel"),deleteModal.callback=function(){deleteCallback(ele,deleteModal.alertDiv)},deleteModal.show()},getList:function(selview,preMonth,isLoadPrevWeekOrMonth){Attendance.Entry.LayoutId=Attendance.Entry.isProfilePage?"#"+Layout.Page.container[0].id:"#"+Layout.Page.parentContainer[0].id,null!==selview&&""!==selview&&void 0!==selview&&"calendar"!==Attendance.Entry.selectedPageView&&(Attendance.Entry.loadToday=!1,Attendance.Entry.selectedView=selview),Att_Common_Operations.isFilterOpen()&&Att_Common_Operations.changeFilterClass(),$(Attendance.Entry.LayoutId).find("[data-toggle=tooltip]").tooltip("hide"),"calendar"!==Attendance.Entry.selectedPageView&&("week"===Attendance.Entry.selectedView?($(Attendance.Entry.LayoutId+" #ZPAtt_weekViewBut").attr("class","btn btn-primary togg"),$(Attendance.Entry.LayoutId+" #ZPAtt_monViewBut").attr("class","btn btn-default togg")):"month"===Attendance.Entry.selectedView&&($(Attendance.Entry.LayoutId+" #ZPAtt_weekViewBut").attr("class","btn btn-default togg"),$(Attendance.Entry.LayoutId+" #ZPAtt_monViewBut").attr("class","btn btn-primary togg")));var param={mode:"getAttList",conreqcsr:csrfToken};TimelySettings.showHideLoadingPage(!1,!0),"calendar"!==Attendance.Entry.selectedPageView?(param.loadToday=!1,Attendance.Entry.loadToday&&(param.loadToday=!0),Attendance.Entry.loadToday=!0):param.isCalView=!0,param.loadToday||("list"===Attendance.Entry.selectedPageView?(TimelySettings.showHideLoadingPage(!0,!0,"ZPAtt5_listView"),$(Attendance.Entry.LayoutId+" #ZPAtt_draggableLine").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").empty(),$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewHead").empty()):"tabler"===Attendance.Entry.selectedPageView?(TimelySettings.showHideLoadingPage(!0,!0,"ZPAtt5_tabView"),$(Attendance.Entry.LayoutId+" #ZPAtt5_tabViewEntries").empty(),$(Attendance.Entry.LayoutId+" #ZPAtt5_tabView thead").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt5_tabView #allowanceFooter").hide()):"calendar"==Attendance.Entry.selectedPageView&&(TimelySettings.showHideLoadingPage(!0,!0,"ZPAtt5_calView"),$(Attendance.Entry.LayoutId+" #ZPAtt5_calView").empty())),Attendance.Entry.erecno&&(param.erecno=Attendance.Entry.erecno),"zero"!==preMonth&&void 0!==preMonth||(preMonth=0),param.view=Attendance.Entry.selectedView,null!==preMonth?(param.preMonth=preMonth,"calendar"===Attendance.Entry.selectedPageView||"month"==Attendance.Entry.selectedView?(Attendance.Entry.calendarPreMonth=preMonth,param.view="month"):Attendance.Entry.preMonth=preMonth):"calendar"===Attendance.Entry.selectedPageView||"month"==Attendance.Entry.selectedView?(param.preMonth=Attendance.Entry.calendarPreMonth,param.view="month"):Attendance.Entry.preMonth&&(param.preMonth=Attendance.Entry.preMonth),"tabler"===Attendance.Entry.selectedPageView&&0===param.preMonth&&(Attendance.Entry.loadToday=!1),param.erecno||param.loadToday||"week"!==param.view||void 0===weekstarts||(param.weekStarts=weekstarts+1);var layout=Attendance.Entry.LayoutId;ZPUtil.checkIsOtherUserProfile()&&(param.isFmSService=!0),clearInterval(Attendance.Entry.timer),$.post("/AttendanceViewAction.zp",param,function(rdata){(TimelySettings.showHideLoadingPage(!1,!0),$(Attendance.Entry.LayoutId).find("[data-toggle=tooltip]").tooltip("hide"),rdata.permissiondenied)&&new EmptyPages("zp_nd_permission",ZPI18N.getString("zp.nopermission"),"",$(Attendance.Entry.LayoutId)).show();if("hh:mm a"!==rdata.timeformat?Attendance.timeFormatIs12hr=!1:Attendance.timeFormatIs12hr=!0,void 0!==rdata.isSubOrdinate&&(Attendance.Entry.isSubOrdinate=rdata.isSubOrdinate),Attendance.Entry.erecno||(void 0!==rdata.isEditAllowed&&(Attendance.Entry.isEditAllowed=rdata.isEditAllowed),void 0!==rdata.isViewAllowedForSub&&(Attendance.Entry.isViewAllowedForSub=rdata.isViewAllowedForSub)),void 0!==rdata.isEditAllowedForSub&&(Attendance.Entry.isEditAllowedForSub=rdata.isEditAllowedForSub),void 0!==rdata.isEditAllowedForLocationAdmin&&(Attendance.Entry.isEditAllowedForLocationAdmin=rdata.isEditAllowedForLocationAdmin),rdata.curDayBreakDetails&&(Attendance.Entry.curDayBreakDetails=rdata.curDayBreakDetails),void 0!==rdata.isTimeSheetAllowedForEntry&&(Attendance.Entry.isTimeSheetAllowedForEntry=rdata.isTimeSheetAllowedForEntry),Attendance.Entry.reportStartDate=rdata.reportStartDate,"list"===Attendance.Entry.selectedPageView&&layout===Attendance.Entry.LayoutId){if(param.loadToday)return Attendance.Entry.allDataList.currDate=rdata.currDate,Attendance.Entry.loadReport=!0,Attendance.Entry.allDataList.dayList[$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").index()].attDate!==rdata.dayList[0].attDate?(Attendance.Entry.loadToday=!1,Attendance.Entry.temp_tsecs=0,Attendance.Entry.display_sec=0,void Attendance.Entry.getList()):(Attendance.Entry.allowUIEntry=void 0!==rdata.allowUIEntry?rdata.allowUIEntry:Attendance.Entry.allowUIEntry,Attendance.isWebCoOrdMandatory=void 0!==rdata.isWebCoOrdMandatory&&rdata.isWebCoOrdMandatory,Attendance.isTrackLocationEnabled=void 0!==rdata.isTrackLocationEnabled&&rdata.isTrackLocationEnabled,Attendance.isAllowToCapturePhotoInWeb=void 0!==rdata.isAllowToCapturePhotoInWeb&&rdata.isAllowToCapturePhotoInWeb,Attendance.isAllowToVerifyUserInWeb=void 0!==rdata.isAllowToVerifyUserInWeb&&rdata.isAllowToVerifyUserInWeb,Attendance.Entry.allDataList.dayList[$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").index()]=rdata.dayList[0],Attendance.Entry.getCurrDayEntry($(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").index()),$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active")&&Attendance.Dashboard&&Attendance.Dashboard.WeeklyData.getCurWeekData(),void Attendance.Entry.setTime("first"));Attendance.Entry.allDataList=rdata,Attendance.Entry.allDataList.viewLoaded=Attendance.Entry.selectedView,Attendance.Entry.allowUIEntry=void 0!==rdata.allowUIEntry?rdata.allowUIEntry:Attendance.Entry.allowUIEntry,Attendance.isWebCoOrdMandatory=void 0!==rdata.isWebCoOrdMandatory&&rdata.isWebCoOrdMandatory,Attendance.isTrackLocationEnabled=void 0!==rdata.isTrackLocationEnabled&&rdata.isTrackLocationEnabled,Attendance.isAllowToCapturePhotoInWeb=void 0!==rdata.isAllowToCapturePhotoInWeb&&rdata.isAllowToCapturePhotoInWeb,Attendance.isAllowToVerifyUserInWeb=void 0!==rdata.isAllowToVerifyUserInWeb&&rdata.isAllowToVerifyUserInWeb,Attendance.Entry.setValueForUserReport(rdata);var shiftDetails=Shift.getShiftName(Attendance.Entry.allDataList.dayList[0].shift.shiftId,!1,!0);Attendance.Entry.fromShiftTime=shiftDetails.fTime,Attendance.Entry.toShiftTime=shiftDetails.tTime;var shiftId=Attendance.Entry.allDataList.dayList[0].shift.shiftId;for(var i in Attendance.Entry.allDataList.dayList)if(Attendance.Entry.allDataList.dayList[i].shift.shiftId!==shiftId){Attendance.Entry.fromShiftTime=0,Attendance.Entry.toShiftTime=0;break}0===Attendance.Entry.allDataList.showScaleView?($(Attendance.Entry.LayoutId+" #ZPAtt_timeAndScaleMeasure").show(),Attendance.Entry.scaleCons()):$(Attendance.Entry.LayoutId+" #ZPAtt_timeAndScaleMeasure").hide(),1===Attendance.Entry.allDataList.showAllEntries?Layout.Page.container.find("#ZPAtt_entry_AuditEntryPopup").hide():Layout.Page.container.find("#ZPAtt_entry_AuditEntryPopup").show(),Attendance.Entry.allDataList.erecno=Attendance.Entry.erecno,Attendance.Entry.lastRefTime=(new Date).getTime(),Attendance.Entry.setTime("first"),Attendance.Entry.showDayList(Attendance.Entry.allDataList.dayList,!1,!1,isLoadPrevWeekOrMonth);var todayId=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active");todayId.length&&todayId[0].scrollIntoView({behavior:"smooth",block:"center"}),Attendance.Entry.setFunctionInOrOut(),Attendance.Entry.loadTabulerView=!1,Attendance.Entry.setAbsentInSummary()}else"tabler"===Attendance.Entry.selectedPageView&&layout===Attendance.Entry.LayoutId?(Attendance.Entry.allDataList=rdata,Attendance.Entry.allDataList.viewLoaded=Attendance.Entry.selectedView,Attendance.Entry.allDataList.erecno=Attendance.Entry.erecno,Attendance.Entry.setValueForUserReport(rdata),$(Attendance.Entry.LayoutId+" #ZPAtt5_tabView thead").show(),Attendance.Entry.showDayListTabler(Attendance.Entry.allDataList.dayList),Attendance.Entry.setAbsentInSummary()):"calendar"===Attendance.Entry.selectedPageView&&layout===Attendance.Entry.LayoutId&&(Attendance.Entry.leaveTypes=rdata.leaveTypes,Attendance.Entry.calendarAllDataList=rdata,Attendance.Entry.calendarAllDataList.erecno=Attendance.Entry.erecno,Attendance.Entry.setValueForUserReport(rdata),Attendance.Entry.showDayListCalendar());(!param.loadToday||"tabler"===Attendance.Entry.selectedPageView&&layout===Attendance.Entry.LayoutId)&&Attendance.Entry.showUserDet(rdata),Attendance.Entry.addGroupbuttonsinHeader()})},navCalOnSel:function(dateVal,obj,data){var preMonth,from=data.fromDate,currWeekStart=new Date(Attendance.Entry.reportStartDate);if(currWeekStart.setHours(0),currWeekStart.setMinutes(0),"calendar"===Attendance.Entry.selectedPageView||"month"==Attendance.Entry.selectedView){var clickedMonth=data.clickedMonth,clickedYear=data.clickedYear,monthDiff=Math.floor(currWeekStart.getMonth()-clickedMonth);monthDiff+=12*Math.floor(currWeekStart.getFullYear()-clickedYear),preMonth=Attendance.Entry.calendarPreMonth+monthDiff}else{var days=Math.floor((from-currWeekStart)/864e5),weekDiff=Math.floor(days/7);preMonth=Attendance.Entry.preMonth+weekDiff,Layout.Page.container.find("#calEntryNavDatePicker").html("")}Layout.Page.container.find("#entryNavDatePicker").html(""),Attendance.Entry.getList(Attendance.Entry.selectedView,preMonth)},removeAddOptions:function(){var lay=Attendance.Entry.prePageId==Attendance.Entry.LayoutId?void 0:$(Attendance.Entry.prePageId),teamListview=$(Attendance.Entry.LayoutId),arrayofIds=[];for(var id in arrayofIds.push("#ZPAtt_Quick_AddOptionsBtn_list"),arrayofIds.push("#attEntryMoreOptionsBtn_list"),arrayofIds.push("#ZPAtt_Quick_AddOptionsBtn_tabler"),arrayofIds.push("#attEntryMoreOptionsBtn_tabler"),arrayofIds.push("#ZPAtt_Quick_AddOptionsBtn_calendar"),arrayofIds.push("#attEntryMoreOptionsBtn_calendar"),arrayofIds)lay&&(0!=lay.find(arrayofIds[id]).length&&ZPeopleComponents.menu(lay.find(arrayofIds[id]),{removeExistingDropdown:!0}).destroy(),lay.find(arrayofIds[id]).remove()),0!=teamListview.find(arrayofIds[id]).length&&ZPeopleComponents.menu(teamListview.find(arrayofIds[id]),{removeExistingDropdown:!0}).destroy(),teamListview.find(arrayofIds[id]).remove();Attendance.Entry.prePageId=Attendance.Entry.LayoutId},addGroupbuttonsinHeader:function(){if(!Attendance.Entry.skipPageView){var lay=$("#"+Layout.Page.pageId),addRegForSub=Attendance.Entry.allDataList.addRegForSub;Attendance.Entry.removeAddOptions();var quickAdd="",reqOptions=[];if((isRegConfigured||isOnDutyConfigured||isPermissionConfigured)&&(addRegForSub||isadmin||isManageAttendanceData||null===Attendance.Entry.erecno)&&(!Attendance.Entry.allDataList.hideDelete||null===Attendance.Entry.erecno||addRegForSub)){var buttext="",buttFunc="",isOneReqOnlyConfig=!0;isRegConfigured?(buttext=ZPI18N.getString("zp.regularization"),buttFunc="regularization_operation.constructRequestReg()",reqOptions.push({type:"regularize",name:buttext,callback:"regularization_operation.constructRequestReg"}),isPermissionConfigured&&(reqOptions.push({type:"permission",name:ZPI18N.getString("zp.perm"),callback:"permission.initPermReqFromEntry"}),isOneReqOnlyConfig=!1),isOnDutyConfigured&&(reqOptions.push({type:"ondDuty",name:ZPI18N.getString("zp.onduty"),callback:"onduty.constructRequestOnDuty"}),isOneReqOnlyConfig=!1)):isPermissionConfigured?(buttext=ZPI18N.getString("zp.perm"),buttFunc="permission.initPermReqFromEntry()",reqOptions.push({type:"permission",name:buttext,callback:"permission.initPermReqFromEntry"}),isOnDutyConfigured&&(reqOptions.push({type:"ondDuty",name:ZPI18N.getString("zp.onduty"),callback:"onduty.constructRequestOnDuty"}),isOneReqOnlyConfig=!1)):isOnDutyConfigured&&(buttext=ZPI18N.getString("zp.onduty"),buttFunc="onduty.constructRequestOnDuty()",reqOptions.push({type:"ondDuty",name:buttext,callback:"onduty.constructRequestOnDuty"})),isOneReqOnlyConfig?quickAdd+="<button type='button' id='ZPAtt_Quick_AddOptionsBtn_"+Attendance.Entry.selectedPageView+"'class='zbutton zbutton--medium zbutton--primary zbutton--action' data-toggle='modal' onclick='"+buttFunc+"'><span class='zbutton__text'>"+buttext+"</span></button>":(quickAdd='<div role="splitbutton" aria-label="Request" id="ZPAtt_Quick_AddOptionsBtn_'+Attendance.Entry.selectedPageView+'">',reqOptions.length>1&&(quickAdd+='<button aria-expanded="false" data-toggle="dropdown" class="drpmenu-js zbutton zbutton--medium zbutton--primary undefined zbutton--menu" type="button" onclick="Attendance.Entry.showMoreReqOptions()">',quickAdd+='<span class="zbutton__text">'+ZPI18N.getString("zp.request")+"</span>",quickAdd+='<i class="zbutton__icon zh-floatright"><svg class="zbutton__svg zbutton__menuarrow" focusable="false"> <use xlink:href="#zc__svg--downarrow"></use></svg> </i>',quickAdd+="</button>"),quickAdd+="</div>")}var moreOpt=[];reqOptions.length>0&&lay.find(".grpbtn").after(quickAdd),quickAdd="","calendar"!=Attendance.Entry.selectedPageView&&(-1===Attendance.Entry.LayoutId.indexOf("attendance-entry-balanceotview")&&(isManageAttendanceData||Attendance.Entry.isViewAllowedForSub&&Attendance.Entry.isEditAllowedForSub)&&moreOpt.push({type:"import",name:ZPI18N.getString("zp.import"),callback:"punchImpExp.Import.construct"}),moreOpt.push({type:"export",name:ZPI18N.getString("zp.export"),callback:"Att_Common_Operations.Export.construct"}),-1===Attendance.Entry.LayoutId.indexOf("attendance-entry-balanceotview")&&0==Attendance.Entry.allDataList.showAllEntries&&moreOpt.push({type:"audit",name:ZPI18N.getString("zp.audithistory"),callback:"Attendance.Entry.showAuditPage"}),quickAdd+='<i class="zpl_ibg PI_more" tabindex="0" aria-label="'+ZPI18N.getString("zp.more")+'" title="'+ZPI18N.getString("zp.more")+'" id="attEntryMoreOptionsBtn_'+Attendance.Entry.selectedPageView+'" onclick="Attendance.Entry.showMoreOptions()"></i>'),moreOpt.length>0&&lay.find("#attSummaryFilter").after(quickAdd),reqOptions.length>1&&!isOneReqOnlyConfig&&Attendance.Entry.moreOptionMenu(reqOptions,"ZPAtt_Quick_AddOptions"),moreOpt.length>0&&Attendance.Entry.moreOptionMenu(moreOpt,"attEntryMoreOptions")}},setValueForUserReport:function(rdata){Attendance.Entry.loadReport=!0,Attendance.Entry.erecforReport=null!=Attendance.Entry.erecno?Attendance.Entry.erecno:ZPeople.CURR_USER.usererec,Attendance.Entry.sdate=rdata.dayList[0].ldate;var len=Object.keys(rdata.dayList).length;Attendance.Entry.edate=rdata.dayList[len-1].ldate,Attendance.Entry.showShiftcoreHours=rdata.dayList[len-1].showShiftcoreHours},showUserDet:function(rdata){if("calendar"!==Attendance.Entry.selectedPageView){if("month"===Attendance.Entry.selectedView){var date=rdata.dayList[0].attDate.split("-");$(Attendance.Entry.LayoutId+" #ZPAtt_entryNavigation").html("<b>"+months[parseInt(date[1])-1]+" "+date[0]+"</b>")}else $(Attendance.Entry.LayoutId+" #ZPAtt_entryNavigation").html("<b>"+rdata.dayList[0].ldate+" &nbsp;-&nbsp; "+rdata.dayList[6].ldate+"</b>");Attendance.Entry.getMonthReportForUser()}else if("calendar"==Attendance.Entry.selectedPageView){date=rdata.dayList[0].attDate.split("-");$(Attendance.Entry.LayoutId+" #ZPAtt_entryNavigation").html("<b>"+months[parseInt(date[1])-1]+" "+date[0]+"</b>")}date=$(Attendance.Entry.LayoutId+" #ZPAtt_entryNavigation").text();$(Attendance.Entry.LayoutId+" #ZPAtt_entryNavigation").attr({"aria-label":ZPI18N.getString("zp.common.period")+date,tabindex:"0"})},showShiftDet:function(rdata,shiftId){var shiftName=rdata.shiftName;$(Attendance.Entry.LayoutId+" #ZPAtt_userShiftName").text(decodeHTML(shiftName)+" [ "+Shift.getShiftTimeForDisplay(shiftId)+" ] "),$(Attendance.Entry.LayoutId+" #ZPAtt_userShiftName").attr({"aria-label":decodeHTML(shiftName)+" [ "+Shift.getShiftTimeForDisplay(shiftId)+" ] ",tabindex:"0"})},scaleCons:function(){var scaleBody=$(Attendance.Entry.LayoutId+" #ZPAtt_timeAndScaleMeasure tbody").find("td")[3];$(scaleBody).children().empty();var shiftDiffTime,fromShiftTime=Attendance.Entry.fromShiftTime,toShiftTime=Attendance.Entry.toShiftTime;shiftDiffTime=toShiftTime>fromShiftTime?(toShiftTime-fromShiftTime)/60:24-(fromShiftTime-toShiftTime)/60,shiftDiffTime=Math.round(shiftDiffTime);for(var indPixel=100/parseInt(shiftDiffTime),i=0;i<shiftDiffTime;i++){var mins=fromShiftTime+60*i;mins>=1440&&(mins-=1440);var time=Attendance.disTime(mins,!0);shiftDiffTime>12&&(shiftDiffTime%2==0&&(shiftDiffTime/2>i&&i%2==1||shiftDiffTime/2<=i&&i%2==0)||shiftDiffTime%2==1&&i%2==1)&&(time="");var scale='<div class="scale-col" style="width:'+indPixel+'%;"><div class="bottom-lines"><span class="vr-line"></span><span class="vr-line mid-line"></span> <span class="vr-line"> </span></div><div class="top-text">';scale+=time+"</div>",i===shiftDiffTime-1&&((mins=fromShiftTime+60*(i+1))>=1440&&(mins-=1440),time=Attendance.disTime(mins,!0),shiftDiffTime>12&&(shiftDiffTime%2==0&&(shiftDiffTime/2>i+1&&(i+1)%2==1||shiftDiffTime/2<=i+1&&(i+1)%2==0)||shiftDiffTime%2==1&&(i+1)%2==1)&&(time=""),scale+="<div class='last-text'>"+time+"</div>"),scale+="</div>",$(scaleBody).children().append(scale)}Attendance.Entry.shiftDiffTime=shiftDiffTime},toLeave:function(date,month,year){var d=new Date;d.setFullYear(year,month,date);var selectedDate=Calendar.formatDate(d);Attendance.Entry.applyLvDate=selectedDate,new LeaveForm({initEmployee:Attendance.Entry.erecno?Attendance.Entry.erecno:ZPeople.CURR_USER.usererec,initApplyLvDate:Attendance.Entry.applyLvDate}).add({callback:function(){window.location.href=Layout.Page.hash,Attendance.Entry.getList(Attendance.Entry.selectedView,Attendance.Entry.preMonth,!0)}})},hideBreakDiv:function(){Layout.Page.parentContainer.find("[id='breakBorder']").hide(),Layout.Page.parentContainer.find("[id='breakSelDiv']").hide(),Layout.Page.parentContainer.find("[id='breakRunningDiv']").hide(),Layout.Page.parentContainer.find("[id='showBreakPopup']").is(":visible")&&ZPeopleComponents.popover($("#showBreakPopup")).close()},getSecsInHHMMSSFormat:function(timeInSecs){var sec=parseInt(timeInSecs%60),min=parseInt((timeInSecs-sec)/60%60),hrs=parseInt((timeInSecs-min)/3600);return Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+":"+Attendance.disTwoDigit(sec)},startBreak:function(breakId){if(Attendance.Entry.breakId=breakId,Attendance.Entry.toggleBreakPopup(),Attendance.Entry.isMyspace()){var punchbtn=Layout.Page.parentContainer.find("#ZPAtt_check_in_out");punchbtn.attr("disabled",!0),punchbtn.find("#zpl_loading_icon").show()}Attendance.Entry.punchOut()},toggleBreakPopup:function(){Layout.Page.parentContainer.find("[id='showBreakPopup']").is(":visible")?ZPeopleComponents.popover($("#showBreakPopup")).close():ZPeopleComponents.popover($("#showBreakPopup")).open()},consBreakPopup:function(breakDetailsObj){ZPeopleComponents.isComponent($("#showBreakPopup"))&&(ZPeopleComponents.popover($("#showBreakPopup")).destroy(),$("#showBreakPopup").remove());var showbreakListPopup='<div id="showBreakPopup" data-type="popover" style="display: none;">';showbreakListPopup+="</div>";var breakOrderArr=Attendance.Entry.allDataList.breakList.breakOrderedArr;Layout.Page.parentContainer.find("#breakSelDiv").parent().append(showbreakListPopup);Layout.Page.parentContainer.find("#showBreakPopup").append('<div id="breakListPopUp" class="zpl_breakpop"></div>');var breakheading="<h5>"+ZPI18N.getString("zp.break")+"</h5>";for(var index in Layout.Page.parentContainer.find("#breakListPopUp").append(breakheading),breakOrderArr){var breakId=breakOrderArr[index];if(void 0!==breakDetailsObj&&breakDetailsObj[breakId]){let breakObj=breakDetailsObj[breakId],initialBreakObj=Attendance.Entry.allDataList.breakList.breakObj[breakId],breakDiv=Attendance.Entry.constructBreakHTML(breakObj,initialBreakObj,breakId);""!==breakDiv.trim()&&Layout.Page.parentContainer.find("#breakListPopUp").append(breakDiv)}}if(Layout.Page.parentContainer.find("#breakListPopUp").children().length>0){Layout.Page.parentContainer.find("#breakListPopUp").children().find(".pie-circle").each(function(){let breakId=$(this).attr("breakId");if(1!=$(this).attr(accrualbreak)&&breakDetailsObj[breakId]){let initialBreakObj=Attendance.Entry.allDataList.breakList.breakObj[breakId],breakObj=breakDetailsObj[breakId],breakSecsTaken=60*initialBreakObj.breakTimeInMins-breakObj.breakTimeInSecs;Attendance.Entry.consBreakChart($(this).attr("id"),breakSecsTaken,breakObj.breakTimeInSecs,initialBreakObj.breakColor)}}),Layout.Page.parentContainer.find("[id='breakSelDiv']").show(),Layout.Page.parentContainer.find("[id='breakRunningDiv']").hide();let position=Attendance.Entry.isMyspace()?"right":"bottom-left";ZPeopleComponents.popover(Layout.Page.parentContainer.find("#showBreakPopup"),{displayType:"box",closeOnBodyClick:!0,position:position,forElement:Layout.Page.parentContainer.find("#breakSelDiv"),className:"zpl_popovr"})}else Attendance.Entry.hideBreakDiv()},constructBreakHTML:function(breakObj,initialBreakObj,breakId){let breakDiv="",isAccrualBreak=!1,breakDetailObj=Attendance.Entry.isMyspace()?Attendance.Entry.curDayBreakDetails:Attendance.Entry.allDataList.curDayBreakDetails;void 0!==breakDetailObj&&void 0!==breakDetailObj.isAccrualBreak&&(isAccrualBreak=breakId==breakDetailObj.isAccrualBreak);let breakMinsAlloted=isAccrualBreak?0:initialBreakObj.breakTimeInMins,breakSecsRem=isAccrualBreak?0:breakObj.breakTimeInSecs,breakFromTimeArray=breakObj.breakFromTimeArray,breakImageClass=initialBreakObj.breakImage,breakSecsTaken=60*breakMinsAlloted-breakSecsRem,breakAllotedText=breakMinsAlloted+" "+ZPI18N.getString("zp.minutes"),breakRemText=breakSecsRem<60?breakSecsRem+" "+ZPI18N.getString("zp.secs"):parseInt(breakSecsRem/60)+" "+ZPI18N.getString("zp.minutes"),breakPayType=1==initialBreakObj.breakPayType?ZPI18N.getString("zp.leavetype.paid"):ZPI18N.getString("zp.leavetype.unpaid"),breakPayColor=1==initialBreakObj.breakPayType?"org":"red";if(0!==breakSecsRem||isAccrualBreak){if(breakDiv='<div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_breakrow d-flexC"><div class="d-flexC flexclmcap"><span class="'+breakImageClass+' icn lv_bgclr2"></span><b>'+initialBreakObj.breakName+' </b></div><div class="MLauto"><span class="'+breakPayColor+'">'+breakPayType+"</span></div></div>",breakDiv+='<div class="zpl_breakrow d-flexC" '+(isAccrualBreak?'"accrualbreak=true"':"")+' id="'+breakId+'_chart" breakId="'+breakId+'" ><div class="flexclmcap d-flexC" id="breakStart""><i class="PI_fil_play grn" onClick=\'Attendance.Entry.startBreak("'+breakId+"\")'></i><b>"+Attendance.Entry.getSecsInHHMMSSFormat(breakSecsTaken)+"</b></div></div>",breakDiv+='<div class="zpl_breakrow d-flexC grybg"><div class="d-flexclmcap10" id="breakAllowed"><em>'+ZPI18N.getString("zp.allow")+"</em><b>"+breakAllotedText+'</b></div><div class="MLauto d-flexclmcap10" id="breakRem"><em>'+ZPI18N.getString("zp.remaining")+"</em><b>"+breakRemText+"</b></div></div>",void 0!=breakFromTimeArray&&0!=breakFromTimeArray.length){let len=breakFromTimeArray.length;breakDiv+='<div class="zpl_breakrow zpl_info"><b>'+ZPI18N.getString("zp.allowedtiming")+"</b>";for(var it=0;it<len;it++){if(it%2==0){breakDiv+='<div class="'+(it>=2?"d-flexclmcap10 M0I":"d-flexclmcap10")+'">'}it%2==1?(breakDiv+="<em>|</em>",breakDiv+="<em>"+Attendance.disTime(breakFromTimeArray[it].fromTime)+" - "+Attendance.disTime(breakFromTimeArray[it].toTime)+"</em></div>"):(breakDiv+="<em>"+Attendance.disTime(breakFromTimeArray[it].fromTime)+" - "+Attendance.disTime(breakFromTimeArray[it].toTime)+"</em>",len-it==1&&(breakDiv+="</div>"))}breakDiv+="</div>"}if(isAccrualBreak){let brksOnWorkHrs=initialBreakObj.brksOnWorkHrs;breakDiv+='<div class="zpl_info zpl_DNI" id="accrualBreakInfo"><div class="zpl_breakrow"><b>'+ZPI18N.getString("zp.breaktimings")+'</b><div class="zpl_flexcolumn">',brksOnWorkHrs.forEach(val=>{breakDiv+="<em id="+val.breakTime+">"+ZPI18N.getString("zp.actualworked",new Array("<b>"+Attendance.disHours(val.workingHrs)+"</b>","<b>"+Attendance.disHours(val.breakTime)+"</b>"))+"</em>"}),breakDiv+="</div></div></div>"}}return breakDiv},isMyspace:function(){return window.location.hash.indexOf("home/myspace/overview")>=0},consBreakChart:function(chartId,breakSecsTaken,breakSecsRem,breakColor){var chart_data=[];chart_data.push({y:breakSecsRem,name:"Point1",color:breakColor}),breakSecsTaken>0&&chart_data.push({y:breakSecsTaken,name:"Point2",color:"#FFF"}),$("#"+chartId).highcharts({chart:{type:"pie",width:"80",height:"80",margin:[0,0,0,0]},plotOptions:{pie:{allowPointSelect:!1,size:"100%",dataLabels:{enabled:!1}},column:{pointPadding:0,borderWidth:0}},title:{enabled:!1,text:""},credits:{enabled:!1},tooltip:{enabled:!1},exporting:{enabled:!1},yAxis:{title:{text:"Total percent market share"}},series:[{data:chart_data,size:"60px",innerSize:"85%",dataLabels:{enabled:!1},states:{hover:{enabled:!1}}}]})},breakTimer:function(breakRemTimeInSecs){breakRemTimeInSecs>=0?(Attendance.Entry.breakTimerInterval=setInterval(Attendance.Entry.breakTimer,1e3),Attendance.Entry.breakMaxTimeAllowed=moment(),Attendance.Entry.breakMaxTimeAllowed.add(breakRemTimeInSecs,"seconds")):breakRemTimeInSecs<0&&(Attendance.Entry.breakMaxTimeAllowed=moment());var breakRemTime=Attendance.Entry.breakMaxTimeAllowed.diff(moment(),"seconds");Layout.Page.parentContainer.find("#breakRunningDiv #breakRemTime").text(""),breakRemTime>0?Layout.Page.parentContainer.find("#breakRunningDiv #breakRemTime").text(Attendance.Entry.getSecsInHHMMSSFormat(breakRemTime)+" Hrs"):clearInterval(Attendance.Entry.breakTimerInterval)},showBreakRunner:function(breakObj){clearInterval(Attendance.Entry.breakTimerInterval);var breakDetails=Attendance.Entry.allDataList.breakList.breakObj[breakObj.runningBreakId];if(Attendance.Entry.isMyspace()?(Layout.Page.parentContainer.find("[id='myspaceBrkIcon']").hide(),Layout.Page.parentContainer.find("[id='breakSelDiv']").show()):Layout.Page.parentContainer.find("[id='breakSelDiv']").hide(),Layout.Page.parentContainer.find("[id='breakBorder']").show(),Layout.Page.parentContainer.find("[id='breakRunningDiv']").show(),Layout.Page.parentContainer.find("[id='runnerBreakImg']").show(),Layout.Page.parentContainer.find("[id='runnerBreakImg']").attr("class",breakDetails.breakImage),breakObj.breakTimerAddSecs||0==breakObj.breakTimerAddSecs)if(Attendance.Entry.curDayBreakDetails.shiftBreakDets&&Attendance.Entry.curDayBreakDetails.shiftBreakDets[breakObj.runningBreakId]){var breakRemTimeInSecs=Attendance.Entry.curDayBreakDetails.isAccrualBreak==breakObj.runningBreakId?breakObj.accrualBreakTimeInSecs:Attendance.Entry.curDayBreakDetails.shiftBreakDets[breakObj.runningBreakId].breakTimeInSecs;breakRemTimeInSecs-=breakObj.breakTimerAddSecs,Attendance.Entry.breakTimer(breakRemTimeInSecs)}else Attendance.Entry.breakTimer(-1);else Attendance.Entry.breakTimer(-1)},showOrHideBreakSelect:function(isShow,breakDetailsObj){clearInterval(Attendance.Entry.breakTimerInterval),isShow&&breakDetailsObj?(Layout.Page.container.find("[id='brkView']").on("shown.bs.modal",function(){-1!==Attendance.Entry.LayoutId.indexOf("selfservice")&&$("#selfservice .Scrcont").addClass("OHI"),$(".modal-backdrop.in").hide(),$(".modal-backdrop.in").css("opacity",0),$("body").off("click").on("click",function(event){$(event.target).parents("div#brkView").length||$(event.target).parents("#breakSelDiv").length||"breakSelDiv"==event.target.id||ZPeople.BSModal.hide("brkView")})}),Layout.Page.container.find("[id='brkView']").on("hidden.bs.modal",function(){-1!==Attendance.Entry.LayoutId.indexOf("selfservice")&&$("#selfservice .Scrcont").removeClass("OHI"),$("body").off("click")}),Attendance.Entry.consBreakPopup(breakDetailsObj)):Attendance.Entry.hideBreakDiv()},consRegPopup:function(){var tempVal,attDate=Attendance.Entry.getDayRecordJson.regDetails.dayList[0],attenddata=Attendance.Entry.getDayRecordJson.regDetails[attDate];if(ZPeople.Module.MODULE_DATA.attendance.isRegReasonsEnabled){var regReasons=ZPeople.Module.MODULE_DATA.attendance.regReasons,txt='<label class="zp_mdt control-label col-sm-3"><font>'+ZPI18N.getString("zp.reason")+'</font></label><div class="col-sm-4"><select class="select2-container W300A" id="reg_req_reason">';txt+='<option value="-1">'+$("<div/>").text(ZPI18N.getString("zp.select")).html()+"</option>",$.each(regReasons,function(index,data){txt+='<option value="'+index+'">'+$("<div/>").text(data).html()+"</option>"}),txt+="</select></div>",Layout.Page.container.find("#ZPAtt_Reg_addReq_reasonDesc").html(txt),Layout.Page.container.find("#ZPAtt_Reg_addReq_Desc").html('<label class="control-label col-sm-3">'+ZPI18N.getString("zp.description")+'</label><div class="col-sm-6"><textarea rows="4" class="form-control" id="reg_req_desc" placeholder='+ZPI18N.getString("zp.description")+"></textarea></div>"),Layout.Page.container.find("#ZPAtt_Reg_addReq_reasonDesc").find("select").select2({minimumResultsForSearch:5})}else Layout.Page.container.find("#ZPAtt_Reg_addReq_Desc").html(""),Layout.Page.container.find("#ZPAtt_Reg_addReq_reasonDesc").html('<label class="control-label col-sm-3">'+ZPI18N.getString("zp.description")+'</label><div class="col-sm-6"><textarea rows="4" class="form-control" id="reg_req_desc" placeholder='+ZPI18N.getString("zp.description")+"></textarea></div>"),$("#"+Layout.Page.pageId+" #ZPAtt_Reg_addReq_Desc textarea").val("");$("#"+Layout.Page.pageId+" #ZPAtt_reg_fromTime").off("change").on("change",function(){Attendance.Entry.regFILOChanged(null,this)}),$("#"+Layout.Page.pageId+" #ZPAtt_reg_toTime").off("change").on("change",function(){Attendance.Entry.regFILOChanged(null,this)});var timeObj=Calendar.getTime();attenddata.fromdate?(tempVal=attDate+" "+attenddata.fromdate,tempVal+=Attendance.timeFormatIs12hr?"":":00"):tempVal="hh:mm a"===timeFormat?attDate+" "+timeObj.hours+":"+timeObj.minutes+" "+timeObj.isampm.toUpperCase():attDate+" "+timeObj.hours+":"+timeObj.minutes+":"+timeObj.seconds,$("#"+Layout.Page.pageId+" #ZPAtt_reg_fromTime").val(tempVal);var minDt=Calendar.parseDate(attDate,uidateFormat),maxDt=Calendar.parseDate(attDate,uidateFormat);if(maxDt.setDate(maxDt.getDate()+1),attenddata.todate)if(attenddata.fromdate){var regFromTime=Attendance.Common.convertTimerInputToMinsOrSecs(tempVal.split(" ")[1]+" "+tempVal.split(" ")[2]);tempVal=attDate+" "+attenddata.todate,tempVal+=Attendance.timeFormatIs12hr?"":":00",Attendance.Common.convertTimerInputToMinsOrSecs(tempVal.split(" ")[1]+" "+tempVal.split(" ")[2])<regFromTime&&(tempVal=Calendar.formatDate(maxDt)+" "+attenddata.todate,tempVal+=Attendance.timeFormatIs12hr?"":":00")}else tempVal=attDate+" "+attenddata.todate,tempVal+=Attendance.timeFormatIs12hr?"":":00";else tempVal="hh:mm a"===timeFormat?attDate+" "+timeObj.hours+":"+timeObj.minutes+" "+timeObj.isampm.toUpperCase():attDate+" "+timeObj.hours+":"+timeObj.minutes+":"+timeObj.seconds;$("#"+Layout.Page.pageId+" #ZPAtt_reg_toTime").val(tempVal);var settingsObjStr='{mindate:"'+minDt+'",maxdate:"'+maxDt+'"}';if($("#"+Layout.Page.pageId+" #ZPAtt_reg_fromTime").attr("onclick","Calendar.setUpCalendar(event, this,1,undefined,Attendance.Entry.regFILOChanged,undefined,"+settingsObjStr+");"),$("#"+Layout.Page.pageId+" #ZPAtt_reg_toTime").attr("onclick","Calendar.setUpCalendar(event, this,1,undefined,Attendance.Entry.regFILOChanged,undefined,"+settingsObjStr+");"),$("#"+Layout.Page.pageId+" #ZPAtt_reg_totalHours").html(""),$("#"+Layout.Page.pageId+" #ZPAtt_reg_Explain").hide(),attenddata.totalhrs>=0){$("#"+Layout.Page.pageId+" #ZPAtt_reg_totalHours").html(Attendance.disHours(parseInt(attenddata.totalhrs/60),!0));var errObj=$("#"+Layout.Page.pageId+" #ZPAtt_reg_fromTime").closest("form");errObj.find("#reg_errorMsg").remove(),errObj.find("#reg_errorMsg_to").remove(),errObj.css("height","44px")}else Attendance.Entry.regFILOChanged(null,"#"+Layout.Page.pageId+" #ZPAtt_reg_fromTime");$("#"+Layout.Page.pageId+" #ZPAtt_Reg_addReq_FDate").show(),$("#"+Layout.Page.pageId+" #ZPAtt_Reg_addReq_TDate").show(),$("#"+Layout.Page.pageId+" #ZPAtt_Reg_addReq_THours").show()},regFILOChanged:function(tmpDateObj,obj){var formObj=$(obj).closest("form"),regFromTime=formObj.find("#ZPAtt_reg_fromTime").val().trim(),regToTime=formObj.find("#ZPAtt_reg_toTime").val().trim(),attDate=$("#"+Layout.Page.pageId+" #ZPAtt_reg_regDate").val(),maxDt=Calendar.parseDate(attDate,uidateFormat);maxDt.setDate(maxDt.getDate()+1);var nextDate=Calendar.formatDate(maxDt);if(formObj.find("#reg_errorMsg").remove(),formObj.find("#reg_errorMsg_to").remove(),formObj.css("height","44px"),formObj.find("#ZPAtt_reg_Explain").hide(),formObj.find("#ZPAtt_reg_totalHours").html(""),""!==regFromTime){var regFormatTime=regFromTime.split(" ")[1]+" "+regFromTime.split(" ")[2],regFromHours=parseInt(regFormatTime.split(":")[0],10),regFromMin=parseInt(regFormatTime.split(":")[1],10),invalidFromTime=!1;if(invalidFromTime=Attendance.timeFormatIs12hr?regFromHours>12||invalidFromTime:regFromHours>23||invalidFromTime,invalidFromTime=regFromMin>60||invalidFromTime)return formObj.attr("errorDispRow",!0),formObj.css("height","70px"),void formObj.find(" #filoDiv").eq(0).find("div").append('<span id="reg_errorMsg" class="ERR MT5">'+ZPI18N.getString("zp.attendance.regInvalidFromEntry")+"</span>")}if(""!==regToTime){regFormatTime=regToTime.split(" ")[1]+" "+regToTime.split(" ")[2];var regToHours=parseInt(regFormatTime.split(":")[0],10),regToMin=parseInt(regFormatTime.split(":")[1],10),invalidToTime=!1;if(invalidToTime=Attendance.timeFormatIs12hr?regToHours>12||invalidToTime:regToHours>23||invalidToTime,invalidToTime=regToMin>60||invalidToTime)return formObj.attr("errorDispRow",!0),formObj.css("height","70px"),void formObj.find(" #filoDiv").eq(1).find("div").append('<span id="reg_errorMsg_to" class="ERR MT5">'+ZPI18N.getString("zp.attendance.regInvalidToEntry")+"</span>")}if(""!==regFromTime&&""!==regToTime){var regFromDate=new Date(regFromTime.split(" ")[0]),regToDate=new Date(regToTime.split(" ")[0]);if(regFromDate<new Date(attDate)||regFromDate>new Date(nextDate))return formObj.attr("errorDispRow",!0),formObj.css("height","70px"),void formObj.find(" #filoDiv").eq(0).find("div").append('<span class="ERR MT5" id="reg_errorMsg">'+ZPI18N.getString("zp.attendance.regInvalidDate")+"</span>");if(regToDate<new Date(attDate)||regToDate>new Date(nextDate))return formObj.attr("errorDispRow",!0),formObj.css("height","70px"),void formObj.find(" #filoDiv").eq(1).find("div").append('<span class="ERR MT5" id="reg_errorMsg_to">'+ZPI18N.getString("zp.attendance.regInvalidDate")+"</span>");if(regFromTime=regFromTime.split(" ")[1]+" "+regFromTime.split(" ")[2],regToTime=regToTime.split(" ")[1]+" "+regToTime.split(" ")[2],regFromTime=Attendance.Common.convertTimerInputToMinsOrSecs(regFromTime),regToTime=Attendance.Common.convertTimerInputToMinsOrSecs(regToTime),regToDate>regFromDate&&regToTime>regFromTime)return formObj.attr("errorDispRow",!0),formObj.css("height","70px"),void formObj.find(" #filoDiv").eq(0).find("div").append('<span id="reg_errorMsg" class="ERR MT5">'+ZPI18N.getString("zp.timeexceeded24")+"</span>");if(regFromDate==regToDate&&regToTime<regFromTime||regFromDate>regToDate)return formObj.attr("errorDispRow",!0),formObj.css("height","70px"),void formObj.find(" #filoDiv").eq(0).find("div").append('<span id="reg_errorMsg" class="ERR MT5">'+ZPI18N.getString("zp.inshouldbebeforeout")+"</span>");regFromDate<regToDate&&(regToTime+=1440);var regDets=Attendance.Entry.getDayRecordJson.regDetails[attDate];if(regDets.isAutoBreakConf)Attendance.Reg.getTotHrsExcludingAutoBreaks(regFromTime,regToTime,attDate,formObj);else{var shiftAllowedTimings=regDets.shiftAllowedTimings,totalHours=Attendance.Reg.getTotalHoursBasedOnShift(shiftAllowedTimings,regFromTime,regToTime);formObj.find("#ZPAtt_reg_totalHours").html(Attendance.disHours(parseInt(totalHours),!0))}}},before_afterShiftEntry:{},latestCheckinLeftPos:null,before_afterShiftEntries:{},todayDate:"",todayShiftId:"",showDayList:function(data,updateTR,fromEntryEdit,isLoadPrevWeekOrMonth){if(data){var tbody=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries");Attendance.Entry.consIpList(fromEntryEdit),updateTR||tbody.empty(),Attendance.Entry.currentDayinView=!1,Attendance.Entry.hasOpenCheckin=!1,$(Attendance.Entry.LayoutId+" #ZPAtt_draggableLine").hide();for(var showOfficeInRemoteIn=Attendance.Entry.showOfficeINRemoteIN(),officeInDname=Att_Common_Operations.isModuleDataLoaded&&ZPeople.Module.MODULE_DATA.attendance.officeINdNameEncoded?ZPeople.Module.MODULE_DATA.attendance.officeINdNameEncoded:ZPI18N.getString("zp.officein"),remoteInDname=Att_Common_Operations.isModuleDataLoaded&&ZPeople.Module.MODULE_DATA.attendance.remoteINdNameEncoded?ZPeople.Module.MODULE_DATA.attendance.remoteINdNameEncoded:ZPI18N.getString("zp.remotein"),i=0;data[i];i++){var status=data[i].status,transStat=Attendance.consLeaveStat(status,!0,!1),approvalInfo=data[i].approvalInfo;approvalInfo&&approvalInfo.isRegularized&&(transStat=""===transStat?ZPI18N.getString("zp.regularized"):transStat+" / "+ZPI18N.getString("zp.regularized"));var entries=Attendance.Entry.allDataList.entries[data[i].attDate],lastEntryObj={};if(entries.length>0){var displayLastRow=entries[entries.length-1];lastEntryObj=1==entries.length?displayLastRow:entries[displayLastRow.lastRowIndex]}var before_afterShiftEntryObj={},before_afterShiftEntriesObj={},iscurrentDay=!(Calendar.parseDate(Attendance.Entry.allDataList.currDate.todayDate,uidateFormat)>Calendar.parseDate(data[i].ldate,uidateFormat)||Calendar.parseDate(Attendance.Entry.allDataList.currDate.todayDate,uidateFormat)<Calendar.parseDate(data[i].ldate,uidateFormat)),day=iscurrentDay?ZPI18N.getString("zp.today"):days[data[i].day-1],currClass=iscurrentDay?"zpl_crntday":"",trow="<tr onclick=Attendance.Entry.consEntriesPopup(this)>";if(data[i].isToday){if(Attendance.Entry.display_sec=data[i].tsecs,Attendance.Entry.todayDate=data[i].attDate.split("-")[2],Attendance.Entry.todayShiftId=data[i].shift.shiftId,entries.length>0&&lastEntryObj.allowPunchOut)"-"===(checkInFdate=lastEntryObj.fdate.slice(0,11))[checkInFdate.length-1]&&(checkInFdate=checkInFdate.slice(0,10)),Attendance.Entry.latestCheckinLeftPos=Attendance.Entry.leftPositionCalc(Attendance.disTimeOnly(lastEntryObj.fdate),checkInFdate,data[i].ldate),Attendance.Entry.latestCheckinDate=checkInFdate,Attendance.Entry.checkInOut="out";else Attendance.Entry.checkInOut="in";if(Attendance.Entry.curDayBreakDetails.shiftBreakDets&&"out"==Attendance.Entry.checkInOut)Attendance.Entry.showOrHideBreakSelect(Att_Common_Operations.isAttListViewSelfUserPage(),Attendance.Entry.curDayBreakDetails.shiftBreakDets);else if("in"==Attendance.Entry.checkInOut&&entries.length>0&&lastEntryObj.runningBreakId){var checkinDate=lastEntryObj.breakFromTime?lastEntryObj.breakFromTime:lastEntryObj.fdate;"-"===(checkInFdate=checkinDate.slice(0,11))[checkInFdate.length-1]&&(checkInFdate=checkInFdate.slice(0,10)),Attendance.Entry.latestCheckinLeftPos=Attendance.Entry.leftPositionCalc(Attendance.disTimeOnly(checkinDate),checkInFdate,data[i].ldate),Attendance.Entry.latestCheckinDate=checkInFdate,Attendance.Entry.showBreakRunner(lastEntryObj)}else Attendance.Entry.showOrHideBreakSelect(!1);Attendance.Entry.setFunctionInOrOut(),trow="<tr class='today-active "+currClass+"' onclick=Attendance.Entry.consEntriesPopup(this)>",Attendance.Entry.currentDayinView=!0}if(Attendance.Entry.showShiftDet(Shift.getShiftName(Attendance.Entry.todayShiftId,!0),Attendance.Entry.todayShiftId),trow+="<td width='60' aria-label='"+day+" "+data[i].attDate.split("-")[2]+"' tabindex='0'> <div><b>"+day+"</b> <em>"+data[i].attDate.split("-")[2]+"</em></div></td>",data[i].filo.ftime)trow+="<td width='180'><div class='zpl_attentrydtls' tabindex='0' aria-label='"+(showOfficeInRemoteIn&&data[i].officein?officeInDname:remoteInDname)+" "+ZPI18N.getString("zp.checkintime")+": "+data[i].filo.ftime+"'>",showOfficeInRemoteIn&&(trow+="<span class='grn'>",data[i].officein?trow+=officeInDname:data[i].remotein&&(trow+=remoteInDname),trow+="</span>"),trow+="<b>"+data[i].filo.ftime+"</b>",data[i].lateby&&data[i].showEalryLateEntries&&(trow+="<em>"+ZPI18N.getString("zp.lateby",[""])+"<span class='org'>"+data[i].lateby+"</span></em>"),trow+="</div></td>";else trow+="<td width='180'></td>";if(1===Attendance.Entry.allDataList.showScaleView){if($(Attendance.Entry.LayoutId+" #ZPAtt5_listView").is(":visible")&&-1===Attendance.Entry.LayoutId.indexOf("selfservice")&&(null!==Attendance.Entry.erecno?Layout.Page.container.find("#ZP-atdancehead").addClass("DNI"):(Layout.Page.container.find("#ZP-atdancehead").addClass("DNI"),Attendance.Entry.allowUIEntry||Layout.Page.container.find("#ZP-atdancehead").removeClass("DNI"))),-1!==Attendance.Entry.LayoutId.indexOf("selfservice")){var headerCont=Layout.Page.container.find(".ZP-atdancehead");null===Attendance.Entry.erecno&&Attendance.Entry.allowUIEntry&&headerCont.hide().next().css("margin-top","20px")}trow+="<td>",trow+="<div class ='zpl_attprgrswrpr' title='"+transStat+"'>";var colorClass="zpl_prsntBg",per=data[i].tsecs/60/60/10*100,leftPer=0;if(per>100?per=100:per<0&&(per=0),("Absent"===status||"0.5 day Present, 0.5 day Absent"===status||"0.25 day Present, 0.75 day Absent"===status||"0.75 day Present, 0.25 day Absent"===status||-1!==status.indexOf("Absent -")&&-1!==status.indexOf("Present -")&&2===status.split(",").length)&&!data[i].isToday&&(!entries[0]||entries.length>0&&!lastEntryObj.allowPunchOut))colorClass="zpl_absntBg",per=100;else if("Present"===status)colorClass="zpl_prsntBg";else if(-1!==status.indexOf("Weekend"))per=100,colorClass="zpl_wkendBg";else if(status.includes("Holiday")||Att_Common_Operations.isRestrictedHoliday(status))per=100,colorClass="zpl_holiBg",!status.includes("Present")||!Att_Common_Operations.isUnAvailedRestrictedHoliday(status)&&(!status.includes("0.5 day Holiday)")||status.includes("0.5 day Paid Leave")||status.includes("0.5 day On Duty")||status.includes("0.5 day Unpaid Leave")||data[i].fulldayPresent)?data[i].session&&(per=50,"2"===data[i].session&&(leftPer=50)):colorClass="zpl_prsntBg";else if(-1!==status.indexOf("Paid Leave")){per=100,colorClass="zpl_levBg";var sessionIndex=(indStatus=status.slice(status.indexOf("Paid Leave"),status.indexOf(",",status.indexOf("Paid Leave")))).indexOf("$");if(-1!==status.indexOf("Present")&&(-1!==status.indexOf("0.5 day Paid Leave")&&-1===status.indexOf("0.5 day On Duty")&&-1===status.indexOf("0.5 day Unpaid Leave")||data[i].leaveHours))colorClass="zpl_prsntBg";else if(-1!==sessionIndex&&"0"!==indStatus.slice(sessionIndex+1,sessionIndex+2)){var session=indStatus.slice(sessionIndex+1,sessionIndex+2);per=-1===indStatus.indexOf("0.5")?25:50,"2"===session?leftPer=per:"3"===session?leftPer=50:"4"===session&&(leftPer=75)}}else if(-1!==status.indexOf("On Duty")){per=100,colorClass="zpl_ondutyBg";sessionIndex=(indStatus=status.slice(status.indexOf("On Duty"),status.indexOf(",",status.indexOf("On Duty")))).indexOf("$");if(-1!==status.indexOf("Present")&&(-1!==status.indexOf("0.5 day On Duty")&&-1===status.indexOf("0.5 day Unpaid Leave")||data[i].leaveHours))colorClass="zpl_prsntBg";else if(-1!==sessionIndex&&"0"!==indStatus.slice(sessionIndex+1,sessionIndex+2)){session=indStatus.slice(sessionIndex+1,sessionIndex+2);per=-1===indStatus.indexOf("0.5")?25:50,"2"===session?leftPer=per:"3"===session?leftPer=50:"4"===session&&(leftPer=75)}}else if(-1!==status.indexOf("Unpaid Leave")){per=100,colorClass="zpl_lopBg";sessionIndex=(indStatus=status.slice(status.indexOf("Unpaid Leave"),status.indexOf(",",status.indexOf("Unpaid Leave")))).indexOf("$");if(-1===status.indexOf("Present")||-1===status.indexOf("0.5 day Unpaid Leave")&&!data[i].leaveHours){if(-1!==sessionIndex&&"0"!==indStatus.slice(sessionIndex+1,sessionIndex+2)){session=indStatus.slice(sessionIndex+1,sessionIndex+2);per=-1===indStatus.indexOf("0.5")?25:50,"2"===session?leftPer=per:"3"===session?leftPer=50:"4"===session&&(leftPer=75)}}else colorClass="zpl_prsntBg"}trow+="<div class='zpl_attprgrs zpl_attcustbar'>";var statusIsActive="";entries.length>0&&(lastEntryObj.allowPunchOut||lastEntryObj.runningBreakId)&&"zpl_prsntBg"===colorClass&&(statusIsActive="zpl_prgrsbaractiv zpl_act"),trow+="<div class='zpl_custprgrsbar "+colorClass+" "+statusIsActive+"' style='left: "+leftPer+"%; width:"+per+"%;'>",trow+="</div></div></div></td>"}else{if($(Attendance.Entry.LayoutId+" #ZPAtt5_listView").is(":visible")&&(null!==Attendance.Entry.erecno?Layout.Page.container.find("#ZP-atdancehead").addClass("DNI"):(-1===Attendance.Entry.LayoutId.indexOf("selfservice")&&Layout.Page.container.find("#ZP-atdancehead").addClass("DNI"),Attendance.Entry.allowUIEntry||-1===Attendance.Entry.LayoutId.indexOf("selfservice")&&Layout.Page.container.find("#ZP-atdancehead").removeClass("DNI"))),-1!==Attendance.Entry.LayoutId.indexOf("selfservice")){headerCont=Layout.Page.container.find(".ZP-atdancehead");null===Attendance.Entry.erecno&&Attendance.Entry.allowUIEntry&&headerCont.hide().next().css("margin-top","20px")}trow+='<td width="24" onmouseover=Attendance.Entry.toggleEntryToolTip(this,false,true) onmouseout=Attendance.Entry.toggleEntryToolTip(this,true) onclick=Attendance.Entry.toggleEntryToolTip(this,true)><div class="zpl_attprgrsevnt"><div class="zpl_attprgrsStrt  zpl_maxprgrsdot" onmouseover="Attendance.Entry.toggleEntryToolTip(this,false,true)" onmouseout="Attendance.Entry.toggleEntryToolTip(this,true)" onclick="Attendance.Entry.toggleEntryToolTip(this,true)"></div> <div class="zpl_attprgrsEnd  zpl_maxprgrsdot"></div></div></td>',trow+="<td>",-1!==status.indexOf("0.5 Weekend")?(status=Attendance.Entry.halfWeekendSwap(status,"0.5 Weekend"),transStat=Attendance.consLeaveStat(status,!0,!1)):-1!==status.indexOf("0.5 Statutory (Weekend)")?(status=Attendance.Entry.halfWeekendSwap(status,"0.5 Statutory (Weekend)"),transStat=Attendance.consLeaveStat(status,!0,!1)):-1!==status.indexOf("0.5 Non-Statutory (Weekend)")&&(status=Attendance.Entry.halfWeekendSwap(status,"0.5 Non-Statutory (Weekend)"),transStat=Attendance.consLeaveStat(status,!0,!1));var fullBars="<div class ='zpl_attprgrswrpr' title='"+transStat+"' aria-label='"+transStat+"' tabindex='0'>";fullBars+="<div class='zpl_attprgrs zpl_attcustbar'>";var isPresent=!1,resHolBalStatus=status.split(",").slice(1).join(",").trim(),isResHolidayAbs=Att_Common_Operations.isRestrictedHoliday(status)&&("Absent"===resHolBalStatus||"0.5 day Present, 0.5 day Absent"===resHolBalStatus);("Absent"===status||"0.5 day Present, 0.5 day Absent"===status||"0.25 day Present, 0.75 day Absent"===status||"0.75 day Present, 0.25 day Absent"===status||-1!==status.indexOf("Absent -")&&-1!==status.indexOf("Present -")&&2===status.split(",").length)&&!data[i].isToday&&(!entries[0]||entries.length>0&&!lastEntryObj.allowPunchOut)?fullBars+="<div class='zpl_custprgrsbar zpl_absntBg'><span class='zpl_lvtag zpl_absntBrdr'>"+transStat+"</span>":isResHolidayAbs?fullBars+="<div class='zpl_custprgrsbar zpl_absntBg'><span class='zpl_lvtag zpl_absntBrdr'>"+resHolBalStatus+"</span>":(-1!==status.indexOf("Present")||0!==entries.length&&-1===status.indexOf("Absent"))&&(isPresent=!0);var splittedStatus=status.split(", "),leftPosWidthArr=[],rightPosWidthArr=[],checkNextStatus=!0,fullBarStatusChanged=!1;trow+=fullBars;for(var len=0;len<splittedStatus.length&&checkNextStatus;len++){var indStatus;if(fullBars="",-1!==(indStatus=splittedStatus[len]).indexOf("Weekend")&&-1===indStatus.indexOf("Present")){var width=100,leftPosInMins=data[i].shift.fTime,startPoint=0;leftPosInMins=data[i].shift.fTime,startPoint=0;if(data[i].weekendSession){sessionIndex=data[i].weekendSession;var wkndDurationBasedOnShift=(shiftWorkingHour=data[i].shift.fTime<data[i].shift.tTime?data[i].shift.tTime-data[i].shift.fTime:1440-data[i].shift.fTime+data[i].shift.tTime)/2;2===sessionIndex&&(leftPosInMins=data[i].shift.fTime+wkndDurationBasedOnShift),startPoint=Attendance.Entry.leftPositionCalc(Attendance.disHours(leftPosInMins),data[i].attDate,data[i].attDate),(width=Attendance.Entry.leftPositionCalc(Attendance.disHours(leftPosInMins+wkndDurationBasedOnShift),data[i].attDate,data[i].attDate)-startPoint)<0&&(width=0)}for(var leftPoint=startPoint,rightPoint=startPoint+width,skipConsStatus=!1,index=0;index<rightPosWidthArr.length;index++){if(leftPoint>=leftPosWidthArr[index]&&rightPoint<=rightPosWidthArr[index]||leftPoint<leftPosWidthArr[index]&&rightPoint>rightPosWidthArr[index]){skipConsStatus=!0;break}leftPoint>=leftPosWidthArr[index]&&rightPoint>rightPosWidthArr[index]&&leftPoint<rightPosWidthArr[index]?leftPoint=rightPosWidthArr[index]:leftPoint<=leftPosWidthArr[index]&&rightPoint>leftPosWidthArr[index]&&rightPoint<=rightPosWidthArr[index]&&(rightPoint=leftPosWidthArr[index])}if(leftPoint=leftPoint<0?0:leftPoint>100?100:leftPoint,rightPoint=rightPoint<0?0:rightPoint>100?100:rightPoint,skipConsStatus)continue;(width=rightPoint-leftPoint)<0&&(width=0);var holidayBarClass="zpl_custprgrsbar";100==width&&(holidayBarClass="zpl_custprgrsbar",checkNextStatus=!1),100==width&&isPresent||(leftPosWidthArr.push(leftPoint),rightPosWidthArr.push(rightPoint),fullBarStatusChanged=!0,fullBars="<div class='"+holidayBarClass+" zpl_wkendBg' style='left: "+leftPoint+"%; width:"+width+"%;'><span class='zpl_lvtag zpl_wkendBrdr'>",-1!==transStat.indexOf("Weekend")?fullBars+=transStat.split(",")[len]+"</span></div>":fullBars+=transStat+"</span></div>")}else if(-1!==indStatus.indexOf("Unpaid Leave")||-1!==indStatus.indexOf("On Duty")||-1!==indStatus.indexOf("Paid Leave")){width=100,leftPosInMins=data[i].shift.fTime;var leaveStatus=transStat,hourBasedIndex=(startPoint=0,sessionIndex=indStatus.indexOf("$"),indStatus.indexOf("#"));if(-1!==sessionIndex&&"0"!==indStatus.slice(sessionIndex+1,sessionIndex+2)){var leaveDurationBasedOnShift=(shiftWorkingHour=data[i].shift.fTime<data[i].shift.tTime?data[i].shift.tTime-data[i].shift.fTime:1440-data[i].shift.fTime+data[i].shift.tTime)/4;-1!==indStatus.indexOf("0.5")&&(leaveDurationBasedOnShift=shiftWorkingHour/2);var curDaySession=indStatus.slice(sessionIndex+1,sessionIndex+2);"2"===curDaySession?leftPosInMins=data[i].shift.fTime+leaveDurationBasedOnShift:"3"===curDaySession?leftPosInMins=data[i].shift.fTime+2*leaveDurationBasedOnShift:"4"===curDaySession&&(leftPosInMins=data[i].shift.fTime+3*leaveDurationBasedOnShift),startPoint=Attendance.Entry.leftPositionCalc(Attendance.disHours(leftPosInMins),data[i].attDate,data[i].attDate),(width=Attendance.Entry.leftPositionCalc(Attendance.disHours(leftPosInMins+leaveDurationBasedOnShift),data[i].attDate,data[i].attDate)-startPoint)<0&&(width=0),leaveStatus=Attendance.setLeaveStat(indStatus,!0)}else if(-1!==hourBasedIndex){var hourDetails=indStatus.slice(hourBasedIndex+1,indStatus.indexOf("#",hourBasedIndex+1)).split(" ");startPoint=Attendance.Entry.leftPositionCalc(Attendance.disHours(hourDetails[0]),data[i].attDate,data[i].attDate),(width=Attendance.Entry.leftPositionCalc(Attendance.disHours(hourDetails[1]),data[i].attDate,data[i].attDate)-startPoint)<0&&(width=0),leaveStatus=Attendance.setLeaveStat(indStatus,!0)}for(leftPoint=startPoint,rightPoint=startPoint+width,skipConsStatus=!1,index=0;index<rightPosWidthArr.length;index++){if(leftPoint>=leftPosWidthArr[index]&&rightPoint<=rightPosWidthArr[index]||leftPoint<leftPosWidthArr[index]&&rightPoint>rightPosWidthArr[index]){skipConsStatus=!0;break}leftPoint>=leftPosWidthArr[index]&&rightPoint>rightPosWidthArr[index]&&leftPoint<rightPosWidthArr[index]?leftPoint=rightPosWidthArr[index]:leftPoint<=leftPosWidthArr[index]&&rightPoint>leftPosWidthArr[index]&&rightPoint<=rightPosWidthArr[index]&&(rightPoint=leftPosWidthArr[index])}if(leftPoint=leftPoint<0?0:leftPoint>100?100:leftPoint,rightPoint=rightPoint<0?0:rightPoint>100?100:rightPoint,skipConsStatus)continue;if((width=rightPoint-leftPoint)<0&&(width=0),0===startPoint&&0===width||100===startPoint&&0===width)continue;var leaveBarClass="zpl_custprgrsbar";100==width&&(leaveBarClass="zpl_custprgrsbar",checkNextStatus=!1),100==width&&isPresent||(leftPosWidthArr.push(leftPoint),rightPosWidthArr.push(rightPoint),fullBarStatusChanged=!0,fullBars="<div class='"+leaveBarClass+" zpl_lopBg' style='left: "+leftPoint+"%; width:"+width+"%;'><span class='zpl_lvtag zpl_lopBrdr'>"+leaveStatus+"</span></div>",-1!==indStatus.indexOf("Paid Leave")?fullBars="<div class='"+leaveBarClass+" zpl_levBg' style='left: "+leftPoint+"%; width:"+width+"%;'><span class='zpl_lvtag zpl_levBrdr'>"+leaveStatus+"</span></div>":-1!==indStatus.indexOf("On Duty")&&(fullBars="<div class='"+leaveBarClass+" zpl_ondutyBg' style='left: "+leftPoint+"%; width:"+width+"%;'><span class='zpl_lvtag zpl_ondutyBrdr'>"+leaveStatus+"</span></div>"))}else if(!isResHolidayAbs&&(Att_Common_Operations.isAvailedRestrictedHoliday(status)||Att_Common_Operations.isUnAvailedRestrictedHoliday(status)&&!indStatus.includes("Present")||indStatus.includes("Holiday")&&!Att_Common_Operations.isRestrictedHoliday(status))){width=100,leftPosInMins=data[i].shift.fTime,startPoint=0;if(data[i].session){sessionIndex=data[i].session;var shiftWorkingHour,holDurationBasedOnShift=(shiftWorkingHour=data[i].shift.fTime<data[i].shift.tTime?data[i].shift.tTime-data[i].shift.fTime:1440-data[i].shift.fTime+data[i].shift.tTime)/2;"2"===sessionIndex&&(leftPosInMins=data[i].shift.fTime+holDurationBasedOnShift),startPoint=Attendance.Entry.leftPositionCalc(Attendance.disHours(leftPosInMins),data[i].attDate,data[i].attDate),(width=Attendance.Entry.leftPositionCalc(Attendance.disHours(leftPosInMins+holDurationBasedOnShift),data[i].attDate,data[i].attDate)-startPoint)<0&&(width=0)}for(leftPoint=startPoint,rightPoint=startPoint+width,skipConsStatus=!1,index=0;index<rightPosWidthArr.length;index++){if(leftPoint>=leftPosWidthArr[index]&&rightPoint<=rightPosWidthArr[index]||leftPoint<leftPosWidthArr[index]&&rightPoint>rightPosWidthArr[index]){skipConsStatus=!0;break}leftPoint>=leftPosWidthArr[index]&&rightPoint>rightPosWidthArr[index]&&leftPoint<rightPosWidthArr[index]?leftPoint=rightPosWidthArr[index]:leftPoint<=leftPosWidthArr[index]&&rightPoint>leftPosWidthArr[index]&&rightPoint<=rightPosWidthArr[index]&&(rightPoint=leftPosWidthArr[index])}if(leftPoint=leftPoint<0?0:leftPoint>100?100:leftPoint,rightPoint=rightPoint<0?0:rightPoint>100?100:rightPoint,skipConsStatus)continue;(width=rightPoint-leftPoint)<0&&(width=0);holidayBarClass="zpl_custprgrsbar";100==width&&(holidayBarClass="zpl_custprgrsbar",checkNextStatus=!1),100==width&&isPresent||(leftPosWidthArr.push(leftPoint),rightPosWidthArr.push(rightPoint),fullBarStatusChanged=!0,fullBars="<div class='"+holidayBarClass+" zpl_holiBg' style='left: "+leftPoint+"%; width:"+width+"%;'><span class='zpl_lvtag zpl_holiBrdr'>",transStat.includes("Holiday")||Att_Common_Operations.isRestrictedHoliday(transStat)?fullBars+=transStat.split(",")[len]+"</span></div>":fullBars+=transStat+"</span></div>")}if((-1!==status.indexOf("day Absent")||-1!==status.indexOf("Absent - "))&&len===splittedStatus.length-1){fullBarStatusChanged=!0,leftPosWidthArr.sort(Attendance.Entry.intArrSort),rightPosWidthArr.sort(Attendance.Entry.intArrSort);for(var sp=0;sp<leftPosWidthArr.length;sp++){var lePos=leftPosWidthArr[sp],riPos=rightPosWidthArr[sp];0===sp&&0!==lePos&&(fullBars+="<div class='zpl_custprgrsbar zpl_absntBg' style='left:0%; width:"+lePos+"%;'><span class='zpl_lvtag zpl_absntBrdr'>"+indStatus+"</span></div>"),0!==sp&&0!==lePos&&1!==leftPosWidthArr.length&&lePos!==rightPosWidthArr[sp-1]&&(fullBars+="<div class='zpl_custprgrsbar zpl_absntBg' style='left:"+rightPosWidthArr[sp-1]+"%; width:"+(lePos-rightPosWidthArr[sp-1])+"%;'><span class='zpl_lvtag zpl_absntBrdr'>"+indStatus+"</span></div>"),sp===leftPosWidthArr.length-1&&riPos!==lePos&&100!==riPos&&(fullBars+="<div class='zpl_custprgrsbar zpl_absntBg' style='left:"+riPos+"%; width:"+(100-riPos)+"%;'><span class='zpl_lvtag zpl_absntBrdr'>"+indStatus+"</span></div>")}}fullBarStatusChanged&&(trow+=fullBars)}fullBarStatusChanged||(trow+=fullBars);var beforeShiftEntries=[],afterShiftEntries=[];if(isPresent){var singleEntries=[];if((0===entries.length||data[i].approvalInfo&&1===data[i].approvalInfo.status)&&data[i].filo&&(data[i].filo.fdate||data[i].filo.tdate)){var entriesObj={};data[i].filo.fdate&&(entriesObj.fdate=data[i].filo.fdate+" - "+data[i].filo.ftime),data[i].filo.tdate&&(entriesObj.tdate=data[i].filo.tdate+" - "+data[i].filo.ttime),singleEntries.push(entriesObj)}else singleEntries=entries;for(var j=singleEntries.length-1;j>=0;j--)if(1!==Object.keys(singleEntries[j]).length){var leftPosOfToTime=0,leftPosOfFromTime=0,fromDateTime=singleEntries[j].fdate,toDateTime=singleEntries[j].tdate,active="";if(fromDateTime){var fromDate=fromDateTime.slice(0,11);if("-"===fromDate[fromDate.length-1]&&(fromDate=fromDate.slice(0,10)),""!==(fromDateTime=Attendance.disTimeOnly(fromDateTime))&&"-"!==fromDateTime){var tempLeftPosOfFromTime=Attendance.Entry.leftPositionCalc(fromDateTime,fromDate,data[i].ldate);leftPosOfFromTime=tempLeftPosOfFromTime,tempLeftPosOfFromTime>=100?leftPosOfFromTime=100:tempLeftPosOfFromTime<=0&&(leftPosOfFromTime=0)}}if(toDateTime){var toDate=toDateTime.slice(0,11);if("-"===toDate[toDate.length-1]&&(toDate=toDate.slice(0,10)),""!==(toDateTime=Attendance.disTimeOnly(toDateTime))&&"-"!==toDateTime){var tempLeftPosOfToTime=Attendance.Entry.leftPositionCalc(toDateTime,toDate,data[i].ldate);leftPosOfToTime=tempLeftPosOfToTime,tempLeftPosOfToTime>=100?leftPosOfToTime=100:tempLeftPosOfToTime<=0&&(leftPosOfToTime=0),1==Attendance.Entry.allDataList.showAllEntries&&singleEntries[j].runningBreakId&&(active="zpl_prgrsbaractiv zpl_act")}else active="zpl_prgrsbaractiv zpl_act"}var beforeinOrOutObj={},afterinOrOutObj={};if(""!==fromDateTime&&"-"!==fromDateTime&&""!==toDateTime&&"-"!==toDateTime){for(leftPoint=tempLeftPosOfFromTime,rightPoint=tempLeftPosOfToTime,skipConsStatus=!1,index=0;index<rightPosWidthArr.length;index++){if(leftPoint>=leftPosWidthArr[index]&&rightPoint<=rightPosWidthArr[index]||leftPoint<leftPosWidthArr[index]&&rightPoint>rightPosWidthArr[index]){skipConsStatus=!0;break}leftPoint>=leftPosWidthArr[index]&&rightPoint>rightPosWidthArr[index]&&leftPoint<rightPosWidthArr[index]?leftPoint=rightPosWidthArr[index]:leftPoint<=leftPosWidthArr[index]&&rightPoint>leftPosWidthArr[index]&&rightPoint<=rightPosWidthArr[index]&&(rightPoint=leftPosWidthArr[index])}if(skipConsStatus)continue;tempLeftPosOfToTime=rightPoint,leftPosOfFromTime=(tempLeftPosOfFromTime=leftPoint)>=100?100:tempLeftPosOfFromTime<=0?0:tempLeftPosOfFromTime,leftPosOfToTime=tempLeftPosOfToTime>=100?100:tempLeftPosOfToTime<=0?0:tempLeftPosOfToTime}if(""!==fromDateTime&&"-"!==fromDateTime){var inWidth=leftPosOfToTime-leftPosOfFromTime;inWidth<0&&(inWidth=0);var lineBGColorClass="zpl_prsntBg";singleEntries[j].breakId&&(lineBGColorClass="LC"+Attendance.Entry.allDataList.breakList.breakObj[singleEntries[j].breakId].breakColorCode),trow+='<div class="zpl_custprgrsbar '+lineBGColorClass+" "+active+'" style="width : '+inWidth+"%; left:"+leftPosOfFromTime+'%;">',tempLeftPosOfFromTime<=100&&tempLeftPosOfFromTime>=0?trow+="<span class='zpl_attprgrsdot zpl_prsntBg' style='left:-7px' onmouseover='Attendance.Entry.toggleEntryToolTip(this,false,false,\""+fromDateTime+"\",false)' onmouseout=Attendance.Entry.toggleEntryToolTip(this,true) onclick=Attendance.Entry.toggleEntryToolTip(this,true)></span>":tempLeftPosOfFromTime>100?(before_afterShiftEntryObj.afterFrom=!0,afterinOrOutObj.checkin=fromDateTime):(before_afterShiftEntryObj.beforeFrom=!0,beforeinOrOutObj.checkin=fromDateTime),trow+="</div>"}""!==toDateTime&&"-"!==toDateTime&&(!data[i].isToday||data[i].isToday&&"in"==Attendance.Entry.checkInOut&&1==Attendance.Entry.allDataList.showAllEntries||0==Attendance.Entry.allDataList.showAllEntries)&&(""!==toDateTime&&"-"!==toDateTime&&tempLeftPosOfToTime<=100&&tempLeftPosOfToTime>=0?trow+="<span class='zpl_attprgrsdot zpl_absntBg'style='left:"+(tempLeftPosOfToTime=100==tempLeftPosOfToTime?tempLeftPosOfToTime+.2:tempLeftPosOfToTime)+"%;' onmouseover='Attendance.Entry.toggleEntryToolTip(this,false,false,false,\""+toDateTime+"\")' onmouseout=Attendance.Entry.toggleEntryToolTip(this,true) onclick=Attendance.Entry.toggleEntryToolTip(this,true)></span>":tempLeftPosOfToTime>100?(before_afterShiftEntryObj.afterTo=!0,afterinOrOutObj.checkout=toDateTime):tempLeftPosOfToTime<0&&(before_afterShiftEntryObj.beforeTo=!0,beforeinOrOutObj.checkout=toDateTime)),0!==Object.keys(afterinOrOutObj).length&&afterShiftEntries.push(afterinOrOutObj),0!==Object.keys(beforeinOrOutObj).length&&beforeShiftEntries.push(beforeinOrOutObj)}}before_afterShiftEntriesObj.beforeEntries=beforeShiftEntries,before_afterShiftEntriesObj.afterEntries=afterShiftEntries,Attendance.Entry.before_afterShiftEntry[data[i].attDate]=before_afterShiftEntryObj,Attendance.Entry.before_afterShiftEntries[data[i].attDate]=before_afterShiftEntriesObj,trow+="</div></div></td>",trow+='<td width="24" onmouseover=Attendance.Entry.toggleEntryToolTip(this,false,true) onmouseout=Attendance.Entry.toggleEntryToolTip(this,true) onclick=Attendance.Entry.toggleEntryToolTip(this,true)><div class="zpl_attprgrsevnt"><div class="zpl_attprgrsStrt  zpl_maxprgrsdot"></div><div class="zpl_attprgrsEnd  zpl_maxprgrsdot"></div></div></td>'}var hrs="";if(data[i].tsecs>=0&&(hrs=ZPI18N.getString("zp.hrs.worked")),data[i].filo.ttime&&(!data[i].isToday||data[i].isToday&&"in"==Attendance.Entry.checkInOut)?(trow+="<td width='150'><div class='zpl_attentrydtls' tabindex='0' aria-label='"+ZPI18N.getString("zp.checkouttime")+" :  "+data[i].filo.ttime+"'><b>"+data[i].filo.ttime+"</b>",Attendance.Entry.hasOpenCheckin=!1,data[i].earlyby&&data[i].showEalryLateEntries&&(trow+="<em>"+ZPI18N.getString("zp.earlyby",[""])+"<span class='org'>"+data[i].earlyby+"</span></em>"),trow+="</div></td>"):(trow+="<td width='150'></td>",Attendance.Entry.hasOpenCheckin=!!data[i].isToday||Attendance.Entry.hasOpenCheckin),trow+="<td width='150'><div class='zpl_attentrydtls' tabindex='0' aria-label ='"+ZPI18N.getString("zp.hours.worked")+": "+Attendance.disHours(data[i].tsecs/60)+"'><b>"+Attendance.disHours(data[i].tsecs/60)+"</b><em>"+hrs+"</em></div></td>",data[i].isToday&&$(Attendance.Entry.LayoutId+" #ZPAtt_clock")){var clocktotalsecs=data[i].tsecs?data[i].tsecs:0,sec=parseInt(clocktotalsecs%60),min=parseInt((clocktotalsecs-sec)/60%60);hrs=parseInt((clocktotalsecs-min)/3600);$(Attendance.Entry.LayoutId+" #ZPAtt_clock").html("<b>"+Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+":"+Attendance.disTwoDigit(sec)+" "+ZPI18N.getString("zp.hrs")+"</b>")}var updateRow="",attDate=data[i].attDate;if(updateTR){var upDateRowIndex=$(updateTR).index();$(updateTR).find("[data-toggle=tooltip]").tooltip("hide"),$(updateTR).replaceWith(trow),updateRow=$(tbody.children()[upDateRowIndex])}else tbody.append(trow),updateRow=$(tbody.children()[i]);if(lastEntryObj&&lastEntryObj.isPrevExtended){var newToday=$(".today-active").prev();if(Attendance.Entry.isPrevExtended=!0,newToday[0])$(".today-active").removeAttr("class"),$(newToday).attr("class","today-active zpl_crntday"),entries=Attendance.Entry.allDataList.entries[data[$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").index()].attDate];else{if(isLoadPrevWeekOrMonth)return void $(Attendance.Entry.LayoutId+" #ZPAtt_entryNavigation").prev().children()[0].click();$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active td").removeAttr("style"),$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").removeClass("today-active"),$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .zpl_crntday").removeClass("zpl_crntday")}}if(0===Attendance.Entry.allDataList.showScaleView&&0!==Object.keys(Attendance.Entry.before_afterShiftEntry).length&&(Attendance.Entry.before_afterShiftEntry[attDate].beforeFrom&&$(updateRow.children()[2].children[0]).find(".zpl_attprgrsStrt").addClass("zpl_prsntBg"),Attendance.Entry.before_afterShiftEntry[attDate].beforeFrom&&!Attendance.Entry.before_afterShiftEntry[attDate].beforeTo?$(updateRow.children()[2].children[0].children[1]).addClass("zpl_prsntBg"):Attendance.Entry.before_afterShiftEntry[attDate].beforeTo&&$(updateRow.children()[2].children[0].children[1]).addClass("zpl_absntBg"),(Attendance.Entry.before_afterShiftEntry[attDate].afterFrom||Attendance.Entry.before_afterShiftEntry[attDate].afterTo)&&$(updateRow.children()[4].children[0]).find(".zpl_attprgrsStrt").addClass("zpl_prsntBg"),Attendance.Entry.before_afterShiftEntry[attDate].afterFrom&&!Attendance.Entry.before_afterShiftEntry[attDate].afterTo?$(updateRow.children()[4].children[0].children[1]).addClass("zpl_prsntBg"):Attendance.Entry.before_afterShiftEntry[attDate].afterTo&&$(updateRow.children()[4].children[0].children[1]).addClass("zpl_absntBg")),(data[i].isToday||Object.keys(data).length===i+1)&&entries.length>0&&(lastEntryObj.allowPunchOut||lastEntryObj.runningBreakId)){var lastObj=lastEntryObj;if(Attendance.Entry.isPrevExtended&&Attendance.Entry.showOrHideBreakSelect(!1),Attendance.Entry.breakRowOpen=!1,lastObj.allowPunchOut?Attendance.Entry.checkInOut="out":Attendance.Entry.breakRowOpen=!0,$(".today-active")[0]||($(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").children().last().attr("class","today-active zpl_crntday"),$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").prev().find("td").css("border-color","rgb(223, 230, 235)")),void 0!==lastObj.tsecs)Attendance.Entry.updateTotalmins(lastObj.tsecs,"set",lastObj.lsecs),Attendance.Entry.setDraggableLine();else if(Attendance.Entry.temp_tsecs=0,1===Attendance.Entry.allDataList.showAllEntries){var addSecs=lastObj.totalSecs?lastObj.addSecs+lastObj.totalSecs:lastObj.addSecs;Attendance.Entry.updateTotalmins(addSecs,"set",lastObj.lsecs)}else Attendance.Entry.updateTotalmins(lastObj.addSecs);Attendance.Entry.setFunctionInOrOut()}else if(lastEntryObj&&lastEntryObj.isPrevExtended){if(Attendance.Entry.showOrHideBreakSelect(!1),Attendance.Entry.checkInOut="out",entries.length>0){var checkInFdate,templastEntryObj={};if(entries.length>0){displayLastRow=entries[entries.length-1];templastEntryObj=1==entries.length?displayLastRow:entries[displayLastRow.lastRowIndex]}if(templastEntryObj.allowPunchOut)"-"===(checkInFdate=templastEntryObj.fdate.slice(0,11))[checkInFdate.length-1]&&(checkInFdate=checkInFdate.slice(0,10)),Attendance.Entry.latestCheckinLeftPos=Attendance.Entry.leftPositionCalc(Attendance.disTimeOnly(templastEntryObj.fdate),checkInFdate,data[i-1].ldate),Attendance.Entry.latestCheckinDate=checkInFdate;if(void 0!==templastEntryObj.tsecs)Attendance.Entry.updateTotalmins(templastEntryObj.tsecs,"set",templastEntryObj.lsecs);else if(templastEntryObj.addSecs)if(Attendance.Entry.temp_tsecs=0,1===Attendance.Entry.allDataList.showAllEntries){addSecs=templastEntryObj.totalSecs?templastEntryObj.addSecs+templastEntryObj.totalSecs:templastEntryObj.addSecs;Attendance.Entry.updateTotalmins(addSecs,"set",templastEntryObj.lsecs)}else Attendance.Entry.updateTotalmins(templastEntryObj.addSecs)}Attendance.Entry.setFunctionInOrOut()}}$(Attendance.Entry.LayoutId+" #ZPAtt_allEntries_popup").is(":visible")&&!fromEntryEdit&&Attendance.Entry.consEntriesPopup($(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").children()[Attendance.Entry.selectedRowIndex]),Attendance.Entry.isProfilePage&&0===Attendance.Entry.allDataList.showScaleView&&Attendance.Entry.setScaleViewWidth()}},setScaleViewWidth:function(){$(Attendance.Entry.LayoutId+" #ZPAtt_timeAndScaleMeasure .zpl_tbl").css("width",$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").width()),$(Attendance.Entry.LayoutId+" #ZPAtt_timeAndScaleMeasure #scaleViewTD").css("width",$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .zpl_attprgrs").width()),$(window).on("resize",function(){$(Attendance.Entry.LayoutId+" #ZPAtt_timeAndScaleMeasure .zpl_tbl").css("width",$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").width()),$(Attendance.Entry.LayoutId+" #ZPAtt_timeAndScaleMeasure #scaleViewTD").css("width",$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .zpl_attprgrs").width())})},intArrSort:function(a,b){return a-b},halfWeekendSwap:function(status,wkndName){if(status.length!==wkndName.length){var lIndex=(status=status.substring(0,status.indexOf(", "+wkndName))).lastIndexOf(",");if(-1===lIndex)status=-1!==status.indexOf("0.5 day Holiday")?status.concat(", ").concat(wkndName):wkndName.concat(", ").concat(status);else{var temp=status.substring(lIndex+2);status=status.substring(0,lIndex).concat(", ").concat(wkndName).concat(", ").concat(temp)}}return status},toggleEntryToolTip:function(obj,isclose,isBeforeOrAfter,fromTime,toTime){if(isclose)$(Attendance.Entry.LayoutId+" #ZPAtt_entry_toolTip").hide();else{var topReduce=30,leftReduce=26;-1!==Attendance.Entry.LayoutId.indexOf("selfservice")&&(topReduce=44);var tooltipPop=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_toolTip_list");if(tooltipPop.empty(),isBeforeOrAfter){var attDate=Attendance.Entry.allDataList.dayList[$(obj).parent().index()].attDate,allentries=Attendance.Entry.before_afterShiftEntries[attDate],befOrAft="afterEntries";2===$(obj).index()&&(befOrAft="beforeEntries",leftReduce=23),"today-active"===$(obj).parent().attr("class")&&(topReduce=-30);var entries=allentries[befOrAft];if(0!==entries.length)for(var i in entries){var checkIn=entries[i].checkin,li="";checkIn&&(li+="<li class='grn'><span>"+ZPI18N.getString("zp.checkin")+", "+checkIn+"</span></li>");var checkOut=entries[i].checkout;checkOut&&(li+="<li class='red'><span>"+ZPI18N.getString("zp.checkout")+", "+checkOut+"</span></li>"),tooltipPop.append(li)}if(tooltipPop.is(":empty"))return void $(Attendance.Entry.LayoutId+" #ZPAtt_entry_toolTip").hide()}else{topReduce=62,-1!==Attendance.Entry.LayoutId.indexOf("selfservice")&&(topReduce=17),leftReduce=17;var li1="";fromTime?li1="<li class='grn'><span>"+ZPI18N.getString("zp.checkin")+", "+fromTime+"</span></li>":toTime&&(li1="<li class='red'><span>"+ZPI18N.getString("zp.checkout")+", "+toTime+"</span></li>"),tooltipPop.append(li1)}var left=$(obj).offset().left-$(Attendance.Entry.LayoutId+" #ZPAtt5_listView").parent().offset().left-(.6*$(Attendance.Entry.LayoutId+" #ZPAtt_entry_toolTip").width()-leftReduce),top=$(obj).offset().top;if(-1!==Attendance.Entry.LayoutId.indexOf("selfservice"))top=top-$(Attendance.Entry.LayoutId+" #"+Layout.Page.container[0].id).offset().top+topReduce+20,left+=10;else top=top-$(Attendance.Entry.LayoutId+" #ZPAtt5_listView").parent().offset().top-topReduce;$(Attendance.Entry.LayoutId+" #ZPAtt_entry_toolTip").css({top:top,left:left}).show()}},editShowCheck:null,selectedRowIndex:null,consEntriesPopup:function(obj){var allData=Attendance.Entry.allDataList,date=allData.dayList[$(obj).index()].attDate,ldate=allData.dayList[$(obj).index()].ldate,isToday=allData.dayList[$(obj).index()].isToday,showAllEntries=allData.showAllEntries,shift=allData.dayList[$(obj).index()].shift,entries=allData.entries[date],odEntries=[];if(isOnDutyConfigured&&Object.keys(allData.odEntries).length&&(odEntries=allData.odEntries[date]),!(Calendar.parseDate(Attendance.Entry.allDataList.currDate.todayDate,uidateFormat)<Calendar.parseDate(ldate,uidateFormat)&&entries.length<=0&&odEntries.length<=0)){$(Attendance.Entry.LayoutId+" #ZP5Att_NoEntry").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_allEntries_popup").show();var eShow=isSPOCEntryEdit&&(Attendance.Entry.erecno&&isSPOCEntryEdit.includes(Attendance.Entry.erecno)||!Attendance.Entry.erecno&&isSPOCEntryEdit.includes(erecno));eShow||isManageAttendanceData&&Attendance.Entry.isEditAllowedForLocationAdmin||!isRegConfigured&&Attendance.Entry.isEditAllowed&&null===Attendance.Entry.erecno||Attendance.Entry.isEditAllowedForSub&&null!==Attendance.Entry.erecno&&Attendance.Entry.isSubOrdinate?Attendance.Entry.editShowCheck=!0:Attendance.Entry.editShowCheck=!1;var isLeaveTabActive=-1!==ZPTabs.ACTIVE_TABARR.toString().toLowerCase().indexOf("leavetracker");Layout.Page.container.find("#leave-bt").text(ZPI18N.getString("zp.apply.context.leave")+" "+ZPeople.decodeTxt(ZPeople.Module.MODULE_DATA.attendance.formname)),date=date.split("-");var dayList=allData.dayList[$(obj).index()];Attendance.Entry.selectedRowIndex=$(obj).index();var status=dayList.status;if($(Attendance.Entry.LayoutId+" #attEntryHeaderDate").text(days[dayList.day-1]+", "+date[2]+" "+months[date[1]-1]+" "+date[0]),shift&&shift.shiftId){var shfitDetailHtml='<h5 class="zpl_ellipsis">'+Shift.getShiftName(shift.shiftId,!0,!1).shiftName+"</h5><em>["+Shift.getShiftTimeForDisplay(shift.shiftId)+"]</em>";$(Attendance.Entry.LayoutId+" #attEntryHeaderShiftDetails").html(shfitDetailHtml)}var entriesCont=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_allEntriesList");entriesCont.empty();var latLongList=new Array,addRegForSub=Attendance.Entry.allDataList.addRegForSub,tmpList="";if(entries[0]&&!entries[0].processRowEntry&&(1!==entries.length||1!==Object.keys(entries[0]).length)||odEntries.length>0){for(var i=0;i<entries.length;i++)if(1!==Object.keys(entries[i]).length){var attRowClass="zpl_attdtlsinrDv";(entries[i].geoLocation_in||entries[i].geoLocation_out||null!==Attendance.Entry.cityNamesList&&0!==Object.keys(Attendance.Entry.cityNamesList).length&&(entries[i].punchin_userip&&Attendance.Entry.cityNamesList[entries[i].punchin_userip]&&"-"!==Attendance.Entry.cityNamesList[entries[i].punchin_userip]||entries[i].punchout_userip&&Attendance.Entry.cityNamesList[entries[i].punchout_userip]&&"-"!==Attendance.Entry.cityNamesList[entries[i].punchout_userip])||entries[i].latitude_in||entries[i].latitude_out)&&(attRowClass="zpl_attdtlsinrDv");var breakAtt="";entries[i].breakId&&(breakAtt="breakId = "+entries[i].breakId);var list1="<div class='"+attRowClass+"' "+breakAtt+">";list1+="<div class='zpl_attSrcrw' id='ZPAtt_AttEntries'>",list1+="<div class='zpl_attchkTm'>";var isFromReg=15===entries[i].inputType_in&&15===entries[i].inputType_out||1===entries.length&&(15===entries[0].inputType_in||15===entries[0].inputType_out);if("-"!==entries[i].fdate.trim()){if(-1!==entries[i].fdate.indexOf(ldate))list1+="<span class='grn'>"+Attendance.disTimeOnly(entries[i].fdate);else list1+="<span class='grn'>"+(dateTime=entries[i].fdate.split(" - "))[0]+" "+dateTime[1].trim();var fromInpType=Attendance.Entry.getInputType(entries[i].inputType_in,!0);list1+="<i class='"+fromInpType.className+"' data-toggle='tooltip' data-placement='right' title='"+fromInpType.title+"'></i>",entries[i].attachId_in&&(list1+="<div class='zpl_attusrIcn lft' onclick=Attendance.Entry.showAttachment(this,true) title='"+ZPI18N.getString("zp.attachment")+"'><i class='PI_user'></i></div>"),list1+="</span>";var cityName_In="",geoLocName_in=entries[i].geoLocation_in,building_In=entries[i].building_in,foundGeoName_in=geoLocName_in&&""!==geoLocName_in&&"-"!==geoLocName_in;foundGeoName_in?cityName_In=geoLocName_in:null!==Attendance.Entry.cityNamesList&&0!==Object.keys(Attendance.Entry.cityNamesList).length&&entries[i].punchin_userip&&Attendance.Entry.cityNamesList[entries[i].punchin_userip]&&"-"!==Attendance.Entry.cityNamesList[entries[i].punchin_userip]&&(cityName_In=(cityName_In=Attendance.Entry.cityNamesList[entries[i].punchin_userip]).charAt(0).toUpperCase()+cityName_In.substr(1).toLowerCase());var latAndLon_in="",viewInMapLink="";if(entries[i].latitude_in&&entries[i].longitude_in){if(latAndLon_in="latLon_in_"+i,!foundGeoName_in){var latLonInObj={};latLonInObj.lat=entries[i].latitude_in,latLonInObj.lon=entries[i].longitude_in,latLonInObj.id="latLon_in_"+i,latLongList.push(latLonInObj)}viewInMapLink="<a onclick=Attendance.Entry.mapContCons(this)>"+ZPI18N.getString("zp.viewmap")+"</a>"}if(""!==cityName_In||""!==viewInMapLink){list1+="<span id='"+latAndLon_in+"' class='zpl_attloctdtls'> <i class='PI_location'></i> "+cityName_In;var addressTypeIn=entries[i].addressType_in,locDispInfo="",accuracyIn=entries[i].accuracy_in,useripIn=entries[i].punchin_userip,latIn=entries[i].latitude_in;if(void 0!==accuracyIn){var accIn=parseInt(accuracyIn);accIn>1e3&&accIn<=3e3?locDispInfo=ZPI18N.getString("zp.lowaccuracyinfo",new Array(accIn+"")):accIn>3e3&&useripIn&&3==addressTypeIn&&(locDispInfo=ZPI18N.getString("zp.lowaccuracyandipaddrinfo",new Array(useripIn,accIn+"")))}else useripIn&&void 0===latIn&&3==addressTypeIn&&(locDispInfo=ZPI18N.getString("zp.ipaddrinfo",new Array(useripIn)));""!==locDispInfo&&(list1+=" <i class='PI_info tooltip-js' data-toggle='tooltip' data-placement='right'",list1+="title='"+locDispInfo+"'></i>"),list1+="</span>"+viewInMapLink}""!==building_In&&void 0!==building_In&&(list1+="<span id='ZPAtt_CheckIn_Building' class='zpl_attloctdtls'> <i class='PI_building'></i> "+building_In,list1+="</span>"),entries[i].desc_in&&(list1+="<span class='zpl_attloctdtls' id='ZPAtt_Checkin_Notes'>",list1+=$("<div/>").text(entries[i].desc_in).html(),list1+="</span>")}list1+="</div>";var isAutoBreak=!1,isManualBreak=!1,isBreak=!1,isShiftApp=!1,isPaidBreak=!1,breakTimeInSecs=0;if("-"!==entries[i].fdate.trim()&&"-"===entries[i].tdate.trim()||"-"===entries[i].fdate.trim()&&"-"!==entries[i].tdate.trim())list1+="<div class='zpl_attintdtls' style='visibility: hidden;'>",list1+="<button class='zpl_intbtns zpl_attinticn zpl_attbrkBg' style='visibility: hidden;'>",list1+="<i class='PI_brk'></i>Break</button>",list1+="<div class='dtdd'></div><span style='visibility: hidden;'>15 Mins</span></div>";else if("-"!==entries[i].fdate.trim()&&"-"!==entries[i].tdate.trim()){if(list1+="<div class='zpl_attintdtls'>",entries[i].breakId){var breakDetails=Attendance.Entry.allDataList.breakList.breakObj[entries[i].breakId];isAutoBreak=entries[i].isAutomatic,isManualBreak=entries[i].isManualInput,isShiftApp=entries[i].isShiftApplicable,isPaidBreak=entries[i].isPaid,isBreak=!0,list1+="<button class='zpl_intbtns zpl_attinticn zpl_attbrkBg'>",list1+='<i class="'+breakDetails.breakImage+'"></i>',list1+=breakDetails.breakName+"</button>",breakTimeInSecs=isPaidBreak?entries[i].paidBreakInSecs:entries[i].unPaidBreakInSecs>0?entries[i].unPaidBreakInSecs:0}else entries[i].permissionId?(list1+="<button class='zpl_intbtns zpl_attprmBg'>",list1+=permission.allPermissionList[entries[i].permissionId]+"</button>"):(list1+="<button class='zpl_intbtns zpl_attinticn zpl_attbrkBg' style='visibility: hidden;'>",list1+="<i class='PI_brk'></i>automatic</button>");if(list1+="<div class='dtdd'><span style='visibility: hidden;'>15 Mins</span></div>",breakTimeInSecs>0)list1+="<span>"+(breakTimeInSecs>=60?parseInt(breakTimeInSecs/60)+" "+ZPI18N.getString("zp.minutes"):breakTimeInSecs+" "+ZPI18N.getString("zp.secs"))+"</span>";else if(entries[i].individualPermission>0){var permissionMins=parseInt(entries[i].individualPermission/60);list1+="<span>"+Attendance.disHours(permissionMins)+" "+(permissionMins<=60?ZPI18N.getString("zp.leavetype.hour"):ZPI18N.getString("zp.hourslog"))+"</span>"}list1+="</div>"}else if(entries[i].breakId){list1+="<div class='zpl_attintdtls'>";breakDetails=Attendance.Entry.allDataList.breakList.breakObj[entries[i].breakId];if(isAutoBreak=entries[i].isAutomatic,isManualBreak=entries[i].isManualInput,isShiftApp=entries[i].isShiftApplicable,isPaidBreak=entries[i].isPaid,isBreak=!0,list1+="<button class='zpl_intbtns zpl_attinticn zpl_attbrkBg'>",list1+='<i class="'+breakDetails.breakImage+'"></i>',list1+=breakDetails.breakName+"</button>",list1+="<div class='dtdd'></div><span style='visibility: hidden;'>15 Mins</span>",(breakTimeInSecs=isPaidBreak?entries[i].paidBreakInSecs:entries[i].unPaidBreakInSecs>0?entries[i].unPaidBreakInSecs:0)>0)list1+="<span>"+(breakTimeInSecs>=60?parseInt(breakTimeInSecs/60)+" "+ZPI18N.getString("zp.minutes"):breakTimeInSecs+" "+ZPI18N.getString("zp.secs"))+"</span>";list1+="</div>"}if(list1+="<div class='zpl_attchkTm'>","-"!==entries[i].tdate.trim()&&(!isToday||1!=showAllEntries||"in"==Attendance.Entry.checkInOut)){var dateTime;if(-1!==entries[i].tdate.indexOf(ldate))list1+="<span class='red'>"+Attendance.disTimeOnly(entries[i].tdate);else list1+="<span class='red'>"+(dateTime=entries[i].tdate.split(" - "))[0]+" "+dateTime[1].trim();var toInpType=Attendance.Entry.getInputType(entries[i].inputType_out,!1);list1+="<i class='"+toInpType.className+"' data-toggle='tooltip' data-placement='right' title='"+toInpType.title+"'></i>",entries[i].attachId_out&&(list1+="<div class='zpl_attusrIcn rgt' onclick=Attendance.Entry.showAttachment(this,false) title='"+ZPI18N.getString("zp.attachment")+"'><i class='PI_user'></i></div>"),list1+="</span>";var cityName_Out="",geoLocName_out=entries[i].geoLocation_out,building_out=entries[i].building_out,foundGeoName_out=geoLocName_out&&""!==geoLocName_out&&"-"!==geoLocName_out;foundGeoName_out?cityName_Out=geoLocName_out:null!==Attendance.Entry.cityNamesList&&0!==Object.keys(Attendance.Entry.cityNamesList).length&&entries[i].punchout_userip&&Attendance.Entry.cityNamesList[entries[i].punchout_userip]&&"-"!==Attendance.Entry.cityNamesList[entries[i].punchout_userip]&&(cityName_Out=(cityName_Out=Attendance.Entry.cityNamesList[entries[i].punchout_userip]).charAt(0).toUpperCase()+cityName_Out.substr(1).toLowerCase());var latAndLon_out="",viewOutMapLink="";if(entries[i].latitude_out&&entries[i].longitude_out){if(latAndLon_out="latLon_out_"+i,!foundGeoName_out){var latLonOutObj={};latLonOutObj.lat=entries[i].latitude_out,latLonOutObj.lon=entries[i].longitude_out,latLonOutObj.id="latLon_out_"+i,latLongList.push(latLonOutObj)}viewOutMapLink="<a onclick=Attendance.Entry.mapContCons(this)>"+ZPI18N.getString("zp.viewmap")+"</a>"}if(""!==cityName_Out||""!==viewOutMapLink){list1+="<span id='"+latAndLon_out+"' class='zpl_attloctdtls'> <i class='PI_location'></i> "+cityName_Out;var addressTypeOut=entries[i].addressType_out,locDispInfoOut="",accuracyOut=entries[i].accuracy_out,useripOut=entries[i].punchout_userip,latOut=entries[i].latitude_out;if(useripOut||(useripOut=entries[i].punchin_userip),void 0!==accuracyOut){var accOut=parseInt(accuracyOut);accOut>1e3&&accOut<=3e3?locDispInfoOut=ZPI18N.getString("zp.lowaccuracyinfo",new Array(accOut+"")):accOut>3e3&&useripOut&&3==addressTypeOut&&(locDispInfoOut=ZPI18N.getString("zp.lowaccuracyandipaddrinfo",new Array(useripOut,accOut+"")))}else useripOut&&void 0===latOut&&3==addressTypeOut&&(locDispInfoOut=ZPI18N.getString("zp.ipaddrinfo",new Array(useripOut)));""!==locDispInfoOut&&(list1+=" <i class='PI_info tooltip-js' data-toggle='tooltip' data-placement='right'",list1+="title='"+locDispInfoOut+"'></i>"),list1+="</span>"+viewOutMapLink}""!==building_out&&void 0!==building_out&&(list1+="<span id='ZPAtt_Checkout_Building' class='zpl_attloctdtls'> <i class='PI_building'></i> "+building_out,list1+="</span>"),entries[i].desc_out&&(list1+="<span class='zpl_attloctdtls' id='ZPAtt_Checkout_Notes'>",list1+=$("<div/>").text(entries[i].desc_out).html(),list1+="</span>")}entries[i].desc_in||entries[i].desc_out||"",list1+="</div>";list1+="<div class='over-display zpl_hvr'>",Attendance.Entry.isTimeSheetAllowedForEntry||isFromReg||(isManualBreak=isManualBreak&&isShiftApp,!Attendance.Entry.editShowCheck||isBreak&&!isManualBreak?isBreak&&!isManualBreak||(list1+="<i class='PI_edt ' onclick=Attendance.Entry.entryNotesToggle(this);></i>"):list1+="<i class='PI_edt ' onclick=Attendance.Entry.showEntryEdit(this);></i>",(eShow||isManageAttendanceData&&!allData.hideDelete)&&0===showAllEntries&&(!isBreak||!isAutoBreak&&isManualBreak)&&(list1+="<i class='PI_delete' onclick=Attendance.Entry.toggleSingleEntryDelete(this);></i>")),list1+="</div></div>",entries[i].permissionId&&entries[i].desc_in&&(list1+="<div class='zpl_attSrcrw'>",list1+="<span class='w100'>"+ZPI18N.getString("zp.reason")+"</span>",list1+="<div class='zpl_attsrcRsn'>"+$("<div/>").text(entries[i].desc_in).html()+"</div></div>"),list1+="</div>",""===tmpList?tmpList=list1:tmpList+=list1}if(odEntries.length>0)for(i=0;i<odEntries.length;i++){list1="<div class='"+(attRowClass="zpl_attdtlsinrDv")+"'>";if(list1+="<div class='zpl_attSrcrw'>",list1+="<div class='zpl_attchkTm'>",odEntries[i].fdate&&(-1!==odEntries[i].fdate.indexOf(ldate)?list1+="<span>"+Attendance.disTimeOnly(odEntries[i].fdate)+"</span>":list1+="<span>"+odEntries[i].fdate+"</span>"),list1+="</div>",odEntries[i].fdate&&odEntries[i].tdate)list1+="<div class='zpl_attintdtls'>",list1+="<button class='zpl_intbtns zpl_attodBg'>",list1+="<span class='brk-typ'>"+ZSEC.Encoder.encodeForHTML(odEntries[i].type)+"</span></button>",list1+="<div class='dtdd'></div>",list1+="<span>"+(odEntries[i].totalHours>=60?odEntries[i].totalHours/60+ZPI18N.getString("zp.shours"):odEntries[i].totalHours+ZPI18N.getString("zp.minutes"))+"</span>",list1+="</div>";else if(void 0!==odEntries[i].daysTaken){var daysTaken=odEntries[i].daysTaken,encodedType=ZSEC.Encoder.encodeForHTML(odEntries[i].type);0==daysTaken?(list1+="<div class='zpl_attintdtls jst_cntr'>",list1+="<button class='zpl_intbtns zpl_attodBg'>",list1+=encodedType+"</button>",list1+="<div class='dtdd'></div>",list1+="<span>"+ZPI18N.getString("zp.fullday")+"</span>",list1+="</div>"):1==daysTaken?(list1+="<div class='zpl_attintdtls'>",list1+="<button class='zpl_intbtns zpl_attodBg'>",list1+=encodedType+"</button>",list1+="<div class='dtdd'></div>",list1+="<span>  0.5 "+ZPI18N.getString("zp.day")+" ("+(1==odEntries[i].session?ZPI18N.getString("zp.firsthalf"):ZPI18N.getString("zp.secondhalf"))+")</span>",list1+="</div>"):(list1+="<div class='zpl_attintdtls'>",list1+="<button class='zpl_intbtns zpl_attodBg'>",list1+=encodedType+"</button>",list1+="<div class='dtdd'></div>",list1+="<span>  0.25 "+ZPI18N.getString("zp.day")+" ("+(1==odEntries[i].session?ZPI18N.getString("zp.firstquarter"):2==odEntries[i].session?ZPI18N.getString("zp.secondquarter"):3==odEntries[i].session?ZPI18N.getString("zp.thirdquarter"):ZPI18N.getString("zp.fourthquarter"))+")</span>",list1+="</div>")}list1+="<div class='zpl_attchkTm'>",odEntries[i].tdate&&"-"!==odEntries[i].tdate.trim()&&(-1!==odEntries[i].tdate.indexOf(ldate)?list1+="<span>"+Attendance.disTimeOnly(odEntries[i].tdate)+"</span>":list1+="<span>"+odEntries[i].tdate+"</span>"),list1+="</div></div>",odEntries[i].odId&&odEntries[i].desc_in&&(list1+="<div class='zpl_attSrcrw'>",list1+="<span class='w100'>"+ZPI18N.getString("zp.reason")+"</span>",list1+="<div class='zpl_attsrcRsn'>"+ZPeople.escapeHtml(odEntries[i].desc_in)+"</div></div>"),list1+="</div>",""===tmpList?tmpList=list1:tmpList+=list1}if(entriesCont.append(tmpList+"</div></div>"),Attendance.Entry.editShowCheck&&!Attendance.Entry.isTimeSheetAllowedForEntry&&entriesCont.append("<div class='zpl_attAdentry'><div class='zpl_lnkbg' onclick=Attendance.Entry.showAddNewEntry(this);>"+ZPI18N.getString("zp.addentry")+"</div></div>"),dayList.approvalInfo&&-1===dayList.approvalInfo.status)entriesCont.parent().find("#absentpop1").hide(),entriesCont.parent().find("#text2").hide();else if(-1!==status.indexOf("Absent")){$(Attendance.Entry.LayoutId+" #ZP5Att_NoEntry").show();var absentDiv=$(Attendance.Entry.LayoutId+" #ZP5Att_NoEntryCnt"),absdayerr=ZPI18N.getString("zp.markedabsent");-1!==status.indexOf("0.5 day Absent")&&(absdayerr=ZPI18N.getString("zp.markedhalfabsent"));var txt="<h4 align='center'>"+absdayerr+"</h4>";!isLeaveTabActive||!isRegConfigured||!isadmin&&!isManageAttendanceData&&null!==Attendance.Entry.erecno||Attendance.Entry.allDataList.hideDelete&&null!==Attendance.Entry.erecno?!isLeaveTabActive||!isadmin&&!isManageAttendanceData&&null!==Attendance.Entry.erecno||Attendance.Entry.allDataList.hideDelete&&null!==Attendance.Entry.erecno?isRegConfigured&&(addRegForSub||isadmin||isManageAttendanceData||null===Attendance.Entry.erecno)&&(!Attendance.Entry.allDataList.hideDelete||null===Attendance.Entry.erecno||addRegForSub)&&(txt+="<div class='flexclmcap d-flexM'><div id='reg-bt' data-toggle='modal' class='zlabel zlabel--blue zlabel--outline zlabel--medium'> "+ZPI18N.getString("zp.regularize")+"</div></div>"):txt+="<div class='flexclmcap d-flexM'><div id='leave-bt' data-toggle='modal' class='zlabel zlabel--blue zlabel--outline zlabel--medium'>"+ZPI18N.getString("zp.apply.context.leave")+" "+ZPeople.Module.MODULE_DATA.attendance.formname+"</div></div>":(txt+="<div class='flexclmcap d-flexM'><div id='leave-bt' data-toggle='modal' class='zlabel zlabel--blue zlabel--outline zlabel--medium'>"+ZPI18N.getString("zp.apply.context.leave")+" "+ZPeople.Module.MODULE_DATA.attendance.formname+"</div><em>",txt+=ZPI18N.getString("zp.or")+"</em><div id='reg-bt' data-toggle='modal' class='zlabel zlabel--blue zlabel--outline zlabel--medium'> "+ZPI18N.getString("zp.regularize")+"</div></div>"),absentDiv.html(txt),absentDiv.find("#leave-bt").attr("onclick","Attendance.Entry.toLeave("+date[2]+","+(date[1]-1)+","+date[0]+")"),absentDiv.find("#reg-bt").attr("onclick","regularization_operation.constructRequestReg(this,"+date[2]+","+date[1]+","+date[0]+")")}}else{$(Attendance.Entry.LayoutId+" #ZP5Att_NoEntry").show();absentDiv=$(Attendance.Entry.LayoutId+" #ZP5Att_NoEntryCnt");var emptydiv='<div class="zpl_emptimg zp_nd_chkin_out"></div>';dayList.approvalInfo&&-1===dayList.approvalInfo.status?emptydiv+='<h4 align="center">'+ZPI18N.getString("zp.noattendanceentryfound")+"</h4>":-1!==status.indexOf("Absent")?(null!==Attendance.Entry.erecno?emptydiv+='<h4 align="center">'+ZPI18N.getString("zp.noattendanceentryfound")+"</h4>":emptydiv+='<h4 align="center">'+ZPI18N.getString("zp.markedabsent")+"</h4>",!isLeaveTabActive||!isRegConfigured||!isadmin&&!isManageAttendanceData&&null!==Attendance.Entry.erecno||Attendance.Entry.allDataList.hideDelete&&null!==Attendance.Entry.erecno?!isLeaveTabActive||!isadmin&&!isManageAttendanceData&&null!==Attendance.Entry.erecno||Attendance.Entry.allDataList.hideDelete&&null!==Attendance.Entry.erecno?isRegConfigured&&(addRegForSub||isadmin||isManageAttendanceData||null===Attendance.Entry.erecno)&&(!Attendance.Entry.allDataList.hideDelete||null===Attendance.Entry.erecno||addRegForSub)&&(emptydiv+="<div class='flexclmcap d-flexM'><div id='reg-bt' data-toggle='modal' class='zlabel zlabel--blue zlabel--outline zlabel--medium'> "+ZPI18N.getString("zp.regularize")+"</div></div>"):emptydiv+="<div class='flexclmcap d-flexM'><div id='leave-bt' data-toggle='modal' class='zlabel zlabel--blue zlabel--outline zlabel--medium'>"+ZPI18N.getString("zp.apply.context.leave")+" "+ZPeople.Module.MODULE_DATA.attendance.formname+"</div></div>":(emptydiv+="<div class='flexclmcap d-flexM'><div id='leave-bt' data-toggle='modal' class='zlabel zlabel--blue zlabel--outline zlabel--medium'>"+ZPI18N.getString("zp.apply.context.leave")+" "+ZPeople.Module.MODULE_DATA.attendance.formname+"</div><em>",emptydiv+=ZPI18N.getString("zp.or")+"</em><div id='reg-bt' data-toggle='modal' class='zlabel zlabel--blue zlabel--outline zlabel--medium'> "+ZPI18N.getString("zp.regularize")+"</div></div>")):emptydiv+='<h4 align="center">'+ZPI18N.getString("zp.noattendanceentryfound")+"</h4>",absentDiv.html(emptydiv),Attendance.Entry.editShowCheck&&!Attendance.Entry.isTimeSheetAllowedForEntry&&entriesCont.append("<div class='zpl_attAdentry'><div class='zpl_lnkbg' onclick=Attendance.Entry.showAddNewEntry(this);>"+ZPI18N.getString("zp.addentry")+"</div></div>"),absentDiv.find("#leave-bt").attr("onclick","Attendance.Entry.toLeave("+date[2]+","+(date[1]-1)+","+date[0]+")"),absentDiv.find("#reg-bt").attr("onclick","regularization_operation.constructRequestReg(this,"+date[2]+","+date[1]+","+date[0]+")")}var desc=allData.dayList[$(obj).index()].description;if(Attendance.Entry.setFInAndLOutinPopup(desc),dayList.approvalInfo&&-1===dayList.approvalInfo.status&&$(Attendance.Entry.LayoutId+" #ZPAtt_entry_RegData").show(),0!==latLongList.length){var param={mode:"getCityNameByLatLong",conreqcsr:csrfToken,latLongList:JSON.stringify(latLongList)};$.post("/AttendanceAction.zp",param,function(rdata){if(rdata.cityNames){var addr=rdata.cityNames;for(var i in addr)$(Attendance.Entry.LayoutId+" #ZPAtt_allEntries_popup").find("#"+i).html("<i class='PI_location'></i>"+text(addr[i]))}})}}},dispLocationInfo:function(locDispInfo){return'<span class="P5 W250 S12 DB">'+locDispInfo+"</span>"},showAttachment:function(obj,isCheckin){var entryIndex=$(obj).closest(".zpl_attdtlsinrDv").index(),attDate=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].attDate,currEntryData=Attendance.Entry.allDataList.entries[attDate][entryIndex],attachId=currEntryData.attachId_out,time=Attendance.disTimeOnly(currEntryData.tdate),location=currEntryData.geoLocation_out;isCheckin&&(attachId=currEntryData.attachId_in,time=Attendance.disTimeOnly(currEntryData.fdate),location=currEntryData.geoLocation_in);var clr=isCheckin?"grn":"red",path="mode=viewImage&attachmentId="+attachId;path+="&isCheckin="+isCheckin,path+="&date="+attDate,null!==Attendance.Entry.erecno&&(path+="&erecno="+Attendance.Entry.erecno),path=encodeURI(path);var popup="<div class='zpl_mdl zpl_mcenter zpl_fcrecg zpl_mopen zpl_fcrecvw'  id='ZPAtt_viewAttachPopup' aria-hidden='false' data-modal-box='fcrechkn'>";popup+="<div class='zpl_minr'><div class='zpl_mhder'><div class='d-flex'>",location&&(popup+="<span class='DB w200 zpl_ellipsis'><i class='PI_location' title='"+location+"'></i> "+location+"</span>"),time&&(popup+="<span><i class='PI_clock'></i><em class='"+clr+"'> "+time+"</em></span></div>"),popup+="<a class='_cls PI_cls '></a></div>";var pName="";portalName&&(pName="/"+portalName),popup+="<div class='zpl_mcnt zpl_fm'><form><div class='zpl_crd'>",popup+="<div class='zpl_crdcnt'><img src='"+pName+"/AttendanceViewAction.zp?"+path+"'></div></div></form></div></div></div>",$("body").find("#ZPAtt_viewAttachPopup")[0]||$("body").append(popup),$("#ZPAtt_viewAttachPopup .zpl_crdcnt").append(ZPeople.LOADING_HTML),$("#ZPAtt_viewAttachPopup .zpl_crdcnt").find("#zp_page_loading").css("margin-top","150px"),$("#ZPAtt_viewAttachPopup").find("._cls.PI_cls ").on("click",function(){$("#ZPAtt_viewAttachPopup").remove()}),$("#ZPAtt_viewAttachPopup img").on("load",function(){$("#ZPAtt_viewAttachPopup .zpl_crdcnt").find("#zp_page_loading").remove()})},mapContCons:function(obj){var dayList=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex],currEntryData=Attendance.Entry.allDataList.entries[dayList.attDate][$(obj).parent().parent().parent().index()],lat=(ZPI18N.getString("zp.checkout"),Attendance.disTimeOnly(currEntryData.tdate),currEntryData.latitude_out),lon=currEntryData.longitude_out;0===$(obj).parent().index()&&(ZPI18N.getString("zp.checkin"),Attendance.disTimeOnly(currEntryData.fdate),!0,lat=currEntryData.latitude_in,lon=currEntryData.longitude_in),window.open("https://maps.google.com/?q="+lat+","+lon,"_blank")},toggleSingleEntryDelete:function(obj,isCancel){if(isCancel){var list="<div class='over-display";Attendance.Entry.breakImageHiddenDiv?list+=" shwBrk'>"+Attendance.Entry.breakImageHiddenDiv+Attendance.Entry.breakNameHiddenDiv:list+="'>";var delShow=isSPOCEntryEdit&&(Attendance.Entry.erecno&&isSPOCEntryEdit.includes(Attendance.Entry.erecno)||!Attendance.Entry.erecno&&isSPOCEntryEdit.includes(erecno));Attendance.Entry.editShowCheck?list+="<i class='PI_edt' onclick=Attendance.Entry.showEntryEdit(this);></i>":list+="<i class='PI_edt' onclick=Attendance.Entry.entryNotesToggle(this);></i>",(delShow||isManageAttendanceData)&&0===Attendance.Entry.allDataList.showAllEntries&&(list+="<i class='PI_delete' onclick=Attendance.Entry.toggleSingleEntryDelete(this);></i>"),list+="</div></div>",$(obj).parent().replaceWith(list).hide().fadeIn(300)}else{var list1="<div class='over-display'>";list1+="<button class='zlabel zlabel--blue zlabel--small' type='button'onclick=Attendance.Entry.deleteSingleEntry(this);>"+ZPI18N.getString("zp.confirm")+"</button>",list1+="<button class='zlabel zlabel--outline zlabel--small' type='button' onclick=Attendance.Entry.toggleSingleEntryDelete(this,true);>"+ZPI18N.getString("zp.cancel")+"</button>",list1+="</div>",delete Attendance.Entry.breakImageHiddenDiv,delete Attendance.Entry.breakNameHiddenDiv,$(obj).parent().hasClass("shwBrk")&&(Attendance.Entry.breakImageHiddenDiv=$(obj).parent().children().eq(0)[0].outerHTML,Attendance.Entry.breakNameHiddenDiv=$(obj).parent().children().eq(1)[0].outerHTML),$(obj).parent().hide(),$(obj).parent().replaceWith(list1).hide().fadeIn(300)}},isAppStatusVisible:null,setFInAndLOutinPopup:function(desc){var layout=Layout.Page.container,dayList=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex];if(ZPeopleComponents.isComponent($("#roundOffOutPopover"))&&(layout.find("#roundedoffOUT").hide(),ZPeopleComponents.popover($("#roundOffOutPopover")).destroy()),ZPeopleComponents.isComponent($("#roundOffInPopover"))&&(layout.find("#roundedoffIN").hide(),ZPeopleComponents.popover($("#roundOffInPopover")).destroy()),dayList.ldate&&(Attendance.Entry.entryPopUpAttDate=dayList.ldate),layout.find("#ZPAtt_firstCheckinInPopup,#ZPAtt_lastCheckoutInPopup").text("-"),dayList.filo&&dayList.filo.ftime){var fromTime=dayList.filo.ftime;fromTime=fromTime.replace(":"," : "),layout.find("#ZPAtt_firstCheckinInPopup").text(fromTime);var actIn=dayList.filo.actual_firstIn;if(actIn){actIn=actIn.substr(actIn.indexOf(" ")+1);var roundOffInPopover='<div id="roundOffInPopover" data-type="popover" style="display: none;">';roundOffInPopover+='<div class="zpl_popoverinr"><table class="zpl_itbl M0I mw180"><tbody><tr><td>'+ZPI18N.getString("zp.recorded")+"</td><td>"+actIn+"</td></tr><tr><td>"+ZPI18N.getString("zp.roundedoff")+"</td><td>"+fromTime.replace(" : ",":")+"</td></tr></tbody></table></div>",layout.find("#roundedoffIN").show(),layout.find("#roundedoffIN").append(roundOffInPopover),ZPeopleComponents.popover(layout.find("#roundOffInPopover"),{displayType:"callout",closeOnBodyClick:!0,position:"top",forElement:layout.find("#roundedoffIN"),className:"zpl_popovr"})}}if(dayList.filo&&dayList.filo.ttime&&(!dayList.isToday||!Attendance.Entry.hasOpenCheckin)){var toTime=dayList.filo.ttime;toTime=toTime.replace(":"," : "),layout.find("#ZPAtt_lastCheckoutInPopup").text(toTime);var actOut=dayList.filo.actual_lastOut;if(actOut){actOut=actOut.substr(actOut.indexOf(" ")+1);var roundOffOutPopover='<div id="roundOffOutPopover" data-type="popover" style="display: none;">';roundOffOutPopover+='<div class="zpl_popoverinr"><table class="zpl_itbl M0I mw180"><tbody><tr><td>'+ZPI18N.getString("zp.recorded")+"</td><td>"+actOut+"</td></tr><tr><td>"+ZPI18N.getString("zp.roundedoff")+"</td><td>"+toTime.replace(" : ",":")+"</td></tr></tbody></table></div>",layout.find("#roundedoffOUT").show(),layout.find("#roundedoffOUT").append(roundOffOutPopover),ZPeopleComponents.popover(layout.find("#roundOffOutPopover"),{displayType:"callout",closeOnBodyClick:!0,position:"top",forElement:layout.find("#roundedoffOUT"),className:"zpl_popovr"})}}$("#roundedoffOUT,#roundedoffIN").is(":visible")?layout.find("#listViewPopupFooter").addClass("zpl_rndofadd"):layout.find("#listViewPopupFooter").removeClass("zpl_rndofadd"),layout.find("#ZPAtt_totalHoursInPopup").text(Attendance.disHours(dayList.tsecs/60)+" "+ZPI18N.getString("zp.hrs")),Layout.Page.container.find("[id='ZPAtt_PaidBreakInPopup']").hide(),Attendance.Entry.allDataList.breakList.activeBreakCount>0&&(Layout.Page.container.find("[id='ZPAtt_PaidBreakInPopup']").show(),Layout.Page.container.find("[id='ZPAtt_totalBreakHoursInPopup']").text(dayList.totalPaidBreakHours+" "+ZPI18N.getString("zp.hrs"))),layout.find("#ZPAtt_entry_appStatus").parent().hide(),Attendance.Entry.isAppStatusVisible=!1,ZPeopleComponents.isComponent($("#attRegPopOver"))&&ZPeopleComponents.popover($("#attRegPopOver")).destroy(),layout.find("#attRegPopOver").remove();var regdescPopover='<div id="attRegPopOver" data-type="popover" style="display: none;">';if(regdescPopover+='<div class="zpl_popoverinr"> <div class="text-right"> <i class="_cls PI_cls red CP" onclick="Attendance.Entry.toggleRegEntries();"></i></div>',regdescPopover+='<div class="zpl_tblres">',regdescPopover+='<table class="zpl_itbl zpl_tblbdr"><thead><tr><th class="w150"></th><th class="w200">'+ZPI18N.getString("zp.checkin")+'</th><th class="w200">'+ZPI18N.getString("zp.checkout")+'</th><th class="w100">'+ZPI18N.getString("zp.totalhours")+"</th><th>"+ZPI18N.getString("zp.status")+"</th></tr></thead>",dayList.approvalInfo){Attendance.Entry.isAppStatusVisible=!0,layout.find("#ZPAtt_entry_appStatus").parent().show(),layout.find("#listViewPopupFooter").addClass("zpl_attreglz");var cont=Layout.Page.container.find("#ZPAtt_entry_appStatus i").eq(0),appInfo=dayList.approvalInfo;1===appInfo.status?(cont.attr("class","PI_like grn"),cont.parent().attr("title",ZPI18N.getString("zp.approved"))):0===appInfo.status?(cont.attr("class","PI_unlike red"),cont.parent().attr("title",ZPI18N.getString("zp.rejected"))):-4===appInfo.status?(cont.attr("class","PI_cancel_pending"),cont.parent().attr("title",ZPI18N.getString("zp.cancelpending"))):-2===appInfo.status?(cont.attr("class","PI_like org"),cont.parent().attr("title",ZPI18N.getString("zp.submitted"))):(cont.attr("class","PI_pending3"),cont.parent().attr("title",ZPI18N.getString("zp.waitingmsg"))),regdescPopover+='<tbody class="zpl_f12">',regdescPopover+="<tr>",regdescPopover+="<td><span>"+ZPI18N.getString("zp.existingdata")+"</span></td>",regdescPopover+="<td><span>"+(appInfo.intime?appInfo.intime:"-")+"</span></td>",regdescPopover+="<td><span>"+(appInfo.outtime?appInfo.outtime:"-")+"</span></td>",regdescPopover+="<td><span>"+Attendance.disHours(appInfo.totalHours/60)+"</span></td>",regdescPopover+="<td><span>"+Attendance.Reg.statI18nInReg(appInfo.att_status)+"</span></td>",regdescPopover+="</tr>",regdescPopover+="<tr>",regdescPopover+="<td><span>"+ZPI18N.getString("zp.modifieddata")+"</span></td>",regdescPopover+="<td><span>"+appInfo.new_intime+"</span></td>",regdescPopover+="<td><span>"+appInfo.new_outtime+"</span></td>",regdescPopover+="<td><span>"+Attendance.disHours(appInfo.new_totalHours/60)+"</span></td>",regdescPopover+="<td><span>"+Attendance.Reg.statI18nInReg(appInfo.new_status)+"</span></td>",regdescPopover+="</tr>",void 0!==desc&&""!==desc&&(regdescPopover+="<tr>",regdescPopover+="<td><span>"+ZPI18N.getString("zp.description")+"</span></td>",regdescPopover+='<td colspan="3"><span>'+desc+"</span></td>",regdescPopover+="</tr>"),regdescPopover+="</tbody>",regdescPopover+="</table>",regdescPopover+="</div>",regdescPopover+="</div>",regdescPopover+="</div>",layout.find("#ZPAtt_allEntries_popup_minr").append(regdescPopover),ZPeopleComponents.popover(layout.find("#attRegPopOver"),{displayType:"callout",closeOnBodyClick:!0,forElement:layout.find("#ZPAtt_allEntries_popup_minr").find("#ZPAtt_entry_appStatus"),className:"zpl_popovr"})}else layout.find("#listViewPopupFooter").removeClass("zpl_attreglz")},toggleRegEntries:function(){$(Attendance.Entry.LayoutId+" #attRegPopOver").is(":visible")?ZPeopleComponents.popover("#attRegPopOver").close():ZPeopleComponents.popover("#attRegPopOver").open()},toggleEntryRoudOffPopOver:function(inTime){inTime?$(Attendance.Entry.LayoutId+" #roundOffInPopover").is(":visible")?ZPeopleComponents.popover("#roundOffInPopover").close():ZPeopleComponents.popover("#roundOffInPopover").open():$(Attendance.Entry.LayoutId+" #roundOffOutPopover").is(":visible")?ZPeopleComponents.popover("#roundOffOutPopover").close():ZPeopleComponents.popover("#roundOffOutPopover").open()},appendAttEditHtml:function(isFrom,date,index){var dateValue="",html="";return date&&""!==date&&(dateValue=date.split(" ")[1],Attendance.timeFormatIs12hr&&(dateValue=date.split(" ")[1]+" "+date.split(" ")[2])),isFrom?(html='<div class="zpl_attdataentry d-flexclmcap"><div>',index?(html+='<input class="ztextbox" placeholder="'+ZPI18N.getString("zp.local.FromTime")+'" id="ZPAtt_entry_editFromTime_'+index+'" type="text" value="'+dateValue+'">',html+='<div class="drp_dwn"><span class="select-js" id="ZPAtt_entry_editFromDate_'+index+'" style="display: none;"></span></div></div>'):(html+='<input class="ztextbox" placeholder="'+ZPI18N.getString("zp.local.FromTime")+'" id="ZPAtt_entry_editFromTime" class="ztextbox" type="text" value="'+dateValue+'">',html+='<div class="drp_dwn"><span class="select-js" id="ZPAtt_entry_editFromDate" style="display: none;"></span></div></div>'),html+='<textarea rows="3" class="ztextbox" placeholder="'+ZPI18N.getString("zp.addnotesforcheckin")+'"></textarea></div>'):(html='<div class="zpl_attdataentry d-flexclmcap"><div>',index?(html+='<input class="ztextbox" placeholder="'+ZPI18N.getString("zp.local.ToTime")+'" id="ZPAtt_entry_editToTime_'+index+'" class="ztextbox" type="text" value="'+dateValue+'">',html+='<div class="drp_dwn"> <span class ="select-js" id="ZPAtt_entry_editToDate_'+index+'" style="display: none;"></span></div></div>'):(html+='<input class="ztextbox" placeholder="'+ZPI18N.getString("zp.local.ToTime")+'" id="ZPAtt_entry_editToTime" class="ztextbox" type="text" value="'+dateValue+'">',html+='<div class="drp_dwn"> <span class ="select-js" id="ZPAtt_entry_editToDate" style="display: none;"></span></div></div>'),html+='<textarea rows="3" class="ztextbox" placeholder="'+ZPI18N.getString("zp.addnotesforcheckout")+'"></textarea></div>'),html},compareDates:function(date1,date2){return date1.getTime()===new Date(date2.add(-1,"days")._d).getTime()?"-1":date1.getTime()===new Date(date2.add(2,"days")._d).getTime()?"1":"0"},showEntryEdit:function(obj,isClose){var entryIndex=isClose?$(obj).parent().parent().index():$(obj).parent().parent().parent().index(),attDate=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].attDate,ldate=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].ldate,currEntryData=Attendance.Entry.allDataList.entries[attDate][entryIndex],from_Date=new Date(moment(currEntryData.fdate,Attendance.Entry.allDataList.currDate.dateFormat.toUpperCase())._d),to_Date=new Date(moment(currEntryData.tdate,Attendance.Entry.allDataList.currDate.dateFormat.toUpperCase())._d);if(currEntryData){var fdate="",tdate="";if(currEntryData.fdate&&""!==currEntryData.fdate&&"-"!==currEntryData.fdate.trim()&&(fdate=Attendance.disTimeOnly(currEntryData.fdate),isClose&&-1!==currEntryData.fdate.indexOf(ldate)||(fdate=currEntryData.fdate)),currEntryData.tdate&&""!==currEntryData.tdate&&"-"!==currEntryData.tdate.trim()&&(tdate=Attendance.disTimeOnly(currEntryData.tdate),isClose&&-1!==currEntryData.tdate.indexOf(ldate)||(tdate=currEntryData.tdate)),isClose)if(Attendance.Entry.removeFromToAttEntryEditDate(!0,entryIndex),Attendance.Entry.removeFromToAttEntryEditDate(!1,entryIndex),Attendance.Entry.removeFromToAttEntryEditTime(!0,entryIndex),Attendance.Entry.removeFromToAttEntryEditTime(!1,entryIndex),Attendance.Entry.editShowCheck){var object=$(obj).parent().prev();object.prev().show(),object.next().next().show(),object.prev().find(".over-display").show(),object.next().remove(),object.remove()}else $(obj).parent().prev().prev().find(".over-display").show(),$(obj).parent().prev().remove(),currEntryData.permissionId&&$(obj).parent().next().show(),$(obj).parent().remove();else{var newCons="<div class='zpl_attetryDv'>";if(newCons+="<div class='zpl_attetryrw'>",""!==fdate){var fromDate=fdate.slice(0,11);"-"===fromDate[fromDate.length-1]&&(fromDate=fromDate.slice(0,10)),fdate=fromDate.trim()+" "+Attendance.disTimeOnly(fdate)}if(""!==tdate){var toDate=tdate.slice(0,11);"-"===toDate[toDate.length-1]&&(toDate=toDate.slice(0,10)),tdate=toDate.trim()+" "+Attendance.disTimeOnly(tdate)}newCons+=Attendance.Entry.appendAttEditHtml(!0,fdate,entryIndex),newCons+=Attendance.Entry.appendAttEditHtml(!1,tdate,entryIndex),newCons+="</div></div>",newCons+="<div class='text-center' id='ZPAtt_SaveCancelNotes'>",newCons+="<button class='zlabel zlabel--blue zlabel--small' type='button' onclick='Attendance.Entry.updateEntry(this)'>"+ZPI18N.getString("zp.save")+"</button>",newCons+="<button class='zlabel zlabel--outline zlabel--small' type='button' onclick='Attendance.Entry.entryNotesToggle(this,true)'>"+ZPI18N.getString("zp.cancel")+"</button>",newCons+="</div>",$(newCons).insertAfter($(obj).parent().parent());from_Date=new Date(moment(currEntryData.fdate,Attendance.Entry.allDataList.currDate.dateFormat.toUpperCase())._d),to_Date=new Date(moment(currEntryData.tdate,Attendance.Entry.allDataList.currDate.dateFormat.toUpperCase())._d);Attendance.Entry.listDaysOnAttEdit(!0,entryIndex,attDate,from_Date),Attendance.Entry.listDaysOnAttEdit(!1,entryIndex,attDate,to_Date),Attendance.Entry.constructTimer(!0,entryIndex,currEntryData&&currEntryData.fdate?Attendance.disTimeOnly(currEntryData.fdate):void 0),Attendance.Entry.constructTimer(!1,entryIndex,currEntryData&&currEntryData.tdate?Attendance.disTimeOnly(currEntryData.tdate):void 0),Attendance.Entry.oldFromDate=Attendance.Entry.compareDates(from_Date,moment(attDate,"YYYY-MM-DD")),Attendance.Entry.oldToDate=Attendance.Entry.compareDates(to_Date,moment(attDate,"YYYY-MM-DD")),$(obj).parent().parent().parent().children(":eq(0)").hide(),$(obj).parent().parent().parent().children(":eq(3)").hide(),Attendance.Entry.entryNotesToggle(obj)}}},removeFromToAttEntryEditDate:function(isFrom,index){0==index&&(index=void 0);var page=Layout.Page.container.find("#ZPAtt_entry_allEntriesList"),id=(isFrom?"#ZPAtt_entry_editFromDate":"#ZPAtt_entry_editToDate")+(index?"_"+index:"");0!=page.find(id).length&&ZPeopleComponents.select(page.find(id),{removeExistingDropdown:!0}).destroy()},removeFromToAttEntryEditTime:function(isFrom,index){0==index&&(index=void 0);var page=Layout.Page.container.find("#ZPAtt_entry_allEntriesList"),id=(isFrom?"#ZPAtt_entry_editFromTime":"#ZPAtt_entry_editToTime")+(index?"_"+index:"");0!=page.find(id).length&&ZPeopleComponents.select(page.find(id),{removeExistingDropdown:!0}).destroy()},validateDate:function(fromTime,toTime,fromDate,toDate,selectedDate){var from=new Date(moment(selectedDate,"YYYY-MM-DD").add(fromDate,"days").set({hour:parseInt(fromTime.split(":")[0],10),minute:parseInt(fromTime.split(":")[1],10)})._d);"PM"===fromTime.split(" ")[1]&&12!==parseInt(fromTime.split(":")[0],10)?from=new Date(moment(selectedDate,"YYYY-MM-DD").add(fromDate,"days").set({hour:12+parseInt(fromTime.split(":")[0],10),minute:parseInt(fromTime.split(":")[1],10)})._d):"AM"===fromTime.split(" ")[1]&&12===parseInt(fromTime.split(":")[0])&&(from=new Date(moment(selectedDate,"YYYY-MM-DD").add(fromDate,"days").set({hour:0,minute:parseInt(fromTime.split(":")[1],10)})._d));var to=new Date(moment(selectedDate,"YYYY-MM-DD").add(toDate,"days").set({hour:parseInt(toTime.split(":")[0],10),minute:parseInt(toTime.split(":")[1],10)})._d);return"PM"===toTime.split(" ")[1]&&12!==parseInt(toTime.split(":")[0],10)?to=new Date(moment(selectedDate,"YYYY-MM-DD").add(toDate,"days").set({hour:12+parseInt(toTime.split(":")[0],10),minute:parseInt(toTime.split(":")[1],10)})._d):"AM"===toTime.split(" ")[1]&&12===parseInt(toTime.split(":")[0])&&(to=new Date(moment(selectedDate,"YYYY-MM-DD").add(toDate,"days").set({hour:0,minute:parseInt(toTime.split(":")[1],10)})._d)),!(from.getTime()>to.getTime())},updateEntry:function(obj){var entryIndex=varNameIndex=$(obj).parent().parent().index();0==varNameIndex&&(varNameIndex=void 0),Attendance.Entry.reloadFromWMS=!1;var fromTimeId=varNameIndex?"#ZPAtt_entry_editFromTime_"+varNameIndex:"#ZPAtt_entry_editFromTime",toTimeId=varNameIndex?"#ZPAtt_entry_editToTime_"+varNameIndex:"#ZPAtt_entry_editToTime",fromDateId=varNameIndex?"#ZPAtt_entry_editFromDate_"+varNameIndex:"#ZPAtt_entry_editFromDate",toDateId=varNameIndex?"#ZPAtt_entry_editToDate_"+varNameIndex:"#ZPAtt_entry_editToDate",fromEntry=ZPeopleComponents.timefield($(Attendance.Entry.LayoutId).find(fromTimeId)).getValue().dateString,toEntry=ZPeopleComponents.timefield($(Attendance.Entry.LayoutId).find(toTimeId)).getValue().dateString,fromTime=fromEntry,toTime=toEntry,breakId=$($(obj).parents(".zpl_attdtlsinrDv")).attr("breakId"),param={mode:"updateAttenEntry",conreqcsr:csrfToken};if(void 0==breakId||(param.breakId=breakId,void 0!=fromTime&&void 0!=toTime&&""!=fromTime&&""!=toTime)){var attDate=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].attDate,currEntryData=Attendance.Entry.allDataList.entries[attDate][entryIndex];if(fromTime&&toTime&&!Attendance.Entry.validateDate(fromEntry,toEntry,ZPeopleComponents.select($(Attendance.Entry.LayoutId).find(fromDateId)).getValue(),ZPeopleComponents.select($(Attendance.Entry.LayoutId).find(toDateId)).getValue(),attDate))ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.fromtimegreater"));else{currEntryData&&!currEntryData.processRowEntry&&(1===Attendance.Entry.allDataList.showAllEntries?param.editProRow=!0:currEntryData.attenId&&0===Attendance.Entry.allDataList.showAllEntries&&(param.attenid=currEntryData.attenId));var isFromTimeModified=!0,isToTimeModified=!0;if(currEntryData&&currEntryData.fdate&&fromTime){isFromTimeModified=fromTime.split(":")[0]+":"+fromTime.split(":")[1]!==currEntryData.fdate.split(" ")[2];Attendance.timeFormatIs12hr&&(isFromTimeModified=fromTime.split(":")[0]+":"+fromTime.split(":")[1]!=currEntryData.fdate.split(" ")[2]+" "+currEntryData.fdate.split(" ")[3])}if(currEntryData&&currEntryData.tdate&&toTime){isToTimeModified=toTime.split(":")[0]+":"+toTime.split(":")[1]!==currEntryData.tdate.split(" ")[2];Attendance.timeFormatIs12hr&&(isToTimeModified=toTime.split(":")[0]+":"+toTime.split(":")[1]!=currEntryData.tdate.split(" ")[2]+" "+currEntryData.tdate.split(" ")[3])}if(fromTime&&(isFromTimeModified||Attendance.Entry.oldFromDate!==ZPeopleComponents.select($(Attendance.Entry.LayoutId).find(fromDateId)).getValue())){var stime_hr=parseInt(fromTime.split(":")[0],10);Attendance.timeFormatIs12hr&&12===stime_hr&&(stime_hr=0);var stime=60*stime_hr+parseInt(fromTime.split(":")[1],10);Attendance.timeFormatIs12hr&&"PM"===fromEntry.split(" ")[1].trim()&&(stime+=720),param.ftime=stime,param.fdate=ZPeopleComponents.select($(Attendance.Entry.LayoutId).find(fromDateId)).getValue()}if(toTime&&(isToTimeModified||Attendance.Entry.oldToDate!==ZPeopleComponents.select($(Attendance.Entry.LayoutId).find(toDateId)).getValue())){var ttime_hr=parseInt(toTime.split(":")[0],10);Attendance.timeFormatIs12hr&&12===ttime_hr&&(ttime_hr=0);var ttime=60*ttime_hr+parseInt(toTime.split(":")[1],10);Attendance.timeFormatIs12hr&&"PM"===toEntry.split(" ")[1].trim()&&(ttime+=720),param.ttime=ttime,param.tdate=ZPeopleComponents.select($(Attendance.Entry.LayoutId).find(toDateId)).getValue()}!currEntryData||"-"===currEntryData.fdate||fromTime||currEntryData.processRowEntry||(param.ftime="valuedeleted"),!currEntryData||"-"===currEntryData.tdate||toTime||currEntryData.processRowEntry||(param.ttime="valuedeleted");var dayList=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex];dayList.ldate&&(param.orgDate=dayList.ldate),Attendance.Entry.erecno&&(param.erecno=Attendance.Entry.erecno),Attendance.Entry.saveNotes(obj,param),!param.ftime&&!param.ttime&&0!==param.ttime&&0!==param.ftime||param.desc_in&&""===fromEntry||param.desc_out&&""===toEntry?Attendance.Entry.descin===param.desc_in&&Attendance.Entry.descout===param.desc_out||Attendance.Entry.saveNotes(obj):Object.keys(param).length<5||($(obj).attr("disabled",!0),$.post("/AttendanceAction.zp",param,function(rdata){if(null!==rdata&&rdata.error)"not allowed"===rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.notallowedtoedit")):"already deleted"===rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.alreadydeleted")):"invalid entry"===rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.fromtimegreater")):"not allowed for this day"===rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.notallowedthisday")):"totalHrsExceeded"===rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.totalhrsreached")):"Given entry overlaps with existing attendance entries. Add a valid entry."===rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.matchingwithavail")):"Provided break time is outside configured break range"===rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.matchingwithavail")):"nullbrkentryfromto"===rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.nullbrkentryfromto")):"permissions limit exceeded"===rdata.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.allowedpermissionexceeded")):"permissions both time required"===rdata.error&&ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.bothtimerequiredforpermission")),$(obj).prop("disabled",!1);else if(null!==rdata&&rdata.errorType)1===rdata.errorType?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.brkDisabledDeleted")):2===rdata.errorType?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.shiftnotapp")):3===rdata.errorType?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.autoerror")):4===rdata.errorType?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.manualautoerror")):5===rdata.errorType?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.breaknotinrange")):6===rdata.errorType?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.entryduplicate")):7===rdata.errorType?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.breakcompleted")):8===rdata.errorType&&ModuleComp.Msg.showFailureMsg(rdata.errorMessage?rdata.errorMessage:ZPI18N.getString("zp.breaknotinshiftcoreRange")),$(obj).prop("disabled",!1);else if(null!==rdata){if(rdata.curDayBreakDetails&&(Attendance.Entry.curDayBreakDetails=rdata.curDayBreakDetails),Attendance.Entry.isPrevExtended&&$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").is(":visible"))return Attendance.Entry.isPrevExtended=null,void $(Attendance.Entry.LayoutId+" #ZPAtt_weekViewBut").parent().find(".btn-primary").trigger("click");Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex]=rdata.daylist[0],Attendance.Entry.getCurrDayEntry(Attendance.Entry.selectedRowIndex,!0),Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].isToday&&Attendance.Dashboard&&Attendance.Dashboard.WeeklyData.getCurWeekData()}}))}}else ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.nullbrkentryfromto"))},deleteSingleEntry:function(obj){Attendance.Entry.reloadFromWMS=!1;var attDate=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].attDate,currEntryData=Attendance.Entry.allDataList.entries[attDate][$(obj).parent().parent().parent().index()];$(obj).attr("disabled",!0);var param={mode:"delAttenEntry",conreqcsr:csrfToken,attDate:Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].ldate};currEntryData&&currEntryData.attenId&&0===Attendance.Entry.allDataList.showAllEntries&&(param.attId=currEntryData.attenId),null!==Attendance.Entry.erecno&&(param.erecno=Attendance.Entry.erecno),$.post("/AttendanceAction.zp",param,function(rdata){rdata.curDayBreakDetails&&(Attendance.Entry.curDayBreakDetails=rdata.curDayBreakDetails),Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex]=rdata.dayList[0],Attendance.Entry.getCurrDayEntry(Attendance.Entry.selectedRowIndex),$(obj).parent().parent().parent().fadeOut("fast",function(){$(obj).parent().parent().parent().remove()}),Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].isToday&&Attendance.Dashboard&&Attendance.Dashboard.WeeklyData.getCurWeekData()})},showAddNewEntry:function(obj){$(Attendance.Entry.LayoutId+" #ZPAtt_entry_allEntriesList").parent().find("div.ZPcolhead").fadeIn(300),$(Attendance.Entry.LayoutId+" #ZPAtt_attEntry_emptyRecInfo").hide();var alreadyVisibleInput=$(obj).parent().closest("div.zpl_mcnt").find("div.zpl_attdtlsinr").find("textarea")[0];if(alreadyVisibleInput){if($(alreadyVisibleInput).closest(".zpl_attdtlsinrDv").is(":visible"))return;$(alreadyVisibleInput).parent().parent().children().last().children(":eq(0)").trigger("click")}var eleIndex=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_allEntriesList .zpl_attdtlsinrDv").length;0===eleIndex&&(eleIndex="");var newCons="<div class='zpl_attdtlsinrDv'>";newCons+="<div class='zpl_attetryDv' id='attEntryEditAddDiv'>",newCons+="<div class='zpl_attetryrw'>",newCons+=Attendance.Entry.appendAttEditHtml(!0,"",eleIndex),newCons+=Attendance.Entry.appendAttEditHtml(!1,"",eleIndex),newCons+="</div>",newCons+="</div><div class='text-center '>",newCons+="<button class='zlabel zlabel--blue zlabel--small' type='button' onclick='Attendance.Entry.updateEntry(this,true)'>"+ZPI18N.getString("zp.save")+"</button>",newCons+="<button class='zlabel zlabel--outline zlabel--small' type='button' onclick='Attendance.Entry.entryNotesToggle(this,true)'>"+ZPI18N.getString("zp.cancel")+"</button>",newCons+="</div></div></div></div>",$(Attendance.Entry.LayoutId+" #ZPAtt_entry_allEntriesList").find("div.zpl_attAdentry").before(newCons),Attendance.Entry.removeFromToAttEntryEditDate(!0,eleIndex),Attendance.Entry.removeFromToAttEntryEditDate(!1,eleIndex),Attendance.Entry.removeFromToAttEntryEditTime(!0,eleIndex),Attendance.Entry.removeFromToAttEntryEditTime(!1,eleIndex),Attendance.Entry.constructTimer(!0,eleIndex),Attendance.Entry.constructTimer(!1,eleIndex),Attendance.Entry.listDaysOnAttEdit(!0,eleIndex),Attendance.Entry.listDaysOnAttEdit(!1,eleIndex)},saveNotes:function(obj,param){Attendance.Entry.reloadFromWMS=!1;var fromNotes=$(obj).parent().prev().children().children(":eq(0)").find("textarea")[0],toNotes=$(obj).parent().prev().children().children(":eq(1)").find("textarea")[0],entryIndex=$(obj).parent().parent().index();Attendance.Entry.editShowCheck||(fromNotes=$(obj).parent().prev().children().find("textarea")[0],toNotes=$(obj).parent().prev().children().find("textarea")[1]);var attDate=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].attDate,currEntryData=Attendance.Entry.allDataList.entries[attDate][entryIndex];if(currEntryData||param){var fromEntryedit=!0;param||(fromEntryedit=!1,param={mode:"updateNoteForEveryEntry",conreqcsr:csrfToken});var fromNotesVal=fromNotes&&fromNotes.value?fromNotes.value.trim():"",prevFromNote="";currEntryData&&currEntryData.desc_in&&(prevFromNote=currEntryData.desc_in),(fromEntryedit||fromNotesVal!==prevFromNote)&&(param.desc_in=fromNotesVal);var toNotesVal=toNotes&&toNotes.value?toNotes.value.trim():"",prevToNote="";if(currEntryData&&currEntryData.desc_out&&(prevToNote=currEntryData.desc_out),(fromEntryedit||toNotesVal!==prevToNote)&&(param.desc_out=toNotesVal),!fromEntryedit){if(void 0===param.desc_in&&void 0===param.desc_out)return;currEntryData.attenId&&0===Attendance.Entry.allDataList.showAllEntries&&(param.attenid=currEntryData.attenId),null!==Attendance.Entry.erecno&&(param.erecno=Attendance.Entry.erecno),$(obj).attr("disabled",!0),param.orgDate=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].ldate,$.post("/AttendanceAction.zp",param,function(rdata){rdata&&(void 0!==rdata.notesDetails.desc_in&&(currEntryData.desc_in=rdata.notesDetails.desc_in),void 0!==rdata.notesDetails.desc_out&&(currEntryData.desc_out=rdata.notesDetails.desc_out),$(obj).prop("disabled",!1)),Attendance.Entry.entryNotesToggle(obj,!0)})}}},entryNotesToggle:function(obj,isClose){obj=isClose?obj:$(obj).parent();var entryIndex=$(obj).parent().parent().index();isClose&&!Attendance.Entry.editShowCheck&&(entryIndex=$(obj).parent().parent().index());var attDate=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].attDate,entries=Attendance.Entry.allDataList.entries[attDate],currEntryData=entries[entryIndex];if(isClose&&(0===Object.keys(entries).length||1===entries.length&&1===Object.keys(entries[0]).length)&&($(Attendance.Entry.LayoutId+" #ZPAtt_entry_allEntriesList").parent().find("div.ZPcolhead").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_attEntry_emptyRecInfo").show()),!currEntryData||currEntryData.processRowEntry)return Attendance.Entry.removeFromToAttEntryEditDate(!0),Attendance.Entry.removeFromToAttEntryEditDate(!1),Attendance.Entry.removeFromToAttEntryEditTime(!0),Attendance.Entry.removeFromToAttEntryEditTime(!1),void $(obj).parent().parent().remove();var desc_in=null,desc_out=null;currEntryData.desc_in&&(desc_in=$("<div/>").text(currEntryData.desc_in).html()),currEntryData.desc_out&&(desc_out=$("<div/>").text(currEntryData.desc_out).html()),Attendance.Entry.descin=desc_in,Attendance.Entry.descout=desc_out;var notes="",tempNotes="";if(isClose){var object=$(obj).parent().prev();if(Attendance.Entry.editShowCheck&&(object=$(obj).parent().prev()),currEntryData.permissionId&&null==desc_in){var tempObject=object;Attendance.Entry.editShowCheck||(tempObject=$(obj).parent()),tempObject.next().remove()}if(null!==desc_in||null!==desc_out){if(desc_in&&currEntryData.fdate&&""!==currEntryData.fdate.trim()&&"-"!==currEntryData.fdate.trim()&&(object.prev().children(":eq(0)").find("#ZPAtt_Checkin_Notes").remove(),object.prev().children(":eq(0)").append("<span class='zpl_attloctdtls' id='ZPAtt_Checkin_Notes'>"+desc_in+"</span>"),currEntryData.permissionId)){tempObject=object;var list="<div class='zpl_attSrcrw'>";list+="<span class='w100'>"+ZPI18N.getString("zp.reason")+"</span>",list+="<div class='zpl_attsrcRsn'>"+desc_in+"</div></div>",Attendance.Entry.editShowCheck||(tempObject=$(obj).parent()),tempObject.next().next().remove(),$(list).insertAfter(tempObject.next())}desc_out&&currEntryData.tdate&&""!==currEntryData.tdate.trim()&&"-"!==currEntryData.tdate.trim()&&(object.prev().children(":eq(2)").find("#ZPAtt_Checkout_Notes").remove(),object.prev().children(":eq(2)").append("<span class='zpl_attloctdtls' id='ZPAtt_Checkout_Notes'>"+desc_out+"</span>"))}Attendance.Entry.showEntryEdit(obj,!0)}else{var alreadyVisibleInput=$(obj).parent().parent().parent().parent().find("textarea")[0];alreadyVisibleInput&&$(alreadyVisibleInput).parent().parent().children().last().children(":eq(0)").trigger("click"),currEntryData.permissionId&&!Attendance.Entry.editShowCheck&&$(obj).parent().parent().next().hide(),$(obj).parent().parent().find("#ZPAtt_Checkin_Notes").hide(),$(obj).parent().parent().find("#ZPAtt_Checkout_Notes").hide(),tempNotes="<div class='zpl_attnterw'><div class='zpl_attnteflds'>",(currEntryData.fdate&&""!==currEntryData.fdate.trim()&&"-"!==currEntryData.fdate.trim()||"ZPadp"!==$(obj).attr("class")&&Attendance.Entry.editShowCheck)&&(null===desc_in&&(desc_in=""),notes="<textarea rows='3' class='ztextbox' data-zbp-bound='true'' placeholder='"+ZPI18N.getString("zp.addnotesforcheckin")+"'>"+desc_in+"</textarea>",Attendance.Entry.editShowCheck?$(obj).parent().parent().children(":eq(1)").children().children(":eq(0)").find("textarea").replaceWith(notes):tempNotes+=notes),tempNotes+="</div>",tempNotes+="<div class='zpl_attnteflds'>",(currEntryData.tdate&&""!==currEntryData.tdate.trim()&&"-"!==currEntryData.tdate.trim()||"ZPadp"!==$(obj).attr("class")&&Attendance.Entry.editShowCheck)&&(null===desc_out&&(desc_out=""),notes="<textarea rows='3' class='ztextbox' placeholder='"+ZPI18N.getString("zp.addnotesforcheckout")+"'>"+desc_out+"</textarea>",Attendance.Entry.editShowCheck?$(obj).parent().parent().children(":eq(1)").children().children(":eq(1)").find("textarea").replaceWith(notes):tempNotes+=notes),tempNotes+="</div></div>",tempNotes+="<div class='text-center' id='ZPAtt_SaveCancelNotes'>",tempNotes+="<button class='zlabel zlabel--blue zlabel--small' type='button' onclick='Attendance.Entry.saveNotes(this)'>"+ZPI18N.getString("zp.save")+"</button>",tempNotes+="<button class='zlabel zlabel--outline zlabel--small' type='button' onclick='Attendance.Entry.entryNotesToggle(this,true)'>"+ZPI18N.getString("zp.cancel")+"</button>",tempNotes+="</div>",Attendance.Entry.editShowCheck||($(obj).parent().parent().append(tempNotes),$(obj).parent().children().last().hide())}},toggleProEntryNotes:function(obj,isClose){var desc=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].description,notesCont=$(obj).parent().parent();if(notesCont.children().remove(),isClose){var noteCont="<div class='form-group'>";return noteCont+="<label class='dgry'><b>"+ZPI18N.getString("zp.notes")+"</b></label>",noteCont+="<div class='form-group P0I paraTags'>"+desc+"</div>",noteCont+="</div>",noteCont+="<div class='form-group'>",noteCont+="<button class='btn btn-primary' onclick=Attendance.Entry.toggleProEntryNotes(this)>"+ZPI18N.getString("zp.edit")+"</button>",noteCont+="</div>",void notesCont.append(noteCont)}var entryEditCont="<div class='form-group'>";entryEditCont+="<label class='dgry'><b>"+ZPI18N.getString("zp.notes")+"</b></label>",entryEditCont+="<textarea rows='3' class='form-control' placeholder='"+ZPI18N.getString("zp.typenotes")+"' autofocus>"+desc+"</textarea>",entryEditCont+="</div>",entryEditCont+="<div class='form-group'>",entryEditCont+="<button class='btn btn-primary MR10' onclick=Attendance.Entry.saveProEntryNotes(this)>"+ZPI18N.getString("zp.save")+"</button>",entryEditCont+="<button class='btn btn-default' onclick=Attendance.Entry.toggleProEntryNotes(this,true)>"+ZPI18N.getString("zp.cancel")+"</button>",entryEditCont+="</div>",notesCont.append(entryEditCont)},saveProEntryNotes:function(obj){Attendance.Entry.reloadFromWMS=!1;var notes=$(obj).parent().prev().find("textarea").val().trim(),orgDate=Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].ldate;if(""!==notes){var param={mode:"updateNotes",conreqcsr:csrfToken};param.notes=notes,null!==Attendance.Entry.erecno&&(param.erecno=Attendance.Entry.erecno),param.orgDate=orgDate,$.post("/AttendanceAction.zp",param,function(rdata){void 0!==rdata.notesDetails.notes&&(Attendance.Entry.allDataList.dayList[Attendance.Entry.selectedRowIndex].description=rdata.notesDetails.notes,Attendance.Entry.toggleProEntryNotes(obj,!0))})}},showDayListTabler:function(data,updateTR){if(data){var tbody=$(Attendance.Entry.LayoutId+" #ZPAtt5_tabViewEntries");updateTR||tbody.empty(),Attendance.Entry.hasOpenCheckin=!1;var showOfficeInRemoteIn=Attendance.Entry.showOfficeINRemoteIN();if(Attendance.Entry.allDataList.showLateNigthWorking){var lateNightPresentHourshtml='<table class="zpl_tblcntr zpl_itbl">';lateNightPresentHourshtml+="<thead>",lateNightPresentHourshtml+='<tr><th colspan="3" style="border-bottom: 1px solid var(--brdr_dflt)">'+ZPI18N.getString("zp.present")+"</th></tr>",lateNightPresentHourshtml+='<tr><th class="mw150">'+ZPI18N.getString("zp.present")+"</th>",lateNightPresentHourshtml+='<th class="mw150">'+ZPI18N.getString("zp.latenight")+"</th>",lateNightPresentHourshtml+='<th class="mw150">'+ZPI18N.getString("zp.total")+"</th>",lateNightPresentHourshtml+="</tr>",lateNightPresentHourshtml+="</thead>",lateNightPresentHourshtml+="</table>",$(Attendance.Entry.LayoutId+" #ZPAtt_showHideLateNightTabView").html(lateNightPresentHourshtml);var lateNightOTHourshtml='<table class="zpl_tblcntr zpl_itbl">';lateNightOTHourshtml+="<thead>",lateNightOTHourshtml+='<tr><th colspan="3" style="border-bottom: 1px solid var(--brdr_dflt)">'+ZPI18N.getString("zp.overtimedeviation")+"</th></tr>",lateNightOTHourshtml+='<tr><th class="mw150">'+ZPI18N.getString("zp.overtime")+"</th>",lateNightOTHourshtml+='<th class="mw150">'+ZPI18N.getString("zp.latenight")+"</th>",lateNightOTHourshtml+='<th class="mw150">'+ZPI18N.getString("zp.total")+"</th>",lateNightOTHourshtml+="</tr>",lateNightOTHourshtml+="</thead>",lateNightOTHourshtml+="</table>",$(Attendance.Entry.LayoutId+" #ZPAtt_overDevInEntry").html(lateNightOTHourshtml),$(Attendance.Entry.LayoutId+" #ZPAtt_totalLateNightEntry").show()}else $(Attendance.Entry.LayoutId+" #ZPAtt_totalLateNightEntry").hide();if(Attendance.Entry.showShiftcoreHours){Layout.Page.container.find("[id='ZPAtt_CoreHrs']").show();var courHoursTHhtml='<table class="zpl_tblcntr zpl_itbl">';courHoursTHhtml+="<thead>",courHoursTHhtml+='<tr><th colspan="3" style="border-bottom: 1px solid var(--brdr_dflt)">'+ZPI18N.getString("zp.worked.shiftCoreHours")+"</th></tr>",courHoursTHhtml+='<tr><th class="mw150">'+ZPI18N.getString("zp.core.Expected")+"</th>",courHoursTHhtml+='<th class="mw150">'+ZPI18N.getString("zp.worked",new Array(""))+"</th>",courHoursTHhtml+='<th class="mw150">'+ZPI18N.getString("zp.deviation")+"</th>",courHoursTHhtml+="</tr>",courHoursTHhtml+="</thead>",courHoursTHhtml+="</table>",$(Attendance.Entry.LayoutId+" #ZPAtt_CoreHrs").html(courHoursTHhtml)}else Layout.Page.container.find("[id='ZPAtt_CoreHrs']").hide();for(var hideAllowanceCol=!0,totalAllowance=0,officeInDname=Att_Common_Operations.isModuleDataLoaded&&ZPeople.Module.MODULE_DATA.attendance.officeINdNameEncoded?ZPeople.Module.MODULE_DATA.attendance.officeINdNameEncoded:ZPI18N.getString("zp.officein"),remoteInDname=Att_Common_Operations.isModuleDataLoaded&&ZPeople.Module.MODULE_DATA.attendance.remoteINdNameEncoded?ZPeople.Module.MODULE_DATA.attendance.remoteINdNameEncoded:ZPI18N.getString("zp.remotein"),i=0;data[i];i++){data[i].tsecs||(data[i].tsecs=0);var trow="<tr>",workTime="-",workingHours="-",totalHours="-",status=data[i].status,colorClass="";"Absent"===status||"0.5 day Present, 0.5 day Absent"===status||"0.25 day Present, 0.75 day Absent"===status||"0.75 day Present, 0.25 day Absent"===status||"0.5 day Absent"===status||-1!==status.indexOf("Absent -")&&-1!==status.indexOf("Present -")&&2===status.split(",").length?colorClass="zpl_absntBg":"Present"===status||"0.5 day Present"===status||-1!==status.indexOf("Present -")&&1===status.split(",").length?colorClass="zpl_prsntBg":-1!==status.indexOf("Weekend")?colorClass="zpl_wkendBg":-1!==status.indexOf("Paid Leave")?(colorClass="zpl_levBg",-1!==status.indexOf("Present")&&(-1!==status.indexOf("0.5 day Paid Leave")&&-1===status.indexOf("0.5 day On Duty")&&-1===status.indexOf("0.5 day Unpaid Leave")||data[i].leaveHours)&&(colorClass="zpl_prsntBg")):-1!==status.indexOf("On Duty")?(colorClass="zpl_ondutyBg",-1!==status.indexOf("Present")&&(-1!==status.indexOf("0.5 day On Duty")&&-1===status.indexOf("0.5 day Unpaid Leave")||data[i].leaveHours)&&(colorClass="zpl_prsntBg")):-1!==status.indexOf("Unpaid Leave")?(colorClass="zpl_lopBg",-1===status.indexOf("Present")||-1===status.indexOf("0.5 day Unpaid Leave")&&!data[i].leaveHours||(colorClass="zpl_prsntBg")):(status.includes("Holiday")||Att_Common_Operations.isRestrictedHoliday(status))&&(colorClass="zpl_holiBg",!status.includes("Present")||!Att_Common_Operations.isUnAvailedRestrictedHoliday(status)&&(!status.includes("(0.5 day Holiday)")||status.includes("0.5 day Paid Leave")||status.includes("0.5 day On Duty")||status.includes("0.5 day Unpaid Leave")||data[i].fulldayPresent)||(colorClass="zpl_prsntBg"));var transStat=Attendance.consLeaveStat(status,!0,!1);if(void 0!==data[i].overTime_tsecs&&(workTime="<span class='grn'>"+Attendance.disHours(data[i].overTime_tsecs/60)+"</span>"),void 0!==data[i].devTime_tsecs&&(workTime="<span class='red'>"+Attendance.disHours(data[i].devTime_tsecs/60)+"</span>"),0!==data[i].wsecs&&(workingHours=Attendance.disHours(data[i].wsecs/60)),0!==data[i].tsecs&&(totalHours=Attendance.disHours(data[i].tsecs/60)),trow+="<td>"+days[data[i].day-1]+", "+Attendance.disDate(data[i].ldate)+"</td>",data[i].isToday){var entries=Attendance.Entry.allDataList.entries[data[i].attDate],lastEntryObj={};if(entries.length>0){var displayLastRow=entries[entries.length-1];(lastEntryObj=1==entries.length?displayLastRow:entries[displayLastRow.lastRowIndex]).allowPunchOut&&(Attendance.Entry.checkInOut="out")}else Attendance.Entry.checkInOut="in";if(void 0!==lastEntryObj.tsecs)Attendance.Entry.updateTotalmins(lastEntryObj.tsecs,"set",lastEntryObj.lsecs);else if(Attendance.Entry.temp_tsecs=0,1===Attendance.Entry.allDataList.showAllEntries){var addSecs=lastEntryObj.totalSecs?lastEntryObj.addSecs+lastEntryObj.totalSecs:lastEntryObj.addSecs;Attendance.Entry.updateTotalmins(addSecs,"set",lastEntryObj.lsecs)}else Attendance.Entry.updateTotalmins(lastEntryObj.addSecs)}data[i].filo?(trow+="<td>"+Attendance.disDate(data[i].filo.ftime)+"</td>",!data[i].isToday||data[i].isToday&&"in"==Attendance.Entry.checkInOut?(Attendance.Entry.hasOpenCheckin=!1,trow+="<td>"+Attendance.disDate(data[i].filo.ttime)+"</td>"):(trow+="<td> </td>",Attendance.Entry.hasOpenCheckin=!!data[i].isToday||Attendance.Entry.hasOpenCheckin)):(trow+="<td> </td>",trow+="<td> </td>"),Attendance.Entry.hasOpenCheckin?(trow+="<td id='ZP5Tab_CurrentTotalHours'></td>",Attendance.Entry.lastRefTime=(new Date).getTime(),Attendance.Entry.setTime("first")):trow+="<td>"+totalHours+"</td>",Layout.Page.container.find("[id='ZPAtt_showHidePaidBreakTabView']").hide(),Layout.Page.container.find("[id='ZPAtt_showHideUnpaidBreakTabView']").hide(),Attendance.Entry.allDataList.breakList.activeBreakCount>0&&(Attendance.Entry.allDataList.breakList.breakDispDetails.isPaidBrkDispNeed&&Attendance.Entry.allDataList.isViewAllowedForPaidBrkHrs&&(Layout.Page.container.find("[id='ZPAtt_showHidePaidBreakTabView']").show(),trow+="<td>"+data[i].totalPaidBreakHours+"</td>"),Attendance.Entry.allDataList.breakList.breakDispDetails.isUnpaidBrkDispNeed&&Attendance.Entry.allDataList.isViewAllowedForUnPaidBrkHrs&&(Layout.Page.container.find("[id='ZPAtt_showHideUnpaidBreakTabView']").show(),trow+="<td>"+data[i].totalUnPaidBreakHours+"</td>")),$(Attendance.Entry.LayoutId+" #ZPAtt_showHidePermissionTabView").hide(),Attendance.Entry.allDataList.isPermissionConfigured&&($(Attendance.Entry.LayoutId+" #ZPAtt_showHidePermissionTabView").show(),trow+="<td>"+data[i].totalPermissionHours+"</td>"),Layout.Page.container.find("[id='ZPAtt_showHidePayableHrsTabView']").hide(),Attendance.Entry.allDataList.isViewAllowedForPayableHrs&&(Layout.Page.container.find("[id='ZPAtt_showHidePayableHrsTabView']").show(),trow+="<td>"+workingHours+"</td>"),Layout.Page.container.find("[id='ZPAtt_showHideLateNightTabView']").hide(),Attendance.Entry.allDataList.showLateNigthWorking&&(Layout.Page.container.find("[id='ZPAtt_showHideLateNightTabView']").show(),trow+="<td class='tblbody'><table class='zpl_tblcntr zpl_itbl'><tbody><tr><td class='mw150'><span>"+(void 0!=data[i].regular_present_tsecs?Attendance.disHours(data[i].regular_present_tsecs/60):"-")+"</span>",trow+="</td><td class='mw150'><span>"+(void 0!=data[i].lateNight_present_tsecs?Attendance.disHours(data[i].lateNight_present_tsecs/60):"-")+"</span>",trow+="</td><td class='mw150'><span>"+(void 0!=data[i].total_present_tsecs?Attendance.disHours(data[i].total_present_tsecs/60):"-")+"</span>",trow+="</td></tr></tbody></table></td>"),0===Attendance.Entry.allDataList.showOverDevTime&&(Attendance.Entry.allDataList.showLateNigthWorking?(trow+="<td class='tblbody'><table class='zpl_tblcntr zpl_itbl'><tbody><tr><td class='mw150'><span>"+(void 0!=data[i].regular_overtTime_tsecs?Attendance.disHours(data[i].regular_overtTime_tsecs/60):"-")+"</span>",trow+="</td><td class='mw150'><span>"+(void 0!=data[i].lateNight_overtTime_tsecs?Attendance.disHours(data[i].lateNight_overtTime_tsecs/60):"-")+"</span> ",trow+="</td><td class='mw150'>"+workTime+"</td></tr></tbody></td></table>"):trow+="<td>"+workTime+"</td>"),Attendance.Entry.allDataList.showLateNigthWorking&&(trow+="<td>"+(void 0!=data[i].total_latenight_tsecs?Attendance.disHours(data[i].total_latenight_tsecs/60):"-")+"</td>");var allowance="-";void 0!==data[i].shiftAllowance&&(hideAllowanceCol=!1,allowance=data[i].shiftAllowance,totalAllowance+=data[i].shiftAllowance),transStat=Attendance.escapeHtml(transStat);var approvalInfo=data[i].approvalInfo;if(approvalInfo&&approvalInfo.isRegularized&&(transStat=""===transStat?ZPI18N.getString("zp.regularized"):transStat+" / "+ZPI18N.getString("zp.regularized")),showOfficeInRemoteIn&&(trow+="<td>"+(data[i].officein_hrs?data[i].officein_hrs:"-")+"</td>",trow+="<td>"+(data[i].remotein_hrs?data[i].remotein_hrs:"-")+"</td>"),Attendance.Entry.showShiftcoreHours&&(trow+="<td class='tblbody'><table class='zpl_tblcntr zpl_itbl'><tbody><tr><td class='mw150'><span>"+(data[i].totalCoreHrs?data[i].totalCoreHrs:"-")+"</span>",trow+="</td><td class='mw150'><span>"+(data[i].shiftCoreHours?data[i].shiftCoreHours:"-")+"</span>",trow+="</td><td class='mw150'><span>"+(data[i].devShiftCoreHours?data[i].devShiftCoreHours:"-")+"</span>",trow+="</td></tr></tbody></table></td>"),trow+="<td><div class='d-flexC flexclmcap'><span class='zpl_lbdr _bx "+colorClass+"' ></span><span title='"+transStat+"'> "+transStat+"</span></span></div></td>",showOfficeInRemoteIn){var officeInRemoteIn="-";data[i].officein?officeInRemoteIn=officeInDname:data[i].remotein&&(officeInRemoteIn=remoteInDname),trow+="<td><span class='ellipsis' data-container='body' data-placement='bottom' data-toggle='tooltip' data-original-title='"+officeInRemoteIn+"'>"+officeInRemoteIn+"</span></td>"}var shiftInfo=Shift.getShiftName(data[i].shift.shiftId,!0);trow+="<td><span class='ellipsis' data-container='body' title='"+Shift.getShiftTimeForDisplay(data[i].shift.shiftId)+"'>"+shiftInfo.shiftName+"</span></td><td id='allowanceColumn'><span class='ellipsis W100'>"+allowance+"</span></td>";var appClass="",appmsg="",clickFunc="";if(approvalInfo){var appInfo=approvalInfo;1===appInfo.status?(appClass="PI_like grn",appmsg=ZPI18N.getString("zp.approved")):0===appInfo.status?(appClass="PI_unlike red",appmsg=ZPI18N.getString("zp.rejected")):-2===appInfo.status?(appClass="PI_like org",appmsg=ZPI18N.getString("zp.submitted")):(appClass="PI_pending3 org",appmsg=ZPI18N.getString("zp.waitingmsg")),clickFunc="regularization_operation.getAttendanceRegDetails('"+appInfo.formId+"','"+appInfo.recordId+"', Att_Common_Operations.approvalCloseCallBack);"}if(trow+="<td><i class='"+appClass+"' title='"+appmsg+"' onclick="+clickFunc+"></i></td>",isSPOCEntryEdit&&(Attendance.Entry.erecno&&isSPOCEntryEdit.includes(Attendance.Entry.erecno)||!Attendance.Entry.erecno&&isSPOCEntryEdit.includes(erecno))||isManageAttendanceData&&!Attendance.Entry.allDataList.hideDelete){if(trow+="<td><div class='over-display zpl_hvr'>",isRegConfigured)trow+="<i class='PI_edt' onclick=regularization_operation.constructRequestReg(this,"+(regDate=data[i].attDate.split("-"))[2]+","+regDate[1]+","+regDate[0]+")></i>";trow+="<i class='PI_delete' onclick=Attendance.Entry.deleteWarning(this,Attendance.Entry.deleteProcessRow);$(this).closest('tr').parent().find('i.PI_delete').removeAttr('id');$(this).attr('id','ZPAtt_entry_clickedElement')></i>",trow+="</div></td>",$(Attendance.Entry.LayoutId+" #ZPAtt_actionInEntry").show()}else if(isRegConfigured&&(null===Attendance.Entry.erecno||Attendance.Entry.allDataList.addRegForSub)){var regDate;trow+="<td><div class='over-display zpl_hvr'><i onclick=regularization_operation.constructRequestReg(this,"+(regDate=data[i].attDate.split("-"))[2]+","+regDate[1]+","+regDate[0]+") class='PI_edt'></i></div></td>",$(Attendance.Entry.LayoutId+" #ZPAtt_actionInEntry").show()}else $(Attendance.Entry.LayoutId+" #ZPAtt_actionInEntry").hide();trow+="</tr>",updateTR?$(updateTR).replaceWith(trow):tbody.append(trow)}hideAllowanceCol?($(Attendance.Entry.LayoutId+" #ZPAtt5_tabView #allowanceColumn").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt5_tabView #allowanceFooter").hide()):($(Attendance.Entry.LayoutId+" #ZPAtt5_tabView #allowanceColumn").show(),$(Attendance.Entry.LayoutId+" #ZPAtt5_tabView #allowanceFooter").show(),$(Attendance.Entry.LayoutId+" #ZPAtt5_tabView #totalAllowanceAmt").text(Math.round(100*totalAllowance)/100)),$(Attendance.Entry.LayoutId+" #ZPAtt5_tabView").parent().hasClass("tabcont")||ZPView.handleTablePosition();var colSpan=7;Attendance.Entry.allDataList.breakList.activeBreakCount&&($("#ZPAtt_showHidePaidBreakTabView").is(":visible")&&(colSpan+=1),$("#ZPAtt_showHideUnpaidBreakTabView").is(":visible")&&(colSpan+=1)),Attendance.Entry.showShiftcoreHours&&(colSpan+=1),showOfficeInRemoteIn&&(colSpan+=3),colSpan=isPermissionConfigured?colSpan+1:colSpan,colSpan=Attendance.Entry.showShiftcoreHours?colSpan+1:colSpan,colSpan=Attendance.Entry.allDataList.showLateNigthWorking?colSpan+1:colSpan,0===Attendance.Entry.allDataList.showOverDevTime?($(Attendance.Entry.LayoutId+" #ZPAtt_overDevInEntry").show(),colSpan+=1,$(Attendance.Entry.LayoutId+" #allowanceFooter th").eq(0).attr("colspan",colSpan)):($(Attendance.Entry.LayoutId+" #ZPAtt_overDevInEntry").hide(),$(Attendance.Entry.LayoutId+" #allowanceFooter th").eq(0).attr("colspan",colSpan))}},addRegFromEntry:function(obj){ZPeople.BSModal.show($("#"+Layout.Page.pageId+" #ZPAtt_Entry_addRequest")),Attendance.Entry.showReqAddPopup(obj)},calObj:null,currMonth:null,currYear:null,showDayListCalendar:function(){var calObj=new NewCalendar.calObj;"calendar"==Attendance.Entry.selectedPageView&&($("#"+Layout.Page.pageId).find(".PI_alft").off("click"),$("#"+Layout.Page.pageId).find(".PI_argt").off("click"));var month=Attendance.Entry.calendarAllDataList.currDate.MONTH,year=Attendance.Entry.calendarAllDataList.currDate.YEAR,mth=moment(year+"-"+Attendance.disTwoDigit(parseInt(month+1))+"-01").add(-1*Attendance.Entry.calendarPreMonth,"month")._d;calObj.curYear=mth.getFullYear(),calObj.curMonth=mth.getMonth(),calObj.callback=Attendance.Entry.consDataDaylistCalendar,calObj.calcontId="monthcalendardiv",calObj.outerdivId="ZPAtt5_calViewOuterDiv",calObj.daysObj={empty:"zpcalempty",weekend:"zpcalweek",day:"zpcaldays",today:"zpcaltoday",leave:"zpcalholi"},calObj.divid="ZPAtt5_calView",calObj.mode="attendance",calObj.tdonclick=null,calObj.totaldata=!1,calObj.prearrow="PI_alft",calObj.nextarrow="PI_argt",Attendance.Entry.calObj=calObj,null===Attendance.Entry.currMonth&&(Attendance.Entry.currYear=calObj.curYear,Attendance.Entry.currMonth=calObj.curMonth),NewCalendar.initCalendar(Attendance.Entry.calObj)},consDataDaylistCalendar:function(){if(TimelySettings.showHideLoadingPage(!1),null!=Attendance.Entry.calendarAllDataList&&Attendance.Entry.calendarAllDataList.dayList){settingsPage.container;var dayList=Attendance.Entry.calendarAllDataList.dayList,resultDataList=new Array,leaveTypes=Attendance.Entry.leaveTypes,totLeave=leaveTypes.length,showOfficeInRemoteIn=Attendance.Entry.showOfficeINRemoteIN(),officeInDname=Att_Common_Operations.isModuleDataLoaded&&ZPeople.Module.MODULE_DATA.attendance.officeINdNameEncoded?ZPeople.Module.MODULE_DATA.attendance.officeINdNameEncoded:ZPI18N.getString("zp.officein"),remoteInDname=Att_Common_Operations.isModuleDataLoaded&&ZPeople.Module.MODULE_DATA.attendance.remoteINdNameEncoded?ZPeople.Module.MODULE_DATA.attendance.remoteINdNameEncoded:ZPI18N.getString("zp.remotein");$.each(dayList,function(index,data){var status="",txt="",rData={};rData.date=data.attDate.split("-")[2];var stat=data.status;for(var k in stat=stat.split(", "))if("Weekend"!==(status=stat[k])){var statWithSesion=status;-1!=(sessionIndex=status.indexOf("$"))&&(status=status.slice(0,sessionIndex)+status.slice(status.indexOf("$",sessionIndex+1)+1));var hourBasedLeaveIndex=status.indexOf("#");-1!=hourBasedLeaveIndex&&(status=status.slice(0,hourBasedLeaveIndex)+status.slice(status.indexOf("#",hourBasedLeaveIndex+1)+1));var transStat=$("<div/>").text(Attendance.statusI18n(status)).html();transStat=Attendance.remCommaInLast(transStat);var sessionClass="",className="";if(-1===status.indexOf("Absent")||data.isToday)-1!==status.indexOf("Paid Leave")?className=Attendance.returnLeaveColorClass(leaveTypes,"lv_bgbdrs1",totLeave,transStat):-1!==status.indexOf("On Duty")?className=Attendance.returnLeaveColorClass(leaveTypes,"lv_bgbdrs3",totLeave,transStat):-1!==status.indexOf("Unpaid Leave")?className=Attendance.returnLeaveColorClass(leaveTypes,"zpl_absntBgbdr",totLeave,transStat):status.includes("Holiday")||Att_Common_Operations.isRestrictedHoliday(status)?className=Att_Common_Operations.isUnAvailedRestrictedHoliday(status)?"zpl_rholiBgbdr":status.includes("0.5 day")?"zpl_holibrdrd":"zpl_holiBgbdr":-1!==status.indexOf("Present")&&-1===stat.indexOf("Absent")&&(className="zpl_prsntBgbdr");else if(0!==data.tsecs){var absentclass="zpl_absntBgbdr",perWidthDiv="";if(-1!==status.indexOf("day Absent"))absentclass="zpl_absntbrdrd zpl_hrly",perWidthDiv='<div class="zpl_hrlylv " style="width: '+(percent=100*status.split(" day Absent")[0])+'%;"></div>';txt+='<div class="zpl_shftdts '+absentclass+'"> <span>'+Attendance.consLeaveStat(status,!0,!0)+"</span>",""!=perWidthDiv&&(txt+=perWidthDiv),-1==stat.toString().indexOf("Present")&&(txt+="<em>"+data.tHrs+" "+ZPI18N.getString("zp.hrs")+"</em>"),txt+="</div>"}else className="zpl_absntBgbdr";if(-1!==status.indexOf("0.25 day")||-1!==status.indexOf("0.5 day")){var sessionIndex,session=0;session=-1!==(sessionIndex=statWithSesion.indexOf("$"))&&"0"!==statWithSesion.slice(sessionIndex+1,sessionIndex+2)?statWithSesion.slice(sessionIndex+1,sessionIndex+2):-1===status.indexOf("Present")&&-1===status.indexOf("Absent")?data.session:void 0!==data.session?1==data.session?2:1:"",-1!==status.indexOf("0.25 day")?sessionClass=Attendance.Entry.getSessionClass(session):-1!==status.indexOf("0.5 day")&&(sessionClass=Attendance.Entry.getSessionClass(session,!0))}if(""!==className){transStat=Attendance.consLeaveStat(stat[k],!0,!0);perWidthDiv="";if(-1!==status.indexOf("day Present")||-1!==status.indexOf("day Absent")){var percent=100;-1!==status.indexOf("day Present")?(className="zpl_prsntbrdrd zpl_hrly",percent=100*status.split(" day Present")[0]):(className="zpl_absntbrdrd zpl_hrly",percent=100*status.split(" day Absent")[0]),perWidthDiv='<div class="zpl_hrlylv" style="width: '+percent+'%;"></div>'}if(-1!==status.toString().indexOf("Present")&&showOfficeInRemoteIn){var officeInRemoteIn="-";data.officein?officeInRemoteIn=officeInDname:data.remotein&&(officeInRemoteIn=remoteInDname),"-"!=officeInRemoteIn&&(transStat=transStat+"("+officeInRemoteIn+")")}txt+='<div class="zpl_shftdts '+className+(""!==sessionClass?" "+sessionClass:"")+'">',""!=perWidthDiv&&(txt+=perWidthDiv),txt+='<span title="'+transStat+'">'+transStat+"</span>",0!==data.tsecs&&-1!==status.indexOf("Present")&&(txt+="<em>"+data.tHrs+" "+ZPI18N.getString("zp.hrs")+"</em>"),txt+="</div>"}}if(data.totalPermissionHours&&"00:00"!=data.totalPermissionHours){var permissionDisp=ZPI18N.getString("zp.perm")+" - "+data.totalPermissionHours;txt+='<div class="zpl_shftdts lv_bgbdr3"><span title="'+permissionDisp+'">'+permissionDisp+"</span></div>"}(txt=""==txt?$("<div></div>"):$(txt)).data("attDate",data.attDate),-1!==stat.toString().indexOf("Present")&&(void 0!==data.filo.ftime&&txt.data("ftime",data.filo.ftime),void 0!==data.filo.ttime&&txt.data("ttime",data.filo.ttime)),rData.txt=txt,resultDataList.push(rData)}),NewCalendar.populateData(Attendance.Entry.calObj,resultDataList)}},getSessionClass:function(session,isHalf){return isHalf?2==session?"zpl_halfsec":"zpl_halffst":2==session?"zpl_qrtrsec":3==session?"zpl_qrtrthrd":4==session?"zpl_qrtrfour":"zpl_qrtrfst"},leftPositionCalc:function(time,date,orgDate){var time_hr=parseInt(time.slice(0,2),10),fromShift=Attendance.Entry.fromShiftTime,toShift=Attendance.Entry.toShiftTime;"AM"!==time.slice(6,8).trim()&&"am"!==time.slice(6,8).trim()||12!==time_hr?"PM"!==time.slice(6,8).trim()&&"pm"!==time.slice(6,8).trim()||12===time_hr||(time_hr+=12):time_hr=0;var time_min=parseInt(time.slice(3,5),10),temphour=time_hr-fromShift/60,per=(3600*temphour+60*time_min)/60/60/Attendance.Entry.shiftDiffTime*100,dateFormat=Attendance.Entry.allDataList.currDate.dateFormat.toUpperCase();return date=new Date(moment(date,dateFormat)._d),orgDate=new Date(moment(orgDate,dateFormat)._d),per<0&&fromShift>toShift&&60*time_hr<=toShift?per=(3600*(temphour+24)+60*time_min)/60/60/Attendance.Entry.shiftDiffTime*100:date.getTime()>orgDate.getTime()?per=101:date.getTime()<orgDate.getTime()&&(per=-1),per},getMonthReportForUser:function(){var param={mode:"getMonthReportForUser",conreqcsr:csrfToken};null!==Attendance.Entry.erecno&&(param.erecno=Attendance.Entry.erecno),param.view=Attendance.Entry.selectedView,param.preMonth=Attendance.Entry.preMonth,"month"!==Attendance.Entry.selectedView&&"calendar"!=Attendance.Entry.selectedPageView||(param.preMonth=Attendance.Entry.calendarPreMonth),$.post("/AttendanceReportAction.zp",param,function(rdata){rdata.monthDetails?(Attendance.Entry.summaryForUserEntry=rdata.monthDetails,Attendance.Entry.setSummaryInUserEntry(rdata)):(Attendance.Entry.summaryForUserEntry=rdata.weekDetails,Attendance.Entry.setSummaryInUserEntry(rdata)),Attendance.Entry.setAbsentInSummary()})},setSummaryInUserEntry:function(rdata){var data=Attendance.Entry.summaryForUserEntry;let sumAbsent,sumAbsentHrs,sameShiftInRange,shiftIdForChking,nonAbsent=0,nonAbsentHrs=0;var showOTDT=rdata.showOverDevTime,isPermissionConfigured=rdata.isPermissionConfigured;if(data&&Attendance.Entry.allDataList){sumAbsent=data.absent_count,sumAbsentHrs=data.totalAbsentDaysInSecs,nonAbsent=0,nonAbsentHrs=0;var dayList=Attendance.Entry.allDataList.dayList;for(var i in sameShiftInRange=!0,shiftIdForChking="",dayList)"0"===i?shiftIdForChking=dayList[i].shift.shiftId:shiftIdForChking!==dayList[i].shift.shiftId&&(sameShiftInRange=!1)}var attViewDaysList="";rdata.isViewAllowedForPayableHrs&&(attViewDaysList='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.payabledays")+'</span><span id="ZPAtt_payDaysCount"><b>'+data.totalPaidDays_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>"),attViewDaysList+='<div class="zpl_dytyp lv_bdr10"><span>'+ZPI18N.getString("zp.present")+'</span><span id="ZPAtt_presentCount"><b>'+data.present_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>",attViewDaysList+='<div class="zpl_dytyp lv_bdr3"><span>'+ZPI18N.getString("zp.onduty")+'</span><span id="ZPAtt_onDutyCount"><b>'+data.onduty_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>",attViewDaysList+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.tt.paidleave")+'</span><span id="ZPAtt_leaveCount"><b>'+data.leave_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>",attViewDaysList+='<div class="zpl_dytyp lv_bdr1"><span>'+holiday_disName+'</span><span id="ZPAtt_holidayCount"><b>'+data.holiday_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>",attViewDaysList+='<div class="zpl_dytyp lv_bdr8"><span>'+ZPI18N.getString("zp.weekend")+'</span><span id="ZPAtt_weekendCount"><b>'+data.weekend_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>";var attRepDaysList="";if(rdata.isViewAllowedForPayableHrs&&(attRepDaysList='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.payabledays")+'</span><span id="ZPAtt_ReppayDaysCount"><b>'+data.totalPaidDays_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>"),attRepDaysList+='<div class="zpl_dytyp lv_bdr10"><span>'+ZPI18N.getString("zp.present")+'</span><span id="ZPAtt_ReppresentCount"><b>'+data.present_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>",attRepDaysList+='<div class="zpl_dytyp lv_bdr3"><span>'+ZPI18N.getString("zp.onduty")+'</span><span id="ZPAtt_ReponDutyCount"><b>'+data.onduty_count+"</b>"+ZPI18N.getString("zp.day.plural")+"</span></div>",attRepDaysList+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.tt.paidleave")+'</span><span id="ZPAtt_RepleaveCount"><b>'+data.leave_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>",attRepDaysList+='<div class="zpl_dytyp lv_bdr1"><span>'+holiday_disName+'</span><span id="ZPAtt_RepholidayCount"><b>'+data.holiday_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>",attRepDaysList+='<div class="zpl_dytyp lv_bdr8"><span>'+ZPI18N.getString("zp.weekend")+'</span><span id="ZPAtt_RepweekendCount"><b>'+data.weekend_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>",data.isStatWeekendConfig&&(attRepDaysList+='<div class="zpl_dytyp lv_bdr8"><span>'+data.custStatWknd_Name+'</span><span id="ZPAtt_RepstatWeekendCount"><b> '+data.statWkndCnt+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>",attRepDaysList+='<div class="zpl_dytyp lv_bdr8"><span>'+data.custNonStatWknd_Name+'</span><span id="ZPAtt_RepnonStatWeekendCount"><b> '+data.nonStatWkndCnt+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>"),sumAbsent&&(attRepDaysList+='<div class="zpl_dytyp lv_bdr6"><span>'+ZPI18N.getString("zp.absent")+'</span><span id="ZPAtt_RepabsentCount"><b>'+Math.round(1e3*(sumAbsent-nonAbsent))/1e3+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>"),attViewDaysList+='<div class="zpl_hvr zpl_hvrsw" onclick="Attendance.Entry.getHourPopup(\'Day\')" data-popup-open="leglvelist"><i class="PI_more" ></i></div>',attRepDaysList+='<div class="zpl_dytyp lv_bdr5"><span>'+ZPI18N.getString("zp.tt.unpaidleave")+'</span><span id="ZPAtt_ReplopCount"><b>'+data.lop_leave_count+"</b> "+ZPI18N.getString("zp.day.plural")+"</span></div>",$(Attendance.Entry.LayoutId+" #ZPAttView5_Days").html(attViewDaysList),$(Attendance.Entry.LayoutId+" #ZP5AttView_RepDays").html(attRepDaysList),sameShiftInRange&&""!==shiftIdForChking){var shiftDetails=Shift.getShiftName(shiftIdForChking,!0,!1);Layout.Page.container.find("#ZPAttViewShfitName_Days").html("<b>"+shiftDetails.shiftName+" [ "+Shift.getShiftTimeForDisplay(shiftIdForChking)+" ] </b>")}var attViewsHoursList="",attRepHoursList="";data.tsecs<0?(attViewsHoursList+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.totalhours")+'</span><span id="ZPAtt_totalhours"><b>'+ZPI18N.getString("zp.na")+"</b></span></div>",attRepHoursList+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.totalhours")+'</span><span id="ZPAttRep_totalhours">'+ZPI18N.getString("zp.na")+"</span></div>"):(attViewsHoursList+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.totalhours")+'</span><span id="ZPAtt_totalhours"><b>'+Attendance.disHours(data.tsecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attRepHoursList+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.totalhours")+'</span><span id="ZPAttRep_totalhours"><b>'+Attendance.disHours(data.tsecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>"),rdata.isViewAllowedForPayableHrs&&(attViewsHoursList+='<div class="zpl_dytyp lv_bdr10"><span>'+ZPI18N.getString("zp.payablehours")+'</span><span id="ZPAtt_totalPayHours"><b>'+Attendance.disHours(data.totalPayDaysInSecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attRepHoursList+='<div class="zpl_dytyp lv_bdr10"><span>'+ZPI18N.getString("zp.payablehours")+'</span><span id="ZPAttRep_totalPayHours"><b>'+Attendance.disHours(data.totalPayDaysInSecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>"),attViewsHoursList+='<div class="zpl_dytyp lv_bdr1"><span>'+ZPI18N.getString("zp.presenthours")+'</span><span id="ZPAtt_totalWorkingHours"><b>'+Attendance.disHours(data.workingHours_tsecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attViewsHoursList+='<div class="zpl_dytyp lv_bdr3"><span>'+ZPI18N.getString("zp.onduty")+'</span><span id="ZPAtt_totalOnDutyHours"><b>'+Attendance.disHours(data.ondutysecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attViewsHoursList+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.tt.paidleave")+'</span><span id="ZPAtt_totalLeaveHours"><b>'+Attendance.disHours(data.leavesecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attViewsHoursList+='<div class="zpl_dytyp lv_bdr1"><span>'+holiday_disName+'</span><span id="ZPAtt_totalHolidayHours"><b>'+Attendance.disHours(data.totalHolidayDaysInSecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attRepHoursList+='<div class="zpl_dytyp lv_bdr1"><span>'+ZPI18N.getString("zp.presenthours")+'</span><span id="ZPAttRep_totalWorkingHours"><b>'+Attendance.disHours(data.workingHours_tsecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attRepHoursList+='<div class="zpl_dytyp lv_bdr3"><span>'+ZPI18N.getString("zp.onduty")+'</span><span id="ZPAttRep_totalOnDutyHours"><b>'+Attendance.disHours(data.ondutysecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attRepHoursList+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.tt.paidleave")+'</span><span id="ZPAttRep_totalLeaveHours"><b>'+Attendance.disHours(data.leavesecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attRepHoursList+='<div class="zpl_dytyp lv_bdr1"><span>'+holiday_disName+'</span><span id="ZPAttRep_totalHolidayHours"><b>'+Attendance.disHours(data.totalHolidayDaysInSecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attRepHoursList+='<div class="zpl_dytyp lv_bdr8"><span>'+ZPI18N.getString("zp.weekend")+'</span><span id="ZPAttRep_totalHolidayHours"><b>'+Attendance.disHours(data.regWeekendHours/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",data.isStatWeekendConfig&&(attRepHoursList+='<div class="zpl_dytyp lv_bdr8"><span>'+data.custStatWknd_Name+'</span><span id="ZPAttRep_statWeekendHours"><b>'+Attendance.disHours(data.totalStatWkndHrs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attRepHoursList+='<div class="zpl_dytyp lv_bdr8"><span>'+data.custNonStatWknd_Name+'</span><span id="ZPAttRep_nonStatWeekendHours"><b>'+Attendance.disHours(data.totalNonStatWkndHrs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>"),attViewsHoursList+='<div class="zpl_hvr zpl_hvrsw" onclick="Attendance.Entry.getHourPopup()" data-popup-open="leglvelist"><i class="PI_more" ></i></div>',attRepHoursList+='<div class="zpl_dytyp lv_bdr4"><span>'+ZPI18N.getString("zp.tt.unpaidleave")+'</span><span id="ZPAttRep_LOPHrs"><b>'+Attendance.disHours(data.lop_leave_secs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",0===showOTDT&&(attRepHoursList+='<div class="zpl_dytyp lv_bdr8"><span>'+ZPI18N.getString("zp.overtime")+'</span><span id="ZPAttRep_OTHrs"><b>'+Attendance.disHours(data.overTime_tsecs/60)+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>",attRepHoursList+='<div class="zpl_dytyp lv_bdr5"><span>'+ZPI18N.getString("zp.deviationtime")+'</span><span id="ZPAttRep_DTHrs"><b>'+(sumAbsentHrs?Attendance.disHours((sumAbsentHrs-nonAbsentHrs)/60):"")+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>");var breakDispDetails=Attendance.Entry.allDataList.breakList.breakDispDetails;breakDispDetails.isBreakConf&&(breakDispDetails.isPaidBrkDispNeed&&rdata.isViewAllowedForPaidBrkHrs&&(attRepHoursList+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.paidbreak")+'</span><span id="ZPAttRep_PaidBreakHrs"><b>'+data.totalPaidBreakHours+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>"),breakDispDetails.isUnpaidBrkDispNeed&&rdata.isViewAllowedForUnPaidBrkHrs&&(attRepHoursList+='<div class="zpl_dytyp lv_bdr5"><span>'+ZPI18N.getString("zp.unpaidbreak")+'</span><span id="ZPAttRep_PaidBreakHrs"><b>'+data.totalUnPaidBreakHours+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>")),isPermissionConfigured&&(attRepHoursList+='<div class="zpl_dytyp lv_bdr9"><span>'+ZPI18N.getString("zp.perm")+'</span><span id="ZPAttRep_PermissionHrs"><b>'+data.totalPermissionHours+"</b> "+ZPI18N.getString("zp.hrs")+"</span></div>"),$(Attendance.Entry.LayoutId+" #ZPAttView5_Hours").html(attViewsHoursList),$(Attendance.Entry.LayoutId+" #ZP5AttView_RepHours").html(attRepHoursList)},addStatWkndDays:function(ele,days,custName){ele.closest(".Dtyps").removeClass("DNI"),ele.text(days+" "+ZPI18N.getString("zp.day.plural")),ele.closest(".Dtyps").children().eq(0).text(custName)},addStatWkndHrs:function(ele,hrs,custName){ele.closest(".Dtyps").removeClass("DNI"),ele.text(Attendance.disHours(hrs/60)+" "+ZPI18N.getString("zp.hrs")),ele.closest(".Dtyps").children().eq(0).text(custName)},setAbsentInSummary:function(){if(Attendance.Entry.summaryForUserEntry&&Attendance.Entry.allDataList){var sumAbsent=Attendance.Entry.summaryForUserEntry.absent_count,sumAbsentHrs=Attendance.Entry.summaryForUserEntry.totalAbsentDaysInSecs,dayList=Attendance.Entry.allDataList.dayList,sameShiftInRange=!0,shiftIdForChking="";for(var i in dayList)"0"===i?shiftIdForChking=dayList[i].shift.shiftId:shiftIdForChking!==dayList[i].shift.shiftId&&(sameShiftInRange=!1);if(Layout.Page.container.find(".well.ZPDat").find("span.SfTxt").remove(),sameShiftInRange&&""!==shiftIdForChking){var shiftDetails=Shift.getShiftName(shiftIdForChking,!0,!1);Layout.Page.container.find(".well.ZPDat").prepend('<span class="SfTxt"><font class="ellipsis W100" title="'+shiftDetails.shiftName+'">'+shiftDetails.shiftName+'</font><time class="DB">[ '+Shift.getShiftTimeForDisplay(shiftIdForChking)+" ]</time></span>")}$(Attendance.Entry.LayoutId+" #ZPAttRep_DTHrs").html("<b>"+Attendance.disHours((sumAbsentHrs-0)/60)+"</b> "+ZPI18N.getString("zp.hrs")),$(Attendance.Entry.LayoutId+" #ZPAtt_absentCount").html("<b>"+Math.round(1e3*(sumAbsent-0))/1e3+"</b> "+ZPI18N.getString("zp.day.plural")),$(Attendance.Entry.LayoutId+" #ZPAtt_RepabsentCount").html("<b>"+Math.round(1e3*(sumAbsent-0))/1e3+"</b> "+ZPI18N.getString("zp.day.plural"))}},capturePhotoInfo:function(){var msg=ZPI18N.getString("zp.enablecameraforpunchesboth");return Attendance.isAllowToVerifyUserInWeb&&!Attendance.isAllowToCapturePhotoInWeb&&(msg=ZPI18N.getString("zp.enablecameraforpunchesverify")),'<i class="PI_info tooltip-js" data-title-position="right" data-title-display-type="callout" data-popover="true" data-html="true" title="'+msg+'"></i>'},openTakePhotoPopup:function(latLanObj,isCheckIn){navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(stream){var modal="<div class='zpl_mdl zpl_mcenter zpl_mopen zpl_fcrecg' data-modal-box='fcrecg' id='ZPAtt_PhotoCaptureModal' aria-hidden='false' data-backdrop='static' data-keyboard='false'>";modal+="<div class='zpl_minr'><div class='zpl_mhder'><div><h4></h4></div><a class='_cls PI_cls '></a></div>",modal+="<div class='zpl_mcnt zpl_fm'><form><div class='zpl_crd'><div class='zpl_crdcnt'>",modal+="<video id='ZPAtt_PhotoCapture_VideoPrev'>Video stream not available</video>",modal+="<img id='ZPAtt_PhotoCapture_output'><canvas id='ZPAtt_PhotoCaptureCanvas' style='display:none'></canvas><div class='zpl_fcactn'><div class='zpl_cmron'><i class='PI_cam' id='ZPAtt_PhotoCaptureButton'></i></div><div class='zpl_cmrok' style='display:none'><i class='PI_tick'id='ZPAtt_PhotoCaptureProceed' data-toggle='modal' data-target='#vrfyPop'></i><i class='PI_cam' id='ZPAtt_PhotoCaptureReTake'></i></div></div></div></div></form>",modal+="</div></div></div>",$("body").find("#ZPAtt_PhotoCaptureModal")[0]||$("body").append(modal);var layout=$("#ZPAtt_PhotoCaptureModal");layout.find("h4").html(ZPI18N.getString("zp.capturephoto")+" "+Attendance.Entry.capturePhotoInfo()),layout.popover({selector:"[data-popover].popHover",trigger:"click hover",delay:{show:50,hide:50}});var videoPrev=layout.find("#ZPAtt_PhotoCapture_VideoPrev");videoPrev.css("width",videoPrev.parent().width()),videoPrev.css("transform","rotateY(180deg)"),videoPrev.css("-webkit-transform","rotateY(180deg)"),videoPrev.css("-moz-transform","rotateY(180deg)");var vdo=videoPrev[0];vdo.srcObject=stream,vdo.play(),layout.find("#ZPAtt_PhotoCaptureProceed").parent().hide(),layout.find("#ZPAtt_PhotoCaptureProceed").data("latLanObj",latLanObj),layout.find("#ZPAtt_PhotoCaptureProceed").data("isCheckIn",isCheckIn),layout.find("#ZPAtt_PhotoCaptureButton").on("click",function(){Attendance.Entry.takePicture()}),layout.find("#ZPAtt_PhotoCaptureReTake").on("click",function(){Attendance.Entry.reTakePicture()}),layout.find("._cls.PI_cls ").on("click",function(){Attendance.Entry.onPhotoCaptureHide(isCheckIn)}),videoPrev.show(),layout.find("#ZPAtt_PhotoCapture_output").hide()}).catch(function(err){Attendance.Entry.onPhotoCaptureHide(isCheckIn,!0),-1===err.toString().indexOf("Requested device not found")?Attendance.isAllowToCapturePhotoInWeb?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.youneedtocapturephoto")):Attendance.isAllowToVerifyUserInWeb&&ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.youneedtoverifyphoto")):Attendance.isAllowToCapturePhotoInWeb?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.notsupporttocapturephoto")):Attendance.isAllowToVerifyUserInWeb&&ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.notsupporttoverifyphoto"))})},playVideo:function(){var vdo=$("#ZPAtt_PhotoCaptureModal").find("#ZPAtt_PhotoCapture_VideoPrev")[0];navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(function(stream){vdo.srcObject=stream,vdo.play()}).catch(function(err){-1===err.toString().indexOf("Requested device not found")?Attendance.isAllowToCapturePhotoInWeb?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.youneedtocapturephoto")):Attendance.isAllowToVerifyUserInWeb&&ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.youneedtoverifyphoto")):Attendance.isAllowToCapturePhotoInWeb?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.notsupporttocapturephoto")):Attendance.isAllowToVerifyUserInWeb&&ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.notsupporttoverifyphoto"))})},onPhotoCaptureHide:function(isCheckIn,isFromError){if(isFromError||(Attendance.Entry.stopMediaPlay(),$("#ZPAtt_PhotoCaptureModal").remove()),Attendance.getCurrPositionTriggered=!1,$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").is(":visible"))(inOutBut=Layout.Page.container.find("#ZPAtt_check_in_out")).find("#ZPAtt_running_timer").show(),inOutBut.find("#ZPATT_Check_in_out_loading").hide(),inOutBut.on("click",isCheckIn?function(){Attendance.Entry.punchIn()}:function(){Attendance.Entry.punchOut()});else if(Attendance.Entry.isMyspace()){var inOutBut;(inOutBut=Layout.Page.parentContainer.find("#ZPAtt_check_in_out")).attr("disabled",!1),inOutBut.find("#zpl_loading_icon").hide()}},takePicture:function(){var layout=$("#ZPAtt_PhotoCaptureModal"),video=layout.find("#ZPAtt_PhotoCapture_VideoPrev")[0],canvas=layout.find("#ZPAtt_PhotoCaptureCanvas")[0],photo=layout.find("#ZPAtt_PhotoCapture_output")[0],width=video.videoWidth,height=video.videoHeight,context=canvas.getContext("2d");canvas.width=width,canvas.height=height,context.translate(width,0),context.scale(-1,1),context.drawImage(video,0,0);var data=canvas.toDataURL("image/png");photo.setAttribute("src",data),layout.find("#ZPAtt_PhotoCapture_VideoPrev").hide(),layout.find("#ZPAtt_PhotoCapture_output").show(),Attendance.Entry.stopMediaPlay(),layout.find("#ZPAtt_PhotoCaptureProceed").unbind("click").bind("click",function(){Attendance.Entry.preceedPunches(data)}),layout.find("#ZPAtt_PhotoCaptureProceed").parent().show(),layout.find("#ZPAtt_PhotoCaptureButton").parent().hide(),layout.find("h4").html(ZPI18N.getString("zp.capturedphoto")+" "+Attendance.Entry.capturePhotoInfo()),layout.popover({selector:"[data-popover].popHover",trigger:"click hover",delay:{show:50,hide:50}})},reTakePicture:function(){var layout=$("#ZPAtt_PhotoCaptureModal");layout.find("#ZPAtt_PhotoCapture_VideoPrev").show(),layout.find("#ZPAtt_PhotoCapture_output").hide(),layout.find("#ZPAtt_PhotoCaptureProceed").parent().hide(),layout.find("#ZPAtt_PhotoCaptureButton").parent().show(),layout.find("h4").html(ZPI18N.getString("zp.capturephoto")+" "+Attendance.Entry.capturePhotoInfo()),layout.popover({selector:"[data-popover].popHover",trigger:"click hover",delay:{show:50,hide:50}}),Attendance.Entry.playVideo()},preceedPunches:function(data){var layout=$("#ZPAtt_PhotoCaptureModal"),latLanObj=layout.find("#ZPAtt_PhotoCaptureProceed").data("latLanObj");layout.find("#ZPAtt_PhotoCaptureProceed").data("isCheckIn")?Attendance.Entry.punchIn(latLanObj,data):Attendance.Entry.punchOut(latLanObj,data),$("#ZPAtt_PhotoCaptureModal").remove(),Attendance.isAllowToVerifyUserInWeb&&Attendance.Entry.openPhotoComparingPopup(data)},stopMediaPlay:function(){$("#ZPAtt_PhotoCaptureModal").find("#ZPAtt_PhotoCapture_VideoPrev")[0].srcObject.getTracks().forEach(function(track){track.stop()})},openPhotoComparingPopup:function(imageObj,isCheckIn,failureMsg,latLong){if(!imageObj){if(failureMsg)return $("#ZPAtt_PhotoComparingTitle").html(ZPI18N.getString("zp.photomismatch")),$("#ZPAtt_PhotoMatchMsg").html(failureMsg),$("#ZPAtt_statusIcon").addClass("zpl_msmtch"),$("#ZPAtt_statusIcon").html('<div class="dot"></div><div class="zpl_stsicn" ><i class="PI_cls"></i></div><div class="dot"></div>'),$("#ZPAtt_PhotoMatchBtmMsg").html('<button class="zlabel zlabel--blue zlabel--medium" id="ZPAtt_comparingRetake">'+ZPI18N.getString("zp.retake")+"</button>"),void $("#ZPAtt_comparingRetake").on("click",function(){$("#ZPAtt_PhotoComparingPopup").remove(),Attendance.Entry.openTakePhotoPopup(latLong,isCheckIn)});$("#ZPAtt_PhotoComparingTitle").html(ZPI18N.getString("zp.success")),$("#ZPAtt_PhotoMatchMsg").html("<span>"+ZPI18N.getString("zp.photomatched")+"</span>"),$("#ZPAtt_statusIcon").html('<div class="dot"></div><div class="zpl_stsicn" ><i class="PI_tick"></i></div><div class="dot"></div>');var bottommsg='<span class="red">'+ZPI18N.getString("zp.checkedout",new Array(""))+"</span>";return isCheckIn&&(bottommsg='<span class="grn">'+ZPI18N.getString("zp.checkedin",new Array(""))+"</span>"),$("#ZPAtt_PhotoComparingPopup #ZPAtt_PhotoMatchBtmMsg").html(bottommsg),void setTimeout(function(){$("#ZPAtt_PhotoComparingPopup").remove()},3e3)}var popup='<div class="zpl_mdl zpl_mcenter zpl_fcrecgver zpl_mopen" id="ZPAtt_PhotoComparingPopup" aria-hidden="false" data-model-box="fcmatch" data-backdrop="static" data-keyboard="false"><div class="zpl_minr"><div class="zpl_mhder">';popup+='<div><h4 id="ZPAtt_PhotoComparingTitle">'+ZPI18N.getString("zp.scanning")+'</h4></div><div><a class="_cls PI_cls "></a></div></div>',popup+='<div class="zpl_mcnt zpl_fm"><form><div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn d-flexM" id="ZPAtt_PhotoMatchMsg">'+ZPI18N.getString("zp.verifyingphoto")+"</div>",popup+='<div class="zpl_fcmatch"><div class="zpl_matpic"><img src="'+ZPeople.CURR_USER.avatar+'"></div><div class="zpl_matsts" id="ZPAtt_statusIcon" ></div><div class="zpl_matpic"><img src="'+imageObj+'"></div></div>',popup+='<div class="zpl_secn d-flexM" id="ZPAtt_PhotoMatchBtmMsg"></div></div></div></form></div></div></div>',popup+="</div></div></div></div>",$("body").find("#ZPAtt_PhotoComparingPopup")[0]||$("body").append(popup),$("#ZPAtt_PhotoComparingPopup").find("._cls.PI_cls ").on("click",function(){$("#ZPAtt_PhotoComparingPopup").remove()})},base64ToBlob:function(base64,mime){mime=mime||"";for(var byteChars=atob(base64),byteArrays=[],offset=0,len=byteChars.length;offset<len;offset+=1024){for(var slice=byteChars.slice(offset,offset+1024),byteNumbers=new Array(slice.length),i=0;i<slice.length;i++)byteNumbers[i]=slice.charCodeAt(i);var byteArray=new Uint8Array(byteNumbers);byteArrays.push(byteArray)}return new Blob(byteArrays,{type:mime})},getGeoForCheckIn:function(position){Attendance.Entry.getLatLangFromGeo(position,!0)},geoErrForCheckIn:function(error){Attendance.Entry.errorForgetLatLang(error,!0)},getGeoForCheckOut:function(position){Attendance.Entry.getLatLangFromGeo(position)},geoErrForCheckOut:function(error){Attendance.Entry.errorForgetLatLang(error)},getLatLangFromGeo:function(position,isCheckin){var obj={};obj.latitude=position.coords.latitude,obj.longitude=position.coords.longitude,obj.accuracy=position.coords.accuracy,isCheckin?Attendance.Entry.punchIn(obj):Attendance.Entry.punchOut(obj)},errorForgetLatLang:function(error,isCheckin){var err=!1;error.code&&(err=!0),isCheckin?Attendance.Entry.punchIn(err):Attendance.Entry.punchOut(err)},storeLatLongInLStore:function(param){if("undefined"!=typeof Storage){var locStorOfLatLon={};locStorOfLatLon.latitude=param.latitude,locStorOfLatLon.longitude=param.longitude,locStorOfLatLon.accuracy=param.accuracy,locStorOfLatLon.fetchedTime=(new Date).getTime(),localStorage.setItem("att_LatLonDet",JSON.stringify(locStorOfLatLon))}},latLongParam:null,punchIn:function(latLanObj,imageObj){settingsPage.container.find("#breakRunningDiv").attr("onclick","");var inOutBut=settingsPage.container.find("#ZPAtt_check_in_out");inOutBut.off("click"),inOutBut.find("#ZPATT_Check_in_out_loading").show(),inOutBut.find("#ZPAtt_running_timer").hide();var formData=new FormData;formData.append("conreqcsr",csrfToken),formData.append("urlMode",Layout.Page.urlmode?Layout.Page.urlmode:Layout.Page.pageId);var lastGenLatLon=null;if("undefined"!=typeof Storage&&null!==localStorage.getItem("att_LatLonDet")){var latLonObj=JSON.parse(localStorage.getItem("att_LatLonDet")),lastFetTime=latLonObj.fetchedTime;(new Date).getTime()-lastFetTime<=12e4&&(lastGenLatLon=latLonObj)}var latLonparam={};if(void 0!==Attendance.isTrackLocationEnabled&&Attendance.isTrackLocationEnabled){if(navigator.geolocation&&void 0===latLanObj&&null===lastGenLatLon){if(!Attendance.getCurrPositionTriggered){Attendance.getCurrPositionTriggered=!0;var extraParam={maximumAge:12e4};void 0===Attendance.isWebCoOrdMandatory||Attendance.isWebCoOrdMandatory||isGeoEnabledAtt?extraParam.timeout=15e3:extraParam.timeout=1e4,navigator.geolocation.getCurrentPosition(Attendance.Entry.getGeoForCheckIn,Attendance.Entry.geoErrForCheckIn,extraParam)}return}(void 0!==latLanObj&&"object"==typeof latLanObj&&0!==Object.keys(latLanObj).length&&latLanObj.latitude&&latLanObj.longitude||null!==lastGenLatLon)&&(null!==lastGenLatLon?(formData.append("latitude",lastGenLatLon.latitude),formData.append("longitude",lastGenLatLon.longitude),formData.append("accuracy",lastGenLatLon.accuracy),latLonparam.latitude=lastGenLatLon.latitude,latLonparam.longitude=lastGenLatLon.longitude,latLonparam.accuracy=lastGenLatLon.accuracy):(formData.append("latitude",latLanObj.latitude),formData.append("longitude",latLanObj.longitude),formData.append("accuracy",latLanObj.accuracy),latLonparam.latitude=latLanObj.latitude,latLonparam.longitude=latLanObj.longitude,latLonparam.accuracy=latLanObj.accuracy,Attendance.Entry.storeLatLongInLStore(latLonparam)))}if(!Attendance.isAllowToCapturePhotoInWeb&&!Attendance.isAllowToVerifyUserInWeb||void 0!==imageObj){if(imageObj){var base64ImageContent=imageObj.replace(/^data:image\/(png|jpg);base64,/,""),blob=Attendance.Entry.base64ToBlob(base64ImageContent,"image/png");formData.append("userImage",blob,"userImage.png")}Attendance.Entry.reloadFromWMS=!1,$(Attendance.Entry.LayoutId+" #ZPAtt_checkInOutDesc").is(":visible")&&""!==$(Attendance.Entry.LayoutId+" #ZPAtt_checkInOutDesc").val().trim()?(formData.append("desc_in",$(Attendance.Entry.LayoutId+" #ZPAtt_checkInOutDesc").val()),$(Attendance.Entry.LayoutId+" #ZPAtt_checkInOutDesc").val("")):$("#ZPAtt_Dash_checkinNotes").is(":visible")&&""!==$("#ZPAtt_Dash_checkinNotes").val().trim()&&formData.append("desc_in",$("#ZPAtt_Dash_checkinNotes").val().trim()),$.ajax({url:"/AttendanceAction.zp?mode=punchIn",type:"POST",data:formData,contentType:!1,processData:!1,success:function(rdata){Attendance.getCurrPositionTriggered=!1,settingsPage.container.find("#breakRunningDiv").attr("onclick",Attendance.Entry.isMyspace()?"TAMSUtil.Attendance.punch();":"Attendance.Entry.punchIn();"),inOutBut.on("click",function(){Attendance.Entry.punchIn()}),Attendance.Entry.isMyspace()&&(Layout.Page.parentContainer.find("#ZPAtt_check_in_out").attr("disabled",!1),Layout.Page.parentContainer.find("#ZPAtt_check_in_out").find("#zpl_loading_icon").hide()),inOutBut.find("#ZPATT_Check_in_out_loading").hide();var attListViewTodayActive=!1;if(Attendance.Entry.LayoutId&&(attListViewTodayActive=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").is(":visible")),Attendance.Dashboard&&!attListViewTodayActive){var dashlay=$(Attendance.Dashboard.pageLayout());dashlay.find('[name="ATTENDANCE"] #ZPAtt_Dash_CurrDate')[0]&&Attendance.Dashboard.WeeklyData.getCurWeekData(),dashlay.find("#ZPD_Top_Att_Stat")[0]&&Attendance.Dashboard.CurrStatus.getCurrDayStatus()}if(rdata.msg&&rdata.msg.error)return"alreadyIn"===rdata.msg.error?ModuleComp.Msg.showWarningMsg(ZPI18N.getString("zp.alreadycheckedin")):"differentTimeZone"===rdata.msg.error&&ModuleComp.Msg.showWarningMsg(ZPI18N.getString("zp.timezonechanged",[rdata.msg.prevEntryTimeZone])),void("list"==Attendance.Entry.selectedPageView&&(Attendance.Entry.loadToday=!1,Attendance.Entry.getList()));if(rdata.photoError)return Attendance.Entry.openPhotoComparingPopup(null,!0,rdata.photoError,latLonparam),void inOutBut.find("#ZPAtt_running_timer").show();if(rdata.fail){if("punchIn_error3"===rdata.fail)ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.allowedintimetracker"));else if("punchIn_error2"===rdata.fail)ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.permissiondenied")+". "+ZPI18N.getString("zp.iprestricted"));else if("punchIn_error1"===rdata.fail)ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.webcheckinnotallowed"));else if("punchIn_error4"===rdata.fail){var errorParam=new Array;rdata.distancediff&&rdata.distancediff<2e3?errorParam.push(ZPI18N.getString("zp.geolocationrestricted.distance",[rdata.distancediff])):null!=latLonparam.accuracy&&latLonparam.accuracy>=1e3?errorParam.push(ZPI18N.getString("zp.geolocationrestricted.inaccuracy")):errorParam.push(""),ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.geolocationrestricted",errorParam))}else"location_access_error"!==rdata.fail&&"punchIn_error5"!==rdata.fail||ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.enableaccesstolocationAsPerCompanyPol",new Array("")));$("#ZPAtt_PhotoComparingPopup")[0]&&$("#ZPAtt_PhotoComparingPopup").modal("hide"),inOutBut.find("#ZPAtt_running_timer").show()}else{if(Attendance.Entry.openPhotoComparingPopup(null,!0,null,latLonparam),Attendance.Entry.checkInOut="out",Attendance.Entry.curDayBreakDetails=rdata.curDayBreakDetails?rdata.curDayBreakDetails:void 0,$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").is(":visible")&&null===Attendance.Entry.erecno){if(ZPeople.reloadDashAttData=!!(Attendance.Dashboard&&attListViewTodayActive||ZPeople.reloadDashAttData),attListViewTodayActive){var todayRowIndex=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").index();Attendance.Entry.allDataList.dayList[todayRowIndex]=rdata.msg.dayList[0],Attendance.Entry.getCurrDayEntry($(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").index())}return attListViewTodayActive||(Attendance.Entry.curDayBreakDetails.shiftBreakDets?Attendance.Entry.showOrHideBreakSelect(!0,Attendance.Entry.curDayBreakDetails.shiftBreakDets):Attendance.Entry.showOrHideBreakSelect(!1)),Attendance.Entry.hideBreakDiv(),void Attendance.Entry.setFunctionInOrOut()}Attendance.Entry.isMyspace()&&TAMSUtil.Attendance.setFunctionInOrOut()}},error:function(data){Attendance.Entry.refreshPage(data)}})}else Attendance.Entry.openTakePhotoPopup(latLonparam,!0)},punchOut:function(latLanObj,imageObj){var inOutBut=settingsPage.container.find("#ZPAtt_check_in_out");inOutBut.off("click"),Layout.Page.parentContainer.find("#breakSelDiv").find("span").removeAttr("onclick").unbind("click"),inOutBut.find("#ZPATT_Check_in_out_loading").show(),inOutBut.find("#ZPAtt_running_timer").hide();var formData=new FormData;formData.append("conreqcsr",csrfToken),formData.append("urlMode",Layout.Page.urlmode?Layout.Page.urlmode:Layout.Page.pageId);var lastGenLatLon=null;if("undefined"!=typeof Storage&&null!==localStorage.getItem("att_LatLonDet")){var latLonObj=JSON.parse(localStorage.getItem("att_LatLonDet")),lastFetTime=latLonObj.fetchedTime;(new Date).getTime()-lastFetTime<=12e4&&(lastGenLatLon=latLonObj)}var latLonparam={};if(void 0!==Attendance.isTrackLocationEnabled&&Attendance.isTrackLocationEnabled){if(navigator.geolocation&&void 0===latLanObj&&null===lastGenLatLon){if(!Attendance.getCurrPositionTriggered){Attendance.getCurrPositionTriggered=!0;var extraParam={maximumAge:12e4};void 0===Attendance.isWebCoOrdMandatory||Attendance.isWebCoOrdMandatory||isGeoEnabledAtt?extraParam.timeout=15e3:extraParam.timeout=1e4,navigator.geolocation.getCurrentPosition(Attendance.Entry.getGeoForCheckOut,Attendance.Entry.geoErrForCheckOut,extraParam)}return}(void 0!==latLanObj&&"object"==typeof latLanObj&&0!==Object.keys(latLanObj).length&&latLanObj.latitude&&latLanObj.longitude||null!==lastGenLatLon)&&(null!==lastGenLatLon?(formData.append("latitude",lastGenLatLon.latitude),formData.append("longitude",lastGenLatLon.longitude),formData.append("accuracy",lastGenLatLon.accuracy),latLonparam.latitude=lastGenLatLon.latitude,latLonparam.longitude=lastGenLatLon.longitude,latLonparam.accuracy=lastGenLatLon.accuracy):(formData.append("latitude",latLanObj.latitude),formData.append("longitude",latLanObj.longitude),formData.append("accuracy",latLanObj.accuracy),latLonparam.latitude=latLanObj.latitude,latLonparam.longitude=latLanObj.longitude,latLonparam.accuracy=latLanObj.accuracy,Attendance.Entry.storeLatLongInLStore(latLonparam)))}if(!Attendance.isAllowToCapturePhotoInWeb&&!Attendance.isAllowToVerifyUserInWeb||void 0!==imageObj){if(imageObj){var base64ImageContent=imageObj.replace(/^data:image\/(png|jpg);base64,/,""),blob=Attendance.Entry.base64ToBlob(base64ImageContent,"image/png");formData.append("userImage",blob,"userImage.png")}Attendance.Entry.breakId&&(formData.append("breakId",Attendance.Entry.breakId),Attendance.Entry.breakId=void 0),Attendance.Entry.reloadFromWMS=!1,$(Attendance.Entry.LayoutId+" #ZPAtt_checkInOutDesc").is(":visible")&&""!==$(Attendance.Entry.LayoutId+" #ZPAtt_checkInOutDesc").val().trim()?(formData.append("desc_out",$(Attendance.Entry.LayoutId+" #ZPAtt_checkInOutDesc").val()),$(Attendance.Entry.LayoutId+" #ZPAtt_checkInOutDesc").val("")):$("#ZPAtt_Dash_checkinNotes").is(":visible")&&""!==$("#ZPAtt_Dash_checkinNotes").val().trim()&&formData.append("desc_out",$("#ZPAtt_Dash_checkinNotes").val().trim()),$.ajax({url:"/AttendanceAction.zp?mode=punchOut",type:"POST",data:formData,contentType:!1,processData:!1,success:function(rdata){Attendance.getCurrPositionTriggered=!1,inOutBut.on("click",function(){Attendance.Entry.punchOut()}),Layout.Page.parentContainer.find("#breakSelDiv").find("span").attr("onclick","Attendance.Entry.toggleBreakPopup()").bind("click"),inOutBut.find("#ZPATT_Check_in_out_loading").hide();var attListViewTodayActive=!1;if(Attendance.Entry.LayoutId&&(attListViewTodayActive=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").is(":visible")),Attendance.Entry.isMyspace()&&(Layout.Page.parentContainer.find("#ZPAtt_check_in_out").attr("disabled",!1),Layout.Page.parentContainer.find("#ZPAtt_check_in_out").find("#zpl_loading_icon").hide()),rdata.punchOut&&rdata.punchOut.error)return"alreadyOut"===rdata.punchOut.error?ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.alreadycheckedout")):rdata.punchOut.error&&rdata.punchOut.error.startsWith("sourceTypeMismatchErr")?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp."+rdata.punchOut.error)):"differentTimeZone"===rdata.punchOut.error?ModuleComp.Msg.showWarningMsg(ZPI18N.getString("zp.timezonechanged",[rdata.punchOut.prevEntryTimeZone])):"breakTimeErr"===rdata.punchOut.error?(ModuleComp.Msg.showWarningMsg(ZPI18N.getString("zp.breakspectime")),$("#ZPAtt_PhotoComparingPopup")[0]&&$("#ZPAtt_PhotoComparingPopup").remove()):"Manual Break shouldn't start in the duration of Automatic breaks"===rdata.punchOut.error?ModuleComp.Msg.showWarningMsg(ZPI18N.getString("zp.manualinauto")):"accBreakExceed"===rdata.punchOut.error?ModuleComp.Msg.showWarningMsg(ZPI18N.getString("zp.accbreaktimeexceed")):"overlapwithCoreHour"===rdata.punchOut.error&&ModuleComp.Msg.showWarningMsg(ZPI18N.getString("zp.manualinauto.corerestrict")),"list"!=Attendance.Entry.selectedPageView||Attendance.Entry.isMyspace()||(Attendance.Entry.loadToday=!1,Attendance.Entry.getList()),void inOutBut.find("#ZPAtt_running_timer").show();if(rdata.photoError)return Attendance.Entry.openPhotoComparingPopup(null,!1,rdata.photoError,latLonparam),void inOutBut.find("#ZPAtt_running_timer").show();if(rdata.fail){if("punchOut_error3"===rdata.fail)ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.allowedintimetracker"));else if("punchOut_error2"===rdata.fail)ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.permissiondenied")+" "+ZPI18N.getString("zp.iprestricted"));else if("punchOut_error1"===rdata.fail)ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.webcheckinnotallowed"));else if("punchOut_error4"===rdata.fail){var errorParam=new Array;rdata.distancediff&&rdata.distancediff<2e3?errorParam.push(ZPI18N.getString("zp.geolocationrestricted.distance",[rdata.distancediff])):null!=latLonparam.accuracy&&latLonparam.accuracy>=1e3?errorParam.push(ZPI18N.getString("zp.geolocationrestricted.inaccuracy")):errorParam.push(""),ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.geolocationrestricted",errorParam))}else"location_access_error"!==rdata.fail&&"punchOut_error5"!==rdata.fail||ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.enableaccesstolocationAsPerCompanyPol",new Array("")));$("#ZPAtt_PhotoComparingPopup")[0]&&$("#ZPAtt_PhotoComparingPopup").modal("hide"),inOutBut.find("#ZPAtt_running_timer").show()}else{if(Attendance.Entry.openPhotoComparingPopup(null,!1,null,latLonparam),Attendance.Entry.checkInOut="in",Attendance.Entry.temp_tsecs=0,$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").is(":visible")&&null===Attendance.Entry.erecno){if(ZPeople.reloadDashAttData=!!(Attendance.Dashboard&&attListViewTodayActive||ZPeople.reloadDashAttData),Attendance.Entry.isPrevExtended)return Attendance.Entry.isPrevExtended=null,void("week"===Attendance.Entry.selectedView?$(Attendance.Entry.LayoutId+" #ZPAtt_weekViewBut").trigger("click"):$(Attendance.Entry.LayoutId+" #ZPAtt_monViewBut").trigger("click"));if(attListViewTodayActive){var todayRowIndex=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").index();Attendance.Entry.allDataList.dayList[todayRowIndex]=rdata.punchOut.dayList[0],Attendance.Entry.getCurrDayEntry($(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active").index())}if(!attListViewTodayActive)if(rdata.punchOut.runningBreakId){var breakDetails={};breakDetails.runningBreakId=rdata.punchOut.runningBreakId,breakDetails.breakTimerAddSecs=rdata.punchOut.breakTimerAddSecs,Attendance.Entry.showBreakRunner(breakDetails)}else Attendance.Entry.showOrHideBreakSelect(!1);return Attendance.Entry.hideBreakDiv(),void Attendance.Entry.setFunctionInOrOut()}Attendance.Entry.isMyspace()&&(Attendance.Entry.hideBreakDiv(),TAMSUtil.Attendance.setFunctionInOrOut())}},error:function(data){Attendance.Entry.refreshPage(data)}})}else Attendance.Entry.openTakePhotoPopup(latLonparam,!1)},manualUpdateOfAbsent:function(shiftId,date){var param={mode:"manualUpdateOfAbsent",conreqcsr:csrfToken};param.shiftId=shiftId,param.punishDate=date,$.post("/AttendanceAction.zp",param,function(rdata){1==rdata.response?ModuleComp.Msg.showSuccessMsg(ZPI18N.getString("zp.success")):ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.unabletoprocess"))})},addPunchInOrOutWithNotes:function(event){27===event.keyCode?$(Attendance.Entry.LayoutId+" #ZPAtt_checkInOutDesc").val(""):""!==$(Attendance.Entry.LayoutId+" #ZPAtt_checkInOutDesc").val()&&13===event.keyCode&&$(Attendance.Entry.LayoutId+" #ZPAtt_check_in_out").trigger("click")},lastRefTime:null,temp_tsecs:0,display_sec:0,lastSecs:0,updateTotalmins:function(addSecs,needtostore,lsecs){var lastRefTime=Attendance.Entry.lastRefTime,curTime=(new Date).getTime();-1!=Attendance.Entry.LayoutId.indexOf("attendance-entry-summary")&&"list"==Attendance.Entry.selectedPageView&&null===Attendance.Entry.erecno&&""===Layout.Page.container.find("#ZPAtt_checkInOutDesc").val().trim()&&!Layout.Page.container.find("#ZPAtt_allEntries_popup").is(":visible")&&(!lastRefTime||curTime-lastRefTime>9e5)&&(Attendance.Entry.lastRefTime=curTime,lastRefTime&&(Attendance.Entry.loadToday=!1,Attendance.Entry.getList(Attendance.Entry.selectedView,Attendance.Entry.preMonth)));var todayId=$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries .today-active"),totalForBarWidth=0,allData=Attendance.Entry.allDataList;if(!(addSecs<0||!todayId||lsecs<0)){if(addSecs||(addSecs=0),"set"===needtostore){var totalsecs=addSecs;this.display_sec=addSecs,this.temp_tsecs=0,0===allData.showScaleView&&todayId.is(":visible")&&(void 0!==lsecs&&""!==lsecs?(totalForBarWidth=lsecs,this.lastSecs=lsecs):(totalForBarWidth=0,this.lastSecs=0))}else this.temp_tsecs+=addSecs,totalForBarWidth=totalsecs=this.display_sec+this.temp_tsecs,0===allData.showScaleView&&todayId.is(":visible")&&(totalForBarWidth=this.lastSecs+this.temp_tsecs);var sec=parseInt(totalsecs%60),min=parseInt((totalsecs-sec)/60%60),hrs=parseInt((totalsecs-min)/3600);if(todayId.is(":visible")&&todayId[0]){if("out"===Attendance.Entry.checkInOut)if(parseInt(totalsecs)>=86400){var temp=Math.round((curTime-ZPeople.lastRefTime)/1e3);if(0==ZPeople.lastRefTime||temp>=36e3)return ZPeople.lastRefTime=curTime,void ZPeople.reloadListViewAtt(Layout.Page.urlmode)}else{var totalHrshtml="<div class='zpl_attentrydtls'><b>"+Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+":"+Attendance.disTwoDigit(sec)+"</b><em>"+ZPI18N.getString("zp.hrs")+"</em></div>";todayId.children().last().html(totalHrshtml),$(Attendance.Entry.LayoutId+" #ZPAtt_clock")&&$(Attendance.Entry.LayoutId+" #ZPAtt_clock").html("<b>"+Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+":"+Attendance.disTwoDigit(sec)+" "+ZPI18N.getString("zp.hrs")+"</b>"),$(Attendance.Entry.LayoutId+" #ZPAtt_allEntries_popup").is(":visible")&&Attendance.Entry.allDataList.currDate&&null!=Attendance.Entry.entryPopUpAttDate&&Attendance.Entry.entryPopUpAttDate==Attendance.Entry.allDataList.currDate.todayDate&&Layout.Page.container.find("#ZPAtt_totalHoursInPopup").text(Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+" "+ZPI18N.getString("zp.hrs"))}else if(!Attendance.Entry.breakRowOpen){totalHrshtml="<div class='zpl_attentrydtls'><b>"+Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+":"+Attendance.disTwoDigit(sec)+"</b><em>"+ZPI18N.getString("zp.hrs")+"</em></div>";todayId.children().last().text(totalHrshtml),$(Attendance.Entry.LayoutId+" #ZPAtt_clock")&&$(Attendance.Entry.LayoutId+" #ZPAtt_clock").html("<b>"+Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+":"+Attendance.disTwoDigit(sec)+" "+ZPI18N.getString("zp.hrs")+"</b>"),$(Attendance.Entry.LayoutId+" #ZPAtt_allEntries_popup").is(":visible")&&Attendance.Entry.allDataList.currDate&&null!=Attendance.Entry.entryPopUpAttDate&&Attendance.Entry.entryPopUpAttDate==Attendance.Entry.allDataList.currDate.todayDate&&Layout.Page.container.find("#ZPAtt_totalHoursInPopup").text(Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+" "+ZPI18N.getString("zp.hrs"))}if(0===allData.showScaleView){var currRunningTimeDate=Attendance.Entry.allDataList.currDate.todayDate,currRunningTimeLeftPos=Attendance.Entry.leftPositionCalc(Attendance.Entry.currRunningTime,currRunningTimeDate,Attendance.Entry.latestCheckinDate);if(currRunningTimeLeftPos>=0&&currRunningTimeLeftPos>=Attendance.Entry.latestCheckinLeftPos){var updateBar=$(todayId.children()[3].children[0].children[0]),per=(totalForBarWidth-30)/60/60/Attendance.Entry.shiftDiffTime*100;Attendance.Entry.latestCheckinLeftPos<0&&(per-=-1*Attendance.Entry.latestCheckinLeftPos),per>100&&(per=100);var tempDivWidth=updateBar.width()*(per/100);if(0!==updateBar.children().length&&(0===Attendance.Entry.allDataList.showAllEntries||1===Attendance.Entry.allDataList.showAllEntries&&!$(todayId.children(":eq(5)").children(":eq(0)").children(":eq(2)")).hasClass("absent-bg")))if(updateBar.children().first().hasClass("zpl_custprgrsbar zpl_prsntBg zpl_prgrsbaractiv zpl_act")&&(updateBar.children().first().hasClass("zpl_prsntBg")||1==updateBar.children().first(["class^='LC'"]).length))tempDivWidth+updateBar.children().first().position().left<updateBar.width()?updateBar.children().first().css("width",per+"%"):updateBar.children().first().css("width",updateBar.width()-updateBar.children().first().position().left);else if("out"===Attendance.Entry.checkInOut&&1===Attendance.Entry.allDataList.showAllEntries&&updateBar.children().first().hasClass("zpl_custprgrsbar")){updateBar.children().first().attr("class","zpl_custprgrsbar zpl_prsntBg zpl_prgrsbaractiv zpl_act"),tempDivWidth+updateBar.children().first().position().left<updateBar.width()?updateBar.children().first().css("width",per+"%"):updateBar.children().first().css("width",updateBar.width()-updateBar.children().first().position().left)}}}else(per=totalsecs/60/60/10*100)>100&&(per=100),$(todayId.children()[2].children[0].children[0]).css("width",per+"%")}return $(Attendance.Entry.LayoutId+" #ZP5Tab_CurrentTotalHours").is(":visible")&&$(Attendance.Entry.LayoutId+" #ZP5Tab_CurrentTotalHours").text(Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)),!todayId.is(":visible")&&$(Attendance.Entry.LayoutId+" #ZPAtt_clock")&&$(Attendance.Entry.LayoutId+" #ZPAtt_clock").html(Attendance.disTwoDigit(hrs)+":"+Attendance.disTwoDigit(min)+":"+Attendance.disTwoDigit(sec)+" "+ZPI18N.getString("zp.hrs")),totalsecs}},setFunctionInOrOut:function(){var checkInBut=Layout.Page.container.find("#ZPAtt_check_in_out"),inClass="in",outClass="out";"/zp"===ZPeople.CONTEXT&&(inClass="in",outClass="out");var butClass=inClass,text=ZPI18N.getString("zp.checkin"),inpPlaceHolder=ZPI18N.getString("zp.addnotesforcheckin"),callback=Attendance.Entry.punchIn;if(checkInBut.find("#ZPAtt_running_timer").remove(),"out"===Attendance.Entry.checkInOut){butClass=outClass,text=ZPI18N.getString("zp.checkout"),inpPlaceHolder=ZPI18N.getString("zp.addnotesforcheckout"),callback=Attendance.Entry.punchOut;var imageSrc=ZPeople.getResourceURL(newUIImageUrl+"timer.gif");checkInBut.append('<span id="ZPAtt_running_timer"><img src="'+imageSrc+'"></span>')}else checkInBut.append('<span class="PI_timer" id="ZPAtt_running_timer"></span>');checkInBut.attr("class","zpl_chk-in "+butClass).attr("title",text),checkInBut.attr({"aria-label":text,tabindex:"0"}),checkInBut.find("p").text(text),Layout.Page.container.find("#ZPAtt_checkInOutDesc").is(":visible")&&Layout.Page.container.find("#ZPAtt_checkInOutDesc").attr({placeholder:inpPlaceHolder,tabindex:"0"}),checkInBut.off("click").on("click",function(){callback()})},getAttRegJson:function(userInput){var attRegJson={};if(userInput.oldAttDataForDay&&void 0!==userInput.fromTime&&void 0!==userInput.toTime){var oldFromTime=userInput.oldAttDataForDay.fromdate?userInput.oldAttDataForDay.fromdate.substring(0):"",oldToTime=userInput.oldAttDataForDay.todate?userInput.oldAttDataForDay.todate.substring(0):"",newFromTime="",newFromDate="",invalidFromHour=!1,invalidToHour=!1;if(""!==userInput.fromTime.trim()){var fromDateTime=userInput.fromTime;newFromDate=fromDateTime.split(" ")[0],attRegJson.fromDate=newFromDate,newFromTime=fromDateTime.split(" ")[1]+" "+fromDateTime.split(" ")[2];var regFromHour=parseInt(newFromTime.split(":")[0],10),regFromMin=parseInt(newFromTime.split(":")[1],10);invalidFromHour=Attendance.timeFormatIs12hr?regFromHour>12||invalidFromHour:regFromHour>23||invalidFromHour,invalidFromHour=regFromMin>60||invalidFromHour,newFromTime=Attendance.disTwoDigit(newFromTime.split(":")[0])+newFromTime.substring(newFromTime.indexOf(":"))}var newToTime="",newToDate="";if(null!=userInput.toTime.trim()){var toDateTime=userInput.toTime;newToDate=toDateTime.split(" ")[0],attRegJson.toDate=newToDate,newToTime=toDateTime.split(" ")[1]+" "+toDateTime.split(" ")[2];var regToHour=parseInt(newToTime.split(":")[0],10),regToMin=parseInt(newToTime.split(":")[1],10);invalidToHour=Attendance.timeFormatIs12hr?regToHour>12||invalidToHour:regToHour>23||invalidToHour,invalidToHour=regToMin>60||invalidToHour,newToTime=Attendance.disTwoDigit(newToTime.split(":")[0])+newToTime.substring(newToTime.indexOf(":"))}if(userInput.reasonanddesc){var reasonanddesc=userInput.reasonanddesc,reasonanddescJson={};reasonanddesc.desc&&""!==reasonanddesc.desc.trim()&&(reasonanddescJson.desc=reasonanddesc.desc.trim()),reasonanddesc.reason&&""!==reasonanddesc.reason.trim()&&(reasonanddescJson.reason=reasonanddesc.reason.trim()),attRegJson.reasonanddesc=reasonanddesc}if(userInput.fromTime.trim()&&(attRegJson.ftime=Attendance.Common.convertTimerInputToMinsOrSecs(userInput.fromTime.trim().split(" ")[1]+" "+userInput.fromTime.trim().split(" ")[2])),userInput.toTime.trim()){var ttime=Attendance.Common.convertTimerInputToMinsOrSecs(userInput.toTime.trim().split(" ")[1]+" "+userInput.toTime.trim().split(" ")[2]);attRegJson.ttime=ttime}if((invalidToHour||invalidFromHour)&&(attRegJson.errorType="5"),oldFromTime!=newFromTime||oldToTime!=newToTime||userInput.oldAttDataForDay.allowDuplicates)if(""==userInput.fromTime.trim()||""==userInput.toTime.trim()){if(attRegJson.errorType="1",userInput.oldAttDataForDay.allowDuplicates&&""==userInput.fromTime.trim()&&""==userInput.toTime.trim())return{}}else!ZPeople.Module.MODULE_DATA.attendance.isRegReasonsEnabled||userInput.reasonanddesc&&userInput.reasonanddesc.reason?userInput.reasonanddesc&&userInput.reasonanddesc.desc&&userInput.reasonanddesc.desc.length>500&&(attRegJson.errorType="4"):attRegJson.errorType="2";else oldFromTime==newFromTime&&oldToTime==newToTime&&""!=newFromTime&&""!=newToTime&&(attRegJson.errorType="3");return attRegJson}return{}},refreshPage:function(resp){resp&&resp.responseJSON&&resp.responseJSON.code&&-1!==resp.responseJSON.code.indexOf("INVALID_CSRF_TOKEN")&&(ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.sessionexpired")),setTimeout(function(){location.reload()},3e3))},processRowUpdate:function(obj){Attendance.Entry.reloadFromWMS=!1;var param={mode:"bulkAttendReg",conreqcsr:csrfToken},isEmpChooseApp=ZPeople.Module.MODULE_DATA.attendance.isEmpChooseApp;($(Attendance.Entry.LayoutId+" #ZPAtt5_tabView").is(":visible")||$(Attendance.Entry.LayoutId+" #ZPAtt5_listView").is(":visible"))&&null!==Attendance.Entry.erecno?param.erecno=Attendance.Entry.erecno:$("#"+Layout.Page.pageId+" #ZPAtt_AddReq_FilEmployee").val()&&"0"!==$("#"+Layout.Page.pageId+" #ZPAtt_AddReq_FilEmployee").val()?param.erecno=$("#"+Layout.Page.pageId+" #ZPAtt_AddReq_FilEmployee").select2("val"):param.erecno=erecno;var dataObj={},isBothInOutMissingErr=[],reasonUnSelectedErr=[],descLimitErr=[],isOldEntriesAvailable=!1,isRegReasonsEnabled=ZPeople.Module.MODULE_DATA.attendance.isRegReasonsEnabled,isAllEmpty=!0,inValidHour=!1;if("attendance-regularization-myrequests"===Layout.Page.pageId){if(isEmpChooseApp){if("-Select-"===(chosenErecno=Attendance.Reg.getEmpChosenApprErecno(Layout.Page.container.find("#addRegularizationPage"))))return;param.empChoosenApprErecno=chosenErecno}$("#"+Layout.Page.pageId+" #attRegTableBody tr:gt(0):visible").each(function(){var userInputJson={},reasonanddesc={},originDate=$(this).find("#attRegDateDiv").attr("date_orgformat");userInputJson.fromTime=$(this).find("#ZPAtt_reg_fromTime").val().trim(),userInputJson.toTime=$(this).find("#ZPAtt_reg_toTime").val().trim();var desc=$(this).find("#reg_req_desc").val().trim();if(isRegReasonsEnabled){var reasonSelect=$(this).find("#reg_req_reason").val();reasonanddesc.reason=ZPeople.Module.MODULE_DATA.attendance.regReasons[reasonSelect]}""!==desc&&(reasonanddesc.desc=desc),(reasonanddesc.desc||reasonanddesc.reason)&&(userInputJson.reasonanddesc=reasonanddesc),userInputJson.oldAttDataForDay=Attendance.Reg.getDayRecordJson.regDetails[originDate],isOldEntriesAvailable||""===userInputJson.fromTime&&""===userInputJson.toTime||(isOldEntriesAvailable=!0);var resultJson=Attendance.Entry.getAttRegJson(userInputJson);if("1"===resultJson.errorType)isBothInOutMissingErr.push(originDate);else if("2"===resultJson.errorType)reasonUnSelectedErr.push(originDate),dataObj[originDate]=resultJson;else{if("3"===resultJson.errorType)return void(isAllEmpty=!1);"4"===resultJson.errorType?descLimitErr.push(originDate):"5"===resultJson.errorType?inValidHour=!0:Object.keys(resultJson).length>0&&(dataObj[originDate]=resultJson)}})}else{if(isEmpChooseApp){var chosenErecno,addReqLayout=Layout.Page.container.find("#ZPAtt_Entry_addRequest");if(Layout.Page.container.find("#ZPAtt5_listView").is(":visible")&&(addReqLayout=Layout.Page.container.find("#ZPAtt_Entry_addRequest_list")),"-Select-"===(chosenErecno=Attendance.Reg.getEmpChosenApprErecno(addReqLayout)))return;param.empChoosenApprErecno=chosenErecno}var userInputJson={},reasonanddesc={},originDate=Attendance.Entry.getDayRecordJson.regDetails.dayList[0];userInputJson.fromTime=$("#"+Layout.Page.pageId+" #ZPAtt_reg_fromTime").val().trim(),userInputJson.toTime=$("#"+Layout.Page.pageId+" #ZPAtt_reg_toTime").val().trim();var desc=Layout.Page.container.find("#reg_req_desc").val().trim();if(isRegReasonsEnabled){var reasonSelect=Layout.Page.container.find("#reg_req_reason").val();reasonanddesc.reason=ZPeople.Module.MODULE_DATA.attendance.regReasons[reasonSelect]}""!==desc&&(reasonanddesc.desc=desc),(reasonanddesc.desc||reasonanddesc.reason)&&(userInputJson.reasonanddesc=reasonanddesc),userInputJson.oldAttDataForDay=Attendance.Entry.getDayRecordJson.regDetails[originDate],isOldEntriesAvailable||""===userInputJson.fromTime&&""===userInputJson.toTime||(isOldEntriesAvailable=!0);var resultJson=Attendance.Entry.getAttRegJson(userInputJson);"1"===resultJson.errorType?isBothInOutMissingErr.push(originDate):"2"===resultJson.errorType?reasonUnSelectedErr.push(originDate):"3"===resultJson.errorType?isAllEmpty=!1:"4"===resultJson.errorType?descLimitErr.push(originDate):"5"===resultJson.errorType?inValidHour=!0:Object.keys(resultJson).length>0&&(dataObj[originDate]=resultJson)}if(!inValidHour)if("attendance-regularization-myrequests"===Layout.Page.pageId?(param.fdate=$("#"+Layout.Page.pageId+" #ZPAtt_reg_fromDate").val(),$("#"+Layout.Page.pageId+" #ZPAtt_reg_toDate").is(":visible")&&(param.tdate=$("#"+Layout.Page.pageId+" #ZPAtt_reg_toDate").val())):param.fdate=$("#"+Layout.Page.pageId+" #ZPAtt_reg_regDate").val(),"attendance-regularization-myrequests"===Layout.Page.pageId&&($("#"+Layout.Page.pageId+" #attRegTableBody tr[errorDispRow=true]").css("height","44px"),$("#"+Layout.Page.pageId+" #attRegTableBody span.attRegErr").remove()),"list"!=Attendance.Entry.selectedPageView&&"tabler"!=Attendance.Entry.selectedPageView||($("#"+Layout.Page.pageId+" #attRegForm").css("height","44px"),$("#"+Layout.Page.pageId+" #attRegForm").find("#reg_errorMsg").remove(),$("#"+Layout.Page.pageId+" #attRegForm").find("#reg_errorMsg_to").remove()),0===descLimitErr.length){if("attendance-regularization-myrequests"===Layout.Page.pageId){var errorMsg=ZPI18N.getString("zp.selectregreason"),isErrorShown=!1;for(var errDate in reasonUnSelectedErr){isErrorShown=!0;var dateId=reasonUnSelectedErr[errDate].replace(/\//g,"\\/");Attendance.Entry.showErrorMessageForReg(dateId,errorMsg,!0)}if(0==Object.keys(dataObj).length){for(var errDate in errorMsg=ZPI18N.getString("zp.inoutempty"),isBothInOutMissingErr){isErrorShown=!0;dateId=isBothInOutMissingErr[errDate].replace(/\//g,"\\/");Attendance.Entry.showErrorMessageForReg(dateId,errorMsg)}isErrorShown||(isErrorShown=!0,errorMsg=isAllEmpty?ZPI18N.getString("zp.inoutempty"):ZPI18N.getString("zp.nochangesmade"),ModuleComp.Msg.showFailureMsg(errorMsg))}if(isErrorShown)return}else if(0==Object.keys(dataObj).length){errorMsg=isAllEmpty?ZPI18N.getString("zp.inoutempty"):ZPI18N.getString("zp.nochangesmade");if(Object.keys(isBothInOutMissingErr).length>0?errorMsg=ZPI18N.getString("zp.inoutempty"):Object.keys(reasonUnSelectedErr).length>0&&(errorMsg=ZPI18N.getString("zp.selectregreason")),errorMsg)return void ModuleComp.Msg.showFailureMsg(errorMsg)}$(obj).attr("disabled","true"),param.isFromEntryPage="attendance-regularization-myrequests"!==Layout.Page.pageId,param.dataObj=JSON.stringify(dataObj),$.post("/AttendanceAction.zp",param,function(rdata){if($(obj).prop("disabled",!1),rdata.errorDates){if("attendance-regularization-myrequests"===Layout.Page.pageId){for(var errDate in rdata.errorDates){var dateId=errDate.replace(/\//g,"\\/");$("#"+Layout.Page.pageId+" #attRegTableBody #"+dateId).attr("errorDispRow",!0),$("#"+Layout.Page.pageId+" #attRegTableBody #"+dateId).css("height","70px"),$($("#"+Layout.Page.pageId+" #attRegTableBody #"+dateId+" #filoDiv").eq(0).find("div")[0]).append('<span id="reg_errorMsg" class="attRegErr">'+rdata.errorDates[errDate]+"</span>")}return}for(var errDate in rdata.errorDates)$("#"+Layout.Page.pageId+" #attRegForm").attr("errorDispRow",!0),$("#"+Layout.Page.pageId+" #attRegForm").css("height","70px"),$("#"+Layout.Page.pageId+" #attRegForm").find(" #filoDiv").eq(0).find("div").append('<span id="reg_errorMsg" class="ERR MT5">'+rdata.errorDates[errDate]+"</span>")}else if(rdata.errorToDates){if("attendance-regularization-myrequests"===Layout.Page.pageId){for(var errDate in rdata.errorToDates){dateId=errDate.replace(/\//g,"\\/");$("#"+Layout.Page.pageId+" #attRegTableBody #"+dateId).attr("errorDispRow",!0),$("#"+Layout.Page.pageId+" #attRegTableBody #"+dateId).css("height","70px"),$($("#"+Layout.Page.pageId+" #attRegTableBody #"+dateId+" #filoDiv").eq(1).find("div")[0]).append('<span id="reg_errorMsg_to" class="attRegErr">'+rdata.errorToDates[errDate]+"</span>")}return}for(var errDate in rdata.errorToDates)$("#"+Layout.Page.pageId+" #attRegForm").attr("errorDispRow",!0),$("#"+Layout.Page.pageId+" #attRegForm").css("height","70px"),$("#"+Layout.Page.pageId+" #attRegForm").find(" #filoDiv").eq(1).find("div").append('<span id="reg_errorMsg_to" class="ERR MT5">'+rdata.errorToDates[errDate]+"</span>")}else{if(rdata.error)ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.unabletoprocess"));else{if(rdata.message)return void $("#"+Layout.Page.pageId+" #ZPAtt_reg_fromTime").parent().next().next().html(ZPI18N.getString("zp.greaterfromdate"));if("totalHrsExceeded"===rdata.error)return void ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.totalhrsreached"));if("not allowed for this day"===rdata.error)return void ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.notallowedthisday"));$(Attendance.Entry.LayoutId+" #ZPAtt5_tabView").is(":visible")||$(Attendance.Entry.LayoutId+" #ZPAtt5_listView").is(":visible")?rdata.dayList&&($(Attendance.Entry.LayoutId+" #ZPAtt_reg_regDate")[0]&&$(Attendance.Entry.LayoutId+" #ZPAtt_reg_regDate")[0].hasAttribute("disabled")?(Attendance.Entry.allDataList.dayList[$(obj).attr("rowindex")]=rdata.dayList[0],Attendance.Entry.loadToday=!1,Attendance.Entry.getMonthReportForUser(),$(Attendance.Entry.LayoutId+" #ZPAtt5_listView").is(":visible")?Attendance.Entry.showDayList(rdata.dayList,$(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").children()[$(obj).attr("rowindex")]):$(Attendance.Entry.LayoutId+" #ZPAtt5_tabView").is(":visible")&&Attendance.Entry.showDayListTabler(rdata.dayList,$(Attendance.Entry.LayoutId+" #ZPAtt5_tabViewEntries").children()[$(obj).attr("rowindex")]),Attendance.Entry.allDataList.dayList[$(obj).attr("rowindex")].isToday&&Attendance.Dashboard&&Attendance.Dashboard.WeeklyData.getCurWeekData()):Attendance.Entry.getList(Attendance.Entry.selectedView,Attendance.Entry.preMonth)):($(obj).next().trigger("click"),"hh:mm a"!==timeFormat?Attendance.timeFormatIs12hr=!1:Attendance.timeFormatIs12hr=!0,Attendance.Reg.getRequest(!1,!1))}$(obj).next().trigger("click")}})}else ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.scheduledescriptioncounterror",new Array("500")))},showErrorMessageForReg:function(dateId,errorMsg,isReasonErr){var div=" #filoDiv";isReasonErr&&(div=" #reg_req_reasonanddesc1 .col-sm-12.P0"),$("#"+Layout.Page.pageId+" #attRegTableBody #"+dateId).attr("errorDispRow",!0),$("#"+Layout.Page.pageId+" #attRegTableBody #"+dateId).css("height","70px"),$("#"+Layout.Page.pageId+" #attRegTableBody #"+dateId+div).eq(0).find("span.attRegErr").remove(),$($("#"+Layout.Page.pageId+" #attRegTableBody #"+dateId+div).eq(0).find("div")[0]).append('<span class="attRegErr">'+errorMsg+"</span>")},deleteProcessRow:function(){Attendance.Entry.reloadFromWMS=!1;var rowIndex=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_clickedElement").parent().parent().parent().index();$(Attendance.Entry.LayoutId+" #ZPAtt_entry_clickedElement").removeAttr("id");var param={mode:"delAttenEntry",conreqcsr:csrfToken,attDate:Attendance.Entry.allDataList.dayList[rowIndex].ldate};null!==Attendance.Entry.erecno&&(param.erecno=Attendance.Entry.erecno),$.post("/AttendanceAction.zp",param,function(rdata){rdata.curDayBreakDetails&&(Attendance.Entry.curDayBreakDetails=rdata.curDayBreakDetails),rdata.dayList&&(Attendance.Entry.allDataList.dayList[rowIndex]=rdata.dayList[0],Attendance.Entry.showDayListTabler(rdata.dayList,$(Attendance.Entry.LayoutId+" #ZPAtt5_tabViewEntries").children()[rowIndex]),Attendance.Entry.loadToday=!1,Attendance.Entry.allDataList.dayList[rowIndex].isToday&&clearInterval(Attendance.Entry.timer),Attendance.Entry.getMonthReportForUser()),Attendance.Entry.allDataList.dayList[rowIndex].isToday&&Attendance.Dashboard&&Attendance.Dashboard.WeeklyData.getCurWeekData()})},cityNamesList:null,consIpList:function(fromEntryEdit){var entries=Attendance.Entry.allDataList.entries,ipsList=new Array;for(var i in entries){var dayEntry=entries[i];for(var j in dayEntry){var punchinIp=dayEntry[j].punchin_userip,geoLocationIn=dayEntry[j].geoLocation_in;geoLocationIn&&""!==geoLocationIn&&"-"!==geoLocationIn||!punchinIp||-1!==ipsList.indexOf(punchinIp)||null!==Attendance.Entry.cityNamesList&&(null===Attendance.Entry.cityNamesList||Attendance.Entry.cityNamesList[punchinIp])||ipsList.push(punchinIp);var punchoutIp=dayEntry[j].punchout_userip,geoLocationOut=dayEntry[j].geoLocation_out;geoLocationOut&&""!==geoLocationOut&&"-"!==geoLocationOut||!punchoutIp||-1!==ipsList.indexOf(punchoutIp)||null!==Attendance.Entry.cityNamesList&&(null===Attendance.Entry.cityNamesList||Attendance.Entry.cityNamesList[punchoutIp])||ipsList.push(punchoutIp)}}if(""!==(ipsList=ipsList.toString())){var param={mode:"getCityNameByIp",conreqcsr:csrfToken,ipList:ipsList};$.post("/AttendanceAction.zp",param,function(rdata){Attendance.Entry.cityNamesList=$.extend(Attendance.Entry.cityNamesList,rdata.cityNames),fromEntryEdit&&Attendance.Entry.consEntriesPopup($(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").children()[Attendance.Entry.selectedRowIndex])})}else fromEntryEdit&&Attendance.Entry.consEntriesPopup($(Attendance.Entry.LayoutId+" #ZPAtt5_listViewEntries").children()[Attendance.Entry.selectedRowIndex])},getInputType:function(type,isCheckin){var className="PI_desktop",title=ZPI18N.getString("zp.web");return 2===type?(className="PI_phone",title=ZPI18N.getString("zp.phone")):7===type||24===type?(className="PI_fingerprint",title=ZPI18N.getString("zp.accessterminal")):3===type||21===type?(className="PI_vpn",title=ZPI18N.getString("zp.api")):15===type||10===type?(className="PI_like",title=ZPI18N.getString("zp.regularized")):25===type?title=isCheckin?ZPI18N.getString("zp.checkinfromcliq"):ZPI18N.getString("zp.checkoutfromcliq"):26===type?title=isCheckin?ZPI18N.getString("zp.checkinfrommail"):ZPI18N.getString("zp.checkoutfrommail"):27===type?title=isCheckin?ZPI18N.getString("zp.checkinfromconnect"):ZPI18N.getString("zp.checkoutfromconnect"):28===type?title=isCheckin?ZPI18N.getString("zp.checkinfromprojects"):ZPI18N.getString("zp.checkoutfromprojects"):30===type?(className="PI_phone",title=ZPI18N.getString("zp.kiosk")):31===type?title=ZPI18N.getString("zp.kiosk"):41===type&&(title=ZPI18N.getString("zp.autocheckouttype")),{className:className,title:title}},reLoadAttDetails:function(){if(document.removeEventListener("visibilitychange",Attendance.Entry.reLoadAttDetails),Attendance.Entry.reloadFromWMS){if(null!=Layout.Page.pageId){var ulrMode=Layout.Page.pageId;-1!==ulrMode.indexOf("attendance-entry-summary")&&null===Attendance.Entry.erecno&&ZPeople.reloadListViewAtt(ulrMode),Attendance.Entry.isMyspace()&&ZPeople.Module.MODULE_DATA.attendance&&ZPeople.Module.MODULE_DATA.attendance.isAttendanceEnabled?TAMSUtil.Attendance.getCurrDayStatus():ZPeople.reloadDashAttData||(ZPeople.reloadDashAttData=!0)}}else Attendance.Entry.reloadFromWMS=!0}},Attendance.Import={showImport:function(){ZPeople.BSModal.show($("#"+Layout.Page.pageId+" #ZPAtt_entry_importPopup")),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importSuccMsg").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importSuccvalues").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_import").parent().parent().removeAttr("class"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_import").fadeIn(300),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_impEx").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importFileConf").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMap").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInput").val(""),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importDesc").after($(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInputCont").show()),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInputCont span").text(ZPI18N.getString("zp.importfile")),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInputCont").attr("class","btn btn-primary ZPbtnDefault"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importNext").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importPrevious").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importHeader li").first().attr("class","active"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importHeader li").last().removeAttr("class"),Layout.Page.container.find("#ZPAtt_entry_importPopup .modal-body").find("#zp_page_loading").remove(),Layout.Page.container.find("#ZPAtt_entry_importPopup .modal-body").children().show(),Attendance.Import.getPendingImport(),Layout.Page.container.find("#importErrDiv").hide()},onInputChange:function(){var fileName=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInput").val();$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importProgress").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importProgress").next().show(),fileName=fileName.replace("C:\\fakepath\\",""),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importFName").text(fileName),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importSuccMsg").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importSuccvalues").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importProgress").after($(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInputCont")),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInputCont span").text(ZPI18N.getString("zp.removeandnew")),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInputCont").attr("class","btn btn-default ZPbtnDefault");var extn=fileName.split(".").pop();"xls"===extn||"csv"===extn?($(Attendance.Entry.LayoutId+" #ZPAtt_entry_importFName").next().attr("class","IC-rou-tik ML5 filetck"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importNext").fadeIn(300),Layout.Page.container.find("#ZPAtt_entry_importNext").attr("disabled",!1),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importNext").off("click").on("click",function(){Attendance.Import.submitImport()})):($(Attendance.Entry.LayoutId+" #ZPAtt_entry_importFName").next().attr("class","IC-r-close ML5 PR S18 red"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importNext").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInput").val(""),""===$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importFName").text()&&$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importFName").text(ZPI18N.getString("zp.choosefile"))),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_import").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_impEx").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importFileConf").fadeIn(300),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMap").hide()},submitImport:function(){$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importNext").off("click"),Attendance.Import.ProgressBarWidth=0,$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importProgress").next().hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importProgress div").width(Attendance.Import.ProgressBarWidth+"%").parent().show(),Attendance.Import.showProgress();var form=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInput")[0].form;""!==$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importInput").val()&&(Layout.Page.container.find("#ZPAtt_entry_importNext").attr("disabled",!0),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importFormCsrf").val(csrfToken),form.action="AttendanceImport.zp",form.submit())},ProgressBarWidth:0,showProgress:function(){$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importProgress div").width(Attendance.Import.ProgressBarWidth+"%"),Attendance.Import.ProgressBarWidth+=2,Attendance.Import.ProgressBarWidth<=99&&setTimeout(Attendance.Import.showProgress,1)},getPendingImport:function(){var pendingMsg=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMsg"),manBrk=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_impEx");pendingMsg.parent().hide();var param={mode:"getPendingImportInfo",conreqcsr:csrfToken};$.post("/AttendanceAction.zp",param,function(rdata){"empty"===rdata.tableInfo.tableHeaders?(pendingMsg.off("click"),pendingMsg.html(""),pendingMsg.parent().hide()):(pendingMsg.attr("class","blu CP"),pendingMsg.off("click").on("click",function(){Attendance.Import.showMapping(rdata.tableInfo)}),pendingMsg.html(rdata.tableInfo.recordCount+" "+ZPI18N.getString("zp.recordspending")),pendingMsg.parent().fadeIn(300)),!1===rdata.tableInfo.isManualBreak?manBrk.find("[id*=manSpec]").hide():manBrk.find("[id*=manSpec]").show(),manBrk.fadeIn(300)})},showMapping:function(obj){Layout.Page.container.find("#ZPAtt_entry_importNext").attr("disabled",!1),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_import").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_impEx").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importFileConf").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMap").fadeIn(300),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importPrevious").fadeIn(300),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importNext").fadeIn(300),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importHeader li").last().attr("class","active"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importNext").off("click").on("click",function(){Attendance.Import.submitMapping(obj)}),-1===Attendance.Entry.LayoutId.indexOf("attendance-entry-balanceotview")&&-1===Attendance.Entry.LayoutId.indexOf("attendance-entry-otview")||$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importNext").off("click").on("click",function(){Attendance.Import.submitMappingBalOrRep(obj.fileFormat)});var rArray=obj.tableHeaders,res="<option value='None' selected='selected'>-- "+ZPI18N.getString("zp.select")+" --</option>";for(var i in rArray)res+="<option value='"+i+"'>"+rArray[i]+"</option>";if($(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMap select").select2(),-1===Attendance.Entry.LayoutId.indexOf("attendance-entry-balanceotview")&&-1===Attendance.Entry.LayoutId.indexOf("attendance-entry-otview"))for(var i in"csv"!==obj.fileFormat?$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importDateFor label").html(ZPI18N.getString("zp.dateformat")):$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importDateFor label").html("<font>"+ZPI18N.getString("zp.dateformat")+"</font>"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_breakCol").hide(),!0===obj.isManualBreak&&$(Attendance.Entry.LayoutId+" #ZPAtt_entry_breakCol").show(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importDateFor select").select2("val","0"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importIds select").html(res),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importCheckIn select").html(res),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importCheckOut select").html(res),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_breakCol select").html(res),rArray)-1!==rArray[i].toLowerCase().indexOf("in")?$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importCheckIn select").select2("val",i):-1!==rArray[i].toLowerCase().indexOf("out")?$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importCheckOut select").select2("val",i):-1!==rArray[i].toLowerCase().indexOf("brk")?$(Attendance.Entry.LayoutId+" #ZPAtt_entry_breakCol select").select2("val",i):-1===rArray[i].toLowerCase().indexOf("employee")&&-1===rArray[i].toLowerCase().indexOf("id")&&-1===rArray[i].toLowerCase().indexOf("user")&&-1===rArray[i].toLowerCase().indexOf("map")||$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importIds select").select2("val",i);else $(Attendance.Entry.LayoutId+" #ZPAtt_entry_balRep_importIds select").html(res),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_balRep_importAdjHrs select").html(res),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_balRep_importPaidHrs select").html(res);$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMsg").off("click"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMsg").attr("class","blu"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMsg").parent().fadeIn(300),obj.error&&"rowExceededLimit"===obj.error?(ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.importcntexceederror"),!0),Layout.Page.container.find("#ZPAtt_entry_importNext").attr("disabled",!0),Layout.Page.container.find("#ZPAtt_entry_importMsg").text("")):void 0!==obj.recordCount?$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMsg").text(obj.recordCount+" "+ZPI18N.getString("zp.recordsfound")):$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMsg").text("0 "+ZPI18N.getString("zp.recordsfound")),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMap select").select2()},submitMapping:function(obj){Attendance.Entry.reloadFromWMS=!1;var si_Id=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importIds select")[0].selectedIndex,si_punchIn=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importCheckIn select")[0].selectedIndex,si_punchOut=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importCheckOut select")[0].selectedIndex,si_breakCol=0;if(!0===obj.isManualBreak&&(si_breakCol=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_breakCol select")[0].selectedIndex),0!==si_Id&&0!==si_punchIn&&0!==si_punchOut){var param={mode:"attImportMapping",mailId:si_Id-1,punchInId:si_punchIn-1,punchOutId:si_punchOut-1,descId:-1,conreqcsr:csrfToken};"0"!==$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importDateFor select").val()&&(param.dateFormat=$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importDateFor select").val()),0!==si_breakCol&&(param.breakCol=si_breakCol-1),"csv"!==obj.fileFormat||param.dateFormat?(Layout.Page.container.find("#ZPAtt_entry_importNext").attr("disabled",!0),Layout.Page.container.find("#ZPAtt_entry_importPopup .modal-body").children().hide(),Layout.Page.container.find("#ZPAtt_entry_importPopup .modal-body").append(ZPeople.LOADING_HTML),$.post("/AttendanceAction.zp",param,function(resultData){if(Layout.Page.container.find("#ZPAtt_entry_importPopup .modal-body").find("#zp_page_loading").remove(),Layout.Page.container.find("#ZPAtt_entry_importPopup .modal-body").children().show(),resultData.msg){if($(Attendance.Entry.LayoutId+" #ZPAtt_entry_import").parent().parent().attr("class","ZPImfrm ZPRecList"),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMap").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importMsg").parent().hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importSuccMsg").fadeIn(300),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importSuccvalues").fadeIn(300),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importSuccvalues span")[1].innerHTML="0",resultData.msg.successCount&&($(Attendance.Entry.LayoutId+" #ZPAtt_entry_importSuccvalues span")[1].innerHTML=resultData.msg.successCount),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importSuccvalues span")[0].innerHTML="0",resultData.msg.totalCount&&($(Attendance.Entry.LayoutId+" #ZPAtt_entry_importSuccvalues span")[0].innerHTML=resultData.msg.totalCount),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importPrevious").hide(),$(Attendance.Entry.LayoutId+" #ZPAtt_entry_importNext").hide(),Attendance.Entry.getList("week","zero"),resultData.msg.emptyEmpIds.length>0||resultData.msg.skippedEmpInfo.length>0||resultData.msg.errorInfo.length>0){var rowNumber=0;if(Layout.Page.container.find("#importErrDiv").show(),Layout.Page.container.find("#importErrTBody").find("tr").remove(),resultData.msg.skippedEmpInfo.length>0){for(length=resultData.msg.skippedEmpInfo.length,Layout.Page.container.find("#importErrTBody").append($("<tr class='ZPLRow' ><td colspan=2 class='err-lst'>"+ZPI18N.getString("zp.invalidempinfo")+"<ul></ul></td></tr>")),i=0;i<length;i++)$($(Layout.Page.container.find("#importErrTBody").find(".ZPLRow")[rowNumber]).find("ul")).append("<li>"+$("<div/>").text(resultData.msg.skippedEmpInfo[i]).html()+"</li>");rowNumber++}if(resultData.msg.emptyEmpIds.length>0){for(length=resultData.msg.emptyEmpIds.length,Layout.Page.container.find("#importErrTBody").append($("<tr class='ZPLRow' ><td colspan=2 class='err-lst'>"+ZPI18N.getString("zp.emptyempids")+"<ul></ul></td></tr>")),i=0;i<length;i++)$($(Layout.Page.container.find("#importErrTBody").find(".ZPLRow")[rowNumber]).find("ul")).append("<li>"+resultData.msg.emptyEmpIds[i]+"</li>");rowNumber++}resultData.msg.errorInfo.length>0&&resultData.msg.errorInfo.forEach(function(obj,index){for(Layout.Page.container.find("#importErrTBody").append($("<tr class='ZPLRow'><td class='P0I W80'>Row "+obj[0]+" :</td><td></td></tr>")),i=1;i<obj.length;i++)$($(Layout.Page.container.find("#importErrTBody").find(".ZPLRow")[index+rowNumber]).find("td")[1]).append(obj[i]+"<br>")})}}else if(resultData.fail||resultData.error){var failMsg=resultData.fail?resultData.fail:ZPI18N.getString("zp.unabletoprocess");ModuleComp.Msg.showFailureMsg(failMsg),Layout.Page.container.find("#ZPAtt_entry_importNext").attr("disabled",!1),Layout.Page.container.find("#ZPAtt_entry_importNext").off("click").on("click",function(){Attendance.Import.submitMapping(obj)})}})):ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.choosereqcolumns"))}else ModuleComp.Msg.showFailureMsg(ZPI18N.getString("zp.choosereqcolumns"))}},Attendance.CustomFireScroll={TRIGGERED:!1,FIRESCROLL_EVENT:{},getCurrentMode:function(){return Layout.Page.currentmode.replace(/\//g,"-")},init:function(callbackFunc,obj){"string"==typeof obj&&(obj=$(obj)),"object"==typeof obj&&obj.scroll(function(){if(Attendance.CustomFireScroll.getFireScrollPropertie().triggered)return!1;var actualDivHeight=this.scrollHeight-100;$(this).scrollTop()+$(this).height()>actualDivHeight&&(Attendance.CustomFireScroll.getFireScrollPropertie().triggered=!0,callbackFunc())})},getFireScrollPropertie:function(){var mode=Attendance.CustomFireScroll.getCurrentMode();return Attendance.CustomFireScroll.initializeMode(mode),Attendance.CustomFireScroll.FIRESCROLL_EVENT[mode]},setRecordCount:function(recordCount){Attendance.CustomFireScroll.getFireScrollPropertie().count=recordCount},increaseRecordCount:function(recordCount){Attendance.CustomFireScroll.getFireScrollPropertie().count+=recordCount},setParam:function(paramName,paramVal){Attendance.CustomFireScroll.getFireScrollPropertie()[paramName]=paramVal},initializeMode:function(mode){void 0===Attendance.CustomFireScroll.FIRESCROLL_EVENT[mode]&&(Attendance.CustomFireScroll.FIRESCROLL_EVENT[mode]={},Attendance.CustomFireScroll.FIRESCROLL_EVENT[mode].triggered=!1)},reset:function(){Attendance.CustomFireScroll.getFireScrollPropertie().triggered=!1}},Attendance.Audit={fromEntry:!1,init:function(isFromEntry){Attendance.Audit.fromEntry="true"==isFromEntry,Attendance.Audit.fetchAuditData(void 0,!0)},dateFilterChange:function(){var modal=landingPage.find("#auditHistory"),date=ZPeopleComponents.datefield(modal.find("#ZPAtt_Audit_FilDate"))?ZPeopleComponents.datefield(modal.find("#ZPAtt_Audit_FilDate")).getValue().dateString:Attendance.Audit.auditData.auditDate;Attendance.Audit.fetchAuditData(date)},auditData:null,fetchAuditData:function(date,isFromInit){var param={};param.conreqcsr=csrfToken,param.mode="getAuditHistory",date?param.auditDate=date:Attendance.Entry.auditDate&&(param.auditDate=moment(Attendance.Entry.auditDate,"YYYY-MM-DD").format(dateFmt.toUpperCase()),Layout.Page.container.find("#ZPAtt_Audit_FilDate").val(param.auditDate)),null!=Layout.Page.container.find("#ZPAtt_Audit_FilActionType").val()&&"0"!==Layout.Page.container.find("#ZPAtt_Audit_FilActionType").val()&&(param.actionType=Layout.Page.container.find("#ZPAtt_Audit_FilActionType").val()),1==Layout.Page.container.find("#ZPAtt_Audit_FilPunchType").length&&null!=Layout.Page.container.find("#ZPAtt_Audit_FilPunchType").val()&&"0"!==Layout.Page.container.find("#ZPAtt_Audit_FilPunchType").val()&&(param.punchType=Layout.Page.container.find("#ZPAtt_Audit_FilPunchType").val()),isFromInit?Attendance.Entry.erecforReport&&(param.erecno=Attendance.Entry.erecforReport):param.erecno=Attendance.Audit.auditData.erecno,Layout.Page.container.find('div[id^="ZPAtt_Audit_ActivityBody_"]').remove(),Layout.Page.container.find("#ZPAtt_Audit_NoData").hide(),Attendance.Break.appendLoader(Layout.Page.container.find("#ZPAtt_AuditContent"),!0),$.post("/AttendanceViewAction.zp",param,function(result){Attendance.Audit.auditData=result,Attendance.Audit.constructAuditPage()})},filterSearch:function(){var param={};param.conreqcsr=csrfToken,param.mode="getAuditHistory",Att_Common_Operations.isFilterOpen()&&Att_Common_Operations.changeFilterClass(!0);var modal=landingPage.find("#auditHistory");param.auditDate=ZPeopleComponents.datefield(modal.find("#ZPAtt_Audit_FilDate"))?ZPeopleComponents.datefield(modal.find("#ZPAtt_Audit_FilDate")).getValue().dateString:Attendance.Audit.auditData.auditDate,param.erecno=ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilEmployee"))?ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilEmployee")).getValue():Attendance.Audit.auditData.erecno,ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilActionType"))&&0!=ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilActionType")).getValue()&&""!=ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilActionType")).getValue()&&(param.actionType=ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilActionType")).getValue()),ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilPunchType"))&&0!=ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilPunchType")).getValue()&&""!=ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilPunchType")).getValue()&&(param.punchType=ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilPunchType")).getValue()),Layout.Page.container.find('div[id^="ZPAtt_Audit_ActivityBody_"]').remove(),Layout.Page.container.find("#ZPAtt_Audit_NoData").hide(),Attendance.Break.appendLoader(Layout.Page.container.find("#ZPAtt_AuditContent"),!0),$.post("/AttendanceViewAction.zp",param,function(result){Layout.Page.container.find("#ZPAtt_Audit_FilDate").val(result.auditDate),Attendance.Audit.auditData=result,Attendance.Audit.constructAuditPage(!0)})},resetInputs:function(){var filterLayout=landingPage.find(".zpl_fltr");ZPeopleComponents.select(filterLayout.find("#ZPAtt_Audit_FilActionType"))&&ZPeopleComponents.select(filterLayout.find("#ZPAtt_Audit_FilActionType")).deselectAllOptions(),ZPeopleComponents.select(filterLayout.find("#ZPAtt_Audit_FilPunchType"))&&ZPeopleComponents.select(filterLayout.find("#ZPAtt_Audit_FilPunchType")).deselectAllOptions(),Attendance.Audit.filterSearch()},ADD:1,EDIT:2,DELETE:3,REGDELETE_READD:4,CANCEL:5,lastModifiedDate:"",destroyZComp:function(){var modal=landingPage.find("#auditHistory");ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilActionType"))&&ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilActionType")).destroy(),ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilPunchType"))&&ZPeopleComponents.select(modal.find("#ZPAtt_Audit_FilPunchType")).destroy(),ZPeopleComponents.datefield(modal.find("#ZPAtt_Audit_FilDate"))&&ZPeopleComponents.datefield(modal.find("#ZPAtt_Audit_FilDate")).destroy()},constructAuditPage:function(isFromFilter){Attendance.Break.appendLoader(Layout.Page.container.find("#ZPAtt_AuditContent"),!1);var modal,html="";if(isFromFilter)html='<div class="fix_day" style="top: 0;"><div>'+Attendance.Audit.lastModifiedDate+"</div></div>",(modal=landingPage.find("#auditHistory")).find('div[id^="ZPAtt_Audit_ActivityBody_"]').remove();else{html='<div class="zpl_mcnt "><div class="zpl_btnmnu">',Attendance.Audit.fromEntry||(html+='<div class="zpl_secn zpl_idivingrp w400"><div><div><label>'+ZPI18N.getString("zp.checkinoutaudit")+"</label></div></div>",html+='<div><div class="zpl_w210"><input id="ZPAtt_Audit_FilDate"/></div></div></div>'),html+='<div class="zpl_rgt"><i class="zpl_ibg PI_fltr"  title="'+ZPI18N.getString("zp.filter")+'" onclick ="Att_Common_Operations.changeFilterClass(true);"></i></div></div>',html+='<div class="zpl_crd"><div class="zpl_alogouter sticky" id="ZPAtt_AuditContent"><div class="fix_day" style="top: 0;"><div>'+Attendance.Audit.auditData.auditDate+"</div></div>",html+='<div id="ZPAtt_Audit_NoData" style="display: none" class="zpl_Emptydata"> <div class="zpl_emptimg zp_nd_noaudit">',html+="</div><h5>"+ZPI18N.getString("zp.noaudittodisplay")+"</h5></div>",html+="</div>",html+="</div>",html+=Attendance.Audit.getFilterHtml(),modal=ModuleComp.Modal.setup({id:"auditHistory",type:1,header:ZPI18N.getString("zp.audithistory"),body:html,backdrop:!1,customBodyAttr:{id:"auditHistory_cards"},closeonEsc:!0,modalClass:"zpl_mlg",hiddenCallback:Attendance.Audit.destroyZComp,disableFooter:!0});var options=[];options.push({label:ZPI18N.getString("zp.all"),value:"0"}),options.push({label:ZPI18N.getString("zp.add"),value:"1"}),options.push({label:ZPI18N.getString("zp.edit"),value:"2"}),options.push({label:ZPI18N.getString("zp.cancel"),value:"5"}),options.push({label:ZPI18N.getString("zp.delete"),value:"3"});var filterLayout=modal.find(".zpl_fltr"),appendToEle=modal.find("#ZPAtt_Audit_Filter");ZPeopleComponents.select(filterLayout.find("#ZPAtt_Audit_FilActionType")).setAttributes({options:options,multiple:!1,dropdownList:{appendTo:appendToEle},placeholder:ZPI18N.getString("zp.select")});var breakDispDetails=Attendance.Entry.allDataList.breakList.breakDispDetails;if(isRegConfigured||isOnDutyConfigured||isPermissionConfigured||breakDispDetails.isBreakConf){var typeOptions=[];typeOptions.push({label:ZPI18N.getString("zp.all"),value:"0"}),typeOptions.push({label:ZPI18N.getString("zp.checkinandcheckout"),value:"1"}),breakDispDetails.isBreakConf&&typeOptions.push({label:ZPI18N.getString("zp.break"),value:"2"}),isRegConfigured&&typeOptions.push({label:ZPI18N.getString("zp.regularization"),value:"3"}),isPermissionConfigured&&typeOptions.push({label:ZPI18N.getString("zp.attpermission"),value:"4"}),isOnDutyConfigured&&typeOptions.push({label:ZPI18N.getString("zp.onduty"),value:"5"}),ZPeopleComponents.select(filterLayout.find("#ZPAtt_Audit_FilPunchType")).setAttributes({options:typeOptions,multiple:!1,dropdownList:{appendTo:appendToEle},placeholder:ZPI18N.getString("zp.select")})}if(!Attendance.Audit.fromEntry){var dateOptions={calendarIcon:!0,calendarIconUIType:"button",showPickerOnFocus:!0,format:dateFmt,picker:!0,datestep:0,spinButtons:"none",clearButton:"none",pickerOptions:{appendTo:"#auditHistory_cards"},pickerclose:Attendance.Audit.dateFilterChange};ZPeopleComponents.datefield(modal.find("#ZPAtt_Audit_FilDate"),dateOptions),ZPeopleComponents.datefield(modal.find("#ZPAtt_Audit_FilDate")).setValue(Attendance.Audit.auditData.auditDate)}}if(0!=Attendance.Audit.auditData.auditArr.length){Attendance.Audit.lastModifiedDate="",Attendance.Audit.uiLastModifiedDate="";for(var index=0;index<Attendance.Audit.auditData.auditArr.length;index++){var auditObj=Attendance.Audit.auditData.auditArr[index];""==Attendance.Audit.lastModifiedDate?(Attendance.Audit.lastModifiedDate=auditObj.modifiedDate,Attendance.Audit.uiLastModifiedDate=auditObj.uiConstructModifiedDate,Attendance.Audit.constructAuditStructure(modal)):Attendance.Audit.lastModifiedDate!=auditObj.modifiedDate&&(Attendance.Audit.lastModifiedDate=auditObj.modifiedDate,Attendance.Audit.uiLastModifiedDate=auditObj.uiConstructModifiedDate,Attendance.Audit.constructAuditStructure(modal)),auditObj.actionType==Attendance.Audit.ADD?Attendance.Audit.appendAddAuditType(auditObj,modal):auditObj.actionType==Attendance.Audit.EDIT?Attendance.Audit.appendEditAuditType(auditObj,modal):auditObj.actionType==Attendance.Audit.DELETE||auditObj.actionType==Attendance.Audit.CANCEL?Attendance.Audit.appendDeleteAuditType(auditObj,modal):auditObj.actionType==Attendance.Audit.REGDELETE_READD&&Attendance.Audit.appendAddAuditType(auditObj,modal)}modal.find('div[id^="ZPAtt_Audit_ActivityBody_"]').show(),modal.find("#ZPAtt_Audit_NoData").hide()}else Layout.Page.container.find("#ZPAtt_Audit_NoData").show()},getFilterHtml:function(){var html='<div class="zpl_fltr"><div><div class="zpl_fltrhd"><h5>'+ZPI18N.getString("zp.filter")+'</h5><i class="PI_cls" onclick="Att_Common_Operations.changeFilterClass(true);" title="'+ZPI18N.getString("zp.close")+'"></i></div></div>';html+='<div class="zpl_fltrcnt" id="ZPAtt_Audit_Filter"><div><div class="zpl_fltclps fltopn"><div class="zpl_fltrlst">',html+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.actiontype")+'</label></div><div><select id="ZPAtt_Audit_FilActionType"></select></div></div>';var breakDispDetails=Attendance.Entry.allDataList.breakList.breakDispDetails;return(isRegConfigured||isOnDutyConfigured||isPermissionConfigured||breakDispDetails.isBreakConf)&&(html+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.type")+'</label></div><div><select id="ZPAtt_Audit_FilPunchType"></select></div></div>'),html+='</div></div></div></div><div><button id="addPolicy1" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="Attendance.Audit.filterSearch()">'+ZPI18N.getString("zp.apply")+'</button> <button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="Attendance.Audit.resetInputs()">'+ZPI18N.getString("zp.reset")+"</button></div></div>"},constructAuditStructure:function(modal){var html='<div class="zpl_alogcont" id="ZPAtt_Audit_ActivityBody_'+Attendance.Audit.uiLastModifiedDate+'" style="display: none">';html+='<div class="zpl_alogdetl" id="ZPAtt_Audit_ActivityBodyCont_'+Attendance.Audit.uiLastModifiedDate+'">';var date=Attendance.Audit.lastModifiedDate;Attendance.Entry.allDataList&&Attendance.Entry.allDataList.currDate&&Attendance.Entry.allDataList.currDate.todayDate&&(date=Attendance.Audit.lastModifiedDate!=Attendance.Entry.allDataList.currDate.todayDate?Attendance.Audit.lastModifiedDate:ZPI18N.getString("zp.today")),html+='<div class="cur_day" id="ZPAtt_Audit_Date"><span>'+date+"</span></div>",html+="</div></div>",modal.find("#ZPAtt_AuditContent").append(html)},appendAddAuditType:function(auditObj,modal){var html='<div class="event add"><span class="tline">'+auditObj.modifiedTime+"</span>";if(html+="<div>"+auditObj.message+'<i class="'+Attendance.Audit.getInputTypeClass(auditObj.displayType)+'"></i>',html+=Attendance.Audit.constructApprovalRecordView(auditObj),html+="</div>",auditObj.dataArr){html+='<div class="zpl_attLgentry">';for(var index=0;index<auditObj.dataArr.length;index++){var indAudit=auditObj.dataArr[index];5==auditObj.inputType||33==auditObj.inputType||10==auditObj.inputType||15==auditObj.inputType||22==auditObj.inputType||23==auditObj.inputType?(html+='<div class="zpl_attLgentryrw">',indAudit.fromTime&&(html+='<div class="zpl_attpnchdt in"><span class="S12 dgry">'+ZPI18N.getString("zp.checkin")+"</span>",html+=Attendance.Audit.getAttDateTimeHtml(indAudit,1),html+="</div>"),indAudit.toTime&&(html+='<div class="zpl_attpnchdt out"><span class="S12 dgry">'+ZPI18N.getString("zp.checkout")+"</span>",html+=Attendance.Audit.getAttDateTimeHtml(indAudit,2),html+="</div>"),html+="</div>"):32==auditObj.inputType?(html+='<div class="zpl_attLgentryrw">',null==indAudit.daysTaken&&null==indAudit.session?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.duration")+"</span>",html+=indAudit.timeDiff+ZPI18N.getString("zp.lms.hours"),html+="</div>",html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.fromtotime")+"</span>",html+=indAudit.fromTime+"-",html+=indAudit.toTime,html+="</div>"):0==indAudit.daysTaken?(html+="<div><span>"+ZPI18N.getString("zp.duration")+"</span><br>",html+="<span><b>"+ZPI18N.getString("zp.fullday")+"</b></span>",html+="</div>"):1==indAudit.daysTaken?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.duration")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.halfday")+"</b></span>",html+="</div>",1==indAudit.session?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.firsthalf")+"</b></span>",html+="</div>"):(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.secondhalf")+"</b></span>",html+="</div>")):2==indAudit.daysTaken&&(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.duration")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.quarterday")+"</b></span>",html+="</div>",1==indAudit.session?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.firstquarter")+"</b></span>",html+="</div>"):2==indAudit.session?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.secondquarter")+"</b></span>",html+="</div>"):3==indAudit.session?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.thirdquarter")+"</b></span>",html+="</div>"):(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.fourthquarter")+"</b></span>",html+="</div>")),html+="</div>"):(html+='<div class="zpl_attLgentryrw">',indAudit.fromTime&&(html+='<div class="zpl_attpnchdt in"><span class="S12 dgry">'+ZPI18N.getString("zp.from")+"</span>",html+=Attendance.Audit.getAttDateTimeHtml(indAudit,1),html+="</div>"),indAudit.toTime&&(html+='<div class="zpl_attpnchdt out"><span class="S12 dgry">'+ZPI18N.getString("zp.to")+"</span>",html+=Attendance.Audit.getAttDateTimeHtml(indAudit,2),html+="</div>"),html+="</div>")}html+="</div>"}html+="</div>",modal.find("#ZPAtt_Audit_ActivityBodyCont_"+Attendance.Audit.uiLastModifiedDate).append(html)},appendEditAuditType:function(auditObj,modal){var html='<div class="event edit"><span class="tline">'+auditObj.modifiedTime+"</span>";html+="<div>"+auditObj.message+'<i class="'+Attendance.Audit.getInputTypeClass(auditObj.displayType)+'"></i>',html+=Attendance.Audit.constructApprovalRecordView(auditObj),html+="</div>",html+='<div class="zpl_attLgentry"><div class="zpl_attLgentryrw"><div class="zpl_attpnchdt P0I"><span>'+ZPI18N.getString("zp.preventry")+"</span></div>",html+='<div class="zpl_attpnchdt P0I"><span>'+ZPI18N.getString("zp.newentry")+"</span></div></div>";for(var index=0;index<auditObj.dataArr.length;index++){var indAudit=auditObj.dataArr[index];indAudit.newFromTime&&(html+='<div class="zpl_attLgentryrw"><div class="zpl_attpnchdt in"><span class="S12 dgry">'+ZPI18N.getString("zp.from")+"</span>",html+=Attendance.Audit.getAttDateTimeHtml(indAudit,1),html+='<div class="arwto"><i class="IC-ar-rgt gry"></i></div></div>',html+='<div class="zpl_attpnchdt in"><span class="S12 dgry">'+ZPI18N.getString("zp.from")+"</span>",html+=Attendance.Audit.getAttDateTimeHtml(indAudit,3),html+="</div></div>"),indAudit.newToTime&&(html+='<div class="zpl_attLgentryrw"><div class="zpl_attpnchdt out"><span class="S12 dgry">'+ZPI18N.getString("zp.to")+"</span>",html+=Attendance.Audit.getAttDateTimeHtml(indAudit,2),html+='<div class="arwto"><i class="IC-ar-rgt gry"></i></div></div>',html+='<div class="zpl_attpnchdt out"><span class="S12 dgry">'+ZPI18N.getString("zp.to")+"</span>",html+=Attendance.Audit.getAttDateTimeHtml(indAudit,4),html+="</div></div>")}html+="</div></div>",modal.find("#ZPAtt_Audit_ActivityBodyCont_"+Attendance.Audit.uiLastModifiedDate).append(html)},appendDeleteAuditType:function(auditObj,modal){var html='<div class="event dlt"><span class="tline">'+auditObj.modifiedTime+"</span>";if(html+="<div>"+auditObj.message+'<i class="'+Attendance.Audit.getInputTypeClass(auditObj.displayType)+'"></i>',html+=Attendance.Audit.constructApprovalRecordView(auditObj),html+="</div>",auditObj.dataArr)for(var index=0;index<auditObj.dataArr.length;index++){var indAudit=auditObj.dataArr[index];html+='<div class="zpl_attLgentry"><div class="zpl_attLgentryrw">',32==auditObj.inputType?null==indAudit.daysTaken&&null==indAudit.session?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.duration")+"</span>",html+=indAudit.timeDiff+ZPI18N.getString("zp.lms.hours"),html+="</div>",html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.fromtotime")+"</span>",html+=indAudit.fromTime+"-",html+=indAudit.toTime,html+="</div>"):0==indAudit.daysTaken?(html+="<div><span>"+ZPI18N.getString("zp.duration")+"</span><br>",html+="<span><b>"+ZPI18N.getString("zp.fullday")+"</b></span>",html+="</div>"):1==indAudit.daysTaken?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.duration")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.halfday")+"</b></span>",html+="</div>",1==indAudit.session?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.firsthalf")+"</b></span>",html+="</div>"):(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.secondhalf")+"</b></span>",html+="</div>")):2==indAudit.daysTaken&&(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.duration")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.quarterday")+"</b></span>",html+="</div>",1==indAudit.session?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.firstquarter")+"</b></span>",html+="</div>"):2==indAudit.session?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.secondquarter")+"</b></span>",html+="</div>"):3==indAudit.session?(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.thirdquarter")+"</b></span>",html+="</div>"):(html+='<div class="zpl_attdrtn"><span class="S12 dgry">'+ZPI18N.getString("zp.lms.session")+"</span>",html+="<span><b>"+ZPI18N.getString("zp.fourthquarter")+"</b></span>",html+="</div>")):(indAudit.fromTime&&(html+='<div class="zpl_attpnchdt in"><span class="S12 dgry">'+ZPI18N.getString("zp.checkin")+"</span>",html+=Attendance.Audit.getAttDateTimeHtml(indAudit,1),html+="</div>"),indAudit.toTime&&(html+='<div class="zpl_attpnchdt out"><span class="S12 dgry">'+ZPI18N.getString("zp.checkout")+"</span>",html+=Attendance.Audit.getAttDateTimeHtml(indAudit,2),html+="</div>")),html+="</div></div>"}html+="</div>",modal.find("#ZPAtt_Audit_ActivityBodyCont_"+Attendance.Audit.uiLastModifiedDate).append(html)},constructApprovalRecordView:function(auditObj){var html="";return auditObj.permissionRecordId&&auditObj.permissionFormId?html+='<a class="view" onclick="permission.getPermissionApprovalDetails(\''+auditObj.permissionFormId+"','"+auditObj.permissionRecordId+"', Att_Common_Operations.approvalCloseCallBack)\">"+ZPI18N.getString("zp.viewRecord")+"</a>":auditObj.regularizationRecordId&&auditObj.regularizationFormId?html+='<a class="view" onclick="regularization_operation.getAttendanceRegDetails(\''+auditObj.regularizationFormId+"','"+auditObj.regularizationRecordId+"', Att_Common_Operations.approvalCloseCallBack)\">"+ZPI18N.getString("zp.viewRecord")+"</a>":auditObj.onDutyRecordId&&auditObj.onDutyFormId&&(html+='<a class="view" onclick="onduty.getAttendanceODDetails(\''+auditObj.onDutyFormId+"','"+auditObj.onDutyRecordId+"', Att_Common_Operations.approvalCloseCallBack)\">"+ZPI18N.getString("zp.viewRecord")+"</a>"),html},getAttDateTimeHtml:function(indAudit,punchType){var html="",time=indAudit.fromTime,date=indAudit.fromDate;if(2==punchType?(time=indAudit.toTime,date=indAudit.toDate):3==punchType?(time=indAudit.newFromTime,date=indAudit.newFromDate):4==punchType&&(time=indAudit.newToTime,date=indAudit.newToDate),void 0===time||""===time)return"<span>--</span>";var timeWithDate=!1;date==Attendance.Audit.auditData.auditDate&&date==Attendance.Audit.lastModifiedDate||(timeWithDate=!0);var timeSuffix="";if(-1!=time.indexOf(" AM")){var index=time.indexOf(" AM");timeSuffix=time.substring(index),time=time.substring(0,index)}if(-1!=time.indexOf(" PM")){index=time.indexOf(" PM");timeSuffix=time.substring(index),time=time.substring(0,index)}return html+=timeWithDate?"<span><b>"+date+"</b></span><span><b>"+time+"</b>"+timeSuffix+"</span>":"<span><b>"+time+"</b>"+timeSuffix+"</span>"},WEB:1,MOBILE:2,INTEGRATION:3,getInputTypeClass:function(displayType){return displayType==Attendance.Audit.WEB?"PI_desktop dgry S12 ML10":displayType==Attendance.Audit.MOBILE?"PI_phone dgry S12 ML10":displayType==Attendance.Audit.INTEGRATION?"IC-url dgry S12 ML10":void 0}},Attendance.Overtime={startIndex:0,init:function(){var page=settingsPage.container;landingPage=page,landingPageId=landingPage[0].id,landingPageURL=Att_Common_Operations.getLandingPageURL();var curUser=AttendanceTeam.getSelfReqPageErecno();if(0===page.children().length||curUser!=landingPage.find(".zpl_ibg.PI_more")[0].id.replace("balOTMore","")){page.children().length>0&&(ZPeopleComponents.menu("#otviewMoreOptions"+landingPage.find(".zpl_ibg.PI_more")[0].id.replace("balOTMore","")).destroy(),page.empty());var html='<div class="zpl_container"><div class="zpl_iwrpr" aria-label="'+ZPI18N.getString("zp.common.tabname",[ZPI18N.getString("zp.overtime")])+'" tabindex="0"><div class="zpl_iwrprrgt"><div class="zpl_act zpl_attnLstvw zpl_tblfxd">';html+='<div class="zpl_btnmnu"><div class="zpl_lft"></div><div class="zpl_rgt"><i class="zpl_ibg PI_more" tabindex="0" aria-label="'+ZPI18N.getString("zp.more")+'"title="'+ZPI18N.getString("zp.more")+'" id="balOTMore'+curUser+'" onclick="Attendance.Overtime.showMoreOptions()"></i></div></div>',html+='<div class="zpl_rgtcnt"><div class="zpl_tblres">',html+=Attendance.Overtime.getTableStruct(),html+="</div></div></div></div></div></div>",page.append(html),html='<div id="otviewMoreOptions'+curUser+'" class="zpl_drpdwn zmenu zmenu--iconwithtext"><ul>',html+='<li data-action="Att_Common_Operations.ExportPDF.construct" data-icon-class="PI_downld"><div class="zmenu__iconcontainer"><i class="zmenu__icon PI_downld"></i></div><span class="zmenu__text">'+ZPI18N.getString("zp.downloadpdf")+"</span></li>",html+='<li data-action="Att_Common_Operations.Export.construct" data-icon-class="PI_exprt"><div class="zmenu__iconcontainer"><i class="zmenu__icon PI_exprt"></i></div><span class="zmenu__text">'+ZPI18N.getString("zp.export")+"</span></li>",html+="</ul></div>",page.append(html),ZPeopleComponents.menu("#otviewMoreOptions"+curUser,{forElement:"#balOTMore"+curUser,contentType:"icon-text"})}Attendance.Overtime.fireScrollObj=new FireScrollBack(Attendance.Overtime.getBalanceOtViewOnScroll,"#overtimeView"),Attendance.Overtime.getBalanceOtView()},getTableStruct:function(){var html='<table class="zpl_tbl zpl_nocrsor" role="grid">';return html+='<thead><tr><th scope="col" class="mw150">'+ZPI18N.getString("zp.from")+'</th><th  scope="col">  '+ZPI18N.getString("zp.to")+"</th>",html+='<th scope="col">'+ZPI18N.getString("zp.previousbalance")+'</th><th scope="col">'+ZPI18N.getString("zp.expectedhrs")+'</th><th scope="col" >'+ZPI18N.getString("zp.payablehours")+"</th>",html+='<th scope="col" >'+ZPI18N.getString("zp.paidhours")+'</th><th  scope="col">'+ZPI18N.getString("zp.adjustHours")+'</th><th  scope="col">'+ZPI18N.getString("zp.balanceHours")+"</th></tr></thead>",html+='<tbody id="balanceOTBody"></tbody></table>'},showMoreOptions:function(){var id="#otviewMoreOptions"+AttendanceTeam.getSelfReqPageErecno();ZPeopleComponents.menu(id).show()},getBalanceOtViewOnScroll:function(){Attendance.Overtime.startIndex+=50,Attendance.Overtime.getBalanceOtView(!0)},getBalanceOtView:function(scroll){var param={mode:"getBalanceOtReport",conreqcsr:csrfToken};param.erecno=AttendanceTeam.getSelfReqPageErecno(),scroll?param.startIndex=Attendance.Overtime.startIndex+1:TimelySettings.showHideLoadingPage(!0,!0),$.post("/AttendanceReportAction.zp",param,function(rdata){if(TimelySettings.showHideLoadingPage(!1,!0),landingPage[0].id.includes("balanceotview"))return rdata.fail?(landingPage.find(".table-responsive.H100.tabcont").hide(),landingPage.find(" #zp_page_loading").hide(),landingPage.find(" #s2id_ZPAtt_otView_empName").is(":visible")||landingPage.find(" #ZPAtt_otView_userPhoto").attr("src",ZPeople.CURR_USER.avatar).parent().show(),Attendance.consResetEmpSearch("ZPAtt_otView_empName",landingPage,!0,!1),landingPage.find(" #ZPAtt_balOtView").parent().parent().removeClass("section"),Attendance.noDataImg(5,"CR-noperm",landingPage.find(".ZPNdata i").eq(0)),void landingPage.find(" #ZPAtt_balOtView_emptyRecInfo").show().find(".no-para").html(ZPI18N.getString("zp.permdenied"))):void(rdata.report&&(50===rdata.report.length&&Attendance.Overtime.fireScrollObj.reset(),Attendance.Overtime.constructOtList(rdata,scroll)))})},constructOtList:function(rdata,isScroll){var page=landingPage,data=rdata.report,repTable=(rdata.userDetails,rdata.isViewAllowedForSub,rdata.isViewAllowed,page.find("#balanceOTBody"));if(isScroll||repTable.empty(),data){0===repTable.length&&(page.find(".zpl_tblres").append(Attendance.Overtime.getTableStruct()),repTable=page.find("#balanceOTBody"));for(var i=0;data[i];i++){var trow='<tr><td tabindex="0" scope="row" ><span>'+data[i].startDate+"</span></td>";trow+="<td><span>"+data[i].endDate+"</span></td>",trow+="<td><span>"+Attendance.disHours(data[i].prevOtHours/60,!1,!0)+"</span></td>",trow+="<td><span>"+Attendance.disHours(data[i].expectedHours/60,!1,!0)+"</span></td>",trow+="<td><span>"+Attendance.disHours(data[i].workedHours/60,!1,!0)+"</span></td>",trow+="<td><span>"+Attendance.disHours(data[i].paidHours/60,!1,!0)+"</span></td>",trow+="<td><span>"+Attendance.disHours(data[i].adjustHours/60,!1,!0)+"</span></td>",trow+="<td><span>"+Attendance.disHours(data[i].balanceHours/60,!1,!0)+"</span></td></tr>",repTable.append(trow)}var emptyhtml=new EmptyPages("zp_nd_nodata",ZPI18N.getString("zp.nodatafound"),"",page.find(".zpl_tblres"));if(0===repTable.children().length)return page.find(".zpl_btnmnu").hide(),void emptyhtml.show();page.find(".zpl_btnmnu").show(),emptyhtml.remove()}}},Attendance.LiveLocation={fireScrollObj:null,init:function(){Layout.Page.container.find("#ZPATT_Live_MapCont")[0]||Layout.Page.parentContainer.html(ZPeople.LOADING_HTML),Attendance.LiveLocation.loadLiveLocHTML()},loadLiveLocHTML:function(){var constructedMapCont,layout=Layout.Page.container,hashurl=Layout.Page.hash,isAlreadyConstructed=!1,contId=Layout.Page.container[0].id;void 0!==$("#ZPATT_liveLocation_map")[0]&&$("#ZPATT_liveLocation_map")[0].children.length>0&&(isAlreadyConstructed=!0,constructedMapCont=$("#ZPATT_liveLocation_map")),Attendance.LiveLocation.loadActionTypeClass();var html='<div class="zpl_container"><div class="zpl_iwrpr">';html+='<div class="zpl_iwrprrgt"><div class="zpl_act zpl_tblfxd">',html+='<div class="zpl_rgtcnt zpl_livlocmap">',html+='<div class="zpl_ltemplist" id="ZPATT_Live_userList" style="z-index:1;">',html+='<div class="zpl_ltemphdr DNI"><div class="zpl_flexligngap3"><b>'+ZPI18N.getString("zp.totalmembers")+'</b><div class="zpl_tg"><span><b id="ZPATT_Live_totalUserCnt"></b></span></div></div>',html+='<i class="zpl_ibg PI_lens" onclick="Attendance.LiveLocation.toggleEmpSearch()"></i><div class="search-cmn"><i class="PI_lens"></i>',html+='<input type="text" class="ztextbox" id="ZPATT_Live_SearchInput" onkeyup="Attendance.LiveLocation.searchEmployee(event)" placeholder="'+ZPI18N.getString("zp.mincharsearch",new Array("3"))+'"><i class="PI_cls" onclick="Attendance.LiveLocation.toggleEmpSearch()"></i></div></div>',html+='<div id="ZPATT_Live_userListDets">'+ZPeople.LOADING_HTML+"</div></div>",html+='<div class="zpl_ltemplist zpl_ltemptmln DNI" id="ZPATT_Live_empDetails" style="z-index:1;"> <div class="zpl_lttmlnhdr">',html+='<div class="zpl_lttmlnsub"><i class="zpl_ibg PI_back" id="ZPATT_Live_backicon"></i><div class="zpl_em" id="ZPATT_Live_userDetHeadEmp"><div class="zpl_emimg zpl_smvw"><img></div>',html+='<div class="zpl_emdts zpl_ellipsis"><div></div></div></div></div>',html+='<div class="zpl_lttmlnhdrcnt">',html+='<div><i class="PI_alft" id="ZPATT_Live_goToPrevBtn" title="Previous"></i></div><div class="a-itm-cntr d-flexclmcap8"><i class="PI_monthly" id="entryNavDatePicker"></i>',html+='<b id="ZPATT_Live_dateNavText"></b></div><div><i class="PI_argt" id="ZPATT_Live_goToNextBtn" title="Next"></i></div></div></div><div class="zpl_lttmlnlist" id="ZPATT_Live_empDetList">'+ZPeople.LOADING_HTML+"</div>",html+='<div class="zpl_lttmlnftr" id="ZPATT_Live_statusCount"><div class="d-flexclm4"><em>'+ZPI18N.getString("zp.checkin")+'</em><div class="a-itm-cntr d-flexclmcap8">',html+='<div class="zpl_ltempsts chkin"><i class="PI_entry"></i></div><b id="ZPATT_Live_BottCheckinCnt"></b></div></div><div class="d-flexclm4">',html+="<em>"+ZPI18N.getString("zp.loctrk.captintrval")+'</em><div class="a-itm-cntr d-flexclmcap8"><div class="zpl_ltempsts locmp">',html+='<i class="PI_loc_upd"></i></div><b id="ZPATT_Live_BottLiveCnt"></b></div></div><div class="d-flexclm4"><em>'+ZPI18N.getString("zp.loctrk.nolocation")+"</em>",html+='<div class="a-itm-cntr d-flexclmcap8"> <div class="zpl_ltempsts ntftch"><i class="PI_loc_no"></i></div>',html+='<b id="ZPATT_Live_BotNoLocCnt"></b></div></div><div><i class="PI_more zpl_ibg" id="ZPATT_Live_moreCnt" data-popup-open="lvtrcklist"></i></div></div></div>',html+='<div class="zpl_crd"><div class="zpl_crdcnt">',html+='<div class="zpl_secn" style="height: 100%;" id="ZPATT_Live_MapCont">',html+='<div id="display-google-map" style="overflow:hidden;width: 100%;height: 600px;resize:none;max-width:100%;">',html+='<div id="'+Layout.Page.pageId+'_map" style="height:100%;width:100%;border:0;">',html+='<div id="ZPATT_liveLocation_map" style="height: 100%; width: 100%; border: 0px; position: relative; overflow: hidden;">',html+="</div></div></div></div>",html+="</div></div></div></div></div></div>",html+='<div class="zpl_mdl zpl_msm" data-modal-box="lvtrcklist" id="ZPATT_Live_CntPop"> <div class="zpl_minr"> <div class="zpl_mhder">',html+="<div><h4>"+ZPI18N.getString("zp.locationtracker")+'</h4> </div> <a class="_cls PI_cls"></a> </div> <div class="zpl_mcnt"> <div id="days" class=""> ',html+='<div class="zpl_crd"> <div class="zpl_crdcnt"> <div class="zpl_ltdtlslist"> <div class="d-flexclmcap10"> ',html+='<div class="zpl_ltempsts chkin"> <i class="PI_entry"></i> </div> <div class="d-flexclm4"> <em>'+ZPI18N.getString("zp.checkin")+"</em> ",html+='<span id="ZPATT_Live_PoPCheckinCnt"></span> </div> </div> <div class="d-flexclmcap10"> <div class="zpl_ltempsts locmp"> ',html+='<i class="PI_loc_upd"></i> </div> <div class="d-flexclm4"> <em>'+ZPI18N.getString("zp.loctrk.captintrval")+'</em> <span id="ZPATT_Live_PoPLiveCnt"></span> ',html+='</div> </div> <div class="d-flexclmcap10"> <div class="zpl_ltempsts ntftch"> <i class="PI_loc_no"></i> </div> ',html+='<div class="d-flexclm4"> <em>'+ZPI18N.getString("zp.loctrk.nolocation")+'</em> <span id="ZPATT_Live_PoPNoLocCnt"></span> </div> </div> <div class="d-flexclmcap10"> ',html+='<div class="zpl_ltempsts chkout"> <i class="PI_exit"></i> </div> <div class="d-flexclm4"> <em>'+ZPI18N.getString("zp.checkout")+"</em> ",html+='<span id="ZPATT_Live_PoPCheckOutCnt"></span> </div> </div><div class="d-flexclmcap10"> <div class="zpl_ltempsts break"> <i class="PI_brk"></i> </div> <div class="d-flexclm4"> <em>'+ZPI18N.getString("zp.break")+'</em> <span id="ZPATT_Live_PoPBreakCnt"></span> </div> </div>',html+="</div> </div> </div> </div> </div> </div> </div>",html+="</div>",Layout.Page.parentContainer.html(html),layout.find("#entryNavDatePicker").off().on("click",function(event){Calendar.setUpCalendar(event,this,void 0,void 0,Attendance.LiveLocation.onSelectCalCallbk,void 0)}),layout.find("#ZPATT_Live_backicon").unbind("click").bind("click",function(){Attendance.LiveLocation.backToUserList()}),layout.find("#ZPATT_Live_moreCnt").unbind("click").bind("click",function(){Layout.Page.container.find("#ZPATT_Live_CntPop").addClass("zpl_mopen")}),layout.find("#ZPATT_Live_CntPop ._cls").unbind("click").bind("click",function(){Layout.Page.container.find("#ZPATT_Live_CntPop").removeClass("zpl_mopen")}),layout.find("#ZPATT_Live_goToPrevBtn").attr("onclick","Attendance.LiveLocation.setNavigationPrevNext(true)"),layout.find("#ZPATT_Live_goToNextBtn").attr("onclick","Attendance.LiveLocation.setNavigationPrevNext()"),layout.find("#display-google-map").css("height",layout.find(".zpl_iwrpr .zpl_crd")[0].offsetHeight-42),settingsPage.fireScrollObj.ZPATT_Live_userList?Attendance.LiveLocation.fireScrollObj=settingsPage.fireScrollObj.ZPATT_Live_userList:(Attendance.LiveLocation.fireScrollObj=new FireScrollBack(Attendance.LiveLocation.getReqOnScroll,"#ZPATT_Live_userList","ZPATT_Live_userList"),Attendance.LiveLocation.ZPATT_Live_userListDetsSIndex=0),isAlreadyConstructed&&0===$("#"+contId+" #ZPATT_Live_MapCont #ZPATT_liveLocation_map")[0].children.length?($("#"+contId+" #ZPATT_Live_MapCont #ZPATT_liveLocation_map").remove(),constructedMapCont.appendTo("#"+contId+" #ZPATT_Live_MapCont #"+Layout.Page.pageId+"_map "),-1!==hashurl.indexOf("entry")||-1!==hashurl.indexOf("searchuser")||-1!==hashurl.indexOf("team/user")?Attendance.LiveLocation.getUserDetails():Attendance.LiveLocation.getAllUsersLiveLocation()):(ZPMaps.map=void 0,Attendance.LiveLocation.loadMapData())},setNavigationPrevNext:function(isPrev){var layout=Layout.Page.container,currDate=layout.find("#ZPATT_Live_dateNavText").html(),prevNextDate=Calendar.parseDate(currDate,uidateFormat);void 0!==isPrev&&isPrev?prevNextDate.setDate(prevNextDate.getDate()-1):prevNextDate.setDate(prevNextDate.getDate()+1),dateObj=layout.find("#ZPATT_Live_dateNavText").html(prevNextDate.getDateBy(dateFmt)),Attendance.LiveLocation.getUserDetails(void 0,dateObj)},onSelectCalCallbk:function(tempDteObj){Layout.Page.container.find("#ZPATT_Live_dateNavText").html(tempDteObj.getDateBy(dateFmt)),Attendance.LiveLocation.getUserDetails(void 0,tempDteObj)},actionTypeClsArr:[],loadActionTypeClass:function(){if(0===Attendance.LiveLocation.actionTypeClsArr.length){for(var clArr=[],i=0;i<10;i++){var clObj={};1===i?(clObj.textClassName="grn",clObj.pinClassName="chkin",clObj.rndClassName="chkin",clObj.iconName="PI_entry",clObj.image=ZPeople.getResourceURL(newUIImageUrl+"Check-in.png")):2===i||9===i?(clObj.textClassName="red",clObj.pinClassName="chkout",clObj.rndClassName="chkout",clObj.iconName="PI_exit",clObj.image=ZPeople.getResourceURL(newUIImageUrl+"Check-out.png")):3===i?(clObj.textClassName="org",clObj.pinClassName="break",clObj.rndClassName="break",clObj.iconName="PI_brk",clObj.image=ZPeople.getResourceURL(newUIImageUrl+"Break.png")):4===i?(clObj.textClassName="blu",clObj.pinClassName="syschk",clObj.rndClassName="locmp",clObj.iconName="PI_loc_upd",clObj.image=ZPeople.getResourceURL(newUIImageUrl+"SysytemCheck.png")):(clObj.textClassName="blk",clObj.pinClassName="blk",clObj.rndClassName="ntftch",clObj.iconName="PI_loc_no"),clArr.push(clObj)}Attendance.LiveLocation.actionTypeClsArr=clArr}},mapType:{},loadMapData:function(){if(ZPMaps.staticLoaded||ZPMaps.loadStatic(),void 0!==ZPMaps.map);else try{var param={conreqcsr:csrfToken,method:"getGeoAPIKeys"};param.referral=document.domain,$.post("getGeoAPIKeys.zp",param,function(rdata){Attendance.LiveLocation.mapType=rdata.mapType,ZPMaps.loadMapsSDK(null,null,!1,"ZPATT_liveLocation_map",null,null,null,rdata,!0)})}catch(err){}},allUsersLiveLocList:{},geoMapCoordinates:{},getAllUsersLiveLocation:function(isScroll){var layout=Layout.Page.container,param={mode:"getAllUsersLiveLocation",conreqcsr:csrfToken},searchInput=layout.find("#ZPATT_Live_SearchInput");searchInput.is(":visible")&&""!==searchInput.val().trim()&&(param.searchStr=searchInput.val().trim()),isScroll?param.startIndex=Attendance.LiveLocation.ZPATT_Live_userListDetsSIndex+1:(Attendance.LiveLocation.ZPATT_Live_userListDetsSIndex=0,$("#ZPATT_Live_userListDets").scrollTop(0)),$.post("/LiveLocationTracking.zp",param,function(rdata){Attendance.LiveLocation.allUsersLiveLocList=rdata,500===rdata.result.details.length?Attendance.LiveLocation.fireScrollObj.reset():Attendance.LiveLocation.fireScrollObj.fireScrollCalled=!0,Attendance.LiveLocation.loadAllUsersMapData(),Attendance.LiveLocation.loadAllUserLiveList(isScroll)})},returnLocFetchText:function(addedTimeDiff){var locFetchText="";return(addedTimeDiff=parseInt(addedTimeDiff))<60?(1===addedTimeDiff&&(addedTimeDiff=2),locFetchText=ZPI18N.getString("zp.loctrk.loccaptperiodmsg",new Array(addedTimeDiff+" "+ZPI18N.getString("zp.lms.seconds")))):locFetchText=addedTimeDiff<3600?1===(addedTimeDiff=parseInt(addedTimeDiff/60))?ZPI18N.getString("zp.loctrk.loccaptperiodmsg",new Array(addedTimeDiff+" "+ZPI18N.getString("zp.smin"))):ZPI18N.getString("zp.loctrk.loccaptperiodmsg",new Array(addedTimeDiff+" "+ZPI18N.getString("zp.minute"))):1===(addedTimeDiff=parseInt(addedTimeDiff/60/60))?ZPI18N.getString("zp.loctrk.loccaptperiodmsg",new Array(addedTimeDiff+" "+ZPI18N.getString("zp.leavetype.hour.singular"))):ZPI18N.getString("zp.loctrk.loccaptperiodmsg",new Array(addedTimeDiff+" "+ZPI18N.getString("zp.leavetype.hour.plural"))),locFetchText},toggleEmpSearch:function(){var layout=Layout.Page.container,searchIcon=layout.find("#ZPATT_Live_userList .zpl_ltemphdr .search-cmn");searchIcon.hasClass("opn")?(searchIcon.removeClass("opn"),layout.find("#ZPATT_Live_SearchInput").val(""),Attendance.LiveLocation.searchKey=null,Attendance.LiveLocation.getAllUsersLiveLocation()):(searchIcon.addClass("opn"),layout.find("#ZPATT_Live_SearchInput").focus())},searchKey:null,searchEmployee:function(event){if(27===event.keyCode)return Attendance.LiveLocation.toggleEmpSearch(),void(Attendance.LiveLocation.searchKey=null);var layout=Layout.Page.container;setTimeout(function(){var searchInput=layout.find("#ZPATT_Live_SearchInput").val();searchInput.length>=3&&Attendance.LiveLocation.searchKey!==searchInput&&(Attendance.LiveLocation.searchKey=searchInput,Attendance.LiveLocation.getAllUsersLiveLocation())},500)},loadAllUserLiveList:function(isScroll){var rdata=Attendance.LiveLocation.allUsersLiveLocList,layout=Layout.Page.container;if(layout.find("#ZPATT_Live_userList .zpl_ltemphdr").removeClass("DNI"),isScroll||(layout.find("#ZPATT_Live_userListDets").html(""),layout.find("#ZPATT_Live_totalUserCnt").html("")),rdata.result&&rdata.result.details&&rdata.result.details.length>0||isScroll&&void 0!=layout.find("#ZPATT_Live_userListDets")){layout.find("#ZPATT_Live_totalUserCnt").html(rdata.result.totalUserCount);for(var res=rdata.result.details,i=0;i<res.length;i++){var details=res[i],liveLocId=details.liveLocId,empId=details.empId,erecno=details.erecno;liveLocId||(liveLocId=erecno);var actionType=details.actionType,empName=details.empName,time=(details.latitude,details.time),empPhoto=details.empPhoto,geoLocName=(details.longitude,details.geoLocName),date=details.originday;date=(date=date?Calendar.parseDate(date,Calendar.DB_DATEFORMAT):new Date).getDateBy(dateFmt);var type=details.type,customHtml='<div class="zpl_ltemplistcrd" id="liveLoc_'+liveLocId+'" erecno="'+erecno+'" date ="'+date+'" > <div class="zpl_em"> <div class="zpl_emimg zpl_smvw"> <img src="'+empPhoto+'"> </div> ';if(customHtml+='<div class="zpl_emdts zpl_ellipsis"> <div>'+$("<div/>").text(empId).html()+" - <b>"+$("<div/>").text(empName).html()+"</b></div> ",actionType)customHtml+='<div><span class="'+Attendance.LiveLocation.actionTypeClsArr[type].textClassName+'">'+actionType+"</span></div>";if(customHtml+='</div> </div> <div class="zpl_ltempdtls"> <div class="zpl_ltnavigticn"><i class="PI_activity"></i></div>',time){if(customHtml+='<div class="zpl_ltempdtlsrw">',customHtml+='<div class="zpl_ltemplft"> <i class="PI_clock"></i> </div> <div class="zpl_ltemprgt"> <div> <div class="zpl_tg"> <span><b>'+time+"</b></span>",customHtml+="</div> </div> ",void 0!==type&&0!==type&&void 0!==details.timeDiffInSecs)customHtml+="<em>"+Attendance.LiveLocation.returnLocFetchText(details.timeDiffInSecs)+"</em>";customHtml+="</div> </div> "}else customHtml+='<div class="zpl_ltempdtlsrw"><div class="zpl_ltemprgt"><em>'+ZPI18N.getString("zp.norecfound")+"</em></div></div>";geoLocName&&(customHtml+='<div class="zpl_ltempdtlsrw"> <div class="zpl_ltemplft">',customHtml+='<i class="PI_location"></i> </div> <div class="zpl_ltemprgt"> <span>'+geoLocName+"</span> </div> </div> "),customHtml+="</div> </div>",layout.find("#ZPATT_Live_userListDets").append(customHtml),void 0!==type&&0!==type&&layout.find("#ZPATT_Live_userListDets").find("#liveLoc_"+liveLocId).unbind("click").bind("click",function(){var mId="map_"+this.id;ZPMaps.map.openInfoWindow(mId),ZPMaps.map.fitToMarkers([ZPMaps.map.getMarkerById(mId)]),layout.find("#ZPATT_Live_userListDets .zpl_act").removeClass("zpl_act")}).addClass("CP"),layout.find("#ZPATT_Live_userListDets").find("#liveLoc_"+liveLocId).find(".zpl_ltnavigticn").unbind("click").bind("click",function(){ZPMaps.map.closeAllOpenInfoWindows();var erecno=$(this).closest(".zpl_ltemplistcrd").attr("erecno");this.erecno=erecno;var date=$(this).closest(".zpl_ltemplistcrd").attr("date");layout.find("#ZPATT_Live_dateNavText").html(date),Attendance.LiveLocation.getUserDetails(this,date)})}}else{layout.find("#ZPATT_Live_totalUserCnt").html("0");customHtml='<div class="zpl_Emptydata"><div class="zpl_emptimg zp_nd_nodata"></div><h4>'+ZPI18N.getString("zp.noemployeecheckedin")+"</h4></div>";layout.find("#ZPATT_Live_userListDets").html(customHtml)}},loadAllUsersMapData:function(){var rdata=Attendance.LiveLocation.allUsersLiveLocList;ZPMaps.map.removeAllMarkers(),ZPMaps.map.removeAllShapes(),ZPMaps.map.closeAllOpenInfoWindows(),ZPMaps.map.onMarkerClick(Attendance.LiveLocation.liveMapMarkerCallBack);var isGmaps=2===ZPMaps.map.mapVendor;if(rdata.result&&rdata.result.details){for(var res=rdata.result.details,i=0;i<res.length;i++){var details=res[i],latitude=details.latitude,longitude=details.longitude,geoLocName=details.geoLocName;if((latitude||longitude)&&void 0!==geoLocName&&""!==geoLocName){var empId=details.empId,liveLocId=details.liveLocId,actionType=details.actionType,empName=details.empName,time=details.time,empPhoto=details.empPhoto,classNames=Attendance.LiveLocation.actionTypeClsArr[details.type],txtClass=classNames.textClassName,pinClass=classNames.pinClassName,locFetchText="";void 0!==details.timeDiffInSecs&&(locFetchText="<em>"+Attendance.LiveLocation.returnLocFetchText(details.timeDiffInSecs)+"</em>");var customHtml='<div class="zpl_ltemplistcrd CP" style="max-width:380px;min-width:380px;"> <div class="zpl_em"> <div class="zpl_emimg zpl_smvw"> <img src="'+empPhoto+'"> </div> ';customHtml+='<div class="zpl_emdts zpl_ellipsis"> <div>'+$("<div/>").text(empId).html()+" - <b>"+$("<div/>").text(empName).html()+'</b></div> <div><span class="'+txtClass+'">'+actionType+"</span></div>",customHtml+='</div> </div> <div class="zpl_ltempdtls"><div class="zpl_ltempdtlsrw">',customHtml+=' <div class="zpl_ltemplft"> <i class="PI_clock"></i> </div> <div class="zpl_ltemprgt"> <div> <div class="zpl_tg"> <span><b>'+time+"</b></span>",customHtml+=" </div> </div>"+locFetchText+'</div> </div> <div class="zpl_ltempdtlsrw"> <div class="zpl_ltemplft">',customHtml+=' <i class="PI_location"></i> </div> <div class="zpl_ltemprgt"> <span>'+geoLocName+"</span> </div> </div> </div> </div>";var marker=new ZMarker("map_liveLoc_"+liveLocId,latitude,longitude);marker.showInfoWindow(!0),marker.setCustomInfoWindowView(customHtml),isGmaps?marker.setIcon(empPhoto):marker.setIconFromHtml("<div class='zpl_ltempin "+pinClass+"'><img src='"+empPhoto+"'></div>"),marker.autoOpenInfoWindow([ZMarkersEventType.OnMouseOver]),ZPMaps.map.addMarker(marker)}}ZPMaps.map.fitToAllMarkers()}},liveMapMarkerCallBack:function(ZMap,ZMarker,DynamicInfowWindowCallback){var markerId=ZMarker.id;markerId=markerId.substring(4);var parCont=Layout.Page.container.find("#ZPATT_Live_userList");parCont.hasClass("DNI")&&parCont.removeClass("DNI"),parCont.find(".zpl_act").removeClass("zpl_act");var selCont=parCont.find("#"+markerId);selCont.addClass("zpl_act"),parCont.animate({scrollTop:selCont.offset().top-parCont.offset().top+parCont.scrollTop()},1e3)},openLiveEmpList:function(){var layout=Layout.Page.container,parCont=layout.find("#ZPATT_Live_userList");parCont.hasClass("DNI")?parCont.removeClass("DNI"):(parCont.addClass("DNI"),Attendance.LiveLocation.loadAllUsersMapData()),parCont.find(".zpl_act").removeClass("zpl_act"),layout.find("#ZPATT_Live_empDetails").addClass("DNI")},backToUserList:function(){var layout=Layout.Page.container;ZPMaps.map.closeAllOpenInfoWindows(),layout.find("#ZPATT_Live_userList .zpl_act").removeClass("zpl_act"),layout.find("#ZPATT_Live_userList").removeClass("DNI"),layout.find("#ZPATT_Live_empDetails").addClass("DNI"),layout.find("#ZPATT_Live_dateNavText").html(""),ZPMaps.removeShape();Layout.Page.hash;ZPMaps.removeShape(),Attendance.LiveLocation.loadAllUsersMapData()},userDetailsList:{},isFromUserSelectJson:{},getUserDetails:function(obj,dateObj){if(void 0!==event){if("load"===event.type)return;event.stopPropagation()}var erecno,date,layout=Layout.Page.container,hashurl=Layout.Page.hash;if(-1!==hashurl.indexOf("team/locationtracker"))erecno=void 0!==obj?obj.erecno:layout.find("#ZPATT_Live_userDetHeadEmp").data("erecno");else if(-1!==hashurl.indexOf("searchuser")||-1!==hashurl.indexOf("team/user")){erecno=hashurl.split("-id:")[1]}else erecno=ZPeople.CURR_USER.usererec;void 0!==dateObj?(dateText=Calendar.parseDate(layout.find("#ZPATT_Live_dateNavText").html(),uidateFormat),date=""!==layout.find("#ZPATT_Live_dateNavText").html()?dateText.getDateBy(dateFmt):(new Date).getDateBy(dateFmt)):date=(new Date).getDateBy(dateFmt);var param={mode:"getUserLiveLocation",conreqcsr:csrfToken,erecno:erecno,date:date};$.post("/LiveLocationTracking.zp",param,function(rdata){void 0!=rdata&&(ZPMaps.map.closeAllOpenInfoWindows(),Attendance.LiveLocation.userDetailsList=rdata,Attendance.LiveLocation.loadUserDetails(obj),void 0!=rdata.result&&void 0!==rdata.result.geoRestrictionCoordinates&&(Attendance.LiveLocation.geoMapCoordinates=rdata.result.geoRestrictionCoordinates),Attendance.LiveLocation.loadUserMap())})},loadUserDetails:function(obj){var rdata=Attendance.LiveLocation.userDetailsList,layout=Layout.Page.container,hashurl=Layout.Page.hash;layout.find("#ZPATT_Live_userList").addClass("DNI"),layout.find("#ZPATT_Live_empDetails").removeClass("DNI"),-1===hashurl.indexOf("entry")&&-1===hashurl.indexOf("searchuser")&&-1===hashurl.indexOf("team/user")||layout.find("#ZPATT_Live_empDetails .zpl_lttmlnsub").addClass("DNI"),layout.find("#ZPATT_Live_empDetList").html("");var date=new Date(rdata.result.date).getDateBy(dateFmt);if(""!==layout.find("#ZPATT_Live_dateNavText")[0].innerText?date=layout.find("#ZPATT_Live_dateNavText").html():void 0!==rdata.result.date||void 0!==layout.find("#ZPATT_Live_dateNavText").val()&&""!==layout.find("#ZPATT_Live_dateNavText").val()||(date=(new Date).getDateBy(dateFmt)),rdata.result&&rdata.result.userDetails){var userDetails=rdata.result.userDetails,empDetsDiv=layout.find("#ZPATT_Live_userDetHeadEmp");empDetsDiv.find("img").attr("src",userDetails.empPhoto),empDetsDiv.find(".zpl_emdts div").html($("<div/>").text(userDetails.empId).html()+" - <b>"+$("<div/>").text(userDetails.empName).html()+"</b>"),empDetsDiv.data("erecno",userDetails.erecno)}if(layout.find("#ZPATT_Live_dateNavText").html(date),rdata.result&&rdata.result.locationDetails&&rdata.result.locationDetails.length>0){for(var res=rdata.result.locationDetails,i=0;i<res.length;i++){var details=res[i],liveLocId=details.liveLocId,time=(details.latitude,details.time),geoLocName=(details.longitude,details.geoLocName),type=details.type,locFetchText=details.actionType,classNames=Attendance.LiveLocation.actionTypeClsArr[type],customHtml='<div class="zpl_ltemplistcrd" id="userLoc_'+liveLocId+'"> <div class="zpl_ltempsts '+classNames.rndClassName+'"> <i class="'+classNames.iconName+'"></i> </div>';customHtml+='<div class="zpl_ltempdtls"> <div class="zpl_ltempdtlsrw"> <div class="zpl_ltemplft"> <i class="PI_clock"></i> </div>',customHtml+='<div class="zpl_ltemprgt"> <div> <div class="zpl_tg"> <span><b>'+time+"</b></span> </div> </div>",customHtml+="<em>"+locFetchText+"</em> </div> </div>",geoLocName&&(customHtml+='<div class="zpl_ltempdtlsrw"> <div class="zpl_ltemplft">',customHtml+='<i class="PI_location"></i> </div> <div class="zpl_ltemprgt"> <span>'+geoLocName+"</span> </div> </div> "),customHtml+="</div> </div>",layout.find("#ZPATT_Live_empDetList").append(customHtml),0!==type&&layout.find("#ZPATT_Live_empDetList").find("#userLoc_"+liveLocId).unbind("click").bind("click",function(){var mId="map_"+this.id;layout.find("ZPATT_Live_dateNavText").html((new Date).getDateBy(dateFmt)),ZPMaps.map.openInfoWindow(mId),ZPMaps.map.fitToMarkers([ZPMaps.map.getMarkerById(mId)]),layout.find("#ZPATT_Live_empDetList .zpl_act").removeClass("zpl_act")}).addClass("CP")}if(rdata.result&&rdata.result.locationReport){layout.find("#ZPATT_Live_statusCount").has("DNI")&&layout.find("#ZPATT_Live_statusCount").removeClass("DNI");var rep=rdata.result.locationReport;layout.find("#ZPATT_Live_BottCheckinCnt").text((void 0!==rep.checkInCount?rep.checkInCount:0)+" T"),layout.find("#ZPATT_Live_BottLiveCnt").text((void 0!==rep.capturedInterval?rep.capturedInterval:0)+" T"),layout.find("#ZPATT_Live_BotNoLocCnt").text((void 0!==rep.noLocCount?rep.noLocCount:0)+" T"),layout.find("#ZPATT_Live_PoPCheckinCnt").html("<b>"+(void 0!==rep.checkInCount?rep.checkInCount:0)+" </b> Times"),layout.find("#ZPATT_Live_PoPCheckOutCnt").html("<b>"+(void 0!==rep.checkOutCount?rep.checkOutCount:0)+" </b> Times"),layout.find("#ZPATT_Live_PoPLiveCnt").html("<b>"+(void 0!==rep.capturedInterval?rep.capturedInterval:0)+" </b> Times"),layout.find("#ZPATT_Live_PoPNoLocCnt").html("<b>"+(void 0!==rep.noLocCount?rep.noLocCount:0)+" </b> Times"),layout.find("#ZPATT_Live_PoPBreakCnt").html("<b>"+(void 0!==rep.breakCount?rep.breakCount:0)+" </b> Times")}}else{var infoMsg=ZPI18N.getString("zp.specificemployee.noentry");-1!==hashurl.indexOf("entry")&&(infoMsg=ZPI18N.getString("zp.mymessage"));customHtml='<div class="zpl_Emptydata"><div class="zpl_emptimg zp_nd_nodata"></div><h4>'+infoMsg+"</h4></div>";layout.find("#ZPATT_Live_empDetList").append(customHtml),layout.find("#ZPATT_Live_statusCount").addClass("DNI")}},loadUserMap:function(){var rdata=Attendance.LiveLocation.userDetailsList;ZPMaps.map.removeAllMarkers(),ZPMaps.map.removeAllShapes(),ZPMaps.map.closeAllOpenInfoWindows(),ZPMaps.map.onMarkerClick(Attendance.LiveLocation.userMapMarkerCallBack);var isZohoMap=1===ZPMaps.map.mapVendor;if(rdata.result&&rdata.result.locationDetails&&0!==rdata.result.locationDetails){for(var res=rdata.result.locationDetails,resLen=res.length,i=0;i<resLen;i++){var details=res[i],longitude=details.longitude,latitude=details.latitude,geoLocName=details.geoLocName;if((latitude||longitude)&&void 0!==geoLocName&&""!==geoLocName){var time=details.time,liveLocId=details.liveLocId,classNames=Attendance.LiveLocation.actionTypeClsArr[details.type],pinClass=classNames.pinClassName,customHtml='<div class="zpl_ltemplistcrd" style="max-width:380px;min-width:380px;">';customHtml+='<div class="zpl_ltempdtls"> <div class="zpl_ltempdtlsrw"> <div class="zpl_ltemplft"> <i class="PI_clock"></i> </div>',customHtml+='<div class="zpl_ltemprgt"> <div> <div class="zpl_tg"> <span><b>'+time+"</b></span> </div> </div>",customHtml+="<em>"+details.actionType+'</em> </div> </div> <div class="zpl_ltempdtlsrw"> <div class="zpl_ltemplft">',customHtml+='<i class="PI_location"></i> </div> <div class="zpl_ltemprgt"> <span>'+geoLocName+"</span> </div> </div> </div> </div>";var marker=new ZMarker("map_userLoc_"+liveLocId,latitude,longitude);marker.showInfoWindow(!0),marker.setCustomInfoWindowView(customHtml),isZohoMap?marker.setIconFromHtml("<div class='zpl_ltempin "+pinClass+"'><b>"+(resLen-i)+"</b></div>"):marker.setIcon(classNames.image),marker.autoOpenInfoWindow([ZMarkersEventType.OnMouseOver]),ZPMaps.map.addMarker(marker)}}ZPMaps.map.fitToAllMarkers();var geoDetls=Attendance.LiveLocation.geoMapCoordinates;if(ZPMaps.removeShape(),void 0!=geoDetls&&Object.keys(geoDetls).length>0)for(i=0;i<geoDetls.length;i++){var locObj=[geoDetls[i]];locObj[0].id=i;var obj=JSON.stringify(locObj);ZPMaps.loadShape(obj)}ZPMaps.map.fitToAll()}},userMapMarkerCallBack:function(ZMap,ZMarker,DynamicInfowWindowCallback){var markerId=ZMarker.id;markerId=markerId.substring(4);var layout=Layout.Page.container;layout.find("#ZPATT_Live_empDetList .zpl_act").removeClass("zpl_act");var parCont=layout.find("#ZPATT_Live_empDetails");layout.find("#ZPATT_Live_userList").addClass("DNI"),parCont.hasClass("DNI")&&parCont.removeClass("DNI");var selCont=parCont.find("#"+markerId);selCont.addClass("zpl_act"),parCont.animate({scrollTop:selCont.offset().top-parCont.offset().top+parCont.scrollTop()-75},1e3)},getReqOnScroll:function(){Attendance.LiveLocation.ZPATT_Live_userListDetsSIndex+=500,Attendance.LiveLocation.getAllUsersLiveLocation(!0)}};