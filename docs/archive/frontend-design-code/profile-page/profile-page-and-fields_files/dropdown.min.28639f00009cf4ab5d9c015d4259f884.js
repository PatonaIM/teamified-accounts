var MIN_SCROLL_LENGTH=5,FIXED_WIDTH=250,isinside=!1;$.fn.zpmenu=function(prop){if((prop=$.extend({callback:"",callbackOnCancel:"",dropdownclass:"zp_drop",scrollclass:"ob_center",initobj:$(this),data:"",id:"",level:1,selectedVal:[],icon:!1,search:!1,checkbox:!1,noDataText:ZPI18N.getString("zp.noresults"),searchNotFoundText:ZPI18N.getString("zp.nomatchesfound"),isMandatory:!1,defaultSelectText:ZPI18N.getString("zp.select"),enableAddNewItem:!1,addNewData:{callback:""},newItemInternalCallback:"",oneTimeMenu:!1},prop)).initobj=$(this),$(prop.initobj).is("input")&&(prop.border=void 0==prop.border||prop.border),$(document).off("click.ddown").on("click.ddown",function(e){$("."+prop.dropdownclass).length>0&&(e.stopPropagation(),0==$("."+prop.dropdownclass).has($(e.target)).length&&0==$(prop.initobj).has($(e.target)).length&&!$(prop.initobj).is($(e.target))&&!$("."+prop.dropdownclass).is($(e.target))&&$(e.target).closest("[zpmenu=true]").length<=0&&(ZPMenu.removeDropDown(prop.border,prop.initobj),isinside=!1))}),("function"==typeof prop.data||prop.data.length>MIN_SCROLL_LENGTH)&&!prop.icon&&(prop.search=!0),prop.selectedVal.length>0)return $(prop.initobj).attr("selectedIds",""),void $.each(prop.selectedVal,function(index,val){var imageDiv="";void 0==val.image&&void 0==val.imageAlt||(imageDiv=CommonTemplates.returnImgDiv(val.image,val.imageAlt)),prop.checkbox?ZPMenu.constructTag(prop.initobj,imageDiv,val.text,val.id,prop.callbackOnCancel,prop):$(prop.initobj).is("input")?ZPMenu.setValuesinInput(prop,val.text,imageDiv):$(prop.initobj).append(imageDiv+"<span>"+val.text+"</span>");var id=""!=$(prop.initobj).attr("selectedIds")&&void 0!=$(prop.initobj).attr("selectedIds")?$.inArray(val.id,$(prop.initobj).attr("selectedIds").split(","))>-1?val.id:$(prop.initobj).attr("selectedIds")+","+val.id:val.id;$(prop.initobj).attr("selectedIds",id),$(prop.initobj).find(" i#"+val.id).on("click",function(e){e.stopPropagation(),ZPMenu.clearValue(this,prop.initobj,prop.callbackOnCancel)})});if("function"!=typeof prop.data)ZPMenu.constructList(prop,prop.data);else{var list=prop.data($("div#"+prop.id+" #searchList"));$("div#"+prop.id).length<=0?ZPMenu.constructList(prop,list):$("#"+prop.id+" #ddList").html(ZPMenu.constructValuesInBox(prop,list))}div=$("div#"+prop.id),ZPMenu.setCSS(prop),ZPMenu.chooseSelectedValueinList(prop),ZPMenu.searchList(prop,div),ZPMenu.selectFromList(prop),ZPMenu.focusSearchBar(prop.id),ZPMenu.keypressEvents(prop)};var ZPMenu={REVERSE_TRAVERSE:"reverse",FORWARD_TRAVERSE:"forward",chooseSelectedValueinList:function(prop){if(void 0!=$(prop.initobj).attr("selectedids")&&""!=$(prop.initobj).attr("selectedids")){var alreadySelected=$(prop.initobj).attr("selectedids").split(",");$.each(alreadySelected,function(i,v){$("."+prop.dropdownclass+" li[id="+v+"]").length>0&&($("."+prop.dropdownclass+" li[id="+v+"]").addClass("sel"),prop.checkbox&&$("."+prop.dropdownclass+" li[id="+v+"]").find("font").length>0&&$("."+prop.dropdownclass+" li[id="+v+"]").find("font").addClass("DN"),$("."+prop.dropdownclass+" li[id="+v+"]").offset().top>$("div.zpD_scrl").scrollTop()+$("."+prop.dropdownclass).height()&&$("div.zpD_scrl").scrollTop($("."+prop.dropdownclass+" li[id="+v+"]").offset().top-$("."+prop.dropdownclass).height()))})}else if(prop.icon&&$(prop.initobj).is("i")){var value=$(prop.initobj).attr("class");$("."+prop.dropdownclass+' li[name="'+value+'"]').length>0&&$("."+prop.dropdownclass+' li[name="'+value+'"]').addClass("sel")}},clearValue:function(obj,initObj,callbackOnCancel){var selectedIds=$(obj).attr("id"),tagType=$(obj).attr("type"),attrName="selectedIds",value=selectedIds;void 0!=tagType&&"newdata"==tagType&&(attrName="newvalues",value=$(obj).attr("value"));var allSelectedIds=$(initObj).attr(attrName);ZPMenu.clearfromAttribute(attrName,value,initObj),""!=allSelectedIds&&void 0!=allSelectedIds&&(void 0!=tagType&&"newdata"==tagType||($("li[id="+$(obj).attr("id")+"]").removeClass("sel"),$("li[id="+$(obj).attr("id")+"]").find("font").length>0&&$("li[id="+$(obj).attr("id")+"]").find("font").removeClass("DN"),void 0!=callbackOnCancel&&"function"==typeof callbackOnCancel&&callbackOnCancel($(obj).closest("div[class=zp_Tg]"),initObj))),$(obj).closest("div[class=zp_Tg]").remove()},clearfromAttribute:function(attrName,value,initObj){var allSelectedIds=$(initObj).attr(attrName);if(""!=allSelectedIds&&void 0!=allSelectedIds){var result=allSelectedIds.split(",");0==allSelectedIds.indexOf(value)?result.length>1&&(value+=","):value=","+value,allSelectedIds=allSelectedIds.replace(value,""),$(initObj).attr(attrName,allSelectedIds)}},constructList:function(prop,data){$('[ddown="true"]').length>0&&ZPMenu.removeDropDown(!0,$('[ddown="true"]').data("sourceObj")),prop.border&&ZPMenu.constructOutlineBox(prop);var html,outerDiv=$('<div ddown="true" class="'+prop.dropdownclass+' zp_shw" level="'+prop.level+'"  id="'+prop.id+'"></div>'),searchBox="";prop.search&&(searchBox='<ul class="zp_dsrc"><li id="searchTag" tabindex="1"><input id="searchList" placeholder="'+ZPI18N.getString("zp.search")+'" type="text"></li></ul>'),html=ZPMenu.constructValuesInBox(prop,data),$(outerDiv).append("<div>"+searchBox+'<div id="ddList" class="zpD_scrl">'+html+"</div></div>"),div=$(outerDiv);prop.initobj.height();$("body").append(div),$("#"+prop.id).data("sourceObj",prop.initobj)},constructAddNewLi:function(addNewProp,dataText){return'<li newItem="true" name="'+dataText+'"><span>'+(addNewProp.hasOwnProperty("placeholder")?addNewProp.placeholder:ZPI18N.getString("zp.add"))+" "+dataText+"</span></li>"},constructValuesInBox:function(prop,data){var checkbox="",imageDiv="",dataTypeDiv="",html="",ulClass="",valueDiv="",iconDiv="";if(prop.icon&&(ulClass="OI"),prop.checkbox&&(ulClass="RI",checkbox='<i class="IC-tick"></i>'),"function"==typeof prop.data&&data.length>0&&data[0].isEmpty)html='<div class="zp_nodata"><span>'+prop.defaultSelectText+"</span></div>";else if(data.length<=0&&prop.enableAddNewItem)html='<div class=""><span>'+prop.noDataText+"</span></div>";else if(data.length<=0){var ndtext="function"==typeof prop.data&&$("#"+prop.id).length>0&&$("#"+prop.id).find("#searchList").val().length>0?prop.searchNotFoundText:prop.noDataText;html='<div class="zp_nodata"><span>'+ndtext+"</span></div>"}else prop.checkbox||prop.isMandatory||(html+='<li id="defaultSelect"><span>'+prop.defaultSelectText+"</span></li>"),$.each(data,function(index,val){valueDiv="<span>"+val.value+"</span>",void 0!=val.image&&(val.imageAlt=void 0==val.imageAlt?"":val.imageAlt,ulClass="LI",imageDiv=CommonTemplates.returnImgDiv(val.image,val.imageAlt)),void 0!=val.dataType&&(dataTypeDiv="<font>"+val.dataType+"</font>"),prop.icon&&(valueDiv='<i class="'+val.value+'"></i>'),void 0!=val.iconClass&&(ulClass="LI",iconDiv='<i class="'+val.iconClass+' lft"></i>'),(void 0!=val.image&&prop.checkbox||void 0!=val.dataType||void 0!=val.iconClass&&prop.checkbox)&&(ulClass="LRI");var attributes="";for(var attr in val)"image"!=attr&&"imageAlt"!=attr&&"dataType"!=attr&&(attributes+="value"==attr?'name="'+val.value+'" ':attr+'="'+val[attr]+'" ');html+="<li "+attributes+">"+iconDiv+checkbox+imageDiv+valueDiv+dataTypeDiv+"</li>"});return'<ul class="'+ulClass+'">'+html+"</ul>"},setCSS:function(prop){var currentObj=prop.initobj,bound=$(currentObj)[0].getBoundingClientRect(),enclosureDiv=$(prop.initobj).closest("div"),enclosureBound=$(enclosureDiv)[0].getBoundingClientRect();$(prop.initobj).scrollParent().on("scroll",function(){ZPMenu.removeDropDown(prop.border,prop.initobj)});var heightoffset=$("#wrapper").height()-(enclosureBound.top+enclosureBound.height),maxheight=300;if(maxheight=heightoffset-maxheight>=45?maxheight:heightoffset-45,$(div).find("div.zpD_scrl").css({"max-height":maxheight+"px"}),$(prop.initobj).is("input")||$(prop.initobj).is("dd")){prop.border&&(enclosureDiv=ZPMenu.getDropdownBoxBoundary(prop),enclosureBound=$(enclosureDiv)[0].getBoundingClientRect());var height=$(enclosureDiv).outerHeight(),width=enclosureBound.width;div.css({top:enclosureBound.top+height,left:enclosureBound.left,width:width}),$(prop.initobj).on("resize",function(){var height=$(enclosureDiv).outerHeight(),width=enclosureBound.width;div.css({top:enclosureBound.top+height,left:enclosureBound.left,width:width})})}else{var leftTabs=$("#zpeople_tabs_container")[0],rpaneBound={x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0};$("#zp_main_subtabs").length>0&&(leftTabs=$("#zp_main_subtabs")[0]),$(".zp_rpane").length>0&&(rpaneBound=$(".zp_rpane")[0].getBoundingClientRect());var subtabsBound=leftTabs.getBoundingClientRect(),boundToLeftDistance=0==subtabsBound.right?Math.abs(bound.right):Math.abs(subtabsBound.right-bound.right);(0==rpaneBound.left?Math.abs($(window).width()-bound.left):Math.abs(rpaneBound.left-bound.left))>boundToLeftDistance?div.css({width:FIXED_WIDTH,left:bound.left,top:bound.top+bound.height}):div.css({width:FIXED_WIDTH,left:bound.right-FIXED_WIDTH,top:bound.top+bound.height})}},selectFromList:function(prop){$("."+prop.dropdownclass+" li:not(#searchTag)").on("click",function(ev){if("submenu"!==$(this).attr("dataval")){void 0===ev&&(ev=window.event),ev.stopPropagation?(ev.preventDefault(),ev.stopPropagation()):(ev.cancelBubble=!0,ev.returnValue=!1);var val="",id="";if(prop.checkbox){if($(this).toggleClass("sel"),$(this).find("font").length>0&&$(this).find("font").toggleClass("DN"),$(this).hasClass("sel")){imageDiv="";val=$(this).attr("name"),id=$(this).attr("id"),$(this).find("div.ZP_photo").length>0&&(imageDiv=$(this).find("div.ZP_photo").get(0).outerHTML),""!=$(this).attr("iconClass")&&void 0!=$(this).attr("iconClass")&&(imageDiv='<i class="'+$(this).attr("iconClass")+'"></i>'),""!=$(prop.initobj).attr("selectedIds")&&void 0!=$(prop.initobj).attr("selectedIds")||$(prop.initobj).html(""),ZPMenu.constructTag($(prop.initobj),imageDiv,ZPeople.escapeHtml(val),$(this).attr("id"),prop.callbackOnCancel,prop),id=""!=$(prop.initobj).attr("selectedIds")&&void 0!=$(prop.initobj).attr("selectedIds")?$(prop.initobj).attr("selectedIds")+","+$(this).attr("id"):$(this).attr("id"),$(prop.initobj).attr("selectedIds",id)}else $(prop.initobj).siblings("div.zp_Tg").find("i[id="+$(this).attr("id")+"]").trigger("click");$("div#"+prop.id+" #searchList").length>0?$("div#"+prop.id+" #searchList").trigger("focus"):$(prop.initobj).trigger("focus")}else{if(val=$(this).attr("name"),prop.icon)!$(prop.initobj).is("i")||""!=prop.callback&&void 0!=prop.callback||$(prop.initobj).attr("class",val);else{var imageDiv="";$(this).find("div.ZP_photo").length>0&&(imageDiv=$(this).find("div.ZP_photo").get(0).outerHTML),""!=$(this).attr("iconClass")&&void 0!=$(this).attr("iconClass")&&(imageDiv='<i class="'+$(this).attr("iconClass")+'"></i>'),id=$(this).attr("id"),($(prop.initobj).is("input")||$(prop.initobj).is("dd"))&&($(prop.initobj).is("input")?(ZPMenu.setValuesinInput(prop,ZPeople.escapeHtml(val),imageDiv),$(prop.initobj).trigger("blur")):$(prop.initobj).html("<span>"+ZPeople.escapeHtml(val)+"</span>"),$(prop.initobj).attr("selectedIds",id))}ZPMenu.removeDropDown(prop.border,prop.initobj)}""!=prop.callback&&prop.callback(this,prop.initobj)}})},setValuesinInput:function(prop,val,imageDiv){$(prop.initobj).closest("div").find("div.zp_Tg").remove(),ZPMenu.constructTag(prop.initobj,imageDiv,val,"",prop.callbackOnCancel,prop)},isValidKeycode:function(e){var keycode=e.which;return keycode>47&&keycode<58||32==keycode||keycode>64&&keycode<91||keycode>95&&keycode<112||keycode>185&&keycode<193||keycode>218&&keycode<223},recursiveDataFunctionCall:function(prop){setTimeout(function(){$(prop.initobj).zpmenu(prop)},100)},constructTag:function(initObj,imageDiv,val,id,callbackOnCancel,prop){var closeButton=""!=id?'<i name="close" class="IC-cls-1px" id="'+id+'"></i>':"",tagHtml='<div class="zp_Tg '+(prop.checkbox||""!=closeButton?"":"notg")+'">'+imageDiv+val+closeButton+"</div>";$(initObj).is("input")?$(tagHtml).insertBefore($(initObj)):$(initObj).find("span[id=tagCover]").length<=0?$(initObj).find("span[id=tagCover]").find("div[id=selTag]").append(tagHtml):$(initObj).prepend('<span id="tagCover">'+tagCoverHtml+"</span>"),""!=closeButton&&($(initObj).siblings("div[class=zp_Tg]").find(" i#"+id).off("click"),$(initObj).siblings("div[class=zp_Tg]").find(" i#"+id).on("click",function(e){e.stopPropagation(),ZPMenu.clearValue(this,initObj,callbackOnCancel)}))},constructOutlineBox:function(prop){$(prop.initobj).is("input")?($(prop.initobj).closest("div").addClass("ddn"),$(prop.initobj).siblings("div[class=zp_hd]").remove(),$(prop.initobj).closest("div.ddn").prepend('<div class="zp_hd"></div>')):$(prop.initobj).is("li")?($(prop.initobj).find("b .zp_hd").remove(),$(prop.initobj).find("b").addClass("ddn"),$(prop.initobj).find("b").prepend('<div class="zp_hd"></div>')):$(prop.initobj).is("dd")&&($(prop.initobj).siblings("div[class=zp_hd]").remove(),$(prop.initobj).closest("div.zp_info").addClass("ddn"),$('<div class="zp_hd"></div>').insertAfter($(prop.initobj)))},removeDropDown:function(hasBorder,initobj,callbackonclose){void 0!=callbackonclose&&"function"==typeof callbackonclose&&callbackonclose(initobj),hasBorder&&(ZPMenu.removeBorderDropDown(initobj),$(initobj).is("input")&&ZPSelect.removeMenu(initobj)),$('[ddown="true"]').remove()},removeBorderDropDown:function(initobj){$(initobj).is("input")?($(initobj).siblings("div[class=zp_hd]").remove(),$(initobj).closest("div.ddn").removeClass("ddn")):$(initobj).is("li")?($(initobj).find("b .zp_hd").remove(),$(initobj).find("b").removeClass("ddn")):$(initobj).is("dd")&&($(initobj).siblings("div[class=zp_hd]").remove(),$(initobj).closest("div.ddn").removeClass("ddn"))},getDropdownBoxBoundary:function(prop){if($(prop.initobj).is("input")||$(prop.initobj).is("dd"))return $(prop.initobj).closest("div.ddn")},searchList:function(prop,div,setTopCallback){if(prop.search){var object=$(this);$(div).find("#searchList").length>0&&(object=$(div).find("#searchList")),$(object).trigger("focus"),"function"!=typeof prop.data&&($(object).off("keyup"),$(object).on("keyup focus",function(e){$(div).find("li:not(#searchTag)").addClass("zp_dyn");var data=this.value.trim(),showNoData=!0,isExactMatch=$(div).find("li:not(#searchTag):Equals('"+data+"')").length>0;if(prop.enableAddNewItem&&($(div).find("ul:not(.zp_dsrc)").find("li[type=newdata]").remove(),!isExactMatch&&data.length>=2&&!ZPSelect.isNewValueDuplicated(prop.initobj,data))){showNoData=!1,$(div).find("ul:not(.zp_dsrc)").append('<li class="zp_nodata" type="newdata" name="'+data+'"><span>'+ZPI18N.getString("zp.create")+" : "+data+"</span></li>");var actionLi=$(div).find("ul:not(.zp_dsrc)").find("li[type=newdata]");void 0!=prop.newItemInternalCallback&&"function"==typeof prop.newItemInternalCallback&&actionLi.on("click",function(e){e.stopPropagation(),e.preventDefault(),prop.newItemInternalCallback(actionLi,e,prop)})}data=data.split(/ +/),$.each(data,function(i,v){$(div).find("li:not(#searchTag):Contains('"+v+"')").removeClass("zp_dyn"),$(div).find("li:not(.zp_dyn,#searchTag)").length<=0&&showNoData?($(div).find("div.zp_nodata").remove(),$(div).find("ul:not(.zp_dsrc)").prepend('<div class="zp_nodata"><span>'+prop.searchNotFoundText+"<span></div>")):$(div).find("div.zp_nodata").remove(),void 0!=setTopCallback&&"function"==typeof setTopCallback&&setTopCallback(prop.initobj)})}))}},focusSearchBar:function(id){$("#"+id+" #searchTag").length>0&&$("#"+id+" #searchList").trigger("focus")},keypressEvents:function(prop,orderOfTraverse){$("#"+prop.id+" #ddList").off("keyup");$("#"+prop.id).add("#searchTag").off("keyup"),$("#"+prop.id).add("#searchTag").on("keyup",function(e){38==e.which||40==e.which||13==e.which||27==e.which?($("#"+prop.id+" #ddList").trigger("focus"),$("#"+prop.id+" #ddList").trigger(e)):8==e.which?void 0!=$("#"+prop.id+" #searchList").val()&&"function"==typeof prop.data&&ZPMenu.recursiveDataFunctionCall(prop):ZPMenu.isValidKeycode(e)&&"function"==typeof prop.data&&ZPMenu.recursiveDataFunctionCall(prop)}),ZPMenu.keypressResponse(prop,-1,orderOfTraverse)},keypressResponse:function(prop,liIndex,orderOfTraverse){$("#"+prop.id+" #ddList").on("keyup",function(e){switch(e.stopPropagation(),e.preventDefault(),e.which){case 38:var oBoxCollection=$("#"+prop.id+" li:not(#searchTag):not(.zp_dyn)");(liIndex+=-1)>=oBoxCollection.length&&(liIndex=0),liIndex<0&&(liIndex=oBoxCollection.length-1);var cssClass="hvr";oBoxCollection.removeClass(cssClass).eq(liIndex).addClass(cssClass);var docViewBottom=(docViewTop=$("div.zpD_scrl").scrollTop()+$("div.zpD_scrl").offset().top)+$("div.zpD_scrl").height();(elemBottom=(elemTop=$("."+prop.dropdownclass+" li.hvr").offset().top)+$("."+prop.dropdownclass+" li.hvr").height())<=docViewBottom&&elemTop>=docViewTop||(elemTop<docViewTop?$("div.zpD_scrl").scrollTop($("div.zpD_scrl").scrollTop()-($("div.zpD_scrl").offset().top-elemTop)):elemBottom>docViewBottom&&$("div.zpD_scrl").scrollTop(docViewBottom+(elemBottom-docViewBottom)));break;case 40:oBoxCollection=$("#"+prop.id+" li:not(#searchTag):not(.zp_dyn)");(liIndex+=1)>=oBoxCollection.length&&(liIndex=0),liIndex<0&&(liIndex=oBoxCollection.length-1);cssClass="hvr";oBoxCollection.removeClass(cssClass).eq(liIndex).addClass(cssClass);var docViewTop,elemTop,elemBottom;docViewBottom=(docViewTop=$("div.zpD_scrl").scrollTop()+$("div.zpD_scrl").offset().top)+$("div.zpD_scrl").height();if(!((elemBottom=(elemTop=$("li.hvr").offset().top)+$("."+prop.dropdownclass+" li.hvr").height())<=docViewBottom&&elemTop>=docViewTop))if(elemTop<docViewTop)$("div.zpD_scrl").scrollTop($("div.zpD_scrl").scrollTop()-($("div.zpD_scrl").offset().top-elemTop));else if(elemBottom>docViewBottom){$("div.zpD_scrl").scrollTop(),$("div.zpD_scrl").scrollTop();$("div.zpD_scrl").scrollTop(docViewBottom+docViewBottom)}break;case 13:$("#"+prop.id+" li.hvr:not(.zp_dyn)").trigger("click");break;case 27:ZPMenu.removeDropDown(prop.border,prop.initobj)}})}};jQuery.expr.pseudos.Contains=function(a,i,m){return jQuery(a).text().toUpperCase().indexOf(m[3].toUpperCase())>=0},jQuery.expr.pseudos.Equals=function(a,i,m){return jQuery(a).text().toUpperCase()==m[3].toUpperCase()},$.fn.zpselect=function(menuProp){menuProp=$.extend({callback:"",callbackOnCancel:"",dropdownclass:"zp_drop",scrollclass:"ob_center",initobj:$(this),data:"",id:"",selectedVal:[],search:!0,checkbox:!1,border:!0,isMandatory:!1,noDataText:ZPI18N.getString("zp.noresults"),searchNotFoundText:ZPI18N.getString("zp.nomatchesfound"),defaultSelectText:ZPI18N.getString("zp.select"),enableAddNewItem:!1,addNewData:{callback:""},newItemInternalCallback:function(obj,ev,menuProp){ZPSelect.selectionLogic(obj,ev,menuProp),menuProp.addNewData.hasOwnProperty("callback")&&"function"==typeof menuProp.addNewData.callback&&menuProp.addNewData.callback(obj,menuProp.initobj)}},menuProp);if($(document).off("click.ddown").on("click.ddown",function(e){$("."+menuProp.dropdownclass).length>0&&(e.stopPropagation(),0==$("."+menuProp.dropdownclass).has($(e.target)).length&&0==$(menuProp.initobj).has($(e.target)).length&&!$(menuProp.initobj).is($(e.target))&&!$("."+menuProp.dropdownclass).is($(e.target))&&$(e.target).closest("[zpmenu=true]").length<=0&&(ZPSelect.removeMenu(menuProp.initobj,menuProp.dropdownclass),isinside=!1))}),menuProp.selectedVal.length>0)ZPSelect.selectValues(menuProp,menuProp.selectedVal);else{if("function"!=typeof menuProp.data)ZPSelect.constructList(menuProp,menuProp.data);else{var list=menuProp.data($("div#"+menuProp.id+" #searchList"));if($("div#"+menuProp.id).length<=0)ZPSelect.constructList(menuProp,list);else{$("#"+menuProp.id+" #ddList").html(ZPMenu.constructValuesInBox(menuProp,list));var data=$("div#"+menuProp.id+" #searchList").val().trim();if(""!=data&&"function"==typeof menuProp.data){var showNoData=!0,isExactMatch=$(div).find("li:not(#searchTag):Equals('"+data+"')").length>0;if(menuProp.enableAddNewItem){if($("div#"+menuProp.id).find("ul:not(.zp_dsrc)").find("li[type=newdata]").remove(),!isExactMatch&&data.trim().length>=2&&!ZPSelect.isNewValueDuplicated(menuProp.initobj,data)){showNoData=!1,$(div).find("ul:not(.zp_dsrc)").append('<li class="zp_nodata" type="newdata" name="'+ZPeople.escapeHtml(data)+'"><span>'+ZPI18N.getString("zp.create")+" : "+ZPeople.escapeHtml(data)+"</span></li>");var actionLi=$(div).find("ul:not(.zp_dsrc)").find("li[type=newdata]");void 0!=menuProp.newItemInternalCallback&&"function"==typeof menuProp.newItemInternalCallback&&$(actionLi).off("click").on("click",function(e){e.stopPropagation(),e.preventDefault(),menuProp.newItemInternalCallback(actionLi,e,menuProp)})}showNoData||$(div).find("#ddList").find("div.zp_nodata").remove()}}}}selectMenu=$("div#"+menuProp.id);ZPSelect.setCSS(menuProp);ZPMenu.chooseSelectedValueinList(menuProp),ZPMenu.searchList(menuProp,selectMenu,function(obj){ZPSelect.setTop(obj)}),ZPSelect.selectFromList(menuProp),ZPMenu.focusSearchBar(menuProp.id),ZPSelect.keypressEvents(menuProp)}};var ZPSelect={timer:null,selectFromList:function(prop){$("."+prop.dropdownclass+" li:not(#searchTag):not(.zp_nodata)").off("click").on("click",function(ev){ZPSelect.selectionLogic(this,ev,prop)})},isNewValueDuplicated:function(initObj,value){var isduplicate=!1,values=$(initObj).attr("newvalues");void 0!=values&&""!=values&&(isduplicate=-1!=values.split(",").indexOf(value));return isduplicate},selectionLogic:function(obj,ev,prop){void 0===ev&&(ev=window.event),ev.stopPropagation?(ev.preventDefault(),ev.stopPropagation()):(ev.cancelBubble=!0,ev.returnValue=!1);var val="",id="";if(prop.checkbox){if(val=$(obj).attr("name"),$(obj).toggleClass("sel"),$(obj).find("font").length>0&&$(obj).find("font").toggleClass("DN"),"newdata"==$(obj).attr("type")){if($(obj).hasClass("sel")){ZPSelect.constructTag("",ZPeople.escapeHtml(val),"newdata",prop);var newvalues=""!=$(prop.initobj).attr("newvalues")&&void 0!=$(prop.initobj).attr("newvalues")?$(prop.initobj).attr("newvalues")+","+$(obj).attr("name").trim():$(obj).attr("name").trim();return $(prop.initobj).attr("newvalues",newvalues),void ZPSelect.removeMenu(prop.initobj)}$(prop.initobj).siblings("div.zp_Tg").find("i[value="+$(obj).attr("name")+"]").trigger("click")}else if($(obj).hasClass("sel")){imageDiv="";val=$(obj).attr("name"),id=$(obj).attr("id"),$(obj).find("div.ZP_photo").length>0&&(imageDiv=$(obj).find("div.ZP_photo").get(0).outerHTML),""!=$(obj).attr("iconClass")&&void 0!=$(obj).attr("iconClass")&&(imageDiv='<i class="'+$(obj).attr("iconClass")+'"></i>'),""!=$(prop.initobj).attr("selectedIds")&&void 0!=$(prop.initobj).attr("selectedIds")||$(prop.initobj).html(""),ZPSelect.constructTag(imageDiv,ZPeople.escapeHtml(val),id,prop),id=""!=$(prop.initobj).attr("selectedIds")&&void 0!=$(prop.initobj).attr("selectedIds")?$(prop.initobj).attr("selectedIds")+","+$(obj).attr("id"):$(obj).attr("id"),$(prop.initobj).attr("selectedIds",id)}else $(prop.initobj).siblings("div.zp_Tg").find("i[id="+$(obj).attr("id")+"]").trigger("click");$("div#"+prop.id+" #searchList").length>0?$("div#"+prop.id+" #searchList").trigger("focus"):$(prop.initobj).trigger("focus")}else{if(val=$(obj).attr("name"),"defaultSelect"==(id=void 0==(id=$(obj).attr("id"))?"":id))return ZPSelect.clearAllValues(prop.initobj,prop.callbackOnCancel),void ZPSelect.removeMenu(prop.initobj);if("newdata"==$(obj).attr("type"))return $(prop.initobj).attr("selectedIds",""),$(prop.initobj).attr("newvalues",val.trim()),ZPSelect.singleSelectValues(prop,ZPeople.escapeHtml(val),"newdata",""),void ZPSelect.removeMenu(prop.initobj);if(prop.icon)!$(prop.initobj).is("i")||""!=prop.callback&&void 0!=prop.callback||$(prop.initobj).attr("class",val);else{if($(prop.initobj).attr("selectedIds")==id)return ZPSelect.removeMenu(prop.initobj,prop.dropdownclass),!1;var imageDiv="";$(obj).find("div.ZP_photo").length>0&&(imageDiv=$(obj).find("div.ZP_photo").get(0).outerHTML),""!=$(obj).attr("iconClass")&&void 0!=$(obj).attr("iconClass")&&(imageDiv='<i class="'+$(obj).attr("iconClass")+'"></i>'),ZPSelect.singleSelectValues(prop,ZPeople.escapeHtml(val),id,imageDiv),$(prop.initobj).trigger("blur"),$(prop.initobj).attr("selectedIds",id)}ZPSelect.removeMenu(prop.initobj,prop.dropdownclass)}""!=prop.callback&&"newdata"!=$(obj).attr("type")&&prop.callback(obj,prop.initobj)},keypressEvents:function(prop,orderOfTraverse){$("#"+prop.id+" #ddList").off("keyup");$("#"+prop.id).add("#searchTag").off("keyup"),$("#"+prop.id).add("#searchTag").on("keyup",function(e){38==e.which||40==e.which||13==e.which||27==e.which?($("#"+prop.id+" #ddList").trigger("focus"),$("#"+prop.id+" #ddList").trigger(e)):8==e.which?void 0!=$("#"+prop.id+" #searchList").val()&&"function"==typeof prop.data&&(clearTimeout(ZPSelect.timer),ZPSelect.timer=null,ZPSelect.timer=setTimeout(function(){ZPSelect.recursiveDataFunctionCall(prop)},700)):ZPMenu.isValidKeycode(e)&&"function"==typeof prop.data&&(clearTimeout(ZPSelect.timer),ZPSelect.timer=null,ZPSelect.timer=setTimeout(function(){ZPSelect.recursiveDataFunctionCall(prop)},700))}),ZPMenu.keypressResponse(prop,-1,orderOfTraverse)},boxPosition:"bottom",setCSS:function(menuProp){var currentObj=menuProp.initobj,enclosureDiv=($(currentObj)[0].getBoundingClientRect(),$(menuProp.initobj).closest("div.ddn")),enclosureBound=$(enclosureDiv)[0].getBoundingClientRect();$(menuProp.initobj).scrollParent().on("scroll",function(){ZPMenu.removeDropDown(menuProp.border,menuProp.initobj)});var height=$(enclosureDiv).outerHeight(),width=enclosureBound.width,heightoffset=$("#wrapper").height()-(enclosureBound.top+height),actualMaxHeight=300,availableheight=heightoffset-300>=45?300:heightoffset-45;return 80>availableheight?(ZPSelect.boxPosition="top",actualMaxHeight=80,$(enclosureDiv).addClass("dtn"),$(selectMenu).addClass("btmShdw")):(ZPSelect.boxPosition="bottom",$(enclosureDiv).removeClass("dtn"),$(selectMenu).removeClass(""),actualMaxHeight=300>availableheight?availableheight:300),$(selectMenu).find("div.zpD_scrl").css({"max-height":actualMaxHeight+"px"}),ZPSelect.setTop(currentObj),selectMenu.css({left:enclosureBound.left,width:width}),"bottom"==ZPSelect.boxPosition?$(selectMenu.find("#searchTag").closest("ul")).insertBefore($("#ddList")):$(selectMenu.find("#searchTag").closest("ul")).insertAfter($("#ddList")),"bottom"==ZPSelect.boxPosition?ZPMenu.FORWARD_TRAVERSE:ZPMenu.REVERSE_TRAVERSE},setTop:function(sourceObj){var enclosureDiv=$(sourceObj).closest("div.ddn"),enclosureBound=$(enclosureDiv)[0].getBoundingClientRect(),height=$(enclosureDiv).outerHeight(),selectMenuTop=enclosureBound.top+height;selectMenuTop="top"==ZPSelect.boxPosition?enclosureBound.top-$(selectMenu).height():enclosureBound.top+height,selectMenu.css({top:selectMenuTop})},selectValues:function(menuProp,data){$(menuProp.initobj).attr("selectedIds",""),$.each(data,function(index,val){var imageDiv="";void 0!=val.image||void 0!=val.imageAlt?imageDiv=CommonTemplates.returnImgDiv(val.image,val.imageAlt):""!=val.iconClass&&void 0!=val.iconClass&&(imageDiv='<i class="'+val.iconClass+'"></i>'),setTimeout(function(){menuProp.checkbox?ZPSelect.constructTag(imageDiv,val.text,val.id,menuProp):ZPSelect.singleSelectValues(menuProp,val.text,val.id,imageDiv)},100),$(menuProp.initobj).siblings("div[class=zp_Tg]").off("click");var id=""!=$(menuProp.initobj).attr("selectedIds")&&void 0!=$(menuProp.initobj).attr("selectedIds")?$.inArray(val.id,$(menuProp.initobj).attr("selectedIds").split(","))>-1?val.id:$(menuProp.initobj).attr("selectedIds")+","+val.id:val.id;$(menuProp.initobj).attr("selectedIds",id),$(menuProp.initobj).find("i#"+val.id).off("click").on("click",function(e){e.stopPropagation(),ZPMenu.clearValue(this,menuProp.initobj,menuProp.callbackOnCancel)})})},constructOutline:function(sourceObj){$(sourceObj).closest("div").addClass("ddn"),$(sourceObj).siblings("div[class=zp_hd]").remove(),$(sourceObj).closest("div.ddn").prepend('<div class="zp_hd"></div>')},constructList:function(menuProp,data){$('[ddown="true"]').length>0&&ZPMenu.removeDropDown(!0,$('[ddown="true"]').data("sourceObj")),ZPSelect.constructOutline(menuProp.initobj);var html,outerDiv=$('<div ddown="true" class="'+menuProp.dropdownclass+' zp_shw" id="'+menuProp.id+'"></div>'),searchBox="";menuProp.search&&(searchBox='<ul class="zp_dsrc"><li id="searchTag" tabindex="1"><input id="searchList" placeholder="'+ZPI18N.getString("zp.search")+'" type="text"></li></ul>'),html=ZPMenu.constructValuesInBox(menuProp,data),$(outerDiv).append("<div>"+searchBox+'<div id="ddList" class="zpD_scrl">'+html+"</div></div>"),div=$(outerDiv),$("body").append(div),$("#"+menuProp.id).data("sourceObj",menuProp.initobj)},singleSelectValues:function(menuProp,val,id,imageDiv){$(menuProp.initobj).closest("div").find("div.zp_Tg").remove(),ZPSelect.constructTag(imageDiv,val,id,menuProp)},constructTag:function(imageDiv,val,id,menuProp){var type="newdata"==id?'type = "newdata" value = "'+val+'"':"",closeButton=menuProp.checkbox?'<i name="close" class="IC-cls-1px" '+type+' id="'+id+'"></i>':"",notag=menuProp.checkbox?"":"notg",tagHtml=$('<div class="zp_Tg">'+imageDiv+val+closeButton+"</div>");tagHtml.insertBefore($(menuProp.initobj)),$(menuProp.initobj).closest("div").addClass(notag),$(menuProp.initobj).siblings("div[class=zp_Tg]").attr("zpmenu",!0),$(menuProp.initobj).siblings("div[class=zp_Tg]").off("click").on("click",function(){menuProp.selectedVal.length<=0&&ZPSelect.recursiveDataFunctionCall(menuProp)}),ZPSelect.resetInputSize(menuProp.initobj,""!=menuProp.id?$("#"+menuProp.id):$()),""!=closeButton&&tagHtml.find("i").off("click").on("click",function(e){e.stopPropagation(),ZPMenu.clearValue(this,menuProp.initobj,menuProp.callbackOnCancel),ZPSelect.resetInputSize(menuProp.initobj,""!=menuProp.id?$("#"+menuProp.id):$())})},resetInputSize:function(initObj,selectMenu){var maxLength=$(initObj).closest("div").outerWidth()-80,availLength=maxLength;$(initObj).siblings("div[class=zp_Tg]").each(function(i){availLength<$(this).outerWidth()&&(availLength=maxLength),availLength-=$(this).outerWidth()}),availLength>0?$(initObj).outerWidth(availLength):$(initObj).outerWidth(0),"bottom"==ZPSelect.boxPosition&&selectMenu.length>0&&selectMenu.css({top:$(initObj).closest("div.ddn").offset().top+$(initObj).closest("div.ddn").outerHeight()})},removeMenu:function(sourceObj){$(sourceObj).siblings("div[class=zp_hd]").remove(),$(sourceObj).closest("div.ddn").removeClass("ddn"),$('[ddown="true"]').remove()},destroyMenu:function(sourceObj){ZPSelect.removeMenu(sourceObj),$(sourceObj).empty()},removeAllMenuBoxes:function(){$("div[class=zp_hd]").remove(),$("div.ddn").removeClass("ddn")},recursiveDataFunctionCall:function(prop){setTimeout(function(){$(prop.initobj).zpselect(prop)},100)},clearAllValues:function(initObj,callbackOnCancel){$(initObj).siblings("div[class=zp_Tg]").remove(),$(initObj).attr("selectedIds",""),$(initObj).removeAttr("style"),void 0!=callbackOnCancel&&"function"==typeof callbackOnCancel&&callbackOnCancel(initObj)}};$.fn.zparrowmenu=function(menuProp){menuProp=$.extend({callback:"",callbackOnCancel:"",callbackonclose:"",dropdownclass:"zp_arm",scrollclass:"ob_center",initobj:$(this),data:"",id:"",search:!1,checkbox:!1,border:!1,isMandatory:!0,noArrow:!1,noDataText:ZPI18N.getString("zp.noresults"),searchNotFoundText:ZPI18N.getString("zp.nomatchesfound"),defaultSelectText:ZPI18N.getString("zp.select"),actionButton:!1,actionText:"",actionCallback:"",oneTimeMenu:!1},menuProp);var isinside=!0;if($(document).off("click.ddown").on("click.ddown",function(e){if($("."+menuProp.dropdownclass).length>0&&(e.stopPropagation(),e.preventDefault(),0==$("."+menuProp.dropdownclass).has($(e.target)).length&&0==$(menuProp.initobj).has($(e.target)).length&&!$(menuProp.initobj).is($(e.target))&&!$("."+menuProp.dropdownclass).is($(e.target))&&$(e.target).closest("[zpmenu=true]").length<=0))return ZPMenu.removeDropDown(!1,menuProp.initobj,menuProp.callbackonclose),void(isinside=!1)}),isinside){if(("function"==typeof menuProp.data||menuProp.data.length>ZPArrow.MIN_SCROLL_LENGTH)&&!menuProp.icon&&(menuProp.search=!0),"function"!=typeof menuProp.data)ZPArrow.constructList(menuProp,menuProp.data);else{var list=menuProp.data($("div#"+menuProp.id+" #searchList"));$("div#"+menuProp.id).length<=0?ZPArrow.constructList(menuProp,list):$("#"+menuProp.id+" #ddList").html(ZPMenu.constructValuesInBox(menuProp,list))}arrowMenu=$("div#"+menuProp.id);var orderOfTraverse=ZPArrow.setCSS(menuProp);ZPMenu.chooseSelectedValueinList(menuProp);var callback="";orderOfTraverse==ZPMenu.REVERSE_TRAVERSE&&(callback=function(obj){ZPArrow.resetTop(obj,menuProp)}),menuProp.actionButton&&(menuProp.searchAction=function(actionLi,initobj){if(void 0!=menuProp.actionCallback&&"function"==typeof menuProp.actionCallback){var actionDataObject=menuProp.actionCallback(actionLi,initobj);menuProp.data.push(actionDataObject),ZPArrow.selectFromList(menuProp)}ZPMenu.removeDropDown(!1,initobj,menuProp.callbackonclose)}),ZPMenu.searchList(menuProp,arrowMenu,function(obj){""!=callback&&callback(obj)}),ZPArrow.selectFromList(menuProp),ZPMenu.focusSearchBar(menuProp.id),ZPArrow.keypressEvents(menuProp,orderOfTraverse)}};var ZPArrow={MAX_HEIGHT:250,ARROW_HEIGHT:12,ARROW_OFFSET:30,MIN_SCROLL_LENGTH:5,NO_ARROW:"na",BOTTOM_CENTER:"tp",BOTTOM_LEFT:"tpl",BOTTOM_RIGHT:"tpr",RIGHT_CENTER:"lt",RIGHT_TOP:"ltt",RIGHT_BOTTOM:"ltb",LEFT_CENTER:"rt",LEFT_TOP:"rtt",LEFT_BOTTOM:"rtb",TOP_CENTER:"btAr",TOP_LEFT:"btl",TOP_RIGHT:"btr",constructList:function(prop,data){$('[ddown="true"]').length>0&&ZPMenu.removeDropDown(!0,$('[ddown="true"]').data("sourceObj"),prop.callbackonclose),prop.border&&ZPMenu.constructOutlineBox(prop);var html,outerDiv=$('<div ddown="true" class="'+prop.dropdownclass+'" id="'+prop.id+'"></div>'),searchBox="";prop.search&&(searchBox='<ul class="zp_dsrc"><li id="searchTag" tabindex="1"><input id="searchList" placeholder="'+ZPI18N.getString("zp.search")+'" type="text"></li></ul>'),html=ZPMenu.constructValuesInBox(prop,data),$(outerDiv).append(searchBox+'<div id="ddList" class="zpD_scrl">'+html+"</div>"),div=$(outerDiv);prop.initobj.height();$("body").append(div),$("#"+prop.id).data("sourceObj",prop.initobj)},setCSS:function(prop){var arrowHeight=prop.noArrow?0:ZPArrow.ARROW_HEIGHT;ZPArrow.FIXED_WIDTH=void 0!=prop.width?prop.width<150?150:prop.width:prop.icon?500:250,$(prop.initobj).scrollParent().on("scroll",function(){ZPMenu.removeDropDown(prop.border,prop.initobj,prop.callbackonclose)});var boxPosition={left:!1,right:!1,top:!1,bottom:!1},arrowPosition={left:!1,right:!1,center:!1,top:!1,bottom:!1};arrowMenu.css({width:ZPArrow.FIXED_WIDTH}),$(arrowMenu).find("div.zpD_scrl").css({"max-height":ZPArrow.MAX_HEIGHT+"px"});var arrowMenuHeight=arrowMenu.outerHeight(),arrowPositioningHeight=prop.search?ZPArrow.MAX_HEIGHT:arrowMenuHeight,currentObj=prop.initobj,bound=$(currentObj)[0].getBoundingClientRect(),currentBoundCenterX=bound.width/2+bound.left,currentBoundCenterY=bound.height/2+bound.top,leftTabs=$("#zpeople_tabs_container")[0];$("#zp_main_subtabs").length>0&&(leftTabs=$("#zp_main_subtabs")[0]);var subtabsBound=leftTabs.getBoundingClientRect(),rpaneBound={x:0,y:0,width:0,height:0,top:0,right:0,bottom:0,left:0};$(".zp_rpane").length>0&&(rpaneBound=$(".zp_rpane")[0].getBoundingClientRect());var hasPosition=prop.hasOwnProperty("position")&&""!=prop.position&&void 0!=prop.position,boundToLeftDistance=0==subtabsBound.right?Math.abs(bound.right):Math.abs(subtabsBound.right-bound.right),boundToRightDistance=0==rpaneBound.left?Math.abs($(window).width()-bound.left):Math.abs(rpaneBound.left-bound.left),boundToTopDistance=bound.top,boundToBottomDistance=$("#wrapper").height()-bound.bottom;return!hasPosition&&boundToLeftDistance>ZPArrow.FIXED_WIDTH/2&&boundToRightDistance>ZPArrow.FIXED_WIDTH/2&&boundToBottomDistance>arrowPositioningHeight||hasPosition&&prop.position==ZPArrow.BOTTOM_CENTER?(arrowPosition.center=!0,boxPosition.bottom=!0,arrowMenu.css({left:bound.left-(ZPArrow.FIXED_WIDTH/2-bound.width/2),top:bound.top+bound.height+arrowHeight})):!hasPosition&&boundToRightDistance>ZPArrow.FIXED_WIDTH&&boundToBottomDistance>arrowPositioningHeight||hasPosition&&prop.position==ZPArrow.BOTTOM_LEFT?(arrowPosition.left=!0,boxPosition.bottom=!0,arrowMenu.css({left:currentBoundCenterX-ZPArrow.ARROW_OFFSET,top:bound.top+bound.height+arrowHeight})):!hasPosition&&boundToLeftDistance>ZPArrow.FIXED_WIDTH&&boundToBottomDistance>arrowPositioningHeight||hasPosition&&prop.position==ZPArrow.BOTTOM_RIGHT?(arrowPosition.right=!0,boxPosition.bottom=!0,arrowMenu.css({left:currentBoundCenterX-ZPArrow.FIXED_WIDTH+ZPArrow.ARROW_OFFSET,top:bound.top+bound.height+arrowHeight})):!hasPosition&&boundToBottomDistance>arrowPositioningHeight&&boundToRightDistance>ZPArrow.FIXED_WIDTH||hasPosition&&prop.position==ZPArrow.RIGHT_TOP?(arrowPosition.top=!0,boxPosition.right=!0,arrowMenu.css({left:bound.left+bound.width+arrowHeight,top:currentBoundCenterY-ZPArrow.ARROW_OFFSET})):!hasPosition&&boundToTopDistance>arrowPositioningHeight/2&&boundToBottomDistance>arrowPositioningHeight/2&&boundToRightDistance>ZPArrow.FIXED_WIDTH||hasPosition&&prop.position==ZPArrow.RIGHT_CENTER?(arrowPosition.center=!0,boxPosition.right=!0,arrowMenu.css({left:bound.left+bound.width+arrowHeight,top:bound.top-(arrowMenuHeight/2-bound.height/2)})):!hasPosition&&boundToTopDistance>arrowPositioningHeight&&boundToRightDistance>ZPArrow.FIXED_WIDTH||hasPosition&&prop.position==ZPArrow.RIGHT_BOTTOM?(arrowPosition.bottom=!0,boxPosition.right=!0,arrowMenu.css({left:bound.left+bound.width+arrowHeight,top:currentBoundCenterY-arrowMenuHeight+ZPArrow.ARROW_OFFSET})):!hasPosition&&boundToBottomDistance>arrowPositioningHeight&&boundToLeftDistance>ZPArrow.FIXED_WIDTH||hasPosition&&prop.position==ZPArrow.LEFT_TOP?(arrowPosition.top=!0,boxPosition.left=!0,arrowMenu.css({left:bound.left-ZPArrow.FIXED_WIDTH-arrowHeight,top:currentBoundCenterY-ZPArrow.ARROW_OFFSET})):!hasPosition&&boundToTopDistance>arrowPositioningHeight/2&&boundToBottomDistance>arrowPositioningHeight/2&&boundToLeftDistance>ZPArrow.FIXED_WIDTH||hasPosition&&prop.position==ZPArrow.LEFT_CENTER?(arrowPosition.center=!0,boxPosition.left=!0,arrowMenu.css({left:bound.left-ZPArrow.FIXED_WIDTH-arrowHeight,top:bound.top-(arrowMenuHeight/2-bound.height/2)})):!hasPosition&&boundToTopDistance>arrowPositioningHeight&&boundToLeftDistance>ZPArrow.FIXED_WIDTH||hasPosition&&prop.position==ZPArrow.LEFT_BOTTOM?(arrowPosition.bottom=!0,boxPosition.left=!0,arrowMenu.css({left:bound.left-ZPArrow.FIXED_WIDTH-arrowHeight,top:currentBoundCenterY-arrowMenuHeight+ZPArrow.ARROW_OFFSET})):!hasPosition&&boundToLeftDistance>ZPArrow.FIXED_WIDTH/2&&boundToRightDistance>ZPArrow.FIXED_WIDTH/2&&boundToTopDistance>arrowPositioningHeight||hasPosition&&prop.position==ZPArrow.TOP_CENTER?(arrowPosition.center=!0,boxPosition.top=!0,arrowMenu.css({left:bound.left-(ZPArrow.FIXED_WIDTH/2-bound.width/2),top:bound.top-arrowMenuHeight-arrowHeight})):!hasPosition&&boundToRightDistance>ZPArrow.FIXED_WIDTH&&boundToTopDistance>arrowPositioningHeight||hasPosition&&prop.position==ZPArrow.TOP_LEFT?(arrowPosition.left=!0,boxPosition.top=!0,arrowMenu.css({left:currentBoundCenterX-ZPArrow.ARROW_OFFSET,top:bound.top-arrowMenuHeight-arrowHeight})):(!hasPosition&&boundToLeftDistance>ZPArrow.FIXED_WIDTH&&boundToTopDistance>arrowPositioningHeight||hasPosition&&prop.position==ZPArrow.TOP_RIGHT)&&(arrowPosition.right=!0,boxPosition.top=!0,arrowMenu.css({left:currentBoundCenterX-ZPArrow.FIXED_WIDTH+ZPArrow.ARROW_OFFSET,top:bound.top-arrowMenuHeight-arrowHeight})),boxPosition.top&&prop.search?$(arrowMenu.find("#searchTag").closest("ul")).insertAfter($("#ddList")):$(arrowMenu.find("#searchTag").closest("ul")).insertBefore($("#ddList")),arrowMenu.attr("class",prop.dropdownclass+" zp_shw "+(prop.noArrow?ZPArrow.NO_ARROW:ZPArrow.getArrowClass(boxPosition,arrowPosition))),ZPArrow.getKeyPressDirection(boxPosition)},resetTop:function(sourceObj,prop){var bound=$(sourceObj)[0].getBoundingClientRect(),arrowHeight=prop.noArrow?0:ZPArrow.ARROW_HEIGHT,arrowMenuHeight=arrowMenu.outerHeight();arrowMenu.css({top:bound.top-arrowMenuHeight-arrowHeight})},getArrowClass:function(boxPosition,arrowPosition){var arrowClass=ZPArrow.NO_ARROW;return boxPosition.bottom?arrowPosition.center?arrowClass=ZPArrow.BOTTOM_CENTER:arrowPosition.left?arrowClass=ZPArrow.BOTTOM_LEFT:arrowPosition.right&&(arrowClass=ZPArrow.BOTTOM_RIGHT):boxPosition.right?arrowPosition.center?arrowClass=ZPArrow.RIGHT_CENTER:arrowPosition.top?arrowClass=ZPArrow.RIGHT_TOP:arrowPosition.bottom&&(arrowClass=ZPArrow.RIGHT_BOTTOM):boxPosition.left?arrowPosition.center?arrowClass=ZPArrow.LEFT_CENTER:arrowPosition.top?arrowClass=ZPArrow.LEFT_TOP:arrowPosition.bottom&&(arrowClass=ZPArrow.LEFT_BOTTOM):boxPosition.top&&(arrowPosition.center?arrowClass=ZPArrow.TOP_CENTER:arrowPosition.left?arrowClass=ZPArrow.TOP_LEFT:arrowPosition.right&&(arrowClass=ZPArrow.TOP_RIGHT)),arrowClass},getKeyPressDirection:function(boxPosition){return boxPosition.top?ZPMenu.REVERSE_TRAVERSE:ZPMenu.FORWARD_TRAVERSE},keypressEvents:function(prop,orderOfTraverse){$("#"+prop.id+" #ddList").off("keyup"),$("#"+prop.id).add("#searchTag").off("keyup");$("#"+prop.id).add("#searchTag").on("keyup",function(e){38==e.which||40==e.which||13==e.which||27==e.which?($("#"+prop.id+" #ddList").trigger("focus"),$("#"+prop.id+" #ddList").trigger(e)):8==e.which?void 0!=$("#"+prop.id+" #searchList").val()&&"function"==typeof prop.data&&ZPArrow.recursiveDataFunctionCall(prop):ZPMenu.isValidKeycode(e)&&"function"==typeof prop.data&&ZPArrow.recursiveDataFunctionCall(prop)}),ZPMenu.keypressResponse(prop,-1,orderOfTraverse)},recursiveDataFunctionCall:function(prop){setTimeout(function(){$(prop.initobj).zparrowmenu(prop)},100)},selectFromList:function(prop){$("."+prop.dropdownclass+" li:not(#searchTag)").on("click",function(ev){void 0===ev&&(ev=window.event),ev.stopPropagation?(ev.preventDefault(),ev.stopPropagation()):(ev.cancelBubble=!0,ev.returnValue=!1);var val="",id="";if(prop.checkbox){if($(this).toggleClass("sel"),id=$(this).attr("id"),!prop.oneTimeMenu){if(!$(this).hasClass("sel"))return void ZPArrow.clearValue(id,prop.initobj,prop.callbackOnCancel);id=$(this).attr("id"),id=""!=$(prop.initobj).attr("selectedIds")&&void 0!=$(prop.initobj).attr("selectedIds")?$(prop.initobj).attr("selectedIds")+","+$(this).attr("id"):$(this).attr("id"),$(prop.initobj).attr("selectedIds",id),$("div#"+prop.id+" #searchList").length>0?$("div#"+prop.id+" #searchList").trigger("focus"):$(prop.initobj).trigger("focus")}}else val=$(this).attr("name"),prop.icon?!$(prop.initobj).is("i")||""!=prop.callback&&void 0!=prop.callback||$(prop.initobj).attr("class",val):prop.oneTimeMenu||(id=$(this).attr("id"),$(prop.initobj).attr("selectedIds",id)),ZPMenu.removeDropDown(!1,prop.initobj,prop.callbackonclose);""!=prop.callback&&prop.callback(this,prop.initobj)})},clearValue:function(id,initObj,callbackOnCancel){var allSelectedIds=$(initObj).attr("selectedIds");if($("li[id="+id+"]").removeClass("sel"),""!=allSelectedIds&&void 0!=allSelectedIds){var result=allSelectedIds.split(",");0==allSelectedIds.indexOf(id)?result.length>1&&(id+=","):id=","+id,allSelectedIds=allSelectedIds.replace(id,""),$(initObj).attr("selectedIds",allSelectedIds),void 0!=callbackOnCancel&&"function"==typeof callbackOnCancel&&callbackOnCancel(id.replace(",",""),initObj)}}},USER_GROUP_LISTS=[],OWNER_LIST={},CommonTemplates={NODATA_CLASS:"CR-nodata",NODATA_PATH:8,setViewKey:function(){null==ZPeople.CURRENT_VIEWKEY&&(ZPeople.CURRENT_VIEWKEY=ZPeople.VIEWKEYS.HrCase,AcsApi.initStream("People",ZPeople.CURRENT_VIEWKEY,10))},sliderPop:function(isNeedButton){var html='<div class="zp_whtbg" id="sliderPopup"><div class="zp_pop">';return html+='<div class="zp_Ptl" id="sliderHeader"><h3 id="sliderName"></h3></div><div class="zp_pcnt" id="sliderContent" onscroll="CommonTemplates.scrollfunction(\'sliderHeader\',\'sliderContent\')"></div>',isNeedButton&&(html+='<div class="zp_btn"><button  id="submitBtn" class="zpthm zpn_btn"><b>'+ZPI18N.getString("zp.save")+'</b><div class="zp_circular"></div><label>'+ZPI18N.getString("zp.saving")+'</label></button><button name="closeSlider">'+ZPI18N.getString("zp.cancel")+"</button></div>"),html+='</div><i class="IC-cls" title='+ZPI18N.getString("zp.close")+' name="closeSlider"></i> </div>'},createEmptyPopupSlider:function(isNeedButton,sliderName,onCloseCallback){$("#sliderPopup").length>0&&$("#sliderPopup").remove(),$("body").append(CommonTemplates.sliderPop(isNeedButton)),ZPUtil.Validation.isEmpty(sliderName)||(CommonTemplates.openSlider(sliderName),$("#sliderPopup").find("[name=closeSlider]").off("click").on("click",function(){void 0!=onCloseCallback&&"function"==typeof onCloseCallback&&onCloseCallback(),CommonTemplates.closeSlider()}))},setSliderBody:function(bodyHtml){$("#sliderPopup").length>0&&$("#sliderContent").html(bodyHtml)},openSlider:function(sliderName){$("#sliderName").html(sliderName),$("#sliderPopup").addClass("zp_shw"),$("#submitBtn").off("click"),CommonTemplates.saveComplete("submitBtn")},closeSlider:function(){$("#sliderName").html(""),$("#sliderPopup").removeClass("zp_shw"),$("#submitBtn").off("click"),CommonTemplates.saveComplete("submitBtn")},noDataSVG:function(parentId,isNeedImage,message,isNeedButton,buttonOnclick,buttonName){var pageId=$("#"+Layout.Page.pageId);if(isNeedImage)return""!=parentId&&pageId.find("#"+parentId).find(".ZPNdata").remove(),ZPUtil.newNoDataHTML(CommonTemplates.NODATA_CLASS,CommonTemplates.NODATA_PATH,message);""!=parentId&&pageId.find("#"+parentId).find("#noData").remove();var html='<div class="ZPNdata zp_ndat" id="noData">';return html+=void 0!=message?"<h5>"+message+"</h5>":"",html+=1==isNeedButton?'<button class="btn btn-primary MT10 btnPlus" onclick ='+buttonOnclick+">"+buttonName+"</p>":"",html+="</div>"},returnImgDiv:function(sourceUrl,altText,imgId,tooltipData,attribute,needCheckBox,extraClasses){sourceUrl=void 0==sourceUrl?"":sourceUrl,extraClasses=void 0==extraClasses?"":extraClasses;var imageId=ZPUtil.Validation.isEmpty(imgId)?"":'id="'+imgId+'"',toolTip=ZPUtil.Validation.isEmpty(tooltipData)?"":'title="'+tooltipData+'"',imgAlt=ZPUtil.Validation.isEmpty(altText)?"":'alt ="'+altText+'"',imghtml=""!=altText&&""==sourceUrl?altText:"<img "+imageId+' src="'+sourceUrl+'" '+imgAlt+" >",altColor=""!=imgAlt?CommonTemplates.getColorCode(altText):"";attribute=ZPUtil.Validation.isEmpty(attribute)?"":attribute;return html=""==sourceUrl&&""==imgAlt?"":'<div class="ZP_photo '+altColor+" "+extraClasses+'" '+attribute+" "+toolTip+">"+imghtml+"</div>",needCheckBox&&(html='<div><i name="selBox" class="IC-chk-box1"></i>'+html+"</div>"),html},getAltText:function(text){var splitname=text.split(" "),shortname=splitname[0].charAt(0);return shortname+=void 0!=splitname[1]?splitname[1].charAt(0):void 0!=splitname[0].charAt(1)?splitname[0].charAt(1):""},getIconMenuBar:function(iconMenuProperties){var menuhtml="",buttonsHtml="";return $.each(iconMenuProperties,function(i,v){buttonsHtml+=CommonTemplates.getSingleIconMenu(v)}),menuhtml+="<ul>"+buttonsHtml+"</ul>"},getSingleIconMenu:function(iconMenuProperty){var attributes="",iconsHtml="",li_attributes=iconMenuProperty.attributes;$.each(li_attributes,function(index,value){attributes+=index+'="'+value+'" '});var iconsList=iconMenuProperty.iconsList;return $.each(iconsList,function(idx,val){var iconAttr="";$.each(val,function(i,v){iconAttr+=i+'="'+v+'" '}),iconsHtml+="<i "+iconAttr+"></i>"}),"<li "+attributes+"><b><span>"+iconsHtml+"</span></b></li>"},setCurrentEmpInSelect:function(inputBox,imageNeeded){var userDetails=ZPeople.getUserDetailsById(erecno),displayName=userDetails.empid+" "+userDetails.name,selectedValObj={id:erecno,text:displayName};if(imageNeeded){var imageVal=userDetails.avatar;selectedValObj.imageAlt=ZSEC.Encoder.encodeForHTML(CommonTemplates.getAltText(ZPeople.decodeTxt(displayName))),selectedValObj.image=imageVal}inputBox.zpselect({selectedVal:[selectedValObj]}),inputBox.attr("agenttype",OWNER_EMPLOYEE),inputBox.attr("name",displayName)},getSelectMenu:function(menuProperties,parentDiv,selectMenuAttributes,selectMenuProperties){$("#"+Layout.Page.pageId);selectMenuProperties.hasOwnProperty("width")&&parentDiv.width(selectMenuProperties.width),selectMenuProperties.rightIcon="IC-ar-dwn",selectMenuProperties.allowExpand=!!menuProperties.hasOwnProperty("checkbox")&&menuProperties.checkbox;var inputId="selectMenuId";inputId=void 0!=selectMenuAttributes.id&&""!=selectMenuAttributes.id?selectMenuAttributes.id:inputId,menuProperties.hasOwnProperty("retainDefaultValue")&&menuProperties.retainDefaultValue?selectMenuAttributes.placeholder=CommonTemplates.getDefaultValuePlaceholder(menuProperties.data):selectMenuAttributes.hasOwnProperty("placeholder")||(selectMenuAttributes.placeholder=ZPI18N.getString("zp.select")),CommonTemplates.getInputTextIcon(selectMenuAttributes,selectMenuProperties,parentDiv),menuProperties.isMandatory=void 0==menuProperties.isMandatory?selectMenuProperties.isMandatory:menuProperties.isMandatory,menuProperties.search=selectMenuProperties.search,parentDiv.find("#"+inputId).off("focus").on("focus",function(e){e.stopPropagation(),e.preventDefault(),menuProperties.hasOwnProperty("refreshProperty")&&(menuProperties.data=menuProperties.refreshProperty()),parentDiv.find("#"+inputId).zpselect(menuProperties)}),parentDiv.find("font").off("click").on("click",function(e){$(this).attr("zpmenu",!0),$(this).data("zpmenu",menuProperties.id),$("#"+menuProperties.id).length>0?ZPSelect.removeMenu(parentDiv.find("#"+inputId),"zp_drop"):parentDiv.find("#"+inputId).trigger("focus")}),CommonTemplates.setMenuSelection(menuProperties,parentDiv,inputId)},getDefaultValuePlaceholder:function(data){var defValue=ZPI18N.getString("zp.select");return $.each(data,function(i,v){if(v.hasOwnProperty("isDefaultValue")&&v.isDefaultValue)return defValue=v.value}),defValue},getMenuSelectedData:function(data){var selectedData=[];return $.each(data,function(i,v){v.hasOwnProperty("isDefaultValue")&&v.isDefaultValue&&(v.text=v.value,selectedData.push(v))}),selectedData},setMenuSelection:function(menuProperties,parentDiv,inputId){var selectedVal=CommonTemplates.getMenuSelectedData(menuProperties.data);if(selectedVal.length>0){var menuProp={selectedVal:selectedVal};menuProp.isMandatory=!!menuProperties.hasOwnProperty("isMandatory")&&menuProperties.isMandatory,menuProp.checkbox=!!menuProperties.hasOwnProperty("checkbox")&&menuProperties.checkbox,menuProp.callback=menuProperties.hasOwnProperty("callback")&&""!=menuProperties.callback?menuProperties.callback:"",menuProp.callbackOnCancel=menuProperties.hasOwnProperty("callbackOnCancel")&&""!=menuProperties.callbackOnCancel?menuProperties.callbackOnCancel:"",parentDiv.find("#"+inputId).zpselect(menuProp)}},getInputTextIcon:function(inputAttributes,properties,currentObj){var html,inputHeaderName=properties.inputHeaderName,isMandatory=properties.isMandatory,showMandatoryRedLine=properties.isMandatory&&properties.hasOwnProperty("hideMandatoryMark")&&!properties.hideMandatoryMark,rightIconClass=properties.rightIcon,leftIconClass=properties.leftIcon,noBorder=void 0!=properties.noBorder&&properties.noBorder,allowExpand=void 0!=properties.allowExpand&&properties.allowExpand,setPadding=void 0!=properties.setPadding&&properties.setPadding,attributes="",leftIcon=void 0!=leftIconClass&&""!=leftIconClass?'<i class="'+leftIconClass+'"></i>':"",rightIcon=void 0!=rightIconClass&&""!=rightIconClass?'<font class="'+rightIconClass+'"></font>':"",nobdrClass=noBorder?"nobdr":"",paddingClass=setPadding?"PL10":"",expandClass=allowExpand?"zp_tgExpand PL10":"";$.each(inputAttributes,function(index,v){attributes+=index+'="'+v+'" ',"disabled"==index&&$(currentObj).addClass("zp_rdonly")});var mandClass=isMandatory&&showMandatoryRedLine?"zp_mdt":"";(html=(""!=inputHeaderName&&void 0!=inputHeaderName?""!=mandClass?'<label class="'+mandClass+'"><font>'+inputHeaderName+"</font></label>":"<label>"+inputHeaderName+"</label>":"")+'<div class="'+paddingClass+" "+expandClass+" "+nobdrClass+'">'+leftIcon+rightIcon+("<input "+attributes+' type="text">')+"</div>",""!=currentObj&&void 0!=currentObj)&&($(currentObj).closest("div.zp_fm").length<=0&&$(currentObj).addClass("zp_fm"),$(currentObj).html(html));return html},getInputTextBox:function(inputAttributes,inputHeaderName,isMandatory,currentObj,noBorder){return CommonTemplates.getInputTextIcon(inputAttributes,{inputHeaderName:inputHeaderName,isMandatory:isMandatory,noBorder:noBorder},currentObj)},setErrorMessageinTextBox:function(inputObj,errorMessage){$(inputObj).closest("div").addClass("zp_err"),$($(inputObj).closest("div.zp_fm").nextAll("span.etxt")[0]).removeClass("zp_dyn"),void 0!=errorMessage&&""!=errorMessage&&$($(inputObj).closest("div.zp_fm").nextAll("span.etxt")[0]).html(errorMessage)},removeErrorMessageinTextBox:function(inputObj){$(inputObj).closest("div.zp_err").removeClass("zp_err"),$($(inputObj).closest("div.zp_fm").nextAll("span.etxt")[0]).addClass("zp_dyn")},removeErrorMessagesinContainerDiv:function(containerId){var parentId=$("[id="+containerId+"]");parentId.find("div.zp_err").removeClass("zp_err"),parentId.find("span[class=etxt]:not([class=zp_dyn])").addClass("zp_dyn")},waitTillSave:function(saveBtn){$("[id="+saveBtn+"]").addClass("zpn_sbmt sel"),$("[id="+saveBtn+"]").prop("disabled",!0)},saveComplete:function(saveBtn){$("[id="+saveBtn+"]").removeClass("zpn_sbmt"),$("[id="+saveBtn+"]").prop("disabled",!1)},scrollfunction:function(headerDiv,contentDiv){0!=$("[id="+contentDiv+"]").scrollTop()?$("[id="+headerDiv+"]").addClass("zp_scrl"):$("[id="+headerDiv+"]").hasClass("zp_scrl")&&$("[id="+headerDiv+"]").removeClass("zp_scrl")},cloneTag:function(data,showTag){var tagsHtml="",noTag=showTag?"":"notg";return $.each(data,function(i,v){var imageHtml,tagAttribute="";imageHtml=CommonTemplates.returnImgDiv(v.imageSrc,v.imageAlt),v.hasOwnProperty("attribute")&&(tagAttribute=v.attribute),tagsHtml+='<div class="zp_Tg '+noTag+'" '+tagAttribute+">"+imageHtml+v.text+"</div>"}),"<div>"+tagsHtml+"</div>"},tagHtml:function(id,val,imageHtml,needCloseBtn,showTag){var tagsHtml="";return tagsHtml+='<div class="zp_Tg'+(showTag?"":" notg")+'" id="'+id+'">'+imageHtml+val+(needCloseBtn?'<i class="IC-cls-1px" id="'+id+'"></i>':"")+"</div>"},checkEditorEmpty:function(editorText){var text=editorText.replace("<div>",""),res=text.lastIndexOf("<br /></div>");return""==text.substring(0,res).trim()},getFileBoxOnSelect:function(file,callback){var fileExtn=file.name.substring(file.name.lastIndexOf(".")+1),fileIcon=this.getFileIcon(fileExtn),fileSize=void 0!=file.size?this.getFileSize(file.size):"",fileName=file.name;"workDriveUpload"==file.type&&(fileIcon="IC-wd");var html='<div class="attachedFile filePosts"><i class="'+fileIcon+' fileType"></i><i  onclick="CommonTemplates.removeFileDiv(this)" class="IC-cls"></i><div class="fileNameAndSize"><label class="fileName" purpose="fileName">'+ZSEC.Encoder.encodeForHTML(fileName)+'</label><span purpose="fileSize">'+fileSize+"</span></div></div>";if(void 0==callback||"function"!=typeof callback)return html;callback(html,file)},getFileBoxProgressOnSelect:function(file,pos,callback){var temp=$("<div></div>"),fileExtn=file.name.substring(file.name.lastIndexOf(".")+1),fileIcon=this.getFileIcon(fileExtn),fileName=(void 0!=file.size&&this.getFileSize(file.size),file.name);"workDriveUpload"==file.type&&(fileIcon="IC-wd");var html='<div class="attachedFile filePosts" filePos="'+pos+'"><i class="'+fileIcon+' fileType"></i><i  onclick="CommonTemplates.removeFileDiv(this)" class="IC-cls"></i><div class="fileNameAndSize"><label class="fileName" purpose="fileName">'+ZSEC.Encoder.encodeForHTML(fileName)+'</label><div class="zpPbar"><div><div class="zp_prgressbg" style="width:90%"></div></div></div></div></div>';temp.html(html),void 0!=callback&&"function"==typeof callback&&callback(temp.children(),file)},setFileBoxAndDataOnSelect:function(file,fileInfo){var html=CommonTemplates.getFileBoxOnSelect(file),temp=$("<div></div>");return temp.html(html),temp.find(".attachedFile.filePosts").data("uploadMode","localUpload").data("caseFileUpload",JSON.stringify({filePath:fileInfo.fileId,fileName:fileInfo.fileName,fileSize:fileInfo.fileSize})),temp.children()},getFileSize:function(sizeinbytes){var size=parseFloat(sizeinbytes);return size>1048576?(size/=1048576).toFixed(2)+" MB":size>1024?(size/=1024).toFixed(2)+" KB":size.toFixed(2)+" Bytes"},getFileIcon:function(fileExtn){var icon="IC-file";switch(fileExtn){case"jpeg":case"png":case"jpg":icon="IC-jpg";break;case"gif":icon="IC-gif";break;case"pdf":icon="IC-pdf";break;case"xlsx":case"xls":case"sxc":case"ods":case"csv":case"tsv":icon="IC-xls-new";break;case"doc":case"docx":case"sxw":case"odt":case"rtf":icon="IC-doc";break;case"ppt":case"pptx":case"odp":case"sxi":icon="IC-ppt";break;case"rar":case"tar.gz":case"zip":icon="IC-zip";break;case"mp3":icon="IC-mp3"}return icon},removeFileDiv:function(obj){$("#"+Layout.Page.pageId);""!=$(obj).closest("div.attachedFile").attr("fileid")&&void 0!=$(obj).closest("div.attachedFile").attr("fileid")?$(obj).closest("div.attachedFile").addClass("zp_dyn"):$(obj).closest("div.attachedFile").remove()},chooseFileHtml:function(isExcWDrive){var cloudHtml=ZPeople.isChinaSetup?"":ZPI18N.getString("zp.or")+'<a id="hcCFile">'+ZPI18N.getString("zp.others")+"</a>",html='<div id="fAtch" class="zp_Add"><div><i class="IC-attcloud"></i>'+ZPI18N.getString("zp.files.attach")+" "+ZPI18N.getString("zp.files.from")+'<a id="hcDFile">'+ZPI18N.getString("zp.files.desktop")+"</a>";return!isExcWDrive&&isWorkdriveAllowed&&(html+=ZPI18N.getString("zp.or")+'<a id="hcWFile">'+ZPI18N.getString("zp.workdrive")+"</a>"),html+=cloudHtml+'</div></div><div class="zp_note"></div>'},validateCleartextString:function(string){return!(string.length>0)||/[0-9a-zA-Z_\-\.\$@\?\,\:\'\/\!\\P{IsBasicLatin}\s]+/g.test(string)},getCountMenuBar:function(countMenuProperties){var parentHtml="",countHtml="";return $.each(countMenuProperties,function(i,v){countHtml+=CommonTemplates.getSingleCountDiv(v)}),parentHtml+='<div class="zp_info"><div>'+countHtml+"</div></div>"},toCheckEmpty:function(id,params,paramname){var pageId=Layout.Page.container;if(pageId.find("#"+id).length>0&&!ZPUtil.Validation.isEmpty(pageId.find("#"+id).attr("selectedids")))return params[paramname]=pageId.find("#"+id).attr("selectedids")},getSingleCountDiv:function(countMenuProperties){var attributes="",div_attribute=countMenuProperties.attributes,div_onclick=countMenuProperties.onclick,count=countMenuProperties.count;return $.each(div_attribute,function(index,value){attributes+=index+"="+value+" "}),'<div onclick="'+div_onclick+'"><dl><dt>'+countMenuProperties.iconName+"</dt><dd><span "+attributes+">"+count+"</span> </dd></dl></div>"},getColorCode:function(text){for(var len=text.length,code=0,i=0;i<len;i++)code+=text.charCodeAt(i);return"pc"+(code=code%9+1)}};CommonTemplates.Popup={popUpHTML:function(confirmBtnName,cancelBtnName,hasCancelCallBack){return confirmBtnName=void 0==confirmBtnName||ZPUtil.Validation.isEmpty(confirmBtnName)?ZPI18N.getString("zp.confirm"):confirmBtnName,cancelBtnName=void 0==cancelBtnName||ZPUtil.Validation.isEmpty(cancelBtnName)?ZPI18N.getString("zp.cancel"):cancelBtnName,'<div id="cnf_popup" class="zp_NSPop active zp_cSAskUs"><div class="zp_popInner zp_serDs"><i class="IC-cls" name="cancelPopup" '+(hasCancelCallBack?"":'onclick="CommonTemplates.Popup.closePopup()"')+'></i><div class="zp_Ptl ML10" id="popupHeader"><h3 id="sliderName"></h3></div><div class="zp_formncls MT20" id="popup_body"></div><div class="zp_btn"><button class="zpthm" id="popup_confirm">'+confirmBtnName+"</button><button "+(hasCancelCallBack?"":'onclick="CommonTemplates.Popup.closePopup()"')+' name="cancelPopup" id="popup_cancel">'+cancelBtnName+"</button></div></div></div>"},showPopup:function(popupHeader,bodyHtml,confirmBtnName,cancelBtnName,hasCancelCallBack){$("body").append(CommonTemplates.Popup.popUpHTML(confirmBtnName,cancelBtnName,hasCancelCallBack)),$("#popup_body").empty().append(bodyHtml),$("#cnf_popup").find("#popupHeader").html("<span>"+popupHeader+"</span>")},closePopup:function(){$("#cnf_popup").remove()}};var AdvancedFilter={MAX_TAG_COUNT:5,CURRENT_TAGS_COUNT:0,getFilterHtml:function(filterDiv,submitCallBack){if(Layout.Page.container.find("#filterOption").length<=0){var contentHtml="";$.each(filterDiv,function(i,val){contentHtml+='<div id="'+val.parentDiv+'"></div>'});var html='<div id="filterOption" class="zp_fltrs">'+('<div class="zp_Lttl"><div class="zp_Lst"><div><div class="zp_Ldtl">'+ZPI18N.getString("zp.filter")+'<i class="IC-cls" title='+ZPI18N.getString("zp.close")+' onclick="AdvancedFilter.hideFilter()"></i></div></div></div></div>')+('<div class="zp_Fscrl">'+contentHtml+"</div>")+('<div class="zp_btn"><button id="aplFltr" class="zpthm zpn_btn">'+ZPI18N.getString("zp.apply")+'</button><span name="reset" class="zp_lnk">'+ZPI18N.getString("zp.reset")+"</span></div>")+"</div>";Layout.Page.container.append(html),Layout.Page.container.find("#aplFltr").off("click").on("click",function(){AdvancedFilter.submitFilter(filterDiv,submitCallBack)})}},constructFilter:function(cdata,submitCallBack){var pageId=Layout.Page.container;cdata.length>0&&Layout.Page.container.find("#filterOption").length<=0&&(AdvancedFilter.getFilterHtml(cdata,submitCallBack),$.each(cdata,function(i,v){"search"==v.type?CommonTemplates.getInputTextIcon({id:v.parentDiv+"_input",placeholder:v.title},{leftIcon:"IC-lens",noBorder:!0},Layout.Page.container.find("#"+v.parentDiv)):"select"==v.type?CommonTemplates.getSelectMenu(v.menuProperties,Layout.Page.container.find("#"+v.parentDiv),{id:v.parentDiv+"_input",value:v.menuProperties.hasOwnProperty("defaultSelectText")?v.menuProperties.defaultSelectText:ZPI18N.getString("zp.select")},{isMandatory:!1,inputHeaderName:v.title,setPadding:!0}):"date"==v.type&&CommonTemplates.getInputTextIcon({id:v.parentDiv+"_input",placeholder:dateFmt,caltype:"filter",onclick:"Calendar.setUpCalendar(event, this);"},{inputHeaderName:v.title},Layout.Page.container.find("#"+v.parentDiv))}),pageId.find("#filterOption").find('[name="clear"]').off("click").on("click",function(){AdvancedFilter.filterTagClearOption(cdata)}),pageId.find("#filterOption").find('[name="reset"]').off("click").on("click",function(){AdvancedFilter.filterDataReset(cdata)}))},showHidefilter:function(){var pageId=Layout.Page.container;pageId.hasClass("zp_Fshw")?pageId.removeClass("zp_Fshw"):pageId.addClass("zp_Fshw"),pageId.hasClass("zp_Fshw")&&pageId.find("#filterOption").find("input[id$=_input]:first").trigger("focus")},showFilter:function(){var pageId=Layout.Page.container;!pageId.hasClass("zp_Fshw")&&pageId.addClass("zp_Fshw")},hideFilter:function(){var pageId=Layout.Page.container;pageId.hasClass("zp_Fshw")&&pageId.removeClass("zp_Fshw")},submitFilter:function(filterDiv,callback){Layout.Page.container.find(".zp_header").attr("name","headerposition"),Layout.Page.container.find("[name=headerposition]").addClass("zp_sfltr"),AdvancedFilter.filterHeaderTag(filterDiv,callback),AdvancedFilter.hideFilter(),callback(!0)},filterHeaderTag:function(filterDiv,callback){var pageId=Layout.Page.container;pageId.find("[name=headerposition]").find("div.zp_Tglst").remove(),pageId.find("[name=headerposition]").append('<div class="zp_Tglst zp_dyn" id="headtag"></div>'),AdvancedFilter.CURRENT_TAGS_COUNT=0,$.each(filterDiv,function(i,v){"search"==v.type?AdvancedFilter.constructQryTags(v,callback,filterDiv):"select"==v.type&&AdvancedFilter.constructHdrTags(v,callback,filterDiv)}),AdvancedFilter.constructMoretags();var headerTags=pageId.find("#headtag");headerTags.append('<span class="zp_link" name="clear">'+ZPI18N.getString("zp.clear")+"</span>"),headerTags.find('[name="clear"]').off("click").on("click",function(){AdvancedFilter.filterTagClearOption(filterDiv,callback)}),headerTags.find("[class=zp_Tg]").off("click").on("click",function(){AdvancedFilter.showFilter()}),0!=headerTags.find("div.zp_Tg").length?pageId.find("[name=headerposition]").find("#headtag").removeClass("zp_dyn"):pageId.find("[name=headerposition]").removeClass("zp_sfltr")},constructMoretags:function(){var headerTags=Layout.Page.container.find("#headtag");if(AdvancedFilter.CURRENT_TAGS_COUNT>AdvancedFilter.MAX_TAG_COUNT){var moreTagsCount=AdvancedFilter.CURRENT_TAGS_COUNT-AdvancedFilter.MAX_TAG_COUNT;headerTags.find("#moreTags").remove();var moreHtml=CommonTemplates.tagHtml("moreTags",moreTagsCount+" "+ZPI18N.getString("zp.smore"),"",!1,!0),clearObj=headerTags.find("[name=clear]");clearObj.length>0?$(moreHtml).insertBefore(clearObj):headerTags.append(CommonTemplates.tagHtml("moreTags",moreTagsCount+" "+ZPI18N.getString("zp.smore"),"",!1,!0))}},constructQryTags:function(srcObj,callback,filterDiv){var srcDiv=srcObj.parentDiv,pageId=Layout.Page.container,data=pageId.find("#"+srcDiv+"_input").val().trim();(data=data.split(/ +/)).length>0&&""!=data[0]&&$.each(data,function(i,v){++AdvancedFilter.CURRENT_TAGS_COUNT,AdvancedFilter.CURRENT_TAGS_COUNT<=AdvancedFilter.MAX_TAG_COUNT&&(pageId.find("#headtag").append(CommonTemplates.tagHtml("src_"+i,ZSEC.Encoder.encodeForHTML(v),"",!0,!0)),pageId.find("#headtag").find("i#src_"+i).off("click").on("click",function(){--AdvancedFilter.CURRENT_TAGS_COUNT;var values=pageId.find("#"+srcDiv+"_input").val();values=values.replace(v,""),pageId.find("#"+srcDiv+"_input").val(values),$(this).closest("div.zp_Tg").remove(),callback(!0),0==pageId.find("#headtag").find("div.zp_Tg").length?AdvancedFilter.filterTagClearOption([srcObj]):AdvancedFilter.filterHeaderTag(filterDiv,callback)}))})},constructHdrTags:function(srcParDiv,callback,filterDiv){var pageId=Layout.Page.container;pageId.find("#"+srcParDiv.parentDiv).find("div.zp_Tg").each(function(i){if(++AdvancedFilter.CURRENT_TAGS_COUNT,AdvancedFilter.CURRENT_TAGS_COUNT<=AdvancedFilter.MAX_TAG_COUNT){var srcTag=$(this),id=$(srcTag).find("i[name=close]").attr("id"),tagClone=$(srcTag).clone();tagClone.find('i[name="close"]').length<=0&&tagClone.append('<i name="close" class="IC-cls-1px" id="'+id+'"></i>'),pageId.find("#headtag").append(tagClone),pageId.find("#headtag").find('i[name="close"]#'+id).off("click").on("click",function(){--AdvancedFilter.CURRENT_TAGS_COUNT,$(srcTag).find('i[id="'+id+'"]').length>0?$(srcTag).find('i[id="'+id+'"]').trigger("click"):ZPSelect.clearAllValues(pageId.find("#"+srcParDiv.parentDiv+"_input")),$(this).closest("div.zp_Tg").remove(),callback(!0),0==pageId.find("#headtag").find("div.zp_Tg").length?AdvancedFilter.filterTagClearOption([srcParDiv]):AdvancedFilter.filterHeaderTag(filterDiv,callback)})}})},filterDataReset:function(filterDiv){var pageId=Layout.Page.container;$.each(filterDiv,function(i,v){pageId.find("#"+v.parentDiv).length>0&&("search"==v.type||"date"==v.type?pageId.find("#"+v.parentDiv+"_input").val(""):"select"==v.type&&(v.menuProperties.hasOwnProperty("retainDefaultValue")&&v.menuProperties.retainDefaultValue?CommonTemplates.setMenuSelection(v.menuProperties,pageId.find("#"+v.parentDiv),v.parentDiv+"_input"):ZPSelect.clearAllValues(pageId.find("#"+v.parentDiv+"_input"),v.menuProperties.callbackOnCancel)))})},filterTagClearOption:function(filterDiv,callback){Layout.Page.container;AdvancedFilter.filterDataReset(filterDiv),AdvancedFilter.removeTaglist(),void 0!=callback&&callback(!0)},removeTaglist:function(){var pageId=Layout.Page.container;pageId.find("[name=headerposition]").removeClass("zp_sfltr"),pageId.find("[name=headerposition]").find("div.zp_Tglst").remove()}},EmployeeDropdown={getEmpList:function(query,searchType,searchMode,excludeErecnos,extraparam,needNonUser,defaultErecno,needEmailId){var result=[],pseudoresult=[];if(needNonUser=void 0!=needNonUser&&needNonUser,needEmailId=void 0!=needEmailId&&needEmailId,(query=void 0==query||""==query?"":query).length)result=EmployeeDropdown.getListData(query.toLowerCase(),searchType,searchMode,query.toLowerCase(),extraparam,needEmailId),$.each(result,function(i){if(void 0==excludeErecnos||!ZPUtil.checkIsExistInArray(excludeErecnos,result[i].id)){var param1={};param1.value=result[i].text,param1.image=result[i].avatar,param1.id=result[i].id,needEmailId&&(param1.emailId=result[i].emailId,param1.zuid=result[i].zuid),pseudoresult.push(param1)}});else{var empList=ZPeople.SUB_USERLIST;ZPUtil.Validation.isEmpty(defaultErecno)||ZPUtil.checkIsExistInArray(ZPeople.SUB_USERLIST,defaultErecno)||(empList=empList.concat([defaultErecno])),$.each(ZPeople.getUserDetailsByIds(empList),function(i,v){var empCrt="true"==v.isLogEnb&&(v.reportingTo===erecno||v.usererec==erecno||defaultErecno&&v.usererec==defaultErecno&&v.usererec!=erecno);if(needNonUser&&(empCrt=("true"==v.isLogEnb||"true"==v.isNonUser)&&(v.reportingTo===erecno||v.usererec==erecno||defaultErecno&&v.usererec==defaultErecno&&v.usererec!=erecno)),empCrt&&(void 0==excludeErecnos||!ZPUtil.checkIsExistInArray(excludeErecnos,v.usererec))){var param1={};param1.value=v.empid+" "+v.name,param1.image=v.avatar,param1.id=v.usererec,needEmailId&&(param1.emailId=v.emailId,param1.zuid=v.zuid),pseudoresult.push(param1)}})}return pseudoresult},getListData:function(query,searchType,searchMode,orgKey,extraparam,needEmailId){var listData=[],pseudoresult=[];void 0==OWNER_LIST[searchMode]&&(OWNER_LIST[searchMode]={emp:{},dept:{},grp:{},role:{}});var LIST=OWNER_LIST[searchMode][searchType],searchQuery=query;if(void 0==LIST[query]&&query.length>3&&void 0==LIST[searchQuery=query.slice(0,3)]&&EmployeeDropdown.getListData(searchQuery,searchType,searchMode,orgKey,extraparam,needEmailId),void 0!=LIST[searchQuery]){if(void 0!=LIST[searchQuery].results&&(listData=LIST[searchQuery].results),void 0!=LIST[searchQuery].matches){var array=LIST[searchQuery].results;listData=void 0!=array?array.concat(LIST[searchQuery].matches):LIST[searchQuery].matches}if("emp"==searchType?$.each(listData,function(i){var avatar="";avatar=""!=listData[i][6]&&void 0!=listData[i][6]?0==listData[i][6].indexOf("/newhr/images/sampleemployeephotos/")?listData[i][6]:"viewPhoto?filename="+listData[i][6]:""!=listData[i][5]&&void 0!=listData[i][5]?contactUrl+"/file?ID="+listData[i][5]+"&fs=thumb":ZPeople.getResourceURL(imageUrl+"user.png"),needEmailId?pseudoresult.push({id:listData[i][0],text:listData[i][1]+" "+ZPeople.getUserDisplayName(listData[i][2],listData[i][3]),value:listData[i][1]+" "+listData[i][2]+" "+listData[i][3],type:OWNER_EMPLOYEE,avatar:avatar,alt:"",emailId:listData[i][4],zuid:listData[i][5]}):pseudoresult.push({id:listData[i][0],text:listData[i][1]+" "+ZPeople.getUserDisplayName(listData[i][2],listData[i][3]),value:listData[i][1]+" "+listData[i][2]+" "+listData[i][3],type:OWNER_EMPLOYEE,avatar:avatar,alt:""})}):"dept"==searchType?$.each(listData,function(i){var alt=ZSEC.Encoder.encodeForHTML(CommonTemplates.getAltText(ZPeople.decodeTxt(listData[i][1])));pseudoresult.push({id:listData[i][0],text:listData[i][1],value:listData[i][1],type:OWNER_DEPARTMENT,avatar:"",alt:alt})}):"grp"==searchType?$.each(listData,function(i){var alt=ZSEC.Encoder.encodeForHTML(CommonTemplates.getAltText(ZPeople.decodeTxt(listData[i][1])));pseudoresult.push({id:listData[i][0],text:listData[i][1],value:listData[i][1],type:OWNER_GROUP,avatar:"",alt:alt})}):"role"==searchType&&$.each(listData,function(i){var alt=ZSEC.Encoder.encodeForHTML(CommonTemplates.getAltText(ZPeople.decodeTxt(listData[i][1])));pseudoresult.push({id:listData[i][0],text:listData[i][1],value:listData[i][1],type:OWNER_ROLE,avatar:"",alt:alt})}),results="*"!=orgKey?$.grep(pseudoresult,function(ele){return decodeHTML(ele.value).toLowerCase().indexOf(orgKey.toLowerCase())>-1||needEmailId&&decodeHTML(ele.emailId).toLowerCase().indexOf(orgKey.toLowerCase())>-1}):pseudoresult,results.length<=0&&(LIST[searchQuery].isNextAvailable||LIST[searchQuery].totalCnt>200)){var paramdata={mode:"SEARCH",key:encodeURIComponent(orgKey),start:"1",searchType:searchType,searchMode:searchMode,conreqcsr:csrfToken};void 0==extraparam||$.isEmptyObject(extraparam)||(paramdata.extraparam=JSON.stringify(extraparam)),$.ajax({context:this,type:"POST",async:!1,url:"/commonAction.zp",data:paramdata,success:function(data){OWNER_LIST[searchMode][searchType][orgKey]=data}}),LIST[orgKey].totalCnt>0&&EmployeeDropdown.getListData(orgKey,searchType,searchMode,orgKey,extraparam,needEmailId)}}else{paramdata={mode:"SEARCH",key:encodeURIComponent(searchQuery),start:"1",searchType:searchType,searchMode:searchMode,conreqcsr:csrfToken};void 0==extraparam||$.isEmptyObject(extraparam)||(paramdata.extraparam=JSON.stringify(extraparam)),$.ajax({context:this,type:"POST",async:!1,url:"/commonAction.zp",data:paramdata,success:function(data){OWNER_LIST[searchMode][searchType][searchQuery]=data}}),EmployeeDropdown.getListData(orgKey,searchType,searchMode,orgKey,extraparam,needEmailId)}return results}},EditorTemplate={MAX_EDITOR_HEIGHT:200,toCheckEditorCustomeBtnPerm:function(actJson){Layout.Page.hash;var isEditorPermJSON={},toCheckAgent=void 0!==actJson&&actJson.isAgent;return isEditorPermJSON.isComment=void 0!==actJson,isEditorPermJSON.isAgent=(void 0!==actJson&&actJson.hasOwnProperty("hr_categoryId")?HRCase.isCaseAdmin(actJson.hr_categoryId):HRCase.CASES_ADMIN.isAdmin)||toCheckAgent,isEditorPermJSON.isEscalatorUser=void 0!==actJson&&actJson.isEscalatedUser,isEditorPermJSON},editorConstruct:function(currentDiv,fileUpload,parentId,isneedHeader,isMandatory){$("#"+Layout.Page.pageId);var editorDiv="";isneedHeader&&(editorDiv=isMandatory?'<label class="zp_mdt"><font>'+ZPI18N.getString("zp.description")+"</font></label>":"<label>"+ZPI18N.getString("zp.description")+"</label>"),editorDiv+='<div class="nobdr"><div>',editorDiv+='<div id="descEditor" class="zp_pr"> </div> ',editorDiv+="</div></div>",$("[id="+currentDiv+"]").empty().append(editorDiv),$("[id="+currentDiv+"]").addClass("zp_fm zp_fmds")},replaceWithEditor:function(parentDiv,currentDiv,isMiniEditor){$("#"+Layout.Page.pageId).find("#"+currentDiv).empty();var initobject={currentContainer:$("[id="+parentDiv+"]"),editorheight:EditorTemplate.MAX_EDITOR_HEIGHT,isMiniEditor:isMiniEditor,isMentionsEnabled:!1};ZPFeeds.Editor.getEditor(currentDiv,"HrCase",initobject)},replaceWithNoteEditor:function(parentDiv,currentDiv,isMiniEditor){$("#"+Layout.Page.pageId).find("#"+currentDiv).empty();var initobject={currentContainer:$("[id="+parentDiv+"]"),editorheight:EditorTemplate.MAX_EDITOR_HEIGHT,isMiniEditor:isMiniEditor,isMentionsEnabled:!1};ZPFeeds.Editor.getEditor(currentDiv,"HRCaseNote",initobject)}},Icons={ICONS_LIST:{add:"CR-add",comp:"zp_app1",travel:"zp_app2",mail:"zp_app3",vacation:"zp_app4",helpdesk:"zp_app5",tag:"zp_app6",wallet:"zp_app7",case:"zp_app8",transport:"zp_app9",calendar:"zp_app10",alarm:"zp_app11",hourglass:"zp_app12",medical:"zp_app13",form:"zp_app14",checklist:"zp_app15",awards:"zp_app16",cart:"zp_app17",celebration:"zp_app18",trophy:"zp_app19",org:"zp_app20",food:"zp_app21",connect:"zp_app22",baggage:"zp_app23",security:"zp_app24",complaince:"zp_app25",printer:"zp_app26",employee:"zp_app27",reports:"zp_app28",settings:"zp_app29",chat:"zp_app30",cloud:"zp_app31",files:"zp_app32",flag:"zp_app33",graduate:"zp_app34",video:"zp_app35",calculator:"zp_app36",training:"zp_app37",announce:"zp_app38",location:"zp_app39",empsearch:"zp_app40",in:"zp_app41",out:"zp_app42",download:"zp_app43",emprelation:"zp_app44",search:"zp_app45",empdb:"zp_app46",idea:"zp_app47",help:"zp_app48",asset:"zp_app49",star:"zp_app50",attendance:"zp_app51",holiday:"zp_app52",timetracker:"zp_app53",leavetracker:"zp_app54",cases:"zp_app55",engagement:"zp_app57"},ADD_ICON:"IC-add",getIconName:function(iconClass){var icName="star";return $.each(Icons.ICONS_LIST,function(key,value){value==iconClass&&"zp_app0"!=value&&(icName=key)}),icName},getIconClass:function(iconName){var icClass=Icons.ICONS_LIST[iconName];return{iconClass:icClass=void 0!=icClass?icClass:Icons.ICONS_LIST.star,iconColor:Icons.getIconColor(icClass)}},getIconColor:function(iconClass){switch(iconClass){case"zp_app0":case"zp_app2":case"zp_app7":case"zp_app10":case"zp_app14":case"zp_app18":case"zp_app22":case"zp_app26":case"zp_app30":case"zp_app34":case"zp_app38":case"zp_app42":case"zp_app46":case"zp_app50":case"zp_app52":case"zp_app54":return"SC1";case"zp_app1":case"zp_app4":case"zp_app11":case"zp_app15":case"zp_app19":case"zp_app23":case"zp_app27":case"zp_app31":case"zp_app35":case"zp_app39":case"zp_app43":case"zp_app47":case"zp_app51":case"zp_app57":return"SC2";case"zp_app3":case"zp_app6":case"zp_app9":case"zp_app13":case"zp_app17":case"zp_app21":case"zp_app25":case"zp_app29":case"zp_app33":case"zp_app37":case"zp_app41":case"zp_app45":case"zp_app49":case"zp_app53":case"zp_app55":return"SC3";case"zp_app5":case"zp_app8":case"zp_app12":case"zp_app16":case"zp_app20":case"zp_app24":case"zp_app28":case"zp_app32":case"zp_app36":case"zp_app40":case"zp_app44":case"zp_app48":return"SC4";default:return""}}};