class PAImportV5Handler extends ImportV5Handler{constructor(mode){super(mode)}getFormId(){return PMSImport.formId}uploadDefActionCallback(){"P_Goals"!=this.getImportInstance().tableName&&this.hideBasedOnSelectDiv()}getRecordCount(data){return"P_Goals"==data.module||"P_SelfAppraisal"==data.module||"P_Salary_Increment"==data.module||"P_MultiRater"==data.module||"P_PerformanceAppraisal"==data.module||"P_KRA"==data.module||"P_Competency"==data.module||"P_Skills"==data.module||"P_Competency_User"==data.module||"P_KRA_User"==data.module||"P_EmployeeSalary"==data.module?data.parseResult.recordCount:data.recordCount}isFileDataPaginationNeeded(){return!1}isModuleBasedImport(){return!1}isFormBasedInit(){return!0}getTableHeaders(data){return"P_Goals"==data.module||"P_Goals"==data.baseTableName||"P_SelfAppraisal"==data.module||"P_Salary_Increment"==data.module||"P_MultiRater"==data.module||"P_PerformanceAppraisal"==data.module||"P_KRA"==data.module||"P_Competency"==data.module||"P_Skills"==data.module||"P_Competency_User"==data.module||"P_KRA_User"==data.module||"P_EmployeeSalary"==data.module?(PMSImport.selectedModule=data.module,data.parseResult.tableHeaders):data.tableHeaders}constructSectionDiv(section){let leftFields=[],getFieldDets=(field,fieldArr)=>{this.getImportInstance().getImportFormId()==AppraisalConfig.goal_formId&&"ASSIGNTO"==field.cname&&(field.isMandatory=!0),fieldArr.push(field)};return $.each(section.col1Fields,function(ind,field){getFieldDets(field,leftFields)}),$.each(section.col2Fields,function(ind,field){getFieldDets(field,leftFields)}),this.getImportInstance().getMappingsInstance().constructSectionDiv(leftFields)}setExtraParamsCallback(params){return PMSImport.getExtraParams(params)}isLocationTrackingEnabled(){return!1}afterSubmitCallback(data,params,others){PMSImport.paImportAfterSubmit(params)}isMandatoryValidation(){if(PMSImport.isValidationNeededImport())return!0;super.isMandatoryValidation()}uploadInitialCallback(){if("#operations/performance/reviewimport"==Layout.Page.hash||"#operations/performance/selfimport"==Layout.Page.hash||"#operations/performance/multiraterimport"==Layout.Page.hash||paCommonUtil.isManageAppraisalPAImportExport()){this.getImportInstance().getContainer().find("[elem=importDataForCont]").show(),this.getImportInstance().getContainer().find("[elem=importDataFor]").show();let options=[],props=ComponentsCommon.select.getProps();options.push({label:ZPeople.decodeTxt(this.getImportInstance().getLabelName()),value:this.getImportInstance().getBaseFormId()}),props.value=options[0].value,props.options=options,ZPeopleComponents.select(this.getImportInstance().getContainer().find("[elem=importDataFor]"),props),this.getImportInstance().getContainer().find("[elem=importBasedOnCont]").hide(),this.getImportInstance().getContainer().find("[elem=importBasedOn]").hide()}else super.uploadInitialCallback()}hashChangeCallback(){let url=Layout.Page.hash;if("#operations/performance/reviewimport"==url||"#operations/performance/selfimport"==url||"#operations/performance/multiraterimport"==url||"#operations/performance/hikeimport"==url||"#operations/performance/goalimport"==url||"#operations/performance/krauserimport"==url||"#operations/performance/competencyuserimport"==url||paCommonUtil.isManageAppraisalPAImportExport())return!1;super.hashChangeCallback()}closeCallback(){super.closeCallback(),"#operations/performance/employeesalary"==Layout.Page.hash?(Layout.Page.container.find(".zpl_rgtcnt").find("#viewsContainer").addClass("zpl_DNI"),Layout.Page.container.find(".zpl_rgtcnt").find("#systemviewsContainer").removeClass("zpl_DNI")):this.getImportInstance().getRefresh()&&(-1!==Layout.Page.hash.indexOf("#performance/myteamuser/goals")||-1!==Layout.Page.hash.indexOf("#performance/appraisaluser/goals")||-1!==Layout.Page.hash.indexOf("#operations/performance/user/goals")?Goals.Filter.searchGoalFilter(void 0):-1!==Layout.Page.hash.indexOf("#performance/myteam/allgoals")||-1!==Layout.Page.hash.indexOf("#performance/myteam/allkra")?TVP.searchListing(void 0,!0):-1===Layout.Page.hash.indexOf("#performance/myteamuser/kra")&&-1===Layout.Page.hash.indexOf("#performance/appraisaluser/kra")&&-1===Layout.Page.hash.indexOf("#operations/performance/user/kra")||Goals.Filter.searchGoalFilter(void 0))}}class PAMethodImportV5UploadFile extends ImportV5UploadFile{constructor(){PMSImport.importReqData=null,PMSImport.importReqParams=null,PMSImport.importAftercallbackIsInit=!0,super()}setImportInstance(importV5){this.IMPORTV5=importV5}getImportInstance(){return this.IMPORTV5}init(data,params,others){if(this.getImportInstance().getSliderInstance().open(),"#operations/performance/kra"==Layout.Page.hash){const resultData=PMSImport.fetchKRARules();this.getImportInstance().setSecArr(resultData)}let callback=(props,locDetails)=>{props.isLocationTrackingEnabled&&!locDetails.isPermEnabled?(FrameworkCommon.showInfoAlert("",ZPI18N.getString("zp.requestuserlocation")+" "+ZPI18N.getString("zp.blockedlocation")),this.getImportInstance().getSliderModal().close()):(FrameworkCommon.removeLoading(this.getImportInstance().getContainer().find("#"+ImportV5Mappings.getConstructMappingsCardId())),this.getImportInstance().getContainer().find("#"+ImportV5Mappings.getConstructMappingsCardId()).addClass("zpl_crdwthful zpl_crdfull"),this.getImportInstance().getContainer().find("#"+ImportV5Mappings.getConstructMappingsCardId()).html(this._getPage()),FrameworkCommon.show(this.getImportInstance().getContainer().find("[elem=uploadFileContainer]")),this._defaultActions())};callback.bind(this);let props={isLocationTrackingEnabled:!1};callback(props)}_defaultActions(){this.getImportInstance().getContainer().find('[elem="importFileButton"]').off("click").on("click",function(event){this.getImportInstance().setFileList(this.getImportInstance().getContainer().find("[elem=importFile]")[0].files),$(event.target).siblings("[elem=importFile]").trigger("click")}.bind(this)),FrameworkCommon.removeError(this.getImportInstance().getContainer().find("[elem=filesDropContainer]")),FrameworkCommon.initDragDropFiles(this.getImportInstance().getContainer().find('[elem="filesDropContainer"]'),this.getImportInstance().getContainer(),(files=>{if($.inArray(files[0].name.split(".").pop(),["csv","xls","xlsx"])>-1){this.getImportInstance().setFileList(this.getImportInstance().getContainer().find("[elem=importFile]")[0].files);let dataTransfer=new DataTransfer;dataTransfer.items.add(files[0]),this.getImportInstance().getContainer().find('[elem="importFile"]')[0].files=dataTransfer.files,this.getImportInstance().getContainer().find('[elem="importFile"]').trigger("change")}else ZPeople.Message.failure(ZPI18N.getString("zp.formfomtsupportxlscsv"))}).bind(this),1),this.getImportInstance().getContainer().find('[elem="importFile"]').off("change").on("change",this._handleUploadedFile.bind(this)),this.getImportInstance().getContainer().find("[elem=downloadSampleTemplate]").off().on("click",this.getImportInstance().getHandler().downloadTemplate.bind(this.getImportInstance().getHandler())),this._showHideMobileUserHelp(),this.getImportInstance().getHandler().uploadInitialCallback()}initImportDataFor(){const pageId=settingsPage.container;let options=[],props=ComponentsCommon.select.getProps();if("#operations/performance/kra"==Layout.Page.hash){let secArr=this.getImportInstance().getSecArr();options.push({label:ZPI18N.getString("zp.designation"),value:"0"}),options.push({label:ZPI18N.getString("zp.department"),value:"1"}),options.push({label:ZPI18N.getString("zp.location"),value:"2"}),options.push({label:ZPI18N.getString("zp.designation")+" & "+ZPI18N.getString("zp.department"),value:"3"}),secArr&&secArr.formfieldDetails.isAvailable&&(options.push({label:ZPI18N.getString("zp.designation")+" & "+secArr.formfieldDetails.displayName,value:"4"}),options.push({label:ZPI18N.getString("zp.designation")+" "+secArr.formfieldDetails.displayName,value:"5"}),options.push({label:secArr.formfieldDetails.displayName,value:"6"})),props.disabled=!0,props.value=ZPeopleComponents.select(pageId.find("#desdepselect")).getValue()}else"#operations/performance/competency"==Layout.Page.hash?(options.push({label:ZPI18N.getString("zp.designation"),value:"0"}),options.push({label:ZPI18N.getString("zp.department"),value:"1"}),options.push({label:ZPI18N.getString("zp.role"),value:"2"}),options.push({label:ZPI18N.getString("zp.location"),value:"3"}),options.push({label:ZPI18N.getString("zp.designation")+" & "+ZPI18N.getString("zp.department"),value:"4"}),props.disabled=!0,props.value=ZPeopleComponents.select(pageId.find("#compdesdepsel2")).getValue()):"#operations/performance/skillset"==Layout.Page.hash&&(options.push({label:ZPI18N.getString("zp.domain"),value:"domain"}),options.push({label:ZPI18N.getString("zp.designation"),value:"designation"}),options.push({label:ZPI18N.getString("zp.department"),value:"department"}),options.push({label:ZPI18N.getString("zp.designation")+" & "+ZPI18N.getString("zp.department"),value:"desDep"}),props.disabled=!0,props.value=ZPeopleComponents.select(pageId.find("#desigdomainsel")).getValue());props.options=options,ZPeopleComponents.select(this.getImportInstance().getContainer().find("[elem=importDataFor]"),props)}}class PAMethodImportV5Handler extends ImportV5Handler{constructor(mode){super(mode)}isLocationTrackingEnabled(){return!1}isFileDataPaginationNeeded(){return!1}getModalHeader(){switch(Layout.Page.hash){case"#operations/performance/kra":return ZPI18N.getString("zp.importkramapping",[PMSSetting.KRA_DISPLAY_NAME]);case"#operations/performance/competency":return ZPI18N.getString("zp.importkramapping",[PMSSetting.COMPETENCY_DISPLAY_NAME]);case"#operations/performance/skillset":return ZPI18N.getString("zp.importkramapping",[PMSSetting.skilldispName]);default:return ZPI18N.getString("zp.import")}}uploadFileCallback(){let formObj=this.getImportInstance().getContainer().find("#cardMappingDetails").find("form[elem=uploadFileForm]");if(this.uploadSetParamsCallback(formObj),this.getImportInstance().setImportFormId(formObj.find("[name=impformId]").val()),this.getImportInstance().setCurrentStep(2),this.getImportInstance().setMappingForward(!0),this.getImportInstance().getSliderModal().nextTab(!1),this.getImportInstance().getContainer().addClass("zpl_mdltopnav"),FrameworkCommon.show(this.getImportInstance().getContainer().find("#tabLeftUl").parents(".zpl_mmnulft")),"#operations/performance/kra"==Layout.Page.hash)formObj.action="performanceConfig.zp?mode=kraMapImport&isnewui=true&modulemode=kra&importtype="+ZPeopleComponents.select(this.getImportInstance().getContainer().find("[elem=importDataFor]")).getValue(),PMSImport.impFormId=ZPeopleComponents.select(this.getImportInstance().getContainer().find("[elem=importDataFor]")).getValue();else if("#operations/performance/competency"==Layout.Page.hash)formObj.action="performanceConfig.zp?mode=competencyMapImport&isnewui=true&modulemode=competency&importtype="+ZPeopleComponents.select(this.getImportInstance().getContainer().find("[elem=importDataFor]")).getValue(),PMSImport.impFormId=ZPeopleComponents.select(this.getImportInstance().getContainer().find("[elem=importDataFor]")).getValue();else if("#operations/performance/skillset"==Layout.Page.hash)formObj.action="performanceConfig.zp?mode=skillSetImport&isnewui=true&modulemode=skill&importtype="+ZPeopleComponents.select(this.getImportInstance().getContainer().find("[elem=importDataFor]")).getValue(),PMSImport.impFormId=ZPeopleComponents.select(this.getImportInstance().getContainer().find("[elem=importDataFor]")).getValue();else if("#operations/performance/cycle"==Layout.Page.hash||"#operations/performance/salarycycle"==Layout.Page.hash){const sliderObj=$(PMSOperation.manageAppraiseeSliderObj.sliderDiv),status=$(sliderObj).find("#appraisalstatus").val();formObj.action="performanceConfig.zp?mode=appraiseeImport&isnewui=true&modulemode=manageappraisee&status="+status+"&configId="+PMSOperation.manageAppraiseeSliderObj.configId}else"#operations/performance/skillsetuserimport"==Layout.Page.hash&&(formObj.action="performanceConfig.zp?mode=skillSetImport&isnewui=true&modulemode=skillsetuser");let formData=new FormData(formObj[0]);ZPeople.Request.sendFormData(formObj.action,formData,this.getImportInstance().getMappingsInstance().init.bind(this.getImportInstance().getMappingsInstance()),{},data=>{FrameworkCommon.failureCallback(data),this.getImportInstance().getSliderModal().close()}),FrameworkCommon.hide(this.getImportInstance().getContainer().find("[elem=uploadFileContainer],[elem=uploadFileHandleDiv]")),FrameworkCommon.hide(this.getImportInstance().getContainer().find("[elem=licenseCountDiv]")),FrameworkCommon.addLoading(this.getImportInstance().getContainer().find("#"+ImportV5Mappings.getConstructMappingsCardId()))}getRecordCount(data){return data.recordCount}isModuleBasedImport(){return!0}getFormId(){return""}isFormBasedInit(){return!1}getTableHeaders(data){return data.tableHeaders}submitMappingsCallback(props,locDets){if(props.isLocationTrackingEnabled&&!locDets.isPermEnabled)return ZPeople.Message.failure(ZPI18N.getString("zp.enableaccesstolocation")),!1;this.getImportInstance().setCurrentStep(4),this.getImportInstance().getSliderModal().nextTab(!1);var params=this.setParamsCallback(props,locDets);ZPeople.Request.send("/performanceConfig.zp",params,this.submitMappingsrequestCallback,this.getImportInstance().getSummaryInstance())}submitMappingsrequestCallback(resultData,params,summaryInstance){PMSImport.importReqData=resultData,PMSImport.importReqParams=params,summaryInstance.init.bind(summaryInstance)(resultData,params)}setExtraParamsCallback(params){return PMSImport.getPAImportParam(params,this.getImportInstance().getImportFormId(),this.getImportInstance().getMappings())}uploadInitialCallback(){"#operations/performance/cycle"==Layout.Page.hash||"#operations/performance/salarycycle"==Layout.Page.hash||"#operations/performance/skillsetuserimport"==Layout.Page.hash?(this.getImportInstance().getContainer().find("[elem=importDataForCont]").hide(),this.getImportInstance().getContainer().find("[elem=importDataFor]").hide(),this.getImportInstance().getContainer().find("[elem=importBasedOnCont]").hide(),this.getImportInstance().getContainer().find("[elem=importBasedOn]").hide()):(this.getImportInstance().getUploadInstance().initImportDataFor(),this.getImportInstance().getUploadInstance().initImportDataBasedOn(),this.getImportInstance().getUploadInstance().showUniqueFieldNote(),this.uploadDefActionCallback())}downloadTemplate(){""!=PMSImport.getImportTemplateType()?PMSImport.downloadImportTemplate():super.downloadTemplate()}isMandatoryValidation(){if(PMSImport.isValidationNeededImport())return!0;super.isMandatoryValidation()}}class PAMethodImportV5Summary extends ImportV5Summary{constructor(){super()}viewRecordsCallback(){this.getSliderModal().close(),"#operations/performance/employeesalary"==Layout.Page.hash&&0==Object.keys(Layout.Page.urlparam).length&&(Layout.Page.container.find("#zp_page_loading").remove(),Layout.Page.container.find(".zpl_rgtcnt").find("#viewsContainer").addClass("zpl_DNI"),Layout.Page.container.find(".zpl_rgtcnt").find("#systemviewsContainer").removeClass("zpl_DNI"))}showRecContainer(){if(PMSImport.importHideSummaryShowRecord()){this.getContainer().find("[elem=importSuccessMessage]").html(ZPI18N.getString("zp.importedsuccessfully"))}if("#operations/performance/employeesalary"==Layout.Page.hash&&(EmployeeSalary.handleTotalRecordCount(!0),0==Object.keys(Layout.Page.urlparam).length&&EmployeeSalary.searchSalaryDetails(!1)),PMSImport.isImportModuleConstruction(this.getContainer().find("[elem=recordCountListDiv] li.zpl_act").attr("actType"))){PMSImport.aftersubmitCallback(),this.hideAllPagination(),PMSImport.isAllowedToShowErrorLink()&&!this.getDataInstance(ZP5Import.SUMMARY_DATA_TYPE.ERROR).getIsEmpty()?FrameworkCommon.show(this.getContainer().find("[elem=importErrorMsgLink]")):FrameworkCommon.hide(this.getContainer().find("[elem=importErrorMsgLink]"));let container=this.getContainer(),selectedContainer=container.find("[elem=recordCountListDiv] li.zpl_act"),dataInstance=this.getDataInstance(selectedContainer.attr("actType"));FrameworkCommon.hide(container.find("[elem=summaryRecContDiv] [elem=tableContainer]").children()),FrameworkCommon.hide(container.find("[elem=summaryRecContDiv] [elem=emptyDivContainer]").children()),FrameworkCommon.addLoading(container.find("#"+ImportV5Summary.getCardId()).find("[elem=summaryRecContDiv]")),container.find("[elem=summaryRecContDiv] [elem=tableContainer] div[actType="+dataInstance.getMode()+"]").children().length>0?dataInstance.showContainer(!1):container.find("[elem=summaryRecContDiv] [elem=emptyDivContainer] [actType="+dataInstance.getMode()+"]").children().length>0?dataInstance.showContainer(!0):selectedContainer.attr("actType")!=ZP5Import.SUMMARY_DATA_TYPE.ERROR?PMSImport.constructImportSummaryCallback(selectedContainer.attr("actType"),this.getImportInstance().getFormDetails().sections,this.getImportInstance().getSummaryInstance().getImportId(),this.getImportInstance().getSummaryInstance().getDataInstance(selectedContainer.attr("actType"))):this.getIsOnlySummary()||FrameworkCommon.removeLoading(this.getContainer().find("#"+ImportV5Summary.getCardId()).find("[elem=summaryRecContDiv]"))}else super.showRecContainer()}}class PAFormsHandler extends ModuleHandler{constructor(formClassObj){super(formClassObj)}handlePrint(printWindow,params){const tableName=ZP5Form.getCurrFormsOperation().getTableName();if("P_SelfAppraisal"===tableName||"P_MultiRater"===tableName&&"#operations-performance-multirater-view"!=settingsPage.tabId||"P_PerformanceAppraisal"===tableName){let layout=PR.reviewKeysObject.LAYOUT.sliderDiv.find(".zpl_paappemvwwrp").clone(!0);layout.find("[attr=viewcmnt]").addClass("zpl_DNI").end().find("[attr=printcmnt]").removeClass("zpl_DNI");let userObj=ZPeople.getUserDetailsById(ZP5Form.getFormClassObj().getParams().selUser);if("P_PerformanceAppraisal"===tableName)userObj=ZPeople.getUserDetailsById(PR.reviewKeysObject.REVIEW_HEADER_DETAILS.appraisee);else if("P_SelfAppraisal"===tableName){let selUser=erecno;AppraisalConfig.selectUsererecno=void 0!=AppraisalConfig.selectUsererecno?AppraisalConfig.selectUsererecno:erecno,selUser=AppraisalConfig.selectUsererecno,userObj=ZPeople.getUserDetailsById(selUser)}let desName=void 0!=userObj.designation?userObj.designation:"";$(PR.reviewKeysObject.printHeader).insertAfter(printWindow.find(".zpl_printlogo"));let htm='<div class="zpl_tblpagination">';if(htm+='<div class="zpl_lftpgn"><div class="zpl_em"><div class="zpl_emimg"><img src="'+userObj.avatar+'"></div>',htm+='<div class="zpl_emdts"><div><em>'+userObj.empid+" - </em><b>"+userObj.name+"</b></div><em>"+desName+"</em></div></div></div>",htm+='<div class="zpl_rhtpgn"><div class="zpl_admclr_rgt">',"P_PerformanceAppraisal"===tableName&&null!=PR.reviewKeysObject.REVIEW_HEADER_DETAILS.reviewer){const reviewObj=ZPeople.getUserDetailsById(PR.reviewKeysObject.REVIEW_HEADER_DETAILS.reviewer);htm+="<div><span><em>"+ZPI18N.getString("zp.reviewer")+'</em></span><span><div class="zpl_em">',htm+='<div class="zpl_emimg"><img src="'+reviewObj.avatar+'"></div>',htm+='<div class="zpl_emdts"><div><em>'+reviewObj.empid+' - </em><b title="'+reviewObj.name+'">'+reviewObj.name+"</b></div></div></div></span></div>"}if(!layout.find("#finalScore").hasClass("zpl_DNI")){let score=layout.find("#finalAvg").text();htm+="<div><span><em>"+ZPI18N.getString("zp.finalscore")+"</em></span><span><b>"+score+"</b></span></div>"}if(!layout.find("#ratingDetails").hasClass("zpl_DNI")&&"P_MultiRater"!=tableName||"P_MultiRater"===tableName&&!layout.find("#ratingName").parent().parent().hasClass("zpl_DNI")){let ratingName=layout.find("#ratingName").text();htm+="<div><span><em>"+ZPI18N.getString("zp.rating")+"</em></span><span><b>"+ZSEC.Encoder.encodeForHTML(ratingName)+"</b></span></div>"}htm+="</div></div>",htm+="</div>",layout.find("#pmsreview_left").remove(),layout.find("#pmsreview_header").remove(),printWindow.find(".zpl_mprintcont").empty().append(layout),$(htm).insertBefore(printWindow.find("#zp_form_outer_container.zpl_mcnt")),printWindow.addClass("zpl_pamdulreview")}else super.handlePrint(printWindow,params)}constructHeader(tableName,formHeaderDiv,container){-1==Layout.Page.hash.indexOf("#operations/performance/multirater")&&(("P_SelfAppraisal"===(tableName=this.FORM_CLASS_OBJ.getTableName())||"P_PerformanceAppraisal"===tableName||"P_MultiRater"===tableName)&&ZP5Form.getFormClassObj().getFormsProperties().getIsPreviewForm())}fieldContainerOuterHtml(){var tableName=this.FORM_CLASS_OBJ.getTableName();let fieldHtmlStart="",fieldHtmlend="",fieldHtmlInit=!1;return("P_SelfAppraisal"===tableName||"P_PerformanceAppraisal"===tableName||"P_MultiRater"===tableName&&"#operations-performance-multirater-view"!=settingsPage.tabId)&&(fieldHtmlStart='<div class="zpl_crdwthful">',fieldHtmlend="</div>",fieldHtmlInit=!0),{fieldHtmlStart:fieldHtmlStart,fieldHtmlend:fieldHtmlend,fieldHtmlInit:fieldHtmlInit}}postFormConstructionModuleHandler(){var tableName=this.FORM_CLASS_OBJ.getTableName();if("P_EmployeeSalary"===tableName&&ZP5Form.getFormClassObj().isViewMode()){let editoption=!1;const singleRec=ZP5Form.getSingleRecord().record,editOpt=ZP5Form.getFormClassObj().LAYOUT.find("#zp_form_editin_singlerec");void 0!==singleRec&&(editoption=singleRec.isAllowedEdit),editoption&&ZP5Form.getFormClassObj().isViewMode()?editOpt.removeClass("zpl_DNI"):editOpt.hide().off("click")}else if("P_UserSkillMap"===tableName){ZP5Form.getFormClassObj().LAYOUT.find("#zp_form_editin_singlerec").hide().off("click")}else if(-1==Layout.Page.hash.indexOf("#operations/performance/multirater")&&"P_EmployeeSalary"!=tableName&&"#myspace"!=settingsPage.tabId||paCommonUtil.isApprovalPage()){if(!ZP5Form.getFormClassObj().getFormsProperties().getIsPreviewForm()){if("P_PerformanceAppraisal"===tableName&&ModuleReview.formUtil.togglePerfAppraisalActions(),(ZP5Form.getFormClassObj().isViewMode()||ZP5Form.getFormClassObj().isEditMode())&&ModuleReview.formUtil.processViewEditRecordDetails(),ModuleReview.formUtil.postFormConstruction(),"P_PerformanceAppraisal"===tableName){const appraiseeField=ZP5Form.getFormClassObj().FIELD_LAYOUT.find('[folabel="Appraisee"]');"false"===appraiseeField.attr("relateddata")&&appraiseeField.parent().remove()}if("P_Goals"==tableName&&Goals.Util.progEditRestrictedInGsp&&(ZP5Form.getFormClassObj().isAddMode()||ZP5Form.getFormClassObj().isEditMode())){var fieldHtml=this.FORM_CLASS_OBJ.FIELD_LAYOUT,fieldComponentID=fieldHtml.find('[name="Progress"]').attr("id");if(void 0!=fieldComponentID){var fcId=fieldComponentID.split("zp_field_")[1];if("Progress"==ZP5Form.Field.getFieldComponent(fcId).labelName){let fieldObjparent=fieldHtml.find('[name="Progress"]').parent();fieldObjparent.parent().children().addClass("zpl_DNI"),fieldObjparent.after("<span>"+ModuleReview.formUtil.getNoValueString(fieldHtml.find('[name="Progress"]').val())+"</span>")}}}}}else this.FORM_CLASS_OBJ.LAYOUT.find("#zp_form_editin_singlerec").remove()}updateHeaderOptions(){var tableName=this.FORM_CLASS_OBJ.getTableName();if(!ZP5Form.getFormClassObj().getFormsProperties().getIsPreviewForm()){if("P_MultiRater"===tableName&&"#operations-performance-multirater-view"==settingsPage.tabId){AppraisalConfig.formUtil.getformDetails("multirater"),this.FORM_CLASS_OBJ.LAYOUT.find("#zp_form_header_name").html(AppraisalConfig.formUtil.multiraterDtl.formDispname);let props={};props.isRecordAdmin=this.FORM_CLASS_OBJ.isRecordAdmin(),props.formLayoutKey=this.FORM_CLASS_OBJ.formLayoutKey,props.isAuditHistoryEnabled=ZP5Form.getCurrFormsOperation().isAuditHistoryEnabled(),props.isLetterTemplateAvailable=ZP5Form.getCurrFormsOperation().getIsLetterTemplateAvailable(),props.isExportAllowed=!1,props.hasMMTForm=ZP5Form.getCurrFormsOperation().getFormsDetailsMap().hasMMTForm,ZP5Form.Layout.constructMoreOptionsForSingleRecordView(this.FORM_CLASS_OBJ.LAYOUT,props)}else if("P_MultiRater_Approval"===tableName)this.FORM_CLASS_OBJ.LAYOUT.find("#zp_form_header_name").html(MR.Util.modalTitle),this.FORM_CLASS_OBJ.LAYOUT.find("#zp_form_editin_singlerec").remove();else if("P_UserSkillMap"===tableName)this.FORM_CLASS_OBJ.LAYOUT.find("#zp_form_editin_singlerec").remove();else if("P_Goals"===tableName){AppraisalConfig.formUtil.getformDetails("goal");let hdr=AppraisalConfig.formUtil.goalFormDtl.formDispname;if(ZP5Form.getFormClassObj().isAddMode())hdr=ZPI18N.getString("zp.addcomponents",new Array(AppraisalConfig.formUtil.goalFormDtl.formDispname)),this.FORM_CLASS_OBJ.LAYOUT.find("#zp_form_editin_singlerec").remove();else if(ZP5Form.getFormClassObj().isEditMode())hdr=ZPI18N.getString("zp.editannouncement",new Array(AppraisalConfig.formUtil.goalFormDtl.formDispname));else if(ZP5Form.getFormClassObj().isViewMode()){let props={};props.isRecordAdmin=this.FORM_CLASS_OBJ.isRecordAdmin(),props.formLayoutKey=this.FORM_CLASS_OBJ.formLayoutKey,props.isAuditHistoryEnabled=ZP5Form.getCurrFormsOperation().isAuditHistoryEnabled(),props.isLetterTemplateAvailable=ZP5Form.getCurrFormsOperation().getIsLetterTemplateAvailable(),props.isExportAllowed=!1,props.hasMMTForm=ZP5Form.getCurrFormsOperation().getFormsDetailsMap().hasMMTForm,ZP5Form.Layout.constructMoreOptionsForSingleRecordView(this.FORM_CLASS_OBJ.LAYOUT,props)}this.FORM_CLASS_OBJ.LAYOUT.find("#zp_form_header_name").html(hdr)}else if(ZP5Form.getFormClassObj().isViewMode()&&"P_EmployeeSalary"==tableName){let props={};props.isRecordAdmin=this.FORM_CLASS_OBJ.isRecordAdmin(),props.formLayoutKey=this.FORM_CLASS_OBJ.formLayoutKey,props.isAuditHistoryEnabled=ZP5Form.getCurrFormsOperation().isAuditHistoryEnabled(),props.isLetterTemplateAvailable=ZP5Form.getCurrFormsOperation().getIsLetterTemplateAvailable(),props.isExportAllowed=!1,props.hasMMTForm=ZP5Form.getCurrFormsOperation().getFormsDetailsMap().hasMMTForm,ZP5Form.Layout.constructMoreOptionsForSingleRecordView(this.FORM_CLASS_OBJ.LAYOUT,props)}!ZP5Form.getFormClassObj().isViewMode()||"P_Goals"!=tableName&&"P_EmployeeSalary"!=tableName&&"P_MultiRater"!==tableName||ModuleReview.formUtil.handleCBRecordView(tableName)}}fieldValueChangeFunc(obj){var targetElement=$(obj),tableName=this.FORM_CLASS_OBJ.getTableName();if("P_SelfAppraisal"===tableName||"P_PerformanceAppraisal"===tableName){if(""!=(fieldDetails=void 0!=(fcId=$(obj).attr("fcid"))?ZP5Form.Field.getFieldComponent(fcId):"")&&"P_Rating"==fieldDetails.refTableName&&"Rating"==fieldDetails.labelName){const optionData=ZPeopleComponents.select(targetElement).getOptionData();PR.reviewKeysObject.LAYOUT.sliderDiv.find("#ratingName, #ratingName1").text(optionData[0].text)}}else if("P_Goals"===tableName){var fcId,fieldDetails;if(""!=(fieldDetails=void 0!=(fcId=$(obj).attr("fcid"))?ZP5Form.Field.getFieldComponent(fcId):"")&&"P_KRA"==fieldDetails.refTableName&&"KRA"==fieldDetails.labelName){const optionData=ZPeopleComponents.select(targetElement).getOptionData();if("-Select-"==optionData[0].id)return ZPeopleComponents.select(targetElement).setValue(Goals.KraVsGoals.selectKra),!1;Goals.KraVsGoals.selectKra=optionData[0].id}}}loadRecordParams(params){var tableName=this.FORM_CLASS_OBJ.getTableName();"#operations-performance-multirater-view"!=settingsPage.tabId&&"P_EmployeeSalary"!=tableName?"P_MultiRater"===tableName||"P_PerformanceAppraisal"==tableName&&($("#modal_Container").find("#reviewApprovalModal").length>0||paCommonUtil.isRatingPageFromReviewHistory()||"#performance-appraisal-userlisting"===settingsPage.tabId||paCommonUtil.isManageAppraisalReviewPage()||"#performance-appraisal-salaryhike"===settingsPage.tabId||paCommonUtil.isApprovalPage()||PR.reviewKeysObject.isWebForm)?MR.form.getParamsForForms(params):"P_SelfAppraisal"===tableName?MR.form.getParamsForForms(params):("#performance-appraisal-multiraterfeedback"==settingsPage.tabId||"#performance-myreview-selfappraisal"==settingsPage.tabId||"#performance-appraisal-userlisting"==settingsPage.tabId||paCommonUtil.isRatingPageFromReviewHistory()||paCommonUtil.isManageAppraisalReviewPage()||"#performance-appraisal-salaryhike"===settingsPage.tabId||"#operations-performance-oprappraisaluser-selfappraisal"===settingsPage.tabId||"#operations-performance-oprappraisaluser-choosemultirater"===settingsPage.tabId||("#performance-appraisaluser-goals"===settingsPage.tabId||"#operations-performance-user-goals"===settingsPage.tabId||paCommonUtil.isApprovalPage())&&void 0!=Layout.Page.urlparam.configId&&-1!=Layout.Page.urlparam.configId)&&"P_Goals"===tableName&&(params.subMode=ZP5Form.getFormClassObj().getParams().formMode,params.isApprovalEnabled=ZP5Form.isApprovalEnabled(ZP5Form.getFormClassObj().getFormId()),params.isFormComponentNeed=!1,"#performance-myreview-selfappraisal"==settingsPage.tabId&&null!=SelfAppr.util.SELFAPPRAISALADDCONFIGID&&void 0!=SelfAppr.util.SELFAPPRAISALADDCONFIGID?params.configId=SelfAppr.util.SELFAPPRAISALADDCONFIGID:"#performance-appraisaluser-goals"===settingsPage.tabId||"#operations-performance-user-goals"===settingsPage.tabId?params.configId=Layout.Page.urlparam.configId:params.configId=AppraisalConfig.selectconfigId):(params.subMode=ZP5Form.getFormClassObj().getParams().formMode,params.isApprovalEnabled=ZP5Form.isApprovalEnabled(ZP5Form.getFormClassObj().getFormId()),params.isFormComponentNeed=!1)}loadParamsForSubmit(params){var tableName=this.FORM_CLASS_OBJ.getTableName();if("P_Goals"!=tableName&&"P_SelfAppraisal"!=params.zp_tableName&&"P_PerformanceAppraisal"!=params.zp_tableName||0!=(params="P_Goals"==tableName&&-1!==Layout.Page.hash.indexOf("home/myspace/overview-goals")?goalWidget.formcallback(params,!1):Goals.Form.formcallback(params,!1)))return-1===Layout.Page.hash.indexOf("#operations/performance/multirater")&&("P_SelfAppraisal"!==tableName&&"P_MultiRater"!==tableName&&"P_PerformanceAppraisal"!==tableName||ModuleReview.formUtil.loadParamsForSubmit(params)),params}validate(){var tableName=this.FORM_CLASS_OBJ.getTableName();if("P_EmployeeSalary"===tableName)return!0;if("P_SelfAppraisal"===tableName||"P_MultiRater"===tableName&&-1===Layout.Page.hash.indexOf("#operations/performance/multirater")||"P_PerformanceAppraisal"===tableName){if(this.FORM_CLASS_OBJ.isDraft||"#performance-appraisaluser-selfappraisal"==settingsPage.tabId)return!0;{let isValid=PR.util.validateModuleRating(!0,tableName);const ratingEnabled=Object.values(PR.reviewKeysObject.MODULERATINGENABLED).some(value=>!0===value);let isRatingRangValidation=("P_SelfAppraisal"==tableName||"P_PerformanceAppraisal"===tableName||"P_MultiRater"===tableName)&&PR.reviewKeysObject.isRatingRangeEnabled&&ratingEnabled&&PR.util.validateRatingRange();if(!isValid||isRatingRangValidation){const sliderDiv=PR.reviewKeysObject.LAYOUT.sliderDiv;if(sliderDiv.find("#sliderSbt").attr("disabled",!1),sliderDiv.find("#savedraft_btn").attr("disabled",!1),isRatingRangValidation){const ranges=PR.util.getMinAndMaxRange();ZPeople.Message.failure(ZPI18N.getString("zp.ratignrangerror",[ranges.minRange,ranges.maxRange])),isValid=!1}}if(isValid&&PR.continuousReview.isCRBasedCycle()&&PR.continuousReview.yetToSync){let{_isSyncReview:_isSyncReview}=PR.continuousReview.isSyncCRReview(tableName);if(_isSyncReview)return PR.continuousReview.yetSyncCRRating(),!1}return isValid}}if("P_Goals"===tableName){if("performance/myteam/allgoals"===Layout.Page.currentmode||"operations/performance/oprgoals/listview"===Layout.Page.currentmode){ZP5Form.getFormClassObj().LAYOUT;const{_mode:_mode}=TVP.getModeAndModuleType();let selectElm=ZP5Form.getFormClassObj().LAYOUT.find("#"+_mode+"_dirreportees_sel");return""!==ZPeopleComponents.select(selectElm).getValue()||(ZPeopleComponents.select(selectElm).setAttributes({className:"ztextbox__error"}),selectElm.parent().find("#error_message").remove(),selectElm.parent().append('<span id="error_message" class="ztextbox--error__label">'+ZPI18N.getString("zp.entervalforfield",new Array(ZPI18N.getString("zp.leave.operations.employeename")))+"</span>"),!1)}return!0}return!0}close(){if(-1!==Layout.Page.hash.indexOf("operations/performance/multirater")||-1!==Layout.Page.hash.indexOf("operations/performance/oprgoals"))return ZP5Views.getLatestFormViewUrl(this.FORM_CLASS_OBJ.getFormsProperties().getFormId());{const tableName=this.FORM_CLASS_OBJ.getTableName();if("P_MultiRater"==tableName||"P_PerformanceAppraisal"==tableName||"P_SelfAppraisal"==tableName){PR.reviewKeysObject.isForm=!0,PR.reviewKeysObject.LAYOUT.sliderDiv.find("#sliderSbt, #savedraft_btn").attr("disabled",!1),PR.reviewKeysObject.LAYOUT.close()}"P_Goals"==tableName&&ZP5Form.getForm(ZP5Form.getCurrentFormId()).refreshFormComponentData();var params=this.FORM_CLASS_OBJ.getParams();if(params.disableUrlTrack||void 0!==params.callback&&"function"==typeof params.callback&&params.callback(this.FORM_CLASS_OBJ.SUCCESS_PKID,this.FORM_CLASS_OBJ.currentTimerData),!params.disableUrlTrack){const tabId=settingsPage.tabId;if("P_EmployeeSalary"===tableName){let niceUrl="#performance-employeesalary"===tabId||"#performance-employeesalary-view"===tabId?"performance/employeesalary":"operations/performance/employeesalary";return(settingsUrlProps.url.includes("employeesalary/add")||settingsUrlProps.url.includes("employeesalary/view")||settingsUrlProps.url.includes("employeesalary/edit")||settingsUrlProps.url.includes("employeesalary-view"))&&!EmployeeSalary.isAddEditSubmit&&(EmployeeSalary.isAddEditCancel=!0,niceUrl+="-viewId:"+ZP5Views.getCurrViewObj().viewId),niceUrl}}return"P_Goals"===this.FORM_CLASS_OBJ.getTableName()&&AppraisalConfig.isKraGoals&&ZP5Form.getForm(ZP5Form.getCurrentFormId()).refreshFormComponentData(),null}}successCallback(resultData,params,isModified){const tableName=this.FORM_CLASS_OBJ.getTableName();if("P_PerformanceAppraisal"==tableName&&"operations/performance/oprappraisaluser/review"==Layout.Page.currentmode)void 0!=resultData[0].isPublishedFieldsEdited&&resultData[0].isPublishedFieldsEdited&&(ApprReview.Reviewer.isPublishedFieldsEdited=!0),void 0!=PMSCycleManageData&&PMSCycleManageData.setrefreshManageAppraisalData();else{if("P_PerformanceAppraisal"===tableName&&void 0!=resultData[0].isPublishedFieldsEdited&&resultData[0].isPublishedFieldsEdited&&("performance/appraisal/userlisting"==Layout.Page.currentmode||"operations/performance/cycle"===Layout.Page.currentmode))return void ApprReview.Reviewer.getConfirmationForEmpFeedbackUpdate(resultData[0].pkId);"performance/myteam/allgoals"===Layout.Page.currentmode||paCommonUtil.isTeamKraGoals()?Goals.peersView.goalAddSuccess():"operations/performance/oprgoals/listview"===Layout.Page.currentmode&&"P_Goals"===tableName&&ZP5Views.currViewObj.reloadView(ZP5Views.currViewObj.getFormId(),ZP5Views.getSelectedView(ZP5Views.currViewObj.getViewId()),!0)}}getEditCallback(){const tableName=this.FORM_CLASS_OBJ.getTableName();if(this.FORM_CLASS_OBJ.LAYOUT.find("#zp_form_editin_singlerec").on("click"),"P_SelfAppraisal"==tableName?SelfAppr.form.editselfAppRec(ZP5Form.getFormClassObj().getFormsProperties().getRecordId()):"t_505460000000230233"!=tableName&&"t_145840000000341749"!=tableName||NewPASanmar.editPrdComment(),"P_PerformanceAppraisal"==tableName){let params=ZP5Form.getFormClassObj().getParams();params.formMode="EDIT",params.addmodclass="zpl_DNI",params.readOnlyFields=PR.util.getReadOnlyFieldsforReviewPA(),PR.sliderLayout.loadLayout(!1,"EDIT"),PR.reviewKeysObject.LOADFORMOBJ=ZP5Form._toForm(params),PR.reviewKeysObject.LOADFORMOBJ.setFormContainer(PR.reviewKeysObject.LAYOUT.sliderDiv.find("#loadreviewform")),PR.reviewKeysObject.LOADFORMOBJ.setIsFormForFieldLayout(),PR.reviewKeysObject.LOADFORMOBJ.skipHeader(!0),PR.reviewKeysObject.LOADFORMOBJ.skipFooter(!0),PR.reviewKeysObject.LOADFORMOBJ.setFormModel(ZP5Form.MODEL.NO_MODEL).init()}"P_Goals"==tableName&&Goals.Form.editDraftGoals(ZP5Form.getFormClassObj().getParams().recordId,ZP5Form.getFormClassObj().getParams().formId),"P_MultiRater"==tableName&&(MR.form.isFromForm=!0,MR.form.showRecordRate(ZP5Form.getFormClassObj().getFormsProperties().getRecordId(),!1,!0,ZP5Form.getFormClassObj().getParams().configId,ZP5Form.getFormClassObj().getParams().selUser,ZP5Form.getFormClassObj().getParams().raterId)),"P_EmployeeSalary"==tableName&&EmployeeSalary.showForm("edit",ZP5Form.getFormClassObj().getFormsProperties().getRecordId()),this.FORM_CLASS_OBJ.layoutRevertChanges(this.FORM_CLASS_OBJ)}validateForm(result){if(-1===Layout.Page.hash.indexOf("#operations/performance/multirater")){var isMandatory=!0;this.FORM_CLASS_OBJ.isDraft&&(isMandatory=!1);var tableName=this.FORM_CLASS_OBJ.getTableName();if(isMandatory&&("P_SelfAppraisal"==tableName||"P_MultiRater"==tableName||"P_PerformanceAppraisal"==tableName)&&"#performance-appraisaluser-selfappraisal"!=settingsPage.tabId){const ratingEnabled=Object.values(PR.reviewKeysObject.MODULERATINGENABLED).some(value=>!0===value);let isRatingRangValidation=("P_SelfAppraisal"==tableName||"P_PerformanceAppraisal"===tableName||"P_MultiRater"===tableName)&&PR.reviewKeysObject.isRatingRangeEnabled&&ratingEnabled&&PR.util.validateRatingRange();if(!PR.util.validateModuleRating(!0,tableName)||isRatingRangValidation){var errMsg={};if(isSanmarUI)errMsg.SanmarReviewerror=ZPI18N.getString("zp.entervalidinput");else if(isRatingRangValidation){const ranges=PR.util.getMinAndMaxRange();errMsg.AppraisalComponent_Error=ZPI18N.getString("zp.ratignrangerror",[ranges.minRange,ranges.maxRange])}else errMsg.AppraisalComponent_Error=ZPI18N.getString("zp.entervalidinput");var resutlObj={};resutlObj.message=errMsg,result.errorList.push(resutlObj)}}}if(result.errorList.length>0&&("P_SelfAppraisal"==tableName||"P_PerformanceAppraisal"===tableName||"P_MultiRater"===tableName)){const sliderDiv=PR.reviewKeysObject.LAYOUT.sliderDiv;sliderDiv.find("#sliderSbt").attr("disabled",!1),sliderDiv.find("#savedraft_btn").attr("disabled",!1)}}getFailureMessage(resultData,params){let{code:code,message:message}=resultData[0];var tableName=this.FORM_CLASS_OBJ.getTableName();if("P_SelfAppraisal"==tableName||"P_PerformanceAppraisal"===tableName||"P_MultiRater"===tableName){const sliderDiv=PR.reviewKeysObject.LAYOUT.sliderDiv;sliderDiv.find("#sliderSbt").attr("disabled",!1),sliderDiv.find("#savedraft_btn").attr("disabled",!1)}return"permission_denied"===message?ZPI18N.getString("zp.permissiondenied"):[7029,7031,7040,7105,7323,7400,7478,"MR_ERROR"].includes(code)?"object"==typeof message?message[Object.keys(message)[0]]:message:void super.getFailureMessage(resultData,params)}isSingleFiledEditAllowed(){var tableName=this.FORM_CLASS_OBJ.getTableName();return"P_PerformanceAppraisal"!==tableName&&"P_SelfAppraisal"!==tableName&&"P_MultiRater"!==tableName&&"P_MultiRater_Approval"!==tableName&&"P_Goals"!==tableName&&"P_KRA_User"!==tableName&&"P_UserSkillMap"!==tableName}isEditOptionAllowed(){var tableName=this.FORM_CLASS_OBJ.getTableName();return"P_PerformanceAppraisal"!==tableName&&"P_Goals"!==tableName}loadLookupDataParams(params){"P_PerformanceAppraisal"===this.FORM_CLASS_OBJ.getTableName()?params.configId=Layout.Page.urlparam.configId:"P_SelfAppraisal"===this.FORM_CLASS_OBJ.getTableName()?params.configId=SelfAppr.util.SELFAPPRAISALADDCONFIGID:"P_Goals"===this.FORM_CLASS_OBJ.getTableName()&&AppraisalConfig.isKraGoals&&""!=Goals.Util.selUser&&null!=Goals.Util.selUser&&(params.selUser=Goals.Util.selUser)}getAddUpdateRecordCallback(params){var fromPAModule=-1!==Layout.Page.hash.indexOf("#performance/appraisal/multiraterfeedback");if("P_MultiRater"==this.FORM_CLASS_OBJ.getTableName()&&fromPAModule){if(ZPeopleComponents.isComponent("#mrfeedback_cycleFilter")){let configId=ZPeopleComponents.select(Layout.Page.container.find("#mrfeedback_cycleFilter")).getValue();if(void 0===configId)return null;params.configId=configId,params.selUser=$("#rate_"+params.zp_recordId).attr("seluser")}return{successCallback:MR.FeedBack.updateFeedback}}return null}updateLookupOptionParams(params){"P_PerformanceAppraisal"===this.FORM_CLASS_OBJ.getTableName()?params.configId=Layout.Page.urlparam.configId:"P_SelfAppraisal"===this.FORM_CLASS_OBJ.getTableName()?params.configId=SelfAppr.util.SELFAPPRAISALADDCONFIGID:"P_Goals"===this.FORM_CLASS_OBJ.getTableName()&&AppraisalConfig.isKraGoals&&""!=Goals.Util.selUser&&null!=Goals.Util.selUser&&(params.selUser=Goals.Util.selUser)}draftBtnNotNeed(){return"P_PerformanceAppraisal"===this.FORM_CLASS_OBJ.getTableName()}submitNewBtnNotNeed(){let tableName=this.FORM_CLASS_OBJ.getTableName();return"P_Goals"===tableName||"P_SelfAppraisal"===tableName||"P_EmployeeSalary"===tableName}isfieldTreatAsPicklist(labelName){let tableName=this.FORM_CLASS_OBJ.getTableName();return"AppriasalConfiguration"===labelName&&"P_SelfAppraisal"==tableName||"Rating"===labelName&&("P_SelfAppraisal"==tableName||"P_PerformanceAppraisal"==tableName)}isFieldNotAllowForConstruction(labelName){let tableName=this.FORM_CLASS_OBJ.getTableName(),dataObject=ZP5Form.Field.getFieldComponentByLabel(labelName,this.FORM_CLASS_OBJ.getFormId());return!("P_Goals"!==tableName||"IsArchived"!==labelName||!this.FORM_CLASS_OBJ.isAddMode())||!(!this.FORM_CLASS_OBJ.isAddMode()||"P_Goals"!=tableName||0!==dataObject.editperm&&(-1==Layout.Page.hash.indexOf("home/myspace/overview")&&-1==Layout.Page.hash.indexOf("performance/myreview/")||4!==dataObject.editperm)&&(-1==Layout.Page.hash.indexOf("performance/myteamuser")&&-1==Layout.Page.hash.indexOf("performance/myteam")||1!==dataObject.editperm))}validRecord(){return!(!(this.FORM_CLASS_OBJ.PRINT||void 0==this.FORM_CLASS_OBJ.FormOperations.getFormsDetailsMap()||this.FORM_CLASS_OBJ.FormOperations.isOperationalRoleAdmin()||this.FORM_CLASS_OBJ.isDraftrec||this.isModuleAdmin())&&this.FORM_CLASS_OBJ.isEditMode()&&"P_Goals"==this.FORM_CLASS_OBJ.getTableName()&&this.FORM_CLASS_OBJ.getRecordDetails().record.isArchive)||(ZP5Form.showErrMsg(ZPI18N.getString("zp.permdeniedtoeditarchivedgoals",new Array(this.FORM_CLASS_OBJ.FormOperations.getFormDisplayName(),this.FORM_CLASS_OBJ.FormOperations.getFormDisplayName()))),!1)}isFormEditable(formCompObj){if(!PR.reviewKeysObject.isFromCyclePreview){let tableName=this.FORM_CLASS_OBJ.getTableName();var isPAComEnabled=("P_MultiRater"===tableName||"P_SelfAppraisal"===tableName||"P_PerformanceAppraisal"===tableName)&&0!==Object.keys(formCompObj.enabledComponents).length,reviewHist="P_PerformanceAppraisal"===tableName&&this.FORM_CLASS_OBJ.getParams().hasOwnProperty("viewmyratings")&&this.FORM_CLASS_OBJ.getParams().viewmyratings;if(!isPAComEnabled&&!reviewHist)return!1}return!0}isValidFields(labelName){var self_PAlabels=["AppriasalConfiguration","AppraiseeList","Employee"];isSanmarUI&&(self_PAlabels=["AppriasalConfiguration","AppraiseeList"]);let tableName=this.FORM_CLASS_OBJ.getTableName();return!("P_PerformanceAppraisal"==tableName&&-1!==["Appraiser","IsFinalized","IsReviewed","Configuration","AppraiseeList","ReviewStartDate","ReviewEndDate","IsPublished","ReviewerType","EATYPE","EAComments"].indexOf(labelName)||"P_SelfAppraisal"==tableName&&-1!==self_PAlabels.indexOf(labelName)||"P_MultiRater"==tableName&&-1!==["StartDate","EndDate","Appraiser","AppriasalConfiguration","Feedback_Status"].indexOf(labelName)||"P_Goals"==tableName&&-1!==["UserRating","ManagerRating","Job","AssignedTo","AssignedBy","IsArchived"].indexOf(labelName))}getFormInputHtml(inputfieldHtml){"P_PerformanceAppraisal"===this.FORM_CLASS_OBJ.getTableName()&&this.FORM_CLASS_OBJ.isEditMode()&&!this.FORM_CLASS_OBJ.IS_RESUBMIT&&'<input type="hidden" name="islocallysaved" id="islocallysaved" value="false"/>'}isQuickAddAllowed(obj){return"P_Goals"!==this.FORM_CLASS_OBJ.getTableName()||"Priority"!==obj.labelName}fileFieldHtml(fieldData,value,filePath,downloadParams){let tableName=this.FORM_CLASS_OBJ.getTableName(),fileHtml="";if(Layout.Page.hash.includes("selfappraisal-mode:revhistory")?downloadParams.submode="myratings":"P_PerformanceAppraisal"==tableName&&(downloadParams.userErecno=AppraisalConfig.selectUsererecno),"1"==fieldData.uploadSource)fileHtml="<span><a onclick=\"window.open('"+filePath+'\');" href="javascript:;">'+ZP5Form.Field.getNoValueString(value)+"</a></span>";else if(void 0!=filePath&&(filePath.indexOf(workDriveUrl)>-1||filePath.indexOf(writerUrl)>-1||filePath.indexOf(sheetUrl)>-1||filePath.indexOf(showUrl)>-1)){fileHtml="<span><a onclick=\"window.open('"+filePath.substr(0,filePath.lastIndexOf("/"))+'\');" href="javascript:;">'+ZP5Form.Field.getNoValueString(value)+"</span>"}else{var fileExtn=ZP5Form.FILEUPLOAD_IMAGES.getExtensionFromFilename(value);fileHtml=1==isPreviewAllowed&&null!=fileExtn&&void 0!=fileExtn&&""!=fileExtn&&-1!=ZP5Form.PreviewSupportedFileTypes.indexOf(fileExtn)?'<span><a fileName="'+value+'" filePath="'+filePath+'" onclick="ZP5Form.FILEUPLOAD_IMAGES.showPreview(this,\''+encodeURIComponent(JSON.stringify(downloadParams))+"')\">"+ZP5Form.Field.getNoValueString(value)+"</span>":'<span><a filePath="'+filePath+'" onclick="window.open(\''+ZP5Form.constructDownloadLink(downloadParams)+'\');" href="javascript:;">'+ZP5Form.Field.getNoValueString(value)+"</span>"}return fileHtml}submitCallback(resultData,params){let tableName=this.FORM_CLASS_OBJ.getTableName();if("P_EmployeeSalary"===tableName)if("#operations-performance-employeesalary"==settingsPage.tabId&&void 0==ZP5Views.currViewObj){let recid="";"ADD"===ZP5Form.getFormClassObj().getFormsProperties().getMode()?recid=resultData[0].pkId:"EDIT"===ZP5Form.getFormClassObj().getFormsProperties().getMode()&&(recid=ZP5Form.getFormClassObj().getFormsProperties().getRecordId()),this.FORM_CLASS_OBJ.close(),EmployeeSalary.refreshData=!0,EmployeeSalary.salaryConstructStart(),""!=recid&&EmployeeSalary.showForm("view",recid)}else this.FORM_CLASS_OBJ.close(),"P_EmployeeSalary"===tableName&&ZP5Views.currViewObj.reloadView(ZP5Views.currViewObj.getFormId(),ZP5Views.getSelectedView(ZP5Views.currViewObj.getViewId()),!0);else("P_Goals"===tableName||"P_MultiRater"===tableName&&-1!=settingsPage.tabId.indexOf("operations-performance-multirater"))&&super.submitCallback(resultData,params)}needNoChangesAlert(){return"P_SelfAppraisal"!==this.FORM_CLASS_OBJ.getTableName()}isRefreshLookup(){if("P_Goals"===this.FORM_CLASS_OBJ.getTableName())return!0}setInitialParams(params){"P_Goals"===this.FORM_CLASS_OBJ.getTableName()&&ZP5Form.getFormClassObj().isEditMode()&&AppraisalConfig.isKraGoals&&ZP5Form.getFormClassObj().setParamsVal("readOnlyFields",["KRA"]),super.setInitialParams(params)}}class GoalsMassUpdateHandler extends MassUpdateModuleHandler{getContainer(){return"#performance-myteam-allgoals"===settingsPage.tabId||"#performance-myteam-allkra"===settingsPage.tabId?Layout.Page.container:ZP5Views.getCurrViewObj().container}handleFailure(resultObj,isDefaultError){if("#performance-myteam-allgoals"===settingsPage.tabId||"#performance-myteam-allkra"===settingsPage.tabId){if(resultObj.isLicenseCountExceeded?ZPeople.Message.failure(ZPI18N.getString("zp.licensecountexceeded")):"GOALVALIDATIONFAILED"===resultObj.errorType?ZPeople.Message.failure(resultObj.errormessage[0].message.error):"GOALPROGRESSFAILED"===resultObj.errorType&&ZPeople.Message.failure(resultObj.errormessage),resultObj.isSuperAdminChange){var errMap=resultObj.errorMap;ZPSetupCommon.showErr(errMap.message,massUpdateElmId.find("#editable"+errMap.labelName).closest("td#firstEdtbox"),"dverrormsg")}}else void 0!=resultObj&&resultObj.hasOwnProperty("errorType")?"GOALVALIDATIONFAILED"===resultObj.errorType?ZPeople.Message.failure(resultObj.errormessage[0].message.error):"GOALPROGRESSFAILED"===resultObj.errorType&&ZPeople.Message.failure(resultObj.errormessage):isDefaultError||ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror")),$("#"+zp5MassUpdate.sliderProps.id).find("#sliderSbt").removeClass("disabled");zp5MassUpdate.container.find("#sliderSbt").removeClass("disabled")}handleSuccess(resultObj,paramsObj){if("#performance-myteam-allgoals"===settingsPage.tabId||"#performance-myteam-allkra"===settingsPage.tabId)resultObj.isSuccess?(ZPeople.Message.success(ZPI18N.getString("zp.success")),zp5MassUpdate.sliderModalObj.close(),TVP.fetchDataList(!1),TVP.listActions.closeSelectAllRecord()):void 0!==resultObj.message?ZPeople.Message.failure(response.message):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"));else{ZPeople.Message.success(ZPI18N.getString("zp.updatedsuccessfully"));var pkIds=resultObj.modifiedPkIds;let approvalDetails=ZP5Form.getFormsOperation(paramsObj.formid).getApprovalSettingsDetails();$.each(pkIds,function(index){ZP5Form.refreshRecord(paramsObj.formid,index),void 0!=approvalDetails&&approvalDetails.isVerifySend&&ZPApprovals.APPROVAL_DETAILS[index]&&delete ZPApprovals.APPROVAL_DETAILS[index]}),ZP5Views.refreshview(),zp5MassUpdate.sliderModalObj.close()}}getPkIds(){if("#performance-myteam-allgoals"===settingsPage.tabId||"#performance-myteam-allkra"===settingsPage.tabId){let pkIds=[];const{_mode:_mode}=TVP.getModeAndModuleType();let userTableElm=this.getContainer().find("#"+_mode+"_table");return $.each(userTableElm.find("tbody input[type=checkbox]:checked"),function(index){pkIds[index]=$(this).parents("[goalid]").attr("goalid")}),pkIds}{let pkIds=[],userTableElm=this.getContainer().find("table#viewsContainer:visible");return $.each(userTableElm.find("tbody input[name=check]:checked"),function(index){pkIds[index]=$(this).parents("[recordid]").attr("recordid")}),pkIds}}}class EmplyeeSalaryMassUpdateHandler extends MassUpdateModuleHandler{getContainer(){return Layout.Page.container}handleFailure(resultObj){if(resultObj.isLicenseCountExceeded?ZPeople.Message.failure(ZPI18N.getString("zp.licensecountexceeded")):"GOALVALIDATIONFAILED"===resultObj.errorType?ZPeople.Message.failure(resultObj.errormessage[0].message.error):"CYCLEINPROGRESS"===resultObj.errorType&&ZPeople.Message.failure(resultObj.errormessage[0].message.error),$("#massUpdateSlider").find("#sliderSbt").removeClass("disabled"),resultObj.isSuperAdminChange){var errMap=resultObj.errorMap;ZPSetupCommon.showErr(errMap.message,massUpdateElmId.find("#editable"+errMap.labelName).closest("td#firstEdtbox"),"dverrormsg")}}handleSuccess(resultObj,paramsObj){resultObj.isSuccess?(ZPeople.Message.success(ZPI18N.getString("zp.success")),zp5MassUpdate.sliderModalObj.close(),ZP5Views.isSystemView()?(EmployeeSalary.refreshData=!1,EmployeeSalary.searchSalaryDetails(!0),EmployeeSalary.showEmployeeSalaryList(),EmployeeSalary.removeOpnViewAction(!0,!1)):ZP5Views.currViewObj.reloadView(ZP5Views.currViewObj.getFormId(),ZP5Views.getSelectedView(ZP5Views.currViewObj.getViewId()),!0)):void 0!==resultObj.message?ZPeople.Message.failure(response.message):ZPeople.Message.failure(ZPI18N.getString("zp.sorryservererror"))}getPkIds(){let pkIds=[];if(ZP5Views.isSystemView())pkIds=EmployeeSalary.employeeArr;else{let userTableElm=ZP5Views.currViewObj.container.find("table#viewsContainer:visible");$.each(userTableElm.find("tbody input[name=check]:checked"),function(index){pkIds[index]=$(this).parents("[recordid]").attr("recordid")})}return pkIds}}class PAReportExportHandler extends ExportV5Handler{constructor(mode){super(mode)}isPasswordProtected(){const mode=ZP5Export.getCurrExportObj().getProps().submode;return Performance.Reports.Export.isPasswordProtectedCheck(mode)}getAllowedFormats(){ZP5Export.getCurrExportObj().getMode();let allowedFormats=[],formatArr=new Array("xls","xlsx","csv","tsv"),restrictedFormats=this.getRestrictedFormats();for(i=0;i<formatArr.length;i++)-1==$.inArray(formatArr[i],restrictedFormats)&&allowedFormats.push(formatArr[i]);return allowedFormats}getRestrictedFormats(){switch(ZP5Export.getCurrExportObj().getProps().submode){case"appraisalModulesRating":return new Array("csv","tsv")}return new Array}getTabularlabel(){return ZPI18N.getString("zp.includetabulardata")}hasTabularSections(){const mode=ZP5Export.getCurrExportObj().getProps().submode;switch(mode){case Performance.Reports.goalsReport.reportName:return Performance.Reports.Export.getIsGoalAdditionalCallbackNeed(mode);case"alluserskill":case"alluserskillwithDomain":case"allskillversion":case"empvspotential":case"noSkillEmp":case"feedback":case"appraisalStatus":case"selfAppraisalStatus":case"multiRaterStatus":case"salaryHikeStatus":case"EsignStatus":case"statusCount":case"ReviewApprovalStatus":case"reviewStatus":return!1;case"multiRater":case"selfAppraisal":return!0;case"moduleRating":case"detailedModuleRating":case"APPRAISAL_REPORT":case"salaryHike":case"perfvspot":case"employeeAppFeedback":case"cfs":case"appraisalModulesRating":return!1}return!1}additionalCallback(optLayout,props){const mode=ZP5Export.getCurrExportObj().getProps().submode;(mode==Performance.Reports.goalsReport.reportName&&Performance.Reports.Export.getIsGoalAdditionalCallbackNeed(mode)||"appraisal"==mode||mode==Performance.Reports.appraisalReport.reportName)&&("appraisal"!=mode&&mode!=Performance.Reports.appraisalReport.reportName||(Performance.Reports.fieldArr=new Array,Performance.Reports.Export.showAppraisalFields()),mode==Performance.Reports.goalsReport.reportName&&(Performance.Reports.fieldArr=new Array,Performance.Reports.Export.showGoalsFields())),"detailedModuleRating"==mode?Performance.Reports.Export.showModuleRatingEnabledComp(mode):"cfs"==mode?Performance.Reports.Export.exportReviewType():"appraisalModulesRating"==mode&&Performance.Reports.Export.showAppraisalModulesRatingAdditionalCol()}isIncludeUsersDiv(){if(ZP5Views.isSystemView()){switch(ZP5Export.getCurrExportObj().getProps().submode){case Performance.Reports.goalsReport.reportName:case"alluserskill":case"alluserskillwithDomain":case"allskillversion":case"empvspotential":case"noSkillEmp":case"feedback":case"appraisalStatus":case"selfAppraisalStatus":case"multiRaterStatus":case"salaryHikeStatus":case"EsignStatus":case"statusCount":case"ReviewApprovalStatus":case"reviewStatus":case"multiRater":case"selfAppraisal":case"appraisal":case"moduleRating":case"detailedModuleRating":case"APPRAISAL_REPORT":case"salaryHike":case"perfvspot":case"employeeAppFeedback":case"cfs":case"appraisalModulesRating":case"reviewExtensionReportExport":return!1}return!0}return!1}}class MRFeedbackViewHandler extends ModuleFormsViewsHandler{needPreHandlings(){return!1}getExtraParamForFetch(){var params={};return params.configId=PR.reviewKeysObject.mrFeedbackProps.configId,params.erecno=PR.reviewKeysObject.mrFeedbackProps.erecno,params.employeeStatus="all",params.isOnload=!0,PR.reviewKeysObject.mrFeedbackProps.formName&&"P_MultiRaterFeedback"===PR.reviewKeysObject.mrFeedbackProps.formName&&AppraisalConfig.InitResult.isRaterTypeEnable&&(params.groupBy="Type: true"),PR.reviewKeysObject.mrFeedbackProps.hasOwnProperty("isFinalReview")&&PR.reviewKeysObject.mrFeedbackProps.isFinalReview&&(params.isFinalReview=!0),params}responseCallback(data,params,isOnlyData,isPageLoaded){PR.multiRater.constructMultiRaterDetails(data,params)}getIsViewTypeNeeded(){return!1}getViewTypeBasedOnPage(){return""}}var ModuleReview={formUtil:{postFormConstruction:()=>{const tableName=ZP5Form.getCurrFormsOperation().getTableName();if(ZP5Form.getFormClassObj().isAddMode()){if("P_SelfAppraisal"===tableName){if(ZP5Form.getFormClassObj().getFormsProperties().getIsPreviewForm())return!1;PR.util.constructEnabledComponents(ZP5Form),PR.util.setRatingFieldLockBasedonCycleConfiguration()}else if("P_Goals"===tableName&&ZP5Form.getFormClassObj().isAddMode()){const fieldHtml=ZP5Form.getFormClassObj().FIELD_LAYOUT;if(fieldHtml.find('[folabel="CREATEDATE"], [folabel="COMPLETEDDATE"]').parent().remove(),("performance/myteam/allgoals"===Layout.Page.currentmode||paCommonUtil.isTeamKraGoals()||"operations/performance/oprgoals/listview"===Layout.Page.currentmode)&&Goals.peersView.loadGoalEmployeeSelect(),AppraisalConfig.isKraGoals&&null!=Goals.KraVsGoals.selectKra){var fieldComponentID=fieldHtml.find('[name="KRA"]').attr("id");if(void 0!=fieldComponentID){var fcId=fieldComponentID.split("zp_field_")[1],fieldDetails=ZP5Form.Field.getFieldComponent(fcId);if("P_KRA"==fieldDetails.refTableName&&"KRA"==fieldDetails.labelName){var selectOption=fieldHtml.find("#"+fieldComponentID);if(ZPeopleComponents.select($(selectOption)).getOptions().length>1){const selctObj=ZPeopleComponents.select($(selectOption)).getOptions().find(obj=>obj.id===Goals.KraVsGoals.selectKra);var option={};option.id=Goals.KraVsGoals.selectKra,option.label=selctObj.label,option.text=selctObj.text,option.selected=!0,ZPeopleComponents.select($(selectOption)).setValue(option)}}}}}}else if(ZP5Form.getFormClassObj().isViewMode()){if("t_505460000000230233"==tableName||"t_145840000000341749"==tableName){let pageId=ZP5Form.getFormClassObj().LAYOUT;if(ZP5Form.getFormClassObj().isPermitted(ZP5Form.getFormClassObj().FormOperations.getEditPerm())){const editOpt=pageId.find("#zp_form_editin_singlerec");editOpt.removeClass("zpl_DNI"),editOpt.off(),editOpt.show().on("click",function(){ZP5Form.getFormClassObj().moduleHandler.getEditCallback()})}}else{const editOpt=(-1!=Layout.Page.hash.indexOf("#operations/performance/multirater")||-1!=Layout.Page.hash.indexOf("#operations/performance/employeesalary")||"#myspace"===settingsPage.tabId||"P_Goals"==tableName||"P_KRA_User"==tableName?ZP5Form.getFormClassObj().LAYOUT:PR.reviewKeysObject.LAYOUT.sliderDiv).find("#zp_form_editin_singlerec");let editoption=!1;if("P_SelfAppraisal"==tableName){const extraDetails=ZP5Form.getSingleRecord().record.extraDetails,isPermitted=ZP5Form.getFormClassObj().isPermitted(ZP5Form.getFormClassObj().FormOperations.getEditPerm());void 0!==extraDetails&&(isPermitted||ZP5Form.getFormClassObj().isDraftrec)&&(editoption=extraDetails.editoption),editoption||ZP5Form.getSingleRecord().record.isPACstGrpAdmin?(editOpt.removeClass("zpl_DNI"),editOpt.off(),editOpt.show().on("click",function(){ZP5Form.getFormClassObj().moduleHandler.getEditCallback()})):editOpt.hide().off("click"),-1!=Layout.Page.currentmode.indexOf("performance/appraisal/userlisting")&&editOpt.hide().off("click")}else"P_Goals"==tableName&&(ZP5Form.isApprovalEnabled(ZP5Form.getFormClassObj().getParams().formId)&&ZP5Form.isApprovalStarted(ZP5Form.getFormClassObj().getFormsProperties().getFormId(),ZP5Form.getFormClassObj().getFormsProperties().getRecordId())&&(ZP5Form.isApprover()||ZP5Form.getSingleRecord().record.isRecordApprover)||AppraisalConfig.GOALSHEETAPPROVER)&&!ZP5Form.getSingleRecord().record.isArchive?(editOpt.removeClass("zpl_DNI"),editOpt.off(),editOpt.show().on("click",function(){ZP5Form.getFormClassObj().moduleHandler.getEditCallback()})):"P_Goals"==tableName&&ZP5Form.getFormClassObj().isDraftrec&&editOpt.addClass("zpl_DNI");if("P_PerformanceAppraisal"==tableName&&void 0!=ZP5Form.getSingleRecord().record.extraDetails&&-1==Layout.Page.hash.indexOf("performance/myreview/selfappraisal-mode:revhistory")&&-1==Layout.Page.currentmode.indexOf("performance/appraisal/salaryhike")&&(editoption=ZP5Form.getSingleRecord().record.extraDetails.editoption,NewPASanmar.OTHERROLEUSERS=NewPASanmar.HR3ROLEUSER=NewPASanmar.PHROLEUSER=NewPASanmar.BMROLEUSER=NewPASanmar.FHROLEUSER=NewPASanmar.MDROLEUSER=NewPASanmar.HR2ROLEUSER=NewPASanmar.HR1ROLEUSER=NewPASanmar.RSMROLEUSER=NewPASanmar.LHROLEUSER=NewPASanmar.FDROLEUSER=NewPASanmar.PSMROLEUSER=!1,void 0!=ZP5Form.getSingleRecord().record.extraDetails.isSanmarRole&&NewPASanmar.setRolePermission(ZP5Form.getSingleRecord().record.extraDetails.isSanmarRole),editoption&&-1==Layout.Page.hash.indexOf("#operations/approvals/allapproval")&&-1==Layout.Page.hash.indexOf("#home/myspace/overview-approval")&&-1==Layout.Page.hash.indexOf("#performance/approval")?(editOpt.removeClass("zpl_DNI"),editOpt.off(),editOpt.show().on("click",function(){ZP5Form.getFormClassObj().moduleHandler.getEditCallback()})):editOpt.addClass("zpl_DNI").off("click")),"P_MultiRater"==tableName){editoption=!1;const extraDetails=ZP5Form.getSingleRecord().record.extraDetails;void 0!==extraDetails&&(editoption=extraDetails.editoption),editoption?(editOpt.removeClass("zpl_DNI"),editOpt.show().on("click",function(){ZP5Form.getFormClassObj().moduleHandler.getEditCallback()})):editOpt.hide().off("click"),(-1!=Layout.Page.currentmode.indexOf("performance/appraisal/userlisting")||paCommonUtil.isMultiRaterSelectionOperationPage())&&editOpt.hide().off("click")}"P_KRA_User"==tableName&&editOpt.hide().off("click")}"P_SelfAppraisal"!==tableName&&"P_MultiRater"!==tableName&&"P_PerformanceAppraisal"!==tableName||ModuleReview.formUtil.handleCBRecordView(tableName)}},processViewEditRecordDetails:()=>{var resultData=ZP5Form.getSingleRecord().record,params=ZP5Form.getFormClassObj().getRecordParams(),tableName=ZP5Form.getCurrFormsOperation().getTableName();if(!ZP5Form.getFormClassObj().PRINT&&("P_SelfAppraisal"===tableName||"P_MultiRater"===tableName||"P_PerformanceAppraisal"===tableName)){if("P_PerformanceAppraisal"===tableName&&(PR.reviewKeysObject.CYCLE_MONTH_DATA=void 0,void 0!=PR.reviewKeysObject.REVIEW_HEADER_DETAILS.approvalSendRec&&0!=PR.reviewKeysObject.REVIEW_HEADER_DETAILS.approvalSendRec||(Layout.Page.container.find("#zp_appproval_container").empty(),Layout.Page.container.find("#headerApprovalBtn").empty())),PR.util.showEnabledComponents(resultData,ZP5Form,params.configId,params.selUser,params.raterId),!isSanmarUI&&"P_MultiRater"===tableName){let pageId="#operations-performance-multirater-view"==settingsPage.tabId||"#operations-performance-employeesalary-view"===settingsPage.tabId?ZP5Form.getFormClassObj().LAYOUT:PR.reviewKeysObject.LAYOUT.sliderDiv;PR.util.showHideEditIcon(pageId,params)}"P_PerformanceAppraisal"==tableName&&null!=ZP5Form.getFormClassObj().getParams().copyRecordId&&PR.util.setPARatingHeader(),ZP5Form.getFormClassObj().isEditMode()&&PR.continuousReview.isCRBasedCycle()&&"P_PerformanceAppraisal"==tableName&&AppraisalConfig.isPARatingEnabled&&!PR.reviewKeysObject.isRecordSubmitted&&null!==PR.continuousReview.revPeriodData&&"SHOW_CFS"===PR.continuousReview.revPeriodData.MSG&&void 0!==PR.continuousReview.revPeriodData.assessorAvg&&void 0!==PR.continuousReview.revPeriodData.assessorAvg[params.selUser]&&PR.util.autopopulationRating(params.configId,PR.continuousReview.revPeriodData.assessorAvg[params.selUser],!0)}},loadParamsForSubmit:params=>{const tableName=ZP5Form.getCurrFormsOperation().getTableName();if("P_SelfAppraisal"===tableName&&null!=SelfAppr.util.SELFAPPRAISALADDCONFIGID&&void 0!=SelfAppr.util.SELFAPPRAISALADDCONFIGID&&(params.AppriasalConfiguration=SelfAppr.util.SELFAPPRAISALADDCONFIGID),"P_SelfAppraisal"===tableName||"P_MultiRater"===tableName||"P_PerformanceAppraisal"===tableName){if(isSanmarUI)"P_PerformanceAppraisal"===tableName?NewPASanmar.setPrdPAParam(params):"P_SelfAppraisal"===tableName&&NewPASanmar.setPrdSAParam(params);else{let additionalParams=PR.util.addUpdateRecord(params,ZP5Form.getFormClassObj().getParams().raterId);null!==additionalParams&&(params.moduleRating=JSON.stringify(additionalParams))}ZP5Form.getFormClassObj().isDraft?params.islocallysaved=!0:params.islocallysaved=!1}},togglePerfAppraisalActions:()=>{let tableName=ZP5Form.getCurrFormsOperation().getTableName(),formPageType=ZP5Form.getFormClassObj().FormOperations.getPaginationType(),container=PR.reviewKeysObject.LAYOUT.sliderDiv;"P_PerformanceAppraisal"===tableName&&(ZP5Form.getFormClassObj().isEditMode()&&void 0==ZP5Form.getFormClassObj().getParams().addmodclass&&container.find("#zp_forms_draft_btn").removeClass("zpl_DNI"),0===formPageType&&container.find("#zp_forms_next_btn").addClass("zpl_DNI"),container.find("#zp_forms_prev_btn").addClass("zpl_DNI"))},showError:function(id){1==ZP5Form.getCurrFormsOperation().getPaginationType()&&ZP5Form.getFieldLayout().find("#zp_section_fields_"+id).append('<div id="error_message" class="zp-err-msg DN">'+ZPI18N.getString("zp.entervalidrating")+"</div>")},handleCBRecordView:function(tableName){let custActAry=ZP5Form.getFormClassObj().getRecordDetails().record.message.customActions;const layout="P_Goals"==tableName||"P_EmployeeSalary"==tableName||"P_MultiRater"==tableName&&"#operations-performance-multirater-view"==settingsPage.tabId?ZP5Form.getFormClassObj().LAYOUT:PR.reviewKeysObject.LAYOUT.sliderDiv,headerId="P_Goals"==tableName||"P_EmployeeSalary"==tableName||"P_MultiRater"==tableName&&"#operations-performance-multirater-view"==settingsPage.tabId?"zp_form_header":"sliHdrDiv";ZPA_CusActOper.constructCBRecordView(ZP5Form.getFormClassObj().getFormsProperties().getRecordId(),custActAry,layout,headerId)},getNoValueString:function(value){return void 0!==value&&""!==value.trim()||(value="0"),value}}};