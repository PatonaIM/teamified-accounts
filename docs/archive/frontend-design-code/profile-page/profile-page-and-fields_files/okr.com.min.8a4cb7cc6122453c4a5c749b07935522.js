var OKRCommon={DATEERROR:!1,ISHAVINGRT:!1,PERIODDATE:{},FINANCIALYEAR:null,YEARSTART:0,GS_ADMINLIST:null,GS_ROLELIST:null,IS_SUPERADMIN:!1,GS_ADMIN_LIST_OPTIONS:null,admintgbtn:!1,setDateValue:function(dateVal,params,id,isobjt){let pageId=Layout.Page.container;var fromDate=null,toDate=null;if(OKRCommon.DATEERROR=!1,6===dateVal.split("-").length)fromDate=(date=dateVal.split("-"))[0]+"-"+date[1]+"-"+date[2],toDate=date[3]+"-"+date[4]+"-"+date[5];else if(2===dateVal.split("-").length){var date;fromDate=(date=dateVal.split("-"))[0],toDate=date[1]}var tdate="",fdate="";if(null!=fromDate&&(fdate=Calendar.parseDate(fromDate,uidateFormat)),null!=toDate&&(tdate=Calendar.parseDate(toDate,uidateFormat)),null==fromDate||0==OKRCommon.checkvalidDate(fromDate)?(pageId.find("#"+id).addClass("ztextbox__error"),pageId.find("#"+id).parent().after('<span id="error_msg" class="ztextbox--error__label">'+ZPI18N.getString("zp.appfromdateerror")+"</span>"),OKRCommon.DATEERROR=!0):null==toDate||0==OKRCommon.checkvalidDate(toDate)?(pageId.find("#"+id).addClass("ztextbox__error"),pageId.find("#"+id).parent().after('<span id="error_msg" class="ztextbox--error__label">'+ZPI18N.getString("zp.apptodateerror")+"</span>"),OKRCommon.DATEERROR=!0):tdate<fdate&&(pageId.find("#"+id).addClass("ztextbox__error"),pageId.find("#"+id).parent().after('<span id="error_msg" class="ztextbox--error__label">'+ZPI18N.getString("zp.fromDateIsGreater")+"</span>"),OKRCommon.DATEERROR=!0),!isobjt&&!OKRCommon.DATEERROR){var objfdate=Calendar.parseDate(KeyResult.OBJECTIVEFROMDATE,uidateFormat),objtdate=Calendar.parseDate(KeyResult.OBJECTIVETODATE,uidateFormat);(objfdate>fdate||objtdate<tdate)&&(pageId.find("#"+id).addClass("ztextbox__error"),pageId.find("#"+id).parent().after('<span id="error_msg" class="ztextbox--error__label">'+ZPI18N.getString("zp.keyObjDateerr")+"</span>"),OKRCommon.DATEERROR=!0)}return params.fromDate=fromDate,params.toDate=toDate,params},getCurrentDate:function(date){if(void 0==date){var currDate=new Date;date=currDate.getDate()+"/"+(currDate.getMonth()+1)+"/"+currDate.getFullYear()}return currDate=Calendar.parseDate(date,uidateFormat)},getPeriodCheck:function(sdate,edate){var currDate=OKRCommon.getCurrentDate();return sDate=Calendar.parseDate(sdate,uidateFormat),eDate=Calendar.parseDate(edate,uidateFormat),currDate.getTime()>=sDate.getTime()&&currDate.getTime()<=eDate.getTime()+86399999},checkvalidDate:function(chkdate){var ufmt=uidateFormat.match(/%./g),udate=chkdate.split(/\W+/),date=0,month=0,year=0;if(udate.length>3)return!1;for(var i=0;i<udate.length;i++)switch(ufmt[i]){case"%d":date=udate[i];break;case"%m":month=udate[i];break;case"%Y":case"%y":year=udate[i];break;case"%b":month=udate[i],Math.round(month)>0&&(month=-1);for(var j=0;j<Calendar.months.length;j++)month===Calendar.months[j]&&(month=j+1)}var valid=!0;return 0===date||date.match(/^([0-9]{1,2})$/i)||(valid=!1),month.toString().match(/^([0-9]{1,2})$/i)||(valid=!1),year.toString().match(/^([0-9]{2}|[0-9]{4})$/i)||(valid=!1),0!==date&&(date=Math.round(date)),month=Math.round(month),(year=Math.round(year))<100&&(year+=2e3),(month<1||month>12)&&(valid=!1),(date>Calendar.daysInMonth(year,month-1)||0==date)&&(valid=!1),valid},onNRKeyDown:function(val,evt){let charCode=evt.which?evt.which:evt.keyCode,value=val.value;return 8===charCode||9===charCode||37===charCode||39===charCode||!(charCode>31&&(charCode<48||charCode>57&&charCode<96||charCode>105))&&!(value.length>3)},getbackToMyObjective:function(){var pId=Layout.Page.container;pId.find("#okrsObjectiveview").toggleClass("zpl_DNI"),pId.find("#mainPage").toggleClass("zpl_DNI"),"TEAM"==Objective.OBJECTIVEPAGE&&$("#okrteamPro").toggleClass("DNI"),KeyResult.IS_KR_TAB&&(pId.find("#objThirdLevTab").toggleClass("zpl_DNI"),pId.find("#keyThirdLevTab").toggleClass("zpl_DNI"),pId.find("#okrsObjectiveviewLanding").toggleClass("zpl_DNI"),pId.find("#okrskeyLanding").toggleClass("zpl_DNI"),KeyResult.KR_IND_DATA=null,KeyResult.IS_SUBKEY=!1)},selectUserObject:function(userErecNo){let userDtl=ZPeople.getUserDetailsById(userErecNo),defaultOptn={};return defaultOptn.html=userDtl.empid+" "+userDtl.name,defaultOptn.text=ZPeople.decodeTxt(userDtl.empid)+" "+ZPeople.decodeTxt(userDtl.name),defaultOptn.id=userErecNo,defaultOptn.photo=userDtl.avatar,defaultOptn.zuid=userDtl.zuid,defaultOptn.empid=userDtl.empid,defaultOptn.decodedItemText=ZPeople.decodeTxt(userDtl.empid)+" "+ZPeople.decodeTxt(userDtl.name),defaultOptn},ajaxCall:{postCallType:function(isAsync,submitUrl,params,successFn){OKRCommon.getAjaxServerCall("POST",isAsync,submitUrl,params,successFn)},getCalltype:function(isAsync,submitUrl,params,successFn){OKRCommon.getAjaxServerCall("GET",isAsync,submitUrl,params,successFn)},putCallType:function(isAsync,submitUrl,params,successFn){OKRCommon.getAjaxServerCall("PUT",isAsync,submitUrl,params,successFn)},deleteCallType:function(isAsync,submitUrl,params,successFn){OKRCommon.getAjaxServerCall("DELETE",isAsync,submitUrl,params,successFn)}},getAjaxServerCall:function(actionType,isAsync,submitUrl,params,successFn){$.ajax({type:actionType,async:isAsync,url:submitUrl,data:params,success:successFn,headers:{"X-ZCSRF-TOKEN":csrfParamName+"="+csrfToken}})},iterateTokenFieldValues:function(arr){for(var idArr=[],i=0;i<arr.length;i++)idArr.push(arr[i].id);return idArr},getColorcls:function(clr){var result={};if("grnbglit"===clr)result.barclr="grnbg1",result.txtclr="grn";else if(-1!=["grybglit","grnbglit","redbglit","ylwbglit","blubglit"].indexOf(clr))result.txtclr=clr.slice(0,3),result.barclr=clr.slice(0,5);else{var clrcode=clr.slice(-1);result.txtclr=clrcode>0&&clrcode<=10?"zpl_seclrtxt"+clrcode:"zpl_seclrtxt1"+clrcode,result.barclr=clrcode>0&&clrcode<=10?"zpl_seclrdrkbg"+clrcode:"zpl_seclrdrkbg1"+clrcode}return result.handlerclr=clr,result},okrCommonGs:function(){OKRCommon.ajaxCall.getCalltype(!1,"/okrSettings/getGSInfo",{},OKRCommon.getGSInfoSuccessFn),OKRCommon.gettingStarted("startmonth_com")},okrSettingsGs:function(){OKRCommon.ajaxCall.getCalltype(!1,"/okrSettings/getGSInfo",{},OKRCommon.getGSInfoSuccessFn),OKRCommon.gettingStarted("startmonth_set")},getGSInfoSuccessFn:function(resultData){void 0!=resultData.adminList&&(OKRCommon.GS_ADMINLIST=resultData.adminList),void 0!=resultData.roleList&&(OKRCommon.GS_ROLELIST=resultData.roleList),void 0!=resultData.issuperAdmin&&(OKRCommon.IS_SUPERADMIN=resultData.issuperAdmin)},gettingStarted:function(id){var pageId=Layout.Page.container;ZPeopleComponents.isComponent(pageId.find("#"+id))&&ZPeopleComponents.select(pageId.find("#"+id)).destroy(),ZPeopleComponents.isComponent(pageId.find("#okradmins"))&&ZPeopleComponents.tokenfield(pageId.find("#okradmins")).destroy(),ZPeopleComponents.isComponent(pageId.find("#okrNonAdmin"))&&ZPeopleComponents.select(pageId.find("#okrNonAdmin")).destroy(),Layout.Page.pageContWrapper.find(".zpl_iwrprlft").remove(),pageId.html(""),pageId.append(OKRCommon.gettingStartedHtml(id)),ZPeopleComponents.select(pageId.find("#"+id)),pageId.find("#"+id).on("zselectchange",OKRCommon.monthchanged),OKRCommon.setGettingStartedEvent()},gettingStartedHtml:function(id){var btnName=OKRCommon.IS_SUPERADMIN?ZPI18N.getString("zp.next"):ZPI18N.getString("zp.gettingStarted"),monthopt="";$.each(Calendar.months,function(key,val){monthopt+='<option value="'+key+'">'+val+"</option>"});var roleoption="";null!=OKRCommon.GS_ROLELIST&&""!=OKRCommon.GS_ROLELIST&&$(OKRCommon.GS_ROLELIST).each(function(index,data){roleoption+='<option value="'+data.roleID+'">'+data.roleName+"</option>"}),OKRCommon.FINANCIALYEAR=Calendar.months[0]+"-"+Calendar.months[11];var html='<div class="zpl_container"> <div class="zpl_iwrpr"> <div class="zpl_iwrprrgt"> <div class="zpl_act"> <div class="zpl_mdlget"> <div class="zpl_mdlgetlft"> ';return html+='<div class="zpl_mdlgetlfthdr"> <div class="d-flexclm8"> <h1>'+ZPI18N.getString("zp.okrservice")+"</h1> <p>"+ZPI18N.getString("zp.okrserDesc")+"</div> </div> ",html+='<div class="zpl_mdlgetlftimg"> <img src="'+ZPeople.getResourceURL(hrImageUrl+"pms_gettingstarted.png")+'"> </div> </div>',html+=' <div class="zpl_mdlgetrgt">',html+='<div class="zpl_mdlgetcrd"> <div class="zpl_mdlgetcrdlst" id="page1"><div class="zpl_mdlgetcrdhdr"> <div class="bxcard-hdrlft"> <h5>'+ZPI18N.getString("zp.okrstInf")+"</h5></div> </div>",html+='<div class="zpl_mdlgetcrdcnt zpl_comp_gs"> <div class="zpl_crdlst"> <div class="zpl_catlst"> <span class="PI_objective icn zpl_objicnclr"></span> <div> <h5>'+ZPI18N.getString("zp.Onboarding.Objectives")+"</h5> <p>"+ZPI18N.getString("zp.okrdef")+'</p> </div> </div> <div class="zpl_catlst"> <span class="PI_kra icn zpl_keyicnclr"></span> <div> <h5>'+ZPI18N.getString("zp.keyResults")+"</h5> <p>"+ZPI18N.getString("zp.keyDef")+"</p> </div> </div> ",html+='<div class="zpl_mmnurgt">\n                        <div  tab-box="compWiz" class="zpl_act">\n                            <div class="zpl_gbox">\n                                <div class="d-flexclmcap">\n                                  <div class="d-flexcap  a-itm-cntr">\n                                    <i class="PI_monthly" style="font-size: 50px;"></i>\n                                    <div class="d-flexclmcap5 flex-dirC">\n                                        <h5>'+ZPI18N.getString("zp.secOkrPerd")+"</h5>\n                                        <p>"+ZPI18N.getString("zp.qtPerdDesc")+'</p>\n                                    </div>\n                                  </div>\n                                  <div class="zpl_secn">\n                                    <div class="d-flexcap a-itm-cntr">\n                                      <span class="w150">'+ZPI18N.getString("zp.startmonth")+'</span>\n                                      <div class="zpl_idiv">\n                                          <select id="'+id+'">'+monthopt+'</select>\n                                      </div>\n                                    </div>\n                                    <div  id="finyearInfo"> </div> </div> </div> </div></div></div> </div> </div> ',html+='<div class="zpl_mdlgetcrdfdr"><div></div><div class="zpl_mdlgetcrdfdrcnt"><button class="zlabel zlabel--blue zlabel--medium" id="nextOrGsBtn">'+btnName+"</button></div><div></div></div></div>",html+='<div class="zpl_mdlgetcrdlst zpl_DNI" id="page2"><div class="zpl_mdlgetcrdhdr"><div class="bxcard-hdrlft"> <h5>'+ZPI18N.getString("zp.okrstInf")+'</h5></div></div><div class="zpl_mdlgetcrdcnt"><div class="zpl_crdlst"><div class="zpl_gbox"><div><h4>'+ZPI18N.getString("zp.okradmin")+"</h4><p>"+ZPI18N.getString("zp.okrAdmindesc")+'</p></div><div class="zpl_crdcnt"><div class="zpl_secn"><div class="zpl_tgsprt"><h4 class="zpl_tgl"><input class="togBtn" id="admintgbtn">'+ZPI18N.getString("zp.moduleadmin")+"</h4><p>"+ZPI18N.getString("zp.OKRadmininfo")+'</p></div></div><div class="zpl_secn zpl_DNI" id="chooseOkrAdmin"><div><h4>'+ZPI18N.getString("zp.chooseokradmin")+'</h4></div><div><div class="w200"><textarea id="okradmins"></textarea></div></div></div><div class="zpl_secn zpl_DNI" id="roleSelect"><div><h4>'+ZPI18N.getString("zp.setOthRoleforadmin")+"</h4><p>"+ZPI18N.getString("zp.okrnonadmininfo")+'</p></div><div><div class="zpl_idiv w200"><select id="okrNonAdmin">'+roleoption+'</select></div></div></div></div></div></div></div><div class="zpl_mdlgetcrdfdr"><div class="zpl_mdlgetcrdfdrrgt"><button class="zlabel zlabel--blue zlabel--medium" id="previousbtn">'+ZPI18N.getString("zp.previous")+'</button></div><div class="zpl_mdlgetcrdfdrlft"><button class="zlabel zlabel--blue zlabel--medium" id="okrgettingStartedbtn">'+ZPI18N.getString("zp.setupokr")+"</button></div></div></div>"},setGettingStartedEvent:function(){var pageId=Layout.Page.container;pageId.find("#nextOrGsBtn").on("click",function(){var param={};OKRCommon.IS_SUPERADMIN?(pageId.find("#page1").addClass("zpl_DNI"),pageId.find("#page2").removeClass("zpl_DNI"),ZPeopleComponents.toggleswitch(pageId.find("#admintgbtn")).setAttributes({on:OKRCommon.admintgbtn,change:OKRCommon.adminchange})):(param.stmonth=OKRCommon.YEARSTART,OKRCommon.ajaxCall.postCallType(!0,"/okrSettings/getstarted",param,OKRCommon.okrGetStarted))}),pageId.find("#previousbtn").on("click",function(){OKRCommon.admintgbtn=ZPeopleComponents.toggleswitch(pageId.find("#admintgbtn")).getState(),pageId.find("#page1").removeClass("zpl_DNI"),pageId.find("#page2").addClass("zpl_DNI")}),pageId.find("#okrgettingStartedbtn").on("click",function(){var param={},isEnabled=ZPeopleComponents.toggleswitch(pageId.find("#admintgbtn")).getState();if(isEnabled){var selectedAdminVal=ZPeopleComponents.tokenfield(pageId.find("#okradmins")).getAllValues();if(0==selectedAdminVal.length)return void pageId.find("#okradmins").addClass("ztextbox__error");var selectedAdminList=[];for(var i in selectedAdminVal)selectedAdminList.push(selectedAdminVal[i].id);selectedRoleId=ZPeopleComponents.select(pageId.find("#okrNonAdmin")).getValue(),param.selectedAdminList=JSON.stringify(selectedAdminList),param.selectedRoleId=selectedRoleId}param.isCustomAdminEnable=isEnabled,param.stmonth=OKRCommon.YEARSTART,OKRCommon.ajaxCall.postCallType(!1,"/okrSettings/getstarted",param,OKRCommon.okrGetStarted)})},adminchange:function(event){var pageId=Layout.Page.container;if(event.detail.state){if(pageId.find("#chooseOkrAdmin").removeClass("zpl_DNI"),pageId.find("#roleSelect").removeClass("zpl_DNI"),null!=OKRCommon.GS_ADMINLIST){var tokenObj={},adminlist=OKRCommon.getAdminOption();tokenObj.data=adminlist,tokenObj.contentType="text",tokenObj.dataMapping={value:"id",text:"name",id:"id",informativeText:"name",titleText:"name"},tokenObj.search={by:"name"},tokenObj.allowDuplicateValues=!1,tokenObj.dropdownList={itemType:"checkbox"},tokenObj.placeholder=ZPI18N.getString("zp.selokrdmin"),ZPeopleComponents.tokenfield(pageId.find("#okradmins"),tokenObj)}ZPeopleComponents.select(pageId.find("#okrNonAdmin"))}else pageId.find("#chooseOkrAdmin").addClass("zpl_DNI"),pageId.find("#roleSelect").addClass("zpl_DNI")},getAdminOption:function(){return null!==OKRCommon.GS_ADMIN_LIST_OPTIONS&&""!==OKRSettings.GS_ADMIN_LIST_OPTIONS||(OKRCommon.GS_ADMIN_LIST_OPTIONS=[],$.each(OKRCommon.GS_ADMINLIST,function(index,data){var Obj={};Obj.name=ZPeople.decodeTxt(data.EMPNAME),Obj.id=data.ERECNO,OKRCommon.GS_ADMIN_LIST_OPTIONS.push(Obj)})),OKRCommon.GS_ADMIN_LIST_OPTIONS},monthchanged:function(event){var endmonth,data=event.detail,pageId=Layout.Page.container,selectedmonth=parseInt(data.value);endmonth=0==selectedmonth?Calendar.months[11]:Calendar.months[selectedmonth-1],OKRCommon.YEARSTART=selectedmonth,OKRCommon.FINANCIALYEAR=Calendar.months[selectedmonth]+"-"+endmonth;var html=' <span class="w150">'+ZPI18N.getString("zp.okrCycPerd")+OKRCommon.FINANCIALYEAR+"</span>";pageId.find("#finyearInfo").addClass("zpl_info"),pageId.find("#finyearInfo").html(""),pageId.find("#finyearInfo").append(html)},setObjectiveYearPeriod:function(id,OKR_MONTH){let pageId=Layout.Page.container;curmonth<OKR_MONTH?(this.fromdate=new Date(curyear-1,OKR_MONTH),this.fromdate.setDate(1),this.todate=new Date(curyear,OKR_MONTH-1),this.todate.setDate(new Date(curyear,OKR_MONTH,0).getDate())):(this.fromdate=new Date(curyear,OKR_MONTH),this.fromdate.setDate(1),Objective.OKR_MONTH>0?(this.todate=new Date(curyear+1,OKR_MONTH-1),this.todate.setDate(new Date(curyear+1,OKR_MONTH,0).getDate())):(this.todate=new Date(curyear,11),this.todate.setDate(new Date(curyear,12,0).getDate()))),OKRCommon.PERIODDATE={from:this.fromdate,to:this.todate};var displayText=Calendar.formatDate(this.fromdate)+" - "+Calendar.formatDate(this.todate);pageId.find("#"+id).html(displayText)},getPreviousYear:function(id,OKR_MONTH){let pageId=Layout.Page.container;var tmpDate=OKRCommon.PERIODDATE;void 0!==tmpDate&&(this.yeartodate=tmpDate.to,this.yearfromdate=tmpDate.from,this.fromTmpYear=this.yearfromdate.getFullYear(),this.toTmpYear=this.yeartodate.getFullYear()),this.fromTmpYear=this.fromTmpYear-1,this.toTmpYear=this.toTmpYear-1,this.toTmpMonth=OKR_MONTH>0?OKR_MONTH-1:11,this.fromdate=new Date(this.fromTmpYear,OKR_MONTH),this.todate=new Date(this.toTmpYear,this.toTmpMonth),this.todate.setDate(new Date(this.toTmpYear,this.toTmpMonth+1,0).getDate()),OKRCommon.PERIODDATE={from:this.fromdate,to:this.todate};var displayText=Calendar.formatDate(this.fromdate)+" - "+Calendar.formatDate(this.todate);pageId.find("#"+id).html(displayText)},getNextYear:function(id,OKR_MONTH){let pageId=Layout.Page.container;var tmpDate=OKRCommon.PERIODDATE;void 0!==tmpDate&&(this.yeartodate=tmpDate.to,this.yearfromdate=tmpDate.from,this.fromTmpYear=this.yearfromdate.getFullYear(),this.toTmpYear=this.yeartodate.getFullYear()),this.fromTmpYear=this.fromTmpYear+1,this.toTmpYear=this.toTmpYear+1,this.toTmpMonth=OKR_MONTH>0?OKR_MONTH-1:11,this.fromdate=new Date(this.fromTmpYear,OKR_MONTH),this.todate=new Date(this.toTmpYear,this.toTmpMonth),this.todate.setDate(new Date(this.toTmpYear,this.toTmpMonth+1,0).getDate()),OKRCommon.PERIODDATE={from:this.fromdate,to:this.todate};var displayText=Calendar.formatDate(this.fromdate)+" - "+Calendar.formatDate(this.todate);pageId.find("#"+id).html(displayText)},setObjectivePeriod:function(){var nxtMon=0,stmont=0;if(curmonth==Objective.OKR_MONTH)stmont=curmonth,nxtMon=curmonth+2;else if(curmonth<Objective.OKR_MONTH){for(var i=Objective.OKR_MONTH-1;i>=0;i-=3)if(nxtMon=i-2,i==curmonth||nxtMon==curmonth||i<curmonth>nxtMon){nxtMon<0?(stmont=12+nxtMon,nxtMon=i):(stmont=nxtMon,nxtMon=i);break}}else if(curmonth>Objective.OKR_MONTH)for(i=Objective.OKR_MONTH;i<=11;i+=3)if(nxtMon=i+2,i==curmonth||nxtMon==curmonth||i<curmonth<nxtMon){stmont=i;break}OKRCommon.getCurrentPeriod(stmont,nxtMon)},getCurrentPeriod:function(stmont,nxtMon){let pageId=Layout.Page.container;this.fromdate=stmont>nxtMon?new Date(curyear-1,stmont):new Date(curyear,stmont),this.fromdate.setDate(1),nxtMon>11?(this.todate=new Date(curyear+1,nxtMon-11),this.todate.setDate(new Date(curyear+1,nxtMon-10,0).getDate())):(this.todate=new Date(curyear,nxtMon),this.todate.setDate(new Date(curyear,nxtMon+1,0).getDate())),OKRCommon.PERIODDATE={from:this.fromdate,to:this.todate};var displayText=Calendar.formatDate(this.fromdate)+" - "+Calendar.formatDate(this.todate);pageId.find("#peridDet").html(displayText)},getNextQuarter:function(){let pageId=Layout.Page.container;var tmpDate=OKRCommon.PERIODDATE;void 0!==tmpDate.from&&(this.fromdate=tmpDate.from,this.tmpMonth=this.fromdate.getMonth(),this.tmpYear=this.fromdate.getFullYear()),this.tmpMonth=this.tmpMonth+3,this.tmpMonth>11&&(this.tmpMonth=this.tmpMonth-12,this.tmpYear=this.tmpYear+1),this.fromdate=new Date(this.tmpYear,this.tmpMonth),this.fromdate.setDate(1),void 0!==tmpDate.to&&(this.todate=tmpDate.to,this.tmpMonth=this.todate.getMonth(),this.tmpYear=this.todate.getFullYear()),this.tmpMonth=this.tmpMonth+3,this.tmpMonth>11&&(this.tmpMonth=this.tmpMonth-12,this.tmpYear=this.tmpYear+1),this.todate=new Date(this.tmpYear,this.tmpMonth),this.todate.setDate(new Date(this.tmpYear,this.tmpMonth+1,0).getDate()),OKRCommon.PERIODDATE={from:this.fromdate,to:this.todate};var displayText=Calendar.formatDate(this.fromdate)+" - "+Calendar.formatDate(this.todate);pageId.find("#peridDet").html(displayText)},getPreviousQuarter:function(){let pageId=Layout.Page.container;var tmpDate=OKRCommon.PERIODDATE;void 0!==tmpDate.from&&(this.fromdate=tmpDate.from,this.tmpMonth=this.fromdate.getMonth(),this.tmpYear=this.fromdate.getFullYear()),this.tmpMonth=this.tmpMonth-3,this.tmpMonth<0&&(this.tmpMonth=this.tmpMonth+12,this.tmpYear=this.tmpYear-1),this.fromdate=new Date(this.tmpYear,this.tmpMonth),this.fromdate.setDate(1),void 0!==tmpDate.to&&(this.todate=tmpDate.to,this.tmpMonth=this.todate.getMonth(),this.tmpYear=this.todate.getFullYear()),this.tmpMonth=this.tmpMonth-3,this.tmpMonth<0&&(this.tmpMonth=this.tmpMonth+12,this.tmpYear=this.tmpYear-1),this.todate=new Date(this.tmpYear,this.tmpMonth),this.todate.setDate(new Date(this.tmpYear,this.tmpMonth+1,0).getDate()),OKRCommon.PERIODDATE={from:this.fromdate,to:this.todate};var displayText=Calendar.formatDate(this.fromdate)+" - "+Calendar.formatDate(this.todate);return pageId.find("#peridDet").html(displayText),{from:this.monthfromdate,to:this.monthtodate}},okrGetStarted:function(resultdata){if("success"==resultdata.msg){var isadmin=resultdata.isAdmin;window.location.href=isadmin?"#settings/service/okr/configuration":"#okr/dashboard",location.reload()}},convertOldUrl:function(){if(void 0!=Layout.Page.urlparam.subkeyId){let redirectUrl=Layout.Page.hash.replace("subkeyId","keyId");return{isValid:!0,redirectToURL:redirectUrl=redirectUrl.replace("#","")}}},setDefDateForReports:function(OKR_MONTH,id,mode,requestcallType){var pId=Layout.Page.container;OKRCommon.setObjectiveYearPeriod(OKR_MONTH),pId.find("#perQut").off("click").on("click",function(){OKRCommon.getPreviousYear(OKR_MONTH),ZPLite.Firescroll.reset(pId.find("#"+id),mode),requestcallType.generateReports()}),pId.find("#nxtQut").off("click").on("click",function(){OKRCommon.getNextYear(OKR_MONTH),ZPLite.Firescroll.reset(pId.find("#"+id),mode),requestcallType.generateReports()})}};class NODATAMessage{static setNoData(container,options){let htmlContent='<div id="emptPage" class="'+(options.isDisplayAsNonCrd?"":"zpl_crd")+' wd100_per"><div class="zpl_Emptydata"><div><div class="zpl_emptimg '+options.className+'"></div>';options.text&&(htmlContent+="<h4>"+options.text+"</h4>"),options.subText&&(htmlContent+="<p>"+options.subText+"</p>"),options.buttonText&&(htmlContent+='<font><button class="zlabel zlabel--blue zlabel--medium" title="'+options.buttonText+'"><span class="zpl_ellipsis200">'+options.buttonText+"</span></button></font>"),htmlContent+="</div></div></div></div>",options.isAppend?container.append(htmlContent):container.html(htmlContent),"function"==typeof options.buttonCallback&&container.find("button").on("click",options.buttonCallback)}}var OKRApproval={APPOBJTID:null,STARTINDEX:1,STATUS:-1,initObjectApprovalPage:function(){var pageId=Layout.Page.container,divht='<div class="zpl_container"><div class="zpl_iwrpr"><div class="zpl_iwrprrgt"><div class="zpl_act zpl_tblfxd" id="filterDiv"><div class="zpl_btnmnu">';divht+='</div><div class="zpl_fltrvw DNI" id="okrApprovalFilter"><div><ul class="zpl_fltrvwlst" id="okrFilSelList"></ul></div><div class="d-flexcap MLauto"><a id="okrFilClr" class="zpl_link" onclick="OKRApproval.getResetOptn()">'+ZPI18N.getString("zp.files.reset")+"</a></div></div>",divht+='<div class="zpl_rgtcnt"><div id="okrApproval" class="zpl_msplst"></div></div></div></div></div>',pageId.append(divht),OKRApproval.constructFilterOpt()},getMyApproval:function(){let pageId=Layout.Page.container;pageId.find("#emptPage").remove(),pageId.find("#okrApproval").html("");let params={sIndx:1,status:OKRApproval.STATUS};Layout.Page.hash.split("-").length>=2&&ApprovalList.approvalAction(),OKRCommon.ajaxCall.getCalltype(!0,"/okrCommon/getMyApproval",params,OKRApproval.myApprovalSuccesFn)},fireScrollCallback:function(){settingsPage.fireScrollObj.hasOwnProperty("okrApprovalFireSc")&&(settingsPage.fireScrollObj.okrApprovalFireSc.reset(),delete settingsPage.fireScrollObj.okrApprovalFireSc);let params={sIndx:OKRApproval.STARTINDEX,status:OKRApproval.STATUS};OKRCommon.ajaxCall.getCalltype(!0,"/okrCommon/getMyApproval",params,OKRApproval.myApprovalSuccesFn)},myApprovalSuccesFn:function(resultData){let pageId=Layout.Page.container.find("#okrApproval"),approvalCards="";if(void 0!=resultData&&0!=resultData.length){if(OKRApproval.STARTFIRESCROLL=!(resultData.length<=20),$.each(resultData,function(index,data){let approvalAction=data.approvalAction,isNotButton=!0,statusTypeHtml="",btnText="",btnClass="",recordOwnerName=ZPeople.CURR_USER.usererec===data.recordOwnerErecno?ZPeople.CURR_USER.name:data.recordOwnerName;data.approvalStatus===zpconst.ApprovalStatus.Pending||data.approvalStatus===zpconst.ApprovalStatus.CancellationPending?(btnText=1==approvalAction?ZPI18N.getString("zp.extenddecline"):ZPI18N.getString("zp.clicktoapprovereject"),btnClass=data.recordImmutable?"disabled":"",isNotButton=!1,statusTypeHtml=ApprovalList.getStatusTypeHtml(btnText,btnClass,isNotButton)):1===data.approvalStatus||3===data.approvalStatus?statusTypeHtml=ApprovalList.getStatusTypeHtml(ZPI18N.getString("zp.approvedmessage",new Array(data.approveRejectTime)),btnClass,isNotButton):0===data.approvalStatus?statusTypeHtml=ApprovalList.getStatusTypeHtml(ZPI18N.getString("zp.rejectedmessage",new Array(data.approveRejectTime)),btnClass,isNotButton):data.approvalStatus===zpconst.ApprovalStatus.Cancelled&&(statusTypeHtml=ApprovalList.getStatusTypeHtml(ZPI18N.getString("zp.approvalmessage",new Array("red",ZPI18N.getString("zp.cancelled"),data.approveRejectTime)),btnClass,isNotButton));let reqMsg="";reqMsg=1==data.approvalAction?ZPI18N.getString("zp.hasmadecancelreq"):ZPI18N.getString("zp.hasmadereq");let cardHtml='<div name="approval_card" id="'+data.recordId+'" formId="'+data.formId+'" formDisplayName="'+data.formName+'" tableName="'+data.tableName+'" status="'+data.approvalStatus+'" recordOwnerErecno="'+data.recordOwnerErecno+'">'+ApprovalList.getApprReqDtlHtml(data.employeePhotoUrl,data.recordOwnerEmpId,recordOwnerName,data.formName,reqMsg,data.recordOwnerZUID)+ApprovalList.MySpace.getRaisedOnHtml(data)+statusTypeHtml+"</div>";approvalCards+=cardHtml}),pageId.append(approvalCards),settingsPage.fireScrollObj.hasOwnProperty("okrApprovalFireSc")&&(settingsPage.fireScrollObj.okrApprovalFireSc.reset(),delete settingsPage.fireScrollObj.okrApprovalFireSc),OKRApproval.STARTFIRESCROLL)new FireScrollBack(OKRApproval.fireScrollCallback,pageId.parent().parent(),"okrApprovalFireSc");OKRApproval.STARTINDEX+=resultData.length,pageId.find('[name="approval_card"]').unbind(),pageId.find('[name="approval_card"]').on("click",function(){OKRApproval.openAprovalPage(this)})}else 1==OKRApproval.STARTINDEX&&NODATAMessage.setNoData(Layout.Page.container.find("#okrApproval"),{text:ZPI18N.getString("zp.norec"),className:"zp_nd_nodata",isAppend:!0})},openAprovalPage:function(obj){let datarow=$(obj).closest("[name=approval_card]"),formId=datarow.attr("formId"),recordId=datarow.attr("id"),tableName=datarow.attr("tableName");OKRApproval.APPOBJTID=recordId,ApprovalList.loadApprovalRecord(formId,recordId,tableName)},constructFilterOpt:function(){var pageId=Layout.Page.container;void 0!=pageId.find("#statusFilter").html()&&(ZPeopleComponents.select(pageId.find("#statusFilter")).destroy(),pageId.find("#appFilterCont").remove(),pageId.find("#appFilter").parent().remove()),pageId.find("#okrFilSelList").html(""),pageId.find("#okrApprovalFilter").addClass("DNI"),OKRApproval.STATUS=-1,OKRApproval.STARTINDEX=1;var html='<div class="zpl_fltr" id="appFilterCont"><div><div class="zpl_fltrhd"><h5>'+ZPI18N.getString("zp.filter")+'</h5><i class="PI_cls" id="fltr_cls"  title="'+ZPI18N.getString("zp.close")+'"></i></div></div>';html+='<div class="zpl_fltrcnt"><div class="zpl_fltrlst">',html+='<div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.status")+'</label></div><div><select id="statusFilter"></select></div></div></div></div>',html+='<div><button id="searchFilter" type="button" class="zlabel zlabel--blue zlabel--medium" onclick="OKRApproval.getApprovalByFilter()">'+ZPI18N.getString("zp.apply")+'</button><button type="button" class="zlabel zlabel--outline zlabel--medium" onclick="OKRApproval.getResetOptn()">'+ZPI18N.getString("zp.reset")+"</button></div></div>",pageId.find("#filterDiv").append(html),html='<div class="zpl_rgt"><i class="zpl_ibg PI_fltr" title="Filter" id="approvFilter"></i></div>',pageId.find("#filterDiv .zpl_btnmnu").append(html);let _confselObj={},optnDtl=OKRApproval.getOptionsForStatus();OKRApproval.setConstructionForFilter(_confselObj,optnDtl),ZPeopleComponents.select(pageId.find("#statusFilter"),_confselObj),ZPeopleComponents.select("#statusFilter").setValue(-1),pageId.find("#approvFilter,#fltr_cls").on("click",function(){$("#filterDiv").hasClass("zpl_fltr_flt")?$("#filterDiv").removeClass("zpl_fltr_flt"):$("#filterDiv").addClass("zpl_fltr_flt")})},getOptionsForStatus:function(){var apprStatus=[];return apprStatus.push({id:-3,value:ZPI18N.getString("zp.allstatus")}),apprStatus.push({id:-1,value:ZPI18N.getString("zp.pending")}),apprStatus.push({id:1,value:ZPI18N.getString("zp.approved")}),apprStatus.push({id:0,value:ZPI18N.getString("zp.rejected")}),apprStatus},setConstructionForFilter:function(_confselObj,optn){_confselObj.options=optn,_confselObj.lazyLoading=!0,_confselObj.showSearchField=!0,_confselObj.randomDropdownListId=!0,_confselObj.dropdownList={height:"260"},_confselObj.dropdownList.closeOnScroll=!0,_confselObj.dropdownList.fitForElement=!0,_confselObj.messages={noResults:ZPI18N.getString("zp.noresults")},_confselObj.dataMapping={label:"value",value:"id"},_confselObj.removeExistingDropdown=!0},getApprovalByFilter:function(){var pageId=Layout.Page.container;pageId.find("#okrApproval").html(""),OKRApproval.STATUS=pageId.find("#statusFilter").val(),OKRApproval.STARTINDEX=1,OKRApproval.getMyApproval();var html="";if(-1!=OKRApproval.STATUS&&void 0===pageId.find("#filterTypeClose").parent().html()){var optnName=ZPeopleComponents.select("#statusFilter")._optDatas[0].label;html+='<li name="BreadCrumbElement" fieldObj=\''+JSON.stringify({filterElementId:"statusFilter"})+"'><label>"+ZPI18N.getString("zp.status")+" : </label><span title="+optnName+">"+optnName+"</span>",html+='<a id="filterTypeClose" class="PI_cls" title="Remove" onclick="OKRApproval.getResetSingleData(this)"></a></li>'}""!=html?(pageId.find("#okrFilSelList").append(html),pageId.find("#okrApprovalFilter").removeClass("DNI"),pageId.find('#okrFilSelList [name="BreadCrumbElement"]').on("click",function(){OKRApproval.onClickHighlights(this)})):-1==OKRApproval.STATUS&&pageId.find("#okrApprovalFilter").addClass("DNI")},getResetOptn:function(){ZPeopleComponents.select("#statusFilter").setValue({id:-1,value:ZPI18N.getString("zp.pending")}),Layout.Page.container.find("#okrFilSelList").html(""),Layout.Page.container.find("#okrApprovalFilter").addClass("DNI"),OKRApproval.getApprovalByFilter(),$("#filterDiv").removeClass("zpl_fltr_flt")},getResetSingleData:function(optn,obj){$(obj).parent().remove(),ZPeopleComponents.select("#statusFilter").setValue({id:-1,value:ZPI18N.getString("zp.pending")}),OKRApproval.getApprovalByFilter(),$("#filterDiv").removeClass("zpl_fltr_flt")},onClickHighlights:function(brdCumbObj){var pageId=Layout.Page.container;pageId.find("#filterDiv").addClass("zpl_fltr_flt");let filterElementObj=JSON.parse($(brdCumbObj).attr("fieldObj"));ZPeopleComponents.select(pageId.find("#"+filterElementObj.filterElementId)).open()},setCallBackForTheUpdatedStatus:function(){$("#zp_appproval_comment_btn").on("click",function(){OKRApproval.setCallBackForTheUpdatedStatus()}),$('[name="approvalBtn"], #zp_appproval_confirm_btn').on("click",function(){var statusId=$(this).attr("approvaltype");ApprovalList.MySpace.updateApprovalCard(OKRApproval.APPOBJTID,parseInt(statusId))})},openObjectiveApproval:function(recId){OKRApproval.APPOBJTID=recId;let param={objectiveId:recId};OKRCommon.ajaxCall.getCalltype(!1,"/okrCommon/getIndObjtDetails",param,OKRApproval.constructApprovalDiv)},openCheckInApproval:function(recId){OKRApproval.APPOBJTID=recId;let param={checkInid:recId};OKRCommon.ajaxCall.getCalltype(!1,"/okrCommon/getApprCheckInDetails",param,OKRApproval.constructCheckInApproval)},openObjectiveAlignApproval:function(recId){OKRApproval.APPOBJTID=recId;let param={alignId:recId};OKRCommon.ajaxCall.getCalltype(!1,"/okrCommon/getApprObjAlignDetails",param,OKRApproval.constructObjAlignApproval)},constructApprovalDiv:function(resultData){if(void 0!=resultData.objective){let sliderDiv=OKRApproval.constructCommonOKRApproval("objectiveApprove","objectiveApproveBody");sliderDiv.find(".zpl_mfoter").empty(),$('<span class="zpl_mhderrgt"><div id="headerApprovalBtn"></div></span>').insertBefore(sliderDiv.find("#sliderCls")),OKRApproval.setApprovalBottomDetails(),OKRApproval.isPrimaryAppr=resultData.approvalDetails.isPrimaryAppr,OPApprovals.Common.RecordOwner.setOwner(OKRApproval.APPOBJTID,resultData.approvalDetails.recOwner),OPApprovals.Common.RecordOwner.setAddedBy(OKRApproval.APPOBJTID,resultData.approvalDetails.recOwner),OKRApproval.apprParam=new ApprovalParam(resultData.approvalDetails.formId,OKRApproval.APPOBJTID,resultData.approvalDetails.tableName,resultData.approvalDetails.currentApprovalStatus,!1),OKRApproval.layoutParam=new LayoutParam(sliderDiv,sliderDiv.find(".zpl_mhder"),sliderDiv.find(".MRauto"),"objectiveApprove"),new ApprovalRecordHeader(OKRApproval.apprParam,OKRApproval.layoutParam,{isRecordApprover:resultData.approvalDetails.isRecordApprover,isPrimaryApprover:OKRApproval.isPrimaryAppr}).show(),sliderDiv.find("#objectiveApproveBody").data({appParam:OKRApproval.apprParam,layoutParam:OKRApproval.layoutParam}),sliderDiv.find("#sliHdrDiv h4").html("");let isConstructFooter=!0;isConstructFooter=isConstructFooter?resultData.approvalDetails.isPrimaryAppr:isConstructFooter,OKRApprovalBootom.setApprovalSettingsDetails(resultData.approvalDetails.approvalSettingsDetails);let footerHtml=OKRApprovalBootom.getFooterHtml(resultData.approvalDetails.currentApprovalStatus,isConstructFooter);sliderDiv.find("#sliFootDiv").html(footerHtml),OKRApprovalBootom.setFooterCallBack(),sliderDiv.find("#objectiveApproveBody").html('<div class="zpl_crd "><div class="zpl_crdhdr"><div><h4 elem="secTitle"><span>'+ZPI18N.getString("zp.objDetails")+'</span></h4></div></div><div class="zpl_crdcnt"><div class="zpl_frmclm zpl_frmclmview" id="objectiveDet"></div></div></div>'),OKRApproval.constructObjTDetails(resultData),"#okr/approval"===Layout.Page.hash&&OKRApproval.setCallBackForTheUpdatedStatus()}},constructCheckInApproval:function(resultData){if(void 0!=resultData.keyName){let sliderDiv=OKRApproval.constructCommonOKRApproval("checkInApproval","checkInApprovalBody");sliderDiv.find(".zpl_mfoter").empty(),$('<span class="zpl_mhderrgt"><div id="headerApprovalBtn"></div></span>').insertBefore(sliderDiv.find("#sliderCls")),OKRApprovalBootom.setApprovalTabelName("P_KeyResult_CheckIn"),OKRApprovalBootom.modalBodyId="#checkInApprovalBody",OKRApproval.modelBox.sliderDiv.find("#sliFootDiv").addClass("d-flexclmcap"),OKRApproval.isPrimaryAppr=resultData.approvalDetails.isPrimaryAppr,OPApprovals.Common.RecordOwner.setOwner(OKRApproval.APPOBJTID,resultData.approvalDetails.recOwner),OPApprovals.Common.RecordOwner.setAddedBy(OKRApproval.APPOBJTID,resultData.approvalDetails.recOwner),OKRApproval.apprParam=new ApprovalParam(resultData.approvalDetails.formId,OKRApproval.APPOBJTID,resultData.approvalDetails.tableName,resultData.approvalDetails.currentApprovalStatus,!1),OKRApproval.layoutParam=new LayoutParam(sliderDiv,sliderDiv.find(".zpl_mhder"),sliderDiv.find(".MRauto"),"checkInApproval"),new ApprovalRecordHeader(OKRApproval.apprParam,OKRApproval.layoutParam,{isRecordApprover:resultData.approvalDetails.isRecordApprover,isPrimaryApprover:OKRApproval.isPrimaryAppr}).show(),sliderDiv.find("#checkInApprovalBody").data({appParam:OKRApproval.apprParam,layoutParam:OKRApproval.layoutParam}),sliderDiv.find("#sliHdrDiv h4").html("");let isConstructFooter=!0;isConstructFooter=isConstructFooter?resultData.approvalDetails.isPrimaryAppr:isConstructFooter,OKRApprovalBootom.setApprovalSettingsDetails(resultData.approvalDetails.approvalSettingsDetails);let footerHtml=OKRApprovalBootom.getFooterHtml(resultData.approvalDetails.currentApprovalStatus,isConstructFooter);sliderDiv.find("#sliFootDiv").html(footerHtml),OKRApprovalBootom.setFooterCallBack(),sliderDiv.find("#checkInApprovalBody").html('<div class="zpl_crd "><div class="zpl_crdhdr"><div><h4 elem="secTitle"><span>'+ZPI18N.getString("zp.keyChkDtls")+'</span></h4></div></div><div class="zpl_crdcnt"><div class="zpl_frmclm zpl_frmclmview" id="checkInDet"></div></div></div>'),OKRApproval.constructKeyDetails(resultData),"#okr/approval"===Layout.Page.hash&&OKRApproval.setCallBackForTheUpdatedStatus()}},constructObjAlignApproval:function(resultData){if(void 0!=resultData.parObjName){let sliderDiv=OKRApproval.constructCommonOKRApproval("alignObjApproval","alignObjApprovalBody");sliderDiv.find(".zpl_mfoter").empty(),$('<span class="zpl_mhderrgt"><div id="headerApprovalBtn"></div></span>').insertBefore(sliderDiv.find("#sliderCls")),OKRApprovalBootom.setApprovalTabelName("P_ObjectiveAlign"),OKRApprovalBootom.modalBodyId="#alignObjApprovalBody",OKRApproval.modelBox.sliderDiv.find("#sliFootDiv").addClass("d-flexclmcap"),OKRApproval.isPrimaryAppr=resultData.approvalDetails.isPrimaryAppr,OPApprovals.Common.RecordOwner.setOwner(OKRApproval.APPOBJTID,resultData.approvalDetails.recOwner),OPApprovals.Common.RecordOwner.setAddedBy(OKRApproval.APPOBJTID,resultData.approvalDetails.recOwner),OKRApproval.apprParam=new ApprovalParam(resultData.approvalDetails.formId,OKRApproval.APPOBJTID,resultData.approvalDetails.tableName,resultData.approvalDetails.currentApprovalStatus,!1),OKRApproval.layoutParam=new LayoutParam(sliderDiv,sliderDiv.find(".zpl_mhder"),sliderDiv.find(".MRauto"),"alignObjApproval"),new ApprovalRecordHeader(OKRApproval.apprParam,OKRApproval.layoutParam,{isRecordApprover:resultData.approvalDetails.isRecordApprover,isPrimaryApprover:OKRApproval.isPrimaryAppr}).show(),sliderDiv.find("#alignObjApprovalBody").data({appParam:OKRApproval.apprParam,layoutParam:OKRApproval.layoutParam}),sliderDiv.find("#sliHdrDiv h4").html("");let isConstructFooter=!0;isConstructFooter=isConstructFooter?resultData.approvalDetails.isPrimaryAppr:isConstructFooter,OKRApprovalBootom.setApprovalSettingsDetails(resultData.approvalDetails.approvalSettingsDetails);let footerHtml=OKRApprovalBootom.getFooterHtml(resultData.approvalDetails.currentApprovalStatus,isConstructFooter);sliderDiv.find("#sliFootDiv").html(footerHtml),OKRApprovalBootom.setFooterCallBack(),sliderDiv.find("#alignObjApprovalBody").html('<div class="zpl_crd "><div class="zpl_crdhdr"><div><h4 elem="secTitle"><span>'+ZPI18N.getString("zp.leave.report.leavedetails",[ZPI18N.getString("zp.alignObj")])+'</span></h4></div></div><div class="zpl_crdcnt"><div class="zpl_frmclm zpl_frmclmview" id="alignObjDet"></div></div></div>'),OKRApproval.constructAlignObjDetails(resultData),"#okr/approval"===Layout.Page.hash&&OKRApproval.setCallBackForTheUpdatedStatus()}},constructCommonOKRApproval:function(tabName,cardId){var tab=new Tab;return tab.id=tabName,tab.cardId=cardId,OKRApproval.modelBox={},OKRApproval.modelBox=new sliderModal("",tab),OKRApproval.modelBox.largeSize=!0,OKRApproval.modelBox.setContainerAsBody(!0),OKRApproval.modelBox.setCloseCallback(function(){OKRApproval.APPOBJTID="",OKRApproval.isPrimaryAppr=!1,OKRApproval.modelBox.remove(),OKRApproval.modelBox={},void 0!=ApprovalList.closePopCallback&&ZPUtil.Validation.isFunction(ApprovalList.closePopCallback)&&ApprovalList.closePopCallback(),OKRApproval.isPrimaryAppr=!1}),OKRApproval.modelBox.construct(),OKRApproval.modelBox.sliderDiv},constructKeyDetails:function(resultData){let pageId=OKRApproval.modelBox.sliderDiv;var row='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.keyResult")+"</label><span></span></div> <div><span>"+resultData.keyName+"</span></div></div>";row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.local.Comments")+"</label><span></span></div> <div><span>"+resultData.comment+"</span></div></div>",row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.oldPrg")+"</label><span></span></div> <div><span>"+resultData.oldPrg+"</span></div></div>",row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.newPrg")+"</label><span></span></div> <div><span>"+resultData.newPrg+"</span></div></div>",pageId.find("#checkInDet").html(row)},constructObjTDetails:function(resultData){let pageId=OKRApproval.modelBox.sliderDiv;var row='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.object")+"</label><span></span></div> <div><span>"+resultData.objective+"</span></div></div>";row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.description")+"</label><span></span></div> <div><span>"+resultData.description+"</span></div></div>",row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.sdate")+"</label><span></span></div> <div><span>"+resultData.fromDate+"</span></div></div>",row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.edate")+"</label><span></span></div> <div><span>"+resultData.toDate+"</span></div></div>",2==resultData.objtType?(row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.createdby",new Array(""))+"</label><span></span></div> <div><span><em>"+resultData.empId+" - </em><b>"+resultData.name+"</b></span></div></div>",row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.department")+"</label><span></span></div> <div><span>"+resultData.depName+"</span></div></div>"):4==resultData.objtType?(row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.createdby",new Array(""))+"</label><span></span></div> <div><span><em>"+resultData.empId+" - </em><b>"+resultData.name+"</b></span></div></div>",row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.location")+"</label><span></span></div> <div><span>"+resultData.locName+"</span></div></div>"):3==resultData.objtType?(row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.createdby",new Array(""))+"</label><span></span></div> <div><span><em>"+resultData.empId+" - </em><b>"+resultData.name+"</b></span></div></div>",row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.objectType")+"</label><span></span></div> <div><span>"+ZPI18N.getString("zp.orgObject")+"</span></div></div>"):row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.owner")+"</label><span></span></div> <div><span><em>"+resultData.empId+" - </em><b>"+resultData.name+"</b></span></div></div>",1!=resultData.objtType&&1!=resultData.visible?row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.lms.course.visibility")+"</label><span></span></div> <div><span>"+ZPI18N.getString("zp.myself")+"</span></div></div>":1!=resultData.objtType&&(row+='<div class="zpl_secn"><div><label class="">'+ZPI18N.getString("zp.lms.course.visibility")+"</label><span></span></div> <div><span>"+ZPI18N.getString("zp.all")+"</span></div></div>"),pageId.find("#objectiveDet").html(row)},constructAlignObjDetails:function(resultData){var objTypes=[ZPI18N.getString("zp.myfb",[ZPI18N.getString("zp.Onboarding.Objectives")]),ZPI18N.getString("zp.depObjTitle"),ZPI18N.getString("zp.orgObjTitle")];let pageId=OKRApproval.modelBox.sliderDiv;var row='<div class="zpl_secn"><div><label class="">Objective Name</label><span></span></div> <div><span>'+resultData.objName+"</span></div></div>";row+='<div class="zpl_secn"><div><label class="">Objective Owner</label><span></span></div> <div><span>'+("-"==resultData.name?resultData.name:ZPeople.decodeTxt(resultData.empId)+" "+ZPeople.decodeTxt(resultData.name))+"</span></div></div>",row+='<div class="zpl_secn"><div><label class="">Objective Type</label><span></span></div> <div><span>'+objTypes[resultData.objType-1]+"</span></div></div>",row+='<div class="zpl_secn"><div><label class="">Align to Objective Name</label><span></span></div> <div><span>'+resultData.parObjName+"</span></div></div>",row+='<div class="zpl_secn"><div><label class="">Align to Objective Type</label><span></span></div> <div><span>'+objTypes[resultData.parObjType-1]+"</span></div></div>",pageId.find("#alignObjDet").html(row)},setApprovalBottomDetails:function(){OKRApprovalBootom.setApprovalTabelName("P_Objectives"),OKRApprovalBootom.modalBodyId="#objectiveApproveBody",OKRApproval.modelBox.sliderDiv.find("#sliFootDiv").addClass("d-flexclmcap")},approvalRejcheck:function(obj){$(obj).hasClass("grn")?($(obj).removeClass("grn"),$(obj).addClass("gry"),$(obj).attr("title",ZPI18N.getString("zp.reject"))):$(obj).hasClass("gry")&&($(obj).removeClass("gry"),$(obj).addClass("grn"),$(obj).attr("title",ZPI18N.getString("zp.approve")))},handleokrApproval:function(apprDtls,comments,table){var type;switch(OKRApprovalBootom.enableDisableButton(!0),table){case"P_Objectives":type=0;break;case"P_KeyResult_CheckIn":type=1;break;case"P_ObjectiveAlign":type=2}var params={comments:comments,status:apprDtls.status,recordId:OKRApproval.APPOBJTID,type:type};OKRCommon.ajaxCall.postCallType(!0,"/okrCommon/approveRejectObjective",params,OKRApproval.approveSuccessCal)},approveSuccessCal:function(resultData){let apprPop=Layout.Page.container.find("#approvalpopup_"+OKRApproval.APPOBJTID);if(void 0===resultData||void 0!==resultData.Error)return OKRApprovalBootom.enableDisableButton(!1),$(apprPop).find("[name=approvalBtn]").removeAttr("disabled"),void ZPeople.Message.failure(ZPI18N.getString("zp.internalservererror"));ZPeople.Message.success(ZPI18N.getString("zp.approvalcmpltd")),delete OPApprovals.APPROVAL_DETAILS[OKRApproval.APPOBJTID],new ApprovalTimeline(OKRApproval.apprParam,OKRApproval.layoutParam).open(),OKRApproval.modelBox.sliderDiv.find("#sliHdrDiv .zpl_mhderrgt").remove(),void 0!=ApprovalList.closePopCallback&&ZPUtil.Validation.isFunction(ApprovalList.closePopCallback)&&ApprovalList.closePopCallback()}},OKRApprovalBootom={apprTableName:null,modalBodyId:null,approvalSettingsDetails:null,resetOKRApprovalBootomDts:function(){OKRApprovalBootom.apprTableName=null,OKRApprovalBootom.modalBodyId=null,OKRApprovalBootom.approvalSettingsDetails=null},setApprovalTabelName:function(tableName){OKRApprovalBootom.apprTableName=tableName},setApprovalSettingsDetails:function(approvalSettingsDetails){OKRApprovalBootom.approvalSettingsDetails=approvalSettingsDetails},getApprovalModal:function(){return OKRApproval.modelBox.sliderDiv},getFooterHtml:function(approvalStatus,isConstructFooter){let htm_="";return isConstructFooter&&void 0!=approvalStatus&&"-1"==approvalStatus?(htm_+='<div class="d-flexC flexclmcap12 zpl_DNI" id="zp_approvereject_box"><div><label id="apprCmtLabel">'+ZPI18N.getString("zp.lms.approvals.addComment")+'</label></div><div class="flex-grow"><textarea type="text" rows="4" class="ztextbox" id="zp_approval_comment" placeholder="'+ZPI18N.getString("zp.writeacomment")+'"></textarea></div></div>',htm_+='<div class="zpl_btnsplt">',htm_+='<div id="createtsbutton">',htm_+='<div id="approvetsbutton"><button id="zp_appproval_approve_btn" name="approvalTypeBtn" class="zlabel zlabel--blue zlabel--medium" approvaltype="1">'+ZPI18N.getString("zp.approve")+"</button>",htm_+='<button id="zp_appproval_reject_btn" name="approvalTypeBtn" class="zlabel zlabel--red zlabel--medium" approvaltype="0">'+ZPI18N.getString("zp.reject")+"</button>",htm_+='<button name="approvalTypeBtn" class="zlabel zlabel--outline zlabel--medium" id="zp_appproval_close_btn" type="button">'+ZPI18N.getString("zp.close")+"</button>",htm_+='<button name="confirmTypeBtn" class="zlabel zlabel--blue zlabel--medium zpl_DNI" id="zp_appproval_confirm_btn">'+ZPI18N.getString("zp.confirm")+"</button>",htm_+='<button name="confirmTypeBtn" class="zlabel zlabel--outline zlabel--medium zpl_DNI" id="zp_appproval_cancel_btn">'+ZPI18N.getString("zp.cancel")+"</button>",htm_+="</div></div>"):(htm_+='<div class="zpl_btnsplt">',htm_+='<div id="createtsbutton">',htm_+='<button name="approvalTypeBtn" class="zlabel zlabel--outline zlabel--medium" type="button" id="zp_appproval_close_btn">'+ZPI18N.getString("zp.close")+"</button>",htm_+="</div></div>"),htm_},setFooterCallBack:function(){let pageId=OKRApprovalBootom.getApprovalModal();pageId.find("#zp_appproval_approve_btn").unbind(),pageId.find("#zp_appproval_approve_btn").on("click",function(){OKRApprovalBootom.showHideApproveRejCommentBox(this)}),pageId.find("#zp_appproval_reject_btn").unbind(),pageId.find("#zp_appproval_reject_btn").on("click",function(){OKRApprovalBootom.showHideApproveRejCommentBox(this)}),pageId.find("#zp_appproval_close_btn").unbind(),pageId.find("#zp_appproval_close_btn").on("click",function(){OKRApprovalBootom.setApprovalCloseCallBack()}),pageId.find("#zp_appproval_confirm_btn").unbind(),pageId.find("#zp_appproval_confirm_btn").on("click",function(){OKRApprovalBootom.approveRejectConfirm()}),pageId.find("#zp_appproval_cancel_btn").unbind(),pageId.find("#zp_appproval_cancel_btn").on("click",function(){OKRApprovalBootom.showHideApproveRejCommentBox(this,!0)})},setApprovalCloseCallBack:function(){return OKRApproval.modelBox.close()},showHideApproveRejCommentBox:function(ele,hideCommentBox){let pageId=OKRApprovalBootom.getApprovalModal();if(pageId.find("#zp_approval_comment").val(""),OKRApprovalBootom.removeErrMsg(),hideCommentBox)pageId.find("#zp_approvereject_box").addClass("zpl_DNI"),pageId.find('[name="approvalTypeBtn"]').removeClass("zpl_DNI"),pageId.find('[name="confirmTypeBtn"]').addClass("zpl_DNI");else{pageId.find("#zp_approvereject_box").removeClass("zpl_DNI"),pageId.find('[name="approvalTypeBtn"]').addClass("zpl_DNI"),pageId.find('[name="confirmTypeBtn"]').removeClass("zpl_DNI");var type=$(ele).attr("approvaltype");OKRApprovalBootom.isCmtManidatory(type)?pageId.find("#apprCmtLabel").addClass("zpl_mtry"):pageId.find("#apprCmtLabel").removeClass("zpl_mtry"),"0"==type?(pageId.find("#zp_appproval_confirm_btn").addClass("zlabel--red").removeClass("zlabel--blue"),pageId.find("#zp_appproval_confirm_btn").attr("approvaltype",0)):(pageId.find("#zp_appproval_confirm_btn").removeClass("zlabel--red").addClass("zlabel--blue"),"1"==type?pageId.find("#zp_appproval_confirm_btn").attr("approvaltype",1):"2"==type&&pageId.find("#zp_appproval_confirm_btn").attr("approvaltype",2))}},removeErrMsg:function(){let pageId=OKRApprovalBootom.getApprovalModal();pageId.find("#zp_approvereject_box #zp_approval_comment").removeClass("ztextbox__error"),pageId.find("#sliFootDiv #error_message").remove()},isCmtManidatory:function(apprType){let isCmtMandatory=!1;return void 0!==OKRApprovalBootom.approvalSettingsDetails&&null!==OKRApprovalBootom.approvalSettingsDetails&&("1"===apprType&&void 0!==OKRApprovalBootom.approvalSettingsDetails.isApprMandatory&&OKRApprovalBootom.approvalSettingsDetails.isApprMandatory||"0"===apprType&&void 0!==OKRApprovalBootom.approvalSettingsDetails.isRejMandatory&&OKRApprovalBootom.approvalSettingsDetails.isRejMandatory)&&(isCmtMandatory=!0),isCmtMandatory},validateApprReject:function(apprType,comment){let pageId=OKRApprovalBootom.getApprovalModal(),isValid=!0;return OKRApprovalBootom.isCmtManidatory(apprType)&&""===comment&&comment.length<=0&&(pageId.find("#zp_approvereject_box #zp_approval_comment").addClass("ztextbox__error"),pageId.find("#zp_approvereject_box #zp_approval_comment").parent().append('<span id="error_message" class="ztextbox--error__label">'+ZPI18N.getString("zp.apprCmtMandatoryErr")+"</span>"),isValid=!1),isValid},approveRejectConfirm:function(){let pageId=OKRApprovalBootom.getApprovalModal();var modalFooter=pageId.find(".zpl_mfoter"),status=modalFooter.find("#zp_appproval_confirm_btn").attr("approvaltype"),comment=modalFooter.find("#zp_approval_comment").val().trim(),approvalType=0==status?"0":"1";if(OKRApprovalBootom.removeErrMsg(),!OKRApprovalBootom.validateApprReject(approvalType,comment))return!1;var data=pageId.find(OKRApprovalBootom.modalBodyId).data(),approveRejObj=new ApproveReject(data.appParam,data.layoutParam,approvalType,comment,!1);return OKRApproval.handleokrApproval(approveRejObj,comment,OKRApprovalBootom.apprTableName)},enableDisableButton:function(isDisable){let pageId=OKRApprovalBootom.getApprovalModal();pageId.find("#zp_appproval_approve_btn").prop("disabled",isDisable),pageId.find("#zp_appproval_reject_btn").prop("disabled",isDisable),pageId.find("#zp_appproval_close_btn").prop("disabled",isDisable),pageId.find("#zp_appproval_confirm_btn").prop("disabled",isDisable),pageId.find("#zp_appproval_cancel_btn").prop("disabled",isDisable)}};