MySpace={},MySpace.Components={dropDownMenu:function(menuObect){var comp=ZPeopleComponents.menu($("#"+menuObect.menuId));comp&&comp.destroy();var menuList=ZPeopleComponents.menu($("#"+menuObect.menuId),{forElement:$("#"+menuObect.forElementId),className:"zpl_drprosts zpl_drpdwn",itemclick:menuObect.callback(),appendTo:menuObect.parentId});menuObect.option.forEach(function(menuOption,indx){menuList.addMenuItem(menuOption)})},userInfo:(erecno,empId,name,designation,img)=>{var card=$('<figure><div class="Activity"><img id="userprofimg" src="'+img+'" alt=""></div><figcaption><div class="zpl_em"><div class="zpl_emdts zpl_ellipsis"><div class="user_dtlscl"><em>'+empId+" - </em><b>"+name+'</b><span id="att_status" class=""></span></div><em>'+designation+"</em></div></div></figcaption></figure>");return card.find("#userprofimg").on("click",function(){ZPeople.showProfilePhotoById(erecno),ZPUserProfile.updatePhoto=!0}),card},managerInfo:(empId,name,img,erecno)=>{var card=$('<div class="zpl_myprof-rptto text-right"><div class="zpl_em"><div class="zpl_emdts zpl_ellipsis"><em>'+ZPI18N.getString("zp.reportingto")+'</em><div class="dtlfld CP"><em>'+empId+" - </em><b>"+name+'</b></div></div><div class="zpl_emimg CP"><img alt="" src="'+img+'"></div></div></div>');return card.find(".zpl_emimg,.dtlfld").on("click",function(){ZPeople.getUserPage(erecno)}),card},more:pageId=>{var cotainer=$('<div id="'+pageId+'_mymenu"></div><a id="'+pageId+'_mymore" class="zpl_ibg PI_more zpl_drpdwn-js" data-menu-id="MyProfileMore"></a>');return cotainer.eq(1).on("click",function(){pageId&&ZPeopleComponents.menu($("#"+pageId+"_mymenu")).show()}),cotainer},tabUL:function(pageId){var tabElement=$('<div class="mspace_actband"><div id="'+pageId+'_tabcontainer" class="nav_container"><ul class="zpl_tabpane"></ul></div></div>');return ZPUserProfile.info.getUserId()==erecno&&tabElement.find("#"+pageId+"_tabcontainer").append($('<i class="PI_widgt_custm mspace_multiact" title="'+ZPI18N.getString("zp.customizetabs")+'" data-popup-open="MyCustab"></i>').on("click",MySpace.ModelView.TabCustomization.show)),tabElement},Wrapper:pageId=>{return $('<div id="'+pageId+'_contentWrap" class="zpl_tabcnt"></div></div>')},modelContainer:'<div id="model_wrap" class="zpl_mdl zpl_mfull zpl_mopen" data-modal-box="full"><div class="zpl_minr"></div></div>',modelTopBand:function(modelHeader,username,userId,userImg){var header=$('<div class="zpl_mhder"><div class="hdr_dts_"><h4> '+ZSEC.Encoder.encodeForHTML(modelHeader)+' </h4><div class="zpl_em"><div class="zpl_emimg"><img src="'+userImg+'"></div><div class="zpl_emdts"><div><em>'+ZSEC.Encoder.encodeForHTML(userId)+" - </em><b>"+ZSEC.Encoder.encodeForHTML(username)+"</b></div></div></div></div></div>"),back=$('<a class="clsArw"><i class="PI_back"></i></a>').on("click",MySpace.ModelView.hide);header.find(".hdr_dts_").prepend(back);var close=$('<a class="close_model"><span class="_cls PI_cls"></span></a>').on("click",MySpace.ModelView.hide);return header.append(close),header},modelContentWrap:'<div class="zpl_mcnt"><div id="content_wrap" class="zpl_mmnu"></div></div>',model:function(modelHeader,username,userId,userImg){var model=$(MySpace.Components.modelContainer),innerwrap=model.find(".zpl_minr");return innerwrap.append(MySpace.Components.modelTopBand(modelHeader,username,userId,userImg)),innerwrap.append(MySpace.Components.modelContentWrap),model},containerLoading:function(classname){return'<div id="containerloading" class="'+classname+'"><div class="zpl_atosv"><div class="'+classname+' zpl_atocnt"><div class="zpl_atoprg"><div></div><div></div><div></div><div></div><div></div></div><i class="PI_tick2"></i></div></div></div>'},pageLoading:function(classname){return'<div id="pageloader" class="'+classname+'"><div class="grybg" style="height: 300px;"><div class="ctable" id="zp_page_loading"><div class="ctcell"><div class="loader-inner line-scale"><div></div><div></div><div></div><div></div><div></div></div></div></div></div></div>'},pageDisabled:'<div class="zpl_Emptydata"> <div> <div class="zpl_emptimg zp_nd_disbldsgn"></div> <h4>'+ZPI18N.getString("zp.nofilterrecord")+"</h4></div> </div>",toggleButton:(id,status)=>`<label class="btnactive MB0" ><div class="zpl_tgl"><input class="togbuttondis-js" id="${id+"_zp_tabEnblDsbl"}" changeStatus="`+status+'" /></div></label>',pageWrap:pageId=>'<div class="zpl_container" scroll="enabled" id="'+pageId+'">'+ZPeople.LOADING_HTML+"</div>",pageContainer:pageId=>$('<div class="zpl_mspace_out"> <div class="zpl_mspace_wrap"><div id="'+pageId+'_mycon" class="zpl_myprofhd"><div class="zpl_myprofhd-acts"></div></div><div id="myprofContainer" class="zpl_myprof-bsinfo"><div id="my_detailsBand"></div></div><section class="mspace_cntwrap"></section></div></div>')},MySpace.Page={tabArray:[],userPage:{},isFeedLoaded:!1,isApprovalLoaded:!1,isLoded:!1,userInfo:{},moreTabsOptions:{},setLoading:(container,loadingType,isinitial)=>{if("container"==loadingType){var loading=container.find("#containerloading");1==isinitial?container.html(MySpace.Components.containerLoading("zpl_Emptydata")):0==loading.length&&container.append(MySpace.Components.containerLoading("zpl_Emptydata"))}else{loading=container.find("#pageloader");1==isinitial?container.html(MySpace.Components.pageLoading("zpl_Emptydata")):0==loading.length&&container.append(MySpace.Components.pageLoading())}},removeLoading:container=>{container.find("#pageloader,#containerloading").remove()}},MySpace.ModelView={TabCustomization:{show:refresh=>{let pageObj=ZPUserProfile.Page.userPage.home_Myspace_contwrap,pageContainer=$(pageObj.page).parent();var wrap=pageContainer.find("#custMyTab");0==wrap.length?((wrap=$('<div id="custMyTab" closemodelview="true" class="zpl_mdl zpl_msm zpl_srvclst zpl_servcustom zpl_mopen" data-modal-box="pplservices"><div class="zpl_minr"><div class="zpl_mhder"><div class="wd100_per"><div class="d-flex" id="hdcsvw"><h5 class="M0I">'+ZPI18N.getString("zp.customizetabs")+'</h5><a class="_cls PI_cls"></a></div></div></div><div class="zpl_mcnt"><div id="myspaceSortable" class="zpl_cat zpl_srvcust ui-sortable"></div></div></div></div>')).find("a._cls.PI_cls").on("click",function(){wrap.removeClass("zpl_mopen")}),MySpace.ModelView.TabCustomization.cunstructCustOption(wrap,pageObj),pageContainer.append(wrap)):1==refresh?MySpace.ModelView.TabCustomization.cunstructCustOption(wrap,pageObj):wrap.addClass("zpl_mopen")},cunstructCustOption:(wrap,pageObj)=>{var customTabContainer=wrap.find("div.ui-sortable");customTabContainer.empty(),$.each(pageObj.tabArray,function(index,value){if(value.isStatic)customTabContainer.append($('<div tabid="'+value.tabId+'" isStatic="'+value.isStatic+'" seq="'+value.seq+'"  customizeId="'+value.customizeId+'" class="zpl_op5 flexclmcap ignore-elements"><div class="d-flexC flexclmcap zpl_ellipsis"><div class="zpl_Fldtl"><h5>'+ZSEC.Encoder.encodeForHTML(value.tabName)+'</h5></div></div><div class="MLauto"><span class="PI_lock"></span></div></div>'));else{var statusIcon="",isEnabled=!1;1==value.isHidden?(statusIcon=MySpace.Components.toggleButton(value.tabId,1),isEnabled=!1):(statusIcon=MySpace.Components.toggleButton(value.tabId,0),isEnabled=!0),customTabContainer.append($('<div id="'+value.tabId+'_tab" seq="'+value.seq+'" isStatic="'+value.isStatic+'" tabid="'+value.tabId+'" customizeId="'+value.customizeId+'" class="dragger flexclmcap"><div class="d-flexC flexclmcap zpl_ellipsis"><div class="zpl_Fldtl"><h5>'+ZSEC.Encoder.encodeForHTML(value.tabName)+'</h5></div></div><div class="MLauto">'+statusIcon+"</div></div>")),ZPeopleComponents.toggleswitch($(customTabContainer).find("#"+value.tabId+"_zp_tabEnblDsbl"),{on:isEnabled,change:MySpace.ModelView.TabCustomization.tabEnableDisable})}}),customTabContainer.sortable({cancel:".ignore-elements , .zswitch",placeholder:"mvr-hldr",update:function(e,ui){var nextElement=ui.item.next();if("true"!=$(nextElement).attr("isStatic")){var item=$(ui.item),prevElement=item.prev(),itemId=item.attr("customizeId"),seq=item.attr("seq"),param={};param.oldSeq=seq,param.newSeq=prevElement.attr("seq"),param.tabId=itemId,param.actionType="SEQUENCE",param.mode="CUSTOMIZE_TAB",customTabContainer.sortable("disable"),MySpace.ModelView.TabCustomization.updatePreference(param)}else customTabContainer.sortable("cancel")}}).disableSelection()},tabEnableDisable:(event,tabObj)=>{var status=!tabObj.state,param={mode:"CUSTOMIZE_TAB"};param.tabId=$(event.target).parents(".dragger").attr("customizeId"),param.isHidden=status,param.actionType="ENABLEDISABLE",MySpace.ModelView.TabCustomization.updatePreference(param)},updatePreference:param=>{ZPeople.Request.send("/myspaceTabAction.zp",param,MySpace.ModelView.TabCustomization.handleUpdatePreference,void 0,MySpace.ModelView.TabCustomization.handleUpdatePreference)},handleUpdatePreference:(response,param)=>{var tab={},pageObj=ZPUserProfile.Page.userPage.home_Myspace_contwrap;if(response.isUpdated){if("ENABLEDISABLE"==param.actionType){pageObj.tabArray.forEach(function(tabObj,ind){tabObj.customizeId!=param.tabId||(tab=tabObj)}),tab.isHidden=param.isHidden,ZPNavBar.getInstance(pageObj.pageId).updateTabArray(pageObj.tabArray)}else if("SEQUENCE"==param.actionType){let currIndex,prevIndex,nSeq=parseInt(param.newSeq),oSeq=parseInt(param.oldSeq),putDown=nSeq>oSeq;nSeq=putDown?nSeq:nSeq+1;let from=putDown?oSeq:nSeq,to=putDown?nSeq:oSeq;for(var i=0;i<pageObj.tabArray.length;i++){var tempObj=pageObj.tabArray[i];param.tabId==tempObj.customizeId&&(currIndex=i),param.newSeq&&param.newSeq==tempObj.seq&&(prevIndex=i)}let CurrObj=pageObj.tabArray.splice(currIndex,1);prevIndex=currIndex<prevIndex?prevIndex-1:prevIndex,pageObj.tabArray.splice(prevIndex+1,0,...CurrObj);for(let i=0;i<pageObj.tabArray.length;i++){let temp=pageObj.tabArray[i],custId=temp.customizeId,seq=temp.seq;seq>=from&&seq<=to&&(custId==param.tabId?temp.seq=nSeq:temp.seq=putDown?seq-1:seq+1)}$("#custMyTab #myspaceSortable [customizeId]").filter(function(){let seq=parseInt($(this).attr("seq"));return seq>=from&&seq<=to}).each(function(){let temp=$(this),custId=temp.attr("customizeId"),seq=parseInt(temp.attr("seq"));custId==param.tabId?temp.attr("seq",nSeq):putDown?temp.attr("seq",seq-1):temp.attr("seq",seq+1)}),ZPNavBar.getInstance(pageObj.pageId).updateTabArray(pageObj.tabArray)}}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror")),MySpace.ModelView.TabCustomization.show(!0);$("#custMyTab .ui-sortable").sortable("enable")}}},MySpace.PageView={Payslips:{isInit:!1,payrollZSOID:0,init:container=>{MySpace.PageView.Payslips.isInit||(ZPeople.Request.send("/integrations/payroll/FetchPayslipsList",{},function(data){if(200==data.code){let zsoid=data.payroll_zsoid;MySpace.PageView.Payslips.payrollZSOID=data.payroll_zsoid;let content="";data.payslipsdata.forEach(payslip=>{let subContent=`\t<div payslip_id="${payslip.payrun_id}" payslip_url="${payslip.payslip_url}">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="PI_ft_pdf"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_msp-dts">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_msp-name">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="zpl_msp-title CP" onClick="MySpace.PageView.Payslips.view('${zsoid}', '${payslip.payrun_id}', '${payslip.pay_date_formatted}')">${payslip.pay_period_formatted}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>     \n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="d-flexclm8 w200">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="zpl_progtitle">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<em>`+ZPI18N.getString("zp.paydate")+`</em>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b>${payslip.pay_date_formatted}</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_msp-act">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zpl_hvr zpl_hvrsw">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="PI_print" onClick="MySpace.PageView.Payslips.view('${zsoid}', '${payslip.payrun_id}', '${payslip.pay_date_formatted}')"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class="PI_downld" onClick="MySpace.PageView.Payslips.download('${zsoid}', '${payslip.payrun_id}', '${payslip.pay_period}')"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>                                          \n\t\t\t\t\t\t\t\t\t\t\t \t</div>`;content+=subContent});let payslipDOM=`<div id="Payslips">${0===content.length?`<div id="emptPage" class="zpl_crd wd100_per"><div class="zpl_crdcnt"><div class="zpl_Emptydata"><div><div class="zpl_emptimg zp_nd_nodata"></div><h4>${ZPI18N.getString("zp.payslipsnotavail")}</h4><p></p></div></div></div></div>`:`<div class="zpl_msplst">${content}</div>`}</div>`+(0!==content.length?'<form id="payslip_download_form" action="integrations/payroll/FetchPayslip" method="get" name="payslip_download_form" style="display: none;" target="downloadresp"></form>':"");container.html(payslipDOM)}else 500==data.code?ZAlertBanner.show({message:data.message,type:"error",hideDelay:3e3,closeButton:!0,icon:!0}):ZAlertBanner.show({message:ZPI18N.getString("zp.reservespaceerrormsg",[ZPeople.peopleSupportEmail]),type:"error",hideDelay:3e3,closeButton:!0,icon:!0})}),MySpace.PageView.Payslips.isInit=!0)},download:function(zsoid,payrun_id,pay_period){var formObj=$("#payslip_download_form").html("");formObj.append('<input type="hidden" value="'+payrun_id+'" name="payrun_id"/>'),formObj.append('<input type="hidden" value="'+zsoid+'" name="payroll_zsoid"/>'),formObj.append('<input type="hidden" value="'+pay_period+'" name="payperiod"/>'),formObj.append('<input type="hidden" value="FetchPayslip" name="method"/>'),formObj.submit()},view:function(zsoid,payrun_id,fileName){let downloadURL=`/${portalName}/pdfViewer.zp?mode=payslip&payrun_id=${payrun_id}&payroll_zsoid=${zsoid}`;lightBox=new LightBox(fileName),lightBox.viewUrl=downloadURL,lightBox.isImage=!1,lightBox.needPrint=!1,lightBox.show()}}},MySpace.Widgets={Configuration:[{mode:"reportingCircle",callback:()=>MySpace.reportingCircle.fetchReportingCircle},{mode:"XoxodayCard",callback:_=>MySpace.XoxodayCard.fetchDetails}]},MySpace.XoxodayCard={template:`<div class="zpl_msplst">\n\t\t\t\t\t<div class="zpl_msp-crdlst">\n\t\t\t\t\t\t<h5 class="d-flexclmcap8"><img width="75" src="${ZPeople.getResourceURL(imageUrl+"l_xoxoday.png")}"></h5>\n\t\t\t\t\t\t<div class="zpl_msp-crdcnt">\n\t\t\t\t\t\t\t<div class="zpl_giftredm">\n\t\t\t\t\t\t\t\t<div class="d-flexclmcap12 d-flexC"><span class="icn"><i class="PI_reward"></i></span><span>${ZPI18N.getString("zp.xoxoday.rewards")}</span><span class="zpl_rdmpts">#reward-points</span></div>\n\t\t\t\t\t\t\t\t<div class="zpl_redmbtn d-flexM"><button class="zlabel zlabel--medium zlabel--outline" data-popup-open="xoxodayRedeem" onclick="MySpace.XoxodayCard.redeem(this)">${ZPI18N.getString("zp.xoxoday.redeempoints")}</button></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`,fetchDetails:card=>{let param={mode:"XOXODAY_CARD"};ZPeople.Request.send("/myspaceTabAction.zp",param,MySpace.XoxodayCard.construct,card,MySpace.XoxodayCard.construct)},construct:(response,param,card)=>{void 0!==response.xoxodayIntegDetails&&response.xoxodayIntegDetails.isIntegEnabled&&response.xoxodayIntegDetails.isLocAndEmpTypeMatched&&response.xoxodayIntegDetails.isAllowedToView&&ZPeople.Request.send("/integrations/xoxoday/getPoints",{erecNo:erecno},function(result){let points=null!=result[1].userPoints?result[1].userPoints:"-";template=MySpace.XoxodayCard.template.replace("#reward-points",points),card.append(template),card.removeClass("DNI")})},redeem:target=>{target.classList.add("disabled"),ZPeople.Request.send("/integrations/xoxoday/userSingleSignOn",{},function(response){target.classList.remove("disabled"),void 0!=response&&1===response[0]?window.open(response[1].storesRedirectUrl+response[1].ssoToken,"_blank"):ZAlertBanner.show({message:response[1].msg,type:"error",hideDelay:3e3,closeButton:!0,icon:!0})})}},MySpace.reportingCircle={fetchReportingCircle:card=>{let param={mode:"REPORTING_CIRCLE"};ZPeople.Request.send("/myspaceTabAction.zp",param,MySpace.reportingCircle.constructReportingCircle,card,MySpace.reportingCircle.constructReportingCircle)},constructReportingCircle:(response,param,card)=>{if(response.reporteeCircleData.length>0){card.removeClass("DNI"),card.append('<div class="zpl_msp-crdlst"><div class="zpl_msp-crdcnt" id="empListDivMSR"></div></div>');let empListDiv=card.find("#empListDivMSR");$.each(response.reporteeCircleData,function(i,data){let lstview=$('<div class="zpl_msp-lstview"></div>');empListDiv.append(lstview),MySpace.reportingCircle.ConstructCardDetails(data,lstview,i),card.attr({tabindex:"0","aria-label":ZPI18N.getString("zp.youhave",[data.count+" "+data.title])})})}},ConstructEmpDetails:empObj=>{let attnstatus="<span autorefresh='true' uid='"+empObj.ENO+"' class='zpl_ondutyclr'>";if(empObj.leaveAttStat){var leaveAttStat=ZSEC.Encoder.encodeForHTML(empObj.leaveAttStatUnEncoded),colourClass=Attendance.setClassToShowStatus(empObj.colourCode);Attendance.isLeaveAvail(empObj.colourCode)&&(leaveAttStat=empObj.leaveAttStat),attnstatus="<div class='zpl_flex-a-c' id='empAttInfo'><span autorefresh='true' uid='"+empObj.ENO+"' class='"+colourClass+"'>"+leaveAttStat+"</span>",void 0!=empObj.checkInBuilding&&""!=empObj.checkInBuilding&&(attnstatus+="<em class='zpl_dots sm' id='checkInBuildingIN_Dot'></em>",attnstatus+="<div class='"+colourClass+" zpl_ellipsis zpl_flexgap2' id='checkInBuildingIN_Div'><i class='PI_building "+colourClass+" tooltip-js' id='checkInBuildingIN_Icon' title='"+empObj.checkInBuilding+"'></i>",attnstatus+="<span class='zpl_ellipsis' id='checkInBuildingIN_Label' title='"+empObj.checkInBuilding+"'>"+empObj.checkInBuilding+"</span></div>"),attnstatus+="</div>"}let empcard=$('<div class="zpl_em"><div class="zpl_emimg"><img empid = "'+empObj.ENO+'" elem="profilePhoto" src="'+empObj.EMPLOYEEPHOTO+'">'+(empObj.ZUID?'<span cstus="true" uid="'+empObj.ZUID+'"></span>':"")+'</div><div class="zpl_emdts"><div class="zpl_link" title="'+ZSEC.Encoder.encodeForHTML(empObj.EMPLOYEENAME)+'"><em>'+ZSEC.Encoder.encodeForHTML(empObj.EMPLOYEEID)+" - </em><b>"+ZSEC.Encoder.encodeForHTML(empObj.EMPLOYEENAME)+"</b></div><div>"+attnstatus+"</div></div>"+(empObj.ZUID&&empObj.ZUID!==_LOGGEDIN_ZUID&&"true"==ZPeople.ISCHAT?'<div title="'+ZPI18N.getString("zp.chatandcall")+'" hvr="true" class="zpl_hvr"><i class="PI_pharw" uid="'+empObj.ZUID+'" chat_comm="true" tabindex="0"></i></div>':"")+"</div>");return empcard.find(".zpl_link").on("click",function(){ZPeople.getUserPage(empObj.ENO)}),empcard},ConstructCardDetails:(data,card,index)=>{let className=index>0?"zpl_msp-subhhdr":"zpl_msp-mainhhdr";if(card.append('<h5 class="'+className+'">'+data.title+"</h5>"),$.each(data.empList,function(i,empObj){card.append(MySpace.reportingCircle.ConstructEmpDetails(empObj))}),data.count>3){let count=parseInt(data.count)-3;card.append($('<div class="zpl_mspmore"><a data-popup-open="teasmbday">+'+count+" More</a></div>").on("click",function(){UserWidget.Components.userListModelCommon(data.mode)}))}}};