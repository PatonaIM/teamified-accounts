var WF_ACTION_ADD=1,WF_ACTION_EDIT=2,WF_ACTION_DELETE=3,WF_ACTION_APPROVE=4,WF_ACTION_REJECT=5,WF_ACTION_ADDOREDIT=8,WF_ACTION_FIELDVALUECHANGE=9,WF_ACTION_REMINDER=10,CHECKLIST_REC_PERPAGE=25,CUSTOM_DATE=36,TOMORROW=33,NEXT_7_DAYS=39,ZPChecklist={CHECKITEMROOT_TEMPLATE:'<div id="rootTaskTriggerDtlsPage"  class="modal popRgtModel PopMdxModel modal-right " aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"> <a data-dismiss="modal" class="close"><span class="IC-cls-1px red" id="rootClose"></span></a><h6><div class="txttrim FL">'+ZPI18N.getString("zp.checklist")+'</div><span data-placement="bottom" title="" class="S14 FL gry ML15 ZPtitle hide" data-original-title="Edit Permissions"><i class="IC-pen S14 MR5"></i></span> </h6></div><div class="row dvTaskdetail" id = "checklistDetails" style="display:none"><div><table class="table table-hover M0"><tbody><tr data-toggle="collapse"><th><div class="FL MR10"data-toggle="tooltip" data-placement="top" data-container="body"><img class="Usrimg FL MR10 MT5" src="" id="taskOwnerImg" /></div><div class="tragcont"><div class="S16" id="taskClName"></div><p id="myReqTriggerInfo"></p></div></th><th width="260" id="rootStatus"></th></tr></tbody></table><div id="taskDtlsDiv"><ul class="ulTaskdetail"></ul></div></div></div><div class="modal-body" id="checkrootList"></div><div class="modal-footer"><a data-dismiss="modal" class="btn btn-default">'+ZPI18N.getString("zp.close")+"</a></div></div></div></div>",CHECKLISTITEM_TEMPLATE:'<div class="modal popRgtModel PopMdxModel PopComtsfixed modal-right" tabindex="-1" id="myClReqComment"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"> <a class="close" data-dismiss="modal"><span class="IC-cls-1px red"></span></a><div class="txttrim FL" id="commentSlideHead"><h6><span class="S14 FL gry ML15 ZPtitle hide" title="Edit Permissions" data-placement="bottom"><i class="IC-pen S14 MR5"></i></span> </h6></div></div><div class="modal-body" id="commentSlideBody"><div class="row dvchklstcom"><div class="dvchkhead"><table class="table table-responsive"><tr><th id="checkitemDetail"></th><th width="260"></th></tr></table></div><div class="col-md-8 PT10 ML40"><div class="row"><label class="control-label col-md-4">'+ZPI18N.getString("zp.formname")+'</label><div class="form-group col-md-8"><a id="checklistFormName" name="record" formid="" recordid=""></a></div></div><div class="row"><label class="control-label col-md-4">'+ZPI18N.getString("zp.taskowner")+'</label><div class="form-group col-md-8" id="checklistTaskOwner"><div class="form-group"><span class="IC-role gry MR10 ZPtitle" title="Role"></span><span name="taskOwner"></span></div><div class="form-group"><span class="gry MR10 ZPtitle" title="Groups"></span><span name="taskOwner"></span></div><div class="form-group"><span class="IC-team gry MR10 ZPtitle" title="Department"></span><span name="taskOwner"></span></div><div class="form-group"><span class="IC-user gry MR10 ZPtitle" title="Employee"></span><span name="taskOwner"></span></div></div></div><div class="row"><label class="control-label col-md-4">'+ZPI18N.getString("zp.initiatedby")+'</label><div class="form-group col-md-8"><span id="checklistInitiatedBy"></span></div></div><div class="row"><label class="control-label col-md-4">'+ZPI18N.getString("zp.initiatedon")+'</label><div class="form-group col-md-8"><span id="checklistInitiatedOn"></span></div></div><div class="row"><label class="control-label col-md-4">'+ZPI18N.getString("zp.triggeredaction")+'</label><div class="form-group col-md-8"><span id="checklistTriggeredOn"></span></div></div></div><div class="main-media CL FL MT20"><div class="media-comments"><div class="media" id="commentBodyDummy" style="display:none"><div class="media-left"> <img src="" class="media-object" /></div><div class="media-body"><div class="media-resize"><a><b></b></a> <span class="dt-time"></span><p class="post-content MT8"></p></div></div></div><div id="checklistComments"><div class="media" id="commentHead"><div class="media-left"> <span class="IC-chat S16"></span> </div><div class="media-body"><a id="cmtCount"></a></div></div></div></div></div></div></div><div class="modal-footer"><div class="media"><div class="media-left"><img src="" class="Usrimg FL MR10 MT5"></div><div class="media-body"><div class="media-resize"><div class="mentions-input-box"><div class="mentions"></div><textarea placeholder="'+ZPI18N.getString("zp.writeacomment")+'" class="form-control ZP-postcmt"></textarea><div  class="mentions-autocomplete-list"></div></div><div class="text-right ZP-cmtbtn DB PT10"><div class="mentions"></div><button class="btn btn-primary" onclick="ZPChecklist.saveComment(this)">'+ZPI18N.getString("zp.post")+'</button><div class="mentions-autocomplete-list"></div></div></div></div></div></div></div></div></div>',getChecklistData:function(){var pageId=$("#"+AutomationCommon.getCurrentPageId()),formId=pageId.find("#myChecklistComboBox").val(),mode=pageId.find("#checklistStatusCombo").val(),url="",params={formId:formId,mode:mode,method:"getMyChecklistItem",conreqcsr:csrfToken};if(isadmin?(params.method="getAdminChecklistItem",params.erecno=pageId.find("#employeeChecklistCombo").val(),url="/checklistAdminAction.zp"):(params.method="getMyChecklistItem",url="/checklistAction.zp"),params.index="pending"===mode||"overdue"===mode?pageId.find(".IC-rou-tik.gry").length+1:pageId.find(".IC-rou-tik").length+1,0==pageId.find(".IC-rou-tik").length&&ZPACommon.showEmptyListPage("pageloading"),pageId.find("#dvFiltersec").is(":visible")&&(params.searchString=pageId.find("#taskSearchString").val(),params.sDate=pageId.find("#datePicker").val(),params.sDate==CUSTOM_DATE)){var dateStr=pageId.find("#customDatePicker").find("input").val(),dates=ZPChecklist.splitFromToDate(dateStr);params.sDate=dates.from,params.eDate=dates.to}ZPeople.Request.send(url,params,ZPChecklist.appendDataInHead)},regFilterClickEvent:function(){var pageId=$("#"+AutomationCommon.getCurrentPageId());pageId.find("#filterIcon").click(function(){pageId.find("#dvFiltersec").is(":visible")?(pageId.find("#dvFiltersec").addClass("DN"),pageId.find("#contWrapper").removeClass("open"),pageId.find("#filterIcon").removeClass("active")):(pageId.find("#dvFiltersec").removeClass("DN"),pageId.find("#contWrapper").addClass("open"),pageId.find("#datePicker").select2(),pageId.find("#filterIcon").addClass("active"))})},splitFromToDate:function(dateStr){var parts=dateStr.split("-"),dates={};return 2==parts.length?(dates.from=parts[0],dates.to=parts[1]):6==parts.length&&(dates.from=parts[0]+"-"+parts[1]+"-"+parts[2],dates.to=parts[3]+"-"+parts[4]+"-"+parts[5]),dates},resetChecklistTaskPage:function(){$(".ERR").remove(),ZPChecklist.isValideTaskFilter()&&($("#"+AutomationCommon.getCurrentPageId()).find("#myChecklistTable").html(""),ZPChecklist.getChecklistData())},isValideTaskFilter:function(){var pageId=$("#"+AutomationCommon.getCurrentPageId()),sDate=pageId.find("#datePicker").val(),mode=pageId.find("#checklistStatusCombo").val();if(pageId.find("#customDateErr").remove(),pageId.find("#dvFiltersec").is(":visible")){if(sDate==CUSTOM_DATE){var dateStr=pageId.find("#customDatePicker").find("input").val(),dates=ZPChecklist.splitFromToDate(dateStr);if(void 0==dates.from||void 0==dates.to||!Calendar.isvalidDate(dates.from)||!Calendar.isvalidDate(dates.to))return pageId.find("#customDatePicker").append('<div class="ERR WNW" id="customDateErr">'+ZPI18N.getString("zp.selectfromandto")+"</div>"),!1;if(Calendar.parseDate(dates.from,uidateFormat)>Calendar.parseDate(dates.to,uidateFormat))return pageId.find("#customDatePicker").append('<div class="ERR WNW" id="customDateErr">'+ZPI18N.getString("zp.holiday.datefromtoerror")+"</div>"),!1}if("completed"===mode&&(sDate==TOMORROW||sDate==NEXT_7_DAYS))return pageId.find("#datePicker").parent().append('<div class="ERR WNW" id="customDateErr">'+ZPI18N.getString("zp.entervalidperiod")+"</div>"),!1}return!0},appendDataInHead:function(data){var pageId=$("#"+AutomationCommon.getCurrentPageId()),listTable="";0==pageId.find(".IC-rou-tik").length?(pageId.find("#myChecklistTable").html(""),0==data.length?listTable='<div class="col-lg-12 text-center"><div class="PArds"></div><h2 class="ZPNdt">'+ZPI18N.getString("zp.nochecklistassigned")+"</h2></div>":(listTable='<div class="table-responsive"><table class="table table-hover"><thead><tr><th width="70"></th><th width="35%"><span >'+ZPI18N.getString("zp.tasks")+'</span></th><th  width="20%">'+ZPI18N.getString("zp.initiatedby")+"</th><th>"+ZPI18N.getString("zp.formname")+"</th>",listTable+='<th width="20%">'+ZPI18N.getString("zp.status")+"</th></tr></thead><tbody>",listTable+=ZPChecklist.constructList(data)+"</tbody></table></div>"),pageId.find("#myChecklistTable").append(listTable),ZPChecklist.setup()):(listTable=ZPChecklist.constructList(data),listTable=ZPChecklist.regClickEvents($(listTable)),pageId.find("#myChecklistTable").find("tbody").append(listTable)),data.length==CHECKLIST_REC_PERPAGE&&ZPeople.FireScroll.reset()},constructList:function(data){var listTable="",tickColor="",status="",onClick="",endDate="",relatedRecordOwnerName="",employeePhoto="",deptName="",relatedRecordOwnerErecno="",empId="";return void 0==ZPeople.EMP_FORMID&&(ZPeople.EMP_FORMID=data[0].employeeFormId),$.each(data,function(){status=ZPChecklist.getStatus(this.isCompleted,this.isOverDue,this.endDate),this.isCompleted?(tickColor="grn",onClick="",endDate=this.actualEndTime,status+=" "+endDate):(tickColor="gry",onClick="onclick=ZPChecklist.changeStatus('"+this.checkItemDataId+"')",endDate=this.endDate),void 0!=this.related_recordOwnerDetails&&void 0!=this.related_recordOwnerDetails.employeePhoto?(employeePhoto=this.related_recordOwnerDetails.employeePhoto,deptName=void 0!=(deptName=ZPeople.getUserDetailsById(this.related_recordOwnerDetails.erecno).deptName)?", "+deptName:"",empId=this.related_recordOwnerDetails.employeeID,relatedRecordOwnerName=this.related_recordOwnerDetails.name,relatedRecordOwnerErecno=this.related_recordOwnerDetails.erecno):(employeePhoto=this.recordOwnerDetails.employeePhoto,deptName=void 0!=(deptName=ZPeople.getUserDetailsById(this.recordOwnerDetails.erecno).deptName)?", "+deptName:"",empId=this.recordOwnerDetails.employeeID,relatedRecordOwnerName=this.recordOwnerDetails.name,relatedRecordOwnerErecno=this.recordOwnerDetails.erecno),listTable+='<tr><td><span id="checkSpan_'+this.checkItemDataId+'" class="IC-rou-tik '+tickColor+' S20 ML20 ZPtitle" title="Task Success" '+onClick+"></span></td>",listTable+='<td><div class="FL MR10"data-toggle="tooltip" data-placement="top" data-original-title="'+empId+" - "+relatedRecordOwnerName+'"><img src="'+employeePhoto+'" class="Usrimg MT5" /></div><div class="tragcont PL0"><a class="lnk" data-target="#myClTaskComment" data-toggle="modal" name="commentlink" checkitemdataid=\''+this.checkItemDataId+"'>"+this.displayName+"</a>",listTable+="<p>"+empId+' - <a class="lnk" name="record" formid=\''+ZPeople.EMP_FORMID+"' recordid='"+relatedRecordOwnerErecno+"'>"+relatedRecordOwnerName+"</a>"+deptName+"</p></div></td>",listTable+='<td><p><a class="lnk" name="record" formid=\''+ZPeople.EMP_FORMID+"' recordid='"+this.recordOwnerDetails.erecno+"'>"+this.recordOwnerDetails.name+"</a></p></td>",listTable+='<td><a name="record" formid=\''+this.checklist.formId+"' recordid='"+this.checklist.recordId+"'>"+this.checklist.formName+"</a></td>",listTable+='<td name="status">'+status+"</td></tr>"}),listTable},isCustomDate:function(){var pageId=$("#"+AutomationCommon.getCurrentPageId());pageId.find("#datePicker").val()==CUSTOM_DATE?pageId.find("#customDatePicker").removeClass("DN"):pageId.find("#customDatePicker").addClass("DN")},getStatus:function(isCompleted,isOverDue,endDate){var status="";if(isCompleted)status='<div class="grn">'+ZPI18N.getString("zp.completed")+'</div> <span class="gry"> '+ZPI18N.getString("zp.on")+"</span>";else{var statusMsg=isOverDue?"zp.overdue":"zp.inprogress",dueDateMsg=isOverDue?"zp.wasdueon":"zp.dueon";status='<div class="'+(isOverDue?"red":"org")+'">'+ZPI18N.getString(statusMsg)+"</div> <span>"+ZPI18N.getString(dueDateMsg)+" "+endDate+"</span>"}return status},commentSlide:function(checkItemDataId){var pageId=$("#"+AutomationCommon.getCurrentPageId());pageId.find("#assignedToList").html("");var params={checkItemDataId:checkItemDataId,method:"getComments",conreqcsr:csrfToken};$.post("/getChecklistComments.zp",params,function(data){var employeePhoto="",empId="",relatedRecordOwnerName="";void 0!=data[0].related_recordOwnerDetails&&void 0!=data[0].related_recordOwnerDetails.employeePhoto?(employeePhoto=data[0].related_recordOwnerDetails.employeePhoto,empId=data[0].related_recordOwnerDetails.employeeID,relatedRecordOwnerName=data[0].related_recordOwnerDetails.name):(employeePhoto=data[0].recordOwnerDetails.employeePhoto,empId=data[0].recordOwnerDetails.employeeID,relatedRecordOwnerName=data[0].recordOwnerDetails.name);data[0].isCompleted?data[0].actualEndTime:data[0].endDate;var checkitemDetail='<div class="FL MR10"data-toggle="tooltip" data-placement="top" data-container="body" data-original-title="'+empId+" - "+relatedRecordOwnerName+'"><img src="'+employeePhoto+'" class="Usrimg FL MR10 ML5" /></div><div class="tragcont"><div class="S16">'+data[0].displayName+"</div></div>",taskOwners="",rowIndex=0;data[0].actualEndTime=void 0==data[0].actualEndTime?"":data[0].actualEndTime,pageId.find("#commentSlideHead").find("h6").text(ZPeople.decodeTxt(data[0].checklist.checklistName)),pageId.find("#commentSlideHead").attr("checkid",data[0].checkItemDataId),pageId.find("#checkitemDetail").html(checkitemDetail),pageId.find("#checklistFormName").attr("formid",data[0].checklist.formId),pageId.find("#checklistFormName").attr("recordid",data[0].checklist.recordId),pageId.find("#checklistInitiatedBy").text(ZPeople.decodeTxt(data[0].recordOwnerDetails.name)),pageId.find("#checklistInitiatedOn").html(data[0].startDate),pageId.find("#checklistTriggeredOn").html(ZPI18N.getString(ZPChecklist.triggerAction(data[0])));var closedByImg=void 0!=data[0].closeBy?'<img class="Usrimg FL MR10 MT5" src="'+data[0].closeBy.employeePhoto+'">':"";pageId.find("#checkitemDetail").siblings("th").html(closedByImg+ZPChecklist.getStatus(data[0].isCompleted,data[0].isOverDue,data[0].endDate)+" "+data[0].actualEndTime),pageId.find("#checklistFormName").text(ZPeople.decodeTxt(data[0].checklist.formName)),pageId.find("#checklistTaskOwner").children().attr("style","display:none").removeAttr("visible").find("[name=taskOwner]").html(""),$.each(data[0].taskOwners,function(taskOwner,row){taskOwners="",0!=this.length&&($.each(row,function(index,assignedTo){""!=taskOwners&&(taskOwners+=","),taskOwners+=" "+assignedTo.value}),$(pageId.find("#checklistTaskOwner").children()[rowIndex]).show().attr("visible","true").attr("class","form-group").find("span").last().html(taskOwners)),rowIndex++}),pageId.find("#checklistTaskOwner").children("[visible=true]").last().removeAttr("class"),pageId.find("#commentHead").siblings().remove(),$.each(data[0].comments,function(index,commentDtl){comments=pageId.find("#commentBodyDummy").cloneRow("#checklistComments"),comments.find("b").text(ZPeople.decodeTxt(commentDtl.name)),comments.find("img").attr("src",commentDtl.employeePhoto),comments.find("p").text(commentDtl.comment),comments.find("span").text(commentDtl.createdTime)});var commentHeadMsg="",commentsCount=data[0].comments.length;0==commentsCount?(commentHeadMsg=ZPI18N.getString("zp.comment"),pageId.find("#commentHead").find("a").attr("expanded",!0)):commentsCount<=3?(commentHeadMsg=ZPI18N.getString("zp.viewingallcomments",[commentsCount]),pageId.find("#commentHead").find("a").attr("expanded",!0)):(commentHeadMsg=ZPI18N.getString("zp.viewallcomments",[commentsCount]),$("#commentHead").siblings().slice(0,commentsCount-3).hide(),pageId.find("#commentHead").find("a").attr("expanded",!1)),pageId.find("#commentHead").find("a").text(commentHeadMsg),pageId.find("#commentHead").find("a").attr("count",commentsCount),pageId.find("div.modal-footer").find("img").attr("src",ZPeople.CURR_USER.avatar),pageId.find("#myClReqComment").modal("show"),$($(".modal-backdrop")[0]).siblings(".modal-backdrop").remove()})},viewAllComments:function(getThis){0!=$("#"+AutomationCommon.getCurrentPageId()).find("#commentHead").siblings().length&&($(getThis).text(ZPI18N.getString("zp.viewingallcomments",[$(getThis).attr("count")])),$(getThis).attr("expanded",!0),$(getThis).parent().parent().siblings().show())},viewRecord:function(formId,pkId){$($(".modal-backdrop")[0]).remove(),$("#"+AutomationCommon.getCurrentPageId()).find("#rootTaskTriggerDtlsPage").remove(),$("#"+AutomationCommon.getCurrentPageId()).find("#myClReqComment").remove(),ZPACommon.viewRecord(formId,pkId),ZPChecklist.setup()},changeStatus:function(dataId){var currentRow=$("#checkSpan_"+dataId).closest("tr"),params={dataid:dataId,method:"completeTask",conreqcsr:csrfToken};$.post("/changeCheckitemStatus.zp",params,function(data){"success"==data&&($("#checkSpan_"+dataId).removeClass("gry").addClass("grn").removeAttr("onclick"),currentRow.find("[name=status]").html(ZPChecklist.getStatus("true")+" "+ZPI18N.getString("zp.today")))})},triggerInfo:function(obj){var triggerDetail="";if(void 0!=obj.workflowdetails)switch(obj.workflowdetails.action){case WF_ACTION_ADD:triggerDetail="zp.triggermessageadd";break;case WF_ACTION_EDIT:triggerDetail="zp.triggermessageedit";break;case WF_ACTION_DELETE:triggerDetail="zp.triggermessagedelete";break;case WF_ACTION_APPROVE:triggerDetail="zp.triggermessageapprove";break;case WF_ACTION_REJECT:triggerDetail="zp.triggermessagereject";break;case WF_ACTION_ADDOREDIT:triggerDetail="zp.triggermessageaddoredit";break;case WF_ACTION_FIELDVALUECHANGE:triggerDetail="zp.triggermessagefieldvalue";break;case WF_ACTION_REMINDER:triggerDetail="zp.triggermessageremainder"}else triggerDetail="zp.triggermessageadd";return triggerDetail},triggerAction:function(obj){var triggerDetail="";if(void 0!=obj.workflowdetails)switch(obj.workflowdetails.action){case WF_ACTION_ADD:triggerDetail="zp.create";break;case WF_ACTION_EDIT:triggerDetail="zp.edit";break;case WF_ACTION_DELETE:triggerDetail="zp.delete";break;case WF_ACTION_APPROVE:triggerDetail="zp.approved";break;case WF_ACTION_REJECT:triggerDetail="zp.rejected";break;case WF_ACTION_ADDOREDIT:triggerDetail="zp.workflow.createoredit";break;case WF_ACTION_FIELDVALUECHANGE:triggerDetail="zp.fieldupdates";break;case WF_ACTION_REMINDER:triggerDetail="zp.date"}else triggerDetail="zp.workflow.createoredit";return triggerDetail},filterChanges:function(thisObj){var pageId=$("#"+AutomationCommon.getCurrentPageId());$(thisObj).toggleClass("active");var filterObj=pageId.find("div#filterSec");pageId.find("div.ZPcontwrap").hasClass("open")?(pageId.find("div.ZPcontwrap").removeClass("open"),filterObj.removeClass("in"),filterObj.addClass("hide")):(pageId.find("div.ZPcontwrap").addClass("open"),filterObj.addClass("in"),filterObj.fadeIn("slow"),filterObj.removeClass("hide"))},saveComment:function(getThis){var textArea=$(getThis).parent().parent().find("textarea"),params={checkid:$("#"+AutomationCommon.getCurrentPageId()).find("#commentSlideHead").attr("checkid"),notes:textArea.val(),conreqcsr:csrfToken};$.post("/AddChecklistComment.zp",params,function(data){ZPChecklist.newComment(textArea.val()),textArea.val("")})},newComment:function(comment){var pageId=$("#"+Layout.Page.pageId),newRow=pageId.find("#commentBodyDummy").clone();pageId.find("#taskCommentBox").before(newRow);var count=parseInt(pageId.find("#cmtCount").attr("count"))+1,isExpanded=pageId.find("#commentHead").find("a").attr("expanded");newRow.attr("id","taskcomment").removeAttr("style"),newRow.find("b").text("Me"),newRow.find("p").text(comment),newRow.find("span").text(ZPI18N.getString("zp.today")),newRow.find("img").attr("src",ZPeople.CURR_USER.avatar),pageId.find("#commentHead").find("a").attr("count",count),pageId.find("#commentSlideBody").animate({scrollTop:pageId.find("#checklistComments").find(".media").last().position().top}),$.parseJSON(isExpanded)?pageId.find("#commentHead").find("a").text(ZPI18N.getString("zp.viewingallcomments",[count])):pageId.find("#commentHead").find("a").text(ZPI18N.getString("zp.viewallcomments",[count]))},getMyChecklistReqData:function(){var pageId=$("#"+AutomationCommon.getCurrentPageId()),formId=pageId.find("#myChecklistReqComboBox").val(),params={mode:pageId.find("#myReqStatusCombo").val(),method:"getMyChecklistReq",conreqcsr:csrfToken};0!=formId&&(params.formId=formId);var url="";if(isadmin||isOperationalRoleAdmin?(url="/getAdminChecklistReq.zp",params.method="getAdminChecklistReq",params.erecno=pageId.find("#checklistReqEmployeeCombo").val()):(url="/getMyChecklistReq.zp",params.method="getMyChecklistReq"),0==pageId.find("#myChecklistReqTable").find("tbody").children().length&&ZPACommon.showEmptyListPage("pageloading"),params.index=$("#myChecklistReqTable").find("tbody").children().length+1,pageId.find("#dvFiltersec").is(":visible")&&(params.searchString=pageId.find("#taskSearchString").val(),params.sDate=pageId.find("#datePicker").val(),params.sDate==CUSTOM_DATE)){var dateStr=pageId.find("#customDatePicker").find("input").val(),dates=ZPChecklist.splitFromToDate(dateStr);if(void 0==dates.from||void 0==dates.to||!Calendar.isvalidDate(dates.from)||!Calendar.isvalidDate(dates.to))return pageId.find("#customDatePicker").append('<div class="ERR WNW">'+ZPI18N.getString("zp.selectfromandto")+"</div>"),void pageId.find("#myChecklistReqTable").html("").append('<div class="col-lg-12 text-center"><div class="PArds"></div><h2 class="ZPNdt">'+ZPI18N.getString("zp.checklistnottriggered")+"</h2></div>");if(Calendar.parseDate(dates.from,uidateFormat)>Calendar.parseDate(dates.to,uidateFormat))return pageId.find("#customDatePicker").append('<div class="ERR WNW">'+ZPI18N.getString("zp.holiday.datefromtoerror")+"</div>"),void pageId.find("#myChecklistReqTable").html("").append('<div class="col-lg-12 text-center"><div class="PArds"></div><h2 class="ZPNdt">'+ZPI18N.getString("zp.checklistnottriggered")+"</h2></div>");params.sDate=dates.from,params.eDate=dates.to}ZPeople.Request.send(url,params,ZPChecklist.appendToCheckReqHead)},resetChecklistReqPage:function(){$(".ERR").remove(),ZPChecklist.isValidChecklistFilter()&&($("#"+AutomationCommon.getCurrentPageId()).find("#myChecklistReqTable").html(""),ZPChecklist.getMyChecklistReqData())},isValidChecklistFilter:function(){var pageId=$("#"+AutomationCommon.getCurrentPageId());if(pageId.find("#dvFiltersec").is(":visible")&&pageId.find("#datePicker").val()==CUSTOM_DATE){var dateStr=pageId.find("#customDatePicker").find("input").val(),dates=ZPChecklist.splitFromToDate(dateStr);if(void 0==dates.from||void 0==dates.to||!Calendar.isvalidDate(dates.from)||!Calendar.isvalidDate(dates.to))return pageId.find("#customDatePicker").append('<div class="ERR WNW">'+ZPI18N.getString("zp.selectfromandto")+"</div>"),!1;if(Calendar.parseDate(dates.from,uidateFormat)>Calendar.parseDate(dates.to,uidateFormat))return pageId.find("#customDatePicker").append('<div class="ERR WNW">'+ZPI18N.getString("zp.holiday.datefromtoerror")+"</div>"),!1}return!0},appendToCheckReqHead:function(data){var pageId=$("#"+AutomationCommon.getCurrentPageId()),listTable="";0==pageId.find("#myChecklistReqTable").find("tbody").children().length?(pageId.find("#myChecklistReqTable").html(""),0==data.length?listTable='<div class="col-lg-12 text-center"><div class="PArds"></div><h2 class="ZPNdt">'+ZPI18N.getString("zp.checklistnottriggered")+"</h2></div>":(listTable='<div class="table-responsive"><table class="table table-hover"><thead><thead><tr><th width="20"></th>',listTable+="<th><span>"+ZPI18N.getString("zp.workflow.checklist")+'</span></th><th width="32%">'+ZPI18N.getString("zp.status")+"</th></tr></thead><tbody>",listTable+=ZPChecklist.constructMyChecklistReq(data)+"</tbody></table>"),pageId.find("#myChecklistReqTable").append(listTable),ZPChecklist.setup()):(listTable=ZPChecklist.constructMyChecklistReq(data),listTable=ZPChecklist.regClickEvents($(listTable)),pageId.find("#myChecklistReqTable").find("tbody").append(listTable)),data.length==CHECKLIST_REC_PERPAGE&&ZPeople.FireScroll.reset()},constructMyChecklistReq:function(data){var listTable="",triggerDetail="",status="",employeePhoto="",empId="",relatedRecordOwnerName="";return $.each(data,function(){void 0!=this.related_recordOwnerDetails&&void 0!=this.related_recordOwnerDetails.employeePhoto?(employeePhoto=this.related_recordOwnerDetails.employeePhoto,empId=this.related_recordOwnerDetails.employeeID,relatedRecordOwnerName=this.related_recordOwnerDetails.name):(employeePhoto=this.recordOwnerDetails.employeePhoto,empId=this.recordOwnerDetails.employeeID,relatedRecordOwnerName=this.recordOwnerDetails.name),status=this.isCompleted?'<div class="grn">'+ZPI18N.getString("zp.completed")+"</div>":'<div class="org">'+ZPI18N.getString("zp.inprogress")+"</div>",triggerDetail=ZPChecklist.getMyreqTriggerInfo(this),listTable+='<tr><td></td><td><div class="FL MR10"data-toggle="tooltip" data-placement="top" data-container="body" data-original-title="'+empId+" - "+relatedRecordOwnerName+'"><img src="'+employeePhoto+'" class="Usrimg FL MR10 MT5" /></div><div class="tragcont PL0"><a class="lnk ZPbold S15" checkrootid='+this.checkItemRootId+" recordid="+this.recordId+' data-toggle="modal">'+this.checklistName+"</a>",listTable+='<p class="S13">'+triggerDetail+"</p>",listTable+="</div></td><td>"+status+"</td></tr>"}),listTable},getChecklistsForRecord:function(recordId,formId){void 0===recordId&&(recordId=ZPForm.CURRFORM_PARAM.recordId,formId=ZPForm.CURRFORM_PARAM.formId);var pageId=$("#"+AutomationCommon.getCurrentPageId());pageId.find("#rootTaskTriggerDtlsPage").is(":visible")||ZPChecklist.setup(),pageId.find("#zp_addedit_record_"+formId).remove();var rootTaskPage=pageId.find("#rootTaskTriggerDtlsPage");$(rootTaskPage.find("#checkrootList").children(0)).show(),rootTaskPage.find("#checkrootList").children().remove(),$(rootTaskPage.find("#checkrootList").children(0)).hide();var params={method:"getCheckItemRootDetails",recordId:recordId,conreqcsr:csrfToken};$.post("/getCheckitemRootDetails.zp",params,function(data){if(0!==data.length)$.each(data,function(index,checklistRoot){var checkroot=ZPChecklist.constructChecklistRoot(checklistRoot);ZPChecklist.regClickEvents(checkroot)}),rootTaskPage.find("#checkrootList").children().click(function(){$(this).siblings().find(".collapse.in").parent().children().find("tr").click(),Task.getCheckRootTasks(this)}),$(rootTaskPage.find("#checkrootList").children()[0]).find("tr").click(),$(rootTaskPage.find("#checkrootList").children()[0]).children().attr("class","dvchkhead");else{var placeToAppend=$("#"+AutomationCommon.getCurrentPageId()).find("div.modal-body:visible#checkrootList");placeToAppend.children().hide(),placeToAppend.append('<div class="ZPNdata"><div id="nochecklist"></div><p class="no-para">'+ZPI18N.getString("zp.nochecklistsassociated")+"</p></div>");var noDataSvg=ZPeople.getResourceURL(newUIImageUrl+"svg/no-records.svg");ZPUtil.noDataSVG("nochecklist",noDataSvg)}rootTaskPage.modal({backdrop:"static"}),$($(".modal-backdrop")[1]).remove()}),ZPForm.CURRFORM_PARAM.recordId=recordId,ZPForm.CURRFORM_PARAM.formId=formId,$("#"+AutomationCommon.getCurrentPageId()).find("#rootClose").click(function(){$(".modal-backdrop").remove(),ZPACommon.viewRecord(formId,recordId,"",!0)})},checklistTriggerData:function(getThis){var pageId=$("#"+AutomationCommon.getCurrentPageId()),rootTaskPage=pageId.find("#rootTaskTriggerDtlsPage");0===rootTaskPage.length&&(pageId.append(ZPChecklist.CHECKITEMROOT_TEMPLATE),rootTaskPage=pageId.find("#rootTaskTriggerDtlsPage")),rootTaskPage.modal({backdrop:"static"}),pageId.find("#checkrootList").children().remove();var rootDetail=$(getThis).parent().parent().parent().clone(),currentCheckroot=$($("#"+AutomationCommon.getCurrentPageId()).find("#rootTaskTriggerDtlsPage").find("#checkrootList").siblings(".row")).clone().cloneRow("#checkrootList");currentCheckroot.find("tr").replaceWith(rootDetail),currentCheckroot.attr("id","taskRootDiv"),rootTaskPage.find("#taskRootDiv").attr("checkrootid",$(getThis).attr("checkrootid")),Task.getCheckRootTasks(rootTaskPage.find("#taskRootDiv"),!0)},constructChecklistRoot:function(data){var status=data.checklist.isCompleted?'<div class="grn">'+ZPI18N.getString("zp.completed")+'</div><span class="gry"> '+ZPI18N.getString("zp.on")+"</span> "+data.checklist.endTime:'<div class="org">'+ZPI18N.getString("zp.inprogress")+"</div>",recordOwnerDetails=data.recordOwnerDetails,checklistDisplayName=data.checklist.checklistName;data.isCommentSlide=!0;var triggerInfo=ZPI18N.getString(ZPChecklist.triggerInfo(data),["",'<a name="record" onclick="ZPChecklist.viewRecord(\''+data.checklist.formId+"', '"+data.checklist.recordId+"')\">"+data.checklist.formName+"</a>"]),currentCheckroot=$($("#"+AutomationCommon.getCurrentPageId()).find("#rootTaskTriggerDtlsPage").find("#checkrootList").siblings(".row")).clone().cloneRow("#checkrootList"),employeePhoto="",empId="",empName="";return void 0!=data.related_recordOwnerDetails&&void 0!=data.related_recordOwnerDetails.employeePhoto?(employeePhoto=data.related_recordOwnerDetails.employeePhoto,empId=data.related_recordOwnerDetails.employeeID,empName=data.related_recordOwnerDetails.name):(employeePhoto=recordOwnerDetails.employeePhoto,empId=recordOwnerDetails.employeeID,empName=recordOwnerDetails.name),currentCheckroot.attr("checkRootId",data.checklist.checkItemRootId),currentCheckroot.attr("recordId",data.checklist.recordId),currentCheckroot.find("#taskClName").text(ZPeople.decodeTxt(checklistDisplayName)),currentCheckroot.find("#taskOwnerImg").attr("src",employeePhoto),currentCheckroot.find("#taskOwnerImg").parent().attr("data-original-title",empId+" - "+ZPeople.decodeTxt(empName)),currentCheckroot.find("#rootStatus").html(status),currentCheckroot.find("#myReqTriggerInfo").html(triggerInfo),currentCheckroot.find("#taskForm").text(data.formName),currentCheckroot},getChecklistItem:function(getThis,callback){var checklistId=$(getThis).attr("checkrootId"),pageId=$("#"+AutomationCommon.getCurrentPageId());if(0==pageId.find("#taskRootDiv_"+checklistId).length||callback){var recordId=$(getThis).attr("recordId");$(getThis).attr("id","taskRootDiv_"+checklistId),$(getThis).find("tr").find("#taskClName").addClass("CP").attr("data-target","#taskDtlsDiv_"+checklistId),$(getThis).find("#taskDtlsDiv").attr("id","taskDtlsDiv_"+checklistId);var params={method:"getChecklistTriggerData",recordId:recordId,checklistId:checklistId,conreqcsr:csrfToken};$.ajax({url:"/getClTriggerData.zp",type:"POST",data:params,success:function(data){void 0!=data.checklist&&(ZPChecklist.taskParentDtls=data,1==callback?(pageId.find("#checkrootList").children().remove(),getThis=ZPChecklist.constructChecklistRoot(ZPChecklist.taskParentDtls),$.each(data.parentDtls[0],function(index,parentTaskId){$(getThis).find("ul").append(ZPChecklist.taskDtlsRecursion(parentTaskId)),ZPChecklist.regClickEvents($(getThis))})):$.each(data.parentDtls[0],function(index,parentTaskId){$(getThis).find("#taskDtlsDiv_"+checklistId).find("ul").append(ZPChecklist.taskDtlsRecursion(parentTaskId))}))}})}},taskDtlsRecursion:function(taskItemId){var taskParentDtls=ZPChecklist.taskParentDtls.parentDtls,checklistItemDtls=ZPChecklist.taskParentDtls.checklistItem[taskItemId],taskChildArray=taskParentDtls[taskItemId],li=ZPChecklist.getTaskDtlsRecHtml(checklistItemDtls);if(void 0===taskChildArray)return li;var parentDiv=li.append($("<ul>",{parentTask:taskItemId}));return $.each(taskChildArray,function(index,childTaskItem){parentDiv.find("ul[parentTask='"+taskItemId+"']").append(ZPChecklist.taskDtlsRecursion(childTaskItem))}),parentDiv},getTaskDtlsRecHtml:function(checklistItemDtls){var action=ZPI18N.getString("zp.chkyettostart"),statusColor="org",process="",date="",li="",isValidChecklistItem=!0;if(!0===checklistItemDtls.isCompleted?(1,action=ZPI18N.getString("zp.completed"),process=ZPI18N.getString("zp.on"),date=checklistItemDtls.actualEndTime,statusColor="grn"):!1===checklistItemDtls.isCompleted?(0,!0===checklistItemDtls.isOverDue?(action=ZPI18N.getString("zp.overdue"),statusColor="red",process=ZPI18N.getString("zp.wasdueon")):(action=ZPI18N.getString("zp.chkinprogress"),statusColor="org",process=ZPI18N.getString("zp.dueon")),date=checklistItemDtls.endDate):void 0==checklistItemDtls.parentCheckItemId||0==checklistItemDtls.parentCheckItemId?isValidChecklistItem=!1:void 0!=checklistItemDtls.parentCheckItemId&&(isValidChecklistItem=!ZPChecklist.taskParentDtls.checklistItem[checklistItemDtls.parentCheckItemId].isCompleted),isValidChecklistItem){var cmtlink="";void 0!=checklistItemDtls.checkItemDataId&&(cmtlink='name="cmtlink" checkitemdataid=\''+checklistItemDtls.checkItemDataId+"'");var col1='<div class="collst1"> <div class="PT10 PL15"><a  class="lnk" '+cmtlink+">"+checklistItemDtls.displayName+"</a></div></div>",col3='<div class="collst3"> <div class="PT5 PB3 '+statusColor+'">'+action+'</div><span class="gry">'+process+"</span> "+date+" </div>";(li=$("<li>",{id:checklistItemDtls.checklistItemId})).append(col1,'<div class="collst2"></div>',col3),li.find("[name=cmtlink]").click(function(){ZPChecklist.commentSlide($(this).attr("checkitemdataid"))})}return li},getMyreqTriggerInfo:function(obj){var triggerDetail="";if(void 0!=obj.workflowdetails)switch(obj.workflowdetails.action){case WF_ACTION_ADD:triggerDetail="zp.triggerreqmessageadd";break;case WF_ACTION_EDIT:triggerDetail="zp.triggerreqmessageedit";break;case WF_ACTION_DELETE:triggerDetail="zp.triggerreqmessagedelete";break;case WF_ACTION_APPROVE:triggerDetail="zp.triggerreqmessageapprove";break;case WF_ACTION_REJECT:triggerDetail="zp.triggerreqmessagereject";break;case WF_ACTION_ADDOREDIT:triggerDetail="zp.triggerreqmessageaddoredit";break;case WF_ACTION_FIELDVALUECHANGE:triggerDetail="zp.triggerreqmessagefieldvalue";break;case WF_ACTION_REMINDER:triggerDetail="zp.triggerreqmessageremainder"}else triggerDetail="zp.triggerreqmessageadd";return ZPI18N.getString(triggerDetail,['<a name="record" formid=\''+obj.formId+"' recordid='"+obj.recordId+"'>"+obj.formName+"</a>",obj.startDate])},setup:function(){$("#"+AutomationCommon.getCurrentPageId()).append(ZPChecklist.CHECKITEMROOT_TEMPLATE),ZPChecklist.regClickEvents()},regClickEvents:function(obj){return(obj=void 0==obj?$("#"+AutomationCommon.getCurrentPageId()):obj).find("[name=record]").click(function(){ZPChecklist.viewRecord($(this).attr("formid"),$(this).attr("recordid"))}),obj.find("[name=commentlink]").click(function(){ZPChecklist.commentSlide($(this).attr("checkitemdataid"))}),obj.find("a[checkrootid]").click(function(){ZPChecklist.checklistTriggerData(this),ZPChecklist.rootLink=this}),obj}};criteria={criteriaJson:{},getCriteriaRowHtml:function(){},cloneCrt:function(mode,index){var clone=$("#crtBody").find("#crtRowTemplate").clone();return $(clone).attr("id",""),clone},addSingleCriteria:function(obj){$("#crtRowTemplate").after(criteria.cloneCrt("approval",1))}};var DataAdministration={init:function(){var url,mode;"#admin/dataadministration/importHistory"===Layout.Page.hash?(url="/importHistory.zp",mode="Import_History"):"#admin/dataadministration/exportHistory"===Layout.Page.hash&&(url="/exportHistory.zp",mode="Export_History"),void 0!==url&&(Layout.Page.container.html(ZPeople.LOADING_HTML),ZPeople.Request.send(url,{mode:mode},DataAdministration.responseHandler))},getImportDataTemplate:function(data){var tmpl="";return 0===data.length?tmpl='<div class="dvDataadmin"><div class="mainhead"><div class="row"><div class="col-md-6"><div class="col-md-12 PT5">'+ZPI18N.getString("zp.importNote")+'</div></div><div class="col-md-6 text-right"> <a class="pagetips"><span class="IC-qus"></span></a></div></div></div><div id="importHistoryNoData" class="ZPTscrlcont"></div>':(tmpl='<div id="importHistory" class="dvDataadmin"><div class="mainhead"><div class="row"><div class="col-md-6"><div class="col-md-12 PT5">'+ZPI18N.getString("zp.importNote")+'</div></div><div class="col-md-6 text-right"></div></div></div><div class="ZPTscrlcont"><table class="table table-hover table-bordered table-responsive"><thead><tr><th width="20%" rowspan="2"><span class="ML20">'+ZPI18N.getString("zp.formname")+'</span></th><th rowspan="2"><span>'+ZPI18N.getString("zp.importBy")+'</span></th><th rowspan="2"><span>'+ZPI18N.getString("zp.dateofImport")+'</span></th><th width="15%" rowspan="2"><span>'+ZPI18N.getString("zp.filename")+'</span></th><th class="text-center" colspan="3"><span>'+ZPI18N.getString("zp.recordStatistics")+'</span></th></tr><tr><th class="text-center">'+ZPI18N.getString("zp.added")+'</th><th class="text-center">'+ZPI18N.getString("zp.updated")+'</th><th class="text-center">'+ZPI18N.getString("zp.skiped")+"</th></tr><tbody>",$.each(data,function(){if(tmpl+='<tr><td><div class="ML20"><span class="txttrim">'+ZSEC.Encoder.encodeForHTML(this.importform)+"</span></div></td><td>"+DataAdministration.getEmployeeLink(this)+"</td><td><span>"+this.importdate+'</span></td><td><span class="txttrim">'+ZSEC.Encoder.encodeForHTML(this.fileName)+"</span></td><td><span >"+this.addedCount+"</span></td><td><span>"+this.updatedCount+"</span></td>",null!=this.importID){var onclick,downloadParams={impId:this.importID};onclick=1==isPreviewAllowed?"Layout.Page.pageContWrapper.parent().prepend(Files.constructViewDiv(this,'Forms','"+encodeURIComponent(JSON.stringify(downloadParams))+"'));Files.viewFile(this,'Forms','"+encodeURIComponent(JSON.stringify(downloadParams))+"')":"window.open('"+ZPForm.constructDownloadLink(downloadParams)+"');",tmpl+='<td><a filepath="'+this.importID+'" filename="'+ZSEC.Encoder.encodeForHTML(this.fileName)+'" onclick="'+onclick+'" href="javascript:;">'+this.skipedCount+"</a></td></tr>"}else tmpl+="<td><span>"+this.skipedCount+"</span></td></tr>"}),tmpl+="</tbody></table></div></div></div></div></div>"),tmpl},getExportDataTemplate:function(data){var tmpl="";return 0===data.length?tmpl='<div class="dvDataadmin"><div class="mainhead"><div class="row"><div class="col-md-6"><div class="col-md-12 PT5">'+ZPI18N.getString("zp.exportNote")+'</div></div><div class="col-md-6 text-right"></div></div></div><div id="exportHistoryNoData" class="ZPTscrlcont"></div>':(tmpl='<div class="dvDataadmin"><div class="mainhead"><div class="row"><div class="col-md-6"><div class="col-md-12 PT5">'+ZPI18N.getString("zp.exportNote")+'</div></div><div class="col-md-6 text-right"> <a class="pagetips"><span class="IC-qus"></span></a> </div></div></div><div class="ZPTscrlcont"><table class="table table-hover table-responsive"><thead><tr><th width="20%"><span class="ML20">'+ZPI18N.getString("zp.formname")+'</span></th><th width="27%"><span>'+ZPI18N.getString("zp.exportedBy")+"</span></th><th><span>"+ZPI18N.getString("zp.dateOfExport")+"</span></th><th><span>"+ZPI18N.getString("zp.noofrecord")+"</span></th></tr></thead><tbody><tr>",$.each(data,function(){tmpl+='<tr><td><div class="ML20"><span class="txttrim">'+ZSEC.Encoder.encodeForHTML(this.exportform)+"</span></div></td><td>"+DataAdministration.getEmployeeLink(this)+"</td><td><span>"+this.exportdate+"</span></td><td><span >"+this.RecordCount+"</span></td></tr>"}),tmpl+="</tbody></table></div></div></div></div></div></div></div>"),tmpl},responseHandler:function(data,param){"Import_History"===param.mode?(Layout.Page.container.html(DataAdministration.getImportDataTemplate(data)),0===data.length&&ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.noimport"),$("#importHistoryNoData"),"","")):"Export_History"===param.mode&&(Layout.Page.container.html(DataAdministration.getExportDataTemplate(data)),0===data.length&&ZPUtil.newNoDataHTML("CR-nodata",6,ZPI18N.getString("zp.noexport"),$("#exportHistoryNoData"),"",""))},getEmployeeLink:function(data){let tmp="";return tmp=data.empIsActive?data.employeeStatus?"<a onclick=\"ZPeople.getUserPage('"+data.erecno+"')\">"+ZSEC.Encoder.encodeForHTML(data.name)+"</a>":"<b>"+ZSEC.Encoder.encodeForHTML(data.name)+"</b>":ZPI18N.getString("zp.unknownuser")}},ActivityLog={NoData:ZPUtil.newNoDataHTML("CR-nofeeds",8,ZPI18N.getString("zp.nologsfound"),"","",""),actLogsStartIndex:0,actLogsParam:{},type:{FORM_CUSTOMISATION:2,FORM_RECORD_OPERATION:3,ONBOARDING_FORM_RECORD_OPERATION:5,SCHEDULAR:6,TRANSITION:8,SERVICE:9,FIELD:10,ROLE:11,BLUEPRINT:12,MAILMERGE:13,ZOHOSIGN:14,ADOBESIGN:15,DOCUSIGN:16,FILES:17,ONBOARDING_TYPE:18,USER_OPERATIONS:19},subType:{VIEW:1,EDIT:2,ADD:3,DELETE:4,LOCATION_TRACKING:5,BACKUP:6,STOP:7,PERM:8,USER_PERM:9,IMPORT:10,MERGE:11,SEND_DOCUMENT:12,SCHEDULE_SEND_DOCUMENT:13,SEND_REMINDER:14,CANCEL_DOCUMENT:15,SEND_COMPANY_POLICY:16,DOWNLOAD_MERGED_TEMPLATE:17,EXPORT:18,SAVE:19,CLONE:20,DOWNLOAD:21,TEMPLATE_CLONE:22,CREATE_ESIGN_TEMPLATE:23,EDIT_ESIGN_TEMPLATE:24,SEND_ESIGN_TEMPLATE:25,CREATE_ESIGNCONFIGURATION:26,DELETE_ESIGNCONFIGURATION:27,EDIT_ESIGNCONFIGURATION:28,FILES_SETTINGS:29,MOVE:30,SEND_FROM_HRFILES:31,RENAME:32,EXTEND:33,ENABLE_DISABLE:34,ONBOARDING_PROCESS:35,ONBOARDING_ACCEPT_DECLINE:36,CLIENT_PORTAL_ADD:37,CLIENT_PORTAL_EDIT:38,DELETE_ESIGN_TEMPLATE:39,SINGLE_FIELD_EDIT_OPTION_ENABLE_DISABLE:40,LOGIN_DISABLE:45,CONVERT_TO_USER:46,CONVERT_TO_NONUSER:47,RESEND_INVITATION:48,ENABLE_TO_NONUSER:49,LOGIN_ENABLE:50},formSubType:{WEB_ADD:1,API_ADD:2,MOBILE_ADD:3,MOBILE_EDIT:4,WEB_EDIT:5,API_EDIT:6,IMPORT_ADD:7,IMPORT_EDIT:8,FIELD_UPDATE:9,MAIL_SYNC:10,GAPPS_SYNC:11,O365_SYNC:12,ZDIRECTORY_SYNC:13,EMBED_ADD:14,SAMPLE_DATA_ADD:15,EXPORT:16,DELETE:17,TRANSITION_EXECUTION:18,IMPORT:19,MASS_UPDATE:20,BULK_FILE_UPLOAD:21,EMP_PHOTO_UPLOAD:22,HISTORY_EXPORT:23},hasMore:!0,hasZSlogs:!1,hasASlogs:!1,hasDSlogs:!1,searchJson:{id:"ZPaclog_filter_username",inpFormat:"select",type:1,limit:200,searchType:"emp",searchMode:"USER_SEARCH",noMatchMessage:"No Users Found",initDefaultValues:!0,alwaysShowDefOpt:!0,defaultOption:{id:0,html:ZPI18N.getString("zp.allusers"),text:ZPI18N.getString("zp.allusers"),photo:ZPeople.getResourceURL(imageUrl+"user.png")},initialSelection:{id:0,html:ZPI18N.getString("zp.allusers"),text:ZPI18N.getString("zp.allusers"),photo:ZPeople.getResourceURL(imageUrl+"user.png")}},init:function(){var formId;ActivityLog.LayoutId="#"+Layout.Page.container[0].id;var formLinkName=!1;void 0!=Layout.Page.urlparam.formId?formId=Layout.Page.urlparam.formId:void 0!=Layout.Page.urlparam.formLinkName&&(formId=Layout.Page.urlparam.formLinkName,formLinkName=!0),void 0!=formId&&void 0!=Layout.Page.urlparam.recordId?ZPApprovals.viewApprovalPopup(formId,Layout.Page.urlparam.recordId,formLinkName,Layout.Page.urlparam.mode,!1):0==Layout.Page.container.find("div[id^='ZPActLogsHead']").length&&(ActivityLog.getConfigList=!0,ActivityLog.formOptions(),ZPComponents.Search.create(ActivityLog.searchJson),$(ActivityLog.LayoutId+" select").select2(),$(ActivityLog.LayoutId).addClass("filter-wrap"),ActivityLog.getActivityLog(!1))},evaluateDateFieldFilter:function(){var headerObj=$(ActivityLog.LayoutId).find("#ZPaclog_filter_date");headerObj.removeClass("zp-err");var fromObj=$(ActivityLog.LayoutId).find(":input[id='ZPaclog_filter_date_from']"),toObj=$(ActivityLog.LayoutId).find(":input[id='ZPaclog_filter_date_to']"),obj=$(ActivityLog.LayoutId).find("#error_message_date").empty(),sDate="",eDate="",selectedOption=$(ActivityLog.LayoutId).find("#ZPaclog_filter_date_options select")[0].value;if(18==selectedOption||58==selectedOption)if(ZPUtil.Validation.isEmpty(fromObj.val()))18==selectedOption?obj.append(ZPI18N.getString("zp.emptydate",[dateFmt])):obj.append(ZPI18N.getString("zp.emptyfromdate",[dateFmt])),headerObj.addClass("zp-err");else{if((sDate=new Date(Calendar.parseDate(fromObj.val(),uidateFormat)))==ZPI18N.getString("zp.invaliddate"))return obj.append(ZPI18N.getString("zp.validinitaldateval",[dateFmt])),headerObj.addClass("zp-err"),!1;if(58==selectedOption&&(ZPUtil.Validation.isEmpty(toObj.val())?(obj.append(ZPI18N.getString("zp.emptytodate",[dateFmt])),headerObj.addClass("zp-err")):(eDate=new Date(Calendar.parseDate(toObj.val(),uidateFormat)))==ZPI18N.getString("zp.invaliddate")?(obj.append(ZPI18N.getString("zp.validinitaldateval",[dateFmt])),headerObj.addClass("zp-err")):eDate.getTime()>=ActivityLog.startTime?sDate.getTime()<=eDate.getTime()||(obj.append(ZPI18N.getString("zp.greaterfromdate")),headerObj.addClass("zp-err")):(obj.append(ZPI18N.getString("zp.entervalidrange")),headerObj.addClass("zp-err")),headerObj.hasClass("zp-err")))return!1;(sDate.getTime()>=ActivityLog.startTime||58==selectedOption)&&sDate.getTime()<=ActivityLog.endTime||(obj.append(ZPI18N.getString("zp.entervalidrange")),headerObj.addClass("zp-err"))}return!headerObj.hasClass("zp-err")},moreActivityLog:function(){ActivityLog.hasMore&&(ActivityLog.actLogsStartIndex+=25,ActivityLog.getActivityLog(!0))},throttleFunction:function(){ActivityLog.timerId||(ActivityLog.timerId=setTimeout(function(){ActivityLog.moreActivityLog(),ActivityLog.timerId=void 0},200))},getActivityLog:function(scroll){Layout.Page.container.find("#ZP_actLogsData").off("onScroll");var changedRec=ActivityLog.actLogsParam,param={mode:"Activity_Log",conreqcsr:csrfToken,getConfigList:ActivityLog.getConfigList};if(this.isSearch){var formObj=$(ActivityLog.LayoutId+" #ZPaclog_filter_formname select")[0];formObj&&""!==formObj.value&&"0"!==formObj.value&&(param.formId=formObj.value);var dateObj=$(ActivityLog.LayoutId+" #ZPaclog_filter_date_options select")[0];dateObj&&""!==dateObj.value&&"0"!==dateObj.value&&(param.optType=dateObj.value,18!=param.optType&&58!=param.optType||(param.date=$(ActivityLog.LayoutId).find(":input[id='ZPaclog_filter_date_from']").val(),58==param.optType&&(param.date=param.date+";"+$(ActivityLog.LayoutId).find(":input[id='ZPaclog_filter_date_to']").val())));var userObj=$(ActivityLog.LayoutId+"  input[name=User]")[0];userObj&&""!==userObj.value&&"0"!==userObj.value&&(param.userId=userObj.value);var actionObj=$(ActivityLog.LayoutId+" #ZPaclog_filter_actions select")[0];if(actionObj&&""!==actionObj.value&&-1!=actionObj.value){param.actionType=actionObj.value;var subActionObj=$(ActivityLog.LayoutId+" #ZPaclog_filter_sub_actions select")[0];subActionObj&&-1!=subActionObj.value&&(param.actionSubType=subActionObj.value,-2!=param.actionType&&-3!=param.actionType&&param.actionType!=ActivityLog.type.BLUEPRINT&&param.actionType!=ActivityLog.type.FORM_CUSTOMISATION&&param.actionType!=ActivityLog.type.ROLE&&param.actionType!=ActivityLog.type.FORM_RECORD_OPERATION||(param.actionType=subActionObj.value.split(",")[0],param.actionSubType=subActionObj.value.split(",")[1]))}}else changedRec&&!this.isReset&&(changedRec.formId&&"0"!==changedRec.formId&&(param.formId=changedRec.formId),changedRec.optType&&"0"!==changedRec.optType&&(param.optType=changedRec.optType,changedRec.date&&""!==changedRec.date&&(param.date=changedRec.date)),changedRec.userId&&"0"!==changedRec.userId&&(param.userId=changedRec.userId),changedRec.actionType&&-1!=changedRec.actionType&&(param.actionType=changedRec.actionType,changedRec.actionSubType&&-1!=changedRec.actionSubType&&(param.actionSubType=changedRec.actionSubType)));this.isReset=!1,scroll?changedRec.formId!==param.formId||changedRec.userId!==param.userId||changedRec.actionType!=param.actionType||changedRec.actionSubType!=param.actionSubType||changedRec.optType!==param.optType||param.date&&param.date!==changedRec.date?scroll=!1:param.startIndex=ActivityLog.actLogsStartIndex+1:($(ActivityLog.LayoutId+" #ZPActLogsNoData")[0]&&$(ActivityLog.LayoutId+" #ZPActLogsNoData").hide(),Layout.Page.parentContainer.find("#ZP_actLogsData").removeClass("sticky"),$("div[id^='ZPActLogsHead']").remove(),0===$(ActivityLog.LayoutId+" #ZP_actLogsData").find("#zp_page_loading").length&&$(ActivityLog.LayoutId+" #ZP_actLogsData").append(ZPeople.LOADING_HTML)),$.post("/getActivityLog.zp",param,function(rdata){if(ActivityLog.getConfigList){var url_currentdomain=ZPeople.ZOHOURL,tempChangeForCnHelp=url_currentdomain.split(".");"cn"==tempChangeForCnHelp[tempChangeForCnHelp.length-1]&&(url_currentdomain="https://www.zoho.com"),Layout.Page.container.find("a#helpLink").attr("href",url_currentdomain+"/people/help/adminguide/activitylog.html"),ActivityLog.consConfigList(rdata);var settingsObj={};settingsObj.mindate=new Date,settingsObj.mindate.setTime(ActivityLog.startTime),settingsObj.maxdate=new Date,settingsObj.maxdate.setTime(ActivityLog.endTime);var fromObj=$("#ZPaclog_filter_date_from");fromObj.off("click").on("click",function(){Calendar.setUpCalendar(event,fromObj,null,null,null,null,settingsObj)});var toObj=$("#ZPaclog_filter_date_to");toObj.off("click").on("click",function(){Calendar.setUpCalendar(event,toObj,null,null,null,null,settingsObj)})}if(scroll||(ActivityLog.actLogsStartIndex=0,$(ActivityLog.LayoutId+" #ZP_actLogsData").scrollTop(0)),rdata.activities)if(ActivityLog.actLogs=rdata.activities,ActivityLog.hasMore=rdata.hasMore,scroll)for(var i in rdata.activities)ActivityLog.activityLogs.push(rdata.activities[i]);else ActivityLog.activityLogs=rdata.activities;ActivityLog.actLogsParam=param,ActivityLog.showActivityLog(scroll)}).fail(function(resultData){$("#"+Layout.Page.pageId+" #zp_page_loading").remove(),0==Layout.Page.container.find("div[id^='ZPActLogsHead']").length&&Layout.Page.container.find("#ZPActLogsNoData").html($(ActivityLog.NoData)).show(),Layout.Page.container.find("#ZPActLogsearch").removeClass("disabled"),Layout.Page.container.find("#ZP_actLogsData").on("onScroll",function(){ActivityLog.OnScrollGetActivity()})})},showActivityLog:function(scroll){var container=Layout.Page.container,emptyLogs=container.find("#ZPActLogsNoData").html($(ActivityLog.NoData)).hide(),actLogsdata=(container.find("#ZPActLogsHead"),container.find("#ZP_actLogsData")),entries=ActivityLog.activityLogs;if(scroll?entries=ActivityLog.actLogs:actLogsdata.find("div[id^='ZPActLogsHead']").remove(),0==entries.length)emptyLogs.show();else for(var i in entries)actLogsdata.append(ActivityLog.groupEntries(entries[i]));$("#"+Layout.Page.pageId+" #zp_page_loading").remove(),$(ActivityLog.LayoutId).find("[data-toggle=popover]").popover(),actLogsdata.find("div[id^='ZPActLogsHead']").show(),0===actLogsdata.find(".cur_day").length?(actLogsdata.find("div[id^='ZPActLogsHead']").remove(),emptyLogs.fadeIn(200)):emptyLogs.hide(),Layout.Page.container.find("#ZPActLogsearch").removeClass("disabled"),Layout.Page.container.find("#ZP_actLogsData").on("onScroll",function(){ActivityLog.OnScrollGetActivity()})},constructEntries:function(entries){var data="";start:for(var i in entries){var message="",eventclass="",empDetails="";if(empDetails=entries[i].empIsActive?entries[i].employeeStatus?"<a onclick=\"ZPeople.getUserPage('"+entries[i].erecNo+"')\">"+ZSEC.Encoder.encodeForHTML(entries[i].empName)+"</a>":"<b>"+entries[i].empName+"</b>":ZPI18N.getString("zp.unknownuser"),entries[i].type==ActivityLog.type.FORM_RECORD_OPERATION){var formName=ZSEC.Encoder.encodeForHTML(entries[i].formName);if(entries[i].subType===ActivityLog.formSubType.WEB_ADD||entries[i].subType===ActivityLog.formSubType.API_ADD||entries[i].subType===ActivityLog.formSubType.MOBILE_ADD||entries[i].subType===ActivityLog.formSubType.IMPORT_ADD||entries[i].subType===ActivityLog.formSubType.EMBED_ADD)eventclass="event add",message=entries[i].subType===ActivityLog.formSubType.WEB_ADD||entries[i].subType===ActivityLog.formSubType.IMPORT_ADD?ZPI18N.getString("zp.addedrecordweb",[empDetails,formName]):entries[i].subType===ActivityLog.formSubType.API_ADD?ZPI18N.getString("zp.addedrecordapi",[empDetails,formName]):entries[i].subType===ActivityLog.formSubType.MOBILE_ADD?ZPI18N.getString("zp.addedrecordmobile",[empDetails,formName]):ZPI18N.getString("zp.addedrecordembed",[empDetails,formName]);else if(entries[i].subType===ActivityLog.formSubType.WEB_EDIT||entries[i].subType===ActivityLog.formSubType.API_EDIT||entries[i].subType===ActivityLog.formSubType.MOBILE_EDIT||entries[i].subType===ActivityLog.formSubType.IMPORT_EDIT)eventclass="event edit",message=entries[i].subType===ActivityLog.formSubType.WEB_EDIT||entries[i].subType===ActivityLog.formSubType.IMPORT_EDIT?ZPI18N.getString("zp.editedrecordweb",[empDetails,formName]):entries[i].subType===ActivityLog.formSubType.API_EDIT?ZPI18N.getString("zp.editedrecordapi",[empDetails,formName]):entries[i].subType===ActivityLog.formSubType.IMPORT_EDIT?ZPI18N.getString("zp.editedrecordimport",[empDetails,formName]):ZPI18N.getString("zp.editedrecordmobile",[empDetails,formName]);else if(entries[i].subType===ActivityLog.formSubType.IMPORT)message=ZPI18N.getString("zp.importedrecord",[empDetails,formName]),eventclass="event imp";else if(entries[i].subType===ActivityLog.formSubType.EXPORT)message=ZPI18N.getString("zp.exportedrecord",[empDetails,formName]),eventclass="event exp";else if(entries[i].subType===ActivityLog.formSubType.DELETE)message=ZPI18N.getString("zp.deletedrecord",[empDetails,formName]),eventclass="event dlt";else if(entries[i].subType===ActivityLog.formSubType.HISTORY_EXPORT)message=ZPI18N.getString("zp.historyexportedrecord",[empDetails,formName]),eventclass="event exp";else if(entries[i].subType===ActivityLog.formSubType.MASS_UPDATE)message=ZPI18N.getString("zp.massupdaterecords",[empDetails,formName]),eventclass="event upd";else if(entries[i].subType===ActivityLog.formSubType.BULK_FILE_UPLOAD)message=ZPI18N.getString("zp.bulkuploadedfiles",[empDetails,formName]),eventclass="event upd";else if(entries[i].subType===ActivityLog.formSubType.EMP_PHOTO_UPLOAD){var userDetails="";entries[i].userEmpIsActive?entries[i].userEmployeeStatus?userDetails+="<a onclick=\"ZPeople.getUserPage('"+entries[i].userERECNO+"')\">"+ZSEC.Encoder.encodeForHTML(entries[i].userEmpName)+"</a>":userDetails+="<b>"+ZSEC.Encoder.encodeForHTML(entries[i].userEmpName)+"</b>":userDetails+=ZPI18N.getString("zp.unknownuser"),message=ZPI18N.getString("zp.userphotoupdated",[empDetails,userDetails]),eventclass="event upd"}}else if(entries[i].type==ActivityLog.type.SERVICE){var serviceName=ZSEC.Encoder.encodeForHTML(entries[i].serviceName);entries[i].subType===ActivityLog.subType.ADD?(message=ZPI18N.getString("zp.createdservice",[empDetails,serviceName]),eventclass="event add"):entries[i].subType===ActivityLog.subType.DELETE?(message=ZPI18N.getString("zp.deletedservice",[empDetails,serviceName]),eventclass="event dlt"):entries[i].subType===ActivityLog.subType.EDIT?(message=entries[i].oldServiceName?ZPI18N.getString("zp.updatedservicename",[empDetails,ZSEC.Encoder.encodeForHTML(entries[i].oldServiceName),serviceName]):ZPI18N.getString("zp.updatedservice",[empDetails,serviceName]),eventclass="event edit"):entries[i].subType===ActivityLog.subType.VIEW&&(message=entries[i].isEnable?ZPI18N.getString("zp.enabledservice",[empDetails,serviceName]):ZPI18N.getString("zp.disabledservice",[empDetails,serviceName]),eventclass="event view")}else if(entries[i].type==ActivityLog.type.ROLE){var roleName=ZSEC.Encoder.encodeForHTML(entries[i].roleName);entries[i].subType===ActivityLog.subType.ADD?(message=ZPI18N.getString("zp.addedrole",[empDetails,roleName]),eventclass="event role"):entries[i].subType===ActivityLog.subType.EDIT?(message=entries[i].oldRoleName?ZPI18N.getString("zp.updatedrolename",[empDetails,ZSEC.Encoder.encodeForHTML(entries[i].oldRoleName),roleName]):ZPI18N.getString("zp.updatedrole",[empDetails,roleName]),eventclass="event role"):entries[i].subType===ActivityLog.subType.DELETE?(message=ZPI18N.getString("zp.deletedrole",[empDetails,roleName]),eventclass="event role"):entries[i].subType===ActivityLog.subType.PERM&&(message=ZPI18N.getString("zp.rolepermissionchanged",[empDetails,roleName]),eventclass="event perm")}else if(entries[i].type==ActivityLog.type.FIELD){formName=ZSEC.Encoder.encodeForHTML(entries[i].formName);var formCompName=ZSEC.Encoder.encodeForHTML(entries[i].componentName);entries[i].subType===ActivityLog.subType.ADD?(message=ZPI18N.getString("zp.addedfield",[empDetails,formCompName,formName]),eventclass="event add"):entries[i].subType===ActivityLog.subType.EDIT?(message=entries[i].oldComponentName?ZPI18N.getString("zp.updatedfieldname",[empDetails,ZSEC.Encoder.encodeForHTML(entries[i].oldComponentName),formCompName,formName]):ZPI18N.getString("zp.updatedfield",[empDetails,formCompName,formName]),eventclass="event edit"):entries[i].subType===ActivityLog.subType.DELETE?(message=ZPI18N.getString("zp.deletedfield",[empDetails,formCompName,formName]),eventclass="event dlt"):entries[i].subType===ActivityLog.subType.PERM?(entries[i].roleName?message=ZPI18N.getString("zp.fieldpermissionchanged",[empDetails,formName,ZSEC.Encoder.encodeForHTML(entries[i].roleName)]):entries[i].roleNameList&&(message=ZPI18N.getString("zp.bulkfieldpermissionchanged",[empDetails,formName,ActivityLog.constructMoreList(entries[i].roleNameList)])),eventclass="event perm"):entries[i].subType===ActivityLog.subType.VIEW&&(message=entries[i].isEnable?ZPI18N.getString("zp.enabledfield",[empDetails,formCompName,formName]):ZPI18N.getString("zp.disabledfield",[empDetails,formCompName,formName]),eventclass="event view")}else if(entries[i].type==ActivityLog.type.TRANSITION){var transitionName=ZSEC.Encoder.encodeForHTML(entries[i].TransitionName),blueprintName=ZSEC.Encoder.encodeForHTML(entries[i].blueprintName);entries[i].subType===ActivityLog.subType.ADD?(message=ZPI18N.getString("zp.addedtransition",[empDetails,transitionName,blueprintName]),eventclass="event add"):entries[i].subType===ActivityLog.subType.EDIT?(message=entries[i].oldTransitionName?ZPI18N.getString("zp.updatedtransitionname",[empDetails,ZSEC.Encoder.encodeForHTML(entries[i].oldTransitionName),transitionName,blueprintName]):ZPI18N.getString("zp.updatedtransition",[empDetails,transitionName,blueprintName]),eventclass="event edit"):entries[i].subType===ActivityLog.subType.DELETE&&(message=ZPI18N.getString("zp.deletedtransition",[empDetails,transitionName,blueprintName]),eventclass="event dlt")}else if(entries[i].type==ActivityLog.type.BLUEPRINT){formName=ZSEC.Encoder.encodeForHTML(entries[i].formName),blueprintName=ZSEC.Encoder.encodeForHTML(entries[i].blueprintName);entries[i].subType===ActivityLog.subType.ADD?(message=ZPI18N.getString("zp.addedblueprint",[empDetails,blueprintName,formName]),eventclass="event add"):entries[i].subType===ActivityLog.subType.EDIT?(message=entries[i].oldBlueprintName?ZPI18N.getString("zp.updatedblueprintname",[empDetails,ZSEC.Encoder.encodeForHTML(entries[i].oldBlueprintName),blueprintName,formName]):ZPI18N.getString("zp.updatedblueprint",[empDetails,blueprintName,formName]),eventclass="event edit"):entries[i].subType===ActivityLog.subType.DELETE?(message=ZPI18N.getString("zp.deletedblueprint",[empDetails,blueprintName,formName]),eventclass="event dlt"):entries[i].subType===ActivityLog.formSubType.TRANSITION_EXECUTION&&(message=ZPI18N.getString("zp.executedtransition",[empDetails,ZSEC.Encoder.encodeForHTML(entries[i].TransitionName),formName]),eventclass="event dlt")}else if(entries[i].type==ActivityLog.type.FORM_CUSTOMISATION){formName=ZSEC.Encoder.encodeForHTML(entries[i].formName),serviceName=ZSEC.Encoder.encodeForHTML(entries[i].serviceName);if(entries[i].subType===ActivityLog.subType.LOCATION_TRACKING)message=ZPI18N.getString("zp.enabledisablelocationtracking",[empDetails,entries[i].status,formName]),eventclass="event view";else if(entries[i].subType===ActivityLog.subType.ADD)message=ZPI18N.getString("zp.createdform",[empDetails,formName,serviceName]),eventclass="event add";else if(entries[i].subType===ActivityLog.subType.DELETE)message=ZPI18N.getString("zp.deletedform",[empDetails,formName,serviceName]),eventclass="event dlt";else if(entries[i].subType===ActivityLog.subType.EDIT)message=entries[i].currFormName?ZPI18N.getString("zp.updatedformname",[empDetails,formName,ZSEC.Encoder.encodeForHTML(entries[i].currFormName),serviceName]):ZPI18N.getString("zp.updatedform",[empDetails,formName,serviceName]),eventclass="event edit";else if(entries[i].subType===ActivityLog.subType.PERM)message=ZPI18N.getString("zp.recordpermissionchanged",[empDetails,formName,ZSEC.Encoder.encodeForHTML(entries[i].roleName)]),eventclass="event perm";else if(entries[i].subType===ActivityLog.subType.USER_PERM){userDetails="";entries[i].userEmpIsActive?entries[i].userEmployeeStatus?userDetails+="<a onclick=\"ZPeople.getUserPage('"+entries[i].userERECNO+"')\">"+ZSEC.Encoder.encodeForHTML(entries[i].userEmpName)+"</a>":userDetails+="<b>"+ZSEC.Encoder.encodeForHTML(entries[i].userEmpName)+"</b>":userDetails+=ZPI18N.getString("zp.unknownuser"),message=ZPI18N.getString("zp.userpermissionchanged",[empDetails,userDetails]),eventclass="event perm"}else entries[i].subType===ActivityLog.subType.MOVE?(message=ZPI18N.getString("zp.movedform",[empDetails,formName,ZSEC.Encoder.encodeForHTML(entries[i].oldServiceName),serviceName]),eventclass="event move"):entries[i].subType===ActivityLog.subType.SINGLE_FIELD_EDIT_OPTION_ENABLE_DISABLE?(message=ZPI18N.getString("zp.enabledisablesinglefieldeditoption",[empDetails,entries[i].status,formName]),eventclass="event view"):entries[i].subType===ActivityLog.subType.VIEW&&(message=entries[i].isEnable?ZPI18N.getString("zp.enabledform",[empDetails,formName,serviceName]):ZPI18N.getString("zp.disabledform",[empDetails,formName,serviceName]),eventclass="event view")}else if(entries[i].type===ActivityLog.type.SCHEDULAR)entries[i].subType===ActivityLog.subType.ADD?(message=ZPI18N.getString("zp.configuredbackup",[empDetails,"added"]),eventclass="event perm"):entries[i].subType===ActivityLog.subType.STOP?(message=ZPI18N.getString("zp.startedstoppedbackupscheduler",[empDetails,"stopped"]),eventclass="event dlt"):entries[i].subType===ActivityLog.subType.BACKUP&&(message=ZPI18N.getString("zp.backupscheduledtomail",[empDetails]),eventclass="event mail");else if(entries[i].type===ActivityLog.type.MAILMERGE){var docname=ZSEC.Encoder.encodeForHTML(entries[i].docname);entries[i].subType===ActivityLog.subType.DELETE?(message=ZPI18N.getString("zp.deletemailmerge",[empDetails,docname]),eventclass="event dlt"):entries[i].subType===ActivityLog.subType.EDIT?(message=ZPI18N.getString("zp.editmailmergename",[empDetails,docname]),eventclass="event edit"):entries[i].subType===ActivityLog.subType.IMPORT?(message=ZPI18N.getString("zp.importmailmerge",[empDetails,docname]),eventclass="event imp"):entries[i].subType===ActivityLog.subType.CLONE?(message=ZPI18N.getString("zp.clonemailmergetemplate",[empDetails,docname]),eventclass="event clone"):entries[i].subType===ActivityLog.subType.ADD?(message=ZPI18N.getString("zp.addmailmerge",[empDetails,docname]),eventclass="event add"):entries[i].subType===ActivityLog.subType.TEMPLATE_CLONE?(message=ZPI18N.getString("zp.createmailmerge",[empDetails,docname]),eventclass="event clone"):entries[i].subType===ActivityLog.subType.DOWNLOAD?(message=ZPI18N.getString("zp.downloadoriginalmailmerge",[empDetails,docname]),eventclass="event imp"):entries[i].subType===ActivityLog.subType.DOWNLOAD_MERGED_TEMPLATE?(message=ZPI18N.getString("zp.downloadmailmerge",[empDetails,docname,ZSEC.Encoder.encodeForHTML(entries[i].docType)]),eventclass="event imp"):entries[i].subType===ActivityLog.subType.MERGE&&(message=ZPI18N.getString("zp.mergemailmerge",[empDetails,docname]),eventclass="event mailmerge")}else if(entries[i].type===ActivityLog.type.ZOHOSIGN||entries[i].type===ActivityLog.type.ADOBESIGN||entries[i].type===ActivityLog.type.DOCUSIGN){var signConfigured,docName=ZSEC.Encoder.encodeForHTML(entries[i].docname);entries[i].type===ActivityLog.type.ZOHOSIGN?signConfigured=ZPI18N.getString("zp.zohosign"):entries[i].type===ActivityLog.type.ADOBESIGN?signConfigured=ZPI18N.getString("zp.adobeesign"):entries[i].type===ActivityLog.type.DOCUSIGN&&(signConfigured=ZPI18N.getString("zp.docusign")),entries[i].subType===ActivityLog.subType.DELETE?(message=entries[i].count>1?ZPI18N.getString("zp.deletedocuments",[empDetails,ZSEC.Encoder.encodeForHTML(entries[i].count),signConfigured]):ZPI18N.getString("zp.deletedocument",[empDetails,ZSEC.Encoder.encodeForHTML(entries[i].docnames),signConfigured]),eventclass="event dlt"):entries[i].subType===ActivityLog.subType.EXPORT?(message=ZPI18N.getString("zp.exportdocument",[empDetails,signConfigured]),eventclass="event exp"):entries[i].subType===ActivityLog.subType.SEND_DOCUMENT?(message=ZPI18N.getString("zp.sentdocument",[empDetails,docName,signConfigured]),eventclass="event esign"):entries[i].subType===ActivityLog.subType.SEND_FROM_HRFILES?(message=ZPI18N.getString("zp.sentcompanypolicy",[empDetails,docName,ZSEC.Encoder.encodeForHTML(Files.hrfiledisname),signConfigured]),eventclass="event esign"):entries[i].subType===ActivityLog.subType.CANCEL_DOCUMENT?(message=ZPI18N.getString("zp.cancelleddocument",[empDetails,docName,signConfigured]),eventclass="event dlt"):entries[i].subType===ActivityLog.subType.SCHEDULE_SEND_DOCUMENT&&(message=ZPI18N.getString("zp.sentdocumentform",[empDetails,docName,ZSEC.Encoder.encodeForHTML(entries[i].formName),signConfigured]),eventclass="event esign"),entries[i].type!==ActivityLog.type.ZOHOSIGN&&entries[i].type!==ActivityLog.type.ADOBESIGN||entries[i].subType===ActivityLog.subType.SEND_REMINDER&&(message=ZPI18N.getString("zp.sentreminder",[empDetails,docName,signConfigured]),eventclass="event reminder"),entries[i].type===ActivityLog.type.ZOHOSIGN&&(entries[i].subType===ActivityLog.subType.SEND_COMPANY_POLICY?(message=ZPI18N.getString("zp.sentcompanypolicy",[empDetails,docName,ZSEC.Encoder.encodeForHTML(Files.compdisname),signConfigured]),eventclass="event esign"):entries[i].subType===ActivityLog.subType.CREATE_ESIGN_TEMPLATE?(message=ZPI18N.getString("zp.createsigntemplate",[empDetails,docName,ZSEC.Encoder.encodeForHTML(Files.compdisname)]),eventclass="event add"):entries[i].subType===ActivityLog.subType.EDIT_ESIGN_TEMPLATE?(message=ZPI18N.getString("zp.editsigntemplate",[empDetails,docName]),eventclass="event edit"):entries[i].subType===ActivityLog.subType.DELETE_ESIGN_TEMPLATE?(message=entries[i].count>1?ZPI18N.getString("zp.deletemanysigntemplate",[entries[i].count]):ZPI18N.getString("zp.deletesigntemplate",[docName]),eventclass="event dlt"):entries[i].subType===ActivityLog.subType.CREATE_ESIGNCONFIGURATION?(message=ZPI18N.getString("zp.createsignconfiguration",[empDetails,docName,signConfigured]),eventclass="event add"):entries[i].subType===ActivityLog.subType.DELETE_ESIGNCONFIGURATION?(message=ZPI18N.getString("zp.deletesignconfiguration",[empDetails,docName]),eventclass="event dlt"):entries[i].subType===ActivityLog.subType.EDIT_ESIGNCONFIGURATION?(message=ZPI18N.getString("zp.editsignconfiguration",[empDetails,docName]),eventclass="event edit"):entries[i].subType===ActivityLog.subType.EXTEND&&(message=ZPI18N.getString("zp.extendexpirydate",[empDetails,docName]),eventclass="event edit"))}else if(entries[i].type===ActivityLog.type.FILES){var filetypename="";if(1==entries[i].fileType?filetypename=ZSEC.Encoder.encodeForHTML(Files.compdisname):0==entries[i].fileType?filetypename=ZSEC.Encoder.encodeForHTML(Files.hrfiledisname):2==entries[i].fileType?filetypename=ZPI18N.getString("zp.pfreport"):5==entries[i].fileType&&(filetypename=ZPI18N.getString("zp.hrdocuments")),entries[i].subType===ActivityLog.subType.DELETE)message=4==entries[i].fileType?ZPI18N.getString("zp.categorydeleted",[empDetails,ZSEC.Encoder.encodeForHTML(entries[i].names)]):entries[i].count>1?ZPI18N.getString("zp.manyfilesdeleted",[empDetails,entries[i].count,filetypename]):ZPI18N.getString("zp.onefiledeleted",[empDetails,ZSEC.Encoder.encodeForHTML(entries[i].names),filetypename]),eventclass="event dlt";else if(entries[i].subType===ActivityLog.subType.EDIT){var endocname=ZSEC.Encoder.encodeForHTML(entries[i].docname);message=4==entries[i].fileType?ZPI18N.getString("zp.categoryedited",[empDetails,endocname]):ZPI18N.getString("zp.filesedited",[empDetails,endocname,filetypename]),eventclass="event edit"}else if(entries[i].subType===ActivityLog.subType.IMPORT)message=ZPI18N.getString("zp.filesimportedinfiles",[empDetails,filetypename]),eventclass="event imp";else if(entries[i].subType===ActivityLog.subType.RENAME){var oldName=ZSEC.Encoder.encodeForHTML(entries[i].oldName);message=ZPI18N.getString("zp.filesrenamed",[empDetails,oldName,filetypename]),eventclass="event edit"}else if(entries[i].subType===ActivityLog.subType.EXPORT){endocname=ZSEC.Encoder.encodeForHTML(entries[i].docname);message=ZPI18N.getString("zp.filesexported",[empDetails,filetypename]),eventclass="event exp"}else if(entries[i].subType===ActivityLog.subType.ADD){endocname=ZSEC.Encoder.encodeForHTML(entries[i].docname);if(4==entries[i].fileType){if("I-9(2020).pdf"==decodeHTML(endocname)||"W-4(2020).pdf"==decodeHTML(endocname)||"W-9(2020).pdf"==decodeHTML(endocname))continue start;message=ZPI18N.getString("zp.categoryadded",[empDetails,endocname])}else{if("Company Handbook Template.docx"==decodeHTML(endocname)&&5==entries[i].fileType)continue start;message=ZPI18N.getString("zp.filesadded",[empDetails,endocname,filetypename,filetypename])}eventclass="event add"}else entries[i].subType===ActivityLog.subType.FILES_SETTINGS&&(message=ZPI18N.getString("zp.filessettingsupdated",[empDetails]),eventclass="event perm")}else if(entries[i].type===ActivityLog.type.ONBOARDING_TYPE){var isPreOnboarding=entries[i].ONBOARDING_TYPE!==ZPOnboarding.CONSTANTS.EMPLOYEE_ONBOARDING_TYPE;if(entries[i].subType===ActivityLog.subType.ONBOARDING_PROCESS)if(isPreOnboarding){if(entries[i].candName){var candName=ZSEC.Encoder.encodeForHTML(entries[i].candName);message=entries[i].ONBOARDING_STATUS===ZPOnboarding.statusConstants.ONBOARDING_NOT_TRIGGERED?ZPI18N.getString("zp.alcandonbtrriggered",[empDetails,candName]):entries[i].ONBOARDING_STATUS===ZPOnboarding.statusConstants.ONBOARDING_STARTED?ZPI18N.getString("zp.alcandonbstarted",[candName]):ZPI18N.getString("zp.alcandonbcomp",[candName]),eventclass="event edit"}}else{var userempDetails;if(entries[i].ONBOARDING_STATUS===ZPOnboarding.statusConstants.ONBOARDING_NOT_TRIGGERED)userempDetails=entries[i].userEmpIsActive?entries[i].userEmployeeStatus?"<a onclick=\"ZPeople.getUserPage('"+entries[i].userERECNO+"')\">"+ZSEC.Encoder.encodeForHTML(entries[i].userEmpName)+"</a>":"<b>"+entries[i].userEmpName+"</b>":ZPI18N.getString("zp.unknownuser"),message=ZPI18N.getString("zp.alemponbtrriggered",[userempDetails,empDetails]);else message=entries[i].ONBOARDING_STATUS===ZPOnboarding.statusConstants.ONBOARDING_STARTED?ZPI18N.getString("zp.alemponbstarted",[empDetails]):ZPI18N.getString("zp.alemponbcomp",[empDetails]);eventclass="event edit"}else if(entries[i].subType===ActivityLog.subType.ADD){var flowname=ZSEC.Encoder.encodeForHTML(entries[i].FLOW_NAME);eventclass="event add",message=isPreOnboarding?ZPI18N.getString("zp.alcandonbflowadd",[empDetails,flowname]):ZPI18N.getString("zp.alemponbflowadd",[empDetails,flowname])}else if(entries[i].subType===ActivityLog.subType.EDIT){flowname=ZSEC.Encoder.encodeForHTML(entries[i].FLOW_NAME);if(eventclass="event edit",entries[i].OLD_FLOW_NAME){var oldflowname=ZSEC.Encoder.encodeForHTML(entries[i].OLD_FLOW_NAME);message=ZPI18N.getString(isPreOnboarding?"zp.alcandonbfloweditandflowchanged":"zp.alemponbfloweditandflowchanged",[empDetails,oldflowname,flowname])}else message=isPreOnboarding?ZPI18N.getString("zp.alcandonbflowedit",[empDetails,flowname]):ZPI18N.getString("zp.alemponbflowedit",[empDetails,flowname])}else if(entries[i].subType===ActivityLog.subType.DELETE){flowname=ZSEC.Encoder.encodeForHTML(entries[i].FLOW_NAME);eventclass="event dlt",message=isPreOnboarding?ZPI18N.getString("zp.alcandonbflowdelete",[empDetails,flowname]):ZPI18N.getString("zp.alemponbflowdelete",[empDetails,flowname])}else if(entries[i].subType===ActivityLog.subType.ENABLE_DISABLE){flowname=ZSEC.Encoder.encodeForHTML(entries[i].FLOW_NAME);eventclass="event edit",message=entries[i].IS_VISIBLE?isPreOnboarding?ZPI18N.getString("zp.alcandonbflowenable",[empDetails,flowname]):ZPI18N.getString("zp.alemponbflowenable",[empDetails,flowname]):isPreOnboarding?ZPI18N.getString("zp.alcandonbflowdisable",[empDetails,flowname]):ZPI18N.getString("zp.alemponbflowdisable",[empDetails,flowname])}else entries[i].subType===ActivityLog.subType.CLIENT_PORTAL_ADD?(eventclass="event add",message=ZPI18N.getString("zp.alonbcreateportal",[empDetails,entries[i].PORTALNAME])):entries[i].subType===ActivityLog.subType.CLIENT_PORTAL_EDIT&&(eventclass="event edit",message=ZPI18N.getString("zp.alonbeditportal",[empDetails,entries[i].PORTALNAME]))}else entries[i].type==ActivityLog.type.USER_OPERATIONS&&(entries[i].subType===ActivityLog.subType.LOGIN_ENABLE?(eventclass="event edit",message=ZPI18N.getString("zp.useropactlogenablelogin",[empDetails])):entries[i].subType===ActivityLog.subType.LOGIN_DISABLE?(eventclass="event edit",message=ZPI18N.getString("zp.useropactlogdiablelogin",[empDetails])):entries[i].subType===ActivityLog.subType.CONVERT_TO_USER?(eventclass="event edit",message=ZPI18N.getString("zp.useropactlogconverttouser",[empDetails])):entries[i].subType===ActivityLog.subType.CONVERT_TO_NONUSER?(eventclass="event edit",message=ZPI18N.getString("zp.useropactlogconverttononuser",[empDetails])):entries[i].subType===ActivityLog.subType.RESEND_INVITATION?(eventclass="event edit",message=ZPI18N.getString("zp.useripactlogtriggerresend",[empDetails])):entries[i].subType===ActivityLog.subType.ENABLE_TO_NONUSER&&(eventclass="event edit",message=ZPI18N.getString("zp.useropactlogenabletononuser",[empDetails])));data+='<div class="'+eventclass+'"><span class="tline">'+entries[i].time+"</span><div>",data+=message,entries[i].type===ActivityLog.type.FORM_RECORD_OPERATION&&(entries[i].subType===ActivityLog.formSubType.IMPORT?(data+="<p><span>"+ZPI18N.getString("zp.added")+" "+ZPI18N.getString("zp.Records")+": "+entries[i].records_added+"</span>",data+="<span>"+ZPI18N.getString("zp.updated")+" "+ZPI18N.getString("zp.Records")+": "+entries[i].records_updated+"</span>",data+="<span>"+ZPI18N.getString("zp.skiped")+" "+ZPI18N.getString("zp.Records")+": "+entries[i].records_skipped+"</span></p>"):entries[i].subType===ActivityLog.formSubType.EXPORT||entries[i].subType===ActivityLog.formSubType.DELETE||entries[i].subType===ActivityLog.formSubType.MASS_UPDATE||entries[i].subType===ActivityLog.formSubType.HISTORY_EXPORT?data+="<p><span>"+ZPI18N.getString("zp.noofrecord")+": "+entries[i].record_count+"</span></p>":entries[i].subType===ActivityLog.formSubType.BULK_FILE_UPLOAD&&(data+="<p><span>"+ZPI18N.getString("zp.added")+" "+ZPI18N.getString("zp.Records")+": "+entries[i].records_added+"</span>",data+="<span>"+ZPI18N.getString("zp.skiped")+" "+ZPI18N.getString("zp.Records")+": "+entries[i].records_failed+"</span></p>")),entries[i].linkComponents&&(data+='<a class="view" onclick="ActivityLog.viewReqForm(\''+entries[i].linkComponents.formId+"','"+entries[i].linkComponents.recId+"','"+entries[i].linkComponents.tableName+"')\">"+ZPI18N.getString("zp.viewRecord")+"</a>"),!entries[i].tid&&!entries[i].templateid||entries[i].type!==ActivityLog.type.MAILMERGE||entries[i].subType!==ActivityLog.subType.ADD&&entries[i].subType!==ActivityLog.subType.EDIT&&entries[i].subType!==ActivityLog.subType.CLONE||(entries[i].tid?data+='<a class="view" onclick="MMtemplte.editSingleTemplate(this,\''+entries[i].tid+"',true)\">"+ZPI18N.getString("zp.viewmmtemplate")+"</a>":data+='<a class="view" onclick="MMtemplte.editSingleTemplate(this,\''+entries[i].templateid+"',true)\">"+ZPI18N.getString("zp.viewmmtemplate")+"</a>"),entries[i].count>1&&entries[i].subType===ActivityLog.subType.DELETE&&(entries[i].type===ActivityLog.type.FILES||entries[i].type===ActivityLog.type.ZOHOSIGN||entries[i].type===ActivityLog.type.ADOBESIGN||entries[i].type===ActivityLog.type.DOCUSIGN)&&(data+="<p><span>"+ZPI18N.getString("zp.noofrecord")+": "+entries[i].count+"</span></p>"),data+="</div></div>"}return data},constructMoreList:function(data){if(!ZPSetupCommon.isEmpty(data)&&0!==data.length){listHtml="";var popHtml="";$.each(data,function(ind,val){ind<4?(listHtml+="<b>"+ZSEC.Encoder.encodeForHTML(val)+"</b>",listHtml+=ind!=data.length-1&&3!=ind?", ":""):popHtml+="<li>"+ZSEC.Encoder.encodeForHTML(val)+"</li>"}),""!=popHtml&&(popHtml="<ul class='P5 PL8'>"+popHtml+"</ul>",listHtml+=" & "+(data.length-4)+" ",listHtml+='<a class="dvShwlocation S13" data-placement="bottom" data-trigger="hover" data-toggle="popover" data-content="'+popHtml+'" data-html="true">'+ZPI18N.getString("zp.more").toLowerCase()+"</a>")}return listHtml},groupEntries:function(entries){if(entries.entries){if(0!=Layout.Page.container.find("div #"+entries.date).length)return Layout.Page.container.find("div #"+entries.date).parent().append(ActivityLog.constructEntries(entries.entries)),"";var dateComp=entries.date.split("-"),date=dateComp[0]+" "+ZPDateTime.getMonth(dateComp[1]-1,"long"),data='<div class="aclog_cont" id="ZPActLogsHead_'+date+'">';return data+='<div class="aclog_detl">',date=ActivityLog.today.split("-")[2]!=dateComp[2]?date+" "+dateComp[2]:entries.date==ActivityLog.today?ZPI18N.getString("zp.today"):date,data+='<div class="cur_day" id='+entries.date+"><span>"+date+"</span></div>",data+=ActivityLog.constructEntries(entries.entries),data+="</div><div>"}},OnScrollGetActivity:function(){ActivityLog.onScrollDateChange();var element=Layout.Page.parentContainer.find("#ZP_actLogsData");element[0].clientHeight+element.scrollTop()+20>=element[0].scrollHeight&&0!=element.scrollTop()&&(ActivityLog.checkThrottle?ActivityLog.throttleFunction():ActivityLog.moreActivityLog())},onScrollDateChange:function(){var currDateObj=Layout.Page.container.find(" .cur_day >span"),currDayFirst=currDateObj.first(),top=$("#ZP_actLogsData").offset().top;currDateObj.show(),currDayFirst.offset()&&currDayFirst.offset().top>top?Layout.Page.parentContainer.find("#ZP_actLogsData").removeClass("sticky"):$(currDateObj).each(function(){var date=$(this).html();if($(this).offset().top-top<45){if(Layout.Page.parentContainer.find("#actLogCurrDate").css("opacity",0),!($(this).offset().top-top<12))return void $(this).show();Layout.Page.parentContainer.find("#ZP_actLogsData").addClass("sticky"),$(this).hide(),Layout.Page.parentContainer.find("#actLogCurrDate").css("opacity",1),Layout.Page.parentContainer.find("#actLogCurrDate").html(date)}})},actionInputChange:function(type,subType){type=type||$(ActivityLog.LayoutId+" #ZPaclog_filter_actions select")[0].value,subType=subType||-1;var searchOpHtml="",formName=$(ActivityLog.LayoutId+" #ZPaclog_filter_formname select")[0].value;Layout.Page.container.find("div[id^='ZPaclog_filter_sub_actions']").hide(),Layout.Page.container.find("#ZPaclog_filter_sub_actions select").empty(),Layout.Page.container.find("div[id^='ZPaclog_filter_formname']").hide(),Layout.Page.container.find("#ZPaclog_filter_formname select").select2("val",0),-2!=type&&type!=ActivityLog.type.FORM_RECORD_OPERATION||(Layout.Page.container.find("div[id^='ZPaclog_filter_formname']").show(),Layout.Page.container.find("#ZPaclog_filter_formname select").select2("val",formName)),-1!=type&&type!=ActivityLog.type.SCHEDULAR&&type!=ActivityLog.type.ONBOARDING_TYPE&&Layout.Page.container.find("div[id^='ZPaclog_filter_sub_actions']").show(),-2==type&&(searchOpHtml='<option value="-2,-1">'+ZPI18N.getString("zp.all")+"</option>",searchOpHtml+='<option value="-2,'+ActivityLog.subType.ADD+'">'+ZPI18N.getString("zp.add")+"</option>",searchOpHtml+='<option value="-2,'+ActivityLog.subType.EDIT+'">'+ZPI18N.getString("zp.edit")+"</option>",searchOpHtml+='<option value="-2,'+ActivityLog.subType.DELETE+'">'+ZPI18N.getString("zp.delete")+"</option>",searchOpHtml+='<optgroup label="'+ZPI18N.getString("zp.fields")+'">',searchOpHtml+='<option value="'+ActivityLog.type.FIELD+","+ActivityLog.subType.ADD+'">'+ZPI18N.getString("zp.add")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FIELD+","+ActivityLog.subType.EDIT+'">'+ZPI18N.getString("zp.edit")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FIELD+","+ActivityLog.subType.DELETE+'">'+ZPI18N.getString("zp.delete")+"</option>",searchOpHtml+="</optgroup>",subType=type+","+subType),-3==type||type==ActivityLog.type.ROLE||type==ActivityLog.type.FORM_CUSTOMISATION&&(ActivityLog.subType.USER_PERM||subType==ActivityLog.subType.PERM)||type==ActivityLog.type.FIELD&&subType==ActivityLog.subType.PERM?(searchOpHtml='<option value="-3,-1">'+ZPI18N.getString("zp.all")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.ROLE+',-1">'+ZPI18N.getString("zp.rolelist")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_CUSTOMISATION+","+ActivityLog.subType.PERM+'">'+ZPI18N.getString("zp.formpermissions")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FIELD+","+ActivityLog.subType.PERM+'">'+ZPI18N.getString("zp.fieldPermissions")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.ROLE+","+ActivityLog.subType.PERM+'">'+ZPI18N.getString("zp.globalpermission")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_CUSTOMISATION+","+ActivityLog.subType.USER_PERM+'">'+ZPI18N.getString("zp.AdminOperation")+"</option>",subType=(type=-3)+","+subType):type==ActivityLog.type.FORM_CUSTOMISATION||type==ActivityLog.type.SERVICE||type==ActivityLog.type.FIELD?(searchOpHtml='<option value="'+ActivityLog.type.FORM_CUSTOMISATION+',-1">'+ZPI18N.getString("zp.all")+"</option>",searchOpHtml+='<optgroup label="'+ZPI18N.getString("zp.services")+'">',searchOpHtml+='<option value="'+ActivityLog.type.SERVICE+","+ActivityLog.subType.ADD+'">'+ZPI18N.getString("zp.add")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.SERVICE+","+ActivityLog.subType.EDIT+'">'+ZPI18N.getString("zp.edit")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.SERVICE+","+ActivityLog.subType.DELETE+'">'+ZPI18N.getString("zp.delete")+"</option>",searchOpHtml+="</optgroup>",searchOpHtml+='<optgroup label="'+ZPI18N.getString("zp.forms")+'">',searchOpHtml+='<option value="'+ActivityLog.type.FORM_CUSTOMISATION+","+ActivityLog.subType.ADD+'">'+ZPI18N.getString("zp.add")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_CUSTOMISATION+","+ActivityLog.subType.EDIT+'">'+ZPI18N.getString("zp.edit")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_CUSTOMISATION+","+ActivityLog.subType.MOVE+'">'+ZPI18N.getString("zp.move")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_CUSTOMISATION+","+ActivityLog.subType.LOCATION_TRACKING+'">'+ZPI18N.getString("zp.location")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_CUSTOMISATION+","+ActivityLog.subType.DELETE+'">'+ZPI18N.getString("zp.delete")+"</option>",searchOpHtml+="</optgroup>",searchOpHtml+='<optgroup label="'+ZPI18N.getString("zp.fields")+'">',searchOpHtml+='<option value="'+ActivityLog.type.FIELD+","+ActivityLog.subType.ADD+'">'+ZPI18N.getString("zp.add")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FIELD+","+ActivityLog.subType.EDIT+'">'+ZPI18N.getString("zp.edit")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FIELD+","+ActivityLog.subType.DELETE+'">'+ZPI18N.getString("zp.delete")+"</option>",searchOpHtml+="</optgroup>",subType=(type=ActivityLog.type.FORM_CUSTOMISATION)+","+subType):type==ActivityLog.type.FORM_RECORD_OPERATION?(searchOpHtml='<option value="'+ActivityLog.type.FORM_RECORD_OPERATION+',-1">'+ZPI18N.getString("zp.all")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_RECORD_OPERATION+","+ActivityLog.subType.ADD+'">'+ZPI18N.getString("zp.add")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_RECORD_OPERATION+","+ActivityLog.subType.EDIT+'">'+ZPI18N.getString("zp.edit")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_RECORD_OPERATION+","+ActivityLog.formSubType.MASS_UPDATE+'">'+ZPI18N.getString("zp.massupdate")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_RECORD_OPERATION+","+ActivityLog.formSubType.BULK_FILE_UPLOAD+'">'+ZPI18N.getString("zp.bulkupload")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_RECORD_OPERATION+","+ActivityLog.formSubType.IMPORT+'">'+ZPI18N.getString("zp.import")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_RECORD_OPERATION+","+ActivityLog.formSubType.EXPORT+'">'+ZPI18N.getString("zp.export")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_RECORD_OPERATION+","+ActivityLog.formSubType.DELETE+'">'+ZPI18N.getString("zp.delete")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.FORM_RECORD_OPERATION+","+ActivityLog.formSubType.HISTORY_EXPORT+'">'+ZPI18N.getString("zp.historyexport")+"</option>",subType=type+","+subType):type==ActivityLog.type.BLUEPRINT||type==ActivityLog.type.TRANSITION?(searchOpHtml='<option value="'+ActivityLog.type.BLUEPRINT+',-1">'+ZPI18N.getString("zp.all")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.BLUEPRINT+","+ActivityLog.subType.ADD+'">'+ZPI18N.getString("zp.add")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.BLUEPRINT+","+ActivityLog.subType.EDIT+'">'+ZPI18N.getString("zp.edit")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.BLUEPRINT+","+ActivityLog.subType.DELETE+'">'+ZPI18N.getString("zp.delete")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.TRANSITION+","+ActivityLog.subType.ADD+'">'+ZPI18N.getString("zp.transitionadd")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.TRANSITION+","+ActivityLog.subType.EDIT+'">'+ZPI18N.getString("zp.transitionedit")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.TRANSITION+","+ActivityLog.subType.DELETE+'">'+ZPI18N.getString("zp.transitiondelete")+"</option>",searchOpHtml+='<option value="'+ActivityLog.type.BLUEPRINT+","+ActivityLog.formSubType.TRANSITION_EXECUTION+'">'+ZPI18N.getString("zp.transitionexecution")+"</option>",subType=(type=ActivityLog.type.BLUEPRINT)+","+subType):type==ActivityLog.type.ZOHOSIGN||type==ActivityLog.type.ADOBESIGN||type==ActivityLog.type.DOCUSIGN?(searchOpHtml='<option value="-1">'+ZPI18N.getString("zp.all")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.ADD+'">'+ZPI18N.getString("zp.add")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.EDIT+'">'+ZPI18N.getString("zp.edit")+"</option>",type==ActivityLog.type.ZOHOSIGN?(searchOpHtml+='<option value="'+ActivityLog.subType.CREATE_ESIGN_TEMPLATE+'">'+ZPI18N.getString("zp.create")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.SEND_REMINDER+'">'+ZPI18N.getString("zp.reminder")+"</option>"):type==ActivityLog.type.ADOBESIGN&&(searchOpHtml+='<option value="'+ActivityLog.subType.SEND_REMINDER+'">'+ZPI18N.getString("zp.reminder")+"</option>"),searchOpHtml+='<option value="'+ActivityLog.subType.SEND_DOCUMENT+'">'+ZPI18N.getString("zp.send")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.EXPORT+'">'+ZPI18N.getString("zp.export")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.CANCEL_DOCUMENT+'">'+ZPI18N.getString("zp.cancel")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.DELETE+'">'+ZPI18N.getString("zp.delete")+"</option>"):type!=ActivityLog.type.MAILMERGE&&type!=ActivityLog.type.FILES||(searchOpHtml='<option value="-1">'+ZPI18N.getString("zp.all")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.ADD+'">'+ZPI18N.getString("zp.add")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.EDIT+'">'+ZPI18N.getString("zp.edit")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.DELETE+'">'+ZPI18N.getString("zp.delete")+"</option>",type==ActivityLog.type.MAILMERGE&&(searchOpHtml+='<option value="'+ActivityLog.subType.IMPORT+'">'+ZPI18N.getString("zp.import")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.CLONE+'">'+ZPI18N.getString("zp.clone")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.DOWNLOAD+'">'+ZPI18N.getString("zp.Download")+"</option>",searchOpHtml+='<option value="'+ActivityLog.subType.MERGE+'">'+ZPI18N.getString("zp.merge")+"</option>")),$(ActivityLog.LayoutId+" #ZPaclog_filter_sub_actions select").html(searchOpHtml),$(ActivityLog.LayoutId+" #ZPaclog_filter_sub_actions select").select2(),$(ActivityLog.LayoutId+" #ZPaclog_filter_actions select").select2("val",type),$(ActivityLog.LayoutId+" #ZPaclog_filter_sub_actions select").select2("val",subType)},changeInputOnDate:function(date){var sDate=date?date.split(";")[0]:"",eDate=date?date.split(";")[1]:"";Layout.Page.container.find("input[id^='ZPaclog_filter_date']").hide(),$("#ZPaclog_filter_date_from").val(sDate||""),$("#ZPaclog_filter_date_to").val(eDate||""),$("#error_message_date").empty().hide(),$(ActivityLog.LayoutId).find("#ZPaclog_filter_date").removeClass("zp-err");var dateOption=$(ActivityLog.LayoutId).find("#ZPaclog_filter_date_options select")[0];dateOption&&dateOption.value&&(18!=dateOption.value&&58!=dateOption.value||(Layout.Page.container.find("input[id^='ZPaclog_filter_date_from']").attr("placeholder",ZPI18N.getString("zp.date")),$("#error_message_date").empty().show(),58==dateOption.value&&(Layout.Page.container.find("input[id^='ZPaclog_filter_date_from']").attr("placeholder",ZPI18N.getString("zp.fromdate")),Layout.Page.container.find("input[id^='ZPaclog_filter_date_to']").show()),Layout.Page.container.find("input[id^='ZPaclog_filter_date_from']").show()))},consConfigList:function(rdata){ActivityLog.today=rdata.today,ActivityLog.startTime=rdata.sTime,ActivityLog.endTime=rdata.eTime,ActivityLog.hasZSlogs=rdata.hasZohosignActivity,ActivityLog.hasASlogs=rdata.hasAdobesignActivity,ActivityLog.hasDSlogs=rdata.hasDocusignActivity,Files.FilesSettings.getFileTabName(),void 0==isAnySignConfigured&&Zohosign.getEsignConfigurations();var obj=Layout.Page.container.find("#ZPaclog_filter_actions select");(ActivityLog.hasZSlogs||isZSConfig)&&0==obj.find("option[value=14]").length&&Layout.Page.container.find("#ZPaclog_filter_actions select").append(new Option(ZPI18N.getString("zp.zohosign"),14)),(ActivityLog.hasASlogs||isAdobeConfig)&&0==obj.find("option[value=15]").length&&Layout.Page.container.find("#ZPaclog_filter_actions select").append(new Option(ZPI18N.getString("zp.adobeesign"),15)),(ActivityLog.hasDSlogs||isDocuConfig)&&0==obj.find("option[value=16]").length&&Layout.Page.container.find("#ZPaclog_filter_actions select").append(new Option(ZPI18N.getString("zp.docusign"),16)),ActivityLog.getConfigList=!1},filterSearch:function(){this.isSearch=!0,Layout.Page.container.find("#ZPActLogsearch").addClass("disabled"),Layout.Page.container.find("div[id^='ZPActLogsHead']").hide(),ActivityLog.evaluateDateFieldFilter()?($(ActivityLog.LayoutId+" #ZP_actLogsData").append(ZPeople.LOADING_HTML),ActivityLog.getActivityLog(!1)):(Layout.Page.container.find("#ZPActLogsearch").removeClass("disabled"),Layout.Page.container.find("div[id^='ZPActLogsHead']").show()),this.isSearch=!1},isReset:!1,resetInputs:function(){this.isReset=!0,$(ActivityLog.LayoutId+" #ZPaclog_filter_formname select").select2("val",0),$(ActivityLog.LayoutId+"  input[name=User]")[0].value=0,ZPComponents.Search.create(ActivityLog.searchJson),Layout.Page.container.find("#ZPaclog_filter_date select").select2("val",0),$(ActivityLog.LayoutId+" #ZPaclog_filter_actions select").select2("val",-1),ActivityLog.actionInputChange(),ActivityLog.changeInputOnDate(),this.isSearch=!1,Layout.Page.container.find("div[id^='ZPActLogsHead']").remove(),$(ActivityLog.LayoutId+" #ZP_actLogsData").append(ZPeople.LOADING_HTML),ActivityLog.getActivityLog(!1)},isSearch:!1,formList:null,formOptions:function(){null==ActivityLog.formList&&(ZPACommon.getFormList("activitylog"),ActivityLog.formList=Automation.formList);var option="<option value='0'>"+ZPI18N.getString("zp.all")+"</option>";for(var i in ActivityLog.formList)option+="<option value="+ActivityLog.formList[i].formId+">"+ActivityLog.formList[i].dispName+"</option>";$(ActivityLog.LayoutId+" #ZPaclog_filter_formname select").html(option)},viewReqForm:function(formId,recordId,tableName){ZPApprovals.setReqFormUrl(formId,recordId,tableName)}};APIUsage={url:"/organizationReports.zp",urlVitals:{report:"APIUsage",mode:"report"},init:function(){"1"!=ZPeople.PLANID&&isadmin?(APIUsage.initPagecomp(),ZPeople.Request.sendRequest(APIUsage.url,APIUsage.urlVitals,"GET",APIUsage.reportBuilder,{},APIUsage.errorHandler)):Layout.Page.container.html(ZPUtil.newNoDataHTML("CR-nodata",8,ZPI18N.getString("zp.permissiondenied"),void 0,void 0,void 0))},initPagecomp:function(){Layout.Page.container.find("#apiusage").hide(),Layout.Page.container.append(ZPeople.LOADING_HTML),Layout.Page.container.find('div[name="tusage"]').find(".usage").find("span").width("0")},reportBuilder:function(data,param){var layout=Layout.Page.container;if(void 0!=data.tusage){layout.find("#tusage").find(".title").text(ZPI18N.getString("zp.apidaily",[data.today])),tusage_can=layout.find("#tusage").find(".t-usage"),$.each(data.tusage,function(key,val){tusage_can.find('div[name="'+key+'"] > .value').text(val)}),usageEle=tusage_can.find('div[name="tusage"]').find(".usage");var width=void 0==usageEle.width()||0==usageEle.width()?500:usageEle.width();usedWidth=width/data.tusage.allotted*data.tusage.used}layout.find("#apiusage").show(),layout.find("#zp_page_loading").remove(),usageEle.find("span").width(usedWidth),APIUsage.chart(data)},chart:function(data){return info={chart:{renderTo:"chartDiv",type:"area"},title:{text:""},credits:{enabled:!1},xAxis:[{categories:data.reports.xaxis}],yAxis:[{title:{text:ZPI18N.getString("zp.apicalls")}}],plotOptions:{area:{fillOpacity:.4}},series:[{name:ZPI18N.getString("zp.Used"),type:"area",data:data.reports.yvalue}],legend:{enabled:!1},exporting:{enabled:!0,buttons:{contextButton:{align:"left",x:-10,y:-10,menuItems:[{text:ZPI18N.getString("zp.lms.reports.exportAsCSV"),onclick:function(){APIUsage.exportchart("csv")}},{text:ZPI18N.getString("zp.lms.reports.exportAsXLS"),onclick:function(){APIUsage.exportchart("xls")}}]}}}},Highcharts.chart(info)},exportchart:function(type){var formObj=$("#zp_export_form").html("");formObj.attr("method","get"),formObj.attr("action",APIUsage.url),formObj.append('<input type="hidden" value="export" name="mode">'),formObj.append('<input type="hidden" value="APIUsage" name="report">'),formObj.append('<input type="hidden" value="'+type+'" name="type">'),formObj.submit(),formObj.attr("action","ExportData.zp"),formObj.attr("method","post"),formObj.html("")},errorHandler:function(data,params){403==data.status?Layout.Page.container.html(ZPUtil.newNoDataHTML("CR-nodata",8,ZPI18N.getString("zp.permissiondenied"),void 0,void 0,void 0)):Layout.Page.container.html(ZPUtil.newNoDataHTML("CR-nodata",8,ZPI18N.getString("zp.sorryservererror"),void 0,void 0,void 0))}};var ZPBackup={URL:"/totalBackup.zp",isRepeatative:!1,day:"",starttime:"",timeFormat:"",logHtml:"",remainingCountHtml:"",permdeniedHtml:'<div><div class="profileLft zc-componentBg mt7"><div class="pad20" id="errorDiv"><div class="P20 text-center"><div class="row"><div class="dvNomsg"><div class="PAdms"></div><p class="PT20 S15">Sorry . You are not allowed to access this data. Please contact Administrator.</p></div></div></div></div></div></div>',backUpCallback:function(isStop){if(isStop){Layout.Page.container.find("#zp_backup_stopbutton").children().find("a").attr("disabled",!0);var params={mode:"stop"}}else params={mode:"load"};ZPeople.Request.send(ZPBackup.URL,params,ZPBackup.handleBackupResponse)},loadNewBackupPage:function(nolog,isCleanUpBackup){Layout.Page.container.find("#zp_backup_options").find("select").select2(),Layout.Page.container.find("#zp_backup_dayofweek").find("select").select2(),Layout.Page.container.find("#zp_weekofmonth_options").find("select").select2(),Layout.Page.container.find("#zp_dayofMonth_options").find("select").select2(),Layout.Page.container.find("#zp_dateofmonth_options").find("select").select2(),Layout.Page.container.find("#zp_month_options").find("select").select2(),Layout.Page.container.find("#zp_backup_options").find("select").select2(),Layout.Page.container.find("#backup_options").removeClass("DN"),Layout.Page.container.find("#zp_backup_text").removeClass("DN"),Layout.Page.container.find("#zp_backup_button").removeClass("DN"),Layout.Page.container.find("#zp_backup_button").children().find("a").attr("disabled",!1),Layout.Page.container.find("#zp_backup_history").addClass("DN"),Layout.Page.container.find("#zp_backup_history").find("#time_input").off(),Layout.Page.container.find("#newbackupPage").find("#time_input").on("click",function(){var timeOptions={};timeOptions.timeFormat=ZPBackup.timeFormat,TimePicker.init(this,timeOptions)}),isCleanUpBackup&&(Layout.Page.container.find("#backup_options").find("#zp_backup_options").find("#option_select").find("select option[value=1]").remove(),Layout.Page.container.find("#backup_options").find("#zp_backup_options").find("#option_select").find("select option[value=2]").remove(),Layout.Page.container.find("#backup_options").find("#zp_backup_options").find("#option_select").find("select option[value=3]").remove(),Layout.Page.container.find("#remainingcount").remove()),nolog?(Layout.Page.container.find("#zp_backup_log").addClass("DN"),Layout.Page.container.find("#zp_nobackup_log").removeClass("DN")):(Layout.Page.container.find("#zp_backup_log").find("table").children("tbody").html(ZPBackup.logHtml),Layout.Page.container.find("#zp_backup_log").removeClass("DN"),Layout.Page.container.find("#zp_nobackup_log").addClass("DN")),Layout.Page.container.find("#remainingcount").html(ZPBackup.remainingCountHtml),Layout.Page.container.find("#backup_start").on("click",function(event){Calendar.setUpCalendar(event,this)}),Layout.Page.container.find("#zp_backup_options").find("select").on("change",function(){var backupvalue=Layout.Page.container.find("#zp_backup_options").find("select").val();if(ZPBackup.isRepeatative=0!=backupvalue,1==backupvalue||2==backupvalue?Layout.Page.container.find("#zp_backup_dayofweek").removeClass("DN"):Layout.Page.container.find("#zp_backup_dayofweek").addClass("DN"),3==backupvalue){var weekvalue=Layout.Page.container.find("#zp_month_options").find("select").val();Layout.Page.container.find("#zp_backup_monthoptions").removeClass("DN"),"0"==weekvalue?(Layout.Page.container.find("#zp_backup_dateofmonth").removeClass("DN"),Layout.Page.container.find("#zp_backup_weekofmonth").addClass("DN"),Layout.Page.container.find("#zp_backup_dayofmonth").addClass("DN")):(Layout.Page.container.find("#zp_backup_dateofmonth").addClass("DN"),Layout.Page.container.find("#zp_backup_weekofmonth").removeClass("DN"),Layout.Page.container.find("#zp_backup_dayofmonth").removeClass("DN"))}else Layout.Page.container.find("#zp_backup_monthoptions").addClass("DN"),Layout.Page.container.find("#zp_backup_dateofmonth").addClass("DN"),Layout.Page.container.find("#zp_backup_weekofmonth").addClass("DN"),Layout.Page.container.find("#zp_backup_dayofmonth").addClass("DN");backupvalue>0&&backupvalue<4?Layout.Page.container.find("#zp_backup_timetoexe").removeClass("DN"):Layout.Page.container.find("#zp_backup_timetoexe").addClass("DN")}),Layout.Page.container.find("#zp_month_options").find("select").on("change",function(){0==Layout.Page.container.find("#zp_month_options").find("select").val()?(Layout.Page.container.find("#zp_backup_dateofmonth").removeClass("DN"),Layout.Page.container.find("#zp_backup_weekofmonth").addClass("DN"),Layout.Page.container.find("#zp_backup_dayofmonth").addClass("DN")):(Layout.Page.container.find("#zp_backup_weekofmonth").removeClass("DN"),Layout.Page.container.find("#zp_backup_dayofmonth").removeClass("DN"),Layout.Page.container.find("#zp_backup_dateofmonth").addClass("DN"))}),Layout.Page.container.find("#head_class").on("click",function(e){!1===$(e.target).is("#time_input")?Layout.Page.container.find("#timepickerforbackup").removeClass("open"):Layout.Page.container.find("#timepickerforbackup").toggleClass("open")})},init:function(){if(ZPeople.ISUNCONFIRMEDACC)ZPeople.showErrorMessageForUnconfirmedAcc();else{var params={mode:"add",frequency:Layout.Page.container.find("#zp_backup_options").find("select").val()};if(ZPBackup.isRepeatative){var frequency=Layout.Page.container.find("#zp_backup_options").find("select").val();if(frequency>0&&frequency<3)ZPBackup.day=Layout.Page.container.find("#zp_backup_dayofweek").find("select").val(),ZPBackup.starttime=Layout.Page.container.find("#timepickerforbackup").find("input").val();else if(3==frequency){var isWeekly=Layout.Page.container.find("#zp_month_options").find("select").val();if("1"==isWeekly){isWeekly=!0;var week=Layout.Page.container.find("#zp_weekofmonth_options").find("select").val();ZPBackup.day=Layout.Page.container.find("#zp_dayofMonth_options").find("select").val(),params.week=week,params.frequency=parseInt(params.frequency)+1}else isWeekly=!1,ZPBackup.day=Layout.Page.container.find("#zp_dateofmonth_options").find("select").val();params.isWeekly=isWeekly,ZPBackup.starttime=""+Layout.Page.container.find("#timepickerforbackup").find("input").val()}if(""==ZPBackup.starttime.trim())return void Layout.Page.container.find("#backup_error_message").removeClass("DN");Layout.Page.container.find("#backup_error_message").addClass("DN"),params.starttime=ZPBackup.starttime,params.day=ZPBackup.day}Layout.Page.container.find("#zp_backup_button").children().find("a").attr("disabled",!0),ZPeople.Request.send(ZPBackup.URL,params,ZPBackup.handleBackupResponse)}},openHelpDocument:function(helpUrl){window.open(helpUrl+"/people/help/adminguide/databackup.html")},handleWMSNotify:function(respObj){ZPeople.Request.send(ZPBackup.URL,{mode:"log"},ZPBackup.handleLogResponse)},handleLogResponse:function(responseJson){var logs=responseJson.logs,mailedto=responseJson.mailedTo;if(void 0!=logs&&JSON.parse(logs).length>0){for(logs=JSON.parse(logs),mailedto=JSON.parse(mailedto),Layout.Page.container.find("#zp_backup_log").removeClass("DN"),Layout.Page.container.find("#zp_nobackup_log").addClass("DN"),ZPBackup.logHtml="",i=0;i<logs.length;i++)ZPBackup.logHtml+="<tr><td>"+logs[i]+"</td><td>"+mailedto[i]+"</td>";Layout.Page.container.find("#zp_backup_log").find("table").children("tbody").html(ZPBackup.logHtml)}else Layout.Page.container.find("#zp_backup_log").addClass("DN"),Layout.Page.container.find("#zp_nobackup_log").removeClass("DN");var remainingCount=responseJson.remainingCount,totalCount=responseJson.totalCount;ZPBackup.remainingCountHtml=ZPI18N.getString("zp.backupremainingmsg")+" <b>",ZPBackup.remainingCountHtml=ZPBackup.remainingCountHtml+""+remainingCount+"/"+totalCount+"<b></b></b>",Layout.Page.container.find("#remainingcount").html(ZPBackup.remainingCountHtml)},handleBackupResponse:function(json){if(json.hasOwnProperty("UnConfirmedAccount"))ZPeople.showErrorMessageForUnconfirmedAcc();else if(json.hasOwnProperty("accessEnabled"))Layout.Page.container.html(ZPBackup.permdeniedHtml);else{if(json.hasOwnProperty("currently_running"))ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.BackupError")),Layout.Page.container.find("#zp_backup_button").children().find("a").attr("disabled",!1);else if(json.hasOwnProperty("count_limit_reached"))ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.BackupCountExceeded")),Layout.Page.container.find("#zp_backup_button").children().find("a").attr("disabled",!1);else if(json.isNew)if(json.afterStop){var params={conreqcsr:csrfToken};Layout.Page.container.find(".zp-sm-6").find(".zpcont-dt zpnew-recedit").html('<div class="ctable ZPTscrlcont" id="zp_page_loading" style="display: block;"><div class="ctcell"><div class="loader-inner line-scale"><div></div><div></div><div></div><div></div><div></div></div></div></div>'),$.post("/getBackUpPage.zp",params,function(resultData){Layout.Page.removeLoading(),Layout.Page.container.html(ZPUtil.Validation.isEmpty(resultData)?"":resultData).data({loaded:!0}),JSON.parse(json.logs).length>0?ZPBackup.loadNewBackupPage(!1):ZPBackup.loadNewBackupPage(!0)})}else{var isCleanUpBackup=!1;json.hasOwnProperty("isCleanUpBackup")&&(isCleanUpBackup=json.isCleanUpBackup),JSON.parse(json.logs).length>0?ZPBackup.loadNewBackupPage(!1,isCleanUpBackup):ZPBackup.loadNewBackupPage(!0,isCleanUpBackup)}else{var type=json.scheduler_type;if(Layout.Page.container.find("#zp_backup_text").addClass("DN"),Layout.Page.container.find("#zp_backup_button").addClass("DN"),Layout.Page.container.find("#zp_backup_monthoptions").addClass("DN"),Layout.Page.container.find("#backup_options").removeClass("DN"),Layout.Page.container.find("#main_class").removeClass("zpnew-recedit"),Layout.Page.container.find("#main_class").addClass("zpnew-recview"),Layout.Page.container.find("#backup_options").find("#zp_backup_options").find("#option_select").remove(),Layout.Page.container.find("#backup_options").find("#zp_backup_options").find("span").removeClass("DN"),Layout.Page.container.find("#backup_options").find("#zp_backup_options").find("span").html(""+json.scheduled_type),type>0){1==type||2==type?(Layout.Page.container.find("#zp_backup_dayofweek").removeClass("DN"),Layout.Page.container.find("#zp_dayofweek_options").find("#option_select").remove(),Layout.Page.container.find("#zp_dayofweek_options").find("span").removeClass("DN"),Layout.Page.container.find("#zp_dayofweek_options").find("span").html(""+json.scheduled_day)):3==type?(Layout.Page.container.find("#zp_backup_dateofmonth").removeClass("DN"),Layout.Page.container.find("#zp_backup_dateofmonth").find("#option_select").remove(),Layout.Page.container.find("#zp_backup_dateofmonth").find("span").removeClass("DN"),Layout.Page.container.find("#zp_backup_dateofmonth").find("span").html(""+json.scheduled_day)):4==type&&(Layout.Page.container.find("#zp_backup_weekofmonth").removeClass("DN"),Layout.Page.container.find("#zp_backup_weekofmonth").find("#option_select").remove(),Layout.Page.container.find("#zp_backup_weekofmonth").find("span").removeClass("DN"),Layout.Page.container.find("#zp_backup_weekofmonth").find("span").html(""+json.scheduled_week),Layout.Page.container.find("#zp_backup_dayofmonth").removeClass("DN"),Layout.Page.container.find("#zp_backup_dayofmonth").find("#option_select").remove(),Layout.Page.container.find("#zp_backup_dayofmonth").find("span").removeClass("DN"),Layout.Page.container.find("#zp_backup_dayofmonth").find("span").html(""+json.scheduled_day)),Layout.Page.container.find("#zp_backup_timetoexe").removeClass("DN"),Layout.Page.container.find("#zp_backup_timeofexe").find("#timepickerforbackup").addClass("DN"),Layout.Page.container.find("#zp_backup_timeofexe").find("span").removeClass("DN"),Layout.Page.container.find("#zp_backup_timeofexe").find("span").html(""+json.scheduled_time);var nextExeHtml="<i>Backup is scheduled at</i>&nbsp"+json.nextExe+"<br>";Layout.Page.container.find("#zp_backup_history").removeClass("DN"),Layout.Page.container.find("#zp_backup_history").find("#backup_history").html(nextExeHtml)}0==type?Layout.Page.container.find("#zp_backup_history").find("#zp_backup_stopbutton").addClass("DN"):Layout.Page.container.find("#zp_backup_history").find("#backup_history").find("#zp_backup_stopbutton").removeClass("DN")}if(ZPBackup.handleLogResponse(json),json.hasOwnProperty("isAdd"))if(json.isSuccess&&json.isScheduled)0==json.scheduler_type?ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.BackupScheduledImediate")):ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.BackupScheduled"));else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror"))}}},ReportSettings={},RSCONSTANTS={MONTHLY:1,WEEKLY:2,BIWEEKLY:3,SEMIMONTHLY:4,SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6,LASTDAY:32,NONE:-1,CURRENT_MONTH:0,NEXT_MONTH:1,WEEK_NAME:[ZPI18N.getString("zp.sunday"),ZPI18N.getString("zp.monday"),ZPI18N.getString("zp.tuesday"),ZPI18N.getString("zp.wednesday"),ZPI18N.getString("zp.thursday"),ZPI18N.getString("zp.friday"),ZPI18N.getString("zp.saturday")],SUPERSCRIPT:{1:"st",2:"nd",3:"rd",4:"th"}};ReportSettings={MODAL_ID:"zp_reportsetting_modal",localValues:{},ALL_LIST:{},autoApplyLeavePayperiod:!1,LAYOUT:$("<form class='form-horizontal pad' role='form'><div class='form-group'><label class='control-label col-sm-3'>"+ZPI18N.getString("zp.ppname")+"</label><div class='col-sm-6'><input class='form-control' id='zp_rs_name' type='text'><span id='zp_rs_name_error' class='error-msg'></span></div></div><div class='form-group'><label class='control-label col-sm-3'>"+ZPI18N.getString("zp.ppcycle")+"</label><div class='col-sm-3'><select id='zp_rs_frequency' onchange=ReportSettings.onFrequencyChange()><option value="+RSCONSTANTS.MONTHLY+">"+ZPI18N.getString("zp.monthly")+"</option><option value="+RSCONSTANTS.WEEKLY+">"+ZPI18N.getString("zp.weekly")+"</option><option value="+RSCONSTANTS.BIWEEKLY+">"+ZPI18N.getString("zp.local.BiWeekly")+"</option><option value="+RSCONSTANTS.SEMIMONTHLY+">"+ZPI18N.getString("zp.local.HalfMonthly")+"</option></select><span id='zp_rs_frequency_error' class='error-msg'></span></div></div><div class='form-group'><div class='col-sm-offset-3 col-sm-3'><select id='zp_rs_from_day'></select><span class='DN dgry MT5' id='zp_rs_startday_info_dummy'>of every month</span></div><div class='col-sm-3'><label class='control-label to-label'>-</label><select id='zp_rs_to_day' onchange='ReportSettings.validateEndDay();'></select><span class='DN dgry MT5' id='zp_rs_endday_info_dummy'>of every month</span><span id='zp_rs_to_day_error' class='error-msg'></span></div></div><span id='zp_rs_to_day_info_dummy' class=' DN error-msg col-sm-offset-3'></span></div><div class='form-group'><label class='control-label col-sm-3' id='zp_rs_ppprocDayText_1'>"+ZPI18N.getString("zp.ppprocessingday")+"</label><div class='col-sm-3'><select class='W100I' id='zp_rs_closure_day' onchange='ReportSettings.validateClosureDay();'></select><span id='zp_rs_closure_day_error' class='error-msg' style='display: none;'></span><span class='DN dgry MT5' id='zp_rs_closure_day_info_dummy'></span></div><div class='col-sm-6'></div></div><div class='form-group'><label class='control-label col-sm-3' id='zp_rs_freeze_dateText'>"+ZPI18N.getString("zp.ppgenerationday")+"</label><div class='col-sm-3'><select class='W100I' id='zp_rs_freeze_date'  onchange='ReportSettings.validateClosureDay();'></select><span id='zp_rs_closure_dayerror_semMont' class='error-msg' style='display: none;'></span><em id='zp_rs_payroll_text' class='dgry'></em></div><div class='col-sm-6 P0'><span class='DB dgry MT5'></span></div></div><div class='form-group' id='zp_rs_cont_semMont'><div class='col-sm-offset-3 col-sm-3'><select id='zp_rs_fromday_semMont'></select><span class='DB dgry MT5' id='zp_rs_startdayinfo_semMont'>of every month</span></div><div class='col-sm-3'><label class='control-label to-label'>-</label><select id='zp_rs_today_semMont'></select><span class='DB dgry MT5' id='zp_rs_enddayinfo_semMont'>of every month</span><span id='zp_rs_to_dayerror_semMont' class='error-msg'></span></div></div><div class='form-group' id='zp_rs_proCont_semMont'><label class='control-label col-sm-3' id='zp_rs_ppprocDayText_2'>"+ZPI18N.getString("zp.ppprocessingday")+"</label><div class='col-sm-3'><select class='W100I' id='zp_rs_closureday_semMont' onchange='ReportSettings.validateClosureDay();'></select><span id='zp_rs_closure_dayerror_semMont' class='error-msg' style='display: none;'></span></div><div class='col-sm-3'><span class='DB dgry MT5' id='zp_rs_closure_dayinfo_semMont'></span></div></div><div class='form-group DN' id='zp_rs_freeze_cont2' ><label class='control-label col-sm-3' id='zp_rs_freeze_dateText2'>"+ZPI18N.getString("zp.ppgenerationday")+"</label><div class='col-sm-3'><select class='W100I' id='zp_rs_freeze_date2'  onchange='ReportSettings.validateClosureDay();'></select><span id='zp_rs_closure_dayerror_semMont' class='error-msg' style='display: none;'></span><em id='zp_rs_payroll_text2'></em></div><div class='col-sm-6 P0'><span class='DB dgry MT5'></span></div></div><div class='form-group'><div class='col-sm-offset-3 col-sm-6'><label class='checkbox pp-checkbox'><input id='zp_rs_encash' type='checkbox' onchange='ReportSettings.validateClosureDay();'><span>"+ZPI18N.getString("zp.pp.processencashment")+"</span></label></div></div><div class='form-group'><div class='col-sm-offset-3 col-sm-6' id='freeze_lable'><label class='checkbox pp-checkbox'><input id='zp_rs_freeze' type='checkbox' onchange='ReportSettings.validateClosureDay();' name='chk1'><span>"+ZPI18N.getString("zp.pplock")+"<small id='lockInfo' class='dgry S14'> "+ZPI18N.getString("zp.pplockinfo")+"</small></span></label></div></div><div class='form-group'><label class='control-label col-sm-3'>"+ZPI18N.getString("zp.ppapplicablelocation")+"</label><div class='col-sm-6'><select id='zp_rs_location' multiple='multiple'></select><span id='zp_rs_location_error' class='error-msg'></span></div></div>"),tr:$("<tr class='ZPLRow'><td id='td_name'></td><td id='td_frequency'></td><td id='td_closureDay'></td><td class='text-right P0I'><div id='action_button' class='over-display' style='display: block;'><i onclick='ReportSettings.showHideConfirmDeleteButtons(this,\"action_confirm_button\",\"table-responsive\");' title='Delete' class='IC-delete S14 gry FR MR15 CP'></i><i id='zp_rs_edit' onclick='ReportSettings.constructAddEditPage(this,true);' title='Edit' class='IC-pen S14 gry FR MR15 CP'></i></div><div style='display: none;' id='action_confirm_button'><button onclick='ReportSettings.showHideConfirmDeleteButtons(this,\"action_button\",\"table-responsive\");' class='btn btn-default btn-sm FR MR15' type='button'>"+ZPI18N.getString("zp.cancel")+"</button><button id='zp_rs_delete' onclick='ReportSettings.deleteAction(this);' class='btn btn-danger btn-sm FR MR10' type='button'>"+ZPI18N.getString("zp.confirm")+"</button></div></td></tr>"),INPUT_PAGE:null,showReportSettingList:function(refresh){if(Layout.Page.container.find("#zp_report_settings_list_div_id,#zp_empty_report_settings_div_id").hide(),Layout.Page.container.find("#zp_report_settings_loading").html(ZPeople.LOADING_HTML).show(),Attendance.noDataImg(8,"CR-set-shlr",Layout.Page.container.find("#zp_svg_id")),Object.keys(ReportSettings.ALL_LIST).length<=0||refresh){var url="reportSettingAction.zp";ZPeople.Module.CURRENT_MODULEPREFIX&&(url="/"+ZPeople.Module.CURRENT_MODULEPREFIX+url);ZPeople.Request.send(url,{mode:"getReportSettings"},ReportSettings.constructListPage)}else ReportSettings.constructData(ReportSettings.ALL_LIST)},showReportSettingListAsync:function(refresh){if(Layout.Page.container.find("#zp_report_settings_loading").html(ZPeople.LOADING_HTML).show(),Attendance.noDataImg(8,"CR-set-shlr",Layout.Page.container.find("#zp_svg_id")),Object.keys(ReportSettings.ALL_LIST).length<=0||refresh){var url="reportSettingAction.zp";ZPeople.Module.CURRENT_MODULEPREFIX&&(url="/"+ZPeople.Module.CURRENT_MODULEPREFIX+url);ZPeople.Request.sendAsyncPost(url,{mode:"getReportSettings"},ReportSettings.constructListPage)}else ReportSettings.constructData(ReportSettings.ALL_LIST)},constructListPage:function(data){return"ACCESS_DENIED"===data.error?(ReportSettings.accessDenied(),null):data.STATUS===ZPI18N.getString("zp.capfailure")?(void 0!==data.CLIENT_MSG&&$.trim(data.CLIENT_MSG).length>0&&(ZPeople.Message.showFailureMsg(data.CLIENT_MSG),Layout.Page.container.find("#zp_report_settings_list_div_id,#zp_report_settings_loading").hide(),Layout.Page.container.find("#zp_empty_report_settings_div_id").show()),null):(ReportSettings.iterate(data.DATA.reportSettingList),void ReportSettings.constructData(ReportSettings.ALL_LIST))},constructData:function(data){Object.keys(data).length>0?(Layout.Page.container.find("#zp_report_settings_list_div_id").show(),Layout.Page.container.find("#zp_empty_report_settings_div_id,#zp_report_settings_loading").hide(),Layout.Page.container.find("#zp_report_setting_table_body_id").empty(),$.each(data,function(key,value){var trClone=ReportSettings.tr.clone();trClone.attr("id","tr_"+value.reportSettID),trClone.find("#td_name").text(value.rsName),trClone.find("#td_frequency").html(value.ppcycle);var proDay=value.closureDayName;value.frequencyCode===RSCONSTANTS.MONTHLY&&value.closureDayCode!==RSCONSTANTS.LASTDAY&&(proDay+=""+ReportSettings.getNumberSuffix(parseInt(value.closureDayName))),proDay+=" <span class='dgry'>"+ReportSettings.getClosureDayInfo(value.frequencyCode,value.toDayCode,value.closureDayCode)+"</span>",value.closureDayName_2&&(proDay+="<div class='MT10'>"+value.closureDayName_2,value.frequencyCode===RSCONSTANTS.MONTHLY&&value.closureDayCode!==RSCONSTANTS.LASTDAY&&(proDay+=""+ReportSettings.getNumberSuffix(parseInt(value.closureDayName_2))),proDay+=" <span class='dgry'>"+value.info[4]+"</span>",proDay+="</div>"),trClone.find("#td_closureDay").html(proDay);var locNameConcat="";$.each(value.locationList,function(key,value){locNameConcat+=value+", ","<span class='label label-primary FL MR5'>"+value+"</span>"}),(locNameConcat=$.trim(locNameConcat)).length<=0?(locNameConcat=ZPI18N.getString("zp.capall"),ZPI18N.getString("zp.capall")):locNameConcat=locNameConcat.substring(0,locNameConcat.length-1),trClone.find("#zp_rs_edit").attr("rsID",value.reportSettID),trClone.find("#zp_rs_delete").attr("rsID",value.reportSettID),Layout.Page.container.find("#zp_report_setting_table_body_id").append(trClone)}),Layout.Page.container.find("#zp_report_setting_table_id").parent().hasClass("tabcont")||ZPView.handleTablePosition()):(Layout.Page.container.find("#zp_report_settings_list_div_id,#zp_report_settings_loading").hide(),Layout.Page.container.find("#zp_empty_report_settings_div_id").show())},showHideConfirmDeleteButtons:function(obj,toggleId,divClass){Layout.Page.container.find("."+divClass).css("overflow-x","hidden"),$(obj).parent().toggle("drop",{direction:"right"},200,function(){$(obj).parent().siblings("#"+toggleId).toggle("drop",200),Layout.Page.container.find("."+divClass).css("overflow-x","")})},iterate:function(reportList){void 0!==reportList&&$.each(reportList,function(key,value){var rsJson={};rsJson.reportSettID=value.rsID;var freq=value.rsFrequency;if(freq===RSCONSTANTS.MONTHLY){rsJson.frequencyCode=freq,rsJson.frequencyName=ZPI18N.getString("zp.monthly"),rsJson.toDayCode=value.rsToDay,rsJson.toDayName=ZPI18N.getString("zp.schlastday"),value.rsToDay!==RSCONSTANTS.LASTDAY&&(rsJson.toDayName=value.rsToDay);var startDay=ReportSettings.getStartDayFromEndDay(freq,value.rsToDay),info=ReportSettings.getStartDayEndDayInfo(freq,value.rsToDay),cycle=startDay;startDay!==RSCONSTANTS.LASTDAY&&(cycle+=ReportSettings.getNumberSuffix(parseInt(startDay))),cycle+=" <span class='dgry'>"+info[0]+"</span> - "+rsJson.toDayName,rsJson.toDayCode!==RSCONSTANTS.LASTDAY&&(cycle+=ReportSettings.getNumberSuffix(parseInt(rsJson.toDayName))),cycle+=" <span class='dgry'>"+info[1]+"</span>",rsJson.ppcycle=cycle,rsJson.startDayCode=startDay,rsJson.closureDayCode=value.rsClosureDay,rsJson.closureDayName=ZPI18N.getString("zp.select"),value.rsClosureDay===RSCONSTANTS.LASTDAY?rsJson.closureDayName=ZPI18N.getString("zp.schlastday"):value.rsClosureDay!==RSCONSTANTS.NONE&&(rsJson.closureDayName=value.rsClosureDay)}else if(freq===RSCONSTANTS.SEMIMONTHLY){rsJson.frequencyCode=freq,rsJson.frequencyName=ZPI18N.getString("zp.monthly"),rsJson.toDayCode=value.rsToDay,rsJson.toDayName=ZPI18N.getString("zp.schlastday"),value.rsToDay!==RSCONSTANTS.LASTDAY&&(rsJson.toDayName=value.rsToDay);var stEndDet=ReportSettings.getStartDayEndDay(value.rsToDay);info=ReportSettings.getStartDayEndDayInfo(freq,value.rsToDay);cycle="<div>"+stEndDet.startDay_1,stEndDet.startDay_1!==RSCONSTANTS.LASTDAY&&(cycle+=ReportSettings.getNumberSuffix(parseInt(stEndDet.startDay_1))),cycle+=" <span class='dgry'>"+info[0]+"</span> - "+rsJson.toDayName,rsJson.toDayCode!==RSCONSTANTS.LASTDAY&&(cycle+=ReportSettings.getNumberSuffix(parseInt(rsJson.toDayName))),cycle+=" <span class='dgry'>"+info[1]+"</span>",cycle+=" </div>",cycle+="<div class='MT10'>"+stEndDet.startDay_2,stEndDet.startDay_2!==RSCONSTANTS.LASTDAY&&(cycle+=ReportSettings.getNumberSuffix(parseInt(stEndDet.startDay_2))),stEndDet.endDay_2===RSCONSTANTS.LASTDAY?cycle+=" <span class='dgry'>"+info[2]+"</span> - "+ZPI18N.getString("zp.schlastday"):(cycle+=" <span class='dgry'>"+info[2]+"</span> - "+stEndDet.endDay_2,cycle+=ReportSettings.getNumberSuffix(parseInt(stEndDet.endDay_2))),cycle+=" <span class='dgry'>"+info[3]+"</span>",cycle+=" </div>",rsJson.ppcycle=cycle,rsJson.info=info,rsJson.startDayCode=startDay,rsJson.closureDayCode=value.rsClosureDay,rsJson.toDayCode_2=value.rsSecToDay,rsJson.closureDayCode_2=value.rsSecClosureDay,rsJson.closureDayName=ZPI18N.getString("zp.select"),value.rsClosureDay===RSCONSTANTS.LASTDAY?rsJson.closureDayName=ZPI18N.getString("zp.schlastday"):value.rsClosureDay!==RSCONSTANTS.NONE&&(rsJson.closureDayName=value.rsClosureDay),rsJson.closureDayName_2=ZPI18N.getString("zp.select"),value.rsSecClosureDay===RSCONSTANTS.LASTDAY?rsJson.closureDayName_2=ZPI18N.getString("zp.schlastday"):value.rsSecClosureDay!==RSCONSTANTS.NONE&&(rsJson.closureDayName_2=value.rsSecClosureDay),rsJson.rsSecPayrollClosure=value.rsSecPayrollClosure}else{rsJson.frequencyCode=freq,rsJson.frequencyName=ZPI18N.getString("zp.weekly"),rsJson.toDayCode=value.rsToDay,rsJson.toDayName=RSCONSTANTS.WEEK_NAME[value.rsToDay];startDay=ReportSettings.getStartDayFromEndDay(freq,value.rsToDay),cycle=RSCONSTANTS.WEEK_NAME[startDay]+" - "+rsJson.toDayName;rsJson.ppcycle=cycle,rsJson.startDayCode=startDay,rsJson.closureDayCode=value.rsClosureDay,rsJson.closureDayName=ZPI18N.getString("zp.select"),value.rsClosureDay!==RSCONSTANTS.NONE&&(rsJson.closureDayName=RSCONSTANTS.WEEK_NAME[value.rsClosureDay])}rsJson.rsName=ZPeople.decodeTxt(value.rsName),rsJson.isFreeze=value.rsIsFreeze,rsJson.rsProcessEncashment=value.rsProcessEncashment,rsJson.payrollClosure=ZP.optValue(value,"rsPayrollClosure",-1),rsJson.locationList=value.rsLocations,ReportSettings.ALL_LIST[rsJson.reportSettID]=rsJson})},constructAddEditPage:function(obj,isUpdate){var customFooter=$(ZPeople.BSModal.MODAL_FOOTER).clone();customFooter.append("<div id='zp_rs_input_warning_div' class='label-message ZPAltmsg DN'><p class='dorg' id='zp_rs_input_warning'></p></div>"),ZPeople.BSModal.setup({id:ReportSettings.MODAL_ID,type:2,modalClass:"popRgtModel ZPsecModal",header:ZPI18N.getString("zp.payperiodaddbutton"),body:ZPeople.LOADING_HTML,buttonValue:ZPI18N.getString("zp.save"),successCallback:isUpdate?ReportSettings.updateAction:ReportSettings.saveAction,footer:customFooter});var modelCnt=1,i=0;if(document.getElementsByClassName("modal-backdrop  in").length>1)for(;i<document.getElementsByClassName("modal-backdrop  in").length;)"modal-backdrop  in"==document.getElementsByClassName("modal-backdrop  in")[i].className&&(modelCnt>1?document.getElementsByClassName("modal-backdrop  in")[i].remove():modelCnt+=1),i++;ReportSettings.INPUT_PAGE=ReportSettings.LAYOUT.clone(),ReportSettings.INPUT_PAGE.find("#zp_rs_location").html(ZPUtil.Location.constructLocationComboBoxOption()),Layout.Page.container.find("#"+ReportSettings.MODAL_ID).find(".modal-body").html(ReportSettings.INPUT_PAGE),Layout.Page.container.find("#"+ReportSettings.MODAL_ID).find(".modal-footer").find("#cycle_details")[0]?Layout.Page.container.find("#"+ReportSettings.MODAL_ID).find(".modal-footer").find("#cycle_details").css("display","none"):Layout.Page.container.find("#"+ReportSettings.MODAL_ID).find(".modal-footer").append('<div class="label-message PPAltmsg label-note DN" id="cycle_details"></div>'),ReportSettings.defaultAction();var repSettID=$(obj).attr("rsID");Object.keys(ReportSettings.ALL_LIST).length>0&&$.each(ReportSettings.ALL_LIST,function(key,value){repSettID!==value.reportSettID&&$.each(value.locationList,function(key,value){Layout.Page.container.find("#zp_rs_location").find("option[value="+key+"]").remove()})}),Layout.Page.container.find("[data-popover]").popover(),isUpdate&&void 0!==obj&&void 0!==repSettID&&(ReportSettings.localValues.repSettID=repSettID,ReportSettings.populateData(repSettID))},populateData:function(repSettID){var rs=ReportSettings.ALL_LIST[repSettID];ReportSettings.INPUT_PAGE.find(".label-message").addClass("DN"),ReportSettings.INPUT_PAGE.find("#zp_rs_name").val(rs.rsName),ReportSettings.INPUT_PAGE.find("#zp_rs_frequency").select2("val",rs.frequencyCode+"").trigger("change"),ReportSettings.INPUT_PAGE.find("#zp_rs_from_day").select2("val",[rs.startDayCode]),ReportSettings.INPUT_PAGE.find("#zp_rs_to_day").select2("val",[rs.toDayCode]).trigger("change"),ReportSettings.INPUT_PAGE.find("#zp_rs_closure_day").select2("val",[rs.closureDayCode]).trigger("change"),ReportSettings.INPUT_PAGE.find("#zp_rs_closureday_semMont").select2("val",[rs.closureDayCode_2]).trigger("change"),ReportSettings.INPUT_PAGE.find("#zp_rs_freeze_date").select2("val",[rs.payrollClosure]).trigger("change"),ReportSettings.INPUT_PAGE.find("#zp_rs_freeze_date2").select2("val",[rs.rsSecPayrollClosure]).trigger("change"),ReportSettings.INPUT_PAGE.find("#zp_rs_freeze")[0].checked=rs.isFreeze,ReportSettings.INPUT_PAGE.find("#zp_rs_freeze")[0].onchange(),ReportSettings.INPUT_PAGE.find("#zp_rs_encash")[0].checked=rs.rsProcessEncashment,ReportSettings.INPUT_PAGE.find("#zp_rs_encash")[0].onchange(),ReportSettings.INPUT_PAGE.find("#zp_rs_location").select2("val",Object.keys(rs.locationList))},defaultAction:function(){Layout.Page.container.find(".error-msg").hide(),Layout.Page.container.find("#zp_rs_name").on("keypress",function(){Layout.Page.container.find("#zp_rs_name").val().length<=0&&Layout.Page.container.find("#zp_rs_name_error").hide()}),Layout.Page.container.find("#zp_rs_location").select2({placeholder:ZPI18N.getString("zp.select")}),Layout.Page.container.find("#zp_rs_frequency").select2({minimumResultsForSearch:1/0}),Layout.Page.container.find("#zp_rs_closure_day,#zp_rs_to_day,#zp_rs_from_day,#zp_rs_closureday_semMont,#zp_rs_today_semMont,#zp_rs_fromday_semMont").select2(),Layout.Page.container.find("#zp_rs_frequency").select2("val","1").trigger("change"),Layout.Page.container.find("#zp_rs_to_day,#zp_rs_from_day,#zp_rs_today_semMont,#zp_rs_fromday_semMont").select2("val",[RSCONSTANTS.NONE]),Layout.Page.container.find("#zp_rs_from_day,#zp_rs_fromday_semMont,#zp_rs_today_semMont").select2("disable"),Layout.Page.container.find("#zp_rs_closure_day,#zp_rs_closureday_semMont").select2("val",[RSCONSTANTS.NONE]),Layout.Page.container.find("#zp_rs_name").val(null)},validateInput:function(fromSave){var isValid=ReportSettings.validateEndDay(fromSave);return isValid=isValid?ReportSettings.validateClosureDay():isValid},validateEndDay:function(fromSave){Layout.Page.container.find("#zp_rs_frequency_error,#zp_rs_to_day_error").hide();var isValid=!0,frequency=Layout.Page.container.find("#zp_rs_frequency").select2("val"),toDay=parseInt(Layout.Page.container.find("#zp_rs_to_day").val());if(void 0===frequency?(Layout.Page.container.find("#zp_rs_frequency_error").html(ZPI18N.getString("zp.frequencyerror")).show(),isValid=!1):(null===toDay||void 0===toDay||isNaN(toDay)||-1===toDay)&&(Layout.Page.container.find("#zp_rs_to_day_error").html(ZPI18N.getString("zp.enddateerror")).show(),ReportSettings.INPUT_PAGE.find("#zp_rs_from_day").select2("val",[RSCONSTANTS.NONE]),Layout.Page.container.find("#zp_rs_startday_info,#zp_rs_endday_info").hide(),isValid=!1),!isValid)return isValid;frequency=parseInt(frequency),Layout.Page.container.find("#zp_rs_to_day_info").hide();var startDayVal;if(frequency===RSCONSTANTS.WEEKLY||frequency===RSCONSTANTS.BIWEEKLY){var prevWeekDay=toDay>=RSCONSTANTS.SATURDAY?RSCONSTANTS.SUNDAY:[toDay+1];"Report will generate from  "+RSCONSTANTS.WEEK_NAME[prevWeekDay]+" to "+RSCONSTANTS.WEEK_NAME[toDay]+".",ReportSettings.INPUT_PAGE.find("#zp_rs_from_day").select2("val",[prevWeekDay]),Layout.Page.container.find("#zp_rs_startday_info,#zp_rs_endday_info").hide();var sDayInfo=ZPI18N.getString("zp.pppreviousweek"),eDayInfo=ZPI18N.getString("zp.sofcurrentweek");6===toDay&&frequency===RSCONSTANTS.WEEKLY?sDayInfo=ZPI18N.getString("zp.sofcurrentweek"):6!==toDay&&frequency===RSCONSTANTS.BIWEEKLY&&(sDayInfo=ZPI18N.getString("zp.ppbeforepreviousweek")),Layout.Page.container.find("#zp_rs_startday_info").text(sDayInfo).show(),Layout.Page.container.find("#zp_rs_endday_info").text(eDayInfo).show()}else if(frequency===RSCONSTANTS.MONTHLY){var startDayInfo,endDayInfo;if(startDayVal=1,toDay===RSCONSTANTS.LASTDAY)"Report will generate from 1"+ReportSettings.getNumberSuffix(1)+" of current month to LAST DAY of current month.",startDayInfo=endDayInfo=ZPI18N.getString("zp.sofcurrentmonth");else{var prevMonthDay=[toDay+1];"Report will generate from "+prevMonthDay+ReportSettings.getNumberSuffix(prevMonthDay)+" of previous month to "+toDay+ReportSettings.getNumberSuffix(toDay)+" of current month.",startDayVal=prevMonthDay,startDayInfo=ZPI18N.getString("zp.pppreviousmonth"),endDayInfo=ZPI18N.getString("zp.sofcurrentmonth")}ReportSettings.INPUT_PAGE.find("#zp_rs_from_day").select2("val",[startDayVal]),Layout.Page.container.find("#zp_rs_startday_info").text(startDayInfo).show(),Layout.Page.container.find("#zp_rs_endday_info").text(endDayInfo).show()}else if(frequency===RSCONSTANTS.SEMIMONTHLY){var stEndDet=ReportSettings.getStartDayEndDay(toDay);startDayVal=stEndDet.startDay_1;var secEndDayVal=stEndDet.endDay_2,secStartDayVal=stEndDet.startDay_2;ReportSettings.INPUT_PAGE.find("#zp_rs_from_day").select2("val",[startDayVal]),ReportSettings.INPUT_PAGE.find("#zp_rs_fromday_semMont").select2("val",[secStartDayVal]),ReportSettings.INPUT_PAGE.find("#zp_rs_today_semMont").select2("val",[secEndDayVal]),fromSave||ReportSettings.setDayInfo(toDay)}var closureDay=parseInt(Layout.Page.container.find("#zp_rs_closure_day").val());return null===closureDay||void 0===closureDay||isNaN(closureDay)||-1===closureDay?isValid:(ReportSettings.validateClosureDay(),isValid)},getStartDayEndDay:function(toDay){var startDay_1=toDay-14,endDay_2=startDay_1-1,startDay_2=toDay+1,info={};return 15===toDay||14===toDay?(startDay_1=1,startDay_2=toDay+1,endDay_2=RSCONSTANTS.LASTDAY):toDay<15?startDay_1=(endDay_2=(startDay_2=toDay+1)+14)+1:toDay===RSCONSTANTS.LASTDAY&&(startDay_1=16,startDay_2=1,endDay_2=15),info.startDay_1=startDay_1,info.startDay_2=startDay_2,info.endDay_1=toDay,info.endDay_2=endDay_2,info},setDayInfo:function(toDay){var secClsDayVal=parseInt(Layout.Page.container.find("#zp_rs_today_semMont").val()),startDayInfo=ZPI18N.getString("zp.sofcurrentmonth"),endDayInfo=startDayInfo;RSCONSTANTS.NONE,ZPI18N.getString("zp.select");Layout.Page.container.find("#zp_rs_closure_day,#zp_rs_freeze_date").html(ReportSettings.consOptionForClsDay(toDay)).select2("val","-1"),Layout.Page.container.find("#zp_rs_closureday_semMont,#zp_rs_freeze_date2").html(ReportSettings.consOptionForClsDay(secClsDayVal)).select2("val","-1"),toDay<14?startDayInfo=ZPI18N.getString("zp.pppreviousmonth"):toDay===RSCONSTANTS.LASTDAY?(startDayInfo=endDayInfo=ZPI18N.getString("zp.pppreviousmonth"),RSCONSTANTS.LASTDAY,ZPI18N.getString("zp.schlastday")):toDay>15&&(startDayInfo=endDayInfo=ZPI18N.getString("zp.pppreviousmonth")),Layout.Page.container.find("#zp_rs_startday_info").text(startDayInfo).show(),Layout.Page.container.find("#zp_rs_endday_info").text(endDayInfo).show(),Layout.Page.container.find("#zp_rs_closure_day_info,#zp_rs_closure_dayinfo_semMont").text("").hide()},setClsDayInfo:function(){var clsDayVal=parseInt(Layout.Page.container.find("#zp_rs_closure_day").val()),secClsDayVal=parseInt(Layout.Page.container.find("#zp_rs_closureday_semMont").val()),toDayVal=parseInt(Layout.Page.container.find("#zp_rs_to_day").val()),secToDayVal=parseInt(Layout.Page.container.find("#zp_rs_today_semMont").val()),clsDayInfo=ZPI18N.getString("zp.sofcurrentmonth");return toDayVal<=15&&secClsDayVal<secToDayVal?ZPI18N.getString("zp.ppnextmonth"):toDayVal===RSCONSTANTS.LASTDAY&&toDayVal===clsDayVal?clsDayInfo=ZPI18N.getString("zp.pppreviousmonth"):toDayVal>15&&toDayVal<=clsDayVal&&(clsDayInfo=ZPI18N.getString("zp.pppreviousmonth")),-1===clsDayVal&&(clsDayInfo=""),clsDayInfo},consOptionForClsDay:function(toDay){var bufferOpt="<option value="+RSCONSTANTS.NONE+">"+ZPI18N.getString("zp.select")+"</option>";32===toDay&&(toDay=29);for(var i=toDay;i<toDay+7;i++)if(29===i)bufferOpt+='<option value="'+RSCONSTANTS.LASTDAY+'">'+ZPI18N.getString("zp.schlastday")+"</option>";else if(i>29){var tDay=i-29;bufferOpt+='<option value="'+tDay+'">'+tDay+ReportSettings.getNumberSuffix(tDay)+"</option>"}else bufferOpt+='<option value="'+i+'">'+i+ReportSettings.getNumberSuffix(i)+"</option>";return bufferOpt},getStartDayEndDayInfo:function(frequency,toDay){var info=[];return frequency===RSCONSTANTS.MONTHLY?toDay===RSCONSTANTS.LASTDAY?(info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth"))):(info.push(ZPI18N.getString("zp.pppreviousmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth"))):frequency===RSCONSTANTS.SEMIMONTHLY&&(15===toDay?(info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth"))):toDay===RSCONSTANTS.LASTDAY?(info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.ppnextmonth")),info.push(ZPI18N.getString("zp.ppnextmonth")),info.push(ZPI18N.getString("zp.ppnextmonth"))):toDay<15?(info.push(ZPI18N.getString("zp.pppreviousmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth"))):(info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.sofcurrentmonth")),info.push(ZPI18N.getString("zp.ppnextmonth")),info.push(ZPI18N.getString("zp.ppnextmonth")))),info},getStartDayFromEndDay:function(frequency,toDay){if(frequency===RSCONSTANTS.WEEKLY||frequency===RSCONSTANTS.BIWEEKLY)return toDay>=RSCONSTANTS.SATURDAY?RSCONSTANTS.SUNDAY:toDay+1;if(frequency===RSCONSTANTS.MONTHLY){return toDay===RSCONSTANTS.LASTDAY?1:toDay+1}},validateClosureDay:function(){Layout.Page.container.find("#zp_rs_closure_day_error,#zp_rs_closure_dayerror_semMont").hide();var isValid=!0,frequency=Layout.Page.container.find("#zp_rs_frequency").select2("val"),fromDay=parseInt(Layout.Page.container.find("#zp_rs_from_day").val()),toDay=parseInt(Layout.Page.container.find("#zp_rs_to_day").val()),closureDay=parseInt(Layout.Page.container.find("#zp_rs_closure_day").val()),closureDay2=parseInt(Layout.Page.container.find("#zp_rs_closureday_semMont").val()),report_freeze=parseInt(Layout.Page.container.find("#zp_rs_freeze_date").val()),report_freeze2=parseInt(Layout.Page.container.find("#zp_rs_freeze_date2").val());if(void 0===frequency||frequency===RSCONSTANTS.NONE?(Layout.Page.container.find("#zp_rs_frequency_error").html(ZPI18N.getString("zp.frequencyerror")).show(),isValid=!1):null===toDay||void 0===toDay||isNaN(toDay)||-1===toDay?(Layout.Page.container.find("#zp_rs_to_day_error").html(ZPI18N.getString("zp.enddateerror")).show(),isValid=!1):null===closureDay||void 0===closureDay||isNaN(closureDay)||-1===closureDay?(Layout.Page.container.find("#zp_rs_closure_day_error").html(ZPI18N.getString("zp.closuredayerror")).show(),isValid=!1):"4"!==frequency||null!==closureDay2&&void 0!==closureDay2&&!isNaN(closureDay2)&&-1!==closureDay2||(isValid=!1),!isValid)return!1;Layout.Page.container.find("#zp_rs_closure_day_info").hide();var closureMsg="";(frequency=parseInt(frequency))!==RSCONSTANTS.WEEKLY&&frequency!==RSCONSTANTS.BIWEEKLY||closureDay===RSCONSTANTS.NONE?frequency===RSCONSTANTS.MONTHLY&&closureDay!==RSCONSTANTS.NONE?closureMsg=closureDay>=toDay&&closureDay<=RSCONSTANTS.LASTDAY?(RSCONSTANTS.LASTDAY,ZPI18N.getString("zp.sofcurrentmonth")):(RSCONSTANTS.LASTDAY,ZPI18N.getString("zp.ppnextmonth")):frequency===RSCONSTANTS.SEMIMONTHLY&&closureDay!==RSCONSTANTS.NONE&&(closureMsg=ReportSettings.setClsDayInfo()):closureMsg=ZPI18N.getString("zp.ppeveryweek");report_freeze!==RSCONSTANTS.NONE&&(frequency===RSCONSTANTS.WEEKLY||frequency===RSCONSTANTS.BIWEEKLY?ZPI18N.getString("zp.ppeveryweek"):frequency===RSCONSTANTS.MONTHLY&&ZPI18N.getString("zp.sofcurrentmonth")),Layout.Page.container.find("#zp_rs_closure_day_info").text(closureMsg).show().css("display","inline-block");var lock_enabled=Layout.Page.container.find("#zp_rs_freeze").is(":checked");if(frequency===RSCONSTANTS.SEMIMONTHLY){var fromDay2=parseInt(Layout.Page.container.find("#zp_rs_fromday_semMont").val()),toDay2=parseInt(Layout.Page.container.find("#zp_rs_today_semMont").val()),period_details=ReportSettings.getPayPeriod(fromDay,toDay,closureDay,report_freeze,frequency,fromDay2,toDay2,closureDay2,report_freeze2),process_date=Calendar.formatDate(period_details.closure)+", "+Calendar.formatDate(period_details.closure2),payprocess_date=Calendar.formatDate(period_details.payroll_closure)+" "+(period_details.payroll_closure>period_details.closure?"00:00 AM":"")+", "+Calendar.formatDate(period_details.payroll_closure2)+" "+(period_details.payroll_closure2===period_details.closure2?"":"00:00 AM"),processReports=ZPI18N.getString("zp.leave.lopreport")+(Layout.Page.container.find("#zp_rs_encash").is(":checked")?", "+ZPI18N.getString("zp.leave.encashmentreport",["Leave"]):"")+" & "+ZPI18N.getString("zp.overtimereport"),help="<div class='MB10'><b>"+ZPI18N.getString("zp.ppgeneration.summary")+"</b></div><p><span>i)</span>Upcoming Pay Cycles : "+Calendar.formatDate(period_details.start)+" - "+Calendar.formatDate(period_details.end)+", "+Calendar.formatDate(period_details.start2)+" - "+Calendar.formatDate(period_details.end2)+"</p><p><span>ii)</span>"+ZPI18N.getString("zp.payperiod.generation.help1",[processReports,process_date])+"</p>";lock_enabled&&(help+="<p><span>iii)</span>"+ZPI18N.getString("zp.payperiod.generation.help2",[process_date])+"</p>"),help+=report_freeze>-1&&report_freeze2>-1?"<p><span>"+(lock_enabled?"iv)":"iii)")+"</span>"+ZPI18N.getString("zp.payperiod.generation.help3",[payprocess_date])+"</span></p>":"",Layout.Page.container.find("#cycle_details").html(help).show().css("display","inline-block")}else{period_details=ReportSettings.getPayPeriod(fromDay,toDay,closureDay,report_freeze,frequency),process_date=Calendar.formatDate(period_details.closure),payprocess_date=Calendar.formatDate(period_details.payroll_closure)+" "+(period_details.payroll_closure>period_details.closure?"00:00 AM":""),processReports=ZPI18N.getString("zp.leave.lopreport")+(Layout.Page.container.find("#zp_rs_encash").is(":checked")?", "+ZPI18N.getString("zp.leave.encashmentreport",["Leave"]):"")+" & "+ZPI18N.getString("zp.overtimereport"),help="<div class='MB10'><b>"+ZPI18N.getString("zp.ppgeneration.summary")+"</b></div><p><span>i)</span>Upcoming Pay Cycle : "+Calendar.formatDate(period_details.start)+" - "+Calendar.formatDate(period_details.end)+"</p><p><span>ii)</span>"+ZPI18N.getString("zp.payperiod.generation.help1",[processReports,process_date])+"</p>";lock_enabled&&(help+="<p><span>iii)</span>"+ZPI18N.getString("zp.payperiod.generation.help2",[process_date])+"</p>"),help+=report_freeze>-1?"<p><span>"+(lock_enabled?"iv)":"iii)")+"</span>"+ZPI18N.getString("zp.payperiod.generation.help3",[payprocess_date])+"</span></p>":"",Layout.Page.container.find("#cycle_details").html(help).show().css("display","inline-block")}return isValid},getPayPeriodSummary:function(start,end,closure,payroll_closure,frequency,start2,end2,closure2,payroll_closure2){var params={mode:"getCurrentPayPeriod"},conf={start:start,end:end,closure:closure,frequency:frequency,mode:{1:"Monthly",2:"Weekly",3:"Weekly",4:"SemiMonthly"}[frequency]};-1!=payroll_closure&&!isNaN(payroll_closure)&&void 0!=payroll_closure&&(conf.payroll=payroll_closure),4==frequency&&(conf.start2=start2,conf.end2=end2,conf.closure2=closure2,-1!=payroll_closure2&&!isNaN(payroll_closure2)&&void 0!=payroll_closure2&&(conf.payroll2=payroll_closure2)),params[csrfParamName]=csrfToken,params.payperiodConf=JSON.stringify(conf);var payperiod={};return ZPeople.Request.sendAsyncPost("reportSettingAction.zp",params,function(result){result.data&&(payperiod=result.data)}),payperiod},getPayPeriod:function(start,end,closure,payroll_closure,frequency,start2,end2,closure2,payroll_closure2){var cls_date,s_date,e_date,paycls_date,cur_date=Calendar.currrentDate,period={};if(cls_date=s_date=e_date=paycls_date=cur_date,frequency===RSCONSTANTS.MONTHLY||frequency===RSCONSTANTS.SEMIMONTHLY?(cls_date=new Date(cur_date),cur_date.getDate()>closure?(cls_date.setMonth(cur_date.getMonth()+1),ZPUtil.setDate(cls_date,closure)):ZPUtil.setDate(cls_date,closure),e_date=new Date(cls_date),ZPUtil.setDate(e_date,end),e_date>cls_date&&(32==end?e_date.setDate(0):(e_date.setMonth(e_date.getMonth()-1),ZPUtil.setDate(e_date,end))),(s_date=new Date(e_date)).setDate(e_date.getDate()+1),s_date.setMonth(s_date.getMonth()-1),paycls_date=new Date(cls_date),ZPUtil.setDate(paycls_date,payroll_closure),paycls_date<cls_date&&(paycls_date.setMonth(paycls_date.getMonth()+1),ZPUtil.setDate(paycls_date,payroll_closure))):frequency!==RSCONSTANTS.WEEKLY&&frequency!==RSCONSTANTS.BIWEEKLY||((cls_date=new Date(cur_date)).setDay(closure),cur_date.getDate()>cls_date.getDate()&&cls_date.setDate(cls_date.getDate()+7),(e_date=new Date(cls_date)).setDay(end),e_date.getDate()>cls_date.getDate()&&e_date.setDate(e_date.getDate()-7),s_date=new Date(e_date),frequency===RSCONSTANTS.BIWEEKLY?s_date.setDate(e_date.getDate()-13):s_date.setDate(e_date.getDate()-6),(paycls_date=new Date(cls_date)).setDay(payroll_closure),paycls_date<cls_date&&paycls_date.setDate(paycls_date.getDate()+7)),frequency===RSCONSTANTS.SEMIMONTHLY){if(cur_date>cls_date)return ReportSettings.getPayPeriod(start2,end2,closure2,payroll_closure2,frequency,start,end,closure,payroll_closure);var cls_date2,s_date2,e_date2,paycls_date2;s_date=new Date(e_date),ZPUtil.setDate(s_date,start),s_date>e_date&&s_date.setMonth(s_date.getMonth()-1),cls_date2=new Date(cur_date),ZPUtil.setDate(cls_date2,closure2),cur_date<=cls_date2?(cls_date2.setMonth(cur_date.getMonth()+1),ZPUtil.setDate(cls_date2,closure2)):cls_date>=cur_date&&cls_date2<cls_date&&cls_date2<cur_date&&(cls_date2.setMonth(cls_date2.getMonth()+1),ZPUtil.setDate(cls_date2,closure2)),e_date2=new Date(cls_date2),ZPUtil.setDate(e_date2,end2),e_date2>cls_date2&&(32==end2?e_date2.setDate(0):(e_date2.setMonth(e_date2.getMonth()-1),ZPUtil.setDate(e_date2,end2))),s_date2=new Date(e_date2),ZPUtil.setDate(s_date2,start2),s_date2>e_date2&&s_date2.setMonth(s_date2.getMonth()-1),paycls_date2=new Date(cls_date2),ZPUtil.setDate(paycls_date2,payroll_closure2),paycls_date2<cls_date2&&(paycls_date2.setMonth(paycls_date2.getMonth()+1),ZPUtil.setDate(paycls_date2,payroll_closure2)),period.start2=s_date2,period.end2=e_date2,period.closure2=cls_date2,period.payroll_closure2=paycls_date2}return period.start=s_date,period.end=e_date,period.closure=cls_date,period.payroll_closure=paycls_date,period},getClosureDayInfo:function(frequency,toDay,closureDay){var closureMsg="";return(frequency=parseInt(frequency))!==RSCONSTANTS.WEEKLY&&frequency!==RSCONSTANTS.BIWEEKLY||closureDay===RSCONSTANTS.NONE?frequency!==RSCONSTANTS.MONTHLY&&frequency!==RSCONSTANTS.SEMIMONTHLY||closureDay===RSCONSTANTS.NONE||(closureMsg=closureDay>=toDay&&closureDay<=RSCONSTANTS.LASTDAY?(RSCONSTANTS.LASTDAY,ZPI18N.getString("zp.sofcurrentmonth")):(RSCONSTANTS.LASTDAY,ZPI18N.getString("zp.ppnextmonth"))):closureMsg=ZPI18N.getString("zp.ppeveryweek"),closureMsg},saveAction:function(modal,isUpdate,checkLocationInput){Layout.Page.container.find("#zp_rs_name_error").hide(),Layout.Page.container.find("#zp_rs_location_error").hide();var isValid=ReportSettings.validateInput(!0),name=$.trim(Layout.Page.container.find("#zp_rs_name").val());(void 0===name||name.length<=0)&&(Layout.Page.container.find("#zp_rs_name_error").html(ZPI18N.getString("zp.nameerror")).show(),isValid=!1);var locVal=Layout.Page.container.find("#zp_rs_location").val(),locationList=null===locVal||0==locVal.length?null:locVal.toString();if($.each(ReportSettings.ALL_LIST,function(settingId,setting){null!=locationList||0!=_.size(setting.locationList)||isUpdate&&ReportSettings.localValues.repSettID==setting.reportSettID||(Layout.Page.container.find("#zp_rs_location_error").html(ZPI18N.getString("zp.locationerror")).show(),isValid=!1)}),isValid){var frequency=Layout.Page.container.find("#zp_rs_frequency").select2("val"),toDay=Layout.Page.container.find("#zp_rs_to_day").val(),fromDay=Layout.Page.container.find("#zp_rs_from_day").val(),closureDay=Layout.Page.container.find("#zp_rs_closure_day").val(),isFreeze=Layout.Page.container.find("#zp_rs_freeze").is(":checked"),processEncashment=Layout.Page.container.find("#zp_rs_encash").is(":checked"),payPerCycle={};payPerCycle.rsName=name,payPerCycle.rsFrequency=parseInt(frequency),payPerCycle.rsFromDay=parseInt(fromDay),payPerCycle.rsToDay=parseInt(toDay),payPerCycle.rsClosureDay=parseInt(closureDay),payPerCycle.rsIsFreeze=isFreeze,payPerCycle.rsProcessEncashment=processEncashment,payPerCycle.rsPayrollClosure=Layout.Page.container.find("#zp_rs_freeze_date").val(),"4"===frequency&&(payPerCycle.rsSecClosureDay=parseInt(Layout.Page.container.find("#zp_rs_closureday_semMont").val()),payPerCycle.rsSecPayrollClosure=Layout.Page.container.find("#zp_rs_freeze_date2").val(),payPerCycle.rsSecFromDay=parseInt(Layout.Page.container.find("#zp_rs_fromday_semMont").val()),payPerCycle.rsSecToDay=parseInt(Layout.Page.container.find("#zp_rs_today_semMont").val()));var url="reportSettingAction.zp";ZPeople.Module.CURRENT_MODULEPREFIX&&(url="/"+ZPeople.Module.CURRENT_MODULEPREFIX+url);var params={mode:void 0!==isUpdate&&isUpdate?"updateReportSetting":"addReportSetting",reportSettingID:void 0!==isUpdate&&isUpdate?ReportSettings.localValues.repSettID:0,payPerCycle:JSON.stringify(payPerCycle),locationList:locationList};Layout.Page.container.find(".modal-footer").find("#zp_modal_blubtn").attr("disabled",!0),ZPeople.Request.sendAsyncPost(url,params,ReportSettings.afterSaveAction),allServicesInteg.getPayrollCycle(allServicesInteg.serviceName)}},updateAction:function(){var editRepSettID=ReportSettings.localValues.repSettID,locList=ReportSettings.ALL_LIST[editRepSettID].locationList,checkLocationInput=!1;null===Layout.Page.container.find("#zp_rs_location").val()&&Object.keys(locList).length<=0&&(checkLocationInput=!0),ReportSettings.saveAction(null,!0,checkLocationInput)},afterSaveAction:function(data){if("ACCESS_DENIED"===data.error)return ReportSettings.accessDenied(),null;Layout.Page.container.find(".modal-footer").find("#zp_modal_blubtn").prop("disabled",!1),ZPeople.BSModal.hide(ReportSettings.MODAL_ID),data.STATUS===ZPI18N.getString("zp.capfailure")?void 0!==data.CLIENT_MSG&&$.trim(data.CLIENT_MSG).length>0&&ZPeople.Message.showFailureMsg(data.CLIENT_MSG):data.STATUS===ZPI18N.getString("zp.capsuccess")&&(void 0!==data.CLIENT_MSG&&$.trim(data.CLIENT_MSG).length>0&&ZPeople.Message.showSuccessMsg(data.CLIENT_MSG),ReportSettings.showReportSettingList(!0))},deleteAction:function(obj){var repSettID=$(obj).attr("rsID"),url="reportSettingAction.zp";ZPeople.Module.CURRENT_MODULEPREFIX&&(url="/"+ZPeople.Module.CURRENT_MODULEPREFIX+url);var params={mode:"deleteReportSetting",reportSettingID:repSettID};ZPeople.Request.sendAsyncPost(url,params,ReportSettings.afterDeleteAction),allServicesInteg.getPayrollCycle(allServicesInteg.serviceName)},afterDeleteAction:function(data){if("ACCESS_DENIED"===data.error)return ReportSettings.accessDenied(),null;if(data.STATUS===ZPI18N.getString("zp.capfailure"))void 0!==data.CLIENT_MSG&&$.trim(data.CLIENT_MSG).length>0&&ZPeople.Message.showFailureMsg(data.CLIENT_MSG);else if(data.STATUS===ZPI18N.getString("zp.capsuccess")){void 0!==data.CLIENT_MSG&&$.trim(data.CLIENT_MSG).length>0&&ZPeople.Message.showSuccessMsg(data.CLIENT_MSG);var repSettID=data.DATA.reportSettingID;$("#zp_report_setting_table_body_id #tr_"+repSettID).remove(),delete ReportSettings.ALL_LIST[repSettID],Object.keys(ReportSettings.ALL_LIST).length<=0&&(Layout.Page.container.find("#zp_report_settings_list_div_id,#zp_report_settings_loading").hide(),Layout.Page.container.find("#zp_empty_report_settings_div_id").show())}},onFrequencyChange:function(){var freqVal=parseInt(Layout.Page.container.find("#zp_rs_frequency").select2("val"));Layout.Page.container.find("#zp_rs_cont_semMont").hide(),Layout.Page.container.find("#zp_rs_proCont_semMont,#zp_rs_freeze_cont2").hide(),Layout.Page.container.find("#zp_rs_ppprocDayText_1").text(ZPI18N.getString("zp.ppprocessingday")),Layout.Page.container.find("#zp_rs_freeze_dateText").text(ZPI18N.getString("zp.ppgenerationday")),freqVal===RSCONSTANTS.MONTHLY?(Layout.Page.container.find("#zp_rs_from_day").html(ReportSettings.monthlyOptions(!1,!0)),Layout.Page.container.find("#zp_rs_to_day").html(ReportSettings.monthlyOptions(!1,!1)),Layout.Page.container.find("#zp_rs_closure_day").html(ReportSettings.monthlyOptions(!0)),Layout.Page.container.find("#zp_rs_to_day,#zp_rs_from_day").select2("val",[RSCONSTANTS.NONE]),Layout.Page.container.find("#zp_rs_freeze_date").html(ReportSettings.monthlyOptions(!0,!1)).select2().select2("val",[RSCONSTANTS.NONE]),Layout.Page.container.find("#zp_rs_frequency_error,#zp_rs_startday_info,#zp_rs_endday_info,#zp_rs_closure_day_info,#zp_rs_closure_day_error").hide()):freqVal===RSCONSTANTS.WEEKLY||freqVal===RSCONSTANTS.BIWEEKLY?(Layout.Page.container.find("#zp_rs_from_day").html(ReportSettings.weeklyOptions(!1,!0)),Layout.Page.container.find("#zp_rs_to_day").html(ReportSettings.weeklyOptions(!1,!1)),Layout.Page.container.find("#zp_rs_closure_day").html(ReportSettings.weeklyOptions(!0)),Layout.Page.container.find("#zp_rs_freeze_date,#zp_rs_freeze_date2").html(ReportSettings.weeklyOptions(!0)).select2().select2("val",[RSCONSTANTS.NONE]),Layout.Page.container.find("#zp_rs_to_day,#zp_rs_from_day").select2("val",[RSCONSTANTS.NONE]),Layout.Page.container.find("#zp_rs_frequency_error,#zp_rs_startday_info,#zp_rs_endday_info,#zp_rs_closure_day_info,#zp_rs_closure_day_error").hide()):freqVal===RSCONSTANTS.SEMIMONTHLY?(Layout.Page.container.find("#zp_rs_ppprocDayText_1").text(ZPI18N.getString("zp.ppfirstprocessingday")),Layout.Page.container.find("#zp_rs_ppprocDayText_2").text(ZPI18N.getString("zp.ppsecondprocessingday")),Layout.Page.container.find("#zp_rs_freeze_dateText").text("1st "+ZPI18N.getString("zp.ppgenerationday")),Layout.Page.container.find("#zp_rs_freeze_dateText2").text("2nd "+ZPI18N.getString("zp.ppgenerationday")),Layout.Page.container.find("#zp_rs_cont_semMont,#zp_rs_proCont_semMont,#zp_rs_freeze_cont2").show(),Layout.Page.container.find("#zp_rs_from_day,#zp_rs_fromday_semMont").html(ReportSettings.monthlyOptions(!1,!0)),Layout.Page.container.find("#zp_rs_to_day,#zp_rs_today_semMont").html(ReportSettings.monthlyOptions(!1,!1)),Layout.Page.container.find("#zp_rs_closure_day,#zp_rs_closureday_semMont").html(ReportSettings.monthlyOptions(!0)),Layout.Page.container.find("#zp_rs_freeze_date,#zp_rs_freeze_date2").html(ReportSettings.monthlyOptions(!0,!1)).select2(),Layout.Page.container.find("#zp_rs_to_day,#zp_rs_from_day,#zp_rs_closureday_semMont,#zp_rs_today_semMont,#zp_rs_fromday_semMont").select2("val",[RSCONSTANTS.NONE]),Layout.Page.container.find("#zp_rs_frequency_error,#zp_rs_startdayinfo_semMont,#zp_rs_enddayinfo_semMont,#zp_rs_closure_dayinfo_semMont,#zp_rs_closure_dayerror_semMont").hide(),Layout.Page.container.find("#zp_rs_frequency_error,#zp_rs_startday_info,#zp_rs_endday_info,#zp_rs_closure_day_info,#zp_rs_closure_day_error").hide()):(Layout.Page.container.find("#zp_rs_to_day,#zp_rs_from_day").html(""),Layout.Page.container.find("#zp_rs_to_day,#zp_rs_from_day").select2("val",[RSCONSTANTS.NONE]),Layout.Page.container.find("#zp_rs_closure_day").html(""),Layout.Page.container.find("#zp_rs_to_day_error,#zp_rs_startday_info,#zp_rs_endday_info,#zp_rs_closure_day_error,#zp_rs_closure_day_info").hide()),Layout.Page.container.find("#zp_rs_closure_day").select2("val",[RSCONSTANTS.NONE]),Layout.Page.container.find("#zp_rs_freeze").attr("checked",!1)},closureDayOptions:function(isNoneRequired){var bufferOpt="";isNoneRequired&&(bufferOpt="<option value="+RSCONSTANTS.NONE+">"+ZPI18N.getString("zp.select")+"</option>");var cnt=0;cnt=parseInt(Layout.Page.container.find("#zp_rs_frequency").val())===RSCONSTANTS.MONTHLY?10:4;for(var i=1;i<=cnt;i++)bufferOpt+='<option value="'+i+'">'+i+"</option>";return bufferOpt},monthlyOptions:function(skipNone,isStart){var monthlyOpt="",cnt=28;skipNone?monthlyOpt="<option value="+RSCONSTANTS.NONE+">"+ZPI18N.getString("zp.select")+"</option>":isStart?(monthlyOpt="<option value="+RSCONSTANTS.NONE+">"+ZPI18N.getString("zp.ppstartday")+"</option>",cnt=29):monthlyOpt="<option value="+RSCONSTANTS.NONE+">"+ZPI18N.getString("zp.ppendday")+"</option>";for(var i=1;i<=cnt;i++)monthlyOpt+='<option value="'+i+'">'+i+ReportSettings.getNumberSuffix(i)+"</option>";return monthlyOpt+="<option value="+RSCONSTANTS.LASTDAY+">"+ZPI18N.getString("zp.schlastday")+"</option>"},weeklyOptions:function(skipNone,isStart){var weeklyOpt="";return weeklyOpt=skipNone?"<option value="+RSCONSTANTS.NONE+">"+ZPI18N.getString("zp.select")+"</option>":isStart?"<option value="+RSCONSTANTS.NONE+">"+ZPI18N.getString("zp.ppstartday")+"</option>":"<option value="+RSCONSTANTS.NONE+">"+ZPI18N.getString("zp.ppendday")+"</option>",weeklyOpt+="<option value="+RSCONSTANTS.SUNDAY+">"+ZPI18N.getString("zp.sunday")+"</option><option value="+RSCONSTANTS.MONDAY+">"+ZPI18N.getString("zp.monday")+"</option><option value="+RSCONSTANTS.TUESDAY+">"+ZPI18N.getString("zp.tuesday")+"</option><option value="+RSCONSTANTS.WEDNESDAY+">"+ZPI18N.getString("zp.wednesday")+"</option><option value="+RSCONSTANTS.THURSDAY+">"+ZPI18N.getString("zp.thursday")+"</option><option value="+RSCONSTANTS.FRIDAY+">"+ZPI18N.getString("zp.friday")+"</option><option value="+RSCONSTANTS.SATURDAY+">"+ZPI18N.getString("zp.saturday")+"</option>"},getNumberSuffix:function(num){if(-1===[11,12,13].indexOf(num)){var ss=num%10;switch(ss){case 1:case 2:case 3:return RSCONSTANTS.SUPERSCRIPT[ss+""];default:return RSCONSTANTS.SUPERSCRIPT[4]}}return RSCONSTANTS.SUPERSCRIPT[4]},accessDenied:function(){ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.adminerrormsg"))}},ReportSetting={localValues:{},ALL_LIST:{},conAbs_lt_select:0,showReportSettingList:function(refresh){if(settingsPage.container.find("#zp_report_Setting_list,#zp_empty_data").hide(),"#settings/service/marketplace/otherapplications"!==window.location.hash&&"#settings/service/marketplace/zohoapplications"!==window.location.hash&&settingsPage.container.html(ZPeople.LOADING_HTML),settingsPage.container.addClass("zpl_tblfxd"),Object.keys(ReportSetting.ALL_LIST).length<=0||refresh){var url="reportSettingAction.zp";settingsUrlProps.currentMode&&"marketplace"!==settingsUrlProps.currentMode&&(url="/"+settingsUrlProps.currentMode+url);ZPeople.Request.send(url,{mode:"getReportSettings"},ReportSetting.constructListPage,null,ReportSetting.handleError)}else"#settings/service/marketplace/otherapplications"===window.location.hash||"#settings/service/marketplace/zohoapplications"===window.location.hash?ReportSetting.constructData(ReportSetting.ALL_LIST,$("#payPerDv"+IntegrationSettings.serviceName)):ReportSetting.constructData(ReportSetting.ALL_LIST)},handleError:function(data){403==data.status&&(settingsPage.container.html(""),settingsPage.constructPermissionDeniedPage())},constructListPage:function(data){return"ACCESS_DENIED"===data.error?(ReportSettings.accessDenied(),null):data.STATUS===ZPI18N.getString("zp.capfailure")?(void 0!==data.CLIENT_MSG&&$.trim(data.CLIENT_MSG).length>0&&(ModuleComp.Msg.showFailureMsg(data.CLIENT_MSG),settingsPage.container.find("#zp_report_Setting_list,#zp_report_settings_loading").hide(),Timetracker.Util.showHideNoData({msg:ZPI18N.getString("zp.payperiod.nodatamsg"),buttonName:ZPI18N.getString("zp.payperiodaddbutton"),buttonCallBack:ReportSetting.constructAddEditPage,desc:ZPI18N.getString("zp.leave.payperioddef")})),null):(ReportSetting.autoApplyLeavePayperiod=!0,ReportSetting.iterate(data.DATA.reportSettingList),"#settings/service/marketplace/otherapplications"===window.location.hash||"#settings/service/marketplace/zohoapplications"===window.location.hash?ReportSetting.constructData(ReportSetting.ALL_LIST,$("#payPerDv"+IntegrationSettings.serviceName)):ReportSetting.constructData(ReportSetting.ALL_LIST),void AppExc.getApplicableIds())},contructHeader:function(){return'<thead><tr><th width="250">'+ZPI18N.getString("zp.ppname")+"</th> <th>"+ZPI18N.getString("zp.ppcycle")+"</th> <th>"+ZPI18N.getString("zp.ppprocessingday")+'</th> <th width="100"></th> </tr> </thead>'},constructData:function(data,id){if(void 0!==id?id.html('<div id="topSettMenu" class="zpl_btnmnu"><div class="zpl_rgt"><class="zpl_rgt"><button  class="zlabel zlabel--blue zlabel--medium" data-popup-open="configPay" onclick="ReportSetting.constructAddEditPage()">'+ZPI18N.getString("zp.payperiodaddbutton")+'</button></div></div><div class="zpl_rgtcnt"><div class="zpl_tblres" id="zp_report_Setting_list"><table class="zpl_tbl">'+ReportSetting.contructHeader()+'<tbody id="zp_report_setting_table_body_id"></tbody></table></div></div>'):settingsPage.container.html('<div class="zpl_crd zpl_topcrdhdr"><div class="zpl_crdhdr"><div><h4>'+ZPI18N.getString("zp.leave.report.payperiod")+"</h4><p>"+ZPI18N.getString("zp.leave.payperioddef")+'</p></div></div></div><div class="zpl_rgtcnt"><div id="topSettMenu" class="zpl_btnmnu"><div class="zpl_rgt"><button class="zlabel zlabel--blue zlabel--medium" data-popup-open="configPay" id="addPayPeriodBtn" onclick="ReportSetting.constructAddEditPage()">'+ZPI18N.getString("zp.payperiod.caddpayperiod")+'</button></div></div><div id="zp_report_settings_loading"></div><div class="zpl_tblres" id="zp_report_Setting_list"><table class="zpl_tbl">'+ReportSetting.contructHeader()+'<tbody id="zp_report_setting_table_body_id"></tbody></table></div></div>'),settingsPage.container.find("#zp_report_settings_loading").html(ZPeople.LOADING_HTML),Object.keys(data).length>0){settingsPage.container.find("#addPayPeriodBtn").closest(".zpl_btnmnu").removeClass("DNI"),settingsPage.container.find("#zp_report_Setting_list").show(),settingsPage.container.find("#zp_empty_data,#zp_report_settings_loading").hide(),settingsPage.container.find("#zp_report_setting_table_body_id").empty(),data=ReportSetting.ALL_LIST;var tbody=settingsPage.container.find(".zpl_tbl").find("tbody");$.each(data,function(key,value){var tr='<tr id="tr_'+value.reportSettID+'" rsID="'+value.reportSettID+'">';tr+="<td><span>"+ZPeople.escapeHtml(value.rsName)+"</span></td>",tr+="<td><span>"+value.ppcycle+"</span></td>",tr+="<td><span>",tr+=value.closureDayName,value.frequencyCode===RSCONSTANTS.MONTHLY&&value.closureDayCode!==RSCONSTANTS.LASTDAY&&(tr+=""+ReportSettings.getNumberSuffix(parseInt(value.closureDayName))),tr+=" "+ReportSettings.getClosureDayInfo(value.frequencyCode,value.toDayCode,value.closureDayCode)+"</span>",value.closureDayName_2&&(tr+="<span>"+value.closureDayName_2,value.frequencyCode===RSCONSTANTS.MONTHLY&&value.closureDayCode!==RSCONSTANTS.LASTDAY&&(tr+=""+ReportSettings.getNumberSuffix(parseInt(value.closureDayName_2))),tr+=" "+value.info[4],tr+="</span>"),tr+="</td>",tr+='<td rsID="'+value.reportSettID+'"><div class="zpl_hvr"><i class="PI_delete" title='+ZPI18N.getString("zp.delete")+"></i></div></td>",tbody.append(tr),ReportSetting.constructMoreOption(value.locationList,"locMoreOptions_"+value.reportSettID)}),tbody.on("click","tr td:not(:last-child)",function(){ReportSetting.constructAddEditPage($(this).closest("tr"),!0)}),tbody.on("click","tr td:last-child i",function(){ReportSetting.showHideConfirmDeleteButtons($(this).closest("td"),"action_confirm_button",ReportSetting.deleteAction)})}else{if(void 0!==id)new EmptyPages("zp_nd_nodata",ZPI18N.getString("zp.payperiod.nodatamsg"),"",$(id.find(".zpl_rgtcnt"))).show();else settingsPage.container.find("#zp_report_Setting_list,#zp_report_settings_loading").hide(),Timetracker.Util.showHideNoData({msg:ZPI18N.getString("zp.payperiod.nodatamsg"),buttonName:ZPI18N.getString("zp.payperiodaddbutton"),buttonCallBack:ReportSetting.constructAddEditPage,desc:ZPI18N.getString("zp.leave.payperioddef")});settingsPage.container.find("#addPayPeriodBtn").closest(".zpl_btnmnu").addClass("DNI")}TimelyZComp.toolTip.intiliaze()},constructMoreOption:function(moreopt,Id){if(Object.keys(moreopt).length>0){var mhtml='<div id="'+Id+'" class="zpl_drpdwn zpl_tagdrpdwn zmenu zposition--bottomright zh-radiustopright" data-type="list"><ul data-body="true" style="height: auto;">';let count=0;$.each(moreopt,function(key,name){count>2&&(mhtml+='<li data-item-type="custom"><div class="zpl_tg"><span>'+name+"</span></div></li>"),count++});let forElementId=Id+"Btn";mhtml+="</ul></div>",$(settingsPage.mainWrapId).append(mhtml),ZPeopleComponents.menu("#"+Id,{forElement:"#"+forElementId}),settingsPage.container.find("#"+forElementId).off().on("click",e=>{e.stopPropagation(),ZPeopleComponents.menu("#"+Id).show()})}},constructAddEditPage:function(obj,isUpdate){var title=ZPI18N.getString("zp.eg")+" "+ZPI18N.getString("zp.monthly")+" "+ZPI18N.getString("zp.spayperiod"),html='<form><div class="zpl_crd"><div class="zpl_crdcnt"><div class="zpl_secn"><div><label class="zpl_mtry">'+ZPI18N.getString("zp.ppname")+'</label></div><div><input id="zp_rs_name" placeholder="'+title+'" type="text" class="ztextbox"><span id="zp_rs_name_error" class="ztextbox--error__label"></span></div></div><div class="zpl_secn"><div><label>'+ZPI18N.getString("zp.ppcycle")+'</label></div><div><select id="zp_rs_frequency" class="select-js" data-width="330" ><option value='+RSCONSTANTS.MONTHLY+">"+ZPI18N.getString("zp.monthly")+"</option><option value="+RSCONSTANTS.WEEKLY+">"+ZPI18N.getString("zp.weekly")+"</option><option value="+RSCONSTANTS.BIWEEKLY+">"+ZPI18N.getString("zp.payperiod.biweekly")+"</option><option value="+RSCONSTANTS.SEMIMONTHLY+">"+ZPI18N.getString("zp.payperiod.halfmonthly")+'</option></select><span id="zp_rs_frequency_error" class="ztextbox--error__label"></span></div></div><div class="zpl_secn zpl_idivingrp"><div><div> <label for="">'+ZPI18N.getString("zp.tt.startday")+'</label><label for="" class="zpl_mtry">'+ZPI18N.getString("zp.tt.endday")+'</label></div></div><div><div><select id="zp_rs_from_day" class="select-js"  ></select><select id="zp_rs_to_day" class="select-js"  ></select></div><div><span class="ztextbox--error__label"></span><span id="zp_rs_to_day_error" class="ztextbox--error__label"></span></div></div></div><div class="zpl_secn"><div><label id="zp_rs_ppprocDayText_1" class="zpl_mtry">'+ZPI18N.getString("zp.ppprocessingday")+'</label></div><div><select id="zp_rs_closure_day" class="select-js" ></select><span id="zp_rs_closure_day_error" class="ztextbox--error__label" ><span class="DN dgry MT5" id="zp_rs_closure_day_info_dummy"></span></div></div><div class="zpl_secn"><div><label id="zp_rs_freeze_dateText" class="zpl_mtry">'+ZPI18N.getString("zp.ppgenerationday")+'</label></div><div><select id="zp_rs_freeze_date" class="select-js" ></select><span id="zp_rs_freeze_day_error" class="ztextbox--error__label"></div></div><div class="zpl_secn zpl_idivingrp" id="zp_rs_cont_semMont"><div><div> <label for="">'+ZPI18N.getString("zp.tt.startday")+'</label><label for="">'+ZPI18N.getString("zp.tt.endday")+'</label></div></div><div><div><select id="zp_rs_fromday_semMont" class="select-js" ></select><span class="DB dgry MT5" id="zp_rs_startdayinfo_semMont">of every month</span><select id="zp_rs_today_semMont" class="select-js" ></select><span class="DB dgry MT5" id="zp_rs_enddayinfo_semMont">of every month</span></div><div><span id="zp_rs_to_dayerror_semMont" class="ztextbox--error__label"></span></div></div></div><div class="zpl_secn" id="zp_rs_proCont_semMont"><div><label id="zp_rs_ppprocDayText_2" class="zpl_mtry">'+ZPI18N.getString("zp.ppprocessingday")+'</label></div><div><select id="zp_rs_closureday_semMont" class="select-js" ></select><span id="zp_rs_closure_dayerror_semMont" class="ztextbox--error__label"><span class="DN dgry MT5" id="zp_rs_closure_day_info_dummy"></span></div></div><div class="zpl_secn" id="zp_rs_freeze_cont2"><div><label id="zp_rs_freeze_dateText2" class="zpl_mtry">'+ZPI18N.getString("zp.ppgenerationday")+'</label></div><div><select id="zp_rs_freeze_date2" class="select-js" ></select><span id="zp_rs_freeze_dayerror_semMont" class="ztextbox--error__label" ></div></div><div class="zpl_secn"><div><div class="zcheckbox"><input id="zp_rs_encash" type="checkbox" class="zcheckbox__helper" onchange="ReportSetting.getPayPeriodInfo();"><label for="zp_rs_encash" class="zcheckbox__label">'+ZPI18N.getString("zp.pp.processencashment")+'</label></div></div></div><div class="zpl_secn"><div class="zpl_flexalign"><div class="zcheckbox"><input id="zp_rs_review" type="checkbox" class="zcheckbox__helper childenable" onchange="ReportSetting.onReviewChange();"><label for="zp_rs_review" class="zcheckbox__label"></label></div><div><select id="zp_rs_review_status" class="" style=""><option value="0">'+ZPI18N.getString("zp.autoreject")+'</option><option value="1">'+ZPI18N.getString("zp.autoapprove")+'</option></select></div><label class="zpl_ml2">'+ZPI18N.getString("zp.pppendingonprocessday")+"</label></div></div>"+ReportSetting.autoApplyLeaveOption()+'<div class="zpl_secn"><div><div class="zcheckbox"><input id="zp_rs_freeze" type="checkbox" class="zcheckbox__helper childenable" onchange="ReportSetting.getPayPeriodInfo();"><label for="zp_rs_freeze" class="zcheckbox__label">'+ZPI18N.getString("zp.pplock")+" "+ZPI18N.getString("zp.pplockinfo")+'</label></div></div></div><div class="zpl_secn"><div><h5>'+ZPI18N.getString("zp.applicableto",[""])+'</h5><span id="zp_rs_appFor_error" class="ztextbox--error__label"></span></div><div class="zpl_cndor"><div class="zpl_gbox zpl_w-100">                <div class="zpl_idiv">                  <select id="zp_rs_appfor" class="select-js">                    <option value="EMPLOYEE_TYPE">'+ZPI18N.getString("zp.employeeType")+'</option>                    <option value="LOCATION">'+ZPI18N.getString("zp.location")+'</option>                    <option value="ROLE">'+ZPI18N.getString("zp.role")+'</option>                  </select>                  <span>is</span>                  <z-tokenfield id="zp_rs_appfor_values" elemType="tokenfield" values="Array" style="display:none"></z-tokenfield>                </div>              </div>            </div>          </div><div class="zpl_secn"><div class="zpl_info DN" id="cycle_details"></div></div></div></form>',modal=ModuleComp.Modal.setup({id:"configurePayPeriod",type:1,header:isUpdate?ZPI18N.getString("zp.payperiod.editpayperiod"):ZPI18N.getString("zp.payperiod.caddpayperiod"),body:html,backdrop:!1,deleteOnHide:!0,buttonValue:ZPI18N.getString("zp.save"),successCallback:isUpdate?ReportSetting.updateAction:ReportSetting.saveAction,hiddenCallback:ReportSetting.destroyZComp,closeonEsc:!0,LayerId:settingsPage.container[0].id});(modal=settingsPage.container.find("#configurePayPeriod")).find(".PI_cls").attr("title",ZPI18N.getString("zp.close")).ztooltip();var locArray=[],locIdArr=[];locIdArr.push("0"),locArray.push({id:"0",name:ZPI18N.getString("zp.alllocaction")}),$.each(ZPUtil.Location.ALL_LOCATION,function(key,value){locArray.push({id:key,name:value}),locIdArr.push(key)});var repSettID=$(obj).attr("rsID");Object.keys(ReportSetting.ALL_LIST).length>0&&$.each(ReportSetting.ALL_LIST,function(key,value){if(repSettID!==value.reportSettID)if(0===Object.keys(value.locationList).length){let index=locIdArr.indexOf("0");index>-1&&(locArray.splice(index,1),locIdArr.splice(index,1))}else $.each(value.locationList,function(key,value){let index=locIdArr.indexOf(key);index>-1&&(locArray.splice(index,1),locIdArr.splice(index,1))})});ZPI18N.getString("zp.nomatchesfound"),ZPI18N.getString("zp.select"),modal.find(".zpl_mcnt");let locationDiv=modal.find("#zp_rs_location");locationDiv.on("ztokenfieldbeforetokenadd",function(obj){AppExc.getZtokenFieldOnchangeForApp(obj,locationDiv)}),modal.find("#cycle_details")[0]?modal.find(".zpl_mfoter").find("#cycle_details").addClass("DNI"):modal.find(".zpl_crdcnt").append('<div class="zpl_secn"><div class="zpl_info DNI" id="cycle_details"></div></div>'),ReportSetting.defaultAction(),modal.find("#zp_rs_name").focus(),modal.find("[data-popover]").popover(),isUpdate&&void 0!==obj&&void 0!==repSettID&&(ReportSetting.localValues.repSettID=repSettID,ReportSetting.populateData(repSettID)),modal.find(".zpl_mcnt").animate({scrollTop:0},20),modal.find(".zpl_mcnt").removeClass("zpl_fm")},autoApplyLeaveOption:function(){return html="",ReportSetting.autoApplyLeavePayperiod&&(html='<div class="zpl_secn"><div class="chkdectxt"><div class="zcheckbox"><input id="zp_rs_convert_absent" type="checkbox" class="zcheckbox__helper" onchange="ReportSetting.convertToAbsent();"><label for="zp_rs_convert_absent" class="zcheckbox__label">'+ZPI18N.getString("zp.payperiod.convertabsenttoleave")+'</label></div><span class="dectxt">'+ZPI18N.getString("zp.payperiod.convertabsentdesc")+'</span><div class="zpl_gbox zpl_w320 DNI" id="convertAbs_leaveIdCont"><div id="convertAbs_leaveRows"></div><div class="zpl_idiv"><div><a class="zpl_lnkbg" id="addConAbsLeaveRow" onclick="ReportSetting.addConvertAbsLeaveRow();">'+ZPI18N.getString("zp.add")+"</a></div></div></div></div></div>"),html},defaultAction:function(){var modal=settingsPage.container.find("#configurePayPeriod");modal.find(".error-msg").hide(),modal.find("#zp_rs_name").on("keypress",function(){modal.find("#zp_rs_name").val().length<=0&&(Timetracker.Util.removeError(modal.find("#zp_rs_name")),modal.find("#zp_rs_name_error").hide())}),ZPeopleComponents.select(modal.find("#zp_rs_review_status")[0]).setAttributes({disabled:!0}),ZPeopleComponents.select(modal.find("#zp_rs_frequency")).setAttributes({selectedValue:"1",dropdownList:{appendTo:modal.find(".zpl_mcnt")}}),ZPeopleComponents.select(modal.find("#zp_rs_appfor")[0]);let appForValueEle=modal.find("#zp_rs_appfor_values");var attr={isLabelHTMLEncoded:!0,sort:!1,dropdownList:{closeOnSelect:!1,hideItemOnSelect:!0,isTextHTMLEncoded:!0,fitForElement:!0,appendTo:appForValueEle.closest(".zpl_mdl").length>0?appForValueEle.closest(".zpl_mdl"):settingsPage.container}};TimelyZComp.tokenField.intialize(appForValueEle,attr,!0),ReportSetting.onFrequencyChange(),ReportSetting.onAppForChange(),$("#zp_rs_frequency").on("zselectchange",ReportSetting.onFrequencyChange),$("#zp_rs_to_day").on("zselectchange",ReportSetting.updateStartDay).on("zselectchange",ReportSetting.updateClosureDay),$("#zp_rs_closure_day,#zp_rs_closureday_semMont").on("zselectchange",ReportSetting.updatePayrollDay),$("#zp_rs_freeze_date,#zp_rs_freeze_date2").on("zselectchange",ReportSetting.getPayPeriodInfo),$("#zp_rs_appfor").on("zselectchange",ReportSetting.onAppForChange)},onFrequencyChange:function(){var modal=settingsPage.container.find("#configurePayPeriod"),freqVal=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_frequency")).getValue());modal.find("#zp_rs_proCont_semMont,#zp_rs_freeze_cont2,#zp_rs_cont_semMont").hide(),modal.find("#zp_rs_ppprocDayText_1").text(ZPI18N.getString("zp.ppprocessingday")),modal.find("#zp_rs_freeze_dateText").text(ZPI18N.getString("zp.ppgenerationday")),modal.find(".ztextbox__error").removeClass("ztextbox__error"),modal.find("#zp_rs_to_day_error").hide(),modal.find("#zp_rs_closure_day_error,#zp_rs_closure_dayerror_semMont").hide(),modal.find("#zp_rs_freeze_day_error,#zp_rs_freeze_dayerror_semMont").hide(),modal.find("#cycle_details").hide();var appendTo=modal.find(".zpl_mcnt");freqVal===RSCONSTANTS.MONTHLY?(ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setAttributes({options:ReportSetting.monthlyOptions(!1,!0),selectedValue:RSCONSTANTS.NONE,disabled:!0,dropdownList:{appendTo:appendTo},placeholder:ZPI18N.getString("zp.select")}),ZPeopleComponents.select(modal.find("#zp_rs_to_day")).setAttributes({options:ReportSetting.monthlyOptions(!0,!1),selectedValue:RSCONSTANTS.NONE,dropdownList:{appendTo:appendTo},placeholder:ZPI18N.getString("zp.select")}),ReportSetting.updateClosureDay(),ReportSetting.updatePayrollDay({target:modal.find("#zp_rs_closure_day")}),modal.find("#zp_rs_frequency_error,#zp_rs_startday_info,#zp_rs_endday_info,#zp_rs_closure_day_info").hide()):freqVal===RSCONSTANTS.WEEKLY||freqVal===RSCONSTANTS.BIWEEKLY?(ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setAttributes({options:ReportSetting.weeklyOptions(!1,!0),selectedValue:RSCONSTANTS.NONE,disabled:!0,dropdownList:{appendTo:appendTo},placeholder:ZPI18N.getString("zp.select")}),ZPeopleComponents.select(modal.find("#zp_rs_to_day")).setAttributes({options:ReportSetting.weeklyOptions(!0,!1),selectedValue:RSCONSTANTS.NONE,dropdownList:{appendTo:appendTo},placeholder:ZPI18N.getString("zp.select")}),ReportSetting.updateClosureDay(),ReportSetting.updatePayrollDay({target:modal.find("#zp_rs_closure_day")}),modal.find("#zp_rs_frequency_error,#zp_rs_startday_info,#zp_rs_endday_info,#zp_rs_closure_day_info").hide()):freqVal===RSCONSTANTS.SEMIMONTHLY?(modal.find("#zp_rs_ppprocDayText_1").text(ZPI18N.getString("zp.ppfirstprocessingday")),modal.find("#zp_rs_ppprocDayText_2").text(ZPI18N.getString("zp.ppsecondprocessingday")),modal.find("#zp_rs_freeze_dateText").text("1st "+ZPI18N.getString("zp.ppgenerationday")),modal.find("#zp_rs_freeze_dateText2").text("2nd "+ZPI18N.getString("zp.ppgenerationday")),modal.find("#zp_rs_cont_semMont,#zp_rs_proCont_semMont,#zp_rs_freeze_cont2").show(),ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setAttributes({options:ReportSetting.monthlyOptions(!1,!0),selectedValue:RSCONSTANTS.NONE,disabled:!0,dropdownList:{appendTo:appendTo},placeholder:ZPI18N.getString("zp.select")}),ZPeopleComponents.select(modal.find("#zp_rs_to_day")).setAttributes({options:ReportSetting.monthlyOptions(!0,!1),selectedValue:RSCONSTANTS.NONE,dropdownList:{appendTo:appendTo},placeholder:ZPI18N.getString("zp.select")}),ZPeopleComponents.select(modal.find("#zp_rs_today_semMont")).setAttributes({options:ReportSetting.monthlyOptions(!0,!1),selectedValue:RSCONSTANTS.NONE,disabled:!0,dropdownList:{appendTo:appendTo},placeholder:ZPI18N.getString("zp.select")}),ZPeopleComponents.select(modal.find("#zp_rs_fromday_semMont")).setAttributes({options:ReportSetting.monthlyOptions(!1,!0),selectedValue:RSCONSTANTS.NONE,disabled:!0,dropdownList:{appendTo:appendTo},placeholder:ZPI18N.getString("zp.select")}),ReportSetting.updateClosureDay(),ReportSetting.updatePayrollDay({target:modal.find("#zp_rs_closure_day")}),ReportSetting.updatePayrollDay({target:modal.find("#zp_rs_closureday_semMont")}),modal.find("#zp_rs_frequency_error,#zp_rs_startdayinfo_semMont,#zp_rs_enddayinfo_semMont,#zp_rs_closure_dayinfo_semMont,#zp_rs_closure_dayerror_semMont").hide(),modal.find("#zp_rs_frequency_error,#zp_rs_startday_info,#zp_rs_endday_info,#zp_rs_closure_day_info").hide()):(modal.find("#zp_rs_to_day,#zp_rs_from_day").html(""),ZPeopleComponents.select(modal.find("#zp_rs_to_day")).setAttributes({options:{},selectedValue:RSCONSTANTS.NONE,disabled:!0,dropdownList:{appendTo:appendTo}}),ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setAttributes({options:{},selectedValue:RSCONSTANTS.NONE,dropdownList:{appendTo:appendTo}}),ZPeopleComponents.select(modal.find("#zp_rs_closure_day")).setAttributes({options:{},dropdownList:{appendTo:appendTo}}),modal.find("#zp_rs_startday_info,#zp_rs_endday_info,#zp_rs_closure_day_info").hide()),modal.find("#zp_rs_freeze").attr("checked",!1)},onAppForChange:function(){var modal=settingsPage.container.find("#configurePayPeriod"),appForEntity=ZPeopleComponents.select(modal.find("#zp_rs_appfor")).getValue(),appForValueEle=modal.find("#zp_rs_appfor_values"),values=[];TimelyZComp.tokenField.destroy(appForValueEle),values="EMPLOYEE_TYPE"===appForEntity?AppExc.getValueForCriteriaOptions("empTypeList",AppExc.appLabels[9],!0):"ROLE"===appForEntity?AppExc.getValueForCriteriaOptions("roleList",AppExc.appLabels[3],!0):AppExc.getValueForCriteriaOptions("locationList",AppExc.appLabels[0],!0);var attr={isLabelHTMLEncoded:!0,sort:!1,dropdownList:{closeOnSelect:!1,hideItemOnSelect:!0,isTextHTMLEncoded:!0,fitForElement:!0,appendTo:appForValueEle.closest(".zpl_mdl").length>0?appForValueEle.closest(".zpl_mdl"):settingsPage.container}};TimelyZComp.tokenField.intialize(appForValueEle,attr,!0),TimelyZComp.tokenField.addOptions(appForValueEle,values),appForValueEle.on("ztokenfieldbeforetokenadd",function(obj){AppExc.getZtokenFieldOnchangeForApp(obj,appForValueEle)})},validateEndDay:function(fromSave){var isErrorNeeded=!0;fromSave&&"boolean"!=typeof fromSave&&fromSave.detail&&!fromSave.detail.fromUI&&(isErrorNeeded=!1);var modal=settingsPage.container.find("#configurePayPeriod");modal.find("#zp_rs_frequency_error,#zp_rs_to_day_error").hide(),Timetracker.Util.removeError(modal.find("#zp_rs_frequency")),Timetracker.Util.removeError(modal.find("#zp_rs_to_day"));var isValid=!0,frequency=ZPeopleComponents.select(modal.find("#zp_rs_frequency")).getValue(),toDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_to_day")).getValue());if(void 0===frequency?(isErrorNeeded&&(modal.find("#zp_rs_frequency_error").html(ZPI18N.getString("zp.frequencyerror")).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_frequency")})),isValid=!1):(null===toDay||void 0===toDay||isNaN(toDay)||-1===toDay)&&(isErrorNeeded&&(modal.find("#zp_rs_to_day_error").html(ZPI18N.getString("zp.payperiod.payperiodenddayerr")).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_to_day")})),ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setValue(RSCONSTANTS.NONE),modal.find("#zp_rs_startday_info,#zp_rs_endday_info").hide(),isValid=!1),!isValid)return isValid;frequency=parseInt(frequency),modal.find("#zp_rs_to_day_info").hide();var startDayVal;if(frequency===RSCONSTANTS.WEEKLY||frequency===RSCONSTANTS.BIWEEKLY){var prevWeekDay=toDay>=RSCONSTANTS.SATURDAY?RSCONSTANTS.SUNDAY:[toDay+1];"Report will generate from  "+RSCONSTANTS.WEEK_NAME[prevWeekDay]+" to "+RSCONSTANTS.WEEK_NAME[toDay]+".",ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setValue(prevWeekDay),modal.find("#zp_rs_startday_info,#zp_rs_endday_info").hide();var sDayInfo=ZPI18N.getString("zp.pppreviousweek"),eDayInfo=ZPI18N.getString("zp.sofcurrentweek");6===toDay&&frequency===RSCONSTANTS.WEEKLY?sDayInfo=ZPI18N.getString("zp.sofcurrentweek"):6!==toDay&&frequency===RSCONSTANTS.BIWEEKLY&&(sDayInfo=ZPI18N.getString("zp.ppbeforepreviousweek")),modal.find("#zp_rs_startday_info").text(sDayInfo).show(),modal.find("#zp_rs_endday_info").text(eDayInfo).show()}else if(frequency===RSCONSTANTS.MONTHLY){var startDayInfo,endDayInfo;if(startDayVal=1,toDay===RSCONSTANTS.LASTDAY)"Report will generate from 1"+ReportSettings.getNumberSuffix(1)+" of current month to LAST DAY of current month.",startDayInfo=endDayInfo=ZPI18N.getString("zp.sofcurrentmonth");else{var prevMonthDay=[toDay+1];"Report will generate from "+prevMonthDay+ReportSettings.getNumberSuffix(prevMonthDay)+" of previous month to "+toDay+ReportSettings.getNumberSuffix(toDay)+" of current month.",startDayVal=prevMonthDay,startDayInfo=ZPI18N.getString("zp.pppreviousmonth"),endDayInfo=ZPI18N.getString("zp.sofcurrentmonth")}ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setValue(startDayVal),modal.find("#zp_rs_startday_info").text(startDayInfo).show(),modal.find("#zp_rs_endday_info").text(endDayInfo).show()}else if(frequency===RSCONSTANTS.SEMIMONTHLY){var stEndDet=ReportSettings.getStartDayEndDay(toDay);startDayVal=stEndDet.startDay_1;var secEndDayVal=stEndDet.endDay_2,secStartDayVal=stEndDet.startDay_2;ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setValue(startDayVal),ZPeopleComponents.select(modal.find("#zp_rs_fromday_semMont")).setValue(secStartDayVal),ZPeopleComponents.select(modal.find("#zp_rs_today_semMont")).setValue(secEndDayVal),fromSave&&"boolean"==typeof fromSave||ReportSetting.setDayInfo(toDay)}var closureDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_closure_day")).getValue());return null===closureDay||void 0===closureDay||isNaN(closureDay)||-1===closureDay?isValid:(ReportSetting.validateGenerationDay(),isValid)},updateStartDay:function(obj){var startDayVal,modal=settingsPage.container.find("#configurePayPeriod"),frequency=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_frequency")).getValue()),toDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_to_day")).getValue());if(-1!==toDay&&null!==toDay&&void 0!==toDay&&!isNaN(toDay))if(frequency===RSCONSTANTS.WEEKLY||frequency===RSCONSTANTS.BIWEEKLY){var prevWeekDay=toDay>=RSCONSTANTS.SATURDAY?RSCONSTANTS.SUNDAY:[toDay+1];ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setValue(prevWeekDay)}else if(frequency===RSCONSTANTS.MONTHLY)startDayVal=toDay===RSCONSTANTS.LASTDAY?1:[toDay+1],ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setValue(startDayVal);else if(frequency===RSCONSTANTS.SEMIMONTHLY){var stEndDet=ReportSettings.getStartDayEndDay(toDay);startDayVal=stEndDet.startDay_1;var secEndDayVal=stEndDet.endDay_2,secStartDayVal=stEndDet.startDay_2;ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setValue(startDayVal),ZPeopleComponents.select(modal.find("#zp_rs_fromday_semMont")).setValue(secStartDayVal),ZPeopleComponents.select(modal.find("#zp_rs_today_semMont")).setValue(secEndDayVal)}},validateGenerationDay:function(obj){if(!obj||!obj.detail||obj.detail.fromUI){var modal=settingsPage.container.find("#configurePayPeriod");modal.find("#zp_rs_closure_day_error,#zp_rs_closure_dayerror_semMont").hide(),modal.find("#zp_rs_freeze_day_error,#zp_rs_freeze_dayerror_semMont").hide(),modal.find(".ztextbox__error").removeClass("ztextbox__error");var frequency=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_frequency")).getValue()),toDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_to_day")).getValue()),toDay2=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_today_semMont")).getValue()),closureDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_closure_day")).getValue()),closureDay2=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_closureday_semMont")).getValue()),report_freeze=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_freeze_date")).getValue()),report_freeze2=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_freeze_date2")).getValue());return void 0===frequency||frequency===RSCONSTANTS.NONE?(modal.find("#zp_rs_frequency_error").html(ZPI18N.getString("zp.frequencyerror")).show(),!1):null===toDay||void 0===toDay||isNaN(toDay)||-1===toDay?(modal.find("#zp_rs_to_day_error").html(ZPI18N.getString("zp.enddateerror")).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_to_day")}),!1):null===closureDay||void 0===closureDay||isNaN(closureDay)||-1===closureDay?(modal.find("#zp_rs_closure_day_error").html(ZPI18N.getString("zp.payperiod.error.dayrange",[ZPI18N.getString("zp.ppprocessingday"),ZPI18N.getString("zp.ppendday")])).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_closure_day")}),!1):null===report_freeze||void 0===report_freeze||isNaN(report_freeze)||-1===report_freeze?(modal.find("#zp_rs_freeze_day_error").html(ZPI18N.getString("zp.payperiod.error.dayrange",[ZPI18N.getString("zp.ppgenerationday"),ZPI18N.getString("zp.ppprocessingday")])).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_freeze_date")}),!1):4!==frequency||null!==closureDay2&&void 0!==closureDay2&&!isNaN(closureDay2)&&-1!==closureDay2?4!==frequency||null!==report_freeze2&&void 0!==report_freeze2&&!isNaN(report_freeze2)&&-1!==report_freeze2?1!=frequency&&4!=frequency||ReportSetting.consOptionForClsDay(toDay).map(obj=>obj.value).includes(closureDay)?1!=frequency&&4!=frequency||ReportSetting.consOptionForClsDay(32==closureDay?1:closureDay+1).map(obj=>obj.value).includes(report_freeze)?4!==frequency||ReportSetting.consOptionForClsDay(toDay2).map(obj=>obj.value).includes(closureDay2)?!(4===frequency&&!ReportSetting.consOptionForClsDay(32==closureDay2?1:closureDay2+1).map(obj=>obj.value).includes(report_freeze2))||(modal.find("#zp_rs_freeze_dayerror_semMont").html(ZPI18N.getString("zp.payperiod.error.dayrange",[ZPI18N.getString("zp.ppgenerationday"),ZPI18N.getString("zp.ppprocessingday")])).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_freeze_date2")}),!1):(modal.find("#zp_rs_closure_dayerror_semMont").html(ZPI18N.getString("zp.payperiod.error.dayrange",[ZPI18N.getString("zp.ppprocessingday"),ZPI18N.getString("zp.ppendday")])).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_closure_dayerror_semMont")}),!1):(modal.find("#zp_rs_freeze_day_error").html(ZPI18N.getString("zp.payperiod.error.dayrange",[ZPI18N.getString("zp.ppgenerationday"),ZPI18N.getString("zp.ppprocessingday")])).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_freeze_date")}),!1):(modal.find("#zp_rs_closure_day_error").html(ZPI18N.getString("zp.payperiod.error.dayrange",[ZPI18N.getString("zp.ppprocessingday"),ZPI18N.getString("zp.ppendday")])).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_closure_day")}),!1):(modal.find("#zp_rs_freeze_dayerror_semMont").html(ZPI18N.getString("zp.payperiod.error.dayrange",[ZPI18N.getString("zp.ppgenerationday"),ZPI18N.getString("zp.ppprocessingday")])).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_freeze_date2")}),!1):(modal.find("#zp_rs_closure_dayerror_semMont").html(ZPI18N.getString("zp.payperiod.error.dayrange",[ZPI18N.getString("zp.ppprocessingday"),ZPI18N.getString("zp.ppendday")])).show(),Timetracker.Util.appenErrorMsgForElem({obj:modal.find("#zp_rs_closureday_semMont")}),!1)}},validateApplicablity:function(){return!0},onReviewChange:function(){var modal=settingsPage.container.find("#configurePayPeriod"),reviewStatusEnabled=modal.find("#zp_rs_review").is(":checked");ZPeopleComponents.select(modal.find("#zp_rs_review_status")[0]).setAttributes({disabled:!reviewStatusEnabled})},convertToAbsent:function(){var modal=settingsPage.container.find("#configurePayPeriod");if(modal.find("#zp_rs_convert_absent").is(":checked")){let leaveTypeContainer=modal.find("#convertAbs_leaveIdCont");leaveTypeContainer.removeClass("DNI"),0==leaveTypeContainer.find("#convertAbs_leaveRows").find(".zpl_idiv").length&&ReportSetting.addConvertAbsLeaveRow()}else modal.find("#convertAbs_leaveIdCont").addClass("DNI")},createLeaveRows:function(idx){let lt_selectId=`convertAbs_lt_select_${ReportSetting.conAbs_lt_select++}`;return html='<div class="zpl_idiv"><div><select class="select-js" id="'+lt_selectId+'" name="convertAbs_lt"></select></div>',0!=idx&&(html+='<div><i class="PI_delete"></i></div>'),html+="</div>",$(html)},updateltOptions:function(){let leavetypes=ReportSetting.getPaidLeaveIdsList(),usedLeaveIds=ReportSetting.getUsedLeaveIds();settingsPage.container.find("select[name=convertAbs_lt]").each(function(idx,ele){let availableLeaveIds=ReportSetting.getAvailableLeaveIds(idx,usedLeaveIds,leavetypes);TimelyZComp.select.setAttributes(ele,{options:availableLeaveIds})})},getUsedLeaveIds:function(){let usedLeaveIds=[];return settingsPage.container.find("select[name=convertAbs_lt]").each(function(idx,ele){let selected_ltype=TimelyZComp.select.getValue(ele);""!=selected_ltype&&usedLeaveIds.push(selected_ltype)}),usedLeaveIds},getAvailableLeaveIds:function(index,savedLeaveIds=[],allLeaveIds){void 0===allLeaveIds&&(allLeaveIds=ReportSetting.getPaidLeaveIdsList());let currentLeaveIds=savedLeaveIds[index]||[],usedInOtherRows=savedLeaveIds.filter((tokens,i)=>i!==index).flat();return allLeaveIds.filter(item=>{let usedElsewhere=usedInOtherRows.includes(item.value),usedHere=currentLeaveIds.includes(item.value);return!usedElsewhere||usedHere})},addConvertAbsLeaveRow:function(selectedValue){let leaveRowsContainer=settingsPage.container.find("#convertAbs_leaveRows"),ltrow=ReportSetting.createLeaveRows(leaveRowsContainer.find(".zpl_idiv").length);leaveRowsContainer.append(ltrow);let leaveIdsSelect=ltrow.find("select[name=convertAbs_lt]");TimelyZComp.select.destroy(leaveIdsSelect),TimelyZComp.select.intialize(leaveIdsSelect,{options:ReportSetting.getAvailableLeaveIds(leaveRowsContainer.find(".zpl_idiv").length,ReportSetting.getUsedLeaveIds(),ReportSetting.getPaidLeaveIdsList())}),void 0!=selectedValue&&TimelyZComp.select.setValue(leaveIdsSelect,selectedValue),ltrow.find("i").on("click",function(event){TimelyZComp.select.destroy(leaveIdsSelect),ltrow.remove(),leaveRowsContainer.find(".zpl_idiv").length<5?settingsPage.container.find("#addConAbsLeaveRow").show():settingsPage.container.find("#addConAbsLeaveRow").hide()}),5==leaveRowsContainer.find(".zpl_idiv").length?settingsPage.container.find("#addConAbsLeaveRow").hide():settingsPage.container.find("#addConAbsLeaveRow").show(),leaveRowsContainer.find("select[name=convertAbs_lt]").on("zselectchange",function(event){ReportSetting.updateltOptions()})},getPaidLeaveIdsList:function(){return AppExc.appElements.paidLeaveList.map(obj=>({value:obj.id,label:ZPeople.decodeTxt(obj.name)}))},getPayPeriodInfo:function(obj){if(!obj||!obj.detail||obj.detail.fromUI){var modal=settingsPage.container.find("#configurePayPeriod");modal.find("#zp_rs_freeze_day_error,#zp_rs_freeze_dayerror_semMont").hide(),Timetracker.Util.removeError(modal.find("#zp_rs_freeze_date")),Timetracker.Util.removeError(modal.find("#zp_rs_freeze_date2"));var frequency=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_frequency")).getValue()),fromDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_from_day")).getValue()),toDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_to_day")).getValue()),toDay2=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_today_semMont")).getValue()),closureDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_closure_day")).getValue()),closureDay2=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_closureday_semMont")).getValue()),report_freeze=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_freeze_date")).getValue()),report_freeze2=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_freeze_date2")).getValue()),isValid=!0;if(void 0===frequency||frequency===RSCONSTANTS.NONE?isValid=!1:null===toDay||void 0===toDay||isNaN(toDay)||-1===toDay?isValid=!1:null===closureDay||void 0===closureDay||isNaN(closureDay)||-1===closureDay?isValid=!1:null===report_freeze||void 0===report_freeze||isNaN(report_freeze)||-1===report_freeze?isValid=!1:(4!==frequency||null!==closureDay2&&void 0!==closureDay2&&!isNaN(closureDay2)&&-1!==closureDay2)&&(4!==frequency||null!==report_freeze2&&void 0!==report_freeze2&&!isNaN(report_freeze2)&&-1!==report_freeze2)&&(1!=frequency&&4!=frequency||ReportSetting.consOptionForClsDay(toDay).map(obj=>obj.value).includes(closureDay))&&(1!=frequency&&4!=frequency||ReportSetting.consOptionForClsDay(32==closureDay?1:closureDay+1).map(obj=>obj.value).includes(report_freeze))&&(4!==frequency||ReportSetting.consOptionForClsDay(toDay2).map(obj=>obj.value).includes(closureDay2))&&(4!==frequency||ReportSetting.consOptionForClsDay(32==closureDay2?1:closureDay2+1).map(obj=>obj.value).includes(report_freeze2))||(isValid=!1),isValid){modal.find("#zp_rs_closure_day_info").hide();var closureMsg="";(frequency=parseInt(frequency))!==RSCONSTANTS.WEEKLY&&frequency!==RSCONSTANTS.BIWEEKLY||closureDay===RSCONSTANTS.NONE?frequency===RSCONSTANTS.MONTHLY&&closureDay!==RSCONSTANTS.NONE?closureMsg=closureDay>=toDay&&closureDay<=RSCONSTANTS.LASTDAY?(RSCONSTANTS.LASTDAY,ZPI18N.getString("zp.sofcurrentmonth")):(RSCONSTANTS.LASTDAY,ZPI18N.getString("zp.ppnextmonth")):frequency===RSCONSTANTS.SEMIMONTHLY&&closureDay!==RSCONSTANTS.NONE&&(closureMsg=ReportSettings.setClsDayInfo()):closureMsg=ZPI18N.getString("zp.ppeveryweek");report_freeze!==RSCONSTANTS.NONE&&(frequency===RSCONSTANTS.WEEKLY||frequency===RSCONSTANTS.BIWEEKLY?ZPI18N.getString("zp.ppeveryweek"):frequency===RSCONSTANTS.MONTHLY&&ZPI18N.getString("zp.sofcurrentmonth")),modal.find("#zp_rs_closure_day_info").text(closureMsg).show().css("display","inline-block");var lock_enabled=modal.find("#zp_rs_freeze").is(":checked");if(frequency===RSCONSTANTS.SEMIMONTHLY){let fromDay2=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_fromday_semMont")).getValue()),toDay2=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_today_semMont")).getValue()),period_details=ReportSettings.getPayPeriodSummary(fromDay,toDay,closureDay,report_freeze,frequency,fromDay2,toDay2,closureDay2,report_freeze2),process_date=period_details.closure+", "+period_details.closure2,payprocess_date=period_details.payroll_closure+" "+(report_freeze===closureDay?"":"00:00 AM")+", "+period_details.payroll_closure2+" "+(report_freeze2===closureDay2?"":"00:00 AM"),processReports=ZPI18N.getString("zp.leave.report.lopreport")+(modal.find("#zp_rs_encash").is(":checked")?", "+ZPI18N.getString("zp.leave.encashmentreport",["Leave"]):"")+" & "+ZPI18N.getString("zp.local.ovetimedetailsreport"),help="<h6><span>"+ZPI18N.getString("zp.ppgeneration.summary")+"</span></h6><ul><li><em>Upcoming Pay Cycles : "+period_details.start+" - "+period_details.end+", "+period_details.start2+" - "+period_details.end2+"</em></li><li><em>"+ZPI18N.getString("zp.payperiod.generation.help1",[processReports,process_date])+"</em></li>";lock_enabled&&(help+="<li><em>"+ZPI18N.getString("zp.payperiod.generation.help2",[process_date])+"</em></li>"),help+=report_freeze>-1&&report_freeze2>-1?"<li><em>"+ZPI18N.getString("zp.payperiod.generation.help4",[payprocess_date])+"</em></li>":"",help+="</ul>",modal.find("#cycle_details").html(help).show().css("display","inline-block")}else{let period_details=ReportSettings.getPayPeriodSummary(fromDay,toDay,closureDay,report_freeze,frequency),process_date=period_details.closure,payprocess_date=period_details.payroll_closure+" "+(report_freeze===closureDay?"":"00:00 AM"),processReports=ZPI18N.getString("zp.leave.report.lopreport")+(modal.find("#zp_rs_encash").is(":checked")?", "+ZPI18N.getString("zp.leave.encashmentreport",["Leave"]):"")+" & "+ZPI18N.getString("zp.local.ovetimedetailsreport"),help="<h6><b>"+ZPI18N.getString("zp.ppgeneration.summary")+"</b></h6><ul><li><em>Upcoming pay cycle : "+period_details.start+" - "+period_details.end+"</em></li><li><em>"+ZPI18N.getString("zp.payperiod.generation.help1",[processReports,process_date])+"</em></li>";lock_enabled&&(help+="<li><em>"+ZPI18N.getString("zp.payperiod.generation.help2",[process_date])+"</em></li>"),help+=report_freeze>-1?"<li><em>"+ZPI18N.getString("zp.payperiod.generation.help4",[payprocess_date])+"</em></li>":"",help+="</ul>",modal.find("#cycle_details").html(help).show().css("display","inline-block")}}else modal.find("#cycle_details").hide()}},validateInput:function(fromSave){var isValid=ReportSetting.validateEndDay(fromSave);return isValid=isValid?ReportSetting.validateGenerationDay():isValid},saveAction:function(modal,isUpdate){(modal=settingsPage.container.find("#configurePayPeriod")).find("#zp_rs_name_error").hide(),modal.find("#zp_rs_appFor_error").hide();var isValid=ReportSetting.validateGenerationDay(),name=$.trim(modal.find("#zp_rs_name").val());(void 0===name||name.length<=0)&&(modal.find("#zp_rs_name").addClass("ztextbox__error"),modal.find("#zp_rs_name_error").html(ZPI18N.getString("zp.payperiod.nameerror")).show(),isValid=!1);let leave_type_heirarchy=[];if(modal.find("#zp_rs_convert_absent").is(":checked")){modal.find("select[name=convertAbs_lt]").each(function(idx,ele){leave_type_heirarchy.push(TimelyZComp.select.getValue(ele))})}var appForEntity=ZPeopleComponents.select(modal.find("#zp_rs_appfor")).getValue(),appForArray=TimelyZComp.tokenField.getValues(modal.find("#zp_rs_appfor_values"));if((void 0==appForArray||appForArray.length<1)&&(modal.find("#zp_rs_appFor_error").html(ZPI18N.getString("zp.tt.selectonecriteria")).show(),isValid=!1),isValid){var frequency=ZPeopleComponents.select(modal.find("#zp_rs_frequency")).getValue(),toDay=ZPeopleComponents.select(modal.find("#zp_rs_to_day")).getValue(),fromDay=ZPeopleComponents.select(modal.find("#zp_rs_from_day")).getValue(),closureDay=ZPeopleComponents.select(modal.find("#zp_rs_closure_day")).getValue(),isFreeze=modal.find("#zp_rs_freeze").is(":checked"),processEncashment=modal.find("#zp_rs_encash").is(":checked"),payPerCycle={};payPerCycle.rsName=name,payPerCycle.rsFrequency=parseInt(frequency),payPerCycle.rsFromDay=parseInt(fromDay),payPerCycle.rsToDay=parseInt(toDay),payPerCycle.rsClosureDay=parseInt(closureDay),payPerCycle.rsIsFreeze=isFreeze,payPerCycle.rsProcessEncashment=processEncashment,payPerCycle.rsPayrollClosure=ZPeopleComponents.select(modal.find("#zp_rs_freeze_date")).getValue(),payPerCycle.rsReviewStatus=Layout.Page.container.find("#zp_rs_review").is(":checked")?ZPeopleComponents.select(modal.find("#zp_rs_review_status")).getValue():-1,"4"===frequency&&(payPerCycle.rsSecClosureDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_closureday_semMont")).getValue()),payPerCycle.rsSecPayrollClosure=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_freeze_date2")).getValue()),payPerCycle.rsSecFromDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_fromday_semMont")).getValue()),payPerCycle.rsSecToDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_today_semMont")).getValue())),leave_type_heirarchy.length>0&&(payPerCycle.MODULE_DATA={LEAVE_TYPE_HIERARCHY:JSON.stringify(leave_type_heirarchy)});var url="reportSettingAction.zp";settingsUrlProps.currentMode&&"marketplace"!==settingsUrlProps.currentMode&&(url="/"+settingsUrlProps.currentMode+url);var params={mode:void 0!==isUpdate&&"boolean"==typeof isUpdate&&isUpdate?"updateReportSetting":"addReportSetting",reportSettingID:void 0!==isUpdate&&"boolean"==typeof isUpdate&&isUpdate?ReportSetting.localValues.repSettID:0,payPerCycle:JSON.stringify(payPerCycle)};"EMPLOYEE_TYPE"===appForEntity&&(params.employeeType=appForArray.toString()),"ROLE"===appForEntity?params.role=appForArray.toString():params.locationList=appForArray.toString(),modal.find(".zpl_mfoter").find("#zp_modal_blubtn").attr("disabled",!0),ZPeople.Request.sendAsyncPost(url,params,ReportSetting.saveActionCallBack),ReportSettings.showReportSettingListAsync(!0)}},setClsDayInfo:function(){var clsDayVal=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_closure_day")).getValue()),secClsDayVal=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_closureday_semMont")).getValue()),toDayVal=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_to_day")).getValue()),secToDayVal=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_today_semMont")).getValue()),clsDayInfo=ZPI18N.getString("zp.sofcurrentmonth");return toDayVal<=15&&secClsDayVal<secToDayVal?ZPI18N.getString("zp.ppnextmonth"):toDayVal===RSCONSTANTS.LASTDAY&&toDayVal===clsDayVal?clsDayInfo=ZPI18N.getString("zp.pppreviousmonth"):toDayVal>15&&toDayVal<=clsDayVal&&(clsDayInfo=ZPI18N.getString("zp.pppreviousmonth")),-1===clsDayVal&&(clsDayInfo=""),clsDayInfo},setDayInfo:function(toDay){var modal=settingsPage.container.find("#configurePayPeriod"),secClsDayVal=parseInt(modal.find("#zp_rs_today_semMont").val()),startDayInfo=ZPI18N.getString("zp.sofcurrentmonth"),endDayInfo=startDayInfo;ZPeopleComponents.select(modal.find("#zp_rs_closure_day")).setAttributes({options:ReportSetting.consOptionForClsDay(toDay),selectedValue:RSCONSTANTS.NONE}),ZPeopleComponents.select(modal.find("#zp_rs_freeze_date")).setAttributes({options:ReportSetting.consOptionForClsDay(toDay),selectedValue:RSCONSTANTS.NONE}),ZPeopleComponents.select(modal.find("#zp_rs_closureday_semMont")).setAttributes({options:ReportSetting.consOptionForClsDay(secClsDayVal),selectedValue:RSCONSTANTS.NONE}),ZPeopleComponents.select(modal.find("#zp_rs_freeze_date2")).setAttributes({options:ReportSetting.consOptionForClsDay(secClsDayVal),selectedValue:RSCONSTANTS.NONE}),toDay<14?startDayInfo=ZPI18N.getString("zp.pppreviousmonth"):toDay===RSCONSTANTS.LASTDAY?startDayInfo=endDayInfo=ZPI18N.getString("zp.pppreviousmonth"):toDay>15&&(startDayInfo=endDayInfo=ZPI18N.getString("zp.pppreviousmonth")),modal.find("#zp_rs_startday_info").text(startDayInfo).show(),modal.find("#zp_rs_endday_info").text(endDayInfo).show(),modal.find("#zp_rs_closure_day_info,#zp_rs_closure_dayinfo_semMont").text("").hide()},consOptionForClsDay:function(toDay){var bufferOpt=[];bufferOpt.push({label:ZPI18N.getString("zp.select"),value:RSCONSTANTS.NONE}),32===toDay&&(toDay=29);for(var i=toDay;i<toDay+7;i++)if(29===i)bufferOpt.push({label:ZPI18N.getString("zp.schlastday"),value:RSCONSTANTS.LASTDAY});else if(i>29){var tDay=i-29;bufferOpt.push({label:tDay+ReportSettings.getNumberSuffix(tDay),value:tDay})}else bufferOpt.push({label:i+ReportSettings.getNumberSuffix(i),value:i});return bufferOpt},populateData:function(repSettID){var modal=settingsPage.container.find("#configurePayPeriod"),rs=ReportSetting.ALL_LIST[repSettID];modal.find("#zp_rs_name").val(rs.rsName).focus(),ZPeopleComponents.select(modal.find("#zp_rs_frequency")).setValue(rs.frequencyCode),ZPeopleComponents.select(modal.find("#zp_rs_from_day")).setValue(rs.startDayCode),ZPeopleComponents.select(modal.find("#zp_rs_to_day")).setValue(rs.toDayCode),ReportSetting.setOptionsForEdit(modal.find("#zp_rs_closure_day"),rs.closureDayCode),rs.frequencyCode===RSCONSTANTS.SEMIMONTHLY&&(ReportSetting.setOptionsForEdit(modal.find("#zp_rs_closureday_semMont"),rs.closureDayCode_2),ReportSetting.setOptionsForEdit(modal.find("#zp_rs_freeze_date2"),rs.rsSecPayrollClosure)),ReportSetting.setOptionsForEdit(modal.find("#zp_rs_freeze_date"),rs.payrollClosure),modal.find("#zp_rs_freeze")[0].checked=rs.isFreeze,modal.find("#zp_rs_encash")[0].checked=rs.rsProcessEncashment,modal.find("#zp_rs_review")[0].checked=rs.rsReviewStatus>-1,rs.rsReviewStatus>-1&&(ZPeopleComponents.select(modal.find("#zp_rs_review_status")).setValue(rs.rsReviewStatus),ZPeopleComponents.select(modal.find("#zp_rs_review_status")).setAttributes({disabled:!1})),ReportSetting.getPayPeriodInfo();var appForValues=["0"];rs.appEmpType.length>0?(appForValues=rs.appEmpType,ZPeopleComponents.select(modal.find("#zp_rs_appfor")).setValue("EMPLOYEE_TYPE")):rs.appRole.length>0?(appForValues=rs.appRole,ZPeopleComponents.select(modal.find("#zp_rs_appfor")).setValue("ROLE")):(appForValues=rs.locationList,ZPeopleComponents.select(modal.find("#zp_rs_appfor")).setValue("LOCATION")),TimelyZComp.tokenField.setValues(modal.find("#zp_rs_appfor_values"),appForValues);let module_data=rs.MODULE_DATA;if(void 0!=module_data&&void 0!=module_data.LEAVE_TYPE_HIERARCHY&&module_data.LEAVE_TYPE_HIERARCHY.length>0){let leavetypeHeirarchy=module_data.LEAVE_TYPE_HIERARCHY,leavetype_cont=modal.find("#convertAbs_leaveIdCont");for(var leaveId of(leavetype_cont.removeClass("DNI"),modal.find("#zp_rs_convert_absent").attr("checked",!0),leavetypeHeirarchy))ReportSetting.addConvertAbsLeaveRow(leaveId)}},setOptionsForEdit:function(ele,day){var entitySelector=ZPeopleComponents.select(ele);entitySelector.options.map(obj=>obj.value).includes(day)?entitySelector.setValue(day):(entitySelector.deselectAllOptions(),entitySelector.setAttributes({placeholder:32==day?ZPI18N.getString("zp.schlastday"):day+ReportSettings.getNumberSuffix(day)}))},updateAction:function(){ReportSetting.saveAction(null,!0)},saveActionCallBack:function(data){if("ACCESS_DENIED"===data.error)return ReportSettings.accessDenied(),null;var modal=settingsPage.container.find("#configurePayPeriod");if("SHOW_ERROR"===data.ACTION)return modal.find("#zp_rs_appFor_error").html("Pay Period Setting already configured for this criteria").show(),void settingsPage.container.find("#configurePayPeriod").find(".zpl_mfoter").find("#zp_modal_blubtn").prop("disabled",!1);modal.find("#zp_rs_appFor_error").hide(),ReportSetting.destroyZComp(),settingsPage.container.find("#configurePayPeriod").find(".zpl_mfoter").find("#zp_modal_blubtn").prop("disabled",!1),ModuleComp.Modal.hide("configurePayPeriod"),data.STATUS===ZPI18N.getString("zp.capfailure")?void 0!==data.CLIENT_MSG&&$.trim(data.CLIENT_MSG).length>0&&ModuleComp.Msg.showFailureMsg(data.CLIENT_MSG):data.STATUS===ZPI18N.getString("zp.capsuccess")&&(void 0!==data.CLIENT_MSG&&$.trim(data.CLIENT_MSG).length>0&&ModuleComp.Msg.showSuccessMsg(data.CLIENT_MSG),ReportSetting.showReportSettingList(!0))},deleteAction:function(obj){var repSettID=$(obj).attr("rsID"),url="reportSettingAction.zp";settingsUrlProps.currentMode&&"marketplace"!==settingsUrlProps.currentMode&&(url="/"+settingsUrlProps.currentMode+url);var params={mode:"deleteReportSetting",reportSettingID:repSettID};ZPeople.Request.sendAsyncPost(url,params,ReportSetting.afterDeleteAction)},afterDeleteAction:function(data){if(ModuleComp.Modal.hide("zp_modal_deletepop",!0),"ACCESS_DENIED"===data.error)return ReportSettings.accessDenied(),null;if(data.STATUS===ZPI18N.getString("zp.capfailure"))void 0!==data.CLIENT_MSG&&$.trim(data.CLIENT_MSG).length>0&&ModuleComp.Msg.showFailureMsg(data.CLIENT_MSG);else if(data.STATUS===ZPI18N.getString("zp.capsuccess")){void 0!==data.CLIENT_MSG&&$.trim(data.CLIENT_MSG).length>0&&ModuleComp.Msg.showSuccessMsg(data.CLIENT_MSG);var repSettID=data.DATA.reportSettingID;$("#zp_report_setting_table_body_id #tr_"+repSettID).remove(),delete ReportSetting.ALL_LIST[repSettID],Object.keys(ReportSetting.ALL_LIST).length<=0&&(settingsPage.container.find("#zp_report_Setting_list,#zp_report_settings_loading").hide(),Timetracker.Util.showHideNoData({msg:ZPI18N.getString("zp.payperiod.nodatamsg"),buttonName:ZPI18N.getString("zp.payperiodaddbutton"),buttonCallBack:ReportSetting.constructAddEditPage,desc:ZPI18N.getString("zp.leave.payperioddef")}),settingsPage.container.find("#addPayPeriodBtn").closest(".zpl_btnmnu").addClass("DNI"))}},destroyZComp:function(){var modal=settingsPage.container.find("#configurePayPeriod");modal.find("select").each(function(){ZPeopleComponents.select(modal.find("#"+$(this).attr("id"))).destroy()}),modal.find("textarea").each(function(){ZPeopleComponents.tokenfield(modal.find("#"+$(this).attr("id"))).destroy()})},showHideConfirmDeleteButtons:function(obj,toggleId,callBack){callBack&&toggleId&&ModuleComp.Modal.delete(function(){callBack(obj)},ZPI18N.getString("zp.payperiod.deletepayperiod"),ZPI18N.getString("zp.common.delEntityInfo2",[ZPI18N.getString("zp.spayperiod")+" "+ZPI18N.getString("zp.sconfig")]),ZPI18N.getString("zp.confirm"),{calId:toggleId})},monthlyOptions:function(skipNone,isStart){var monthlyOpt=[],cnt=28;!skipNone&&isStart&&(cnt=29),monthlyOpt.push({label:ZPI18N.getString("zp.select"),value:RSCONSTANTS.NONE});for(var i=1;i<=cnt;i++)monthlyOpt.push({label:i+ReportSettings.getNumberSuffix(i),value:i});return monthlyOpt.push({label:ZPI18N.getString("zp.schlastday"),value:RSCONSTANTS.LASTDAY}),monthlyOpt},weeklyOptions:function(skipNone,isStart){var weeklyOpt=[];return weeklyOpt.push({label:ZPI18N.getString("zp.select"),value:RSCONSTANTS.NONE}),weeklyOpt.push({label:ZPI18N.getString("zp.sunday"),value:RSCONSTANTS.SUNDAY}),weeklyOpt.push({label:ZPI18N.getString("zp.monday"),value:RSCONSTANTS.MONDAY}),weeklyOpt.push({label:ZPI18N.getString("zp.tuesday"),value:RSCONSTANTS.TUESDAY}),weeklyOpt.push({label:ZPI18N.getString("zp.wednesday"),value:RSCONSTANTS.WEDNESDAY}),weeklyOpt.push({label:ZPI18N.getString("zp.thursday"),value:RSCONSTANTS.THURSDAY}),weeklyOpt.push({label:ZPI18N.getString("zp.friday"),value:RSCONSTANTS.FRIDAY}),weeklyOpt.push({label:ZPI18N.getString("zp.saturday"),value:RSCONSTANTS.SATURDAY}),weeklyOpt},iterate:function(reportList){void 0!==reportList&&$.each(reportList,function(key,value){var rsJson={};rsJson.reportSettID=value.rsID;var freq=value.rsFrequency;if(freq===RSCONSTANTS.MONTHLY){rsJson.frequencyCode=freq,rsJson.frequencyName=ZPI18N.getString("zp.monthly"),rsJson.toDayCode=value.rsToDay,rsJson.toDayName=ZPI18N.getString("zp.schlastday"),value.rsToDay!==RSCONSTANTS.LASTDAY&&(rsJson.toDayName=value.rsToDay);var startDay=ReportSettings.getStartDayFromEndDay(freq,value.rsToDay),info=ReportSettings.getStartDayEndDayInfo(freq,value.rsToDay),cycle=startDay;startDay!==RSCONSTANTS.LASTDAY&&(cycle+=ReportSettings.getNumberSuffix(parseInt(startDay))),cycle+=" <span class='dgry'>"+info[0]+"</span> - "+rsJson.toDayName,rsJson.toDayCode!==RSCONSTANTS.LASTDAY&&(cycle+=ReportSettings.getNumberSuffix(parseInt(rsJson.toDayName))),cycle+=" <span class='dgry'>"+info[1]+"</span>",rsJson.ppcycle=cycle,rsJson.startDayCode=startDay,rsJson.closureDayCode=value.rsClosureDay,rsJson.closureDayName=ZPI18N.getString("zp.select"),value.rsClosureDay===RSCONSTANTS.LASTDAY?rsJson.closureDayName=ZPI18N.getString("zp.schlastday"):value.rsClosureDay!==RSCONSTANTS.NONE&&(rsJson.closureDayName=value.rsClosureDay)}else if(freq===RSCONSTANTS.SEMIMONTHLY){rsJson.frequencyCode=freq,rsJson.frequencyName=ZPI18N.getString("zp.monthly"),rsJson.toDayCode=value.rsToDay,rsJson.toDayName=ZPI18N.getString("zp.schlastday"),value.rsToDay!==RSCONSTANTS.LASTDAY&&(rsJson.toDayName=value.rsToDay);var stEndDet=ReportSettings.getStartDayEndDay(value.rsToDay);info=ReportSettings.getStartDayEndDayInfo(freq,value.rsToDay);cycle="<div>"+stEndDet.startDay_1,stEndDet.startDay_1!==RSCONSTANTS.LASTDAY&&(cycle+=ReportSettings.getNumberSuffix(parseInt(stEndDet.startDay_1))),cycle+=" <span class='dgry'>"+info[0]+"</span> - "+rsJson.toDayName,rsJson.toDayCode!==RSCONSTANTS.LASTDAY&&(cycle+=ReportSettings.getNumberSuffix(parseInt(rsJson.toDayName))),cycle+=" <span class='dgry'>"+info[1]+"</span>",cycle+=" </div>",cycle+="<div class='MT10'>"+stEndDet.startDay_2,stEndDet.startDay_2!==RSCONSTANTS.LASTDAY&&(cycle+=ReportSettings.getNumberSuffix(parseInt(stEndDet.startDay_2))),stEndDet.endDay_2===RSCONSTANTS.LASTDAY?cycle+=" <span class='dgry'>"+info[2]+"</span> - "+ZPI18N.getString("zp.schlastday"):(cycle+=" <span class='dgry'>"+info[2]+"</span> - "+stEndDet.endDay_2,cycle+=ReportSettings.getNumberSuffix(parseInt(stEndDet.endDay_2))),cycle+=" <span class='dgry'>"+info[3]+"</span>",cycle+=" </div>",rsJson.ppcycle=cycle,rsJson.info=info,rsJson.startDayCode=startDay,rsJson.closureDayCode=value.rsClosureDay,rsJson.toDayCode_2=value.rsSecToDay,rsJson.closureDayCode_2=value.rsSecClosureDay,rsJson.closureDayName=ZPI18N.getString("zp.select"),value.rsClosureDay===RSCONSTANTS.LASTDAY?rsJson.closureDayName=ZPI18N.getString("zp.schlastday"):value.rsClosureDay!==RSCONSTANTS.NONE&&(rsJson.closureDayName=value.rsClosureDay),rsJson.closureDayName_2=ZPI18N.getString("zp.select"),value.rsSecClosureDay===RSCONSTANTS.LASTDAY?rsJson.closureDayName_2=ZPI18N.getString("zp.schlastday"):value.rsSecClosureDay!==RSCONSTANTS.NONE&&(rsJson.closureDayName_2=value.rsSecClosureDay),rsJson.rsSecPayrollClosure=value.rsSecPayrollClosure}else{rsJson.frequencyCode=freq,rsJson.frequencyName=ZPI18N.getString("zp.weekly"),rsJson.toDayCode=value.rsToDay,rsJson.toDayName=RSCONSTANTS.WEEK_NAME[value.rsToDay];startDay=ReportSettings.getStartDayFromEndDay(freq,value.rsToDay),cycle=RSCONSTANTS.WEEK_NAME[startDay]+" - "+rsJson.toDayName;rsJson.ppcycle=cycle,rsJson.startDayCode=startDay,rsJson.closureDayCode=value.rsClosureDay,rsJson.closureDayName=ZPI18N.getString("zp.select"),value.rsClosureDay!==RSCONSTANTS.NONE&&(rsJson.closureDayName=RSCONSTANTS.WEEK_NAME[value.rsClosureDay])}rsJson.rsName=ZPeople.decodeTxt(value.rsName),rsJson.isFreeze=value.rsIsFreeze,rsJson.rsProcessEncashment=value.rsProcessEncashment,rsJson.payrollClosure=ZP.optValue(value,"rsPayrollClosure",-1),rsJson.locationList=value.rsLocations,rsJson.appEmpType=value.rsEmpTypes,rsJson.appRole=value.rsRoles,rsJson.rsReviewStatus=value.rsReviewStatus,value.hasOwnProperty("MODULE_DATA")&&(rsJson.MODULE_DATA=value.MODULE_DATA),ReportSetting.ALL_LIST[rsJson.reportSettID]=rsJson})},updateClosureDay:obj=>{var modal=settingsPage.container.find("#configurePayPeriod");modal.find("#zp_rs_to_day_error").hide(),Timetracker.Util.removeError(modal.find("#zp_rs_to_day"));var appendTo=modal.find(".zpl_mcnt"),frequency=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_frequency")).getValue()),toDay=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_to_day")).getValue());if(frequency===RSCONSTANTS.WEEKLY||frequency===RSCONSTANTS.BIWEEKLY)return(-1==toDay||isNaN(toDay))&&ZPeopleComponents.select(modal.find("#zp_rs_closure_day")).setAttributes({options:ReportSetting.weeklyOptions(!0),selectedValue:RSCONSTANTS.NONE,dropdownList:{appendTo:appendTo}}),void ReportSetting.getPayPeriodInfo();if(-1==toDay||isNaN(toDay))return ZPeopleComponents.select(modal.find("#zp_rs_closure_day")).setAttributes({options:ReportSetting.monthlyOptions(!0,!1),selectedValue:RSCONSTANTS.NONE,dropdownList:{appendTo:appendTo}}),void(frequency===RSCONSTANTS.SEMIMONTHLY&&ZPeopleComponents.select(modal.find("#zp_rs_closureday_semMont")).setAttributes({options:ReportSetting.monthlyOptions(!0,!1),selectedValue:RSCONSTANTS.NONE,dropdownList:{appendTo:appendTo}}));if(ReportSetting.updateValuesBasedOnPrev(modal.find("#zp_rs_closure_day"),toDay,appendTo),frequency===RSCONSTANTS.SEMIMONTHLY){var toDay2=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_today_semMont")).getValue());ReportSetting.updateValuesBasedOnPrev(modal.find("#zp_rs_closureday_semMont"),toDay2,appendTo)}ReportSetting.getPayPeriodInfo()},updatePayrollDay:obj=>{var modal=settingsPage.container.find("#configurePayPeriod");modal.find("#zp_rs_closure_day_error,#zp_rs_closure_dayerror_semMont").hide(),Timetracker.Util.removeError(modal.find("#zp_rs_closure_day")),Timetracker.Util.removeError(modal.find("#zp_rs_closureday_semMont"));var closureDay,appendTo=modal.find(".zpl_mcnt"),frequency=parseInt(ZPeopleComponents.select(modal.find("#zp_rs_frequency")).getValue()),closureDaySelector="#zp_rs_closure_day",payrollDaySelector="#zp_rs_freeze_date";if(frequency===RSCONSTANTS.WEEKLY||frequency===RSCONSTANTS.BIWEEKLY)return(-1==(closureDay=parseInt(ZPeopleComponents.select(modal.find(closureDaySelector)).getValue()))||isNaN(closureDay))&&ZPeopleComponents.select(modal.find("#zp_rs_freeze_date")).setAttributes({options:ReportSetting.weeklyOptions(!0),selectedValue:RSCONSTANTS.NONE,dropdownList:{appendTo:appendTo}}),void ReportSetting.getPayPeriodInfo();obj.target.length>0&&"zp_rs_closureday_semMont"===obj.target.attr("id")&&(closureDaySelector="#zp_rs_closureday_semMont",payrollDaySelector="#zp_rs_freeze_date2"),-1==(closureDay=parseInt(ZPeopleComponents.select(modal.find(closureDaySelector)).getValue()))||isNaN(closureDay)?ZPeopleComponents.select(modal.find(payrollDaySelector)).setAttributes({options:ReportSetting.monthlyOptions(!0),selectedValue:RSCONSTANTS.NONE,dropdownList:{appendTo:appendTo}}):ReportSetting.updateValuesBasedOnPrev(modal.find(payrollDaySelector),32==closureDay?1:closureDay+1,appendTo),ReportSetting.getPayPeriodInfo()},updateValuesBasedOnPrev:(ele,baseVal,appendTo)=>{var day=parseInt(ZPeopleComponents.select(ele).getValue());day=isNaN(day)?RSCONSTANTS.NONE:day;var selectedVal=RSCONSTANTS.NONE,options=ReportSetting.consOptionForClsDay(baseVal);options.map(obj=>obj.value).includes(day)&&(selectedVal=day),ZPeopleComponents.select(ele).setAttributes({options:options,selectedValue:selectedVal,dropdownList:{appendTo:appendTo}})}};var User={isFromDashBoard:!1,licenseCountElm:'<div class="dvusrcount row MB20" id="licensecount_details"><div class="PL20 PR30"><div id="import_total_licensebtn" class="btn-group PL10">'+ZPI18N.getString("zp.totalpplicense")+'<span class="spncount" id="import_total_license"></span></div><div class="btn-group PL10" id="employees_addebtntxt">'+ZPI18N.getString("zp.employeeprofilesadded")+'<span class="spncount" id="import_employees_added"></span></div><div class="btn-group PL30">'+ZPI18N.getString("zp.licencecountleft")+'<span class="spncount" id="import_licensecnt_left"></span></div><span id="license_alert" data-content="" data-trigger="manual" data-toggle="popover" role="button" data-placement="right" name="fieldToolTip" class="IC-alert red ML5 PRI" tabindex="0" data-original-title="" title="" style="top: 1px;tabindex="0""></span></div></div></div>',noRecFoundElms:'<div class="ZPNdata" id="no_recfound_img"><svg xml:space="preserve" enable-background="new 0 0 124 124" viewBox="0 0 124 124" y="0px" x="0px" xmlns:xlink="https://www.w3.org/1999/xlink" xmlns="https://www.w3.org/2000/svg" id="Layer_1" version="1.1" class="ZPsvg"><g id="No_Records"><g><rect height="2" width="48" y="37.4" x="40.1"/><rect height="2" width="26" y="24.4" x="52.1"/><rect height="2" width="48" y="43.4" x="40.1"/><rect height="2" width="48" y="50.4" x="40.1"/><rect height="2" width="48" y="87.4" x="40.1"/><rect height="2" width="48" y="94.4" x="40.1"/><rect height="2" width="48" y="101.4" x="40.1"/><path d="M67.7,79.4c-0.1,0.2-0.2,0.3-0.3,0.5c-0.4,0.5-0.9,1.1-1.4,1.5h22.1v-2H67.7z"/><path d="M40.3,79.4h-0.3v2h2C41.4,80.8,40.9,80.1,40.3,79.4z"/><path d="M70.8,72.4c-0.1,0.7-0.3,1.3-0.5,2h17.8v-2H70.8z"/><path d="M70.4,64.4c0.2,0.7,0.3,1.3,0.4,2h17.3v-2H70.4z"/><path d="M40.7,58.6c0.3-0.4,0.7-0.8,1-1.1h-1.6v2C40.3,59.2,40.5,58.9,40.7,58.6z"/><path d="M66.3,57.4c0.6,0.6,1.2,1.3,1.7,2h20.1v-2H66.3z"/><path d="M36.3,87.4l6.6-8.2l0.9,0.8c0.3,0.3,0.6,0.6,0.9,0.8c0.3,0.3,0.7,0.5,1,0.7l1,0.7l-6.6,8.2l-0.9-1.1c-0.1-0.1-0.2-0.2-0.3-0.3l-1-0.8c-0.1-0.1-0.2-0.2-0.4-0.2L36.3,87.4z M43.2,82.4l-3.4,4.3l0.3,0.3l3.4-4.3c-0.1,0-0.1-0.1-0.2-0.1S43.2,82.5,43.2,82.4z"/><path d="M33.5,87.1c0.4-0.5,1-0.9,1.6-1.2V24.4h13v-2h-15v65.2L33.5,87.1z"/><polygon points="82.1,22.4 82.1,24.4 93.1,24.4 93.1,108.4 35.1,108.4 35.1,100.7 33.1,103.2 33.1,110.4 95.1,110.4 95.1,22.4"/></g><g><path d="M65.2,11.9c3,0,5.5,2.1,6.2,5l0.3,1.6h1.6h6.8v10h-30v-10h7h1.6l0.3-1.6C60.2,13.5,62.6,11.5,65.2,11.9M65.2,9.9c-4,0-7.3,2.8-8.1,6.6h-9v14h34v-14h-8.8C72.5,12.7,69.2,9.9,65.2,9.9L65.2,9.9z" class="filcolor"/><path d="M64.4,77.6c2.2-2.8,3.2-6.2,2.8-9.8c-0.4-3.5-2.1-6.7-4.9-8.9c-5.7-4.6-14.1-3.7-18.7,2.1c-2.2,2.8-3.2,6.2-2.8,9.8c0.4,3.5,2.1,6.7,4.9,8.9C51.4,84.2,59.8,83.3,64.4,77.6z M47.1,77.9c-2.3-1.8-3.8-4.5-4.1-7.4c-0.3-2.9,0.5-5.8,2.4-8.1c3.8-4.8,10.8-5.5,15.5-1.7c2.3,1.8,3.8,4.5,4.1,7.4c0.3,2.9-0.5,5.8-2.4,8.1C58.8,80.9,51.9,81.7,47.1,77.9z" class="filcolor"/><path d="M67.3,79.9c2.8-3.6,4.1-8,3.6-12.5s-2.7-8.6-6.3-11.4c-3.6-2.8-8-4.1-12.5-3.6c-4.5,0.5-8.6,2.7-11.4,6.3c-2.8,3.6-4.1,8-3.6,12.5c0.5,4.5,2.7,8.6,6.3,11.4c3.6,2.8,8,4.1,12.5,3.6C60.4,85.7,64.5,83.5,67.3,79.9z M44.7,80.8c-3.1-2.5-5-6-5.5-9.9c-0.4-3.9,0.7-7.8,3.2-10.9c2.5-3.1,6-5,9.9-5.5c3.9-0.4,7.8,0.7,10.9,3.2c3.1,2.5,5,6,5.5,9.9c0.4,3.9-0.7,7.8-3.2,10.9c-2.5,3.1-6,5-9.9,5.5C51.7,84.4,47.8,83.3,44.7,80.8z" class="filcolor"/><path d="M41.1,93.2c0.7-0.9,1-2,0.9-3.1c-0.1-1.1-0.7-2.1-1.6-2.8l-1-0.8c-0.9-0.7-2-1-3.1-0.9c-1.1,0.1-2.1,0.7-2.8,1.6l-13.3,16.7c-0.7,0.9-1,2-0.9,3.1c0.1,1.1,0.7,2.1,1.6,2.8l1,0.8c1.8,1.5,4.5,1.2,6-0.7L41.1,93.2zM23.2,108.7l-1-0.8c-0.8-0.7-1-2-0.3-2.8l13.3-16.7c0.3-0.4,0.8-0.7,1.3-0.7c0.5-0.1,1,0.1,1.5,0.4l1,0.8c0.4,0.3,0.7,0.8,0.7,1.3c0.1,0.5-0.1,1-0.4,1.5L26,108.4C25.3,109.3,24,109.4,23.2,108.7z" class="filcolor"/><rect height="2" width="7" class="filcolor" y="40.4" x="99.1"/><rect height="2" width="4" class="filcolor" y="44.4" x="117.1"/><rect height="2" width="5" class="filcolor" y="49.4" x="104.1"/><rect height="2" width="4" class="filcolor" y="49.4" x="113.1"/><rect height="2" width="16.9" class="filcolor" y="44.4" x="95.1"/><rect height="2" width="7" class="filcolor" y="71.4" x="6.1"/><rect height="2" width="4" class="filcolor" y="75.4" x="24.1"/><rect height="2" width="5" class="filcolor" y="80.4" x="11.1"/><rect height="2" width="13" class="filcolor" y="80.4" x="20.1"/><rect height="2" width="14.9" class="filcolor" y="75.4" x="4.1"/></g></g></svg><p class="no-para">No records found.</p></div>',usersPageElm:'<div style="display: none;" id="addEmp" class="modal popRgtModel modal-right" name="userPopup"><div class="modal-dialog"><div class="modal-content "><div class="modal-header"><a aria-label="Close" data-dismiss="modal" class="close IC-cls-1px red"></a><h6 id="exampleModalLabel" class="modal-title">'+ZPI18N.getString("zp.addinviteusers")+'</h6></div><div class="modal-body"><div class="row"><div class="dvusrcount row MB20 PL3"><div class="PL20 PR30"><div class="btn-group PL3" id="employees_addebtntxt">'+ZPI18N.getString("zp.employeeprofilesadded")+'<span class="spncount" id="employees_added"></span></div><div class="btn-group PL40">'+ZPI18N.getString("zp.licencecountleft")+'<span class="spncount" id="licensecnt_left"></span></div></div></div><div class="col-md-12 tabpills PR15" id="addUserSubTabs"><ul id="dvAddEmp" role="tablist" class="nav nav-tabs"><li class="active" role="presentation" id="formAddNonPopUp"><a data-toggle="tab" role="tab" href="">'+ZPI18N.getString("zp.accdtls")+'</a></li><li role="presentation" id="formAddEmpPopUp"><a>'+ZPI18N.getString("zp.basicinfo")+'</a></li></ul></div><div class="tab-content col-md-11 MT20 ML5"><div id="formAddEmp" class="tab-pane fade" role="tabpanel" name="addEmpDtls"><p class="section DN">'+ZPI18N.getString("zp.empinfo")+'</p><p class="MB20 DN" id="inviteUsernotes"></p><div class="row"><div id="empIdErr"><label class="col-md-3 MT5 frmmandpos"><sup>*</sup>'+ZPI18N.getString("zp.empid")+'</label><div class="col-md-6 form-group" name="errDiv"><input type="text" class="form-control" autofocus="" id="employeeId"><div class="addbadge MT5 S12 FL" id="lastEMpId">'+ZPI18N.getString("zp.lastemployeeid")+'&nbsp;<span></span></div><div class="dverrormsg hide"></div></div></div></div><div class="row"><div id="firstNameParentElm"><label class="col-md-3 MT5 frmmandpos"><sup>*</sup>'+ZPI18N.getString("zp.fname")+'</label><div class="col-md-6 form-group" name="errDiv"><input type="text" class="form-control" id="fname"></div></div></div><div class="row" id="lastNameParentElm"><div ismandatory="true"><label class="col-md-3 MT5 frmmandpos"><sup>*</sup>'+ZPI18N.getString("zp.lname")+'</label><div class="col-md-6 form-group" name="errDiv"><input type="text" class="form-control" id="lname"></div></div></div><div class="row" id="emailIdParentElm"><div ismandatory="true"><label class="col-md-3 MT5 frmmandpos"><sup>*</sup>'+ZPI18N.getString("zp.emailid")+'</label><div id="mobMail" class="col-md-6 form-group" name="errDiv"><input type="text" onkeyup="User.togglePhone()" class="form-control" disabled="" value="" id="disabledEmailId"></div></div></div><div class="row" id="locationParentElm" style="display:none"><div ismandatory="true"><label class="col-md-3 MT5 frmmandpos">'+ZPI18N.getString("zp.location")+'</label><div class="col-md-6 form-group" name="errDiv" id="locationgrp"></div></div></div><div class="row" id="onboardParentElm" style="display:none"><div><label class="col-md-3 MT5 formandpos">'+ZPI18N.getString("zp.triggeronboadring")+'</label><div class="col-md-6 form-group" name="errDiv" id="locationgrp"><div class="checkbox checkbox-primary"><input id="onboardChkbox" type="checkbox" keyname="enableOnboarding"/><label class="MT6"></label></div></div></div></div></div><div id="formAddNon" class="tab-pane fade active in" role="tabpanel" name="formAddNonDtls"><pclass="MB20">'+ZPI18N.getString("zp.addempnotes")+'</p><br><div class="row"><div class="col-md-11"><div class="form-group MB0" ismandatory="true"><div><label class="control-label frmmand"><sup>*</sup>'+ZPI18N.getString("zp.emailid")+'</label></div><div class="col-md-6 PL0 PR5"><input type="text" id="emailEditBox" onkeyup="User.showPreview()" class="form-control" value="" autofocus="" placeholder="michael"></div><div class="bgcl col-md-1 PT5 PL0 PR5 text-center"> <a id="mailspecialChar">@</a> </div><div class="col-md-5 PL0 PR0" id="domaingrp"></div><div class="clearfix FL W100"><div class="input-group P5 gry PL3" id="emailIdErrParent"><span id="previewEmailId" class="P5 PL0"></span><div class="dverrormsg"></div></div></div></div><div class="form-group"><div class="col-md-6 PL0 PR5 PT5 hide"  id="passwordParentElm"><label class="frmmand"><sup>*</sup>'+ZPI18N.getString("zp.passwd")+'</label><input type="text" class="form-control" id="pswd"><a class="FR MT5" onClick="User.toggPwdForAUD()">'+ZPI18N.getString("zp.setpwdautnolink")+'</a></div><div class="col-md-12 PL0 PR5 PT5" id="passwordParentElmAgp"><p class="mb20">'+ZPI18N.getString("zp.passwordtxt",['User.toggPwdForAUD("defined")'])+'</p><p class="info"></p></div><div class="col-md-1 PT30"><adata-placement="right" class="dvTool IC-qus S15 gry DN" role="button" tabindex=0 data-trigger="hover" id="singleUPwd" data-toggle="popover" data-content=""></a></div></div></div></div></div></div></div></div><div class="modal-footer"> <a class="btn btn-primary" onclick="User.AddUser.nextStep()" id="nextStep"><fmt:message key="zp.next" bundle="zpeopleResource"/></a></div></div></div></div>'};function openPopUp(object){var pageId=Layout.Page.container,currMode=Layout.Page.pageId.split("-")[2],findElmId=$(object).attr("class");User.isMigrateUser=!1,pageId.find("div#formAddEmp,div#formAddNon").find("div[isMandatory=true]").removeClass("has-error"),"addMulti"===findElmId&&$("div#addMulti").find("table#massAddUsersTable").find("tr[isAddedByClick='true']").remove(),"employeeprofile"===User.currMode&&-1!==findElmId.indexOf("addEmp")&&(pageId.find("div#emailIdParentElm,div#lastNameParentElm").attr("isMandatory","false"),pageId.find("div#emailIdParentElm,div#lastNameParentElm").find("label").removeClass("red")),"user"!==User.currMode||User.isLastNameMand||(pageId.find("div#lastNameParentElm").attr("isMandatory","false"),pageId.find("div#lastNameParentElm").find("label").removeClass("red")),"Non-user"===$(object).attr("status")?(User.isMigrateUser=!0,findElmId="addEmp",pageId.find("div#emailIdParentElm,div#lastNameParentElm").attr("isMandatory","true"),pageId.find("div#emailIdParentElm,div#lastNameParentElm").find("label").addClass("red"),pageId.find("div#lastEMpId").hide(),User.AddUser.openDummyEmployeePage(object)):pageId.find("div#lastEMpId").show(),User.currentErecNo=$(object).closest("tr").attr("empErecNo"),animatePopUpIn(findElmId,User.isMigrateUser),ZPSetupCommon.isEmpty(findElmId)||("user"===currMode?($("ul#dvAddEmp li:last").removeClass("active").removeClass("active"),$("ul#dvAddEmp li:first").addClass("active").removeClass("hide"),pageId.find("div#formAddNon").addClass("active in"),pageId.find("div#formAddEmp").removeClass("active in"),$("ul#dvAddEmp li:first").on("click",function(){pageId.find("a#nextStep").attr("onclick","User.AddUser.nextStep()"),pageId.find("a#nextStep").text(ZPI18N.getString("zp.next"))}),$("ul#dvAddEmp li:last").on("click",function(){pageId.find("a#nextStep").attr("onclick","User.AddUser.addDirectUser()"),pageId.find("a#nextStep").text(ZPI18N.getString("zp.add"))}),$("input#disabledEmailId").prop("disabled",!0)):($("ul#dvAddEmp li:last").addClass("active").removeClass("hide"),$("ul#dvAddEmp li:first").addClass("hide"),pageId.find("div#formAddNon").removeClass("active in"),pageId.find("div#formAddEmp").addClass("active in"),pageId.find("input#disabledEmailId").prop("disabled",!1),pageId.find("a#nextStep").attr("onclick","User.AddUser.addDirectUser()"),pageId.find("a#nextStep").text(ZPI18N.getString("zp.add"))),removeTextNode(pageId.find("div#emailIdErrParent")))}function removeTextNode(div){div.contents().filter(function(){return 3===this.nodeType}).remove()}function animatePopUpIn(popUpId,type){var pageId=Layout.Page.container;pageId.find("div.dverrormsg").remove(),pageId.find("div#"+popUpId).modal(),pageId.find("a#nextStep").attr("onclick","User.AddUser.nextStep()"),("user"===User.currMode||!User.isMigrateUser&&"employeeprofile"===User.currMode)&&($("div#"+popUpId).find("input[type='text'][class='form-control']").val(""),$("div#"+popUpId).find("div").removeClass("has-error"))}User.isScrollEventFired=!1,User.sortOrder={"0_0":"0_1","0_1":"0_0","3_0":"3_1","3_1":"3_0","4_0":"4_1","4_1":"4_0"},User.ListUsers={},User.AddUser={},User.NonUserType="3",User.isMobile=!1,User.viewId=null,User.disperr=null,User.pwdProtCheck=null,User.searchVal=null,User.searchType=null,User.canSendcallBack=!1,User.lastEmployeeId="",User.endOfpage=!1,User.totalUsersCount=0,User.isAllowToAddUser=!1,User.maxRangeOfgetData=25,User.currMode=null,User.nonUser=3,User.isMigrateUser=!1,User.variables={user:{reload:null,filterParams:{searchByLoc:null,searchByDept:null,searchByRole:null,userStatus:null,searchByEmpStatus:null}},employeeprofile:{reload:null,filterParams:{searchByLoc:null,searchByDept:null,searchByRole:null,userStatus:null}}},User.openFilter=!1,User.isLastNameMand=!1,User.allowToAddUserDirectly=1,User.intermediateDomain=3,User.currentErecNo=null,User.modifiedByTime="2_0",User.mobNoDtls={},User.ALLOW_MOBILEUSER_ADDITION=!1,User.typingTimer=null,User.doneTypingInterval=1e3,User.isInviteMode=!1,User.mobOnlyStatus=!1,User.empidLength="100",User.fnameLength="100",User.lnameLength="100",User.mailLength="100",User.fnameUnique="false",User.lnameUnique="false",User.isAutoGenPwd=!0,User.empidDispName=ZPI18N.getString("zp.empid"),User.fnameDispName=ZPI18N.getString("zp.fname"),User.lnameDispName=ZPI18N.getString("zp.lname"),User.mailDispName=ZPI18N.getString("zp.emailid"),User.locationDispName=ZPI18N.getString("zp.location"),User.toggleAGPforAddDir=!0,User.toggleAGPforMulUsrsDir=!0,User.toggleAGPforBulkConvDir=!0,User.ListUsers.usersListPageInit=function(){if(User.currMode=Layout.Page.currentmode.split("/")[2],null==User.variables[User.currMode].reload&&(Layout.Page.container.find("div#close_user_options").on("click",function(){Layout.Page.container.find("div#usersOptions,div#licenseDtlsRow").toggleClass("DN"),Layout.Page.container.find("table#userListTable input[name='userRowCheck']").prop("checked",!1),Layout.Page.container.find("table#userListTable tbody tr").removeClass("active")}),User.variables[User.currMode].reload=!0),1==User.variables[User.currMode].reload||!0===ZPForm.CURRFORM_PARAM.refreshView){var params={conreqcsr:csrfToken,sortByType:User.modifiedByTime,isAjax:!1};if("employeeprofile"===User.currMode&&(params.userType=User.NonUserType),Object.assign(params,User.variables[User.currMode].filterParams),User.endOfPage=!1,Layout.Page.container.find("div#scrollContent").empty(),Layout.Page.container.append(Organization.ZP_PAGE_LOADING),0==$("button#addDirectBtn").length){ZPeople.Request.send("/users/getAddUserPage",{mode:"user",needAllDtls:!1},User.AddUser.checkAddUserDirectlyAllowed)}ZPeople.Request.send("/users/getUsersListing",params,User.ListUsers.usersListConstruction),User.variables[User.currMode].reload=!1}},User.ListUsers.usersListConstruction=function(resultData,paramsObj){var pageContent,currMode;void 0==paramsObj.startInd&&(ZPOnboarding.isOnboarding=resultData.isOnboarding),resultData.empType==User.NonUserType?(pageContent=$("div#admin-employeerecords-employeeprofile"),currMode="employeeprofile"):(pageContent=$("div#admin-employeerecords-user"),currMode="user"),resultData.hasOwnProperty("dataChangeForms")&&transfers.addToRecordSelectionActions(pageContent.find("#usersOptions .col-md-11"),"btn btn-default MR5",resultData.dataChangeForms,!1,!1,"user"==currMode),User.myCurrErec=resultData.loginErec,User.viewId=resultData.viewID,User.pwdProtCheck=resultData.pwdProtCheck,User.ALLOW_MOBILEUSER_ADDITION=resultData.ALLOW_MOBILEUSER_ADDITION,User.ALLOW_MOBILEUSER_ADDITION=resultData.ALLOW_MOBILEUSER_ADDITION,User.userRelatedFunction(resultData),pageContent.find("div#scrollContent").empty(),pageContent.find("div#scrollContent").append(User.constructUsersList(resultData)),User.setNonUsersDataInEachRowOfUsersList(resultData),User.lastEmployeeId=resultData.lastEmployeeId,pageContent.find("div#zp_page_loading").remove(),$("select#domainName").on("change",function(){$("span#domainView").text("@"+$("select#domainName").val())}),pageContent.find("div#close_user_options").off().on("click",function(){pageContent.find("div#usersOptions,div#licenseDtlsRow").toggleClass("DN"),pageContent.find("table#userListTable input[name='userRowCheck']").prop("checked",!1),pageContent.find("table#userListTable tbody tr").removeClass("active")}),$(".ZPtitle").tooltip(),User.isAllowToAddUser=resultData.isAllowToAddEmployee,Layout.usersLength=Object.keys(resultData.usersDtls).length,User.totalUsersCount=Object.keys(resultData.usersDtls).length,pageContent.data({totalUsersCount:Object.keys(resultData.usersDtls).length}),pageContent.data({userCnt:Object.keys(resultData.usersDtls).length}),User.setCurrentFilterValues(resultData),$("a#addNew").data({domainsList:resultData.userDomains}),pageContent.find("table#userListTable").data({startInd:resultData.startInd})},User.showPreview=function(){var pageId=Layout.Page.container;removeTextNode(pageId.find("div#emailIdErrParent"));var inpName=pageId.find("#emailEditBox").val(),domName=$("#domaingrp").find("span").text();if(ZPSetupCommon.isEmpty(inpName))Layout.Page.container.find("span#previewEmailId").text("");else{var finEmail=inpName+"@"+domName;Layout.Page.container.find("span#previewEmailId").text(ZPI18N.getString("zp.mailidpreview")+finEmail)}},User.switchAddDirectUser=function(pageSTatus,isImportOptns,predefinedCheck){var pageId=Layout.Page.container;if(pageId.find("ul#addEmpMenu").find("li[name='directUsers']").remove(),pageSTatus===User.allowToAddUserDirectly)if(void 0!=isImportOptns&&isImportOptns&&"admin-employeerecords-employeeprofile"===Layout.Page.pageId)pageId.find("li#directConvert").remove(),pageId.find("ul#convertOptns").append("<li id='directConvert' onclick='User.AddUser.migrateNonuserstoUsers(\"directuser\")'><a class='dvshwaddmulti'>"+ZPI18N.getString("zp.convertdirectly")+"</a></li>");else if(void 0!=isImportOptns&&isImportOptns)pageId.find("li#directImport").remove(),pageId.find("ul#importOptns").append("<li id='directImport' onclick='User.AddUser.getAddUserListPage(null,null,true,true)'><a class='dvshwaddmulti'>"+ZPI18N.getString("zp.importusersdirectly")+"</a></li>");else if("user"==predefinedCheck){var replaceBtnDIv="<div class='btnMulti FR' id='UserDirect'><button class='btn btn-primary btnMulti FR dropdown' id='addDirectBtn' onclick=User.AddUser.getAddUserListPage(undefined,undefined,undefined,true)><span class='FL'>"+ZPI18N.getString("zp.addusers")+"</button><i id='remveMe' class='dropdown-toggle' data-toggle='dropdown'></i><ul class='dropdown-menu' style='width:120%'><li onclick=User.AddUser.getAddUserListPage('invite')><a class='addEmp'>"+ZPI18N.getString("zp.addinviteusers")+"</a></li><li id='addMultiUserOptn' onclick=User.AddUser.getAddMultiUserListPage('invite')><a class='addMulti'>"+ZPI18N.getString("zp.addmultiinviteusers")+"</a></li><li onclick=User.AddUser.getAddMultiUserListPage()><a>"+ZPI18N.getString("zp.addmultiusers")+"</a></li></ul></div>";$(replaceBtnDIv).replaceAll(pageId.find("div#addOptnbtn").find("a.btn.btn-primary.dropdown-toggle")),pageId.find("li#directImport").remove(),pageId.find("ul#importOptns").append("<li id='directImport' onclick='User.AddUser.getAddUserListPage(null,null,true,true)'><a class='dvshwaddmulti'>"+ZPI18N.getString("zp.importusersdirectly")+"</a></li>");var abutton=pageId.find("div#addOptnbtn").find("a.btn.btn-primary.dropdown-toggle");abutton.hasClass("btn btn-primary dropdown-toggle")&&abutton.toggleClass("btn btn-primary btnMulti FR dropdown")}else"employeeprofile"==predefinedCheck?(pageId.find("li#directConvert").remove(),pageId.find("ul#convertOptns").append("<li id='directConvert' onclick='User.AddUser.migrateNonuserstoUsers(\"directuser\")'><a class='dvshwaddmulti'>"+ZPI18N.getString("zp.convertdirectly")+"</a></li>")):(pageId.find("ul#addEmpMenu").append('<li name="directUsers" onclick="User.AddUser.getAddUserListPage(undefined,undefined,undefined,true)"><a class="addMulti">'+ZPI18N.getString("zp.addusers")+"</a></li>"),pageId.find("ul#addEmpMenu").append('<li name="directUsers" onclick="User.AddUser.getAddMultiUserListPage()"><a class="addMulti">'+ZPI18N.getString("zp.addmultiusers")+"</a></li>"))},User.displayTotalUserCnt=function(data,params){Layout.Page.container.find("span#totalusersCnt").text(-1===data.totalUserCount?"0":data.totalUserCount).toggleClass("hide").prev("a#userCount").toggleClass("hide"),User.isScrollEventFired=!1},User.ListUsers.resetAfterClose=function(){var pageId=Layout.Page.container;pageId.find("#filterIcon").removeClass("active"),pageId.hasClass("filter-wrap")&&pageId.removeClass("filter-wrap")},User.ListUsers.getSortedUser=function(obj){var pageId=Layout.Page.container;if(parseInt(pageId.data("totalUsersCount"))>1){var sort=$(obj).attr("sortType");User.ListUsers.getUserList(null,sort,null,!0),$(obj).attr("sortType",User.sortOrder[sort]),$(obj).closest("table").attr("sortbytype",sort);var upAndDownArrowElm=$(obj).find("b");"IC-l-ar-dwn S13 ML5"===upAndDownArrowElm.attr("class")?upAndDownArrowElm.attr("class","IC-l-ar-top S13 ML5"):upAndDownArrowElm.attr("class","IC-l-ar-dwn S13 ML5")}},User.ListUsers.getUserList=function(startInd,sortByType,event,isSortUser,needTogetCount){var pageContent=Layout.Page.container;Layout.Page.currentmode.indexOf("admin/dashboard")>0&&(pageContent=$("div#admin-employeerecords-user"));var callback,url,searchval=pageContent.find("input#searcFilter").val(),tableObj=pageContent.find("table#userListTable"),params={};if(sortType=tableObj.attr("sortbytype"),sortByType=ZPSetupCommon.isEmpty(sortByType)?User.modifiedByTime:sortByType,params.sortByType=sortByType,"click"===event)Layout.Page.container.find("div#scrollContent").prop("scrollTop",0),params.searchByRole=pageContent.find("select#rolesDtls").val()!==ZPI18N.getString("zp.allroles")?pageContent.find("select#rolesDtls").val():0,params.searchByLoc=pageContent.find("select#locationsDtls").val()!==ZPI18N.getString("zp.alllocaction")?pageContent.find("select#locationsDtls").val():0,params.searchByDept=pageContent.find("select#deptDtls").val()!==ZPI18N.getString("zp.alldepartment")?pageContent.find("select#deptDtls").val():0,params.searchByOnbStatus=pageContent.find("select#onbStatusDtls").val(),params.userStatus=pageContent.find("select#accStatusDtls").val(),"user"===User.currMode&&(params.searchByEmpStatus=pageContent.find("select#empStatusDtls").val()),ZPSetupCommon.isEmpty(searchval)||""==searchval.trim()||(params.searchval=encodeURIComponent(searchval));else{var role=tableObj.data("role"),location=tableObj.data("location"),dept=tableObj.data("dept"),searchVal=tableObj.data("searchval"),status=tableObj.data("status"),searchByEmpStatus=tableObj.data("employeeStatus");params.searchByOnbStatus=tableObj.data("onboardingstatus"),params.searchByRole=role,params.searchByLoc=location,params.searchByDept=dept,ZPSetupCommon.isEmpty(searchVal)||(params.searchval=searchVal),ZPSetupCommon.isEmpty(dept)||(params.searchByDept=dept),ZPSetupCommon.isEmpty(role)||(params.searchByRole=role),ZPSetupCommon.isEmpty(location)||(params.searchByLoc=location),ZPSetupCommon.isEmpty(status)||(params.userStatus=status),"user"!==User.currMode||ZPSetupCommon.isEmpty(searchByEmpStatus)||(params.searchByEmpStatus=searchByEmpStatus)}params.searchType=Layout.searchType,"employeeprofile"==User.currMode&&"migrate"!==event&&"redirect"!==event&&"convert"!==event&&(params.userType=User.NonUserType),ZPSetupCommon.isEmpty(event)||"scroll"!==event||(params.startInd=pageContent.find("table#userListTable").data("startInd")),"migrate"!==event&&"redirect"!==event&&"convert"!==event||(params.userStatus="convert"===event?"1":"2"),0==params.searchByRole&&0==params.searchByLoc&&0==params.searchByDept&&ZPSetupCommon.isEmpty(params.userStatus)&&("user"!==User.currMode||ZPSetupCommon.isEmpty(params.searchByEmpStatus))&&ZPSetupCommon.isEmpty(isSortUser),needTogetCount?(callback=User.displayTotalUserCnt,params.mode="count",pageContent.find("a#userCount").html('<div class="loader-inner line-scale FR ML5"><div></div><div></div><div></div></div>'),url="/users/getUsersListing"):(callback=User.AddUser.modifyUserList,params.isAjax=!0,url="/users/getUsersListing"),User.isScrollEventFired||(User.isScrollEventFired=!0,ZPeople.Request.send(url,params,callback,event,User.failureScrollEventResponse))},User.showImportUsersPopUp=function(isQuickImport,resultObj){var pageId=Layout.Page.container,formId=pageId.find("table#userListTable").attr("formId");if(isQuickImport){var domainsList=resultObj.userDomains;User.iterateDomains(domainsList,pageId.find("select#importdomains"));var locList=resultObj.modAdminLocDetails;if(null!=locList&&void 0!=locList){var locDiv=pageId.find("div#Qilocationdiv");locDiv.attr("style","display:block");var locSelect=locDiv.find("select");User.iterateLoc(locList,$(locSelect))}User.quickImportPopUp(resultObj)}else Import.init(formId,null,Layout.Page.hash)},User.quickImportPopUp=function(resultObj){var pageId=Layout.Page.container.find("div#quickImportNewUI"),uploadMainDiv=pageId.find("div#quickImportparent");if(uploadMainDiv.find("i#importIc").addClass("IC-imprt S22 MB8 DIB blu"),uploadMainDiv.find("i#importIc").removeClass("IC-docs imtIcn DIB blu"),uploadMainDiv.find("p#notes").removeClass("DN"),pageId.find("p#importloadedFileName,div#quickImportErrDiv").addClass("DN"),uploadMainDiv.find("span#btnTxt").text(ZPI18N.getString("zp.uploadfile")),pageId.find("button#uploadBtn").text(ZPI18N.getString("zp.import")).hide(),resultObj.hasOwnProperty("pwdPolicy")){pageId.find("#importUPwd").removeClass("DN"),$(".dvShwRectcon1").remove();var pwdDtls=User.constructPasswordPolicyElms(resultObj.pwdPolicy);uploadMainDiv.append('<div class="dvShwRectcon1 DN"><div class="P10 S12">'+pwdDtls+"</div></div>"),pageId.find("#importUPwd").popover({html:!0,content:function(){return $(".dvShwRectcon1").html()}})}pageId.modal(),User.updateLicenseCountDetails(resultObj)},User.quickImportPreview=function(file){var pageId=Layout.Page.container,uploadMainDiv=pageId.find("div#quickImportparent");$("button#uploadBtn").prop("disabled",!1),uploadMainDiv.find("i#importIc").removeClass("IC-imprt S22 MB8 DIB blu"),uploadMainDiv.find("i#importIc").addClass("IC-docs imtIcn DIB blu"),uploadMainDiv.find("p#notes").addClass("DN"),pageId.find("p#importloadedFileName").removeClass("DN"),uploadMainDiv.find("span#btnTxt").text(ZPI18N.getString("zp.removeandnew")),pageId.find("p#importloadedFileName").find("em").text($(file).val()),pageId.find("button#uploadBtn").text(ZPI18N.getString("zp.import")).show()},User.toggleAutoGenPassword=function(mode){var pageId=Layout.Page.container.find("div#quickImportNewUI");pageId.find('div#autoIUD input[type="checkbox"]').is(":checked")?(pageId.find("#toggForAutoGen").removeClass("zp_mdt"),User.isAutoGenPwd=!0):(pageId.find("#toggForAutoGen").addClass("zp_mdt"),User.isAutoGenPwd=!1)},User.quickImportFileSubmit=function(){var pageId=Layout.Page.container,inputFile=pageId.find("input#importFile").val(),location=(pageId.find("input#importFile")[0].files[0].size,pageId.find("select#importlocation").val()),domainName=pageId.find("select#importdomains").val();!ZPSetupCommon.isEmpty(inputFile)&&(CompanySettings.endsWith(inputFile,"xls")||CompanySettings.endsWith(inputFile,"xlsx")||CompanySettings.endsWith(inputFile,"csv"))?ZPSetupCommon.isEmpty(domainName)?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.selvalfordomain")):(pageId.find("input#domainName").val(domainName),pageId.find("input#autoGenPassword").val(User.isAutoGenPwd),null!=location&&void 0!=location&&pageId.find("input#LocID").val(location),pageId.find("form#quickImportForm").submit(),pageId.find("button#uploadBtn").prop("disabled",!0)):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.notSupportedFileFormat"))},User.quickImportResponse=function(result,zEmailIDs){var pageId=Layout.Page.container,tables=$("table#errorListTable");if(result.length>0&&result[0].hasOwnProperty("error"))pageId.find("button#uploadBtn").prop("disabled",!1),ZPeople.Message.showFailureMsg(result[0].error);else if(result.length>0)if(ZPSetupCommon.isEmpty(result[0].details))pageId.find("button#uploadBtn").prop("disabled",!1),ZPeople.Message.showFailureMsg(result[0]);else{var errorDivElm=pageId.find("div#quickImportErrDiv");tables.html(""),$.each(result,function(key,val){var rowNo=val["row no"],elms="<tr><td style='width: 35%;padding-left: 40px;padding-top: 18px;'>"+ZPI18N.getString("zp.rownoofquickimport")+rowNo+"</td><td>"+val.details.replace(/[[\]]/g,"")+"<td><tr>";tables.append(elms)}),pageId.find("button#uploadBtn").prop("disabled",!1),errorDivElm.removeClass("DN")}else User.ListUsers.getUserList(),pageId.find("div#quickImportNewUI").modal("hide"),tables.html(""),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.quickimportsucccess"));User.showZohoUsers(zEmailIDs)},User.showZohoUsers=function(zEmailIDs,invType){if(null!=zEmailIDs&&zEmailIDs.length>0){var zUserDispMsg=2==invType?"zp.invitedexistinguser":"zp.existingzohouser";ZPeople.confirm(null,"",zUserDispMsg,"",!0,!1),$("#textConfirmationPopupBody").addClass("dvExecutescript"),$("#textConfirmationPopupBody").append('<div class=dvinfo id="emailInfo">'),$.each(zEmailIDs,function(key,val){$("#emailInfo").append('<p class="text-left">'+val+"</p>")}),$("#textConfirmationPopupBody").append("</div>")}},User.ListUsers.bulkChangeLoginStatus=function(mode){var pageId=Layout.Page.container,erecNo=[],count=0;if(userTableElm=pageId.find("table#userListTable"),$.each(userTableElm.find("input[name='userRowCheck']:checked"),function(index,obj){erecNo[index]=$(obj).closest("tr").attr("emperecno"),count++}),count>0&&count<=50){if(erecNo.length>0){var params={erecNos:JSON.stringify(erecNo),method:"enable"==mode?"bulkEnableLoginStatus":"bulkDisableLoginStatus"};ZPeople.Request.send("/users/changeLoginStatus",params,User.AddUser.migrateUsersAction)}}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.bulkChangeLoginLimit"))},User.ListUsers.changeLoginStatus=function(eleToChange,mode){var parentTr=$(eleToChange).closest("tr"),erecNO=$(parentTr).attr("empErecNo");if("Non-user"===mode){var params={erecno:erecNO,method:"enableDowngradedNonUser"};ZPeople.Request.send("/users/enableDowngradedNonUser",params,User.handleResponseOfChangeLoginStatus,eleToChange)}else if("MakeNonUser"===mode)User.checkIfHasAdminPermission(erecNO,parentTr);else{params={erecno:erecNO,changeStatus:$(eleToChange).attr("changeStatus")};ZPeople.Request.send("users/UpgradeUsers",params,User.handleResponseOfChangeLoginStatus,eleToChange)}},User.checkIfHasAdminPermission=function(erec,parentTr){var params={erecno:erec},shwMsg="";ZPeople.Request.send("/users/canConvert",params,function(resltObj){if(resltObj.hasOwnProperty("isAllowedToConvert")&&!resltObj.isAllowedToConvert)shwMsg=ZPI18N.getString("zp.paymenterrnonusers",new Array(paymentUrl)),ZPeople.Message.showFailureMsg(shwMsg);else{shwMsg=resltObj.hasOwnProperty("hasAdminPermission")&&resltObj.hasAdminPermission?ZPI18N.getString("zp.nonuseradmperm"):ZPI18N.getString("zp.nonusernoadmperm"),ZPeople.confirm("","",shwMsg,null,!1,!0);var alertDiv=$("#confirmConfirmationPopup");$(alertDiv).off(),$(alertDiv).on("click",function(){User.proceedToUserConversion(erec,parentTr)})}})},User.proceedToUserConversion=function(erec,parentTr){var params={erecno:erec};ZPeople.Request.send("/users/userConvert",params,function(resltObj){resltObj.isConverted?(parentTr.remove(),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.usernonusersuccess")),User.variables.user.reload=!0,User.variables.employeeprofile.reload=!0,User.variables.employeeprofile.filterParams.userStatus=resltObj.filterStatus,window.location="#admin/employeerecords/employeeprofile"):resltObj.hasOwnProperty("code")||resltObj.hasOwnProperty("message")?ZPeople.Message.showFailureMsg(resltObj.message):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.usernonuserfail"))})},User.handleResponseOfChangeLoginStatus=function(data,obj,thisObj){var classNm,pageId=Layout.Page.container,tableObj=pageId.find("table#userListTable"),empStatus=pageId.find("table#userListTable").attr("status"),isChangeLoginStatus="enableDowngradedNonUser"!==obj.method,column=$(thisObj).closest("td");if(!ZPSetupCommon.isEmpty(data.SUCCESS)){if(isChangeLoginStatus)if("0"===obj.changeStatus)$(thisObj).attr("changeStatus","1"),column.find("label").attr("title",ZPI18N.getString("zp.enableLogin")),column.prev().text(ZPI18N.getString("zp.inactiveusers")),column.prevObject[0].checked=!1;else if(data.isInvitedUser){var statusIcon="";column.find("label.btnactive.MB0").remove(),column.prev().text(ZPI18N.getString("zp.invited")),Layout.isPeoplePlus?statusIcon="<a title='' class='ZPtitle' data-original-title='"+ZPI18N.getString("zp.resendinv")+"' onclick=User.ListUsers.resentInvitationForPeoplePlus('"+data.email+"')><span class='IC-mail2x btnmail'></span></a>":Layout.isZohoOne||(statusIcon="<a title='' class='ZPtitle' data-original-title='"+ZPI18N.getString("zp.resendinv")+"' onclick=User.ListUsers.resentInvitation('"+obj.erecNo+"')><span class='IC-mail2x btnmail'></span></a>"),column.find(".dvlist-action.MT4").prepend(statusIcon)}else $(thisObj).attr("changeStatus","0"),column.find("label").attr("title",ZPI18N.getString("zp.disableLogin")),column.prev().text(ZPI18N.getString("zp.orgusers")),column.prevObject[0].checked=!0;else classNm="IC-change-usr btnmail btnMigemp",$(thisObj).attr("data-original-title",ZPI18N.getString("zp.migraToEmp")),User.ListUsers.getUserList();isNaN(empStatus)?$(thisObj).find("i").attr("class",classNm):($(thisObj).closest("tr").remove(),0===tableObj.find("tbody tr").length?(tableObj.find("thead").addClass("DN"),tableObj.find("tbody").append(jQuery("<tr />",{id:"noRowsOfOrg"}).append(jQuery("<td />",{class:"text-center",colspan:"7",text:ZPI18N.getString("zp.norecfound")})))):tableObj.find("thead").removeClass("DN")),ZPeople.Message.showSuccessMsg(data.SUCCESS)}ZPSetupCommon.isEmpty(data.SUCCESS)&&(isChangeLoginStatus&&(column.prevObject[0].checked="0"===obj.changeStatus),ZPeople.Message.showFailureMsg(data.ERROR))},User.ListUsers.createPopUp=function(thisObj){ZPeople.confirm($(thisObj).closest("tr"),"","zp.userconfirmmsg",User.ListUsers.deleteUser)},User.ListUsers.deleteUser=function(obj){var formId=$(obj).closest("table#userListTable").attr("formId"),pageId=Layout.Page.container,erecno=$(obj).attr("emperecno"),params={formID:formId,viewLinkName:"",deletegroup:erecno,method:"deleteRecordAction",conreqcsr:csrfToken};$.post("/deleteRecordAction.zp",params,function(data){var errorObj=void 0;if(data.hasOwnProperty("errObj")&&(errorObj=data.errObj),void 0!=errorObj&&0!=errorObj.length&&errorObj[0].hasOwnProperty("error"))ZPeople.Message.showFailureMsg(errorObj[0].error);else{pageId.find("table#userListTable").find("tr[empErecNo='"+erecno+"']").closest("tr").remove();parseInt(pageId.data("totalUsersCount"));User.isAllowToAddUser=data.isAllowtoAddEmployee;var msgKey="user"==Layout.Page.currentmode.split("/")[2]?"zp.userDeleted":"zp.nonUserDeleted";ZPeople.Message.showSuccessMsg(ZPI18N.getString(msgKey))}})},User.ListUsers.resentInvitation=function(erecNot,resendReject){var params={};params.erecno=erecNot,resendReject&&(params.resendReject=!0),ZPeople.Request.send("ResendInvitation.do",params,User.resendResponse,!1)},User.ListUsers.resentInvitationForPeoplePlus=function(mailAlias){ZPeople.Request.send("/pplus/resendInvitation",{action:"resendInvitation",mailAlias:mailAlias},User.resendResponse)},User.resendResponse=function(data,paramsObj,isBulkResend){var pageId=Layout.Page.container;if(ZPSetupCommon.isEmpty(data.failedRecords)){if("Unconfirmed"==data||"UnConfirmed"==data.result)return void ZPeople.showErrorMessageForUnconfirmedAcc();if(!isBulkResend){var errMsg=User.getResendErrMsg(data);return void(null!=errMsg?ZPeople.Message.showFailureMsg(errMsg):"Rejected"===data?ZPeople.confirm(null,"","zp.invrejConf",()=>{User.ListUsers.resentInvitation(paramsObj.erecno,!0)}):(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.invitationsent")),pageId.find("table#userListTable tr input[name='userRowCheck']").prop("checked",!1),pageId.find("div#usersOptions").addClass("DN"),pageId.find("div#massUpdate,div#resendInvite").hide(),pageId.find("div#dispUserCntTitle,div#licenseDtlsRow").removeClass("DN")))}if(data.errorRecords&&data.errorRecords.length>0)return void User.bulkResendResponse(data,paramsObj);"success"===data.result?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.invitationsent")),pageId.find("table#userListTable tr input[name='userRowCheck']").prop("checked",!1),pageId.find("div#usersOptions").addClass("DN"),pageId.find("div#massUpdate,div#resendInvite").hide(),pageId.find("div#dispUserCntTitle,div#licenseDtlsRow").removeClass("DN")):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.invfailed"))}else $.each(data.failedRecords,function(index,erecNo){pageId.find("table#userListTable tbody tr[empErecNo='"+erecNo+"'] input[name='userRowCheck']").prop("checked",!0),ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.failedinvforselectedrec"))})},User.bulkResendResponse=function(data,params){var pageId=Layout.Page.container;data.errorRecords&&(pageId.find("div#bulkResendResponse").modal(),pageId.find("#bulkResendResponseBody").show(),pageId.find("#bulkResendResponseBody").find("#bulkResendError").empty(),$.each(data.errorRecords,function(key,error){var msg=User.getResendErrMsg(error.code);msg=null!=msg?msg:ZPI18N.getString("zp.invcase3",[ZPeople.peopleSupportEmail]),pageId.find("#bulkResendResponseBody").find("#bulkResendError").append('<tr class="ZPLRow"><td>'+error.email+"</td><td>"+msg+"</td></tr>")}),User.ListUsers.getUserList(),Layout.Page.pageId.includes("user")?User.variables.employeeprofile.reload=!0:User.variables.user.reload=!0)},User.getResendErrMsg=function(errorCode){var message=null;return"Failure"===errorCode?message=ZPI18N.getString("zp.invfailed"):"201"==errorCode?message=ZPI18N.getString("zp.invcase1",[ZPeople.peopleSupportEmail]):"202"==errorCode?message=ZPI18N.getString("zp.invcase2",[ZPeople.peopleSupportEmail]):"299"==errorCode&&(message=ZPI18N.getString("zp.invcase3",[ZPeople.peopleSupportEmail])),message},User.AddUser.openDummyEmployeePage=function(obj){var pageId=Layout.Page.container;pageId.find("div#addEmp").find("h6#exampleModalLabel").text(ZPI18N.getString("zp.addinviteusers")),pageId.find("input#employeeId").val($(obj).closest("tr").data("employeeId")),pageId.find("input#disabledEmailId").val($(obj).closest("tr").data("empMailAlias")),pageId.find("input#fname").val($(obj).closest("tr").data("empFname")),pageId.find("input#lname").val($(obj).closest("tr").data("empLname")),pageId.find("div#addEmp").modal()},User.AddUser.handleRedirection=function(){return!ZPeople.UnifiedUI.isUnifiedUI()||(CrmPlusImpl.triggerAddUser(),!1)},User.AddUser.validateAccDtls=function(){var pageId=Layout.Page.container,emailId=pageId.find("input#emailEditBox").val(),passwd=pageId.find("input#pswd").val(),error=!1;if($("div.dverrormsg").remove(),$("div.modal-body").find("div").removeClass("has-error"),ZPSetupCommon.isEmpty(emailId)||!CompanySettings.isValidEmail(emailId+pageId.find("a#mailspecialChar").text()+$("select#domainName").val())){error=!0;var errorKeptObj=pageId.find("div#emailIdErrParent");ZPSetupCommon.showErr(ZPI18N.getString("zp.entermailid"),errorKeptObj,"dverrormsg"),pageId.find("input#emailEditBox").parent().addClass("has-error")}if(User.toggleAGPforAddDir)return error;if(ZPSetupCommon.isEmpty(passwd)){error=!0;errorKeptObj=pageId.find("div#passwordParentElm");ZPSetupCommon.showErr(ZPI18N.getString("zp.entervalforfield",[ZPI18N.getString("zp.passwd")]),errorKeptObj,"dverrormsg"),pageId.find("div#passwordParentElm").addClass("has-error")}if(!ZPSetupCommon.isEmpty(passwd)&&passwd.length<8){error=!0;errorKeptObj=pageId.find("div#passwordParentElm");ZPSetupCommon.showErr(ZPI18N.getString("zp.passwordlengshort"),errorKeptObj,"dverrormsg"),pageId.find("div#passwordParentElm").addClass("has-error")}if(User.validatePwdPolicy(passwd)){error=!0;errorKeptObj=pageId.find("div#passwordParentElm");ZPSetupCommon.showErr(ZPI18N.getString("zp.passwordpolicy"),errorKeptObj,"dverrormsg"),pageId.find("div#passwordParentElm").addClass("has-error"),pageId.find("#singleUPwd").mouseover(),setTimeout(function(){pageId.find("#singleUPwd").popover("hide")},3e3)}return error},User.iterateDomains=function(domainList,obj){var domainsOptions="";$.each(domainList,function(index,domain){domainsOptions+="<option value='"+domain.ORG_DOMAIN+"'>"+domain.ORG_DOMAIN+"</option>"}),$(obj).html(domainsOptions),$(obj).select2()},User.iterateLoc=function(locList,obj){var locOptions="";$.each(locList,function(index,location){var key=Object.keys(location)[0];locOptions+="<option value='"+key+"'>"+location[key]+"</option>"}),$(obj).html(locOptions),$(obj).select2()},User.userListScrollEvent=function(event,dataCnt){var currPage=Layout.Page.currentmode.split("/")[2],pageId=Layout.Page.container,sortType=pageId.find(),usersLength=pageId.data("userCnt");if(User.endOfPage=ZPCommon.isScrollEnd(),User.endOfPage){var totalUsersCnt=parseInt(pageId.data("totalUsersCount"));if("user"===currPage||"employeeprofile"===currPage){if(usersLength>=User.maxRangeOfgetData){sortType=pageId.find("table#userListTable").attr("sortbytype");User.ListUsers.getUserList(totalUsersCnt+1,sortType,event),User.endOfpage=!1}}else if(Organization.dataCount>=User.maxRangeOfgetData){var url,parameters={};"departments"===currPage?(parameters.startInd=Organization.startIndex+1,parameters.method="getDepartmentsDetails",url="/getDepartmentsList.zp"):"designationdetails"===currPage?"designations"===Layout.Page.currentmode.split("/")[3]?(parameters.startInd=Organization.startIndex+1,parameters.method="getDesignationsDetails",url="/getDesignationsList.zp"):"streams"===Layout.Page.currentmode.split("/")[3]&&(parameters.stIndex=Organization.startIndex+1,parameters.method="getStreamsDetails",url="/getStreamsList.zp"):(parameters.startInd=Organization.startIndex+1,parameters.method="getLocationsDetails",url="/getLocationsList.zp"),User.isScrollEventFired||(User.isScrollEventFired=!0,ZPeople.Request.send(url,parameters,User.handleScrollEventResponse,null,User.failureScrollEventResponse)),User.endOfpage=!1}}},User.failureScrollEventResponse=function(data,params){User.isScrollEventFired=!1},User.isScrollEnd=function(){var scrollContent=Layout.Page.container.find("div#scrollContent");return scrollContent.prop("scrollTop")>0&&scrollContent.prop("scrollTop")+scrollContent.innerHeight()+1>=scrollContent.prop("scrollHeight")},User.handleScrollEventResponse=function(data,mode){var IterateObj,linkNm,noRecFoundMsg,pageContent=Layout.Page.container;User.isScrollEventFired=!1;var currMode=Layout.Page.currentmode.split("/")[2];"locations"===currMode?(Organization.dataCount=Object.keys(data.locationDtls).length,IterateObj=data.locationDtls,linkNm="P_Location",ZPI18N.getString("zp.addlocation"),noRecFoundMsg=ZPI18N.getString("zp.nolocations")):"designationdetails"===currMode?(currMode=Layout.Page.currentmode.split("/")[3],Organization.dataCount="designations"===currMode?Object.keys(data.desgDtls).length:Object.keys(data.streamDtls).length,IterateObj="designations"===currMode?data.desgDtls:data.streamDtls,linkNm="designations"===currMode?"P_Designation":"P_Streams","designations"===currMode?ZPI18N.getString("zp.adddesg"):ZPI18N.getString("zp.addstream"),noRecFoundMsg="designations"===currMode?ZPI18N.getString("zp.nodesignations"):ZPI18N.getString("zp.nostreams")):"departments"===currMode&&(Organization.dataCount=Object.keys(data.deptDtls).length,IterateObj=data.deptDtls,linkNm="P_Department",ZPI18N.getString("zp.manageadddept"),noRecFoundMsg=ZPI18N.getString("zp.nodept")),Organization.startIndex=Organization.startIndex+IterateObj.length;var parent=$(pageContent).find("div#dvListview").find("table tbody"),gridViewObj="",listViewObj="";if($.each(IterateObj,function(index,object){"locations"===currMode?(gridViewObj+=Organization.ManageOrgs.ItearteLocationDtlsGridView(object,data.formId,pageContent.find("div#dvGridview"),data.membersCountJson),listViewObj+=Organization.ManageOrgs.iterateLocationDtlsListView(object,data)):("streams"!==currMode&&(gridViewObj+=Organization.ManageOrgs.constructDeptDesigContent(object,pageContent.find("div#dvGridview"),data)),listViewObj+=Organization.ManageOrgs.iterateDeptDesgDtlsListView(object,data.formId,linkNm))}),pageContent.find("div#dvGridview").append(gridViewObj),pageContent.find("div#dvListview table tbody").append(listViewObj),Organization.startIndex>=User.maxRangeOfgetData&&($(parent).find("tr#noRowsOfOrg").remove(),$(parent).append(jQuery("<tr />",{id:"noRowsOfOrg"}).append(jQuery("<td />",{class:"text-center",colspan:"7",text:noRecFoundMsg})))),pageContent.find("a#sort_menu").removeClass("disabled"),pageContent.find("table#listOf"+currMode).find("thead").removeClass("DN"),pageContent.find(".dvhelpover,[data-toggle=popover]").popover(),0===Object.keys(IterateObj).length&&0===Organization.startIndex){$(parent).find("tr#noRowsOfOrg").remove(),pageContent.find("a#sort_menu").addClass("disabled"),pageContent.find("table#listOf_"+currMode).find("thead").addClass("DN");var emptyMsg=ZPI18N.getString("zp.norecfound"),modeCheck=Layout.Page.currentmode.split("/")[2];"departments"==modeCheck||"designationdetails"==modeCheck||"locations"==modeCheck?pageContent.find("div.ZPTscrlcont").html(Organization.ManageOrgs.constructEmptyIcon()):pageContent.find("div.ZPTscrlcont").find("div#dvGridview").html(Organization.ManageOrgs.constructEmptyIcon()),$(parent).append(jQuery("<tr />",{id:"noRowsOfOrg"}).append(jQuery("<td />",{class:"text-center",colspan:"7",text:emptyMsg})))}pageContent.find("div#addDeptLink").remove()},User.constructUserListRows=function(data,event){var noUserMsg,pageId=Layout.Page.container,pgHash=Layout.Page.hash,dataObj=data.usersDtls,usersListRowObj="",usersStatus=data.userStatus,needToDispDateOfExit=!1;return"0"!==usersStatus&&"-3"!==usersStatus||(needToDispDateOfExit=!0),0!==dataObj.length&&$.each(data.usersDtls,function(key,userDtls){var usersListRow="",zuId=userDtls.ZUID?userDtls.ZUID:"",isZohoOne=data.isZohoOne,isPeoplePlus=data.isPeoplePlus,loginStatus=userDtls.LOGINSTATUS,mailAlias=ZPSetupCommon.isEmpty(userDtls.EMPLOYEEMAILALIAS)?"":userDtls.EMPLOYEEMAILALIAS,dateOfExit=userDtls.DATEOFEXIT,dataOfJoining=userDtls.DATEOFJOINING,erecNo=userDtls.ERECNO;usersListRow+="<tr empErecNo='"+erecNo+"' status='"+loginStatus+"' zuid='"+zuId+"'>",usersListRow+="<td class='text-right'><div class='checkbox checkbox-primary ML8'><input type='checkbox' onchange='User.AddUser.switchResendMassupdate(this)' name='userRowCheck' loginstatus='"+loginStatus+"'><label></label></div></td>",usersListRow+="<td><div class='PR FL usrsts'><img width='40' height='40' alt='' class='img-circle FL' src='"+userDtls.EMPLOYEEPHOTO+"'><span class='NO_CLASS'></span></div><div class='FL ML15 lndvname'><a class='lnk ZPbold' onclick=User.getRecordPage('"+data.formId+"','"+erecNo+"','VIEW')>"+userDtls.EMPLOYEENAME+", "+userDtls.EMPLOYEEID+"</a><div class='lblmail'>"+mailAlias+"</div></div></td>",usersListRow+="<td>",ZPSetupCommon.isEmpty(dataOfJoining)||(usersListRow+=dataOfJoining),usersListRow+="</td>",needToDispDateOfExit&&(usersListRow+="<td>",ZPSetupCommon.isEmpty(dateOfExit)||(usersListRow+=dateOfExit),usersListRow+="</td>");var locName=ZPSetupCommon.isEmpty(userDtls.LOCATION)?"":userDtls.LOCATION;usersListRow+="<td>"+(ZPSetupCommon.isEmpty(userDtls.ROLENAME)?"":userDtls.ROLENAME)+"</td>",usersListRow+="<td>"+locName+"</td>",usersListRow+="<td>"+(ZPSetupCommon.isEmpty(userDtls.EMPLOYEESTATUS)?"":userDtls.EMPLOYEESTATUS)+"</td>",data.empType!=User.NonUserType&&(usersListRow+="<td>"+("0"==loginStatus?ZPI18N.getString("zp.inactiveusers"):"1"==loginStatus?ZPI18N.getString("zp.orgusers"):"2"==loginStatus?ZPI18N.getString("zp.pendingusers"):"-1"==loginStatus?ZPI18N.getString("zp.downgraded"):"")+"</td>");var statusIcon="",deleteIc="";if(data.superAdminErecNo!==erecNo){if("1"===loginStatus&&User.myCurrErec!=erecNo)statusIcon='<label class="btnactive MB0" title="'+ZPI18N.getString("zp.disableLogin")+'"><input class="cmn-toggle-small cmn-toggle-round-small" type="checkbox" checked="checked" changeStatus="0" onchange="User.ListUsers.changeLoginStatus(this)"><span class="M0"></span></label>';else if(isPeoplePlus&&"2"===loginStatus)statusIcon="<a title='' class='ZPtitle' data-original-title='"+ZPI18N.getString("zp.resendinv")+"' onclick=User.ListUsers.resentInvitationForPeoplePlus('"+mailAlias+"')><span class='IC-mail2x btnmail'></span></a>";else if(isZohoOne||"2"!==loginStatus)if("0"===loginStatus||"-1"===loginStatus)statusIcon='<label class="btnactive MB0" title="'+ZPI18N.getString("zp.enableLogin")+'"><input class="cmn-toggle-small cmn-toggle-round-small" type="checkbox" changeStatus="1" onchange="User.ListUsers.changeLoginStatus(this)"><span class="M0"></span></label>';else if("-3"===loginStatus){statusIcon="<a title='' class='ZPtitle' data-original-title='"+ZPI18N.getString("zp.enableNonUser")+"' changeStatus='1' onclick=User.ListUsers.changeLoginStatus(this,'Non-user')><i class='IC-user btnmail'></i></a>"}else"-2"!==loginStatus&&"-6"!==loginStatus||(statusIcon="<a title='' class='ZPtitle' data-original-title='"+ZPI18N.getString("zp.migraToEmp")+"' onclick='User.AddUser.nonUserPopUp(this,undefined,undefined,\"migrateToEmp\")' status='Non-user'><span class='IC-change-usr btnmail btnMigemp'></span></a>");else statusIcon="<a title='' class='ZPtitle' data-original-title='"+ZPI18N.getString("zp.resendinv")+"' onclick=User.ListUsers.resentInvitation('"+erecNo+"')><span class='IC-mail2x btnmail'></span></a>";User.myCurrErec!=erecNo&&(deleteIc="<a title='' class='ML15 ZPtitle' data-original-title='"+ZPI18N.getString("zp.icoDelete")+"'><span class='IC-delete' onclick='User.ListUsers.createPopUp(this)'></span></a>")}var migToEmpClass=isZohoOne&&"2"===loginStatus?"":"ML10";usersListRow+="<td><div class='dvlist-action MT4'> "+statusIcon,data.superAdminErecNo!==erecNo&&pgHash.indexOf("admin/employeerecords/user")>-1&&User.myCurrErec!=erecNo&&(usersListRow+="<a title='' class='ZPtitle "+migToEmpClass+"' data-original-title='"+ZPI18N.getString("zp.convertcandtoempprofile")+"' changestatus='0' onclick='User.ListUsers.changeLoginStatus(this,\"MakeNonUser\")'><i class='IC-change-nonusr btnmail btnMigemp'></i></a>"),usersListRow+="<a title='' class='ML15 ZPtitle' data-original-title='"+ZPI18N.getString("zp.icoEdit")+"' onclick=User.getRecordPage('"+data.formId+"','"+erecNo+"','EDIT')><span class='IC-pen'></span></a>"+deleteIc+"</div>",usersListRowObj+=usersListRow+="</td></tr>"}),"scroll"===event?noUserMsg=ZPI18N.getString("zp.nomoreusersfound"):0===dataObj.length?(User.disperr="disperror",pageId.find("table#userListTable thead").addClass("DN"),noUserMsg=ZPI18N.getString("zp.norecfound")):(pageId.find("table#userListTable thead").removeClass("DN"),User.disperr=" "),ZPSetupCommon.isEmpty(noUserMsg)||(usersListRowObj+="<tr id='emptyRow'><td class='text-center' colspan='8'>"+noUserMsg+"</td></tr>"),usersListRowObj},User.notifyCallbackWhenAddOrEdit=function(){Organization.refreshStats=!0},User.notifyCallback=function(){if(void 0!=ZPForm.Record.PARAMS){var params=ZPForm.Record.PARAMS[Object.keys(ZPForm.Record.PARAMS)[0]];if(params.hasOwnProperty("Employeestatus")&&("All Status"!=Layout.Page.container.find("#empStatusDtls").val()&&(User.variables[User.currMode].filterParams.searchByEmpStatus="user"==User.currMode?params.Employeestatus:"All Status"),"All Status"!=Layout.Page.container.find("#accStatusDtls").val())){var sysval,formComponentDetails=ZPForm.FORM_COMPONENT_DATA[ZPForm.CURRFORM_PARAM.formId].message.formComponentDetails;for(var i in formComponentDetails)for(var j=0;j<2;j++){var column=0==j?formComponentDetails[i].column1:formComponentDetails[i].column2;for(var k in column){var formComponent=column[k];if("Employeestatus"==formComponent.labelName){var optionsWithId=formComponent.OptionsWithId;for(var l in optionsWithId)if(optionsWithId[l].Value==ZPForm.Record.PARAMS[Object.keys(ZPForm.Record.PARAMS)[0]].Employeestatus){sysval=optionsWithId[l].SysValue;break}}}}User.variables[User.currMode].filterParams.userStatus=User.statusBasedOnSysVal(sysval)}params.hasOwnProperty("LocationName")&&"0"!=Layout.Page.container.find("#locationsDtls").val()&&(User.variables[User.currMode].filterParams.searchByLoc=params.LocationName),params.hasOwnProperty("Role")&&"0"!=Layout.Page.container.find("#rolesDtls").val()&&(User.variables[User.currMode].filterParams.searchByRole=params.Role),params.hasOwnProperty("Department")&&"0"!=Layout.Page.container.find("#deptDtls").val()&&(User.variables[User.currMode].filterParams.searchByDept=params.Department),User.variables[User.currMode].reload=!0}},User.statusBasedOnSysVal=function(sysval){return User.currMode=Layout.Page.currentmode.split("/")[2],"user"==User.currMode?1==sysval||-1==sysval?"1":3==sysval?"2":4==sysval?"-1":"0":1==sysval||-1==sysval?"-2":"-33"},User.getRecordPage=function(formId,recId,formMode){Layout.Page.container;var currPage=Layout.Page.currentmode.split("/")[2],modalCloseCallback="",notifycallback="";void 0==formMode&&(formMode="EDIT"),User.currentErecNo=null!=recId?recId:User.currentErecNo,"departments"===currPage?(modalCloseCallback=Organization.forModalCloseCallback,notifycallback=User.notifyCallbackWhenAddOrEdit):"designationdetails"===currPage?(currPage=Layout.Page.currentmode.split("/")[3],modalCloseCallback=Organization.forModalCloseCallback,notifycallback=User.notifyCallbackWhenAddOrEdit):"locations"===currPage?(modalCloseCallback=Organization.forModalCloseCallback,notifycallback=User.notifyCallbackWhenAddOrEdit):"user"!==currPage&&"employeeprofile"!==currPage||(modalCloseCallback=User.ListUsers.usersListPageInit,notifycallback=User.notifyCallback);var paramsObj={formId:formId,recordId:User.currentErecNo,disableUrlTrack:!0,formMode:formMode,modalCloseCallback:modalCloseCallback,notifycallback:notifycallback};"streams"==currPage&&(paramsObj.isRefreshNeeded=!0),paramsObj.editCallback=User.getRecordPage,ZPForm.load(paramsObj)},User.AddUser.getAddUserListPage=function(type,needToGetImportOptns,needToGetImportPopUp,fetchFormComp){var pageId=Layout.Page.container,curPage=Layout.Page.currentmode.split("/")[2];if("employeeprofile"!==curPage||"convertAddDirectUser"!==type||1!=Layout.Page.container.find("#selectBulkActiontoUsers").find(".dropdown-toggle").hasClass("disabled")){"#admin/dashboard"!==Layout.Page.hash&&"#admin/gettingStarted"!==Layout.Page.hash&&"#onboarding/reports/employee"!==Layout.Page.hash||(curPage="user");var paramsObj={mode:curPage};(ZPSetupCommon.isEmpty(type)||"invite"===type)&&(paramsObj.needAllDtls=!0,"invite"===type||!ZPSetupCommon.isEmpty(needToGetImportPopUp)&&!needToGetImportPopUp?(paramsObj.isInviteuser="true",User.isInviteMode="user"===curPage):(User.isInviteMode=!1,User.isMobile=!1)),void 0!=fetchFormComp&&(paramsObj.fetchFormComp=!0);var optnLen=pageId.find("ul#addEmpMenu").find("li").length,importOptnLen=pageId.find("ul#importOptns").find("li").length;("switchToAddDirectUser"===type&&"user"===curPage&&!pageId.find("div#addOptnbtn").hasClass("open")&&optnLen<4&&!needToGetImportOptns||needToGetImportOptns&&importOptnLen<2||"switchToAddDirectUser"!==type)&&ZPeople.Request.send("/users/getAddUserPage",paramsObj,User.AddUser.openAddUserPopUp,{type:type,needToGetImportOptns:needToGetImportOptns,needToGetImportPopUp:needToGetImportPopUp})}},User.AddUser.openAddUserPopUp=function(data,params,otherDtls){var pageId=Layout.Page.container,currPage=Layout.Page.currentmode.split("/")[2];data.hasOwnProperty("isLastNameMand")&&(User.isLastNameMand=data.isLastNameMand),void 0!=data.selectedComponent&&(void 0!=data.selectedComponent.EMPLOYEEID&&(User.empidLength=data.selectedComponent.EMPLOYEEID.maxLength,User.empidDispName=ZSEC.Encoder.encodeForHTML(data.selectedComponent.EMPLOYEEID.dispName)),void 0!=data.selectedComponent.EMPLOYEEFIRSTNAME&&(User.fnameLength=data.selectedComponent.EMPLOYEEFIRSTNAME.maxLength,User.fnameUnique=data.selectedComponent.EMPLOYEEFIRSTNAME.isUnique,User.fnameDispName=ZSEC.Encoder.encodeForHTML(data.selectedComponent.EMPLOYEEFIRSTNAME.dispName)),void 0!=data.selectedComponent.EMPLOYEELASTNAME&&(User.lnameLength=data.selectedComponent.EMPLOYEELASTNAME.maxLength,User.lnameUnique=data.selectedComponent.EMPLOYEELASTNAME.isUnique,User.lnameDispName=ZSEC.Encoder.encodeForHTML(data.selectedComponent.EMPLOYEELASTNAME.dispName)),void 0!=data.selectedComponent.EMPLOYEEMAILALIAS&&(User.mailLength=data.selectedComponent.EMPLOYEEMAILALIAS.maxLength,User.mailDispName=ZSEC.Encoder.encodeForHTML(data.selectedComponent.EMPLOYEEMAILALIAS.dispName)),void 0!=data.selectedComponent.LOCATION&&(User.locationDispName=ZSEC.Encoder.encodeForHTML(data.selectedComponent.LOCATION.dispName),User.locationLength=data.selectedComponent.LOCATION.maxLength)),pageId.find("div#addEmp").length<=0&&pageId.append(User.usersPageElm);var idForDispNameChange=pageId.find("div#formAddEmp");idForDispNameChange.find("div#empIdErr").find("label").html("<font>"+User.empidDispName+"</font>"),idForDispNameChange.find("div#firstNameParentElm").find("label").html("<font>"+User.fnameDispName+"</font>"),idForDispNameChange.find("div#lastNameParentElm").find("label").html("<font>"+User.lnameDispName+"</font>"),idForDispNameChange.find("div#emailIdParentElm").find("label").html("<font>"+User.mailDispName+"</font>"),idForDispNameChange.find("div#locationParentElm").find("label").html("<font>"+User.locationDispName+"</font>"),idForDispNameChange.find("div#lastEMpId").html(ZPI18N.getString("zp.last")+"&nbsp;"+User.empidDispName+"&nbsp;<span></span>");var addUserSlider=pageId.find("div#addEmp");2==pageId.find(addUserSlider).length&&pageId.find(addUserSlider).first().remove(),pageId.find("#previewEmailId").text(""),"#admin/dashboard"!==Layout.Page.hash&&"#onboarding/reports/employee"!==Layout.Page.hash||(currPage="user");var pageSts=data.pageStatus,addType=otherDtls.type;if(addUserSlider.find("[id=onboardParentElm]").hide(),"switchToAddDirectUser"===addType)User.switchAddDirectUser(pageSts,otherDtls.needToGetImportOptns);else if("convertAddDirectUser"===addType)User.switchAddDirectUser(pageSts,otherDtls.needToGetImportOptns);else{var goForInvite=!1;if(!data.isOrgAdmin&&"user"===currPage){if(!(Layout.Page.currentmode.indexOf("admin/dashboard")>-1))return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.notOrgAdmin"));goForInvite=!0}if(data.isOrgAdmin&&1!=pageSts&&(goForInvite=!0),"employeeprofile"!=User.currMode&&User.allowToAddUserDirectly&&data.ALLOW_MOBILEUSER_ADDITION){if(pageId.find("#emailIdParentElm").find("label").html("<font>"+ZPI18N.getString("zp.emailormob")+"</font>"),0==pageId.find("#mobDialCode").length){pageId.find("#mobMail").prepend('<select class="DN" id="mobDialCode"></select>'),pageId.find("#mobDialCode").appendDialCode()}pageId.find("#mobMail").removeClass("zprt-labelNum"),pageId.find("#mobMail > select").addClass("DN"),pageId.find("#mobMail > div").addClass("DN")}if(data.isAllowToAddEmployee){pageId.find("#employeeId,#fname,#lname,#disabledEmailId,#emailEditBox,#pswd").val(""),addUserSlider.find("#onboardChkbox").prop("checked",!1),addUserSlider.find("div").removeClass("has-error"),pageId.find("div.dverrormsg").remove(),pageId.find("p#inviteUsernotes").addClass("DN");var titleMsg,title=pageId.find("div#addEmp").find("h6#exampleModalLabel"),needToShowImportPopUp=!ZPSetupCommon.isEmpty(otherDtls.needToGetImportPopUp),addemp_btn=pageId.find("div[name='employees_addedbtn']:visible");if(data.isPeopleplus&&data.isMismatchInLicenseLeftInPP?(pageId.find("div[name=employees_addedbtn]").attr("class","btn-group PL30"),pageId.find("span[name=import_total_license]:visible").text(data.totalLicenseCount),pageId.find("span#license_alert").attr("data-content",ZPI18N.getString("zp.alertLicenseInfo",new Array(data.otherappLicense,data.adminPanelAppsPageUrl))),pageId.find("span#license_alert").popover({html:!0}).on("focus",function(){$(this).popover("show")}).on("focusout",function(){var _this=this;$(".popover:hover").length?$(".popover").mouseleave(function(){$(_this).popover("hide"),$(this).off("mouseleave")}):$(this).popover("hide")})):(pageId.find("div#import_total_licensebtn").hide(),pageId.find("span#license_alert").hide()),needToShowImportPopUp)return void User.showImportUsersPopUp(otherDtls.needToGetImportPopUp,data);if("user"===currPage)if(pageSts===User.allowToAddUserDirectly&&ZPSetupCommon.isEmpty(addType)&&!goForInvite){if(titleMsg=ZPI18N.getString("zp.addusers"),pageId.find("div#addUserSubTabs").removeClass("hide"),pageId.find("li#formAddEmpPopUp").removeClass("active"),pageId.find("li#formAddNonPopUp").addClass("active"),pageId.find("div#formAddNon").addClass("active in"),pageId.find("div#formAddEmp").removeClass("active in"),pageId.find("input#disabledEmailId").prop("disabled",!1),data.hasOwnProperty("pwdPolicy")){pageId.find("#singleUPwd").removeClass("DN"),pageId.find(".dvShwRectcon1").remove(),User.pwdPol=data.pwdPolicy;var pwdDtls=User.constructPasswordPolicyElms(data.pwdPolicy);addUserSlider.append('<div class="dvShwRectcon1 DN"><div class="S12">'+pwdDtls+"</div></div>"),User.getPopover(pageId.find("#singleUPwd"))}$(pageId.find("select#domainName").find("option").get(0)).prop("selected",!0),pageId.find("a#nextStep").attr("onclick","User.AddUser.nextStep()"),pageId.find("select#domainName").remove(),pageId.find("div#domaingrp").html('<select class="hideSearch" id="domainName"></select>');var addDirectUserDomainObj=pageId.find("select#domainName");User.iterateDomains(data.userDomains,addDirectUserDomainObj),pageId.find("a#nextStep").text(ZPI18N.getString("zp.next")),pageId.find("#formAddNonPopUp").on("click",function(){pageId.find("ul#dvAddEmp li:last").removeClass("active"),pageId.find("ul#dvAddEmp li:first").addClass("active"),pageId.find("div#formAddNon").addClass("active in"),pageId.find("div#formAddEmp").removeClass("active in"),pageId.find("a#nextStep").attr("onclick","User.AddUser.nextStep()"),pageId.find("a#nextStep").text(ZPI18N.getString("zp.next"))}),addDirectUserDomainObj.on("change",function(){User.showPreview()}),User.iterateDomains(data.userDomains),User.isLastNameMand?(pageId.find("div#lastNameParentElm").attr("isMandatory","true"),pageId.find("div#lastNameParentElm").find("label").addClass("zp_mdt")):(pageId.find("div#lastNameParentElm").attr("isMandatory","false"),pageId.find("div#lastNameParentElm").find("label").removeClass("zp_mdt")),addUserSlider.modal()}else pageSts===User.intermediateDomain&&ZPSetupCommon.isEmpty(addType)&&"#admin/dashboard"!==Layout.Page.hash?(titleMsg=ZPI18N.getString("zp.addinviteusers"),data.hasOwnProperty("userDomains")&&data.userDomains.length>=0?(addUserSlider.modal(),User.AddUser.nonUserPopUp()):ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.domainisnotavail"))):(titleMsg=ZPI18N.getString("zp.addinviteusers"),addUserSlider.modal(),pageId.find("p#inviteUsernotes").text(ZPI18N.getString("zp.inviteusernotes")).removeClass("DN"),User.AddUser.nonUserPopUp());else titleMsg=ZPI18N.getString("zp.addnonusers"),pageId.find("p#inviteUsernotes").text(ZPI18N.getString("zp.addnonusernotes")).removeClass("DN"),addUserSlider.modal(),User.AddUser.nonUserPopUp();if(!ZPSetupCommon.isEmpty(data.modAdminLocDetails)){var locselect=addUserSlider.find("div#locationParentElm");pageId.find(locselect).attr("style","display:block"),$(pageId.find("select#locName").find("option").get(0)).prop("selected",!0),pageId.find("select#locName").remove(),pageId.find("div#locationgrp").html('<select class="hideSearch" id="locName"></select>');var addLocObj=pageId.find("select#locName");User.iterateLoc(data.modAdminLocDetails,addLocObj)}title.text(titleMsg),pageId.find("div#lastEMpId").show(),removeTextNode(addemp_btn),addemp_btn.prepend(document.createTextNode(data.addUsersKey)),removeTextNode(pageId.find("div#addEmp").find("div#employees_addebtntxt")),pageId.find("div#addEmp").find("div#employees_addebtntxt").prepend(document.createTextNode(data.addUsersKey)),"user"===currPage?addUserSlider.find("span#total_license").text(data.totalLicenseCount):addUserSlider.find("div#total_licensebtn").hide(),addUserSlider.find("span#employees_added").text(data.employeesAdded),addUserSlider.find("span#licensecnt_left").text(data.licenseCountLeft),pageId.find("div#lastEMpId span").html(data.lastEmployeeId),void 0!=data.isOnboarding&&data.isOnboarding&&addUserSlider.find("#onboardParentElm").show()}else if(Subscription.restrictWidgetPlan.includes(ZPeople.PLANID)||"false"!=ZPeople.ISTRIALUSER){parmentErrMsg="user"===currPage?ZPI18N.getString("zp.paymenterr",new Array(paymentUrl)):ZPI18N.getString("zp.employeeprofilepaymenterr",new Array(paymentUrl));ZPeople.Message.showFailureMsg(parmentErrMsg)}else if(data.offlinePaymentMode)if("user"===currPage)Subscription.showOfflineWidget(Subscription.userWidget);else if("employeeprofile"==currPage&&Subscription.user_plan.includes(ZPeople.PLANID))Subscription.showOfflineWidget(Subscription.nonUserWidget);else if(Subscription.static_plan.includes(ZPeople.PLANID)){var paymentErrMsg=0==data.totalLicenseCount?ZPI18N.getString("zp.employeeprofileaddsupport",[ZPeople.peopleSupportEmail]):ZPI18N.getString("zp.employeeprofileaddmoresupport",[ZPeople.peopleSupportEmail]);ZPeople.Message.showFailureMsg(paymentErrMsg)}else{var parmentErrMsg=ZPI18N.getString("zp.employeeprofilepaymenterr",new Array(paymentUrl));ZPeople.Message.showFailureMsg(parmentErrMsg)}else if("user"===currPage)Subscription.getPaymentsWidget(Subscription.userWidget,data.totalLicenseCount);else if(Subscription.user_plan.includes(ZPeople.PLANID))Subscription.getPaymentsWidget(Subscription.nonUserWidget,data.totalLicenseCount);else if(Subscription.static_plan.includes(ZPeople.PLANID)){paymentErrMsg=0==data.totalLicenseCount?ZPI18N.getString("zp.employeeprofileaddsupport",[ZPeople.peopleSupportEmail]):ZPI18N.getString("zp.employeeprofileaddmoresupport",[ZPeople.peopleSupportEmail]);ZPeople.Message.showFailureMsg(paymentErrMsg)}else{var parmentErrMsg=ZPI18N.getString("zp.employeeprofilepaymenterr",new Array(paymentUrl));ZPeople.Message.showFailureMsg(parmentErrMsg)}}},User.getPopover=function(ele){$(ele).popover({html:!0,container:"#wrapper",content:function(){return $(".dvShwRectcon1").html()}})},User.AddUser.getAddMultiUserListPage=function(type){var currPage=Layout.Page.currentmode.split("/")[2];"#onboarding/reports/employee"===Layout.Page.hash&&(currPage="user");var params={mode:currPage,needAllDtls:!0};"invite"===type&&(params.isInviteuser="true"),ZPeople.Request.send("/users/getAddUserPage",params,User.AddUser.openAddMultiUserPopUp,type)},User.AddUser.checkAddUserDirectlyAllowed=function(data){var currPage=Layout.Page.currentmode.split("/")[2];void 0!=data&&"1"==data.pageStatus&&User.switchAddDirectUser(1,void 0,currPage)},User.AddUser.openAddMultiUserPopUp=function(data,paramsObj,type){var pageId=Layout.Page.container,islocBoolean=!1,locselect=null,addLocObj=null,popupMainDiv=pageId.find("div#formAddMultiple tbody"),firstRow=popupMainDiv.find("tr")[0];if(data.isAllowToAddEmployee){if(!data.isOrgAdmin)return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.notOrgAdmin"));if(ZPSetupCommon.isEmpty(data.modAdminLocDetails)||(islocBoolean=!0),data.pageStatus===User.allowToAddUserDirectly&&ZPSetupCommon.isEmpty(type)){if(pageId.find("div#addMulti #onboardParentElm").hide(),pageId.find("select[name='domain']").remove(),pageId.find("td#domainColm").html('<span class="DI MR5">@</span><select style="width: 160px; display:" name="domain"></select>'),User.iterateDomains(data.userDomains,pageId.find("select[name='domain']")),pageId.find("td#domainColm").closest("table").data({domains:data.userDomains}),popupMainDiv.find("tr[isaddedbyclick=true]").remove(),pageId.find("div.dverrormsg").remove(),$(firstRow).find("td").removeClass("has-error"),$(firstRow).find("input[type='text']").val(""),pageId.find("#agpMulti").prop("checked",!0),"user"==Layout.Page.currentmode.split("/")[2]?User.togglePassword("multiUser"):User.toggPwdForAUD(void 0,"multiDirect","auto"),data.hasOwnProperty("pwdPolicy")){pageId.find("#multiUPwd").removeClass("DN"),$(".dvShwRectcon1").remove(),User.pwdPol=data.pwdPolicy;var pwdDtls=User.constructPasswordPolicyElms(data.pwdPolicy);pageId.find("#addMulti").append('<div class="dvShwRectcon1 DN"><div class="S12">'+pwdDtls+"</div></div>"),User.getPopover(pageId.find("#multiUPwd"))}islocBoolean&&($("th#locHead").attr("style","display:table-cell"),$("td#locationgrp").attr("style","display:table-cell"),locselect=$("div#formAddMultiple").find("td#locationgrp"),pageId.find("td#locationgrp").closest("table").data({locations:data.modAdminLocDetails}),$($("select#MultiPagelocName").find("option").get(0)).prop("selected",!0)),data.isOnboarding&&pageId.find("div#addMulti #onboardParentElm").show(),pageId.find("div#addMulti").find("#onboardChkbox").prop("checked",!1),pageId.find("div#addMulti").modal()}else pageId.find("div#inviteMultiUsers #onboardParentElm").hide(),islocBoolean&&(locselect=pageId.find("div#inviteMultiUsers").find("div#locationParentElm"),$(locselect).attr("style","display:block"),$($("select#MultiPagelocName").find("option").get(0)).prop("selected",!0),$("div#locationgrp").html('<select class="hideSearch" id="MultiPagelocName"></select>')),data.isOnboarding&&pageId.find("div#inviteMultiUsers #onboardParentElm").show(),pageId.find("div#inviteMultiUsers").modal(),pageId.find("div#inviteMultiUsers").find("#onboardChkbox").prop("checked",!1),pageId.find("textarea#bulkmailIdBox").val(""),pageId.find("div.dverrormsg").remove();ZPSetupCommon.isEmpty(data.modAdminLocDetails)||(addLocObj=$("select#MultiPagelocName"),User.iterateLoc(data.modAdminLocDetails,addLocObj)),User.updateLicenseCountDetails(data)}else if(Subscription.restrictWidgetPlan.includes(ZPeople.PLANID)||"false"!=ZPeople.ISTRIALUSER){var parmentErrMsg=ZPI18N.getString("zp.employeeprofilepaymenterr",new Array(paymentUrl));ZPeople.Message.showFailureMsg(parmentErrMsg)}else data.offlinePaymentMode?Subscription.showOfflineWidget(Subscription.userWidget):Subscription.getPaymentsWidget(Subscription.userWidget,data.totalLicenseCount)},User.constructPasswordPolicyElms=function(object){var pwdDtls="";return $.each(object,function(key,val){"minPwdLen"==key?pwdDtls+=ZPI18N.getString("zp.pwdminlength")+val+"<br>":"minNumChar"==key?pwdDtls+=ZPI18N.getString("zp.pwdminnumchar")+val+"<br>":"minSplChar"==key?pwdDtls+=ZPI18N.getString("zp.pwdminsplchar")+val+"<br>":"mixedCase"==key&&(pwdDtls+=ZPI18N.getString("zp.pwdmixedcase")+"<br>")}),pwdDtls},User.validatePwdPolicy=function(passwd){if($(".dvShwRectcon1").length>0){var pwdKeys=User.pwdPol;if(pwdKeys.hasOwnProperty("minPwdLen")&&passwd.length<=pwdKeys.minPwdLen)return!0;if(pwdKeys.hasOwnProperty("mixedCase")){var smallC=!1,bigC=!1;if(null!=passwd.match(/[a-z]/g)&&passwd.match(/[a-z]/g).length>=1&&(smallC=!0),null!=passwd.match(/[A-Z]/g)&&passwd.match(/[A-Z]/g).length>=1&&(bigC=!0),!smallC||!bigC)return!0}if(pwdKeys.hasOwnProperty("minSplChar")){var allFoundSplCharacters=passwd.match(/[@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/g);if(null==allFoundSplCharacters)return!0;if(!(allFoundSplCharacters.length>=pwdKeys.minSplChar))return!0}if(pwdKeys.hasOwnProperty("minNumChar")){var allFoundNumCharacters=passwd.match(/[\d]/g);if(null==allFoundNumCharacters)return!0;if(!(allFoundNumCharacters.length>=pwdKeys.minNumChar))return!0}}},User.updateLicenseCountDetails=function(dataObj){var pageId=Layout.Page.container;pageId.find("span[name=employees_added]:visible").text(dataObj.employeesAdded),pageId.find("span[name=licensecnt_left]:visible").text(dataObj.licenseCountLeft),dataObj.isPeopleplus&&dataObj.isMismatchInLicenseLeftInPP?(pageId.find("div[name=employees_addedbtn]").attr("class","btn-group PL30"),pageId.find("span[name=import_total_license]:visible").text(dataObj.totalLicenseCount),pageId.find("span#license_alert").attr("data-content",ZPI18N.getString("zp.alertLicenseInfo",new Array(dataObj.otherappLicense,dataObj.adminPanelAppsPageUrl))),pageId.find("span#license_alert").popover({html:!0}).on("focus",function(){$(this).popover("show")}).on("focusout",function(){var _this=this;$(".popover:hover").length?$(".popover").mouseleave(function(){$(_this).popover("hide"),$(this).off("mouseleave")}):$(this).popover("hide")})):(pageId.find("div[name=import_total_licensebtn]:visible").hide(),pageId.find("span#license_alert").hide())},User.AddUser.inviteBulkUsers=function(){var pageId=Layout.Page.container;pageId.find("div#inviteMultiUsers").find("a#inviteBulk").addClass("disabled");var bulkEmailIdBoxElm=pageId.find("textarea#bulkmailIdBox"),locid=pageId.find("select#MultiPagelocName").val();null==locid&&(locid=-1);var bulkMailIds=bulkEmailIdBoxElm.val(),bulkEmailIdparentElm=bulkEmailIdBoxElm.parent();if(pageId.find("div.dverrormsg").remove(),ZPSetupCommon.isEmpty(bulkMailIds.trim()))ZPSetupCommon.showErr(ZPI18N.getString("zp.specifyemailids"),bulkEmailIdparentElm,"dverrormsg");else{var mailIdList=bulkMailIds.split(","),errorList=[],validMailIdsList=[];if(0===mailIdList.length)ZPSetupCommon.showErr(ZPI18N.getString("zp.validemail"),bulkEmailIdparentElm,className);else if($.each(mailIdList,function(index,mailId){mailId=mailId.trim(),ZPSetupCommon.isEmpty(mailId)||(CompanySettings.isValidEmail(mailId)?-1!==validMailIdsList.indexOf(mailId)?(ZPSetupCommon.showErr(mailId+" - "+ZPI18N.getString("zp.duplicatmailid"),bulkEmailIdparentElm,"dverrormsg","bulkInv"+index),errorList.push(mailId)):validMailIdsList.push(mailId):(ZPSetupCommon.showErr(ZSEC.Encoder.encodeForHTML(mailId)+" - "+ZPI18N.getString("zp.invalidemail"),bulkEmailIdparentElm,"dverrormsg","bulkInv"+index),errorList.push(mailId)))}),0===errorList.length){var params={multiEmailIds:JSON.stringify(validMailIdsList),method:"bulkInviteUser",locid:locid};pageId.find("#inviteMultiUsers").find("#onboardParentElm").is(":visible")&&(params.obEnable=pageId.find("#inviteMultiUsers").find("#onboardChkbox").is(":checked")),ZPeople.Request.send("/users/bulkInviteUsers",params,User.AddUser.handleResponseOfBulkInivteUsers)}else pageId.find("div#inviteMultiUsers").find("a#inviteBulk").removeClass("disabled")}},User.AddUser.handleResponseOfBulkInivteUsers=function(data){var pageId=Layout.Page.container;pageId.find("div#inviteMultiUsers").find("a#inviteBulk").removeClass("disabled");var bulkEmailIdparentElm=pageId.find("textarea#bulkmailIdBox").parent(),zUserMsg=data.isZohoUserMsg;if(ZPSetupCommon.isEmpty(data.result))if(ZPSetupCommon.isEmpty(data.error.userAddError)){idCount=0;if(!ZPSetupCommon.isEmpty(data.noOrgAdmin))return void ZPeople.Message.showFailureMsg(data.noOrgAdmin);if(data.error.hasOwnProperty("paymentError")){idCount++,ZPSetupCommon.showErr(data.error.paymentError+"<br>",bulkEmailIdparentElm,"dverrormsg","duplicate"+idCount);filterValues={userStatus:"2"};User.setCurrentFilterValues(filterValues,!0)}else $.each(data.error,function(mailId,error){idCount++,ZPSetupCommon.showErr(mailId+" - "+error+"<br>",bulkEmailIdparentElm,"dverrormsg","duplicate"+idCount)})}else{var allValues=data.error.userAddError,idCount=0;$.each(allValues,function(index,errObj){idCount++,"Z112"==errObj.errorMsg?ZPSetupCommon.showErr(errObj.errorMailIds+" - "+ZPI18N.getString("zp.dcinviteerror",[ZPeople.peopleSupportEmail])+"<br>",bulkEmailIdparentElm,"dverrormsg","duplicate"+idCount):ZPSetupCommon.showErr(errObj.errorMailIds+" - "+ZPI18N.getString("zp.userAdd.exceptionMsg",[ZPeople.peopleSupportEmail])+"<br>",bulkEmailIdparentElm,"dverrormsg","duplicate"+idCount)})}else{pageId.find("div#inviteMultiUsers").modal("hide"),ZPeople.ISUNCONFIRMEDACC?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.inviteuncnfrmd")):ZPeople.Message.showSuccessMsg(data.result);var filterValues={userStatus:"2"};User.setCurrentFilterValues(filterValues,!0),null==zUserMsg||ZPSetupCommon.isEmpty(zUserMsg)||User.showZohoUsers(zUserMsg,data.invitationType)}},User.AddUser.migrateNonuserstoUsersDirectPopup=function(result,params){result.modal;if($("#migrateNonusersLoader").hide(),Layout.Page.container.find("#bulkUserConvertDiv .ZPLRow").remove(),result.hasOwnProperty("success")){Layout.Page.container.find("#selectBulkActiontoUsers").find(".dropdown-toggle").removeClass("disabled"),Layout.Page.container.find("#selectBulkActiontoUsers").find(".dropdown-toggle").find("span").show(),Layout.Page.container.find("#migrateemployeeprofilesLoader").hide(),Layout.Page.container.find("#password").val("");var toResetBulkConversion=Layout.Page.container.find("#bulkMigrateusersDirectPopup");toResetBulkConversion.find("div#manualBulk").addClass("hide"),toResetBulkConversion.find("div#autoBulk").removeClass("hide"),User.toggleAGPforBulkConvDir=!0,Layout.Page.container.find("div#bulkMigrateusersDirectPopup").modal(),Layout.Page.container.find("div#bulkMigrateusersDirectPopup").find("#directUserSubmit").off().on("click",function(){User.AddUser.migrateNonuserstoUsersDirectly(params.erecNos)})}result.hasOwnProperty("Error")&&ZPeople.Request.send("/users/convertNonusersToUsers",{erecNos:params.erecNos,type:1},User.AddUser.migrateUsersAction)},User.AddUser.migrateNonuserstoUsersDirectly=function(erecNos){Layout.Page.container.find(".dverrormsg").hide();var params={erecNos:erecNos,type:1};if(User.toggleAGPforBulkConvDir)params.autoGenPwdBulk=User.toggleAGPforBulkConvDir;else{var password=Layout.Page.container.find("#password").val();if(ZPSetupCommon.isEmpty(password))return Layout.Page.container.find(".dverrormsg").text(ZPI18N.getString("zp.enterpasswd")),void Layout.Page.container.find(".dverrormsg").show();if(!ZPSetupCommon.isEmpty(password)&&password.length<8)return Layout.Page.container.find(".dverrormsg").text(ZPI18N.getString("zp.passwordlengshort")),void Layout.Page.container.find(".dverrormsg").show();if(User.validatePwdPolicy(password))return Layout.Page.container.find(".dverrormsg").text(ZPI18N.getString("zp.passwordpolicy")),void Layout.Page.container.find(".dverrormsg").show();params.password=password.trim()}Layout.Page.container.find("div#bulkMigrateusersDirectPopup").find("#directUserSubmit").html(ZPI18N.getString("zp.pleasewaitmsg")),Layout.Page.container.find("div#bulkMigrateusersDirectPopup").find("#directUserSubmit").addClass("disabled"),Layout.Page.container.find("div#bulkMigrateusersDirectPopup").find("#directUserClose").addClass("disabled"),ZPeople.Request.send("/users/convertNonusersToUsers",params,User.AddUser.migrateUsersAction)},User.AddUser.migrateNonuserstoUsers=function(target){var pageId=Layout.Page.container,erecNo=[],maxCount=0;if(Layout.Page.container.find("div#bulkMigrateusersDirectPopup").modal("hide"),userTableElm=pageId.find("table#userListTable"),$.each(userTableElm.find("input[name='userRowCheck']:checked"),function(index,obj){erecNo[index]=$(obj).closest("tr").attr("emperecno"),maxCount++}),maxCount>0)if($("#bulkUserConvertErrorDiv"+target).hide(),erecNo.length>0){var erecNos=JSON.stringify(erecNo);"employeeprofile"==target?($("#migrateNonusersLoader").show(),Layout.Page.container.find("#selectBulkActiontoUsers").find(".dropdown-toggle").addClass("disabled"),Layout.Page.container.find("#selectBulkActiontoUsers").find(".dropdown-toggle").find("span").hide(),Layout.Page.container.find("#migrateemployeeprofilesLoader").show(),ZPeople.Request.send("/users/convertNonusersToUsers",{erecNos:erecNos,type:2},User.AddUser.migrateUsersAction)):"user"==target?($("#migrateusersLoader").show(),ZPeople.Request.send("/users/convertUsersToNonUsers",{erecNos:erecNos},User.AddUser.migrateUsersAction)):"directuser"==target&&($("#migrateNonusersLoader").show(),Layout.Page.container.find("#selectBulkActiontoUsers").find(".dropdown-toggle").addClass("disabled"),Layout.Page.container.find("#selectBulkActiontoUsers").find(".dropdown-toggle").find("span").hide(),Layout.Page.container.find("#migrateemployeeprofilesLoader").show(),ZPeople.Request.send("/users/getDomainNonUsersForBulkConversion",{method:"getDomainNonUsersForBulkConversion",erecNos:erecNos},User.AddUser.migrateNonuserstoUsersDirectPopup))}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.lookup.norecfound"))},User.AddUser.migrateUsersAction=function(result){var pageId=Layout.Page.container,modal=result.modal;if("azure"==result.integratedName?pageId.find("div#dvImportUsr").modal("hide"):"gapps"==result.integratedName&&pageId.find("div#dvGappUsr").modal("hide"),$("#migrateNonusersLoader").hide(),$("#migrateusersLoader").hide(),"admin-employeerecords-employeeprofile"==Layout.Page.pageId&&(Layout.Page.container.find("#selectBulkActiontoUsers").find(".dropdown-toggle").removeClass("disabled"),Layout.Page.container.find("#selectBulkActiontoUsers").find(".dropdown-toggle").find("span").show(),Layout.Page.container.find("#migrateemployeeprofilesLoader").hide(),Layout.Page.container.find("div#bulkMigrateusersDirectPopup").find("#directUserSubmit").html("Submit"),Layout.Page.container.find("div#bulkMigrateusersDirectPopup").find("#directUserSubmit").removeClass("disabled"),Layout.Page.container.find("div#bulkMigrateusersDirectPopup").find("#directUserClose").removeClass("disabled"),Layout.Page.container.find("div#bulkMigrateusersDirectPopup").modal("hide")),result.hasOwnProperty("paymentErrInit")?ZPeople.Message.showFailureMsg(result.paymentErrInit):result.hasOwnProperty("Limitexceeded")&&ZPeople.Message.showFailureMsg(result.Limitexceeded),result.hasOwnProperty("SuccessMsg")&&ZPeople.Message.showSuccessMsg(result.SuccessMsg),result.hasOwnProperty("Errors")||result.hasOwnProperty("mode")&&"Login Status"==result.mode){$("div#bulkMigrateusersPopup"+modal).modal(),$("#bulkUserConvertErrorDiv"+modal).show();var convModal=$("div#bulkMigrateusersPopup"+modal);result.hasOwnProperty("mode")&&"Login Status"==result.mode?(convModal.find("#modalTitle").text(ZPI18N.getString("zp.bulkChangeLoginSummary")),convModal.find("#successDetail").text(ZPI18N.getString("zp.successLoginSummary")),convModal.find("#errorDetail").text(ZPI18N.getString("zp.failedLoginSummary"))):(convModal.find("#modalTitle").text(ZPI18N.getString("zp.convertionreport")),convModal.find("#successDetail").text(ZPI18N.getString("user"==modal?"zp.successuser":"zp.successemployeeprofile")),convModal.find("#errorDetail").text(ZPI18N.getString("zp.bulkerror"))),$("#bulkUserConvertErrorDiv"+modal+" #formOne"+modal).removeClass("in"),$("#bulkUserConvertErrorDiv"+modal+" #formTwo"+modal).removeClass("in"),$("#bulkUserConvertErrorDiv"+modal+" #formThree"+modal).removeClass("in"),result.hasOwnProperty("Success")?($("#SuccessDiv").addClass("label-main"),$("#bulkUserConvertErrorDiv"+modal).find("#SuccessDiv .label-head").show(),$("#bulkUserConvertErrorDiv"+modal).find("#bulkUserConvertSuccess").empty(),result.Success[0].hasOwnProperty("EmployeeId")?($.each(result.Success,function(key,success){$("#bulkUserConvertErrorDiv"+modal).find("#bulkUserConvertSuccess").append('<tr class="ZPLRow"><td>'+success.EmployeeId+"</td><td>"+success.mailId+"</td><td>"+success.Message+"</td></tr>")}),$("#bulkUserConvertErrorDiv"+modal+" .ZPLHRow").find("#bulkSuccessEmpids").show()):($.each(result.Success,function(key,success){$("#bulkUserConvertErrorDiv"+modal).find("#bulkUserConvertSuccess").append('<tr class="ZPLRow"><td>'+success.mailId+"</td><td>"+success.Message+"</td></tr>")}),$("#bulkUserConvertErrorDiv"+modal+" .ZPLHRow").find("#bulkSuccessEmpids").hide())):($("#bulkUserConvertErrorDiv"+modal).find("#SuccessDiv .label-head").hide(),$("#SuccessDiv").removeClass("label-main")),result.hasOwnProperty("Errors")?($("#ErrorDiv").addClass("label-main"),$("#bulkUserConvertErrorDiv"+modal).find("#ErrorDiv .label-head").show(),$("#bulkUserConvertErrorDiv"+modal).find("#bulkUserConvertError").empty(),result.Errors[0].hasOwnProperty("EmployeeId")?($.each(result.Errors,function(key,error){$("#bulkUserConvertErrorDiv"+modal).find("#bulkUserConvertError").append('<tr class="ZPLRow"><td>'+error.EmployeeId+"</td><td>"+(error.hasOwnProperty("mailId")?error.mailId:"")+"</td><td>"+error.Message+"</td></tr>")}),$("#bulkUserConvertErrorDiv"+modal+" .ZPLHRow").find("#bulkErrorEmpids").show()):($.each(result.Errors,function(key,error){$("#bulkUserConvertErrorDiv"+modal).find("#bulkUserConvertError").append('<tr class="ZPLRow"><td>'+(error.hasOwnProperty("mailId")?error.mailId:"")+"</td><td>"+error.Message+"</td></tr>")}),$("#bulkUserConvertErrorDiv"+modal+" .ZPLHRow").find("#bulkErrorEmpids").hide())):($("#bulkUserConvertErrorDiv"+modal).find("#ErrorDiv .label-head").hide(),$("#ErrorDiv").removeClass("label-main")),result.hasOwnProperty("Skipped")?($("#SkippedDiv").addClass("label-main"),$("#bulkUserConvertErrorDiv"+modal).find("#SkippedDiv .label-head").show(),$("#bulkUserConvertErrorDiv"+modal).find("#bulkUserConvertSkipped").empty(),result.Skipped[0].hasOwnProperty("EmployeeId")&&($.each(result.Skipped,function(key,skip){$("#bulkUserConvertErrorDiv"+modal).find("#bulkUserConvertSkipped").append('<tr class="ZPLRow"><td>'+skip.EmployeeId+"</td><td>"+skip.mailId+"</td><td>"+skip.Message+"</td></tr>")}),$("#bulkUserConvertErrorDiv"+modal+" .ZPLHRow").find("#bulkSkippedEmpids").show())):($("#bulkUserConvertErrorDiv"+modal).find("#SkippedDiv .label-head").hide(),$("#SkippedDiv").removeClass("label-main"))}result.hasOwnProperty("ERROR")&&ZPeople.Message.showFailureMsg(result.ERROR),(result.hasOwnProperty("SuccessMsg")||result.hasOwnProperty("Success"))&&(User.ListUsers.getUserList(),Layout.Page.pageId.includes("user")?User.variables.employeeprofile.reload=!0:User.variables.user.reload=!0),result.hasOwnProperty("Limitexceeded")||(userTableElm.find("#massCheckBox").prop("checked",!1),$.each(userTableElm.find("input[name='userRowCheck']:checked"),function(index,obj){userTableElm.find(".active").removeClass("active"),userTableElm.find("input[name='userRowCheck']").prop("checked",!1)}),pageId.find("div#usersOptions").addClass("DN"),pageId.find("div#licenseDtlsRow").removeClass("DN"))},User.AddUser.nonUserPopUp=function(object,params,isJson){var pageId=Layout.Page.container,currPage=Layout.Page.currentmode.split("/")[2];pageId.find("div#addEmp").length<=0&&pageId.find("body").append(User.usersPageElm),pageId.find("div#addUserSubTabs").addClass("hide"),void 0!=params&&params.hasOwnProperty("isEmailIdDisabled")&&1==params.isEmailIdDisabled?pageId.find("input#disabledEmailId").prop("disabled",!0):(pageId.find("#disabledEmailIdInfo").remove(),pageId.find("input#disabledEmailId").prop("disabled",!1)),pageId.find("div#formAddEmp"+currPage).addClass("active in"),pageId.find("div#formAddNon").removeClass("active in"),pageId.find("div#formAddEmp").addClass("active in"),pageId.find("div#formAddEmp").find("div").removeClass("has-error"),pageId.find("div#formAddEmp").find("div.dverrormsg").remove(),"#admin/dashboard"!==Layout.Page.hash&&"#onboarding/reports/employee"!==Layout.Page.hash||(currPage="user");var addEmpSliderCont=pageId.find("div#addEmp"),employees_addedObj=addEmpSliderCont.find("span#employees_added");if(!isJson||ZPSetupCommon.isEmpty(object.licenseCountLeft))if(addEmpSliderCont.find("div#import_total_licensebtn").hide(),addEmpSliderCont.find("span[name=import_total_license]").hide(),addEmpSliderCont.find("span#license_alert").hide(),addEmpSliderCont.find("div#employees_addebtntxt").attr("class","btn-group PL10"),"Non-user"===$(object).attr("status")){findElmId="addEmp";var erecNo=$(object).closest("tr").attr("empErecNo");pageId.find("div#emailIdParentElm").attr("isMandatory","true"),pageId.find("div#emailIdParentElm").find("label").addClass("zp_mdt"),User.isLastNameMand?(pageId.find("div#lastNameParentElm").attr("isMandatory","true"),pageId.find("div#lastNameParentElm").find("label").addClass("zp_mdt")):(pageId.find("div#lastNameParentElm").attr("isMandatory","false"),pageId.find("div#lastNameParentElm").find("label").removeClass("zp_mdt"));var isEmailIdDisabled=!1;pageId.find("div#lastEMpId").hide();var zuid=$(object).closest("tr").attr("zuid");zuid&&-1!=zuid&&""!=zuid&&(pageId.find("input#disabledEmailId").prop("disabled",!0),$(`<a id="disabledEmailIdInfo" title="${ZPI18N.getString("zp.canteditusercovertedempemailid")}" name="fieldToolTip" class="IC-info"></a>`).insertAfter($("div#mobMail")),isEmailIdDisabled=!0),User.AddUser.openDummyEmployeePage(object),pageId.find("a#nextStep").attr("onclick","User.AddUser.addDirectUser('"+erecNo+"',true)"),pageId.find("a#nextStep").text(ZPI18N.getString("zp.add")),ZPeople.Request.send("/users/getAddUserPage",{needAllDtls:"true",mode:"user",isEmailIdDisabled:isEmailIdDisabled},User.AddUser.nonUserPopUp,!0)}else pageId.find("a#nextStep").attr("onclick","User.AddUser.addDirectUser(true)"),"user"===currPage?(pageId.find("div#emailIdParentElm").attr("isMandatory","true"),pageId.find("div#emailIdParentElm").find("label").addClass("zp_mdt"),User.isLastNameMand?(pageId.find("div#lastNameParentElm").attr("isMandatory","true"),pageId.find("div#lastNameParentElm").find("label").addClass("zp_mdt")):(pageId.find("div#lastNameParentElm").attr("isMandatory","false"),pageId.find("div#lastNameParentElm").find("label").removeClass("zp_mdt")),pageId.find("a#nextStep").text(ZPI18N.getString("zp.invite"))):(pageId.find("div#emailIdParentElm,div#lastNameParentElm").attr("isMandatory","false"),pageId.find("#emailIdParentElm").find("label").html("<font>"+User.mailDispName+"</font>"),pageId.find("#emailIdParentElm,div#lastNameParentElm").find("label").removeClass("zp_mdt"),pageId.find("a#nextStep").text(ZPI18N.getString("zp.add")));else if(employees_addedObj.text(object.employeesAdded),addEmpSliderCont.find("div#import_total_licensebtn").show(),addEmpSliderCont.find("span[name=import_total_license]").show(),addEmpSliderCont.find("span#licensecnt_left").text(object.licenseCountLeft),object.isPeopleplus&&object.isMismatchInLicenseLeftInPP?(addEmpSliderCont.find("div[name=employees_addedbtn]").attr("class","btn-group PL30"),addEmpSliderCont.find("div#employees_addebtntxt").attr("class","btn-group PL30"),addEmpSliderCont.find("span#license_alert").show(),addEmpSliderCont.find("span[name=import_total_license]:visible").text(object.totalLicenseCount),addEmpSliderCont.find("span#license_alert").attr("data-content",ZPI18N.getString("zp.alertLicenseInfo",new Array(object.otherappLicense,object.adminPanelAppsPageUrl))),addEmpSliderCont.find("span#license_alert").popover({html:!0}).on("focus",function(){$(this).popover("show")}).on("focusout",function(){var _this=this;$(".popover:hover").length?$(".popover").mouseleave(function(){$(_this).popover("hide"),$(this).off("mouseleave")}):$(this).popover("hide")})):(addEmpSliderCont.find("div#import_total_licensebtn").hide(),addEmpSliderCont.find("span[name=import_total_license]").hide(),addEmpSliderCont.find("span#license_alert").hide()),removeTextNode(addEmpSliderCont.find("div#employees_addebtntxt")),addEmpSliderCont.find("div#employees_addebtntxt").prepend(document.createTextNode(object.addUsersKey)),isJson&&!ZPSetupCommon.isEmpty(object.modAdminLocDetails)){var locselect=pageId.find("div#addEmp").find("div#locationParentElm");$(locselect).attr("style","display:block"),$(pageId.find("div#addEmp select#locName").find("option").get(0)).prop("selected",!0),pageId.find("div#addEmp select#locName").remove(),pageId.find("div#locationgrp").html('<select class="hideSearch" id="locName"></select>');var addLocObj=pageId.find("select#locName");User.iterateLoc(object.modAdminLocDetails,addLocObj)}},User.AddUser.validateBasicInfo=function(userType){var pageId=Layout.Page.container,empId=pageId.find("input#employeeId").val(),firstName=pageId.find("input#fname").val(),lastName=pageId.find("input#lname").val(),emailId=pageId.find("input#disabledEmailId").val(),currPage=Layout.Page.currentmode.split("/")[2],error=!1,isLastNameMandatory=pageId.find("div#lastNameParentElm").attr("isMandatory"),isEmailIdMandatory=pageId.find("div#emailIdParentElm").attr("isMandatory"),empIdErr="";if(pageId.find("div.dverrormsg").remove(),pageId.find("div.modal-body").find("div").removeClass("has-error"),ZPSetupCommon.isEmpty(empId)||empId===User.lastEmployeeId&&"user"===currPage){ZPSetupCommon.isEmpty(empId)?(empIdErr=ZPI18N.getString("zp.entervalforfield",[User.empidDispName]),"empEmptyId"):(empIdErr=ZPI18N.getString("zp.DuplicateMsgInAdduser",[User.empidDispName]),"empDuplicateId");var errorKeptElm=pageId.find("input#employeeId"),errDiv=jQuery("<div/>",{class:"dverrormsg"});$(errDiv).insertAfter(pageId.find("input#employeeId")),$(errDiv).html(empIdErr),pageId.find("div#empIdErr").addClass("has-error"),error=!0}if(ZPSetupCommon.isEmpty(firstName)){errorKeptElm=pageId.find("input#fname").parent();ZPSetupCommon.showErr(ZPI18N.getString("zp.entervalforfield",[User.fnameDispName]),errorKeptElm,"dverrormsg"),pageId.find("div#firstNameParentElm").addClass("has-error"),error=!0}if(ZPSetupCommon.isEmpty(lastName)&&"true"===isLastNameMandatory){errorKeptElm=pageId.find("input#lname").parent();ZPSetupCommon.showErr(ZPI18N.getString("zp.entervalforfield",[User.lnameDispName]),errorKeptElm,"dverrormsg"),pageId.find("div#lastNameParentElm").addClass("has-error"),error=!0}if(!User.isMobile&&(ZPSetupCommon.isEmpty(emailId)&&"true"===isEmailIdMandatory||!ZPSetupCommon.isEmpty(emailId)&&!CompanySettings.isValidEmail(emailId))){errorKeptElm=pageId.find("input#disabledEmailId").parent();ZPSetupCommon.showErr(ZPI18N.getString("zp.entermailid"),errorKeptElm,"dverrormsg"),pageId.find("div#emailIdParentElm").addClass("has-error"),error=!0}if(User.isMobile){var countryCode=null==pageId.find("#mobDialCode").val()?"":pageId.find("#mobDialCode").val();if(ZPSetupCommon.isEmpty(countryCode)||!ZPComponents.dialCode.isValidCountryCode(countryCode.trim())){errorKeptElm=pageId.find("input#disabledEmailId").parent();ZPSetupCommon.showErr(ZPI18N.getString("zp.countryemptymsg"),errorKeptElm,"dverrormsg"),pageId.find("div#mobMail").addClass("has-error"),error=!0}if(ZPSetupCommon.isEmpty(emailId)&&"true"===isEmailIdMandatory||!ZPSetupCommon.isEmpty(emailId)&&!CompanySettings.isValidMobile(emailId)){errorKeptElm=pageId.find("input#disabledEmailId").parent();ZPSetupCommon.showErr(ZPI18N.getString("zp.mobusrvaldn"),errorKeptElm,"dverrormsg"),pageId.find("div#emailIdParentElm").addClass("has-error"),error=!0}}return error},User.AddUser.nextStep=function(){var pageId=Layout.Page.container;User.AddUser.validateAccDtls()||(pageId.find("ul#dvAddEmp li:last").addClass("active"),pageId.find("ul#dvAddEmp li:first").removeClass("active"),pageId.find("div#formAddNon").removeClass("active in"),pageId.find("div#formAddEmp").addClass("active in"),pageId.find("input#disabledEmailId").val(pageId.find("input#emailEditBox").val()+pageId.find("a#mailspecialChar").text()+pageId.find("select#domainName").val()),$("div.dverrormsg").remove(),pageId.find("#emailIdParentElm").find("label").html("<font>"+User.mailDispName+"</font>"),"active"===pageId.find("ul#dvAddEmp li:last").attr("class")?(pageId.find("a#nextStep").attr("onclick","User.AddUser.addDirectUser()"),pageId.find("a#nextStep").text(ZPI18N.getString("zp.add"))):(pageId.find("a#nextStep").attr("onclick","User.AddUser.nextStep()"),pageId.find("a#nextStep").text(ZPI18N.getString("zp.next"))))},User.AddUser.addMultiEmployees=function(thisObj){var emailIdsPasswd={},emailIdsLoc={},error=!1,emailIdList=[],mailIdsLength=0,rows=($("div#addMulti").find("input[name='emailId']"),Layout.Page.container.find("#formAddMultiple tbody tr"));if($.each(rows,function(index,ele){var usernameEle=$(ele).find("input[name='emailId']"),username=usernameEle.val(),emailId=username+"@"+$(ele).find("select[name='domain']").val(),location=$(ele).find("select[name='location']").val();if(mailIdsLength+=emailId.length,usernameEle.attr("emailId",emailId),ZPSetupCommon.isEmpty(username)||!CompanySettings.isValidEmail(emailId)?($(this).parent().addClass("has-error"),error=!0,ZPSetupCommon.showErr(ZPI18N.getString("zp.entervalforfield",[ZPI18N.getString("zp.emailid")]),usernameEle.parent(),"dverrormsg")):!ZPSetupCommon.isEmpty(username)&&CompanySettings.isValidEmail(emailId)&&(-1!==emailIdList.indexOf(emailId)?(error=!0,ZPSetupCommon.showErr(ZPI18N.getString("zp.duplicatmailid"),usernameEle.parent(),"dverrormsg")):(error=!1,usernameEle.parent().find("div.dverrormsg").remove(),usernameEle.parent().removeClass("has-error"),emailId=encodeURI(emailId),emailIdList.push(emailId))),!User.toggleAGPforMulUsrsDir){var passEle=$(ele).find("input[name='password']").parent(),pass=$(ele).find("input[name='password']").val();passEle.find("div.dverrormsg").remove(),ZPSetupCommon.isEmpty(pass)?(error=!0,passEle.addClass("has-error"),ZPSetupCommon.showErr(ZPI18N.getString("zp.entervalforfield",[ZPI18N.getString("zp.passwd")]),passEle,"dverrormsg")):ZPSetupCommon.isEmpty(pass)||(pass.length<8?(error=!0,passEle.addClass("has-error"),ZPSetupCommon.showErr(ZPI18N.getString("zp.passwordlengshort"),passEle,"dverrormsg")):User.validatePwdPolicy(pass)?(error=!0,passEle.addClass("has-error"),ZPSetupCommon.showErr(ZPI18N.getString("zp.passwordpolicy"),passEle,"dverrormsg"),$("#multiUPwd").mouseover(),setTimeout(function(){$("#multiUPwd").popover("hide")},3e3)):(passEle.find("div.dverrormsg").remove(),passEle.removeClass("has-error")))}error||(User.toggleAGPforMulUsrsDir?emailIdsPasswd[emailId]=null:emailIdsPasswd[emailId]=pass,null!=location&&(emailIdsLoc[emailId]=location))}),!error)if(mailIdsLength<=1e3){$(thisObj).prop("disabled",!0);var params={multiEmailIds:JSON.stringify(emailIdsPasswd),method:"addMultiUsers",autoGenPwdMulti:User.toggleAGPforMulUsrsDir};$.isEmptyObject(emailIdsLoc)||(params.locids=JSON.stringify(emailIdsLoc)),Layout.Page.container.find("div#addMulti").find("#onboardParentElm").is(":visible")&&(params.obEnable=Layout.Page.container.find("div#addMulti").find("#onboardChkbox").is(":checked")),Layout.Page.container.find("div#addMulti").find("a#addMultipleDirectly").addClass("disabled"),ZPeople.Request.send("/users/addMultiUser",params,User.AddUser.addMultiUsersResponse,thisObj)}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.maildidlengthexceeded"))},User.AddUser.addMultiUsersResponse=function(data,params,saveElement){var pageId=Layout.Page.container;pageId.find("div#addMulti").find("a#addMultipleDirectly").removeClass("disabled");var zUserMsg=data.isZohoUserMsg;if($(saveElement).prop("disabled",!1),"success"===data.result){pageId.find("div#addMulti").modal("hide"),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.usersdaddedsuccessfully"));var filterValues={userStatus:data.filterStatus};User.setCurrentFilterValues(filterValues,!0),null==zUserMsg||ZPSetupCommon.isEmpty(zUserMsg)||User.showZohoUsers(zUserMsg)}else if("duplicate"===data.result)$.each(data,function(mailId,errObj){var errkeptElm=pageId.find("div#formAddMultiple").find("input[emailId='"+mailId+"']").parent(),errorValue=null;null!=errObj.emailIdParentElm&&void 0!=errObj.emailIdParentElm&&(errorValue=errObj.emailIdParentElm),null!=errObj.empLocAuthErr&&void 0!=errObj.empLocAuthErr&&(errorValue=null!=errorValue?errorValue+","+errObj.empLocAuthErr:errObj.empLocAuthErr),ZPSetupCommon.showErr(errorValue,errkeptElm,"dverrormsg")});else if(ZPSetupCommon.isEmpty(data.userAddError))ZPeople.Message.showFailureMsg(data.error);else{var allValues=data.userAddError;$.each(allValues,function(index,errObj){var errkeptElm=pageId.find("div#formAddMultiple").find("input[emailId='"+errObj.errorMailIds+"']").parent();"Z112"==errObj.errorMsg?ZPSetupCommon.showErr(ZPI18N.getString("zp.dcinviteerror",[ZPeople.peopleSupportEmail]),errkeptElm,"dverrormsg"):ZPSetupCommon.showErr(ZPI18N.getString("zp.userAdd.exceptionMsg",[ZPeople.peopleSupportEmail]),errkeptElm,"dverrormsg")})}null==zUserMsg||ZPSetupCommon.isEmpty(zUserMsg)||User.showZohoUsers(zUserMsg)},User.toggPwdForAUD=function(setPwd,mode,manualOrAuto){var pageId=Layout.Page.container;"multiDirect"==mode?"auto"==manualOrAuto?(pageId.find("#pwdHideHdr").addClass("hide"),pageId.find("#pwdHide1stLine").addClass("hide"),$("#formAddMultiple").find("input[name='password']").parent().addClass("hide"),$("#manualMulti").addClass("hide"),$("#autoMulti").removeClass("hide"),User.toggleAGPforMulUsrsDir=!0):"manual"==manualOrAuto&&(pageId.find("#pwdHideHdr").removeClass("hide"),pageId.find("#pwdHide1stLine").removeClass("hide"),$("#formAddMultiple").find("input[name='password']").parent().removeClass("hide"),$("#autoMulti").addClass("hide"),$("#manualMulti").removeClass("hide"),User.toggleAGPforMulUsrsDir=!1):void 0==setPwd?(pageId.find("#passwordParentElmAgp").removeClass("hide"),pageId.find("#passwordParentElm").addClass("hide"),User.toggleAGPforAddDir=!0):(pageId.find("#passwordParentElmAgp").addClass("hide"),pageId.find("#passwordParentElm").removeClass("hide"),User.toggleAGPforAddDir=!1)},User.togglePassword=function(mode){var pageId=Layout.Page.container;"singleUser"==mode?pageId.find('#passwordParentElmAgp input[type="checkbox"]').is(":checked")?(pageId.find("#passwordParentElm").addClass("hide"),User.toggleAGPforAddDir=!0):(pageId.find("#passwordParentElm").removeClass("hide"),User.toggleAGPforAddDir=!1):pageId.find('#autoMulti input[type="checkbox"]').is(":checked")?(pageId.find("#pwdHideHdr").addClass("hide"),pageId.find("#formAddMultiple").find('input[name="password"]').parent().addClass("hide"),User.toggleAGPforMulUsrsDir=!0):(pageId.find("#pwdHideHdr").removeClass("hide"),pageId.find("#formAddMultiple").find('input[name="password"]').parent().removeClass("hide"),User.toggleAGPforMulUsrsDir=!1)},User.toggleAutoGenPasswordForBUC=function(mode){var pageId=Layout.Page.container.find("#bulkMigrateusersDirectPopup");void 0!=mode?(pageId.find("div#manualBulk").addClass("hide"),pageId.find("div#autoBulk").removeClass("hide"),User.toggleAGPforBulkConvDir=!0):(pageId.find("div#autoBulk").addClass("hide"),pageId.find("div#manualBulk").removeClass("hide"),User.toggleAGPforBulkConvDir=!1)},User.AddUser.addDirectUser=function(isInviteUser,isMigrate){var emailId,type,erecNo,locid,pageContent=Layout.Page.container,currPage=Layout.Page.currentmode.split("/")[2];emailId=pageContent.find("input#disabledEmailId").val().trim();var password=pageContent.find("input#pswd").val();if("#admin/dashboard"!==Layout.Page.hash&&"#onboarding/reports/employee"!==Layout.Page.hash||(currPage="user"),User.isMigrateUser=!!isMigrate,!User.AddUser.validateBasicInfo()&&"user"===currPage||!User.AddUser.validateBasicInfo()&&"employeeprofile"===currPage){"employeeprofile"===currPage?User.isMigrateUser?(type="0",erecNo=isInviteUser):type="-2":type=isInviteUser?"2":"1",locid=pageContent.find("#addEmp select#locName").val(),pageContent.find("div#addEmp").find("a#nextStep").addClass("disabled");var params={};1==User.isMobile&&(emailId=pageContent.find("#mobDialCode option:selected").text().split("-")[0].trim()+"-"+emailId,type="8"),params=isInviteUser?{empId:pageContent.find("input#employeeId").val(),empFname:pageContent.find("input#fname").val(),empLname:pageContent.find("input#lname").val(),empMail:emailId,type:type,erecno:erecNo,password:password,method:"addUser",locid:locid}:{empId:pageContent.find("input#employeeId").val(),empFname:pageContent.find("input#fname").val(),empLname:pageContent.find("input#lname").val(),empMail:emailId,type:type,erecno:erecNo,password:password,method:"addUser",locid:locid,autoGenPwd:User.toggleAGPforAddDir},1==User.isMobile&&(params.dialCode=pageContent.find("#mobDialCode").val()),pageContent.find("#addEmp").find("#onboardParentElm").is(":visible")&&(params.obEnable=pageContent.find("#addEmp").find("#onboardChkbox").is(":checked")),ZPeople.Request.send("/users/addUsers",params,User.AddUser.addUsersResponse,null,User.AddUser.addUserfailedCallBack),$("div.dverrormsg").remove(),$("div.form-group").removeClass("has-error")}},User.AddUser.addUserfailedCallBack=function(){Layout.Page.container.find("div#addEmp").find("a#nextStep").removeClass("disabled")},User.AddUser.addUsersResponse=function(dataObj,paramsObj){var searchByEmpStatus,pageId=Layout.Page.container,errorMsg=dataObj.exception,filterStatus=dataObj.filterStatus,isOnboarding=(dataObj.isZohoUserMsg,Layout.Page.currentmode.indexOf("admin/dashboard"),Layout.Page.currentmode.indexOf("onboarding/reports/employee")>-1);if(ZPSetupCommon.isEmpty(errorMsg)&&ZPSetupCommon.isEmpty(dataObj.paymentErr))if(pageId.find("select#deptDtls,select#rolesDtls,select#locationsDtls").val(0).select2(),pageId.find("inpu#searcFilter").val(""),pageId.find("select#onbStatusDtls").val(-1).select2(),ZPSetupCommon.isEmpty(filterStatus)||($("div#admin-employeerecords-user").find("select#accStatusDtls").val(filterStatus).select2(),1!=filterStatus&&User.isMigrateUser&&!0,searchByEmpStatus=1==filterStatus?ZPI18N.getString("zp.active"):ZPI18N.getString("zp.allstatus"),$("div#admin-employeerecords-user").find("select#empStatusDtls").val(searchByEmpStatus).select2()),null!=dataObj.usersDtls&&void 0!=dataObj.usersDtls)User.variables.user.reload=!0,User.variables.employeeprofile.reload=!0,ZPSetupCommon.isEmpty(dataObj.success)||(ZPeople.ISUNCONFIRMEDACC?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.inviteuncnfrmd")):ZPeople.Message.showSuccessMsg(dataObj.success)),User.variables.user.filterParams.userStatus=filterStatus,User.variables.user.filterParams.searchByEmpStatus=searchByEmpStatus,"#admin/employeerecords/user"===window.location.hash||1!=filterStatus&&2!=filterStatus||isOnboarding?isOnboarding||User.ListUsers.usersListPageInit():window.location.href="#admin/employeerecords/user",$(".modal-right").hasClass("in")&&$(".modal-right").modal("hide");else{if(!ZPSetupCommon.isEmpty(dataObj.noOrgAdmin))return void ZPeople.Message.showFailureMsg(dataObj.noOrgAdmin);ZPSetupCommon.isEmpty(dataObj.error)?$.each(dataObj,function(emailId,errorObj){if("isErrorFound"!==emailId){var getErrorObj=dataObj[emailId],parentObj=pageId.find("input[emailId='"+emailId+"']").parent();parentObj.addClass("has-error"),ZPSetupCommon.showErr(getErrorObj.emailIdParentElm,parentObj,"dverrormsg"),pageId.find("input[emailId='"+emailId+"']").attr("emailErr","true")}}):$.each(dataObj.error,function(key,errMsg){if("notAllowed"!==key){var errorDiv=pageId.find("div#"+key).find("div[name='errDiv']");"emailIdParentElm"===key&&User.isMobile?pageId.find("div#"+key).addClass("has-error"):errorDiv.addClass("has-error"),"empIdErr"!==key&&"empLocAuthErr"!==key?ZPSetupCommon.showErr(errMsg,errorDiv,"dverrormsg"):"empLocAuthErr"==key?ZPeople.Message.showFailureMsg(dataObj.error[key]):jQuery("<div/>",{class:"dverrormsg",id:"empId",text:errMsg}).insertBefore(pageId.find("div#lastEMpId"))}else ZPeople.Message.showFailureMsg(dataObj.error[key])}),User.isAllowToAddUser=dataObj.isAllowToAddEmployee}else ZPSetupCommon.isEmpty(dataObj.paymentErr)||(errorMsg=dataObj.paymentErr),ZPeople.Message.showFailureMsg(errorMsg);User.lastEmployeeId=dataObj.lastEmployeeId;filterStatus=dataObj.filterStatus;Layout.Page.container.find("div#lastEMpId").find("span").text(dataObj.lastEmployeeId),Layout.Page.container.find("span#dispUsersCount").text(User.totalUsersCount),Layout.Page.container.find("div#addEmp").find("a#nextStep").removeClass("disabled")},User.AddUser.getZohoUsers=function(){ZPeople.Request.send("/users/getZohoMailUsers",{method:"getZohoUsersNewUI"},User.AddUser.handleResponseOfgetZohoUsers)},User.AddUser.handleResponseOfgetZohoUsers=function(resultDataObject){var pageContent=Layout.Page.container.find("div#dvImportUsr"),zohoMailUsersTableElm=pageContent.find("table#zohoMailUsers tbody");zohoMailUsersTableElm.find("tr").remove(),pageContent.find("#importUsrs").removeClass("disabled"),$("#showMoreDiv").remove();var zohoUsersObj=resultDataObject.zohoUsers,zohoUsersCnt=Object.keys(zohoUsersObj).length;pageContent.find("input#zohoMailUsersSearch").val(""),pageContent.find("h6#exampleModalLabel").text(ZPI18N.getString("zp.importfromzmail"));var zohoRowListElm="",objCnt=0===zohoUsersCnt?0:zohoUsersCnt,tableHeaderCont=pageContent.find("table#zohoMailUsers thead");pageContent.find("div#no_recfound_img").remove(),0===zohoUsersCnt?(tableHeaderCont.addClass("DN"),pageContent.find("div[name = 'import_optns']").addClass("DN"),pageContent.find("div#body_cont").removeClass("dvImportpop"),zohoRowListElm+=User.noRecFoundElms):(tableHeaderCont.removeClass("DN"),pageContent.find("input#massChecked").prop("checked",!1),pageContent.find("div[name = 'import_optns']").removeClass("DN"),pageContent.find("div#body_cont").addClass("dvImportpop"),$.each(resultDataObject.zohoUsers,function(zuids,userDtls){zohoRowListElm+=User.AddUser.createZohoAndGappsUserListElm(userDtls.dispName,userDtls.mailId,userDtls.photo)})),pageContent.find("div#selected_userscnt").addClass("DN"),pageContent.find("div#total_userscnt").removeClass("DN"),pageContent.find("#zohoMailUserCnt").text(objCnt),zohoMailUsersTableElm.html(zohoRowListElm),zohoMailUsersTableElm.attr("balanceUser",resultDataObject.balanceUser),openPopUp("a.dvImportUsr"),User.updateLicenseCountDetails(resultDataObject)},User.AddUser.getMicroSoftUsers=function(callNum){"1"==callNum&&(User.officeNextLink=null);var pageContent=$(Layout.Page.pageId);pageContent.find("input#massChecked").prop("checked",!1),null!=User.officeNextLink&&void 0!=User.officeNextLink||($("table#zohoMailUsers tbody").find("tr").remove(),$("#showMoreDiv").remove()),ZPeople.Request.send("/getOffice365Actions.zp",{mode:"userlisting",nextLink:User.officeNextLink},User.AddUser.handleResponseOfgetMSusers),pageContent.find("#importUsrs").addClass("disabled")},User.AddUser.handleResponseOfgetMSusers=function(msUsersList,params){var pageContent=Layout.Page.container.find("div#dvImportUsr"),zohoMailUsersTableElm=pageContent.find("table#zohoMailUsers tbody");if(pageContent.find("input#zohoMailUsersSearch").val(""),ZPSetupCommon.isEmpty(msUsersList.ERROR)){var zohoUsersCnt=Object.keys(msUsersList.SUCCESS).length;pageContent.find("h6#exampleModalLabel").text(ZPI18N.getString("zp.importfromMS"));var msUsersRows="",tableHeaderCont=pageContent.find("table#zohoMailUsers thead");pageContent.find("div#no_recfound_img").remove(),pageContent.find("#importUsrs").removeClass("disabled"),0===zohoUsersCnt&&0==zohoMailUsersTableElm.find("tr").length?(tableHeaderCont.addClass("DN"),pageContent.find("div[name = 'import_optns']").addClass("DN"),pageContent.find("div#body_cont").removeClass("dvImportpop"),msUsersRows+=User.noRecFoundElms):(tableHeaderCont.removeClass("DN"),pageContent.find("input#massChecked").prop("checked",!1),pageContent.find("div[name = 'import_optns']").removeClass("DN"),pageContent.find("div#body_cont").addClass("dvImportpop"),$.each(msUsersList.SUCCESS,function(index,msUsersDtls){msUsersRows+='<tr><td class="text-center"><div class="checkbox checkbox-primary DI ML10"><input type="checkbox" id="userListCheckBox" onchange="User.zohoUsersTickCheckBoxes(this,this.id)" name="'+msUsersDtls.user+'" value="'+msUsersDtls.emailId+'"><label></label></div></td><td id="userPhotoColm"><div class="FL" id="dispNameDiv"><a class="lnk ZPbold">'+msUsersDtls.user+'</a><div class="lblmail">'+msUsersDtls.emailId+"</div></div></td><td></td></tr>"})),pageContent.find("div#selected_userscnt").addClass("DN"),pageContent.find("div#total_userscnt").removeClass("DN"),pageContent.find("a#importUsrs").removeClass("disabled"),pageContent.find("a#importUsrs").attr("onclick","User.importZohoUsers(true,"+msUsersList.isEnabledNotify+")"),0==$("#userPhotoColm").length?zohoMailUsersTableElm.html(msUsersRows):$("#userPhotoColm").length>0&&zohoMailUsersTableElm.append(msUsersRows),!msUsersList.hasOwnProperty("nextLink")||null==msUsersList.nextLink&&void 0==msUsersList.nextLink?$("#showMoreDiv").remove():($("#showMoreDiv").remove(),User.officeNextLink=msUsersList.nextLink,$("#zohoMailUsers").append('<tfoot id="showMoreDiv"><tr><td class="text-center" colspan="3"><a id="showMore" onclick=User.AddUser.getMicroSoftUsers(\'2\')>'+ZPI18N.getString("zp.showmore")+"</a></td></tr></tfoot>")),pageContent.find("#zohoMailUserCnt").text(zohoMailUsersTableElm.find("tr").length),openPopUp("a.dvImportUsr"),User.updateLicenseCountDetails(msUsersList)}else ZPeople.Message.showFailureMsg(msUsersList.ERROR)},User.searchZohoUsers=function(thisObj){var pageContent=$(thisObj).closest("div[name='userPopup']"),shwMore=$("#showMoreDiv");$(thisObj).on("keyup",function(){""!=this.value&&null!=this.value?shwMore.hide():shwMore.show(),pageContent.find("tr#emptyMsg").remove();var rowsOfSearchList=pageContent.find("div#dvImportUsr").find("table#zohoMailUsers tbody tr").filter(":contains('"+this.value+"')"),tableObj=pageContent.find("table#zohoMailUsers tbody");rowsOfSearchList=pageContent.find("table#zohoMailUsers tbody tr").filter(":contains('"+this.value+"')"),tableObj.find("tr").addClass("hide"),0!==rowsOfSearchList.length?pageContent.find(rowsOfSearchList).removeClass("hide"):tableObj.append('<tr id="emptyMsg"><td colspan="4" class="text-center">'+ZPI18N.getString("zp.norecfound")+"</td></tr>"),pageContent.find("span#zohoMailUserCnt").text(rowsOfSearchList.length)})},User.AddUser.getGAppsUsers=function(){ZPeople.Request.send("/users/getGAppsUsers",{method:"getGAppsUsersNewUI"},User.AddUser.handleResponseOfgetGAppsUsers)},User.AddUser.handleResponseOfgetGAppsUsers=function(resultDataObject){if(ZPSetupCommon.isEmpty(resultDataObject.ERROR)){var pageContent=Layout.Page.container.find("div#dvGappUsr");openPopUp("a.dvGappUsr");var gAppRowListElm="",tableBodyContent=pageContent.find("table#zohoMailUsers tbody");tableBodyContent.find("tr").remove();var gAppsUsersCnt=0,tableHeaderCont=pageContent.find("table#zohoMailUsers thead");pageContent.find("div#no_recfound_img").remove(),$("#dvGappUsr").find("#importUsrs").removeClass("disabled"),pageContent.find("h6#exampleModalLabel").text(ZPI18N.getString("zp.importfromgapps")),ZPSetupCommon.isEmpty(resultDataObject.ERROR)?(void 0!==resultDataObject.SUCCESS&&(gAppsUsersCnt=Object.keys(resultDataObject.SUCCESS).length,$.each(resultDataObject.SUCCESS,function(index,gAppsUsersDtls){gAppRowListElm+=User.AddUser.createZohoAndGappsUserListElm(gAppsUsersDtls.user,gAppsUsersDtls.emailId,null)})),0===gAppsUsersCnt&&(gAppRowListElm+=User.noRecFoundElms),tableBodyContent.html(gAppRowListElm)):(resultDataObject.ERROR!==ZPI18N.getString("zp.norec")&&ZPeople.Message.showFailureMsg(resultDataObject.ERROR),tableBodyContent.append(User.noRecFoundElms),gAppsUsersCnt=0),0===gAppsUsersCnt?(pageContent.find("div[name = 'import_optns']").addClass("DN"),pageContent.find("div#body_cont").removeClass("dvImportpop"),pageContent.find("table#zohoMailUsers thead").addClass("DN")):(tableHeaderCont.removeClass("DN"),pageContent.find("inpu#massChecked").prop("checked",!1),pageContent.find("div[name = 'import_optns']").removeClass("DN"),pageContent.find("div#body_cont").addClass("dvImportpop")),pageContent.find("div#selected_userscnt").addClass("DN"),pageContent.find("div#total_userscnt").removeClass("DN"),pageContent.find("span#zohoMailUserCnt").text(gAppsUsersCnt),User.updateLicenseCountDetails(resultDataObject)}else resultDataObject.ERROR!==ZPI18N.getString("zp.norec")&&ZPeople.Message.showFailureMsg(resultDataObject.ERROR)},User.AddUser.createZohoAndGappsUserListElm=function(dispName,emailId,photo){var emailIdsCol=jQuery("<td />",{id:"userPhotoColm"}),emailIdsElm=jQuery("<div />",{class:"FL ML15",id:"dispNameDiv"}).append(jQuery("<div />",{text:emailId})),dispNameColm=jQuery("<div />",{class:"lnk ZPbold",text:dispName}),userPhotoElm=jQuery("<div />",{class:"PR FL"}).append(jQuery("<img />",{width:"40",height:"40",class:"img-circle FL",src:photo})).append(jQuery("<span />",{class:""}));ZPSetupCommon.isEmpty(photo)||($(emailIdsCol).append(userPhotoElm),$(dispNameColm).append(jQuery("<a />",{text:dispName}))),$(emailIdsCol).append(emailIdsElm);var zohoAndGappsUserListElm="<tr>";return zohoAndGappsUserListElm+="<td class='text-center'><div class='checkbox checkbox-primary DI ML10'><input type='checkbox' id='userListCheckBox' onchange='User.zohoUsersTickCheckBoxes(this,this.id)' value="+emailId+" /><label></label></div></td>",zohoAndGappsUserListElm+="<td id='userPhotoColm'>",null!=photo&&(zohoAndGappsUserListElm+="<div class='PR FL'><img width='40' height='40' class='img-circle FL' src='"+photo+"' />"),zohoAndGappsUserListElm+="</div>",zohoAndGappsUserListElm+="<div class='FL ML15' id='dispNameDiv'><a class='lnk ZPbold'>"+dispName+"</a><div class='lblmail'>"+emailId+"</div></div>",zohoAndGappsUserListElm+="</td>",zohoAndGappsUserListElm+="<td></td>",zohoAndGappsUserListElm+="</tr>"},User.AddUser.modifyUserList=function(data,params,event){User.isScrollEventFired=!1;var pageContent=Layout.Page.container,currPage=Layout.Page.currentmode.split("/")[2],currentUserListStatus=pageContent.find("select#accStatusDtls").val();if(pageContent.find("table#userListTable").attr("status",currentUserListStatus),pageContent.find("a#userCount").html("#").removeClass("hide"),pageContent.find("span#totalusersCnt").addClass("hide"),User.setCurrentFilterValues(data),data.paymentErr&&(ZPeople.Message.showFailureMsg(data.paymentErr),User.animatePopUpOut()),User.endOfPage=User.isScrollEnd(),null!=data.usersDtls&&void 0!=data.usersDtls){User.disperr=" ";var usersCount=Object.keys(data.usersDtls).length;pageContent.data({userCnt:usersCount});var totalUsersCnt=parseInt(pageContent.data("totalUsersCount"));pageContent.find("tr#emptyRow").remove(),data.empType=params.userType,User.endOfPage&&"scroll"===event?(pageContent.data({totalUsersCount:totalUsersCnt+usersCount}),totalUsersCnt+=usersCount,$(pageContent).find("table#userListTable tbody").append(User.constructUserListRows(data,"scroll")),pageContent.find("input#massCheckBox").is(":checked")&&pageContent.find("input[name='userRowCheck']").prop("checked",!0)):"scroll"!==event&&(totalUsersCnt=Object.keys(data.usersDtls).length,pageContent.find("table#userListTable tbody").html(""),pageContent.find("table#userListTable tbody").html(User.constructUserListRows(data)),pageContent.find("div#licenseDtlsRow").removeClass("DN"),pageContent.find("div#usersOptions").addClass("DN"),pageContent.find("input#massCheckBox,input[name='userRowCheck']").prop("checked",!1),User.endOfPage=!1),$(".ZPtitle").tooltip(),pageContent.find("span#userCnt").text(usersCount);var userStatus=params.userStatus;"0"===userStatus||"-3"===userStatus?pageContent.find("table#userListTable thead th[name='dateOfExit']").removeClass("DN"):pageContent.find("table#userListTable thead th[name='dateOfExit']").addClass("DN"),pageContent.find("span#userCnt").text(totalUsersCnt),pageContent.find("table#userListTable").data({startInd:data.startInd}),pageContent.find("select#locationsDtls option[value='"+data.usersDtls.LOCATION+"']").text(),"employeeprofile"===currPage&&User.setNonUsersDataInEachRowOfUsersList(data),User.animatePopUpOut(),"#admin/dashboard"===Layout.Page.hash&&(window.location.href="#admin/employeerecords/user"),$("div.orgivRed").remove()}else{if(!ZPSetupCommon.isEmpty(data.noOrgAdmin))return void ZPeople.Message.showFailureMsg(data.noOrgAdmin);ZPSetupCommon.isEmpty(data.error)?$.each(data,function(emailId,errorObj){if("isErrorFound"!==emailId){var getErrorObj=data[emailId],parentObj=$("input[emailId='"+emailId+"']").parent();parentObj.addClass("has-error"),ZPSetupCommon.showErr(getErrorObj.emailIdParentElm,parentObj,"dverrormsg"),$("input[emailId='"+emailId+"']").attr("emailErr","true")}}):$.each(data.error,function(key,errMsg){if("notAllowed"!==key){var errorDiv=$("div#"+key).find("div[name='errDiv']");errorDiv.addClass("has-error"),"empIdErr"!==key&&"empLocAuthErr"!==key?ZPSetupCommon.showErr(errMsg,errorDiv,"dverrormsg"):"empLocAuthErr"==key?ZPeople.Message.showFailureMsg(data.error[key]):jQuery("<div/>",{class:"dverrormsg",id:"empId",text:errMsg}).insertBefore(pageId.find("div#lastEMpId"))}else ZPeople.Message.showFailureMsg(data.error[key])}),User.isAllowToAddUser=data.isAllowToAddEmployee}User.lastEmployeeId=data.lastEmployeeId;data.filterStatus;pageContent.find("div#lastEMpId").find("span").text(data.lastEmployeeId),pageContent.find("span#dispUsersCount").text(User.totalUsersCount)},User.setCurrentFilterValues=function(data,isFromFilter){var pageId=Layout.Page.container,isFilterChanged=!1,filterSearch=Layout.Page.container.find("#searcFilter").val(),filterStatus=Layout.Page.container.find("#accStatusDtls").val(),filterLoc=Layout.Page.container.find("#locationsDtls").val(),filterDept=Layout.Page.container.find("#deptDtls").val(),filterRole=Layout.Page.container.find("#rolesDtls").val(),filterEmpStatus=Layout.Page.container.find("#empStatusDtls").val(),filterOnbStatus=Layout.Page.container.find("#onbStatusDtls").val(),searchVal="",deptVal="0",roleVal="0",locationVal="0",empStatus="All Status",searchByEmpStatus="All Status",searchByOnbStatus="-1";void 0!=data&&null!=data&&(ZPSetupCommon.isEmpty(data.searchVal)||(searchVal=User.searchVal=data.searchVal),ZPSetupCommon.isEmpty(data.deptVal)||(deptVal=data.deptVal,User.variables[User.currMode].filterParams.searchByDept="0"==deptVal?null:deptVal),ZPSetupCommon.isEmpty(data.roleVal)||(roleVal=data.roleVal,User.variables[User.currMode].filterParams.searchByRole="0"==roleVal?null:roleVal),ZPSetupCommon.isEmpty(data.locationVal)||(locationVal=data.locationVal,User.variables[User.currMode].filterParams.searchByLoc="0"==locationVal?null:locationVal),ZPSetupCommon.isEmpty(data.userStatus)||(empStatus=User.variables[User.currMode].filterParams.userStatus=data.userStatus),ZPSetupCommon.isEmpty(data.searchByOnbStatus)||(searchByOnbStatus=data.searchByOnbStatus),ZPSetupCommon.isEmpty(data.searchByEmpStatus)||(searchByEmpStatus=User.variables[User.currMode].filterParams.searchByEmpStatus=data.searchByEmpStatus)),pageId.find("table#userListTable").data({searchval:searchVal,dept:deptVal,role:roleVal,location:locationVal,status:empStatus,employeeStatus:searchByEmpStatus,onboardingstatus:searchByOnbStatus}),searchVal!=filterSearch&&(pageId.find("#searcFilter").html(searchVal),isFilterChanged=!0),roleVal!=filterRole&&(pageId.find("select#rolesDtls").val(roleVal),isFilterChanged=!0),deptVal!=filterDept&&(pageId.find("select#deptDtls").val(deptVal),isFilterChanged=!0),locationVal!=filterLoc&&(pageId.find("select#locationsDtls").val(locationVal),isFilterChanged=!0),empStatus!=filterStatus&&(pageId.find("select#accStatusDtls").val(empStatus),isFilterChanged=!0,"0"===empStatus||"-3"===empStatus?pageId.find("table#userListTable thead th[name='dateOfExit']").removeClass("DN"):pageId.find("table#userListTable thead th[name='dateOfExit']").addClass("DN"),pageId.find("table#userListTable").attr("status",empStatus)),"user"===User.currMode&&searchByEmpStatus!=filterEmpStatus&&(pageId.find("select#empStatusDtls").val(searchByEmpStatus),isFilterChanged=!0),"user"===User.currMode&&filterOnbStatus!=searchByOnbStatus&&(pageId.find("select#onbStatusDtls").val(searchByOnbStatus),isFilterChanged=!0),pageId.find("select#deptDtls,select#rolesDtls,select#locationsDtls,select#accStatusDtls,select#empStatusDtls,select#onbStatusDtls").select2(),1!=isFilterChanged||Layout.Page.container.find("#filterIcon").hasClass("active")||pageId.find("#filterIcon").click(),isFromFilter&&pageId.find("#usrListSubmit1").click()},User.zohoUsersTickCheckBoxes=function(obj,id,isGappsUsers){var zohoMailUserListTableObj,pageId=$(obj).closest("div[name='userPopup']");if(zohoMailUserListTableObj=pageId.find("table#zohoMailUsers tbody"),"massChecked"===id){var checkBox=zohoMailUserListTableObj.find("input[type=checkbox]:visible");$(checkBox).prop("checked",!!$(obj).is(":checked"))}else{var usersCheckBox=zohoMailUserListTableObj.find("input[type=checkbox]:not(:checked)");pageId.find("#massChecked").prop("checked",0===usersCheckBox.length)}var selectedItemsCnt=zohoMailUserListTableObj.find("input[id=userListCheckBox]:checked").length;zohoMailUserListTableObj.find("input[id=userListCheckBox]:checked").closest("tr").addClass("active"),zohoMailUserListTableObj.find("input[id=userListCheckBox]:not(:checked)").closest("tr").removeClass("active"),pageId.find("div#selected_userscnt").removeClass("DN").find("span").text(selectedItemsCnt),selectedItemsCnt>0?pageId.find("div#total_userscnt").addClass("DN"):pageId.find("div#total_userscnt,div#selected_userscnt").toggleClass("DN")},User.importZohoUsers=function(isMicrosoftUsers,isEnabledNotify){var pageId=Layout.Page.container,zohoMailUsersListObj=pageId.find("table#zohoMailUsers tbody");if(zohoMailUsersListObj.find("input[type=checkbox]:checked").length>parseInt(zohoMailUsersListObj.attr("balanceUser")))ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.paymenterr"));else{var mailIds=zohoMailUsersListObj.find("input:checked").map(function(){return this.value}).get().join(","),mailArrList=[],nameArrList=[];if(isMicrosoftUsers){var mailSplit=mailIds.split(",");$.each(mailSplit,function(index,value){mailArrList.push(value)}),nameArrList=zohoMailUsersListObj.find("input:checked").map(function(){return this.name}).get()}if(0!==mailIds.length){if(!isEnabledNotify){var modaBoxDiv=$(AutomationCommon.getActionMapModalHtml()).attr("id","popUpAlertNotify");pageId.find("#popUpAlertDiv").html(modaBoxDiv),$(modaBoxDiv).setModal({header:ZPI18N.getString("zp.orgnotifytitle"),buttonname:ZPI18N.getString("zp.ok"),subheader:ZPI18N.getString("zp.orgnotifyalertmsg")})}var url=isMicrosoftUsers?"importOffice365Users.zp":"/users/importZohoUsers",params=isMicrosoftUsers?{mode:"importOfficeUser"}:{method:"importZohoUsers"};if(params.mailIds=isMicrosoftUsers?JSON.stringify(mailArrList):mailIds,isMicrosoftUsers)if(params.dispName=JSON.stringify(nameArrList),isEnabledNotify){ZPeople.confirm(null,"","Do you want to notify employees' by mail?",null,!1,!0);var alertDiv=$("#confirmConfirmationPopup").text("Yes"),cancelDiv=$("#cancelConfirmationPopup").text("No");$(alertDiv).off(),$(cancelDiv).off(),$(alertDiv).on("click",function(){params.mailToNotifyUsers=!0,ZPeople.Request.send(url,params,User.AddUser.migrateUsersAction)}),$(cancelDiv).on("click",function(){params.mailToNotifyUsers=!1,ZPeople.Request.send(url,params,User.AddUser.migrateUsersAction)})}else ZPeople.Request.send(url,params,User.AddUser.migrateUsersAction);else ZPeople.Request.send(url,params,User.importZohoUserAndGAppsUsersUpdate);pageId.find("#importUsrs").addClass("disabled")}}},User.importGappUsers=function(){Layout.Page.container;var mailIds=$("table#zohoMailUsers tbody").find("input:checked").map(function(){return this.value}).get().join(",");mailIds.length>0&&mailIds.length<=1e3&&(ZPeople.Request.send("/users/importGAppsUsers",{method:"getImportGAppsUsersNewUI",mailIds:mailIds},User.AddUser.migrateUsersAction),$("#dvGappUsr").find("#importUsrs").addClass("disabled"))},User.importZohoUserAndGAppsUsersUpdate=function(resultObject){if(Layout.Page.container.find("div#dvImportUsr").find("#importUsrs").removeClass("disabled"),resultObject.hasOwnProperty("ERROR")&&!ZPSetupCommon.isEmpty(resultObject.ERROR.userAddError)){var unknownErrorMsgToBeDisplayed="",dcErrorMsgToBeDisplayed="";"UNKNOWN_ERROR"==resultObject.ERROR.userAddError[0].errorMsg?unknownErrorMsgToBeDisplayed=ZPI18N.getString("zp.userAdd.exceptionMsg",[ZPeople.peopleSupportEmail])+"-":"Z112"==resultObject.ERROR.userAddError[0].errorMsg&&(dcErrorMsgToBeDisplayed=ZPI18N.getString("zp.dcinviteerror",[ZPeople.peopleSupportEmail])+"-"),$.each(resultObject.ERROR.userAddError,function(index,value){"Z112"==value.errorMsg?dcErrorMsgToBeDisplayed+=value.errorMailIds+" ":"UNKNOWN_ERROR"==value.errorMsg&&(unknownErrorMsgToBeDisplayed+=value.errorMailIds+" ")}),ZPeople.Message.showFailureMsg(unknownErrorMsgToBeDisplayed+dcErrorMsgToBeDisplayed)}else ZPSetupCommon.isEmpty(resultObject.ERROR)?User.ListUsers.getUserList():ZPeople.Message.showFailureMsg(resultObject.ERROR)},User.userListfireScroll=function(thisObj,numberOfRows){User.isScrollEnd()&&User.userListScrollEvent("scroll",numberOfRows)},User.constructUsersList=function(data){var pageId=$("#"+Layout.Page.pageId),showExitHeader="0"===data.userStatus||"-3"===data.userStatus?"":"DN",isUser=data.empType!=User.NonUserType,headerRow="<table class='table table-hover userdataTables table-responsive' id='userListTable' formId='"+data.formId+"'>";return headerRow+="<thead>",headerRow+="<tr>",headerRow+='<th width="3%" class="text-right">',headerRow+='<div class="checkbox checkbox-primary">',headerRow+='<input type="checkbox" onchange="User.AddUser.switchResendMassupdate(this);" id="massCheckBox">',headerRow+='<label for="massCheckBox"></label>',headerRow+="</div>",headerRow+="</th>",headerRow+='<th width="33%"><span class="CP" id="sortByname" onclick="User.ListUsers.getSortedUser(this)" sortType="0_1">'+ZPI18N.getString("zp.basicinfo")+'<b class="IC-l-ar-dwn S13 ML5"></b></span></th>',headerRow+='<th width="12%"><span class="CP" id="sortBydate" onclick="User.ListUsers.getSortedUser(this)" sortType="3_0">'+ZPI18N.getString("zp.dateofjoining")+'<b class="IC-l-ar-dwn S13 ML5"></b></span></th>',headerRow+='<th width="'+(isUser?7:12)+'%" class = "'+showExitHeader+'" name="dateOfExit"><span class="CP" id="sortByExitdate" onclick="User.ListUsers.getSortedUser(this)" sortType="4_0">'+ZPI18N.getString("zp.dateofexit")+'<b class="IC-l-ar-dwn S13 ML5"></b></span></th>',headerRow+='<th width="'+(isUser?10:16)+'%"><span>'+ZPI18N.getString("zp.userroles")+"</span></th>",headerRow+='<th width="'+(isUser?9:10)+'%"><span>'+ZPI18N.getString("zp.location")+"</span></th>",headerRow+='<th width="10%"><span>'+ZPI18N.getString("zp.employeestatus")+"</span></th>",isUser&&(headerRow+='<th width="9%"><span>'+ZPI18N.getString("zp.accountStatus")+"</span></th>"),headerRow+='<th width="'+(isUser?12:15)+'%"><span>'+ZPI18N.getString("zp.actions")+"</span></th>",headerRow+="</tr></thead>",headerRow+=User.constructUserListRows(data),headerRow+="</table>",Layout.usersCount=Object.keys(data.usersDtls).length,$(pageId).find("span#dispUsersCount").text(Layout.usersCount),headerRow},User.setNonUsersDataInEachRowOfUsersList=function(data){var pageContent=$("#"+Layout.Page.pageId);$.each(data.usersDtls,function(index,obj){"-2"!==obj.LOGINSTATUS&&"-6"!==obj.LOGINSTATUS||$(pageContent).find("table#userListTable tbody").find("tr[empErecNo='"+obj.ERECNO+"']").data({employeeId:ZPeople.decodeTxt(obj.EMPLOYEEID),empMailAlias:obj.EMPLOYEEMAILALIAS,empFname:ZPeople.decodeTxt(obj.EMPLOYEEFIRSTNAME),empLname:ZPeople.decodeTxt(obj.EMPLOYEELASTNAME)})})},User.userRelatedFunction=function(resultData){var pageContent=$("#"+Layout.Page.pageId),filterBoxes=(Layout.Page.currentmode.split("/")[2],{rolesDtls:ZPI18N.getString("zp.allroles"),deptDtls:ZPI18N.getString("zp.alldepartment"),locationsDtls:ZPI18N.getString("zp.alllocaction"),empStatusDtls:ZPI18N.getString("zp.allstatus")});$.each(filterBoxes,function(id,val){var constructFilterOptn="";constructFilterOptn+="empStatusDtls"===id?"<option value='"+val+"'>"+val+"</option>":"<option value=0>"+val+"</option>",$.each(resultData[id],function(erecId,obj){"rolesDtls"===id?constructFilterOptn+="<option value='"+obj.roleId+"'>"+obj.roleName+"</option>":"deptDtls"===id?constructFilterOptn+="<option value='"+obj.DEPARTMENTID+"'>"+obj.DEPARTMENTNAME+"</option>":"locationsDtls"===id?constructFilterOptn+="<option value='"+obj.LOCATIONID+"'>"+obj.LOCATIONNAME+"</option>":"empStatusDtls"===id&&(constructFilterOptn+="<option value='"+obj+"'>"+obj+"</option>")}),$(pageContent).find("select#"+id).html(constructFilterOptn)})},User.AddUser.switchResendMassupdate=function(obj){var pageContent=Layout.Page.container;if("massCheckBox"===obj.id){var checkBoxes=$(pageContent).find("table#userListTable tbody").find("input[name='userRowCheck']");pageContent.find("input#massCheckBox").is(":checked")?(checkBoxes.prop("checked",!0),0!==pageContent.find("table#userListTable tbody tr").find("input[name='userRowCheck']:checked").length&&(pageContent.find("div#usersOptions").removeClass("DN"),ZPOnboarding.isOnboarding&&(pageContent.find("div#enableOnboarding").removeClass("DN"),pageContent.find("div#enableOnboarding").addClass("DIB")),pageContent.find("div#licenseDtlsRow").addClass("DN")),pageContent.find("div#dispUserCntTitle").addClass("DN"),User.disableFilter()):(checkBoxes.prop("checked",!1),pageContent.find("div#usersOptions").addClass("DN"),pageContent.find("div#resendInvite,div#enableOnboarding").addClass("DN"),pageContent.find("div#dispUserCntTitle,div#licenseDtlsRow").removeClass("DN")),0!==$(pageContent).find("table#userListTable tbody").find("input[loginstatus=2]:checked").length?pageContent.find("div#resendInvite").fadeIn():pageContent.find("div#resendInvite").hide()}else 0!==pageContent.find("table#userListTable tbody tr").find("input[name='userRowCheck']:checked").length?(pageContent.find("div#usersOptions").removeClass("DN"),ZPOnboarding.isOnboarding&&(pageContent.find("div#enableOnboarding").removeClass("DN"),pageContent.find("div#enableOnboarding").addClass("DIB")),pageContent.find("div#licenseDtlsRow").addClass("DN"),0===$(pageContent).find("table#userListTable tbody").find("input[loginstatus='2']:checked").length?pageContent.find("div#resendInvite").hide():(pageContent.find("div#dispUserCntTitle").addClass("DN"),0!==pageContent.find("table#userListTable tbody").find("input[loginstatus='2']:checked").length?pageContent.find("div#resendInvite").fadeIn():pageContent.find("div#resendInvite").hide()),User.disableFilter()):(pageContent.find("div#usersOptions").addClass("DN"),pageContent.find("div#resendInvite,div#enableOnboarding").addClass("DN"),$("div#dispUserCntTitle,div#licenseDtlsRow").removeClass("DN")),$(obj).is(":checked")?$(obj).closest("tr").attr("class","active"):$(obj).closest("tr").attr("class",""),0===pageContent.find("table#userListTable tbody").find("input[name='userRowCheck']").not(":checked").length?pageContent.find("input#massCheckBox").prop("checked",!0):pageContent.find("input#massCheckBox").prop("checked",!1)},User.disableFilter=function(){var pageContent=Layout.Page.container;Layout.Page.currentmode.split("/")[2];pageContent.removeClass("open"),pageContent.find("#filterIcon").hasClass("active")&&pageContent.find("#filterIcon").click(),pageContent.find("div#filterIcon").removeClass("active")},User.constructEmpEmailIdRows=function(event,domainsObj,locationObj){var isAddedByClick="click"===event,addMultiUserOptns='<tr isAddedByClick="'+isAddedByClick+'" style="display:none">';return addMultiUserOptns+='<td><input type="text" class="form-control" name="emailId">',addMultiUserOptns+='<div class="dverrormsg"></div></td>',addMultiUserOptns+='<td><span class="DI MR5">@</span>',addMultiUserOptns+='<select style="width:160px" name="domain">',"string"!=typeof domainsObj?$.each(domainsObj,function(index,domain){addMultiUserOptns+='<option value="'+domain.ORG_DOMAIN+'">'+domain.ORG_DOMAIN+"</option>"}):addMultiUserOptns+="<option>"+domainsObj+"</option>",addMultiUserOptns+="</select></td>",User.toggleAGPforMulUsrsDir?addMultiUserOptns+='<td class="hide"><input type="text" class="form-control" name="password"></td>':addMultiUserOptns+='<td><input type="text" class="form-control" name="password"></td>',void 0!==locationObj&&(addMultiUserOptns+='<td style="width:160px"> <select  class="" name="location">',$.each(locationObj,function(index,location){var key=Object.keys(location)[0];addMultiUserOptns+='<option value="'+key+'">'+location[key]+"</option>"}),addMultiUserOptns+="</select></td>"),isAddedByClick&&(addMultiUserOptns+='<td width=""><div class="dvlist-action MT5" id = "removeIc"><a title="" class="IC-remove red MR10" data-original-title="Remove" onclick=$(this).closest("tr").fadeOut("slow",function(){this.remove()})></a><a class="IC-plus-round grn S16 " onclick="User.addEmailIdRows(this)"></a></div></td>'),addMultiUserOptns+="<td></td></tr>"},User.addEmailIdRows=function(thisObj){var newAddUserRow=$(User.constructEmpEmailIdRows("click",$(thisObj).closest("table").data("domains"),$(thisObj).closest("table").data("locations")));newAddUserRow.insertAfter($(thisObj).closest("tbody").find("tr").last()).fadeIn("slow"),newAddUserRow.find("select[name='domain']").select2(),newAddUserRow.find("select[name='location']").select2()},User.bulkResendInvitation=function(){var pageContent=$("#"+Layout.Page.pageId),erecNoDigObj={};$.each($(pageContent).find("table#userListTable tbody").find("tr[status='2'] input[name='userRowCheck']:checked"),function(index,elm){var empErecNo=$(elm).closest("tr").attr("empErecNo"),digest=$(elm).closest("tr").attr("digest");erecNoDigObj["erecno"+empErecNo]=empErecNo,erecNoDigObj["digest"+empErecNo]=digest}),erecNoDigObj=JSON.stringify(erecNoDigObj),[].push(erecNoDigObj),ZPeople.Request.send("/users/bulkResendInvitation",{conreqcsr:csrfToken,erecAndDigestObj:erecNoDigObj},User.resendResponse,!0)},User.AddUser.changeSearchType=function(clickObj,searchType){var pageContent=$("#"+Layout.Page.pageId);$(pageContent).find("ul#searchMenu").find("a").removeClass("active"),$(clickObj).find("a").addClass("active"),Layout.searchType=User.searchType=searchType},User.animatePopUpOut=function(){var pageId=Layout.Page.container;pageId.find("div[name=userPopup]").modal("hide"),pageId.find("div#addEmp").modal("hide")},User.filterChanges=function(thisObj){var pageId=Layout.Page.container,currMode=Layout.Page.pageId.split("-")[2];pageId.find("div#dvFiltersec"+currMode);pageId.hasClass("filter-wrap")?(pageId.removeClass("filter-wrap"),$(thisObj).removeClass("active")):(pageId.addClass("filter-wrap"),$(thisObj).addClass("active"))},User.listLoginEnabledUsers=function(thisObj){$(thisObj).css({"pointer-events":"none"}),ZPeople.Request.send("/getLoginEnabledUsers.zp",{method:"getLoginEnabledUsersTOchangeSAdmin",conreqcsr:csrfToken},User.handleLoginUsrs)},User.handleLoginUsrs=function(dataObj,params,needToChangeToSadmin,erecNumber){var pageId=Layout.Page.container;pageId.find("select#users_list").remove();var transferClickObj=pageId.find("a#disp_loginen_users");transferClickObj.removeAttr("style");var adminDtlsList=pageId.find("select[updateKey=superadmin]");if(ZPSetupCommon.isEmpty(dataObj.servererr))if(needToChangeToSadmin)dataObj.isSuccess&&(-1===dataObj.infomsg.indexOf("success")&&ZPeople.Message.showWarningMsg(dataObj.infomsg),pageId.find("select#users_list").select2(),adminDtlsList.find("option[selected='selected']").prop("selected",!1),adminDtlsList.append("<option selected='selected' value='"+params.erecno+"'>"+dataObj.superadminMailId+"</option>"),adminDtlsList.val(params.erecno),adminDtlsList.select2(),pageId.find("div#superadmin").text(dataObj.superadminMailId),User.hideAdminRightsOption());else if(ZPSetupCommon.isEmpty(dataObj.error)){var usersDropDownbox="";usersDropDownbox+="<div class='dvedit-field col-md-5 ML10' id='loginusers_ist'><select onchange='' id='users_list'>",$.each(dataObj,function(erecNo,dispName){usersDropDownbox+="<option value='"+erecNo+"'>"+dispName+"</option>"});usersDropDownbox+="</select></div><a onclick=ZPeople.confirm(null,'','zp.changeadminrightsconfmsg',User.usersChangeToSAdmin) data-original-title='"+ZPI18N.getString("zp.clicktotransferadminrights")+"' class='IC-tick S21 grn MR15 FL MT2 CP ML10 ' id='transfer_rights' data-toggle='tooltip' data-placement='top' title=''></a><a onclick='User.hideAdminRightsOption()' class='IC-cls S16 red MT5 CP FL' id='cls_rights' data-toggle='tooltip' data-placement='top' title=''></a>",$(usersDropDownbox).insertAfter(pageId.find("div#superadmin").parent()),pageId.find("select#users_list").select2(),transferClickObj.addClass("DN"),adminDtlsList.parent().addClass("hide")}else ZPeople.Message.showWarningMsg(dataObj.error);else ZPeople.Message.showFailureMsg(dataObj.error)},User.usersChangeToSAdmin=function(){var erecNo=Layout.Page.container.find("select#users_list").val();ZPeople.Request.send("/getLoginEnabledUsers.zp",{erecno:erecNo,method:"getLoginEnabledUsersTOchangeSAdmin",conreqcsr:csrfToken},User.handleLoginUsrs,!0,erecNo)},User.hideAdminRightsOption=function(){var pageId=Layout.Page.container;pageId.find("a#transfer_rights,a#cls_rights").remove(),pageId.find("div#loginusers_ist").remove(),pageId.find("a#disp_loginen_users").removeClass("DN"),pageId.find("a#cls_rights").removeAttr("title"),pageId.find("select[updateKey=superadmin]").parent().removeClass("hide")},User.niceLocation=function(mode,recId,formId){if("add"==mode&&(formActUrl="#admin/organization/locations/add",window.location.href=formActUrl),"edit"==mode){var formActUrl="#admin/organization/locations/edit/"+recId;window.location.href=formActUrl}"view"==mode&&(window.location.href="#admin/organization/locations/view/"+recId)},User.togglePhone=function(){if(User.isInviteMode&&User.ALLOW_MOBILEUSER_ADDITION){var emailtxt=$("#disabledEmailId").val().trim();User.validation("number",emailtxt)&&emailtxt.length>2?($("#mobMail").addClass("zprt-labelNum"),$("#mobMail > select").removeClass("DN"),$("#mobMail > div").removeClass("DN"),User.isMobile=!0):($("#mobMail").removeClass("zprt-labelNum"),$("#mobMail > select").addClass("DN"),$("#mobMail > div").addClass("DN"),User.isMobile=!1)}},User.validation=function(mode,str){if("mailId"==mode){if(!str)return!1;var objRegExp=new XRegExp("^[\\p{L}\\p{N}\\p{M}\\_]([\\p{L}\\p{N}\\p{M}\\_\\+\\-\\.\\'\\&]*)@(?=.{4,256}$)(([\\p{L}\\p{N}\\p{M}]+)(([\\-\\_]*[\\p{L}\\p{N}\\p{M}])*)[\\.])+[\\p{L}\\p{M}]{2,22}$","i");return XRegExp.test(str.trim(),objRegExp)}if("userName"==mode){if(!str)return!1;objRegExp=new XRegExp("^[\\p{L}\\p{N}\\p{M}\\_\\.]+$","i");return XRegExp.test(str.trim(),objRegExp)}return"phoneNumber"==mode?!!str&&(str=str.replace(/[+ \[\]\(\)\-\.\,]/g,""),(objRegExp=/^([0-9]{5,14})$/).test(str)):"number"==mode?!!str&&(str=str.replace(/[+ \[\]\(\)\-\.\,]/g,""),(objRegExp=/^[0-9]*$/).test(str)):void 0};var CompanySettings={paramNames:[],paramVals:[],error:null,sectionName:null,url:"/viewCompanySettings.zp",defaultPhotoUrl:"viewPhoto?filename=",orgDtlsObj:null,oldElmObj:null},Organization={ZP_PAGE_LOADING:'<div class="ctable" id="zp_page_loading"><div class="ctcell"><div class="loader-inner line-scale"><div></div><div></div><div></div><div></div><div></div></div></div></div>',Holiday:{url:"/holidayAction.zp"},Calendar:{url:"/calendarSettings.zp"},Location:{},cnameMappedUrl:"",showCnameOrTxt:!1,selectSingleDomain:void 0,canSendCname:!1,selectedIndustry:""};function emptyCheck(){var imagepath=$("input#importFileName").val();0==$("input#importFileName").val().length?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.selectimage")):CompanySettings.endsWith(imagepath,"jpg")||CompanySettings.endsWith(imagepath,"png")||CompanySettings.endsWith(imagepath,"gif")||CompanySettings.endsWith(imagepath,"jpeg")||CompanySettings.endsWith(imagepath,"JPG")||CompanySettings.endsWith(imagepath,"PNG")||CompanySettings.endsWith(imagepath,"GIF")||CompanySettings.endsWith(imagepath,"JPEG")?$("input#importFileName")[0].files[0].size<5e5?$("form#companyLogo").trigger("submit"):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.filesizeexceeded")):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.allowedimagetypes"))}CompanySettings.callBack=function(){var params={conreqcsr:csrfToken,method:"getCompanySettingsDetails",mode:"view"};Layout.Page.container.html(Organization.ZP_PAGE_LOADING),ZPeople.Request.send(CompanySettings.url,params,CompanySettings.iterateOrgDtls)},CompanySettings.iterateOrgDtls=function(resultData){var pageContent=$("div#admin-organization-companysettings-companydetails"),orgSettingDtls=resultData.orgSettingsDtls;pageContent.html(CompanySettings.constructViewPageOfOrgSetting(resultData)),CompanySettings.isAddrSectionEmpty()?pageContent.find("div#addrSection").addClass("DN"):pageContent.find("div#addrSection").removeClass("DN");var $logo=pageContent.find("div#companyLogo").find("img");ZPSetupCommon.isEmpty(orgSettingDtls.logo)?($logo.addClass("DN"),pageContent.find("#resetlogo").addClass("hide"),pageContent.find("div#companyLogo").find("span.nologo").removeClass("hide")):$logo.attr("src",orgSettingDtls.logo).removeClass("DN"),pageContent.find(".dvhelpover,[data-toggle=popover]").popover(),CompanySettings.setValuesFordropDownAndCheckBox(orgSettingDtls),(ZPSetupCommon.isEmpty(orgSettingDtls.companyName)||ZPSetupCommon.isEmpty(orgSettingDtls.superadmin))&&(pageContent.find("a#modify").trigger("click"),pageContent.find("a#orgSetCancel").addClass("DN")),pageContent.find("a#modify").on("click",function(){pageContent.find("a#orgSetCancel").removeClass("DN")}),pageContent.find(".selectBox").select2()},CompanySettings.constructViewPageOfOrgSetting=function(data){data.orgSettingsDtls;CompanySettings.orgDtlsObj=data.orgSettingsDtls;var orgSettingsFieldsObj='<div class="compsettings">';return orgSettingsFieldsObj+=CompanySettings.constructOrgLeftBar(data),orgSettingsFieldsObj+='<div class="orgrht">',orgSettingsFieldsObj+='<div class="clearfix mainhead">',orgSettingsFieldsObj+='<div class="zp-md-8">',orgSettingsFieldsObj+=ZPI18N.getString("zp.neworgnotes")+"</div>",orgSettingsFieldsObj+='<div class="zp-md-4 text-right">',orgSettingsFieldsObj+='<a class="btn-group pagetips gry" onclick="ZPeople.Help.show()"><span class="IC-qus"></span></a> ',orgSettingsFieldsObj+="</div></div>",orgSettingsFieldsObj+=CompanySettings.constructSuperadminDtls(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructOrgEmailSettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructLocaleSettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructDisplaySettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructPhotoSettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructSampleDataSettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructChatSettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructNotifySettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructOrgStructureSettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructEmployeeSettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructSearchSettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+=CompanySettings.constructBotSettings(CompanySettings.orgDtlsObj),orgSettingsFieldsObj+="</div>",orgSettingsFieldsObj+=CompanySettings.constructModifySettingsButton(),orgSettingsFieldsObj+="</div>",orgSettingsFieldsObj+=CompanySettings.constructCompanyLogoElms(CompanySettings.orgDtlsObj.logo),orgSettingsFieldsObj+="</div>"},CompanySettings.constructBotSettings=function(orgSettingDtls){var html="";if("CN"!=ZPeople.ZPDataCenter&&"cn"!=ZPeople.ZPDataCenter&&"JP"!=ZPeople.ZPDataCenter&&"en"==currLanguage){var dispName=ZPI18N.getString("zp.disable");1==orgSettingDtls.isBotEnabled&&(dispName=ZPI18N.getString("zp.enable")),html='<div class="bgwhite B0"> <h2 class="ZPbold">Bot Settings<a data-content="Bot will be displayed and can be used only by user having language as english" data-trigger="hover" data-toggle="popover" role="button" data-placement="right" name="fieldToolTip" class="IC-info S15 ML10 dvhelpover" tabindex="0" data-original-title="" title=""></a></h2><div class="dvedit-row"><label class="lbltxt">Bot</label><div class="dvedit-field col-md-5"><div class="spnfield" name="displayvalue" id="botendisable">'+dispName+'</div><div class="DN" name="editable" oldval="'+orgSettingDtls.isBotEnabled+'" disp="radioType"><div class="radio DIB MR10"><input type="radio" updatekey="botendisable" name="botendisable" value="false" id="botendisabledis"><label id="botendisablefalse" for="botendisabledis">Disable</label></div><div class="radio DIB MR10"><input type="radio" updatekey="botendisable" name="botendisable" value="true" id="botendisableen"><label id="botendisabletrue" for="botendisableen">Enable</label></div></div></div></div></div>'}return html},CompanySettings.constructOrgStructureSettings=function(orgSettingDtls){var orgStructureFiled="";return orgStructureFiled+='<div class="bgwhite B0">',orgStructureFiled+='<h2 class="ZPbold">'+ZPI18N.getString("zp.generalsettingheader"),orgStructureFiled+='<a data-content="'+ZPI18N.getString("zp.orgstructureenableinfo")+'" data-trigger="hover" data-toggle="popover" role="button" data-placement="right" name="fieldToolTip" class="IC-info S15 ML10 dvhelpover DN" tabindex="0" data-original-title="" title=""></a></h2>',orgStructureFiled+='<div class="dvedit-row">',orgStructureFiled+='<label class="lbltxt">'+ZPI18N.getString("zp.orgstructure")+"</label>",orgStructureFiled+='<div class="dvedit-field zp-md-5">',orgStructureFiled+='<div class="" class="spnfield" name="displayvalue" id="orgstructure">',orgStructureFiled+="</div>",orgStructureFiled+='<div class="DN" name="editable" oldval = "'+orgSettingDtls.orgstructure+'" disp="radioType">',orgStructureFiled+='<div class="radio DIB MR10">',orgStructureFiled+='<input type="radio" updatekey="orgstructure" name="orgstructure" value="0" id="orgstructures0">',orgStructureFiled+='<label id="orgstructure0" for="orgstructures0">'+ZPI18N.getString("zp.disable")+"</label></div>",orgStructureFiled+='<div class="radio DIB MR10">',orgStructureFiled+='<input type="radio" updatekey="orgstructure" name="orgstructure" value="1" id="orgstructures1">',orgStructureFiled+='<label id="orgstructure1" for="orgstructures1">'+ZPI18N.getString("zp.enable")+"</label>",orgStructureFiled+="</div></div></div></div></div>"},CompanySettings.constructEmployeeSettings=function(orgSettingDtls){var empSettings='<div class="bgwhite B0"> <h2 class="ZPbold">'+ZPI18N.getString("zp.employeesettings")+'</h2><div class="dvedit-row"><label class="lbltxt">'+ZPI18N.getString("zp.DualReportingTo")+'</label><div class="dvedit-field col-md-5"><div class="spnfield" name="displayvalue" id="dualreport"></div><div class="DN" name="editable" oldval = "'+orgSettingDtls.dualreport+'" disp="radioType"><div class="radio DIB MR10"><input type="radio" updateKey="dualreport" name="dualreports" value="false" id="dualreportdis"><label id="dualreportfalse" for="dualreportdis">'+ZPI18N.getString("zp.disable")+'</label></div><div class="radio DIB MR10"><input type="radio" updateKey="dualreport" name="dualreports" value="true" id="dualreporten"><label id="dualreporttrue" for="dualreporten">'+ZPI18N.getString("zp.enable")+"</label></div></div></div></div>";return CompanySettings.orgDtlsObj.streamFormAvail&&(empSettings+='<div class="dvedit-row">',empSettings+='<label class="lbltxt">'+ZPI18N.getString("zp.streams")+"</label>",empSettings+='<div class="dvedit-field zp-md-5">',empSettings+='<div class="" class="spnfield" name="displayvalue" id="stream">',empSettings+="</div>",empSettings+='<div class="DN" name="editable" oldval = "'+orgSettingDtls.stream+'" disp="radioType">',empSettings+='<div class="radio DIB MR10">',empSettings+='<input type="radio" updatekey="stream" name="stream" value="0" id="streamr0">',empSettings+='<label id="stream0" for="streamr0">'+ZPI18N.getString("zp.disable")+"</label></div>",empSettings+='<div class="radio DIB MR10">',empSettings+='<input type="radio" updatekey="stream" name="stream" value="1" id="streamr1">',empSettings+='<label id="stream1" for="streamr1">'+ZPI18N.getString("zp.enable")+"</label>",empSettings+="</div></div></div></div>"),empSettings=CompanySettings.constructAnniversaryEmployeeSettings(orgSettingDtls,empSettings),empSettings+="</div>"},CompanySettings.constructSearchSettings=function(orgSettingDtls){var searchSettings='<div class="bgwhite B0">';return searchSettings+='<h2 class="ZPbold">'+ZPI18N.getString("zp.searchSettings")+"</h2>",searchSettings=CompanySettings.constructMobileEmployeeSettings(orgSettingDtls,searchSettings),searchSettings=CompanySettings.constructMobileSearchSettings(orgSettingDtls,searchSettings),searchSettings+="</div>"},CompanySettings.constructAnniversaryEmployeeSettings=function(orgSettingDtls,empSettings){var index;for(index=0;index<3;index++){var labelText,id,oldVal;if(0==index)labelText=ZPI18N.getString("zp.allowhidingbirthday"),id="isBirthdayHideAllowed",oldVal=orgSettingDtls.isBirthdayHideAllowed?"1":"0";else if(1==index&&null!=orgSettingDtls.isWorkAnnHideAllowed)labelText=ZPI18N.getString("zp.allowhidingworkann"),id="isWorkAnnHideAllowed",oldVal=orgSettingDtls.isWorkAnnHideAllowed?"1":"0";else{if(2!=index||null==orgSettingDtls.isWedAnnHideAllowed)continue;labelText=ZPI18N.getString("zp.allowhidingwedann"),id="isWedAnnHideAllowed",oldVal=orgSettingDtls.isWedAnnHideAllowed?"1":"0"}empSettings+='<div class="dvedit-row">',empSettings+='<label class="lbltxt PR10">'+labelText+"</label>",empSettings+='<div class="dvedit-field zp-md-5">',empSettings+='<div class="" class="spnfield" name="displayvalue" id="'+id+'">',empSettings+="</div>",empSettings+='<div class="DN" name="editable" oldval = "'+oldVal+'" disp="radioType">',empSettings+='<div class="radio DIB MR10">',empSettings+='<input type="radio" updatekey="'+id+'" name="'+id+'" value="0" id="'+id+'r0">',empSettings+='<label id="'+id+'0" for="'+id+'r0">'+ZPI18N.getString("zp.disable")+"</label></div>",empSettings+='<div class="radio DIB MR10">',empSettings+='<input type="radio" updatekey="'+id+'" name="'+id+'" value="1" id="'+id+'r1">',empSettings+='<label id="'+id+'1" for="'+id+'r1">'+ZPI18N.getString("zp.enable")+"</label>",empSettings+="</div></div></div></div>"}return empSettings},CompanySettings.constructMobileEmployeeSettings=function(orgSettingDtls,empSettings){var id="isMobileHideAllowed";return empSettings+='<div class="dvedit-row">',empSettings+='<label class="lbltxt PR10">'+ZPI18N.getString("zp.allowhidingmobile"),empSettings+="</label>",empSettings+='<div class="dvedit-field zp-md-5">',empSettings+='<div class="" class="spnfield" name="displayvalue" id="'+id+'">',empSettings+="</div>",empSettings+='<div class="DN" name="editable" oldval = "'+(orgSettingDtls.isMobileHideAllowed?"1":"0")+'" disp="radioType">',empSettings+='<div class="radio DIB MR10">',empSettings+='<input type="radio" updatekey="'+id+'" name="'+id+'" value="0" id="'+id+'r0">',empSettings+='<label id="'+id+'0" for="'+id+'r0">'+ZPI18N.getString("zp.disable")+"</label></div>",empSettings+='<div class="radio DIB MR10">',empSettings+='<input type="radio" updatekey="'+id+'" name="'+id+'" value="1" id="'+id+'r1">',empSettings+='<label id="'+id+'1" for="'+id+'r1">'+ZPI18N.getString("zp.enable")+"</label>",empSettings+="</div></div></div></div>"},CompanySettings.constructMobileSearchSettings=function(orgSettingDtls,empSettings){var id="isMobileSearchAllowed";return empSettings+='<div class="dvedit-row">',empSettings+='<label class="lbltxt PR10">'+ZPI18N.getString("zp.allowMobileInSearch"),empSettings+="</label>",empSettings+='<div class="dvedit-field zp-md-5">',empSettings+='<div class="" class="spnfield" name="displayvalue" id="'+id+'">',empSettings+="</div>",empSettings+='<div class="DN" name="editable" oldval = "'+(orgSettingDtls.isMobileSearchAllowed?"1":"0")+'" disp="radioType">',empSettings+='<div class="radio DIB MR10">',empSettings+='<input type="radio" updatekey="'+id+'" name="'+id+'" value="0" id="'+id+'r0">',empSettings+='<label id="'+id+'0" for="'+id+'r0">'+ZPI18N.getString("zp.disable")+"</label></div>",empSettings+='<div class="radio DIB MR10">',empSettings+='<input type="radio" updatekey="'+id+'" name="'+id+'" value="1" id="'+id+'r1">',empSettings+='<label id="'+id+'1" for="'+id+'r1">'+ZPI18N.getString("zp.enable")+"</label>",empSettings+="</div></div></div></div>"},CompanySettings.constructOrgEmailSettings=function(orgSettingDtls){var superAdminDtlsElm='<div class="bgwhite">';return superAdminDtlsElm+='<h2 class="ZPbold">'+ZPI18N.getString("zp.orgemailtitle"),superAdminDtlsElm+="</h2>",superAdminDtlsElm+='<div class="dvedit-row">',superAdminDtlsElm+='<label class="lbltxt ">'+ZPI18N.getString("zp.orgdefaultemail")+'<a data-content="'+ZPI18N.getString("zp.defaulfromaddrinfo")+'" data-toggle="popover" role="button" name="fieldToolTip" data-placement="right" class="IC-info ML5 gry DN" tabindex="0" data-original-title="" data-trigger="hover" title=""></a></label>',superAdminDtlsElm+='<div name="orgEmailDiv"><div class="dvedit-field zp-md-5">',superAdminDtlsElm+='<div class="spnfield" name="displayvalue"><span>'+ZSEC.Encoder.encodeForHTML(orgSettingDtls.ORG_EMAIL)+"</span></div>",superAdminDtlsElm+='<input maxlength="50"  value="'+orgSettingDtls.ORG_EMAIL+'" disabled="disabled"   placeholder="" class="form-control FL DN"  updateKey="orgEmail"></div>',superAdminDtlsElm+='<a onclick="window.open(\'#admin/organization/fromAddress\', \'_self\')"  class="IC-pen S14 ML10 MT8 FL gry DN" name="changeOrgEmail" id="changeOrgEmail" data-toggle="tooltip" data-placement="top" title="'+ZPI18N.getString("zp.changeorgemail")+'" ></a>',superAdminDtlsElm+="</div></div></div>"},CompanySettings.constructNotifySettings=function(orgSettingDtls){var notifySettingsFieldsObj="";return notifySettingsFieldsObj+='<div class="bgwhite B0">',notifySettingsFieldsObj+='<h2 class="ZPbold">'+ZPI18N.getString("zp.orgnotifyheading"),notifySettingsFieldsObj+='<a data-content="'+ZPI18N.getString("zp.orgnotifyinfo")+'" data-trigger="hover" data-toggle="popover" role="button" data-placement="right" name="fieldToolTip" class="IC-info S15 ML10 dvhelpover DN" tabindex="0" data-original-title="" title=""></a></h2>',notifySettingsFieldsObj+='<div class="dvedit-row">',notifySettingsFieldsObj+='<label class="lbltxt">'+ZPI18N.getString("zp.orgnotifyname")+"</label>",notifySettingsFieldsObj+='<div class="dvedit-field zp-md-5">',notifySettingsFieldsObj+='<div class="" class="spnfield" name="displayvalue" id="notify">',notifySettingsFieldsObj+="</div>",notifySettingsFieldsObj+='<div class="DN" name="editable" oldval = "'+orgSettingDtls.notify+'" disp="radioType">',notifySettingsFieldsObj+='<div class="radio DIB MR10">',notifySettingsFieldsObj+='<input type="radio" updatekey="notify" name="notify" value="0" id="orgNotify0">',notifySettingsFieldsObj+='<label id="notify0" for="orgNotify0">'+ZPI18N.getString("zp.disable")+"</label></div>",notifySettingsFieldsObj+='<div class="radio DIB MR10">',notifySettingsFieldsObj+='<input type="radio" updatekey="notify" name="notify" value="1" id="orgNotify1">',notifySettingsFieldsObj+='<label id="notify1" for="orgNotify1">'+ZPI18N.getString("zp.enable")+"</label>",notifySettingsFieldsObj+="</div></div></div></div></div>"},CompanySettings.constructSuperadminDtls=function(orgSettingDtls){var superAdminDtlsElm="";superAdminDtlsElm+='<div class="bgwhite">',superAdminDtlsElm+='<h2 class="ZPbold">'+ZPI18N.getString("zp.superadmin"),superAdminDtlsElm+='<a data-content="'+ZPI18N.getString("zp.superAdminDesc")+'" data-toggle="popover" role="button" name="fieldToolTip" data-placement="right" class="IC-info ML5 S15 dvhelpover DN" tabindex="0" data-original-title="" data-trigger="hover" title=""></a>',superAdminDtlsElm+="</h2>",superAdminDtlsElm+='<div class="dvedit-row">',superAdminDtlsElm+='<label class="lbltxt red">'+ZPI18N.getString("zp.email")+"</label>",superAdminDtlsElm+='<div class="dvedit-field zp-md-5">',superAdminDtlsElm+='<div class="spnfield" name="displayvalue" id="superadmin">'+decodeTxt(orgSettingDtls.superadmin)+"</div>",superAdminDtlsElm+='<select class="selectBox DN" name="editable" updateKey="superadmin">';var count=0;return $.each(orgSettingDtls.adminEmailIds,function(index,adminDtls){count++,superAdminDtlsElm+="<option value="+adminDtls.ERECNO+" ",superAdminDtlsElm+=1===count?"selected='selected'":"",superAdminDtlsElm+=">"+adminDtls.EMPLOYEEMAILALIAS+"</option>"}),superAdminDtlsElm+='</select> </div><a title="" data-placement="top" data-toggle="tooltip" id="disp_loginen_users" class="S11 ML10 MT10 FL DN" data-original-title="'+ZPI18N.getString("zp.clicktotransferadminrights")+'" onclick="User.listLoginEnabledUsers(this)">'+ZPI18N.getString("zp.clicktotransferadminrights")+"</a></div></div>"},CompanySettings.constructLocaleSettings=function(orgSettingDtls){var localeSettingsElms="";return localeSettingsElms+='<div class="bgwhite"> ',localeSettingsElms+='<h2 class="ZPbold">'+ZPI18N.getString("zp.localesettings")+"</h2>",localeSettingsElms+='<div class="dvedit-row">',localeSettingsElms+='<label class="lbltxt">'+ZPI18N.getString("zp.localesettings.locale")+"</label>",localeSettingsElms+='<div class="dvedit-field zp-md-5">',localeSettingsElms+='<div class="spnfield" name="displayvalue" id="currentlocale">'+decodeTxt(orgSettingDtls.currentlocale)+"</div>",localeSettingsElms+='<select class="selectBox DN" updateKey="currentlocale" name="editable" value="'+orgSettingDtls.currentLocVal+'" selected="selected">',localeSettingsElms+="</select></div></div>",localeSettingsElms+='<div class="dvedit-row">',localeSettingsElms+='<label class="lbltxt">'+ZPI18N.getString("zp.localesettings.timezone")+"</label>",localeSettingsElms+='<div class="dvedit-field zp-md-8">',localeSettingsElms+='<div class="spnfield" id="timezone" name="displayvalue">'+(ZPSetupCommon.isEmpty(orgSettingDtls.timezoneVal)?"":decodeTxt(orgSettingDtls.timezone)+" ("+orgSettingDtls.timezoneVal+")")+"</div>",localeSettingsElms+='<select name="editable" class="selectBox DN" updateKey="timezone" value="'+orgSettingDtls.timezoneVal+'">',localeSettingsElms+="</select></div></div></div>"},CompanySettings.constructDisplaySettings=function(orgSettingDtls){var displaySettingsElms="";return displaySettingsElms+='<div class="bgwhite">',displaySettingsElms+='<h2 class="ZPbold">'+ZPI18N.getString("zp.displaysettings")+"</h2>",displaySettingsElms+='<div class="dvedit-row">',displaySettingsElms+='<label class="lbltxt">'+ZPI18N.getString("zp.namedisptype")+"</label>",displaySettingsElms+='<div class="dvedit-field zp-md-5">',displaySettingsElms+='<div class="spnfield" name="displayvalue" id="userDetailType">',displaySettingsElms+="</div>",displaySettingsElms+='<select class="selectBox DN" name="editable" updateKey="userDetailType">',orgSettingDtls.isLastNameMand&&(displaySettingsElms+='<option value="2" id="userDetailType2" selected="selected">'+ZPI18N.getString("zp.lastname")+"</option> "),displaySettingsElms+='<option value="3" id="userDetailType3">'+ZPI18N.getString("zp.firstname")+"</option>",displaySettingsElms+='<option value="4" id="userDetailType4">'+ZPI18N.getString("zp.firstnamelastname")+"</option>",displaySettingsElms+='<option value="5" id="userDetailType5">'+ZPI18N.getString("zp.lastnamefirstname")+"</option> ",displaySettingsElms+="</select>",displaySettingsElms+='<a id="userDetailTypeInfo" data-content="'+ZPI18N.getString(orgSettingDtls.isLastNameMand?"zp.nameshowformat":"zp.nameshowformatwithnote")+'" data-html="true" data-trigger="hover" data-toggle="popover" role="button" data-placement="right" name="fieldToolTip" class="IC-info S15 dvhelpover DN" tabindex="0" data-original-title="" title=""></a> </div>',displaySettingsElms+="</div>",displaySettingsElms+='<div class="dvedit-row">',displaySettingsElms+='<label class="lbltxt">'+ZPI18N.getString("zp.dateformat")+"</label>",displaySettingsElms+='<div class="dvedit-field zp-md-5">',displaySettingsElms+='<div class="spnfield" name="displayvalue" id="dateformat">'+decodeTxt(orgSettingDtls.dateformat)+"</div>",displaySettingsElms+='<select class="selectBox DN" name="editable" oldval = "'+decodeTxt(orgSettingDtls.dateformat)+'" updateKey="dateformat">',displaySettingsElms+='<option value="MM-dd-yyyy" selected="selected">'+ZPI18N.getString("zp.format1")+"</option>",displaySettingsElms+='<option value="dd-MM-yyyy">'+ZPI18N.getString("zp.format2")+"</option>",displaySettingsElms+='<option value="dd-MMM-yyyy">'+ZPI18N.getString("zp.format3")+"</option>",displaySettingsElms+='<option value="dd-MMM-yy">'+ZPI18N.getString("zp.format4")+"</option>",displaySettingsElms+='<option value="MM/dd/yyyy">'+ZPI18N.getString("zp.format5")+"</option>",displaySettingsElms+='<option value="dd/MM/yyyy">'+ZPI18N.getString("zp.format6")+"</option>",displaySettingsElms+='<option value="yyyy-MM-dd">'+ZPI18N.getString("zp.format7")+"</option>",displaySettingsElms+='<option value="yyyy/MM/dd">'+ZPI18N.getString("zp.format8")+"</option>",displaySettingsElms+='<option value="dd.MM.yyyy">'+ZPI18N.getString("zp.format9")+"</option>",displaySettingsElms+="</select></div></div>",displaySettingsElms+='<div class="dvedit-row">',displaySettingsElms+='<label class="lbltxt">'+ZPI18N.getString("zp.timeformat")+"</label>",displaySettingsElms+='<div class="dvedit-field zp-md-6">',displaySettingsElms+='<div class="spnfield" name="displayvalue" id="timeFormat">',"hh:mm a"==orgSettingDtls.timeFormat||ZPSetupCommon.isEmpty(orgSettingDtls.timeFormat)?displaySettingsElms+="12 - ":"HH:mm"==orgSettingDtls.timeFormat&&(displaySettingsElms+="24 - "),displaySettingsElms+=decodeTxt(ZPI18N.getString("zp.hours"))+"</div>",displaySettingsElms+='<div class="DN" name="editable" oldval = "'+orgSettingDtls.timeFormat+'" disp="radioType">',displaySettingsElms+='<div class="radio DIB MR10">',displaySettingsElms+='<input type="radio" id="timeformat" value="hh:mm a" updateKey="timeFormat" name="timefmt">',displaySettingsElms+='<label for="timeformat">12 - '+ZPI18N.getString("zp.hours")+"</label> </div>",displaySettingsElms+='<div class="radio DIB MR10">',displaySettingsElms+='<input id="timefmt" type="radio" value="HH:mm" updateKey="timeFormat" name="timefmt"> ',displaySettingsElms+='<label  for="timefmt">24 - '+ZPI18N.getString("zp.hours")+"</label></div></div></div></div></div>"},CompanySettings.constructPhotoSettings=function(orgSettingDtls){var photoSettingsElms="";return photoSettingsElms+='<div class="bgwhite">',photoSettingsElms+='<h2 class="ZPbold">'+ZPI18N.getString("zp.photosettings")+'<span class="IC-help S15 ML5 DN"></span></h2>',photoSettingsElms+='<div class="dvedit-row">',photoSettingsElms+='<label class="lbltxt">'+ZPI18N.getString("zp.owner")+"</label>",photoSettingsElms+='<div class="dvedit-field zp-md-5">',photoSettingsElms+='<div class="spnfield" name="displayvalue" id="dispType">',photoSettingsElms+="</div>",photoSettingsElms+='<div class="DN" name="editable" oldval = "'+orgSettingDtls.dispType+'" disp="radioType">',photoSettingsElms+='<div class="radio DIB MR10">',photoSettingsElms+='<input id="rdEmployee" type="radio"  value="0" name="displayType" updateKey="dispType">',photoSettingsElms+='<label for="rdEmployee" id="dispType0">'+ZPI18N.getString("zp.employee")+"</label></div>",photoSettingsElms+='<div class="radio DIB MR10">',photoSettingsElms+='<input id="rdAdministrator" type="radio" name="displayType" value="1" updateKey="dispType">',photoSettingsElms+='<label for="rdAdministrator" id="dispType1">'+ZPI18N.getString("zp.administrator")+"</label></div></div></div></div></div>"},CompanySettings.constructSampleDataSettings=function(orgSettingDtls){var sampleDataSettingsElms="";ZPeople.PORTAL_NAME;return orgSettingDtls.hasSampleData&&isadmin&&(sampleDataSettingsElms+='<div class="bgwhite B0" id="sampledatasettingsdiv" name="sampledatasettingsdiv">',sampleDataSettingsElms+='<h2 class="ZPbold">'+ZPI18N.getString("zp.sampledatasettings")+"</h2>",sampleDataSettingsElms+='<div class="dvedit-row">',sampleDataSettingsElms+='<label class="lbltxt">'+ZPI18N.getString("zp.sampledatasetting1")+"</label>",sampleDataSettingsElms+='<div class="dvedit-field zp-md-5">',sampleDataSettingsElms+='<div class="spnfield" name="displayvalue">',sampleDataSettingsElms+='<a class="btn btn-primary MR10" onclick="ZPeople.deleteSampleData()">'+ZPI18N.getString("zp.deletesampledata")+"</a>",sampleDataSettingsElms+="</div></div></div></div>"),sampleDataSettingsElms},CompanySettings.constructChatSettings=function(orgSettingDtls){var chatSettingsFieldsObj="";return chatSettingsFieldsObj+='<div class="bgwhite B0">',chatSettingsFieldsObj+='<h2 class="ZPbold">'+ZPI18N.getString("zp.chatsettings"),chatSettingsFieldsObj+='<a data-content="'+ZPI18N.getString("zp.enableChatDesc")+'" data-trigger="hover" data-toggle="popover" role="button" data-placement="right" name="fieldToolTip" class="IC-info S15 ML10 dvhelpover DN" tabindex="0" data-original-title="" title=""></a></h2>',chatSettingsFieldsObj+='<div class="dvedit-row">',chatSettingsFieldsObj+='<label class="lbltxt">'+ZPI18N.getString("zp.chatsettings.chat")+"</label>",chatSettingsFieldsObj+='<div class="dvedit-field zp-md-5">',chatSettingsFieldsObj+='<div class="spnfield" name="displayvalue" id="chat">',chatSettingsFieldsObj+="</div>",chatSettingsFieldsObj+='<div class="DN" name="editable" oldval = "'+orgSettingDtls.chat+'" disp="radioType">',chatSettingsFieldsObj+='<div class="radio DIB MR10">',chatSettingsFieldsObj+='<input type="radio" updateKey="chat" name="chat" value="0" id="orgchatdis">',chatSettingsFieldsObj+='<label id="chat0" for="orgchatdis">'+ZPI18N.getString("zp.disable")+"</label></div>",chatSettingsFieldsObj+='<div class="radio DIB MR10">',chatSettingsFieldsObj+='<input type="radio" updateKey="chat" name="chat" value="1" id="orgchaten">',chatSettingsFieldsObj+='<label id="chat1" for="orgchaten">'+ZPI18N.getString("zp.enable")+"</label>",chatSettingsFieldsObj+="</div></div></div></div></div>"},CompanySettings.constructCompanyLogoElms=function(url){var companyLogoObj="";return companyLogoObj+='<div class="modal modal-small fade" id="dvchangelogo">',companyLogoObj+='<div class="modal-dialog">',companyLogoObj+='<div class="modal-content" id="companyLogoPopup">',companyLogoObj+='<div class="modal-header"> <a data-dismiss="modal" class="IC-cls-1px red close"></a>',companyLogoObj+='<h4 class="modal-title">'+ZPI18N.getString("zp.uploadlogo")+"</h4></div>",companyLogoObj+='<div class="modal-body dvreorder-section">',companyLogoObj+='<div class="clearfix">',companyLogoObj+='<div class="text-center dvupldfile PB10">',companyLogoObj+='<img width="150" src="">',companyLogoObj+='<span class="nologo hide"><i class="IC-img2x"></i></span>',companyLogoObj+='<div class="S13 MT10">'+ZPI18N.getString("zp.resolution")+" 80 x 55</div>",companyLogoObj+="</div>",companyLogoObj+='<form id="companyLogo" method="post" action="ViewCompanyLogoImage.zp" enctype="multipart/form-data" target="companylogo-target">',companyLogoObj+='<div class="zp-md-12">',companyLogoObj+='<input type="hidden" name="'+csrfParamName+'" value="'+csrfToken+'">',companyLogoObj+='<div class="ZPfileBox text-center PT20 PB20" id ="companylogoImg1"> <i class="IC-imprt S22 MB8 DIB blu" id = "icOn"></i> <p class="ZPbold" id = "notesTag">'+ZPI18N.getString("zp.browseupload")+'</p> <p class="MB20 DN" id = "uploadedDtl"><em id="importdUploadedFName"></em> <span class="IC-rou-tik ML5 filetck"></span></p><div class="btn btn-primary ZPbtnDefault"> <span>'+ZPI18N.getString("zp.importfile")+'</span> <input type="file" class="ZPFfile" name="image"  id="importFileName" onchange = "CompanySettings.showPreviewOfLogoUploaded()"> </div></div>',companyLogoObj+='<iframe align="top" frameborder="0" src="'+ZPeople.getResourceURL(htmlUrl+"blank.html")+'" name="companylogo-target" marginwidth="0" marginheight="0" scrolling="no" width="100%" height="30" style="display:none"> </iframe>',companyLogoObj+="</div></div>",companyLogoObj+='<div class="modal-footer">',companyLogoObj+='<a class="btn btn-primary" onclick="javascript:emptyCheck()" id="update">'+ZPI18N.getString("zp.update")+'</a><a aria-label="Close" data-dismiss="modal" class="btn btn-default">'+ZPI18N.getString("zp.cancel")+"</a>",companyLogoObj+="</div></div></div>"},CompanySettings.constructTypeOfIndustry=function(orgDtls){var typeOfIndustryElms="";typeOfIndustryElms+='<div class="form-group"> ',typeOfIndustryElms+='<span class="IC-org PR10"></span>';var typeOfInd=ZPSetupCommon.isEmpty(orgDtls.industryType)?ZPI18N.getString("zp.selectIndustryType"):decodeTxt(orgDtls.industryType);return Organization.selectedIndustry=typeOfInd,typeOfIndustryElms+='<span class="spnfield" name="displayvalue" id="industryType">'+decodeTxt(typeOfInd)+"</span>",typeOfIndustryElms+='<select class="selectBox hide" updateKey="industryType" name="editable">',typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.agri")+'">'+ZPI18N.getString("zp.agri")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.automotive")+'">'+ZPI18N.getString("zp.automotive")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.bussiness")+'">'+ZPI18N.getString("zp.bussiness")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.callcentre")+'">'+ZPI18N.getString("zp.callcentre")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.construction")+'">'+ZPI18N.getString("zp.construction")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.consultant")+'">'+ZPI18N.getString("zp.consultant")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.education")+'">'+ZPI18N.getString("zp.education")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.emergency")+'">'+ZPI18N.getString("zp.emergency")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.entertainAevents")+'">'+ZPI18N.getString("zp.entertainAevents")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.financeAins")+'">'+ZPI18N.getString("zp.financeAins")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.govApublic")+'">'+ZPI18N.getString("zp.govApublic")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.homeimpser")+'">'+ZPI18N.getString("zp.homeimpser")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.housAreal")+'">'+ZPI18N.getString("zp.housAreal")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.infotech")+'">'+ZPI18N.getString("zp.infotech")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.manufacturing")+'">'+ZPI18N.getString("zp.manufacturing")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.media")+'">'+ZPI18N.getString("zp.media")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.medicalAheal")+'">'+ZPI18N.getString("zp.medicalAheal")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.mine")+'">'+ZPI18N.getString("zp.mine")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.nonProfit")+'">'+ZPI18N.getString("zp.nonProfit")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.publishing")+'">'+ZPI18N.getString("zp.publishing")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.resellAwhite")+'">'+ZPI18N.getString("zp.resellAwhite")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.restaurantAfood")+'">'+ZPI18N.getString("zp.restaurantAfood")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.retail")+'">'+ZPI18N.getString("zp.retail")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.sales&Trade")+'">'+ZPI18N.getString("zp.sales&Trade")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.seaFood")+'">'+ZPI18N.getString("zp.seaFood")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.securser")+'">'+ZPI18N.getString("zp.securser")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.soft")+'">'+ZPI18N.getString("zp.soft")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.telecom")+'">'+ZPI18N.getString("zp.telecom")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.tour&Hospitality")+'">'+ZPI18N.getString("zp.tour&Hospitality")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.transportAlogis")+'">'+ZPI18N.getString("zp.transportAlogis")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.utilities")+'">'+ZPI18N.getString("zp.utilities")+"</option>",typeOfIndustryElms+='<option value="'+ZPI18N.getString("zp.veter")+'">'+ZPI18N.getString("zp.veter")+"</option>",typeOfIndustryElms+="</select></div>"},CompanySettings.showPreviewOfLogoUploaded=function(){var pageId=Layout.Page.container;pageId.find("input#importFileName").prev("span").text(ZPI18N.getString("zp.removeandnew")),pageId.find("p#uploadedDtl").removeClass("DN"),pageId.find("p#notesTag").addClass("DN"),pageId.find("i#icOn").attr("class","IC-docs imtIcn DIB blu"),pageId.find("em#importdUploadedFName").text(pageId.find("input#importFileName").val())},CompanySettings.constructOrgLeftBar=function(resultObj){var orgSettingDtls=resultObj.orgSettingsDtls,orgSettingsLeftBar=(orgSettingDtls.adminemail,"");return orgSettingsLeftBar+='<div class="orglft">',orgSettingsLeftBar+='<div class="orglogo text-center brdbtm">',orgSettingsLeftBar+='<div class="dvlist-action">',orgSettingsLeftBar+='<a data-target="#dvchangelogo" data-toggle="modal" class="btn btn-default dvchange" onclick=CompanySettings.showPopUp("'+orgSettingDtls.logo+'")><span class="IC-exprt MR5"></span>'+ZPI18N.getString("zp.uploadlogo")+"</a>",orgSettingsLeftBar+='<a id="resetlogo" class="btn btn-link btn-reset" onclick="CompanySettings.resetLogo()"><span class="IC-reload MR3"></span>'+ZPI18N.getString("zp.reset")+"</a></div>",orgSettingsLeftBar+='<div class="logoset" id="companyLogo"><span class="nologo hide"><i class="IC-img2x"></i></span> <img class="" width="160" src=""></div></div>',orgSettingsLeftBar+='<div class="orddetail active brdbtm PR PT20">',orgSettingsLeftBar+='<div class="dvedit DN"> </div>',orgSettingsLeftBar+='<div class="S18 form-group"><span name="displayvalue" id="companyName">'+orgSettingDtls.companyName+"</span>",orgSettingsLeftBar+='<input value="'+orgSettingDtls.companyName+'" name="editable" updateKey="companyName" placeholder="'+ZPI18N.getString("zp.companyname")+'" class="form-control hide"></div>',orgSettingsLeftBar+='<div class="S14 form-group"><a name="displayvalue" id="website" class="lblname" target="_blank" href="'+orgSettingDtls.website+'">'+orgSettingDtls.website+"</a>",orgSettingsLeftBar+='<input value="'+orgSettingDtls.website+'" name="editable" updateKey="website" placeholder="'+ZPI18N.getString("zp.website")+'" class="form-control hide"></div>',orgSettingsLeftBar+='<div class="address-sec PT10 PB5">',orgSettingsLeftBar+=CompanySettings.constructTypeOfIndustry(resultObj.orgSettingsDtls),orgSettingsLeftBar+='<div class="form-group"> <span class="IC-usr-fill PR10"></span> <span name="displayvalue" id="contactperson" class="lblname">'+orgSettingDtls.contactperson+"</span>",orgSettingsLeftBar+='<input value="'+orgSettingDtls.contactperson+'" name="editable" updateKey="contactperson" placeholder="'+ZPI18N.getString("zp.contactperson")+'" class="form-control hide"></div>',orgSettingsLeftBar+='<div class="form-group"> <span class="IC-phone PR10"></span> <span name="displayvalue" id="contactno" class="lblname">'+orgSettingDtls.contactno+"</span>",orgSettingsLeftBar+='<input value="'+orgSettingDtls.contactno+'" placeholder="'+ZPI18N.getString("zp.contactnum")+'" name="editable" updateKey="contactno" class="form-control hide"></div>',orgSettingsLeftBar+='<div class="form-group lnkmail"> <span class="IC-mail PR10"></span> <a class="lblname lnk" id="adminemail" name="displayvalue">'+orgSettingDtls.ADMINSUPPORT+"</a>",orgSettingsLeftBar+='<input value="'+orgSettingDtls.ADMINSUPPORT+'" name="editable" placeholder="'+ZPI18N.getString("zp.adminEmail")+'" class="form-control hide" updateKey="adminemail"></div></div></div>',orgSettingsLeftBar+='<div class="form-group ordadd PT20 PR" id="addrSection">',orgSettingsLeftBar+='<h2 class="ZPbold">'+ZPI18N.getString("zp.addrdtls")+"</h2>",orgSettingsLeftBar+='<address class="dvadddetail lblname"> ',orgSettingsLeftBar+='<span id="firstaddr" name="displayvalue" >'+decodeTxt(orgSettingDtls.firstaddr)+"</span>",orgSettingsLeftBar+='<span id="secondaddr" name="displayvalue" class="lblname">'+decodeTxt(orgSettingDtls.secondaddr)+"</span>",orgSettingsLeftBar+='<span id="city" name="displayvalue" class="lblname">'+decodeTxt(orgSettingDtls.city)+"</span>",orgSettingsLeftBar+='<span id="state" name="displayvalue" class="lblname" >'+decodeTxt(orgSettingDtls.state)+"</span>",orgSettingsLeftBar+='<span id="country" name="displayvalue" class="lblname">'+decodeTxt(orgSettingDtls.country)+"</span>",orgSettingsLeftBar+='<span id="zipcode" name="displayvalue" class="lblname">'+decodeTxt(orgSettingDtls.zipcode)+"</span></address> </div>",orgSettingsLeftBar+='<div class="form-group MT15">',orgSettingsLeftBar+='<input class="form-control ZPtooltip-lftnav hide" placeholder="'+ZPI18N.getString("zp.addressLine")+' 1" name="editable" updateKey="firstaddr" ZPtitle="Address Line 1" value="'+orgSettingDtls.firstaddr+'"></div>',orgSettingsLeftBar+='<div class="form-group">',orgSettingsLeftBar+='<input class="form-control ZPtooltip-lftnav hide" placeholder="'+ZPI18N.getString("zp.addressLine")+' 2"  name="editable" updateKey="secondaddr" ZPtitle="Second Address" value="'+orgSettingDtls.secondaddr+'"></div>',orgSettingsLeftBar+='<div class="form-group">',orgSettingsLeftBar+='<input class="form-control ZPtooltip-lftnav hide" name="editable" updateKey="city" placeholder="'+ZPI18N.getString("zp.local.City")+'" ZPtitle="City" value="'+orgSettingDtls.city+'"></div>',orgSettingsLeftBar+='<div class="form-group">',orgSettingsLeftBar+='<input class="form-control ZPtooltip-lftnav hide" name="editable" updateKey="state" placeholder="'+ZPI18N.getString("zp.local.StateProvince")+'" ZPtitle="State" value="'+orgSettingDtls.state+'"></div>',orgSettingsLeftBar+='<div class="form-group">',orgSettingsLeftBar+='<input class="form-control ZPtooltip-lftnav hide" name="editable" updateKey="country" placeholder="'+ZPI18N.getString("zp.country")+'" ZPtitle="Country" value="'+orgSettingDtls.country+'"></div>',orgSettingsLeftBar+='<div class="form-group">',orgSettingsLeftBar+='<input class="form-control ZPtooltip-lftnav hide" name="editable" value="'+orgSettingDtls.zipcode+'" updateKey="zipcode" placeholder="'+ZPI18N.getString("zp.local.ZIPPINCode")+'" ZPtitle="Zip Code"></div></div>'},CompanySettings.showupLoadDiv=function(){var pageId=Layout.Page.container,fName=pageId.find("#importFileName").val();fName=fName.replace("C:\\fakepath\\",""),pageId.find("#companylogoImg1").hide(),pageId.find("#companylogoImg2").show(),pageId.find("#importdUploadedFName").empty().text(fName),pageId.find("#companylogoImg2").append(pageId.find("#importFileName").attr("onchange","CompanySettings.ChangeImportFileName()").siblings().html(ZPI18N.getString("zp.removeandnew")).parent())},CompanySettings.ChangeImportFileName=function(){var pageId=Layout.Page.container,fName=pageId.find("#importFileName").val();fName=fName.replace("C:\\fakepath\\",""),pageId.find("#importdUploadedFName").empty().text(fName),pageId.find("#importFileName").show()},CompanySettings.showPopUp=function(orgLogoPath){var pageId=Layout.Page.container;pageId.find("input#importFileName").val("");var $popUplogo=pageId.find("div#companyLogoPopup").find("img"),$emptyLogo=pageId.find("div#companyLogoPopup").find("span.nologo"),updatedSrc=$popUplogo.attr("src");(ZPSetupCommon.isEmpty(orgLogoPath)||"undefined"===orgLogoPath)&&ZPSetupCommon.isEmpty(updatedSrc)?($popUplogo.addClass("DN"),pageId.find("#resetlogo").addClass("hide"),$emptyLogo.removeClass("hide")):(orgLogoPath=ZPSetupCommon.isEmpty(updatedSrc)?orgLogoPath:updatedSrc,pageId.find("#resetlogo").removeClass("hide"),$emptyLogo.addClass("hide"),$popUplogo.attr("src",orgLogoPath),$popUplogo.removeClass("DN"),pageId.find("i#icOn").attr("class","IC-imprt S22 MB8 DIB blu"),pageId.find("p#notesTag").removeClass("DN"),pageId.find("p#uploadedDtl").addClass("DN"),pageId.find("input#importFileName").prev("span").text(ZPI18N.getString("zp.importfile")))},CompanySettings.resetLogo=function(){0==$(".ZPHeadLft .DB").length&&ZPeople.Request.send("/editCompanySettings.zp",{method:"resetCompanyLogo",mode:"edit"},CompanySettings.resetLogoCallBack)},CompanySettings.resetLogoCallBack=function(data){data.hasOwnProperty("result")&&data.result?(Layout.Page.container.find("#resetlogo").addClass("hide"),Layout.Page.container.find("#companyLogo .nologo").removeClass("hide"),$("div#companyLogoPopup").find("img").attr("src",""),$("div#companylogoImg1 #notesTag").removeClass("DN").text(ZPI18N.getString("zp.orgupload")),$("div#companylogoImg1 #uploadedDtl").addClass("DN"),$("div#companylogoImg1 .ZPbtnDefault span").text(ZPI18N.getString("zp.importfile")),$("div#companyLogo").find("img").attr("src",""),Layout.Page.container.find("#resetlogo").siblings().attr("onclick","CompanySettings.showPopUp('undefined')"),$(".zp_Nav .ZPHeadLft img").remove(),0==$(".zp_Nav .ZPHeadLft .DB").length&&$(".zp_Nav .ZPHeadLft").append("<a class="+(Layout.isPeoplePus?'"ZPPLogo DB"':'"ZPLogo DB"')+"></a>")):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.erroroccuredtryagain"))},CompanySettings.constructModifySettingsButton=function(){var orgSettingsFieldsObj="";return orgSettingsFieldsObj+='<div class="dvcom-action text-left">',orgSettingsFieldsObj+='<div class="zp-md-6 text-left hide" id="saveChanged" >',orgSettingsFieldsObj+='<button data-loading-text="Loading..." id="dvbtnSave" class="btn btnfrmsave btn-primary PL15 PR15" type="button" autocomplete="off" onclick="CompanySettings.updateCompanySettings(this)" >'+ZPI18N.getString("zp.save")+' <span class="loader FR hide"></span></button>',orgSettingsFieldsObj+='<a class="btn btnfrmsave btn-default ML10" id="orgSetCancel" onclick="CompanySettings.openclsForm(this)" >'+ZPI18N.getString("zp.cancel")+"</a></div>",orgSettingsFieldsObj+='<div class="zp-md-6 text-left">',orgSettingsFieldsObj+='<a class="btn btn-primary" id="modify" onclick="CompanySettings.openclsForm(this)" >'+ZPI18N.getString("zp.modifysettings")+"</a>",orgSettingsFieldsObj+="</div></div>"},CompanySettings.setValuesFordropDownAndCheckBox=function(companyDtls){var pageId=Layout.Page.container;$.each(pageId.find("*[name=displayvalue]"),function(index,object){var key="adminemail"===$(object).attr("id")?"ADMINSUPPORT":$(object).attr("id"),value="superadmin"===key?companyDtls.superadmin:companyDtls[key];if("superadmin"!==key){var tagName=$("*[updateKey='"+key+"']").prop("tagName");if("INPUT"===tagName&&"radio"!==$("*[updateKey='"+key+"']").attr("type")){var val=decodeTxt(value);$("*[updateKey='"+key+"']").val(val)}else if("chat"===key||"dispType"===key||"userDetailType"===key||"notify"===key||"orgstructure"===key||"stream"===key||"dualreport"===key||"isBirthdayHideAllowed"==key||"isWorkAnnHideAllowed"==key||"isWedAnnHideAllowed"==key||"isMobileHideAllowed"==key||"isMobileSearchAllowed"==key){var dispVal;"INPUT"===tagName?(("chat"===key&&ZPSetupCommon.isEmpty(value)||"dispType"===key&&ZPSetupCommon.isEmpty(value))&&(value="0"),dispVal="dispType"===key?$("input[updateKey='"+key+"'][value='"+value+"']").next("label").text():"0"==value?ZPI18N.getString("zp.disabled"):ZPI18N.getString("zp.enabled")):dispVal=$("select[updateKey='"+key+"'] option[value='"+value+"']").text(),value=dispVal,$(object).text(value)}}});var fromEmail=decodeTxt(companyDtls.fromEmail);ZPSetupCommon.isEmpty(fromEmail)||pageId.find("select[updateKey='fromEmail']").val(fromEmail),ZPSetupCommon.isEmpty(companyDtls.emailencoding)||pageId.find("select[updateKey='emailencoding']").val(companyDtls.emailencoding),ZPSetupCommon.isEmpty(companyDtls.currentlocale)||pageId.find("select[updateKey='currentlocale']").val(companyDtls.currentlocale),ZPSetupCommon.isEmpty(companyDtls.userDetailType)||pageId.find("select[updateKey='userDetailType']").val(companyDtls.userDetailType),ZPSetupCommon.isEmpty(companyDtls.dateformat)||pageId.find("select[updateKey='dateformat']").val(decodeTxt(companyDtls.dateformat)),ZPSetupCommon.isEmpty(companyDtls.superadmin)||pageId.find("select[updateKey='superadmin']").val(companyDtls.superadminErecNo)},CompanySettings.openclsForm=function(thisObj,compnDtls){var pageId=Layout.Page.container;pageId.find("input[name='editable']").is(":visible")?(Layout.Page.container.find("div.select2-container,a#cls_rights,a#transfer_rights,div#loginusers_ist").remove(),pageId.find("a#disp_loginen_users").addClass("DN"),pageId.find("div#sampledatasettingsdiv").removeClass("hide"),CompanySettings.resetValues(),pageId.find("select[updateKey='superadmin']").off(),CompanySettings.paramNames=[],CompanySettings.paramVals=[]):(ZPeople.Request.send("/editCompanySettings.zp",{method:"getCompanySettingsDetails",mode:"edit"},CompanySettings.setEditDetails),pageId.find("a#disp_loginen_users").removeClass("DN"),pageId.find("div#sampledatasettingsdiv").addClass("hide")),pageId.find("select[updateKey=superadmin]").parent().removeClass("hide");var leftDiv=pageId.find("div.orglft"),rightDiv=pageId.find("div.orgrht");pageId.find("div[name='error']").remove(),leftDiv.find("input[name='editable']").parent().removeClass("has-error"),$(thisObj).find("span").siblings(".IC-pen").toggleClass("hide"),pageId.find("a#modify,span.IC-pen").toggleClass("hide"),leftDiv.find("input[name='editable'],a[name='displayvalue'],span[name='displayvalue']").toggleClass("hide"),rightDiv.find("input[updateKey='orgEmail'],a[name='changeOrgEmail'],input[name='editable'],select[name='editable'],div[name='displayvalue'],div[name='editable'],a[name='fieldToolTip']").toggleClass("DN"),pageId.find("#saveChanged").toggleClass("hide"),pageId.find(".compsettings").find("div#industryType").removeClass("hide"),OrgEmail.companySettingsCallBack(rightDiv),CompanySettings.traceChangedValues($("input[name='editable'],select[name='editable'],input[type=radio]"))},CompanySettings.setEditDetails=function(dataObj){dataObj.isLastNameMand&&1!=$("[updatekey=userDetailType] option[value=2]").length?$("[updatekey=userDetailType]").append('<option value="2" id="userDetailType2">'+ZPI18N.getString("zp.lastname")+"</option>").select2():dataObj.isLastNameMand||1!=$("[updatekey=userDetailType] option[value=2]").length||$("[updatekey=userDetailType] option[value=2]").remove(),$("#userDetailTypeInfo").attr("data-content",ZPI18N.getString(dataObj.isLastNameMand?"zp.nameshowformat":"zp.nameshowformatwithnote"));var pageId=Layout.Page.container,timeZoneList=CompanySettings.iterateTimeZonoList(dataObj),currentLocBox=$("select[updateKey='currentlocale']");currentLocBox.html(CompanySettings.iterateCountryDtls(dataObj)),ZPSetupCommon.isEmpty(currentLocBox.attr("value"))||"undefined"===currentLocBox.attr("value")||currentLocBox.val(currentLocBox.attr("value"));var timeZnBox=$("select[updateKey='timezone']");timeZnBox.html(timeZoneList);var oldVal=timeZnBox.attr("value");"undefined"!==oldVal?timeZnBox.val(oldVal):timeZnBox.val($(timeZnBox.find("option")[0]).attr("value"));var dateFmtSelBox=pageId.find("select[updateKey='dateformat']"),dateFmtVal=ZPSetupCommon.isEmpty(dateFmtSelBox.attr("oldval"))?$(dateFmtSelBox.find("option")[0]).attr("value"):dateFmtSelBox.attr("oldval");dateFmtSelBox.val(dateFmtVal),$.each(pageId.find("div[disp='radioType']"),function(index,obj){var oldVal=$(obj).attr("oldval"),key=$(obj).parent().find("div[name='displayvalue']").attr("id");"undefined"===oldVal&&("timeFormat"===key?oldVal="hh:mm a":"dispType"===key&&(oldVal="0")),pageId.find("input[updateKey='"+key+"']").prop("checked",!1),pageId.find("input[updateKey='"+key+"'][value='"+oldVal+"']").prop("checked",!0)}),ZPSetupCommon.isEmpty(Organization.selectedIndustry)||pageId.find(".compsettings").find("select option[value='"+Organization.selectedIndustry+"']").attr("selected","selected"),pageId.find(".compsettings").find("div#industryType").addClass("hide"),pageId.find(".compsettings").find("select[updateKey='industryType']").removeClass("hide"),Layout.Page.container.find("select.selectBox").select2()},CompanySettings.iterateCountryDtls=function(data){var countryDtls="";return $.each(data.countryList,function(index,country){countryDtls+=0===index?"<option value="+country.code+' selected="selected">'+country.name+"</option>":"<option value="+country.code+">"+country.name+"</option>"}),countryDtls},CompanySettings.iterateTimeZonoList=function(data){var timeZoneListElms="";return $.each(data.timeZoneList,function(index,timeMap){for(timeZoneListElms+="<optgroup label='"+timeMap.disp+"'>",i=0;i<timeMap.list.length;i++)timeZoneListElms+="<option value='"+timeMap.list[i].code+"'>"+timeMap.list[i].name+"&nbsp("+timeMap.list[i].code+")</option>";timeZoneListElms+="</optgroup>"}),timeZoneListElms},CompanySettings.updateCompanySettings=function(obj){var pageId=Layout.Page.container,params={},companySettingsJsonObject={},companyNameisEmpty=ZPSetupCommon.isEmpty($("input[updateKey=companyName]").val()),isError=!1,isEmailCorrectFormat=!(ZPSetupCommon.isEmpty(pageId.find("input[updateKey=adminemail]").val())||!CompanySettings.isValidEmail(pageId.find("input[updateKey=adminemail]").val())),timFmt=pageId.find("div[id='timeFormat']").parent().find("div[name='editable']");$("div.dverrormsg").remove(),"undefined"!==timFmt.attr("oldval")||CompanySettings.paramNames.hasOwnProperty("timeFormat")||(CompanySettings.paramNames.push("timeFormat"),CompanySettings.paramVals.push(timFmt.find("input[type='radio']:checked").attr("value"))),$.each(CompanySettings.paramNames,function(index,key){"adminemail"===key&&!isEmailCorrectFormat||"companyName"===key&&companyNameisEmpty?(CompanySettings.error="companyName"===key?ZPI18N.getString("zp.organizationemptymsg"):ZPI18N.getString("zp.validemail"),$("div#error"+key).remove(),$("input[updateKey="+key+"]").parent().addClass("has-error").append("<div class='dverrormsg' name='error' id='error"+key+"'>"+CompanySettings.error+"</div>"),$("select[updateKey="+key+"]").parent().addClass("has-error").append("<div class='dverrormsg' name='error' id='error"+key+"'>"+ZPI18N.getString("zp.validemail")+"</div>"),isError=!0):($("div#error"+key).remove(),$("input[updateKey="+key+"]").parent().removeClass("has-error"))}),isError||(CompanySettings.error=null,CompanySettings.createJsonObject(companySettingsJsonObject),void 0!==companySettingsJsonObject.orgstructure&&"0"==companySettingsJsonObject.orgstructure&&isZohoPayrollOrganisationStructureSyncEnabled?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.payrollorgstructuresyncenabled")):(params.orgsettingsjson=JSON.stringify(companySettingsJsonObject),params.method="saveCompanySettings",params.conreqcsr=csrfToken,0!==CompanySettings.paramNames.length&&!companyNameisEmpty&&isEmailCorrectFormat?$.post("/saveCompanySettings.zp",params,function(data,status){var cnt=0;if(ZPSetupCommon.isEmpty(data.values))if(ZPSetupCommon.isEmpty(data.orgstructure))ZPSetupCommon.isEmpty(data.error)?$.each(data,function(key,error){var obj=pageId.find("*[updateKey='"+key+"']").parent();$(obj).addClass("has-error"),ZPSetupCommon.showErr(data[key],obj,"dverrormsg")}):ZPeople.Message.showFailureMsg(data.error);else{var obj=pageId.find("*[updateKey='orgstructure']").closest("[name='editable']");ZPSetupCommon.showErr(data.orgstructure,obj,"dverrormsg")}else $.each(data.values,function(key,value){if(cnt++,"superadmin"===key&&(value=JSON.parse(params.orgsettingsjson)[key]),"botendisable"===key&&(1==value&&0==$("#footerOptions").find(".CR-zia").length?$("#footerOptions").prepend('<span class="CR-zia" zonename="ziachatbot" onclick="ziaPeople.ziaChatClick()"></span>'):(ziaPeople.ziaMinimizeChat(),$("#footerOptions").find(".CR-zia").remove()),ZPeople.UnifiedUI.isUnifiedUI())){var footerIcons=CrmPlusImpl.getFooterIcons();CrmPlusImpl.trigger("modifyUI",["chatBarNotification",footerIcons])}CompanySettings.setValuesToElements(key,value,obj,$("input[updateKey='"+key+"']").attr("type")),"website"===key&&$("#"+key).attr("href",value);var editableParent=pageId.find("*[updateKey='"+key+"']").closest("div[name='editable']");ZPSetupCommon.isEmpty(editableParent.attr("disp"))||editableParent.attr("oldval",value),pageId.find("select[updateKey='dateformat']").attr("oldval",value),$("div#infoMsg").slideUp("slow"),cnt===Object.keys(data.values).length&&CompanySettings.openclsForm($(obj).parent().parent().find("a#open"))}),CompanySettings.paramNames=[],CompanySettings.paramVals=[],void 0===JSON.parse(params.orgsettingsjson).orgstructure&&void 0===JSON.parse(params.orgsettingsjson).stream&&void 0===JSON.parse(params.orgsettingsjson).stream||window.location.reload(),void 0===JSON.parse(params.orgsettingsjson).isBirthdayHideAllowed&&void 0===JSON.parse(params.orgsettingsjson).isWorkAnnHideAllowed&&void 0===JSON.parse(params.orgsettingsjson).isWedAnnHideAllowed||void 0!=$("#zp-contwrap-personalSetting")&&$("#zp-contwrap-personalSetting").length>0&&$("#zp-contwrap-personalSetting").remove()}).fail(function(data){null!=data.responseJSON.error&&void 0!=data.responseJSON.error&&ZPeople.Message.showFailureMsg(data.responseJSON.error)}):(ZPSetupCommon.isEmpty(CompanySettings.error)&&(companyNameisEmpty||!isEmailCorrectFormat?(companyNameisEmpty&&$("input[updateKey='companyName']").parent().addClass("has-error").append("<div class='dverrormsg' name='error' id='errorcompanyName'>"+ZPI18N.getString("zp.organizationemptymsg")+"</div>"),isEmailCorrectFormat||$("input[updateKey='adminemail']").parent().addClass("has-error").append("<div class='dverrormsg' name='error' id='erroradminemail'>"+ZPI18N.getString("zp.validemail")+"</div>")):($("div#infoMsg,div#succMsg").slideUp("slow"),CompanySettings.openclsForm($(obj).parent().parent().find("a#open")))),CompanySettings.paramNames=[],CompanySettings.paramVals=[])))},CompanySettings.isValidEmail=function(value){return/^\w+((-\w+)|(\.\w+)|(\+\w+)|(\'\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/.test($.trim(value))},CompanySettings.isValidMobile=function(value){return/^[0-9]{5,14}$/.test($.trim(value))},CompanySettings.setValuesToElements=function(key,val,obj,type){var outputVal,pageId=Layout.Page.container;if($("div#error"+key).remove(),"radio"!==type){if("userDetailType"===key)outputVal=$("#"+key+val).text();else if(outputVal=val,"SELECT"===$("*[updateKey='"+key+"']").prop("tagName")){var currentSelectField=$("select[updateKey='"+key+"']").find("option[value='"+outputVal+"']");"timezone"!==key&&"currentlocale"!==key||$("select[updateKey='"+key+"']").attr("value",outputVal),currentSelectField.prop("selected","selected"),outputVal=currentSelectField.text()}$("#"+key).text(outputVal),$("input[updateKey="+key+"],select[updateKey="+key+"]").val(val)}else if("timeFormat"===key){val="HH:mm"===val?"24 -":"12 -";$("div[id="+key+"]").text(val+" "+ZPI18N.getString("zp.hours"))}else"dispType"===key?$("div[id="+key+"]").text($("label#"+key+val).text()):(val="0"==val?ZPI18N.getString("zp.disabled"):ZPI18N.getString("zp.enabled"),$("div[id="+key+"]").text(val));CompanySettings.isAddrSectionEmpty()?pageId.find("div#addrSection").addClass("DN"):pageId.find("div#addrSection").removeClass("DN")},CompanySettings.isAddrSectionEmpty=function(){return 0===Layout.Page.container.find("input[updateKey='firstaddr'],input[updateKey='secondaddr'],input[updateKey='city'],input[updateKey='state'],input[updateKey='country'],input[updateKey='zipcode']").filter(function(){return $(this).val()}).length},CompanySettings.resetValues=function(){$.each(Layout.Page.container.find("*[name=displayvalue]"),function(index,object){var oldVal=$(object).text(),key=$(object).attr("id");"INPUT"===$("*[updateKey='"+key+"']").prop("tagName")&&"radio"!==$("*[updateKey='"+key+"']").attr("type")&&$("*[updateKey='"+key+"']").val(oldVal)})},CompanySettings.traceChangedValues=function(object){Layout.Page.container;$.each(object,function(i,obj){$(obj).on("change",function(){var paramName=$(this).attr("updateKey"),paramVal=$(this).val();CompanySettings.paramNames.push(paramName.trim()),CompanySettings.paramVals.push(paramVal.trim())})})},CompanySettings.createJsonObject=function(json){$.each(CompanySettings.paramNames,function(i,param){json[param]=CompanySettings.paramVals[i]})},CompanySettings.setDefaultVal=function(){$.each($(Layout.containerid).find("*[name='displayvalue']"),function(index,elm){})},CompanySettings.endsWith=function(str,suffix){var sufLen=suffix.length,strLen=str.length;return!(sufLen>str.length)&&str.substr(strLen-sufLen,sufLen)==suffix};var TemplateList={isError:!1,actionType:"addTemplate",templateId:null,isExceeded:null,isPopupBoxAllowToBeAsEditMode:!0,isAllowToAddTemplate:!1,formId:null,isTempListCountExceed:!1,clonePopUp:null,firstFormObj:null,autoMaticChanged:!1,currentTempType:null};function removeDKIMPop(){$("div#dkimPop").addClass("DN")}function copyTxtToClipBoard(mode){var successCopy;"hostkey"===mode?$("input#hostkey").trigger("select"):"hostValue"===mode&&$("input#hostValue").trigger("select");try{!1===(successCopy=document.execCommand("copy"))?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.copyfailed")):ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.copysuccess"))}catch(exception){successCopy=!1,ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.copyfailed"))}return successCopy}function removeModal(){Organization.canSendCname=!1,$("input#txtRadio").prop("checked",!0),$("input#cnameRadio").prop("checked",!1),$("div#vDomPop").addClass("DN")}function changeValuesInModalForDomainVerification(mode,cname,txt,cnamedest){var url_currentdomain=ZPeople.ZOHOURL,tempChangeForCnHelp=url_currentdomain.split(".");if("cn"==tempChangeForCnHelp[tempChangeForCnHelp.length-1]&&(url_currentdomain="https://www.zoho.com"),null!=mode&&"cname"==mode?Organization.showCname=!0:(Organization.showCname=!1,Organization.showtxt=!0),Organization.showCname){var cName1='<p id="torc1"><span>2.</span>'+ZPI18N.getString("zp.addcnamerec")+"</p>",cName2='<div id="torc2">';cName2+="<span>",cName2+=ZPI18N.getString("zp.hostoraliascname"),cName2+="</span>",cName2+="<span>",cName2+=cname,cName2+="</span>",cName2+="</div>";var cName3='<div id="torc3">';cName3+="<span>"+ZPI18N.getString("zp.pointo")+";</span>",cName3+="<span>",cName3+="<b>",cName3+=cnamedest,cName3+="</b>",cName3+="</span>",cName3+="</div>";var cName4='<div id="torc4"><p><span>3.'+ZPI18N.getString("zp.plswaitcname")+"</span></p></div>",cName5='<div class="zps_lnkDv" id="torc5"><p><a href="'+url_currentdomain+'/people/help/adminguide/overview-orgsettings.html#domains" target="_blank">'+ZPI18N.getString("zp.clickhere")+"</a>"+ZPI18N.getString("zp.tofollownotecname")+"</p></div>";$("p#torc1").replaceWith(cName1),$("div#torc2").replaceWith(cName2),$("div#torc3").replaceWith(cName3),$("div#torc4").replaceWith(cName4),$("div#torc5").replaceWith(cName5),$("input#cnameRadio").prop("checked",!0),Organization.showCnameOrTxt=!1,Organization.canSendCname=!0}else if(Organization.showtxt){Organization.canSendCname=!1;var tXT1='<p id="torc1"><span>2.</span>'+ZPI18N.getString("zp.addtxtrec")+"</p>",tXT2='<div id="torc2">';tXT2+="<span>",tXT2+=ZPI18N.getString("zp.hostoraliastxt"),tXT2+="</span>",tXT2+="<span>",tXT2+=ZPI18N.getString("zp.blankorat"),tXT2+="</span>",tXT2+="</div>";var tXT3='<div id="torc3">';tXT3+="<span>"+ZPI18N.getString("zp.pointo")+"</span>",tXT3+="<span>",tXT3+=txt,tXT3+="</span>",tXT3+="</div>";var tXT4='<div id="torc4"><p><span>3.</span>'+ZPI18N.getString("zp.plswaittxt")+"</p></div></div>",tXT5='<div class="zps_lnkDv" id="torc5"><p><a href="'+url_currentdomain+'/people/help/adminguide/overview-orgsettings.html#domains" target="_blank">'+ZPI18N.getString("zp.clickhere")+"</a>"+ZPI18N.getString("zp.tofollownotetxt")+"</p></div></div>";$("p#torc1").replaceWith(tXT1),$("div#torc2").replaceWith(tXT2),$("div#torc3").replaceWith(tXT3),$("div#torc4").replaceWith(tXT4),$("div#torc5").replaceWith(tXT5),$("input#txtRadio").prop("checked",!0)}}function decodeTxt(txt){var tempdiv=$("<div></div>");return(tempdiv=$(tempdiv)).html(txt),txt=tempdiv.text()}TemplateList.showAndHideTemplateEditPopUp=function(tempName,tempMsg){$("div.ze,div#templateNameErr").remove(),$("div#outerDiv,div.temp-editview").removeClass("hide"),$("input#titleBox").is(":visible")||$("input#titleBox").val(tempName),$("a#savetemplate").text(i18n.save).attr("onclick","TemplateList.saveTemplate(this)"),createNewUIEditor("templatecomposetextarea"+Layout.tempType,"templatemailtextarea"+Layout.tempType),editor.setContent(tempMsg),$("div.tempPreview").addClass("DN"),isEmpty(tempName)&&isEmpty(tempMsg)&&($("div#outerDiv").addClass("hide"),$("div#titleEditOptn").addClass("hide"),$("span#editHead").hide(),$("table#templatelisttable").find("tr").removeClass("active")),Layout.tempId=null},TemplateList.addTemplate=function(){isEmpty(TemplateList.clonePopUp)||($("div#outerDiv").html(TemplateList.clonePopUp),TemplateList.clonePopUp=""),$("div#addTempTypeGroup").find("input[type='radio']").on("click",function(){TemplateList.currentTempType=$(this).val()}),$("div.zptedi").hide(),TemplateList.actionType="addTemplate",TemplateList.firstFormObj=$("select[accessType='view']").find("option")[1];var formIdenty=$("select[accessType='view']").val()===zpi18n.alltemplates?$(TemplateList.firstFormObj).val():$("select[accessType='view']").val();$("div#addTempTypeGroup").find("input[value='"+Layout.tempType+"']").prop("checked",!0),TemplateList.getFormComponentDetails(formIdenty),$("div#addTemplateFormComp").show(),TemplateList.currentTempType=Layout.tempType},TemplateList.addTemplateContent=function(){$("div.ze,div.orgDiv").remove(),createNewUIEditor("addTemplatecomposetextarea"+Layout.tempType,"addTemplatemailtextarea"+Layout.tempType),$("a#savetemplate1").text(i18n.save).attr("onclick","TemplateList.saveTemplate(this)"),$("div[name='addTemplate"+Layout.tempType+"']").toggleClass("hide animated fadeInRight"),$("div#outerDiv").addClass("hide"),TemplateList.actionType="addTemplate",$("input#addTemplateName").val(""),$("div#"+Layout.tempType).toggleClass("hide")},TemplateList.addreplacefields=function(){editor.insertHTML($("#fieldLabelBox").val())},TemplateList.showPreview=function(templateName,templateMessage,templateID,formName,formId){$("span#editHead").show(),isEmpty(TemplateList.clonePopUp)||($("div#outerDiv").html(TemplateList.clonePopUp),TemplateList.clonePopUp=""),$("a#savetemplate").text(zpi18n["common.edit"]).attr("onclick","TemplateList.editForm(this,'editfromEditorBox')"),$("div#outerDiv").find("div.dvslide-popup").removeClass("DN"),"addTemplate"===TemplateList.actionType&&$("div[name='addTemplate"+Layout.tempType+"']").addClass("hide"),$("div#outerDiv").removeClass("hide"),$("a#savetemplate").parent("div.dvslide-foo").attr("templateId",templateID),$("a#savetemplate").parent("div.dvslide-foo").attr("formId",formId),$("a#savetemplate").text(zpi18n["common.edit"]).attr("onclick","TemplateList.editForm(this,'editfromEditorBox')"),isEmpty(templateMessage)&&(templateMessage=$("table#templatelisttable tbody").find("tr[templateId='"+templateID+"']").data("templateMessage")),$("table#templatelisttable tbody").find("tr[class='active']").attr("class",""),$("table#templatelisttable tbody").find("tr[templateId="+templateID+"]").attr("class","active"),$("div[name='templateMessage']").find("iframe").text(templateMessage),$("div.temp-editview").addClass("hide"),$("div.tempPreview").removeClass("DN"),$("span#editHead").text(templateName),$("div#formComp").hide(),$("div.dvslide-overlay").addClass("hide"),$("label#formNameView").text(formName),TemplateList.formId=$("table#templatelisttable tbody").filter(":visible").find("tr[templateId="+templateID+"]").attr("formId"),TemplateList.setContentIntoIframe(templateMessage)},TemplateList.editForm=function(clickObj,isClone){cloneType=typeof isClone,TemplateList.actionType=isClone&&"boolean"===cloneType?"cloneTemplate":"editTemplate",isEmpty(TemplateList.clonePopUp)||($("div#outerDiv").html(TemplateList.clonePopUp),TemplateList.clonePopUp=""),"editfromEditorBox"===isClone?(TemplateList.formId=$(clickObj).parent("div").attr("formID"),TemplateList.templateId=$(clickObj).parent().attr("templateId")):(TemplateList.formId=$(clickObj).closest("tr").attr("formID"),TemplateList.templateId=$(clickObj).closest("tr").attr("templateId"),$("div#titleEditOptn").addClass("hide")),TemplateList.currentTempType=Layout.tempType,$("div#tempTypeGroup").find("input[value='"+Layout.tempType+"']").prop("checked",!0),TemplateList.getFormComponentDetails(TemplateList.formId,isClone,cloneType,clickObj),$("div#tempTypeGroup").find("input[type='radio']").on("click",function(){TemplateList.currentTempType=$(this).val()}),$("span#editHead").text($("a#tempnameView"+TemplateList.templateId).text()),$("div#titleEditOptn").is(":visible")||$("span#editHead").show(),TemplateList.editTemplateName(),$(clickObj).closest("tr").addClass("active"),$("div#formComp").show()},TemplateList.editTemplateName=function(thisObj){$("input#titleBox").val($(Layout.containerid).find("span#editHead").text()),$("span#editHead").hide(),$("div#titleEditOptn").removeClass("hide")},TemplateList.editTemplateContent=function(isClone,cloneType,clickObj){$("div#outerDiv").find("div.dvslide-popup").removeClass("DN"),TemplateList.templateId="editfromEditorBox"!==isClone?$(clickObj).closest("tr").attr("templateID"):$(clickObj).parent().attr("templateID"),TemplateList.formId="editfromEditorBox"!==isClone?$(clickObj).closest("tr").attr("formID"):$(clickObj).parent().attr("formID"),params={formid:TemplateList.formId,templateId:TemplateList.templateId,temptype:Layout.tempType,method:"editTemplate",conreqcsr:csrfToken},isClone&&"boolean"===cloneType&&(params.isClone=!0);var templateObj=$("table#templatelisttable tbody").filter(":visible").find("tr[templateId='"+TemplateList.templateId+"']");$("table#templatelisttable tbody").find("tr[class='active']").attr("class",""),$("table#templatelisttable tbody").find("tr[templateId='"+TemplateList.templateId+"']").attr("class","active");var templateMsg=templateObj.data("templateMessage"),templateName=templateObj.attr("templateName");$("div.orgDiv").remove(),"cloneTemplate"===TemplateList.actionType?$("div#tempType").removeClass("hide"):$("div#tempType").addClass("hide"),$("div[name='addTemplate"+Layout.tempType+"']").addClass("hide"),$("div[name='addTemplate"+Layout.tempType+"']").find("div.ze").remove(),TemplateList.isTempListCountExceed=!1,TemplateList.showAndHideTemplateEditPopUp(templateName,templateMsg)},TemplateList.saveTemplate=function(saveObj,event){TemplateList.isError=!1;var tempName="addTemplate"===TemplateList.actionType?$("div[name='addTemplate"+Layout.tempType+"']").find("input#addTemplateName").val():$(Layout.containerid).find("input#titleBox").val(),tempNameId="addTemplate"===TemplateList.actionType?"addTemplateName":"titleBox";if(TemplateList.validatetemplate(tempName,Layout.tempType,"editorRow",tempNameId),!TemplateList.isError){$("span#editHead").text($("input#titleBox").val());"addTemplate"===TemplateList.actionType?$("div#addTempTypeGroup").find("input[type='radio']:checked").val():$("div#tempTypeGroup").find("input[type='radio']:checked").val();var params={formid:TemplateList.formId,templateName:tempName,templateMessage:editor.getContent(),method:"saveTemplate",conreqcsr:csrfToken};"editTemplate"!==TemplateList.actionType&&(params.temptype=TemplateList.currentTempType),params.templateId="cloneTemplate"===TemplateList.actionType||"addTemplate"===TemplateList.actionType?0:TemplateList.templateId,$.post("/saveTemplate.zp",params,function(data){var newTemplateId="editTemplate"!==TemplateList.actionType?data.templateID:TemplateList.templateId;if(!isEmpty(data)&&data.result===zpi18n["common.success"]){TemplateList.isExceeded=data,$("table#templatelisttable tbody").find("tr[templateId='"+TemplateList.templateId+"']").attr("formId",$("div#outerDiv").find("select#formname").val()),Layout.showStatusMsg(data.result,"succMsg"),$("div#outerDiv").find("a#savetemplate").parent().attr("templateId",data.templateID).attr("formid",TemplateList.formId),$("a#savetemplate").text(zpi18n["common.edit"]).attr("onclick","TemplateList.editForm(this,'editfromEditorBox')"),TemplateList.isPopupBoxAllowToBeAsEditMode=!0,$("span#editHead").show(),$("div#titleEditOptn").addClass("hide");var formName=$("select#formname").filter(":visible").find("option:selected").text();Layout.tempType===parseInt(TemplateList.currentTempType)?TemplateList.updateList(tempName,$("table#templatelisttable").find("tbody"),newTemplateId,TemplateList.formId):(0===Layout.tempType?(window.location.hash="#admin/formslayout/templates/recordtemplatelist",Layout.tempType=1,1==$("div.ZPcontwrap").find("div#sub-admin-templates-recordtemplatelist").length&&(Layout.containerid=$("div#sub-admin-templates-recordtemplatelist"),window.onhashchange=function(){$("#"+Layout.tempType).addClass("hide"),$("div.dvslide-outer:visible").addClass("hide"),isEmpty(Layout.formId)||($("div#sub-admin-templates-recordtemplatelist").show(),$("div#sub-admin-templates-emailtemplatelist").hide(),$("select[accesstype='view']").filter(":visible").val(Layout.formId).trigger("change"),formName=$("select#formname").find("option[value="+Layout.formId+"]").text(),TemplateList.formId=Layout.formId),Layout.getTabs("admintabs")})):(window.location.hash="#admin/formslayout/templates/emailtemplatelist",Layout.tempType=0,1==$("div.ZPcontwrap").find("div#sub-admin-templates-emailtemplatelist").length&&(Layout.containerid=$("div#sub-admin-templates-emailtemplatelist"),$("#"+Layout.tempType).addClass("hide"),$("div.dvslide-outer:visible").addClass("hide"),window.onhashchange=function(){isEmpty(Layout.formId)||($("div#sub-admin-templates-emailtemplatelist").show(),$("div#sub-admin-templates-recordtemplatelist").hide(),$("select[accesstype='view']").filter(":visible").val(Layout.formId).trigger("change"),formName=$("select#formname").find("option[value="+Layout.formId+"]").text(),TemplateList.formId=Layout.formId),Layout.getTabs("admintabs")})),Layout.formId=TemplateList.formId,Layout.tempId=newTemplateId,Layout.shiftedTemplateRowObj.tempId=newTemplateId,Layout.shiftedTemplateRowObj.templateMessage=editor.getContent(),Layout.shiftedTemplateRowObj.formName=$("select#formname option:selected").filter(":visible").text(),Layout.shiftedTemplateRowObj.tempName=tempName,$("table#templatelisttable").remove(),$("div[name='addTemplate"+Layout.tempType+"'],div.dvslide-overlay").addClass("hide"),$(Layout.containerid).find("input#titleBox").val($(Layout.containerid).find("a#tempnameView"+newTemplateId).text())),TemplateList.showPreview(tempName,editor.getContent(),newTemplateId,formName,TemplateList.formId),$("table#templatelisttable tbody").find("tr[templateId='"+data.templateID+"']").data({templateMessage:editor.getContent()}),$("table#templatelisttable tbody").find("tr[templateId='"+newTemplateId+"']").attr("templateName",tempName),$(saveObj).parent().attr("formID",$("table#templatelisttable tbody").find("tr[templateId='"+TemplateList.templateId+"']").attr("formId")),$("table#templatelisttable tbody").find("tr[class='active']").attr("class",""),$("table#templatelisttable tbody").find("tr[templateId='"+newTemplateId+"']").attr("class","active"),TemplateList.actionType="addTemplate",TemplateList.templateId=newTemplateId,$("div#tempTypeGroup,div#addTempTypeGroup").find("input[type='radio']").prop("checked",!1)}})}},TemplateList.validatetemplate=function(templateName,templateType,editorElmId,templateNameId){isEmpty(templateName)?ZPSetupCommon.showErr(i18n.template_msgtemplatenotempty,$("input#"+templateNameId).parent(),"templateNameErr"):$("div#templateNameErr").remove(),$("select[accessType='view']").find("option:selected").text()===i18n.selectopt&&ZPSetupCommon.showErr(i18n.formnameempty,$("select[accessType='view']").parent());var getmessage=editor.getContent(),templateMessage=getmessage.replace(/(?:&nbsp;|<br>)/g,"");""===$.trim(templateMessage)?ZPSetupCommon.showErr(i18n.mailalert_msgnotempty,$("div#"+editorElmId),"templateMsgErr"):getmessage.length>1e5?ZPSetupCommon.showErr(i18n.announcement_lengthexceedsmessage,$("div#"+editorElmId),"templateMsgErr"):$("div#templateMsgErr").remove(),1===templateType&&(templateMessage.indexOf("${Person performing this action}")>=0||templateMessage.indexOf("${Reporting To}")>=0)&&ZPSetupCommon.showErr("Document Template should not contains Person performing this action/Reporting to",$("div#templatecomposetextarea").parent())},TemplateList.deleteTemplate=function(deleteIcon){if(confirm(i18n.template_deletconfmsg)){var status,parameters={templateId:$(deleteIcon).closest("tr").attr("templateID"),tempname:$(deleteIcon).closest("tr").attr("templateName"),method:"deleteTemplate",conreqcsr:csrfToken};$.post("/deleteTemplate.zp",parameters,function(data){isEmpty(data)||data.result!==zpi18n["common.success"]?status="errorMsg":($(deleteIcon).closest("tr").remove(),$("table#templatelisttable").find("tr").removeClass("active"),status="succMsg",Layout.templateCount=parseInt(Layout.templateCount)-1,removeTextNode($("span#templateListCount")),$("span#templateListCount").append(document.createTextNode(Layout.templateCount)),TemplateList.isTempListCountExceed=data.isAllowToAddTemplate,TemplateList.actionType="deleteTemplate",$("#outerDiv").addClass("hide")),Layout.showStatusMsg(data.result,status),0===Layout.templateCount&&$(Layout.containerid).find("table#templatelisttable tbody").append(jQuery("<tr></tr>").append(jQuery("<td></td>",{width:"25%"})).append(jQuery("<td></td>",{text:zpi18n.notconfigured})))})}},TemplateList.updateList=function(tempname,obj,tempId,formId){if($("select[accessType='view']").val()===formId){var styleCol,styleCol1;if("addTemplate"===TemplateList.actionType||"cloneTemplate"===TemplateList.actionType)Layout.templateCount=parseInt(Layout.templateCount)+1,removeTextNode($("span#templateListCount")),$("span#templateListCount").append(document.createTextNode(Layout.templateCount)),0===$("table#templatelisttable").find("tr").length&&(styleCol="width:6%",styleCol1="width:30%"),TemplateList.createTemplateListRow(tempname,obj,tempId,formId,styleCol,styleCol1);"editTemplate"===TemplateList.actionType&&$("a#tempnameView"+tempId).text(tempname),"deleteTemplate"===TemplateList.actionType&&$("tr[templateID="+tempId+"]").remove()}else TemplateList.autoMaticChanged=!0,$("select[accessType='view']").val(formId).trigger("change"),$("#listDiv").closest("tr[templateId='"+tempId+"']").attr("class","active")},TemplateList.createTemplateListRow=function(tempName,obj,templateId,formId,styleColm,styleColm1){var column1=jQuery("<td></td>",{style:styleColm}),tempNameaTag=jQuery("<a></a>",{text:tempName,onclick:"TemplateList.showPreview('"+tempName+"','','"+templateId+"')",id:"tempnameView"+templateId}),tempNameDiv=jQuery("<div></div>",{class:"ac-email"}),column2=jQuery("<td></td>",{html:$(tempNameDiv).append(tempNameaTag)}),cloneIc=jQuery("<a></a>",{id:"cloneicon",class:"IC-clone S16 MR30 ZPtooltip tooltipstered",onclick:"TemplateList.editForm(this,true)"}),editIc=jQuery("<a></a>",{id:"editicon",class:"IC-pen S16 ZPtooltip tooltipstered",onclick:"TemplateList.editForm(this)"}),addIc=jQuery("<a></a>",{id:"deleteicon",class:"IC-delete ML30 S16 ZPtooltip tooltipstered",onclick:"TemplateList.deleteTemplate(this)"}),icsParent=jQuery("<div></div>",{class:"dvlist-action",templateName:tempName}),column3=jQuery("<td></td>",{style:styleColm1,html:$(icsParent).append(cloneIc).append(editIc).append(addIc)}),row=jQuery("<tr></tr>",{templateId:templateId,templatename:tempName,formId:formId});$(obj).append($(row).prepend(column3).prepend(column2).prepend(column1)),$(obj).find("div.noRec").closest("tr").remove()},TemplateList.setContentIntoIframe=function(content){var iframe=document.createElement("iframe");iframe.setAttribute("frameBorder","0"),iframe.setAttribute("scrolling","auto"),iframe.setAttribute("width","100%"),iframe.setAttribute("class","zpdfpre"),iframe.setAttribute("height","350px"),iframe.setAttribute("src",ZPeople.getResourceURL(htmlUrl+"templateContent.html")),$('div[class="ZPpage-cont"]:visible').find('div[name="templateMessage"]:visible').html(iframe),setTimeout(function(){var checkType=iframe.document;iframe.contentDocument?checkType=iframe.contentDocument:iframe.contentWindow&&(checkType=iframe.contentWindow.document),checkType.open(),checkType.writeln(content),checkType.close()},1e3)},TemplateList.getFormComponentDetails=function(formId,isclone,cloneType,clickObj){var mode="editTemplate"===TemplateList.actionType?"edit":"";TemplateList.formId=formId,$.post("/getFormCompDetails.zp",{formId:formId,method:"createEditor",mode:mode},function(data){var formCompElmId;isEmpty(data.error)&&"editTemplate"!==TemplateList.actionType||"editTemplate"===TemplateList.actionType?($("div.PB0").remove(),"addTemplate"===TemplateList.actionType?(formCompElmId="addTemplateAllRelatedFormList",$("div#tempType").removeClass("hide")):formCompElmId="allRelatedFormList",$("div#editComponents").prepend(Layout.setFormComponentDtls(data,formCompElmId)),$.each(data.formNameMap,function(formType,value){$("select#"+formCompElmId).append(jQuery("<option></option>",{value:formType,text:value.lookupFullName,id:formType}))}),$("select#"+formCompElmId).append(jQuery("<option></option>",{value:"other",text:zpi18n.systemfields})),$("div#allFieldListCombos").append(jQuery("<select></select>",{style:"display:none",id:"other_fields",class:"form-control selectBox"})),$.each(data.formComponentMap,function(fieldType,value){$("div#allFieldListCombos").append(jQuery("<select></select>",{style:"display:none",id:fieldType+"_fields",class:"selectBox",onchange:"TemplateList.insertCompInFieldBox(this)"}).append(jQuery("<option></option>"))),$.each(value,function(sectionName,field){$("div#allFieldListCombos").find("select[id='"+fieldType+"_fields']").append(jQuery("<optgroup></optgroup>",{label:sectionName})),$.each(value[sectionName],function(secName,displayName){$("select[id='"+fieldType+"_fields']").find("optgroup[label='"+sectionName+"']").append(jQuery("<option></option>",{value:displayName.displayName,text:displayName.displayName}))})})}),$("#"+$("select#"+formCompElmId).val()+"_fields").show(),"changeForm"!==cloneType&&("editTemplate"===TemplateList.actionType||"cloneTemplate"===TemplateList.actionType?TemplateList.editTemplateContent(isclone,cloneType,clickObj):TemplateList.addTemplateContent(),$("select#formname").filter(":visible").find("option").prop("selected",!1),$("select#formname").filter(":visible").find("option[value='"+formId+"']").attr("selected","selected"),$("select#formname").filter(":visible").val(formId),TemplateList.showFormComponentDtls(formCompElmId),TemplateList.isTempListCountExceed=!1),TemplateList.constructCompanyDetailsOfEditor()):($("div#popup").remove(),TemplateList.isTempListCountExceed=data.error,$("body.ZPtheme-blue").append(Layout.paymentErrorMsgPopUp(data.paymenturl))),$("select#"+$("select#"+formCompElmId).val()+"_fields,select#"+formCompElmId+",select#formname").select2()})},TemplateList.showFormComponentDtls=function(id){$("div#formComp").filter(":visible").find("#"+id).on("change",function(){var selectedFormValue=$(this).val();$("div#formComp").filter(":visible").find("#allFieldListCombos").children("select").val("").hide(),$("div#formComp").filter(":visible").find("#fieldLabelBox").val(""),$("div#formComp").filter(":visible").find("#"+selectedFormValue+"_fields").show(),$("div#formComp").filter(":visible").find("#allFieldListCombos").children("select").attr("class","form-control")}),$("div#formComp").filter(":visible").find("#allFieldListCombos select").on("change",function(){var selectedValue=$(this).val();selectedValue.length>0?(selectedValue="${"+selectedValue+"}",$("div#formComp").filter(":visible").find("#fieldLabelBox").val(selectedValue)):$("div#formComp").filter(":visible").find("#fieldLabelBox").val("")})},TemplateList.constructCompanyDetailsOfEditor=function(){var timezoneDtls={"zoho.currentdate":zpi18n.currentdate,"zoho.currenttime":zpi18n.currentdatetime},companyDtls={companyLogo:zpi18n.companylogo,companyName:zpi18n.companyname,companyFirstAddress:zpi18n.companyfirstaddr,companySecondAddress:zpi18n.companysecondaddr,companyCity:zpi18n.companycity,companyState:zpi18n.companystate,companyCountry:zpi18n.companycountry,companyZipcode:zpi18n.companyzipcode,companyWebsite:zpi18n.companywebsite,companyContactPerson:zpi18n.companycontactperson,companyContactNumber:zpi18n.companycontactnumber},checklistDtls={checkItemOwner:zpi18n.checklistowner,checklistName:zpi18n.checklistname,checklistItemName:zpi18n.checklistitemname};$("select#other_fields").append(jQuery("<option></option>")).append(jQuery("<option></option>",{text:zpi18n.personaction,value:"Person performing this action"})).append(jQuery("<option></option>",{text:zpi18n.reportingto,value:"Reporting To"})).append(jQuery("<option></option>",{text:zpi18n.recordurl,value:"RecordURL"})),$("select#other_fields").append(jQuery("<optgroup></optgroup>",{label:zpi18n.timezonedtls,name:"timezoneDtls"})).append(jQuery("<optgroup></optgroup>",{label:zpi18n.companydtls,name:"companydtls"})).append(jQuery("<optgroup></optgroup>",{label:zpi18n.companydtls,name:"checklistDtls"})),$.each(timezoneDtls,function(key,value){$("select#other_fields").find("optgroup[name='timezoneDtls']").append(jQuery("<option></option>",{text:value,value:key}))}),$.each(companyDtls,function(key,value){$("select#other_fields").find("optgroup[name='companydtls']").append(jQuery("<option></option>",{text:value,value:key}))}),$.each(checklistDtls,function(key,value){$("select#other_fields").find("optgroup[name='checklistDtls']").append(jQuery("<option></option>",{text:value,value:key}))})},TemplateList.addreplacefields=function(){editor.insertHTML($("div.PB0:visible").find("input#fieldLabelBox").val())},TemplateList.handlePaymentErrMsg=function(){$("div#outerDiv").find("div.dvslide-popup").addClass("DN"),TemplateList.clonePopUp=$("div#outerDiv").children().clone(),$("div#outerDiv").html(zpi18n.templateupgrademsg).removeClass("hide")},TemplateList.changeFormComp=function(formCmpElmId){var selectedFormValue=$("div#formComp").filter(":visible").find("select#"+formCmpElmId).val();$("div#formComp").filter(":visible").find("#allFieldListCombos").children("span.select2").hide(),$("#fieldLabelBox").val(""),$("div#formComp").filter(":visible").find("#"+selectedFormValue+"_fields").show(),$("div#formComp").filter(":visible").find("#"+selectedFormValue+"_fields").select2({width:"resolve"})},TemplateList.insertCompInFieldBox=function(obj){var selectedValue=$(obj).val();selectedValue.length>0?(selectedValue="${"+selectedValue+"}",$("div#formComp").filter(":visible").find("#fieldLabelBox").val(selectedValue)):$("#fieldLabelBox").val("")},TemplateList.editAndUpdateTemplateName=function(clickObj){var templateId=$(clickObj).closest("tr").attr("templateId");$("div#tempNameErr").remove(),$("input#templateRenameBox").val(""),$("a#updateName").on("click",function(){isEmpty($("input#templateRenameBox").val())?ZPSetupCommon.showErr(i18n.template_msgtemplatenotempty,$("input#templateRenameBox").parent(),"tempNameErr"):$.post("/updateTemplateName.zp",{method:"saveTemplateName",templateId:templateId,templateName:$("input#templateRenameBox").val(),conreqcsr:csrfToken},function(data){data.result===zpi18n["common.success"]?($("div#dvTempalateName,div.modal-backdrop").removeClass("in"),$("div#dvTempalateName,div.modal-backdrop").hide(),Layout.showStatusMsg(data.result,"succMsg"),$(clickObj).closest("tr").find("a#tempnameView"+templateId).text($("input#templateRenameBox").val()),$(clickObj).closest("tr").attr("templateName",$("input#templateRenameBox").val())):Layout.showStatusMsg(data.result,"errorMsg")})}),document.getElementById("dvTempalateName").onhide=function(){$("a#updateName").off("click")}},Organization.startIndex=0,Organization.dataCount=0,Organization.dispType="gridview",Organization.initialDataCount=0,Organization.ManageOrgs={formId:null,viewId:null,streamDependency:!0},Organization.refreshStats=!1,Organization.ManageDomain={},Organization.forModalCloseCallback=function(){Organization.refreshStats&&("admin/organization/departments"==Layout.Page.currentmode&&(Organization.refreshStats=!1,Organization.ManageOrgs.manageDeptInit()),"admin/organization/designationdetails/designations"==Layout.Page.currentmode&&(Organization.refreshStats=!1,Organization.ManageOrgs.manageDesgInit()),"admin/organization/designationdetails/streams"==Layout.Page.currentmode&&(Organization.refreshStats=!1,Organization.ManageOrgs.manageStreamInit()),"admin/organization/locations"==Layout.Page.currentmode&&(Organization.refreshStats=!1,Organization.ManageOrgs.manageLocInit()))},Organization.ManageOrgs.manageDeptInit=function(){if(Organization.startIndex=0,$(window).width()>1440)var params={conreqcsr:csrfToken,method:"getDepartmentsDetails",startInd:Organization.startIndex,getMoreData:"getMoreData"};else params={conreqcsr:csrfToken,method:"getDepartmentsDetails",startInd:Organization.startIndex};Layout.Page.container.html(Organization.ZP_PAGE_LOADING),ZPeople.Request.send("/getDepartmentsList.zp",params,Organization.ManageOrgs.iterateManageDeptDtls)},Organization.ManageOrgs.iterateManageDeptDtls=function(resultData){if("displayErrorMsgDepartment"==resultData.deptordesg){Layout.Page.container.find("#zp_page_loading").remove(),(pageContent=$("div#admin-organization-departments")).append(Organization.ManageOrgs.constructEmptyIcon("displayErrorMsgDepartment"))}else{var url_domain=ZPeople.ZOHOURL,pageContent=$("div#admin-organization-departments"),deptDtlsObj=(Layout.Page.currentmode.split("/")[2],$("body#ZPwrapper"),'<div class="deptsettings" id="deptParent">');deptDtlsObj+=Organization.ManageOrgs.constructHeaderElements(ZPI18N.getString("zp.managedeptnotes"),ZPI18N.getString("zp.manageadddept"),resultData.formId,resultData.displayName),deptDtlsObj+='<div class="ZPTscrlcont" id="scrollContent" onscroll=User.userListfireScroll(this,"'+resultData.numRows+'")>',deptDtlsObj+=Organization.ManageOrgs.constructDepartmentDtlsElmsGridView(resultData.deptDtls,resultData,"departments"),deptDtlsObj+=Organization.ManageOrgs.constructDepartmentDtlsElmsListView(resultData.deptDtls,resultData,"departments"),deptDtlsObj+="</div></div>",pageContent.html(deptDtlsObj),Organization.ManageOrgs.showDeptDesgLocView("departments"),$("a#addDepartMent").on("click",function(){animatePopUpIn("addDeptPopUp")});var url_diffdomain=url_domain+"/people/help/manage-departments.html";pageContent.find("a#helpLink").attr("href",url_diffdomain),$("a#departmentPopUpCancel,a#addDeptCancel").on("click",function(){animatePopUpOut()}),resultData.numRows>0?(pageContent.find("a#sort_menu").removeAttr("disabled"),pageContent.find("table#listOf_departments").find("thead").removeClass("DN")):(pageContent.find("a#sort_menu").attr("disabled","disabled"),pageContent.find("table#listOf_departments").find("thead").addClass("DN")),Organization.ManageOrgs.formId=resultData.formId,Organization.dataCount=Object.keys(resultData.deptDtls).length,Organization.startIndex=Organization.startIndex+Object.keys(resultData.deptDtls).length}},Organization.ManageOrgs.manageDesgInit=function(){if(Organization.startIndex=0,$(window).width()>1440)var params={conreqcsr:csrfToken,method:"getDesignationsDetails",startInd:Organization.startIndex,getMoreData:"getMoreData"};else params={conreqcsr:csrfToken,method:"getDesignationsDetails",startInd:Organization.startIndex};Layout.Page.container.html(Organization.ZP_PAGE_LOADING),ZPeople.Request.send("/getDesignationsList.zp",params,Organization.ManageOrgs.iterateManageDesgDtls)},Organization.ManageOrgs.getStreamSettingsValues=function(resultData){resultData.success?(Organization.ManageOrgs.streamDependency=resultData.isDependent,$("#zp_modal_streamsettings").find("#StreamDependSettings").prop("checked",Organization.ManageOrgs.streamDependency),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.dependencychanged"))):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererroroccured")),Organization.ManageOrgs.manageStreamInit()},Organization.ManageOrgs.getStreamSettings=function(){0==$("#zp_modal_streamsettings").length?Organization.ManageOrgs.constructModalPopUp():$("#zp_modal_streamsettings").show(),$("#zp_modal_streamsettings").find("#StreamDependSettings").prop("checked",Organization.ManageOrgs.streamDependency);var msg=ZPI18N.getString("zp.streamsarenotdesignationsdependent");Organization.ManageOrgs.streamDependency&&(msg=ZPI18N.getString("zp.streamsaredesignationsdependent")),$("#zp_modal_streamsettings").find("#streamDependInfo").html(msg)},Organization.ManageOrgs.streamSettingsInfoChange=function(obj){$(obj).prop("checked")?$("#zp_modal_streamsettings").find("#streamDependInfo").html(ZPI18N.getString("zp.streamsaredesignationsdependent")):$("#zp_modal_streamsettings").find("#streamDependInfo").html(ZPI18N.getString("zp.streamsarenotdesignationsdependent"))},Organization.ManageOrgs.saveSettings=function(obj){obj.find("#saveBtn").addClass("disabled");var isDependent=obj.find("input[id=StreamDependSettings]").prop("checked");if(isDependent!==Organization.ManageOrgs.streamDependency){var params={isDependent:isDependent,conreqcsr:csrfToken,method:"updateStreamDependency"};ZPeople.Request.send("/updateStreamDependency.zp",params,Organization.ManageOrgs.getStreamSettingsValues)}obj.find("#saveBtn").removeClass("disabled")},Organization.ManageOrgs.constructModalPopUp=function(){var modal=ZPeople.BSModal.get({id:"zp_modal_streamsettings",type:2,body:'<div class="form-horizontal pad" id="settingDtls"><div><label class="checkbox DIB col-md-12 S15"><input class="chkbox" type="checkbox" id="StreamDependSettings" \tonchange="Organization.ManageOrgs.streamSettingsInfoChange(this);"><span class="style1"></span>'+ZPI18N.getString("zp.associatestreamswithdesignations")+'</label></div><div id="streamDependInfo" class="dgry DIB W100 MT10 ML30 PL5"></div></div>',disableFooter:!1,closeonEsc:!0,buttonValue:ZPI18N.getString("zp.save"),disableHeader:!1,modalClass:"popRgtModel modal-right in",header:ZPI18N.getString("zp.streamssettings"),successCallback:Organization.ManageOrgs.saveSettings,deleteOnHide:!0,closeOnSubmit:!0});ZPeople.BSModal.show(modal)},Organization.ManageOrgs.manageStreamInit=function(){if(Organization.startIndex=0,$(window).width()>1440)var params={conreqcsr:csrfToken,method:"getStreamsDetails",stIndex:Organization.startIndex,getMoreData:"getMoreData"};else params={conreqcsr:csrfToken,method:"getStreamsDetails",stIndex:Organization.startIndex};Layout.Page.container.html(Organization.ZP_PAGE_LOADING),ZPeople.Request.send("/getStreamsList.zp",params,Organization.ManageOrgs.iterateManageStreamDtls)},Organization.ManageOrgs.iterateManageStreamDtls=function(resultData){if("displayErrorMsgStream"==resultData.streamErr){Layout.Page.container.find("#zp_page_loading").remove(),(pageContent=$("div#admin-organization-designationdetails-streams")).append(Organization.ManageOrgs.constructEmptyIcon("displayErrorMsgStream"))}else{ZPeople.ZOHOURL;Organization.ManageOrgs.streamDependency=resultData.isDependent,Organization.ManageOrgs.formId=resultData.formId,Organization.ManageOrgs.viewId=resultData.viewId;var pageContent=$("div#admin-organization-designationdetails-streams"),streamHeadElm='<div class="deptsettings designsettings" id="streamParent">';streamHeadElm+=Organization.ManageOrgs.constructHeaderElements(ZPI18N.getString("zp.streamnotes"),ZPI18N.getString("zp.addstream"),resultData.formId,resultData.displayName),streamHeadElm+='<div class="ZPTscrlcont ZPTscrlcontExt" id="scrollContent" onscroll=User.userListfireScroll(this,"'+resultData.numRows+'") >',!resultData.numRows>0&&(streamHeadElm+=Organization.ManageOrgs.constructEmptyIcon()),streamHeadElm+=Organization.ManageOrgs.constructDepartmentDtlsElmsListView(resultData.streamDtls,resultData,"streams"),streamHeadElm+="</div></div>",pageContent.html(streamHeadElm),$("[data-toggle=popover]").popover(),resultData.numRows>0?(pageContent.find("a#sort_menu").removeAttr("disabled"),pageContent.find("table#listOf_streams").find("thead").removeClass("DN")):(pageContent.find("a#sort_menu").attr("disabled","disabled"),pageContent.find("table#listOf_streams").find("thead").addClass("DN")),Organization.startIndex=Organization.startIndex+Object.keys(resultData.streamDtls).length,Organization.initialDataCount=Object.keys(resultData.streamDtls).length,Organization.dataCount=Object.keys(resultData.streamDtls).length,pageContent.find("a#helpLink").hide()}},Organization.ManageOrgs.iterateManageDesgDtls=function(resultData){if("displayErrorMsgDesignation"==resultData.deptordesg){Layout.Page.container.find("#zp_page_loading").remove(),(pageContent=$("div#admin-organization-designationdetails-designations")).append(Organization.ManageOrgs.constructEmptyIcon("displayErrorMsgDesignation"))}else{var url_domain=ZPeople.ZOHOURL,pageContent=$("div#admin-organization-designationdetails-designations"),desgHeadElm=(Layout.Page.currentmode.split("/")[3],'<div class="deptsettings designsettings" id="desgParent">');desgHeadElm+=Organization.ManageOrgs.constructHeaderElements(ZPI18N.getString("zp.desgnotes"),ZPI18N.getString("zp.adddesg"),resultData.formId,resultData.displayName),desgHeadElm+='<div class="ZPTscrlcont" id="scrollContent" onscroll=User.userListfireScroll(this,"'+resultData.numRows+'") >',desgHeadElm+=Organization.ManageOrgs.constructDepartmentDtlsElmsGridView(resultData.desgDtls,resultData,"designations"),desgHeadElm+=Organization.ManageOrgs.constructDepartmentDtlsElmsListView(resultData.desgDtls,resultData,"designations"),desgHeadElm+="</div></div>",pageContent.html(desgHeadElm),resultData.numRows>0?(pageContent.find("a#sort_menu").removeAttr("disabled"),pageContent.find("table#listOf_designations").find("thead").removeClass("DN")):(pageContent.find("a#sort_menu").attr("disabled","disabled"),pageContent.find("table#listOf_designations").find("thead").addClass("DN")),Organization.ManageOrgs.showDeptDesgLocView("designationdetails-designations"),Organization.startIndex=Organization.startIndex+Object.keys(resultData.desgDtls).length,Organization.initialDataCount=Object.keys(resultData.desgDtls).length,Organization.dataCount=Object.keys(resultData.desgDtls).length;var url_diffdomain=url_domain+"/people/help/manage-designations.html";pageContent.find("a#helpLink").attr("href",url_diffdomain)}},Organization.ManageOrgs.manageLocInit=function(){if(Organization.startIndex=0,$(window).width()>1440)var params={conreqcsr:csrfToken,method:"getLocationsDetails",startInd:Organization.startIndex,sortByType:"0",getMoreData:"getMoreData"};else params={conreqcsr:csrfToken,method:"getLocationsDetails",startInd:Organization.startIndex,sortByType:"0"};Layout.Page.container.html(Organization.ZP_PAGE_LOADING),ZPeople.Request.send("/getLocationsList.zp",params,Organization.ManageOrgs.iterateManageLocDtls)},Organization.ManageOrgs.iterateManageLocDtls=function(resultData){var url_domain=ZPeople.ZOHOURL,pageContent=$("div#admin-organization-locations"),locHeadElm=(Layout.Page.currentmode.split("/")[2],'<div class="deptsettings locsettings" id="locParent">');locHeadElm+=Organization.ManageOrgs.constructHeaderElements(ZPI18N.getString("zp.newlocnotes"),ZPI18N.getString("zp.addlocation"),resultData.formId),locHeadElm+='<div class="ZPTscrlcont" id="scrollContent" onscroll=User.userListfireScroll(this,"'+resultData.numRows+'") >',locHeadElm+=Organization.ManageOrgs.constructLocationDtlsGridView(resultData),locHeadElm+=Organization.ManageOrgs.constructLocationDtlsListView(resultData),locHeadElm+="</div>",locHeadElm+="</div>",pageContent.html(locHeadElm),resultData.numRows>0?(pageContent.find("a#sort_menu").removeAttr("disabled"),pageContent.find("table#listOf_locations").find("thead").removeClass("DN")):(pageContent.find("a#sort_menu").attr("disabled","disabled"),pageContent.find("table#listOf_locations").find("thead").addClass("DN")),Organization.ManageOrgs.showDeptDesgLocView("locations"),Organization.startIndex=Organization.startIndex+Object.keys(resultData.locationDtls).length,Organization.dataCount=Object.keys(resultData.locationDtls).length;var url_diffdomain=url_domain+"/people/help/manage-locations.html";pageContent.find("a#helpLink").attr("href",url_diffdomain)},Organization.ManageOrgs.constructHeaderElements=function(notes,popUpTitile,formId,displayName){var currMode=Layout.Page.currentmode.split("/")[2],isStream="designationdetails"==currMode&&"streams"==Layout.Page.currentmode.split("/")[3],mainHeadOfOrg='<div class="mainhead">';mainHeadOfOrg+='<div class="zprow">',mainHeadOfOrg+='<div class="zp-md-6">';var notesClass="zp-md-12 ";return isStream||(notesClass+="PT5"),mainHeadOfOrg+='<div class="'+notesClass+'">'+notes+"</div>",mainHeadOfOrg+="</div>",mainHeadOfOrg+='<div class="zp-md-6 text-right">',mainHeadOfOrg+='<div class="zp-md-12" id="headeOptns">',"domains"===currMode?mainHeadOfOrg+='<div class="btn-group" onclick="Organization.ManageOrgs.showAddDomainPopup()"><a id = "'+currMode+'" class="btn btn-primary btnPlus dvshwalert MR5">'+popUpTitile+"</a> </div>":"fromAddress"===currMode?mainHeadOfOrg+='<div class="btn-group" onclick="FromAddress.constructFromAddressPopUp()"><a id = "'+currMode+'" class="btn btn-primary btnPlus dvshwalert MR5">'+popUpTitile+"</a> </div>":"smtpconfiguration"===currMode&&(mainHeadOfOrg+='<div class="btn-group" onclick="SmtpConfig.Modal.constructPopUp()"><a id = "'+currMode+'" class="btn btn-primary btnPlus dvshwalert MR5">'+popUpTitile+"</a> </div>"),"domains"!==currMode&&"fromAddress"!==currMode&&"smtpconfiguration"!==currMode&&(isStream?(mainHeadOfOrg+='<div class="btn-group"><a class="btn btn-primary btnPlus dvshwalert MR5" onclick=User.getRecordPage("'+formId+'","","ADD")>'+popUpTitile+"</a></div>",mainHeadOfOrg+='<div class="btn-group"><button class="btn btn-default FR" onclick=Organization.ManageOrgs.getStreamSettings();>'+ZPI18N.getString("zp.streamssettings")+"</button></div>",mainHeadOfOrg+='<div class="btn-group"><div class="dropdown PR ZPCusDrs impexp ZPPdrop cust-dm">',mainHeadOfOrg+='<i data-toggle="dropdown" class="IC-more gry S20 CP ML10 dropdown-toggle" id="zp_impexp" aria-expanded="false"></i>',mainHeadOfOrg+='<ul class="dropdown-menu ZPCmn-Arrow top gray TBDD">',mainHeadOfOrg+='<li id="zp_stream_imp" style=""><a onclick=Organization.import("'+formId+'")><i class="IC-imprt DIB gry MR10"></i>'+ZPI18N.getString("zp.import")+"</a></li>",mainHeadOfOrg+='<li id="zp_stream_exp" style=""><a onclick="ZPExport.showExportContainer();"><i class="IC-exprt DIB gry MR10"></i>'+ZPI18N.getString("zp.export")+"</a></li>",mainHeadOfOrg+="</ul></div></div>"):("locations"===currMode?(mainHeadOfOrg+='<div class="btn-group"><a class="btn btn-primary btnPlus dvshwalert MR5" onclick=User.niceLocation("add",null,"'+formId+'"); </a>'+popUpTitile+" </div>",mainHeadOfOrg+='<div class="btn-group MR5" id="switchImport"><a onclick=Organization.import("'+formId+'") class="btn btn-default">'+ZPI18N.getString("zp.import"),mainHeadOfOrg+="</a></div>"):mainHeadOfOrg+='<div class="btn-group"><a class="btn btn-primary btnPlus dvshwalert MR5" onclick=User.getRecordPage("'+formId+'","","ADD")>'+ZPI18N.getString("zp.add")+" "+displayName+" </a></div>",mainHeadOfOrg+='<div class="btn-group MR10"><a data-toggle="dropdown" class="btn btn-default btn-small dropdown-toggle" id="sort_menu"><span class="IC-switch S12"></span></a>',mainHeadOfOrg+='<ul style="min-width:80px" role="menu" class="dropdown-menu bullet pull-right">',mainHeadOfOrg+='<li onclick=Organization.ManageOrgs.getSortListOfDeptDesgLoc(0,"'+currMode+'")><a>'+ZPI18N.getString("zp.sortbyalpha")+"</a></li>",mainHeadOfOrg+='<li onclick=Organization.ManageOrgs.getSortListOfDeptDesgLoc(2,"'+currMode+'")><a>'+ZPI18N.getString("zp.date")+"</a></li></ul></div>",mainHeadOfOrg+='<div class="btn-group ML5 viewswitch">',mainHeadOfOrg+='<a href="#dvDepart-grid" class="btn btn-default btn-small active" data-toggle="collapse" id="gridView" onclick=Organization.ManageOrgs.eventForChangeViewTypeOfManageDeptDesgLoc(this)><span class="IC-grid-v S12"></span></a>',mainHeadOfOrg+='<a href="#dvDepart-list" class="btn btn-default btn-small" data-toggle="collapse" id="listView" onclick=Organization.ManageOrgs.eventForChangeViewTypeOfManageDeptDesgLoc(this)><span class="IC-list-v S12"></span></a>',mainHeadOfOrg+="</div>")),mainHeadOfOrg+='<a class="btn-group pagetips" id="helpLink" target="_blank" onclick="ZPeople.Help.show()"><span class="IC-qus"></span></a>',mainHeadOfOrg+="</div>",mainHeadOfOrg+="</div>",mainHeadOfOrg+="</div>",mainHeadOfOrg+="</div>"},Organization.ManageOrgs.showAddDomainPopup=function(){var pageId=Layout.Page.container;pageId.find("#newDomainVal").val(""),pageId.find("#newDomainVal").parent().removeClass("has-error"),pageId.find("div#emptyDomainerrdiv,div.dverrormsg").remove()},Organization.ManageOrgs.constructDepartmentDtlsElmsGridView=function(data,dataobject,mode){Layout.Page.currentmode.split("/")[2],"departments"===mode?data.deptDtls:data.desgDtls,"departments"===mode?ZPI18N.getString("zp.manageadddept"):ZPI18N.getString("zp.adddesg");var deptDtlsMainDiv='<div class = "clearfix MT30 ML15 MR15" id="dvGridview">';return dataobject.numRows>0?($.each(data,function(index,depts){deptDtlsMainDiv+=Organization.ManageOrgs.constructDeptDesigContent(depts,deptDtlsMainDiv,dataobject)}),deptDtlsMainDiv+="</div>"):Organization.ManageOrgs.constructEmptyIcon()},Organization.ManageOrgs.constructDeptDesigContent=function(object,parent,dataobj){var currMode=Layout.Page.currentmode.split("/")[2],recPkID="departments"===currMode?object.DEPARTMENTID:object.DESIGNATIONID,formId=dataobj.formId,deptOrDesgName="departments"===currMode?object.DEPARTMENTNAME:object.DESIGNATIONNAME,mail="departments"===currMode?object.deptMail:object.MAILALIAS;mail=ZPSetupCommon.isEmpty(mail)?"":mail;var linkName="departments"===currMode?"P_Department":"P_Designation",deptDesgGridView='<div class="zp-md-3" recPkID='+recPkID+" formId="+formId+' id="gridViewParent">';(deptDesgGridView+='<div class="bgwhite">',deptDesgGridView+='<div class="zprow">',deptDesgGridView+=Organization.ManageOrgs.constructEditAndDeleteElmForGridView("Organization.ManageOrgs.deleteConfirmPopUp(this,'grid','"+linkName+"')",formId,recPkID),deptDesgGridView+='<div class="zp-md-12">',deptDesgGridView+='<div class="MB5">',deptDesgGridView+='<a class="depthead" onclick=User.getRecordPage("'+formId+'","'+recPkID+'","VIEW")>'+deptOrDesgName+"</a>",deptDesgGridView+="</div>",deptDesgGridView+="<p>"+mail+"</p>","departments"===currMode)?(deptDesgGridView+="<p>"+(ZPSetupCommon.isEmpty(object.DEPARTMENT_LEAD)?"":object.DEPARTMENT_LEAD)+"</p>",User.isNewUI=ZPeople.isZPNewUI(),User.isNewUI?deptDesgGridView+='<a class="spncount MT20" onclick = ZPUsers.showDeptById("'+recPkID+'")>'+object.membersCount+"</a></div></div></div></div>":deptDesgGridView+='<a class="spncount MT20" onclick = ZPUserList.showDeptById("'+recPkID+'")>'+object.membersCount+"</a></div></div></div></div>"):deptDesgGridView+='<div class="spncount MT20">'+object.membersCount+"</div></div></div></div></div>";return deptDesgGridView},Organization.ManageOrgs.constructDepartmentDtlsElmsListView=function(data,dataObj,mode){Layout.Page.currentmode.split("/")[2];var headerRow='<div id="dvListview" class="dvListview">';headerRow+="<table id='listOf_"+mode+"' class='table table-hover table-responsive tbldepart'>",headerRow+="<thead>",headerRow+="<tr>","departments"===mode?(headerRow+='<th class="text-center" width="2%"></th>',headerRow+='<th width="20%"><span class="CP">'+ZPI18N.getString("zp.deptname")+"</span></th>",headerRow+='<th width="15%"><span>'+ZPI18N.getString("zp.memberscount")+"</span></th>",headerRow+="<th><span>"+ZPI18N.getString("zp.deptmailalias")+"</span></th>",headerRow+='<th width="22%"><span>'+ZPI18N.getString("zp.depthead")+"</span></th>",headerRow+='<th width="12%"><span>'+ZPI18N.getString("zp.actions")+"</span></th></tr>"):"designations"===mode?(headerRow+='<th class="text-center" width="2%"></th>',headerRow+='<th width="22%"><span class="CP">'+ZPI18N.getString("zp.desgname")+"</span></th>",headerRow+='<th width="20%"><span>'+ZPI18N.getString("zp.memberscount")+"</span></th>",headerRow+="<th><span>"+ZPI18N.getString("zp.desgmail")+"</span></th>",headerRow+='<th width="12%"><span></span></th></tr>'):"streams"===mode&&(headerRow+='<th class="text-center" width="2%"></th>',headerRow+='<th width="22%"><span class="CP">'+ZPI18N.getString("zp.streamname")+"</span></th>",headerRow+='<th width="20%"><span>'+ZPI18N.getString("zp.memberscount")+"</span></th>",headerRow+="<th><span>"+ZPI18N.getString("zp.description")+"</span></th>",dataObj.isDependent&&(headerRow+='<th  width="23%"><span>'+ZPI18N.getString("zp.designations")+"</span></th>"),headerRow+='<th width="12%"><span></span></th></tr>'),headerRow+="</thead>",headerRow+="<tbody>";var linkName="departments"===mode?"P_Department":"designations"===mode?"P_Designation":"P_Streams";return 0!==data.length&&$.each(data,function(index,deptObj){headerRow+=Organization.ManageOrgs.iterateDeptDesgDtlsListView(deptObj,dataObj.formId,linkName)}),headerRow+="</tbody>",headerRow+="</table>",headerRow+="</div>"},Organization.ManageOrgs.constructLocationDtlsGridView=function(dataObject){var locDtlsMainDiv='<div class="clearfix MT30 ML15 MR15" id="dvGridview">';return 0===Object(dataObject.locationDtls).length?Organization.ManageOrgs.constructEmptyIcon():($.each(dataObject.locationDtls,function(index,locationsDtls){locDtlsMainDiv+=Organization.ManageOrgs.ItearteLocationDtlsGridView(locationsDtls,dataObject.formId,locDtlsMainDiv)}),locDtlsMainDiv+="</div>")},Organization.ManageOrgs.ItearteLocationDtlsGridView=function(dataObject,formId,parent){var mail=ZPSetupCommon.isEmpty(dataObject.MAILALIAS)?"":dataObject.MAILALIAS,country=ZPSetupCommon.isEmpty(dataObject.COUNTRY)?"":dataObject.COUNTRY,recPkId=dataObject.LOCATIONID,locationDtlsGridView='<div class="zp-md-3" recPkID='+recPkId+" formId="+formId+' id="gridViewParent">';return locationDtlsGridView+='<div class="bgwhite">',locationDtlsGridView+='<div class="zprow">',locationDtlsGridView+=Organization.ManageOrgs.constructEditAndDeleteElmForGridView("Organization.ManageOrgs.deleteConfirmPopUp(this,'grid','P_Location')",formId,recPkId),locationDtlsGridView+='<div class="zp-md-12">',locationDtlsGridView+='<div class="MB5"><a class="depthead ZPbold" onclick=User.niceLocation("view","'+recPkId+'","'+formId+'")>'+dataObject.LOCATIONNAME+"</a></div>",locationDtlsGridView+="<p>"+mail+"</p>",locationDtlsGridView+="<div>"+country+"</div>",locationDtlsGridView+='<a class="spncount MT20" onclick=Organization.ManageOrgs.redirectToItsProfile("'+recPkId+'","'+encodeURIComponent(dataObject.LOCATIONNAME)+'","'+dataObject.membersCount+'",this)>'+dataObject.membersCount+"</a>",locationDtlsGridView+="</div>",locationDtlsGridView+="</div>",locationDtlsGridView+="</div>",locationDtlsGridView+="</div>"},Organization.ManageOrgs.constructLocationDtlsListView=function(dataObject){var locationDtlsListObj='<div class="" id="dvListview">';return locationDtlsListObj+='<table id="listOf_locations" class="table table-hover table-responsive tbldepart"><thead><tr>',locationDtlsListObj+='<th width="2%" class="text-center"></th>',locationDtlsListObj+='<th width="22%"><span>'+ZPI18N.getString("zp.locationname")+"</span></th>",locationDtlsListObj+='<th width="22%"><span>'+ZPI18N.getString("zp.memberscount")+"</span></th>",locationDtlsListObj+='<th width="15%"><span>'+ZPI18N.getString("zp.country")+"</span></th>",locationDtlsListObj+='<th width="20%"><span>'+ZPI18N.getString("zp.desgmail")+"</span></th>",locationDtlsListObj+="<th><span>"+ZPI18N.getString("zp.description")+"</span></th>",locationDtlsListObj+='<th width="12%"><span></span></th>',locationDtlsListObj+="</tr>",locationDtlsListObj+="</thead>",locationDtlsListObj+="<tbody>",0!==Object.keys(dataObject.locationDtls).length&&$.each(dataObject.locationDtls,function(index,deptObj){locationDtlsListObj+=Organization.ManageOrgs.iterateLocationDtlsListView(deptObj,dataObject)}),locationDtlsListObj+="</tr></tbody></table></div>"},Organization.ManageOrgs.constructEditAndDeleteElmForGridView=function(func,formId,recId){var deptDesgGridView='<div class="dvedit">';return deptDesgGridView+='<div class="dropdown"> <a data-toggle="dropdown" class="dropdown-toggle"> <span class="IC-more S16"></span> </a>',deptDesgGridView+='<ul role="menu" class="dropdown-menu bullet pull-right droprht">',"Organization.ManageOrgs.deleteConfirmPopUp(this,'grid','P_Location')"==func?(deptDesgGridView+='<li onclick=User.niceLocation("edit","'+recId+'");><a>'+ZPI18N.getString("zp.edit")+"</a></li>",deptDesgGridView+="<li onclick="+func+"><a>"+ZPI18N.getString("zp.delete")+"</a></li></ul></div></div>"):(deptDesgGridView+='<li onclick=User.getRecordPage("'+formId+'","'+recId+'","EDIT")><a>'+ZPI18N.getString("zp.edit")+"</a></li>",deptDesgGridView+="<li onclick="+func+"><a>"+ZPI18N.getString("zp.delete")+"</a></li></ul></div></div>"),deptDesgGridView},Organization.ManageOrgs.constructEditAndDeleteElmForListView=function(func,formID){return"<a class='IC-pen ZPtitle' data-original-title='"+ZPI18N.getString("zp.icoEdit")+"' title='Edit' onclick=User.getRecordPage('"+formID+"',$(this).closest('tr').attr('recPkID'),'EDIT')><a class='IC-delete ML20 ZPtitle' data-original-title='"+ZPI18N.getString("zp.icoDelete")+"' title='Delete' onclick="+func+"></a></a>"},Organization.ManageOrgs.iterateLocationDtlsListView=function(locaDtls,data){var country=ZPSetupCommon.isEmpty(locaDtls.COUNTRY)?"":locaDtls.COUNTRY,mail=ZPSetupCommon.isEmpty(locaDtls.MAILALIAS)?"":locaDtls.MAILALIAS,desc=ZPSetupCommon.isEmpty(locaDtls.LOCATIONDESC)?"":locaDtls.LOCATIONDESC,recPkID=locaDtls.LOCATIONID,contructLocationRows='<tr recPkID="'+recPkID+'" formId="'+data.formId+'">';return contructLocationRows+='<td class="text-center"></td>',contructLocationRows+='<td><a class="ulnk" onclick=User.niceLocation("view","'+recPkID+'","'+data.formId+'")>'+locaDtls.LOCATIONNAME+"</div></td>",contructLocationRows+='<td><a onclick=Organization.ManageOrgs.redirectToItsProfile("'+recPkID+'","'+encodeURIComponent(locaDtls.LOCATIONNAME)+'","'+locaDtls.membersCount+'",this)>'+locaDtls.membersCount+"</a></td>",contructLocationRows+="<td>"+country+"</td>",contructLocationRows+="<td>"+mail+"</td>",contructLocationRows+="<td><span>"+desc+"</span></td>",contructLocationRows+='<td><div class="dvlist-action"><a title="" class="IC-pen ZPtitle" data-original-title='+ZPI18N.getString("zp.icoEdit")+' onClick = User.niceLocation("edit","'+recPkID+'");></a> <a title="" class="IC-delete ML20 ZPtitle" onclick=Organization.ManageOrgs.deleteConfirmPopUp(this,"list","P_Location") data-original-title="'+ZPI18N.getString("zp.icoDelete")+'"></a> </div></td>',contructLocationRows+="</tr>"},Organization.ManageOrgs.iterateDeptDesgDtlsListView=function(deptDesgDtlsObj,formId,linkNm){var currMode=Layout.Page.currentmode.split("/")[2];"designationdetails"===currMode&&(currMode=Layout.Page.currentmode.split("/")[3]);var recPkID="departments"===currMode?deptDesgDtlsObj.DEPARTMENTID:"designations"===currMode?deptDesgDtlsObj.DESIGNATIONID:deptDesgDtlsObj.STREAMID,mailAlias="departments"===currMode?deptDesgDtlsObj.deptMail:"designations"===currMode?deptDesgDtlsObj.MAILALIAS:"",name="departments"===currMode?deptDesgDtlsObj.DEPARTMENTNAME:"designations"===currMode?deptDesgDtlsObj.DESIGNATIONNAME:deptDesgDtlsObj.NAME,lead="departments"===currMode?deptDesgDtlsObj.DEPARTMENT_LEAD:"";lead=ZPSetupCommon.isEmpty(lead)?"":lead,mailAlias=ZPSetupCommon.isEmpty(mailAlias)?"":mailAlias;var contentRow='<tr recPkID="'+recPkID+'" formId="'+formId+'">';if(contentRow+='<td class="text-center"></td>',contentRow+="<td><div>",contentRow+='<a class="ulnk" onclick=User.getRecordPage("'+formId+'","'+recPkID+'","VIEW")>'+name+"</a>",contentRow+="</div></td>","departments"===currMode?(User.isNewUI=ZPeople.isZPNewUI(),User.isNewUI?contentRow+='<td><a class="ML10" onclick = ZPUsers.showDeptById("'+recPkID+'")>'+deptDesgDtlsObj.membersCount+"</a></td>":contentRow+='<td><a class="ML10" onclick = ZPUserList.showDeptById("'+recPkID+'")>'+deptDesgDtlsObj.membersCount+"</a></td>"):contentRow+='<td><span class="ML10">'+deptDesgDtlsObj.membersCount+"</span></td>","streams"===currMode){if(contentRow+="<td><div>",contentRow+=ZPSetupCommon.isEmpty(deptDesgDtlsObj.DESCRIPTION)?"":deptDesgDtlsObj.DESCRIPTION,contentRow+="</div></td>",Organization.ManageOrgs.streamDependency){if(contentRow+="<td><div>",!ZPSetupCommon.isEmpty(deptDesgDtlsObj.DESIGNATION)&&0!==deptDesgDtlsObj.DESIGNATION.length){var listHtml="<span>",popHtml="";$.each(deptDesgDtlsObj.DESIGNATION,function(index,desgName){index<4?(listHtml+=desgName,listHtml+=index!=deptDesgDtlsObj.DESIGNATION.length-1&&3!=index?", ":""):popHtml+="<li>"+desgName+"</li>"}),""!=popHtml&&(popHtml="<ul class='P5 PL8'>"+popHtml+"</ul>",listHtml+=" & "+(deptDesgDtlsObj.DESIGNATION.length-4)+" ",listHtml+='<a class="dvShwlocation S13" data-placement="bottom" data-trigger="hover" data-toggle="popover" data-content="'+popHtml+'" data-html="true">'+ZPI18N.getString("zp.more").toLowerCase()+"</a>"),contentRow+=listHtml}contentRow+="</div></td>"}}else contentRow+="<td><div>"+mailAlias+"</div></td>";return"departments"===currMode&&(contentRow+="<td><div>"+lead+"</div></td>"),contentRow+='<td><div class="dvlist-action ">'+Organization.ManageOrgs.constructEditAndDeleteElmForListView("Organization.ManageOrgs.deleteConfirmPopUp(this,'list','"+linkNm+"')",formId)+"</div></td>",contentRow+="</tr>"},Organization.ManageOrgs.addDepartmentLink=function(title,classOfElm,formId){var addDeptLinkElms='<div class="zp-md-3 text-center" id="addDeptLink">';return addDeptLinkElms+='<div class="bgwhite dvdepart-h CP">',addDeptLinkElms+='<div class="'+classOfElm+'" onclick=User.getRecordPage("'+formId+'","","ADD")><span class="IC-addtab MR8"></span>'+title+"</div>",addDeptLinkElms+="</div></div>"},Organization.ManageOrgs.constructEmptyIcon=function(deptordesg){if("displayErrorMsgDepartment"==deptordesg)return'<div id="no_companyFiles_rec" class="ZPND" style="position:relative"><div class="PArds"></div><h4>'+ZPI18N.getString("zp.displayErrorMsgDepartment")+"</h4></div>";if("displayErrorMsgDesignation"==deptordesg)return'<div id="no_companyFiles_rec" class="ZPND" style="position:relative"><div class="PArds"></div><h4>'+ZPI18N.getString("zp.displayErrorMsgDesignation")+"</h4></div>";if("displayErrorMsgStream"==deptordesg)return'<div id="no_companyFiles_rec" class="ZPND" style="position:relative"><div class="PArds"></div><h4>'+ZPI18N.getString("zp.displayErrorMsgStream")+"</h4></div>";var noDataTxt="",classname=";";return"departments"==Layout.Page.currentmode.split("/")[2]?(noDataTxt="zp.nodepartmentfound",classname="CR-department"):"designationdetails"==Layout.Page.currentmode.split("/")[2]?"designations"==Layout.Page.currentmode.split("/")[3]?(noDataTxt="zp.nodesignationfound",classname="CR-designation"):(noDataTxt="zp.nostreamfound",classname="CR-designation"):"locations"==Layout.Page.currentmode.split("/")[2]&&(noDataTxt="zp.nolocationfound",classname="CR-location"),ZPUtil.newNoDataHTML(classname,8,ZPI18N.getString(noDataTxt))},Organization.ManageOrgs.deleteRecord=function(thisObj){var recPkID=thisObj.attr("recPkID"),params={mode:"deleteRecords",recordIds:recPkID,formId:thisObj.attr("formId")},others={pkid:recPkID,linkname:thisObj.attr("linkname")};ZPeople.Request.send("formAction.zp",params,Organization.ManageOrgs.callbackOfNewDeleteRecord,others)},Organization.ManageOrgs.deleteConfirmPopUp=function(thisObject,typeOfView,linkname){var mainObj;(mainObj="grid"===typeOfView?$(thisObject).closest("div#gridViewParent"):$(thisObject).closest("tr")).attr("linkname",linkname),ZPeople.confirm(mainObj,"","zp.deleteconfirmtitle",Organization.ManageOrgs.deleteRecord)},Organization.ManageOrgs.callbackOfNewDeleteRecord=function(data,params,others){if(7e3==data.code){var pageContent=$("#"+Layout.Page.pageId),currMode=Layout.Page.currentmode.split("/")[2];"P_Location"==others.linkname&&ZPUtil.Location.reload(!0),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.recorddeletedsuccessfully"));window.location.hash;pageContent.find("div#dvListview").find("tr[recPkID='"+params.recordIds+"']").remove(),pageContent.find("div#dvGridview").find("div[recPkID='"+params.recordIds+"']").remove(),Organization.ManageOrgs.getSortListOfDeptDesgLoc(0,currMode)}else{var message=null;message=data.message,data.payLocsExist&&(message=data.payLocsExist),null!=message&&void 0!=message&&ZPeople.Message.showFailureMsg(message)}},Organization.ManageOrgs.callbackOfDeleteRecord=function(data,pkId,dispType){var pageContent=$("#"+Layout.Page.pageId),currMode=Layout.Page.currentmode.split("/")[2];if(data.hasOwnProperty("errObj")&&null!=data.errObj&&data.errObj.length>0){var payLocExist=null;$.each(data.errObj,function(k,v){payLocExist=v.payLocsExist,v.error&&(payLocExist=v.error)}),null!=payLocExist&&void 0!=payLocExist&&ZPeople.Message.showFailureMsg(payLocExist)}else{"P_Location"==pkId.viewLinkName&&ZPUtil.Location.reload(!0);window.location.hash;pageContent.find("div#dvListview").find("tr[recPkID='"+pkId+"']").remove(),pageContent.find("div#dvGridview").find("div[recPkID='"+pkId+"']").remove(),Organization.ManageOrgs.getSortListOfDeptDesgLoc(0,currMode)}},Organization.ManageOrgs.getSortListOfDeptDesgLoc=function(sortBy,curPage){var pageContent=$("#"+Layout.Page.pageId),params={};params.sortByType=sortBy,Organization.startIndex=0,"departments"===curPage?(params.method="getDepartmentsDetails",url="/getDepartmentsList.zp"):"designationdetails"===curPage?"designations"==Layout.Page.currentmode.split("/")[3]?(params.method="getDesignationsDetails",url="/getDesignationsList.zp"):"streams"==Layout.Page.currentmode.split("/")[3]&&(params.method="getStreamsDetails",url="/getStreamsList.zp"):(params.method="getLocationsDetails",url="/getLocationsList.zp"),$(window).width()>1440&&(params.getMoreData="getMoreData"),pageContent.find("div#dvGridview").html(""),pageContent.find("div#dvListview").find("table tbody").html(""),ZPeople.Request.send(url,params,User.handleScrollEventResponse)},Organization.ManageOrgs.showDeptDesgLocView=function(pageMode){var pageId=$("div#admin-organization-"+pageMode);pageId.find("a#gridView,a#listView").removeClass("active"),"gridview"===Organization.dispType?(pageId.find("div#dvGridview").removeClass("DN"),pageId.find("div#dvListview").addClass("DN"),pageId.find("a#gridView").addClass("active")):(pageId.find("div#dvGridview").addClass("DN"),pageId.find("div#dvListview").removeClass("DN"),pageId.find("a#listView").addClass("active"))},Organization.ManageOrgs.manageDomainInit=function(){var params={conreqcsr:csrfToken,method:"getOrgDomainsList"};Layout.Page.container.html(Organization.ZP_PAGE_LOADING),ZPeople.Request.send("/getOrgDomains.zp",params,Organization.ManageOrgs.iterateManageDomainsDtls)},Organization.ManageOrgs.iterateManageDomainsDtls=function(resultData){var pageContent=Layout.Page.container,currMode=Layout.Page.currentmode.split("/")[2],domainListElm="";domainListElm+='<div class="dvDomain" id="domainParent">',domainListElm+=Organization.ManageOrgs.constructHeaderElements(ZPI18N.getString("zp.newdomainnotes"),ZPI18N.getString("zp.adddomain"),currMode),ZPSetupCommon.isEmpty(resultData.notAllowed)?(domainListElm+='<div class="ZPTscrlcont" onscroll=User.userListfireScroll(this,"'+resultData.numRows+'") >',domainListElm+='<table class="table table-hover table-responsive tbldepart" zuid="'+resultData.zuid+'" id="orgDomainDtlsTable">',domainListElm+=Organization.ManageOrgs.constructTableHeaderOfDomians(),domainListElm+="<tbody>"+Organization.ManageOrgs.constructDomainsList(resultData)+"</tbody></table>",domainListElm+="</div></div>",pageContent.html(domainListElm),ZPSetupCommon.isEmpty(resultData.orgDtls)&&pageContent.find("table#orgDomainDtlsTable thead").addClass("DN"),pageContent.append(Organization.ManageOrgs.constructAddDomainPopUp()),pageContent.find("a#domains").attr("data-target","#dvDomainName"),pageContent.find("a#domains").attr("data-toggle","modal"),pageContent.find(".ZPtitle").tooltip()):(domainListElm+='<div class="ZPTscrlcont" onscroll=User.userListfireScroll(this,"'+resultData.numRows+'") >',domainListElm+='<div class="ZPNdata"><i class="CR-domains"><i class="path1"></i><i class="path2"></i><i class="path3"></i><i class="path4"></i><i class="path5"></i><i class="path6"></i><i class="path7"></i><i class="path8"></i></i><h5>'+resultData.notAllowed+"</h5></div>",domainListElm+="</div>",pageContent.html(domainListElm),pageContent.find("a#domains").parent().addClass("DN"));var url_currentdomain=ZPeople.ZOHOURL,tempChangeForCnHelp=url_currentdomain.split(".");"cn"==tempChangeForCnHelp[tempChangeForCnHelp.length-1]&&(url_currentdomain="https://www.zoho.com"),pageContent.find("a#helpLink").attr("href",url_currentdomain+"/people/help/adminguide/overview-orgsettings.html#domains"),pageContent.find("a#helpLink").attr("target","_blank"),pageContent.find("a#helpLink").attr("onClick",""),ZPeople.ISUNCONFIRMEDACC&&ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.shorttextunconfirmed",["ZPeople.sendIAMConfirmation()"]))},Organization.ManageOrgs.addDomain=function(thisObj){var pageId=Layout.Page.container,domainInput=pageId.find("input#newDomainVal"),domainInputParent=domainInput.parent(),newDomainName=domainInput.val();(domainInputParent.removeClass("has-error"),ZPSetupCommon.isEmpty(newDomainName))?(ZPSetupCommon.showErr(ZPI18N.getString("zp.domainempty"),domainInputParent,"dverrormsg"),domainInputParent.addClass("has-error")):isValidDomainName($("input#newDomainVal").val())?("www"===newDomainName.split(".")[0]&&"."===newDomainName.charAt(3)&&(newDomainName=jQuery.trim(newDomainName).substring(4,newDomainName.length)),ZPeople.Request.send("addNewDomain.zp",{domainName:newDomainName.trim(),method:"addDomainNewUI"},Organization.ManageOrgs.callBackOfAddDomain),pageId.find("a#adddomain_btn").attr("disabled","disabled")):(ZPSetupCommon.showErr(ZPI18N.getString("zp.entervaliddomain"),domainInputParent,"dverrormsg"),domainInputParent.addClass("has-error"));pageId.find("div.dverrormsg").addClass("text-left")},Organization.ManageOrgs.callBackOfAddDomain=function(data){var pageId=Layout.Page.container;pageId.find("a#adddomain_btn").attr("disabled",!1),ZPSetupCommon.isEmpty(data.success)?ZPSetupCommon.isEmpty(data.warning)?ZPeople.Message.showFailureMsg(data.failed):ZPeople.Message.showWarningMsg(data.warning):(ZPeople.Message.showSuccessMsg(data.success),$("div#dvDomainName").removeClass("in").hide(),pageId.find("table#orgDomainDtlsTable thead").removeClass("DN"),$("div.modal-backdrop").remove(),ZPeople.Request.send("getOrgDomains.zp",{method:"getOrgDomainsList"},Organization.ManageOrgs.constructDomainsList,$(Layout.currContainerObj).find("table#orgDomainDtlsTable tbody")))},Organization.ManageOrgs.deleteDomain=function(clickObj){Layout.Page.container;var domainName=$(clickObj).attr("domainname");$.post("/deleteDomain.zp",{conreqcsr:csrfToken,domainName:domainName,method:"deleteDomainNewUI"},function(resultData){resultData.success?ZPeople.Request.send("getOrgDomains.zp",{method:"getOrgDomainsList"},Organization.ManageOrgs.updateAfterDelete):ZPeople.Message.showFailureMsg(resultData.failed)})},Organization.ManageOrgs.updateAfterDelete=function(data){var pageContent=Layout.Page.container;if(Organization.ManageOrgs.constructDomainsList(data),ZPSetupCommon.isEmpty(data.orgDtls)){pageContent.find("table#orgDomainDtlsTable").addClass("DN");var buttonHtml='<div class="btn-group" onclick="Organization.ManageOrgs.showAddDomainPopup()"><a id="domains" class="btn btn-primary btnPlus dvshwalert MR5" data-target="#dvDomainName" data-toggle="modal">'+ZPI18N.getString("zp.adddomain")+"</a> </div>";pageContent.find("div.ZPTscrlcont").append(ZPUtil.newNoDataHTML("CR-domains",8,ZPI18N.getString("zp.nodomainconf"),void 0,void 0,buttonHtml))}},Organization.ManageOrgs.constructDomainsList=function(dataObj,appendElm){var pageContent=$("#"+Layout.Page.pageId),domainRows="";if(!("string"!=typeof dataObj.orgDtls&&!ZPSetupCommon.isEmpty(dataObj.orgDtls))){var buttonHtml='<div class="btn-group" onclick="Organization.ManageOrgs.showAddDomainPopup()"><a id="domains" class="btn btn-primary btnPlus dvshwalert MR5" data-target="#dvDomainName" data-toggle="modal">'+ZPI18N.getString("zp.adddomain")+"</a> </div>";return ZPUtil.newNoDataHTML("CR-domains",8,ZPI18N.getString("zp.nodomainconf"),void 0,void 0,buttonHtml)}Layout.Page.container.find(".ZPNdata").remove(),$.each(dataObj.orgDtls,function(index,obj){var domainStatusMsg="1"===JSON.parse(obj.domainDetails).IS_VERIFIED?ZPI18N.getString("zp.domainverified"):"";domainRows+=Organization.ManageOrgs.constructDomainRow(obj,domainStatusMsg,appendElm)});var tableBody=pageContent.find("table#orgDomainDtlsTable tbody");return pageContent.find("table#orgDomainDtlsTable").removeClass("DN"),tableBody.html(""),tableBody.append($(domainRows)),domainRows},Organization.ManageOrgs.getDKIMData=function(domain){var url_currentdomain=ZPeople.ZOHOURL,tempChangeForCnHelp=url_currentdomain.split(".");"cn"==tempChangeForCnHelp[tempChangeForCnHelp.length-1]&&(url_currentdomain="https://www.zoho.com"),ZPeople.Request.send("/dkimdetails.zp",{domainName:domain,method:"dkimdetails"},function(result){if(result.error)ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.domainiserror",[ZPeople.peopleSupportEmail]));else{var dkimdata=ZPI18N.getString("zp.dkimdetailsnotfound");if(result.TRANSMAIL_HOSTKEY){dkimdata="";var updatedStatus="-";updatedStatus=result.TRANSMAIL_DKIM_VERIFICATION?'<i class="IC-rou-tik grn MR5"></i> '+ZPI18N.getString("zp.authenticated"):ZPI18N.getString("zp.notauthenticated"),dkimdata+='<div id="dkimdata" class="zps_infoHg"><div><span>'+ZPI18N.getString("zp.hostkey")+' <i class="IC-copy ML5 csP" onClick="copyTxtToClipBoard(\'hostkey\')" data-placement="bottom" data-toggle="tooltip" data-original-title="'+ZPI18N.getString("zp.copy")+'"></i><input type="text" id="hostkey" value="'+result.TRANSMAIL_HOSTKEY+'"></span><span>'+result.TRANSMAIL_HOSTKEY+"</span></div>",dkimdata+="<div><span>"+ZPI18N.getString("zp.hostvalue")+' <i class="IC-copy ML5 csP" onClick="copyTxtToClipBoard(\'hostValue\')" data-placement="bottom" data-toggle="tooltip" data-original-title="'+ZPI18N.getString("zp.copy")+'"></i><input type="text" id="hostValue" value="'+result.TRANSMAIL_HOSTVALUE+'"></span><span>'+result.TRANSMAIL_HOSTVALUE+"</span></div>",dkimdata+="<div><span>"+ZPI18N.getString("zp.validation")+"</span><span>"+updatedStatus+"</span></div>",dkimdata+="</div>"}if(0==$("#dkimPop").length){var dkimdetails='<div role="dialog" id="dkimPop" class="zp_welPop zps_dVpop dmntbl DN">';dkimdetails+='<div class="zp_popCont">',dkimdetails+='<div class="zps_popHd">',dkimdetails+='<h4 id="domChange1">'+ZPI18N.getString("zp.dkimdetails")+" - "+domain+"</h4>",dkimdetails+='<i class="IC-cls" onClick="removeDKIMPop()"></i>',dkimdetails+="</div>",dkimdetails+='<div class="zps_popBd" style="overflow:auto;padding:2%;" ">',dkimdetails+="<h5>"+ZPI18N.getString("zp.authenticatedomain",[domain])+"</h5><br>",dkimdetails+='<div style="margin-left:20px;"><p> 1. '+ZPI18N.getString("zp.signinnote")+"</p></div>",dkimdetails+='<div style="margin-left:20px;"><p> 2. '+ZPI18N.getString("zp.addtxtrec")+"</p></div>",dkimdetails+=dkimdata,dkimdetails+='<div style="margin-left:20px;"><p>'+ZPI18N.getString("zp.dkimwaittxt")+"</p></div>",dkimdetails+='<div class="zps_lnkDv" id="torc5"><p><a href="https://www.zoho.com/people/help/adminguide/overview-orgsettings.html#Email%20Auth" target="_blank">'+ZPI18N.getString("zp.clickhere")+"</a> "+ZPI18N.getString("zp.tofollownotetxt")+"</p></div>",dkimdetails+="</div></div></div>",$(".cont-wrap").append(dkimdetails),$("div#dkimPop").removeClass("DN")}else $("#domChange1").html(ZPI18N.getString("zp.dkimdetails")+" - "+domain),$("#dkimdata").html(dkimdata),$("div#dkimPop").removeClass("DN")}})},Organization.ManageOrgs.constructDomainRow=function(obj,verifiedStatus){var domaindetails=JSON.parse(obj.domainDetails),domainRowList='<tr domainCode="'+domaindetails.VERIFICATION_CODE+'">';if(domainRowList+='<td class="text-center"></td>',domainRowList+="<td><div><span>"+domaindetails.ORG_DOMAIN+"</span></div></td>",domainRowList+="<td>",verifiedStatus===ZPI18N.getString("zp.domainverified"))domainRowList+='<i class="IC-rou-tik grn MR5"></i>';else{var cname=obj.cname,txt=obj.txt,cnamedest=obj.cnamedest;domainRowList+="<a onclick=\"Organization.ManageOrgs.constructVerifyDomainPopUp('"+domaindetails.ORG_DOMAIN+"','"+cname+"','"+txt+"','"+cnamedest+"')\">"+ZPI18N.getString("zp.verify")+"</a>"}return domainRowList+=verifiedStatus,domainRowList+="</td>",domainRowList+="<td><div><a onclick=\"Organization.ManageOrgs.getDKIMData('"+domaindetails.ORG_DOMAIN+"')\">"+ZPI18N.getString("zp.get")+"</a></div></td>",domainRowList+='<td><div class="dvlist-action"><a title="" class="IC-delete ML20 ZPtitle" data-original-title="Delete" domainname = "'+domaindetails.ORG_DOMAIN+'" onclick=ZPeople.confirm(this,"","zp.deleteconfirmtitle",Organization.ManageOrgs.deleteDomain) ></a></div></td>',domainRowList+="</tr>"},Organization.ManageOrgs.constructTableHeaderOfDomians=function(){var domainTableHeader="<thead>";return domainTableHeader+="<tr>",domainTableHeader+='<th width="2%" class="text-center"></th>',domainTableHeader+='<th width="30%"><span class="CP">'+ZPI18N.getString("zp.domainname")+"</span></th>",domainTableHeader+="<th><span>"+ZPI18N.getString("zp.verificationstatus")+"</span></th>",domainTableHeader+="<th><span>"+ZPI18N.getString("zp.dkimdetails")+"</span></th>",domainTableHeader+='<th width="12%"><span></span></th>',domainTableHeader+="</tr>",domainTableHeader+="</thead>"},Organization.ManageOrgs.constructAddDomainPopUp=function(){var domainPopup='<div role="dialog" id="dvDomainName" class="modal modal-xs fade">';return domainPopup+='<div class="modal-dialog">',domainPopup+='<div class="modal-content">',domainPopup+='<div class="modal-header"><a aria-label="Close" data-dismiss="modal" class="close IC-cls-1px red"></a>',domainPopup+='<h4 class="modal-title">'+ZPI18N.getString("zp.adddomainname")+"</h4>",domainPopup+="</div>",domainPopup+='<div class="modal-body">',domainPopup+='<div class="zprow">',domainPopup+='<div class="form-group">',domainPopup+='<div class="zp-md-10">',domainPopup+='<label class="control-label">'+ZPI18N.getString("zp.domainname")+"</label>",domainPopup+='<input type="text" autofocus="" class="form-control" id="newDomainVal"></div></div></div>',domainPopup+='<div class="clearfix">',domainPopup+="",domainPopup+="</div></div>",domainPopup+='<label class="input-group PT5 PB5 ML5 gry PL10">'+ZPI18N.getString("zp.domainexample")+" </label>",domainPopup+='<div class="modal-footer"><a class="btn btn-primary" onclick="Organization.ManageOrgs.addDomain()" id="adddomain_btn">'+ZPI18N.getString("zp.save")+'</a><a class="btn btn-default ML5" data-dismiss="modal">'+ZPI18N.getString("zp.cancel")+"</a></div></div></div></div>"},isValidDomainName=function(val){return/^([a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,22}$/.test(val)},Organization.ManageOrgs.constructVerifyDomainPopUp=function(domName,cname,txt,cnamedest){var verifyDomPop='<div role="dialog" id="vDomPop" class="zp_welPop zps_dVpop DN">';verifyDomPop+='<div class="zp_popCont">',verifyDomPop+='<div class="zps_popHd">',verifyDomPop+='<h4 id="domChange1">'+ZPI18N.getString("zp.verifydomain",[domName])+"</h4>",verifyDomPop+='<i class="IC-cls" onClick="removeModal()"></i>',verifyDomPop+="</div>",verifyDomPop+='<div class="zps_popBd">',verifyDomPop+='<h5 id="domChange2">'+ZPI18N.getString("zp.followinst",[domName])+"</h5>",verifyDomPop+='<div class="zps_lstVw">',verifyDomPop+="<div>",verifyDomPop+='<input id="txtRadio" name="verification_mode" type="radio" checked="checked" value="TXT" onClick="changeValuesInModalForDomainVerification(\'txt\',\''+cname+"','"+txt+"','"+cnamedest+"')\">",verifyDomPop+="<label>"+ZPI18N.getString("zp.txt")+"</label>",verifyDomPop+='<input id="cnameRadio" name="verification_mode" type="radio" value="CNAME" onClick="changeValuesInModalForDomainVerification(\'cname\',\''+cname+"','"+txt+"','"+cnamedest+"')\">",verifyDomPop+="<label>"+ZPI18N.getString("zp.cname")+"</label>",verifyDomPop+="</div>",verifyDomPop+="<div><p><span>1.</span>"+ZPI18N.getString("zp.signinnote")+"</p></div>",verifyDomPop+="<div>",verifyDomPop+='<p id="torc1"><span>2.</span>'+ZPI18N.getString("zp.addtxtrec")+"</p>",verifyDomPop+='<div class="zps_infoHg">',verifyDomPop+='<div id="torc2">',verifyDomPop+="<span>",verifyDomPop+=ZPI18N.getString("zp.hostoraliastxt"),verifyDomPop+="</span>",verifyDomPop+="<span>",verifyDomPop+=ZPI18N.getString("zp.blankorat"),verifyDomPop+="</span>",verifyDomPop+="</div>",verifyDomPop+='<div id="torc3">',verifyDomPop+="<span>"+ZPI18N.getString("zp.pointo")+"</span>",verifyDomPop+="<span>",verifyDomPop+=txt,verifyDomPop+="</span>",verifyDomPop+="</div>",verifyDomPop+="</div>",verifyDomPop+="</div>",verifyDomPop+='<div id="torc4"><p><span>3.</span>'+ZPI18N.getString("zp.plswaittxt")+"</p></div></div>";var url_currentdomain=ZPeople.ZOHOURL,tempChangeForCnHelp=url_currentdomain.split(".");"cn"==tempChangeForCnHelp[tempChangeForCnHelp.length-1]&&(url_currentdomain="https://www.zoho.com"),verifyDomPop+='<div class="zps_lnkDv" id="torc5"><p><a href="'+url_currentdomain+'/people/help/adminguide/overview-orgsettings.html#domains" target="_blank">'+ZPI18N.getString("zp.clickhere")+"</a>"+ZPI18N.getString("zp.tofollownotetxt")+"</p></div></div>",verifyDomPop+='<div class="zps_popFt"><div class="zp_btn"><button class="zpthm" onClick="Organization.ManageOrgs.finalVerificationForDomain()">'+ZPI18N.getString("zp.verify")+'</button><button onClick="removeModal()">'+ZPI18N.getString("zp.cancel")+"</button></div></div>",verifyDomPop+="</div>",verifyDomPop+="</div>",$(".cont-wrap").append(verifyDomPop),Organization.selectSingleDomain=domName,$("h4#domChange1").replaceWith('<h4 id="domChange1">'+ZPI18N.getString("zp.verifydomain",[domName])+"</h4>"),$("h5#domChange2").replaceWith('<h5 id="domChange2">'+ZPI18N.getString("zp.followinst",[domName])+"</h5>"),$("div#vDomPop").removeClass("DN"),$("input#txtRadio").prop("checked",!0),Organization.canSendCname&&($("input#txtRadio").prop("checked",!1),$("input#cnameRadio").prop("checked",!0))},Organization.ManageOrgs.finalVerificationForDomain=function(){var mode="txt";Organization.canSendCname&&(mode="cname"),void 0!=Organization.selectSingleDomain&&ZPeople.Request.send("/verifyDomain.zp",{method:"verifyDomain",mode:mode,domainName:Organization.selectSingleDomain},function(resultObject){var resultJSON=JSON.parse(resultObject);if(void 0!=resultJSON.status&&200==resultJSON.status)$("div#vDomPop").addClass("DN"),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.domainsuccessmessage")),Organization.ManageOrgs.manageDomainInit();else if(void 0!=resultJSON.status&&404==resultJSON.status){var cnameortxt="TXT";Organization.canSendCname&&(cnameortxt="CNAME"),ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.domainfailuremessage",[cnameortxt]))}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.domainiserror",[ZPeople.peopleSupportEmail]))})},Organization.ManageOrgs.rebrandingSettings=function(){$("#modiBtnn").hide(),$("#subBtnn").hide(),$("#portDomName").hide(),$("#s2id_portDomName").hide(),$("#portDomPreview").text(""),$("#delDomBtn").hide(),$("#curSubDmnName").val(""),$("#instTab").hide(),Organization.ManageOrgs.rebrandingSettings.domainPath="",ZPeople.Request.send("/org/getRebrandingDetails",{method:"getRebrandingDetails"},function(resltPath){Organization.ManageOrgs.rebrandingSettings.domainPath=resltPath.domName;var dnsDtls=resltPath.dnsDtls;if(resltPath.ERROR_PAYMENT)$("#admin-organization-rebranding").html("<div class = 'dvNomsg'> <div class='PAdms'></div> <p class='PT20 S15' align = 'center'>"+ZPI18N.getString("zp.embedupgrade",new Array(resltPath.paymentUrl))+"</p> </div>");else if(resltPath.hasOwnProperty("domName")&&null!=resltPath.domName&&""!=resltPath.domName){var subDmnName=$("#curSubDmnName");$("#modiBtnn").show(),$("#subBtnn").hide(),$("#delDomBtn").show(),subDmnName.val(resltPath.domName),$("#curSubDmnName").parent().parent().removeClass("mapdot"),subDmnName.attr("disabled","disabled"),void 0!==dnsDtls&&null!=dnsDtls&&void 0!=dnsDtls&&(dnsDtls.hasOwnProperty("hasCName")&&!dnsDtls.hasCName?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.rebrandnocname")):dnsDtls.hasOwnProperty("unResolved")&&dnsDtls.unResolved&&ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.rebrandnohost")))}else Organization.ManageOrgs.rebrandingSettings.fetchOrgDoms()})},Organization.ManageOrgs.rebrandingSettings.fetchOrgDoms=function(){$("#portDomName").select2(),$("#modiBtnn").hide(),$("#subBtnn").hide(),$("#delDomBtn").hide(),$("#curSubDmnName").attr("disabled","disabled"),$("option#domOpt").remove(),$("#portDomPreview").text(""),$("#yrDomn").text("<"+ZPI18N.getString("zp.yoursubdomain")+">");var spltDom=null,spltInd=null,subDm=null,mainDm=null,domName=Organization.ManageOrgs.rebrandingSettings.domainPath;void 0!=domName&&null!=domName&&""!=domName&&(spltDom=domName.split("."),spltInd=domName.indexOf("."),subDm=spltDom[0],mainDm=domName.substring(spltInd+1,domName.length)),ZPeople.Request.send("/org/getOrgDomains",{method:"getOrgDomains"},function(reslt){if(reslt.ERROR_PAYMENT)$("#admin-organization-rebranding").html("<div class = 'dvNomsg'> <div class='PAdms'></div> <p class='PT20 S15' align = 'center'>"+ZPI18N.getString("zp.embedupgrade",new Array(reslt.paymentUrl))+"</p> </div>");else if(reslt.hasOwnProperty("notAllowed"))ZPeople.Message.showWarningMsg(reslt.notAllowed);else{var portDomNameDv=$("#portDomName"),curSubDmnName=$("#curSubDmnName");reslt.hasOwnProperty("orgDtls")&&reslt.orgDtls.length>0?($.each(reslt.orgDtls,function(key,val){portDomNameDv.append('<option id="domOpt" value='+val.ORG_DOMAIN+">"+val.ORG_DOMAIN+"</option>")}),void 0!=subDm&&null!=subDm&&""!=subDm&&void 0!=mainDm&&null!=mainDm&&""!=mainDm?(curSubDmnName.val(subDm),$("#yrDomn").text(subDm),portDomNameDv.select2("val",mainDm)):portDomNameDv.select2("val","0"),curSubDmnName.prop("disabled",!1),curSubDmnName.parent().parent().addClass("mapdot"),$("#subBtnn").show(),$("#instTab").show()):reslt.hasOwnProperty("noReq")?ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.rebrandnodomreqraised")):ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.rebrandnoverifieddomain",[ZPeople.peopleSupportEmail]))}})},Organization.ManageOrgs.rebrandingSettings.showPreview=function(){var subDmnName=$("#curSubDmnName").val().trim(),mainDmnName=$("#portDomName").val(),portDomPrevDv=$("#portDomPreview"),yrDomDdv=$("#yrDomn");null!==subDmnName&&""!==subDmnName&&void 0!=subDmnName&&"0"!=mainDmnName?(portDomPrevDv.text(ZPI18N.getString("zp.rebrandprevhttp")+subDmnName+"."+mainDmnName).show(),yrDomDdv.text(subDmnName)):(portDomPrevDv.text(""),null!==subDmnName&&""!==subDmnName&&void 0!=subDmnName?yrDomDdv.text(subDmnName):yrDomDdv.text("<"+ZPI18N.getString("zp.yoursubdomain")+">"))},Organization.ManageOrgs.rebrandingSettings.submitMapping=function(){var subDmnName=$("#curSubDmnName").val().trim(),mainDmnName=$("#portDomName").val(),actDomName=Organization.ManageOrgs.rebrandingSettings.domainPath,actMode="ADD";if(null!=subDmnName&&""!=subDmnName&&void 0!=subDmnName&&"0"!=mainDmnName&&null!=mainDmnName&&""!=mainDmnName&&void 0!=mainDmnName){void 0!=actDomName&&null!=actDomName&&""!=actDomName&&(actMode="UPDATE");var domainPath=subDmnName.trim()+"."+mainDmnName;subDmnName.length;subDmnName.startsWith("-")||subDmnName.endsWith("-")||mainDmnName.startsWith("-")||mainDmnName.endsWith("-")||!subDmnName.match(/^[0-9a-zA-Z-]+$/)||!domainPath.match(/^[0-9a-zA-Z.-]+$/)?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.rebranddomalphanum")):ZPeople.Request.send("/org/addorUpdateRebrandingDetails",{method:"addorUpdateRebrandingDetails",mode:actMode,domainPath:domainPath},function(reslt){null!=reslt&&reslt.hasOwnProperty("msgDtl")&&("Added"==(reslt=reslt.msgDtl)?ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.rebrandaddsuccess")):"Updated"==reslt?ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.rebrandupdatesucc")):"domain error"==reslt?ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.rebranderrdomname")):"error occurred"==reslt?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.rebranderrinaction")):"cnameerror"==reslt?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.rebrandnohost")):"crossidcerror"==reslt?ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.crossidcerror",[Organization.cnameMappedUrl])):ZPeople.Message.showFailureMsg(reslt),"Added"!=reslt&&"Updated"!=reslt||Organization.ManageOrgs.rebrandingSettings())})}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.rebranddomnotvalid"))},Organization.ManageOrgs.rebrandingSettings.deleteMapping=function(){var domPath=$("#curSubDmnName").val();ZPeople.confirm("",ZPI18N.getString("zp.rebranddelmapheading"),ZPI18N.getString("zp.rebranddelconfirm"),"",!1,!0);var yesDel=$("#confirmConfirmationPopup");yesDel.off(),yesDel.on("click",function(){Organization.ManageOrgs.rebrandingSettings.deleteMapping.confirmDelete(domPath)})},Organization.ManageOrgs.rebrandingSettings.deleteMapping.confirmDelete=function(domainPath){ZPeople.Request.send("/org/delRebrandingDetails",{method:"delRebrandingDetails",domainPath:domainPath},function(reslt){reslt?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.rebranddelsucc")),Organization.ManageOrgs.rebrandingSettings()):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.rebranddelunable"))})},Organization.ManageOrgs.eventForChangeViewTypeOfManageDeptDesgLoc=function(thisObj){var pageContent=Layout.Page.container;pageContent.find("a#listView,a#gridView").removeClass("active"),"listView"===$(thisObj).attr("id")?(pageContent.find("div#dvListview").show(),pageContent.find("div#dvGridview").hide(),Organization.dispType="listview"):(pageContent.find("div#dvGridview").show(),pageContent.find("div#dvListview").hide(),Organization.dispType="gridview"),$(thisObj).addClass("active")},Organization.ManageOrgs.redirectToItsProfile=function(recId,deptOrLocname,membersCnt,thisObj){var currPage=Layout.Page.currentmode.split("/")[2];Organization.erecNo=recId,membersCnt>0?("roles"===currPage?User.variables.user.filterParams.searchByRole=recId:"departments"===currPage?User.variables.user.filterParams.searchByDept=recId:User.variables.user.filterParams.searchByLoc=recId,User.variables.user.reload=!0,window.location.href="#admin/employeerecords/user"):ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.norecfound"))},Organization.Calendar.HolidayCalenderInit=function(){Layout.Page.container.empty().append(Organization.ZP_PAGE_LOADING);var params={conreqcsr:csrfToken,mode:"View"};ZPeople.Request.send(Organization.Calendar.url,params,Organization.Calendar.CalendarSettingtab)},Organization.Calendar.CalendarSettingtab=function(resultData){var calendarSettingHeader='<div class="dvHolidaycal">';calendarSettingHeader+='<div class="mainhead">',calendarSettingHeader+='<div class="zprow">',calendarSettingHeader+='<div class="zp-md-6">',calendarSettingHeader+='<div class="zp-md-12 PT5">'+ZPI18N.getString("zp.CalendarNotes")+"</div></div>",calendarSettingHeader+='<div class="zp-md-6 text-right"> <a class="btn-group pagetips" href="'+zohoUrl+'/people/help/calendar-settings.html" target="_blank"><span class="IC-qus"></span></a> </div></div></div>',calendarSettingHeader+=Organization.Calendar.constructWeekDefinition(resultData),calendarSettingHeader+="</div>",Layout.Page.container.empty().append(calendarSettingHeader);var location="";location+="<option value =-1>All Locations</option>",$.each(resultData.locationMap,function(fieldType,value){location+="<option value ="+value.locationId+">"+value.locationName+"</option>"}),$("select[name='locale']").append(location);var days="",ind={sunday:0,monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6};$.each(resultData.leaveReport.getNwDays,function(index,obj){days+="<option value ="+ind[obj.attrDay]+">"+obj.dispDay+"</option>"}),$("#weekStartList").empty().append(days),$("#WorkweekStartList").empty().append(days),$("#WorkweekEndList").empty().append(days),Organization.Calendar.WeekDaysResponseHandler(resultData),$("select.selectBox").select2()},Organization.Calendar.constructWeekDefinition=function(resultData){var weekEndHoliday='<div class="ZPTscrlcont"><div class="clearfix PL15 PR15">';return weekEndHoliday+='<div class="zprow PT15"><div class="zp-md-6"><div class="zp-md-4"><label class="control-label MT3">'+ZPI18N.getString("zp.applcble")+'</label></div><div class="zp-md-6"><div class="form-group"><select class="selectBox" name="locale" id ="listLocation" onchange="Organization.Calendar.getLocationBasedLeaveReport(this)" style="display: none;"></select></div></div></div></div>',weekEndHoliday+='<div class="zp-md-12"><h2 class="ZPbold">'+ZPI18N.getString("zp.weekDef")+"</h2></div>",weekEndHoliday+='<div class="zprow"><div class="zp-md-6"><div class="zp-md-4"><label class="control-label MT3">'+ZPI18N.getString("zp.weekStrtOn")+'</label></div><div class="zp-md-6"><div class="form-group"><select class="selectBox"  id="weekStartList" style="display: none;"></select></div></div></div></div>',weekEndHoliday+='<div class="zprow"><div class="zp-md-6"><div class="zp-md-4"><label class="control-label MT3">'+ZPI18N.getString("zp.workStrtOn")+'</label></div><div class="zp-md-6"><div class="form-group"><select class="selectBox" id="WorkweekStartList" style="display: none;"></select></div></div></div></div>',weekEndHoliday+='<div class="zprow"><div class="zp-md-6"><div class="zp-md-4"><label class="control-label MT3">'+ZPI18N.getString("zp.workEndOn")+'</label></div><div class="zp-md-6"><div class="form-group"><select class="selectBox" id="WorkweekEndList" style="display: none;"></select></div></div></div></div>',weekEndHoliday+='<div class="zp-md-12"><h2 class="ZPbold">'+ZPI18N.getString("zp.weekEndDef")+'<a class="IC-pen lnk ML10 S11"  data-target="#dvWeekdef" id="dataToggle" data-toggle="collapse"  onclick="Organization.Calendar.removeWeekendList(this)"></a></h2></div>',weekEndHoliday+='<div id="dummypenLink">'+Organization.Calendar.constructWeekEndDefinition(resultData)+"</div>",weekEndHoliday+="</div>"},Organization.Calendar.getLocationBasedLeaveReport=function(Obj){var locId=$(Obj).val();null!=locId&&void 0!=locId&&""!=locId.trim()||(locId=-1);var params={locationId:locId,mode:"View"};ZPeople.Request.send(Organization.Calendar.url,params,Organization.Calendar.WeekDaysResponseHandler)},Organization.Calendar.WeekDaysResponseHandler=function(resultData){if(resultData.hasOwnProperty("errorMsg"))ZPeople.Message.showFailureMsg(resultData.errorMsg);else{var workDays=resultData.leaveReport;Layout.Page.container.find("#weekStartList").val(workDays.weekStarts).select2(),Layout.Page.container.find("#WorkweekStartList").val(workDays.workWeekStarts).select2(),Layout.Page.container.find("#WorkweekEndList").val(workDays.workWeekEnds).select2(),Layout.Page.container.find("#dummypenLink").empty().append(Organization.Calendar.constructWeekEndDefinition(resultData)),resultData.leaveReport.isForCurrYear||Layout.Page.container.find("#selectYear").prop("checked",!0),Layout.Page.container.find("#fromDate").val(workDays.fromLeave),Layout.Page.container.find("#error_fromdate").hide(),Layout.Page.container.find("#error_Todate").hide(),Layout.Page.container.find("#toDate").val(workDays.toLeave),resultData.leaveReport.isForCurrYear||(Layout.Page.container.find("#fromDate").removeAttr("disabled"),Layout.Page.container.find("#toDate").removeAttr("disabled"))}},Organization.Calendar.constructWeekEndDefinition=function(resultData){var weekendDiv="",mainDiv='<div id="dvWeekdef" class="zprow fade collapse" aria-expanded="true" style="">';mainDiv+='<table class="table table-hover table-responsive">',mainDiv+='<thead><tr><th width="22"></th><th width="22"></th><th class="text-center" width="15%"> </th><th class="text-center">1st '+ZPI18N.getString("zp.week")+'</th><th class="text-center">2nd '+ZPI18N.getString("zp.week")+'</th><th class="text-center">3rd '+ZPI18N.getString("zp.week")+'</th><th class="text-center">4th '+ZPI18N.getString("zp.week")+'</th><th class="text-center">5th '+ZPI18N.getString("zp.week")+"</th></tr></thead><tbody>";var count=0;return $.each(resultData.leaveReport.getNwDays,function(index,obj){var tr1=$('<tr> <td></td> <td><div class="checkbox checkbox-primary M0"></div></td> <td class="weekDayname"></td><td class="text-center"><div class="DI"><a class="1 IC-rdo-cir-1 text-default"  onclick="Organization.Calendar.toggleWeekEnd(this)" value="1"></a></div></td><td class="text-center"><div class="DI"><a class="2 IC-rdo-cir-1 text-default" onclick="Organization.Calendar.toggleWeekEnd(this)" value="2"></a></div></td><td class="text-center"><div class="DI"><a class="3 IC-rdo-cir-1 text-default" onclick="Organization.Calendar.toggleWeekEnd(this)" value="3"></a></div></td><td class="text-center"><div class="DI"><a class="4 IC-rdo-cir-1 text-default" onclick="Organization.Calendar.toggleWeekEnd(this)" value="4"></a></div></td><td class="text-center"><div class="DI"><a class="5 IC-rdo-cir-1 text-default" onclick="Organization.Calendar.toggleWeekEnd(this)" value="5"></a></div></td></tr>');tr1.find(".weekDayname").html(obj.dispDay),obj.isNone?count++:(weekendDiv+='<div class="zprow listWeekDays" id="'+obj.attrDay+'"><div class="zp-md-6  class="deleteHolidaylist"><div class="zp-md-4"><label class="control-label">'+obj.dispDay+'</label></div><div class="zp-md-8"><div class="form-group">',obj.isAll?(weekendDiv+='<span  class="btn-md addbadge" wkday="'+obj.attrDay+'" value="0" onclick=Organization.Calendar.removeHolidayWeek(this)>'+ZPI18N.getString("zp.allWeek")+'<i class="IC-cls S7 PL5"></i></span>',tr1.find("a").removeClass("IC-rdo-cir-1").removeClass("text-default").addClass("IC-round blu")):(obj.week1&&(weekendDiv+='<span  class="btn-md addbadge MR5" wkday="'+obj.attrDay+'" value="1" onclick=Organization.Calendar.removeHolidayWeek(this)>1st '+ZPI18N.getString("zp.week")+'<span class="IC-cls S7 PL5" ></span></span>',tr1.find(".1").removeClass("IC-rdo-cir-1").removeClass("text-default").addClass("IC-round blu")),obj.week2&&(weekendDiv+='<span class="btn-md addbadge MR5" wkday="'+obj.attrDay+'" value="2" onclick=Organization.Calendar.removeHolidayWeek(this)>2nd '+ZPI18N.getString("zp.week")+'<span class="IC-cls S7 PL5" ></span></span>',tr1.find(".2").removeClass("IC-rdo-cir-1").removeClass("text-default").addClass("IC-round blu")),obj.week3&&(weekendDiv+='<span class="btn-md addbadge MR5" wkday="'+obj.attrDay+'" value="3" onclick=Organization.Calendar.removeHolidayWeek(this)>3rd '+ZPI18N.getString("zp.week")+'<span class="IC-cls S7 PL5" ></span></span>',tr1.find(".3").removeClass("IC-rdo-cir-1").removeClass("text-default").addClass("IC-round blu")),obj.week4&&(weekendDiv+='<span class="btn-md addbadge MR5" wkday="'+obj.attrDay+'" value="4" onclick=Organization.Calendar.removeHolidayWeek(this)>4th '+ZPI18N.getString("zp.week")+'<span class="IC-cls S7 PL5" ></span></span>',tr1.find(".4").removeClass("IC-rdo-cir-1").removeClass("text-default").addClass("IC-round blu")),obj.week5&&(weekendDiv+='<span class="btn-md addbadge MR5" wkday="'+obj.attrDay+'" value="5"  onclick=Organization.Calendar.removeHolidayWeek(this)>5th '+ZPI18N.getString("zp.week")+'<span class="IC-cls S7 PL5"></span></span>',tr1.find(".5").removeClass("IC-rdo-cir-1").removeClass("text-default").addClass("IC-round blu"))),weekendDiv+="</div></div></div></div>"),mainDiv+='<tr  class="'+obj.attrDay+'">'+tr1.html()+"</tr>"}),mainDiv+="</table>",mainDiv+="</div>",count==resultData.leaveReport.getNwDays.length&&(mainDiv+='<div class="zp-md-12 PB10 listWeekDays" id="noHoliday">'+ZPI18N.getString("zp.nonWorkings")+'<a class="btn btn-link"   data-target="#dvWeekdef" data-toggle="collapse" onclick="Organization.Calendar.populateListHoliday(this)">Choose now</a></div>'),mainDiv+='<div id ="weekEndHoliday">'+weekendDiv+"</div>"+Organization.Calendar.typeOfCalendarYear()},Organization.Calendar.removeWeekendList=function(ele){Layout.Page.container.find(".listWeekDays").hide();$(dvWeekdef).on("hide.bs.collapse",function(){var weekEnd="",ele=Layout.Page.container.find("#dvWeekdef tbody tr");for(i=0;i<ele.length;i++){var weekendDiv="",wkday=$(ele[i]).attr("class"),tdArray=$(ele[i]).find(".blu");weekendDiv+='<div class="zprow listWeekDays" id="'+wkday+'"><div class="zp-md-6  class="deleteHolidaylist"><div class="zp-md-4"><label class="control-label">'+wkday+'</label></div><div class="zp-md-8"><div class="form-group">';var wkEnd=!1;if(currentWeek="",5==tdArray.length)currentWeek="All",weekendDiv+='<span  class="btn-md addbadge" wkday="'+wkday+'" value="0" onclick=Organization.Calendar.removeHolidayWeek(this)>'+ZPI18N.getString("zp.allWeek")+'<i class="IC-cls S7 PL5"></i></span>',wkEnd=!0;else for(j=0;j<tdArray.length;j++)1==$(tdArray[j]).attr("value")?(currentWeek="1st",wkEnd=!0):2==$(tdArray[j]).attr("value")?(currentWeek="2nd",wkEnd=!0):3==$(tdArray[j]).attr("value")?(currentWeek="3rd",wkEnd=!0):4==$(tdArray[j]).attr("value")?(currentWeek="4th",wkEnd=!0):5==$(tdArray[j]).attr("value")&&(currentWeek="5th",wkEnd=!0),weekendDiv+='<span class="btn-md addbadge MR5" wkday="'+wkday+'" value='+$(tdArray[j]).attr("value")+" onclick=Organization.Calendar.removeHolidayWeek(this)>"+currentWeek+' week<span class="IC-cls S7 PL5" ></span></span>';weekendDiv+="</div></div></div></div>",wkEnd&&(weekEnd+=weekendDiv)}""!=weekEnd?Layout.Page.container.find("#weekEndHoliday").empty().append(weekEnd):(weekEnd='<div class="zp-md-12 PB10 listWeekDays" id="noHoliday">No non-working days chosen.<a class="btn btn-link"   data-target="#dvWeekdef" data-toggle="collapse" onclick="Organization.Calendar.populateListHoliday(this)">Choose now</a></div>',Layout.Page.container.find("#weekEndHoliday").empty().append(weekEnd))})},Organization.Calendar.populateListHoliday=function(ele){Layout.Page.container.find(".listWeekDays").hide()},Organization.Calendar.removeHolidayWeek=function(ele){var val=$(ele).attr("value"),wkday=$(ele).attr("wkday"),rw=Layout.Page.container.find("#dvWeekdef tbody ."+wkday);"0"==val?(rw.find("a").addClass("IC-rdo-cir-1").addClass("text-default").removeClass("IC-round").removeClass("blu"),$(ele).parent().parent().parent().parent().remove()):(rw.find("."+val).addClass("IC-rdo-cir-1").addClass("text-default").removeClass("IC-round").removeClass("blu"),1==$(ele).parent().children().length&&$(ele).parent().parent().parent().parent().remove()),$(ele).remove(),$("#weekEndHoliday").is(":empty")&&(weekEnd='<div class="zp-md-12 PB10 listWeekDays" id="noHoliday">No non-working days chosen.<a class="btn btn-link"   data-target="#dvWeekdef" data-toggle="collapse" onclick="Organization.Calendar.populateListHoliday(this)">Choose now</a></div>',Layout.Page.container.find("#weekEndHoliday").empty().append(weekEnd))},Organization.Calendar.typeOfCalendarYear=function(){var typeOfYear='<div class="zp-md-12 PB10"><h2 class="ZPbold">'+ZPI18N.getString("zp.calendarSetting")+"</h2></div>";return typeOfYear+='<div class="zprow"><div class="zp-md-6"><div class="zp-md-12 form-group"><div class="radio radio-primary M0"><input checked=""  value="CYEAR"  name="rdocalendarset" type="radio" id ="currntYear" onclick="Organization.Calendar.checkYearType(this)"><label class="control-label" for="rdoCurrentyrs">'+ZPI18N.getString("zp.currentYear")+"</label></div></div></div></div>",typeOfYear+='<div class="zprow"><div class="zp-md-7"><div class="zp-md-3 form-group MT5"><div class="radio radio-primary"><input value="CPERIOD" name="rdocalendarset" type="radio" id ="selectYear" onclick="Organization.Calendar.checkYearType(this)"> <label class="control-label" for="rdoCurrentyrs">'+ZPI18N.getString("zp.yearStrt")+'</label></div> </div><div class="btnCal"><input type="text"  disabled="" class="form-control"  id="fromDate" caltype="cal_settings" onclick=Calendar.setUpCalendar(event,this)><div id="error_fromdate" class="red" style="display: block;">Enter the from date</div></div>',typeOfYear+='<div class="zp-md-2 form-group text-right"><label class="control-label MT3">'+ZPI18N.getString("zp.yearEnd")+'</label></div><div class="btnCal"><div class="input-group"><input type="text" id="toDate"  disabled="" class="form-control" id="toDate"  caltype="cal_settings" onclick=Calendar.setUpCalendar(event,this)></div><div id="error_Todate" class="red" style="display: block;">Enter the To date</div></div></div><div class="clearfix PB15 PT15"><div class="zp-md-6 text-left"> <a class="btn btn-primary" id=updateCal  onclick="Organization.Calendar.UpdateCalendarSettings(this)" ><span class="IC-pen MR5 S13 hide" ></span>Update</a> </div><div class="zp-md-6 text-right"> </div></div>',typeOfYear+="</div></div></div></div></div></div></div></div>"},Organization.Calendar.checkYearType=function(ele){if("currntYear"!=ele.id)Layout.Page.container.find("#fromDate").removeAttr("disabled"),Layout.Page.container.find("#toDate").removeAttr("disabled");else{Layout.Page.container.find("#fromDate").attr("disabled",""),Layout.Page.container.find("#toDate").attr("disabled","")}},Organization.Calendar.toggleWeekEnd=function(ele){$(ele).hasClass("text-default")?$(ele).removeClass("IC-rdo-cir-1").removeClass("text-default").addClass("IC-round blu"):$(ele).removeClass("IC-round blu").addClass("IC-rdo-cir-1").addClass("text-default")},Organization.Calendar.UpdateCalendarSettings=function(data){var loctionId=$("#listLocation").val(),weekStrt=$("#weekStartList").val(),workweekStart=$("#WorkweekStartList").val(),workweekEnds=$("#WorkweekEndList").val(),Datefrom=$("#fromDate").val(),DateTo=$("#toDate").val(),ele=Layout.Page.container.find("#dvWeekdef tbody tr"),weekends={},we={};for(i=0;i<ele.length;i++){var wkday=$(ele[i]).attr("class");we[wkday]="None";var tdArray=$(ele[i]).find(".blu");if(5==tdArray.length)we[wkday]="All";else if(tdArray.length>0)for(we[wkday]="",j=0;j<tdArray.length;j++)weekends=$(tdArray[j]).attr("value"),we[wkday]+=String(weekends)+","}var leaveType=$("input[name=rdocalendarset]:checked").val(),errMsg=!1;if("CYEAR"!=leaveType&&(""==Datefrom.trim()&&(Layout.Page.container.find("#error_fromdate").show(),errMsg=!0),""==DateTo.trim()&&(Layout.Page.container.find("#error_Todate").show(),errMsg=!0)),!errMsg){var params={weekstarts:weekStrt,workweekfrom:workweekStart,leaveCalcType:leaveType,workweekto:workweekEnds,fromDate:Datefrom,toDate:DateTo,wdays:JSON.stringify(we),locationId:loctionId,mode:"Update"};ZPeople.Request.send(Organization.Calendar.url,params,Organization.Calendar.WeekDaysResponseHandler),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.updateCalendarMsg"))}},Organization.import=function(formId){var callback="";"admin/organization/designationdetails/streams"==Layout.Page.currentmode?callback=Organization.ManageOrgs.manageStreamInit:"admin/organization/locations"==Layout.Page.currentmode&&(callback=Organization.ManageOrgs.manageLocInit),Import.init(formId,null,Layout.Page.hash,callback)},ZPreseller={getResellerHeader:function(){return ZPeople.ISResellerConsole?' <div class="copyUserList" ><span> '+ZPI18N.getString("zp.copyemail")+' </span><div > <select  multiple="multiple" id="emailId" onchange="ZPreseller.updateSelect(this)"> </select> </div> </div> <div class="hdr"><label class="onOff"><input id="all" type="checkbox" value="" onchange="ZPreseller.copycustomizeAll(this)"> <div class="checkBox"></div> </label> <span>'+ZPI18N.getString("zp.copycustomizeall")+'</span> </div><div class="box" name="modules" id="module_section">  <h2>                <label class="onOff">                        <input id="all_modules" type="checkbox" value="" onchange="ZPreseller.showallmodules(this)"><div class="checkBox"></div></label><span>'+ZPI18N.getString("zp.allModules")+' </span></h2><ul class="moduleList"><li><span>'+ZPI18N.getString("zp.timetracker")+'</span><label class="onOff"><input id="module_1" class="secinput" type="checkbox" value="timeTracker" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><div class="checkBox"></div></label></li><li><span>'+ZPI18N.getString("zp.attendance")+'</span><label class="onOff"><input id="module_2" class="secinput" type="checkbox" value="attendance" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><div class="checkBox"></div></label></li><li><span>'+ZPI18N.getString("zp.leavetracker")+'</span><label class="onOff"><input id="module_3" class="secinput" type="checkbox" value="leave" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><div class="checkBox"></div></label></li><li><span>'+ZPI18N.getString("zp.files")+'</span><label class="onOff"><input id="module_4" class="secinput" type="checkbox" value="files" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><div class="checkBox"></div></label></li><li><span>'+ZPI18N.getString("zp.PA")+'</span><label class="onOff"><input id="module_5" class="secinput" type="checkbox" value="pa" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><div class="checkBox"></div></label></li><li><span>'+ZPI18N.getString("zp.holidays")+'</span><label class="onOff"><input id="module_6" class="secinput" type="checkbox" value="holidays" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><div class="checkBox"></div></label></li></ul></div><div class="box" id="forms_section"><h2><label class="onOff"><input type="checkbox" id="all_form"><div class="checkBox"></div></label><span>'+ZPI18N.getString("zp.allforms")+'</span></h2><ul class="moduleList" id="formList"></ul></div></div><div class="dvcom-action text-left"><div class="PL30 PR30"><button type="submit" id="submit" class="btn btn-default"  onclick="ZPreseller.sendDetails();">'+ZPI18N.getString("zp.copy")+"</button></div>":'<div id="copycustom-form"><div class="ZPTscrlcont P30" style="top:0"><div class=""><div class="clearfix"><div class="form-group PL0"><label class="col-md-5" for="emailId">'+ZPI18N.getString("zp.copyemail")+'</label><div class="col-md-3"><select  multiple="multiple" id="emailId" onchange="ZPreseller.updateSelect(this)"></select></div></div></div><div class="col-md-12 PB8"><label class="checkbox DI"><input id="all" class="fieldinput " type="checkbox" value="" onchange="ZPreseller.copycustomizeAll(this)"><span>'+ZPI18N.getString("zp.copycustomizeall")+'</span></label></div><div class="copycustom-form"><div><form id="zp_copycustom" role="form"><div class="col-md-7" name="modules" id="module_section"><ul class="list-group"><li class="list-group-item bgrey"><label class="checkbox DI"><input id="all_modules" type="checkbox" value="" onchange="ZPreseller.showallmodules(this)"><span class="ZPbold" name="tabname">'+ZPI18N.getString("zp.allModules")+'</span></label></li><li class="list-group-item" name="fixedLi"><label class="checkbox"><input id="module_1" class="secinput" type="checkbox" value="timeTracker" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><span>'+ZPI18N.getString("zp.timetracker")+'</span></label></li><li class="list-group-item" name="fixedLi"><label class="checkbox"><input id="module_2" class="secinput" type="checkbox" value="attendance" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><span>'+ZPI18N.getString("zp.attendance")+'</span></label></li><li class="list-group-item" name="fixedLi"><label class="checkbox"><input id="module_3" class="secinput" type="checkbox" value="leave" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><span>'+ZPI18N.getString("zp.leavetracker")+'</span></label></li><li class="list-group-item" name="fixedLi"><label class="checkbox"><input id="module_4" class="secinput" type="checkbox" value="files" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><span>'+ZPI18N.getString("zp.files")+'</span></label></li><li class="list-group-item" name="fixedLi"><label class="checkbox" iscolapse="false"><input id="module_5" class="secinput" type="checkbox" value="pa" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><span>'+ZPI18N.getString("zp.PA")+'</span></label></li><li class="list-group-item" name="fixedLi"><label class="checkbox"><input id="module_6" class="secinput" type="checkbox" value="holidays" onchange="ZPreseller.addModules(this,ZPreseller.mod,ZPreseller.jsonObj)"><span>'+ZPI18N.getString("zp.holidays")+'</span></label></li></ul></div></div></form></div></div></div><div class="dvcom-action text-left"><div class="PL30 PR30"><button type="submit" id="submit" class="btn btn-default"  onclick="ZPreseller.sendDetails();">'+ZPI18N.getString("zp.copy")+"</button></div>"},getAccessHeader:function(){return ZPeople.ISResellerConsole?'<div class="copyUserList"> <span> '+ZPI18N.getString("zp.requestemail")+'</span><div> <input type="email" class="form-control" id="emailIdRequest"/> </div><button  id="sendRequest" class="btn btn-primary"  onclick="ZPreseller.sendCustomizationRequest();">'+ZPI18N.getString("zp.sendreq")+"</button></div>":'<div class="dvcpycustm"><div id="accessrequest-form"><div class="mainhead"><div class="form-group col-md-12"><label class="col-md-5" for="emailId">'+ZPI18N.getString("zp.requestemail")+'</label><div class="col-md-3"><input type="email" class="form-control" id="emailIdRequest"></input></div><button  id="sendRequest" class="btn btn-primary"  onclick="ZPreseller.sendCustomizationRequest();">'+ZPI18N.getString("zp.sendreq")+'</button></div></div><div class="dvcom-action text-left"></div></div>'},IS_RESELLER:"false",mod:[],jsonObj:{},FORMS_LIST:{},initPage:function(){var head=ZPreseller.getResellerHeader();head=$(head),Layout.Page.container.parent().find("#admin-copycustomization-copy-copycustomize").empty(),Layout.Page.container.append(head);var val,params={mode:"GetCustomizationRequests",requestType:"0",status:"1",conreqcsr:csrfToken};if($.ajax({url:"/copyCustomRequests.zp",data:params,type:"POST",async:!1,success:function(data){7e3==data.code?val=data.message:ZPeople.Message.showFailureMsg(data.message)}}),void 0!=val){for(key in Layout.Page.container.find("#emailId").select2({allowClear:!0}),Layout.Page.container.find("#emailId").append(jQuery("<option />",{value:"-1"}).text(ZPI18N.getString("zp.all"))),val)Layout.Page.container.find("#emailId").append($("<option>",{value:val[key],text:key}));Layout.Page.container.find("#emailId").on("change",function(val1){val1.added&&-1==val1.added.id?Layout.Page.container.find("#emailId").val([-1]).select2():val1.added&&-1!=val1.added.id&&(Layout.Page.container.find("#emailId [value=-1]").prop("selected",!1),Layout.Page.container.find("#emailId").select2())})}params={method:"formsListPage"};ZPeople.Request.send("/getFormsListing.zp",params,ZPreseller.showFormDetails,"")},showallmodules:function(details){for(var i=1;i<=7;i++)document.getElementById("module_"+i).checked=details.checked,$("#module_"+i).change();details.checked?ZPreseller.mod=["timeTracker","attendance","leave","files","pa","holidays","analytics"]:ZPreseller.mod=[]},copycustomizeAll:function(input){1==input.checked?(Layout.Page.container.find("#module_section *").addClass("disabled unsel"),Layout.Page.container.find("#forms_section *").addClass("disabled unsel"),ZPreseller.mod=["all"],ZPreseller.jsonObj=["all"]):(Layout.Page.container.find("#module_section *").removeClass("disabled unsel"),Layout.Page.container.find("#forms_section *").removeClass("disabled unsel"),ZPreseller.mod=[],ZPreseller.jsonObj=[])},updateSelect:function(details){var options=$(details).val();null!=options&&options.indexOf("all")>-1&&1!=options.length&&$(details).select2("val","all")},showFormDetails:function(result){ZPreseller.FORMS_LIST=result;var tabs=result.tabFormDetails;if(ZPeople.ISResellerConsole){var list=Layout.Page.container.find("#formList");for(tabid in tabs){(firstDiv=jQuery("<li />",{id:"tabid-"+tabs[tabid].tabId})).append(jQuery("<span />").append(tabs[tabid].tabDisplayName)),firstDiv.append(jQuery("<label />",{class:"onOff"}).append(jQuery("<input />",{id:"tab_"+tabs[tabid].tabId,type:"checkbox",value:tabs[tabid].tabId})).append(jQuery("<div />",{class:"checkBox"}))),firstDiv.append(' <div class="checkArw"></div>');var forms=tabs[tabid].formDetailsMap,headId=jQuery("<ul />");for(formid in forms){(li=jQuery("<li />",{id:"forms_formid-"+forms[formid].formId})).append(jQuery("<span />").append(forms[formid].formName)),li.append(jQuery("<label />",{class:"onOff"}).append(jQuery("<input />",{id:"form_"+forms[formid].formId,isSystem:!forms[formid].isCustom,type:"checkbox",onchange:"",value:tabs[tabid].tabId+"-"+forms[formid].formId})).append(jQuery("<div />",{class:"checkBox"}))),li.attr("isDisp",!0),headId.append(li)}firstDiv.append(headId),list.append(firstDiv)}$(".checkArw").click(function(){$(this).parents(".moduleList li").toggleClass("open")}),Layout.Page.container.find("input[type=checkbox]").on("change",function(ele){$(ele.currentTarget).is(":checked")?$(ele.currentTarget).closest("label").addClass("sel"):$(ele.currentTarget).closest("label").removeClass("sel")})}else{list=jQuery("<div />");var len=tabs.length-1;for(tabid in tabs){var firstDiv=jQuery("<li />",{class:"list-group-item clearfix bgrey"});tabid==len&&(firstDiv=jQuery("<li />",{class:"list-group-item clearfix bgrey MB40"}));forms=tabs[tabid].formDetailsMap;var secs=jQuery("<div />",{class:"ZPbold bgrey",id:"tabid-"+tabs[tabid].tabId});secs.append(jQuery("<div />",{class:"form-group MB0"}).append(jQuery("<label/>",{class:"checkbox DI",isColapse:!1}).append(jQuery("<input />",{class:"secinput",id:"tab_"+tabs[tabid].tabId,type:"checkbox",value:tabs[tabid].tabId})).append(jQuery("<span />").text(tabs[tabid].tabDisplayName))).append(jQuery("<i/>",{class:"IC-ar-dwn pull-right"})));headId=jQuery("<ul />",{id:"lstsec"+tabid,class:"list-group BL0 collapse MT10 MB0","aria-expanded":"false"});for(formid in forms){var li;(li=jQuery("<li />",{class:"list-group-item clearfix",id:"forms_formid-"+forms[formid].formId})).append(jQuery("<div />",{class:" PL0"}).append(jQuery("<label/>",{class:"checkbox"}).append(jQuery("<input />",{id:"form_"+forms[formid].formId,class:"fieldinput",isSystem:!forms[formid].isCustom,type:"checkbox",onchange:"",value:tabs[tabid].tabId+"-"+forms[formid].formId})).append(jQuery("<span />").text(forms[formid].formName)))),li.attr("isDisp",!0),headId.append(li)}firstDiv.append(secs),firstDiv.append(headId),list.append(firstDiv)}var head=jQuery("<div />",{id:"forms_section",class:"col-md-7",name:"forms"}).append(jQuery("<ul />",{class:"list-group MB40 PB40 clearfix"}).append(jQuery("<li />",{class:"list-group-item clearfix"}).append(jQuery("<div />",{class:"col-md-3 PL0"}).append(jQuery("<label/>",{class:"checkbox"}).append(jQuery("<input />",{id:"all_form",value:"forms",class:"fieldinput ",type:"checkbox"})).append(jQuery("<span />").text(ZPI18N.getString("zp.allforms")))))).append(list));Layout.Page.container.find("#zp_copycustom").append(head),Layout.Page.container.find('[id^="tabid-"]').click(function(e){"false"!=$(e.target).parent().attr("iscolapse")&&(void 0!=$(e.target).attr("id")&&0==$(e.target).attr("id").indexOf("tabid-")?$(e.target).siblings().collapse("toggle"):$(e.target).closest('[id^="tabid-"]').siblings().collapse("toggle"))})}Layout.Page.container.find("input[isSystem='true']").prop("checked",!0).attr("disabled",!0).change(),Layout.Page.container.find("#all").click(function(){$(":checkbox").not("[disabled='disabled']").prop("checked",$(this).prop("checked")).change()}),Layout.Page.container.find("#all_form").click(function(){Layout.Page.container.find("[id^='tab_']").prop("checked",$(this).prop("checked")).change(),$(this).closest("li").siblings().find('[id^="form_"]').prop("checked",$(this).prop("checked")).change()}),Layout.Page.container.find("[id^='tab_']").click(function(){var ele=$(this).closest('[id^="tabid-"]');ZPeople.ISResellerConsole||(ele=ele.siblings()),ele.find(":checkbox[isSystem='false']").prop("checked",$(this).prop("checked")).change()})},addModules:function(modDetails,array,abc){if(modDetails.checked)array.push(modDetails.value),7==array.length&&($("#all_modules").prop("checked",!0),$("#all_modules").closest("label").addClass("sel"));else{var i=array.indexOf(modDetails.value);i>-1&&array.splice(i,1),$("#all_modules").prop("checked",!1),$("#all_modules").closest("label").removeClass("sel")}},sendDetails:function(){var emailId=$("#emailId").val(),modDetails=ZPreseller.mod.join(),mdtls={};if("all"!=modDetails?($.each(ZPreseller.mod,function(ind,val){mdtls[val]=!0}),ZPreseller.jsonObj=[],Layout.Page.container.find("[id^='form_']").each(function(){if(this.checked){var value=$(this).attr("value"),l=value.indexOf("-"),formid=value.slice(l+1);ZPreseller.jsonObj.push(formid)}}),mdtls.formIds=ZPreseller.jsonObj):mdtls.isAll=!0,""==emailId||null==emailId||""==modDetails&&!Object.keys(ZPreseller.jsonObj).length)ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.inputreq"));else{document.getElementById("submit").disabled=!0;var params={mode:"CopyCustomizationToAccount",emailIds:JSON.stringify(emailId),mDtls:JSON.stringify(mdtls)};ZPeople.Request.send("/copyCustomAccess.zp",params,ZPreseller.showResponse)}},showResponse:function(result){document.getElementById("submit").disabled=!1,7e3!=result.code?ZPeople.Message.showFailureMsg(result.message):ZPeople.Message.showSuccessMsg(result.message)},requestAccessPage:function(){Layout.Page.container.parent().find("#admin-copycustomization-copy-customizationrequest").empty();var head=ZPreseller.getAccessHeader();head=$(head),responseContent='<div class="'+(ZPeople.ISResellerConsole?"":"ZPTscrlcont")+'"><div class="table-responsive"><table class="table table-hover">',responseContent+='<thead id="zp_approval_header"><tr class="ZPLHRow"><th colspan="1">'+ZPI18N.getString("zp.email")+"</th><th>"+ZPI18N.getString("zp.status")+'</th></tr></thead><tbody id="zp_request_bodycontent"></tbody></table></div></div>',ZPeople.ISResellerConsole?head=ZPreseller.getAccessHeader()+responseContent:head.append(responseContent),Layout.Page.container.append(head);ZPeople.Request.send("/copyCustomRequests.zp",{mode:"GetCustomizationRequests",requestType:"0"},ZPreseller.constructResponse)},constructResponse:function(result){if(7e3==result.code){result.message;for(var requestContent="",i=0;i<result.message.length;i++){var status;1==result.message[i].isCompleted?status=ZPI18N.getString("zp.copycust.completedmsg"):-1==result.message[i].status?status="true"===ZPeople.IS_RESELLER?ZPI18N.getString("zp.pending"):ZPI18N.getString("zp.copycust.pendingmsg"):1==result.message[i].status?status="true"===ZPeople.IS_RESELLER?ZPI18N.getString("zp.approved"):ZPI18N.getString("zp.copycust.approvemsg"):0==result.message[i].status&&(status="true"===ZPeople.IS_RESELLER?ZPI18N.getString("zp.rejected"):ZPI18N.getString("zp.copycust.rejectmsg")),requestContent+='<tr class="ZPLRow" id=row_'+result.message[i].emailId+' copycustid="'+result.message[i].id+'"><td>'+result.message[i].emailId+"</td>",requestContent+="<td>"+status+"</td>","false"===ZPeople.IS_RESELLER&&0==result.message[i].isCompleted&&-1==result.message[i].status&&(requestContent+='<td><button class="btn btn-default btn-sm btnstnwid" id="zp_requestApprove" type="button"  emailid="'+result.message[i].emailId+'"value="1" onclick="ZPreseller.sendApproveReject(this)">'+ZPI18N.getString("zp.approve")+'</button> <button class="btn btn-default btn-sm btnstnwid" id="zp_requestReject" type="button"   emailid="'+result.message[i].emailId+'" value="0" onclick="ZPreseller.sendApproveReject(this)">'+ZPI18N.getString("zp.reject")+"</button></td>"),requestContent+="</tr>"}Layout.Page.container.find("#zp_request_bodycontent").append(requestContent)}else ZPeople.Message.showFailureMsg(result.message)},sendCustomizationRequest:function(){var emailId=document.getElementById("emailIdRequest").value;if(!ZPUtil.Validation.isEmpty(emailId)&&ZPUtil.Validation.isEmail(emailId)){var params={mode:"addEmail",emailId:emailId};document.getElementById("sendRequest").disabled=!0,ZPeople.Request.send("/copyCustomAccess.zp",params,ZPreseller.sendCustomizationRequestResponse)}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.copycustomization.enteravalidemailaddress"))},sendCustomizationRequestResponse:function(result){document.getElementById("sendRequest").disabled=!1,Layout.Page.container.find("#emailIdRequest").val(""),7e3==result.code?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.copycust.sucmsg")),ZPreseller.constructResponse(result)):ZPeople.Message.showFailureMsg(result.message)},sendApproveReject:function(details){var status=details.value;$(details).attr("emailid");Layout.Page.container.find("#zp_requestApprove,#zp_requestReject").addClass("disabled");var params={mode:"ApproveRejectAccess",id:$(details).closest("tr").attr("copycustid"),status:status};ZPeople.Request.send("/copyCustomRequests.zp",params,ZPreseller.sendApproveRejectResponse)},sendApproveRejectResponse:function(result){if(Layout.Page.container.find("#zp_requestApprove,#zp_requestReject").removeClass("disabled"),7e3==result.code){var status,statusStr;for(key in result.message)status=result.message[key];1==status?statusStr=ZPI18N.getString("zp.copycust.approvemsg"):0==status&&(statusStr=ZPI18N.getString("zp.copycust.rejectmsg"));var row=Layout.Page.container.find("tr[copycustid="+key+"]");$(row).find("td:nth-child(2)").html(statusStr),$(row).children("td:last").html(" ")}else ZPeople.Message.showFailureMsg(result.message)},userPage:function(){Layout.Page.container.parent().find("#admin-customizationrequest").empty();Layout.Page.container.append($('<div class="dvcpycustm"><div class="mainhead"><div class="row"><div class="col-md-6"><div class="col-md-12 PT5">Copy Customization Requests</div></div></div></div></div>'));var table='<div class="ZPTscrlcont"><div class="table-responsive"><table class="table table-hover">';table+='<thead id="zp_request_header"><tr class="ZPLHRow"><th>'+ZPI18N.getString("zp.email")+'</th><th width="30%">'+ZPI18N.getString("zp.status")+'</th><th width="20%"></th></tr></thead><tbody id="zp_request_bodycontent"></tbody></table></div></div>',Layout.Page.container.find(".dvcpycustm").append($(table));ZPeople.Request.send("/copyCustomRequests.zp",{mode:"GetCustomizationRequests",requestType:"1"},ZPreseller.constructResponse)}};var Marketplace={init:function(){}};Marketplace.InstalledTab={URL:"getInstalledExtensions.zp",extensionComponents:{},init:function(){var params={isLatestVersionNeeded:!0,method:"getInstalledExtensions"};ZPeople.Request.send(Marketplace.InstalledTab.URL,params,function(data){Marketplace.InstalledTab.extensionList=data.extensionArray,Marketplace.InstalledTab.loadListUI()})},loadListUI:function(){var extensionArray=Marketplace.InstalledTab.extensionList,extensionString="";let alertBodyContent="<p>".concat(ZPI18N.getString("zp.marketplace.uninstallconfirmationtext"),"</p><div class='ZPlgrybg P10 MT20I' id='notifyCheckDiv'><div class='d-flex a-itm-cntr j-cnt-cntr'><div class='checkbox'><input type='checkbox' id='export-alert-checkbox' /><label></label></div><p class='MB5'>").concat(ZPI18N.getString("zp.extension.uninstall.exportalert"),"</p></div></div>");if(0===extensionArray.length)extensionString=ZPUtil.newNoDataHTML("CR-nodata",8,ZPI18N.getString("zp.nodatafound"),void 0,void 0,void 0);else for(var extI=0,extN=extensionArray.length;extI<extN;++extI)extensionString+='<div class="ZP_mp_hdr bdr" id="zpPublish2" extension_id="'.concat(extensionArray[extI].EXTENSION_ID,'" mapped_extension_id="').concat(extensionArray[extI].DEV_EXTENSION_ID,'" extension_version="').concat(extensionArray[extI].LATEST_VERSION,'" max_version="').concat(extensionArray[extI].MAX_VERSION,'" extension_installed_by="').concat(extensionArray[extI].CREATED_BY,'" ').concat(void 0!==extensionArray[extI].LICENSE_DETAILS?'license="'+extensionArray[extI].LICENSE_DETAILS.STATUS+'"':"",'>\n\t\t\t\t\t\t                    <img src="/getExtensionLogo.zp?ZSOID=').concat(_LOGGEDIN_ZSOID,"&extensionID=").concat(extensionArray[extI].DEV_EXTENSION_ID,'&method=getExtensionLogo">\n\t\t\t\t\t\t                    <div>\n\t\t\t\t\t\t                        <h1 id="extension-name">\n\t\t\t\t\t\t                            ').concat(extensionArray[extI].NAME,'                       \n\t\t\t\t\t\t                        </h1>\n\t\t\t\t\t\t                        <p class="dgry" id="extension-description">\n\t\t\t\t\t\t                            ').concat(extensionArray[extI].DESCRIPTION,'\n\t\t\t\t\t\t                        </p>\n\t\t\t\t\t\t                        <span>\n\t\t\t\t\t\t                            <a class="MR20" onclick="Marketplace.InstalledTab.loadConfigurationUI(this)">').concat(ZPI18N.getString("zp.configure"),"</a>\n\t\t\t\t\t\t                            <a onclick=\"ZPeople.confirm( this,'").concat(ZPI18N.getString("zp.marketplace.uninstallconfirmation"),"','").concat(alertBodyContent.replaceAll("'","\\'"),"', Marketplace.InstalledTab.uninstall, false, true, '', true, false, Marketplace.InstalledTab.cancelUninstall); Marketplace.InstalledTab.preUninstallCheck();\">").concat(ZPI18N.getString("zp.marketplace.uninstall"),"</a>\n\t\t\t\t\t\t                        </span>\n\t\t\t\t\t\t                    </div>                          \n\t\t\t\t\t\t                </div>");document.getElementById("installedTabDiv").innerHTML=extensionString},loadConfigurationUI:function(data){var extensionDiv=data.parentElement.parentElement.parentElement,extensionID=extensionDiv.getAttribute("extension_id"),mappedExtensionID=extensionDiv.getAttribute("mapped_extension_id"),extensionConfiguration='<div class="ZPSettings">\n\t\t\t\t\t\t\t\t\t\t\t<div class="profileDiv">\n\t\t\t\t\t\t\t\t\t\t\t    <div class="profLocale info">\n\t\t\t\t\t\t\t\t\t\t\t        <h2>\n\t\t\t\t\t\t\t\t\t\t\t            <span>\n\t\t\t\t\t\t\t\t\t\t\t                <i class="IC-l-ar-top" id="extensionListBack" onclick="Marketplace.InstalledTab.loadListUI()"></i>\n\t\t\t\t\t\t\t\t\t\t\t                '.concat(ZPI18N.getString("zp.extensiondetails"),'\n\t\t\t\t\t\t\t\t\t\t\t            </span>\n\t\t\t\t\t\t\t\t\t\t\t        </h2>\n\t\t\t\t\t\t\t\t\t\t\t        <div class="form-horizontal pad">\n\t\t\t\t\t\t\t\t\t\t\t            \n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t            <div class="zp-label" isallowed="true">\n\t\t\t\t\t\t\t\t\t\t\t                <p class="zplt-label">').concat(ZPI18N.getString("zp.name"),'</p>\n\t\t\t\t\t\t\t\t\t\t\t                <div class="zprt-label PT5"><span>').concat(extensionDiv.querySelector("#extension-name").innerText,'</span></div>\n\t\t\t\t\t\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t            <div class="zp-label">\n\t\t\t\t\t\t\t\t\t\t\t                <p class="zplt-label">\n\t\t\t\t\t\t\t\t\t\t\t                    ').concat(ZPI18N.getString("zp.version"),'\n\t\t\t\t\t\t\t\t\t\t\t                </p>\n\t\t\t\t\t\t\t\t\t\t\t                <div class="zprt-label PT5"><span>').concat(extensionDiv.getAttribute("max_version"),'</span></div>\n\t\t\t\t\t\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t\t\t\t\t\t            <div class="zp-label">\n\t\t\t\t\t\t\t\t\t\t\t                <p class="zplt-label">\n\t\t\t\t\t\t\t\t\t\t\t                    ').concat(ZPI18N.getString("zp.installedby",[""]),'\n\t\t\t\t\t\t\t\t\t\t\t                </p>\n\t\t\t\t\t\t\t\t\t\t\t                <div class="zprt-label PT5"><span>').concat(ZPeople.getUserDetailsById(extensionDiv.getAttribute("extension_installed_by")).email,'</span></div>\n\t\t\t\t\t\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t\t\t\t\t\t            <div class="zp-label">\n\t\t\t\t\t\t\t\t\t\t\t                <p class="zplt-label">\n\t\t\t\t\t\t\t\t\t\t\t                    ').concat(ZPI18N.getString("zp.description"),'\n\t\t\t\t\t\t\t\t\t\t\t                </p>\n\t\t\t\t\t\t\t\t\t\t\t                <div class="zprt-label PT5"><span>').concat(""===extensionDiv.querySelector("#extension-description").innerText?ZPI18N.getString("zp.nodescription"):ZSEC.Encoder.encodeForHTML(extensionDiv.querySelector("#extension-description").innerText),"</span></div>                                            \n\t\t\t\t\t\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t").concat(null!=extensionDiv.getAttribute("license")?'<div class="zp-label">\n\t\t\t\t\t\t\t\t\t\t\t\t                <p class="zplt-label">\n\t\t\t\t\t\t\t\t\t\t\t\t                    '.concat(ZPI18N.getString("zp.status"),'\n\t\t\t\t\t\t\t\t\t\t\t\t                </p>\n\t\t\t\t\t\t\t\t\t\t\t\t                <div class="zprt-label PT5"><span>').concat("true"===extensionDiv.getAttribute("license")?ZPI18N.getString("zp.available"):ZPI18N.getString("zp.expired"),"</span></div>                                            \n\t\t\t\t\t\t\t\t\t\t\t\t            </div>"):"",'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   \n\t\t\t\t\t\t\t\t\t\t\t        </div>\n\t\t\t\t\t\t\t\t\t\t\t    </div>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t    <div class="profLocale info">\n\t\t\t\t\t\t\t\t\t\t\t        <h2 class="bn">').concat(ZPI18N.getString("zp.integration"),'</h2>\n\t\t\t\t\t\t\t\t\t\t\t        <div id="extension-connection">\n\t\t\t\t\t\t\t\t\t\t\t        </div>\n\t\t\t\t\t\t\t\t\t\t\t    </div>\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t    <div class="profLocale">\n\t\t\t\t\t\t\t\t\t\t\t        <h2 class="bn">').concat(ZPI18N.getString("zp.marketplace.installedcomponents"),'</h2>\n\t\t\t\t\t\t\t\t\t\t\t        <div id="extension-components">\n\t\t\t\t\t\t\t\t\t\t\t        </div>\n\t\t\t\t\t\t\t\t\t\t\t    </div>                                \n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>');document.getElementById("installedTabDiv").innerHTML=extensionConfiguration,void 0===Marketplace.InstalledTab.extensionComponents[extensionID]?ZPeople.Request.send("getExtensionDetail.zp",{method:"getExtensionDetail",extensionID:extensionID,mappedExtensionID:mappedExtensionID},function(data){Marketplace.InstalledTab.extensionComponents[extensionID]=data.details,Marketplace.InstalledTab.loadExtensionComponentsUI(Marketplace.InstalledTab.extensionComponents[extensionID]),Marketplace.InstalledTab.loadExtensionConnections(data.integrations)}):Marketplace.InstalledTab.loadExtensionComponentsUI(Marketplace.InstalledTab.extensionComponents[extensionID])},loadExtensionComponentsUI:function(components){for(var tableStringTop='<tr class="ZPLRow DNI">\n\t\t\t\t\t                <td colspan="5" class="innerTable">\n\t\t\t\t\t                    <div class="table-responsive ZPjobsTbl">\n\t\t\t\t\t                        <table class="table table-hover MB0I">\n\t\t\t\t\t                            <thead>\n\t\t\t\t\t                                <tr>\n\t\t\t\t\t                                    <th width="280">'.concat(ZPI18N.getString("zp.name"),'</th>\n\t\t\t\t\t                                    <th width="410">').concat(ZPI18N.getString("zp.extension.componenttype"),"</th>\n\t\t\t\t\t                                    <th>").concat(ZPI18N.getString("zp.extension.parentcomponent"),"</th>\n\t\t\t\t\t                                </tr>\n\t\t\t\t\t                            </thead>\n\t\t\t\t\t                            <tbody>"),tableStringBody="",i=0,n=components.length;i<n;++i){var component=components[i];tableStringBody+='<tr class="ZPLRow">\n\t\t\t        \t<td>'.concat(ZSEC.Encoder.encodeForHTML(component.compName),"</td>\n\t\t\t            <td>").concat(ZPI18N.getString(PlatformConstants.ComponentType[+component.compType]),"</td>\n\t\t\t            <td>").concat(void 0===component.parCompName?"-":ZSEC.Encoder.encodeForHTML(component.parCompName),"</td>\n\t\t\t         </tr>")}document.getElementById("extension-components").innerHTML=tableStringTop+tableStringBody+"           </tbody>    \n\t\t\t\t\t                        </table>\n\t\t\t\t\t                    </div>   \n\t\t\t\t\t                </td>\n\t\t\t\t\t            </tr>"},loadExtensionConnections:function(connections){for(var divContent="",i=0,n=connections.length;i<n;++i){var connection=connections[i];divContent+='<div class="zp-label">\n\t\t\t\t                <p class="zplt-label">\n\t\t\t\t                    '.concat(connection.displayName,"\n\t\t\t\t                </p>\n\t\t\t\t            </div>")}0===divContent.length&&(divContent=ZPI18N.getString("zp.extension.noconnections")),document.getElementById("extension-connection").innerHTML='<div class="form-horizontal pad">'+divContent+"</div>"},exportCheckBoxListner:function(){let confirmButton=document.querySelector("#confirmationPopup #confirmConfirmationPopup");confirmButton.getAttribute("disabled")?confirmButton.removeAttribute("disabled"):confirmButton.setAttribute("disabled",!0)},preUninstallCheck:function(){let container=document.querySelector("#confirmationPopup"),exportCheckBox=container.querySelector("#export-alert-checkbox"),confirmButton=container.querySelector("#confirmConfirmationPopup");confirmButton.setAttribute("disabled",!0);exportCheckBox.addEventListener("click",Marketplace.InstalledTab.exportCheckBoxListner)},uninstall:function(object){var params={method:"uninstallExtension"};params.extensionID=object.parentElement.parentElement.parentElement.getAttribute("extension_id"),ZPeople.Request.send("uninstallExtension.zp",params,function(data){"ZPEC011"==data.status?(object.parentElement.parentElement.parentElement.remove(),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.marketplace.uninstallsuccess"))):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.marketplace.uninstallfailed"))}),0===document.querySelector("#installedTabDiv .ZP_mp_hdr").length&&(object.parentElement.parentElement.parentElement.parentElement.innerHTML=ZPUtil.newNoDataHTML("CR-nodata",8,ZPI18N.getString("zp.nodatafound"),void 0,void 0,void 0))},cancelUninstall:function(){document.querySelector("#confirmationPopup #export-alert-checkbox").removeEventListener("click",Marketplace.InstalledTab.exportCheckBoxListner)}},Marketplace.UpdatesTab={URL:"getInstalledExtensions.zp",extensionComponents:{},init:function(){var params={isLatestVersionNeeded:!0,method:"getInstalledExtensions"};ZPeople.Request.send(Marketplace.UpdatesTab.URL,params,function(data){Marketplace.UpdatesTab.extensionList=data.extensionArray,Marketplace.UpdatesTab.loadListUI()})},loadListUI:function(){for(var extensionArray=Marketplace.UpdatesTab.extensionList,extensionString="",extI=0,extN=extensionArray.length;extI<extN;++extI)2===extensionArray[extI].TYPE&&extensionArray[extI].LATEST_VERSION>extensionArray[extI].MAX_VERSION&&(extensionString+='<div class="ZP_mp_hdr bdr" id="zpPublish2" extension_id="'.concat(extensionArray[extI].EXTENSION_ID,'" extension_version="').concat(extensionArray[extI].VERSION,'" extension_installed_by="').concat(extensionArray[extI].CREATED_BY,'">\n\t                    <img src="/getExtensionLogo.zp?ZSOID=').concat(_LOGGEDIN_ZSOID,"&extensionID=").concat(extensionArray[extI].DEV_EXTENSION_ID,'&method=getExtensionLogo">\n\t                    <div>\n\t                        <h1 id="extension-name">\n\t                            ').concat(extensionArray[extI].NAME,'                       \n\t                        </h1>\n\t                        <p class="dgry" id="extension-description">\n\t                            ').concat(extensionArray[extI].DESCRIPTION,'\n\t                        </p>\n\t                        <span>\n\t                            <a href="').concat("https://"+window.location.host+"/marketplace/installPrivateExtension?devZSOID="+extensionArray[extI].ZSOID+"&extensionID="+extensionArray[extI].DEV_EXTENSION_ID+"&version="+extensionArray[extI].LATEST_VERSION,'">').concat(ZPI18N.getString("zp.marketplace.install"),"</a>\n\t                        </span>\n\t                    </div>                          \n\t                </div>"));""===extensionString&&(extensionString=ZPUtil.newNoDataHTML("CR-nodata",8,ZPI18N.getString("zp.nodatafound"),void 0,void 0,void 0)),document.getElementById("updatesTabDiv").innerHTML=extensionString}},Marketplace.IFrame={isLoaded:!1,init:function(){Marketplace.IFrame.listen()},listen:function(){Marketplace.IFrame.isLoaded&&(window.addEventListener("message",function(event){event.origin==window.location.origin&&void 0==event.data.whatsapp&&(tt=event,window.location.href=event.data)}),Marketplace.IFrame.isLoaded=!1)}};var Extension={URL:"extensionOperation.zp",EMAIL_REGEX:/^([A-Za-z0-9-._%-+]+@[A-Za-z0-9.-]+\.[a-zA-Z]{2,6}(,?))+$/i,cache:{},onlySharePrivatelyStatus:[1,2,3,5],init:function(){document.getElementById("marketPublish").setAttribute("disabled",!0),document.getElementById("marketPublish").addEventListener("click",Extension.marketplacePublishCallback),Extension.getExtensions(),document.getElementById("publishButton").addEventListener("click",Extension.publish),ZPeople.Request.send("getUnPublishedComponents.zp",{method:"getUnPublishedComponents"},function(data){Extension.cache.unPublishedComponent=data,"{}"===JSON.stringify(Extension.cache.unPublishedComponent.components)?document.getElementById("marketPublish").setAttribute("disabled",!0):document.getElementById("marketPublish").removeAttribute("disabled")})},marketplacePublishCallback:function(){Layout.Page.container.find("#publishModal").modal("show"),Extension.getUnPublishedComponenets()},getExtensions:function(){var params={method:"getExtensions",isLatestVersionNeeded:!0};ZPeople.Request.send(Extension.URL,params,Extension.loadPage)},getUnPublishedComponenets:function(){Extension.loadUnPublishedComponents(Extension.cache.unPublishedComponent)},loadPage:function(resultData){var outerStartHTML='<div class="table-responsive ZPjobsTbl" id="zpListTab">\n\t\t\t\t\t\t\t\t            <table class="table table-hover MB0I" id="versionTable">\n\t\t\t\t\t\t\t\t                <thead>\n\t\t\t\t\t\t\t\t                    <tr>\n\t\t\t\t\t\t\t\t                        <th width="210">'.concat(ZPI18N.getString("zp.name"),'</th>\n\t\t\t\t\t\t\t\t                        <th width="210">').concat(ZPI18N.getString("zp.date"),"</th>\n\t\t\t\t\t\t\t\t                        \n\t\t\t\t\t\t\t\t                        <th>").concat(ZPI18N.getString("zp.status"),'</th>\n\t\t\t\t\t\t\t\t                        <th width="210"></th>\n\t\t\t\t\t\t\t\t                    </tr>\n\t\t\t\t\t\t\t\t                </thead>\n\t\t\t\t\t\t\t\t                <tbody>'),extensionVersionsArray=resultData.extensionDetails.versions;Extension.initLatestVersionComponent(resultData.extensionDetails);var trString="";if(extensionVersionsArray&&extensionVersionsArray.length>0){$.each(extensionVersionsArray,function(index,extensionVersion){trString+='<tr class="ZPLRow" expanded="false" extensionVersion="'.concat(extensionVersion.version,'">\n\t\t\t\t                        <td><a>').concat(extensionVersion.version,"</a></td>\n\t\t\t\t                        <td>").concat(moment(extensionVersion.modified_time).format(dateFmt.toUpperCase()),"</td>\n\t\t\t\t                        \n\t\t\t\t                        <td>").concat(PlatformConstants.ExtensionStatus[extensionVersion.status],"</td>\n\t\t\t\t                        ").concat(-1!==Extension.onlySharePrivatelyStatus.indexOf(+extensionVersion.status)?'<td><span class="btn btn-default" onclick="Extension.showSharePrivatelyPopup()">Share Privately</span></td>':"<td></td>","\n\t\t\t\t                    </tr>"),trString+=Extension.constructComponentTable(extensionVersion.componentArray)}),document.getElementById("versionTableDiv").innerHTML=outerStartHTML+trString+" \t\t\t\t</tbody>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t</div>";for(var versionTable=document.getElementById("versionTable"),i=1,n=versionTable.rows.length;i<n;i+=2){versionTable.rows[i].addEventListener("click",Extension.versionTableRowListener)}}else extensionVersionsArray&&0==extensionVersionsArray.length&&(document.getElementById("versionTableDiv").innerHTML=ZPUtil.newNoDataHTML("CR-nodata",8,ZPI18N.getString("zp.extension.nocomponentsfound"),void 0,void 0,void 0))},versionTableRowListener:function(){"false"==this.getAttribute("expanded")?(this.nextSibling.classList.remove("DNI"),this.setAttribute("expanded",!0),$(this.nextSibling).find(".table-responsive").slideDown()):($(this.nextSibling).find(".table-responsive").slideUp(),this.setAttribute("expanded",!1),setTimeout(function(){this.nextSibling.classList.add("DNI")}.bind(this),200))},publish:function(){document.getElementById("publishButton").setAttribute("disabled","true");var params={method:"publishExtension"};ZPeople.Request.send("publishExtensionToMarketplace.zp",params,function(resultData){"ZPEC101"==resultData.status?location.reload(!0):"ZPEC102"==resultData.status&&ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror"))})},initLatestVersionComponent:function(extension){var link=void 0!==extension.latestVersion?"https://"+window.location.host+"/marketplace/installPrivateExtension?devZSOID="+_LOGGEDIN_ZSOID+"&extensionID="+extension.EID+"&version="+extension.latestVersion:"";document.getElementById("latestVersionName").innerHTML=extension.name,document.getElementById("latestVersionName").setAttribute("ext-uuid",extension.UUID),document.getElementById("latestVersionLink").innerHTML=link,document.getElementById("latestVersionNumber").innerHTML=void 0!==extension.latestVersion?extension.latestVersion:"-",document.getElementById("latestVersionLink").addEventListener("click",function(e){Extension.copyToClipboard(e.target.innerText),ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.extension.linkcopied"))}),document.getElementById("publishExtensionLogo").setAttribute("src","/getExtensionLogo.zp?ZSOID="+_LOGGEDIN_ZSOID+"&extensionID="+pfExtId+"&method=getExtensionLogo"),document.getElementById("extensionLogoPreview").setAttribute("src",document.getElementById("publishExtensionLogo").getAttribute("src")),Extension.EditModal.init(extension),Extension.SharePrivately.init()},constructComponentTable:function(componentArray){for(var tableStringTop='<tr class="ZPLRow DNI">\n                                            <td colspan="5" class="innerTable">\n                                                <div class="table-responsive ZPjobsTbl" style="display: none;">\n                                                    <table class="table table-hover MB0I">\n                                                        <thead>\n                                                            <tr>\n                                                                <th width="280">'.concat(ZPI18N.getString("zp.name"),'</th>\n                                                                <th width="410">').concat(ZPI18N.getString("zp.extension.componenttype"),"</th>\n                                                                <th>").concat(ZPI18N.getString("zp.extension.parentcomponent"),'</th>\n                                                                <th width="150">').concat(ZPI18N.getString("zp.action"),"</th>\n                                                            </tr>\n                                                        </thead>\n                                                        <tbody>"),i=0,n=componentArray.length;i<n;++i){var component=componentArray[i];'<tr class="ZPLRow">\n                                    \t<td>'.concat(ZSEC.Encoder.encodeForHTML(component.compName),"</td>\n                                        <td>").concat(ZPI18N.getString(PlatformConstants.ComponentType[+component.compType]),"</td>\n                                        <td>").concat(ZSEC.Encoder.encodeForHTML(component.parCompName),"</td>\n                                        <td>").concat(ZPI18N.getString(PlatformConstants.ActionType[+component.operation]),"</td>\n                                     </tr>")}return tableStringTop+Extension.constructInnerTableRow(componentArray)+"                   </tbody>    \n                                                    </table>\n                                                </div>   \n                                            </td>\n                                        </tr>"},constructInnerTableRow:function(componentArray){for(var tableStringBody="",i=0,n=componentArray.length;i<n;++i){var component=componentArray[i];tableStringBody+='<tr class="ZPLRow">\n                                    \t<td>'.concat(ZSEC.Encoder.encodeForHTML(component.compName),"</td>\n                                        <td>").concat(ZPI18N.getString(PlatformConstants.ComponentType[+component.compType]),"</td>\n                                        <td>").concat(void 0===component.parCompName?"-":ZSEC.Encoder.encodeForHTML(component.parCompName),"</td>\n                                        <td>").concat(ZPI18N.getString(PlatformConstants.ActionType[+component.operation]),"</td>\n                                     </tr>")}return tableStringBody},loadUnPublishedComponents:function(data){var tableBody="",tableBodyHeader='<div class="table-responsive ZPjobsTbl" style="">\n\t\t\t\t\t\t               <table class="table table-hover MB0I">\n\t\t\t\t\t\t                  <thead>\n\t\t\t\t\t\t                     <tr>\n\t\t\t\t\t\t                        <th width="200">'.concat(ZPI18N.getString("zp.name"),'</th>\n\t\t\t\t\t\t                        <th width="200">').concat(ZPI18N.getString("zp.extension.componenttype"),"</th>\n\t\t\t\t\t\t                        <th>").concat(ZPI18N.getString("zp.extension.parentcomponent"),'</th>\n\t\t\t\t\t\t                        <th width="150">').concat(ZPI18N.getString("zp.action"),'</th>\n\t\t\t\t\t\t                     </tr>\n\t\t\t\t\t\t                  </thead>\n\t\t\t\t\t\t                  <tbody id="unPublishedComponenetTable">'),tableRowString="";for(var componentVersion in data.components)tableRowString+=Extension.constructInnerTableRow(data.components[componentVersion]);tableBody=""===tableRowString?ZPUtil.newNoDataHTML("CR-nodata",8,ZPI18N.getString("zp.extension.nocomponentsfound"),void 0,void 0,void 0):tableBodyHeader+tableRowString+"\t\t  </tbody>\n\t\t\t\t\t\t               </table>\n\t\t\t\t\t\t            </div>",document.getElementById("publishModalBody").innerHTML=tableBody},copyToClipboard:function(text){const el=document.createElement("textarea");el.value=text,el.setAttribute("readonly",""),el.style.position="absolute",el.style.left="-9999px",document.body.appendChild(el),el.select(),document.execCommand("copy"),document.body.removeChild(el)},loadEditChanges:function(response){document.getElementById("latestVersionName").innerHTML=response.name},showSharePrivatelyPopup:function(){event.stopPropagation(),$("#sharePrivatelyPopup").modal("show"),document.getElementById("shareByEmailButton").setAttribute("disabled","true"),document.getElementById("sharePrivatelyPopup").setAttribute("extensionVersion",event.target.parentElement.parentElement.getAttribute("extensionVersion"))}};function _classCallCheck(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_toPropertyKey(o.key),o)}}function _createClass(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==typeof i?i:i+""}function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _toConsumableArray(r){return _arrayWithoutHoles(r)||_iterableToArray(r)||_unsupportedIterableToArray(r)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _iterableToArray(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function _arrayWithoutHoles(r){if(Array.isArray(r))return _arrayLikeToArray(r)}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}Extension.EditModal={init:function(extension){document.getElementById("extensionName").value=extension.name,document.getElementById("extensionDescription").value=extension.description&&extension.description||"",document.getElementById("editExtension").setAttribute("extensionID",extension.EID),document.getElementById("editExtension").setAttribute("extensionVersion",extension.latestVersion),document.getElementById("editExtensionButton").addEventListener("click",Extension.EditModal.saveButtonActionListener)},saveButtonActionListener:function(){if(document.getElementById("extensionDescription").value.length<25)return ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.extension.descriptionerrormessage")),void(document.getElementById("descriptionErrorMessage").innerText=ZPI18N.getString("zp.extension.descriptionerrormessage"));if(document.getElementById("extensionLogoPreview").naturalWidth>120&&document.getElementById("extensionLogoPreview").naturalHeight>120)ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.extension.logoresolutionmessage"));else if($("#editExtension").modal("hide"),document.getElementById("editExtensionButton").classList.add("disabled"),""!==document.getElementById("extensionName").value){var form=$("#uploadExtensionLogo");if(ZPUtil.isAllowedFormatForImage($("#uploadExtensionLogo").val())&&ZPUtil.isFileSizeExceed(form,null,!0))return void ZPeople.Message.showWarningMsg(ZPI18N.getString("zp.photolengthwarning"));var formData=new FormData(document.getElementById("extensionEditForm"));formData.append("conreqcsr",csrfToken),formData.append("method","editExtensionDetails"),formData.append("devZSOID",_LOGGEDIN_ZSOID),formData.append("extensionID",document.getElementById("editExtension").getAttribute("extensionID")),formData.append("extensionUUID",document.getElementById("latestVersionName").getAttribute("ext-uuid")),$.ajax({type:"POST",processData:!1,contentType:!1,cache:!1,enctype:"multipart/form-data",url:"editExtensionDetails.zp",data:formData,success:function(response){if("ZPEC051"===response.status){var extensionDetails={};extensionDetails.name=document.getElementById("extensionName").value,extensionDetails.description=document.getElementById("extensionDescription").value,document.getElementById("latestVersionName").innerText=extensionDetails.name,document.getElementById("publishExtensionLogo").setAttribute("src","/getExtensionLogo.zp?ZSOID="+_LOGGEDIN_ZSOID+"&extensionID="+pfExtId+"&method=getExtensionLogo")}else ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror"));document.getElementById("editExtensionButton").classList.remove("disabled")},error:function(response){ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.sorryservererror")),document.getElementById("editExtensionButton").classList.remove("disabled")}})}},removeEmailList:function(){for(var emailListElement=document.getElementById("extensionEmailInput");emailListElement.firstChild;)emailListElement.removeChild(emailListElement.lastChild)}},Extension.ImageUtil={previewUploadImage:function(input,id){if(input.files&&input.files[0]){var reader=new FileReader;reader.onload=function(e){document.getElementById(id).setAttribute("src",e.target.result)},reader.readAsDataURL(input.files[0])}}},Extension.SharePrivately={counter:0,emailList:[],init:function(){document.getElementById("shareByEmailButton").addEventListener("click",Extension.SharePrivately.handleShareButton),document.getElementById("shareExtensionName").innerText=document.getElementById("latestVersionName").innerText,document.getElementById("shareToMail").setAttribute("class","pointer-events: none;"),document.getElementById("currTextBox").addEventListener("focusout",function(){Extension.SharePrivately.handleDOM()})},handleInput:function(){13===event.keyCode&&Extension.SharePrivately.handleDOM(event)},handleDOM:function(event){var value="";if(value=void 0!==event?event.target.value:document.getElementById("currTextBox").value,Extension.SharePrivately.counter<=50&&Extension.EMAIL_REGEX.test(value)&&Extension.SharePrivately.isUniqueEMail(value))return Extension.SharePrivately.emailList.push(value),document.getElementById("extensionEmailInput").insertAdjacentHTML("beforeend",'<li class="multipleInput-email faildEmail"><span class="shareEmailID">'.concat(value,'</span><i class="IC-cls" onclick="Extension.SharePrivately.handleDelete()"></i></li>')),document.getElementById("currTextBox").value="",Extension.SharePrivately.counter++,void document.getElementById("shareByEmailButton").removeAttribute("disabled")},handleDelete:function(){event.target.parentElement.remove(),Extension.SharePrivately.counter--,Extension.SharePrivately.counter<=0&&document.getElementById("shareByEmailButton").setAttribute("disabled","true")},isUniqueEMail:function(value){return-1===Extension.SharePrivately.emailList.indexOf(value)},handleShareButton:function(){for(var version=document.getElementById("sharePrivatelyPopup").getAttribute("extensionVersion"),shareList=[],shareI=0,shareN=document.getElementById("extensionEmailInput").childElementCount;shareI<shareN;++shareI)shareList.push(extensionEmailInput.querySelector(".shareEmailID").innerText);if(shareList.length>0){document.getElementById("shareByEmailButton").setAttribute("disabled","true");var params={method:"sharePrivateExtension"};params.devZSOID=_LOGGEDIN_ZSOID,params.extensionID=pfExtId,params.version=version,params.shareEMailList=JSON.stringify(shareList),params.devEMail=decodeHTML(ZPeople.CURR_USER.email),params.extensionDescription=document.getElementById("extensionDescription").value,params.extensionName=document.getElementById("latestVersionName").innerText,params.publishURL=document.getElementById("latestVersionLink").innerText,ZPeople.Request.send("sharePrivateExtension.zp",params,function(response){"ZPEC151"==response.status&&ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.mailsent")),$("#sharePrivatelyPopup").modal("hide"),Extension.EditModal.removeEmailList(),Extension.SharePrivately.emailList=[],Extension.SharePrivately.counter=0})}}};let ZohoPayrollIntegration={organisationStructureCache:{},isLocationNeededInCriteria:!1,init:function(configuration){ZohoPayrollIntegration.initOrganisationStructureCache(configuration)},initOrganisationStructureCache:function(configuration){ZPeople.Request.sendAsyncPost(ZPOrgStructure.URL,{method:"fetchOrganizationStructure"},function(response){ZohoPayrollIntegration.organisationStructureCache=response,ZohoPayrollIntegration.OrgStructureSyncCriteria.init(configuration)})}};ZohoPayrollIntegration.OrgStructureSyncCriteria={id:0,locationCache:[],employeeTypeCache:[],pouplatedLegalEntity:[],populatedBusinessUnit:[],populatedDivision:[],isLocationNeededInCriteria:!1,isEmployeeTypeNeededInCriteria:!1,idMapping:{},containerID:"",entityMapping:{"legal-entity-select":{placeholderValue:ZPI18N.getString("zp.selectlegalEntity"),changeListener:function(targetDOM){ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndAddOption(targetDOM,"legal-entity-select","legal-entity"),ZohoPayrollIntegration.OrgStructureSyncCriteria.populateBusinessUnit(targetDOM),ZohoPayrollIntegration.OrgStructureSyncCriteria.ruleListener(),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndToggleSaveButton(targetDOM),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndLoadHiddenField(targetDOM,"business-unit")},required:!1},"business-unit-select":{placeholderValue:ZPI18N.getString("zp.selectbusinessunit"),allValue:ZPI18N.getString("zp.allbusinessunits"),changeListener:function(targetDOM){ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndAddOption(targetDOM,"business-unit-select","business-unit"),ZohoPayrollIntegration.OrgStructureSyncCriteria.populateDivision(targetDOM),ZohoPayrollIntegration.OrgStructureSyncCriteria.ruleListener(),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndToggleSaveButton(targetDOM),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndLoadHiddenField(targetDOM,"division")},required:!1},"division-select":{placeholderValue:ZPI18N.getString("zp.selectdivision"),allValue:ZPI18N.getString("zp.alldivisions"),changeListener:function(targetDOM){ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndAddOption(targetDOM,"division-select","division"),ZohoPayrollIntegration.OrgStructureSyncCriteria.populateDepartment(targetDOM),ZohoPayrollIntegration.OrgStructureSyncCriteria.ruleListener(),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndToggleSaveButton(targetDOM)},required:!1},"department-select":{placeholderValue:ZPI18N.getString("zp.selectdepartment"),changeListener:function(targetDOM){ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndAddOption(targetDOM,"department-select","department"),ZohoPayrollIntegration.OrgStructureSyncCriteria.ruleListener(),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndToggleSaveButton(targetDOM)},required:!1},"location-select":{placeholderValue:ZPI18N.getString("zp.selectlocation"),changeListener:function(targetDOM){ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndAddOption(targetDOM,"location-select","location"),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkValuesForLocation(targetDOM),ZohoPayrollIntegration.OrgStructureSyncCriteria.ruleListener(),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndToggleSaveButton(targetDOM)},required:!1},"employee-type-select":{placeholderValue:ZPI18N.getString("zp.selectemployeetype"),changeListener:function(targetDOM){ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndAddOption(targetDOM,"employee-type-select","employee-type"),ZohoPayrollIntegration.OrgStructureSyncCriteria.ruleListener(),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndToggleSaveButton(targetDOM)},required:!1}},orgStructureSyncTemplate:'<div class="zp_slaLvl" id="sla_levels_box">\n\t\t\t\t\t\t\t\t\t  <div class="zp_lvlIn" name="sla_levels">\n\t\t\t\t\t\t\t\t\t      <div style="" class="zp_lvlHead DF ">\n\t\t\t\t\t\t\t\t\t          <h5 style="flex: 1;" class="rule-number"></h5>\n\t\t\t\t\t\t\t\t\t          <div style="flex: 0;" class="zp_btn DF M0I PT0I"> <button type="button" class="dgry preference-save-button" onclick="ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndSubmit(this, true);">Save</button>\n\t\t\t\t\t\t\t\t\t          </div><i name="delete_btn" onclick="ZohoPayrollIntegration.OrgStructureSyncCriteria.removeOrganisationStructureSyncCriteria(this);" class="IC-delete dgry" style="right: 100px;"></i>\n\t\t\t\t\t\t\t\t\t      </div>\n\t\t\t\t\t\t\t\t\t      <div style="justify-content: space-between;width: 640px;" class="zp_mLtFld DF ">\n\t\t\t\t\t\t\t\t\t          <div class=" W300">\n\t\t\t\t\t\t\t\t\t              <div>\n\t\t\t\t\t\t\t\t\t                <select class="legal-entity-select" name="legal-entity" multiple="multiple"></select>  \n\t\t\t\t\t\t\t\t\t              </div>\n\t\t\t\t\t\t\t\t\t          </div>\n\t\t\t\t\t\t\t\t\t          <div class=" W300">\n\t\t\t\t\t\t\t\t\t              <div>\n\t\t\t\t\t\t\t\t\t                <select class="business-unit-select" name="business-unit" multiple="multiple"></select>  \n\t\t\t\t\t\t\t\t\t              </div>\n\t\t\t\t\t\t\t\t\t          </div>\n\t\t\t\t\t\t\t\t\t      </div>\n\t\t\t\t\t\t\t\t\t      <div style="justify-content: space-between;width: 640px;" class="zp_mLtFld DF ">\n\t\t\t\t\t\t\t\t\t          <div class=" W300">\n\t\t\t\t\t\t\t\t\t              <div>\n\t\t\t\t\t\t\t\t\t                <div><select class="division-select" name="division" multiple="multiple"></select></div>\n\t\t\t\t\t\t\t\t\t              </div>\n\t\t\t\t\t\t\t\t\t          </div>\n\t\t\t\t\t\t\t\t\t          <div class=" W300">\n\t\t\t\t\t\t\t\t\t              <div>\n\t\t\t\t\t\t\t\t\t                <div><select class="department-select" name="department" multiple="multiple"></select></div>\n\t\t\t\t\t\t\t\t\t              </div>\n\t\t\t\t\t\t\t\t\t          </div>\n\t\t\t\t\t\t\t\t\t      </div>\n\t\t\t\t\t\t\t\t\t      <div style="justify-content: space-between;width: 640px;" class="zp_mLtFld DF ">\n\t\t\t\t\t\t\t\t\t        {#location-template}\n\t\t\t\t\t\t\t\t\t        {#employee-type-template}\n\t\t\t\t\t\t\t\t\t      </div>\n\t\t\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t\t\t</div>',locationTemplate:'<div class=" W300">\n\t\t\t\t              <div>\n\t\t\t\t                <div><select class="location-select" name="location" multiple="multiple"></select></div>\n\t\t\t\t              </div>\n\t\t\t\t           </div>',employeeTypeTemplate:'<div class=" W300">\n\t\t\t\t\t              <div>\n\t\t\t\t\t                <div><select class="employee-type-select" name="employee-type" multiple="multiple"></select></div>\n\t\t\t\t\t              </div>\n\t\t\t\t\t           </div>',initConfiguration:function(configuration){ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria=configuration.isLocationNeeded,ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria=configuration.isEmployeeTypeNeeded,ZohoPayrollIntegration.OrgStructureSyncCriteria.containerID=configuration.containerID,ZohoPayrollIntegration.OrgStructureSyncCriteria.maximumCount=configuration.maximumCount;let requiredFields=configuration.requiredFields;for(let i=0,n=requiredFields.length;i<n;++i)ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping[requiredFields[i]].required=!0},init:function(configuration){this.initConfiguration(configuration),document.getElementById(this.containerID).innerHTML='<div id="organisation-strucute-sync-content" class="PT10"><label class="lbldiv">'+ZPI18N.getString("zp.syncwithorgstructure")+'<b></b></label><div style="min-height:auto"><div id="org-structure-sync-criteria"></div><a class="S14" id="organisation-structure-add-rule" onClick="ZohoPayrollIntegration.OrgStructureSyncCriteria.addOrganisationStructureListener();">+'+ZPI18N.getString("zp.addpreference")+"</a></div></div>",this.organisationStructure=this.contructOrganisationStructure(ZohoPayrollIntegration.organisationStructureCache),configuration.isLoad||this.addOrganisationStructureSyncCriteria()},addOrganisationStructureListener:function(){let targetDOM=ZohoPayrollIntegration.OrgStructureSyncCriteria.addOrganisationStructureSyncCriteria();ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndHide(targetDOM)},addOrganisationStructureSyncCriteria:function(){if(document.querySelectorAll(".org-structure-sync").length===ZohoPayrollIntegration.OrgStructureSyncCriteria.maximumCount)return void ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.payrollmaximumcriteria"),[ZohoPayrollIntegration.OrgStructureSyncCriteria.maximumCount]);let container=document.getElementById("org-structure-sync-criteria"),templateDOM=document.createElement("div");templateDOM.setAttribute("id","org-structure-sync-id-"+this.id++),templateDOM.setAttribute("class","org-structure-sync");let template=this.orgStructureSyncTemplate;template=ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria?template.replace("{#location-template}",ZohoPayrollIntegration.OrgStructureSyncCriteria.locationTemplate):template.replace("{#location-template}",""),template=ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria?template.replace("{#employee-type-template}",ZohoPayrollIntegration.OrgStructureSyncCriteria.employeeTypeTemplate):template.replace("{#employee-type-template}",""),templateDOM.innerHTML=template;let currentRuleNumber=document.querySelectorAll(".org-structure-sync").length+1;var params;(templateDOM.querySelector(".rule-number").innerText=ZPI18N.getString("zp.preference")+" "+currentRuleNumber,container.appendChild(templateDOM),this.addOptionsForLegalEntity(templateDOM),ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria)&&(0===ZohoPayrollIntegration.OrgStructureSyncCriteria.locationCache.length?((params={serviceName:"ZPayroll"}).integId=document.getElementById("ZPayrollconf").getAttribute("pkid"),params.isPermBasedListNotNeeded="true",ZPeople.Request.sendAsyncPost("/integrations/payroll/fetchPayrollDetails",params,function(response){"Success"===response.message&&(ZohoPayrollIntegration.OrgStructureSyncCriteria.locationCache=response.orgLocationList,ZohoPayrollIntegration.OrgStructureSyncCriteria.populateLocation(templateDOM))})):ZohoPayrollIntegration.OrgStructureSyncCriteria.populateLocation(templateDOM));ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria?0===ZohoPayrollIntegration.OrgStructureSyncCriteria.employeeTypeCache.length?((params={fetchAction:"EmpType",serviceName:"ZPayroll"}).integId=document.getElementById("ZPayrollconf").getAttribute("pkid"),params.isPermBasedListNotNeeded="true",ZPeople.Request.sendAsyncPost("/integrations/payroll/fetchPayrollAdminsAndLocations",params,function(response){ZohoPayrollIntegration.OrgStructureSyncCriteria.employeeTypeCache=response.empTypes.uVals,ZohoPayrollIntegration.OrgStructureSyncCriteria.populateEmployeeType(templateDOM),ZohoPayrollIntegration.OrgStructureSyncCriteria.applySelect2(templateDOM)})):(ZohoPayrollIntegration.OrgStructureSyncCriteria.populateEmployeeType(templateDOM),this.applySelect2(templateDOM)):this.applySelect2(templateDOM);return ZohoPayrollIntegration.OrgStructureSyncCriteria.ruleListener(),templateDOM},addOptionsForLegalEntity:function(templateDOM){let container=templateDOM.querySelector(".legal-entity-select"),optionElement=document.createElement("option");container.appendChild(optionElement),(optionElement=document.createElement("option")).setAttribute("value","all"),optionElement.innerHTML=ZPI18N.getString("zp.alllegalentities"),container.appendChild(optionElement),ZohoPayrollIntegration.OrgStructureSyncCriteria.pouplatedLegalEntity=[],this.organisationStructure.getLegalEntityArray().forEach(function(legalEntity){(optionElement=document.createElement("option")).setAttribute("value",legalEntity.getId()),optionElement.innerHTML=legalEntity.getName(),container.appendChild(optionElement),ZohoPayrollIntegration.OrgStructureSyncCriteria.pouplatedLegalEntity.push(legalEntity.getId())})},applySelect2:function(templateDOM){Object.keys(ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping).forEach(function(mapping){"location-select"===mapping&&!ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria||"employee-type-select"===mapping&&!ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria||(templateDOM.querySelector("."+mapping).onchange=function(event){ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping[mapping].changeListener(event.target.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement)},$(templateDOM.querySelector("."+mapping)).select2({placeholder:ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping[mapping].placeholderValue}))})},contructOrganisationStructure:function(organisationStructure){let company=new Company(organisationStructure.companyid,organisationStructure.companyName,organisationStructure.departmentFormId),legalEntityArray=ZohoPayrollIntegration.OrgStructureSyncCriteria.getLegalEntityArray(organisationStructure);return company.setLegalEntityArray(legalEntityArray),company},removeOrganisationStructureSyncCriteria:function(content){1!==document.getElementById("org-structure-sync-criteria").querySelectorAll(".org-structure-sync").length?(content.parentElement.parentElement.parentElement.parentElement.remove(),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndSubmit(null,!1)):ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.payrollminimumcriteria",[1])),ZohoPayrollIntegration.OrgStructureSyncCriteria.renameRuleNumber(),ZohoPayrollIntegration.OrgStructureSyncCriteria.ruleListener()},getLegalEntityArray:function(organisationStructure){let legalEntityArray=[],entityArray=organisationStructure.entityIds,entityDetails=organisationStructure.entityDetails;if(void 0!==entityArray)for(let i=0,n=entityArray.length;i<n;++i){let entityDetail=entityDetails[entityArray[i]],entity=new LegalEntity(entityDetail.entityId,entityDetail.entityName,entityDetail.entityDesc,entityDetail.isDummy),businessUnitArray=ZohoPayrollIntegration.OrgStructureSyncCriteria.getBusinessUnitArray(entityDetail);entity.setBusinessUnitArray(businessUnitArray),legalEntityArray.push(entity)}return legalEntityArray},getBusinessUnitArray:function(entityDetail){let businessUnitArray=[],unitArray=entityDetail.unitIdList;for(let i=0,n=unitArray.length;i<n;++i){let unitDetail=entityDetail[unitArray[i]],businessUnit=new BusinessUnit(unitArray[i],unitDetail.unitName,unitDetail.unitDesc,unitDetail.isDummy),divisionArray=ZohoPayrollIntegration.OrgStructureSyncCriteria.getDivisionArray(unitDetail);businessUnit.setDivisionArray(divisionArray),businessUnitArray.push(businessUnit)}return businessUnitArray},getDivisionArray:function(unitDetail){return ZohoPayrollIntegration.OrgStructureSyncCriteria.getDivisionDepartmentArray(unitDetail)},getDivisionDepartmentArray:function(unitDetail){let divisionArray=[],divisionIDArray=unitDetail.divisionIdList,divisionDeparmentMapping={};for(let i=0,n=divisionIDArray.length;i<n;++i){let division=null,department=null,divisionID=divisionIDArray[i],divisionDetail=unitDetail[divisionID];divisionDetail.isDept?(department=new Department(divisionID,divisionDetail.name,divisionDetail.desc,divisionDetail.isDummy,divisionDetail.isParentDiv,divisionDetail.childDivIdList),divisionDeparmentMapping[divisionID]=department):(division=new Division(divisionID,divisionDetail.name,divisionDetail.desc,divisionDetail.isDummy,divisionDetail.isParentDiv,divisionDetail.childDivIdList),divisionArray.push(division),divisionDeparmentMapping[divisionID]=division)}return ZohoPayrollIntegration.OrgStructureSyncCriteria.addDepartmentInDivision(divisionArray,divisionArray[0],unitDetail,divisionDeparmentMapping),divisionArray},addDepartmentInDivision:function(divisionArray,division,unitDetail,divisionDepartmentMapping){for(let i=0,n=divisionArray.length;i<n;++i){let division=divisionArray[i];if(0!==division.getChildArray().length){let childArray=division.getChildArray();for(let childDivisionI=0,childDivisionN=childArray.length;childDivisionI<childDivisionN;++childDivisionI)division.addDepartment(divisionDepartmentMapping[childArray[childDivisionI]])}}},populateBusinessUnit:function(targetDOM){var _ref;let businessUnitArray,subBusinessUnitArray=[];if("all"===targetDOM.querySelector('[name="legal-entity"]').value)ZohoPayrollIntegration.OrgStructureSyncCriteria.pouplatedLegalEntity.forEach(function(legalEntityValue){subBusinessUnitArray.push(ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getBusinessUnitArrayForLEID(legalEntityValue))});else{$(targetDOM.querySelector(".legal-entity-select")).select2("data").map(function(legalEntityValue){if("all"!==legalEntityValue.id)return legalEntityValue.id}).forEach(function(legalEntityValue){subBusinessUnitArray.push(ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getBusinessUnitArrayForLEID(legalEntityValue))})}businessUnitArray=(_ref=[]).concat.apply(_ref,subBusinessUnitArray);let container=targetDOM.querySelector('[name="business-unit"]'),parentDOM=targetDOM.querySelector(".business-unit-select");$(parentDOM).select2("destroy"),ZohoPayrollIntegration.OrgStructureSyncCriteria.clearSelectionAndOption(targetDOM,"business-unit-select","business-unit"),ZohoPayrollIntegration.OrgStructureSyncCriteria.clearSelectionAndOption(targetDOM,"division-select","division"),ZohoPayrollIntegration.OrgStructureSyncCriteria.clearSelectionAndOption(targetDOM,"department-select","department"),container.innerHTML="",ZohoPayrollIntegration.OrgStructureSyncCriteria.addEmptyOption(container),ZohoPayrollIntegration.OrgStructureSyncCriteria.addAllOption(businessUnitArray,container,"business-unit-select"),1===businessUnitArray.length&&businessUnitArray[0].getIsDummy()?$(container).select2({placeholder:ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping["business-unit-select"].placeholderValue}):(ZohoPayrollIntegration.OrgStructureSyncCriteria.populatedBusinessUnit=[],businessUnitArray.forEach(function(businessUnitValue){if(""!==businessUnitValue.getName()){let optionElement=document.createElement("option");optionElement.setAttribute("value",businessUnitValue.getId()),optionElement.innerHTML=businessUnitValue.getName(),container.appendChild(optionElement)}ZohoPayrollIntegration.OrgStructureSyncCriteria.populatedBusinessUnit.push(businessUnitValue.getId())}),$(container).select2({placeholder:ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping["business-unit-select"].placeholderValue}))},populateDivision:function(targetDOM){var _ref2,_ref3;targetDOM.querySelector('[name="legal-entity"]').value;let businessUnitID=targetDOM.querySelector('[name="business-unit"]').value;if(""===businessUnitID)return ZohoPayrollIntegration.OrgStructureSyncCriteria.clearSelectionAndOption(targetDOM,"division-select","division"),void ZohoPayrollIntegration.OrgStructureSyncCriteria.clearSelectionAndOption(targetDOM,"department-select","department");let container=targetDOM.querySelector('[name="division"]'),parentDOM=targetDOM.querySelector(".division-select");$(parentDOM).select2("destroy");let divisionArray=[],subBusinessUnitArray=[];if("all"===businessUnitID)ZohoPayrollIntegration.OrgStructureSyncCriteria.populatedBusinessUnit.forEach(function(divisionValue){subBusinessUnitArray.push(ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDivisionArrayForBUID(divisionValue))});else{$(targetDOM.querySelector(".business-unit-select")).select2("data").map(function(businessUnitValue){if("all"!==businessUnitValue.id)return businessUnitValue.id}).forEach(function(divisionValue){subBusinessUnitArray.push(ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDivisionArrayForBUID(divisionValue))})}divisionArray=(_ref2=[]).concat.apply(_ref2,_toConsumableArray((_ref3=[]).concat.apply(_ref3,subBusinessUnitArray)));let entityValueIDArray=[],uniqueEntityArray=[];for(let entityValue of divisionArray)-1===entityValueIDArray.indexOf(entityValue.id)&&(uniqueEntityArray.push(entityValue),entityValueIDArray.push(entityValue.id));divisionArray=uniqueEntityArray,container.innerHTML="",ZohoPayrollIntegration.OrgStructureSyncCriteria.addEmptyOption(container),ZohoPayrollIntegration.OrgStructureSyncCriteria.addAllOption(divisionArray,container,"division-select"),1===divisionArray.length&&divisionArray[0].getIsDummy()?$(container).select2():(ZohoPayrollIntegration.OrgStructureSyncCriteria.populatedDivision=[],divisionArray.forEach(function(divisionValue){""!==divisionValue.getName()&&(optionElement=document.createElement("option"),optionElement.setAttribute("value",divisionValue.getId()),optionElement.innerHTML=divisionValue.getName(),container.appendChild(optionElement)),ZohoPayrollIntegration.OrgStructureSyncCriteria.populatedDivision.push(divisionValue.getId())}),$(container).select2({placeholder:ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping["division-select"].placeholderValue}))},populateDepartment:function(targetDOM){targetDOM.querySelector('[name="legal-entity"]').value,targetDOM.querySelector('[name="business-unit"]').value;let divisionID=targetDOM.querySelector('[name="division"]').value;if(""===divisionID)return void ZohoPayrollIntegration.OrgStructureSyncCriteria.clearSelectionAndOption(targetDOM,"department-select","department");let container=targetDOM.querySelector('[name="department"]'),parentDOM=targetDOM.querySelector(".department-select"),departmentArray=[];if($(parentDOM).select2("destroy"),"all"===divisionID){var _ref4,_ref5,_ref6;let divisionIDArray=[],subDivisionArray=[];targetDOM.querySelector('[name="division"]').childNodes.forEach(function(optionElement){""!==optionElement.value&&"all"!==optionElement.value&&divisionIDArray.push(optionElement.value)}),divisionIDArray.forEach(function(divisionID){subDivisionArray.push(ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDepartmentAndChildrenArray(divisionID))}),departmentArray=(_ref4=[]).concat.apply(_ref4,_toConsumableArray((_ref5=[]).concat.apply(_ref5,subDivisionArray))),departmentArray=(_ref6=[]).concat.apply(_ref6,_toConsumableArray(new Set(departmentArray)));let entityValueIDArray=[],uniqueEntityArray=[];for(let entityValue of departmentArray)-1===entityValueIDArray.indexOf(entityValue.id)&&(uniqueEntityArray.push(entityValue),entityValueIDArray.push(entityValue.id));departmentArray=uniqueEntityArray}else{var _ref7,_ref8,_ref9;let subDivisionArray=[];$(targetDOM.querySelector(".division-select")).select2("data").map(function(divisionValue){if("all"!==divisionValue.id)return divisionValue.id}).forEach(function(divisionValue){subDivisionArray.push(ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDepartmentAndChildrenArray(divisionValue))}),departmentArray=(_ref7=[]).concat.apply(_ref7,_toConsumableArray((_ref8=[]).concat.apply(_ref8,subDivisionArray))),departmentArray=(_ref9=[]).concat.apply(_ref9,_toConsumableArray(new Set(departmentArray)))}container.innerHTML="";let optionElement=document.createElement("option");container.appendChild(optionElement),(optionElement=document.createElement("option")).setAttribute("value","all"),optionElement.innerHTML=ZPI18N.getString("zp.alldepartment"),container.appendChild(optionElement),departmentArray.forEach(function(legalEntity){(optionElement=document.createElement("option")).setAttribute("value",legalEntity.getId()),optionElement.innerHTML=legalEntity.getName(),container.appendChild(optionElement)}),$(container).select2({placeholder:ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping["department-select"].placeholderValue})},populateLocation:function(targetDOM){let container=targetDOM.querySelector('[name="location"]'),parentDOM=targetDOM.querySelector(".location-select");ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping["location-select"].required&&container.setAttribute("required","true"),$(parentDOM).select2("destroy");let optionElement=document.createElement("option");container.appendChild(optionElement),(optionElement=document.createElement("option")).setAttribute("value","all"),optionElement.innerHTML=ZPI18N.getString("zp.alllocaction"),container.appendChild(optionElement),ZohoPayrollIntegration.OrgStructureSyncCriteria.locationCache.forEach(function(locationValue){(optionElement=document.createElement("option")).setAttribute("value",locationValue.locationId),optionElement.innerHTML=locationValue.locationName,container.appendChild(optionElement)})},populateEmployeeType:function(targetDOM){let container=targetDOM.querySelector('[name="employee-type"]'),parentDOM=targetDOM.querySelector(".employee-type-select");ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping["employee-type-select"].required&&container.setAttribute("required","true"),$(parentDOM).select2("destroy");let optionElement=document.createElement("option");container.appendChild(optionElement),ZohoPayrollIntegration.OrgStructureSyncCriteria.employeeTypeCache.forEach(function(employeeTypeValue){(optionElement=document.createElement("option")).setAttribute("value",-1==employeeTypeValue.optId?"all":employeeTypeValue.optId),optionElement.innerHTML=employeeTypeValue.optVal,container.appendChild(optionElement)})},addEmptyOption:function(container){let optionElement=document.createElement("option");container.appendChild(optionElement)},addAllOption:function(entityArray,container,entityType){let optionElement=document.createElement("option");optionElement.setAttribute("value","all"),optionElement.innerHTML=void 0!==entityType?ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping[entityType].allValue:"All",container.appendChild(optionElement),1===entityArray.length&&entityArray[0].getIsDummy()&&(optionElement.setAttribute("value",entityArray[0].getId()),container.appendChild(optionElement))},clearSelectionAndOption:function(targetDOM,className,entityName){let container=targetDOM.querySelector("."+className),selectElement=targetDOM.querySelector('[name="'+entityName+'"]');$(container).select2("destroy"),selectElement.innerHTML="",$(selectElement).select2({placeholder:ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping[className].placeholderValue})},checkAndHide:function(targetDOM){document.querySelectorAll(".org-structure-sync");1===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getLegalEntityArray().length&&!0===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getLegalEntityArray()[0].isDummy&&($(targetDOM.querySelector('[name="legal-entity"]')).select2("val",ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getLegalEntityArray()[0].id),$(targetDOM.querySelector('[name="legal-entity"]')).trigger("change"),targetDOM.querySelector(".legal-entity-select").parentElement.parentElement.classList.add("DN"))},checkAndLoadHiddenField:function(targetDOM,fieldName){"legal-entity"===fieldName&&(1===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getLegalEntityArray().length&&!0===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getLegalEntityArray()[0].isDummy?($(targetDOM.querySelector('[name="legal-entity"]')).select2("val",ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getLegalEntityArray()[0].id),$(targetDOM.querySelector('[name="legal-entity"]')).trigger("change"),targetDOM.querySelector(".legal-entity-select").parentElement.parentElement.classList.add("DN")):0===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getLegalEntityArray().length&&($(targetDOM.querySelector('[name="legal-entity"]')).select2("val","all"),$(targetDOM.querySelector('[name="legal-entity"]')).trigger("change"),targetDOM.querySelector(".legal-entity-select").parentElement.parentElement.classList.add("DN"))),"business-unit"===fieldName&&(1===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getBusinessUnitArray().length&&!0===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getBusinessUnitArray()[0].isDummy?($(targetDOM.querySelector('[name="business-unit"]')).select2("val",ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getBusinessUnitArray()[0].id),$(targetDOM.querySelector('[name="business-unit"]')).trigger("change"),targetDOM.querySelector(".business-unit-select").parentElement.parentElement.classList.add("DN")):0===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getBusinessUnitArray().length&&($(targetDOM.querySelector('[name="business-unit"]')).select2("val","all"),$(targetDOM.querySelector('[name="business-unit"]')).trigger("change"),targetDOM.querySelector(".business-unit-select").parentElement.parentElement.classList.add("DN"))),"division"===fieldName&&(1===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDivisionArray().length&&!0===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDivisionArray()[0].isDummy?($(targetDOM.querySelector('[name="division"]')).select2("val",ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDivisionArray()[0].id),$(targetDOM.querySelector('[name="division"]')).trigger("change"),targetDOM.querySelector(".division-select").parentElement.parentElement.parentElement.classList.add("DN")):0===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDivisionArray().length&&($(targetDOM.querySelector('[name="division"]')).select2("val","all"),$(targetDOM.querySelector('[name="division"]')).trigger("change"),targetDOM.querySelector(".division-select").parentElement.parentElement.parentElement.classList.add("DN")))},checkAndAddOption:function(targetDOM,className,entityName){let container=targetDOM.querySelector("."+className),optionArray=[];$(container).select2("data").forEach(function(value){optionArray.push(value.id)}),-1!==optionArray.indexOf("all")&&$(container).select2("val","all")},checkValuesForLocation:function(targetDOM){""===$(targetDOM.querySelector(".legal-entity-select")).select2("val")&&0===$(targetDOM.querySelector(".business-unit-select")).select2("val").length&&0===$(targetDOM.querySelector(".division-select")).select2("val").length&&0===$(targetDOM.querySelector(".department-select")).select2("val").length&&($(targetDOM.querySelector(".legal-entity-select")).select2("val","all"),$(targetDOM.querySelector('[name="legal-entity"]')).trigger("change"),$(targetDOM.querySelector(".business-unit-select")).select2("val","all"),$(targetDOM.querySelector('[name="business-unit"]')).trigger("change"),$(targetDOM.querySelector(".division-select")).select2("val","all"),$(targetDOM.querySelector('[name="division"]')).trigger("change"),$(targetDOM.querySelector(".department-select")).select2("val","all"))},checkAndAddAllOption:function(criteriaDOM){let entityDOM=$(criteriaDOM.querySelector(".legal-entity-select"));0==entityDOM.select2("data").length&&(entityDOM.select2("val","all"),$(criteriaDOM.querySelector('[name="legal-entity"]')).trigger("change")),0==(entityDOM=$(criteriaDOM.querySelector(".business-unit-select"))).select2("data").length&&(entityDOM.select2("val","all"),$(criteriaDOM.querySelector('[name="business-unit"]')).trigger("change")),0==(entityDOM=$(criteriaDOM.querySelector(".division-select"))).select2("data").length&&(entityDOM.select2("val","all"),$(criteriaDOM.querySelector('[name="division"]')).trigger("change")),0==(entityDOM=$(criteriaDOM.querySelector(".department-select"))).select2("data").length&&(entityDOM.select2("val","all"),$(criteriaDOM.querySelector('[name="department"]')).trigger("change")),0==(entityDOM=$(criteriaDOM.querySelector(".location-select"))).select2("data").length&&(entityDOM.select2("val","all"),$(criteriaDOM.querySelector('[name="location"]')).trigger("change")),0==(entityDOM=$(criteriaDOM.querySelector(".employee-type-select"))).select2("data").length&&(entityDOM.select2("val","all"),$(criteriaDOM.querySelector('[name="employee-type"]')).trigger("change"))},checkAndSubmit:function(targetDOM,isUpdate){let container=document.getElementById("org-structure-sync-criteria"),idMapping={},idArray=[],organisationStructureSyncCriteriaValue=[],isError=!1;if(isUpdate&&(ZohoPayrollIntegration.OrgStructureSyncCriteria.clearMandatoryHighlights(container),ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndHighlightMandatoryFields(container)))return!1;let containerArray=container.querySelectorAll(".org-structure-sync");for(let criteriaValue of containerArray){let idValue=criteriaValue.getAttribute("id");ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndAddAllOption(criteriaValue);let legalEntityID=$(criteriaValue.querySelector(".legal-entity-select")).select2("val"),businessUnitIDArray=$(criteriaValue.querySelector(".business-unit-select")).select2("val"),divisionIDArray=$(criteriaValue.querySelector(".division-select")).select2("val"),departmentIDArray=$(criteriaValue.querySelector(".department-select")).select2("val"),entityValue={};if(0===legalEntityID.length){isError=!0;break}entityValue.legalEntity=legalEntityID,0===businessUnitIDArray.length&&(businessUnitIDArray[0]="all"),entityValue.businessUnitArray=businessUnitIDArray,0===divisionIDArray.length&&(divisionIDArray[0]="all"),entityValue.divisionArray=divisionIDArray,0===departmentIDArray.length&&(departmentIDArray[0]="all"),entityValue.departmentArray=departmentIDArray;let uniqueValue=legalEntityID.sort().join("")+"-"+businessUnitIDArray.sort().join("")+"-"+divisionIDArray.sort().join("")+"-"+departmentIDArray.sort().join("")+"-";if(ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria){let locationIDArray=$(criteriaValue.querySelector(".location-select")).select2("val");0===locationIDArray.length&&(locationIDArray[0]="all"),entityValue.locationArray=locationIDArray,uniqueValue+=locationIDArray.sort().join(""),uniqueValue+="-"}if(ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria){let employeeTypeIDArray=$(criteriaValue.querySelector(".employee-type-select")).select2("val");0===employeeTypeIDArray.length&&(employeeTypeIDArray[0]="all"),entityValue.employeeTypeArray=employeeTypeIDArray,uniqueValue+=employeeTypeIDArray.sort().join("")}uniqueValue=-1!==uniqueValue.lastIndexOf("-")?uniqueValue.substring(0,uniqueValue.length):uniqueValue,idMapping[idValue]=uniqueValue,idArray.push(idValue),ZohoPayrollIntegration.OrgStructureSyncCriteria.idMapping[idValue]=uniqueValue,organisationStructureSyncCriteriaValue.push(entityValue)}let found=!1,targetIDValue="";for(let i=0,n=idArray.length;i<n;++i){for(let j=i+1,m=idArray.length;j<m;++j)if(idMapping[idArray[i]]===idMapping[idArray[j]]){targetIDValue=idArray[j],found=!0;break}if(found)break}if(document.querySelector(".criteria-duplicate-entry")&&document.querySelector(".criteria-duplicate-entry").remove(),found)return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.payrollorgstructureremoveduplicate")),!1;t=organisationStructureSyncCriteriaValue;let configuration={};if(configuration.organisationStructureSyncCriteriaValue=organisationStructureSyncCriteriaValue,isError)return ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.savecategoryconfigurationfailed")),!1;if(0!==configuration.organisationStructureSyncCriteriaValue.length){ZohoPayrollIntegration.OrgStructureSyncCriteria.saveCriteria(configuration)&&isUpdate&&targetDOM.setAttribute("disabled","true")}return!0},saveCriteria:function(configuation){let params={},isSaved=!1;params.integId=document.getElementById("ZPayrollconf").getAttribute("pkid"),params.serviceName="ZPayroll",params.mode="updateCriteria",params.criteria=JSON.stringify(configuation.organisationStructureSyncCriteriaValue);return configuation.organisationStructureSyncCriteriaValue,ZPeople.Request.sendAsyncPost("/integrations/payroll/payrollOrganisationStructureSyncOperation",params,function(resultData){tt=resultData,"success"==resultData.status?(ZPeople.Message.showSuccessMsg(ZPI18N.getString("zp.rulesaved")),isSaved=!0):9994==resultData.error?(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.payrollorgstructureduplicatecriteria")),isSaved=!1):9998==resultData.error?(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.payrollorgstructurechildduplicate")),isSaved=!1):(ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.savecategoryconfigurationfailed")),isSaved=!1)}),isSaved},checkCriteria:function(targetDOM){if(ZohoPayrollIntegration.OrgStructureSyncCriteria.checkDuplicateCriteria())return;document.getElementById("org-structure-sync-criteria");let criteriaValue=targetDOM.parentElement.parentElement.parentElement,idValue=criteriaValue.getAttribute("id"),legalEntityID=$(criteriaValue.querySelector(".legal-entity-select")).select2("val"),businessUnitIDArray=$(criteriaValue.querySelector(".business-unit-select")).select2("val"),divisionIDArray=$(criteriaValue.querySelector(".division-select")).select2("val"),departmentIDArray=$(criteriaValue.querySelector(".department-select")).select2("val"),entityValue={};if(""===legalEntityID)return;entityValue.legalEntity=legalEntityID,0===businessUnitIDArray.length&&(businessUnitIDArray[0]="all"),entityValue.businessUnitArray=businessUnitIDArray,0===divisionIDArray.length&&(divisionIDArray[0]="all"),entityValue.divisionArray=divisionIDArray,0===departmentIDArray.length&&(departmentIDArray[0]="all"),entityValue.departmentArray=departmentIDArray;let uniqueValue=legalEntityID+businessUnitIDArray.sort().join("")+divisionIDArray.sort().join("")+departmentIDArray.sort().join("");if(ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria){let locationIDArray=$(criteriaValue.querySelector(".location-select")).select2("val");0===locationIDArray.length&&(locationIDArray[0]="all"),entityValue.locationArray=locationIDArray,uniqueValue+=locationIDArray.sort().join("")}if(ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria){let employeeTypeIDArray=$(criteriaValue.querySelector(".employee-type-select")).select2("val");0===employeeTypeIDArray.length&&(employeeTypeIDArray[0]="all"),entityValue.employeeTypeArray=employeeTypeIDArray,uniqueValue+=employeeTypeIDArray.sort().join("")}ZohoPayrollIntegration.OrgStructureSyncCriteria.idMapping[idValue]=uniqueValue;let integrationID=document.getElementById("ZPayrollconf").getAttribute("pkid");var addnlPref={};addnlPref.criteria=entityValue,ZPeople.Request.sendAsyncPost("/integrations/payroll/updatePayrollSettings",{addnlprefs:JSON.stringify(addnlPref),fieldName:"orgstructure",integId:integrationID,newValues:JSON.stringify([]),newVals:JSON.stringify([])},function(resltData){tt=resultData})},checkDuplicateCriteria:function(){let container=document.getElementById("org-structure-sync-criteria"),idMapping={},idArray=[],organisationStructureSyncCriteriaValue=[];container.querySelectorAll(".org-structure-sync").forEach(function(criteriaValue){let idValue=criteriaValue.getAttribute("id"),legalEntityID=$(criteriaValue.querySelector(".legal-entity-select")).select2("val"),businessUnitIDArray=$(criteriaValue.querySelector(".business-unit-select")).select2("val"),divisionIDArray=$(criteriaValue.querySelector(".division-select")).select2("val"),departmentIDArray=$(criteriaValue.querySelector(".department-select")).select2("val"),entityValue={};if(0===legalEntityID.length)return!1;entityValue.legalEntity=legalEntityID,0===businessUnitIDArray.length&&(businessUnitIDArray[0]="all"),entityValue.businessUnitArray=businessUnitIDArray,0===divisionIDArray.length&&(divisionIDArray[0]="all"),entityValue.divisionArray=divisionIDArray,0===departmentIDArray.length&&(departmentIDArray[0]="all"),entityValue.departmentArray=departmentIDArray;let uniqueValue=legalEntityID+businessUnitIDArray.sort().join("")+divisionIDArray.sort().join("")+departmentIDArray.sort().join("");if(ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria){let locationIDArray=$(criteriaValue.querySelector(".location-select")).select2("val");0===locationIDArray.length&&(locationIDArray[0]="all"),entityValue.locationArray=locationIDArray,uniqueValue+=locationIDArray.sort().join("")}if(ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria){let employeeTypeIDArray=$(criteriaValue.querySelector(".employee-type-select")).select2("val");0===employeeTypeIDArray.length&&(employeeTypeIDArray[0]="all"),entityValue.employeeTypeArray=employeeTypeIDArray,uniqueValue+=employeeTypeIDArray.sort().join("")}idMapping[idValue]=uniqueValue,idArray.push(idValue),organisationStructureSyncCriteriaValue.push(entityValue)});let found=!1,targetIDValue="";for(let i=0,n=idArray.length;i<n;++i){for(let j=i+1,m=idArray.length;j<m;++j)if(idMapping[idArray[i]]===idMapping[idArray[j]]){targetIDValue=idArray[j],found=!0;break}if(found)break}if(document.querySelector(".criteria-duplicate-entry")&&document.querySelector(".criteria-duplicate-entry"),found){let spanElement=document.createElement("span");return spanElement.setAttribute("class","DB CL text-center S15 MB10 red criteria-duplicate-entry"),spanElement.innerHTML=ZPI18N.getString("zp.duplicateentriesexist"),container.querySelector("#"+targetIDValue).insertAdjacentElement("afterbegin",spanElement),!0}return!1},loadCriteria:function(criteriaArray){criteriaArray.forEach(function(criteriaValue){let templateDOM=ZohoPayrollIntegration.OrgStructureSyncCriteria.addOrganisationStructureSyncCriteria();["legal-entity","business-unit","division"].forEach(function(value){ZohoPayrollIntegration.OrgStructureSyncCriteria.checkAndLoadHiddenField(templateDOM,value)}),-1!==criteriaValue.legalEntity.indexOf("all")&&1===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getLegalEntityArray().length&&ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getLegalEntityArray()[0].isDummy?($(templateDOM.querySelector(".legal-entity-select")).select2("val",ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getLegalEntityArray()[0].id),$(templateDOM.querySelector('[name="legal-entity"]')).trigger("change")):($(templateDOM.querySelector(".legal-entity-select")).select2("val",criteriaValue.legalEntity),$(templateDOM.querySelector('[name="legal-entity"]')).trigger("change")),-1!==criteriaValue.businessUnitArray.indexOf("all")&&1===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getBusinessUnitArray().length&&ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getBusinessUnitArray()[0].isDummy?($(templateDOM.querySelector(".business-unit-select")).select2("val",ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getBusinessUnitArray()[0].id),$(templateDOM.querySelector('[name="business-unit"]')).trigger("change")):($(templateDOM.querySelector(".business-unit-select")).select2("val",criteriaValue.businessUnitArray),$(templateDOM.querySelector('[name="business-unit"]')).trigger("change")),-1!==criteriaValue.divisionArray.indexOf("all")&&1===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDivisionArray().length&&ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDivisionArray()[0].isDummy?($(templateDOM.querySelector(".division-select")).select2("val",ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDivisionArray()[0].id),$(templateDOM.querySelector('[name="division"]')).trigger("change")):($(templateDOM.querySelector(".division-select")).select2("val",criteriaValue.divisionArray),$(templateDOM.querySelector('[name="division"]')).trigger("change")),-1!==criteriaValue.departmentArray.indexOf("all")&&1===ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDepartmentArray().length&&ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDepartmentArray()[0].isDummy?($(templateDOM.querySelector(".department-select")).select2("val",ZohoPayrollIntegration.OrgStructureSyncCriteria.organisationStructure.getDepartmentArray()[0].id),$(templateDOM.querySelector('[name="department"]')).trigger("change")):($(templateDOM.querySelector(".department-select")).select2("val",criteriaValue.departmentArray),$(templateDOM.querySelector('[name="department"]')).trigger("change")),ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria&&$(templateDOM.querySelector(".location-select")).select2("val",criteriaValue.locationArray),ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria&&$(templateDOM.querySelector(".employee-type-select")).select2("val",criteriaValue.employeeTypeArray);let uniqueValue=criteriaValue.legalEntity.sort().join("")+"-"+criteriaValue.businessUnitArray.sort().join("")+"-"+criteriaValue.divisionArray.sort().join("")+"-"+criteriaValue.departmentArray.sort().join("")+"-";ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria&&(uniqueValue+=criteriaValue.locationArray+"-"),ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria&&(uniqueValue+=criteriaValue.employeeTypeArray+"-"),uniqueValue=-1!==uniqueValue.lastIndexOf("-")?uniqueValue.substring(0,uniqueValue.length):uniqueValue,ZohoPayrollIntegration.OrgStructureSyncCriteria.idMapping[templateDOM.getAttribute("id")]=uniqueValue}),ZohoPayrollIntegration.OrgStructureSyncCriteria.disableAllSaveButton(),ZohoPayrollIntegration.OrgStructureSyncCriteria.ruleListener()},checkAndHighlightMandatoryFields:function(parentDOM){let criteriaDOMArray=parentDOM.querySelectorAll('select[required="true"]'),found=!1;for(let i=0,n=criteriaDOMArray.length;i<n;++i){let criteriaDOM=criteriaDOMArray[i];if(0===$(criteriaDOM.previousSibling).select2("data").length){found=!0,(void 0!==criteriaDOM.querySelector('[name="legal-entity]')?criteriaDOM.parentElement.parentElement:criteriaDOM.parentElement.parentElement.parentElement).style.borderBottom="1px solid red"}}return found&&ZPeople.Message.showFailureMsg(ZPI18N.getString("zp.payrollfillmandatoryfields")),found},clearMandatoryHighlights:function(parentDOM){let criteriaDOMArray=parentDOM.querySelectorAll('select[required="true"]');for(let i=0,n=criteriaDOMArray.length;i<n;++i){let criteriaParentDOM=criteriaDOMArray[i].parentElement.parentElement.parentElement;""!==criteriaParentDOM.style.borderBottom&&(criteriaParentDOM.style="")}},checkAndToggleSaveButton:function(targetDOM){let legalEntityID=$(targetDOM.querySelector(".legal-entity-select")).select2("val"),businessUnitIDArray=$(targetDOM.querySelector(".business-unit-select")).select2("val"),divisionIDArray=$(targetDOM.querySelector(".division-select")).select2("val"),departmentIDArray=$(targetDOM.querySelector(".department-select")).select2("val"),entityValue={};entityValue.legalEntity=legalEntityID,0===businessUnitIDArray.length&&(businessUnitIDArray[0]="all"),entityValue.businessUnitArray=businessUnitIDArray,0===divisionIDArray.length&&(divisionIDArray[0]="all"),entityValue.divisionArray=divisionIDArray,0===departmentIDArray.length&&(departmentIDArray[0]="all"),entityValue.departmentArray=departmentIDArray;let uniqueValue=legalEntityID.sort().join("")+"-"+businessUnitIDArray.sort().join("")+"-"+divisionIDArray.sort().join("")+"-"+departmentIDArray.sort().join("")+"-";if(ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria){let locationIDArray=$(targetDOM.querySelector(".location-select")).select2("val");0===locationIDArray.length&&(locationIDArray[0]="all"),entityValue.locationArray=locationIDArray,uniqueValue+=locationIDArray.sort().join(""),uniqueValue+="-"}if(ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria){let employeeTypeIDArray=$(targetDOM.querySelector(".employee-type-select")).select2("val");0===employeeTypeIDArray.length&&(employeeTypeIDArray[0]="all"),entityValue.employeeTypeArray=employeeTypeIDArray,uniqueValue+=employeeTypeIDArray.sort().join("")}uniqueValue=-1!==uniqueValue.lastIndexOf("-")?uniqueValue.substring(0,uniqueValue.length):uniqueValue,ZohoPayrollIntegration.OrgStructureSyncCriteria.idMapping[targetDOM.parentElement.getAttribute("id")]===uniqueValue?targetDOM.querySelector(".preference-save-button").setAttribute("disabled","true"):targetDOM.querySelector(".preference-save-button").removeAttribute("disabled")},disableAllSaveButton:function(){let containerArray=document.getElementById("org-structure-sync-criteria").querySelectorAll(".org-structure-sync");for(let container of containerArray)container.querySelector(".preference-save-button").setAttribute("disabled","true")},renameRuleNumber:function(){let criteriaDOMArray=document.querySelectorAll(".org-structure-sync"),ruleNumber=1;for(let criteriaDOM of criteriaDOMArray)criteriaDOM.querySelector(".rule-number").innerText=ZPI18N.getString("zp.preference")+" "+ruleNumber++},ruleListener:function(){let ruleDOM=document.getElementById("organisation-structure-add-rule"),criteriaDOMArray=document.querySelectorAll(".org-structure-sync"),found=!1;if(criteriaDOMArray.length!==ZohoPayrollIntegration.OrgStructureSyncCriteria.maximumCount){for(var i=0,n=criteriaDOMArray.length;i<n;++i){let criteriaDOM=criteriaDOMArray[i];for(let mappingKey in ZohoPayrollIntegration.OrgStructureSyncCriteria.entityMapping)if(("location-select"!==mappingKey||ZohoPayrollIntegration.OrgStructureSyncCriteria.isLocationNeededInCriteria)&&("employee-type-select"!==mappingKey||ZohoPayrollIntegration.OrgStructureSyncCriteria.isEmployeeTypeNeededInCriteria)&&0===$(criteriaDOM.querySelector("."+mappingKey)).select2("data").length){found=!0;break}if(found)break}found?ruleDOM.classList.add("DN"):ruleDOM.classList.remove("DN")}else ruleDOM.classList.add("DN")}};let Company=function(){return _createClass(function Company(id,name,departmentFormId){_classCallCheck(this,Company),this.id=id,this.name=name,this.departmentFormId=departmentFormId,this.legalEntityArray=[]},[{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.name}},{key:"getDepartmentFormId",value:function(){return this.departmentFormId}},{key:"setLegalEntityArray",value:function(legalEntityArray){this.legalEntityArray=legalEntityArray}},{key:"getLegalEntityArray",value:function(){return this.legalEntityArray}},{key:"getLegalEntityForID",value:function(legalEntityID){for(let i=0,n=this.legalEntityArray.length;i<n;++i)if(legalEntityID===this.legalEntityArray[i].id)return this.legalEntityArray[i];return null}},{key:"getBusinessUnitArrayForLEID",value:function(legalEntityID){for(let legalEntityValue of this.getLegalEntityArray())if(legalEntityID==legalEntityValue.getId())return legalEntityValue.getBusinessUnitArray()}},{key:"getBusinessUnitArray",value:function(){var _ref0;let businessUnitArray=[];for(let legalEntityValue of this.getLegalEntityArray())businessUnitArray.push(legalEntityValue.getBusinessUnitArray());return(_ref0=[]).concat.apply(_ref0,businessUnitArray)}},{key:"getDivisionArrayForBUID",value:function(businessUnitID){let divisionValueArray=[];for(let legalEntityValue of this.getLegalEntityArray())for(let businessUnitValue of legalEntityValue.getBusinessUnitArray())businessUnitID==businessUnitValue.getId()&&divisionValueArray.push(businessUnitValue.getDivisionArray());return divisionValueArray}},{key:"getDivisionArray",value:function(businessUnitID){var _ref1;let divisionValueArray=[];for(let legalEntityValue of this.getLegalEntityArray())for(let businessUnitValue of legalEntityValue.getBusinessUnitArray())divisionValueArray.push(businessUnitValue.getDivisionArray());return(_ref1=[]).concat.apply(_ref1,divisionValueArray)}},{key:"getDivisionForID",value:function(divisionID){for(let legalEntityValue of this.getLegalEntityArray())for(let businessUnitValue of legalEntityValue.getBusinessUnitArray())for(let divisionValue of businessUnitValue.getDivisionArray())if(divisionID==divisionValue.getId())return divisionValue;return null}},{key:"getDepartmentArray",value:function(divisionID){for(let legalEntityValue of this.getLegalEntityArray())for(let businessUnitValue of legalEntityValue.getBusinessUnitArray());return[]}},{key:"getDepartmentAndChildrenArray",value:function(divisionID){let departmentValueArray=[];for(let legalEntityValue of this.getLegalEntityArray())for(let businessUnitValue of legalEntityValue.getBusinessUnitArray())for(let divisionValue of businessUnitValue.getDivisionArray())divisionID==divisionValue.getId()&&this.getDepartmentFromDivision(divisionValue,departmentValueArray);return departmentValueArray}},{key:"getDepartmentFromDivision",value:function(divisionValue,departmentValueArray){if(0!==divisionValue.getDepartmentArray().length){let departmentArray=divisionValue.getDepartmentArray();for(let department of departmentArray){0===departmentValueArray.filter(function(departmentValue){return departmentValue.id===department.id}).length&&(department.isDept?departmentValueArray.push(department):this.getDepartmentFromDivision(department,departmentValueArray))}}}},{key:"getDivision",value:function(divisionID){this.getLegalEntityArray().forEach(function(entityValue){entityValue.getBusinessUnitArray(entityValue.getId()).forEach(function(businessUnitValue){if(businessUnitValue.getDivisionForID(businessUnitValue.getId()).getId()==divisionID)return businessUnitValue.getDivisionForID(businessUnitValue.getId())})})}},{key:"getDepartment",value:function(departmentID){this.getLegalEntityArray().forEach(function(entityValue){entityValue.getBusinessUnitArray(entityValue.getId()).forEach(function(businessUnitValue){businessUnitValue.getDivisionArray(businessUnitValue.getId()).forEach(function(divisionValue){if(divisionValue.getDepartmentForID(divisionValue.getId())==departmentID)return divisionValue.getDepartmentForID(divisionValue.getId())})})})}}])}(),LegalEntity=function(){return _createClass(function LegalEntity(id,name,description,isDummy){_classCallCheck(this,LegalEntity),this.id=id,this.name=name,this.description=description,this.isDummy=isDummy,this.businessUnitArray=[]},[{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.name}},{key:"getDescription",value:function(){return this.name}},{key:"getIsDummy",value:function(){return this.isDummy}},{key:"setBusinessUnitArray",value:function(businessUnitArray){this.businessUnitArray=businessUnitArray}},{key:"getBusinessUnitArray",value:function(){return this.businessUnitArray}},{key:"getBusinessUnitForID",value:function(businessUnitID){for(let i=0,n=this.businessUnitArray.length;i<n;++i)if(businessUnitID===this.businessUnitArray[i].id)return this.businessUnitArray[i];return null}}])}(),BusinessUnit=function(){return _createClass(function BusinessUnit(id,name,description,isDummy){_classCallCheck(this,BusinessUnit),this.id=id,this.name=name,this.description=description,this.isDummy=isDummy,this.divisionArray=[]},[{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.name}},{key:"getDescription",value:function(){return this.name}},{key:"getIsDummy",value:function(){return this.isDummy}},{key:"setDivisionArray",value:function(divisionArray){this.divisionArray=divisionArray}},{key:"getDivisionArray",value:function(){return this.divisionArray}},{key:"getDivisionForID",value:function(divisionID){for(let i=0,n=this.divisionArray.length;i<n;++i)if(divisionID===this.divisionArray[i].id)return this.divisionArray[i];return null}}])}(),Division=function(){return _createClass(function Division(id,name,description,isDummy,isParent,childArray){_classCallCheck(this,Division),this.id=id,this.name=name,this.description=description,this.isDummy=isDummy,this.isParent=isParent,this.childArray=childArray,this.departmentArray=[],this.isDept=!1,this.departmentIDArray=[]},[{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.name}},{key:"getDescription",value:function(){return this.name}},{key:"getIsDummy",value:function(){return this.isDummy}},{key:"getIsParent",value:function(){return this.isParent}},{key:"getChildArray",value:function(){return this.childArray}},{key:"getDepartmentArray",value:function(){return this.departmentArray}},{key:"getDepartmentForID",value:function(departmentID){for(let i=0,n=this.departmentArray.length;i<n;++i)if(departmentID===this.departmentArray[i].id)return this.departmentArray[i];return null}},{key:"addDepartment",value:function(department){this.departmentArray.push(department),this.departmentIDArray=this.departmentArray.map(function(value){return value.id})}}])}(),Department=function(){return _createClass(function Department(id,name,description,isDummy,isParent,childArray){_classCallCheck(this,Department),this.id=id,this.name=name,this.description=description,this.isDummy=isDummy,this.isParent=isParent,this.childArray=childArray,this.departmentArray=[],this.isDept=!0,this.departmentIDArray=[]},[{key:"getId",value:function(){return this.id}},{key:"getName",value:function(){return this.name}},{key:"getDescription",value:function(){return this.name}},{key:"getIsDummy",value:function(){return this.isDummy}},{key:"getIsParent",value:function(){return this.isParent}},{key:"getChildArray",value:function(){return this.childArray}},{key:"getDepartmentArray",value:function(){return this.departmentArray}},{key:"addDepartment",value:function(department){this.departmentArray.push(department),this.departmentIDArray=this.departmentArray.map(function(value){return value.id})}}])}();